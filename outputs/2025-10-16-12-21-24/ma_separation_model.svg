<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="38457pt" height="926pt"
 viewBox="0.00 0.00 38456.57 926.48" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 922.48)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-922.48 38452.57,-922.48 38452.57,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer_0</title>
<path fill="lightgray" stroke="black" d="M3169,-308C3169,-308 9491,-308 9491,-308 9497,-308 9503,-314 9503,-320 9503,-320 9503,-790 9503,-790 9503,-796 9497,-802 9491,-802 9491,-802 3169,-802 3169,-802 3163,-802 3157,-796 3157,-790 3157,-790 3157,-320 3157,-320 3157,-314 3163,-308 3169,-308"/>
<text text-anchor="middle" x="6330" y="-788.4" font-family="Arial" font-size="12.00">Layer 1</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_attention_0</title>
<polygon fill="#e6f3ff" stroke="black" stroke-dasharray="5,2" points="8,-8 8,-496 3078,-496 3078,-8 8,-8"/>
<text text-anchor="middle" x="1543" y="-482.4" font-family="Arial" font-size="12.00">Attention &#45; Layer 1</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_moe_0</title>
<polygon fill="#ffe6e6" stroke="black" stroke-dasharray="5,2" points="3118,-8 3118,-300 9565,-300 9565,-8 3118,-8"/>
<text text-anchor="middle" x="6341.5" y="-286.4" font-family="Arial" font-size="12.00">MoE &#45; Layer 1</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer_1</title>
<path fill="lightgray" stroke="black" d="M12766,-308C12766,-308 18708,-308 18708,-308 18714,-308 18720,-314 18720,-320 18720,-320 18720,-898.48 18720,-898.48 18720,-904.48 18714,-910.48 18708,-910.48 18708,-910.48 12766,-910.48 12766,-910.48 12760,-910.48 12754,-904.48 12754,-898.48 12754,-898.48 12754,-320 12754,-320 12754,-314 12760,-308 12766,-308"/>
<text text-anchor="middle" x="15737" y="-896.88" font-family="Arial" font-size="12.00">Layer 2</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_attention_1</title>
<polygon fill="#e6f3ff" stroke="black" stroke-dasharray="5,2" points="9605,-8 9605,-496 12675,-496 12675,-8 9605,-8"/>
<text text-anchor="middle" x="11140" y="-482.4" font-family="Arial" font-size="12.00">Attention &#45; Layer 2</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_moe_1</title>
<polygon fill="#ffe6e6" stroke="black" stroke-dasharray="5,2" points="12715,-8 12715,-300 19162,-300 19162,-8 12715,-8"/>
<text text-anchor="middle" x="15938.5" y="-286.4" font-family="Arial" font-size="12.00">MoE &#45; Layer 2</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_layer_2</title>
<path fill="lightgray" stroke="black" d="M22363,-308C22363,-308 28305,-308 28305,-308 28311,-308 28317,-314 28317,-320 28317,-320 28317,-898.48 28317,-898.48 28317,-904.48 28311,-910.48 28305,-910.48 28305,-910.48 22363,-910.48 22363,-910.48 22357,-910.48 22351,-904.48 22351,-898.48 22351,-898.48 22351,-320 22351,-320 22351,-314 22357,-308 22363,-308"/>
<text text-anchor="middle" x="25334" y="-896.88" font-family="Arial" font-size="12.00">Layer 3</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_attention_2</title>
<polygon fill="#e6f3ff" stroke="black" stroke-dasharray="5,2" points="19202,-8 19202,-496 22272,-496 22272,-8 19202,-8"/>
<text text-anchor="middle" x="20737" y="-482.4" font-family="Arial" font-size="12.00">Attention &#45; Layer 3</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_moe_2</title>
<polygon fill="#ffe6e6" stroke="black" stroke-dasharray="5,2" points="22312,-8 22312,-300 28759,-300 28759,-8 22312,-8"/>
<text text-anchor="middle" x="25535.5" y="-286.4" font-family="Arial" font-size="12.00">MoE &#45; Layer 3</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_layer_3</title>
<path fill="lightgray" stroke="black" d="M31925,-308C31925,-308 37867,-308 37867,-308 37873,-308 37879,-314 37879,-320 37879,-320 37879,-898.48 37879,-898.48 37879,-904.48 37873,-910.48 37867,-910.48 37867,-910.48 31925,-910.48 31925,-910.48 31919,-910.48 31913,-904.48 31913,-898.48 31913,-898.48 31913,-320 31913,-320 31913,-314 31919,-308 31925,-308"/>
<text text-anchor="middle" x="34896" y="-896.88" font-family="Arial" font-size="12.00">Layer 4</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_attention_3</title>
<polygon fill="#e6f3ff" stroke="black" stroke-dasharray="5,2" points="28799,-8 28799,-496 31869,-496 31869,-8 28799,-8"/>
<text text-anchor="middle" x="30334" y="-482.4" font-family="Arial" font-size="12.00">Attention &#45; Layer 4</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_moe_3</title>
<polygon fill="#ffe6e6" stroke="black" stroke-dasharray="5,2" points="31909,-8 31909,-300 38356,-300 38356,-8 31909,-8"/>
<text text-anchor="middle" x="35132.5" y="-286.4" font-family="Arial" font-size="12.00">MoE &#45; Layer 4</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" stroke-width="2" cx="4884" cy="-847.48" rx="248.39" ry="37.45"/>
<text text-anchor="middle" x="4884" y="-858.78" font-family="Arial" font-size="14.00">Model Input</text>
<text text-anchor="middle" x="4884" y="-843.78" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4884" y="-828.78" font-family="Arial" font-size="14.00">GPU: Host</text>
</g>
<!-- layer_0_distribute -->
<g id="node2" class="node">
<title>layer_0_distribute</title>
<polygon fill="lightcoral" stroke="black" points="4884,-773 4441,-705 4884,-637 5327,-705 4884,-773"/>
<text text-anchor="middle" x="4884" y="-723.8" font-family="Arial" font-size="14.00">Layer 1 Input Distribution</text>
<text text-anchor="middle" x="4884" y="-708.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4884" y="-693.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, hidden_dim=4096] replicated 8x</text>
<text text-anchor="middle" x="4884" y="-678.8" font-family="Arial" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- input&#45;&gt;layer_0_distribute -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer_0_distribute</title>
<path fill="none" stroke="black" d="M4884,-809.93C4884,-801.64 4884,-792.52 4884,-783.23"/>
<polygon fill="black" stroke="black" points="4887.5,-783.12 4884,-773.12 4880.5,-783.12 4887.5,-783.12"/>
</g>
<!-- layer_0_qkv_gpu_0 -->
<g id="node3" class="node">
<title>layer_0_qkv_gpu_0</title>
<polygon fill="#ffe4e1" stroke="black" points="3531,-601 3165,-601 3165,-518 3531,-518 3531,-601"/>
<text text-anchor="middle" x="3348" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3348" y="-570.8" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="3348" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3348" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3348" y="-525.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_distribute&#45;&gt;layer_0_qkv_gpu_0 -->
<g id="edge2" class="edge">
<title>layer_0_distribute&#45;&gt;layer_0_qkv_gpu_0</title>
<path fill="none" stroke="black" d="M4538.4,-690.02C4268.73,-676.13 3884.88,-649.82 3540.99,-601.09"/>
<polygon fill="black" stroke="black" points="3541.48,-597.62 3531.08,-599.68 3540.49,-604.55 3541.48,-597.62"/>
</g>
<!-- layer_0_qkv_gpu_1 -->
<g id="node4" class="node">
<title>layer_0_qkv_gpu_1</title>
<polygon fill="#e6e6fa" stroke="black" points="3915,-601 3549,-601 3549,-518 3915,-518 3915,-601"/>
<text text-anchor="middle" x="3732" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3732" y="-570.8" font-family="Arial" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3732" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3732" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3732" y="-525.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_0_distribute&#45;&gt;layer_0_qkv_gpu_1 -->
<g id="edge3" class="edge">
<title>layer_0_distribute&#45;&gt;layer_0_qkv_gpu_1</title>
<path fill="none" stroke="black" d="M4597.62,-680.9C4408.96,-663.84 4156.52,-637.51 3925.06,-601.13"/>
<polygon fill="black" stroke="black" points="3925.53,-597.66 3915.1,-599.55 3924.44,-604.57 3925.53,-597.66"/>
</g>
<!-- layer_0_qkv_gpu_2 -->
<g id="node5" class="node">
<title>layer_0_qkv_gpu_2</title>
<polygon fill="#f0e68c" stroke="black" points="4299,-601 3933,-601 3933,-518 4299,-518 4299,-601"/>
<text text-anchor="middle" x="4116" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4116" y="-570.8" font-family="Arial" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4116" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4116" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4116" y="-525.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_0_distribute&#45;&gt;layer_0_qkv_gpu_2 -->
<g id="edge4" class="edge">
<title>layer_0_distribute&#45;&gt;layer_0_qkv_gpu_2</title>
<path fill="none" stroke="black" d="M4677.44,-668.66C4570.36,-649.94 4437.23,-626.07 4309.15,-601.21"/>
<polygon fill="black" stroke="black" points="4309.64,-597.74 4299.15,-599.27 4308.3,-604.61 4309.64,-597.74"/>
</g>
<!-- layer_0_qkv_gpu_3 -->
<g id="node6" class="node">
<title>layer_0_qkv_gpu_3</title>
<polygon fill="#98fb98" stroke="black" points="4683,-601 4317,-601 4317,-518 4683,-518 4683,-601"/>
<text text-anchor="middle" x="4500" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4500" y="-570.8" font-family="Arial" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="4500" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4500" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4500" y="-525.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_0_distribute&#45;&gt;layer_0_qkv_gpu_3 -->
<g id="edge5" class="edge">
<title>layer_0_distribute&#45;&gt;layer_0_qkv_gpu_3</title>
<path fill="none" stroke="black" d="M4756.67,-656.42C4712.02,-639.73 4662.1,-621.07 4618.23,-604.68"/>
<polygon fill="black" stroke="black" points="4619.27,-601.33 4608.67,-601.11 4616.82,-607.89 4619.27,-601.33"/>
</g>
<!-- layer_0_qkv_gpu_4 -->
<g id="node7" class="node">
<title>layer_0_qkv_gpu_4</title>
<polygon fill="#87ceeb" stroke="black" points="5067,-601 4701,-601 4701,-518 5067,-518 5067,-601"/>
<text text-anchor="middle" x="4884" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4884" y="-570.8" font-family="Arial" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="4884" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4884" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4884" y="-525.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_0_distribute&#45;&gt;layer_0_qkv_gpu_4 -->
<g id="edge6" class="edge">
<title>layer_0_distribute&#45;&gt;layer_0_qkv_gpu_4</title>
<path fill="none" stroke="black" d="M4884,-636.87C4884,-628.26 4884,-619.55 4884,-611.25"/>
<polygon fill="black" stroke="black" points="4887.5,-611 4884,-601 4880.5,-611 4887.5,-611"/>
</g>
<!-- layer_0_qkv_gpu_5 -->
<g id="node8" class="node">
<title>layer_0_qkv_gpu_5</title>
<polygon fill="#dda0dd" stroke="black" points="5451,-601 5085,-601 5085,-518 5451,-518 5451,-601"/>
<text text-anchor="middle" x="5268" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5268" y="-570.8" font-family="Arial" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="5268" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5268" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5268" y="-525.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_0_distribute&#45;&gt;layer_0_qkv_gpu_5 -->
<g id="edge7" class="edge">
<title>layer_0_distribute&#45;&gt;layer_0_qkv_gpu_5</title>
<path fill="none" stroke="black" d="M5011.33,-656.42C5055.98,-639.73 5105.9,-621.07 5149.77,-604.68"/>
<polygon fill="black" stroke="black" points="5151.18,-607.89 5159.33,-601.11 5148.73,-601.33 5151.18,-607.89"/>
</g>
<!-- layer_0_qkv_gpu_6 -->
<g id="node9" class="node">
<title>layer_0_qkv_gpu_6</title>
<polygon fill="#f4a460" stroke="black" points="5835,-601 5469,-601 5469,-518 5835,-518 5835,-601"/>
<text text-anchor="middle" x="5652" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5652" y="-570.8" font-family="Arial" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="5652" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5652" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5652" y="-525.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_0_distribute&#45;&gt;layer_0_qkv_gpu_6 -->
<g id="edge8" class="edge">
<title>layer_0_distribute&#45;&gt;layer_0_qkv_gpu_6</title>
<path fill="none" stroke="black" d="M5090.56,-668.66C5197.64,-649.94 5330.77,-626.07 5458.85,-601.21"/>
<polygon fill="black" stroke="black" points="5459.7,-604.61 5468.85,-599.27 5458.36,-597.74 5459.7,-604.61"/>
</g>
<!-- layer_0_qkv_gpu_7 -->
<g id="node10" class="node">
<title>layer_0_qkv_gpu_7</title>
<polygon fill="#d3d3d3" stroke="black" points="6219,-601 5853,-601 5853,-518 6219,-518 6219,-601"/>
<text text-anchor="middle" x="6036" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6036" y="-570.8" font-family="Arial" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="6036" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6036" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6036" y="-525.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_0_distribute&#45;&gt;layer_0_qkv_gpu_7 -->
<g id="edge9" class="edge">
<title>layer_0_distribute&#45;&gt;layer_0_qkv_gpu_7</title>
<path fill="none" stroke="black" d="M5170.38,-680.9C5359.04,-663.84 5611.48,-637.51 5842.94,-601.13"/>
<polygon fill="black" stroke="black" points="5843.56,-604.57 5852.9,-599.55 5842.47,-597.66 5843.56,-604.57"/>
</g>
<!-- layer_0_attn_ln -->
<g id="node11" class="node">
<title>layer_0_attn_ln</title>
<polygon fill="#ffe4b5" stroke="black" points="6599,-593.5 6237,-593.5 6237,-525.5 6599,-525.5 6599,-593.5"/>
<text text-anchor="middle" x="6418" y="-578.3" font-family="Arial" font-size="14.00">LayerNorm + Residual</text>
<text text-anchor="middle" x="6418" y="-563.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6418" y="-548.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6418" y="-533.3" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_0_distribute&#45;&gt;layer_0_attn_ln -->
<g id="edge44" class="edge">
<title>layer_0_distribute&#45;&gt;layer_0_attn_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5230.68,-690.17C5502.91,-676.24 5890.99,-649.61 6228,-601 6239.41,-599.35 6251.16,-597.43 6262.96,-595.32"/>
<polygon fill="black" stroke="black" points="6263.66,-598.75 6272.87,-593.51 6262.4,-591.86 6263.66,-598.75"/>
</g>
<!-- layer_0_kv_reduce -->
<g id="node21" class="node">
<title>layer_0_kv_reduce</title>
<polygon fill="lightcoral" stroke="black" points="2632,-467 2194,-399 2632,-331 3070,-399 2632,-467"/>
<text text-anchor="middle" x="2632" y="-417.8" font-family="Arial" font-size="14.00">KV All&#45;Reduce</text>
<text text-anchor="middle" x="2632" y="-402.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128] from 8 GPUs</text>
<text text-anchor="middle" x="2632" y="-387.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2632" y="-372.8" font-family="Arial" font-size="14.00">GPU: All 0&#45;7</text>
</g>
<!-- layer_0_qkv_gpu_0&#45;&gt;layer_0_kv_reduce -->
<g id="edge19" class="edge">
<title>layer_0_qkv_gpu_0&#45;&gt;layer_0_kv_reduce</title>
<path fill="none" stroke="black" d="M3165.01,-517.99C3059.24,-494.58 2926.43,-465.18 2819.85,-441.58"/>
<polygon fill="black" stroke="black" points="2820.47,-438.14 2809.95,-439.39 2818.96,-444.97 2820.47,-438.14"/>
</g>
<!-- layer_0_qkv_gpu_1&#45;&gt;layer_0_kv_reduce -->
<g id="edge20" class="edge">
<title>layer_0_qkv_gpu_1&#45;&gt;layer_0_kv_reduce</title>
<path fill="none" stroke="black" d="M3548.93,-519.2C3545.94,-518.78 3542.96,-518.38 3540,-518 3338.76,-492.09 3285.22,-522.05 3084,-496 2991.4,-484.01 2889.57,-463.08 2806.04,-443.82"/>
<polygon fill="black" stroke="black" points="2806.74,-440.39 2796.21,-441.54 2805.16,-447.2 2806.74,-440.39"/>
</g>
<!-- layer_0_qkv_gpu_2&#45;&gt;layer_0_kv_reduce -->
<g id="edge21" class="edge">
<title>layer_0_qkv_gpu_2&#45;&gt;layer_0_kv_reduce</title>
<path fill="none" stroke="black" d="M3932.94,-519.11C3929.94,-518.72 3926.96,-518.35 3924,-518 3553.09,-474.39 3454.88,-539.87 3084,-496 2990.51,-484.94 2887.75,-463.85 2803.86,-444.24"/>
<polygon fill="black" stroke="black" points="2804.52,-440.8 2793.99,-441.92 2802.92,-447.62 2804.52,-440.8"/>
</g>
<!-- layer_0_qkv_gpu_3&#45;&gt;layer_0_kv_reduce -->
<g id="edge22" class="edge">
<title>layer_0_qkv_gpu_3&#45;&gt;layer_0_kv_reduce</title>
<path fill="none" stroke="black" d="M4316.95,-519.08C4313.95,-518.7 4310.96,-518.34 4308,-518 3767.38,-456.69 3624.58,-557.69 3084,-496 2990.18,-485.29 2887.07,-464.13 2803.05,-444.4"/>
<polygon fill="black" stroke="black" points="2803.7,-440.96 2793.16,-442.06 2802.09,-447.77 2803.7,-440.96"/>
</g>
<!-- layer_0_qkv_gpu_4&#45;&gt;layer_0_kv_reduce -->
<g id="edge23" class="edge">
<title>layer_0_qkv_gpu_4&#45;&gt;layer_0_kv_reduce</title>
<path fill="none" stroke="black" d="M4700.95,-519.06C4697.95,-518.68 4694.96,-518.33 4692,-518 4336.82,-478.49 3439.15,-535.76 3084,-496 2989.96,-485.47 2886.62,-464.27 2802.52,-444.46"/>
<polygon fill="black" stroke="black" points="2803.16,-441.01 2792.62,-442.11 2801.54,-447.82 2803.16,-441.01"/>
</g>
<!-- layer_0_qkv_gpu_5&#45;&gt;layer_0_kv_reduce -->
<g id="edge24" class="edge">
<title>layer_0_qkv_gpu_5&#45;&gt;layer_0_kv_reduce</title>
<path fill="none" stroke="black" d="M5084.95,-519.05C5081.95,-518.68 5078.96,-518.33 5076,-518 4635.96,-469.64 3524.01,-544.67 3084,-496 2989.85,-485.59 2886.4,-464.36 2802.25,-444.5"/>
<polygon fill="black" stroke="black" points="2802.88,-441.06 2792.34,-442.15 2801.27,-447.87 2802.88,-441.06"/>
</g>
<!-- layer_0_qkv_gpu_6&#45;&gt;layer_0_kv_reduce -->
<g id="edge25" class="edge">
<title>layer_0_qkv_gpu_6&#45;&gt;layer_0_kv_reduce</title>
<path fill="none" stroke="black" d="M5468.95,-519.04C5465.95,-518.67 5462.96,-518.32 5460,-518 4935.09,-460.78 3608.87,-553.58 3084,-496 2989.75,-485.66 2886.17,-464.4 2801.98,-444.52"/>
<polygon fill="black" stroke="black" points="2802.61,-441.07 2792.07,-442.16 2800.99,-447.88 2802.61,-441.07"/>
</g>
<!-- layer_0_qkv_gpu_7&#45;&gt;layer_0_kv_reduce -->
<g id="edge26" class="edge">
<title>layer_0_qkv_gpu_7&#45;&gt;layer_0_kv_reduce</title>
<path fill="none" stroke="black" d="M5852.95,-519.04C5849.95,-518.67 5846.96,-518.32 5844,-518 5539.11,-484.96 3388.87,-529.25 3084,-496 2989.74,-485.72 2886.17,-464.47 2801.98,-444.57"/>
<polygon fill="black" stroke="black" points="2802.61,-441.12 2792.07,-442.21 2800.99,-447.93 2802.61,-441.12"/>
</g>
<!-- layer_0_gate_gpu_8 -->
<g id="node12" class="node">
<title>layer_0_gate_gpu_8</title>
<polygon fill="#ffb6c1" stroke="black" points="3892.8,-482 3314.08,-482 3165.2,-316 3743.92,-316 3892.8,-482"/>
<text text-anchor="middle" x="3529" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="3529" y="-410.3" font-family="Arial" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="3529" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3529" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="3529" y="-365.3" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_0_attn_ln&#45;&gt;layer_0_gate_gpu_8 -->
<g id="edge10" class="edge">
<title>layer_0_attn_ln&#45;&gt;layer_0_gate_gpu_8</title>
<path fill="none" stroke="black" d="M6278.7,-525.48C6261.7,-522.44 6244.51,-519.82 6228,-518 5971.1,-489.69 4158.25,-529.68 3902,-496 3878.4,-492.9 3854.15,-488.8 3829.89,-484.05"/>
<polygon fill="black" stroke="black" points="3830.36,-480.57 3819.87,-482.05 3828.99,-487.44 3830.36,-480.57"/>
</g>
<!-- layer_0_gate_gpu_9 -->
<g id="node13" class="node">
<title>layer_0_gate_gpu_9</title>
<polygon fill="#20b2aa" stroke="black" points="4638.8,-482 4060.08,-482 3911.2,-316 4489.92,-316 4638.8,-482"/>
<text text-anchor="middle" x="4275" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="4275" y="-410.3" font-family="Arial" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="4275" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4275" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="4275" y="-365.3" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_0_attn_ln&#45;&gt;layer_0_gate_gpu_9 -->
<g id="edge11" class="edge">
<title>layer_0_attn_ln&#45;&gt;layer_0_gate_gpu_9</title>
<path fill="none" stroke="black" d="M6278.17,-525.46C6261.35,-522.44 6244.34,-519.84 6228,-518 5879.05,-478.76 4996.05,-542.53 4648,-496 4624.55,-492.87 4600.46,-488.76 4576.36,-484.02"/>
<polygon fill="black" stroke="black" points="4576.89,-480.56 4566.39,-482.03 4575.51,-487.42 4576.89,-480.56"/>
</g>
<!-- layer_0_gate_gpu_10 -->
<g id="node14" class="node">
<title>layer_0_gate_gpu_10</title>
<polygon fill="#b0c4de" stroke="black" points="5384.8,-482 4806.08,-482 4657.2,-316 5235.92,-316 5384.8,-482"/>
<text text-anchor="middle" x="5021" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="5021" y="-410.3" font-family="Arial" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="5021" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5021" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="5021" y="-365.3" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_0_attn_ln&#45;&gt;layer_0_gate_gpu_10 -->
<g id="edge12" class="edge">
<title>layer_0_attn_ln&#45;&gt;layer_0_gate_gpu_10</title>
<path fill="none" stroke="black" d="M6277.11,-525.47C6260.63,-522.5 6243.99,-519.9 6228,-518 5859.79,-474.28 5761.21,-547.43 5394,-496 5371.18,-492.8 5347.75,-488.73 5324.29,-484.07"/>
<polygon fill="black" stroke="black" points="5324.73,-480.59 5314.23,-482.04 5323.34,-487.45 5324.73,-480.59"/>
</g>
<!-- layer_0_gate_gpu_11 -->
<g id="node15" class="node">
<title>layer_0_gate_gpu_11</title>
<polygon fill="#ffdead" stroke="black" points="6130.8,-482 5552.08,-482 5403.2,-316 5981.92,-316 6130.8,-482"/>
<text text-anchor="middle" x="5767" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="5767" y="-410.3" font-family="Arial" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="5767" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5767" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="5767" y="-365.3" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_0_attn_ln&#45;&gt;layer_0_gate_gpu_11 -->
<g id="edge13" class="edge">
<title>layer_0_attn_ln&#45;&gt;layer_0_gate_gpu_11</title>
<path fill="none" stroke="black" d="M6267.03,-525.45C6225.78,-516.17 6181.12,-505.91 6140,-496 6124.59,-492.29 6108.84,-488.44 6092.93,-484.51"/>
<polygon fill="black" stroke="black" points="6093.56,-481.06 6083.01,-482.05 6091.88,-487.85 6093.56,-481.06"/>
</g>
<!-- layer_0_gate_gpu_12 -->
<g id="node16" class="node">
<title>layer_0_gate_gpu_12</title>
<polygon fill="#9acd32" stroke="black" points="6876.8,-482 6298.08,-482 6149.2,-316 6727.92,-316 6876.8,-482"/>
<text text-anchor="middle" x="6513" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="6513" y="-410.3" font-family="Arial" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="6513" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6513" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="6513" y="-365.3" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_0_attn_ln&#45;&gt;layer_0_gate_gpu_12 -->
<g id="edge14" class="edge">
<title>layer_0_attn_ln&#45;&gt;layer_0_gate_gpu_12</title>
<path fill="none" stroke="black" d="M6437.92,-525.27C6444.04,-515.05 6451.11,-503.26 6458.41,-491.08"/>
<polygon fill="black" stroke="black" points="6461.61,-492.55 6463.75,-482.17 6455.61,-488.95 6461.61,-492.55"/>
</g>
<!-- layer_0_gate_gpu_13 -->
<g id="node17" class="node">
<title>layer_0_gate_gpu_13</title>
<polygon fill="#d8bf0d" stroke="black" points="7622.8,-482 7044.08,-482 6895.2,-316 7473.92,-316 7622.8,-482"/>
<text text-anchor="middle" x="7259" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="7259" y="-410.3" font-family="Arial" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="7259" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7259" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="7259" y="-365.3" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_0_attn_ln&#45;&gt;layer_0_gate_gpu_13 -->
<g id="edge15" class="edge">
<title>layer_0_attn_ln&#45;&gt;layer_0_gate_gpu_13</title>
<path fill="none" stroke="black" d="M6599.11,-539.41C6686.24,-528.93 6791.96,-514.31 6886,-496 6928.87,-487.65 6974.14,-477.32 7017.8,-466.55"/>
<polygon fill="black" stroke="black" points="7018.81,-469.9 7027.67,-464.1 7017.12,-463.11 7018.81,-469.9"/>
</g>
<!-- layer_0_gate_gpu_14 -->
<g id="node18" class="node">
<title>layer_0_gate_gpu_14</title>
<polygon fill="#e0e0e0" stroke="black" points="8368.8,-482 7790.08,-482 7641.2,-316 8219.92,-316 8368.8,-482"/>
<text text-anchor="middle" x="8005" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="8005" y="-410.3" font-family="Arial" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="8005" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8005" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="8005" y="-365.3" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_0_attn_ln&#45;&gt;layer_0_gate_gpu_14 -->
<g id="edge16" class="edge">
<title>layer_0_attn_ln&#45;&gt;layer_0_gate_gpu_14</title>
<path fill="none" stroke="black" d="M6599.18,-553.63C6887.63,-545.12 7438.44,-525.58 7632,-496 7675.88,-489.29 7722.08,-479.61 7766.45,-468.95"/>
<polygon fill="black" stroke="black" points="7767.29,-472.34 7776.18,-466.58 7765.64,-465.54 7767.29,-472.34"/>
</g>
<!-- layer_0_gate_gpu_15 -->
<g id="node19" class="node">
<title>layer_0_gate_gpu_15</title>
<polygon fill="#fff8dc" stroke="black" points="9114.8,-482 8536.08,-482 8387.2,-316 8965.92,-316 9114.8,-482"/>
<text text-anchor="middle" x="8751" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="8751" y="-410.3" font-family="Arial" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="8751" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8751" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="8751" y="-365.3" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_0_attn_ln&#45;&gt;layer_0_gate_gpu_15 -->
<g id="edge17" class="edge">
<title>layer_0_attn_ln&#45;&gt;layer_0_gate_gpu_15</title>
<path fill="none" stroke="black" d="M6599.34,-557.81C7017.22,-555.39 8038.13,-544.55 8378,-496 8421.94,-489.72 8468.17,-480.25 8512.55,-469.65"/>
<polygon fill="black" stroke="black" points="8513.39,-473.05 8522.29,-467.3 8511.75,-466.25 8513.39,-473.05"/>
</g>
<!-- layer_0_output -->
<g id="node20" class="node">
<title>layer_0_output</title>
<polygon fill="#ffe4b5" stroke="black" points="9495,-433 9133,-433 9133,-365 9495,-365 9495,-433"/>
<text text-anchor="middle" x="9314" y="-417.8" font-family="Arial" font-size="14.00">Layer 1 Output</text>
<text text-anchor="middle" x="9314" y="-402.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9314" y="-387.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9314" y="-372.8" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_0_attn_ln&#45;&gt;layer_0_output -->
<g id="edge18" class="edge">
<title>layer_0_attn_ln&#45;&gt;layer_0_output</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6599.35,-558.95C7166.14,-559.7 8881.06,-556.86 9124,-496 9170.6,-484.33 9218.86,-459.76 9255.08,-438.4"/>
<polygon fill="black" stroke="black" points="9257.24,-441.19 9264.02,-433.05 9253.65,-435.18 9257.24,-441.19"/>
</g>
<!-- layer_0_expert_0_gpu_8 -->
<g id="node31" class="node">
<title>layer_0_expert_0_gpu_8</title>
<polygon fill="#ffb6c1" stroke="black" points="3914.5,-271 3529.5,-271 3529.5,-188 3914.5,-188 3914.5,-271"/>
<text text-anchor="middle" x="3722" y="-255.8" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="3722" y="-240.8" font-family="Arial" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="3722" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3722" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="3722" y="-195.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_0_gate_gpu_8&#45;&gt;layer_0_expert_0_gpu_8 -->
<g id="edge45" class="edge">
<title>layer_0_gate_gpu_8&#45;&gt;layer_0_expert_0_gpu_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3623.52,-315.97C3638.53,-302.94 3653.6,-289.86 3667.29,-277.98"/>
<polygon fill="black" stroke="black" points="3669.92,-280.34 3675.17,-271.14 3665.33,-275.05 3669.92,-280.34"/>
</g>
<!-- layer_0_expert_1_gpu_8 -->
<g id="node32" class="node">
<title>layer_0_expert_1_gpu_8</title>
<polygon fill="#ffb6c1" stroke="black" points="3511.5,-271 3126.5,-271 3126.5,-188 3511.5,-188 3511.5,-271"/>
<text text-anchor="middle" x="3319" y="-255.8" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3319" y="-240.8" font-family="Arial" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="3319" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3319" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="3319" y="-195.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_0_gate_gpu_8&#45;&gt;layer_0_expert_1_gpu_8 -->
<g id="edge46" class="edge">
<title>layer_0_gate_gpu_8&#45;&gt;layer_0_expert_1_gpu_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3426.15,-315.97C3409.67,-302.82 3393.11,-289.61 3378.11,-277.65"/>
<polygon fill="black" stroke="black" points="3379.95,-274.64 3369.95,-271.14 3375.59,-280.11 3379.95,-274.64"/>
</g>
<!-- layer_0_expert_2_gpu_9 -->
<g id="node33" class="node">
<title>layer_0_expert_2_gpu_9</title>
<polygon fill="#20b2aa" stroke="black" points="4720.5,-271 4335.5,-271 4335.5,-188 4720.5,-188 4720.5,-271"/>
<text text-anchor="middle" x="4528" y="-255.8" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4528" y="-240.8" font-family="Arial" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="4528" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4528" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="4528" y="-195.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_0_gate_gpu_9&#45;&gt;layer_0_expert_2_gpu_9 -->
<g id="edge47" class="edge">
<title>layer_0_gate_gpu_9&#45;&gt;layer_0_expert_2_gpu_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4398.91,-315.97C4419.13,-302.58 4439.45,-289.13 4457.78,-276.99"/>
<polygon fill="black" stroke="black" points="4460.21,-279.58 4466.62,-271.14 4456.35,-273.74 4460.21,-279.58"/>
</g>
<!-- layer_0_expert_3_gpu_9 -->
<g id="node34" class="node">
<title>layer_0_expert_3_gpu_9</title>
<polygon fill="#20b2aa" stroke="black" points="4317.5,-271 3932.5,-271 3932.5,-188 4317.5,-188 4317.5,-271"/>
<text text-anchor="middle" x="4125" y="-255.8" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="4125" y="-240.8" font-family="Arial" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="4125" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4125" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="4125" y="-195.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_0_gate_gpu_9&#45;&gt;layer_0_expert_3_gpu_9 -->
<g id="edge48" class="edge">
<title>layer_0_gate_gpu_9&#45;&gt;layer_0_expert_3_gpu_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4201.32,-315.72C4189.89,-302.96 4178.43,-290.16 4167.98,-278.49"/>
<polygon fill="black" stroke="black" points="4170.55,-276.12 4161.27,-271 4165.34,-280.79 4170.55,-276.12"/>
</g>
<!-- layer_0_expert_4_gpu_10 -->
<g id="node35" class="node">
<title>layer_0_expert_4_gpu_10</title>
<polygon fill="#b0c4de" stroke="black" points="5526.5,-271 5141.5,-271 5141.5,-188 5526.5,-188 5526.5,-271"/>
<text text-anchor="middle" x="5334" y="-255.8" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="5334" y="-240.8" font-family="Arial" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="5334" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5334" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="5334" y="-195.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_0_gate_gpu_10&#45;&gt;layer_0_expert_4_gpu_10 -->
<g id="edge49" class="edge">
<title>layer_0_gate_gpu_10&#45;&gt;layer_0_expert_4_gpu_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5174.29,-315.97C5200,-302.21 5225.82,-288.39 5248.98,-276"/>
<polygon fill="black" stroke="black" points="5250.89,-278.94 5258.06,-271.14 5247.59,-272.77 5250.89,-278.94"/>
</g>
<!-- layer_0_expert_5_gpu_10 -->
<g id="node36" class="node">
<title>layer_0_expert_5_gpu_10</title>
<polygon fill="#b0c4de" stroke="black" points="5123.5,-271 4738.5,-271 4738.5,-188 5123.5,-188 5123.5,-271"/>
<text text-anchor="middle" x="4931" y="-255.8" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4931" y="-240.8" font-family="Arial" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="4931" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4931" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="4931" y="-195.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_0_gate_gpu_10&#45;&gt;layer_0_expert_5_gpu_10 -->
<g id="edge50" class="edge">
<title>layer_0_gate_gpu_10&#45;&gt;layer_0_expert_5_gpu_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4976.79,-315.72C4970.2,-303.45 4963.58,-291.13 4957.51,-279.83"/>
<polygon fill="black" stroke="black" points="4960.58,-278.16 4952.76,-271 4954.41,-281.47 4960.58,-278.16"/>
</g>
<!-- layer_0_expert_6_gpu_11 -->
<g id="node37" class="node">
<title>layer_0_expert_6_gpu_11</title>
<polygon fill="#ffdead" stroke="black" points="6332.5,-271 5947.5,-271 5947.5,-188 6332.5,-188 6332.5,-271"/>
<text text-anchor="middle" x="6140" y="-255.8" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="6140" y="-240.8" font-family="Arial" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="6140" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6140" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="6140" y="-195.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_0_gate_gpu_11&#45;&gt;layer_0_expert_6_gpu_11 -->
<g id="edge51" class="edge">
<title>layer_0_gate_gpu_11&#45;&gt;layer_0_expert_6_gpu_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5949.68,-315.97C5980.85,-301.97 6012.17,-287.9 6040.15,-275.34"/>
<polygon fill="black" stroke="black" points="6041.81,-278.43 6049.5,-271.14 6038.95,-272.04 6041.81,-278.43"/>
</g>
<!-- layer_0_expert_7_gpu_11 -->
<g id="node38" class="node">
<title>layer_0_expert_7_gpu_11</title>
<polygon fill="#ffdead" stroke="black" points="5929.5,-271 5544.5,-271 5544.5,-188 5929.5,-188 5929.5,-271"/>
<text text-anchor="middle" x="5737" y="-255.8" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5737" y="-240.8" font-family="Arial" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="5737" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5737" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="5737" y="-195.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_0_gate_gpu_11&#45;&gt;layer_0_expert_7_gpu_11 -->
<g id="edge52" class="edge">
<title>layer_0_gate_gpu_11&#45;&gt;layer_0_expert_7_gpu_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5752.26,-315.72C5750.15,-303.94 5748.03,-292.11 5746.08,-281.18"/>
<polygon fill="black" stroke="black" points="5749.46,-280.23 5744.25,-271 5742.57,-281.46 5749.46,-280.23"/>
</g>
<!-- layer_0_expert_8_gpu_12 -->
<g id="node39" class="node">
<title>layer_0_expert_8_gpu_12</title>
<polygon fill="#9acd32" stroke="black" points="7138.5,-271 6753.5,-271 6753.5,-188 7138.5,-188 7138.5,-271"/>
<text text-anchor="middle" x="6946" y="-255.8" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="6946" y="-240.8" font-family="Arial" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="6946" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6946" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="6946" y="-195.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_0_gate_gpu_12&#45;&gt;layer_0_expert_8_gpu_12 -->
<g id="edge53" class="edge">
<title>layer_0_gate_gpu_12&#45;&gt;layer_0_expert_8_gpu_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6725.06,-315.97C6761.82,-301.75 6798.76,-287.46 6831.62,-274.75"/>
<polygon fill="black" stroke="black" points="6833.16,-277.9 6841.23,-271.03 6830.64,-271.37 6833.16,-277.9"/>
</g>
<!-- layer_0_expert_9_gpu_12 -->
<g id="node40" class="node">
<title>layer_0_expert_9_gpu_12</title>
<polygon fill="#9acd32" stroke="black" points="6735.5,-271 6350.5,-271 6350.5,-188 6735.5,-188 6735.5,-271"/>
<text text-anchor="middle" x="6543" y="-255.8" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="6543" y="-240.8" font-family="Arial" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="6543" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6543" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="6543" y="-195.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_0_gate_gpu_12&#45;&gt;layer_0_expert_9_gpu_12 -->
<g id="edge54" class="edge">
<title>layer_0_gate_gpu_12&#45;&gt;layer_0_expert_9_gpu_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6527.74,-315.72C6529.85,-303.94 6531.97,-292.11 6533.92,-281.18"/>
<polygon fill="black" stroke="black" points="6537.43,-281.46 6535.75,-271 6530.54,-280.23 6537.43,-281.46"/>
</g>
<!-- layer_0_expert_10_gpu_13 -->
<g id="node41" class="node">
<title>layer_0_expert_10_gpu_13</title>
<polygon fill="#d8bf0d" stroke="black" points="7944.5,-271 7559.5,-271 7559.5,-188 7944.5,-188 7944.5,-271"/>
<text text-anchor="middle" x="7752" y="-255.8" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="7752" y="-240.8" font-family="Arial" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="7752" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7752" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="7752" y="-195.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_0_gate_gpu_13&#45;&gt;layer_0_expert_10_gpu_13 -->
<g id="edge55" class="edge">
<title>layer_0_gate_gpu_13&#45;&gt;layer_0_expert_10_gpu_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7480.69,-323.51C7504.1,-315.59 7527.54,-307.64 7550,-300 7574.28,-291.73 7600.19,-282.86 7625.07,-274.31"/>
<polygon fill="black" stroke="black" points="7626.23,-277.62 7634.55,-271.06 7623.95,-271 7626.23,-277.62"/>
</g>
<!-- layer_0_expert_11_gpu_13 -->
<g id="node42" class="node">
<title>layer_0_expert_11_gpu_13</title>
<polygon fill="#d8bf0d" stroke="black" points="7541.5,-271 7156.5,-271 7156.5,-188 7541.5,-188 7541.5,-271"/>
<text text-anchor="middle" x="7349" y="-255.8" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="7349" y="-240.8" font-family="Arial" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="7349" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7349" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="7349" y="-195.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_0_gate_gpu_13&#45;&gt;layer_0_expert_11_gpu_13 -->
<g id="edge56" class="edge">
<title>layer_0_gate_gpu_13&#45;&gt;layer_0_expert_11_gpu_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7303.21,-315.72C7309.8,-303.45 7316.42,-291.13 7322.49,-279.83"/>
<polygon fill="black" stroke="black" points="7325.59,-281.47 7327.24,-271 7319.42,-278.16 7325.59,-281.47"/>
</g>
<!-- layer_0_expert_12_gpu_14 -->
<g id="node43" class="node">
<title>layer_0_expert_12_gpu_14</title>
<polygon fill="#e0e0e0" stroke="black" points="8750.5,-271 8365.5,-271 8365.5,-188 8750.5,-188 8750.5,-271"/>
<text text-anchor="middle" x="8558" y="-255.8" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="8558" y="-240.8" font-family="Arial" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="8558" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8558" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="8558" y="-195.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_0_gate_gpu_14&#45;&gt;layer_0_expert_12_gpu_14 -->
<g id="edge57" class="edge">
<title>layer_0_gate_gpu_14&#45;&gt;layer_0_expert_12_gpu_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8237.33,-335.22C8277.04,-323.9 8317.79,-311.9 8356,-300 8381.55,-292.05 8408.73,-283.06 8434.61,-274.25"/>
<polygon fill="black" stroke="black" points="8435.75,-277.56 8444.08,-271.01 8433.49,-270.93 8435.75,-277.56"/>
</g>
<!-- layer_0_expert_13_gpu_14 -->
<g id="node44" class="node">
<title>layer_0_expert_13_gpu_14</title>
<polygon fill="#e0e0e0" stroke="black" points="8347.5,-271 7962.5,-271 7962.5,-188 8347.5,-188 8347.5,-271"/>
<text text-anchor="middle" x="8155" y="-255.8" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="8155" y="-240.8" font-family="Arial" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="8155" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8155" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="8155" y="-195.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_0_gate_gpu_14&#45;&gt;layer_0_expert_13_gpu_14 -->
<g id="edge58" class="edge">
<title>layer_0_gate_gpu_14&#45;&gt;layer_0_expert_13_gpu_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8078.68,-315.72C8090.11,-302.96 8101.57,-290.16 8112.02,-278.49"/>
<polygon fill="black" stroke="black" points="8114.66,-280.79 8118.73,-271 8109.45,-276.12 8114.66,-280.79"/>
</g>
<!-- layer_0_expert_14_gpu_15 -->
<g id="node45" class="node">
<title>layer_0_expert_14_gpu_15</title>
<polygon fill="#fff8dc" stroke="black" points="9556.5,-271 9171.5,-271 9171.5,-188 9556.5,-188 9556.5,-271"/>
<text text-anchor="middle" x="9364" y="-255.8" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="9364" y="-240.8" font-family="Arial" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="9364" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9364" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="9364" y="-195.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_0_gate_gpu_15&#45;&gt;layer_0_expert_14_gpu_15 -->
<g id="edge59" class="edge">
<title>layer_0_gate_gpu_15&#45;&gt;layer_0_expert_14_gpu_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8987.54,-339.82C9032.78,-329.01 9079.81,-317.98 9124,-308 9140.84,-304.2 9145.36,-304.59 9162,-300 9189.02,-292.54 9217.7,-283.42 9244.69,-274.28"/>
<polygon fill="black" stroke="black" points="9245.83,-277.59 9254.17,-271.05 9243.57,-270.97 9245.83,-277.59"/>
</g>
<!-- layer_0_expert_15_gpu_15 -->
<g id="node46" class="node">
<title>layer_0_expert_15_gpu_15</title>
<polygon fill="#fff8dc" stroke="black" points="9153.5,-271 8768.5,-271 8768.5,-188 9153.5,-188 9153.5,-271"/>
<text text-anchor="middle" x="8961" y="-255.8" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="8961" y="-240.8" font-family="Arial" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="8961" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8961" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="8961" y="-195.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_0_gate_gpu_15&#45;&gt;layer_0_expert_15_gpu_15 -->
<g id="edge60" class="edge">
<title>layer_0_gate_gpu_15&#45;&gt;layer_0_expert_15_gpu_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8853.85,-315.97C8870.33,-302.82 8886.89,-289.61 8901.89,-277.65"/>
<polygon fill="black" stroke="black" points="8904.41,-280.11 8910.05,-271.14 8900.05,-274.64 8904.41,-280.11"/>
</g>
<!-- layer_0_attn_gpu_0 -->
<g id="node22" class="node">
<title>layer_0_attn_gpu_0</title>
<polygon fill="#ffe4e1" stroke="black" points="382,-271 16,-271 16,-188 382,-188 382,-271"/>
<text text-anchor="middle" x="199" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="199" y="-240.8" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="199" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="199" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="199" y="-195.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_kv_reduce&#45;&gt;layer_0_attn_gpu_0 -->
<g id="edge27" class="edge">
<title>layer_0_kv_reduce&#45;&gt;layer_0_attn_gpu_0</title>
<path fill="none" stroke="black" d="M2220.36,-394.89C1671.29,-388.18 729.14,-366.96 391,-300 361.79,-294.22 331.07,-284.74 302.99,-274.63"/>
<polygon fill="black" stroke="black" points="304.16,-271.33 293.57,-271.18 301.76,-277.9 304.16,-271.33"/>
</g>
<!-- layer_0_attn_gpu_1 -->
<g id="node23" class="node">
<title>layer_0_attn_gpu_1</title>
<polygon fill="#e6e6fa" stroke="black" points="766,-271 400,-271 400,-188 766,-188 766,-271"/>
<text text-anchor="middle" x="583" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="583" y="-240.8" font-family="Arial" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="583" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="583" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="583" y="-195.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_0_kv_reduce&#45;&gt;layer_0_attn_gpu_1 -->
<g id="edge28" class="edge">
<title>layer_0_kv_reduce&#45;&gt;layer_0_attn_gpu_1</title>
<path fill="none" stroke="black" d="M2245.77,-390.96C1785.91,-380.24 1046.02,-354.94 775,-300 746.1,-294.14 715.7,-284.75 687.84,-274.74"/>
<polygon fill="black" stroke="black" points="688.69,-271.33 678.1,-271.18 686.29,-277.9 688.69,-271.33"/>
</g>
<!-- layer_0_attn_gpu_2 -->
<g id="node24" class="node">
<title>layer_0_attn_gpu_2</title>
<polygon fill="#f0e68c" stroke="black" points="1150,-271 784,-271 784,-188 1150,-188 1150,-271"/>
<text text-anchor="middle" x="967" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="967" y="-240.8" font-family="Arial" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="967" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="967" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="967" y="-195.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_0_kv_reduce&#45;&gt;layer_0_attn_gpu_2 -->
<g id="edge29" class="edge">
<title>layer_0_kv_reduce&#45;&gt;layer_0_attn_gpu_2</title>
<path fill="none" stroke="black" d="M2278.13,-385.87C1911.77,-371.27 1364.76,-343.18 1159,-300 1130.29,-293.98 1100.08,-284.58 1072.34,-274.63"/>
<polygon fill="black" stroke="black" points="1073.24,-271.23 1062.64,-271.09 1070.84,-277.81 1073.24,-271.23"/>
</g>
<!-- layer_0_attn_gpu_3 -->
<g id="node25" class="node">
<title>layer_0_attn_gpu_3</title>
<polygon fill="#98fb98" stroke="black" points="1534,-271 1168,-271 1168,-188 1534,-188 1534,-271"/>
<text text-anchor="middle" x="1351" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1351" y="-240.8" font-family="Arial" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1351" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1351" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1351" y="-195.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_0_kv_reduce&#45;&gt;layer_0_attn_gpu_3 -->
<g id="edge30" class="edge">
<title>layer_0_kv_reduce&#45;&gt;layer_0_attn_gpu_3</title>
<path fill="none" stroke="black" d="M2262.28,-388.34C2049.79,-376.94 1779.04,-352.42 1543,-300 1514.67,-293.71 1484.83,-284.34 1457.34,-274.5"/>
<polygon fill="black" stroke="black" points="1458.32,-271.13 1447.73,-271 1455.93,-277.71 1458.32,-271.13"/>
</g>
<!-- layer_0_attn_gpu_4 -->
<g id="node26" class="node">
<title>layer_0_attn_gpu_4</title>
<polygon fill="#87ceeb" stroke="black" points="1918,-271 1552,-271 1552,-188 1918,-188 1918,-271"/>
<text text-anchor="middle" x="1735" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1735" y="-240.8" font-family="Arial" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="1735" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1735" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1735" y="-195.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_0_kv_reduce&#45;&gt;layer_0_attn_gpu_4 -->
<g id="edge31" class="edge">
<title>layer_0_kv_reduce&#45;&gt;layer_0_attn_gpu_4</title>
<path fill="none" stroke="black" d="M2358.3,-373.43C2226.66,-358.2 2067.34,-334.75 1927,-300 1899.88,-293.28 1871.26,-284.12 1844.63,-274.64"/>
<polygon fill="black" stroke="black" points="1845.51,-271.24 1834.91,-271.14 1843.14,-277.82 1845.51,-271.24"/>
</g>
<!-- layer_0_attn_gpu_5 -->
<g id="node27" class="node">
<title>layer_0_attn_gpu_5</title>
<polygon fill="#dda0dd" stroke="black" points="2302,-271 1936,-271 1936,-188 2302,-188 2302,-271"/>
<text text-anchor="middle" x="2119" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2119" y="-240.8" font-family="Arial" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2119" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2119" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2119" y="-195.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_0_kv_reduce&#45;&gt;layer_0_attn_gpu_5 -->
<g id="edge32" class="edge">
<title>layer_0_kv_reduce&#45;&gt;layer_0_attn_gpu_5</title>
<path fill="none" stroke="black" d="M2482.47,-354.07C2428.27,-337.7 2366.69,-318.57 2311,-300 2287.17,-292.06 2261.83,-283.19 2237.64,-274.51"/>
<polygon fill="black" stroke="black" points="2238.66,-271.16 2228.07,-271.07 2236.29,-277.75 2238.66,-271.16"/>
</g>
<!-- layer_0_attn_gpu_6 -->
<g id="node28" class="node">
<title>layer_0_attn_gpu_6</title>
<polygon fill="#f4a460" stroke="black" points="2686,-271 2320,-271 2320,-188 2686,-188 2686,-271"/>
<text text-anchor="middle" x="2503" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2503" y="-240.8" font-family="Arial" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="2503" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2503" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2503" y="-195.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_0_kv_reduce&#45;&gt;layer_0_attn_gpu_6 -->
<g id="edge33" class="edge">
<title>layer_0_kv_reduce&#45;&gt;layer_0_attn_gpu_6</title>
<path fill="none" stroke="black" d="M2585.79,-338C2571,-318.79 2554.8,-297.76 2540.69,-279.44"/>
<polygon fill="black" stroke="black" points="2543.24,-277.01 2534.36,-271.22 2537.69,-281.28 2543.24,-277.01"/>
</g>
<!-- layer_0_attn_gpu_7 -->
<g id="node29" class="node">
<title>layer_0_attn_gpu_7</title>
<polygon fill="#d3d3d3" stroke="black" points="3070,-271 2704,-271 2704,-188 3070,-188 3070,-271"/>
<text text-anchor="middle" x="2887" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2887" y="-240.8" font-family="Arial" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="2887" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2887" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2887" y="-195.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_0_kv_reduce&#45;&gt;layer_0_attn_gpu_7 -->
<g id="edge34" class="edge">
<title>layer_0_kv_reduce&#45;&gt;layer_0_attn_gpu_7</title>
<path fill="none" stroke="black" d="M2714.79,-343.62C2747.62,-322.05 2784.99,-297.51 2816.5,-276.81"/>
<polygon fill="black" stroke="black" points="2818.79,-279.49 2825.22,-271.08 2814.94,-273.64 2818.79,-279.49"/>
</g>
<!-- layer_0_attn_agg -->
<g id="node30" class="node">
<title>layer_0_attn_agg</title>
<polygon fill="lightcoral" stroke="black" points="1735,-152 1297,-84 1735,-16 2173,-84 1735,-152"/>
<text text-anchor="middle" x="1735" y="-102.8" font-family="Arial" font-size="14.00">Attention Output All&#45;Reduce</text>
<text text-anchor="middle" x="1735" y="-87.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128] from 8 GPUs</text>
<text text-anchor="middle" x="1735" y="-72.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1735" y="-57.8" font-family="Arial" font-size="14.00">GPU: All 0&#45;7</text>
</g>
<!-- layer_0_attn_gpu_0&#45;&gt;layer_0_attn_agg -->
<g id="edge35" class="edge">
<title>layer_0_attn_gpu_0&#45;&gt;layer_0_attn_agg</title>
<path fill="none" stroke="black" d="M382.08,-189.32C385.08,-188.86 388.05,-188.42 391,-188 725.52,-140.11 1110.28,-113.48 1382.17,-99.35"/>
<polygon fill="black" stroke="black" points="1382.39,-102.85 1392.2,-98.84 1382.03,-95.86 1382.39,-102.85"/>
</g>
<!-- layer_0_attn_gpu_1&#45;&gt;layer_0_attn_agg -->
<g id="edge36" class="edge">
<title>layer_0_attn_gpu_1&#45;&gt;layer_0_attn_agg</title>
<path fill="none" stroke="black" d="M766.1,-189.45C769.09,-188.95 772.06,-188.47 775,-188 997.11,-152.75 1250.08,-126.16 1440.56,-108.83"/>
<polygon fill="black" stroke="black" points="1441.08,-112.3 1450.73,-107.91 1440.45,-105.33 1441.08,-112.3"/>
</g>
<!-- layer_0_attn_gpu_2&#45;&gt;layer_0_attn_agg -->
<g id="edge37" class="edge">
<title>layer_0_attn_gpu_2&#45;&gt;layer_0_attn_agg</title>
<path fill="none" stroke="black" d="M1150.15,-189.73C1153.12,-189.15 1156.07,-188.57 1159,-188 1277.93,-164.83 1411.08,-140.89 1519.38,-121.93"/>
<polygon fill="black" stroke="black" points="1520.2,-125.34 1529.44,-120.17 1518.99,-118.44 1520.2,-125.34"/>
</g>
<!-- layer_0_attn_gpu_3&#45;&gt;layer_0_attn_agg -->
<g id="edge38" class="edge">
<title>layer_0_attn_gpu_3&#45;&gt;layer_0_attn_agg</title>
<path fill="none" stroke="black" d="M1459.5,-187.95C1502.76,-171.79 1553.05,-153 1598.72,-135.93"/>
<polygon fill="black" stroke="black" points="1599.95,-139.2 1608.1,-132.42 1597.5,-132.65 1599.95,-139.2"/>
</g>
<!-- layer_0_attn_gpu_4&#45;&gt;layer_0_attn_agg -->
<g id="edge39" class="edge">
<title>layer_0_attn_gpu_4&#45;&gt;layer_0_attn_agg</title>
<path fill="none" stroke="black" d="M1735,-187.76C1735,-179.78 1735,-171.17 1735,-162.44"/>
<polygon fill="black" stroke="black" points="1738.5,-162.17 1735,-152.17 1731.5,-162.17 1738.5,-162.17"/>
</g>
<!-- layer_0_attn_gpu_5&#45;&gt;layer_0_attn_agg -->
<g id="edge40" class="edge">
<title>layer_0_attn_gpu_5&#45;&gt;layer_0_attn_agg</title>
<path fill="none" stroke="black" d="M2010.5,-187.95C1967.24,-171.79 1916.95,-153 1871.28,-135.93"/>
<polygon fill="black" stroke="black" points="1872.5,-132.65 1861.9,-132.42 1870.05,-139.2 1872.5,-132.65"/>
</g>
<!-- layer_0_attn_gpu_6&#45;&gt;layer_0_attn_agg -->
<g id="edge41" class="edge">
<title>layer_0_attn_gpu_6&#45;&gt;layer_0_attn_agg</title>
<path fill="none" stroke="black" d="M2319.85,-189.73C2316.88,-189.15 2313.93,-188.57 2311,-188 2192.07,-164.83 2058.92,-140.89 1950.62,-121.93"/>
<polygon fill="black" stroke="black" points="1951.01,-118.44 1940.56,-120.17 1949.8,-125.34 1951.01,-118.44"/>
</g>
<!-- layer_0_attn_gpu_7&#45;&gt;layer_0_attn_agg -->
<g id="edge42" class="edge">
<title>layer_0_attn_gpu_7&#45;&gt;layer_0_attn_agg</title>
<path fill="none" stroke="black" d="M2703.9,-189.45C2700.91,-188.95 2697.94,-188.47 2695,-188 2472.89,-152.75 2219.92,-126.16 2029.44,-108.83"/>
<polygon fill="black" stroke="black" points="2029.55,-105.33 2019.27,-107.91 2028.92,-112.3 2029.55,-105.33"/>
</g>
<!-- layer_0_attn_agg&#45;&gt;layer_0_attn_ln -->
<g id="edge43" class="edge">
<title>layer_0_attn_agg&#45;&gt;layer_0_attn_ln</title>
<path fill="none" stroke="black" d="M2122.29,-91.9C2493.2,-102.12 3006.97,-127.19 3079,-188 3132.91,-233.51 3100.55,-452.38 3156,-496 3189.54,-522.38 6185.58,-513.38 6228,-518 6241.36,-519.46 6255.15,-521.44 6268.94,-523.75"/>
<polygon fill="black" stroke="black" points="6268.51,-527.23 6278.96,-525.49 6269.71,-520.33 6268.51,-527.23"/>
</g>
<!-- layer_0_expert_agg -->
<g id="node47" class="node">
<title>layer_0_expert_agg</title>
<polygon fill="yellow" stroke="black" points="7032.2,-152 6254,-152 6053.8,-16 6832,-16 7032.2,-152"/>
<text text-anchor="middle" x="6543" y="-102.8" font-family="Arial" font-size="14.00">Expert Aggregation (Top&#45;2)</text>
<text text-anchor="middle" x="6543" y="-87.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, expert_hidden=16384] from 16 experts</text>
<text text-anchor="middle" x="6543" y="-72.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6543" y="-57.8" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_0_expert_0_gpu_8&#45;&gt;layer_0_expert_agg -->
<g id="edge61" class="edge">
<title>layer_0_expert_0_gpu_8&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M3914.73,-189.03C3917.5,-188.67 3920.26,-188.33 3923,-188 4343.2,-137.73 5535.11,-106.15 6156.07,-92.63"/>
<polygon fill="black" stroke="black" points="6156.16,-96.13 6166.08,-92.41 6156.01,-89.13 6156.16,-96.13"/>
</g>
<!-- layer_0_expert_1_gpu_8&#45;&gt;layer_0_expert_agg -->
<g id="edge62" class="edge">
<title>layer_0_expert_1_gpu_8&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M3511.73,-189.01C3514.5,-188.66 3517.26,-188.32 3520,-188 4017.86,-129.76 5454.31,-101.1 6152.62,-90.3"/>
<polygon fill="black" stroke="black" points="6152.9,-93.79 6162.84,-90.14 6152.79,-86.79 6152.9,-93.79"/>
</g>
<!-- layer_0_expert_2_gpu_9&#45;&gt;layer_0_expert_agg -->
<g id="edge63" class="edge">
<title>layer_0_expert_2_gpu_9&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M4720.74,-189.1C4723.51,-188.72 4726.26,-188.35 4729,-188 5217.7,-125.21 5785.37,-100.7 6153.71,-91.13"/>
<polygon fill="black" stroke="black" points="6153.82,-94.63 6163.73,-90.87 6153.64,-87.63 6153.82,-94.63"/>
</g>
<!-- layer_0_expert_3_gpu_9&#45;&gt;layer_0_expert_agg -->
<g id="edge64" class="edge">
<title>layer_0_expert_3_gpu_9&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M4317.73,-189.06C4320.51,-188.69 4323.26,-188.34 4326,-188 4959.09,-109.97 5700.51,-89.79 6145.39,-85.27"/>
<polygon fill="black" stroke="black" points="6145.55,-88.77 6155.51,-85.17 6145.48,-81.77 6145.55,-88.77"/>
</g>
<!-- layer_0_expert_4_gpu_10&#45;&gt;layer_0_expert_agg -->
<g id="edge65" class="edge">
<title>layer_0_expert_4_gpu_10&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M5526.76,-189.27C5529.53,-188.84 5532.27,-188.41 5535,-188 5749.87,-155.45 5992.1,-130.33 6185.24,-113.05"/>
<polygon fill="black" stroke="black" points="6185.62,-116.53 6195.27,-112.16 6185,-109.56 6185.62,-116.53"/>
</g>
<!-- layer_0_expert_5_gpu_10&#45;&gt;layer_0_expert_agg -->
<g id="edge66" class="edge">
<title>layer_0_expert_5_gpu_10&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M5123.75,-189.16C5126.51,-188.76 5129.27,-188.37 5132,-188 5480.58,-140.35 5880.82,-113.78 6165.78,-99.61"/>
<polygon fill="black" stroke="black" points="6166.06,-103.1 6175.87,-99.11 6165.71,-96.11 6166.06,-103.1"/>
</g>
<!-- layer_0_expert_6_gpu_11&#45;&gt;layer_0_expert_agg -->
<g id="edge67" class="edge">
<title>layer_0_expert_6_gpu_11&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M6253.87,-187.95C6282.34,-177.81 6313.72,-166.64 6344.98,-155.51"/>
<polygon fill="black" stroke="black" points="6346.43,-158.71 6354.68,-152.06 6344.09,-152.11 6346.43,-158.71"/>
</g>
<!-- layer_0_expert_7_gpu_11&#45;&gt;layer_0_expert_agg -->
<g id="edge68" class="edge">
<title>layer_0_expert_7_gpu_11&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M5929.54,-189.58C5932.38,-189.05 5935.2,-188.52 5938,-188 6029.59,-170.98 6129.2,-153.57 6220.66,-138.02"/>
<polygon fill="black" stroke="black" points="6221.35,-141.45 6230.62,-136.33 6220.18,-134.55 6221.35,-141.45"/>
</g>
<!-- layer_0_expert_8_gpu_12&#45;&gt;layer_0_expert_agg -->
<g id="edge69" class="edge">
<title>layer_0_expert_8_gpu_12&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M6832.13,-187.95C6803.66,-177.81 6772.28,-166.64 6741.02,-155.51"/>
<polygon fill="black" stroke="black" points="6741.91,-152.11 6731.32,-152.06 6739.57,-158.71 6741.91,-152.11"/>
</g>
<!-- layer_0_expert_9_gpu_12&#45;&gt;layer_0_expert_agg -->
<g id="edge70" class="edge">
<title>layer_0_expert_9_gpu_12&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M6543,-187.76C6543,-179.78 6543,-171.17 6543,-162.44"/>
<polygon fill="black" stroke="black" points="6546.5,-162.17 6543,-152.17 6539.5,-162.17 6546.5,-162.17"/>
</g>
<!-- layer_0_expert_10_gpu_13&#45;&gt;layer_0_expert_agg -->
<g id="edge71" class="edge">
<title>layer_0_expert_10_gpu_13&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M7559.35,-189.45C7556.21,-188.95 7553.09,-188.47 7550,-188 7369.85,-160.79 7170.45,-138.73 6996.95,-122.1"/>
<polygon fill="black" stroke="black" points="6997.16,-118.61 6986.88,-121.14 6996.5,-125.58 6997.16,-118.61"/>
</g>
<!-- layer_0_expert_11_gpu_13&#45;&gt;layer_0_expert_agg -->
<g id="edge72" class="edge">
<title>layer_0_expert_11_gpu_13&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M7156.3,-189.74C7153.18,-189.15 7150.08,-188.57 7147,-188 7085.2,-176.54 7019.74,-164.88 6955.62,-153.72"/>
<polygon fill="black" stroke="black" points="6956.2,-150.27 6945.75,-152.01 6955,-157.17 6956.2,-150.27"/>
</g>
<!-- layer_0_expert_12_gpu_14&#45;&gt;layer_0_expert_agg -->
<g id="edge73" class="edge">
<title>layer_0_expert_12_gpu_14&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M8365.38,-189.25C8362.23,-188.81 8359.1,-188.4 8356,-188 7876.84,-126.67 7321.75,-101.85 6953.3,-91.82"/>
<polygon fill="black" stroke="black" points="6953.36,-88.32 6943.27,-91.55 6953.17,-95.31 6953.36,-88.32"/>
</g>
<!-- layer_0_expert_13_gpu_14&#45;&gt;layer_0_expert_agg -->
<g id="edge74" class="edge">
<title>layer_0_expert_13_gpu_14&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M7962.37,-189.32C7959.23,-188.86 7956.1,-188.42 7953,-188 7624.04,-143.19 7249.06,-116.97 6968.53,-102.22"/>
<polygon fill="black" stroke="black" points="6968.34,-98.7 6958.17,-101.67 6967.98,-105.69 6968.34,-98.7"/>
</g>
<!-- layer_0_expert_14_gpu_15&#45;&gt;layer_0_expert_agg -->
<g id="edge75" class="edge">
<title>layer_0_expert_14_gpu_15&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M9171.39,-189.17C9168.24,-188.76 9165.11,-188.37 9162,-188 8747.69,-138.64 7583.02,-107.14 6955.62,-93.25"/>
<polygon fill="black" stroke="black" points="6955.58,-89.74 6945.5,-93.02 6955.42,-96.74 6955.58,-89.74"/>
</g>
<!-- layer_0_expert_15_gpu_15&#45;&gt;layer_0_expert_agg -->
<g id="edge76" class="edge">
<title>layer_0_expert_15_gpu_15&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M8768.38,-189.21C8765.24,-188.78 8762.11,-188.38 8759,-188 8128.05,-110.54 7389.53,-90.15 6944.43,-85.43"/>
<polygon fill="black" stroke="black" points="6944.33,-81.93 6934.29,-85.33 6944.26,-88.93 6944.33,-81.93"/>
</g>
<!-- layer_0_expert_agg&#45;&gt;layer_0_output -->
<g id="edge77" class="edge">
<title>layer_0_expert_agg&#45;&gt;layer_0_output</title>
<path fill="none" stroke="black" d="M6932.46,-84.08C7728.5,-84.13 9475.02,-94.9 9565,-188 9599.59,-223.79 9593.08,-258.9 9565,-300 9546.59,-326.96 9519.56,-346.5 9489.99,-360.66"/>
<polygon fill="black" stroke="black" points="9488.38,-357.55 9480.74,-364.89 9491.29,-363.92 9488.38,-357.55"/>
</g>
<!-- layer_1_output -->
<g id="node48" class="node">
<title>layer_1_output</title>
<polygon fill="#ffe4b5" stroke="black" points="16196,-881.48 15834,-881.48 15834,-813.48 16196,-813.48 16196,-881.48"/>
<text text-anchor="middle" x="16015" y="-866.28" font-family="Arial" font-size="14.00">Layer 2 Output</text>
<text text-anchor="middle" x="16015" y="-851.28" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16015" y="-836.28" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16015" y="-821.28" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_1_distribute -->
<g id="node49" class="node">
<title>layer_1_distribute</title>
<polygon fill="lightcoral" stroke="black" points="14673,-773 14230,-705 14673,-637 15116,-705 14673,-773"/>
<text text-anchor="middle" x="14673" y="-723.8" font-family="Arial" font-size="14.00">Layer 2 Input Distribution</text>
<text text-anchor="middle" x="14673" y="-708.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14673" y="-693.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, hidden_dim=4096] replicated 8x</text>
<text text-anchor="middle" x="14673" y="-678.8" font-family="Arial" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- layer_1_output&#45;&gt;layer_1_distribute -->
<g id="edge78" class="edge">
<title>layer_1_output&#45;&gt;layer_1_distribute</title>
<path fill="none" stroke="black" d="M15833.66,-827.49C15604.35,-803.49 15207.56,-761.96 14942.67,-734.23"/>
<polygon fill="black" stroke="black" points="14942.83,-730.73 14932.52,-733.17 14942.1,-737.69 14942.83,-730.73"/>
</g>
<!-- layer_1_qkv_gpu_0 -->
<g id="node50" class="node">
<title>layer_1_qkv_gpu_0</title>
<polygon fill="#ffe4e1" stroke="black" points="13128,-601 12762,-601 12762,-518 13128,-518 13128,-601"/>
<text text-anchor="middle" x="12945" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12945" y="-570.8" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="12945" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12945" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12945" y="-525.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_1_distribute&#45;&gt;layer_1_qkv_gpu_0 -->
<g id="edge79" class="edge">
<title>layer_1_distribute&#45;&gt;layer_1_qkv_gpu_0</title>
<path fill="none" stroke="black" d="M14302.57,-693.79C13993.12,-681.79 13540.55,-656.19 13138.17,-601.11"/>
<polygon fill="black" stroke="black" points="13138.46,-597.61 13128.08,-599.72 13137.51,-604.55 13138.46,-597.61"/>
</g>
<!-- layer_1_qkv_gpu_1 -->
<g id="node51" class="node">
<title>layer_1_qkv_gpu_1</title>
<polygon fill="#e6e6fa" stroke="black" points="13512,-601 13146,-601 13146,-518 13512,-518 13512,-601"/>
<text text-anchor="middle" x="13329" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13329" y="-570.8" font-family="Arial" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="13329" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13329" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13329" y="-525.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_1_distribute&#45;&gt;layer_1_qkv_gpu_1 -->
<g id="edge80" class="edge">
<title>layer_1_distribute&#45;&gt;layer_1_qkv_gpu_1</title>
<path fill="none" stroke="black" d="M14355.2,-685.77C14125.9,-670.17 13809.03,-643.6 13522.28,-601.14"/>
<polygon fill="black" stroke="black" points="13522.5,-597.64 13512.09,-599.63 13521.47,-604.56 13522.5,-597.64"/>
</g>
<!-- layer_1_qkv_gpu_2 -->
<g id="node52" class="node">
<title>layer_1_qkv_gpu_2</title>
<polygon fill="#f0e68c" stroke="black" points="13896,-601 13530,-601 13530,-518 13896,-518 13896,-601"/>
<text text-anchor="middle" x="13713" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13713" y="-570.8" font-family="Arial" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="13713" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13713" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13713" y="-525.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_1_distribute&#45;&gt;layer_1_qkv_gpu_2 -->
<g id="edge81" class="edge">
<title>layer_1_distribute&#45;&gt;layer_1_qkv_gpu_2</title>
<path fill="none" stroke="black" d="M14423.25,-675.29C14275.49,-657.13 14084.58,-631.66 13906.22,-601.18"/>
<polygon fill="black" stroke="black" points="13906.57,-597.69 13896.12,-599.45 13905.39,-604.59 13906.57,-597.69"/>
</g>
<!-- layer_1_qkv_gpu_3 -->
<g id="node53" class="node">
<title>layer_1_qkv_gpu_3</title>
<polygon fill="#98fb98" stroke="black" points="14280,-601 13914,-601 13914,-518 14280,-518 14280,-601"/>
<text text-anchor="middle" x="14097" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14097" y="-570.8" font-family="Arial" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="14097" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14097" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14097" y="-525.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_1_distribute&#45;&gt;layer_1_qkv_gpu_3 -->
<g id="edge82" class="edge">
<title>layer_1_distribute&#45;&gt;layer_1_qkv_gpu_3</title>
<path fill="none" stroke="black" d="M14506.4,-662.49C14432.15,-644 14344.72,-622.22 14269.77,-603.54"/>
<polygon fill="black" stroke="black" points="14270.3,-600.07 14259.75,-601.05 14268.61,-606.86 14270.3,-600.07"/>
</g>
<!-- layer_1_qkv_gpu_4 -->
<g id="node54" class="node">
<title>layer_1_qkv_gpu_4</title>
<polygon fill="#87ceeb" stroke="black" points="14664,-601 14298,-601 14298,-518 14664,-518 14664,-601"/>
<text text-anchor="middle" x="14481" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14481" y="-570.8" font-family="Arial" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="14481" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14481" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14481" y="-525.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_1_distribute&#45;&gt;layer_1_qkv_gpu_4 -->
<g id="edge83" class="edge">
<title>layer_1_distribute&#45;&gt;layer_1_qkv_gpu_4</title>
<path fill="none" stroke="black" d="M14598.49,-648.31C14580.38,-634.77 14561.18,-620.43 14543.68,-607.34"/>
<polygon fill="black" stroke="black" points="14545.33,-604.21 14535.23,-601.03 14541.14,-609.82 14545.33,-604.21"/>
</g>
<!-- layer_1_qkv_gpu_5 -->
<g id="node55" class="node">
<title>layer_1_qkv_gpu_5</title>
<polygon fill="#dda0dd" stroke="black" points="15048,-601 14682,-601 14682,-518 15048,-518 15048,-601"/>
<text text-anchor="middle" x="14865" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14865" y="-570.8" font-family="Arial" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="14865" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14865" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14865" y="-525.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_1_distribute&#45;&gt;layer_1_qkv_gpu_5 -->
<g id="edge84" class="edge">
<title>layer_1_distribute&#45;&gt;layer_1_qkv_gpu_5</title>
<path fill="none" stroke="black" d="M14747.51,-648.31C14765.62,-634.77 14784.82,-620.43 14802.32,-607.34"/>
<polygon fill="black" stroke="black" points="14804.86,-609.82 14810.77,-601.03 14800.67,-604.21 14804.86,-609.82"/>
</g>
<!-- layer_1_qkv_gpu_6 -->
<g id="node56" class="node">
<title>layer_1_qkv_gpu_6</title>
<polygon fill="#f4a460" stroke="black" points="15432,-601 15066,-601 15066,-518 15432,-518 15432,-601"/>
<text text-anchor="middle" x="15249" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15249" y="-570.8" font-family="Arial" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="15249" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15249" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15249" y="-525.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_1_distribute&#45;&gt;layer_1_qkv_gpu_6 -->
<g id="edge85" class="edge">
<title>layer_1_distribute&#45;&gt;layer_1_qkv_gpu_6</title>
<path fill="none" stroke="black" d="M14839.6,-662.49C14913.85,-644 15001.28,-622.22 15076.23,-603.54"/>
<polygon fill="black" stroke="black" points="15077.39,-606.86 15086.25,-601.05 15075.7,-600.07 15077.39,-606.86"/>
</g>
<!-- layer_1_qkv_gpu_7 -->
<g id="node57" class="node">
<title>layer_1_qkv_gpu_7</title>
<polygon fill="#d3d3d3" stroke="black" points="15816,-601 15450,-601 15450,-518 15816,-518 15816,-601"/>
<text text-anchor="middle" x="15633" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15633" y="-570.8" font-family="Arial" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="15633" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15633" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15633" y="-525.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_1_distribute&#45;&gt;layer_1_qkv_gpu_7 -->
<g id="edge86" class="edge">
<title>layer_1_distribute&#45;&gt;layer_1_qkv_gpu_7</title>
<path fill="none" stroke="black" d="M14922.75,-675.29C15070.51,-657.13 15261.42,-631.66 15439.78,-601.18"/>
<polygon fill="black" stroke="black" points="15440.61,-604.59 15449.88,-599.45 15439.43,-597.69 15440.61,-604.59"/>
</g>
<!-- layer_1_attn_ln -->
<g id="node58" class="node">
<title>layer_1_attn_ln</title>
<polygon fill="#ffe4b5" stroke="black" points="16196,-593.5 15834,-593.5 15834,-525.5 16196,-525.5 16196,-593.5"/>
<text text-anchor="middle" x="16015" y="-578.3" font-family="Arial" font-size="14.00">LayerNorm + Residual</text>
<text text-anchor="middle" x="16015" y="-563.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16015" y="-548.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16015" y="-533.3" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_1_distribute&#45;&gt;layer_1_attn_ln -->
<g id="edge121" class="edge">
<title>layer_1_distribute&#45;&gt;layer_1_attn_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14991.76,-685.88C15223.72,-670.18 15544.91,-643.21 15825,-601 15836.03,-599.34 15847.38,-597.43 15858.78,-595.37"/>
<polygon fill="black" stroke="black" points="15859.61,-598.77 15868.81,-593.52 15858.34,-591.89 15859.61,-598.77"/>
</g>
<!-- layer_1_kv_reduce -->
<g id="node67" class="node">
<title>layer_1_kv_reduce</title>
<polygon fill="lightcoral" stroke="black" points="12229,-467 11791,-399 12229,-331 12667,-399 12229,-467"/>
<text text-anchor="middle" x="12229" y="-417.8" font-family="Arial" font-size="14.00">KV All&#45;Reduce</text>
<text text-anchor="middle" x="12229" y="-402.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128] from 8 GPUs</text>
<text text-anchor="middle" x="12229" y="-387.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12229" y="-372.8" font-family="Arial" font-size="14.00">GPU: All 0&#45;7</text>
</g>
<!-- layer_1_qkv_gpu_0&#45;&gt;layer_1_kv_reduce -->
<g id="edge96" class="edge">
<title>layer_1_qkv_gpu_0&#45;&gt;layer_1_kv_reduce</title>
<path fill="none" stroke="black" d="M12762.01,-517.99C12656.24,-494.58 12523.43,-465.18 12416.85,-441.58"/>
<polygon fill="black" stroke="black" points="12417.47,-438.14 12406.95,-439.39 12415.96,-444.97 12417.47,-438.14"/>
</g>
<!-- layer_1_qkv_gpu_1&#45;&gt;layer_1_kv_reduce -->
<g id="edge97" class="edge">
<title>layer_1_qkv_gpu_1&#45;&gt;layer_1_kv_reduce</title>
<path fill="none" stroke="black" d="M13145.93,-519.2C13142.94,-518.78 13139.96,-518.38 13137,-518 12935.76,-492.09 12882.22,-522.05 12681,-496 12588.4,-484.01 12486.57,-463.08 12403.04,-443.82"/>
<polygon fill="black" stroke="black" points="12403.74,-440.39 12393.21,-441.54 12402.16,-447.2 12403.74,-440.39"/>
</g>
<!-- layer_1_qkv_gpu_2&#45;&gt;layer_1_kv_reduce -->
<g id="edge98" class="edge">
<title>layer_1_qkv_gpu_2&#45;&gt;layer_1_kv_reduce</title>
<path fill="none" stroke="black" d="M13529.94,-519.11C13526.94,-518.72 13523.96,-518.35 13521,-518 13150.09,-474.39 13051.88,-539.87 12681,-496 12587.51,-484.94 12484.75,-463.85 12400.86,-444.24"/>
<polygon fill="black" stroke="black" points="12401.52,-440.8 12390.99,-441.92 12399.92,-447.62 12401.52,-440.8"/>
</g>
<!-- layer_1_qkv_gpu_3&#45;&gt;layer_1_kv_reduce -->
<g id="edge99" class="edge">
<title>layer_1_qkv_gpu_3&#45;&gt;layer_1_kv_reduce</title>
<path fill="none" stroke="black" d="M13913.95,-519.08C13910.95,-518.7 13907.96,-518.34 13905,-518 13364.38,-456.69 13221.58,-557.69 12681,-496 12587.18,-485.29 12484.07,-464.13 12400.05,-444.4"/>
<polygon fill="black" stroke="black" points="12400.7,-440.96 12390.16,-442.06 12399.09,-447.77 12400.7,-440.96"/>
</g>
<!-- layer_1_qkv_gpu_4&#45;&gt;layer_1_kv_reduce -->
<g id="edge100" class="edge">
<title>layer_1_qkv_gpu_4&#45;&gt;layer_1_kv_reduce</title>
<path fill="none" stroke="black" d="M14297.95,-519.06C14294.95,-518.68 14291.96,-518.33 14289,-518 13933.82,-478.49 13036.15,-535.76 12681,-496 12586.96,-485.47 12483.62,-464.27 12399.52,-444.46"/>
<polygon fill="black" stroke="black" points="12400.16,-441.01 12389.62,-442.11 12398.54,-447.82 12400.16,-441.01"/>
</g>
<!-- layer_1_qkv_gpu_5&#45;&gt;layer_1_kv_reduce -->
<g id="edge101" class="edge">
<title>layer_1_qkv_gpu_5&#45;&gt;layer_1_kv_reduce</title>
<path fill="none" stroke="black" d="M14681.95,-519.05C14678.95,-518.68 14675.96,-518.33 14673,-518 14232.96,-469.64 13121.01,-544.67 12681,-496 12586.85,-485.59 12483.4,-464.36 12399.25,-444.5"/>
<polygon fill="black" stroke="black" points="12399.88,-441.06 12389.34,-442.15 12398.27,-447.87 12399.88,-441.06"/>
</g>
<!-- layer_1_qkv_gpu_6&#45;&gt;layer_1_kv_reduce -->
<g id="edge102" class="edge">
<title>layer_1_qkv_gpu_6&#45;&gt;layer_1_kv_reduce</title>
<path fill="none" stroke="black" d="M15065.95,-519.04C15062.95,-518.67 15059.96,-518.32 15057,-518 14532.09,-460.78 13205.87,-553.58 12681,-496 12586.75,-485.66 12483.17,-464.4 12398.98,-444.52"/>
<polygon fill="black" stroke="black" points="12399.61,-441.07 12389.07,-442.16 12397.99,-447.88 12399.61,-441.07"/>
</g>
<!-- layer_1_qkv_gpu_7&#45;&gt;layer_1_kv_reduce -->
<g id="edge103" class="edge">
<title>layer_1_qkv_gpu_7&#45;&gt;layer_1_kv_reduce</title>
<path fill="none" stroke="black" d="M15449.95,-519.04C15446.95,-518.67 15443.96,-518.32 15441,-518 15136.11,-484.96 12985.87,-529.25 12681,-496 12586.74,-485.72 12483.17,-464.47 12398.98,-444.57"/>
<polygon fill="black" stroke="black" points="12399.61,-441.12 12389.07,-442.21 12397.99,-447.93 12399.61,-441.12"/>
</g>
<!-- layer_1_attn_ln&#45;&gt;layer_1_output -->
<g id="edge95" class="edge">
<title>layer_1_attn_ln&#45;&gt;layer_1_output</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16015,-593.73C16015,-645.58 16015,-745.75 16015,-803.19"/>
<polygon fill="black" stroke="black" points="16011.5,-803.39 16015,-813.39 16018.5,-803.39 16011.5,-803.39"/>
</g>
<!-- layer_1_gate_gpu_8 -->
<g id="node59" class="node">
<title>layer_1_gate_gpu_8</title>
<polygon fill="#ffb6c1" stroke="black" points="13489.8,-482 12911.08,-482 12762.2,-316 13340.92,-316 13489.8,-482"/>
<text text-anchor="middle" x="13126" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="13126" y="-410.3" font-family="Arial" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="13126" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13126" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="13126" y="-365.3" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_1_attn_ln&#45;&gt;layer_1_gate_gpu_8 -->
<g id="edge87" class="edge">
<title>layer_1_attn_ln&#45;&gt;layer_1_gate_gpu_8</title>
<path fill="none" stroke="black" d="M15875.7,-525.48C15858.7,-522.44 15841.51,-519.82 15825,-518 15568.1,-489.69 13755.25,-529.68 13499,-496 13475.4,-492.9 13451.15,-488.8 13426.89,-484.05"/>
<polygon fill="black" stroke="black" points="13427.36,-480.57 13416.87,-482.05 13425.99,-487.44 13427.36,-480.57"/>
</g>
<!-- layer_1_gate_gpu_9 -->
<g id="node60" class="node">
<title>layer_1_gate_gpu_9</title>
<polygon fill="#20b2aa" stroke="black" points="14235.8,-482 13657.08,-482 13508.2,-316 14086.92,-316 14235.8,-482"/>
<text text-anchor="middle" x="13872" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="13872" y="-410.3" font-family="Arial" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="13872" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13872" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="13872" y="-365.3" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_1_attn_ln&#45;&gt;layer_1_gate_gpu_9 -->
<g id="edge88" class="edge">
<title>layer_1_attn_ln&#45;&gt;layer_1_gate_gpu_9</title>
<path fill="none" stroke="black" d="M15875.17,-525.46C15858.35,-522.44 15841.34,-519.84 15825,-518 15476.05,-478.76 14593.05,-542.53 14245,-496 14221.55,-492.87 14197.46,-488.76 14173.36,-484.02"/>
<polygon fill="black" stroke="black" points="14173.89,-480.56 14163.39,-482.03 14172.51,-487.42 14173.89,-480.56"/>
</g>
<!-- layer_1_gate_gpu_10 -->
<g id="node61" class="node">
<title>layer_1_gate_gpu_10</title>
<polygon fill="#b0c4de" stroke="black" points="14981.8,-482 14403.08,-482 14254.2,-316 14832.92,-316 14981.8,-482"/>
<text text-anchor="middle" x="14618" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="14618" y="-410.3" font-family="Arial" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="14618" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14618" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="14618" y="-365.3" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_1_attn_ln&#45;&gt;layer_1_gate_gpu_10 -->
<g id="edge89" class="edge">
<title>layer_1_attn_ln&#45;&gt;layer_1_gate_gpu_10</title>
<path fill="none" stroke="black" d="M15874.11,-525.47C15857.63,-522.5 15840.99,-519.9 15825,-518 15456.79,-474.28 15358.21,-547.43 14991,-496 14968.18,-492.8 14944.75,-488.73 14921.29,-484.07"/>
<polygon fill="black" stroke="black" points="14921.73,-480.59 14911.23,-482.04 14920.34,-487.45 14921.73,-480.59"/>
</g>
<!-- layer_1_gate_gpu_11 -->
<g id="node62" class="node">
<title>layer_1_gate_gpu_11</title>
<polygon fill="#ffdead" stroke="black" points="15727.8,-482 15149.08,-482 15000.2,-316 15578.92,-316 15727.8,-482"/>
<text text-anchor="middle" x="15364" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="15364" y="-410.3" font-family="Arial" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="15364" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15364" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="15364" y="-365.3" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_1_attn_ln&#45;&gt;layer_1_gate_gpu_11 -->
<g id="edge90" class="edge">
<title>layer_1_attn_ln&#45;&gt;layer_1_gate_gpu_11</title>
<path fill="none" stroke="black" d="M15864.03,-525.45C15822.78,-516.17 15778.12,-505.91 15737,-496 15721.59,-492.29 15705.84,-488.44 15689.93,-484.51"/>
<polygon fill="black" stroke="black" points="15690.56,-481.06 15680.01,-482.05 15688.88,-487.85 15690.56,-481.06"/>
</g>
<!-- layer_1_gate_gpu_12 -->
<g id="node63" class="node">
<title>layer_1_gate_gpu_12</title>
<polygon fill="#9acd32" stroke="black" points="16473.8,-482 15895.08,-482 15746.2,-316 16324.92,-316 16473.8,-482"/>
<text text-anchor="middle" x="16110" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="16110" y="-410.3" font-family="Arial" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="16110" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16110" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="16110" y="-365.3" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_1_attn_ln&#45;&gt;layer_1_gate_gpu_12 -->
<g id="edge91" class="edge">
<title>layer_1_attn_ln&#45;&gt;layer_1_gate_gpu_12</title>
<path fill="none" stroke="black" d="M16034.92,-525.27C16041.04,-515.05 16048.11,-503.26 16055.41,-491.08"/>
<polygon fill="black" stroke="black" points="16058.61,-492.55 16060.75,-482.17 16052.61,-488.95 16058.61,-492.55"/>
</g>
<!-- layer_1_gate_gpu_13 -->
<g id="node64" class="node">
<title>layer_1_gate_gpu_13</title>
<polygon fill="#d8bf0d" stroke="black" points="17219.8,-482 16641.08,-482 16492.2,-316 17070.92,-316 17219.8,-482"/>
<text text-anchor="middle" x="16856" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="16856" y="-410.3" font-family="Arial" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="16856" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16856" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="16856" y="-365.3" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_1_attn_ln&#45;&gt;layer_1_gate_gpu_13 -->
<g id="edge92" class="edge">
<title>layer_1_attn_ln&#45;&gt;layer_1_gate_gpu_13</title>
<path fill="none" stroke="black" d="M16196.11,-539.41C16283.24,-528.93 16388.96,-514.31 16483,-496 16525.87,-487.65 16571.14,-477.32 16614.8,-466.55"/>
<polygon fill="black" stroke="black" points="16615.81,-469.9 16624.67,-464.1 16614.12,-463.11 16615.81,-469.9"/>
</g>
<!-- layer_1_gate_gpu_14 -->
<g id="node65" class="node">
<title>layer_1_gate_gpu_14</title>
<polygon fill="#e0e0e0" stroke="black" points="17965.8,-482 17387.08,-482 17238.2,-316 17816.92,-316 17965.8,-482"/>
<text text-anchor="middle" x="17602" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="17602" y="-410.3" font-family="Arial" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="17602" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17602" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="17602" y="-365.3" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_1_attn_ln&#45;&gt;layer_1_gate_gpu_14 -->
<g id="edge93" class="edge">
<title>layer_1_attn_ln&#45;&gt;layer_1_gate_gpu_14</title>
<path fill="none" stroke="black" d="M16196.18,-553.63C16484.63,-545.12 17035.44,-525.58 17229,-496 17272.88,-489.29 17319.08,-479.61 17363.45,-468.95"/>
<polygon fill="black" stroke="black" points="17364.29,-472.34 17373.18,-466.58 17362.64,-465.54 17364.29,-472.34"/>
</g>
<!-- layer_1_gate_gpu_15 -->
<g id="node66" class="node">
<title>layer_1_gate_gpu_15</title>
<polygon fill="#fff8dc" stroke="black" points="18711.8,-482 18133.08,-482 17984.2,-316 18562.92,-316 18711.8,-482"/>
<text text-anchor="middle" x="18348" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="18348" y="-410.3" font-family="Arial" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="18348" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18348" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="18348" y="-365.3" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_1_attn_ln&#45;&gt;layer_1_gate_gpu_15 -->
<g id="edge94" class="edge">
<title>layer_1_attn_ln&#45;&gt;layer_1_gate_gpu_15</title>
<path fill="none" stroke="black" d="M16196.34,-557.81C16614.22,-555.39 17635.13,-544.55 17975,-496 18018.94,-489.72 18065.17,-480.25 18109.55,-469.65"/>
<polygon fill="black" stroke="black" points="18110.39,-473.05 18119.29,-467.3 18108.75,-466.25 18110.39,-473.05"/>
</g>
<!-- layer_1_expert_0_gpu_8 -->
<g id="node77" class="node">
<title>layer_1_expert_0_gpu_8</title>
<polygon fill="#ffb6c1" stroke="black" points="13511.5,-271 13126.5,-271 13126.5,-188 13511.5,-188 13511.5,-271"/>
<text text-anchor="middle" x="13319" y="-255.8" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="13319" y="-240.8" font-family="Arial" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="13319" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13319" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="13319" y="-195.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_1_gate_gpu_8&#45;&gt;layer_1_expert_0_gpu_8 -->
<g id="edge122" class="edge">
<title>layer_1_gate_gpu_8&#45;&gt;layer_1_expert_0_gpu_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13220.52,-315.97C13235.53,-302.94 13250.6,-289.86 13264.29,-277.98"/>
<polygon fill="black" stroke="black" points="13266.92,-280.34 13272.17,-271.14 13262.33,-275.05 13266.92,-280.34"/>
</g>
<!-- layer_1_expert_1_gpu_8 -->
<g id="node78" class="node">
<title>layer_1_expert_1_gpu_8</title>
<polygon fill="#ffb6c1" stroke="black" points="13108.5,-271 12723.5,-271 12723.5,-188 13108.5,-188 13108.5,-271"/>
<text text-anchor="middle" x="12916" y="-255.8" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="12916" y="-240.8" font-family="Arial" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="12916" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12916" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="12916" y="-195.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_1_gate_gpu_8&#45;&gt;layer_1_expert_1_gpu_8 -->
<g id="edge123" class="edge">
<title>layer_1_gate_gpu_8&#45;&gt;layer_1_expert_1_gpu_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13023.15,-315.97C13006.67,-302.82 12990.11,-289.61 12975.11,-277.65"/>
<polygon fill="black" stroke="black" points="12976.95,-274.64 12966.95,-271.14 12972.59,-280.11 12976.95,-274.64"/>
</g>
<!-- layer_1_expert_2_gpu_9 -->
<g id="node79" class="node">
<title>layer_1_expert_2_gpu_9</title>
<polygon fill="#20b2aa" stroke="black" points="14317.5,-271 13932.5,-271 13932.5,-188 14317.5,-188 14317.5,-271"/>
<text text-anchor="middle" x="14125" y="-255.8" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="14125" y="-240.8" font-family="Arial" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="14125" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14125" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="14125" y="-195.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_1_gate_gpu_9&#45;&gt;layer_1_expert_2_gpu_9 -->
<g id="edge124" class="edge">
<title>layer_1_gate_gpu_9&#45;&gt;layer_1_expert_2_gpu_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13995.91,-315.97C14016.13,-302.58 14036.45,-289.13 14054.78,-276.99"/>
<polygon fill="black" stroke="black" points="14057.21,-279.58 14063.62,-271.14 14053.35,-273.74 14057.21,-279.58"/>
</g>
<!-- layer_1_expert_3_gpu_9 -->
<g id="node80" class="node">
<title>layer_1_expert_3_gpu_9</title>
<polygon fill="#20b2aa" stroke="black" points="13914.5,-271 13529.5,-271 13529.5,-188 13914.5,-188 13914.5,-271"/>
<text text-anchor="middle" x="13722" y="-255.8" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="13722" y="-240.8" font-family="Arial" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="13722" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13722" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="13722" y="-195.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_1_gate_gpu_9&#45;&gt;layer_1_expert_3_gpu_9 -->
<g id="edge125" class="edge">
<title>layer_1_gate_gpu_9&#45;&gt;layer_1_expert_3_gpu_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13798.32,-315.72C13786.89,-302.96 13775.43,-290.16 13764.98,-278.49"/>
<polygon fill="black" stroke="black" points="13767.55,-276.12 13758.27,-271 13762.34,-280.79 13767.55,-276.12"/>
</g>
<!-- layer_1_expert_4_gpu_10 -->
<g id="node81" class="node">
<title>layer_1_expert_4_gpu_10</title>
<polygon fill="#b0c4de" stroke="black" points="15123.5,-271 14738.5,-271 14738.5,-188 15123.5,-188 15123.5,-271"/>
<text text-anchor="middle" x="14931" y="-255.8" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="14931" y="-240.8" font-family="Arial" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="14931" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14931" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="14931" y="-195.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_1_gate_gpu_10&#45;&gt;layer_1_expert_4_gpu_10 -->
<g id="edge126" class="edge">
<title>layer_1_gate_gpu_10&#45;&gt;layer_1_expert_4_gpu_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14771.29,-315.97C14797,-302.21 14822.82,-288.39 14845.98,-276"/>
<polygon fill="black" stroke="black" points="14847.89,-278.94 14855.06,-271.14 14844.59,-272.77 14847.89,-278.94"/>
</g>
<!-- layer_1_expert_5_gpu_10 -->
<g id="node82" class="node">
<title>layer_1_expert_5_gpu_10</title>
<polygon fill="#b0c4de" stroke="black" points="14720.5,-271 14335.5,-271 14335.5,-188 14720.5,-188 14720.5,-271"/>
<text text-anchor="middle" x="14528" y="-255.8" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="14528" y="-240.8" font-family="Arial" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="14528" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14528" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="14528" y="-195.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_1_gate_gpu_10&#45;&gt;layer_1_expert_5_gpu_10 -->
<g id="edge127" class="edge">
<title>layer_1_gate_gpu_10&#45;&gt;layer_1_expert_5_gpu_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14573.79,-315.72C14567.2,-303.45 14560.58,-291.13 14554.51,-279.83"/>
<polygon fill="black" stroke="black" points="14557.58,-278.16 14549.76,-271 14551.41,-281.47 14557.58,-278.16"/>
</g>
<!-- layer_1_expert_6_gpu_11 -->
<g id="node83" class="node">
<title>layer_1_expert_6_gpu_11</title>
<polygon fill="#ffdead" stroke="black" points="15929.5,-271 15544.5,-271 15544.5,-188 15929.5,-188 15929.5,-271"/>
<text text-anchor="middle" x="15737" y="-255.8" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="15737" y="-240.8" font-family="Arial" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="15737" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15737" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="15737" y="-195.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_1_gate_gpu_11&#45;&gt;layer_1_expert_6_gpu_11 -->
<g id="edge128" class="edge">
<title>layer_1_gate_gpu_11&#45;&gt;layer_1_expert_6_gpu_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15546.68,-315.97C15577.85,-301.97 15609.17,-287.9 15637.15,-275.34"/>
<polygon fill="black" stroke="black" points="15638.81,-278.43 15646.5,-271.14 15635.95,-272.04 15638.81,-278.43"/>
</g>
<!-- layer_1_expert_7_gpu_11 -->
<g id="node84" class="node">
<title>layer_1_expert_7_gpu_11</title>
<polygon fill="#ffdead" stroke="black" points="15526.5,-271 15141.5,-271 15141.5,-188 15526.5,-188 15526.5,-271"/>
<text text-anchor="middle" x="15334" y="-255.8" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="15334" y="-240.8" font-family="Arial" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="15334" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15334" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="15334" y="-195.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_1_gate_gpu_11&#45;&gt;layer_1_expert_7_gpu_11 -->
<g id="edge129" class="edge">
<title>layer_1_gate_gpu_11&#45;&gt;layer_1_expert_7_gpu_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15349.26,-315.72C15347.15,-303.94 15345.03,-292.11 15343.08,-281.18"/>
<polygon fill="black" stroke="black" points="15346.46,-280.23 15341.25,-271 15339.57,-281.46 15346.46,-280.23"/>
</g>
<!-- layer_1_expert_8_gpu_12 -->
<g id="node85" class="node">
<title>layer_1_expert_8_gpu_12</title>
<polygon fill="#9acd32" stroke="black" points="16735.5,-271 16350.5,-271 16350.5,-188 16735.5,-188 16735.5,-271"/>
<text text-anchor="middle" x="16543" y="-255.8" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="16543" y="-240.8" font-family="Arial" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="16543" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16543" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="16543" y="-195.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_1_gate_gpu_12&#45;&gt;layer_1_expert_8_gpu_12 -->
<g id="edge130" class="edge">
<title>layer_1_gate_gpu_12&#45;&gt;layer_1_expert_8_gpu_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16322.06,-315.97C16358.82,-301.75 16395.76,-287.46 16428.62,-274.75"/>
<polygon fill="black" stroke="black" points="16430.16,-277.9 16438.23,-271.03 16427.64,-271.37 16430.16,-277.9"/>
</g>
<!-- layer_1_expert_9_gpu_12 -->
<g id="node86" class="node">
<title>layer_1_expert_9_gpu_12</title>
<polygon fill="#9acd32" stroke="black" points="16332.5,-271 15947.5,-271 15947.5,-188 16332.5,-188 16332.5,-271"/>
<text text-anchor="middle" x="16140" y="-255.8" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="16140" y="-240.8" font-family="Arial" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="16140" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16140" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="16140" y="-195.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_1_gate_gpu_12&#45;&gt;layer_1_expert_9_gpu_12 -->
<g id="edge131" class="edge">
<title>layer_1_gate_gpu_12&#45;&gt;layer_1_expert_9_gpu_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16124.74,-315.72C16126.85,-303.94 16128.97,-292.11 16130.92,-281.18"/>
<polygon fill="black" stroke="black" points="16134.43,-281.46 16132.75,-271 16127.54,-280.23 16134.43,-281.46"/>
</g>
<!-- layer_1_expert_10_gpu_13 -->
<g id="node87" class="node">
<title>layer_1_expert_10_gpu_13</title>
<polygon fill="#d8bf0d" stroke="black" points="17541.5,-271 17156.5,-271 17156.5,-188 17541.5,-188 17541.5,-271"/>
<text text-anchor="middle" x="17349" y="-255.8" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="17349" y="-240.8" font-family="Arial" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="17349" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17349" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="17349" y="-195.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_1_gate_gpu_13&#45;&gt;layer_1_expert_10_gpu_13 -->
<g id="edge132" class="edge">
<title>layer_1_gate_gpu_13&#45;&gt;layer_1_expert_10_gpu_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17077.69,-323.51C17101.1,-315.59 17124.54,-307.64 17147,-300 17171.28,-291.73 17197.19,-282.86 17222.07,-274.31"/>
<polygon fill="black" stroke="black" points="17223.23,-277.62 17231.55,-271.06 17220.95,-271 17223.23,-277.62"/>
</g>
<!-- layer_1_expert_11_gpu_13 -->
<g id="node88" class="node">
<title>layer_1_expert_11_gpu_13</title>
<polygon fill="#d8bf0d" stroke="black" points="17138.5,-271 16753.5,-271 16753.5,-188 17138.5,-188 17138.5,-271"/>
<text text-anchor="middle" x="16946" y="-255.8" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="16946" y="-240.8" font-family="Arial" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="16946" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16946" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="16946" y="-195.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_1_gate_gpu_13&#45;&gt;layer_1_expert_11_gpu_13 -->
<g id="edge133" class="edge">
<title>layer_1_gate_gpu_13&#45;&gt;layer_1_expert_11_gpu_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16900.21,-315.72C16906.8,-303.45 16913.42,-291.13 16919.49,-279.83"/>
<polygon fill="black" stroke="black" points="16922.59,-281.47 16924.24,-271 16916.42,-278.16 16922.59,-281.47"/>
</g>
<!-- layer_1_expert_12_gpu_14 -->
<g id="node89" class="node">
<title>layer_1_expert_12_gpu_14</title>
<polygon fill="#e0e0e0" stroke="black" points="18347.5,-271 17962.5,-271 17962.5,-188 18347.5,-188 18347.5,-271"/>
<text text-anchor="middle" x="18155" y="-255.8" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="18155" y="-240.8" font-family="Arial" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="18155" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18155" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="18155" y="-195.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_1_gate_gpu_14&#45;&gt;layer_1_expert_12_gpu_14 -->
<g id="edge134" class="edge">
<title>layer_1_gate_gpu_14&#45;&gt;layer_1_expert_12_gpu_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17834.33,-335.22C17874.04,-323.9 17914.79,-311.9 17953,-300 17978.55,-292.05 18005.73,-283.06 18031.61,-274.25"/>
<polygon fill="black" stroke="black" points="18032.75,-277.56 18041.08,-271.01 18030.49,-270.93 18032.75,-277.56"/>
</g>
<!-- layer_1_expert_13_gpu_14 -->
<g id="node90" class="node">
<title>layer_1_expert_13_gpu_14</title>
<polygon fill="#e0e0e0" stroke="black" points="17944.5,-271 17559.5,-271 17559.5,-188 17944.5,-188 17944.5,-271"/>
<text text-anchor="middle" x="17752" y="-255.8" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="17752" y="-240.8" font-family="Arial" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="17752" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17752" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="17752" y="-195.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_1_gate_gpu_14&#45;&gt;layer_1_expert_13_gpu_14 -->
<g id="edge135" class="edge">
<title>layer_1_gate_gpu_14&#45;&gt;layer_1_expert_13_gpu_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17675.68,-315.72C17687.11,-302.96 17698.57,-290.16 17709.02,-278.49"/>
<polygon fill="black" stroke="black" points="17711.66,-280.79 17715.73,-271 17706.45,-276.12 17711.66,-280.79"/>
</g>
<!-- layer_1_expert_14_gpu_15 -->
<g id="node91" class="node">
<title>layer_1_expert_14_gpu_15</title>
<polygon fill="#fff8dc" stroke="black" points="19153.5,-271 18768.5,-271 18768.5,-188 19153.5,-188 19153.5,-271"/>
<text text-anchor="middle" x="18961" y="-255.8" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="18961" y="-240.8" font-family="Arial" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="18961" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18961" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="18961" y="-195.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_1_gate_gpu_15&#45;&gt;layer_1_expert_14_gpu_15 -->
<g id="edge136" class="edge">
<title>layer_1_gate_gpu_15&#45;&gt;layer_1_expert_14_gpu_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18588.91,-344.7C18645.01,-331.15 18704.32,-315.89 18759,-300 18785.33,-292.35 18813.29,-283.33 18839.76,-274.35"/>
<polygon fill="black" stroke="black" points="18841.1,-277.6 18849.43,-271.06 18838.84,-270.97 18841.1,-277.6"/>
</g>
<!-- layer_1_expert_15_gpu_15 -->
<g id="node92" class="node">
<title>layer_1_expert_15_gpu_15</title>
<polygon fill="#fff8dc" stroke="black" points="18750.5,-271 18365.5,-271 18365.5,-188 18750.5,-188 18750.5,-271"/>
<text text-anchor="middle" x="18558" y="-255.8" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="18558" y="-240.8" font-family="Arial" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="18558" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18558" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="18558" y="-195.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_1_gate_gpu_15&#45;&gt;layer_1_expert_15_gpu_15 -->
<g id="edge137" class="edge">
<title>layer_1_gate_gpu_15&#45;&gt;layer_1_expert_15_gpu_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18450.85,-315.97C18467.33,-302.82 18483.89,-289.61 18498.89,-277.65"/>
<polygon fill="black" stroke="black" points="18501.41,-280.11 18507.05,-271.14 18497.05,-274.64 18501.41,-280.11"/>
</g>
<!-- layer_1_attn_gpu_0 -->
<g id="node68" class="node">
<title>layer_1_attn_gpu_0</title>
<polygon fill="#ffe4e1" stroke="black" points="9979,-271 9613,-271 9613,-188 9979,-188 9979,-271"/>
<text text-anchor="middle" x="9796" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="9796" y="-240.8" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="9796" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9796" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9796" y="-195.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_1_kv_reduce&#45;&gt;layer_1_attn_gpu_0 -->
<g id="edge104" class="edge">
<title>layer_1_kv_reduce&#45;&gt;layer_1_attn_gpu_0</title>
<path fill="none" stroke="black" d="M11817.36,-394.89C11268.29,-388.18 10326.14,-366.96 9988,-300 9958.79,-294.22 9928.07,-284.74 9899.99,-274.63"/>
<polygon fill="black" stroke="black" points="9901.16,-271.33 9890.57,-271.18 9898.76,-277.9 9901.16,-271.33"/>
</g>
<!-- layer_1_attn_gpu_1 -->
<g id="node69" class="node">
<title>layer_1_attn_gpu_1</title>
<polygon fill="#e6e6fa" stroke="black" points="10363,-271 9997,-271 9997,-188 10363,-188 10363,-271"/>
<text text-anchor="middle" x="10180" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="10180" y="-240.8" font-family="Arial" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="10180" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10180" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10180" y="-195.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_1_kv_reduce&#45;&gt;layer_1_attn_gpu_1 -->
<g id="edge105" class="edge">
<title>layer_1_kv_reduce&#45;&gt;layer_1_attn_gpu_1</title>
<path fill="none" stroke="black" d="M11842.77,-390.96C11382.91,-380.24 10643.02,-354.94 10372,-300 10343.1,-294.14 10312.7,-284.75 10284.84,-274.74"/>
<polygon fill="black" stroke="black" points="10285.69,-271.33 10275.1,-271.18 10283.29,-277.9 10285.69,-271.33"/>
</g>
<!-- layer_1_attn_gpu_2 -->
<g id="node70" class="node">
<title>layer_1_attn_gpu_2</title>
<polygon fill="#f0e68c" stroke="black" points="10747,-271 10381,-271 10381,-188 10747,-188 10747,-271"/>
<text text-anchor="middle" x="10564" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="10564" y="-240.8" font-family="Arial" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="10564" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10564" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10564" y="-195.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_1_kv_reduce&#45;&gt;layer_1_attn_gpu_2 -->
<g id="edge106" class="edge">
<title>layer_1_kv_reduce&#45;&gt;layer_1_attn_gpu_2</title>
<path fill="none" stroke="black" d="M11875.13,-385.87C11508.77,-371.27 10961.76,-343.18 10756,-300 10727.29,-293.98 10697.08,-284.58 10669.34,-274.63"/>
<polygon fill="black" stroke="black" points="10670.24,-271.23 10659.64,-271.09 10667.84,-277.81 10670.24,-271.23"/>
</g>
<!-- layer_1_attn_gpu_3 -->
<g id="node71" class="node">
<title>layer_1_attn_gpu_3</title>
<polygon fill="#98fb98" stroke="black" points="11131,-271 10765,-271 10765,-188 11131,-188 11131,-271"/>
<text text-anchor="middle" x="10948" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="10948" y="-240.8" font-family="Arial" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="10948" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10948" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10948" y="-195.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_1_kv_reduce&#45;&gt;layer_1_attn_gpu_3 -->
<g id="edge107" class="edge">
<title>layer_1_kv_reduce&#45;&gt;layer_1_attn_gpu_3</title>
<path fill="none" stroke="black" d="M11859.28,-388.34C11646.79,-376.94 11376.04,-352.42 11140,-300 11111.67,-293.71 11081.83,-284.34 11054.34,-274.5"/>
<polygon fill="black" stroke="black" points="11055.32,-271.13 11044.73,-271 11052.93,-277.71 11055.32,-271.13"/>
</g>
<!-- layer_1_attn_gpu_4 -->
<g id="node72" class="node">
<title>layer_1_attn_gpu_4</title>
<polygon fill="#87ceeb" stroke="black" points="11515,-271 11149,-271 11149,-188 11515,-188 11515,-271"/>
<text text-anchor="middle" x="11332" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="11332" y="-240.8" font-family="Arial" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="11332" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11332" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11332" y="-195.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_1_kv_reduce&#45;&gt;layer_1_attn_gpu_4 -->
<g id="edge108" class="edge">
<title>layer_1_kv_reduce&#45;&gt;layer_1_attn_gpu_4</title>
<path fill="none" stroke="black" d="M11955.3,-373.43C11823.66,-358.2 11664.34,-334.75 11524,-300 11496.88,-293.28 11468.26,-284.12 11441.63,-274.64"/>
<polygon fill="black" stroke="black" points="11442.51,-271.24 11431.91,-271.14 11440.14,-277.82 11442.51,-271.24"/>
</g>
<!-- layer_1_attn_gpu_5 -->
<g id="node73" class="node">
<title>layer_1_attn_gpu_5</title>
<polygon fill="#dda0dd" stroke="black" points="11899,-271 11533,-271 11533,-188 11899,-188 11899,-271"/>
<text text-anchor="middle" x="11716" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="11716" y="-240.8" font-family="Arial" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="11716" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11716" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11716" y="-195.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_1_kv_reduce&#45;&gt;layer_1_attn_gpu_5 -->
<g id="edge109" class="edge">
<title>layer_1_kv_reduce&#45;&gt;layer_1_attn_gpu_5</title>
<path fill="none" stroke="black" d="M12079.47,-354.07C12025.27,-337.7 11963.69,-318.57 11908,-300 11884.17,-292.06 11858.83,-283.19 11834.64,-274.51"/>
<polygon fill="black" stroke="black" points="11835.66,-271.16 11825.07,-271.07 11833.29,-277.75 11835.66,-271.16"/>
</g>
<!-- layer_1_attn_gpu_6 -->
<g id="node74" class="node">
<title>layer_1_attn_gpu_6</title>
<polygon fill="#f4a460" stroke="black" points="12283,-271 11917,-271 11917,-188 12283,-188 12283,-271"/>
<text text-anchor="middle" x="12100" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="12100" y="-240.8" font-family="Arial" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="12100" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12100" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12100" y="-195.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_1_kv_reduce&#45;&gt;layer_1_attn_gpu_6 -->
<g id="edge110" class="edge">
<title>layer_1_kv_reduce&#45;&gt;layer_1_attn_gpu_6</title>
<path fill="none" stroke="black" d="M12182.79,-338C12168,-318.79 12151.8,-297.76 12137.69,-279.44"/>
<polygon fill="black" stroke="black" points="12140.24,-277.01 12131.36,-271.22 12134.69,-281.28 12140.24,-277.01"/>
</g>
<!-- layer_1_attn_gpu_7 -->
<g id="node75" class="node">
<title>layer_1_attn_gpu_7</title>
<polygon fill="#d3d3d3" stroke="black" points="12667,-271 12301,-271 12301,-188 12667,-188 12667,-271"/>
<text text-anchor="middle" x="12484" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="12484" y="-240.8" font-family="Arial" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="12484" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12484" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12484" y="-195.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_1_kv_reduce&#45;&gt;layer_1_attn_gpu_7 -->
<g id="edge111" class="edge">
<title>layer_1_kv_reduce&#45;&gt;layer_1_attn_gpu_7</title>
<path fill="none" stroke="black" d="M12311.79,-343.62C12344.62,-322.05 12381.99,-297.51 12413.5,-276.81"/>
<polygon fill="black" stroke="black" points="12415.79,-279.49 12422.22,-271.08 12411.94,-273.64 12415.79,-279.49"/>
</g>
<!-- layer_1_attn_agg -->
<g id="node76" class="node">
<title>layer_1_attn_agg</title>
<polygon fill="lightcoral" stroke="black" points="11332,-152 10894,-84 11332,-16 11770,-84 11332,-152"/>
<text text-anchor="middle" x="11332" y="-102.8" font-family="Arial" font-size="14.00">Attention Output All&#45;Reduce</text>
<text text-anchor="middle" x="11332" y="-87.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128] from 8 GPUs</text>
<text text-anchor="middle" x="11332" y="-72.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11332" y="-57.8" font-family="Arial" font-size="14.00">GPU: All 0&#45;7</text>
</g>
<!-- layer_1_attn_gpu_0&#45;&gt;layer_1_attn_agg -->
<g id="edge112" class="edge">
<title>layer_1_attn_gpu_0&#45;&gt;layer_1_attn_agg</title>
<path fill="none" stroke="black" d="M9979.08,-189.32C9982.08,-188.86 9985.05,-188.42 9988,-188 10322.52,-140.11 10707.28,-113.48 10979.17,-99.35"/>
<polygon fill="black" stroke="black" points="10979.39,-102.85 10989.2,-98.84 10979.03,-95.86 10979.39,-102.85"/>
</g>
<!-- layer_1_attn_gpu_1&#45;&gt;layer_1_attn_agg -->
<g id="edge113" class="edge">
<title>layer_1_attn_gpu_1&#45;&gt;layer_1_attn_agg</title>
<path fill="none" stroke="black" d="M10363.1,-189.45C10366.09,-188.95 10369.06,-188.47 10372,-188 10594.11,-152.75 10847.08,-126.16 11037.56,-108.83"/>
<polygon fill="black" stroke="black" points="11038.08,-112.3 11047.73,-107.91 11037.45,-105.33 11038.08,-112.3"/>
</g>
<!-- layer_1_attn_gpu_2&#45;&gt;layer_1_attn_agg -->
<g id="edge114" class="edge">
<title>layer_1_attn_gpu_2&#45;&gt;layer_1_attn_agg</title>
<path fill="none" stroke="black" d="M10747.15,-189.73C10750.12,-189.15 10753.07,-188.57 10756,-188 10874.93,-164.83 11008.08,-140.89 11116.38,-121.93"/>
<polygon fill="black" stroke="black" points="11117.2,-125.34 11126.44,-120.17 11115.99,-118.44 11117.2,-125.34"/>
</g>
<!-- layer_1_attn_gpu_3&#45;&gt;layer_1_attn_agg -->
<g id="edge115" class="edge">
<title>layer_1_attn_gpu_3&#45;&gt;layer_1_attn_agg</title>
<path fill="none" stroke="black" d="M11056.5,-187.95C11099.76,-171.79 11150.05,-153 11195.72,-135.93"/>
<polygon fill="black" stroke="black" points="11196.95,-139.2 11205.1,-132.42 11194.5,-132.65 11196.95,-139.2"/>
</g>
<!-- layer_1_attn_gpu_4&#45;&gt;layer_1_attn_agg -->
<g id="edge116" class="edge">
<title>layer_1_attn_gpu_4&#45;&gt;layer_1_attn_agg</title>
<path fill="none" stroke="black" d="M11332,-187.76C11332,-179.78 11332,-171.17 11332,-162.44"/>
<polygon fill="black" stroke="black" points="11335.5,-162.17 11332,-152.17 11328.5,-162.17 11335.5,-162.17"/>
</g>
<!-- layer_1_attn_gpu_5&#45;&gt;layer_1_attn_agg -->
<g id="edge117" class="edge">
<title>layer_1_attn_gpu_5&#45;&gt;layer_1_attn_agg</title>
<path fill="none" stroke="black" d="M11607.5,-187.95C11564.24,-171.79 11513.95,-153 11468.28,-135.93"/>
<polygon fill="black" stroke="black" points="11469.5,-132.65 11458.9,-132.42 11467.05,-139.2 11469.5,-132.65"/>
</g>
<!-- layer_1_attn_gpu_6&#45;&gt;layer_1_attn_agg -->
<g id="edge118" class="edge">
<title>layer_1_attn_gpu_6&#45;&gt;layer_1_attn_agg</title>
<path fill="none" stroke="black" d="M11916.85,-189.73C11913.88,-189.15 11910.93,-188.57 11908,-188 11789.07,-164.83 11655.92,-140.89 11547.62,-121.93"/>
<polygon fill="black" stroke="black" points="11548.01,-118.44 11537.56,-120.17 11546.8,-125.34 11548.01,-118.44"/>
</g>
<!-- layer_1_attn_gpu_7&#45;&gt;layer_1_attn_agg -->
<g id="edge119" class="edge">
<title>layer_1_attn_gpu_7&#45;&gt;layer_1_attn_agg</title>
<path fill="none" stroke="black" d="M12300.9,-189.45C12297.91,-188.95 12294.94,-188.47 12292,-188 12069.89,-152.75 11816.92,-126.16 11626.44,-108.83"/>
<polygon fill="black" stroke="black" points="11626.55,-105.33 11616.27,-107.91 11625.92,-112.3 11626.55,-105.33"/>
</g>
<!-- layer_1_attn_agg&#45;&gt;layer_1_attn_ln -->
<g id="edge120" class="edge">
<title>layer_1_attn_agg&#45;&gt;layer_1_attn_ln</title>
<path fill="none" stroke="black" d="M11719.29,-91.9C12090.2,-102.12 12603.97,-127.19 12676,-188 12729.91,-233.51 12697.55,-452.38 12753,-496 12786.54,-522.38 15782.58,-513.38 15825,-518 15838.36,-519.46 15852.15,-521.44 15865.94,-523.75"/>
<polygon fill="black" stroke="black" points="15865.51,-527.23 15875.96,-525.49 15866.71,-520.33 15865.51,-527.23"/>
</g>
<!-- layer_1_expert_agg -->
<g id="node93" class="node">
<title>layer_1_expert_agg</title>
<polygon fill="yellow" stroke="black" points="16629.2,-152 15851,-152 15650.8,-16 16429,-16 16629.2,-152"/>
<text text-anchor="middle" x="16140" y="-102.8" font-family="Arial" font-size="14.00">Expert Aggregation (Top&#45;2)</text>
<text text-anchor="middle" x="16140" y="-87.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, expert_hidden=16384] from 16 experts</text>
<text text-anchor="middle" x="16140" y="-72.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16140" y="-57.8" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_1_expert_0_gpu_8&#45;&gt;layer_1_expert_agg -->
<g id="edge138" class="edge">
<title>layer_1_expert_0_gpu_8&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M13511.73,-189.03C13514.5,-188.67 13517.26,-188.33 13520,-188 13940.2,-137.73 15132.11,-106.15 15753.07,-92.63"/>
<polygon fill="black" stroke="black" points="15753.16,-96.13 15763.08,-92.41 15753.01,-89.13 15753.16,-96.13"/>
</g>
<!-- layer_1_expert_1_gpu_8&#45;&gt;layer_1_expert_agg -->
<g id="edge139" class="edge">
<title>layer_1_expert_1_gpu_8&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M13108.73,-189.01C13111.5,-188.66 13114.26,-188.32 13117,-188 13614.86,-129.76 15051.31,-101.1 15749.62,-90.3"/>
<polygon fill="black" stroke="black" points="15749.9,-93.79 15759.84,-90.14 15749.79,-86.79 15749.9,-93.79"/>
</g>
<!-- layer_1_expert_2_gpu_9&#45;&gt;layer_1_expert_agg -->
<g id="edge140" class="edge">
<title>layer_1_expert_2_gpu_9&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M14317.74,-189.1C14320.51,-188.72 14323.26,-188.35 14326,-188 14814.7,-125.21 15382.37,-100.7 15750.71,-91.13"/>
<polygon fill="black" stroke="black" points="15750.82,-94.63 15760.73,-90.87 15750.64,-87.63 15750.82,-94.63"/>
</g>
<!-- layer_1_expert_3_gpu_9&#45;&gt;layer_1_expert_agg -->
<g id="edge141" class="edge">
<title>layer_1_expert_3_gpu_9&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M13914.73,-189.06C13917.51,-188.69 13920.26,-188.34 13923,-188 14556.09,-109.97 15297.51,-89.79 15742.39,-85.27"/>
<polygon fill="black" stroke="black" points="15742.55,-88.77 15752.51,-85.17 15742.48,-81.77 15742.55,-88.77"/>
</g>
<!-- layer_1_expert_4_gpu_10&#45;&gt;layer_1_expert_agg -->
<g id="edge142" class="edge">
<title>layer_1_expert_4_gpu_10&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M15123.76,-189.27C15126.53,-188.84 15129.27,-188.41 15132,-188 15346.87,-155.45 15589.1,-130.33 15782.24,-113.05"/>
<polygon fill="black" stroke="black" points="15782.62,-116.53 15792.27,-112.16 15782,-109.56 15782.62,-116.53"/>
</g>
<!-- layer_1_expert_5_gpu_10&#45;&gt;layer_1_expert_agg -->
<g id="edge143" class="edge">
<title>layer_1_expert_5_gpu_10&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M14720.75,-189.16C14723.51,-188.76 14726.27,-188.37 14729,-188 15077.58,-140.35 15477.82,-113.78 15762.78,-99.61"/>
<polygon fill="black" stroke="black" points="15763.06,-103.1 15772.87,-99.11 15762.71,-96.11 15763.06,-103.1"/>
</g>
<!-- layer_1_expert_6_gpu_11&#45;&gt;layer_1_expert_agg -->
<g id="edge144" class="edge">
<title>layer_1_expert_6_gpu_11&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M15850.87,-187.95C15879.34,-177.81 15910.72,-166.64 15941.98,-155.51"/>
<polygon fill="black" stroke="black" points="15943.43,-158.71 15951.68,-152.06 15941.09,-152.11 15943.43,-158.71"/>
</g>
<!-- layer_1_expert_7_gpu_11&#45;&gt;layer_1_expert_agg -->
<g id="edge145" class="edge">
<title>layer_1_expert_7_gpu_11&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M15526.54,-189.58C15529.38,-189.05 15532.2,-188.52 15535,-188 15626.59,-170.98 15726.2,-153.57 15817.66,-138.02"/>
<polygon fill="black" stroke="black" points="15818.35,-141.45 15827.62,-136.33 15817.18,-134.55 15818.35,-141.45"/>
</g>
<!-- layer_1_expert_8_gpu_12&#45;&gt;layer_1_expert_agg -->
<g id="edge146" class="edge">
<title>layer_1_expert_8_gpu_12&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M16429.13,-187.95C16400.66,-177.81 16369.28,-166.64 16338.02,-155.51"/>
<polygon fill="black" stroke="black" points="16338.91,-152.11 16328.32,-152.06 16336.57,-158.71 16338.91,-152.11"/>
</g>
<!-- layer_1_expert_9_gpu_12&#45;&gt;layer_1_expert_agg -->
<g id="edge147" class="edge">
<title>layer_1_expert_9_gpu_12&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M16140,-187.76C16140,-179.78 16140,-171.17 16140,-162.44"/>
<polygon fill="black" stroke="black" points="16143.5,-162.17 16140,-152.17 16136.5,-162.17 16143.5,-162.17"/>
</g>
<!-- layer_1_expert_10_gpu_13&#45;&gt;layer_1_expert_agg -->
<g id="edge148" class="edge">
<title>layer_1_expert_10_gpu_13&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M17156.35,-189.45C17153.21,-188.95 17150.09,-188.47 17147,-188 16966.85,-160.79 16767.45,-138.73 16593.95,-122.1"/>
<polygon fill="black" stroke="black" points="16594.16,-118.61 16583.88,-121.14 16593.5,-125.58 16594.16,-118.61"/>
</g>
<!-- layer_1_expert_11_gpu_13&#45;&gt;layer_1_expert_agg -->
<g id="edge149" class="edge">
<title>layer_1_expert_11_gpu_13&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M16753.3,-189.74C16750.18,-189.15 16747.08,-188.57 16744,-188 16682.2,-176.54 16616.74,-164.88 16552.62,-153.72"/>
<polygon fill="black" stroke="black" points="16553.2,-150.27 16542.75,-152.01 16552,-157.17 16553.2,-150.27"/>
</g>
<!-- layer_1_expert_12_gpu_14&#45;&gt;layer_1_expert_agg -->
<g id="edge150" class="edge">
<title>layer_1_expert_12_gpu_14&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M17962.38,-189.25C17959.23,-188.81 17956.1,-188.4 17953,-188 17473.84,-126.67 16918.75,-101.85 16550.3,-91.82"/>
<polygon fill="black" stroke="black" points="16550.36,-88.32 16540.27,-91.55 16550.17,-95.31 16550.36,-88.32"/>
</g>
<!-- layer_1_expert_13_gpu_14&#45;&gt;layer_1_expert_agg -->
<g id="edge151" class="edge">
<title>layer_1_expert_13_gpu_14&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M17559.37,-189.32C17556.23,-188.86 17553.1,-188.42 17550,-188 17221.04,-143.19 16846.06,-116.97 16565.53,-102.22"/>
<polygon fill="black" stroke="black" points="16565.34,-98.7 16555.17,-101.67 16564.98,-105.69 16565.34,-98.7"/>
</g>
<!-- layer_1_expert_14_gpu_15&#45;&gt;layer_1_expert_agg -->
<g id="edge152" class="edge">
<title>layer_1_expert_14_gpu_15&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M18768.39,-189.17C18765.24,-188.76 18762.11,-188.37 18759,-188 18344.69,-138.64 17180.02,-107.14 16552.62,-93.25"/>
<polygon fill="black" stroke="black" points="16552.58,-89.74 16542.5,-93.02 16552.42,-96.74 16552.58,-89.74"/>
</g>
<!-- layer_1_expert_15_gpu_15&#45;&gt;layer_1_expert_agg -->
<g id="edge153" class="edge">
<title>layer_1_expert_15_gpu_15&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M18365.38,-189.21C18362.24,-188.78 18359.11,-188.38 18356,-188 17725.05,-110.54 16986.53,-90.15 16541.43,-85.43"/>
<polygon fill="black" stroke="black" points="16541.33,-81.93 16531.29,-85.33 16541.26,-88.93 16541.33,-81.93"/>
</g>
<!-- layer_1_expert_agg&#45;&gt;layer_1_output -->
<g id="edge154" class="edge">
<title>layer_1_expert_agg&#45;&gt;layer_1_output</title>
<path fill="none" stroke="black" d="M16530.29,-84.77C17325.73,-86.15 19067.76,-99.33 19162,-188 19196.14,-220.12 19182,-351.12 19182,-398 19182,-560.5 19182,-560.5 19182,-560.5 19182,-710.74 16891.37,-812.28 16206.29,-839.28"/>
<polygon fill="black" stroke="black" points="16205.92,-835.79 16196.07,-839.69 16206.2,-842.79 16205.92,-835.79"/>
</g>
<!-- layer_2_output -->
<g id="node94" class="node">
<title>layer_2_output</title>
<polygon fill="#ffe4b5" stroke="black" points="25793,-881.48 25431,-881.48 25431,-813.48 25793,-813.48 25793,-881.48"/>
<text text-anchor="middle" x="25612" y="-866.28" font-family="Arial" font-size="14.00">Layer 3 Output</text>
<text text-anchor="middle" x="25612" y="-851.28" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="25612" y="-836.28" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="25612" y="-821.28" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_2_distribute -->
<g id="node95" class="node">
<title>layer_2_distribute</title>
<polygon fill="lightcoral" stroke="black" points="24270,-773 23827,-705 24270,-637 24713,-705 24270,-773"/>
<text text-anchor="middle" x="24270" y="-723.8" font-family="Arial" font-size="14.00">Layer 3 Input Distribution</text>
<text text-anchor="middle" x="24270" y="-708.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="24270" y="-693.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, hidden_dim=4096] replicated 8x</text>
<text text-anchor="middle" x="24270" y="-678.8" font-family="Arial" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- layer_2_output&#45;&gt;layer_2_distribute -->
<g id="edge155" class="edge">
<title>layer_2_output&#45;&gt;layer_2_distribute</title>
<path fill="none" stroke="black" d="M25430.66,-827.49C25201.35,-803.49 24804.56,-761.96 24539.67,-734.23"/>
<polygon fill="black" stroke="black" points="24539.83,-730.73 24529.52,-733.17 24539.1,-737.69 24539.83,-730.73"/>
</g>
<!-- layer_2_qkv_gpu_0 -->
<g id="node96" class="node">
<title>layer_2_qkv_gpu_0</title>
<polygon fill="#ffe4e1" stroke="black" points="22725,-601 22359,-601 22359,-518 22725,-518 22725,-601"/>
<text text-anchor="middle" x="22542" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="22542" y="-570.8" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="22542" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="22542" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="22542" y="-525.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_2_distribute&#45;&gt;layer_2_qkv_gpu_0 -->
<g id="edge156" class="edge">
<title>layer_2_distribute&#45;&gt;layer_2_qkv_gpu_0</title>
<path fill="none" stroke="black" d="M23899.57,-693.79C23590.12,-681.79 23137.55,-656.19 22735.17,-601.11"/>
<polygon fill="black" stroke="black" points="22735.46,-597.61 22725.08,-599.72 22734.51,-604.55 22735.46,-597.61"/>
</g>
<!-- layer_2_qkv_gpu_1 -->
<g id="node97" class="node">
<title>layer_2_qkv_gpu_1</title>
<polygon fill="#e6e6fa" stroke="black" points="23109,-601 22743,-601 22743,-518 23109,-518 23109,-601"/>
<text text-anchor="middle" x="22926" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="22926" y="-570.8" font-family="Arial" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="22926" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="22926" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="22926" y="-525.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_2_distribute&#45;&gt;layer_2_qkv_gpu_1 -->
<g id="edge157" class="edge">
<title>layer_2_distribute&#45;&gt;layer_2_qkv_gpu_1</title>
<path fill="none" stroke="black" d="M23952.2,-685.77C23722.9,-670.17 23406.03,-643.6 23119.28,-601.14"/>
<polygon fill="black" stroke="black" points="23119.5,-597.64 23109.09,-599.63 23118.47,-604.56 23119.5,-597.64"/>
</g>
<!-- layer_2_qkv_gpu_2 -->
<g id="node98" class="node">
<title>layer_2_qkv_gpu_2</title>
<polygon fill="#f0e68c" stroke="black" points="23493,-601 23127,-601 23127,-518 23493,-518 23493,-601"/>
<text text-anchor="middle" x="23310" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="23310" y="-570.8" font-family="Arial" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="23310" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="23310" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="23310" y="-525.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_2_distribute&#45;&gt;layer_2_qkv_gpu_2 -->
<g id="edge158" class="edge">
<title>layer_2_distribute&#45;&gt;layer_2_qkv_gpu_2</title>
<path fill="none" stroke="black" d="M24020.25,-675.29C23872.49,-657.13 23681.58,-631.66 23503.22,-601.18"/>
<polygon fill="black" stroke="black" points="23503.57,-597.69 23493.12,-599.45 23502.39,-604.59 23503.57,-597.69"/>
</g>
<!-- layer_2_qkv_gpu_3 -->
<g id="node99" class="node">
<title>layer_2_qkv_gpu_3</title>
<polygon fill="#98fb98" stroke="black" points="23877,-601 23511,-601 23511,-518 23877,-518 23877,-601"/>
<text text-anchor="middle" x="23694" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="23694" y="-570.8" font-family="Arial" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="23694" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="23694" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="23694" y="-525.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_2_distribute&#45;&gt;layer_2_qkv_gpu_3 -->
<g id="edge159" class="edge">
<title>layer_2_distribute&#45;&gt;layer_2_qkv_gpu_3</title>
<path fill="none" stroke="black" d="M24103.4,-662.49C24029.15,-644 23941.72,-622.22 23866.77,-603.54"/>
<polygon fill="black" stroke="black" points="23867.3,-600.07 23856.75,-601.05 23865.61,-606.86 23867.3,-600.07"/>
</g>
<!-- layer_2_qkv_gpu_4 -->
<g id="node100" class="node">
<title>layer_2_qkv_gpu_4</title>
<polygon fill="#87ceeb" stroke="black" points="24261,-601 23895,-601 23895,-518 24261,-518 24261,-601"/>
<text text-anchor="middle" x="24078" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="24078" y="-570.8" font-family="Arial" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="24078" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="24078" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="24078" y="-525.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_2_distribute&#45;&gt;layer_2_qkv_gpu_4 -->
<g id="edge160" class="edge">
<title>layer_2_distribute&#45;&gt;layer_2_qkv_gpu_4</title>
<path fill="none" stroke="black" d="M24195.49,-648.31C24177.38,-634.77 24158.18,-620.43 24140.68,-607.34"/>
<polygon fill="black" stroke="black" points="24142.33,-604.21 24132.23,-601.03 24138.14,-609.82 24142.33,-604.21"/>
</g>
<!-- layer_2_qkv_gpu_5 -->
<g id="node101" class="node">
<title>layer_2_qkv_gpu_5</title>
<polygon fill="#dda0dd" stroke="black" points="24645,-601 24279,-601 24279,-518 24645,-518 24645,-601"/>
<text text-anchor="middle" x="24462" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="24462" y="-570.8" font-family="Arial" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="24462" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="24462" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="24462" y="-525.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_2_distribute&#45;&gt;layer_2_qkv_gpu_5 -->
<g id="edge161" class="edge">
<title>layer_2_distribute&#45;&gt;layer_2_qkv_gpu_5</title>
<path fill="none" stroke="black" d="M24344.51,-648.31C24362.62,-634.77 24381.82,-620.43 24399.32,-607.34"/>
<polygon fill="black" stroke="black" points="24401.86,-609.82 24407.77,-601.03 24397.67,-604.21 24401.86,-609.82"/>
</g>
<!-- layer_2_qkv_gpu_6 -->
<g id="node102" class="node">
<title>layer_2_qkv_gpu_6</title>
<polygon fill="#f4a460" stroke="black" points="25029,-601 24663,-601 24663,-518 25029,-518 25029,-601"/>
<text text-anchor="middle" x="24846" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="24846" y="-570.8" font-family="Arial" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="24846" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="24846" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="24846" y="-525.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_2_distribute&#45;&gt;layer_2_qkv_gpu_6 -->
<g id="edge162" class="edge">
<title>layer_2_distribute&#45;&gt;layer_2_qkv_gpu_6</title>
<path fill="none" stroke="black" d="M24436.6,-662.49C24510.85,-644 24598.28,-622.22 24673.23,-603.54"/>
<polygon fill="black" stroke="black" points="24674.39,-606.86 24683.25,-601.05 24672.7,-600.07 24674.39,-606.86"/>
</g>
<!-- layer_2_qkv_gpu_7 -->
<g id="node103" class="node">
<title>layer_2_qkv_gpu_7</title>
<polygon fill="#d3d3d3" stroke="black" points="25413,-601 25047,-601 25047,-518 25413,-518 25413,-601"/>
<text text-anchor="middle" x="25230" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="25230" y="-570.8" font-family="Arial" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="25230" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="25230" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="25230" y="-525.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_2_distribute&#45;&gt;layer_2_qkv_gpu_7 -->
<g id="edge163" class="edge">
<title>layer_2_distribute&#45;&gt;layer_2_qkv_gpu_7</title>
<path fill="none" stroke="black" d="M24519.75,-675.29C24667.51,-657.13 24858.42,-631.66 25036.78,-601.18"/>
<polygon fill="black" stroke="black" points="25037.61,-604.59 25046.88,-599.45 25036.43,-597.69 25037.61,-604.59"/>
</g>
<!-- layer_2_attn_ln -->
<g id="node104" class="node">
<title>layer_2_attn_ln</title>
<polygon fill="#ffe4b5" stroke="black" points="25793,-593.5 25431,-593.5 25431,-525.5 25793,-525.5 25793,-593.5"/>
<text text-anchor="middle" x="25612" y="-578.3" font-family="Arial" font-size="14.00">LayerNorm + Residual</text>
<text text-anchor="middle" x="25612" y="-563.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="25612" y="-548.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="25612" y="-533.3" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_2_distribute&#45;&gt;layer_2_attn_ln -->
<g id="edge198" class="edge">
<title>layer_2_distribute&#45;&gt;layer_2_attn_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24588.76,-685.88C24820.72,-670.18 25141.91,-643.21 25422,-601 25433.03,-599.34 25444.38,-597.43 25455.78,-595.37"/>
<polygon fill="black" stroke="black" points="25456.61,-598.77 25465.81,-593.52 25455.34,-591.89 25456.61,-598.77"/>
</g>
<!-- layer_2_kv_reduce -->
<g id="node113" class="node">
<title>layer_2_kv_reduce</title>
<polygon fill="lightcoral" stroke="black" points="21826,-467 21388,-399 21826,-331 22264,-399 21826,-467"/>
<text text-anchor="middle" x="21826" y="-417.8" font-family="Arial" font-size="14.00">KV All&#45;Reduce</text>
<text text-anchor="middle" x="21826" y="-402.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128] from 8 GPUs</text>
<text text-anchor="middle" x="21826" y="-387.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="21826" y="-372.8" font-family="Arial" font-size="14.00">GPU: All 0&#45;7</text>
</g>
<!-- layer_2_qkv_gpu_0&#45;&gt;layer_2_kv_reduce -->
<g id="edge173" class="edge">
<title>layer_2_qkv_gpu_0&#45;&gt;layer_2_kv_reduce</title>
<path fill="none" stroke="black" d="M22359.01,-517.99C22253.24,-494.58 22120.43,-465.18 22013.85,-441.58"/>
<polygon fill="black" stroke="black" points="22014.47,-438.14 22003.95,-439.39 22012.96,-444.97 22014.47,-438.14"/>
</g>
<!-- layer_2_qkv_gpu_1&#45;&gt;layer_2_kv_reduce -->
<g id="edge174" class="edge">
<title>layer_2_qkv_gpu_1&#45;&gt;layer_2_kv_reduce</title>
<path fill="none" stroke="black" d="M22742.93,-519.2C22739.94,-518.78 22736.96,-518.38 22734,-518 22532.76,-492.09 22479.22,-522.05 22278,-496 22185.4,-484.01 22083.57,-463.08 22000.04,-443.82"/>
<polygon fill="black" stroke="black" points="22000.74,-440.39 21990.21,-441.54 21999.16,-447.2 22000.74,-440.39"/>
</g>
<!-- layer_2_qkv_gpu_2&#45;&gt;layer_2_kv_reduce -->
<g id="edge175" class="edge">
<title>layer_2_qkv_gpu_2&#45;&gt;layer_2_kv_reduce</title>
<path fill="none" stroke="black" d="M23126.94,-519.11C23123.94,-518.72 23120.96,-518.35 23118,-518 22747.09,-474.39 22648.88,-539.87 22278,-496 22184.51,-484.94 22081.75,-463.85 21997.86,-444.24"/>
<polygon fill="black" stroke="black" points="21998.52,-440.8 21987.99,-441.92 21996.92,-447.62 21998.52,-440.8"/>
</g>
<!-- layer_2_qkv_gpu_3&#45;&gt;layer_2_kv_reduce -->
<g id="edge176" class="edge">
<title>layer_2_qkv_gpu_3&#45;&gt;layer_2_kv_reduce</title>
<path fill="none" stroke="black" d="M23510.95,-519.08C23507.95,-518.7 23504.96,-518.34 23502,-518 22961.38,-456.69 22818.58,-557.69 22278,-496 22184.18,-485.29 22081.07,-464.13 21997.05,-444.4"/>
<polygon fill="black" stroke="black" points="21997.7,-440.96 21987.16,-442.06 21996.09,-447.77 21997.7,-440.96"/>
</g>
<!-- layer_2_qkv_gpu_4&#45;&gt;layer_2_kv_reduce -->
<g id="edge177" class="edge">
<title>layer_2_qkv_gpu_4&#45;&gt;layer_2_kv_reduce</title>
<path fill="none" stroke="black" d="M23894.95,-519.06C23891.95,-518.68 23888.96,-518.33 23886,-518 23530.82,-478.49 22633.15,-535.76 22278,-496 22183.96,-485.47 22080.62,-464.27 21996.52,-444.46"/>
<polygon fill="black" stroke="black" points="21997.16,-441.01 21986.62,-442.11 21995.54,-447.82 21997.16,-441.01"/>
</g>
<!-- layer_2_qkv_gpu_5&#45;&gt;layer_2_kv_reduce -->
<g id="edge178" class="edge">
<title>layer_2_qkv_gpu_5&#45;&gt;layer_2_kv_reduce</title>
<path fill="none" stroke="black" d="M24278.95,-519.05C24275.95,-518.68 24272.96,-518.33 24270,-518 23829.96,-469.64 22718.01,-544.67 22278,-496 22183.85,-485.59 22080.4,-464.36 21996.25,-444.5"/>
<polygon fill="black" stroke="black" points="21996.88,-441.06 21986.34,-442.15 21995.27,-447.87 21996.88,-441.06"/>
</g>
<!-- layer_2_qkv_gpu_6&#45;&gt;layer_2_kv_reduce -->
<g id="edge179" class="edge">
<title>layer_2_qkv_gpu_6&#45;&gt;layer_2_kv_reduce</title>
<path fill="none" stroke="black" d="M24662.95,-519.04C24659.95,-518.67 24656.96,-518.32 24654,-518 24129.09,-460.78 22802.87,-553.58 22278,-496 22183.75,-485.66 22080.17,-464.4 21995.98,-444.52"/>
<polygon fill="black" stroke="black" points="21996.61,-441.07 21986.07,-442.16 21994.99,-447.88 21996.61,-441.07"/>
</g>
<!-- layer_2_qkv_gpu_7&#45;&gt;layer_2_kv_reduce -->
<g id="edge180" class="edge">
<title>layer_2_qkv_gpu_7&#45;&gt;layer_2_kv_reduce</title>
<path fill="none" stroke="black" d="M25046.95,-519.04C25043.95,-518.67 25040.96,-518.32 25038,-518 24733.11,-484.96 22582.87,-529.25 22278,-496 22183.74,-485.72 22080.17,-464.47 21995.98,-444.57"/>
<polygon fill="black" stroke="black" points="21996.61,-441.12 21986.07,-442.21 21994.99,-447.93 21996.61,-441.12"/>
</g>
<!-- layer_2_attn_ln&#45;&gt;layer_2_output -->
<g id="edge172" class="edge">
<title>layer_2_attn_ln&#45;&gt;layer_2_output</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M25612,-593.73C25612,-645.58 25612,-745.75 25612,-803.19"/>
<polygon fill="black" stroke="black" points="25608.5,-803.39 25612,-813.39 25615.5,-803.39 25608.5,-803.39"/>
</g>
<!-- layer_2_gate_gpu_8 -->
<g id="node105" class="node">
<title>layer_2_gate_gpu_8</title>
<polygon fill="#ffb6c1" stroke="black" points="23086.8,-482 22508.08,-482 22359.2,-316 22937.92,-316 23086.8,-482"/>
<text text-anchor="middle" x="22723" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="22723" y="-410.3" font-family="Arial" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="22723" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="22723" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="22723" y="-365.3" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_2_attn_ln&#45;&gt;layer_2_gate_gpu_8 -->
<g id="edge164" class="edge">
<title>layer_2_attn_ln&#45;&gt;layer_2_gate_gpu_8</title>
<path fill="none" stroke="black" d="M25472.7,-525.48C25455.7,-522.44 25438.51,-519.82 25422,-518 25165.1,-489.69 23352.25,-529.68 23096,-496 23072.4,-492.9 23048.15,-488.8 23023.89,-484.05"/>
<polygon fill="black" stroke="black" points="23024.36,-480.57 23013.87,-482.05 23022.99,-487.44 23024.36,-480.57"/>
</g>
<!-- layer_2_gate_gpu_9 -->
<g id="node106" class="node">
<title>layer_2_gate_gpu_9</title>
<polygon fill="#20b2aa" stroke="black" points="23832.8,-482 23254.08,-482 23105.2,-316 23683.92,-316 23832.8,-482"/>
<text text-anchor="middle" x="23469" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="23469" y="-410.3" font-family="Arial" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="23469" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="23469" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="23469" y="-365.3" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_2_attn_ln&#45;&gt;layer_2_gate_gpu_9 -->
<g id="edge165" class="edge">
<title>layer_2_attn_ln&#45;&gt;layer_2_gate_gpu_9</title>
<path fill="none" stroke="black" d="M25472.17,-525.46C25455.35,-522.44 25438.34,-519.84 25422,-518 25073.05,-478.76 24190.05,-542.53 23842,-496 23818.55,-492.87 23794.46,-488.76 23770.36,-484.02"/>
<polygon fill="black" stroke="black" points="23770.89,-480.56 23760.39,-482.03 23769.51,-487.42 23770.89,-480.56"/>
</g>
<!-- layer_2_gate_gpu_10 -->
<g id="node107" class="node">
<title>layer_2_gate_gpu_10</title>
<polygon fill="#b0c4de" stroke="black" points="24578.8,-482 24000.08,-482 23851.2,-316 24429.92,-316 24578.8,-482"/>
<text text-anchor="middle" x="24215" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="24215" y="-410.3" font-family="Arial" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="24215" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="24215" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="24215" y="-365.3" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_2_attn_ln&#45;&gt;layer_2_gate_gpu_10 -->
<g id="edge166" class="edge">
<title>layer_2_attn_ln&#45;&gt;layer_2_gate_gpu_10</title>
<path fill="none" stroke="black" d="M25471.11,-525.47C25454.63,-522.5 25437.99,-519.9 25422,-518 25053.79,-474.28 24955.21,-547.43 24588,-496 24565.18,-492.8 24541.75,-488.73 24518.29,-484.07"/>
<polygon fill="black" stroke="black" points="24518.73,-480.59 24508.23,-482.04 24517.34,-487.45 24518.73,-480.59"/>
</g>
<!-- layer_2_gate_gpu_11 -->
<g id="node108" class="node">
<title>layer_2_gate_gpu_11</title>
<polygon fill="#ffdead" stroke="black" points="25324.8,-482 24746.08,-482 24597.2,-316 25175.92,-316 25324.8,-482"/>
<text text-anchor="middle" x="24961" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="24961" y="-410.3" font-family="Arial" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="24961" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="24961" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="24961" y="-365.3" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_2_attn_ln&#45;&gt;layer_2_gate_gpu_11 -->
<g id="edge167" class="edge">
<title>layer_2_attn_ln&#45;&gt;layer_2_gate_gpu_11</title>
<path fill="none" stroke="black" d="M25461.03,-525.45C25419.78,-516.17 25375.12,-505.91 25334,-496 25318.59,-492.29 25302.84,-488.44 25286.93,-484.51"/>
<polygon fill="black" stroke="black" points="25287.56,-481.06 25277.01,-482.05 25285.88,-487.85 25287.56,-481.06"/>
</g>
<!-- layer_2_gate_gpu_12 -->
<g id="node109" class="node">
<title>layer_2_gate_gpu_12</title>
<polygon fill="#9acd32" stroke="black" points="26070.8,-482 25492.08,-482 25343.2,-316 25921.92,-316 26070.8,-482"/>
<text text-anchor="middle" x="25707" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="25707" y="-410.3" font-family="Arial" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="25707" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="25707" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="25707" y="-365.3" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_2_attn_ln&#45;&gt;layer_2_gate_gpu_12 -->
<g id="edge168" class="edge">
<title>layer_2_attn_ln&#45;&gt;layer_2_gate_gpu_12</title>
<path fill="none" stroke="black" d="M25631.92,-525.27C25638.04,-515.05 25645.11,-503.26 25652.41,-491.08"/>
<polygon fill="black" stroke="black" points="25655.61,-492.55 25657.75,-482.17 25649.61,-488.95 25655.61,-492.55"/>
</g>
<!-- layer_2_gate_gpu_13 -->
<g id="node110" class="node">
<title>layer_2_gate_gpu_13</title>
<polygon fill="#d8bf0d" stroke="black" points="26816.8,-482 26238.08,-482 26089.2,-316 26667.92,-316 26816.8,-482"/>
<text text-anchor="middle" x="26453" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="26453" y="-410.3" font-family="Arial" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="26453" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="26453" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="26453" y="-365.3" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_2_attn_ln&#45;&gt;layer_2_gate_gpu_13 -->
<g id="edge169" class="edge">
<title>layer_2_attn_ln&#45;&gt;layer_2_gate_gpu_13</title>
<path fill="none" stroke="black" d="M25793.11,-539.41C25880.24,-528.93 25985.96,-514.31 26080,-496 26122.87,-487.65 26168.14,-477.32 26211.8,-466.55"/>
<polygon fill="black" stroke="black" points="26212.81,-469.9 26221.67,-464.1 26211.12,-463.11 26212.81,-469.9"/>
</g>
<!-- layer_2_gate_gpu_14 -->
<g id="node111" class="node">
<title>layer_2_gate_gpu_14</title>
<polygon fill="#e0e0e0" stroke="black" points="27562.8,-482 26984.08,-482 26835.2,-316 27413.92,-316 27562.8,-482"/>
<text text-anchor="middle" x="27199" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="27199" y="-410.3" font-family="Arial" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="27199" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="27199" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="27199" y="-365.3" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_2_attn_ln&#45;&gt;layer_2_gate_gpu_14 -->
<g id="edge170" class="edge">
<title>layer_2_attn_ln&#45;&gt;layer_2_gate_gpu_14</title>
<path fill="none" stroke="black" d="M25793.18,-553.63C26081.63,-545.12 26632.44,-525.58 26826,-496 26869.88,-489.29 26916.08,-479.61 26960.45,-468.95"/>
<polygon fill="black" stroke="black" points="26961.29,-472.34 26970.18,-466.58 26959.64,-465.54 26961.29,-472.34"/>
</g>
<!-- layer_2_gate_gpu_15 -->
<g id="node112" class="node">
<title>layer_2_gate_gpu_15</title>
<polygon fill="#fff8dc" stroke="black" points="28308.8,-482 27730.08,-482 27581.2,-316 28159.92,-316 28308.8,-482"/>
<text text-anchor="middle" x="27945" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="27945" y="-410.3" font-family="Arial" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="27945" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="27945" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="27945" y="-365.3" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_2_attn_ln&#45;&gt;layer_2_gate_gpu_15 -->
<g id="edge171" class="edge">
<title>layer_2_attn_ln&#45;&gt;layer_2_gate_gpu_15</title>
<path fill="none" stroke="black" d="M25793.34,-557.81C26211.22,-555.39 27232.13,-544.55 27572,-496 27615.94,-489.72 27662.17,-480.25 27706.55,-469.65"/>
<polygon fill="black" stroke="black" points="27707.39,-473.05 27716.29,-467.3 27705.75,-466.25 27707.39,-473.05"/>
</g>
<!-- layer_2_expert_0_gpu_8 -->
<g id="node123" class="node">
<title>layer_2_expert_0_gpu_8</title>
<polygon fill="#ffb6c1" stroke="black" points="23108.5,-271 22723.5,-271 22723.5,-188 23108.5,-188 23108.5,-271"/>
<text text-anchor="middle" x="22916" y="-255.8" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="22916" y="-240.8" font-family="Arial" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="22916" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="22916" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="22916" y="-195.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_2_gate_gpu_8&#45;&gt;layer_2_expert_0_gpu_8 -->
<g id="edge199" class="edge">
<title>layer_2_gate_gpu_8&#45;&gt;layer_2_expert_0_gpu_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22817.52,-315.97C22832.53,-302.94 22847.6,-289.86 22861.29,-277.98"/>
<polygon fill="black" stroke="black" points="22863.92,-280.34 22869.17,-271.14 22859.33,-275.05 22863.92,-280.34"/>
</g>
<!-- layer_2_expert_1_gpu_8 -->
<g id="node124" class="node">
<title>layer_2_expert_1_gpu_8</title>
<polygon fill="#ffb6c1" stroke="black" points="22705.5,-271 22320.5,-271 22320.5,-188 22705.5,-188 22705.5,-271"/>
<text text-anchor="middle" x="22513" y="-255.8" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="22513" y="-240.8" font-family="Arial" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="22513" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="22513" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="22513" y="-195.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_2_gate_gpu_8&#45;&gt;layer_2_expert_1_gpu_8 -->
<g id="edge200" class="edge">
<title>layer_2_gate_gpu_8&#45;&gt;layer_2_expert_1_gpu_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22620.15,-315.97C22603.67,-302.82 22587.11,-289.61 22572.11,-277.65"/>
<polygon fill="black" stroke="black" points="22573.95,-274.64 22563.95,-271.14 22569.59,-280.11 22573.95,-274.64"/>
</g>
<!-- layer_2_expert_2_gpu_9 -->
<g id="node125" class="node">
<title>layer_2_expert_2_gpu_9</title>
<polygon fill="#20b2aa" stroke="black" points="23914.5,-271 23529.5,-271 23529.5,-188 23914.5,-188 23914.5,-271"/>
<text text-anchor="middle" x="23722" y="-255.8" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="23722" y="-240.8" font-family="Arial" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="23722" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="23722" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="23722" y="-195.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_2_gate_gpu_9&#45;&gt;layer_2_expert_2_gpu_9 -->
<g id="edge201" class="edge">
<title>layer_2_gate_gpu_9&#45;&gt;layer_2_expert_2_gpu_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23592.91,-315.97C23613.13,-302.58 23633.45,-289.13 23651.78,-276.99"/>
<polygon fill="black" stroke="black" points="23654.21,-279.58 23660.62,-271.14 23650.35,-273.74 23654.21,-279.58"/>
</g>
<!-- layer_2_expert_3_gpu_9 -->
<g id="node126" class="node">
<title>layer_2_expert_3_gpu_9</title>
<polygon fill="#20b2aa" stroke="black" points="23511.5,-271 23126.5,-271 23126.5,-188 23511.5,-188 23511.5,-271"/>
<text text-anchor="middle" x="23319" y="-255.8" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="23319" y="-240.8" font-family="Arial" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="23319" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="23319" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="23319" y="-195.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_2_gate_gpu_9&#45;&gt;layer_2_expert_3_gpu_9 -->
<g id="edge202" class="edge">
<title>layer_2_gate_gpu_9&#45;&gt;layer_2_expert_3_gpu_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23395.32,-315.72C23383.89,-302.96 23372.43,-290.16 23361.98,-278.49"/>
<polygon fill="black" stroke="black" points="23364.55,-276.12 23355.27,-271 23359.34,-280.79 23364.55,-276.12"/>
</g>
<!-- layer_2_expert_4_gpu_10 -->
<g id="node127" class="node">
<title>layer_2_expert_4_gpu_10</title>
<polygon fill="#b0c4de" stroke="black" points="24720.5,-271 24335.5,-271 24335.5,-188 24720.5,-188 24720.5,-271"/>
<text text-anchor="middle" x="24528" y="-255.8" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="24528" y="-240.8" font-family="Arial" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="24528" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="24528" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="24528" y="-195.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_2_gate_gpu_10&#45;&gt;layer_2_expert_4_gpu_10 -->
<g id="edge203" class="edge">
<title>layer_2_gate_gpu_10&#45;&gt;layer_2_expert_4_gpu_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24368.29,-315.97C24394,-302.21 24419.82,-288.39 24442.98,-276"/>
<polygon fill="black" stroke="black" points="24444.89,-278.94 24452.06,-271.14 24441.59,-272.77 24444.89,-278.94"/>
</g>
<!-- layer_2_expert_5_gpu_10 -->
<g id="node128" class="node">
<title>layer_2_expert_5_gpu_10</title>
<polygon fill="#b0c4de" stroke="black" points="24317.5,-271 23932.5,-271 23932.5,-188 24317.5,-188 24317.5,-271"/>
<text text-anchor="middle" x="24125" y="-255.8" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="24125" y="-240.8" font-family="Arial" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="24125" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="24125" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="24125" y="-195.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_2_gate_gpu_10&#45;&gt;layer_2_expert_5_gpu_10 -->
<g id="edge204" class="edge">
<title>layer_2_gate_gpu_10&#45;&gt;layer_2_expert_5_gpu_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24170.79,-315.72C24164.2,-303.45 24157.58,-291.13 24151.51,-279.83"/>
<polygon fill="black" stroke="black" points="24154.58,-278.16 24146.76,-271 24148.41,-281.47 24154.58,-278.16"/>
</g>
<!-- layer_2_expert_6_gpu_11 -->
<g id="node129" class="node">
<title>layer_2_expert_6_gpu_11</title>
<polygon fill="#ffdead" stroke="black" points="25526.5,-271 25141.5,-271 25141.5,-188 25526.5,-188 25526.5,-271"/>
<text text-anchor="middle" x="25334" y="-255.8" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="25334" y="-240.8" font-family="Arial" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="25334" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="25334" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="25334" y="-195.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_2_gate_gpu_11&#45;&gt;layer_2_expert_6_gpu_11 -->
<g id="edge205" class="edge">
<title>layer_2_gate_gpu_11&#45;&gt;layer_2_expert_6_gpu_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M25143.68,-315.97C25174.85,-301.97 25206.17,-287.9 25234.15,-275.34"/>
<polygon fill="black" stroke="black" points="25235.81,-278.43 25243.5,-271.14 25232.95,-272.04 25235.81,-278.43"/>
</g>
<!-- layer_2_expert_7_gpu_11 -->
<g id="node130" class="node">
<title>layer_2_expert_7_gpu_11</title>
<polygon fill="#ffdead" stroke="black" points="25123.5,-271 24738.5,-271 24738.5,-188 25123.5,-188 25123.5,-271"/>
<text text-anchor="middle" x="24931" y="-255.8" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="24931" y="-240.8" font-family="Arial" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="24931" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="24931" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="24931" y="-195.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_2_gate_gpu_11&#45;&gt;layer_2_expert_7_gpu_11 -->
<g id="edge206" class="edge">
<title>layer_2_gate_gpu_11&#45;&gt;layer_2_expert_7_gpu_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24946.26,-315.72C24944.15,-303.94 24942.03,-292.11 24940.08,-281.18"/>
<polygon fill="black" stroke="black" points="24943.46,-280.23 24938.25,-271 24936.57,-281.46 24943.46,-280.23"/>
</g>
<!-- layer_2_expert_8_gpu_12 -->
<g id="node131" class="node">
<title>layer_2_expert_8_gpu_12</title>
<polygon fill="#9acd32" stroke="black" points="26332.5,-271 25947.5,-271 25947.5,-188 26332.5,-188 26332.5,-271"/>
<text text-anchor="middle" x="26140" y="-255.8" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="26140" y="-240.8" font-family="Arial" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="26140" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="26140" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="26140" y="-195.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_2_gate_gpu_12&#45;&gt;layer_2_expert_8_gpu_12 -->
<g id="edge207" class="edge">
<title>layer_2_gate_gpu_12&#45;&gt;layer_2_expert_8_gpu_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M25919.06,-315.97C25955.82,-301.75 25992.76,-287.46 26025.62,-274.75"/>
<polygon fill="black" stroke="black" points="26027.16,-277.9 26035.23,-271.03 26024.64,-271.37 26027.16,-277.9"/>
</g>
<!-- layer_2_expert_9_gpu_12 -->
<g id="node132" class="node">
<title>layer_2_expert_9_gpu_12</title>
<polygon fill="#9acd32" stroke="black" points="25929.5,-271 25544.5,-271 25544.5,-188 25929.5,-188 25929.5,-271"/>
<text text-anchor="middle" x="25737" y="-255.8" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="25737" y="-240.8" font-family="Arial" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="25737" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="25737" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="25737" y="-195.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_2_gate_gpu_12&#45;&gt;layer_2_expert_9_gpu_12 -->
<g id="edge208" class="edge">
<title>layer_2_gate_gpu_12&#45;&gt;layer_2_expert_9_gpu_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M25721.74,-315.72C25723.85,-303.94 25725.97,-292.11 25727.92,-281.18"/>
<polygon fill="black" stroke="black" points="25731.43,-281.46 25729.75,-271 25724.54,-280.23 25731.43,-281.46"/>
</g>
<!-- layer_2_expert_10_gpu_13 -->
<g id="node133" class="node">
<title>layer_2_expert_10_gpu_13</title>
<polygon fill="#d8bf0d" stroke="black" points="27138.5,-271 26753.5,-271 26753.5,-188 27138.5,-188 27138.5,-271"/>
<text text-anchor="middle" x="26946" y="-255.8" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="26946" y="-240.8" font-family="Arial" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="26946" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="26946" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="26946" y="-195.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_2_gate_gpu_13&#45;&gt;layer_2_expert_10_gpu_13 -->
<g id="edge209" class="edge">
<title>layer_2_gate_gpu_13&#45;&gt;layer_2_expert_10_gpu_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26674.69,-323.51C26698.1,-315.59 26721.54,-307.64 26744,-300 26768.28,-291.73 26794.19,-282.86 26819.07,-274.31"/>
<polygon fill="black" stroke="black" points="26820.23,-277.62 26828.55,-271.06 26817.95,-271 26820.23,-277.62"/>
</g>
<!-- layer_2_expert_11_gpu_13 -->
<g id="node134" class="node">
<title>layer_2_expert_11_gpu_13</title>
<polygon fill="#d8bf0d" stroke="black" points="26735.5,-271 26350.5,-271 26350.5,-188 26735.5,-188 26735.5,-271"/>
<text text-anchor="middle" x="26543" y="-255.8" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="26543" y="-240.8" font-family="Arial" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="26543" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="26543" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="26543" y="-195.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_2_gate_gpu_13&#45;&gt;layer_2_expert_11_gpu_13 -->
<g id="edge210" class="edge">
<title>layer_2_gate_gpu_13&#45;&gt;layer_2_expert_11_gpu_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26497.21,-315.72C26503.8,-303.45 26510.42,-291.13 26516.49,-279.83"/>
<polygon fill="black" stroke="black" points="26519.59,-281.47 26521.24,-271 26513.42,-278.16 26519.59,-281.47"/>
</g>
<!-- layer_2_expert_12_gpu_14 -->
<g id="node135" class="node">
<title>layer_2_expert_12_gpu_14</title>
<polygon fill="#e0e0e0" stroke="black" points="27944.5,-271 27559.5,-271 27559.5,-188 27944.5,-188 27944.5,-271"/>
<text text-anchor="middle" x="27752" y="-255.8" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="27752" y="-240.8" font-family="Arial" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="27752" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="27752" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="27752" y="-195.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_2_gate_gpu_14&#45;&gt;layer_2_expert_12_gpu_14 -->
<g id="edge211" class="edge">
<title>layer_2_gate_gpu_14&#45;&gt;layer_2_expert_12_gpu_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27431.33,-335.22C27471.04,-323.9 27511.79,-311.9 27550,-300 27575.55,-292.05 27602.73,-283.06 27628.61,-274.25"/>
<polygon fill="black" stroke="black" points="27629.75,-277.56 27638.08,-271.01 27627.49,-270.93 27629.75,-277.56"/>
</g>
<!-- layer_2_expert_13_gpu_14 -->
<g id="node136" class="node">
<title>layer_2_expert_13_gpu_14</title>
<polygon fill="#e0e0e0" stroke="black" points="27541.5,-271 27156.5,-271 27156.5,-188 27541.5,-188 27541.5,-271"/>
<text text-anchor="middle" x="27349" y="-255.8" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="27349" y="-240.8" font-family="Arial" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="27349" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="27349" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="27349" y="-195.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_2_gate_gpu_14&#45;&gt;layer_2_expert_13_gpu_14 -->
<g id="edge212" class="edge">
<title>layer_2_gate_gpu_14&#45;&gt;layer_2_expert_13_gpu_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27272.68,-315.72C27284.11,-302.96 27295.57,-290.16 27306.02,-278.49"/>
<polygon fill="black" stroke="black" points="27308.66,-280.79 27312.73,-271 27303.45,-276.12 27308.66,-280.79"/>
</g>
<!-- layer_2_expert_14_gpu_15 -->
<g id="node137" class="node">
<title>layer_2_expert_14_gpu_15</title>
<polygon fill="#fff8dc" stroke="black" points="28750.5,-271 28365.5,-271 28365.5,-188 28750.5,-188 28750.5,-271"/>
<text text-anchor="middle" x="28558" y="-255.8" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="28558" y="-240.8" font-family="Arial" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="28558" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="28558" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="28558" y="-195.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_2_gate_gpu_15&#45;&gt;layer_2_expert_14_gpu_15 -->
<g id="edge213" class="edge">
<title>layer_2_gate_gpu_15&#45;&gt;layer_2_expert_14_gpu_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M28185.91,-344.7C28242.01,-331.15 28301.32,-315.89 28356,-300 28382.33,-292.35 28410.29,-283.33 28436.76,-274.35"/>
<polygon fill="black" stroke="black" points="28438.1,-277.6 28446.43,-271.06 28435.84,-270.97 28438.1,-277.6"/>
</g>
<!-- layer_2_expert_15_gpu_15 -->
<g id="node138" class="node">
<title>layer_2_expert_15_gpu_15</title>
<polygon fill="#fff8dc" stroke="black" points="28347.5,-271 27962.5,-271 27962.5,-188 28347.5,-188 28347.5,-271"/>
<text text-anchor="middle" x="28155" y="-255.8" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="28155" y="-240.8" font-family="Arial" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="28155" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="28155" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="28155" y="-195.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_2_gate_gpu_15&#45;&gt;layer_2_expert_15_gpu_15 -->
<g id="edge214" class="edge">
<title>layer_2_gate_gpu_15&#45;&gt;layer_2_expert_15_gpu_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M28047.85,-315.97C28064.33,-302.82 28080.89,-289.61 28095.89,-277.65"/>
<polygon fill="black" stroke="black" points="28098.41,-280.11 28104.05,-271.14 28094.05,-274.64 28098.41,-280.11"/>
</g>
<!-- layer_2_attn_gpu_0 -->
<g id="node114" class="node">
<title>layer_2_attn_gpu_0</title>
<polygon fill="#ffe4e1" stroke="black" points="19576,-271 19210,-271 19210,-188 19576,-188 19576,-271"/>
<text text-anchor="middle" x="19393" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="19393" y="-240.8" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="19393" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="19393" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="19393" y="-195.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_2_kv_reduce&#45;&gt;layer_2_attn_gpu_0 -->
<g id="edge181" class="edge">
<title>layer_2_kv_reduce&#45;&gt;layer_2_attn_gpu_0</title>
<path fill="none" stroke="black" d="M21414.36,-394.89C20865.29,-388.18 19923.14,-366.96 19585,-300 19555.79,-294.22 19525.07,-284.74 19496.99,-274.63"/>
<polygon fill="black" stroke="black" points="19498.16,-271.33 19487.57,-271.18 19495.76,-277.9 19498.16,-271.33"/>
</g>
<!-- layer_2_attn_gpu_1 -->
<g id="node115" class="node">
<title>layer_2_attn_gpu_1</title>
<polygon fill="#e6e6fa" stroke="black" points="19960,-271 19594,-271 19594,-188 19960,-188 19960,-271"/>
<text text-anchor="middle" x="19777" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="19777" y="-240.8" font-family="Arial" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="19777" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="19777" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="19777" y="-195.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_2_kv_reduce&#45;&gt;layer_2_attn_gpu_1 -->
<g id="edge182" class="edge">
<title>layer_2_kv_reduce&#45;&gt;layer_2_attn_gpu_1</title>
<path fill="none" stroke="black" d="M21439.77,-390.96C20979.91,-380.24 20240.02,-354.94 19969,-300 19940.1,-294.14 19909.7,-284.75 19881.84,-274.74"/>
<polygon fill="black" stroke="black" points="19882.69,-271.33 19872.1,-271.18 19880.29,-277.9 19882.69,-271.33"/>
</g>
<!-- layer_2_attn_gpu_2 -->
<g id="node116" class="node">
<title>layer_2_attn_gpu_2</title>
<polygon fill="#f0e68c" stroke="black" points="20344,-271 19978,-271 19978,-188 20344,-188 20344,-271"/>
<text text-anchor="middle" x="20161" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="20161" y="-240.8" font-family="Arial" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="20161" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="20161" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="20161" y="-195.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_2_kv_reduce&#45;&gt;layer_2_attn_gpu_2 -->
<g id="edge183" class="edge">
<title>layer_2_kv_reduce&#45;&gt;layer_2_attn_gpu_2</title>
<path fill="none" stroke="black" d="M21472.13,-385.87C21105.77,-371.27 20558.76,-343.18 20353,-300 20324.29,-293.98 20294.08,-284.58 20266.34,-274.63"/>
<polygon fill="black" stroke="black" points="20267.24,-271.23 20256.64,-271.09 20264.84,-277.81 20267.24,-271.23"/>
</g>
<!-- layer_2_attn_gpu_3 -->
<g id="node117" class="node">
<title>layer_2_attn_gpu_3</title>
<polygon fill="#98fb98" stroke="black" points="20728,-271 20362,-271 20362,-188 20728,-188 20728,-271"/>
<text text-anchor="middle" x="20545" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="20545" y="-240.8" font-family="Arial" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="20545" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="20545" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="20545" y="-195.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_2_kv_reduce&#45;&gt;layer_2_attn_gpu_3 -->
<g id="edge184" class="edge">
<title>layer_2_kv_reduce&#45;&gt;layer_2_attn_gpu_3</title>
<path fill="none" stroke="black" d="M21456.28,-388.34C21243.79,-376.94 20973.04,-352.42 20737,-300 20708.67,-293.71 20678.83,-284.34 20651.34,-274.5"/>
<polygon fill="black" stroke="black" points="20652.32,-271.13 20641.73,-271 20649.93,-277.71 20652.32,-271.13"/>
</g>
<!-- layer_2_attn_gpu_4 -->
<g id="node118" class="node">
<title>layer_2_attn_gpu_4</title>
<polygon fill="#87ceeb" stroke="black" points="21112,-271 20746,-271 20746,-188 21112,-188 21112,-271"/>
<text text-anchor="middle" x="20929" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="20929" y="-240.8" font-family="Arial" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="20929" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="20929" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="20929" y="-195.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_2_kv_reduce&#45;&gt;layer_2_attn_gpu_4 -->
<g id="edge185" class="edge">
<title>layer_2_kv_reduce&#45;&gt;layer_2_attn_gpu_4</title>
<path fill="none" stroke="black" d="M21552.3,-373.43C21420.66,-358.2 21261.34,-334.75 21121,-300 21093.88,-293.28 21065.26,-284.12 21038.63,-274.64"/>
<polygon fill="black" stroke="black" points="21039.51,-271.24 21028.91,-271.14 21037.14,-277.82 21039.51,-271.24"/>
</g>
<!-- layer_2_attn_gpu_5 -->
<g id="node119" class="node">
<title>layer_2_attn_gpu_5</title>
<polygon fill="#dda0dd" stroke="black" points="21496,-271 21130,-271 21130,-188 21496,-188 21496,-271"/>
<text text-anchor="middle" x="21313" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="21313" y="-240.8" font-family="Arial" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="21313" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="21313" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="21313" y="-195.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_2_kv_reduce&#45;&gt;layer_2_attn_gpu_5 -->
<g id="edge186" class="edge">
<title>layer_2_kv_reduce&#45;&gt;layer_2_attn_gpu_5</title>
<path fill="none" stroke="black" d="M21676.47,-354.07C21622.27,-337.7 21560.69,-318.57 21505,-300 21481.17,-292.06 21455.83,-283.19 21431.64,-274.51"/>
<polygon fill="black" stroke="black" points="21432.66,-271.16 21422.07,-271.07 21430.29,-277.75 21432.66,-271.16"/>
</g>
<!-- layer_2_attn_gpu_6 -->
<g id="node120" class="node">
<title>layer_2_attn_gpu_6</title>
<polygon fill="#f4a460" stroke="black" points="21880,-271 21514,-271 21514,-188 21880,-188 21880,-271"/>
<text text-anchor="middle" x="21697" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="21697" y="-240.8" font-family="Arial" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="21697" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="21697" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="21697" y="-195.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_2_kv_reduce&#45;&gt;layer_2_attn_gpu_6 -->
<g id="edge187" class="edge">
<title>layer_2_kv_reduce&#45;&gt;layer_2_attn_gpu_6</title>
<path fill="none" stroke="black" d="M21779.79,-338C21765,-318.79 21748.8,-297.76 21734.69,-279.44"/>
<polygon fill="black" stroke="black" points="21737.24,-277.01 21728.36,-271.22 21731.69,-281.28 21737.24,-277.01"/>
</g>
<!-- layer_2_attn_gpu_7 -->
<g id="node121" class="node">
<title>layer_2_attn_gpu_7</title>
<polygon fill="#d3d3d3" stroke="black" points="22264,-271 21898,-271 21898,-188 22264,-188 22264,-271"/>
<text text-anchor="middle" x="22081" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="22081" y="-240.8" font-family="Arial" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="22081" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="22081" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="22081" y="-195.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_2_kv_reduce&#45;&gt;layer_2_attn_gpu_7 -->
<g id="edge188" class="edge">
<title>layer_2_kv_reduce&#45;&gt;layer_2_attn_gpu_7</title>
<path fill="none" stroke="black" d="M21908.79,-343.62C21941.62,-322.05 21978.99,-297.51 22010.5,-276.81"/>
<polygon fill="black" stroke="black" points="22012.79,-279.49 22019.22,-271.08 22008.94,-273.64 22012.79,-279.49"/>
</g>
<!-- layer_2_attn_agg -->
<g id="node122" class="node">
<title>layer_2_attn_agg</title>
<polygon fill="lightcoral" stroke="black" points="20929,-152 20491,-84 20929,-16 21367,-84 20929,-152"/>
<text text-anchor="middle" x="20929" y="-102.8" font-family="Arial" font-size="14.00">Attention Output All&#45;Reduce</text>
<text text-anchor="middle" x="20929" y="-87.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128] from 8 GPUs</text>
<text text-anchor="middle" x="20929" y="-72.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="20929" y="-57.8" font-family="Arial" font-size="14.00">GPU: All 0&#45;7</text>
</g>
<!-- layer_2_attn_gpu_0&#45;&gt;layer_2_attn_agg -->
<g id="edge189" class="edge">
<title>layer_2_attn_gpu_0&#45;&gt;layer_2_attn_agg</title>
<path fill="none" stroke="black" d="M19576.08,-189.32C19579.08,-188.86 19582.05,-188.42 19585,-188 19919.52,-140.11 20304.28,-113.48 20576.17,-99.35"/>
<polygon fill="black" stroke="black" points="20576.39,-102.85 20586.2,-98.84 20576.03,-95.86 20576.39,-102.85"/>
</g>
<!-- layer_2_attn_gpu_1&#45;&gt;layer_2_attn_agg -->
<g id="edge190" class="edge">
<title>layer_2_attn_gpu_1&#45;&gt;layer_2_attn_agg</title>
<path fill="none" stroke="black" d="M19960.1,-189.45C19963.09,-188.95 19966.06,-188.47 19969,-188 20191.11,-152.75 20444.08,-126.16 20634.56,-108.83"/>
<polygon fill="black" stroke="black" points="20635.08,-112.3 20644.73,-107.91 20634.45,-105.33 20635.08,-112.3"/>
</g>
<!-- layer_2_attn_gpu_2&#45;&gt;layer_2_attn_agg -->
<g id="edge191" class="edge">
<title>layer_2_attn_gpu_2&#45;&gt;layer_2_attn_agg</title>
<path fill="none" stroke="black" d="M20344.15,-189.73C20347.12,-189.15 20350.07,-188.57 20353,-188 20471.93,-164.83 20605.08,-140.89 20713.38,-121.93"/>
<polygon fill="black" stroke="black" points="20714.2,-125.34 20723.44,-120.17 20712.99,-118.44 20714.2,-125.34"/>
</g>
<!-- layer_2_attn_gpu_3&#45;&gt;layer_2_attn_agg -->
<g id="edge192" class="edge">
<title>layer_2_attn_gpu_3&#45;&gt;layer_2_attn_agg</title>
<path fill="none" stroke="black" d="M20653.5,-187.95C20696.76,-171.79 20747.05,-153 20792.72,-135.93"/>
<polygon fill="black" stroke="black" points="20793.95,-139.2 20802.1,-132.42 20791.5,-132.65 20793.95,-139.2"/>
</g>
<!-- layer_2_attn_gpu_4&#45;&gt;layer_2_attn_agg -->
<g id="edge193" class="edge">
<title>layer_2_attn_gpu_4&#45;&gt;layer_2_attn_agg</title>
<path fill="none" stroke="black" d="M20929,-187.76C20929,-179.78 20929,-171.17 20929,-162.44"/>
<polygon fill="black" stroke="black" points="20932.5,-162.17 20929,-152.17 20925.5,-162.17 20932.5,-162.17"/>
</g>
<!-- layer_2_attn_gpu_5&#45;&gt;layer_2_attn_agg -->
<g id="edge194" class="edge">
<title>layer_2_attn_gpu_5&#45;&gt;layer_2_attn_agg</title>
<path fill="none" stroke="black" d="M21204.5,-187.95C21161.24,-171.79 21110.95,-153 21065.28,-135.93"/>
<polygon fill="black" stroke="black" points="21066.5,-132.65 21055.9,-132.42 21064.05,-139.2 21066.5,-132.65"/>
</g>
<!-- layer_2_attn_gpu_6&#45;&gt;layer_2_attn_agg -->
<g id="edge195" class="edge">
<title>layer_2_attn_gpu_6&#45;&gt;layer_2_attn_agg</title>
<path fill="none" stroke="black" d="M21513.85,-189.73C21510.88,-189.15 21507.93,-188.57 21505,-188 21386.07,-164.83 21252.92,-140.89 21144.62,-121.93"/>
<polygon fill="black" stroke="black" points="21145.01,-118.44 21134.56,-120.17 21143.8,-125.34 21145.01,-118.44"/>
</g>
<!-- layer_2_attn_gpu_7&#45;&gt;layer_2_attn_agg -->
<g id="edge196" class="edge">
<title>layer_2_attn_gpu_7&#45;&gt;layer_2_attn_agg</title>
<path fill="none" stroke="black" d="M21897.9,-189.45C21894.91,-188.95 21891.94,-188.47 21889,-188 21666.89,-152.75 21413.92,-126.16 21223.44,-108.83"/>
<polygon fill="black" stroke="black" points="21223.55,-105.33 21213.27,-107.91 21222.92,-112.3 21223.55,-105.33"/>
</g>
<!-- layer_2_attn_agg&#45;&gt;layer_2_attn_ln -->
<g id="edge197" class="edge">
<title>layer_2_attn_agg&#45;&gt;layer_2_attn_ln</title>
<path fill="none" stroke="black" d="M21316.29,-91.9C21687.2,-102.12 22200.97,-127.19 22273,-188 22326.91,-233.51 22294.55,-452.38 22350,-496 22383.54,-522.38 25379.58,-513.38 25422,-518 25435.36,-519.46 25449.15,-521.44 25462.94,-523.75"/>
<polygon fill="black" stroke="black" points="25462.51,-527.23 25472.96,-525.49 25463.71,-520.33 25462.51,-527.23"/>
</g>
<!-- layer_2_expert_agg -->
<g id="node139" class="node">
<title>layer_2_expert_agg</title>
<polygon fill="yellow" stroke="black" points="26226.2,-152 25448,-152 25247.8,-16 26026,-16 26226.2,-152"/>
<text text-anchor="middle" x="25737" y="-102.8" font-family="Arial" font-size="14.00">Expert Aggregation (Top&#45;2)</text>
<text text-anchor="middle" x="25737" y="-87.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, expert_hidden=16384] from 16 experts</text>
<text text-anchor="middle" x="25737" y="-72.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="25737" y="-57.8" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_2_expert_0_gpu_8&#45;&gt;layer_2_expert_agg -->
<g id="edge215" class="edge">
<title>layer_2_expert_0_gpu_8&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M23108.73,-189.03C23111.5,-188.67 23114.26,-188.33 23117,-188 23537.2,-137.73 24729.11,-106.15 25350.07,-92.63"/>
<polygon fill="black" stroke="black" points="25350.16,-96.13 25360.08,-92.41 25350.01,-89.13 25350.16,-96.13"/>
</g>
<!-- layer_2_expert_1_gpu_8&#45;&gt;layer_2_expert_agg -->
<g id="edge216" class="edge">
<title>layer_2_expert_1_gpu_8&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M22705.73,-189.01C22708.5,-188.66 22711.26,-188.32 22714,-188 23211.86,-129.76 24648.31,-101.1 25346.62,-90.3"/>
<polygon fill="black" stroke="black" points="25346.9,-93.79 25356.84,-90.14 25346.79,-86.79 25346.9,-93.79"/>
</g>
<!-- layer_2_expert_2_gpu_9&#45;&gt;layer_2_expert_agg -->
<g id="edge217" class="edge">
<title>layer_2_expert_2_gpu_9&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M23914.74,-189.1C23917.51,-188.72 23920.26,-188.35 23923,-188 24411.7,-125.21 24979.37,-100.7 25347.71,-91.13"/>
<polygon fill="black" stroke="black" points="25347.82,-94.63 25357.73,-90.87 25347.64,-87.63 25347.82,-94.63"/>
</g>
<!-- layer_2_expert_3_gpu_9&#45;&gt;layer_2_expert_agg -->
<g id="edge218" class="edge">
<title>layer_2_expert_3_gpu_9&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M23511.73,-189.06C23514.51,-188.69 23517.26,-188.34 23520,-188 24153.09,-109.97 24894.51,-89.79 25339.39,-85.27"/>
<polygon fill="black" stroke="black" points="25339.55,-88.77 25349.51,-85.17 25339.48,-81.77 25339.55,-88.77"/>
</g>
<!-- layer_2_expert_4_gpu_10&#45;&gt;layer_2_expert_agg -->
<g id="edge219" class="edge">
<title>layer_2_expert_4_gpu_10&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M24720.76,-189.27C24723.53,-188.84 24726.27,-188.41 24729,-188 24943.87,-155.45 25186.1,-130.33 25379.24,-113.05"/>
<polygon fill="black" stroke="black" points="25379.62,-116.53 25389.27,-112.16 25379,-109.56 25379.62,-116.53"/>
</g>
<!-- layer_2_expert_5_gpu_10&#45;&gt;layer_2_expert_agg -->
<g id="edge220" class="edge">
<title>layer_2_expert_5_gpu_10&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M24317.75,-189.16C24320.51,-188.76 24323.27,-188.37 24326,-188 24674.58,-140.35 25074.82,-113.78 25359.78,-99.61"/>
<polygon fill="black" stroke="black" points="25360.06,-103.1 25369.87,-99.11 25359.71,-96.11 25360.06,-103.1"/>
</g>
<!-- layer_2_expert_6_gpu_11&#45;&gt;layer_2_expert_agg -->
<g id="edge221" class="edge">
<title>layer_2_expert_6_gpu_11&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M25447.87,-187.95C25476.34,-177.81 25507.72,-166.64 25538.98,-155.51"/>
<polygon fill="black" stroke="black" points="25540.43,-158.71 25548.68,-152.06 25538.09,-152.11 25540.43,-158.71"/>
</g>
<!-- layer_2_expert_7_gpu_11&#45;&gt;layer_2_expert_agg -->
<g id="edge222" class="edge">
<title>layer_2_expert_7_gpu_11&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M25123.54,-189.58C25126.38,-189.05 25129.2,-188.52 25132,-188 25223.59,-170.98 25323.2,-153.57 25414.66,-138.02"/>
<polygon fill="black" stroke="black" points="25415.35,-141.45 25424.62,-136.33 25414.18,-134.55 25415.35,-141.45"/>
</g>
<!-- layer_2_expert_8_gpu_12&#45;&gt;layer_2_expert_agg -->
<g id="edge223" class="edge">
<title>layer_2_expert_8_gpu_12&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M26026.13,-187.95C25997.66,-177.81 25966.28,-166.64 25935.02,-155.51"/>
<polygon fill="black" stroke="black" points="25935.91,-152.11 25925.32,-152.06 25933.57,-158.71 25935.91,-152.11"/>
</g>
<!-- layer_2_expert_9_gpu_12&#45;&gt;layer_2_expert_agg -->
<g id="edge224" class="edge">
<title>layer_2_expert_9_gpu_12&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M25737,-187.76C25737,-179.78 25737,-171.17 25737,-162.44"/>
<polygon fill="black" stroke="black" points="25740.5,-162.17 25737,-152.17 25733.5,-162.17 25740.5,-162.17"/>
</g>
<!-- layer_2_expert_10_gpu_13&#45;&gt;layer_2_expert_agg -->
<g id="edge225" class="edge">
<title>layer_2_expert_10_gpu_13&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M26753.35,-189.45C26750.21,-188.95 26747.09,-188.47 26744,-188 26563.85,-160.79 26364.45,-138.73 26190.95,-122.1"/>
<polygon fill="black" stroke="black" points="26191.16,-118.61 26180.88,-121.14 26190.5,-125.58 26191.16,-118.61"/>
</g>
<!-- layer_2_expert_11_gpu_13&#45;&gt;layer_2_expert_agg -->
<g id="edge226" class="edge">
<title>layer_2_expert_11_gpu_13&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M26350.3,-189.74C26347.18,-189.15 26344.08,-188.57 26341,-188 26279.2,-176.54 26213.74,-164.88 26149.62,-153.72"/>
<polygon fill="black" stroke="black" points="26150.2,-150.27 26139.75,-152.01 26149,-157.17 26150.2,-150.27"/>
</g>
<!-- layer_2_expert_12_gpu_14&#45;&gt;layer_2_expert_agg -->
<g id="edge227" class="edge">
<title>layer_2_expert_12_gpu_14&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M27559.38,-189.25C27556.23,-188.81 27553.1,-188.4 27550,-188 27070.84,-126.67 26515.75,-101.85 26147.3,-91.82"/>
<polygon fill="black" stroke="black" points="26147.36,-88.32 26137.27,-91.55 26147.17,-95.31 26147.36,-88.32"/>
</g>
<!-- layer_2_expert_13_gpu_14&#45;&gt;layer_2_expert_agg -->
<g id="edge228" class="edge">
<title>layer_2_expert_13_gpu_14&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M27156.37,-189.32C27153.23,-188.86 27150.1,-188.42 27147,-188 26818.04,-143.19 26443.06,-116.97 26162.53,-102.22"/>
<polygon fill="black" stroke="black" points="26162.34,-98.7 26152.17,-101.67 26161.98,-105.69 26162.34,-98.7"/>
</g>
<!-- layer_2_expert_14_gpu_15&#45;&gt;layer_2_expert_agg -->
<g id="edge229" class="edge">
<title>layer_2_expert_14_gpu_15&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M28365.39,-189.17C28362.24,-188.76 28359.11,-188.37 28356,-188 27941.69,-138.64 26777.02,-107.14 26149.62,-93.25"/>
<polygon fill="black" stroke="black" points="26149.58,-89.74 26139.5,-93.02 26149.42,-96.74 26149.58,-89.74"/>
</g>
<!-- layer_2_expert_15_gpu_15&#45;&gt;layer_2_expert_agg -->
<g id="edge230" class="edge">
<title>layer_2_expert_15_gpu_15&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M27962.38,-189.21C27959.24,-188.78 27956.11,-188.38 27953,-188 27322.05,-110.54 26583.53,-90.15 26138.43,-85.43"/>
<polygon fill="black" stroke="black" points="26138.33,-81.93 26128.29,-85.33 26138.26,-88.93 26138.33,-81.93"/>
</g>
<!-- layer_2_expert_agg&#45;&gt;layer_2_output -->
<g id="edge231" class="edge">
<title>layer_2_expert_agg&#45;&gt;layer_2_output</title>
<path fill="none" stroke="black" d="M26127.29,-84.77C26922.73,-86.15 28664.76,-99.33 28759,-188 28793.14,-220.12 28779,-351.12 28779,-398 28779,-560.5 28779,-560.5 28779,-560.5 28779,-710.74 26488.37,-812.28 25803.29,-839.28"/>
<polygon fill="black" stroke="black" points="25802.92,-835.79 25793.07,-839.69 25803.2,-842.79 25802.92,-835.79"/>
</g>
<!-- layer_3_output -->
<g id="node140" class="node">
<title>layer_3_output</title>
<polygon fill="#ffe4b5" stroke="black" points="37242,-881.48 36880,-881.48 36880,-813.48 37242,-813.48 37242,-881.48"/>
<text text-anchor="middle" x="37061" y="-866.28" font-family="Arial" font-size="14.00">Layer 4 Output</text>
<text text-anchor="middle" x="37061" y="-851.28" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="37061" y="-836.28" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="37061" y="-821.28" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_3_distribute -->
<g id="node141" class="node">
<title>layer_3_distribute</title>
<polygon fill="lightcoral" stroke="black" points="33832,-773 33389,-705 33832,-637 34275,-705 33832,-773"/>
<text text-anchor="middle" x="33832" y="-723.8" font-family="Arial" font-size="14.00">Layer 4 Input Distribution</text>
<text text-anchor="middle" x="33832" y="-708.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="33832" y="-693.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, hidden_dim=4096] replicated 8x</text>
<text text-anchor="middle" x="33832" y="-678.8" font-family="Arial" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- layer_3_output&#45;&gt;layer_3_distribute -->
<g id="edge232" class="edge">
<title>layer_3_output&#45;&gt;layer_3_distribute</title>
<path fill="none" stroke="black" d="M36879.89,-838.6C36361.8,-816.06 34867.01,-751.03 34182.2,-721.24"/>
<polygon fill="black" stroke="black" points="34182.32,-717.74 34172.18,-720.8 34182.02,-724.73 34182.32,-717.74"/>
</g>
<!-- output -->
<g id="node186" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" stroke-width="2" cx="38143" cy="-705" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="38143" y="-723.8" font-family="Arial" font-size="14.00">Model Output</text>
<text text-anchor="middle" x="38143" y="-708.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="38143" y="-693.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="38143" y="-678.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_3_output&#45;&gt;output -->
<g id="edge309" class="edge">
<title>layer_3_output&#45;&gt;output</title>
<path fill="none" stroke="black" d="M37242.12,-842.98C37446.28,-837.93 37765.09,-826.38 37883,-802 37935.02,-791.24 37990.52,-771.91 38036.83,-753.4"/>
<polygon fill="black" stroke="black" points="38038.31,-756.58 38046.27,-749.59 38035.69,-750.09 38038.31,-756.58"/>
</g>
<!-- layer_3_qkv_gpu_0 -->
<g id="node142" class="node">
<title>layer_3_qkv_gpu_0</title>
<polygon fill="#ffe4e1" stroke="black" points="32287,-601 31921,-601 31921,-518 32287,-518 32287,-601"/>
<text text-anchor="middle" x="32104" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="32104" y="-570.8" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="32104" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="32104" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="32104" y="-525.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_3_distribute&#45;&gt;layer_3_qkv_gpu_0 -->
<g id="edge233" class="edge">
<title>layer_3_distribute&#45;&gt;layer_3_qkv_gpu_0</title>
<path fill="none" stroke="black" d="M33461.57,-693.79C33152.12,-681.79 32699.55,-656.19 32297.17,-601.11"/>
<polygon fill="black" stroke="black" points="32297.46,-597.61 32287.08,-599.72 32296.51,-604.55 32297.46,-597.61"/>
</g>
<!-- layer_3_qkv_gpu_1 -->
<g id="node143" class="node">
<title>layer_3_qkv_gpu_1</title>
<polygon fill="#e6e6fa" stroke="black" points="32671,-601 32305,-601 32305,-518 32671,-518 32671,-601"/>
<text text-anchor="middle" x="32488" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="32488" y="-570.8" font-family="Arial" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="32488" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="32488" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="32488" y="-525.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_3_distribute&#45;&gt;layer_3_qkv_gpu_1 -->
<g id="edge234" class="edge">
<title>layer_3_distribute&#45;&gt;layer_3_qkv_gpu_1</title>
<path fill="none" stroke="black" d="M33514.2,-685.77C33284.9,-670.17 32968.03,-643.6 32681.28,-601.14"/>
<polygon fill="black" stroke="black" points="32681.5,-597.64 32671.09,-599.63 32680.47,-604.56 32681.5,-597.64"/>
</g>
<!-- layer_3_qkv_gpu_2 -->
<g id="node144" class="node">
<title>layer_3_qkv_gpu_2</title>
<polygon fill="#f0e68c" stroke="black" points="33055,-601 32689,-601 32689,-518 33055,-518 33055,-601"/>
<text text-anchor="middle" x="32872" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="32872" y="-570.8" font-family="Arial" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="32872" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="32872" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="32872" y="-525.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_3_distribute&#45;&gt;layer_3_qkv_gpu_2 -->
<g id="edge235" class="edge">
<title>layer_3_distribute&#45;&gt;layer_3_qkv_gpu_2</title>
<path fill="none" stroke="black" d="M33582.25,-675.29C33434.49,-657.13 33243.58,-631.66 33065.22,-601.18"/>
<polygon fill="black" stroke="black" points="33065.57,-597.69 33055.12,-599.45 33064.39,-604.59 33065.57,-597.69"/>
</g>
<!-- layer_3_qkv_gpu_3 -->
<g id="node145" class="node">
<title>layer_3_qkv_gpu_3</title>
<polygon fill="#98fb98" stroke="black" points="33439,-601 33073,-601 33073,-518 33439,-518 33439,-601"/>
<text text-anchor="middle" x="33256" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="33256" y="-570.8" font-family="Arial" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="33256" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="33256" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="33256" y="-525.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_3_distribute&#45;&gt;layer_3_qkv_gpu_3 -->
<g id="edge236" class="edge">
<title>layer_3_distribute&#45;&gt;layer_3_qkv_gpu_3</title>
<path fill="none" stroke="black" d="M33665.4,-662.49C33591.15,-644 33503.72,-622.22 33428.77,-603.54"/>
<polygon fill="black" stroke="black" points="33429.3,-600.07 33418.75,-601.05 33427.61,-606.86 33429.3,-600.07"/>
</g>
<!-- layer_3_qkv_gpu_4 -->
<g id="node146" class="node">
<title>layer_3_qkv_gpu_4</title>
<polygon fill="#87ceeb" stroke="black" points="33823,-601 33457,-601 33457,-518 33823,-518 33823,-601"/>
<text text-anchor="middle" x="33640" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="33640" y="-570.8" font-family="Arial" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="33640" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="33640" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="33640" y="-525.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_3_distribute&#45;&gt;layer_3_qkv_gpu_4 -->
<g id="edge237" class="edge">
<title>layer_3_distribute&#45;&gt;layer_3_qkv_gpu_4</title>
<path fill="none" stroke="black" d="M33757.49,-648.31C33739.38,-634.77 33720.18,-620.43 33702.68,-607.34"/>
<polygon fill="black" stroke="black" points="33704.33,-604.21 33694.23,-601.03 33700.14,-609.82 33704.33,-604.21"/>
</g>
<!-- layer_3_qkv_gpu_5 -->
<g id="node147" class="node">
<title>layer_3_qkv_gpu_5</title>
<polygon fill="#dda0dd" stroke="black" points="34207,-601 33841,-601 33841,-518 34207,-518 34207,-601"/>
<text text-anchor="middle" x="34024" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="34024" y="-570.8" font-family="Arial" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="34024" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="34024" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="34024" y="-525.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_3_distribute&#45;&gt;layer_3_qkv_gpu_5 -->
<g id="edge238" class="edge">
<title>layer_3_distribute&#45;&gt;layer_3_qkv_gpu_5</title>
<path fill="none" stroke="black" d="M33906.51,-648.31C33924.62,-634.77 33943.82,-620.43 33961.32,-607.34"/>
<polygon fill="black" stroke="black" points="33963.86,-609.82 33969.77,-601.03 33959.67,-604.21 33963.86,-609.82"/>
</g>
<!-- layer_3_qkv_gpu_6 -->
<g id="node148" class="node">
<title>layer_3_qkv_gpu_6</title>
<polygon fill="#f4a460" stroke="black" points="34591,-601 34225,-601 34225,-518 34591,-518 34591,-601"/>
<text text-anchor="middle" x="34408" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="34408" y="-570.8" font-family="Arial" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="34408" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="34408" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="34408" y="-525.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_3_distribute&#45;&gt;layer_3_qkv_gpu_6 -->
<g id="edge239" class="edge">
<title>layer_3_distribute&#45;&gt;layer_3_qkv_gpu_6</title>
<path fill="none" stroke="black" d="M33998.6,-662.49C34072.85,-644 34160.28,-622.22 34235.23,-603.54"/>
<polygon fill="black" stroke="black" points="34236.39,-606.86 34245.25,-601.05 34234.7,-600.07 34236.39,-606.86"/>
</g>
<!-- layer_3_qkv_gpu_7 -->
<g id="node149" class="node">
<title>layer_3_qkv_gpu_7</title>
<polygon fill="#d3d3d3" stroke="black" points="34975,-601 34609,-601 34609,-518 34975,-518 34975,-601"/>
<text text-anchor="middle" x="34792" y="-585.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="34792" y="-570.8" font-family="Arial" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="34792" y="-555.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="34792" y="-540.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="34792" y="-525.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_3_distribute&#45;&gt;layer_3_qkv_gpu_7 -->
<g id="edge240" class="edge">
<title>layer_3_distribute&#45;&gt;layer_3_qkv_gpu_7</title>
<path fill="none" stroke="black" d="M34081.75,-675.29C34229.51,-657.13 34420.42,-631.66 34598.78,-601.18"/>
<polygon fill="black" stroke="black" points="34599.61,-604.59 34608.88,-599.45 34598.43,-597.69 34599.61,-604.59"/>
</g>
<!-- layer_3_attn_ln -->
<g id="node150" class="node">
<title>layer_3_attn_ln</title>
<polygon fill="#ffe4b5" stroke="black" points="35355,-593.5 34993,-593.5 34993,-525.5 35355,-525.5 35355,-593.5"/>
<text text-anchor="middle" x="35174" y="-578.3" font-family="Arial" font-size="14.00">LayerNorm + Residual</text>
<text text-anchor="middle" x="35174" y="-563.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="35174" y="-548.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="35174" y="-533.3" font-family="Arial" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer_3_distribute&#45;&gt;layer_3_attn_ln -->
<g id="edge275" class="edge">
<title>layer_3_distribute&#45;&gt;layer_3_attn_ln</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34150.76,-685.88C34382.72,-670.18 34703.91,-643.21 34984,-601 34995.03,-599.34 35006.38,-597.43 35017.78,-595.37"/>
<polygon fill="black" stroke="black" points="35018.61,-598.77 35027.81,-593.52 35017.34,-591.89 35018.61,-598.77"/>
</g>
<!-- layer_3_kv_reduce -->
<g id="node159" class="node">
<title>layer_3_kv_reduce</title>
<polygon fill="lightcoral" stroke="black" points="31423,-467 30985,-399 31423,-331 31861,-399 31423,-467"/>
<text text-anchor="middle" x="31423" y="-417.8" font-family="Arial" font-size="14.00">KV All&#45;Reduce</text>
<text text-anchor="middle" x="31423" y="-402.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128] from 8 GPUs</text>
<text text-anchor="middle" x="31423" y="-387.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="31423" y="-372.8" font-family="Arial" font-size="14.00">GPU: All 0&#45;7</text>
</g>
<!-- layer_3_qkv_gpu_0&#45;&gt;layer_3_kv_reduce -->
<g id="edge250" class="edge">
<title>layer_3_qkv_gpu_0&#45;&gt;layer_3_kv_reduce</title>
<path fill="none" stroke="black" d="M31929.95,-517.99C31830.7,-494.89 31706.42,-465.96 31605.75,-442.54"/>
<polygon fill="black" stroke="black" points="31606.31,-439.07 31595.78,-440.21 31604.72,-445.89 31606.31,-439.07"/>
</g>
<!-- layer_3_qkv_gpu_1&#45;&gt;layer_3_kv_reduce -->
<g id="edge251" class="edge">
<title>layer_3_qkv_gpu_1&#45;&gt;layer_3_kv_reduce</title>
<path fill="none" stroke="black" d="M32304.93,-519.22C32301.93,-518.79 32298.96,-518.39 32296,-518 32110.22,-493.7 32060.77,-520.43 31875,-496 31782.62,-483.85 31681.02,-462.97 31597.58,-443.77"/>
<polygon fill="black" stroke="black" points="31598.29,-440.34 31587.76,-441.5 31596.71,-447.16 31598.29,-440.34"/>
</g>
<!-- layer_3_qkv_gpu_2&#45;&gt;layer_3_kv_reduce -->
<g id="edge252" class="edge">
<title>layer_3_qkv_gpu_2&#45;&gt;layer_3_kv_reduce</title>
<path fill="none" stroke="black" d="M32688.94,-519.12C32685.94,-518.72 32682.96,-518.35 32680,-518 32324.56,-476 32230.41,-538.24 31875,-496 31781.51,-484.89 31678.75,-463.79 31594.87,-444.2"/>
<polygon fill="black" stroke="black" points="31595.53,-440.76 31584.99,-441.88 31593.93,-447.57 31595.53,-440.76"/>
</g>
<!-- layer_3_qkv_gpu_3&#45;&gt;layer_3_kv_reduce -->
<g id="edge253" class="edge">
<title>layer_3_qkv_gpu_3&#45;&gt;layer_3_kv_reduce</title>
<path fill="none" stroke="black" d="M33072.95,-519.08C33069.95,-518.7 33066.96,-518.34 33064,-518 32538.85,-458.3 32400.11,-556.06 31875,-496 31781.18,-485.27 31678.07,-464.11 31594.05,-444.38"/>
<polygon fill="black" stroke="black" points="31594.7,-440.94 31584.16,-442.04 31593.09,-447.75 31594.7,-440.94"/>
</g>
<!-- layer_3_qkv_gpu_4&#45;&gt;layer_3_kv_reduce -->
<g id="edge254" class="edge">
<title>layer_3_qkv_gpu_4&#45;&gt;layer_3_kv_reduce</title>
<path fill="none" stroke="black" d="M33456.95,-519.06C33453.95,-518.68 33450.96,-518.33 33448,-518 33100.56,-479.3 32222.41,-534.94 31875,-496 31780.96,-485.46 31677.62,-464.25 31593.52,-444.44"/>
<polygon fill="black" stroke="black" points="31594.16,-441 31583.62,-442.1 31592.54,-447.81 31594.16,-441"/>
</g>
<!-- layer_3_qkv_gpu_5&#45;&gt;layer_3_kv_reduce -->
<g id="edge255" class="edge">
<title>layer_3_qkv_gpu_5&#45;&gt;layer_3_kv_reduce</title>
<path fill="none" stroke="black" d="M33840.95,-519.05C33837.95,-518.68 33834.96,-518.33 33832,-518 33399.69,-470.44 32307.28,-543.86 31875,-496 31780.85,-485.58 31677.4,-464.35 31593.25,-444.5"/>
<polygon fill="black" stroke="black" points="31593.88,-441.05 31583.34,-442.14 31592.27,-447.86 31593.88,-441.05"/>
</g>
<!-- layer_3_qkv_gpu_6&#45;&gt;layer_3_kv_reduce -->
<g id="edge256" class="edge">
<title>layer_3_qkv_gpu_6&#45;&gt;layer_3_kv_reduce</title>
<path fill="none" stroke="black" d="M34224.95,-519.04C34221.95,-518.67 34218.96,-518.32 34216,-518 33698.82,-461.59 32392.14,-552.77 31875,-496 31780.75,-485.65 31677.18,-464.4 31592.98,-444.51"/>
<polygon fill="black" stroke="black" points="31593.61,-441.06 31583.07,-442.16 31591.99,-447.87 31593.61,-441.06"/>
</g>
<!-- layer_3_qkv_gpu_7&#45;&gt;layer_3_kv_reduce -->
<g id="edge257" class="edge">
<title>layer_3_qkv_gpu_7&#45;&gt;layer_3_kv_reduce</title>
<path fill="none" stroke="black" d="M34608.95,-519.04C34605.95,-518.67 34602.96,-518.32 34600,-518 33997.95,-452.74 32477,-561.68 31875,-496 31780.74,-485.72 31677.17,-464.46 31592.98,-444.56"/>
<polygon fill="black" stroke="black" points="31593.61,-441.12 31583.07,-442.21 31591.99,-447.93 31593.61,-441.12"/>
</g>
<!-- layer_3_attn_ln&#45;&gt;layer_3_output -->
<g id="edge249" class="edge">
<title>layer_3_attn_ln&#45;&gt;layer_3_output</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35355.32,-587.98C35712.52,-642.11 36504.19,-762.09 36869.49,-817.45"/>
<polygon fill="black" stroke="black" points="36869.23,-820.95 36879.64,-818.99 36870.28,-814.03 36869.23,-820.95"/>
</g>
<!-- layer_3_gate_gpu_8 -->
<g id="node151" class="node">
<title>layer_3_gate_gpu_8</title>
<polygon fill="#ffb6c1" stroke="black" points="32648.8,-482 32070.08,-482 31921.2,-316 32499.92,-316 32648.8,-482"/>
<text text-anchor="middle" x="32285" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="32285" y="-410.3" font-family="Arial" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="32285" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="32285" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="32285" y="-365.3" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_3_attn_ln&#45;&gt;layer_3_gate_gpu_8 -->
<g id="edge241" class="edge">
<title>layer_3_attn_ln&#45;&gt;layer_3_gate_gpu_8</title>
<path fill="none" stroke="black" d="M35034.7,-525.48C35017.7,-522.44 35000.51,-519.82 34984,-518 34727.1,-489.69 32914.25,-529.68 32658,-496 32634.4,-492.9 32610.15,-488.8 32585.89,-484.05"/>
<polygon fill="black" stroke="black" points="32586.36,-480.57 32575.87,-482.05 32584.99,-487.44 32586.36,-480.57"/>
</g>
<!-- layer_3_gate_gpu_9 -->
<g id="node152" class="node">
<title>layer_3_gate_gpu_9</title>
<polygon fill="#20b2aa" stroke="black" points="33394.8,-482 32816.08,-482 32667.2,-316 33245.92,-316 33394.8,-482"/>
<text text-anchor="middle" x="33031" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="33031" y="-410.3" font-family="Arial" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="33031" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="33031" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="33031" y="-365.3" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_3_attn_ln&#45;&gt;layer_3_gate_gpu_9 -->
<g id="edge242" class="edge">
<title>layer_3_attn_ln&#45;&gt;layer_3_gate_gpu_9</title>
<path fill="none" stroke="black" d="M35034.17,-525.46C35017.35,-522.44 35000.34,-519.84 34984,-518 34635.05,-478.76 33752.05,-542.53 33404,-496 33380.55,-492.87 33356.46,-488.76 33332.36,-484.02"/>
<polygon fill="black" stroke="black" points="33332.89,-480.56 33322.39,-482.03 33331.51,-487.42 33332.89,-480.56"/>
</g>
<!-- layer_3_gate_gpu_10 -->
<g id="node153" class="node">
<title>layer_3_gate_gpu_10</title>
<polygon fill="#b0c4de" stroke="black" points="34140.8,-482 33562.08,-482 33413.2,-316 33991.92,-316 34140.8,-482"/>
<text text-anchor="middle" x="33777" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="33777" y="-410.3" font-family="Arial" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="33777" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="33777" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="33777" y="-365.3" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_3_attn_ln&#45;&gt;layer_3_gate_gpu_10 -->
<g id="edge243" class="edge">
<title>layer_3_attn_ln&#45;&gt;layer_3_gate_gpu_10</title>
<path fill="none" stroke="black" d="M35033.11,-525.47C35016.63,-522.5 34999.99,-519.9 34984,-518 34615.79,-474.28 34517.21,-547.43 34150,-496 34127.18,-492.8 34103.75,-488.73 34080.29,-484.07"/>
<polygon fill="black" stroke="black" points="34080.73,-480.59 34070.23,-482.04 34079.34,-487.45 34080.73,-480.59"/>
</g>
<!-- layer_3_gate_gpu_11 -->
<g id="node154" class="node">
<title>layer_3_gate_gpu_11</title>
<polygon fill="#ffdead" stroke="black" points="34886.8,-482 34308.08,-482 34159.2,-316 34737.92,-316 34886.8,-482"/>
<text text-anchor="middle" x="34523" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="34523" y="-410.3" font-family="Arial" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="34523" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="34523" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="34523" y="-365.3" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_3_attn_ln&#45;&gt;layer_3_gate_gpu_11 -->
<g id="edge244" class="edge">
<title>layer_3_attn_ln&#45;&gt;layer_3_gate_gpu_11</title>
<path fill="none" stroke="black" d="M35023.03,-525.45C34981.78,-516.17 34937.12,-505.91 34896,-496 34880.59,-492.29 34864.84,-488.44 34848.93,-484.51"/>
<polygon fill="black" stroke="black" points="34849.56,-481.06 34839.01,-482.05 34847.88,-487.85 34849.56,-481.06"/>
</g>
<!-- layer_3_gate_gpu_12 -->
<g id="node155" class="node">
<title>layer_3_gate_gpu_12</title>
<polygon fill="#9acd32" stroke="black" points="35632.8,-482 35054.08,-482 34905.2,-316 35483.92,-316 35632.8,-482"/>
<text text-anchor="middle" x="35269" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="35269" y="-410.3" font-family="Arial" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="35269" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="35269" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="35269" y="-365.3" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_3_attn_ln&#45;&gt;layer_3_gate_gpu_12 -->
<g id="edge245" class="edge">
<title>layer_3_attn_ln&#45;&gt;layer_3_gate_gpu_12</title>
<path fill="none" stroke="black" d="M35193.92,-525.27C35200.04,-515.05 35207.11,-503.26 35214.41,-491.08"/>
<polygon fill="black" stroke="black" points="35217.61,-492.55 35219.75,-482.17 35211.61,-488.95 35217.61,-492.55"/>
</g>
<!-- layer_3_gate_gpu_13 -->
<g id="node156" class="node">
<title>layer_3_gate_gpu_13</title>
<polygon fill="#d8bf0d" stroke="black" points="36378.8,-482 35800.08,-482 35651.2,-316 36229.92,-316 36378.8,-482"/>
<text text-anchor="middle" x="36015" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="36015" y="-410.3" font-family="Arial" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="36015" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="36015" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="36015" y="-365.3" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_3_attn_ln&#45;&gt;layer_3_gate_gpu_13 -->
<g id="edge246" class="edge">
<title>layer_3_attn_ln&#45;&gt;layer_3_gate_gpu_13</title>
<path fill="none" stroke="black" d="M35355.11,-539.41C35442.24,-528.93 35547.96,-514.31 35642,-496 35684.87,-487.65 35730.14,-477.32 35773.8,-466.55"/>
<polygon fill="black" stroke="black" points="35774.81,-469.9 35783.67,-464.1 35773.12,-463.11 35774.81,-469.9"/>
</g>
<!-- layer_3_gate_gpu_14 -->
<g id="node157" class="node">
<title>layer_3_gate_gpu_14</title>
<polygon fill="#e0e0e0" stroke="black" points="37124.8,-482 36546.08,-482 36397.2,-316 36975.92,-316 37124.8,-482"/>
<text text-anchor="middle" x="36761" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="36761" y="-410.3" font-family="Arial" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="36761" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="36761" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="36761" y="-365.3" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_3_attn_ln&#45;&gt;layer_3_gate_gpu_14 -->
<g id="edge247" class="edge">
<title>layer_3_attn_ln&#45;&gt;layer_3_gate_gpu_14</title>
<path fill="none" stroke="black" d="M35355.18,-553.63C35643.63,-545.12 36194.44,-525.58 36388,-496 36431.88,-489.29 36478.08,-479.61 36522.45,-468.95"/>
<polygon fill="black" stroke="black" points="36523.29,-472.34 36532.18,-466.58 36521.64,-465.54 36523.29,-472.34"/>
</g>
<!-- layer_3_gate_gpu_15 -->
<g id="node158" class="node">
<title>layer_3_gate_gpu_15</title>
<polygon fill="#fff8dc" stroke="black" points="37870.8,-482 37292.08,-482 37143.2,-316 37721.92,-316 37870.8,-482"/>
<text text-anchor="middle" x="37507" y="-425.3" font-family="Arial" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="37507" y="-410.3" font-family="Arial" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="37507" y="-395.3" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="37507" y="-380.3" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="37507" y="-365.3" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_3_attn_ln&#45;&gt;layer_3_gate_gpu_15 -->
<g id="edge248" class="edge">
<title>layer_3_attn_ln&#45;&gt;layer_3_gate_gpu_15</title>
<path fill="none" stroke="black" d="M35355.34,-557.81C35773.22,-555.39 36794.13,-544.55 37134,-496 37177.94,-489.72 37224.17,-480.25 37268.55,-469.65"/>
<polygon fill="black" stroke="black" points="37269.39,-473.05 37278.29,-467.3 37267.75,-466.25 37269.39,-473.05"/>
</g>
<!-- layer_3_expert_0_gpu_8 -->
<g id="node169" class="node">
<title>layer_3_expert_0_gpu_8</title>
<polygon fill="#ffb6c1" stroke="black" points="32705.5,-271 32320.5,-271 32320.5,-188 32705.5,-188 32705.5,-271"/>
<text text-anchor="middle" x="32513" y="-255.8" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="32513" y="-240.8" font-family="Arial" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="32513" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="32513" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="32513" y="-195.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_3_gate_gpu_8&#45;&gt;layer_3_expert_0_gpu_8 -->
<g id="edge276" class="edge">
<title>layer_3_gate_gpu_8&#45;&gt;layer_3_expert_0_gpu_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32396.66,-315.97C32414.73,-302.7 32432.87,-289.37 32449.27,-277.32"/>
<polygon fill="black" stroke="black" points="32451.7,-279.88 32457.68,-271.14 32447.55,-274.24 32451.7,-279.88"/>
</g>
<!-- layer_3_expert_1_gpu_8 -->
<g id="node170" class="node">
<title>layer_3_expert_1_gpu_8</title>
<polygon fill="#ffb6c1" stroke="black" points="32302.5,-271 31917.5,-271 31917.5,-188 32302.5,-188 32302.5,-271"/>
<text text-anchor="middle" x="32110" y="-255.8" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="32110" y="-240.8" font-family="Arial" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="32110" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="32110" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="32110" y="-195.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_3_gate_gpu_8&#45;&gt;layer_3_expert_1_gpu_8 -->
<g id="edge277" class="edge">
<title>layer_3_gate_gpu_8&#45;&gt;layer_3_expert_1_gpu_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32199.29,-315.97C32185.81,-303.06 32172.27,-290.1 32159.96,-278.32"/>
<polygon fill="black" stroke="black" points="32162.1,-275.53 32152.46,-271.14 32157.26,-280.58 32162.1,-275.53"/>
</g>
<!-- layer_3_expert_2_gpu_9 -->
<g id="node171" class="node">
<title>layer_3_expert_2_gpu_9</title>
<polygon fill="#20b2aa" stroke="black" points="33511.5,-271 33126.5,-271 33126.5,-188 33511.5,-188 33511.5,-271"/>
<text text-anchor="middle" x="33319" y="-255.8" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="33319" y="-240.8" font-family="Arial" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="33319" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="33319" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="33319" y="-195.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_3_gate_gpu_9&#45;&gt;layer_3_expert_2_gpu_9 -->
<g id="edge278" class="edge">
<title>layer_3_gate_gpu_9&#45;&gt;layer_3_expert_2_gpu_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33172.05,-315.97C33195.49,-302.33 33219.04,-288.64 33240.21,-276.33"/>
<polygon fill="black" stroke="black" points="33242.24,-279.19 33249.13,-271.14 33238.72,-273.14 33242.24,-279.19"/>
</g>
<!-- layer_3_expert_3_gpu_9 -->
<g id="node172" class="node">
<title>layer_3_expert_3_gpu_9</title>
<polygon fill="#20b2aa" stroke="black" points="33108.5,-271 32723.5,-271 32723.5,-188 33108.5,-188 33108.5,-271"/>
<text text-anchor="middle" x="32916" y="-255.8" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="32916" y="-240.8" font-family="Arial" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="32916" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="32916" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="32916" y="-195.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_3_gate_gpu_9&#45;&gt;layer_3_expert_3_gpu_9 -->
<g id="edge279" class="edge">
<title>layer_3_gate_gpu_9&#45;&gt;layer_3_expert_3_gpu_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32974.51,-315.72C32966,-303.33 32957.46,-290.89 32949.64,-279.5"/>
<polygon fill="black" stroke="black" points="32952.35,-277.27 32943.81,-271 32946.58,-281.23 32952.35,-277.27"/>
</g>
<!-- layer_3_expert_4_gpu_10 -->
<g id="node173" class="node">
<title>layer_3_expert_4_gpu_10</title>
<polygon fill="#b0c4de" stroke="black" points="34317.5,-271 33932.5,-271 33932.5,-188 34317.5,-188 34317.5,-271"/>
<text text-anchor="middle" x="34125" y="-255.8" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="34125" y="-240.8" font-family="Arial" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="34125" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="34125" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="34125" y="-195.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_3_gate_gpu_10&#45;&gt;layer_3_expert_4_gpu_10 -->
<g id="edge280" class="edge">
<title>layer_3_gate_gpu_10&#45;&gt;layer_3_expert_4_gpu_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33947.43,-315.97C33976.39,-302.03 34005.49,-288.02 34031.5,-275.5"/>
<polygon fill="black" stroke="black" points="34033.08,-278.63 34040.57,-271.14 34030.04,-272.32 34033.08,-278.63"/>
</g>
<!-- layer_3_expert_5_gpu_10 -->
<g id="node174" class="node">
<title>layer_3_expert_5_gpu_10</title>
<polygon fill="#b0c4de" stroke="black" points="33914.5,-271 33529.5,-271 33529.5,-188 33914.5,-188 33914.5,-271"/>
<text text-anchor="middle" x="33722" y="-255.8" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="33722" y="-240.8" font-family="Arial" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="33722" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="33722" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="33722" y="-195.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_3_gate_gpu_10&#45;&gt;layer_3_expert_5_gpu_10 -->
<g id="edge281" class="edge">
<title>layer_3_gate_gpu_10&#45;&gt;layer_3_expert_5_gpu_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33749.98,-315.72C33746.07,-303.81 33742.15,-291.87 33738.53,-280.84"/>
<polygon fill="black" stroke="black" points="33741.74,-279.41 33735.3,-271 33735.09,-281.6 33741.74,-279.41"/>
</g>
<!-- layer_3_expert_6_gpu_11 -->
<g id="node175" class="node">
<title>layer_3_expert_6_gpu_11</title>
<polygon fill="#ffdead" stroke="black" points="35123.5,-271 34738.5,-271 34738.5,-188 35123.5,-188 35123.5,-271"/>
<text text-anchor="middle" x="34931" y="-255.8" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="34931" y="-240.8" font-family="Arial" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="34931" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="34931" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="34931" y="-195.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_3_gate_gpu_11&#45;&gt;layer_3_expert_6_gpu_11 -->
<g id="edge282" class="edge">
<title>layer_3_gate_gpu_11&#45;&gt;layer_3_expert_6_gpu_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34722.82,-315.97C34757.31,-301.81 34791.96,-287.58 34822.82,-274.91"/>
<polygon fill="black" stroke="black" points="34824.35,-278.07 34832.27,-271.03 34821.69,-271.59 34824.35,-278.07"/>
</g>
<!-- layer_3_expert_7_gpu_11 -->
<g id="node176" class="node">
<title>layer_3_expert_7_gpu_11</title>
<polygon fill="#ffdead" stroke="black" points="34720.5,-271 34335.5,-271 34335.5,-188 34720.5,-188 34720.5,-271"/>
<text text-anchor="middle" x="34528" y="-255.8" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="34528" y="-240.8" font-family="Arial" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="34528" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="34528" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="34528" y="-195.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_3_gate_gpu_11&#45;&gt;layer_3_expert_7_gpu_11 -->
<g id="edge283" class="edge">
<title>layer_3_gate_gpu_11&#45;&gt;layer_3_expert_7_gpu_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34525.46,-315.72C34525.81,-303.94 34526.16,-292.11 34526.49,-281.18"/>
<polygon fill="black" stroke="black" points="34529.99,-281.1 34526.79,-271 34522.99,-280.89 34529.99,-281.1"/>
</g>
<!-- layer_3_expert_8_gpu_12 -->
<g id="node177" class="node">
<title>layer_3_expert_8_gpu_12</title>
<polygon fill="#9acd32" stroke="black" points="35929.5,-271 35544.5,-271 35544.5,-188 35929.5,-188 35929.5,-271"/>
<text text-anchor="middle" x="35737" y="-255.8" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="35737" y="-240.8" font-family="Arial" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="35737" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="35737" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="35737" y="-195.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_3_gate_gpu_12&#45;&gt;layer_3_expert_8_gpu_12 -->
<g id="edge284" class="edge">
<title>layer_3_gate_gpu_12&#45;&gt;layer_3_expert_8_gpu_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35487.59,-319.77C35531.05,-304.21 35575.22,-288.4 35614.07,-274.5"/>
<polygon fill="black" stroke="black" points="35615.59,-277.67 35623.83,-271 35613.24,-271.08 35615.59,-277.67"/>
</g>
<!-- layer_3_expert_9_gpu_12 -->
<g id="node178" class="node">
<title>layer_3_expert_9_gpu_12</title>
<polygon fill="#9acd32" stroke="black" points="35526.5,-271 35141.5,-271 35141.5,-188 35526.5,-188 35526.5,-271"/>
<text text-anchor="middle" x="35334" y="-255.8" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="35334" y="-240.8" font-family="Arial" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="35334" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="35334" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="35334" y="-195.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_3_gate_gpu_12&#45;&gt;layer_3_expert_9_gpu_12 -->
<g id="edge285" class="edge">
<title>layer_3_gate_gpu_12&#45;&gt;layer_3_expert_9_gpu_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35300.93,-315.72C35305.6,-303.69 35310.28,-291.62 35314.6,-280.5"/>
<polygon fill="black" stroke="black" points="35317.93,-281.59 35318.28,-271 35311.4,-279.06 35317.93,-281.59"/>
</g>
<!-- layer_3_expert_10_gpu_13 -->
<g id="node179" class="node">
<title>layer_3_expert_10_gpu_13</title>
<polygon fill="#d8bf0d" stroke="black" points="36735.5,-271 36350.5,-271 36350.5,-188 36735.5,-188 36735.5,-271"/>
<text text-anchor="middle" x="36543" y="-255.8" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="36543" y="-240.8" font-family="Arial" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="36543" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="36543" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="36543" y="-195.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_3_gate_gpu_13&#45;&gt;layer_3_expert_10_gpu_13 -->
<g id="edge286" class="edge">
<title>layer_3_gate_gpu_13&#45;&gt;layer_3_expert_10_gpu_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36243.63,-330.81C36276.7,-320.7 36310.27,-310.23 36342,-300 36366.93,-291.96 36393.47,-283.04 36418.83,-274.34"/>
<polygon fill="black" stroke="black" points="36420.16,-277.58 36428.48,-271.02 36417.89,-270.96 36420.16,-277.58"/>
</g>
<!-- layer_3_expert_11_gpu_13 -->
<g id="node180" class="node">
<title>layer_3_expert_11_gpu_13</title>
<polygon fill="#d8bf0d" stroke="black" points="36332.5,-271 35947.5,-271 35947.5,-188 36332.5,-188 36332.5,-271"/>
<text text-anchor="middle" x="36140" y="-255.8" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="36140" y="-240.8" font-family="Arial" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="36140" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="36140" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="36140" y="-195.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_3_gate_gpu_13&#45;&gt;layer_3_expert_11_gpu_13 -->
<g id="edge287" class="edge">
<title>layer_3_gate_gpu_13&#45;&gt;layer_3_expert_11_gpu_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36076.4,-315.72C36085.74,-303.21 36095.11,-290.65 36103.69,-279.16"/>
<polygon fill="black" stroke="black" points="36106.6,-281.11 36109.77,-271 36100.99,-276.92 36106.6,-281.11"/>
</g>
<!-- layer_3_expert_12_gpu_14 -->
<g id="node181" class="node">
<title>layer_3_expert_12_gpu_14</title>
<polygon fill="#e0e0e0" stroke="black" points="37541.5,-271 37156.5,-271 37156.5,-188 37541.5,-188 37541.5,-271"/>
<text text-anchor="middle" x="37349" y="-255.8" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="37349" y="-240.8" font-family="Arial" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="37349" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="37349" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="37349" y="-195.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_3_gate_gpu_14&#45;&gt;layer_3_expert_12_gpu_14 -->
<g id="edge288" class="edge">
<title>layer_3_gate_gpu_14&#45;&gt;layer_3_expert_12_gpu_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36998.77,-341.18C37048.3,-328.39 37100.02,-314.34 37148,-300 37173.91,-292.25 37201.46,-283.25 37227.57,-274.34"/>
<polygon fill="black" stroke="black" points="37228.8,-277.62 37237.12,-271.07 37226.53,-271 37228.8,-277.62"/>
</g>
<!-- layer_3_expert_13_gpu_14 -->
<g id="node182" class="node">
<title>layer_3_expert_13_gpu_14</title>
<polygon fill="#e0e0e0" stroke="black" points="37138.5,-271 36753.5,-271 36753.5,-188 37138.5,-188 37138.5,-271"/>
<text text-anchor="middle" x="36946" y="-255.8" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="36946" y="-240.8" font-family="Arial" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="36946" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="36946" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="36946" y="-195.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_3_gate_gpu_14&#45;&gt;layer_3_expert_13_gpu_14 -->
<g id="edge289" class="edge">
<title>layer_3_gate_gpu_14&#45;&gt;layer_3_expert_13_gpu_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36851.6,-315.97C36865.99,-302.94 36880.44,-289.86 36893.56,-277.98"/>
<polygon fill="black" stroke="black" points="36896.05,-280.45 36901.12,-271.14 36891.35,-275.26 36896.05,-280.45"/>
</g>
<!-- layer_3_expert_14_gpu_15 -->
<g id="node183" class="node">
<title>layer_3_expert_14_gpu_15</title>
<polygon fill="#fff8dc" stroke="black" points="38347.5,-271 37962.5,-271 37962.5,-188 38347.5,-188 38347.5,-271"/>
<text text-anchor="middle" x="38155" y="-255.8" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="38155" y="-240.8" font-family="Arial" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="38155" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="38155" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="38155" y="-195.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_3_gate_gpu_15&#45;&gt;layer_3_expert_14_gpu_15 -->
<g id="edge290" class="edge">
<title>layer_3_gate_gpu_15&#45;&gt;layer_3_expert_14_gpu_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37752.17,-349.66C37818.09,-335.2 37889.09,-318.27 37954,-300 37980.59,-292.52 38008.8,-283.47 38035.42,-274.42"/>
<polygon fill="black" stroke="black" points="38036.83,-277.63 38045.15,-271.08 38034.56,-271.01 38036.83,-277.63"/>
</g>
<!-- layer_3_expert_15_gpu_15 -->
<g id="node184" class="node">
<title>layer_3_expert_15_gpu_15</title>
<polygon fill="#fff8dc" stroke="black" points="37944.5,-271 37559.5,-271 37559.5,-188 37944.5,-188 37944.5,-271"/>
<text text-anchor="middle" x="37752" y="-255.8" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="37752" y="-240.8" font-family="Arial" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="37752" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="37752" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, expert_hidden=16384]</text>
<text text-anchor="middle" x="37752" y="-195.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_3_gate_gpu_15&#45;&gt;layer_3_expert_15_gpu_15 -->
<g id="edge291" class="edge">
<title>layer_3_gate_gpu_15&#45;&gt;layer_3_expert_15_gpu_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37626.99,-315.97C37646.58,-302.58 37666.25,-289.13 37684,-276.99"/>
<polygon fill="black" stroke="black" points="37686.28,-279.67 37692.56,-271.14 37682.33,-273.89 37686.28,-279.67"/>
</g>
<!-- layer_3_attn_gpu_0 -->
<g id="node160" class="node">
<title>layer_3_attn_gpu_0</title>
<polygon fill="#ffe4e1" stroke="black" points="29173,-271 28807,-271 28807,-188 29173,-188 29173,-271"/>
<text text-anchor="middle" x="28990" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="28990" y="-240.8" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="28990" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="28990" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="28990" y="-195.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_3_kv_reduce&#45;&gt;layer_3_attn_gpu_0 -->
<g id="edge258" class="edge">
<title>layer_3_kv_reduce&#45;&gt;layer_3_attn_gpu_0</title>
<path fill="none" stroke="black" d="M31011.36,-394.89C30462.29,-388.18 29520.14,-366.96 29182,-300 29152.79,-294.22 29122.07,-284.74 29093.99,-274.63"/>
<polygon fill="black" stroke="black" points="29095.16,-271.33 29084.57,-271.18 29092.76,-277.9 29095.16,-271.33"/>
</g>
<!-- layer_3_attn_gpu_1 -->
<g id="node161" class="node">
<title>layer_3_attn_gpu_1</title>
<polygon fill="#e6e6fa" stroke="black" points="29557,-271 29191,-271 29191,-188 29557,-188 29557,-271"/>
<text text-anchor="middle" x="29374" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="29374" y="-240.8" font-family="Arial" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="29374" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="29374" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="29374" y="-195.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_3_kv_reduce&#45;&gt;layer_3_attn_gpu_1 -->
<g id="edge259" class="edge">
<title>layer_3_kv_reduce&#45;&gt;layer_3_attn_gpu_1</title>
<path fill="none" stroke="black" d="M31036.77,-390.96C30576.91,-380.24 29837.02,-354.94 29566,-300 29537.1,-294.14 29506.7,-284.75 29478.84,-274.74"/>
<polygon fill="black" stroke="black" points="29479.69,-271.33 29469.1,-271.18 29477.29,-277.9 29479.69,-271.33"/>
</g>
<!-- layer_3_attn_gpu_2 -->
<g id="node162" class="node">
<title>layer_3_attn_gpu_2</title>
<polygon fill="#f0e68c" stroke="black" points="29941,-271 29575,-271 29575,-188 29941,-188 29941,-271"/>
<text text-anchor="middle" x="29758" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="29758" y="-240.8" font-family="Arial" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="29758" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="29758" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="29758" y="-195.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_3_kv_reduce&#45;&gt;layer_3_attn_gpu_2 -->
<g id="edge260" class="edge">
<title>layer_3_kv_reduce&#45;&gt;layer_3_attn_gpu_2</title>
<path fill="none" stroke="black" d="M31069.13,-385.87C30702.77,-371.27 30155.76,-343.18 29950,-300 29921.29,-293.98 29891.08,-284.58 29863.34,-274.63"/>
<polygon fill="black" stroke="black" points="29864.24,-271.23 29853.64,-271.09 29861.84,-277.81 29864.24,-271.23"/>
</g>
<!-- layer_3_attn_gpu_3 -->
<g id="node163" class="node">
<title>layer_3_attn_gpu_3</title>
<polygon fill="#98fb98" stroke="black" points="30325,-271 29959,-271 29959,-188 30325,-188 30325,-271"/>
<text text-anchor="middle" x="30142" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="30142" y="-240.8" font-family="Arial" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="30142" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="30142" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="30142" y="-195.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_3_kv_reduce&#45;&gt;layer_3_attn_gpu_3 -->
<g id="edge261" class="edge">
<title>layer_3_kv_reduce&#45;&gt;layer_3_attn_gpu_3</title>
<path fill="none" stroke="black" d="M31053.28,-388.34C30840.79,-376.94 30570.04,-352.42 30334,-300 30305.67,-293.71 30275.83,-284.34 30248.34,-274.5"/>
<polygon fill="black" stroke="black" points="30249.32,-271.13 30238.73,-271 30246.93,-277.71 30249.32,-271.13"/>
</g>
<!-- layer_3_attn_gpu_4 -->
<g id="node164" class="node">
<title>layer_3_attn_gpu_4</title>
<polygon fill="#87ceeb" stroke="black" points="30709,-271 30343,-271 30343,-188 30709,-188 30709,-271"/>
<text text-anchor="middle" x="30526" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="30526" y="-240.8" font-family="Arial" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="30526" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="30526" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="30526" y="-195.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_3_kv_reduce&#45;&gt;layer_3_attn_gpu_4 -->
<g id="edge262" class="edge">
<title>layer_3_kv_reduce&#45;&gt;layer_3_attn_gpu_4</title>
<path fill="none" stroke="black" d="M31149.3,-373.43C31017.66,-358.2 30858.34,-334.75 30718,-300 30690.88,-293.28 30662.26,-284.12 30635.63,-274.64"/>
<polygon fill="black" stroke="black" points="30636.51,-271.24 30625.91,-271.14 30634.14,-277.82 30636.51,-271.24"/>
</g>
<!-- layer_3_attn_gpu_5 -->
<g id="node165" class="node">
<title>layer_3_attn_gpu_5</title>
<polygon fill="#dda0dd" stroke="black" points="31093,-271 30727,-271 30727,-188 31093,-188 31093,-271"/>
<text text-anchor="middle" x="30910" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="30910" y="-240.8" font-family="Arial" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="30910" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="30910" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="30910" y="-195.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_3_kv_reduce&#45;&gt;layer_3_attn_gpu_5 -->
<g id="edge263" class="edge">
<title>layer_3_kv_reduce&#45;&gt;layer_3_attn_gpu_5</title>
<path fill="none" stroke="black" d="M31273.47,-354.07C31219.27,-337.7 31157.69,-318.57 31102,-300 31078.17,-292.06 31052.83,-283.19 31028.64,-274.51"/>
<polygon fill="black" stroke="black" points="31029.66,-271.16 31019.07,-271.07 31027.29,-277.75 31029.66,-271.16"/>
</g>
<!-- layer_3_attn_gpu_6 -->
<g id="node166" class="node">
<title>layer_3_attn_gpu_6</title>
<polygon fill="#f4a460" stroke="black" points="31477,-271 31111,-271 31111,-188 31477,-188 31477,-271"/>
<text text-anchor="middle" x="31294" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="31294" y="-240.8" font-family="Arial" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="31294" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="31294" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="31294" y="-195.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_3_kv_reduce&#45;&gt;layer_3_attn_gpu_6 -->
<g id="edge264" class="edge">
<title>layer_3_kv_reduce&#45;&gt;layer_3_attn_gpu_6</title>
<path fill="none" stroke="black" d="M31376.79,-338C31362,-318.79 31345.8,-297.76 31331.69,-279.44"/>
<polygon fill="black" stroke="black" points="31334.24,-277.01 31325.36,-271.22 31328.69,-281.28 31334.24,-277.01"/>
</g>
<!-- layer_3_attn_gpu_7 -->
<g id="node167" class="node">
<title>layer_3_attn_gpu_7</title>
<polygon fill="#d3d3d3" stroke="black" points="31861,-271 31495,-271 31495,-188 31861,-188 31861,-271"/>
<text text-anchor="middle" x="31678" y="-255.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="31678" y="-240.8" font-family="Arial" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="31678" y="-225.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="31678" y="-210.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="31678" y="-195.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_3_kv_reduce&#45;&gt;layer_3_attn_gpu_7 -->
<g id="edge265" class="edge">
<title>layer_3_kv_reduce&#45;&gt;layer_3_attn_gpu_7</title>
<path fill="none" stroke="black" d="M31505.79,-343.62C31538.62,-322.05 31575.99,-297.51 31607.5,-276.81"/>
<polygon fill="black" stroke="black" points="31609.79,-279.49 31616.22,-271.08 31605.94,-273.64 31609.79,-279.49"/>
</g>
<!-- layer_3_attn_agg -->
<g id="node168" class="node">
<title>layer_3_attn_agg</title>
<polygon fill="lightcoral" stroke="black" points="30526,-152 30088,-84 30526,-16 30964,-84 30526,-152"/>
<text text-anchor="middle" x="30526" y="-102.8" font-family="Arial" font-size="14.00">Attention Output All&#45;Reduce</text>
<text text-anchor="middle" x="30526" y="-87.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, heads=4, d_k=128] from 8 GPUs</text>
<text text-anchor="middle" x="30526" y="-72.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="30526" y="-57.8" font-family="Arial" font-size="14.00">GPU: All 0&#45;7</text>
</g>
<!-- layer_3_attn_gpu_0&#45;&gt;layer_3_attn_agg -->
<g id="edge266" class="edge">
<title>layer_3_attn_gpu_0&#45;&gt;layer_3_attn_agg</title>
<path fill="none" stroke="black" d="M29173.08,-189.32C29176.08,-188.86 29179.05,-188.42 29182,-188 29516.52,-140.11 29901.28,-113.48 30173.17,-99.35"/>
<polygon fill="black" stroke="black" points="30173.39,-102.85 30183.2,-98.84 30173.03,-95.86 30173.39,-102.85"/>
</g>
<!-- layer_3_attn_gpu_1&#45;&gt;layer_3_attn_agg -->
<g id="edge267" class="edge">
<title>layer_3_attn_gpu_1&#45;&gt;layer_3_attn_agg</title>
<path fill="none" stroke="black" d="M29557.1,-189.45C29560.09,-188.95 29563.06,-188.47 29566,-188 29788.11,-152.75 30041.08,-126.16 30231.56,-108.83"/>
<polygon fill="black" stroke="black" points="30232.08,-112.3 30241.73,-107.91 30231.45,-105.33 30232.08,-112.3"/>
</g>
<!-- layer_3_attn_gpu_2&#45;&gt;layer_3_attn_agg -->
<g id="edge268" class="edge">
<title>layer_3_attn_gpu_2&#45;&gt;layer_3_attn_agg</title>
<path fill="none" stroke="black" d="M29941.15,-189.73C29944.12,-189.15 29947.07,-188.57 29950,-188 30068.93,-164.83 30202.08,-140.89 30310.38,-121.93"/>
<polygon fill="black" stroke="black" points="30311.2,-125.34 30320.44,-120.17 30309.99,-118.44 30311.2,-125.34"/>
</g>
<!-- layer_3_attn_gpu_3&#45;&gt;layer_3_attn_agg -->
<g id="edge269" class="edge">
<title>layer_3_attn_gpu_3&#45;&gt;layer_3_attn_agg</title>
<path fill="none" stroke="black" d="M30250.5,-187.95C30293.76,-171.79 30344.05,-153 30389.72,-135.93"/>
<polygon fill="black" stroke="black" points="30390.95,-139.2 30399.1,-132.42 30388.5,-132.65 30390.95,-139.2"/>
</g>
<!-- layer_3_attn_gpu_4&#45;&gt;layer_3_attn_agg -->
<g id="edge270" class="edge">
<title>layer_3_attn_gpu_4&#45;&gt;layer_3_attn_agg</title>
<path fill="none" stroke="black" d="M30526,-187.76C30526,-179.78 30526,-171.17 30526,-162.44"/>
<polygon fill="black" stroke="black" points="30529.5,-162.17 30526,-152.17 30522.5,-162.17 30529.5,-162.17"/>
</g>
<!-- layer_3_attn_gpu_5&#45;&gt;layer_3_attn_agg -->
<g id="edge271" class="edge">
<title>layer_3_attn_gpu_5&#45;&gt;layer_3_attn_agg</title>
<path fill="none" stroke="black" d="M30801.5,-187.95C30758.24,-171.79 30707.95,-153 30662.28,-135.93"/>
<polygon fill="black" stroke="black" points="30663.5,-132.65 30652.9,-132.42 30661.05,-139.2 30663.5,-132.65"/>
</g>
<!-- layer_3_attn_gpu_6&#45;&gt;layer_3_attn_agg -->
<g id="edge272" class="edge">
<title>layer_3_attn_gpu_6&#45;&gt;layer_3_attn_agg</title>
<path fill="none" stroke="black" d="M31110.85,-189.73C31107.88,-189.15 31104.93,-188.57 31102,-188 30983.07,-164.83 30849.92,-140.89 30741.62,-121.93"/>
<polygon fill="black" stroke="black" points="30742.01,-118.44 30731.56,-120.17 30740.8,-125.34 30742.01,-118.44"/>
</g>
<!-- layer_3_attn_gpu_7&#45;&gt;layer_3_attn_agg -->
<g id="edge273" class="edge">
<title>layer_3_attn_gpu_7&#45;&gt;layer_3_attn_agg</title>
<path fill="none" stroke="black" d="M31494.9,-189.45C31491.91,-188.95 31488.94,-188.47 31486,-188 31263.89,-152.75 31010.92,-126.16 30820.44,-108.83"/>
<polygon fill="black" stroke="black" points="30820.55,-105.33 30810.27,-107.91 30819.92,-112.3 30820.55,-105.33"/>
</g>
<!-- layer_3_attn_agg&#45;&gt;layer_3_attn_ln -->
<g id="edge274" class="edge">
<title>layer_3_attn_agg&#45;&gt;layer_3_attn_ln</title>
<path fill="none" stroke="black" d="M30922.51,-90.5C31293.91,-99.61 31801.89,-123.79 31870,-188 31970.53,-282.76 31808.24,-404.78 31912,-496 31944.04,-524.17 34941.58,-513.38 34984,-518 34997.36,-519.46 35011.15,-521.44 35024.94,-523.75"/>
<polygon fill="black" stroke="black" points="35024.51,-527.23 35034.96,-525.49 35025.71,-520.33 35024.51,-527.23"/>
</g>
<!-- layer_3_expert_agg -->
<g id="node185" class="node">
<title>layer_3_expert_agg</title>
<polygon fill="yellow" stroke="black" points="35823.2,-152 35045,-152 34844.8,-16 35623,-16 35823.2,-152"/>
<text text-anchor="middle" x="35334" y="-102.8" font-family="Arial" font-size="14.00">Expert Aggregation (Top&#45;2)</text>
<text text-anchor="middle" x="35334" y="-87.8" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=2048, expert_hidden=16384] from 16 experts</text>
<text text-anchor="middle" x="35334" y="-72.8" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="35334" y="-57.8" font-family="Arial" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_3_expert_0_gpu_8&#45;&gt;layer_3_expert_agg -->
<g id="edge292" class="edge">
<title>layer_3_expert_0_gpu_8&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M32705.61,-189.17C32708.76,-188.76 32711.89,-188.37 32715,-188 33135.06,-137.95 34326.5,-106.27 34947.22,-92.68"/>
<polygon fill="black" stroke="black" points="34947.31,-96.18 34957.23,-92.46 34947.16,-89.18 34947.31,-96.18"/>
</g>
<!-- layer_3_expert_1_gpu_8&#45;&gt;layer_3_expert_agg -->
<g id="edge293" class="edge">
<title>layer_3_expert_1_gpu_8&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M32302.61,-189.15C32305.76,-188.75 32308.89,-188.36 32312,-188 32809.72,-130.02 34245.69,-101.23 34943.75,-90.35"/>
<polygon fill="black" stroke="black" points="34944.03,-93.84 34953.98,-90.19 34943.92,-86.84 34944.03,-93.84"/>
</g>
<!-- layer_3_expert_2_gpu_9&#45;&gt;layer_3_expert_agg -->
<g id="edge294" class="edge">
<title>layer_3_expert_2_gpu_9&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M33511.62,-189.25C33514.77,-188.81 33517.9,-188.4 33521,-188 34009.46,-125.48 34576.82,-100.9 34944.94,-91.25"/>
<polygon fill="black" stroke="black" points="34945.05,-94.75 34954.95,-90.99 34944.87,-87.75 34945.05,-94.75"/>
</g>
<!-- layer_3_expert_3_gpu_9&#45;&gt;layer_3_expert_agg -->
<g id="edge295" class="edge">
<title>layer_3_expert_3_gpu_9&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M33108.62,-189.21C33111.76,-188.78 33114.89,-188.38 33118,-188 33750.84,-110.31 34491.91,-90.02 34936.58,-85.39"/>
<polygon fill="black" stroke="black" points="34936.74,-88.89 34946.7,-85.29 34936.67,-81.89 34936.74,-88.89"/>
</g>
<!-- layer_3_expert_4_gpu_10&#45;&gt;layer_3_expert_agg -->
<g id="edge296" class="edge">
<title>layer_3_expert_4_gpu_10&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M34317.65,-189.45C34320.79,-188.95 34323.91,-188.47 34327,-188 34541.57,-155.59 34783.42,-130.49 34976.32,-113.18"/>
<polygon fill="black" stroke="black" points="34976.69,-116.66 34986.34,-112.28 34976.07,-109.68 34976.69,-116.66"/>
</g>
<!-- layer_3_expert_5_gpu_10&#45;&gt;layer_3_expert_agg -->
<g id="edge297" class="edge">
<title>layer_3_expert_5_gpu_10&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M33914.63,-189.32C33917.77,-188.86 33920.9,-188.42 33924,-188 34272.35,-140.54 34672.31,-113.95 34957.06,-99.72"/>
<polygon fill="black" stroke="black" points="34957.33,-103.22 34967.15,-99.22 34956.98,-96.22 34957.33,-103.22"/>
</g>
<!-- layer_3_expert_6_gpu_11&#45;&gt;layer_3_expert_agg -->
<g id="edge298" class="edge">
<title>layer_3_expert_6_gpu_11&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M35044.87,-187.95C35073.34,-177.81 35104.72,-166.64 35135.98,-155.51"/>
<polygon fill="black" stroke="black" points="35137.43,-158.71 35145.68,-152.06 35135.09,-152.11 35137.43,-158.71"/>
</g>
<!-- layer_3_expert_7_gpu_11&#45;&gt;layer_3_expert_agg -->
<g id="edge299" class="edge">
<title>layer_3_expert_7_gpu_11&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M34720.7,-189.74C34723.82,-189.15 34726.92,-188.57 34730,-188 34821.33,-171.06 34920.62,-153.69 35011.83,-138.16"/>
<polygon fill="black" stroke="black" points="35012.49,-141.6 35021.76,-136.47 35011.32,-134.7 35012.49,-141.6"/>
</g>
<!-- layer_3_expert_8_gpu_12&#45;&gt;layer_3_expert_agg -->
<g id="edge300" class="edge">
<title>layer_3_expert_8_gpu_12&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M35623.13,-187.95C35594.66,-177.81 35563.28,-166.64 35532.02,-155.51"/>
<polygon fill="black" stroke="black" points="35532.91,-152.11 35522.32,-152.06 35530.57,-158.71 35532.91,-152.11"/>
</g>
<!-- layer_3_expert_9_gpu_12&#45;&gt;layer_3_expert_agg -->
<g id="edge301" class="edge">
<title>layer_3_expert_9_gpu_12&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M35334,-187.76C35334,-179.78 35334,-171.17 35334,-162.44"/>
<polygon fill="black" stroke="black" points="35337.5,-162.17 35334,-152.17 35330.5,-162.17 35337.5,-162.17"/>
</g>
<!-- layer_3_expert_10_gpu_13&#45;&gt;layer_3_expert_agg -->
<g id="edge302" class="edge">
<title>layer_3_expert_10_gpu_13&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M36350.24,-189.27C36347.47,-188.84 36344.73,-188.41 36342,-188 36161.47,-160.65 35961.62,-138.55 35787.8,-121.93"/>
<polygon fill="black" stroke="black" points="35787.99,-118.44 35777.71,-120.97 35787.33,-125.41 35787.99,-118.44"/>
</g>
<!-- layer_3_expert_11_gpu_13&#45;&gt;layer_3_expert_agg -->
<g id="edge303" class="edge">
<title>layer_3_expert_11_gpu_13&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M35947.46,-189.58C35944.62,-189.05 35941.8,-188.52 35939,-188 35877.22,-176.52 35811.81,-164.86 35747.7,-153.72"/>
<polygon fill="black" stroke="black" points="35748.29,-150.27 35737.84,-152.01 35747.09,-157.17 35748.29,-150.27"/>
</g>
<!-- layer_3_expert_12_gpu_14&#45;&gt;layer_3_expert_agg -->
<g id="edge304" class="edge">
<title>layer_3_expert_12_gpu_14&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M37156.26,-189.1C37153.49,-188.72 37150.74,-188.35 37148,-188 36668.41,-126.38 36112.76,-101.63 35744.09,-91.68"/>
<polygon fill="black" stroke="black" points="35744.15,-88.18 35734.06,-91.41 35743.96,-95.18 35744.15,-88.18"/>
</g>
<!-- layer_3_expert_13_gpu_14&#45;&gt;layer_3_expert_agg -->
<g id="edge305" class="edge">
<title>layer_3_expert_13_gpu_14&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M36753.25,-189.16C36750.49,-188.76 36747.73,-188.37 36745,-188 36415.67,-142.98 36040.23,-116.78 35759.46,-102.08"/>
<polygon fill="black" stroke="black" points="35759.26,-98.56 35749.09,-101.54 35758.9,-105.55 35759.26,-98.56"/>
</g>
<!-- layer_3_expert_14_gpu_15&#45;&gt;layer_3_expert_agg -->
<g id="edge306" class="edge">
<title>layer_3_expert_14_gpu_15&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M37962.27,-189.03C37959.5,-188.67 37956.74,-188.33 37954,-188 37539.49,-138.41 36374.03,-107.01 35746.46,-93.19"/>
<polygon fill="black" stroke="black" points="35746.42,-89.68 35736.34,-92.96 35746.27,-96.68 35746.42,-89.68"/>
</g>
<!-- layer_3_expert_15_gpu_15&#45;&gt;layer_3_expert_agg -->
<g id="edge307" class="edge">
<title>layer_3_expert_15_gpu_15&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M37559.27,-189.06C37556.49,-188.69 37553.74,-188.34 37551,-188 36919.57,-110.18 36180.38,-89.9 35735.12,-85.3"/>
<polygon fill="black" stroke="black" points="35735.02,-81.8 35724.98,-85.2 35734.95,-88.8 35735.02,-81.8"/>
</g>
<!-- layer_3_expert_agg&#45;&gt;layer_3_output -->
<g id="edge308" class="edge">
<title>layer_3_expert_agg&#45;&gt;layer_3_output</title>
<path fill="none" stroke="black" d="M35727.08,-86.57C36521.84,-91.37 38253.48,-110.68 38357,-188 38435.82,-246.88 38427,-299.62 38427,-398 38427,-560.5 38427,-560.5 38427,-560.5 38427,-668.17 38485.84,-727.62 38408,-802 38366.96,-841.21 37614.13,-846.53 37252.21,-846.81"/>
<polygon fill="black" stroke="black" points="37252.15,-843.31 37242.15,-846.82 37252.15,-850.31 37252.15,-843.31"/>
</g>
</g>
</svg>
