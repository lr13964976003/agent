digraph MoE_Baseline_TP8_PP2 {
	node [shape=rectangle]
	bgcolor=white rankdir=TB
	input [label="Input
[batch=1024, seq=10000, hidden=8192]
GPU: all" fillcolor=lightgreen shape=ellipse style=filled]
	layer_1_input [label="Layer 1 Input
[batch=1024, seq=10000, hidden=8192]
GPU: 0-7" fillcolor=lightyellow shape=parallelogram style=filled]
	layer_1_mha_norm [label="MHA LayerNorm 1
[batch=1024, seq=10000, hidden=8192]
GPU: 0-7" fillcolor=lightcoral style=filled]
	layer_1_q_0 [label="Q Proj 1.0
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightblue style=filled]
	layer_1_k_0 [label="K Proj 1.0
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightblue style=filled]
	layer_1_v_0 [label="V Proj 1.0
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightblue style=filled]
	layer_1_attn_0 [label="Attention 1.0
[batch=1024, seq=10000, head=2, dim=512]
GPU: 0" fillcolor=lightgreen style=filled]
	layer_1_o_0 [label="O Proj 1.0
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightblue style=filled]
	layer_1_mha_norm -> layer_1_q_0
	layer_1_mha_norm -> layer_1_k_0
	layer_1_mha_norm -> layer_1_v_0
	layer_1_q_0 -> layer_1_attn_0
	layer_1_k_0 -> layer_1_attn_0
	layer_1_v_0 -> layer_1_attn_0
	layer_1_attn_0 -> layer_1_o_0
	layer_1_q_1 [label="Q Proj 1.1
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightblue style=filled]
	layer_1_k_1 [label="K Proj 1.1
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightblue style=filled]
	layer_1_v_1 [label="V Proj 1.1
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightblue style=filled]
	layer_1_attn_1 [label="Attention 1.1
[batch=1024, seq=10000, head=2, dim=512]
GPU: 1" fillcolor=lightgreen style=filled]
	layer_1_o_1 [label="O Proj 1.1
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightblue style=filled]
	layer_1_mha_norm -> layer_1_q_1
	layer_1_mha_norm -> layer_1_k_1
	layer_1_mha_norm -> layer_1_v_1
	layer_1_q_1 -> layer_1_attn_1
	layer_1_k_1 -> layer_1_attn_1
	layer_1_v_1 -> layer_1_attn_1
	layer_1_attn_1 -> layer_1_o_1
	layer_1_q_2 [label="Q Proj 1.2
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightblue style=filled]
	layer_1_k_2 [label="K Proj 1.2
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightblue style=filled]
	layer_1_v_2 [label="V Proj 1.2
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightblue style=filled]
	layer_1_attn_2 [label="Attention 1.2
[batch=1024, seq=10000, head=2, dim=512]
GPU: 2" fillcolor=lightgreen style=filled]
	layer_1_o_2 [label="O Proj 1.2
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightblue style=filled]
	layer_1_mha_norm -> layer_1_q_2
	layer_1_mha_norm -> layer_1_k_2
	layer_1_mha_norm -> layer_1_v_2
	layer_1_q_2 -> layer_1_attn_2
	layer_1_k_2 -> layer_1_attn_2
	layer_1_v_2 -> layer_1_attn_2
	layer_1_attn_2 -> layer_1_o_2
	layer_1_q_3 [label="Q Proj 1.3
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightblue style=filled]
	layer_1_k_3 [label="K Proj 1.3
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightblue style=filled]
	layer_1_v_3 [label="V Proj 1.3
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightblue style=filled]
	layer_1_attn_3 [label="Attention 1.3
[batch=1024, seq=10000, head=2, dim=512]
GPU: 3" fillcolor=lightgreen style=filled]
	layer_1_o_3 [label="O Proj 1.3
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightblue style=filled]
	layer_1_mha_norm -> layer_1_q_3
	layer_1_mha_norm -> layer_1_k_3
	layer_1_mha_norm -> layer_1_v_3
	layer_1_q_3 -> layer_1_attn_3
	layer_1_k_3 -> layer_1_attn_3
	layer_1_v_3 -> layer_1_attn_3
	layer_1_attn_3 -> layer_1_o_3
	layer_1_q_4 [label="Q Proj 1.4
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightblue style=filled]
	layer_1_k_4 [label="K Proj 1.4
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightblue style=filled]
	layer_1_v_4 [label="V Proj 1.4
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightblue style=filled]
	layer_1_attn_4 [label="Attention 1.4
[batch=1024, seq=10000, head=2, dim=512]
GPU: 4" fillcolor=lightgreen style=filled]
	layer_1_o_4 [label="O Proj 1.4
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightblue style=filled]
	layer_1_mha_norm -> layer_1_q_4
	layer_1_mha_norm -> layer_1_k_4
	layer_1_mha_norm -> layer_1_v_4
	layer_1_q_4 -> layer_1_attn_4
	layer_1_k_4 -> layer_1_attn_4
	layer_1_v_4 -> layer_1_attn_4
	layer_1_attn_4 -> layer_1_o_4
	layer_1_q_5 [label="Q Proj 1.5
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightblue style=filled]
	layer_1_k_5 [label="K Proj 1.5
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightblue style=filled]
	layer_1_v_5 [label="V Proj 1.5
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightblue style=filled]
	layer_1_attn_5 [label="Attention 1.5
[batch=1024, seq=10000, head=2, dim=512]
GPU: 5" fillcolor=lightgreen style=filled]
	layer_1_o_5 [label="O Proj 1.5
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightblue style=filled]
	layer_1_mha_norm -> layer_1_q_5
	layer_1_mha_norm -> layer_1_k_5
	layer_1_mha_norm -> layer_1_v_5
	layer_1_q_5 -> layer_1_attn_5
	layer_1_k_5 -> layer_1_attn_5
	layer_1_v_5 -> layer_1_attn_5
	layer_1_attn_5 -> layer_1_o_5
	layer_1_q_6 [label="Q Proj 1.6
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightblue style=filled]
	layer_1_k_6 [label="K Proj 1.6
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightblue style=filled]
	layer_1_v_6 [label="V Proj 1.6
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightblue style=filled]
	layer_1_attn_6 [label="Attention 1.6
[batch=1024, seq=10000, head=2, dim=512]
GPU: 6" fillcolor=lightgreen style=filled]
	layer_1_o_6 [label="O Proj 1.6
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightblue style=filled]
	layer_1_mha_norm -> layer_1_q_6
	layer_1_mha_norm -> layer_1_k_6
	layer_1_mha_norm -> layer_1_v_6
	layer_1_q_6 -> layer_1_attn_6
	layer_1_k_6 -> layer_1_attn_6
	layer_1_v_6 -> layer_1_attn_6
	layer_1_attn_6 -> layer_1_o_6
	layer_1_q_7 [label="Q Proj 1.7
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightblue style=filled]
	layer_1_k_7 [label="K Proj 1.7
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightblue style=filled]
	layer_1_v_7 [label="V Proj 1.7
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightblue style=filled]
	layer_1_attn_7 [label="Attention 1.7
[batch=1024, seq=10000, head=2, dim=512]
GPU: 7" fillcolor=lightgreen style=filled]
	layer_1_o_7 [label="O Proj 1.7
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightblue style=filled]
	layer_1_mha_norm -> layer_1_q_7
	layer_1_mha_norm -> layer_1_k_7
	layer_1_mha_norm -> layer_1_v_7
	layer_1_q_7 -> layer_1_attn_7
	layer_1_k_7 -> layer_1_attn_7
	layer_1_v_7 -> layer_1_attn_7
	layer_1_attn_7 -> layer_1_o_7
	layer_1_attn_reduce [label="All-Reduce 1
[batch=1024, seq=10000, hidden=8192]
GPU: 0-7" fillcolor=orange shape=parallelogram style=filled]
	layer_1_attn_res [label="Residual Add 1
[batch=1024, seq=10000, hidden=8192]
GPU: 0-7" fillcolor=lightyellow style=filled]
	layer_1_exp_norm [label="Expert Norm 1
[batch=1024, seq=10000, hidden=8192]
GPU: 0-7" fillcolor=lightcoral style=filled]
	layer_1_gate_0 [label="Gate 0
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_0 [label="Expert 0
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_0
	layer_1_gate_0 -> layer_1_expert_0 [style=dashed]
	layer_1_gate_1 [label="Gate 1
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_1 [label="Expert 1
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_1
	layer_1_gate_1 -> layer_1_expert_1 [style=dashed]
	layer_1_gate_2 [label="Gate 2
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_2 [label="Expert 2
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_2
	layer_1_gate_2 -> layer_1_expert_2 [style=dashed]
	layer_1_gate_3 [label="Gate 3
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_3 [label="Expert 3
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_3
	layer_1_gate_3 -> layer_1_expert_3 [style=dashed]
	layer_1_gate_4 [label="Gate 4
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_4 [label="Expert 4
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_4
	layer_1_gate_4 -> layer_1_expert_4 [style=dashed]
	layer_1_gate_5 [label="Gate 5
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_5 [label="Expert 5
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_5
	layer_1_gate_5 -> layer_1_expert_5 [style=dashed]
	layer_1_gate_6 [label="Gate 6
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_6 [label="Expert 6
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_6
	layer_1_gate_6 -> layer_1_expert_6 [style=dashed]
	layer_1_gate_7 [label="Gate 7
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_7 [label="Expert 7
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_7
	layer_1_gate_7 -> layer_1_expert_7 [style=dashed]
	layer_1_gate_8 [label="Gate 8
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_8 [label="Expert 8
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_8
	layer_1_gate_8 -> layer_1_expert_8 [style=dashed]
	layer_1_gate_9 [label="Gate 9
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_9 [label="Expert 9
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_9
	layer_1_gate_9 -> layer_1_expert_9 [style=dashed]
	layer_1_gate_10 [label="Gate 10
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_10 [label="Expert 10
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_10
	layer_1_gate_10 -> layer_1_expert_10 [style=dashed]
	layer_1_gate_11 [label="Gate 11
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_11 [label="Expert 11
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_11
	layer_1_gate_11 -> layer_1_expert_11 [style=dashed]
	layer_1_gate_12 [label="Gate 12
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_12 [label="Expert 12
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_12
	layer_1_gate_12 -> layer_1_expert_12 [style=dashed]
	layer_1_gate_13 [label="Gate 13
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_13 [label="Expert 13
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_13
	layer_1_gate_13 -> layer_1_expert_13 [style=dashed]
	layer_1_gate_14 [label="Gate 14
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_14 [label="Expert 14
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_14
	layer_1_gate_14 -> layer_1_expert_14 [style=dashed]
	layer_1_gate_15 [label="Gate 15
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_15 [label="Expert 15
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_15
	layer_1_gate_15 -> layer_1_expert_15 [style=dashed]
	layer_1_gate_16 [label="Gate 16
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_16 [label="Expert 16
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_16
	layer_1_gate_16 -> layer_1_expert_16 [style=dashed]
	layer_1_gate_17 [label="Gate 17
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_17 [label="Expert 17
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_17
	layer_1_gate_17 -> layer_1_expert_17 [style=dashed]
	layer_1_gate_18 [label="Gate 18
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_18 [label="Expert 18
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_18
	layer_1_gate_18 -> layer_1_expert_18 [style=dashed]
	layer_1_gate_19 [label="Gate 19
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_19 [label="Expert 19
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_19
	layer_1_gate_19 -> layer_1_expert_19 [style=dashed]
	layer_1_gate_20 [label="Gate 20
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_20 [label="Expert 20
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_20
	layer_1_gate_20 -> layer_1_expert_20 [style=dashed]
	layer_1_gate_21 [label="Gate 21
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_21 [label="Expert 21
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_21
	layer_1_gate_21 -> layer_1_expert_21 [style=dashed]
	layer_1_gate_22 [label="Gate 22
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_22 [label="Expert 22
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_22
	layer_1_gate_22 -> layer_1_expert_22 [style=dashed]
	layer_1_gate_23 [label="Gate 23
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_23 [label="Expert 23
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_23
	layer_1_gate_23 -> layer_1_expert_23 [style=dashed]
	layer_1_gate_24 [label="Gate 24
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_24 [label="Expert 24
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_24
	layer_1_gate_24 -> layer_1_expert_24 [style=dashed]
	layer_1_gate_25 [label="Gate 25
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_25 [label="Expert 25
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_25
	layer_1_gate_25 -> layer_1_expert_25 [style=dashed]
	layer_1_gate_26 [label="Gate 26
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_26 [label="Expert 26
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_26
	layer_1_gate_26 -> layer_1_expert_26 [style=dashed]
	layer_1_gate_27 [label="Gate 27
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_27 [label="Expert 27
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_27
	layer_1_gate_27 -> layer_1_expert_27 [style=dashed]
	layer_1_gate_28 [label="Gate 28
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_28 [label="Expert 28
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_28
	layer_1_gate_28 -> layer_1_expert_28 [style=dashed]
	layer_1_gate_29 [label="Gate 29
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_29 [label="Expert 29
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_29
	layer_1_gate_29 -> layer_1_expert_29 [style=dashed]
	layer_1_gate_30 [label="Gate 30
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_30 [label="Expert 30
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_30
	layer_1_gate_30 -> layer_1_expert_30 [style=dashed]
	layer_1_gate_31 [label="Gate 31
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_31 [label="Expert 31
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_31
	layer_1_gate_31 -> layer_1_expert_31 [style=dashed]
	layer_1_gate_32 [label="Gate 32
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_32 [label="Expert 32
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_32
	layer_1_gate_32 -> layer_1_expert_32 [style=dashed]
	layer_1_gate_33 [label="Gate 33
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_33 [label="Expert 33
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_33
	layer_1_gate_33 -> layer_1_expert_33 [style=dashed]
	layer_1_gate_34 [label="Gate 34
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_34 [label="Expert 34
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_34
	layer_1_gate_34 -> layer_1_expert_34 [style=dashed]
	layer_1_gate_35 [label="Gate 35
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_35 [label="Expert 35
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_35
	layer_1_gate_35 -> layer_1_expert_35 [style=dashed]
	layer_1_gate_36 [label="Gate 36
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_36 [label="Expert 36
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_36
	layer_1_gate_36 -> layer_1_expert_36 [style=dashed]
	layer_1_gate_37 [label="Gate 37
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_37 [label="Expert 37
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_37
	layer_1_gate_37 -> layer_1_expert_37 [style=dashed]
	layer_1_gate_38 [label="Gate 38
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_38 [label="Expert 38
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_38
	layer_1_gate_38 -> layer_1_expert_38 [style=dashed]
	layer_1_gate_39 [label="Gate 39
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_39 [label="Expert 39
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_39
	layer_1_gate_39 -> layer_1_expert_39 [style=dashed]
	layer_1_gate_40 [label="Gate 40
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_40 [label="Expert 40
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_40
	layer_1_gate_40 -> layer_1_expert_40 [style=dashed]
	layer_1_gate_41 [label="Gate 41
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_41 [label="Expert 41
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_41
	layer_1_gate_41 -> layer_1_expert_41 [style=dashed]
	layer_1_gate_42 [label="Gate 42
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_42 [label="Expert 42
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_42
	layer_1_gate_42 -> layer_1_expert_42 [style=dashed]
	layer_1_gate_43 [label="Gate 43
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_43 [label="Expert 43
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_43
	layer_1_gate_43 -> layer_1_expert_43 [style=dashed]
	layer_1_gate_44 [label="Gate 44
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_44 [label="Expert 44
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_44
	layer_1_gate_44 -> layer_1_expert_44 [style=dashed]
	layer_1_gate_45 [label="Gate 45
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_45 [label="Expert 45
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_45
	layer_1_gate_45 -> layer_1_expert_45 [style=dashed]
	layer_1_gate_46 [label="Gate 46
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_46 [label="Expert 46
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_46
	layer_1_gate_46 -> layer_1_expert_46 [style=dashed]
	layer_1_gate_47 [label="Gate 47
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_47 [label="Expert 47
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_47
	layer_1_gate_47 -> layer_1_expert_47 [style=dashed]
	layer_1_gate_48 [label="Gate 48
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_48 [label="Expert 48
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_48
	layer_1_gate_48 -> layer_1_expert_48 [style=dashed]
	layer_1_gate_49 [label="Gate 49
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_49 [label="Expert 49
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_49
	layer_1_gate_49 -> layer_1_expert_49 [style=dashed]
	layer_1_gate_50 [label="Gate 50
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_50 [label="Expert 50
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_50
	layer_1_gate_50 -> layer_1_expert_50 [style=dashed]
	layer_1_gate_51 [label="Gate 51
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_51 [label="Expert 51
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_51
	layer_1_gate_51 -> layer_1_expert_51 [style=dashed]
	layer_1_gate_52 [label="Gate 52
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_52 [label="Expert 52
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_52
	layer_1_gate_52 -> layer_1_expert_52 [style=dashed]
	layer_1_gate_53 [label="Gate 53
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_53 [label="Expert 53
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_53
	layer_1_gate_53 -> layer_1_expert_53 [style=dashed]
	layer_1_gate_54 [label="Gate 54
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_54 [label="Expert 54
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_54
	layer_1_gate_54 -> layer_1_expert_54 [style=dashed]
	layer_1_gate_55 [label="Gate 55
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_55 [label="Expert 55
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_55
	layer_1_gate_55 -> layer_1_expert_55 [style=dashed]
	layer_1_gate_56 [label="Gate 56
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_56 [label="Expert 56
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_56
	layer_1_gate_56 -> layer_1_expert_56 [style=dashed]
	layer_1_gate_57 [label="Gate 57
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_57 [label="Expert 57
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_57
	layer_1_gate_57 -> layer_1_expert_57 [style=dashed]
	layer_1_gate_58 [label="Gate 58
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_58 [label="Expert 58
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_58
	layer_1_gate_58 -> layer_1_expert_58 [style=dashed]
	layer_1_gate_59 [label="Gate 59
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_59 [label="Expert 59
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_59
	layer_1_gate_59 -> layer_1_expert_59 [style=dashed]
	layer_1_gate_60 [label="Gate 60
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_60 [label="Expert 60
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_60
	layer_1_gate_60 -> layer_1_expert_60 [style=dashed]
	layer_1_gate_61 [label="Gate 61
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_61 [label="Expert 61
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_61
	layer_1_gate_61 -> layer_1_expert_61 [style=dashed]
	layer_1_gate_62 [label="Gate 62
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_62 [label="Expert 62
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_62
	layer_1_gate_62 -> layer_1_expert_62 [style=dashed]
	layer_1_gate_63 [label="Gate 63
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=yellow shape=diamond style=filled]
	layer_1_expert_63 [label="Expert 63
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightpink style=filled]
	layer_1_exp_norm -> layer_1_gate_63
	layer_1_gate_63 -> layer_1_expert_63 [style=dashed]
	layer_1_exp_agg [label="Expert Agg 1
[batch=1024, seq=10000, hidden=8192]
GPU: 0-7" fillcolor=orange shape=parallelogram style=filled]
	layer_1_exp_res [label="Expert Residual 1
[batch=1024, seq=10000, hidden=8192]
GPU: 0-7" fillcolor=lightyellow style=filled]
	input -> layer_1_input
	layer_1_o_0 -> layer_1_attn_reduce
	layer_1_o_1 -> layer_1_attn_reduce
	layer_1_o_2 -> layer_1_attn_reduce
	layer_1_o_3 -> layer_1_attn_reduce
	layer_1_o_4 -> layer_1_attn_reduce
	layer_1_o_5 -> layer_1_attn_reduce
	layer_1_o_6 -> layer_1_attn_reduce
	layer_1_o_7 -> layer_1_attn_reduce
	layer_1_attn_reduce -> layer_1_attn_res
	layer_1_input -> layer_1_attn_res
	layer_1_expert_0 -> layer_1_exp_agg
	layer_1_expert_1 -> layer_1_exp_agg
	layer_1_expert_2 -> layer_1_exp_agg
	layer_1_expert_3 -> layer_1_exp_agg
	layer_1_expert_4 -> layer_1_exp_agg
	layer_1_expert_5 -> layer_1_exp_agg
	layer_1_expert_6 -> layer_1_exp_agg
	layer_1_expert_7 -> layer_1_exp_agg
	layer_1_expert_8 -> layer_1_exp_agg
	layer_1_expert_9 -> layer_1_exp_agg
	layer_1_expert_10 -> layer_1_exp_agg
	layer_1_expert_11 -> layer_1_exp_agg
	layer_1_expert_12 -> layer_1_exp_agg
	layer_1_expert_13 -> layer_1_exp_agg
	layer_1_expert_14 -> layer_1_exp_agg
	layer_1_expert_15 -> layer_1_exp_agg
	layer_1_expert_16 -> layer_1_exp_agg
	layer_1_expert_17 -> layer_1_exp_agg
	layer_1_expert_18 -> layer_1_exp_agg
	layer_1_expert_19 -> layer_1_exp_agg
	layer_1_expert_20 -> layer_1_exp_agg
	layer_1_expert_21 -> layer_1_exp_agg
	layer_1_expert_22 -> layer_1_exp_agg
	layer_1_expert_23 -> layer_1_exp_agg
	layer_1_expert_24 -> layer_1_exp_agg
	layer_1_expert_25 -> layer_1_exp_agg
	layer_1_expert_26 -> layer_1_exp_agg
	layer_1_expert_27 -> layer_1_exp_agg
	layer_1_expert_28 -> layer_1_exp_agg
	layer_1_expert_29 -> layer_1_exp_agg
	layer_1_expert_30 -> layer_1_exp_agg
	layer_1_expert_31 -> layer_1_exp_agg
	layer_1_expert_32 -> layer_1_exp_agg
	layer_1_expert_33 -> layer_1_exp_agg
	layer_1_expert_34 -> layer_1_exp_agg
	layer_1_expert_35 -> layer_1_exp_agg
	layer_1_expert_36 -> layer_1_exp_agg
	layer_1_expert_37 -> layer_1_exp_agg
	layer_1_expert_38 -> layer_1_exp_agg
	layer_1_expert_39 -> layer_1_exp_agg
	layer_1_expert_40 -> layer_1_exp_agg
	layer_1_expert_41 -> layer_1_exp_agg
	layer_1_expert_42 -> layer_1_exp_agg
	layer_1_expert_43 -> layer_1_exp_agg
	layer_1_expert_44 -> layer_1_exp_agg
	layer_1_expert_45 -> layer_1_exp_agg
	layer_1_expert_46 -> layer_1_exp_agg
	layer_1_expert_47 -> layer_1_exp_agg
	layer_1_expert_48 -> layer_1_exp_agg
	layer_1_expert_49 -> layer_1_exp_agg
	layer_1_expert_50 -> layer_1_exp_agg
	layer_1_expert_51 -> layer_1_exp_agg
	layer_1_expert_52 -> layer_1_exp_agg
	layer_1_expert_53 -> layer_1_exp_agg
	layer_1_expert_54 -> layer_1_exp_agg
	layer_1_expert_55 -> layer_1_exp_agg
	layer_1_expert_56 -> layer_1_exp_agg
	layer_1_expert_57 -> layer_1_exp_agg
	layer_1_expert_58 -> layer_1_exp_agg
	layer_1_expert_59 -> layer_1_exp_agg
	layer_1_expert_60 -> layer_1_exp_agg
	layer_1_expert_61 -> layer_1_exp_agg
	layer_1_expert_62 -> layer_1_exp_agg
	layer_1_expert_63 -> layer_1_exp_agg
	layer_1_attn_res -> layer_1_exp_norm
	layer_1_exp_agg -> layer_1_exp_res
	layer_1_attn_res -> layer_1_exp_res
	layer_2_input [label="Layer 2 Input
[batch=1024, seq=10000, hidden=8192]
GPU: 0-7" fillcolor=lightyellow shape=parallelogram style=filled]
	layer_2_mha_norm [label="MHA LayerNorm 2
[batch=1024, seq=10000, hidden=8192]
GPU: 0-7" fillcolor=lightcoral style=filled]
	layer_2_q_0 [label="Q Proj 2.0
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightblue style=filled]
	layer_2_k_0 [label="K Proj 2.0
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightblue style=filled]
	layer_2_v_0 [label="V Proj 2.0
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightblue style=filled]
	layer_2_attn_0 [label="Attention 2.0
[batch=1024, seq=10000, head=2, dim=512]
GPU: 0" fillcolor=lightgreen style=filled]
	layer_2_o_0 [label="O Proj 2.0
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightblue style=filled]
	layer_2_mha_norm -> layer_2_q_0
	layer_2_mha_norm -> layer_2_k_0
	layer_2_mha_norm -> layer_2_v_0
	layer_2_q_0 -> layer_2_attn_0
	layer_2_k_0 -> layer_2_attn_0
	layer_2_v_0 -> layer_2_attn_0
	layer_2_attn_0 -> layer_2_o_0
	layer_2_q_1 [label="Q Proj 2.1
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightblue style=filled]
	layer_2_k_1 [label="K Proj 2.1
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightblue style=filled]
	layer_2_v_1 [label="V Proj 2.1
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightblue style=filled]
	layer_2_attn_1 [label="Attention 2.1
[batch=1024, seq=10000, head=2, dim=512]
GPU: 1" fillcolor=lightgreen style=filled]
	layer_2_o_1 [label="O Proj 2.1
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightblue style=filled]
	layer_2_mha_norm -> layer_2_q_1
	layer_2_mha_norm -> layer_2_k_1
	layer_2_mha_norm -> layer_2_v_1
	layer_2_q_1 -> layer_2_attn_1
	layer_2_k_1 -> layer_2_attn_1
	layer_2_v_1 -> layer_2_attn_1
	layer_2_attn_1 -> layer_2_o_1
	layer_2_q_2 [label="Q Proj 2.2
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightblue style=filled]
	layer_2_k_2 [label="K Proj 2.2
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightblue style=filled]
	layer_2_v_2 [label="V Proj 2.2
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightblue style=filled]
	layer_2_attn_2 [label="Attention 2.2
[batch=1024, seq=10000, head=2, dim=512]
GPU: 2" fillcolor=lightgreen style=filled]
	layer_2_o_2 [label="O Proj 2.2
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightblue style=filled]
	layer_2_mha_norm -> layer_2_q_2
	layer_2_mha_norm -> layer_2_k_2
	layer_2_mha_norm -> layer_2_v_2
	layer_2_q_2 -> layer_2_attn_2
	layer_2_k_2 -> layer_2_attn_2
	layer_2_v_2 -> layer_2_attn_2
	layer_2_attn_2 -> layer_2_o_2
	layer_2_q_3 [label="Q Proj 2.3
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightblue style=filled]
	layer_2_k_3 [label="K Proj 2.3
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightblue style=filled]
	layer_2_v_3 [label="V Proj 2.3
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightblue style=filled]
	layer_2_attn_3 [label="Attention 2.3
[batch=1024, seq=10000, head=2, dim=512]
GPU: 3" fillcolor=lightgreen style=filled]
	layer_2_o_3 [label="O Proj 2.3
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightblue style=filled]
	layer_2_mha_norm -> layer_2_q_3
	layer_2_mha_norm -> layer_2_k_3
	layer_2_mha_norm -> layer_2_v_3
	layer_2_q_3 -> layer_2_attn_3
	layer_2_k_3 -> layer_2_attn_3
	layer_2_v_3 -> layer_2_attn_3
	layer_2_attn_3 -> layer_2_o_3
	layer_2_q_4 [label="Q Proj 2.4
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightblue style=filled]
	layer_2_k_4 [label="K Proj 2.4
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightblue style=filled]
	layer_2_v_4 [label="V Proj 2.4
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightblue style=filled]
	layer_2_attn_4 [label="Attention 2.4
[batch=1024, seq=10000, head=2, dim=512]
GPU: 4" fillcolor=lightgreen style=filled]
	layer_2_o_4 [label="O Proj 2.4
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightblue style=filled]
	layer_2_mha_norm -> layer_2_q_4
	layer_2_mha_norm -> layer_2_k_4
	layer_2_mha_norm -> layer_2_v_4
	layer_2_q_4 -> layer_2_attn_4
	layer_2_k_4 -> layer_2_attn_4
	layer_2_v_4 -> layer_2_attn_4
	layer_2_attn_4 -> layer_2_o_4
	layer_2_q_5 [label="Q Proj 2.5
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightblue style=filled]
	layer_2_k_5 [label="K Proj 2.5
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightblue style=filled]
	layer_2_v_5 [label="V Proj 2.5
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightblue style=filled]
	layer_2_attn_5 [label="Attention 2.5
[batch=1024, seq=10000, head=2, dim=512]
GPU: 5" fillcolor=lightgreen style=filled]
	layer_2_o_5 [label="O Proj 2.5
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightblue style=filled]
	layer_2_mha_norm -> layer_2_q_5
	layer_2_mha_norm -> layer_2_k_5
	layer_2_mha_norm -> layer_2_v_5
	layer_2_q_5 -> layer_2_attn_5
	layer_2_k_5 -> layer_2_attn_5
	layer_2_v_5 -> layer_2_attn_5
	layer_2_attn_5 -> layer_2_o_5
	layer_2_q_6 [label="Q Proj 2.6
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightblue style=filled]
	layer_2_k_6 [label="K Proj 2.6
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightblue style=filled]
	layer_2_v_6 [label="V Proj 2.6
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightblue style=filled]
	layer_2_attn_6 [label="Attention 2.6
[batch=1024, seq=10000, head=2, dim=512]
GPU: 6" fillcolor=lightgreen style=filled]
	layer_2_o_6 [label="O Proj 2.6
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightblue style=filled]
	layer_2_mha_norm -> layer_2_q_6
	layer_2_mha_norm -> layer_2_k_6
	layer_2_mha_norm -> layer_2_v_6
	layer_2_q_6 -> layer_2_attn_6
	layer_2_k_6 -> layer_2_attn_6
	layer_2_v_6 -> layer_2_attn_6
	layer_2_attn_6 -> layer_2_o_6
	layer_2_q_7 [label="Q Proj 2.7
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightblue style=filled]
	layer_2_k_7 [label="K Proj 2.7
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightblue style=filled]
	layer_2_v_7 [label="V Proj 2.7
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightblue style=filled]
	layer_2_attn_7 [label="Attention 2.7
[batch=1024, seq=10000, head=2, dim=512]
GPU: 7" fillcolor=lightgreen style=filled]
	layer_2_o_7 [label="O Proj 2.7
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightblue style=filled]
	layer_2_mha_norm -> layer_2_q_7
	layer_2_mha_norm -> layer_2_k_7
	layer_2_mha_norm -> layer_2_v_7
	layer_2_q_7 -> layer_2_attn_7
	layer_2_k_7 -> layer_2_attn_7
	layer_2_v_7 -> layer_2_attn_7
	layer_2_attn_7 -> layer_2_o_7
	layer_2_attn_reduce [label="All-Reduce 2
[batch=1024, seq=10000, hidden=8192]
GPU: 0-7" fillcolor=orange shape=parallelogram style=filled]
	layer_2_attn_res [label="Residual Add 2
[batch=1024, seq=10000, hidden=8192]
GPU: 0-7" fillcolor=lightyellow style=filled]
	layer_2_exp_norm [label="Expert Norm 2
[batch=1024, seq=10000, hidden=8192]
GPU: 0-7" fillcolor=lightcoral style=filled]
	layer_2_gate_0 [label="Gate 0
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_0 [label="Expert 0
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_0
	layer_2_gate_0 -> layer_2_expert_0 [style=dashed]
	layer_2_gate_1 [label="Gate 1
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_1 [label="Expert 1
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_1
	layer_2_gate_1 -> layer_2_expert_1 [style=dashed]
	layer_2_gate_2 [label="Gate 2
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_2 [label="Expert 2
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_2
	layer_2_gate_2 -> layer_2_expert_2 [style=dashed]
	layer_2_gate_3 [label="Gate 3
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_3 [label="Expert 3
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_3
	layer_2_gate_3 -> layer_2_expert_3 [style=dashed]
	layer_2_gate_4 [label="Gate 4
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_4 [label="Expert 4
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_4
	layer_2_gate_4 -> layer_2_expert_4 [style=dashed]
	layer_2_gate_5 [label="Gate 5
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_5 [label="Expert 5
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_5
	layer_2_gate_5 -> layer_2_expert_5 [style=dashed]
	layer_2_gate_6 [label="Gate 6
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_6 [label="Expert 6
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_6
	layer_2_gate_6 -> layer_2_expert_6 [style=dashed]
	layer_2_gate_7 [label="Gate 7
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_7 [label="Expert 7
[batch=1024, seq=10000, hidden=1024]
GPU: 0" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_7
	layer_2_gate_7 -> layer_2_expert_7 [style=dashed]
	layer_2_gate_8 [label="Gate 8
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_8 [label="Expert 8
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_8
	layer_2_gate_8 -> layer_2_expert_8 [style=dashed]
	layer_2_gate_9 [label="Gate 9
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_9 [label="Expert 9
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_9
	layer_2_gate_9 -> layer_2_expert_9 [style=dashed]
	layer_2_gate_10 [label="Gate 10
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_10 [label="Expert 10
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_10
	layer_2_gate_10 -> layer_2_expert_10 [style=dashed]
	layer_2_gate_11 [label="Gate 11
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_11 [label="Expert 11
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_11
	layer_2_gate_11 -> layer_2_expert_11 [style=dashed]
	layer_2_gate_12 [label="Gate 12
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_12 [label="Expert 12
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_12
	layer_2_gate_12 -> layer_2_expert_12 [style=dashed]
	layer_2_gate_13 [label="Gate 13
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_13 [label="Expert 13
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_13
	layer_2_gate_13 -> layer_2_expert_13 [style=dashed]
	layer_2_gate_14 [label="Gate 14
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_14 [label="Expert 14
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_14
	layer_2_gate_14 -> layer_2_expert_14 [style=dashed]
	layer_2_gate_15 [label="Gate 15
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_15 [label="Expert 15
[batch=1024, seq=10000, hidden=1024]
GPU: 1" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_15
	layer_2_gate_15 -> layer_2_expert_15 [style=dashed]
	layer_2_gate_16 [label="Gate 16
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_16 [label="Expert 16
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_16
	layer_2_gate_16 -> layer_2_expert_16 [style=dashed]
	layer_2_gate_17 [label="Gate 17
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_17 [label="Expert 17
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_17
	layer_2_gate_17 -> layer_2_expert_17 [style=dashed]
	layer_2_gate_18 [label="Gate 18
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_18 [label="Expert 18
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_18
	layer_2_gate_18 -> layer_2_expert_18 [style=dashed]
	layer_2_gate_19 [label="Gate 19
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_19 [label="Expert 19
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_19
	layer_2_gate_19 -> layer_2_expert_19 [style=dashed]
	layer_2_gate_20 [label="Gate 20
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_20 [label="Expert 20
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_20
	layer_2_gate_20 -> layer_2_expert_20 [style=dashed]
	layer_2_gate_21 [label="Gate 21
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_21 [label="Expert 21
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_21
	layer_2_gate_21 -> layer_2_expert_21 [style=dashed]
	layer_2_gate_22 [label="Gate 22
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_22 [label="Expert 22
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_22
	layer_2_gate_22 -> layer_2_expert_22 [style=dashed]
	layer_2_gate_23 [label="Gate 23
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_23 [label="Expert 23
[batch=1024, seq=10000, hidden=1024]
GPU: 2" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_23
	layer_2_gate_23 -> layer_2_expert_23 [style=dashed]
	layer_2_gate_24 [label="Gate 24
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_24 [label="Expert 24
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_24
	layer_2_gate_24 -> layer_2_expert_24 [style=dashed]
	layer_2_gate_25 [label="Gate 25
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_25 [label="Expert 25
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_25
	layer_2_gate_25 -> layer_2_expert_25 [style=dashed]
	layer_2_gate_26 [label="Gate 26
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_26 [label="Expert 26
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_26
	layer_2_gate_26 -> layer_2_expert_26 [style=dashed]
	layer_2_gate_27 [label="Gate 27
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_27 [label="Expert 27
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_27
	layer_2_gate_27 -> layer_2_expert_27 [style=dashed]
	layer_2_gate_28 [label="Gate 28
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_28 [label="Expert 28
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_28
	layer_2_gate_28 -> layer_2_expert_28 [style=dashed]
	layer_2_gate_29 [label="Gate 29
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_29 [label="Expert 29
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_29
	layer_2_gate_29 -> layer_2_expert_29 [style=dashed]
	layer_2_gate_30 [label="Gate 30
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_30 [label="Expert 30
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_30
	layer_2_gate_30 -> layer_2_expert_30 [style=dashed]
	layer_2_gate_31 [label="Gate 31
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_31 [label="Expert 31
[batch=1024, seq=10000, hidden=1024]
GPU: 3" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_31
	layer_2_gate_31 -> layer_2_expert_31 [style=dashed]
	layer_2_gate_32 [label="Gate 32
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_32 [label="Expert 32
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_32
	layer_2_gate_32 -> layer_2_expert_32 [style=dashed]
	layer_2_gate_33 [label="Gate 33
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_33 [label="Expert 33
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_33
	layer_2_gate_33 -> layer_2_expert_33 [style=dashed]
	layer_2_gate_34 [label="Gate 34
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_34 [label="Expert 34
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_34
	layer_2_gate_34 -> layer_2_expert_34 [style=dashed]
	layer_2_gate_35 [label="Gate 35
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_35 [label="Expert 35
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_35
	layer_2_gate_35 -> layer_2_expert_35 [style=dashed]
	layer_2_gate_36 [label="Gate 36
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_36 [label="Expert 36
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_36
	layer_2_gate_36 -> layer_2_expert_36 [style=dashed]
	layer_2_gate_37 [label="Gate 37
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_37 [label="Expert 37
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_37
	layer_2_gate_37 -> layer_2_expert_37 [style=dashed]
	layer_2_gate_38 [label="Gate 38
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_38 [label="Expert 38
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_38
	layer_2_gate_38 -> layer_2_expert_38 [style=dashed]
	layer_2_gate_39 [label="Gate 39
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_39 [label="Expert 39
[batch=1024, seq=10000, hidden=1024]
GPU: 4" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_39
	layer_2_gate_39 -> layer_2_expert_39 [style=dashed]
	layer_2_gate_40 [label="Gate 40
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_40 [label="Expert 40
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_40
	layer_2_gate_40 -> layer_2_expert_40 [style=dashed]
	layer_2_gate_41 [label="Gate 41
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_41 [label="Expert 41
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_41
	layer_2_gate_41 -> layer_2_expert_41 [style=dashed]
	layer_2_gate_42 [label="Gate 42
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_42 [label="Expert 42
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_42
	layer_2_gate_42 -> layer_2_expert_42 [style=dashed]
	layer_2_gate_43 [label="Gate 43
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_43 [label="Expert 43
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_43
	layer_2_gate_43 -> layer_2_expert_43 [style=dashed]
	layer_2_gate_44 [label="Gate 44
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_44 [label="Expert 44
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_44
	layer_2_gate_44 -> layer_2_expert_44 [style=dashed]
	layer_2_gate_45 [label="Gate 45
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_45 [label="Expert 45
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_45
	layer_2_gate_45 -> layer_2_expert_45 [style=dashed]
	layer_2_gate_46 [label="Gate 46
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_46 [label="Expert 46
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_46
	layer_2_gate_46 -> layer_2_expert_46 [style=dashed]
	layer_2_gate_47 [label="Gate 47
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_47 [label="Expert 47
[batch=1024, seq=10000, hidden=1024]
GPU: 5" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_47
	layer_2_gate_47 -> layer_2_expert_47 [style=dashed]
	layer_2_gate_48 [label="Gate 48
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_48 [label="Expert 48
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_48
	layer_2_gate_48 -> layer_2_expert_48 [style=dashed]
	layer_2_gate_49 [label="Gate 49
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_49 [label="Expert 49
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_49
	layer_2_gate_49 -> layer_2_expert_49 [style=dashed]
	layer_2_gate_50 [label="Gate 50
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_50 [label="Expert 50
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_50
	layer_2_gate_50 -> layer_2_expert_50 [style=dashed]
	layer_2_gate_51 [label="Gate 51
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_51 [label="Expert 51
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_51
	layer_2_gate_51 -> layer_2_expert_51 [style=dashed]
	layer_2_gate_52 [label="Gate 52
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_52 [label="Expert 52
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_52
	layer_2_gate_52 -> layer_2_expert_52 [style=dashed]
	layer_2_gate_53 [label="Gate 53
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_53 [label="Expert 53
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_53
	layer_2_gate_53 -> layer_2_expert_53 [style=dashed]
	layer_2_gate_54 [label="Gate 54
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_54 [label="Expert 54
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_54
	layer_2_gate_54 -> layer_2_expert_54 [style=dashed]
	layer_2_gate_55 [label="Gate 55
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_55 [label="Expert 55
[batch=1024, seq=10000, hidden=1024]
GPU: 6" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_55
	layer_2_gate_55 -> layer_2_expert_55 [style=dashed]
	layer_2_gate_56 [label="Gate 56
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_56 [label="Expert 56
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_56
	layer_2_gate_56 -> layer_2_expert_56 [style=dashed]
	layer_2_gate_57 [label="Gate 57
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_57 [label="Expert 57
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_57
	layer_2_gate_57 -> layer_2_expert_57 [style=dashed]
	layer_2_gate_58 [label="Gate 58
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_58 [label="Expert 58
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_58
	layer_2_gate_58 -> layer_2_expert_58 [style=dashed]
	layer_2_gate_59 [label="Gate 59
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_59 [label="Expert 59
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_59
	layer_2_gate_59 -> layer_2_expert_59 [style=dashed]
	layer_2_gate_60 [label="Gate 60
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_60 [label="Expert 60
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_60
	layer_2_gate_60 -> layer_2_expert_60 [style=dashed]
	layer_2_gate_61 [label="Gate 61
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_61 [label="Expert 61
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_61
	layer_2_gate_61 -> layer_2_expert_61 [style=dashed]
	layer_2_gate_62 [label="Gate 62
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_62 [label="Expert 62
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_62
	layer_2_gate_62 -> layer_2_expert_62 [style=dashed]
	layer_2_gate_63 [label="Gate 63
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=yellow shape=diamond style=filled]
	layer_2_expert_63 [label="Expert 63
[batch=1024, seq=10000, hidden=1024]
GPU: 7" fillcolor=lightpink style=filled]
	layer_2_exp_norm -> layer_2_gate_63
	layer_2_gate_63 -> layer_2_expert_63 [style=dashed]
	layer_2_exp_agg [label="Expert Agg 2
[batch=1024, seq=10000, hidden=8192]
GPU: 0-7" fillcolor=orange shape=parallelogram style=filled]
	layer_2_exp_res [label="Expert Residual 2
[batch=1024, seq=10000, hidden=8192]
GPU: 0-7" fillcolor=lightyellow style=filled]
	layer_1_exp_res -> layer_2_input
	layer_2_o_0 -> layer_2_attn_reduce
	layer_2_o_1 -> layer_2_attn_reduce
	layer_2_o_2 -> layer_2_attn_reduce
	layer_2_o_3 -> layer_2_attn_reduce
	layer_2_o_4 -> layer_2_attn_reduce
	layer_2_o_5 -> layer_2_attn_reduce
	layer_2_o_6 -> layer_2_attn_reduce
	layer_2_o_7 -> layer_2_attn_reduce
	layer_2_attn_reduce -> layer_2_attn_res
	layer_2_input -> layer_2_attn_res
	layer_2_expert_0 -> layer_2_exp_agg
	layer_2_expert_1 -> layer_2_exp_agg
	layer_2_expert_2 -> layer_2_exp_agg
	layer_2_expert_3 -> layer_2_exp_agg
	layer_2_expert_4 -> layer_2_exp_agg
	layer_2_expert_5 -> layer_2_exp_agg
	layer_2_expert_6 -> layer_2_exp_agg
	layer_2_expert_7 -> layer_2_exp_agg
	layer_2_expert_8 -> layer_2_exp_agg
	layer_2_expert_9 -> layer_2_exp_agg
	layer_2_expert_10 -> layer_2_exp_agg
	layer_2_expert_11 -> layer_2_exp_agg
	layer_2_expert_12 -> layer_2_exp_agg
	layer_2_expert_13 -> layer_2_exp_agg
	layer_2_expert_14 -> layer_2_exp_agg
	layer_2_expert_15 -> layer_2_exp_agg
	layer_2_expert_16 -> layer_2_exp_agg
	layer_2_expert_17 -> layer_2_exp_agg
	layer_2_expert_18 -> layer_2_exp_agg
	layer_2_expert_19 -> layer_2_exp_agg
	layer_2_expert_20 -> layer_2_exp_agg
	layer_2_expert_21 -> layer_2_exp_agg
	layer_2_expert_22 -> layer_2_exp_agg
	layer_2_expert_23 -> layer_2_exp_agg
	layer_2_expert_24 -> layer_2_exp_agg
	layer_2_expert_25 -> layer_2_exp_agg
	layer_2_expert_26 -> layer_2_exp_agg
	layer_2_expert_27 -> layer_2_exp_agg
	layer_2_expert_28 -> layer_2_exp_agg
	layer_2_expert_29 -> layer_2_exp_agg
	layer_2_expert_30 -> layer_2_exp_agg
	layer_2_expert_31 -> layer_2_exp_agg
	layer_2_expert_32 -> layer_2_exp_agg
	layer_2_expert_33 -> layer_2_exp_agg
	layer_2_expert_34 -> layer_2_exp_agg
	layer_2_expert_35 -> layer_2_exp_agg
	layer_2_expert_36 -> layer_2_exp_agg
	layer_2_expert_37 -> layer_2_exp_agg
	layer_2_expert_38 -> layer_2_exp_agg
	layer_2_expert_39 -> layer_2_exp_agg
	layer_2_expert_40 -> layer_2_exp_agg
	layer_2_expert_41 -> layer_2_exp_agg
	layer_2_expert_42 -> layer_2_exp_agg
	layer_2_expert_43 -> layer_2_exp_agg
	layer_2_expert_44 -> layer_2_exp_agg
	layer_2_expert_45 -> layer_2_exp_agg
	layer_2_expert_46 -> layer_2_exp_agg
	layer_2_expert_47 -> layer_2_exp_agg
	layer_2_expert_48 -> layer_2_exp_agg
	layer_2_expert_49 -> layer_2_exp_agg
	layer_2_expert_50 -> layer_2_exp_agg
	layer_2_expert_51 -> layer_2_exp_agg
	layer_2_expert_52 -> layer_2_exp_agg
	layer_2_expert_53 -> layer_2_exp_agg
	layer_2_expert_54 -> layer_2_exp_agg
	layer_2_expert_55 -> layer_2_exp_agg
	layer_2_expert_56 -> layer_2_exp_agg
	layer_2_expert_57 -> layer_2_exp_agg
	layer_2_expert_58 -> layer_2_exp_agg
	layer_2_expert_59 -> layer_2_exp_agg
	layer_2_expert_60 -> layer_2_exp_agg
	layer_2_expert_61 -> layer_2_exp_agg
	layer_2_expert_62 -> layer_2_exp_agg
	layer_2_expert_63 -> layer_2_exp_agg
	layer_2_attn_res -> layer_2_exp_norm
	layer_2_exp_agg -> layer_2_exp_res
	layer_2_attn_res -> layer_2_exp_res
	layer_3_input [label="Layer 3 Input
[batch=1024, seq=10000, hidden=8192]
GPU: 8-15" fillcolor=lightyellow shape=parallelogram style=filled]
	layer_3_mha_norm [label="MHA LayerNorm 3
[batch=1024, seq=10000, hidden=8192]
GPU: 8-15" fillcolor=lightcoral style=filled]
	layer_3_q_0 [label="Q Proj 3.0
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightblue style=filled]
	layer_3_k_0 [label="K Proj 3.0
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightblue style=filled]
	layer_3_v_0 [label="V Proj 3.0
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightblue style=filled]
	layer_3_attn_0 [label="Attention 3.0
[batch=1024, seq=10000, head=2, dim=512]
GPU: 8" fillcolor=lightgreen style=filled]
	layer_3_o_0 [label="O Proj 3.0
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightblue style=filled]
	layer_3_mha_norm -> layer_3_q_0
	layer_3_mha_norm -> layer_3_k_0
	layer_3_mha_norm -> layer_3_v_0
	layer_3_q_0 -> layer_3_attn_0
	layer_3_k_0 -> layer_3_attn_0
	layer_3_v_0 -> layer_3_attn_0
	layer_3_attn_0 -> layer_3_o_0
	layer_3_q_1 [label="Q Proj 3.1
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightblue style=filled]
	layer_3_k_1 [label="K Proj 3.1
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightblue style=filled]
	layer_3_v_1 [label="V Proj 3.1
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightblue style=filled]
	layer_3_attn_1 [label="Attention 3.1
[batch=1024, seq=10000, head=2, dim=512]
GPU: 9" fillcolor=lightgreen style=filled]
	layer_3_o_1 [label="O Proj 3.1
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightblue style=filled]
	layer_3_mha_norm -> layer_3_q_1
	layer_3_mha_norm -> layer_3_k_1
	layer_3_mha_norm -> layer_3_v_1
	layer_3_q_1 -> layer_3_attn_1
	layer_3_k_1 -> layer_3_attn_1
	layer_3_v_1 -> layer_3_attn_1
	layer_3_attn_1 -> layer_3_o_1
	layer_3_q_2 [label="Q Proj 3.2
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightblue style=filled]
	layer_3_k_2 [label="K Proj 3.2
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightblue style=filled]
	layer_3_v_2 [label="V Proj 3.2
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightblue style=filled]
	layer_3_attn_2 [label="Attention 3.2
[batch=1024, seq=10000, head=2, dim=512]
GPU: 10" fillcolor=lightgreen style=filled]
	layer_3_o_2 [label="O Proj 3.2
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightblue style=filled]
	layer_3_mha_norm -> layer_3_q_2
	layer_3_mha_norm -> layer_3_k_2
	layer_3_mha_norm -> layer_3_v_2
	layer_3_q_2 -> layer_3_attn_2
	layer_3_k_2 -> layer_3_attn_2
	layer_3_v_2 -> layer_3_attn_2
	layer_3_attn_2 -> layer_3_o_2
	layer_3_q_3 [label="Q Proj 3.3
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightblue style=filled]
	layer_3_k_3 [label="K Proj 3.3
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightblue style=filled]
	layer_3_v_3 [label="V Proj 3.3
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightblue style=filled]
	layer_3_attn_3 [label="Attention 3.3
[batch=1024, seq=10000, head=2, dim=512]
GPU: 11" fillcolor=lightgreen style=filled]
	layer_3_o_3 [label="O Proj 3.3
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightblue style=filled]
	layer_3_mha_norm -> layer_3_q_3
	layer_3_mha_norm -> layer_3_k_3
	layer_3_mha_norm -> layer_3_v_3
	layer_3_q_3 -> layer_3_attn_3
	layer_3_k_3 -> layer_3_attn_3
	layer_3_v_3 -> layer_3_attn_3
	layer_3_attn_3 -> layer_3_o_3
	layer_3_q_4 [label="Q Proj 3.4
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightblue style=filled]
	layer_3_k_4 [label="K Proj 3.4
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightblue style=filled]
	layer_3_v_4 [label="V Proj 3.4
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightblue style=filled]
	layer_3_attn_4 [label="Attention 3.4
[batch=1024, seq=10000, head=2, dim=512]
GPU: 12" fillcolor=lightgreen style=filled]
	layer_3_o_4 [label="O Proj 3.4
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightblue style=filled]
	layer_3_mha_norm -> layer_3_q_4
	layer_3_mha_norm -> layer_3_k_4
	layer_3_mha_norm -> layer_3_v_4
	layer_3_q_4 -> layer_3_attn_4
	layer_3_k_4 -> layer_3_attn_4
	layer_3_v_4 -> layer_3_attn_4
	layer_3_attn_4 -> layer_3_o_4
	layer_3_q_5 [label="Q Proj 3.5
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightblue style=filled]
	layer_3_k_5 [label="K Proj 3.5
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightblue style=filled]
	layer_3_v_5 [label="V Proj 3.5
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightblue style=filled]
	layer_3_attn_5 [label="Attention 3.5
[batch=1024, seq=10000, head=2, dim=512]
GPU: 13" fillcolor=lightgreen style=filled]
	layer_3_o_5 [label="O Proj 3.5
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightblue style=filled]
	layer_3_mha_norm -> layer_3_q_5
	layer_3_mha_norm -> layer_3_k_5
	layer_3_mha_norm -> layer_3_v_5
	layer_3_q_5 -> layer_3_attn_5
	layer_3_k_5 -> layer_3_attn_5
	layer_3_v_5 -> layer_3_attn_5
	layer_3_attn_5 -> layer_3_o_5
	layer_3_q_6 [label="Q Proj 3.6
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightblue style=filled]
	layer_3_k_6 [label="K Proj 3.6
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightblue style=filled]
	layer_3_v_6 [label="V Proj 3.6
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightblue style=filled]
	layer_3_attn_6 [label="Attention 3.6
[batch=1024, seq=10000, head=2, dim=512]
GPU: 14" fillcolor=lightgreen style=filled]
	layer_3_o_6 [label="O Proj 3.6
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightblue style=filled]
	layer_3_mha_norm -> layer_3_q_6
	layer_3_mha_norm -> layer_3_k_6
	layer_3_mha_norm -> layer_3_v_6
	layer_3_q_6 -> layer_3_attn_6
	layer_3_k_6 -> layer_3_attn_6
	layer_3_v_6 -> layer_3_attn_6
	layer_3_attn_6 -> layer_3_o_6
	layer_3_q_7 [label="Q Proj 3.7
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightblue style=filled]
	layer_3_k_7 [label="K Proj 3.7
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightblue style=filled]
	layer_3_v_7 [label="V Proj 3.7
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightblue style=filled]
	layer_3_attn_7 [label="Attention 3.7
[batch=1024, seq=10000, head=2, dim=512]
GPU: 15" fillcolor=lightgreen style=filled]
	layer_3_o_7 [label="O Proj 3.7
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightblue style=filled]
	layer_3_mha_norm -> layer_3_q_7
	layer_3_mha_norm -> layer_3_k_7
	layer_3_mha_norm -> layer_3_v_7
	layer_3_q_7 -> layer_3_attn_7
	layer_3_k_7 -> layer_3_attn_7
	layer_3_v_7 -> layer_3_attn_7
	layer_3_attn_7 -> layer_3_o_7
	layer_3_attn_reduce [label="All-Reduce 3
[batch=1024, seq=10000, hidden=8192]
GPU: 8-15" fillcolor=orange shape=parallelogram style=filled]
	layer_3_attn_res [label="Residual Add 3
[batch=1024, seq=10000, hidden=8192]
GPU: 8-15" fillcolor=lightyellow style=filled]
	layer_3_exp_norm [label="Expert Norm 3
[batch=1024, seq=10000, hidden=8192]
GPU: 8-15" fillcolor=lightcoral style=filled]
	layer_3_gate_64 [label="Gate 64
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_64 [label="Expert 64
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_64
	layer_3_gate_64 -> layer_3_expert_64 [style=dashed]
	layer_3_gate_65 [label="Gate 65
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_65 [label="Expert 65
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_65
	layer_3_gate_65 -> layer_3_expert_65 [style=dashed]
	layer_3_gate_66 [label="Gate 66
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_66 [label="Expert 66
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_66
	layer_3_gate_66 -> layer_3_expert_66 [style=dashed]
	layer_3_gate_67 [label="Gate 67
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_67 [label="Expert 67
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_67
	layer_3_gate_67 -> layer_3_expert_67 [style=dashed]
	layer_3_gate_68 [label="Gate 68
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_68 [label="Expert 68
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_68
	layer_3_gate_68 -> layer_3_expert_68 [style=dashed]
	layer_3_gate_69 [label="Gate 69
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_69 [label="Expert 69
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_69
	layer_3_gate_69 -> layer_3_expert_69 [style=dashed]
	layer_3_gate_70 [label="Gate 70
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_70 [label="Expert 70
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_70
	layer_3_gate_70 -> layer_3_expert_70 [style=dashed]
	layer_3_gate_71 [label="Gate 71
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_71 [label="Expert 71
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_71
	layer_3_gate_71 -> layer_3_expert_71 [style=dashed]
	layer_3_gate_72 [label="Gate 72
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_72 [label="Expert 72
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_72
	layer_3_gate_72 -> layer_3_expert_72 [style=dashed]
	layer_3_gate_73 [label="Gate 73
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_73 [label="Expert 73
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_73
	layer_3_gate_73 -> layer_3_expert_73 [style=dashed]
	layer_3_gate_74 [label="Gate 74
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_74 [label="Expert 74
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_74
	layer_3_gate_74 -> layer_3_expert_74 [style=dashed]
	layer_3_gate_75 [label="Gate 75
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_75 [label="Expert 75
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_75
	layer_3_gate_75 -> layer_3_expert_75 [style=dashed]
	layer_3_gate_76 [label="Gate 76
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_76 [label="Expert 76
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_76
	layer_3_gate_76 -> layer_3_expert_76 [style=dashed]
	layer_3_gate_77 [label="Gate 77
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_77 [label="Expert 77
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_77
	layer_3_gate_77 -> layer_3_expert_77 [style=dashed]
	layer_3_gate_78 [label="Gate 78
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_78 [label="Expert 78
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_78
	layer_3_gate_78 -> layer_3_expert_78 [style=dashed]
	layer_3_gate_79 [label="Gate 79
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_79 [label="Expert 79
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_79
	layer_3_gate_79 -> layer_3_expert_79 [style=dashed]
	layer_3_gate_80 [label="Gate 80
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_80 [label="Expert 80
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_80
	layer_3_gate_80 -> layer_3_expert_80 [style=dashed]
	layer_3_gate_81 [label="Gate 81
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_81 [label="Expert 81
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_81
	layer_3_gate_81 -> layer_3_expert_81 [style=dashed]
	layer_3_gate_82 [label="Gate 82
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_82 [label="Expert 82
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_82
	layer_3_gate_82 -> layer_3_expert_82 [style=dashed]
	layer_3_gate_83 [label="Gate 83
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_83 [label="Expert 83
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_83
	layer_3_gate_83 -> layer_3_expert_83 [style=dashed]
	layer_3_gate_84 [label="Gate 84
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_84 [label="Expert 84
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_84
	layer_3_gate_84 -> layer_3_expert_84 [style=dashed]
	layer_3_gate_85 [label="Gate 85
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_85 [label="Expert 85
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_85
	layer_3_gate_85 -> layer_3_expert_85 [style=dashed]
	layer_3_gate_86 [label="Gate 86
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_86 [label="Expert 86
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_86
	layer_3_gate_86 -> layer_3_expert_86 [style=dashed]
	layer_3_gate_87 [label="Gate 87
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_87 [label="Expert 87
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_87
	layer_3_gate_87 -> layer_3_expert_87 [style=dashed]
	layer_3_gate_88 [label="Gate 88
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_88 [label="Expert 88
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_88
	layer_3_gate_88 -> layer_3_expert_88 [style=dashed]
	layer_3_gate_89 [label="Gate 89
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_89 [label="Expert 89
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_89
	layer_3_gate_89 -> layer_3_expert_89 [style=dashed]
	layer_3_gate_90 [label="Gate 90
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_90 [label="Expert 90
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_90
	layer_3_gate_90 -> layer_3_expert_90 [style=dashed]
	layer_3_gate_91 [label="Gate 91
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_91 [label="Expert 91
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_91
	layer_3_gate_91 -> layer_3_expert_91 [style=dashed]
	layer_3_gate_92 [label="Gate 92
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_92 [label="Expert 92
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_92
	layer_3_gate_92 -> layer_3_expert_92 [style=dashed]
	layer_3_gate_93 [label="Gate 93
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_93 [label="Expert 93
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_93
	layer_3_gate_93 -> layer_3_expert_93 [style=dashed]
	layer_3_gate_94 [label="Gate 94
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_94 [label="Expert 94
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_94
	layer_3_gate_94 -> layer_3_expert_94 [style=dashed]
	layer_3_gate_95 [label="Gate 95
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_95 [label="Expert 95
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_95
	layer_3_gate_95 -> layer_3_expert_95 [style=dashed]
	layer_3_gate_96 [label="Gate 96
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_96 [label="Expert 96
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_96
	layer_3_gate_96 -> layer_3_expert_96 [style=dashed]
	layer_3_gate_97 [label="Gate 97
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_97 [label="Expert 97
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_97
	layer_3_gate_97 -> layer_3_expert_97 [style=dashed]
	layer_3_gate_98 [label="Gate 98
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_98 [label="Expert 98
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_98
	layer_3_gate_98 -> layer_3_expert_98 [style=dashed]
	layer_3_gate_99 [label="Gate 99
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_99 [label="Expert 99
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_99
	layer_3_gate_99 -> layer_3_expert_99 [style=dashed]
	layer_3_gate_100 [label="Gate 100
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_100 [label="Expert 100
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_100
	layer_3_gate_100 -> layer_3_expert_100 [style=dashed]
	layer_3_gate_101 [label="Gate 101
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_101 [label="Expert 101
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_101
	layer_3_gate_101 -> layer_3_expert_101 [style=dashed]
	layer_3_gate_102 [label="Gate 102
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_102 [label="Expert 102
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_102
	layer_3_gate_102 -> layer_3_expert_102 [style=dashed]
	layer_3_gate_103 [label="Gate 103
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_103 [label="Expert 103
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_103
	layer_3_gate_103 -> layer_3_expert_103 [style=dashed]
	layer_3_gate_104 [label="Gate 104
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_104 [label="Expert 104
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_104
	layer_3_gate_104 -> layer_3_expert_104 [style=dashed]
	layer_3_gate_105 [label="Gate 105
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_105 [label="Expert 105
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_105
	layer_3_gate_105 -> layer_3_expert_105 [style=dashed]
	layer_3_gate_106 [label="Gate 106
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_106 [label="Expert 106
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_106
	layer_3_gate_106 -> layer_3_expert_106 [style=dashed]
	layer_3_gate_107 [label="Gate 107
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_107 [label="Expert 107
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_107
	layer_3_gate_107 -> layer_3_expert_107 [style=dashed]
	layer_3_gate_108 [label="Gate 108
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_108 [label="Expert 108
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_108
	layer_3_gate_108 -> layer_3_expert_108 [style=dashed]
	layer_3_gate_109 [label="Gate 109
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_109 [label="Expert 109
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_109
	layer_3_gate_109 -> layer_3_expert_109 [style=dashed]
	layer_3_gate_110 [label="Gate 110
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_110 [label="Expert 110
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_110
	layer_3_gate_110 -> layer_3_expert_110 [style=dashed]
	layer_3_gate_111 [label="Gate 111
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_111 [label="Expert 111
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_111
	layer_3_gate_111 -> layer_3_expert_111 [style=dashed]
	layer_3_gate_112 [label="Gate 112
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_112 [label="Expert 112
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_112
	layer_3_gate_112 -> layer_3_expert_112 [style=dashed]
	layer_3_gate_113 [label="Gate 113
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_113 [label="Expert 113
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_113
	layer_3_gate_113 -> layer_3_expert_113 [style=dashed]
	layer_3_gate_114 [label="Gate 114
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_114 [label="Expert 114
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_114
	layer_3_gate_114 -> layer_3_expert_114 [style=dashed]
	layer_3_gate_115 [label="Gate 115
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_115 [label="Expert 115
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_115
	layer_3_gate_115 -> layer_3_expert_115 [style=dashed]
	layer_3_gate_116 [label="Gate 116
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_116 [label="Expert 116
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_116
	layer_3_gate_116 -> layer_3_expert_116 [style=dashed]
	layer_3_gate_117 [label="Gate 117
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_117 [label="Expert 117
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_117
	layer_3_gate_117 -> layer_3_expert_117 [style=dashed]
	layer_3_gate_118 [label="Gate 118
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_118 [label="Expert 118
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_118
	layer_3_gate_118 -> layer_3_expert_118 [style=dashed]
	layer_3_gate_119 [label="Gate 119
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_119 [label="Expert 119
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_119
	layer_3_gate_119 -> layer_3_expert_119 [style=dashed]
	layer_3_gate_120 [label="Gate 120
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_120 [label="Expert 120
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_120
	layer_3_gate_120 -> layer_3_expert_120 [style=dashed]
	layer_3_gate_121 [label="Gate 121
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_121 [label="Expert 121
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_121
	layer_3_gate_121 -> layer_3_expert_121 [style=dashed]
	layer_3_gate_122 [label="Gate 122
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_122 [label="Expert 122
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_122
	layer_3_gate_122 -> layer_3_expert_122 [style=dashed]
	layer_3_gate_123 [label="Gate 123
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_123 [label="Expert 123
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_123
	layer_3_gate_123 -> layer_3_expert_123 [style=dashed]
	layer_3_gate_124 [label="Gate 124
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_124 [label="Expert 124
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_124
	layer_3_gate_124 -> layer_3_expert_124 [style=dashed]
	layer_3_gate_125 [label="Gate 125
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_125 [label="Expert 125
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_125
	layer_3_gate_125 -> layer_3_expert_125 [style=dashed]
	layer_3_gate_126 [label="Gate 126
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_126 [label="Expert 126
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_126
	layer_3_gate_126 -> layer_3_expert_126 [style=dashed]
	layer_3_gate_127 [label="Gate 127
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=yellow shape=diamond style=filled]
	layer_3_expert_127 [label="Expert 127
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightpink style=filled]
	layer_3_exp_norm -> layer_3_gate_127
	layer_3_gate_127 -> layer_3_expert_127 [style=dashed]
	layer_3_exp_agg [label="Expert Agg 3
[batch=1024, seq=10000, hidden=8192]
GPU: 8-15" fillcolor=orange shape=parallelogram style=filled]
	layer_3_exp_res [label="Expert Residual 3
[batch=1024, seq=10000, hidden=8192]
GPU: 8-15" fillcolor=lightyellow style=filled]
	pipeline_comm_2_to_3 [label="Pipeline Comm
[batch=1024, seq=10000, hidden=8192]
GPU: 7 to 8" fillcolor=lightgreen shape=ellipse style=filled]
	layer_2_exp_res -> pipeline_comm_2_to_3
	pipeline_comm_2_to_3 -> layer_3_input
	layer_3_o_0 -> layer_3_attn_reduce
	layer_3_o_1 -> layer_3_attn_reduce
	layer_3_o_2 -> layer_3_attn_reduce
	layer_3_o_3 -> layer_3_attn_reduce
	layer_3_o_4 -> layer_3_attn_reduce
	layer_3_o_5 -> layer_3_attn_reduce
	layer_3_o_6 -> layer_3_attn_reduce
	layer_3_o_7 -> layer_3_attn_reduce
	layer_3_attn_reduce -> layer_3_attn_res
	layer_3_input -> layer_3_attn_res
	layer_3_expert_64 -> layer_3_exp_agg
	layer_3_expert_65 -> layer_3_exp_agg
	layer_3_expert_66 -> layer_3_exp_agg
	layer_3_expert_67 -> layer_3_exp_agg
	layer_3_expert_68 -> layer_3_exp_agg
	layer_3_expert_69 -> layer_3_exp_agg
	layer_3_expert_70 -> layer_3_exp_agg
	layer_3_expert_71 -> layer_3_exp_agg
	layer_3_expert_72 -> layer_3_exp_agg
	layer_3_expert_73 -> layer_3_exp_agg
	layer_3_expert_74 -> layer_3_exp_agg
	layer_3_expert_75 -> layer_3_exp_agg
	layer_3_expert_76 -> layer_3_exp_agg
	layer_3_expert_77 -> layer_3_exp_agg
	layer_3_expert_78 -> layer_3_exp_agg
	layer_3_expert_79 -> layer_3_exp_agg
	layer_3_expert_80 -> layer_3_exp_agg
	layer_3_expert_81 -> layer_3_exp_agg
	layer_3_expert_82 -> layer_3_exp_agg
	layer_3_expert_83 -> layer_3_exp_agg
	layer_3_expert_84 -> layer_3_exp_agg
	layer_3_expert_85 -> layer_3_exp_agg
	layer_3_expert_86 -> layer_3_exp_agg
	layer_3_expert_87 -> layer_3_exp_agg
	layer_3_expert_88 -> layer_3_exp_agg
	layer_3_expert_89 -> layer_3_exp_agg
	layer_3_expert_90 -> layer_3_exp_agg
	layer_3_expert_91 -> layer_3_exp_agg
	layer_3_expert_92 -> layer_3_exp_agg
	layer_3_expert_93 -> layer_3_exp_agg
	layer_3_expert_94 -> layer_3_exp_agg
	layer_3_expert_95 -> layer_3_exp_agg
	layer_3_expert_96 -> layer_3_exp_agg
	layer_3_expert_97 -> layer_3_exp_agg
	layer_3_expert_98 -> layer_3_exp_agg
	layer_3_expert_99 -> layer_3_exp_agg
	layer_3_expert_100 -> layer_3_exp_agg
	layer_3_expert_101 -> layer_3_exp_agg
	layer_3_expert_102 -> layer_3_exp_agg
	layer_3_expert_103 -> layer_3_exp_agg
	layer_3_expert_104 -> layer_3_exp_agg
	layer_3_expert_105 -> layer_3_exp_agg
	layer_3_expert_106 -> layer_3_exp_agg
	layer_3_expert_107 -> layer_3_exp_agg
	layer_3_expert_108 -> layer_3_exp_agg
	layer_3_expert_109 -> layer_3_exp_agg
	layer_3_expert_110 -> layer_3_exp_agg
	layer_3_expert_111 -> layer_3_exp_agg
	layer_3_expert_112 -> layer_3_exp_agg
	layer_3_expert_113 -> layer_3_exp_agg
	layer_3_expert_114 -> layer_3_exp_agg
	layer_3_expert_115 -> layer_3_exp_agg
	layer_3_expert_116 -> layer_3_exp_agg
	layer_3_expert_117 -> layer_3_exp_agg
	layer_3_expert_118 -> layer_3_exp_agg
	layer_3_expert_119 -> layer_3_exp_agg
	layer_3_expert_120 -> layer_3_exp_agg
	layer_3_expert_121 -> layer_3_exp_agg
	layer_3_expert_122 -> layer_3_exp_agg
	layer_3_expert_123 -> layer_3_exp_agg
	layer_3_expert_124 -> layer_3_exp_agg
	layer_3_expert_125 -> layer_3_exp_agg
	layer_3_expert_126 -> layer_3_exp_agg
	layer_3_expert_127 -> layer_3_exp_agg
	layer_3_attn_res -> layer_3_exp_norm
	layer_3_exp_agg -> layer_3_exp_res
	layer_3_attn_res -> layer_3_exp_res
	layer_4_input [label="Layer 4 Input
[batch=1024, seq=10000, hidden=8192]
GPU: 8-15" fillcolor=lightyellow shape=parallelogram style=filled]
	layer_4_mha_norm [label="MHA LayerNorm 4
[batch=1024, seq=10000, hidden=8192]
GPU: 8-15" fillcolor=lightcoral style=filled]
	layer_4_q_0 [label="Q Proj 4.0
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightblue style=filled]
	layer_4_k_0 [label="K Proj 4.0
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightblue style=filled]
	layer_4_v_0 [label="V Proj 4.0
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightblue style=filled]
	layer_4_attn_0 [label="Attention 4.0
[batch=1024, seq=10000, head=2, dim=512]
GPU: 8" fillcolor=lightgreen style=filled]
	layer_4_o_0 [label="O Proj 4.0
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightblue style=filled]
	layer_4_mha_norm -> layer_4_q_0
	layer_4_mha_norm -> layer_4_k_0
	layer_4_mha_norm -> layer_4_v_0
	layer_4_q_0 -> layer_4_attn_0
	layer_4_k_0 -> layer_4_attn_0
	layer_4_v_0 -> layer_4_attn_0
	layer_4_attn_0 -> layer_4_o_0
	layer_4_q_1 [label="Q Proj 4.1
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightblue style=filled]
	layer_4_k_1 [label="K Proj 4.1
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightblue style=filled]
	layer_4_v_1 [label="V Proj 4.1
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightblue style=filled]
	layer_4_attn_1 [label="Attention 4.1
[batch=1024, seq=10000, head=2, dim=512]
GPU: 9" fillcolor=lightgreen style=filled]
	layer_4_o_1 [label="O Proj 4.1
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightblue style=filled]
	layer_4_mha_norm -> layer_4_q_1
	layer_4_mha_norm -> layer_4_k_1
	layer_4_mha_norm -> layer_4_v_1
	layer_4_q_1 -> layer_4_attn_1
	layer_4_k_1 -> layer_4_attn_1
	layer_4_v_1 -> layer_4_attn_1
	layer_4_attn_1 -> layer_4_o_1
	layer_4_q_2 [label="Q Proj 4.2
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightblue style=filled]
	layer_4_k_2 [label="K Proj 4.2
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightblue style=filled]
	layer_4_v_2 [label="V Proj 4.2
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightblue style=filled]
	layer_4_attn_2 [label="Attention 4.2
[batch=1024, seq=10000, head=2, dim=512]
GPU: 10" fillcolor=lightgreen style=filled]
	layer_4_o_2 [label="O Proj 4.2
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightblue style=filled]
	layer_4_mha_norm -> layer_4_q_2
	layer_4_mha_norm -> layer_4_k_2
	layer_4_mha_norm -> layer_4_v_2
	layer_4_q_2 -> layer_4_attn_2
	layer_4_k_2 -> layer_4_attn_2
	layer_4_v_2 -> layer_4_attn_2
	layer_4_attn_2 -> layer_4_o_2
	layer_4_q_3 [label="Q Proj 4.3
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightblue style=filled]
	layer_4_k_3 [label="K Proj 4.3
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightblue style=filled]
	layer_4_v_3 [label="V Proj 4.3
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightblue style=filled]
	layer_4_attn_3 [label="Attention 4.3
[batch=1024, seq=10000, head=2, dim=512]
GPU: 11" fillcolor=lightgreen style=filled]
	layer_4_o_3 [label="O Proj 4.3
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightblue style=filled]
	layer_4_mha_norm -> layer_4_q_3
	layer_4_mha_norm -> layer_4_k_3
	layer_4_mha_norm -> layer_4_v_3
	layer_4_q_3 -> layer_4_attn_3
	layer_4_k_3 -> layer_4_attn_3
	layer_4_v_3 -> layer_4_attn_3
	layer_4_attn_3 -> layer_4_o_3
	layer_4_q_4 [label="Q Proj 4.4
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightblue style=filled]
	layer_4_k_4 [label="K Proj 4.4
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightblue style=filled]
	layer_4_v_4 [label="V Proj 4.4
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightblue style=filled]
	layer_4_attn_4 [label="Attention 4.4
[batch=1024, seq=10000, head=2, dim=512]
GPU: 12" fillcolor=lightgreen style=filled]
	layer_4_o_4 [label="O Proj 4.4
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightblue style=filled]
	layer_4_mha_norm -> layer_4_q_4
	layer_4_mha_norm -> layer_4_k_4
	layer_4_mha_norm -> layer_4_v_4
	layer_4_q_4 -> layer_4_attn_4
	layer_4_k_4 -> layer_4_attn_4
	layer_4_v_4 -> layer_4_attn_4
	layer_4_attn_4 -> layer_4_o_4
	layer_4_q_5 [label="Q Proj 4.5
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightblue style=filled]
	layer_4_k_5 [label="K Proj 4.5
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightblue style=filled]
	layer_4_v_5 [label="V Proj 4.5
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightblue style=filled]
	layer_4_attn_5 [label="Attention 4.5
[batch=1024, seq=10000, head=2, dim=512]
GPU: 13" fillcolor=lightgreen style=filled]
	layer_4_o_5 [label="O Proj 4.5
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightblue style=filled]
	layer_4_mha_norm -> layer_4_q_5
	layer_4_mha_norm -> layer_4_k_5
	layer_4_mha_norm -> layer_4_v_5
	layer_4_q_5 -> layer_4_attn_5
	layer_4_k_5 -> layer_4_attn_5
	layer_4_v_5 -> layer_4_attn_5
	layer_4_attn_5 -> layer_4_o_5
	layer_4_q_6 [label="Q Proj 4.6
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightblue style=filled]
	layer_4_k_6 [label="K Proj 4.6
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightblue style=filled]
	layer_4_v_6 [label="V Proj 4.6
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightblue style=filled]
	layer_4_attn_6 [label="Attention 4.6
[batch=1024, seq=10000, head=2, dim=512]
GPU: 14" fillcolor=lightgreen style=filled]
	layer_4_o_6 [label="O Proj 4.6
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightblue style=filled]
	layer_4_mha_norm -> layer_4_q_6
	layer_4_mha_norm -> layer_4_k_6
	layer_4_mha_norm -> layer_4_v_6
	layer_4_q_6 -> layer_4_attn_6
	layer_4_k_6 -> layer_4_attn_6
	layer_4_v_6 -> layer_4_attn_6
	layer_4_attn_6 -> layer_4_o_6
	layer_4_q_7 [label="Q Proj 4.7
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightblue style=filled]
	layer_4_k_7 [label="K Proj 4.7
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightblue style=filled]
	layer_4_v_7 [label="V Proj 4.7
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightblue style=filled]
	layer_4_attn_7 [label="Attention 4.7
[batch=1024, seq=10000, head=2, dim=512]
GPU: 15" fillcolor=lightgreen style=filled]
	layer_4_o_7 [label="O Proj 4.7
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightblue style=filled]
	layer_4_mha_norm -> layer_4_q_7
	layer_4_mha_norm -> layer_4_k_7
	layer_4_mha_norm -> layer_4_v_7
	layer_4_q_7 -> layer_4_attn_7
	layer_4_k_7 -> layer_4_attn_7
	layer_4_v_7 -> layer_4_attn_7
	layer_4_attn_7 -> layer_4_o_7
	layer_4_attn_reduce [label="All-Reduce 4
[batch=1024, seq=10000, hidden=8192]
GPU: 8-15" fillcolor=orange shape=parallelogram style=filled]
	layer_4_attn_res [label="Residual Add 4
[batch=1024, seq=10000, hidden=8192]
GPU: 8-15" fillcolor=lightyellow style=filled]
	layer_4_exp_norm [label="Expert Norm 4
[batch=1024, seq=10000, hidden=8192]
GPU: 8-15" fillcolor=lightcoral style=filled]
	layer_4_gate_64 [label="Gate 64
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_64 [label="Expert 64
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_64
	layer_4_gate_64 -> layer_4_expert_64 [style=dashed]
	layer_4_gate_65 [label="Gate 65
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_65 [label="Expert 65
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_65
	layer_4_gate_65 -> layer_4_expert_65 [style=dashed]
	layer_4_gate_66 [label="Gate 66
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_66 [label="Expert 66
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_66
	layer_4_gate_66 -> layer_4_expert_66 [style=dashed]
	layer_4_gate_67 [label="Gate 67
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_67 [label="Expert 67
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_67
	layer_4_gate_67 -> layer_4_expert_67 [style=dashed]
	layer_4_gate_68 [label="Gate 68
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_68 [label="Expert 68
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_68
	layer_4_gate_68 -> layer_4_expert_68 [style=dashed]
	layer_4_gate_69 [label="Gate 69
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_69 [label="Expert 69
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_69
	layer_4_gate_69 -> layer_4_expert_69 [style=dashed]
	layer_4_gate_70 [label="Gate 70
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_70 [label="Expert 70
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_70
	layer_4_gate_70 -> layer_4_expert_70 [style=dashed]
	layer_4_gate_71 [label="Gate 71
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_71 [label="Expert 71
[batch=1024, seq=10000, hidden=1024]
GPU: 8" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_71
	layer_4_gate_71 -> layer_4_expert_71 [style=dashed]
	layer_4_gate_72 [label="Gate 72
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_72 [label="Expert 72
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_72
	layer_4_gate_72 -> layer_4_expert_72 [style=dashed]
	layer_4_gate_73 [label="Gate 73
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_73 [label="Expert 73
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_73
	layer_4_gate_73 -> layer_4_expert_73 [style=dashed]
	layer_4_gate_74 [label="Gate 74
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_74 [label="Expert 74
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_74
	layer_4_gate_74 -> layer_4_expert_74 [style=dashed]
	layer_4_gate_75 [label="Gate 75
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_75 [label="Expert 75
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_75
	layer_4_gate_75 -> layer_4_expert_75 [style=dashed]
	layer_4_gate_76 [label="Gate 76
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_76 [label="Expert 76
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_76
	layer_4_gate_76 -> layer_4_expert_76 [style=dashed]
	layer_4_gate_77 [label="Gate 77
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_77 [label="Expert 77
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_77
	layer_4_gate_77 -> layer_4_expert_77 [style=dashed]
	layer_4_gate_78 [label="Gate 78
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_78 [label="Expert 78
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_78
	layer_4_gate_78 -> layer_4_expert_78 [style=dashed]
	layer_4_gate_79 [label="Gate 79
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_79 [label="Expert 79
[batch=1024, seq=10000, hidden=1024]
GPU: 9" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_79
	layer_4_gate_79 -> layer_4_expert_79 [style=dashed]
	layer_4_gate_80 [label="Gate 80
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_80 [label="Expert 80
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_80
	layer_4_gate_80 -> layer_4_expert_80 [style=dashed]
	layer_4_gate_81 [label="Gate 81
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_81 [label="Expert 81
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_81
	layer_4_gate_81 -> layer_4_expert_81 [style=dashed]
	layer_4_gate_82 [label="Gate 82
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_82 [label="Expert 82
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_82
	layer_4_gate_82 -> layer_4_expert_82 [style=dashed]
	layer_4_gate_83 [label="Gate 83
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_83 [label="Expert 83
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_83
	layer_4_gate_83 -> layer_4_expert_83 [style=dashed]
	layer_4_gate_84 [label="Gate 84
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_84 [label="Expert 84
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_84
	layer_4_gate_84 -> layer_4_expert_84 [style=dashed]
	layer_4_gate_85 [label="Gate 85
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_85 [label="Expert 85
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_85
	layer_4_gate_85 -> layer_4_expert_85 [style=dashed]
	layer_4_gate_86 [label="Gate 86
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_86 [label="Expert 86
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_86
	layer_4_gate_86 -> layer_4_expert_86 [style=dashed]
	layer_4_gate_87 [label="Gate 87
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_87 [label="Expert 87
[batch=1024, seq=10000, hidden=1024]
GPU: 10" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_87
	layer_4_gate_87 -> layer_4_expert_87 [style=dashed]
	layer_4_gate_88 [label="Gate 88
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_88 [label="Expert 88
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_88
	layer_4_gate_88 -> layer_4_expert_88 [style=dashed]
	layer_4_gate_89 [label="Gate 89
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_89 [label="Expert 89
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_89
	layer_4_gate_89 -> layer_4_expert_89 [style=dashed]
	layer_4_gate_90 [label="Gate 90
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_90 [label="Expert 90
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_90
	layer_4_gate_90 -> layer_4_expert_90 [style=dashed]
	layer_4_gate_91 [label="Gate 91
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_91 [label="Expert 91
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_91
	layer_4_gate_91 -> layer_4_expert_91 [style=dashed]
	layer_4_gate_92 [label="Gate 92
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_92 [label="Expert 92
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_92
	layer_4_gate_92 -> layer_4_expert_92 [style=dashed]
	layer_4_gate_93 [label="Gate 93
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_93 [label="Expert 93
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_93
	layer_4_gate_93 -> layer_4_expert_93 [style=dashed]
	layer_4_gate_94 [label="Gate 94
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_94 [label="Expert 94
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_94
	layer_4_gate_94 -> layer_4_expert_94 [style=dashed]
	layer_4_gate_95 [label="Gate 95
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_95 [label="Expert 95
[batch=1024, seq=10000, hidden=1024]
GPU: 11" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_95
	layer_4_gate_95 -> layer_4_expert_95 [style=dashed]
	layer_4_gate_96 [label="Gate 96
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_96 [label="Expert 96
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_96
	layer_4_gate_96 -> layer_4_expert_96 [style=dashed]
	layer_4_gate_97 [label="Gate 97
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_97 [label="Expert 97
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_97
	layer_4_gate_97 -> layer_4_expert_97 [style=dashed]
	layer_4_gate_98 [label="Gate 98
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_98 [label="Expert 98
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_98
	layer_4_gate_98 -> layer_4_expert_98 [style=dashed]
	layer_4_gate_99 [label="Gate 99
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_99 [label="Expert 99
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_99
	layer_4_gate_99 -> layer_4_expert_99 [style=dashed]
	layer_4_gate_100 [label="Gate 100
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_100 [label="Expert 100
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_100
	layer_4_gate_100 -> layer_4_expert_100 [style=dashed]
	layer_4_gate_101 [label="Gate 101
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_101 [label="Expert 101
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_101
	layer_4_gate_101 -> layer_4_expert_101 [style=dashed]
	layer_4_gate_102 [label="Gate 102
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_102 [label="Expert 102
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_102
	layer_4_gate_102 -> layer_4_expert_102 [style=dashed]
	layer_4_gate_103 [label="Gate 103
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_103 [label="Expert 103
[batch=1024, seq=10000, hidden=1024]
GPU: 12" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_103
	layer_4_gate_103 -> layer_4_expert_103 [style=dashed]
	layer_4_gate_104 [label="Gate 104
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_104 [label="Expert 104
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_104
	layer_4_gate_104 -> layer_4_expert_104 [style=dashed]
	layer_4_gate_105 [label="Gate 105
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_105 [label="Expert 105
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_105
	layer_4_gate_105 -> layer_4_expert_105 [style=dashed]
	layer_4_gate_106 [label="Gate 106
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_106 [label="Expert 106
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_106
	layer_4_gate_106 -> layer_4_expert_106 [style=dashed]
	layer_4_gate_107 [label="Gate 107
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_107 [label="Expert 107
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_107
	layer_4_gate_107 -> layer_4_expert_107 [style=dashed]
	layer_4_gate_108 [label="Gate 108
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_108 [label="Expert 108
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_108
	layer_4_gate_108 -> layer_4_expert_108 [style=dashed]
	layer_4_gate_109 [label="Gate 109
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_109 [label="Expert 109
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_109
	layer_4_gate_109 -> layer_4_expert_109 [style=dashed]
	layer_4_gate_110 [label="Gate 110
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_110 [label="Expert 110
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_110
	layer_4_gate_110 -> layer_4_expert_110 [style=dashed]
	layer_4_gate_111 [label="Gate 111
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_111 [label="Expert 111
[batch=1024, seq=10000, hidden=1024]
GPU: 13" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_111
	layer_4_gate_111 -> layer_4_expert_111 [style=dashed]
	layer_4_gate_112 [label="Gate 112
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_112 [label="Expert 112
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_112
	layer_4_gate_112 -> layer_4_expert_112 [style=dashed]
	layer_4_gate_113 [label="Gate 113
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_113 [label="Expert 113
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_113
	layer_4_gate_113 -> layer_4_expert_113 [style=dashed]
	layer_4_gate_114 [label="Gate 114
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_114 [label="Expert 114
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_114
	layer_4_gate_114 -> layer_4_expert_114 [style=dashed]
	layer_4_gate_115 [label="Gate 115
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_115 [label="Expert 115
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_115
	layer_4_gate_115 -> layer_4_expert_115 [style=dashed]
	layer_4_gate_116 [label="Gate 116
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_116 [label="Expert 116
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_116
	layer_4_gate_116 -> layer_4_expert_116 [style=dashed]
	layer_4_gate_117 [label="Gate 117
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_117 [label="Expert 117
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_117
	layer_4_gate_117 -> layer_4_expert_117 [style=dashed]
	layer_4_gate_118 [label="Gate 118
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_118 [label="Expert 118
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_118
	layer_4_gate_118 -> layer_4_expert_118 [style=dashed]
	layer_4_gate_119 [label="Gate 119
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_119 [label="Expert 119
[batch=1024, seq=10000, hidden=1024]
GPU: 14" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_119
	layer_4_gate_119 -> layer_4_expert_119 [style=dashed]
	layer_4_gate_120 [label="Gate 120
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_120 [label="Expert 120
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_120
	layer_4_gate_120 -> layer_4_expert_120 [style=dashed]
	layer_4_gate_121 [label="Gate 121
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_121 [label="Expert 121
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_121
	layer_4_gate_121 -> layer_4_expert_121 [style=dashed]
	layer_4_gate_122 [label="Gate 122
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_122 [label="Expert 122
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_122
	layer_4_gate_122 -> layer_4_expert_122 [style=dashed]
	layer_4_gate_123 [label="Gate 123
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_123 [label="Expert 123
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_123
	layer_4_gate_123 -> layer_4_expert_123 [style=dashed]
	layer_4_gate_124 [label="Gate 124
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_124 [label="Expert 124
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_124
	layer_4_gate_124 -> layer_4_expert_124 [style=dashed]
	layer_4_gate_125 [label="Gate 125
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_125 [label="Expert 125
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_125
	layer_4_gate_125 -> layer_4_expert_125 [style=dashed]
	layer_4_gate_126 [label="Gate 126
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_126 [label="Expert 126
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_126
	layer_4_gate_126 -> layer_4_expert_126 [style=dashed]
	layer_4_gate_127 [label="Gate 127
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=yellow shape=diamond style=filled]
	layer_4_expert_127 [label="Expert 127
[batch=1024, seq=10000, hidden=1024]
GPU: 15" fillcolor=lightpink style=filled]
	layer_4_exp_norm -> layer_4_gate_127
	layer_4_gate_127 -> layer_4_expert_127 [style=dashed]
	layer_4_exp_agg [label="Expert Agg 4
[batch=1024, seq=10000, hidden=8192]
GPU: 8-15" fillcolor=orange shape=parallelogram style=filled]
	layer_4_exp_res [label="Expert Residual 4
[batch=1024, seq=10000, hidden=8192]
GPU: 8-15" fillcolor=lightyellow style=filled]
	layer_3_exp_res -> layer_4_input
	layer_4_o_0 -> layer_4_attn_reduce
	layer_4_o_1 -> layer_4_attn_reduce
	layer_4_o_2 -> layer_4_attn_reduce
	layer_4_o_3 -> layer_4_attn_reduce
	layer_4_o_4 -> layer_4_attn_reduce
	layer_4_o_5 -> layer_4_attn_reduce
	layer_4_o_6 -> layer_4_attn_reduce
	layer_4_o_7 -> layer_4_attn_reduce
	layer_4_attn_reduce -> layer_4_attn_res
	layer_4_input -> layer_4_attn_res
	layer_4_expert_64 -> layer_4_exp_agg
	layer_4_expert_65 -> layer_4_exp_agg
	layer_4_expert_66 -> layer_4_exp_agg
	layer_4_expert_67 -> layer_4_exp_agg
	layer_4_expert_68 -> layer_4_exp_agg
	layer_4_expert_69 -> layer_4_exp_agg
	layer_4_expert_70 -> layer_4_exp_agg
	layer_4_expert_71 -> layer_4_exp_agg
	layer_4_expert_72 -> layer_4_exp_agg
	layer_4_expert_73 -> layer_4_exp_agg
	layer_4_expert_74 -> layer_4_exp_agg
	layer_4_expert_75 -> layer_4_exp_agg
	layer_4_expert_76 -> layer_4_exp_agg
	layer_4_expert_77 -> layer_4_exp_agg
	layer_4_expert_78 -> layer_4_exp_agg
	layer_4_expert_79 -> layer_4_exp_agg
	layer_4_expert_80 -> layer_4_exp_agg
	layer_4_expert_81 -> layer_4_exp_agg
	layer_4_expert_82 -> layer_4_exp_agg
	layer_4_expert_83 -> layer_4_exp_agg
	layer_4_expert_84 -> layer_4_exp_agg
	layer_4_expert_85 -> layer_4_exp_agg
	layer_4_expert_86 -> layer_4_exp_agg
	layer_4_expert_87 -> layer_4_exp_agg
	layer_4_expert_88 -> layer_4_exp_agg
	layer_4_expert_89 -> layer_4_exp_agg
	layer_4_expert_90 -> layer_4_exp_agg
	layer_4_expert_91 -> layer_4_exp_agg
	layer_4_expert_92 -> layer_4_exp_agg
	layer_4_expert_93 -> layer_4_exp_agg
	layer_4_expert_94 -> layer_4_exp_agg
	layer_4_expert_95 -> layer_4_exp_agg
	layer_4_expert_96 -> layer_4_exp_agg
	layer_4_expert_97 -> layer_4_exp_agg
	layer_4_expert_98 -> layer_4_exp_agg
	layer_4_expert_99 -> layer_4_exp_agg
	layer_4_expert_100 -> layer_4_exp_agg
	layer_4_expert_101 -> layer_4_exp_agg
	layer_4_expert_102 -> layer_4_exp_agg
	layer_4_expert_103 -> layer_4_exp_agg
	layer_4_expert_104 -> layer_4_exp_agg
	layer_4_expert_105 -> layer_4_exp_agg
	layer_4_expert_106 -> layer_4_exp_agg
	layer_4_expert_107 -> layer_4_exp_agg
	layer_4_expert_108 -> layer_4_exp_agg
	layer_4_expert_109 -> layer_4_exp_agg
	layer_4_expert_110 -> layer_4_exp_agg
	layer_4_expert_111 -> layer_4_exp_agg
	layer_4_expert_112 -> layer_4_exp_agg
	layer_4_expert_113 -> layer_4_exp_agg
	layer_4_expert_114 -> layer_4_exp_agg
	layer_4_expert_115 -> layer_4_exp_agg
	layer_4_expert_116 -> layer_4_exp_agg
	layer_4_expert_117 -> layer_4_exp_agg
	layer_4_expert_118 -> layer_4_exp_agg
	layer_4_expert_119 -> layer_4_exp_agg
	layer_4_expert_120 -> layer_4_exp_agg
	layer_4_expert_121 -> layer_4_exp_agg
	layer_4_expert_122 -> layer_4_exp_agg
	layer_4_expert_123 -> layer_4_exp_agg
	layer_4_expert_124 -> layer_4_exp_agg
	layer_4_expert_125 -> layer_4_exp_agg
	layer_4_expert_126 -> layer_4_exp_agg
	layer_4_expert_127 -> layer_4_exp_agg
	layer_4_attn_res -> layer_4_exp_norm
	layer_4_exp_agg -> layer_4_exp_res
	layer_4_attn_res -> layer_4_exp_res
	layer_4_exp_res -> output
}
