<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MoE_EP16_Proposed Pages: 1 -->
<svg width="12231pt" height="7299pt"
 viewBox="0.00 0.00 12230.87 7298.58" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 7294.58)">
<title>MoE_EP16_Proposed</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-7294.58 12226.87,-7294.58 12226.87,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="9473.72" cy="-7253.1" rx="219.82" ry="37.45"/>
<text text-anchor="middle" x="9473.72" y="-7264.4" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="9473.72" y="-7249.4" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9473.72" y="-7234.4" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_1_input -->
<g id="node2" class="node">
<title>layer_1_input</title>
<ellipse fill="lightgreen" stroke="black" cx="9473.72" cy="-7142.15" rx="219.82" ry="37.45"/>
<text text-anchor="middle" x="9473.72" y="-7153.45" font-family="Times,serif" font-size="14.00">Layer 1 Input</text>
<text text-anchor="middle" x="9473.72" y="-7138.45" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9473.72" y="-7123.45" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- input&#45;&gt;layer_1_input -->
<g id="edge65" class="edge">
<title>input&#45;&gt;layer_1_input</title>
<path fill="none" stroke="black" d="M9473.72,-7215.52C9473.72,-7207.35 9473.72,-7198.57 9473.72,-7190.04"/>
<polygon fill="black" stroke="black" points="9477.22,-7189.82 9473.72,-7179.82 9470.22,-7189.82 9477.22,-7189.82"/>
</g>
<!-- layer_1_mha_norm -->
<g id="node3" class="node">
<title>layer_1_mha_norm</title>
<polygon fill="lightcoral" stroke="black" points="9537.22,-7068.67 9226.22,-7068.67 9226.22,-7015.67 9537.22,-7015.67 9537.22,-7068.67"/>
<text text-anchor="middle" x="9381.72" y="-7053.47" font-family="Times,serif" font-size="14.00">MHA LayerNorm 1</text>
<text text-anchor="middle" x="9381.72" y="-7038.47" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9381.72" y="-7023.47" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_1_input&#45;&gt;layer_1_mha_norm -->
<g id="edge66" class="edge">
<title>layer_1_input&#45;&gt;layer_1_mha_norm</title>
<path fill="none" stroke="black" d="M9439.72,-7104.95C9430.92,-7095.58 9421.5,-7085.54 9412.85,-7076.33"/>
<polygon fill="black" stroke="black" points="9415.2,-7073.72 9405.81,-7068.83 9410.1,-7078.52 9415.2,-7073.72"/>
</g>
<!-- layer_1_mha_res -->
<g id="node9" class="node">
<title>layer_1_mha_res</title>
<polygon fill="lightyellow" stroke="black" points="9781.22,-6712.67 9470.22,-6712.67 9470.22,-6659.67 9781.22,-6659.67 9781.22,-6712.67"/>
<text text-anchor="middle" x="9625.72" y="-6697.47" font-family="Times,serif" font-size="14.00">MHA Residual 1</text>
<text text-anchor="middle" x="9625.72" y="-6682.47" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9625.72" y="-6667.47" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_1_input&#45;&gt;layer_1_mha_res -->
<g id="edge75" class="edge">
<title>layer_1_input&#45;&gt;layer_1_mha_res</title>
<path fill="none" stroke="black" d="M9581.17,-7109.28C9651.23,-7081.13 9729.72,-7032.19 9729.72,-6954.17 9729.72,-6954.17 9729.72,-6954.17 9729.72,-6863.17 9729.72,-6810.45 9727.06,-6793.13 9698.72,-6748.67 9691.83,-6737.87 9682.44,-6727.98 9672.69,-6719.44"/>
<polygon fill="black" stroke="black" points="9674.76,-6716.6 9664.84,-6712.89 9670.27,-6721.98 9674.76,-6716.6"/>
</g>
<!-- layer_1_mha_q -->
<g id="node4" class="node">
<title>layer_1_mha_q</title>
<polygon fill="lightblue" stroke="black" points="9043.22,-6979.67 8732.22,-6979.67 8732.22,-6926.67 9043.22,-6926.67 9043.22,-6979.67"/>
<text text-anchor="middle" x="8887.72" y="-6964.47" font-family="Times,serif" font-size="14.00">MHA Q Proj 1</text>
<text text-anchor="middle" x="8887.72" y="-6949.47" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="8887.72" y="-6934.47" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_1_mha_norm&#45;&gt;layer_1_mha_q -->
<g id="edge67" class="edge">
<title>layer_1_mha_norm&#45;&gt;layer_1_mha_q</title>
<path fill="none" stroke="black" d="M9236.84,-7015.66C9175.76,-7004.9 9104.58,-6992.37 9042.48,-6981.43"/>
<polygon fill="black" stroke="black" points="9043.05,-6977.98 9032.59,-6979.69 9041.83,-6984.87 9043.05,-6977.98"/>
</g>
<!-- layer_1_mha_k -->
<g id="node5" class="node">
<title>layer_1_mha_k</title>
<polygon fill="lightblue" stroke="black" points="9372.22,-6979.67 9061.22,-6979.67 9061.22,-6926.67 9372.22,-6926.67 9372.22,-6979.67"/>
<text text-anchor="middle" x="9216.72" y="-6964.47" font-family="Times,serif" font-size="14.00">MHA K Proj 1</text>
<text text-anchor="middle" x="9216.72" y="-6949.47" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9216.72" y="-6934.47" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_1_mha_norm&#45;&gt;layer_1_mha_k -->
<g id="edge68" class="edge">
<title>layer_1_mha_norm&#45;&gt;layer_1_mha_k</title>
<path fill="none" stroke="black" d="M9333.1,-7015.54C9314.64,-7005.81 9293.43,-6994.62 9274.22,-6984.5"/>
<polygon fill="black" stroke="black" points="9275.75,-6981.34 9265.27,-6979.77 9272.48,-6987.53 9275.75,-6981.34"/>
</g>
<!-- layer_1_mha_v -->
<g id="node6" class="node">
<title>layer_1_mha_v</title>
<polygon fill="lightblue" stroke="black" points="9701.22,-6979.67 9390.22,-6979.67 9390.22,-6926.67 9701.22,-6926.67 9701.22,-6979.67"/>
<text text-anchor="middle" x="9545.72" y="-6964.47" font-family="Times,serif" font-size="14.00">MHA V Proj 1</text>
<text text-anchor="middle" x="9545.72" y="-6949.47" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9545.72" y="-6934.47" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_1_mha_norm&#45;&gt;layer_1_mha_v -->
<g id="edge69" class="edge">
<title>layer_1_mha_norm&#45;&gt;layer_1_mha_v</title>
<path fill="none" stroke="black" d="M9430.03,-7015.54C9448.39,-7005.81 9469.46,-6994.62 9488.56,-6984.5"/>
<polygon fill="black" stroke="black" points="9490.27,-6987.55 9497.46,-6979.77 9486.99,-6981.37 9490.27,-6987.55"/>
</g>
<!-- layer_1_mha_attn -->
<g id="node7" class="node">
<title>layer_1_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="9549.72,-6890.67 9187.72,-6890.67 9187.72,-6837.67 9549.72,-6837.67 9549.72,-6890.67"/>
<text text-anchor="middle" x="9368.72" y="-6875.47" font-family="Times,serif" font-size="14.00">MHA 1</text>
<text text-anchor="middle" x="9368.72" y="-6860.47" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, heads=16, dim=512]</text>
<text text-anchor="middle" x="9368.72" y="-6845.47" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_1_mha_q&#45;&gt;layer_1_mha_attn -->
<g id="edge70" class="edge">
<title>layer_1_mha_q&#45;&gt;layer_1_mha_attn</title>
<path fill="none" stroke="black" d="M9028.78,-6926.66C9088.13,-6915.92 9157.28,-6903.42 9217.65,-6892.5"/>
<polygon fill="black" stroke="black" points="9218.44,-6895.91 9227.65,-6890.69 9217.19,-6889.02 9218.44,-6895.91"/>
</g>
<!-- layer_1_mha_k&#45;&gt;layer_1_mha_attn -->
<g id="edge71" class="edge">
<title>layer_1_mha_k&#45;&gt;layer_1_mha_attn</title>
<path fill="none" stroke="black" d="M9261.5,-6926.54C9278.28,-6916.94 9297.51,-6905.93 9315.02,-6895.91"/>
<polygon fill="black" stroke="black" points="9317.05,-6898.78 9323.99,-6890.77 9313.57,-6892.7 9317.05,-6898.78"/>
</g>
<!-- layer_1_mha_v&#45;&gt;layer_1_mha_attn -->
<g id="edge72" class="edge">
<title>layer_1_mha_v&#45;&gt;layer_1_mha_attn</title>
<path fill="none" stroke="black" d="M9493.57,-6926.54C9473.58,-6916.72 9450.6,-6905.42 9429.85,-6895.22"/>
<polygon fill="black" stroke="black" points="9431.32,-6892.04 9420.8,-6890.77 9428.23,-6898.32 9431.32,-6892.04"/>
</g>
<!-- layer_1_mha_o -->
<g id="node8" class="node">
<title>layer_1_mha_o</title>
<polygon fill="lightblue" stroke="black" points="9689.22,-6801.67 9378.22,-6801.67 9378.22,-6748.67 9689.22,-6748.67 9689.22,-6801.67"/>
<text text-anchor="middle" x="9533.72" y="-6786.47" font-family="Times,serif" font-size="14.00">MHA O Proj 1</text>
<text text-anchor="middle" x="9533.72" y="-6771.47" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9533.72" y="-6756.47" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_1_mha_attn&#45;&gt;layer_1_mha_o -->
<g id="edge73" class="edge">
<title>layer_1_mha_attn&#45;&gt;layer_1_mha_o</title>
<path fill="none" stroke="black" d="M9417.33,-6837.54C9435.79,-6827.81 9457,-6816.62 9476.21,-6806.5"/>
<polygon fill="black" stroke="black" points="9477.95,-6809.53 9485.17,-6801.77 9474.69,-6803.34 9477.95,-6809.53"/>
</g>
<!-- layer_1_mha_o&#45;&gt;layer_1_mha_res -->
<g id="edge74" class="edge">
<title>layer_1_mha_o&#45;&gt;layer_1_mha_res</title>
<path fill="none" stroke="black" d="M9560.82,-6748.54C9570.28,-6739.59 9581.03,-6729.43 9591.03,-6719.98"/>
<polygon fill="black" stroke="black" points="9593.63,-6722.34 9598.49,-6712.92 9588.82,-6717.25 9593.63,-6722.34"/>
</g>
<!-- layer_1_exp_norm -->
<g id="node10" class="node">
<title>layer_1_exp_norm</title>
<polygon fill="lightcoral" stroke="black" points="7185.22,-6623.67 6874.22,-6623.67 6874.22,-6570.67 7185.22,-6570.67 7185.22,-6623.67"/>
<text text-anchor="middle" x="7029.72" y="-6608.47" font-family="Times,serif" font-size="14.00">Expert Norm 1</text>
<text text-anchor="middle" x="7029.72" y="-6593.47" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="7029.72" y="-6578.47" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_1_mha_res&#45;&gt;layer_1_exp_norm -->
<g id="edge76" class="edge">
<title>layer_1_mha_res&#45;&gt;layer_1_exp_norm</title>
<path fill="none" stroke="black" d="M9470.14,-6679.96C9011.49,-6664.59 7667.45,-6619.55 7195.7,-6603.74"/>
<polygon fill="black" stroke="black" points="7195.51,-6600.23 7185.4,-6603.39 7195.28,-6607.22 7195.51,-6600.23"/>
</g>
<!-- layer_1_exp_res -->
<g id="node78" class="node">
<title>layer_1_exp_res</title>
<polygon fill="lightyellow" stroke="black" points="9612.22,-5593.67 9301.22,-5593.67 9301.22,-5540.67 9612.22,-5540.67 9612.22,-5593.67"/>
<text text-anchor="middle" x="9456.72" y="-5578.47" font-family="Times,serif" font-size="14.00">Expert Residual 1</text>
<text text-anchor="middle" x="9456.72" y="-5563.47" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9456.72" y="-5548.47" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_1_mha_res&#45;&gt;layer_1_exp_res -->
<g id="edge97" class="edge">
<title>layer_1_mha_res&#45;&gt;layer_1_exp_res</title>
<path fill="none" stroke="black" d="M9781.36,-6681.23C10341.64,-6666.03 12222.72,-6605.84 12222.72,-6482.67 12222.72,-6482.67 12222.72,-6482.67 12222.72,-5823.67 12222.72,-5799.07 12223.35,-5786.51 12203.72,-5771.67 11997.78,-5616.02 10184.99,-5578.17 9622.46,-5570.13"/>
<polygon fill="black" stroke="black" points="9622.29,-5566.63 9612.24,-5569.98 9622.19,-5573.63 9622.29,-5566.63"/>
</g>
<!-- layer_1_global_gate -->
<g id="node11" class="node">
<title>layer_1_global_gate</title>
<polygon fill="yellow" stroke="black" points="6690.72,-6534.67 6379.72,-6481.67 6690.72,-6428.67 7001.72,-6481.67 6690.72,-6534.67"/>
<text text-anchor="middle" x="6690.72" y="-6492.97" font-family="Times,serif" font-size="14.00">Global Gate 1</text>
<text text-anchor="middle" x="6690.72" y="-6477.97" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="6690.72" y="-6462.97" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_1_exp_norm&#45;&gt;layer_1_global_gate -->
<g id="edge77" class="edge">
<title>layer_1_exp_norm&#45;&gt;layer_1_global_gate</title>
<path fill="none" stroke="black" d="M6953.22,-6570.56C6909.09,-6555.79 6852.8,-6536.94 6803.66,-6520.49"/>
<polygon fill="black" stroke="black" points="6804.53,-6517.09 6793.93,-6517.23 6802.31,-6523.73 6804.53,-6517.09"/>
</g>
<!-- layer_1_token_dist -->
<g id="node12" class="node">
<title>layer_1_token_dist</title>
<polygon fill="orange" stroke="black" points="7013.08,-6392.67 6500.27,-6392.67 6368.36,-6286.67 6881.16,-6286.67 7013.08,-6392.67"/>
<text text-anchor="middle" x="6690.72" y="-6350.97" font-family="Times,serif" font-size="14.00">Token Distribution 1</text>
<text text-anchor="middle" x="6690.72" y="-6335.97" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="6690.72" y="-6320.97" font-family="Times,serif" font-size="14.00">GPU: all to 0&#45;15</text>
</g>
<!-- layer_1_exp_norm&#45;&gt;layer_1_token_dist -->
<g id="edge79" class="edge">
<title>layer_1_exp_norm&#45;&gt;layer_1_token_dist</title>
<path fill="none" stroke="black" d="M7034.84,-6570.63C7040.49,-6534.51 7044.77,-6468.48 7010.72,-6428.67 7000.5,-6416.73 6980.11,-6405.88 6954.34,-6396.2"/>
<polygon fill="black" stroke="black" points="6955.21,-6392.8 6944.61,-6392.69 6952.83,-6399.38 6955.21,-6392.8"/>
</g>
<!-- layer_1_global_gate&#45;&gt;layer_1_token_dist -->
<g id="edge78" class="edge">
<title>layer_1_global_gate&#45;&gt;layer_1_token_dist</title>
<path fill="none" stroke="black" d="M6690.72,-6428.54C6690.72,-6420.25 6690.72,-6411.6 6690.72,-6403.1"/>
<polygon fill="black" stroke="black" points="6694.22,-6402.85 6690.72,-6392.85 6687.22,-6402.85 6694.22,-6402.85"/>
</g>
<!-- layer_1_expert0_recv -->
<g id="node13" class="node">
<title>layer_1_expert0_recv</title>
<polygon fill="lightgreen" stroke="black" points="1169.65,-6250.67 598.67,-6250.67 451.78,-6144.67 1022.77,-6144.67 1169.65,-6250.67"/>
<text text-anchor="middle" x="810.72" y="-6208.97" font-family="Times,serif" font-size="14.00">Expert 0 Recv</text>
<text text-anchor="middle" x="810.72" y="-6193.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="810.72" y="-6178.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_1_token_dist&#45;&gt;layer_1_expert0_recv -->
<g id="edge1" class="edge">
<title>layer_1_token_dist&#45;&gt;layer_1_expert0_recv</title>
<path fill="none" stroke="black" d="M6433.15,-6338.83C5492,-6338.74 2239.39,-6332.45 1179.08,-6250.75"/>
<polygon fill="black" stroke="black" points="1179.26,-6247.26 1169.02,-6249.97 1178.72,-6254.23 1179.26,-6247.26"/>
</g>
<!-- layer_1_expert1_recv -->
<g id="node17" class="node">
<title>layer_1_expert1_recv</title>
<polygon fill="lightgreen" stroke="black" points="1904.65,-6250.67 1333.67,-6250.67 1186.78,-6144.67 1757.77,-6144.67 1904.65,-6250.67"/>
<text text-anchor="middle" x="1545.72" y="-6208.97" font-family="Times,serif" font-size="14.00">Expert 1 Recv</text>
<text text-anchor="middle" x="1545.72" y="-6193.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="1545.72" y="-6178.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_1_token_dist&#45;&gt;layer_1_expert1_recv -->
<g id="edge5" class="edge">
<title>layer_1_token_dist&#45;&gt;layer_1_expert1_recv</title>
<path fill="none" stroke="black" d="M6432.22,-6338.09C5574.07,-6335.48 2823.22,-6321.72 1914.3,-6250.77"/>
<polygon fill="black" stroke="black" points="1914.27,-6247.26 1904.02,-6249.96 1913.72,-6254.23 1914.27,-6247.26"/>
</g>
<!-- layer_1_expert2_recv -->
<g id="node21" class="node">
<title>layer_1_expert2_recv</title>
<polygon fill="lightgreen" stroke="black" points="2639.65,-6250.67 2068.67,-6250.67 1921.78,-6144.67 2492.77,-6144.67 2639.65,-6250.67"/>
<text text-anchor="middle" x="2280.72" y="-6208.97" font-family="Times,serif" font-size="14.00">Expert 2 Recv</text>
<text text-anchor="middle" x="2280.72" y="-6193.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2280.72" y="-6178.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_1_token_dist&#45;&gt;layer_1_expert2_recv -->
<g id="edge9" class="edge">
<title>layer_1_token_dist&#45;&gt;layer_1_expert2_recv</title>
<path fill="none" stroke="black" d="M6431.04,-6337.06C5662.68,-6331.66 3407.33,-6311.05 2649.25,-6250.77"/>
<polygon fill="black" stroke="black" points="2649.27,-6247.26 2639.02,-6249.95 2648.71,-6254.24 2649.27,-6247.26"/>
</g>
<!-- layer_1_expert3_recv -->
<g id="node25" class="node">
<title>layer_1_expert3_recv</title>
<polygon fill="lightgreen" stroke="black" points="3374.65,-6250.67 2803.67,-6250.67 2656.78,-6144.67 3227.77,-6144.67 3374.65,-6250.67"/>
<text text-anchor="middle" x="3015.72" y="-6208.97" font-family="Times,serif" font-size="14.00">Expert 3 Recv</text>
<text text-anchor="middle" x="3015.72" y="-6193.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="3015.72" y="-6178.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_1_token_dist&#45;&gt;layer_1_expert3_recv -->
<g id="edge13" class="edge">
<title>layer_1_token_dist&#45;&gt;layer_1_expert3_recv</title>
<path fill="none" stroke="black" d="M6428.92,-6335.57C5758.84,-6327.02 3992.38,-6300.43 3384.22,-6250.77"/>
<polygon fill="black" stroke="black" points="3384.28,-6247.26 3374.02,-6249.92 3383.7,-6254.24 3384.28,-6247.26"/>
</g>
<!-- layer_1_expert4_recv -->
<g id="node29" class="node">
<title>layer_1_expert4_recv</title>
<polygon fill="lightgreen" stroke="black" points="4109.65,-6250.67 3538.67,-6250.67 3391.78,-6144.67 3962.77,-6144.67 4109.65,-6250.67"/>
<text text-anchor="middle" x="3750.72" y="-6208.97" font-family="Times,serif" font-size="14.00">Expert 4 Recv</text>
<text text-anchor="middle" x="3750.72" y="-6193.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="3750.72" y="-6178.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_1_token_dist&#45;&gt;layer_1_expert4_recv -->
<g id="edge17" class="edge">
<title>layer_1_token_dist&#45;&gt;layer_1_expert4_recv</title>
<path fill="none" stroke="black" d="M6433.16,-6338.93C5971.07,-6337.38 4970.72,-6324.89 4118.56,-6250.72"/>
<polygon fill="black" stroke="black" points="4118.81,-6247.23 4108.54,-6249.85 4118.2,-6254.21 4118.81,-6247.23"/>
</g>
<!-- layer_1_expert5_recv -->
<g id="node33" class="node">
<title>layer_1_expert5_recv</title>
<polygon fill="lightgreen" stroke="black" points="4844.65,-6250.67 4273.67,-6250.67 4126.78,-6144.67 4697.77,-6144.67 4844.65,-6250.67"/>
<text text-anchor="middle" x="4485.72" y="-6208.97" font-family="Times,serif" font-size="14.00">Expert 5 Recv</text>
<text text-anchor="middle" x="4485.72" y="-6193.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="4485.72" y="-6178.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_1_token_dist&#45;&gt;layer_1_expert5_recv -->
<g id="edge21" class="edge">
<title>layer_1_token_dist&#45;&gt;layer_1_expert5_recv</title>
<path fill="none" stroke="black" d="M6426.89,-6333.74C6071.53,-6325.34 5419.38,-6303.79 4853.54,-6250.73"/>
<polygon fill="black" stroke="black" points="4853.83,-6247.24 4843.55,-6249.79 4853.18,-6254.21 4853.83,-6247.24"/>
</g>
<!-- layer_1_expert6_recv -->
<g id="node37" class="node">
<title>layer_1_expert6_recv</title>
<polygon fill="lightgreen" stroke="black" points="5579.65,-6250.67 5008.67,-6250.67 4861.78,-6144.67 5432.77,-6144.67 5579.65,-6250.67"/>
<text text-anchor="middle" x="5220.72" y="-6208.97" font-family="Times,serif" font-size="14.00">Expert 6 Recv</text>
<text text-anchor="middle" x="5220.72" y="-6193.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5220.72" y="-6178.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_1_token_dist&#45;&gt;layer_1_expert6_recv -->
<g id="edge25" class="edge">
<title>layer_1_token_dist&#45;&gt;layer_1_expert6_recv</title>
<path fill="none" stroke="black" d="M6411.19,-6321.11C6190.57,-6306.12 5874.82,-6282.18 5588.73,-6250.77"/>
<polygon fill="black" stroke="black" points="5588.89,-6247.27 5578.56,-6249.65 5588.12,-6254.22 5588.89,-6247.27"/>
</g>
<!-- layer_1_expert7_recv -->
<g id="node41" class="node">
<title>layer_1_expert7_recv</title>
<polygon fill="lightgreen" stroke="black" points="6314.65,-6250.67 5743.67,-6250.67 5596.78,-6144.67 6167.77,-6144.67 6314.65,-6250.67"/>
<text text-anchor="middle" x="5955.72" y="-6208.97" font-family="Times,serif" font-size="14.00">Expert 7 Recv</text>
<text text-anchor="middle" x="5955.72" y="-6193.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5955.72" y="-6178.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_1_token_dist&#45;&gt;layer_1_expert7_recv -->
<g id="edge29" class="edge">
<title>layer_1_token_dist&#45;&gt;layer_1_expert7_recv</title>
<path fill="none" stroke="black" d="M6417.55,-6286.64C6359.26,-6275.54 6297.58,-6263.79 6238.92,-6252.62"/>
<polygon fill="black" stroke="black" points="6239.25,-6249.12 6228.78,-6250.68 6237.94,-6255.99 6239.25,-6249.12"/>
</g>
<!-- layer_1_expert8_recv -->
<g id="node45" class="node">
<title>layer_1_expert8_recv</title>
<polygon fill="lightgreen" stroke="black" points="7049.65,-6250.67 6478.67,-6250.67 6331.78,-6144.67 6902.77,-6144.67 7049.65,-6250.67"/>
<text text-anchor="middle" x="6690.72" y="-6208.97" font-family="Times,serif" font-size="14.00">Expert 8 Recv</text>
<text text-anchor="middle" x="6690.72" y="-6193.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="6690.72" y="-6178.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_1_token_dist&#45;&gt;layer_1_expert8_recv -->
<g id="edge33" class="edge">
<title>layer_1_token_dist&#45;&gt;layer_1_expert8_recv</title>
<path fill="none" stroke="black" d="M6690.72,-6286.54C6690.72,-6278.25 6690.72,-6269.6 6690.72,-6261.1"/>
<polygon fill="black" stroke="black" points="6694.22,-6260.85 6690.72,-6250.85 6687.22,-6260.85 6694.22,-6260.85"/>
</g>
<!-- layer_1_expert9_recv -->
<g id="node49" class="node">
<title>layer_1_expert9_recv</title>
<polygon fill="lightgreen" stroke="black" points="7784.65,-6250.67 7213.67,-6250.67 7066.78,-6144.67 7637.77,-6144.67 7784.65,-6250.67"/>
<text text-anchor="middle" x="7425.72" y="-6208.97" font-family="Times,serif" font-size="14.00">Expert 9 Recv</text>
<text text-anchor="middle" x="7425.72" y="-6193.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="7425.72" y="-6178.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_1_token_dist&#45;&gt;layer_1_expert9_recv -->
<g id="edge37" class="edge">
<title>layer_1_token_dist&#45;&gt;layer_1_expert9_recv</title>
<path fill="none" stroke="black" d="M6897.41,-6299.3C6988.66,-6281.92 7096.37,-6261.41 7190.66,-6243.45"/>
<polygon fill="black" stroke="black" points="7191.45,-6246.86 7200.62,-6241.55 7190.14,-6239.98 7191.45,-6246.86"/>
</g>
<!-- layer_1_expert10_recv -->
<g id="node53" class="node">
<title>layer_1_expert10_recv</title>
<polygon fill="lightgreen" stroke="black" points="8519.65,-6250.67 7948.67,-6250.67 7801.78,-6144.67 8372.77,-6144.67 8519.65,-6250.67"/>
<text text-anchor="middle" x="8160.72" y="-6208.97" font-family="Times,serif" font-size="14.00">Expert 10 Recv</text>
<text text-anchor="middle" x="8160.72" y="-6193.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8160.72" y="-6178.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_1_token_dist&#45;&gt;layer_1_expert10_recv -->
<g id="edge41" class="edge">
<title>layer_1_token_dist&#45;&gt;layer_1_expert10_recv</title>
<path fill="none" stroke="black" d="M6927.79,-6323.97C7151.43,-6309.1 7495.86,-6283.63 7793.72,-6250.67 7833.16,-6246.31 7874.89,-6241.03 7915.53,-6235.53"/>
<polygon fill="black" stroke="black" points="7916.12,-6238.98 7925.56,-6234.17 7915.18,-6232.05 7916.12,-6238.98"/>
</g>
<!-- layer_1_expert11_recv -->
<g id="node57" class="node">
<title>layer_1_expert11_recv</title>
<polygon fill="lightgreen" stroke="black" points="9254.65,-6250.67 8683.67,-6250.67 8536.78,-6144.67 9107.77,-6144.67 9254.65,-6250.67"/>
<text text-anchor="middle" x="8895.72" y="-6208.97" font-family="Times,serif" font-size="14.00">Expert 11 Recv</text>
<text text-anchor="middle" x="8895.72" y="-6193.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8895.72" y="-6178.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_1_token_dist&#45;&gt;layer_1_expert11_recv -->
<g id="edge45" class="edge">
<title>layer_1_token_dist&#45;&gt;layer_1_expert11_recv</title>
<path fill="none" stroke="black" d="M6940.22,-6334.07C7294.2,-6325.88 7962.2,-6304.25 8528.72,-6250.67 8568.52,-6246.91 8610.62,-6241.91 8651.55,-6236.49"/>
<polygon fill="black" stroke="black" points="8652.2,-6239.94 8661.65,-6235.15 8651.28,-6233 8652.2,-6239.94"/>
</g>
<!-- layer_1_expert12_recv -->
<g id="node61" class="node">
<title>layer_1_expert12_recv</title>
<polygon fill="lightgreen" stroke="black" points="9989.65,-6250.67 9418.67,-6250.67 9271.78,-6144.67 9842.77,-6144.67 9989.65,-6250.67"/>
<text text-anchor="middle" x="9630.72" y="-6208.97" font-family="Times,serif" font-size="14.00">Expert 12 Recv</text>
<text text-anchor="middle" x="9630.72" y="-6193.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="9630.72" y="-6178.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_1_token_dist&#45;&gt;layer_1_expert12_recv -->
<g id="edge49" class="edge">
<title>layer_1_token_dist&#45;&gt;layer_1_expert12_recv</title>
<path fill="none" stroke="black" d="M6946.45,-6338.94C7409.53,-6337.41 8417.46,-6324.89 9263.72,-6250.67 9303.69,-6247.17 9345.97,-6242.28 9387.05,-6236.9"/>
<polygon fill="black" stroke="black" points="9387.73,-6240.34 9397.19,-6235.56 9386.82,-6233.4 9387.73,-6240.34"/>
</g>
<!-- layer_1_expert13_recv -->
<g id="node65" class="node">
<title>layer_1_expert13_recv</title>
<polygon fill="lightgreen" stroke="black" points="10724.65,-6250.67 10153.67,-6250.67 10006.78,-6144.67 10577.77,-6144.67 10724.65,-6250.67"/>
<text text-anchor="middle" x="10365.72" y="-6208.97" font-family="Times,serif" font-size="14.00">Expert 13 Recv</text>
<text text-anchor="middle" x="10365.72" y="-6193.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10365.72" y="-6178.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_1_token_dist&#45;&gt;layer_1_expert13_recv -->
<g id="edge53" class="edge">
<title>layer_1_token_dist&#45;&gt;layer_1_expert13_recv</title>
<path fill="none" stroke="black" d="M6942.47,-6335.7C7608.49,-6327.24 9406.09,-6300.38 9998.72,-6250.67 10038.85,-6247.31 10081.3,-6242.48 10122.53,-6237.1"/>
<polygon fill="black" stroke="black" points="10123.25,-6240.54 10132.7,-6235.76 10122.33,-6233.6 10123.25,-6240.54"/>
</g>
<!-- layer_1_expert14_recv -->
<g id="node69" class="node">
<title>layer_1_expert14_recv</title>
<polygon fill="lightgreen" stroke="black" points="11459.65,-6250.67 10888.67,-6250.67 10741.78,-6144.67 11312.77,-6144.67 11459.65,-6250.67"/>
<text text-anchor="middle" x="11100.72" y="-6208.97" font-family="Times,serif" font-size="14.00">Expert 14 Recv</text>
<text text-anchor="middle" x="11100.72" y="-6193.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="11100.72" y="-6178.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_1_token_dist&#45;&gt;layer_1_expert14_recv -->
<g id="edge57" class="edge">
<title>layer_1_token_dist&#45;&gt;layer_1_expert14_recv</title>
<path fill="none" stroke="black" d="M6944.26,-6337.11C7710.13,-6331.75 9992.63,-6311.03 10733.72,-6250.67 10773.86,-6247.4 10816.31,-6242.63 10857.54,-6237.27"/>
<polygon fill="black" stroke="black" points="10858.26,-6240.71 10867.72,-6235.93 10857.35,-6233.77 10858.26,-6240.71"/>
</g>
<!-- layer_1_expert15_recv -->
<g id="node73" class="node">
<title>layer_1_expert15_recv</title>
<polygon fill="lightgreen" stroke="black" points="12194.65,-6250.67 11623.67,-6250.67 11476.78,-6144.67 12047.77,-6144.67 12194.65,-6250.67"/>
<text text-anchor="middle" x="11835.72" y="-6208.97" font-family="Times,serif" font-size="14.00">Expert 15 Recv</text>
<text text-anchor="middle" x="11835.72" y="-6193.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="11835.72" y="-6178.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_1_token_dist&#45;&gt;layer_1_expert15_recv -->
<g id="edge61" class="edge">
<title>layer_1_token_dist&#45;&gt;layer_1_expert15_recv</title>
<path fill="none" stroke="black" d="M6945.47,-6338.1C7802.57,-6335.51 10577.85,-6321.72 11468.72,-6250.67 11509.1,-6247.45 11551.81,-6242.67 11593.27,-6237.29"/>
<polygon fill="black" stroke="black" points="11593.76,-6240.76 11603.22,-6235.99 11592.85,-6233.82 11593.76,-6240.76"/>
</g>
<!-- layer_1_expert0_gate -->
<g id="node14" class="node">
<title>layer_1_expert0_gate</title>
<polygon fill="yellow" stroke="black" points="810.72,-6108.67 464.72,-6055.67 810.72,-6002.67 1156.72,-6055.67 810.72,-6108.67"/>
<text text-anchor="middle" x="810.72" y="-6066.97" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="810.72" y="-6051.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="810.72" y="-6036.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_1_expert0_recv&#45;&gt;layer_1_expert0_gate -->
<g id="edge2" class="edge">
<title>layer_1_expert0_recv&#45;&gt;layer_1_expert0_gate</title>
<path fill="none" stroke="black" d="M810.72,-6144.54C810.72,-6136.25 810.72,-6127.6 810.72,-6119.1"/>
<polygon fill="black" stroke="black" points="814.22,-6118.85 810.72,-6108.85 807.22,-6118.85 814.22,-6118.85"/>
</g>
<!-- layer_1_expert0 -->
<g id="node15" class="node">
<title>layer_1_expert0</title>
<polygon fill="lightpink" stroke="black" points="983.72,-5966.67 637.72,-5966.67 637.72,-5913.67 983.72,-5913.67 983.72,-5966.67"/>
<text text-anchor="middle" x="810.72" y="-5951.47" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="810.72" y="-5936.47" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="810.72" y="-5921.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_1_expert0_gate&#45;&gt;layer_1_expert0 -->
<g id="edge3" class="edge">
<title>layer_1_expert0_gate&#45;&gt;layer_1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M810.72,-6002.57C810.72,-5993.9 810.72,-5985.09 810.72,-5976.94"/>
<polygon fill="black" stroke="black" points="814.22,-5976.69 810.72,-5966.69 807.22,-5976.69 814.22,-5976.69"/>
</g>
<!-- layer_1_expert0_send -->
<g id="node16" class="node">
<title>layer_1_expert0_send</title>
<polygon fill="lightgreen" stroke="black" points="1169.65,-5877.67 598.67,-5877.67 451.78,-5771.67 1022.77,-5771.67 1169.65,-5877.67"/>
<text text-anchor="middle" x="810.72" y="-5835.97" font-family="Times,serif" font-size="14.00">Expert 0 Send</text>
<text text-anchor="middle" x="810.72" y="-5820.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="810.72" y="-5805.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_1_expert0&#45;&gt;layer_1_expert0_send -->
<g id="edge4" class="edge">
<title>layer_1_expert0&#45;&gt;layer_1_expert0_send</title>
<path fill="none" stroke="black" d="M810.72,-5913.42C810.72,-5905.72 810.72,-5896.92 810.72,-5887.94"/>
<polygon fill="black" stroke="black" points="814.22,-5887.77 810.72,-5877.77 807.22,-5887.77 814.22,-5887.77"/>
</g>
<!-- layer_1_exp_agg -->
<g id="node77" class="node">
<title>layer_1_exp_agg</title>
<polygon fill="orange" stroke="black" points="7013.08,-5735.67 6500.27,-5735.67 6368.36,-5629.67 6881.16,-5629.67 7013.08,-5735.67"/>
<text text-anchor="middle" x="6690.72" y="-5693.97" font-family="Times,serif" font-size="14.00">Expert Aggregation 1</text>
<text text-anchor="middle" x="6690.72" y="-5678.97" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="6690.72" y="-5663.97" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_1_expert0_send&#45;&gt;layer_1_exp_agg -->
<g id="edge80" class="edge">
<title>layer_1_expert0_send&#45;&gt;layer_1_exp_agg</title>
<path fill="none" stroke="black" d="M1043.21,-5786.27C1087.75,-5780.37 1134.09,-5775.1 1177.72,-5771.67 2215.71,-5690.17 5470.54,-5683.64 6425.09,-5683.52"/>
<polygon fill="black" stroke="black" points="6425.18,-5687.02 6435.18,-5683.52 6425.18,-5680.02 6425.18,-5687.02"/>
</g>
<!-- layer_1_expert1_gate -->
<g id="node18" class="node">
<title>layer_1_expert1_gate</title>
<polygon fill="yellow" stroke="black" points="1545.72,-6108.67 1199.72,-6055.67 1545.72,-6002.67 1891.72,-6055.67 1545.72,-6108.67"/>
<text text-anchor="middle" x="1545.72" y="-6066.97" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="1545.72" y="-6051.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="1545.72" y="-6036.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_1_expert1_recv&#45;&gt;layer_1_expert1_gate -->
<g id="edge6" class="edge">
<title>layer_1_expert1_recv&#45;&gt;layer_1_expert1_gate</title>
<path fill="none" stroke="black" d="M1545.72,-6144.54C1545.72,-6136.25 1545.72,-6127.6 1545.72,-6119.1"/>
<polygon fill="black" stroke="black" points="1549.22,-6118.85 1545.72,-6108.85 1542.22,-6118.85 1549.22,-6118.85"/>
</g>
<!-- layer_1_expert1 -->
<g id="node19" class="node">
<title>layer_1_expert1</title>
<polygon fill="lightpink" stroke="black" points="1718.72,-5966.67 1372.72,-5966.67 1372.72,-5913.67 1718.72,-5913.67 1718.72,-5966.67"/>
<text text-anchor="middle" x="1545.72" y="-5951.47" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1545.72" y="-5936.47" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="1545.72" y="-5921.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_1_expert1_gate&#45;&gt;layer_1_expert1 -->
<g id="edge7" class="edge">
<title>layer_1_expert1_gate&#45;&gt;layer_1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1545.72,-6002.57C1545.72,-5993.9 1545.72,-5985.09 1545.72,-5976.94"/>
<polygon fill="black" stroke="black" points="1549.22,-5976.69 1545.72,-5966.69 1542.22,-5976.69 1549.22,-5976.69"/>
</g>
<!-- layer_1_expert1_send -->
<g id="node20" class="node">
<title>layer_1_expert1_send</title>
<polygon fill="lightgreen" stroke="black" points="1904.65,-5877.67 1333.67,-5877.67 1186.78,-5771.67 1757.77,-5771.67 1904.65,-5877.67"/>
<text text-anchor="middle" x="1545.72" y="-5835.97" font-family="Times,serif" font-size="14.00">Expert 1 Send</text>
<text text-anchor="middle" x="1545.72" y="-5820.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="1545.72" y="-5805.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_1_expert1&#45;&gt;layer_1_expert1_send -->
<g id="edge8" class="edge">
<title>layer_1_expert1&#45;&gt;layer_1_expert1_send</title>
<path fill="none" stroke="black" d="M1545.72,-5913.42C1545.72,-5905.72 1545.72,-5896.92 1545.72,-5887.94"/>
<polygon fill="black" stroke="black" points="1549.22,-5887.77 1545.72,-5877.77 1542.22,-5887.77 1549.22,-5887.77"/>
</g>
<!-- layer_1_expert1_send&#45;&gt;layer_1_exp_agg -->
<g id="edge81" class="edge">
<title>layer_1_expert1_send&#45;&gt;layer_1_exp_agg</title>
<path fill="none" stroke="black" d="M1778.22,-5786.36C1822.75,-5780.45 1869.1,-5775.15 1912.72,-5771.67 2800.1,-5700.9 5557.21,-5686.94 6425.83,-5684.28"/>
<polygon fill="black" stroke="black" points="6425.97,-5687.78 6435.96,-5684.25 6425.95,-5680.78 6425.97,-5687.78"/>
</g>
<!-- layer_1_expert2_gate -->
<g id="node22" class="node">
<title>layer_1_expert2_gate</title>
<polygon fill="yellow" stroke="black" points="2280.72,-6108.67 1934.72,-6055.67 2280.72,-6002.67 2626.72,-6055.67 2280.72,-6108.67"/>
<text text-anchor="middle" x="2280.72" y="-6066.97" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="2280.72" y="-6051.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2280.72" y="-6036.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_1_expert2_recv&#45;&gt;layer_1_expert2_gate -->
<g id="edge10" class="edge">
<title>layer_1_expert2_recv&#45;&gt;layer_1_expert2_gate</title>
<path fill="none" stroke="black" d="M2280.72,-6144.54C2280.72,-6136.25 2280.72,-6127.6 2280.72,-6119.1"/>
<polygon fill="black" stroke="black" points="2284.22,-6118.85 2280.72,-6108.85 2277.22,-6118.85 2284.22,-6118.85"/>
</g>
<!-- layer_1_expert2 -->
<g id="node23" class="node">
<title>layer_1_expert2</title>
<polygon fill="lightpink" stroke="black" points="2453.72,-5966.67 2107.72,-5966.67 2107.72,-5913.67 2453.72,-5913.67 2453.72,-5966.67"/>
<text text-anchor="middle" x="2280.72" y="-5951.47" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2280.72" y="-5936.47" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2280.72" y="-5921.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_1_expert2_gate&#45;&gt;layer_1_expert2 -->
<g id="edge11" class="edge">
<title>layer_1_expert2_gate&#45;&gt;layer_1_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2280.72,-6002.57C2280.72,-5993.9 2280.72,-5985.09 2280.72,-5976.94"/>
<polygon fill="black" stroke="black" points="2284.22,-5976.69 2280.72,-5966.69 2277.22,-5976.69 2284.22,-5976.69"/>
</g>
<!-- layer_1_expert2_send -->
<g id="node24" class="node">
<title>layer_1_expert2_send</title>
<polygon fill="lightgreen" stroke="black" points="2639.65,-5877.67 2068.67,-5877.67 1921.78,-5771.67 2492.77,-5771.67 2639.65,-5877.67"/>
<text text-anchor="middle" x="2280.72" y="-5835.97" font-family="Times,serif" font-size="14.00">Expert 2 Send</text>
<text text-anchor="middle" x="2280.72" y="-5820.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2280.72" y="-5805.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_1_expert2&#45;&gt;layer_1_expert2_send -->
<g id="edge12" class="edge">
<title>layer_1_expert2&#45;&gt;layer_1_expert2_send</title>
<path fill="none" stroke="black" d="M2280.72,-5913.42C2280.72,-5905.72 2280.72,-5896.92 2280.72,-5887.94"/>
<polygon fill="black" stroke="black" points="2284.22,-5887.77 2280.72,-5877.77 2277.22,-5887.77 2284.22,-5887.77"/>
</g>
<!-- layer_1_expert2_send&#45;&gt;layer_1_exp_agg -->
<g id="edge82" class="edge">
<title>layer_1_expert2_send&#45;&gt;layer_1_exp_agg</title>
<path fill="none" stroke="black" d="M2513.72,-5786.41C2558.1,-5780.52 2604.26,-5775.21 2647.72,-5771.67 3385.55,-5711.59 5651.27,-5690.78 6426.99,-5685.31"/>
<polygon fill="black" stroke="black" points="6427.2,-5688.81 6437.17,-5685.24 6427.15,-5681.81 6427.2,-5688.81"/>
</g>
<!-- layer_1_expert3_gate -->
<g id="node26" class="node">
<title>layer_1_expert3_gate</title>
<polygon fill="yellow" stroke="black" points="3015.72,-6108.67 2669.72,-6055.67 3015.72,-6002.67 3361.72,-6055.67 3015.72,-6108.67"/>
<text text-anchor="middle" x="3015.72" y="-6066.97" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="3015.72" y="-6051.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="3015.72" y="-6036.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_1_expert3_recv&#45;&gt;layer_1_expert3_gate -->
<g id="edge14" class="edge">
<title>layer_1_expert3_recv&#45;&gt;layer_1_expert3_gate</title>
<path fill="none" stroke="black" d="M3015.72,-6144.54C3015.72,-6136.25 3015.72,-6127.6 3015.72,-6119.1"/>
<polygon fill="black" stroke="black" points="3019.22,-6118.85 3015.72,-6108.85 3012.22,-6118.85 3019.22,-6118.85"/>
</g>
<!-- layer_1_expert3 -->
<g id="node27" class="node">
<title>layer_1_expert3</title>
<polygon fill="lightpink" stroke="black" points="3188.72,-5966.67 2842.72,-5966.67 2842.72,-5913.67 3188.72,-5913.67 3188.72,-5966.67"/>
<text text-anchor="middle" x="3015.72" y="-5951.47" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3015.72" y="-5936.47" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="3015.72" y="-5921.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_1_expert3_gate&#45;&gt;layer_1_expert3 -->
<g id="edge15" class="edge">
<title>layer_1_expert3_gate&#45;&gt;layer_1_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3015.72,-6002.57C3015.72,-5993.9 3015.72,-5985.09 3015.72,-5976.94"/>
<polygon fill="black" stroke="black" points="3019.22,-5976.69 3015.72,-5966.69 3012.22,-5976.69 3019.22,-5976.69"/>
</g>
<!-- layer_1_expert3_send -->
<g id="node28" class="node">
<title>layer_1_expert3_send</title>
<polygon fill="lightgreen" stroke="black" points="3374.65,-5877.67 2803.67,-5877.67 2656.78,-5771.67 3227.77,-5771.67 3374.65,-5877.67"/>
<text text-anchor="middle" x="3015.72" y="-5835.97" font-family="Times,serif" font-size="14.00">Expert 3 Send</text>
<text text-anchor="middle" x="3015.72" y="-5820.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="3015.72" y="-5805.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_1_expert3&#45;&gt;layer_1_expert3_send -->
<g id="edge16" class="edge">
<title>layer_1_expert3&#45;&gt;layer_1_expert3_send</title>
<path fill="none" stroke="black" d="M3015.72,-5913.42C3015.72,-5905.72 3015.72,-5896.92 3015.72,-5887.94"/>
<polygon fill="black" stroke="black" points="3019.22,-5887.77 3015.72,-5877.77 3012.22,-5887.77 3019.22,-5887.77"/>
</g>
<!-- layer_1_expert3_send&#45;&gt;layer_1_exp_agg -->
<g id="edge83" class="edge">
<title>layer_1_expert3_send&#45;&gt;layer_1_exp_agg</title>
<path fill="none" stroke="black" d="M3248.73,-5786.58C3293.12,-5780.67 3339.27,-5775.32 3382.72,-5771.67 3972.3,-5722.22 5754.54,-5695.38 6428.63,-5686.78"/>
<polygon fill="black" stroke="black" points="6429,-5690.27 6438.96,-5686.65 6428.91,-5683.27 6429,-5690.27"/>
</g>
<!-- layer_1_expert4_gate -->
<g id="node30" class="node">
<title>layer_1_expert4_gate</title>
<polygon fill="yellow" stroke="black" points="3750.72,-6108.67 3404.72,-6055.67 3750.72,-6002.67 4096.72,-6055.67 3750.72,-6108.67"/>
<text text-anchor="middle" x="3750.72" y="-6066.97" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="3750.72" y="-6051.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="3750.72" y="-6036.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_1_expert4_recv&#45;&gt;layer_1_expert4_gate -->
<g id="edge18" class="edge">
<title>layer_1_expert4_recv&#45;&gt;layer_1_expert4_gate</title>
<path fill="none" stroke="black" d="M3750.72,-6144.54C3750.72,-6136.25 3750.72,-6127.6 3750.72,-6119.1"/>
<polygon fill="black" stroke="black" points="3754.22,-6118.85 3750.72,-6108.85 3747.22,-6118.85 3754.22,-6118.85"/>
</g>
<!-- layer_1_expert4 -->
<g id="node31" class="node">
<title>layer_1_expert4</title>
<polygon fill="lightpink" stroke="black" points="3923.72,-5966.67 3577.72,-5966.67 3577.72,-5913.67 3923.72,-5913.67 3923.72,-5966.67"/>
<text text-anchor="middle" x="3750.72" y="-5951.47" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3750.72" y="-5936.47" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="3750.72" y="-5921.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_1_expert4_gate&#45;&gt;layer_1_expert4 -->
<g id="edge19" class="edge">
<title>layer_1_expert4_gate&#45;&gt;layer_1_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3750.72,-6002.57C3750.72,-5993.9 3750.72,-5985.09 3750.72,-5976.94"/>
<polygon fill="black" stroke="black" points="3754.22,-5976.69 3750.72,-5966.69 3747.22,-5976.69 3754.22,-5976.69"/>
</g>
<!-- layer_1_expert4_send -->
<g id="node32" class="node">
<title>layer_1_expert4_send</title>
<polygon fill="lightgreen" stroke="black" points="4109.65,-5877.67 3538.67,-5877.67 3391.78,-5771.67 3962.77,-5771.67 4109.65,-5877.67"/>
<text text-anchor="middle" x="3750.72" y="-5835.97" font-family="Times,serif" font-size="14.00">Expert 4 Send</text>
<text text-anchor="middle" x="3750.72" y="-5820.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="3750.72" y="-5805.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_1_expert4&#45;&gt;layer_1_expert4_send -->
<g id="edge20" class="edge">
<title>layer_1_expert4&#45;&gt;layer_1_expert4_send</title>
<path fill="none" stroke="black" d="M3750.72,-5913.42C3750.72,-5905.72 3750.72,-5896.92 3750.72,-5887.94"/>
<polygon fill="black" stroke="black" points="3754.22,-5887.77 3750.72,-5877.77 3747.22,-5887.77 3754.22,-5887.77"/>
</g>
<!-- layer_1_expert4_send&#45;&gt;layer_1_exp_agg -->
<g id="edge84" class="edge">
<title>layer_1_expert4_send&#45;&gt;layer_1_exp_agg</title>
<path fill="none" stroke="black" d="M3984.24,-5786.78C4028.48,-5780.88 4074.45,-5775.47 4117.72,-5771.67 4957.78,-5698 5957.15,-5685.12 6424.72,-5683.45"/>
<polygon fill="black" stroke="black" points="6425,-5686.94 6434.99,-5683.41 6424.97,-5679.94 6425,-5686.94"/>
</g>
<!-- layer_1_expert5_gate -->
<g id="node34" class="node">
<title>layer_1_expert5_gate</title>
<polygon fill="yellow" stroke="black" points="4485.72,-6108.67 4139.72,-6055.67 4485.72,-6002.67 4831.72,-6055.67 4485.72,-6108.67"/>
<text text-anchor="middle" x="4485.72" y="-6066.97" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="4485.72" y="-6051.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="4485.72" y="-6036.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_1_expert5_recv&#45;&gt;layer_1_expert5_gate -->
<g id="edge22" class="edge">
<title>layer_1_expert5_recv&#45;&gt;layer_1_expert5_gate</title>
<path fill="none" stroke="black" d="M4485.72,-6144.54C4485.72,-6136.25 4485.72,-6127.6 4485.72,-6119.1"/>
<polygon fill="black" stroke="black" points="4489.22,-6118.85 4485.72,-6108.85 4482.22,-6118.85 4489.22,-6118.85"/>
</g>
<!-- layer_1_expert5 -->
<g id="node35" class="node">
<title>layer_1_expert5</title>
<polygon fill="lightpink" stroke="black" points="4658.72,-5966.67 4312.72,-5966.67 4312.72,-5913.67 4658.72,-5913.67 4658.72,-5966.67"/>
<text text-anchor="middle" x="4485.72" y="-5951.47" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4485.72" y="-5936.47" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="4485.72" y="-5921.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_1_expert5_gate&#45;&gt;layer_1_expert5 -->
<g id="edge23" class="edge">
<title>layer_1_expert5_gate&#45;&gt;layer_1_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4485.72,-6002.57C4485.72,-5993.9 4485.72,-5985.09 4485.72,-5976.94"/>
<polygon fill="black" stroke="black" points="4489.22,-5976.69 4485.72,-5966.69 4482.22,-5976.69 4489.22,-5976.69"/>
</g>
<!-- layer_1_expert5_send -->
<g id="node36" class="node">
<title>layer_1_expert5_send</title>
<polygon fill="lightgreen" stroke="black" points="4844.65,-5877.67 4273.67,-5877.67 4126.78,-5771.67 4697.77,-5771.67 4844.65,-5877.67"/>
<text text-anchor="middle" x="4485.72" y="-5835.97" font-family="Times,serif" font-size="14.00">Expert 5 Send</text>
<text text-anchor="middle" x="4485.72" y="-5820.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="4485.72" y="-5805.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_1_expert5&#45;&gt;layer_1_expert5_send -->
<g id="edge24" class="edge">
<title>layer_1_expert5&#45;&gt;layer_1_expert5_send</title>
<path fill="none" stroke="black" d="M4485.72,-5913.42C4485.72,-5905.72 4485.72,-5896.92 4485.72,-5887.94"/>
<polygon fill="black" stroke="black" points="4489.22,-5887.77 4485.72,-5877.77 4482.22,-5887.77 4489.22,-5887.77"/>
</g>
<!-- layer_1_expert5_send&#45;&gt;layer_1_exp_agg -->
<g id="edge85" class="edge">
<title>layer_1_expert5_send&#45;&gt;layer_1_exp_agg</title>
<path fill="none" stroke="black" d="M4719.78,-5787.2C4763.86,-5781.27 4809.63,-5775.75 4852.72,-5771.67 5413.84,-5718.6 6074.52,-5696.89 6431.02,-5688.51"/>
<polygon fill="black" stroke="black" points="6431.3,-5692.01 6441.22,-5688.27 6431.14,-5685.01 6431.3,-5692.01"/>
</g>
<!-- layer_1_expert6_gate -->
<g id="node38" class="node">
<title>layer_1_expert6_gate</title>
<polygon fill="yellow" stroke="black" points="5220.72,-6108.67 4874.72,-6055.67 5220.72,-6002.67 5566.72,-6055.67 5220.72,-6108.67"/>
<text text-anchor="middle" x="5220.72" y="-6066.97" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="5220.72" y="-6051.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5220.72" y="-6036.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_1_expert6_recv&#45;&gt;layer_1_expert6_gate -->
<g id="edge26" class="edge">
<title>layer_1_expert6_recv&#45;&gt;layer_1_expert6_gate</title>
<path fill="none" stroke="black" d="M5220.72,-6144.54C5220.72,-6136.25 5220.72,-6127.6 5220.72,-6119.1"/>
<polygon fill="black" stroke="black" points="5224.22,-6118.85 5220.72,-6108.85 5217.22,-6118.85 5224.22,-6118.85"/>
</g>
<!-- layer_1_expert6 -->
<g id="node39" class="node">
<title>layer_1_expert6</title>
<polygon fill="lightpink" stroke="black" points="5393.72,-5966.67 5047.72,-5966.67 5047.72,-5913.67 5393.72,-5913.67 5393.72,-5966.67"/>
<text text-anchor="middle" x="5220.72" y="-5951.47" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="5220.72" y="-5936.47" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5220.72" y="-5921.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_1_expert6_gate&#45;&gt;layer_1_expert6 -->
<g id="edge27" class="edge">
<title>layer_1_expert6_gate&#45;&gt;layer_1_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5220.72,-6002.57C5220.72,-5993.9 5220.72,-5985.09 5220.72,-5976.94"/>
<polygon fill="black" stroke="black" points="5224.22,-5976.69 5220.72,-5966.69 5217.22,-5976.69 5224.22,-5976.69"/>
</g>
<!-- layer_1_expert6_send -->
<g id="node40" class="node">
<title>layer_1_expert6_send</title>
<polygon fill="lightgreen" stroke="black" points="5579.65,-5877.67 5008.67,-5877.67 4861.78,-5771.67 5432.77,-5771.67 5579.65,-5877.67"/>
<text text-anchor="middle" x="5220.72" y="-5835.97" font-family="Times,serif" font-size="14.00">Expert 6 Send</text>
<text text-anchor="middle" x="5220.72" y="-5820.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5220.72" y="-5805.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_1_expert6&#45;&gt;layer_1_expert6_send -->
<g id="edge28" class="edge">
<title>layer_1_expert6&#45;&gt;layer_1_expert6_send</title>
<path fill="none" stroke="black" d="M5220.72,-5913.42C5220.72,-5905.72 5220.72,-5896.92 5220.72,-5887.94"/>
<polygon fill="black" stroke="black" points="5224.22,-5887.77 5220.72,-5877.77 5217.22,-5887.77 5224.22,-5887.77"/>
</g>
<!-- layer_1_expert6_send&#45;&gt;layer_1_exp_agg -->
<g id="edge86" class="edge">
<title>layer_1_expert6_send&#45;&gt;layer_1_exp_agg</title>
<path fill="none" stroke="black" d="M5455.88,-5788.18C5499.64,-5782.19 5545.02,-5776.4 5587.72,-5771.67 5881.07,-5739.22 6219.59,-5714.02 6443.4,-5699.06"/>
<polygon fill="black" stroke="black" points="6443.9,-5702.54 6453.64,-5698.38 6443.43,-5695.55 6443.9,-5702.54"/>
</g>
<!-- layer_1_expert7_gate -->
<g id="node42" class="node">
<title>layer_1_expert7_gate</title>
<polygon fill="yellow" stroke="black" points="5955.72,-6108.67 5609.72,-6055.67 5955.72,-6002.67 6301.72,-6055.67 5955.72,-6108.67"/>
<text text-anchor="middle" x="5955.72" y="-6066.97" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="5955.72" y="-6051.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5955.72" y="-6036.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_1_expert7_recv&#45;&gt;layer_1_expert7_gate -->
<g id="edge30" class="edge">
<title>layer_1_expert7_recv&#45;&gt;layer_1_expert7_gate</title>
<path fill="none" stroke="black" d="M5955.72,-6144.54C5955.72,-6136.25 5955.72,-6127.6 5955.72,-6119.1"/>
<polygon fill="black" stroke="black" points="5959.22,-6118.85 5955.72,-6108.85 5952.22,-6118.85 5959.22,-6118.85"/>
</g>
<!-- layer_1_expert7 -->
<g id="node43" class="node">
<title>layer_1_expert7</title>
<polygon fill="lightpink" stroke="black" points="6128.72,-5966.67 5782.72,-5966.67 5782.72,-5913.67 6128.72,-5913.67 6128.72,-5966.67"/>
<text text-anchor="middle" x="5955.72" y="-5951.47" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5955.72" y="-5936.47" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5955.72" y="-5921.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_1_expert7_gate&#45;&gt;layer_1_expert7 -->
<g id="edge31" class="edge">
<title>layer_1_expert7_gate&#45;&gt;layer_1_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5955.72,-6002.57C5955.72,-5993.9 5955.72,-5985.09 5955.72,-5976.94"/>
<polygon fill="black" stroke="black" points="5959.22,-5976.69 5955.72,-5966.69 5952.22,-5976.69 5959.22,-5976.69"/>
</g>
<!-- layer_1_expert7_send -->
<g id="node44" class="node">
<title>layer_1_expert7_send</title>
<polygon fill="lightgreen" stroke="black" points="6314.65,-5877.67 5743.67,-5877.67 5596.78,-5771.67 6167.77,-5771.67 6314.65,-5877.67"/>
<text text-anchor="middle" x="5955.72" y="-5835.97" font-family="Times,serif" font-size="14.00">Expert 7 Send</text>
<text text-anchor="middle" x="5955.72" y="-5820.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5955.72" y="-5805.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_1_expert7&#45;&gt;layer_1_expert7_send -->
<g id="edge32" class="edge">
<title>layer_1_expert7&#45;&gt;layer_1_expert7_send</title>
<path fill="none" stroke="black" d="M5955.72,-5913.42C5955.72,-5905.72 5955.72,-5896.92 5955.72,-5887.94"/>
<polygon fill="black" stroke="black" points="5959.22,-5887.77 5955.72,-5877.77 5952.22,-5887.77 5959.22,-5887.77"/>
</g>
<!-- layer_1_expert7_send&#45;&gt;layer_1_exp_agg -->
<g id="edge87" class="edge">
<title>layer_1_expert7_send&#45;&gt;layer_1_exp_agg</title>
<path fill="none" stroke="black" d="M6180.74,-5780.81C6274.09,-5763.03 6381.97,-5742.48 6474.39,-5724.88"/>
<polygon fill="black" stroke="black" points="6475.27,-5728.27 6484.43,-5722.97 6473.96,-5721.4 6475.27,-5728.27"/>
</g>
<!-- layer_1_expert8_gate -->
<g id="node46" class="node">
<title>layer_1_expert8_gate</title>
<polygon fill="yellow" stroke="black" points="6690.72,-6108.67 6344.72,-6055.67 6690.72,-6002.67 7036.72,-6055.67 6690.72,-6108.67"/>
<text text-anchor="middle" x="6690.72" y="-6066.97" font-family="Times,serif" font-size="14.00">Expert 8 Gate</text>
<text text-anchor="middle" x="6690.72" y="-6051.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="6690.72" y="-6036.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_1_expert8_recv&#45;&gt;layer_1_expert8_gate -->
<g id="edge34" class="edge">
<title>layer_1_expert8_recv&#45;&gt;layer_1_expert8_gate</title>
<path fill="none" stroke="black" d="M6690.72,-6144.54C6690.72,-6136.25 6690.72,-6127.6 6690.72,-6119.1"/>
<polygon fill="black" stroke="black" points="6694.22,-6118.85 6690.72,-6108.85 6687.22,-6118.85 6694.22,-6118.85"/>
</g>
<!-- layer_1_expert8 -->
<g id="node47" class="node">
<title>layer_1_expert8</title>
<polygon fill="lightpink" stroke="black" points="6863.72,-5966.67 6517.72,-5966.67 6517.72,-5913.67 6863.72,-5913.67 6863.72,-5966.67"/>
<text text-anchor="middle" x="6690.72" y="-5951.47" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="6690.72" y="-5936.47" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="6690.72" y="-5921.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_1_expert8_gate&#45;&gt;layer_1_expert8 -->
<g id="edge35" class="edge">
<title>layer_1_expert8_gate&#45;&gt;layer_1_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6690.72,-6002.57C6690.72,-5993.9 6690.72,-5985.09 6690.72,-5976.94"/>
<polygon fill="black" stroke="black" points="6694.22,-5976.69 6690.72,-5966.69 6687.22,-5976.69 6694.22,-5976.69"/>
</g>
<!-- layer_1_expert8_send -->
<g id="node48" class="node">
<title>layer_1_expert8_send</title>
<polygon fill="lightgreen" stroke="black" points="7049.65,-5877.67 6478.67,-5877.67 6331.78,-5771.67 6902.77,-5771.67 7049.65,-5877.67"/>
<text text-anchor="middle" x="6690.72" y="-5835.97" font-family="Times,serif" font-size="14.00">Expert 8 Send</text>
<text text-anchor="middle" x="6690.72" y="-5820.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="6690.72" y="-5805.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_1_expert8&#45;&gt;layer_1_expert8_send -->
<g id="edge36" class="edge">
<title>layer_1_expert8&#45;&gt;layer_1_expert8_send</title>
<path fill="none" stroke="black" d="M6690.72,-5913.42C6690.72,-5905.72 6690.72,-5896.92 6690.72,-5887.94"/>
<polygon fill="black" stroke="black" points="6694.22,-5887.77 6690.72,-5877.77 6687.22,-5887.77 6694.22,-5887.77"/>
</g>
<!-- layer_1_expert8_send&#45;&gt;layer_1_exp_agg -->
<g id="edge88" class="edge">
<title>layer_1_expert8_send&#45;&gt;layer_1_exp_agg</title>
<path fill="none" stroke="black" d="M6690.72,-5771.54C6690.72,-5763.25 6690.72,-5754.6 6690.72,-5746.1"/>
<polygon fill="black" stroke="black" points="6694.22,-5745.85 6690.72,-5735.85 6687.22,-5745.85 6694.22,-5745.85"/>
</g>
<!-- layer_1_expert9_gate -->
<g id="node50" class="node">
<title>layer_1_expert9_gate</title>
<polygon fill="yellow" stroke="black" points="7425.72,-6108.67 7079.72,-6055.67 7425.72,-6002.67 7771.72,-6055.67 7425.72,-6108.67"/>
<text text-anchor="middle" x="7425.72" y="-6066.97" font-family="Times,serif" font-size="14.00">Expert 9 Gate</text>
<text text-anchor="middle" x="7425.72" y="-6051.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="7425.72" y="-6036.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_1_expert9_recv&#45;&gt;layer_1_expert9_gate -->
<g id="edge38" class="edge">
<title>layer_1_expert9_recv&#45;&gt;layer_1_expert9_gate</title>
<path fill="none" stroke="black" d="M7425.72,-6144.54C7425.72,-6136.25 7425.72,-6127.6 7425.72,-6119.1"/>
<polygon fill="black" stroke="black" points="7429.22,-6118.85 7425.72,-6108.85 7422.22,-6118.85 7429.22,-6118.85"/>
</g>
<!-- layer_1_expert9 -->
<g id="node51" class="node">
<title>layer_1_expert9</title>
<polygon fill="lightpink" stroke="black" points="7598.72,-5966.67 7252.72,-5966.67 7252.72,-5913.67 7598.72,-5913.67 7598.72,-5966.67"/>
<text text-anchor="middle" x="7425.72" y="-5951.47" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="7425.72" y="-5936.47" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="7425.72" y="-5921.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_1_expert9_gate&#45;&gt;layer_1_expert9 -->
<g id="edge39" class="edge">
<title>layer_1_expert9_gate&#45;&gt;layer_1_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7425.72,-6002.57C7425.72,-5993.9 7425.72,-5985.09 7425.72,-5976.94"/>
<polygon fill="black" stroke="black" points="7429.22,-5976.69 7425.72,-5966.69 7422.22,-5976.69 7429.22,-5976.69"/>
</g>
<!-- layer_1_expert9_send -->
<g id="node52" class="node">
<title>layer_1_expert9_send</title>
<polygon fill="lightgreen" stroke="black" points="7784.65,-5877.67 7213.67,-5877.67 7066.78,-5771.67 7637.77,-5771.67 7784.65,-5877.67"/>
<text text-anchor="middle" x="7425.72" y="-5835.97" font-family="Times,serif" font-size="14.00">Expert 9 Send</text>
<text text-anchor="middle" x="7425.72" y="-5820.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="7425.72" y="-5805.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_1_expert9&#45;&gt;layer_1_expert9_send -->
<g id="edge40" class="edge">
<title>layer_1_expert9&#45;&gt;layer_1_expert9_send</title>
<path fill="none" stroke="black" d="M7425.72,-5913.42C7425.72,-5905.72 7425.72,-5896.92 7425.72,-5887.94"/>
<polygon fill="black" stroke="black" points="7429.22,-5887.77 7425.72,-5877.77 7422.22,-5887.77 7429.22,-5887.77"/>
</g>
<!-- layer_1_expert9_send&#45;&gt;layer_1_exp_agg -->
<g id="edge89" class="edge">
<title>layer_1_expert9_send&#45;&gt;layer_1_exp_agg</title>
<path fill="none" stroke="black" d="M7152.55,-5771.64C7094.26,-5760.54 7032.58,-5748.79 6973.92,-5737.62"/>
<polygon fill="black" stroke="black" points="6974.25,-5734.12 6963.78,-5735.68 6972.94,-5740.99 6974.25,-5734.12"/>
</g>
<!-- layer_1_expert10_gate -->
<g id="node54" class="node">
<title>layer_1_expert10_gate</title>
<polygon fill="yellow" stroke="black" points="8160.72,-6108.67 7814.72,-6055.67 8160.72,-6002.67 8506.72,-6055.67 8160.72,-6108.67"/>
<text text-anchor="middle" x="8160.72" y="-6066.97" font-family="Times,serif" font-size="14.00">Expert 10 Gate</text>
<text text-anchor="middle" x="8160.72" y="-6051.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8160.72" y="-6036.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_1_expert10_recv&#45;&gt;layer_1_expert10_gate -->
<g id="edge42" class="edge">
<title>layer_1_expert10_recv&#45;&gt;layer_1_expert10_gate</title>
<path fill="none" stroke="black" d="M8160.72,-6144.54C8160.72,-6136.25 8160.72,-6127.6 8160.72,-6119.1"/>
<polygon fill="black" stroke="black" points="8164.22,-6118.85 8160.72,-6108.85 8157.22,-6118.85 8164.22,-6118.85"/>
</g>
<!-- layer_1_expert10 -->
<g id="node55" class="node">
<title>layer_1_expert10</title>
<polygon fill="lightpink" stroke="black" points="8333.72,-5966.67 7987.72,-5966.67 7987.72,-5913.67 8333.72,-5913.67 8333.72,-5966.67"/>
<text text-anchor="middle" x="8160.72" y="-5951.47" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="8160.72" y="-5936.47" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8160.72" y="-5921.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_1_expert10_gate&#45;&gt;layer_1_expert10 -->
<g id="edge43" class="edge">
<title>layer_1_expert10_gate&#45;&gt;layer_1_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8160.72,-6002.57C8160.72,-5993.9 8160.72,-5985.09 8160.72,-5976.94"/>
<polygon fill="black" stroke="black" points="8164.22,-5976.69 8160.72,-5966.69 8157.22,-5976.69 8164.22,-5976.69"/>
</g>
<!-- layer_1_expert10_send -->
<g id="node56" class="node">
<title>layer_1_expert10_send</title>
<polygon fill="lightgreen" stroke="black" points="8519.65,-5877.67 7948.67,-5877.67 7801.78,-5771.67 8372.77,-5771.67 8519.65,-5877.67"/>
<text text-anchor="middle" x="8160.72" y="-5835.97" font-family="Times,serif" font-size="14.00">Expert 10 Send</text>
<text text-anchor="middle" x="8160.72" y="-5820.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8160.72" y="-5805.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_1_expert10&#45;&gt;layer_1_expert10_send -->
<g id="edge44" class="edge">
<title>layer_1_expert10&#45;&gt;layer_1_expert10_send</title>
<path fill="none" stroke="black" d="M8160.72,-5913.42C8160.72,-5905.72 8160.72,-5896.92 8160.72,-5887.94"/>
<polygon fill="black" stroke="black" points="8164.22,-5887.77 8160.72,-5877.77 8157.22,-5887.77 8164.22,-5887.77"/>
</g>
<!-- layer_1_expert10_send&#45;&gt;layer_1_exp_agg -->
<g id="edge90" class="edge">
<title>layer_1_expert10_send&#45;&gt;layer_1_exp_agg</title>
<path fill="none" stroke="black" d="M7802.87,-5772.7C7799.81,-5772.35 7796.75,-5772.01 7793.72,-5771.67 7518.35,-5741.21 7203.17,-5717.14 6980.44,-5701.93"/>
<polygon fill="black" stroke="black" points="6980.46,-5698.42 6970.24,-5701.23 6979.98,-5705.41 6980.46,-5698.42"/>
</g>
<!-- layer_1_expert11_gate -->
<g id="node58" class="node">
<title>layer_1_expert11_gate</title>
<polygon fill="yellow" stroke="black" points="8895.72,-6108.67 8549.72,-6055.67 8895.72,-6002.67 9241.72,-6055.67 8895.72,-6108.67"/>
<text text-anchor="middle" x="8895.72" y="-6066.97" font-family="Times,serif" font-size="14.00">Expert 11 Gate</text>
<text text-anchor="middle" x="8895.72" y="-6051.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8895.72" y="-6036.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_1_expert11_recv&#45;&gt;layer_1_expert11_gate -->
<g id="edge46" class="edge">
<title>layer_1_expert11_recv&#45;&gt;layer_1_expert11_gate</title>
<path fill="none" stroke="black" d="M8895.72,-6144.54C8895.72,-6136.25 8895.72,-6127.6 8895.72,-6119.1"/>
<polygon fill="black" stroke="black" points="8899.22,-6118.85 8895.72,-6108.85 8892.22,-6118.85 8899.22,-6118.85"/>
</g>
<!-- layer_1_expert11 -->
<g id="node59" class="node">
<title>layer_1_expert11</title>
<polygon fill="lightpink" stroke="black" points="9068.72,-5966.67 8722.72,-5966.67 8722.72,-5913.67 9068.72,-5913.67 9068.72,-5966.67"/>
<text text-anchor="middle" x="8895.72" y="-5951.47" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="8895.72" y="-5936.47" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8895.72" y="-5921.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_1_expert11_gate&#45;&gt;layer_1_expert11 -->
<g id="edge47" class="edge">
<title>layer_1_expert11_gate&#45;&gt;layer_1_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8895.72,-6002.57C8895.72,-5993.9 8895.72,-5985.09 8895.72,-5976.94"/>
<polygon fill="black" stroke="black" points="8899.22,-5976.69 8895.72,-5966.69 8892.22,-5976.69 8899.22,-5976.69"/>
</g>
<!-- layer_1_expert11_send -->
<g id="node60" class="node">
<title>layer_1_expert11_send</title>
<polygon fill="lightgreen" stroke="black" points="9254.65,-5877.67 8683.67,-5877.67 8536.78,-5771.67 9107.77,-5771.67 9254.65,-5877.67"/>
<text text-anchor="middle" x="8895.72" y="-5835.97" font-family="Times,serif" font-size="14.00">Expert 11 Send</text>
<text text-anchor="middle" x="8895.72" y="-5820.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8895.72" y="-5805.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_1_expert11&#45;&gt;layer_1_expert11_send -->
<g id="edge48" class="edge">
<title>layer_1_expert11&#45;&gt;layer_1_expert11_send</title>
<path fill="none" stroke="black" d="M8895.72,-5913.42C8895.72,-5905.72 8895.72,-5896.92 8895.72,-5887.94"/>
<polygon fill="black" stroke="black" points="8899.22,-5887.77 8895.72,-5877.77 8892.22,-5887.77 8899.22,-5887.77"/>
</g>
<!-- layer_1_expert11_send&#45;&gt;layer_1_exp_agg -->
<g id="edge91" class="edge">
<title>layer_1_expert11_send&#45;&gt;layer_1_exp_agg</title>
<path fill="none" stroke="black" d="M8537.88,-5772.56C8534.82,-5772.26 8531.76,-5771.96 8528.72,-5771.67 7974.94,-5719.3 7324.19,-5697.46 6964.57,-5688.85"/>
<polygon fill="black" stroke="black" points="6964.62,-5685.35 6954.54,-5688.61 6964.46,-5692.35 6964.62,-5685.35"/>
</g>
<!-- layer_1_expert12_gate -->
<g id="node62" class="node">
<title>layer_1_expert12_gate</title>
<polygon fill="yellow" stroke="black" points="9630.72,-6108.67 9284.72,-6055.67 9630.72,-6002.67 9976.72,-6055.67 9630.72,-6108.67"/>
<text text-anchor="middle" x="9630.72" y="-6066.97" font-family="Times,serif" font-size="14.00">Expert 12 Gate</text>
<text text-anchor="middle" x="9630.72" y="-6051.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="9630.72" y="-6036.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_1_expert12_recv&#45;&gt;layer_1_expert12_gate -->
<g id="edge50" class="edge">
<title>layer_1_expert12_recv&#45;&gt;layer_1_expert12_gate</title>
<path fill="none" stroke="black" d="M9630.72,-6144.54C9630.72,-6136.25 9630.72,-6127.6 9630.72,-6119.1"/>
<polygon fill="black" stroke="black" points="9634.22,-6118.85 9630.72,-6108.85 9627.22,-6118.85 9634.22,-6118.85"/>
</g>
<!-- layer_1_expert12 -->
<g id="node63" class="node">
<title>layer_1_expert12</title>
<polygon fill="lightpink" stroke="black" points="9803.72,-5966.67 9457.72,-5966.67 9457.72,-5913.67 9803.72,-5913.67 9803.72,-5966.67"/>
<text text-anchor="middle" x="9630.72" y="-5951.47" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="9630.72" y="-5936.47" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="9630.72" y="-5921.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_1_expert12_gate&#45;&gt;layer_1_expert12 -->
<g id="edge51" class="edge">
<title>layer_1_expert12_gate&#45;&gt;layer_1_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9630.72,-6002.57C9630.72,-5993.9 9630.72,-5985.09 9630.72,-5976.94"/>
<polygon fill="black" stroke="black" points="9634.22,-5976.69 9630.72,-5966.69 9627.22,-5976.69 9634.22,-5976.69"/>
</g>
<!-- layer_1_expert12_send -->
<g id="node64" class="node">
<title>layer_1_expert12_send</title>
<polygon fill="lightgreen" stroke="black" points="9989.65,-5877.67 9418.67,-5877.67 9271.78,-5771.67 9842.77,-5771.67 9989.65,-5877.67"/>
<text text-anchor="middle" x="9630.72" y="-5835.97" font-family="Times,serif" font-size="14.00">Expert 12 Send</text>
<text text-anchor="middle" x="9630.72" y="-5820.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="9630.72" y="-5805.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_1_expert12&#45;&gt;layer_1_expert12_send -->
<g id="edge52" class="edge">
<title>layer_1_expert12&#45;&gt;layer_1_expert12_send</title>
<path fill="none" stroke="black" d="M9630.72,-5913.42C9630.72,-5905.72 9630.72,-5896.92 9630.72,-5887.94"/>
<polygon fill="black" stroke="black" points="9634.22,-5887.77 9630.72,-5877.77 9627.22,-5887.77 9634.22,-5887.77"/>
</g>
<!-- layer_1_expert12_send&#45;&gt;layer_1_exp_agg -->
<g id="edge92" class="edge">
<title>layer_1_expert12_send&#45;&gt;layer_1_exp_agg</title>
<path fill="none" stroke="black" d="M9272.89,-5772.5C9269.82,-5772.22 9266.76,-5771.94 9263.72,-5771.67 8424.76,-5698.1 7426.91,-5685.16 6958.56,-5683.45"/>
<polygon fill="black" stroke="black" points="6958.29,-5679.95 6948.28,-5683.42 6958.27,-5686.95 6958.29,-5679.95"/>
</g>
<!-- layer_1_expert13_gate -->
<g id="node66" class="node">
<title>layer_1_expert13_gate</title>
<polygon fill="yellow" stroke="black" points="10365.72,-6108.67 10019.72,-6055.67 10365.72,-6002.67 10711.72,-6055.67 10365.72,-6108.67"/>
<text text-anchor="middle" x="10365.72" y="-6066.97" font-family="Times,serif" font-size="14.00">Expert 13 Gate</text>
<text text-anchor="middle" x="10365.72" y="-6051.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10365.72" y="-6036.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_1_expert13_recv&#45;&gt;layer_1_expert13_gate -->
<g id="edge54" class="edge">
<title>layer_1_expert13_recv&#45;&gt;layer_1_expert13_gate</title>
<path fill="none" stroke="black" d="M10365.72,-6144.54C10365.72,-6136.25 10365.72,-6127.6 10365.72,-6119.1"/>
<polygon fill="black" stroke="black" points="10369.22,-6118.85 10365.72,-6108.85 10362.22,-6118.85 10369.22,-6118.85"/>
</g>
<!-- layer_1_expert13 -->
<g id="node67" class="node">
<title>layer_1_expert13</title>
<polygon fill="lightpink" stroke="black" points="10538.72,-5966.67 10192.72,-5966.67 10192.72,-5913.67 10538.72,-5913.67 10538.72,-5966.67"/>
<text text-anchor="middle" x="10365.72" y="-5951.47" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="10365.72" y="-5936.47" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10365.72" y="-5921.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_1_expert13_gate&#45;&gt;layer_1_expert13 -->
<g id="edge55" class="edge">
<title>layer_1_expert13_gate&#45;&gt;layer_1_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10365.72,-6002.57C10365.72,-5993.9 10365.72,-5985.09 10365.72,-5976.94"/>
<polygon fill="black" stroke="black" points="10369.22,-5976.69 10365.72,-5966.69 10362.22,-5976.69 10369.22,-5976.69"/>
</g>
<!-- layer_1_expert13_send -->
<g id="node68" class="node">
<title>layer_1_expert13_send</title>
<polygon fill="lightgreen" stroke="black" points="10724.65,-5877.67 10153.67,-5877.67 10006.78,-5771.67 10577.77,-5771.67 10724.65,-5877.67"/>
<text text-anchor="middle" x="10365.72" y="-5835.97" font-family="Times,serif" font-size="14.00">Expert 13 Send</text>
<text text-anchor="middle" x="10365.72" y="-5820.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10365.72" y="-5805.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_1_expert13&#45;&gt;layer_1_expert13_send -->
<g id="edge56" class="edge">
<title>layer_1_expert13&#45;&gt;layer_1_expert13_send</title>
<path fill="none" stroke="black" d="M10365.72,-5913.42C10365.72,-5905.72 10365.72,-5896.92 10365.72,-5887.94"/>
<polygon fill="black" stroke="black" points="10369.22,-5887.77 10365.72,-5877.77 10362.22,-5887.77 10369.22,-5887.77"/>
</g>
<!-- layer_1_expert13_send&#45;&gt;layer_1_exp_agg -->
<g id="edge93" class="edge">
<title>layer_1_expert13_send&#45;&gt;layer_1_exp_agg</title>
<path fill="none" stroke="black" d="M10007.41,-5772.42C10004.5,-5772.16 10001.6,-5771.92 9998.72,-5771.67 9411.99,-5722.46 7644.19,-5695.64 6962.71,-5686.9"/>
<polygon fill="black" stroke="black" points="6962.56,-5683.4 6952.51,-5686.77 6962.47,-5690.4 6962.56,-5683.4"/>
</g>
<!-- layer_1_expert14_gate -->
<g id="node70" class="node">
<title>layer_1_expert14_gate</title>
<polygon fill="yellow" stroke="black" points="11100.72,-6108.67 10754.72,-6055.67 11100.72,-6002.67 11446.72,-6055.67 11100.72,-6108.67"/>
<text text-anchor="middle" x="11100.72" y="-6066.97" font-family="Times,serif" font-size="14.00">Expert 14 Gate</text>
<text text-anchor="middle" x="11100.72" y="-6051.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="11100.72" y="-6036.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_1_expert14_recv&#45;&gt;layer_1_expert14_gate -->
<g id="edge58" class="edge">
<title>layer_1_expert14_recv&#45;&gt;layer_1_expert14_gate</title>
<path fill="none" stroke="black" d="M11100.72,-6144.54C11100.72,-6136.25 11100.72,-6127.6 11100.72,-6119.1"/>
<polygon fill="black" stroke="black" points="11104.22,-6118.85 11100.72,-6108.85 11097.22,-6118.85 11104.22,-6118.85"/>
</g>
<!-- layer_1_expert14 -->
<g id="node71" class="node">
<title>layer_1_expert14</title>
<polygon fill="lightpink" stroke="black" points="11273.72,-5966.67 10927.72,-5966.67 10927.72,-5913.67 11273.72,-5913.67 11273.72,-5966.67"/>
<text text-anchor="middle" x="11100.72" y="-5951.47" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="11100.72" y="-5936.47" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="11100.72" y="-5921.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_1_expert14_gate&#45;&gt;layer_1_expert14 -->
<g id="edge59" class="edge">
<title>layer_1_expert14_gate&#45;&gt;layer_1_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11100.72,-6002.57C11100.72,-5993.9 11100.72,-5985.09 11100.72,-5976.94"/>
<polygon fill="black" stroke="black" points="11104.22,-5976.69 11100.72,-5966.69 11097.22,-5976.69 11104.22,-5976.69"/>
</g>
<!-- layer_1_expert14_send -->
<g id="node72" class="node">
<title>layer_1_expert14_send</title>
<polygon fill="lightgreen" stroke="black" points="11459.65,-5877.67 10888.67,-5877.67 10741.78,-5771.67 11312.77,-5771.67 11459.65,-5877.67"/>
<text text-anchor="middle" x="11100.72" y="-5835.97" font-family="Times,serif" font-size="14.00">Expert 14 Send</text>
<text text-anchor="middle" x="11100.72" y="-5820.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="11100.72" y="-5805.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_1_expert14&#45;&gt;layer_1_expert14_send -->
<g id="edge60" class="edge">
<title>layer_1_expert14&#45;&gt;layer_1_expert14_send</title>
<path fill="none" stroke="black" d="M11100.72,-5913.42C11100.72,-5905.72 11100.72,-5896.92 11100.72,-5887.94"/>
<polygon fill="black" stroke="black" points="11104.22,-5887.77 11100.72,-5877.77 11097.22,-5887.77 11104.22,-5887.77"/>
</g>
<!-- layer_1_expert14_send&#45;&gt;layer_1_exp_agg -->
<g id="edge94" class="edge">
<title>layer_1_expert14_send&#45;&gt;layer_1_exp_agg</title>
<path fill="none" stroke="black" d="M10742.41,-5772.4C10739.5,-5772.15 10736.6,-5771.91 10733.72,-5771.67 9997.84,-5711.75 7742.19,-5690.89 6960.65,-5685.35"/>
<polygon fill="black" stroke="black" points="6960.42,-5681.85 6950.39,-5685.28 6960.37,-5688.85 6960.42,-5681.85"/>
</g>
<!-- layer_1_expert15_gate -->
<g id="node74" class="node">
<title>layer_1_expert15_gate</title>
<polygon fill="yellow" stroke="black" points="11835.72,-6108.67 11489.72,-6055.67 11835.72,-6002.67 12181.72,-6055.67 11835.72,-6108.67"/>
<text text-anchor="middle" x="11835.72" y="-6066.97" font-family="Times,serif" font-size="14.00">Expert 15 Gate</text>
<text text-anchor="middle" x="11835.72" y="-6051.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="11835.72" y="-6036.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_1_expert15_recv&#45;&gt;layer_1_expert15_gate -->
<g id="edge62" class="edge">
<title>layer_1_expert15_recv&#45;&gt;layer_1_expert15_gate</title>
<path fill="none" stroke="black" d="M11835.72,-6144.54C11835.72,-6136.25 11835.72,-6127.6 11835.72,-6119.1"/>
<polygon fill="black" stroke="black" points="11839.22,-6118.85 11835.72,-6108.85 11832.22,-6118.85 11839.22,-6118.85"/>
</g>
<!-- layer_1_expert15 -->
<g id="node75" class="node">
<title>layer_1_expert15</title>
<polygon fill="lightpink" stroke="black" points="12008.72,-5966.67 11662.72,-5966.67 11662.72,-5913.67 12008.72,-5913.67 12008.72,-5966.67"/>
<text text-anchor="middle" x="11835.72" y="-5951.47" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="11835.72" y="-5936.47" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="11835.72" y="-5921.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_1_expert15_gate&#45;&gt;layer_1_expert15 -->
<g id="edge63" class="edge">
<title>layer_1_expert15_gate&#45;&gt;layer_1_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11835.72,-6002.57C11835.72,-5993.9 11835.72,-5985.09 11835.72,-5976.94"/>
<polygon fill="black" stroke="black" points="11839.22,-5976.69 11835.72,-5966.69 11832.22,-5976.69 11839.22,-5976.69"/>
</g>
<!-- layer_1_expert15_send -->
<g id="node76" class="node">
<title>layer_1_expert15_send</title>
<polygon fill="lightgreen" stroke="black" points="12194.65,-5877.67 11623.67,-5877.67 11476.78,-5771.67 12047.77,-5771.67 12194.65,-5877.67"/>
<text text-anchor="middle" x="11835.72" y="-5835.97" font-family="Times,serif" font-size="14.00">Expert 15 Send</text>
<text text-anchor="middle" x="11835.72" y="-5820.97" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="11835.72" y="-5805.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_1_expert15&#45;&gt;layer_1_expert15_send -->
<g id="edge64" class="edge">
<title>layer_1_expert15&#45;&gt;layer_1_expert15_send</title>
<path fill="none" stroke="black" d="M11835.72,-5913.42C11835.72,-5905.72 11835.72,-5896.92 11835.72,-5887.94"/>
<polygon fill="black" stroke="black" points="11839.22,-5887.77 11835.72,-5877.77 11832.22,-5887.77 11839.22,-5887.77"/>
</g>
<!-- layer_1_expert15_send&#45;&gt;layer_1_exp_agg -->
<g id="edge95" class="edge">
<title>layer_1_expert15_send&#45;&gt;layer_1_exp_agg</title>
<path fill="none" stroke="black" d="M11477.41,-5772.39C11474.5,-5772.14 11471.6,-5771.9 11468.72,-5771.67 10582.62,-5701 7832.22,-5686.98 6959.39,-5684.29"/>
<polygon fill="black" stroke="black" points="6959.22,-5680.79 6949.21,-5684.26 6959.2,-5687.79 6959.22,-5680.79"/>
</g>
<!-- layer_1_exp_agg&#45;&gt;layer_1_exp_res -->
<g id="edge96" class="edge">
<title>layer_1_exp_agg&#45;&gt;layer_1_exp_res</title>
<path fill="none" stroke="black" d="M6933.76,-5671.7C7485.67,-5649.05 8821.91,-5594.22 9290.77,-5574.98"/>
<polygon fill="black" stroke="black" points="9291.16,-5578.47 9301,-5574.56 9290.87,-5571.48 9291.16,-5578.47"/>
</g>
<!-- layer_1_output -->
<g id="node79" class="node">
<title>layer_1_output</title>
<ellipse fill="lightgreen" stroke="black" cx="9456.72" cy="-5467.2" rx="219.82" ry="37.45"/>
<text text-anchor="middle" x="9456.72" y="-5478.5" font-family="Times,serif" font-size="14.00">Layer 1 Output</text>
<text text-anchor="middle" x="9456.72" y="-5463.5" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9456.72" y="-5448.5" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_1_exp_res&#45;&gt;layer_1_output -->
<g id="edge98" class="edge">
<title>layer_1_exp_res&#45;&gt;layer_1_output</title>
<path fill="none" stroke="black" d="M9456.72,-5540.43C9456.72,-5532.61 9456.72,-5523.75 9456.72,-5514.99"/>
<polygon fill="black" stroke="black" points="9460.22,-5514.82 9456.72,-5504.82 9453.22,-5514.82 9460.22,-5514.82"/>
</g>
<!-- layer_2_input -->
<g id="node80" class="node">
<title>layer_2_input</title>
<ellipse fill="lightgreen" stroke="black" cx="9456.72" cy="-5356.24" rx="219.82" ry="37.45"/>
<text text-anchor="middle" x="9456.72" y="-5367.54" font-family="Times,serif" font-size="14.00">Layer 2 Input</text>
<text text-anchor="middle" x="9456.72" y="-5352.54" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9456.72" y="-5337.54" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_1_output&#45;&gt;layer_2_input -->
<g id="edge163" class="edge">
<title>layer_1_output&#45;&gt;layer_2_input</title>
<path fill="none" stroke="black" d="M9456.72,-5429.61C9456.72,-5421.44 9456.72,-5412.66 9456.72,-5404.13"/>
<polygon fill="black" stroke="black" points="9460.22,-5403.92 9456.72,-5393.92 9453.22,-5403.92 9460.22,-5403.92"/>
</g>
<!-- layer_2_mha_norm -->
<g id="node81" class="node">
<title>layer_2_mha_norm</title>
<polygon fill="lightcoral" stroke="black" points="9356.22,-5282.77 9045.22,-5282.77 9045.22,-5229.77 9356.22,-5229.77 9356.22,-5282.77"/>
<text text-anchor="middle" x="9200.72" y="-5267.57" font-family="Times,serif" font-size="14.00">MHA LayerNorm 2</text>
<text text-anchor="middle" x="9200.72" y="-5252.57" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9200.72" y="-5237.57" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_2_input&#45;&gt;layer_2_mha_norm -->
<g id="edge164" class="edge">
<title>layer_2_input&#45;&gt;layer_2_mha_norm</title>
<path fill="none" stroke="black" d="M9369.33,-5321.8C9339.4,-5310.34 9306.16,-5297.62 9277.17,-5286.53"/>
<polygon fill="black" stroke="black" points="9278.1,-5283.13 9267.5,-5282.83 9275.59,-5289.67 9278.1,-5283.13"/>
</g>
<!-- layer_2_mha_res -->
<g id="node87" class="node">
<title>layer_2_mha_res</title>
<polygon fill="lightyellow" stroke="black" points="9637.22,-4926.77 9326.22,-4926.77 9326.22,-4873.77 9637.22,-4873.77 9637.22,-4926.77"/>
<text text-anchor="middle" x="9481.72" y="-4911.57" font-family="Times,serif" font-size="14.00">MHA Residual 2</text>
<text text-anchor="middle" x="9481.72" y="-4896.57" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9481.72" y="-4881.57" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_2_input&#45;&gt;layer_2_mha_res -->
<g id="edge173" class="edge">
<title>layer_2_input&#45;&gt;layer_2_mha_res</title>
<path fill="none" stroke="black" d="M9501.11,-5319.44C9538.43,-5285.04 9585.72,-5229.39 9585.72,-5168.27 9585.72,-5168.27 9585.72,-5168.27 9585.72,-5077.27 9585.72,-5024.55 9583.06,-5007.22 9554.72,-4962.77 9547.83,-4951.96 9538.44,-4942.07 9528.69,-4933.53"/>
<polygon fill="black" stroke="black" points="9530.76,-4930.7 9520.84,-4926.98 9526.27,-4936.07 9530.76,-4930.7"/>
</g>
<!-- layer_2_mha_q -->
<g id="node82" class="node">
<title>layer_2_mha_q</title>
<polygon fill="lightblue" stroke="black" points="8899.22,-5193.77 8588.22,-5193.77 8588.22,-5140.77 8899.22,-5140.77 8899.22,-5193.77"/>
<text text-anchor="middle" x="8743.72" y="-5178.57" font-family="Times,serif" font-size="14.00">MHA Q Proj 2</text>
<text text-anchor="middle" x="8743.72" y="-5163.57" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="8743.72" y="-5148.57" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_2_mha_norm&#45;&gt;layer_2_mha_q -->
<g id="edge165" class="edge">
<title>layer_2_mha_norm&#45;&gt;layer_2_mha_q</title>
<path fill="none" stroke="black" d="M9066.69,-5229.75C9010.42,-5219.04 8944.88,-5206.56 8887.6,-5195.66"/>
<polygon fill="black" stroke="black" points="8888.22,-5192.21 8877.74,-5193.78 8886.91,-5199.09 8888.22,-5192.21"/>
</g>
<!-- layer_2_mha_k -->
<g id="node83" class="node">
<title>layer_2_mha_k</title>
<polygon fill="lightblue" stroke="black" points="9228.22,-5193.77 8917.22,-5193.77 8917.22,-5140.77 9228.22,-5140.77 9228.22,-5193.77"/>
<text text-anchor="middle" x="9072.72" y="-5178.57" font-family="Times,serif" font-size="14.00">MHA K Proj 2</text>
<text text-anchor="middle" x="9072.72" y="-5163.57" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9072.72" y="-5148.57" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_2_mha_norm&#45;&gt;layer_2_mha_k -->
<g id="edge166" class="edge">
<title>layer_2_mha_norm&#45;&gt;layer_2_mha_k</title>
<path fill="none" stroke="black" d="M9163,-5229.63C9149.2,-5220.25 9133.41,-5209.52 9118.94,-5199.69"/>
<polygon fill="black" stroke="black" points="9120.84,-5196.74 9110.6,-5194.02 9116.9,-5202.53 9120.84,-5196.74"/>
</g>
<!-- layer_2_mha_v -->
<g id="node84" class="node">
<title>layer_2_mha_v</title>
<polygon fill="lightblue" stroke="black" points="9557.22,-5193.77 9246.22,-5193.77 9246.22,-5140.77 9557.22,-5140.77 9557.22,-5193.77"/>
<text text-anchor="middle" x="9401.72" y="-5178.57" font-family="Times,serif" font-size="14.00">MHA V Proj 2</text>
<text text-anchor="middle" x="9401.72" y="-5163.57" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9401.72" y="-5148.57" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_2_mha_norm&#45;&gt;layer_2_mha_v -->
<g id="edge167" class="edge">
<title>layer_2_mha_norm&#45;&gt;layer_2_mha_v</title>
<path fill="none" stroke="black" d="M9259.67,-5229.75C9282.78,-5219.75 9309.45,-5208.2 9333.39,-5197.84"/>
<polygon fill="black" stroke="black" points="9334.98,-5200.97 9342.77,-5193.78 9332.2,-5194.54 9334.98,-5200.97"/>
</g>
<!-- layer_2_mha_attn -->
<g id="node85" class="node">
<title>layer_2_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="9405.72,-5104.77 9043.72,-5104.77 9043.72,-5051.77 9405.72,-5051.77 9405.72,-5104.77"/>
<text text-anchor="middle" x="9224.72" y="-5089.57" font-family="Times,serif" font-size="14.00">MHA 2</text>
<text text-anchor="middle" x="9224.72" y="-5074.57" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, heads=16, dim=512]</text>
<text text-anchor="middle" x="9224.72" y="-5059.57" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_2_mha_q&#45;&gt;layer_2_mha_attn -->
<g id="edge168" class="edge">
<title>layer_2_mha_q&#45;&gt;layer_2_mha_attn</title>
<path fill="none" stroke="black" d="M8884.78,-5140.75C8944.13,-5130.02 9013.28,-5117.51 9073.65,-5106.59"/>
<polygon fill="black" stroke="black" points="9074.44,-5110.01 9083.65,-5104.78 9073.19,-5103.12 9074.44,-5110.01"/>
</g>
<!-- layer_2_mha_k&#45;&gt;layer_2_mha_attn -->
<g id="edge169" class="edge">
<title>layer_2_mha_k&#45;&gt;layer_2_mha_attn</title>
<path fill="none" stroke="black" d="M9117.5,-5140.63C9134.28,-5131.03 9153.51,-5120.02 9171.02,-5110"/>
<polygon fill="black" stroke="black" points="9173.05,-5112.87 9179.99,-5104.87 9169.57,-5106.8 9173.05,-5112.87"/>
</g>
<!-- layer_2_mha_v&#45;&gt;layer_2_mha_attn -->
<g id="edge170" class="edge">
<title>layer_2_mha_v&#45;&gt;layer_2_mha_attn</title>
<path fill="none" stroke="black" d="M9349.57,-5140.63C9329.58,-5130.81 9306.6,-5119.52 9285.85,-5109.31"/>
<polygon fill="black" stroke="black" points="9287.32,-5106.14 9276.8,-5104.87 9284.23,-5112.42 9287.32,-5106.14"/>
</g>
<!-- layer_2_mha_o -->
<g id="node86" class="node">
<title>layer_2_mha_o</title>
<polygon fill="lightblue" stroke="black" points="9545.22,-5015.77 9234.22,-5015.77 9234.22,-4962.77 9545.22,-4962.77 9545.22,-5015.77"/>
<text text-anchor="middle" x="9389.72" y="-5000.57" font-family="Times,serif" font-size="14.00">MHA O Proj 2</text>
<text text-anchor="middle" x="9389.72" y="-4985.57" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9389.72" y="-4970.57" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_2_mha_attn&#45;&gt;layer_2_mha_o -->
<g id="edge171" class="edge">
<title>layer_2_mha_attn&#45;&gt;layer_2_mha_o</title>
<path fill="none" stroke="black" d="M9273.33,-5051.63C9291.79,-5041.9 9313,-5030.72 9332.21,-5020.59"/>
<polygon fill="black" stroke="black" points="9333.95,-5023.63 9341.17,-5015.87 9330.69,-5017.43 9333.95,-5023.63"/>
</g>
<!-- layer_2_mha_o&#45;&gt;layer_2_mha_res -->
<g id="edge172" class="edge">
<title>layer_2_mha_o&#45;&gt;layer_2_mha_res</title>
<path fill="none" stroke="black" d="M9416.82,-4962.63C9426.28,-4953.69 9437.03,-4943.52 9447.03,-4934.07"/>
<polygon fill="black" stroke="black" points="9449.63,-4936.43 9454.49,-4927.02 9444.82,-4931.34 9449.63,-4936.43"/>
</g>
<!-- layer_2_exp_norm -->
<g id="node88" class="node">
<title>layer_2_exp_norm</title>
<polygon fill="lightcoral" stroke="black" points="7041.22,-4837.77 6730.22,-4837.77 6730.22,-4784.77 7041.22,-4784.77 7041.22,-4837.77"/>
<text text-anchor="middle" x="6885.72" y="-4822.57" font-family="Times,serif" font-size="14.00">Expert Norm 2</text>
<text text-anchor="middle" x="6885.72" y="-4807.57" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="6885.72" y="-4792.57" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_2_mha_res&#45;&gt;layer_2_exp_norm -->
<g id="edge174" class="edge">
<title>layer_2_mha_res&#45;&gt;layer_2_exp_norm</title>
<path fill="none" stroke="black" d="M9326.14,-4894.05C8867.49,-4878.68 7523.45,-4833.64 7051.7,-4817.83"/>
<polygon fill="black" stroke="black" points="7051.51,-4814.32 7041.4,-4817.48 7051.28,-4821.32 7051.51,-4814.32"/>
</g>
<!-- layer_2_exp_res -->
<g id="node156" class="node">
<title>layer_2_exp_res</title>
<polygon fill="lightyellow" stroke="black" points="9468.22,-3807.77 9157.22,-3807.77 9157.22,-3754.77 9468.22,-3754.77 9468.22,-3807.77"/>
<text text-anchor="middle" x="9312.72" y="-3792.57" font-family="Times,serif" font-size="14.00">Expert Residual 2</text>
<text text-anchor="middle" x="9312.72" y="-3777.57" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9312.72" y="-3762.57" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_2_mha_res&#45;&gt;layer_2_exp_res -->
<g id="edge195" class="edge">
<title>layer_2_mha_res&#45;&gt;layer_2_exp_res</title>
<path fill="none" stroke="black" d="M9637.36,-4895.33C10197.64,-4880.13 12078.72,-4819.93 12078.72,-4696.77 12078.72,-4696.77 12078.72,-4696.77 12078.72,-4037.77 12078.72,-4013.16 12079.35,-4000.6 12059.72,-3985.77 11853.78,-3830.11 10040.99,-3792.26 9478.46,-3784.22"/>
<polygon fill="black" stroke="black" points="9478.29,-3780.72 9468.24,-3784.08 9478.19,-3787.72 9478.29,-3780.72"/>
</g>
<!-- layer_2_global_gate -->
<g id="node89" class="node">
<title>layer_2_global_gate</title>
<polygon fill="yellow" stroke="black" points="6546.72,-4748.77 6235.72,-4695.77 6546.72,-4642.77 6857.72,-4695.77 6546.72,-4748.77"/>
<text text-anchor="middle" x="6546.72" y="-4707.07" font-family="Times,serif" font-size="14.00">Global Gate 2</text>
<text text-anchor="middle" x="6546.72" y="-4692.07" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="6546.72" y="-4677.07" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_2_exp_norm&#45;&gt;layer_2_global_gate -->
<g id="edge175" class="edge">
<title>layer_2_exp_norm&#45;&gt;layer_2_global_gate</title>
<path fill="none" stroke="black" d="M6809.22,-4784.65C6765.09,-4769.88 6708.8,-4751.03 6659.66,-4734.58"/>
<polygon fill="black" stroke="black" points="6660.53,-4731.18 6649.93,-4731.32 6658.31,-4737.82 6660.53,-4731.18"/>
</g>
<!-- layer_2_token_dist -->
<g id="node90" class="node">
<title>layer_2_token_dist</title>
<polygon fill="orange" stroke="black" points="6869.08,-4606.77 6356.27,-4606.77 6224.36,-4500.77 6737.16,-4500.77 6869.08,-4606.77"/>
<text text-anchor="middle" x="6546.72" y="-4565.07" font-family="Times,serif" font-size="14.00">Token Distribution 2</text>
<text text-anchor="middle" x="6546.72" y="-4550.07" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="6546.72" y="-4535.07" font-family="Times,serif" font-size="14.00">GPU: all to 0&#45;15</text>
</g>
<!-- layer_2_exp_norm&#45;&gt;layer_2_token_dist -->
<g id="edge177" class="edge">
<title>layer_2_exp_norm&#45;&gt;layer_2_token_dist</title>
<path fill="none" stroke="black" d="M6890.84,-4784.73C6896.49,-4748.6 6900.77,-4682.57 6866.72,-4642.77 6856.5,-4630.82 6836.11,-4619.98 6810.34,-4610.3"/>
<polygon fill="black" stroke="black" points="6811.21,-4606.89 6800.61,-4606.79 6808.83,-4613.47 6811.21,-4606.89"/>
</g>
<!-- layer_2_global_gate&#45;&gt;layer_2_token_dist -->
<g id="edge176" class="edge">
<title>layer_2_global_gate&#45;&gt;layer_2_token_dist</title>
<path fill="none" stroke="black" d="M6546.72,-4642.64C6546.72,-4634.35 6546.72,-4625.7 6546.72,-4617.2"/>
<polygon fill="black" stroke="black" points="6550.22,-4616.94 6546.72,-4606.94 6543.22,-4616.94 6550.22,-4616.94"/>
</g>
<!-- layer_2_expert0_recv -->
<g id="node91" class="node">
<title>layer_2_expert0_recv</title>
<polygon fill="lightgreen" stroke="black" points="1025.65,-4464.77 454.67,-4464.77 307.78,-4358.77 878.77,-4358.77 1025.65,-4464.77"/>
<text text-anchor="middle" x="666.72" y="-4423.07" font-family="Times,serif" font-size="14.00">Expert 0 Recv</text>
<text text-anchor="middle" x="666.72" y="-4408.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="666.72" y="-4393.07" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_2_token_dist&#45;&gt;layer_2_expert0_recv -->
<g id="edge99" class="edge">
<title>layer_2_token_dist&#45;&gt;layer_2_expert0_recv</title>
<path fill="none" stroke="black" d="M6289.15,-4552.92C5348,-4552.84 2095.39,-4546.54 1035.08,-4464.85"/>
<polygon fill="black" stroke="black" points="1035.26,-4461.35 1025.02,-4464.06 1034.72,-4468.33 1035.26,-4461.35"/>
</g>
<!-- layer_2_expert1_recv -->
<g id="node95" class="node">
<title>layer_2_expert1_recv</title>
<polygon fill="lightgreen" stroke="black" points="1760.65,-4464.77 1189.67,-4464.77 1042.78,-4358.77 1613.77,-4358.77 1760.65,-4464.77"/>
<text text-anchor="middle" x="1401.72" y="-4423.07" font-family="Times,serif" font-size="14.00">Expert 1 Recv</text>
<text text-anchor="middle" x="1401.72" y="-4408.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="1401.72" y="-4393.07" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_2_token_dist&#45;&gt;layer_2_expert1_recv -->
<g id="edge103" class="edge">
<title>layer_2_token_dist&#45;&gt;layer_2_expert1_recv</title>
<path fill="none" stroke="black" d="M6288.22,-4552.18C5430.07,-4549.57 2679.22,-4535.82 1770.3,-4464.86"/>
<polygon fill="black" stroke="black" points="1770.27,-4461.35 1760.02,-4464.05 1769.72,-4468.33 1770.27,-4461.35"/>
</g>
<!-- layer_2_expert2_recv -->
<g id="node99" class="node">
<title>layer_2_expert2_recv</title>
<polygon fill="lightgreen" stroke="black" points="2495.65,-4464.77 1924.67,-4464.77 1777.78,-4358.77 2348.77,-4358.77 2495.65,-4464.77"/>
<text text-anchor="middle" x="2136.72" y="-4423.07" font-family="Times,serif" font-size="14.00">Expert 2 Recv</text>
<text text-anchor="middle" x="2136.72" y="-4408.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2136.72" y="-4393.07" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_2_token_dist&#45;&gt;layer_2_expert2_recv -->
<g id="edge107" class="edge">
<title>layer_2_token_dist&#45;&gt;layer_2_expert2_recv</title>
<path fill="none" stroke="black" d="M6287.04,-4551.16C5518.68,-4545.76 3263.33,-4525.15 2505.25,-4464.86"/>
<polygon fill="black" stroke="black" points="2505.27,-4461.35 2495.02,-4464.04 2504.71,-4468.33 2505.27,-4461.35"/>
</g>
<!-- layer_2_expert3_recv -->
<g id="node103" class="node">
<title>layer_2_expert3_recv</title>
<polygon fill="lightgreen" stroke="black" points="3230.65,-4464.77 2659.67,-4464.77 2512.78,-4358.77 3083.77,-4358.77 3230.65,-4464.77"/>
<text text-anchor="middle" x="2871.72" y="-4423.07" font-family="Times,serif" font-size="14.00">Expert 3 Recv</text>
<text text-anchor="middle" x="2871.72" y="-4408.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2871.72" y="-4393.07" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_2_token_dist&#45;&gt;layer_2_expert3_recv -->
<g id="edge111" class="edge">
<title>layer_2_token_dist&#45;&gt;layer_2_expert3_recv</title>
<path fill="none" stroke="black" d="M6284.92,-4549.67C5614.84,-4541.12 3848.38,-4514.52 3240.22,-4464.86"/>
<polygon fill="black" stroke="black" points="3240.28,-4461.36 3230.02,-4464.02 3239.7,-4468.33 3240.28,-4461.36"/>
</g>
<!-- layer_2_expert4_recv -->
<g id="node107" class="node">
<title>layer_2_expert4_recv</title>
<polygon fill="lightgreen" stroke="black" points="3965.65,-4464.77 3394.67,-4464.77 3247.78,-4358.77 3818.77,-4358.77 3965.65,-4464.77"/>
<text text-anchor="middle" x="3606.72" y="-4423.07" font-family="Times,serif" font-size="14.00">Expert 4 Recv</text>
<text text-anchor="middle" x="3606.72" y="-4408.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="3606.72" y="-4393.07" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_2_token_dist&#45;&gt;layer_2_expert4_recv -->
<g id="edge115" class="edge">
<title>layer_2_token_dist&#45;&gt;layer_2_expert4_recv</title>
<path fill="none" stroke="black" d="M6289.16,-4553.02C5827.07,-4551.47 4826.72,-4538.98 3974.56,-4464.82"/>
<polygon fill="black" stroke="black" points="3974.81,-4461.33 3964.54,-4463.94 3974.2,-4468.3 3974.81,-4461.33"/>
</g>
<!-- layer_2_expert5_recv -->
<g id="node111" class="node">
<title>layer_2_expert5_recv</title>
<polygon fill="lightgreen" stroke="black" points="4700.65,-4464.77 4129.67,-4464.77 3982.78,-4358.77 4553.77,-4358.77 4700.65,-4464.77"/>
<text text-anchor="middle" x="4341.72" y="-4423.07" font-family="Times,serif" font-size="14.00">Expert 5 Recv</text>
<text text-anchor="middle" x="4341.72" y="-4408.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="4341.72" y="-4393.07" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_2_token_dist&#45;&gt;layer_2_expert5_recv -->
<g id="edge119" class="edge">
<title>layer_2_token_dist&#45;&gt;layer_2_expert5_recv</title>
<path fill="none" stroke="black" d="M6282.89,-4547.83C5927.53,-4539.44 5275.38,-4517.89 4709.54,-4464.82"/>
<polygon fill="black" stroke="black" points="4709.83,-4461.34 4699.55,-4463.88 4709.18,-4468.3 4709.83,-4461.34"/>
</g>
<!-- layer_2_expert6_recv -->
<g id="node115" class="node">
<title>layer_2_expert6_recv</title>
<polygon fill="lightgreen" stroke="black" points="5435.65,-4464.77 4864.67,-4464.77 4717.78,-4358.77 5288.77,-4358.77 5435.65,-4464.77"/>
<text text-anchor="middle" x="5076.72" y="-4423.07" font-family="Times,serif" font-size="14.00">Expert 6 Recv</text>
<text text-anchor="middle" x="5076.72" y="-4408.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5076.72" y="-4393.07" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_2_token_dist&#45;&gt;layer_2_expert6_recv -->
<g id="edge123" class="edge">
<title>layer_2_token_dist&#45;&gt;layer_2_expert6_recv</title>
<path fill="none" stroke="black" d="M6267.19,-4535.21C6046.57,-4520.22 5730.82,-4496.27 5444.73,-4464.86"/>
<polygon fill="black" stroke="black" points="5444.89,-4461.36 5434.56,-4463.74 5444.12,-4468.32 5444.89,-4461.36"/>
</g>
<!-- layer_2_expert7_recv -->
<g id="node119" class="node">
<title>layer_2_expert7_recv</title>
<polygon fill="lightgreen" stroke="black" points="6170.65,-4464.77 5599.67,-4464.77 5452.78,-4358.77 6023.77,-4358.77 6170.65,-4464.77"/>
<text text-anchor="middle" x="5811.72" y="-4423.07" font-family="Times,serif" font-size="14.00">Expert 7 Recv</text>
<text text-anchor="middle" x="5811.72" y="-4408.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5811.72" y="-4393.07" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_2_token_dist&#45;&gt;layer_2_expert7_recv -->
<g id="edge127" class="edge">
<title>layer_2_token_dist&#45;&gt;layer_2_expert7_recv</title>
<path fill="none" stroke="black" d="M6273.55,-4500.74C6215.26,-4489.63 6153.58,-4477.88 6094.92,-4466.71"/>
<polygon fill="black" stroke="black" points="6095.25,-4463.21 6084.78,-4464.78 6093.94,-4470.09 6095.25,-4463.21"/>
</g>
<!-- layer_2_expert8_recv -->
<g id="node123" class="node">
<title>layer_2_expert8_recv</title>
<polygon fill="lightgreen" stroke="black" points="6905.65,-4464.77 6334.67,-4464.77 6187.78,-4358.77 6758.77,-4358.77 6905.65,-4464.77"/>
<text text-anchor="middle" x="6546.72" y="-4423.07" font-family="Times,serif" font-size="14.00">Expert 8 Recv</text>
<text text-anchor="middle" x="6546.72" y="-4408.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="6546.72" y="-4393.07" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_2_token_dist&#45;&gt;layer_2_expert8_recv -->
<g id="edge131" class="edge">
<title>layer_2_token_dist&#45;&gt;layer_2_expert8_recv</title>
<path fill="none" stroke="black" d="M6546.72,-4500.64C6546.72,-4492.35 6546.72,-4483.7 6546.72,-4475.2"/>
<polygon fill="black" stroke="black" points="6550.22,-4474.94 6546.72,-4464.94 6543.22,-4474.94 6550.22,-4474.94"/>
</g>
<!-- layer_2_expert9_recv -->
<g id="node127" class="node">
<title>layer_2_expert9_recv</title>
<polygon fill="lightgreen" stroke="black" points="7640.65,-4464.77 7069.67,-4464.77 6922.78,-4358.77 7493.77,-4358.77 7640.65,-4464.77"/>
<text text-anchor="middle" x="7281.72" y="-4423.07" font-family="Times,serif" font-size="14.00">Expert 9 Recv</text>
<text text-anchor="middle" x="7281.72" y="-4408.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="7281.72" y="-4393.07" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_2_token_dist&#45;&gt;layer_2_expert9_recv -->
<g id="edge135" class="edge">
<title>layer_2_token_dist&#45;&gt;layer_2_expert9_recv</title>
<path fill="none" stroke="black" d="M6753.41,-4513.4C6844.66,-4496.02 6952.37,-4475.5 7046.66,-4457.54"/>
<polygon fill="black" stroke="black" points="7047.45,-4460.95 7056.62,-4455.64 7046.14,-4454.07 7047.45,-4460.95"/>
</g>
<!-- layer_2_expert10_recv -->
<g id="node131" class="node">
<title>layer_2_expert10_recv</title>
<polygon fill="lightgreen" stroke="black" points="8375.65,-4464.77 7804.67,-4464.77 7657.78,-4358.77 8228.77,-4358.77 8375.65,-4464.77"/>
<text text-anchor="middle" x="8016.72" y="-4423.07" font-family="Times,serif" font-size="14.00">Expert 10 Recv</text>
<text text-anchor="middle" x="8016.72" y="-4408.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8016.72" y="-4393.07" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_2_token_dist&#45;&gt;layer_2_expert10_recv -->
<g id="edge139" class="edge">
<title>layer_2_token_dist&#45;&gt;layer_2_expert10_recv</title>
<path fill="none" stroke="black" d="M6783.79,-4538.06C7007.43,-4523.19 7351.86,-4497.72 7649.72,-4464.77 7689.16,-4460.4 7730.89,-4455.12 7771.53,-4449.62"/>
<polygon fill="black" stroke="black" points="7772.12,-4453.08 7781.56,-4448.26 7771.18,-4446.14 7772.12,-4453.08"/>
</g>
<!-- layer_2_expert11_recv -->
<g id="node135" class="node">
<title>layer_2_expert11_recv</title>
<polygon fill="lightgreen" stroke="black" points="9110.65,-4464.77 8539.67,-4464.77 8392.78,-4358.77 8963.77,-4358.77 9110.65,-4464.77"/>
<text text-anchor="middle" x="8751.72" y="-4423.07" font-family="Times,serif" font-size="14.00">Expert 11 Recv</text>
<text text-anchor="middle" x="8751.72" y="-4408.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8751.72" y="-4393.07" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_2_token_dist&#45;&gt;layer_2_expert11_recv -->
<g id="edge143" class="edge">
<title>layer_2_token_dist&#45;&gt;layer_2_expert11_recv</title>
<path fill="none" stroke="black" d="M6796.22,-4548.17C7150.2,-4539.97 7818.2,-4518.35 8384.72,-4464.77 8424.52,-4461 8466.62,-4456 8507.55,-4450.59"/>
<polygon fill="black" stroke="black" points="8508.2,-4454.03 8517.65,-4449.24 8507.28,-4447.09 8508.2,-4454.03"/>
</g>
<!-- layer_2_expert12_recv -->
<g id="node139" class="node">
<title>layer_2_expert12_recv</title>
<polygon fill="lightgreen" stroke="black" points="9845.65,-4464.77 9274.67,-4464.77 9127.78,-4358.77 9698.77,-4358.77 9845.65,-4464.77"/>
<text text-anchor="middle" x="9486.72" y="-4423.07" font-family="Times,serif" font-size="14.00">Expert 12 Recv</text>
<text text-anchor="middle" x="9486.72" y="-4408.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="9486.72" y="-4393.07" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_2_token_dist&#45;&gt;layer_2_expert12_recv -->
<g id="edge147" class="edge">
<title>layer_2_token_dist&#45;&gt;layer_2_expert12_recv</title>
<path fill="none" stroke="black" d="M6802.45,-4553.03C7265.53,-4551.5 8273.46,-4538.98 9119.72,-4464.77 9159.69,-4461.26 9201.97,-4456.38 9243.05,-4451"/>
<polygon fill="black" stroke="black" points="9243.73,-4454.44 9253.19,-4449.66 9242.82,-4447.5 9243.73,-4454.44"/>
</g>
<!-- layer_2_expert13_recv -->
<g id="node143" class="node">
<title>layer_2_expert13_recv</title>
<polygon fill="lightgreen" stroke="black" points="10580.65,-4464.77 10009.67,-4464.77 9862.78,-4358.77 10433.77,-4358.77 10580.65,-4464.77"/>
<text text-anchor="middle" x="10221.72" y="-4423.07" font-family="Times,serif" font-size="14.00">Expert 13 Recv</text>
<text text-anchor="middle" x="10221.72" y="-4408.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10221.72" y="-4393.07" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_2_token_dist&#45;&gt;layer_2_expert13_recv -->
<g id="edge151" class="edge">
<title>layer_2_token_dist&#45;&gt;layer_2_expert13_recv</title>
<path fill="none" stroke="black" d="M6798.47,-4549.79C7464.49,-4541.34 9262.09,-4514.47 9854.72,-4464.77 9894.85,-4461.4 9937.3,-4456.57 9978.53,-4451.2"/>
<polygon fill="black" stroke="black" points="9979.25,-4454.63 9988.7,-4449.86 9978.33,-4447.69 9979.25,-4454.63"/>
</g>
<!-- layer_2_expert14_recv -->
<g id="node147" class="node">
<title>layer_2_expert14_recv</title>
<polygon fill="lightgreen" stroke="black" points="11315.65,-4464.77 10744.67,-4464.77 10597.78,-4358.77 11168.77,-4358.77 11315.65,-4464.77"/>
<text text-anchor="middle" x="10956.72" y="-4423.07" font-family="Times,serif" font-size="14.00">Expert 14 Recv</text>
<text text-anchor="middle" x="10956.72" y="-4408.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10956.72" y="-4393.07" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_2_token_dist&#45;&gt;layer_2_expert14_recv -->
<g id="edge155" class="edge">
<title>layer_2_token_dist&#45;&gt;layer_2_expert14_recv</title>
<path fill="none" stroke="black" d="M6800.26,-4551.2C7566.13,-4545.84 9848.63,-4525.12 10589.72,-4464.77 10629.86,-4461.5 10672.31,-4456.72 10713.54,-4451.36"/>
<polygon fill="black" stroke="black" points="10714.26,-4454.8 10723.72,-4450.03 10713.35,-4447.86 10714.26,-4454.8"/>
</g>
<!-- layer_2_expert15_recv -->
<g id="node151" class="node">
<title>layer_2_expert15_recv</title>
<polygon fill="lightgreen" stroke="black" points="12050.65,-4464.77 11479.67,-4464.77 11332.78,-4358.77 11903.77,-4358.77 12050.65,-4464.77"/>
<text text-anchor="middle" x="11691.72" y="-4423.07" font-family="Times,serif" font-size="14.00">Expert 15 Recv</text>
<text text-anchor="middle" x="11691.72" y="-4408.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="11691.72" y="-4393.07" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_2_token_dist&#45;&gt;layer_2_expert15_recv -->
<g id="edge159" class="edge">
<title>layer_2_token_dist&#45;&gt;layer_2_expert15_recv</title>
<path fill="none" stroke="black" d="M6801.47,-4552.19C7658.57,-4549.6 10433.85,-4535.82 11324.72,-4464.77 11365.1,-4461.55 11407.81,-4456.76 11449.27,-4451.39"/>
<polygon fill="black" stroke="black" points="11449.76,-4454.85 11459.22,-4450.08 11448.85,-4447.91 11449.76,-4454.85"/>
</g>
<!-- layer_2_expert0_gate -->
<g id="node92" class="node">
<title>layer_2_expert0_gate</title>
<polygon fill="yellow" stroke="black" points="666.72,-4322.77 320.72,-4269.77 666.72,-4216.77 1012.72,-4269.77 666.72,-4322.77"/>
<text text-anchor="middle" x="666.72" y="-4281.07" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="666.72" y="-4266.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="666.72" y="-4251.07" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_2_expert0_recv&#45;&gt;layer_2_expert0_gate -->
<g id="edge100" class="edge">
<title>layer_2_expert0_recv&#45;&gt;layer_2_expert0_gate</title>
<path fill="none" stroke="black" d="M666.72,-4358.64C666.72,-4350.35 666.72,-4341.7 666.72,-4333.2"/>
<polygon fill="black" stroke="black" points="670.22,-4332.94 666.72,-4322.94 663.22,-4332.94 670.22,-4332.94"/>
</g>
<!-- layer_2_expert0 -->
<g id="node93" class="node">
<title>layer_2_expert0</title>
<polygon fill="lightpink" stroke="black" points="839.72,-4180.77 493.72,-4180.77 493.72,-4127.77 839.72,-4127.77 839.72,-4180.77"/>
<text text-anchor="middle" x="666.72" y="-4165.57" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="666.72" y="-4150.57" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="666.72" y="-4135.57" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_2_expert0_gate&#45;&gt;layer_2_expert0 -->
<g id="edge101" class="edge">
<title>layer_2_expert0_gate&#45;&gt;layer_2_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M666.72,-4216.67C666.72,-4208 666.72,-4199.18 666.72,-4191.03"/>
<polygon fill="black" stroke="black" points="670.22,-4190.78 666.72,-4180.78 663.22,-4190.78 670.22,-4190.78"/>
</g>
<!-- layer_2_expert0_send -->
<g id="node94" class="node">
<title>layer_2_expert0_send</title>
<polygon fill="lightgreen" stroke="black" points="1025.65,-4091.77 454.67,-4091.77 307.78,-3985.77 878.77,-3985.77 1025.65,-4091.77"/>
<text text-anchor="middle" x="666.72" y="-4050.07" font-family="Times,serif" font-size="14.00">Expert 0 Send</text>
<text text-anchor="middle" x="666.72" y="-4035.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="666.72" y="-4020.07" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_2_expert0&#45;&gt;layer_2_expert0_send -->
<g id="edge102" class="edge">
<title>layer_2_expert0&#45;&gt;layer_2_expert0_send</title>
<path fill="none" stroke="black" d="M666.72,-4127.51C666.72,-4119.81 666.72,-4111.02 666.72,-4102.04"/>
<polygon fill="black" stroke="black" points="670.22,-4101.86 666.72,-4091.86 663.22,-4101.86 670.22,-4101.86"/>
</g>
<!-- layer_2_exp_agg -->
<g id="node155" class="node">
<title>layer_2_exp_agg</title>
<polygon fill="orange" stroke="black" points="6869.08,-3949.77 6356.27,-3949.77 6224.36,-3843.77 6737.16,-3843.77 6869.08,-3949.77"/>
<text text-anchor="middle" x="6546.72" y="-3908.07" font-family="Times,serif" font-size="14.00">Expert Aggregation 2</text>
<text text-anchor="middle" x="6546.72" y="-3893.07" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="6546.72" y="-3878.07" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_2_expert0_send&#45;&gt;layer_2_exp_agg -->
<g id="edge178" class="edge">
<title>layer_2_expert0_send&#45;&gt;layer_2_exp_agg</title>
<path fill="none" stroke="black" d="M899.21,-4000.37C943.75,-3994.47 990.09,-3989.19 1033.72,-3985.77 2071.71,-3904.27 5326.54,-3897.73 6281.09,-3897.61"/>
<polygon fill="black" stroke="black" points="6281.18,-3901.11 6291.18,-3897.61 6281.18,-3894.11 6281.18,-3901.11"/>
</g>
<!-- layer_2_expert1_gate -->
<g id="node96" class="node">
<title>layer_2_expert1_gate</title>
<polygon fill="yellow" stroke="black" points="1401.72,-4322.77 1055.72,-4269.77 1401.72,-4216.77 1747.72,-4269.77 1401.72,-4322.77"/>
<text text-anchor="middle" x="1401.72" y="-4281.07" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="1401.72" y="-4266.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="1401.72" y="-4251.07" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_2_expert1_recv&#45;&gt;layer_2_expert1_gate -->
<g id="edge104" class="edge">
<title>layer_2_expert1_recv&#45;&gt;layer_2_expert1_gate</title>
<path fill="none" stroke="black" d="M1401.72,-4358.64C1401.72,-4350.35 1401.72,-4341.7 1401.72,-4333.2"/>
<polygon fill="black" stroke="black" points="1405.22,-4332.94 1401.72,-4322.94 1398.22,-4332.94 1405.22,-4332.94"/>
</g>
<!-- layer_2_expert1 -->
<g id="node97" class="node">
<title>layer_2_expert1</title>
<polygon fill="lightpink" stroke="black" points="1574.72,-4180.77 1228.72,-4180.77 1228.72,-4127.77 1574.72,-4127.77 1574.72,-4180.77"/>
<text text-anchor="middle" x="1401.72" y="-4165.57" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1401.72" y="-4150.57" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="1401.72" y="-4135.57" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_2_expert1_gate&#45;&gt;layer_2_expert1 -->
<g id="edge105" class="edge">
<title>layer_2_expert1_gate&#45;&gt;layer_2_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1401.72,-4216.67C1401.72,-4208 1401.72,-4199.18 1401.72,-4191.03"/>
<polygon fill="black" stroke="black" points="1405.22,-4190.78 1401.72,-4180.78 1398.22,-4190.78 1405.22,-4190.78"/>
</g>
<!-- layer_2_expert1_send -->
<g id="node98" class="node">
<title>layer_2_expert1_send</title>
<polygon fill="lightgreen" stroke="black" points="1760.65,-4091.77 1189.67,-4091.77 1042.78,-3985.77 1613.77,-3985.77 1760.65,-4091.77"/>
<text text-anchor="middle" x="1401.72" y="-4050.07" font-family="Times,serif" font-size="14.00">Expert 1 Send</text>
<text text-anchor="middle" x="1401.72" y="-4035.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="1401.72" y="-4020.07" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_2_expert1&#45;&gt;layer_2_expert1_send -->
<g id="edge106" class="edge">
<title>layer_2_expert1&#45;&gt;layer_2_expert1_send</title>
<path fill="none" stroke="black" d="M1401.72,-4127.51C1401.72,-4119.81 1401.72,-4111.02 1401.72,-4102.04"/>
<polygon fill="black" stroke="black" points="1405.22,-4101.86 1401.72,-4091.86 1398.22,-4101.86 1405.22,-4101.86"/>
</g>
<!-- layer_2_expert1_send&#45;&gt;layer_2_exp_agg -->
<g id="edge179" class="edge">
<title>layer_2_expert1_send&#45;&gt;layer_2_exp_agg</title>
<path fill="none" stroke="black" d="M1634.22,-4000.45C1678.75,-3994.55 1725.1,-3989.25 1768.72,-3985.77 2656.1,-3915 5413.21,-3901.04 6281.83,-3898.37"/>
<polygon fill="black" stroke="black" points="6281.97,-3901.87 6291.96,-3898.34 6281.95,-3894.87 6281.97,-3901.87"/>
</g>
<!-- layer_2_expert2_gate -->
<g id="node100" class="node">
<title>layer_2_expert2_gate</title>
<polygon fill="yellow" stroke="black" points="2136.72,-4322.77 1790.72,-4269.77 2136.72,-4216.77 2482.72,-4269.77 2136.72,-4322.77"/>
<text text-anchor="middle" x="2136.72" y="-4281.07" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="2136.72" y="-4266.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2136.72" y="-4251.07" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_2_expert2_recv&#45;&gt;layer_2_expert2_gate -->
<g id="edge108" class="edge">
<title>layer_2_expert2_recv&#45;&gt;layer_2_expert2_gate</title>
<path fill="none" stroke="black" d="M2136.72,-4358.64C2136.72,-4350.35 2136.72,-4341.7 2136.72,-4333.2"/>
<polygon fill="black" stroke="black" points="2140.22,-4332.94 2136.72,-4322.94 2133.22,-4332.94 2140.22,-4332.94"/>
</g>
<!-- layer_2_expert2 -->
<g id="node101" class="node">
<title>layer_2_expert2</title>
<polygon fill="lightpink" stroke="black" points="2309.72,-4180.77 1963.72,-4180.77 1963.72,-4127.77 2309.72,-4127.77 2309.72,-4180.77"/>
<text text-anchor="middle" x="2136.72" y="-4165.57" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2136.72" y="-4150.57" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2136.72" y="-4135.57" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_2_expert2_gate&#45;&gt;layer_2_expert2 -->
<g id="edge109" class="edge">
<title>layer_2_expert2_gate&#45;&gt;layer_2_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2136.72,-4216.67C2136.72,-4208 2136.72,-4199.18 2136.72,-4191.03"/>
<polygon fill="black" stroke="black" points="2140.22,-4190.78 2136.72,-4180.78 2133.22,-4190.78 2140.22,-4190.78"/>
</g>
<!-- layer_2_expert2_send -->
<g id="node102" class="node">
<title>layer_2_expert2_send</title>
<polygon fill="lightgreen" stroke="black" points="2495.65,-4091.77 1924.67,-4091.77 1777.78,-3985.77 2348.77,-3985.77 2495.65,-4091.77"/>
<text text-anchor="middle" x="2136.72" y="-4050.07" font-family="Times,serif" font-size="14.00">Expert 2 Send</text>
<text text-anchor="middle" x="2136.72" y="-4035.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2136.72" y="-4020.07" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_2_expert2&#45;&gt;layer_2_expert2_send -->
<g id="edge110" class="edge">
<title>layer_2_expert2&#45;&gt;layer_2_expert2_send</title>
<path fill="none" stroke="black" d="M2136.72,-4127.51C2136.72,-4119.81 2136.72,-4111.02 2136.72,-4102.04"/>
<polygon fill="black" stroke="black" points="2140.22,-4101.86 2136.72,-4091.86 2133.22,-4101.86 2140.22,-4101.86"/>
</g>
<!-- layer_2_expert2_send&#45;&gt;layer_2_exp_agg -->
<g id="edge180" class="edge">
<title>layer_2_expert2_send&#45;&gt;layer_2_exp_agg</title>
<path fill="none" stroke="black" d="M2369.72,-4000.51C2414.1,-3994.61 2460.26,-3989.31 2503.72,-3985.77 3241.55,-3925.68 5507.27,-3904.87 6282.99,-3899.4"/>
<polygon fill="black" stroke="black" points="6283.2,-3902.9 6293.17,-3899.33 6283.15,-3895.9 6283.2,-3902.9"/>
</g>
<!-- layer_2_expert3_gate -->
<g id="node104" class="node">
<title>layer_2_expert3_gate</title>
<polygon fill="yellow" stroke="black" points="2871.72,-4322.77 2525.72,-4269.77 2871.72,-4216.77 3217.72,-4269.77 2871.72,-4322.77"/>
<text text-anchor="middle" x="2871.72" y="-4281.07" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="2871.72" y="-4266.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2871.72" y="-4251.07" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_2_expert3_recv&#45;&gt;layer_2_expert3_gate -->
<g id="edge112" class="edge">
<title>layer_2_expert3_recv&#45;&gt;layer_2_expert3_gate</title>
<path fill="none" stroke="black" d="M2871.72,-4358.64C2871.72,-4350.35 2871.72,-4341.7 2871.72,-4333.2"/>
<polygon fill="black" stroke="black" points="2875.22,-4332.94 2871.72,-4322.94 2868.22,-4332.94 2875.22,-4332.94"/>
</g>
<!-- layer_2_expert3 -->
<g id="node105" class="node">
<title>layer_2_expert3</title>
<polygon fill="lightpink" stroke="black" points="3044.72,-4180.77 2698.72,-4180.77 2698.72,-4127.77 3044.72,-4127.77 3044.72,-4180.77"/>
<text text-anchor="middle" x="2871.72" y="-4165.57" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2871.72" y="-4150.57" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2871.72" y="-4135.57" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_2_expert3_gate&#45;&gt;layer_2_expert3 -->
<g id="edge113" class="edge">
<title>layer_2_expert3_gate&#45;&gt;layer_2_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2871.72,-4216.67C2871.72,-4208 2871.72,-4199.18 2871.72,-4191.03"/>
<polygon fill="black" stroke="black" points="2875.22,-4190.78 2871.72,-4180.78 2868.22,-4190.78 2875.22,-4190.78"/>
</g>
<!-- layer_2_expert3_send -->
<g id="node106" class="node">
<title>layer_2_expert3_send</title>
<polygon fill="lightgreen" stroke="black" points="3230.65,-4091.77 2659.67,-4091.77 2512.78,-3985.77 3083.77,-3985.77 3230.65,-4091.77"/>
<text text-anchor="middle" x="2871.72" y="-4050.07" font-family="Times,serif" font-size="14.00">Expert 3 Send</text>
<text text-anchor="middle" x="2871.72" y="-4035.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2871.72" y="-4020.07" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_2_expert3&#45;&gt;layer_2_expert3_send -->
<g id="edge114" class="edge">
<title>layer_2_expert3&#45;&gt;layer_2_expert3_send</title>
<path fill="none" stroke="black" d="M2871.72,-4127.51C2871.72,-4119.81 2871.72,-4111.02 2871.72,-4102.04"/>
<polygon fill="black" stroke="black" points="2875.22,-4101.86 2871.72,-4091.86 2868.22,-4101.86 2875.22,-4101.86"/>
</g>
<!-- layer_2_expert3_send&#45;&gt;layer_2_exp_agg -->
<g id="edge181" class="edge">
<title>layer_2_expert3_send&#45;&gt;layer_2_exp_agg</title>
<path fill="none" stroke="black" d="M3104.73,-4000.68C3149.12,-3994.77 3195.27,-3989.41 3238.72,-3985.77 3828.3,-3936.32 5610.54,-3909.47 6284.63,-3900.87"/>
<polygon fill="black" stroke="black" points="6285,-3904.37 6294.96,-3900.74 6284.91,-3897.37 6285,-3904.37"/>
</g>
<!-- layer_2_expert4_gate -->
<g id="node108" class="node">
<title>layer_2_expert4_gate</title>
<polygon fill="yellow" stroke="black" points="3606.72,-4322.77 3260.72,-4269.77 3606.72,-4216.77 3952.72,-4269.77 3606.72,-4322.77"/>
<text text-anchor="middle" x="3606.72" y="-4281.07" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="3606.72" y="-4266.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="3606.72" y="-4251.07" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_2_expert4_recv&#45;&gt;layer_2_expert4_gate -->
<g id="edge116" class="edge">
<title>layer_2_expert4_recv&#45;&gt;layer_2_expert4_gate</title>
<path fill="none" stroke="black" d="M3606.72,-4358.64C3606.72,-4350.35 3606.72,-4341.7 3606.72,-4333.2"/>
<polygon fill="black" stroke="black" points="3610.22,-4332.94 3606.72,-4322.94 3603.22,-4332.94 3610.22,-4332.94"/>
</g>
<!-- layer_2_expert4 -->
<g id="node109" class="node">
<title>layer_2_expert4</title>
<polygon fill="lightpink" stroke="black" points="3779.72,-4180.77 3433.72,-4180.77 3433.72,-4127.77 3779.72,-4127.77 3779.72,-4180.77"/>
<text text-anchor="middle" x="3606.72" y="-4165.57" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3606.72" y="-4150.57" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="3606.72" y="-4135.57" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_2_expert4_gate&#45;&gt;layer_2_expert4 -->
<g id="edge117" class="edge">
<title>layer_2_expert4_gate&#45;&gt;layer_2_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3606.72,-4216.67C3606.72,-4208 3606.72,-4199.18 3606.72,-4191.03"/>
<polygon fill="black" stroke="black" points="3610.22,-4190.78 3606.72,-4180.78 3603.22,-4190.78 3610.22,-4190.78"/>
</g>
<!-- layer_2_expert4_send -->
<g id="node110" class="node">
<title>layer_2_expert4_send</title>
<polygon fill="lightgreen" stroke="black" points="3965.65,-4091.77 3394.67,-4091.77 3247.78,-3985.77 3818.77,-3985.77 3965.65,-4091.77"/>
<text text-anchor="middle" x="3606.72" y="-4050.07" font-family="Times,serif" font-size="14.00">Expert 4 Send</text>
<text text-anchor="middle" x="3606.72" y="-4035.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="3606.72" y="-4020.07" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_2_expert4&#45;&gt;layer_2_expert4_send -->
<g id="edge118" class="edge">
<title>layer_2_expert4&#45;&gt;layer_2_expert4_send</title>
<path fill="none" stroke="black" d="M3606.72,-4127.51C3606.72,-4119.81 3606.72,-4111.02 3606.72,-4102.04"/>
<polygon fill="black" stroke="black" points="3610.22,-4101.86 3606.72,-4091.86 3603.22,-4101.86 3610.22,-4101.86"/>
</g>
<!-- layer_2_expert4_send&#45;&gt;layer_2_exp_agg -->
<g id="edge182" class="edge">
<title>layer_2_expert4_send&#45;&gt;layer_2_exp_agg</title>
<path fill="none" stroke="black" d="M3840.24,-4000.88C3884.48,-3994.97 3930.45,-3989.56 3973.72,-3985.77 4813.78,-3912.1 5813.15,-3899.22 6280.72,-3897.54"/>
<polygon fill="black" stroke="black" points="6281,-3901.04 6290.99,-3897.5 6280.97,-3894.04 6281,-3901.04"/>
</g>
<!-- layer_2_expert5_gate -->
<g id="node112" class="node">
<title>layer_2_expert5_gate</title>
<polygon fill="yellow" stroke="black" points="4341.72,-4322.77 3995.72,-4269.77 4341.72,-4216.77 4687.72,-4269.77 4341.72,-4322.77"/>
<text text-anchor="middle" x="4341.72" y="-4281.07" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="4341.72" y="-4266.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="4341.72" y="-4251.07" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_2_expert5_recv&#45;&gt;layer_2_expert5_gate -->
<g id="edge120" class="edge">
<title>layer_2_expert5_recv&#45;&gt;layer_2_expert5_gate</title>
<path fill="none" stroke="black" d="M4341.72,-4358.64C4341.72,-4350.35 4341.72,-4341.7 4341.72,-4333.2"/>
<polygon fill="black" stroke="black" points="4345.22,-4332.94 4341.72,-4322.94 4338.22,-4332.94 4345.22,-4332.94"/>
</g>
<!-- layer_2_expert5 -->
<g id="node113" class="node">
<title>layer_2_expert5</title>
<polygon fill="lightpink" stroke="black" points="4514.72,-4180.77 4168.72,-4180.77 4168.72,-4127.77 4514.72,-4127.77 4514.72,-4180.77"/>
<text text-anchor="middle" x="4341.72" y="-4165.57" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4341.72" y="-4150.57" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="4341.72" y="-4135.57" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_2_expert5_gate&#45;&gt;layer_2_expert5 -->
<g id="edge121" class="edge">
<title>layer_2_expert5_gate&#45;&gt;layer_2_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4341.72,-4216.67C4341.72,-4208 4341.72,-4199.18 4341.72,-4191.03"/>
<polygon fill="black" stroke="black" points="4345.22,-4190.78 4341.72,-4180.78 4338.22,-4190.78 4345.22,-4190.78"/>
</g>
<!-- layer_2_expert5_send -->
<g id="node114" class="node">
<title>layer_2_expert5_send</title>
<polygon fill="lightgreen" stroke="black" points="4700.65,-4091.77 4129.67,-4091.77 3982.78,-3985.77 4553.77,-3985.77 4700.65,-4091.77"/>
<text text-anchor="middle" x="4341.72" y="-4050.07" font-family="Times,serif" font-size="14.00">Expert 5 Send</text>
<text text-anchor="middle" x="4341.72" y="-4035.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="4341.72" y="-4020.07" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_2_expert5&#45;&gt;layer_2_expert5_send -->
<g id="edge122" class="edge">
<title>layer_2_expert5&#45;&gt;layer_2_expert5_send</title>
<path fill="none" stroke="black" d="M4341.72,-4127.51C4341.72,-4119.81 4341.72,-4111.02 4341.72,-4102.04"/>
<polygon fill="black" stroke="black" points="4345.22,-4101.86 4341.72,-4091.86 4338.22,-4101.86 4345.22,-4101.86"/>
</g>
<!-- layer_2_expert5_send&#45;&gt;layer_2_exp_agg -->
<g id="edge183" class="edge">
<title>layer_2_expert5_send&#45;&gt;layer_2_exp_agg</title>
<path fill="none" stroke="black" d="M4575.78,-4001.29C4619.86,-3995.36 4665.63,-3989.84 4708.72,-3985.77 5269.84,-3932.7 5930.52,-3910.98 6287.02,-3902.61"/>
<polygon fill="black" stroke="black" points="6287.3,-3906.1 6297.22,-3902.37 6287.14,-3899.1 6287.3,-3906.1"/>
</g>
<!-- layer_2_expert6_gate -->
<g id="node116" class="node">
<title>layer_2_expert6_gate</title>
<polygon fill="yellow" stroke="black" points="5076.72,-4322.77 4730.72,-4269.77 5076.72,-4216.77 5422.72,-4269.77 5076.72,-4322.77"/>
<text text-anchor="middle" x="5076.72" y="-4281.07" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="5076.72" y="-4266.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5076.72" y="-4251.07" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_2_expert6_recv&#45;&gt;layer_2_expert6_gate -->
<g id="edge124" class="edge">
<title>layer_2_expert6_recv&#45;&gt;layer_2_expert6_gate</title>
<path fill="none" stroke="black" d="M5076.72,-4358.64C5076.72,-4350.35 5076.72,-4341.7 5076.72,-4333.2"/>
<polygon fill="black" stroke="black" points="5080.22,-4332.94 5076.72,-4322.94 5073.22,-4332.94 5080.22,-4332.94"/>
</g>
<!-- layer_2_expert6 -->
<g id="node117" class="node">
<title>layer_2_expert6</title>
<polygon fill="lightpink" stroke="black" points="5249.72,-4180.77 4903.72,-4180.77 4903.72,-4127.77 5249.72,-4127.77 5249.72,-4180.77"/>
<text text-anchor="middle" x="5076.72" y="-4165.57" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="5076.72" y="-4150.57" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5076.72" y="-4135.57" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_2_expert6_gate&#45;&gt;layer_2_expert6 -->
<g id="edge125" class="edge">
<title>layer_2_expert6_gate&#45;&gt;layer_2_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5076.72,-4216.67C5076.72,-4208 5076.72,-4199.18 5076.72,-4191.03"/>
<polygon fill="black" stroke="black" points="5080.22,-4190.78 5076.72,-4180.78 5073.22,-4190.78 5080.22,-4190.78"/>
</g>
<!-- layer_2_expert6_send -->
<g id="node118" class="node">
<title>layer_2_expert6_send</title>
<polygon fill="lightgreen" stroke="black" points="5435.65,-4091.77 4864.67,-4091.77 4717.78,-3985.77 5288.77,-3985.77 5435.65,-4091.77"/>
<text text-anchor="middle" x="5076.72" y="-4050.07" font-family="Times,serif" font-size="14.00">Expert 6 Send</text>
<text text-anchor="middle" x="5076.72" y="-4035.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5076.72" y="-4020.07" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_2_expert6&#45;&gt;layer_2_expert6_send -->
<g id="edge126" class="edge">
<title>layer_2_expert6&#45;&gt;layer_2_expert6_send</title>
<path fill="none" stroke="black" d="M5076.72,-4127.51C5076.72,-4119.81 5076.72,-4111.02 5076.72,-4102.04"/>
<polygon fill="black" stroke="black" points="5080.22,-4101.86 5076.72,-4091.86 5073.22,-4101.86 5080.22,-4101.86"/>
</g>
<!-- layer_2_expert6_send&#45;&gt;layer_2_exp_agg -->
<g id="edge184" class="edge">
<title>layer_2_expert6_send&#45;&gt;layer_2_exp_agg</title>
<path fill="none" stroke="black" d="M5311.88,-4002.27C5355.64,-3996.29 5401.02,-3990.49 5443.72,-3985.77 5737.07,-3953.31 6075.59,-3928.12 6299.4,-3913.16"/>
<polygon fill="black" stroke="black" points="6299.9,-3916.63 6309.64,-3912.47 6299.43,-3909.65 6299.9,-3916.63"/>
</g>
<!-- layer_2_expert7_gate -->
<g id="node120" class="node">
<title>layer_2_expert7_gate</title>
<polygon fill="yellow" stroke="black" points="5811.72,-4322.77 5465.72,-4269.77 5811.72,-4216.77 6157.72,-4269.77 5811.72,-4322.77"/>
<text text-anchor="middle" x="5811.72" y="-4281.07" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="5811.72" y="-4266.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5811.72" y="-4251.07" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_2_expert7_recv&#45;&gt;layer_2_expert7_gate -->
<g id="edge128" class="edge">
<title>layer_2_expert7_recv&#45;&gt;layer_2_expert7_gate</title>
<path fill="none" stroke="black" d="M5811.72,-4358.64C5811.72,-4350.35 5811.72,-4341.7 5811.72,-4333.2"/>
<polygon fill="black" stroke="black" points="5815.22,-4332.94 5811.72,-4322.94 5808.22,-4332.94 5815.22,-4332.94"/>
</g>
<!-- layer_2_expert7 -->
<g id="node121" class="node">
<title>layer_2_expert7</title>
<polygon fill="lightpink" stroke="black" points="5984.72,-4180.77 5638.72,-4180.77 5638.72,-4127.77 5984.72,-4127.77 5984.72,-4180.77"/>
<text text-anchor="middle" x="5811.72" y="-4165.57" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5811.72" y="-4150.57" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5811.72" y="-4135.57" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_2_expert7_gate&#45;&gt;layer_2_expert7 -->
<g id="edge129" class="edge">
<title>layer_2_expert7_gate&#45;&gt;layer_2_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5811.72,-4216.67C5811.72,-4208 5811.72,-4199.18 5811.72,-4191.03"/>
<polygon fill="black" stroke="black" points="5815.22,-4190.78 5811.72,-4180.78 5808.22,-4190.78 5815.22,-4190.78"/>
</g>
<!-- layer_2_expert7_send -->
<g id="node122" class="node">
<title>layer_2_expert7_send</title>
<polygon fill="lightgreen" stroke="black" points="6170.65,-4091.77 5599.67,-4091.77 5452.78,-3985.77 6023.77,-3985.77 6170.65,-4091.77"/>
<text text-anchor="middle" x="5811.72" y="-4050.07" font-family="Times,serif" font-size="14.00">Expert 7 Send</text>
<text text-anchor="middle" x="5811.72" y="-4035.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5811.72" y="-4020.07" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_2_expert7&#45;&gt;layer_2_expert7_send -->
<g id="edge130" class="edge">
<title>layer_2_expert7&#45;&gt;layer_2_expert7_send</title>
<path fill="none" stroke="black" d="M5811.72,-4127.51C5811.72,-4119.81 5811.72,-4111.02 5811.72,-4102.04"/>
<polygon fill="black" stroke="black" points="5815.22,-4101.86 5811.72,-4091.86 5808.22,-4101.86 5815.22,-4101.86"/>
</g>
<!-- layer_2_expert7_send&#45;&gt;layer_2_exp_agg -->
<g id="edge185" class="edge">
<title>layer_2_expert7_send&#45;&gt;layer_2_exp_agg</title>
<path fill="none" stroke="black" d="M6036.74,-3994.91C6130.09,-3977.12 6237.97,-3956.58 6330.39,-3938.97"/>
<polygon fill="black" stroke="black" points="6331.27,-3942.37 6340.43,-3937.06 6329.96,-3935.49 6331.27,-3942.37"/>
</g>
<!-- layer_2_expert8_gate -->
<g id="node124" class="node">
<title>layer_2_expert8_gate</title>
<polygon fill="yellow" stroke="black" points="6546.72,-4322.77 6200.72,-4269.77 6546.72,-4216.77 6892.72,-4269.77 6546.72,-4322.77"/>
<text text-anchor="middle" x="6546.72" y="-4281.07" font-family="Times,serif" font-size="14.00">Expert 8 Gate</text>
<text text-anchor="middle" x="6546.72" y="-4266.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="6546.72" y="-4251.07" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_2_expert8_recv&#45;&gt;layer_2_expert8_gate -->
<g id="edge132" class="edge">
<title>layer_2_expert8_recv&#45;&gt;layer_2_expert8_gate</title>
<path fill="none" stroke="black" d="M6546.72,-4358.64C6546.72,-4350.35 6546.72,-4341.7 6546.72,-4333.2"/>
<polygon fill="black" stroke="black" points="6550.22,-4332.94 6546.72,-4322.94 6543.22,-4332.94 6550.22,-4332.94"/>
</g>
<!-- layer_2_expert8 -->
<g id="node125" class="node">
<title>layer_2_expert8</title>
<polygon fill="lightpink" stroke="black" points="6719.72,-4180.77 6373.72,-4180.77 6373.72,-4127.77 6719.72,-4127.77 6719.72,-4180.77"/>
<text text-anchor="middle" x="6546.72" y="-4165.57" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="6546.72" y="-4150.57" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="6546.72" y="-4135.57" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_2_expert8_gate&#45;&gt;layer_2_expert8 -->
<g id="edge133" class="edge">
<title>layer_2_expert8_gate&#45;&gt;layer_2_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6546.72,-4216.67C6546.72,-4208 6546.72,-4199.18 6546.72,-4191.03"/>
<polygon fill="black" stroke="black" points="6550.22,-4190.78 6546.72,-4180.78 6543.22,-4190.78 6550.22,-4190.78"/>
</g>
<!-- layer_2_expert8_send -->
<g id="node126" class="node">
<title>layer_2_expert8_send</title>
<polygon fill="lightgreen" stroke="black" points="6905.65,-4091.77 6334.67,-4091.77 6187.78,-3985.77 6758.77,-3985.77 6905.65,-4091.77"/>
<text text-anchor="middle" x="6546.72" y="-4050.07" font-family="Times,serif" font-size="14.00">Expert 8 Send</text>
<text text-anchor="middle" x="6546.72" y="-4035.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="6546.72" y="-4020.07" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_2_expert8&#45;&gt;layer_2_expert8_send -->
<g id="edge134" class="edge">
<title>layer_2_expert8&#45;&gt;layer_2_expert8_send</title>
<path fill="none" stroke="black" d="M6546.72,-4127.51C6546.72,-4119.81 6546.72,-4111.02 6546.72,-4102.04"/>
<polygon fill="black" stroke="black" points="6550.22,-4101.86 6546.72,-4091.86 6543.22,-4101.86 6550.22,-4101.86"/>
</g>
<!-- layer_2_expert8_send&#45;&gt;layer_2_exp_agg -->
<g id="edge186" class="edge">
<title>layer_2_expert8_send&#45;&gt;layer_2_exp_agg</title>
<path fill="none" stroke="black" d="M6546.72,-3985.64C6546.72,-3977.35 6546.72,-3968.7 6546.72,-3960.2"/>
<polygon fill="black" stroke="black" points="6550.22,-3959.94 6546.72,-3949.94 6543.22,-3959.94 6550.22,-3959.94"/>
</g>
<!-- layer_2_expert9_gate -->
<g id="node128" class="node">
<title>layer_2_expert9_gate</title>
<polygon fill="yellow" stroke="black" points="7281.72,-4322.77 6935.72,-4269.77 7281.72,-4216.77 7627.72,-4269.77 7281.72,-4322.77"/>
<text text-anchor="middle" x="7281.72" y="-4281.07" font-family="Times,serif" font-size="14.00">Expert 9 Gate</text>
<text text-anchor="middle" x="7281.72" y="-4266.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="7281.72" y="-4251.07" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_2_expert9_recv&#45;&gt;layer_2_expert9_gate -->
<g id="edge136" class="edge">
<title>layer_2_expert9_recv&#45;&gt;layer_2_expert9_gate</title>
<path fill="none" stroke="black" d="M7281.72,-4358.64C7281.72,-4350.35 7281.72,-4341.7 7281.72,-4333.2"/>
<polygon fill="black" stroke="black" points="7285.22,-4332.94 7281.72,-4322.94 7278.22,-4332.94 7285.22,-4332.94"/>
</g>
<!-- layer_2_expert9 -->
<g id="node129" class="node">
<title>layer_2_expert9</title>
<polygon fill="lightpink" stroke="black" points="7454.72,-4180.77 7108.72,-4180.77 7108.72,-4127.77 7454.72,-4127.77 7454.72,-4180.77"/>
<text text-anchor="middle" x="7281.72" y="-4165.57" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="7281.72" y="-4150.57" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="7281.72" y="-4135.57" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_2_expert9_gate&#45;&gt;layer_2_expert9 -->
<g id="edge137" class="edge">
<title>layer_2_expert9_gate&#45;&gt;layer_2_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7281.72,-4216.67C7281.72,-4208 7281.72,-4199.18 7281.72,-4191.03"/>
<polygon fill="black" stroke="black" points="7285.22,-4190.78 7281.72,-4180.78 7278.22,-4190.78 7285.22,-4190.78"/>
</g>
<!-- layer_2_expert9_send -->
<g id="node130" class="node">
<title>layer_2_expert9_send</title>
<polygon fill="lightgreen" stroke="black" points="7640.65,-4091.77 7069.67,-4091.77 6922.78,-3985.77 7493.77,-3985.77 7640.65,-4091.77"/>
<text text-anchor="middle" x="7281.72" y="-4050.07" font-family="Times,serif" font-size="14.00">Expert 9 Send</text>
<text text-anchor="middle" x="7281.72" y="-4035.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="7281.72" y="-4020.07" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_2_expert9&#45;&gt;layer_2_expert9_send -->
<g id="edge138" class="edge">
<title>layer_2_expert9&#45;&gt;layer_2_expert9_send</title>
<path fill="none" stroke="black" d="M7281.72,-4127.51C7281.72,-4119.81 7281.72,-4111.02 7281.72,-4102.04"/>
<polygon fill="black" stroke="black" points="7285.22,-4101.86 7281.72,-4091.86 7278.22,-4101.86 7285.22,-4101.86"/>
</g>
<!-- layer_2_expert9_send&#45;&gt;layer_2_exp_agg -->
<g id="edge187" class="edge">
<title>layer_2_expert9_send&#45;&gt;layer_2_exp_agg</title>
<path fill="none" stroke="black" d="M7008.55,-3985.74C6950.26,-3974.63 6888.58,-3962.88 6829.92,-3951.71"/>
<polygon fill="black" stroke="black" points="6830.25,-3948.21 6819.78,-3949.78 6828.94,-3955.09 6830.25,-3948.21"/>
</g>
<!-- layer_2_expert10_gate -->
<g id="node132" class="node">
<title>layer_2_expert10_gate</title>
<polygon fill="yellow" stroke="black" points="8016.72,-4322.77 7670.72,-4269.77 8016.72,-4216.77 8362.72,-4269.77 8016.72,-4322.77"/>
<text text-anchor="middle" x="8016.72" y="-4281.07" font-family="Times,serif" font-size="14.00">Expert 10 Gate</text>
<text text-anchor="middle" x="8016.72" y="-4266.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8016.72" y="-4251.07" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_2_expert10_recv&#45;&gt;layer_2_expert10_gate -->
<g id="edge140" class="edge">
<title>layer_2_expert10_recv&#45;&gt;layer_2_expert10_gate</title>
<path fill="none" stroke="black" d="M8016.72,-4358.64C8016.72,-4350.35 8016.72,-4341.7 8016.72,-4333.2"/>
<polygon fill="black" stroke="black" points="8020.22,-4332.94 8016.72,-4322.94 8013.22,-4332.94 8020.22,-4332.94"/>
</g>
<!-- layer_2_expert10 -->
<g id="node133" class="node">
<title>layer_2_expert10</title>
<polygon fill="lightpink" stroke="black" points="8189.72,-4180.77 7843.72,-4180.77 7843.72,-4127.77 8189.72,-4127.77 8189.72,-4180.77"/>
<text text-anchor="middle" x="8016.72" y="-4165.57" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="8016.72" y="-4150.57" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8016.72" y="-4135.57" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_2_expert10_gate&#45;&gt;layer_2_expert10 -->
<g id="edge141" class="edge">
<title>layer_2_expert10_gate&#45;&gt;layer_2_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8016.72,-4216.67C8016.72,-4208 8016.72,-4199.18 8016.72,-4191.03"/>
<polygon fill="black" stroke="black" points="8020.22,-4190.78 8016.72,-4180.78 8013.22,-4190.78 8020.22,-4190.78"/>
</g>
<!-- layer_2_expert10_send -->
<g id="node134" class="node">
<title>layer_2_expert10_send</title>
<polygon fill="lightgreen" stroke="black" points="8375.65,-4091.77 7804.67,-4091.77 7657.78,-3985.77 8228.77,-3985.77 8375.65,-4091.77"/>
<text text-anchor="middle" x="8016.72" y="-4050.07" font-family="Times,serif" font-size="14.00">Expert 10 Send</text>
<text text-anchor="middle" x="8016.72" y="-4035.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8016.72" y="-4020.07" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_2_expert10&#45;&gt;layer_2_expert10_send -->
<g id="edge142" class="edge">
<title>layer_2_expert10&#45;&gt;layer_2_expert10_send</title>
<path fill="none" stroke="black" d="M8016.72,-4127.51C8016.72,-4119.81 8016.72,-4111.02 8016.72,-4102.04"/>
<polygon fill="black" stroke="black" points="8020.22,-4101.86 8016.72,-4091.86 8013.22,-4101.86 8020.22,-4101.86"/>
</g>
<!-- layer_2_expert10_send&#45;&gt;layer_2_exp_agg -->
<g id="edge188" class="edge">
<title>layer_2_expert10_send&#45;&gt;layer_2_exp_agg</title>
<path fill="none" stroke="black" d="M7658.87,-3986.79C7655.81,-3986.44 7652.75,-3986.1 7649.72,-3985.77 7374.35,-3955.3 7059.17,-3931.23 6836.44,-3916.02"/>
<polygon fill="black" stroke="black" points="6836.46,-3912.52 6826.24,-3915.33 6835.98,-3919.5 6836.46,-3912.52"/>
</g>
<!-- layer_2_expert11_gate -->
<g id="node136" class="node">
<title>layer_2_expert11_gate</title>
<polygon fill="yellow" stroke="black" points="8751.72,-4322.77 8405.72,-4269.77 8751.72,-4216.77 9097.72,-4269.77 8751.72,-4322.77"/>
<text text-anchor="middle" x="8751.72" y="-4281.07" font-family="Times,serif" font-size="14.00">Expert 11 Gate</text>
<text text-anchor="middle" x="8751.72" y="-4266.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8751.72" y="-4251.07" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_2_expert11_recv&#45;&gt;layer_2_expert11_gate -->
<g id="edge144" class="edge">
<title>layer_2_expert11_recv&#45;&gt;layer_2_expert11_gate</title>
<path fill="none" stroke="black" d="M8751.72,-4358.64C8751.72,-4350.35 8751.72,-4341.7 8751.72,-4333.2"/>
<polygon fill="black" stroke="black" points="8755.22,-4332.94 8751.72,-4322.94 8748.22,-4332.94 8755.22,-4332.94"/>
</g>
<!-- layer_2_expert11 -->
<g id="node137" class="node">
<title>layer_2_expert11</title>
<polygon fill="lightpink" stroke="black" points="8924.72,-4180.77 8578.72,-4180.77 8578.72,-4127.77 8924.72,-4127.77 8924.72,-4180.77"/>
<text text-anchor="middle" x="8751.72" y="-4165.57" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="8751.72" y="-4150.57" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8751.72" y="-4135.57" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_2_expert11_gate&#45;&gt;layer_2_expert11 -->
<g id="edge145" class="edge">
<title>layer_2_expert11_gate&#45;&gt;layer_2_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8751.72,-4216.67C8751.72,-4208 8751.72,-4199.18 8751.72,-4191.03"/>
<polygon fill="black" stroke="black" points="8755.22,-4190.78 8751.72,-4180.78 8748.22,-4190.78 8755.22,-4190.78"/>
</g>
<!-- layer_2_expert11_send -->
<g id="node138" class="node">
<title>layer_2_expert11_send</title>
<polygon fill="lightgreen" stroke="black" points="9110.65,-4091.77 8539.67,-4091.77 8392.78,-3985.77 8963.77,-3985.77 9110.65,-4091.77"/>
<text text-anchor="middle" x="8751.72" y="-4050.07" font-family="Times,serif" font-size="14.00">Expert 11 Send</text>
<text text-anchor="middle" x="8751.72" y="-4035.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8751.72" y="-4020.07" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_2_expert11&#45;&gt;layer_2_expert11_send -->
<g id="edge146" class="edge">
<title>layer_2_expert11&#45;&gt;layer_2_expert11_send</title>
<path fill="none" stroke="black" d="M8751.72,-4127.51C8751.72,-4119.81 8751.72,-4111.02 8751.72,-4102.04"/>
<polygon fill="black" stroke="black" points="8755.22,-4101.86 8751.72,-4091.86 8748.22,-4101.86 8755.22,-4101.86"/>
</g>
<!-- layer_2_expert11_send&#45;&gt;layer_2_exp_agg -->
<g id="edge189" class="edge">
<title>layer_2_expert11_send&#45;&gt;layer_2_exp_agg</title>
<path fill="none" stroke="black" d="M8393.88,-3986.65C8390.82,-3986.35 8387.76,-3986.05 8384.72,-3985.77 7830.94,-3933.39 7180.19,-3911.55 6820.57,-3902.94"/>
<polygon fill="black" stroke="black" points="6820.62,-3899.44 6810.54,-3902.7 6820.46,-3906.44 6820.62,-3899.44"/>
</g>
<!-- layer_2_expert12_gate -->
<g id="node140" class="node">
<title>layer_2_expert12_gate</title>
<polygon fill="yellow" stroke="black" points="9486.72,-4322.77 9140.72,-4269.77 9486.72,-4216.77 9832.72,-4269.77 9486.72,-4322.77"/>
<text text-anchor="middle" x="9486.72" y="-4281.07" font-family="Times,serif" font-size="14.00">Expert 12 Gate</text>
<text text-anchor="middle" x="9486.72" y="-4266.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="9486.72" y="-4251.07" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_2_expert12_recv&#45;&gt;layer_2_expert12_gate -->
<g id="edge148" class="edge">
<title>layer_2_expert12_recv&#45;&gt;layer_2_expert12_gate</title>
<path fill="none" stroke="black" d="M9486.72,-4358.64C9486.72,-4350.35 9486.72,-4341.7 9486.72,-4333.2"/>
<polygon fill="black" stroke="black" points="9490.22,-4332.94 9486.72,-4322.94 9483.22,-4332.94 9490.22,-4332.94"/>
</g>
<!-- layer_2_expert12 -->
<g id="node141" class="node">
<title>layer_2_expert12</title>
<polygon fill="lightpink" stroke="black" points="9659.72,-4180.77 9313.72,-4180.77 9313.72,-4127.77 9659.72,-4127.77 9659.72,-4180.77"/>
<text text-anchor="middle" x="9486.72" y="-4165.57" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="9486.72" y="-4150.57" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="9486.72" y="-4135.57" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_2_expert12_gate&#45;&gt;layer_2_expert12 -->
<g id="edge149" class="edge">
<title>layer_2_expert12_gate&#45;&gt;layer_2_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9486.72,-4216.67C9486.72,-4208 9486.72,-4199.18 9486.72,-4191.03"/>
<polygon fill="black" stroke="black" points="9490.22,-4190.78 9486.72,-4180.78 9483.22,-4190.78 9490.22,-4190.78"/>
</g>
<!-- layer_2_expert12_send -->
<g id="node142" class="node">
<title>layer_2_expert12_send</title>
<polygon fill="lightgreen" stroke="black" points="9845.65,-4091.77 9274.67,-4091.77 9127.78,-3985.77 9698.77,-3985.77 9845.65,-4091.77"/>
<text text-anchor="middle" x="9486.72" y="-4050.07" font-family="Times,serif" font-size="14.00">Expert 12 Send</text>
<text text-anchor="middle" x="9486.72" y="-4035.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="9486.72" y="-4020.07" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_2_expert12&#45;&gt;layer_2_expert12_send -->
<g id="edge150" class="edge">
<title>layer_2_expert12&#45;&gt;layer_2_expert12_send</title>
<path fill="none" stroke="black" d="M9486.72,-4127.51C9486.72,-4119.81 9486.72,-4111.02 9486.72,-4102.04"/>
<polygon fill="black" stroke="black" points="9490.22,-4101.86 9486.72,-4091.86 9483.22,-4101.86 9490.22,-4101.86"/>
</g>
<!-- layer_2_expert12_send&#45;&gt;layer_2_exp_agg -->
<g id="edge190" class="edge">
<title>layer_2_expert12_send&#45;&gt;layer_2_exp_agg</title>
<path fill="none" stroke="black" d="M9128.89,-3986.59C9125.82,-3986.31 9122.76,-3986.03 9119.72,-3985.77 8280.76,-3912.2 7282.91,-3899.25 6814.56,-3897.55"/>
<polygon fill="black" stroke="black" points="6814.29,-3894.04 6804.28,-3897.51 6814.27,-3901.04 6814.29,-3894.04"/>
</g>
<!-- layer_2_expert13_gate -->
<g id="node144" class="node">
<title>layer_2_expert13_gate</title>
<polygon fill="yellow" stroke="black" points="10221.72,-4322.77 9875.72,-4269.77 10221.72,-4216.77 10567.72,-4269.77 10221.72,-4322.77"/>
<text text-anchor="middle" x="10221.72" y="-4281.07" font-family="Times,serif" font-size="14.00">Expert 13 Gate</text>
<text text-anchor="middle" x="10221.72" y="-4266.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10221.72" y="-4251.07" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_2_expert13_recv&#45;&gt;layer_2_expert13_gate -->
<g id="edge152" class="edge">
<title>layer_2_expert13_recv&#45;&gt;layer_2_expert13_gate</title>
<path fill="none" stroke="black" d="M10221.72,-4358.64C10221.72,-4350.35 10221.72,-4341.7 10221.72,-4333.2"/>
<polygon fill="black" stroke="black" points="10225.22,-4332.94 10221.72,-4322.94 10218.22,-4332.94 10225.22,-4332.94"/>
</g>
<!-- layer_2_expert13 -->
<g id="node145" class="node">
<title>layer_2_expert13</title>
<polygon fill="lightpink" stroke="black" points="10394.72,-4180.77 10048.72,-4180.77 10048.72,-4127.77 10394.72,-4127.77 10394.72,-4180.77"/>
<text text-anchor="middle" x="10221.72" y="-4165.57" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="10221.72" y="-4150.57" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10221.72" y="-4135.57" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_2_expert13_gate&#45;&gt;layer_2_expert13 -->
<g id="edge153" class="edge">
<title>layer_2_expert13_gate&#45;&gt;layer_2_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10221.72,-4216.67C10221.72,-4208 10221.72,-4199.18 10221.72,-4191.03"/>
<polygon fill="black" stroke="black" points="10225.22,-4190.78 10221.72,-4180.78 10218.22,-4190.78 10225.22,-4190.78"/>
</g>
<!-- layer_2_expert13_send -->
<g id="node146" class="node">
<title>layer_2_expert13_send</title>
<polygon fill="lightgreen" stroke="black" points="10580.65,-4091.77 10009.67,-4091.77 9862.78,-3985.77 10433.77,-3985.77 10580.65,-4091.77"/>
<text text-anchor="middle" x="10221.72" y="-4050.07" font-family="Times,serif" font-size="14.00">Expert 13 Send</text>
<text text-anchor="middle" x="10221.72" y="-4035.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10221.72" y="-4020.07" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_2_expert13&#45;&gt;layer_2_expert13_send -->
<g id="edge154" class="edge">
<title>layer_2_expert13&#45;&gt;layer_2_expert13_send</title>
<path fill="none" stroke="black" d="M10221.72,-4127.51C10221.72,-4119.81 10221.72,-4111.02 10221.72,-4102.04"/>
<polygon fill="black" stroke="black" points="10225.22,-4101.86 10221.72,-4091.86 10218.22,-4101.86 10225.22,-4101.86"/>
</g>
<!-- layer_2_expert13_send&#45;&gt;layer_2_exp_agg -->
<g id="edge191" class="edge">
<title>layer_2_expert13_send&#45;&gt;layer_2_exp_agg</title>
<path fill="none" stroke="black" d="M9863.41,-3986.51C9860.5,-3986.26 9857.6,-3986.01 9854.72,-3985.77 9267.99,-3936.56 7500.19,-3909.74 6818.71,-3901"/>
<polygon fill="black" stroke="black" points="6818.56,-3897.49 6808.51,-3900.87 6818.47,-3904.49 6818.56,-3897.49"/>
</g>
<!-- layer_2_expert14_gate -->
<g id="node148" class="node">
<title>layer_2_expert14_gate</title>
<polygon fill="yellow" stroke="black" points="10956.72,-4322.77 10610.72,-4269.77 10956.72,-4216.77 11302.72,-4269.77 10956.72,-4322.77"/>
<text text-anchor="middle" x="10956.72" y="-4281.07" font-family="Times,serif" font-size="14.00">Expert 14 Gate</text>
<text text-anchor="middle" x="10956.72" y="-4266.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10956.72" y="-4251.07" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_2_expert14_recv&#45;&gt;layer_2_expert14_gate -->
<g id="edge156" class="edge">
<title>layer_2_expert14_recv&#45;&gt;layer_2_expert14_gate</title>
<path fill="none" stroke="black" d="M10956.72,-4358.64C10956.72,-4350.35 10956.72,-4341.7 10956.72,-4333.2"/>
<polygon fill="black" stroke="black" points="10960.22,-4332.94 10956.72,-4322.94 10953.22,-4332.94 10960.22,-4332.94"/>
</g>
<!-- layer_2_expert14 -->
<g id="node149" class="node">
<title>layer_2_expert14</title>
<polygon fill="lightpink" stroke="black" points="11129.72,-4180.77 10783.72,-4180.77 10783.72,-4127.77 11129.72,-4127.77 11129.72,-4180.77"/>
<text text-anchor="middle" x="10956.72" y="-4165.57" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="10956.72" y="-4150.57" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10956.72" y="-4135.57" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_2_expert14_gate&#45;&gt;layer_2_expert14 -->
<g id="edge157" class="edge">
<title>layer_2_expert14_gate&#45;&gt;layer_2_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10956.72,-4216.67C10956.72,-4208 10956.72,-4199.18 10956.72,-4191.03"/>
<polygon fill="black" stroke="black" points="10960.22,-4190.78 10956.72,-4180.78 10953.22,-4190.78 10960.22,-4190.78"/>
</g>
<!-- layer_2_expert14_send -->
<g id="node150" class="node">
<title>layer_2_expert14_send</title>
<polygon fill="lightgreen" stroke="black" points="11315.65,-4091.77 10744.67,-4091.77 10597.78,-3985.77 11168.77,-3985.77 11315.65,-4091.77"/>
<text text-anchor="middle" x="10956.72" y="-4050.07" font-family="Times,serif" font-size="14.00">Expert 14 Send</text>
<text text-anchor="middle" x="10956.72" y="-4035.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10956.72" y="-4020.07" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_2_expert14&#45;&gt;layer_2_expert14_send -->
<g id="edge158" class="edge">
<title>layer_2_expert14&#45;&gt;layer_2_expert14_send</title>
<path fill="none" stroke="black" d="M10956.72,-4127.51C10956.72,-4119.81 10956.72,-4111.02 10956.72,-4102.04"/>
<polygon fill="black" stroke="black" points="10960.22,-4101.86 10956.72,-4091.86 10953.22,-4101.86 10960.22,-4101.86"/>
</g>
<!-- layer_2_expert14_send&#45;&gt;layer_2_exp_agg -->
<g id="edge192" class="edge">
<title>layer_2_expert14_send&#45;&gt;layer_2_exp_agg</title>
<path fill="none" stroke="black" d="M10598.41,-3986.49C10595.5,-3986.24 10592.6,-3986 10589.72,-3985.77 9853.84,-3925.84 7598.19,-3904.98 6816.65,-3899.45"/>
<polygon fill="black" stroke="black" points="6816.42,-3895.95 6806.39,-3899.38 6816.37,-3902.95 6816.42,-3895.95"/>
</g>
<!-- layer_2_expert15_gate -->
<g id="node152" class="node">
<title>layer_2_expert15_gate</title>
<polygon fill="yellow" stroke="black" points="11691.72,-4322.77 11345.72,-4269.77 11691.72,-4216.77 12037.72,-4269.77 11691.72,-4322.77"/>
<text text-anchor="middle" x="11691.72" y="-4281.07" font-family="Times,serif" font-size="14.00">Expert 15 Gate</text>
<text text-anchor="middle" x="11691.72" y="-4266.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="11691.72" y="-4251.07" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_2_expert15_recv&#45;&gt;layer_2_expert15_gate -->
<g id="edge160" class="edge">
<title>layer_2_expert15_recv&#45;&gt;layer_2_expert15_gate</title>
<path fill="none" stroke="black" d="M11691.72,-4358.64C11691.72,-4350.35 11691.72,-4341.7 11691.72,-4333.2"/>
<polygon fill="black" stroke="black" points="11695.22,-4332.94 11691.72,-4322.94 11688.22,-4332.94 11695.22,-4332.94"/>
</g>
<!-- layer_2_expert15 -->
<g id="node153" class="node">
<title>layer_2_expert15</title>
<polygon fill="lightpink" stroke="black" points="11864.72,-4180.77 11518.72,-4180.77 11518.72,-4127.77 11864.72,-4127.77 11864.72,-4180.77"/>
<text text-anchor="middle" x="11691.72" y="-4165.57" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="11691.72" y="-4150.57" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="11691.72" y="-4135.57" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_2_expert15_gate&#45;&gt;layer_2_expert15 -->
<g id="edge161" class="edge">
<title>layer_2_expert15_gate&#45;&gt;layer_2_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11691.72,-4216.67C11691.72,-4208 11691.72,-4199.18 11691.72,-4191.03"/>
<polygon fill="black" stroke="black" points="11695.22,-4190.78 11691.72,-4180.78 11688.22,-4190.78 11695.22,-4190.78"/>
</g>
<!-- layer_2_expert15_send -->
<g id="node154" class="node">
<title>layer_2_expert15_send</title>
<polygon fill="lightgreen" stroke="black" points="12050.65,-4091.77 11479.67,-4091.77 11332.78,-3985.77 11903.77,-3985.77 12050.65,-4091.77"/>
<text text-anchor="middle" x="11691.72" y="-4050.07" font-family="Times,serif" font-size="14.00">Expert 15 Send</text>
<text text-anchor="middle" x="11691.72" y="-4035.07" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="11691.72" y="-4020.07" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_2_expert15&#45;&gt;layer_2_expert15_send -->
<g id="edge162" class="edge">
<title>layer_2_expert15&#45;&gt;layer_2_expert15_send</title>
<path fill="none" stroke="black" d="M11691.72,-4127.51C11691.72,-4119.81 11691.72,-4111.02 11691.72,-4102.04"/>
<polygon fill="black" stroke="black" points="11695.22,-4101.86 11691.72,-4091.86 11688.22,-4101.86 11695.22,-4101.86"/>
</g>
<!-- layer_2_expert15_send&#45;&gt;layer_2_exp_agg -->
<g id="edge193" class="edge">
<title>layer_2_expert15_send&#45;&gt;layer_2_exp_agg</title>
<path fill="none" stroke="black" d="M11333.41,-3986.48C11330.5,-3986.24 11327.6,-3986 11324.72,-3985.77 10438.62,-3915.1 7688.22,-3901.08 6815.39,-3898.39"/>
<polygon fill="black" stroke="black" points="6815.22,-3894.89 6805.21,-3898.35 6815.2,-3901.89 6815.22,-3894.89"/>
</g>
<!-- layer_2_exp_agg&#45;&gt;layer_2_exp_res -->
<g id="edge194" class="edge">
<title>layer_2_exp_agg&#45;&gt;layer_2_exp_res</title>
<path fill="none" stroke="black" d="M6789.76,-3885.79C7341.67,-3863.15 8677.91,-3808.32 9146.77,-3789.08"/>
<polygon fill="black" stroke="black" points="9147.16,-3792.56 9157,-3788.66 9146.87,-3785.57 9147.16,-3792.56"/>
</g>
<!-- layer_2_output -->
<g id="node157" class="node">
<title>layer_2_output</title>
<ellipse fill="lightgreen" stroke="black" cx="9312.72" cy="-3681.29" rx="219.82" ry="37.45"/>
<text text-anchor="middle" x="9312.72" y="-3692.59" font-family="Times,serif" font-size="14.00">Layer 2 Output</text>
<text text-anchor="middle" x="9312.72" y="-3677.59" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9312.72" y="-3662.59" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_2_exp_res&#45;&gt;layer_2_output -->
<g id="edge196" class="edge">
<title>layer_2_exp_res&#45;&gt;layer_2_output</title>
<path fill="none" stroke="black" d="M9312.72,-3754.52C9312.72,-3746.7 9312.72,-3737.85 9312.72,-3729.09"/>
<polygon fill="black" stroke="black" points="9316.22,-3728.91 9312.72,-3718.91 9309.22,-3728.91 9316.22,-3728.91"/>
</g>
<!-- layer_3_input -->
<g id="node158" class="node">
<title>layer_3_input</title>
<ellipse fill="lightgreen" stroke="black" cx="9312.72" cy="-3570.34" rx="219.82" ry="37.45"/>
<text text-anchor="middle" x="9312.72" y="-3581.64" font-family="Times,serif" font-size="14.00">Layer 3 Input</text>
<text text-anchor="middle" x="9312.72" y="-3566.64" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9312.72" y="-3551.64" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_2_output&#45;&gt;layer_3_input -->
<g id="edge261" class="edge">
<title>layer_2_output&#45;&gt;layer_3_input</title>
<path fill="none" stroke="black" d="M9312.72,-3643.71C9312.72,-3635.53 9312.72,-3626.75 9312.72,-3618.23"/>
<polygon fill="black" stroke="black" points="9316.22,-3618.01 9312.72,-3608.01 9309.22,-3618.01 9316.22,-3618.01"/>
</g>
<!-- layer_3_mha_norm -->
<g id="node159" class="node">
<title>layer_3_mha_norm</title>
<polygon fill="lightcoral" stroke="black" points="9376.22,-3496.86 9065.22,-3496.86 9065.22,-3443.86 9376.22,-3443.86 9376.22,-3496.86"/>
<text text-anchor="middle" x="9220.72" y="-3481.66" font-family="Times,serif" font-size="14.00">MHA LayerNorm 3</text>
<text text-anchor="middle" x="9220.72" y="-3466.66" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9220.72" y="-3451.66" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_3_input&#45;&gt;layer_3_mha_norm -->
<g id="edge262" class="edge">
<title>layer_3_input&#45;&gt;layer_3_mha_norm</title>
<path fill="none" stroke="black" d="M9278.72,-3533.13C9269.92,-3523.76 9260.5,-3513.72 9251.85,-3504.52"/>
<polygon fill="black" stroke="black" points="9254.2,-3501.91 9244.81,-3497.02 9249.1,-3506.7 9254.2,-3501.91"/>
</g>
<!-- layer_3_mha_res -->
<g id="node165" class="node">
<title>layer_3_mha_res</title>
<polygon fill="lightyellow" stroke="black" points="9620.22,-3140.86 9309.22,-3140.86 9309.22,-3087.86 9620.22,-3087.86 9620.22,-3140.86"/>
<text text-anchor="middle" x="9464.72" y="-3125.66" font-family="Times,serif" font-size="14.00">MHA Residual 3</text>
<text text-anchor="middle" x="9464.72" y="-3110.66" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9464.72" y="-3095.66" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_3_input&#45;&gt;layer_3_mha_res -->
<g id="edge271" class="edge">
<title>layer_3_input&#45;&gt;layer_3_mha_res</title>
<path fill="none" stroke="black" d="M9420.17,-3537.47C9490.23,-3509.32 9568.72,-3460.37 9568.72,-3382.36 9568.72,-3382.36 9568.72,-3382.36 9568.72,-3291.36 9568.72,-3238.52 9565.15,-3221.4 9536.72,-3176.86 9529.81,-3166.04 9520.41,-3156.09 9510.69,-3147.5"/>
<polygon fill="black" stroke="black" points="9512.76,-3144.67 9502.86,-3140.9 9508.25,-3150.02 9512.76,-3144.67"/>
</g>
<!-- layer_3_mha_q -->
<g id="node160" class="node">
<title>layer_3_mha_q</title>
<polygon fill="lightblue" stroke="black" points="8882.22,-3407.86 8571.22,-3407.86 8571.22,-3354.86 8882.22,-3354.86 8882.22,-3407.86"/>
<text text-anchor="middle" x="8726.72" y="-3392.66" font-family="Times,serif" font-size="14.00">MHA Q Proj 3</text>
<text text-anchor="middle" x="8726.72" y="-3377.66" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="8726.72" y="-3362.66" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_3_mha_norm&#45;&gt;layer_3_mha_q -->
<g id="edge263" class="edge">
<title>layer_3_mha_norm&#45;&gt;layer_3_mha_q</title>
<path fill="none" stroke="black" d="M9075.84,-3443.84C9014.76,-3433.09 8943.58,-3420.55 8881.48,-3409.62"/>
<polygon fill="black" stroke="black" points="8882.05,-3406.16 8871.59,-3407.87 8880.83,-3413.06 8882.05,-3406.16"/>
</g>
<!-- layer_3_mha_k -->
<g id="node161" class="node">
<title>layer_3_mha_k</title>
<polygon fill="lightblue" stroke="black" points="9211.22,-3407.86 8900.22,-3407.86 8900.22,-3354.86 9211.22,-3354.86 9211.22,-3407.86"/>
<text text-anchor="middle" x="9055.72" y="-3392.66" font-family="Times,serif" font-size="14.00">MHA K Proj 3</text>
<text text-anchor="middle" x="9055.72" y="-3377.66" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9055.72" y="-3362.66" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_3_mha_norm&#45;&gt;layer_3_mha_k -->
<g id="edge264" class="edge">
<title>layer_3_mha_norm&#45;&gt;layer_3_mha_k</title>
<path fill="none" stroke="black" d="M9172.1,-3443.73C9153.64,-3433.99 9132.43,-3422.81 9113.22,-3412.68"/>
<polygon fill="black" stroke="black" points="9114.75,-3409.53 9104.27,-3407.96 9111.48,-3415.72 9114.75,-3409.53"/>
</g>
<!-- layer_3_mha_v -->
<g id="node162" class="node">
<title>layer_3_mha_v</title>
<polygon fill="lightblue" stroke="black" points="9540.22,-3407.86 9229.22,-3407.86 9229.22,-3354.86 9540.22,-3354.86 9540.22,-3407.86"/>
<text text-anchor="middle" x="9384.72" y="-3392.66" font-family="Times,serif" font-size="14.00">MHA V Proj 3</text>
<text text-anchor="middle" x="9384.72" y="-3377.66" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9384.72" y="-3362.66" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_3_mha_norm&#45;&gt;layer_3_mha_v -->
<g id="edge265" class="edge">
<title>layer_3_mha_norm&#45;&gt;layer_3_mha_v</title>
<path fill="none" stroke="black" d="M9269.03,-3443.73C9287.39,-3433.99 9308.46,-3422.81 9327.56,-3412.68"/>
<polygon fill="black" stroke="black" points="9329.27,-3415.74 9336.46,-3407.96 9325.99,-3409.55 9329.27,-3415.74"/>
</g>
<!-- layer_3_mha_attn -->
<g id="node163" class="node">
<title>layer_3_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="9388.72,-3318.86 9026.72,-3318.86 9026.72,-3265.86 9388.72,-3265.86 9388.72,-3318.86"/>
<text text-anchor="middle" x="9207.72" y="-3303.66" font-family="Times,serif" font-size="14.00">MHA 3</text>
<text text-anchor="middle" x="9207.72" y="-3288.66" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, heads=16, dim=512]</text>
<text text-anchor="middle" x="9207.72" y="-3273.66" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_3_mha_q&#45;&gt;layer_3_mha_attn -->
<g id="edge266" class="edge">
<title>layer_3_mha_q&#45;&gt;layer_3_mha_attn</title>
<path fill="none" stroke="black" d="M8867.78,-3354.84C8927.13,-3344.11 8996.28,-3331.6 9056.65,-3320.68"/>
<polygon fill="black" stroke="black" points="9057.44,-3324.1 9066.65,-3318.87 9056.19,-3317.21 9057.44,-3324.1"/>
</g>
<!-- layer_3_mha_k&#45;&gt;layer_3_mha_attn -->
<g id="edge267" class="edge">
<title>layer_3_mha_k&#45;&gt;layer_3_mha_attn</title>
<path fill="none" stroke="black" d="M9100.5,-3354.73C9117.28,-3345.12 9136.51,-3334.11 9154.02,-3324.1"/>
<polygon fill="black" stroke="black" points="9156.05,-3326.96 9162.99,-3318.96 9152.57,-3320.89 9156.05,-3326.96"/>
</g>
<!-- layer_3_mha_v&#45;&gt;layer_3_mha_attn -->
<g id="edge268" class="edge">
<title>layer_3_mha_v&#45;&gt;layer_3_mha_attn</title>
<path fill="none" stroke="black" d="M9332.57,-3354.73C9312.58,-3344.9 9289.6,-3333.61 9268.85,-3323.41"/>
<polygon fill="black" stroke="black" points="9270.32,-3320.23 9259.8,-3318.96 9267.23,-3326.51 9270.32,-3320.23"/>
</g>
<!-- layer_3_mha_o -->
<g id="node164" class="node">
<title>layer_3_mha_o</title>
<polygon fill="lightblue" stroke="black" points="9528.22,-3229.86 9217.22,-3229.86 9217.22,-3176.86 9528.22,-3176.86 9528.22,-3229.86"/>
<text text-anchor="middle" x="9372.72" y="-3214.66" font-family="Times,serif" font-size="14.00">MHA O Proj 3</text>
<text text-anchor="middle" x="9372.72" y="-3199.66" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9372.72" y="-3184.66" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_3_mha_attn&#45;&gt;layer_3_mha_o -->
<g id="edge269" class="edge">
<title>layer_3_mha_attn&#45;&gt;layer_3_mha_o</title>
<path fill="none" stroke="black" d="M9256.33,-3265.73C9274.79,-3255.99 9296,-3244.81 9315.21,-3234.68"/>
<polygon fill="black" stroke="black" points="9316.95,-3237.72 9324.17,-3229.96 9313.69,-3231.53 9316.95,-3237.72"/>
</g>
<!-- layer_3_mha_o&#45;&gt;layer_3_mha_res -->
<g id="edge270" class="edge">
<title>layer_3_mha_o&#45;&gt;layer_3_mha_res</title>
<path fill="none" stroke="black" d="M9399.82,-3176.73C9409.28,-3167.78 9420.03,-3157.61 9430.03,-3148.16"/>
<polygon fill="black" stroke="black" points="9432.63,-3150.52 9437.49,-3141.11 9427.82,-3145.44 9432.63,-3150.52"/>
</g>
<!-- layer_3_exp_norm -->
<g id="node166" class="node">
<title>layer_3_exp_norm</title>
<polygon fill="lightcoral" stroke="black" points="7024.22,-3051.86 6713.22,-3051.86 6713.22,-2998.86 7024.22,-2998.86 7024.22,-3051.86"/>
<text text-anchor="middle" x="6868.72" y="-3036.66" font-family="Times,serif" font-size="14.00">Expert Norm 3</text>
<text text-anchor="middle" x="6868.72" y="-3021.66" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="6868.72" y="-3006.66" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_3_mha_res&#45;&gt;layer_3_exp_norm -->
<g id="edge272" class="edge">
<title>layer_3_mha_res&#45;&gt;layer_3_exp_norm</title>
<path fill="none" stroke="black" d="M9309.14,-3108.15C8850.49,-3092.78 7506.45,-3047.73 7034.7,-3031.92"/>
<polygon fill="black" stroke="black" points="7034.51,-3028.41 7024.4,-3031.58 7034.28,-3035.41 7034.51,-3028.41"/>
</g>
<!-- layer_3_exp_res -->
<g id="node234" class="node">
<title>layer_3_exp_res</title>
<polygon fill="lightyellow" stroke="black" points="9451.22,-2021.86 9140.22,-2021.86 9140.22,-1968.86 9451.22,-1968.86 9451.22,-2021.86"/>
<text text-anchor="middle" x="9295.72" y="-2006.66" font-family="Times,serif" font-size="14.00">Expert Residual 3</text>
<text text-anchor="middle" x="9295.72" y="-1991.66" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9295.72" y="-1976.66" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_3_mha_res&#45;&gt;layer_3_exp_res -->
<g id="edge293" class="edge">
<title>layer_3_mha_res&#45;&gt;layer_3_exp_res</title>
<path fill="none" stroke="black" d="M9620.36,-3109.42C10180.64,-3094.22 12061.72,-3034.02 12061.72,-2910.86 12061.72,-2910.86 12061.72,-2910.86 12061.72,-2251.86 12061.72,-2227.25 12062.35,-2214.7 12042.72,-2199.86 11836.78,-2044.21 10023.99,-2006.35 9461.46,-1998.32"/>
<polygon fill="black" stroke="black" points="9461.29,-1994.81 9451.24,-1998.17 9461.19,-2001.81 9461.29,-1994.81"/>
</g>
<!-- layer_3_global_gate -->
<g id="node167" class="node">
<title>layer_3_global_gate</title>
<polygon fill="yellow" stroke="black" points="6529.72,-2962.86 6218.72,-2909.86 6529.72,-2856.86 6840.72,-2909.86 6529.72,-2962.86"/>
<text text-anchor="middle" x="6529.72" y="-2921.16" font-family="Times,serif" font-size="14.00">Global Gate 3</text>
<text text-anchor="middle" x="6529.72" y="-2906.16" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="6529.72" y="-2891.16" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_3_exp_norm&#45;&gt;layer_3_global_gate -->
<g id="edge273" class="edge">
<title>layer_3_exp_norm&#45;&gt;layer_3_global_gate</title>
<path fill="none" stroke="black" d="M6792.22,-2998.75C6748.09,-2983.97 6691.8,-2965.13 6642.66,-2948.67"/>
<polygon fill="black" stroke="black" points="6643.53,-2945.27 6632.93,-2945.42 6641.31,-2951.91 6643.53,-2945.27"/>
</g>
<!-- layer_3_token_dist -->
<g id="node168" class="node">
<title>layer_3_token_dist</title>
<polygon fill="orange" stroke="black" points="6852.08,-2820.86 6339.27,-2820.86 6207.36,-2714.86 6720.16,-2714.86 6852.08,-2820.86"/>
<text text-anchor="middle" x="6529.72" y="-2779.16" font-family="Times,serif" font-size="14.00">Token Distribution 3</text>
<text text-anchor="middle" x="6529.72" y="-2764.16" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="6529.72" y="-2749.16" font-family="Times,serif" font-size="14.00">GPU: all to 0&#45;15</text>
</g>
<!-- layer_3_exp_norm&#45;&gt;layer_3_token_dist -->
<g id="edge275" class="edge">
<title>layer_3_exp_norm&#45;&gt;layer_3_token_dist</title>
<path fill="none" stroke="black" d="M6873.84,-2998.82C6879.49,-2962.7 6883.77,-2896.67 6849.72,-2856.86 6839.5,-2844.92 6819.11,-2834.07 6793.34,-2824.39"/>
<polygon fill="black" stroke="black" points="6794.21,-2820.98 6783.61,-2820.88 6791.83,-2827.57 6794.21,-2820.98"/>
</g>
<!-- layer_3_global_gate&#45;&gt;layer_3_token_dist -->
<g id="edge274" class="edge">
<title>layer_3_global_gate&#45;&gt;layer_3_token_dist</title>
<path fill="none" stroke="black" d="M6529.72,-2856.73C6529.72,-2848.44 6529.72,-2839.79 6529.72,-2831.29"/>
<polygon fill="black" stroke="black" points="6533.22,-2831.03 6529.72,-2821.03 6526.22,-2831.03 6533.22,-2831.03"/>
</g>
<!-- layer_3_expert0_recv -->
<g id="node169" class="node">
<title>layer_3_expert0_recv</title>
<polygon fill="lightgreen" stroke="black" points="1008.65,-2678.86 437.67,-2678.86 290.78,-2572.86 861.77,-2572.86 1008.65,-2678.86"/>
<text text-anchor="middle" x="649.72" y="-2637.16" font-family="Times,serif" font-size="14.00">Expert 0 Recv</text>
<text text-anchor="middle" x="649.72" y="-2622.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="649.72" y="-2607.16" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_3_token_dist&#45;&gt;layer_3_expert0_recv -->
<g id="edge197" class="edge">
<title>layer_3_token_dist&#45;&gt;layer_3_expert0_recv</title>
<path fill="none" stroke="black" d="M6272.15,-2767.02C5331,-2766.93 2078.39,-2760.63 1018.08,-2678.94"/>
<polygon fill="black" stroke="black" points="1018.26,-2675.44 1008.02,-2678.16 1017.72,-2682.42 1018.26,-2675.44"/>
</g>
<!-- layer_3_expert1_recv -->
<g id="node173" class="node">
<title>layer_3_expert1_recv</title>
<polygon fill="lightgreen" stroke="black" points="1743.65,-2678.86 1172.67,-2678.86 1025.78,-2572.86 1596.77,-2572.86 1743.65,-2678.86"/>
<text text-anchor="middle" x="1384.72" y="-2637.16" font-family="Times,serif" font-size="14.00">Expert 1 Recv</text>
<text text-anchor="middle" x="1384.72" y="-2622.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="1384.72" y="-2607.16" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_3_token_dist&#45;&gt;layer_3_expert1_recv -->
<g id="edge201" class="edge">
<title>layer_3_token_dist&#45;&gt;layer_3_expert1_recv</title>
<path fill="none" stroke="black" d="M6271.22,-2766.27C5413.07,-2763.67 2662.22,-2749.91 1753.3,-2678.96"/>
<polygon fill="black" stroke="black" points="1753.27,-2675.44 1743.02,-2678.15 1752.72,-2682.42 1753.27,-2675.44"/>
</g>
<!-- layer_3_expert2_recv -->
<g id="node177" class="node">
<title>layer_3_expert2_recv</title>
<polygon fill="lightgreen" stroke="black" points="2478.65,-2678.86 1907.67,-2678.86 1760.78,-2572.86 2331.77,-2572.86 2478.65,-2678.86"/>
<text text-anchor="middle" x="2119.72" y="-2637.16" font-family="Times,serif" font-size="14.00">Expert 2 Recv</text>
<text text-anchor="middle" x="2119.72" y="-2622.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2119.72" y="-2607.16" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_3_token_dist&#45;&gt;layer_3_expert2_recv -->
<g id="edge205" class="edge">
<title>layer_3_token_dist&#45;&gt;layer_3_expert2_recv</title>
<path fill="none" stroke="black" d="M6270.04,-2765.25C5501.68,-2759.85 3246.33,-2739.24 2488.25,-2678.95"/>
<polygon fill="black" stroke="black" points="2488.27,-2675.45 2478.02,-2678.13 2487.71,-2682.42 2488.27,-2675.45"/>
</g>
<!-- layer_3_expert3_recv -->
<g id="node181" class="node">
<title>layer_3_expert3_recv</title>
<polygon fill="lightgreen" stroke="black" points="3213.65,-2678.86 2642.67,-2678.86 2495.78,-2572.86 3066.77,-2572.86 3213.65,-2678.86"/>
<text text-anchor="middle" x="2854.72" y="-2637.16" font-family="Times,serif" font-size="14.00">Expert 3 Recv</text>
<text text-anchor="middle" x="2854.72" y="-2622.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2854.72" y="-2607.16" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_3_token_dist&#45;&gt;layer_3_expert3_recv -->
<g id="edge209" class="edge">
<title>layer_3_token_dist&#45;&gt;layer_3_expert3_recv</title>
<path fill="none" stroke="black" d="M6267.92,-2763.76C5597.84,-2755.21 3831.38,-2728.62 3223.22,-2678.96"/>
<polygon fill="black" stroke="black" points="3223.28,-2675.45 3213.02,-2678.11 3222.7,-2682.42 3223.28,-2675.45"/>
</g>
<!-- layer_3_expert4_recv -->
<g id="node185" class="node">
<title>layer_3_expert4_recv</title>
<polygon fill="lightgreen" stroke="black" points="3948.65,-2678.86 3377.67,-2678.86 3230.78,-2572.86 3801.77,-2572.86 3948.65,-2678.86"/>
<text text-anchor="middle" x="3589.72" y="-2637.16" font-family="Times,serif" font-size="14.00">Expert 4 Recv</text>
<text text-anchor="middle" x="3589.72" y="-2622.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="3589.72" y="-2607.16" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_3_token_dist&#45;&gt;layer_3_expert4_recv -->
<g id="edge213" class="edge">
<title>layer_3_token_dist&#45;&gt;layer_3_expert4_recv</title>
<path fill="none" stroke="black" d="M6272.16,-2767.12C5810.07,-2765.57 4809.72,-2753.07 3957.56,-2678.91"/>
<polygon fill="black" stroke="black" points="3957.81,-2675.42 3947.54,-2678.04 3957.2,-2682.39 3957.81,-2675.42"/>
</g>
<!-- layer_3_expert5_recv -->
<g id="node189" class="node">
<title>layer_3_expert5_recv</title>
<polygon fill="lightgreen" stroke="black" points="4683.65,-2678.86 4112.67,-2678.86 3965.78,-2572.86 4536.77,-2572.86 4683.65,-2678.86"/>
<text text-anchor="middle" x="4324.72" y="-2637.16" font-family="Times,serif" font-size="14.00">Expert 5 Recv</text>
<text text-anchor="middle" x="4324.72" y="-2622.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="4324.72" y="-2607.16" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_3_token_dist&#45;&gt;layer_3_expert5_recv -->
<g id="edge217" class="edge">
<title>layer_3_token_dist&#45;&gt;layer_3_expert5_recv</title>
<path fill="none" stroke="black" d="M6265.89,-2761.92C5910.53,-2753.53 5258.38,-2731.98 4692.54,-2678.92"/>
<polygon fill="black" stroke="black" points="4692.83,-2675.43 4682.55,-2677.98 4692.18,-2682.4 4692.83,-2675.43"/>
</g>
<!-- layer_3_expert6_recv -->
<g id="node193" class="node">
<title>layer_3_expert6_recv</title>
<polygon fill="lightgreen" stroke="black" points="5418.65,-2678.86 4847.67,-2678.86 4700.78,-2572.86 5271.77,-2572.86 5418.65,-2678.86"/>
<text text-anchor="middle" x="5059.72" y="-2637.16" font-family="Times,serif" font-size="14.00">Expert 6 Recv</text>
<text text-anchor="middle" x="5059.72" y="-2622.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5059.72" y="-2607.16" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_3_token_dist&#45;&gt;layer_3_expert6_recv -->
<g id="edge221" class="edge">
<title>layer_3_token_dist&#45;&gt;layer_3_expert6_recv</title>
<path fill="none" stroke="black" d="M6250.19,-2749.3C6029.57,-2734.31 5713.82,-2710.36 5427.73,-2678.96"/>
<polygon fill="black" stroke="black" points="5427.89,-2675.45 5417.56,-2677.84 5427.12,-2682.41 5427.89,-2675.45"/>
</g>
<!-- layer_3_expert7_recv -->
<g id="node197" class="node">
<title>layer_3_expert7_recv</title>
<polygon fill="lightgreen" stroke="black" points="6153.65,-2678.86 5582.67,-2678.86 5435.78,-2572.86 6006.77,-2572.86 6153.65,-2678.86"/>
<text text-anchor="middle" x="5794.72" y="-2637.16" font-family="Times,serif" font-size="14.00">Expert 7 Recv</text>
<text text-anchor="middle" x="5794.72" y="-2622.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5794.72" y="-2607.16" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_3_token_dist&#45;&gt;layer_3_expert7_recv -->
<g id="edge225" class="edge">
<title>layer_3_token_dist&#45;&gt;layer_3_expert7_recv</title>
<path fill="none" stroke="black" d="M6256.55,-2714.83C6198.26,-2703.73 6136.58,-2691.98 6077.92,-2680.8"/>
<polygon fill="black" stroke="black" points="6078.25,-2677.3 6067.78,-2678.87 6076.94,-2684.18 6078.25,-2677.3"/>
</g>
<!-- layer_3_expert8_recv -->
<g id="node201" class="node">
<title>layer_3_expert8_recv</title>
<polygon fill="lightgreen" stroke="black" points="6888.65,-2678.86 6317.67,-2678.86 6170.78,-2572.86 6741.77,-2572.86 6888.65,-2678.86"/>
<text text-anchor="middle" x="6529.72" y="-2637.16" font-family="Times,serif" font-size="14.00">Expert 8 Recv</text>
<text text-anchor="middle" x="6529.72" y="-2622.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="6529.72" y="-2607.16" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_3_token_dist&#45;&gt;layer_3_expert8_recv -->
<g id="edge229" class="edge">
<title>layer_3_token_dist&#45;&gt;layer_3_expert8_recv</title>
<path fill="none" stroke="black" d="M6529.72,-2714.73C6529.72,-2706.44 6529.72,-2697.79 6529.72,-2689.29"/>
<polygon fill="black" stroke="black" points="6533.22,-2689.03 6529.72,-2679.03 6526.22,-2689.03 6533.22,-2689.03"/>
</g>
<!-- layer_3_expert9_recv -->
<g id="node205" class="node">
<title>layer_3_expert9_recv</title>
<polygon fill="lightgreen" stroke="black" points="7623.65,-2678.86 7052.67,-2678.86 6905.78,-2572.86 7476.77,-2572.86 7623.65,-2678.86"/>
<text text-anchor="middle" x="7264.72" y="-2637.16" font-family="Times,serif" font-size="14.00">Expert 9 Recv</text>
<text text-anchor="middle" x="7264.72" y="-2622.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="7264.72" y="-2607.16" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_3_token_dist&#45;&gt;layer_3_expert9_recv -->
<g id="edge233" class="edge">
<title>layer_3_token_dist&#45;&gt;layer_3_expert9_recv</title>
<path fill="none" stroke="black" d="M6736.41,-2727.49C6827.66,-2710.11 6935.37,-2689.59 7029.66,-2671.63"/>
<polygon fill="black" stroke="black" points="7030.45,-2675.04 7039.62,-2669.74 7029.14,-2668.17 7030.45,-2675.04"/>
</g>
<!-- layer_3_expert10_recv -->
<g id="node209" class="node">
<title>layer_3_expert10_recv</title>
<polygon fill="lightgreen" stroke="black" points="8358.65,-2678.86 7787.67,-2678.86 7640.78,-2572.86 8211.77,-2572.86 8358.65,-2678.86"/>
<text text-anchor="middle" x="7999.72" y="-2637.16" font-family="Times,serif" font-size="14.00">Expert 10 Recv</text>
<text text-anchor="middle" x="7999.72" y="-2622.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="7999.72" y="-2607.16" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_3_token_dist&#45;&gt;layer_3_expert10_recv -->
<g id="edge237" class="edge">
<title>layer_3_token_dist&#45;&gt;layer_3_expert10_recv</title>
<path fill="none" stroke="black" d="M6766.79,-2752.15C6990.43,-2737.28 7334.86,-2711.81 7632.72,-2678.86 7672.16,-2674.5 7713.89,-2669.22 7754.53,-2663.72"/>
<polygon fill="black" stroke="black" points="7755.12,-2667.17 7764.56,-2662.35 7754.18,-2660.23 7755.12,-2667.17"/>
</g>
<!-- layer_3_expert11_recv -->
<g id="node213" class="node">
<title>layer_3_expert11_recv</title>
<polygon fill="lightgreen" stroke="black" points="9093.65,-2678.86 8522.67,-2678.86 8375.78,-2572.86 8946.77,-2572.86 9093.65,-2678.86"/>
<text text-anchor="middle" x="8734.72" y="-2637.16" font-family="Times,serif" font-size="14.00">Expert 11 Recv</text>
<text text-anchor="middle" x="8734.72" y="-2622.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8734.72" y="-2607.16" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_3_token_dist&#45;&gt;layer_3_expert11_recv -->
<g id="edge241" class="edge">
<title>layer_3_token_dist&#45;&gt;layer_3_expert11_recv</title>
<path fill="none" stroke="black" d="M6779.22,-2762.26C7133.2,-2754.06 7801.2,-2732.44 8367.72,-2678.86 8407.52,-2675.1 8449.62,-2670.1 8490.55,-2664.68"/>
<polygon fill="black" stroke="black" points="8491.2,-2668.13 8500.65,-2663.33 8490.28,-2661.19 8491.2,-2668.13"/>
</g>
<!-- layer_3_expert12_recv -->
<g id="node217" class="node">
<title>layer_3_expert12_recv</title>
<polygon fill="lightgreen" stroke="black" points="9828.65,-2678.86 9257.67,-2678.86 9110.78,-2572.86 9681.77,-2572.86 9828.65,-2678.86"/>
<text text-anchor="middle" x="9469.72" y="-2637.16" font-family="Times,serif" font-size="14.00">Expert 12 Recv</text>
<text text-anchor="middle" x="9469.72" y="-2622.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="9469.72" y="-2607.16" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_3_token_dist&#45;&gt;layer_3_expert12_recv -->
<g id="edge245" class="edge">
<title>layer_3_token_dist&#45;&gt;layer_3_expert12_recv</title>
<path fill="none" stroke="black" d="M6785.45,-2767.12C7248.53,-2765.6 8256.46,-2753.07 9102.72,-2678.86 9142.69,-2675.35 9184.97,-2670.47 9226.05,-2665.09"/>
<polygon fill="black" stroke="black" points="9226.73,-2668.53 9236.19,-2663.75 9225.82,-2661.59 9226.73,-2668.53"/>
</g>
<!-- layer_3_expert13_recv -->
<g id="node221" class="node">
<title>layer_3_expert13_recv</title>
<polygon fill="lightgreen" stroke="black" points="10563.65,-2678.86 9992.67,-2678.86 9845.78,-2572.86 10416.77,-2572.86 10563.65,-2678.86"/>
<text text-anchor="middle" x="10204.72" y="-2637.16" font-family="Times,serif" font-size="14.00">Expert 13 Recv</text>
<text text-anchor="middle" x="10204.72" y="-2622.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10204.72" y="-2607.16" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_3_token_dist&#45;&gt;layer_3_expert13_recv -->
<g id="edge249" class="edge">
<title>layer_3_token_dist&#45;&gt;layer_3_expert13_recv</title>
<path fill="none" stroke="black" d="M6781.47,-2763.89C7447.49,-2755.43 9245.09,-2728.56 9837.72,-2678.86 9877.85,-2675.49 9920.3,-2670.67 9961.53,-2665.29"/>
<polygon fill="black" stroke="black" points="9962.25,-2668.73 9971.7,-2663.95 9961.33,-2661.79 9962.25,-2668.73"/>
</g>
<!-- layer_3_expert14_recv -->
<g id="node225" class="node">
<title>layer_3_expert14_recv</title>
<polygon fill="lightgreen" stroke="black" points="11298.65,-2678.86 10727.67,-2678.86 10580.78,-2572.86 11151.77,-2572.86 11298.65,-2678.86"/>
<text text-anchor="middle" x="10939.72" y="-2637.16" font-family="Times,serif" font-size="14.00">Expert 14 Recv</text>
<text text-anchor="middle" x="10939.72" y="-2622.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10939.72" y="-2607.16" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_3_token_dist&#45;&gt;layer_3_expert14_recv -->
<g id="edge253" class="edge">
<title>layer_3_token_dist&#45;&gt;layer_3_expert14_recv</title>
<path fill="none" stroke="black" d="M6783.26,-2765.29C7549.13,-2759.94 9831.63,-2739.21 10572.72,-2678.86 10612.86,-2675.59 10655.31,-2670.81 10696.54,-2665.46"/>
<polygon fill="black" stroke="black" points="10697.26,-2668.89 10706.72,-2664.12 10696.35,-2661.95 10697.26,-2668.89"/>
</g>
<!-- layer_3_expert15_recv -->
<g id="node229" class="node">
<title>layer_3_expert15_recv</title>
<polygon fill="lightgreen" stroke="black" points="12033.65,-2678.86 11462.67,-2678.86 11315.78,-2572.86 11886.77,-2572.86 12033.65,-2678.86"/>
<text text-anchor="middle" x="11674.72" y="-2637.16" font-family="Times,serif" font-size="14.00">Expert 15 Recv</text>
<text text-anchor="middle" x="11674.72" y="-2622.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="11674.72" y="-2607.16" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_3_token_dist&#45;&gt;layer_3_expert15_recv -->
<g id="edge257" class="edge">
<title>layer_3_token_dist&#45;&gt;layer_3_expert15_recv</title>
<path fill="none" stroke="black" d="M6784.47,-2766.28C7641.57,-2763.7 10416.85,-2749.91 11307.72,-2678.86 11348.1,-2675.64 11390.81,-2670.86 11432.27,-2665.48"/>
<polygon fill="black" stroke="black" points="11432.76,-2668.95 11442.22,-2664.17 11431.85,-2662 11432.76,-2668.95"/>
</g>
<!-- layer_3_expert0_gate -->
<g id="node170" class="node">
<title>layer_3_expert0_gate</title>
<polygon fill="yellow" stroke="black" points="649.72,-2536.86 303.72,-2483.86 649.72,-2430.86 995.72,-2483.86 649.72,-2536.86"/>
<text text-anchor="middle" x="649.72" y="-2495.16" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="649.72" y="-2480.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="649.72" y="-2465.16" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_3_expert0_recv&#45;&gt;layer_3_expert0_gate -->
<g id="edge198" class="edge">
<title>layer_3_expert0_recv&#45;&gt;layer_3_expert0_gate</title>
<path fill="none" stroke="black" d="M649.72,-2572.73C649.72,-2564.44 649.72,-2555.79 649.72,-2547.29"/>
<polygon fill="black" stroke="black" points="653.22,-2547.03 649.72,-2537.03 646.22,-2547.03 653.22,-2547.03"/>
</g>
<!-- layer_3_expert0 -->
<g id="node171" class="node">
<title>layer_3_expert0</title>
<polygon fill="lightpink" stroke="black" points="822.72,-2394.86 476.72,-2394.86 476.72,-2341.86 822.72,-2341.86 822.72,-2394.86"/>
<text text-anchor="middle" x="649.72" y="-2379.66" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="649.72" y="-2364.66" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="649.72" y="-2349.66" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_3_expert0_gate&#45;&gt;layer_3_expert0 -->
<g id="edge199" class="edge">
<title>layer_3_expert0_gate&#45;&gt;layer_3_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M649.72,-2430.76C649.72,-2422.09 649.72,-2413.27 649.72,-2405.13"/>
<polygon fill="black" stroke="black" points="653.22,-2404.87 649.72,-2394.87 646.22,-2404.87 653.22,-2404.87"/>
</g>
<!-- layer_3_expert0_send -->
<g id="node172" class="node">
<title>layer_3_expert0_send</title>
<polygon fill="lightgreen" stroke="black" points="1008.65,-2305.86 437.67,-2305.86 290.78,-2199.86 861.77,-2199.86 1008.65,-2305.86"/>
<text text-anchor="middle" x="649.72" y="-2264.16" font-family="Times,serif" font-size="14.00">Expert 0 Send</text>
<text text-anchor="middle" x="649.72" y="-2249.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="649.72" y="-2234.16" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_3_expert0&#45;&gt;layer_3_expert0_send -->
<g id="edge200" class="edge">
<title>layer_3_expert0&#45;&gt;layer_3_expert0_send</title>
<path fill="none" stroke="black" d="M649.72,-2341.61C649.72,-2333.91 649.72,-2325.11 649.72,-2316.13"/>
<polygon fill="black" stroke="black" points="653.22,-2315.96 649.72,-2305.96 646.22,-2315.96 653.22,-2315.96"/>
</g>
<!-- layer_3_exp_agg -->
<g id="node233" class="node">
<title>layer_3_exp_agg</title>
<polygon fill="orange" stroke="black" points="6852.08,-2163.86 6339.27,-2163.86 6207.36,-2057.86 6720.16,-2057.86 6852.08,-2163.86"/>
<text text-anchor="middle" x="6529.72" y="-2122.16" font-family="Times,serif" font-size="14.00">Expert Aggregation 3</text>
<text text-anchor="middle" x="6529.72" y="-2107.16" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="6529.72" y="-2092.16" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_3_expert0_send&#45;&gt;layer_3_exp_agg -->
<g id="edge276" class="edge">
<title>layer_3_expert0_send&#45;&gt;layer_3_exp_agg</title>
<path fill="none" stroke="black" d="M882.21,-2214.46C926.75,-2208.56 973.09,-2203.29 1016.72,-2199.86 2054.71,-2118.36 5309.54,-2111.83 6264.09,-2111.7"/>
<polygon fill="black" stroke="black" points="6264.18,-2115.2 6274.18,-2111.7 6264.18,-2108.2 6264.18,-2115.2"/>
</g>
<!-- layer_3_expert1_gate -->
<g id="node174" class="node">
<title>layer_3_expert1_gate</title>
<polygon fill="yellow" stroke="black" points="1384.72,-2536.86 1038.72,-2483.86 1384.72,-2430.86 1730.72,-2483.86 1384.72,-2536.86"/>
<text text-anchor="middle" x="1384.72" y="-2495.16" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="1384.72" y="-2480.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="1384.72" y="-2465.16" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_3_expert1_recv&#45;&gt;layer_3_expert1_gate -->
<g id="edge202" class="edge">
<title>layer_3_expert1_recv&#45;&gt;layer_3_expert1_gate</title>
<path fill="none" stroke="black" d="M1384.72,-2572.73C1384.72,-2564.44 1384.72,-2555.79 1384.72,-2547.29"/>
<polygon fill="black" stroke="black" points="1388.22,-2547.03 1384.72,-2537.03 1381.22,-2547.03 1388.22,-2547.03"/>
</g>
<!-- layer_3_expert1 -->
<g id="node175" class="node">
<title>layer_3_expert1</title>
<polygon fill="lightpink" stroke="black" points="1557.72,-2394.86 1211.72,-2394.86 1211.72,-2341.86 1557.72,-2341.86 1557.72,-2394.86"/>
<text text-anchor="middle" x="1384.72" y="-2379.66" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1384.72" y="-2364.66" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="1384.72" y="-2349.66" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_3_expert1_gate&#45;&gt;layer_3_expert1 -->
<g id="edge203" class="edge">
<title>layer_3_expert1_gate&#45;&gt;layer_3_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1384.72,-2430.76C1384.72,-2422.09 1384.72,-2413.27 1384.72,-2405.13"/>
<polygon fill="black" stroke="black" points="1388.22,-2404.87 1384.72,-2394.87 1381.22,-2404.87 1388.22,-2404.87"/>
</g>
<!-- layer_3_expert1_send -->
<g id="node176" class="node">
<title>layer_3_expert1_send</title>
<polygon fill="lightgreen" stroke="black" points="1743.65,-2305.86 1172.67,-2305.86 1025.78,-2199.86 1596.77,-2199.86 1743.65,-2305.86"/>
<text text-anchor="middle" x="1384.72" y="-2264.16" font-family="Times,serif" font-size="14.00">Expert 1 Send</text>
<text text-anchor="middle" x="1384.72" y="-2249.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="1384.72" y="-2234.16" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_3_expert1&#45;&gt;layer_3_expert1_send -->
<g id="edge204" class="edge">
<title>layer_3_expert1&#45;&gt;layer_3_expert1_send</title>
<path fill="none" stroke="black" d="M1384.72,-2341.61C1384.72,-2333.91 1384.72,-2325.11 1384.72,-2316.13"/>
<polygon fill="black" stroke="black" points="1388.22,-2315.96 1384.72,-2305.96 1381.22,-2315.96 1388.22,-2315.96"/>
</g>
<!-- layer_3_expert1_send&#45;&gt;layer_3_exp_agg -->
<g id="edge277" class="edge">
<title>layer_3_expert1_send&#45;&gt;layer_3_exp_agg</title>
<path fill="none" stroke="black" d="M1617.22,-2214.55C1661.75,-2208.64 1708.1,-2203.34 1751.72,-2199.86 2639.1,-2129.09 5396.21,-2115.13 6264.83,-2112.47"/>
<polygon fill="black" stroke="black" points="6264.97,-2115.97 6274.96,-2112.44 6264.95,-2108.97 6264.97,-2115.97"/>
</g>
<!-- layer_3_expert2_gate -->
<g id="node178" class="node">
<title>layer_3_expert2_gate</title>
<polygon fill="yellow" stroke="black" points="2119.72,-2536.86 1773.72,-2483.86 2119.72,-2430.86 2465.72,-2483.86 2119.72,-2536.86"/>
<text text-anchor="middle" x="2119.72" y="-2495.16" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="2119.72" y="-2480.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2119.72" y="-2465.16" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_3_expert2_recv&#45;&gt;layer_3_expert2_gate -->
<g id="edge206" class="edge">
<title>layer_3_expert2_recv&#45;&gt;layer_3_expert2_gate</title>
<path fill="none" stroke="black" d="M2119.72,-2572.73C2119.72,-2564.44 2119.72,-2555.79 2119.72,-2547.29"/>
<polygon fill="black" stroke="black" points="2123.22,-2547.03 2119.72,-2537.03 2116.22,-2547.03 2123.22,-2547.03"/>
</g>
<!-- layer_3_expert2 -->
<g id="node179" class="node">
<title>layer_3_expert2</title>
<polygon fill="lightpink" stroke="black" points="2292.72,-2394.86 1946.72,-2394.86 1946.72,-2341.86 2292.72,-2341.86 2292.72,-2394.86"/>
<text text-anchor="middle" x="2119.72" y="-2379.66" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2119.72" y="-2364.66" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2119.72" y="-2349.66" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_3_expert2_gate&#45;&gt;layer_3_expert2 -->
<g id="edge207" class="edge">
<title>layer_3_expert2_gate&#45;&gt;layer_3_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2119.72,-2430.76C2119.72,-2422.09 2119.72,-2413.27 2119.72,-2405.13"/>
<polygon fill="black" stroke="black" points="2123.22,-2404.87 2119.72,-2394.87 2116.22,-2404.87 2123.22,-2404.87"/>
</g>
<!-- layer_3_expert2_send -->
<g id="node180" class="node">
<title>layer_3_expert2_send</title>
<polygon fill="lightgreen" stroke="black" points="2478.65,-2305.86 1907.67,-2305.86 1760.78,-2199.86 2331.77,-2199.86 2478.65,-2305.86"/>
<text text-anchor="middle" x="2119.72" y="-2264.16" font-family="Times,serif" font-size="14.00">Expert 2 Send</text>
<text text-anchor="middle" x="2119.72" y="-2249.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2119.72" y="-2234.16" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_3_expert2&#45;&gt;layer_3_expert2_send -->
<g id="edge208" class="edge">
<title>layer_3_expert2&#45;&gt;layer_3_expert2_send</title>
<path fill="none" stroke="black" d="M2119.72,-2341.61C2119.72,-2333.91 2119.72,-2325.11 2119.72,-2316.13"/>
<polygon fill="black" stroke="black" points="2123.22,-2315.96 2119.72,-2305.96 2116.22,-2315.96 2123.22,-2315.96"/>
</g>
<!-- layer_3_expert2_send&#45;&gt;layer_3_exp_agg -->
<g id="edge278" class="edge">
<title>layer_3_expert2_send&#45;&gt;layer_3_exp_agg</title>
<path fill="none" stroke="black" d="M2352.72,-2214.6C2397.1,-2208.71 2443.26,-2203.4 2486.72,-2199.86 3224.55,-2139.77 5490.27,-2118.97 6265.99,-2113.5"/>
<polygon fill="black" stroke="black" points="6266.2,-2117 6276.17,-2113.43 6266.15,-2110 6266.2,-2117"/>
</g>
<!-- layer_3_expert3_gate -->
<g id="node182" class="node">
<title>layer_3_expert3_gate</title>
<polygon fill="yellow" stroke="black" points="2854.72,-2536.86 2508.72,-2483.86 2854.72,-2430.86 3200.72,-2483.86 2854.72,-2536.86"/>
<text text-anchor="middle" x="2854.72" y="-2495.16" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="2854.72" y="-2480.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2854.72" y="-2465.16" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_3_expert3_recv&#45;&gt;layer_3_expert3_gate -->
<g id="edge210" class="edge">
<title>layer_3_expert3_recv&#45;&gt;layer_3_expert3_gate</title>
<path fill="none" stroke="black" d="M2854.72,-2572.73C2854.72,-2564.44 2854.72,-2555.79 2854.72,-2547.29"/>
<polygon fill="black" stroke="black" points="2858.22,-2547.03 2854.72,-2537.03 2851.22,-2547.03 2858.22,-2547.03"/>
</g>
<!-- layer_3_expert3 -->
<g id="node183" class="node">
<title>layer_3_expert3</title>
<polygon fill="lightpink" stroke="black" points="3027.72,-2394.86 2681.72,-2394.86 2681.72,-2341.86 3027.72,-2341.86 3027.72,-2394.86"/>
<text text-anchor="middle" x="2854.72" y="-2379.66" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2854.72" y="-2364.66" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2854.72" y="-2349.66" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_3_expert3_gate&#45;&gt;layer_3_expert3 -->
<g id="edge211" class="edge">
<title>layer_3_expert3_gate&#45;&gt;layer_3_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2854.72,-2430.76C2854.72,-2422.09 2854.72,-2413.27 2854.72,-2405.13"/>
<polygon fill="black" stroke="black" points="2858.22,-2404.87 2854.72,-2394.87 2851.22,-2404.87 2858.22,-2404.87"/>
</g>
<!-- layer_3_expert3_send -->
<g id="node184" class="node">
<title>layer_3_expert3_send</title>
<polygon fill="lightgreen" stroke="black" points="3213.65,-2305.86 2642.67,-2305.86 2495.78,-2199.86 3066.77,-2199.86 3213.65,-2305.86"/>
<text text-anchor="middle" x="2854.72" y="-2264.16" font-family="Times,serif" font-size="14.00">Expert 3 Send</text>
<text text-anchor="middle" x="2854.72" y="-2249.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2854.72" y="-2234.16" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_3_expert3&#45;&gt;layer_3_expert3_send -->
<g id="edge212" class="edge">
<title>layer_3_expert3&#45;&gt;layer_3_expert3_send</title>
<path fill="none" stroke="black" d="M2854.72,-2341.61C2854.72,-2333.91 2854.72,-2325.11 2854.72,-2316.13"/>
<polygon fill="black" stroke="black" points="2858.22,-2315.96 2854.72,-2305.96 2851.22,-2315.96 2858.22,-2315.96"/>
</g>
<!-- layer_3_expert3_send&#45;&gt;layer_3_exp_agg -->
<g id="edge279" class="edge">
<title>layer_3_expert3_send&#45;&gt;layer_3_exp_agg</title>
<path fill="none" stroke="black" d="M3087.73,-2214.77C3132.12,-2208.86 3178.27,-2203.5 3221.72,-2199.86 3811.3,-2150.41 5593.54,-2123.57 6267.63,-2114.96"/>
<polygon fill="black" stroke="black" points="6268,-2118.46 6277.96,-2114.83 6267.91,-2111.46 6268,-2118.46"/>
</g>
<!-- layer_3_expert4_gate -->
<g id="node186" class="node">
<title>layer_3_expert4_gate</title>
<polygon fill="yellow" stroke="black" points="3589.72,-2536.86 3243.72,-2483.86 3589.72,-2430.86 3935.72,-2483.86 3589.72,-2536.86"/>
<text text-anchor="middle" x="3589.72" y="-2495.16" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="3589.72" y="-2480.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="3589.72" y="-2465.16" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_3_expert4_recv&#45;&gt;layer_3_expert4_gate -->
<g id="edge214" class="edge">
<title>layer_3_expert4_recv&#45;&gt;layer_3_expert4_gate</title>
<path fill="none" stroke="black" d="M3589.72,-2572.73C3589.72,-2564.44 3589.72,-2555.79 3589.72,-2547.29"/>
<polygon fill="black" stroke="black" points="3593.22,-2547.03 3589.72,-2537.03 3586.22,-2547.03 3593.22,-2547.03"/>
</g>
<!-- layer_3_expert4 -->
<g id="node187" class="node">
<title>layer_3_expert4</title>
<polygon fill="lightpink" stroke="black" points="3762.72,-2394.86 3416.72,-2394.86 3416.72,-2341.86 3762.72,-2341.86 3762.72,-2394.86"/>
<text text-anchor="middle" x="3589.72" y="-2379.66" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3589.72" y="-2364.66" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="3589.72" y="-2349.66" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_3_expert4_gate&#45;&gt;layer_3_expert4 -->
<g id="edge215" class="edge">
<title>layer_3_expert4_gate&#45;&gt;layer_3_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3589.72,-2430.76C3589.72,-2422.09 3589.72,-2413.27 3589.72,-2405.13"/>
<polygon fill="black" stroke="black" points="3593.22,-2404.87 3589.72,-2394.87 3586.22,-2404.87 3593.22,-2404.87"/>
</g>
<!-- layer_3_expert4_send -->
<g id="node188" class="node">
<title>layer_3_expert4_send</title>
<polygon fill="lightgreen" stroke="black" points="3948.65,-2305.86 3377.67,-2305.86 3230.78,-2199.86 3801.77,-2199.86 3948.65,-2305.86"/>
<text text-anchor="middle" x="3589.72" y="-2264.16" font-family="Times,serif" font-size="14.00">Expert 4 Send</text>
<text text-anchor="middle" x="3589.72" y="-2249.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="3589.72" y="-2234.16" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_3_expert4&#45;&gt;layer_3_expert4_send -->
<g id="edge216" class="edge">
<title>layer_3_expert4&#45;&gt;layer_3_expert4_send</title>
<path fill="none" stroke="black" d="M3589.72,-2341.61C3589.72,-2333.91 3589.72,-2325.11 3589.72,-2316.13"/>
<polygon fill="black" stroke="black" points="3593.22,-2315.96 3589.72,-2305.96 3586.22,-2315.96 3593.22,-2315.96"/>
</g>
<!-- layer_3_expert4_send&#45;&gt;layer_3_exp_agg -->
<g id="edge280" class="edge">
<title>layer_3_expert4_send&#45;&gt;layer_3_exp_agg</title>
<path fill="none" stroke="black" d="M3823.24,-2214.97C3867.48,-2209.06 3913.45,-2203.65 3956.72,-2199.86 4796.78,-2126.19 5796.15,-2113.31 6263.72,-2111.63"/>
<polygon fill="black" stroke="black" points="6264,-2115.13 6273.99,-2111.6 6263.97,-2108.13 6264,-2115.13"/>
</g>
<!-- layer_3_expert5_gate -->
<g id="node190" class="node">
<title>layer_3_expert5_gate</title>
<polygon fill="yellow" stroke="black" points="4324.72,-2536.86 3978.72,-2483.86 4324.72,-2430.86 4670.72,-2483.86 4324.72,-2536.86"/>
<text text-anchor="middle" x="4324.72" y="-2495.16" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="4324.72" y="-2480.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="4324.72" y="-2465.16" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_3_expert5_recv&#45;&gt;layer_3_expert5_gate -->
<g id="edge218" class="edge">
<title>layer_3_expert5_recv&#45;&gt;layer_3_expert5_gate</title>
<path fill="none" stroke="black" d="M4324.72,-2572.73C4324.72,-2564.44 4324.72,-2555.79 4324.72,-2547.29"/>
<polygon fill="black" stroke="black" points="4328.22,-2547.03 4324.72,-2537.03 4321.22,-2547.03 4328.22,-2547.03"/>
</g>
<!-- layer_3_expert5 -->
<g id="node191" class="node">
<title>layer_3_expert5</title>
<polygon fill="lightpink" stroke="black" points="4497.72,-2394.86 4151.72,-2394.86 4151.72,-2341.86 4497.72,-2341.86 4497.72,-2394.86"/>
<text text-anchor="middle" x="4324.72" y="-2379.66" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4324.72" y="-2364.66" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="4324.72" y="-2349.66" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_3_expert5_gate&#45;&gt;layer_3_expert5 -->
<g id="edge219" class="edge">
<title>layer_3_expert5_gate&#45;&gt;layer_3_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4324.72,-2430.76C4324.72,-2422.09 4324.72,-2413.27 4324.72,-2405.13"/>
<polygon fill="black" stroke="black" points="4328.22,-2404.87 4324.72,-2394.87 4321.22,-2404.87 4328.22,-2404.87"/>
</g>
<!-- layer_3_expert5_send -->
<g id="node192" class="node">
<title>layer_3_expert5_send</title>
<polygon fill="lightgreen" stroke="black" points="4683.65,-2305.86 4112.67,-2305.86 3965.78,-2199.86 4536.77,-2199.86 4683.65,-2305.86"/>
<text text-anchor="middle" x="4324.72" y="-2264.16" font-family="Times,serif" font-size="14.00">Expert 5 Send</text>
<text text-anchor="middle" x="4324.72" y="-2249.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="4324.72" y="-2234.16" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_3_expert5&#45;&gt;layer_3_expert5_send -->
<g id="edge220" class="edge">
<title>layer_3_expert5&#45;&gt;layer_3_expert5_send</title>
<path fill="none" stroke="black" d="M4324.72,-2341.61C4324.72,-2333.91 4324.72,-2325.11 4324.72,-2316.13"/>
<polygon fill="black" stroke="black" points="4328.22,-2315.96 4324.72,-2305.96 4321.22,-2315.96 4328.22,-2315.96"/>
</g>
<!-- layer_3_expert5_send&#45;&gt;layer_3_exp_agg -->
<g id="edge281" class="edge">
<title>layer_3_expert5_send&#45;&gt;layer_3_exp_agg</title>
<path fill="none" stroke="black" d="M4558.78,-2215.39C4602.86,-2209.46 4648.63,-2203.93 4691.72,-2199.86 5252.84,-2146.79 5913.52,-2125.07 6270.02,-2116.7"/>
<polygon fill="black" stroke="black" points="6270.3,-2120.19 6280.22,-2116.46 6270.14,-2113.2 6270.3,-2120.19"/>
</g>
<!-- layer_3_expert6_gate -->
<g id="node194" class="node">
<title>layer_3_expert6_gate</title>
<polygon fill="yellow" stroke="black" points="5059.72,-2536.86 4713.72,-2483.86 5059.72,-2430.86 5405.72,-2483.86 5059.72,-2536.86"/>
<text text-anchor="middle" x="5059.72" y="-2495.16" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="5059.72" y="-2480.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5059.72" y="-2465.16" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_3_expert6_recv&#45;&gt;layer_3_expert6_gate -->
<g id="edge222" class="edge">
<title>layer_3_expert6_recv&#45;&gt;layer_3_expert6_gate</title>
<path fill="none" stroke="black" d="M5059.72,-2572.73C5059.72,-2564.44 5059.72,-2555.79 5059.72,-2547.29"/>
<polygon fill="black" stroke="black" points="5063.22,-2547.03 5059.72,-2537.03 5056.22,-2547.03 5063.22,-2547.03"/>
</g>
<!-- layer_3_expert6 -->
<g id="node195" class="node">
<title>layer_3_expert6</title>
<polygon fill="lightpink" stroke="black" points="5232.72,-2394.86 4886.72,-2394.86 4886.72,-2341.86 5232.72,-2341.86 5232.72,-2394.86"/>
<text text-anchor="middle" x="5059.72" y="-2379.66" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="5059.72" y="-2364.66" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5059.72" y="-2349.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_3_expert6_gate&#45;&gt;layer_3_expert6 -->
<g id="edge223" class="edge">
<title>layer_3_expert6_gate&#45;&gt;layer_3_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5059.72,-2430.76C5059.72,-2422.09 5059.72,-2413.27 5059.72,-2405.13"/>
<polygon fill="black" stroke="black" points="5063.22,-2404.87 5059.72,-2394.87 5056.22,-2404.87 5063.22,-2404.87"/>
</g>
<!-- layer_3_expert6_send -->
<g id="node196" class="node">
<title>layer_3_expert6_send</title>
<polygon fill="lightgreen" stroke="black" points="5418.65,-2305.86 4847.67,-2305.86 4700.78,-2199.86 5271.77,-2199.86 5418.65,-2305.86"/>
<text text-anchor="middle" x="5059.72" y="-2264.16" font-family="Times,serif" font-size="14.00">Expert 6 Send</text>
<text text-anchor="middle" x="5059.72" y="-2249.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5059.72" y="-2234.16" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_3_expert6&#45;&gt;layer_3_expert6_send -->
<g id="edge224" class="edge">
<title>layer_3_expert6&#45;&gt;layer_3_expert6_send</title>
<path fill="none" stroke="black" d="M5059.72,-2341.61C5059.72,-2333.91 5059.72,-2325.11 5059.72,-2316.13"/>
<polygon fill="black" stroke="black" points="5063.22,-2315.96 5059.72,-2305.96 5056.22,-2315.96 5063.22,-2315.96"/>
</g>
<!-- layer_3_expert6_send&#45;&gt;layer_3_exp_agg -->
<g id="edge282" class="edge">
<title>layer_3_expert6_send&#45;&gt;layer_3_exp_agg</title>
<path fill="none" stroke="black" d="M5294.88,-2216.37C5338.64,-2210.38 5384.02,-2204.58 5426.72,-2199.86 5720.07,-2167.41 6058.59,-2142.21 6282.4,-2127.25"/>
<polygon fill="black" stroke="black" points="6282.9,-2130.73 6292.64,-2126.57 6282.43,-2123.74 6282.9,-2130.73"/>
</g>
<!-- layer_3_expert7_gate -->
<g id="node198" class="node">
<title>layer_3_expert7_gate</title>
<polygon fill="yellow" stroke="black" points="5794.72,-2536.86 5448.72,-2483.86 5794.72,-2430.86 6140.72,-2483.86 5794.72,-2536.86"/>
<text text-anchor="middle" x="5794.72" y="-2495.16" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="5794.72" y="-2480.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5794.72" y="-2465.16" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_3_expert7_recv&#45;&gt;layer_3_expert7_gate -->
<g id="edge226" class="edge">
<title>layer_3_expert7_recv&#45;&gt;layer_3_expert7_gate</title>
<path fill="none" stroke="black" d="M5794.72,-2572.73C5794.72,-2564.44 5794.72,-2555.79 5794.72,-2547.29"/>
<polygon fill="black" stroke="black" points="5798.22,-2547.03 5794.72,-2537.03 5791.22,-2547.03 5798.22,-2547.03"/>
</g>
<!-- layer_3_expert7 -->
<g id="node199" class="node">
<title>layer_3_expert7</title>
<polygon fill="lightpink" stroke="black" points="5967.72,-2394.86 5621.72,-2394.86 5621.72,-2341.86 5967.72,-2341.86 5967.72,-2394.86"/>
<text text-anchor="middle" x="5794.72" y="-2379.66" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5794.72" y="-2364.66" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5794.72" y="-2349.66" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_3_expert7_gate&#45;&gt;layer_3_expert7 -->
<g id="edge227" class="edge">
<title>layer_3_expert7_gate&#45;&gt;layer_3_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5794.72,-2430.76C5794.72,-2422.09 5794.72,-2413.27 5794.72,-2405.13"/>
<polygon fill="black" stroke="black" points="5798.22,-2404.87 5794.72,-2394.87 5791.22,-2404.87 5798.22,-2404.87"/>
</g>
<!-- layer_3_expert7_send -->
<g id="node200" class="node">
<title>layer_3_expert7_send</title>
<polygon fill="lightgreen" stroke="black" points="6153.65,-2305.86 5582.67,-2305.86 5435.78,-2199.86 6006.77,-2199.86 6153.65,-2305.86"/>
<text text-anchor="middle" x="5794.72" y="-2264.16" font-family="Times,serif" font-size="14.00">Expert 7 Send</text>
<text text-anchor="middle" x="5794.72" y="-2249.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5794.72" y="-2234.16" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_3_expert7&#45;&gt;layer_3_expert7_send -->
<g id="edge228" class="edge">
<title>layer_3_expert7&#45;&gt;layer_3_expert7_send</title>
<path fill="none" stroke="black" d="M5794.72,-2341.61C5794.72,-2333.91 5794.72,-2325.11 5794.72,-2316.13"/>
<polygon fill="black" stroke="black" points="5798.22,-2315.96 5794.72,-2305.96 5791.22,-2315.96 5798.22,-2315.96"/>
</g>
<!-- layer_3_expert7_send&#45;&gt;layer_3_exp_agg -->
<g id="edge283" class="edge">
<title>layer_3_expert7_send&#45;&gt;layer_3_exp_agg</title>
<path fill="none" stroke="black" d="M6019.74,-2209C6113.09,-2191.22 6220.97,-2170.67 6313.39,-2153.06"/>
<polygon fill="black" stroke="black" points="6314.27,-2156.46 6323.43,-2151.15 6312.96,-2149.58 6314.27,-2156.46"/>
</g>
<!-- layer_3_expert8_gate -->
<g id="node202" class="node">
<title>layer_3_expert8_gate</title>
<polygon fill="yellow" stroke="black" points="6529.72,-2536.86 6183.72,-2483.86 6529.72,-2430.86 6875.72,-2483.86 6529.72,-2536.86"/>
<text text-anchor="middle" x="6529.72" y="-2495.16" font-family="Times,serif" font-size="14.00">Expert 8 Gate</text>
<text text-anchor="middle" x="6529.72" y="-2480.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="6529.72" y="-2465.16" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_3_expert8_recv&#45;&gt;layer_3_expert8_gate -->
<g id="edge230" class="edge">
<title>layer_3_expert8_recv&#45;&gt;layer_3_expert8_gate</title>
<path fill="none" stroke="black" d="M6529.72,-2572.73C6529.72,-2564.44 6529.72,-2555.79 6529.72,-2547.29"/>
<polygon fill="black" stroke="black" points="6533.22,-2547.03 6529.72,-2537.03 6526.22,-2547.03 6533.22,-2547.03"/>
</g>
<!-- layer_3_expert8 -->
<g id="node203" class="node">
<title>layer_3_expert8</title>
<polygon fill="lightpink" stroke="black" points="6702.72,-2394.86 6356.72,-2394.86 6356.72,-2341.86 6702.72,-2341.86 6702.72,-2394.86"/>
<text text-anchor="middle" x="6529.72" y="-2379.66" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="6529.72" y="-2364.66" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="6529.72" y="-2349.66" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_3_expert8_gate&#45;&gt;layer_3_expert8 -->
<g id="edge231" class="edge">
<title>layer_3_expert8_gate&#45;&gt;layer_3_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6529.72,-2430.76C6529.72,-2422.09 6529.72,-2413.27 6529.72,-2405.13"/>
<polygon fill="black" stroke="black" points="6533.22,-2404.87 6529.72,-2394.87 6526.22,-2404.87 6533.22,-2404.87"/>
</g>
<!-- layer_3_expert8_send -->
<g id="node204" class="node">
<title>layer_3_expert8_send</title>
<polygon fill="lightgreen" stroke="black" points="6888.65,-2305.86 6317.67,-2305.86 6170.78,-2199.86 6741.77,-2199.86 6888.65,-2305.86"/>
<text text-anchor="middle" x="6529.72" y="-2264.16" font-family="Times,serif" font-size="14.00">Expert 8 Send</text>
<text text-anchor="middle" x="6529.72" y="-2249.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="6529.72" y="-2234.16" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_3_expert8&#45;&gt;layer_3_expert8_send -->
<g id="edge232" class="edge">
<title>layer_3_expert8&#45;&gt;layer_3_expert8_send</title>
<path fill="none" stroke="black" d="M6529.72,-2341.61C6529.72,-2333.91 6529.72,-2325.11 6529.72,-2316.13"/>
<polygon fill="black" stroke="black" points="6533.22,-2315.96 6529.72,-2305.96 6526.22,-2315.96 6533.22,-2315.96"/>
</g>
<!-- layer_3_expert8_send&#45;&gt;layer_3_exp_agg -->
<g id="edge284" class="edge">
<title>layer_3_expert8_send&#45;&gt;layer_3_exp_agg</title>
<path fill="none" stroke="black" d="M6529.72,-2199.73C6529.72,-2191.44 6529.72,-2182.79 6529.72,-2174.29"/>
<polygon fill="black" stroke="black" points="6533.22,-2174.03 6529.72,-2164.03 6526.22,-2174.03 6533.22,-2174.03"/>
</g>
<!-- layer_3_expert9_gate -->
<g id="node206" class="node">
<title>layer_3_expert9_gate</title>
<polygon fill="yellow" stroke="black" points="7264.72,-2536.86 6918.72,-2483.86 7264.72,-2430.86 7610.72,-2483.86 7264.72,-2536.86"/>
<text text-anchor="middle" x="7264.72" y="-2495.16" font-family="Times,serif" font-size="14.00">Expert 9 Gate</text>
<text text-anchor="middle" x="7264.72" y="-2480.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="7264.72" y="-2465.16" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_3_expert9_recv&#45;&gt;layer_3_expert9_gate -->
<g id="edge234" class="edge">
<title>layer_3_expert9_recv&#45;&gt;layer_3_expert9_gate</title>
<path fill="none" stroke="black" d="M7264.72,-2572.73C7264.72,-2564.44 7264.72,-2555.79 7264.72,-2547.29"/>
<polygon fill="black" stroke="black" points="7268.22,-2547.03 7264.72,-2537.03 7261.22,-2547.03 7268.22,-2547.03"/>
</g>
<!-- layer_3_expert9 -->
<g id="node207" class="node">
<title>layer_3_expert9</title>
<polygon fill="lightpink" stroke="black" points="7437.72,-2394.86 7091.72,-2394.86 7091.72,-2341.86 7437.72,-2341.86 7437.72,-2394.86"/>
<text text-anchor="middle" x="7264.72" y="-2379.66" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="7264.72" y="-2364.66" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="7264.72" y="-2349.66" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_3_expert9_gate&#45;&gt;layer_3_expert9 -->
<g id="edge235" class="edge">
<title>layer_3_expert9_gate&#45;&gt;layer_3_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7264.72,-2430.76C7264.72,-2422.09 7264.72,-2413.27 7264.72,-2405.13"/>
<polygon fill="black" stroke="black" points="7268.22,-2404.87 7264.72,-2394.87 7261.22,-2404.87 7268.22,-2404.87"/>
</g>
<!-- layer_3_expert9_send -->
<g id="node208" class="node">
<title>layer_3_expert9_send</title>
<polygon fill="lightgreen" stroke="black" points="7623.65,-2305.86 7052.67,-2305.86 6905.78,-2199.86 7476.77,-2199.86 7623.65,-2305.86"/>
<text text-anchor="middle" x="7264.72" y="-2264.16" font-family="Times,serif" font-size="14.00">Expert 9 Send</text>
<text text-anchor="middle" x="7264.72" y="-2249.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="7264.72" y="-2234.16" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_3_expert9&#45;&gt;layer_3_expert9_send -->
<g id="edge236" class="edge">
<title>layer_3_expert9&#45;&gt;layer_3_expert9_send</title>
<path fill="none" stroke="black" d="M7264.72,-2341.61C7264.72,-2333.91 7264.72,-2325.11 7264.72,-2316.13"/>
<polygon fill="black" stroke="black" points="7268.22,-2315.96 7264.72,-2305.96 7261.22,-2315.96 7268.22,-2315.96"/>
</g>
<!-- layer_3_expert9_send&#45;&gt;layer_3_exp_agg -->
<g id="edge285" class="edge">
<title>layer_3_expert9_send&#45;&gt;layer_3_exp_agg</title>
<path fill="none" stroke="black" d="M6991.55,-2199.83C6933.26,-2188.73 6871.58,-2176.98 6812.92,-2165.8"/>
<polygon fill="black" stroke="black" points="6813.25,-2162.3 6802.78,-2163.87 6811.94,-2169.18 6813.25,-2162.3"/>
</g>
<!-- layer_3_expert10_gate -->
<g id="node210" class="node">
<title>layer_3_expert10_gate</title>
<polygon fill="yellow" stroke="black" points="7999.72,-2536.86 7653.72,-2483.86 7999.72,-2430.86 8345.72,-2483.86 7999.72,-2536.86"/>
<text text-anchor="middle" x="7999.72" y="-2495.16" font-family="Times,serif" font-size="14.00">Expert 10 Gate</text>
<text text-anchor="middle" x="7999.72" y="-2480.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="7999.72" y="-2465.16" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_3_expert10_recv&#45;&gt;layer_3_expert10_gate -->
<g id="edge238" class="edge">
<title>layer_3_expert10_recv&#45;&gt;layer_3_expert10_gate</title>
<path fill="none" stroke="black" d="M7999.72,-2572.73C7999.72,-2564.44 7999.72,-2555.79 7999.72,-2547.29"/>
<polygon fill="black" stroke="black" points="8003.22,-2547.03 7999.72,-2537.03 7996.22,-2547.03 8003.22,-2547.03"/>
</g>
<!-- layer_3_expert10 -->
<g id="node211" class="node">
<title>layer_3_expert10</title>
<polygon fill="lightpink" stroke="black" points="8172.72,-2394.86 7826.72,-2394.86 7826.72,-2341.86 8172.72,-2341.86 8172.72,-2394.86"/>
<text text-anchor="middle" x="7999.72" y="-2379.66" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="7999.72" y="-2364.66" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="7999.72" y="-2349.66" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_3_expert10_gate&#45;&gt;layer_3_expert10 -->
<g id="edge239" class="edge">
<title>layer_3_expert10_gate&#45;&gt;layer_3_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7999.72,-2430.76C7999.72,-2422.09 7999.72,-2413.27 7999.72,-2405.13"/>
<polygon fill="black" stroke="black" points="8003.22,-2404.87 7999.72,-2394.87 7996.22,-2404.87 8003.22,-2404.87"/>
</g>
<!-- layer_3_expert10_send -->
<g id="node212" class="node">
<title>layer_3_expert10_send</title>
<polygon fill="lightgreen" stroke="black" points="8358.65,-2305.86 7787.67,-2305.86 7640.78,-2199.86 8211.77,-2199.86 8358.65,-2305.86"/>
<text text-anchor="middle" x="7999.72" y="-2264.16" font-family="Times,serif" font-size="14.00">Expert 10 Send</text>
<text text-anchor="middle" x="7999.72" y="-2249.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="7999.72" y="-2234.16" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_3_expert10&#45;&gt;layer_3_expert10_send -->
<g id="edge240" class="edge">
<title>layer_3_expert10&#45;&gt;layer_3_expert10_send</title>
<path fill="none" stroke="black" d="M7999.72,-2341.61C7999.72,-2333.91 7999.72,-2325.11 7999.72,-2316.13"/>
<polygon fill="black" stroke="black" points="8003.22,-2315.96 7999.72,-2305.96 7996.22,-2315.96 8003.22,-2315.96"/>
</g>
<!-- layer_3_expert10_send&#45;&gt;layer_3_exp_agg -->
<g id="edge286" class="edge">
<title>layer_3_expert10_send&#45;&gt;layer_3_exp_agg</title>
<path fill="none" stroke="black" d="M7641.87,-2200.88C7638.81,-2200.54 7635.75,-2200.2 7632.72,-2199.86 7357.35,-2169.4 7042.17,-2145.33 6819.44,-2130.12"/>
<polygon fill="black" stroke="black" points="6819.46,-2126.61 6809.24,-2129.42 6818.98,-2133.59 6819.46,-2126.61"/>
</g>
<!-- layer_3_expert11_gate -->
<g id="node214" class="node">
<title>layer_3_expert11_gate</title>
<polygon fill="yellow" stroke="black" points="8734.72,-2536.86 8388.72,-2483.86 8734.72,-2430.86 9080.72,-2483.86 8734.72,-2536.86"/>
<text text-anchor="middle" x="8734.72" y="-2495.16" font-family="Times,serif" font-size="14.00">Expert 11 Gate</text>
<text text-anchor="middle" x="8734.72" y="-2480.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8734.72" y="-2465.16" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_3_expert11_recv&#45;&gt;layer_3_expert11_gate -->
<g id="edge242" class="edge">
<title>layer_3_expert11_recv&#45;&gt;layer_3_expert11_gate</title>
<path fill="none" stroke="black" d="M8734.72,-2572.73C8734.72,-2564.44 8734.72,-2555.79 8734.72,-2547.29"/>
<polygon fill="black" stroke="black" points="8738.22,-2547.03 8734.72,-2537.03 8731.22,-2547.03 8738.22,-2547.03"/>
</g>
<!-- layer_3_expert11 -->
<g id="node215" class="node">
<title>layer_3_expert11</title>
<polygon fill="lightpink" stroke="black" points="8907.72,-2394.86 8561.72,-2394.86 8561.72,-2341.86 8907.72,-2341.86 8907.72,-2394.86"/>
<text text-anchor="middle" x="8734.72" y="-2379.66" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="8734.72" y="-2364.66" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8734.72" y="-2349.66" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_3_expert11_gate&#45;&gt;layer_3_expert11 -->
<g id="edge243" class="edge">
<title>layer_3_expert11_gate&#45;&gt;layer_3_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8734.72,-2430.76C8734.72,-2422.09 8734.72,-2413.27 8734.72,-2405.13"/>
<polygon fill="black" stroke="black" points="8738.22,-2404.87 8734.72,-2394.87 8731.22,-2404.87 8738.22,-2404.87"/>
</g>
<!-- layer_3_expert11_send -->
<g id="node216" class="node">
<title>layer_3_expert11_send</title>
<polygon fill="lightgreen" stroke="black" points="9093.65,-2305.86 8522.67,-2305.86 8375.78,-2199.86 8946.77,-2199.86 9093.65,-2305.86"/>
<text text-anchor="middle" x="8734.72" y="-2264.16" font-family="Times,serif" font-size="14.00">Expert 11 Send</text>
<text text-anchor="middle" x="8734.72" y="-2249.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8734.72" y="-2234.16" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_3_expert11&#45;&gt;layer_3_expert11_send -->
<g id="edge244" class="edge">
<title>layer_3_expert11&#45;&gt;layer_3_expert11_send</title>
<path fill="none" stroke="black" d="M8734.72,-2341.61C8734.72,-2333.91 8734.72,-2325.11 8734.72,-2316.13"/>
<polygon fill="black" stroke="black" points="8738.22,-2315.96 8734.72,-2305.96 8731.22,-2315.96 8738.22,-2315.96"/>
</g>
<!-- layer_3_expert11_send&#45;&gt;layer_3_exp_agg -->
<g id="edge287" class="edge">
<title>layer_3_expert11_send&#45;&gt;layer_3_exp_agg</title>
<path fill="none" stroke="black" d="M8376.88,-2200.74C8373.82,-2200.44 8370.76,-2200.15 8367.72,-2199.86 7813.94,-2147.49 7163.19,-2125.65 6803.57,-2117.03"/>
<polygon fill="black" stroke="black" points="6803.62,-2113.54 6793.54,-2116.8 6803.46,-2120.53 6803.62,-2113.54"/>
</g>
<!-- layer_3_expert12_gate -->
<g id="node218" class="node">
<title>layer_3_expert12_gate</title>
<polygon fill="yellow" stroke="black" points="9469.72,-2536.86 9123.72,-2483.86 9469.72,-2430.86 9815.72,-2483.86 9469.72,-2536.86"/>
<text text-anchor="middle" x="9469.72" y="-2495.16" font-family="Times,serif" font-size="14.00">Expert 12 Gate</text>
<text text-anchor="middle" x="9469.72" y="-2480.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="9469.72" y="-2465.16" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_3_expert12_recv&#45;&gt;layer_3_expert12_gate -->
<g id="edge246" class="edge">
<title>layer_3_expert12_recv&#45;&gt;layer_3_expert12_gate</title>
<path fill="none" stroke="black" d="M9469.72,-2572.73C9469.72,-2564.44 9469.72,-2555.79 9469.72,-2547.29"/>
<polygon fill="black" stroke="black" points="9473.22,-2547.03 9469.72,-2537.03 9466.22,-2547.03 9473.22,-2547.03"/>
</g>
<!-- layer_3_expert12 -->
<g id="node219" class="node">
<title>layer_3_expert12</title>
<polygon fill="lightpink" stroke="black" points="9642.72,-2394.86 9296.72,-2394.86 9296.72,-2341.86 9642.72,-2341.86 9642.72,-2394.86"/>
<text text-anchor="middle" x="9469.72" y="-2379.66" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="9469.72" y="-2364.66" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="9469.72" y="-2349.66" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_3_expert12_gate&#45;&gt;layer_3_expert12 -->
<g id="edge247" class="edge">
<title>layer_3_expert12_gate&#45;&gt;layer_3_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9469.72,-2430.76C9469.72,-2422.09 9469.72,-2413.27 9469.72,-2405.13"/>
<polygon fill="black" stroke="black" points="9473.22,-2404.87 9469.72,-2394.87 9466.22,-2404.87 9473.22,-2404.87"/>
</g>
<!-- layer_3_expert12_send -->
<g id="node220" class="node">
<title>layer_3_expert12_send</title>
<polygon fill="lightgreen" stroke="black" points="9828.65,-2305.86 9257.67,-2305.86 9110.78,-2199.86 9681.77,-2199.86 9828.65,-2305.86"/>
<text text-anchor="middle" x="9469.72" y="-2264.16" font-family="Times,serif" font-size="14.00">Expert 12 Send</text>
<text text-anchor="middle" x="9469.72" y="-2249.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="9469.72" y="-2234.16" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_3_expert12&#45;&gt;layer_3_expert12_send -->
<g id="edge248" class="edge">
<title>layer_3_expert12&#45;&gt;layer_3_expert12_send</title>
<path fill="none" stroke="black" d="M9469.72,-2341.61C9469.72,-2333.91 9469.72,-2325.11 9469.72,-2316.13"/>
<polygon fill="black" stroke="black" points="9473.22,-2315.96 9469.72,-2305.96 9466.22,-2315.96 9473.22,-2315.96"/>
</g>
<!-- layer_3_expert12_send&#45;&gt;layer_3_exp_agg -->
<g id="edge288" class="edge">
<title>layer_3_expert12_send&#45;&gt;layer_3_exp_agg</title>
<path fill="none" stroke="black" d="M9111.89,-2200.68C9108.82,-2200.4 9105.76,-2200.13 9102.72,-2199.86 8263.76,-2126.29 7265.91,-2113.35 6797.56,-2111.64"/>
<polygon fill="black" stroke="black" points="6797.29,-2108.14 6787.28,-2111.6 6797.27,-2115.14 6797.29,-2108.14"/>
</g>
<!-- layer_3_expert13_gate -->
<g id="node222" class="node">
<title>layer_3_expert13_gate</title>
<polygon fill="yellow" stroke="black" points="10204.72,-2536.86 9858.72,-2483.86 10204.72,-2430.86 10550.72,-2483.86 10204.72,-2536.86"/>
<text text-anchor="middle" x="10204.72" y="-2495.16" font-family="Times,serif" font-size="14.00">Expert 13 Gate</text>
<text text-anchor="middle" x="10204.72" y="-2480.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10204.72" y="-2465.16" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_3_expert13_recv&#45;&gt;layer_3_expert13_gate -->
<g id="edge250" class="edge">
<title>layer_3_expert13_recv&#45;&gt;layer_3_expert13_gate</title>
<path fill="none" stroke="black" d="M10204.72,-2572.73C10204.72,-2564.44 10204.72,-2555.79 10204.72,-2547.29"/>
<polygon fill="black" stroke="black" points="10208.22,-2547.03 10204.72,-2537.03 10201.22,-2547.03 10208.22,-2547.03"/>
</g>
<!-- layer_3_expert13 -->
<g id="node223" class="node">
<title>layer_3_expert13</title>
<polygon fill="lightpink" stroke="black" points="10377.72,-2394.86 10031.72,-2394.86 10031.72,-2341.86 10377.72,-2341.86 10377.72,-2394.86"/>
<text text-anchor="middle" x="10204.72" y="-2379.66" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="10204.72" y="-2364.66" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10204.72" y="-2349.66" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_3_expert13_gate&#45;&gt;layer_3_expert13 -->
<g id="edge251" class="edge">
<title>layer_3_expert13_gate&#45;&gt;layer_3_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10204.72,-2430.76C10204.72,-2422.09 10204.72,-2413.27 10204.72,-2405.13"/>
<polygon fill="black" stroke="black" points="10208.22,-2404.87 10204.72,-2394.87 10201.22,-2404.87 10208.22,-2404.87"/>
</g>
<!-- layer_3_expert13_send -->
<g id="node224" class="node">
<title>layer_3_expert13_send</title>
<polygon fill="lightgreen" stroke="black" points="10563.65,-2305.86 9992.67,-2305.86 9845.78,-2199.86 10416.77,-2199.86 10563.65,-2305.86"/>
<text text-anchor="middle" x="10204.72" y="-2264.16" font-family="Times,serif" font-size="14.00">Expert 13 Send</text>
<text text-anchor="middle" x="10204.72" y="-2249.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10204.72" y="-2234.16" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_3_expert13&#45;&gt;layer_3_expert13_send -->
<g id="edge252" class="edge">
<title>layer_3_expert13&#45;&gt;layer_3_expert13_send</title>
<path fill="none" stroke="black" d="M10204.72,-2341.61C10204.72,-2333.91 10204.72,-2325.11 10204.72,-2316.13"/>
<polygon fill="black" stroke="black" points="10208.22,-2315.96 10204.72,-2305.96 10201.22,-2315.96 10208.22,-2315.96"/>
</g>
<!-- layer_3_expert13_send&#45;&gt;layer_3_exp_agg -->
<g id="edge289" class="edge">
<title>layer_3_expert13_send&#45;&gt;layer_3_exp_agg</title>
<path fill="none" stroke="black" d="M9846.41,-2200.61C9843.5,-2200.35 9840.6,-2200.1 9837.72,-2199.86 9250.99,-2150.65 7483.19,-2123.83 6801.71,-2115.09"/>
<polygon fill="black" stroke="black" points="6801.56,-2111.59 6791.51,-2114.96 6801.47,-2118.59 6801.56,-2111.59"/>
</g>
<!-- layer_3_expert14_gate -->
<g id="node226" class="node">
<title>layer_3_expert14_gate</title>
<polygon fill="yellow" stroke="black" points="10939.72,-2536.86 10593.72,-2483.86 10939.72,-2430.86 11285.72,-2483.86 10939.72,-2536.86"/>
<text text-anchor="middle" x="10939.72" y="-2495.16" font-family="Times,serif" font-size="14.00">Expert 14 Gate</text>
<text text-anchor="middle" x="10939.72" y="-2480.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10939.72" y="-2465.16" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_3_expert14_recv&#45;&gt;layer_3_expert14_gate -->
<g id="edge254" class="edge">
<title>layer_3_expert14_recv&#45;&gt;layer_3_expert14_gate</title>
<path fill="none" stroke="black" d="M10939.72,-2572.73C10939.72,-2564.44 10939.72,-2555.79 10939.72,-2547.29"/>
<polygon fill="black" stroke="black" points="10943.22,-2547.03 10939.72,-2537.03 10936.22,-2547.03 10943.22,-2547.03"/>
</g>
<!-- layer_3_expert14 -->
<g id="node227" class="node">
<title>layer_3_expert14</title>
<polygon fill="lightpink" stroke="black" points="11112.72,-2394.86 10766.72,-2394.86 10766.72,-2341.86 11112.72,-2341.86 11112.72,-2394.86"/>
<text text-anchor="middle" x="10939.72" y="-2379.66" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="10939.72" y="-2364.66" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10939.72" y="-2349.66" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_3_expert14_gate&#45;&gt;layer_3_expert14 -->
<g id="edge255" class="edge">
<title>layer_3_expert14_gate&#45;&gt;layer_3_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10939.72,-2430.76C10939.72,-2422.09 10939.72,-2413.27 10939.72,-2405.13"/>
<polygon fill="black" stroke="black" points="10943.22,-2404.87 10939.72,-2394.87 10936.22,-2404.87 10943.22,-2404.87"/>
</g>
<!-- layer_3_expert14_send -->
<g id="node228" class="node">
<title>layer_3_expert14_send</title>
<polygon fill="lightgreen" stroke="black" points="11298.65,-2305.86 10727.67,-2305.86 10580.78,-2199.86 11151.77,-2199.86 11298.65,-2305.86"/>
<text text-anchor="middle" x="10939.72" y="-2264.16" font-family="Times,serif" font-size="14.00">Expert 14 Send</text>
<text text-anchor="middle" x="10939.72" y="-2249.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10939.72" y="-2234.16" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_3_expert14&#45;&gt;layer_3_expert14_send -->
<g id="edge256" class="edge">
<title>layer_3_expert14&#45;&gt;layer_3_expert14_send</title>
<path fill="none" stroke="black" d="M10939.72,-2341.61C10939.72,-2333.91 10939.72,-2325.11 10939.72,-2316.13"/>
<polygon fill="black" stroke="black" points="10943.22,-2315.96 10939.72,-2305.96 10936.22,-2315.96 10943.22,-2315.96"/>
</g>
<!-- layer_3_expert14_send&#45;&gt;layer_3_exp_agg -->
<g id="edge290" class="edge">
<title>layer_3_expert14_send&#45;&gt;layer_3_exp_agg</title>
<path fill="none" stroke="black" d="M10581.41,-2200.59C10578.5,-2200.34 10575.6,-2200.1 10572.72,-2199.86 9836.84,-2139.93 7581.19,-2119.08 6799.65,-2113.54"/>
<polygon fill="black" stroke="black" points="6799.42,-2110.04 6789.39,-2113.47 6799.37,-2117.04 6799.42,-2110.04"/>
</g>
<!-- layer_3_expert15_gate -->
<g id="node230" class="node">
<title>layer_3_expert15_gate</title>
<polygon fill="yellow" stroke="black" points="11674.72,-2536.86 11328.72,-2483.86 11674.72,-2430.86 12020.72,-2483.86 11674.72,-2536.86"/>
<text text-anchor="middle" x="11674.72" y="-2495.16" font-family="Times,serif" font-size="14.00">Expert 15 Gate</text>
<text text-anchor="middle" x="11674.72" y="-2480.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="11674.72" y="-2465.16" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_3_expert15_recv&#45;&gt;layer_3_expert15_gate -->
<g id="edge258" class="edge">
<title>layer_3_expert15_recv&#45;&gt;layer_3_expert15_gate</title>
<path fill="none" stroke="black" d="M11674.72,-2572.73C11674.72,-2564.44 11674.72,-2555.79 11674.72,-2547.29"/>
<polygon fill="black" stroke="black" points="11678.22,-2547.03 11674.72,-2537.03 11671.22,-2547.03 11678.22,-2547.03"/>
</g>
<!-- layer_3_expert15 -->
<g id="node231" class="node">
<title>layer_3_expert15</title>
<polygon fill="lightpink" stroke="black" points="11847.72,-2394.86 11501.72,-2394.86 11501.72,-2341.86 11847.72,-2341.86 11847.72,-2394.86"/>
<text text-anchor="middle" x="11674.72" y="-2379.66" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="11674.72" y="-2364.66" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="11674.72" y="-2349.66" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_3_expert15_gate&#45;&gt;layer_3_expert15 -->
<g id="edge259" class="edge">
<title>layer_3_expert15_gate&#45;&gt;layer_3_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11674.72,-2430.76C11674.72,-2422.09 11674.72,-2413.27 11674.72,-2405.13"/>
<polygon fill="black" stroke="black" points="11678.22,-2404.87 11674.72,-2394.87 11671.22,-2404.87 11678.22,-2404.87"/>
</g>
<!-- layer_3_expert15_send -->
<g id="node232" class="node">
<title>layer_3_expert15_send</title>
<polygon fill="lightgreen" stroke="black" points="12033.65,-2305.86 11462.67,-2305.86 11315.78,-2199.86 11886.77,-2199.86 12033.65,-2305.86"/>
<text text-anchor="middle" x="11674.72" y="-2264.16" font-family="Times,serif" font-size="14.00">Expert 15 Send</text>
<text text-anchor="middle" x="11674.72" y="-2249.16" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="11674.72" y="-2234.16" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_3_expert15&#45;&gt;layer_3_expert15_send -->
<g id="edge260" class="edge">
<title>layer_3_expert15&#45;&gt;layer_3_expert15_send</title>
<path fill="none" stroke="black" d="M11674.72,-2341.61C11674.72,-2333.91 11674.72,-2325.11 11674.72,-2316.13"/>
<polygon fill="black" stroke="black" points="11678.22,-2315.96 11674.72,-2305.96 11671.22,-2315.96 11678.22,-2315.96"/>
</g>
<!-- layer_3_expert15_send&#45;&gt;layer_3_exp_agg -->
<g id="edge291" class="edge">
<title>layer_3_expert15_send&#45;&gt;layer_3_exp_agg</title>
<path fill="none" stroke="black" d="M11316.41,-2200.57C11313.5,-2200.33 11310.6,-2200.09 11307.72,-2199.86 10421.62,-2129.19 7671.22,-2115.17 6798.39,-2112.48"/>
<polygon fill="black" stroke="black" points="6798.22,-2108.98 6788.21,-2112.45 6798.2,-2115.98 6798.22,-2108.98"/>
</g>
<!-- layer_3_exp_agg&#45;&gt;layer_3_exp_res -->
<g id="edge292" class="edge">
<title>layer_3_exp_agg&#45;&gt;layer_3_exp_res</title>
<path fill="none" stroke="black" d="M6772.76,-2099.89C7324.67,-2077.24 8660.91,-2022.41 9129.77,-2003.17"/>
<polygon fill="black" stroke="black" points="9130.16,-2006.66 9140,-2002.75 9129.87,-1999.66 9130.16,-2006.66"/>
</g>
<!-- layer_3_output -->
<g id="node235" class="node">
<title>layer_3_output</title>
<ellipse fill="lightgreen" stroke="black" cx="9295.72" cy="-1895.38" rx="219.82" ry="37.45"/>
<text text-anchor="middle" x="9295.72" y="-1906.68" font-family="Times,serif" font-size="14.00">Layer 3 Output</text>
<text text-anchor="middle" x="9295.72" y="-1891.68" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9295.72" y="-1876.68" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_3_exp_res&#45;&gt;layer_3_output -->
<g id="edge294" class="edge">
<title>layer_3_exp_res&#45;&gt;layer_3_output</title>
<path fill="none" stroke="black" d="M9295.72,-1968.62C9295.72,-1960.79 9295.72,-1951.94 9295.72,-1943.18"/>
<polygon fill="black" stroke="black" points="9299.22,-1943.01 9295.72,-1933.01 9292.22,-1943.01 9299.22,-1943.01"/>
</g>
<!-- layer_4_input -->
<g id="node236" class="node">
<title>layer_4_input</title>
<ellipse fill="lightgreen" stroke="black" cx="9295.72" cy="-1784.43" rx="219.82" ry="37.45"/>
<text text-anchor="middle" x="9295.72" y="-1795.73" font-family="Times,serif" font-size="14.00">Layer 4 Input</text>
<text text-anchor="middle" x="9295.72" y="-1780.73" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9295.72" y="-1765.73" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_3_output&#45;&gt;layer_4_input -->
<g id="edge359" class="edge">
<title>layer_3_output&#45;&gt;layer_4_input</title>
<path fill="none" stroke="black" d="M9295.72,-1857.8C9295.72,-1849.63 9295.72,-1840.85 9295.72,-1832.32"/>
<polygon fill="black" stroke="black" points="9299.22,-1832.1 9295.72,-1822.1 9292.22,-1832.1 9299.22,-1832.1"/>
</g>
<!-- layer_4_mha_norm -->
<g id="node237" class="node">
<title>layer_4_mha_norm</title>
<polygon fill="lightcoral" stroke="black" points="9195.22,-1710.95 8884.22,-1710.95 8884.22,-1657.95 9195.22,-1657.95 9195.22,-1710.95"/>
<text text-anchor="middle" x="9039.72" y="-1695.75" font-family="Times,serif" font-size="14.00">MHA LayerNorm 4</text>
<text text-anchor="middle" x="9039.72" y="-1680.75" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9039.72" y="-1665.75" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_4_input&#45;&gt;layer_4_mha_norm -->
<g id="edge360" class="edge">
<title>layer_4_input&#45;&gt;layer_4_mha_norm</title>
<path fill="none" stroke="black" d="M9208.33,-1749.99C9178.4,-1738.53 9145.16,-1725.81 9116.17,-1714.71"/>
<polygon fill="black" stroke="black" points="9117.1,-1711.32 9106.5,-1711.01 9114.59,-1717.86 9117.1,-1711.32"/>
</g>
<!-- layer_4_mha_res -->
<g id="node243" class="node">
<title>layer_4_mha_res</title>
<polygon fill="lightyellow" stroke="black" points="9329.22,-1354.95 9018.22,-1354.95 9018.22,-1301.95 9329.22,-1301.95 9329.22,-1354.95"/>
<text text-anchor="middle" x="9173.72" y="-1339.75" font-family="Times,serif" font-size="14.00">MHA Residual 4</text>
<text text-anchor="middle" x="9173.72" y="-1324.75" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9173.72" y="-1309.75" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_4_input&#45;&gt;layer_4_mha_res -->
<g id="edge369" class="edge">
<title>layer_4_input&#45;&gt;layer_4_mha_res</title>
<path fill="none" stroke="black" d="M9340.11,-1747.63C9377.43,-1713.23 9424.72,-1657.58 9424.72,-1596.45 9424.72,-1596.45 9424.72,-1596.45 9424.72,-1505.45 9424.72,-1430.35 9348.45,-1384.57 9280,-1358.6"/>
<polygon fill="black" stroke="black" points="9280.99,-1355.24 9270.4,-1355.07 9278.58,-1361.81 9280.99,-1355.24"/>
</g>
<!-- layer_4_mha_q -->
<g id="node238" class="node">
<title>layer_4_mha_q</title>
<polygon fill="lightblue" stroke="black" points="8738.22,-1621.95 8427.22,-1621.95 8427.22,-1568.95 8738.22,-1568.95 8738.22,-1621.95"/>
<text text-anchor="middle" x="8582.72" y="-1606.75" font-family="Times,serif" font-size="14.00">MHA Q Proj 4</text>
<text text-anchor="middle" x="8582.72" y="-1591.75" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="8582.72" y="-1576.75" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_4_mha_norm&#45;&gt;layer_4_mha_q -->
<g id="edge361" class="edge">
<title>layer_4_mha_norm&#45;&gt;layer_4_mha_q</title>
<path fill="none" stroke="black" d="M8905.69,-1657.94C8849.42,-1647.23 8783.88,-1634.75 8726.6,-1623.84"/>
<polygon fill="black" stroke="black" points="8727.22,-1620.4 8716.74,-1621.97 8725.91,-1627.28 8727.22,-1620.4"/>
</g>
<!-- layer_4_mha_k -->
<g id="node239" class="node">
<title>layer_4_mha_k</title>
<polygon fill="lightblue" stroke="black" points="9067.22,-1621.95 8756.22,-1621.95 8756.22,-1568.95 9067.22,-1568.95 9067.22,-1621.95"/>
<text text-anchor="middle" x="8911.72" y="-1606.75" font-family="Times,serif" font-size="14.00">MHA K Proj 4</text>
<text text-anchor="middle" x="8911.72" y="-1591.75" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="8911.72" y="-1576.75" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_4_mha_norm&#45;&gt;layer_4_mha_k -->
<g id="edge362" class="edge">
<title>layer_4_mha_norm&#45;&gt;layer_4_mha_k</title>
<path fill="none" stroke="black" d="M9002,-1657.82C8988.2,-1648.44 8972.41,-1637.71 8957.94,-1627.87"/>
<polygon fill="black" stroke="black" points="8959.84,-1624.93 8949.6,-1622.2 8955.9,-1630.72 8959.84,-1624.93"/>
</g>
<!-- layer_4_mha_v -->
<g id="node240" class="node">
<title>layer_4_mha_v</title>
<polygon fill="lightblue" stroke="black" points="9396.22,-1621.95 9085.22,-1621.95 9085.22,-1568.95 9396.22,-1568.95 9396.22,-1621.95"/>
<text text-anchor="middle" x="9240.72" y="-1606.75" font-family="Times,serif" font-size="14.00">MHA V Proj 4</text>
<text text-anchor="middle" x="9240.72" y="-1591.75" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9240.72" y="-1576.75" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_4_mha_norm&#45;&gt;layer_4_mha_v -->
<g id="edge363" class="edge">
<title>layer_4_mha_norm&#45;&gt;layer_4_mha_v</title>
<path fill="none" stroke="black" d="M9098.67,-1657.94C9121.78,-1647.93 9148.45,-1636.39 9172.39,-1626.03"/>
<polygon fill="black" stroke="black" points="9173.98,-1629.15 9181.77,-1621.97 9171.2,-1622.73 9173.98,-1629.15"/>
</g>
<!-- layer_4_mha_attn -->
<g id="node241" class="node">
<title>layer_4_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="9244.72,-1532.95 8882.72,-1532.95 8882.72,-1479.95 9244.72,-1479.95 9244.72,-1532.95"/>
<text text-anchor="middle" x="9063.72" y="-1517.75" font-family="Times,serif" font-size="14.00">MHA 4</text>
<text text-anchor="middle" x="9063.72" y="-1502.75" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, heads=16, dim=512]</text>
<text text-anchor="middle" x="9063.72" y="-1487.75" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_4_mha_q&#45;&gt;layer_4_mha_attn -->
<g id="edge364" class="edge">
<title>layer_4_mha_q&#45;&gt;layer_4_mha_attn</title>
<path fill="none" stroke="black" d="M8723.78,-1568.94C8783.13,-1558.2 8852.28,-1545.7 8912.65,-1534.78"/>
<polygon fill="black" stroke="black" points="8913.44,-1538.19 8922.65,-1532.97 8912.19,-1531.3 8913.44,-1538.19"/>
</g>
<!-- layer_4_mha_k&#45;&gt;layer_4_mha_attn -->
<g id="edge365" class="edge">
<title>layer_4_mha_k&#45;&gt;layer_4_mha_attn</title>
<path fill="none" stroke="black" d="M8956.5,-1568.82C8973.28,-1559.22 8992.51,-1548.21 9010.02,-1538.19"/>
<polygon fill="black" stroke="black" points="9012.05,-1541.06 9018.99,-1533.05 9008.57,-1534.98 9012.05,-1541.06"/>
</g>
<!-- layer_4_mha_v&#45;&gt;layer_4_mha_attn -->
<g id="edge366" class="edge">
<title>layer_4_mha_v&#45;&gt;layer_4_mha_attn</title>
<path fill="none" stroke="black" d="M9188.57,-1568.82C9168.58,-1559 9145.6,-1547.7 9124.85,-1537.5"/>
<polygon fill="black" stroke="black" points="9126.32,-1534.32 9115.8,-1533.05 9123.23,-1540.6 9126.32,-1534.32"/>
</g>
<!-- layer_4_mha_o -->
<g id="node242" class="node">
<title>layer_4_mha_o</title>
<polygon fill="lightblue" stroke="black" points="9231.22,-1443.95 8920.22,-1443.95 8920.22,-1390.95 9231.22,-1390.95 9231.22,-1443.95"/>
<text text-anchor="middle" x="9075.72" y="-1428.75" font-family="Times,serif" font-size="14.00">MHA O Proj 4</text>
<text text-anchor="middle" x="9075.72" y="-1413.75" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9075.72" y="-1398.75" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_4_mha_attn&#45;&gt;layer_4_mha_o -->
<g id="edge367" class="edge">
<title>layer_4_mha_attn&#45;&gt;layer_4_mha_o</title>
<path fill="none" stroke="black" d="M9067.25,-1479.82C9068.35,-1471.84 9069.59,-1462.89 9070.77,-1454.34"/>
<polygon fill="black" stroke="black" points="9074.27,-1454.59 9072.16,-1444.2 9067.33,-1453.63 9074.27,-1454.59"/>
</g>
<!-- layer_4_mha_o&#45;&gt;layer_4_mha_res -->
<g id="edge368" class="edge">
<title>layer_4_mha_o&#45;&gt;layer_4_mha_res</title>
<path fill="none" stroke="black" d="M9104.59,-1390.82C9114.77,-1381.79 9126.35,-1371.51 9137.08,-1361.98"/>
<polygon fill="black" stroke="black" points="9139.56,-1364.46 9144.71,-1355.2 9134.91,-1359.22 9139.56,-1364.46"/>
</g>
<!-- layer_4_exp_norm -->
<g id="node244" class="node">
<title>layer_4_exp_norm</title>
<polygon fill="lightcoral" stroke="black" points="6733.22,-1265.95 6422.22,-1265.95 6422.22,-1212.95 6733.22,-1212.95 6733.22,-1265.95"/>
<text text-anchor="middle" x="6577.72" y="-1250.75" font-family="Times,serif" font-size="14.00">Expert Norm 4</text>
<text text-anchor="middle" x="6577.72" y="-1235.75" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="6577.72" y="-1220.75" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_4_mha_res&#45;&gt;layer_4_exp_norm -->
<g id="edge370" class="edge">
<title>layer_4_mha_res&#45;&gt;layer_4_exp_norm</title>
<path fill="none" stroke="black" d="M9018.14,-1322.24C8559.49,-1306.87 7215.45,-1261.83 6743.7,-1246.02"/>
<polygon fill="black" stroke="black" points="6743.51,-1242.51 6733.4,-1245.67 6743.28,-1249.5 6743.51,-1242.51"/>
</g>
<!-- layer_4_exp_res -->
<g id="node312" class="node">
<title>layer_4_exp_res</title>
<polygon fill="lightyellow" stroke="black" points="9160.22,-235.95 8849.22,-235.95 8849.22,-182.95 9160.22,-182.95 9160.22,-235.95"/>
<text text-anchor="middle" x="9004.72" y="-220.75" font-family="Times,serif" font-size="14.00">Expert Residual 4</text>
<text text-anchor="middle" x="9004.72" y="-205.75" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9004.72" y="-190.75" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_4_mha_res&#45;&gt;layer_4_exp_res -->
<g id="edge391" class="edge">
<title>layer_4_mha_res&#45;&gt;layer_4_exp_res</title>
<path fill="none" stroke="black" d="M9329.36,-1323.51C9889.64,-1308.31 11770.72,-1248.12 11770.72,-1124.95 11770.72,-1124.95 11770.72,-1124.95 11770.72,-465.95 11770.72,-441.35 11771.35,-428.79 11751.72,-413.95 11545.78,-258.3 9732.99,-220.45 9170.46,-212.41"/>
<polygon fill="black" stroke="black" points="9170.29,-208.91 9160.24,-212.26 9170.19,-215.91 9170.29,-208.91"/>
</g>
<!-- layer_4_global_gate -->
<g id="node245" class="node">
<title>layer_4_global_gate</title>
<polygon fill="yellow" stroke="black" points="6238.72,-1176.95 5927.72,-1123.95 6238.72,-1070.95 6549.72,-1123.95 6238.72,-1176.95"/>
<text text-anchor="middle" x="6238.72" y="-1135.25" font-family="Times,serif" font-size="14.00">Global Gate 4</text>
<text text-anchor="middle" x="6238.72" y="-1120.25" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="6238.72" y="-1105.25" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_4_exp_norm&#45;&gt;layer_4_global_gate -->
<g id="edge371" class="edge">
<title>layer_4_exp_norm&#45;&gt;layer_4_global_gate</title>
<path fill="none" stroke="black" d="M6501.22,-1212.84C6457.09,-1198.07 6400.8,-1179.22 6351.66,-1162.77"/>
<polygon fill="black" stroke="black" points="6352.53,-1159.37 6341.93,-1159.51 6350.31,-1166.01 6352.53,-1159.37"/>
</g>
<!-- layer_4_token_dist -->
<g id="node246" class="node">
<title>layer_4_token_dist</title>
<polygon fill="orange" stroke="black" points="6561.08,-1034.95 6048.27,-1034.95 5916.36,-928.95 6429.16,-928.95 6561.08,-1034.95"/>
<text text-anchor="middle" x="6238.72" y="-993.25" font-family="Times,serif" font-size="14.00">Token Distribution 4</text>
<text text-anchor="middle" x="6238.72" y="-978.25" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="6238.72" y="-963.25" font-family="Times,serif" font-size="14.00">GPU: all to 0&#45;15</text>
</g>
<!-- layer_4_exp_norm&#45;&gt;layer_4_token_dist -->
<g id="edge373" class="edge">
<title>layer_4_exp_norm&#45;&gt;layer_4_token_dist</title>
<path fill="none" stroke="black" d="M6582.84,-1212.91C6588.49,-1176.79 6592.77,-1110.76 6558.72,-1070.95 6548.5,-1059.01 6528.11,-1048.16 6502.34,-1038.48"/>
<polygon fill="black" stroke="black" points="6503.21,-1035.08 6492.61,-1034.97 6500.83,-1041.66 6503.21,-1035.08"/>
</g>
<!-- layer_4_global_gate&#45;&gt;layer_4_token_dist -->
<g id="edge372" class="edge">
<title>layer_4_global_gate&#45;&gt;layer_4_token_dist</title>
<path fill="none" stroke="black" d="M6238.72,-1070.82C6238.72,-1062.53 6238.72,-1053.88 6238.72,-1045.38"/>
<polygon fill="black" stroke="black" points="6242.22,-1045.13 6238.72,-1035.13 6235.22,-1045.13 6242.22,-1045.13"/>
</g>
<!-- layer_4_expert0_recv -->
<g id="node247" class="node">
<title>layer_4_expert0_recv</title>
<polygon fill="lightgreen" stroke="black" points="717.65,-892.95 146.67,-892.95 -0.22,-786.95 570.77,-786.95 717.65,-892.95"/>
<text text-anchor="middle" x="358.72" y="-851.25" font-family="Times,serif" font-size="14.00">Expert 0 Recv</text>
<text text-anchor="middle" x="358.72" y="-836.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="358.72" y="-821.25" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_4_token_dist&#45;&gt;layer_4_expert0_recv -->
<g id="edge295" class="edge">
<title>layer_4_token_dist&#45;&gt;layer_4_expert0_recv</title>
<path fill="none" stroke="black" d="M5981.15,-981.11C5040,-981.02 1787.39,-974.73 727.08,-893.03"/>
<polygon fill="black" stroke="black" points="727.26,-889.54 717.02,-892.25 726.72,-896.51 727.26,-889.54"/>
</g>
<!-- layer_4_expert1_recv -->
<g id="node251" class="node">
<title>layer_4_expert1_recv</title>
<polygon fill="lightgreen" stroke="black" points="1452.65,-892.95 881.67,-892.95 734.78,-786.95 1305.77,-786.95 1452.65,-892.95"/>
<text text-anchor="middle" x="1093.72" y="-851.25" font-family="Times,serif" font-size="14.00">Expert 1 Recv</text>
<text text-anchor="middle" x="1093.72" y="-836.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="1093.72" y="-821.25" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_4_token_dist&#45;&gt;layer_4_expert1_recv -->
<g id="edge299" class="edge">
<title>layer_4_token_dist&#45;&gt;layer_4_expert1_recv</title>
<path fill="none" stroke="black" d="M5980.22,-980.37C5122.07,-977.76 2371.22,-964 1462.3,-893.05"/>
<polygon fill="black" stroke="black" points="1462.27,-889.54 1452.02,-892.24 1461.72,-896.52 1462.27,-889.54"/>
</g>
<!-- layer_4_expert2_recv -->
<g id="node255" class="node">
<title>layer_4_expert2_recv</title>
<polygon fill="lightgreen" stroke="black" points="2187.65,-892.95 1616.67,-892.95 1469.78,-786.95 2040.77,-786.95 2187.65,-892.95"/>
<text text-anchor="middle" x="1828.72" y="-851.25" font-family="Times,serif" font-size="14.00">Expert 2 Recv</text>
<text text-anchor="middle" x="1828.72" y="-836.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="1828.72" y="-821.25" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_4_token_dist&#45;&gt;layer_4_expert2_recv -->
<g id="edge303" class="edge">
<title>layer_4_token_dist&#45;&gt;layer_4_expert2_recv</title>
<path fill="none" stroke="black" d="M5979.04,-979.34C5210.68,-973.94 2955.33,-953.33 2197.25,-893.05"/>
<polygon fill="black" stroke="black" points="2197.27,-889.54 2187.02,-892.23 2196.71,-896.52 2197.27,-889.54"/>
</g>
<!-- layer_4_expert3_recv -->
<g id="node259" class="node">
<title>layer_4_expert3_recv</title>
<polygon fill="lightgreen" stroke="black" points="2922.65,-892.95 2351.67,-892.95 2204.78,-786.95 2775.77,-786.95 2922.65,-892.95"/>
<text text-anchor="middle" x="2563.72" y="-851.25" font-family="Times,serif" font-size="14.00">Expert 3 Recv</text>
<text text-anchor="middle" x="2563.72" y="-836.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2563.72" y="-821.25" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_4_token_dist&#45;&gt;layer_4_expert3_recv -->
<g id="edge307" class="edge">
<title>layer_4_token_dist&#45;&gt;layer_4_expert3_recv</title>
<path fill="none" stroke="black" d="M5976.92,-977.85C5306.84,-969.3 3540.38,-942.71 2932.22,-893.05"/>
<polygon fill="black" stroke="black" points="2932.28,-889.54 2922.02,-892.2 2931.7,-896.52 2932.28,-889.54"/>
</g>
<!-- layer_4_expert4_recv -->
<g id="node263" class="node">
<title>layer_4_expert4_recv</title>
<polygon fill="lightgreen" stroke="black" points="3657.65,-892.95 3086.67,-892.95 2939.78,-786.95 3510.77,-786.95 3657.65,-892.95"/>
<text text-anchor="middle" x="3298.72" y="-851.25" font-family="Times,serif" font-size="14.00">Expert 4 Recv</text>
<text text-anchor="middle" x="3298.72" y="-836.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="3298.72" y="-821.25" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_4_token_dist&#45;&gt;layer_4_expert4_recv -->
<g id="edge311" class="edge">
<title>layer_4_token_dist&#45;&gt;layer_4_expert4_recv</title>
<path fill="none" stroke="black" d="M5981.16,-981.21C5519.07,-979.66 4518.72,-967.17 3666.56,-893"/>
<polygon fill="black" stroke="black" points="3666.81,-889.51 3656.54,-892.13 3666.2,-896.49 3666.81,-889.51"/>
</g>
<!-- layer_4_expert5_recv -->
<g id="node267" class="node">
<title>layer_4_expert5_recv</title>
<polygon fill="lightgreen" stroke="black" points="4392.65,-892.95 3821.67,-892.95 3674.78,-786.95 4245.77,-786.95 4392.65,-892.95"/>
<text text-anchor="middle" x="4033.72" y="-851.25" font-family="Times,serif" font-size="14.00">Expert 5 Recv</text>
<text text-anchor="middle" x="4033.72" y="-836.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="4033.72" y="-821.25" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_4_token_dist&#45;&gt;layer_4_expert5_recv -->
<g id="edge315" class="edge">
<title>layer_4_token_dist&#45;&gt;layer_4_expert5_recv</title>
<path fill="none" stroke="black" d="M5974.89,-976.02C5619.53,-967.62 4967.38,-946.07 4401.54,-893.01"/>
<polygon fill="black" stroke="black" points="4401.83,-889.52 4391.55,-892.07 4401.18,-896.49 4401.83,-889.52"/>
</g>
<!-- layer_4_expert6_recv -->
<g id="node271" class="node">
<title>layer_4_expert6_recv</title>
<polygon fill="lightgreen" stroke="black" points="5127.65,-892.95 4556.67,-892.95 4409.78,-786.95 4980.77,-786.95 5127.65,-892.95"/>
<text text-anchor="middle" x="4768.72" y="-851.25" font-family="Times,serif" font-size="14.00">Expert 6 Recv</text>
<text text-anchor="middle" x="4768.72" y="-836.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="4768.72" y="-821.25" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_4_token_dist&#45;&gt;layer_4_expert6_recv -->
<g id="edge319" class="edge">
<title>layer_4_token_dist&#45;&gt;layer_4_expert6_recv</title>
<path fill="none" stroke="black" d="M5959.19,-963.39C5738.57,-948.4 5422.82,-924.46 5136.73,-893.05"/>
<polygon fill="black" stroke="black" points="5136.89,-889.55 5126.56,-891.93 5136.12,-896.5 5136.89,-889.55"/>
</g>
<!-- layer_4_expert7_recv -->
<g id="node275" class="node">
<title>layer_4_expert7_recv</title>
<polygon fill="lightgreen" stroke="black" points="5862.65,-892.95 5291.67,-892.95 5144.78,-786.95 5715.77,-786.95 5862.65,-892.95"/>
<text text-anchor="middle" x="5503.72" y="-851.25" font-family="Times,serif" font-size="14.00">Expert 7 Recv</text>
<text text-anchor="middle" x="5503.72" y="-836.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5503.72" y="-821.25" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_4_token_dist&#45;&gt;layer_4_expert7_recv -->
<g id="edge323" class="edge">
<title>layer_4_token_dist&#45;&gt;layer_4_expert7_recv</title>
<path fill="none" stroke="black" d="M5965.55,-928.92C5907.26,-917.82 5845.58,-906.07 5786.92,-894.9"/>
<polygon fill="black" stroke="black" points="5787.25,-891.4 5776.78,-892.96 5785.94,-898.27 5787.25,-891.4"/>
</g>
<!-- layer_4_expert8_recv -->
<g id="node279" class="node">
<title>layer_4_expert8_recv</title>
<polygon fill="lightgreen" stroke="black" points="6597.65,-892.95 6026.67,-892.95 5879.78,-786.95 6450.77,-786.95 6597.65,-892.95"/>
<text text-anchor="middle" x="6238.72" y="-851.25" font-family="Times,serif" font-size="14.00">Expert 8 Recv</text>
<text text-anchor="middle" x="6238.72" y="-836.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="6238.72" y="-821.25" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_4_token_dist&#45;&gt;layer_4_expert8_recv -->
<g id="edge327" class="edge">
<title>layer_4_token_dist&#45;&gt;layer_4_expert8_recv</title>
<path fill="none" stroke="black" d="M6238.72,-928.82C6238.72,-920.53 6238.72,-911.88 6238.72,-903.38"/>
<polygon fill="black" stroke="black" points="6242.22,-903.13 6238.72,-893.13 6235.22,-903.13 6242.22,-903.13"/>
</g>
<!-- layer_4_expert9_recv -->
<g id="node283" class="node">
<title>layer_4_expert9_recv</title>
<polygon fill="lightgreen" stroke="black" points="7332.65,-892.95 6761.67,-892.95 6614.78,-786.95 7185.77,-786.95 7332.65,-892.95"/>
<text text-anchor="middle" x="6973.72" y="-851.25" font-family="Times,serif" font-size="14.00">Expert 9 Recv</text>
<text text-anchor="middle" x="6973.72" y="-836.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="6973.72" y="-821.25" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_4_token_dist&#45;&gt;layer_4_expert9_recv -->
<g id="edge331" class="edge">
<title>layer_4_token_dist&#45;&gt;layer_4_expert9_recv</title>
<path fill="none" stroke="black" d="M6445.41,-941.58C6536.66,-924.2 6644.37,-903.69 6738.66,-885.73"/>
<polygon fill="black" stroke="black" points="6739.45,-889.14 6748.62,-883.83 6738.14,-882.26 6739.45,-889.14"/>
</g>
<!-- layer_4_expert10_recv -->
<g id="node287" class="node">
<title>layer_4_expert10_recv</title>
<polygon fill="lightgreen" stroke="black" points="8067.65,-892.95 7496.67,-892.95 7349.78,-786.95 7920.77,-786.95 8067.65,-892.95"/>
<text text-anchor="middle" x="7708.72" y="-851.25" font-family="Times,serif" font-size="14.00">Expert 10 Recv</text>
<text text-anchor="middle" x="7708.72" y="-836.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="7708.72" y="-821.25" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_4_token_dist&#45;&gt;layer_4_expert10_recv -->
<g id="edge335" class="edge">
<title>layer_4_token_dist&#45;&gt;layer_4_expert10_recv</title>
<path fill="none" stroke="black" d="M6475.79,-966.25C6699.43,-951.38 7043.86,-925.91 7341.72,-892.95 7381.16,-888.59 7422.89,-883.31 7463.53,-877.81"/>
<polygon fill="black" stroke="black" points="7464.12,-881.26 7473.56,-876.45 7463.18,-874.33 7464.12,-881.26"/>
</g>
<!-- layer_4_expert11_recv -->
<g id="node291" class="node">
<title>layer_4_expert11_recv</title>
<polygon fill="lightgreen" stroke="black" points="8802.65,-892.95 8231.67,-892.95 8084.78,-786.95 8655.77,-786.95 8802.65,-892.95"/>
<text text-anchor="middle" x="8443.72" y="-851.25" font-family="Times,serif" font-size="14.00">Expert 11 Recv</text>
<text text-anchor="middle" x="8443.72" y="-836.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8443.72" y="-821.25" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_4_token_dist&#45;&gt;layer_4_expert11_recv -->
<g id="edge339" class="edge">
<title>layer_4_token_dist&#45;&gt;layer_4_expert11_recv</title>
<path fill="none" stroke="black" d="M6488.22,-976.35C6842.2,-968.16 7510.2,-946.53 8076.72,-892.95 8116.52,-889.19 8158.62,-884.19 8199.55,-878.78"/>
<polygon fill="black" stroke="black" points="8200.2,-882.22 8209.65,-877.43 8199.28,-875.28 8200.2,-882.22"/>
</g>
<!-- layer_4_expert12_recv -->
<g id="node295" class="node">
<title>layer_4_expert12_recv</title>
<polygon fill="lightgreen" stroke="black" points="9537.65,-892.95 8966.67,-892.95 8819.78,-786.95 9390.77,-786.95 9537.65,-892.95"/>
<text text-anchor="middle" x="9178.72" y="-851.25" font-family="Times,serif" font-size="14.00">Expert 12 Recv</text>
<text text-anchor="middle" x="9178.72" y="-836.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="9178.72" y="-821.25" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_4_token_dist&#45;&gt;layer_4_expert12_recv -->
<g id="edge343" class="edge">
<title>layer_4_token_dist&#45;&gt;layer_4_expert12_recv</title>
<path fill="none" stroke="black" d="M6494.45,-981.22C6957.53,-979.69 7965.46,-967.17 8811.72,-892.95 8851.69,-889.45 8893.97,-884.56 8935.05,-879.18"/>
<polygon fill="black" stroke="black" points="8935.73,-882.62 8945.19,-877.84 8934.82,-875.68 8935.73,-882.62"/>
</g>
<!-- layer_4_expert13_recv -->
<g id="node299" class="node">
<title>layer_4_expert13_recv</title>
<polygon fill="lightgreen" stroke="black" points="10272.65,-892.95 9701.67,-892.95 9554.78,-786.95 10125.77,-786.95 10272.65,-892.95"/>
<text text-anchor="middle" x="9913.72" y="-851.25" font-family="Times,serif" font-size="14.00">Expert 13 Recv</text>
<text text-anchor="middle" x="9913.72" y="-836.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="9913.72" y="-821.25" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_4_token_dist&#45;&gt;layer_4_expert13_recv -->
<g id="edge347" class="edge">
<title>layer_4_token_dist&#45;&gt;layer_4_expert13_recv</title>
<path fill="none" stroke="black" d="M6490.47,-977.98C7156.49,-969.52 8954.09,-942.66 9546.72,-892.95 9586.85,-889.59 9629.3,-884.76 9670.53,-879.38"/>
<polygon fill="black" stroke="black" points="9671.25,-882.82 9680.7,-878.04 9670.33,-875.88 9671.25,-882.82"/>
</g>
<!-- layer_4_expert14_recv -->
<g id="node303" class="node">
<title>layer_4_expert14_recv</title>
<polygon fill="lightgreen" stroke="black" points="11007.65,-892.95 10436.67,-892.95 10289.78,-786.95 10860.77,-786.95 11007.65,-892.95"/>
<text text-anchor="middle" x="10648.72" y="-851.25" font-family="Times,serif" font-size="14.00">Expert 14 Recv</text>
<text text-anchor="middle" x="10648.72" y="-836.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10648.72" y="-821.25" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_4_token_dist&#45;&gt;layer_4_expert14_recv -->
<g id="edge351" class="edge">
<title>layer_4_token_dist&#45;&gt;layer_4_expert14_recv</title>
<path fill="none" stroke="black" d="M6492.26,-979.39C7258.13,-974.03 9540.63,-953.31 10281.72,-892.95 10321.86,-889.68 10364.31,-884.91 10405.54,-879.55"/>
<polygon fill="black" stroke="black" points="10406.26,-882.99 10415.72,-878.21 10405.35,-876.05 10406.26,-882.99"/>
</g>
<!-- layer_4_expert15_recv -->
<g id="node307" class="node">
<title>layer_4_expert15_recv</title>
<polygon fill="lightgreen" stroke="black" points="11742.65,-892.95 11171.67,-892.95 11024.78,-786.95 11595.77,-786.95 11742.65,-892.95"/>
<text text-anchor="middle" x="11383.72" y="-851.25" font-family="Times,serif" font-size="14.00">Expert 15 Recv</text>
<text text-anchor="middle" x="11383.72" y="-836.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="11383.72" y="-821.25" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_4_token_dist&#45;&gt;layer_4_expert15_recv -->
<g id="edge355" class="edge">
<title>layer_4_token_dist&#45;&gt;layer_4_expert15_recv</title>
<path fill="none" stroke="black" d="M6493.47,-980.38C7350.57,-977.79 10125.85,-964 11016.72,-892.95 11057.1,-889.73 11099.81,-884.95 11141.27,-879.57"/>
<polygon fill="black" stroke="black" points="11141.76,-883.04 11151.22,-878.27 11140.85,-876.1 11141.76,-883.04"/>
</g>
<!-- layer_4_expert0_gate -->
<g id="node248" class="node">
<title>layer_4_expert0_gate</title>
<polygon fill="yellow" stroke="black" points="358.72,-750.95 12.72,-697.95 358.72,-644.95 704.72,-697.95 358.72,-750.95"/>
<text text-anchor="middle" x="358.72" y="-709.25" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="358.72" y="-694.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="358.72" y="-679.25" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_4_expert0_recv&#45;&gt;layer_4_expert0_gate -->
<g id="edge296" class="edge">
<title>layer_4_expert0_recv&#45;&gt;layer_4_expert0_gate</title>
<path fill="none" stroke="black" d="M358.72,-786.82C358.72,-778.53 358.72,-769.88 358.72,-761.38"/>
<polygon fill="black" stroke="black" points="362.22,-761.13 358.72,-751.13 355.22,-761.13 362.22,-761.13"/>
</g>
<!-- layer_4_expert0 -->
<g id="node249" class="node">
<title>layer_4_expert0</title>
<polygon fill="lightpink" stroke="black" points="531.72,-608.95 185.72,-608.95 185.72,-555.95 531.72,-555.95 531.72,-608.95"/>
<text text-anchor="middle" x="358.72" y="-593.75" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="358.72" y="-578.75" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="358.72" y="-563.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_4_expert0_gate&#45;&gt;layer_4_expert0 -->
<g id="edge297" class="edge">
<title>layer_4_expert0_gate&#45;&gt;layer_4_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M358.72,-644.85C358.72,-636.18 358.72,-627.37 358.72,-619.22"/>
<polygon fill="black" stroke="black" points="362.22,-618.97 358.72,-608.97 355.22,-618.97 362.22,-618.97"/>
</g>
<!-- layer_4_expert0_send -->
<g id="node250" class="node">
<title>layer_4_expert0_send</title>
<polygon fill="lightgreen" stroke="black" points="717.65,-519.95 146.67,-519.95 -0.22,-413.95 570.77,-413.95 717.65,-519.95"/>
<text text-anchor="middle" x="358.72" y="-478.25" font-family="Times,serif" font-size="14.00">Expert 0 Send</text>
<text text-anchor="middle" x="358.72" y="-463.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="358.72" y="-448.25" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_4_expert0&#45;&gt;layer_4_expert0_send -->
<g id="edge298" class="edge">
<title>layer_4_expert0&#45;&gt;layer_4_expert0_send</title>
<path fill="none" stroke="black" d="M358.72,-555.7C358.72,-548 358.72,-539.2 358.72,-530.22"/>
<polygon fill="black" stroke="black" points="362.22,-530.05 358.72,-520.05 355.22,-530.05 362.22,-530.05"/>
</g>
<!-- layer_4_exp_agg -->
<g id="node311" class="node">
<title>layer_4_exp_agg</title>
<polygon fill="orange" stroke="black" points="6561.08,-377.95 6048.27,-377.95 5916.36,-271.95 6429.16,-271.95 6561.08,-377.95"/>
<text text-anchor="middle" x="6238.72" y="-336.25" font-family="Times,serif" font-size="14.00">Expert Aggregation 4</text>
<text text-anchor="middle" x="6238.72" y="-321.25" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="6238.72" y="-306.25" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_4_expert0_send&#45;&gt;layer_4_exp_agg -->
<g id="edge374" class="edge">
<title>layer_4_expert0_send&#45;&gt;layer_4_exp_agg</title>
<path fill="none" stroke="black" d="M591.21,-428.55C635.75,-422.65 682.09,-417.38 725.72,-413.95 1763.71,-332.45 5018.54,-325.92 5973.09,-325.8"/>
<polygon fill="black" stroke="black" points="5973.18,-329.3 5983.18,-325.8 5973.18,-322.3 5973.18,-329.3"/>
</g>
<!-- layer_4_expert1_gate -->
<g id="node252" class="node">
<title>layer_4_expert1_gate</title>
<polygon fill="yellow" stroke="black" points="1093.72,-750.95 747.72,-697.95 1093.72,-644.95 1439.72,-697.95 1093.72,-750.95"/>
<text text-anchor="middle" x="1093.72" y="-709.25" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="1093.72" y="-694.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="1093.72" y="-679.25" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_4_expert1_recv&#45;&gt;layer_4_expert1_gate -->
<g id="edge300" class="edge">
<title>layer_4_expert1_recv&#45;&gt;layer_4_expert1_gate</title>
<path fill="none" stroke="black" d="M1093.72,-786.82C1093.72,-778.53 1093.72,-769.88 1093.72,-761.38"/>
<polygon fill="black" stroke="black" points="1097.22,-761.13 1093.72,-751.13 1090.22,-761.13 1097.22,-761.13"/>
</g>
<!-- layer_4_expert1 -->
<g id="node253" class="node">
<title>layer_4_expert1</title>
<polygon fill="lightpink" stroke="black" points="1266.72,-608.95 920.72,-608.95 920.72,-555.95 1266.72,-555.95 1266.72,-608.95"/>
<text text-anchor="middle" x="1093.72" y="-593.75" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1093.72" y="-578.75" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="1093.72" y="-563.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_4_expert1_gate&#45;&gt;layer_4_expert1 -->
<g id="edge301" class="edge">
<title>layer_4_expert1_gate&#45;&gt;layer_4_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1093.72,-644.85C1093.72,-636.18 1093.72,-627.37 1093.72,-619.22"/>
<polygon fill="black" stroke="black" points="1097.22,-618.97 1093.72,-608.97 1090.22,-618.97 1097.22,-618.97"/>
</g>
<!-- layer_4_expert1_send -->
<g id="node254" class="node">
<title>layer_4_expert1_send</title>
<polygon fill="lightgreen" stroke="black" points="1452.65,-519.95 881.67,-519.95 734.78,-413.95 1305.77,-413.95 1452.65,-519.95"/>
<text text-anchor="middle" x="1093.72" y="-478.25" font-family="Times,serif" font-size="14.00">Expert 1 Send</text>
<text text-anchor="middle" x="1093.72" y="-463.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="1093.72" y="-448.25" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_4_expert1&#45;&gt;layer_4_expert1_send -->
<g id="edge302" class="edge">
<title>layer_4_expert1&#45;&gt;layer_4_expert1_send</title>
<path fill="none" stroke="black" d="M1093.72,-555.7C1093.72,-548 1093.72,-539.2 1093.72,-530.22"/>
<polygon fill="black" stroke="black" points="1097.22,-530.05 1093.72,-520.05 1090.22,-530.05 1097.22,-530.05"/>
</g>
<!-- layer_4_expert1_send&#45;&gt;layer_4_exp_agg -->
<g id="edge375" class="edge">
<title>layer_4_expert1_send&#45;&gt;layer_4_exp_agg</title>
<path fill="none" stroke="black" d="M1326.22,-428.64C1370.75,-422.73 1417.1,-417.43 1460.72,-413.95 2348.1,-343.18 5105.21,-329.22 5973.83,-326.56"/>
<polygon fill="black" stroke="black" points="5973.97,-330.06 5983.96,-326.53 5973.95,-323.06 5973.97,-330.06"/>
</g>
<!-- layer_4_expert2_gate -->
<g id="node256" class="node">
<title>layer_4_expert2_gate</title>
<polygon fill="yellow" stroke="black" points="1828.72,-750.95 1482.72,-697.95 1828.72,-644.95 2174.72,-697.95 1828.72,-750.95"/>
<text text-anchor="middle" x="1828.72" y="-709.25" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="1828.72" y="-694.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="1828.72" y="-679.25" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_4_expert2_recv&#45;&gt;layer_4_expert2_gate -->
<g id="edge304" class="edge">
<title>layer_4_expert2_recv&#45;&gt;layer_4_expert2_gate</title>
<path fill="none" stroke="black" d="M1828.72,-786.82C1828.72,-778.53 1828.72,-769.88 1828.72,-761.38"/>
<polygon fill="black" stroke="black" points="1832.22,-761.13 1828.72,-751.13 1825.22,-761.13 1832.22,-761.13"/>
</g>
<!-- layer_4_expert2 -->
<g id="node257" class="node">
<title>layer_4_expert2</title>
<polygon fill="lightpink" stroke="black" points="2001.72,-608.95 1655.72,-608.95 1655.72,-555.95 2001.72,-555.95 2001.72,-608.95"/>
<text text-anchor="middle" x="1828.72" y="-593.75" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1828.72" y="-578.75" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="1828.72" y="-563.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_4_expert2_gate&#45;&gt;layer_4_expert2 -->
<g id="edge305" class="edge">
<title>layer_4_expert2_gate&#45;&gt;layer_4_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1828.72,-644.85C1828.72,-636.18 1828.72,-627.37 1828.72,-619.22"/>
<polygon fill="black" stroke="black" points="1832.22,-618.97 1828.72,-608.97 1825.22,-618.97 1832.22,-618.97"/>
</g>
<!-- layer_4_expert2_send -->
<g id="node258" class="node">
<title>layer_4_expert2_send</title>
<polygon fill="lightgreen" stroke="black" points="2187.65,-519.95 1616.67,-519.95 1469.78,-413.95 2040.77,-413.95 2187.65,-519.95"/>
<text text-anchor="middle" x="1828.72" y="-478.25" font-family="Times,serif" font-size="14.00">Expert 2 Send</text>
<text text-anchor="middle" x="1828.72" y="-463.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="1828.72" y="-448.25" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_4_expert2&#45;&gt;layer_4_expert2_send -->
<g id="edge306" class="edge">
<title>layer_4_expert2&#45;&gt;layer_4_expert2_send</title>
<path fill="none" stroke="black" d="M1828.72,-555.7C1828.72,-548 1828.72,-539.2 1828.72,-530.22"/>
<polygon fill="black" stroke="black" points="1832.22,-530.05 1828.72,-520.05 1825.22,-530.05 1832.22,-530.05"/>
</g>
<!-- layer_4_expert2_send&#45;&gt;layer_4_exp_agg -->
<g id="edge376" class="edge">
<title>layer_4_expert2_send&#45;&gt;layer_4_exp_agg</title>
<path fill="none" stroke="black" d="M2061.72,-428.69C2106.1,-422.8 2152.26,-417.49 2195.72,-413.95 2933.55,-353.87 5199.27,-333.06 5974.99,-327.59"/>
<polygon fill="black" stroke="black" points="5975.2,-331.09 5985.17,-327.52 5975.15,-324.09 5975.2,-331.09"/>
</g>
<!-- layer_4_expert3_gate -->
<g id="node260" class="node">
<title>layer_4_expert3_gate</title>
<polygon fill="yellow" stroke="black" points="2563.72,-750.95 2217.72,-697.95 2563.72,-644.95 2909.72,-697.95 2563.72,-750.95"/>
<text text-anchor="middle" x="2563.72" y="-709.25" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="2563.72" y="-694.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2563.72" y="-679.25" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_4_expert3_recv&#45;&gt;layer_4_expert3_gate -->
<g id="edge308" class="edge">
<title>layer_4_expert3_recv&#45;&gt;layer_4_expert3_gate</title>
<path fill="none" stroke="black" d="M2563.72,-786.82C2563.72,-778.53 2563.72,-769.88 2563.72,-761.38"/>
<polygon fill="black" stroke="black" points="2567.22,-761.13 2563.72,-751.13 2560.22,-761.13 2567.22,-761.13"/>
</g>
<!-- layer_4_expert3 -->
<g id="node261" class="node">
<title>layer_4_expert3</title>
<polygon fill="lightpink" stroke="black" points="2736.72,-608.95 2390.72,-608.95 2390.72,-555.95 2736.72,-555.95 2736.72,-608.95"/>
<text text-anchor="middle" x="2563.72" y="-593.75" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2563.72" y="-578.75" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2563.72" y="-563.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_4_expert3_gate&#45;&gt;layer_4_expert3 -->
<g id="edge309" class="edge">
<title>layer_4_expert3_gate&#45;&gt;layer_4_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2563.72,-644.85C2563.72,-636.18 2563.72,-627.37 2563.72,-619.22"/>
<polygon fill="black" stroke="black" points="2567.22,-618.97 2563.72,-608.97 2560.22,-618.97 2567.22,-618.97"/>
</g>
<!-- layer_4_expert3_send -->
<g id="node262" class="node">
<title>layer_4_expert3_send</title>
<polygon fill="lightgreen" stroke="black" points="2922.65,-519.95 2351.67,-519.95 2204.78,-413.95 2775.77,-413.95 2922.65,-519.95"/>
<text text-anchor="middle" x="2563.72" y="-478.25" font-family="Times,serif" font-size="14.00">Expert 3 Send</text>
<text text-anchor="middle" x="2563.72" y="-463.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="2563.72" y="-448.25" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_4_expert3&#45;&gt;layer_4_expert3_send -->
<g id="edge310" class="edge">
<title>layer_4_expert3&#45;&gt;layer_4_expert3_send</title>
<path fill="none" stroke="black" d="M2563.72,-555.7C2563.72,-548 2563.72,-539.2 2563.72,-530.22"/>
<polygon fill="black" stroke="black" points="2567.22,-530.05 2563.72,-520.05 2560.22,-530.05 2567.22,-530.05"/>
</g>
<!-- layer_4_expert3_send&#45;&gt;layer_4_exp_agg -->
<g id="edge377" class="edge">
<title>layer_4_expert3_send&#45;&gt;layer_4_exp_agg</title>
<path fill="none" stroke="black" d="M2796.73,-428.86C2841.12,-422.95 2887.27,-417.6 2930.72,-413.95 3520.3,-364.5 5302.54,-337.66 5976.63,-329.06"/>
<polygon fill="black" stroke="black" points="5977,-332.55 5986.96,-328.93 5976.91,-325.55 5977,-332.55"/>
</g>
<!-- layer_4_expert4_gate -->
<g id="node264" class="node">
<title>layer_4_expert4_gate</title>
<polygon fill="yellow" stroke="black" points="3298.72,-750.95 2952.72,-697.95 3298.72,-644.95 3644.72,-697.95 3298.72,-750.95"/>
<text text-anchor="middle" x="3298.72" y="-709.25" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="3298.72" y="-694.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="3298.72" y="-679.25" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_4_expert4_recv&#45;&gt;layer_4_expert4_gate -->
<g id="edge312" class="edge">
<title>layer_4_expert4_recv&#45;&gt;layer_4_expert4_gate</title>
<path fill="none" stroke="black" d="M3298.72,-786.82C3298.72,-778.53 3298.72,-769.88 3298.72,-761.38"/>
<polygon fill="black" stroke="black" points="3302.22,-761.13 3298.72,-751.13 3295.22,-761.13 3302.22,-761.13"/>
</g>
<!-- layer_4_expert4 -->
<g id="node265" class="node">
<title>layer_4_expert4</title>
<polygon fill="lightpink" stroke="black" points="3471.72,-608.95 3125.72,-608.95 3125.72,-555.95 3471.72,-555.95 3471.72,-608.95"/>
<text text-anchor="middle" x="3298.72" y="-593.75" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3298.72" y="-578.75" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="3298.72" y="-563.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_4_expert4_gate&#45;&gt;layer_4_expert4 -->
<g id="edge313" class="edge">
<title>layer_4_expert4_gate&#45;&gt;layer_4_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3298.72,-644.85C3298.72,-636.18 3298.72,-627.37 3298.72,-619.22"/>
<polygon fill="black" stroke="black" points="3302.22,-618.97 3298.72,-608.97 3295.22,-618.97 3302.22,-618.97"/>
</g>
<!-- layer_4_expert4_send -->
<g id="node266" class="node">
<title>layer_4_expert4_send</title>
<polygon fill="lightgreen" stroke="black" points="3657.65,-519.95 3086.67,-519.95 2939.78,-413.95 3510.77,-413.95 3657.65,-519.95"/>
<text text-anchor="middle" x="3298.72" y="-478.25" font-family="Times,serif" font-size="14.00">Expert 4 Send</text>
<text text-anchor="middle" x="3298.72" y="-463.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="3298.72" y="-448.25" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_4_expert4&#45;&gt;layer_4_expert4_send -->
<g id="edge314" class="edge">
<title>layer_4_expert4&#45;&gt;layer_4_expert4_send</title>
<path fill="none" stroke="black" d="M3298.72,-555.7C3298.72,-548 3298.72,-539.2 3298.72,-530.22"/>
<polygon fill="black" stroke="black" points="3302.22,-530.05 3298.72,-520.05 3295.22,-530.05 3302.22,-530.05"/>
</g>
<!-- layer_4_expert4_send&#45;&gt;layer_4_exp_agg -->
<g id="edge378" class="edge">
<title>layer_4_expert4_send&#45;&gt;layer_4_exp_agg</title>
<path fill="none" stroke="black" d="M3532.24,-429.06C3576.48,-423.16 3622.45,-417.75 3665.72,-413.95 4505.78,-340.28 5505.15,-327.4 5972.72,-325.73"/>
<polygon fill="black" stroke="black" points="5973,-329.22 5982.99,-325.69 5972.97,-322.22 5973,-329.22"/>
</g>
<!-- layer_4_expert5_gate -->
<g id="node268" class="node">
<title>layer_4_expert5_gate</title>
<polygon fill="yellow" stroke="black" points="4033.72,-750.95 3687.72,-697.95 4033.72,-644.95 4379.72,-697.95 4033.72,-750.95"/>
<text text-anchor="middle" x="4033.72" y="-709.25" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="4033.72" y="-694.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="4033.72" y="-679.25" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_4_expert5_recv&#45;&gt;layer_4_expert5_gate -->
<g id="edge316" class="edge">
<title>layer_4_expert5_recv&#45;&gt;layer_4_expert5_gate</title>
<path fill="none" stroke="black" d="M4033.72,-786.82C4033.72,-778.53 4033.72,-769.88 4033.72,-761.38"/>
<polygon fill="black" stroke="black" points="4037.22,-761.13 4033.72,-751.13 4030.22,-761.13 4037.22,-761.13"/>
</g>
<!-- layer_4_expert5 -->
<g id="node269" class="node">
<title>layer_4_expert5</title>
<polygon fill="lightpink" stroke="black" points="4206.72,-608.95 3860.72,-608.95 3860.72,-555.95 4206.72,-555.95 4206.72,-608.95"/>
<text text-anchor="middle" x="4033.72" y="-593.75" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4033.72" y="-578.75" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="4033.72" y="-563.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_4_expert5_gate&#45;&gt;layer_4_expert5 -->
<g id="edge317" class="edge">
<title>layer_4_expert5_gate&#45;&gt;layer_4_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4033.72,-644.85C4033.72,-636.18 4033.72,-627.37 4033.72,-619.22"/>
<polygon fill="black" stroke="black" points="4037.22,-618.97 4033.72,-608.97 4030.22,-618.97 4037.22,-618.97"/>
</g>
<!-- layer_4_expert5_send -->
<g id="node270" class="node">
<title>layer_4_expert5_send</title>
<polygon fill="lightgreen" stroke="black" points="4392.65,-519.95 3821.67,-519.95 3674.78,-413.95 4245.77,-413.95 4392.65,-519.95"/>
<text text-anchor="middle" x="4033.72" y="-478.25" font-family="Times,serif" font-size="14.00">Expert 5 Send</text>
<text text-anchor="middle" x="4033.72" y="-463.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="4033.72" y="-448.25" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_4_expert5&#45;&gt;layer_4_expert5_send -->
<g id="edge318" class="edge">
<title>layer_4_expert5&#45;&gt;layer_4_expert5_send</title>
<path fill="none" stroke="black" d="M4033.72,-555.7C4033.72,-548 4033.72,-539.2 4033.72,-530.22"/>
<polygon fill="black" stroke="black" points="4037.22,-530.05 4033.72,-520.05 4030.22,-530.05 4037.22,-530.05"/>
</g>
<!-- layer_4_expert5_send&#45;&gt;layer_4_exp_agg -->
<g id="edge379" class="edge">
<title>layer_4_expert5_send&#45;&gt;layer_4_exp_agg</title>
<path fill="none" stroke="black" d="M4267.78,-429.48C4311.86,-423.55 4357.63,-418.03 4400.72,-413.95 4961.84,-360.88 5622.52,-339.17 5979.02,-330.79"/>
<polygon fill="black" stroke="black" points="5979.3,-334.29 5989.22,-330.55 5979.14,-327.29 5979.3,-334.29"/>
</g>
<!-- layer_4_expert6_gate -->
<g id="node272" class="node">
<title>layer_4_expert6_gate</title>
<polygon fill="yellow" stroke="black" points="4768.72,-750.95 4422.72,-697.95 4768.72,-644.95 5114.72,-697.95 4768.72,-750.95"/>
<text text-anchor="middle" x="4768.72" y="-709.25" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="4768.72" y="-694.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="4768.72" y="-679.25" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_4_expert6_recv&#45;&gt;layer_4_expert6_gate -->
<g id="edge320" class="edge">
<title>layer_4_expert6_recv&#45;&gt;layer_4_expert6_gate</title>
<path fill="none" stroke="black" d="M4768.72,-786.82C4768.72,-778.53 4768.72,-769.88 4768.72,-761.38"/>
<polygon fill="black" stroke="black" points="4772.22,-761.13 4768.72,-751.13 4765.22,-761.13 4772.22,-761.13"/>
</g>
<!-- layer_4_expert6 -->
<g id="node273" class="node">
<title>layer_4_expert6</title>
<polygon fill="lightpink" stroke="black" points="4941.72,-608.95 4595.72,-608.95 4595.72,-555.95 4941.72,-555.95 4941.72,-608.95"/>
<text text-anchor="middle" x="4768.72" y="-593.75" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="4768.72" y="-578.75" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="4768.72" y="-563.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_4_expert6_gate&#45;&gt;layer_4_expert6 -->
<g id="edge321" class="edge">
<title>layer_4_expert6_gate&#45;&gt;layer_4_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4768.72,-644.85C4768.72,-636.18 4768.72,-627.37 4768.72,-619.22"/>
<polygon fill="black" stroke="black" points="4772.22,-618.97 4768.72,-608.97 4765.22,-618.97 4772.22,-618.97"/>
</g>
<!-- layer_4_expert6_send -->
<g id="node274" class="node">
<title>layer_4_expert6_send</title>
<polygon fill="lightgreen" stroke="black" points="5127.65,-519.95 4556.67,-519.95 4409.78,-413.95 4980.77,-413.95 5127.65,-519.95"/>
<text text-anchor="middle" x="4768.72" y="-478.25" font-family="Times,serif" font-size="14.00">Expert 6 Send</text>
<text text-anchor="middle" x="4768.72" y="-463.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="4768.72" y="-448.25" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_4_expert6&#45;&gt;layer_4_expert6_send -->
<g id="edge322" class="edge">
<title>layer_4_expert6&#45;&gt;layer_4_expert6_send</title>
<path fill="none" stroke="black" d="M4768.72,-555.7C4768.72,-548 4768.72,-539.2 4768.72,-530.22"/>
<polygon fill="black" stroke="black" points="4772.22,-530.05 4768.72,-520.05 4765.22,-530.05 4772.22,-530.05"/>
</g>
<!-- layer_4_expert6_send&#45;&gt;layer_4_exp_agg -->
<g id="edge380" class="edge">
<title>layer_4_expert6_send&#45;&gt;layer_4_exp_agg</title>
<path fill="none" stroke="black" d="M5003.88,-430.46C5047.64,-424.47 5093.02,-418.68 5135.72,-413.95 5429.07,-381.5 5767.59,-356.3 5991.4,-341.34"/>
<polygon fill="black" stroke="black" points="5991.9,-344.82 6001.64,-340.66 5991.43,-337.83 5991.9,-344.82"/>
</g>
<!-- layer_4_expert7_gate -->
<g id="node276" class="node">
<title>layer_4_expert7_gate</title>
<polygon fill="yellow" stroke="black" points="5503.72,-750.95 5157.72,-697.95 5503.72,-644.95 5849.72,-697.95 5503.72,-750.95"/>
<text text-anchor="middle" x="5503.72" y="-709.25" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="5503.72" y="-694.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5503.72" y="-679.25" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_4_expert7_recv&#45;&gt;layer_4_expert7_gate -->
<g id="edge324" class="edge">
<title>layer_4_expert7_recv&#45;&gt;layer_4_expert7_gate</title>
<path fill="none" stroke="black" d="M5503.72,-786.82C5503.72,-778.53 5503.72,-769.88 5503.72,-761.38"/>
<polygon fill="black" stroke="black" points="5507.22,-761.13 5503.72,-751.13 5500.22,-761.13 5507.22,-761.13"/>
</g>
<!-- layer_4_expert7 -->
<g id="node277" class="node">
<title>layer_4_expert7</title>
<polygon fill="lightpink" stroke="black" points="5676.72,-608.95 5330.72,-608.95 5330.72,-555.95 5676.72,-555.95 5676.72,-608.95"/>
<text text-anchor="middle" x="5503.72" y="-593.75" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5503.72" y="-578.75" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5503.72" y="-563.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_4_expert7_gate&#45;&gt;layer_4_expert7 -->
<g id="edge325" class="edge">
<title>layer_4_expert7_gate&#45;&gt;layer_4_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5503.72,-644.85C5503.72,-636.18 5503.72,-627.37 5503.72,-619.22"/>
<polygon fill="black" stroke="black" points="5507.22,-618.97 5503.72,-608.97 5500.22,-618.97 5507.22,-618.97"/>
</g>
<!-- layer_4_expert7_send -->
<g id="node278" class="node">
<title>layer_4_expert7_send</title>
<polygon fill="lightgreen" stroke="black" points="5862.65,-519.95 5291.67,-519.95 5144.78,-413.95 5715.77,-413.95 5862.65,-519.95"/>
<text text-anchor="middle" x="5503.72" y="-478.25" font-family="Times,serif" font-size="14.00">Expert 7 Send</text>
<text text-anchor="middle" x="5503.72" y="-463.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="5503.72" y="-448.25" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_4_expert7&#45;&gt;layer_4_expert7_send -->
<g id="edge326" class="edge">
<title>layer_4_expert7&#45;&gt;layer_4_expert7_send</title>
<path fill="none" stroke="black" d="M5503.72,-555.7C5503.72,-548 5503.72,-539.2 5503.72,-530.22"/>
<polygon fill="black" stroke="black" points="5507.22,-530.05 5503.72,-520.05 5500.22,-530.05 5507.22,-530.05"/>
</g>
<!-- layer_4_expert7_send&#45;&gt;layer_4_exp_agg -->
<g id="edge381" class="edge">
<title>layer_4_expert7_send&#45;&gt;layer_4_exp_agg</title>
<path fill="none" stroke="black" d="M5728.74,-423.09C5822.09,-405.31 5929.97,-384.76 6022.39,-367.16"/>
<polygon fill="black" stroke="black" points="6023.27,-370.55 6032.43,-365.25 6021.96,-363.68 6023.27,-370.55"/>
</g>
<!-- layer_4_expert8_gate -->
<g id="node280" class="node">
<title>layer_4_expert8_gate</title>
<polygon fill="yellow" stroke="black" points="6238.72,-750.95 5892.72,-697.95 6238.72,-644.95 6584.72,-697.95 6238.72,-750.95"/>
<text text-anchor="middle" x="6238.72" y="-709.25" font-family="Times,serif" font-size="14.00">Expert 8 Gate</text>
<text text-anchor="middle" x="6238.72" y="-694.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="6238.72" y="-679.25" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_4_expert8_recv&#45;&gt;layer_4_expert8_gate -->
<g id="edge328" class="edge">
<title>layer_4_expert8_recv&#45;&gt;layer_4_expert8_gate</title>
<path fill="none" stroke="black" d="M6238.72,-786.82C6238.72,-778.53 6238.72,-769.88 6238.72,-761.38"/>
<polygon fill="black" stroke="black" points="6242.22,-761.13 6238.72,-751.13 6235.22,-761.13 6242.22,-761.13"/>
</g>
<!-- layer_4_expert8 -->
<g id="node281" class="node">
<title>layer_4_expert8</title>
<polygon fill="lightpink" stroke="black" points="6411.72,-608.95 6065.72,-608.95 6065.72,-555.95 6411.72,-555.95 6411.72,-608.95"/>
<text text-anchor="middle" x="6238.72" y="-593.75" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="6238.72" y="-578.75" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="6238.72" y="-563.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_4_expert8_gate&#45;&gt;layer_4_expert8 -->
<g id="edge329" class="edge">
<title>layer_4_expert8_gate&#45;&gt;layer_4_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6238.72,-644.85C6238.72,-636.18 6238.72,-627.37 6238.72,-619.22"/>
<polygon fill="black" stroke="black" points="6242.22,-618.97 6238.72,-608.97 6235.22,-618.97 6242.22,-618.97"/>
</g>
<!-- layer_4_expert8_send -->
<g id="node282" class="node">
<title>layer_4_expert8_send</title>
<polygon fill="lightgreen" stroke="black" points="6597.65,-519.95 6026.67,-519.95 5879.78,-413.95 6450.77,-413.95 6597.65,-519.95"/>
<text text-anchor="middle" x="6238.72" y="-478.25" font-family="Times,serif" font-size="14.00">Expert 8 Send</text>
<text text-anchor="middle" x="6238.72" y="-463.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="6238.72" y="-448.25" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_4_expert8&#45;&gt;layer_4_expert8_send -->
<g id="edge330" class="edge">
<title>layer_4_expert8&#45;&gt;layer_4_expert8_send</title>
<path fill="none" stroke="black" d="M6238.72,-555.7C6238.72,-548 6238.72,-539.2 6238.72,-530.22"/>
<polygon fill="black" stroke="black" points="6242.22,-530.05 6238.72,-520.05 6235.22,-530.05 6242.22,-530.05"/>
</g>
<!-- layer_4_expert8_send&#45;&gt;layer_4_exp_agg -->
<g id="edge382" class="edge">
<title>layer_4_expert8_send&#45;&gt;layer_4_exp_agg</title>
<path fill="none" stroke="black" d="M6238.72,-413.82C6238.72,-405.53 6238.72,-396.88 6238.72,-388.38"/>
<polygon fill="black" stroke="black" points="6242.22,-388.13 6238.72,-378.13 6235.22,-388.13 6242.22,-388.13"/>
</g>
<!-- layer_4_expert9_gate -->
<g id="node284" class="node">
<title>layer_4_expert9_gate</title>
<polygon fill="yellow" stroke="black" points="6973.72,-750.95 6627.72,-697.95 6973.72,-644.95 7319.72,-697.95 6973.72,-750.95"/>
<text text-anchor="middle" x="6973.72" y="-709.25" font-family="Times,serif" font-size="14.00">Expert 9 Gate</text>
<text text-anchor="middle" x="6973.72" y="-694.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="6973.72" y="-679.25" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_4_expert9_recv&#45;&gt;layer_4_expert9_gate -->
<g id="edge332" class="edge">
<title>layer_4_expert9_recv&#45;&gt;layer_4_expert9_gate</title>
<path fill="none" stroke="black" d="M6973.72,-786.82C6973.72,-778.53 6973.72,-769.88 6973.72,-761.38"/>
<polygon fill="black" stroke="black" points="6977.22,-761.13 6973.72,-751.13 6970.22,-761.13 6977.22,-761.13"/>
</g>
<!-- layer_4_expert9 -->
<g id="node285" class="node">
<title>layer_4_expert9</title>
<polygon fill="lightpink" stroke="black" points="7146.72,-608.95 6800.72,-608.95 6800.72,-555.95 7146.72,-555.95 7146.72,-608.95"/>
<text text-anchor="middle" x="6973.72" y="-593.75" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="6973.72" y="-578.75" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="6973.72" y="-563.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_4_expert9_gate&#45;&gt;layer_4_expert9 -->
<g id="edge333" class="edge">
<title>layer_4_expert9_gate&#45;&gt;layer_4_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6973.72,-644.85C6973.72,-636.18 6973.72,-627.37 6973.72,-619.22"/>
<polygon fill="black" stroke="black" points="6977.22,-618.97 6973.72,-608.97 6970.22,-618.97 6977.22,-618.97"/>
</g>
<!-- layer_4_expert9_send -->
<g id="node286" class="node">
<title>layer_4_expert9_send</title>
<polygon fill="lightgreen" stroke="black" points="7332.65,-519.95 6761.67,-519.95 6614.78,-413.95 7185.77,-413.95 7332.65,-519.95"/>
<text text-anchor="middle" x="6973.72" y="-478.25" font-family="Times,serif" font-size="14.00">Expert 9 Send</text>
<text text-anchor="middle" x="6973.72" y="-463.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="6973.72" y="-448.25" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_4_expert9&#45;&gt;layer_4_expert9_send -->
<g id="edge334" class="edge">
<title>layer_4_expert9&#45;&gt;layer_4_expert9_send</title>
<path fill="none" stroke="black" d="M6973.72,-555.7C6973.72,-548 6973.72,-539.2 6973.72,-530.22"/>
<polygon fill="black" stroke="black" points="6977.22,-530.05 6973.72,-520.05 6970.22,-530.05 6977.22,-530.05"/>
</g>
<!-- layer_4_expert9_send&#45;&gt;layer_4_exp_agg -->
<g id="edge383" class="edge">
<title>layer_4_expert9_send&#45;&gt;layer_4_exp_agg</title>
<path fill="none" stroke="black" d="M6700.55,-413.92C6642.26,-402.82 6580.58,-391.07 6521.92,-379.9"/>
<polygon fill="black" stroke="black" points="6522.25,-376.4 6511.78,-377.96 6520.94,-383.27 6522.25,-376.4"/>
</g>
<!-- layer_4_expert10_gate -->
<g id="node288" class="node">
<title>layer_4_expert10_gate</title>
<polygon fill="yellow" stroke="black" points="7708.72,-750.95 7362.72,-697.95 7708.72,-644.95 8054.72,-697.95 7708.72,-750.95"/>
<text text-anchor="middle" x="7708.72" y="-709.25" font-family="Times,serif" font-size="14.00">Expert 10 Gate</text>
<text text-anchor="middle" x="7708.72" y="-694.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="7708.72" y="-679.25" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_4_expert10_recv&#45;&gt;layer_4_expert10_gate -->
<g id="edge336" class="edge">
<title>layer_4_expert10_recv&#45;&gt;layer_4_expert10_gate</title>
<path fill="none" stroke="black" d="M7708.72,-786.82C7708.72,-778.53 7708.72,-769.88 7708.72,-761.38"/>
<polygon fill="black" stroke="black" points="7712.22,-761.13 7708.72,-751.13 7705.22,-761.13 7712.22,-761.13"/>
</g>
<!-- layer_4_expert10 -->
<g id="node289" class="node">
<title>layer_4_expert10</title>
<polygon fill="lightpink" stroke="black" points="7881.72,-608.95 7535.72,-608.95 7535.72,-555.95 7881.72,-555.95 7881.72,-608.95"/>
<text text-anchor="middle" x="7708.72" y="-593.75" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="7708.72" y="-578.75" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="7708.72" y="-563.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_4_expert10_gate&#45;&gt;layer_4_expert10 -->
<g id="edge337" class="edge">
<title>layer_4_expert10_gate&#45;&gt;layer_4_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7708.72,-644.85C7708.72,-636.18 7708.72,-627.37 7708.72,-619.22"/>
<polygon fill="black" stroke="black" points="7712.22,-618.97 7708.72,-608.97 7705.22,-618.97 7712.22,-618.97"/>
</g>
<!-- layer_4_expert10_send -->
<g id="node290" class="node">
<title>layer_4_expert10_send</title>
<polygon fill="lightgreen" stroke="black" points="8067.65,-519.95 7496.67,-519.95 7349.78,-413.95 7920.77,-413.95 8067.65,-519.95"/>
<text text-anchor="middle" x="7708.72" y="-478.25" font-family="Times,serif" font-size="14.00">Expert 10 Send</text>
<text text-anchor="middle" x="7708.72" y="-463.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="7708.72" y="-448.25" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_4_expert10&#45;&gt;layer_4_expert10_send -->
<g id="edge338" class="edge">
<title>layer_4_expert10&#45;&gt;layer_4_expert10_send</title>
<path fill="none" stroke="black" d="M7708.72,-555.7C7708.72,-548 7708.72,-539.2 7708.72,-530.22"/>
<polygon fill="black" stroke="black" points="7712.22,-530.05 7708.72,-520.05 7705.22,-530.05 7712.22,-530.05"/>
</g>
<!-- layer_4_expert10_send&#45;&gt;layer_4_exp_agg -->
<g id="edge384" class="edge">
<title>layer_4_expert10_send&#45;&gt;layer_4_exp_agg</title>
<path fill="none" stroke="black" d="M7350.87,-414.98C7347.81,-414.63 7344.75,-414.29 7341.72,-413.95 7066.35,-383.49 6751.17,-359.42 6528.44,-344.21"/>
<polygon fill="black" stroke="black" points="6528.46,-340.7 6518.24,-343.51 6527.98,-347.69 6528.46,-340.7"/>
</g>
<!-- layer_4_expert11_gate -->
<g id="node292" class="node">
<title>layer_4_expert11_gate</title>
<polygon fill="yellow" stroke="black" points="8443.72,-750.95 8097.72,-697.95 8443.72,-644.95 8789.72,-697.95 8443.72,-750.95"/>
<text text-anchor="middle" x="8443.72" y="-709.25" font-family="Times,serif" font-size="14.00">Expert 11 Gate</text>
<text text-anchor="middle" x="8443.72" y="-694.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8443.72" y="-679.25" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_4_expert11_recv&#45;&gt;layer_4_expert11_gate -->
<g id="edge340" class="edge">
<title>layer_4_expert11_recv&#45;&gt;layer_4_expert11_gate</title>
<path fill="none" stroke="black" d="M8443.72,-786.82C8443.72,-778.53 8443.72,-769.88 8443.72,-761.38"/>
<polygon fill="black" stroke="black" points="8447.22,-761.13 8443.72,-751.13 8440.22,-761.13 8447.22,-761.13"/>
</g>
<!-- layer_4_expert11 -->
<g id="node293" class="node">
<title>layer_4_expert11</title>
<polygon fill="lightpink" stroke="black" points="8616.72,-608.95 8270.72,-608.95 8270.72,-555.95 8616.72,-555.95 8616.72,-608.95"/>
<text text-anchor="middle" x="8443.72" y="-593.75" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="8443.72" y="-578.75" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8443.72" y="-563.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_4_expert11_gate&#45;&gt;layer_4_expert11 -->
<g id="edge341" class="edge">
<title>layer_4_expert11_gate&#45;&gt;layer_4_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8443.72,-644.85C8443.72,-636.18 8443.72,-627.37 8443.72,-619.22"/>
<polygon fill="black" stroke="black" points="8447.22,-618.97 8443.72,-608.97 8440.22,-618.97 8447.22,-618.97"/>
</g>
<!-- layer_4_expert11_send -->
<g id="node294" class="node">
<title>layer_4_expert11_send</title>
<polygon fill="lightgreen" stroke="black" points="8802.65,-519.95 8231.67,-519.95 8084.78,-413.95 8655.77,-413.95 8802.65,-519.95"/>
<text text-anchor="middle" x="8443.72" y="-478.25" font-family="Times,serif" font-size="14.00">Expert 11 Send</text>
<text text-anchor="middle" x="8443.72" y="-463.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="8443.72" y="-448.25" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_4_expert11&#45;&gt;layer_4_expert11_send -->
<g id="edge342" class="edge">
<title>layer_4_expert11&#45;&gt;layer_4_expert11_send</title>
<path fill="none" stroke="black" d="M8443.72,-555.7C8443.72,-548 8443.72,-539.2 8443.72,-530.22"/>
<polygon fill="black" stroke="black" points="8447.22,-530.05 8443.72,-520.05 8440.22,-530.05 8447.22,-530.05"/>
</g>
<!-- layer_4_expert11_send&#45;&gt;layer_4_exp_agg -->
<g id="edge385" class="edge">
<title>layer_4_expert11_send&#45;&gt;layer_4_exp_agg</title>
<path fill="none" stroke="black" d="M8085.88,-414.84C8082.82,-414.54 8079.76,-414.24 8076.72,-413.95 7522.94,-361.58 6872.19,-339.74 6512.57,-331.13"/>
<polygon fill="black" stroke="black" points="6512.62,-327.63 6502.54,-330.89 6512.46,-334.63 6512.62,-327.63"/>
</g>
<!-- layer_4_expert12_gate -->
<g id="node296" class="node">
<title>layer_4_expert12_gate</title>
<polygon fill="yellow" stroke="black" points="9178.72,-750.95 8832.72,-697.95 9178.72,-644.95 9524.72,-697.95 9178.72,-750.95"/>
<text text-anchor="middle" x="9178.72" y="-709.25" font-family="Times,serif" font-size="14.00">Expert 12 Gate</text>
<text text-anchor="middle" x="9178.72" y="-694.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="9178.72" y="-679.25" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_4_expert12_recv&#45;&gt;layer_4_expert12_gate -->
<g id="edge344" class="edge">
<title>layer_4_expert12_recv&#45;&gt;layer_4_expert12_gate</title>
<path fill="none" stroke="black" d="M9178.72,-786.82C9178.72,-778.53 9178.72,-769.88 9178.72,-761.38"/>
<polygon fill="black" stroke="black" points="9182.22,-761.13 9178.72,-751.13 9175.22,-761.13 9182.22,-761.13"/>
</g>
<!-- layer_4_expert12 -->
<g id="node297" class="node">
<title>layer_4_expert12</title>
<polygon fill="lightpink" stroke="black" points="9351.72,-608.95 9005.72,-608.95 9005.72,-555.95 9351.72,-555.95 9351.72,-608.95"/>
<text text-anchor="middle" x="9178.72" y="-593.75" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="9178.72" y="-578.75" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="9178.72" y="-563.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_4_expert12_gate&#45;&gt;layer_4_expert12 -->
<g id="edge345" class="edge">
<title>layer_4_expert12_gate&#45;&gt;layer_4_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9178.72,-644.85C9178.72,-636.18 9178.72,-627.37 9178.72,-619.22"/>
<polygon fill="black" stroke="black" points="9182.22,-618.97 9178.72,-608.97 9175.22,-618.97 9182.22,-618.97"/>
</g>
<!-- layer_4_expert12_send -->
<g id="node298" class="node">
<title>layer_4_expert12_send</title>
<polygon fill="lightgreen" stroke="black" points="9537.65,-519.95 8966.67,-519.95 8819.78,-413.95 9390.77,-413.95 9537.65,-519.95"/>
<text text-anchor="middle" x="9178.72" y="-478.25" font-family="Times,serif" font-size="14.00">Expert 12 Send</text>
<text text-anchor="middle" x="9178.72" y="-463.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="9178.72" y="-448.25" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_4_expert12&#45;&gt;layer_4_expert12_send -->
<g id="edge346" class="edge">
<title>layer_4_expert12&#45;&gt;layer_4_expert12_send</title>
<path fill="none" stroke="black" d="M9178.72,-555.7C9178.72,-548 9178.72,-539.2 9178.72,-530.22"/>
<polygon fill="black" stroke="black" points="9182.22,-530.05 9178.72,-520.05 9175.22,-530.05 9182.22,-530.05"/>
</g>
<!-- layer_4_expert12_send&#45;&gt;layer_4_exp_agg -->
<g id="edge386" class="edge">
<title>layer_4_expert12_send&#45;&gt;layer_4_exp_agg</title>
<path fill="none" stroke="black" d="M8820.89,-414.78C8817.82,-414.5 8814.76,-414.22 8811.72,-413.95 7972.76,-340.38 6974.91,-327.44 6506.56,-325.73"/>
<polygon fill="black" stroke="black" points="6506.29,-322.23 6496.28,-325.7 6506.27,-329.23 6506.29,-322.23"/>
</g>
<!-- layer_4_expert13_gate -->
<g id="node300" class="node">
<title>layer_4_expert13_gate</title>
<polygon fill="yellow" stroke="black" points="9913.72,-750.95 9567.72,-697.95 9913.72,-644.95 10259.72,-697.95 9913.72,-750.95"/>
<text text-anchor="middle" x="9913.72" y="-709.25" font-family="Times,serif" font-size="14.00">Expert 13 Gate</text>
<text text-anchor="middle" x="9913.72" y="-694.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="9913.72" y="-679.25" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_4_expert13_recv&#45;&gt;layer_4_expert13_gate -->
<g id="edge348" class="edge">
<title>layer_4_expert13_recv&#45;&gt;layer_4_expert13_gate</title>
<path fill="none" stroke="black" d="M9913.72,-786.82C9913.72,-778.53 9913.72,-769.88 9913.72,-761.38"/>
<polygon fill="black" stroke="black" points="9917.22,-761.13 9913.72,-751.13 9910.22,-761.13 9917.22,-761.13"/>
</g>
<!-- layer_4_expert13 -->
<g id="node301" class="node">
<title>layer_4_expert13</title>
<polygon fill="lightpink" stroke="black" points="10086.72,-608.95 9740.72,-608.95 9740.72,-555.95 10086.72,-555.95 10086.72,-608.95"/>
<text text-anchor="middle" x="9913.72" y="-593.75" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="9913.72" y="-578.75" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="9913.72" y="-563.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_4_expert13_gate&#45;&gt;layer_4_expert13 -->
<g id="edge349" class="edge">
<title>layer_4_expert13_gate&#45;&gt;layer_4_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9913.72,-644.85C9913.72,-636.18 9913.72,-627.37 9913.72,-619.22"/>
<polygon fill="black" stroke="black" points="9917.22,-618.97 9913.72,-608.97 9910.22,-618.97 9917.22,-618.97"/>
</g>
<!-- layer_4_expert13_send -->
<g id="node302" class="node">
<title>layer_4_expert13_send</title>
<polygon fill="lightgreen" stroke="black" points="10272.65,-519.95 9701.67,-519.95 9554.78,-413.95 10125.77,-413.95 10272.65,-519.95"/>
<text text-anchor="middle" x="9913.72" y="-478.25" font-family="Times,serif" font-size="14.00">Expert 13 Send</text>
<text text-anchor="middle" x="9913.72" y="-463.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="9913.72" y="-448.25" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_4_expert13&#45;&gt;layer_4_expert13_send -->
<g id="edge350" class="edge">
<title>layer_4_expert13&#45;&gt;layer_4_expert13_send</title>
<path fill="none" stroke="black" d="M9913.72,-555.7C9913.72,-548 9913.72,-539.2 9913.72,-530.22"/>
<polygon fill="black" stroke="black" points="9917.22,-530.05 9913.72,-520.05 9910.22,-530.05 9917.22,-530.05"/>
</g>
<!-- layer_4_expert13_send&#45;&gt;layer_4_exp_agg -->
<g id="edge387" class="edge">
<title>layer_4_expert13_send&#45;&gt;layer_4_exp_agg</title>
<path fill="none" stroke="black" d="M9555.41,-414.7C9552.5,-414.44 9549.6,-414.2 9546.72,-413.95 8959.99,-364.74 7192.19,-337.92 6510.71,-329.18"/>
<polygon fill="black" stroke="black" points="6510.56,-325.68 6500.51,-329.05 6510.47,-332.68 6510.56,-325.68"/>
</g>
<!-- layer_4_expert14_gate -->
<g id="node304" class="node">
<title>layer_4_expert14_gate</title>
<polygon fill="yellow" stroke="black" points="10648.72,-750.95 10302.72,-697.95 10648.72,-644.95 10994.72,-697.95 10648.72,-750.95"/>
<text text-anchor="middle" x="10648.72" y="-709.25" font-family="Times,serif" font-size="14.00">Expert 14 Gate</text>
<text text-anchor="middle" x="10648.72" y="-694.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10648.72" y="-679.25" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_4_expert14_recv&#45;&gt;layer_4_expert14_gate -->
<g id="edge352" class="edge">
<title>layer_4_expert14_recv&#45;&gt;layer_4_expert14_gate</title>
<path fill="none" stroke="black" d="M10648.72,-786.82C10648.72,-778.53 10648.72,-769.88 10648.72,-761.38"/>
<polygon fill="black" stroke="black" points="10652.22,-761.13 10648.72,-751.13 10645.22,-761.13 10652.22,-761.13"/>
</g>
<!-- layer_4_expert14 -->
<g id="node305" class="node">
<title>layer_4_expert14</title>
<polygon fill="lightpink" stroke="black" points="10821.72,-608.95 10475.72,-608.95 10475.72,-555.95 10821.72,-555.95 10821.72,-608.95"/>
<text text-anchor="middle" x="10648.72" y="-593.75" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="10648.72" y="-578.75" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10648.72" y="-563.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_4_expert14_gate&#45;&gt;layer_4_expert14 -->
<g id="edge353" class="edge">
<title>layer_4_expert14_gate&#45;&gt;layer_4_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10648.72,-644.85C10648.72,-636.18 10648.72,-627.37 10648.72,-619.22"/>
<polygon fill="black" stroke="black" points="10652.22,-618.97 10648.72,-608.97 10645.22,-618.97 10652.22,-618.97"/>
</g>
<!-- layer_4_expert14_send -->
<g id="node306" class="node">
<title>layer_4_expert14_send</title>
<polygon fill="lightgreen" stroke="black" points="11007.65,-519.95 10436.67,-519.95 10289.78,-413.95 10860.77,-413.95 11007.65,-519.95"/>
<text text-anchor="middle" x="10648.72" y="-478.25" font-family="Times,serif" font-size="14.00">Expert 14 Send</text>
<text text-anchor="middle" x="10648.72" y="-463.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="10648.72" y="-448.25" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_4_expert14&#45;&gt;layer_4_expert14_send -->
<g id="edge354" class="edge">
<title>layer_4_expert14&#45;&gt;layer_4_expert14_send</title>
<path fill="none" stroke="black" d="M10648.72,-555.7C10648.72,-548 10648.72,-539.2 10648.72,-530.22"/>
<polygon fill="black" stroke="black" points="10652.22,-530.05 10648.72,-520.05 10645.22,-530.05 10652.22,-530.05"/>
</g>
<!-- layer_4_expert14_send&#45;&gt;layer_4_exp_agg -->
<g id="edge388" class="edge">
<title>layer_4_expert14_send&#45;&gt;layer_4_exp_agg</title>
<path fill="none" stroke="black" d="M10290.41,-414.68C10287.5,-414.43 10284.6,-414.19 10281.72,-413.95 9545.84,-354.03 7290.19,-333.17 6508.65,-327.63"/>
<polygon fill="black" stroke="black" points="6508.42,-324.13 6498.39,-327.56 6508.37,-331.13 6508.42,-324.13"/>
</g>
<!-- layer_4_expert15_gate -->
<g id="node308" class="node">
<title>layer_4_expert15_gate</title>
<polygon fill="yellow" stroke="black" points="11383.72,-750.95 11037.72,-697.95 11383.72,-644.95 11729.72,-697.95 11383.72,-750.95"/>
<text text-anchor="middle" x="11383.72" y="-709.25" font-family="Times,serif" font-size="14.00">Expert 15 Gate</text>
<text text-anchor="middle" x="11383.72" y="-694.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="11383.72" y="-679.25" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_4_expert15_recv&#45;&gt;layer_4_expert15_gate -->
<g id="edge356" class="edge">
<title>layer_4_expert15_recv&#45;&gt;layer_4_expert15_gate</title>
<path fill="none" stroke="black" d="M11383.72,-786.82C11383.72,-778.53 11383.72,-769.88 11383.72,-761.38"/>
<polygon fill="black" stroke="black" points="11387.22,-761.13 11383.72,-751.13 11380.22,-761.13 11387.22,-761.13"/>
</g>
<!-- layer_4_expert15 -->
<g id="node309" class="node">
<title>layer_4_expert15</title>
<polygon fill="lightpink" stroke="black" points="11556.72,-608.95 11210.72,-608.95 11210.72,-555.95 11556.72,-555.95 11556.72,-608.95"/>
<text text-anchor="middle" x="11383.72" y="-593.75" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="11383.72" y="-578.75" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="11383.72" y="-563.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_4_expert15_gate&#45;&gt;layer_4_expert15 -->
<g id="edge357" class="edge">
<title>layer_4_expert15_gate&#45;&gt;layer_4_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11383.72,-644.85C11383.72,-636.18 11383.72,-627.37 11383.72,-619.22"/>
<polygon fill="black" stroke="black" points="11387.22,-618.97 11383.72,-608.97 11380.22,-618.97 11387.22,-618.97"/>
</g>
<!-- layer_4_expert15_send -->
<g id="node310" class="node">
<title>layer_4_expert15_send</title>
<polygon fill="lightgreen" stroke="black" points="11742.65,-519.95 11171.67,-519.95 11024.78,-413.95 11595.77,-413.95 11742.65,-519.95"/>
<text text-anchor="middle" x="11383.72" y="-478.25" font-family="Times,serif" font-size="14.00">Expert 15 Send</text>
<text text-anchor="middle" x="11383.72" y="-463.25" font-family="Times,serif" font-size="14.00">[batch=variable, seq=variable, hidden=8192]</text>
<text text-anchor="middle" x="11383.72" y="-448.25" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_4_expert15&#45;&gt;layer_4_expert15_send -->
<g id="edge358" class="edge">
<title>layer_4_expert15&#45;&gt;layer_4_expert15_send</title>
<path fill="none" stroke="black" d="M11383.72,-555.7C11383.72,-548 11383.72,-539.2 11383.72,-530.22"/>
<polygon fill="black" stroke="black" points="11387.22,-530.05 11383.72,-520.05 11380.22,-530.05 11387.22,-530.05"/>
</g>
<!-- layer_4_expert15_send&#45;&gt;layer_4_exp_agg -->
<g id="edge389" class="edge">
<title>layer_4_expert15_send&#45;&gt;layer_4_exp_agg</title>
<path fill="none" stroke="black" d="M11025.41,-414.67C11022.5,-414.42 11019.6,-414.18 11016.72,-413.95 10130.62,-343.28 7380.22,-329.27 6507.39,-326.57"/>
<polygon fill="black" stroke="black" points="6507.22,-323.07 6497.21,-326.54 6507.2,-330.07 6507.22,-323.07"/>
</g>
<!-- layer_4_exp_agg&#45;&gt;layer_4_exp_res -->
<g id="edge390" class="edge">
<title>layer_4_exp_agg&#45;&gt;layer_4_exp_res</title>
<path fill="none" stroke="black" d="M6481.76,-313.98C7033.67,-291.33 8369.91,-236.5 8838.77,-217.26"/>
<polygon fill="black" stroke="black" points="8839.16,-220.75 8849,-216.84 8838.87,-213.76 8839.16,-220.75"/>
</g>
<!-- layer_4_output -->
<g id="node313" class="node">
<title>layer_4_output</title>
<ellipse fill="lightgreen" stroke="black" cx="9004.72" cy="-109.48" rx="219.82" ry="37.45"/>
<text text-anchor="middle" x="9004.72" y="-120.78" font-family="Times,serif" font-size="14.00">Layer 4 Output</text>
<text text-anchor="middle" x="9004.72" y="-105.78" font-family="Times,serif" font-size="14.00">[batch=1024, seq=10000, hidden=8192]</text>
<text text-anchor="middle" x="9004.72" y="-90.78" font-family="Times,serif" font-size="14.00">GPU: all</text>
</g>
<!-- layer_4_exp_res&#45;&gt;layer_4_output -->
<g id="edge392" class="edge">
<title>layer_4_exp_res&#45;&gt;layer_4_output</title>
<path fill="none" stroke="black" d="M9004.72,-182.71C9004.72,-174.89 9004.72,-166.03 9004.72,-157.27"/>
<polygon fill="black" stroke="black" points="9008.22,-157.1 9004.72,-147.1 9001.22,-157.1 9008.22,-157.1"/>
</g>
<!-- output -->
<g id="node314" class="node">
<title>output</title>
<polygon fill="none" stroke="black" points="9036.72,-36 8972.72,-36 8972.72,0 9036.72,0 9036.72,-36"/>
<text text-anchor="middle" x="9004.72" y="-14.3" font-family="Times,serif" font-size="14.00">output</text>
</g>
<!-- layer_4_output&#45;&gt;output -->
<g id="edge393" class="edge">
<title>layer_4_output&#45;&gt;output</title>
<path fill="none" stroke="black" d="M9004.72,-71.82C9004.72,-63.33 9004.72,-54.43 9004.72,-46.42"/>
<polygon fill="black" stroke="black" points="9008.22,-46.15 9004.72,-36.15 9001.22,-46.15 9008.22,-46.15"/>
</g>
</g>
</svg>
