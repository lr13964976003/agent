<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_transformer_dag Pages: 1 -->
<svg width="13657pt" height="3554pt"
 viewBox="0.00 0.00 13657.00 3553.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 3549.51)">
<title>baseline_transformer_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3549.51 13653,-3549.51 13653,4 -4,4"/>
<text text-anchor="middle" x="6824.5" y="-32" font-family="Times,serif" font-size="20.00">Baseline 4&#45;Layer Dense Transformer (TP=8, PP=2)</text>
<text text-anchor="middle" x="6824.5" y="-10" font-family="Times,serif" font-size="20.00">Total GPUs: 16</text>
<g id="clust1" class="cluster">
<title>cluster_embedding</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-2352.55 8,-2880.55 3519,-2880.55 3519,-2352.55 8,-2352.55"/>
<text text-anchor="middle" x="1763.5" y="-2860.55" font-family="Times,serif" font-size="20.00">Embedding Layer (TP=8)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer0</title>
<path fill="none" stroke="black" d="M3539,-2054.39C3539,-2054.39 11296,-2054.39 11296,-2054.39 11302,-2054.39 11308,-2060.39 11308,-2066.39 11308,-2066.39 11308,-3525.51 11308,-3525.51 11308,-3531.51 11302,-3537.51 11296,-3537.51 11296,-3537.51 3539,-3537.51 3539,-3537.51 3533,-3537.51 3527,-3531.51 3527,-3525.51 3527,-3525.51 3527,-2066.39 3527,-2066.39 3527,-2060.39 3533,-2054.39 3539,-2054.39"/>
<text text-anchor="middle" x="7417.5" y="-3517.51" font-family="Times,serif" font-size="20.00">Layer 0 &#45; Pipeline Stage 0 (GPUs 0&#45;7)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_attention_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3535,-2352.55 3535,-3499.51 7693,-3499.51 7693,-2352.55 3535,-2352.55"/>
<text text-anchor="middle" x="5614" y="-3479.51" font-family="Times,serif" font-size="20.00">Multi&#45;Head Attention (TP=8)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_ffn_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="7713,-2525.55 7713,-3298.51 11288,-3298.51 11288,-2525.55 7713,-2525.55"/>
<text text-anchor="middle" x="9500.5" y="-3278.51" font-family="Times,serif" font-size="20.00">FFN Layer (TP=8)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer1</title>
<path fill="none" stroke="black" d="M11328,-1750.39C11328,-1750.39 12076,-1750.39 12076,-1750.39 12082,-1750.39 12088,-1756.39 12088,-1762.39 12088,-1762.39 12088,-2160.39 12088,-2160.39 12088,-2166.39 12082,-2172.39 12076,-2172.39 12076,-2172.39 11328,-2172.39 11328,-2172.39 11322,-2172.39 11316,-2166.39 11316,-2160.39 11316,-2160.39 11316,-1762.39 11316,-1762.39 11316,-1756.39 11322,-1750.39 11328,-1750.39"/>
<text text-anchor="middle" x="11702" y="-2152.39" font-family="Times,serif" font-size="20.00">Layer 1 &#45; Pipeline Stage 1 (GPUs 8&#45;15)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer2</title>
<path fill="none" stroke="black" d="M11680,-1256.65C11680,-1256.65 12050,-1256.65 12050,-1256.65 12056,-1256.65 12062,-1262.65 12062,-1268.65 12062,-1268.65 12062,-1628.65 12062,-1628.65 12062,-1634.65 12056,-1640.65 12050,-1640.65 12050,-1640.65 11680,-1640.65 11680,-1640.65 11674,-1640.65 11668,-1634.65 11668,-1628.65 11668,-1628.65 11668,-1268.65 11668,-1268.65 11668,-1262.65 11674,-1256.65 11680,-1256.65"/>
<text text-anchor="middle" x="11865" y="-1620.65" font-family="Times,serif" font-size="20.00">Layer 2 &#45; Pipeline Stage 0 (GPUs 0&#45;7)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_layer3</title>
<path fill="none" stroke="black" d="M11674,-762.91C11674,-762.91 12057,-762.91 12057,-762.91 12063,-762.91 12069,-768.91 12069,-774.91 12069,-774.91 12069,-1134.91 12069,-1134.91 12069,-1140.91 12063,-1146.91 12057,-1146.91 12057,-1146.91 11674,-1146.91 11674,-1146.91 11668,-1146.91 11662,-1140.91 11662,-1134.91 11662,-1134.91 11662,-774.91 11662,-774.91 11662,-768.91 11668,-762.91 11674,-762.91"/>
<text text-anchor="middle" x="11865.5" y="-1126.91" font-family="Times,serif" font-size="20.00">Layer 3 &#45; Pipeline Stage 1 (GPUs 8&#45;15)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_output</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="10194,-60 10194,-653.17 13641,-653.17 13641,-60 10194,-60"/>
<text text-anchor="middle" x="11917.5" y="-633.17" font-family="Times,serif" font-size="20.00">Output Layer (TP=8)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="#e8f4fd" stroke="black" cx="1763" cy="-2945.03" rx="297.88" ry="37.45"/>
<text text-anchor="middle" x="1763" y="-2956.33" font-family="monospace" font-size="14.00">Input</text>
<text text-anchor="middle" x="1763" y="-2941.33" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="1763" y="-2926.33" font-family="monospace" font-size="14.00">GPU: Host</text>
</g>
<!-- embed_split -->
<g id="node2" class="node">
<title>embed_split</title>
<polygon fill="#ffe4b5" stroke="black" points="2199.45,-2842.55 1505.16,-2842.55 1326.55,-2706.55 2020.84,-2706.55 2199.45,-2842.55"/>
<text text-anchor="middle" x="1763" y="-2793.35" font-family="monospace" font-size="14.00">Split (TP=8)</text>
<text text-anchor="middle" x="1763" y="-2778.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="1763" y="-2763.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="1763" y="-2748.35" font-family="monospace" font-size="14.00">GPU: All</text>
</g>
<!-- input&#45;&gt;embed_split -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embed_split</title>
<path fill="none" stroke="black" d="M1763,-2907.2C1763,-2907.2 1763,-2852.81 1763,-2852.81"/>
<polygon fill="black" stroke="black" points="1766.5,-2852.81 1763,-2842.81 1759.5,-2852.81 1766.5,-2852.81"/>
</g>
<!-- embed_0 -->
<g id="node3" class="node">
<title>embed_0</title>
<polygon fill="#90ee90" stroke="black" points="3071.5,-2635.55 2650.5,-2635.55 2650.5,-2567.55 3071.5,-2567.55 3071.5,-2635.55"/>
<text text-anchor="middle" x="2861" y="-2620.35" font-family="monospace" font-size="14.00">Embedding GPU0</text>
<text text-anchor="middle" x="2861" y="-2605.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="2861" y="-2590.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="2861" y="-2575.35" font-family="monospace" font-size="14.00">GPU: gpu_0</text>
</g>
<!-- embed_split&#45;&gt;embed_0 -->
<g id="edge2" class="edge">
<title>embed_split&#45;&gt;embed_0</title>
<path fill="none" stroke="black" d="M2042.56,-2723C2367.86,-2723 2861,-2723 2861,-2723 2861,-2723 2861,-2645.71 2861,-2645.71"/>
<polygon fill="black" stroke="black" points="2864.5,-2645.71 2861,-2635.71 2857.5,-2645.71 2864.5,-2645.71"/>
</g>
<!-- embed_1 -->
<g id="node4" class="node">
<title>embed_1</title>
<polygon fill="#90ee90" stroke="black" points="3510.5,-2635.55 3089.5,-2635.55 3089.5,-2567.55 3510.5,-2567.55 3510.5,-2635.55"/>
<text text-anchor="middle" x="3300" y="-2620.35" font-family="monospace" font-size="14.00">Embedding GPU1</text>
<text text-anchor="middle" x="3300" y="-2605.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="3300" y="-2590.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="3300" y="-2575.35" font-family="monospace" font-size="14.00">GPU: gpu_1</text>
</g>
<!-- embed_split&#45;&gt;embed_1 -->
<g id="edge3" class="edge">
<title>embed_split&#45;&gt;embed_1</title>
<path fill="none" stroke="black" d="M2054.36,-2732C2500.04,-2732 3300,-2732 3300,-2732 3300,-2732 3300,-2645.83 3300,-2645.83"/>
<polygon fill="black" stroke="black" points="3303.5,-2645.83 3300,-2635.83 3296.5,-2645.83 3303.5,-2645.83"/>
</g>
<!-- embed_2 -->
<g id="node5" class="node">
<title>embed_2</title>
<polygon fill="#90ee90" stroke="black" points="437.5,-2635.55 16.5,-2635.55 16.5,-2567.55 437.5,-2567.55 437.5,-2635.55"/>
<text text-anchor="middle" x="227" y="-2620.35" font-family="monospace" font-size="14.00">Embedding GPU2</text>
<text text-anchor="middle" x="227" y="-2605.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="227" y="-2590.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="227" y="-2575.35" font-family="monospace" font-size="14.00">GPU: gpu_2</text>
</g>
<!-- embed_split&#45;&gt;embed_2 -->
<g id="edge4" class="edge">
<title>embed_split&#45;&gt;embed_2</title>
<path fill="none" stroke="black" d="M1459.54,-2808C1011.9,-2808 227,-2808 227,-2808 227,-2808 227,-2645.64 227,-2645.64"/>
<polygon fill="black" stroke="black" points="230.5,-2645.64 227,-2635.64 223.5,-2645.64 230.5,-2645.64"/>
</g>
<!-- embed_3 -->
<g id="node6" class="node">
<title>embed_3</title>
<polygon fill="#90ee90" stroke="black" points="876.5,-2635.55 455.5,-2635.55 455.5,-2567.55 876.5,-2567.55 876.5,-2635.55"/>
<text text-anchor="middle" x="666" y="-2620.35" font-family="monospace" font-size="14.00">Embedding GPU3</text>
<text text-anchor="middle" x="666" y="-2605.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="666" y="-2590.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="666" y="-2575.35" font-family="monospace" font-size="14.00">GPU: gpu_3</text>
</g>
<!-- embed_split&#45;&gt;embed_3 -->
<g id="edge5" class="edge">
<title>embed_split&#45;&gt;embed_3</title>
<path fill="none" stroke="black" d="M1414.77,-2774C1093.51,-2774 666,-2774 666,-2774 666,-2774 666,-2645.62 666,-2645.62"/>
<polygon fill="black" stroke="black" points="669.5,-2645.62 666,-2635.62 662.5,-2645.62 669.5,-2645.62"/>
</g>
<!-- embed_4 -->
<g id="node7" class="node">
<title>embed_4</title>
<polygon fill="#90ee90" stroke="black" points="1315.5,-2635.55 894.5,-2635.55 894.5,-2567.55 1315.5,-2567.55 1315.5,-2635.55"/>
<text text-anchor="middle" x="1105" y="-2620.35" font-family="monospace" font-size="14.00">Embedding GPU4</text>
<text text-anchor="middle" x="1105" y="-2605.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="1105" y="-2590.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="1105" y="-2575.35" font-family="monospace" font-size="14.00">GPU: gpu_4</text>
</g>
<!-- embed_split&#45;&gt;embed_4 -->
<g id="edge6" class="edge">
<title>embed_split&#45;&gt;embed_4</title>
<path fill="none" stroke="black" d="M1370.26,-2740C1229.54,-2740 1105,-2740 1105,-2740 1105,-2740 1105,-2645.78 1105,-2645.78"/>
<polygon fill="black" stroke="black" points="1108.5,-2645.78 1105,-2635.78 1101.5,-2645.78 1108.5,-2645.78"/>
</g>
<!-- embed_5 -->
<g id="node8" class="node">
<title>embed_5</title>
<polygon fill="#90ee90" stroke="black" points="1754.5,-2635.55 1333.5,-2635.55 1333.5,-2567.55 1754.5,-2567.55 1754.5,-2635.55"/>
<text text-anchor="middle" x="1544" y="-2620.35" font-family="monospace" font-size="14.00">Embedding GPU5</text>
<text text-anchor="middle" x="1544" y="-2605.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="1544" y="-2590.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="1544" y="-2575.35" font-family="monospace" font-size="14.00">GPU: gpu_5</text>
</g>
<!-- embed_split&#45;&gt;embed_5 -->
<g id="edge7" class="edge">
<title>embed_split&#45;&gt;embed_5</title>
<path fill="none" stroke="black" d="M1544,-2706.18C1544,-2706.18 1544,-2645.73 1544,-2645.73"/>
<polygon fill="black" stroke="black" points="1547.5,-2645.73 1544,-2635.73 1540.5,-2645.73 1547.5,-2645.73"/>
</g>
<!-- embed_6 -->
<g id="node9" class="node">
<title>embed_6</title>
<polygon fill="#90ee90" stroke="black" points="2193.5,-2635.55 1772.5,-2635.55 1772.5,-2567.55 2193.5,-2567.55 2193.5,-2635.55"/>
<text text-anchor="middle" x="1983" y="-2620.35" font-family="monospace" font-size="14.00">Embedding GPU6</text>
<text text-anchor="middle" x="1983" y="-2605.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="1983" y="-2590.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="1983" y="-2575.35" font-family="monospace" font-size="14.00">GPU: gpu_6</text>
</g>
<!-- embed_split&#45;&gt;embed_6 -->
<g id="edge8" class="edge">
<title>embed_split&#45;&gt;embed_6</title>
<path fill="none" stroke="black" d="M1983,-2706.18C1983,-2706.18 1983,-2645.73 1983,-2645.73"/>
<polygon fill="black" stroke="black" points="1986.5,-2645.73 1983,-2635.73 1979.5,-2645.73 1986.5,-2645.73"/>
</g>
<!-- embed_7 -->
<g id="node10" class="node">
<title>embed_7</title>
<polygon fill="#90ee90" stroke="black" points="2632.5,-2635.55 2211.5,-2635.55 2211.5,-2567.55 2632.5,-2567.55 2632.5,-2635.55"/>
<text text-anchor="middle" x="2422" y="-2620.35" font-family="monospace" font-size="14.00">Embedding GPU7</text>
<text text-anchor="middle" x="2422" y="-2605.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="2422" y="-2590.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="2422" y="-2575.35" font-family="monospace" font-size="14.00">GPU: gpu_7</text>
</g>
<!-- embed_split&#45;&gt;embed_7 -->
<g id="edge9" class="edge">
<title>embed_split&#45;&gt;embed_7</title>
<path fill="none" stroke="black" d="M2031.99,-2715C2214.21,-2715 2422,-2715 2422,-2715 2422,-2715 2422,-2645.59 2422,-2645.59"/>
<polygon fill="black" stroke="black" points="2425.5,-2645.59 2422,-2635.59 2418.5,-2645.59 2425.5,-2645.59"/>
</g>
<!-- embed_gather -->
<g id="node11" class="node">
<title>embed_gather</title>
<polygon fill="#ffe4b5" stroke="black" points="2427.53,-2496.55 1720.38,-2496.55 1538.47,-2360.55 2245.62,-2360.55 2427.53,-2496.55"/>
<text text-anchor="middle" x="1983" y="-2447.35" font-family="monospace" font-size="14.00">All&#45;Gather (TP=8)</text>
<text text-anchor="middle" x="1983" y="-2432.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="1983" y="-2417.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="1983" y="-2402.35" font-family="monospace" font-size="14.00">GPU: All</text>
</g>
<!-- embed_0&#45;&gt;embed_gather -->
<g id="edge10" class="edge">
<title>embed_0&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M2704.5,-2567.46C2704.5,-2514.38 2704.5,-2418 2704.5,-2418 2704.5,-2418 2332.62,-2418 2332.62,-2418"/>
<polygon fill="black" stroke="black" points="2332.62,-2414.5 2322.62,-2418 2332.62,-2421.5 2332.62,-2414.5"/>
</g>
<!-- embed_1&#45;&gt;embed_gather -->
<g id="edge11" class="edge">
<title>embed_1&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M3138.5,-2567.19C3138.5,-2509.4 3138.5,-2399 3138.5,-2399 3138.5,-2399 2307.22,-2399 2307.22,-2399"/>
<polygon fill="black" stroke="black" points="2307.22,-2395.5 2297.22,-2399 2307.22,-2402.5 2307.22,-2395.5"/>
</g>
<!-- embed_2&#45;&gt;embed_gather -->
<g id="edge12" class="edge">
<title>embed_2&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M227,-2567.28C227,-2508.33 227,-2394 227,-2394 227,-2394 1573.16,-2394 1573.16,-2394"/>
<polygon fill="black" stroke="black" points="1573.16,-2397.5 1583.16,-2394 1573.16,-2390.5 1573.16,-2397.5"/>
</g>
<!-- embed_3&#45;&gt;embed_gather -->
<g id="edge13" class="edge">
<title>embed_3&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M666,-2567.26C666,-2516.69 666,-2428 666,-2428 666,-2428 1618.34,-2428 1618.34,-2428"/>
<polygon fill="black" stroke="black" points="1618.34,-2431.5 1628.34,-2428 1618.34,-2424.5 1618.34,-2431.5"/>
</g>
<!-- embed_4&#45;&gt;embed_gather -->
<g id="edge14" class="edge">
<title>embed_4&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M1105,-2567.41C1105,-2526.1 1105,-2462 1105,-2462 1105,-2462 1664.07,-2462 1664.07,-2462"/>
<polygon fill="black" stroke="black" points="1664.07,-2465.5 1674.07,-2462 1664.07,-2458.5 1664.07,-2465.5"/>
</g>
<!-- embed_5&#45;&gt;embed_gather -->
<g id="edge15" class="edge">
<title>embed_5&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M1646.37,-2567.37C1646.37,-2567.37 1646.37,-2451.49 1646.37,-2451.49"/>
<polygon fill="black" stroke="black" points="1649.87,-2451.49 1646.37,-2441.49 1642.87,-2451.49 1649.87,-2451.49"/>
</g>
<!-- embed_6&#45;&gt;embed_gather -->
<g id="edge16" class="edge">
<title>embed_6&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M1983,-2567.37C1983,-2567.37 1983,-2506.66 1983,-2506.66"/>
<polygon fill="black" stroke="black" points="1986.5,-2506.66 1983,-2496.66 1979.5,-2506.66 1986.5,-2506.66"/>
</g>
<!-- embed_7&#45;&gt;embed_gather -->
<g id="edge17" class="edge">
<title>embed_7&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M2319.63,-2567.37C2319.63,-2567.37 2319.63,-2506.66 2319.63,-2506.66"/>
<polygon fill="black" stroke="black" points="2323.13,-2506.66 2319.63,-2496.66 2316.13,-2506.66 2323.13,-2506.66"/>
</g>
<!-- pos_enc -->
<g id="node12" class="node">
<title>pos_enc</title>
<polygon fill="#87ceeb" stroke="black" points="3187.5,-2295.47 2758.5,-2295.47 2758.5,-2227.47 3187.5,-2227.47 3187.5,-2295.47"/>
<text text-anchor="middle" x="2973" y="-2280.27" font-family="monospace" font-size="14.00">Positional Encoding</text>
<text text-anchor="middle" x="2973" y="-2265.27" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="2973" y="-2250.27" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="2973" y="-2235.27" font-family="monospace" font-size="14.00">GPU: All</text>
</g>
<!-- embed_gather&#45;&gt;pos_enc -->
<g id="edge18" class="edge">
<title>embed_gather&#45;&gt;pos_enc</title>
<path fill="none" stroke="black" d="M2270.55,-2379C2544.37,-2379 2915,-2379 2915,-2379 2915,-2379 2915,-2305.78 2915,-2305.78"/>
<polygon fill="black" stroke="black" points="2918.5,-2305.78 2915,-2295.78 2911.5,-2305.78 2918.5,-2305.78"/>
</g>
<!-- layernorm_0 -->
<g id="node13" class="node">
<title>layernorm_0</title>
<polygon fill="#dda0dd" stroke="black" points="7916.5,-2130.39 7487.5,-2130.39 7487.5,-2062.39 7916.5,-2062.39 7916.5,-2130.39"/>
<text text-anchor="middle" x="7702" y="-2115.19" font-family="monospace" font-size="14.00">LayerNorm 0</text>
<text text-anchor="middle" x="7702" y="-2100.19" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="7702" y="-2085.19" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="7702" y="-2070.19" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- pos_enc&#45;&gt;layernorm_0 -->
<g id="edge19" class="edge">
<title>pos_enc&#45;&gt;layernorm_0</title>
<path fill="none" stroke="black" d="M2973,-2227.44C2973,-2176.16 2973,-2085 2973,-2085 2973,-2085 7477.29,-2085 7477.29,-2085"/>
<polygon fill="black" stroke="black" points="7477.29,-2088.5 7487.29,-2085 7477.29,-2081.5 7477.29,-2088.5"/>
</g>
<!-- qkv_split_0 -->
<g id="node14" class="node">
<title>qkv_split_0</title>
<polygon fill="#ffe4b5" stroke="black" points="6077.12,-3461.51 5356.31,-3461.51 5170.88,-3325.51 5891.69,-3325.51 6077.12,-3461.51"/>
<text text-anchor="middle" x="5624" y="-3412.31" font-family="monospace" font-size="14.00">Split QKV (TP=8)</text>
<text text-anchor="middle" x="5624" y="-3397.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="5624" y="-3382.31" font-family="monospace" font-size="14.00">Output: 8Ã—[batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5624" y="-3367.31" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layernorm_0&#45;&gt;qkv_split_0 -->
<g id="edge20" class="edge">
<title>layernorm_0&#45;&gt;qkv_split_0</title>
<path fill="none" stroke="black" d="M7487.25,-2107C7171.33,-2107 6618.33,-2107 6618.33,-2107 6618.33,-2107 6618.33,-3293 6618.33,-3293 6618.33,-3293 5787.69,-3293 5787.69,-3293 5787.69,-3293 5787.69,-3315.35 5787.69,-3315.35"/>
<polygon fill="black" stroke="black" points="5784.19,-3315.35 5787.69,-3325.35 5791.19,-3315.35 5784.19,-3315.35"/>
</g>
<!-- q_proj_0 -->
<g id="node15" class="node">
<title>q_proj_0</title>
<polygon fill="#ffb6c1" stroke="black" points="6105,-3226.51 5643,-3226.51 5643,-3158.51 6105,-3158.51 6105,-3226.51"/>
<text text-anchor="middle" x="5874" y="-3211.31" font-family="monospace" font-size="14.00">Q Proj GPU0</text>
<text text-anchor="middle" x="5874" y="-3196.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5874" y="-3181.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5874" y="-3166.31" font-family="monospace" font-size="14.00">GPU: gpu_0</text>
</g>
<!-- qkv_split_0&#45;&gt;q_proj_0 -->
<g id="edge21" class="edge">
<title>qkv_split_0&#45;&gt;q_proj_0</title>
<path fill="none" stroke="black" d="M5932.37,-3355.23C5932.37,-3355.23 5932.37,-3236.63 5932.37,-3236.63"/>
<polygon fill="black" stroke="black" points="5935.87,-3236.63 5932.37,-3226.63 5928.87,-3236.63 5935.87,-3236.63"/>
</g>
<!-- k_proj_0 -->
<g id="node16" class="node">
<title>k_proj_0</title>
<polygon fill="#ffb6c1" stroke="black" points="6105,-3087.51 5643,-3087.51 5643,-3019.51 6105,-3019.51 6105,-3087.51"/>
<text text-anchor="middle" x="5874" y="-3072.31" font-family="monospace" font-size="14.00">K Proj GPU0</text>
<text text-anchor="middle" x="5874" y="-3057.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5874" y="-3042.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5874" y="-3027.31" font-family="monospace" font-size="14.00">GPU: gpu_0</text>
</g>
<!-- qkv_split_0&#45;&gt;k_proj_0 -->
<g id="edge22" class="edge">
<title>qkv_split_0&#45;&gt;k_proj_0</title>
<path fill="none" stroke="black" d="M5633,-3325.32C5633,-3223.1 5633,-3042 5633,-3042 5633,-3042 5633.97,-3042 5633.97,-3042"/>
<polygon fill="black" stroke="black" points="5632.75,-3045.5 5642.75,-3042 5632.75,-3038.5 5632.75,-3045.5"/>
</g>
<!-- v_proj_0 -->
<g id="node17" class="node">
<title>v_proj_0</title>
<polygon fill="#ffb6c1" stroke="black" points="6101,-2979.03 5639,-2979.03 5639,-2911.03 6101,-2911.03 6101,-2979.03"/>
<text text-anchor="middle" x="5870" y="-2963.83" font-family="monospace" font-size="14.00">V Proj GPU0</text>
<text text-anchor="middle" x="5870" y="-2948.83" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5870" y="-2933.83" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5870" y="-2918.83" font-family="monospace" font-size="14.00">GPU: gpu_0</text>
</g>
<!-- qkv_split_0&#45;&gt;v_proj_0 -->
<g id="edge23" class="edge">
<title>qkv_split_0&#45;&gt;v_proj_0</title>
<path fill="none" stroke="black" d="M5627,-3325.06C5627,-3196.78 5627,-2933 5627,-2933 5627,-2933 5628.72,-2933 5628.72,-2933"/>
<polygon fill="black" stroke="black" points="5628.72,-2936.5 5638.72,-2933 5628.72,-2929.5 5628.72,-2936.5"/>
</g>
<!-- q_proj_1 -->
<g id="node18" class="node">
<title>q_proj_1</title>
<polygon fill="#ffb6c1" stroke="black" points="5085,-3226.51 4623,-3226.51 4623,-3158.51 5085,-3158.51 5085,-3226.51"/>
<text text-anchor="middle" x="4854" y="-3211.31" font-family="monospace" font-size="14.00">Q Proj GPU1</text>
<text text-anchor="middle" x="4854" y="-3196.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="4854" y="-3181.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4854" y="-3166.31" font-family="monospace" font-size="14.00">GPU: gpu_1</text>
</g>
<!-- qkv_split_0&#45;&gt;q_proj_1 -->
<g id="edge24" class="edge">
<title>qkv_split_0&#45;&gt;q_proj_1</title>
<path fill="none" stroke="black" d="M5226.03,-3366C5037.95,-3366 4854,-3366 4854,-3366 4854,-3366 4854,-3236.78 4854,-3236.78"/>
<polygon fill="black" stroke="black" points="4857.5,-3236.78 4854,-3226.78 4850.5,-3236.78 4857.5,-3236.78"/>
</g>
<!-- k_proj_1 -->
<g id="node19" class="node">
<title>k_proj_1</title>
<polygon fill="#ffb6c1" stroke="black" points="5085,-3087.51 4623,-3087.51 4623,-3019.51 5085,-3019.51 5085,-3087.51"/>
<text text-anchor="middle" x="4854" y="-3072.31" font-family="monospace" font-size="14.00">K Proj GPU1</text>
<text text-anchor="middle" x="4854" y="-3057.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="4854" y="-3042.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4854" y="-3027.31" font-family="monospace" font-size="14.00">GPU: gpu_1</text>
</g>
<!-- qkv_split_0&#45;&gt;k_proj_1 -->
<g id="edge25" class="edge">
<title>qkv_split_0&#45;&gt;k_proj_1</title>
<path fill="none" stroke="black" d="M5189.2,-3339C5152.48,-3339 5129,-3339 5129,-3339 5129,-3339 5129,-3053 5129,-3053 5129,-3053 5095.12,-3053 5095.12,-3053"/>
<polygon fill="black" stroke="black" points="5095.12,-3049.5 5085.12,-3053 5095.12,-3056.5 5095.12,-3049.5"/>
</g>
<!-- v_proj_1 -->
<g id="node20" class="node">
<title>v_proj_1</title>
<polygon fill="#ffb6c1" stroke="black" points="5105,-2979.03 4643,-2979.03 4643,-2911.03 5105,-2911.03 5105,-2979.03"/>
<text text-anchor="middle" x="4874" y="-2963.83" font-family="monospace" font-size="14.00">V Proj GPU1</text>
<text text-anchor="middle" x="4874" y="-2948.83" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="4874" y="-2933.83" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4874" y="-2918.83" font-family="monospace" font-size="14.00">GPU: gpu_1</text>
</g>
<!-- qkv_split_0&#45;&gt;v_proj_1 -->
<g id="edge26" class="edge">
<title>qkv_split_0&#45;&gt;v_proj_1</title>
<path fill="none" stroke="black" d="M5206.86,-3352C5141.47,-3352 5095,-3352 5095,-3352 5095,-3352 5095,-2989.38 5095,-2989.38"/>
<polygon fill="black" stroke="black" points="5098.5,-2989.38 5095,-2979.38 5091.5,-2989.38 5098.5,-2989.38"/>
</g>
<!-- q_proj_2 -->
<g id="node21" class="node">
<title>q_proj_2</title>
<polygon fill="#ffb6c1" stroke="black" points="5605,-3226.51 5143,-3226.51 5143,-3158.51 5605,-3158.51 5605,-3226.51"/>
<text text-anchor="middle" x="5374" y="-3211.31" font-family="monospace" font-size="14.00">Q Proj GPU2</text>
<text text-anchor="middle" x="5374" y="-3196.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5374" y="-3181.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5374" y="-3166.31" font-family="monospace" font-size="14.00">GPU: gpu_2</text>
</g>
<!-- qkv_split_0&#45;&gt;q_proj_2 -->
<g id="edge27" class="edge">
<title>qkv_split_0&#45;&gt;q_proj_2</title>
<path fill="none" stroke="black" d="M5387.97,-3325.46C5387.97,-3325.46 5387.97,-3236.63 5387.97,-3236.63"/>
<polygon fill="black" stroke="black" points="5391.47,-3236.63 5387.97,-3226.63 5384.47,-3236.63 5391.47,-3236.63"/>
</g>
<!-- k_proj_2 -->
<g id="node22" class="node">
<title>k_proj_2</title>
<polygon fill="#ffb6c1" stroke="black" points="5595,-3087.51 5133,-3087.51 5133,-3019.51 5595,-3019.51 5595,-3087.51"/>
<text text-anchor="middle" x="5364" y="-3072.31" font-family="monospace" font-size="14.00">K Proj GPU2</text>
<text text-anchor="middle" x="5364" y="-3057.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5364" y="-3042.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5364" y="-3027.31" font-family="monospace" font-size="14.00">GPU: gpu_2</text>
</g>
<!-- qkv_split_0&#45;&gt;k_proj_2 -->
<g id="edge28" class="edge">
<title>qkv_split_0&#45;&gt;k_proj_2</title>
<path fill="none" stroke="black" d="M5608,-3325.23C5608,-3228.72 5608,-3064 5608,-3064 5608,-3064 5605.23,-3064 5605.23,-3064"/>
<polygon fill="black" stroke="black" points="5605.23,-3060.5 5595.23,-3064 5605.23,-3067.5 5605.23,-3060.5"/>
</g>
<!-- v_proj_2 -->
<g id="node23" class="node">
<title>v_proj_2</title>
<polygon fill="#ffb6c1" stroke="black" points="5595,-2979.03 5133,-2979.03 5133,-2911.03 5595,-2911.03 5595,-2979.03"/>
<text text-anchor="middle" x="5364" y="-2963.83" font-family="monospace" font-size="14.00">V Proj GPU2</text>
<text text-anchor="middle" x="5364" y="-2948.83" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5364" y="-2933.83" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5364" y="-2918.83" font-family="monospace" font-size="14.00">GPU: gpu_2</text>
</g>
<!-- qkv_split_0&#45;&gt;v_proj_2 -->
<g id="edge29" class="edge">
<title>qkv_split_0&#45;&gt;v_proj_2</title>
<path fill="none" stroke="black" d="M5611,-3325.15C5611,-3202.1 5611,-2956 5611,-2956 5611,-2956 5605.17,-2956 5605.17,-2956"/>
<polygon fill="black" stroke="black" points="5605.17,-2952.5 5595.17,-2956 5605.17,-2959.5 5605.17,-2952.5"/>
</g>
<!-- q_proj_3 -->
<g id="node24" class="node">
<title>q_proj_3</title>
<polygon fill="#ffb6c1" stroke="black" points="4525,-3226.51 4063,-3226.51 4063,-3158.51 4525,-3158.51 4525,-3226.51"/>
<text text-anchor="middle" x="4294" y="-3211.31" font-family="monospace" font-size="14.00">Q Proj GPU3</text>
<text text-anchor="middle" x="4294" y="-3196.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="4294" y="-3181.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4294" y="-3166.31" font-family="monospace" font-size="14.00">GPU: gpu_3</text>
</g>
<!-- qkv_split_0&#45;&gt;q_proj_3 -->
<g id="edge30" class="edge">
<title>qkv_split_0&#45;&gt;q_proj_3</title>
<path fill="none" stroke="black" d="M5281.92,-3407C4887.86,-3407 4294,-3407 4294,-3407 4294,-3407 4294,-3236.97 4294,-3236.97"/>
<polygon fill="black" stroke="black" points="4297.5,-3236.97 4294,-3226.97 4290.5,-3236.97 4297.5,-3236.97"/>
</g>
<!-- k_proj_3 -->
<g id="node25" class="node">
<title>k_proj_3</title>
<polygon fill="#ffb6c1" stroke="black" points="4545,-3087.51 4083,-3087.51 4083,-3019.51 4545,-3019.51 4545,-3087.51"/>
<text text-anchor="middle" x="4314" y="-3072.31" font-family="monospace" font-size="14.00">K Proj GPU3</text>
<text text-anchor="middle" x="4314" y="-3057.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="4314" y="-3042.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4314" y="-3027.31" font-family="monospace" font-size="14.00">GPU: gpu_3</text>
</g>
<!-- qkv_split_0&#45;&gt;k_proj_3 -->
<g id="edge31" class="edge">
<title>qkv_split_0&#45;&gt;k_proj_3</title>
<path fill="none" stroke="black" d="M5262.89,-3393C4945.89,-3393 4535,-3393 4535,-3393 4535,-3393 4535,-3097.61 4535,-3097.61"/>
<polygon fill="black" stroke="black" points="4538.5,-3097.61 4535,-3087.61 4531.5,-3097.61 4538.5,-3097.61"/>
</g>
<!-- v_proj_3 -->
<g id="node26" class="node">
<title>v_proj_3</title>
<polygon fill="#ffb6c1" stroke="black" points="4625,-2979.03 4163,-2979.03 4163,-2911.03 4625,-2911.03 4625,-2979.03"/>
<text text-anchor="middle" x="4394" y="-2963.83" font-family="monospace" font-size="14.00">V Proj GPU3</text>
<text text-anchor="middle" x="4394" y="-2948.83" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="4394" y="-2933.83" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4394" y="-2918.83" font-family="monospace" font-size="14.00">GPU: gpu_3</text>
</g>
<!-- qkv_split_0&#45;&gt;v_proj_3 -->
<g id="edge32" class="edge">
<title>qkv_split_0&#45;&gt;v_proj_3</title>
<path fill="none" stroke="black" d="M5243.75,-3379C4946.73,-3379 4584,-3379 4584,-3379 4584,-3379 4584,-2989.08 4584,-2989.08"/>
<polygon fill="black" stroke="black" points="4587.5,-2989.08 4584,-2979.08 4580.5,-2989.08 4587.5,-2989.08"/>
</g>
<!-- q_proj_4 -->
<g id="node27" class="node">
<title>q_proj_4</title>
<polygon fill="#ffb6c1" stroke="black" points="6605,-3226.51 6143,-3226.51 6143,-3158.51 6605,-3158.51 6605,-3226.51"/>
<text text-anchor="middle" x="6374" y="-3211.31" font-family="monospace" font-size="14.00">Q Proj GPU4</text>
<text text-anchor="middle" x="6374" y="-3196.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6374" y="-3181.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6374" y="-3166.31" font-family="monospace" font-size="14.00">GPU: gpu_4</text>
</g>
<!-- qkv_split_0&#45;&gt;q_proj_4 -->
<g id="edge33" class="edge">
<title>qkv_split_0&#45;&gt;q_proj_4</title>
<path fill="none" stroke="black" d="M5927.97,-3352C6135.87,-3352 6374,-3352 6374,-3352 6374,-3352 6374,-3236.72 6374,-3236.72"/>
<polygon fill="black" stroke="black" points="6377.5,-3236.72 6374,-3226.72 6370.5,-3236.72 6377.5,-3236.72"/>
</g>
<!-- k_proj_4 -->
<g id="node28" class="node">
<title>k_proj_4</title>
<polygon fill="#ffb6c1" stroke="black" points="6615,-3087.51 6153,-3087.51 6153,-3019.51 6615,-3019.51 6615,-3087.51"/>
<text text-anchor="middle" x="6384" y="-3072.31" font-family="monospace" font-size="14.00">K Proj GPU4</text>
<text text-anchor="middle" x="6384" y="-3057.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6384" y="-3042.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6384" y="-3027.31" font-family="monospace" font-size="14.00">GPU: gpu_4</text>
</g>
<!-- qkv_split_0&#45;&gt;k_proj_4 -->
<g id="edge34" class="edge">
<title>qkv_split_0&#45;&gt;k_proj_4</title>
<path fill="none" stroke="black" d="M5947.19,-3366C6234.71,-3366 6610,-3366 6610,-3366 6610,-3366 6610,-3097.54 6610,-3097.54"/>
<polygon fill="black" stroke="black" points="6613.5,-3097.54 6610,-3087.54 6606.5,-3097.54 6613.5,-3097.54"/>
</g>
<!-- v_proj_4 -->
<g id="node29" class="node">
<title>v_proj_4</title>
<polygon fill="#ffb6c1" stroke="black" points="6615,-2979.03 6153,-2979.03 6153,-2911.03 6615,-2911.03 6615,-2979.03"/>
<text text-anchor="middle" x="6384" y="-2963.83" font-family="monospace" font-size="14.00">V Proj GPU4</text>
<text text-anchor="middle" x="6384" y="-2948.83" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6384" y="-2933.83" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6384" y="-2918.83" font-family="monospace" font-size="14.00">GPU: gpu_4</text>
</g>
<!-- qkv_split_0&#45;&gt;v_proj_4 -->
<g id="edge35" class="edge">
<title>qkv_split_0&#45;&gt;v_proj_4</title>
<path fill="none" stroke="black" d="M5910.13,-3339C6018.62,-3339 6116.5,-3339 6116.5,-3339 6116.5,-3339 6116.5,-2945 6116.5,-2945 6116.5,-2945 6142.85,-2945 6142.85,-2945"/>
<polygon fill="black" stroke="black" points="6142.85,-2948.5 6152.85,-2945 6142.85,-2941.5 6142.85,-2948.5"/>
</g>
<!-- q_proj_5 -->
<g id="node30" class="node">
<title>q_proj_5</title>
<polygon fill="#ffb6c1" stroke="black" points="7125,-3226.51 6663,-3226.51 6663,-3158.51 7125,-3158.51 7125,-3226.51"/>
<text text-anchor="middle" x="6894" y="-3211.31" font-family="monospace" font-size="14.00">Q Proj GPU5</text>
<text text-anchor="middle" x="6894" y="-3196.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6894" y="-3181.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6894" y="-3166.31" font-family="monospace" font-size="14.00">GPU: gpu_5</text>
</g>
<!-- qkv_split_0&#45;&gt;q_proj_5 -->
<g id="edge36" class="edge">
<title>qkv_split_0&#45;&gt;q_proj_5</title>
<path fill="none" stroke="black" d="M5984.11,-3393C6359.6,-3393 6894,-3393 6894,-3393 6894,-3393 6894,-3236.52 6894,-3236.52"/>
<polygon fill="black" stroke="black" points="6897.5,-3236.52 6894,-3226.52 6890.5,-3236.52 6897.5,-3236.52"/>
</g>
<!-- k_proj_5 -->
<g id="node31" class="node">
<title>k_proj_5</title>
<polygon fill="#ffb6c1" stroke="black" points="7135,-3087.51 6673,-3087.51 6673,-3019.51 7135,-3019.51 7135,-3087.51"/>
<text text-anchor="middle" x="6904" y="-3072.31" font-family="monospace" font-size="14.00">K Proj GPU5</text>
<text text-anchor="middle" x="6904" y="-3057.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6904" y="-3042.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6904" y="-3027.31" font-family="monospace" font-size="14.00">GPU: gpu_5</text>
</g>
<!-- qkv_split_0&#45;&gt;k_proj_5 -->
<g id="edge37" class="edge">
<title>qkv_split_0&#45;&gt;k_proj_5</title>
<path fill="none" stroke="black" d="M6003.06,-3407C6449.18,-3407 7130,-3407 7130,-3407 7130,-3407 7130,-3097.72 7130,-3097.72"/>
<polygon fill="black" stroke="black" points="7133.5,-3097.72 7130,-3087.72 7126.5,-3097.72 7133.5,-3097.72"/>
</g>
<!-- v_proj_5 -->
<g id="node32" class="node">
<title>v_proj_5</title>
<polygon fill="#ffb6c1" stroke="black" points="7135,-2979.03 6673,-2979.03 6673,-2911.03 7135,-2911.03 7135,-2979.03"/>
<text text-anchor="middle" x="6904" y="-2963.83" font-family="monospace" font-size="14.00">V Proj GPU5</text>
<text text-anchor="middle" x="6904" y="-2948.83" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6904" y="-2933.83" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6904" y="-2918.83" font-family="monospace" font-size="14.00">GPU: gpu_5</text>
</g>
<!-- qkv_split_0&#45;&gt;v_proj_5 -->
<g id="edge38" class="edge">
<title>qkv_split_0&#45;&gt;v_proj_5</title>
<path fill="none" stroke="black" d="M5964.9,-3379C6253.86,-3379 6621.67,-3379 6621.67,-3379 6621.67,-3379 6621.67,-2945 6621.67,-2945 6621.67,-2945 6662.8,-2945 6662.8,-2945"/>
<polygon fill="black" stroke="black" points="6662.8,-2948.5 6672.8,-2945 6662.8,-2941.5 6662.8,-2948.5"/>
</g>
<!-- q_proj_6 -->
<g id="node33" class="node">
<title>q_proj_6</title>
<polygon fill="#ffb6c1" stroke="black" points="7645,-3226.51 7183,-3226.51 7183,-3158.51 7645,-3158.51 7645,-3226.51"/>
<text text-anchor="middle" x="7414" y="-3211.31" font-family="monospace" font-size="14.00">Q Proj GPU6</text>
<text text-anchor="middle" x="7414" y="-3196.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="7414" y="-3181.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7414" y="-3166.31" font-family="monospace" font-size="14.00">GPU: gpu_6</text>
</g>
<!-- qkv_split_0&#45;&gt;q_proj_6 -->
<g id="edge39" class="edge">
<title>qkv_split_0&#45;&gt;q_proj_6</title>
<path fill="none" stroke="black" d="M6039.72,-3434C6568.55,-3434 7414,-3434 7414,-3434 7414,-3434 7414,-3236.59 7414,-3236.59"/>
<polygon fill="black" stroke="black" points="7417.5,-3236.59 7414,-3226.59 7410.5,-3236.59 7417.5,-3236.59"/>
</g>
<!-- k_proj_6 -->
<g id="node34" class="node">
<title>k_proj_6</title>
<polygon fill="#ffb6c1" stroke="black" points="7654,-3087.51 7192,-3087.51 7192,-3019.51 7654,-3019.51 7654,-3087.51"/>
<text text-anchor="middle" x="7423" y="-3072.31" font-family="monospace" font-size="14.00">K Proj GPU6</text>
<text text-anchor="middle" x="7423" y="-3057.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="7423" y="-3042.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7423" y="-3027.31" font-family="monospace" font-size="14.00">GPU: gpu_6</text>
</g>
<!-- qkv_split_0&#45;&gt;k_proj_6 -->
<g id="edge40" class="edge">
<title>qkv_split_0&#45;&gt;k_proj_6</title>
<path fill="none" stroke="black" d="M6057.59,-3447C6652.64,-3447 7649.5,-3447 7649.5,-3447 7649.5,-3447 7649.5,-3097.74 7649.5,-3097.74"/>
<polygon fill="black" stroke="black" points="7653,-3097.74 7649.5,-3087.74 7646,-3097.74 7653,-3097.74"/>
</g>
<!-- v_proj_6 -->
<g id="node35" class="node">
<title>v_proj_6</title>
<polygon fill="#ffb6c1" stroke="black" points="7654,-2979.03 7192,-2979.03 7192,-2911.03 7654,-2911.03 7654,-2979.03"/>
<text text-anchor="middle" x="7423" y="-2963.83" font-family="monospace" font-size="14.00">V Proj GPU6</text>
<text text-anchor="middle" x="7423" y="-2948.83" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="7423" y="-2933.83" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7423" y="-2918.83" font-family="monospace" font-size="14.00">GPU: gpu_6</text>
</g>
<!-- qkv_split_0&#45;&gt;v_proj_6 -->
<g id="edge41" class="edge">
<title>qkv_split_0&#45;&gt;v_proj_6</title>
<path fill="none" stroke="black" d="M6020.93,-3420C6472.48,-3420 7148,-3420 7148,-3420 7148,-3420 7148,-2945 7148,-2945 7148,-2945 7181.88,-2945 7181.88,-2945"/>
<polygon fill="black" stroke="black" points="7181.88,-2948.5 7191.88,-2945 7181.88,-2941.5 7181.88,-2948.5"/>
</g>
<!-- q_proj_7 -->
<g id="node36" class="node">
<title>q_proj_7</title>
<polygon fill="#ffb6c1" stroke="black" points="4045,-3226.51 3583,-3226.51 3583,-3158.51 4045,-3158.51 4045,-3226.51"/>
<text text-anchor="middle" x="3814" y="-3211.31" font-family="monospace" font-size="14.00">Q Proj GPU7</text>
<text text-anchor="middle" x="3814" y="-3196.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="3814" y="-3181.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3814" y="-3166.31" font-family="monospace" font-size="14.00">GPU: gpu_7</text>
</g>
<!-- qkv_split_0&#45;&gt;q_proj_7 -->
<g id="edge42" class="edge">
<title>qkv_split_0&#45;&gt;q_proj_7</title>
<path fill="none" stroke="black" d="M5318.75,-3434C4802.84,-3434 3814,-3434 3814,-3434 3814,-3434 3814,-3236.59 3814,-3236.59"/>
<polygon fill="black" stroke="black" points="3817.5,-3236.59 3814,-3226.59 3810.5,-3236.59 3817.5,-3236.59"/>
</g>
<!-- k_proj_7 -->
<g id="node37" class="node">
<title>k_proj_7</title>
<polygon fill="#ffb6c1" stroke="black" points="4030,-3087.51 3568,-3087.51 3568,-3019.51 4030,-3019.51 4030,-3087.51"/>
<text text-anchor="middle" x="3799" y="-3072.31" font-family="monospace" font-size="14.00">K Proj GPU7</text>
<text text-anchor="middle" x="3799" y="-3057.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="3799" y="-3042.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3799" y="-3027.31" font-family="monospace" font-size="14.00">GPU: gpu_7</text>
</g>
<!-- qkv_split_0&#45;&gt;k_proj_7 -->
<g id="edge43" class="edge">
<title>qkv_split_0&#45;&gt;k_proj_7</title>
<path fill="none" stroke="black" d="M5336.47,-3447C4772.47,-3447 3575.5,-3447 3575.5,-3447 3575.5,-3447 3575.5,-3097.74 3575.5,-3097.74"/>
<polygon fill="black" stroke="black" points="3579,-3097.74 3575.5,-3087.74 3572,-3097.74 3579,-3097.74"/>
</g>
<!-- v_proj_7 -->
<g id="node38" class="node">
<title>v_proj_7</title>
<polygon fill="#ffb6c1" stroke="black" points="4030,-2979.03 3568,-2979.03 3568,-2911.03 4030,-2911.03 4030,-2979.03"/>
<text text-anchor="middle" x="3799" y="-2963.83" font-family="monospace" font-size="14.00">V Proj GPU7</text>
<text text-anchor="middle" x="3799" y="-2948.83" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="3799" y="-2933.83" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3799" y="-2918.83" font-family="monospace" font-size="14.00">GPU: gpu_7</text>
</g>
<!-- qkv_split_0&#45;&gt;v_proj_7 -->
<g id="edge44" class="edge">
<title>qkv_split_0&#45;&gt;v_proj_7</title>
<path fill="none" stroke="black" d="M5299.65,-3420C4839.92,-3420 4054,-3420 4054,-3420 4054,-3420 4054,-2945 4054,-2945 4054,-2945 4040.01,-2945 4040.01,-2945"/>
<polygon fill="black" stroke="black" points="4040.01,-2941.5 4030.01,-2945 4040.01,-2948.5 4040.01,-2941.5"/>
</g>
<!-- q_proj_0&#45;&gt;k_proj_0 -->
<g id="edge45" class="edge">
<title>q_proj_0&#45;&gt;k_proj_0</title>
<path fill="none" stroke="black" d="M5874,-3158.5C5874,-3158.5 5874,-3097.64 5874,-3097.64"/>
<polygon fill="black" stroke="black" points="5877.5,-3097.64 5874,-3087.64 5870.5,-3097.64 5877.5,-3097.64"/>
</g>
<!-- k_proj_0&#45;&gt;v_proj_0 -->
<g id="edge46" class="edge">
<title>k_proj_0&#45;&gt;v_proj_0</title>
<path fill="none" stroke="black" d="M5872,-3019.48C5872,-3019.48 5872,-2989.31 5872,-2989.31"/>
<polygon fill="black" stroke="black" points="5875.5,-2989.31 5872,-2979.31 5868.5,-2989.31 5875.5,-2989.31"/>
</g>
<!-- attn_0 -->
<g id="node39" class="node">
<title>attn_0</title>
<polygon fill="#ffd700" stroke="black" points="6101,-2808.55 5639,-2808.55 5639,-2740.55 6101,-2740.55 6101,-2808.55"/>
<text text-anchor="middle" x="5870" y="-2793.35" font-family="monospace" font-size="14.00">Attention GPU0</text>
<text text-anchor="middle" x="5870" y="-2778.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5870" y="-2763.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5870" y="-2748.35" font-family="monospace" font-size="14.00">GPU: gpu_0</text>
</g>
<!-- v_proj_0&#45;&gt;attn_0 -->
<g id="edge47" class="edge">
<title>v_proj_0&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M5870,-2910.94C5870,-2910.94 5870,-2818.58 5870,-2818.58"/>
<polygon fill="black" stroke="black" points="5873.5,-2818.58 5870,-2808.58 5866.5,-2818.58 5873.5,-2818.58"/>
</g>
<!-- q_proj_1&#45;&gt;k_proj_1 -->
<g id="edge49" class="edge">
<title>q_proj_1&#45;&gt;k_proj_1</title>
<path fill="none" stroke="black" d="M4854,-3158.5C4854,-3158.5 4854,-3097.64 4854,-3097.64"/>
<polygon fill="black" stroke="black" points="4857.5,-3097.64 4854,-3087.64 4850.5,-3097.64 4857.5,-3097.64"/>
</g>
<!-- k_proj_1&#45;&gt;v_proj_1 -->
<g id="edge50" class="edge">
<title>k_proj_1&#45;&gt;v_proj_1</title>
<path fill="none" stroke="black" d="M4864,-3019.48C4864,-3019.48 4864,-2989.31 4864,-2989.31"/>
<polygon fill="black" stroke="black" points="4867.5,-2989.31 4864,-2979.31 4860.5,-2989.31 4867.5,-2989.31"/>
</g>
<!-- attn_1 -->
<g id="node40" class="node">
<title>attn_1</title>
<polygon fill="#ffd700" stroke="black" points="5125,-2808.55 4663,-2808.55 4663,-2740.55 5125,-2740.55 5125,-2808.55"/>
<text text-anchor="middle" x="4894" y="-2793.35" font-family="monospace" font-size="14.00">Attention GPU1</text>
<text text-anchor="middle" x="4894" y="-2778.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4894" y="-2763.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4894" y="-2748.35" font-family="monospace" font-size="14.00">GPU: gpu_1</text>
</g>
<!-- v_proj_1&#45;&gt;attn_1 -->
<g id="edge51" class="edge">
<title>v_proj_1&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M4884,-2910.94C4884,-2910.94 4884,-2818.58 4884,-2818.58"/>
<polygon fill="black" stroke="black" points="4887.5,-2818.58 4884,-2808.58 4880.5,-2818.58 4887.5,-2818.58"/>
</g>
<!-- q_proj_2&#45;&gt;k_proj_2 -->
<g id="edge53" class="edge">
<title>q_proj_2&#45;&gt;k_proj_2</title>
<path fill="none" stroke="black" d="M5369,-3158.5C5369,-3158.5 5369,-3097.64 5369,-3097.64"/>
<polygon fill="black" stroke="black" points="5372.5,-3097.64 5369,-3087.64 5365.5,-3097.64 5372.5,-3097.64"/>
</g>
<!-- k_proj_2&#45;&gt;v_proj_2 -->
<g id="edge54" class="edge">
<title>k_proj_2&#45;&gt;v_proj_2</title>
<path fill="none" stroke="black" d="M5364,-3019.48C5364,-3019.48 5364,-2989.31 5364,-2989.31"/>
<polygon fill="black" stroke="black" points="5367.5,-2989.31 5364,-2979.31 5360.5,-2989.31 5367.5,-2989.31"/>
</g>
<!-- attn_2 -->
<g id="node41" class="node">
<title>attn_2</title>
<polygon fill="#ffd700" stroke="black" points="5614,-2808.55 5152,-2808.55 5152,-2740.55 5614,-2740.55 5614,-2808.55"/>
<text text-anchor="middle" x="5383" y="-2793.35" font-family="monospace" font-size="14.00">Attention GPU2</text>
<text text-anchor="middle" x="5383" y="-2778.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5383" y="-2763.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5383" y="-2748.35" font-family="monospace" font-size="14.00">GPU: gpu_2</text>
</g>
<!-- v_proj_2&#45;&gt;attn_2 -->
<g id="edge55" class="edge">
<title>v_proj_2&#45;&gt;attn_2</title>
<path fill="none" stroke="black" d="M5373.5,-2910.94C5373.5,-2910.94 5373.5,-2818.58 5373.5,-2818.58"/>
<polygon fill="black" stroke="black" points="5377,-2818.58 5373.5,-2808.58 5370,-2818.58 5377,-2818.58"/>
</g>
<!-- q_proj_3&#45;&gt;k_proj_3 -->
<g id="edge57" class="edge">
<title>q_proj_3&#45;&gt;k_proj_3</title>
<path fill="none" stroke="black" d="M4304,-3158.5C4304,-3158.5 4304,-3097.64 4304,-3097.64"/>
<polygon fill="black" stroke="black" points="4307.5,-3097.64 4304,-3087.64 4300.5,-3097.64 4307.5,-3097.64"/>
</g>
<!-- k_proj_3&#45;&gt;v_proj_3 -->
<g id="edge58" class="edge">
<title>k_proj_3&#45;&gt;v_proj_3</title>
<path fill="none" stroke="black" d="M4354,-3019.48C4354,-3019.48 4354,-2989.31 4354,-2989.31"/>
<polygon fill="black" stroke="black" points="4357.5,-2989.31 4354,-2979.31 4350.5,-2989.31 4357.5,-2989.31"/>
</g>
<!-- attn_3 -->
<g id="node42" class="node">
<title>attn_3</title>
<polygon fill="#ffd700" stroke="black" points="4636,-2808.55 4174,-2808.55 4174,-2740.55 4636,-2740.55 4636,-2808.55"/>
<text text-anchor="middle" x="4405" y="-2793.35" font-family="monospace" font-size="14.00">Attention GPU3</text>
<text text-anchor="middle" x="4405" y="-2778.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4405" y="-2763.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4405" y="-2748.35" font-family="monospace" font-size="14.00">GPU: gpu_3</text>
</g>
<!-- v_proj_3&#45;&gt;attn_3 -->
<g id="edge59" class="edge">
<title>v_proj_3&#45;&gt;attn_3</title>
<path fill="none" stroke="black" d="M4399.5,-2910.94C4399.5,-2910.94 4399.5,-2818.58 4399.5,-2818.58"/>
<polygon fill="black" stroke="black" points="4403,-2818.58 4399.5,-2808.58 4396,-2818.58 4403,-2818.58"/>
</g>
<!-- q_proj_4&#45;&gt;k_proj_4 -->
<g id="edge61" class="edge">
<title>q_proj_4&#45;&gt;k_proj_4</title>
<path fill="none" stroke="black" d="M6379,-3158.5C6379,-3158.5 6379,-3097.64 6379,-3097.64"/>
<polygon fill="black" stroke="black" points="6382.5,-3097.64 6379,-3087.64 6375.5,-3097.64 6382.5,-3097.64"/>
</g>
<!-- k_proj_4&#45;&gt;v_proj_4 -->
<g id="edge62" class="edge">
<title>k_proj_4&#45;&gt;v_proj_4</title>
<path fill="none" stroke="black" d="M6384,-3019.48C6384,-3019.48 6384,-2989.31 6384,-2989.31"/>
<polygon fill="black" stroke="black" points="6387.5,-2989.31 6384,-2979.31 6380.5,-2989.31 6387.5,-2989.31"/>
</g>
<!-- attn_4 -->
<g id="node43" class="node">
<title>attn_4</title>
<polygon fill="#ffd700" stroke="black" points="6600,-2808.55 6138,-2808.55 6138,-2740.55 6600,-2740.55 6600,-2808.55"/>
<text text-anchor="middle" x="6369" y="-2793.35" font-family="monospace" font-size="14.00">Attention GPU4</text>
<text text-anchor="middle" x="6369" y="-2778.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6369" y="-2763.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6369" y="-2748.35" font-family="monospace" font-size="14.00">GPU: gpu_4</text>
</g>
<!-- v_proj_4&#45;&gt;attn_4 -->
<g id="edge63" class="edge">
<title>v_proj_4&#45;&gt;attn_4</title>
<path fill="none" stroke="black" d="M6376.5,-2910.94C6376.5,-2910.94 6376.5,-2818.58 6376.5,-2818.58"/>
<polygon fill="black" stroke="black" points="6380,-2818.58 6376.5,-2808.58 6373,-2818.58 6380,-2818.58"/>
</g>
<!-- q_proj_5&#45;&gt;k_proj_5 -->
<g id="edge65" class="edge">
<title>q_proj_5&#45;&gt;k_proj_5</title>
<path fill="none" stroke="black" d="M6899,-3158.5C6899,-3158.5 6899,-3097.64 6899,-3097.64"/>
<polygon fill="black" stroke="black" points="6902.5,-3097.64 6899,-3087.64 6895.5,-3097.64 6902.5,-3097.64"/>
</g>
<!-- k_proj_5&#45;&gt;v_proj_5 -->
<g id="edge66" class="edge">
<title>k_proj_5&#45;&gt;v_proj_5</title>
<path fill="none" stroke="black" d="M6904,-3019.48C6904,-3019.48 6904,-2989.31 6904,-2989.31"/>
<polygon fill="black" stroke="black" points="6907.5,-2989.31 6904,-2979.31 6900.5,-2989.31 6907.5,-2989.31"/>
</g>
<!-- attn_5 -->
<g id="node44" class="node">
<title>attn_5</title>
<polygon fill="#ffd700" stroke="black" points="7109,-2808.55 6647,-2808.55 6647,-2740.55 7109,-2740.55 7109,-2808.55"/>
<text text-anchor="middle" x="6878" y="-2793.35" font-family="monospace" font-size="14.00">Attention GPU5</text>
<text text-anchor="middle" x="6878" y="-2778.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6878" y="-2763.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6878" y="-2748.35" font-family="monospace" font-size="14.00">GPU: gpu_5</text>
</g>
<!-- v_proj_5&#45;&gt;attn_5 -->
<g id="edge67" class="edge">
<title>v_proj_5&#45;&gt;attn_5</title>
<path fill="none" stroke="black" d="M6891,-2910.94C6891,-2910.94 6891,-2818.58 6891,-2818.58"/>
<polygon fill="black" stroke="black" points="6894.5,-2818.58 6891,-2808.58 6887.5,-2818.58 6894.5,-2818.58"/>
</g>
<!-- q_proj_6&#45;&gt;k_proj_6 -->
<g id="edge69" class="edge">
<title>q_proj_6&#45;&gt;k_proj_6</title>
<path fill="none" stroke="black" d="M7418.5,-3158.5C7418.5,-3158.5 7418.5,-3097.64 7418.5,-3097.64"/>
<polygon fill="black" stroke="black" points="7422,-3097.64 7418.5,-3087.64 7415,-3097.64 7422,-3097.64"/>
</g>
<!-- k_proj_6&#45;&gt;v_proj_6 -->
<g id="edge70" class="edge">
<title>k_proj_6&#45;&gt;v_proj_6</title>
<path fill="none" stroke="black" d="M7423,-3019.48C7423,-3019.48 7423,-2989.31 7423,-2989.31"/>
<polygon fill="black" stroke="black" points="7426.5,-2989.31 7423,-2979.31 7419.5,-2989.31 7426.5,-2989.31"/>
</g>
<!-- attn_6 -->
<g id="node45" class="node">
<title>attn_6</title>
<polygon fill="#ffd700" stroke="black" points="7623,-2808.55 7161,-2808.55 7161,-2740.55 7623,-2740.55 7623,-2808.55"/>
<text text-anchor="middle" x="7392" y="-2793.35" font-family="monospace" font-size="14.00">Attention GPU6</text>
<text text-anchor="middle" x="7392" y="-2778.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7392" y="-2763.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7392" y="-2748.35" font-family="monospace" font-size="14.00">GPU: gpu_6</text>
</g>
<!-- v_proj_6&#45;&gt;attn_6 -->
<g id="edge71" class="edge">
<title>v_proj_6&#45;&gt;attn_6</title>
<path fill="none" stroke="black" d="M7407.5,-2910.94C7407.5,-2910.94 7407.5,-2818.58 7407.5,-2818.58"/>
<polygon fill="black" stroke="black" points="7411,-2818.58 7407.5,-2808.58 7404,-2818.58 7411,-2818.58"/>
</g>
<!-- q_proj_7&#45;&gt;k_proj_7 -->
<g id="edge73" class="edge">
<title>q_proj_7&#45;&gt;k_proj_7</title>
<path fill="none" stroke="black" d="M3806.5,-3158.5C3806.5,-3158.5 3806.5,-3097.64 3806.5,-3097.64"/>
<polygon fill="black" stroke="black" points="3810,-3097.64 3806.5,-3087.64 3803,-3097.64 3810,-3097.64"/>
</g>
<!-- k_proj_7&#45;&gt;v_proj_7 -->
<g id="edge74" class="edge">
<title>k_proj_7&#45;&gt;v_proj_7</title>
<path fill="none" stroke="black" d="M3799,-3019.48C3799,-3019.48 3799,-2989.31 3799,-2989.31"/>
<polygon fill="black" stroke="black" points="3802.5,-2989.31 3799,-2979.31 3795.5,-2989.31 3802.5,-2989.31"/>
</g>
<!-- attn_7 -->
<g id="node46" class="node">
<title>attn_7</title>
<polygon fill="#ffd700" stroke="black" points="4098,-2808.55 3636,-2808.55 3636,-2740.55 4098,-2740.55 4098,-2808.55"/>
<text text-anchor="middle" x="3867" y="-2793.35" font-family="monospace" font-size="14.00">Attention GPU7</text>
<text text-anchor="middle" x="3867" y="-2778.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3867" y="-2763.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3867" y="-2748.35" font-family="monospace" font-size="14.00">GPU: gpu_7</text>
</g>
<!-- v_proj_7&#45;&gt;attn_7 -->
<g id="edge75" class="edge">
<title>v_proj_7&#45;&gt;attn_7</title>
<path fill="none" stroke="black" d="M3833,-2910.94C3833,-2910.94 3833,-2818.58 3833,-2818.58"/>
<polygon fill="black" stroke="black" points="3836.5,-2818.58 3833,-2808.58 3829.5,-2818.58 3836.5,-2818.58"/>
</g>
<!-- out_proj_0 -->
<g id="node47" class="node">
<title>out_proj_0</title>
<polygon fill="#ffb6c1" stroke="black" points="6097,-2635.55 5643,-2635.55 5643,-2567.55 6097,-2567.55 6097,-2635.55"/>
<text text-anchor="middle" x="5870" y="-2620.35" font-family="monospace" font-size="14.00">Output Proj GPU0</text>
<text text-anchor="middle" x="5870" y="-2605.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5870" y="-2590.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5870" y="-2575.35" font-family="monospace" font-size="14.00">GPU: gpu_0</text>
</g>
<!-- attn_0&#45;&gt;out_proj_0 -->
<g id="edge48" class="edge">
<title>attn_0&#45;&gt;out_proj_0</title>
<path fill="none" stroke="black" d="M5870,-2740.37C5870,-2740.37 5870,-2645.66 5870,-2645.66"/>
<polygon fill="black" stroke="black" points="5873.5,-2645.66 5870,-2635.66 5866.5,-2645.66 5873.5,-2645.66"/>
</g>
<!-- out_proj_1 -->
<g id="node48" class="node">
<title>out_proj_1</title>
<polygon fill="#ffb6c1" stroke="black" points="5141,-2635.55 4687,-2635.55 4687,-2567.55 5141,-2567.55 5141,-2635.55"/>
<text text-anchor="middle" x="4914" y="-2620.35" font-family="monospace" font-size="14.00">Output Proj GPU1</text>
<text text-anchor="middle" x="4914" y="-2605.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4914" y="-2590.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="4914" y="-2575.35" font-family="monospace" font-size="14.00">GPU: gpu_1</text>
</g>
<!-- attn_1&#45;&gt;out_proj_1 -->
<g id="edge52" class="edge">
<title>attn_1&#45;&gt;out_proj_1</title>
<path fill="none" stroke="black" d="M4906,-2740.37C4906,-2740.37 4906,-2645.66 4906,-2645.66"/>
<polygon fill="black" stroke="black" points="4909.5,-2645.66 4906,-2635.66 4902.5,-2645.66 4909.5,-2645.66"/>
</g>
<!-- out_proj_2 -->
<g id="node49" class="node">
<title>out_proj_2</title>
<polygon fill="#ffb6c1" stroke="black" points="5621,-2635.55 5167,-2635.55 5167,-2567.55 5621,-2567.55 5621,-2635.55"/>
<text text-anchor="middle" x="5394" y="-2620.35" font-family="monospace" font-size="14.00">Output Proj GPU2</text>
<text text-anchor="middle" x="5394" y="-2605.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5394" y="-2590.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5394" y="-2575.35" font-family="monospace" font-size="14.00">GPU: gpu_2</text>
</g>
<!-- attn_2&#45;&gt;out_proj_2 -->
<g id="edge56" class="edge">
<title>attn_2&#45;&gt;out_proj_2</title>
<path fill="none" stroke="black" d="M5390.5,-2740.37C5390.5,-2740.37 5390.5,-2645.66 5390.5,-2645.66"/>
<polygon fill="black" stroke="black" points="5394,-2645.66 5390.5,-2635.66 5387,-2645.66 5394,-2645.66"/>
</g>
<!-- out_proj_3 -->
<g id="node50" class="node">
<title>out_proj_3</title>
<polygon fill="#ffb6c1" stroke="black" points="4663,-2635.55 4209,-2635.55 4209,-2567.55 4663,-2567.55 4663,-2635.55"/>
<text text-anchor="middle" x="4436" y="-2620.35" font-family="monospace" font-size="14.00">Output Proj GPU3</text>
<text text-anchor="middle" x="4436" y="-2605.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4436" y="-2590.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="4436" y="-2575.35" font-family="monospace" font-size="14.00">GPU: gpu_3</text>
</g>
<!-- attn_3&#45;&gt;out_proj_3 -->
<g id="edge60" class="edge">
<title>attn_3&#45;&gt;out_proj_3</title>
<path fill="none" stroke="black" d="M4422.5,-2740.37C4422.5,-2740.37 4422.5,-2645.66 4422.5,-2645.66"/>
<polygon fill="black" stroke="black" points="4426,-2645.66 4422.5,-2635.66 4419,-2645.66 4426,-2645.66"/>
</g>
<!-- out_proj_4 -->
<g id="node51" class="node">
<title>out_proj_4</title>
<polygon fill="#ffb6c1" stroke="black" points="6582,-2635.55 6128,-2635.55 6128,-2567.55 6582,-2567.55 6582,-2635.55"/>
<text text-anchor="middle" x="6355" y="-2620.35" font-family="monospace" font-size="14.00">Output Proj GPU4</text>
<text text-anchor="middle" x="6355" y="-2605.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6355" y="-2590.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6355" y="-2575.35" font-family="monospace" font-size="14.00">GPU: gpu_4</text>
</g>
<!-- attn_4&#45;&gt;out_proj_4 -->
<g id="edge64" class="edge">
<title>attn_4&#45;&gt;out_proj_4</title>
<path fill="none" stroke="black" d="M6360,-2740.37C6360,-2740.37 6360,-2645.66 6360,-2645.66"/>
<polygon fill="black" stroke="black" points="6363.5,-2645.66 6360,-2635.66 6356.5,-2645.66 6363.5,-2645.66"/>
</g>
<!-- out_proj_5 -->
<g id="node52" class="node">
<title>out_proj_5</title>
<polygon fill="#ffb6c1" stroke="black" points="7079,-2635.55 6625,-2635.55 6625,-2567.55 7079,-2567.55 7079,-2635.55"/>
<text text-anchor="middle" x="6852" y="-2620.35" font-family="monospace" font-size="14.00">Output Proj GPU5</text>
<text text-anchor="middle" x="6852" y="-2605.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6852" y="-2590.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6852" y="-2575.35" font-family="monospace" font-size="14.00">GPU: gpu_5</text>
</g>
<!-- attn_5&#45;&gt;out_proj_5 -->
<g id="edge68" class="edge">
<title>attn_5&#45;&gt;out_proj_5</title>
<path fill="none" stroke="black" d="M6863,-2740.37C6863,-2740.37 6863,-2645.66 6863,-2645.66"/>
<polygon fill="black" stroke="black" points="6866.5,-2645.66 6863,-2635.66 6859.5,-2645.66 6866.5,-2645.66"/>
</g>
<!-- out_proj_6 -->
<g id="node53" class="node">
<title>out_proj_6</title>
<polygon fill="#ffb6c1" stroke="black" points="7585,-2635.55 7131,-2635.55 7131,-2567.55 7585,-2567.55 7585,-2635.55"/>
<text text-anchor="middle" x="7358" y="-2620.35" font-family="monospace" font-size="14.00">Output Proj GPU6</text>
<text text-anchor="middle" x="7358" y="-2605.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7358" y="-2590.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="7358" y="-2575.35" font-family="monospace" font-size="14.00">GPU: gpu_6</text>
</g>
<!-- attn_6&#45;&gt;out_proj_6 -->
<g id="edge72" class="edge">
<title>attn_6&#45;&gt;out_proj_6</title>
<path fill="none" stroke="black" d="M7373,-2740.37C7373,-2740.37 7373,-2645.66 7373,-2645.66"/>
<polygon fill="black" stroke="black" points="7376.5,-2645.66 7373,-2635.66 7369.5,-2645.66 7376.5,-2645.66"/>
</g>
<!-- out_proj_7 -->
<g id="node54" class="node">
<title>out_proj_7</title>
<polygon fill="#ffb6c1" stroke="black" points="4162,-2635.55 3708,-2635.55 3708,-2567.55 4162,-2567.55 4162,-2635.55"/>
<text text-anchor="middle" x="3935" y="-2620.35" font-family="monospace" font-size="14.00">Output Proj GPU7</text>
<text text-anchor="middle" x="3935" y="-2605.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3935" y="-2590.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="3935" y="-2575.35" font-family="monospace" font-size="14.00">GPU: gpu_7</text>
</g>
<!-- attn_7&#45;&gt;out_proj_7 -->
<g id="edge76" class="edge">
<title>attn_7&#45;&gt;out_proj_7</title>
<path fill="none" stroke="black" d="M3903,-2740.37C3903,-2740.37 3903,-2645.66 3903,-2645.66"/>
<polygon fill="black" stroke="black" points="3906.5,-2645.66 3903,-2635.66 3899.5,-2645.66 3906.5,-2645.66"/>
</g>
<!-- concat_0 -->
<g id="node55" class="node">
<title>concat_0</title>
<polygon fill="#ffe4b5" stroke="black" points="6314.53,-2496.55 5607.38,-2496.55 5425.47,-2360.55 6132.62,-2360.55 6314.53,-2496.55"/>
<text text-anchor="middle" x="5870" y="-2447.35" font-family="monospace" font-size="14.00">Concat (TP=8)</text>
<text text-anchor="middle" x="5870" y="-2432.35" font-family="monospace" font-size="14.00">Input: 8Ã—[batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5870" y="-2417.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="5870" y="-2402.35" font-family="monospace" font-size="14.00">GPU: All</text>
</g>
<!-- out_proj_0&#45;&gt;concat_0 -->
<g id="edge77" class="edge">
<title>out_proj_0&#45;&gt;concat_0</title>
<path fill="none" stroke="black" d="M5870,-2567.37C5870,-2567.37 5870,-2506.66 5870,-2506.66"/>
<polygon fill="black" stroke="black" points="5873.5,-2506.66 5870,-2496.66 5866.5,-2506.66 5873.5,-2506.66"/>
</g>
<!-- out_proj_1&#45;&gt;concat_0 -->
<g id="edge78" class="edge">
<title>out_proj_1&#45;&gt;concat_0</title>
<path fill="none" stroke="black" d="M4914,-2567.52C4914,-2530.64 4914,-2477 4914,-2477 4914,-2477 5571.22,-2477 5571.22,-2477"/>
<polygon fill="black" stroke="black" points="5571.22,-2480.5 5581.22,-2477 5571.22,-2473.5 5571.22,-2480.5"/>
</g>
<!-- out_proj_2&#45;&gt;concat_0 -->
<g id="edge79" class="edge">
<title>out_proj_2&#45;&gt;concat_0</title>
<path fill="none" stroke="black" d="M5523.12,-2567.37C5523.12,-2567.37 5523.12,-2443.71 5523.12,-2443.71"/>
<polygon fill="black" stroke="black" points="5526.62,-2443.71 5523.12,-2433.71 5519.62,-2443.71 5526.62,-2443.71"/>
</g>
<!-- out_proj_3&#45;&gt;concat_0 -->
<g id="edge80" class="edge">
<title>out_proj_3&#45;&gt;concat_0</title>
<path fill="none" stroke="black" d="M4436,-2567.3C4436,-2524.55 4436,-2457 4436,-2457 4436,-2457 5544.42,-2457 5544.42,-2457"/>
<polygon fill="black" stroke="black" points="5544.42,-2460.5 5554.42,-2457 5544.42,-2453.5 5544.42,-2460.5"/>
</g>
<!-- out_proj_4&#45;&gt;concat_0 -->
<g id="edge81" class="edge">
<title>out_proj_4&#45;&gt;concat_0</title>
<path fill="none" stroke="black" d="M6221.38,-2567.37C6221.38,-2567.37 6221.38,-2506.66 6221.38,-2506.66"/>
<polygon fill="black" stroke="black" points="6224.88,-2506.66 6221.38,-2496.66 6217.88,-2506.66 6224.88,-2506.66"/>
</g>
<!-- out_proj_5&#45;&gt;concat_0 -->
<g id="edge82" class="edge">
<title>out_proj_5&#45;&gt;concat_0</title>
<path fill="none" stroke="black" d="M6852,-2567.53C6852,-2533.13 6852,-2485 6852,-2485 6852,-2485 6309.29,-2485 6309.29,-2485"/>
<polygon fill="black" stroke="black" points="6309.29,-2481.5 6299.29,-2485 6309.29,-2488.5 6309.29,-2481.5"/>
</g>
<!-- out_proj_6&#45;&gt;concat_0 -->
<g id="edge83" class="edge">
<title>out_proj_6&#45;&gt;concat_0</title>
<path fill="none" stroke="black" d="M7309.25,-2567.44C7309.25,-2529.36 7309.25,-2473 7309.25,-2473 7309.25,-2473 6293.4,-2473 6293.4,-2473"/>
<polygon fill="black" stroke="black" points="6293.4,-2469.5 6283.4,-2473 6293.4,-2476.5 6293.4,-2469.5"/>
</g>
<!-- out_proj_7&#45;&gt;concat_0 -->
<g id="edge84" class="edge">
<title>out_proj_7&#45;&gt;concat_0</title>
<path fill="none" stroke="black" d="M3935,-2567.27C3935,-2519.31 3935,-2438 3935,-2438 3935,-2438 5518.79,-2438 5518.79,-2438"/>
<polygon fill="black" stroke="black" points="5518.79,-2441.5 5528.79,-2438 5518.79,-2434.5 5518.79,-2441.5"/>
</g>
<!-- residual_0 -->
<g id="node56" class="node">
<title>residual_0</title>
<polygon fill="#dda0dd" stroke="black" points="7916.5,-2295.47 7487.5,-2295.47 7487.5,-2227.47 7916.5,-2227.47 7916.5,-2295.47"/>
<text text-anchor="middle" x="7702" y="-2280.27" font-family="monospace" font-size="14.00">Residual Add 0</text>
<text text-anchor="middle" x="7702" y="-2265.27" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="7702" y="-2250.27" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="7702" y="-2235.27" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- concat_0&#45;&gt;residual_0 -->
<g id="edge85" class="edge">
<title>concat_0&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M6155.02,-2377C6631.05,-2377 7536.25,-2377 7536.25,-2377 7536.25,-2377 7536.25,-2305.51 7536.25,-2305.51"/>
<polygon fill="black" stroke="black" points="7539.75,-2305.51 7536.25,-2295.51 7532.75,-2305.51 7539.75,-2305.51"/>
</g>
<!-- residual_0&#45;&gt;layernorm_0 -->
<g id="edge86" class="edge">
<title>residual_0&#45;&gt;layernorm_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7702,-2227.26C7702,-2227.26 7702,-2140.55 7702,-2140.55"/>
<polygon fill="black" stroke="black" points="7705.5,-2140.55 7702,-2130.55 7698.5,-2140.55 7705.5,-2140.55"/>
<text text-anchor="middle" x="7733" y="-2184.19" font-family="Times,serif" font-size="14.00">Residual</text>
</g>
<!-- ffn_split_0 -->
<g id="node57" class="node">
<title>ffn_split_0</title>
<polygon fill="#ffe4b5" stroke="black" points="9730.12,-3260.51 9009.31,-3260.51 8823.88,-3124.51 9544.69,-3124.51 9730.12,-3260.51"/>
<text text-anchor="middle" x="9277" y="-3211.31" font-family="monospace" font-size="14.00">Split FFN Input (TP=8)</text>
<text text-anchor="middle" x="9277" y="-3196.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="9277" y="-3181.31" font-family="monospace" font-size="14.00">Output: 8Ã—[batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="9277" y="-3166.31" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- residual_0&#45;&gt;ffn_split_0 -->
<g id="edge87" class="edge">
<title>residual_0&#45;&gt;ffn_split_0</title>
<path fill="none" stroke="black" d="M7687.75,-2295.49C7687.75,-2458.28 7687.75,-3150 7687.75,-3150 7687.75,-3150 8848.4,-3150 8848.4,-3150"/>
<polygon fill="black" stroke="black" points="8848.4,-3153.5 8858.4,-3150 8848.4,-3146.5 8848.4,-3153.5"/>
</g>
<!-- ffn_linear1_0 -->
<g id="node58" class="node">
<title>ffn_linear1_0</title>
<polygon fill="#98fb98" stroke="black" points="8150.5,-3087.51 7721.5,-3087.51 7721.5,-3019.51 8150.5,-3019.51 8150.5,-3087.51"/>
<text text-anchor="middle" x="7936" y="-3072.31" font-family="monospace" font-size="14.00">FFN Linear1 GPU0</text>
<text text-anchor="middle" x="7936" y="-3057.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="7936" y="-3042.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="7936" y="-3027.31" font-family="monospace" font-size="14.00">GPU: gpu_0</text>
</g>
<!-- ffn_split_0&#45;&gt;ffn_linear1_0 -->
<g id="edge88" class="edge">
<title>ffn_split_0&#45;&gt;ffn_linear1_0</title>
<path fill="none" stroke="black" d="M8846.24,-3141C8454.11,-3141 7936,-3141 7936,-3141 7936,-3141 7936,-3097.58 7936,-3097.58"/>
<polygon fill="black" stroke="black" points="7939.5,-3097.58 7936,-3087.58 7932.5,-3097.58 7939.5,-3097.58"/>
</g>
<!-- ffn_linear1_1 -->
<g id="node59" class="node">
<title>ffn_linear1_1</title>
<polygon fill="#98fb98" stroke="black" points="8597.5,-3087.51 8168.5,-3087.51 8168.5,-3019.51 8597.5,-3019.51 8597.5,-3087.51"/>
<text text-anchor="middle" x="8383" y="-3072.31" font-family="monospace" font-size="14.00">FFN Linear1 GPU1</text>
<text text-anchor="middle" x="8383" y="-3057.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="8383" y="-3042.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="8383" y="-3027.31" font-family="monospace" font-size="14.00">GPU: gpu_1</text>
</g>
<!-- ffn_split_0&#45;&gt;ffn_linear1_1 -->
<g id="edge89" class="edge">
<title>ffn_split_0&#45;&gt;ffn_linear1_1</title>
<path fill="none" stroke="black" d="M8835.24,-3133C8610.01,-3133 8383,-3133 8383,-3133 8383,-3133 8383,-3097.68 8383,-3097.68"/>
<polygon fill="black" stroke="black" points="8386.5,-3097.68 8383,-3087.68 8379.5,-3097.68 8386.5,-3097.68"/>
</g>
<!-- ffn_linear1_2 -->
<g id="node60" class="node">
<title>ffn_linear1_2</title>
<polygon fill="#98fb98" stroke="black" points="9044.5,-3087.51 8615.5,-3087.51 8615.5,-3019.51 9044.5,-3019.51 9044.5,-3087.51"/>
<text text-anchor="middle" x="8830" y="-3072.31" font-family="monospace" font-size="14.00">FFN Linear1 GPU2</text>
<text text-anchor="middle" x="8830" y="-3057.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="8830" y="-3042.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="8830" y="-3027.31" font-family="monospace" font-size="14.00">GPU: gpu_2</text>
</g>
<!-- ffn_split_0&#45;&gt;ffn_linear1_2 -->
<g id="edge90" class="edge">
<title>ffn_split_0&#45;&gt;ffn_linear1_2</title>
<path fill="none" stroke="black" d="M8934.22,-3124.23C8934.22,-3124.23 8934.22,-3097.84 8934.22,-3097.84"/>
<polygon fill="black" stroke="black" points="8937.72,-3097.84 8934.22,-3087.84 8930.72,-3097.84 8937.72,-3097.84"/>
</g>
<!-- ffn_linear1_3 -->
<g id="node61" class="node">
<title>ffn_linear1_3</title>
<polygon fill="#98fb98" stroke="black" points="9491.5,-3087.51 9062.5,-3087.51 9062.5,-3019.51 9491.5,-3019.51 9491.5,-3087.51"/>
<text text-anchor="middle" x="9277" y="-3072.31" font-family="monospace" font-size="14.00">FFN Linear1 GPU3</text>
<text text-anchor="middle" x="9277" y="-3057.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="9277" y="-3042.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="9277" y="-3027.31" font-family="monospace" font-size="14.00">GPU: gpu_3</text>
</g>
<!-- ffn_split_0&#45;&gt;ffn_linear1_3 -->
<g id="edge91" class="edge">
<title>ffn_split_0&#45;&gt;ffn_linear1_3</title>
<path fill="none" stroke="black" d="M9277,-3124.23C9277,-3124.23 9277,-3097.84 9277,-3097.84"/>
<polygon fill="black" stroke="black" points="9280.5,-3097.84 9277,-3087.84 9273.5,-3097.84 9280.5,-3097.84"/>
</g>
<!-- ffn_linear1_4 -->
<g id="node62" class="node">
<title>ffn_linear1_4</title>
<polygon fill="#98fb98" stroke="black" points="9938.5,-3087.51 9509.5,-3087.51 9509.5,-3019.51 9938.5,-3019.51 9938.5,-3087.51"/>
<text text-anchor="middle" x="9724" y="-3072.31" font-family="monospace" font-size="14.00">FFN Linear1 GPU4</text>
<text text-anchor="middle" x="9724" y="-3057.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="9724" y="-3042.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="9724" y="-3027.31" font-family="monospace" font-size="14.00">GPU: gpu_4</text>
</g>
<!-- ffn_split_0&#45;&gt;ffn_linear1_4 -->
<g id="edge92" class="edge">
<title>ffn_split_0&#45;&gt;ffn_linear1_4</title>
<path fill="none" stroke="black" d="M9619.78,-3179.43C9619.78,-3179.43 9619.78,-3097.64 9619.78,-3097.64"/>
<polygon fill="black" stroke="black" points="9623.28,-3097.64 9619.78,-3087.64 9616.28,-3097.64 9623.28,-3097.64"/>
</g>
<!-- ffn_linear1_5 -->
<g id="node63" class="node">
<title>ffn_linear1_5</title>
<polygon fill="#98fb98" stroke="black" points="10385.5,-3087.51 9956.5,-3087.51 9956.5,-3019.51 10385.5,-3019.51 10385.5,-3087.51"/>
<text text-anchor="middle" x="10171" y="-3072.31" font-family="monospace" font-size="14.00">FFN Linear1 GPU5</text>
<text text-anchor="middle" x="10171" y="-3057.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="10171" y="-3042.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="10171" y="-3027.31" font-family="monospace" font-size="14.00">GPU: gpu_5</text>
</g>
<!-- ffn_split_0&#45;&gt;ffn_linear1_5 -->
<g id="edge93" class="edge">
<title>ffn_split_0&#45;&gt;ffn_linear1_5</title>
<path fill="none" stroke="black" d="M9590.62,-3158C9848.27,-3158 10171,-3158 10171,-3158 10171,-3158 10171,-3097.72 10171,-3097.72"/>
<polygon fill="black" stroke="black" points="10174.5,-3097.72 10171,-3087.72 10167.5,-3097.72 10174.5,-3097.72"/>
</g>
<!-- ffn_linear1_6 -->
<g id="node64" class="node">
<title>ffn_linear1_6</title>
<polygon fill="#98fb98" stroke="black" points="10832.5,-3087.51 10403.5,-3087.51 10403.5,-3019.51 10832.5,-3019.51 10832.5,-3087.51"/>
<text text-anchor="middle" x="10618" y="-3072.31" font-family="monospace" font-size="14.00">FFN Linear1 GPU6</text>
<text text-anchor="middle" x="10618" y="-3057.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="10618" y="-3042.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="10618" y="-3027.31" font-family="monospace" font-size="14.00">GPU: gpu_6</text>
</g>
<!-- ffn_split_0&#45;&gt;ffn_linear1_6 -->
<g id="edge94" class="edge">
<title>ffn_split_0&#45;&gt;ffn_linear1_6</title>
<path fill="none" stroke="black" d="M9636.8,-3192C10034.02,-3192 10618,-3192 10618,-3192 10618,-3192 10618,-3097.74 10618,-3097.74"/>
<polygon fill="black" stroke="black" points="10621.5,-3097.74 10618,-3087.74 10614.5,-3097.74 10621.5,-3097.74"/>
</g>
<!-- ffn_linear1_7 -->
<g id="node65" class="node">
<title>ffn_linear1_7</title>
<polygon fill="#98fb98" stroke="black" points="11279.5,-3087.51 10850.5,-3087.51 10850.5,-3019.51 11279.5,-3019.51 11279.5,-3087.51"/>
<text text-anchor="middle" x="11065" y="-3072.31" font-family="monospace" font-size="14.00">FFN Linear1 GPU7</text>
<text text-anchor="middle" x="11065" y="-3057.31" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="11065" y="-3042.31" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="11065" y="-3027.31" font-family="monospace" font-size="14.00">GPU: gpu_7</text>
</g>
<!-- ffn_split_0&#45;&gt;ffn_linear1_7 -->
<g id="edge95" class="edge">
<title>ffn_split_0&#45;&gt;ffn_linear1_7</title>
<path fill="none" stroke="black" d="M9683.28,-3226C10210.86,-3226 11065,-3226 11065,-3226 11065,-3226 11065,-3097.59 11065,-3097.59"/>
<polygon fill="black" stroke="black" points="11068.5,-3097.59 11065,-3087.59 11061.5,-3097.59 11068.5,-3097.59"/>
</g>
<!-- ffn_gelu_0 -->
<g id="node66" class="node">
<title>ffn_gelu_0</title>
<polygon fill="#87ceeb" stroke="black" points="8150.5,-2979.03 7721.5,-2979.03 7721.5,-2911.03 8150.5,-2911.03 8150.5,-2979.03"/>
<text text-anchor="middle" x="7936" y="-2963.83" font-family="monospace" font-size="14.00">GELU GPU0</text>
<text text-anchor="middle" x="7936" y="-2948.83" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="7936" y="-2933.83" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="7936" y="-2918.83" font-family="monospace" font-size="14.00">GPU: gpu_0</text>
</g>
<!-- ffn_linear1_0&#45;&gt;ffn_gelu_0 -->
<g id="edge96" class="edge">
<title>ffn_linear1_0&#45;&gt;ffn_gelu_0</title>
<path fill="none" stroke="black" d="M7936,-3019.48C7936,-3019.48 7936,-2989.31 7936,-2989.31"/>
<polygon fill="black" stroke="black" points="7939.5,-2989.31 7936,-2979.31 7932.5,-2989.31 7939.5,-2989.31"/>
</g>
<!-- ffn_gelu_1 -->
<g id="node67" class="node">
<title>ffn_gelu_1</title>
<polygon fill="#87ceeb" stroke="black" points="8597.5,-2979.03 8168.5,-2979.03 8168.5,-2911.03 8597.5,-2911.03 8597.5,-2979.03"/>
<text text-anchor="middle" x="8383" y="-2963.83" font-family="monospace" font-size="14.00">GELU GPU1</text>
<text text-anchor="middle" x="8383" y="-2948.83" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="8383" y="-2933.83" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="8383" y="-2918.83" font-family="monospace" font-size="14.00">GPU: gpu_1</text>
</g>
<!-- ffn_linear1_1&#45;&gt;ffn_gelu_1 -->
<g id="edge98" class="edge">
<title>ffn_linear1_1&#45;&gt;ffn_gelu_1</title>
<path fill="none" stroke="black" d="M8383,-3019.48C8383,-3019.48 8383,-2989.31 8383,-2989.31"/>
<polygon fill="black" stroke="black" points="8386.5,-2989.31 8383,-2979.31 8379.5,-2989.31 8386.5,-2989.31"/>
</g>
<!-- ffn_gelu_2 -->
<g id="node68" class="node">
<title>ffn_gelu_2</title>
<polygon fill="#87ceeb" stroke="black" points="9044.5,-2979.03 8615.5,-2979.03 8615.5,-2911.03 9044.5,-2911.03 9044.5,-2979.03"/>
<text text-anchor="middle" x="8830" y="-2963.83" font-family="monospace" font-size="14.00">GELU GPU2</text>
<text text-anchor="middle" x="8830" y="-2948.83" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="8830" y="-2933.83" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="8830" y="-2918.83" font-family="monospace" font-size="14.00">GPU: gpu_2</text>
</g>
<!-- ffn_linear1_2&#45;&gt;ffn_gelu_2 -->
<g id="edge100" class="edge">
<title>ffn_linear1_2&#45;&gt;ffn_gelu_2</title>
<path fill="none" stroke="black" d="M8830,-3019.48C8830,-3019.48 8830,-2989.31 8830,-2989.31"/>
<polygon fill="black" stroke="black" points="8833.5,-2989.31 8830,-2979.31 8826.5,-2989.31 8833.5,-2989.31"/>
</g>
<!-- ffn_gelu_3 -->
<g id="node69" class="node">
<title>ffn_gelu_3</title>
<polygon fill="#87ceeb" stroke="black" points="9491.5,-2979.03 9062.5,-2979.03 9062.5,-2911.03 9491.5,-2911.03 9491.5,-2979.03"/>
<text text-anchor="middle" x="9277" y="-2963.83" font-family="monospace" font-size="14.00">GELU GPU3</text>
<text text-anchor="middle" x="9277" y="-2948.83" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="9277" y="-2933.83" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="9277" y="-2918.83" font-family="monospace" font-size="14.00">GPU: gpu_3</text>
</g>
<!-- ffn_linear1_3&#45;&gt;ffn_gelu_3 -->
<g id="edge102" class="edge">
<title>ffn_linear1_3&#45;&gt;ffn_gelu_3</title>
<path fill="none" stroke="black" d="M9277,-3019.48C9277,-3019.48 9277,-2989.31 9277,-2989.31"/>
<polygon fill="black" stroke="black" points="9280.5,-2989.31 9277,-2979.31 9273.5,-2989.31 9280.5,-2989.31"/>
</g>
<!-- ffn_gelu_4 -->
<g id="node70" class="node">
<title>ffn_gelu_4</title>
<polygon fill="#87ceeb" stroke="black" points="9938.5,-2979.03 9509.5,-2979.03 9509.5,-2911.03 9938.5,-2911.03 9938.5,-2979.03"/>
<text text-anchor="middle" x="9724" y="-2963.83" font-family="monospace" font-size="14.00">GELU GPU4</text>
<text text-anchor="middle" x="9724" y="-2948.83" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="9724" y="-2933.83" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="9724" y="-2918.83" font-family="monospace" font-size="14.00">GPU: gpu_4</text>
</g>
<!-- ffn_linear1_4&#45;&gt;ffn_gelu_4 -->
<g id="edge104" class="edge">
<title>ffn_linear1_4&#45;&gt;ffn_gelu_4</title>
<path fill="none" stroke="black" d="M9724,-3019.48C9724,-3019.48 9724,-2989.31 9724,-2989.31"/>
<polygon fill="black" stroke="black" points="9727.5,-2989.31 9724,-2979.31 9720.5,-2989.31 9727.5,-2989.31"/>
</g>
<!-- ffn_gelu_5 -->
<g id="node71" class="node">
<title>ffn_gelu_5</title>
<polygon fill="#87ceeb" stroke="black" points="10385.5,-2979.03 9956.5,-2979.03 9956.5,-2911.03 10385.5,-2911.03 10385.5,-2979.03"/>
<text text-anchor="middle" x="10171" y="-2963.83" font-family="monospace" font-size="14.00">GELU GPU5</text>
<text text-anchor="middle" x="10171" y="-2948.83" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="10171" y="-2933.83" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="10171" y="-2918.83" font-family="monospace" font-size="14.00">GPU: gpu_5</text>
</g>
<!-- ffn_linear1_5&#45;&gt;ffn_gelu_5 -->
<g id="edge106" class="edge">
<title>ffn_linear1_5&#45;&gt;ffn_gelu_5</title>
<path fill="none" stroke="black" d="M10171,-3019.48C10171,-3019.48 10171,-2989.31 10171,-2989.31"/>
<polygon fill="black" stroke="black" points="10174.5,-2989.31 10171,-2979.31 10167.5,-2989.31 10174.5,-2989.31"/>
</g>
<!-- ffn_gelu_6 -->
<g id="node72" class="node">
<title>ffn_gelu_6</title>
<polygon fill="#87ceeb" stroke="black" points="10832.5,-2979.03 10403.5,-2979.03 10403.5,-2911.03 10832.5,-2911.03 10832.5,-2979.03"/>
<text text-anchor="middle" x="10618" y="-2963.83" font-family="monospace" font-size="14.00">GELU GPU6</text>
<text text-anchor="middle" x="10618" y="-2948.83" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="10618" y="-2933.83" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="10618" y="-2918.83" font-family="monospace" font-size="14.00">GPU: gpu_6</text>
</g>
<!-- ffn_linear1_6&#45;&gt;ffn_gelu_6 -->
<g id="edge108" class="edge">
<title>ffn_linear1_6&#45;&gt;ffn_gelu_6</title>
<path fill="none" stroke="black" d="M10618,-3019.48C10618,-3019.48 10618,-2989.31 10618,-2989.31"/>
<polygon fill="black" stroke="black" points="10621.5,-2989.31 10618,-2979.31 10614.5,-2989.31 10621.5,-2989.31"/>
</g>
<!-- ffn_gelu_7 -->
<g id="node73" class="node">
<title>ffn_gelu_7</title>
<polygon fill="#87ceeb" stroke="black" points="11279.5,-2979.03 10850.5,-2979.03 10850.5,-2911.03 11279.5,-2911.03 11279.5,-2979.03"/>
<text text-anchor="middle" x="11065" y="-2963.83" font-family="monospace" font-size="14.00">GELU GPU7</text>
<text text-anchor="middle" x="11065" y="-2948.83" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="11065" y="-2933.83" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="11065" y="-2918.83" font-family="monospace" font-size="14.00">GPU: gpu_7</text>
</g>
<!-- ffn_linear1_7&#45;&gt;ffn_gelu_7 -->
<g id="edge110" class="edge">
<title>ffn_linear1_7&#45;&gt;ffn_gelu_7</title>
<path fill="none" stroke="black" d="M11065,-3019.48C11065,-3019.48 11065,-2989.31 11065,-2989.31"/>
<polygon fill="black" stroke="black" points="11068.5,-2989.31 11065,-2979.31 11061.5,-2989.31 11068.5,-2989.31"/>
</g>
<!-- ffn_linear2_0 -->
<g id="node74" class="node">
<title>ffn_linear2_0</title>
<polygon fill="#98fb98" stroke="black" points="8157.5,-2808.55 7736.5,-2808.55 7736.5,-2740.55 8157.5,-2740.55 8157.5,-2808.55"/>
<text text-anchor="middle" x="7947" y="-2793.35" font-family="monospace" font-size="14.00">FFN Linear2 GPU0</text>
<text text-anchor="middle" x="7947" y="-2778.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="7947" y="-2763.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="7947" y="-2748.35" font-family="monospace" font-size="14.00">GPU: gpu_0</text>
</g>
<!-- ffn_gelu_0&#45;&gt;ffn_linear2_0 -->
<g id="edge97" class="edge">
<title>ffn_gelu_0&#45;&gt;ffn_linear2_0</title>
<path fill="none" stroke="black" d="M7943.5,-2910.94C7943.5,-2910.94 7943.5,-2818.58 7943.5,-2818.58"/>
<polygon fill="black" stroke="black" points="7947,-2818.58 7943.5,-2808.58 7940,-2818.58 7947,-2818.58"/>
</g>
<!-- ffn_linear2_1 -->
<g id="node75" class="node">
<title>ffn_linear2_1</title>
<polygon fill="#98fb98" stroke="black" points="8604.5,-2808.55 8183.5,-2808.55 8183.5,-2740.55 8604.5,-2740.55 8604.5,-2808.55"/>
<text text-anchor="middle" x="8394" y="-2793.35" font-family="monospace" font-size="14.00">FFN Linear2 GPU1</text>
<text text-anchor="middle" x="8394" y="-2778.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="8394" y="-2763.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="8394" y="-2748.35" font-family="monospace" font-size="14.00">GPU: gpu_1</text>
</g>
<!-- ffn_gelu_1&#45;&gt;ffn_linear2_1 -->
<g id="edge99" class="edge">
<title>ffn_gelu_1&#45;&gt;ffn_linear2_1</title>
<path fill="none" stroke="black" d="M8390.5,-2910.94C8390.5,-2910.94 8390.5,-2818.58 8390.5,-2818.58"/>
<polygon fill="black" stroke="black" points="8394,-2818.58 8390.5,-2808.58 8387,-2818.58 8394,-2818.58"/>
</g>
<!-- ffn_linear2_2 -->
<g id="node76" class="node">
<title>ffn_linear2_2</title>
<polygon fill="#98fb98" stroke="black" points="9047.5,-2808.55 8626.5,-2808.55 8626.5,-2740.55 9047.5,-2740.55 9047.5,-2808.55"/>
<text text-anchor="middle" x="8837" y="-2793.35" font-family="monospace" font-size="14.00">FFN Linear2 GPU2</text>
<text text-anchor="middle" x="8837" y="-2778.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="8837" y="-2763.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="8837" y="-2748.35" font-family="monospace" font-size="14.00">GPU: gpu_2</text>
</g>
<!-- ffn_gelu_2&#45;&gt;ffn_linear2_2 -->
<g id="edge101" class="edge">
<title>ffn_gelu_2&#45;&gt;ffn_linear2_2</title>
<path fill="none" stroke="black" d="M8835.5,-2910.94C8835.5,-2910.94 8835.5,-2818.58 8835.5,-2818.58"/>
<polygon fill="black" stroke="black" points="8839,-2818.58 8835.5,-2808.58 8832,-2818.58 8839,-2818.58"/>
</g>
<!-- ffn_linear2_3 -->
<g id="node77" class="node">
<title>ffn_linear2_3</title>
<polygon fill="#98fb98" stroke="black" points="9488.5,-2808.55 9067.5,-2808.55 9067.5,-2740.55 9488.5,-2740.55 9488.5,-2808.55"/>
<text text-anchor="middle" x="9278" y="-2793.35" font-family="monospace" font-size="14.00">FFN Linear2 GPU3</text>
<text text-anchor="middle" x="9278" y="-2778.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="9278" y="-2763.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="9278" y="-2748.35" font-family="monospace" font-size="14.00">GPU: gpu_3</text>
</g>
<!-- ffn_gelu_3&#45;&gt;ffn_linear2_3 -->
<g id="edge103" class="edge">
<title>ffn_gelu_3&#45;&gt;ffn_linear2_3</title>
<path fill="none" stroke="black" d="M9278,-2910.94C9278,-2910.94 9278,-2818.58 9278,-2818.58"/>
<polygon fill="black" stroke="black" points="9281.5,-2818.58 9278,-2808.58 9274.5,-2818.58 9281.5,-2818.58"/>
</g>
<!-- ffn_linear2_4 -->
<g id="node78" class="node">
<title>ffn_linear2_4</title>
<polygon fill="#98fb98" stroke="black" points="9931.5,-2808.55 9510.5,-2808.55 9510.5,-2740.55 9931.5,-2740.55 9931.5,-2808.55"/>
<text text-anchor="middle" x="9721" y="-2793.35" font-family="monospace" font-size="14.00">FFN Linear2 GPU4</text>
<text text-anchor="middle" x="9721" y="-2778.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="9721" y="-2763.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="9721" y="-2748.35" font-family="monospace" font-size="14.00">GPU: gpu_4</text>
</g>
<!-- ffn_gelu_4&#45;&gt;ffn_linear2_4 -->
<g id="edge105" class="edge">
<title>ffn_gelu_4&#45;&gt;ffn_linear2_4</title>
<path fill="none" stroke="black" d="M9721,-2910.94C9721,-2910.94 9721,-2818.58 9721,-2818.58"/>
<polygon fill="black" stroke="black" points="9724.5,-2818.58 9721,-2808.58 9717.5,-2818.58 9724.5,-2818.58"/>
</g>
<!-- ffn_linear2_5 -->
<g id="node79" class="node">
<title>ffn_linear2_5</title>
<polygon fill="#98fb98" stroke="black" points="10374.5,-2808.55 9953.5,-2808.55 9953.5,-2740.55 10374.5,-2740.55 10374.5,-2808.55"/>
<text text-anchor="middle" x="10164" y="-2793.35" font-family="monospace" font-size="14.00">FFN Linear2 GPU5</text>
<text text-anchor="middle" x="10164" y="-2778.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="10164" y="-2763.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="10164" y="-2748.35" font-family="monospace" font-size="14.00">GPU: gpu_5</text>
</g>
<!-- ffn_gelu_5&#45;&gt;ffn_linear2_5 -->
<g id="edge107" class="edge">
<title>ffn_gelu_5&#45;&gt;ffn_linear2_5</title>
<path fill="none" stroke="black" d="M10165.5,-2910.94C10165.5,-2910.94 10165.5,-2818.58 10165.5,-2818.58"/>
<polygon fill="black" stroke="black" points="10169,-2818.58 10165.5,-2808.58 10162,-2818.58 10169,-2818.58"/>
</g>
<!-- ffn_linear2_6 -->
<g id="node80" class="node">
<title>ffn_linear2_6</title>
<polygon fill="#98fb98" stroke="black" points="10819.5,-2808.55 10398.5,-2808.55 10398.5,-2740.55 10819.5,-2740.55 10819.5,-2808.55"/>
<text text-anchor="middle" x="10609" y="-2793.35" font-family="monospace" font-size="14.00">FFN Linear2 GPU6</text>
<text text-anchor="middle" x="10609" y="-2778.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="10609" y="-2763.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="10609" y="-2748.35" font-family="monospace" font-size="14.00">GPU: gpu_6</text>
</g>
<!-- ffn_gelu_6&#45;&gt;ffn_linear2_6 -->
<g id="edge109" class="edge">
<title>ffn_gelu_6&#45;&gt;ffn_linear2_6</title>
<path fill="none" stroke="black" d="M10611.5,-2910.94C10611.5,-2910.94 10611.5,-2818.58 10611.5,-2818.58"/>
<polygon fill="black" stroke="black" points="10615,-2818.58 10611.5,-2808.58 10608,-2818.58 10615,-2818.58"/>
</g>
<!-- ffn_linear2_7 -->
<g id="node81" class="node">
<title>ffn_linear2_7</title>
<polygon fill="#98fb98" stroke="black" points="11265.5,-2808.55 10844.5,-2808.55 10844.5,-2740.55 11265.5,-2740.55 11265.5,-2808.55"/>
<text text-anchor="middle" x="11055" y="-2793.35" font-family="monospace" font-size="14.00">FFN Linear2 GPU7</text>
<text text-anchor="middle" x="11055" y="-2778.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="11055" y="-2763.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="11055" y="-2748.35" font-family="monospace" font-size="14.00">GPU: gpu_7</text>
</g>
<!-- ffn_gelu_7&#45;&gt;ffn_linear2_7 -->
<g id="edge111" class="edge">
<title>ffn_gelu_7&#45;&gt;ffn_linear2_7</title>
<path fill="none" stroke="black" d="M11058,-2910.94C11058,-2910.94 11058,-2818.58 11058,-2818.58"/>
<polygon fill="black" stroke="black" points="11061.5,-2818.58 11058,-2808.58 11054.5,-2818.58 11061.5,-2818.58"/>
</g>
<!-- ffn_reduce_0 -->
<g id="node82" class="node">
<title>ffn_reduce_0</title>
<polygon fill="#ffe4b5" stroke="black" points="9944.53,-2669.55 9237.38,-2669.55 9055.47,-2533.55 9762.62,-2533.55 9944.53,-2669.55"/>
<text text-anchor="middle" x="9500" y="-2620.35" font-family="monospace" font-size="14.00">All&#45;Reduce Sum (TP=8)</text>
<text text-anchor="middle" x="9500" y="-2605.35" font-family="monospace" font-size="14.00">Input: 8Ã—[batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="9500" y="-2590.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="9500" y="-2575.35" font-family="monospace" font-size="14.00">GPU: All</text>
</g>
<!-- ffn_linear2_0&#45;&gt;ffn_reduce_0 -->
<g id="edge112" class="edge">
<title>ffn_linear2_0&#45;&gt;ffn_reduce_0</title>
<path fill="none" stroke="black" d="M8037,-2740.44C8037,-2702.36 8037,-2646 8037,-2646 8037,-2646 9195.7,-2646 9195.7,-2646"/>
<polygon fill="black" stroke="black" points="9195.7,-2649.5 9205.7,-2646 9195.7,-2642.5 9195.7,-2649.5"/>
</g>
<!-- ffn_linear2_1&#45;&gt;ffn_reduce_0 -->
<g id="edge113" class="edge">
<title>ffn_linear2_1&#45;&gt;ffn_reduce_0</title>
<path fill="none" stroke="black" d="M8394,-2740.53C8394,-2706.13 8394,-2658 8394,-2658 8394,-2658 9211.62,-2658 9211.62,-2658"/>
<polygon fill="black" stroke="black" points="9211.62,-2661.5 9221.62,-2658 9211.62,-2654.5 9211.62,-2661.5"/>
</g>
<!-- ffn_linear2_2&#45;&gt;ffn_reduce_0 -->
<g id="edge114" class="edge">
<title>ffn_linear2_2&#45;&gt;ffn_reduce_0</title>
<path fill="none" stroke="black" d="M9047.56,-2774C9054.72,-2774 9058.87,-2774 9058.87,-2774 9058.87,-2774 9058.87,-2611.68 9058.87,-2611.68"/>
<polygon fill="black" stroke="black" points="9062.37,-2611.68 9058.87,-2601.68 9055.37,-2611.68 9062.37,-2611.68"/>
</g>
<!-- ffn_linear2_3&#45;&gt;ffn_reduce_0 -->
<g id="edge115" class="edge">
<title>ffn_linear2_3&#45;&gt;ffn_reduce_0</title>
<path fill="none" stroke="black" d="M9278,-2740.37C9278,-2740.37 9278,-2679.66 9278,-2679.66"/>
<polygon fill="black" stroke="black" points="9281.5,-2679.66 9278,-2669.66 9274.5,-2679.66 9281.5,-2679.66"/>
</g>
<!-- ffn_linear2_4&#45;&gt;ffn_reduce_0 -->
<g id="edge116" class="edge">
<title>ffn_linear2_4&#45;&gt;ffn_reduce_0</title>
<path fill="none" stroke="black" d="M9721,-2740.37C9721,-2740.37 9721,-2679.66 9721,-2679.66"/>
<polygon fill="black" stroke="black" points="9724.5,-2679.66 9721,-2669.66 9717.5,-2679.66 9724.5,-2679.66"/>
</g>
<!-- ffn_linear2_5&#45;&gt;ffn_reduce_0 -->
<g id="edge117" class="edge">
<title>ffn_linear2_5&#45;&gt;ffn_reduce_0</title>
<path fill="none" stroke="black" d="M9953.35,-2774C9941.92,-2774 9935,-2774 9935,-2774 9935,-2774 9935,-2611.68 9935,-2611.68"/>
<polygon fill="black" stroke="black" points="9938.5,-2611.68 9935,-2601.68 9931.5,-2611.68 9938.5,-2611.68"/>
</g>
<!-- ffn_linear2_6&#45;&gt;ffn_reduce_0 -->
<g id="edge118" class="edge">
<title>ffn_linear2_6&#45;&gt;ffn_reduce_0</title>
<path fill="none" stroke="black" d="M10543.17,-2740.39C10543.17,-2695.97 10543.17,-2624 10543.17,-2624 10543.17,-2624 9893.62,-2624 9893.62,-2624"/>
<polygon fill="black" stroke="black" points="9893.62,-2620.5 9883.62,-2624 9893.62,-2627.5 9893.62,-2620.5"/>
</g>
<!-- ffn_linear2_7&#45;&gt;ffn_reduce_0 -->
<g id="edge119" class="edge">
<title>ffn_linear2_7&#45;&gt;ffn_reduce_0</title>
<path fill="none" stroke="black" d="M10911.83,-2740.32C10911.83,-2684 10911.83,-2578 10911.83,-2578 10911.83,-2578 9832.13,-2578 9832.13,-2578"/>
<polygon fill="black" stroke="black" points="9832.13,-2574.5 9822.13,-2578 9832.13,-2581.5 9832.13,-2574.5"/>
</g>
<!-- residual_0_ffn -->
<g id="node83" class="node">
<title>residual_0_ffn</title>
<polygon fill="#dda0dd" stroke="black" points="9714.5,-2462.55 9285.5,-2462.55 9285.5,-2394.55 9714.5,-2394.55 9714.5,-2462.55"/>
<text text-anchor="middle" x="9500" y="-2447.35" font-family="monospace" font-size="14.00">Residual Add 0</text>
<text text-anchor="middle" x="9500" y="-2432.35" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="9500" y="-2417.35" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="9500" y="-2402.35" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ffn_reduce_0&#45;&gt;residual_0_ffn -->
<g id="edge120" class="edge">
<title>ffn_reduce_0&#45;&gt;residual_0_ffn</title>
<path fill="none" stroke="black" d="M9500,-2533.18C9500,-2533.18 9500,-2472.73 9500,-2472.73"/>
<polygon fill="black" stroke="black" points="9503.5,-2472.73 9500,-2462.73 9496.5,-2472.73 9503.5,-2472.73"/>
</g>
<!-- residual_0_ffn&#45;&gt;residual_0 -->
<g id="edge121" class="edge">
<title>residual_0_ffn&#45;&gt;residual_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9285.5,-2428C8833.93,-2428 7826.5,-2428 7826.5,-2428 7826.5,-2428 7826.5,-2305.57 7826.5,-2305.57"/>
<polygon fill="black" stroke="black" points="7830,-2305.57 7826.5,-2295.57 7823,-2305.57 7830,-2305.57"/>
<text text-anchor="middle" x="8644" y="-2331.35" font-family="Times,serif" font-size="14.00">Residual</text>
</g>
<!-- pipeline_comm_0 -->
<g id="node84" class="node">
<title>pipeline_comm_0</title>
<ellipse fill="#ffd700" stroke="black" cx="11743" cy="-2261.47" rx="303.2" ry="48.17"/>
<text text-anchor="middle" x="11743" y="-2280.27" font-family="monospace" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="11743" y="-2265.27" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="11743" y="-2250.27" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="11743" y="-2235.27" font-family="monospace" font-size="14.00">GPU: 0&#45;7 â†’ 8&#45;15</text>
</g>
<!-- residual_0_ffn&#45;&gt;pipeline_comm_0 -->
<g id="edge122" class="edge">
<title>residual_0_ffn&#45;&gt;pipeline_comm_0</title>
<path fill="none" stroke="black" d="M9500,-2394.31C9500,-2356.83 9500,-2302 9500,-2302 9500,-2302 11569.43,-2302 11569.43,-2302"/>
<polygon fill="black" stroke="black" points="11569.43,-2305.5 11579.43,-2302 11569.43,-2298.5 11569.43,-2305.5"/>
</g>
<!-- layernorm_1 -->
<g id="node85" class="node">
<title>layernorm_1</title>
<polygon fill="#dda0dd" stroke="black" points="12079.5,-2130.39 11650.5,-2130.39 11650.5,-2062.39 12079.5,-2062.39 12079.5,-2130.39"/>
<text text-anchor="middle" x="11865" y="-2115.19" font-family="monospace" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="11865" y="-2100.19" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="11865" y="-2085.19" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="11865" y="-2070.19" font-family="monospace" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- pipeline_comm_0&#45;&gt;layernorm_1 -->
<g id="edge123" class="edge">
<title>pipeline_comm_0&#45;&gt;layernorm_1</title>
<path fill="none" stroke="black" d="M11848.42,-2216.36C11848.42,-2216.36 11848.42,-2140.44 11848.42,-2140.44"/>
<polygon fill="black" stroke="black" points="11851.92,-2140.44 11848.42,-2130.44 11844.92,-2140.44 11851.92,-2140.44"/>
</g>
<!-- attn_1_result -->
<g id="node87" class="node">
<title>attn_1_result</title>
<polygon fill="#ffd700" stroke="black" points="11993,-2021.39 11737,-2021.39 11737,-1983.39 11993,-1983.39 11993,-2021.39"/>
<text text-anchor="middle" x="11865" y="-2006.19" font-family="monospace" font-size="14.00">Multi&#45;Head Attention 1 (TP=8)</text>
<text text-anchor="middle" x="11865" y="-1991.19" font-family="monospace" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layernorm_1&#45;&gt;attn_1_result -->
<g id="edge124" class="edge">
<title>layernorm_1&#45;&gt;attn_1_result</title>
<path fill="none" stroke="black" d="M11865,-2062.18C11865,-2062.18 11865,-2031.4 11865,-2031.4"/>
<polygon fill="black" stroke="black" points="11868.5,-2031.4 11865,-2021.4 11861.5,-2031.4 11868.5,-2031.4"/>
</g>
<!-- qkv_split_1 -->
<g id="node86" class="node">
<title>qkv_split_1</title>
<polygon fill="#ffe4b5" stroke="black" points="11632.45,-2134.39 11386.75,-2134.39 11323.55,-2058.39 11569.25,-2058.39 11632.45,-2134.39"/>
<text text-anchor="middle" x="11478" y="-2100.19" font-family="monospace" font-size="14.00">Split QKV (TP=8)</text>
<text text-anchor="middle" x="11478" y="-2085.19" font-family="monospace" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- residual_1 -->
<g id="node88" class="node">
<title>residual_1</title>
<polygon fill="#dda0dd" stroke="black" points="11931,-1946.39 11799,-1946.39 11799,-1908.39 11931,-1908.39 11931,-1946.39"/>
<text text-anchor="middle" x="11865" y="-1931.19" font-family="monospace" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="11865" y="-1916.19" font-family="monospace" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- attn_1_result&#45;&gt;residual_1 -->
<g id="edge125" class="edge">
<title>attn_1_result&#45;&gt;residual_1</title>
<path fill="none" stroke="black" d="M11865,-1983.07C11865,-1983.07 11865,-1956.64 11865,-1956.64"/>
<polygon fill="black" stroke="black" points="11868.5,-1956.64 11865,-1946.64 11861.5,-1956.64 11868.5,-1956.64"/>
</g>
<!-- ffn_1_result -->
<g id="node89" class="node">
<title>ffn_1_result</title>
<polygon fill="#98fb98" stroke="black" points="11923,-1871.39 11807,-1871.39 11807,-1833.39 11923,-1833.39 11923,-1871.39"/>
<text text-anchor="middle" x="11865" y="-1856.19" font-family="monospace" font-size="14.00">FFN 1 (TP=8)</text>
<text text-anchor="middle" x="11865" y="-1841.19" font-family="monospace" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- residual_1&#45;&gt;ffn_1_result -->
<g id="edge126" class="edge">
<title>residual_1&#45;&gt;ffn_1_result</title>
<path fill="none" stroke="black" d="M11865,-1908.07C11865,-1908.07 11865,-1881.64 11865,-1881.64"/>
<polygon fill="black" stroke="black" points="11868.5,-1881.64 11865,-1871.64 11861.5,-1881.64 11868.5,-1881.64"/>
</g>
<!-- residual_1_ffn -->
<g id="node90" class="node">
<title>residual_1_ffn</title>
<polygon fill="#dda0dd" stroke="black" points="11931,-1796.39 11799,-1796.39 11799,-1758.39 11931,-1758.39 11931,-1796.39"/>
<text text-anchor="middle" x="11865" y="-1781.19" font-family="monospace" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="11865" y="-1766.19" font-family="monospace" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- ffn_1_result&#45;&gt;residual_1_ffn -->
<g id="edge127" class="edge">
<title>ffn_1_result&#45;&gt;residual_1_ffn</title>
<path fill="none" stroke="black" d="M11865,-1833.07C11865,-1833.07 11865,-1806.64 11865,-1806.64"/>
<polygon fill="black" stroke="black" points="11868.5,-1806.64 11865,-1796.64 11861.5,-1806.64 11868.5,-1806.64"/>
</g>
<!-- pipeline_comm_1 -->
<g id="node91" class="node">
<title>pipeline_comm_1</title>
<ellipse fill="#ffd700" stroke="black" cx="11865" cy="-1694.52" rx="140.01" ry="26.74"/>
<text text-anchor="middle" x="11865" y="-1698.32" font-family="monospace" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="11865" y="-1683.32" font-family="monospace" font-size="14.00">GPU: 8&#45;15 â†’ 0&#45;7</text>
</g>
<!-- residual_1_ffn&#45;&gt;pipeline_comm_1 -->
<g id="edge128" class="edge">
<title>residual_1_ffn&#45;&gt;pipeline_comm_1</title>
<path fill="none" stroke="black" d="M11865,-1758.17C11865,-1758.17 11865,-1731.48 11865,-1731.48"/>
<polygon fill="black" stroke="black" points="11868.5,-1731.48 11865,-1721.48 11861.5,-1731.48 11868.5,-1731.48"/>
</g>
<!-- layernorm_2 -->
<g id="node92" class="node">
<title>layernorm_2</title>
<polygon fill="#dda0dd" stroke="black" points="11918.5,-1602.65 11811.5,-1602.65 11811.5,-1564.65 11918.5,-1564.65 11918.5,-1602.65"/>
<text text-anchor="middle" x="11865" y="-1587.45" font-family="monospace" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="11865" y="-1572.45" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- pipeline_comm_1&#45;&gt;layernorm_2 -->
<g id="edge129" class="edge">
<title>pipeline_comm_1&#45;&gt;layernorm_2</title>
<path fill="none" stroke="black" d="M11865,-1667.39C11865,-1667.39 11865,-1612.84 11865,-1612.84"/>
<polygon fill="black" stroke="black" points="11868.5,-1612.84 11865,-1602.84 11861.5,-1612.84 11868.5,-1612.84"/>
</g>
<!-- attn_2_result -->
<g id="node93" class="node">
<title>attn_2_result</title>
<polygon fill="#ffd700" stroke="black" points="11993,-1527.65 11737,-1527.65 11737,-1489.65 11993,-1489.65 11993,-1527.65"/>
<text text-anchor="middle" x="11865" y="-1512.45" font-family="monospace" font-size="14.00">Multi&#45;Head Attention 2 (TP=8)</text>
<text text-anchor="middle" x="11865" y="-1497.45" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layernorm_2&#45;&gt;attn_2_result -->
<g id="edge130" class="edge">
<title>layernorm_2&#45;&gt;attn_2_result</title>
<path fill="none" stroke="black" d="M11865,-1564.33C11865,-1564.33 11865,-1537.9 11865,-1537.9"/>
<polygon fill="black" stroke="black" points="11868.5,-1537.9 11865,-1527.9 11861.5,-1537.9 11868.5,-1537.9"/>
</g>
<!-- residual_2 -->
<g id="node94" class="node">
<title>residual_2</title>
<polygon fill="#dda0dd" stroke="black" points="11931,-1452.65 11799,-1452.65 11799,-1414.65 11931,-1414.65 11931,-1452.65"/>
<text text-anchor="middle" x="11865" y="-1437.45" font-family="monospace" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="11865" y="-1422.45" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- attn_2_result&#45;&gt;residual_2 -->
<g id="edge131" class="edge">
<title>attn_2_result&#45;&gt;residual_2</title>
<path fill="none" stroke="black" d="M11865,-1489.33C11865,-1489.33 11865,-1462.9 11865,-1462.9"/>
<polygon fill="black" stroke="black" points="11868.5,-1462.9 11865,-1452.9 11861.5,-1462.9 11868.5,-1462.9"/>
</g>
<!-- ffn_2_result -->
<g id="node95" class="node">
<title>ffn_2_result</title>
<polygon fill="#98fb98" stroke="black" points="11923,-1377.65 11807,-1377.65 11807,-1339.65 11923,-1339.65 11923,-1377.65"/>
<text text-anchor="middle" x="11865" y="-1362.45" font-family="monospace" font-size="14.00">FFN 2 (TP=8)</text>
<text text-anchor="middle" x="11865" y="-1347.45" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- residual_2&#45;&gt;ffn_2_result -->
<g id="edge132" class="edge">
<title>residual_2&#45;&gt;ffn_2_result</title>
<path fill="none" stroke="black" d="M11865,-1414.33C11865,-1414.33 11865,-1387.9 11865,-1387.9"/>
<polygon fill="black" stroke="black" points="11868.5,-1387.9 11865,-1377.9 11861.5,-1387.9 11868.5,-1387.9"/>
</g>
<!-- residual_2_ffn -->
<g id="node96" class="node">
<title>residual_2_ffn</title>
<polygon fill="#dda0dd" stroke="black" points="11931,-1302.65 11799,-1302.65 11799,-1264.65 11931,-1264.65 11931,-1302.65"/>
<text text-anchor="middle" x="11865" y="-1287.45" font-family="monospace" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="11865" y="-1272.45" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ffn_2_result&#45;&gt;residual_2_ffn -->
<g id="edge133" class="edge">
<title>ffn_2_result&#45;&gt;residual_2_ffn</title>
<path fill="none" stroke="black" d="M11865,-1339.33C11865,-1339.33 11865,-1312.9 11865,-1312.9"/>
<polygon fill="black" stroke="black" points="11868.5,-1312.9 11865,-1302.9 11861.5,-1312.9 11868.5,-1312.9"/>
</g>
<!-- pipeline_comm_2 -->
<g id="node97" class="node">
<title>pipeline_comm_2</title>
<ellipse fill="#ffd700" stroke="black" cx="11865" cy="-1200.78" rx="140.01" ry="26.74"/>
<text text-anchor="middle" x="11865" y="-1204.58" font-family="monospace" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="11865" y="-1189.58" font-family="monospace" font-size="14.00">GPU: 0&#45;7 â†’ 8&#45;15</text>
</g>
<!-- residual_2_ffn&#45;&gt;pipeline_comm_2 -->
<g id="edge134" class="edge">
<title>residual_2_ffn&#45;&gt;pipeline_comm_2</title>
<path fill="none" stroke="black" d="M11865,-1264.43C11865,-1264.43 11865,-1237.74 11865,-1237.74"/>
<polygon fill="black" stroke="black" points="11868.5,-1237.74 11865,-1227.74 11861.5,-1237.74 11868.5,-1237.74"/>
</g>
<!-- layernorm_3 -->
<g id="node98" class="node">
<title>layernorm_3</title>
<polygon fill="#dda0dd" stroke="black" points="11918.5,-1108.91 11811.5,-1108.91 11811.5,-1070.91 11918.5,-1070.91 11918.5,-1108.91"/>
<text text-anchor="middle" x="11865" y="-1093.71" font-family="monospace" font-size="14.00">LayerNorm 3</text>
<text text-anchor="middle" x="11865" y="-1078.71" font-family="monospace" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- pipeline_comm_2&#45;&gt;layernorm_3 -->
<g id="edge135" class="edge">
<title>pipeline_comm_2&#45;&gt;layernorm_3</title>
<path fill="none" stroke="black" d="M11865,-1173.65C11865,-1173.65 11865,-1119.1 11865,-1119.1"/>
<polygon fill="black" stroke="black" points="11868.5,-1119.1 11865,-1109.1 11861.5,-1119.1 11868.5,-1119.1"/>
</g>
<!-- attn_3_result -->
<g id="node99" class="node">
<title>attn_3_result</title>
<polygon fill="#ffd700" stroke="black" points="11993,-1033.91 11737,-1033.91 11737,-995.91 11993,-995.91 11993,-1033.91"/>
<text text-anchor="middle" x="11865" y="-1018.71" font-family="monospace" font-size="14.00">Multi&#45;Head Attention 3 (TP=8)</text>
<text text-anchor="middle" x="11865" y="-1003.71" font-family="monospace" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layernorm_3&#45;&gt;attn_3_result -->
<g id="edge136" class="edge">
<title>layernorm_3&#45;&gt;attn_3_result</title>
<path fill="none" stroke="black" d="M11865,-1070.59C11865,-1070.59 11865,-1044.16 11865,-1044.16"/>
<polygon fill="black" stroke="black" points="11868.5,-1044.16 11865,-1034.16 11861.5,-1044.16 11868.5,-1044.16"/>
</g>
<!-- residual_3 -->
<g id="node100" class="node">
<title>residual_3</title>
<polygon fill="#dda0dd" stroke="black" points="11931,-958.91 11799,-958.91 11799,-920.91 11931,-920.91 11931,-958.91"/>
<text text-anchor="middle" x="11865" y="-943.71" font-family="monospace" font-size="14.00">Residual Add 3</text>
<text text-anchor="middle" x="11865" y="-928.71" font-family="monospace" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- attn_3_result&#45;&gt;residual_3 -->
<g id="edge137" class="edge">
<title>attn_3_result&#45;&gt;residual_3</title>
<path fill="none" stroke="black" d="M11865,-995.59C11865,-995.59 11865,-969.16 11865,-969.16"/>
<polygon fill="black" stroke="black" points="11868.5,-969.16 11865,-959.16 11861.5,-969.16 11868.5,-969.16"/>
</g>
<!-- ffn_3_result -->
<g id="node101" class="node">
<title>ffn_3_result</title>
<polygon fill="#98fb98" stroke="black" points="11923,-883.91 11807,-883.91 11807,-845.91 11923,-845.91 11923,-883.91"/>
<text text-anchor="middle" x="11865" y="-868.71" font-family="monospace" font-size="14.00">FFN 3 (TP=8)</text>
<text text-anchor="middle" x="11865" y="-853.71" font-family="monospace" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- residual_3&#45;&gt;ffn_3_result -->
<g id="edge138" class="edge">
<title>residual_3&#45;&gt;ffn_3_result</title>
<path fill="none" stroke="black" d="M11865,-920.59C11865,-920.59 11865,-894.16 11865,-894.16"/>
<polygon fill="black" stroke="black" points="11868.5,-894.16 11865,-884.16 11861.5,-894.16 11868.5,-894.16"/>
</g>
<!-- residual_3_ffn -->
<g id="node102" class="node">
<title>residual_3_ffn</title>
<polygon fill="#dda0dd" stroke="black" points="11931,-808.91 11799,-808.91 11799,-770.91 11931,-770.91 11931,-808.91"/>
<text text-anchor="middle" x="11865" y="-793.71" font-family="monospace" font-size="14.00">Residual Add 3</text>
<text text-anchor="middle" x="11865" y="-778.71" font-family="monospace" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- ffn_3_result&#45;&gt;residual_3_ffn -->
<g id="edge139" class="edge">
<title>ffn_3_result&#45;&gt;residual_3_ffn</title>
<path fill="none" stroke="black" d="M11865,-845.59C11865,-845.59 11865,-819.16 11865,-819.16"/>
<polygon fill="black" stroke="black" points="11868.5,-819.16 11865,-809.16 11861.5,-819.16 11868.5,-819.16"/>
</g>
<!-- pipeline_comm_final -->
<g id="node103" class="node">
<title>pipeline_comm_final</title>
<ellipse fill="#ffd700" stroke="black" cx="11865" cy="-707.04" rx="140.01" ry="26.74"/>
<text text-anchor="middle" x="11865" y="-710.84" font-family="monospace" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="11865" y="-695.84" font-family="monospace" font-size="14.00">GPU: 8&#45;15 â†’ 0&#45;7</text>
</g>
<!-- residual_3_ffn&#45;&gt;pipeline_comm_final -->
<g id="edge140" class="edge">
<title>residual_3_ffn&#45;&gt;pipeline_comm_final</title>
<path fill="none" stroke="black" d="M11865,-770.69C11865,-770.69 11865,-744 11865,-744"/>
<polygon fill="black" stroke="black" points="11868.5,-744 11865,-734 11861.5,-744 11868.5,-744"/>
</g>
<!-- output_split -->
<g id="node104" class="node">
<title>output_split</title>
<polygon fill="#ffe4b5" stroke="black" points="12318.12,-615.17 11597.31,-615.17 11411.88,-479.17 12132.69,-479.17 12318.12,-615.17"/>
<text text-anchor="middle" x="11865" y="-565.97" font-family="monospace" font-size="14.00">Split Output (TP=8)</text>
<text text-anchor="middle" x="11865" y="-550.97" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="11865" y="-535.97" font-family="monospace" font-size="14.00">Output: 8Ã—[batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="11865" y="-520.97" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- pipeline_comm_final&#45;&gt;output_split -->
<g id="edge141" class="edge">
<title>pipeline_comm_final&#45;&gt;output_split</title>
<path fill="none" stroke="black" d="M11865,-679.92C11865,-679.92 11865,-625.47 11865,-625.47"/>
<polygon fill="black" stroke="black" points="11868.5,-625.47 11865,-615.47 11861.5,-625.47 11868.5,-625.47"/>
</g>
<!-- output_0 -->
<g id="node105" class="node">
<title>output_0</title>
<polygon fill="#ffb6c1" stroke="black" points="10615.5,-442.17 10202.5,-442.17 10202.5,-374.17 10615.5,-374.17 10615.5,-442.17"/>
<text text-anchor="middle" x="10409" y="-426.97" font-family="monospace" font-size="14.00">Linear GPU0</text>
<text text-anchor="middle" x="10409" y="-411.97" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="10409" y="-396.97" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab=4000]</text>
<text text-anchor="middle" x="10409" y="-381.97" font-family="monospace" font-size="14.00">GPU: gpu_0</text>
</g>
<!-- output_split&#45;&gt;output_0 -->
<g id="edge142" class="edge">
<title>output_split&#45;&gt;output_0</title>
<path fill="none" stroke="black" d="M11534.16,-569C11121.86,-569 10470.83,-569 10470.83,-569 10470.83,-569 10470.83,-452.28 10470.83,-452.28"/>
<polygon fill="black" stroke="black" points="10474.33,-452.28 10470.83,-442.28 10467.33,-452.28 10474.33,-452.28"/>
</g>
<!-- output_1 -->
<g id="node106" class="node">
<title>output_1</title>
<polygon fill="#ffb6c1" stroke="black" points="11046.5,-442.17 10633.5,-442.17 10633.5,-374.17 11046.5,-374.17 11046.5,-442.17"/>
<text text-anchor="middle" x="10840" y="-426.97" font-family="monospace" font-size="14.00">Linear GPU1</text>
<text text-anchor="middle" x="10840" y="-411.97" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="10840" y="-396.97" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab=4000]</text>
<text text-anchor="middle" x="10840" y="-381.97" font-family="monospace" font-size="14.00">GPU: gpu_1</text>
</g>
<!-- output_split&#45;&gt;output_1 -->
<g id="edge143" class="edge">
<title>output_split&#45;&gt;output_1</title>
<path fill="none" stroke="black" d="M11472.91,-524C11235.88,-524 10979.17,-524 10979.17,-524 10979.17,-524 10979.17,-452.29 10979.17,-452.29"/>
<polygon fill="black" stroke="black" points="10982.67,-452.29 10979.17,-442.29 10975.67,-452.29 10982.67,-452.29"/>
</g>
<!-- output_2 -->
<g id="node107" class="node">
<title>output_2</title>
<polygon fill="#ffb6c1" stroke="black" points="11477.5,-442.17 11064.5,-442.17 11064.5,-374.17 11477.5,-374.17 11477.5,-442.17"/>
<text text-anchor="middle" x="11271" y="-426.97" font-family="monospace" font-size="14.00">Linear GPU2</text>
<text text-anchor="middle" x="11271" y="-411.97" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="11271" y="-396.97" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab=4000]</text>
<text text-anchor="middle" x="11271" y="-381.97" font-family="monospace" font-size="14.00">GPU: gpu_2</text>
</g>
<!-- output_split&#45;&gt;output_2 -->
<g id="edge144" class="edge">
<title>output_split&#45;&gt;output_2</title>
<path fill="none" stroke="black" d="M11444.72,-547.07C11444.72,-547.07 11444.72,-452.3 11444.72,-452.3"/>
<polygon fill="black" stroke="black" points="11448.22,-452.3 11444.72,-442.3 11441.22,-452.3 11448.22,-452.3"/>
</g>
<!-- output_3 -->
<g id="node108" class="node">
<title>output_3</title>
<polygon fill="#ffb6c1" stroke="black" points="11908.5,-442.17 11495.5,-442.17 11495.5,-374.17 11908.5,-374.17 11908.5,-442.17"/>
<text text-anchor="middle" x="11702" y="-426.97" font-family="monospace" font-size="14.00">Linear GPU3</text>
<text text-anchor="middle" x="11702" y="-411.97" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="11702" y="-396.97" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab=4000]</text>
<text text-anchor="middle" x="11702" y="-381.97" font-family="monospace" font-size="14.00">GPU: gpu_3</text>
</g>
<!-- output_split&#45;&gt;output_3 -->
<g id="edge145" class="edge">
<title>output_split&#45;&gt;output_3</title>
<path fill="none" stroke="black" d="M11702,-478.89C11702,-478.89 11702,-452.5 11702,-452.5"/>
<polygon fill="black" stroke="black" points="11705.5,-452.5 11702,-442.5 11698.5,-452.5 11705.5,-452.5"/>
</g>
<!-- output_4 -->
<g id="node109" class="node">
<title>output_4</title>
<polygon fill="#ffb6c1" stroke="black" points="12339.5,-442.17 11926.5,-442.17 11926.5,-374.17 12339.5,-374.17 12339.5,-442.17"/>
<text text-anchor="middle" x="12133" y="-426.97" font-family="monospace" font-size="14.00">Linear GPU4</text>
<text text-anchor="middle" x="12133" y="-411.97" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="12133" y="-396.97" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab=4000]</text>
<text text-anchor="middle" x="12133" y="-381.97" font-family="monospace" font-size="14.00">GPU: gpu_4</text>
</g>
<!-- output_split&#45;&gt;output_4 -->
<g id="edge146" class="edge">
<title>output_split&#45;&gt;output_4</title>
<path fill="none" stroke="black" d="M12122.28,-478.89C12122.28,-478.89 12122.28,-452.5 12122.28,-452.5"/>
<polygon fill="black" stroke="black" points="12125.78,-452.5 12122.28,-442.5 12118.78,-452.5 12125.78,-452.5"/>
</g>
<!-- output_5 -->
<g id="node110" class="node">
<title>output_5</title>
<polygon fill="#ffb6c1" stroke="black" points="12770.5,-442.17 12357.5,-442.17 12357.5,-374.17 12770.5,-374.17 12770.5,-442.17"/>
<text text-anchor="middle" x="12564" y="-426.97" font-family="monospace" font-size="14.00">Linear GPU5</text>
<text text-anchor="middle" x="12564" y="-411.97" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="12564" y="-396.97" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab=4000]</text>
<text text-anchor="middle" x="12564" y="-381.97" font-family="monospace" font-size="14.00">GPU: gpu_5</text>
</g>
<!-- output_split&#45;&gt;output_5 -->
<g id="edge147" class="edge">
<title>output_split&#45;&gt;output_5</title>
<path fill="none" stroke="black" d="M12178.97,-513C12364.72,-513 12564,-513 12564,-513 12564,-513 12564,-452.2 12564,-452.2"/>
<polygon fill="black" stroke="black" points="12567.5,-452.2 12564,-442.2 12560.5,-452.2 12567.5,-452.2"/>
</g>
<!-- output_6 -->
<g id="node111" class="node">
<title>output_6</title>
<polygon fill="#ffb6c1" stroke="black" points="13201.5,-442.17 12788.5,-442.17 12788.5,-374.17 13201.5,-374.17 13201.5,-442.17"/>
<text text-anchor="middle" x="12995" y="-426.97" font-family="monospace" font-size="14.00">Linear GPU6</text>
<text text-anchor="middle" x="12995" y="-411.97" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="12995" y="-396.97" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab=4000]</text>
<text text-anchor="middle" x="12995" y="-381.97" font-family="monospace" font-size="14.00">GPU: gpu_6</text>
</g>
<!-- output_split&#45;&gt;output_6 -->
<g id="edge148" class="edge">
<title>output_split&#45;&gt;output_6</title>
<path fill="none" stroke="black" d="M12225.26,-547C12556,-547 12995,-547 12995,-547 12995,-547 12995,-452.48 12995,-452.48"/>
<polygon fill="black" stroke="black" points="12998.5,-452.48 12995,-442.48 12991.5,-452.48 12998.5,-452.48"/>
</g>
<!-- output_7 -->
<g id="node112" class="node">
<title>output_7</title>
<polygon fill="#ffb6c1" stroke="black" points="13632.5,-442.17 13219.5,-442.17 13219.5,-374.17 13632.5,-374.17 13632.5,-442.17"/>
<text text-anchor="middle" x="13426" y="-426.97" font-family="monospace" font-size="14.00">Linear GPU7</text>
<text text-anchor="middle" x="13426" y="-411.97" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="13426" y="-396.97" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab=4000]</text>
<text text-anchor="middle" x="13426" y="-381.97" font-family="monospace" font-size="14.00">GPU: gpu_7</text>
</g>
<!-- output_split&#45;&gt;output_7 -->
<g id="edge149" class="edge">
<title>output_split&#45;&gt;output_7</title>
<path fill="none" stroke="black" d="M12271.57,-581C12734.08,-581 13426,-581 13426,-581 13426,-581 13426,-452.31 13426,-452.31"/>
<polygon fill="black" stroke="black" points="13429.5,-452.31 13426,-442.31 13422.5,-452.31 13429.5,-452.31"/>
</g>
<!-- output_concat -->
<g id="node113" class="node">
<title>output_concat</title>
<polygon fill="#ffe4b5" stroke="black" points="12353.45,-337.17 11659.16,-337.17 11480.55,-201.17 12174.84,-201.17 12353.45,-337.17"/>
<text text-anchor="middle" x="11917" y="-287.97" font-family="monospace" font-size="14.00">Concat Output (TP=8)</text>
<text text-anchor="middle" x="11917" y="-272.97" font-family="monospace" font-size="14.00">Input: 8Ã—[batch_size=1024, seq_len=?, vocab=4000]</text>
<text text-anchor="middle" x="11917" y="-257.97" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab=32000]</text>
<text text-anchor="middle" x="11917" y="-242.97" font-family="monospace" font-size="14.00">GPU: All</text>
</g>
<!-- output_0&#45;&gt;output_concat -->
<g id="edge150" class="edge">
<title>output_0&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M10409,-373.78C10409,-326.17 10409,-246 10409,-246 10409,-246 11529.39,-246 11529.39,-246"/>
<polygon fill="black" stroke="black" points="11529.39,-249.5 11539.39,-246 11529.39,-242.5 11529.39,-249.5"/>
</g>
<!-- output_1&#45;&gt;output_concat -->
<g id="edge151" class="edge">
<title>output_1&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M10840,-373.96C10840,-339.38 10840,-291 10840,-291 10840,-291 11588.24,-291 11588.24,-291"/>
<polygon fill="black" stroke="black" points="11588.24,-294.5 11598.24,-291 11588.24,-287.5 11588.24,-294.5"/>
</g>
<!-- output_2&#45;&gt;output_concat -->
<g id="edge152" class="edge">
<title>output_2&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M11477.55,-408C11484.19,-408 11488.01,-408 11488.01,-408 11488.01,-408 11488.01,-279.27 11488.01,-279.27"/>
<polygon fill="black" stroke="black" points="11491.51,-279.27 11488.01,-269.27 11484.51,-279.27 11491.51,-279.27"/>
</g>
<!-- output_3&#45;&gt;output_concat -->
<g id="edge153" class="edge">
<title>output_3&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M11702,-374.16C11702,-374.16 11702,-347.36 11702,-347.36"/>
<polygon fill="black" stroke="black" points="11705.5,-347.36 11702,-337.36 11698.5,-347.36 11705.5,-347.36"/>
</g>
<!-- output_4&#45;&gt;output_concat -->
<g id="edge154" class="edge">
<title>output_4&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M12133,-374.16C12133,-374.16 12133,-347.36 12133,-347.36"/>
<polygon fill="black" stroke="black" points="12136.5,-347.36 12133,-337.36 12129.5,-347.36 12136.5,-347.36"/>
</g>
<!-- output_5&#45;&gt;output_concat -->
<g id="edge155" class="edge">
<title>output_5&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M12357.27,-408C12350.44,-408 12346.49,-408 12346.49,-408 12346.49,-408 12346.49,-279.27 12346.49,-279.27"/>
<polygon fill="black" stroke="black" points="12349.99,-279.27 12346.49,-269.27 12342.99,-279.27 12349.99,-279.27"/>
</g>
<!-- output_6&#45;&gt;output_concat -->
<g id="edge156" class="edge">
<title>output_6&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M12995,-373.96C12995,-339.38 12995,-291 12995,-291 12995,-291 12302.9,-291 12302.9,-291"/>
<polygon fill="black" stroke="black" points="12302.9,-287.5 12292.9,-291 12302.9,-294.5 12302.9,-287.5"/>
</g>
<!-- output_7&#45;&gt;output_concat -->
<g id="edge157" class="edge">
<title>output_7&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M13426,-373.78C13426,-326.17 13426,-246 13426,-246 13426,-246 12243.8,-246 12243.8,-246"/>
<polygon fill="black" stroke="black" points="12243.8,-242.5 12233.8,-246 12243.8,-249.5 12243.8,-242.5"/>
</g>
<!-- final_output -->
<g id="node114" class="node">
<title>final_output</title>
<ellipse fill="#e8f4fd" stroke="black" cx="11917" cy="-116.08" rx="297.88" ry="48.17"/>
<text text-anchor="middle" x="11917" y="-134.88" font-family="monospace" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="11917" y="-119.88" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=?, vocab=32000]</text>
<text text-anchor="middle" x="11917" y="-104.88" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab=32000]</text>
<text text-anchor="middle" x="11917" y="-89.88" font-family="monospace" font-size="14.00">GPU: All</text>
</g>
<!-- output_concat&#45;&gt;final_output -->
<g id="edge158" class="edge">
<title>output_concat&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M11917,-201.13C11917,-201.13 11917,-174.19 11917,-174.19"/>
<polygon fill="black" stroke="black" points="11920.5,-174.19 11917,-164.19 11913.5,-174.19 11920.5,-174.19"/>
</g>
</g>
</svg>
