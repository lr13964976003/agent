<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: fa_pool_long_sequence_dag Pages: 1 -->
<svg width="8961pt" height="1657pt"
 viewBox="0.00 0.00 8961.00 1656.69" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1652.69)">
<title>fa_pool_long_sequence_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1652.69 8957,-1652.69 8957,4 -4,4"/>
<text text-anchor="middle" x="4476.5" y="-54" font-family="Times,serif" font-size="20.00">FA Pool &#45; Long Sequence (&gt;4096 tokens)</text>
<text text-anchor="middle" x="4476.5" y="-32" font-family="Times,serif" font-size="20.00">Base Layer: 8 GPUs + Attention Pool: 32 GPUs</text>
<text text-anchor="middle" x="4476.5" y="-10" font-family="Times,serif" font-size="20.00">Total: 40 GPUs</text>
<g id="clust1" class="cluster">
<title>cluster_base_layer</title>
<path fill="none" stroke="black" d="M219,-1129.74C219,-1129.74 813,-1129.74 813,-1129.74 819,-1129.74 825,-1135.74 825,-1141.74 825,-1141.74 825,-1239.74 825,-1239.74 825,-1245.74 819,-1251.74 813,-1251.74 813,-1251.74 219,-1251.74 219,-1251.74 213,-1251.74 207,-1245.74 207,-1239.74 207,-1239.74 207,-1141.74 207,-1141.74 207,-1135.74 213,-1129.74 219,-1129.74"/>
<text text-anchor="middle" x="516" y="-1231.74" font-family="Times,serif" font-size="20.00">Base Layer (8 GPUs &#45; Always Active)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_attention_pool</title>
<path fill="none" stroke="black" d="M776,-607.74C776,-607.74 8933,-607.74 8933,-607.74 8939,-607.74 8945,-613.74 8945,-619.74 8945,-619.74 8945,-1109.74 8945,-1109.74 8945,-1115.74 8939,-1121.74 8933,-1121.74 8933,-1121.74 776,-1121.74 776,-1121.74 770,-1121.74 764,-1115.74 764,-1109.74 764,-1109.74 764,-619.74 764,-619.74 764,-613.74 770,-607.74 776,-607.74"/>
<text text-anchor="middle" x="4854.5" y="-1101.74" font-family="Times,serif" font-size="20.00">Attention Pool (32 GPUs &#45; Activated for Long Sequences)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer0_pool</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="772,-615.74 772,-939.74 8937,-939.74 8937,-615.74 772,-615.74"/>
<text text-anchor="middle" x="4854.5" y="-919.74" font-family="Times,serif" font-size="20.00">Layer 0 Attention Pool</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_base_layer_ffn</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="7332,-485.74 7332,-599.74 8114,-599.74 8114,-485.74 7332,-485.74"/>
<text text-anchor="middle" x="7723" y="-579.74" font-family="Times,serif" font-size="20.00">Base Layer FFN (Always on Base GPUs)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_output</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="6979,-82 6979,-477.74 7786,-477.74 7786,-82 6979,-82"/>
<text text-anchor="middle" x="7382.5" y="-457.74" font-family="Times,serif" font-size="20.00">Output Layer (TP=8)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="#e8f4fd" stroke="black" cx="420" cy="-1611.22" rx="321.05" ry="37.45"/>
<text text-anchor="middle" x="420" y="-1622.52" font-family="monospace" font-size="14.00">Input (Long Seq)</text>
<text text-anchor="middle" x="420" y="-1607.52" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=&gt;4096, d_model=4096]</text>
<text text-anchor="middle" x="420" y="-1592.52" font-family="monospace" font-size="14.00">GPU: Host</text>
</g>
<!-- seq_check -->
<g id="node2" class="node">
<title>seq_check</title>
<polygon fill="#ffe4b5" stroke="black" points="719.74,-1537.74 242.92,-1537.74 120.26,-1401.74 597.08,-1401.74 719.74,-1537.74"/>
<text text-anchor="middle" x="420" y="-1488.54" font-family="monospace" font-size="14.00">Sequence Length Check</text>
<text text-anchor="middle" x="420" y="-1473.54" font-family="monospace" font-size="14.00">Threshold: 4096 tokens</text>
<text text-anchor="middle" x="420" y="-1458.54" font-family="monospace" font-size="14.00">Decision: Activate Attention Pool</text>
<text text-anchor="middle" x="420" y="-1443.54" font-family="monospace" font-size="14.00">Block Size: ceil(seq_len/32)</text>
</g>
<!-- input&#45;&gt;seq_check -->
<g id="edge1" class="edge">
<title>input&#45;&gt;seq_check</title>
<path fill="none" stroke="black" d="M420,-1573.68C420,-1573.68 420,-1547.83 420,-1547.83"/>
<polygon fill="black" stroke="black" points="423.5,-1547.83 420,-1537.83 416.5,-1547.83 423.5,-1547.83"/>
</g>
<!-- resource_manager -->
<g id="node3" class="node">
<title>resource_manager</title>
<polygon fill="#ff6b6b" stroke="black" points="736.42,-1365.74 233.07,-1365.74 103.58,-1259.74 606.93,-1259.74 736.42,-1365.74"/>
<text text-anchor="middle" x="420" y="-1324.04" font-family="monospace" font-size="14.00">Resource Manager</text>
<text text-anchor="middle" x="420" y="-1309.04" font-family="monospace" font-size="14.00">Activate 32 GPUs for Attention Pool</text>
<text text-anchor="middle" x="420" y="-1294.04" font-family="monospace" font-size="14.00">Distribute Attention Computation</text>
</g>
<!-- seq_check&#45;&gt;resource_manager -->
<g id="edge2" class="edge">
<title>seq_check&#45;&gt;resource_manager</title>
<path fill="none" stroke="black" d="M420,-1401.33C420,-1401.33 420,-1375.81 420,-1375.81"/>
<polygon fill="black" stroke="black" points="423.5,-1375.81 420,-1365.81 416.5,-1375.81 423.5,-1375.81"/>
</g>
<!-- embed_split -->
<g id="node4" class="node">
<title>embed_split</title>
<polygon fill="#ffe4b5" stroke="black" points="625.05,-1213.74 298.86,-1213.74 214.95,-1137.74 541.14,-1137.74 625.05,-1213.74"/>
<text text-anchor="middle" x="420" y="-1179.54" font-family="monospace" font-size="14.00">Split Embedding (TP=8)</text>
<text text-anchor="middle" x="420" y="-1164.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- resource_manager&#45;&gt;embed_split -->
<g id="edge3" class="edge">
<title>resource_manager&#45;&gt;embed_split</title>
<path fill="none" stroke="black" d="M420,-1259.38C420,-1259.38 420,-1223.91 420,-1223.91"/>
<polygon fill="black" stroke="black" points="423.5,-1223.91 420,-1213.91 416.5,-1223.91 423.5,-1223.91"/>
</g>
<!-- embed_0 -->
<g id="node61" class="node">
<title>embed_0</title>
<polygon fill="lightgrey" stroke="black" points="74,-1033.74 0,-1033.74 0,-997.74 74,-997.74 74,-1033.74"/>
<text text-anchor="middle" x="37" y="-1012.04" font-family="monospace" font-size="14.00">embed_0</text>
</g>
<!-- embed_split&#45;&gt;embed_0 -->
<g id="edge4" class="edge">
<title>embed_split&#45;&gt;embed_0</title>
<path fill="none" stroke="black" d="M270.28,-1188C162.86,-1188 37,-1188 37,-1188 37,-1188 37,-1043.85 37,-1043.85"/>
<polygon fill="black" stroke="black" points="40.5,-1043.85 37,-1033.85 33.5,-1043.85 40.5,-1043.85"/>
</g>
<!-- embed_1 -->
<g id="node62" class="node">
<title>embed_1</title>
<polygon fill="lightgrey" stroke="black" points="166,-1033.74 92,-1033.74 92,-997.74 166,-997.74 166,-1033.74"/>
<text text-anchor="middle" x="129" y="-1012.04" font-family="monospace" font-size="14.00">embed_1</text>
</g>
<!-- embed_split&#45;&gt;embed_1 -->
<g id="edge5" class="edge">
<title>embed_split&#45;&gt;embed_1</title>
<path fill="none" stroke="black" d="M242.68,-1163C184.7,-1163 134.9,-1163 134.9,-1163 134.9,-1163 134.9,-1043.8 134.9,-1043.8"/>
<polygon fill="black" stroke="black" points="138.4,-1043.8 134.9,-1033.8 131.4,-1043.8 138.4,-1043.8"/>
</g>
<!-- embed_2 -->
<g id="node63" class="node">
<title>embed_2</title>
<polygon fill="lightgrey" stroke="black" points="258,-1033.74 184,-1033.74 184,-997.74 258,-997.74 258,-1033.74"/>
<text text-anchor="middle" x="221" y="-1012.04" font-family="monospace" font-size="14.00">embed_2</text>
</g>
<!-- embed_split&#45;&gt;embed_2 -->
<g id="edge6" class="edge">
<title>embed_split&#45;&gt;embed_2</title>
<path fill="none" stroke="black" d="M236.36,-1137.42C236.36,-1137.42 236.36,-1044 236.36,-1044"/>
<polygon fill="black" stroke="black" points="239.86,-1044 236.36,-1034 232.86,-1044 239.86,-1044"/>
</g>
<!-- embed_3 -->
<g id="node64" class="node">
<title>embed_3</title>
<polygon fill="lightgrey" stroke="black" points="350,-1033.74 276,-1033.74 276,-997.74 350,-997.74 350,-1033.74"/>
<text text-anchor="middle" x="313" y="-1012.04" font-family="monospace" font-size="14.00">embed_3</text>
</g>
<!-- embed_split&#45;&gt;embed_3 -->
<g id="edge7" class="edge">
<title>embed_split&#45;&gt;embed_3</title>
<path fill="none" stroke="black" d="M313,-1137.42C313,-1137.42 313,-1044 313,-1044"/>
<polygon fill="black" stroke="black" points="316.5,-1044 313,-1034 309.5,-1044 316.5,-1044"/>
</g>
<!-- embed_4 -->
<g id="node65" class="node">
<title>embed_4</title>
<polygon fill="lightgrey" stroke="black" points="442,-1033.74 368,-1033.74 368,-997.74 442,-997.74 442,-1033.74"/>
<text text-anchor="middle" x="405" y="-1012.04" font-family="monospace" font-size="14.00">embed_4</text>
</g>
<!-- embed_split&#45;&gt;embed_4 -->
<g id="edge8" class="edge">
<title>embed_split&#45;&gt;embed_4</title>
<path fill="none" stroke="black" d="M405,-1137.42C405,-1137.42 405,-1044 405,-1044"/>
<polygon fill="black" stroke="black" points="408.5,-1044 405,-1034 401.5,-1044 408.5,-1044"/>
</g>
<!-- embed_5 -->
<g id="node66" class="node">
<title>embed_5</title>
<polygon fill="lightgrey" stroke="black" points="534,-1033.74 460,-1033.74 460,-997.74 534,-997.74 534,-1033.74"/>
<text text-anchor="middle" x="497" y="-1012.04" font-family="monospace" font-size="14.00">embed_5</text>
</g>
<!-- embed_split&#45;&gt;embed_5 -->
<g id="edge9" class="edge">
<title>embed_split&#45;&gt;embed_5</title>
<path fill="none" stroke="black" d="M497,-1137.42C497,-1137.42 497,-1044 497,-1044"/>
<polygon fill="black" stroke="black" points="500.5,-1044 497,-1034 493.5,-1044 500.5,-1044"/>
</g>
<!-- embed_6 -->
<g id="node67" class="node">
<title>embed_6</title>
<polygon fill="lightgrey" stroke="black" points="626,-1033.74 552,-1033.74 552,-997.74 626,-997.74 626,-1033.74"/>
<text text-anchor="middle" x="589" y="-1012.04" font-family="monospace" font-size="14.00">embed_6</text>
</g>
<!-- embed_split&#45;&gt;embed_6 -->
<g id="edge10" class="edge">
<title>embed_split&#45;&gt;embed_6</title>
<path fill="none" stroke="black" d="M588.64,-1175.62C588.64,-1175.62 588.64,-1043.88 588.64,-1043.88"/>
<polygon fill="black" stroke="black" points="592.14,-1043.88 588.64,-1033.88 585.14,-1043.88 592.14,-1043.88"/>
</g>
<!-- embed_7 -->
<g id="node68" class="node">
<title>embed_7</title>
<polygon fill="lightgrey" stroke="black" points="718,-1033.74 644,-1033.74 644,-997.74 718,-997.74 718,-1033.74"/>
<text text-anchor="middle" x="681" y="-1012.04" font-family="monospace" font-size="14.00">embed_7</text>
</g>
<!-- embed_split&#45;&gt;embed_7 -->
<g id="edge11" class="edge">
<title>embed_split&#45;&gt;embed_7</title>
<path fill="none" stroke="black" d="M551.65,-1147C616.51,-1147 681,-1147 681,-1147 681,-1147 681,-1043.99 681,-1043.99"/>
<polygon fill="black" stroke="black" points="684.5,-1043.99 681,-1033.99 677.5,-1043.99 684.5,-1043.99"/>
</g>
<!-- pos_enc -->
<g id="node5" class="node">
<title>pos_enc</title>
<polygon fill="#87ceeb" stroke="black" points="816.5,-1194.74 643.5,-1194.74 643.5,-1156.74 816.5,-1156.74 816.5,-1194.74"/>
<text text-anchor="middle" x="730" y="-1179.54" font-family="monospace" font-size="14.00">Positional Encoding</text>
<text text-anchor="middle" x="730" y="-1164.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- block_split -->
<g id="node6" class="node">
<title>block_split</title>
<polygon fill="#ff6b6b" stroke="black" points="8241.96,-1083.74 7480.04,-1083.74 7284.04,-947.74 8045.96,-947.74 8241.96,-1083.74"/>
<text text-anchor="middle" x="7763" y="-1034.54" font-family="monospace" font-size="14.00">Block&#45;wise Split</text>
<text text-anchor="middle" x="7763" y="-1019.54" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=&gt;4096, d_model=4096]</text>
<text text-anchor="middle" x="7763" y="-1004.54" font-family="monospace" font-size="14.00">Output: 32×[batch_size=1024, block_size, d_model=4096]</text>
<text text-anchor="middle" x="7763" y="-989.54" font-family="monospace" font-size="14.00">GPU: 8&#45;39</text>
</g>
<!-- pos_enc&#45;&gt;block_split -->
<g id="edge21" class="edge">
<title>pos_enc&#45;&gt;block_split</title>
<path fill="none" stroke="black" d="M798.29,-1156.56C798.29,-1123.2 798.29,-1058 798.29,-1058 798.29,-1058 7432.77,-1058 7432.77,-1058"/>
<polygon fill="black" stroke="black" points="7432.77,-1061.5 7442.77,-1058 7432.77,-1054.5 7432.77,-1061.5"/>
</g>
<!-- flash_attn_0_8 -->
<g id="node8" class="node">
<title>flash_attn_0_8</title>
<polygon fill="#ffd700" stroke="black" points="8762,-867.74 8556,-867.74 8556,-829.74 8762,-829.74 8762,-867.74"/>
<text text-anchor="middle" x="8659" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 0</text>
<text text-anchor="middle" x="8659" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_8</text>
</g>
<!-- block_split&#45;&gt;flash_attn_0_8 -->
<g id="edge22" class="edge">
<title>block_split&#45;&gt;flash_attn_0_8</title>
<path fill="none" stroke="black" d="M8176.25,-1038C8411.21,-1038 8659,-1038 8659,-1038 8659,-1038 8659,-877.93 8659,-877.93"/>
<polygon fill="black" stroke="black" points="8662.5,-877.93 8659,-867.93 8655.5,-877.93 8662.5,-877.93"/>
</g>
<!-- flash_attn_0_9 -->
<g id="node9" class="node">
<title>flash_attn_0_9</title>
<polygon fill="#ffd700" stroke="black" points="8538,-867.74 8332,-867.74 8332,-829.74 8538,-829.74 8538,-867.74"/>
<text text-anchor="middle" x="8435" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 1</text>
<text text-anchor="middle" x="8435" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_9</text>
</g>
<!-- block_split&#45;&gt;flash_attn_0_9 -->
<g id="edge23" class="edge">
<title>block_split&#45;&gt;flash_attn_0_9</title>
<path fill="none" stroke="black" d="M8111.3,-993C8275.1,-993 8435,-993 8435,-993 8435,-993 8435,-877.9 8435,-877.9"/>
<polygon fill="black" stroke="black" points="8438.5,-877.9 8435,-867.9 8431.5,-877.9 8438.5,-877.9"/>
</g>
<!-- flash_attn_0_10 -->
<g id="node10" class="node">
<title>flash_attn_0_10</title>
<polygon fill="#ffd700" stroke="black" points="8314,-867.74 8108,-867.74 8108,-829.74 8314,-829.74 8314,-867.74"/>
<text text-anchor="middle" x="8211" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 2</text>
<text text-anchor="middle" x="8211" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_10</text>
</g>
<!-- block_split&#45;&gt;flash_attn_0_10 -->
<g id="edge24" class="edge">
<title>block_split&#45;&gt;flash_attn_0_10</title>
<path fill="none" stroke="black" d="M8174.99,-1015.62C8174.99,-1015.62 8174.99,-877.99 8174.99,-877.99"/>
<polygon fill="black" stroke="black" points="8178.49,-877.99 8174.99,-867.99 8171.49,-877.99 8178.49,-877.99"/>
</g>
<!-- flash_attn_0_11 -->
<g id="node11" class="node">
<title>flash_attn_0_11</title>
<polygon fill="#ffd700" stroke="black" points="8090,-867.74 7884,-867.74 7884,-829.74 8090,-829.74 8090,-867.74"/>
<text text-anchor="middle" x="7987" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 3</text>
<text text-anchor="middle" x="7987" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_11</text>
</g>
<!-- block_split&#45;&gt;flash_attn_0_11 -->
<g id="edge25" class="edge">
<title>block_split&#45;&gt;flash_attn_0_11</title>
<path fill="none" stroke="black" d="M7987,-947.33C7987,-947.33 7987,-877.78 7987,-877.78"/>
<polygon fill="black" stroke="black" points="7990.5,-877.78 7987,-867.78 7983.5,-877.78 7990.5,-877.78"/>
</g>
<!-- flash_attn_0_12 -->
<g id="node12" class="node">
<title>flash_attn_0_12</title>
<polygon fill="#ffd700" stroke="black" points="7866,-867.74 7660,-867.74 7660,-829.74 7866,-829.74 7866,-867.74"/>
<text text-anchor="middle" x="7763" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 4</text>
<text text-anchor="middle" x="7763" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_12</text>
</g>
<!-- block_split&#45;&gt;flash_attn_0_12 -->
<g id="edge26" class="edge">
<title>block_split&#45;&gt;flash_attn_0_12</title>
<path fill="none" stroke="black" d="M7763,-947.33C7763,-947.33 7763,-877.78 7763,-877.78"/>
<polygon fill="black" stroke="black" points="7766.5,-877.78 7763,-867.78 7759.5,-877.78 7766.5,-877.78"/>
</g>
<!-- flash_attn_0_13 -->
<g id="node13" class="node">
<title>flash_attn_0_13</title>
<polygon fill="#ffd700" stroke="black" points="7642,-867.74 7436,-867.74 7436,-829.74 7642,-829.74 7642,-867.74"/>
<text text-anchor="middle" x="7539" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 5</text>
<text text-anchor="middle" x="7539" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_13</text>
</g>
<!-- block_split&#45;&gt;flash_attn_0_13 -->
<g id="edge27" class="edge">
<title>block_split&#45;&gt;flash_attn_0_13</title>
<path fill="none" stroke="black" d="M7539,-947.33C7539,-947.33 7539,-877.78 7539,-877.78"/>
<polygon fill="black" stroke="black" points="7542.5,-877.78 7539,-867.78 7535.5,-877.78 7542.5,-877.78"/>
</g>
<!-- flash_attn_0_14 -->
<g id="node14" class="node">
<title>flash_attn_0_14</title>
<polygon fill="#ffd700" stroke="black" points="7418,-867.74 7212,-867.74 7212,-829.74 7418,-829.74 7418,-867.74"/>
<text text-anchor="middle" x="7315" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 6</text>
<text text-anchor="middle" x="7315" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_14</text>
</g>
<!-- block_split&#45;&gt;flash_attn_0_14 -->
<g id="edge28" class="edge">
<title>block_split&#45;&gt;flash_attn_0_14</title>
<path fill="none" stroke="black" d="M7351.01,-947.33C7351.01,-947.33 7351.01,-877.78 7351.01,-877.78"/>
<polygon fill="black" stroke="black" points="7354.51,-877.78 7351.01,-867.78 7347.51,-877.78 7354.51,-877.78"/>
</g>
<!-- flash_attn_0_15 -->
<g id="node15" class="node">
<title>flash_attn_0_15</title>
<polygon fill="#ffd700" stroke="black" points="7194,-867.74 6988,-867.74 6988,-829.74 7194,-829.74 7194,-867.74"/>
<text text-anchor="middle" x="7091" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 7</text>
<text text-anchor="middle" x="7091" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_15</text>
</g>
<!-- block_split&#45;&gt;flash_attn_0_15 -->
<g id="edge29" class="edge">
<title>block_split&#45;&gt;flash_attn_0_15</title>
<path fill="none" stroke="black" d="M7318.98,-972C7193.8,-972 7091,-972 7091,-972 7091,-972 7091,-878 7091,-878"/>
<polygon fill="black" stroke="black" points="7094.5,-878 7091,-868 7087.5,-878 7094.5,-878"/>
</g>
<!-- layernorm_0_pool -->
<g id="node7" class="node">
<title>layernorm_0_pool</title>
<polygon fill="#dda0dd" stroke="black" points="8929.5,-867.74 8780.5,-867.74 8780.5,-829.74 8929.5,-829.74 8929.5,-867.74"/>
<text text-anchor="middle" x="8855" y="-852.54" font-family="monospace" font-size="14.00">LayerNorm 0 Pool</text>
<text text-anchor="middle" x="8855" y="-837.54" font-family="monospace" font-size="14.00">GPU: 8&#45;39</text>
</g>
<!-- concat_0 -->
<g id="node41" class="node">
<title>concat_0</title>
<polygon fill="#ffe4b5" stroke="black" points="8345.87,-759.74 7596.82,-759.74 7404.13,-623.74 8153.18,-623.74 8345.87,-759.74"/>
<text text-anchor="middle" x="7875" y="-710.54" font-family="monospace" font-size="14.00">Concatenate Blocks</text>
<text text-anchor="middle" x="7875" y="-695.54" font-family="monospace" font-size="14.00">Input: 32×[batch_size=1024, block_size, d_model=4096]</text>
<text text-anchor="middle" x="7875" y="-680.54" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len, d_model=4096]</text>
<text text-anchor="middle" x="7875" y="-665.54" font-family="monospace" font-size="14.00">GPU: 8&#45;39 → 0&#45;7</text>
</g>
<!-- flash_attn_0_8&#45;&gt;concat_0 -->
<g id="edge30" class="edge">
<title>flash_attn_0_8&#45;&gt;concat_0</title>
<path fill="none" stroke="black" d="M8659,-829.71C8659,-787.76 8659,-691 8659,-691 8659,-691 8258.63,-691 8258.63,-691"/>
<polygon fill="black" stroke="black" points="8258.63,-687.5 8248.63,-691 8258.63,-694.5 8258.63,-687.5"/>
</g>
<!-- flash_attn_0_9&#45;&gt;concat_0 -->
<g id="edge31" class="edge">
<title>flash_attn_0_9&#45;&gt;concat_0</title>
<path fill="none" stroke="black" d="M8338.84,-829.49C8338.84,-829.49 8338.84,-701.81 8338.84,-701.81"/>
<polygon fill="black" stroke="black" points="8342.34,-701.81 8338.84,-691.81 8335.34,-701.81 8342.34,-701.81"/>
</g>
<!-- flash_attn_0_10&#45;&gt;concat_0 -->
<g id="edge32" class="edge">
<title>flash_attn_0_10&#45;&gt;concat_0</title>
<path fill="none" stroke="black" d="M8211,-829.49C8211,-829.49 8211,-769.96 8211,-769.96"/>
<polygon fill="black" stroke="black" points="8214.5,-769.96 8211,-759.96 8207.5,-769.96 8214.5,-769.96"/>
</g>
<!-- flash_attn_0_11&#45;&gt;concat_0 -->
<g id="edge33" class="edge">
<title>flash_attn_0_11&#45;&gt;concat_0</title>
<path fill="none" stroke="black" d="M7987,-829.49C7987,-829.49 7987,-769.96 7987,-769.96"/>
<polygon fill="black" stroke="black" points="7990.5,-769.96 7987,-759.96 7983.5,-769.96 7990.5,-769.96"/>
</g>
<!-- flash_attn_0_12&#45;&gt;concat_0 -->
<g id="edge34" class="edge">
<title>flash_attn_0_12&#45;&gt;concat_0</title>
<path fill="none" stroke="black" d="M7763,-829.49C7763,-829.49 7763,-769.96 7763,-769.96"/>
<polygon fill="black" stroke="black" points="7766.5,-769.96 7763,-759.96 7759.5,-769.96 7766.5,-769.96"/>
</g>
<!-- flash_attn_0_13&#45;&gt;concat_0 -->
<g id="edge35" class="edge">
<title>flash_attn_0_13&#45;&gt;concat_0</title>
<path fill="none" stroke="black" d="M7539,-829.49C7539,-829.49 7539,-729.07 7539,-729.07"/>
<polygon fill="black" stroke="black" points="7542.5,-729.06 7539,-719.07 7535.5,-729.07 7542.5,-729.06"/>
</g>
<!-- flash_attn_0_14&#45;&gt;concat_0 -->
<g id="edge36" class="edge">
<title>flash_attn_0_14&#45;&gt;concat_0</title>
<path fill="none" stroke="black" d="M7411.16,-829.49C7411.16,-829.49 7411.16,-701.81 7411.16,-701.81"/>
<polygon fill="black" stroke="black" points="7414.66,-701.81 7411.16,-691.81 7407.66,-701.81 7414.66,-701.81"/>
</g>
<!-- flash_attn_0_15&#45;&gt;concat_0 -->
<g id="edge37" class="edge">
<title>flash_attn_0_15&#45;&gt;concat_0</title>
<path fill="none" stroke="black" d="M7180.5,-829.71C7180.5,-787.76 7180.5,-691 7180.5,-691 7180.5,-691 7489.29,-691 7489.29,-691"/>
<polygon fill="black" stroke="black" points="7489.29,-694.5 7499.29,-691 7489.29,-687.5 7489.29,-694.5"/>
</g>
<!-- flash_attn_0_16 -->
<g id="node16" class="node">
<title>flash_attn_0_16</title>
<polygon fill="#ffd700" stroke="black" points="6970,-867.74 6764,-867.74 6764,-829.74 6970,-829.74 6970,-867.74"/>
<text text-anchor="middle" x="6867" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 8</text>
<text text-anchor="middle" x="6867" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_16</text>
</g>
<!-- flash_attn_0_17 -->
<g id="node17" class="node">
<title>flash_attn_0_17</title>
<polygon fill="#ffd700" stroke="black" points="6746,-867.74 6540,-867.74 6540,-829.74 6746,-829.74 6746,-867.74"/>
<text text-anchor="middle" x="6643" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 9</text>
<text text-anchor="middle" x="6643" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_17</text>
</g>
<!-- flash_attn_0_18 -->
<g id="node18" class="node">
<title>flash_attn_0_18</title>
<polygon fill="#ffd700" stroke="black" points="6521.5,-867.74 6306.5,-867.74 6306.5,-829.74 6521.5,-829.74 6521.5,-867.74"/>
<text text-anchor="middle" x="6414" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 10</text>
<text text-anchor="middle" x="6414" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_18</text>
</g>
<!-- flash_attn_0_19 -->
<g id="node19" class="node">
<title>flash_attn_0_19</title>
<polygon fill="#ffd700" stroke="black" points="6288.5,-867.74 6073.5,-867.74 6073.5,-829.74 6288.5,-829.74 6288.5,-867.74"/>
<text text-anchor="middle" x="6181" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 11</text>
<text text-anchor="middle" x="6181" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_19</text>
</g>
<!-- flash_attn_0_20 -->
<g id="node20" class="node">
<title>flash_attn_0_20</title>
<polygon fill="#ffd700" stroke="black" points="6055.5,-867.74 5840.5,-867.74 5840.5,-829.74 6055.5,-829.74 6055.5,-867.74"/>
<text text-anchor="middle" x="5948" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 12</text>
<text text-anchor="middle" x="5948" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_20</text>
</g>
<!-- flash_attn_0_21 -->
<g id="node21" class="node">
<title>flash_attn_0_21</title>
<polygon fill="#ffd700" stroke="black" points="5822.5,-867.74 5607.5,-867.74 5607.5,-829.74 5822.5,-829.74 5822.5,-867.74"/>
<text text-anchor="middle" x="5715" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 13</text>
<text text-anchor="middle" x="5715" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_21</text>
</g>
<!-- flash_attn_0_22 -->
<g id="node22" class="node">
<title>flash_attn_0_22</title>
<polygon fill="#ffd700" stroke="black" points="5589.5,-867.74 5374.5,-867.74 5374.5,-829.74 5589.5,-829.74 5589.5,-867.74"/>
<text text-anchor="middle" x="5482" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 14</text>
<text text-anchor="middle" x="5482" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_22</text>
</g>
<!-- flash_attn_0_23 -->
<g id="node23" class="node">
<title>flash_attn_0_23</title>
<polygon fill="#ffd700" stroke="black" points="5356.5,-867.74 5141.5,-867.74 5141.5,-829.74 5356.5,-829.74 5356.5,-867.74"/>
<text text-anchor="middle" x="5249" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 15</text>
<text text-anchor="middle" x="5249" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_23</text>
</g>
<!-- flash_attn_0_24 -->
<g id="node24" class="node">
<title>flash_attn_0_24</title>
<polygon fill="#ffd700" stroke="black" points="5123.5,-867.74 4908.5,-867.74 4908.5,-829.74 5123.5,-829.74 5123.5,-867.74"/>
<text text-anchor="middle" x="5016" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 16</text>
<text text-anchor="middle" x="5016" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_24</text>
</g>
<!-- flash_attn_0_25 -->
<g id="node25" class="node">
<title>flash_attn_0_25</title>
<polygon fill="#ffd700" stroke="black" points="4890.5,-867.74 4675.5,-867.74 4675.5,-829.74 4890.5,-829.74 4890.5,-867.74"/>
<text text-anchor="middle" x="4783" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 17</text>
<text text-anchor="middle" x="4783" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_25</text>
</g>
<!-- flash_attn_0_26 -->
<g id="node26" class="node">
<title>flash_attn_0_26</title>
<polygon fill="#ffd700" stroke="black" points="4657.5,-867.74 4442.5,-867.74 4442.5,-829.74 4657.5,-829.74 4657.5,-867.74"/>
<text text-anchor="middle" x="4550" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 18</text>
<text text-anchor="middle" x="4550" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_26</text>
</g>
<!-- flash_attn_0_27 -->
<g id="node27" class="node">
<title>flash_attn_0_27</title>
<polygon fill="#ffd700" stroke="black" points="4424.5,-867.74 4209.5,-867.74 4209.5,-829.74 4424.5,-829.74 4424.5,-867.74"/>
<text text-anchor="middle" x="4317" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 19</text>
<text text-anchor="middle" x="4317" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_27</text>
</g>
<!-- flash_attn_0_28 -->
<g id="node28" class="node">
<title>flash_attn_0_28</title>
<polygon fill="#ffd700" stroke="black" points="4191.5,-867.74 3976.5,-867.74 3976.5,-829.74 4191.5,-829.74 4191.5,-867.74"/>
<text text-anchor="middle" x="4084" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 20</text>
<text text-anchor="middle" x="4084" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_28</text>
</g>
<!-- flash_attn_0_29 -->
<g id="node29" class="node">
<title>flash_attn_0_29</title>
<polygon fill="#ffd700" stroke="black" points="3958.5,-867.74 3743.5,-867.74 3743.5,-829.74 3958.5,-829.74 3958.5,-867.74"/>
<text text-anchor="middle" x="3851" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 21</text>
<text text-anchor="middle" x="3851" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_29</text>
</g>
<!-- flash_attn_0_30 -->
<g id="node30" class="node">
<title>flash_attn_0_30</title>
<polygon fill="#ffd700" stroke="black" points="3725.5,-867.74 3510.5,-867.74 3510.5,-829.74 3725.5,-829.74 3725.5,-867.74"/>
<text text-anchor="middle" x="3618" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 22</text>
<text text-anchor="middle" x="3618" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_30</text>
</g>
<!-- flash_attn_0_31 -->
<g id="node31" class="node">
<title>flash_attn_0_31</title>
<polygon fill="#ffd700" stroke="black" points="3492.5,-867.74 3277.5,-867.74 3277.5,-829.74 3492.5,-829.74 3492.5,-867.74"/>
<text text-anchor="middle" x="3385" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 23</text>
<text text-anchor="middle" x="3385" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_31</text>
</g>
<!-- flash_attn_0_32 -->
<g id="node32" class="node">
<title>flash_attn_0_32</title>
<polygon fill="#ffd700" stroke="black" points="3259.5,-867.74 3044.5,-867.74 3044.5,-829.74 3259.5,-829.74 3259.5,-867.74"/>
<text text-anchor="middle" x="3152" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 24</text>
<text text-anchor="middle" x="3152" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_32</text>
</g>
<!-- flash_attn_0_33 -->
<g id="node33" class="node">
<title>flash_attn_0_33</title>
<polygon fill="#ffd700" stroke="black" points="3026.5,-867.74 2811.5,-867.74 2811.5,-829.74 3026.5,-829.74 3026.5,-867.74"/>
<text text-anchor="middle" x="2919" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 25</text>
<text text-anchor="middle" x="2919" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_33</text>
</g>
<!-- flash_attn_0_34 -->
<g id="node34" class="node">
<title>flash_attn_0_34</title>
<polygon fill="#ffd700" stroke="black" points="2793.5,-867.74 2578.5,-867.74 2578.5,-829.74 2793.5,-829.74 2793.5,-867.74"/>
<text text-anchor="middle" x="2686" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 26</text>
<text text-anchor="middle" x="2686" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_34</text>
</g>
<!-- flash_attn_0_35 -->
<g id="node35" class="node">
<title>flash_attn_0_35</title>
<polygon fill="#ffd700" stroke="black" points="2560.5,-867.74 2345.5,-867.74 2345.5,-829.74 2560.5,-829.74 2560.5,-867.74"/>
<text text-anchor="middle" x="2453" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 27</text>
<text text-anchor="middle" x="2453" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_35</text>
</g>
<!-- flash_attn_0_36 -->
<g id="node36" class="node">
<title>flash_attn_0_36</title>
<polygon fill="#ffd700" stroke="black" points="2327.5,-867.74 2112.5,-867.74 2112.5,-829.74 2327.5,-829.74 2327.5,-867.74"/>
<text text-anchor="middle" x="2220" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 28</text>
<text text-anchor="middle" x="2220" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_36</text>
</g>
<!-- flash_attn_0_37 -->
<g id="node37" class="node">
<title>flash_attn_0_37</title>
<polygon fill="#ffd700" stroke="black" points="2094.5,-867.74 1879.5,-867.74 1879.5,-829.74 2094.5,-829.74 2094.5,-867.74"/>
<text text-anchor="middle" x="1987" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 29</text>
<text text-anchor="middle" x="1987" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_37</text>
</g>
<!-- flash_attn_0_38 -->
<g id="node38" class="node">
<title>flash_attn_0_38</title>
<polygon fill="#ffd700" stroke="black" points="1861.5,-867.74 1646.5,-867.74 1646.5,-829.74 1861.5,-829.74 1861.5,-867.74"/>
<text text-anchor="middle" x="1754" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 30</text>
<text text-anchor="middle" x="1754" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_38</text>
</g>
<!-- flash_attn_0_39 -->
<g id="node39" class="node">
<title>flash_attn_0_39</title>
<polygon fill="#ffd700" stroke="black" points="1628.5,-867.74 1413.5,-867.74 1413.5,-829.74 1628.5,-829.74 1628.5,-867.74"/>
<text text-anchor="middle" x="1521" y="-852.54" font-family="monospace" font-size="14.00">Flash Attention Block 31</text>
<text text-anchor="middle" x="1521" y="-837.54" font-family="monospace" font-size="14.00">GPU: gpu_39</text>
</g>
<!-- kv_cache_share -->
<g id="node40" class="node">
<title>kv_cache_share</title>
<polygon fill="#ff6b6b" stroke="black" points="1395.83,-901.74 906.14,-901.74 780.17,-795.74 1269.86,-795.74 1395.83,-901.74"/>
<text text-anchor="middle" x="1088" y="-860.04" font-family="monospace" font-size="14.00">KV Cache Sharing</text>
<text text-anchor="middle" x="1088" y="-845.04" font-family="monospace" font-size="14.00">Replicate K,V across all pool GPUs</text>
<text text-anchor="middle" x="1088" y="-830.04" font-family="monospace" font-size="14.00">GPU: 8&#45;39</text>
</g>
<!-- ffn_0 -->
<g id="node42" class="node">
<title>ffn_0</title>
<polygon fill="#98fb98" stroke="black" points="8106,-561.74 7644,-561.74 7644,-493.74 8106,-493.74 8106,-561.74"/>
<text text-anchor="middle" x="7875" y="-546.54" font-family="monospace" font-size="14.00">FFN 0</text>
<text text-anchor="middle" x="7875" y="-531.54" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=&gt;4096, d_model=4096]</text>
<text text-anchor="middle" x="7875" y="-516.54" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=&gt;4096, d_model=4096]</text>
<text text-anchor="middle" x="7875" y="-501.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- concat_0&#45;&gt;ffn_0 -->
<g id="edge38" class="edge">
<title>concat_0&#45;&gt;ffn_0</title>
<path fill="none" stroke="black" d="M7875,-623.61C7875,-623.61 7875,-571.84 7875,-571.84"/>
<polygon fill="black" stroke="black" points="7878.5,-571.84 7875,-561.84 7871.5,-571.84 7878.5,-571.84"/>
</g>
<!-- ffn_1 -->
<g id="node43" class="node">
<title>ffn_1</title>
<polygon fill="#98fb98" stroke="black" points="7625.5,-546.74 7542.5,-546.74 7542.5,-508.74 7625.5,-508.74 7625.5,-546.74"/>
<text text-anchor="middle" x="7584" y="-531.54" font-family="monospace" font-size="14.00">FFN 1</text>
<text text-anchor="middle" x="7584" y="-516.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ffn_2 -->
<g id="node44" class="node">
<title>ffn_2</title>
<polygon fill="#98fb98" stroke="black" points="7524.5,-546.74 7441.5,-546.74 7441.5,-508.74 7524.5,-508.74 7524.5,-546.74"/>
<text text-anchor="middle" x="7483" y="-531.54" font-family="monospace" font-size="14.00">FFN 2</text>
<text text-anchor="middle" x="7483" y="-516.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ffn_3 -->
<g id="node45" class="node">
<title>ffn_3</title>
<polygon fill="#98fb98" stroke="black" points="7423.5,-546.74 7340.5,-546.74 7340.5,-508.74 7423.5,-508.74 7423.5,-546.74"/>
<text text-anchor="middle" x="7382" y="-531.54" font-family="monospace" font-size="14.00">FFN 3</text>
<text text-anchor="middle" x="7382" y="-516.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- output_split -->
<g id="node50" class="node">
<title>output_split</title>
<polygon fill="#ffe4b5" stroke="black" points="7561.22,-439.74 7276.12,-439.74 7202.78,-363.74 7487.88,-363.74 7561.22,-439.74"/>
<text text-anchor="middle" x="7382" y="-405.54" font-family="monospace" font-size="14.00">Split Output (TP=8)</text>
<text text-anchor="middle" x="7382" y="-390.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ffn_3&#45;&gt;output_split -->
<g id="edge39" class="edge">
<title>ffn_3&#45;&gt;output_split</title>
<path fill="none" stroke="black" d="M7382,-508.6C7382,-508.6 7382,-449.88 7382,-449.88"/>
<polygon fill="black" stroke="black" points="7385.5,-449.88 7382,-439.88 7378.5,-449.88 7385.5,-449.88"/>
</g>
<!-- async_comm_0 -->
<g id="node46" class="node">
<title>async_comm_0</title>
<ellipse fill="#ff6b6b" stroke="black" cx="1004" cy="-1611.22" rx="245.23" ry="37.45"/>
<text text-anchor="middle" x="1004" y="-1622.52" font-family="monospace" font-size="14.00">Asynchronous Communication</text>
<text text-anchor="middle" x="1004" y="-1607.52" font-family="monospace" font-size="14.00">Overlap Attention (Pool) with FFN (Base)</text>
<text text-anchor="middle" x="1004" y="-1592.52" font-family="monospace" font-size="14.00">GPU: 8&#45;39 ↔ 0&#45;7</text>
</g>
<!-- async_comm_1 -->
<g id="node47" class="node">
<title>async_comm_1</title>
<ellipse fill="#ff6b6b" stroke="black" cx="1443" cy="-1611.22" rx="175.23" ry="26.74"/>
<text text-anchor="middle" x="1443" y="-1615.02" font-family="monospace" font-size="14.00">Asynchronous Communication 1</text>
<text text-anchor="middle" x="1443" y="-1600.02" font-family="monospace" font-size="14.00">GPU: 8&#45;39 ↔ 0&#45;7</text>
</g>
<!-- async_comm_2 -->
<g id="node48" class="node">
<title>async_comm_2</title>
<ellipse fill="#ff6b6b" stroke="black" cx="1812" cy="-1611.22" rx="175.23" ry="26.74"/>
<text text-anchor="middle" x="1812" y="-1615.02" font-family="monospace" font-size="14.00">Asynchronous Communication 2</text>
<text text-anchor="middle" x="1812" y="-1600.02" font-family="monospace" font-size="14.00">GPU: 8&#45;39 ↔ 0&#45;7</text>
</g>
<!-- async_comm_3 -->
<g id="node49" class="node">
<title>async_comm_3</title>
<ellipse fill="#ff6b6b" stroke="black" cx="2181" cy="-1611.22" rx="175.23" ry="26.74"/>
<text text-anchor="middle" x="2181" y="-1615.02" font-family="monospace" font-size="14.00">Asynchronous Communication 3</text>
<text text-anchor="middle" x="2181" y="-1600.02" font-family="monospace" font-size="14.00">GPU: 8&#45;39 ↔ 0&#45;7</text>
</g>
<!-- output_0 -->
<g id="node51" class="node">
<title>output_0</title>
<polygon fill="lightgrey" stroke="black" points="7070.5,-327.74 6987.5,-327.74 6987.5,-291.74 7070.5,-291.74 7070.5,-327.74"/>
<text text-anchor="middle" x="7029" y="-306.04" font-family="monospace" font-size="14.00">output_0</text>
</g>
<!-- output_split&#45;&gt;output_0 -->
<g id="edge40" class="edge">
<title>output_split&#45;&gt;output_0</title>
<path fill="none" stroke="black" d="M7251.15,-414C7150.76,-414 7029.25,-414 7029.25,-414 7029.25,-414 7029.25,-337.9 7029.25,-337.9"/>
<polygon fill="black" stroke="black" points="7032.75,-337.9 7029.25,-327.9 7025.75,-337.9 7032.75,-337.9"/>
</g>
<!-- output_1 -->
<g id="node52" class="node">
<title>output_1</title>
<polygon fill="lightgrey" stroke="black" points="7171.5,-327.74 7088.5,-327.74 7088.5,-291.74 7171.5,-291.74 7171.5,-327.74"/>
<text text-anchor="middle" x="7130" y="-306.04" font-family="monospace" font-size="14.00">output_1</text>
</g>
<!-- output_split&#45;&gt;output_1 -->
<g id="edge41" class="edge">
<title>output_split&#45;&gt;output_1</title>
<path fill="none" stroke="black" d="M7227.07,-389C7175.06,-389 7130,-389 7130,-389 7130,-389 7130,-338.12 7130,-338.12"/>
<polygon fill="black" stroke="black" points="7133.5,-338.12 7130,-328.12 7126.5,-338.12 7133.5,-338.12"/>
</g>
<!-- output_2 -->
<g id="node53" class="node">
<title>output_2</title>
<polygon fill="lightgrey" stroke="black" points="7272.5,-327.74 7189.5,-327.74 7189.5,-291.74 7272.5,-291.74 7272.5,-327.74"/>
<text text-anchor="middle" x="7231" y="-306.04" font-family="monospace" font-size="14.00">output_2</text>
</g>
<!-- output_split&#45;&gt;output_2 -->
<g id="edge42" class="edge">
<title>output_split&#45;&gt;output_2</title>
<path fill="none" stroke="black" d="M7237.57,-363.52C7237.57,-363.52 7237.57,-338.13 7237.57,-338.13"/>
<polygon fill="black" stroke="black" points="7241.07,-338.13 7237.57,-328.13 7234.07,-338.13 7241.07,-338.13"/>
</g>
<!-- output_3 -->
<g id="node54" class="node">
<title>output_3</title>
<polygon fill="lightgrey" stroke="black" points="7373.5,-327.74 7290.5,-327.74 7290.5,-291.74 7373.5,-291.74 7373.5,-327.74"/>
<text text-anchor="middle" x="7332" y="-306.04" font-family="monospace" font-size="14.00">output_3</text>
</g>
<!-- output_split&#45;&gt;output_3 -->
<g id="edge43" class="edge">
<title>output_split&#45;&gt;output_3</title>
<path fill="none" stroke="black" d="M7332,-363.52C7332,-363.52 7332,-338.13 7332,-338.13"/>
<polygon fill="black" stroke="black" points="7335.5,-338.13 7332,-328.13 7328.5,-338.13 7335.5,-338.13"/>
</g>
<!-- output_4 -->
<g id="node55" class="node">
<title>output_4</title>
<polygon fill="lightgrey" stroke="black" points="7474.5,-327.74 7391.5,-327.74 7391.5,-291.74 7474.5,-291.74 7474.5,-327.74"/>
<text text-anchor="middle" x="7433" y="-306.04" font-family="monospace" font-size="14.00">output_4</text>
</g>
<!-- output_split&#45;&gt;output_4 -->
<g id="edge44" class="edge">
<title>output_split&#45;&gt;output_4</title>
<path fill="none" stroke="black" d="M7433,-363.52C7433,-363.52 7433,-338.13 7433,-338.13"/>
<polygon fill="black" stroke="black" points="7436.5,-338.13 7433,-328.13 7429.5,-338.13 7436.5,-338.13"/>
</g>
<!-- output_5 -->
<g id="node56" class="node">
<title>output_5</title>
<polygon fill="lightgrey" stroke="black" points="7575.5,-327.74 7492.5,-327.74 7492.5,-291.74 7575.5,-291.74 7575.5,-327.74"/>
<text text-anchor="middle" x="7534" y="-306.04" font-family="monospace" font-size="14.00">output_5</text>
</g>
<!-- output_split&#45;&gt;output_5 -->
<g id="edge45" class="edge">
<title>output_split&#45;&gt;output_5</title>
<path fill="none" stroke="black" d="M7526.93,-401.67C7526.93,-401.67 7526.93,-337.85 7526.93,-337.85"/>
<polygon fill="black" stroke="black" points="7530.43,-337.85 7526.93,-327.85 7523.43,-337.85 7530.43,-337.85"/>
</g>
<!-- output_6 -->
<g id="node57" class="node">
<title>output_6</title>
<polygon fill="lightgrey" stroke="black" points="7676.5,-327.74 7593.5,-327.74 7593.5,-291.74 7676.5,-291.74 7676.5,-327.74"/>
<text text-anchor="middle" x="7635" y="-306.04" font-family="monospace" font-size="14.00">output_6</text>
</g>
<!-- output_split&#45;&gt;output_6 -->
<g id="edge46" class="edge">
<title>output_split&#45;&gt;output_6</title>
<path fill="none" stroke="black" d="M7512.36,-389C7563.19,-389 7609.5,-389 7609.5,-389 7609.5,-389 7609.5,-338.12 7609.5,-338.12"/>
<polygon fill="black" stroke="black" points="7613,-338.12 7609.5,-328.12 7606,-338.12 7613,-338.12"/>
</g>
<!-- output_7 -->
<g id="node58" class="node">
<title>output_7</title>
<polygon fill="lightgrey" stroke="black" points="7777.5,-327.74 7694.5,-327.74 7694.5,-291.74 7777.5,-291.74 7777.5,-327.74"/>
<text text-anchor="middle" x="7736" y="-306.04" font-family="monospace" font-size="14.00">output_7</text>
</g>
<!-- output_split&#45;&gt;output_7 -->
<g id="edge47" class="edge">
<title>output_split&#45;&gt;output_7</title>
<path fill="none" stroke="black" d="M7536.5,-414C7631.82,-414 7736,-414 7736,-414 7736,-414 7736,-337.9 7736,-337.9"/>
<polygon fill="black" stroke="black" points="7739.5,-337.9 7736,-327.9 7732.5,-337.9 7739.5,-337.9"/>
</g>
<!-- output_concat -->
<g id="node59" class="node">
<title>output_concat</title>
<polygon fill="#ffe4b5" stroke="black" points="7510.61,-255.74 7306.02,-255.74 7253.39,-179.74 7457.98,-179.74 7510.61,-255.74"/>
<text text-anchor="middle" x="7382" y="-221.54" font-family="monospace" font-size="14.00">Concat Output</text>
<text text-anchor="middle" x="7382" y="-206.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- output_0&#45;&gt;output_concat -->
<g id="edge48" class="edge">
<title>output_0&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M7029,-291.5C7029,-261.49 7029,-205 7029,-205 7029,-205 7260.79,-205 7260.79,-205"/>
<polygon fill="black" stroke="black" points="7260.79,-208.5 7270.79,-205 7260.79,-201.5 7260.79,-208.5"/>
</g>
<!-- output_1&#45;&gt;output_concat -->
<g id="edge49" class="edge">
<title>output_1&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M7130,-291.65C7130,-268.12 7130,-230 7130,-230 7130,-230 7278.16,-230 7278.16,-230"/>
<polygon fill="black" stroke="black" points="7278.16,-233.5 7288.16,-230 7278.16,-226.5 7278.16,-233.5"/>
</g>
<!-- output_2&#45;&gt;output_concat -->
<g id="edge50" class="edge">
<title>output_2&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M7262.97,-291.56C7262.97,-291.56 7262.97,-227.88 7262.97,-227.88"/>
<polygon fill="black" stroke="black" points="7266.47,-227.88 7262.97,-217.88 7259.47,-227.88 7266.47,-227.88"/>
</g>
<!-- output_3&#45;&gt;output_concat -->
<g id="edge51" class="edge">
<title>output_3&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M7332,-291.56C7332,-291.56 7332,-266.04 7332,-266.04"/>
<polygon fill="black" stroke="black" points="7335.5,-266.04 7332,-256.04 7328.5,-266.04 7335.5,-266.04"/>
</g>
<!-- output_4&#45;&gt;output_concat -->
<g id="edge52" class="edge">
<title>output_4&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M7433,-291.56C7433,-291.56 7433,-266.04 7433,-266.04"/>
<polygon fill="black" stroke="black" points="7436.5,-266.04 7433,-256.04 7429.5,-266.04 7436.5,-266.04"/>
</g>
<!-- output_5&#45;&gt;output_concat -->
<g id="edge53" class="edge">
<title>output_5&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M7501.53,-291.56C7501.53,-291.56 7501.53,-266.04 7501.53,-266.04"/>
<polygon fill="black" stroke="black" points="7505.03,-266.04 7501.53,-256.04 7498.03,-266.04 7505.03,-266.04"/>
</g>
<!-- output_6&#45;&gt;output_concat -->
<g id="edge54" class="edge">
<title>output_6&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M7635,-291.65C7635,-268.12 7635,-230 7635,-230 7635,-230 7502.97,-230 7502.97,-230"/>
<polygon fill="black" stroke="black" points="7502.97,-226.5 7492.97,-230 7502.97,-233.5 7502.97,-226.5"/>
</g>
<!-- output_7&#45;&gt;output_concat -->
<g id="edge55" class="edge">
<title>output_7&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M7736,-291.5C7736,-261.49 7736,-205 7736,-205 7736,-205 7485.94,-205 7485.94,-205"/>
<polygon fill="black" stroke="black" points="7485.94,-201.5 7475.94,-205 7485.94,-208.5 7485.94,-201.5"/>
</g>
<!-- final_output -->
<g id="node60" class="node">
<title>final_output</title>
<ellipse fill="#e8f4fd" stroke="black" cx="7382" cy="-116.87" rx="82.05" ry="26.74"/>
<text text-anchor="middle" x="7382" y="-120.67" font-family="monospace" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="7382" y="-105.67" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- output_concat&#45;&gt;final_output -->
<g id="edge56" class="edge">
<title>output_concat&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M7382,-179.61C7382,-179.61 7382,-153.75 7382,-153.75"/>
<polygon fill="black" stroke="black" points="7385.5,-153.75 7382,-143.75 7378.5,-153.75 7385.5,-153.75"/>
</g>
<!-- embed_gather -->
<g id="node69" class="node">
<title>embed_gather</title>
<polygon fill="lightgrey" stroke="black" points="463,-866.74 347,-866.74 347,-830.74 463,-830.74 463,-866.74"/>
<text text-anchor="middle" x="405" y="-845.04" font-family="monospace" font-size="14.00">embed_gather</text>
</g>
<!-- embed_0&#45;&gt;embed_gather -->
<g id="edge12" class="edge">
<title>embed_0&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M37,-997.49C37,-952.33 37,-839 37,-839 37,-839 336.69,-839 336.69,-839"/>
<polygon fill="black" stroke="black" points="336.69,-842.5 346.69,-839 336.69,-835.5 336.69,-842.5"/>
</g>
<!-- embed_1&#45;&gt;embed_gather -->
<g id="edge13" class="edge">
<title>embed_1&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M129,-997.47C129,-954 129,-848 129,-848 129,-848 336.8,-848 336.8,-848"/>
<polygon fill="black" stroke="black" points="336.8,-851.5 346.8,-848 336.8,-844.5 336.8,-851.5"/>
</g>
<!-- embed_2&#45;&gt;embed_gather -->
<g id="edge14" class="edge">
<title>embed_2&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M221,-997.53C221,-955.83 221,-857 221,-857 221,-857 336.78,-857 336.78,-857"/>
<polygon fill="black" stroke="black" points="336.78,-860.5 346.78,-857 336.78,-853.5 336.78,-860.5"/>
</g>
<!-- embed_3&#45;&gt;embed_gather -->
<g id="edge15" class="edge">
<title>embed_3&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M350.13,-1015C355.36,-1015 359,-1015 359,-1015 359,-1015 359,-876.85 359,-876.85"/>
<polygon fill="black" stroke="black" points="362.5,-876.85 359,-866.85 355.5,-876.85 362.5,-876.85"/>
</g>
<!-- embed_4&#45;&gt;embed_gather -->
<g id="edge16" class="edge">
<title>embed_4&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M405,-997.55C405,-997.55 405,-876.91 405,-876.91"/>
<polygon fill="black" stroke="black" points="408.5,-876.91 405,-866.91 401.5,-876.91 408.5,-876.91"/>
</g>
<!-- embed_5&#45;&gt;embed_gather -->
<g id="edge17" class="edge">
<title>embed_5&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M459.87,-1015C454.64,-1015 451,-1015 451,-1015 451,-1015 451,-876.85 451,-876.85"/>
<polygon fill="black" stroke="black" points="454.5,-876.85 451,-866.85 447.5,-876.85 454.5,-876.85"/>
</g>
<!-- embed_6&#45;&gt;embed_gather -->
<g id="edge18" class="edge">
<title>embed_6&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M589,-997.53C589,-955.83 589,-857 589,-857 589,-857 473.22,-857 473.22,-857"/>
<polygon fill="black" stroke="black" points="473.22,-853.5 463.22,-857 473.22,-860.5 473.22,-853.5"/>
</g>
<!-- embed_7&#45;&gt;embed_gather -->
<g id="edge19" class="edge">
<title>embed_7&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M681,-997.47C681,-954 681,-848 681,-848 681,-848 473.2,-848 473.2,-848"/>
<polygon fill="black" stroke="black" points="473.2,-844.5 463.2,-848 473.2,-851.5 473.2,-844.5"/>
</g>
<!-- embed_gather&#45;&gt;pos_enc -->
<g id="edge20" class="edge">
<title>embed_gather&#45;&gt;pos_enc</title>
<path fill="none" stroke="black" d="M463.36,-839C561.52,-839 749.04,-839 749.04,-839 749.04,-839 749.04,-1146.67 749.04,-1146.67"/>
<polygon fill="black" stroke="black" points="745.54,-1146.67 749.04,-1156.67 752.54,-1146.67 745.54,-1146.67"/>
</g>
</g>
</svg>
