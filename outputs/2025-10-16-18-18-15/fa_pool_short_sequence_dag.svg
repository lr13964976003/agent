<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: fa_pool_short_sequence_dag Pages: 1 -->
<svg width="3798pt" height="3032pt"
 viewBox="0.00 0.00 3798.00 3031.69" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 3027.69)">
<title>fa_pool_short_sequence_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3027.69 3794,-3027.69 3794,4 -4,4"/>
<text text-anchor="middle" x="1895" y="-32" font-family="Times,serif" font-size="20.00">FA Pool &#45; Short Sequence (≤4096 tokens)</text>
<text text-anchor="middle" x="1895" y="-10" font-family="Times,serif" font-size="20.00">Base Layer GPUs: 8</text>
<g id="clust1" class="cluster">
<title>cluster_base_layer</title>
<path fill="none" stroke="black" d="M20,-60C20,-60 3770,-60 3770,-60 3776,-60 3782,-66 3782,-72 3782,-72 3782,-2766.74 3782,-2766.74 3782,-2772.74 3776,-2778.74 3770,-2778.74 3770,-2778.74 20,-2778.74 20,-2778.74 14,-2778.74 8,-2772.74 8,-2766.74 8,-2766.74 8,-72 8,-72 8,-66 14,-60 20,-60"/>
<text text-anchor="middle" x="1895" y="-2758.74" font-family="Times,serif" font-size="20.00">Base Layer (Always Active &#45; 8 GPUs)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer0_base</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1582,-1660.74 1582,-2194.74 2158,-2194.74 2158,-1660.74 1582,-1660.74"/>
<text text-anchor="middle" x="1870" y="-2174.74" font-family="Times,serif" font-size="20.00">Layer 0 &#45; Base Layer</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer1_base</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1757,-1257.74 1757,-1641.74 1984,-1641.74 1984,-1257.74 1757,-1257.74"/>
<text text-anchor="middle" x="1870.5" y="-1621.74" font-family="Times,serif" font-size="20.00">Layer 1 &#45; Base Layer</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer2_base</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1757,-854.74 1757,-1238.74 1984,-1238.74 1984,-854.74 1757,-854.74"/>
<text text-anchor="middle" x="1870.5" y="-1218.74" font-family="Times,serif" font-size="20.00">Layer 2 &#45; Base Layer</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer3_base</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1757,-451.74 1757,-835.74 1984,-835.74 1984,-451.74 1757,-451.74"/>
<text text-anchor="middle" x="1870.5" y="-815.74" font-family="Times,serif" font-size="20.00">Layer 3 &#45; Base Layer</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="#e8f4fd" stroke="black" cx="1894" cy="-2986.22" rx="321.05" ry="37.45"/>
<text text-anchor="middle" x="1894" y="-2997.52" font-family="monospace" font-size="14.00">Input (Short Seq)</text>
<text text-anchor="middle" x="1894" y="-2982.52" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=≤4096, d_model=4096]</text>
<text text-anchor="middle" x="1894" y="-2967.52" font-family="monospace" font-size="14.00">GPU: Host</text>
</g>
<!-- seq_check -->
<g id="node2" class="node">
<title>seq_check</title>
<polygon fill="#ffe4b5" stroke="black" points="2159.32,-2911.74 1737.26,-2911.74 1628.68,-2805.74 2050.74,-2805.74 2159.32,-2911.74"/>
<text text-anchor="middle" x="1894" y="-2870.04" font-family="monospace" font-size="14.00">Sequence Length Check</text>
<text text-anchor="middle" x="1894" y="-2855.04" font-family="monospace" font-size="14.00">Threshold: 4096 tokens</text>
<text text-anchor="middle" x="1894" y="-2840.04" font-family="monospace" font-size="14.00">Decision: Use Base Layer Only</text>
</g>
<!-- input&#45;&gt;seq_check -->
<g id="edge1" class="edge">
<title>input&#45;&gt;seq_check</title>
<path fill="none" stroke="black" d="M1894,-2948.66C1894,-2948.66 1894,-2922.09 1894,-2922.09"/>
<polygon fill="black" stroke="black" points="1897.5,-2922.09 1894,-2912.09 1890.5,-2922.09 1897.5,-2922.09"/>
</g>
<!-- embed_split -->
<g id="node3" class="node">
<title>embed_split</title>
<polygon fill="#ffe4b5" stroke="black" points="2381.05,-2740.74 1606.26,-2740.74 1406.95,-2604.74 2181.74,-2604.74 2381.05,-2740.74"/>
<text text-anchor="middle" x="1894" y="-2691.54" font-family="monospace" font-size="14.00">Split Embedding (TP=8)</text>
<text text-anchor="middle" x="1894" y="-2676.54" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=≤4096, d_model=4096]</text>
<text text-anchor="middle" x="1894" y="-2661.54" font-family="monospace" font-size="14.00">Output: 8×[batch_size=1024, seq_len=≤4096, d_model=512]</text>
<text text-anchor="middle" x="1894" y="-2646.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- seq_check&#45;&gt;embed_split -->
<g id="edge2" class="edge">
<title>seq_check&#45;&gt;embed_split</title>
<path fill="none" stroke="black" d="M1894,-2805.44C1894,-2805.44 1894,-2751 1894,-2751"/>
<polygon fill="black" stroke="black" points="1897.5,-2751 1894,-2741 1890.5,-2751 1897.5,-2751"/>
</g>
<!-- embed_0 -->
<g id="node4" class="node">
<title>embed_0</title>
<polygon fill="#90ee90" stroke="black" points="470,-2567.74 16,-2567.74 16,-2499.74 470,-2499.74 470,-2567.74"/>
<text text-anchor="middle" x="243" y="-2552.54" font-family="monospace" font-size="14.00">Embedding GPU0</text>
<text text-anchor="middle" x="243" y="-2537.54" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=≤4096, d_model=512]</text>
<text text-anchor="middle" x="243" y="-2522.54" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=≤4096, d_model=512]</text>
<text text-anchor="middle" x="243" y="-2507.54" font-family="monospace" font-size="14.00">GPU: gpu_0</text>
</g>
<!-- embed_split&#45;&gt;embed_0 -->
<g id="edge3" class="edge">
<title>embed_split&#45;&gt;embed_0</title>
<path fill="none" stroke="black" d="M1539.06,-2695C1053.85,-2695 243,-2695 243,-2695 243,-2695 243,-2577.94 243,-2577.94"/>
<polygon fill="black" stroke="black" points="246.5,-2577.94 243,-2567.94 239.5,-2577.94 246.5,-2577.94"/>
</g>
<!-- embed_1 -->
<g id="node5" class="node">
<title>embed_1</title>
<polygon fill="#90ee90" stroke="black" points="942,-2567.74 488,-2567.74 488,-2499.74 942,-2499.74 942,-2567.74"/>
<text text-anchor="middle" x="715" y="-2552.54" font-family="monospace" font-size="14.00">Embedding GPU1</text>
<text text-anchor="middle" x="715" y="-2537.54" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=≤4096, d_model=512]</text>
<text text-anchor="middle" x="715" y="-2522.54" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=≤4096, d_model=512]</text>
<text text-anchor="middle" x="715" y="-2507.54" font-family="monospace" font-size="14.00">GPU: gpu_1</text>
</g>
<!-- embed_split&#45;&gt;embed_1 -->
<g id="edge4" class="edge">
<title>embed_split&#45;&gt;embed_1</title>
<path fill="none" stroke="black" d="M1472.93,-2650C1134.41,-2650 715,-2650 715,-2650 715,-2650 715,-2577.99 715,-2577.99"/>
<polygon fill="black" stroke="black" points="718.5,-2577.99 715,-2567.99 711.5,-2577.99 718.5,-2577.99"/>
</g>
<!-- embed_2 -->
<g id="node6" class="node">
<title>embed_2</title>
<polygon fill="#90ee90" stroke="black" points="1414,-2567.74 960,-2567.74 960,-2499.74 1414,-2499.74 1414,-2567.74"/>
<text text-anchor="middle" x="1187" y="-2552.54" font-family="monospace" font-size="14.00">Embedding GPU2</text>
<text text-anchor="middle" x="1187" y="-2537.54" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=≤4096, d_model=512]</text>
<text text-anchor="middle" x="1187" y="-2522.54" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=≤4096, d_model=512]</text>
<text text-anchor="middle" x="1187" y="-2507.54" font-family="monospace" font-size="14.00">GPU: gpu_2</text>
</g>
<!-- embed_split&#45;&gt;embed_2 -->
<g id="edge5" class="edge">
<title>embed_split&#45;&gt;embed_2</title>
<path fill="none" stroke="black" d="M1410.36,-2672.64C1410.36,-2672.64 1410.36,-2577.88 1410.36,-2577.88"/>
<polygon fill="black" stroke="black" points="1413.86,-2577.88 1410.36,-2567.88 1406.86,-2577.88 1413.86,-2577.88"/>
</g>
<!-- embed_3 -->
<g id="node7" class="node">
<title>embed_3</title>
<polygon fill="#90ee90" stroke="black" points="1886,-2567.74 1432,-2567.74 1432,-2499.74 1886,-2499.74 1886,-2567.74"/>
<text text-anchor="middle" x="1659" y="-2552.54" font-family="monospace" font-size="14.00">Embedding GPU3</text>
<text text-anchor="middle" x="1659" y="-2537.54" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=≤4096, d_model=512]</text>
<text text-anchor="middle" x="1659" y="-2522.54" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=≤4096, d_model=512]</text>
<text text-anchor="middle" x="1659" y="-2507.54" font-family="monospace" font-size="14.00">GPU: gpu_3</text>
</g>
<!-- embed_split&#45;&gt;embed_3 -->
<g id="edge6" class="edge">
<title>embed_split&#45;&gt;embed_3</title>
<path fill="none" stroke="black" d="M1659,-2604.46C1659,-2604.46 1659,-2578.07 1659,-2578.07"/>
<polygon fill="black" stroke="black" points="1662.5,-2578.07 1659,-2568.07 1655.5,-2578.07 1662.5,-2578.07"/>
</g>
<!-- embed_4 -->
<g id="node8" class="node">
<title>embed_4</title>
<polygon fill="#90ee90" stroke="black" points="2358,-2567.74 1904,-2567.74 1904,-2499.74 2358,-2499.74 2358,-2567.74"/>
<text text-anchor="middle" x="2131" y="-2552.54" font-family="monospace" font-size="14.00">Embedding GPU4</text>
<text text-anchor="middle" x="2131" y="-2537.54" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=≤4096, d_model=512]</text>
<text text-anchor="middle" x="2131" y="-2522.54" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=≤4096, d_model=512]</text>
<text text-anchor="middle" x="2131" y="-2507.54" font-family="monospace" font-size="14.00">GPU: gpu_4</text>
</g>
<!-- embed_split&#45;&gt;embed_4 -->
<g id="edge7" class="edge">
<title>embed_split&#45;&gt;embed_4</title>
<path fill="none" stroke="black" d="M2131,-2604.46C2131,-2604.46 2131,-2578.07 2131,-2578.07"/>
<polygon fill="black" stroke="black" points="2134.5,-2578.07 2131,-2568.07 2127.5,-2578.07 2134.5,-2578.07"/>
</g>
<!-- embed_5 -->
<g id="node9" class="node">
<title>embed_5</title>
<polygon fill="#90ee90" stroke="black" points="2830,-2567.74 2376,-2567.74 2376,-2499.74 2830,-2499.74 2830,-2567.74"/>
<text text-anchor="middle" x="2603" y="-2552.54" font-family="monospace" font-size="14.00">Embedding GPU5</text>
<text text-anchor="middle" x="2603" y="-2537.54" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=≤4096, d_model=512]</text>
<text text-anchor="middle" x="2603" y="-2522.54" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=≤4096, d_model=512]</text>
<text text-anchor="middle" x="2603" y="-2507.54" font-family="monospace" font-size="14.00">GPU: gpu_5</text>
</g>
<!-- embed_split&#45;&gt;embed_5 -->
<g id="edge8" class="edge">
<title>embed_split&#45;&gt;embed_5</title>
<path fill="none" stroke="black" d="M2367.99,-2672.65C2367.99,-2668.78 2367.99,-2545 2367.99,-2545 2367.99,-2545 2368.77,-2545 2368.77,-2545"/>
<polygon fill="black" stroke="black" points="2365.81,-2548.5 2375.81,-2545 2365.81,-2541.5 2365.81,-2548.5"/>
</g>
<!-- embed_6 -->
<g id="node10" class="node">
<title>embed_6</title>
<polygon fill="#90ee90" stroke="black" points="3302,-2567.74 2848,-2567.74 2848,-2499.74 3302,-2499.74 3302,-2567.74"/>
<text text-anchor="middle" x="3075" y="-2552.54" font-family="monospace" font-size="14.00">Embedding GPU6</text>
<text text-anchor="middle" x="3075" y="-2537.54" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=≤4096, d_model=512]</text>
<text text-anchor="middle" x="3075" y="-2522.54" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=≤4096, d_model=512]</text>
<text text-anchor="middle" x="3075" y="-2507.54" font-family="monospace" font-size="14.00">GPU: gpu_6</text>
</g>
<!-- embed_split&#45;&gt;embed_6 -->
<g id="edge9" class="edge">
<title>embed_split&#45;&gt;embed_6</title>
<path fill="none" stroke="black" d="M2248.34,-2650C2596.21,-2650 3075,-2650 3075,-2650 3075,-2650 3075,-2577.99 3075,-2577.99"/>
<polygon fill="black" stroke="black" points="3078.5,-2577.99 3075,-2567.99 3071.5,-2577.99 3078.5,-2577.99"/>
</g>
<!-- embed_7 -->
<g id="node11" class="node">
<title>embed_7</title>
<polygon fill="#90ee90" stroke="black" points="3774,-2567.74 3320,-2567.74 3320,-2499.74 3774,-2499.74 3774,-2567.74"/>
<text text-anchor="middle" x="3547" y="-2552.54" font-family="monospace" font-size="14.00">Embedding GPU7</text>
<text text-anchor="middle" x="3547" y="-2537.54" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=≤4096, d_model=512]</text>
<text text-anchor="middle" x="3547" y="-2522.54" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=≤4096, d_model=512]</text>
<text text-anchor="middle" x="3547" y="-2507.54" font-family="monospace" font-size="14.00">GPU: gpu_7</text>
</g>
<!-- embed_split&#45;&gt;embed_7 -->
<g id="edge10" class="edge">
<title>embed_split&#45;&gt;embed_7</title>
<path fill="none" stroke="black" d="M2314.06,-2695C2803.79,-2695 3547,-2695 3547,-2695 3547,-2695 3547,-2577.94 3547,-2577.94"/>
<polygon fill="black" stroke="black" points="3550.5,-2577.94 3547,-2567.94 3543.5,-2577.94 3550.5,-2577.94"/>
</g>
<!-- embed_gather -->
<g id="node12" class="node">
<title>embed_gather</title>
<polygon fill="#ffe4b5" stroke="black" points="2372.96,-2462.74 1611.04,-2462.74 1415.04,-2326.74 2176.96,-2326.74 2372.96,-2462.74"/>
<text text-anchor="middle" x="1894" y="-2413.54" font-family="monospace" font-size="14.00">All&#45;Gather (TP=8)</text>
<text text-anchor="middle" x="1894" y="-2398.54" font-family="monospace" font-size="14.00">Input: 8×[batch_size=1024, seq_len=≤4096, d_model=512]</text>
<text text-anchor="middle" x="1894" y="-2383.54" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=≤4096, d_model=4096]</text>
<text text-anchor="middle" x="1894" y="-2368.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- embed_0&#45;&gt;embed_gather -->
<g id="edge11" class="edge">
<title>embed_0&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M243,-2499.44C243,-2451.96 243,-2372 243,-2372 243,-2372 1470.05,-2372 1470.05,-2372"/>
<polygon fill="black" stroke="black" points="1470.05,-2375.5 1480.05,-2372 1470.05,-2368.5 1470.05,-2375.5"/>
</g>
<!-- embed_1&#45;&gt;embed_gather -->
<g id="edge12" class="edge">
<title>embed_1&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M715,-2499.66C715,-2465.2 715,-2417 715,-2417 715,-2417 1535.05,-2417 1535.05,-2417"/>
<polygon fill="black" stroke="black" points="1535.05,-2420.5 1545.05,-2417 1535.05,-2413.5 1535.05,-2420.5"/>
</g>
<!-- embed_2&#45;&gt;embed_gather -->
<g id="edge13" class="edge">
<title>embed_2&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M1414.24,-2533C1420.15,-2533 1423.51,-2533 1423.51,-2533 1423.51,-2533 1423.51,-2404.84 1423.51,-2404.84"/>
<polygon fill="black" stroke="black" points="1427.01,-2404.84 1423.51,-2394.84 1420.01,-2404.84 1427.01,-2404.84"/>
</g>
<!-- embed_3&#45;&gt;embed_gather -->
<g id="edge14" class="edge">
<title>embed_3&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M1659,-2499.74C1659,-2499.74 1659,-2472.93 1659,-2472.93"/>
<polygon fill="black" stroke="black" points="1662.5,-2472.93 1659,-2462.93 1655.5,-2472.94 1662.5,-2472.93"/>
</g>
<!-- embed_4&#45;&gt;embed_gather -->
<g id="edge15" class="edge">
<title>embed_4&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M2131,-2499.74C2131,-2499.74 2131,-2472.93 2131,-2472.93"/>
<polygon fill="black" stroke="black" points="2134.5,-2472.93 2131,-2462.93 2127.5,-2472.94 2134.5,-2472.93"/>
</g>
<!-- embed_5&#45;&gt;embed_gather -->
<g id="edge16" class="edge">
<title>embed_5&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M2375.9,-2522C2367.74,-2522 2362.99,-2522 2362.99,-2522 2362.99,-2522 2362.99,-2472.84 2362.99,-2472.84"/>
<polygon fill="black" stroke="black" points="2366.49,-2472.84 2362.99,-2462.84 2359.49,-2472.84 2366.49,-2472.84"/>
</g>
<!-- embed_6&#45;&gt;embed_gather -->
<g id="edge17" class="edge">
<title>embed_6&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M3075,-2499.66C3075,-2465.2 3075,-2417 3075,-2417 3075,-2417 2317.06,-2417 2317.06,-2417"/>
<polygon fill="black" stroke="black" points="2317.06,-2413.5 2307.06,-2417 2317.06,-2420.5 2317.06,-2413.5"/>
</g>
<!-- embed_7&#45;&gt;embed_gather -->
<g id="edge18" class="edge">
<title>embed_7&#45;&gt;embed_gather</title>
<path fill="none" stroke="black" d="M3547,-2499.44C3547,-2451.96 3547,-2372 3547,-2372 3547,-2372 2252.29,-2372 2252.29,-2372"/>
<polygon fill="black" stroke="black" points="2252.29,-2368.5 2242.29,-2372 2252.29,-2375.5 2252.29,-2368.5"/>
</g>
<!-- pos_enc -->
<g id="node13" class="node">
<title>pos_enc</title>
<polygon fill="#87ceeb" stroke="black" points="2125,-2289.74 1663,-2289.74 1663,-2221.74 2125,-2221.74 2125,-2289.74"/>
<text text-anchor="middle" x="1894" y="-2274.54" font-family="monospace" font-size="14.00">Positional Encoding</text>
<text text-anchor="middle" x="1894" y="-2259.54" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=≤4096, d_model=4096]</text>
<text text-anchor="middle" x="1894" y="-2244.54" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=≤4096, d_model=4096]</text>
<text text-anchor="middle" x="1894" y="-2229.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- embed_gather&#45;&gt;pos_enc -->
<g id="edge19" class="edge">
<title>embed_gather&#45;&gt;pos_enc</title>
<path fill="none" stroke="black" d="M1894,-2326.46C1894,-2326.46 1894,-2300.07 1894,-2300.07"/>
<polygon fill="black" stroke="black" points="1897.5,-2300.07 1894,-2290.07 1890.5,-2300.07 1897.5,-2300.07"/>
</g>
<!-- layernorm_0 -->
<g id="node14" class="node">
<title>layernorm_0</title>
<polygon fill="#dda0dd" stroke="black" points="2125,-2156.74 1663,-2156.74 1663,-2088.74 2125,-2088.74 2125,-2156.74"/>
<text text-anchor="middle" x="1894" y="-2141.54" font-family="monospace" font-size="14.00">LayerNorm 0</text>
<text text-anchor="middle" x="1894" y="-2126.54" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=≤4096, d_model=4096]</text>
<text text-anchor="middle" x="1894" y="-2111.54" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=≤4096, d_model=4096]</text>
<text text-anchor="middle" x="1894" y="-2096.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- pos_enc&#45;&gt;layernorm_0 -->
<g id="edge20" class="edge">
<title>pos_enc&#45;&gt;layernorm_0</title>
<path fill="none" stroke="black" d="M1894,-2221.49C1894,-2221.49 1894,-2166.87 1894,-2166.87"/>
<polygon fill="black" stroke="black" points="1897.5,-2166.87 1894,-2156.87 1890.5,-2166.87 1897.5,-2166.87"/>
</g>
<!-- attn_base_0 -->
<g id="node15" class="node">
<title>attn_base_0</title>
<polygon fill="#ffd700" stroke="black" points="2052,-2051.74 1590,-2051.74 1590,-1983.74 2052,-1983.74 2052,-2051.74"/>
<text text-anchor="middle" x="1821" y="-2036.54" font-family="monospace" font-size="14.00">Flash Attention Base</text>
<text text-anchor="middle" x="1821" y="-2021.54" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=≤4096, d_model=4096]</text>
<text text-anchor="middle" x="1821" y="-2006.54" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=≤4096, d_model=4096]</text>
<text text-anchor="middle" x="1821" y="-1991.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- layernorm_0&#45;&gt;attn_base_0 -->
<g id="edge21" class="edge">
<title>layernorm_0&#45;&gt;attn_base_0</title>
<path fill="none" stroke="black" d="M1857.5,-2088.65C1857.5,-2088.65 1857.5,-2062.02 1857.5,-2062.02"/>
<polygon fill="black" stroke="black" points="1861,-2062.02 1857.5,-2052.02 1854,-2062.02 1861,-2062.02"/>
</g>
<!-- residual_0 -->
<g id="node16" class="node">
<title>residual_0</title>
<polygon fill="#dda0dd" stroke="black" points="2101,-1946.74 1639,-1946.74 1639,-1878.74 2101,-1878.74 2101,-1946.74"/>
<text text-anchor="middle" x="1870" y="-1931.54" font-family="monospace" font-size="14.00">Residual Add 0</text>
<text text-anchor="middle" x="1870" y="-1916.54" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=≤4096, d_model=4096]</text>
<text text-anchor="middle" x="1870" y="-1901.54" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=≤4096, d_model=4096]</text>
<text text-anchor="middle" x="1870" y="-1886.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layernorm_0&#45;&gt;residual_0 -->
<g id="edge23" class="edge">
<title>layernorm_0&#45;&gt;residual_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2076.5,-2088.53C2076.5,-2088.53 2076.5,-1956.93 2076.5,-1956.93"/>
<polygon fill="black" stroke="black" points="2080,-1956.93 2076.5,-1946.93 2073,-1956.93 2080,-1956.93"/>
<text text-anchor="middle" x="2119" y="-2014.04" font-family="Times,serif" font-size="14.00">Residual</text>
</g>
<!-- attn_base_0&#45;&gt;residual_0 -->
<g id="edge22" class="edge">
<title>attn_base_0&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M1845.5,-1983.65C1845.5,-1983.65 1845.5,-1957.02 1845.5,-1957.02"/>
<polygon fill="black" stroke="black" points="1849,-1957.02 1845.5,-1947.02 1842,-1957.02 1849,-1957.02"/>
</g>
<!-- ffn_0 -->
<g id="node17" class="node">
<title>ffn_0</title>
<polygon fill="#98fb98" stroke="black" points="2052,-1841.74 1590,-1841.74 1590,-1773.74 2052,-1773.74 2052,-1841.74"/>
<text text-anchor="middle" x="1821" y="-1826.54" font-family="monospace" font-size="14.00">FFN 0</text>
<text text-anchor="middle" x="1821" y="-1811.54" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=≤4096, d_model=4096]</text>
<text text-anchor="middle" x="1821" y="-1796.54" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=≤4096, d_model=4096]</text>
<text text-anchor="middle" x="1821" y="-1781.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7 (TP=8)</text>
</g>
<!-- residual_0&#45;&gt;ffn_0 -->
<g id="edge24" class="edge">
<title>residual_0&#45;&gt;ffn_0</title>
<path fill="none" stroke="black" d="M1845.5,-1878.65C1845.5,-1878.65 1845.5,-1852.02 1845.5,-1852.02"/>
<polygon fill="black" stroke="black" points="1849,-1852.02 1845.5,-1842.02 1842,-1852.02 1849,-1852.02"/>
</g>
<!-- residual_0_ffn -->
<g id="node18" class="node">
<title>residual_0_ffn</title>
<polygon fill="#dda0dd" stroke="black" points="2101,-1736.74 1639,-1736.74 1639,-1668.74 2101,-1668.74 2101,-1736.74"/>
<text text-anchor="middle" x="1870" y="-1721.54" font-family="monospace" font-size="14.00">Residual Add 0 FFN</text>
<text text-anchor="middle" x="1870" y="-1706.54" font-family="monospace" font-size="14.00">Input: [batch_size=1024, seq_len=≤4096, d_model=4096]</text>
<text text-anchor="middle" x="1870" y="-1691.54" font-family="monospace" font-size="14.00">Output: [batch_size=1024, seq_len=≤4096, d_model=4096]</text>
<text text-anchor="middle" x="1870" y="-1676.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- residual_0&#45;&gt;residual_0_ffn -->
<g id="edge26" class="edge">
<title>residual_0&#45;&gt;residual_0_ffn</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2076.5,-1878.53C2076.5,-1878.53 2076.5,-1746.93 2076.5,-1746.93"/>
<polygon fill="black" stroke="black" points="2080,-1746.93 2076.5,-1736.93 2073,-1746.93 2080,-1746.93"/>
<text text-anchor="middle" x="2119" y="-1804.04" font-family="Times,serif" font-size="14.00">Residual</text>
</g>
<!-- ffn_0&#45;&gt;residual_0_ffn -->
<g id="edge25" class="edge">
<title>ffn_0&#45;&gt;residual_0_ffn</title>
<path fill="none" stroke="black" d="M1845.5,-1773.65C1845.5,-1773.65 1845.5,-1747.02 1845.5,-1747.02"/>
<polygon fill="black" stroke="black" points="1849,-1747.02 1845.5,-1737.02 1842,-1747.02 1849,-1747.02"/>
</g>
<!-- layernorm_1 -->
<g id="node19" class="node">
<title>layernorm_1</title>
<polygon fill="#dda0dd" stroke="black" points="1923.5,-1603.74 1816.5,-1603.74 1816.5,-1565.74 1923.5,-1565.74 1923.5,-1603.74"/>
<text text-anchor="middle" x="1870" y="-1588.54" font-family="monospace" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="1870" y="-1573.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- residual_0_ffn&#45;&gt;layernorm_1 -->
<g id="edge27" class="edge">
<title>residual_0_ffn&#45;&gt;layernorm_1</title>
<path fill="none" stroke="black" d="M1870,-1668.61C1870,-1668.61 1870,-1613.75 1870,-1613.75"/>
<polygon fill="black" stroke="black" points="1873.5,-1613.75 1870,-1603.75 1866.5,-1613.75 1873.5,-1613.75"/>
</g>
<!-- attn_base_1 -->
<g id="node20" class="node">
<title>attn_base_1</title>
<polygon fill="#ffd700" stroke="black" points="1961,-1528.74 1779,-1528.74 1779,-1490.74 1961,-1490.74 1961,-1528.74"/>
<text text-anchor="middle" x="1870" y="-1513.54" font-family="monospace" font-size="14.00">Flash Attention Base</text>
<text text-anchor="middle" x="1870" y="-1498.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layernorm_1&#45;&gt;attn_base_1 -->
<g id="edge28" class="edge">
<title>layernorm_1&#45;&gt;attn_base_1</title>
<path fill="none" stroke="black" d="M1870,-1565.43C1870,-1565.43 1870,-1538.99 1870,-1538.99"/>
<polygon fill="black" stroke="black" points="1873.5,-1538.99 1870,-1528.99 1866.5,-1538.99 1873.5,-1538.99"/>
</g>
<!-- residual_1 -->
<g id="node21" class="node">
<title>residual_1</title>
<polygon fill="#dda0dd" stroke="black" points="1936,-1453.74 1804,-1453.74 1804,-1415.74 1936,-1415.74 1936,-1453.74"/>
<text text-anchor="middle" x="1870" y="-1438.54" font-family="monospace" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1870" y="-1423.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- attn_base_1&#45;&gt;residual_1 -->
<g id="edge29" class="edge">
<title>attn_base_1&#45;&gt;residual_1</title>
<path fill="none" stroke="black" d="M1870,-1490.43C1870,-1490.43 1870,-1463.99 1870,-1463.99"/>
<polygon fill="black" stroke="black" points="1873.5,-1463.99 1870,-1453.99 1866.5,-1463.99 1873.5,-1463.99"/>
</g>
<!-- ffn_1 -->
<g id="node22" class="node">
<title>ffn_1</title>
<polygon fill="#98fb98" stroke="black" points="1911.5,-1378.74 1828.5,-1378.74 1828.5,-1340.74 1911.5,-1340.74 1911.5,-1378.74"/>
<text text-anchor="middle" x="1870" y="-1363.54" font-family="monospace" font-size="14.00">FFN 1</text>
<text text-anchor="middle" x="1870" y="-1348.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- residual_1&#45;&gt;ffn_1 -->
<g id="edge30" class="edge">
<title>residual_1&#45;&gt;ffn_1</title>
<path fill="none" stroke="black" d="M1870,-1415.43C1870,-1415.43 1870,-1388.99 1870,-1388.99"/>
<polygon fill="black" stroke="black" points="1873.5,-1388.99 1870,-1378.99 1866.5,-1388.99 1873.5,-1388.99"/>
</g>
<!-- residual_1_ffn -->
<g id="node23" class="node">
<title>residual_1_ffn</title>
<polygon fill="#dda0dd" stroke="black" points="1952.5,-1303.74 1787.5,-1303.74 1787.5,-1265.74 1952.5,-1265.74 1952.5,-1303.74"/>
<text text-anchor="middle" x="1870" y="-1288.54" font-family="monospace" font-size="14.00">Residual Add 1 FFN</text>
<text text-anchor="middle" x="1870" y="-1273.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ffn_1&#45;&gt;residual_1_ffn -->
<g id="edge31" class="edge">
<title>ffn_1&#45;&gt;residual_1_ffn</title>
<path fill="none" stroke="black" d="M1870,-1340.43C1870,-1340.43 1870,-1313.99 1870,-1313.99"/>
<polygon fill="black" stroke="black" points="1873.5,-1313.99 1870,-1303.99 1866.5,-1313.99 1873.5,-1313.99"/>
</g>
<!-- layernorm_2 -->
<g id="node24" class="node">
<title>layernorm_2</title>
<polygon fill="#dda0dd" stroke="black" points="1923.5,-1200.74 1816.5,-1200.74 1816.5,-1162.74 1923.5,-1162.74 1923.5,-1200.74"/>
<text text-anchor="middle" x="1870" y="-1185.54" font-family="monospace" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="1870" y="-1170.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- residual_1_ffn&#45;&gt;layernorm_2 -->
<g id="edge32" class="edge">
<title>residual_1_ffn&#45;&gt;layernorm_2</title>
<path fill="none" stroke="black" d="M1870,-1265.37C1870,-1265.37 1870,-1211.03 1870,-1211.03"/>
<polygon fill="black" stroke="black" points="1873.5,-1211.03 1870,-1201.03 1866.5,-1211.03 1873.5,-1211.03"/>
</g>
<!-- attn_base_2 -->
<g id="node25" class="node">
<title>attn_base_2</title>
<polygon fill="#ffd700" stroke="black" points="1961,-1125.74 1779,-1125.74 1779,-1087.74 1961,-1087.74 1961,-1125.74"/>
<text text-anchor="middle" x="1870" y="-1110.54" font-family="monospace" font-size="14.00">Flash Attention Base</text>
<text text-anchor="middle" x="1870" y="-1095.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layernorm_2&#45;&gt;attn_base_2 -->
<g id="edge33" class="edge">
<title>layernorm_2&#45;&gt;attn_base_2</title>
<path fill="none" stroke="black" d="M1870,-1162.43C1870,-1162.43 1870,-1135.99 1870,-1135.99"/>
<polygon fill="black" stroke="black" points="1873.5,-1135.99 1870,-1125.99 1866.5,-1135.99 1873.5,-1135.99"/>
</g>
<!-- residual_2 -->
<g id="node26" class="node">
<title>residual_2</title>
<polygon fill="#dda0dd" stroke="black" points="1936,-1050.74 1804,-1050.74 1804,-1012.74 1936,-1012.74 1936,-1050.74"/>
<text text-anchor="middle" x="1870" y="-1035.54" font-family="monospace" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1870" y="-1020.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- attn_base_2&#45;&gt;residual_2 -->
<g id="edge34" class="edge">
<title>attn_base_2&#45;&gt;residual_2</title>
<path fill="none" stroke="black" d="M1870,-1087.43C1870,-1087.43 1870,-1060.99 1870,-1060.99"/>
<polygon fill="black" stroke="black" points="1873.5,-1060.99 1870,-1050.99 1866.5,-1060.99 1873.5,-1060.99"/>
</g>
<!-- ffn_2 -->
<g id="node27" class="node">
<title>ffn_2</title>
<polygon fill="#98fb98" stroke="black" points="1911.5,-975.74 1828.5,-975.74 1828.5,-937.74 1911.5,-937.74 1911.5,-975.74"/>
<text text-anchor="middle" x="1870" y="-960.54" font-family="monospace" font-size="14.00">FFN 2</text>
<text text-anchor="middle" x="1870" y="-945.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- residual_2&#45;&gt;ffn_2 -->
<g id="edge35" class="edge">
<title>residual_2&#45;&gt;ffn_2</title>
<path fill="none" stroke="black" d="M1870,-1012.43C1870,-1012.43 1870,-985.99 1870,-985.99"/>
<polygon fill="black" stroke="black" points="1873.5,-985.99 1870,-975.99 1866.5,-985.99 1873.5,-985.99"/>
</g>
<!-- residual_2_ffn -->
<g id="node28" class="node">
<title>residual_2_ffn</title>
<polygon fill="#dda0dd" stroke="black" points="1952.5,-900.74 1787.5,-900.74 1787.5,-862.74 1952.5,-862.74 1952.5,-900.74"/>
<text text-anchor="middle" x="1870" y="-885.54" font-family="monospace" font-size="14.00">Residual Add 2 FFN</text>
<text text-anchor="middle" x="1870" y="-870.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ffn_2&#45;&gt;residual_2_ffn -->
<g id="edge36" class="edge">
<title>ffn_2&#45;&gt;residual_2_ffn</title>
<path fill="none" stroke="black" d="M1870,-937.43C1870,-937.43 1870,-910.99 1870,-910.99"/>
<polygon fill="black" stroke="black" points="1873.5,-910.99 1870,-900.99 1866.5,-910.99 1873.5,-910.99"/>
</g>
<!-- layernorm_3 -->
<g id="node29" class="node">
<title>layernorm_3</title>
<polygon fill="#dda0dd" stroke="black" points="1923.5,-797.74 1816.5,-797.74 1816.5,-759.74 1923.5,-759.74 1923.5,-797.74"/>
<text text-anchor="middle" x="1870" y="-782.54" font-family="monospace" font-size="14.00">LayerNorm 3</text>
<text text-anchor="middle" x="1870" y="-767.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- residual_2_ffn&#45;&gt;layernorm_3 -->
<g id="edge37" class="edge">
<title>residual_2_ffn&#45;&gt;layernorm_3</title>
<path fill="none" stroke="black" d="M1870,-862.37C1870,-862.37 1870,-808.03 1870,-808.03"/>
<polygon fill="black" stroke="black" points="1873.5,-808.03 1870,-798.03 1866.5,-808.03 1873.5,-808.03"/>
</g>
<!-- attn_base_3 -->
<g id="node30" class="node">
<title>attn_base_3</title>
<polygon fill="#ffd700" stroke="black" points="1961,-722.74 1779,-722.74 1779,-684.74 1961,-684.74 1961,-722.74"/>
<text text-anchor="middle" x="1870" y="-707.54" font-family="monospace" font-size="14.00">Flash Attention Base</text>
<text text-anchor="middle" x="1870" y="-692.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layernorm_3&#45;&gt;attn_base_3 -->
<g id="edge38" class="edge">
<title>layernorm_3&#45;&gt;attn_base_3</title>
<path fill="none" stroke="black" d="M1870,-759.43C1870,-759.43 1870,-732.99 1870,-732.99"/>
<polygon fill="black" stroke="black" points="1873.5,-732.99 1870,-722.99 1866.5,-732.99 1873.5,-732.99"/>
</g>
<!-- residual_3 -->
<g id="node31" class="node">
<title>residual_3</title>
<polygon fill="#dda0dd" stroke="black" points="1936,-647.74 1804,-647.74 1804,-609.74 1936,-609.74 1936,-647.74"/>
<text text-anchor="middle" x="1870" y="-632.54" font-family="monospace" font-size="14.00">Residual Add 3</text>
<text text-anchor="middle" x="1870" y="-617.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- attn_base_3&#45;&gt;residual_3 -->
<g id="edge39" class="edge">
<title>attn_base_3&#45;&gt;residual_3</title>
<path fill="none" stroke="black" d="M1870,-684.43C1870,-684.43 1870,-657.99 1870,-657.99"/>
<polygon fill="black" stroke="black" points="1873.5,-657.99 1870,-647.99 1866.5,-657.99 1873.5,-657.99"/>
</g>
<!-- ffn_3 -->
<g id="node32" class="node">
<title>ffn_3</title>
<polygon fill="#98fb98" stroke="black" points="1911.5,-572.74 1828.5,-572.74 1828.5,-534.74 1911.5,-534.74 1911.5,-572.74"/>
<text text-anchor="middle" x="1870" y="-557.54" font-family="monospace" font-size="14.00">FFN 3</text>
<text text-anchor="middle" x="1870" y="-542.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- residual_3&#45;&gt;ffn_3 -->
<g id="edge40" class="edge">
<title>residual_3&#45;&gt;ffn_3</title>
<path fill="none" stroke="black" d="M1870,-609.43C1870,-609.43 1870,-582.99 1870,-582.99"/>
<polygon fill="black" stroke="black" points="1873.5,-582.99 1870,-572.99 1866.5,-582.99 1873.5,-582.99"/>
</g>
<!-- residual_3_ffn -->
<g id="node33" class="node">
<title>residual_3_ffn</title>
<polygon fill="#dda0dd" stroke="black" points="1952.5,-497.74 1787.5,-497.74 1787.5,-459.74 1952.5,-459.74 1952.5,-497.74"/>
<text text-anchor="middle" x="1870" y="-482.54" font-family="monospace" font-size="14.00">Residual Add 3 FFN</text>
<text text-anchor="middle" x="1870" y="-467.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ffn_3&#45;&gt;residual_3_ffn -->
<g id="edge41" class="edge">
<title>ffn_3&#45;&gt;residual_3_ffn</title>
<path fill="none" stroke="black" d="M1870,-534.43C1870,-534.43 1870,-507.99 1870,-507.99"/>
<polygon fill="black" stroke="black" points="1873.5,-507.99 1870,-497.99 1866.5,-507.99 1873.5,-507.99"/>
</g>
<!-- output_split -->
<g id="node34" class="node">
<title>output_split</title>
<polygon fill="#ffe4b5" stroke="black" points="2049.22,-422.74 1764.12,-422.74 1690.78,-346.74 1975.88,-346.74 2049.22,-422.74"/>
<text text-anchor="middle" x="1870" y="-388.54" font-family="monospace" font-size="14.00">Split Output (TP=8)</text>
<text text-anchor="middle" x="1870" y="-373.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- residual_3_ffn&#45;&gt;output_split -->
<g id="edge42" class="edge">
<title>residual_3_ffn&#45;&gt;output_split</title>
<path fill="none" stroke="black" d="M1870,-459.72C1870,-459.72 1870,-432.77 1870,-432.77"/>
<polygon fill="black" stroke="black" points="1873.5,-432.77 1870,-422.77 1866.5,-432.77 1873.5,-432.77"/>
</g>
<!-- output_0 -->
<g id="node35" class="node">
<title>output_0</title>
<polygon fill="#ffb6c1" stroke="black" points="1486.5,-309.74 1379.5,-309.74 1379.5,-271.74 1486.5,-271.74 1486.5,-309.74"/>
<text text-anchor="middle" x="1433" y="-294.54" font-family="monospace" font-size="14.00">Linear GPU0</text>
<text text-anchor="middle" x="1433" y="-279.54" font-family="monospace" font-size="14.00">GPU: gpu_0</text>
</g>
<!-- output_split&#45;&gt;output_0 -->
<g id="edge43" class="edge">
<title>output_split&#45;&gt;output_0</title>
<path fill="none" stroke="black" d="M1739.07,-397C1616.06,-397 1450.76,-397 1450.76,-397 1450.76,-397 1450.76,-320.23 1450.76,-320.23"/>
<polygon fill="black" stroke="black" points="1454.26,-320.23 1450.76,-310.23 1447.26,-320.23 1454.26,-320.23"/>
</g>
<!-- output_1 -->
<g id="node36" class="node">
<title>output_1</title>
<polygon fill="#ffb6c1" stroke="black" points="1611.5,-309.74 1504.5,-309.74 1504.5,-271.74 1611.5,-271.74 1611.5,-309.74"/>
<text text-anchor="middle" x="1558" y="-294.54" font-family="monospace" font-size="14.00">Linear GPU1</text>
<text text-anchor="middle" x="1558" y="-279.54" font-family="monospace" font-size="14.00">GPU: gpu_1</text>
</g>
<!-- output_split&#45;&gt;output_1 -->
<g id="edge44" class="edge">
<title>output_split&#45;&gt;output_1</title>
<path fill="none" stroke="black" d="M1714.94,-372C1655.08,-372 1600.75,-372 1600.75,-372 1600.75,-372 1600.75,-320 1600.75,-320"/>
<polygon fill="black" stroke="black" points="1604.25,-320 1600.75,-310 1597.25,-320 1604.25,-320"/>
</g>
<!-- output_2 -->
<g id="node37" class="node">
<title>output_2</title>
<polygon fill="#ffb6c1" stroke="black" points="1736.5,-309.74 1629.5,-309.74 1629.5,-271.74 1736.5,-271.74 1736.5,-309.74"/>
<text text-anchor="middle" x="1683" y="-294.54" font-family="monospace" font-size="14.00">Linear GPU2</text>
<text text-anchor="middle" x="1683" y="-279.54" font-family="monospace" font-size="14.00">GPU: gpu_2</text>
</g>
<!-- output_split&#45;&gt;output_2 -->
<g id="edge45" class="edge">
<title>output_split&#45;&gt;output_2</title>
<path fill="none" stroke="black" d="M1713.57,-346.51C1713.57,-346.51 1713.57,-319.88 1713.57,-319.88"/>
<polygon fill="black" stroke="black" points="1717.07,-319.88 1713.57,-309.88 1710.07,-319.88 1717.07,-319.88"/>
</g>
<!-- output_3 -->
<g id="node38" class="node">
<title>output_3</title>
<polygon fill="#ffb6c1" stroke="black" points="1861.5,-309.74 1754.5,-309.74 1754.5,-271.74 1861.5,-271.74 1861.5,-309.74"/>
<text text-anchor="middle" x="1808" y="-294.54" font-family="monospace" font-size="14.00">Linear GPU3</text>
<text text-anchor="middle" x="1808" y="-279.54" font-family="monospace" font-size="14.00">GPU: gpu_3</text>
</g>
<!-- output_split&#45;&gt;output_3 -->
<g id="edge46" class="edge">
<title>output_split&#45;&gt;output_3</title>
<path fill="none" stroke="black" d="M1808,-346.51C1808,-346.51 1808,-319.88 1808,-319.88"/>
<polygon fill="black" stroke="black" points="1811.5,-319.88 1808,-309.88 1804.5,-319.88 1811.5,-319.88"/>
</g>
<!-- output_4 -->
<g id="node39" class="node">
<title>output_4</title>
<polygon fill="#ffb6c1" stroke="black" points="1986.5,-309.74 1879.5,-309.74 1879.5,-271.74 1986.5,-271.74 1986.5,-309.74"/>
<text text-anchor="middle" x="1933" y="-294.54" font-family="monospace" font-size="14.00">Linear GPU4</text>
<text text-anchor="middle" x="1933" y="-279.54" font-family="monospace" font-size="14.00">GPU: gpu_4</text>
</g>
<!-- output_split&#45;&gt;output_4 -->
<g id="edge47" class="edge">
<title>output_split&#45;&gt;output_4</title>
<path fill="none" stroke="black" d="M1933,-346.51C1933,-346.51 1933,-319.88 1933,-319.88"/>
<polygon fill="black" stroke="black" points="1936.5,-319.88 1933,-309.88 1929.5,-319.88 1936.5,-319.88"/>
</g>
<!-- output_5 -->
<g id="node40" class="node">
<title>output_5</title>
<polygon fill="#ffb6c1" stroke="black" points="2111.5,-309.74 2004.5,-309.74 2004.5,-271.74 2111.5,-271.74 2111.5,-309.74"/>
<text text-anchor="middle" x="2058" y="-294.54" font-family="monospace" font-size="14.00">Linear GPU5</text>
<text text-anchor="middle" x="2058" y="-279.54" font-family="monospace" font-size="14.00">GPU: gpu_5</text>
</g>
<!-- output_split&#45;&gt;output_5 -->
<g id="edge48" class="edge">
<title>output_split&#45;&gt;output_5</title>
<path fill="none" stroke="black" d="M2026.93,-384.67C2026.93,-384.67 2026.93,-320.13 2026.93,-320.13"/>
<polygon fill="black" stroke="black" points="2030.43,-320.13 2026.93,-310.13 2023.43,-320.13 2030.43,-320.13"/>
</g>
<!-- output_6 -->
<g id="node41" class="node">
<title>output_6</title>
<polygon fill="#ffb6c1" stroke="black" points="2236.5,-309.74 2129.5,-309.74 2129.5,-271.74 2236.5,-271.74 2236.5,-309.74"/>
<text text-anchor="middle" x="2183" y="-294.54" font-family="monospace" font-size="14.00">Linear GPU6</text>
<text text-anchor="middle" x="2183" y="-279.54" font-family="monospace" font-size="14.00">GPU: gpu_6</text>
</g>
<!-- output_split&#45;&gt;output_6 -->
<g id="edge49" class="edge">
<title>output_split&#45;&gt;output_6</title>
<path fill="none" stroke="black" d="M2000.47,-372C2086.36,-372 2183,-372 2183,-372 2183,-372 2183,-320 2183,-320"/>
<polygon fill="black" stroke="black" points="2186.5,-320 2183,-310 2179.5,-320 2186.5,-320"/>
</g>
<!-- output_7 -->
<g id="node42" class="node">
<title>output_7</title>
<polygon fill="#ffb6c1" stroke="black" points="2361.5,-309.74 2254.5,-309.74 2254.5,-271.74 2361.5,-271.74 2361.5,-309.74"/>
<text text-anchor="middle" x="2308" y="-294.54" font-family="monospace" font-size="14.00">Linear GPU7</text>
<text text-anchor="middle" x="2308" y="-279.54" font-family="monospace" font-size="14.00">GPU: gpu_7</text>
</g>
<!-- output_split&#45;&gt;output_7 -->
<g id="edge50" class="edge">
<title>output_split&#45;&gt;output_7</title>
<path fill="none" stroke="black" d="M2024.42,-397C2150.53,-397 2308,-397 2308,-397 2308,-397 2308,-320.23 2308,-320.23"/>
<polygon fill="black" stroke="black" points="2311.5,-320.23 2308,-310.23 2304.5,-320.23 2311.5,-320.23"/>
</g>
<!-- output_concat -->
<g id="node43" class="node">
<title>output_concat</title>
<polygon fill="#ffe4b5" stroke="black" points="1998.61,-234.74 1794.02,-234.74 1741.39,-158.74 1945.98,-158.74 1998.61,-234.74"/>
<text text-anchor="middle" x="1870" y="-200.54" font-family="monospace" font-size="14.00">Concat Output</text>
<text text-anchor="middle" x="1870" y="-185.54" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- output_0&#45;&gt;output_concat -->
<g id="edge51" class="edge">
<title>output_0&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M1433,-271.66C1433,-240.95 1433,-184 1433,-184 1433,-184 1748.6,-184 1748.6,-184"/>
<polygon fill="black" stroke="black" points="1748.6,-187.5 1758.6,-184 1748.6,-180.5 1748.6,-187.5"/>
</g>
<!-- output_1&#45;&gt;output_concat -->
<g id="edge52" class="edge">
<title>output_1&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M1558,-271.37C1558,-247.2 1558,-209 1558,-209 1558,-209 1765.97,-209 1765.97,-209"/>
<polygon fill="black" stroke="black" points="1765.97,-212.5 1775.97,-209 1765.97,-205.5 1765.97,-212.5"/>
</g>
<!-- output_2&#45;&gt;output_concat -->
<g id="edge53" class="edge">
<title>output_2&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M1736.65,-290C1743.39,-290 1747.97,-290 1747.97,-290 1747.97,-290 1747.97,-206.81 1747.97,-206.81"/>
<polygon fill="black" stroke="black" points="1751.47,-206.81 1747.97,-196.81 1744.47,-206.81 1751.47,-206.81"/>
</g>
<!-- output_3&#45;&gt;output_concat -->
<g id="edge54" class="edge">
<title>output_3&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M1808,-271.72C1808,-271.72 1808,-244.77 1808,-244.77"/>
<polygon fill="black" stroke="black" points="1811.5,-244.77 1808,-234.77 1804.5,-244.77 1811.5,-244.77"/>
</g>
<!-- output_4&#45;&gt;output_concat -->
<g id="edge55" class="edge">
<title>output_4&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M1933,-271.72C1933,-271.72 1933,-244.77 1933,-244.77"/>
<polygon fill="black" stroke="black" points="1936.5,-244.77 1933,-234.77 1929.5,-244.77 1936.5,-244.77"/>
</g>
<!-- output_5&#45;&gt;output_concat -->
<g id="edge56" class="edge">
<title>output_5&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M2004.23,-290C1997.28,-290 1992.53,-290 1992.53,-290 1992.53,-290 1992.53,-206.81 1992.53,-206.81"/>
<polygon fill="black" stroke="black" points="1996.03,-206.81 1992.53,-196.81 1989.03,-206.81 1996.03,-206.81"/>
</g>
<!-- output_6&#45;&gt;output_concat -->
<g id="edge57" class="edge">
<title>output_6&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M2183,-271.37C2183,-247.2 2183,-209 2183,-209 2183,-209 1990.79,-209 1990.79,-209"/>
<polygon fill="black" stroke="black" points="1990.79,-205.5 1980.79,-209 1990.79,-212.5 1990.79,-205.5"/>
</g>
<!-- output_7&#45;&gt;output_concat -->
<g id="edge58" class="edge">
<title>output_7&#45;&gt;output_concat</title>
<path fill="none" stroke="black" d="M2308,-271.66C2308,-240.95 2308,-184 2308,-184 2308,-184 1973.69,-184 1973.69,-184"/>
<polygon fill="black" stroke="black" points="1973.69,-180.5 1963.69,-184 1973.69,-187.5 1973.69,-180.5"/>
</g>
<!-- final_output -->
<g id="node44" class="node">
<title>final_output</title>
<ellipse fill="#e8f4fd" stroke="black" cx="1870" cy="-94.87" rx="82.05" ry="26.74"/>
<text text-anchor="middle" x="1870" y="-98.67" font-family="monospace" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="1870" y="-83.67" font-family="monospace" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- output_concat&#45;&gt;final_output -->
<g id="edge59" class="edge">
<title>output_concat&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M1870,-158.52C1870,-158.52 1870,-131.86 1870,-131.86"/>
<polygon fill="black" stroke="black" points="1873.5,-131.86 1870,-121.86 1866.5,-131.86 1873.5,-131.86"/>
</g>
</g>
</svg>
