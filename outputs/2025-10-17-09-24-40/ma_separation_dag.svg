<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: ma_separation_dag Pages: 1 -->
<svg width="13663pt" height="3848pt"
 viewBox="0.00 0.00 13663.30 3847.85" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 3843.85)">
<title>ma_separation_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3843.85 13659.3,-3843.85 13659.3,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="#d0e8ff" stroke="black" cx="5202" cy="-3818.64" rx="173.9" ry="21.43"/>
<text text-anchor="middle" x="5202" y="-3821.64" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="5202" y="-3810.64" font-family="Arial" font-size="10.00">[batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- embeddings -->
<g id="node2" class="node">
<title>embeddings</title>
<polygon fill="#e8f4fd" stroke="black" points="5311,-3761.43 5093,-3761.43 5093,-3720.43 5311,-3720.43 5311,-3761.43"/>
<text text-anchor="middle" x="5202" y="-3749.43" font-family="Arial" font-size="10.00">Token + Position</text>
<text text-anchor="middle" x="5202" y="-3738.43" font-family="Arial" font-size="10.00">Embedding</text>
<text text-anchor="middle" x="5202" y="-3727.43" font-family="Arial" font-size="10.00">[Input: [1024,2048], Output: [1024,2048,4096]]</text>
</g>
<!-- input&#45;&gt;embeddings -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embeddings</title>
<path fill="none" stroke="black" d="M5202,-3797.35C5202,-3789.44 5202,-3780.22 5202,-3771.59"/>
<polygon fill="black" stroke="black" points="5205.5,-3771.49 5202,-3761.49 5198.5,-3771.49 5205.5,-3771.49"/>
</g>
<!-- layer0_pre_attn_norm -->
<g id="node3" class="node">
<title>layer0_pre_attn_norm</title>
<polygon fill="#e8f4fd" stroke="black" points="242,-3650.43 0,-3650.43 0,-3614.43 242,-3614.43 242,-3650.43"/>
<text text-anchor="middle" x="121" y="-3635.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="121" y="-3624.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- embeddings&#45;&gt;layer0_pre_attn_norm -->
<g id="edge2" class="edge">
<title>embeddings&#45;&gt;layer0_pre_attn_norm</title>
<path fill="none" stroke="black" d="M5092.98,-3739.82C4388.12,-3739 496.47,-3732.28 251,-3684.43 220.72,-3678.52 188.42,-3665.89 163.6,-3654.67"/>
<polygon fill="black" stroke="black" points="165.01,-3651.47 154.47,-3650.46 162.08,-3657.83 165.01,-3651.47"/>
</g>
<!-- layer0_residual1 -->
<g id="node41" class="node">
<title>layer0_residual1</title>
<path fill="#fff4e8" stroke="black" d="M10645.04,-3662.43C10645.04,-3662.43 10074.03,-3662.43 10074.03,-3662.43 10068.03,-3662.43 10056.44,-3660.24 10050.86,-3658.05 10050.86,-3658.05 9920.14,-3606.81 9920.14,-3606.81 9914.55,-3604.62 9914.96,-3602.43 9920.96,-3602.43 9920.96,-3602.43 10491.97,-3602.43 10491.97,-3602.43 10497.97,-3602.43 10509.56,-3604.62 10515.14,-3606.81 10515.14,-3606.81 10645.86,-3658.05 10645.86,-3658.05 10651.45,-3660.24 10651.04,-3662.43 10645.04,-3662.43"/>
<text text-anchor="middle" x="10283" y="-3635.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="10283" y="-3624.43" font-family="Arial" font-size="10.00">[Input1: [1024,2048,4096], Input2: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- embeddings&#45;&gt;layer0_residual1 -->
<g id="edge52" class="edge">
<title>embeddings&#45;&gt;layer0_residual1</title>
<path fill="none" stroke="black" d="M5311.23,-3739.42C5972.58,-3736.28 9428.56,-3718.32 9899,-3684.43 9960.95,-3679.96 10028.18,-3672.08 10088.82,-3663.83"/>
<polygon fill="black" stroke="black" points="10089.45,-3667.28 10098.89,-3662.45 10088.5,-3660.34 10089.45,-3667.28"/>
</g>
<!-- layer0_qkv_gpu0 -->
<g id="node4" class="node">
<title>layer0_qkv_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="8834,-3652.93 8598,-3652.93 8598,-3611.93 8834,-3611.93 8834,-3652.93"/>
<text text-anchor="middle" x="8716" y="-3640.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="8716" y="-3629.93" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="8716" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu0 -->
<g id="edge3" class="edge">
<title>layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu0</title>
<path fill="none" stroke="black" d="M147.49,-3650.52C174.43,-3667.74 218.07,-3692.46 260,-3702.43 316.21,-3715.78 8523.85,-3716.03 8580,-3702.43 8615.24,-3693.89 8651.59,-3674.54 8677.83,-3658.34"/>
<polygon fill="black" stroke="black" points="8679.73,-3661.28 8686.32,-3652.99 8676,-3655.36 8679.73,-3661.28"/>
</g>
<!-- layer0_qkv_gpu1 -->
<g id="node5" class="node">
<title>layer0_qkv_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="8076,-3652.93 7840,-3652.93 7840,-3611.93 8076,-3611.93 8076,-3652.93"/>
<text text-anchor="middle" x="7958" y="-3640.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="7958" y="-3629.93" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="7958" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu1 -->
<g id="edge7" class="edge">
<title>layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu1</title>
<path fill="none" stroke="black" d="M147.49,-3650.52C174.43,-3667.74 218.07,-3692.46 260,-3702.43 311.09,-3714.57 7770.96,-3714.79 7822,-3702.43 7857.24,-3693.89 7893.59,-3674.54 7919.83,-3658.34"/>
<polygon fill="black" stroke="black" points="7921.73,-3661.28 7928.32,-3652.99 7918,-3655.36 7921.73,-3661.28"/>
</g>
<!-- layer0_qkv_gpu2 -->
<g id="node6" class="node">
<title>layer0_qkv_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="7318,-3652.93 7082,-3652.93 7082,-3611.93 7318,-3611.93 7318,-3652.93"/>
<text text-anchor="middle" x="7200" y="-3640.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="7200" y="-3629.93" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="7200" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu2 -->
<g id="edge11" class="edge">
<title>layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu2</title>
<path fill="none" stroke="black" d="M147.49,-3650.52C174.43,-3667.74 218.07,-3692.46 260,-3702.43 351.94,-3724.27 6972.16,-3724.68 7064,-3702.43 7099.24,-3693.89 7135.59,-3674.54 7161.83,-3658.34"/>
<polygon fill="black" stroke="black" points="7163.73,-3661.28 7170.32,-3652.99 7160,-3655.36 7163.73,-3661.28"/>
</g>
<!-- layer0_qkv_gpu3 -->
<g id="node7" class="node">
<title>layer0_qkv_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="6560,-3652.93 6324,-3652.93 6324,-3611.93 6560,-3611.93 6560,-3652.93"/>
<text text-anchor="middle" x="6442" y="-3640.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="6442" y="-3629.93" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="6442" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu3 -->
<g id="edge15" class="edge">
<title>layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu3</title>
<path fill="none" stroke="black" d="M147.49,-3650.52C174.43,-3667.74 218.07,-3692.46 260,-3702.43 341.7,-3721.84 6224.39,-3722.2 6306,-3702.43 6341.24,-3693.89 6377.59,-3674.54 6403.83,-3658.34"/>
<polygon fill="black" stroke="black" points="6405.73,-3661.28 6412.32,-3652.99 6402,-3655.36 6405.73,-3661.28"/>
</g>
<!-- layer0_qkv_gpu4 -->
<g id="node8" class="node">
<title>layer0_qkv_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="5802,-3652.93 5566,-3652.93 5566,-3611.93 5802,-3611.93 5802,-3652.93"/>
<text text-anchor="middle" x="5684" y="-3640.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="5684" y="-3629.93" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="5684" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu4 -->
<g id="edge19" class="edge">
<title>layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu4</title>
<path fill="none" stroke="black" d="M147.49,-3650.52C174.43,-3667.74 218.07,-3692.46 260,-3702.43 331.46,-3719.4 5476.62,-3719.72 5548,-3702.43 5583.24,-3693.89 5619.59,-3674.54 5645.83,-3658.34"/>
<polygon fill="black" stroke="black" points="5647.73,-3661.28 5654.32,-3652.99 5644,-3655.36 5647.73,-3661.28"/>
</g>
<!-- layer0_qkv_gpu5 -->
<g id="node9" class="node">
<title>layer0_qkv_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="5044,-3652.93 4808,-3652.93 4808,-3611.93 5044,-3611.93 5044,-3652.93"/>
<text text-anchor="middle" x="4926" y="-3640.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="4926" y="-3629.93" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4926" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu5 -->
<g id="edge23" class="edge">
<title>layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu5</title>
<path fill="none" stroke="black" d="M147.49,-3650.52C174.43,-3667.74 218.07,-3692.46 260,-3702.43 321.21,-3716.97 4728.85,-3717.24 4790,-3702.43 4825.24,-3693.89 4861.59,-3674.54 4887.83,-3658.34"/>
<polygon fill="black" stroke="black" points="4889.73,-3661.28 4896.32,-3652.99 4886,-3655.36 4889.73,-3661.28"/>
</g>
<!-- layer0_qkv_gpu6 -->
<g id="node10" class="node">
<title>layer0_qkv_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="4286,-3652.93 4050,-3652.93 4050,-3611.93 4286,-3611.93 4286,-3652.93"/>
<text text-anchor="middle" x="4168" y="-3640.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="4168" y="-3629.93" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4168" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu6 -->
<g id="edge27" class="edge">
<title>layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu6</title>
<path fill="none" stroke="black" d="M147.49,-3650.52C174.43,-3667.74 218.07,-3692.46 260,-3702.43 310.97,-3714.54 3981.08,-3714.76 4032,-3702.43 4067.24,-3693.89 4103.59,-3674.54 4129.83,-3658.34"/>
<polygon fill="black" stroke="black" points="4131.73,-3661.28 4138.32,-3652.99 4128,-3655.36 4131.73,-3661.28"/>
</g>
<!-- layer0_qkv_gpu7 -->
<g id="node11" class="node">
<title>layer0_qkv_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="3528,-3652.93 3292,-3652.93 3292,-3611.93 3528,-3611.93 3528,-3652.93"/>
<text text-anchor="middle" x="3410" y="-3640.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="3410" y="-3629.93" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3410" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu7 -->
<g id="edge31" class="edge">
<title>layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu7</title>
<path fill="none" stroke="black" d="M147.49,-3650.52C174.43,-3667.74 218.07,-3692.46 260,-3702.43 341.45,-3721.78 3192.63,-3722.14 3274,-3702.43 3309.24,-3693.89 3345.59,-3674.54 3371.83,-3658.34"/>
<polygon fill="black" stroke="black" points="3373.73,-3661.28 3380.32,-3652.99 3370,-3655.36 3373.73,-3661.28"/>
</g>
<!-- layer0_qkv_gpu8 -->
<g id="node12" class="node">
<title>layer0_qkv_gpu8</title>
<polygon fill="#e8f4fd" stroke="black" points="2770,-3652.93 2534,-3652.93 2534,-3611.93 2770,-3611.93 2770,-3652.93"/>
<text text-anchor="middle" x="2652" y="-3640.93" font-family="Arial" font-size="10.00">GPU8</text>
<text text-anchor="middle" x="2652" y="-3629.93" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2652" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,256]]</text>
</g>
<!-- layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu8 -->
<g id="edge35" class="edge">
<title>layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu8</title>
<path fill="none" stroke="black" d="M147.49,-3650.52C174.43,-3667.74 218.07,-3692.46 260,-3702.43 320.97,-3716.91 2455.09,-3717.18 2516,-3702.43 2551.24,-3693.89 2587.59,-3674.54 2613.83,-3658.34"/>
<polygon fill="black" stroke="black" points="2615.73,-3661.28 2622.32,-3652.99 2612,-3655.36 2615.73,-3661.28"/>
</g>
<!-- layer0_qkv_gpu9 -->
<g id="node13" class="node">
<title>layer0_qkv_gpu9</title>
<polygon fill="#e8f4fd" stroke="black" points="2012,-3652.93 1776,-3652.93 1776,-3611.93 2012,-3611.93 2012,-3652.93"/>
<text text-anchor="middle" x="1894" y="-3640.93" font-family="Arial" font-size="10.00">GPU9</text>
<text text-anchor="middle" x="1894" y="-3629.93" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1894" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,256]]</text>
</g>
<!-- layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu9 -->
<g id="edge39" class="edge">
<title>layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu9</title>
<path fill="none" stroke="black" d="M147.49,-3650.52C174.43,-3667.74 218.07,-3692.46 260,-3702.43 340.97,-3721.66 1677.12,-3722.02 1758,-3702.43 1793.24,-3693.89 1829.59,-3674.54 1855.83,-3658.34"/>
<polygon fill="black" stroke="black" points="1857.73,-3661.28 1864.32,-3652.99 1854,-3655.36 1857.73,-3661.28"/>
</g>
<!-- layer0_qkv_gpu10 -->
<g id="node14" class="node">
<title>layer0_qkv_gpu10</title>
<polygon fill="#e8f4fd" stroke="black" points="1254,-3652.93 1018,-3652.93 1018,-3611.93 1254,-3611.93 1254,-3652.93"/>
<text text-anchor="middle" x="1136" y="-3640.93" font-family="Arial" font-size="10.00">GPU10</text>
<text text-anchor="middle" x="1136" y="-3629.93" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1136" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,256]]</text>
</g>
<!-- layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu10 -->
<g id="edge43" class="edge">
<title>layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu10</title>
<path fill="none" stroke="black" d="M147.49,-3650.52C174.43,-3667.74 218.07,-3692.46 260,-3702.43 340,-3721.43 920.09,-3721.78 1000,-3702.43 1035.24,-3693.89 1071.59,-3674.54 1097.83,-3658.34"/>
<polygon fill="black" stroke="black" points="1099.73,-3661.28 1106.32,-3652.99 1096,-3655.36 1099.73,-3661.28"/>
</g>
<!-- layer0_qkv_gpu11 -->
<g id="node15" class="node">
<title>layer0_qkv_gpu11</title>
<polygon fill="#e8f4fd" stroke="black" points="496,-3652.93 260,-3652.93 260,-3611.93 496,-3611.93 496,-3652.93"/>
<text text-anchor="middle" x="378" y="-3640.93" font-family="Arial" font-size="10.00">GPU11</text>
<text text-anchor="middle" x="378" y="-3629.93" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="378" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,256]]</text>
</g>
<!-- layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu11 -->
<g id="edge47" class="edge">
<title>layer0_pre_attn_norm&#45;&gt;layer0_qkv_gpu11</title>
<path fill="none" stroke="black" d="M242.22,-3632.43C244.72,-3632.43 247.22,-3632.43 249.72,-3632.43"/>
<polygon fill="black" stroke="black" points="249.99,-3635.93 259.99,-3632.43 249.99,-3628.93 249.99,-3635.93"/>
</g>
<!-- layer0_attn_gpu0 -->
<g id="node16" class="node">
<title>layer0_attn_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="9083.5,-3652.93 8852.5,-3652.93 8852.5,-3611.93 9083.5,-3611.93 9083.5,-3652.93"/>
<text text-anchor="middle" x="8968" y="-3640.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="8968" y="-3629.93" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="8968" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer0_qkv_gpu0&#45;&gt;layer0_attn_gpu0 -->
<g id="edge4" class="edge">
<title>layer0_qkv_gpu0&#45;&gt;layer0_attn_gpu0</title>
<path fill="none" stroke="black" d="M8834.12,-3632.43C8836.89,-3632.43 8839.65,-3632.43 8842.42,-3632.43"/>
<polygon fill="black" stroke="black" points="8842.43,-3635.93 8852.43,-3632.43 8842.43,-3628.93 8842.43,-3635.93"/>
</g>
<!-- layer0_attn_gpu1 -->
<g id="node17" class="node">
<title>layer0_attn_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="8325.5,-3652.93 8094.5,-3652.93 8094.5,-3611.93 8325.5,-3611.93 8325.5,-3652.93"/>
<text text-anchor="middle" x="8210" y="-3640.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="8210" y="-3629.93" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="8210" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer0_qkv_gpu1&#45;&gt;layer0_attn_gpu1 -->
<g id="edge8" class="edge">
<title>layer0_qkv_gpu1&#45;&gt;layer0_attn_gpu1</title>
<path fill="none" stroke="black" d="M8076.12,-3632.43C8078.89,-3632.43 8081.65,-3632.43 8084.42,-3632.43"/>
<polygon fill="black" stroke="black" points="8084.43,-3635.93 8094.43,-3632.43 8084.43,-3628.93 8084.43,-3635.93"/>
</g>
<!-- layer0_attn_gpu2 -->
<g id="node18" class="node">
<title>layer0_attn_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="7567.5,-3652.93 7336.5,-3652.93 7336.5,-3611.93 7567.5,-3611.93 7567.5,-3652.93"/>
<text text-anchor="middle" x="7452" y="-3640.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="7452" y="-3629.93" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="7452" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer0_qkv_gpu2&#45;&gt;layer0_attn_gpu2 -->
<g id="edge12" class="edge">
<title>layer0_qkv_gpu2&#45;&gt;layer0_attn_gpu2</title>
<path fill="none" stroke="black" d="M7318.12,-3632.43C7320.89,-3632.43 7323.65,-3632.43 7326.42,-3632.43"/>
<polygon fill="black" stroke="black" points="7326.43,-3635.93 7336.43,-3632.43 7326.43,-3628.93 7326.43,-3635.93"/>
</g>
<!-- layer0_attn_gpu3 -->
<g id="node19" class="node">
<title>layer0_attn_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="6809.5,-3652.93 6578.5,-3652.93 6578.5,-3611.93 6809.5,-3611.93 6809.5,-3652.93"/>
<text text-anchor="middle" x="6694" y="-3640.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="6694" y="-3629.93" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="6694" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer0_qkv_gpu3&#45;&gt;layer0_attn_gpu3 -->
<g id="edge16" class="edge">
<title>layer0_qkv_gpu3&#45;&gt;layer0_attn_gpu3</title>
<path fill="none" stroke="black" d="M6560.12,-3632.43C6562.89,-3632.43 6565.65,-3632.43 6568.42,-3632.43"/>
<polygon fill="black" stroke="black" points="6568.43,-3635.93 6578.43,-3632.43 6568.43,-3628.93 6568.43,-3635.93"/>
</g>
<!-- layer0_attn_gpu4 -->
<g id="node20" class="node">
<title>layer0_attn_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="6051.5,-3652.93 5820.5,-3652.93 5820.5,-3611.93 6051.5,-3611.93 6051.5,-3652.93"/>
<text text-anchor="middle" x="5936" y="-3640.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="5936" y="-3629.93" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5936" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer0_qkv_gpu4&#45;&gt;layer0_attn_gpu4 -->
<g id="edge20" class="edge">
<title>layer0_qkv_gpu4&#45;&gt;layer0_attn_gpu4</title>
<path fill="none" stroke="black" d="M5802.12,-3632.43C5804.89,-3632.43 5807.65,-3632.43 5810.42,-3632.43"/>
<polygon fill="black" stroke="black" points="5810.43,-3635.93 5820.43,-3632.43 5810.43,-3628.93 5810.43,-3635.93"/>
</g>
<!-- layer0_attn_gpu5 -->
<g id="node21" class="node">
<title>layer0_attn_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="5293.5,-3652.93 5062.5,-3652.93 5062.5,-3611.93 5293.5,-3611.93 5293.5,-3652.93"/>
<text text-anchor="middle" x="5178" y="-3640.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="5178" y="-3629.93" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5178" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer0_qkv_gpu5&#45;&gt;layer0_attn_gpu5 -->
<g id="edge24" class="edge">
<title>layer0_qkv_gpu5&#45;&gt;layer0_attn_gpu5</title>
<path fill="none" stroke="black" d="M5044.12,-3632.43C5046.89,-3632.43 5049.65,-3632.43 5052.42,-3632.43"/>
<polygon fill="black" stroke="black" points="5052.43,-3635.93 5062.43,-3632.43 5052.43,-3628.93 5052.43,-3635.93"/>
</g>
<!-- layer0_attn_gpu6 -->
<g id="node22" class="node">
<title>layer0_attn_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="4535.5,-3652.93 4304.5,-3652.93 4304.5,-3611.93 4535.5,-3611.93 4535.5,-3652.93"/>
<text text-anchor="middle" x="4420" y="-3640.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="4420" y="-3629.93" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="4420" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer0_qkv_gpu6&#45;&gt;layer0_attn_gpu6 -->
<g id="edge28" class="edge">
<title>layer0_qkv_gpu6&#45;&gt;layer0_attn_gpu6</title>
<path fill="none" stroke="black" d="M4286.12,-3632.43C4288.89,-3632.43 4291.65,-3632.43 4294.42,-3632.43"/>
<polygon fill="black" stroke="black" points="4294.43,-3635.93 4304.43,-3632.43 4294.43,-3628.93 4294.43,-3635.93"/>
</g>
<!-- layer0_attn_gpu7 -->
<g id="node23" class="node">
<title>layer0_attn_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="3777.5,-3652.93 3546.5,-3652.93 3546.5,-3611.93 3777.5,-3611.93 3777.5,-3652.93"/>
<text text-anchor="middle" x="3662" y="-3640.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="3662" y="-3629.93" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3662" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer0_qkv_gpu7&#45;&gt;layer0_attn_gpu7 -->
<g id="edge32" class="edge">
<title>layer0_qkv_gpu7&#45;&gt;layer0_attn_gpu7</title>
<path fill="none" stroke="black" d="M3528.12,-3632.43C3530.89,-3632.43 3533.65,-3632.43 3536.42,-3632.43"/>
<polygon fill="black" stroke="black" points="3536.43,-3635.93 3546.43,-3632.43 3536.43,-3628.93 3536.43,-3635.93"/>
</g>
<!-- layer0_attn_gpu8 -->
<g id="node24" class="node">
<title>layer0_attn_gpu8</title>
<polygon fill="#e8f4fd" stroke="black" points="3019.5,-3652.93 2788.5,-3652.93 2788.5,-3611.93 3019.5,-3611.93 3019.5,-3652.93"/>
<text text-anchor="middle" x="2904" y="-3640.93" font-family="Arial" font-size="10.00">GPU8</text>
<text text-anchor="middle" x="2904" y="-3629.93" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2904" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,256]]</text>
</g>
<!-- layer0_qkv_gpu8&#45;&gt;layer0_attn_gpu8 -->
<g id="edge36" class="edge">
<title>layer0_qkv_gpu8&#45;&gt;layer0_attn_gpu8</title>
<path fill="none" stroke="black" d="M2770.12,-3632.43C2772.89,-3632.43 2775.65,-3632.43 2778.42,-3632.43"/>
<polygon fill="black" stroke="black" points="2778.43,-3635.93 2788.43,-3632.43 2778.43,-3628.93 2778.43,-3635.93"/>
</g>
<!-- layer0_attn_gpu9 -->
<g id="node25" class="node">
<title>layer0_attn_gpu9</title>
<polygon fill="#e8f4fd" stroke="black" points="2261.5,-3652.93 2030.5,-3652.93 2030.5,-3611.93 2261.5,-3611.93 2261.5,-3652.93"/>
<text text-anchor="middle" x="2146" y="-3640.93" font-family="Arial" font-size="10.00">GPU9</text>
<text text-anchor="middle" x="2146" y="-3629.93" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2146" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,256]]</text>
</g>
<!-- layer0_qkv_gpu9&#45;&gt;layer0_attn_gpu9 -->
<g id="edge40" class="edge">
<title>layer0_qkv_gpu9&#45;&gt;layer0_attn_gpu9</title>
<path fill="none" stroke="black" d="M2012.12,-3632.43C2014.89,-3632.43 2017.65,-3632.43 2020.42,-3632.43"/>
<polygon fill="black" stroke="black" points="2020.43,-3635.93 2030.43,-3632.43 2020.43,-3628.93 2020.43,-3635.93"/>
</g>
<!-- layer0_attn_gpu10 -->
<g id="node26" class="node">
<title>layer0_attn_gpu10</title>
<polygon fill="#e8f4fd" stroke="black" points="1503.5,-3652.93 1272.5,-3652.93 1272.5,-3611.93 1503.5,-3611.93 1503.5,-3652.93"/>
<text text-anchor="middle" x="1388" y="-3640.93" font-family="Arial" font-size="10.00">GPU10</text>
<text text-anchor="middle" x="1388" y="-3629.93" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1388" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,256]]</text>
</g>
<!-- layer0_qkv_gpu10&#45;&gt;layer0_attn_gpu10 -->
<g id="edge44" class="edge">
<title>layer0_qkv_gpu10&#45;&gt;layer0_attn_gpu10</title>
<path fill="none" stroke="black" d="M1254.12,-3632.43C1256.89,-3632.43 1259.65,-3632.43 1262.42,-3632.43"/>
<polygon fill="black" stroke="black" points="1262.43,-3635.93 1272.43,-3632.43 1262.43,-3628.93 1262.43,-3635.93"/>
</g>
<!-- layer0_attn_gpu11 -->
<g id="node27" class="node">
<title>layer0_attn_gpu11</title>
<polygon fill="#e8f4fd" stroke="black" points="745.5,-3652.93 514.5,-3652.93 514.5,-3611.93 745.5,-3611.93 745.5,-3652.93"/>
<text text-anchor="middle" x="630" y="-3640.93" font-family="Arial" font-size="10.00">GPU11</text>
<text text-anchor="middle" x="630" y="-3629.93" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="630" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,256]]</text>
</g>
<!-- layer0_qkv_gpu11&#45;&gt;layer0_attn_gpu11 -->
<g id="edge48" class="edge">
<title>layer0_qkv_gpu11&#45;&gt;layer0_attn_gpu11</title>
<path fill="none" stroke="black" d="M496.12,-3632.43C498.89,-3632.43 501.65,-3632.43 504.42,-3632.43"/>
<polygon fill="black" stroke="black" points="504.43,-3635.93 514.43,-3632.43 504.43,-3628.93 504.43,-3635.93"/>
</g>
<!-- layer0_out_proj_gpu0 -->
<g id="node28" class="node">
<title>layer0_out_proj_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="9338,-3652.93 9102,-3652.93 9102,-3611.93 9338,-3611.93 9338,-3652.93"/>
<text text-anchor="middle" x="9220" y="-3640.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="9220" y="-3629.93" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="9220" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_attn_gpu0&#45;&gt;layer0_out_proj_gpu0 -->
<g id="edge5" class="edge">
<title>layer0_attn_gpu0&#45;&gt;layer0_out_proj_gpu0</title>
<path fill="none" stroke="black" d="M9083.66,-3632.43C9086.3,-3632.43 9088.95,-3632.43 9091.59,-3632.43"/>
<polygon fill="black" stroke="black" points="9091.77,-3635.93 9101.77,-3632.43 9091.77,-3628.93 9091.77,-3635.93"/>
</g>
<!-- layer0_out_proj_gpu1 -->
<g id="node29" class="node">
<title>layer0_out_proj_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="8580,-3652.93 8344,-3652.93 8344,-3611.93 8580,-3611.93 8580,-3652.93"/>
<text text-anchor="middle" x="8462" y="-3640.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="8462" y="-3629.93" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="8462" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_attn_gpu1&#45;&gt;layer0_out_proj_gpu1 -->
<g id="edge9" class="edge">
<title>layer0_attn_gpu1&#45;&gt;layer0_out_proj_gpu1</title>
<path fill="none" stroke="black" d="M8325.66,-3632.43C8328.3,-3632.43 8330.95,-3632.43 8333.59,-3632.43"/>
<polygon fill="black" stroke="black" points="8333.77,-3635.93 8343.77,-3632.43 8333.77,-3628.93 8333.77,-3635.93"/>
</g>
<!-- layer0_out_proj_gpu2 -->
<g id="node30" class="node">
<title>layer0_out_proj_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="7822,-3652.93 7586,-3652.93 7586,-3611.93 7822,-3611.93 7822,-3652.93"/>
<text text-anchor="middle" x="7704" y="-3640.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="7704" y="-3629.93" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="7704" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_attn_gpu2&#45;&gt;layer0_out_proj_gpu2 -->
<g id="edge13" class="edge">
<title>layer0_attn_gpu2&#45;&gt;layer0_out_proj_gpu2</title>
<path fill="none" stroke="black" d="M7567.66,-3632.43C7570.3,-3632.43 7572.95,-3632.43 7575.59,-3632.43"/>
<polygon fill="black" stroke="black" points="7575.77,-3635.93 7585.77,-3632.43 7575.77,-3628.93 7575.77,-3635.93"/>
</g>
<!-- layer0_out_proj_gpu3 -->
<g id="node31" class="node">
<title>layer0_out_proj_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="7064,-3652.93 6828,-3652.93 6828,-3611.93 7064,-3611.93 7064,-3652.93"/>
<text text-anchor="middle" x="6946" y="-3640.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="6946" y="-3629.93" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="6946" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_attn_gpu3&#45;&gt;layer0_out_proj_gpu3 -->
<g id="edge17" class="edge">
<title>layer0_attn_gpu3&#45;&gt;layer0_out_proj_gpu3</title>
<path fill="none" stroke="black" d="M6809.66,-3632.43C6812.3,-3632.43 6814.95,-3632.43 6817.59,-3632.43"/>
<polygon fill="black" stroke="black" points="6817.77,-3635.93 6827.77,-3632.43 6817.77,-3628.93 6817.77,-3635.93"/>
</g>
<!-- layer0_out_proj_gpu4 -->
<g id="node32" class="node">
<title>layer0_out_proj_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="6306,-3652.93 6070,-3652.93 6070,-3611.93 6306,-3611.93 6306,-3652.93"/>
<text text-anchor="middle" x="6188" y="-3640.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="6188" y="-3629.93" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="6188" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_attn_gpu4&#45;&gt;layer0_out_proj_gpu4 -->
<g id="edge21" class="edge">
<title>layer0_attn_gpu4&#45;&gt;layer0_out_proj_gpu4</title>
<path fill="none" stroke="black" d="M6051.66,-3632.43C6054.3,-3632.43 6056.95,-3632.43 6059.59,-3632.43"/>
<polygon fill="black" stroke="black" points="6059.77,-3635.93 6069.77,-3632.43 6059.77,-3628.93 6059.77,-3635.93"/>
</g>
<!-- layer0_out_proj_gpu5 -->
<g id="node33" class="node">
<title>layer0_out_proj_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="5548,-3652.93 5312,-3652.93 5312,-3611.93 5548,-3611.93 5548,-3652.93"/>
<text text-anchor="middle" x="5430" y="-3640.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="5430" y="-3629.93" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="5430" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_attn_gpu5&#45;&gt;layer0_out_proj_gpu5 -->
<g id="edge25" class="edge">
<title>layer0_attn_gpu5&#45;&gt;layer0_out_proj_gpu5</title>
<path fill="none" stroke="black" d="M5293.66,-3632.43C5296.3,-3632.43 5298.95,-3632.43 5301.59,-3632.43"/>
<polygon fill="black" stroke="black" points="5301.77,-3635.93 5311.77,-3632.43 5301.77,-3628.93 5301.77,-3635.93"/>
</g>
<!-- layer0_out_proj_gpu6 -->
<g id="node34" class="node">
<title>layer0_out_proj_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="4790,-3652.93 4554,-3652.93 4554,-3611.93 4790,-3611.93 4790,-3652.93"/>
<text text-anchor="middle" x="4672" y="-3640.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="4672" y="-3629.93" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="4672" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_attn_gpu6&#45;&gt;layer0_out_proj_gpu6 -->
<g id="edge29" class="edge">
<title>layer0_attn_gpu6&#45;&gt;layer0_out_proj_gpu6</title>
<path fill="none" stroke="black" d="M4535.66,-3632.43C4538.3,-3632.43 4540.95,-3632.43 4543.59,-3632.43"/>
<polygon fill="black" stroke="black" points="4543.77,-3635.93 4553.77,-3632.43 4543.77,-3628.93 4543.77,-3635.93"/>
</g>
<!-- layer0_out_proj_gpu7 -->
<g id="node35" class="node">
<title>layer0_out_proj_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="4032,-3652.93 3796,-3652.93 3796,-3611.93 4032,-3611.93 4032,-3652.93"/>
<text text-anchor="middle" x="3914" y="-3640.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="3914" y="-3629.93" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="3914" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_attn_gpu7&#45;&gt;layer0_out_proj_gpu7 -->
<g id="edge33" class="edge">
<title>layer0_attn_gpu7&#45;&gt;layer0_out_proj_gpu7</title>
<path fill="none" stroke="black" d="M3777.66,-3632.43C3780.3,-3632.43 3782.95,-3632.43 3785.59,-3632.43"/>
<polygon fill="black" stroke="black" points="3785.77,-3635.93 3795.77,-3632.43 3785.77,-3628.93 3785.77,-3635.93"/>
</g>
<!-- layer0_out_proj_gpu8 -->
<g id="node36" class="node">
<title>layer0_out_proj_gpu8</title>
<polygon fill="#e8f4fd" stroke="black" points="3274,-3652.93 3038,-3652.93 3038,-3611.93 3274,-3611.93 3274,-3652.93"/>
<text text-anchor="middle" x="3156" y="-3640.93" font-family="Arial" font-size="10.00">GPU8</text>
<text text-anchor="middle" x="3156" y="-3629.93" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="3156" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_attn_gpu8&#45;&gt;layer0_out_proj_gpu8 -->
<g id="edge37" class="edge">
<title>layer0_attn_gpu8&#45;&gt;layer0_out_proj_gpu8</title>
<path fill="none" stroke="black" d="M3019.66,-3632.43C3022.3,-3632.43 3024.95,-3632.43 3027.59,-3632.43"/>
<polygon fill="black" stroke="black" points="3027.77,-3635.93 3037.77,-3632.43 3027.77,-3628.93 3027.77,-3635.93"/>
</g>
<!-- layer0_out_proj_gpu9 -->
<g id="node37" class="node">
<title>layer0_out_proj_gpu9</title>
<polygon fill="#e8f4fd" stroke="black" points="2516,-3652.93 2280,-3652.93 2280,-3611.93 2516,-3611.93 2516,-3652.93"/>
<text text-anchor="middle" x="2398" y="-3640.93" font-family="Arial" font-size="10.00">GPU9</text>
<text text-anchor="middle" x="2398" y="-3629.93" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="2398" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_attn_gpu9&#45;&gt;layer0_out_proj_gpu9 -->
<g id="edge41" class="edge">
<title>layer0_attn_gpu9&#45;&gt;layer0_out_proj_gpu9</title>
<path fill="none" stroke="black" d="M2261.66,-3632.43C2264.3,-3632.43 2266.95,-3632.43 2269.59,-3632.43"/>
<polygon fill="black" stroke="black" points="2269.77,-3635.93 2279.77,-3632.43 2269.77,-3628.93 2269.77,-3635.93"/>
</g>
<!-- layer0_out_proj_gpu10 -->
<g id="node38" class="node">
<title>layer0_out_proj_gpu10</title>
<polygon fill="#e8f4fd" stroke="black" points="1758,-3652.93 1522,-3652.93 1522,-3611.93 1758,-3611.93 1758,-3652.93"/>
<text text-anchor="middle" x="1640" y="-3640.93" font-family="Arial" font-size="10.00">GPU10</text>
<text text-anchor="middle" x="1640" y="-3629.93" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="1640" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_attn_gpu10&#45;&gt;layer0_out_proj_gpu10 -->
<g id="edge45" class="edge">
<title>layer0_attn_gpu10&#45;&gt;layer0_out_proj_gpu10</title>
<path fill="none" stroke="black" d="M1503.66,-3632.43C1506.3,-3632.43 1508.95,-3632.43 1511.59,-3632.43"/>
<polygon fill="black" stroke="black" points="1511.77,-3635.93 1521.77,-3632.43 1511.77,-3628.93 1511.77,-3635.93"/>
</g>
<!-- layer0_out_proj_gpu11 -->
<g id="node39" class="node">
<title>layer0_out_proj_gpu11</title>
<polygon fill="#e8f4fd" stroke="black" points="1000,-3652.93 764,-3652.93 764,-3611.93 1000,-3611.93 1000,-3652.93"/>
<text text-anchor="middle" x="882" y="-3640.93" font-family="Arial" font-size="10.00">GPU11</text>
<text text-anchor="middle" x="882" y="-3629.93" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="882" y="-3618.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_attn_gpu11&#45;&gt;layer0_out_proj_gpu11 -->
<g id="edge49" class="edge">
<title>layer0_attn_gpu11&#45;&gt;layer0_out_proj_gpu11</title>
<path fill="none" stroke="black" d="M745.66,-3632.43C748.3,-3632.43 750.95,-3632.43 753.59,-3632.43"/>
<polygon fill="black" stroke="black" points="753.77,-3635.93 763.77,-3632.43 753.77,-3628.93 753.77,-3635.93"/>
</g>
<!-- layer0_attn_agg -->
<g id="node40" class="node">
<title>layer0_attn_agg</title>
<path fill="#fff4e8" stroke="black" d="M9878.46,-3684.43C9878.46,-3684.43 9476.99,-3684.43 9476.99,-3684.43 9470.99,-3684.43 9460.64,-3680.29 9456.29,-3676.16 9456.29,-3676.16 9364.23,-3588.69 9364.23,-3588.69 9359.88,-3584.56 9361.54,-3580.43 9367.54,-3580.43 9367.54,-3580.43 9769.01,-3580.43 9769.01,-3580.43 9775.01,-3580.43 9785.36,-3584.56 9789.71,-3588.69 9789.71,-3588.69 9881.77,-3676.16 9881.77,-3676.16 9886.12,-3680.29 9884.46,-3684.43 9878.46,-3684.43"/>
<text text-anchor="middle" x="9623" y="-3646.43" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="9623" y="-3635.43" font-family="Arial" font-size="10.00">Aggregation</text>
<text text-anchor="middle" x="9623" y="-3624.43" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="9623" y="-3613.43" font-family="Arial" font-size="10.00">[Input: 12×[1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_out_proj_gpu0&#45;&gt;layer0_attn_agg -->
<g id="edge6" class="edge">
<title>layer0_out_proj_gpu0&#45;&gt;layer0_attn_agg</title>
<path fill="none" stroke="black" d="M9338.07,-3632.43C9358.71,-3632.43 9379.36,-3632.43 9400,-3632.43"/>
<polygon fill="black" stroke="black" points="9400.13,-3635.93 9410.13,-3632.43 9400.13,-3628.93 9400.13,-3635.93"/>
</g>
<!-- layer0_out_proj_gpu1&#45;&gt;layer0_attn_agg -->
<g id="edge10" class="edge">
<title>layer0_out_proj_gpu1&#45;&gt;layer0_attn_agg</title>
<path fill="none" stroke="black" d="M8491.68,-3652.99C8518.18,-3670.03 8558.77,-3692.92 8598,-3702.43 8677.91,-3721.78 9256.37,-3712.3 9338,-3702.43 9374.56,-3698 9413.21,-3690.49 9449.83,-3682"/>
<polygon fill="black" stroke="black" points="9450.67,-3685.4 9459.6,-3679.7 9449.07,-3678.58 9450.67,-3685.4"/>
</g>
<!-- layer0_out_proj_gpu2&#45;&gt;layer0_attn_agg -->
<g id="edge14" class="edge">
<title>layer0_out_proj_gpu2&#45;&gt;layer0_attn_agg</title>
<path fill="none" stroke="black" d="M7733.68,-3652.99C7760.18,-3670.03 7800.77,-3692.92 7840,-3702.43 7920.88,-3722.02 9255.38,-3712.42 9338,-3702.43 9374.56,-3698 9413.21,-3690.49 9449.83,-3682"/>
<polygon fill="black" stroke="black" points="9450.67,-3685.4 9459.6,-3679.7 9449.07,-3678.58 9450.67,-3685.4"/>
</g>
<!-- layer0_out_proj_gpu3&#45;&gt;layer0_attn_agg -->
<g id="edge18" class="edge">
<title>layer0_out_proj_gpu3&#45;&gt;layer0_attn_agg</title>
<path fill="none" stroke="black" d="M6975.68,-3652.99C7002.18,-3670.03 7042.77,-3692.92 7082,-3702.43 7203.81,-3731.93 9213.57,-3717.48 9338,-3702.43 9374.56,-3698 9413.21,-3690.49 9449.83,-3682"/>
<polygon fill="black" stroke="black" points="9450.67,-3685.4 9459.6,-3679.7 9449.07,-3678.58 9450.67,-3685.4"/>
</g>
<!-- layer0_out_proj_gpu4&#45;&gt;layer0_attn_agg -->
<g id="edge22" class="edge">
<title>layer0_out_proj_gpu4&#45;&gt;layer0_attn_agg</title>
<path fill="none" stroke="black" d="M6217.68,-3652.99C6244.18,-3670.03 6284.77,-3692.92 6324,-3702.43 6405.37,-3722.14 9254.88,-3712.48 9338,-3702.43 9374.56,-3698 9413.21,-3690.49 9449.83,-3682"/>
<polygon fill="black" stroke="black" points="9450.67,-3685.4 9459.6,-3679.7 9449.07,-3678.58 9450.67,-3685.4"/>
</g>
<!-- layer0_out_proj_gpu5&#45;&gt;layer0_attn_agg -->
<g id="edge26" class="edge">
<title>layer0_out_proj_gpu5&#45;&gt;layer0_attn_agg</title>
<path fill="none" stroke="black" d="M5459.68,-3652.99C5486.18,-3670.03 5526.77,-3692.92 5566,-3702.43 5667.83,-3727.1 9233.98,-3715.01 9338,-3702.43 9374.56,-3698 9413.21,-3690.49 9449.83,-3682"/>
<polygon fill="black" stroke="black" points="9450.67,-3685.4 9459.6,-3679.7 9449.07,-3678.58 9450.67,-3685.4"/>
</g>
<!-- layer0_out_proj_gpu6&#45;&gt;layer0_attn_agg -->
<g id="edge30" class="edge">
<title>layer0_out_proj_gpu6&#45;&gt;layer0_attn_agg</title>
<path fill="none" stroke="black" d="M4701.68,-3652.99C4728.18,-3670.03 4768.77,-3692.92 4808,-3702.43 4930.3,-3732.05 9213.08,-3717.54 9338,-3702.43 9374.56,-3698 9413.21,-3690.49 9449.83,-3682"/>
<polygon fill="black" stroke="black" points="9450.67,-3685.4 9459.6,-3679.7 9449.07,-3678.58 9450.67,-3685.4"/>
</g>
<!-- layer0_out_proj_gpu7&#45;&gt;layer0_attn_agg -->
<g id="edge34" class="edge">
<title>layer0_out_proj_gpu7&#45;&gt;layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3943.68,-3652.99C3970.18,-3670.03 4010.77,-3692.92 4050,-3702.43 4121.38,-3719.72 9265.09,-3711.25 9338,-3702.43 9374.56,-3698 9413.21,-3690.49 9449.83,-3682"/>
<polygon fill="black" stroke="black" points="9450.67,-3685.4 9459.6,-3679.7 9449.07,-3678.58 9450.67,-3685.4"/>
</g>
<!-- layer0_out_proj_gpu8&#45;&gt;layer0_attn_agg -->
<g id="edge38" class="edge">
<title>layer0_out_proj_gpu8&#45;&gt;layer0_attn_agg</title>
<path fill="none" stroke="black" d="M3185.68,-3652.99C3212.18,-3670.03 3252.77,-3692.92 3292,-3702.43 3373.61,-3722.2 9254.64,-3712.51 9338,-3702.43 9374.56,-3698 9413.21,-3690.49 9449.83,-3682"/>
<polygon fill="black" stroke="black" points="9450.67,-3685.4 9459.6,-3679.7 9449.07,-3678.58 9450.67,-3685.4"/>
</g>
<!-- layer0_out_proj_gpu9&#45;&gt;layer0_attn_agg -->
<g id="edge42" class="edge">
<title>layer0_out_proj_gpu9&#45;&gt;layer0_attn_agg</title>
<path fill="none" stroke="black" d="M2427.68,-3652.99C2454.18,-3670.03 2494.77,-3692.92 2534,-3702.43 2625.84,-3724.68 9244.18,-3713.78 9338,-3702.43 9374.56,-3698 9413.21,-3690.49 9449.83,-3682"/>
<polygon fill="black" stroke="black" points="9450.67,-3685.4 9459.6,-3679.7 9449.07,-3678.58 9450.67,-3685.4"/>
</g>
<!-- layer0_out_proj_gpu10&#45;&gt;layer0_attn_agg -->
<g id="edge46" class="edge">
<title>layer0_out_proj_gpu10&#45;&gt;layer0_attn_agg</title>
<path fill="none" stroke="black" d="M1669.68,-3652.99C1696.18,-3670.03 1736.77,-3692.92 1776,-3702.43 1878.08,-3727.15 9233.73,-3715.04 9338,-3702.43 9374.56,-3698 9413.21,-3690.49 9449.83,-3682"/>
<polygon fill="black" stroke="black" points="9450.67,-3685.4 9459.6,-3679.7 9449.07,-3678.58 9450.67,-3685.4"/>
</g>
<!-- layer0_out_proj_gpu11&#45;&gt;layer0_attn_agg -->
<g id="edge50" class="edge">
<title>layer0_out_proj_gpu11&#45;&gt;layer0_attn_agg</title>
<path fill="none" stroke="black" d="M911.68,-3652.99C938.18,-3670.03 978.77,-3692.92 1018,-3702.43 1130.31,-3729.63 9223.28,-3716.31 9338,-3702.43 9374.56,-3698 9413.21,-3690.49 9449.83,-3682"/>
<polygon fill="black" stroke="black" points="9450.67,-3685.4 9459.6,-3679.7 9449.07,-3678.58 9450.67,-3685.4"/>
</g>
<!-- layer0_attn_agg&#45;&gt;layer0_residual1 -->
<g id="edge51" class="edge">
<title>layer0_attn_agg&#45;&gt;layer0_residual1</title>
<path fill="none" stroke="black" d="M9836.02,-3632.43C9882.38,-3632.43 9928.74,-3632.43 9975.1,-3632.43"/>
<polygon fill="black" stroke="black" points="9975.3,-3635.93 9985.3,-3632.43 9975.3,-3628.93 9975.3,-3635.93"/>
</g>
<!-- layer0_post_attn_norm -->
<g id="node42" class="node">
<title>layer0_post_attn_norm</title>
<polygon fill="#fde8e8" stroke="black" points="11441,-3650.43 11199,-3650.43 11199,-3614.43 11441,-3614.43 11441,-3650.43"/>
<text text-anchor="middle" x="11320" y="-3635.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="11320" y="-3624.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_residual1&#45;&gt;layer0_post_attn_norm -->
<g id="edge53" class="edge">
<title>layer0_residual1&#45;&gt;layer0_post_attn_norm</title>
<path fill="none" stroke="black" d="M10580.73,-3632.43C10783.31,-3632.43 10985.88,-3632.43 11188.45,-3632.43"/>
<polygon fill="black" stroke="black" points="11188.71,-3635.93 11198.71,-3632.43 11188.71,-3628.93 11188.71,-3635.93"/>
</g>
<!-- layer0_residual2 -->
<g id="node52" class="node">
<title>layer0_residual2</title>
<path fill="#fff4e8" stroke="black" d="M11938.04,-3426.43C11938.04,-3426.43 11367.03,-3426.43 11367.03,-3426.43 11361.03,-3426.43 11349.44,-3424.24 11343.86,-3422.05 11343.86,-3422.05 11213.14,-3370.81 11213.14,-3370.81 11207.55,-3368.62 11207.96,-3366.43 11213.96,-3366.43 11213.96,-3366.43 11784.97,-3366.43 11784.97,-3366.43 11790.97,-3366.43 11802.56,-3368.62 11808.14,-3370.81 11808.14,-3370.81 11938.86,-3422.05 11938.86,-3422.05 11944.45,-3424.24 11944.04,-3426.43 11938.04,-3426.43"/>
<text text-anchor="middle" x="11576" y="-3399.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="11576" y="-3388.43" font-family="Arial" font-size="10.00">[Input1: [1024,2048,4096], Input2: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_residual1&#45;&gt;layer0_residual2 -->
<g id="edge71" class="edge">
<title>layer0_residual1&#45;&gt;layer0_residual2</title>
<path fill="none" stroke="black" d="M10078.89,-3602.38C9943.25,-3582.08 9788.2,-3556.54 9778,-3544.43 9754.52,-3516.55 9752.7,-3488.66 9778,-3462.43 9828.86,-3409.69 10771.19,-3399.34 11270.78,-3397.58"/>
<polygon fill="black" stroke="black" points="11271.04,-3401.07 11281.03,-3397.54 11271.02,-3394.07 11271.04,-3401.07"/>
</g>
<!-- layer0_gate_gpu12 -->
<g id="node43" class="node">
<title>layer0_gate_gpu12</title>
<polygon fill="#fde8e8" stroke="black" points="10344.77,-3544.43 9901.31,-3544.43 9787.23,-3462.43 10230.69,-3462.43 10344.77,-3544.43"/>
<text text-anchor="middle" x="10066" y="-3511.93" font-family="Arial" font-size="10.00">GPU12</text>
<text text-anchor="middle" x="10066" y="-3500.93" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="10066" y="-3489.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,16] (routing)]</text>
</g>
<!-- layer0_post_attn_norm&#45;&gt;layer0_gate_gpu12 -->
<g id="edge54" class="edge">
<title>layer0_post_attn_norm&#45;&gt;layer0_gate_gpu12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M11198.95,-3622.41C11015.8,-3608.34 10657.43,-3579.14 10354,-3544.43 10353.66,-3544.39 10353.32,-3544.35 10352.98,-3544.31"/>
<polygon fill="blue" stroke="blue" points="10353.36,-3540.83 10343.02,-3543.15 10352.55,-3547.78 10353.36,-3540.83"/>
</g>
<!-- layer0_gate_gpu13 -->
<g id="node44" class="node">
<title>layer0_gate_gpu13</title>
<polygon fill="#fde8e8" stroke="black" points="11180.77,-3544.43 10737.31,-3544.43 10623.23,-3462.43 11066.69,-3462.43 11180.77,-3544.43"/>
<text text-anchor="middle" x="10902" y="-3511.93" font-family="Arial" font-size="10.00">GPU13</text>
<text text-anchor="middle" x="10902" y="-3500.93" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="10902" y="-3489.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,16] (routing)]</text>
</g>
<!-- layer0_post_attn_norm&#45;&gt;layer0_gate_gpu13 -->
<g id="edge55" class="edge">
<title>layer0_post_attn_norm&#45;&gt;layer0_gate_gpu13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M11263.63,-3614.3C11207.42,-3597.22 11118.84,-3570.31 11043.42,-3547.39"/>
<polygon fill="blue" stroke="blue" points="11044.4,-3544.03 11033.81,-3544.48 11042.36,-3550.73 11044.4,-3544.03"/>
</g>
<!-- layer0_gate_gpu14 -->
<g id="node45" class="node">
<title>layer0_gate_gpu14</title>
<polygon fill="#fde8e8" stroke="black" points="12016.77,-3544.43 11573.31,-3544.43 11459.23,-3462.43 11902.69,-3462.43 12016.77,-3544.43"/>
<text text-anchor="middle" x="11738" y="-3511.93" font-family="Arial" font-size="10.00">GPU14</text>
<text text-anchor="middle" x="11738" y="-3500.93" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="11738" y="-3489.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,16] (routing)]</text>
</g>
<!-- layer0_post_attn_norm&#45;&gt;layer0_gate_gpu14 -->
<g id="edge56" class="edge">
<title>layer0_post_attn_norm&#45;&gt;layer0_gate_gpu14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M11376.37,-3614.3C11432.58,-3597.22 11521.16,-3570.31 11596.58,-3547.39"/>
<polygon fill="blue" stroke="blue" points="11597.64,-3550.73 11606.19,-3544.48 11595.6,-3544.03 11597.64,-3550.73"/>
</g>
<!-- layer0_gate_gpu15 -->
<g id="node46" class="node">
<title>layer0_gate_gpu15</title>
<polygon fill="#fde8e8" stroke="black" points="12852.77,-3544.43 12409.31,-3544.43 12295.23,-3462.43 12738.69,-3462.43 12852.77,-3544.43"/>
<text text-anchor="middle" x="12574" y="-3511.93" font-family="Arial" font-size="10.00">GPU15</text>
<text text-anchor="middle" x="12574" y="-3500.93" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="12574" y="-3489.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,16] (routing)]</text>
</g>
<!-- layer0_post_attn_norm&#45;&gt;layer0_gate_gpu15 -->
<g id="edge57" class="edge">
<title>layer0_post_attn_norm&#45;&gt;layer0_gate_gpu15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M11441.05,-3622.41C11624.2,-3608.34 11982.57,-3579.14 12286,-3544.43 12316.55,-3540.93 12348.86,-3536.84 12380.37,-3532.62"/>
<polygon fill="blue" stroke="blue" points="12381.13,-3536.05 12390.57,-3531.25 12380.2,-3529.11 12381.13,-3536.05"/>
</g>
<!-- layer0_experts_gpu12 -->
<g id="node47" class="node">
<title>layer0_experts_gpu12</title>
<polygon fill="#fde8e8" stroke="black" points="10605,-3523.93 10363,-3523.93 10363,-3482.93 10605,-3482.93 10605,-3523.93"/>
<text text-anchor="middle" x="10484" y="-3511.93" font-family="Arial" font-size="10.00">GPU12</text>
<text text-anchor="middle" x="10484" y="-3500.93" font-family="Arial" font-size="10.00">Experts 0&#45;3</text>
<text text-anchor="middle" x="10484" y="-3489.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_post_attn_norm&#45;&gt;layer0_experts_gpu12 -->
<g id="edge58" class="edge">
<title>layer0_post_attn_norm&#45;&gt;layer0_experts_gpu12</title>
<path fill="none" stroke="black" d="M11198.69,-3623C11057.18,-3611.67 10816.74,-3587.76 10614,-3544.43 10592.67,-3539.87 10569.81,-3533.39 10549.29,-3526.97"/>
<polygon fill="black" stroke="black" points="10550.33,-3523.63 10539.74,-3523.94 10548.21,-3530.3 10550.33,-3523.63"/>
</g>
<!-- layer0_experts_gpu13 -->
<g id="node48" class="node">
<title>layer0_experts_gpu13</title>
<polygon fill="#fde8e8" stroke="black" points="11441,-3523.93 11199,-3523.93 11199,-3482.93 11441,-3482.93 11441,-3523.93"/>
<text text-anchor="middle" x="11320" y="-3511.93" font-family="Arial" font-size="10.00">GPU13</text>
<text text-anchor="middle" x="11320" y="-3500.93" font-family="Arial" font-size="10.00">Experts 4&#45;7</text>
<text text-anchor="middle" x="11320" y="-3489.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_post_attn_norm&#45;&gt;layer0_experts_gpu13 -->
<g id="edge61" class="edge">
<title>layer0_post_attn_norm&#45;&gt;layer0_experts_gpu13</title>
<path fill="none" stroke="black" d="M11320,-3614.3C11320,-3593.8 11320,-3559.13 11320,-3534.21"/>
<polygon fill="black" stroke="black" points="11323.5,-3534.2 11320,-3524.2 11316.5,-3534.2 11323.5,-3534.2"/>
</g>
<!-- layer0_experts_gpu14 -->
<g id="node49" class="node">
<title>layer0_experts_gpu14</title>
<polygon fill="#fde8e8" stroke="black" points="12277,-3523.93 12035,-3523.93 12035,-3482.93 12277,-3482.93 12277,-3523.93"/>
<text text-anchor="middle" x="12156" y="-3511.93" font-family="Arial" font-size="10.00">GPU14</text>
<text text-anchor="middle" x="12156" y="-3500.93" font-family="Arial" font-size="10.00">Experts 8&#45;11</text>
<text text-anchor="middle" x="12156" y="-3489.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_post_attn_norm&#45;&gt;layer0_experts_gpu14 -->
<g id="edge64" class="edge">
<title>layer0_post_attn_norm&#45;&gt;layer0_experts_gpu14</title>
<path fill="none" stroke="black" d="M11441.31,-3623C11582.82,-3611.67 11823.26,-3587.76 12026,-3544.43 12047.33,-3539.87 12070.19,-3533.39 12090.71,-3526.97"/>
<polygon fill="black" stroke="black" points="12091.79,-3530.3 12100.26,-3523.94 12089.67,-3523.63 12091.79,-3530.3"/>
</g>
<!-- layer0_experts_gpu15 -->
<g id="node50" class="node">
<title>layer0_experts_gpu15</title>
<polygon fill="#fde8e8" stroke="black" points="13113,-3523.93 12871,-3523.93 12871,-3482.93 13113,-3482.93 13113,-3523.93"/>
<text text-anchor="middle" x="12992" y="-3511.93" font-family="Arial" font-size="10.00">GPU15</text>
<text text-anchor="middle" x="12992" y="-3500.93" font-family="Arial" font-size="10.00">Experts 12&#45;15</text>
<text text-anchor="middle" x="12992" y="-3489.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_post_attn_norm&#45;&gt;layer0_experts_gpu15 -->
<g id="edge67" class="edge">
<title>layer0_post_attn_norm&#45;&gt;layer0_experts_gpu15</title>
<path fill="none" stroke="black" d="M11441.24,-3628.38C11755.31,-3619.87 12589.83,-3593.23 12862,-3544.43 12884.27,-3540.43 12908.09,-3533.82 12929.17,-3527.12"/>
<polygon fill="black" stroke="black" points="12930.53,-3530.36 12938.96,-3523.93 12928.37,-3523.7 12930.53,-3530.36"/>
</g>
<!-- layer0_gate_gpu12&#45;&gt;layer0_experts_gpu12 -->
<g id="edge59" class="edge">
<title>layer0_gate_gpu12&#45;&gt;layer0_experts_gpu12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10288.06,-3503.43C10309.54,-3503.43 10331.01,-3503.43 10352.48,-3503.43"/>
<polygon fill="red" stroke="red" points="10352.69,-3506.93 10362.69,-3503.43 10352.69,-3499.93 10352.69,-3506.93"/>
</g>
<!-- layer0_gate_gpu13&#45;&gt;layer0_experts_gpu13 -->
<g id="edge62" class="edge">
<title>layer0_gate_gpu13&#45;&gt;layer0_experts_gpu13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M11124.06,-3503.43C11145.54,-3503.43 11167.01,-3503.43 11188.48,-3503.43"/>
<polygon fill="red" stroke="red" points="11188.69,-3506.93 11198.69,-3503.43 11188.69,-3499.93 11188.69,-3506.93"/>
</g>
<!-- layer0_gate_gpu14&#45;&gt;layer0_experts_gpu14 -->
<g id="edge65" class="edge">
<title>layer0_gate_gpu14&#45;&gt;layer0_experts_gpu14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M11960.06,-3503.43C11981.54,-3503.43 12003.01,-3503.43 12024.48,-3503.43"/>
<polygon fill="red" stroke="red" points="12024.69,-3506.93 12034.69,-3503.43 12024.69,-3499.93 12024.69,-3506.93"/>
</g>
<!-- layer0_gate_gpu15&#45;&gt;layer0_experts_gpu15 -->
<g id="edge68" class="edge">
<title>layer0_gate_gpu15&#45;&gt;layer0_experts_gpu15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12796.06,-3503.43C12817.54,-3503.43 12839.01,-3503.43 12860.48,-3503.43"/>
<polygon fill="red" stroke="red" points="12860.69,-3506.93 12870.69,-3503.43 12860.69,-3499.93 12860.69,-3506.93"/>
</g>
<!-- layer0_moe_agg -->
<g id="node51" class="node">
<title>layer0_moe_agg</title>
<path fill="#fff4e8" stroke="black" d="M13643.1,-3544.43C13643.1,-3544.43 13250.16,-3544.43 13250.16,-3544.43 13244.16,-3544.43 13233.39,-3540.78 13228.63,-3537.14 13228.63,-3537.14 13140.44,-3469.71 13140.44,-3469.71 13135.67,-3466.07 13136.9,-3462.43 13142.9,-3462.43 13142.9,-3462.43 13535.84,-3462.43 13535.84,-3462.43 13541.84,-3462.43 13552.61,-3466.07 13557.37,-3469.71 13557.37,-3469.71 13645.56,-3537.14 13645.56,-3537.14 13650.33,-3540.78 13649.1,-3544.43 13643.1,-3544.43"/>
<text text-anchor="middle" x="13393" y="-3511.93" font-family="Arial" font-size="10.00">Expert</text>
<text text-anchor="middle" x="13393" y="-3500.93" font-family="Arial" font-size="10.00">Aggregation</text>
<text text-anchor="middle" x="13393" y="-3489.93" font-family="Arial" font-size="10.00">[Input: 4×[1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_experts_gpu12&#45;&gt;layer0_moe_agg -->
<g id="edge60" class="edge">
<title>layer0_experts_gpu12&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M10521.02,-3523.99C10548.29,-3537.91 10586.78,-3555.06 10623,-3562.43 10758.56,-3590 12975.41,-3576.76 13113,-3562.43 13149.74,-3558.6 13188.76,-3552.02 13225.63,-3544.6"/>
<polygon fill="black" stroke="black" points="13226.37,-3548.03 13235.46,-3542.6 13224.97,-3541.17 13226.37,-3548.03"/>
</g>
<!-- layer0_experts_gpu13&#45;&gt;layer0_moe_agg -->
<g id="edge63" class="edge">
<title>layer0_experts_gpu13&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M11357.02,-3523.99C11384.29,-3537.91 11422.78,-3555.06 11459,-3562.43 11549.04,-3580.75 13021.61,-3571.95 13113,-3562.43 13149.74,-3558.6 13188.76,-3552.02 13225.63,-3544.6"/>
<polygon fill="black" stroke="black" points="13226.37,-3548.03 13235.46,-3542.6 13224.97,-3541.17 13226.37,-3548.03"/>
</g>
<!-- layer0_experts_gpu14&#45;&gt;layer0_moe_agg -->
<g id="edge66" class="edge">
<title>layer0_experts_gpu14&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M12193.02,-3523.99C12220.29,-3537.91 12258.78,-3555.06 12295,-3562.43 12384.06,-3580.55 13022.6,-3571.85 13113,-3562.43 13149.74,-3558.6 13188.76,-3552.02 13225.63,-3544.6"/>
<polygon fill="black" stroke="black" points="13226.37,-3548.03 13235.46,-3542.6 13224.97,-3541.17 13226.37,-3548.03"/>
</g>
<!-- layer0_experts_gpu15&#45;&gt;layer0_moe_agg -->
<g id="edge69" class="edge">
<title>layer0_experts_gpu15&#45;&gt;layer0_moe_agg</title>
<path fill="none" stroke="black" d="M13113,-3503.43C13133.45,-3503.43 13153.89,-3503.43 13174.33,-3503.43"/>
<polygon fill="black" stroke="black" points="13174.37,-3506.93 13184.37,-3503.43 13174.37,-3499.93 13174.37,-3506.93"/>
</g>
<!-- layer0_moe_agg&#45;&gt;layer0_residual2 -->
<g id="edge70" class="edge">
<title>layer0_moe_agg&#45;&gt;layer0_residual2</title>
<path fill="none" stroke="black" d="M13132,-3463.4C13128.65,-3463.07 13125.31,-3462.74 13122,-3462.43 12698.85,-3422.41 12208.21,-3407.03 11895.14,-3401.12"/>
<polygon fill="black" stroke="black" points="11895.07,-3397.62 11885,-3400.93 11894.94,-3404.61 11895.07,-3397.62"/>
</g>
<!-- layer1_pre_attn_norm -->
<g id="node53" class="node">
<title>layer1_pre_attn_norm</title>
<polygon fill="#e8f4fd" stroke="black" points="10989,-3330.43 10747,-3330.43 10747,-3289.43 10989,-3289.43 10989,-3330.43"/>
<text text-anchor="middle" x="10868" y="-3318.43" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="10868" y="-3307.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="10868" y="-3296.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_residual2&#45;&gt;layer1_pre_attn_norm -->
<g id="edge72" class="edge">
<title>layer0_residual2&#45;&gt;layer1_pre_attn_norm</title>
<path fill="none" stroke="black" d="M11332.84,-3366.41C11221.07,-3353.07 11092.91,-3337.77 10999.5,-3326.62"/>
<polygon fill="black" stroke="black" points="10999.77,-3323.13 10989.43,-3325.42 10998.94,-3330.08 10999.77,-3323.13"/>
</g>
<!-- layer1_residual1 -->
<g id="node91" class="node">
<title>layer1_residual1</title>
<path fill="#fff4e8" stroke="black" d="M11826.1,-2882.43C11826.1,-2882.43 11433.16,-2882.43 11433.16,-2882.43 11427.16,-2882.43 11416.39,-2878.78 11411.63,-2875.14 11411.63,-2875.14 11323.44,-2807.71 11323.44,-2807.71 11318.67,-2804.07 11319.9,-2800.43 11325.9,-2800.43 11325.9,-2800.43 11718.84,-2800.43 11718.84,-2800.43 11724.84,-2800.43 11735.61,-2804.07 11740.37,-2807.71 11740.37,-2807.71 11828.56,-2875.14 11828.56,-2875.14 11833.33,-2878.78 11832.1,-2882.43 11826.1,-2882.43"/>
<text text-anchor="middle" x="11576" y="-2849.93" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="11576" y="-2838.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="11576" y="-2827.93" font-family="Arial" font-size="10.00">[Input: 2×[1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_residual2&#45;&gt;layer1_residual1 -->
<g id="edge122" class="edge">
<title>layer0_residual2&#45;&gt;layer1_residual1</title>
<path fill="none" stroke="black" d="M11841.4,-3383.78C12042.34,-3367.45 12284,-3328.21 12284,-3233.93 12284,-3233.93 12284,-3233.93 12284,-3077.93 12284,-2981.47 12044.4,-2917.54 11843.97,-2880.94"/>
<polygon fill="black" stroke="black" points="11844.32,-2877.44 11833.86,-2879.11 11843.07,-2884.33 11844.32,-2877.44"/>
</g>
<!-- layer1_qkv_gpu0 -->
<g id="node54" class="node">
<title>layer1_qkv_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="9462,-3253.43 9226,-3253.43 9226,-3212.43 9462,-3212.43 9462,-3253.43"/>
<text text-anchor="middle" x="9344" y="-3241.43" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="9344" y="-3230.43" font-family="Arial" font-size="10.00">QKV Layer1</text>
<text text-anchor="middle" x="9344" y="-3219.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu0 -->
<g id="edge73" class="edge">
<title>layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu0</title>
<path fill="none" stroke="black" d="M10746.69,-3308.7C10505.64,-3307.23 9949.18,-3298.84 9472.43,-3253.5"/>
<polygon fill="black" stroke="black" points="9472.54,-3250 9462.25,-3252.53 9471.87,-3256.97 9472.54,-3250"/>
</g>
<!-- layer1_qkv_gpu1 -->
<g id="node57" class="node">
<title>layer1_qkv_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="9716,-3253.43 9480,-3253.43 9480,-3212.43 9716,-3212.43 9716,-3253.43"/>
<text text-anchor="middle" x="9598" y="-3241.43" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="9598" y="-3230.43" font-family="Arial" font-size="10.00">QKV Layer1</text>
<text text-anchor="middle" x="9598" y="-3219.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu1 -->
<g id="edge77" class="edge">
<title>layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu1</title>
<path fill="none" stroke="black" d="M10746.73,-3307.17C10539.51,-3303.25 10103.87,-3291.04 9726.28,-3253.5"/>
<polygon fill="black" stroke="black" points="9726.55,-3250.01 9716.25,-3252.49 9725.85,-3256.97 9726.55,-3250.01"/>
</g>
<!-- layer1_qkv_gpu2 -->
<g id="node60" class="node">
<title>layer1_qkv_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="9970,-3253.43 9734,-3253.43 9734,-3212.43 9970,-3212.43 9970,-3253.43"/>
<text text-anchor="middle" x="9852" y="-3241.43" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="9852" y="-3230.43" font-family="Arial" font-size="10.00">QKV Layer1</text>
<text text-anchor="middle" x="9852" y="-3219.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu2 -->
<g id="edge81" class="edge">
<title>layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu2</title>
<path fill="none" stroke="black" d="M10746.92,-3304.82C10577.57,-3298.31 10260.22,-3283.28 9980.2,-3253.51"/>
<polygon fill="black" stroke="black" points="9980.57,-3250.03 9970.26,-3252.44 9979.83,-3256.99 9980.57,-3250.03"/>
</g>
<!-- layer1_qkv_gpu3 -->
<g id="node63" class="node">
<title>layer1_qkv_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="10224,-3253.43 9988,-3253.43 9988,-3212.43 10224,-3212.43 10224,-3253.43"/>
<text text-anchor="middle" x="10106" y="-3241.43" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="10106" y="-3230.43" font-family="Arial" font-size="10.00">QKV Layer1</text>
<text text-anchor="middle" x="10106" y="-3219.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu3 -->
<g id="edge85" class="edge">
<title>layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu3</title>
<path fill="none" stroke="black" d="M10746.91,-3300.7C10621.27,-3291.63 10418.88,-3275.49 10234.43,-3253.56"/>
<polygon fill="black" stroke="black" points="10234.61,-3250.06 10224.27,-3252.34 10233.78,-3257.01 10234.61,-3250.06"/>
</g>
<!-- layer1_qkv_gpu4 -->
<g id="node66" class="node">
<title>layer1_qkv_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="10478,-3253.43 10242,-3253.43 10242,-3212.43 10478,-3212.43 10478,-3253.43"/>
<text text-anchor="middle" x="10360" y="-3241.43" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="10360" y="-3230.43" font-family="Arial" font-size="10.00">QKV Layer1</text>
<text text-anchor="middle" x="10360" y="-3219.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu4 -->
<g id="edge89" class="edge">
<title>layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu4</title>
<path fill="none" stroke="black" d="M10746.99,-3291.54C10674.72,-3281.1 10580.8,-3267.43 10488.39,-3253.63"/>
<polygon fill="black" stroke="black" points="10488.71,-3250.14 10478.3,-3252.12 10487.67,-3257.06 10488.71,-3250.14"/>
</g>
<!-- layer1_qkv_gpu5 -->
<g id="node69" class="node">
<title>layer1_qkv_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="10732,-3253.43 10496,-3253.43 10496,-3212.43 10732,-3212.43 10732,-3253.43"/>
<text text-anchor="middle" x="10614" y="-3241.43" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="10614" y="-3230.43" font-family="Arial" font-size="10.00">QKV Layer1</text>
<text text-anchor="middle" x="10614" y="-3219.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu5 -->
<g id="edge93" class="edge">
<title>layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu5</title>
<path fill="none" stroke="black" d="M10801.93,-3289.42C10767.67,-3279.3 10725.65,-3266.89 10690.04,-3256.38"/>
<polygon fill="black" stroke="black" points="10690.76,-3252.94 10680.18,-3253.47 10688.78,-3259.66 10690.76,-3252.94"/>
</g>
<!-- layer1_qkv_gpu6 -->
<g id="node72" class="node">
<title>layer1_qkv_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="10986,-3253.43 10750,-3253.43 10750,-3212.43 10986,-3212.43 10986,-3253.43"/>
<text text-anchor="middle" x="10868" y="-3241.43" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="10868" y="-3230.43" font-family="Arial" font-size="10.00">QKV Layer1</text>
<text text-anchor="middle" x="10868" y="-3219.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu6 -->
<g id="edge97" class="edge">
<title>layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu6</title>
<path fill="none" stroke="black" d="M10868,-3289.22C10868,-3281.38 10868,-3272.2 10868,-3263.59"/>
<polygon fill="black" stroke="black" points="10871.5,-3263.5 10868,-3253.5 10864.5,-3263.5 10871.5,-3263.5"/>
</g>
<!-- layer1_qkv_gpu7 -->
<g id="node75" class="node">
<title>layer1_qkv_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="11240,-3253.43 11004,-3253.43 11004,-3212.43 11240,-3212.43 11240,-3253.43"/>
<text text-anchor="middle" x="11122" y="-3241.43" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="11122" y="-3230.43" font-family="Arial" font-size="10.00">QKV Layer1</text>
<text text-anchor="middle" x="11122" y="-3219.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu7 -->
<g id="edge101" class="edge">
<title>layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu7</title>
<path fill="none" stroke="black" d="M10934.07,-3289.42C10968.33,-3279.3 11010.35,-3266.89 11045.96,-3256.38"/>
<polygon fill="black" stroke="black" points="11047.22,-3259.66 11055.82,-3253.47 11045.24,-3252.94 11047.22,-3259.66"/>
</g>
<!-- layer1_qkv_gpu8 -->
<g id="node78" class="node">
<title>layer1_qkv_gpu8</title>
<polygon fill="#e8f4fd" stroke="black" points="11494,-3253.43 11258,-3253.43 11258,-3212.43 11494,-3212.43 11494,-3253.43"/>
<text text-anchor="middle" x="11376" y="-3241.43" font-family="Arial" font-size="10.00">GPU8</text>
<text text-anchor="middle" x="11376" y="-3230.43" font-family="Arial" font-size="10.00">QKV Layer1</text>
<text text-anchor="middle" x="11376" y="-3219.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,256]]</text>
</g>
<!-- layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu8 -->
<g id="edge105" class="edge">
<title>layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu8</title>
<path fill="none" stroke="black" d="M10989.01,-3291.54C11061.28,-3281.1 11155.2,-3267.43 11247.61,-3253.63"/>
<polygon fill="black" stroke="black" points="11248.33,-3257.06 11257.7,-3252.12 11247.29,-3250.14 11248.33,-3257.06"/>
</g>
<!-- layer1_qkv_gpu9 -->
<g id="node81" class="node">
<title>layer1_qkv_gpu9</title>
<polygon fill="#e8f4fd" stroke="black" points="11748,-3253.43 11512,-3253.43 11512,-3212.43 11748,-3212.43 11748,-3253.43"/>
<text text-anchor="middle" x="11630" y="-3241.43" font-family="Arial" font-size="10.00">GPU9</text>
<text text-anchor="middle" x="11630" y="-3230.43" font-family="Arial" font-size="10.00">QKV Layer1</text>
<text text-anchor="middle" x="11630" y="-3219.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,256]]</text>
</g>
<!-- layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu9 -->
<g id="edge109" class="edge">
<title>layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu9</title>
<path fill="none" stroke="black" d="M10989.09,-3300.7C11114.73,-3291.63 11317.12,-3275.49 11501.57,-3253.56"/>
<polygon fill="black" stroke="black" points="11502.22,-3257.01 11511.73,-3252.34 11501.39,-3250.06 11502.22,-3257.01"/>
</g>
<!-- layer1_qkv_gpu10 -->
<g id="node84" class="node">
<title>layer1_qkv_gpu10</title>
<polygon fill="#e8f4fd" stroke="black" points="12002,-3253.43 11766,-3253.43 11766,-3212.43 12002,-3212.43 12002,-3253.43"/>
<text text-anchor="middle" x="11884" y="-3241.43" font-family="Arial" font-size="10.00">GPU10</text>
<text text-anchor="middle" x="11884" y="-3230.43" font-family="Arial" font-size="10.00">QKV Layer1</text>
<text text-anchor="middle" x="11884" y="-3219.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,256]]</text>
</g>
<!-- layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu10 -->
<g id="edge113" class="edge">
<title>layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu10</title>
<path fill="none" stroke="black" d="M10989.08,-3304.82C11158.43,-3298.31 11475.78,-3283.28 11755.8,-3253.51"/>
<polygon fill="black" stroke="black" points="11756.17,-3256.99 11765.74,-3252.44 11755.43,-3250.03 11756.17,-3256.99"/>
</g>
<!-- layer1_qkv_gpu11 -->
<g id="node87" class="node">
<title>layer1_qkv_gpu11</title>
<polygon fill="#e8f4fd" stroke="black" points="12256,-3253.43 12020,-3253.43 12020,-3212.43 12256,-3212.43 12256,-3253.43"/>
<text text-anchor="middle" x="12138" y="-3241.43" font-family="Arial" font-size="10.00">GPU11</text>
<text text-anchor="middle" x="12138" y="-3230.43" font-family="Arial" font-size="10.00">QKV Layer1</text>
<text text-anchor="middle" x="12138" y="-3219.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,256]]</text>
</g>
<!-- layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu11 -->
<g id="edge117" class="edge">
<title>layer1_pre_attn_norm&#45;&gt;layer1_qkv_gpu11</title>
<path fill="none" stroke="black" d="M10989.27,-3307.17C11196.49,-3303.25 11632.13,-3291.04 12009.72,-3253.5"/>
<polygon fill="black" stroke="black" points="12010.15,-3256.97 12019.75,-3252.49 12009.45,-3250.01 12010.15,-3256.97"/>
</g>
<!-- layer1_attn_gpu0 -->
<g id="node55" class="node">
<title>layer1_attn_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="9459.5,-3176.43 9228.5,-3176.43 9228.5,-3135.43 9459.5,-3135.43 9459.5,-3176.43"/>
<text text-anchor="middle" x="9344" y="-3164.43" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="9344" y="-3153.43" font-family="Arial" font-size="10.00">Attn Layer1</text>
<text text-anchor="middle" x="9344" y="-3142.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer1_qkv_gpu0&#45;&gt;layer1_attn_gpu0 -->
<g id="edge74" class="edge">
<title>layer1_qkv_gpu0&#45;&gt;layer1_attn_gpu0</title>
<path fill="none" stroke="black" d="M9344,-3212.22C9344,-3204.38 9344,-3195.2 9344,-3186.59"/>
<polygon fill="black" stroke="black" points="9347.5,-3186.5 9344,-3176.5 9340.5,-3186.5 9347.5,-3186.5"/>
</g>
<!-- layer1_out_proj_gpu0 -->
<g id="node56" class="node">
<title>layer1_out_proj_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="9462,-3099.43 9226,-3099.43 9226,-3058.43 9462,-3058.43 9462,-3099.43"/>
<text text-anchor="middle" x="9344" y="-3087.43" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="9344" y="-3076.43" font-family="Arial" font-size="10.00">OutProj Layer1</text>
<text text-anchor="middle" x="9344" y="-3065.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_attn_gpu0&#45;&gt;layer1_out_proj_gpu0 -->
<g id="edge75" class="edge">
<title>layer1_attn_gpu0&#45;&gt;layer1_out_proj_gpu0</title>
<path fill="none" stroke="black" d="M9344,-3135.22C9344,-3127.38 9344,-3118.2 9344,-3109.59"/>
<polygon fill="black" stroke="black" points="9347.5,-3109.5 9344,-3099.5 9340.5,-3109.5 9347.5,-3109.5"/>
</g>
<!-- layer1_attn_agg -->
<g id="node90" class="node">
<title>layer1_attn_agg</title>
<path fill="#fff4e8" stroke="black" d="M11123.46,-3022.43C11123.46,-3022.43 10721.99,-3022.43 10721.99,-3022.43 10715.99,-3022.43 10705.64,-3018.29 10701.29,-3014.16 10701.29,-3014.16 10609.23,-2926.69 10609.23,-2926.69 10604.88,-2922.56 10606.54,-2918.43 10612.54,-2918.43 10612.54,-2918.43 11014.01,-2918.43 11014.01,-2918.43 11020.01,-2918.43 11030.36,-2922.56 11034.71,-2926.69 11034.71,-2926.69 11126.77,-3014.16 11126.77,-3014.16 11131.12,-3018.29 11129.46,-3022.43 11123.46,-3022.43"/>
<text text-anchor="middle" x="10868" y="-2984.43" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="10868" y="-2973.43" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="10868" y="-2962.43" font-family="Arial" font-size="10.00">Aggregation</text>
<text text-anchor="middle" x="10868" y="-2951.43" font-family="Arial" font-size="10.00">[Input: 12×[1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_out_proj_gpu0&#45;&gt;layer1_attn_agg -->
<g id="edge76" class="edge">
<title>layer1_out_proj_gpu0&#45;&gt;layer1_attn_agg</title>
<path fill="none" stroke="black" d="M9462.26,-3059.41C9465.2,-3059.07 9468.12,-3058.74 9471,-3058.43 9888.5,-3013.47 10378.89,-2989.56 10653.54,-2978.77"/>
<polygon fill="black" stroke="black" points="10653.77,-2982.27 10663.63,-2978.38 10653.5,-2975.27 10653.77,-2982.27"/>
</g>
<!-- layer1_attn_gpu1 -->
<g id="node58" class="node">
<title>layer1_attn_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="9713.5,-3176.43 9482.5,-3176.43 9482.5,-3135.43 9713.5,-3135.43 9713.5,-3176.43"/>
<text text-anchor="middle" x="9598" y="-3164.43" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="9598" y="-3153.43" font-family="Arial" font-size="10.00">Attn Layer1</text>
<text text-anchor="middle" x="9598" y="-3142.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer1_qkv_gpu1&#45;&gt;layer1_attn_gpu1 -->
<g id="edge78" class="edge">
<title>layer1_qkv_gpu1&#45;&gt;layer1_attn_gpu1</title>
<path fill="none" stroke="black" d="M9598,-3212.22C9598,-3204.38 9598,-3195.2 9598,-3186.59"/>
<polygon fill="black" stroke="black" points="9601.5,-3186.5 9598,-3176.5 9594.5,-3186.5 9601.5,-3186.5"/>
</g>
<!-- layer1_out_proj_gpu1 -->
<g id="node59" class="node">
<title>layer1_out_proj_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="9716,-3099.43 9480,-3099.43 9480,-3058.43 9716,-3058.43 9716,-3099.43"/>
<text text-anchor="middle" x="9598" y="-3087.43" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="9598" y="-3076.43" font-family="Arial" font-size="10.00">OutProj Layer1</text>
<text text-anchor="middle" x="9598" y="-3065.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_attn_gpu1&#45;&gt;layer1_out_proj_gpu1 -->
<g id="edge79" class="edge">
<title>layer1_attn_gpu1&#45;&gt;layer1_out_proj_gpu1</title>
<path fill="none" stroke="black" d="M9598,-3135.22C9598,-3127.38 9598,-3118.2 9598,-3109.59"/>
<polygon fill="black" stroke="black" points="9601.5,-3109.5 9598,-3099.5 9594.5,-3109.5 9601.5,-3109.5"/>
</g>
<!-- layer1_out_proj_gpu1&#45;&gt;layer1_attn_agg -->
<g id="edge80" class="edge">
<title>layer1_out_proj_gpu1&#45;&gt;layer1_attn_agg</title>
<path fill="none" stroke="black" d="M9716.26,-3059.47C9719.2,-3059.1 9722.12,-3058.76 9725,-3058.43 10049.38,-3021.23 10427.43,-2995.98 10657.13,-2982.64"/>
<polygon fill="black" stroke="black" points="10657.5,-2986.12 10667.28,-2982.05 10657.09,-2979.14 10657.5,-2986.12"/>
</g>
<!-- layer1_attn_gpu2 -->
<g id="node61" class="node">
<title>layer1_attn_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="9967.5,-3176.43 9736.5,-3176.43 9736.5,-3135.43 9967.5,-3135.43 9967.5,-3176.43"/>
<text text-anchor="middle" x="9852" y="-3164.43" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="9852" y="-3153.43" font-family="Arial" font-size="10.00">Attn Layer1</text>
<text text-anchor="middle" x="9852" y="-3142.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer1_qkv_gpu2&#45;&gt;layer1_attn_gpu2 -->
<g id="edge82" class="edge">
<title>layer1_qkv_gpu2&#45;&gt;layer1_attn_gpu2</title>
<path fill="none" stroke="black" d="M9852,-3212.22C9852,-3204.38 9852,-3195.2 9852,-3186.59"/>
<polygon fill="black" stroke="black" points="9855.5,-3186.5 9852,-3176.5 9848.5,-3186.5 9855.5,-3186.5"/>
</g>
<!-- layer1_out_proj_gpu2 -->
<g id="node62" class="node">
<title>layer1_out_proj_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="9970,-3099.43 9734,-3099.43 9734,-3058.43 9970,-3058.43 9970,-3099.43"/>
<text text-anchor="middle" x="9852" y="-3087.43" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="9852" y="-3076.43" font-family="Arial" font-size="10.00">OutProj Layer1</text>
<text text-anchor="middle" x="9852" y="-3065.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_attn_gpu2&#45;&gt;layer1_out_proj_gpu2 -->
<g id="edge83" class="edge">
<title>layer1_attn_gpu2&#45;&gt;layer1_out_proj_gpu2</title>
<path fill="none" stroke="black" d="M9852,-3135.22C9852,-3127.38 9852,-3118.2 9852,-3109.59"/>
<polygon fill="black" stroke="black" points="9855.5,-3109.5 9852,-3099.5 9848.5,-3109.5 9855.5,-3109.5"/>
</g>
<!-- layer1_out_proj_gpu2&#45;&gt;layer1_attn_agg -->
<g id="edge84" class="edge">
<title>layer1_out_proj_gpu2&#45;&gt;layer1_attn_agg</title>
<path fill="none" stroke="black" d="M9970.27,-3059.55C9973.21,-3059.16 9976.12,-3058.79 9979,-3058.43 10212.88,-3029.05 10482.44,-3003.89 10662.85,-2988.29"/>
<polygon fill="black" stroke="black" points="10663.33,-2991.76 10672.99,-2987.42 10662.73,-2984.79 10663.33,-2991.76"/>
</g>
<!-- layer1_attn_gpu3 -->
<g id="node64" class="node">
<title>layer1_attn_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="10221.5,-3176.43 9990.5,-3176.43 9990.5,-3135.43 10221.5,-3135.43 10221.5,-3176.43"/>
<text text-anchor="middle" x="10106" y="-3164.43" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="10106" y="-3153.43" font-family="Arial" font-size="10.00">Attn Layer1</text>
<text text-anchor="middle" x="10106" y="-3142.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer1_qkv_gpu3&#45;&gt;layer1_attn_gpu3 -->
<g id="edge86" class="edge">
<title>layer1_qkv_gpu3&#45;&gt;layer1_attn_gpu3</title>
<path fill="none" stroke="black" d="M10106,-3212.22C10106,-3204.38 10106,-3195.2 10106,-3186.59"/>
<polygon fill="black" stroke="black" points="10109.5,-3186.5 10106,-3176.5 10102.5,-3186.5 10109.5,-3186.5"/>
</g>
<!-- layer1_out_proj_gpu3 -->
<g id="node65" class="node">
<title>layer1_out_proj_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="10224,-3099.43 9988,-3099.43 9988,-3058.43 10224,-3058.43 10224,-3099.43"/>
<text text-anchor="middle" x="10106" y="-3087.43" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="10106" y="-3076.43" font-family="Arial" font-size="10.00">OutProj Layer1</text>
<text text-anchor="middle" x="10106" y="-3065.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_attn_gpu3&#45;&gt;layer1_out_proj_gpu3 -->
<g id="edge87" class="edge">
<title>layer1_attn_gpu3&#45;&gt;layer1_out_proj_gpu3</title>
<path fill="none" stroke="black" d="M10106,-3135.22C10106,-3127.38 10106,-3118.2 10106,-3109.59"/>
<polygon fill="black" stroke="black" points="10109.5,-3109.5 10106,-3099.5 10102.5,-3109.5 10109.5,-3109.5"/>
</g>
<!-- layer1_out_proj_gpu3&#45;&gt;layer1_attn_agg -->
<g id="edge88" class="edge">
<title>layer1_out_proj_gpu3&#45;&gt;layer1_attn_agg</title>
<path fill="none" stroke="black" d="M10224.29,-3059.7C10227.22,-3059.27 10230.13,-3058.84 10233,-3058.43 10380.02,-3037.07 10546.4,-3014.33 10671.96,-2997.45"/>
<polygon fill="black" stroke="black" points="10672.63,-3000.89 10682.07,-2996.09 10671.69,-2993.96 10672.63,-3000.89"/>
</g>
<!-- layer1_attn_gpu4 -->
<g id="node67" class="node">
<title>layer1_attn_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="10475.5,-3176.43 10244.5,-3176.43 10244.5,-3135.43 10475.5,-3135.43 10475.5,-3176.43"/>
<text text-anchor="middle" x="10360" y="-3164.43" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="10360" y="-3153.43" font-family="Arial" font-size="10.00">Attn Layer1</text>
<text text-anchor="middle" x="10360" y="-3142.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer1_qkv_gpu4&#45;&gt;layer1_attn_gpu4 -->
<g id="edge90" class="edge">
<title>layer1_qkv_gpu4&#45;&gt;layer1_attn_gpu4</title>
<path fill="none" stroke="black" d="M10360,-3212.22C10360,-3204.38 10360,-3195.2 10360,-3186.59"/>
<polygon fill="black" stroke="black" points="10363.5,-3186.5 10360,-3176.5 10356.5,-3186.5 10363.5,-3186.5"/>
</g>
<!-- layer1_out_proj_gpu4 -->
<g id="node68" class="node">
<title>layer1_out_proj_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="10478,-3099.43 10242,-3099.43 10242,-3058.43 10478,-3058.43 10478,-3099.43"/>
<text text-anchor="middle" x="10360" y="-3087.43" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="10360" y="-3076.43" font-family="Arial" font-size="10.00">OutProj Layer1</text>
<text text-anchor="middle" x="10360" y="-3065.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_attn_gpu4&#45;&gt;layer1_out_proj_gpu4 -->
<g id="edge91" class="edge">
<title>layer1_attn_gpu4&#45;&gt;layer1_out_proj_gpu4</title>
<path fill="none" stroke="black" d="M10360,-3135.22C10360,-3127.38 10360,-3118.2 10360,-3109.59"/>
<polygon fill="black" stroke="black" points="10363.5,-3109.5 10360,-3099.5 10356.5,-3109.5 10363.5,-3109.5"/>
</g>
<!-- layer1_out_proj_gpu4&#45;&gt;layer1_attn_agg -->
<g id="edge92" class="edge">
<title>layer1_out_proj_gpu4&#45;&gt;layer1_attn_agg</title>
<path fill="none" stroke="black" d="M10453.18,-3058.39C10517.8,-3044.85 10606.01,-3026.35 10684.48,-3009.9"/>
<polygon fill="black" stroke="black" points="10685.42,-3013.28 10694.49,-3007.8 10683.98,-3006.43 10685.42,-3013.28"/>
</g>
<!-- layer1_attn_gpu5 -->
<g id="node70" class="node">
<title>layer1_attn_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="10729.5,-3176.43 10498.5,-3176.43 10498.5,-3135.43 10729.5,-3135.43 10729.5,-3176.43"/>
<text text-anchor="middle" x="10614" y="-3164.43" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="10614" y="-3153.43" font-family="Arial" font-size="10.00">Attn Layer1</text>
<text text-anchor="middle" x="10614" y="-3142.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer1_qkv_gpu5&#45;&gt;layer1_attn_gpu5 -->
<g id="edge94" class="edge">
<title>layer1_qkv_gpu5&#45;&gt;layer1_attn_gpu5</title>
<path fill="none" stroke="black" d="M10614,-3212.22C10614,-3204.38 10614,-3195.2 10614,-3186.59"/>
<polygon fill="black" stroke="black" points="10617.5,-3186.5 10614,-3176.5 10610.5,-3186.5 10617.5,-3186.5"/>
</g>
<!-- layer1_out_proj_gpu5 -->
<g id="node71" class="node">
<title>layer1_out_proj_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="10732,-3099.43 10496,-3099.43 10496,-3058.43 10732,-3058.43 10732,-3099.43"/>
<text text-anchor="middle" x="10614" y="-3087.43" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="10614" y="-3076.43" font-family="Arial" font-size="10.00">OutProj Layer1</text>
<text text-anchor="middle" x="10614" y="-3065.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_attn_gpu5&#45;&gt;layer1_out_proj_gpu5 -->
<g id="edge95" class="edge">
<title>layer1_attn_gpu5&#45;&gt;layer1_out_proj_gpu5</title>
<path fill="none" stroke="black" d="M10614,-3135.22C10614,-3127.38 10614,-3118.2 10614,-3109.59"/>
<polygon fill="black" stroke="black" points="10617.5,-3109.5 10614,-3099.5 10610.5,-3109.5 10617.5,-3109.5"/>
</g>
<!-- layer1_out_proj_gpu5&#45;&gt;layer1_attn_agg -->
<g id="edge96" class="edge">
<title>layer1_out_proj_gpu5&#45;&gt;layer1_attn_agg</title>
<path fill="none" stroke="black" d="M10660.59,-3058.39C10682.4,-3049.25 10709.58,-3037.85 10737.02,-3026.35"/>
<polygon fill="black" stroke="black" points="10738.45,-3029.54 10746.32,-3022.45 10735.75,-3023.08 10738.45,-3029.54"/>
</g>
<!-- layer1_attn_gpu6 -->
<g id="node73" class="node">
<title>layer1_attn_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="10983.5,-3176.43 10752.5,-3176.43 10752.5,-3135.43 10983.5,-3135.43 10983.5,-3176.43"/>
<text text-anchor="middle" x="10868" y="-3164.43" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="10868" y="-3153.43" font-family="Arial" font-size="10.00">Attn Layer1</text>
<text text-anchor="middle" x="10868" y="-3142.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer1_qkv_gpu6&#45;&gt;layer1_attn_gpu6 -->
<g id="edge98" class="edge">
<title>layer1_qkv_gpu6&#45;&gt;layer1_attn_gpu6</title>
<path fill="none" stroke="black" d="M10868,-3212.22C10868,-3204.38 10868,-3195.2 10868,-3186.59"/>
<polygon fill="black" stroke="black" points="10871.5,-3186.5 10868,-3176.5 10864.5,-3186.5 10871.5,-3186.5"/>
</g>
<!-- layer1_out_proj_gpu6 -->
<g id="node74" class="node">
<title>layer1_out_proj_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="10986,-3099.43 10750,-3099.43 10750,-3058.43 10986,-3058.43 10986,-3099.43"/>
<text text-anchor="middle" x="10868" y="-3087.43" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="10868" y="-3076.43" font-family="Arial" font-size="10.00">OutProj Layer1</text>
<text text-anchor="middle" x="10868" y="-3065.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_attn_gpu6&#45;&gt;layer1_out_proj_gpu6 -->
<g id="edge99" class="edge">
<title>layer1_attn_gpu6&#45;&gt;layer1_out_proj_gpu6</title>
<path fill="none" stroke="black" d="M10868,-3135.22C10868,-3127.38 10868,-3118.2 10868,-3109.59"/>
<polygon fill="black" stroke="black" points="10871.5,-3109.5 10868,-3099.5 10864.5,-3109.5 10871.5,-3109.5"/>
</g>
<!-- layer1_out_proj_gpu6&#45;&gt;layer1_attn_agg -->
<g id="edge100" class="edge">
<title>layer1_out_proj_gpu6&#45;&gt;layer1_attn_agg</title>
<path fill="none" stroke="black" d="M10868,-3058.39C10868,-3050.98 10868,-3042.1 10868,-3032.87"/>
<polygon fill="black" stroke="black" points="10871.5,-3032.79 10868,-3022.79 10864.5,-3032.79 10871.5,-3032.79"/>
</g>
<!-- layer1_attn_gpu7 -->
<g id="node76" class="node">
<title>layer1_attn_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="11237.5,-3176.43 11006.5,-3176.43 11006.5,-3135.43 11237.5,-3135.43 11237.5,-3176.43"/>
<text text-anchor="middle" x="11122" y="-3164.43" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="11122" y="-3153.43" font-family="Arial" font-size="10.00">Attn Layer1</text>
<text text-anchor="middle" x="11122" y="-3142.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer1_qkv_gpu7&#45;&gt;layer1_attn_gpu7 -->
<g id="edge102" class="edge">
<title>layer1_qkv_gpu7&#45;&gt;layer1_attn_gpu7</title>
<path fill="none" stroke="black" d="M11122,-3212.22C11122,-3204.38 11122,-3195.2 11122,-3186.59"/>
<polygon fill="black" stroke="black" points="11125.5,-3186.5 11122,-3176.5 11118.5,-3186.5 11125.5,-3186.5"/>
</g>
<!-- layer1_out_proj_gpu7 -->
<g id="node77" class="node">
<title>layer1_out_proj_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="11240,-3099.43 11004,-3099.43 11004,-3058.43 11240,-3058.43 11240,-3099.43"/>
<text text-anchor="middle" x="11122" y="-3087.43" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="11122" y="-3076.43" font-family="Arial" font-size="10.00">OutProj Layer1</text>
<text text-anchor="middle" x="11122" y="-3065.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_attn_gpu7&#45;&gt;layer1_out_proj_gpu7 -->
<g id="edge103" class="edge">
<title>layer1_attn_gpu7&#45;&gt;layer1_out_proj_gpu7</title>
<path fill="none" stroke="black" d="M11122,-3135.22C11122,-3127.38 11122,-3118.2 11122,-3109.59"/>
<polygon fill="black" stroke="black" points="11125.5,-3109.5 11122,-3099.5 11118.5,-3109.5 11125.5,-3109.5"/>
</g>
<!-- layer1_out_proj_gpu7&#45;&gt;layer1_attn_agg -->
<g id="edge104" class="edge">
<title>layer1_out_proj_gpu7&#45;&gt;layer1_attn_agg</title>
<path fill="none" stroke="black" d="M11075.41,-3058.39C11053.6,-3049.25 11026.42,-3037.85 10998.98,-3026.35"/>
<polygon fill="black" stroke="black" points="11000.25,-3023.08 10989.68,-3022.45 10997.55,-3029.54 11000.25,-3023.08"/>
</g>
<!-- layer1_attn_gpu8 -->
<g id="node79" class="node">
<title>layer1_attn_gpu8</title>
<polygon fill="#e8f4fd" stroke="black" points="11491.5,-3176.43 11260.5,-3176.43 11260.5,-3135.43 11491.5,-3135.43 11491.5,-3176.43"/>
<text text-anchor="middle" x="11376" y="-3164.43" font-family="Arial" font-size="10.00">GPU8</text>
<text text-anchor="middle" x="11376" y="-3153.43" font-family="Arial" font-size="10.00">Attn Layer1</text>
<text text-anchor="middle" x="11376" y="-3142.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,256]]</text>
</g>
<!-- layer1_qkv_gpu8&#45;&gt;layer1_attn_gpu8 -->
<g id="edge106" class="edge">
<title>layer1_qkv_gpu8&#45;&gt;layer1_attn_gpu8</title>
<path fill="none" stroke="black" d="M11376,-3212.22C11376,-3204.38 11376,-3195.2 11376,-3186.59"/>
<polygon fill="black" stroke="black" points="11379.5,-3186.5 11376,-3176.5 11372.5,-3186.5 11379.5,-3186.5"/>
</g>
<!-- layer1_out_proj_gpu8 -->
<g id="node80" class="node">
<title>layer1_out_proj_gpu8</title>
<polygon fill="#e8f4fd" stroke="black" points="11494,-3099.43 11258,-3099.43 11258,-3058.43 11494,-3058.43 11494,-3099.43"/>
<text text-anchor="middle" x="11376" y="-3087.43" font-family="Arial" font-size="10.00">GPU8</text>
<text text-anchor="middle" x="11376" y="-3076.43" font-family="Arial" font-size="10.00">OutProj Layer1</text>
<text text-anchor="middle" x="11376" y="-3065.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_attn_gpu8&#45;&gt;layer1_out_proj_gpu8 -->
<g id="edge107" class="edge">
<title>layer1_attn_gpu8&#45;&gt;layer1_out_proj_gpu8</title>
<path fill="none" stroke="black" d="M11376,-3135.22C11376,-3127.38 11376,-3118.2 11376,-3109.59"/>
<polygon fill="black" stroke="black" points="11379.5,-3109.5 11376,-3099.5 11372.5,-3109.5 11379.5,-3109.5"/>
</g>
<!-- layer1_out_proj_gpu8&#45;&gt;layer1_attn_agg -->
<g id="edge108" class="edge">
<title>layer1_out_proj_gpu8&#45;&gt;layer1_attn_agg</title>
<path fill="none" stroke="black" d="M11282.82,-3058.39C11236.93,-3048.77 11179.13,-3036.65 11121.38,-3024.55"/>
<polygon fill="black" stroke="black" points="11121.86,-3021.07 11111.36,-3022.45 11120.43,-3027.92 11121.86,-3021.07"/>
</g>
<!-- layer1_attn_gpu9 -->
<g id="node82" class="node">
<title>layer1_attn_gpu9</title>
<polygon fill="#e8f4fd" stroke="black" points="11745.5,-3176.43 11514.5,-3176.43 11514.5,-3135.43 11745.5,-3135.43 11745.5,-3176.43"/>
<text text-anchor="middle" x="11630" y="-3164.43" font-family="Arial" font-size="10.00">GPU9</text>
<text text-anchor="middle" x="11630" y="-3153.43" font-family="Arial" font-size="10.00">Attn Layer1</text>
<text text-anchor="middle" x="11630" y="-3142.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,256]]</text>
</g>
<!-- layer1_qkv_gpu9&#45;&gt;layer1_attn_gpu9 -->
<g id="edge110" class="edge">
<title>layer1_qkv_gpu9&#45;&gt;layer1_attn_gpu9</title>
<path fill="none" stroke="black" d="M11630,-3212.22C11630,-3204.38 11630,-3195.2 11630,-3186.59"/>
<polygon fill="black" stroke="black" points="11633.5,-3186.5 11630,-3176.5 11626.5,-3186.5 11633.5,-3186.5"/>
</g>
<!-- layer1_out_proj_gpu9 -->
<g id="node83" class="node">
<title>layer1_out_proj_gpu9</title>
<polygon fill="#e8f4fd" stroke="black" points="11748,-3099.43 11512,-3099.43 11512,-3058.43 11748,-3058.43 11748,-3099.43"/>
<text text-anchor="middle" x="11630" y="-3087.43" font-family="Arial" font-size="10.00">GPU9</text>
<text text-anchor="middle" x="11630" y="-3076.43" font-family="Arial" font-size="10.00">OutProj Layer1</text>
<text text-anchor="middle" x="11630" y="-3065.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_attn_gpu9&#45;&gt;layer1_out_proj_gpu9 -->
<g id="edge111" class="edge">
<title>layer1_attn_gpu9&#45;&gt;layer1_out_proj_gpu9</title>
<path fill="none" stroke="black" d="M11630,-3135.22C11630,-3127.38 11630,-3118.2 11630,-3109.59"/>
<polygon fill="black" stroke="black" points="11633.5,-3109.5 11630,-3099.5 11626.5,-3109.5 11633.5,-3109.5"/>
</g>
<!-- layer1_out_proj_gpu9&#45;&gt;layer1_attn_agg -->
<g id="edge112" class="edge">
<title>layer1_out_proj_gpu9&#45;&gt;layer1_attn_agg</title>
<path fill="none" stroke="black" d="M11511.71,-3059.7C11508.78,-3059.27 11505.87,-3058.84 11503,-3058.43 11379.42,-3040.47 11242.15,-3021.54 11126.95,-3005.94"/>
<polygon fill="black" stroke="black" points="11127.31,-3002.46 11116.93,-3004.58 11126.37,-3009.39 11127.31,-3002.46"/>
</g>
<!-- layer1_attn_gpu10 -->
<g id="node85" class="node">
<title>layer1_attn_gpu10</title>
<polygon fill="#e8f4fd" stroke="black" points="11999.5,-3176.43 11768.5,-3176.43 11768.5,-3135.43 11999.5,-3135.43 11999.5,-3176.43"/>
<text text-anchor="middle" x="11884" y="-3164.43" font-family="Arial" font-size="10.00">GPU10</text>
<text text-anchor="middle" x="11884" y="-3153.43" font-family="Arial" font-size="10.00">Attn Layer1</text>
<text text-anchor="middle" x="11884" y="-3142.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,256]]</text>
</g>
<!-- layer1_qkv_gpu10&#45;&gt;layer1_attn_gpu10 -->
<g id="edge114" class="edge">
<title>layer1_qkv_gpu10&#45;&gt;layer1_attn_gpu10</title>
<path fill="none" stroke="black" d="M11884,-3212.22C11884,-3204.38 11884,-3195.2 11884,-3186.59"/>
<polygon fill="black" stroke="black" points="11887.5,-3186.5 11884,-3176.5 11880.5,-3186.5 11887.5,-3186.5"/>
</g>
<!-- layer1_out_proj_gpu10 -->
<g id="node86" class="node">
<title>layer1_out_proj_gpu10</title>
<polygon fill="#e8f4fd" stroke="black" points="12002,-3099.43 11766,-3099.43 11766,-3058.43 12002,-3058.43 12002,-3099.43"/>
<text text-anchor="middle" x="11884" y="-3087.43" font-family="Arial" font-size="10.00">GPU10</text>
<text text-anchor="middle" x="11884" y="-3076.43" font-family="Arial" font-size="10.00">OutProj Layer1</text>
<text text-anchor="middle" x="11884" y="-3065.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_attn_gpu10&#45;&gt;layer1_out_proj_gpu10 -->
<g id="edge115" class="edge">
<title>layer1_attn_gpu10&#45;&gt;layer1_out_proj_gpu10</title>
<path fill="none" stroke="black" d="M11884,-3135.22C11884,-3127.38 11884,-3118.2 11884,-3109.59"/>
<polygon fill="black" stroke="black" points="11887.5,-3109.5 11884,-3099.5 11880.5,-3109.5 11887.5,-3109.5"/>
</g>
<!-- layer1_out_proj_gpu10&#45;&gt;layer1_attn_agg -->
<g id="edge116" class="edge">
<title>layer1_out_proj_gpu10&#45;&gt;layer1_attn_agg</title>
<path fill="none" stroke="black" d="M11765.73,-3059.55C11762.79,-3059.16 11759.88,-3058.79 11757,-3058.43 11539.54,-3031.11 11291.24,-3007.44 11112.43,-2991.71"/>
<polygon fill="black" stroke="black" points="11112.63,-2988.22 11102.36,-2990.83 11112.02,-2995.19 11112.63,-2988.22"/>
</g>
<!-- layer1_attn_gpu11 -->
<g id="node88" class="node">
<title>layer1_attn_gpu11</title>
<polygon fill="#e8f4fd" stroke="black" points="12253.5,-3176.43 12022.5,-3176.43 12022.5,-3135.43 12253.5,-3135.43 12253.5,-3176.43"/>
<text text-anchor="middle" x="12138" y="-3164.43" font-family="Arial" font-size="10.00">GPU11</text>
<text text-anchor="middle" x="12138" y="-3153.43" font-family="Arial" font-size="10.00">Attn Layer1</text>
<text text-anchor="middle" x="12138" y="-3142.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,256]]</text>
</g>
<!-- layer1_qkv_gpu11&#45;&gt;layer1_attn_gpu11 -->
<g id="edge118" class="edge">
<title>layer1_qkv_gpu11&#45;&gt;layer1_attn_gpu11</title>
<path fill="none" stroke="black" d="M12138,-3212.22C12138,-3204.38 12138,-3195.2 12138,-3186.59"/>
<polygon fill="black" stroke="black" points="12141.5,-3186.5 12138,-3176.5 12134.5,-3186.5 12141.5,-3186.5"/>
</g>
<!-- layer1_out_proj_gpu11 -->
<g id="node89" class="node">
<title>layer1_out_proj_gpu11</title>
<polygon fill="#e8f4fd" stroke="black" points="12256,-3099.43 12020,-3099.43 12020,-3058.43 12256,-3058.43 12256,-3099.43"/>
<text text-anchor="middle" x="12138" y="-3087.43" font-family="Arial" font-size="10.00">GPU11</text>
<text text-anchor="middle" x="12138" y="-3076.43" font-family="Arial" font-size="10.00">OutProj Layer1</text>
<text text-anchor="middle" x="12138" y="-3065.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_attn_gpu11&#45;&gt;layer1_out_proj_gpu11 -->
<g id="edge119" class="edge">
<title>layer1_attn_gpu11&#45;&gt;layer1_out_proj_gpu11</title>
<path fill="none" stroke="black" d="M12138,-3135.22C12138,-3127.38 12138,-3118.2 12138,-3109.59"/>
<polygon fill="black" stroke="black" points="12141.5,-3109.5 12138,-3099.5 12134.5,-3109.5 12141.5,-3109.5"/>
</g>
<!-- layer1_out_proj_gpu11&#45;&gt;layer1_attn_agg -->
<g id="edge120" class="edge">
<title>layer1_out_proj_gpu11&#45;&gt;layer1_attn_agg</title>
<path fill="none" stroke="black" d="M12019.74,-3059.47C12016.8,-3059.1 12013.88,-3058.76 12011,-3058.43 11698.56,-3022.6 11336.32,-2997.85 11104.81,-2984.16"/>
<polygon fill="black" stroke="black" points="11104.76,-2980.65 11094.57,-2983.56 11104.35,-2987.64 11104.76,-2980.65"/>
</g>
<!-- layer1_attn_agg&#45;&gt;layer1_residual1 -->
<g id="edge121" class="edge">
<title>layer1_attn_agg&#45;&gt;layer1_residual1</title>
<path fill="none" stroke="black" d="M11046.2,-2937.46C11153.85,-2918.15 11290.57,-2893.63 11398.15,-2874.33"/>
<polygon fill="black" stroke="black" points="11398.92,-2877.75 11408.14,-2872.54 11397.68,-2870.86 11398.92,-2877.75"/>
</g>
<!-- layer1_post_attn_norm -->
<g id="node92" class="node">
<title>layer1_post_attn_norm</title>
<polygon fill="#fde8e8" stroke="black" points="11278,-2764.43 11036,-2764.43 11036,-2723.43 11278,-2723.43 11278,-2764.43"/>
<text text-anchor="middle" x="11157" y="-2752.43" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="11157" y="-2741.43" font-family="Arial" font-size="10.00">Post&#45;Attn LayerNorm</text>
<text text-anchor="middle" x="11157" y="-2730.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_residual1&#45;&gt;layer1_post_attn_norm -->
<g id="edge123" class="edge">
<title>layer1_residual1&#45;&gt;layer1_post_attn_norm</title>
<path fill="none" stroke="black" d="M11400.43,-2800.41C11349.7,-2788.85 11296.24,-2776.66 11252.38,-2766.67"/>
<polygon fill="black" stroke="black" points="11253.13,-2763.25 11242.6,-2764.44 11251.57,-2770.07 11253.13,-2763.25"/>
</g>
<!-- layer1_residual2 -->
<g id="node102" class="node">
<title>layer1_residual2</title>
<path fill="#fff4e8" stroke="black" d="M11827.1,-2352.43C11827.1,-2352.43 11434.16,-2352.43 11434.16,-2352.43 11428.16,-2352.43 11417.39,-2348.78 11412.63,-2345.14 11412.63,-2345.14 11324.44,-2277.71 11324.44,-2277.71 11319.67,-2274.07 11320.9,-2270.43 11326.9,-2270.43 11326.9,-2270.43 11719.84,-2270.43 11719.84,-2270.43 11725.84,-2270.43 11736.61,-2274.07 11741.37,-2277.71 11741.37,-2277.71 11829.56,-2345.14 11829.56,-2345.14 11834.33,-2348.78 11833.1,-2352.43 11827.1,-2352.43"/>
<text text-anchor="middle" x="11577" y="-2319.93" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="11577" y="-2308.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="11577" y="-2297.93" font-family="Arial" font-size="10.00">[Input: 2×[1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_residual1&#45;&gt;layer1_residual2 -->
<g id="edge141" class="edge">
<title>layer1_residual1&#45;&gt;layer1_residual2</title>
<path fill="none" stroke="black" d="M11763.58,-2825.41C11875.5,-2804.99 11996,-2757.46 11996,-2647.43 11996,-2647.43 11996,-2647.43 11996,-2547.93 11996,-2446.98 11902.44,-2388.85 11803.74,-2355.61"/>
<polygon fill="black" stroke="black" points="11804.76,-2352.27 11794.17,-2352.47 11802.58,-2358.92 11804.76,-2352.27"/>
</g>
<!-- layer1_gate_gpu12 -->
<g id="node93" class="node">
<title>layer1_gate_gpu12</title>
<polygon fill="#fde8e8" stroke="black" points="10328.48,-2687.43 9947.52,-2687.43 9849.52,-2605.43 10230.48,-2605.43 10328.48,-2687.43"/>
<text text-anchor="middle" x="10089" y="-2654.93" font-family="Arial" font-size="10.00">GPU12</text>
<text text-anchor="middle" x="10089" y="-2643.93" font-family="Arial" font-size="10.00">Gating Layer1</text>
<text text-anchor="middle" x="10089" y="-2632.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,16]]</text>
</g>
<!-- layer1_post_attn_norm&#45;&gt;layer1_gate_gpu12 -->
<g id="edge124" class="edge">
<title>layer1_post_attn_norm&#45;&gt;layer1_gate_gpu12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M11035.87,-2738.04C10876.43,-2730.84 10587.56,-2715.14 10342,-2687.43 10340.25,-2687.23 10338.5,-2687.03 10336.74,-2686.82"/>
<polygon fill="blue" stroke="blue" points="10336.95,-2683.33 10326.61,-2685.62 10336.13,-2690.28 10336.95,-2683.33"/>
</g>
<!-- layer1_experts_gpu12 -->
<g id="node94" class="node">
<title>layer1_experts_gpu12</title>
<polygon fill="#fde8e8" stroke="black" points="10477,-2569.43 10235,-2569.43 10235,-2528.43 10477,-2528.43 10477,-2569.43"/>
<text text-anchor="middle" x="10356" y="-2557.43" font-family="Arial" font-size="10.00">GPU12</text>
<text text-anchor="middle" x="10356" y="-2546.43" font-family="Arial" font-size="10.00">Experts 0&#45;3</text>
<text text-anchor="middle" x="10356" y="-2535.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_post_attn_norm&#45;&gt;layer1_experts_gpu12 -->
<g id="edge125" class="edge">
<title>layer1_post_attn_norm&#45;&gt;layer1_experts_gpu12</title>
<path fill="none" stroke="black" d="M11035.64,-2742.56C10827.96,-2740.73 10422.08,-2731.48 10375,-2687.43 10346.07,-2660.36 10346.46,-2611.34 10350.45,-2579.74"/>
<polygon fill="black" stroke="black" points="10353.92,-2580.14 10351.9,-2569.74 10347,-2579.13 10353.92,-2580.14"/>
</g>
<!-- layer1_gate_gpu13 -->
<g id="node95" class="node">
<title>layer1_gate_gpu13</title>
<polygon fill="#fde8e8" stroke="black" points="10862.48,-2687.43 10481.52,-2687.43 10383.52,-2605.43 10764.48,-2605.43 10862.48,-2687.43"/>
<text text-anchor="middle" x="10623" y="-2654.93" font-family="Arial" font-size="10.00">GPU13</text>
<text text-anchor="middle" x="10623" y="-2643.93" font-family="Arial" font-size="10.00">Gating Layer1</text>
<text text-anchor="middle" x="10623" y="-2632.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,16]]</text>
</g>
<!-- layer1_post_attn_norm&#45;&gt;layer1_gate_gpu13 -->
<g id="edge128" class="edge">
<title>layer1_post_attn_norm&#45;&gt;layer1_gate_gpu13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M11047.65,-2723.37C10992.5,-2713.51 10923.38,-2701.15 10857.02,-2689.28"/>
<polygon fill="blue" stroke="blue" points="10857.28,-2685.77 10846.82,-2687.45 10856.05,-2692.66 10857.28,-2685.77"/>
</g>
<!-- layer1_experts_gpu13 -->
<g id="node96" class="node">
<title>layer1_experts_gpu13</title>
<polygon fill="#fde8e8" stroke="black" points="11011,-2569.43 10769,-2569.43 10769,-2528.43 11011,-2528.43 11011,-2569.43"/>
<text text-anchor="middle" x="10890" y="-2557.43" font-family="Arial" font-size="10.00">GPU13</text>
<text text-anchor="middle" x="10890" y="-2546.43" font-family="Arial" font-size="10.00">Experts 4&#45;7</text>
<text text-anchor="middle" x="10890" y="-2535.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_post_attn_norm&#45;&gt;layer1_experts_gpu13 -->
<g id="edge129" class="edge">
<title>layer1_post_attn_norm&#45;&gt;layer1_experts_gpu13</title>
<path fill="none" stroke="black" d="M11035.89,-2728.96C10982.08,-2720.2 10926.85,-2706.82 10909,-2687.43 10882.43,-2658.56 10881.97,-2610.8 10885.16,-2579.85"/>
<polygon fill="black" stroke="black" points="10888.66,-2580.01 10886.4,-2569.66 10881.71,-2579.16 10888.66,-2580.01"/>
</g>
<!-- layer1_gate_gpu14 -->
<g id="node97" class="node">
<title>layer1_gate_gpu14</title>
<polygon fill="#fde8e8" stroke="black" points="11396.48,-2687.43 11015.52,-2687.43 10917.52,-2605.43 11298.48,-2605.43 11396.48,-2687.43"/>
<text text-anchor="middle" x="11157" y="-2654.93" font-family="Arial" font-size="10.00">GPU14</text>
<text text-anchor="middle" x="11157" y="-2643.93" font-family="Arial" font-size="10.00">Gating Layer1</text>
<text text-anchor="middle" x="11157" y="-2632.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,16]]</text>
</g>
<!-- layer1_post_attn_norm&#45;&gt;layer1_gate_gpu14 -->
<g id="edge132" class="edge">
<title>layer1_post_attn_norm&#45;&gt;layer1_gate_gpu14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M11157,-2723.14C11157,-2715.68 11157,-2706.81 11157,-2697.81"/>
<polygon fill="blue" stroke="blue" points="11160.5,-2697.67 11157,-2687.67 11153.5,-2697.67 11160.5,-2697.67"/>
</g>
<!-- layer1_experts_gpu14 -->
<g id="node98" class="node">
<title>layer1_experts_gpu14</title>
<polygon fill="#fde8e8" stroke="black" points="11412,-2569.43 11170,-2569.43 11170,-2528.43 11412,-2528.43 11412,-2569.43"/>
<text text-anchor="middle" x="11291" y="-2557.43" font-family="Arial" font-size="10.00">GPU14</text>
<text text-anchor="middle" x="11291" y="-2546.43" font-family="Arial" font-size="10.00">Experts 8&#45;11</text>
<text text-anchor="middle" x="11291" y="-2535.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_post_attn_norm&#45;&gt;layer1_experts_gpu14 -->
<g id="edge133" class="edge">
<title>layer1_post_attn_norm&#45;&gt;layer1_experts_gpu14</title>
<path fill="none" stroke="black" d="M11278.26,-2730.13C11332.69,-2721.63 11388.42,-2708.13 11405,-2687.43 11427.78,-2658.98 11424.32,-2636.33 11405,-2605.43 11396.72,-2592.18 11384.27,-2582.02 11370.6,-2574.24"/>
<polygon fill="black" stroke="black" points="11371.95,-2571 11361.47,-2569.47 11368.71,-2577.2 11371.95,-2571"/>
</g>
<!-- layer1_gate_gpu15 -->
<g id="node99" class="node">
<title>layer1_gate_gpu15</title>
<polygon fill="#fde8e8" stroke="black" points="11930.48,-2687.43 11549.52,-2687.43 11451.52,-2605.43 11832.48,-2605.43 11930.48,-2687.43"/>
<text text-anchor="middle" x="11691" y="-2654.93" font-family="Arial" font-size="10.00">GPU15</text>
<text text-anchor="middle" x="11691" y="-2643.93" font-family="Arial" font-size="10.00">Gating Layer1</text>
<text text-anchor="middle" x="11691" y="-2632.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,16]]</text>
</g>
<!-- layer1_post_attn_norm&#45;&gt;layer1_gate_gpu15 -->
<g id="edge136" class="edge">
<title>layer1_post_attn_norm&#45;&gt;layer1_gate_gpu15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M11266.35,-2723.37C11340.83,-2710.05 11440.81,-2692.17 11525.04,-2677.11"/>
<polygon fill="blue" stroke="blue" points="11525.75,-2680.54 11534.97,-2675.33 11524.51,-2673.65 11525.75,-2680.54"/>
</g>
<!-- layer1_experts_gpu15 -->
<g id="node100" class="node">
<title>layer1_experts_gpu15</title>
<polygon fill="#fde8e8" stroke="black" points="11812,-2569.43 11570,-2569.43 11570,-2528.43 11812,-2528.43 11812,-2569.43"/>
<text text-anchor="middle" x="11691" y="-2557.43" font-family="Arial" font-size="10.00">GPU15</text>
<text text-anchor="middle" x="11691" y="-2546.43" font-family="Arial" font-size="10.00">Experts 12&#45;15</text>
<text text-anchor="middle" x="11691" y="-2535.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_post_attn_norm&#45;&gt;layer1_experts_gpu15 -->
<g id="edge137" class="edge">
<title>layer1_post_attn_norm&#45;&gt;layer1_experts_gpu15</title>
<path fill="none" stroke="black" d="M11278.17,-2743.19C11486.6,-2742.37 11894.99,-2734.67 11939,-2687.43 11963.84,-2660.76 11961.78,-2633.87 11939,-2605.43 11923.42,-2585.98 11873.3,-2572.88 11822.15,-2564.33"/>
<polygon fill="black" stroke="black" points="11822.69,-2560.87 11812.26,-2562.73 11821.57,-2567.78 11822.69,-2560.87"/>
</g>
<!-- layer1_gate_gpu12&#45;&gt;layer1_experts_gpu12 -->
<g id="edge126" class="edge">
<title>layer1_gate_gpu12&#45;&gt;layer1_experts_gpu12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10201.07,-2605.34C10231.96,-2594.29 10264.41,-2582.68 10291.59,-2572.96"/>
<polygon fill="red" stroke="red" points="10293.12,-2576.13 10301.36,-2569.47 10290.76,-2569.54 10293.12,-2576.13"/>
</g>
<!-- layer1_moe_agg -->
<g id="node101" class="node">
<title>layer1_moe_agg</title>
<path fill="#fff4e8" stroke="black" d="M11541.1,-2492.43C11541.1,-2492.43 11148.16,-2492.43 11148.16,-2492.43 11142.16,-2492.43 11131.85,-2488.25 11127.54,-2484.07 11127.54,-2484.07 11037.52,-2396.78 11037.52,-2396.78 11033.21,-2392.6 11034.9,-2388.43 11040.9,-2388.43 11040.9,-2388.43 11433.84,-2388.43 11433.84,-2388.43 11439.84,-2388.43 11450.15,-2392.6 11454.46,-2396.78 11454.46,-2396.78 11544.48,-2484.07 11544.48,-2484.07 11548.79,-2488.25 11547.1,-2492.43 11541.1,-2492.43"/>
<text text-anchor="middle" x="11291" y="-2454.43" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="11291" y="-2443.43" font-family="Arial" font-size="10.00">MoE</text>
<text text-anchor="middle" x="11291" y="-2432.43" font-family="Arial" font-size="10.00">Aggregation</text>
<text text-anchor="middle" x="11291" y="-2421.43" font-family="Arial" font-size="10.00">[Input: 4×[1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_experts_gpu12&#45;&gt;layer1_moe_agg -->
<g id="edge127" class="edge">
<title>layer1_experts_gpu12&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M10477.28,-2534.11C10633.87,-2516.28 10908.38,-2485.01 11094.83,-2463.77"/>
<polygon fill="black" stroke="black" points="11095.49,-2467.22 11105.03,-2462.61 11094.69,-2460.26 11095.49,-2467.22"/>
</g>
<!-- layer1_gate_gpu13&#45;&gt;layer1_experts_gpu13 -->
<g id="edge130" class="edge">
<title>layer1_gate_gpu13&#45;&gt;layer1_experts_gpu13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10735.07,-2605.34C10765.96,-2594.29 10798.41,-2582.68 10825.59,-2572.96"/>
<polygon fill="red" stroke="red" points="10827.12,-2576.13 10835.36,-2569.47 10824.76,-2569.54 10827.12,-2576.13"/>
</g>
<!-- layer1_experts_gpu13&#45;&gt;layer1_moe_agg -->
<g id="edge131" class="edge">
<title>layer1_experts_gpu13&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M10963.55,-2528.39C11007.06,-2516.84 11064.13,-2501.68 11118.41,-2487.26"/>
<polygon fill="black" stroke="black" points="11119.38,-2490.63 11128.15,-2484.68 11117.59,-2483.86 11119.38,-2490.63"/>
</g>
<!-- layer1_gate_gpu14&#45;&gt;layer1_experts_gpu14 -->
<g id="edge134" class="edge">
<title>layer1_gate_gpu14&#45;&gt;layer1_experts_gpu14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M11213.44,-2605.2C11227.5,-2595.18 11242.2,-2584.7 11254.98,-2575.6"/>
<polygon fill="red" stroke="red" points="11257.37,-2578.19 11263.48,-2569.54 11253.31,-2572.49 11257.37,-2578.19"/>
</g>
<!-- layer1_experts_gpu14&#45;&gt;layer1_moe_agg -->
<g id="edge135" class="edge">
<title>layer1_experts_gpu14&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M11291,-2528.39C11291,-2520.98 11291,-2512.1 11291,-2502.87"/>
<polygon fill="black" stroke="black" points="11294.5,-2502.79 11291,-2492.79 11287.5,-2502.79 11294.5,-2502.79"/>
</g>
<!-- layer1_gate_gpu15&#45;&gt;layer1_experts_gpu15 -->
<g id="edge138" class="edge">
<title>layer1_gate_gpu15&#45;&gt;layer1_experts_gpu15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M11691,-2605.2C11691,-2596.63 11691,-2587.72 11691,-2579.62"/>
<polygon fill="red" stroke="red" points="11694.5,-2579.54 11691,-2569.54 11687.5,-2579.54 11694.5,-2579.54"/>
</g>
<!-- layer1_experts_gpu15&#45;&gt;layer1_moe_agg -->
<g id="edge139" class="edge">
<title>layer1_experts_gpu15&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M11617.63,-2528.39C11582.02,-2518.91 11537.3,-2507 11492.48,-2495.07"/>
<polygon fill="black" stroke="black" points="11493.18,-2491.64 11482.62,-2492.45 11491.38,-2498.4 11493.18,-2491.64"/>
</g>
<!-- layer1_moe_agg&#45;&gt;layer1_residual2 -->
<g id="edge140" class="edge">
<title>layer1_moe_agg&#45;&gt;layer1_residual2</title>
<path fill="none" stroke="black" d="M11406.09,-2388.32C11429.69,-2377.84 11454.35,-2366.89 11477.35,-2356.68"/>
<polygon fill="black" stroke="black" points="11479.04,-2359.76 11486.76,-2352.5 11476.2,-2353.36 11479.04,-2359.76"/>
</g>
<!-- layer2_pre_attn_norm -->
<g id="node103" class="node">
<title>layer2_pre_attn_norm</title>
<polygon fill="#e8f4fd" stroke="black" points="10990,-2234.43 10748,-2234.43 10748,-2193.43 10990,-2193.43 10990,-2234.43"/>
<text text-anchor="middle" x="10869" y="-2222.43" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="10869" y="-2211.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="10869" y="-2200.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_residual2&#45;&gt;layer2_pre_attn_norm -->
<g id="edge142" class="edge">
<title>layer1_residual2&#45;&gt;layer2_pre_attn_norm</title>
<path fill="none" stroke="black" d="M11322.15,-2276.05C11213.08,-2261.34 11090.35,-2244.78 11000.15,-2232.62"/>
<polygon fill="black" stroke="black" points="11000.52,-2229.14 10990.15,-2231.27 10999.59,-2236.07 11000.52,-2229.14"/>
</g>
<!-- layer2_residual1 -->
<g id="node141" class="node">
<title>layer2_residual1</title>
<path fill="#fff4e8" stroke="black" d="M11827.1,-1786.43C11827.1,-1786.43 11434.16,-1786.43 11434.16,-1786.43 11428.16,-1786.43 11417.39,-1782.78 11412.63,-1779.14 11412.63,-1779.14 11324.44,-1711.71 11324.44,-1711.71 11319.67,-1708.07 11320.9,-1704.43 11326.9,-1704.43 11326.9,-1704.43 11719.84,-1704.43 11719.84,-1704.43 11725.84,-1704.43 11736.61,-1708.07 11741.37,-1711.71 11741.37,-1711.71 11829.56,-1779.14 11829.56,-1779.14 11834.33,-1782.78 11833.1,-1786.43 11827.1,-1786.43"/>
<text text-anchor="middle" x="11577" y="-1753.93" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="11577" y="-1742.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="11577" y="-1731.93" font-family="Arial" font-size="10.00">[Input: 2×[1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_residual2&#45;&gt;layer2_residual1 -->
<g id="edge192" class="edge">
<title>layer1_residual2&#45;&gt;layer2_residual1</title>
<path fill="none" stroke="black" d="M11771.87,-2300.86C11981.45,-2285.09 12285,-2243.96 12285,-2137.93 12285,-2137.93 12285,-2137.93 12285,-1981.93 12285,-1885.47 12045.4,-1821.54 11844.97,-1784.94"/>
<polygon fill="black" stroke="black" points="11845.32,-1781.44 11834.86,-1783.11 11844.07,-1788.33 11845.32,-1781.44"/>
</g>
<!-- layer2_qkv_gpu0 -->
<g id="node104" class="node">
<title>layer2_qkv_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="9463,-2157.43 9227,-2157.43 9227,-2116.43 9463,-2116.43 9463,-2157.43"/>
<text text-anchor="middle" x="9345" y="-2145.43" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="9345" y="-2134.43" font-family="Arial" font-size="10.00">QKV Layer2</text>
<text text-anchor="middle" x="9345" y="-2123.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu0 -->
<g id="edge143" class="edge">
<title>layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu0</title>
<path fill="none" stroke="black" d="M10747.69,-2212.7C10506.64,-2211.23 9950.18,-2202.84 9473.43,-2157.5"/>
<polygon fill="black" stroke="black" points="9473.54,-2154 9463.25,-2156.53 9472.87,-2160.97 9473.54,-2154"/>
</g>
<!-- layer2_qkv_gpu1 -->
<g id="node107" class="node">
<title>layer2_qkv_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="9717,-2157.43 9481,-2157.43 9481,-2116.43 9717,-2116.43 9717,-2157.43"/>
<text text-anchor="middle" x="9599" y="-2145.43" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="9599" y="-2134.43" font-family="Arial" font-size="10.00">QKV Layer2</text>
<text text-anchor="middle" x="9599" y="-2123.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu1 -->
<g id="edge147" class="edge">
<title>layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu1</title>
<path fill="none" stroke="black" d="M10747.73,-2211.17C10540.51,-2207.25 10104.87,-2195.04 9727.28,-2157.5"/>
<polygon fill="black" stroke="black" points="9727.55,-2154.01 9717.25,-2156.49 9726.85,-2160.97 9727.55,-2154.01"/>
</g>
<!-- layer2_qkv_gpu2 -->
<g id="node110" class="node">
<title>layer2_qkv_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="9971,-2157.43 9735,-2157.43 9735,-2116.43 9971,-2116.43 9971,-2157.43"/>
<text text-anchor="middle" x="9853" y="-2145.43" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="9853" y="-2134.43" font-family="Arial" font-size="10.00">QKV Layer2</text>
<text text-anchor="middle" x="9853" y="-2123.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu2 -->
<g id="edge151" class="edge">
<title>layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu2</title>
<path fill="none" stroke="black" d="M10747.92,-2208.82C10578.57,-2202.31 10261.22,-2187.28 9981.2,-2157.51"/>
<polygon fill="black" stroke="black" points="9981.57,-2154.03 9971.26,-2156.44 9980.83,-2160.99 9981.57,-2154.03"/>
</g>
<!-- layer2_qkv_gpu3 -->
<g id="node113" class="node">
<title>layer2_qkv_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="10225,-2157.43 9989,-2157.43 9989,-2116.43 10225,-2116.43 10225,-2157.43"/>
<text text-anchor="middle" x="10107" y="-2145.43" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="10107" y="-2134.43" font-family="Arial" font-size="10.00">QKV Layer2</text>
<text text-anchor="middle" x="10107" y="-2123.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu3 -->
<g id="edge155" class="edge">
<title>layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu3</title>
<path fill="none" stroke="black" d="M10747.91,-2204.7C10622.27,-2195.63 10419.88,-2179.49 10235.43,-2157.56"/>
<polygon fill="black" stroke="black" points="10235.61,-2154.06 10225.27,-2156.34 10234.78,-2161.01 10235.61,-2154.06"/>
</g>
<!-- layer2_qkv_gpu4 -->
<g id="node116" class="node">
<title>layer2_qkv_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="10479,-2157.43 10243,-2157.43 10243,-2116.43 10479,-2116.43 10479,-2157.43"/>
<text text-anchor="middle" x="10361" y="-2145.43" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="10361" y="-2134.43" font-family="Arial" font-size="10.00">QKV Layer2</text>
<text text-anchor="middle" x="10361" y="-2123.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu4 -->
<g id="edge159" class="edge">
<title>layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu4</title>
<path fill="none" stroke="black" d="M10747.99,-2195.54C10675.72,-2185.1 10581.8,-2171.43 10489.39,-2157.63"/>
<polygon fill="black" stroke="black" points="10489.71,-2154.14 10479.3,-2156.12 10488.67,-2161.06 10489.71,-2154.14"/>
</g>
<!-- layer2_qkv_gpu5 -->
<g id="node119" class="node">
<title>layer2_qkv_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="10733,-2157.43 10497,-2157.43 10497,-2116.43 10733,-2116.43 10733,-2157.43"/>
<text text-anchor="middle" x="10615" y="-2145.43" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="10615" y="-2134.43" font-family="Arial" font-size="10.00">QKV Layer2</text>
<text text-anchor="middle" x="10615" y="-2123.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu5 -->
<g id="edge163" class="edge">
<title>layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu5</title>
<path fill="none" stroke="black" d="M10802.93,-2193.42C10768.67,-2183.3 10726.65,-2170.89 10691.04,-2160.38"/>
<polygon fill="black" stroke="black" points="10691.76,-2156.94 10681.18,-2157.47 10689.78,-2163.66 10691.76,-2156.94"/>
</g>
<!-- layer2_qkv_gpu6 -->
<g id="node122" class="node">
<title>layer2_qkv_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="10987,-2157.43 10751,-2157.43 10751,-2116.43 10987,-2116.43 10987,-2157.43"/>
<text text-anchor="middle" x="10869" y="-2145.43" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="10869" y="-2134.43" font-family="Arial" font-size="10.00">QKV Layer2</text>
<text text-anchor="middle" x="10869" y="-2123.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu6 -->
<g id="edge167" class="edge">
<title>layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu6</title>
<path fill="none" stroke="black" d="M10869,-2193.22C10869,-2185.38 10869,-2176.2 10869,-2167.59"/>
<polygon fill="black" stroke="black" points="10872.5,-2167.5 10869,-2157.5 10865.5,-2167.5 10872.5,-2167.5"/>
</g>
<!-- layer2_qkv_gpu7 -->
<g id="node125" class="node">
<title>layer2_qkv_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="11241,-2157.43 11005,-2157.43 11005,-2116.43 11241,-2116.43 11241,-2157.43"/>
<text text-anchor="middle" x="11123" y="-2145.43" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="11123" y="-2134.43" font-family="Arial" font-size="10.00">QKV Layer2</text>
<text text-anchor="middle" x="11123" y="-2123.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu7 -->
<g id="edge171" class="edge">
<title>layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu7</title>
<path fill="none" stroke="black" d="M10935.07,-2193.42C10969.33,-2183.3 11011.35,-2170.89 11046.96,-2160.38"/>
<polygon fill="black" stroke="black" points="11048.22,-2163.66 11056.82,-2157.47 11046.24,-2156.94 11048.22,-2163.66"/>
</g>
<!-- layer2_qkv_gpu8 -->
<g id="node128" class="node">
<title>layer2_qkv_gpu8</title>
<polygon fill="#e8f4fd" stroke="black" points="11495,-2157.43 11259,-2157.43 11259,-2116.43 11495,-2116.43 11495,-2157.43"/>
<text text-anchor="middle" x="11377" y="-2145.43" font-family="Arial" font-size="10.00">GPU8</text>
<text text-anchor="middle" x="11377" y="-2134.43" font-family="Arial" font-size="10.00">QKV Layer2</text>
<text text-anchor="middle" x="11377" y="-2123.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,256]]</text>
</g>
<!-- layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu8 -->
<g id="edge175" class="edge">
<title>layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu8</title>
<path fill="none" stroke="black" d="M10990.01,-2195.54C11062.28,-2185.1 11156.2,-2171.43 11248.61,-2157.63"/>
<polygon fill="black" stroke="black" points="11249.33,-2161.06 11258.7,-2156.12 11248.29,-2154.14 11249.33,-2161.06"/>
</g>
<!-- layer2_qkv_gpu9 -->
<g id="node131" class="node">
<title>layer2_qkv_gpu9</title>
<polygon fill="#e8f4fd" stroke="black" points="11749,-2157.43 11513,-2157.43 11513,-2116.43 11749,-2116.43 11749,-2157.43"/>
<text text-anchor="middle" x="11631" y="-2145.43" font-family="Arial" font-size="10.00">GPU9</text>
<text text-anchor="middle" x="11631" y="-2134.43" font-family="Arial" font-size="10.00">QKV Layer2</text>
<text text-anchor="middle" x="11631" y="-2123.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,256]]</text>
</g>
<!-- layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu9 -->
<g id="edge179" class="edge">
<title>layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu9</title>
<path fill="none" stroke="black" d="M10990.09,-2204.7C11115.73,-2195.63 11318.12,-2179.49 11502.57,-2157.56"/>
<polygon fill="black" stroke="black" points="11503.22,-2161.01 11512.73,-2156.34 11502.39,-2154.06 11503.22,-2161.01"/>
</g>
<!-- layer2_qkv_gpu10 -->
<g id="node134" class="node">
<title>layer2_qkv_gpu10</title>
<polygon fill="#e8f4fd" stroke="black" points="12003,-2157.43 11767,-2157.43 11767,-2116.43 12003,-2116.43 12003,-2157.43"/>
<text text-anchor="middle" x="11885" y="-2145.43" font-family="Arial" font-size="10.00">GPU10</text>
<text text-anchor="middle" x="11885" y="-2134.43" font-family="Arial" font-size="10.00">QKV Layer2</text>
<text text-anchor="middle" x="11885" y="-2123.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,256]]</text>
</g>
<!-- layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu10 -->
<g id="edge183" class="edge">
<title>layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu10</title>
<path fill="none" stroke="black" d="M10990.08,-2208.82C11159.43,-2202.31 11476.78,-2187.28 11756.8,-2157.51"/>
<polygon fill="black" stroke="black" points="11757.17,-2160.99 11766.74,-2156.44 11756.43,-2154.03 11757.17,-2160.99"/>
</g>
<!-- layer2_qkv_gpu11 -->
<g id="node137" class="node">
<title>layer2_qkv_gpu11</title>
<polygon fill="#e8f4fd" stroke="black" points="12257,-2157.43 12021,-2157.43 12021,-2116.43 12257,-2116.43 12257,-2157.43"/>
<text text-anchor="middle" x="12139" y="-2145.43" font-family="Arial" font-size="10.00">GPU11</text>
<text text-anchor="middle" x="12139" y="-2134.43" font-family="Arial" font-size="10.00">QKV Layer2</text>
<text text-anchor="middle" x="12139" y="-2123.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,256]]</text>
</g>
<!-- layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu11 -->
<g id="edge187" class="edge">
<title>layer2_pre_attn_norm&#45;&gt;layer2_qkv_gpu11</title>
<path fill="none" stroke="black" d="M10990.27,-2211.17C11197.49,-2207.25 11633.13,-2195.04 12010.72,-2157.5"/>
<polygon fill="black" stroke="black" points="12011.15,-2160.97 12020.75,-2156.49 12010.45,-2154.01 12011.15,-2160.97"/>
</g>
<!-- layer2_attn_gpu0 -->
<g id="node105" class="node">
<title>layer2_attn_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="9460.5,-2080.43 9229.5,-2080.43 9229.5,-2039.43 9460.5,-2039.43 9460.5,-2080.43"/>
<text text-anchor="middle" x="9345" y="-2068.43" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="9345" y="-2057.43" font-family="Arial" font-size="10.00">Attn Layer2</text>
<text text-anchor="middle" x="9345" y="-2046.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer2_qkv_gpu0&#45;&gt;layer2_attn_gpu0 -->
<g id="edge144" class="edge">
<title>layer2_qkv_gpu0&#45;&gt;layer2_attn_gpu0</title>
<path fill="none" stroke="black" d="M9345,-2116.22C9345,-2108.38 9345,-2099.2 9345,-2090.59"/>
<polygon fill="black" stroke="black" points="9348.5,-2090.5 9345,-2080.5 9341.5,-2090.5 9348.5,-2090.5"/>
</g>
<!-- layer2_out_proj_gpu0 -->
<g id="node106" class="node">
<title>layer2_out_proj_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="9463,-2003.43 9227,-2003.43 9227,-1962.43 9463,-1962.43 9463,-2003.43"/>
<text text-anchor="middle" x="9345" y="-1991.43" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="9345" y="-1980.43" font-family="Arial" font-size="10.00">OutProj Layer2</text>
<text text-anchor="middle" x="9345" y="-1969.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_attn_gpu0&#45;&gt;layer2_out_proj_gpu0 -->
<g id="edge145" class="edge">
<title>layer2_attn_gpu0&#45;&gt;layer2_out_proj_gpu0</title>
<path fill="none" stroke="black" d="M9345,-2039.22C9345,-2031.38 9345,-2022.2 9345,-2013.59"/>
<polygon fill="black" stroke="black" points="9348.5,-2013.5 9345,-2003.5 9341.5,-2013.5 9348.5,-2013.5"/>
</g>
<!-- layer2_attn_agg -->
<g id="node140" class="node">
<title>layer2_attn_agg</title>
<path fill="#fff4e8" stroke="black" d="M11124.46,-1926.43C11124.46,-1926.43 10722.99,-1926.43 10722.99,-1926.43 10716.99,-1926.43 10706.64,-1922.29 10702.29,-1918.16 10702.29,-1918.16 10610.23,-1830.69 10610.23,-1830.69 10605.88,-1826.56 10607.54,-1822.43 10613.54,-1822.43 10613.54,-1822.43 11015.01,-1822.43 11015.01,-1822.43 11021.01,-1822.43 11031.36,-1826.56 11035.71,-1830.69 11035.71,-1830.69 11127.77,-1918.16 11127.77,-1918.16 11132.12,-1922.29 11130.46,-1926.43 11124.46,-1926.43"/>
<text text-anchor="middle" x="10869" y="-1888.43" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="10869" y="-1877.43" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="10869" y="-1866.43" font-family="Arial" font-size="10.00">Aggregation</text>
<text text-anchor="middle" x="10869" y="-1855.43" font-family="Arial" font-size="10.00">[Input: 12×[1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_out_proj_gpu0&#45;&gt;layer2_attn_agg -->
<g id="edge146" class="edge">
<title>layer2_out_proj_gpu0&#45;&gt;layer2_attn_agg</title>
<path fill="none" stroke="black" d="M9463.26,-1963.41C9466.2,-1963.07 9469.12,-1962.74 9472,-1962.43 9889.5,-1917.47 10379.89,-1893.56 10654.54,-1882.77"/>
<polygon fill="black" stroke="black" points="10654.77,-1886.27 10664.63,-1882.38 10654.5,-1879.27 10654.77,-1886.27"/>
</g>
<!-- layer2_attn_gpu1 -->
<g id="node108" class="node">
<title>layer2_attn_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="9714.5,-2080.43 9483.5,-2080.43 9483.5,-2039.43 9714.5,-2039.43 9714.5,-2080.43"/>
<text text-anchor="middle" x="9599" y="-2068.43" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="9599" y="-2057.43" font-family="Arial" font-size="10.00">Attn Layer2</text>
<text text-anchor="middle" x="9599" y="-2046.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer2_qkv_gpu1&#45;&gt;layer2_attn_gpu1 -->
<g id="edge148" class="edge">
<title>layer2_qkv_gpu1&#45;&gt;layer2_attn_gpu1</title>
<path fill="none" stroke="black" d="M9599,-2116.22C9599,-2108.38 9599,-2099.2 9599,-2090.59"/>
<polygon fill="black" stroke="black" points="9602.5,-2090.5 9599,-2080.5 9595.5,-2090.5 9602.5,-2090.5"/>
</g>
<!-- layer2_out_proj_gpu1 -->
<g id="node109" class="node">
<title>layer2_out_proj_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="9717,-2003.43 9481,-2003.43 9481,-1962.43 9717,-1962.43 9717,-2003.43"/>
<text text-anchor="middle" x="9599" y="-1991.43" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="9599" y="-1980.43" font-family="Arial" font-size="10.00">OutProj Layer2</text>
<text text-anchor="middle" x="9599" y="-1969.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_attn_gpu1&#45;&gt;layer2_out_proj_gpu1 -->
<g id="edge149" class="edge">
<title>layer2_attn_gpu1&#45;&gt;layer2_out_proj_gpu1</title>
<path fill="none" stroke="black" d="M9599,-2039.22C9599,-2031.38 9599,-2022.2 9599,-2013.59"/>
<polygon fill="black" stroke="black" points="9602.5,-2013.5 9599,-2003.5 9595.5,-2013.5 9602.5,-2013.5"/>
</g>
<!-- layer2_out_proj_gpu1&#45;&gt;layer2_attn_agg -->
<g id="edge150" class="edge">
<title>layer2_out_proj_gpu1&#45;&gt;layer2_attn_agg</title>
<path fill="none" stroke="black" d="M9717.26,-1963.47C9720.2,-1963.1 9723.12,-1962.76 9726,-1962.43 10050.38,-1925.23 10428.43,-1899.98 10658.13,-1886.64"/>
<polygon fill="black" stroke="black" points="10658.5,-1890.12 10668.28,-1886.05 10658.09,-1883.14 10658.5,-1890.12"/>
</g>
<!-- layer2_attn_gpu2 -->
<g id="node111" class="node">
<title>layer2_attn_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="9968.5,-2080.43 9737.5,-2080.43 9737.5,-2039.43 9968.5,-2039.43 9968.5,-2080.43"/>
<text text-anchor="middle" x="9853" y="-2068.43" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="9853" y="-2057.43" font-family="Arial" font-size="10.00">Attn Layer2</text>
<text text-anchor="middle" x="9853" y="-2046.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer2_qkv_gpu2&#45;&gt;layer2_attn_gpu2 -->
<g id="edge152" class="edge">
<title>layer2_qkv_gpu2&#45;&gt;layer2_attn_gpu2</title>
<path fill="none" stroke="black" d="M9853,-2116.22C9853,-2108.38 9853,-2099.2 9853,-2090.59"/>
<polygon fill="black" stroke="black" points="9856.5,-2090.5 9853,-2080.5 9849.5,-2090.5 9856.5,-2090.5"/>
</g>
<!-- layer2_out_proj_gpu2 -->
<g id="node112" class="node">
<title>layer2_out_proj_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="9971,-2003.43 9735,-2003.43 9735,-1962.43 9971,-1962.43 9971,-2003.43"/>
<text text-anchor="middle" x="9853" y="-1991.43" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="9853" y="-1980.43" font-family="Arial" font-size="10.00">OutProj Layer2</text>
<text text-anchor="middle" x="9853" y="-1969.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_attn_gpu2&#45;&gt;layer2_out_proj_gpu2 -->
<g id="edge153" class="edge">
<title>layer2_attn_gpu2&#45;&gt;layer2_out_proj_gpu2</title>
<path fill="none" stroke="black" d="M9853,-2039.22C9853,-2031.38 9853,-2022.2 9853,-2013.59"/>
<polygon fill="black" stroke="black" points="9856.5,-2013.5 9853,-2003.5 9849.5,-2013.5 9856.5,-2013.5"/>
</g>
<!-- layer2_out_proj_gpu2&#45;&gt;layer2_attn_agg -->
<g id="edge154" class="edge">
<title>layer2_out_proj_gpu2&#45;&gt;layer2_attn_agg</title>
<path fill="none" stroke="black" d="M9971.27,-1963.55C9974.21,-1963.16 9977.12,-1962.79 9980,-1962.43 10213.88,-1933.05 10483.44,-1907.89 10663.85,-1892.29"/>
<polygon fill="black" stroke="black" points="10664.33,-1895.76 10673.99,-1891.42 10663.73,-1888.79 10664.33,-1895.76"/>
</g>
<!-- layer2_attn_gpu3 -->
<g id="node114" class="node">
<title>layer2_attn_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="10222.5,-2080.43 9991.5,-2080.43 9991.5,-2039.43 10222.5,-2039.43 10222.5,-2080.43"/>
<text text-anchor="middle" x="10107" y="-2068.43" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="10107" y="-2057.43" font-family="Arial" font-size="10.00">Attn Layer2</text>
<text text-anchor="middle" x="10107" y="-2046.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer2_qkv_gpu3&#45;&gt;layer2_attn_gpu3 -->
<g id="edge156" class="edge">
<title>layer2_qkv_gpu3&#45;&gt;layer2_attn_gpu3</title>
<path fill="none" stroke="black" d="M10107,-2116.22C10107,-2108.38 10107,-2099.2 10107,-2090.59"/>
<polygon fill="black" stroke="black" points="10110.5,-2090.5 10107,-2080.5 10103.5,-2090.5 10110.5,-2090.5"/>
</g>
<!-- layer2_out_proj_gpu3 -->
<g id="node115" class="node">
<title>layer2_out_proj_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="10225,-2003.43 9989,-2003.43 9989,-1962.43 10225,-1962.43 10225,-2003.43"/>
<text text-anchor="middle" x="10107" y="-1991.43" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="10107" y="-1980.43" font-family="Arial" font-size="10.00">OutProj Layer2</text>
<text text-anchor="middle" x="10107" y="-1969.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_attn_gpu3&#45;&gt;layer2_out_proj_gpu3 -->
<g id="edge157" class="edge">
<title>layer2_attn_gpu3&#45;&gt;layer2_out_proj_gpu3</title>
<path fill="none" stroke="black" d="M10107,-2039.22C10107,-2031.38 10107,-2022.2 10107,-2013.59"/>
<polygon fill="black" stroke="black" points="10110.5,-2013.5 10107,-2003.5 10103.5,-2013.5 10110.5,-2013.5"/>
</g>
<!-- layer2_out_proj_gpu3&#45;&gt;layer2_attn_agg -->
<g id="edge158" class="edge">
<title>layer2_out_proj_gpu3&#45;&gt;layer2_attn_agg</title>
<path fill="none" stroke="black" d="M10225.29,-1963.7C10228.22,-1963.27 10231.13,-1962.84 10234,-1962.43 10381.02,-1941.07 10547.4,-1918.33 10672.96,-1901.45"/>
<polygon fill="black" stroke="black" points="10673.63,-1904.89 10683.07,-1900.09 10672.69,-1897.96 10673.63,-1904.89"/>
</g>
<!-- layer2_attn_gpu4 -->
<g id="node117" class="node">
<title>layer2_attn_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="10476.5,-2080.43 10245.5,-2080.43 10245.5,-2039.43 10476.5,-2039.43 10476.5,-2080.43"/>
<text text-anchor="middle" x="10361" y="-2068.43" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="10361" y="-2057.43" font-family="Arial" font-size="10.00">Attn Layer2</text>
<text text-anchor="middle" x="10361" y="-2046.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer2_qkv_gpu4&#45;&gt;layer2_attn_gpu4 -->
<g id="edge160" class="edge">
<title>layer2_qkv_gpu4&#45;&gt;layer2_attn_gpu4</title>
<path fill="none" stroke="black" d="M10361,-2116.22C10361,-2108.38 10361,-2099.2 10361,-2090.59"/>
<polygon fill="black" stroke="black" points="10364.5,-2090.5 10361,-2080.5 10357.5,-2090.5 10364.5,-2090.5"/>
</g>
<!-- layer2_out_proj_gpu4 -->
<g id="node118" class="node">
<title>layer2_out_proj_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="10479,-2003.43 10243,-2003.43 10243,-1962.43 10479,-1962.43 10479,-2003.43"/>
<text text-anchor="middle" x="10361" y="-1991.43" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="10361" y="-1980.43" font-family="Arial" font-size="10.00">OutProj Layer2</text>
<text text-anchor="middle" x="10361" y="-1969.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_attn_gpu4&#45;&gt;layer2_out_proj_gpu4 -->
<g id="edge161" class="edge">
<title>layer2_attn_gpu4&#45;&gt;layer2_out_proj_gpu4</title>
<path fill="none" stroke="black" d="M10361,-2039.22C10361,-2031.38 10361,-2022.2 10361,-2013.59"/>
<polygon fill="black" stroke="black" points="10364.5,-2013.5 10361,-2003.5 10357.5,-2013.5 10364.5,-2013.5"/>
</g>
<!-- layer2_out_proj_gpu4&#45;&gt;layer2_attn_agg -->
<g id="edge162" class="edge">
<title>layer2_out_proj_gpu4&#45;&gt;layer2_attn_agg</title>
<path fill="none" stroke="black" d="M10454.18,-1962.39C10518.8,-1948.85 10607.01,-1930.35 10685.48,-1913.9"/>
<polygon fill="black" stroke="black" points="10686.42,-1917.28 10695.49,-1911.8 10684.98,-1910.43 10686.42,-1917.28"/>
</g>
<!-- layer2_attn_gpu5 -->
<g id="node120" class="node">
<title>layer2_attn_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="10730.5,-2080.43 10499.5,-2080.43 10499.5,-2039.43 10730.5,-2039.43 10730.5,-2080.43"/>
<text text-anchor="middle" x="10615" y="-2068.43" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="10615" y="-2057.43" font-family="Arial" font-size="10.00">Attn Layer2</text>
<text text-anchor="middle" x="10615" y="-2046.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer2_qkv_gpu5&#45;&gt;layer2_attn_gpu5 -->
<g id="edge164" class="edge">
<title>layer2_qkv_gpu5&#45;&gt;layer2_attn_gpu5</title>
<path fill="none" stroke="black" d="M10615,-2116.22C10615,-2108.38 10615,-2099.2 10615,-2090.59"/>
<polygon fill="black" stroke="black" points="10618.5,-2090.5 10615,-2080.5 10611.5,-2090.5 10618.5,-2090.5"/>
</g>
<!-- layer2_out_proj_gpu5 -->
<g id="node121" class="node">
<title>layer2_out_proj_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="10733,-2003.43 10497,-2003.43 10497,-1962.43 10733,-1962.43 10733,-2003.43"/>
<text text-anchor="middle" x="10615" y="-1991.43" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="10615" y="-1980.43" font-family="Arial" font-size="10.00">OutProj Layer2</text>
<text text-anchor="middle" x="10615" y="-1969.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_attn_gpu5&#45;&gt;layer2_out_proj_gpu5 -->
<g id="edge165" class="edge">
<title>layer2_attn_gpu5&#45;&gt;layer2_out_proj_gpu5</title>
<path fill="none" stroke="black" d="M10615,-2039.22C10615,-2031.38 10615,-2022.2 10615,-2013.59"/>
<polygon fill="black" stroke="black" points="10618.5,-2013.5 10615,-2003.5 10611.5,-2013.5 10618.5,-2013.5"/>
</g>
<!-- layer2_out_proj_gpu5&#45;&gt;layer2_attn_agg -->
<g id="edge166" class="edge">
<title>layer2_out_proj_gpu5&#45;&gt;layer2_attn_agg</title>
<path fill="none" stroke="black" d="M10661.59,-1962.39C10683.4,-1953.25 10710.58,-1941.85 10738.02,-1930.35"/>
<polygon fill="black" stroke="black" points="10739.45,-1933.54 10747.32,-1926.45 10736.75,-1927.08 10739.45,-1933.54"/>
</g>
<!-- layer2_attn_gpu6 -->
<g id="node123" class="node">
<title>layer2_attn_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="10984.5,-2080.43 10753.5,-2080.43 10753.5,-2039.43 10984.5,-2039.43 10984.5,-2080.43"/>
<text text-anchor="middle" x="10869" y="-2068.43" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="10869" y="-2057.43" font-family="Arial" font-size="10.00">Attn Layer2</text>
<text text-anchor="middle" x="10869" y="-2046.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer2_qkv_gpu6&#45;&gt;layer2_attn_gpu6 -->
<g id="edge168" class="edge">
<title>layer2_qkv_gpu6&#45;&gt;layer2_attn_gpu6</title>
<path fill="none" stroke="black" d="M10869,-2116.22C10869,-2108.38 10869,-2099.2 10869,-2090.59"/>
<polygon fill="black" stroke="black" points="10872.5,-2090.5 10869,-2080.5 10865.5,-2090.5 10872.5,-2090.5"/>
</g>
<!-- layer2_out_proj_gpu6 -->
<g id="node124" class="node">
<title>layer2_out_proj_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="10987,-2003.43 10751,-2003.43 10751,-1962.43 10987,-1962.43 10987,-2003.43"/>
<text text-anchor="middle" x="10869" y="-1991.43" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="10869" y="-1980.43" font-family="Arial" font-size="10.00">OutProj Layer2</text>
<text text-anchor="middle" x="10869" y="-1969.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_attn_gpu6&#45;&gt;layer2_out_proj_gpu6 -->
<g id="edge169" class="edge">
<title>layer2_attn_gpu6&#45;&gt;layer2_out_proj_gpu6</title>
<path fill="none" stroke="black" d="M10869,-2039.22C10869,-2031.38 10869,-2022.2 10869,-2013.59"/>
<polygon fill="black" stroke="black" points="10872.5,-2013.5 10869,-2003.5 10865.5,-2013.5 10872.5,-2013.5"/>
</g>
<!-- layer2_out_proj_gpu6&#45;&gt;layer2_attn_agg -->
<g id="edge170" class="edge">
<title>layer2_out_proj_gpu6&#45;&gt;layer2_attn_agg</title>
<path fill="none" stroke="black" d="M10869,-1962.39C10869,-1954.98 10869,-1946.1 10869,-1936.87"/>
<polygon fill="black" stroke="black" points="10872.5,-1936.79 10869,-1926.79 10865.5,-1936.79 10872.5,-1936.79"/>
</g>
<!-- layer2_attn_gpu7 -->
<g id="node126" class="node">
<title>layer2_attn_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="11238.5,-2080.43 11007.5,-2080.43 11007.5,-2039.43 11238.5,-2039.43 11238.5,-2080.43"/>
<text text-anchor="middle" x="11123" y="-2068.43" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="11123" y="-2057.43" font-family="Arial" font-size="10.00">Attn Layer2</text>
<text text-anchor="middle" x="11123" y="-2046.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer2_qkv_gpu7&#45;&gt;layer2_attn_gpu7 -->
<g id="edge172" class="edge">
<title>layer2_qkv_gpu7&#45;&gt;layer2_attn_gpu7</title>
<path fill="none" stroke="black" d="M11123,-2116.22C11123,-2108.38 11123,-2099.2 11123,-2090.59"/>
<polygon fill="black" stroke="black" points="11126.5,-2090.5 11123,-2080.5 11119.5,-2090.5 11126.5,-2090.5"/>
</g>
<!-- layer2_out_proj_gpu7 -->
<g id="node127" class="node">
<title>layer2_out_proj_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="11241,-2003.43 11005,-2003.43 11005,-1962.43 11241,-1962.43 11241,-2003.43"/>
<text text-anchor="middle" x="11123" y="-1991.43" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="11123" y="-1980.43" font-family="Arial" font-size="10.00">OutProj Layer2</text>
<text text-anchor="middle" x="11123" y="-1969.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_attn_gpu7&#45;&gt;layer2_out_proj_gpu7 -->
<g id="edge173" class="edge">
<title>layer2_attn_gpu7&#45;&gt;layer2_out_proj_gpu7</title>
<path fill="none" stroke="black" d="M11123,-2039.22C11123,-2031.38 11123,-2022.2 11123,-2013.59"/>
<polygon fill="black" stroke="black" points="11126.5,-2013.5 11123,-2003.5 11119.5,-2013.5 11126.5,-2013.5"/>
</g>
<!-- layer2_out_proj_gpu7&#45;&gt;layer2_attn_agg -->
<g id="edge174" class="edge">
<title>layer2_out_proj_gpu7&#45;&gt;layer2_attn_agg</title>
<path fill="none" stroke="black" d="M11076.41,-1962.39C11054.6,-1953.25 11027.42,-1941.85 10999.98,-1930.35"/>
<polygon fill="black" stroke="black" points="11001.25,-1927.08 10990.68,-1926.45 10998.55,-1933.54 11001.25,-1927.08"/>
</g>
<!-- layer2_attn_gpu8 -->
<g id="node129" class="node">
<title>layer2_attn_gpu8</title>
<polygon fill="#e8f4fd" stroke="black" points="11492.5,-2080.43 11261.5,-2080.43 11261.5,-2039.43 11492.5,-2039.43 11492.5,-2080.43"/>
<text text-anchor="middle" x="11377" y="-2068.43" font-family="Arial" font-size="10.00">GPU8</text>
<text text-anchor="middle" x="11377" y="-2057.43" font-family="Arial" font-size="10.00">Attn Layer2</text>
<text text-anchor="middle" x="11377" y="-2046.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,256]]</text>
</g>
<!-- layer2_qkv_gpu8&#45;&gt;layer2_attn_gpu8 -->
<g id="edge176" class="edge">
<title>layer2_qkv_gpu8&#45;&gt;layer2_attn_gpu8</title>
<path fill="none" stroke="black" d="M11377,-2116.22C11377,-2108.38 11377,-2099.2 11377,-2090.59"/>
<polygon fill="black" stroke="black" points="11380.5,-2090.5 11377,-2080.5 11373.5,-2090.5 11380.5,-2090.5"/>
</g>
<!-- layer2_out_proj_gpu8 -->
<g id="node130" class="node">
<title>layer2_out_proj_gpu8</title>
<polygon fill="#e8f4fd" stroke="black" points="11495,-2003.43 11259,-2003.43 11259,-1962.43 11495,-1962.43 11495,-2003.43"/>
<text text-anchor="middle" x="11377" y="-1991.43" font-family="Arial" font-size="10.00">GPU8</text>
<text text-anchor="middle" x="11377" y="-1980.43" font-family="Arial" font-size="10.00">OutProj Layer2</text>
<text text-anchor="middle" x="11377" y="-1969.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_attn_gpu8&#45;&gt;layer2_out_proj_gpu8 -->
<g id="edge177" class="edge">
<title>layer2_attn_gpu8&#45;&gt;layer2_out_proj_gpu8</title>
<path fill="none" stroke="black" d="M11377,-2039.22C11377,-2031.38 11377,-2022.2 11377,-2013.59"/>
<polygon fill="black" stroke="black" points="11380.5,-2013.5 11377,-2003.5 11373.5,-2013.5 11380.5,-2013.5"/>
</g>
<!-- layer2_out_proj_gpu8&#45;&gt;layer2_attn_agg -->
<g id="edge178" class="edge">
<title>layer2_out_proj_gpu8&#45;&gt;layer2_attn_agg</title>
<path fill="none" stroke="black" d="M11283.82,-1962.39C11237.93,-1952.77 11180.13,-1940.65 11122.38,-1928.55"/>
<polygon fill="black" stroke="black" points="11122.86,-1925.07 11112.36,-1926.45 11121.43,-1931.92 11122.86,-1925.07"/>
</g>
<!-- layer2_attn_gpu9 -->
<g id="node132" class="node">
<title>layer2_attn_gpu9</title>
<polygon fill="#e8f4fd" stroke="black" points="11746.5,-2080.43 11515.5,-2080.43 11515.5,-2039.43 11746.5,-2039.43 11746.5,-2080.43"/>
<text text-anchor="middle" x="11631" y="-2068.43" font-family="Arial" font-size="10.00">GPU9</text>
<text text-anchor="middle" x="11631" y="-2057.43" font-family="Arial" font-size="10.00">Attn Layer2</text>
<text text-anchor="middle" x="11631" y="-2046.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,256]]</text>
</g>
<!-- layer2_qkv_gpu9&#45;&gt;layer2_attn_gpu9 -->
<g id="edge180" class="edge">
<title>layer2_qkv_gpu9&#45;&gt;layer2_attn_gpu9</title>
<path fill="none" stroke="black" d="M11631,-2116.22C11631,-2108.38 11631,-2099.2 11631,-2090.59"/>
<polygon fill="black" stroke="black" points="11634.5,-2090.5 11631,-2080.5 11627.5,-2090.5 11634.5,-2090.5"/>
</g>
<!-- layer2_out_proj_gpu9 -->
<g id="node133" class="node">
<title>layer2_out_proj_gpu9</title>
<polygon fill="#e8f4fd" stroke="black" points="11749,-2003.43 11513,-2003.43 11513,-1962.43 11749,-1962.43 11749,-2003.43"/>
<text text-anchor="middle" x="11631" y="-1991.43" font-family="Arial" font-size="10.00">GPU9</text>
<text text-anchor="middle" x="11631" y="-1980.43" font-family="Arial" font-size="10.00">OutProj Layer2</text>
<text text-anchor="middle" x="11631" y="-1969.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_attn_gpu9&#45;&gt;layer2_out_proj_gpu9 -->
<g id="edge181" class="edge">
<title>layer2_attn_gpu9&#45;&gt;layer2_out_proj_gpu9</title>
<path fill="none" stroke="black" d="M11631,-2039.22C11631,-2031.38 11631,-2022.2 11631,-2013.59"/>
<polygon fill="black" stroke="black" points="11634.5,-2013.5 11631,-2003.5 11627.5,-2013.5 11634.5,-2013.5"/>
</g>
<!-- layer2_out_proj_gpu9&#45;&gt;layer2_attn_agg -->
<g id="edge182" class="edge">
<title>layer2_out_proj_gpu9&#45;&gt;layer2_attn_agg</title>
<path fill="none" stroke="black" d="M11512.71,-1963.7C11509.78,-1963.27 11506.87,-1962.84 11504,-1962.43 11380.42,-1944.47 11243.15,-1925.54 11127.95,-1909.94"/>
<polygon fill="black" stroke="black" points="11128.31,-1906.46 11117.93,-1908.58 11127.37,-1913.39 11128.31,-1906.46"/>
</g>
<!-- layer2_attn_gpu10 -->
<g id="node135" class="node">
<title>layer2_attn_gpu10</title>
<polygon fill="#e8f4fd" stroke="black" points="12000.5,-2080.43 11769.5,-2080.43 11769.5,-2039.43 12000.5,-2039.43 12000.5,-2080.43"/>
<text text-anchor="middle" x="11885" y="-2068.43" font-family="Arial" font-size="10.00">GPU10</text>
<text text-anchor="middle" x="11885" y="-2057.43" font-family="Arial" font-size="10.00">Attn Layer2</text>
<text text-anchor="middle" x="11885" y="-2046.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,256]]</text>
</g>
<!-- layer2_qkv_gpu10&#45;&gt;layer2_attn_gpu10 -->
<g id="edge184" class="edge">
<title>layer2_qkv_gpu10&#45;&gt;layer2_attn_gpu10</title>
<path fill="none" stroke="black" d="M11885,-2116.22C11885,-2108.38 11885,-2099.2 11885,-2090.59"/>
<polygon fill="black" stroke="black" points="11888.5,-2090.5 11885,-2080.5 11881.5,-2090.5 11888.5,-2090.5"/>
</g>
<!-- layer2_out_proj_gpu10 -->
<g id="node136" class="node">
<title>layer2_out_proj_gpu10</title>
<polygon fill="#e8f4fd" stroke="black" points="12003,-2003.43 11767,-2003.43 11767,-1962.43 12003,-1962.43 12003,-2003.43"/>
<text text-anchor="middle" x="11885" y="-1991.43" font-family="Arial" font-size="10.00">GPU10</text>
<text text-anchor="middle" x="11885" y="-1980.43" font-family="Arial" font-size="10.00">OutProj Layer2</text>
<text text-anchor="middle" x="11885" y="-1969.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_attn_gpu10&#45;&gt;layer2_out_proj_gpu10 -->
<g id="edge185" class="edge">
<title>layer2_attn_gpu10&#45;&gt;layer2_out_proj_gpu10</title>
<path fill="none" stroke="black" d="M11885,-2039.22C11885,-2031.38 11885,-2022.2 11885,-2013.59"/>
<polygon fill="black" stroke="black" points="11888.5,-2013.5 11885,-2003.5 11881.5,-2013.5 11888.5,-2013.5"/>
</g>
<!-- layer2_out_proj_gpu10&#45;&gt;layer2_attn_agg -->
<g id="edge186" class="edge">
<title>layer2_out_proj_gpu10&#45;&gt;layer2_attn_agg</title>
<path fill="none" stroke="black" d="M11766.73,-1963.55C11763.79,-1963.16 11760.88,-1962.79 11758,-1962.43 11540.54,-1935.11 11292.24,-1911.44 11113.43,-1895.71"/>
<polygon fill="black" stroke="black" points="11113.63,-1892.22 11103.36,-1894.83 11113.02,-1899.19 11113.63,-1892.22"/>
</g>
<!-- layer2_attn_gpu11 -->
<g id="node138" class="node">
<title>layer2_attn_gpu11</title>
<polygon fill="#e8f4fd" stroke="black" points="12254.5,-2080.43 12023.5,-2080.43 12023.5,-2039.43 12254.5,-2039.43 12254.5,-2080.43"/>
<text text-anchor="middle" x="12139" y="-2068.43" font-family="Arial" font-size="10.00">GPU11</text>
<text text-anchor="middle" x="12139" y="-2057.43" font-family="Arial" font-size="10.00">Attn Layer2</text>
<text text-anchor="middle" x="12139" y="-2046.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,256]]</text>
</g>
<!-- layer2_qkv_gpu11&#45;&gt;layer2_attn_gpu11 -->
<g id="edge188" class="edge">
<title>layer2_qkv_gpu11&#45;&gt;layer2_attn_gpu11</title>
<path fill="none" stroke="black" d="M12139,-2116.22C12139,-2108.38 12139,-2099.2 12139,-2090.59"/>
<polygon fill="black" stroke="black" points="12142.5,-2090.5 12139,-2080.5 12135.5,-2090.5 12142.5,-2090.5"/>
</g>
<!-- layer2_out_proj_gpu11 -->
<g id="node139" class="node">
<title>layer2_out_proj_gpu11</title>
<polygon fill="#e8f4fd" stroke="black" points="12257,-2003.43 12021,-2003.43 12021,-1962.43 12257,-1962.43 12257,-2003.43"/>
<text text-anchor="middle" x="12139" y="-1991.43" font-family="Arial" font-size="10.00">GPU11</text>
<text text-anchor="middle" x="12139" y="-1980.43" font-family="Arial" font-size="10.00">OutProj Layer2</text>
<text text-anchor="middle" x="12139" y="-1969.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_attn_gpu11&#45;&gt;layer2_out_proj_gpu11 -->
<g id="edge189" class="edge">
<title>layer2_attn_gpu11&#45;&gt;layer2_out_proj_gpu11</title>
<path fill="none" stroke="black" d="M12139,-2039.22C12139,-2031.38 12139,-2022.2 12139,-2013.59"/>
<polygon fill="black" stroke="black" points="12142.5,-2013.5 12139,-2003.5 12135.5,-2013.5 12142.5,-2013.5"/>
</g>
<!-- layer2_out_proj_gpu11&#45;&gt;layer2_attn_agg -->
<g id="edge190" class="edge">
<title>layer2_out_proj_gpu11&#45;&gt;layer2_attn_agg</title>
<path fill="none" stroke="black" d="M12020.74,-1963.47C12017.8,-1963.1 12014.88,-1962.76 12012,-1962.43 11699.56,-1926.6 11337.32,-1901.85 11105.81,-1888.16"/>
<polygon fill="black" stroke="black" points="11105.76,-1884.65 11095.57,-1887.56 11105.35,-1891.64 11105.76,-1884.65"/>
</g>
<!-- layer2_attn_agg&#45;&gt;layer2_residual1 -->
<g id="edge191" class="edge">
<title>layer2_attn_agg&#45;&gt;layer2_residual1</title>
<path fill="none" stroke="black" d="M11047.2,-1841.46C11154.85,-1822.15 11291.57,-1797.63 11399.15,-1778.33"/>
<polygon fill="black" stroke="black" points="11399.92,-1781.75 11409.14,-1776.54 11398.68,-1774.86 11399.92,-1781.75"/>
</g>
<!-- layer2_post_attn_norm -->
<g id="node142" class="node">
<title>layer2_post_attn_norm</title>
<polygon fill="#fde8e8" stroke="black" points="11279,-1668.43 11037,-1668.43 11037,-1627.43 11279,-1627.43 11279,-1668.43"/>
<text text-anchor="middle" x="11158" y="-1656.43" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="11158" y="-1645.43" font-family="Arial" font-size="10.00">Post&#45;Attn LayerNorm</text>
<text text-anchor="middle" x="11158" y="-1634.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_residual1&#45;&gt;layer2_post_attn_norm -->
<g id="edge193" class="edge">
<title>layer2_residual1&#45;&gt;layer2_post_attn_norm</title>
<path fill="none" stroke="black" d="M11401.43,-1704.41C11350.7,-1692.85 11297.24,-1680.66 11253.38,-1670.67"/>
<polygon fill="black" stroke="black" points="11254.13,-1667.25 11243.6,-1668.44 11252.57,-1674.07 11254.13,-1667.25"/>
</g>
<!-- layer2_residual2 -->
<g id="node152" class="node">
<title>layer2_residual2</title>
<path fill="#fff4e8" stroke="black" d="M11828.1,-1256.43C11828.1,-1256.43 11435.16,-1256.43 11435.16,-1256.43 11429.16,-1256.43 11418.39,-1252.78 11413.63,-1249.14 11413.63,-1249.14 11325.44,-1181.71 11325.44,-1181.71 11320.67,-1178.07 11321.9,-1174.43 11327.9,-1174.43 11327.9,-1174.43 11720.84,-1174.43 11720.84,-1174.43 11726.84,-1174.43 11737.61,-1178.07 11742.37,-1181.71 11742.37,-1181.71 11830.56,-1249.14 11830.56,-1249.14 11835.33,-1252.78 11834.1,-1256.43 11828.1,-1256.43"/>
<text text-anchor="middle" x="11578" y="-1223.93" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="11578" y="-1212.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="11578" y="-1201.93" font-family="Arial" font-size="10.00">[Input: 2×[1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_residual1&#45;&gt;layer2_residual2 -->
<g id="edge211" class="edge">
<title>layer2_residual1&#45;&gt;layer2_residual2</title>
<path fill="none" stroke="black" d="M11764.58,-1729.41C11876.5,-1708.99 11997,-1661.46 11997,-1551.43 11997,-1551.43 11997,-1551.43 11997,-1451.93 11997,-1350.98 11903.44,-1292.85 11804.74,-1259.61"/>
<polygon fill="black" stroke="black" points="11805.76,-1256.27 11795.17,-1256.47 11803.58,-1262.92 11805.76,-1256.27"/>
</g>
<!-- layer2_gate_gpu12 -->
<g id="node143" class="node">
<title>layer2_gate_gpu12</title>
<polygon fill="#fde8e8" stroke="black" points="10329.48,-1591.43 9948.52,-1591.43 9850.52,-1509.43 10231.48,-1509.43 10329.48,-1591.43"/>
<text text-anchor="middle" x="10090" y="-1558.93" font-family="Arial" font-size="10.00">GPU12</text>
<text text-anchor="middle" x="10090" y="-1547.93" font-family="Arial" font-size="10.00">Gating Layer2</text>
<text text-anchor="middle" x="10090" y="-1536.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,16]]</text>
</g>
<!-- layer2_post_attn_norm&#45;&gt;layer2_gate_gpu12 -->
<g id="edge194" class="edge">
<title>layer2_post_attn_norm&#45;&gt;layer2_gate_gpu12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M11036.87,-1642.04C10877.43,-1634.84 10588.56,-1619.14 10343,-1591.43 10341.25,-1591.23 10339.5,-1591.03 10337.74,-1590.82"/>
<polygon fill="blue" stroke="blue" points="10337.95,-1587.33 10327.61,-1589.62 10337.13,-1594.28 10337.95,-1587.33"/>
</g>
<!-- layer2_experts_gpu12 -->
<g id="node144" class="node">
<title>layer2_experts_gpu12</title>
<polygon fill="#fde8e8" stroke="black" points="10478,-1473.43 10236,-1473.43 10236,-1432.43 10478,-1432.43 10478,-1473.43"/>
<text text-anchor="middle" x="10357" y="-1461.43" font-family="Arial" font-size="10.00">GPU12</text>
<text text-anchor="middle" x="10357" y="-1450.43" font-family="Arial" font-size="10.00">Experts 0&#45;3</text>
<text text-anchor="middle" x="10357" y="-1439.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_post_attn_norm&#45;&gt;layer2_experts_gpu12 -->
<g id="edge195" class="edge">
<title>layer2_post_attn_norm&#45;&gt;layer2_experts_gpu12</title>
<path fill="none" stroke="black" d="M11036.64,-1646.56C10828.96,-1644.73 10423.08,-1635.48 10376,-1591.43 10347.07,-1564.36 10347.46,-1515.34 10351.45,-1483.74"/>
<polygon fill="black" stroke="black" points="10354.92,-1484.14 10352.9,-1473.74 10348,-1483.13 10354.92,-1484.14"/>
</g>
<!-- layer2_gate_gpu13 -->
<g id="node145" class="node">
<title>layer2_gate_gpu13</title>
<polygon fill="#fde8e8" stroke="black" points="10863.48,-1591.43 10482.52,-1591.43 10384.52,-1509.43 10765.48,-1509.43 10863.48,-1591.43"/>
<text text-anchor="middle" x="10624" y="-1558.93" font-family="Arial" font-size="10.00">GPU13</text>
<text text-anchor="middle" x="10624" y="-1547.93" font-family="Arial" font-size="10.00">Gating Layer2</text>
<text text-anchor="middle" x="10624" y="-1536.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,16]]</text>
</g>
<!-- layer2_post_attn_norm&#45;&gt;layer2_gate_gpu13 -->
<g id="edge198" class="edge">
<title>layer2_post_attn_norm&#45;&gt;layer2_gate_gpu13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M11048.65,-1627.37C10993.5,-1617.51 10924.38,-1605.15 10858.02,-1593.28"/>
<polygon fill="blue" stroke="blue" points="10858.28,-1589.77 10847.82,-1591.45 10857.05,-1596.66 10858.28,-1589.77"/>
</g>
<!-- layer2_experts_gpu13 -->
<g id="node146" class="node">
<title>layer2_experts_gpu13</title>
<polygon fill="#fde8e8" stroke="black" points="11012,-1473.43 10770,-1473.43 10770,-1432.43 11012,-1432.43 11012,-1473.43"/>
<text text-anchor="middle" x="10891" y="-1461.43" font-family="Arial" font-size="10.00">GPU13</text>
<text text-anchor="middle" x="10891" y="-1450.43" font-family="Arial" font-size="10.00">Experts 4&#45;7</text>
<text text-anchor="middle" x="10891" y="-1439.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_post_attn_norm&#45;&gt;layer2_experts_gpu13 -->
<g id="edge199" class="edge">
<title>layer2_post_attn_norm&#45;&gt;layer2_experts_gpu13</title>
<path fill="none" stroke="black" d="M11036.89,-1632.96C10983.08,-1624.2 10927.85,-1610.82 10910,-1591.43 10883.43,-1562.56 10882.97,-1514.8 10886.16,-1483.85"/>
<polygon fill="black" stroke="black" points="10889.66,-1484.01 10887.4,-1473.66 10882.71,-1483.16 10889.66,-1484.01"/>
</g>
<!-- layer2_gate_gpu14 -->
<g id="node147" class="node">
<title>layer2_gate_gpu14</title>
<polygon fill="#fde8e8" stroke="black" points="11397.48,-1591.43 11016.52,-1591.43 10918.52,-1509.43 11299.48,-1509.43 11397.48,-1591.43"/>
<text text-anchor="middle" x="11158" y="-1558.93" font-family="Arial" font-size="10.00">GPU14</text>
<text text-anchor="middle" x="11158" y="-1547.93" font-family="Arial" font-size="10.00">Gating Layer2</text>
<text text-anchor="middle" x="11158" y="-1536.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,16]]</text>
</g>
<!-- layer2_post_attn_norm&#45;&gt;layer2_gate_gpu14 -->
<g id="edge202" class="edge">
<title>layer2_post_attn_norm&#45;&gt;layer2_gate_gpu14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M11158,-1627.14C11158,-1619.68 11158,-1610.81 11158,-1601.81"/>
<polygon fill="blue" stroke="blue" points="11161.5,-1601.67 11158,-1591.67 11154.5,-1601.67 11161.5,-1601.67"/>
</g>
<!-- layer2_experts_gpu14 -->
<g id="node148" class="node">
<title>layer2_experts_gpu14</title>
<polygon fill="#fde8e8" stroke="black" points="11413,-1473.43 11171,-1473.43 11171,-1432.43 11413,-1432.43 11413,-1473.43"/>
<text text-anchor="middle" x="11292" y="-1461.43" font-family="Arial" font-size="10.00">GPU14</text>
<text text-anchor="middle" x="11292" y="-1450.43" font-family="Arial" font-size="10.00">Experts 8&#45;11</text>
<text text-anchor="middle" x="11292" y="-1439.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_post_attn_norm&#45;&gt;layer2_experts_gpu14 -->
<g id="edge203" class="edge">
<title>layer2_post_attn_norm&#45;&gt;layer2_experts_gpu14</title>
<path fill="none" stroke="black" d="M11279.26,-1634.13C11333.69,-1625.63 11389.42,-1612.13 11406,-1591.43 11428.78,-1562.98 11425.32,-1540.33 11406,-1509.43 11397.72,-1496.18 11385.27,-1486.02 11371.6,-1478.24"/>
<polygon fill="black" stroke="black" points="11372.95,-1475 11362.47,-1473.47 11369.71,-1481.2 11372.95,-1475"/>
</g>
<!-- layer2_gate_gpu15 -->
<g id="node149" class="node">
<title>layer2_gate_gpu15</title>
<polygon fill="#fde8e8" stroke="black" points="11931.48,-1591.43 11550.52,-1591.43 11452.52,-1509.43 11833.48,-1509.43 11931.48,-1591.43"/>
<text text-anchor="middle" x="11692" y="-1558.93" font-family="Arial" font-size="10.00">GPU15</text>
<text text-anchor="middle" x="11692" y="-1547.93" font-family="Arial" font-size="10.00">Gating Layer2</text>
<text text-anchor="middle" x="11692" y="-1536.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,16]]</text>
</g>
<!-- layer2_post_attn_norm&#45;&gt;layer2_gate_gpu15 -->
<g id="edge206" class="edge">
<title>layer2_post_attn_norm&#45;&gt;layer2_gate_gpu15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M11267.35,-1627.37C11341.83,-1614.05 11441.81,-1596.17 11526.04,-1581.11"/>
<polygon fill="blue" stroke="blue" points="11526.75,-1584.54 11535.97,-1579.33 11525.51,-1577.65 11526.75,-1584.54"/>
</g>
<!-- layer2_experts_gpu15 -->
<g id="node150" class="node">
<title>layer2_experts_gpu15</title>
<polygon fill="#fde8e8" stroke="black" points="11813,-1473.43 11571,-1473.43 11571,-1432.43 11813,-1432.43 11813,-1473.43"/>
<text text-anchor="middle" x="11692" y="-1461.43" font-family="Arial" font-size="10.00">GPU15</text>
<text text-anchor="middle" x="11692" y="-1450.43" font-family="Arial" font-size="10.00">Experts 12&#45;15</text>
<text text-anchor="middle" x="11692" y="-1439.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_post_attn_norm&#45;&gt;layer2_experts_gpu15 -->
<g id="edge207" class="edge">
<title>layer2_post_attn_norm&#45;&gt;layer2_experts_gpu15</title>
<path fill="none" stroke="black" d="M11279.17,-1647.19C11487.6,-1646.37 11895.99,-1638.67 11940,-1591.43 11964.84,-1564.76 11962.78,-1537.87 11940,-1509.43 11924.42,-1489.98 11874.3,-1476.88 11823.15,-1468.33"/>
<polygon fill="black" stroke="black" points="11823.69,-1464.87 11813.26,-1466.73 11822.57,-1471.78 11823.69,-1464.87"/>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_experts_gpu12 -->
<g id="edge196" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_experts_gpu12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10202.07,-1509.34C10232.96,-1498.29 10265.41,-1486.68 10292.59,-1476.96"/>
<polygon fill="red" stroke="red" points="10294.12,-1480.13 10302.36,-1473.47 10291.76,-1473.54 10294.12,-1480.13"/>
</g>
<!-- layer2_moe_agg -->
<g id="node151" class="node">
<title>layer2_moe_agg</title>
<path fill="#fff4e8" stroke="black" d="M11542.1,-1396.43C11542.1,-1396.43 11149.16,-1396.43 11149.16,-1396.43 11143.16,-1396.43 11132.85,-1392.25 11128.54,-1388.07 11128.54,-1388.07 11038.52,-1300.78 11038.52,-1300.78 11034.21,-1296.6 11035.9,-1292.43 11041.9,-1292.43 11041.9,-1292.43 11434.84,-1292.43 11434.84,-1292.43 11440.84,-1292.43 11451.15,-1296.6 11455.46,-1300.78 11455.46,-1300.78 11545.48,-1388.07 11545.48,-1388.07 11549.79,-1392.25 11548.1,-1396.43 11542.1,-1396.43"/>
<text text-anchor="middle" x="11292" y="-1358.43" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="11292" y="-1347.43" font-family="Arial" font-size="10.00">MoE</text>
<text text-anchor="middle" x="11292" y="-1336.43" font-family="Arial" font-size="10.00">Aggregation</text>
<text text-anchor="middle" x="11292" y="-1325.43" font-family="Arial" font-size="10.00">[Input: 4×[1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_experts_gpu12&#45;&gt;layer2_moe_agg -->
<g id="edge197" class="edge">
<title>layer2_experts_gpu12&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M10478.28,-1438.11C10634.87,-1420.28 10909.38,-1389.01 11095.83,-1367.77"/>
<polygon fill="black" stroke="black" points="11096.49,-1371.22 11106.03,-1366.61 11095.69,-1364.26 11096.49,-1371.22"/>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_experts_gpu13 -->
<g id="edge200" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_experts_gpu13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10736.07,-1509.34C10766.96,-1498.29 10799.41,-1486.68 10826.59,-1476.96"/>
<polygon fill="red" stroke="red" points="10828.12,-1480.13 10836.36,-1473.47 10825.76,-1473.54 10828.12,-1480.13"/>
</g>
<!-- layer2_experts_gpu13&#45;&gt;layer2_moe_agg -->
<g id="edge201" class="edge">
<title>layer2_experts_gpu13&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M10964.55,-1432.39C11008.06,-1420.84 11065.13,-1405.68 11119.41,-1391.26"/>
<polygon fill="black" stroke="black" points="11120.38,-1394.63 11129.15,-1388.68 11118.59,-1387.86 11120.38,-1394.63"/>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_experts_gpu14 -->
<g id="edge204" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_experts_gpu14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M11214.44,-1509.2C11228.5,-1499.18 11243.2,-1488.7 11255.98,-1479.6"/>
<polygon fill="red" stroke="red" points="11258.37,-1482.19 11264.48,-1473.54 11254.31,-1476.49 11258.37,-1482.19"/>
</g>
<!-- layer2_experts_gpu14&#45;&gt;layer2_moe_agg -->
<g id="edge205" class="edge">
<title>layer2_experts_gpu14&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M11292,-1432.39C11292,-1424.98 11292,-1416.1 11292,-1406.87"/>
<polygon fill="black" stroke="black" points="11295.5,-1406.79 11292,-1396.79 11288.5,-1406.79 11295.5,-1406.79"/>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_experts_gpu15 -->
<g id="edge208" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_experts_gpu15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M11692,-1509.2C11692,-1500.63 11692,-1491.72 11692,-1483.62"/>
<polygon fill="red" stroke="red" points="11695.5,-1483.54 11692,-1473.54 11688.5,-1483.54 11695.5,-1483.54"/>
</g>
<!-- layer2_experts_gpu15&#45;&gt;layer2_moe_agg -->
<g id="edge209" class="edge">
<title>layer2_experts_gpu15&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M11618.63,-1432.39C11583.02,-1422.91 11538.3,-1411 11493.48,-1399.07"/>
<polygon fill="black" stroke="black" points="11494.18,-1395.64 11483.62,-1396.45 11492.38,-1402.4 11494.18,-1395.64"/>
</g>
<!-- layer2_moe_agg&#45;&gt;layer2_residual2 -->
<g id="edge210" class="edge">
<title>layer2_moe_agg&#45;&gt;layer2_residual2</title>
<path fill="none" stroke="black" d="M11407.09,-1292.32C11430.69,-1281.84 11455.35,-1270.89 11478.35,-1260.68"/>
<polygon fill="black" stroke="black" points="11480.04,-1263.76 11487.76,-1256.5 11477.2,-1257.36 11480.04,-1263.76"/>
</g>
<!-- layer3_pre_attn_norm -->
<g id="node153" class="node">
<title>layer3_pre_attn_norm</title>
<polygon fill="#e8f4fd" stroke="black" points="10991,-1138.43 10749,-1138.43 10749,-1097.43 10991,-1097.43 10991,-1138.43"/>
<text text-anchor="middle" x="10870" y="-1126.43" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="10870" y="-1115.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="10870" y="-1104.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_residual2&#45;&gt;layer3_pre_attn_norm -->
<g id="edge212" class="edge">
<title>layer2_residual2&#45;&gt;layer3_pre_attn_norm</title>
<path fill="none" stroke="black" d="M11323.15,-1180.05C11214.08,-1165.34 11091.35,-1148.78 11001.15,-1136.62"/>
<polygon fill="black" stroke="black" points="11001.52,-1133.14 10991.15,-1135.27 11000.59,-1140.07 11001.52,-1133.14"/>
</g>
<!-- layer3_residual1 -->
<g id="node191" class="node">
<title>layer3_residual1</title>
<path fill="#fff4e8" stroke="black" d="M11828.1,-690.43C11828.1,-690.43 11435.16,-690.43 11435.16,-690.43 11429.16,-690.43 11418.39,-686.78 11413.63,-683.14 11413.63,-683.14 11325.44,-615.71 11325.44,-615.71 11320.67,-612.07 11321.9,-608.43 11327.9,-608.43 11327.9,-608.43 11720.84,-608.43 11720.84,-608.43 11726.84,-608.43 11737.61,-612.07 11742.37,-615.71 11742.37,-615.71 11830.56,-683.14 11830.56,-683.14 11835.33,-686.78 11834.1,-690.43 11828.1,-690.43"/>
<text text-anchor="middle" x="11578" y="-657.93" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="11578" y="-646.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="11578" y="-635.93" font-family="Arial" font-size="10.00">[Input: 2×[1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_residual2&#45;&gt;layer3_residual1 -->
<g id="edge262" class="edge">
<title>layer2_residual2&#45;&gt;layer3_residual1</title>
<path fill="none" stroke="black" d="M11772.87,-1204.86C11982.45,-1189.09 12286,-1147.96 12286,-1041.93 12286,-1041.93 12286,-1041.93 12286,-885.93 12286,-789.47 12046.4,-725.54 11845.97,-688.94"/>
<polygon fill="black" stroke="black" points="11846.32,-685.44 11835.86,-687.11 11845.07,-692.33 11846.32,-685.44"/>
</g>
<!-- layer3_qkv_gpu0 -->
<g id="node154" class="node">
<title>layer3_qkv_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="9464,-1061.43 9228,-1061.43 9228,-1020.43 9464,-1020.43 9464,-1061.43"/>
<text text-anchor="middle" x="9346" y="-1049.43" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="9346" y="-1038.43" font-family="Arial" font-size="10.00">QKV Layer3</text>
<text text-anchor="middle" x="9346" y="-1027.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu0 -->
<g id="edge213" class="edge">
<title>layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu0</title>
<path fill="none" stroke="black" d="M10748.69,-1116.7C10507.64,-1115.23 9951.18,-1106.84 9474.43,-1061.5"/>
<polygon fill="black" stroke="black" points="9474.54,-1058 9464.25,-1060.53 9473.87,-1064.97 9474.54,-1058"/>
</g>
<!-- layer3_qkv_gpu1 -->
<g id="node157" class="node">
<title>layer3_qkv_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="9718,-1061.43 9482,-1061.43 9482,-1020.43 9718,-1020.43 9718,-1061.43"/>
<text text-anchor="middle" x="9600" y="-1049.43" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="9600" y="-1038.43" font-family="Arial" font-size="10.00">QKV Layer3</text>
<text text-anchor="middle" x="9600" y="-1027.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu1 -->
<g id="edge217" class="edge">
<title>layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu1</title>
<path fill="none" stroke="black" d="M10748.73,-1115.17C10541.51,-1111.25 10105.87,-1099.04 9728.28,-1061.5"/>
<polygon fill="black" stroke="black" points="9728.55,-1058.01 9718.25,-1060.49 9727.85,-1064.97 9728.55,-1058.01"/>
</g>
<!-- layer3_qkv_gpu2 -->
<g id="node160" class="node">
<title>layer3_qkv_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="9972,-1061.43 9736,-1061.43 9736,-1020.43 9972,-1020.43 9972,-1061.43"/>
<text text-anchor="middle" x="9854" y="-1049.43" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="9854" y="-1038.43" font-family="Arial" font-size="10.00">QKV Layer3</text>
<text text-anchor="middle" x="9854" y="-1027.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu2 -->
<g id="edge221" class="edge">
<title>layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu2</title>
<path fill="none" stroke="black" d="M10748.92,-1112.82C10579.57,-1106.31 10262.22,-1091.28 9982.2,-1061.51"/>
<polygon fill="black" stroke="black" points="9982.57,-1058.03 9972.26,-1060.44 9981.83,-1064.99 9982.57,-1058.03"/>
</g>
<!-- layer3_qkv_gpu3 -->
<g id="node163" class="node">
<title>layer3_qkv_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="10226,-1061.43 9990,-1061.43 9990,-1020.43 10226,-1020.43 10226,-1061.43"/>
<text text-anchor="middle" x="10108" y="-1049.43" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="10108" y="-1038.43" font-family="Arial" font-size="10.00">QKV Layer3</text>
<text text-anchor="middle" x="10108" y="-1027.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu3 -->
<g id="edge225" class="edge">
<title>layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu3</title>
<path fill="none" stroke="black" d="M10748.91,-1108.7C10623.27,-1099.63 10420.88,-1083.49 10236.43,-1061.56"/>
<polygon fill="black" stroke="black" points="10236.61,-1058.06 10226.27,-1060.34 10235.78,-1065.01 10236.61,-1058.06"/>
</g>
<!-- layer3_qkv_gpu4 -->
<g id="node166" class="node">
<title>layer3_qkv_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="10480,-1061.43 10244,-1061.43 10244,-1020.43 10480,-1020.43 10480,-1061.43"/>
<text text-anchor="middle" x="10362" y="-1049.43" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="10362" y="-1038.43" font-family="Arial" font-size="10.00">QKV Layer3</text>
<text text-anchor="middle" x="10362" y="-1027.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu4 -->
<g id="edge229" class="edge">
<title>layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu4</title>
<path fill="none" stroke="black" d="M10748.99,-1099.54C10676.72,-1089.1 10582.8,-1075.43 10490.39,-1061.63"/>
<polygon fill="black" stroke="black" points="10490.71,-1058.14 10480.3,-1060.12 10489.67,-1065.06 10490.71,-1058.14"/>
</g>
<!-- layer3_qkv_gpu5 -->
<g id="node169" class="node">
<title>layer3_qkv_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="10734,-1061.43 10498,-1061.43 10498,-1020.43 10734,-1020.43 10734,-1061.43"/>
<text text-anchor="middle" x="10616" y="-1049.43" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="10616" y="-1038.43" font-family="Arial" font-size="10.00">QKV Layer3</text>
<text text-anchor="middle" x="10616" y="-1027.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu5 -->
<g id="edge233" class="edge">
<title>layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu5</title>
<path fill="none" stroke="black" d="M10803.93,-1097.42C10769.67,-1087.3 10727.65,-1074.89 10692.04,-1064.38"/>
<polygon fill="black" stroke="black" points="10692.76,-1060.94 10682.18,-1061.47 10690.78,-1067.66 10692.76,-1060.94"/>
</g>
<!-- layer3_qkv_gpu6 -->
<g id="node172" class="node">
<title>layer3_qkv_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="10988,-1061.43 10752,-1061.43 10752,-1020.43 10988,-1020.43 10988,-1061.43"/>
<text text-anchor="middle" x="10870" y="-1049.43" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="10870" y="-1038.43" font-family="Arial" font-size="10.00">QKV Layer3</text>
<text text-anchor="middle" x="10870" y="-1027.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu6 -->
<g id="edge237" class="edge">
<title>layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu6</title>
<path fill="none" stroke="black" d="M10870,-1097.22C10870,-1089.38 10870,-1080.2 10870,-1071.59"/>
<polygon fill="black" stroke="black" points="10873.5,-1071.5 10870,-1061.5 10866.5,-1071.5 10873.5,-1071.5"/>
</g>
<!-- layer3_qkv_gpu7 -->
<g id="node175" class="node">
<title>layer3_qkv_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="11242,-1061.43 11006,-1061.43 11006,-1020.43 11242,-1020.43 11242,-1061.43"/>
<text text-anchor="middle" x="11124" y="-1049.43" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="11124" y="-1038.43" font-family="Arial" font-size="10.00">QKV Layer3</text>
<text text-anchor="middle" x="11124" y="-1027.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,384]]</text>
</g>
<!-- layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu7 -->
<g id="edge241" class="edge">
<title>layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu7</title>
<path fill="none" stroke="black" d="M10936.07,-1097.42C10970.33,-1087.3 11012.35,-1074.89 11047.96,-1064.38"/>
<polygon fill="black" stroke="black" points="11049.22,-1067.66 11057.82,-1061.47 11047.24,-1060.94 11049.22,-1067.66"/>
</g>
<!-- layer3_qkv_gpu8 -->
<g id="node178" class="node">
<title>layer3_qkv_gpu8</title>
<polygon fill="#e8f4fd" stroke="black" points="11496,-1061.43 11260,-1061.43 11260,-1020.43 11496,-1020.43 11496,-1061.43"/>
<text text-anchor="middle" x="11378" y="-1049.43" font-family="Arial" font-size="10.00">GPU8</text>
<text text-anchor="middle" x="11378" y="-1038.43" font-family="Arial" font-size="10.00">QKV Layer3</text>
<text text-anchor="middle" x="11378" y="-1027.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,256]]</text>
</g>
<!-- layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu8 -->
<g id="edge245" class="edge">
<title>layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu8</title>
<path fill="none" stroke="black" d="M10991.01,-1099.54C11063.28,-1089.1 11157.2,-1075.43 11249.61,-1061.63"/>
<polygon fill="black" stroke="black" points="11250.33,-1065.06 11259.7,-1060.12 11249.29,-1058.14 11250.33,-1065.06"/>
</g>
<!-- layer3_qkv_gpu9 -->
<g id="node181" class="node">
<title>layer3_qkv_gpu9</title>
<polygon fill="#e8f4fd" stroke="black" points="11750,-1061.43 11514,-1061.43 11514,-1020.43 11750,-1020.43 11750,-1061.43"/>
<text text-anchor="middle" x="11632" y="-1049.43" font-family="Arial" font-size="10.00">GPU9</text>
<text text-anchor="middle" x="11632" y="-1038.43" font-family="Arial" font-size="10.00">QKV Layer3</text>
<text text-anchor="middle" x="11632" y="-1027.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,256]]</text>
</g>
<!-- layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu9 -->
<g id="edge249" class="edge">
<title>layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu9</title>
<path fill="none" stroke="black" d="M10991.09,-1108.7C11116.73,-1099.63 11319.12,-1083.49 11503.57,-1061.56"/>
<polygon fill="black" stroke="black" points="11504.22,-1065.01 11513.73,-1060.34 11503.39,-1058.06 11504.22,-1065.01"/>
</g>
<!-- layer3_qkv_gpu10 -->
<g id="node184" class="node">
<title>layer3_qkv_gpu10</title>
<polygon fill="#e8f4fd" stroke="black" points="12004,-1061.43 11768,-1061.43 11768,-1020.43 12004,-1020.43 12004,-1061.43"/>
<text text-anchor="middle" x="11886" y="-1049.43" font-family="Arial" font-size="10.00">GPU10</text>
<text text-anchor="middle" x="11886" y="-1038.43" font-family="Arial" font-size="10.00">QKV Layer3</text>
<text text-anchor="middle" x="11886" y="-1027.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,256]]</text>
</g>
<!-- layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu10 -->
<g id="edge253" class="edge">
<title>layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu10</title>
<path fill="none" stroke="black" d="M10991.08,-1112.82C11160.43,-1106.31 11477.78,-1091.28 11757.8,-1061.51"/>
<polygon fill="black" stroke="black" points="11758.17,-1064.99 11767.74,-1060.44 11757.43,-1058.03 11758.17,-1064.99"/>
</g>
<!-- layer3_qkv_gpu11 -->
<g id="node187" class="node">
<title>layer3_qkv_gpu11</title>
<polygon fill="#e8f4fd" stroke="black" points="12258,-1061.43 12022,-1061.43 12022,-1020.43 12258,-1020.43 12258,-1061.43"/>
<text text-anchor="middle" x="12140" y="-1049.43" font-family="Arial" font-size="10.00">GPU11</text>
<text text-anchor="middle" x="12140" y="-1038.43" font-family="Arial" font-size="10.00">QKV Layer3</text>
<text text-anchor="middle" x="12140" y="-1027.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,256]]</text>
</g>
<!-- layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu11 -->
<g id="edge257" class="edge">
<title>layer3_pre_attn_norm&#45;&gt;layer3_qkv_gpu11</title>
<path fill="none" stroke="black" d="M10991.27,-1115.17C11198.49,-1111.25 11634.13,-1099.04 12011.72,-1061.5"/>
<polygon fill="black" stroke="black" points="12012.15,-1064.97 12021.75,-1060.49 12011.45,-1058.01 12012.15,-1064.97"/>
</g>
<!-- layer3_attn_gpu0 -->
<g id="node155" class="node">
<title>layer3_attn_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="9461.5,-984.43 9230.5,-984.43 9230.5,-943.43 9461.5,-943.43 9461.5,-984.43"/>
<text text-anchor="middle" x="9346" y="-972.43" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="9346" y="-961.43" font-family="Arial" font-size="10.00">Attn Layer3</text>
<text text-anchor="middle" x="9346" y="-950.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer3_qkv_gpu0&#45;&gt;layer3_attn_gpu0 -->
<g id="edge214" class="edge">
<title>layer3_qkv_gpu0&#45;&gt;layer3_attn_gpu0</title>
<path fill="none" stroke="black" d="M9346,-1020.22C9346,-1012.38 9346,-1003.2 9346,-994.59"/>
<polygon fill="black" stroke="black" points="9349.5,-994.5 9346,-984.5 9342.5,-994.5 9349.5,-994.5"/>
</g>
<!-- layer3_out_proj_gpu0 -->
<g id="node156" class="node">
<title>layer3_out_proj_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="9464,-907.43 9228,-907.43 9228,-866.43 9464,-866.43 9464,-907.43"/>
<text text-anchor="middle" x="9346" y="-895.43" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="9346" y="-884.43" font-family="Arial" font-size="10.00">OutProj Layer3</text>
<text text-anchor="middle" x="9346" y="-873.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_attn_gpu0&#45;&gt;layer3_out_proj_gpu0 -->
<g id="edge215" class="edge">
<title>layer3_attn_gpu0&#45;&gt;layer3_out_proj_gpu0</title>
<path fill="none" stroke="black" d="M9346,-943.22C9346,-935.38 9346,-926.2 9346,-917.59"/>
<polygon fill="black" stroke="black" points="9349.5,-917.5 9346,-907.5 9342.5,-917.5 9349.5,-917.5"/>
</g>
<!-- layer3_attn_agg -->
<g id="node190" class="node">
<title>layer3_attn_agg</title>
<path fill="#fff4e8" stroke="black" d="M11125.46,-830.43C11125.46,-830.43 10723.99,-830.43 10723.99,-830.43 10717.99,-830.43 10707.64,-826.29 10703.29,-822.16 10703.29,-822.16 10611.23,-734.69 10611.23,-734.69 10606.88,-730.56 10608.54,-726.43 10614.54,-726.43 10614.54,-726.43 11016.01,-726.43 11016.01,-726.43 11022.01,-726.43 11032.36,-730.56 11036.71,-734.69 11036.71,-734.69 11128.77,-822.16 11128.77,-822.16 11133.12,-826.29 11131.46,-830.43 11125.46,-830.43"/>
<text text-anchor="middle" x="10870" y="-792.43" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="10870" y="-781.43" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="10870" y="-770.43" font-family="Arial" font-size="10.00">Aggregation</text>
<text text-anchor="middle" x="10870" y="-759.43" font-family="Arial" font-size="10.00">[Input: 12×[1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_out_proj_gpu0&#45;&gt;layer3_attn_agg -->
<g id="edge216" class="edge">
<title>layer3_out_proj_gpu0&#45;&gt;layer3_attn_agg</title>
<path fill="none" stroke="black" d="M9464.26,-867.41C9467.2,-867.07 9470.12,-866.74 9473,-866.43 9890.5,-821.47 10380.89,-797.56 10655.54,-786.77"/>
<polygon fill="black" stroke="black" points="10655.77,-790.27 10665.63,-786.38 10655.5,-783.27 10655.77,-790.27"/>
</g>
<!-- layer3_attn_gpu1 -->
<g id="node158" class="node">
<title>layer3_attn_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="9715.5,-984.43 9484.5,-984.43 9484.5,-943.43 9715.5,-943.43 9715.5,-984.43"/>
<text text-anchor="middle" x="9600" y="-972.43" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="9600" y="-961.43" font-family="Arial" font-size="10.00">Attn Layer3</text>
<text text-anchor="middle" x="9600" y="-950.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer3_qkv_gpu1&#45;&gt;layer3_attn_gpu1 -->
<g id="edge218" class="edge">
<title>layer3_qkv_gpu1&#45;&gt;layer3_attn_gpu1</title>
<path fill="none" stroke="black" d="M9600,-1020.22C9600,-1012.38 9600,-1003.2 9600,-994.59"/>
<polygon fill="black" stroke="black" points="9603.5,-994.5 9600,-984.5 9596.5,-994.5 9603.5,-994.5"/>
</g>
<!-- layer3_out_proj_gpu1 -->
<g id="node159" class="node">
<title>layer3_out_proj_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="9718,-907.43 9482,-907.43 9482,-866.43 9718,-866.43 9718,-907.43"/>
<text text-anchor="middle" x="9600" y="-895.43" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="9600" y="-884.43" font-family="Arial" font-size="10.00">OutProj Layer3</text>
<text text-anchor="middle" x="9600" y="-873.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_attn_gpu1&#45;&gt;layer3_out_proj_gpu1 -->
<g id="edge219" class="edge">
<title>layer3_attn_gpu1&#45;&gt;layer3_out_proj_gpu1</title>
<path fill="none" stroke="black" d="M9600,-943.22C9600,-935.38 9600,-926.2 9600,-917.59"/>
<polygon fill="black" stroke="black" points="9603.5,-917.5 9600,-907.5 9596.5,-917.5 9603.5,-917.5"/>
</g>
<!-- layer3_out_proj_gpu1&#45;&gt;layer3_attn_agg -->
<g id="edge220" class="edge">
<title>layer3_out_proj_gpu1&#45;&gt;layer3_attn_agg</title>
<path fill="none" stroke="black" d="M9718.26,-867.47C9721.2,-867.1 9724.12,-866.76 9727,-866.43 10051.38,-829.23 10429.43,-803.98 10659.13,-790.64"/>
<polygon fill="black" stroke="black" points="10659.5,-794.12 10669.28,-790.05 10659.09,-787.14 10659.5,-794.12"/>
</g>
<!-- layer3_attn_gpu2 -->
<g id="node161" class="node">
<title>layer3_attn_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="9969.5,-984.43 9738.5,-984.43 9738.5,-943.43 9969.5,-943.43 9969.5,-984.43"/>
<text text-anchor="middle" x="9854" y="-972.43" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="9854" y="-961.43" font-family="Arial" font-size="10.00">Attn Layer3</text>
<text text-anchor="middle" x="9854" y="-950.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer3_qkv_gpu2&#45;&gt;layer3_attn_gpu2 -->
<g id="edge222" class="edge">
<title>layer3_qkv_gpu2&#45;&gt;layer3_attn_gpu2</title>
<path fill="none" stroke="black" d="M9854,-1020.22C9854,-1012.38 9854,-1003.2 9854,-994.59"/>
<polygon fill="black" stroke="black" points="9857.5,-994.5 9854,-984.5 9850.5,-994.5 9857.5,-994.5"/>
</g>
<!-- layer3_out_proj_gpu2 -->
<g id="node162" class="node">
<title>layer3_out_proj_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="9972,-907.43 9736,-907.43 9736,-866.43 9972,-866.43 9972,-907.43"/>
<text text-anchor="middle" x="9854" y="-895.43" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="9854" y="-884.43" font-family="Arial" font-size="10.00">OutProj Layer3</text>
<text text-anchor="middle" x="9854" y="-873.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_attn_gpu2&#45;&gt;layer3_out_proj_gpu2 -->
<g id="edge223" class="edge">
<title>layer3_attn_gpu2&#45;&gt;layer3_out_proj_gpu2</title>
<path fill="none" stroke="black" d="M9854,-943.22C9854,-935.38 9854,-926.2 9854,-917.59"/>
<polygon fill="black" stroke="black" points="9857.5,-917.5 9854,-907.5 9850.5,-917.5 9857.5,-917.5"/>
</g>
<!-- layer3_out_proj_gpu2&#45;&gt;layer3_attn_agg -->
<g id="edge224" class="edge">
<title>layer3_out_proj_gpu2&#45;&gt;layer3_attn_agg</title>
<path fill="none" stroke="black" d="M9972.27,-867.55C9975.21,-867.16 9978.12,-866.79 9981,-866.43 10214.88,-837.05 10484.44,-811.89 10664.85,-796.29"/>
<polygon fill="black" stroke="black" points="10665.33,-799.76 10674.99,-795.42 10664.73,-792.79 10665.33,-799.76"/>
</g>
<!-- layer3_attn_gpu3 -->
<g id="node164" class="node">
<title>layer3_attn_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="10223.5,-984.43 9992.5,-984.43 9992.5,-943.43 10223.5,-943.43 10223.5,-984.43"/>
<text text-anchor="middle" x="10108" y="-972.43" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="10108" y="-961.43" font-family="Arial" font-size="10.00">Attn Layer3</text>
<text text-anchor="middle" x="10108" y="-950.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer3_qkv_gpu3&#45;&gt;layer3_attn_gpu3 -->
<g id="edge226" class="edge">
<title>layer3_qkv_gpu3&#45;&gt;layer3_attn_gpu3</title>
<path fill="none" stroke="black" d="M10108,-1020.22C10108,-1012.38 10108,-1003.2 10108,-994.59"/>
<polygon fill="black" stroke="black" points="10111.5,-994.5 10108,-984.5 10104.5,-994.5 10111.5,-994.5"/>
</g>
<!-- layer3_out_proj_gpu3 -->
<g id="node165" class="node">
<title>layer3_out_proj_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="10226,-907.43 9990,-907.43 9990,-866.43 10226,-866.43 10226,-907.43"/>
<text text-anchor="middle" x="10108" y="-895.43" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="10108" y="-884.43" font-family="Arial" font-size="10.00">OutProj Layer3</text>
<text text-anchor="middle" x="10108" y="-873.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_attn_gpu3&#45;&gt;layer3_out_proj_gpu3 -->
<g id="edge227" class="edge">
<title>layer3_attn_gpu3&#45;&gt;layer3_out_proj_gpu3</title>
<path fill="none" stroke="black" d="M10108,-943.22C10108,-935.38 10108,-926.2 10108,-917.59"/>
<polygon fill="black" stroke="black" points="10111.5,-917.5 10108,-907.5 10104.5,-917.5 10111.5,-917.5"/>
</g>
<!-- layer3_out_proj_gpu3&#45;&gt;layer3_attn_agg -->
<g id="edge228" class="edge">
<title>layer3_out_proj_gpu3&#45;&gt;layer3_attn_agg</title>
<path fill="none" stroke="black" d="M10226.29,-867.7C10229.22,-867.27 10232.13,-866.84 10235,-866.43 10382.02,-845.07 10548.4,-822.33 10673.96,-805.45"/>
<polygon fill="black" stroke="black" points="10674.63,-808.89 10684.07,-804.09 10673.69,-801.96 10674.63,-808.89"/>
</g>
<!-- layer3_attn_gpu4 -->
<g id="node167" class="node">
<title>layer3_attn_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="10477.5,-984.43 10246.5,-984.43 10246.5,-943.43 10477.5,-943.43 10477.5,-984.43"/>
<text text-anchor="middle" x="10362" y="-972.43" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="10362" y="-961.43" font-family="Arial" font-size="10.00">Attn Layer3</text>
<text text-anchor="middle" x="10362" y="-950.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer3_qkv_gpu4&#45;&gt;layer3_attn_gpu4 -->
<g id="edge230" class="edge">
<title>layer3_qkv_gpu4&#45;&gt;layer3_attn_gpu4</title>
<path fill="none" stroke="black" d="M10362,-1020.22C10362,-1012.38 10362,-1003.2 10362,-994.59"/>
<polygon fill="black" stroke="black" points="10365.5,-994.5 10362,-984.5 10358.5,-994.5 10365.5,-994.5"/>
</g>
<!-- layer3_out_proj_gpu4 -->
<g id="node168" class="node">
<title>layer3_out_proj_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="10480,-907.43 10244,-907.43 10244,-866.43 10480,-866.43 10480,-907.43"/>
<text text-anchor="middle" x="10362" y="-895.43" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="10362" y="-884.43" font-family="Arial" font-size="10.00">OutProj Layer3</text>
<text text-anchor="middle" x="10362" y="-873.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_attn_gpu4&#45;&gt;layer3_out_proj_gpu4 -->
<g id="edge231" class="edge">
<title>layer3_attn_gpu4&#45;&gt;layer3_out_proj_gpu4</title>
<path fill="none" stroke="black" d="M10362,-943.22C10362,-935.38 10362,-926.2 10362,-917.59"/>
<polygon fill="black" stroke="black" points="10365.5,-917.5 10362,-907.5 10358.5,-917.5 10365.5,-917.5"/>
</g>
<!-- layer3_out_proj_gpu4&#45;&gt;layer3_attn_agg -->
<g id="edge232" class="edge">
<title>layer3_out_proj_gpu4&#45;&gt;layer3_attn_agg</title>
<path fill="none" stroke="black" d="M10455.18,-866.39C10519.8,-852.85 10608.01,-834.35 10686.48,-817.9"/>
<polygon fill="black" stroke="black" points="10687.42,-821.28 10696.49,-815.8 10685.98,-814.43 10687.42,-821.28"/>
</g>
<!-- layer3_attn_gpu5 -->
<g id="node170" class="node">
<title>layer3_attn_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="10731.5,-984.43 10500.5,-984.43 10500.5,-943.43 10731.5,-943.43 10731.5,-984.43"/>
<text text-anchor="middle" x="10616" y="-972.43" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="10616" y="-961.43" font-family="Arial" font-size="10.00">Attn Layer3</text>
<text text-anchor="middle" x="10616" y="-950.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer3_qkv_gpu5&#45;&gt;layer3_attn_gpu5 -->
<g id="edge234" class="edge">
<title>layer3_qkv_gpu5&#45;&gt;layer3_attn_gpu5</title>
<path fill="none" stroke="black" d="M10616,-1020.22C10616,-1012.38 10616,-1003.2 10616,-994.59"/>
<polygon fill="black" stroke="black" points="10619.5,-994.5 10616,-984.5 10612.5,-994.5 10619.5,-994.5"/>
</g>
<!-- layer3_out_proj_gpu5 -->
<g id="node171" class="node">
<title>layer3_out_proj_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="10734,-907.43 10498,-907.43 10498,-866.43 10734,-866.43 10734,-907.43"/>
<text text-anchor="middle" x="10616" y="-895.43" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="10616" y="-884.43" font-family="Arial" font-size="10.00">OutProj Layer3</text>
<text text-anchor="middle" x="10616" y="-873.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_attn_gpu5&#45;&gt;layer3_out_proj_gpu5 -->
<g id="edge235" class="edge">
<title>layer3_attn_gpu5&#45;&gt;layer3_out_proj_gpu5</title>
<path fill="none" stroke="black" d="M10616,-943.22C10616,-935.38 10616,-926.2 10616,-917.59"/>
<polygon fill="black" stroke="black" points="10619.5,-917.5 10616,-907.5 10612.5,-917.5 10619.5,-917.5"/>
</g>
<!-- layer3_out_proj_gpu5&#45;&gt;layer3_attn_agg -->
<g id="edge236" class="edge">
<title>layer3_out_proj_gpu5&#45;&gt;layer3_attn_agg</title>
<path fill="none" stroke="black" d="M10662.59,-866.39C10684.4,-857.25 10711.58,-845.85 10739.02,-834.35"/>
<polygon fill="black" stroke="black" points="10740.45,-837.54 10748.32,-830.45 10737.75,-831.08 10740.45,-837.54"/>
</g>
<!-- layer3_attn_gpu6 -->
<g id="node173" class="node">
<title>layer3_attn_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="10985.5,-984.43 10754.5,-984.43 10754.5,-943.43 10985.5,-943.43 10985.5,-984.43"/>
<text text-anchor="middle" x="10870" y="-972.43" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="10870" y="-961.43" font-family="Arial" font-size="10.00">Attn Layer3</text>
<text text-anchor="middle" x="10870" y="-950.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer3_qkv_gpu6&#45;&gt;layer3_attn_gpu6 -->
<g id="edge238" class="edge">
<title>layer3_qkv_gpu6&#45;&gt;layer3_attn_gpu6</title>
<path fill="none" stroke="black" d="M10870,-1020.22C10870,-1012.38 10870,-1003.2 10870,-994.59"/>
<polygon fill="black" stroke="black" points="10873.5,-994.5 10870,-984.5 10866.5,-994.5 10873.5,-994.5"/>
</g>
<!-- layer3_out_proj_gpu6 -->
<g id="node174" class="node">
<title>layer3_out_proj_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="10988,-907.43 10752,-907.43 10752,-866.43 10988,-866.43 10988,-907.43"/>
<text text-anchor="middle" x="10870" y="-895.43" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="10870" y="-884.43" font-family="Arial" font-size="10.00">OutProj Layer3</text>
<text text-anchor="middle" x="10870" y="-873.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_attn_gpu6&#45;&gt;layer3_out_proj_gpu6 -->
<g id="edge239" class="edge">
<title>layer3_attn_gpu6&#45;&gt;layer3_out_proj_gpu6</title>
<path fill="none" stroke="black" d="M10870,-943.22C10870,-935.38 10870,-926.2 10870,-917.59"/>
<polygon fill="black" stroke="black" points="10873.5,-917.5 10870,-907.5 10866.5,-917.5 10873.5,-917.5"/>
</g>
<!-- layer3_out_proj_gpu6&#45;&gt;layer3_attn_agg -->
<g id="edge240" class="edge">
<title>layer3_out_proj_gpu6&#45;&gt;layer3_attn_agg</title>
<path fill="none" stroke="black" d="M10870,-866.39C10870,-858.98 10870,-850.1 10870,-840.87"/>
<polygon fill="black" stroke="black" points="10873.5,-840.79 10870,-830.79 10866.5,-840.79 10873.5,-840.79"/>
</g>
<!-- layer3_attn_gpu7 -->
<g id="node176" class="node">
<title>layer3_attn_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="11239.5,-984.43 11008.5,-984.43 11008.5,-943.43 11239.5,-943.43 11239.5,-984.43"/>
<text text-anchor="middle" x="11124" y="-972.43" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="11124" y="-961.43" font-family="Arial" font-size="10.00">Attn Layer3</text>
<text text-anchor="middle" x="11124" y="-950.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,384]]</text>
</g>
<!-- layer3_qkv_gpu7&#45;&gt;layer3_attn_gpu7 -->
<g id="edge242" class="edge">
<title>layer3_qkv_gpu7&#45;&gt;layer3_attn_gpu7</title>
<path fill="none" stroke="black" d="M11124,-1020.22C11124,-1012.38 11124,-1003.2 11124,-994.59"/>
<polygon fill="black" stroke="black" points="11127.5,-994.5 11124,-984.5 11120.5,-994.5 11127.5,-994.5"/>
</g>
<!-- layer3_out_proj_gpu7 -->
<g id="node177" class="node">
<title>layer3_out_proj_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="11242,-907.43 11006,-907.43 11006,-866.43 11242,-866.43 11242,-907.43"/>
<text text-anchor="middle" x="11124" y="-895.43" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="11124" y="-884.43" font-family="Arial" font-size="10.00">OutProj Layer3</text>
<text text-anchor="middle" x="11124" y="-873.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,384], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_attn_gpu7&#45;&gt;layer3_out_proj_gpu7 -->
<g id="edge243" class="edge">
<title>layer3_attn_gpu7&#45;&gt;layer3_out_proj_gpu7</title>
<path fill="none" stroke="black" d="M11124,-943.22C11124,-935.38 11124,-926.2 11124,-917.59"/>
<polygon fill="black" stroke="black" points="11127.5,-917.5 11124,-907.5 11120.5,-917.5 11127.5,-917.5"/>
</g>
<!-- layer3_out_proj_gpu7&#45;&gt;layer3_attn_agg -->
<g id="edge244" class="edge">
<title>layer3_out_proj_gpu7&#45;&gt;layer3_attn_agg</title>
<path fill="none" stroke="black" d="M11077.41,-866.39C11055.6,-857.25 11028.42,-845.85 11000.98,-834.35"/>
<polygon fill="black" stroke="black" points="11002.25,-831.08 10991.68,-830.45 10999.55,-837.54 11002.25,-831.08"/>
</g>
<!-- layer3_attn_gpu8 -->
<g id="node179" class="node">
<title>layer3_attn_gpu8</title>
<polygon fill="#e8f4fd" stroke="black" points="11493.5,-984.43 11262.5,-984.43 11262.5,-943.43 11493.5,-943.43 11493.5,-984.43"/>
<text text-anchor="middle" x="11378" y="-972.43" font-family="Arial" font-size="10.00">GPU8</text>
<text text-anchor="middle" x="11378" y="-961.43" font-family="Arial" font-size="10.00">Attn Layer3</text>
<text text-anchor="middle" x="11378" y="-950.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,256]]</text>
</g>
<!-- layer3_qkv_gpu8&#45;&gt;layer3_attn_gpu8 -->
<g id="edge246" class="edge">
<title>layer3_qkv_gpu8&#45;&gt;layer3_attn_gpu8</title>
<path fill="none" stroke="black" d="M11378,-1020.22C11378,-1012.38 11378,-1003.2 11378,-994.59"/>
<polygon fill="black" stroke="black" points="11381.5,-994.5 11378,-984.5 11374.5,-994.5 11381.5,-994.5"/>
</g>
<!-- layer3_out_proj_gpu8 -->
<g id="node180" class="node">
<title>layer3_out_proj_gpu8</title>
<polygon fill="#e8f4fd" stroke="black" points="11496,-907.43 11260,-907.43 11260,-866.43 11496,-866.43 11496,-907.43"/>
<text text-anchor="middle" x="11378" y="-895.43" font-family="Arial" font-size="10.00">GPU8</text>
<text text-anchor="middle" x="11378" y="-884.43" font-family="Arial" font-size="10.00">OutProj Layer3</text>
<text text-anchor="middle" x="11378" y="-873.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_attn_gpu8&#45;&gt;layer3_out_proj_gpu8 -->
<g id="edge247" class="edge">
<title>layer3_attn_gpu8&#45;&gt;layer3_out_proj_gpu8</title>
<path fill="none" stroke="black" d="M11378,-943.22C11378,-935.38 11378,-926.2 11378,-917.59"/>
<polygon fill="black" stroke="black" points="11381.5,-917.5 11378,-907.5 11374.5,-917.5 11381.5,-917.5"/>
</g>
<!-- layer3_out_proj_gpu8&#45;&gt;layer3_attn_agg -->
<g id="edge248" class="edge">
<title>layer3_out_proj_gpu8&#45;&gt;layer3_attn_agg</title>
<path fill="none" stroke="black" d="M11284.82,-866.39C11238.93,-856.77 11181.13,-844.65 11123.38,-832.55"/>
<polygon fill="black" stroke="black" points="11123.86,-829.07 11113.36,-830.45 11122.43,-835.92 11123.86,-829.07"/>
</g>
<!-- layer3_attn_gpu9 -->
<g id="node182" class="node">
<title>layer3_attn_gpu9</title>
<polygon fill="#e8f4fd" stroke="black" points="11747.5,-984.43 11516.5,-984.43 11516.5,-943.43 11747.5,-943.43 11747.5,-984.43"/>
<text text-anchor="middle" x="11632" y="-972.43" font-family="Arial" font-size="10.00">GPU9</text>
<text text-anchor="middle" x="11632" y="-961.43" font-family="Arial" font-size="10.00">Attn Layer3</text>
<text text-anchor="middle" x="11632" y="-950.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,256]]</text>
</g>
<!-- layer3_qkv_gpu9&#45;&gt;layer3_attn_gpu9 -->
<g id="edge250" class="edge">
<title>layer3_qkv_gpu9&#45;&gt;layer3_attn_gpu9</title>
<path fill="none" stroke="black" d="M11632,-1020.22C11632,-1012.38 11632,-1003.2 11632,-994.59"/>
<polygon fill="black" stroke="black" points="11635.5,-994.5 11632,-984.5 11628.5,-994.5 11635.5,-994.5"/>
</g>
<!-- layer3_out_proj_gpu9 -->
<g id="node183" class="node">
<title>layer3_out_proj_gpu9</title>
<polygon fill="#e8f4fd" stroke="black" points="11750,-907.43 11514,-907.43 11514,-866.43 11750,-866.43 11750,-907.43"/>
<text text-anchor="middle" x="11632" y="-895.43" font-family="Arial" font-size="10.00">GPU9</text>
<text text-anchor="middle" x="11632" y="-884.43" font-family="Arial" font-size="10.00">OutProj Layer3</text>
<text text-anchor="middle" x="11632" y="-873.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_attn_gpu9&#45;&gt;layer3_out_proj_gpu9 -->
<g id="edge251" class="edge">
<title>layer3_attn_gpu9&#45;&gt;layer3_out_proj_gpu9</title>
<path fill="none" stroke="black" d="M11632,-943.22C11632,-935.38 11632,-926.2 11632,-917.59"/>
<polygon fill="black" stroke="black" points="11635.5,-917.5 11632,-907.5 11628.5,-917.5 11635.5,-917.5"/>
</g>
<!-- layer3_out_proj_gpu9&#45;&gt;layer3_attn_agg -->
<g id="edge252" class="edge">
<title>layer3_out_proj_gpu9&#45;&gt;layer3_attn_agg</title>
<path fill="none" stroke="black" d="M11513.71,-867.7C11510.78,-867.27 11507.87,-866.84 11505,-866.43 11381.42,-848.47 11244.15,-829.54 11128.95,-813.94"/>
<polygon fill="black" stroke="black" points="11129.31,-810.46 11118.93,-812.58 11128.37,-817.39 11129.31,-810.46"/>
</g>
<!-- layer3_attn_gpu10 -->
<g id="node185" class="node">
<title>layer3_attn_gpu10</title>
<polygon fill="#e8f4fd" stroke="black" points="12001.5,-984.43 11770.5,-984.43 11770.5,-943.43 12001.5,-943.43 12001.5,-984.43"/>
<text text-anchor="middle" x="11886" y="-972.43" font-family="Arial" font-size="10.00">GPU10</text>
<text text-anchor="middle" x="11886" y="-961.43" font-family="Arial" font-size="10.00">Attn Layer3</text>
<text text-anchor="middle" x="11886" y="-950.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,256]]</text>
</g>
<!-- layer3_qkv_gpu10&#45;&gt;layer3_attn_gpu10 -->
<g id="edge254" class="edge">
<title>layer3_qkv_gpu10&#45;&gt;layer3_attn_gpu10</title>
<path fill="none" stroke="black" d="M11886,-1020.22C11886,-1012.38 11886,-1003.2 11886,-994.59"/>
<polygon fill="black" stroke="black" points="11889.5,-994.5 11886,-984.5 11882.5,-994.5 11889.5,-994.5"/>
</g>
<!-- layer3_out_proj_gpu10 -->
<g id="node186" class="node">
<title>layer3_out_proj_gpu10</title>
<polygon fill="#e8f4fd" stroke="black" points="12004,-907.43 11768,-907.43 11768,-866.43 12004,-866.43 12004,-907.43"/>
<text text-anchor="middle" x="11886" y="-895.43" font-family="Arial" font-size="10.00">GPU10</text>
<text text-anchor="middle" x="11886" y="-884.43" font-family="Arial" font-size="10.00">OutProj Layer3</text>
<text text-anchor="middle" x="11886" y="-873.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_attn_gpu10&#45;&gt;layer3_out_proj_gpu10 -->
<g id="edge255" class="edge">
<title>layer3_attn_gpu10&#45;&gt;layer3_out_proj_gpu10</title>
<path fill="none" stroke="black" d="M11886,-943.22C11886,-935.38 11886,-926.2 11886,-917.59"/>
<polygon fill="black" stroke="black" points="11889.5,-917.5 11886,-907.5 11882.5,-917.5 11889.5,-917.5"/>
</g>
<!-- layer3_out_proj_gpu10&#45;&gt;layer3_attn_agg -->
<g id="edge256" class="edge">
<title>layer3_out_proj_gpu10&#45;&gt;layer3_attn_agg</title>
<path fill="none" stroke="black" d="M11767.73,-867.55C11764.79,-867.16 11761.88,-866.79 11759,-866.43 11541.54,-839.11 11293.24,-815.44 11114.43,-799.71"/>
<polygon fill="black" stroke="black" points="11114.63,-796.22 11104.36,-798.83 11114.02,-803.19 11114.63,-796.22"/>
</g>
<!-- layer3_attn_gpu11 -->
<g id="node188" class="node">
<title>layer3_attn_gpu11</title>
<polygon fill="#e8f4fd" stroke="black" points="12255.5,-984.43 12024.5,-984.43 12024.5,-943.43 12255.5,-943.43 12255.5,-984.43"/>
<text text-anchor="middle" x="12140" y="-972.43" font-family="Arial" font-size="10.00">GPU11</text>
<text text-anchor="middle" x="12140" y="-961.43" font-family="Arial" font-size="10.00">Attn Layer3</text>
<text text-anchor="middle" x="12140" y="-950.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,256]]</text>
</g>
<!-- layer3_qkv_gpu11&#45;&gt;layer3_attn_gpu11 -->
<g id="edge258" class="edge">
<title>layer3_qkv_gpu11&#45;&gt;layer3_attn_gpu11</title>
<path fill="none" stroke="black" d="M12140,-1020.22C12140,-1012.38 12140,-1003.2 12140,-994.59"/>
<polygon fill="black" stroke="black" points="12143.5,-994.5 12140,-984.5 12136.5,-994.5 12143.5,-994.5"/>
</g>
<!-- layer3_out_proj_gpu11 -->
<g id="node189" class="node">
<title>layer3_out_proj_gpu11</title>
<polygon fill="#e8f4fd" stroke="black" points="12258,-907.43 12022,-907.43 12022,-866.43 12258,-866.43 12258,-907.43"/>
<text text-anchor="middle" x="12140" y="-895.43" font-family="Arial" font-size="10.00">GPU11</text>
<text text-anchor="middle" x="12140" y="-884.43" font-family="Arial" font-size="10.00">OutProj Layer3</text>
<text text-anchor="middle" x="12140" y="-873.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,256], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_attn_gpu11&#45;&gt;layer3_out_proj_gpu11 -->
<g id="edge259" class="edge">
<title>layer3_attn_gpu11&#45;&gt;layer3_out_proj_gpu11</title>
<path fill="none" stroke="black" d="M12140,-943.22C12140,-935.38 12140,-926.2 12140,-917.59"/>
<polygon fill="black" stroke="black" points="12143.5,-917.5 12140,-907.5 12136.5,-917.5 12143.5,-917.5"/>
</g>
<!-- layer3_out_proj_gpu11&#45;&gt;layer3_attn_agg -->
<g id="edge260" class="edge">
<title>layer3_out_proj_gpu11&#45;&gt;layer3_attn_agg</title>
<path fill="none" stroke="black" d="M12021.74,-867.47C12018.8,-867.1 12015.88,-866.76 12013,-866.43 11700.56,-830.6 11338.32,-805.85 11106.81,-792.16"/>
<polygon fill="black" stroke="black" points="11106.76,-788.65 11096.57,-791.56 11106.35,-795.64 11106.76,-788.65"/>
</g>
<!-- layer3_attn_agg&#45;&gt;layer3_residual1 -->
<g id="edge261" class="edge">
<title>layer3_attn_agg&#45;&gt;layer3_residual1</title>
<path fill="none" stroke="black" d="M11048.2,-745.46C11155.85,-726.15 11292.57,-701.63 11400.15,-682.33"/>
<polygon fill="black" stroke="black" points="11400.92,-685.75 11410.14,-680.54 11399.68,-678.86 11400.92,-685.75"/>
</g>
<!-- layer3_post_attn_norm -->
<g id="node192" class="node">
<title>layer3_post_attn_norm</title>
<polygon fill="#fde8e8" stroke="black" points="11280,-572.43 11038,-572.43 11038,-531.43 11280,-531.43 11280,-572.43"/>
<text text-anchor="middle" x="11159" y="-560.43" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="11159" y="-549.43" font-family="Arial" font-size="10.00">Post&#45;Attn LayerNorm</text>
<text text-anchor="middle" x="11159" y="-538.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_residual1&#45;&gt;layer3_post_attn_norm -->
<g id="edge263" class="edge">
<title>layer3_residual1&#45;&gt;layer3_post_attn_norm</title>
<path fill="none" stroke="black" d="M11402.43,-608.41C11351.7,-596.85 11298.24,-584.66 11254.38,-574.67"/>
<polygon fill="black" stroke="black" points="11255.13,-571.25 11244.6,-572.44 11253.57,-578.07 11255.13,-571.25"/>
</g>
<!-- layer3_residual2 -->
<g id="node202" class="node">
<title>layer3_residual2</title>
<path fill="#fff4e8" stroke="black" d="M11829.1,-160.43C11829.1,-160.43 11436.16,-160.43 11436.16,-160.43 11430.16,-160.43 11419.39,-156.78 11414.63,-153.14 11414.63,-153.14 11326.44,-85.71 11326.44,-85.71 11321.67,-82.07 11322.9,-78.43 11328.9,-78.43 11328.9,-78.43 11721.84,-78.43 11721.84,-78.43 11727.84,-78.43 11738.61,-82.07 11743.37,-85.71 11743.37,-85.71 11831.56,-153.14 11831.56,-153.14 11836.33,-156.78 11835.1,-160.43 11829.1,-160.43"/>
<text text-anchor="middle" x="11579" y="-127.93" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="11579" y="-116.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="11579" y="-105.93" font-family="Arial" font-size="10.00">[Input: 2×[1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_residual1&#45;&gt;layer3_residual2 -->
<g id="edge281" class="edge">
<title>layer3_residual1&#45;&gt;layer3_residual2</title>
<path fill="none" stroke="black" d="M11765.58,-633.41C11877.5,-612.99 11998,-565.46 11998,-455.43 11998,-455.43 11998,-455.43 11998,-355.93 11998,-254.98 11904.44,-196.85 11805.74,-163.61"/>
<polygon fill="black" stroke="black" points="11806.76,-160.27 11796.17,-160.47 11804.58,-166.92 11806.76,-160.27"/>
</g>
<!-- layer3_gate_gpu12 -->
<g id="node193" class="node">
<title>layer3_gate_gpu12</title>
<polygon fill="#fde8e8" stroke="black" points="10330.48,-495.43 9949.52,-495.43 9851.52,-413.43 10232.48,-413.43 10330.48,-495.43"/>
<text text-anchor="middle" x="10091" y="-462.93" font-family="Arial" font-size="10.00">GPU12</text>
<text text-anchor="middle" x="10091" y="-451.93" font-family="Arial" font-size="10.00">Gating Layer3</text>
<text text-anchor="middle" x="10091" y="-440.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,16]]</text>
</g>
<!-- layer3_post_attn_norm&#45;&gt;layer3_gate_gpu12 -->
<g id="edge264" class="edge">
<title>layer3_post_attn_norm&#45;&gt;layer3_gate_gpu12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M11037.87,-546.04C10878.43,-538.84 10589.56,-523.14 10344,-495.43 10342.25,-495.23 10340.5,-495.03 10338.74,-494.82"/>
<polygon fill="blue" stroke="blue" points="10338.95,-491.33 10328.61,-493.62 10338.13,-498.28 10338.95,-491.33"/>
</g>
<!-- layer3_experts_gpu12 -->
<g id="node194" class="node">
<title>layer3_experts_gpu12</title>
<polygon fill="#fde8e8" stroke="black" points="10479,-377.43 10237,-377.43 10237,-336.43 10479,-336.43 10479,-377.43"/>
<text text-anchor="middle" x="10358" y="-365.43" font-family="Arial" font-size="10.00">GPU12</text>
<text text-anchor="middle" x="10358" y="-354.43" font-family="Arial" font-size="10.00">Experts 0&#45;3</text>
<text text-anchor="middle" x="10358" y="-343.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_post_attn_norm&#45;&gt;layer3_experts_gpu12 -->
<g id="edge265" class="edge">
<title>layer3_post_attn_norm&#45;&gt;layer3_experts_gpu12</title>
<path fill="none" stroke="black" d="M11037.64,-550.56C10829.96,-548.73 10424.08,-539.48 10377,-495.43 10348.07,-468.36 10348.46,-419.34 10352.45,-387.74"/>
<polygon fill="black" stroke="black" points="10355.92,-388.14 10353.9,-377.74 10349,-387.13 10355.92,-388.14"/>
</g>
<!-- layer3_gate_gpu13 -->
<g id="node195" class="node">
<title>layer3_gate_gpu13</title>
<polygon fill="#fde8e8" stroke="black" points="10864.48,-495.43 10483.52,-495.43 10385.52,-413.43 10766.48,-413.43 10864.48,-495.43"/>
<text text-anchor="middle" x="10625" y="-462.93" font-family="Arial" font-size="10.00">GPU13</text>
<text text-anchor="middle" x="10625" y="-451.93" font-family="Arial" font-size="10.00">Gating Layer3</text>
<text text-anchor="middle" x="10625" y="-440.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,16]]</text>
</g>
<!-- layer3_post_attn_norm&#45;&gt;layer3_gate_gpu13 -->
<g id="edge268" class="edge">
<title>layer3_post_attn_norm&#45;&gt;layer3_gate_gpu13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M11049.65,-531.37C10994.5,-521.51 10925.38,-509.15 10859.02,-497.28"/>
<polygon fill="blue" stroke="blue" points="10859.28,-493.77 10848.82,-495.45 10858.05,-500.66 10859.28,-493.77"/>
</g>
<!-- layer3_experts_gpu13 -->
<g id="node196" class="node">
<title>layer3_experts_gpu13</title>
<polygon fill="#fde8e8" stroke="black" points="11013,-377.43 10771,-377.43 10771,-336.43 11013,-336.43 11013,-377.43"/>
<text text-anchor="middle" x="10892" y="-365.43" font-family="Arial" font-size="10.00">GPU13</text>
<text text-anchor="middle" x="10892" y="-354.43" font-family="Arial" font-size="10.00">Experts 4&#45;7</text>
<text text-anchor="middle" x="10892" y="-343.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_post_attn_norm&#45;&gt;layer3_experts_gpu13 -->
<g id="edge269" class="edge">
<title>layer3_post_attn_norm&#45;&gt;layer3_experts_gpu13</title>
<path fill="none" stroke="black" d="M11037.89,-536.96C10984.08,-528.2 10928.85,-514.82 10911,-495.43 10884.43,-466.56 10883.97,-418.8 10887.16,-387.85"/>
<polygon fill="black" stroke="black" points="10890.66,-388.01 10888.4,-377.66 10883.71,-387.16 10890.66,-388.01"/>
</g>
<!-- layer3_gate_gpu14 -->
<g id="node197" class="node">
<title>layer3_gate_gpu14</title>
<polygon fill="#fde8e8" stroke="black" points="11398.48,-495.43 11017.52,-495.43 10919.52,-413.43 11300.48,-413.43 11398.48,-495.43"/>
<text text-anchor="middle" x="11159" y="-462.93" font-family="Arial" font-size="10.00">GPU14</text>
<text text-anchor="middle" x="11159" y="-451.93" font-family="Arial" font-size="10.00">Gating Layer3</text>
<text text-anchor="middle" x="11159" y="-440.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,16]]</text>
</g>
<!-- layer3_post_attn_norm&#45;&gt;layer3_gate_gpu14 -->
<g id="edge272" class="edge">
<title>layer3_post_attn_norm&#45;&gt;layer3_gate_gpu14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M11159,-531.14C11159,-523.68 11159,-514.81 11159,-505.81"/>
<polygon fill="blue" stroke="blue" points="11162.5,-505.67 11159,-495.67 11155.5,-505.67 11162.5,-505.67"/>
</g>
<!-- layer3_experts_gpu14 -->
<g id="node198" class="node">
<title>layer3_experts_gpu14</title>
<polygon fill="#fde8e8" stroke="black" points="11414,-377.43 11172,-377.43 11172,-336.43 11414,-336.43 11414,-377.43"/>
<text text-anchor="middle" x="11293" y="-365.43" font-family="Arial" font-size="10.00">GPU14</text>
<text text-anchor="middle" x="11293" y="-354.43" font-family="Arial" font-size="10.00">Experts 8&#45;11</text>
<text text-anchor="middle" x="11293" y="-343.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_post_attn_norm&#45;&gt;layer3_experts_gpu14 -->
<g id="edge273" class="edge">
<title>layer3_post_attn_norm&#45;&gt;layer3_experts_gpu14</title>
<path fill="none" stroke="black" d="M11280.26,-538.13C11334.69,-529.63 11390.42,-516.13 11407,-495.43 11429.78,-466.98 11426.32,-444.33 11407,-413.43 11398.72,-400.18 11386.27,-390.02 11372.6,-382.24"/>
<polygon fill="black" stroke="black" points="11373.95,-379 11363.47,-377.47 11370.71,-385.2 11373.95,-379"/>
</g>
<!-- layer3_gate_gpu15 -->
<g id="node199" class="node">
<title>layer3_gate_gpu15</title>
<polygon fill="#fde8e8" stroke="black" points="11932.48,-495.43 11551.52,-495.43 11453.52,-413.43 11834.48,-413.43 11932.48,-495.43"/>
<text text-anchor="middle" x="11693" y="-462.93" font-family="Arial" font-size="10.00">GPU15</text>
<text text-anchor="middle" x="11693" y="-451.93" font-family="Arial" font-size="10.00">Gating Layer3</text>
<text text-anchor="middle" x="11693" y="-440.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,16]]</text>
</g>
<!-- layer3_post_attn_norm&#45;&gt;layer3_gate_gpu15 -->
<g id="edge276" class="edge">
<title>layer3_post_attn_norm&#45;&gt;layer3_gate_gpu15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M11268.35,-531.37C11342.83,-518.05 11442.81,-500.17 11527.04,-485.11"/>
<polygon fill="blue" stroke="blue" points="11527.75,-488.54 11536.97,-483.33 11526.51,-481.65 11527.75,-488.54"/>
</g>
<!-- layer3_experts_gpu15 -->
<g id="node200" class="node">
<title>layer3_experts_gpu15</title>
<polygon fill="#fde8e8" stroke="black" points="11814,-377.43 11572,-377.43 11572,-336.43 11814,-336.43 11814,-377.43"/>
<text text-anchor="middle" x="11693" y="-365.43" font-family="Arial" font-size="10.00">GPU15</text>
<text text-anchor="middle" x="11693" y="-354.43" font-family="Arial" font-size="10.00">Experts 12&#45;15</text>
<text text-anchor="middle" x="11693" y="-343.43" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_post_attn_norm&#45;&gt;layer3_experts_gpu15 -->
<g id="edge277" class="edge">
<title>layer3_post_attn_norm&#45;&gt;layer3_experts_gpu15</title>
<path fill="none" stroke="black" d="M11280.17,-551.19C11488.6,-550.37 11896.99,-542.67 11941,-495.43 11965.84,-468.76 11963.78,-441.87 11941,-413.43 11925.42,-393.98 11875.3,-380.88 11824.15,-372.33"/>
<polygon fill="black" stroke="black" points="11824.69,-368.87 11814.26,-370.73 11823.57,-375.78 11824.69,-368.87"/>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_experts_gpu12 -->
<g id="edge266" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_experts_gpu12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10203.07,-413.34C10233.96,-402.29 10266.41,-390.68 10293.59,-380.96"/>
<polygon fill="red" stroke="red" points="10295.12,-384.13 10303.36,-377.47 10292.76,-377.54 10295.12,-384.13"/>
</g>
<!-- layer3_moe_agg -->
<g id="node201" class="node">
<title>layer3_moe_agg</title>
<path fill="#fff4e8" stroke="black" d="M11543.1,-300.43C11543.1,-300.43 11150.16,-300.43 11150.16,-300.43 11144.16,-300.43 11133.85,-296.25 11129.54,-292.07 11129.54,-292.07 11039.52,-204.78 11039.52,-204.78 11035.21,-200.6 11036.9,-196.43 11042.9,-196.43 11042.9,-196.43 11435.84,-196.43 11435.84,-196.43 11441.84,-196.43 11452.15,-200.6 11456.46,-204.78 11456.46,-204.78 11546.48,-292.07 11546.48,-292.07 11550.79,-296.25 11549.1,-300.43 11543.1,-300.43"/>
<text text-anchor="middle" x="11293" y="-262.43" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="11293" y="-251.43" font-family="Arial" font-size="10.00">MoE</text>
<text text-anchor="middle" x="11293" y="-240.43" font-family="Arial" font-size="10.00">Aggregation</text>
<text text-anchor="middle" x="11293" y="-229.43" font-family="Arial" font-size="10.00">[Input: 4×[1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_experts_gpu12&#45;&gt;layer3_moe_agg -->
<g id="edge267" class="edge">
<title>layer3_experts_gpu12&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M10479.28,-342.11C10635.87,-324.28 10910.38,-293.01 11096.83,-271.77"/>
<polygon fill="black" stroke="black" points="11097.49,-275.22 11107.03,-270.61 11096.69,-268.26 11097.49,-275.22"/>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_experts_gpu13 -->
<g id="edge270" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_experts_gpu13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10737.07,-413.34C10767.96,-402.29 10800.41,-390.68 10827.59,-380.96"/>
<polygon fill="red" stroke="red" points="10829.12,-384.13 10837.36,-377.47 10826.76,-377.54 10829.12,-384.13"/>
</g>
<!-- layer3_experts_gpu13&#45;&gt;layer3_moe_agg -->
<g id="edge271" class="edge">
<title>layer3_experts_gpu13&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M10965.55,-336.39C11009.06,-324.84 11066.13,-309.68 11120.41,-295.26"/>
<polygon fill="black" stroke="black" points="11121.38,-298.63 11130.15,-292.68 11119.59,-291.86 11121.38,-298.63"/>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_experts_gpu14 -->
<g id="edge274" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_experts_gpu14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M11215.44,-413.2C11229.5,-403.18 11244.2,-392.7 11256.98,-383.6"/>
<polygon fill="red" stroke="red" points="11259.37,-386.19 11265.48,-377.54 11255.31,-380.49 11259.37,-386.19"/>
</g>
<!-- layer3_experts_gpu14&#45;&gt;layer3_moe_agg -->
<g id="edge275" class="edge">
<title>layer3_experts_gpu14&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M11293,-336.39C11293,-328.98 11293,-320.1 11293,-310.87"/>
<polygon fill="black" stroke="black" points="11296.5,-310.79 11293,-300.79 11289.5,-310.79 11296.5,-310.79"/>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_experts_gpu15 -->
<g id="edge278" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_experts_gpu15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M11693,-413.2C11693,-404.63 11693,-395.72 11693,-387.62"/>
<polygon fill="red" stroke="red" points="11696.5,-387.54 11693,-377.54 11689.5,-387.54 11696.5,-387.54"/>
</g>
<!-- layer3_experts_gpu15&#45;&gt;layer3_moe_agg -->
<g id="edge279" class="edge">
<title>layer3_experts_gpu15&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M11619.63,-336.39C11584.02,-326.91 11539.3,-315 11494.48,-303.07"/>
<polygon fill="black" stroke="black" points="11495.18,-299.64 11484.62,-300.45 11493.38,-306.4 11495.18,-299.64"/>
</g>
<!-- layer3_moe_agg&#45;&gt;layer3_residual2 -->
<g id="edge280" class="edge">
<title>layer3_moe_agg&#45;&gt;layer3_residual2</title>
<path fill="none" stroke="black" d="M11408.09,-196.32C11431.69,-185.84 11456.35,-174.89 11479.35,-164.68"/>
<polygon fill="black" stroke="black" points="11481.04,-167.76 11488.76,-160.5 11478.2,-161.36 11481.04,-167.76"/>
</g>
<!-- output -->
<g id="node203" class="node">
<title>output</title>
<ellipse fill="#d0e8ff" stroke="black" cx="11579" cy="-21.21" rx="173.9" ry="21.43"/>
<text text-anchor="middle" x="11579" y="-24.21" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="11579" y="-13.21" font-family="Arial" font-size="10.00">[batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer3_residual2&#45;&gt;output -->
<g id="edge282" class="edge">
<title>layer3_residual2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M11579,-78.18C11579,-69.66 11579,-60.8 11579,-52.71"/>
<polygon fill="black" stroke="black" points="11582.5,-52.61 11579,-42.61 11575.5,-52.61 11582.5,-52.61"/>
</g>
</g>
</svg>
