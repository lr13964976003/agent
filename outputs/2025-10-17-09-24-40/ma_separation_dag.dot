digraph ma_separation_dag {
	graph [bb="0,0,13655,3839.9",
		bgcolor=white,
		compound=true,
		fontname=Arial,
		fontsize=12,
		rankdir=TB
	];
	node [fontname=Arial,
		fontsize=10,
		label="\N"
	];
	subgraph layer_0 {
		graph [label="Layer 0",
			rank=same
		];
		subgraph layer0_attention_group {
			graph [label="Attention Parallelization (GPUs 0-11)",
				rank=same,
				style=dotted
			];
			layer0_qkv_gpu0	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU0\nQKV Projection\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
				pos="8716,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_qkv_gpu1	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU1\nQKV Projection\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
				pos="7958,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_qkv_gpu2	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU2\nQKV Projection\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
				pos="7200,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_qkv_gpu3	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU3\nQKV Projection\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
				pos="6442,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_qkv_gpu4	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU4\nQKV Projection\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
				pos="5684,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_qkv_gpu5	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU5\nQKV Projection\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
				pos="4926,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_qkv_gpu6	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU6\nQKV Projection\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
				pos="4168,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_qkv_gpu7	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU7\nQKV Projection\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
				pos="3410,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_qkv_gpu8	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU8\nQKV Projection\n[Input: [1024,2048,4096], Output: [1024,2048,256]]",
				pos="2652,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_qkv_gpu9	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU9\nQKV Projection\n[Input: [1024,2048,4096], Output: [1024,2048,256]]",
				pos="1894,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_qkv_gpu10	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU10\nQKV Projection\n[Input: [1024,2048,4096], Output: [1024,2048,256]]",
				pos="1136,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_qkv_gpu11	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU11\nQKV Projection\n[Input: [1024,2048,4096], Output: [1024,2048,256]]",
				pos="378,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_attn_gpu0	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU0\nMulti-Head Attention\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
				pos="8968,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2083];
			layer0_attn_gpu1	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU1\nMulti-Head Attention\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
				pos="8210,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2083];
			layer0_attn_gpu2	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU2\nMulti-Head Attention\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
				pos="7452,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2083];
			layer0_attn_gpu3	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU3\nMulti-Head Attention\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
				pos="6694,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2083];
			layer0_attn_gpu4	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU4\nMulti-Head Attention\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
				pos="5936,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2083];
			layer0_attn_gpu5	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU5\nMulti-Head Attention\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
				pos="5178,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2083];
			layer0_attn_gpu6	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU6\nMulti-Head Attention\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
				pos="4420,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2083];
			layer0_attn_gpu7	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU7\nMulti-Head Attention\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
				pos="3662,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2083];
			layer0_attn_gpu8	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU8\nMulti-Head Attention\n[Input: [1024,2048,256], Output: [1024,2048,256]]",
				pos="2904,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2083];
			layer0_attn_gpu9	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU9\nMulti-Head Attention\n[Input: [1024,2048,256], Output: [1024,2048,256]]",
				pos="2146,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2083];
			layer0_attn_gpu10	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU10\nMulti-Head Attention\n[Input: [1024,2048,256], Output: [1024,2048,256]]",
				pos="1388,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2083];
			layer0_attn_gpu11	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU11\nMulti-Head Attention\n[Input: [1024,2048,256], Output: [1024,2048,256]]",
				pos="630,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2083];
			layer0_out_proj_gpu0	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU0\nOutput Projection\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
				pos="9220,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_out_proj_gpu1	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU1\nOutput Projection\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
				pos="8462,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_out_proj_gpu2	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU2\nOutput Projection\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
				pos="7704,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_out_proj_gpu3	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU3\nOutput Projection\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
				pos="6946,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_out_proj_gpu4	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU4\nOutput Projection\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
				pos="6188,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_out_proj_gpu5	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU5\nOutput Projection\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
				pos="5430,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_out_proj_gpu6	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU6\nOutput Projection\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
				pos="4672,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_out_proj_gpu7	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU7\nOutput Projection\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
				pos="3914,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_out_proj_gpu8	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU8\nOutput Projection\n[Input: [1024,2048,256], Output: [1024,2048,4096]]",
				pos="3156,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_out_proj_gpu9	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU9\nOutput Projection\n[Input: [1024,2048,256], Output: [1024,2048,4096]]",
				pos="2398,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_out_proj_gpu10	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU10\nOutput Projection\n[Input: [1024,2048,256], Output: [1024,2048,4096]]",
				pos="1640,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
			layer0_out_proj_gpu11	[fillcolor="#E8F4FD",
				height=0.56944,
				label="GPU11\nOutput Projection\n[Input: [1024,2048,256], Output: [1024,2048,4096]]",
				pos="882,3632.4",
				shape=rectangle,
				style=filled,
				width=3.2778];
		}
		layer0_pre_attn_norm	[fillcolor="#E8F4FD",
			height=0.5,
			label="LayerNorm\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="121,3632.4",
			shape=rectangle,
			style=filled,
			width=3.3611];
		layer0_attn_agg	[fillcolor="#FFF4E8",
			height=1.4444,
			label="Attention\nAggregation\nAll-Reduce\n[Input: 12Ã—[1024,2048,4096], Output: [1024,2048,4096]]",
			pos="9623,3632.4",
			shape=parallelogram,
			style="filled,rounded",
			width=7.4301];
		layer0_residual1	[fillcolor="#FFF4E8",
			height=0.83333,
			label="Residual Add\n[Input1: [1024,2048,4096], Input2: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="10283,3632.4",
			shape=parallelogram,
			style="filled,rounded",
			width=10.396];
		layer0_post_attn_norm	[fillcolor="#FDE8E8",
			height=0.5,
			label="LayerNorm\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="11320,3632.4",
			shape=rectangle,
			style=filled,
			width=3.3611];
	}
	subgraph layer0_moe_group {
		graph [label="MoE Parallelization (GPUs 12-15)",
			rank=same,
			style=dotted
		];
		layer0_gate_gpu12	[fillcolor="#FDE8E8",
			height=1.1389,
			label="GPU12\nGating Network\n[Input: [1024,2048,4096], Output: [1024,2048,16] (routing)]",
			pos="10066,3503.4",
			shape=parallelogram,
			style=filled,
			width=7.7468];
		layer0_gate_gpu13	[fillcolor="#FDE8E8",
			height=1.1389,
			label="GPU13\nGating Network\n[Input: [1024,2048,4096], Output: [1024,2048,16] (routing)]",
			pos="10902,3503.4",
			shape=parallelogram,
			style=filled,
			width=7.7468];
		layer0_gate_gpu14	[fillcolor="#FDE8E8",
			height=1.1389,
			label="GPU14\nGating Network\n[Input: [1024,2048,4096], Output: [1024,2048,16] (routing)]",
			pos="11738,3503.4",
			shape=parallelogram,
			style=filled,
			width=7.7468];
		layer0_gate_gpu15	[fillcolor="#FDE8E8",
			height=1.1389,
			label="GPU15\nGating Network\n[Input: [1024,2048,4096], Output: [1024,2048,16] (routing)]",
			pos="12574,3503.4",
			shape=parallelogram,
			style=filled,
			width=7.7468];
		layer0_experts_gpu12	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU12\nExperts 0-3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="10484,3503.4",
			shape=rectangle,
			style=filled,
			width=3.3611];
		layer0_experts_gpu13	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU13\nExperts 4-7\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="11320,3503.4",
			shape=rectangle,
			style=filled,
			width=3.3611];
		layer0_experts_gpu14	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU14\nExperts 8-11\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="12156,3503.4",
			shape=rectangle,
			style=filled,
			width=3.3611];
		layer0_experts_gpu15	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU15\nExperts 12-15\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="12992,3503.4",
			shape=rectangle,
			style=filled,
			width=3.3611];
		layer0_moe_agg	[fillcolor="#FFF4E8",
			height=1.1389,
			label="Expert\nAggregation\n[Input: 4Ã—[1024,2048,4096], Output: [1024,2048,4096]]",
			pos="13393,3503.4",
			shape=parallelogram,
			style="filled,rounded",
			width=7.2861];
	}
	input	[fillcolor="#D0E8FF",
		height=0.58926,
		label="Input\n[batch_size=1024, seq_len=2048, hidden_dim=4096]",
		pos="5202,3818.6",
		shape=ellipse,
		style=filled,
		width=4.8319];
	embeddings	[fillcolor="#E8F4FD",
		height=0.56944,
		label="Token + Position\nEmbedding\n[Input: [1024,2048], Output: [1024,2048,4096]]",
		pos="5202,3740.9",
		shape=rectangle,
		style=filled,
		width=3.0278];
	input -> embeddings	[pos="e,5202,3761.5 5202,3797.3 5202,3789.4 5202,3780.2 5202,3771.6"];
	embeddings -> layer0_pre_attn_norm	[pos="e,154.47,3650.5 5093,3739.8 4388.1,3739 496.47,3732.3 251,3684.4 220.72,3678.5 188.42,3665.9 163.6,3654.7"];
	embeddings -> layer0_residual1	[pos="e,10099,3662.4 5311.2,3739.4 5972.6,3736.3 9428.6,3718.3 9899,3684.4 9961,3680 10028,3672.1 10089,3663.8"];
	layer0_pre_attn_norm -> layer0_qkv_gpu0	[pos="e,8686.3,3653 147.49,3650.5 174.43,3667.7 218.07,3692.5 260,3702.4 316.21,3715.8 8523.8,3716 8580,3702.4 8615.2,3693.9 8651.6,3674.5 \
8677.8,3658.3"];
	layer0_pre_attn_norm -> layer0_qkv_gpu1	[pos="e,7928.3,3653 147.49,3650.5 174.43,3667.7 218.07,3692.5 260,3702.4 311.09,3714.6 7771,3714.8 7822,3702.4 7857.2,3693.9 7893.6,3674.5 \
7919.8,3658.3"];
	layer0_pre_attn_norm -> layer0_qkv_gpu2	[pos="e,7170.3,3653 147.49,3650.5 174.43,3667.7 218.07,3692.5 260,3702.4 351.94,3724.3 6972.2,3724.7 7064,3702.4 7099.2,3693.9 7135.6,\
3674.5 7161.8,3658.3"];
	layer0_pre_attn_norm -> layer0_qkv_gpu3	[pos="e,6412.3,3653 147.49,3650.5 174.43,3667.7 218.07,3692.5 260,3702.4 341.7,3721.8 6224.4,3722.2 6306,3702.4 6341.2,3693.9 6377.6,3674.5 \
6403.8,3658.3"];
	layer0_pre_attn_norm -> layer0_qkv_gpu4	[pos="e,5654.3,3653 147.49,3650.5 174.43,3667.7 218.07,3692.5 260,3702.4 331.46,3719.4 5476.6,3719.7 5548,3702.4 5583.2,3693.9 5619.6,\
3674.5 5645.8,3658.3"];
	layer0_pre_attn_norm -> layer0_qkv_gpu5	[pos="e,4896.3,3653 147.49,3650.5 174.43,3667.7 218.07,3692.5 260,3702.4 321.21,3717 4728.9,3717.2 4790,3702.4 4825.2,3693.9 4861.6,3674.5 \
4887.8,3658.3"];
	layer0_pre_attn_norm -> layer0_qkv_gpu6	[pos="e,4138.3,3653 147.49,3650.5 174.43,3667.7 218.07,3692.5 260,3702.4 310.97,3714.5 3981.1,3714.8 4032,3702.4 4067.2,3693.9 4103.6,\
3674.5 4129.8,3658.3"];
	layer0_pre_attn_norm -> layer0_qkv_gpu7	[pos="e,3380.3,3653 147.49,3650.5 174.43,3667.7 218.07,3692.5 260,3702.4 341.45,3721.8 3192.6,3722.1 3274,3702.4 3309.2,3693.9 3345.6,\
3674.5 3371.8,3658.3"];
	layer0_pre_attn_norm -> layer0_qkv_gpu8	[pos="e,2622.3,3653 147.49,3650.5 174.43,3667.7 218.07,3692.5 260,3702.4 320.97,3716.9 2455.1,3717.2 2516,3702.4 2551.2,3693.9 2587.6,\
3674.5 2613.8,3658.3"];
	layer0_pre_attn_norm -> layer0_qkv_gpu9	[pos="e,1864.3,3653 147.49,3650.5 174.43,3667.7 218.07,3692.5 260,3702.4 340.97,3721.7 1677.1,3722 1758,3702.4 1793.2,3693.9 1829.6,3674.5 \
1855.8,3658.3"];
	layer0_pre_attn_norm -> layer0_qkv_gpu10	[pos="e,1106.3,3653 147.49,3650.5 174.43,3667.7 218.07,3692.5 260,3702.4 340,3721.4 920.09,3721.8 1000,3702.4 1035.2,3693.9 1071.6,3674.5 \
1097.8,3658.3"];
	layer0_pre_attn_norm -> layer0_qkv_gpu11	[pos="e,259.99,3632.4 242.22,3632.4 244.72,3632.4 247.22,3632.4 249.72,3632.4"];
	layer0_qkv_gpu0 -> layer0_attn_gpu0	[pos="e,8852.4,3632.4 8834.1,3632.4 8836.9,3632.4 8839.7,3632.4 8842.4,3632.4"];
	layer0_qkv_gpu1 -> layer0_attn_gpu1	[pos="e,8094.4,3632.4 8076.1,3632.4 8078.9,3632.4 8081.7,3632.4 8084.4,3632.4"];
	layer0_qkv_gpu2 -> layer0_attn_gpu2	[pos="e,7336.4,3632.4 7318.1,3632.4 7320.9,3632.4 7323.7,3632.4 7326.4,3632.4"];
	layer0_qkv_gpu3 -> layer0_attn_gpu3	[pos="e,6578.4,3632.4 6560.1,3632.4 6562.9,3632.4 6565.7,3632.4 6568.4,3632.4"];
	layer0_qkv_gpu4 -> layer0_attn_gpu4	[pos="e,5820.4,3632.4 5802.1,3632.4 5804.9,3632.4 5807.7,3632.4 5810.4,3632.4"];
	layer0_qkv_gpu5 -> layer0_attn_gpu5	[pos="e,5062.4,3632.4 5044.1,3632.4 5046.9,3632.4 5049.7,3632.4 5052.4,3632.4"];
	layer0_qkv_gpu6 -> layer0_attn_gpu6	[pos="e,4304.4,3632.4 4286.1,3632.4 4288.9,3632.4 4291.7,3632.4 4294.4,3632.4"];
	layer0_qkv_gpu7 -> layer0_attn_gpu7	[pos="e,3546.4,3632.4 3528.1,3632.4 3530.9,3632.4 3533.7,3632.4 3536.4,3632.4"];
	layer0_qkv_gpu8 -> layer0_attn_gpu8	[pos="e,2788.4,3632.4 2770.1,3632.4 2772.9,3632.4 2775.7,3632.4 2778.4,3632.4"];
	layer0_qkv_gpu9 -> layer0_attn_gpu9	[pos="e,2030.4,3632.4 2012.1,3632.4 2014.9,3632.4 2017.7,3632.4 2020.4,3632.4"];
	layer0_qkv_gpu10 -> layer0_attn_gpu10	[pos="e,1272.4,3632.4 1254.1,3632.4 1256.9,3632.4 1259.7,3632.4 1262.4,3632.4"];
	layer0_qkv_gpu11 -> layer0_attn_gpu11	[pos="e,514.43,3632.4 496.12,3632.4 498.89,3632.4 501.65,3632.4 504.42,3632.4"];
	layer0_attn_gpu0 -> layer0_out_proj_gpu0	[pos="e,9101.8,3632.4 9083.7,3632.4 9086.3,3632.4 9088.9,3632.4 9091.6,3632.4"];
	layer0_attn_gpu1 -> layer0_out_proj_gpu1	[pos="e,8343.8,3632.4 8325.7,3632.4 8328.3,3632.4 8330.9,3632.4 8333.6,3632.4"];
	layer0_attn_gpu2 -> layer0_out_proj_gpu2	[pos="e,7585.8,3632.4 7567.7,3632.4 7570.3,3632.4 7572.9,3632.4 7575.6,3632.4"];
	layer0_attn_gpu3 -> layer0_out_proj_gpu3	[pos="e,6827.8,3632.4 6809.7,3632.4 6812.3,3632.4 6814.9,3632.4 6817.6,3632.4"];
	layer0_attn_gpu4 -> layer0_out_proj_gpu4	[pos="e,6069.8,3632.4 6051.7,3632.4 6054.3,3632.4 6056.9,3632.4 6059.6,3632.4"];
	layer0_attn_gpu5 -> layer0_out_proj_gpu5	[pos="e,5311.8,3632.4 5293.7,3632.4 5296.3,3632.4 5298.9,3632.4 5301.6,3632.4"];
	layer0_attn_gpu6 -> layer0_out_proj_gpu6	[pos="e,4553.8,3632.4 4535.7,3632.4 4538.3,3632.4 4540.9,3632.4 4543.6,3632.4"];
	layer0_attn_gpu7 -> layer0_out_proj_gpu7	[pos="e,3795.8,3632.4 3777.7,3632.4 3780.3,3632.4 3782.9,3632.4 3785.6,3632.4"];
	layer0_attn_gpu8 -> layer0_out_proj_gpu8	[pos="e,3037.8,3632.4 3019.7,3632.4 3022.3,3632.4 3024.9,3632.4 3027.6,3632.4"];
	layer0_attn_gpu9 -> layer0_out_proj_gpu9	[pos="e,2279.8,3632.4 2261.7,3632.4 2264.3,3632.4 2266.9,3632.4 2269.6,3632.4"];
	layer0_attn_gpu10 -> layer0_out_proj_gpu10	[pos="e,1521.8,3632.4 1503.7,3632.4 1506.3,3632.4 1508.9,3632.4 1511.6,3632.4"];
	layer0_attn_gpu11 -> layer0_out_proj_gpu11	[pos="e,763.77,3632.4 745.66,3632.4 748.3,3632.4 750.95,3632.4 753.59,3632.4"];
	layer0_out_proj_gpu0 -> layer0_attn_agg	[pos="e,9410.1,3632.4 9338.1,3632.4 9358.7,3632.4 9379.4,3632.4 9400,3632.4"];
	layer0_out_proj_gpu1 -> layer0_attn_agg	[pos="e,9459.6,3679.7 8491.7,3653 8518.2,3670 8558.8,3692.9 8598,3702.4 8677.9,3721.8 9256.4,3712.3 9338,3702.4 9374.6,3698 9413.2,3690.5 \
9449.8,3682"];
	layer0_out_proj_gpu2 -> layer0_attn_agg	[pos="e,9459.6,3679.7 7733.7,3653 7760.2,3670 7800.8,3692.9 7840,3702.4 7920.9,3722 9255.4,3712.4 9338,3702.4 9374.6,3698 9413.2,3690.5 \
9449.8,3682"];
	layer0_out_proj_gpu3 -> layer0_attn_agg	[pos="e,9459.6,3679.7 6975.7,3653 7002.2,3670 7042.8,3692.9 7082,3702.4 7203.8,3731.9 9213.6,3717.5 9338,3702.4 9374.6,3698 9413.2,3690.5 \
9449.8,3682"];
	layer0_out_proj_gpu4 -> layer0_attn_agg	[pos="e,9459.6,3679.7 6217.7,3653 6244.2,3670 6284.8,3692.9 6324,3702.4 6405.4,3722.1 9254.9,3712.5 9338,3702.4 9374.6,3698 9413.2,3690.5 \
9449.8,3682"];
	layer0_out_proj_gpu5 -> layer0_attn_agg	[pos="e,9459.6,3679.7 5459.7,3653 5486.2,3670 5526.8,3692.9 5566,3702.4 5667.8,3727.1 9234,3715 9338,3702.4 9374.6,3698 9413.2,3690.5 \
9449.8,3682"];
	layer0_out_proj_gpu6 -> layer0_attn_agg	[pos="e,9459.6,3679.7 4701.7,3653 4728.2,3670 4768.8,3692.9 4808,3702.4 4930.3,3732.1 9213.1,3717.5 9338,3702.4 9374.6,3698 9413.2,3690.5 \
9449.8,3682"];
	layer0_out_proj_gpu7 -> layer0_attn_agg	[pos="e,9459.6,3679.7 3943.7,3653 3970.2,3670 4010.8,3692.9 4050,3702.4 4121.4,3719.7 9265.1,3711.2 9338,3702.4 9374.6,3698 9413.2,3690.5 \
9449.8,3682"];
	layer0_out_proj_gpu8 -> layer0_attn_agg	[pos="e,9459.6,3679.7 3185.7,3653 3212.2,3670 3252.8,3692.9 3292,3702.4 3373.6,3722.2 9254.6,3712.5 9338,3702.4 9374.6,3698 9413.2,3690.5 \
9449.8,3682"];
	layer0_out_proj_gpu9 -> layer0_attn_agg	[pos="e,9459.6,3679.7 2427.7,3653 2454.2,3670 2494.8,3692.9 2534,3702.4 2625.8,3724.7 9244.2,3713.8 9338,3702.4 9374.6,3698 9413.2,3690.5 \
9449.8,3682"];
	layer0_out_proj_gpu10 -> layer0_attn_agg	[pos="e,9459.6,3679.7 1669.7,3653 1696.2,3670 1736.8,3692.9 1776,3702.4 1878.1,3727.2 9233.7,3715 9338,3702.4 9374.6,3698 9413.2,3690.5 \
9449.8,3682"];
	layer0_out_proj_gpu11 -> layer0_attn_agg	[pos="e,9459.6,3679.7 911.68,3653 938.18,3670 978.77,3692.9 1018,3702.4 1130.3,3729.6 9223.3,3716.3 9338,3702.4 9374.6,3698 9413.2,3690.5 \
9449.8,3682"];
	layer0_attn_agg -> layer0_residual1	[pos="e,9985.3,3632.4 9836,3632.4 9882.4,3632.4 9928.7,3632.4 9975.1,3632.4"];
	layer0_residual1 -> layer0_post_attn_norm	[pos="e,11199,3632.4 10581,3632.4 10783,3632.4 10986,3632.4 11188,3632.4"];
	layer0_residual2	[fillcolor="#FFF4E8",
		height=0.83333,
		label="Residual Add\n[Input1: [1024,2048,4096], Input2: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="11576,3396.4",
		shape=parallelogram,
		style="filled,rounded",
		width=10.396];
	layer0_residual1 -> layer0_residual2	[pos="e,11281,3397.5 10079,3602.4 9943.3,3582.1 9788.2,3556.5 9778,3544.4 9754.5,3516.6 9752.7,3488.7 9778,3462.4 9828.9,3409.7 10771,\
3399.3 11271,3397.6"];
	layer0_post_attn_norm -> layer0_gate_gpu12	[color=blue,
		pos="e,10343,3543.2 11199,3622.4 11016,3608.3 10657,3579.1 10354,3544.4 10354,3544.4 10353,3544.3 10353,3544.3",
		style=dashed];
	layer0_post_attn_norm -> layer0_gate_gpu13	[color=blue,
		pos="e,11034,3544.5 11264,3614.3 11207,3597.2 11119,3570.3 11043,3547.4",
		style=dashed];
	layer0_post_attn_norm -> layer0_gate_gpu14	[color=blue,
		pos="e,11606,3544.5 11376,3614.3 11433,3597.2 11521,3570.3 11597,3547.4",
		style=dashed];
	layer0_post_attn_norm -> layer0_gate_gpu15	[color=blue,
		pos="e,12391,3531.3 11441,3622.4 11624,3608.3 11983,3579.1 12286,3544.4 12317,3540.9 12349,3536.8 12380,3532.6",
		style=dashed];
	layer0_post_attn_norm -> layer0_experts_gpu12	[pos="e,10540,3523.9 11199,3623 11057,3611.7 10817,3587.8 10614,3544.4 10593,3539.9 10570,3533.4 10549,3527"];
	layer0_post_attn_norm -> layer0_experts_gpu13	[pos="e,11320,3524.2 11320,3614.3 11320,3593.8 11320,3559.1 11320,3534.2"];
	layer0_post_attn_norm -> layer0_experts_gpu14	[pos="e,12100,3523.9 11441,3623 11583,3611.7 11823,3587.8 12026,3544.4 12047,3539.9 12070,3533.4 12091,3527"];
	layer0_post_attn_norm -> layer0_experts_gpu15	[pos="e,12939,3523.9 11441,3628.4 11755,3619.9 12590,3593.2 12862,3544.4 12884,3540.4 12908,3533.8 12929,3527.1"];
	layer0_gate_gpu12 -> layer0_experts_gpu12	[color=red,
		pos="e,10363,3503.4 10288,3503.4 10310,3503.4 10331,3503.4 10352,3503.4",
		style=dashed];
	layer0_gate_gpu13 -> layer0_experts_gpu13	[color=red,
		pos="e,11199,3503.4 11124,3503.4 11146,3503.4 11167,3503.4 11188,3503.4",
		style=dashed];
	layer0_gate_gpu14 -> layer0_experts_gpu14	[color=red,
		pos="e,12035,3503.4 11960,3503.4 11982,3503.4 12003,3503.4 12024,3503.4",
		style=dashed];
	layer0_gate_gpu15 -> layer0_experts_gpu15	[color=red,
		pos="e,12871,3503.4 12796,3503.4 12818,3503.4 12839,3503.4 12860,3503.4",
		style=dashed];
	layer0_experts_gpu12 -> layer0_moe_agg	[pos="e,13235,3542.6 10521,3524 10548,3537.9 10587,3555.1 10623,3562.4 10759,3590 12975,3576.8 13113,3562.4 13150,3558.6 13189,3552 13226,\
3544.6"];
	layer0_experts_gpu13 -> layer0_moe_agg	[pos="e,13235,3542.6 11357,3524 11384,3537.9 11423,3555.1 11459,3562.4 11549,3580.7 13022,3572 13113,3562.4 13150,3558.6 13189,3552 13226,\
3544.6"];
	layer0_experts_gpu14 -> layer0_moe_agg	[pos="e,13235,3542.6 12193,3524 12220,3537.9 12259,3555.1 12295,3562.4 12384,3580.5 13023,3571.8 13113,3562.4 13150,3558.6 13189,3552 \
13226,3544.6"];
	layer0_experts_gpu15 -> layer0_moe_agg	[pos="e,13184,3503.4 13113,3503.4 13133,3503.4 13154,3503.4 13174,3503.4"];
	layer0_moe_agg -> layer0_residual2	[pos="e,11885,3400.9 13132,3463.4 13129,3463.1 13125,3462.7 13122,3462.4 12699,3422.4 12208,3407 11895,3401.1"];
	layer1_pre_attn_norm	[fillcolor="#E8F4FD",
		height=0.56944,
		label="Layer 1\nLayerNorm\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="10868,3309.9",
		shape=rectangle,
		style=filled,
		width=3.3611];
	layer0_residual2 -> layer1_pre_attn_norm	[pos="e,10989,3325.4 11333,3366.4 11221,3353.1 11093,3337.8 10999,3326.6"];
	layer1_residual1	[fillcolor="#FFF4E8",
		height=1.1389,
		label="Layer 1\nResidual Add\n[Input: 2Ã—[1024,2048,4096], Output: [1024,2048,4096]]",
		pos="11576,2841.4",
		shape=parallelogram,
		style="filled,rounded",
		width=7.2861];
	layer0_residual2 -> layer1_residual1	[pos="e,11834,2879.1 11841,3383.8 12042,3367.4 12284,3328.2 12284,3233.9 12284,3233.9 12284,3233.9 12284,3077.9 12284,2981.5 12044,2917.5 \
11844,2880.9"];
	layer1_qkv_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nQKV Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="9344,3232.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_pre_attn_norm -> layer1_qkv_gpu0	[pos="e,9462.2,3252.5 10747,3308.7 10506,3307.2 9949.2,3298.8 9472.4,3253.5"];
	layer1_qkv_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nQKV Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="9598,3232.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_pre_attn_norm -> layer1_qkv_gpu1	[pos="e,9716.3,3252.5 10747,3307.2 10540,3303.3 10104,3291 9726.3,3253.5"];
	layer1_qkv_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nQKV Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="9852,3232.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_pre_attn_norm -> layer1_qkv_gpu2	[pos="e,9970.3,3252.4 10747,3304.8 10578,3298.3 10260,3283.3 9980.2,3253.5"];
	layer1_qkv_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nQKV Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="10106,3232.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_pre_attn_norm -> layer1_qkv_gpu3	[pos="e,10224,3252.3 10747,3300.7 10621,3291.6 10419,3275.5 10234,3253.6"];
	layer1_qkv_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nQKV Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="10360,3232.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_pre_attn_norm -> layer1_qkv_gpu4	[pos="e,10478,3252.1 10747,3291.5 10675,3281.1 10581,3267.4 10488,3253.6"];
	layer1_qkv_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nQKV Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="10614,3232.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_pre_attn_norm -> layer1_qkv_gpu5	[pos="e,10680,3253.5 10802,3289.4 10768,3279.3 10726,3266.9 10690,3256.4"];
	layer1_qkv_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nQKV Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="10868,3232.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_pre_attn_norm -> layer1_qkv_gpu6	[pos="e,10868,3253.5 10868,3289.2 10868,3281.4 10868,3272.2 10868,3263.6"];
	layer1_qkv_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nQKV Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="11122,3232.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_pre_attn_norm -> layer1_qkv_gpu7	[pos="e,11056,3253.5 10934,3289.4 10968,3279.3 11010,3266.9 11046,3256.4"];
	layer1_qkv_gpu8	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU8\nQKV Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,256]]",
		pos="11376,3232.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_pre_attn_norm -> layer1_qkv_gpu8	[pos="e,11258,3252.1 10989,3291.5 11061,3281.1 11155,3267.4 11248,3253.6"];
	layer1_qkv_gpu9	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU9\nQKV Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,256]]",
		pos="11630,3232.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_pre_attn_norm -> layer1_qkv_gpu9	[pos="e,11512,3252.3 10989,3300.7 11115,3291.6 11317,3275.5 11502,3253.6"];
	layer1_qkv_gpu10	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU10\nQKV Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,256]]",
		pos="11884,3232.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_pre_attn_norm -> layer1_qkv_gpu10	[pos="e,11766,3252.4 10989,3304.8 11158,3298.3 11476,3283.3 11756,3253.5"];
	layer1_qkv_gpu11	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU11\nQKV Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,256]]",
		pos="12138,3232.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_pre_attn_norm -> layer1_qkv_gpu11	[pos="e,12020,3252.5 10989,3307.2 11196,3303.3 11632,3291 12010,3253.5"];
	layer1_attn_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nAttn Layer1\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="9344,3155.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_qkv_gpu0 -> layer1_attn_gpu0	[pos="e,9344,3176.5 9344,3212.2 9344,3204.4 9344,3195.2 9344,3186.6"];
	layer1_out_proj_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nOutProj Layer1\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="9344,3078.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_attn_gpu0 -> layer1_out_proj_gpu0	[pos="e,9344,3099.5 9344,3135.2 9344,3127.4 9344,3118.2 9344,3109.6"];
	layer1_attn_agg	[fillcolor="#FFF4E8",
		height=1.4444,
		label="Layer 1\nAttention\nAggregation\n[Input: 12Ã—[1024,2048,4096], Output: [1024,2048,4096]]",
		pos="10868,2970.4",
		shape=parallelogram,
		style="filled,rounded",
		width=7.4301];
	layer1_out_proj_gpu0 -> layer1_attn_agg	[pos="e,10664,2978.4 9462.3,3059.4 9465.2,3059.1 9468.1,3058.7 9471,3058.4 9888.5,3013.5 10379,2989.6 10654,2978.8"];
	layer1_attn_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nAttn Layer1\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="9598,3155.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_qkv_gpu1 -> layer1_attn_gpu1	[pos="e,9598,3176.5 9598,3212.2 9598,3204.4 9598,3195.2 9598,3186.6"];
	layer1_out_proj_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nOutProj Layer1\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="9598,3078.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_attn_gpu1 -> layer1_out_proj_gpu1	[pos="e,9598,3099.5 9598,3135.2 9598,3127.4 9598,3118.2 9598,3109.6"];
	layer1_out_proj_gpu1 -> layer1_attn_agg	[pos="e,10667,2982.1 9716.3,3059.5 9719.2,3059.1 9722.1,3058.8 9725,3058.4 10049,3021.2 10427,2996 10657,2982.6"];
	layer1_attn_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nAttn Layer1\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="9852,3155.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_qkv_gpu2 -> layer1_attn_gpu2	[pos="e,9852,3176.5 9852,3212.2 9852,3204.4 9852,3195.2 9852,3186.6"];
	layer1_out_proj_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nOutProj Layer1\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="9852,3078.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_attn_gpu2 -> layer1_out_proj_gpu2	[pos="e,9852,3099.5 9852,3135.2 9852,3127.4 9852,3118.2 9852,3109.6"];
	layer1_out_proj_gpu2 -> layer1_attn_agg	[pos="e,10673,2987.4 9970.3,3059.5 9973.2,3059.2 9976.1,3058.8 9979,3058.4 10213,3029 10482,3003.9 10663,2988.3"];
	layer1_attn_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nAttn Layer1\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="10106,3155.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_qkv_gpu3 -> layer1_attn_gpu3	[pos="e,10106,3176.5 10106,3212.2 10106,3204.4 10106,3195.2 10106,3186.6"];
	layer1_out_proj_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nOutProj Layer1\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="10106,3078.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_attn_gpu3 -> layer1_out_proj_gpu3	[pos="e,10106,3099.5 10106,3135.2 10106,3127.4 10106,3118.2 10106,3109.6"];
	layer1_out_proj_gpu3 -> layer1_attn_agg	[pos="e,10682,2996.1 10224,3059.7 10227,3059.3 10230,3058.8 10233,3058.4 10380,3037.1 10546,3014.3 10672,2997.5"];
	layer1_attn_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nAttn Layer1\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="10360,3155.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_qkv_gpu4 -> layer1_attn_gpu4	[pos="e,10360,3176.5 10360,3212.2 10360,3204.4 10360,3195.2 10360,3186.6"];
	layer1_out_proj_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nOutProj Layer1\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="10360,3078.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_attn_gpu4 -> layer1_out_proj_gpu4	[pos="e,10360,3099.5 10360,3135.2 10360,3127.4 10360,3118.2 10360,3109.6"];
	layer1_out_proj_gpu4 -> layer1_attn_agg	[pos="e,10694,3007.8 10453,3058.4 10518,3044.8 10606,3026.4 10684,3009.9"];
	layer1_attn_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nAttn Layer1\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="10614,3155.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_qkv_gpu5 -> layer1_attn_gpu5	[pos="e,10614,3176.5 10614,3212.2 10614,3204.4 10614,3195.2 10614,3186.6"];
	layer1_out_proj_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nOutProj Layer1\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="10614,3078.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_attn_gpu5 -> layer1_out_proj_gpu5	[pos="e,10614,3099.5 10614,3135.2 10614,3127.4 10614,3118.2 10614,3109.6"];
	layer1_out_proj_gpu5 -> layer1_attn_agg	[pos="e,10746,3022.4 10661,3058.4 10682,3049.2 10710,3037.8 10737,3026.3"];
	layer1_attn_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nAttn Layer1\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="10868,3155.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_qkv_gpu6 -> layer1_attn_gpu6	[pos="e,10868,3176.5 10868,3212.2 10868,3204.4 10868,3195.2 10868,3186.6"];
	layer1_out_proj_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nOutProj Layer1\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="10868,3078.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_attn_gpu6 -> layer1_out_proj_gpu6	[pos="e,10868,3099.5 10868,3135.2 10868,3127.4 10868,3118.2 10868,3109.6"];
	layer1_out_proj_gpu6 -> layer1_attn_agg	[pos="e,10868,3022.8 10868,3058.4 10868,3051 10868,3042.1 10868,3032.9"];
	layer1_attn_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nAttn Layer1\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="11122,3155.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_qkv_gpu7 -> layer1_attn_gpu7	[pos="e,11122,3176.5 11122,3212.2 11122,3204.4 11122,3195.2 11122,3186.6"];
	layer1_out_proj_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nOutProj Layer1\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="11122,3078.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_attn_gpu7 -> layer1_out_proj_gpu7	[pos="e,11122,3099.5 11122,3135.2 11122,3127.4 11122,3118.2 11122,3109.6"];
	layer1_out_proj_gpu7 -> layer1_attn_agg	[pos="e,10990,3022.4 11075,3058.4 11054,3049.2 11026,3037.8 10999,3026.3"];
	layer1_attn_gpu8	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU8\nAttn Layer1\n[Input: [1024,2048,256], Output: [1024,2048,256]]",
		pos="11376,3155.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_qkv_gpu8 -> layer1_attn_gpu8	[pos="e,11376,3176.5 11376,3212.2 11376,3204.4 11376,3195.2 11376,3186.6"];
	layer1_out_proj_gpu8	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU8\nOutProj Layer1\n[Input: [1024,2048,256], Output: [1024,2048,4096]]",
		pos="11376,3078.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_attn_gpu8 -> layer1_out_proj_gpu8	[pos="e,11376,3099.5 11376,3135.2 11376,3127.4 11376,3118.2 11376,3109.6"];
	layer1_out_proj_gpu8 -> layer1_attn_agg	[pos="e,11111,3022.4 11283,3058.4 11237,3048.8 11179,3036.7 11121,3024.5"];
	layer1_attn_gpu9	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU9\nAttn Layer1\n[Input: [1024,2048,256], Output: [1024,2048,256]]",
		pos="11630,3155.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_qkv_gpu9 -> layer1_attn_gpu9	[pos="e,11630,3176.5 11630,3212.2 11630,3204.4 11630,3195.2 11630,3186.6"];
	layer1_out_proj_gpu9	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU9\nOutProj Layer1\n[Input: [1024,2048,256], Output: [1024,2048,4096]]",
		pos="11630,3078.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_attn_gpu9 -> layer1_out_proj_gpu9	[pos="e,11630,3099.5 11630,3135.2 11630,3127.4 11630,3118.2 11630,3109.6"];
	layer1_out_proj_gpu9 -> layer1_attn_agg	[pos="e,11117,3004.6 11512,3059.7 11509,3059.3 11506,3058.8 11503,3058.4 11379,3040.5 11242,3021.5 11127,3005.9"];
	layer1_attn_gpu10	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU10\nAttn Layer1\n[Input: [1024,2048,256], Output: [1024,2048,256]]",
		pos="11884,3155.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_qkv_gpu10 -> layer1_attn_gpu10	[pos="e,11884,3176.5 11884,3212.2 11884,3204.4 11884,3195.2 11884,3186.6"];
	layer1_out_proj_gpu10	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU10\nOutProj Layer1\n[Input: [1024,2048,256], Output: [1024,2048,4096]]",
		pos="11884,3078.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_attn_gpu10 -> layer1_out_proj_gpu10	[pos="e,11884,3099.5 11884,3135.2 11884,3127.4 11884,3118.2 11884,3109.6"];
	layer1_out_proj_gpu10 -> layer1_attn_agg	[pos="e,11102,2990.8 11766,3059.5 11763,3059.2 11760,3058.8 11757,3058.4 11540,3031.1 11291,3007.4 11112,2991.7"];
	layer1_attn_gpu11	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU11\nAttn Layer1\n[Input: [1024,2048,256], Output: [1024,2048,256]]",
		pos="12138,3155.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_qkv_gpu11 -> layer1_attn_gpu11	[pos="e,12138,3176.5 12138,3212.2 12138,3204.4 12138,3195.2 12138,3186.6"];
	layer1_out_proj_gpu11	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU11\nOutProj Layer1\n[Input: [1024,2048,256], Output: [1024,2048,4096]]",
		pos="12138,3078.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer1_attn_gpu11 -> layer1_out_proj_gpu11	[pos="e,12138,3099.5 12138,3135.2 12138,3127.4 12138,3118.2 12138,3109.6"];
	layer1_out_proj_gpu11 -> layer1_attn_agg	[pos="e,11095,2983.6 12020,3059.5 12017,3059.1 12014,3058.8 12011,3058.4 11699,3022.6 11336,2997.9 11105,2984.2"];
	layer1_attn_agg -> layer1_residual1	[pos="e,11408,2872.5 11046,2937.5 11154,2918.2 11291,2893.6 11398,2874.3"];
	layer1_post_attn_norm	[fillcolor="#FDE8E8",
		height=0.56944,
		label="Layer 1\nPost-Attn LayerNorm\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="11157,2743.9",
		shape=rectangle,
		style=filled,
		width=3.3611];
	layer1_residual1 -> layer1_post_attn_norm	[pos="e,11243,2764.4 11400,2800.4 11350,2788.8 11296,2776.7 11252,2766.7"];
	layer1_residual2	[fillcolor="#FFF4E8",
		height=1.1389,
		label="Layer 1\nResidual Add\n[Input: 2Ã—[1024,2048,4096], Output: [1024,2048,4096]]",
		pos="11577,2311.4",
		shape=parallelogram,
		style="filled,rounded",
		width=7.2861];
	layer1_residual1 -> layer1_residual2	[pos="e,11794,2352.5 11764,2825.4 11875,2805 11996,2757.5 11996,2647.4 11996,2647.4 11996,2647.4 11996,2547.9 11996,2447 11902,2388.9 \
11804,2355.6"];
	layer1_gate_gpu12	[fillcolor="#FDE8E8",
		height=1.1389,
		label="GPU12\nGating Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,16]]",
		pos="10089,2646.4",
		shape=parallelogram,
		style=filled,
		width=6.6525];
	layer1_post_attn_norm -> layer1_gate_gpu12	[color=blue,
		pos="e,10327,2685.6 11036,2738 10876,2730.8 10588,2715.1 10342,2687.4 10340,2687.2 10338,2687 10337,2686.8",
		style=dashed];
	layer1_experts_gpu12	[fillcolor="#FDE8E8",
		height=0.56944,
		label="GPU12\nExperts 0-3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="10356,2548.9",
		shape=rectangle,
		style=filled,
		width=3.3611];
	layer1_post_attn_norm -> layer1_experts_gpu12	[pos="e,10352,2569.7 11036,2742.6 10828,2740.7 10422,2731.5 10375,2687.4 10346,2660.4 10346,2611.3 10350,2579.7"];
	layer1_gate_gpu13	[fillcolor="#FDE8E8",
		height=1.1389,
		label="GPU13\nGating Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,16]]",
		pos="10623,2646.4",
		shape=parallelogram,
		style=filled,
		width=6.6525];
	layer1_post_attn_norm -> layer1_gate_gpu13	[color=blue,
		pos="e,10847,2687.5 11048,2723.4 10993,2713.5 10923,2701.1 10857,2689.3",
		style=dashed];
	layer1_experts_gpu13	[fillcolor="#FDE8E8",
		height=0.56944,
		label="GPU13\nExperts 4-7\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="10890,2548.9",
		shape=rectangle,
		style=filled,
		width=3.3611];
	layer1_post_attn_norm -> layer1_experts_gpu13	[pos="e,10886,2569.7 11036,2729 10982,2720.2 10927,2706.8 10909,2687.4 10882,2658.6 10882,2610.8 10885,2579.8"];
	layer1_gate_gpu14	[fillcolor="#FDE8E8",
		height=1.1389,
		label="GPU14\nGating Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,16]]",
		pos="11157,2646.4",
		shape=parallelogram,
		style=filled,
		width=6.6525];
	layer1_post_attn_norm -> layer1_gate_gpu14	[color=blue,
		pos="e,11157,2687.7 11157,2723.1 11157,2715.7 11157,2706.8 11157,2697.8",
		style=dashed];
	layer1_experts_gpu14	[fillcolor="#FDE8E8",
		height=0.56944,
		label="GPU14\nExperts 8-11\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="11291,2548.9",
		shape=rectangle,
		style=filled,
		width=3.3611];
	layer1_post_attn_norm -> layer1_experts_gpu14	[pos="e,11361,2569.5 11278,2730.1 11333,2721.6 11388,2708.1 11405,2687.4 11428,2659 11424,2636.3 11405,2605.4 11397,2592.2 11384,2582 \
11371,2574.2"];
	layer1_gate_gpu15	[fillcolor="#FDE8E8",
		height=1.1389,
		label="GPU15\nGating Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,16]]",
		pos="11691,2646.4",
		shape=parallelogram,
		style=filled,
		width=6.6525];
	layer1_post_attn_norm -> layer1_gate_gpu15	[color=blue,
		pos="e,11535,2675.3 11266,2723.4 11341,2710.1 11441,2692.2 11525,2677.1",
		style=dashed];
	layer1_experts_gpu15	[fillcolor="#FDE8E8",
		height=0.56944,
		label="GPU15\nExperts 12-15\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="11691,2548.9",
		shape=rectangle,
		style=filled,
		width=3.3611];
	layer1_post_attn_norm -> layer1_experts_gpu15	[pos="e,11812,2562.7 11278,2743.2 11487,2742.4 11895,2734.7 11939,2687.4 11964,2660.8 11962,2633.9 11939,2605.4 11923,2586 11873,2572.9 \
11822,2564.3"];
	layer1_gate_gpu12 -> layer1_experts_gpu12	[color=red,
		pos="e,10301,2569.5 10201,2605.3 10232,2594.3 10264,2582.7 10292,2573",
		style=dashed];
	layer1_moe_agg	[fillcolor="#FFF4E8",
		height=1.4444,
		label="Layer 1\nMoE\nAggregation\n[Input: 4Ã—[1024,2048,4096], Output: [1024,2048,4096]]",
		pos="11291,2440.4",
		shape=parallelogram,
		style="filled,rounded",
		width=7.2861];
	layer1_experts_gpu12 -> layer1_moe_agg	[pos="e,11105,2462.6 10477,2534.1 10634,2516.3 10908,2485 11095,2463.8"];
	layer1_gate_gpu13 -> layer1_experts_gpu13	[color=red,
		pos="e,10835,2569.5 10735,2605.3 10766,2594.3 10798,2582.7 10826,2573",
		style=dashed];
	layer1_experts_gpu13 -> layer1_moe_agg	[pos="e,11128,2484.7 10964,2528.4 11007,2516.8 11064,2501.7 11118,2487.3"];
	layer1_gate_gpu14 -> layer1_experts_gpu14	[color=red,
		pos="e,11263,2569.5 11213,2605.2 11228,2595.2 11242,2584.7 11255,2575.6",
		style=dashed];
	layer1_experts_gpu14 -> layer1_moe_agg	[pos="e,11291,2492.8 11291,2528.4 11291,2521 11291,2512.1 11291,2502.9"];
	layer1_gate_gpu15 -> layer1_experts_gpu15	[color=red,
		pos="e,11691,2569.5 11691,2605.2 11691,2596.6 11691,2587.7 11691,2579.6",
		style=dashed];
	layer1_experts_gpu15 -> layer1_moe_agg	[pos="e,11483,2492.4 11618,2528.4 11582,2518.9 11537,2507 11492,2495.1"];
	layer1_moe_agg -> layer1_residual2	[pos="e,11487,2352.5 11406,2388.3 11430,2377.8 11454,2366.9 11477,2356.7"];
	layer2_pre_attn_norm	[fillcolor="#E8F4FD",
		height=0.56944,
		label="Layer 2\nLayerNorm\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="10869,2213.9",
		shape=rectangle,
		style=filled,
		width=3.3611];
	layer1_residual2 -> layer2_pre_attn_norm	[pos="e,10990,2231.3 11322,2276 11213,2261.3 11090,2244.8 11000,2232.6"];
	layer2_residual1	[fillcolor="#FFF4E8",
		height=1.1389,
		label="Layer 2\nResidual Add\n[Input: 2Ã—[1024,2048,4096], Output: [1024,2048,4096]]",
		pos="11577,1745.4",
		shape=parallelogram,
		style="filled,rounded",
		width=7.2861];
	layer1_residual2 -> layer2_residual1	[pos="e,11835,1783.1 11772,2300.9 11981,2285.1 12285,2244 12285,2137.9 12285,2137.9 12285,2137.9 12285,1981.9 12285,1885.5 12045,1821.5 \
11845,1784.9"];
	layer2_qkv_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nQKV Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="9345,2136.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_pre_attn_norm -> layer2_qkv_gpu0	[pos="e,9463.2,2156.5 10748,2212.7 10507,2211.2 9950.2,2202.8 9473.4,2157.5"];
	layer2_qkv_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nQKV Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="9599,2136.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_pre_attn_norm -> layer2_qkv_gpu1	[pos="e,9717.3,2156.5 10748,2211.2 10541,2207.3 10105,2195 9727.3,2157.5"];
	layer2_qkv_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nQKV Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="9853,2136.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_pre_attn_norm -> layer2_qkv_gpu2	[pos="e,9971.3,2156.4 10748,2208.8 10579,2202.3 10261,2187.3 9981.2,2157.5"];
	layer2_qkv_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nQKV Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="10107,2136.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_pre_attn_norm -> layer2_qkv_gpu3	[pos="e,10225,2156.3 10748,2204.7 10622,2195.6 10420,2179.5 10235,2157.6"];
	layer2_qkv_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nQKV Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="10361,2136.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_pre_attn_norm -> layer2_qkv_gpu4	[pos="e,10479,2156.1 10748,2195.5 10676,2185.1 10582,2171.4 10489,2157.6"];
	layer2_qkv_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nQKV Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="10615,2136.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_pre_attn_norm -> layer2_qkv_gpu5	[pos="e,10681,2157.5 10803,2193.4 10769,2183.3 10727,2170.9 10691,2160.4"];
	layer2_qkv_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nQKV Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="10869,2136.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_pre_attn_norm -> layer2_qkv_gpu6	[pos="e,10869,2157.5 10869,2193.2 10869,2185.4 10869,2176.2 10869,2167.6"];
	layer2_qkv_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nQKV Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="11123,2136.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_pre_attn_norm -> layer2_qkv_gpu7	[pos="e,11057,2157.5 10935,2193.4 10969,2183.3 11011,2170.9 11047,2160.4"];
	layer2_qkv_gpu8	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU8\nQKV Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,256]]",
		pos="11377,2136.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_pre_attn_norm -> layer2_qkv_gpu8	[pos="e,11259,2156.1 10990,2195.5 11062,2185.1 11156,2171.4 11249,2157.6"];
	layer2_qkv_gpu9	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU9\nQKV Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,256]]",
		pos="11631,2136.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_pre_attn_norm -> layer2_qkv_gpu9	[pos="e,11513,2156.3 10990,2204.7 11116,2195.6 11318,2179.5 11503,2157.6"];
	layer2_qkv_gpu10	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU10\nQKV Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,256]]",
		pos="11885,2136.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_pre_attn_norm -> layer2_qkv_gpu10	[pos="e,11767,2156.4 10990,2208.8 11159,2202.3 11477,2187.3 11757,2157.5"];
	layer2_qkv_gpu11	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU11\nQKV Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,256]]",
		pos="12139,2136.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_pre_attn_norm -> layer2_qkv_gpu11	[pos="e,12021,2156.5 10990,2211.2 11197,2207.3 11633,2195 12011,2157.5"];
	layer2_attn_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nAttn Layer2\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="9345,2059.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_qkv_gpu0 -> layer2_attn_gpu0	[pos="e,9345,2080.5 9345,2116.2 9345,2108.4 9345,2099.2 9345,2090.6"];
	layer2_out_proj_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nOutProj Layer2\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="9345,1982.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_attn_gpu0 -> layer2_out_proj_gpu0	[pos="e,9345,2003.5 9345,2039.2 9345,2031.4 9345,2022.2 9345,2013.6"];
	layer2_attn_agg	[fillcolor="#FFF4E8",
		height=1.4444,
		label="Layer 2\nAttention\nAggregation\n[Input: 12Ã—[1024,2048,4096], Output: [1024,2048,4096]]",
		pos="10869,1874.4",
		shape=parallelogram,
		style="filled,rounded",
		width=7.4301];
	layer2_out_proj_gpu0 -> layer2_attn_agg	[pos="e,10665,1882.4 9463.3,1963.4 9466.2,1963.1 9469.1,1962.7 9472,1962.4 9889.5,1917.5 10380,1893.6 10655,1882.8"];
	layer2_attn_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nAttn Layer2\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="9599,2059.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_qkv_gpu1 -> layer2_attn_gpu1	[pos="e,9599,2080.5 9599,2116.2 9599,2108.4 9599,2099.2 9599,2090.6"];
	layer2_out_proj_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nOutProj Layer2\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="9599,1982.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_attn_gpu1 -> layer2_out_proj_gpu1	[pos="e,9599,2003.5 9599,2039.2 9599,2031.4 9599,2022.2 9599,2013.6"];
	layer2_out_proj_gpu1 -> layer2_attn_agg	[pos="e,10668,1886.1 9717.3,1963.5 9720.2,1963.1 9723.1,1962.8 9726,1962.4 10050,1925.2 10428,1900 10658,1886.6"];
	layer2_attn_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nAttn Layer2\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="9853,2059.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_qkv_gpu2 -> layer2_attn_gpu2	[pos="e,9853,2080.5 9853,2116.2 9853,2108.4 9853,2099.2 9853,2090.6"];
	layer2_out_proj_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nOutProj Layer2\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="9853,1982.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_attn_gpu2 -> layer2_out_proj_gpu2	[pos="e,9853,2003.5 9853,2039.2 9853,2031.4 9853,2022.2 9853,2013.6"];
	layer2_out_proj_gpu2 -> layer2_attn_agg	[pos="e,10674,1891.4 9971.3,1963.5 9974.2,1963.2 9977.1,1962.8 9980,1962.4 10214,1933 10483,1907.9 10664,1892.3"];
	layer2_attn_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nAttn Layer2\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="10107,2059.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_qkv_gpu3 -> layer2_attn_gpu3	[pos="e,10107,2080.5 10107,2116.2 10107,2108.4 10107,2099.2 10107,2090.6"];
	layer2_out_proj_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nOutProj Layer2\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="10107,1982.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_attn_gpu3 -> layer2_out_proj_gpu3	[pos="e,10107,2003.5 10107,2039.2 10107,2031.4 10107,2022.2 10107,2013.6"];
	layer2_out_proj_gpu3 -> layer2_attn_agg	[pos="e,10683,1900.1 10225,1963.7 10228,1963.3 10231,1962.8 10234,1962.4 10381,1941.1 10547,1918.3 10673,1901.5"];
	layer2_attn_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nAttn Layer2\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="10361,2059.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_qkv_gpu4 -> layer2_attn_gpu4	[pos="e,10361,2080.5 10361,2116.2 10361,2108.4 10361,2099.2 10361,2090.6"];
	layer2_out_proj_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nOutProj Layer2\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="10361,1982.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_attn_gpu4 -> layer2_out_proj_gpu4	[pos="e,10361,2003.5 10361,2039.2 10361,2031.4 10361,2022.2 10361,2013.6"];
	layer2_out_proj_gpu4 -> layer2_attn_agg	[pos="e,10695,1911.8 10454,1962.4 10519,1948.8 10607,1930.4 10685,1913.9"];
	layer2_attn_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nAttn Layer2\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="10615,2059.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_qkv_gpu5 -> layer2_attn_gpu5	[pos="e,10615,2080.5 10615,2116.2 10615,2108.4 10615,2099.2 10615,2090.6"];
	layer2_out_proj_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nOutProj Layer2\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="10615,1982.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_attn_gpu5 -> layer2_out_proj_gpu5	[pos="e,10615,2003.5 10615,2039.2 10615,2031.4 10615,2022.2 10615,2013.6"];
	layer2_out_proj_gpu5 -> layer2_attn_agg	[pos="e,10747,1926.4 10662,1962.4 10683,1953.2 10711,1941.8 10738,1930.3"];
	layer2_attn_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nAttn Layer2\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="10869,2059.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_qkv_gpu6 -> layer2_attn_gpu6	[pos="e,10869,2080.5 10869,2116.2 10869,2108.4 10869,2099.2 10869,2090.6"];
	layer2_out_proj_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nOutProj Layer2\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="10869,1982.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_attn_gpu6 -> layer2_out_proj_gpu6	[pos="e,10869,2003.5 10869,2039.2 10869,2031.4 10869,2022.2 10869,2013.6"];
	layer2_out_proj_gpu6 -> layer2_attn_agg	[pos="e,10869,1926.8 10869,1962.4 10869,1955 10869,1946.1 10869,1936.9"];
	layer2_attn_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nAttn Layer2\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="11123,2059.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_qkv_gpu7 -> layer2_attn_gpu7	[pos="e,11123,2080.5 11123,2116.2 11123,2108.4 11123,2099.2 11123,2090.6"];
	layer2_out_proj_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nOutProj Layer2\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="11123,1982.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_attn_gpu7 -> layer2_out_proj_gpu7	[pos="e,11123,2003.5 11123,2039.2 11123,2031.4 11123,2022.2 11123,2013.6"];
	layer2_out_proj_gpu7 -> layer2_attn_agg	[pos="e,10991,1926.4 11076,1962.4 11055,1953.2 11027,1941.8 11000,1930.3"];
	layer2_attn_gpu8	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU8\nAttn Layer2\n[Input: [1024,2048,256], Output: [1024,2048,256]]",
		pos="11377,2059.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_qkv_gpu8 -> layer2_attn_gpu8	[pos="e,11377,2080.5 11377,2116.2 11377,2108.4 11377,2099.2 11377,2090.6"];
	layer2_out_proj_gpu8	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU8\nOutProj Layer2\n[Input: [1024,2048,256], Output: [1024,2048,4096]]",
		pos="11377,1982.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_attn_gpu8 -> layer2_out_proj_gpu8	[pos="e,11377,2003.5 11377,2039.2 11377,2031.4 11377,2022.2 11377,2013.6"];
	layer2_out_proj_gpu8 -> layer2_attn_agg	[pos="e,11112,1926.4 11284,1962.4 11238,1952.8 11180,1940.7 11122,1928.5"];
	layer2_attn_gpu9	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU9\nAttn Layer2\n[Input: [1024,2048,256], Output: [1024,2048,256]]",
		pos="11631,2059.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_qkv_gpu9 -> layer2_attn_gpu9	[pos="e,11631,2080.5 11631,2116.2 11631,2108.4 11631,2099.2 11631,2090.6"];
	layer2_out_proj_gpu9	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU9\nOutProj Layer2\n[Input: [1024,2048,256], Output: [1024,2048,4096]]",
		pos="11631,1982.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_attn_gpu9 -> layer2_out_proj_gpu9	[pos="e,11631,2003.5 11631,2039.2 11631,2031.4 11631,2022.2 11631,2013.6"];
	layer2_out_proj_gpu9 -> layer2_attn_agg	[pos="e,11118,1908.6 11513,1963.7 11510,1963.3 11507,1962.8 11504,1962.4 11380,1944.5 11243,1925.5 11128,1909.9"];
	layer2_attn_gpu10	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU10\nAttn Layer2\n[Input: [1024,2048,256], Output: [1024,2048,256]]",
		pos="11885,2059.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_qkv_gpu10 -> layer2_attn_gpu10	[pos="e,11885,2080.5 11885,2116.2 11885,2108.4 11885,2099.2 11885,2090.6"];
	layer2_out_proj_gpu10	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU10\nOutProj Layer2\n[Input: [1024,2048,256], Output: [1024,2048,4096]]",
		pos="11885,1982.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_attn_gpu10 -> layer2_out_proj_gpu10	[pos="e,11885,2003.5 11885,2039.2 11885,2031.4 11885,2022.2 11885,2013.6"];
	layer2_out_proj_gpu10 -> layer2_attn_agg	[pos="e,11103,1894.8 11767,1963.5 11764,1963.2 11761,1962.8 11758,1962.4 11541,1935.1 11292,1911.4 11113,1895.7"];
	layer2_attn_gpu11	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU11\nAttn Layer2\n[Input: [1024,2048,256], Output: [1024,2048,256]]",
		pos="12139,2059.9",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_qkv_gpu11 -> layer2_attn_gpu11	[pos="e,12139,2080.5 12139,2116.2 12139,2108.4 12139,2099.2 12139,2090.6"];
	layer2_out_proj_gpu11	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU11\nOutProj Layer2\n[Input: [1024,2048,256], Output: [1024,2048,4096]]",
		pos="12139,1982.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer2_attn_gpu11 -> layer2_out_proj_gpu11	[pos="e,12139,2003.5 12139,2039.2 12139,2031.4 12139,2022.2 12139,2013.6"];
	layer2_out_proj_gpu11 -> layer2_attn_agg	[pos="e,11096,1887.6 12021,1963.5 12018,1963.1 12015,1962.8 12012,1962.4 11700,1926.6 11337,1901.9 11106,1888.2"];
	layer2_attn_agg -> layer2_residual1	[pos="e,11409,1776.5 11047,1841.5 11155,1822.2 11292,1797.6 11399,1778.3"];
	layer2_post_attn_norm	[fillcolor="#FDE8E8",
		height=0.56944,
		label="Layer 2\nPost-Attn LayerNorm\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="11158,1647.9",
		shape=rectangle,
		style=filled,
		width=3.3611];
	layer2_residual1 -> layer2_post_attn_norm	[pos="e,11244,1668.4 11401,1704.4 11351,1692.8 11297,1680.7 11253,1670.7"];
	layer2_residual2	[fillcolor="#FFF4E8",
		height=1.1389,
		label="Layer 2\nResidual Add\n[Input: 2Ã—[1024,2048,4096], Output: [1024,2048,4096]]",
		pos="11578,1215.4",
		shape=parallelogram,
		style="filled,rounded",
		width=7.2861];
	layer2_residual1 -> layer2_residual2	[pos="e,11795,1256.5 11765,1729.4 11876,1709 11997,1661.5 11997,1551.4 11997,1551.4 11997,1551.4 11997,1451.9 11997,1351 11903,1292.9 \
11805,1259.6"];
	layer2_gate_gpu12	[fillcolor="#FDE8E8",
		height=1.1389,
		label="GPU12\nGating Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,16]]",
		pos="10090,1550.4",
		shape=parallelogram,
		style=filled,
		width=6.6525];
	layer2_post_attn_norm -> layer2_gate_gpu12	[color=blue,
		pos="e,10328,1589.6 11037,1642 10877,1634.8 10589,1619.1 10343,1591.4 10341,1591.2 10339,1591 10338,1590.8",
		style=dashed];
	layer2_experts_gpu12	[fillcolor="#FDE8E8",
		height=0.56944,
		label="GPU12\nExperts 0-3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="10357,1452.9",
		shape=rectangle,
		style=filled,
		width=3.3611];
	layer2_post_attn_norm -> layer2_experts_gpu12	[pos="e,10353,1473.7 11037,1646.6 10829,1644.7 10423,1635.5 10376,1591.4 10347,1564.4 10347,1515.3 10351,1483.7"];
	layer2_gate_gpu13	[fillcolor="#FDE8E8",
		height=1.1389,
		label="GPU13\nGating Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,16]]",
		pos="10624,1550.4",
		shape=parallelogram,
		style=filled,
		width=6.6525];
	layer2_post_attn_norm -> layer2_gate_gpu13	[color=blue,
		pos="e,10848,1591.5 11049,1627.4 10994,1617.5 10924,1605.1 10858,1593.3",
		style=dashed];
	layer2_experts_gpu13	[fillcolor="#FDE8E8",
		height=0.56944,
		label="GPU13\nExperts 4-7\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="10891,1452.9",
		shape=rectangle,
		style=filled,
		width=3.3611];
	layer2_post_attn_norm -> layer2_experts_gpu13	[pos="e,10887,1473.7 11037,1633 10983,1624.2 10928,1610.8 10910,1591.4 10883,1562.6 10883,1514.8 10886,1483.8"];
	layer2_gate_gpu14	[fillcolor="#FDE8E8",
		height=1.1389,
		label="GPU14\nGating Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,16]]",
		pos="11158,1550.4",
		shape=parallelogram,
		style=filled,
		width=6.6525];
	layer2_post_attn_norm -> layer2_gate_gpu14	[color=blue,
		pos="e,11158,1591.7 11158,1627.1 11158,1619.7 11158,1610.8 11158,1601.8",
		style=dashed];
	layer2_experts_gpu14	[fillcolor="#FDE8E8",
		height=0.56944,
		label="GPU14\nExperts 8-11\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="11292,1452.9",
		shape=rectangle,
		style=filled,
		width=3.3611];
	layer2_post_attn_norm -> layer2_experts_gpu14	[pos="e,11362,1473.5 11279,1634.1 11334,1625.6 11389,1612.1 11406,1591.4 11429,1563 11425,1540.3 11406,1509.4 11398,1496.2 11385,1486 \
11372,1478.2"];
	layer2_gate_gpu15	[fillcolor="#FDE8E8",
		height=1.1389,
		label="GPU15\nGating Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,16]]",
		pos="11692,1550.4",
		shape=parallelogram,
		style=filled,
		width=6.6525];
	layer2_post_attn_norm -> layer2_gate_gpu15	[color=blue,
		pos="e,11536,1579.3 11267,1627.4 11342,1614.1 11442,1596.2 11526,1581.1",
		style=dashed];
	layer2_experts_gpu15	[fillcolor="#FDE8E8",
		height=0.56944,
		label="GPU15\nExperts 12-15\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="11692,1452.9",
		shape=rectangle,
		style=filled,
		width=3.3611];
	layer2_post_attn_norm -> layer2_experts_gpu15	[pos="e,11813,1466.7 11279,1647.2 11488,1646.4 11896,1638.7 11940,1591.4 11965,1564.8 11963,1537.9 11940,1509.4 11924,1490 11874,1476.9 \
11823,1468.3"];
	layer2_gate_gpu12 -> layer2_experts_gpu12	[color=red,
		pos="e,10302,1473.5 10202,1509.3 10233,1498.3 10265,1486.7 10293,1477",
		style=dashed];
	layer2_moe_agg	[fillcolor="#FFF4E8",
		height=1.4444,
		label="Layer 2\nMoE\nAggregation\n[Input: 4Ã—[1024,2048,4096], Output: [1024,2048,4096]]",
		pos="11292,1344.4",
		shape=parallelogram,
		style="filled,rounded",
		width=7.2861];
	layer2_experts_gpu12 -> layer2_moe_agg	[pos="e,11106,1366.6 10478,1438.1 10635,1420.3 10909,1389 11096,1367.8"];
	layer2_gate_gpu13 -> layer2_experts_gpu13	[color=red,
		pos="e,10836,1473.5 10736,1509.3 10767,1498.3 10799,1486.7 10827,1477",
		style=dashed];
	layer2_experts_gpu13 -> layer2_moe_agg	[pos="e,11129,1388.7 10965,1432.4 11008,1420.8 11065,1405.7 11119,1391.3"];
	layer2_gate_gpu14 -> layer2_experts_gpu14	[color=red,
		pos="e,11264,1473.5 11214,1509.2 11229,1499.2 11243,1488.7 11256,1479.6",
		style=dashed];
	layer2_experts_gpu14 -> layer2_moe_agg	[pos="e,11292,1396.8 11292,1432.4 11292,1425 11292,1416.1 11292,1406.9"];
	layer2_gate_gpu15 -> layer2_experts_gpu15	[color=red,
		pos="e,11692,1473.5 11692,1509.2 11692,1500.6 11692,1491.7 11692,1483.6",
		style=dashed];
	layer2_experts_gpu15 -> layer2_moe_agg	[pos="e,11484,1396.4 11619,1432.4 11583,1422.9 11538,1411 11493,1399.1"];
	layer2_moe_agg -> layer2_residual2	[pos="e,11488,1256.5 11407,1292.3 11431,1281.8 11455,1270.9 11478,1260.7"];
	layer3_pre_attn_norm	[fillcolor="#E8F4FD",
		height=0.56944,
		label="Layer 3\nLayerNorm\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="10870,1117.9",
		shape=rectangle,
		style=filled,
		width=3.3611];
	layer2_residual2 -> layer3_pre_attn_norm	[pos="e,10991,1135.3 11323,1180 11214,1165.3 11091,1148.8 11001,1136.6"];
	layer3_residual1	[fillcolor="#FFF4E8",
		height=1.1389,
		label="Layer 3\nResidual Add\n[Input: 2Ã—[1024,2048,4096], Output: [1024,2048,4096]]",
		pos="11578,649.43",
		shape=parallelogram,
		style="filled,rounded",
		width=7.2861];
	layer2_residual2 -> layer3_residual1	[pos="e,11836,687.11 11773,1204.9 11982,1189.1 12286,1148 12286,1041.9 12286,1041.9 12286,1041.9 12286,885.93 12286,789.47 12046,725.54 \
11846,688.94"];
	layer3_qkv_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nQKV Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="9346,1040.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_pre_attn_norm -> layer3_qkv_gpu0	[pos="e,9464.2,1060.5 10749,1116.7 10508,1115.2 9951.2,1106.8 9474.4,1061.5"];
	layer3_qkv_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nQKV Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="9600,1040.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_pre_attn_norm -> layer3_qkv_gpu1	[pos="e,9718.3,1060.5 10749,1115.2 10542,1111.3 10106,1099 9728.3,1061.5"];
	layer3_qkv_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nQKV Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="9854,1040.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_pre_attn_norm -> layer3_qkv_gpu2	[pos="e,9972.3,1060.4 10749,1112.8 10580,1106.3 10262,1091.3 9982.2,1061.5"];
	layer3_qkv_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nQKV Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="10108,1040.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_pre_attn_norm -> layer3_qkv_gpu3	[pos="e,10226,1060.3 10749,1108.7 10623,1099.6 10421,1083.5 10236,1061.6"];
	layer3_qkv_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nQKV Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="10362,1040.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_pre_attn_norm -> layer3_qkv_gpu4	[pos="e,10480,1060.1 10749,1099.5 10677,1089.1 10583,1075.4 10490,1061.6"];
	layer3_qkv_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nQKV Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="10616,1040.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_pre_attn_norm -> layer3_qkv_gpu5	[pos="e,10682,1061.5 10804,1097.4 10770,1087.3 10728,1074.9 10692,1064.4"];
	layer3_qkv_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nQKV Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="10870,1040.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_pre_attn_norm -> layer3_qkv_gpu6	[pos="e,10870,1061.5 10870,1097.2 10870,1089.4 10870,1080.2 10870,1071.6"];
	layer3_qkv_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nQKV Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,384]]",
		pos="11124,1040.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_pre_attn_norm -> layer3_qkv_gpu7	[pos="e,11058,1061.5 10936,1097.4 10970,1087.3 11012,1074.9 11048,1064.4"];
	layer3_qkv_gpu8	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU8\nQKV Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,256]]",
		pos="11378,1040.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_pre_attn_norm -> layer3_qkv_gpu8	[pos="e,11260,1060.1 10991,1099.5 11063,1089.1 11157,1075.4 11250,1061.6"];
	layer3_qkv_gpu9	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU9\nQKV Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,256]]",
		pos="11632,1040.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_pre_attn_norm -> layer3_qkv_gpu9	[pos="e,11514,1060.3 10991,1108.7 11117,1099.6 11319,1083.5 11504,1061.6"];
	layer3_qkv_gpu10	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU10\nQKV Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,256]]",
		pos="11886,1040.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_pre_attn_norm -> layer3_qkv_gpu10	[pos="e,11768,1060.4 10991,1112.8 11160,1106.3 11478,1091.3 11758,1061.5"];
	layer3_qkv_gpu11	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU11\nQKV Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,256]]",
		pos="12140,1040.9",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_pre_attn_norm -> layer3_qkv_gpu11	[pos="e,12022,1060.5 10991,1115.2 11198,1111.3 11634,1099 12012,1061.5"];
	layer3_attn_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nAttn Layer3\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="9346,963.93",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_qkv_gpu0 -> layer3_attn_gpu0	[pos="e,9346,984.5 9346,1020.2 9346,1012.4 9346,1003.2 9346,994.59"];
	layer3_out_proj_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nOutProj Layer3\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="9346,886.93",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_attn_gpu0 -> layer3_out_proj_gpu0	[pos="e,9346,907.5 9346,943.22 9346,935.38 9346,926.2 9346,917.59"];
	layer3_attn_agg	[fillcolor="#FFF4E8",
		height=1.4444,
		label="Layer 3\nAttention\nAggregation\n[Input: 12Ã—[1024,2048,4096], Output: [1024,2048,4096]]",
		pos="10870,778.43",
		shape=parallelogram,
		style="filled,rounded",
		width=7.4301];
	layer3_out_proj_gpu0 -> layer3_attn_agg	[pos="e,10666,786.38 9464.3,867.41 9467.2,867.07 9470.1,866.74 9473,866.43 9890.5,821.47 10381,797.56 10656,786.77"];
	layer3_attn_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nAttn Layer3\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="9600,963.93",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_qkv_gpu1 -> layer3_attn_gpu1	[pos="e,9600,984.5 9600,1020.2 9600,1012.4 9600,1003.2 9600,994.59"];
	layer3_out_proj_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nOutProj Layer3\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="9600,886.93",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_attn_gpu1 -> layer3_out_proj_gpu1	[pos="e,9600,907.5 9600,943.22 9600,935.38 9600,926.2 9600,917.59"];
	layer3_out_proj_gpu1 -> layer3_attn_agg	[pos="e,10669,790.05 9718.3,867.47 9721.2,867.1 9724.1,866.76 9727,866.43 10051,829.23 10429,803.98 10659,790.64"];
	layer3_attn_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nAttn Layer3\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="9854,963.93",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_qkv_gpu2 -> layer3_attn_gpu2	[pos="e,9854,984.5 9854,1020.2 9854,1012.4 9854,1003.2 9854,994.59"];
	layer3_out_proj_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nOutProj Layer3\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="9854,886.93",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_attn_gpu2 -> layer3_out_proj_gpu2	[pos="e,9854,907.5 9854,943.22 9854,935.38 9854,926.2 9854,917.59"];
	layer3_out_proj_gpu2 -> layer3_attn_agg	[pos="e,10675,795.42 9972.3,867.55 9975.2,867.16 9978.1,866.79 9981,866.43 10215,837.05 10484,811.89 10665,796.29"];
	layer3_attn_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nAttn Layer3\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="10108,963.93",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_qkv_gpu3 -> layer3_attn_gpu3	[pos="e,10108,984.5 10108,1020.2 10108,1012.4 10108,1003.2 10108,994.59"];
	layer3_out_proj_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nOutProj Layer3\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="10108,886.93",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_attn_gpu3 -> layer3_out_proj_gpu3	[pos="e,10108,907.5 10108,943.22 10108,935.38 10108,926.2 10108,917.59"];
	layer3_out_proj_gpu3 -> layer3_attn_agg	[pos="e,10684,804.09 10226,867.7 10229,867.27 10232,866.84 10235,866.43 10382,845.07 10548,822.33 10674,805.45"];
	layer3_attn_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nAttn Layer3\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="10362,963.93",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_qkv_gpu4 -> layer3_attn_gpu4	[pos="e,10362,984.5 10362,1020.2 10362,1012.4 10362,1003.2 10362,994.59"];
	layer3_out_proj_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nOutProj Layer3\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="10362,886.93",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_attn_gpu4 -> layer3_out_proj_gpu4	[pos="e,10362,907.5 10362,943.22 10362,935.38 10362,926.2 10362,917.59"];
	layer3_out_proj_gpu4 -> layer3_attn_agg	[pos="e,10696,815.8 10455,866.39 10520,852.85 10608,834.35 10686,817.9"];
	layer3_attn_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nAttn Layer3\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="10616,963.93",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_qkv_gpu5 -> layer3_attn_gpu5	[pos="e,10616,984.5 10616,1020.2 10616,1012.4 10616,1003.2 10616,994.59"];
	layer3_out_proj_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nOutProj Layer3\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="10616,886.93",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_attn_gpu5 -> layer3_out_proj_gpu5	[pos="e,10616,907.5 10616,943.22 10616,935.38 10616,926.2 10616,917.59"];
	layer3_out_proj_gpu5 -> layer3_attn_agg	[pos="e,10748,830.45 10663,866.39 10684,857.25 10712,845.85 10739,834.35"];
	layer3_attn_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nAttn Layer3\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="10870,963.93",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_qkv_gpu6 -> layer3_attn_gpu6	[pos="e,10870,984.5 10870,1020.2 10870,1012.4 10870,1003.2 10870,994.59"];
	layer3_out_proj_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nOutProj Layer3\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="10870,886.93",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_attn_gpu6 -> layer3_out_proj_gpu6	[pos="e,10870,907.5 10870,943.22 10870,935.38 10870,926.2 10870,917.59"];
	layer3_out_proj_gpu6 -> layer3_attn_agg	[pos="e,10870,830.79 10870,866.39 10870,858.98 10870,850.1 10870,840.87"];
	layer3_attn_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nAttn Layer3\n[Input: [1024,2048,384], Output: [1024,2048,384]]",
		pos="11124,963.93",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_qkv_gpu7 -> layer3_attn_gpu7	[pos="e,11124,984.5 11124,1020.2 11124,1012.4 11124,1003.2 11124,994.59"];
	layer3_out_proj_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nOutProj Layer3\n[Input: [1024,2048,384], Output: [1024,2048,4096]]",
		pos="11124,886.93",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_attn_gpu7 -> layer3_out_proj_gpu7	[pos="e,11124,907.5 11124,943.22 11124,935.38 11124,926.2 11124,917.59"];
	layer3_out_proj_gpu7 -> layer3_attn_agg	[pos="e,10992,830.45 11077,866.39 11056,857.25 11028,845.85 11001,834.35"];
	layer3_attn_gpu8	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU8\nAttn Layer3\n[Input: [1024,2048,256], Output: [1024,2048,256]]",
		pos="11378,963.93",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_qkv_gpu8 -> layer3_attn_gpu8	[pos="e,11378,984.5 11378,1020.2 11378,1012.4 11378,1003.2 11378,994.59"];
	layer3_out_proj_gpu8	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU8\nOutProj Layer3\n[Input: [1024,2048,256], Output: [1024,2048,4096]]",
		pos="11378,886.93",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_attn_gpu8 -> layer3_out_proj_gpu8	[pos="e,11378,907.5 11378,943.22 11378,935.38 11378,926.2 11378,917.59"];
	layer3_out_proj_gpu8 -> layer3_attn_agg	[pos="e,11113,830.45 11285,866.39 11239,856.77 11181,844.65 11123,832.55"];
	layer3_attn_gpu9	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU9\nAttn Layer3\n[Input: [1024,2048,256], Output: [1024,2048,256]]",
		pos="11632,963.93",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_qkv_gpu9 -> layer3_attn_gpu9	[pos="e,11632,984.5 11632,1020.2 11632,1012.4 11632,1003.2 11632,994.59"];
	layer3_out_proj_gpu9	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU9\nOutProj Layer3\n[Input: [1024,2048,256], Output: [1024,2048,4096]]",
		pos="11632,886.93",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_attn_gpu9 -> layer3_out_proj_gpu9	[pos="e,11632,907.5 11632,943.22 11632,935.38 11632,926.2 11632,917.59"];
	layer3_out_proj_gpu9 -> layer3_attn_agg	[pos="e,11119,812.58 11514,867.7 11511,867.27 11508,866.84 11505,866.43 11381,848.47 11244,829.54 11129,813.94"];
	layer3_attn_gpu10	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU10\nAttn Layer3\n[Input: [1024,2048,256], Output: [1024,2048,256]]",
		pos="11886,963.93",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_qkv_gpu10 -> layer3_attn_gpu10	[pos="e,11886,984.5 11886,1020.2 11886,1012.4 11886,1003.2 11886,994.59"];
	layer3_out_proj_gpu10	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU10\nOutProj Layer3\n[Input: [1024,2048,256], Output: [1024,2048,4096]]",
		pos="11886,886.93",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_attn_gpu10 -> layer3_out_proj_gpu10	[pos="e,11886,907.5 11886,943.22 11886,935.38 11886,926.2 11886,917.59"];
	layer3_out_proj_gpu10 -> layer3_attn_agg	[pos="e,11104,798.83 11768,867.55 11765,867.16 11762,866.79 11759,866.43 11542,839.11 11293,815.44 11114,799.71"];
	layer3_attn_gpu11	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU11\nAttn Layer3\n[Input: [1024,2048,256], Output: [1024,2048,256]]",
		pos="12140,963.93",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_qkv_gpu11 -> layer3_attn_gpu11	[pos="e,12140,984.5 12140,1020.2 12140,1012.4 12140,1003.2 12140,994.59"];
	layer3_out_proj_gpu11	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU11\nOutProj Layer3\n[Input: [1024,2048,256], Output: [1024,2048,4096]]",
		pos="12140,886.93",
		shape=rectangle,
		style=filled,
		width=3.2778];
	layer3_attn_gpu11 -> layer3_out_proj_gpu11	[pos="e,12140,907.5 12140,943.22 12140,935.38 12140,926.2 12140,917.59"];
	layer3_out_proj_gpu11 -> layer3_attn_agg	[pos="e,11097,791.56 12022,867.47 12019,867.1 12016,866.76 12013,866.43 11701,830.6 11338,805.85 11107,792.16"];
	layer3_attn_agg -> layer3_residual1	[pos="e,11410,680.54 11048,745.46 11156,726.15 11293,701.63 11400,682.33"];
	layer3_post_attn_norm	[fillcolor="#FDE8E8",
		height=0.56944,
		label="Layer 3\nPost-Attn LayerNorm\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="11159,551.93",
		shape=rectangle,
		style=filled,
		width=3.3611];
	layer3_residual1 -> layer3_post_attn_norm	[pos="e,11245,572.44 11402,608.41 11352,596.85 11298,584.66 11254,574.67"];
	layer3_residual2	[fillcolor="#FFF4E8",
		height=1.1389,
		label="Layer 3\nResidual Add\n[Input: 2Ã—[1024,2048,4096], Output: [1024,2048,4096]]",
		pos="11579,119.43",
		shape=parallelogram,
		style="filled,rounded",
		width=7.2861];
	layer3_residual1 -> layer3_residual2	[pos="e,11796,160.47 11766,633.41 11877,612.99 11998,565.46 11998,455.43 11998,455.43 11998,455.43 11998,355.93 11998,254.98 11904,196.85 \
11806,163.61"];
	layer3_gate_gpu12	[fillcolor="#FDE8E8",
		height=1.1389,
		label="GPU12\nGating Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,16]]",
		pos="10091,454.43",
		shape=parallelogram,
		style=filled,
		width=6.6525];
	layer3_post_attn_norm -> layer3_gate_gpu12	[color=blue,
		pos="e,10329,493.62 11038,546.04 10878,538.84 10590,523.14 10344,495.43 10342,495.23 10340,495.03 10339,494.82",
		style=dashed];
	layer3_experts_gpu12	[fillcolor="#FDE8E8",
		height=0.56944,
		label="GPU12\nExperts 0-3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="10358,356.93",
		shape=rectangle,
		style=filled,
		width=3.3611];
	layer3_post_attn_norm -> layer3_experts_gpu12	[pos="e,10354,377.74 11038,550.56 10830,548.73 10424,539.48 10377,495.43 10348,468.36 10348,419.34 10352,387.74"];
	layer3_gate_gpu13	[fillcolor="#FDE8E8",
		height=1.1389,
		label="GPU13\nGating Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,16]]",
		pos="10625,454.43",
		shape=parallelogram,
		style=filled,
		width=6.6525];
	layer3_post_attn_norm -> layer3_gate_gpu13	[color=blue,
		pos="e,10849,495.45 11050,531.37 10995,521.51 10925,509.15 10859,497.28",
		style=dashed];
	layer3_experts_gpu13	[fillcolor="#FDE8E8",
		height=0.56944,
		label="GPU13\nExperts 4-7\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="10892,356.93",
		shape=rectangle,
		style=filled,
		width=3.3611];
	layer3_post_attn_norm -> layer3_experts_gpu13	[pos="e,10888,377.66 11038,536.96 10984,528.2 10929,514.82 10911,495.43 10884,466.56 10884,418.8 10887,387.85"];
	layer3_gate_gpu14	[fillcolor="#FDE8E8",
		height=1.1389,
		label="GPU14\nGating Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,16]]",
		pos="11159,454.43",
		shape=parallelogram,
		style=filled,
		width=6.6525];
	layer3_post_attn_norm -> layer3_gate_gpu14	[color=blue,
		pos="e,11159,495.67 11159,531.14 11159,523.68 11159,514.81 11159,505.81",
		style=dashed];
	layer3_experts_gpu14	[fillcolor="#FDE8E8",
		height=0.56944,
		label="GPU14\nExperts 8-11\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="11293,356.93",
		shape=rectangle,
		style=filled,
		width=3.3611];
	layer3_post_attn_norm -> layer3_experts_gpu14	[pos="e,11363,377.47 11280,538.13 11335,529.63 11390,516.13 11407,495.43 11430,466.98 11426,444.33 11407,413.43 11399,400.18 11386,390.02 \
11373,382.24"];
	layer3_gate_gpu15	[fillcolor="#FDE8E8",
		height=1.1389,
		label="GPU15\nGating Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,16]]",
		pos="11693,454.43",
		shape=parallelogram,
		style=filled,
		width=6.6525];
	layer3_post_attn_norm -> layer3_gate_gpu15	[color=blue,
		pos="e,11537,483.33 11268,531.37 11343,518.05 11443,500.17 11527,485.11",
		style=dashed];
	layer3_experts_gpu15	[fillcolor="#FDE8E8",
		height=0.56944,
		label="GPU15\nExperts 12-15\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="11693,356.93",
		shape=rectangle,
		style=filled,
		width=3.3611];
	layer3_post_attn_norm -> layer3_experts_gpu15	[pos="e,11814,370.73 11280,551.19 11489,550.37 11897,542.67 11941,495.43 11966,468.76 11964,441.87 11941,413.43 11925,393.98 11875,380.88 \
11824,372.33"];
	layer3_gate_gpu12 -> layer3_experts_gpu12	[color=red,
		pos="e,10303,377.47 10203,413.34 10234,402.29 10266,390.68 10294,380.96",
		style=dashed];
	layer3_moe_agg	[fillcolor="#FFF4E8",
		height=1.4444,
		label="Layer 3\nMoE\nAggregation\n[Input: 4Ã—[1024,2048,4096], Output: [1024,2048,4096]]",
		pos="11293,248.43",
		shape=parallelogram,
		style="filled,rounded",
		width=7.2861];
	layer3_experts_gpu12 -> layer3_moe_agg	[pos="e,11107,270.61 10479,342.11 10636,324.28 10910,293.01 11097,271.77"];
	layer3_gate_gpu13 -> layer3_experts_gpu13	[color=red,
		pos="e,10837,377.47 10737,413.34 10768,402.29 10800,390.68 10828,380.96",
		style=dashed];
	layer3_experts_gpu13 -> layer3_moe_agg	[pos="e,11130,292.68 10966,336.39 11009,324.84 11066,309.68 11120,295.26"];
	layer3_gate_gpu14 -> layer3_experts_gpu14	[color=red,
		pos="e,11265,377.54 11215,413.2 11230,403.18 11244,392.7 11257,383.6",
		style=dashed];
	layer3_experts_gpu14 -> layer3_moe_agg	[pos="e,11293,300.79 11293,336.39 11293,328.98 11293,320.1 11293,310.87"];
	layer3_gate_gpu15 -> layer3_experts_gpu15	[color=red,
		pos="e,11693,377.54 11693,413.2 11693,404.63 11693,395.72 11693,387.62",
		style=dashed];
	layer3_experts_gpu15 -> layer3_moe_agg	[pos="e,11485,300.45 11620,336.39 11584,326.91 11539,315 11494,303.07"];
	layer3_moe_agg -> layer3_residual2	[pos="e,11489,160.5 11408,196.32 11432,185.84 11456,174.89 11479,164.68"];
	output	[fillcolor="#D0E8FF",
		height=0.58926,
		label="Output\n[batch_size=1024, seq_len=2048, hidden_dim=4096]",
		pos="11579,21.213",
		shape=ellipse,
		style=filled,
		width=4.8319];
	layer3_residual2 -> output	[pos="e,11579,42.614 11579,78.181 11579,69.659 11579,60.8 11579,52.711"];
}
