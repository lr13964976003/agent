digraph baseline_tp8_dag {
	graph [bb="0,0,53199,237.43",
		bgcolor=white,
		fontname=Arial,
		fontsize=12,
		rankdir=TB
	];
	node [fontname=Arial,
		fontsize=10,
		label="\N"
	];
	input	[fillcolor="#D0E8FF",
		height=0.58926,
		label="Input\n[batch_size=1024, seq_len=2048, hidden_dim=4096]",
		pos="173.95,196.43",
		shape=ellipse,
		style=filled,
		width=4.8319];
	embeddings	[fillcolor="#E8F4FD",
		height=0.5,
		label="Token+Pos Embedding\n[Input: [1024,2048], Output: [1024,2048,4096]]",
		pos="173.95,98.213",
		shape=rectangle,
		style=filled,
		width=3.0278];
	input -> embeddings	[pos="e,173.95,116.37 173.95,175.02 173.95,160.86 173.95,141.84 173.95,126.39"];
	layer0_norm1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="Layer 0\nLayerNorm\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="173.95,20.5",
		shape=rectangle,
		style=filled,
		width=3.3611];
	embeddings -> layer0_norm1	[pos="e,173.95,41.015 173.95,80.033 173.95,71.51 173.95,60.97 173.95,51.193"];
	layer0_qkv_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nQKV Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="480.95,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_attn_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nAttn Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="729.95,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_output_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nOutput Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="978.95,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_qkv_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nQKV Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="1227.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_attn_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nAttn Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="1476.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_output_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nOutput Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="1725.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_qkv_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nQKV Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="1974.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_attn_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nAttn Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="2223.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_output_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nOutput Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="2472.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_qkv_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nQKV Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="2721.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_attn_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nAttn Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="2970.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_output_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nOutput Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="3219.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_qkv_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nQKV Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="3468.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_attn_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nAttn Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="3717.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_output_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nOutput Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="3966.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_qkv_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nQKV Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="4215.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_attn_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nAttn Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="4464.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_output_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nOutput Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="4713.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_qkv_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nQKV Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="4962.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_attn_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nAttn Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="5211.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_output_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nOutput Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="5460.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_qkv_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nQKV Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="5709.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_attn_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nAttn Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="5958.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_output_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nOutput Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="6207.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_attn_allreduce	[fillcolor="#E8FDE8",
		height=1.1389,
		label="Layer 0\nAttention All-Reduce\n[Input: 8×[1024,2048,512], Output: [1024,2048,4096]]",
		pos="6598.9,196.43",
		shape=parallelogram,
		style="filled,rounded",
		width=7.1421];
	layer0_moe_qkv_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nMoE QKV Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="6989.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_experts_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\n2 Experts Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="7238.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_output_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nMoE Output Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="7487.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_qkv_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nMoE QKV Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="7736.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_experts_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\n2 Experts Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="7985.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_output_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nMoE Output Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="8234.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_qkv_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nMoE QKV Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="8483.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_experts_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\n2 Experts Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="8732.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_output_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nMoE Output Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="8981.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_qkv_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nMoE QKV Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="9230.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_experts_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\n2 Experts Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="9479.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_output_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nMoE Output Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="9728.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_qkv_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nMoE QKV Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="9977.9,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_experts_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\n2 Experts Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="10227,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_output_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nMoE Output Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="10476,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_qkv_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nMoE QKV Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="10725,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_experts_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\n2 Experts Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="10974,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_output_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nMoE Output Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="11223,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_qkv_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nMoE QKV Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="11472,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_experts_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\n2 Experts Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="11721,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_output_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nMoE Output Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="11970,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_qkv_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nMoE QKV Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="12219,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_experts_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\n2 Experts Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="12468,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_output_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nMoE Output Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="12717,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer0_moe_allreduce	[fillcolor="#E8FDE8",
		height=1.1389,
		label="Layer 0\nMoE All-Reduce\n[Input: 8×[1024,2048,512], Output: [1024,2048,4096]]",
		pos="13108,196.43",
		shape=parallelogram,
		style="filled,rounded",
		width=7.1421];
	layer1_norm1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="Layer 1\nLayerNorm\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="13504,196.43",
		shape=rectangle,
		style=filled,
		width=3.3611];
	layer1_qkv_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nQKV Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="13759,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_attn_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nAttn Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="14008,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_output_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nOutput Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="14257,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_qkv_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nQKV Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="14506,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_attn_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nAttn Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="14755,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_output_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nOutput Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="15004,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_qkv_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nQKV Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="15253,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_attn_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nAttn Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="15502,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_output_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nOutput Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="15751,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_qkv_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nQKV Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="16000,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_attn_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nAttn Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="16249,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_output_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nOutput Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="16498,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_qkv_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nQKV Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="16747,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_attn_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nAttn Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="16996,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_output_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nOutput Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="17245,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_qkv_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nQKV Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="17494,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_attn_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nAttn Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="17743,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_output_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nOutput Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="17992,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_qkv_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nQKV Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="18241,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_attn_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nAttn Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="18490,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_output_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nOutput Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="18739,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_qkv_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nQKV Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="18988,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_attn_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nAttn Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="19237,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_output_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nOutput Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="19486,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_attn_allreduce	[fillcolor="#E8FDE8",
		height=1.1389,
		label="Layer 1\nAttention All-Reduce\n[Input: 8×[1024,2048,512], Output: [1024,2048,4096]]",
		pos="19877,196.43",
		shape=parallelogram,
		style="filled,rounded",
		width=7.1421];
	layer1_moe_qkv_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nMoE QKV Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="20268,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_experts_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\n2 Experts Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="20517,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_output_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nMoE Output Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="20766,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_qkv_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nMoE QKV Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="21015,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_experts_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\n2 Experts Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="21264,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_output_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nMoE Output Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="21513,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_qkv_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nMoE QKV Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="21762,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_experts_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\n2 Experts Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="22011,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_output_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nMoE Output Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="22260,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_qkv_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nMoE QKV Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="22509,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_experts_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\n2 Experts Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="22758,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_output_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nMoE Output Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="23007,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_qkv_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nMoE QKV Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="23256,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_experts_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\n2 Experts Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="23505,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_output_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nMoE Output Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="23754,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_qkv_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nMoE QKV Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="24003,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_experts_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\n2 Experts Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="24252,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_output_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nMoE Output Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="24501,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_qkv_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nMoE QKV Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="24750,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_experts_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\n2 Experts Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="24999,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_output_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nMoE Output Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="25248,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_qkv_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nMoE QKV Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="25497,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_experts_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\n2 Experts Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="25746,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_output_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nMoE Output Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="25995,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer1_moe_allreduce	[fillcolor="#E8FDE8",
		height=1.1389,
		label="Layer 1\nMoE All-Reduce\n[Input: 8×[1024,2048,512], Output: [1024,2048,4096]]",
		pos="26386,196.43",
		shape=parallelogram,
		style="filled,rounded",
		width=7.1421];
	layer2_norm1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="Layer 2\nLayerNorm\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="26782,196.43",
		shape=rectangle,
		style=filled,
		width=3.3611];
	layer2_qkv_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nQKV Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="27037,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_attn_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nAttn Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="27286,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_output_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nOutput Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="27535,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_qkv_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nQKV Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="27784,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_attn_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nAttn Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="28033,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_output_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nOutput Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="28282,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_qkv_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nQKV Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="28531,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_attn_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nAttn Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="28780,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_output_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nOutput Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="29029,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_qkv_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nQKV Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="29278,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_attn_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nAttn Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="29527,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_output_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nOutput Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="29776,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_qkv_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nQKV Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="30025,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_attn_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nAttn Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="30274,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_output_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nOutput Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="30523,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_qkv_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nQKV Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="30772,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_attn_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nAttn Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="31021,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_output_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nOutput Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="31270,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_qkv_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nQKV Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="31519,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_attn_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nAttn Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="31768,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_output_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nOutput Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="32017,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_qkv_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nQKV Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="32266,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_attn_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nAttn Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="32515,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_output_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nOutput Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="32764,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_attn_allreduce	[fillcolor="#E8FDE8",
		height=1.1389,
		label="Layer 2\nAttention All-Reduce\n[Input: 8×[1024,2048,512], Output: [1024,2048,4096]]",
		pos="33155,196.43",
		shape=parallelogram,
		style="filled,rounded",
		width=7.1421];
	layer2_moe_qkv_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nMoE QKV Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="33546,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_experts_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\n2 Experts Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="33795,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_output_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nMoE Output Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="34044,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_qkv_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nMoE QKV Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="34293,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_experts_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\n2 Experts Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="34542,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_output_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nMoE Output Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="34791,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_qkv_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nMoE QKV Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="35040,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_experts_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\n2 Experts Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="35289,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_output_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nMoE Output Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="35538,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_qkv_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nMoE QKV Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="35787,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_experts_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\n2 Experts Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="36036,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_output_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nMoE Output Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="36285,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_qkv_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nMoE QKV Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="36534,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_experts_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\n2 Experts Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="36783,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_output_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nMoE Output Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="37032,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_qkv_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nMoE QKV Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="37281,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_experts_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\n2 Experts Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="37530,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_output_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nMoE Output Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="37779,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_qkv_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nMoE QKV Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="38028,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_experts_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\n2 Experts Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="38277,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_output_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nMoE Output Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="38526,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_qkv_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nMoE QKV Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="38775,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_experts_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\n2 Experts Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="39024,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_output_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nMoE Output Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="39273,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer2_moe_allreduce	[fillcolor="#E8FDE8",
		height=1.1389,
		label="Layer 2\nMoE All-Reduce\n[Input: 8×[1024,2048,512], Output: [1024,2048,4096]]",
		pos="39664,196.43",
		shape=parallelogram,
		style="filled,rounded",
		width=7.1421];
	layer3_norm1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="Layer 3\nLayerNorm\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="40060,196.43",
		shape=rectangle,
		style=filled,
		width=3.3611];
	layer3_qkv_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nQKV Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="40315,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_attn_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nAttn Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="40564,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_output_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nOutput Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="40813,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_qkv_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nQKV Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="41062,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_attn_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nAttn Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="41311,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_output_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nOutput Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="41560,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_qkv_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nQKV Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="41809,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_attn_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nAttn Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="42058,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_output_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nOutput Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="42307,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_qkv_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nQKV Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="42556,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_attn_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nAttn Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="42805,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_output_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nOutput Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="43054,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_qkv_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nQKV Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="43303,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_attn_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nAttn Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="43552,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_output_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nOutput Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="43801,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_qkv_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nQKV Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="44050,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_attn_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nAttn Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="44299,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_output_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nOutput Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="44548,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_qkv_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nQKV Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="44797,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_attn_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nAttn Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="45046,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_output_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nOutput Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="45295,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_qkv_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nQKV Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="45544,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_attn_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nAttn Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="45793,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_output_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nOutput Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="46042,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_attn_allreduce	[fillcolor="#E8FDE8",
		height=1.1389,
		label="Layer 3\nAttention All-Reduce\n[Input: 8×[1024,2048,512], Output: [1024,2048,4096]]",
		pos="46433,196.43",
		shape=parallelogram,
		style="filled,rounded",
		width=7.1421];
	layer3_moe_qkv_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nMoE QKV Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="46824,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_experts_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\n2 Experts Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="47073,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_output_gpu0	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU0\nMoE Output Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="47322,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_qkv_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nMoE QKV Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="47571,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_experts_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\n2 Experts Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="47820,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_output_gpu1	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU1\nMoE Output Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="48069,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_qkv_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nMoE QKV Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="48318,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_experts_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\n2 Experts Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="48567,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_output_gpu2	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU2\nMoE Output Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="48816,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_qkv_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nMoE QKV Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="49065,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_experts_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\n2 Experts Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="49314,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_output_gpu3	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU3\nMoE Output Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="49563,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_qkv_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nMoE QKV Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="49812,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_experts_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\n2 Experts Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="50061,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_output_gpu4	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU4\nMoE Output Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="50310,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_qkv_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nMoE QKV Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="50559,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_experts_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\n2 Experts Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="50808,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_output_gpu5	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU5\nMoE Output Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="51057,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_qkv_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nMoE QKV Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="51306,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_experts_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\n2 Experts Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="51555,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_output_gpu6	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU6\nMoE Output Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="51804,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_qkv_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nMoE QKV Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="52053,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_experts_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\n2 Experts Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="52302,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_output_gpu7	[fillcolor="#E8F4FD",
		height=0.56944,
		label="GPU7\nMoE Output Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
		pos="52551,196.43",
		shape=rectangle,
		style=filled,
		width=3.2083];
	layer3_moe_allreduce	[fillcolor="#E8FDE8",
		height=1.1389,
		label="Layer 3\nMoE All-Reduce\n[Input: 8×[1024,2048,512], Output: [1024,2048,4096]]",
		pos="52942,196.43",
		shape=parallelogram,
		style="filled,rounded",
		width=7.1421];
	output	[fillcolor="#D0E8FF",
		height=0.58926,
		label="Output\n[batch_size=1024, seq_len=2048, hidden_dim=4096]",
		pos="52942,98.213",
		shape=ellipse,
		style=filled,
		width=4.8319];
	layer3_moe_allreduce -> output	[pos="e,52942,119.61 52942,155.18 52942,146.66 52942,137.8 52942,129.71"];
}
