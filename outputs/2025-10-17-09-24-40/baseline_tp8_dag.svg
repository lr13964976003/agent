<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_tp8_dag Pages: 1 -->
<svg width="53207pt" height="245pt"
 viewBox="0.00 0.00 53207.06 245.43" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 241.43)">
<title>baseline_tp8_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-241.43 53203.06,-241.43 53203.06,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="#d0e8ff" stroke="black" cx="173.95" cy="-196.43" rx="173.9" ry="21.43"/>
<text text-anchor="middle" x="173.95" y="-199.43" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="173.95" y="-188.43" font-family="Arial" font-size="10.00">[batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- embeddings -->
<g id="node2" class="node">
<title>embeddings</title>
<polygon fill="#e8f4fd" stroke="black" points="282.95,-116.21 64.95,-116.21 64.95,-80.21 282.95,-80.21 282.95,-116.21"/>
<text text-anchor="middle" x="173.95" y="-101.21" font-family="Arial" font-size="10.00">Token+Pos Embedding</text>
<text text-anchor="middle" x="173.95" y="-90.21" font-family="Arial" font-size="10.00">[Input: [1024,2048], Output: [1024,2048,4096]]</text>
</g>
<!-- input&#45;&gt;embeddings -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embeddings</title>
<path fill="none" stroke="black" d="M173.95,-175.02C173.95,-160.86 173.95,-141.84 173.95,-126.39"/>
<polygon fill="black" stroke="black" points="177.45,-126.37 173.95,-116.37 170.45,-126.37 177.45,-126.37"/>
</g>
<!-- layer0_norm1 -->
<g id="node3" class="node">
<title>layer0_norm1</title>
<polygon fill="#e8f4fd" stroke="black" points="294.95,-41 52.95,-41 52.95,0 294.95,0 294.95,-41"/>
<text text-anchor="middle" x="173.95" y="-29" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="173.95" y="-18" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="173.95" y="-7" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- embeddings&#45;&gt;layer0_norm1 -->
<g id="edge2" class="edge">
<title>embeddings&#45;&gt;layer0_norm1</title>
<path fill="none" stroke="black" d="M173.95,-80.03C173.95,-71.51 173.95,-60.97 173.95,-51.19"/>
<polygon fill="black" stroke="black" points="177.45,-51.01 173.95,-41.01 170.45,-51.01 177.45,-51.01"/>
</g>
<!-- layer0_qkv_gpu0 -->
<g id="node4" class="node">
<title>layer0_qkv_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="596.45,-216.93 365.45,-216.93 365.45,-175.93 596.45,-175.93 596.45,-216.93"/>
<text text-anchor="middle" x="480.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="480.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer0</text>
<text text-anchor="middle" x="480.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_attn_gpu0 -->
<g id="node5" class="node">
<title>layer0_attn_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="845.45,-216.93 614.45,-216.93 614.45,-175.93 845.45,-175.93 845.45,-216.93"/>
<text text-anchor="middle" x="729.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="729.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer0</text>
<text text-anchor="middle" x="729.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_output_gpu0 -->
<g id="node6" class="node">
<title>layer0_output_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="1094.45,-216.93 863.45,-216.93 863.45,-175.93 1094.45,-175.93 1094.45,-216.93"/>
<text text-anchor="middle" x="978.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="978.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer0</text>
<text text-anchor="middle" x="978.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_qkv_gpu1 -->
<g id="node7" class="node">
<title>layer0_qkv_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="1343.45,-216.93 1112.45,-216.93 1112.45,-175.93 1343.45,-175.93 1343.45,-216.93"/>
<text text-anchor="middle" x="1227.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="1227.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer0</text>
<text text-anchor="middle" x="1227.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_attn_gpu1 -->
<g id="node8" class="node">
<title>layer0_attn_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="1592.45,-216.93 1361.45,-216.93 1361.45,-175.93 1592.45,-175.93 1592.45,-216.93"/>
<text text-anchor="middle" x="1476.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="1476.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer0</text>
<text text-anchor="middle" x="1476.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_output_gpu1 -->
<g id="node9" class="node">
<title>layer0_output_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="1841.45,-216.93 1610.45,-216.93 1610.45,-175.93 1841.45,-175.93 1841.45,-216.93"/>
<text text-anchor="middle" x="1725.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="1725.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer0</text>
<text text-anchor="middle" x="1725.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_qkv_gpu2 -->
<g id="node10" class="node">
<title>layer0_qkv_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="2090.45,-216.93 1859.45,-216.93 1859.45,-175.93 2090.45,-175.93 2090.45,-216.93"/>
<text text-anchor="middle" x="1974.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="1974.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer0</text>
<text text-anchor="middle" x="1974.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_attn_gpu2 -->
<g id="node11" class="node">
<title>layer0_attn_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="2339.45,-216.93 2108.45,-216.93 2108.45,-175.93 2339.45,-175.93 2339.45,-216.93"/>
<text text-anchor="middle" x="2223.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="2223.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer0</text>
<text text-anchor="middle" x="2223.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_output_gpu2 -->
<g id="node12" class="node">
<title>layer0_output_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="2588.45,-216.93 2357.45,-216.93 2357.45,-175.93 2588.45,-175.93 2588.45,-216.93"/>
<text text-anchor="middle" x="2472.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="2472.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer0</text>
<text text-anchor="middle" x="2472.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_qkv_gpu3 -->
<g id="node13" class="node">
<title>layer0_qkv_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="2837.45,-216.93 2606.45,-216.93 2606.45,-175.93 2837.45,-175.93 2837.45,-216.93"/>
<text text-anchor="middle" x="2721.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="2721.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer0</text>
<text text-anchor="middle" x="2721.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_attn_gpu3 -->
<g id="node14" class="node">
<title>layer0_attn_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="3086.45,-216.93 2855.45,-216.93 2855.45,-175.93 3086.45,-175.93 3086.45,-216.93"/>
<text text-anchor="middle" x="2970.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="2970.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer0</text>
<text text-anchor="middle" x="2970.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_output_gpu3 -->
<g id="node15" class="node">
<title>layer0_output_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="3335.45,-216.93 3104.45,-216.93 3104.45,-175.93 3335.45,-175.93 3335.45,-216.93"/>
<text text-anchor="middle" x="3219.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="3219.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer0</text>
<text text-anchor="middle" x="3219.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_qkv_gpu4 -->
<g id="node16" class="node">
<title>layer0_qkv_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="3584.45,-216.93 3353.45,-216.93 3353.45,-175.93 3584.45,-175.93 3584.45,-216.93"/>
<text text-anchor="middle" x="3468.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="3468.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer0</text>
<text text-anchor="middle" x="3468.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_attn_gpu4 -->
<g id="node17" class="node">
<title>layer0_attn_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="3833.45,-216.93 3602.45,-216.93 3602.45,-175.93 3833.45,-175.93 3833.45,-216.93"/>
<text text-anchor="middle" x="3717.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="3717.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer0</text>
<text text-anchor="middle" x="3717.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_output_gpu4 -->
<g id="node18" class="node">
<title>layer0_output_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="4082.45,-216.93 3851.45,-216.93 3851.45,-175.93 4082.45,-175.93 4082.45,-216.93"/>
<text text-anchor="middle" x="3966.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="3966.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer0</text>
<text text-anchor="middle" x="3966.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_qkv_gpu5 -->
<g id="node19" class="node">
<title>layer0_qkv_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="4331.45,-216.93 4100.45,-216.93 4100.45,-175.93 4331.45,-175.93 4331.45,-216.93"/>
<text text-anchor="middle" x="4215.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="4215.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer0</text>
<text text-anchor="middle" x="4215.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_attn_gpu5 -->
<g id="node20" class="node">
<title>layer0_attn_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="4580.45,-216.93 4349.45,-216.93 4349.45,-175.93 4580.45,-175.93 4580.45,-216.93"/>
<text text-anchor="middle" x="4464.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="4464.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer0</text>
<text text-anchor="middle" x="4464.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_output_gpu5 -->
<g id="node21" class="node">
<title>layer0_output_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="4829.45,-216.93 4598.45,-216.93 4598.45,-175.93 4829.45,-175.93 4829.45,-216.93"/>
<text text-anchor="middle" x="4713.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="4713.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer0</text>
<text text-anchor="middle" x="4713.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_qkv_gpu6 -->
<g id="node22" class="node">
<title>layer0_qkv_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="5078.45,-216.93 4847.45,-216.93 4847.45,-175.93 5078.45,-175.93 5078.45,-216.93"/>
<text text-anchor="middle" x="4962.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="4962.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer0</text>
<text text-anchor="middle" x="4962.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_attn_gpu6 -->
<g id="node23" class="node">
<title>layer0_attn_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="5327.45,-216.93 5096.45,-216.93 5096.45,-175.93 5327.45,-175.93 5327.45,-216.93"/>
<text text-anchor="middle" x="5211.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="5211.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer0</text>
<text text-anchor="middle" x="5211.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_output_gpu6 -->
<g id="node24" class="node">
<title>layer0_output_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="5576.45,-216.93 5345.45,-216.93 5345.45,-175.93 5576.45,-175.93 5576.45,-216.93"/>
<text text-anchor="middle" x="5460.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="5460.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer0</text>
<text text-anchor="middle" x="5460.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_qkv_gpu7 -->
<g id="node25" class="node">
<title>layer0_qkv_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="5825.45,-216.93 5594.45,-216.93 5594.45,-175.93 5825.45,-175.93 5825.45,-216.93"/>
<text text-anchor="middle" x="5709.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="5709.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer0</text>
<text text-anchor="middle" x="5709.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_attn_gpu7 -->
<g id="node26" class="node">
<title>layer0_attn_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="6074.45,-216.93 5843.45,-216.93 5843.45,-175.93 6074.45,-175.93 6074.45,-216.93"/>
<text text-anchor="middle" x="5958.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="5958.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer0</text>
<text text-anchor="middle" x="5958.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_output_gpu7 -->
<g id="node27" class="node">
<title>layer0_output_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="6323.45,-216.93 6092.45,-216.93 6092.45,-175.93 6323.45,-175.93 6323.45,-216.93"/>
<text text-anchor="middle" x="6207.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="6207.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer0</text>
<text text-anchor="middle" x="6207.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_attn_allreduce -->
<g id="node28" class="node">
<title>layer0_attn_allreduce</title>
<path fill="#e8fde8" stroke="black" d="M6844.18,-237.43C6844.18,-237.43 6458.98,-237.43 6458.98,-237.43 6452.98,-237.43 6442.25,-233.74 6437.52,-230.05 6437.52,-230.05 6351.19,-162.8 6351.19,-162.8 6346.45,-159.11 6347.72,-155.43 6353.72,-155.43 6353.72,-155.43 6738.91,-155.43 6738.91,-155.43 6744.91,-155.43 6755.65,-159.11 6760.38,-162.8 6760.38,-162.8 6846.71,-230.05 6846.71,-230.05 6851.44,-233.74 6850.18,-237.43 6844.18,-237.43"/>
<text text-anchor="middle" x="6598.95" y="-204.93" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="6598.95" y="-193.93" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="6598.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: 8×[1024,2048,512], Output: [1024,2048,4096]]</text>
</g>
<!-- layer0_moe_qkv_gpu0 -->
<g id="node29" class="node">
<title>layer0_moe_qkv_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="7105.45,-216.93 6874.45,-216.93 6874.45,-175.93 7105.45,-175.93 7105.45,-216.93"/>
<text text-anchor="middle" x="6989.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="6989.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer0</text>
<text text-anchor="middle" x="6989.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_experts_gpu0 -->
<g id="node30" class="node">
<title>layer0_moe_experts_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="7354.45,-216.93 7123.45,-216.93 7123.45,-175.93 7354.45,-175.93 7354.45,-216.93"/>
<text text-anchor="middle" x="7238.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="7238.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer0</text>
<text text-anchor="middle" x="7238.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_output_gpu0 -->
<g id="node31" class="node">
<title>layer0_moe_output_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="7603.45,-216.93 7372.45,-216.93 7372.45,-175.93 7603.45,-175.93 7603.45,-216.93"/>
<text text-anchor="middle" x="7487.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="7487.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer0</text>
<text text-anchor="middle" x="7487.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_qkv_gpu1 -->
<g id="node32" class="node">
<title>layer0_moe_qkv_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="7852.45,-216.93 7621.45,-216.93 7621.45,-175.93 7852.45,-175.93 7852.45,-216.93"/>
<text text-anchor="middle" x="7736.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="7736.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer0</text>
<text text-anchor="middle" x="7736.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_experts_gpu1 -->
<g id="node33" class="node">
<title>layer0_moe_experts_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="8101.45,-216.93 7870.45,-216.93 7870.45,-175.93 8101.45,-175.93 8101.45,-216.93"/>
<text text-anchor="middle" x="7985.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="7985.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer0</text>
<text text-anchor="middle" x="7985.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_output_gpu1 -->
<g id="node34" class="node">
<title>layer0_moe_output_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="8350.45,-216.93 8119.45,-216.93 8119.45,-175.93 8350.45,-175.93 8350.45,-216.93"/>
<text text-anchor="middle" x="8234.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="8234.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer0</text>
<text text-anchor="middle" x="8234.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_qkv_gpu2 -->
<g id="node35" class="node">
<title>layer0_moe_qkv_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="8599.45,-216.93 8368.45,-216.93 8368.45,-175.93 8599.45,-175.93 8599.45,-216.93"/>
<text text-anchor="middle" x="8483.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="8483.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer0</text>
<text text-anchor="middle" x="8483.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_experts_gpu2 -->
<g id="node36" class="node">
<title>layer0_moe_experts_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="8848.45,-216.93 8617.45,-216.93 8617.45,-175.93 8848.45,-175.93 8848.45,-216.93"/>
<text text-anchor="middle" x="8732.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="8732.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer0</text>
<text text-anchor="middle" x="8732.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_output_gpu2 -->
<g id="node37" class="node">
<title>layer0_moe_output_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="9097.45,-216.93 8866.45,-216.93 8866.45,-175.93 9097.45,-175.93 9097.45,-216.93"/>
<text text-anchor="middle" x="8981.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="8981.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer0</text>
<text text-anchor="middle" x="8981.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_qkv_gpu3 -->
<g id="node38" class="node">
<title>layer0_moe_qkv_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="9346.45,-216.93 9115.45,-216.93 9115.45,-175.93 9346.45,-175.93 9346.45,-216.93"/>
<text text-anchor="middle" x="9230.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="9230.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer0</text>
<text text-anchor="middle" x="9230.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_experts_gpu3 -->
<g id="node39" class="node">
<title>layer0_moe_experts_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="9595.45,-216.93 9364.45,-216.93 9364.45,-175.93 9595.45,-175.93 9595.45,-216.93"/>
<text text-anchor="middle" x="9479.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="9479.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer0</text>
<text text-anchor="middle" x="9479.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_output_gpu3 -->
<g id="node40" class="node">
<title>layer0_moe_output_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="9844.45,-216.93 9613.45,-216.93 9613.45,-175.93 9844.45,-175.93 9844.45,-216.93"/>
<text text-anchor="middle" x="9728.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="9728.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer0</text>
<text text-anchor="middle" x="9728.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_qkv_gpu4 -->
<g id="node41" class="node">
<title>layer0_moe_qkv_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="10093.45,-216.93 9862.45,-216.93 9862.45,-175.93 10093.45,-175.93 10093.45,-216.93"/>
<text text-anchor="middle" x="9977.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="9977.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer0</text>
<text text-anchor="middle" x="9977.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_experts_gpu4 -->
<g id="node42" class="node">
<title>layer0_moe_experts_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="10342.45,-216.93 10111.45,-216.93 10111.45,-175.93 10342.45,-175.93 10342.45,-216.93"/>
<text text-anchor="middle" x="10226.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="10226.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer0</text>
<text text-anchor="middle" x="10226.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_output_gpu4 -->
<g id="node43" class="node">
<title>layer0_moe_output_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="10591.45,-216.93 10360.45,-216.93 10360.45,-175.93 10591.45,-175.93 10591.45,-216.93"/>
<text text-anchor="middle" x="10475.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="10475.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer0</text>
<text text-anchor="middle" x="10475.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_qkv_gpu5 -->
<g id="node44" class="node">
<title>layer0_moe_qkv_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="10840.45,-216.93 10609.45,-216.93 10609.45,-175.93 10840.45,-175.93 10840.45,-216.93"/>
<text text-anchor="middle" x="10724.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="10724.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer0</text>
<text text-anchor="middle" x="10724.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_experts_gpu5 -->
<g id="node45" class="node">
<title>layer0_moe_experts_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="11089.45,-216.93 10858.45,-216.93 10858.45,-175.93 11089.45,-175.93 11089.45,-216.93"/>
<text text-anchor="middle" x="10973.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="10973.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer0</text>
<text text-anchor="middle" x="10973.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_output_gpu5 -->
<g id="node46" class="node">
<title>layer0_moe_output_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="11338.45,-216.93 11107.45,-216.93 11107.45,-175.93 11338.45,-175.93 11338.45,-216.93"/>
<text text-anchor="middle" x="11222.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="11222.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer0</text>
<text text-anchor="middle" x="11222.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_qkv_gpu6 -->
<g id="node47" class="node">
<title>layer0_moe_qkv_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="11587.45,-216.93 11356.45,-216.93 11356.45,-175.93 11587.45,-175.93 11587.45,-216.93"/>
<text text-anchor="middle" x="11471.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="11471.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer0</text>
<text text-anchor="middle" x="11471.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_experts_gpu6 -->
<g id="node48" class="node">
<title>layer0_moe_experts_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="11836.45,-216.93 11605.45,-216.93 11605.45,-175.93 11836.45,-175.93 11836.45,-216.93"/>
<text text-anchor="middle" x="11720.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="11720.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer0</text>
<text text-anchor="middle" x="11720.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_output_gpu6 -->
<g id="node49" class="node">
<title>layer0_moe_output_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="12085.45,-216.93 11854.45,-216.93 11854.45,-175.93 12085.45,-175.93 12085.45,-216.93"/>
<text text-anchor="middle" x="11969.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="11969.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer0</text>
<text text-anchor="middle" x="11969.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_qkv_gpu7 -->
<g id="node50" class="node">
<title>layer0_moe_qkv_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="12334.45,-216.93 12103.45,-216.93 12103.45,-175.93 12334.45,-175.93 12334.45,-216.93"/>
<text text-anchor="middle" x="12218.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="12218.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer0</text>
<text text-anchor="middle" x="12218.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_experts_gpu7 -->
<g id="node51" class="node">
<title>layer0_moe_experts_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="12583.45,-216.93 12352.45,-216.93 12352.45,-175.93 12583.45,-175.93 12583.45,-216.93"/>
<text text-anchor="middle" x="12467.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="12467.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer0</text>
<text text-anchor="middle" x="12467.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_output_gpu7 -->
<g id="node52" class="node">
<title>layer0_moe_output_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="12832.45,-216.93 12601.45,-216.93 12601.45,-175.93 12832.45,-175.93 12832.45,-216.93"/>
<text text-anchor="middle" x="12716.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="12716.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer0</text>
<text text-anchor="middle" x="12716.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer0_moe_allreduce -->
<g id="node53" class="node">
<title>layer0_moe_allreduce</title>
<path fill="#e8fde8" stroke="black" d="M13353.18,-237.43C13353.18,-237.43 12967.98,-237.43 12967.98,-237.43 12961.98,-237.43 12951.25,-233.74 12946.52,-230.05 12946.52,-230.05 12860.19,-162.8 12860.19,-162.8 12855.45,-159.11 12856.72,-155.43 12862.72,-155.43 12862.72,-155.43 13247.91,-155.43 13247.91,-155.43 13253.91,-155.43 13264.65,-159.11 13269.38,-162.8 13269.38,-162.8 13355.71,-230.05 13355.71,-230.05 13360.44,-233.74 13359.18,-237.43 13353.18,-237.43"/>
<text text-anchor="middle" x="13107.95" y="-204.93" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="13107.95" y="-193.93" font-family="Arial" font-size="10.00">MoE All&#45;Reduce</text>
<text text-anchor="middle" x="13107.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: 8×[1024,2048,512], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_norm1 -->
<g id="node54" class="node">
<title>layer1_norm1</title>
<polygon fill="#e8f4fd" stroke="black" points="13624.95,-216.93 13382.95,-216.93 13382.95,-175.93 13624.95,-175.93 13624.95,-216.93"/>
<text text-anchor="middle" x="13503.95" y="-204.93" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="13503.95" y="-193.93" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="13503.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_qkv_gpu0 -->
<g id="node55" class="node">
<title>layer1_qkv_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="13874.45,-216.93 13643.45,-216.93 13643.45,-175.93 13874.45,-175.93 13874.45,-216.93"/>
<text text-anchor="middle" x="13758.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="13758.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer1</text>
<text text-anchor="middle" x="13758.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_attn_gpu0 -->
<g id="node56" class="node">
<title>layer1_attn_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="14123.45,-216.93 13892.45,-216.93 13892.45,-175.93 14123.45,-175.93 14123.45,-216.93"/>
<text text-anchor="middle" x="14007.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="14007.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer1</text>
<text text-anchor="middle" x="14007.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_output_gpu0 -->
<g id="node57" class="node">
<title>layer1_output_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="14372.45,-216.93 14141.45,-216.93 14141.45,-175.93 14372.45,-175.93 14372.45,-216.93"/>
<text text-anchor="middle" x="14256.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="14256.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer1</text>
<text text-anchor="middle" x="14256.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_qkv_gpu1 -->
<g id="node58" class="node">
<title>layer1_qkv_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="14621.45,-216.93 14390.45,-216.93 14390.45,-175.93 14621.45,-175.93 14621.45,-216.93"/>
<text text-anchor="middle" x="14505.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="14505.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer1</text>
<text text-anchor="middle" x="14505.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_attn_gpu1 -->
<g id="node59" class="node">
<title>layer1_attn_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="14870.45,-216.93 14639.45,-216.93 14639.45,-175.93 14870.45,-175.93 14870.45,-216.93"/>
<text text-anchor="middle" x="14754.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="14754.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer1</text>
<text text-anchor="middle" x="14754.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_output_gpu1 -->
<g id="node60" class="node">
<title>layer1_output_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="15119.45,-216.93 14888.45,-216.93 14888.45,-175.93 15119.45,-175.93 15119.45,-216.93"/>
<text text-anchor="middle" x="15003.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="15003.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer1</text>
<text text-anchor="middle" x="15003.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_qkv_gpu2 -->
<g id="node61" class="node">
<title>layer1_qkv_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="15368.45,-216.93 15137.45,-216.93 15137.45,-175.93 15368.45,-175.93 15368.45,-216.93"/>
<text text-anchor="middle" x="15252.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="15252.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer1</text>
<text text-anchor="middle" x="15252.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_attn_gpu2 -->
<g id="node62" class="node">
<title>layer1_attn_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="15617.45,-216.93 15386.45,-216.93 15386.45,-175.93 15617.45,-175.93 15617.45,-216.93"/>
<text text-anchor="middle" x="15501.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="15501.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer1</text>
<text text-anchor="middle" x="15501.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_output_gpu2 -->
<g id="node63" class="node">
<title>layer1_output_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="15866.45,-216.93 15635.45,-216.93 15635.45,-175.93 15866.45,-175.93 15866.45,-216.93"/>
<text text-anchor="middle" x="15750.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="15750.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer1</text>
<text text-anchor="middle" x="15750.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_qkv_gpu3 -->
<g id="node64" class="node">
<title>layer1_qkv_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="16115.45,-216.93 15884.45,-216.93 15884.45,-175.93 16115.45,-175.93 16115.45,-216.93"/>
<text text-anchor="middle" x="15999.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="15999.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer1</text>
<text text-anchor="middle" x="15999.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_attn_gpu3 -->
<g id="node65" class="node">
<title>layer1_attn_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="16364.45,-216.93 16133.45,-216.93 16133.45,-175.93 16364.45,-175.93 16364.45,-216.93"/>
<text text-anchor="middle" x="16248.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="16248.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer1</text>
<text text-anchor="middle" x="16248.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_output_gpu3 -->
<g id="node66" class="node">
<title>layer1_output_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="16613.45,-216.93 16382.45,-216.93 16382.45,-175.93 16613.45,-175.93 16613.45,-216.93"/>
<text text-anchor="middle" x="16497.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="16497.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer1</text>
<text text-anchor="middle" x="16497.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_qkv_gpu4 -->
<g id="node67" class="node">
<title>layer1_qkv_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="16862.45,-216.93 16631.45,-216.93 16631.45,-175.93 16862.45,-175.93 16862.45,-216.93"/>
<text text-anchor="middle" x="16746.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="16746.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer1</text>
<text text-anchor="middle" x="16746.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_attn_gpu4 -->
<g id="node68" class="node">
<title>layer1_attn_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="17111.45,-216.93 16880.45,-216.93 16880.45,-175.93 17111.45,-175.93 17111.45,-216.93"/>
<text text-anchor="middle" x="16995.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="16995.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer1</text>
<text text-anchor="middle" x="16995.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_output_gpu4 -->
<g id="node69" class="node">
<title>layer1_output_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="17360.45,-216.93 17129.45,-216.93 17129.45,-175.93 17360.45,-175.93 17360.45,-216.93"/>
<text text-anchor="middle" x="17244.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="17244.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer1</text>
<text text-anchor="middle" x="17244.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_qkv_gpu5 -->
<g id="node70" class="node">
<title>layer1_qkv_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="17609.45,-216.93 17378.45,-216.93 17378.45,-175.93 17609.45,-175.93 17609.45,-216.93"/>
<text text-anchor="middle" x="17493.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="17493.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer1</text>
<text text-anchor="middle" x="17493.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_attn_gpu5 -->
<g id="node71" class="node">
<title>layer1_attn_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="17858.45,-216.93 17627.45,-216.93 17627.45,-175.93 17858.45,-175.93 17858.45,-216.93"/>
<text text-anchor="middle" x="17742.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="17742.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer1</text>
<text text-anchor="middle" x="17742.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_output_gpu5 -->
<g id="node72" class="node">
<title>layer1_output_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="18107.45,-216.93 17876.45,-216.93 17876.45,-175.93 18107.45,-175.93 18107.45,-216.93"/>
<text text-anchor="middle" x="17991.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="17991.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer1</text>
<text text-anchor="middle" x="17991.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_qkv_gpu6 -->
<g id="node73" class="node">
<title>layer1_qkv_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="18356.45,-216.93 18125.45,-216.93 18125.45,-175.93 18356.45,-175.93 18356.45,-216.93"/>
<text text-anchor="middle" x="18240.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="18240.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer1</text>
<text text-anchor="middle" x="18240.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_attn_gpu6 -->
<g id="node74" class="node">
<title>layer1_attn_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="18605.45,-216.93 18374.45,-216.93 18374.45,-175.93 18605.45,-175.93 18605.45,-216.93"/>
<text text-anchor="middle" x="18489.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="18489.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer1</text>
<text text-anchor="middle" x="18489.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_output_gpu6 -->
<g id="node75" class="node">
<title>layer1_output_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="18854.45,-216.93 18623.45,-216.93 18623.45,-175.93 18854.45,-175.93 18854.45,-216.93"/>
<text text-anchor="middle" x="18738.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="18738.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer1</text>
<text text-anchor="middle" x="18738.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_qkv_gpu7 -->
<g id="node76" class="node">
<title>layer1_qkv_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="19103.45,-216.93 18872.45,-216.93 18872.45,-175.93 19103.45,-175.93 19103.45,-216.93"/>
<text text-anchor="middle" x="18987.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="18987.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer1</text>
<text text-anchor="middle" x="18987.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_attn_gpu7 -->
<g id="node77" class="node">
<title>layer1_attn_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="19352.45,-216.93 19121.45,-216.93 19121.45,-175.93 19352.45,-175.93 19352.45,-216.93"/>
<text text-anchor="middle" x="19236.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="19236.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer1</text>
<text text-anchor="middle" x="19236.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_output_gpu7 -->
<g id="node78" class="node">
<title>layer1_output_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="19601.45,-216.93 19370.45,-216.93 19370.45,-175.93 19601.45,-175.93 19601.45,-216.93"/>
<text text-anchor="middle" x="19485.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="19485.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer1</text>
<text text-anchor="middle" x="19485.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_attn_allreduce -->
<g id="node79" class="node">
<title>layer1_attn_allreduce</title>
<path fill="#e8fde8" stroke="black" d="M20122.18,-237.43C20122.18,-237.43 19736.98,-237.43 19736.98,-237.43 19730.98,-237.43 19720.25,-233.74 19715.52,-230.05 19715.52,-230.05 19629.19,-162.8 19629.19,-162.8 19624.45,-159.11 19625.72,-155.43 19631.72,-155.43 19631.72,-155.43 20016.91,-155.43 20016.91,-155.43 20022.91,-155.43 20033.65,-159.11 20038.38,-162.8 20038.38,-162.8 20124.71,-230.05 20124.71,-230.05 20129.44,-233.74 20128.18,-237.43 20122.18,-237.43"/>
<text text-anchor="middle" x="19876.95" y="-204.93" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="19876.95" y="-193.93" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="19876.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: 8×[1024,2048,512], Output: [1024,2048,4096]]</text>
</g>
<!-- layer1_moe_qkv_gpu0 -->
<g id="node80" class="node">
<title>layer1_moe_qkv_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="20383.45,-216.93 20152.45,-216.93 20152.45,-175.93 20383.45,-175.93 20383.45,-216.93"/>
<text text-anchor="middle" x="20267.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="20267.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer1</text>
<text text-anchor="middle" x="20267.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_experts_gpu0 -->
<g id="node81" class="node">
<title>layer1_moe_experts_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="20632.45,-216.93 20401.45,-216.93 20401.45,-175.93 20632.45,-175.93 20632.45,-216.93"/>
<text text-anchor="middle" x="20516.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="20516.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer1</text>
<text text-anchor="middle" x="20516.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_output_gpu0 -->
<g id="node82" class="node">
<title>layer1_moe_output_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="20881.45,-216.93 20650.45,-216.93 20650.45,-175.93 20881.45,-175.93 20881.45,-216.93"/>
<text text-anchor="middle" x="20765.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="20765.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer1</text>
<text text-anchor="middle" x="20765.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_qkv_gpu1 -->
<g id="node83" class="node">
<title>layer1_moe_qkv_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="21130.45,-216.93 20899.45,-216.93 20899.45,-175.93 21130.45,-175.93 21130.45,-216.93"/>
<text text-anchor="middle" x="21014.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="21014.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer1</text>
<text text-anchor="middle" x="21014.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_experts_gpu1 -->
<g id="node84" class="node">
<title>layer1_moe_experts_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="21379.45,-216.93 21148.45,-216.93 21148.45,-175.93 21379.45,-175.93 21379.45,-216.93"/>
<text text-anchor="middle" x="21263.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="21263.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer1</text>
<text text-anchor="middle" x="21263.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_output_gpu1 -->
<g id="node85" class="node">
<title>layer1_moe_output_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="21628.45,-216.93 21397.45,-216.93 21397.45,-175.93 21628.45,-175.93 21628.45,-216.93"/>
<text text-anchor="middle" x="21512.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="21512.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer1</text>
<text text-anchor="middle" x="21512.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_qkv_gpu2 -->
<g id="node86" class="node">
<title>layer1_moe_qkv_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="21877.45,-216.93 21646.45,-216.93 21646.45,-175.93 21877.45,-175.93 21877.45,-216.93"/>
<text text-anchor="middle" x="21761.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="21761.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer1</text>
<text text-anchor="middle" x="21761.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_experts_gpu2 -->
<g id="node87" class="node">
<title>layer1_moe_experts_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="22126.45,-216.93 21895.45,-216.93 21895.45,-175.93 22126.45,-175.93 22126.45,-216.93"/>
<text text-anchor="middle" x="22010.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="22010.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer1</text>
<text text-anchor="middle" x="22010.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_output_gpu2 -->
<g id="node88" class="node">
<title>layer1_moe_output_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="22375.45,-216.93 22144.45,-216.93 22144.45,-175.93 22375.45,-175.93 22375.45,-216.93"/>
<text text-anchor="middle" x="22259.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="22259.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer1</text>
<text text-anchor="middle" x="22259.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_qkv_gpu3 -->
<g id="node89" class="node">
<title>layer1_moe_qkv_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="22624.45,-216.93 22393.45,-216.93 22393.45,-175.93 22624.45,-175.93 22624.45,-216.93"/>
<text text-anchor="middle" x="22508.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="22508.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer1</text>
<text text-anchor="middle" x="22508.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_experts_gpu3 -->
<g id="node90" class="node">
<title>layer1_moe_experts_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="22873.45,-216.93 22642.45,-216.93 22642.45,-175.93 22873.45,-175.93 22873.45,-216.93"/>
<text text-anchor="middle" x="22757.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="22757.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer1</text>
<text text-anchor="middle" x="22757.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_output_gpu3 -->
<g id="node91" class="node">
<title>layer1_moe_output_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="23122.45,-216.93 22891.45,-216.93 22891.45,-175.93 23122.45,-175.93 23122.45,-216.93"/>
<text text-anchor="middle" x="23006.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="23006.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer1</text>
<text text-anchor="middle" x="23006.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_qkv_gpu4 -->
<g id="node92" class="node">
<title>layer1_moe_qkv_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="23371.45,-216.93 23140.45,-216.93 23140.45,-175.93 23371.45,-175.93 23371.45,-216.93"/>
<text text-anchor="middle" x="23255.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="23255.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer1</text>
<text text-anchor="middle" x="23255.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_experts_gpu4 -->
<g id="node93" class="node">
<title>layer1_moe_experts_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="23620.45,-216.93 23389.45,-216.93 23389.45,-175.93 23620.45,-175.93 23620.45,-216.93"/>
<text text-anchor="middle" x="23504.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="23504.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer1</text>
<text text-anchor="middle" x="23504.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_output_gpu4 -->
<g id="node94" class="node">
<title>layer1_moe_output_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="23869.45,-216.93 23638.45,-216.93 23638.45,-175.93 23869.45,-175.93 23869.45,-216.93"/>
<text text-anchor="middle" x="23753.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="23753.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer1</text>
<text text-anchor="middle" x="23753.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_qkv_gpu5 -->
<g id="node95" class="node">
<title>layer1_moe_qkv_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="24118.45,-216.93 23887.45,-216.93 23887.45,-175.93 24118.45,-175.93 24118.45,-216.93"/>
<text text-anchor="middle" x="24002.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="24002.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer1</text>
<text text-anchor="middle" x="24002.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_experts_gpu5 -->
<g id="node96" class="node">
<title>layer1_moe_experts_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="24367.45,-216.93 24136.45,-216.93 24136.45,-175.93 24367.45,-175.93 24367.45,-216.93"/>
<text text-anchor="middle" x="24251.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="24251.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer1</text>
<text text-anchor="middle" x="24251.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_output_gpu5 -->
<g id="node97" class="node">
<title>layer1_moe_output_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="24616.45,-216.93 24385.45,-216.93 24385.45,-175.93 24616.45,-175.93 24616.45,-216.93"/>
<text text-anchor="middle" x="24500.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="24500.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer1</text>
<text text-anchor="middle" x="24500.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_qkv_gpu6 -->
<g id="node98" class="node">
<title>layer1_moe_qkv_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="24865.45,-216.93 24634.45,-216.93 24634.45,-175.93 24865.45,-175.93 24865.45,-216.93"/>
<text text-anchor="middle" x="24749.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="24749.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer1</text>
<text text-anchor="middle" x="24749.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_experts_gpu6 -->
<g id="node99" class="node">
<title>layer1_moe_experts_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="25114.45,-216.93 24883.45,-216.93 24883.45,-175.93 25114.45,-175.93 25114.45,-216.93"/>
<text text-anchor="middle" x="24998.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="24998.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer1</text>
<text text-anchor="middle" x="24998.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_output_gpu6 -->
<g id="node100" class="node">
<title>layer1_moe_output_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="25363.45,-216.93 25132.45,-216.93 25132.45,-175.93 25363.45,-175.93 25363.45,-216.93"/>
<text text-anchor="middle" x="25247.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="25247.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer1</text>
<text text-anchor="middle" x="25247.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_qkv_gpu7 -->
<g id="node101" class="node">
<title>layer1_moe_qkv_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="25612.45,-216.93 25381.45,-216.93 25381.45,-175.93 25612.45,-175.93 25612.45,-216.93"/>
<text text-anchor="middle" x="25496.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="25496.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer1</text>
<text text-anchor="middle" x="25496.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_experts_gpu7 -->
<g id="node102" class="node">
<title>layer1_moe_experts_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="25861.45,-216.93 25630.45,-216.93 25630.45,-175.93 25861.45,-175.93 25861.45,-216.93"/>
<text text-anchor="middle" x="25745.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="25745.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer1</text>
<text text-anchor="middle" x="25745.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_output_gpu7 -->
<g id="node103" class="node">
<title>layer1_moe_output_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="26110.45,-216.93 25879.45,-216.93 25879.45,-175.93 26110.45,-175.93 26110.45,-216.93"/>
<text text-anchor="middle" x="25994.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="25994.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer1</text>
<text text-anchor="middle" x="25994.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer1_moe_allreduce -->
<g id="node104" class="node">
<title>layer1_moe_allreduce</title>
<path fill="#e8fde8" stroke="black" d="M26631.18,-237.43C26631.18,-237.43 26245.98,-237.43 26245.98,-237.43 26239.98,-237.43 26229.25,-233.74 26224.52,-230.05 26224.52,-230.05 26138.19,-162.8 26138.19,-162.8 26133.45,-159.11 26134.72,-155.43 26140.72,-155.43 26140.72,-155.43 26525.91,-155.43 26525.91,-155.43 26531.91,-155.43 26542.65,-159.11 26547.38,-162.8 26547.38,-162.8 26633.71,-230.05 26633.71,-230.05 26638.44,-233.74 26637.18,-237.43 26631.18,-237.43"/>
<text text-anchor="middle" x="26385.95" y="-204.93" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="26385.95" y="-193.93" font-family="Arial" font-size="10.00">MoE All&#45;Reduce</text>
<text text-anchor="middle" x="26385.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: 8×[1024,2048,512], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_norm1 -->
<g id="node105" class="node">
<title>layer2_norm1</title>
<polygon fill="#e8f4fd" stroke="black" points="26902.95,-216.93 26660.95,-216.93 26660.95,-175.93 26902.95,-175.93 26902.95,-216.93"/>
<text text-anchor="middle" x="26781.95" y="-204.93" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="26781.95" y="-193.93" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="26781.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_qkv_gpu0 -->
<g id="node106" class="node">
<title>layer2_qkv_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="27152.45,-216.93 26921.45,-216.93 26921.45,-175.93 27152.45,-175.93 27152.45,-216.93"/>
<text text-anchor="middle" x="27036.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="27036.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer2</text>
<text text-anchor="middle" x="27036.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_attn_gpu0 -->
<g id="node107" class="node">
<title>layer2_attn_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="27401.45,-216.93 27170.45,-216.93 27170.45,-175.93 27401.45,-175.93 27401.45,-216.93"/>
<text text-anchor="middle" x="27285.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="27285.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer2</text>
<text text-anchor="middle" x="27285.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_output_gpu0 -->
<g id="node108" class="node">
<title>layer2_output_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="27650.45,-216.93 27419.45,-216.93 27419.45,-175.93 27650.45,-175.93 27650.45,-216.93"/>
<text text-anchor="middle" x="27534.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="27534.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer2</text>
<text text-anchor="middle" x="27534.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_qkv_gpu1 -->
<g id="node109" class="node">
<title>layer2_qkv_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="27899.45,-216.93 27668.45,-216.93 27668.45,-175.93 27899.45,-175.93 27899.45,-216.93"/>
<text text-anchor="middle" x="27783.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="27783.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer2</text>
<text text-anchor="middle" x="27783.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_attn_gpu1 -->
<g id="node110" class="node">
<title>layer2_attn_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="28148.45,-216.93 27917.45,-216.93 27917.45,-175.93 28148.45,-175.93 28148.45,-216.93"/>
<text text-anchor="middle" x="28032.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="28032.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer2</text>
<text text-anchor="middle" x="28032.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_output_gpu1 -->
<g id="node111" class="node">
<title>layer2_output_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="28397.45,-216.93 28166.45,-216.93 28166.45,-175.93 28397.45,-175.93 28397.45,-216.93"/>
<text text-anchor="middle" x="28281.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="28281.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer2</text>
<text text-anchor="middle" x="28281.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_qkv_gpu2 -->
<g id="node112" class="node">
<title>layer2_qkv_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="28646.45,-216.93 28415.45,-216.93 28415.45,-175.93 28646.45,-175.93 28646.45,-216.93"/>
<text text-anchor="middle" x="28530.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="28530.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer2</text>
<text text-anchor="middle" x="28530.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_attn_gpu2 -->
<g id="node113" class="node">
<title>layer2_attn_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="28895.45,-216.93 28664.45,-216.93 28664.45,-175.93 28895.45,-175.93 28895.45,-216.93"/>
<text text-anchor="middle" x="28779.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="28779.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer2</text>
<text text-anchor="middle" x="28779.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_output_gpu2 -->
<g id="node114" class="node">
<title>layer2_output_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="29144.45,-216.93 28913.45,-216.93 28913.45,-175.93 29144.45,-175.93 29144.45,-216.93"/>
<text text-anchor="middle" x="29028.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="29028.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer2</text>
<text text-anchor="middle" x="29028.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_qkv_gpu3 -->
<g id="node115" class="node">
<title>layer2_qkv_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="29393.45,-216.93 29162.45,-216.93 29162.45,-175.93 29393.45,-175.93 29393.45,-216.93"/>
<text text-anchor="middle" x="29277.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="29277.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer2</text>
<text text-anchor="middle" x="29277.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_attn_gpu3 -->
<g id="node116" class="node">
<title>layer2_attn_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="29642.45,-216.93 29411.45,-216.93 29411.45,-175.93 29642.45,-175.93 29642.45,-216.93"/>
<text text-anchor="middle" x="29526.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="29526.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer2</text>
<text text-anchor="middle" x="29526.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_output_gpu3 -->
<g id="node117" class="node">
<title>layer2_output_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="29891.45,-216.93 29660.45,-216.93 29660.45,-175.93 29891.45,-175.93 29891.45,-216.93"/>
<text text-anchor="middle" x="29775.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="29775.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer2</text>
<text text-anchor="middle" x="29775.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_qkv_gpu4 -->
<g id="node118" class="node">
<title>layer2_qkv_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="30140.45,-216.93 29909.45,-216.93 29909.45,-175.93 30140.45,-175.93 30140.45,-216.93"/>
<text text-anchor="middle" x="30024.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="30024.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer2</text>
<text text-anchor="middle" x="30024.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_attn_gpu4 -->
<g id="node119" class="node">
<title>layer2_attn_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="30389.45,-216.93 30158.45,-216.93 30158.45,-175.93 30389.45,-175.93 30389.45,-216.93"/>
<text text-anchor="middle" x="30273.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="30273.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer2</text>
<text text-anchor="middle" x="30273.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_output_gpu4 -->
<g id="node120" class="node">
<title>layer2_output_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="30638.45,-216.93 30407.45,-216.93 30407.45,-175.93 30638.45,-175.93 30638.45,-216.93"/>
<text text-anchor="middle" x="30522.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="30522.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer2</text>
<text text-anchor="middle" x="30522.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_qkv_gpu5 -->
<g id="node121" class="node">
<title>layer2_qkv_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="30887.45,-216.93 30656.45,-216.93 30656.45,-175.93 30887.45,-175.93 30887.45,-216.93"/>
<text text-anchor="middle" x="30771.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="30771.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer2</text>
<text text-anchor="middle" x="30771.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_attn_gpu5 -->
<g id="node122" class="node">
<title>layer2_attn_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="31136.45,-216.93 30905.45,-216.93 30905.45,-175.93 31136.45,-175.93 31136.45,-216.93"/>
<text text-anchor="middle" x="31020.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="31020.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer2</text>
<text text-anchor="middle" x="31020.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_output_gpu5 -->
<g id="node123" class="node">
<title>layer2_output_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="31385.45,-216.93 31154.45,-216.93 31154.45,-175.93 31385.45,-175.93 31385.45,-216.93"/>
<text text-anchor="middle" x="31269.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="31269.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer2</text>
<text text-anchor="middle" x="31269.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_qkv_gpu6 -->
<g id="node124" class="node">
<title>layer2_qkv_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="31634.45,-216.93 31403.45,-216.93 31403.45,-175.93 31634.45,-175.93 31634.45,-216.93"/>
<text text-anchor="middle" x="31518.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="31518.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer2</text>
<text text-anchor="middle" x="31518.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_attn_gpu6 -->
<g id="node125" class="node">
<title>layer2_attn_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="31883.45,-216.93 31652.45,-216.93 31652.45,-175.93 31883.45,-175.93 31883.45,-216.93"/>
<text text-anchor="middle" x="31767.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="31767.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer2</text>
<text text-anchor="middle" x="31767.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_output_gpu6 -->
<g id="node126" class="node">
<title>layer2_output_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="32132.45,-216.93 31901.45,-216.93 31901.45,-175.93 32132.45,-175.93 32132.45,-216.93"/>
<text text-anchor="middle" x="32016.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="32016.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer2</text>
<text text-anchor="middle" x="32016.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_qkv_gpu7 -->
<g id="node127" class="node">
<title>layer2_qkv_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="32381.45,-216.93 32150.45,-216.93 32150.45,-175.93 32381.45,-175.93 32381.45,-216.93"/>
<text text-anchor="middle" x="32265.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="32265.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer2</text>
<text text-anchor="middle" x="32265.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_attn_gpu7 -->
<g id="node128" class="node">
<title>layer2_attn_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="32630.45,-216.93 32399.45,-216.93 32399.45,-175.93 32630.45,-175.93 32630.45,-216.93"/>
<text text-anchor="middle" x="32514.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="32514.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer2</text>
<text text-anchor="middle" x="32514.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_output_gpu7 -->
<g id="node129" class="node">
<title>layer2_output_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="32879.45,-216.93 32648.45,-216.93 32648.45,-175.93 32879.45,-175.93 32879.45,-216.93"/>
<text text-anchor="middle" x="32763.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="32763.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer2</text>
<text text-anchor="middle" x="32763.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_attn_allreduce -->
<g id="node130" class="node">
<title>layer2_attn_allreduce</title>
<path fill="#e8fde8" stroke="black" d="M33400.18,-237.43C33400.18,-237.43 33014.98,-237.43 33014.98,-237.43 33008.98,-237.43 32998.25,-233.74 32993.52,-230.05 32993.52,-230.05 32907.19,-162.8 32907.19,-162.8 32902.45,-159.11 32903.72,-155.43 32909.72,-155.43 32909.72,-155.43 33294.91,-155.43 33294.91,-155.43 33300.91,-155.43 33311.65,-159.11 33316.38,-162.8 33316.38,-162.8 33402.71,-230.05 33402.71,-230.05 33407.44,-233.74 33406.18,-237.43 33400.18,-237.43"/>
<text text-anchor="middle" x="33154.95" y="-204.93" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="33154.95" y="-193.93" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="33154.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: 8×[1024,2048,512], Output: [1024,2048,4096]]</text>
</g>
<!-- layer2_moe_qkv_gpu0 -->
<g id="node131" class="node">
<title>layer2_moe_qkv_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="33661.45,-216.93 33430.45,-216.93 33430.45,-175.93 33661.45,-175.93 33661.45,-216.93"/>
<text text-anchor="middle" x="33545.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="33545.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer2</text>
<text text-anchor="middle" x="33545.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_experts_gpu0 -->
<g id="node132" class="node">
<title>layer2_moe_experts_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="33910.45,-216.93 33679.45,-216.93 33679.45,-175.93 33910.45,-175.93 33910.45,-216.93"/>
<text text-anchor="middle" x="33794.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="33794.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer2</text>
<text text-anchor="middle" x="33794.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_output_gpu0 -->
<g id="node133" class="node">
<title>layer2_moe_output_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="34159.45,-216.93 33928.45,-216.93 33928.45,-175.93 34159.45,-175.93 34159.45,-216.93"/>
<text text-anchor="middle" x="34043.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="34043.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer2</text>
<text text-anchor="middle" x="34043.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_qkv_gpu1 -->
<g id="node134" class="node">
<title>layer2_moe_qkv_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="34408.45,-216.93 34177.45,-216.93 34177.45,-175.93 34408.45,-175.93 34408.45,-216.93"/>
<text text-anchor="middle" x="34292.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="34292.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer2</text>
<text text-anchor="middle" x="34292.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_experts_gpu1 -->
<g id="node135" class="node">
<title>layer2_moe_experts_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="34657.45,-216.93 34426.45,-216.93 34426.45,-175.93 34657.45,-175.93 34657.45,-216.93"/>
<text text-anchor="middle" x="34541.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="34541.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer2</text>
<text text-anchor="middle" x="34541.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_output_gpu1 -->
<g id="node136" class="node">
<title>layer2_moe_output_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="34906.45,-216.93 34675.45,-216.93 34675.45,-175.93 34906.45,-175.93 34906.45,-216.93"/>
<text text-anchor="middle" x="34790.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="34790.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer2</text>
<text text-anchor="middle" x="34790.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_qkv_gpu2 -->
<g id="node137" class="node">
<title>layer2_moe_qkv_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="35155.45,-216.93 34924.45,-216.93 34924.45,-175.93 35155.45,-175.93 35155.45,-216.93"/>
<text text-anchor="middle" x="35039.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="35039.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer2</text>
<text text-anchor="middle" x="35039.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_experts_gpu2 -->
<g id="node138" class="node">
<title>layer2_moe_experts_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="35404.45,-216.93 35173.45,-216.93 35173.45,-175.93 35404.45,-175.93 35404.45,-216.93"/>
<text text-anchor="middle" x="35288.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="35288.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer2</text>
<text text-anchor="middle" x="35288.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_output_gpu2 -->
<g id="node139" class="node">
<title>layer2_moe_output_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="35653.45,-216.93 35422.45,-216.93 35422.45,-175.93 35653.45,-175.93 35653.45,-216.93"/>
<text text-anchor="middle" x="35537.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="35537.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer2</text>
<text text-anchor="middle" x="35537.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_qkv_gpu3 -->
<g id="node140" class="node">
<title>layer2_moe_qkv_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="35902.45,-216.93 35671.45,-216.93 35671.45,-175.93 35902.45,-175.93 35902.45,-216.93"/>
<text text-anchor="middle" x="35786.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="35786.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer2</text>
<text text-anchor="middle" x="35786.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_experts_gpu3 -->
<g id="node141" class="node">
<title>layer2_moe_experts_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="36151.45,-216.93 35920.45,-216.93 35920.45,-175.93 36151.45,-175.93 36151.45,-216.93"/>
<text text-anchor="middle" x="36035.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="36035.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer2</text>
<text text-anchor="middle" x="36035.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_output_gpu3 -->
<g id="node142" class="node">
<title>layer2_moe_output_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="36400.45,-216.93 36169.45,-216.93 36169.45,-175.93 36400.45,-175.93 36400.45,-216.93"/>
<text text-anchor="middle" x="36284.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="36284.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer2</text>
<text text-anchor="middle" x="36284.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_qkv_gpu4 -->
<g id="node143" class="node">
<title>layer2_moe_qkv_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="36649.45,-216.93 36418.45,-216.93 36418.45,-175.93 36649.45,-175.93 36649.45,-216.93"/>
<text text-anchor="middle" x="36533.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="36533.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer2</text>
<text text-anchor="middle" x="36533.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_experts_gpu4 -->
<g id="node144" class="node">
<title>layer2_moe_experts_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="36898.45,-216.93 36667.45,-216.93 36667.45,-175.93 36898.45,-175.93 36898.45,-216.93"/>
<text text-anchor="middle" x="36782.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="36782.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer2</text>
<text text-anchor="middle" x="36782.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_output_gpu4 -->
<g id="node145" class="node">
<title>layer2_moe_output_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="37147.45,-216.93 36916.45,-216.93 36916.45,-175.93 37147.45,-175.93 37147.45,-216.93"/>
<text text-anchor="middle" x="37031.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="37031.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer2</text>
<text text-anchor="middle" x="37031.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_qkv_gpu5 -->
<g id="node146" class="node">
<title>layer2_moe_qkv_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="37396.45,-216.93 37165.45,-216.93 37165.45,-175.93 37396.45,-175.93 37396.45,-216.93"/>
<text text-anchor="middle" x="37280.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="37280.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer2</text>
<text text-anchor="middle" x="37280.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_experts_gpu5 -->
<g id="node147" class="node">
<title>layer2_moe_experts_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="37645.45,-216.93 37414.45,-216.93 37414.45,-175.93 37645.45,-175.93 37645.45,-216.93"/>
<text text-anchor="middle" x="37529.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="37529.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer2</text>
<text text-anchor="middle" x="37529.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_output_gpu5 -->
<g id="node148" class="node">
<title>layer2_moe_output_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="37894.45,-216.93 37663.45,-216.93 37663.45,-175.93 37894.45,-175.93 37894.45,-216.93"/>
<text text-anchor="middle" x="37778.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="37778.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer2</text>
<text text-anchor="middle" x="37778.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_qkv_gpu6 -->
<g id="node149" class="node">
<title>layer2_moe_qkv_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="38143.45,-216.93 37912.45,-216.93 37912.45,-175.93 38143.45,-175.93 38143.45,-216.93"/>
<text text-anchor="middle" x="38027.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="38027.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer2</text>
<text text-anchor="middle" x="38027.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_experts_gpu6 -->
<g id="node150" class="node">
<title>layer2_moe_experts_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="38392.45,-216.93 38161.45,-216.93 38161.45,-175.93 38392.45,-175.93 38392.45,-216.93"/>
<text text-anchor="middle" x="38276.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="38276.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer2</text>
<text text-anchor="middle" x="38276.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_output_gpu6 -->
<g id="node151" class="node">
<title>layer2_moe_output_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="38641.45,-216.93 38410.45,-216.93 38410.45,-175.93 38641.45,-175.93 38641.45,-216.93"/>
<text text-anchor="middle" x="38525.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="38525.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer2</text>
<text text-anchor="middle" x="38525.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_qkv_gpu7 -->
<g id="node152" class="node">
<title>layer2_moe_qkv_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="38890.45,-216.93 38659.45,-216.93 38659.45,-175.93 38890.45,-175.93 38890.45,-216.93"/>
<text text-anchor="middle" x="38774.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="38774.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer2</text>
<text text-anchor="middle" x="38774.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_experts_gpu7 -->
<g id="node153" class="node">
<title>layer2_moe_experts_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="39139.45,-216.93 38908.45,-216.93 38908.45,-175.93 39139.45,-175.93 39139.45,-216.93"/>
<text text-anchor="middle" x="39023.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="39023.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer2</text>
<text text-anchor="middle" x="39023.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_output_gpu7 -->
<g id="node154" class="node">
<title>layer2_moe_output_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="39388.45,-216.93 39157.45,-216.93 39157.45,-175.93 39388.45,-175.93 39388.45,-216.93"/>
<text text-anchor="middle" x="39272.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="39272.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer2</text>
<text text-anchor="middle" x="39272.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer2_moe_allreduce -->
<g id="node155" class="node">
<title>layer2_moe_allreduce</title>
<path fill="#e8fde8" stroke="black" d="M39909.18,-237.43C39909.18,-237.43 39523.98,-237.43 39523.98,-237.43 39517.98,-237.43 39507.25,-233.74 39502.52,-230.05 39502.52,-230.05 39416.19,-162.8 39416.19,-162.8 39411.45,-159.11 39412.72,-155.43 39418.72,-155.43 39418.72,-155.43 39803.91,-155.43 39803.91,-155.43 39809.91,-155.43 39820.65,-159.11 39825.38,-162.8 39825.38,-162.8 39911.71,-230.05 39911.71,-230.05 39916.44,-233.74 39915.18,-237.43 39909.18,-237.43"/>
<text text-anchor="middle" x="39663.95" y="-204.93" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="39663.95" y="-193.93" font-family="Arial" font-size="10.00">MoE All&#45;Reduce</text>
<text text-anchor="middle" x="39663.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: 8×[1024,2048,512], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_norm1 -->
<g id="node156" class="node">
<title>layer3_norm1</title>
<polygon fill="#e8f4fd" stroke="black" points="40180.95,-216.93 39938.95,-216.93 39938.95,-175.93 40180.95,-175.93 40180.95,-216.93"/>
<text text-anchor="middle" x="40059.95" y="-204.93" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="40059.95" y="-193.93" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="40059.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,4096], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_qkv_gpu0 -->
<g id="node157" class="node">
<title>layer3_qkv_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="40430.45,-216.93 40199.45,-216.93 40199.45,-175.93 40430.45,-175.93 40430.45,-216.93"/>
<text text-anchor="middle" x="40314.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="40314.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer3</text>
<text text-anchor="middle" x="40314.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_attn_gpu0 -->
<g id="node158" class="node">
<title>layer3_attn_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="40679.45,-216.93 40448.45,-216.93 40448.45,-175.93 40679.45,-175.93 40679.45,-216.93"/>
<text text-anchor="middle" x="40563.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="40563.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer3</text>
<text text-anchor="middle" x="40563.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_output_gpu0 -->
<g id="node159" class="node">
<title>layer3_output_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="40928.45,-216.93 40697.45,-216.93 40697.45,-175.93 40928.45,-175.93 40928.45,-216.93"/>
<text text-anchor="middle" x="40812.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="40812.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer3</text>
<text text-anchor="middle" x="40812.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_qkv_gpu1 -->
<g id="node160" class="node">
<title>layer3_qkv_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="41177.45,-216.93 40946.45,-216.93 40946.45,-175.93 41177.45,-175.93 41177.45,-216.93"/>
<text text-anchor="middle" x="41061.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="41061.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer3</text>
<text text-anchor="middle" x="41061.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_attn_gpu1 -->
<g id="node161" class="node">
<title>layer3_attn_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="41426.45,-216.93 41195.45,-216.93 41195.45,-175.93 41426.45,-175.93 41426.45,-216.93"/>
<text text-anchor="middle" x="41310.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="41310.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer3</text>
<text text-anchor="middle" x="41310.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_output_gpu1 -->
<g id="node162" class="node">
<title>layer3_output_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="41675.45,-216.93 41444.45,-216.93 41444.45,-175.93 41675.45,-175.93 41675.45,-216.93"/>
<text text-anchor="middle" x="41559.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="41559.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer3</text>
<text text-anchor="middle" x="41559.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_qkv_gpu2 -->
<g id="node163" class="node">
<title>layer3_qkv_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="41924.45,-216.93 41693.45,-216.93 41693.45,-175.93 41924.45,-175.93 41924.45,-216.93"/>
<text text-anchor="middle" x="41808.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="41808.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer3</text>
<text text-anchor="middle" x="41808.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_attn_gpu2 -->
<g id="node164" class="node">
<title>layer3_attn_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="42173.45,-216.93 41942.45,-216.93 41942.45,-175.93 42173.45,-175.93 42173.45,-216.93"/>
<text text-anchor="middle" x="42057.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="42057.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer3</text>
<text text-anchor="middle" x="42057.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_output_gpu2 -->
<g id="node165" class="node">
<title>layer3_output_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="42422.45,-216.93 42191.45,-216.93 42191.45,-175.93 42422.45,-175.93 42422.45,-216.93"/>
<text text-anchor="middle" x="42306.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="42306.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer3</text>
<text text-anchor="middle" x="42306.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_qkv_gpu3 -->
<g id="node166" class="node">
<title>layer3_qkv_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="42671.45,-216.93 42440.45,-216.93 42440.45,-175.93 42671.45,-175.93 42671.45,-216.93"/>
<text text-anchor="middle" x="42555.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="42555.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer3</text>
<text text-anchor="middle" x="42555.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_attn_gpu3 -->
<g id="node167" class="node">
<title>layer3_attn_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="42920.45,-216.93 42689.45,-216.93 42689.45,-175.93 42920.45,-175.93 42920.45,-216.93"/>
<text text-anchor="middle" x="42804.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="42804.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer3</text>
<text text-anchor="middle" x="42804.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_output_gpu3 -->
<g id="node168" class="node">
<title>layer3_output_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="43169.45,-216.93 42938.45,-216.93 42938.45,-175.93 43169.45,-175.93 43169.45,-216.93"/>
<text text-anchor="middle" x="43053.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="43053.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer3</text>
<text text-anchor="middle" x="43053.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_qkv_gpu4 -->
<g id="node169" class="node">
<title>layer3_qkv_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="43418.45,-216.93 43187.45,-216.93 43187.45,-175.93 43418.45,-175.93 43418.45,-216.93"/>
<text text-anchor="middle" x="43302.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="43302.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer3</text>
<text text-anchor="middle" x="43302.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_attn_gpu4 -->
<g id="node170" class="node">
<title>layer3_attn_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="43667.45,-216.93 43436.45,-216.93 43436.45,-175.93 43667.45,-175.93 43667.45,-216.93"/>
<text text-anchor="middle" x="43551.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="43551.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer3</text>
<text text-anchor="middle" x="43551.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_output_gpu4 -->
<g id="node171" class="node">
<title>layer3_output_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="43916.45,-216.93 43685.45,-216.93 43685.45,-175.93 43916.45,-175.93 43916.45,-216.93"/>
<text text-anchor="middle" x="43800.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="43800.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer3</text>
<text text-anchor="middle" x="43800.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_qkv_gpu5 -->
<g id="node172" class="node">
<title>layer3_qkv_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="44165.45,-216.93 43934.45,-216.93 43934.45,-175.93 44165.45,-175.93 44165.45,-216.93"/>
<text text-anchor="middle" x="44049.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="44049.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer3</text>
<text text-anchor="middle" x="44049.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_attn_gpu5 -->
<g id="node173" class="node">
<title>layer3_attn_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="44414.45,-216.93 44183.45,-216.93 44183.45,-175.93 44414.45,-175.93 44414.45,-216.93"/>
<text text-anchor="middle" x="44298.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="44298.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer3</text>
<text text-anchor="middle" x="44298.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_output_gpu5 -->
<g id="node174" class="node">
<title>layer3_output_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="44663.45,-216.93 44432.45,-216.93 44432.45,-175.93 44663.45,-175.93 44663.45,-216.93"/>
<text text-anchor="middle" x="44547.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="44547.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer3</text>
<text text-anchor="middle" x="44547.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_qkv_gpu6 -->
<g id="node175" class="node">
<title>layer3_qkv_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="44912.45,-216.93 44681.45,-216.93 44681.45,-175.93 44912.45,-175.93 44912.45,-216.93"/>
<text text-anchor="middle" x="44796.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="44796.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer3</text>
<text text-anchor="middle" x="44796.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_attn_gpu6 -->
<g id="node176" class="node">
<title>layer3_attn_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="45161.45,-216.93 44930.45,-216.93 44930.45,-175.93 45161.45,-175.93 45161.45,-216.93"/>
<text text-anchor="middle" x="45045.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="45045.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer3</text>
<text text-anchor="middle" x="45045.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_output_gpu6 -->
<g id="node177" class="node">
<title>layer3_output_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="45410.45,-216.93 45179.45,-216.93 45179.45,-175.93 45410.45,-175.93 45410.45,-216.93"/>
<text text-anchor="middle" x="45294.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="45294.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer3</text>
<text text-anchor="middle" x="45294.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_qkv_gpu7 -->
<g id="node178" class="node">
<title>layer3_qkv_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="45659.45,-216.93 45428.45,-216.93 45428.45,-175.93 45659.45,-175.93 45659.45,-216.93"/>
<text text-anchor="middle" x="45543.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="45543.95" y="-193.93" font-family="Arial" font-size="10.00">QKV Layer3</text>
<text text-anchor="middle" x="45543.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_attn_gpu7 -->
<g id="node179" class="node">
<title>layer3_attn_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="45908.45,-216.93 45677.45,-216.93 45677.45,-175.93 45908.45,-175.93 45908.45,-216.93"/>
<text text-anchor="middle" x="45792.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="45792.95" y="-193.93" font-family="Arial" font-size="10.00">Attn Layer3</text>
<text text-anchor="middle" x="45792.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_output_gpu7 -->
<g id="node180" class="node">
<title>layer3_output_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="46157.45,-216.93 45926.45,-216.93 45926.45,-175.93 46157.45,-175.93 46157.45,-216.93"/>
<text text-anchor="middle" x="46041.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="46041.95" y="-193.93" font-family="Arial" font-size="10.00">Output Layer3</text>
<text text-anchor="middle" x="46041.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_attn_allreduce -->
<g id="node181" class="node">
<title>layer3_attn_allreduce</title>
<path fill="#e8fde8" stroke="black" d="M46678.18,-237.43C46678.18,-237.43 46292.98,-237.43 46292.98,-237.43 46286.98,-237.43 46276.25,-233.74 46271.52,-230.05 46271.52,-230.05 46185.19,-162.8 46185.19,-162.8 46180.45,-159.11 46181.72,-155.43 46187.72,-155.43 46187.72,-155.43 46572.91,-155.43 46572.91,-155.43 46578.91,-155.43 46589.65,-159.11 46594.38,-162.8 46594.38,-162.8 46680.71,-230.05 46680.71,-230.05 46685.44,-233.74 46684.18,-237.43 46678.18,-237.43"/>
<text text-anchor="middle" x="46432.95" y="-204.93" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="46432.95" y="-193.93" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="46432.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: 8×[1024,2048,512], Output: [1024,2048,4096]]</text>
</g>
<!-- layer3_moe_qkv_gpu0 -->
<g id="node182" class="node">
<title>layer3_moe_qkv_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="46939.45,-216.93 46708.45,-216.93 46708.45,-175.93 46939.45,-175.93 46939.45,-216.93"/>
<text text-anchor="middle" x="46823.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="46823.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer3</text>
<text text-anchor="middle" x="46823.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_experts_gpu0 -->
<g id="node183" class="node">
<title>layer3_moe_experts_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="47188.45,-216.93 46957.45,-216.93 46957.45,-175.93 47188.45,-175.93 47188.45,-216.93"/>
<text text-anchor="middle" x="47072.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="47072.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer3</text>
<text text-anchor="middle" x="47072.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_output_gpu0 -->
<g id="node184" class="node">
<title>layer3_moe_output_gpu0</title>
<polygon fill="#e8f4fd" stroke="black" points="47437.45,-216.93 47206.45,-216.93 47206.45,-175.93 47437.45,-175.93 47437.45,-216.93"/>
<text text-anchor="middle" x="47321.95" y="-204.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="47321.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer3</text>
<text text-anchor="middle" x="47321.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_qkv_gpu1 -->
<g id="node185" class="node">
<title>layer3_moe_qkv_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="47686.45,-216.93 47455.45,-216.93 47455.45,-175.93 47686.45,-175.93 47686.45,-216.93"/>
<text text-anchor="middle" x="47570.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="47570.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer3</text>
<text text-anchor="middle" x="47570.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_experts_gpu1 -->
<g id="node186" class="node">
<title>layer3_moe_experts_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="47935.45,-216.93 47704.45,-216.93 47704.45,-175.93 47935.45,-175.93 47935.45,-216.93"/>
<text text-anchor="middle" x="47819.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="47819.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer3</text>
<text text-anchor="middle" x="47819.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_output_gpu1 -->
<g id="node187" class="node">
<title>layer3_moe_output_gpu1</title>
<polygon fill="#e8f4fd" stroke="black" points="48184.45,-216.93 47953.45,-216.93 47953.45,-175.93 48184.45,-175.93 48184.45,-216.93"/>
<text text-anchor="middle" x="48068.95" y="-204.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="48068.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer3</text>
<text text-anchor="middle" x="48068.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_qkv_gpu2 -->
<g id="node188" class="node">
<title>layer3_moe_qkv_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="48433.45,-216.93 48202.45,-216.93 48202.45,-175.93 48433.45,-175.93 48433.45,-216.93"/>
<text text-anchor="middle" x="48317.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="48317.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer3</text>
<text text-anchor="middle" x="48317.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_experts_gpu2 -->
<g id="node189" class="node">
<title>layer3_moe_experts_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="48682.45,-216.93 48451.45,-216.93 48451.45,-175.93 48682.45,-175.93 48682.45,-216.93"/>
<text text-anchor="middle" x="48566.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="48566.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer3</text>
<text text-anchor="middle" x="48566.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_output_gpu2 -->
<g id="node190" class="node">
<title>layer3_moe_output_gpu2</title>
<polygon fill="#e8f4fd" stroke="black" points="48931.45,-216.93 48700.45,-216.93 48700.45,-175.93 48931.45,-175.93 48931.45,-216.93"/>
<text text-anchor="middle" x="48815.95" y="-204.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="48815.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer3</text>
<text text-anchor="middle" x="48815.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_qkv_gpu3 -->
<g id="node191" class="node">
<title>layer3_moe_qkv_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="49180.45,-216.93 48949.45,-216.93 48949.45,-175.93 49180.45,-175.93 49180.45,-216.93"/>
<text text-anchor="middle" x="49064.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="49064.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer3</text>
<text text-anchor="middle" x="49064.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_experts_gpu3 -->
<g id="node192" class="node">
<title>layer3_moe_experts_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="49429.45,-216.93 49198.45,-216.93 49198.45,-175.93 49429.45,-175.93 49429.45,-216.93"/>
<text text-anchor="middle" x="49313.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="49313.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer3</text>
<text text-anchor="middle" x="49313.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_output_gpu3 -->
<g id="node193" class="node">
<title>layer3_moe_output_gpu3</title>
<polygon fill="#e8f4fd" stroke="black" points="49678.45,-216.93 49447.45,-216.93 49447.45,-175.93 49678.45,-175.93 49678.45,-216.93"/>
<text text-anchor="middle" x="49562.95" y="-204.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="49562.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer3</text>
<text text-anchor="middle" x="49562.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_qkv_gpu4 -->
<g id="node194" class="node">
<title>layer3_moe_qkv_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="49927.45,-216.93 49696.45,-216.93 49696.45,-175.93 49927.45,-175.93 49927.45,-216.93"/>
<text text-anchor="middle" x="49811.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="49811.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer3</text>
<text text-anchor="middle" x="49811.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_experts_gpu4 -->
<g id="node195" class="node">
<title>layer3_moe_experts_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="50176.45,-216.93 49945.45,-216.93 49945.45,-175.93 50176.45,-175.93 50176.45,-216.93"/>
<text text-anchor="middle" x="50060.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="50060.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer3</text>
<text text-anchor="middle" x="50060.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_output_gpu4 -->
<g id="node196" class="node">
<title>layer3_moe_output_gpu4</title>
<polygon fill="#e8f4fd" stroke="black" points="50425.45,-216.93 50194.45,-216.93 50194.45,-175.93 50425.45,-175.93 50425.45,-216.93"/>
<text text-anchor="middle" x="50309.95" y="-204.93" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="50309.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer3</text>
<text text-anchor="middle" x="50309.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_qkv_gpu5 -->
<g id="node197" class="node">
<title>layer3_moe_qkv_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="50674.45,-216.93 50443.45,-216.93 50443.45,-175.93 50674.45,-175.93 50674.45,-216.93"/>
<text text-anchor="middle" x="50558.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="50558.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer3</text>
<text text-anchor="middle" x="50558.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_experts_gpu5 -->
<g id="node198" class="node">
<title>layer3_moe_experts_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="50923.45,-216.93 50692.45,-216.93 50692.45,-175.93 50923.45,-175.93 50923.45,-216.93"/>
<text text-anchor="middle" x="50807.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="50807.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer3</text>
<text text-anchor="middle" x="50807.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_output_gpu5 -->
<g id="node199" class="node">
<title>layer3_moe_output_gpu5</title>
<polygon fill="#e8f4fd" stroke="black" points="51172.45,-216.93 50941.45,-216.93 50941.45,-175.93 51172.45,-175.93 51172.45,-216.93"/>
<text text-anchor="middle" x="51056.95" y="-204.93" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="51056.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer3</text>
<text text-anchor="middle" x="51056.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_qkv_gpu6 -->
<g id="node200" class="node">
<title>layer3_moe_qkv_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="51421.45,-216.93 51190.45,-216.93 51190.45,-175.93 51421.45,-175.93 51421.45,-216.93"/>
<text text-anchor="middle" x="51305.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="51305.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer3</text>
<text text-anchor="middle" x="51305.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_experts_gpu6 -->
<g id="node201" class="node">
<title>layer3_moe_experts_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="51670.45,-216.93 51439.45,-216.93 51439.45,-175.93 51670.45,-175.93 51670.45,-216.93"/>
<text text-anchor="middle" x="51554.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="51554.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer3</text>
<text text-anchor="middle" x="51554.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_output_gpu6 -->
<g id="node202" class="node">
<title>layer3_moe_output_gpu6</title>
<polygon fill="#e8f4fd" stroke="black" points="51919.45,-216.93 51688.45,-216.93 51688.45,-175.93 51919.45,-175.93 51919.45,-216.93"/>
<text text-anchor="middle" x="51803.95" y="-204.93" font-family="Arial" font-size="10.00">GPU6</text>
<text text-anchor="middle" x="51803.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer3</text>
<text text-anchor="middle" x="51803.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_qkv_gpu7 -->
<g id="node203" class="node">
<title>layer3_moe_qkv_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="52168.45,-216.93 51937.45,-216.93 51937.45,-175.93 52168.45,-175.93 52168.45,-216.93"/>
<text text-anchor="middle" x="52052.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="52052.95" y="-193.93" font-family="Arial" font-size="10.00">MoE QKV Layer3</text>
<text text-anchor="middle" x="52052.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_experts_gpu7 -->
<g id="node204" class="node">
<title>layer3_moe_experts_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="52417.45,-216.93 52186.45,-216.93 52186.45,-175.93 52417.45,-175.93 52417.45,-216.93"/>
<text text-anchor="middle" x="52301.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="52301.95" y="-193.93" font-family="Arial" font-size="10.00">2 Experts Layer3</text>
<text text-anchor="middle" x="52301.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_output_gpu7 -->
<g id="node205" class="node">
<title>layer3_moe_output_gpu7</title>
<polygon fill="#e8f4fd" stroke="black" points="52666.45,-216.93 52435.45,-216.93 52435.45,-175.93 52666.45,-175.93 52666.45,-216.93"/>
<text text-anchor="middle" x="52550.95" y="-204.93" font-family="Arial" font-size="10.00">GPU7</text>
<text text-anchor="middle" x="52550.95" y="-193.93" font-family="Arial" font-size="10.00">MoE Output Layer3</text>
<text text-anchor="middle" x="52550.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: [1024,2048,512], Output: [1024,2048,512]]</text>
</g>
<!-- layer3_moe_allreduce -->
<g id="node206" class="node">
<title>layer3_moe_allreduce</title>
<path fill="#e8fde8" stroke="black" d="M53187.18,-237.43C53187.18,-237.43 52801.98,-237.43 52801.98,-237.43 52795.98,-237.43 52785.25,-233.74 52780.52,-230.05 52780.52,-230.05 52694.19,-162.8 52694.19,-162.8 52689.45,-159.11 52690.72,-155.43 52696.72,-155.43 52696.72,-155.43 53081.91,-155.43 53081.91,-155.43 53087.91,-155.43 53098.65,-159.11 53103.38,-162.8 53103.38,-162.8 53189.71,-230.05 53189.71,-230.05 53194.44,-233.74 53193.18,-237.43 53187.18,-237.43"/>
<text text-anchor="middle" x="52941.95" y="-204.93" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="52941.95" y="-193.93" font-family="Arial" font-size="10.00">MoE All&#45;Reduce</text>
<text text-anchor="middle" x="52941.95" y="-182.93" font-family="Arial" font-size="10.00">[Input: 8×[1024,2048,512], Output: [1024,2048,4096]]</text>
</g>
<!-- output -->
<g id="node207" class="node">
<title>output</title>
<ellipse fill="#d0e8ff" stroke="black" cx="52941.95" cy="-98.21" rx="173.9" ry="21.43"/>
<text text-anchor="middle" x="52941.95" y="-101.21" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="52941.95" y="-90.21" font-family="Arial" font-size="10.00">[batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer3_moe_allreduce&#45;&gt;output -->
<g id="edge3" class="edge">
<title>layer3_moe_allreduce&#45;&gt;output</title>
<path fill="none" stroke="black" d="M52941.95,-155.18C52941.95,-146.66 52941.95,-137.8 52941.95,-129.71"/>
<polygon fill="black" stroke="black" points="52945.45,-129.61 52941.95,-119.61 52938.45,-129.61 52945.45,-129.61"/>
</g>
</g>
</svg>
