digraph baseline_tp8_pp2_dag {
	graph [bb="0,0,54849,704.43",
		bgcolor=white,
		compound=true,
		fontname=Arial,
		fontsize=12,
		rankdir=TB
	];
	node [fontname=Arial,
		fontsize=10,
		label="\N"
	];
	subgraph stage0 {
		graph [label="Stage 0: GPUs 0-7 (TP=8), Layers 0-1"];
		stage0_embedding	[fillcolor="#E8F4FD",
			height=0.5,
			label="Token+Pos Embedding\n[Input: [1024,2048], Output: [1024,2048,4096]]",
			pos="1588,565.21",
			shape=rectangle,
			style=filled,
			width=3.0278];
		stage0_layer0_norm1	[fillcolor="#E8F4FD",
			height=0.56944,
			label="Layer 0\nPre-Attn LayerNorm\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="1134,487.5",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_qkv_gpu0	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU0\nQKV Proj Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="118,410.5",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer0_attn_gpu0	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU0\nAttn Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="118,333.5",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage0_layer0_out_gpu0	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU0\nOutput Proj Layer0\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="118,256.5",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer0_qkv_gpu1	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU1\nQKV Proj Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="372,410.5",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer0_attn_gpu1	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU1\nAttn Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="372,333.5",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage0_layer0_out_gpu1	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU1\nOutput Proj Layer0\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="372,256.5",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer0_qkv_gpu2	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU2\nQKV Proj Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="626,410.5",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer0_attn_gpu2	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU2\nAttn Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="626,333.5",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage0_layer0_out_gpu2	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU2\nOutput Proj Layer0\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="626,256.5",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer0_qkv_gpu3	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU3\nQKV Proj Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="880,410.5",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer0_attn_gpu3	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU3\nAttn Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="880,333.5",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage0_layer0_out_gpu3	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU3\nOutput Proj Layer0\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="880,256.5",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer0_qkv_gpu4	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU4\nQKV Proj Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="1134,410.5",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer0_attn_gpu4	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU4\nAttn Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="1134,333.5",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage0_layer0_out_gpu4	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU4\nOutput Proj Layer0\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="1134,256.5",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer0_qkv_gpu5	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU5\nQKV Proj Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="1388,410.5",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer0_attn_gpu5	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU5\nAttn Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="1388,333.5",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage0_layer0_out_gpu5	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU5\nOutput Proj Layer0\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="1388,256.5",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer0_qkv_gpu6	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU6\nQKV Proj Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="1642,410.5",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer0_attn_gpu6	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU6\nAttn Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="1642,333.5",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage0_layer0_out_gpu6	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU6\nOutput Proj Layer0\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="1642,256.5",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer0_qkv_gpu7	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU7\nQKV Proj Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="1896,410.5",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer0_attn_gpu7	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU7\nAttn Layer0\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="1896,333.5",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage0_layer0_out_gpu7	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU7\nOutput Proj Layer0\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="1896,256.5",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer0_attn_allreduce	[fillcolor="#E8FDE8",
			height=1.1389,
			label="Layer 0\nAttention All-Reduce\n[Input: 8×[1024,2048,4096], Output: [1024,2048,4096]]",
			pos="1134,159",
			shape=parallelogram,
			style="filled,rounded",
			width=7.2861];
		stage0_layer0_residual1	[fillcolor="#E8FDE8",
			height=1.1389,
			label="Layer 0\nResidual Add\n[Input: 2×[1024,2048,4096], Output: [1024,2048,4096]]",
			pos="1588,41",
			shape=parallelogram,
			style="filled,rounded",
			width=7.2861];
		stage0_layer0_norm2	[fillcolor="#E8F4FD",
			height=0.56944,
			label="Layer 0\nPre-MoE LayerNorm\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="1901,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_qkv_gpu0	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU0\nMoE QKV Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="2161,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_experts_gpu0	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU0\n2 Experts Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="2421,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_out_gpu0	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU0\nMoE Output Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="2681,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_qkv_gpu1	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU1\nMoE QKV Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="2941,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_experts_gpu1	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU1\n2 Experts Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="3201,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_out_gpu1	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU1\nMoE Output Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="3461,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_qkv_gpu2	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU2\nMoE QKV Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="3721,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_experts_gpu2	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU2\n2 Experts Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="3981,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_out_gpu2	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU2\nMoE Output Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="4241,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_qkv_gpu3	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU3\nMoE QKV Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="4501,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_experts_gpu3	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU3\n2 Experts Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="4761,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_out_gpu3	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU3\nMoE Output Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="5021,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_qkv_gpu4	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU4\nMoE QKV Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="5281,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_experts_gpu4	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU4\n2 Experts Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="5541,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_out_gpu4	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU4\nMoE Output Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="5801,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_qkv_gpu5	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU5\nMoE QKV Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="6061,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_experts_gpu5	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU5\n2 Experts Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="6321,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_out_gpu5	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU5\nMoE Output Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="6581,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_qkv_gpu6	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU6\nMoE QKV Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="6841,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_experts_gpu6	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU6\n2 Experts Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="7101,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_out_gpu6	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU6\nMoE Output Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="7361,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_qkv_gpu7	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU7\nMoE QKV Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="7621,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_experts_gpu7	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU7\n2 Experts Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="7881,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_out_gpu7	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU7\nMoE Output Layer0\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="8141,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer0_moe_allreduce	[fillcolor="#E8FDE8",
			height=1.1389,
			label="Layer 0\nMoE All-Reduce\n[Input: 8×[1024,2048,4096], Output: [1024,2048,4096]]",
			pos="8542,663.43",
			shape=parallelogram,
			style="filled,rounded",
			width=7.2861];
		stage0_layer0_residual2	[fillcolor="#E8FDE8",
			height=1.1389,
			label="Layer 0\nResidual Add\n[Input: 2×[1024,2048,4096], Output: [1024,2048,4096]]",
			pos="9085,663.43",
			shape=parallelogram,
			style="filled,rounded",
			width=7.2861];
		stage0_layer1_norm1	[fillcolor="#E8F4FD",
			height=0.56944,
			label="Layer 1\nPre-Attn LayerNorm\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="9486,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_qkv_gpu0	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU0\nQKV Proj Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="9743,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer1_attn_gpu0	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU0\nAttn Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="9995,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage0_layer1_out_gpu0	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU0\nOutput Proj Layer1\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="10247,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer1_qkv_gpu1	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU1\nQKV Proj Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="10501,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer1_attn_gpu1	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU1\nAttn Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="10753,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage0_layer1_out_gpu1	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU1\nOutput Proj Layer1\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="11005,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer1_qkv_gpu2	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU2\nQKV Proj Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="11259,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer1_attn_gpu2	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU2\nAttn Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="11511,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage0_layer1_out_gpu2	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU2\nOutput Proj Layer1\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="11763,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer1_qkv_gpu3	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU3\nQKV Proj Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="12017,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer1_attn_gpu3	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU3\nAttn Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="12269,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage0_layer1_out_gpu3	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU3\nOutput Proj Layer1\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="12521,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer1_qkv_gpu4	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU4\nQKV Proj Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="12775,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer1_attn_gpu4	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU4\nAttn Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="13027,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage0_layer1_out_gpu4	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU4\nOutput Proj Layer1\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="13279,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer1_qkv_gpu5	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU5\nQKV Proj Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="13533,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer1_attn_gpu5	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU5\nAttn Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="13785,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage0_layer1_out_gpu5	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU5\nOutput Proj Layer1\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="14037,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer1_qkv_gpu6	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU6\nQKV Proj Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="14291,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer1_attn_gpu6	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU6\nAttn Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="14543,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage0_layer1_out_gpu6	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU6\nOutput Proj Layer1\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="14795,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer1_qkv_gpu7	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU7\nQKV Proj Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="15049,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer1_attn_gpu7	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU7\nAttn Layer1\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="15301,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage0_layer1_out_gpu7	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU7\nOutput Proj Layer1\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="15553,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage0_layer1_attn_allreduce	[fillcolor="#E8FDE8",
			height=1.1389,
			label="Layer 1\nAttention All-Reduce\n[Input: 8×[1024,2048,4096], Output: [1024,2048,4096]]",
			pos="15951,663.43",
			shape=parallelogram,
			style="filled,rounded",
			width=7.2861];
		stage0_layer1_residual1	[fillcolor="#E8FDE8",
			height=1.1389,
			label="Layer 1\nResidual Add\n[Input: 2×[1024,2048,4096], Output: [1024,2048,4096]]",
			pos="16494,663.43",
			shape=parallelogram,
			style="filled,rounded",
			width=7.2861];
		stage0_layer1_norm2	[fillcolor="#E8F4FD",
			height=0.56944,
			label="Layer 1\nPre-MoE LayerNorm\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="16895,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_qkv_gpu0	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU0\nMoE QKV Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="17155,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_experts_gpu0	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU0\n2 Experts Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="17415,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_out_gpu0	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU0\nMoE Output Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="17675,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_qkv_gpu1	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU1\nMoE QKV Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="17935,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_experts_gpu1	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU1\n2 Experts Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="18195,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_out_gpu1	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU1\nMoE Output Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="18455,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_qkv_gpu2	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU2\nMoE QKV Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="18715,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_experts_gpu2	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU2\n2 Experts Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="18975,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_out_gpu2	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU2\nMoE Output Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="19235,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_qkv_gpu3	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU3\nMoE QKV Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="19495,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_experts_gpu3	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU3\n2 Experts Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="19755,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_out_gpu3	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU3\nMoE Output Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="20015,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_qkv_gpu4	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU4\nMoE QKV Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="20275,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_experts_gpu4	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU4\n2 Experts Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="20535,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_out_gpu4	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU4\nMoE Output Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="20795,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_qkv_gpu5	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU5\nMoE QKV Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="21055,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_experts_gpu5	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU5\n2 Experts Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="21315,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_out_gpu5	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU5\nMoE Output Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="21575,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_qkv_gpu6	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU6\nMoE QKV Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="21835,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_experts_gpu6	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU6\n2 Experts Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="22095,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_out_gpu6	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU6\nMoE Output Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="22355,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_qkv_gpu7	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU7\nMoE QKV Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="22615,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_experts_gpu7	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU7\n2 Experts Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="22875,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_out_gpu7	[fillcolor="#E8F4FD",
			height=0.56944,
			label="GPU7\nMoE Output Layer1\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="23135,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage0_layer1_moe_allreduce	[fillcolor="#E8FDE8",
			height=1.1389,
			label="Layer 1\nMoE All-Reduce\n[Input: 8×[1024,2048,4096], Output: [1024,2048,4096]]",
			pos="23536,663.43",
			shape=parallelogram,
			style="filled,rounded",
			width=7.2861];
		stage0_layer1_residual2	[fillcolor="#E8FDE8",
			height=1.1389,
			label="Layer 1\nResidual Add\n[Input: 2×[1024,2048,4096], Output: [1024,2048,4096]]",
			pos="24079,663.43",
			shape=parallelogram,
			style="filled,rounded",
			width=7.2861];
	}
	subgraph stage1 {
		graph [label="Stage 1: GPUs 8-15 (TP=8), Layers 2-3"];
		stage1_layer2_norm1	[fillcolor="#FDE8E8",
			height=0.56944,
			label="Layer 2\nPre-Attn LayerNorm\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="25000,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_qkv_gpu8	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU8\nQKV Proj Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="25257,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer2_attn_gpu8	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU8\nAttn Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="25509,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage1_layer2_out_gpu8	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU8\nOutput Proj Layer2\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="25761,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer2_qkv_gpu9	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU9\nQKV Proj Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="26015,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer2_attn_gpu9	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU9\nAttn Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="26267,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage1_layer2_out_gpu9	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU9\nOutput Proj Layer2\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="26519,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer2_qkv_gpu10	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU10\nQKV Proj Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="26773,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer2_attn_gpu10	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU10\nAttn Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="27025,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage1_layer2_out_gpu10	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU10\nOutput Proj Layer2\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="27277,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer2_qkv_gpu11	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU11\nQKV Proj Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="27531,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer2_attn_gpu11	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU11\nAttn Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="27783,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage1_layer2_out_gpu11	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU11\nOutput Proj Layer2\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="28035,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer2_qkv_gpu12	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU12\nQKV Proj Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="28289,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer2_attn_gpu12	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU12\nAttn Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="28541,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage1_layer2_out_gpu12	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU12\nOutput Proj Layer2\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="28793,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer2_qkv_gpu13	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU13\nQKV Proj Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="29047,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer2_attn_gpu13	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU13\nAttn Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="29299,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage1_layer2_out_gpu13	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU13\nOutput Proj Layer2\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="29551,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer2_qkv_gpu14	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU14\nQKV Proj Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="29805,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer2_attn_gpu14	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU14\nAttn Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="30057,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage1_layer2_out_gpu14	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU14\nOutput Proj Layer2\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="30309,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer2_qkv_gpu15	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU15\nQKV Proj Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="30563,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer2_attn_gpu15	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU15\nAttn Layer2\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="30815,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage1_layer2_out_gpu15	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU15\nOutput Proj Layer2\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="31067,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer2_attn_allreduce	[fillcolor="#E8FDE8",
			height=1.1389,
			label="Layer 2\nAttention All-Reduce\n[Input: 8×[1024,2048,4096], Output: [1024,2048,4096]]",
			pos="31465,663.43",
			shape=parallelogram,
			style="filled,rounded",
			width=7.2861];
		stage1_layer2_residual1	[fillcolor="#E8FDE8",
			height=1.1389,
			label="Layer 2\nResidual Add\n[Input: 2×[1024,2048,4096], Output: [1024,2048,4096]]",
			pos="32008,663.43",
			shape=parallelogram,
			style="filled,rounded",
			width=7.2861];
		stage1_layer2_norm2	[fillcolor="#FDE8E8",
			height=0.56944,
			label="Layer 2\nPre-MoE LayerNorm\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="32409,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_qkv_gpu8	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU8\nMoE QKV Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="32669,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_experts_gpu8	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU8\n2 Experts Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="32929,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_out_gpu8	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU8\nMoE Output Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="33189,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_qkv_gpu9	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU9\nMoE QKV Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="33449,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_experts_gpu9	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU9\n2 Experts Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="33709,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_out_gpu9	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU9\nMoE Output Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="33969,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_qkv_gpu10	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU10\nMoE QKV Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="34229,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_experts_gpu10	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU10\n2 Experts Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="34489,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_out_gpu10	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU10\nMoE Output Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="34749,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_qkv_gpu11	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU11\nMoE QKV Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="35009,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_experts_gpu11	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU11\n2 Experts Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="35269,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_out_gpu11	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU11\nMoE Output Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="35529,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_qkv_gpu12	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU12\nMoE QKV Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="35789,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_experts_gpu12	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU12\n2 Experts Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="36049,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_out_gpu12	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU12\nMoE Output Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="36309,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_qkv_gpu13	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU13\nMoE QKV Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="36569,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_experts_gpu13	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU13\n2 Experts Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="36829,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_out_gpu13	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU13\nMoE Output Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="37089,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_qkv_gpu14	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU14\nMoE QKV Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="37349,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_experts_gpu14	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU14\n2 Experts Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="37609,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_out_gpu14	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU14\nMoE Output Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="37869,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_qkv_gpu15	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU15\nMoE QKV Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="38129,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_experts_gpu15	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU15\n2 Experts Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="38389,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_out_gpu15	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU15\nMoE Output Layer2\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="38649,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer2_moe_allreduce	[fillcolor="#E8FDE8",
			height=1.1389,
			label="Layer 2\nMoE All-Reduce\n[Input: 8×[1024,2048,4096], Output: [1024,2048,4096]]",
			pos="39050,663.43",
			shape=parallelogram,
			style="filled,rounded",
			width=7.2861];
		stage1_layer2_residual2	[fillcolor="#E8FDE8",
			height=1.1389,
			label="Layer 2\nResidual Add\n[Input: 2×[1024,2048,4096], Output: [1024,2048,4096]]",
			pos="39593,663.43",
			shape=parallelogram,
			style="filled,rounded",
			width=7.2861];
		stage1_layer3_norm1	[fillcolor="#FDE8E8",
			height=0.56944,
			label="Layer 3\nPre-Attn LayerNorm\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="39994,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_qkv_gpu8	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU8\nQKV Proj Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="40251,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer3_attn_gpu8	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU8\nAttn Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="40503,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage1_layer3_out_gpu8	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU8\nOutput Proj Layer3\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="40755,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer3_qkv_gpu9	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU9\nQKV Proj Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="41009,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer3_attn_gpu9	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU9\nAttn Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="41261,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage1_layer3_out_gpu9	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU9\nOutput Proj Layer3\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="41513,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer3_qkv_gpu10	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU10\nQKV Proj Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="41767,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer3_attn_gpu10	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU10\nAttn Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="42019,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage1_layer3_out_gpu10	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU10\nOutput Proj Layer3\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="42271,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer3_qkv_gpu11	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU11\nQKV Proj Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="42525,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer3_attn_gpu11	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU11\nAttn Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="42777,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage1_layer3_out_gpu11	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU11\nOutput Proj Layer3\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="43029,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer3_qkv_gpu12	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU12\nQKV Proj Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="43283,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer3_attn_gpu12	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU12\nAttn Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="43535,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage1_layer3_out_gpu12	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU12\nOutput Proj Layer3\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="43787,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer3_qkv_gpu13	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU13\nQKV Proj Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="44041,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer3_attn_gpu13	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU13\nAttn Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="44293,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage1_layer3_out_gpu13	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU13\nOutput Proj Layer3\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="44545,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer3_qkv_gpu14	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU14\nQKV Proj Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="44799,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer3_attn_gpu14	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU14\nAttn Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="45051,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage1_layer3_out_gpu14	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU14\nOutput Proj Layer3\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="45303,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer3_qkv_gpu15	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU15\nQKV Proj Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,512]]",
			pos="45557,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer3_attn_gpu15	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU15\nAttn Layer3\n[Input: [1024,2048,512], Output: [1024,2048,512]]",
			pos="45809,663.43",
			shape=rectangle,
			style=filled,
			width=3.2083];
		stage1_layer3_out_gpu15	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU15\nOutput Proj Layer3\n[Input: [1024,2048,512], Output: [1024,2048,4096]]",
			pos="46061,663.43",
			shape=rectangle,
			style=filled,
			width=3.2778];
		stage1_layer3_attn_allreduce	[fillcolor="#E8FDE8",
			height=1.1389,
			label="Layer 3\nAttention All-Reduce\n[Input: 8×[1024,2048,4096], Output: [1024,2048,4096]]",
			pos="46459,663.43",
			shape=parallelogram,
			style="filled,rounded",
			width=7.2861];
		stage1_layer3_residual1	[fillcolor="#E8FDE8",
			height=1.1389,
			label="Layer 3\nResidual Add\n[Input: 2×[1024,2048,4096], Output: [1024,2048,4096]]",
			pos="47002,663.43",
			shape=parallelogram,
			style="filled,rounded",
			width=7.2861];
		stage1_layer3_norm2	[fillcolor="#FDE8E8",
			height=0.56944,
			label="Layer 3\nPre-MoE LayerNorm\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="47403,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_qkv_gpu8	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU8\nMoE QKV Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="47663,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_experts_gpu8	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU8\n2 Experts Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="47923,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_out_gpu8	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU8\nMoE Output Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="48183,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_qkv_gpu9	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU9\nMoE QKV Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="48443,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_experts_gpu9	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU9\n2 Experts Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="48703,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_out_gpu9	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU9\nMoE Output Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="48963,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_qkv_gpu10	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU10\nMoE QKV Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="49223,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_experts_gpu10	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU10\n2 Experts Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="49483,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_out_gpu10	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU10\nMoE Output Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="49743,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_qkv_gpu11	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU11\nMoE QKV Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="50003,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_experts_gpu11	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU11\n2 Experts Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="50263,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_out_gpu11	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU11\nMoE Output Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="50523,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_qkv_gpu12	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU12\nMoE QKV Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="50783,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_experts_gpu12	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU12\n2 Experts Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="51043,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_out_gpu12	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU12\nMoE Output Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="51303,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_qkv_gpu13	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU13\nMoE QKV Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="51563,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_experts_gpu13	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU13\n2 Experts Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="51823,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_out_gpu13	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU13\nMoE Output Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="52083,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_qkv_gpu14	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU14\nMoE QKV Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="52343,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_experts_gpu14	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU14\n2 Experts Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="52603,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_out_gpu14	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU14\nMoE Output Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="52863,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_qkv_gpu15	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU15\nMoE QKV Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="53123,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_experts_gpu15	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU15\n2 Experts Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="53383,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_out_gpu15	[fillcolor="#FDE8E8",
			height=0.56944,
			label="GPU15\nMoE Output Layer3\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
			pos="53643,663.43",
			shape=rectangle,
			style=filled,
			width=3.3611];
		stage1_layer3_moe_allreduce	[fillcolor="#E8FDE8",
			height=1.1389,
			label="Layer 3\nMoE All-Reduce\n[Input: 8×[1024,2048,4096], Output: [1024,2048,4096]]",
			pos="54044,663.43",
			shape=parallelogram,
			style="filled,rounded",
			width=7.2861];
		stage1_layer3_residual2	[fillcolor="#E8FDE8",
			height=1.1389,
			label="Layer 3\nResidual Add\n[Input: 2×[1024,2048,4096], Output: [1024,2048,4096]]",
			pos="54587,663.43",
			shape=parallelogram,
			style="filled,rounded",
			width=7.2861];
	}
	input	[fillcolor="#D0E8FF",
		height=0.58926,
		label="Input\n[batch_size=1024, seq_len=2048, hidden_dim=4096]",
		pos="1588,663.43",
		shape=ellipse,
		style=filled,
		width=4.8319];
	input -> stage0_embedding	[pos="e,1588,583.37 1588,642.02 1588,627.86 1588,608.84 1588,593.39"];
	stage0_embedding -> stage0_layer0_norm1	[pos="e,1251,508.02 1485.8,547.17 1419.3,536.08 1331.9,521.51 1260.9,509.67"];
	stage0_embedding -> stage0_layer0_residual1	[pos="e,1834.3,69.741 1697,549.65 1831.4,528.59 2042,484 2042,411.5 2042,411.5 2042,411.5 2042,255.5 2042,153.51 1947,100.15 1843.9,72.278"];
	stage0_layer0_norm1 -> stage0_layer0_qkv_gpu0	[pos="e,236.26,430.01 1012.9,482.4 843.57,475.88 526.22,460.85 246.2,431.08"];
	stage0_layer0_norm1 -> stage0_layer0_qkv_gpu1	[pos="e,490.27,429.92 1012.9,478.27 887.27,469.2 684.88,453.07 500.43,431.13"];
	stage0_layer0_norm1 -> stage0_layer0_qkv_gpu2	[pos="e,744.3,429.69 1013,469.12 940.72,458.67 846.8,445.01 754.39,431.2"];
	stage0_layer0_norm1 -> stage0_layer0_qkv_gpu3	[pos="e,946.18,431.04 1067.9,466.99 1033.7,456.87 991.65,444.47 956.04,433.95"];
	stage0_layer0_norm1 -> stage0_layer0_qkv_gpu4	[pos="e,1134,431.07 1134,466.79 1134,458.96 1134,449.77 1134,441.16"];
	stage0_layer0_norm1 -> stage0_layer0_qkv_gpu5	[pos="e,1321.8,431.04 1200.1,466.99 1234.3,456.87 1276.3,444.47 1312,433.95"];
	stage0_layer0_norm1 -> stage0_layer0_qkv_gpu6	[pos="e,1523.7,429.69 1255,469.12 1327.3,458.67 1421.2,445.01 1513.6,431.2"];
	stage0_layer0_norm1 -> stage0_layer0_qkv_gpu7	[pos="e,1777.7,429.92 1255.1,478.27 1380.7,469.2 1583.1,453.07 1767.6,431.13"];
	stage0_layer0_qkv_gpu0 -> stage0_layer0_attn_gpu0	[pos="e,118,354.07 118,389.79 118,381.96 118,372.77 118,364.16"];
	stage0_layer0_attn_gpu0 -> stage0_layer0_out_gpu0	[pos="e,118,277.07 118,312.79 118,304.96 118,295.77 118,287.16"];
	stage0_layer0_out_gpu0 -> stage0_layer0_attn_allreduce	[pos="e,943.3,172.59 236.27,237.07 239.21,236.7 242.12,236.34 245,236 480.68,207.86 752.72,186.18 933.16,173.31"];
	stage0_layer0_qkv_gpu1 -> stage0_layer0_attn_gpu1	[pos="e,372,354.07 372,389.79 372,381.96 372,372.77 372,364.16"];
	stage0_layer0_attn_gpu1 -> stage0_layer0_out_gpu1	[pos="e,372,277.07 372,312.79 372,304.96 372,295.77 372,287.16"];
	stage0_layer0_out_gpu1 -> stage0_layer0_attn_allreduce	[pos="e,952.8,180.07 490.28,237.21 493.22,236.8 496.13,236.39 499,236 647.75,215.68 816.51,195.63 942.65,181.22"];
	stage0_layer0_qkv_gpu2 -> stage0_layer0_attn_gpu2	[pos="e,626,354.07 626,389.79 626,381.96 626,372.77 626,364.16"];
	stage0_layer0_attn_gpu2 -> stage0_layer0_out_gpu2	[pos="e,626,277.07 626,312.79 626,304.96 626,295.77 626,287.16"];
	stage0_layer0_out_gpu2 -> stage0_layer0_attn_allreduce	[pos="e,967.61,191.28 730.03,235.94 795.45,223.64 881.55,207.46 957.45,193.19"];
	stage0_layer0_qkv_gpu3 -> stage0_layer0_attn_gpu3	[pos="e,880,354.07 880,389.79 880,381.96 880,372.77 880,364.16"];
	stage0_layer0_attn_gpu3 -> stage0_layer0_out_gpu3	[pos="e,880,277.07 880,312.79 880,304.96 880,295.77 880,287.16"];
	stage0_layer0_out_gpu3 -> stage0_layer0_attn_allreduce	[pos="e,1027.5,200.03 932.01,235.94 956.9,226.59 987.76,214.98 1017.8,203.68"];
	stage0_layer0_qkv_gpu4 -> stage0_layer0_attn_gpu4	[pos="e,1134,354.07 1134,389.79 1134,381.96 1134,372.77 1134,364.16"];
	stage0_layer0_attn_gpu4 -> stage0_layer0_out_gpu4	[pos="e,1134,277.07 1134,312.79 1134,304.96 1134,295.77 1134,287.16"];
	stage0_layer0_out_gpu4 -> stage0_layer0_attn_allreduce	[pos="e,1134,200.25 1134,235.71 1134,228.25 1134,219.38 1134,210.39"];
	stage0_layer0_qkv_gpu5 -> stage0_layer0_attn_gpu5	[pos="e,1388,354.07 1388,389.79 1388,381.96 1388,372.77 1388,364.16"];
	stage0_layer0_attn_gpu5 -> stage0_layer0_out_gpu5	[pos="e,1388,277.07 1388,312.79 1388,304.96 1388,295.77 1388,287.16"];
	stage0_layer0_out_gpu5 -> stage0_layer0_attn_allreduce	[pos="e,1240.5,200.03 1336,235.94 1311.1,226.59 1280.2,214.98 1250.2,203.68"];
	stage0_layer0_qkv_gpu6 -> stage0_layer0_attn_gpu6	[pos="e,1642,354.07 1642,389.79 1642,381.96 1642,372.77 1642,364.16"];
	stage0_layer0_attn_gpu6 -> stage0_layer0_out_gpu6	[pos="e,1642,277.07 1642,312.79 1642,304.96 1642,295.77 1642,287.16"];
	stage0_layer0_out_gpu6 -> stage0_layer0_attn_allreduce	[pos="e,1346.9,200.03 1538,235.94 1485.6,226.1 1420,213.77 1357,201.92"];
	stage0_layer0_qkv_gpu7 -> stage0_layer0_attn_gpu7	[pos="e,1896,354.07 1896,389.79 1896,381.96 1896,372.77 1896,364.16"];
	stage0_layer0_attn_gpu7 -> stage0_layer0_out_gpu7	[pos="e,1896,277.07 1896,312.79 1896,304.96 1896,295.77 1896,287.16"];
	stage0_layer0_out_gpu7 -> stage0_layer0_attn_allreduce	[pos="e,1380,187.51 1777.7,237.21 1774.8,236.8 1771.9,236.39 1769,236 1644.5,218.99 1505.9,202.17 1390.1,188.68"];
	stage0_layer0_attn_allreduce -> stage0_layer0_residual1	[pos="e,1432.4,81.759 1289.3,118.32 1332.3,107.34 1379.1,95.388 1422.6,84.267"];
	pipeline_comm	[fillcolor="#E8FDE8",
		height=1.1389,
		label="Pipeline Communication\nSend/Recv\n[Input: [1024,2048,4096], Output: [1024,2048,4096]]",
		pos="24610,663.43",
		shape=parallelogram,
		style="filled,rounded",
		width=6.9693];
	output	[fillcolor="#D0E8FF",
		height=0.58926,
		label="Output\n[batch_size=1024, seq_len=2048, hidden_dim=4096]",
		pos="54587,565.21",
		shape=ellipse,
		style=filled,
		width=4.8319];
	stage1_layer3_residual2 -> output	[pos="e,54587,586.61 54587,622.18 54587,613.66 54587,604.8 54587,596.71"];
}
