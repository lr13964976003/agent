<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_dag Pages: 1 -->
<svg width="3863pt" height="3915pt"
 viewBox="0.00 0.00 3862.74 3914.95" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 3910.95)">
<title>baseline_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3910.95 3858.74,-3910.95 3858.74,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="767.87" cy="-3869.48" rx="316.15" ry="37.45"/>
<text text-anchor="middle" x="767.87" y="-3880.78" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="767.87" y="-3865.78" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="767.87" y="-3850.78" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- l0_input_split -->
<g id="node2" class="node">
<title>l0_input_split</title>
<polygon fill="lightyellow" stroke="black" points="1243.61,-3760 486.81,-3760 292.13,-3624 1048.93,-3624 1243.61,-3760"/>
<text text-anchor="middle" x="767.87" y="-3710.8" font-family="Times,serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="767.87" y="-3695.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="767.87" y="-3680.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="767.87" y="-3665.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- input&#45;&gt;l0_input_split -->
<g id="edge1" class="edge">
<title>input&#45;&gt;l0_input_split</title>
<path fill="none" stroke="black" d="M767.87,-3831.84C767.87,-3831.84 767.87,-3770.04 767.87,-3770.04"/>
<polygon fill="black" stroke="black" points="771.37,-3770.04 767.87,-3760.04 764.37,-3770.04 771.37,-3770.04"/>
</g>
<!-- l0_mha_qkv -->
<g id="node3" class="node">
<title>l0_mha_qkv</title>
<polygon fill="lightgreen" stroke="black" points="1044.87,-3552 490.87,-3552 490.87,-3484 1044.87,-3484 1044.87,-3552"/>
<text text-anchor="middle" x="767.87" y="-3536.8" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="767.87" y="-3521.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="767.87" y="-3506.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="767.87" y="-3491.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_input_split&#45;&gt;l0_mha_qkv -->
<g id="edge2" class="edge">
<title>l0_input_split&#45;&gt;l0_mha_qkv</title>
<path fill="none" stroke="black" d="M767.87,-3623.73C767.87,-3623.73 767.87,-3562.11 767.87,-3562.11"/>
<polygon fill="black" stroke="black" points="771.37,-3562.11 767.87,-3552.11 764.37,-3562.11 771.37,-3562.11"/>
</g>
<!-- l0_mha_attn -->
<g id="node4" class="node">
<title>l0_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="1038.87,-3412 496.87,-3412 496.87,-3344 1038.87,-3344 1038.87,-3412"/>
<text text-anchor="middle" x="767.87" y="-3396.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="767.87" y="-3381.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="767.87" y="-3366.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="767.87" y="-3351.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_mha_qkv&#45;&gt;l0_mha_attn -->
<g id="edge3" class="edge">
<title>l0_mha_qkv&#45;&gt;l0_mha_attn</title>
<path fill="none" stroke="black" d="M767.87,-3483.75C767.87,-3483.75 767.87,-3422.38 767.87,-3422.38"/>
<polygon fill="black" stroke="black" points="771.37,-3422.38 767.87,-3412.38 764.37,-3422.38 771.37,-3422.38"/>
</g>
<!-- l0_mha_agg -->
<g id="node11" class="node">
<title>l0_mha_agg</title>
<polygon fill="lightyellow" stroke="black" points="1243.61,-3272 486.81,-3272 292.13,-3136 1048.93,-3136 1243.61,-3272"/>
<text text-anchor="middle" x="767.87" y="-3222.8" font-family="Times,serif" font-size="14.00">MHA All&#45;Reduce</text>
<text text-anchor="middle" x="767.87" y="-3207.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="767.87" y="-3192.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="767.87" y="-3177.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_mha_attn&#45;&gt;l0_mha_agg -->
<g id="edge4" class="edge">
<title>l0_mha_attn&#45;&gt;l0_mha_agg</title>
<path fill="none" stroke="black" d="M767.87,-3343.62C767.87,-3343.62 767.87,-3282.14 767.87,-3282.14"/>
<polygon fill="black" stroke="black" points="771.37,-3282.14 767.87,-3272.14 764.37,-3282.14 771.37,-3282.14"/>
</g>
<!-- l0_ffn_up -->
<g id="node5" class="node">
<title>l0_ffn_up</title>
<polygon fill="lightgreen" stroke="black" points="880.87,-2784 378.87,-2784 378.87,-2716 880.87,-2716 880.87,-2784"/>
<text text-anchor="middle" x="629.87" y="-2768.8" font-family="Times,serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="629.87" y="-2753.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="629.87" y="-2738.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="629.87" y="-2723.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_ffn_act -->
<g id="node7" class="node">
<title>l0_ffn_act</title>
<polygon fill="lightgreen" stroke="black" points="880.87,-2610 378.87,-2610 378.87,-2542 880.87,-2542 880.87,-2610"/>
<text text-anchor="middle" x="629.87" y="-2594.8" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="629.87" y="-2579.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="629.87" y="-2564.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="629.87" y="-2549.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_ffn_up&#45;&gt;l0_ffn_act -->
<g id="edge9" class="edge">
<title>l0_ffn_up&#45;&gt;l0_ffn_act</title>
<path fill="none" stroke="black" d="M629.87,-2715.62C629.87,-2715.62 629.87,-2620.01 629.87,-2620.01"/>
<polygon fill="black" stroke="black" points="633.37,-2620.01 629.87,-2610.01 626.37,-2620.01 633.37,-2620.01"/>
</g>
<!-- l0_ffn_gate -->
<g id="node6" class="node">
<title>l0_ffn_gate</title>
<polygon fill="lightgreen" stroke="black" points="1418.87,-2784 916.87,-2784 916.87,-2716 1418.87,-2716 1418.87,-2784"/>
<text text-anchor="middle" x="1167.87" y="-2768.8" font-family="Times,serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="1167.87" y="-2753.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1167.87" y="-2738.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="1167.87" y="-2723.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_ffn_gate&#45;&gt;l0_ffn_act -->
<g id="edge10" class="edge">
<title>l0_ffn_gate&#45;&gt;l0_ffn_act</title>
<path fill="none" stroke="black" d="M934.3,-2715.62C934.3,-2664.91 934.3,-2576 934.3,-2576 934.3,-2576 890.93,-2576 890.93,-2576"/>
<polygon fill="black" stroke="black" points="890.93,-2572.5 880.93,-2576 890.93,-2579.5 890.93,-2572.5"/>
</g>
<!-- l0_ffn_down -->
<g id="node8" class="node">
<title>l0_ffn_down</title>
<polygon fill="lightgreen" stroke="black" points="871.87,-2436 381.87,-2436 381.87,-2368 871.87,-2368 871.87,-2436"/>
<text text-anchor="middle" x="626.87" y="-2420.8" font-family="Times,serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="626.87" y="-2405.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="626.87" y="-2390.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="626.87" y="-2375.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_ffn_act&#45;&gt;l0_ffn_down -->
<g id="edge11" class="edge">
<title>l0_ffn_act&#45;&gt;l0_ffn_down</title>
<path fill="none" stroke="black" d="M626.87,-2541.62C626.87,-2541.62 626.87,-2446.01 626.87,-2446.01"/>
<polygon fill="black" stroke="black" points="630.37,-2446.01 626.87,-2436.01 623.37,-2446.01 630.37,-2446.01"/>
</g>
<!-- l0_ffn_agg -->
<g id="node12" class="node">
<title>l0_ffn_agg</title>
<polygon fill="lightyellow" stroke="black" points="951.61,-2296 194.81,-2296 0.13,-2160 756.93,-2160 951.61,-2296"/>
<text text-anchor="middle" x="475.87" y="-2246.8" font-family="Times,serif" font-size="14.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="475.87" y="-2231.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="475.87" y="-2216.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="475.87" y="-2201.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_ffn_down&#45;&gt;l0_ffn_agg -->
<g id="edge12" class="edge">
<title>l0_ffn_down&#45;&gt;l0_ffn_agg</title>
<path fill="none" stroke="black" d="M626.87,-2367.62C626.87,-2367.62 626.87,-2306.14 626.87,-2306.14"/>
<polygon fill="black" stroke="black" points="630.37,-2306.14 626.87,-2296.14 623.37,-2306.14 630.37,-2306.14"/>
</g>
<!-- l0_residual -->
<g id="node9" class="node">
<title>l0_residual</title>
<polygon fill="lightgreen" stroke="black" points="1007.37,-3064 528.37,-3064 528.37,-2996 1007.37,-2996 1007.37,-3064"/>
<text text-anchor="middle" x="767.87" y="-3048.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="767.87" y="-3033.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096] (x2)</text>
<text text-anchor="middle" x="767.87" y="-3018.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="767.87" y="-3003.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_layernorm -->
<g id="node10" class="node">
<title>l0_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="997.37,-2924 538.37,-2924 538.37,-2856 997.37,-2856 997.37,-2924"/>
<text text-anchor="middle" x="767.87" y="-2908.8" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="767.87" y="-2893.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="767.87" y="-2878.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="767.87" y="-2863.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_residual&#45;&gt;l0_layernorm -->
<g id="edge6" class="edge">
<title>l0_residual&#45;&gt;l0_layernorm</title>
<path fill="none" stroke="black" d="M767.87,-2995.75C767.87,-2995.75 767.87,-2934.38 767.87,-2934.38"/>
<polygon fill="black" stroke="black" points="771.37,-2934.38 767.87,-2924.38 764.37,-2934.38 771.37,-2934.38"/>
</g>
<!-- l1_mha_qkv -->
<g id="node13" class="node">
<title>l1_mha_qkv</title>
<polygon fill="lightgreen" stroke="black" points="1863.87,-2924 1309.87,-2924 1309.87,-2856 1863.87,-2856 1863.87,-2924"/>
<text text-anchor="middle" x="1586.87" y="-2908.8" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="1586.87" y="-2893.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1586.87" y="-2878.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="1586.87" y="-2863.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_residual&#45;&gt;l1_mha_qkv -->
<g id="edge14" class="edge">
<title>l0_residual&#45;&gt;l1_mha_qkv</title>
<path fill="none" stroke="black" d="M1002.37,-2995.75C1002.37,-2954.31 1002.37,-2890 1002.37,-2890 1002.37,-2890 1299.6,-2890 1299.6,-2890"/>
<polygon fill="black" stroke="black" points="1299.6,-2893.5 1309.6,-2890 1299.6,-2886.5 1299.6,-2893.5"/>
</g>
<!-- l0_layernorm&#45;&gt;l0_ffn_up -->
<g id="edge7" class="edge">
<title>l0_layernorm&#45;&gt;l0_ffn_up</title>
<path fill="none" stroke="black" d="M709.62,-2855.75C709.62,-2855.75 709.62,-2794.38 709.62,-2794.38"/>
<polygon fill="black" stroke="black" points="713.12,-2794.38 709.62,-2784.38 706.12,-2794.38 713.12,-2794.38"/>
</g>
<!-- l0_layernorm&#45;&gt;l0_ffn_gate -->
<g id="edge8" class="edge">
<title>l0_layernorm&#45;&gt;l0_ffn_gate</title>
<path fill="none" stroke="black" d="M957.12,-2855.75C957.12,-2855.75 957.12,-2794.38 957.12,-2794.38"/>
<polygon fill="black" stroke="black" points="960.62,-2794.38 957.12,-2784.38 953.62,-2794.38 960.62,-2794.38"/>
</g>
<!-- l0_mha_agg&#45;&gt;l0_residual -->
<g id="edge5" class="edge">
<title>l0_mha_agg&#45;&gt;l0_residual</title>
<path fill="none" stroke="black" d="M767.87,-3135.73C767.87,-3135.73 767.87,-3074.11 767.87,-3074.11"/>
<polygon fill="black" stroke="black" points="771.37,-3074.11 767.87,-3064.11 764.37,-3074.11 771.37,-3074.11"/>
</g>
<!-- l0_ffn_agg&#45;&gt;l0_residual -->
<g id="edge13" class="edge">
<title>l0_ffn_agg&#45;&gt;l0_residual</title>
<path fill="none" stroke="black" d="M335.43,-2296.03C335.43,-2489.68 335.43,-3030 335.43,-3030 335.43,-3030 518.26,-3030 518.26,-3030"/>
<polygon fill="black" stroke="black" points="518.26,-3033.5 528.26,-3030 518.26,-3026.5 518.26,-3033.5"/>
</g>
<!-- l1_mha_attn -->
<g id="node14" class="node">
<title>l1_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="1996.87,-2784 1454.87,-2784 1454.87,-2716 1996.87,-2716 1996.87,-2784"/>
<text text-anchor="middle" x="1725.87" y="-2768.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="1725.87" y="-2753.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="1725.87" y="-2738.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1725.87" y="-2723.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_mha_qkv&#45;&gt;l1_mha_attn -->
<g id="edge15" class="edge">
<title>l1_mha_qkv&#45;&gt;l1_mha_attn</title>
<path fill="none" stroke="black" d="M1659.37,-2855.75C1659.37,-2855.75 1659.37,-2794.38 1659.37,-2794.38"/>
<polygon fill="black" stroke="black" points="1662.87,-2794.38 1659.37,-2784.38 1655.87,-2794.38 1662.87,-2794.38"/>
</g>
<!-- l1_mha_agg -->
<g id="node21" class="node">
<title>l1_mha_agg</title>
<polygon fill="lightyellow" stroke="black" points="2201.61,-2644 1444.81,-2644 1250.13,-2508 2006.93,-2508 2201.61,-2644"/>
<text text-anchor="middle" x="1725.87" y="-2594.8" font-family="Times,serif" font-size="14.00">MHA All&#45;Reduce</text>
<text text-anchor="middle" x="1725.87" y="-2579.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1725.87" y="-2564.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1725.87" y="-2549.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_mha_attn&#45;&gt;l1_mha_agg -->
<g id="edge16" class="edge">
<title>l1_mha_attn&#45;&gt;l1_mha_agg</title>
<path fill="none" stroke="black" d="M1725.87,-2715.62C1725.87,-2715.62 1725.87,-2654.14 1725.87,-2654.14"/>
<polygon fill="black" stroke="black" points="1729.37,-2654.14 1725.87,-2644.14 1722.37,-2654.14 1729.37,-2654.14"/>
</g>
<!-- l1_ffn_up -->
<g id="node15" class="node">
<title>l1_ffn_up</title>
<polygon fill="lightgreen" stroke="black" points="1132.87,-2088 630.87,-2088 630.87,-2020 1132.87,-2020 1132.87,-2088"/>
<text text-anchor="middle" x="881.87" y="-2072.8" font-family="Times,serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="881.87" y="-2057.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="881.87" y="-2042.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="881.87" y="-2027.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_ffn_act -->
<g id="node17" class="node">
<title>l1_ffn_act</title>
<polygon fill="lightgreen" stroke="black" points="1670.87,-1948 1168.87,-1948 1168.87,-1880 1670.87,-1880 1670.87,-1948"/>
<text text-anchor="middle" x="1419.87" y="-1932.8" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="1419.87" y="-1917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="1419.87" y="-1902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="1419.87" y="-1887.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_ffn_up&#45;&gt;l1_ffn_act -->
<g id="edge21" class="edge">
<title>l1_ffn_up&#45;&gt;l1_ffn_act</title>
<path fill="none" stroke="black" d="M1061.43,-2019.75C1061.43,-1978.31 1061.43,-1914 1061.43,-1914 1061.43,-1914 1158.49,-1914 1158.49,-1914"/>
<polygon fill="black" stroke="black" points="1158.49,-1917.5 1168.49,-1914 1158.49,-1910.5 1158.49,-1917.5"/>
</g>
<!-- l1_ffn_gate -->
<g id="node16" class="node">
<title>l1_ffn_gate</title>
<polygon fill="lightgreen" stroke="black" points="1670.87,-2088 1168.87,-2088 1168.87,-2020 1670.87,-2020 1670.87,-2088"/>
<text text-anchor="middle" x="1419.87" y="-2072.8" font-family="Times,serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="1419.87" y="-2057.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1419.87" y="-2042.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="1419.87" y="-2027.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_ffn_gate&#45;&gt;l1_ffn_act -->
<g id="edge22" class="edge">
<title>l1_ffn_gate&#45;&gt;l1_ffn_act</title>
<path fill="none" stroke="black" d="M1419.87,-2019.75C1419.87,-2019.75 1419.87,-1958.38 1419.87,-1958.38"/>
<polygon fill="black" stroke="black" points="1423.37,-1958.38 1419.87,-1948.38 1416.37,-1958.38 1423.37,-1958.38"/>
</g>
<!-- l1_ffn_down -->
<g id="node18" class="node">
<title>l1_ffn_down</title>
<polygon fill="lightgreen" stroke="black" points="1667.87,-1774 1177.87,-1774 1177.87,-1706 1667.87,-1706 1667.87,-1774"/>
<text text-anchor="middle" x="1422.87" y="-1758.8" font-family="Times,serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="1422.87" y="-1743.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="1422.87" y="-1728.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1422.87" y="-1713.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_ffn_act&#45;&gt;l1_ffn_down -->
<g id="edge23" class="edge">
<title>l1_ffn_act&#45;&gt;l1_ffn_down</title>
<path fill="none" stroke="black" d="M1422.87,-1879.62C1422.87,-1879.62 1422.87,-1784.01 1422.87,-1784.01"/>
<polygon fill="black" stroke="black" points="1426.37,-1784.01 1422.87,-1774.01 1419.37,-1784.01 1426.37,-1784.01"/>
</g>
<!-- l1_ffn_agg -->
<g id="node22" class="node">
<title>l1_ffn_agg</title>
<polygon fill="lightyellow" stroke="black" points="1941.61,-1600 1184.81,-1600 990.13,-1464 1746.93,-1464 1941.61,-1600"/>
<text text-anchor="middle" x="1465.87" y="-1550.8" font-family="Times,serif" font-size="14.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="1465.87" y="-1535.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1465.87" y="-1520.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1465.87" y="-1505.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_ffn_down&#45;&gt;l1_ffn_agg -->
<g id="edge24" class="edge">
<title>l1_ffn_down&#45;&gt;l1_ffn_agg</title>
<path fill="none" stroke="black" d="M1422.87,-1705.65C1422.87,-1705.65 1422.87,-1610.07 1422.87,-1610.07"/>
<polygon fill="black" stroke="black" points="1426.37,-1610.07 1422.87,-1600.07 1419.37,-1610.07 1426.37,-1610.07"/>
</g>
<!-- l1_residual -->
<g id="node19" class="node">
<title>l1_residual</title>
<polygon fill="lightgreen" stroke="black" points="1965.37,-2436 1486.37,-2436 1486.37,-2368 1965.37,-2368 1965.37,-2436"/>
<text text-anchor="middle" x="1725.87" y="-2420.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1725.87" y="-2405.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096] (x2)</text>
<text text-anchor="middle" x="1725.87" y="-2390.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1725.87" y="-2375.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_layernorm -->
<g id="node20" class="node">
<title>l1_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="1649.37,-2262 1190.37,-2262 1190.37,-2194 1649.37,-2194 1649.37,-2262"/>
<text text-anchor="middle" x="1419.87" y="-2246.8" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1419.87" y="-2231.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1419.87" y="-2216.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1419.87" y="-2201.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_residual&#45;&gt;l1_layernorm -->
<g id="edge18" class="edge">
<title>l1_residual&#45;&gt;l1_layernorm</title>
<path fill="none" stroke="black" d="M1567.87,-2367.62C1567.87,-2367.62 1567.87,-2272.01 1567.87,-2272.01"/>
<polygon fill="black" stroke="black" points="1571.37,-2272.01 1567.87,-2262.01 1564.37,-2272.01 1571.37,-2272.01"/>
</g>
<!-- stage0_to_stage1 -->
<g id="node23" class="node">
<title>stage0_to_stage1</title>
<ellipse fill="orange" stroke="black" cx="2180.87" cy="-2228" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="2180.87" y="-2246.8" font-family="Times,serif" font-size="14.00">Pipeline Send</text>
<text text-anchor="middle" x="2180.87" y="-2231.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2180.87" y="-2216.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2180.87" y="-2201.8" font-family="Times,serif" font-size="14.00">GPU: 0â†’8</text>
</g>
<!-- l1_residual&#45;&gt;stage0_to_stage1 -->
<g id="edge26" class="edge">
<title>l1_residual&#45;&gt;stage0_to_stage1</title>
<path fill="none" stroke="black" d="M1910.84,-2367.62C1910.84,-2367.62 1910.84,-2264.9 1910.84,-2264.9"/>
<polygon fill="black" stroke="black" points="1914.34,-2264.9 1910.84,-2254.9 1907.34,-2264.9 1914.34,-2264.9"/>
</g>
<!-- l1_layernorm&#45;&gt;l1_ffn_up -->
<g id="edge19" class="edge">
<title>l1_layernorm&#45;&gt;l1_ffn_up</title>
<path fill="none" stroke="black" d="M1190.17,-2228C1111.23,-2228 1042.3,-2228 1042.3,-2228 1042.3,-2228 1042.3,-2098.38 1042.3,-2098.38"/>
<polygon fill="black" stroke="black" points="1045.8,-2098.38 1042.3,-2088.38 1038.8,-2098.38 1045.8,-2098.38"/>
</g>
<!-- l1_layernorm&#45;&gt;l1_ffn_gate -->
<g id="edge20" class="edge">
<title>l1_layernorm&#45;&gt;l1_ffn_gate</title>
<path fill="none" stroke="black" d="M1419.87,-2193.62C1419.87,-2193.62 1419.87,-2098.01 1419.87,-2098.01"/>
<polygon fill="black" stroke="black" points="1423.37,-2098.01 1419.87,-2088.01 1416.37,-2098.01 1423.37,-2098.01"/>
</g>
<!-- l1_mha_agg&#45;&gt;l1_residual -->
<g id="edge17" class="edge">
<title>l1_mha_agg&#45;&gt;l1_residual</title>
<path fill="none" stroke="black" d="M1725.87,-2507.73C1725.87,-2507.73 1725.87,-2446.11 1725.87,-2446.11"/>
<polygon fill="black" stroke="black" points="1729.37,-2446.11 1725.87,-2436.11 1722.37,-2446.11 1729.37,-2446.11"/>
</g>
<!-- l1_ffn_agg&#45;&gt;l1_residual -->
<g id="edge25" class="edge">
<title>l1_ffn_agg&#45;&gt;l1_residual</title>
<path fill="none" stroke="black" d="M1725.93,-1600.27C1725.93,-1600.27 1725.93,-2357.59 1725.93,-2357.59"/>
<polygon fill="black" stroke="black" points="1722.43,-2357.59 1725.93,-2367.59 1729.43,-2357.59 1722.43,-2357.59"/>
</g>
<!-- l2_mha_qkv -->
<g id="node24" class="node">
<title>l2_mha_qkv</title>
<polygon fill="lightgreen" stroke="black" points="2495.87,-2088 1941.87,-2088 1941.87,-2020 2495.87,-2020 2495.87,-2088"/>
<text text-anchor="middle" x="2218.87" y="-2072.8" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="2218.87" y="-2057.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2218.87" y="-2042.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="2218.87" y="-2027.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- stage0_to_stage1&#45;&gt;l2_mha_qkv -->
<g id="edge27" class="edge">
<title>stage0_to_stage1&#45;&gt;l2_mha_qkv</title>
<path fill="none" stroke="black" d="M2218.87,-2179.99C2218.87,-2179.99 2218.87,-2098.07 2218.87,-2098.07"/>
<polygon fill="black" stroke="black" points="2222.37,-2098.07 2218.87,-2088.07 2215.37,-2098.07 2222.37,-2098.07"/>
</g>
<!-- l2_mha_attn -->
<g id="node25" class="node">
<title>l2_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="2508.87,-1948 1966.87,-1948 1966.87,-1880 2508.87,-1880 2508.87,-1948"/>
<text text-anchor="middle" x="2237.87" y="-1932.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="2237.87" y="-1917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="2237.87" y="-1902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2237.87" y="-1887.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_mha_qkv&#45;&gt;l2_mha_attn -->
<g id="edge28" class="edge">
<title>l2_mha_qkv&#45;&gt;l2_mha_attn</title>
<path fill="none" stroke="black" d="M2231.37,-2019.75C2231.37,-2019.75 2231.37,-1958.38 2231.37,-1958.38"/>
<polygon fill="black" stroke="black" points="2234.87,-1958.38 2231.37,-1948.38 2227.87,-1958.38 2234.87,-1958.38"/>
</g>
<!-- l2_mha_agg -->
<g id="node32" class="node">
<title>l2_mha_agg</title>
<polygon fill="lightyellow" stroke="black" points="2732.61,-1808 1975.81,-1808 1781.13,-1672 2537.93,-1672 2732.61,-1808"/>
<text text-anchor="middle" x="2256.87" y="-1758.8" font-family="Times,serif" font-size="14.00">MHA All&#45;Reduce</text>
<text text-anchor="middle" x="2256.87" y="-1743.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2256.87" y="-1728.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2256.87" y="-1713.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_mha_attn&#45;&gt;l2_mha_agg -->
<g id="edge29" class="edge">
<title>l2_mha_attn&#45;&gt;l2_mha_agg</title>
<path fill="none" stroke="black" d="M2237.87,-1879.62C2237.87,-1879.62 2237.87,-1818.14 2237.87,-1818.14"/>
<polygon fill="black" stroke="black" points="2241.37,-1818.14 2237.87,-1808.14 2234.37,-1818.14 2241.37,-1818.14"/>
</g>
<!-- l2_ffn_up -->
<g id="node26" class="node">
<title>l2_ffn_up</title>
<polygon fill="lightgreen" stroke="black" points="2369.87,-1252 1867.87,-1252 1867.87,-1184 2369.87,-1184 2369.87,-1252"/>
<text text-anchor="middle" x="2118.87" y="-1236.8" font-family="Times,serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="2118.87" y="-1221.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2118.87" y="-1206.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="2118.87" y="-1191.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_ffn_act -->
<g id="node28" class="node">
<title>l2_ffn_act</title>
<polygon fill="lightgreen" stroke="black" points="2369.87,-1078 1867.87,-1078 1867.87,-1010 2369.87,-1010 2369.87,-1078"/>
<text text-anchor="middle" x="2118.87" y="-1062.8" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="2118.87" y="-1047.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="2118.87" y="-1032.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="2118.87" y="-1017.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_ffn_up&#45;&gt;l2_ffn_act -->
<g id="edge34" class="edge">
<title>l2_ffn_up&#45;&gt;l2_ffn_act</title>
<path fill="none" stroke="black" d="M2118.87,-1183.62C2118.87,-1183.62 2118.87,-1088.01 2118.87,-1088.01"/>
<polygon fill="black" stroke="black" points="2122.37,-1088.01 2118.87,-1078.01 2115.37,-1088.01 2122.37,-1088.01"/>
</g>
<!-- l2_ffn_gate -->
<g id="node27" class="node">
<title>l2_ffn_gate</title>
<polygon fill="lightgreen" stroke="black" points="2907.87,-1252 2405.87,-1252 2405.87,-1184 2907.87,-1184 2907.87,-1252"/>
<text text-anchor="middle" x="2656.87" y="-1236.8" font-family="Times,serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="2656.87" y="-1221.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2656.87" y="-1206.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="2656.87" y="-1191.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_ffn_gate&#45;&gt;l2_ffn_act -->
<g id="edge35" class="edge">
<title>l2_ffn_gate&#45;&gt;l2_ffn_act</title>
<path fill="none" stroke="black" d="M2572.43,-1183.62C2572.43,-1132.91 2572.43,-1044 2572.43,-1044 2572.43,-1044 2380.19,-1044 2380.19,-1044"/>
<polygon fill="black" stroke="black" points="2380.19,-1040.5 2370.19,-1044 2380.19,-1047.5 2380.19,-1040.5"/>
</g>
<!-- l2_ffn_down -->
<g id="node29" class="node">
<title>l2_ffn_down</title>
<polygon fill="lightgreen" stroke="black" points="2360.87,-904 1870.87,-904 1870.87,-836 2360.87,-836 2360.87,-904"/>
<text text-anchor="middle" x="2115.87" y="-888.8" font-family="Times,serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="2115.87" y="-873.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="2115.87" y="-858.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2115.87" y="-843.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_ffn_act&#45;&gt;l2_ffn_down -->
<g id="edge36" class="edge">
<title>l2_ffn_act&#45;&gt;l2_ffn_down</title>
<path fill="none" stroke="black" d="M2115.87,-1009.62C2115.87,-1009.62 2115.87,-914.01 2115.87,-914.01"/>
<polygon fill="black" stroke="black" points="2119.37,-914.01 2115.87,-904.01 2112.37,-914.01 2119.37,-914.01"/>
</g>
<!-- l2_ffn_agg -->
<g id="node33" class="node">
<title>l2_ffn_agg</title>
<polygon fill="lightyellow" stroke="black" points="2324.61,-764 1567.81,-764 1373.13,-628 2129.93,-628 2324.61,-764"/>
<text text-anchor="middle" x="1848.87" y="-714.8" font-family="Times,serif" font-size="14.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="1848.87" y="-699.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1848.87" y="-684.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1848.87" y="-669.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_ffn_down&#45;&gt;l2_ffn_agg -->
<g id="edge37" class="edge">
<title>l2_ffn_down&#45;&gt;l2_ffn_agg</title>
<path fill="none" stroke="black" d="M2097.8,-835.62C2097.8,-835.62 2097.8,-774.14 2097.8,-774.14"/>
<polygon fill="black" stroke="black" points="2101.3,-774.14 2097.8,-764.14 2094.3,-774.14 2101.3,-774.14"/>
</g>
<!-- l2_residual -->
<g id="node30" class="node">
<title>l2_residual</title>
<polygon fill="lightgreen" stroke="black" points="2496.37,-1566 2017.37,-1566 2017.37,-1498 2496.37,-1498 2496.37,-1566"/>
<text text-anchor="middle" x="2256.87" y="-1550.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2256.87" y="-1535.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096] (x2)</text>
<text text-anchor="middle" x="2256.87" y="-1520.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2256.87" y="-1505.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_layernorm -->
<g id="node31" class="node">
<title>l2_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="2486.37,-1392 2027.37,-1392 2027.37,-1324 2486.37,-1324 2486.37,-1392"/>
<text text-anchor="middle" x="2256.87" y="-1376.8" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="2256.87" y="-1361.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2256.87" y="-1346.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2256.87" y="-1331.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_residual&#45;&gt;l2_layernorm -->
<g id="edge31" class="edge">
<title>l2_residual&#45;&gt;l2_layernorm</title>
<path fill="none" stroke="black" d="M2256.87,-1497.62C2256.87,-1497.62 2256.87,-1402.01 2256.87,-1402.01"/>
<polygon fill="black" stroke="black" points="2260.37,-1402.01 2256.87,-1392.01 2253.37,-1402.01 2260.37,-1402.01"/>
</g>
<!-- l3_mha_qkv -->
<g id="node34" class="node">
<title>l3_mha_qkv</title>
<polygon fill="lightgreen" stroke="black" points="3352.87,-1392 2798.87,-1392 2798.87,-1324 3352.87,-1324 3352.87,-1392"/>
<text text-anchor="middle" x="3075.87" y="-1376.8" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="3075.87" y="-1361.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3075.87" y="-1346.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="3075.87" y="-1331.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_residual&#45;&gt;l3_mha_qkv -->
<g id="edge39" class="edge">
<title>l2_residual&#45;&gt;l3_mha_qkv</title>
<path fill="none" stroke="black" d="M2491.37,-1497.62C2491.37,-1446.91 2491.37,-1358 2491.37,-1358 2491.37,-1358 2788.6,-1358 2788.6,-1358"/>
<polygon fill="black" stroke="black" points="2788.6,-1361.5 2798.6,-1358 2788.6,-1354.5 2788.6,-1361.5"/>
</g>
<!-- l2_layernorm&#45;&gt;l2_ffn_up -->
<g id="edge32" class="edge">
<title>l2_layernorm&#45;&gt;l2_ffn_up</title>
<path fill="none" stroke="black" d="M2198.62,-1323.75C2198.62,-1323.75 2198.62,-1262.38 2198.62,-1262.38"/>
<polygon fill="black" stroke="black" points="2202.12,-1262.38 2198.62,-1252.38 2195.12,-1262.38 2202.12,-1262.38"/>
</g>
<!-- l2_layernorm&#45;&gt;l2_ffn_gate -->
<g id="edge33" class="edge">
<title>l2_layernorm&#45;&gt;l2_ffn_gate</title>
<path fill="none" stroke="black" d="M2446.12,-1323.75C2446.12,-1323.75 2446.12,-1262.38 2446.12,-1262.38"/>
<polygon fill="black" stroke="black" points="2449.62,-1262.38 2446.12,-1252.38 2442.62,-1262.38 2449.62,-1262.38"/>
</g>
<!-- l2_mha_agg&#45;&gt;l2_residual -->
<g id="edge30" class="edge">
<title>l2_mha_agg&#45;&gt;l2_residual</title>
<path fill="none" stroke="black" d="M2256.87,-1671.89C2256.87,-1671.89 2256.87,-1576.1 2256.87,-1576.1"/>
<polygon fill="black" stroke="black" points="2260.37,-1576.1 2256.87,-1566.1 2253.37,-1576.1 2260.37,-1576.1"/>
</g>
<!-- l2_ffn_agg&#45;&gt;l2_residual -->
<g id="edge38" class="edge">
<title>l2_ffn_agg&#45;&gt;l2_residual</title>
<path fill="none" stroke="black" d="M1620.43,-764.2C1620.43,-919.87 1620.43,-1288 1620.43,-1288 1620.43,-1288 2022.37,-1288 2022.37,-1288 2022.37,-1288 2022.37,-1487.82 2022.37,-1487.82"/>
<polygon fill="black" stroke="black" points="2018.87,-1487.82 2022.37,-1497.82 2025.87,-1487.82 2018.87,-1487.82"/>
</g>
<!-- l3_mha_attn -->
<g id="node35" class="node">
<title>l3_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="3485.87,-1252 2943.87,-1252 2943.87,-1184 3485.87,-1184 3485.87,-1252"/>
<text text-anchor="middle" x="3214.87" y="-1236.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="3214.87" y="-1221.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="3214.87" y="-1206.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3214.87" y="-1191.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_mha_qkv&#45;&gt;l3_mha_attn -->
<g id="edge40" class="edge">
<title>l3_mha_qkv&#45;&gt;l3_mha_attn</title>
<path fill="none" stroke="black" d="M3148.37,-1323.75C3148.37,-1323.75 3148.37,-1262.38 3148.37,-1262.38"/>
<polygon fill="black" stroke="black" points="3151.87,-1262.38 3148.37,-1252.38 3144.87,-1262.38 3151.87,-1262.38"/>
</g>
<!-- l3_mha_agg -->
<g id="node42" class="node">
<title>l3_mha_agg</title>
<polygon fill="lightyellow" stroke="black" points="3690.61,-1112 2933.81,-1112 2739.13,-976 3495.93,-976 3690.61,-1112"/>
<text text-anchor="middle" x="3214.87" y="-1062.8" font-family="Times,serif" font-size="14.00">MHA All&#45;Reduce</text>
<text text-anchor="middle" x="3214.87" y="-1047.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3214.87" y="-1032.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3214.87" y="-1017.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_mha_attn&#45;&gt;l3_mha_agg -->
<g id="edge41" class="edge">
<title>l3_mha_attn&#45;&gt;l3_mha_agg</title>
<path fill="none" stroke="black" d="M3214.87,-1183.62C3214.87,-1183.62 3214.87,-1122.14 3214.87,-1122.14"/>
<polygon fill="black" stroke="black" points="3218.37,-1122.14 3214.87,-1112.14 3211.37,-1122.14 3218.37,-1122.14"/>
</g>
<!-- l3_ffn_up -->
<g id="node36" class="node">
<title>l3_ffn_up</title>
<polygon fill="lightgreen" stroke="black" points="2875.87,-556 2373.87,-556 2373.87,-488 2875.87,-488 2875.87,-556"/>
<text text-anchor="middle" x="2624.87" y="-540.8" font-family="Times,serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="2624.87" y="-525.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2624.87" y="-510.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="2624.87" y="-495.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_ffn_act -->
<g id="node38" class="node">
<title>l3_ffn_act</title>
<polygon fill="lightgreen" stroke="black" points="3413.87,-416 2911.87,-416 2911.87,-348 3413.87,-348 3413.87,-416"/>
<text text-anchor="middle" x="3162.87" y="-400.8" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="3162.87" y="-385.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="3162.87" y="-370.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="3162.87" y="-355.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_ffn_up&#45;&gt;l3_ffn_act -->
<g id="edge46" class="edge">
<title>l3_ffn_up&#45;&gt;l3_ffn_act</title>
<path fill="none" stroke="black" d="M2624.87,-487.75C2624.87,-446.31 2624.87,-382 2624.87,-382 2624.87,-382 2901.59,-382 2901.59,-382"/>
<polygon fill="black" stroke="black" points="2901.59,-385.5 2911.59,-382 2901.59,-378.5 2901.59,-385.5"/>
</g>
<!-- l3_ffn_gate -->
<g id="node37" class="node">
<title>l3_ffn_gate</title>
<polygon fill="lightgreen" stroke="black" points="3413.87,-556 2911.87,-556 2911.87,-488 3413.87,-488 3413.87,-556"/>
<text text-anchor="middle" x="3162.87" y="-540.8" font-family="Times,serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="3162.87" y="-525.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3162.87" y="-510.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="3162.87" y="-495.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_ffn_gate&#45;&gt;l3_ffn_act -->
<g id="edge47" class="edge">
<title>l3_ffn_gate&#45;&gt;l3_ffn_act</title>
<path fill="none" stroke="black" d="M3162.87,-487.75C3162.87,-487.75 3162.87,-426.38 3162.87,-426.38"/>
<polygon fill="black" stroke="black" points="3166.37,-426.38 3162.87,-416.38 3159.37,-426.38 3166.37,-426.38"/>
</g>
<!-- l3_ffn_down -->
<g id="node39" class="node">
<title>l3_ffn_down</title>
<polygon fill="lightgreen" stroke="black" points="3473.87,-276 2983.87,-276 2983.87,-208 3473.87,-208 3473.87,-276"/>
<text text-anchor="middle" x="3228.87" y="-260.8" font-family="Times,serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="3228.87" y="-245.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=16384]</text>
<text text-anchor="middle" x="3228.87" y="-230.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3228.87" y="-215.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_ffn_act&#45;&gt;l3_ffn_down -->
<g id="edge48" class="edge">
<title>l3_ffn_act&#45;&gt;l3_ffn_down</title>
<path fill="none" stroke="black" d="M3198.87,-347.75C3198.87,-347.75 3198.87,-286.38 3198.87,-286.38"/>
<polygon fill="black" stroke="black" points="3202.37,-286.38 3198.87,-276.38 3195.37,-286.38 3202.37,-286.38"/>
</g>
<!-- l3_ffn_agg -->
<g id="node43" class="node">
<title>l3_ffn_agg</title>
<polygon fill="lightyellow" stroke="black" points="3854.61,-136 3097.81,-136 2903.13,0 3659.93,0 3854.61,-136"/>
<text text-anchor="middle" x="3378.87" y="-86.8" font-family="Times,serif" font-size="14.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="3378.87" y="-71.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3378.87" y="-56.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3378.87" y="-41.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_ffn_down&#45;&gt;l3_ffn_agg -->
<g id="edge49" class="edge">
<title>l3_ffn_down&#45;&gt;l3_ffn_agg</title>
<path fill="none" stroke="black" d="M3228.87,-207.62C3228.87,-207.62 3228.87,-146.14 3228.87,-146.14"/>
<polygon fill="black" stroke="black" points="3232.37,-146.14 3228.87,-136.14 3225.37,-146.14 3232.37,-146.14"/>
</g>
<!-- l3_residual -->
<g id="node40" class="node">
<title>l3_residual</title>
<polygon fill="lightgreen" stroke="black" points="3454.37,-904 2975.37,-904 2975.37,-836 3454.37,-836 3454.37,-904"/>
<text text-anchor="middle" x="3214.87" y="-888.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3214.87" y="-873.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096] (x2)</text>
<text text-anchor="middle" x="3214.87" y="-858.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3214.87" y="-843.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_layernorm -->
<g id="node41" class="node">
<title>l3_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="2854.37,-730 2395.37,-730 2395.37,-662 2854.37,-662 2854.37,-730"/>
<text text-anchor="middle" x="2624.87" y="-714.8" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="2624.87" y="-699.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2624.87" y="-684.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2624.87" y="-669.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_residual&#45;&gt;l3_layernorm -->
<g id="edge43" class="edge">
<title>l3_residual&#45;&gt;l3_layernorm</title>
<path fill="none" stroke="black" d="M2975.25,-870C2881.81,-870 2796.68,-870 2796.68,-870 2796.68,-870 2796.68,-740.38 2796.68,-740.38"/>
<polygon fill="black" stroke="black" points="2800.18,-740.38 2796.68,-730.38 2793.18,-740.38 2800.18,-740.38"/>
</g>
<!-- output -->
<g id="node44" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="3214.87" cy="-696" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="3214.87" y="-714.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="3214.87" y="-699.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3214.87" y="-684.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3214.87" y="-669.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_residual&#45;&gt;output -->
<g id="edge51" class="edge">
<title>l3_residual&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3214.87,-835.62C3214.87,-835.62 3214.87,-754.14 3214.87,-754.14"/>
<polygon fill="black" stroke="black" points="3218.37,-754.14 3214.87,-744.14 3211.37,-754.14 3218.37,-754.14"/>
</g>
<!-- l3_layernorm&#45;&gt;l3_ffn_up -->
<g id="edge44" class="edge">
<title>l3_layernorm&#45;&gt;l3_ffn_up</title>
<path fill="none" stroke="black" d="M2624.87,-661.62C2624.87,-661.62 2624.87,-566.01 2624.87,-566.01"/>
<polygon fill="black" stroke="black" points="2628.37,-566.01 2624.87,-556.01 2621.37,-566.01 2628.37,-566.01"/>
</g>
<!-- l3_layernorm&#45;&gt;l3_ffn_gate -->
<g id="edge45" class="edge">
<title>l3_layernorm&#45;&gt;l3_ffn_gate</title>
<path fill="none" stroke="black" d="M2854.47,-696C2872.02,-696 2883.09,-696 2883.09,-696 2883.09,-696 2883.09,-522 2883.09,-522 2883.09,-522 2901.72,-522 2901.72,-522"/>
<polygon fill="black" stroke="black" points="2901.72,-525.5 2911.72,-522 2901.72,-518.5 2901.72,-525.5"/>
</g>
<!-- l3_mha_agg&#45;&gt;l3_residual -->
<g id="edge42" class="edge">
<title>l3_mha_agg&#45;&gt;l3_residual</title>
<path fill="none" stroke="black" d="M3214.87,-975.73C3214.87,-975.73 3214.87,-914.11 3214.87,-914.11"/>
<polygon fill="black" stroke="black" points="3218.37,-914.11 3214.87,-904.11 3211.37,-914.11 3218.37,-914.11"/>
</g>
<!-- l3_ffn_agg&#45;&gt;l3_residual -->
<g id="edge50" class="edge">
<title>l3_ffn_agg&#45;&gt;l3_residual</title>
<path fill="none" stroke="black" d="M3615.09,-136.03C3615.09,-329.68 3615.09,-870 3615.09,-870 3615.09,-870 3464.61,-870 3464.61,-870"/>
<polygon fill="black" stroke="black" points="3464.61,-866.5 3454.61,-870 3464.61,-873.5 3464.61,-866.5"/>
</g>
</g>
</svg>
