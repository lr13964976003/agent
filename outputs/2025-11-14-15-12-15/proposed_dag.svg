<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proposed_dag Pages: 1 -->
<svg width="5434pt" height="6996pt"
 viewBox="0.00 0.00 5434.00 6996.29" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 6992.29)">
<title>proposed_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-6992.29 5430,-6992.29 5430,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="2723.5" cy="-6950.81" rx="316.15" ry="37.45"/>
<text text-anchor="middle" x="2723.5" y="-6962.11" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="2723.5" y="-6947.11" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2723.5" y="-6932.11" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- l0_input_split -->
<g id="node2" class="node">
<title>l0_input_split</title>
<polygon fill="lightyellow" stroke="black" points="3221.28,-6841.33 2429.42,-6841.33 2225.72,-6705.33 3017.58,-6705.33 3221.28,-6841.33"/>
<text text-anchor="middle" x="2723.5" y="-6792.13" font-family="Times,serif" font-size="14.00">Input Broadcast</text>
<text text-anchor="middle" x="2723.5" y="-6777.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2723.5" y="-6762.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]×4</text>
<text text-anchor="middle" x="2723.5" y="-6747.13" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
</g>
<!-- input&#45;&gt;l0_input_split -->
<g id="edge1" class="edge">
<title>input&#45;&gt;l0_input_split</title>
<path fill="none" stroke="black" d="M2723.5,-6913.17C2723.5,-6913.17 2723.5,-6851.37 2723.5,-6851.37"/>
<polygon fill="black" stroke="black" points="2727,-6851.37 2723.5,-6841.37 2720,-6851.37 2727,-6851.37"/>
</g>
<!-- l0_mha_qkv_split -->
<g id="node3" class="node">
<title>l0_mha_qkv_split</title>
<polygon fill="lightyellow" stroke="black" points="3310.1,-6633.33 2376.95,-6633.33 2136.9,-6497.33 3070.05,-6497.33 3310.1,-6633.33"/>
<text text-anchor="middle" x="2723.5" y="-6584.13" font-family="Times,serif" font-size="14.00">QKV Split</text>
<text text-anchor="middle" x="2723.5" y="-6569.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2723.5" y="-6554.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]×4</text>
<text text-anchor="middle" x="2723.5" y="-6539.13" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
</g>
<!-- l0_input_split&#45;&gt;l0_mha_qkv_split -->
<g id="edge2" class="edge">
<title>l0_input_split&#45;&gt;l0_mha_qkv_split</title>
<path fill="none" stroke="black" d="M2723.5,-6705.23C2723.5,-6705.23 2723.5,-6643.59 2723.5,-6643.59"/>
<polygon fill="black" stroke="black" points="2727,-6643.59 2723.5,-6633.59 2720,-6643.59 2727,-6643.59"/>
</g>
<!-- l0_ffn_up_gpu0 -->
<g id="node6" class="node">
<title>l0_ffn_up_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1043,-6599.33 550,-6599.33 550,-6531.33 1043,-6531.33 1043,-6599.33"/>
<text text-anchor="middle" x="796.5" y="-6584.13" font-family="Times,serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="796.5" y="-6569.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="796.5" y="-6554.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="796.5" y="-6539.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_input_split&#45;&gt;l0_ffn_up_gpu0 -->
<g id="edge5" class="edge">
<title>l0_input_split&#45;&gt;l0_ffn_up_gpu0</title>
<path fill="none" stroke="black" d="M2346.52,-6786C1785.58,-6786 796.5,-6786 796.5,-6786 796.5,-6786 796.5,-6609.81 796.5,-6609.81"/>
<polygon fill="black" stroke="black" points="800,-6609.81 796.5,-6599.81 793,-6609.81 800,-6609.81"/>
</g>
<!-- l0_ffn_gate_gpu0 -->
<g id="node7" class="node">
<title>l0_ffn_gate_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="514,-6599.33 21,-6599.33 21,-6531.33 514,-6531.33 514,-6599.33"/>
<text text-anchor="middle" x="267.5" y="-6584.13" font-family="Times,serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="267.5" y="-6569.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="267.5" y="-6554.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="267.5" y="-6539.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_input_split&#45;&gt;l0_ffn_gate_gpu0 -->
<g id="edge6" class="edge">
<title>l0_input_split&#45;&gt;l0_ffn_gate_gpu0</title>
<path fill="none" stroke="black" d="M2388.44,-6814C1716.36,-6814 267.5,-6814 267.5,-6814 267.5,-6814 267.5,-6609.39 267.5,-6609.39"/>
<polygon fill="black" stroke="black" points="271,-6609.39 267.5,-6599.39 264,-6609.39 271,-6609.39"/>
</g>
<!-- l0_ffn_up_gpu1 -->
<g id="node14" class="node">
<title>l0_ffn_up_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1572,-6599.33 1079,-6599.33 1079,-6531.33 1572,-6531.33 1572,-6599.33"/>
<text text-anchor="middle" x="1325.5" y="-6584.13" font-family="Times,serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="1325.5" y="-6569.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1325.5" y="-6554.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1325.5" y="-6539.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_input_split&#45;&gt;l0_ffn_up_gpu1 -->
<g id="edge18" class="edge">
<title>l0_input_split&#45;&gt;l0_ffn_up_gpu1</title>
<path fill="none" stroke="black" d="M2305.95,-6759C1894,-6759 1325.5,-6759 1325.5,-6759 1325.5,-6759 1325.5,-6609.51 1325.5,-6609.51"/>
<polygon fill="black" stroke="black" points="1329,-6609.51 1325.5,-6599.51 1322,-6609.51 1329,-6609.51"/>
</g>
<!-- l0_ffn_gate_gpu1 -->
<g id="node15" class="node">
<title>l0_ffn_gate_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2101,-6599.33 1608,-6599.33 1608,-6531.33 2101,-6531.33 2101,-6599.33"/>
<text text-anchor="middle" x="1854.5" y="-6584.13" font-family="Times,serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="1854.5" y="-6569.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1854.5" y="-6554.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1854.5" y="-6539.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_input_split&#45;&gt;l0_ffn_gate_gpu1 -->
<g id="edge19" class="edge">
<title>l0_input_split&#45;&gt;l0_ffn_gate_gpu1</title>
<path fill="none" stroke="black" d="M2265.46,-6732C2056.33,-6732 1854.5,-6732 1854.5,-6732 1854.5,-6732 1854.5,-6609.46 1854.5,-6609.46"/>
<polygon fill="black" stroke="black" points="1858,-6609.46 1854.5,-6599.46 1851,-6609.46 1858,-6609.46"/>
</g>
<!-- l0_ffn_up_gpu2 -->
<g id="node22" class="node">
<title>l0_ffn_up_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="4368,-6599.33 3875,-6599.33 3875,-6531.33 4368,-6531.33 4368,-6599.33"/>
<text text-anchor="middle" x="4121.5" y="-6584.13" font-family="Times,serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="4121.5" y="-6569.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4121.5" y="-6554.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4121.5" y="-6539.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_input_split&#45;&gt;l0_ffn_up_gpu2 -->
<g id="edge31" class="edge">
<title>l0_input_split&#45;&gt;l0_ffn_up_gpu2</title>
<path fill="none" stroke="black" d="M3098.14,-6759C3512.24,-6759 4121.5,-6759 4121.5,-6759 4121.5,-6759 4121.5,-6609.51 4121.5,-6609.51"/>
<polygon fill="black" stroke="black" points="4125,-6609.51 4121.5,-6599.51 4118,-6609.51 4125,-6609.51"/>
</g>
<!-- l0_ffn_gate_gpu2 -->
<g id="node23" class="node">
<title>l0_ffn_gate_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="3839,-6599.33 3346,-6599.33 3346,-6531.33 3839,-6531.33 3839,-6599.33"/>
<text text-anchor="middle" x="3592.5" y="-6584.13" font-family="Times,serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="3592.5" y="-6569.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3592.5" y="-6554.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3592.5" y="-6539.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_input_split&#45;&gt;l0_ffn_gate_gpu2 -->
<g id="edge32" class="edge">
<title>l0_input_split&#45;&gt;l0_ffn_gate_gpu2</title>
<path fill="none" stroke="black" d="M3057.61,-6732C3302.55,-6732 3592.5,-6732 3592.5,-6732 3592.5,-6732 3592.5,-6609.46 3592.5,-6609.46"/>
<polygon fill="black" stroke="black" points="3596,-6609.46 3592.5,-6599.46 3589,-6609.46 3596,-6609.46"/>
</g>
<!-- l0_ffn_up_gpu3 -->
<g id="node30" class="node">
<title>l0_ffn_up_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="5426,-6599.33 4933,-6599.33 4933,-6531.33 5426,-6531.33 5426,-6599.33"/>
<text text-anchor="middle" x="5179.5" y="-6584.13" font-family="Times,serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="5179.5" y="-6569.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5179.5" y="-6554.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="5179.5" y="-6539.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_input_split&#45;&gt;l0_ffn_up_gpu3 -->
<g id="edge44" class="edge">
<title>l0_input_split&#45;&gt;l0_ffn_up_gpu3</title>
<path fill="none" stroke="black" d="M3180.42,-6814C3890.82,-6814 5179.5,-6814 5179.5,-6814 5179.5,-6814 5179.5,-6609.39 5179.5,-6609.39"/>
<polygon fill="black" stroke="black" points="5183,-6609.39 5179.5,-6599.39 5176,-6609.39 5183,-6609.39"/>
</g>
<!-- l0_ffn_gate_gpu3 -->
<g id="node31" class="node">
<title>l0_ffn_gate_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="4897,-6599.33 4404,-6599.33 4404,-6531.33 4897,-6531.33 4897,-6599.33"/>
<text text-anchor="middle" x="4650.5" y="-6584.13" font-family="Times,serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="4650.5" y="-6569.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4650.5" y="-6554.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4650.5" y="-6539.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_input_split&#45;&gt;l0_ffn_gate_gpu3 -->
<g id="edge45" class="edge">
<title>l0_input_split&#45;&gt;l0_ffn_gate_gpu3</title>
<path fill="none" stroke="black" d="M3138.67,-6786C3705.08,-6786 4650.5,-6786 4650.5,-6786 4650.5,-6786 4650.5,-6609.81 4650.5,-6609.81"/>
<polygon fill="black" stroke="black" points="4654,-6609.81 4650.5,-6599.81 4647,-6609.81 4654,-6609.81"/>
</g>
<!-- l0_mha_qkv_gpu0 -->
<g id="node4" class="node">
<title>l0_mha_qkv_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2124,-6425.33 1579,-6425.33 1579,-6357.33 2124,-6357.33 2124,-6425.33"/>
<text text-anchor="middle" x="1851.5" y="-6410.13" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="1851.5" y="-6395.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1851.5" y="-6380.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="1851.5" y="-6365.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_mha_qkv_split&#45;&gt;l0_mha_qkv_gpu0 -->
<g id="edge3" class="edge">
<title>l0_mha_qkv_split&#45;&gt;l0_mha_qkv_gpu0</title>
<path fill="none" stroke="black" d="M2166.19,-6514C2132.88,-6514 2112.5,-6514 2112.5,-6514 2112.5,-6514 2112.5,-6435.5 2112.5,-6435.5"/>
<polygon fill="black" stroke="black" points="2116,-6435.5 2112.5,-6425.5 2109,-6435.5 2116,-6435.5"/>
</g>
<!-- l0_mha_qkv_gpu1 -->
<g id="node12" class="node">
<title>l0_mha_qkv_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2705,-6425.33 2160,-6425.33 2160,-6357.33 2705,-6357.33 2705,-6425.33"/>
<text text-anchor="middle" x="2432.5" y="-6410.13" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="2432.5" y="-6395.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2432.5" y="-6380.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="2432.5" y="-6365.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_mha_qkv_split&#45;&gt;l0_mha_qkv_gpu1 -->
<g id="edge16" class="edge">
<title>l0_mha_qkv_split&#45;&gt;l0_mha_qkv_gpu1</title>
<path fill="none" stroke="black" d="M2432.5,-6497.06C2432.5,-6497.06 2432.5,-6435.44 2432.5,-6435.44"/>
<polygon fill="black" stroke="black" points="2436,-6435.44 2432.5,-6425.44 2429,-6435.44 2436,-6435.44"/>
</g>
<!-- l0_mha_qkv_gpu2 -->
<g id="node20" class="node">
<title>l0_mha_qkv_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="3286,-6425.33 2741,-6425.33 2741,-6357.33 3286,-6357.33 3286,-6425.33"/>
<text text-anchor="middle" x="3013.5" y="-6410.13" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="3013.5" y="-6395.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3013.5" y="-6380.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="3013.5" y="-6365.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_mha_qkv_split&#45;&gt;l0_mha_qkv_gpu2 -->
<g id="edge29" class="edge">
<title>l0_mha_qkv_split&#45;&gt;l0_mha_qkv_gpu2</title>
<path fill="none" stroke="black" d="M3013.5,-6497.06C3013.5,-6497.06 3013.5,-6435.44 3013.5,-6435.44"/>
<polygon fill="black" stroke="black" points="3017,-6435.44 3013.5,-6425.44 3010,-6435.44 3017,-6435.44"/>
</g>
<!-- l0_mha_qkv_gpu3 -->
<g id="node28" class="node">
<title>l0_mha_qkv_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="3867,-6425.33 3322,-6425.33 3322,-6357.33 3867,-6357.33 3867,-6425.33"/>
<text text-anchor="middle" x="3594.5" y="-6410.13" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="3594.5" y="-6395.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3594.5" y="-6380.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="3594.5" y="-6365.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_mha_qkv_split&#45;&gt;l0_mha_qkv_gpu3 -->
<g id="edge42" class="edge">
<title>l0_mha_qkv_split&#45;&gt;l0_mha_qkv_gpu3</title>
<path fill="none" stroke="black" d="M3099.71,-6514C3225.34,-6514 3334,-6514 3334,-6514 3334,-6514 3334,-6435.5 3334,-6435.5"/>
<polygon fill="black" stroke="black" points="3337.5,-6435.5 3334,-6425.5 3330.5,-6435.5 3337.5,-6435.5"/>
</g>
<!-- l0_mha_attn_gpu0 -->
<g id="node5" class="node">
<title>l0_mha_attn_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2118,-6285.33 1585,-6285.33 1585,-6217.33 2118,-6217.33 2118,-6285.33"/>
<text text-anchor="middle" x="1851.5" y="-6270.13" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="1851.5" y="-6255.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="1851.5" y="-6240.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1851.5" y="-6225.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_mha_qkv_gpu0&#45;&gt;l0_mha_attn_gpu0 -->
<g id="edge4" class="edge">
<title>l0_mha_qkv_gpu0&#45;&gt;l0_mha_attn_gpu0</title>
<path fill="none" stroke="black" d="M1851.5,-6357.08C1851.5,-6357.08 1851.5,-6295.71 1851.5,-6295.71"/>
<polygon fill="black" stroke="black" points="1855,-6295.71 1851.5,-6285.71 1848,-6295.71 1855,-6295.71"/>
</g>
<!-- l0_residual_gpu0 -->
<g id="node10" class="node">
<title>l0_residual_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2091,-6145.33 1612,-6145.33 1612,-6077.33 2091,-6077.33 2091,-6145.33"/>
<text text-anchor="middle" x="1851.5" y="-6130.13" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1851.5" y="-6115.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024] (x2)</text>
<text text-anchor="middle" x="1851.5" y="-6100.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1851.5" y="-6085.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_mha_attn_gpu0&#45;&gt;l0_residual_gpu0 -->
<g id="edge10" class="edge">
<title>l0_mha_attn_gpu0&#45;&gt;l0_residual_gpu0</title>
<path fill="none" stroke="black" d="M1851.5,-6217.08C1851.5,-6217.08 1851.5,-6155.71 1851.5,-6155.71"/>
<polygon fill="black" stroke="black" points="1855,-6155.71 1851.5,-6145.71 1848,-6155.71 1855,-6155.71"/>
</g>
<!-- l0_ffn_act_gpu0 -->
<g id="node8" class="node">
<title>l0_ffn_act_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1014,-6425.33 521,-6425.33 521,-6357.33 1014,-6357.33 1014,-6425.33"/>
<text text-anchor="middle" x="767.5" y="-6410.13" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="767.5" y="-6395.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="767.5" y="-6380.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="767.5" y="-6365.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_ffn_up_gpu0&#45;&gt;l0_ffn_act_gpu0 -->
<g id="edge7" class="edge">
<title>l0_ffn_up_gpu0&#45;&gt;l0_ffn_act_gpu0</title>
<path fill="none" stroke="black" d="M782,-6530.96C782,-6530.96 782,-6435.34 782,-6435.34"/>
<polygon fill="black" stroke="black" points="785.5,-6435.34 782,-6425.34 778.5,-6435.34 785.5,-6435.34"/>
</g>
<!-- l0_ffn_gate_gpu0&#45;&gt;l0_ffn_act_gpu0 -->
<g id="edge8" class="edge">
<title>l0_ffn_gate_gpu0&#45;&gt;l0_ffn_act_gpu0</title>
<path fill="none" stroke="black" d="M514.02,-6565C527.4,-6565 535.5,-6565 535.5,-6565 535.5,-6565 535.5,-6435.64 535.5,-6435.64"/>
<polygon fill="black" stroke="black" points="539,-6435.64 535.5,-6425.64 532,-6435.64 539,-6435.64"/>
</g>
<!-- l0_ffn_down_gpu0 -->
<g id="node9" class="node">
<title>l0_ffn_down_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1014,-6285.33 533,-6285.33 533,-6217.33 1014,-6217.33 1014,-6285.33"/>
<text text-anchor="middle" x="773.5" y="-6270.13" font-family="Times,serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="773.5" y="-6255.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="773.5" y="-6240.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="773.5" y="-6225.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_ffn_act_gpu0&#45;&gt;l0_ffn_down_gpu0 -->
<g id="edge9" class="edge">
<title>l0_ffn_act_gpu0&#45;&gt;l0_ffn_down_gpu0</title>
<path fill="none" stroke="black" d="M773.5,-6357.08C773.5,-6357.08 773.5,-6295.71 773.5,-6295.71"/>
<polygon fill="black" stroke="black" points="777,-6295.71 773.5,-6285.71 770,-6295.71 777,-6295.71"/>
</g>
<!-- l0_ffn_down_gpu0&#45;&gt;l0_residual_gpu0 -->
<g id="edge11" class="edge">
<title>l0_ffn_down_gpu0&#45;&gt;l0_residual_gpu0</title>
<path fill="none" stroke="black" d="M778.5,-6217C778.5,-6175.46 778.5,-6111 778.5,-6111 778.5,-6111 1601.7,-6111 1601.7,-6111"/>
<polygon fill="black" stroke="black" points="1601.7,-6114.5 1611.7,-6111 1601.7,-6107.5 1601.7,-6114.5"/>
</g>
<!-- l0_layernorm_gpu0 -->
<g id="node11" class="node">
<title>l0_layernorm_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2161,-6005.33 1702,-6005.33 1702,-5937.33 2161,-5937.33 2161,-6005.33"/>
<text text-anchor="middle" x="1931.5" y="-5990.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1931.5" y="-5975.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1931.5" y="-5960.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1931.5" y="-5945.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_residual_gpu0&#45;&gt;l0_layernorm_gpu0 -->
<g id="edge12" class="edge">
<title>l0_residual_gpu0&#45;&gt;l0_layernorm_gpu0</title>
<path fill="none" stroke="black" d="M1896.5,-6077.08C1896.5,-6077.08 1896.5,-6015.71 1896.5,-6015.71"/>
<polygon fill="black" stroke="black" points="1900,-6015.71 1896.5,-6005.71 1893,-6015.71 1900,-6015.71"/>
</g>
<!-- l0_mha_allreduce -->
<g id="node36" class="node">
<title>l0_mha_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="3201.9,-5865.33 2429.74,-5865.33 2231.1,-5729.33 3003.26,-5729.33 3201.9,-5865.33"/>
<text text-anchor="middle" x="2716.5" y="-5816.13" font-family="Times,serif" font-size="14.00">MHA All&#45;Reduce</text>
<text text-anchor="middle" x="2716.5" y="-5801.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="2716.5" y="-5786.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2716.5" y="-5771.13" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
</g>
<!-- l0_layernorm_gpu0&#45;&gt;l0_mha_allreduce -->
<g id="edge13" class="edge">
<title>l0_layernorm_gpu0&#45;&gt;l0_mha_allreduce</title>
<path fill="none" stroke="black" d="M2161.25,-5971C2204.06,-5971 2235.65,-5971 2235.65,-5971 2235.65,-5971 2235.65,-5807.46 2235.65,-5807.46"/>
<polygon fill="black" stroke="black" points="2239.15,-5807.46 2235.65,-5797.46 2232.15,-5807.46 2239.15,-5807.46"/>
</g>
<!-- l0_mha_attn_gpu1 -->
<g id="node13" class="node">
<title>l0_mha_attn_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2699,-6285.33 2166,-6285.33 2166,-6217.33 2699,-6217.33 2699,-6285.33"/>
<text text-anchor="middle" x="2432.5" y="-6270.13" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="2432.5" y="-6255.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="2432.5" y="-6240.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2432.5" y="-6225.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_mha_qkv_gpu1&#45;&gt;l0_mha_attn_gpu1 -->
<g id="edge17" class="edge">
<title>l0_mha_qkv_gpu1&#45;&gt;l0_mha_attn_gpu1</title>
<path fill="none" stroke="black" d="M2432.5,-6357.08C2432.5,-6357.08 2432.5,-6295.71 2432.5,-6295.71"/>
<polygon fill="black" stroke="black" points="2436,-6295.71 2432.5,-6285.71 2429,-6295.71 2436,-6295.71"/>
</g>
<!-- l0_residual_gpu1 -->
<g id="node18" class="node">
<title>l0_residual_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2672,-6145.33 2193,-6145.33 2193,-6077.33 2672,-6077.33 2672,-6145.33"/>
<text text-anchor="middle" x="2432.5" y="-6130.13" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2432.5" y="-6115.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024] (x2)</text>
<text text-anchor="middle" x="2432.5" y="-6100.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2432.5" y="-6085.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_mha_attn_gpu1&#45;&gt;l0_residual_gpu1 -->
<g id="edge23" class="edge">
<title>l0_mha_attn_gpu1&#45;&gt;l0_residual_gpu1</title>
<path fill="none" stroke="black" d="M2432.5,-6217.08C2432.5,-6217.08 2432.5,-6155.71 2432.5,-6155.71"/>
<polygon fill="black" stroke="black" points="2436,-6155.71 2432.5,-6145.71 2429,-6155.71 2436,-6155.71"/>
</g>
<!-- l0_ffn_act_gpu1 -->
<g id="node16" class="node">
<title>l0_ffn_act_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1543,-6425.33 1050,-6425.33 1050,-6357.33 1543,-6357.33 1543,-6425.33"/>
<text text-anchor="middle" x="1296.5" y="-6410.13" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="1296.5" y="-6395.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1296.5" y="-6380.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1296.5" y="-6365.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_ffn_up_gpu1&#45;&gt;l0_ffn_act_gpu1 -->
<g id="edge20" class="edge">
<title>l0_ffn_up_gpu1&#45;&gt;l0_ffn_act_gpu1</title>
<path fill="none" stroke="black" d="M1311,-6530.96C1311,-6530.96 1311,-6435.34 1311,-6435.34"/>
<polygon fill="black" stroke="black" points="1314.5,-6435.34 1311,-6425.34 1307.5,-6435.34 1314.5,-6435.34"/>
</g>
<!-- l0_ffn_gate_gpu1&#45;&gt;l0_ffn_act_gpu1 -->
<g id="edge21" class="edge">
<title>l0_ffn_gate_gpu1&#45;&gt;l0_ffn_act_gpu1</title>
<path fill="none" stroke="black" d="M1607.78,-6565C1588.03,-6565 1575.5,-6565 1575.5,-6565 1575.5,-6565 1575.5,-6391 1575.5,-6391 1575.5,-6391 1553.22,-6391 1553.22,-6391"/>
<polygon fill="black" stroke="black" points="1553.22,-6387.5 1543.22,-6391 1553.22,-6394.5 1553.22,-6387.5"/>
</g>
<!-- l0_ffn_down_gpu1 -->
<g id="node17" class="node">
<title>l0_ffn_down_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1543,-6285.33 1062,-6285.33 1062,-6217.33 1543,-6217.33 1543,-6285.33"/>
<text text-anchor="middle" x="1302.5" y="-6270.13" font-family="Times,serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="1302.5" y="-6255.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1302.5" y="-6240.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1302.5" y="-6225.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_ffn_act_gpu1&#45;&gt;l0_ffn_down_gpu1 -->
<g id="edge22" class="edge">
<title>l0_ffn_act_gpu1&#45;&gt;l0_ffn_down_gpu1</title>
<path fill="none" stroke="black" d="M1302.5,-6357.08C1302.5,-6357.08 1302.5,-6295.71 1302.5,-6295.71"/>
<polygon fill="black" stroke="black" points="1306,-6295.71 1302.5,-6285.71 1299,-6295.71 1306,-6295.71"/>
</g>
<!-- l0_ffn_down_gpu1&#45;&gt;l0_residual_gpu1 -->
<g id="edge24" class="edge">
<title>l0_ffn_down_gpu1&#45;&gt;l0_residual_gpu1</title>
<path fill="none" stroke="black" d="M1307.5,-6217.07C1307.5,-6157.47 1307.5,-6041 1307.5,-6041 1307.5,-6041 2205.93,-6041 2205.93,-6041 2205.93,-6041 2205.93,-6066.99 2205.93,-6066.99"/>
<polygon fill="black" stroke="black" points="2202.43,-6066.99 2205.93,-6076.99 2209.43,-6066.99 2202.43,-6066.99"/>
</g>
<!-- l0_layernorm_gpu1 -->
<g id="node19" class="node">
<title>l0_layernorm_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2699,-6005.33 2240,-6005.33 2240,-5937.33 2699,-5937.33 2699,-6005.33"/>
<text text-anchor="middle" x="2469.5" y="-5990.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="2469.5" y="-5975.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2469.5" y="-5960.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2469.5" y="-5945.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_residual_gpu1&#45;&gt;l0_layernorm_gpu1 -->
<g id="edge25" class="edge">
<title>l0_residual_gpu1&#45;&gt;l0_layernorm_gpu1</title>
<path fill="none" stroke="black" d="M2456,-6077.08C2456,-6077.08 2456,-6015.71 2456,-6015.71"/>
<polygon fill="black" stroke="black" points="2459.5,-6015.71 2456,-6005.71 2452.5,-6015.71 2459.5,-6015.71"/>
</g>
<!-- l0_layernorm_gpu1&#45;&gt;l0_mha_allreduce -->
<g id="edge26" class="edge">
<title>l0_layernorm_gpu1&#45;&gt;l0_mha_allreduce</title>
<path fill="none" stroke="black" d="M2469.5,-5936.96C2469.5,-5936.96 2469.5,-5875.47 2469.5,-5875.47"/>
<polygon fill="black" stroke="black" points="2473,-5875.47 2469.5,-5865.47 2466,-5875.47 2473,-5875.47"/>
</g>
<!-- l0_mha_attn_gpu2 -->
<g id="node21" class="node">
<title>l0_mha_attn_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="3274,-6285.33 2741,-6285.33 2741,-6217.33 3274,-6217.33 3274,-6285.33"/>
<text text-anchor="middle" x="3007.5" y="-6270.13" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="3007.5" y="-6255.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="3007.5" y="-6240.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3007.5" y="-6225.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_mha_qkv_gpu2&#45;&gt;l0_mha_attn_gpu2 -->
<g id="edge30" class="edge">
<title>l0_mha_qkv_gpu2&#45;&gt;l0_mha_attn_gpu2</title>
<path fill="none" stroke="black" d="M3007.5,-6357.08C3007.5,-6357.08 3007.5,-6295.71 3007.5,-6295.71"/>
<polygon fill="black" stroke="black" points="3011,-6295.71 3007.5,-6285.71 3004,-6295.71 3011,-6295.71"/>
</g>
<!-- l0_residual_gpu2 -->
<g id="node26" class="node">
<title>l0_residual_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="3247,-6145.33 2768,-6145.33 2768,-6077.33 3247,-6077.33 3247,-6145.33"/>
<text text-anchor="middle" x="3007.5" y="-6130.13" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3007.5" y="-6115.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024] (x2)</text>
<text text-anchor="middle" x="3007.5" y="-6100.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3007.5" y="-6085.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_mha_attn_gpu2&#45;&gt;l0_residual_gpu2 -->
<g id="edge36" class="edge">
<title>l0_mha_attn_gpu2&#45;&gt;l0_residual_gpu2</title>
<path fill="none" stroke="black" d="M3007.5,-6217.08C3007.5,-6217.08 3007.5,-6155.71 3007.5,-6155.71"/>
<polygon fill="black" stroke="black" points="3011,-6155.71 3007.5,-6145.71 3004,-6155.71 3011,-6155.71"/>
</g>
<!-- l0_ffn_act_gpu2 -->
<g id="node24" class="node">
<title>l0_ffn_act_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="4396,-6425.33 3903,-6425.33 3903,-6357.33 4396,-6357.33 4396,-6425.33"/>
<text text-anchor="middle" x="4149.5" y="-6410.13" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="4149.5" y="-6395.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4149.5" y="-6380.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4149.5" y="-6365.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_ffn_up_gpu2&#45;&gt;l0_ffn_act_gpu2 -->
<g id="edge33" class="edge">
<title>l0_ffn_up_gpu2&#45;&gt;l0_ffn_act_gpu2</title>
<path fill="none" stroke="black" d="M4135.5,-6530.96C4135.5,-6530.96 4135.5,-6435.34 4135.5,-6435.34"/>
<polygon fill="black" stroke="black" points="4139,-6435.34 4135.5,-6425.34 4132,-6435.34 4139,-6435.34"/>
</g>
<!-- l0_ffn_gate_gpu2&#45;&gt;l0_ffn_act_gpu2 -->
<g id="edge34" class="edge">
<title>l0_ffn_gate_gpu2&#45;&gt;l0_ffn_act_gpu2</title>
<path fill="none" stroke="black" d="M3839.05,-6565C3858.61,-6565 3871,-6565 3871,-6565 3871,-6565 3871,-6391 3871,-6391 3871,-6391 3892.95,-6391 3892.95,-6391"/>
<polygon fill="black" stroke="black" points="3892.95,-6394.5 3902.95,-6391 3892.95,-6387.5 3892.95,-6394.5"/>
</g>
<!-- l0_ffn_down_gpu2 -->
<g id="node25" class="node">
<title>l0_ffn_down_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="3791,-6285.33 3310,-6285.33 3310,-6217.33 3791,-6217.33 3791,-6285.33"/>
<text text-anchor="middle" x="3550.5" y="-6270.13" font-family="Times,serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="3550.5" y="-6255.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3550.5" y="-6240.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3550.5" y="-6225.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_ffn_act_gpu2&#45;&gt;l0_ffn_down_gpu2 -->
<g id="edge35" class="edge">
<title>l0_ffn_act_gpu2&#45;&gt;l0_ffn_down_gpu2</title>
<path fill="none" stroke="black" d="M4131.5,-6356.99C4131.5,-6339.14 4131.5,-6321 4131.5,-6321 4131.5,-6321 3556.5,-6321 3556.5,-6321 3556.5,-6321 3556.5,-6295.35 3556.5,-6295.35"/>
<polygon fill="black" stroke="black" points="3560,-6295.35 3556.5,-6285.35 3553,-6295.35 3560,-6295.35"/>
</g>
<!-- l0_ffn_down_gpu2&#45;&gt;l0_residual_gpu2 -->
<g id="edge37" class="edge">
<title>l0_ffn_down_gpu2&#45;&gt;l0_residual_gpu2</title>
<path fill="none" stroke="black" d="M3331,-6217C3331,-6175.46 3331,-6111 3331,-6111 3331,-6111 3257.27,-6111 3257.27,-6111"/>
<polygon fill="black" stroke="black" points="3257.27,-6107.5 3247.27,-6111 3257.27,-6114.5 3257.27,-6107.5"/>
</g>
<!-- l0_layernorm_gpu2 -->
<g id="node27" class="node">
<title>l0_layernorm_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="3212,-6005.33 2753,-6005.33 2753,-5937.33 3212,-5937.33 3212,-6005.33"/>
<text text-anchor="middle" x="2982.5" y="-5990.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="2982.5" y="-5975.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2982.5" y="-5960.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2982.5" y="-5945.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_residual_gpu2&#45;&gt;l0_layernorm_gpu2 -->
<g id="edge38" class="edge">
<title>l0_residual_gpu2&#45;&gt;l0_layernorm_gpu2</title>
<path fill="none" stroke="black" d="M2990,-6077.08C2990,-6077.08 2990,-6015.71 2990,-6015.71"/>
<polygon fill="black" stroke="black" points="2993.5,-6015.71 2990,-6005.71 2986.5,-6015.71 2993.5,-6015.71"/>
</g>
<!-- l0_layernorm_gpu2&#45;&gt;l0_mha_allreduce -->
<g id="edge39" class="edge">
<title>l0_layernorm_gpu2&#45;&gt;l0_mha_allreduce</title>
<path fill="none" stroke="black" d="M2977.35,-5936.96C2977.35,-5936.96 2977.35,-5875.47 2977.35,-5875.47"/>
<polygon fill="black" stroke="black" points="2980.85,-5875.47 2977.35,-5865.47 2973.85,-5875.47 2980.85,-5875.47"/>
</g>
<!-- l0_mha_attn_gpu3 -->
<g id="node29" class="node">
<title>l0_mha_attn_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="4360,-6285.33 3827,-6285.33 3827,-6217.33 4360,-6217.33 4360,-6285.33"/>
<text text-anchor="middle" x="4093.5" y="-6270.13" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="4093.5" y="-6255.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="4093.5" y="-6240.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4093.5" y="-6225.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_mha_qkv_gpu3&#45;&gt;l0_mha_attn_gpu3 -->
<g id="edge43" class="edge">
<title>l0_mha_qkv_gpu3&#45;&gt;l0_mha_attn_gpu3</title>
<path fill="none" stroke="black" d="M3847,-6357.08C3847,-6357.08 3847,-6295.71 3847,-6295.71"/>
<polygon fill="black" stroke="black" points="3850.5,-6295.71 3847,-6285.71 3843.5,-6295.71 3850.5,-6295.71"/>
</g>
<!-- l0_residual_gpu3 -->
<g id="node34" class="node">
<title>l0_residual_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="4333,-6145.33 3854,-6145.33 3854,-6077.33 4333,-6077.33 4333,-6145.33"/>
<text text-anchor="middle" x="4093.5" y="-6130.13" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4093.5" y="-6115.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024] (x2)</text>
<text text-anchor="middle" x="4093.5" y="-6100.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4093.5" y="-6085.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_mha_attn_gpu3&#45;&gt;l0_residual_gpu3 -->
<g id="edge49" class="edge">
<title>l0_mha_attn_gpu3&#45;&gt;l0_residual_gpu3</title>
<path fill="none" stroke="black" d="M4093.5,-6217.08C4093.5,-6217.08 4093.5,-6155.71 4093.5,-6155.71"/>
<polygon fill="black" stroke="black" points="4097,-6155.71 4093.5,-6145.71 4090,-6155.71 4097,-6155.71"/>
</g>
<!-- l0_ffn_act_gpu3 -->
<g id="node32" class="node">
<title>l0_ffn_act_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="4925,-6425.33 4432,-6425.33 4432,-6357.33 4925,-6357.33 4925,-6425.33"/>
<text text-anchor="middle" x="4678.5" y="-6410.13" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="4678.5" y="-6395.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4678.5" y="-6380.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4678.5" y="-6365.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_ffn_up_gpu3&#45;&gt;l0_ffn_act_gpu3 -->
<g id="edge46" class="edge">
<title>l0_ffn_up_gpu3&#45;&gt;l0_ffn_act_gpu3</title>
<path fill="none" stroke="black" d="M4932.97,-6565C4919.3,-6565 4911,-6565 4911,-6565 4911,-6565 4911,-6435.64 4911,-6435.64"/>
<polygon fill="black" stroke="black" points="4914.5,-6435.64 4911,-6425.64 4907.5,-6435.64 4914.5,-6435.64"/>
</g>
<!-- l0_ffn_gate_gpu3&#45;&gt;l0_ffn_act_gpu3 -->
<g id="edge47" class="edge">
<title>l0_ffn_gate_gpu3&#45;&gt;l0_ffn_act_gpu3</title>
<path fill="none" stroke="black" d="M4664.5,-6530.96C4664.5,-6530.96 4664.5,-6435.34 4664.5,-6435.34"/>
<polygon fill="black" stroke="black" points="4668,-6435.34 4664.5,-6425.34 4661,-6435.34 4668,-6435.34"/>
</g>
<!-- l0_ffn_down_gpu3 -->
<g id="node33" class="node">
<title>l0_ffn_down_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="4898,-6285.33 4417,-6285.33 4417,-6217.33 4898,-6217.33 4898,-6285.33"/>
<text text-anchor="middle" x="4657.5" y="-6270.13" font-family="Times,serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="4657.5" y="-6255.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4657.5" y="-6240.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4657.5" y="-6225.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_ffn_act_gpu3&#45;&gt;l0_ffn_down_gpu3 -->
<g id="edge48" class="edge">
<title>l0_ffn_act_gpu3&#45;&gt;l0_ffn_down_gpu3</title>
<path fill="none" stroke="black" d="M4665,-6357.08C4665,-6357.08 4665,-6295.71 4665,-6295.71"/>
<polygon fill="black" stroke="black" points="4668.5,-6295.71 4665,-6285.71 4661.5,-6295.71 4668.5,-6295.71"/>
</g>
<!-- l0_ffn_down_gpu3&#45;&gt;l0_residual_gpu3 -->
<g id="edge50" class="edge">
<title>l0_ffn_down_gpu3&#45;&gt;l0_residual_gpu3</title>
<path fill="none" stroke="black" d="M4653.5,-6217C4653.5,-6175.46 4653.5,-6111 4653.5,-6111 4653.5,-6111 4343.02,-6111 4343.02,-6111"/>
<polygon fill="black" stroke="black" points="4343.02,-6107.5 4333.02,-6111 4343.02,-6114.5 4343.02,-6107.5"/>
</g>
<!-- l0_layernorm_gpu3 -->
<g id="node35" class="node">
<title>l0_layernorm_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="4012,-6005.33 3553,-6005.33 3553,-5937.33 4012,-5937.33 4012,-6005.33"/>
<text text-anchor="middle" x="3782.5" y="-5990.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="3782.5" y="-5975.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3782.5" y="-5960.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3782.5" y="-5945.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_residual_gpu3&#45;&gt;l0_layernorm_gpu3 -->
<g id="edge51" class="edge">
<title>l0_residual_gpu3&#45;&gt;l0_layernorm_gpu3</title>
<path fill="none" stroke="black" d="M3933,-6077.08C3933,-6077.08 3933,-6015.71 3933,-6015.71"/>
<polygon fill="black" stroke="black" points="3936.5,-6015.71 3933,-6005.71 3929.5,-6015.71 3936.5,-6015.71"/>
</g>
<!-- l0_layernorm_gpu3&#45;&gt;l0_mha_allreduce -->
<g id="edge52" class="edge">
<title>l0_layernorm_gpu3&#45;&gt;l0_mha_allreduce</title>
<path fill="none" stroke="black" d="M3692.5,-5937.31C3692.5,-5886.57 3692.5,-5797 3692.5,-5797 3692.5,-5797 3112.24,-5797 3112.24,-5797"/>
<polygon fill="black" stroke="black" points="3112.24,-5793.5 3102.24,-5797 3112.24,-5800.5 3112.24,-5793.5"/>
</g>
<!-- l0_ffn_allreduce -->
<g id="node37" class="node">
<title>l0_ffn_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="3201.9,-5657.33 2429.74,-5657.33 2231.1,-5521.33 3003.26,-5521.33 3201.9,-5657.33"/>
<text text-anchor="middle" x="2716.5" y="-5608.13" font-family="Times,serif" font-size="14.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="2716.5" y="-5593.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="2716.5" y="-5578.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2716.5" y="-5563.13" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
</g>
<!-- l0_mha_allreduce&#45;&gt;l0_ffn_allreduce -->
<g id="edge14" class="edge">
<title>l0_mha_allreduce&#45;&gt;l0_ffn_allreduce</title>
<path fill="none" stroke="black" d="M2425.38,-5729.23C2425.38,-5729.23 2425.38,-5664.41 2425.38,-5664.41"/>
<polygon fill="black" stroke="black" points="2428.88,-5664.41 2425.38,-5654.41 2421.88,-5664.41 2428.88,-5664.41"/>
</g>
<!-- l0_mha_allreduce&#45;&gt;l0_ffn_allreduce -->
<g id="edge27" class="edge">
<title>l0_mha_allreduce&#45;&gt;l0_ffn_allreduce</title>
<path fill="none" stroke="black" d="M2619.46,-5729.23C2619.46,-5729.23 2619.46,-5667.59 2619.46,-5667.59"/>
<polygon fill="black" stroke="black" points="2622.96,-5667.59 2619.46,-5657.59 2615.96,-5667.59 2622.96,-5667.59"/>
</g>
<!-- l0_mha_allreduce&#45;&gt;l0_ffn_allreduce -->
<g id="edge40" class="edge">
<title>l0_mha_allreduce&#45;&gt;l0_ffn_allreduce</title>
<path fill="none" stroke="black" d="M2813.54,-5729.23C2813.54,-5729.23 2813.54,-5667.59 2813.54,-5667.59"/>
<polygon fill="black" stroke="black" points="2817.04,-5667.59 2813.54,-5657.59 2810.04,-5667.59 2817.04,-5667.59"/>
</g>
<!-- l0_mha_allreduce&#45;&gt;l0_ffn_allreduce -->
<g id="edge53" class="edge">
<title>l0_mha_allreduce&#45;&gt;l0_ffn_allreduce</title>
<path fill="none" stroke="black" d="M3007.62,-5732.09C3007.62,-5732.09 3007.62,-5667.58 3007.62,-5667.58"/>
<polygon fill="black" stroke="black" points="3011.12,-5667.58 3007.62,-5657.58 3004.12,-5667.58 3011.12,-5667.58"/>
</g>
<!-- l0_output -->
<g id="node38" class="node">
<title>l0_output</title>
<ellipse fill="lightblue" stroke="black" cx="2716.5" cy="-5401.25" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="2716.5" y="-5420.05" font-family="Times,serif" font-size="14.00">Layer 0 Output</text>
<text text-anchor="middle" x="2716.5" y="-5405.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2716.5" y="-5390.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2716.5" y="-5375.05" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
</g>
<!-- l0_ffn_allreduce&#45;&gt;l0_output -->
<g id="edge15" class="edge">
<title>l0_ffn_allreduce&#45;&gt;l0_output</title>
<path fill="none" stroke="black" d="M2521.76,-5521.16C2521.76,-5521.16 2521.76,-5449.94 2521.76,-5449.94"/>
<polygon fill="black" stroke="black" points="2525.26,-5449.94 2521.76,-5439.94 2518.26,-5449.94 2525.26,-5449.94"/>
</g>
<!-- l0_ffn_allreduce&#45;&gt;l0_output -->
<g id="edge28" class="edge">
<title>l0_ffn_allreduce&#45;&gt;l0_output</title>
<path fill="none" stroke="black" d="M2651.59,-5521.16C2651.59,-5521.16 2651.59,-5458.59 2651.59,-5458.59"/>
<polygon fill="black" stroke="black" points="2655.09,-5458.59 2651.59,-5448.59 2648.09,-5458.59 2655.09,-5458.59"/>
</g>
<!-- l0_ffn_allreduce&#45;&gt;l0_output -->
<g id="edge41" class="edge">
<title>l0_ffn_allreduce&#45;&gt;l0_output</title>
<path fill="none" stroke="black" d="M2781.41,-5521.16C2781.41,-5521.16 2781.41,-5458.59 2781.41,-5458.59"/>
<polygon fill="black" stroke="black" points="2784.91,-5458.59 2781.41,-5448.59 2777.91,-5458.59 2784.91,-5458.59"/>
</g>
<!-- l0_ffn_allreduce&#45;&gt;l0_output -->
<g id="edge54" class="edge">
<title>l0_ffn_allreduce&#45;&gt;l0_output</title>
<path fill="none" stroke="black" d="M2911.24,-5521.16C2911.24,-5521.16 2911.24,-5449.94 2911.24,-5449.94"/>
<polygon fill="black" stroke="black" points="2914.74,-5449.94 2911.24,-5439.94 2907.74,-5449.94 2914.74,-5449.94"/>
</g>
<!-- send_l0_l1 -->
<g id="node39" class="node">
<title>send_l0_l1</title>
<ellipse fill="orange" stroke="black" cx="2716.5" cy="-5233.08" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="2716.5" y="-5251.88" font-family="Times,serif" font-size="14.00">Pipeline Send</text>
<text text-anchor="middle" x="2716.5" y="-5236.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2716.5" y="-5221.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2716.5" y="-5206.88" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- l0_output&#45;&gt;send_l0_l1 -->
<g id="edge55" class="edge">
<title>l0_output&#45;&gt;send_l0_l1</title>
<path fill="none" stroke="black" d="M2716.5,-5353.06C2716.5,-5353.06 2716.5,-5291.28 2716.5,-5291.28"/>
<polygon fill="black" stroke="black" points="2720,-5291.28 2716.5,-5281.28 2713,-5291.28 2720,-5291.28"/>
</g>
<!-- l1_input_split -->
<g id="node40" class="node">
<title>l1_input_split</title>
<polygon fill="lightyellow" stroke="black" points="3214.28,-5113 2422.42,-5113 2218.72,-4977 3010.58,-4977 3214.28,-5113"/>
<text text-anchor="middle" x="2716.5" y="-5063.8" font-family="Times,serif" font-size="14.00">Input Broadcast</text>
<text text-anchor="middle" x="2716.5" y="-5048.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2716.5" y="-5033.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]×4</text>
<text text-anchor="middle" x="2716.5" y="-5018.8" font-family="Times,serif" font-size="14.00">GPU: 4&#45;7</text>
</g>
<!-- send_l0_l1&#45;&gt;l1_input_split -->
<g id="edge56" class="edge">
<title>send_l0_l1&#45;&gt;l1_input_split</title>
<path fill="none" stroke="black" d="M2716.5,-5184.65C2716.5,-5184.65 2716.5,-5123.12 2716.5,-5123.12"/>
<polygon fill="black" stroke="black" points="2720,-5123.12 2716.5,-5113.12 2713,-5123.12 2720,-5123.12"/>
</g>
<!-- l1_mha_qkv_split -->
<g id="node41" class="node">
<title>l1_mha_qkv_split</title>
<polygon fill="lightyellow" stroke="black" points="3303.1,-4905 2369.95,-4905 2129.9,-4769 3063.05,-4769 3303.1,-4905"/>
<text text-anchor="middle" x="2716.5" y="-4855.8" font-family="Times,serif" font-size="14.00">QKV Split</text>
<text text-anchor="middle" x="2716.5" y="-4840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2716.5" y="-4825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]×4</text>
<text text-anchor="middle" x="2716.5" y="-4810.8" font-family="Times,serif" font-size="14.00">GPU: 4&#45;7</text>
</g>
<!-- l1_input_split&#45;&gt;l1_mha_qkv_split -->
<g id="edge57" class="edge">
<title>l1_input_split&#45;&gt;l1_mha_qkv_split</title>
<path fill="none" stroke="black" d="M2716.5,-4976.89C2716.5,-4976.89 2716.5,-4915.26 2716.5,-4915.26"/>
<polygon fill="black" stroke="black" points="2720,-4915.26 2716.5,-4905.26 2713,-4915.26 2720,-4915.26"/>
</g>
<!-- l1_ffn_up_gpu4 -->
<g id="node44" class="node">
<title>l1_ffn_up_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="1036,-4871 543,-4871 543,-4803 1036,-4803 1036,-4871"/>
<text text-anchor="middle" x="789.5" y="-4855.8" font-family="Times,serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="789.5" y="-4840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="789.5" y="-4825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="789.5" y="-4810.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_input_split&#45;&gt;l1_ffn_up_gpu4 -->
<g id="edge60" class="edge">
<title>l1_input_split&#45;&gt;l1_ffn_up_gpu4</title>
<path fill="none" stroke="black" d="M2339.79,-5058C1841.34,-5058 1025,-5058 1025,-5058 1025,-5058 1025,-4881.05 1025,-4881.05"/>
<polygon fill="black" stroke="black" points="1028.5,-4881.05 1025,-4871.05 1021.5,-4881.05 1028.5,-4881.05"/>
</g>
<!-- l1_ffn_gate_gpu4 -->
<g id="node45" class="node">
<title>l1_ffn_gate_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="507,-4871 14,-4871 14,-4803 507,-4803 507,-4871"/>
<text text-anchor="middle" x="260.5" y="-4855.8" font-family="Times,serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="260.5" y="-4840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="260.5" y="-4825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="260.5" y="-4810.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_input_split&#45;&gt;l1_ffn_gate_gpu4 -->
<g id="edge61" class="edge">
<title>l1_input_split&#45;&gt;l1_ffn_gate_gpu4</title>
<path fill="none" stroke="black" d="M2380.31,-5085C1708.5,-5085 264,-5085 264,-5085 264,-5085 264,-4881.22 264,-4881.22"/>
<polygon fill="black" stroke="black" points="267.5,-4881.22 264,-4871.22 260.5,-4881.22 267.5,-4881.22"/>
</g>
<!-- l1_ffn_up_gpu5 -->
<g id="node52" class="node">
<title>l1_ffn_up_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="1565,-4871 1072,-4871 1072,-4803 1565,-4803 1565,-4871"/>
<text text-anchor="middle" x="1318.5" y="-4855.8" font-family="Times,serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="1318.5" y="-4840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1318.5" y="-4825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1318.5" y="-4810.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_input_split&#45;&gt;l1_ffn_up_gpu5 -->
<g id="edge73" class="edge">
<title>l1_input_split&#45;&gt;l1_ffn_up_gpu5</title>
<path fill="none" stroke="black" d="M2299.27,-5031C1965.85,-5031 1554,-5031 1554,-5031 1554,-5031 1554,-4881.24 1554,-4881.24"/>
<polygon fill="black" stroke="black" points="1557.5,-4881.24 1554,-4871.24 1550.5,-4881.24 1557.5,-4881.24"/>
</g>
<!-- l1_ffn_gate_gpu5 -->
<g id="node53" class="node">
<title>l1_ffn_gate_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="2094,-4871 1601,-4871 1601,-4803 2094,-4803 2094,-4871"/>
<text text-anchor="middle" x="1847.5" y="-4855.8" font-family="Times,serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="1847.5" y="-4840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1847.5" y="-4825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1847.5" y="-4810.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_input_split&#45;&gt;l1_ffn_gate_gpu5 -->
<g id="edge74" class="edge">
<title>l1_input_split&#45;&gt;l1_ffn_gate_gpu5</title>
<path fill="none" stroke="black" d="M2259.09,-5004C2071.72,-5004 1898,-5004 1898,-5004 1898,-5004 1898,-4881.2 1898,-4881.2"/>
<polygon fill="black" stroke="black" points="1901.5,-4881.2 1898,-4871.2 1894.5,-4881.2 1901.5,-4881.2"/>
</g>
<!-- l1_ffn_up_gpu6 -->
<g id="node60" class="node">
<title>l1_ffn_up_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="4361,-4871 3868,-4871 3868,-4803 4361,-4803 4361,-4871"/>
<text text-anchor="middle" x="4114.5" y="-4855.8" font-family="Times,serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="4114.5" y="-4840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4114.5" y="-4825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4114.5" y="-4810.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_input_split&#45;&gt;l1_ffn_up_gpu6 -->
<g id="edge86" class="edge">
<title>l1_input_split&#45;&gt;l1_ffn_up_gpu6</title>
<path fill="none" stroke="black" d="M3091.49,-5031C3451.18,-5031 3940,-5031 3940,-5031 3940,-5031 3940,-4881.24 3940,-4881.24"/>
<polygon fill="black" stroke="black" points="3943.5,-4881.24 3940,-4871.24 3936.5,-4881.24 3943.5,-4881.24"/>
</g>
<!-- l1_ffn_gate_gpu6 -->
<g id="node61" class="node">
<title>l1_ffn_gate_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="3832,-4871 3339,-4871 3339,-4803 3832,-4803 3832,-4871"/>
<text text-anchor="middle" x="3585.5" y="-4855.8" font-family="Times,serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="3585.5" y="-4840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3585.5" y="-4825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3585.5" y="-4810.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_input_split&#45;&gt;l1_ffn_gate_gpu6 -->
<g id="edge87" class="edge">
<title>l1_input_split&#45;&gt;l1_ffn_gate_gpu6</title>
<path fill="none" stroke="black" d="M3051.09,-5004C3242.94,-5004 3446,-5004 3446,-5004 3446,-5004 3446,-4881.2 3446,-4881.2"/>
<polygon fill="black" stroke="black" points="3449.5,-4881.2 3446,-4871.2 3442.5,-4881.2 3449.5,-4881.2"/>
</g>
<!-- l1_ffn_up_gpu7 -->
<g id="node68" class="node">
<title>l1_ffn_up_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="5419,-4871 4926,-4871 4926,-4803 5419,-4803 5419,-4871"/>
<text text-anchor="middle" x="5172.5" y="-4855.8" font-family="Times,serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="5172.5" y="-4840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5172.5" y="-4825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="5172.5" y="-4810.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_input_split&#45;&gt;l1_ffn_up_gpu7 -->
<g id="edge99" class="edge">
<title>l1_input_split&#45;&gt;l1_ffn_up_gpu7</title>
<path fill="none" stroke="black" d="M3172.35,-5085C3820.18,-5085 4929.5,-5085 4929.5,-5085 4929.5,-5085 4929.5,-4881.22 4929.5,-4881.22"/>
<polygon fill="black" stroke="black" points="4933,-4881.22 4929.5,-4871.22 4926,-4881.22 4933,-4881.22"/>
</g>
<!-- l1_ffn_gate_gpu7 -->
<g id="node69" class="node">
<title>l1_ffn_gate_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="4890,-4871 4397,-4871 4397,-4803 4890,-4803 4890,-4871"/>
<text text-anchor="middle" x="4643.5" y="-4855.8" font-family="Times,serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="4643.5" y="-4840.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4643.5" y="-4825.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4643.5" y="-4810.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_input_split&#45;&gt;l1_ffn_gate_gpu7 -->
<g id="edge100" class="edge">
<title>l1_input_split&#45;&gt;l1_ffn_gate_gpu7</title>
<path fill="none" stroke="black" d="M3131.96,-5058C3630.62,-5058 4400.5,-5058 4400.5,-5058 4400.5,-5058 4400.5,-4881.05 4400.5,-4881.05"/>
<polygon fill="black" stroke="black" points="4404,-4881.05 4400.5,-4871.05 4397,-4881.05 4404,-4881.05"/>
</g>
<!-- l1_mha_qkv_gpu4 -->
<g id="node42" class="node">
<title>l1_mha_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="2117,-4697 1572,-4697 1572,-4629 2117,-4629 2117,-4697"/>
<text text-anchor="middle" x="1844.5" y="-4681.8" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="1844.5" y="-4666.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1844.5" y="-4651.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="1844.5" y="-4636.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_mha_qkv_split&#45;&gt;l1_mha_qkv_gpu4 -->
<g id="edge58" class="edge">
<title>l1_mha_qkv_split&#45;&gt;l1_mha_qkv_gpu4</title>
<path fill="none" stroke="black" d="M2158.12,-4785C2125.44,-4785 2105.5,-4785 2105.5,-4785 2105.5,-4785 2105.5,-4707.31 2105.5,-4707.31"/>
<polygon fill="black" stroke="black" points="2109,-4707.31 2105.5,-4697.31 2102,-4707.31 2109,-4707.31"/>
</g>
<!-- l1_mha_qkv_gpu5 -->
<g id="node50" class="node">
<title>l1_mha_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="2698,-4697 2153,-4697 2153,-4629 2698,-4629 2698,-4697"/>
<text text-anchor="middle" x="2425.5" y="-4681.8" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="2425.5" y="-4666.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2425.5" y="-4651.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="2425.5" y="-4636.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_mha_qkv_split&#45;&gt;l1_mha_qkv_gpu5 -->
<g id="edge71" class="edge">
<title>l1_mha_qkv_split&#45;&gt;l1_mha_qkv_gpu5</title>
<path fill="none" stroke="black" d="M2425.5,-4768.73C2425.5,-4768.73 2425.5,-4707.11 2425.5,-4707.11"/>
<polygon fill="black" stroke="black" points="2429,-4707.11 2425.5,-4697.11 2422,-4707.11 2429,-4707.11"/>
</g>
<!-- l1_mha_qkv_gpu6 -->
<g id="node58" class="node">
<title>l1_mha_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="3279,-4697 2734,-4697 2734,-4629 3279,-4629 3279,-4697"/>
<text text-anchor="middle" x="3006.5" y="-4681.8" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="3006.5" y="-4666.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3006.5" y="-4651.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="3006.5" y="-4636.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_mha_qkv_split&#45;&gt;l1_mha_qkv_gpu6 -->
<g id="edge84" class="edge">
<title>l1_mha_qkv_split&#45;&gt;l1_mha_qkv_gpu6</title>
<path fill="none" stroke="black" d="M3006.5,-4768.73C3006.5,-4768.73 3006.5,-4707.11 3006.5,-4707.11"/>
<polygon fill="black" stroke="black" points="3010,-4707.11 3006.5,-4697.11 3003,-4707.11 3010,-4707.11"/>
</g>
<!-- l1_mha_qkv_gpu7 -->
<g id="node66" class="node">
<title>l1_mha_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="3860,-4697 3315,-4697 3315,-4629 3860,-4629 3860,-4697"/>
<text text-anchor="middle" x="3587.5" y="-4681.8" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="3587.5" y="-4666.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3587.5" y="-4651.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="3587.5" y="-4636.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_mha_qkv_split&#45;&gt;l1_mha_qkv_gpu7 -->
<g id="edge97" class="edge">
<title>l1_mha_qkv_split&#45;&gt;l1_mha_qkv_gpu7</title>
<path fill="none" stroke="black" d="M3091.55,-4785C3215.8,-4785 3323,-4785 3323,-4785 3323,-4785 3323,-4707.31 3323,-4707.31"/>
<polygon fill="black" stroke="black" points="3326.5,-4707.31 3323,-4697.31 3319.5,-4707.31 3326.5,-4707.31"/>
</g>
<!-- l1_mha_attn_gpu4 -->
<g id="node43" class="node">
<title>l1_mha_attn_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="2111,-4557 1578,-4557 1578,-4489 2111,-4489 2111,-4557"/>
<text text-anchor="middle" x="1844.5" y="-4541.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="1844.5" y="-4526.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="1844.5" y="-4511.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1844.5" y="-4496.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_mha_qkv_gpu4&#45;&gt;l1_mha_attn_gpu4 -->
<g id="edge59" class="edge">
<title>l1_mha_qkv_gpu4&#45;&gt;l1_mha_attn_gpu4</title>
<path fill="none" stroke="black" d="M1844.5,-4628.75C1844.5,-4628.75 1844.5,-4567.38 1844.5,-4567.38"/>
<polygon fill="black" stroke="black" points="1848,-4567.38 1844.5,-4557.38 1841,-4567.38 1848,-4567.38"/>
</g>
<!-- l1_residual_gpu4 -->
<g id="node48" class="node">
<title>l1_residual_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="2084,-4417 1605,-4417 1605,-4349 2084,-4349 2084,-4417"/>
<text text-anchor="middle" x="1844.5" y="-4401.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1844.5" y="-4386.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024] (x2)</text>
<text text-anchor="middle" x="1844.5" y="-4371.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1844.5" y="-4356.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_mha_attn_gpu4&#45;&gt;l1_residual_gpu4 -->
<g id="edge65" class="edge">
<title>l1_mha_attn_gpu4&#45;&gt;l1_residual_gpu4</title>
<path fill="none" stroke="black" d="M1844.5,-4488.75C1844.5,-4488.75 1844.5,-4427.38 1844.5,-4427.38"/>
<polygon fill="black" stroke="black" points="1848,-4427.38 1844.5,-4417.38 1841,-4427.38 1848,-4427.38"/>
</g>
<!-- l1_ffn_act_gpu4 -->
<g id="node46" class="node">
<title>l1_ffn_act_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="1007,-4697 514,-4697 514,-4629 1007,-4629 1007,-4697"/>
<text text-anchor="middle" x="760.5" y="-4681.8" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="760.5" y="-4666.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="760.5" y="-4651.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="760.5" y="-4636.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_ffn_up_gpu4&#45;&gt;l1_ffn_act_gpu4 -->
<g id="edge62" class="edge">
<title>l1_ffn_up_gpu4&#45;&gt;l1_ffn_act_gpu4</title>
<path fill="none" stroke="black" d="M775,-4802.62C775,-4802.62 775,-4707.01 775,-4707.01"/>
<polygon fill="black" stroke="black" points="778.5,-4707.01 775,-4697.01 771.5,-4707.01 778.5,-4707.01"/>
</g>
<!-- l1_ffn_gate_gpu4&#45;&gt;l1_ffn_act_gpu4 -->
<g id="edge63" class="edge">
<title>l1_ffn_gate_gpu4&#45;&gt;l1_ffn_act_gpu4</title>
<path fill="none" stroke="black" d="M507.11,-4836C513.73,-4836 517.5,-4836 517.5,-4836 517.5,-4836 517.5,-4707.18 517.5,-4707.18"/>
<polygon fill="black" stroke="black" points="521,-4707.18 517.5,-4697.18 514,-4707.18 521,-4707.18"/>
</g>
<!-- l1_ffn_down_gpu4 -->
<g id="node47" class="node">
<title>l1_ffn_down_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="1007,-4557 526,-4557 526,-4489 1007,-4489 1007,-4557"/>
<text text-anchor="middle" x="766.5" y="-4541.8" font-family="Times,serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="766.5" y="-4526.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="766.5" y="-4511.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="766.5" y="-4496.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_ffn_act_gpu4&#45;&gt;l1_ffn_down_gpu4 -->
<g id="edge64" class="edge">
<title>l1_ffn_act_gpu4&#45;&gt;l1_ffn_down_gpu4</title>
<path fill="none" stroke="black" d="M766.5,-4628.75C766.5,-4628.75 766.5,-4567.38 766.5,-4567.38"/>
<polygon fill="black" stroke="black" points="770,-4567.38 766.5,-4557.38 763,-4567.38 770,-4567.38"/>
</g>
<!-- l1_ffn_down_gpu4&#45;&gt;l1_residual_gpu4 -->
<g id="edge66" class="edge">
<title>l1_ffn_down_gpu4&#45;&gt;l1_residual_gpu4</title>
<path fill="none" stroke="black" d="M771.5,-4488.87C771.5,-4447.14 771.5,-4382 771.5,-4382 771.5,-4382 1594.7,-4382 1594.7,-4382"/>
<polygon fill="black" stroke="black" points="1594.7,-4385.5 1604.7,-4382 1594.7,-4378.5 1594.7,-4385.5"/>
</g>
<!-- l1_layernorm_gpu4 -->
<g id="node49" class="node">
<title>l1_layernorm_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="2154,-4277 1695,-4277 1695,-4209 2154,-4209 2154,-4277"/>
<text text-anchor="middle" x="1924.5" y="-4261.8" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1924.5" y="-4246.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1924.5" y="-4231.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1924.5" y="-4216.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_residual_gpu4&#45;&gt;l1_layernorm_gpu4 -->
<g id="edge67" class="edge">
<title>l1_residual_gpu4&#45;&gt;l1_layernorm_gpu4</title>
<path fill="none" stroke="black" d="M1889.5,-4348.75C1889.5,-4348.75 1889.5,-4287.38 1889.5,-4287.38"/>
<polygon fill="black" stroke="black" points="1893,-4287.38 1889.5,-4277.38 1886,-4287.38 1893,-4287.38"/>
</g>
<!-- l1_mha_allreduce -->
<g id="node74" class="node">
<title>l1_mha_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="3194.9,-4137 2422.74,-4137 2224.1,-4001 2996.26,-4001 3194.9,-4137"/>
<text text-anchor="middle" x="2709.5" y="-4087.8" font-family="Times,serif" font-size="14.00">MHA All&#45;Reduce</text>
<text text-anchor="middle" x="2709.5" y="-4072.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="2709.5" y="-4057.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2709.5" y="-4042.8" font-family="Times,serif" font-size="14.00">GPU: 4&#45;7</text>
</g>
<!-- l1_layernorm_gpu4&#45;&gt;l1_mha_allreduce -->
<g id="edge68" class="edge">
<title>l1_layernorm_gpu4&#45;&gt;l1_mha_allreduce</title>
<path fill="none" stroke="black" d="M2154.25,-4242C2197.06,-4242 2228.65,-4242 2228.65,-4242 2228.65,-4242 2228.65,-4079.12 2228.65,-4079.12"/>
<polygon fill="black" stroke="black" points="2232.15,-4079.12 2228.65,-4069.12 2225.15,-4079.12 2232.15,-4079.12"/>
</g>
<!-- l1_mha_attn_gpu5 -->
<g id="node51" class="node">
<title>l1_mha_attn_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="2692,-4557 2159,-4557 2159,-4489 2692,-4489 2692,-4557"/>
<text text-anchor="middle" x="2425.5" y="-4541.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="2425.5" y="-4526.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="2425.5" y="-4511.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2425.5" y="-4496.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_mha_qkv_gpu5&#45;&gt;l1_mha_attn_gpu5 -->
<g id="edge72" class="edge">
<title>l1_mha_qkv_gpu5&#45;&gt;l1_mha_attn_gpu5</title>
<path fill="none" stroke="black" d="M2425.5,-4628.75C2425.5,-4628.75 2425.5,-4567.38 2425.5,-4567.38"/>
<polygon fill="black" stroke="black" points="2429,-4567.38 2425.5,-4557.38 2422,-4567.38 2429,-4567.38"/>
</g>
<!-- l1_residual_gpu5 -->
<g id="node56" class="node">
<title>l1_residual_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="2665,-4417 2186,-4417 2186,-4349 2665,-4349 2665,-4417"/>
<text text-anchor="middle" x="2425.5" y="-4401.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2425.5" y="-4386.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024] (x2)</text>
<text text-anchor="middle" x="2425.5" y="-4371.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2425.5" y="-4356.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_mha_attn_gpu5&#45;&gt;l1_residual_gpu5 -->
<g id="edge78" class="edge">
<title>l1_mha_attn_gpu5&#45;&gt;l1_residual_gpu5</title>
<path fill="none" stroke="black" d="M2425.5,-4488.75C2425.5,-4488.75 2425.5,-4427.38 2425.5,-4427.38"/>
<polygon fill="black" stroke="black" points="2429,-4427.38 2425.5,-4417.38 2422,-4427.38 2429,-4427.38"/>
</g>
<!-- l1_ffn_act_gpu5 -->
<g id="node54" class="node">
<title>l1_ffn_act_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="1536,-4697 1043,-4697 1043,-4629 1536,-4629 1536,-4697"/>
<text text-anchor="middle" x="1289.5" y="-4681.8" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="1289.5" y="-4666.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1289.5" y="-4651.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1289.5" y="-4636.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_ffn_up_gpu5&#45;&gt;l1_ffn_act_gpu5 -->
<g id="edge75" class="edge">
<title>l1_ffn_up_gpu5&#45;&gt;l1_ffn_act_gpu5</title>
<path fill="none" stroke="black" d="M1304,-4802.62C1304,-4802.62 1304,-4707.01 1304,-4707.01"/>
<polygon fill="black" stroke="black" points="1307.5,-4707.01 1304,-4697.01 1300.5,-4707.01 1307.5,-4707.01"/>
</g>
<!-- l1_ffn_gate_gpu5&#45;&gt;l1_ffn_act_gpu5 -->
<g id="edge76" class="edge">
<title>l1_ffn_gate_gpu5&#45;&gt;l1_ffn_act_gpu5</title>
<path fill="none" stroke="black" d="M1600.78,-4836C1581.03,-4836 1568.5,-4836 1568.5,-4836 1568.5,-4836 1568.5,-4662 1568.5,-4662 1568.5,-4662 1546.22,-4662 1546.22,-4662"/>
<polygon fill="black" stroke="black" points="1546.22,-4658.5 1536.22,-4662 1546.22,-4665.5 1546.22,-4658.5"/>
</g>
<!-- l1_ffn_down_gpu5 -->
<g id="node55" class="node">
<title>l1_ffn_down_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="1536,-4557 1055,-4557 1055,-4489 1536,-4489 1536,-4557"/>
<text text-anchor="middle" x="1295.5" y="-4541.8" font-family="Times,serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="1295.5" y="-4526.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1295.5" y="-4511.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1295.5" y="-4496.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_ffn_act_gpu5&#45;&gt;l1_ffn_down_gpu5 -->
<g id="edge77" class="edge">
<title>l1_ffn_act_gpu5&#45;&gt;l1_ffn_down_gpu5</title>
<path fill="none" stroke="black" d="M1295.5,-4628.75C1295.5,-4628.75 1295.5,-4567.38 1295.5,-4567.38"/>
<polygon fill="black" stroke="black" points="1299,-4567.38 1295.5,-4557.38 1292,-4567.38 1299,-4567.38"/>
</g>
<!-- l1_ffn_down_gpu5&#45;&gt;l1_residual_gpu5 -->
<g id="edge79" class="edge">
<title>l1_ffn_down_gpu5&#45;&gt;l1_residual_gpu5</title>
<path fill="none" stroke="black" d="M1300.5,-4488.63C1300.5,-4428.84 1300.5,-4312 1300.5,-4312 1300.5,-4312 2198.93,-4312 2198.93,-4312 2198.93,-4312 2198.93,-4338.75 2198.93,-4338.75"/>
<polygon fill="black" stroke="black" points="2195.43,-4338.75 2198.93,-4348.75 2202.43,-4338.75 2195.43,-4338.75"/>
</g>
<!-- l1_layernorm_gpu5 -->
<g id="node57" class="node">
<title>l1_layernorm_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="2692,-4277 2233,-4277 2233,-4209 2692,-4209 2692,-4277"/>
<text text-anchor="middle" x="2462.5" y="-4261.8" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="2462.5" y="-4246.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2462.5" y="-4231.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2462.5" y="-4216.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_residual_gpu5&#45;&gt;l1_layernorm_gpu5 -->
<g id="edge80" class="edge">
<title>l1_residual_gpu5&#45;&gt;l1_layernorm_gpu5</title>
<path fill="none" stroke="black" d="M2449,-4348.75C2449,-4348.75 2449,-4287.38 2449,-4287.38"/>
<polygon fill="black" stroke="black" points="2452.5,-4287.38 2449,-4277.38 2445.5,-4287.38 2452.5,-4287.38"/>
</g>
<!-- l1_layernorm_gpu5&#45;&gt;l1_mha_allreduce -->
<g id="edge81" class="edge">
<title>l1_layernorm_gpu5&#45;&gt;l1_mha_allreduce</title>
<path fill="none" stroke="black" d="M2462.5,-4208.62C2462.5,-4208.62 2462.5,-4147.14 2462.5,-4147.14"/>
<polygon fill="black" stroke="black" points="2466,-4147.14 2462.5,-4137.14 2459,-4147.14 2466,-4147.14"/>
</g>
<!-- l1_mha_attn_gpu6 -->
<g id="node59" class="node">
<title>l1_mha_attn_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="3267,-4557 2734,-4557 2734,-4489 3267,-4489 3267,-4557"/>
<text text-anchor="middle" x="3000.5" y="-4541.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="3000.5" y="-4526.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="3000.5" y="-4511.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3000.5" y="-4496.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_mha_qkv_gpu6&#45;&gt;l1_mha_attn_gpu6 -->
<g id="edge85" class="edge">
<title>l1_mha_qkv_gpu6&#45;&gt;l1_mha_attn_gpu6</title>
<path fill="none" stroke="black" d="M3000.5,-4628.75C3000.5,-4628.75 3000.5,-4567.38 3000.5,-4567.38"/>
<polygon fill="black" stroke="black" points="3004,-4567.38 3000.5,-4557.38 2997,-4567.38 3004,-4567.38"/>
</g>
<!-- l1_residual_gpu6 -->
<g id="node64" class="node">
<title>l1_residual_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="3240,-4417 2761,-4417 2761,-4349 3240,-4349 3240,-4417"/>
<text text-anchor="middle" x="3000.5" y="-4401.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3000.5" y="-4386.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024] (x2)</text>
<text text-anchor="middle" x="3000.5" y="-4371.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3000.5" y="-4356.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_mha_attn_gpu6&#45;&gt;l1_residual_gpu6 -->
<g id="edge91" class="edge">
<title>l1_mha_attn_gpu6&#45;&gt;l1_residual_gpu6</title>
<path fill="none" stroke="black" d="M3000.5,-4488.75C3000.5,-4488.75 3000.5,-4427.38 3000.5,-4427.38"/>
<polygon fill="black" stroke="black" points="3004,-4427.38 3000.5,-4417.38 2997,-4427.38 3004,-4427.38"/>
</g>
<!-- l1_ffn_act_gpu6 -->
<g id="node62" class="node">
<title>l1_ffn_act_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="4389,-4697 3896,-4697 3896,-4629 4389,-4629 4389,-4697"/>
<text text-anchor="middle" x="4142.5" y="-4681.8" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="4142.5" y="-4666.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4142.5" y="-4651.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4142.5" y="-4636.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_ffn_up_gpu6&#45;&gt;l1_ffn_act_gpu6 -->
<g id="edge88" class="edge">
<title>l1_ffn_up_gpu6&#45;&gt;l1_ffn_act_gpu6</title>
<path fill="none" stroke="black" d="M4128.5,-4802.62C4128.5,-4802.62 4128.5,-4707.01 4128.5,-4707.01"/>
<polygon fill="black" stroke="black" points="4132,-4707.01 4128.5,-4697.01 4125,-4707.01 4132,-4707.01"/>
</g>
<!-- l1_ffn_gate_gpu6&#45;&gt;l1_ffn_act_gpu6 -->
<g id="edge89" class="edge">
<title>l1_ffn_gate_gpu6&#45;&gt;l1_ffn_act_gpu6</title>
<path fill="none" stroke="black" d="M3832.05,-4836C3851.61,-4836 3864,-4836 3864,-4836 3864,-4836 3864,-4662 3864,-4662 3864,-4662 3885.95,-4662 3885.95,-4662"/>
<polygon fill="black" stroke="black" points="3885.95,-4665.5 3895.95,-4662 3885.95,-4658.5 3885.95,-4665.5"/>
</g>
<!-- l1_ffn_down_gpu6 -->
<g id="node63" class="node">
<title>l1_ffn_down_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="3784,-4557 3303,-4557 3303,-4489 3784,-4489 3784,-4557"/>
<text text-anchor="middle" x="3543.5" y="-4541.8" font-family="Times,serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="3543.5" y="-4526.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3543.5" y="-4511.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3543.5" y="-4496.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_ffn_act_gpu6&#45;&gt;l1_ffn_down_gpu6 -->
<g id="edge90" class="edge">
<title>l1_ffn_act_gpu6&#45;&gt;l1_ffn_down_gpu6</title>
<path fill="none" stroke="black" d="M4124.5,-4628.75C4124.5,-4610.59 4124.5,-4592 4124.5,-4592 4124.5,-4592 3549.5,-4592 3549.5,-4592 3549.5,-4592 3549.5,-4567.1 3549.5,-4567.1"/>
<polygon fill="black" stroke="black" points="3553,-4567.1 3549.5,-4557.1 3546,-4567.1 3553,-4567.1"/>
</g>
<!-- l1_ffn_down_gpu6&#45;&gt;l1_residual_gpu6 -->
<g id="edge92" class="edge">
<title>l1_ffn_down_gpu6&#45;&gt;l1_residual_gpu6</title>
<path fill="none" stroke="black" d="M3324,-4488.87C3324,-4447.14 3324,-4382 3324,-4382 3324,-4382 3250.27,-4382 3250.27,-4382"/>
<polygon fill="black" stroke="black" points="3250.27,-4378.5 3240.27,-4382 3250.27,-4385.5 3250.27,-4378.5"/>
</g>
<!-- l1_layernorm_gpu6 -->
<g id="node65" class="node">
<title>l1_layernorm_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="3205,-4277 2746,-4277 2746,-4209 3205,-4209 3205,-4277"/>
<text text-anchor="middle" x="2975.5" y="-4261.8" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="2975.5" y="-4246.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2975.5" y="-4231.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2975.5" y="-4216.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_residual_gpu6&#45;&gt;l1_layernorm_gpu6 -->
<g id="edge93" class="edge">
<title>l1_residual_gpu6&#45;&gt;l1_layernorm_gpu6</title>
<path fill="none" stroke="black" d="M2983,-4348.75C2983,-4348.75 2983,-4287.38 2983,-4287.38"/>
<polygon fill="black" stroke="black" points="2986.5,-4287.38 2983,-4277.38 2979.5,-4287.38 2986.5,-4287.38"/>
</g>
<!-- l1_layernorm_gpu6&#45;&gt;l1_mha_allreduce -->
<g id="edge94" class="edge">
<title>l1_layernorm_gpu6&#45;&gt;l1_mha_allreduce</title>
<path fill="none" stroke="black" d="M2970.35,-4208.62C2970.35,-4208.62 2970.35,-4147.14 2970.35,-4147.14"/>
<polygon fill="black" stroke="black" points="2973.85,-4147.14 2970.35,-4137.14 2966.85,-4147.14 2973.85,-4147.14"/>
</g>
<!-- l1_mha_attn_gpu7 -->
<g id="node67" class="node">
<title>l1_mha_attn_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="4353,-4557 3820,-4557 3820,-4489 4353,-4489 4353,-4557"/>
<text text-anchor="middle" x="4086.5" y="-4541.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="4086.5" y="-4526.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="4086.5" y="-4511.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4086.5" y="-4496.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_mha_qkv_gpu7&#45;&gt;l1_mha_attn_gpu7 -->
<g id="edge98" class="edge">
<title>l1_mha_qkv_gpu7&#45;&gt;l1_mha_attn_gpu7</title>
<path fill="none" stroke="black" d="M3840,-4628.75C3840,-4628.75 3840,-4567.38 3840,-4567.38"/>
<polygon fill="black" stroke="black" points="3843.5,-4567.38 3840,-4557.38 3836.5,-4567.38 3843.5,-4567.38"/>
</g>
<!-- l1_residual_gpu7 -->
<g id="node72" class="node">
<title>l1_residual_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="4326,-4417 3847,-4417 3847,-4349 4326,-4349 4326,-4417"/>
<text text-anchor="middle" x="4086.5" y="-4401.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4086.5" y="-4386.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024] (x2)</text>
<text text-anchor="middle" x="4086.5" y="-4371.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4086.5" y="-4356.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_mha_attn_gpu7&#45;&gt;l1_residual_gpu7 -->
<g id="edge104" class="edge">
<title>l1_mha_attn_gpu7&#45;&gt;l1_residual_gpu7</title>
<path fill="none" stroke="black" d="M4086.5,-4488.75C4086.5,-4488.75 4086.5,-4427.38 4086.5,-4427.38"/>
<polygon fill="black" stroke="black" points="4090,-4427.38 4086.5,-4417.38 4083,-4427.38 4090,-4427.38"/>
</g>
<!-- l1_ffn_act_gpu7 -->
<g id="node70" class="node">
<title>l1_ffn_act_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="4918,-4697 4425,-4697 4425,-4629 4918,-4629 4918,-4697"/>
<text text-anchor="middle" x="4671.5" y="-4681.8" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="4671.5" y="-4666.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4671.5" y="-4651.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4671.5" y="-4636.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_ffn_up_gpu7&#45;&gt;l1_ffn_act_gpu7 -->
<g id="edge101" class="edge">
<title>l1_ffn_up_gpu7&#45;&gt;l1_ffn_act_gpu7</title>
<path fill="none" stroke="black" d="M4925.77,-4836C4914.62,-4836 4908,-4836 4908,-4836 4908,-4836 4908,-4707.18 4908,-4707.18"/>
<polygon fill="black" stroke="black" points="4911.5,-4707.18 4908,-4697.18 4904.5,-4707.18 4911.5,-4707.18"/>
</g>
<!-- l1_ffn_gate_gpu7&#45;&gt;l1_ffn_act_gpu7 -->
<g id="edge102" class="edge">
<title>l1_ffn_gate_gpu7&#45;&gt;l1_ffn_act_gpu7</title>
<path fill="none" stroke="black" d="M4657.5,-4802.62C4657.5,-4802.62 4657.5,-4707.01 4657.5,-4707.01"/>
<polygon fill="black" stroke="black" points="4661,-4707.01 4657.5,-4697.01 4654,-4707.01 4661,-4707.01"/>
</g>
<!-- l1_ffn_down_gpu7 -->
<g id="node71" class="node">
<title>l1_ffn_down_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="4891,-4557 4410,-4557 4410,-4489 4891,-4489 4891,-4557"/>
<text text-anchor="middle" x="4650.5" y="-4541.8" font-family="Times,serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="4650.5" y="-4526.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4650.5" y="-4511.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4650.5" y="-4496.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_ffn_act_gpu7&#45;&gt;l1_ffn_down_gpu7 -->
<g id="edge103" class="edge">
<title>l1_ffn_act_gpu7&#45;&gt;l1_ffn_down_gpu7</title>
<path fill="none" stroke="black" d="M4658,-4628.75C4658,-4628.75 4658,-4567.38 4658,-4567.38"/>
<polygon fill="black" stroke="black" points="4661.5,-4567.38 4658,-4557.38 4654.5,-4567.38 4661.5,-4567.38"/>
</g>
<!-- l1_ffn_down_gpu7&#45;&gt;l1_residual_gpu7 -->
<g id="edge105" class="edge">
<title>l1_ffn_down_gpu7&#45;&gt;l1_residual_gpu7</title>
<path fill="none" stroke="black" d="M4646.5,-4488.87C4646.5,-4447.14 4646.5,-4382 4646.5,-4382 4646.5,-4382 4336.02,-4382 4336.02,-4382"/>
<polygon fill="black" stroke="black" points="4336.02,-4378.5 4326.02,-4382 4336.02,-4385.5 4336.02,-4378.5"/>
</g>
<!-- l1_layernorm_gpu7 -->
<g id="node73" class="node">
<title>l1_layernorm_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="4005,-4277 3546,-4277 3546,-4209 4005,-4209 4005,-4277"/>
<text text-anchor="middle" x="3775.5" y="-4261.8" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="3775.5" y="-4246.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3775.5" y="-4231.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3775.5" y="-4216.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_residual_gpu7&#45;&gt;l1_layernorm_gpu7 -->
<g id="edge106" class="edge">
<title>l1_residual_gpu7&#45;&gt;l1_layernorm_gpu7</title>
<path fill="none" stroke="black" d="M3926,-4348.75C3926,-4348.75 3926,-4287.38 3926,-4287.38"/>
<polygon fill="black" stroke="black" points="3929.5,-4287.38 3926,-4277.38 3922.5,-4287.38 3929.5,-4287.38"/>
</g>
<!-- l1_layernorm_gpu7&#45;&gt;l1_mha_allreduce -->
<g id="edge107" class="edge">
<title>l1_layernorm_gpu7&#45;&gt;l1_mha_allreduce</title>
<path fill="none" stroke="black" d="M3685.5,-4208.84C3685.5,-4157.91 3685.5,-4068 3685.5,-4068 3685.5,-4068 3104.19,-4068 3104.19,-4068"/>
<polygon fill="black" stroke="black" points="3104.19,-4064.5 3094.19,-4068 3104.19,-4071.5 3104.19,-4064.5"/>
</g>
<!-- l1_ffn_allreduce -->
<g id="node75" class="node">
<title>l1_ffn_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="3194.9,-3929 2422.74,-3929 2224.1,-3793 2996.26,-3793 3194.9,-3929"/>
<text text-anchor="middle" x="2709.5" y="-3879.8" font-family="Times,serif" font-size="14.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="2709.5" y="-3864.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="2709.5" y="-3849.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2709.5" y="-3834.8" font-family="Times,serif" font-size="14.00">GPU: 4&#45;7</text>
</g>
<!-- l1_mha_allreduce&#45;&gt;l1_ffn_allreduce -->
<g id="edge69" class="edge">
<title>l1_mha_allreduce&#45;&gt;l1_ffn_allreduce</title>
<path fill="none" stroke="black" d="M2418.38,-4000.89C2418.38,-4000.89 2418.38,-3936.08 2418.38,-3936.08"/>
<polygon fill="black" stroke="black" points="2421.88,-3936.08 2418.38,-3926.08 2414.88,-3936.08 2421.88,-3936.08"/>
</g>
<!-- l1_mha_allreduce&#45;&gt;l1_ffn_allreduce -->
<g id="edge82" class="edge">
<title>l1_mha_allreduce&#45;&gt;l1_ffn_allreduce</title>
<path fill="none" stroke="black" d="M2612.46,-4000.89C2612.46,-4000.89 2612.46,-3939.26 2612.46,-3939.26"/>
<polygon fill="black" stroke="black" points="2615.96,-3939.26 2612.46,-3929.26 2608.96,-3939.26 2615.96,-3939.26"/>
</g>
<!-- l1_mha_allreduce&#45;&gt;l1_ffn_allreduce -->
<g id="edge95" class="edge">
<title>l1_mha_allreduce&#45;&gt;l1_ffn_allreduce</title>
<path fill="none" stroke="black" d="M2806.54,-4000.89C2806.54,-4000.89 2806.54,-3939.26 2806.54,-3939.26"/>
<polygon fill="black" stroke="black" points="2810.04,-3939.26 2806.54,-3929.26 2803.04,-3939.26 2810.04,-3939.26"/>
</g>
<!-- l1_mha_allreduce&#45;&gt;l1_ffn_allreduce -->
<g id="edge108" class="edge">
<title>l1_mha_allreduce&#45;&gt;l1_ffn_allreduce</title>
<path fill="none" stroke="black" d="M3000.62,-4003.76C3000.62,-4003.76 3000.62,-3939.24 3000.62,-3939.24"/>
<polygon fill="black" stroke="black" points="3004.12,-3939.24 3000.62,-3929.24 2997.12,-3939.24 3004.12,-3939.24"/>
</g>
<!-- l1_output -->
<g id="node76" class="node">
<title>l1_output</title>
<ellipse fill="lightblue" stroke="black" cx="2709.5" cy="-3672.92" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="2709.5" y="-3691.72" font-family="Times,serif" font-size="14.00">Layer 1 Output</text>
<text text-anchor="middle" x="2709.5" y="-3676.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2709.5" y="-3661.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2709.5" y="-3646.72" font-family="Times,serif" font-size="14.00">GPU: 4&#45;7</text>
</g>
<!-- l1_ffn_allreduce&#45;&gt;l1_output -->
<g id="edge70" class="edge">
<title>l1_ffn_allreduce&#45;&gt;l1_output</title>
<path fill="none" stroke="black" d="M2514.76,-3792.83C2514.76,-3792.83 2514.76,-3721.6 2514.76,-3721.6"/>
<polygon fill="black" stroke="black" points="2518.26,-3721.6 2514.76,-3711.6 2511.26,-3721.6 2518.26,-3721.6"/>
</g>
<!-- l1_ffn_allreduce&#45;&gt;l1_output -->
<g id="edge83" class="edge">
<title>l1_ffn_allreduce&#45;&gt;l1_output</title>
<path fill="none" stroke="black" d="M2644.59,-3792.83C2644.59,-3792.83 2644.59,-3730.26 2644.59,-3730.26"/>
<polygon fill="black" stroke="black" points="2648.09,-3730.26 2644.59,-3720.26 2641.09,-3730.26 2648.09,-3730.26"/>
</g>
<!-- l1_ffn_allreduce&#45;&gt;l1_output -->
<g id="edge96" class="edge">
<title>l1_ffn_allreduce&#45;&gt;l1_output</title>
<path fill="none" stroke="black" d="M2774.41,-3792.83C2774.41,-3792.83 2774.41,-3730.26 2774.41,-3730.26"/>
<polygon fill="black" stroke="black" points="2777.91,-3730.26 2774.41,-3720.26 2770.91,-3730.26 2777.91,-3730.26"/>
</g>
<!-- l1_ffn_allreduce&#45;&gt;l1_output -->
<g id="edge109" class="edge">
<title>l1_ffn_allreduce&#45;&gt;l1_output</title>
<path fill="none" stroke="black" d="M2904.24,-3792.83C2904.24,-3792.83 2904.24,-3721.6 2904.24,-3721.6"/>
<polygon fill="black" stroke="black" points="2907.74,-3721.6 2904.24,-3711.6 2900.74,-3721.6 2907.74,-3721.6"/>
</g>
<!-- send_l1_l2 -->
<g id="node77" class="node">
<title>send_l1_l2</title>
<ellipse fill="orange" stroke="black" cx="2709.5" cy="-3504.75" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="2709.5" y="-3523.55" font-family="Times,serif" font-size="14.00">Pipeline Send</text>
<text text-anchor="middle" x="2709.5" y="-3508.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2709.5" y="-3493.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2709.5" y="-3478.55" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- l1_output&#45;&gt;send_l1_l2 -->
<g id="edge110" class="edge">
<title>l1_output&#45;&gt;send_l1_l2</title>
<path fill="none" stroke="black" d="M2709.5,-3624.73C2709.5,-3624.73 2709.5,-3562.95 2709.5,-3562.95"/>
<polygon fill="black" stroke="black" points="2713,-3562.95 2709.5,-3552.95 2706,-3562.95 2713,-3562.95"/>
</g>
<!-- l2_input_split -->
<g id="node78" class="node">
<title>l2_input_split</title>
<polygon fill="lightyellow" stroke="black" points="3207.28,-3384.67 2415.42,-3384.67 2211.72,-3248.67 3003.58,-3248.67 3207.28,-3384.67"/>
<text text-anchor="middle" x="2709.5" y="-3335.47" font-family="Times,serif" font-size="14.00">Input Broadcast</text>
<text text-anchor="middle" x="2709.5" y="-3320.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2709.5" y="-3305.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]×4</text>
<text text-anchor="middle" x="2709.5" y="-3290.47" font-family="Times,serif" font-size="14.00">GPU: 8&#45;11</text>
</g>
<!-- send_l1_l2&#45;&gt;l2_input_split -->
<g id="edge111" class="edge">
<title>send_l1_l2&#45;&gt;l2_input_split</title>
<path fill="none" stroke="black" d="M2709.5,-3456.31C2709.5,-3456.31 2709.5,-3394.78 2709.5,-3394.78"/>
<polygon fill="black" stroke="black" points="2713,-3394.78 2709.5,-3384.78 2706,-3394.78 2713,-3394.78"/>
</g>
<!-- l2_mha_qkv_split -->
<g id="node79" class="node">
<title>l2_mha_qkv_split</title>
<polygon fill="lightyellow" stroke="black" points="3296.1,-3176.67 2362.95,-3176.67 2122.9,-3040.67 3056.05,-3040.67 3296.1,-3176.67"/>
<text text-anchor="middle" x="2709.5" y="-3127.47" font-family="Times,serif" font-size="14.00">QKV Split</text>
<text text-anchor="middle" x="2709.5" y="-3112.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2709.5" y="-3097.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]×4</text>
<text text-anchor="middle" x="2709.5" y="-3082.47" font-family="Times,serif" font-size="14.00">GPU: 8&#45;11</text>
</g>
<!-- l2_input_split&#45;&gt;l2_mha_qkv_split -->
<g id="edge112" class="edge">
<title>l2_input_split&#45;&gt;l2_mha_qkv_split</title>
<path fill="none" stroke="black" d="M2709.5,-3248.56C2709.5,-3248.56 2709.5,-3186.93 2709.5,-3186.93"/>
<polygon fill="black" stroke="black" points="2713,-3186.93 2709.5,-3176.93 2706,-3186.93 2713,-3186.93"/>
</g>
<!-- l2_ffn_up_gpu8 -->
<g id="node82" class="node">
<title>l2_ffn_up_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="1029,-3142.67 536,-3142.67 536,-3074.67 1029,-3074.67 1029,-3142.67"/>
<text text-anchor="middle" x="782.5" y="-3127.47" font-family="Times,serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="782.5" y="-3112.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="782.5" y="-3097.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="782.5" y="-3082.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_input_split&#45;&gt;l2_ffn_up_gpu8 -->
<g id="edge115" class="edge">
<title>l2_input_split&#45;&gt;l2_ffn_up_gpu8</title>
<path fill="none" stroke="black" d="M2333.31,-3330C1834.91,-3330 1018,-3330 1018,-3330 1018,-3330 1018,-3152.76 1018,-3152.76"/>
<polygon fill="black" stroke="black" points="1021.5,-3152.76 1018,-3142.76 1014.5,-3152.76 1021.5,-3152.76"/>
</g>
<!-- l2_ffn_gate_gpu8 -->
<g id="node83" class="node">
<title>l2_ffn_gate_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="500,-3142.67 7,-3142.67 7,-3074.67 500,-3074.67 500,-3142.67"/>
<text text-anchor="middle" x="253.5" y="-3127.47" font-family="Times,serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="253.5" y="-3112.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="253.5" y="-3097.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="253.5" y="-3082.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_input_split&#45;&gt;l2_ffn_gate_gpu8 -->
<g id="edge116" class="edge">
<title>l2_input_split&#45;&gt;l2_ffn_gate_gpu8</title>
<path fill="none" stroke="black" d="M2373.95,-3357C1702.41,-3357 257,-3357 257,-3357 257,-3357 257,-3152.68 257,-3152.68"/>
<polygon fill="black" stroke="black" points="260.5,-3152.68 257,-3142.68 253.5,-3152.68 260.5,-3152.68"/>
</g>
<!-- l2_ffn_up_gpu9 -->
<g id="node90" class="node">
<title>l2_ffn_up_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="1558,-3142.67 1065,-3142.67 1065,-3074.67 1558,-3074.67 1558,-3142.67"/>
<text text-anchor="middle" x="1311.5" y="-3127.47" font-family="Times,serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="1311.5" y="-3112.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1311.5" y="-3097.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1311.5" y="-3082.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_input_split&#45;&gt;l2_ffn_up_gpu9 -->
<g id="edge128" class="edge">
<title>l2_input_split&#45;&gt;l2_ffn_up_gpu9</title>
<path fill="none" stroke="black" d="M2293.09,-3303C1959.53,-3303 1547,-3303 1547,-3303 1547,-3303 1547,-3152.96 1547,-3152.96"/>
<polygon fill="black" stroke="black" points="1550.5,-3152.96 1547,-3142.96 1543.5,-3152.96 1550.5,-3152.96"/>
</g>
<!-- l2_ffn_gate_gpu9 -->
<g id="node91" class="node">
<title>l2_ffn_gate_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2087,-3142.67 1594,-3142.67 1594,-3074.67 2087,-3074.67 2087,-3142.67"/>
<text text-anchor="middle" x="1840.5" y="-3127.47" font-family="Times,serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="1840.5" y="-3112.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1840.5" y="-3097.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1840.5" y="-3082.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_input_split&#45;&gt;l2_ffn_gate_gpu9 -->
<g id="edge129" class="edge">
<title>l2_input_split&#45;&gt;l2_ffn_gate_gpu9</title>
<path fill="none" stroke="black" d="M2250.9,-3275C2063.98,-3275 1891,-3275 1891,-3275 1891,-3275 1891,-3152.73 1891,-3152.73"/>
<polygon fill="black" stroke="black" points="1894.5,-3152.73 1891,-3142.73 1887.5,-3152.73 1894.5,-3152.73"/>
</g>
<!-- l2_ffn_up_gpu10 -->
<g id="node98" class="node">
<title>l2_ffn_up_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="4354,-3142.67 3861,-3142.67 3861,-3074.67 4354,-3074.67 4354,-3142.67"/>
<text text-anchor="middle" x="4107.5" y="-3127.47" font-family="Times,serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="4107.5" y="-3112.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4107.5" y="-3097.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4107.5" y="-3082.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_input_split&#45;&gt;l2_ffn_up_gpu10 -->
<g id="edge141" class="edge">
<title>l2_input_split&#45;&gt;l2_ffn_up_gpu10</title>
<path fill="none" stroke="black" d="M3085.32,-3303C3444.94,-3303 3933,-3303 3933,-3303 3933,-3303 3933,-3152.96 3933,-3152.96"/>
<polygon fill="black" stroke="black" points="3936.5,-3152.96 3933,-3142.96 3929.5,-3152.96 3936.5,-3152.96"/>
</g>
<!-- l2_ffn_gate_gpu10 -->
<g id="node99" class="node">
<title>l2_ffn_gate_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="3825,-3142.67 3332,-3142.67 3332,-3074.67 3825,-3074.67 3825,-3142.67"/>
<text text-anchor="middle" x="3578.5" y="-3127.47" font-family="Times,serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="3578.5" y="-3112.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3578.5" y="-3097.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3578.5" y="-3082.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_input_split&#45;&gt;l2_ffn_gate_gpu10 -->
<g id="edge142" class="edge">
<title>l2_input_split&#45;&gt;l2_ffn_gate_gpu10</title>
<path fill="none" stroke="black" d="M3043.03,-3275C3235.19,-3275 3439,-3275 3439,-3275 3439,-3275 3439,-3152.73 3439,-3152.73"/>
<polygon fill="black" stroke="black" points="3442.5,-3152.73 3439,-3142.73 3435.5,-3152.73 3442.5,-3152.73"/>
</g>
<!-- l2_ffn_up_gpu11 -->
<g id="node106" class="node">
<title>l2_ffn_up_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="5412,-3142.67 4919,-3142.67 4919,-3074.67 5412,-3074.67 5412,-3142.67"/>
<text text-anchor="middle" x="5165.5" y="-3127.47" font-family="Times,serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="5165.5" y="-3112.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5165.5" y="-3097.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="5165.5" y="-3082.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_input_split&#45;&gt;l2_ffn_up_gpu11 -->
<g id="edge154" class="edge">
<title>l2_input_split&#45;&gt;l2_ffn_up_gpu11</title>
<path fill="none" stroke="black" d="M3165.99,-3357C3877.18,-3357 5169,-3357 5169,-3357 5169,-3357 5169,-3152.68 5169,-3152.68"/>
<polygon fill="black" stroke="black" points="5172.5,-3152.68 5169,-3142.68 5165.5,-3152.68 5172.5,-3152.68"/>
</g>
<!-- l2_ffn_gate_gpu11 -->
<g id="node107" class="node">
<title>l2_ffn_gate_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="4883,-3142.67 4390,-3142.67 4390,-3074.67 4883,-3074.67 4883,-3142.67"/>
<text text-anchor="middle" x="4636.5" y="-3127.47" font-family="Times,serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="4636.5" y="-3112.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4636.5" y="-3097.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4636.5" y="-3082.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_input_split&#45;&gt;l2_ffn_gate_gpu11 -->
<g id="edge155" class="edge">
<title>l2_input_split&#45;&gt;l2_ffn_gate_gpu11</title>
<path fill="none" stroke="black" d="M3125.53,-3330C3627.09,-3330 4403.5,-3330 4403.5,-3330 4403.5,-3330 4403.5,-3152.76 4403.5,-3152.76"/>
<polygon fill="black" stroke="black" points="4407,-3152.76 4403.5,-3142.76 4400,-3152.76 4407,-3152.76"/>
</g>
<!-- l2_mha_qkv_gpu8 -->
<g id="node80" class="node">
<title>l2_mha_qkv_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="2110,-2968.67 1565,-2968.67 1565,-2900.67 2110,-2900.67 2110,-2968.67"/>
<text text-anchor="middle" x="1837.5" y="-2953.47" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="1837.5" y="-2938.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1837.5" y="-2923.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="1837.5" y="-2908.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_mha_qkv_split&#45;&gt;l2_mha_qkv_gpu8 -->
<g id="edge113" class="edge">
<title>l2_mha_qkv_split&#45;&gt;l2_mha_qkv_gpu8</title>
<path fill="none" stroke="black" d="M2151.65,-3057C2118.66,-3057 2098.5,-3057 2098.5,-3057 2098.5,-3057 2098.5,-2978.74 2098.5,-2978.74"/>
<polygon fill="black" stroke="black" points="2102,-2978.74 2098.5,-2968.74 2095,-2978.74 2102,-2978.74"/>
</g>
<!-- l2_mha_qkv_gpu9 -->
<g id="node88" class="node">
<title>l2_mha_qkv_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2691,-2968.67 2146,-2968.67 2146,-2900.67 2691,-2900.67 2691,-2968.67"/>
<text text-anchor="middle" x="2418.5" y="-2953.47" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="2418.5" y="-2938.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2418.5" y="-2923.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="2418.5" y="-2908.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_mha_qkv_split&#45;&gt;l2_mha_qkv_gpu9 -->
<g id="edge126" class="edge">
<title>l2_mha_qkv_split&#45;&gt;l2_mha_qkv_gpu9</title>
<path fill="none" stroke="black" d="M2418.5,-3040.4C2418.5,-3040.4 2418.5,-2978.78 2418.5,-2978.78"/>
<polygon fill="black" stroke="black" points="2422,-2978.78 2418.5,-2968.78 2415,-2978.78 2422,-2978.78"/>
</g>
<!-- l2_mha_qkv_gpu10 -->
<g id="node96" class="node">
<title>l2_mha_qkv_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="3272,-2968.67 2727,-2968.67 2727,-2900.67 3272,-2900.67 3272,-2968.67"/>
<text text-anchor="middle" x="2999.5" y="-2953.47" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="2999.5" y="-2938.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2999.5" y="-2923.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="2999.5" y="-2908.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_mha_qkv_split&#45;&gt;l2_mha_qkv_gpu10 -->
<g id="edge139" class="edge">
<title>l2_mha_qkv_split&#45;&gt;l2_mha_qkv_gpu10</title>
<path fill="none" stroke="black" d="M2999.5,-3040.4C2999.5,-3040.4 2999.5,-2978.78 2999.5,-2978.78"/>
<polygon fill="black" stroke="black" points="3003,-2978.78 2999.5,-2968.78 2996,-2978.78 3003,-2978.78"/>
</g>
<!-- l2_mha_qkv_gpu11 -->
<g id="node104" class="node">
<title>l2_mha_qkv_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="3853,-2968.67 3308,-2968.67 3308,-2900.67 3853,-2900.67 3853,-2968.67"/>
<text text-anchor="middle" x="3580.5" y="-2953.47" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="3580.5" y="-2938.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3580.5" y="-2923.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="3580.5" y="-2908.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_mha_qkv_split&#45;&gt;l2_mha_qkv_gpu11 -->
<g id="edge152" class="edge">
<title>l2_mha_qkv_split&#45;&gt;l2_mha_qkv_gpu11</title>
<path fill="none" stroke="black" d="M3084.98,-3057C3209.05,-3057 3316,-3057 3316,-3057 3316,-3057 3316,-2978.74 3316,-2978.74"/>
<polygon fill="black" stroke="black" points="3319.5,-2978.74 3316,-2968.74 3312.5,-2978.74 3319.5,-2978.74"/>
</g>
<!-- l2_mha_attn_gpu8 -->
<g id="node81" class="node">
<title>l2_mha_attn_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="2104,-2828.67 1571,-2828.67 1571,-2760.67 2104,-2760.67 2104,-2828.67"/>
<text text-anchor="middle" x="1837.5" y="-2813.47" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="1837.5" y="-2798.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="1837.5" y="-2783.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1837.5" y="-2768.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_mha_qkv_gpu8&#45;&gt;l2_mha_attn_gpu8 -->
<g id="edge114" class="edge">
<title>l2_mha_qkv_gpu8&#45;&gt;l2_mha_attn_gpu8</title>
<path fill="none" stroke="black" d="M1837.5,-2900.42C1837.5,-2900.42 1837.5,-2839.05 1837.5,-2839.05"/>
<polygon fill="black" stroke="black" points="1841,-2839.05 1837.5,-2829.05 1834,-2839.05 1841,-2839.05"/>
</g>
<!-- l2_residual_gpu8 -->
<g id="node86" class="node">
<title>l2_residual_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="2077,-2688.67 1598,-2688.67 1598,-2620.67 2077,-2620.67 2077,-2688.67"/>
<text text-anchor="middle" x="1837.5" y="-2673.47" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1837.5" y="-2658.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024] (x2)</text>
<text text-anchor="middle" x="1837.5" y="-2643.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1837.5" y="-2628.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_mha_attn_gpu8&#45;&gt;l2_residual_gpu8 -->
<g id="edge120" class="edge">
<title>l2_mha_attn_gpu8&#45;&gt;l2_residual_gpu8</title>
<path fill="none" stroke="black" d="M1837.5,-2760.42C1837.5,-2760.42 1837.5,-2699.05 1837.5,-2699.05"/>
<polygon fill="black" stroke="black" points="1841,-2699.05 1837.5,-2689.05 1834,-2699.05 1841,-2699.05"/>
</g>
<!-- l2_ffn_act_gpu8 -->
<g id="node84" class="node">
<title>l2_ffn_act_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="1000,-2968.67 507,-2968.67 507,-2900.67 1000,-2900.67 1000,-2968.67"/>
<text text-anchor="middle" x="753.5" y="-2953.47" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="753.5" y="-2938.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="753.5" y="-2923.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="753.5" y="-2908.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_ffn_up_gpu8&#45;&gt;l2_ffn_act_gpu8 -->
<g id="edge117" class="edge">
<title>l2_ffn_up_gpu8&#45;&gt;l2_ffn_act_gpu8</title>
<path fill="none" stroke="black" d="M768,-3074.29C768,-3074.29 768,-2978.68 768,-2978.68"/>
<polygon fill="black" stroke="black" points="771.5,-2978.67 768,-2968.68 764.5,-2978.68 771.5,-2978.67"/>
</g>
<!-- l2_ffn_gate_gpu8&#45;&gt;l2_ffn_act_gpu8 -->
<g id="edge118" class="edge">
<title>l2_ffn_gate_gpu8&#45;&gt;l2_ffn_act_gpu8</title>
<path fill="none" stroke="black" d="M496.5,-3074.57C496.5,-3023.74 496.5,-2934 496.5,-2934 496.5,-2934 497.54,-2934 497.54,-2934"/>
<polygon fill="black" stroke="black" points="496.89,-2937.5 506.89,-2934 496.89,-2930.5 496.89,-2937.5"/>
</g>
<!-- l2_ffn_down_gpu8 -->
<g id="node85" class="node">
<title>l2_ffn_down_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="1006,-2828.67 525,-2828.67 525,-2760.67 1006,-2760.67 1006,-2828.67"/>
<text text-anchor="middle" x="765.5" y="-2813.47" font-family="Times,serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="765.5" y="-2798.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="765.5" y="-2783.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="765.5" y="-2768.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_ffn_act_gpu8&#45;&gt;l2_ffn_down_gpu8 -->
<g id="edge119" class="edge">
<title>l2_ffn_act_gpu8&#45;&gt;l2_ffn_down_gpu8</title>
<path fill="none" stroke="black" d="M762.5,-2900.42C762.5,-2900.42 762.5,-2839.05 762.5,-2839.05"/>
<polygon fill="black" stroke="black" points="766,-2839.05 762.5,-2829.05 759,-2839.05 766,-2839.05"/>
</g>
<!-- l2_ffn_down_gpu8&#45;&gt;l2_residual_gpu8 -->
<g id="edge121" class="edge">
<title>l2_ffn_down_gpu8&#45;&gt;l2_residual_gpu8</title>
<path fill="none" stroke="black" d="M767.5,-2760.61C767.5,-2718.98 767.5,-2654 767.5,-2654 767.5,-2654 1587.7,-2654 1587.7,-2654"/>
<polygon fill="black" stroke="black" points="1587.7,-2657.5 1597.7,-2654 1587.7,-2650.5 1587.7,-2657.5"/>
</g>
<!-- l2_layernorm_gpu8 -->
<g id="node87" class="node">
<title>l2_layernorm_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="2147,-2548.67 1688,-2548.67 1688,-2480.67 2147,-2480.67 2147,-2548.67"/>
<text text-anchor="middle" x="1917.5" y="-2533.47" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1917.5" y="-2518.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1917.5" y="-2503.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1917.5" y="-2488.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_residual_gpu8&#45;&gt;l2_layernorm_gpu8 -->
<g id="edge122" class="edge">
<title>l2_residual_gpu8&#45;&gt;l2_layernorm_gpu8</title>
<path fill="none" stroke="black" d="M1882.5,-2620.42C1882.5,-2620.42 1882.5,-2559.05 1882.5,-2559.05"/>
<polygon fill="black" stroke="black" points="1886,-2559.05 1882.5,-2549.05 1879,-2559.05 1886,-2559.05"/>
</g>
<!-- l2_mha_allreduce -->
<g id="node112" class="node">
<title>l2_mha_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="3187.9,-2408.67 2415.74,-2408.67 2217.1,-2272.67 2989.26,-2272.67 3187.9,-2408.67"/>
<text text-anchor="middle" x="2702.5" y="-2359.47" font-family="Times,serif" font-size="14.00">MHA All&#45;Reduce</text>
<text text-anchor="middle" x="2702.5" y="-2344.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="2702.5" y="-2329.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2702.5" y="-2314.47" font-family="Times,serif" font-size="14.00">GPU: 8&#45;11</text>
</g>
<!-- l2_layernorm_gpu8&#45;&gt;l2_mha_allreduce -->
<g id="edge123" class="edge">
<title>l2_layernorm_gpu8&#45;&gt;l2_mha_allreduce</title>
<path fill="none" stroke="black" d="M2147.25,-2514C2190.06,-2514 2221.65,-2514 2221.65,-2514 2221.65,-2514 2221.65,-2350.79 2221.65,-2350.79"/>
<polygon fill="black" stroke="black" points="2225.15,-2350.79 2221.65,-2340.79 2218.15,-2350.79 2225.15,-2350.79"/>
</g>
<!-- l2_mha_attn_gpu9 -->
<g id="node89" class="node">
<title>l2_mha_attn_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2685,-2828.67 2152,-2828.67 2152,-2760.67 2685,-2760.67 2685,-2828.67"/>
<text text-anchor="middle" x="2418.5" y="-2813.47" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="2418.5" y="-2798.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="2418.5" y="-2783.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2418.5" y="-2768.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_mha_qkv_gpu9&#45;&gt;l2_mha_attn_gpu9 -->
<g id="edge127" class="edge">
<title>l2_mha_qkv_gpu9&#45;&gt;l2_mha_attn_gpu9</title>
<path fill="none" stroke="black" d="M2418.5,-2900.42C2418.5,-2900.42 2418.5,-2839.05 2418.5,-2839.05"/>
<polygon fill="black" stroke="black" points="2422,-2839.05 2418.5,-2829.05 2415,-2839.05 2422,-2839.05"/>
</g>
<!-- l2_residual_gpu9 -->
<g id="node94" class="node">
<title>l2_residual_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2658,-2688.67 2179,-2688.67 2179,-2620.67 2658,-2620.67 2658,-2688.67"/>
<text text-anchor="middle" x="2418.5" y="-2673.47" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2418.5" y="-2658.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024] (x2)</text>
<text text-anchor="middle" x="2418.5" y="-2643.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2418.5" y="-2628.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_mha_attn_gpu9&#45;&gt;l2_residual_gpu9 -->
<g id="edge133" class="edge">
<title>l2_mha_attn_gpu9&#45;&gt;l2_residual_gpu9</title>
<path fill="none" stroke="black" d="M2418.5,-2760.42C2418.5,-2760.42 2418.5,-2699.05 2418.5,-2699.05"/>
<polygon fill="black" stroke="black" points="2422,-2699.05 2418.5,-2689.05 2415,-2699.05 2422,-2699.05"/>
</g>
<!-- l2_ffn_act_gpu9 -->
<g id="node92" class="node">
<title>l2_ffn_act_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="1529,-2968.67 1036,-2968.67 1036,-2900.67 1529,-2900.67 1529,-2968.67"/>
<text text-anchor="middle" x="1282.5" y="-2953.47" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="1282.5" y="-2938.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1282.5" y="-2923.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1282.5" y="-2908.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_ffn_up_gpu9&#45;&gt;l2_ffn_act_gpu9 -->
<g id="edge130" class="edge">
<title>l2_ffn_up_gpu9&#45;&gt;l2_ffn_act_gpu9</title>
<path fill="none" stroke="black" d="M1297,-3074.29C1297,-3074.29 1297,-2978.68 1297,-2978.68"/>
<polygon fill="black" stroke="black" points="1300.5,-2978.67 1297,-2968.68 1293.5,-2978.68 1300.5,-2978.67"/>
</g>
<!-- l2_ffn_gate_gpu9&#45;&gt;l2_ffn_act_gpu9 -->
<g id="edge131" class="edge">
<title>l2_ffn_gate_gpu9&#45;&gt;l2_ffn_act_gpu9</title>
<path fill="none" stroke="black" d="M1593.78,-3108C1574.03,-3108 1561.5,-3108 1561.5,-3108 1561.5,-3108 1561.5,-2934 1561.5,-2934 1561.5,-2934 1539.22,-2934 1539.22,-2934"/>
<polygon fill="black" stroke="black" points="1539.22,-2930.5 1529.22,-2934 1539.22,-2937.5 1539.22,-2930.5"/>
</g>
<!-- l2_ffn_down_gpu9 -->
<g id="node93" class="node">
<title>l2_ffn_down_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="1529,-2828.67 1048,-2828.67 1048,-2760.67 1529,-2760.67 1529,-2828.67"/>
<text text-anchor="middle" x="1288.5" y="-2813.47" font-family="Times,serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="1288.5" y="-2798.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1288.5" y="-2783.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1288.5" y="-2768.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_ffn_act_gpu9&#45;&gt;l2_ffn_down_gpu9 -->
<g id="edge132" class="edge">
<title>l2_ffn_act_gpu9&#45;&gt;l2_ffn_down_gpu9</title>
<path fill="none" stroke="black" d="M1288.5,-2900.42C1288.5,-2900.42 1288.5,-2839.05 1288.5,-2839.05"/>
<polygon fill="black" stroke="black" points="1292,-2839.05 1288.5,-2829.05 1285,-2839.05 1292,-2839.05"/>
</g>
<!-- l2_ffn_down_gpu9&#45;&gt;l2_residual_gpu9 -->
<g id="edge134" class="edge">
<title>l2_ffn_down_gpu9&#45;&gt;l2_residual_gpu9</title>
<path fill="none" stroke="black" d="M1293.5,-2760.35C1293.5,-2700.66 1293.5,-2584 1293.5,-2584 1293.5,-2584 2191.93,-2584 2191.93,-2584 2191.93,-2584 2191.93,-2610.57 2191.93,-2610.57"/>
<polygon fill="black" stroke="black" points="2188.43,-2610.57 2191.93,-2620.57 2195.43,-2610.58 2188.43,-2610.57"/>
</g>
<!-- l2_layernorm_gpu9 -->
<g id="node95" class="node">
<title>l2_layernorm_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2685,-2548.67 2226,-2548.67 2226,-2480.67 2685,-2480.67 2685,-2548.67"/>
<text text-anchor="middle" x="2455.5" y="-2533.47" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="2455.5" y="-2518.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2455.5" y="-2503.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2455.5" y="-2488.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_residual_gpu9&#45;&gt;l2_layernorm_gpu9 -->
<g id="edge135" class="edge">
<title>l2_residual_gpu9&#45;&gt;l2_layernorm_gpu9</title>
<path fill="none" stroke="black" d="M2442,-2620.42C2442,-2620.42 2442,-2559.05 2442,-2559.05"/>
<polygon fill="black" stroke="black" points="2445.5,-2559.05 2442,-2549.05 2438.5,-2559.05 2445.5,-2559.05"/>
</g>
<!-- l2_layernorm_gpu9&#45;&gt;l2_mha_allreduce -->
<g id="edge136" class="edge">
<title>l2_layernorm_gpu9&#45;&gt;l2_mha_allreduce</title>
<path fill="none" stroke="black" d="M2455.5,-2480.29C2455.5,-2480.29 2455.5,-2418.81 2455.5,-2418.81"/>
<polygon fill="black" stroke="black" points="2459,-2418.81 2455.5,-2408.81 2452,-2418.81 2459,-2418.81"/>
</g>
<!-- l2_mha_attn_gpu10 -->
<g id="node97" class="node">
<title>l2_mha_attn_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="3260,-2828.67 2727,-2828.67 2727,-2760.67 3260,-2760.67 3260,-2828.67"/>
<text text-anchor="middle" x="2993.5" y="-2813.47" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="2993.5" y="-2798.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="2993.5" y="-2783.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2993.5" y="-2768.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_mha_qkv_gpu10&#45;&gt;l2_mha_attn_gpu10 -->
<g id="edge140" class="edge">
<title>l2_mha_qkv_gpu10&#45;&gt;l2_mha_attn_gpu10</title>
<path fill="none" stroke="black" d="M2993.5,-2900.42C2993.5,-2900.42 2993.5,-2839.05 2993.5,-2839.05"/>
<polygon fill="black" stroke="black" points="2997,-2839.05 2993.5,-2829.05 2990,-2839.05 2997,-2839.05"/>
</g>
<!-- l2_residual_gpu10 -->
<g id="node102" class="node">
<title>l2_residual_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="3233,-2688.67 2754,-2688.67 2754,-2620.67 3233,-2620.67 3233,-2688.67"/>
<text text-anchor="middle" x="2993.5" y="-2673.47" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2993.5" y="-2658.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024] (x2)</text>
<text text-anchor="middle" x="2993.5" y="-2643.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2993.5" y="-2628.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_mha_attn_gpu10&#45;&gt;l2_residual_gpu10 -->
<g id="edge146" class="edge">
<title>l2_mha_attn_gpu10&#45;&gt;l2_residual_gpu10</title>
<path fill="none" stroke="black" d="M2993.5,-2760.42C2993.5,-2760.42 2993.5,-2699.05 2993.5,-2699.05"/>
<polygon fill="black" stroke="black" points="2997,-2699.05 2993.5,-2689.05 2990,-2699.05 2997,-2699.05"/>
</g>
<!-- l2_ffn_act_gpu10 -->
<g id="node100" class="node">
<title>l2_ffn_act_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="4382,-2968.67 3889,-2968.67 3889,-2900.67 4382,-2900.67 4382,-2968.67"/>
<text text-anchor="middle" x="4135.5" y="-2953.47" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="4135.5" y="-2938.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4135.5" y="-2923.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4135.5" y="-2908.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_ffn_up_gpu10&#45;&gt;l2_ffn_act_gpu10 -->
<g id="edge143" class="edge">
<title>l2_ffn_up_gpu10&#45;&gt;l2_ffn_act_gpu10</title>
<path fill="none" stroke="black" d="M4121.5,-3074.29C4121.5,-3074.29 4121.5,-2978.68 4121.5,-2978.68"/>
<polygon fill="black" stroke="black" points="4125,-2978.67 4121.5,-2968.68 4118,-2978.68 4125,-2978.67"/>
</g>
<!-- l2_ffn_gate_gpu10&#45;&gt;l2_ffn_act_gpu10 -->
<g id="edge144" class="edge">
<title>l2_ffn_gate_gpu10&#45;&gt;l2_ffn_act_gpu10</title>
<path fill="none" stroke="black" d="M3825.05,-3108C3844.61,-3108 3857,-3108 3857,-3108 3857,-3108 3857,-2934 3857,-2934 3857,-2934 3878.95,-2934 3878.95,-2934"/>
<polygon fill="black" stroke="black" points="3878.95,-2937.5 3888.95,-2934 3878.95,-2930.5 3878.95,-2937.5"/>
</g>
<!-- l2_ffn_down_gpu10 -->
<g id="node101" class="node">
<title>l2_ffn_down_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="3777,-2828.67 3296,-2828.67 3296,-2760.67 3777,-2760.67 3777,-2828.67"/>
<text text-anchor="middle" x="3536.5" y="-2813.47" font-family="Times,serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="3536.5" y="-2798.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3536.5" y="-2783.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3536.5" y="-2768.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_ffn_act_gpu10&#45;&gt;l2_ffn_down_gpu10 -->
<g id="edge145" class="edge">
<title>l2_ffn_act_gpu10&#45;&gt;l2_ffn_down_gpu10</title>
<path fill="none" stroke="black" d="M4117.5,-2900.57C4117.5,-2882.5 4117.5,-2864 4117.5,-2864 4117.5,-2864 3542.5,-2864 3542.5,-2864 3542.5,-2864 3542.5,-2838.93 3542.5,-2838.93"/>
<polygon fill="black" stroke="black" points="3546,-2838.93 3542.5,-2828.93 3539,-2838.93 3546,-2838.93"/>
</g>
<!-- l2_ffn_down_gpu10&#45;&gt;l2_residual_gpu10 -->
<g id="edge147" class="edge">
<title>l2_ffn_down_gpu10&#45;&gt;l2_residual_gpu10</title>
<path fill="none" stroke="black" d="M3317,-2760.61C3317,-2718.98 3317,-2654 3317,-2654 3317,-2654 3243.27,-2654 3243.27,-2654"/>
<polygon fill="black" stroke="black" points="3243.27,-2650.5 3233.27,-2654 3243.27,-2657.5 3243.27,-2650.5"/>
</g>
<!-- l2_layernorm_gpu10 -->
<g id="node103" class="node">
<title>l2_layernorm_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="3198,-2548.67 2739,-2548.67 2739,-2480.67 3198,-2480.67 3198,-2548.67"/>
<text text-anchor="middle" x="2968.5" y="-2533.47" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="2968.5" y="-2518.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2968.5" y="-2503.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2968.5" y="-2488.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_residual_gpu10&#45;&gt;l2_layernorm_gpu10 -->
<g id="edge148" class="edge">
<title>l2_residual_gpu10&#45;&gt;l2_layernorm_gpu10</title>
<path fill="none" stroke="black" d="M2976,-2620.42C2976,-2620.42 2976,-2559.05 2976,-2559.05"/>
<polygon fill="black" stroke="black" points="2979.5,-2559.05 2976,-2549.05 2972.5,-2559.05 2979.5,-2559.05"/>
</g>
<!-- l2_layernorm_gpu10&#45;&gt;l2_mha_allreduce -->
<g id="edge149" class="edge">
<title>l2_layernorm_gpu10&#45;&gt;l2_mha_allreduce</title>
<path fill="none" stroke="black" d="M2963.35,-2480.29C2963.35,-2480.29 2963.35,-2418.81 2963.35,-2418.81"/>
<polygon fill="black" stroke="black" points="2966.85,-2418.81 2963.35,-2408.81 2959.85,-2418.81 2966.85,-2418.81"/>
</g>
<!-- l2_mha_attn_gpu11 -->
<g id="node105" class="node">
<title>l2_mha_attn_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="4346,-2828.67 3813,-2828.67 3813,-2760.67 4346,-2760.67 4346,-2828.67"/>
<text text-anchor="middle" x="4079.5" y="-2813.47" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="4079.5" y="-2798.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="4079.5" y="-2783.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4079.5" y="-2768.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_mha_qkv_gpu11&#45;&gt;l2_mha_attn_gpu11 -->
<g id="edge153" class="edge">
<title>l2_mha_qkv_gpu11&#45;&gt;l2_mha_attn_gpu11</title>
<path fill="none" stroke="black" d="M3833,-2900.42C3833,-2900.42 3833,-2839.05 3833,-2839.05"/>
<polygon fill="black" stroke="black" points="3836.5,-2839.05 3833,-2829.05 3829.5,-2839.05 3836.5,-2839.05"/>
</g>
<!-- l2_residual_gpu11 -->
<g id="node110" class="node">
<title>l2_residual_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="4319,-2688.67 3840,-2688.67 3840,-2620.67 4319,-2620.67 4319,-2688.67"/>
<text text-anchor="middle" x="4079.5" y="-2673.47" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4079.5" y="-2658.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024] (x2)</text>
<text text-anchor="middle" x="4079.5" y="-2643.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4079.5" y="-2628.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_mha_attn_gpu11&#45;&gt;l2_residual_gpu11 -->
<g id="edge159" class="edge">
<title>l2_mha_attn_gpu11&#45;&gt;l2_residual_gpu11</title>
<path fill="none" stroke="black" d="M4079.5,-2760.42C4079.5,-2760.42 4079.5,-2699.05 4079.5,-2699.05"/>
<polygon fill="black" stroke="black" points="4083,-2699.05 4079.5,-2689.05 4076,-2699.05 4083,-2699.05"/>
</g>
<!-- l2_ffn_act_gpu11 -->
<g id="node108" class="node">
<title>l2_ffn_act_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="4911,-2968.67 4418,-2968.67 4418,-2900.67 4911,-2900.67 4911,-2968.67"/>
<text text-anchor="middle" x="4664.5" y="-2953.47" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="4664.5" y="-2938.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4664.5" y="-2923.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4664.5" y="-2908.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_ffn_up_gpu11&#45;&gt;l2_ffn_act_gpu11 -->
<g id="edge156" class="edge">
<title>l2_ffn_up_gpu11&#45;&gt;l2_ffn_act_gpu11</title>
<path fill="none" stroke="black" d="M4918.77,-3108C4907.62,-3108 4901,-3108 4901,-3108 4901,-3108 4901,-2978.91 4901,-2978.91"/>
<polygon fill="black" stroke="black" points="4904.5,-2978.91 4901,-2968.91 4897.5,-2978.91 4904.5,-2978.91"/>
</g>
<!-- l2_ffn_gate_gpu11&#45;&gt;l2_ffn_act_gpu11 -->
<g id="edge157" class="edge">
<title>l2_ffn_gate_gpu11&#45;&gt;l2_ffn_act_gpu11</title>
<path fill="none" stroke="black" d="M4650.5,-3074.29C4650.5,-3074.29 4650.5,-2978.68 4650.5,-2978.68"/>
<polygon fill="black" stroke="black" points="4654,-2978.67 4650.5,-2968.68 4647,-2978.68 4654,-2978.67"/>
</g>
<!-- l2_ffn_down_gpu11 -->
<g id="node109" class="node">
<title>l2_ffn_down_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="4884,-2828.67 4403,-2828.67 4403,-2760.67 4884,-2760.67 4884,-2828.67"/>
<text text-anchor="middle" x="4643.5" y="-2813.47" font-family="Times,serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="4643.5" y="-2798.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4643.5" y="-2783.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4643.5" y="-2768.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_ffn_act_gpu11&#45;&gt;l2_ffn_down_gpu11 -->
<g id="edge158" class="edge">
<title>l2_ffn_act_gpu11&#45;&gt;l2_ffn_down_gpu11</title>
<path fill="none" stroke="black" d="M4651,-2900.42C4651,-2900.42 4651,-2839.05 4651,-2839.05"/>
<polygon fill="black" stroke="black" points="4654.5,-2839.05 4651,-2829.05 4647.5,-2839.05 4654.5,-2839.05"/>
</g>
<!-- l2_ffn_down_gpu11&#45;&gt;l2_residual_gpu11 -->
<g id="edge160" class="edge">
<title>l2_ffn_down_gpu11&#45;&gt;l2_residual_gpu11</title>
<path fill="none" stroke="black" d="M4639.5,-2760.61C4639.5,-2718.98 4639.5,-2654 4639.5,-2654 4639.5,-2654 4329.02,-2654 4329.02,-2654"/>
<polygon fill="black" stroke="black" points="4329.02,-2650.5 4319.02,-2654 4329.02,-2657.5 4329.02,-2650.5"/>
</g>
<!-- l2_layernorm_gpu11 -->
<g id="node111" class="node">
<title>l2_layernorm_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="3998,-2548.67 3539,-2548.67 3539,-2480.67 3998,-2480.67 3998,-2548.67"/>
<text text-anchor="middle" x="3768.5" y="-2533.47" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="3768.5" y="-2518.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3768.5" y="-2503.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3768.5" y="-2488.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_residual_gpu11&#45;&gt;l2_layernorm_gpu11 -->
<g id="edge161" class="edge">
<title>l2_residual_gpu11&#45;&gt;l2_layernorm_gpu11</title>
<path fill="none" stroke="black" d="M3919,-2620.42C3919,-2620.42 3919,-2559.05 3919,-2559.05"/>
<polygon fill="black" stroke="black" points="3922.5,-2559.05 3919,-2549.05 3915.5,-2559.05 3922.5,-2559.05"/>
</g>
<!-- l2_layernorm_gpu11&#45;&gt;l2_mha_allreduce -->
<g id="edge162" class="edge">
<title>l2_layernorm_gpu11&#45;&gt;l2_mha_allreduce</title>
<path fill="none" stroke="black" d="M3678.5,-2480.57C3678.5,-2429.74 3678.5,-2340 3678.5,-2340 3678.5,-2340 3097.89,-2340 3097.89,-2340"/>
<polygon fill="black" stroke="black" points="3097.89,-2336.5 3087.89,-2340 3097.89,-2343.5 3097.89,-2336.5"/>
</g>
<!-- l2_ffn_allreduce -->
<g id="node113" class="node">
<title>l2_ffn_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="3187.9,-2200.67 2415.74,-2200.67 2217.1,-2064.67 2989.26,-2064.67 3187.9,-2200.67"/>
<text text-anchor="middle" x="2702.5" y="-2151.47" font-family="Times,serif" font-size="14.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="2702.5" y="-2136.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="2702.5" y="-2121.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2702.5" y="-2106.47" font-family="Times,serif" font-size="14.00">GPU: 8&#45;11</text>
</g>
<!-- l2_mha_allreduce&#45;&gt;l2_ffn_allreduce -->
<g id="edge124" class="edge">
<title>l2_mha_allreduce&#45;&gt;l2_ffn_allreduce</title>
<path fill="none" stroke="black" d="M2411.38,-2272.56C2411.38,-2272.56 2411.38,-2207.74 2411.38,-2207.74"/>
<polygon fill="black" stroke="black" points="2414.88,-2207.74 2411.38,-2197.74 2407.88,-2207.74 2414.88,-2207.74"/>
</g>
<!-- l2_mha_allreduce&#45;&gt;l2_ffn_allreduce -->
<g id="edge137" class="edge">
<title>l2_mha_allreduce&#45;&gt;l2_ffn_allreduce</title>
<path fill="none" stroke="black" d="M2605.46,-2272.56C2605.46,-2272.56 2605.46,-2210.93 2605.46,-2210.93"/>
<polygon fill="black" stroke="black" points="2608.96,-2210.93 2605.46,-2200.93 2601.96,-2210.93 2608.96,-2210.93"/>
</g>
<!-- l2_mha_allreduce&#45;&gt;l2_ffn_allreduce -->
<g id="edge150" class="edge">
<title>l2_mha_allreduce&#45;&gt;l2_ffn_allreduce</title>
<path fill="none" stroke="black" d="M2799.54,-2272.56C2799.54,-2272.56 2799.54,-2210.93 2799.54,-2210.93"/>
<polygon fill="black" stroke="black" points="2803.04,-2210.93 2799.54,-2200.93 2796.04,-2210.93 2803.04,-2210.93"/>
</g>
<!-- l2_mha_allreduce&#45;&gt;l2_ffn_allreduce -->
<g id="edge163" class="edge">
<title>l2_mha_allreduce&#45;&gt;l2_ffn_allreduce</title>
<path fill="none" stroke="black" d="M2993.62,-2275.42C2993.62,-2275.42 2993.62,-2210.91 2993.62,-2210.91"/>
<polygon fill="black" stroke="black" points="2997.12,-2210.91 2993.62,-2200.91 2990.12,-2210.91 2997.12,-2210.91"/>
</g>
<!-- l2_output -->
<g id="node114" class="node">
<title>l2_output</title>
<ellipse fill="lightblue" stroke="black" cx="2702.5" cy="-1944.58" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="2702.5" y="-1963.38" font-family="Times,serif" font-size="14.00">Layer 2 Output</text>
<text text-anchor="middle" x="2702.5" y="-1948.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2702.5" y="-1933.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2702.5" y="-1918.38" font-family="Times,serif" font-size="14.00">GPU: 8&#45;11</text>
</g>
<!-- l2_ffn_allreduce&#45;&gt;l2_output -->
<g id="edge125" class="edge">
<title>l2_ffn_allreduce&#45;&gt;l2_output</title>
<path fill="none" stroke="black" d="M2507.76,-2064.5C2507.76,-2064.5 2507.76,-1993.27 2507.76,-1993.27"/>
<polygon fill="black" stroke="black" points="2511.26,-1993.27 2507.76,-1983.27 2504.26,-1993.27 2511.26,-1993.27"/>
</g>
<!-- l2_ffn_allreduce&#45;&gt;l2_output -->
<g id="edge138" class="edge">
<title>l2_ffn_allreduce&#45;&gt;l2_output</title>
<path fill="none" stroke="black" d="M2637.59,-2064.5C2637.59,-2064.5 2637.59,-2001.93 2637.59,-2001.93"/>
<polygon fill="black" stroke="black" points="2641.09,-2001.93 2637.59,-1991.93 2634.09,-2001.93 2641.09,-2001.93"/>
</g>
<!-- l2_ffn_allreduce&#45;&gt;l2_output -->
<g id="edge151" class="edge">
<title>l2_ffn_allreduce&#45;&gt;l2_output</title>
<path fill="none" stroke="black" d="M2767.41,-2064.5C2767.41,-2064.5 2767.41,-2001.93 2767.41,-2001.93"/>
<polygon fill="black" stroke="black" points="2770.91,-2001.93 2767.41,-1991.93 2763.91,-2001.93 2770.91,-2001.93"/>
</g>
<!-- l2_ffn_allreduce&#45;&gt;l2_output -->
<g id="edge164" class="edge">
<title>l2_ffn_allreduce&#45;&gt;l2_output</title>
<path fill="none" stroke="black" d="M2897.24,-2064.5C2897.24,-2064.5 2897.24,-1993.27 2897.24,-1993.27"/>
<polygon fill="black" stroke="black" points="2900.74,-1993.27 2897.24,-1983.27 2893.74,-1993.27 2900.74,-1993.27"/>
</g>
<!-- send_l2_l3 -->
<g id="node115" class="node">
<title>send_l2_l3</title>
<ellipse fill="orange" stroke="black" cx="2702.5" cy="-1776.42" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="2702.5" y="-1795.22" font-family="Times,serif" font-size="14.00">Pipeline Send</text>
<text text-anchor="middle" x="2702.5" y="-1780.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2702.5" y="-1765.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2702.5" y="-1750.22" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- l2_output&#45;&gt;send_l2_l3 -->
<g id="edge165" class="edge">
<title>l2_output&#45;&gt;send_l2_l3</title>
<path fill="none" stroke="black" d="M2702.5,-1896.39C2702.5,-1896.39 2702.5,-1834.61 2702.5,-1834.61"/>
<polygon fill="black" stroke="black" points="2706,-1834.61 2702.5,-1824.61 2699,-1834.61 2706,-1834.61"/>
</g>
<!-- l3_input_split -->
<g id="node116" class="node">
<title>l3_input_split</title>
<polygon fill="lightyellow" stroke="black" points="3200.28,-1656.33 2408.42,-1656.33 2204.72,-1520.33 2996.58,-1520.33 3200.28,-1656.33"/>
<text text-anchor="middle" x="2702.5" y="-1607.13" font-family="Times,serif" font-size="14.00">Input Broadcast</text>
<text text-anchor="middle" x="2702.5" y="-1592.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2702.5" y="-1577.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]×4</text>
<text text-anchor="middle" x="2702.5" y="-1562.13" font-family="Times,serif" font-size="14.00">GPU: 12&#45;15</text>
</g>
<!-- send_l2_l3&#45;&gt;l3_input_split -->
<g id="edge166" class="edge">
<title>send_l2_l3&#45;&gt;l3_input_split</title>
<path fill="none" stroke="black" d="M2702.5,-1727.98C2702.5,-1727.98 2702.5,-1666.45 2702.5,-1666.45"/>
<polygon fill="black" stroke="black" points="2706,-1666.45 2702.5,-1656.45 2699,-1666.45 2706,-1666.45"/>
</g>
<!-- l3_mha_qkv_split -->
<g id="node117" class="node">
<title>l3_mha_qkv_split</title>
<polygon fill="lightyellow" stroke="black" points="3289.1,-1448.33 2355.95,-1448.33 2115.9,-1312.33 3049.05,-1312.33 3289.1,-1448.33"/>
<text text-anchor="middle" x="2702.5" y="-1399.13" font-family="Times,serif" font-size="14.00">QKV Split</text>
<text text-anchor="middle" x="2702.5" y="-1384.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2702.5" y="-1369.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]×4</text>
<text text-anchor="middle" x="2702.5" y="-1354.13" font-family="Times,serif" font-size="14.00">GPU: 12&#45;15</text>
</g>
<!-- l3_input_split&#45;&gt;l3_mha_qkv_split -->
<g id="edge167" class="edge">
<title>l3_input_split&#45;&gt;l3_mha_qkv_split</title>
<path fill="none" stroke="black" d="M2702.5,-1520.23C2702.5,-1520.23 2702.5,-1458.59 2702.5,-1458.59"/>
<polygon fill="black" stroke="black" points="2706,-1458.59 2702.5,-1448.59 2699,-1458.59 2706,-1458.59"/>
</g>
<!-- l3_ffn_up_gpu12 -->
<g id="node120" class="node">
<title>l3_ffn_up_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="1022,-1414.33 529,-1414.33 529,-1346.33 1022,-1346.33 1022,-1414.33"/>
<text text-anchor="middle" x="775.5" y="-1399.13" font-family="Times,serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="775.5" y="-1384.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="775.5" y="-1369.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="775.5" y="-1354.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_input_split&#45;&gt;l3_ffn_up_gpu12 -->
<g id="edge170" class="edge">
<title>l3_input_split&#45;&gt;l3_ffn_up_gpu12</title>
<path fill="none" stroke="black" d="M2325.41,-1601C1827.74,-1601 1014,-1601 1014,-1601 1014,-1601 1014,-1424.81 1014,-1424.81"/>
<polygon fill="black" stroke="black" points="1017.5,-1424.81 1014,-1414.81 1010.5,-1424.81 1017.5,-1424.81"/>
</g>
<!-- l3_ffn_gate_gpu12 -->
<g id="node121" class="node">
<title>l3_ffn_gate_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="493,-1414.33 0,-1414.33 0,-1346.33 493,-1346.33 493,-1414.33"/>
<text text-anchor="middle" x="246.5" y="-1399.13" font-family="Times,serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="246.5" y="-1384.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="246.5" y="-1369.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="246.5" y="-1354.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_input_split&#45;&gt;l3_ffn_gate_gpu12 -->
<g id="edge171" class="edge">
<title>l3_input_split&#45;&gt;l3_ffn_gate_gpu12</title>
<path fill="none" stroke="black" d="M2367.27,-1629C1695.87,-1629 250,-1629 250,-1629 250,-1629 250,-1424.39 250,-1424.39"/>
<polygon fill="black" stroke="black" points="253.5,-1424.39 250,-1414.39 246.5,-1424.39 253.5,-1424.39"/>
</g>
<!-- l3_ffn_up_gpu13 -->
<g id="node128" class="node">
<title>l3_ffn_up_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="1551,-1414.33 1058,-1414.33 1058,-1346.33 1551,-1346.33 1551,-1414.33"/>
<text text-anchor="middle" x="1304.5" y="-1399.13" font-family="Times,serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="1304.5" y="-1384.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1304.5" y="-1369.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1304.5" y="-1354.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_input_split&#45;&gt;l3_ffn_up_gpu13 -->
<g id="edge183" class="edge">
<title>l3_input_split&#45;&gt;l3_ffn_up_gpu13</title>
<path fill="none" stroke="black" d="M2284.86,-1574C1951.51,-1574 1540,-1574 1540,-1574 1540,-1574 1540,-1424.51 1540,-1424.51"/>
<polygon fill="black" stroke="black" points="1543.5,-1424.51 1540,-1414.51 1536.5,-1424.51 1543.5,-1424.51"/>
</g>
<!-- l3_ffn_gate_gpu13 -->
<g id="node129" class="node">
<title>l3_ffn_gate_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="2080,-1414.33 1587,-1414.33 1587,-1346.33 2080,-1346.33 2080,-1414.33"/>
<text text-anchor="middle" x="1833.5" y="-1399.13" font-family="Times,serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="1833.5" y="-1384.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1833.5" y="-1369.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1833.5" y="-1354.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_input_split&#45;&gt;l3_ffn_gate_gpu13 -->
<g id="edge184" class="edge">
<title>l3_input_split&#45;&gt;l3_ffn_gate_gpu13</title>
<path fill="none" stroke="black" d="M2244.49,-1547C2057.35,-1547 1884,-1547 1884,-1547 1884,-1547 1884,-1424.46 1884,-1424.46"/>
<polygon fill="black" stroke="black" points="1887.5,-1424.46 1884,-1414.46 1880.5,-1424.46 1887.5,-1424.46"/>
</g>
<!-- l3_ffn_up_gpu14 -->
<g id="node136" class="node">
<title>l3_ffn_up_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="4347,-1414.33 3854,-1414.33 3854,-1346.33 4347,-1346.33 4347,-1414.33"/>
<text text-anchor="middle" x="4100.5" y="-1399.13" font-family="Times,serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="4100.5" y="-1384.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4100.5" y="-1369.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4100.5" y="-1354.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_input_split&#45;&gt;l3_ffn_up_gpu14 -->
<g id="edge196" class="edge">
<title>l3_input_split&#45;&gt;l3_ffn_up_gpu14</title>
<path fill="none" stroke="black" d="M3077.07,-1574C3436.8,-1574 3926,-1574 3926,-1574 3926,-1574 3926,-1424.51 3926,-1424.51"/>
<polygon fill="black" stroke="black" points="3929.5,-1424.51 3926,-1414.51 3922.5,-1424.51 3929.5,-1424.51"/>
</g>
<!-- l3_ffn_gate_gpu14 -->
<g id="node137" class="node">
<title>l3_ffn_gate_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="3818,-1414.33 3325,-1414.33 3325,-1346.33 3818,-1346.33 3818,-1414.33"/>
<text text-anchor="middle" x="3571.5" y="-1399.13" font-family="Times,serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="3571.5" y="-1384.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3571.5" y="-1369.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3571.5" y="-1354.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_input_split&#45;&gt;l3_ffn_gate_gpu14 -->
<g id="edge197" class="edge">
<title>l3_input_split&#45;&gt;l3_ffn_gate_gpu14</title>
<path fill="none" stroke="black" d="M3036.56,-1547C3228.57,-1547 3432,-1547 3432,-1547 3432,-1547 3432,-1424.46 3432,-1424.46"/>
<polygon fill="black" stroke="black" points="3435.5,-1424.46 3432,-1414.46 3428.5,-1424.46 3435.5,-1424.46"/>
</g>
<!-- l3_ffn_up_gpu15 -->
<g id="node144" class="node">
<title>l3_ffn_up_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="5405,-1414.33 4912,-1414.33 4912,-1346.33 5405,-1346.33 5405,-1414.33"/>
<text text-anchor="middle" x="5158.5" y="-1399.13" font-family="Times,serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="5158.5" y="-1384.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5158.5" y="-1369.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="5158.5" y="-1354.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_input_split&#45;&gt;l3_ffn_up_gpu15 -->
<g id="edge209" class="edge">
<title>l3_input_split&#45;&gt;l3_ffn_up_gpu15</title>
<path fill="none" stroke="black" d="M3159.35,-1629C3870.62,-1629 5162,-1629 5162,-1629 5162,-1629 5162,-1424.39 5162,-1424.39"/>
<polygon fill="black" stroke="black" points="5165.5,-1424.39 5162,-1414.39 5158.5,-1424.39 5165.5,-1424.39"/>
</g>
<!-- l3_ffn_gate_gpu15 -->
<g id="node145" class="node">
<title>l3_ffn_gate_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="4876,-1414.33 4383,-1414.33 4383,-1346.33 4876,-1346.33 4876,-1414.33"/>
<text text-anchor="middle" x="4629.5" y="-1399.13" font-family="Times,serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="4629.5" y="-1384.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4629.5" y="-1369.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4629.5" y="-1354.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_input_split&#45;&gt;l3_ffn_gate_gpu15 -->
<g id="edge210" class="edge">
<title>l3_input_split&#45;&gt;l3_ffn_gate_gpu15</title>
<path fill="none" stroke="black" d="M3117.44,-1601C3618.97,-1601 4396.5,-1601 4396.5,-1601 4396.5,-1601 4396.5,-1424.81 4396.5,-1424.81"/>
<polygon fill="black" stroke="black" points="4400,-1424.81 4396.5,-1414.81 4393,-1424.81 4400,-1424.81"/>
</g>
<!-- l3_mha_qkv_gpu12 -->
<g id="node118" class="node">
<title>l3_mha_qkv_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="2103,-1240.33 1558,-1240.33 1558,-1172.33 2103,-1172.33 2103,-1240.33"/>
<text text-anchor="middle" x="1830.5" y="-1225.13" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="1830.5" y="-1210.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1830.5" y="-1195.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="1830.5" y="-1180.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_mha_qkv_split&#45;&gt;l3_mha_qkv_gpu12 -->
<g id="edge168" class="edge">
<title>l3_mha_qkv_split&#45;&gt;l3_mha_qkv_gpu12</title>
<path fill="none" stroke="black" d="M2145.19,-1329C2111.88,-1329 2091.5,-1329 2091.5,-1329 2091.5,-1329 2091.5,-1250.5 2091.5,-1250.5"/>
<polygon fill="black" stroke="black" points="2095,-1250.5 2091.5,-1240.5 2088,-1250.5 2095,-1250.5"/>
</g>
<!-- l3_mha_qkv_gpu13 -->
<g id="node126" class="node">
<title>l3_mha_qkv_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="2684,-1240.33 2139,-1240.33 2139,-1172.33 2684,-1172.33 2684,-1240.33"/>
<text text-anchor="middle" x="2411.5" y="-1225.13" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="2411.5" y="-1210.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2411.5" y="-1195.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="2411.5" y="-1180.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_mha_qkv_split&#45;&gt;l3_mha_qkv_gpu13 -->
<g id="edge181" class="edge">
<title>l3_mha_qkv_split&#45;&gt;l3_mha_qkv_gpu13</title>
<path fill="none" stroke="black" d="M2411.5,-1312.06C2411.5,-1312.06 2411.5,-1250.44 2411.5,-1250.44"/>
<polygon fill="black" stroke="black" points="2415,-1250.44 2411.5,-1240.44 2408,-1250.44 2415,-1250.44"/>
</g>
<!-- l3_mha_qkv_gpu14 -->
<g id="node134" class="node">
<title>l3_mha_qkv_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="3265,-1240.33 2720,-1240.33 2720,-1172.33 3265,-1172.33 3265,-1240.33"/>
<text text-anchor="middle" x="2992.5" y="-1225.13" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="2992.5" y="-1210.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2992.5" y="-1195.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="2992.5" y="-1180.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_mha_qkv_split&#45;&gt;l3_mha_qkv_gpu14 -->
<g id="edge194" class="edge">
<title>l3_mha_qkv_split&#45;&gt;l3_mha_qkv_gpu14</title>
<path fill="none" stroke="black" d="M2992.5,-1312.06C2992.5,-1312.06 2992.5,-1250.44 2992.5,-1250.44"/>
<polygon fill="black" stroke="black" points="2996,-1250.44 2992.5,-1240.44 2989,-1250.44 2996,-1250.44"/>
</g>
<!-- l3_mha_qkv_gpu15 -->
<g id="node142" class="node">
<title>l3_mha_qkv_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="3846,-1240.33 3301,-1240.33 3301,-1172.33 3846,-1172.33 3846,-1240.33"/>
<text text-anchor="middle" x="3573.5" y="-1225.13" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="3573.5" y="-1210.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3573.5" y="-1195.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="3573.5" y="-1180.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_mha_qkv_split&#45;&gt;l3_mha_qkv_gpu15 -->
<g id="edge207" class="edge">
<title>l3_mha_qkv_split&#45;&gt;l3_mha_qkv_gpu15</title>
<path fill="none" stroke="black" d="M3078.84,-1329C3202.55,-1329 3309,-1329 3309,-1329 3309,-1329 3309,-1250.5 3309,-1250.5"/>
<polygon fill="black" stroke="black" points="3312.5,-1250.5 3309,-1240.5 3305.5,-1250.5 3312.5,-1250.5"/>
</g>
<!-- l3_mha_attn_gpu12 -->
<g id="node119" class="node">
<title>l3_mha_attn_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="2097,-1100.33 1564,-1100.33 1564,-1032.33 2097,-1032.33 2097,-1100.33"/>
<text text-anchor="middle" x="1830.5" y="-1085.13" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="1830.5" y="-1070.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="1830.5" y="-1055.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1830.5" y="-1040.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_mha_qkv_gpu12&#45;&gt;l3_mha_attn_gpu12 -->
<g id="edge169" class="edge">
<title>l3_mha_qkv_gpu12&#45;&gt;l3_mha_attn_gpu12</title>
<path fill="none" stroke="black" d="M1830.5,-1172.09C1830.5,-1172.09 1830.5,-1110.71 1830.5,-1110.71"/>
<polygon fill="black" stroke="black" points="1834,-1110.71 1830.5,-1100.71 1827,-1110.71 1834,-1110.71"/>
</g>
<!-- l3_residual_gpu12 -->
<g id="node124" class="node">
<title>l3_residual_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="2070,-960.33 1591,-960.33 1591,-892.33 2070,-892.33 2070,-960.33"/>
<text text-anchor="middle" x="1830.5" y="-945.13" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1830.5" y="-930.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024] (x2)</text>
<text text-anchor="middle" x="1830.5" y="-915.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1830.5" y="-900.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_mha_attn_gpu12&#45;&gt;l3_residual_gpu12 -->
<g id="edge175" class="edge">
<title>l3_mha_attn_gpu12&#45;&gt;l3_residual_gpu12</title>
<path fill="none" stroke="black" d="M1830.5,-1032.09C1830.5,-1032.09 1830.5,-970.71 1830.5,-970.71"/>
<polygon fill="black" stroke="black" points="1834,-970.71 1830.5,-960.71 1827,-970.71 1834,-970.71"/>
</g>
<!-- l3_ffn_act_gpu12 -->
<g id="node122" class="node">
<title>l3_ffn_act_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="993,-1240.33 500,-1240.33 500,-1172.33 993,-1172.33 993,-1240.33"/>
<text text-anchor="middle" x="746.5" y="-1225.13" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="746.5" y="-1210.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="746.5" y="-1195.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="746.5" y="-1180.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_ffn_up_gpu12&#45;&gt;l3_ffn_act_gpu12 -->
<g id="edge172" class="edge">
<title>l3_ffn_up_gpu12&#45;&gt;l3_ffn_act_gpu12</title>
<path fill="none" stroke="black" d="M761,-1345.96C761,-1345.96 761,-1250.34 761,-1250.34"/>
<polygon fill="black" stroke="black" points="764.5,-1250.34 761,-1240.34 757.5,-1250.34 764.5,-1250.34"/>
</g>
<!-- l3_ffn_gate_gpu12&#45;&gt;l3_ffn_act_gpu12 -->
<g id="edge173" class="edge">
<title>l3_ffn_gate_gpu12&#45;&gt;l3_ffn_act_gpu12</title>
<path fill="none" stroke="black" d="M493.02,-1380C507.3,-1380 516,-1380 516,-1380 516,-1380 516,-1250.64 516,-1250.64"/>
<polygon fill="black" stroke="black" points="519.5,-1250.64 516,-1240.64 512.5,-1250.64 519.5,-1250.64"/>
</g>
<!-- l3_ffn_down_gpu12 -->
<g id="node123" class="node">
<title>l3_ffn_down_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="993,-1100.33 512,-1100.33 512,-1032.33 993,-1032.33 993,-1100.33"/>
<text text-anchor="middle" x="752.5" y="-1085.13" font-family="Times,serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="752.5" y="-1070.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="752.5" y="-1055.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="752.5" y="-1040.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_ffn_act_gpu12&#45;&gt;l3_ffn_down_gpu12 -->
<g id="edge174" class="edge">
<title>l3_ffn_act_gpu12&#45;&gt;l3_ffn_down_gpu12</title>
<path fill="none" stroke="black" d="M752.5,-1172.09C752.5,-1172.09 752.5,-1110.71 752.5,-1110.71"/>
<polygon fill="black" stroke="black" points="756,-1110.71 752.5,-1100.71 749,-1110.71 756,-1110.71"/>
</g>
<!-- l3_ffn_down_gpu12&#45;&gt;l3_residual_gpu12 -->
<g id="edge176" class="edge">
<title>l3_ffn_down_gpu12&#45;&gt;l3_residual_gpu12</title>
<path fill="none" stroke="black" d="M752.5,-1032C752.5,-990.46 752.5,-926 752.5,-926 752.5,-926 1580.92,-926 1580.92,-926"/>
<polygon fill="black" stroke="black" points="1580.92,-929.5 1590.92,-926 1580.92,-922.5 1580.92,-929.5"/>
</g>
<!-- l3_layernorm_gpu12 -->
<g id="node125" class="node">
<title>l3_layernorm_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="2140,-820.33 1681,-820.33 1681,-752.33 2140,-752.33 2140,-820.33"/>
<text text-anchor="middle" x="1910.5" y="-805.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1910.5" y="-790.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1910.5" y="-775.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1910.5" y="-760.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_residual_gpu12&#45;&gt;l3_layernorm_gpu12 -->
<g id="edge177" class="edge">
<title>l3_residual_gpu12&#45;&gt;l3_layernorm_gpu12</title>
<path fill="none" stroke="black" d="M1875.5,-892.09C1875.5,-892.09 1875.5,-830.71 1875.5,-830.71"/>
<polygon fill="black" stroke="black" points="1879,-830.71 1875.5,-820.71 1872,-830.71 1879,-830.71"/>
</g>
<!-- l3_mha_allreduce -->
<g id="node150" class="node">
<title>l3_mha_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="3180.9,-680.33 2408.74,-680.33 2210.1,-544.33 2982.26,-544.33 3180.9,-680.33"/>
<text text-anchor="middle" x="2695.5" y="-631.13" font-family="Times,serif" font-size="14.00">MHA All&#45;Reduce</text>
<text text-anchor="middle" x="2695.5" y="-616.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="2695.5" y="-601.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2695.5" y="-586.13" font-family="Times,serif" font-size="14.00">GPU: 12&#45;15</text>
</g>
<!-- l3_layernorm_gpu12&#45;&gt;l3_mha_allreduce -->
<g id="edge178" class="edge">
<title>l3_layernorm_gpu12&#45;&gt;l3_mha_allreduce</title>
<path fill="none" stroke="black" d="M2140.25,-786C2183.06,-786 2214.65,-786 2214.65,-786 2214.65,-786 2214.65,-622.46 2214.65,-622.46"/>
<polygon fill="black" stroke="black" points="2218.15,-622.46 2214.65,-612.46 2211.15,-622.46 2218.15,-622.46"/>
</g>
<!-- l3_mha_attn_gpu13 -->
<g id="node127" class="node">
<title>l3_mha_attn_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="2678,-1100.33 2145,-1100.33 2145,-1032.33 2678,-1032.33 2678,-1100.33"/>
<text text-anchor="middle" x="2411.5" y="-1085.13" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="2411.5" y="-1070.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="2411.5" y="-1055.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2411.5" y="-1040.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_mha_qkv_gpu13&#45;&gt;l3_mha_attn_gpu13 -->
<g id="edge182" class="edge">
<title>l3_mha_qkv_gpu13&#45;&gt;l3_mha_attn_gpu13</title>
<path fill="none" stroke="black" d="M2411.5,-1172.09C2411.5,-1172.09 2411.5,-1110.71 2411.5,-1110.71"/>
<polygon fill="black" stroke="black" points="2415,-1110.71 2411.5,-1100.71 2408,-1110.71 2415,-1110.71"/>
</g>
<!-- l3_residual_gpu13 -->
<g id="node132" class="node">
<title>l3_residual_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="2651,-960.33 2172,-960.33 2172,-892.33 2651,-892.33 2651,-960.33"/>
<text text-anchor="middle" x="2411.5" y="-945.13" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2411.5" y="-930.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024] (x2)</text>
<text text-anchor="middle" x="2411.5" y="-915.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2411.5" y="-900.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_mha_attn_gpu13&#45;&gt;l3_residual_gpu13 -->
<g id="edge188" class="edge">
<title>l3_mha_attn_gpu13&#45;&gt;l3_residual_gpu13</title>
<path fill="none" stroke="black" d="M2411.5,-1032.09C2411.5,-1032.09 2411.5,-970.71 2411.5,-970.71"/>
<polygon fill="black" stroke="black" points="2415,-970.71 2411.5,-960.71 2408,-970.71 2415,-970.71"/>
</g>
<!-- l3_ffn_act_gpu13 -->
<g id="node130" class="node">
<title>l3_ffn_act_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="1522,-1240.33 1029,-1240.33 1029,-1172.33 1522,-1172.33 1522,-1240.33"/>
<text text-anchor="middle" x="1275.5" y="-1225.13" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="1275.5" y="-1210.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1275.5" y="-1195.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1275.5" y="-1180.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_ffn_up_gpu13&#45;&gt;l3_ffn_act_gpu13 -->
<g id="edge185" class="edge">
<title>l3_ffn_up_gpu13&#45;&gt;l3_ffn_act_gpu13</title>
<path fill="none" stroke="black" d="M1290,-1345.96C1290,-1345.96 1290,-1250.34 1290,-1250.34"/>
<polygon fill="black" stroke="black" points="1293.5,-1250.34 1290,-1240.34 1286.5,-1250.34 1293.5,-1250.34"/>
</g>
<!-- l3_ffn_gate_gpu13&#45;&gt;l3_ffn_act_gpu13 -->
<g id="edge186" class="edge">
<title>l3_ffn_gate_gpu13&#45;&gt;l3_ffn_act_gpu13</title>
<path fill="none" stroke="black" d="M1586.78,-1380C1567.03,-1380 1554.5,-1380 1554.5,-1380 1554.5,-1380 1554.5,-1206 1554.5,-1206 1554.5,-1206 1532.22,-1206 1532.22,-1206"/>
<polygon fill="black" stroke="black" points="1532.22,-1202.5 1522.22,-1206 1532.22,-1209.5 1532.22,-1202.5"/>
</g>
<!-- l3_ffn_down_gpu13 -->
<g id="node131" class="node">
<title>l3_ffn_down_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="1522,-1100.33 1041,-1100.33 1041,-1032.33 1522,-1032.33 1522,-1100.33"/>
<text text-anchor="middle" x="1281.5" y="-1085.13" font-family="Times,serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="1281.5" y="-1070.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1281.5" y="-1055.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1281.5" y="-1040.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_ffn_act_gpu13&#45;&gt;l3_ffn_down_gpu13 -->
<g id="edge187" class="edge">
<title>l3_ffn_act_gpu13&#45;&gt;l3_ffn_down_gpu13</title>
<path fill="none" stroke="black" d="M1281.5,-1172.09C1281.5,-1172.09 1281.5,-1110.71 1281.5,-1110.71"/>
<polygon fill="black" stroke="black" points="1285,-1110.71 1281.5,-1100.71 1278,-1110.71 1285,-1110.71"/>
</g>
<!-- l3_ffn_down_gpu13&#45;&gt;l3_residual_gpu13 -->
<g id="edge189" class="edge">
<title>l3_ffn_down_gpu13&#45;&gt;l3_residual_gpu13</title>
<path fill="none" stroke="black" d="M1281.5,-1032.07C1281.5,-972.47 1281.5,-856 1281.5,-856 1281.5,-856 2191.15,-856 2191.15,-856 2191.15,-856 2191.15,-881.99 2191.15,-881.99"/>
<polygon fill="black" stroke="black" points="2187.65,-881.99 2191.15,-891.99 2194.65,-881.99 2187.65,-881.99"/>
</g>
<!-- l3_layernorm_gpu13 -->
<g id="node133" class="node">
<title>l3_layernorm_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="2678,-820.33 2219,-820.33 2219,-752.33 2678,-752.33 2678,-820.33"/>
<text text-anchor="middle" x="2448.5" y="-805.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="2448.5" y="-790.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2448.5" y="-775.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2448.5" y="-760.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_residual_gpu13&#45;&gt;l3_layernorm_gpu13 -->
<g id="edge190" class="edge">
<title>l3_residual_gpu13&#45;&gt;l3_layernorm_gpu13</title>
<path fill="none" stroke="black" d="M2435,-892.09C2435,-892.09 2435,-830.71 2435,-830.71"/>
<polygon fill="black" stroke="black" points="2438.5,-830.71 2435,-820.71 2431.5,-830.71 2438.5,-830.71"/>
</g>
<!-- l3_layernorm_gpu13&#45;&gt;l3_mha_allreduce -->
<g id="edge191" class="edge">
<title>l3_layernorm_gpu13&#45;&gt;l3_mha_allreduce</title>
<path fill="none" stroke="black" d="M2448.5,-751.96C2448.5,-751.96 2448.5,-690.47 2448.5,-690.47"/>
<polygon fill="black" stroke="black" points="2452,-690.47 2448.5,-680.47 2445,-690.47 2452,-690.47"/>
</g>
<!-- l3_mha_attn_gpu14 -->
<g id="node135" class="node">
<title>l3_mha_attn_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="3253,-1100.33 2720,-1100.33 2720,-1032.33 3253,-1032.33 3253,-1100.33"/>
<text text-anchor="middle" x="2986.5" y="-1085.13" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="2986.5" y="-1070.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="2986.5" y="-1055.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2986.5" y="-1040.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_mha_qkv_gpu14&#45;&gt;l3_mha_attn_gpu14 -->
<g id="edge195" class="edge">
<title>l3_mha_qkv_gpu14&#45;&gt;l3_mha_attn_gpu14</title>
<path fill="none" stroke="black" d="M2986.5,-1172.09C2986.5,-1172.09 2986.5,-1110.71 2986.5,-1110.71"/>
<polygon fill="black" stroke="black" points="2990,-1110.71 2986.5,-1100.71 2983,-1110.71 2990,-1110.71"/>
</g>
<!-- l3_residual_gpu14 -->
<g id="node140" class="node">
<title>l3_residual_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="3226,-960.33 2747,-960.33 2747,-892.33 3226,-892.33 3226,-960.33"/>
<text text-anchor="middle" x="2986.5" y="-945.13" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2986.5" y="-930.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024] (x2)</text>
<text text-anchor="middle" x="2986.5" y="-915.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2986.5" y="-900.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_mha_attn_gpu14&#45;&gt;l3_residual_gpu14 -->
<g id="edge201" class="edge">
<title>l3_mha_attn_gpu14&#45;&gt;l3_residual_gpu14</title>
<path fill="none" stroke="black" d="M2986.5,-1032.09C2986.5,-1032.09 2986.5,-970.71 2986.5,-970.71"/>
<polygon fill="black" stroke="black" points="2990,-970.71 2986.5,-960.71 2983,-970.71 2990,-970.71"/>
</g>
<!-- l3_ffn_act_gpu14 -->
<g id="node138" class="node">
<title>l3_ffn_act_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="4375,-1240.33 3882,-1240.33 3882,-1172.33 4375,-1172.33 4375,-1240.33"/>
<text text-anchor="middle" x="4128.5" y="-1225.13" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="4128.5" y="-1210.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4128.5" y="-1195.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4128.5" y="-1180.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_ffn_up_gpu14&#45;&gt;l3_ffn_act_gpu14 -->
<g id="edge198" class="edge">
<title>l3_ffn_up_gpu14&#45;&gt;l3_ffn_act_gpu14</title>
<path fill="none" stroke="black" d="M4114.5,-1345.96C4114.5,-1345.96 4114.5,-1250.34 4114.5,-1250.34"/>
<polygon fill="black" stroke="black" points="4118,-1250.34 4114.5,-1240.34 4111,-1250.34 4118,-1250.34"/>
</g>
<!-- l3_ffn_gate_gpu14&#45;&gt;l3_ffn_act_gpu14 -->
<g id="edge199" class="edge">
<title>l3_ffn_gate_gpu14&#45;&gt;l3_ffn_act_gpu14</title>
<path fill="none" stroke="black" d="M3818.05,-1380C3837.61,-1380 3850,-1380 3850,-1380 3850,-1380 3850,-1206 3850,-1206 3850,-1206 3871.95,-1206 3871.95,-1206"/>
<polygon fill="black" stroke="black" points="3871.95,-1209.5 3881.95,-1206 3871.95,-1202.5 3871.95,-1209.5"/>
</g>
<!-- l3_ffn_down_gpu14 -->
<g id="node139" class="node">
<title>l3_ffn_down_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="3770,-1100.33 3289,-1100.33 3289,-1032.33 3770,-1032.33 3770,-1100.33"/>
<text text-anchor="middle" x="3529.5" y="-1085.13" font-family="Times,serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="3529.5" y="-1070.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3529.5" y="-1055.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3529.5" y="-1040.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_ffn_act_gpu14&#45;&gt;l3_ffn_down_gpu14 -->
<g id="edge200" class="edge">
<title>l3_ffn_act_gpu14&#45;&gt;l3_ffn_down_gpu14</title>
<path fill="none" stroke="black" d="M4110.5,-1171.99C4110.5,-1154.14 4110.5,-1136 4110.5,-1136 4110.5,-1136 3535.5,-1136 3535.5,-1136 3535.5,-1136 3535.5,-1110.35 3535.5,-1110.35"/>
<polygon fill="black" stroke="black" points="3539,-1110.35 3535.5,-1100.35 3532,-1110.35 3539,-1110.35"/>
</g>
<!-- l3_ffn_down_gpu14&#45;&gt;l3_residual_gpu14 -->
<g id="edge202" class="edge">
<title>l3_ffn_down_gpu14&#45;&gt;l3_residual_gpu14</title>
<path fill="none" stroke="black" d="M3410.5,-1032C3410.5,-990.46 3410.5,-926 3410.5,-926 3410.5,-926 3236.07,-926 3236.07,-926"/>
<polygon fill="black" stroke="black" points="3236.07,-922.5 3226.07,-926 3236.07,-929.5 3236.07,-922.5"/>
</g>
<!-- l3_layernorm_gpu14 -->
<g id="node141" class="node">
<title>l3_layernorm_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="3191,-820.33 2732,-820.33 2732,-752.33 3191,-752.33 3191,-820.33"/>
<text text-anchor="middle" x="2961.5" y="-805.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="2961.5" y="-790.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2961.5" y="-775.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2961.5" y="-760.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_residual_gpu14&#45;&gt;l3_layernorm_gpu14 -->
<g id="edge203" class="edge">
<title>l3_residual_gpu14&#45;&gt;l3_layernorm_gpu14</title>
<path fill="none" stroke="black" d="M2969,-892.09C2969,-892.09 2969,-830.71 2969,-830.71"/>
<polygon fill="black" stroke="black" points="2972.5,-830.71 2969,-820.71 2965.5,-830.71 2972.5,-830.71"/>
</g>
<!-- l3_layernorm_gpu14&#45;&gt;l3_mha_allreduce -->
<g id="edge204" class="edge">
<title>l3_layernorm_gpu14&#45;&gt;l3_mha_allreduce</title>
<path fill="none" stroke="black" d="M2956.35,-751.96C2956.35,-751.96 2956.35,-690.47 2956.35,-690.47"/>
<polygon fill="black" stroke="black" points="2959.85,-690.47 2956.35,-680.47 2952.85,-690.47 2959.85,-690.47"/>
</g>
<!-- l3_mha_attn_gpu15 -->
<g id="node143" class="node">
<title>l3_mha_attn_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="4339,-1100.33 3806,-1100.33 3806,-1032.33 4339,-1032.33 4339,-1100.33"/>
<text text-anchor="middle" x="4072.5" y="-1085.13" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="4072.5" y="-1070.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="4072.5" y="-1055.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4072.5" y="-1040.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_mha_qkv_gpu15&#45;&gt;l3_mha_attn_gpu15 -->
<g id="edge208" class="edge">
<title>l3_mha_qkv_gpu15&#45;&gt;l3_mha_attn_gpu15</title>
<path fill="none" stroke="black" d="M3826,-1172.09C3826,-1172.09 3826,-1110.71 3826,-1110.71"/>
<polygon fill="black" stroke="black" points="3829.5,-1110.71 3826,-1100.71 3822.5,-1110.71 3829.5,-1110.71"/>
</g>
<!-- l3_residual_gpu15 -->
<g id="node148" class="node">
<title>l3_residual_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="4312,-960.33 3833,-960.33 3833,-892.33 4312,-892.33 4312,-960.33"/>
<text text-anchor="middle" x="4072.5" y="-945.13" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4072.5" y="-930.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024] (x2)</text>
<text text-anchor="middle" x="4072.5" y="-915.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4072.5" y="-900.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_mha_attn_gpu15&#45;&gt;l3_residual_gpu15 -->
<g id="edge214" class="edge">
<title>l3_mha_attn_gpu15&#45;&gt;l3_residual_gpu15</title>
<path fill="none" stroke="black" d="M4072.5,-1032.09C4072.5,-1032.09 4072.5,-970.71 4072.5,-970.71"/>
<polygon fill="black" stroke="black" points="4076,-970.71 4072.5,-960.71 4069,-970.71 4076,-970.71"/>
</g>
<!-- l3_ffn_act_gpu15 -->
<g id="node146" class="node">
<title>l3_ffn_act_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="4904,-1240.33 4411,-1240.33 4411,-1172.33 4904,-1172.33 4904,-1240.33"/>
<text text-anchor="middle" x="4657.5" y="-1225.13" font-family="Times,serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="4657.5" y="-1210.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4657.5" y="-1195.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4657.5" y="-1180.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_ffn_up_gpu15&#45;&gt;l3_ffn_act_gpu15 -->
<g id="edge211" class="edge">
<title>l3_ffn_up_gpu15&#45;&gt;l3_ffn_act_gpu15</title>
<path fill="none" stroke="black" d="M4911.77,-1380C4900.62,-1380 4894,-1380 4894,-1380 4894,-1380 4894,-1250.64 4894,-1250.64"/>
<polygon fill="black" stroke="black" points="4897.5,-1250.64 4894,-1240.64 4890.5,-1250.64 4897.5,-1250.64"/>
</g>
<!-- l3_ffn_gate_gpu15&#45;&gt;l3_ffn_act_gpu15 -->
<g id="edge212" class="edge">
<title>l3_ffn_gate_gpu15&#45;&gt;l3_ffn_act_gpu15</title>
<path fill="none" stroke="black" d="M4643.5,-1345.96C4643.5,-1345.96 4643.5,-1250.34 4643.5,-1250.34"/>
<polygon fill="black" stroke="black" points="4647,-1250.34 4643.5,-1240.34 4640,-1250.34 4647,-1250.34"/>
</g>
<!-- l3_ffn_down_gpu15 -->
<g id="node147" class="node">
<title>l3_ffn_down_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="4877,-1100.33 4396,-1100.33 4396,-1032.33 4877,-1032.33 4877,-1100.33"/>
<text text-anchor="middle" x="4636.5" y="-1085.13" font-family="Times,serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="4636.5" y="-1070.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4636.5" y="-1055.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4636.5" y="-1040.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_ffn_act_gpu15&#45;&gt;l3_ffn_down_gpu15 -->
<g id="edge213" class="edge">
<title>l3_ffn_act_gpu15&#45;&gt;l3_ffn_down_gpu15</title>
<path fill="none" stroke="black" d="M4644,-1172.09C4644,-1172.09 4644,-1110.71 4644,-1110.71"/>
<polygon fill="black" stroke="black" points="4647.5,-1110.71 4644,-1100.71 4640.5,-1110.71 4647.5,-1110.71"/>
</g>
<!-- l3_ffn_down_gpu15&#45;&gt;l3_residual_gpu15 -->
<g id="edge215" class="edge">
<title>l3_ffn_down_gpu15&#45;&gt;l3_residual_gpu15</title>
<path fill="none" stroke="black" d="M4636.5,-1032C4636.5,-990.46 4636.5,-926 4636.5,-926 4636.5,-926 4322.1,-926 4322.1,-926"/>
<polygon fill="black" stroke="black" points="4322.1,-922.5 4312.1,-926 4322.1,-929.5 4322.1,-922.5"/>
</g>
<!-- l3_layernorm_gpu15 -->
<g id="node149" class="node">
<title>l3_layernorm_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="3991,-820.33 3532,-820.33 3532,-752.33 3991,-752.33 3991,-820.33"/>
<text text-anchor="middle" x="3761.5" y="-805.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="3761.5" y="-790.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3761.5" y="-775.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3761.5" y="-760.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_residual_gpu15&#45;&gt;l3_layernorm_gpu15 -->
<g id="edge216" class="edge">
<title>l3_residual_gpu15&#45;&gt;l3_layernorm_gpu15</title>
<path fill="none" stroke="black" d="M3912,-892.09C3912,-892.09 3912,-830.71 3912,-830.71"/>
<polygon fill="black" stroke="black" points="3915.5,-830.71 3912,-820.71 3908.5,-830.71 3915.5,-830.71"/>
</g>
<!-- l3_layernorm_gpu15&#45;&gt;l3_mha_allreduce -->
<g id="edge217" class="edge">
<title>l3_layernorm_gpu15&#45;&gt;l3_mha_allreduce</title>
<path fill="none" stroke="black" d="M3761.5,-752.31C3761.5,-701.57 3761.5,-612 3761.5,-612 3761.5,-612 3091.1,-612 3091.1,-612"/>
<polygon fill="black" stroke="black" points="3091.1,-608.5 3081.1,-612 3091.1,-615.5 3091.1,-608.5"/>
</g>
<!-- l3_ffn_allreduce -->
<g id="node151" class="node">
<title>l3_ffn_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="3180.9,-472.33 2408.74,-472.33 2210.1,-336.33 2982.26,-336.33 3180.9,-472.33"/>
<text text-anchor="middle" x="2695.5" y="-423.13" font-family="Times,serif" font-size="14.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="2695.5" y="-408.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="2695.5" y="-393.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2695.5" y="-378.13" font-family="Times,serif" font-size="14.00">GPU: 12&#45;15</text>
</g>
<!-- l3_mha_allreduce&#45;&gt;l3_ffn_allreduce -->
<g id="edge179" class="edge">
<title>l3_mha_allreduce&#45;&gt;l3_ffn_allreduce</title>
<path fill="none" stroke="black" d="M2404.38,-544.23C2404.38,-544.23 2404.38,-479.41 2404.38,-479.41"/>
<polygon fill="black" stroke="black" points="2407.88,-479.41 2404.38,-469.41 2400.88,-479.41 2407.88,-479.41"/>
</g>
<!-- l3_mha_allreduce&#45;&gt;l3_ffn_allreduce -->
<g id="edge192" class="edge">
<title>l3_mha_allreduce&#45;&gt;l3_ffn_allreduce</title>
<path fill="none" stroke="black" d="M2598.46,-544.23C2598.46,-544.23 2598.46,-482.59 2598.46,-482.59"/>
<polygon fill="black" stroke="black" points="2601.96,-482.59 2598.46,-472.59 2594.96,-482.59 2601.96,-482.59"/>
</g>
<!-- l3_mha_allreduce&#45;&gt;l3_ffn_allreduce -->
<g id="edge205" class="edge">
<title>l3_mha_allreduce&#45;&gt;l3_ffn_allreduce</title>
<path fill="none" stroke="black" d="M2792.54,-544.23C2792.54,-544.23 2792.54,-482.59 2792.54,-482.59"/>
<polygon fill="black" stroke="black" points="2796.04,-482.59 2792.54,-472.59 2789.04,-482.59 2796.04,-482.59"/>
</g>
<!-- l3_mha_allreduce&#45;&gt;l3_ffn_allreduce -->
<g id="edge218" class="edge">
<title>l3_mha_allreduce&#45;&gt;l3_ffn_allreduce</title>
<path fill="none" stroke="black" d="M2986.62,-547.09C2986.62,-547.09 2986.62,-482.58 2986.62,-482.58"/>
<polygon fill="black" stroke="black" points="2990.12,-482.58 2986.62,-472.58 2983.12,-482.58 2990.12,-482.58"/>
</g>
<!-- l3_output -->
<g id="node152" class="node">
<title>l3_output</title>
<ellipse fill="lightblue" stroke="black" cx="2695.5" cy="-216.25" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="2695.5" y="-235.05" font-family="Times,serif" font-size="14.00">Layer 3 Output</text>
<text text-anchor="middle" x="2695.5" y="-220.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2695.5" y="-205.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2695.5" y="-190.05" font-family="Times,serif" font-size="14.00">GPU: 12&#45;15</text>
</g>
<!-- l3_ffn_allreduce&#45;&gt;l3_output -->
<g id="edge180" class="edge">
<title>l3_ffn_allreduce&#45;&gt;l3_output</title>
<path fill="none" stroke="black" d="M2500.76,-336.16C2500.76,-336.16 2500.76,-264.94 2500.76,-264.94"/>
<polygon fill="black" stroke="black" points="2504.26,-264.94 2500.76,-254.94 2497.26,-264.94 2504.26,-264.94"/>
</g>
<!-- l3_ffn_allreduce&#45;&gt;l3_output -->
<g id="edge193" class="edge">
<title>l3_ffn_allreduce&#45;&gt;l3_output</title>
<path fill="none" stroke="black" d="M2630.59,-336.16C2630.59,-336.16 2630.59,-273.59 2630.59,-273.59"/>
<polygon fill="black" stroke="black" points="2634.09,-273.59 2630.59,-263.59 2627.09,-273.59 2634.09,-273.59"/>
</g>
<!-- l3_ffn_allreduce&#45;&gt;l3_output -->
<g id="edge206" class="edge">
<title>l3_ffn_allreduce&#45;&gt;l3_output</title>
<path fill="none" stroke="black" d="M2760.41,-336.16C2760.41,-336.16 2760.41,-273.59 2760.41,-273.59"/>
<polygon fill="black" stroke="black" points="2763.91,-273.59 2760.41,-263.59 2756.91,-273.59 2763.91,-273.59"/>
</g>
<!-- l3_ffn_allreduce&#45;&gt;l3_output -->
<g id="edge219" class="edge">
<title>l3_ffn_allreduce&#45;&gt;l3_output</title>
<path fill="none" stroke="black" d="M2890.24,-336.16C2890.24,-336.16 2890.24,-264.94 2890.24,-264.94"/>
<polygon fill="black" stroke="black" points="2893.74,-264.94 2890.24,-254.94 2886.74,-264.94 2893.74,-264.94"/>
</g>
<!-- final_output -->
<g id="node153" class="node">
<title>final_output</title>
<ellipse fill="lightblue" stroke="black" cx="2695.5" cy="-48.08" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="2695.5" y="-66.88" font-family="Times,serif" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="2695.5" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2695.5" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2695.5" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: 12&#45;15</text>
</g>
<!-- l3_output&#45;&gt;final_output -->
<g id="edge220" class="edge">
<title>l3_output&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M2695.5,-168.06C2695.5,-168.06 2695.5,-106.28 2695.5,-106.28"/>
<polygon fill="black" stroke="black" points="2699,-106.28 2695.5,-96.28 2692,-106.28 2699,-106.28"/>
</g>
</g>
</svg>
