<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_dag Pages: 1 -->
<svg width="1278pt" height="8787pt"
 viewBox="0.00 0.00 1278.00 8787.29" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 8783.29)">
<title>baseline_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-8783.29 1274,-8783.29 1274,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="140,-4504.33 140,-8694.33 1262,-8694.33 1262,-4504.33 140,-4504.33"/>
<text text-anchor="middle" x="701" y="-8679.13" font-family="Times,serif" font-size="14.00">Pipeline Stage 0 (GPUs 0&#45;7)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer0</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="148,-6604.33 148,-8663.33 1254,-8663.33 1254,-6604.33 148,-6604.33"/>
<text text-anchor="middle" x="701" y="-8648.13" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer1</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="148,-4512.33 148,-6571.33 1254,-6571.33 1254,-4512.33 148,-4512.33"/>
<text text-anchor="middle" x="701" y="-6556.13" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage1</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="8,-152.17 8,-4342.17 1130,-4342.17 1130,-152.17 8,-152.17"/>
<text text-anchor="middle" x="569" y="-4326.97" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (GPUs 8&#45;15)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer2</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="16,-2252.17 16,-4311.17 1122,-4311.17 1122,-2252.17 16,-2252.17"/>
<text text-anchor="middle" x="569" y="-4295.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer3</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="16,-160.17 16,-2219.17 1122,-2219.17 1122,-160.17 16,-160.17"/>
<text text-anchor="middle" x="569" y="-2203.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="955" cy="-8741.81" rx="312.58" ry="37.45"/>
<text text-anchor="middle" x="955" y="-8753.11" font-family="Helvetica,sans-Serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="955" y="-8738.11" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="955" y="-8723.11" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l0_input_split -->
<g id="node2" class="node">
<title>l0_input_split</title>
<polygon fill="lightyellow" stroke="black" points="1169.25,-8632.33 400.51,-8632.33 202.75,-8496.33 971.49,-8496.33 1169.25,-8632.33"/>
<text text-anchor="middle" x="686" y="-8583.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="686" y="-8568.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="686" y="-8553.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="686" y="-8538.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- input&#45;&gt;l0_input_split -->
<g id="edge1" class="edge">
<title>input&#45;&gt;l0_input_split</title>
<path fill="none" stroke="black" d="M905.79,-8704.6C905.79,-8704.6 905.79,-8642.68 905.79,-8642.68"/>
<polygon fill="black" stroke="black" points="909.29,-8642.68 905.79,-8632.68 902.29,-8642.68 909.29,-8642.68"/>
</g>
<!-- l0_mha_residual -->
<g id="node6" class="node">
<title>l0_mha_residual</title>
<polygon fill="lightgreen" stroke="black" points="984,-7936.33 510,-7936.33 510,-7868.33 984,-7868.33 984,-7936.33"/>
<text text-anchor="middle" x="747" y="-7921.13" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="747" y="-7906.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096] (x2)</text>
<text text-anchor="middle" x="747" y="-7891.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="747" y="-7876.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- input&#45;&gt;l0_mha_residual -->
<g id="edge6" class="edge">
<title>input&#45;&gt;l0_mha_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1188.63,-8716.68C1188.63,-8576.94 1188.63,-7902 1188.63,-7902 1188.63,-7902 994.3,-7902 994.3,-7902"/>
<polygon fill="black" stroke="black" points="994.3,-7898.5 984.3,-7902 994.3,-7905.5 994.3,-7898.5"/>
</g>
<!-- l0_mha_qkv_split -->
<g id="node3" class="node">
<title>l0_mha_qkv_split</title>
<polygon fill="lightgreen" stroke="black" points="968,-8424.33 406,-8424.33 406,-8356.33 968,-8356.33 968,-8424.33"/>
<text text-anchor="middle" x="687" y="-8409.13" font-family="Helvetica,sans-Serif" font-size="14.00">MHA QKV Linear Split</text>
<text text-anchor="middle" x="687" y="-8394.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="687" y="-8379.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=4, head_dim=128]×8</text>
<text text-anchor="middle" x="687" y="-8364.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_input_split&#45;&gt;l0_mha_qkv_split -->
<g id="edge2" class="edge">
<title>l0_input_split&#45;&gt;l0_mha_qkv_split</title>
<path fill="none" stroke="black" d="M687,-8496.06C687,-8496.06 687,-8434.44 687,-8434.44"/>
<polygon fill="black" stroke="black" points="690.5,-8434.44 687,-8424.44 683.5,-8434.44 690.5,-8434.44"/>
</g>
<!-- l0_mha_attn -->
<g id="node4" class="node">
<title>l0_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="954.5,-8284.33 425.5,-8284.33 425.5,-8216.33 954.5,-8216.33 954.5,-8284.33"/>
<text text-anchor="middle" x="690" y="-8269.13" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="690" y="-8254.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=4, head_dim=128]</text>
<text text-anchor="middle" x="690" y="-8239.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="690" y="-8224.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_mha_qkv_split&#45;&gt;l0_mha_attn -->
<g id="edge3" class="edge">
<title>l0_mha_qkv_split&#45;&gt;l0_mha_attn</title>
<path fill="none" stroke="black" d="M690,-8356.09C690,-8356.09 690,-8294.71 690,-8294.71"/>
<polygon fill="black" stroke="black" points="693.5,-8294.71 690,-8284.71 686.5,-8294.71 693.5,-8294.71"/>
</g>
<!-- l0_mha_allreduce -->
<g id="node5" class="node">
<title>l0_mha_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="1166.87,-8144.33 417.82,-8144.33 225.13,-8008.33 974.18,-8008.33 1166.87,-8144.33"/>
<text text-anchor="middle" x="696" y="-8095.13" font-family="Helvetica,sans-Serif" font-size="14.00">MHA All&#45;Reduce</text>
<text text-anchor="middle" x="696" y="-8080.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="696" y="-8065.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="696" y="-8050.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_mha_attn&#45;&gt;l0_mha_allreduce -->
<g id="edge4" class="edge">
<title>l0_mha_attn&#45;&gt;l0_mha_allreduce</title>
<path fill="none" stroke="black" d="M690,-8215.96C690,-8215.96 690,-8154.47 690,-8154.47"/>
<polygon fill="black" stroke="black" points="693.5,-8154.47 690,-8144.47 686.5,-8154.47 693.5,-8154.47"/>
</g>
<!-- l0_mha_allreduce&#45;&gt;l0_mha_residual -->
<g id="edge5" class="edge">
<title>l0_mha_allreduce&#45;&gt;l0_mha_residual</title>
<path fill="none" stroke="black" d="M747,-8008.06C747,-8008.06 747,-7946.44 747,-7946.44"/>
<polygon fill="black" stroke="black" points="750.5,-7946.44 747,-7936.44 743.5,-7946.44 750.5,-7946.44"/>
</g>
<!-- l0_mha_layernorm -->
<g id="node7" class="node">
<title>l0_mha_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="974,-7796.33 520,-7796.33 520,-7728.33 974,-7728.33 974,-7796.33"/>
<text text-anchor="middle" x="747" y="-7781.13" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="747" y="-7766.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="747" y="-7751.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="747" y="-7736.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l0_mha_residual&#45;&gt;l0_mha_layernorm -->
<g id="edge7" class="edge">
<title>l0_mha_residual&#45;&gt;l0_mha_layernorm</title>
<path fill="none" stroke="black" d="M747,-7868.09C747,-7868.09 747,-7806.71 747,-7806.71"/>
<polygon fill="black" stroke="black" points="750.5,-7806.71 747,-7796.71 743.5,-7806.71 750.5,-7806.71"/>
</g>
<!-- l0_ffn_input_split -->
<g id="node8" class="node">
<title>l0_ffn_input_split</title>
<polygon fill="lightyellow" stroke="black" points="1208.25,-7656.33 439.51,-7656.33 241.75,-7520.33 1010.49,-7520.33 1208.25,-7656.33"/>
<text text-anchor="middle" x="725" y="-7607.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Input Split</text>
<text text-anchor="middle" x="725" y="-7592.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="725" y="-7577.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="725" y="-7562.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_mha_layernorm&#45;&gt;l0_ffn_input_split -->
<g id="edge8" class="edge">
<title>l0_mha_layernorm&#45;&gt;l0_ffn_input_split</title>
<path fill="none" stroke="black" d="M747,-7727.96C747,-7727.96 747,-7666.47 747,-7666.47"/>
<polygon fill="black" stroke="black" points="750.5,-7666.47 747,-7656.47 743.5,-7666.47 750.5,-7666.47"/>
</g>
<!-- l0_ffn_residual -->
<g id="node14" class="node">
<title>l0_ffn_residual</title>
<polygon fill="lightgreen" stroke="black" points="1110,-6820.33 636,-6820.33 636,-6752.33 1110,-6752.33 1110,-6820.33"/>
<text text-anchor="middle" x="873" y="-6805.13" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="873" y="-6790.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096] (x2)</text>
<text text-anchor="middle" x="873" y="-6775.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="873" y="-6760.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l0_mha_layernorm&#45;&gt;l0_ffn_residual -->
<g id="edge16" class="edge">
<title>l0_mha_layernorm&#45;&gt;l0_ffn_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M974.2,-7762C1096.98,-7762 1223.73,-7762 1223.73,-7762 1223.73,-7762 1223.73,-6786 1223.73,-6786 1223.73,-6786 1120.34,-6786 1120.34,-6786"/>
<polygon fill="black" stroke="black" points="1120.34,-6782.5 1110.34,-6786 1120.34,-6789.5 1120.34,-6782.5"/>
</g>
<!-- l0_ffn_up -->
<g id="node9" class="node">
<title>l0_ffn_up</title>
<polygon fill="lightgreen" stroke="black" points="664,-7448.33 156,-7448.33 156,-7380.33 664,-7380.33 664,-7448.33"/>
<text text-anchor="middle" x="410" y="-7433.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="410" y="-7418.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="410" y="-7403.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=2048]×8</text>
<text text-anchor="middle" x="410" y="-7388.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_ffn_input_split&#45;&gt;l0_ffn_up -->
<g id="edge9" class="edge">
<title>l0_ffn_input_split&#45;&gt;l0_ffn_up</title>
<path fill="none" stroke="black" d="M452.94,-7520.06C452.94,-7520.06 452.94,-7458.44 452.94,-7458.44"/>
<polygon fill="black" stroke="black" points="456.44,-7458.44 452.94,-7448.44 449.44,-7458.44 456.44,-7458.44"/>
</g>
<!-- l0_ffn_gate -->
<g id="node10" class="node">
<title>l0_ffn_gate</title>
<polygon fill="lightgreen" stroke="black" points="1208,-7448.33 700,-7448.33 700,-7380.33 1208,-7380.33 1208,-7448.33"/>
<text text-anchor="middle" x="954" y="-7433.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="954" y="-7418.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="954" y="-7403.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=2048]×8</text>
<text text-anchor="middle" x="954" y="-7388.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_ffn_input_split&#45;&gt;l0_ffn_gate -->
<g id="edge10" class="edge">
<title>l0_ffn_input_split&#45;&gt;l0_ffn_gate</title>
<path fill="none" stroke="black" d="M954,-7520.06C954,-7520.06 954,-7458.44 954,-7458.44"/>
<polygon fill="black" stroke="black" points="957.5,-7458.44 954,-7448.44 950.5,-7458.44 957.5,-7458.44"/>
</g>
<!-- l0_ffn_act -->
<g id="node11" class="node">
<title>l0_ffn_act</title>
<polygon fill="lightgreen" stroke="black" points="991,-7308.33 483,-7308.33 483,-7240.33 991,-7240.33 991,-7308.33"/>
<text text-anchor="middle" x="737" y="-7293.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="737" y="-7278.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=2048]</text>
<text text-anchor="middle" x="737" y="-7263.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=2048]×8</text>
<text text-anchor="middle" x="737" y="-7248.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_ffn_up&#45;&gt;l0_ffn_act -->
<g id="edge11" class="edge">
<title>l0_ffn_up&#45;&gt;l0_ffn_act</title>
<path fill="none" stroke="black" d="M573.5,-7380.09C573.5,-7380.09 573.5,-7318.71 573.5,-7318.71"/>
<polygon fill="black" stroke="black" points="577,-7318.71 573.5,-7308.71 570,-7318.71 577,-7318.71"/>
</g>
<!-- l0_ffn_gate&#45;&gt;l0_ffn_act -->
<g id="edge12" class="edge">
<title>l0_ffn_gate&#45;&gt;l0_ffn_act</title>
<path fill="none" stroke="black" d="M845.5,-7380.09C845.5,-7380.09 845.5,-7318.71 845.5,-7318.71"/>
<polygon fill="black" stroke="black" points="849,-7318.71 845.5,-7308.71 842,-7318.71 849,-7318.71"/>
</g>
<!-- l0_ffn_down -->
<g id="node12" class="node">
<title>l0_ffn_down</title>
<polygon fill="lightgreen" stroke="black" points="974.5,-7168.33 499.5,-7168.33 499.5,-7100.33 974.5,-7100.33 974.5,-7168.33"/>
<text text-anchor="middle" x="737" y="-7153.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="737" y="-7138.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=2048]</text>
<text text-anchor="middle" x="737" y="-7123.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="737" y="-7108.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_ffn_act&#45;&gt;l0_ffn_down -->
<g id="edge13" class="edge">
<title>l0_ffn_act&#45;&gt;l0_ffn_down</title>
<path fill="none" stroke="black" d="M737,-7240.09C737,-7240.09 737,-7178.71 737,-7178.71"/>
<polygon fill="black" stroke="black" points="740.5,-7178.71 737,-7168.71 733.5,-7178.71 740.5,-7178.71"/>
</g>
<!-- l0_ffn_allreduce -->
<g id="node13" class="node">
<title>l0_ffn_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="1207.87,-7028.33 458.82,-7028.33 266.13,-6892.33 1015.18,-6892.33 1207.87,-7028.33"/>
<text text-anchor="middle" x="737" y="-6979.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="737" y="-6964.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="737" y="-6949.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="737" y="-6934.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_ffn_down&#45;&gt;l0_ffn_allreduce -->
<g id="edge14" class="edge">
<title>l0_ffn_down&#45;&gt;l0_ffn_allreduce</title>
<path fill="none" stroke="black" d="M737,-7099.96C737,-7099.96 737,-7038.47 737,-7038.47"/>
<polygon fill="black" stroke="black" points="740.5,-7038.47 737,-7028.47 733.5,-7038.47 740.5,-7038.47"/>
</g>
<!-- l0_ffn_allreduce&#45;&gt;l0_ffn_residual -->
<g id="edge15" class="edge">
<title>l0_ffn_allreduce&#45;&gt;l0_ffn_residual</title>
<path fill="none" stroke="black" d="M873,-6892.06C873,-6892.06 873,-6830.44 873,-6830.44"/>
<polygon fill="black" stroke="black" points="876.5,-6830.44 873,-6820.44 869.5,-6830.44 876.5,-6830.44"/>
</g>
<!-- l0_layernorm -->
<g id="node15" class="node">
<title>l0_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="1100,-6680.33 646,-6680.33 646,-6612.33 1100,-6612.33 1100,-6680.33"/>
<text text-anchor="middle" x="873" y="-6665.13" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="873" y="-6650.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="873" y="-6635.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="873" y="-6620.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l0_ffn_residual&#45;&gt;l0_layernorm -->
<g id="edge17" class="edge">
<title>l0_ffn_residual&#45;&gt;l0_layernorm</title>
<path fill="none" stroke="black" d="M873,-6752.09C873,-6752.09 873,-6690.71 873,-6690.71"/>
<polygon fill="black" stroke="black" points="876.5,-6690.71 873,-6680.71 869.5,-6690.71 876.5,-6690.71"/>
</g>
<!-- l1_input_split -->
<g id="node16" class="node">
<title>l1_input_split</title>
<polygon fill="lightyellow" stroke="black" points="1209.25,-6540.33 440.51,-6540.33 242.75,-6404.33 1011.49,-6404.33 1209.25,-6540.33"/>
<text text-anchor="middle" x="726" y="-6491.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="726" y="-6476.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="726" y="-6461.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="726" y="-6446.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l0_layernorm&#45;&gt;l1_input_split -->
<g id="edge18" class="edge">
<title>l0_layernorm&#45;&gt;l1_input_split</title>
<path fill="none" stroke="black" d="M873,-6611.96C873,-6611.96 873,-6550.47 873,-6550.47"/>
<polygon fill="black" stroke="black" points="876.5,-6550.47 873,-6540.47 869.5,-6550.47 876.5,-6550.47"/>
</g>
<!-- l1_mha_residual -->
<g id="node20" class="node">
<title>l1_mha_residual</title>
<polygon fill="lightgreen" stroke="black" points="1111,-5844.33 637,-5844.33 637,-5776.33 1111,-5776.33 1111,-5844.33"/>
<text text-anchor="middle" x="874" y="-5829.13" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="874" y="-5814.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096] (x2)</text>
<text text-anchor="middle" x="874" y="-5799.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="874" y="-5784.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l0_layernorm&#45;&gt;l1_mha_residual -->
<g id="edge23" class="edge">
<title>l0_layernorm&#45;&gt;l1_mha_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1100.04,-6646C1181.19,-6646 1252.94,-6646 1252.94,-6646 1252.94,-6646 1252.94,-5810 1252.94,-5810 1252.94,-5810 1121.03,-5810 1121.03,-5810"/>
<polygon fill="black" stroke="black" points="1121.03,-5806.5 1111.03,-5810 1121.03,-5813.5 1121.03,-5806.5"/>
</g>
<!-- l1_mha_qkv_split -->
<g id="node17" class="node">
<title>l1_mha_qkv_split</title>
<polygon fill="lightgreen" stroke="black" points="1008,-6332.33 446,-6332.33 446,-6264.33 1008,-6264.33 1008,-6332.33"/>
<text text-anchor="middle" x="727" y="-6317.13" font-family="Helvetica,sans-Serif" font-size="14.00">MHA QKV Linear Split</text>
<text text-anchor="middle" x="727" y="-6302.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="727" y="-6287.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=4, head_dim=128]×8</text>
<text text-anchor="middle" x="727" y="-6272.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_input_split&#45;&gt;l1_mha_qkv_split -->
<g id="edge19" class="edge">
<title>l1_input_split&#45;&gt;l1_mha_qkv_split</title>
<path fill="none" stroke="black" d="M727,-6404.06C727,-6404.06 727,-6342.44 727,-6342.44"/>
<polygon fill="black" stroke="black" points="730.5,-6342.44 727,-6332.44 723.5,-6342.44 730.5,-6342.44"/>
</g>
<!-- l1_mha_attn -->
<g id="node18" class="node">
<title>l1_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="994.5,-6192.33 465.5,-6192.33 465.5,-6124.33 994.5,-6124.33 994.5,-6192.33"/>
<text text-anchor="middle" x="730" y="-6177.13" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="730" y="-6162.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=4, head_dim=128]</text>
<text text-anchor="middle" x="730" y="-6147.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="730" y="-6132.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_mha_qkv_split&#45;&gt;l1_mha_attn -->
<g id="edge20" class="edge">
<title>l1_mha_qkv_split&#45;&gt;l1_mha_attn</title>
<path fill="none" stroke="black" d="M730,-6264.09C730,-6264.09 730,-6202.71 730,-6202.71"/>
<polygon fill="black" stroke="black" points="733.5,-6202.71 730,-6192.71 726.5,-6202.71 733.5,-6202.71"/>
</g>
<!-- l1_mha_allreduce -->
<g id="node19" class="node">
<title>l1_mha_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="1206.87,-6052.33 457.82,-6052.33 265.13,-5916.33 1014.18,-5916.33 1206.87,-6052.33"/>
<text text-anchor="middle" x="736" y="-6003.13" font-family="Helvetica,sans-Serif" font-size="14.00">MHA All&#45;Reduce</text>
<text text-anchor="middle" x="736" y="-5988.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="736" y="-5973.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="736" y="-5958.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_mha_attn&#45;&gt;l1_mha_allreduce -->
<g id="edge21" class="edge">
<title>l1_mha_attn&#45;&gt;l1_mha_allreduce</title>
<path fill="none" stroke="black" d="M730,-6123.96C730,-6123.96 730,-6062.47 730,-6062.47"/>
<polygon fill="black" stroke="black" points="733.5,-6062.47 730,-6052.47 726.5,-6062.47 733.5,-6062.47"/>
</g>
<!-- l1_mha_allreduce&#45;&gt;l1_mha_residual -->
<g id="edge22" class="edge">
<title>l1_mha_allreduce&#45;&gt;l1_mha_residual</title>
<path fill="none" stroke="black" d="M874,-5916.06C874,-5916.06 874,-5854.44 874,-5854.44"/>
<polygon fill="black" stroke="black" points="877.5,-5854.44 874,-5844.44 870.5,-5854.44 877.5,-5854.44"/>
</g>
<!-- l1_mha_layernorm -->
<g id="node21" class="node">
<title>l1_mha_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="1101,-5704.33 647,-5704.33 647,-5636.33 1101,-5636.33 1101,-5704.33"/>
<text text-anchor="middle" x="874" y="-5689.13" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="874" y="-5674.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="874" y="-5659.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="874" y="-5644.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l1_mha_residual&#45;&gt;l1_mha_layernorm -->
<g id="edge24" class="edge">
<title>l1_mha_residual&#45;&gt;l1_mha_layernorm</title>
<path fill="none" stroke="black" d="M874,-5776.09C874,-5776.09 874,-5714.71 874,-5714.71"/>
<polygon fill="black" stroke="black" points="877.5,-5714.71 874,-5704.71 870.5,-5714.71 877.5,-5714.71"/>
</g>
<!-- l1_ffn_input_split -->
<g id="node22" class="node">
<title>l1_ffn_input_split</title>
<polygon fill="lightyellow" stroke="black" points="1208.25,-5564.33 439.51,-5564.33 241.75,-5428.33 1010.49,-5428.33 1208.25,-5564.33"/>
<text text-anchor="middle" x="725" y="-5515.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Input Split</text>
<text text-anchor="middle" x="725" y="-5500.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="725" y="-5485.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="725" y="-5470.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_mha_layernorm&#45;&gt;l1_ffn_input_split -->
<g id="edge25" class="edge">
<title>l1_mha_layernorm&#45;&gt;l1_ffn_input_split</title>
<path fill="none" stroke="black" d="M874,-5635.96C874,-5635.96 874,-5574.47 874,-5574.47"/>
<polygon fill="black" stroke="black" points="877.5,-5574.47 874,-5564.47 870.5,-5574.47 877.5,-5574.47"/>
</g>
<!-- l1_ffn_residual -->
<g id="node28" class="node">
<title>l1_ffn_residual</title>
<polygon fill="lightgreen" stroke="black" points="1110,-4728.33 636,-4728.33 636,-4660.33 1110,-4660.33 1110,-4728.33"/>
<text text-anchor="middle" x="873" y="-4713.13" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="873" y="-4698.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096] (x2)</text>
<text text-anchor="middle" x="873" y="-4683.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="873" y="-4668.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l1_mha_layernorm&#45;&gt;l1_ffn_residual -->
<g id="edge33" class="edge">
<title>l1_mha_layernorm&#45;&gt;l1_ffn_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1101.11,-5670C1174.98,-5670 1238.33,-5670 1238.33,-5670 1238.33,-5670 1238.33,-4694 1238.33,-4694 1238.33,-4694 1120.04,-4694 1120.04,-4694"/>
<polygon fill="black" stroke="black" points="1120.04,-4690.5 1110.04,-4694 1120.04,-4697.5 1120.04,-4690.5"/>
</g>
<!-- l1_ffn_up -->
<g id="node23" class="node">
<title>l1_ffn_up</title>
<polygon fill="lightgreen" stroke="black" points="664,-5356.33 156,-5356.33 156,-5288.33 664,-5288.33 664,-5356.33"/>
<text text-anchor="middle" x="410" y="-5341.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="410" y="-5326.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="410" y="-5311.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=2048]×8</text>
<text text-anchor="middle" x="410" y="-5296.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_ffn_input_split&#45;&gt;l1_ffn_up -->
<g id="edge26" class="edge">
<title>l1_ffn_input_split&#45;&gt;l1_ffn_up</title>
<path fill="none" stroke="black" d="M452.94,-5428.06C452.94,-5428.06 452.94,-5366.44 452.94,-5366.44"/>
<polygon fill="black" stroke="black" points="456.44,-5366.44 452.94,-5356.44 449.44,-5366.44 456.44,-5366.44"/>
</g>
<!-- l1_ffn_gate -->
<g id="node24" class="node">
<title>l1_ffn_gate</title>
<polygon fill="lightgreen" stroke="black" points="1208,-5356.33 700,-5356.33 700,-5288.33 1208,-5288.33 1208,-5356.33"/>
<text text-anchor="middle" x="954" y="-5341.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="954" y="-5326.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="954" y="-5311.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=2048]×8</text>
<text text-anchor="middle" x="954" y="-5296.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_ffn_input_split&#45;&gt;l1_ffn_gate -->
<g id="edge27" class="edge">
<title>l1_ffn_input_split&#45;&gt;l1_ffn_gate</title>
<path fill="none" stroke="black" d="M954,-5428.06C954,-5428.06 954,-5366.44 954,-5366.44"/>
<polygon fill="black" stroke="black" points="957.5,-5366.44 954,-5356.44 950.5,-5366.44 957.5,-5366.44"/>
</g>
<!-- l1_ffn_act -->
<g id="node25" class="node">
<title>l1_ffn_act</title>
<polygon fill="lightgreen" stroke="black" points="991,-5216.33 483,-5216.33 483,-5148.33 991,-5148.33 991,-5216.33"/>
<text text-anchor="middle" x="737" y="-5201.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="737" y="-5186.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=2048]</text>
<text text-anchor="middle" x="737" y="-5171.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=2048]×8</text>
<text text-anchor="middle" x="737" y="-5156.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_ffn_up&#45;&gt;l1_ffn_act -->
<g id="edge28" class="edge">
<title>l1_ffn_up&#45;&gt;l1_ffn_act</title>
<path fill="none" stroke="black" d="M573.5,-5288.09C573.5,-5288.09 573.5,-5226.71 573.5,-5226.71"/>
<polygon fill="black" stroke="black" points="577,-5226.71 573.5,-5216.71 570,-5226.71 577,-5226.71"/>
</g>
<!-- l1_ffn_gate&#45;&gt;l1_ffn_act -->
<g id="edge29" class="edge">
<title>l1_ffn_gate&#45;&gt;l1_ffn_act</title>
<path fill="none" stroke="black" d="M845.5,-5288.09C845.5,-5288.09 845.5,-5226.71 845.5,-5226.71"/>
<polygon fill="black" stroke="black" points="849,-5226.71 845.5,-5216.71 842,-5226.71 849,-5226.71"/>
</g>
<!-- l1_ffn_down -->
<g id="node26" class="node">
<title>l1_ffn_down</title>
<polygon fill="lightgreen" stroke="black" points="974.5,-5076.33 499.5,-5076.33 499.5,-5008.33 974.5,-5008.33 974.5,-5076.33"/>
<text text-anchor="middle" x="737" y="-5061.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="737" y="-5046.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=2048]</text>
<text text-anchor="middle" x="737" y="-5031.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="737" y="-5016.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_ffn_act&#45;&gt;l1_ffn_down -->
<g id="edge30" class="edge">
<title>l1_ffn_act&#45;&gt;l1_ffn_down</title>
<path fill="none" stroke="black" d="M737,-5148.09C737,-5148.09 737,-5086.71 737,-5086.71"/>
<polygon fill="black" stroke="black" points="740.5,-5086.71 737,-5076.71 733.5,-5086.71 740.5,-5086.71"/>
</g>
<!-- l1_ffn_allreduce -->
<g id="node27" class="node">
<title>l1_ffn_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="1207.87,-4936.33 458.82,-4936.33 266.13,-4800.33 1015.18,-4800.33 1207.87,-4936.33"/>
<text text-anchor="middle" x="737" y="-4887.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="737" y="-4872.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="737" y="-4857.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="737" y="-4842.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- l1_ffn_down&#45;&gt;l1_ffn_allreduce -->
<g id="edge31" class="edge">
<title>l1_ffn_down&#45;&gt;l1_ffn_allreduce</title>
<path fill="none" stroke="black" d="M737,-5007.96C737,-5007.96 737,-4946.47 737,-4946.47"/>
<polygon fill="black" stroke="black" points="740.5,-4946.47 737,-4936.47 733.5,-4946.47 740.5,-4946.47"/>
</g>
<!-- l1_ffn_allreduce&#45;&gt;l1_ffn_residual -->
<g id="edge32" class="edge">
<title>l1_ffn_allreduce&#45;&gt;l1_ffn_residual</title>
<path fill="none" stroke="black" d="M873,-4800.06C873,-4800.06 873,-4738.44 873,-4738.44"/>
<polygon fill="black" stroke="black" points="876.5,-4738.44 873,-4728.44 869.5,-4738.44 876.5,-4738.44"/>
</g>
<!-- l1_layernorm -->
<g id="node29" class="node">
<title>l1_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="1100,-4588.33 646,-4588.33 646,-4520.33 1100,-4520.33 1100,-4588.33"/>
<text text-anchor="middle" x="873" y="-4573.13" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="873" y="-4558.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="873" y="-4543.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="873" y="-4528.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l1_ffn_residual&#45;&gt;l1_layernorm -->
<g id="edge34" class="edge">
<title>l1_ffn_residual&#45;&gt;l1_layernorm</title>
<path fill="none" stroke="black" d="M873,-4660.09C873,-4660.09 873,-4598.71 873,-4598.71"/>
<polygon fill="black" stroke="black" points="876.5,-4598.71 873,-4588.71 869.5,-4598.71 876.5,-4598.71"/>
</g>
<!-- stage0_to_stage1 -->
<g id="node30" class="node">
<title>stage0_to_stage1</title>
<ellipse fill="orange" stroke="black" cx="873" cy="-4400.25" rx="321.05" ry="48.17"/>
<text text-anchor="middle" x="873" y="-4419.05" font-family="Helvetica,sans-Serif" font-size="14.00">Pipeline Send</text>
<text text-anchor="middle" x="873" y="-4404.05" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="873" y="-4389.05" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="873" y="-4374.05" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- l1_layernorm&#45;&gt;stage0_to_stage1 -->
<g id="edge35" class="edge">
<title>l1_layernorm&#45;&gt;stage0_to_stage1</title>
<path fill="none" stroke="black" d="M873,-4520.14C873,-4520.14 873,-4458.38 873,-4458.38"/>
<polygon fill="black" stroke="black" points="876.5,-4458.38 873,-4448.38 869.5,-4458.38 876.5,-4458.38"/>
</g>
<!-- l2_input_split -->
<g id="node31" class="node">
<title>l2_input_split</title>
<polygon fill="lightyellow" stroke="black" points="1037.25,-4280.17 268.51,-4280.17 70.75,-4144.17 839.49,-4144.17 1037.25,-4280.17"/>
<text text-anchor="middle" x="554" y="-4230.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="554" y="-4215.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="554" y="-4200.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="554" y="-4185.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- stage0_to_stage1&#45;&gt;l2_input_split -->
<g id="edge36" class="edge">
<title>stage0_to_stage1&#45;&gt;l2_input_split</title>
<path fill="none" stroke="black" d="M794.55,-4353.27C794.55,-4353.27 794.55,-4290.18 794.55,-4290.18"/>
<polygon fill="black" stroke="black" points="798.05,-4290.18 794.55,-4280.18 791.05,-4290.18 798.05,-4290.18"/>
</g>
<!-- l2_mha_residual -->
<g id="node35" class="node">
<title>l2_mha_residual</title>
<polygon fill="lightgreen" stroke="black" points="852,-3584.17 378,-3584.17 378,-3516.17 852,-3516.17 852,-3584.17"/>
<text text-anchor="middle" x="615" y="-3568.97" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="615" y="-3553.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096] (x2)</text>
<text text-anchor="middle" x="615" y="-3538.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="615" y="-3523.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- stage0_to_stage1&#45;&gt;l2_mha_residual -->
<g id="edge41" class="edge">
<title>stage0_to_stage1&#45;&gt;l2_mha_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1056.63,-4360.66C1056.63,-4193.01 1056.63,-3550 1056.63,-3550 1056.63,-3550 862.3,-3550 862.3,-3550"/>
<polygon fill="black" stroke="black" points="862.3,-3546.5 852.3,-3550 862.3,-3553.5 862.3,-3546.5"/>
</g>
<!-- l2_mha_qkv_split -->
<g id="node32" class="node">
<title>l2_mha_qkv_split</title>
<polygon fill="lightgreen" stroke="black" points="836,-4072.17 274,-4072.17 274,-4004.17 836,-4004.17 836,-4072.17"/>
<text text-anchor="middle" x="555" y="-4056.97" font-family="Helvetica,sans-Serif" font-size="14.00">MHA QKV Linear Split</text>
<text text-anchor="middle" x="555" y="-4041.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="555" y="-4026.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=4, head_dim=128]×8</text>
<text text-anchor="middle" x="555" y="-4011.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_input_split&#45;&gt;l2_mha_qkv_split -->
<g id="edge37" class="edge">
<title>l2_input_split&#45;&gt;l2_mha_qkv_split</title>
<path fill="none" stroke="black" d="M555,-4143.9C555,-4143.9 555,-4082.28 555,-4082.28"/>
<polygon fill="black" stroke="black" points="558.5,-4082.28 555,-4072.28 551.5,-4082.28 558.5,-4082.28"/>
</g>
<!-- l2_mha_attn -->
<g id="node33" class="node">
<title>l2_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="822.5,-3932.17 293.5,-3932.17 293.5,-3864.17 822.5,-3864.17 822.5,-3932.17"/>
<text text-anchor="middle" x="558" y="-3916.97" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="558" y="-3901.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=4, head_dim=128]</text>
<text text-anchor="middle" x="558" y="-3886.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="558" y="-3871.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_mha_qkv_split&#45;&gt;l2_mha_attn -->
<g id="edge38" class="edge">
<title>l2_mha_qkv_split&#45;&gt;l2_mha_attn</title>
<path fill="none" stroke="black" d="M558,-4003.92C558,-4003.92 558,-3942.55 558,-3942.55"/>
<polygon fill="black" stroke="black" points="561.5,-3942.55 558,-3932.55 554.5,-3942.55 561.5,-3942.55"/>
</g>
<!-- l2_mha_allreduce -->
<g id="node34" class="node">
<title>l2_mha_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="1034.87,-3792.17 285.82,-3792.17 93.13,-3656.17 842.18,-3656.17 1034.87,-3792.17"/>
<text text-anchor="middle" x="564" y="-3742.97" font-family="Helvetica,sans-Serif" font-size="14.00">MHA All&#45;Reduce</text>
<text text-anchor="middle" x="564" y="-3727.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="564" y="-3712.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="564" y="-3697.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_mha_attn&#45;&gt;l2_mha_allreduce -->
<g id="edge39" class="edge">
<title>l2_mha_attn&#45;&gt;l2_mha_allreduce</title>
<path fill="none" stroke="black" d="M558,-3863.79C558,-3863.79 558,-3802.31 558,-3802.31"/>
<polygon fill="black" stroke="black" points="561.5,-3802.31 558,-3792.31 554.5,-3802.31 561.5,-3802.31"/>
</g>
<!-- l2_mha_allreduce&#45;&gt;l2_mha_residual -->
<g id="edge40" class="edge">
<title>l2_mha_allreduce&#45;&gt;l2_mha_residual</title>
<path fill="none" stroke="black" d="M615,-3655.9C615,-3655.9 615,-3594.28 615,-3594.28"/>
<polygon fill="black" stroke="black" points="618.5,-3594.28 615,-3584.28 611.5,-3594.28 618.5,-3594.28"/>
</g>
<!-- l2_mha_layernorm -->
<g id="node36" class="node">
<title>l2_mha_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="842,-3444.17 388,-3444.17 388,-3376.17 842,-3376.17 842,-3444.17"/>
<text text-anchor="middle" x="615" y="-3428.97" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="615" y="-3413.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="615" y="-3398.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="615" y="-3383.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l2_mha_residual&#45;&gt;l2_mha_layernorm -->
<g id="edge42" class="edge">
<title>l2_mha_residual&#45;&gt;l2_mha_layernorm</title>
<path fill="none" stroke="black" d="M615,-3515.92C615,-3515.92 615,-3454.55 615,-3454.55"/>
<polygon fill="black" stroke="black" points="618.5,-3454.55 615,-3444.55 611.5,-3454.55 618.5,-3454.55"/>
</g>
<!-- l2_ffn_input_split -->
<g id="node37" class="node">
<title>l2_ffn_input_split</title>
<polygon fill="lightyellow" stroke="black" points="1076.25,-3304.17 307.51,-3304.17 109.75,-3168.17 878.49,-3168.17 1076.25,-3304.17"/>
<text text-anchor="middle" x="593" y="-3254.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Input Split</text>
<text text-anchor="middle" x="593" y="-3239.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="593" y="-3224.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="593" y="-3209.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_mha_layernorm&#45;&gt;l2_ffn_input_split -->
<g id="edge43" class="edge">
<title>l2_mha_layernorm&#45;&gt;l2_ffn_input_split</title>
<path fill="none" stroke="black" d="M615,-3375.79C615,-3375.79 615,-3314.31 615,-3314.31"/>
<polygon fill="black" stroke="black" points="618.5,-3314.31 615,-3304.31 611.5,-3314.31 618.5,-3314.31"/>
</g>
<!-- l2_ffn_residual -->
<g id="node43" class="node">
<title>l2_ffn_residual</title>
<polygon fill="lightgreen" stroke="black" points="978,-2468.17 504,-2468.17 504,-2400.17 978,-2400.17 978,-2468.17"/>
<text text-anchor="middle" x="741" y="-2452.97" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="741" y="-2437.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096] (x2)</text>
<text text-anchor="middle" x="741" y="-2422.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="741" y="-2407.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l2_mha_layernorm&#45;&gt;l2_ffn_residual -->
<g id="edge51" class="edge">
<title>l2_mha_layernorm&#45;&gt;l2_ffn_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M842.34,-3410C970.97,-3410 1106.35,-3410 1106.35,-3410 1106.35,-3410 1106.35,-2434 1106.35,-2434 1106.35,-2434 988.06,-2434 988.06,-2434"/>
<polygon fill="black" stroke="black" points="988.06,-2430.5 978.06,-2434 988.06,-2437.5 988.06,-2430.5"/>
</g>
<!-- l2_ffn_up -->
<g id="node38" class="node">
<title>l2_ffn_up</title>
<polygon fill="lightgreen" stroke="black" points="532,-3096.17 24,-3096.17 24,-3028.17 532,-3028.17 532,-3096.17"/>
<text text-anchor="middle" x="278" y="-3080.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="278" y="-3065.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="278" y="-3050.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=2048]×8</text>
<text text-anchor="middle" x="278" y="-3035.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_ffn_input_split&#45;&gt;l2_ffn_up -->
<g id="edge44" class="edge">
<title>l2_ffn_input_split&#45;&gt;l2_ffn_up</title>
<path fill="none" stroke="black" d="M320.94,-3167.9C320.94,-3167.9 320.94,-3106.28 320.94,-3106.28"/>
<polygon fill="black" stroke="black" points="324.44,-3106.28 320.94,-3096.28 317.44,-3106.28 324.44,-3106.28"/>
</g>
<!-- l2_ffn_gate -->
<g id="node39" class="node">
<title>l2_ffn_gate</title>
<polygon fill="lightgreen" stroke="black" points="1076,-3096.17 568,-3096.17 568,-3028.17 1076,-3028.17 1076,-3096.17"/>
<text text-anchor="middle" x="822" y="-3080.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="822" y="-3065.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="822" y="-3050.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=2048]×8</text>
<text text-anchor="middle" x="822" y="-3035.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_ffn_input_split&#45;&gt;l2_ffn_gate -->
<g id="edge45" class="edge">
<title>l2_ffn_input_split&#45;&gt;l2_ffn_gate</title>
<path fill="none" stroke="black" d="M822,-3167.9C822,-3167.9 822,-3106.28 822,-3106.28"/>
<polygon fill="black" stroke="black" points="825.5,-3106.28 822,-3096.28 818.5,-3106.28 825.5,-3106.28"/>
</g>
<!-- l2_ffn_act -->
<g id="node40" class="node">
<title>l2_ffn_act</title>
<polygon fill="lightgreen" stroke="black" points="859,-2956.17 351,-2956.17 351,-2888.17 859,-2888.17 859,-2956.17"/>
<text text-anchor="middle" x="605" y="-2940.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="605" y="-2925.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=2048]</text>
<text text-anchor="middle" x="605" y="-2910.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=2048]×8</text>
<text text-anchor="middle" x="605" y="-2895.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_ffn_up&#45;&gt;l2_ffn_act -->
<g id="edge46" class="edge">
<title>l2_ffn_up&#45;&gt;l2_ffn_act</title>
<path fill="none" stroke="black" d="M441.5,-3027.92C441.5,-3027.92 441.5,-2966.55 441.5,-2966.55"/>
<polygon fill="black" stroke="black" points="445,-2966.55 441.5,-2956.55 438,-2966.55 445,-2966.55"/>
</g>
<!-- l2_ffn_gate&#45;&gt;l2_ffn_act -->
<g id="edge47" class="edge">
<title>l2_ffn_gate&#45;&gt;l2_ffn_act</title>
<path fill="none" stroke="black" d="M713.5,-3027.92C713.5,-3027.92 713.5,-2966.55 713.5,-2966.55"/>
<polygon fill="black" stroke="black" points="717,-2966.55 713.5,-2956.55 710,-2966.55 717,-2966.55"/>
</g>
<!-- l2_ffn_down -->
<g id="node41" class="node">
<title>l2_ffn_down</title>
<polygon fill="lightgreen" stroke="black" points="842.5,-2816.17 367.5,-2816.17 367.5,-2748.17 842.5,-2748.17 842.5,-2816.17"/>
<text text-anchor="middle" x="605" y="-2800.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="605" y="-2785.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=2048]</text>
<text text-anchor="middle" x="605" y="-2770.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="605" y="-2755.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_ffn_act&#45;&gt;l2_ffn_down -->
<g id="edge48" class="edge">
<title>l2_ffn_act&#45;&gt;l2_ffn_down</title>
<path fill="none" stroke="black" d="M605,-2887.92C605,-2887.92 605,-2826.55 605,-2826.55"/>
<polygon fill="black" stroke="black" points="608.5,-2826.55 605,-2816.55 601.5,-2826.55 608.5,-2826.55"/>
</g>
<!-- l2_ffn_allreduce -->
<g id="node42" class="node">
<title>l2_ffn_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="1075.87,-2676.17 326.82,-2676.17 134.13,-2540.17 883.18,-2540.17 1075.87,-2676.17"/>
<text text-anchor="middle" x="605" y="-2626.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="605" y="-2611.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="605" y="-2596.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="605" y="-2581.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_ffn_down&#45;&gt;l2_ffn_allreduce -->
<g id="edge49" class="edge">
<title>l2_ffn_down&#45;&gt;l2_ffn_allreduce</title>
<path fill="none" stroke="black" d="M605,-2747.79C605,-2747.79 605,-2686.31 605,-2686.31"/>
<polygon fill="black" stroke="black" points="608.5,-2686.31 605,-2676.31 601.5,-2686.31 608.5,-2686.31"/>
</g>
<!-- l2_ffn_allreduce&#45;&gt;l2_ffn_residual -->
<g id="edge50" class="edge">
<title>l2_ffn_allreduce&#45;&gt;l2_ffn_residual</title>
<path fill="none" stroke="black" d="M741,-2539.9C741,-2539.9 741,-2478.28 741,-2478.28"/>
<polygon fill="black" stroke="black" points="744.5,-2478.28 741,-2468.28 737.5,-2478.28 744.5,-2478.28"/>
</g>
<!-- l2_layernorm -->
<g id="node44" class="node">
<title>l2_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="968,-2328.17 514,-2328.17 514,-2260.17 968,-2260.17 968,-2328.17"/>
<text text-anchor="middle" x="741" y="-2312.97" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="741" y="-2297.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="741" y="-2282.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="741" y="-2267.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l2_ffn_residual&#45;&gt;l2_layernorm -->
<g id="edge52" class="edge">
<title>l2_ffn_residual&#45;&gt;l2_layernorm</title>
<path fill="none" stroke="black" d="M741,-2399.92C741,-2399.92 741,-2338.55 741,-2338.55"/>
<polygon fill="black" stroke="black" points="744.5,-2338.55 741,-2328.55 737.5,-2338.55 744.5,-2338.55"/>
</g>
<!-- l3_input_split -->
<g id="node45" class="node">
<title>l3_input_split</title>
<polygon fill="lightyellow" stroke="black" points="1077.25,-2188.17 308.51,-2188.17 110.75,-2052.17 879.49,-2052.17 1077.25,-2188.17"/>
<text text-anchor="middle" x="594" y="-2138.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input Split</text>
<text text-anchor="middle" x="594" y="-2123.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="594" y="-2108.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="594" y="-2093.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l2_layernorm&#45;&gt;l3_input_split -->
<g id="edge53" class="edge">
<title>l2_layernorm&#45;&gt;l3_input_split</title>
<path fill="none" stroke="black" d="M741,-2259.79C741,-2259.79 741,-2198.31 741,-2198.31"/>
<polygon fill="black" stroke="black" points="744.5,-2198.31 741,-2188.31 737.5,-2198.31 744.5,-2198.31"/>
</g>
<!-- l3_mha_residual -->
<g id="node49" class="node">
<title>l3_mha_residual</title>
<polygon fill="lightgreen" stroke="black" points="979,-1492.17 505,-1492.17 505,-1424.17 979,-1424.17 979,-1492.17"/>
<text text-anchor="middle" x="742" y="-1476.97" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="742" y="-1461.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096] (x2)</text>
<text text-anchor="middle" x="742" y="-1446.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="742" y="-1431.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l2_layernorm&#45;&gt;l3_mha_residual -->
<g id="edge58" class="edge">
<title>l2_layernorm&#45;&gt;l3_mha_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M968.1,-2294C1068.75,-2294 1164.8,-2294 1164.8,-2294 1164.8,-2294 1164.8,-1458 1164.8,-1458 1164.8,-1458 989.05,-1458 989.05,-1458"/>
<polygon fill="black" stroke="black" points="989.05,-1454.5 979.05,-1458 989.05,-1461.5 989.05,-1454.5"/>
</g>
<!-- l3_mha_qkv_split -->
<g id="node46" class="node">
<title>l3_mha_qkv_split</title>
<polygon fill="lightgreen" stroke="black" points="876,-1980.17 314,-1980.17 314,-1912.17 876,-1912.17 876,-1980.17"/>
<text text-anchor="middle" x="595" y="-1964.97" font-family="Helvetica,sans-Serif" font-size="14.00">MHA QKV Linear Split</text>
<text text-anchor="middle" x="595" y="-1949.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="595" y="-1934.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=4, head_dim=128]×8</text>
<text text-anchor="middle" x="595" y="-1919.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_input_split&#45;&gt;l3_mha_qkv_split -->
<g id="edge54" class="edge">
<title>l3_input_split&#45;&gt;l3_mha_qkv_split</title>
<path fill="none" stroke="black" d="M595,-2051.9C595,-2051.9 595,-1990.28 595,-1990.28"/>
<polygon fill="black" stroke="black" points="598.5,-1990.28 595,-1980.28 591.5,-1990.28 598.5,-1990.28"/>
</g>
<!-- l3_mha_attn -->
<g id="node47" class="node">
<title>l3_mha_attn</title>
<polygon fill="lightgreen" stroke="black" points="862.5,-1840.17 333.5,-1840.17 333.5,-1772.17 862.5,-1772.17 862.5,-1840.17"/>
<text text-anchor="middle" x="598" y="-1824.97" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="598" y="-1809.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=4, head_dim=128]</text>
<text text-anchor="middle" x="598" y="-1794.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="598" y="-1779.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_mha_qkv_split&#45;&gt;l3_mha_attn -->
<g id="edge55" class="edge">
<title>l3_mha_qkv_split&#45;&gt;l3_mha_attn</title>
<path fill="none" stroke="black" d="M598,-1911.92C598,-1911.92 598,-1850.55 598,-1850.55"/>
<polygon fill="black" stroke="black" points="601.5,-1850.55 598,-1840.55 594.5,-1850.55 601.5,-1850.55"/>
</g>
<!-- l3_mha_allreduce -->
<g id="node48" class="node">
<title>l3_mha_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="1074.87,-1700.17 325.82,-1700.17 133.13,-1564.17 882.18,-1564.17 1074.87,-1700.17"/>
<text text-anchor="middle" x="604" y="-1650.97" font-family="Helvetica,sans-Serif" font-size="14.00">MHA All&#45;Reduce</text>
<text text-anchor="middle" x="604" y="-1635.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="604" y="-1620.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="604" y="-1605.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_mha_attn&#45;&gt;l3_mha_allreduce -->
<g id="edge56" class="edge">
<title>l3_mha_attn&#45;&gt;l3_mha_allreduce</title>
<path fill="none" stroke="black" d="M598,-1771.79C598,-1771.79 598,-1710.31 598,-1710.31"/>
<polygon fill="black" stroke="black" points="601.5,-1710.31 598,-1700.31 594.5,-1710.31 601.5,-1710.31"/>
</g>
<!-- l3_mha_allreduce&#45;&gt;l3_mha_residual -->
<g id="edge57" class="edge">
<title>l3_mha_allreduce&#45;&gt;l3_mha_residual</title>
<path fill="none" stroke="black" d="M742,-1563.9C742,-1563.9 742,-1502.28 742,-1502.28"/>
<polygon fill="black" stroke="black" points="745.5,-1502.28 742,-1492.28 738.5,-1502.28 745.5,-1502.28"/>
</g>
<!-- l3_mha_layernorm -->
<g id="node50" class="node">
<title>l3_mha_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="969,-1352.17 515,-1352.17 515,-1284.17 969,-1284.17 969,-1352.17"/>
<text text-anchor="middle" x="742" y="-1336.97" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="742" y="-1321.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="742" y="-1306.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="742" y="-1291.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l3_mha_residual&#45;&gt;l3_mha_layernorm -->
<g id="edge59" class="edge">
<title>l3_mha_residual&#45;&gt;l3_mha_layernorm</title>
<path fill="none" stroke="black" d="M742,-1423.92C742,-1423.92 742,-1362.55 742,-1362.55"/>
<polygon fill="black" stroke="black" points="745.5,-1362.55 742,-1352.55 738.5,-1362.55 745.5,-1362.55"/>
</g>
<!-- l3_ffn_input_split -->
<g id="node51" class="node">
<title>l3_ffn_input_split</title>
<polygon fill="lightyellow" stroke="black" points="1076.25,-1212.17 307.51,-1212.17 109.75,-1076.17 878.49,-1076.17 1076.25,-1212.17"/>
<text text-anchor="middle" x="593" y="-1162.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Input Split</text>
<text text-anchor="middle" x="593" y="-1147.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="593" y="-1132.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="593" y="-1117.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_mha_layernorm&#45;&gt;l3_ffn_input_split -->
<g id="edge60" class="edge">
<title>l3_mha_layernorm&#45;&gt;l3_ffn_input_split</title>
<path fill="none" stroke="black" d="M742,-1283.79C742,-1283.79 742,-1222.31 742,-1222.31"/>
<polygon fill="black" stroke="black" points="745.5,-1222.31 742,-1212.31 738.5,-1222.31 745.5,-1222.31"/>
</g>
<!-- l3_ffn_residual -->
<g id="node57" class="node">
<title>l3_ffn_residual</title>
<polygon fill="lightgreen" stroke="black" points="978,-376.17 504,-376.17 504,-308.17 978,-308.17 978,-376.17"/>
<text text-anchor="middle" x="741" y="-360.97" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="741" y="-345.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096] (x2)</text>
<text text-anchor="middle" x="741" y="-330.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="741" y="-315.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l3_mha_layernorm&#45;&gt;l3_ffn_residual -->
<g id="edge68" class="edge">
<title>l3_mha_layernorm&#45;&gt;l3_ffn_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M969.24,-1318C1056.5,-1318 1135.58,-1318 1135.58,-1318 1135.58,-1318 1135.58,-342 1135.58,-342 1135.58,-342 988.21,-342 988.21,-342"/>
<polygon fill="black" stroke="black" points="988.21,-338.5 978.21,-342 988.21,-345.5 988.21,-338.5"/>
</g>
<!-- l3_ffn_up -->
<g id="node52" class="node">
<title>l3_ffn_up</title>
<polygon fill="lightgreen" stroke="black" points="532,-1004.17 24,-1004.17 24,-936.17 532,-936.17 532,-1004.17"/>
<text text-anchor="middle" x="278" y="-988.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="278" y="-973.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="278" y="-958.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=2048]×8</text>
<text text-anchor="middle" x="278" y="-943.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_ffn_input_split&#45;&gt;l3_ffn_up -->
<g id="edge61" class="edge">
<title>l3_ffn_input_split&#45;&gt;l3_ffn_up</title>
<path fill="none" stroke="black" d="M320.94,-1075.9C320.94,-1075.9 320.94,-1014.28 320.94,-1014.28"/>
<polygon fill="black" stroke="black" points="324.44,-1014.28 320.94,-1004.28 317.44,-1014.28 324.44,-1014.28"/>
</g>
<!-- l3_ffn_gate -->
<g id="node53" class="node">
<title>l3_ffn_gate</title>
<polygon fill="lightgreen" stroke="black" points="1076,-1004.17 568,-1004.17 568,-936.17 1076,-936.17 1076,-1004.17"/>
<text text-anchor="middle" x="822" y="-988.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="822" y="-973.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="822" y="-958.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=2048]×8</text>
<text text-anchor="middle" x="822" y="-943.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_ffn_input_split&#45;&gt;l3_ffn_gate -->
<g id="edge62" class="edge">
<title>l3_ffn_input_split&#45;&gt;l3_ffn_gate</title>
<path fill="none" stroke="black" d="M822,-1075.9C822,-1075.9 822,-1014.28 822,-1014.28"/>
<polygon fill="black" stroke="black" points="825.5,-1014.28 822,-1004.28 818.5,-1014.28 825.5,-1014.28"/>
</g>
<!-- l3_ffn_act -->
<g id="node54" class="node">
<title>l3_ffn_act</title>
<polygon fill="lightgreen" stroke="black" points="859,-864.17 351,-864.17 351,-796.17 859,-796.17 859,-864.17"/>
<text text-anchor="middle" x="605" y="-848.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="605" y="-833.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=2048]</text>
<text text-anchor="middle" x="605" y="-818.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=2048]×8</text>
<text text-anchor="middle" x="605" y="-803.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_ffn_up&#45;&gt;l3_ffn_act -->
<g id="edge63" class="edge">
<title>l3_ffn_up&#45;&gt;l3_ffn_act</title>
<path fill="none" stroke="black" d="M441.5,-935.92C441.5,-935.92 441.5,-874.55 441.5,-874.55"/>
<polygon fill="black" stroke="black" points="445,-874.55 441.5,-864.55 438,-874.55 445,-874.55"/>
</g>
<!-- l3_ffn_gate&#45;&gt;l3_ffn_act -->
<g id="edge64" class="edge">
<title>l3_ffn_gate&#45;&gt;l3_ffn_act</title>
<path fill="none" stroke="black" d="M713.5,-935.92C713.5,-935.92 713.5,-874.55 713.5,-874.55"/>
<polygon fill="black" stroke="black" points="717,-874.55 713.5,-864.55 710,-874.55 717,-874.55"/>
</g>
<!-- l3_ffn_down -->
<g id="node55" class="node">
<title>l3_ffn_down</title>
<polygon fill="lightgreen" stroke="black" points="842.5,-724.17 367.5,-724.17 367.5,-656.17 842.5,-656.17 842.5,-724.17"/>
<text text-anchor="middle" x="605" y="-708.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="605" y="-693.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=2048]</text>
<text text-anchor="middle" x="605" y="-678.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="605" y="-663.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_ffn_act&#45;&gt;l3_ffn_down -->
<g id="edge65" class="edge">
<title>l3_ffn_act&#45;&gt;l3_ffn_down</title>
<path fill="none" stroke="black" d="M605,-795.92C605,-795.92 605,-734.55 605,-734.55"/>
<polygon fill="black" stroke="black" points="608.5,-734.55 605,-724.55 601.5,-734.55 608.5,-734.55"/>
</g>
<!-- l3_ffn_allreduce -->
<g id="node56" class="node">
<title>l3_ffn_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="1075.87,-584.17 326.82,-584.17 134.13,-448.17 883.18,-448.17 1075.87,-584.17"/>
<text text-anchor="middle" x="605" y="-534.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="605" y="-519.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]×8</text>
<text text-anchor="middle" x="605" y="-504.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="605" y="-489.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_ffn_down&#45;&gt;l3_ffn_allreduce -->
<g id="edge66" class="edge">
<title>l3_ffn_down&#45;&gt;l3_ffn_allreduce</title>
<path fill="none" stroke="black" d="M605,-655.79C605,-655.79 605,-594.31 605,-594.31"/>
<polygon fill="black" stroke="black" points="608.5,-594.31 605,-584.31 601.5,-594.31 608.5,-594.31"/>
</g>
<!-- l3_ffn_allreduce&#45;&gt;l3_ffn_residual -->
<g id="edge67" class="edge">
<title>l3_ffn_allreduce&#45;&gt;l3_ffn_residual</title>
<path fill="none" stroke="black" d="M741,-447.9C741,-447.9 741,-386.28 741,-386.28"/>
<polygon fill="black" stroke="black" points="744.5,-386.28 741,-376.28 737.5,-386.28 744.5,-386.28"/>
</g>
<!-- l3_layernorm -->
<g id="node58" class="node">
<title>l3_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="968,-236.17 514,-236.17 514,-168.17 968,-168.17 968,-236.17"/>
<text text-anchor="middle" x="741" y="-220.97" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="741" y="-205.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="741" y="-190.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="741" y="-175.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l3_ffn_residual&#45;&gt;l3_layernorm -->
<g id="edge69" class="edge">
<title>l3_ffn_residual&#45;&gt;l3_layernorm</title>
<path fill="none" stroke="black" d="M741,-307.92C741,-307.92 741,-246.55 741,-246.55"/>
<polygon fill="black" stroke="black" points="744.5,-246.55 741,-236.55 737.5,-246.55 744.5,-246.55"/>
</g>
<!-- output -->
<g id="node59" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="741" cy="-48.08" rx="321.05" ry="48.17"/>
<text text-anchor="middle" x="741" y="-66.88" font-family="Helvetica,sans-Serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="741" y="-51.88" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="741" y="-36.88" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="741" y="-21.88" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- l3_layernorm&#45;&gt;output -->
<g id="edge70" class="edge">
<title>l3_layernorm&#45;&gt;output</title>
<path fill="none" stroke="black" d="M741,-167.97C741,-167.97 741,-106.21 741,-106.21"/>
<polygon fill="black" stroke="black" points="744.5,-106.21 741,-96.21 737.5,-106.21 744.5,-106.21"/>
</g>
</g>
</svg>
