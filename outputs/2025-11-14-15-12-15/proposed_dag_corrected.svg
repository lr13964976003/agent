<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proposed_dag Pages: 1 -->
<svg width="6071pt" height="9956pt"
 viewBox="0.00 0.00 6071.00 9955.62" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 9951.62)">
<title>proposed_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-9951.62 6067,-9951.62 6067,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer0</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="8,-7564.67 8,-9831.67 4210,-9831.67 4210,-7564.67 8,-7564.67"/>
<text text-anchor="middle" x="2109" y="-9816.47" font-family="Times,serif" font-size="14.00">Layer 0 (GPUs 0&#45;3)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer1</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="971,-5096.5 971,-7363.5 5173,-7363.5 5173,-5096.5 971,-5096.5"/>
<text text-anchor="middle" x="3072" y="-7348.3" font-family="Times,serif" font-size="14.00">Layer 1 (GPUs 4&#45;7)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer2</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="1853,-2628.33 1853,-4895.33 6055,-4895.33 6055,-2628.33 1853,-2628.33"/>
<text text-anchor="middle" x="3954" y="-4880.13" font-family="Times,serif" font-size="14.00">Layer 2 (GPUs 8&#45;11)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer3</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="1551,-160.17 1551,-2427.17 5753,-2427.17 5753,-160.17 1551,-160.17"/>
<text text-anchor="middle" x="3652" y="-2411.97" font-family="Times,serif" font-size="14.00">Layer 3 (GPUs 12&#45;15)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="3157" cy="-9910.14" rx="312.58" ry="37.45"/>
<text text-anchor="middle" x="3157" y="-9921.44" font-family="Helvetica,sans-Serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="3157" y="-9906.44" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3157" y="-9891.44" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l0_input_broadcast -->
<g id="node2" class="node">
<title>l0_input_broadcast</title>
<polygon fill="lightyellow" stroke="black" points="3649.42,-9800.67 2866.09,-9800.67 2664.58,-9664.67 3447.91,-9664.67 3649.42,-9800.67"/>
<text text-anchor="middle" x="3157" y="-9751.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input Broadcast</text>
<text text-anchor="middle" x="3157" y="-9736.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3157" y="-9721.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]×4</text>
<text text-anchor="middle" x="3157" y="-9706.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;3</text>
</g>
<!-- input&#45;&gt;l0_input_broadcast -->
<g id="edge1" class="edge">
<title>input&#45;&gt;l0_input_broadcast</title>
<path fill="none" stroke="black" d="M3157,-9872.5C3157,-9872.5 3157,-9810.7 3157,-9810.7"/>
<polygon fill="black" stroke="black" points="3160.5,-9810.7 3157,-9800.7 3153.5,-9810.7 3160.5,-9810.7"/>
</g>
<!-- l0_mha_split -->
<g id="node3" class="node">
<title>l0_mha_split</title>
<polygon fill="lightyellow" stroke="black" points="3207.42,-9592.67 2424.09,-9592.67 2222.58,-9456.67 3005.91,-9456.67 3207.42,-9592.67"/>
<text text-anchor="middle" x="2715" y="-9543.47" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Input Split</text>
<text text-anchor="middle" x="2715" y="-9528.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2715" y="-9513.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="2715" y="-9498.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;3</text>
</g>
<!-- l0_input_broadcast&#45;&gt;l0_mha_split -->
<g id="edge2" class="edge">
<title>l0_input_broadcast&#45;&gt;l0_mha_split</title>
<path fill="none" stroke="black" d="M2936,-9664.56C2936,-9664.56 2936,-9602.93 2936,-9602.93"/>
<polygon fill="black" stroke="black" points="2939.5,-9602.93 2936,-9592.93 2932.5,-9602.93 2939.5,-9602.93"/>
</g>
<!-- l0_mha_residual -->
<g id="node13" class="node">
<title>l0_mha_residual</title>
<polygon fill="lightgreen" stroke="black" points="3395,-8896.67 2921,-8896.67 2921,-8828.67 3395,-8828.67 3395,-8896.67"/>
<text text-anchor="middle" x="3158" y="-8881.47" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3158" y="-8866.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096] (x2)</text>
<text text-anchor="middle" x="3158" y="-8851.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3158" y="-8836.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l0_input_broadcast&#45;&gt;l0_mha_residual -->
<g id="edge15" class="edge">
<title>l0_input_broadcast&#45;&gt;l0_mha_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3601.5,-9732.51C3601.5,-9719.12 3601.5,-8862 3601.5,-8862 3601.5,-8862 3405.01,-8862 3405.01,-8862"/>
<polygon fill="black" stroke="black" points="3405.01,-8858.5 3395.01,-8862 3405.01,-8865.5 3405.01,-8858.5"/>
</g>
<!-- l0_mha_qkv_0 -->
<g id="node4" class="node">
<title>l0_mha_qkv_0</title>
<polygon fill="lightgreen" stroke="black" points="3562.5,-9384.67 3021.5,-9384.67 3021.5,-9316.67 3562.5,-9316.67 3562.5,-9384.67"/>
<text text-anchor="middle" x="3292" y="-9369.47" font-family="Helvetica,sans-Serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="3292" y="-9354.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3292" y="-9339.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="3292" y="-9324.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_mha_split&#45;&gt;l0_mha_qkv_0 -->
<g id="edge3" class="edge">
<title>l0_mha_split&#45;&gt;l0_mha_qkv_0</title>
<path fill="none" stroke="black" d="M3114.48,-9524.54C3114.48,-9524.54 3114.48,-9394.91 3114.48,-9394.91"/>
<polygon fill="black" stroke="black" points="3117.98,-9394.91 3114.48,-9384.91 3110.98,-9394.91 3117.98,-9394.91"/>
</g>
<!-- l0_mha_qkv_1 -->
<g id="node5" class="node">
<title>l0_mha_qkv_1</title>
<polygon fill="lightgreen" stroke="black" points="1831.5,-9384.67 1290.5,-9384.67 1290.5,-9316.67 1831.5,-9316.67 1831.5,-9384.67"/>
<text text-anchor="middle" x="1561" y="-9369.47" font-family="Helvetica,sans-Serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="1561" y="-9354.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1561" y="-9339.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="1561" y="-9324.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_mha_split&#45;&gt;l0_mha_qkv_1 -->
<g id="edge4" class="edge">
<title>l0_mha_split&#45;&gt;l0_mha_qkv_1</title>
<path fill="none" stroke="black" d="M2322.3,-9524C1987.81,-9524 1561,-9524 1561,-9524 1561,-9524 1561,-9394.91 1561,-9394.91"/>
<polygon fill="black" stroke="black" points="1564.5,-9394.91 1561,-9384.91 1557.5,-9394.91 1564.5,-9394.91"/>
</g>
<!-- l0_mha_qkv_2 -->
<g id="node6" class="node">
<title>l0_mha_qkv_2</title>
<polygon fill="lightgreen" stroke="black" points="2408.5,-9384.67 1867.5,-9384.67 1867.5,-9316.67 2408.5,-9316.67 2408.5,-9384.67"/>
<text text-anchor="middle" x="2138" y="-9369.47" font-family="Helvetica,sans-Serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="2138" y="-9354.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2138" y="-9339.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="2138" y="-9324.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_mha_split&#45;&gt;l0_mha_qkv_2 -->
<g id="edge5" class="edge">
<title>l0_mha_split&#45;&gt;l0_mha_qkv_2</title>
<path fill="none" stroke="black" d="M2315.52,-9456.4C2315.52,-9456.4 2315.52,-9394.78 2315.52,-9394.78"/>
<polygon fill="black" stroke="black" points="2319.02,-9394.78 2315.52,-9384.78 2312.02,-9394.78 2319.02,-9394.78"/>
</g>
<!-- l0_mha_qkv_3 -->
<g id="node7" class="node">
<title>l0_mha_qkv_3</title>
<polygon fill="lightgreen" stroke="black" points="2985.5,-9384.67 2444.5,-9384.67 2444.5,-9316.67 2985.5,-9316.67 2985.5,-9384.67"/>
<text text-anchor="middle" x="2715" y="-9369.47" font-family="Helvetica,sans-Serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="2715" y="-9354.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2715" y="-9339.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="2715" y="-9324.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_mha_split&#45;&gt;l0_mha_qkv_3 -->
<g id="edge6" class="edge">
<title>l0_mha_split&#45;&gt;l0_mha_qkv_3</title>
<path fill="none" stroke="black" d="M2715,-9456.4C2715,-9456.4 2715,-9394.78 2715,-9394.78"/>
<polygon fill="black" stroke="black" points="2718.5,-9394.78 2715,-9384.78 2711.5,-9394.78 2718.5,-9394.78"/>
</g>
<!-- l0_mha_attn_0 -->
<g id="node8" class="node">
<title>l0_mha_attn_0</title>
<polygon fill="lightgreen" stroke="black" points="3550.5,-9244.67 3021.5,-9244.67 3021.5,-9176.67 3550.5,-9176.67 3550.5,-9244.67"/>
<text text-anchor="middle" x="3286" y="-9229.47" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="3286" y="-9214.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="3286" y="-9199.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3286" y="-9184.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_mha_qkv_0&#45;&gt;l0_mha_attn_0 -->
<g id="edge7" class="edge">
<title>l0_mha_qkv_0&#45;&gt;l0_mha_attn_0</title>
<path fill="none" stroke="black" d="M3286,-9316.42C3286,-9316.42 3286,-9255.05 3286,-9255.05"/>
<polygon fill="black" stroke="black" points="3289.5,-9255.05 3286,-9245.05 3282.5,-9255.05 3289.5,-9255.05"/>
</g>
<!-- l0_mha_attn_1 -->
<g id="node9" class="node">
<title>l0_mha_attn_1</title>
<polygon fill="lightgreen" stroke="black" points="1834.5,-9244.67 1305.5,-9244.67 1305.5,-9176.67 1834.5,-9176.67 1834.5,-9244.67"/>
<text text-anchor="middle" x="1570" y="-9229.47" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="1570" y="-9214.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="1570" y="-9199.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1570" y="-9184.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_mha_qkv_1&#45;&gt;l0_mha_attn_1 -->
<g id="edge8" class="edge">
<title>l0_mha_qkv_1&#45;&gt;l0_mha_attn_1</title>
<path fill="none" stroke="black" d="M1568.5,-9316.42C1568.5,-9316.42 1568.5,-9255.05 1568.5,-9255.05"/>
<polygon fill="black" stroke="black" points="1572,-9255.05 1568.5,-9245.05 1565,-9255.05 1572,-9255.05"/>
</g>
<!-- l0_mha_attn_2 -->
<g id="node10" class="node">
<title>l0_mha_attn_2</title>
<polygon fill="lightgreen" stroke="black" points="2408.5,-9244.67 1879.5,-9244.67 1879.5,-9176.67 2408.5,-9176.67 2408.5,-9244.67"/>
<text text-anchor="middle" x="2144" y="-9229.47" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="2144" y="-9214.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="2144" y="-9199.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2144" y="-9184.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_mha_qkv_2&#45;&gt;l0_mha_attn_2 -->
<g id="edge9" class="edge">
<title>l0_mha_qkv_2&#45;&gt;l0_mha_attn_2</title>
<path fill="none" stroke="black" d="M2144,-9316.42C2144,-9316.42 2144,-9255.05 2144,-9255.05"/>
<polygon fill="black" stroke="black" points="2147.5,-9255.05 2144,-9245.05 2140.5,-9255.05 2147.5,-9255.05"/>
</g>
<!-- l0_mha_attn_3 -->
<g id="node11" class="node">
<title>l0_mha_attn_3</title>
<polygon fill="lightgreen" stroke="black" points="2979.5,-9244.67 2450.5,-9244.67 2450.5,-9176.67 2979.5,-9176.67 2979.5,-9244.67"/>
<text text-anchor="middle" x="2715" y="-9229.47" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="2715" y="-9214.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="2715" y="-9199.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2715" y="-9184.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_mha_qkv_3&#45;&gt;l0_mha_attn_3 -->
<g id="edge10" class="edge">
<title>l0_mha_qkv_3&#45;&gt;l0_mha_attn_3</title>
<path fill="none" stroke="black" d="M2715,-9316.42C2715,-9316.42 2715,-9255.05 2715,-9255.05"/>
<polygon fill="black" stroke="black" points="2718.5,-9255.05 2715,-9245.05 2711.5,-9255.05 2718.5,-9255.05"/>
</g>
<!-- l0_mha_allreduce -->
<g id="node12" class="node">
<title>l0_mha_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="3195.03,-9104.67 2431.41,-9104.67 2234.97,-8968.67 2998.59,-8968.67 3195.03,-9104.67"/>
<text text-anchor="middle" x="2715" y="-9055.47" font-family="Helvetica,sans-Serif" font-size="14.00">MHA All&#45;Reduce</text>
<text text-anchor="middle" x="2715" y="-9040.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="2715" y="-9025.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2715" y="-9010.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;3</text>
</g>
<!-- l0_mha_attn_0&#45;&gt;l0_mha_allreduce -->
<g id="edge11" class="edge">
<title>l0_mha_attn_0&#45;&gt;l0_mha_allreduce</title>
<path fill="none" stroke="black" d="M3108.26,-9176.29C3108.26,-9176.29 3108.26,-9114.81 3108.26,-9114.81"/>
<polygon fill="black" stroke="black" points="3111.76,-9114.81 3108.26,-9104.81 3104.76,-9114.81 3111.76,-9114.81"/>
</g>
<!-- l0_mha_attn_1&#45;&gt;l0_mha_allreduce -->
<g id="edge12" class="edge">
<title>l0_mha_attn_1&#45;&gt;l0_mha_allreduce</title>
<path fill="none" stroke="black" d="M1709.5,-9176.57C1709.5,-9125.74 1709.5,-9036 1709.5,-9036 1709.5,-9036 2322,-9036 2322,-9036"/>
<polygon fill="black" stroke="black" points="2322,-9039.5 2332,-9036 2322,-9032.5 2322,-9039.5"/>
</g>
<!-- l0_mha_attn_2&#45;&gt;l0_mha_allreduce -->
<g id="edge13" class="edge">
<title>l0_mha_attn_2&#45;&gt;l0_mha_allreduce</title>
<path fill="none" stroke="black" d="M2321.74,-9176.29C2321.74,-9176.29 2321.74,-9046.73 2321.74,-9046.73"/>
<polygon fill="black" stroke="black" points="2325.24,-9046.73 2321.74,-9036.73 2318.24,-9046.73 2325.24,-9046.73"/>
</g>
<!-- l0_mha_attn_3&#45;&gt;l0_mha_allreduce -->
<g id="edge14" class="edge">
<title>l0_mha_attn_3&#45;&gt;l0_mha_allreduce</title>
<path fill="none" stroke="black" d="M2715,-9176.29C2715,-9176.29 2715,-9114.81 2715,-9114.81"/>
<polygon fill="black" stroke="black" points="2718.5,-9114.81 2715,-9104.81 2711.5,-9114.81 2718.5,-9114.81"/>
</g>
<!-- l0_mha_allreduce&#45;&gt;l0_mha_residual -->
<g id="edge16" class="edge">
<title>l0_mha_allreduce&#45;&gt;l0_mha_residual</title>
<path fill="none" stroke="black" d="M3058.01,-9009.48C3058.01,-9009.48 3058.01,-8906.84 3058.01,-8906.84"/>
<polygon fill="black" stroke="black" points="3061.51,-8906.84 3058.01,-8896.84 3054.51,-8906.84 3061.51,-8906.84"/>
</g>
<!-- l0_mha_layernorm -->
<g id="node14" class="node">
<title>l0_mha_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="3385,-8756.67 2931,-8756.67 2931,-8688.67 3385,-8688.67 3385,-8756.67"/>
<text text-anchor="middle" x="3158" y="-8741.47" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="3158" y="-8726.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3158" y="-8711.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3158" y="-8696.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l0_mha_residual&#45;&gt;l0_mha_layernorm -->
<g id="edge17" class="edge">
<title>l0_mha_residual&#45;&gt;l0_mha_layernorm</title>
<path fill="none" stroke="black" d="M3158,-8828.42C3158,-8828.42 3158,-8767.05 3158,-8767.05"/>
<polygon fill="black" stroke="black" points="3161.5,-8767.05 3158,-8757.05 3154.5,-8767.05 3161.5,-8767.05"/>
</g>
<!-- l0_ffn_split -->
<g id="node15" class="node">
<title>l0_ffn_split</title>
<polygon fill="lightyellow" stroke="black" points="2843.42,-8616.67 2060.09,-8616.67 1858.58,-8480.67 2641.91,-8480.67 2843.42,-8616.67"/>
<text text-anchor="middle" x="2351" y="-8567.47" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Input Split</text>
<text text-anchor="middle" x="2351" y="-8552.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2351" y="-8537.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="2351" y="-8522.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;3</text>
</g>
<!-- l0_mha_layernorm&#45;&gt;l0_ffn_split -->
<g id="edge18" class="edge">
<title>l0_mha_layernorm&#45;&gt;l0_ffn_split</title>
<path fill="none" stroke="black" d="M3024.25,-8688.61C3024.25,-8646.98 3024.25,-8582 3024.25,-8582 3024.25,-8582 2802.08,-8582 2802.08,-8582"/>
<polygon fill="black" stroke="black" points="2802.08,-8578.5 2792.08,-8582 2802.08,-8585.5 2802.08,-8578.5"/>
</g>
<!-- l0_ffn_residual -->
<g id="node33" class="node">
<title>l0_ffn_residual</title>
<polygon fill="lightgreen" stroke="black" points="3526,-7780.67 3052,-7780.67 3052,-7712.67 3526,-7712.67 3526,-7780.67"/>
<text text-anchor="middle" x="3289" y="-7765.47" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3289" y="-7750.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096] (x2)</text>
<text text-anchor="middle" x="3289" y="-7735.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3289" y="-7720.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l0_mha_layernorm&#45;&gt;l0_ffn_residual -->
<g id="edge43" class="edge">
<title>l0_mha_layernorm&#45;&gt;l0_ffn_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3135.5,-8688.56C3135.5,-8567.27 3135.5,-8164 3135.5,-8164 3135.5,-8164 3512.25,-8164 3512.25,-8164 3512.25,-8164 3512.25,-7790.82 3512.25,-7790.82"/>
<polygon fill="black" stroke="black" points="3515.75,-7790.82 3512.25,-7780.82 3508.75,-7790.82 3515.75,-7790.82"/>
</g>
<!-- l0_ffn_up_0 -->
<g id="node16" class="node">
<title>l0_ffn_up_0</title>
<polygon fill="lightgreen" stroke="black" points="4163.5,-8408.67 3676.5,-8408.67 3676.5,-8340.67 4163.5,-8340.67 4163.5,-8408.67"/>
<text text-anchor="middle" x="3920" y="-8393.47" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="3920" y="-8378.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3920" y="-8363.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3920" y="-8348.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_ffn_split&#45;&gt;l0_ffn_up_0 -->
<g id="edge19" class="edge">
<title>l0_ffn_split&#45;&gt;l0_ffn_up_0</title>
<path fill="none" stroke="black" d="M2741.87,-8548C3206.57,-8548 3920,-8548 3920,-8548 3920,-8548 3920,-8418.91 3920,-8418.91"/>
<polygon fill="black" stroke="black" points="3923.5,-8418.91 3920,-8408.91 3916.5,-8418.91 3923.5,-8418.91"/>
</g>
<!-- l0_ffn_up_1 -->
<g id="node17" class="node">
<title>l0_ffn_up_1</title>
<polygon fill="lightgreen" stroke="black" points="502.5,-8408.67 15.5,-8408.67 15.5,-8340.67 502.5,-8340.67 502.5,-8408.67"/>
<text text-anchor="middle" x="259" y="-8393.47" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="259" y="-8378.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="259" y="-8363.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="259" y="-8348.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_ffn_split&#45;&gt;l0_ffn_up_1 -->
<g id="edge20" class="edge">
<title>l0_ffn_split&#45;&gt;l0_ffn_up_1</title>
<path fill="none" stroke="black" d="M2008.48,-8582C1415.16,-8582 259,-8582 259,-8582 259,-8582 259,-8418.9 259,-8418.9"/>
<polygon fill="black" stroke="black" points="262.5,-8418.9 259,-8408.9 255.5,-8418.9 262.5,-8418.9"/>
</g>
<!-- l0_ffn_up_2 -->
<g id="node18" class="node">
<title>l0_ffn_up_2</title>
<polygon fill="lightgreen" stroke="black" points="1548.5,-8408.67 1061.5,-8408.67 1061.5,-8340.67 1548.5,-8340.67 1548.5,-8408.67"/>
<text text-anchor="middle" x="1305" y="-8393.47" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="1305" y="-8378.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1305" y="-8363.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1305" y="-8348.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_ffn_split&#45;&gt;l0_ffn_up_2 -->
<g id="edge21" class="edge">
<title>l0_ffn_split&#45;&gt;l0_ffn_up_2</title>
<path fill="none" stroke="black" d="M1907.94,-8514C1670.81,-8514 1427,-8514 1427,-8514 1427,-8514 1427,-8418.75 1427,-8418.75"/>
<polygon fill="black" stroke="black" points="1430.5,-8418.75 1427,-8408.75 1423.5,-8418.75 1430.5,-8418.75"/>
</g>
<!-- l0_ffn_up_3 -->
<g id="node19" class="node">
<title>l0_ffn_up_3</title>
<polygon fill="lightgreen" stroke="black" points="2594.5,-8408.67 2107.5,-8408.67 2107.5,-8340.67 2594.5,-8340.67 2594.5,-8408.67"/>
<text text-anchor="middle" x="2351" y="-8393.47" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="2351" y="-8378.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2351" y="-8363.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="2351" y="-8348.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_ffn_split&#45;&gt;l0_ffn_up_3 -->
<g id="edge22" class="edge">
<title>l0_ffn_split&#45;&gt;l0_ffn_up_3</title>
<path fill="none" stroke="black" d="M2351,-8480.4C2351,-8480.4 2351,-8418.78 2351,-8418.78"/>
<polygon fill="black" stroke="black" points="2354.5,-8418.78 2351,-8408.78 2347.5,-8418.78 2354.5,-8418.78"/>
</g>
<!-- l0_ffn_gate_0 -->
<g id="node20" class="node">
<title>l0_ffn_gate_0</title>
<polygon fill="lightgreen" stroke="black" points="3640.5,-8408.67 3153.5,-8408.67 3153.5,-8340.67 3640.5,-8340.67 3640.5,-8408.67"/>
<text text-anchor="middle" x="3397" y="-8393.47" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="3397" y="-8378.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3397" y="-8363.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3397" y="-8348.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_ffn_split&#45;&gt;l0_ffn_gate_0 -->
<g id="edge23" class="edge">
<title>l0_ffn_split&#45;&gt;l0_ffn_gate_0</title>
<path fill="none" stroke="black" d="M2691.62,-8514C2952.94,-8514 3269.25,-8514 3269.25,-8514 3269.25,-8514 3269.25,-8418.75 3269.25,-8418.75"/>
<polygon fill="black" stroke="black" points="3272.75,-8418.75 3269.25,-8408.75 3265.75,-8418.75 3272.75,-8418.75"/>
</g>
<!-- l0_ffn_gate_1 -->
<g id="node21" class="node">
<title>l0_ffn_gate_1</title>
<polygon fill="lightgreen" stroke="black" points="1025.5,-8408.67 538.5,-8408.67 538.5,-8340.67 1025.5,-8340.67 1025.5,-8408.67"/>
<text text-anchor="middle" x="782" y="-8393.47" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="782" y="-8378.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="782" y="-8363.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="782" y="-8348.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_ffn_split&#45;&gt;l0_ffn_gate_1 -->
<g id="edge24" class="edge">
<title>l0_ffn_split&#45;&gt;l0_ffn_gate_1</title>
<path fill="none" stroke="black" d="M1958.11,-8548C1493.36,-8548 782,-8548 782,-8548 782,-8548 782,-8418.91 782,-8418.91"/>
<polygon fill="black" stroke="black" points="785.5,-8418.91 782,-8408.91 778.5,-8418.91 785.5,-8418.91"/>
</g>
<!-- l0_ffn_gate_2 -->
<g id="node22" class="node">
<title>l0_ffn_gate_2</title>
<polygon fill="lightgreen" stroke="black" points="2071.5,-8408.67 1584.5,-8408.67 1584.5,-8340.67 2071.5,-8340.67 2071.5,-8408.67"/>
<text text-anchor="middle" x="1828" y="-8393.47" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="1828" y="-8378.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1828" y="-8363.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1828" y="-8348.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_ffn_split&#45;&gt;l0_ffn_gate_2 -->
<g id="edge25" class="edge">
<title>l0_ffn_split&#45;&gt;l0_ffn_gate_2</title>
<path fill="none" stroke="black" d="M1965.02,-8480.4C1965.02,-8480.4 1965.02,-8418.78 1965.02,-8418.78"/>
<polygon fill="black" stroke="black" points="1968.52,-8418.78 1965.02,-8408.78 1961.52,-8418.78 1968.52,-8418.78"/>
</g>
<!-- l0_ffn_gate_3 -->
<g id="node23" class="node">
<title>l0_ffn_gate_3</title>
<polygon fill="lightgreen" stroke="black" points="3117.5,-8408.67 2630.5,-8408.67 2630.5,-8340.67 3117.5,-8340.67 3117.5,-8408.67"/>
<text text-anchor="middle" x="2874" y="-8393.47" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="2874" y="-8378.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2874" y="-8363.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="2874" y="-8348.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_ffn_split&#45;&gt;l0_ffn_gate_3 -->
<g id="edge26" class="edge">
<title>l0_ffn_split&#45;&gt;l0_ffn_gate_3</title>
<path fill="none" stroke="black" d="M2736.98,-8544.7C2736.98,-8544.7 2736.98,-8418.89 2736.98,-8418.89"/>
<polygon fill="black" stroke="black" points="2740.48,-8418.89 2736.98,-8408.89 2733.48,-8418.89 2740.48,-8418.89"/>
</g>
<!-- l0_ffn_act_0 -->
<g id="node24" class="node">
<title>l0_ffn_act_0</title>
<polygon fill="lightgreen" stroke="black" points="3640.5,-8268.67 3153.5,-8268.67 3153.5,-8200.67 3640.5,-8200.67 3640.5,-8268.67"/>
<text text-anchor="middle" x="3397" y="-8253.47" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="3397" y="-8238.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3397" y="-8223.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3397" y="-8208.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_ffn_up_0&#45;&gt;l0_ffn_act_0 -->
<g id="edge27" class="edge">
<title>l0_ffn_up_0&#45;&gt;l0_ffn_act_0</title>
<path fill="none" stroke="black" d="M3728.98,-8340.61C3728.98,-8298.98 3728.98,-8234 3728.98,-8234 3728.98,-8234 3650.89,-8234 3650.89,-8234"/>
<polygon fill="black" stroke="black" points="3650.89,-8230.5 3640.89,-8234 3650.89,-8237.5 3650.89,-8230.5"/>
</g>
<!-- l0_ffn_act_1 -->
<g id="node25" class="node">
<title>l0_ffn_act_1</title>
<polygon fill="lightgreen" stroke="black" points="1025.5,-8268.67 538.5,-8268.67 538.5,-8200.67 1025.5,-8200.67 1025.5,-8268.67"/>
<text text-anchor="middle" x="782" y="-8253.47" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="782" y="-8238.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="782" y="-8223.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="782" y="-8208.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_ffn_up_1&#45;&gt;l0_ffn_act_1 -->
<g id="edge28" class="edge">
<title>l0_ffn_up_1&#45;&gt;l0_ffn_act_1</title>
<path fill="none" stroke="black" d="M259,-8340.61C259,-8298.98 259,-8234 259,-8234 259,-8234 528.49,-8234 528.49,-8234"/>
<polygon fill="black" stroke="black" points="528.49,-8237.5 538.49,-8234 528.49,-8230.5 528.49,-8237.5"/>
</g>
<!-- l0_ffn_act_2 -->
<g id="node26" class="node">
<title>l0_ffn_act_2</title>
<polygon fill="lightgreen" stroke="black" points="2071.5,-8268.67 1584.5,-8268.67 1584.5,-8200.67 2071.5,-8200.67 2071.5,-8268.67"/>
<text text-anchor="middle" x="1828" y="-8253.47" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="1828" y="-8238.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1828" y="-8223.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1828" y="-8208.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_ffn_up_2&#45;&gt;l0_ffn_act_2 -->
<g id="edge29" class="edge">
<title>l0_ffn_up_2&#45;&gt;l0_ffn_act_2</title>
<path fill="none" stroke="black" d="M1525,-8340.61C1525,-8298.98 1525,-8234 1525,-8234 1525,-8234 1574.14,-8234 1574.14,-8234"/>
<polygon fill="black" stroke="black" points="1574.14,-8237.5 1584.14,-8234 1574.14,-8230.5 1574.14,-8237.5"/>
</g>
<!-- l0_ffn_act_3 -->
<g id="node27" class="node">
<title>l0_ffn_act_3</title>
<polygon fill="lightgreen" stroke="black" points="2856.5,-8268.67 2369.5,-8268.67 2369.5,-8200.67 2856.5,-8200.67 2856.5,-8268.67"/>
<text text-anchor="middle" x="2613" y="-8253.47" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="2613" y="-8238.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="2613" y="-8223.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="2613" y="-8208.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_ffn_up_3&#45;&gt;l0_ffn_act_3 -->
<g id="edge30" class="edge">
<title>l0_ffn_up_3&#45;&gt;l0_ffn_act_3</title>
<path fill="none" stroke="black" d="M2482,-8340.42C2482,-8340.42 2482,-8279.05 2482,-8279.05"/>
<polygon fill="black" stroke="black" points="2485.5,-8279.05 2482,-8269.05 2478.5,-8279.05 2485.5,-8279.05"/>
</g>
<!-- l0_ffn_gate_0&#45;&gt;l0_ffn_act_0 -->
<g id="edge31" class="edge">
<title>l0_ffn_gate_0&#45;&gt;l0_ffn_act_0</title>
<path fill="none" stroke="black" d="M3397,-8340.42C3397,-8340.42 3397,-8279.05 3397,-8279.05"/>
<polygon fill="black" stroke="black" points="3400.5,-8279.05 3397,-8269.05 3393.5,-8279.05 3400.5,-8279.05"/>
</g>
<!-- l0_ffn_gate_1&#45;&gt;l0_ffn_act_1 -->
<g id="edge32" class="edge">
<title>l0_ffn_gate_1&#45;&gt;l0_ffn_act_1</title>
<path fill="none" stroke="black" d="M782,-8340.42C782,-8340.42 782,-8279.05 782,-8279.05"/>
<polygon fill="black" stroke="black" points="785.5,-8279.05 782,-8269.05 778.5,-8279.05 785.5,-8279.05"/>
</g>
<!-- l0_ffn_gate_2&#45;&gt;l0_ffn_act_2 -->
<g id="edge33" class="edge">
<title>l0_ffn_gate_2&#45;&gt;l0_ffn_act_2</title>
<path fill="none" stroke="black" d="M1828,-8340.42C1828,-8340.42 1828,-8279.05 1828,-8279.05"/>
<polygon fill="black" stroke="black" points="1831.5,-8279.05 1828,-8269.05 1824.5,-8279.05 1831.5,-8279.05"/>
</g>
<!-- l0_ffn_gate_3&#45;&gt;l0_ffn_act_3 -->
<g id="edge34" class="edge">
<title>l0_ffn_gate_3&#45;&gt;l0_ffn_act_3</title>
<path fill="none" stroke="black" d="M2743.5,-8340.42C2743.5,-8340.42 2743.5,-8279.05 2743.5,-8279.05"/>
<polygon fill="black" stroke="black" points="2747,-8279.05 2743.5,-8269.05 2740,-8279.05 2747,-8279.05"/>
</g>
<!-- l0_ffn_down_0 -->
<g id="node28" class="node">
<title>l0_ffn_down_0</title>
<polygon fill="lightgreen" stroke="black" points="3498.5,-8128.67 3023.5,-8128.67 3023.5,-8060.67 3498.5,-8060.67 3498.5,-8128.67"/>
<text text-anchor="middle" x="3261" y="-8113.47" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="3261" y="-8098.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3261" y="-8083.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3261" y="-8068.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0</text>
</g>
<!-- l0_ffn_act_0&#45;&gt;l0_ffn_down_0 -->
<g id="edge35" class="edge">
<title>l0_ffn_act_0&#45;&gt;l0_ffn_down_0</title>
<path fill="none" stroke="black" d="M3326,-8200.42C3326,-8200.42 3326,-8139.05 3326,-8139.05"/>
<polygon fill="black" stroke="black" points="3329.5,-8139.05 3326,-8129.05 3322.5,-8139.05 3329.5,-8139.05"/>
</g>
<!-- l0_ffn_down_1 -->
<g id="node29" class="node">
<title>l0_ffn_down_1</title>
<polygon fill="lightgreen" stroke="black" points="1355.5,-8128.67 880.5,-8128.67 880.5,-8060.67 1355.5,-8060.67 1355.5,-8128.67"/>
<text text-anchor="middle" x="1118" y="-8113.47" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="1118" y="-8098.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1118" y="-8083.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1118" y="-8068.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 1</text>
</g>
<!-- l0_ffn_act_1&#45;&gt;l0_ffn_down_1 -->
<g id="edge36" class="edge">
<title>l0_ffn_act_1&#45;&gt;l0_ffn_down_1</title>
<path fill="none" stroke="black" d="M953,-8200.42C953,-8200.42 953,-8139.05 953,-8139.05"/>
<polygon fill="black" stroke="black" points="956.5,-8139.05 953,-8129.05 949.5,-8139.05 956.5,-8139.05"/>
</g>
<!-- l0_ffn_down_2 -->
<g id="node30" class="node">
<title>l0_ffn_down_2</title>
<polygon fill="lightgreen" stroke="black" points="2202.5,-8128.67 1727.5,-8128.67 1727.5,-8060.67 2202.5,-8060.67 2202.5,-8128.67"/>
<text text-anchor="middle" x="1965" y="-8113.47" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="1965" y="-8098.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1965" y="-8083.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1965" y="-8068.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 2</text>
</g>
<!-- l0_ffn_act_2&#45;&gt;l0_ffn_down_2 -->
<g id="edge37" class="edge">
<title>l0_ffn_act_2&#45;&gt;l0_ffn_down_2</title>
<path fill="none" stroke="black" d="M1899.5,-8200.42C1899.5,-8200.42 1899.5,-8139.05 1899.5,-8139.05"/>
<polygon fill="black" stroke="black" points="1903,-8139.05 1899.5,-8129.05 1896,-8139.05 1903,-8139.05"/>
</g>
<!-- l0_ffn_down_3 -->
<g id="node31" class="node">
<title>l0_ffn_down_3</title>
<polygon fill="lightgreen" stroke="black" points="2850.5,-8128.67 2375.5,-8128.67 2375.5,-8060.67 2850.5,-8060.67 2850.5,-8128.67"/>
<text text-anchor="middle" x="2613" y="-8113.47" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="2613" y="-8098.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="2613" y="-8083.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2613" y="-8068.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 3</text>
</g>
<!-- l0_ffn_act_3&#45;&gt;l0_ffn_down_3 -->
<g id="edge38" class="edge">
<title>l0_ffn_act_3&#45;&gt;l0_ffn_down_3</title>
<path fill="none" stroke="black" d="M2613,-8200.42C2613,-8200.42 2613,-8139.05 2613,-8139.05"/>
<polygon fill="black" stroke="black" points="2616.5,-8139.05 2613,-8129.05 2609.5,-8139.05 2616.5,-8139.05"/>
</g>
<!-- l0_ffn_allreduce -->
<g id="node32" class="node">
<title>l0_ffn_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="3093.03,-7988.67 2329.41,-7988.67 2132.97,-7852.67 2896.59,-7852.67 3093.03,-7988.67"/>
<text text-anchor="middle" x="2613" y="-7939.47" font-family="Helvetica,sans-Serif" font-size="14.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="2613" y="-7924.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="2613" y="-7909.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2613" y="-7894.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0&#45;3</text>
</g>
<!-- l0_ffn_down_0&#45;&gt;l0_ffn_allreduce -->
<g id="edge39" class="edge">
<title>l0_ffn_down_0&#45;&gt;l0_ffn_allreduce</title>
<path fill="none" stroke="black" d="M3058.26,-8060.29C3058.26,-8060.29 3058.26,-7998.81 3058.26,-7998.81"/>
<polygon fill="black" stroke="black" points="3061.76,-7998.81 3058.26,-7988.81 3054.76,-7998.81 3061.76,-7998.81"/>
</g>
<!-- l0_ffn_down_1&#45;&gt;l0_ffn_allreduce -->
<g id="edge40" class="edge">
<title>l0_ffn_down_1&#45;&gt;l0_ffn_allreduce</title>
<path fill="none" stroke="black" d="M1167,-8060.57C1167,-8009.74 1167,-7920 1167,-7920 1167,-7920 2219.77,-7920 2219.77,-7920"/>
<polygon fill="black" stroke="black" points="2219.77,-7923.5 2229.77,-7920 2219.77,-7916.5 2219.77,-7923.5"/>
</g>
<!-- l0_ffn_down_2&#45;&gt;l0_ffn_allreduce -->
<g id="edge41" class="edge">
<title>l0_ffn_down_2&#45;&gt;l0_ffn_allreduce</title>
<path fill="none" stroke="black" d="M2167.74,-8060.29C2167.74,-8060.29 2167.74,-7930.73 2167.74,-7930.73"/>
<polygon fill="black" stroke="black" points="2171.24,-7930.73 2167.74,-7920.73 2164.24,-7930.73 2171.24,-7930.73"/>
</g>
<!-- l0_ffn_down_3&#45;&gt;l0_ffn_allreduce -->
<g id="edge42" class="edge">
<title>l0_ffn_down_3&#45;&gt;l0_ffn_allreduce</title>
<path fill="none" stroke="black" d="M2613,-8060.29C2613,-8060.29 2613,-7998.81 2613,-7998.81"/>
<polygon fill="black" stroke="black" points="2616.5,-7998.81 2613,-7988.81 2609.5,-7998.81 2616.5,-7998.81"/>
</g>
<!-- l0_ffn_allreduce&#45;&gt;l0_ffn_residual -->
<g id="edge44" class="edge">
<title>l0_ffn_allreduce&#45;&gt;l0_ffn_residual</title>
<path fill="none" stroke="black" d="M3072.51,-7920.54C3072.51,-7920.54 3072.51,-7790.91 3072.51,-7790.91"/>
<polygon fill="black" stroke="black" points="3076.01,-7790.91 3072.51,-7780.91 3069.01,-7790.91 3076.01,-7790.91"/>
</g>
<!-- l0_layernorm -->
<g id="node34" class="node">
<title>l0_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="3516,-7640.67 3062,-7640.67 3062,-7572.67 3516,-7572.67 3516,-7640.67"/>
<text text-anchor="middle" x="3289" y="-7625.47" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="3289" y="-7610.47" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3289" y="-7595.47" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3289" y="-7580.47" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l0_ffn_residual&#45;&gt;l0_layernorm -->
<g id="edge45" class="edge">
<title>l0_ffn_residual&#45;&gt;l0_layernorm</title>
<path fill="none" stroke="black" d="M3289,-7712.42C3289,-7712.42 3289,-7651.05 3289,-7651.05"/>
<polygon fill="black" stroke="black" points="3292.5,-7651.05 3289,-7641.05 3285.5,-7651.05 3292.5,-7651.05"/>
</g>
<!-- send_l0_l1 -->
<g id="node135" class="node">
<title>send_l0_l1</title>
<ellipse fill="orange" stroke="black" cx="3289" cy="-7452.58" rx="321.05" ry="48.17"/>
<text text-anchor="middle" x="3289" y="-7471.38" font-family="Helvetica,sans-Serif" font-size="14.00">Pipeline Send</text>
<text text-anchor="middle" x="3289" y="-7456.38" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3289" y="-7441.38" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3289" y="-7426.38" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- l0_layernorm&#45;&gt;send_l0_l1 -->
<g id="edge46" class="edge">
<title>l0_layernorm&#45;&gt;send_l0_l1</title>
<path fill="none" stroke="black" d="M3289,-7572.47C3289,-7572.47 3289,-7510.71 3289,-7510.71"/>
<polygon fill="black" stroke="black" points="3292.5,-7510.71 3289,-7500.71 3285.5,-7510.71 3292.5,-7510.71"/>
</g>
<!-- l1_input_broadcast -->
<g id="node35" class="node">
<title>l1_input_broadcast</title>
<polygon fill="lightyellow" stroke="black" points="3781.42,-7332.5 2998.09,-7332.5 2796.58,-7196.5 3579.91,-7196.5 3781.42,-7332.5"/>
<text text-anchor="middle" x="3289" y="-7283.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input Broadcast</text>
<text text-anchor="middle" x="3289" y="-7268.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3289" y="-7253.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]×4</text>
<text text-anchor="middle" x="3289" y="-7238.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4&#45;7</text>
</g>
<!-- l1_mha_split -->
<g id="node36" class="node">
<title>l1_mha_split</title>
<polygon fill="lightyellow" stroke="black" points="3495.42,-7124.5 2712.09,-7124.5 2510.58,-6988.5 3293.91,-6988.5 3495.42,-7124.5"/>
<text text-anchor="middle" x="3003" y="-7075.3" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Input Split</text>
<text text-anchor="middle" x="3003" y="-7060.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3003" y="-7045.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="3003" y="-7030.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4&#45;7</text>
</g>
<!-- l1_input_broadcast&#45;&gt;l1_mha_split -->
<g id="edge48" class="edge">
<title>l1_input_broadcast&#45;&gt;l1_mha_split</title>
<path fill="none" stroke="black" d="M3146,-7196.39C3146,-7196.39 3146,-7134.76 3146,-7134.76"/>
<polygon fill="black" stroke="black" points="3149.5,-7134.76 3146,-7124.76 3142.5,-7134.76 3149.5,-7134.76"/>
</g>
<!-- l1_mha_residual -->
<g id="node46" class="node">
<title>l1_mha_residual</title>
<polygon fill="lightgreen" stroke="black" points="3682,-6428.5 3208,-6428.5 3208,-6360.5 3682,-6360.5 3682,-6428.5"/>
<text text-anchor="middle" x="3445" y="-6413.3" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3445" y="-6398.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096] (x2)</text>
<text text-anchor="middle" x="3445" y="-6383.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3445" y="-6368.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l1_input_broadcast&#45;&gt;l1_mha_residual -->
<g id="edge61" class="edge">
<title>l1_input_broadcast&#45;&gt;l1_mha_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3680.07,-7264C3829.87,-7264 3965.5,-7264 3965.5,-7264 3965.5,-7264 3965.5,-6394 3965.5,-6394 3965.5,-6394 3692.02,-6394 3692.02,-6394"/>
<polygon fill="black" stroke="black" points="3692.02,-6390.5 3682.02,-6394 3692.02,-6397.5 3692.02,-6390.5"/>
</g>
<!-- l1_mha_qkv_4 -->
<g id="node37" class="node">
<title>l1_mha_qkv_4</title>
<polygon fill="lightgreen" stroke="black" points="3850.5,-6916.5 3309.5,-6916.5 3309.5,-6848.5 3850.5,-6848.5 3850.5,-6916.5"/>
<text text-anchor="middle" x="3580" y="-6901.3" font-family="Helvetica,sans-Serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="3580" y="-6886.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3580" y="-6871.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="3580" y="-6856.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_mha_split&#45;&gt;l1_mha_qkv_4 -->
<g id="edge49" class="edge">
<title>l1_mha_split&#45;&gt;l1_mha_qkv_4</title>
<path fill="none" stroke="black" d="M3402.48,-7056.37C3402.48,-7056.37 3402.48,-6926.75 3402.48,-6926.75"/>
<polygon fill="black" stroke="black" points="3405.98,-6926.75 3402.48,-6916.75 3398.98,-6926.75 3405.98,-6926.75"/>
</g>
<!-- l1_mha_qkv_5 -->
<g id="node38" class="node">
<title>l1_mha_qkv_5</title>
<polygon fill="lightgreen" stroke="black" points="2119.5,-6916.5 1578.5,-6916.5 1578.5,-6848.5 2119.5,-6848.5 2119.5,-6916.5"/>
<text text-anchor="middle" x="1849" y="-6901.3" font-family="Helvetica,sans-Serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="1849" y="-6886.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1849" y="-6871.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="1849" y="-6856.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_mha_split&#45;&gt;l1_mha_qkv_5 -->
<g id="edge50" class="edge">
<title>l1_mha_split&#45;&gt;l1_mha_qkv_5</title>
<path fill="none" stroke="black" d="M2610.22,-7056C2301.57,-7056 1923.5,-7056 1923.5,-7056 1923.5,-7056 1923.5,-6926.78 1923.5,-6926.78"/>
<polygon fill="black" stroke="black" points="1927,-6926.78 1923.5,-6916.78 1920,-6926.78 1927,-6926.78"/>
</g>
<!-- l1_mha_qkv_6 -->
<g id="node39" class="node">
<title>l1_mha_qkv_6</title>
<polygon fill="lightgreen" stroke="black" points="2696.5,-6916.5 2155.5,-6916.5 2155.5,-6848.5 2696.5,-6848.5 2696.5,-6916.5"/>
<text text-anchor="middle" x="2426" y="-6901.3" font-family="Helvetica,sans-Serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="2426" y="-6886.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2426" y="-6871.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="2426" y="-6856.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_mha_split&#45;&gt;l1_mha_qkv_6 -->
<g id="edge51" class="edge">
<title>l1_mha_split&#45;&gt;l1_mha_qkv_6</title>
<path fill="none" stroke="black" d="M2603.52,-6988.23C2603.52,-6988.23 2603.52,-6926.61 2603.52,-6926.61"/>
<polygon fill="black" stroke="black" points="2607.02,-6926.61 2603.52,-6916.61 2600.02,-6926.61 2607.02,-6926.61"/>
</g>
<!-- l1_mha_qkv_7 -->
<g id="node40" class="node">
<title>l1_mha_qkv_7</title>
<polygon fill="lightgreen" stroke="black" points="3273.5,-6916.5 2732.5,-6916.5 2732.5,-6848.5 3273.5,-6848.5 3273.5,-6916.5"/>
<text text-anchor="middle" x="3003" y="-6901.3" font-family="Helvetica,sans-Serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="3003" y="-6886.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3003" y="-6871.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="3003" y="-6856.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_mha_split&#45;&gt;l1_mha_qkv_7 -->
<g id="edge52" class="edge">
<title>l1_mha_split&#45;&gt;l1_mha_qkv_7</title>
<path fill="none" stroke="black" d="M3003,-6988.23C3003,-6988.23 3003,-6926.61 3003,-6926.61"/>
<polygon fill="black" stroke="black" points="3006.5,-6926.61 3003,-6916.61 2999.5,-6926.61 3006.5,-6926.61"/>
</g>
<!-- l1_mha_attn_4 -->
<g id="node41" class="node">
<title>l1_mha_attn_4</title>
<polygon fill="lightgreen" stroke="black" points="3838.5,-6776.5 3309.5,-6776.5 3309.5,-6708.5 3838.5,-6708.5 3838.5,-6776.5"/>
<text text-anchor="middle" x="3574" y="-6761.3" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="3574" y="-6746.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="3574" y="-6731.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3574" y="-6716.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_mha_qkv_4&#45;&gt;l1_mha_attn_4 -->
<g id="edge53" class="edge">
<title>l1_mha_qkv_4&#45;&gt;l1_mha_attn_4</title>
<path fill="none" stroke="black" d="M3574,-6848.25C3574,-6848.25 3574,-6786.88 3574,-6786.88"/>
<polygon fill="black" stroke="black" points="3577.5,-6786.88 3574,-6776.88 3570.5,-6786.88 3577.5,-6786.88"/>
</g>
<!-- l1_mha_attn_5 -->
<g id="node42" class="node">
<title>l1_mha_attn_5</title>
<polygon fill="lightgreen" stroke="black" points="2122.5,-6776.5 1593.5,-6776.5 1593.5,-6708.5 2122.5,-6708.5 2122.5,-6776.5"/>
<text text-anchor="middle" x="1858" y="-6761.3" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="1858" y="-6746.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="1858" y="-6731.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1858" y="-6716.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_mha_qkv_5&#45;&gt;l1_mha_attn_5 -->
<g id="edge54" class="edge">
<title>l1_mha_qkv_5&#45;&gt;l1_mha_attn_5</title>
<path fill="none" stroke="black" d="M1856.5,-6848.25C1856.5,-6848.25 1856.5,-6786.88 1856.5,-6786.88"/>
<polygon fill="black" stroke="black" points="1860,-6786.88 1856.5,-6776.88 1853,-6786.88 1860,-6786.88"/>
</g>
<!-- l1_mha_attn_6 -->
<g id="node43" class="node">
<title>l1_mha_attn_6</title>
<polygon fill="lightgreen" stroke="black" points="2696.5,-6776.5 2167.5,-6776.5 2167.5,-6708.5 2696.5,-6708.5 2696.5,-6776.5"/>
<text text-anchor="middle" x="2432" y="-6761.3" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="2432" y="-6746.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="2432" y="-6731.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2432" y="-6716.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_mha_qkv_6&#45;&gt;l1_mha_attn_6 -->
<g id="edge55" class="edge">
<title>l1_mha_qkv_6&#45;&gt;l1_mha_attn_6</title>
<path fill="none" stroke="black" d="M2432,-6848.25C2432,-6848.25 2432,-6786.88 2432,-6786.88"/>
<polygon fill="black" stroke="black" points="2435.5,-6786.88 2432,-6776.88 2428.5,-6786.88 2435.5,-6786.88"/>
</g>
<!-- l1_mha_attn_7 -->
<g id="node44" class="node">
<title>l1_mha_attn_7</title>
<polygon fill="lightgreen" stroke="black" points="3267.5,-6776.5 2738.5,-6776.5 2738.5,-6708.5 3267.5,-6708.5 3267.5,-6776.5"/>
<text text-anchor="middle" x="3003" y="-6761.3" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="3003" y="-6746.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="3003" y="-6731.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3003" y="-6716.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_mha_qkv_7&#45;&gt;l1_mha_attn_7 -->
<g id="edge56" class="edge">
<title>l1_mha_qkv_7&#45;&gt;l1_mha_attn_7</title>
<path fill="none" stroke="black" d="M3003,-6848.25C3003,-6848.25 3003,-6786.88 3003,-6786.88"/>
<polygon fill="black" stroke="black" points="3006.5,-6786.88 3003,-6776.88 2999.5,-6786.88 3006.5,-6786.88"/>
</g>
<!-- l1_mha_allreduce -->
<g id="node45" class="node">
<title>l1_mha_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="3483.03,-6636.5 2719.41,-6636.5 2522.97,-6500.5 3286.59,-6500.5 3483.03,-6636.5"/>
<text text-anchor="middle" x="3003" y="-6587.3" font-family="Helvetica,sans-Serif" font-size="14.00">MHA All&#45;Reduce</text>
<text text-anchor="middle" x="3003" y="-6572.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="3003" y="-6557.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3003" y="-6542.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4&#45;7</text>
</g>
<!-- l1_mha_attn_4&#45;&gt;l1_mha_allreduce -->
<g id="edge57" class="edge">
<title>l1_mha_attn_4&#45;&gt;l1_mha_allreduce</title>
<path fill="none" stroke="black" d="M3396.26,-6708.12C3396.26,-6708.12 3396.26,-6646.64 3396.26,-6646.64"/>
<polygon fill="black" stroke="black" points="3399.76,-6646.64 3396.26,-6636.64 3392.76,-6646.64 3399.76,-6646.64"/>
</g>
<!-- l1_mha_attn_5&#45;&gt;l1_mha_allreduce -->
<g id="edge58" class="edge">
<title>l1_mha_attn_5&#45;&gt;l1_mha_allreduce</title>
<path fill="none" stroke="black" d="M2073.5,-6708.44C2073.5,-6657.66 2073.5,-6568 2073.5,-6568 2073.5,-6568 2610.24,-6568 2610.24,-6568"/>
<polygon fill="black" stroke="black" points="2610.24,-6571.5 2620.24,-6568 2610.24,-6564.5 2610.24,-6571.5"/>
</g>
<!-- l1_mha_attn_6&#45;&gt;l1_mha_allreduce -->
<g id="edge59" class="edge">
<title>l1_mha_attn_6&#45;&gt;l1_mha_allreduce</title>
<path fill="none" stroke="black" d="M2609.74,-6708.12C2609.74,-6708.12 2609.74,-6578.56 2609.74,-6578.56"/>
<polygon fill="black" stroke="black" points="2613.24,-6578.56 2609.74,-6568.56 2606.24,-6578.56 2613.24,-6578.56"/>
</g>
<!-- l1_mha_attn_7&#45;&gt;l1_mha_allreduce -->
<g id="edge60" class="edge">
<title>l1_mha_attn_7&#45;&gt;l1_mha_allreduce</title>
<path fill="none" stroke="black" d="M3003,-6708.12C3003,-6708.12 3003,-6646.64 3003,-6646.64"/>
<polygon fill="black" stroke="black" points="3006.5,-6646.64 3003,-6636.64 2999.5,-6646.64 3006.5,-6646.64"/>
</g>
<!-- l1_mha_allreduce&#45;&gt;l1_mha_residual -->
<g id="edge62" class="edge">
<title>l1_mha_allreduce&#45;&gt;l1_mha_residual</title>
<path fill="none" stroke="black" d="M3345.51,-6540.93C3345.51,-6540.93 3345.51,-6438.51 3345.51,-6438.51"/>
<polygon fill="black" stroke="black" points="3349.01,-6438.51 3345.51,-6428.51 3342.01,-6438.51 3349.01,-6438.51"/>
</g>
<!-- l1_mha_layernorm -->
<g id="node47" class="node">
<title>l1_mha_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="3672,-6288.5 3218,-6288.5 3218,-6220.5 3672,-6220.5 3672,-6288.5"/>
<text text-anchor="middle" x="3445" y="-6273.3" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="3445" y="-6258.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3445" y="-6243.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3445" y="-6228.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l1_mha_residual&#45;&gt;l1_mha_layernorm -->
<g id="edge63" class="edge">
<title>l1_mha_residual&#45;&gt;l1_mha_layernorm</title>
<path fill="none" stroke="black" d="M3445,-6360.25C3445,-6360.25 3445,-6298.88 3445,-6298.88"/>
<polygon fill="black" stroke="black" points="3448.5,-6298.88 3445,-6288.88 3441.5,-6298.88 3448.5,-6298.88"/>
</g>
<!-- l1_ffn_split -->
<g id="node48" class="node">
<title>l1_ffn_split</title>
<polygon fill="lightyellow" stroke="black" points="3806.42,-6148.5 3023.09,-6148.5 2821.58,-6012.5 3604.91,-6012.5 3806.42,-6148.5"/>
<text text-anchor="middle" x="3314" y="-6099.3" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Input Split</text>
<text text-anchor="middle" x="3314" y="-6084.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3314" y="-6069.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="3314" y="-6054.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4&#45;7</text>
</g>
<!-- l1_mha_layernorm&#45;&gt;l1_ffn_split -->
<g id="edge64" class="edge">
<title>l1_mha_layernorm&#45;&gt;l1_ffn_split</title>
<path fill="none" stroke="black" d="M3445,-6220.12C3445,-6220.12 3445,-6158.64 3445,-6158.64"/>
<polygon fill="black" stroke="black" points="3448.5,-6158.64 3445,-6148.64 3441.5,-6158.64 3448.5,-6158.64"/>
</g>
<!-- l1_ffn_residual -->
<g id="node66" class="node">
<title>l1_ffn_residual</title>
<polygon fill="lightgreen" stroke="black" points="4488,-5312.5 4014,-5312.5 4014,-5244.5 4488,-5244.5 4488,-5312.5"/>
<text text-anchor="middle" x="4251" y="-5297.3" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4251" y="-5282.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096] (x2)</text>
<text text-anchor="middle" x="4251" y="-5267.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4251" y="-5252.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l1_mha_layernorm&#45;&gt;l1_ffn_residual -->
<g id="edge89" class="edge">
<title>l1_mha_layernorm&#45;&gt;l1_ffn_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3672.19,-6254C4014.13,-6254 4621.5,-6254 4621.5,-6254 4621.5,-6254 4621.5,-5278 4621.5,-5278 4621.5,-5278 4498,-5278 4498,-5278"/>
<polygon fill="black" stroke="black" points="4498,-5274.5 4488,-5278 4498,-5281.5 4498,-5274.5"/>
</g>
<!-- l1_ffn_up_4 -->
<g id="node49" class="node">
<title>l1_ffn_up_4</title>
<polygon fill="lightgreen" stroke="black" points="5126.5,-5940.5 4639.5,-5940.5 4639.5,-5872.5 5126.5,-5872.5 5126.5,-5940.5"/>
<text text-anchor="middle" x="4883" y="-5925.3" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="4883" y="-5910.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4883" y="-5895.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4883" y="-5880.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_ffn_split&#45;&gt;l1_ffn_up_4 -->
<g id="edge65" class="edge">
<title>l1_ffn_split&#45;&gt;l1_ffn_up_4</title>
<path fill="none" stroke="black" d="M3739.11,-6103C4203.76,-6103 4883,-6103 4883,-6103 4883,-6103 4883,-5950.73 4883,-5950.73"/>
<polygon fill="black" stroke="black" points="4886.5,-5950.73 4883,-5940.73 4879.5,-5950.73 4886.5,-5950.73"/>
</g>
<!-- l1_ffn_up_5 -->
<g id="node50" class="node">
<title>l1_ffn_up_5</title>
<polygon fill="lightgreen" stroke="black" points="1465.5,-5940.5 978.5,-5940.5 978.5,-5872.5 1465.5,-5872.5 1465.5,-5940.5"/>
<text text-anchor="middle" x="1222" y="-5925.3" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="1222" y="-5910.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1222" y="-5895.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1222" y="-5880.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_ffn_split&#45;&gt;l1_ffn_up_5 -->
<g id="edge66" class="edge">
<title>l1_ffn_split&#45;&gt;l1_ffn_up_5</title>
<path fill="none" stroke="black" d="M2971.77,-6114C2423.8,-6114 1410.5,-6114 1410.5,-6114 1410.5,-6114 1410.5,-5950.76 1410.5,-5950.76"/>
<polygon fill="black" stroke="black" points="1414,-5950.76 1410.5,-5940.76 1407,-5950.76 1414,-5950.76"/>
</g>
<!-- l1_ffn_up_6 -->
<g id="node51" class="node">
<title>l1_ffn_up_6</title>
<polygon fill="lightgreen" stroke="black" points="2511.5,-5940.5 2024.5,-5940.5 2024.5,-5872.5 2511.5,-5872.5 2511.5,-5940.5"/>
<text text-anchor="middle" x="2268" y="-5925.3" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="2268" y="-5910.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2268" y="-5895.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="2268" y="-5880.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_ffn_split&#45;&gt;l1_ffn_up_6 -->
<g id="edge67" class="edge">
<title>l1_ffn_split&#45;&gt;l1_ffn_up_6</title>
<path fill="none" stroke="black" d="M2870.95,-6046C2613.52,-6046 2339.5,-6046 2339.5,-6046 2339.5,-6046 2339.5,-5950.63 2339.5,-5950.63"/>
<polygon fill="black" stroke="black" points="2343,-5950.63 2339.5,-5940.63 2336,-5950.63 2343,-5950.63"/>
</g>
<!-- l1_ffn_up_7 -->
<g id="node52" class="node">
<title>l1_ffn_up_7</title>
<polygon fill="lightgreen" stroke="black" points="3557.5,-5940.5 3070.5,-5940.5 3070.5,-5872.5 3557.5,-5872.5 3557.5,-5940.5"/>
<text text-anchor="middle" x="3314" y="-5925.3" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="3314" y="-5910.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3314" y="-5895.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3314" y="-5880.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_ffn_split&#45;&gt;l1_ffn_up_7 -->
<g id="edge68" class="edge">
<title>l1_ffn_split&#45;&gt;l1_ffn_up_7</title>
<path fill="none" stroke="black" d="M3314,-6012.23C3314,-6012.23 3314,-5950.61 3314,-5950.61"/>
<polygon fill="black" stroke="black" points="3317.5,-5950.61 3314,-5940.61 3310.5,-5950.61 3317.5,-5950.61"/>
</g>
<!-- l1_ffn_gate_4 -->
<g id="node53" class="node">
<title>l1_ffn_gate_4</title>
<polygon fill="lightgreen" stroke="black" points="4603.5,-5940.5 4116.5,-5940.5 4116.5,-5872.5 4603.5,-5872.5 4603.5,-5940.5"/>
<text text-anchor="middle" x="4360" y="-5925.3" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="4360" y="-5910.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4360" y="-5895.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4360" y="-5880.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_ffn_split&#45;&gt;l1_ffn_gate_4 -->
<g id="edge69" class="edge">
<title>l1_ffn_split&#45;&gt;l1_ffn_gate_4</title>
<path fill="none" stroke="black" d="M3670.89,-6057C3894.29,-6057 4140,-6057 4140,-6057 4140,-6057 4140,-5950.65 4140,-5950.65"/>
<polygon fill="black" stroke="black" points="4143.5,-5950.65 4140,-5940.65 4136.5,-5950.65 4143.5,-5950.65"/>
</g>
<!-- l1_ffn_gate_5 -->
<g id="node54" class="node">
<title>l1_ffn_gate_5</title>
<polygon fill="lightgreen" stroke="black" points="1988.5,-5940.5 1501.5,-5940.5 1501.5,-5872.5 1988.5,-5872.5 1988.5,-5940.5"/>
<text text-anchor="middle" x="1745" y="-5925.3" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="1745" y="-5910.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1745" y="-5895.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1745" y="-5880.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_ffn_split&#45;&gt;l1_ffn_gate_5 -->
<g id="edge70" class="edge">
<title>l1_ffn_split&#45;&gt;l1_ffn_gate_5</title>
<path fill="none" stroke="black" d="M2921.29,-6080C2470.04,-6080 1791,-6080 1791,-6080 1791,-6080 1791,-5950.78 1791,-5950.78"/>
<polygon fill="black" stroke="black" points="1794.5,-5950.78 1791,-5940.78 1787.5,-5950.78 1794.5,-5950.78"/>
</g>
<!-- l1_ffn_gate_6 -->
<g id="node55" class="node">
<title>l1_ffn_gate_6</title>
<polygon fill="lightgreen" stroke="black" points="3034.5,-5940.5 2547.5,-5940.5 2547.5,-5872.5 3034.5,-5872.5 3034.5,-5940.5"/>
<text text-anchor="middle" x="2791" y="-5925.3" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="2791" y="-5910.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2791" y="-5895.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="2791" y="-5880.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_ffn_split&#45;&gt;l1_ffn_gate_6 -->
<g id="edge71" class="edge">
<title>l1_ffn_split&#45;&gt;l1_ffn_gate_6</title>
<path fill="none" stroke="black" d="M2928.02,-6012.23C2928.02,-6012.23 2928.02,-5950.61 2928.02,-5950.61"/>
<polygon fill="black" stroke="black" points="2931.52,-5950.61 2928.02,-5940.61 2924.52,-5950.61 2931.52,-5950.61"/>
</g>
<!-- l1_ffn_gate_7 -->
<g id="node56" class="node">
<title>l1_ffn_gate_7</title>
<polygon fill="lightgreen" stroke="black" points="4080.5,-5940.5 3593.5,-5940.5 3593.5,-5872.5 4080.5,-5872.5 4080.5,-5940.5"/>
<text text-anchor="middle" x="3837" y="-5925.3" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="3837" y="-5910.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3837" y="-5895.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3837" y="-5880.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_ffn_split&#45;&gt;l1_ffn_gate_7 -->
<g id="edge72" class="edge">
<title>l1_ffn_split&#45;&gt;l1_ffn_gate_7</title>
<path fill="none" stroke="black" d="M3699.98,-6076.54C3699.98,-6076.54 3699.98,-5950.72 3699.98,-5950.72"/>
<polygon fill="black" stroke="black" points="3703.48,-5950.72 3699.98,-5940.72 3696.48,-5950.72 3703.48,-5950.72"/>
</g>
<!-- l1_ffn_act_4 -->
<g id="node57" class="node">
<title>l1_ffn_act_4</title>
<polygon fill="lightgreen" stroke="black" points="4603.5,-5800.5 4116.5,-5800.5 4116.5,-5732.5 4603.5,-5732.5 4603.5,-5800.5"/>
<text text-anchor="middle" x="4360" y="-5785.3" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="4360" y="-5770.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4360" y="-5755.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4360" y="-5740.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_ffn_up_4&#45;&gt;l1_ffn_act_4 -->
<g id="edge73" class="edge">
<title>l1_ffn_up_4&#45;&gt;l1_ffn_act_4</title>
<path fill="none" stroke="black" d="M4691.48,-5872.49C4691.48,-5830.91 4691.48,-5766 4691.48,-5766 4691.48,-5766 4613.52,-5766 4613.52,-5766"/>
<polygon fill="black" stroke="black" points="4613.52,-5762.5 4603.52,-5766 4613.52,-5769.5 4613.52,-5762.5"/>
</g>
<!-- l1_ffn_act_5 -->
<g id="node58" class="node">
<title>l1_ffn_act_5</title>
<polygon fill="lightgreen" stroke="black" points="1988.5,-5800.5 1501.5,-5800.5 1501.5,-5732.5 1988.5,-5732.5 1988.5,-5800.5"/>
<text text-anchor="middle" x="1745" y="-5785.3" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="1745" y="-5770.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1745" y="-5755.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1745" y="-5740.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_ffn_up_5&#45;&gt;l1_ffn_act_5 -->
<g id="edge74" class="edge">
<title>l1_ffn_up_5&#45;&gt;l1_ffn_act_5</title>
<path fill="none" stroke="black" d="M1222,-5872.49C1222,-5830.91 1222,-5766 1222,-5766 1222,-5766 1491.49,-5766 1491.49,-5766"/>
<polygon fill="black" stroke="black" points="1491.49,-5769.5 1501.49,-5766 1491.49,-5762.5 1491.49,-5769.5"/>
</g>
<!-- l1_ffn_act_6 -->
<g id="node59" class="node">
<title>l1_ffn_act_6</title>
<polygon fill="lightgreen" stroke="black" points="3034.5,-5800.5 2547.5,-5800.5 2547.5,-5732.5 3034.5,-5732.5 3034.5,-5800.5"/>
<text text-anchor="middle" x="2791" y="-5785.3" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="2791" y="-5770.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="2791" y="-5755.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="2791" y="-5740.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_ffn_up_6&#45;&gt;l1_ffn_act_6 -->
<g id="edge75" class="edge">
<title>l1_ffn_up_6&#45;&gt;l1_ffn_act_6</title>
<path fill="none" stroke="black" d="M2447.5,-5872.49C2447.5,-5830.91 2447.5,-5766 2447.5,-5766 2447.5,-5766 2537.32,-5766 2537.32,-5766"/>
<polygon fill="black" stroke="black" points="2537.32,-5769.5 2547.32,-5766 2537.32,-5762.5 2537.32,-5769.5"/>
</g>
<!-- l1_ffn_act_7 -->
<g id="node60" class="node">
<title>l1_ffn_act_7</title>
<polygon fill="lightgreen" stroke="black" points="3818.5,-5800.5 3331.5,-5800.5 3331.5,-5732.5 3818.5,-5732.5 3818.5,-5800.5"/>
<text text-anchor="middle" x="3575" y="-5785.3" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="3575" y="-5770.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3575" y="-5755.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3575" y="-5740.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_ffn_up_7&#45;&gt;l1_ffn_act_7 -->
<g id="edge76" class="edge">
<title>l1_ffn_up_7&#45;&gt;l1_ffn_act_7</title>
<path fill="none" stroke="black" d="M3444.5,-5872.25C3444.5,-5872.25 3444.5,-5810.88 3444.5,-5810.88"/>
<polygon fill="black" stroke="black" points="3448,-5810.88 3444.5,-5800.88 3441,-5810.88 3448,-5810.88"/>
</g>
<!-- l1_ffn_gate_4&#45;&gt;l1_ffn_act_4 -->
<g id="edge77" class="edge">
<title>l1_ffn_gate_4&#45;&gt;l1_ffn_act_4</title>
<path fill="none" stroke="black" d="M4360,-5872.25C4360,-5872.25 4360,-5810.88 4360,-5810.88"/>
<polygon fill="black" stroke="black" points="4363.5,-5810.88 4360,-5800.88 4356.5,-5810.88 4363.5,-5810.88"/>
</g>
<!-- l1_ffn_gate_5&#45;&gt;l1_ffn_act_5 -->
<g id="edge78" class="edge">
<title>l1_ffn_gate_5&#45;&gt;l1_ffn_act_5</title>
<path fill="none" stroke="black" d="M1745,-5872.25C1745,-5872.25 1745,-5810.88 1745,-5810.88"/>
<polygon fill="black" stroke="black" points="1748.5,-5810.88 1745,-5800.88 1741.5,-5810.88 1748.5,-5810.88"/>
</g>
<!-- l1_ffn_gate_6&#45;&gt;l1_ffn_act_6 -->
<g id="edge79" class="edge">
<title>l1_ffn_gate_6&#45;&gt;l1_ffn_act_6</title>
<path fill="none" stroke="black" d="M2791,-5872.25C2791,-5872.25 2791,-5810.88 2791,-5810.88"/>
<polygon fill="black" stroke="black" points="2794.5,-5810.88 2791,-5800.88 2787.5,-5810.88 2794.5,-5810.88"/>
</g>
<!-- l1_ffn_gate_7&#45;&gt;l1_ffn_act_7 -->
<g id="edge80" class="edge">
<title>l1_ffn_gate_7&#45;&gt;l1_ffn_act_7</title>
<path fill="none" stroke="black" d="M3706,-5872.25C3706,-5872.25 3706,-5810.88 3706,-5810.88"/>
<polygon fill="black" stroke="black" points="3709.5,-5810.88 3706,-5800.88 3702.5,-5810.88 3709.5,-5810.88"/>
</g>
<!-- l1_ffn_down_4 -->
<g id="node61" class="node">
<title>l1_ffn_down_4</title>
<polygon fill="lightgreen" stroke="black" points="4460.5,-5660.5 3985.5,-5660.5 3985.5,-5592.5 4460.5,-5592.5 4460.5,-5660.5"/>
<text text-anchor="middle" x="4223" y="-5645.3" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="4223" y="-5630.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4223" y="-5615.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4223" y="-5600.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4</text>
</g>
<!-- l1_ffn_act_4&#45;&gt;l1_ffn_down_4 -->
<g id="edge81" class="edge">
<title>l1_ffn_act_4&#45;&gt;l1_ffn_down_4</title>
<path fill="none" stroke="black" d="M4288.5,-5732.25C4288.5,-5732.25 4288.5,-5670.88 4288.5,-5670.88"/>
<polygon fill="black" stroke="black" points="4292,-5670.88 4288.5,-5660.88 4285,-5670.88 4292,-5670.88"/>
</g>
<!-- l1_ffn_down_5 -->
<g id="node62" class="node">
<title>l1_ffn_down_5</title>
<polygon fill="lightgreen" stroke="black" points="2317.5,-5660.5 1842.5,-5660.5 1842.5,-5592.5 2317.5,-5592.5 2317.5,-5660.5"/>
<text text-anchor="middle" x="2080" y="-5645.3" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="2080" y="-5630.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="2080" y="-5615.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2080" y="-5600.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 5</text>
</g>
<!-- l1_ffn_act_5&#45;&gt;l1_ffn_down_5 -->
<g id="edge82" class="edge">
<title>l1_ffn_act_5&#45;&gt;l1_ffn_down_5</title>
<path fill="none" stroke="black" d="M1915.5,-5732.25C1915.5,-5732.25 1915.5,-5670.88 1915.5,-5670.88"/>
<polygon fill="black" stroke="black" points="1919,-5670.88 1915.5,-5660.88 1912,-5670.88 1919,-5670.88"/>
</g>
<!-- l1_ffn_down_6 -->
<g id="node63" class="node">
<title>l1_ffn_down_6</title>
<polygon fill="lightgreen" stroke="black" points="3164.5,-5660.5 2689.5,-5660.5 2689.5,-5592.5 3164.5,-5592.5 3164.5,-5660.5"/>
<text text-anchor="middle" x="2927" y="-5645.3" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="2927" y="-5630.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="2927" y="-5615.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2927" y="-5600.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 6</text>
</g>
<!-- l1_ffn_act_6&#45;&gt;l1_ffn_down_6 -->
<g id="edge83" class="edge">
<title>l1_ffn_act_6&#45;&gt;l1_ffn_down_6</title>
<path fill="none" stroke="black" d="M2862,-5732.25C2862,-5732.25 2862,-5670.88 2862,-5670.88"/>
<polygon fill="black" stroke="black" points="2865.5,-5670.88 2862,-5660.88 2858.5,-5670.88 2865.5,-5670.88"/>
</g>
<!-- l1_ffn_down_7 -->
<g id="node64" class="node">
<title>l1_ffn_down_7</title>
<polygon fill="lightgreen" stroke="black" points="3812.5,-5660.5 3337.5,-5660.5 3337.5,-5592.5 3812.5,-5592.5 3812.5,-5660.5"/>
<text text-anchor="middle" x="3575" y="-5645.3" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="3575" y="-5630.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3575" y="-5615.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3575" y="-5600.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 7</text>
</g>
<!-- l1_ffn_act_7&#45;&gt;l1_ffn_down_7 -->
<g id="edge84" class="edge">
<title>l1_ffn_act_7&#45;&gt;l1_ffn_down_7</title>
<path fill="none" stroke="black" d="M3575,-5732.25C3575,-5732.25 3575,-5670.88 3575,-5670.88"/>
<polygon fill="black" stroke="black" points="3578.5,-5670.88 3575,-5660.88 3571.5,-5670.88 3578.5,-5670.88"/>
</g>
<!-- l1_ffn_allreduce -->
<g id="node65" class="node">
<title>l1_ffn_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="4055.03,-5520.5 3291.41,-5520.5 3094.97,-5384.5 3858.59,-5384.5 4055.03,-5520.5"/>
<text text-anchor="middle" x="3575" y="-5471.3" font-family="Helvetica,sans-Serif" font-size="14.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="3575" y="-5456.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="3575" y="-5441.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3575" y="-5426.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4&#45;7</text>
</g>
<!-- l1_ffn_down_4&#45;&gt;l1_ffn_allreduce -->
<g id="edge85" class="edge">
<title>l1_ffn_down_4&#45;&gt;l1_ffn_allreduce</title>
<path fill="none" stroke="black" d="M4020.26,-5592.12C4020.26,-5592.12 4020.26,-5530.64 4020.26,-5530.64"/>
<polygon fill="black" stroke="black" points="4023.76,-5530.64 4020.26,-5520.64 4016.76,-5530.64 4023.76,-5530.64"/>
</g>
<!-- l1_ffn_down_5&#45;&gt;l1_ffn_allreduce -->
<g id="edge86" class="edge">
<title>l1_ffn_down_5&#45;&gt;l1_ffn_allreduce</title>
<path fill="none" stroke="black" d="M2089,-5592.44C2089,-5541.66 2089,-5452 2089,-5452 2089,-5452 3182.32,-5452 3182.32,-5452"/>
<polygon fill="black" stroke="black" points="3182.32,-5455.5 3192.32,-5452 3182.32,-5448.5 3182.32,-5455.5"/>
</g>
<!-- l1_ffn_down_6&#45;&gt;l1_ffn_allreduce -->
<g id="edge87" class="edge">
<title>l1_ffn_down_6&#45;&gt;l1_ffn_allreduce</title>
<path fill="none" stroke="black" d="M3129.74,-5592.12C3129.74,-5592.12 3129.74,-5462.56 3129.74,-5462.56"/>
<polygon fill="black" stroke="black" points="3133.24,-5462.56 3129.74,-5452.56 3126.24,-5462.56 3133.24,-5462.56"/>
</g>
<!-- l1_ffn_down_7&#45;&gt;l1_ffn_allreduce -->
<g id="edge88" class="edge">
<title>l1_ffn_down_7&#45;&gt;l1_ffn_allreduce</title>
<path fill="none" stroke="black" d="M3575,-5592.12C3575,-5592.12 3575,-5530.64 3575,-5530.64"/>
<polygon fill="black" stroke="black" points="3578.5,-5530.64 3575,-5520.64 3571.5,-5530.64 3578.5,-5530.64"/>
</g>
<!-- l1_ffn_allreduce&#45;&gt;l1_ffn_residual -->
<g id="edge90" class="edge">
<title>l1_ffn_allreduce&#45;&gt;l1_ffn_residual</title>
<path fill="none" stroke="black" d="M4034.51,-5452.37C4034.51,-5452.37 4034.51,-5322.75 4034.51,-5322.75"/>
<polygon fill="black" stroke="black" points="4038.01,-5322.75 4034.51,-5312.75 4031.01,-5322.75 4038.01,-5322.75"/>
</g>
<!-- l1_layernorm -->
<g id="node67" class="node">
<title>l1_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="4478,-5172.5 4024,-5172.5 4024,-5104.5 4478,-5104.5 4478,-5172.5"/>
<text text-anchor="middle" x="4251" y="-5157.3" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="4251" y="-5142.3" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4251" y="-5127.3" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4251" y="-5112.3" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l1_ffn_residual&#45;&gt;l1_layernorm -->
<g id="edge91" class="edge">
<title>l1_ffn_residual&#45;&gt;l1_layernorm</title>
<path fill="none" stroke="black" d="M4251,-5244.25C4251,-5244.25 4251,-5182.88 4251,-5182.88"/>
<polygon fill="black" stroke="black" points="4254.5,-5182.88 4251,-5172.88 4247.5,-5182.88 4254.5,-5182.88"/>
</g>
<!-- send_l1_l2 -->
<g id="node136" class="node">
<title>send_l1_l2</title>
<ellipse fill="orange" stroke="black" cx="4251" cy="-4984.42" rx="321.05" ry="48.17"/>
<text text-anchor="middle" x="4251" y="-5003.22" font-family="Helvetica,sans-Serif" font-size="14.00">Pipeline Send</text>
<text text-anchor="middle" x="4251" y="-4988.22" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4251" y="-4973.22" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4251" y="-4958.22" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- l1_layernorm&#45;&gt;send_l1_l2 -->
<g id="edge92" class="edge">
<title>l1_layernorm&#45;&gt;send_l1_l2</title>
<path fill="none" stroke="black" d="M4251,-5104.3C4251,-5104.3 4251,-5042.54 4251,-5042.54"/>
<polygon fill="black" stroke="black" points="4254.5,-5042.54 4251,-5032.54 4247.5,-5042.54 4254.5,-5042.54"/>
</g>
<!-- l2_input_broadcast -->
<g id="node68" class="node">
<title>l2_input_broadcast</title>
<polygon fill="lightyellow" stroke="black" points="4743.42,-4864.33 3960.09,-4864.33 3758.58,-4728.33 4541.91,-4728.33 4743.42,-4864.33"/>
<text text-anchor="middle" x="4251" y="-4815.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input Broadcast</text>
<text text-anchor="middle" x="4251" y="-4800.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4251" y="-4785.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]×4</text>
<text text-anchor="middle" x="4251" y="-4770.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;11</text>
</g>
<!-- l2_mha_split -->
<g id="node69" class="node">
<title>l2_mha_split</title>
<polygon fill="lightyellow" stroke="black" points="4577.42,-4656.33 3794.09,-4656.33 3592.58,-4520.33 4375.91,-4520.33 4577.42,-4656.33"/>
<text text-anchor="middle" x="4085" y="-4607.13" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Input Split</text>
<text text-anchor="middle" x="4085" y="-4592.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4085" y="-4577.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="4085" y="-4562.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;11</text>
</g>
<!-- l2_input_broadcast&#45;&gt;l2_mha_split -->
<g id="edge94" class="edge">
<title>l2_input_broadcast&#45;&gt;l2_mha_split</title>
<path fill="none" stroke="black" d="M4168,-4728.23C4168,-4728.23 4168,-4666.59 4168,-4666.59"/>
<polygon fill="black" stroke="black" points="4171.5,-4666.59 4168,-4656.59 4164.5,-4666.59 4171.5,-4666.59"/>
</g>
<!-- l2_mha_residual -->
<g id="node79" class="node">
<title>l2_mha_residual</title>
<polygon fill="lightgreen" stroke="black" points="4764,-3960.33 4290,-3960.33 4290,-3892.33 4764,-3892.33 4764,-3960.33"/>
<text text-anchor="middle" x="4527" y="-3945.13" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4527" y="-3930.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096] (x2)</text>
<text text-anchor="middle" x="4527" y="-3915.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4527" y="-3900.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l2_input_broadcast&#45;&gt;l2_mha_residual -->
<g id="edge107" class="edge">
<title>l2_input_broadcast&#45;&gt;l2_mha_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4642.26,-4796C4800.93,-4796 4947.5,-4796 4947.5,-4796 4947.5,-4796 4947.5,-3926 4947.5,-3926 4947.5,-3926 4774.29,-3926 4774.29,-3926"/>
<polygon fill="black" stroke="black" points="4774.29,-3922.5 4764.29,-3926 4774.29,-3929.5 4774.29,-3922.5"/>
</g>
<!-- l2_mha_qkv_8 -->
<g id="node70" class="node">
<title>l2_mha_qkv_8</title>
<polygon fill="lightgreen" stroke="black" points="4932.5,-4448.33 4391.5,-4448.33 4391.5,-4380.33 4932.5,-4380.33 4932.5,-4448.33"/>
<text text-anchor="middle" x="4662" y="-4433.13" font-family="Helvetica,sans-Serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="4662" y="-4418.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4662" y="-4403.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="4662" y="-4388.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_mha_split&#45;&gt;l2_mha_qkv_8 -->
<g id="edge95" class="edge">
<title>l2_mha_split&#45;&gt;l2_mha_qkv_8</title>
<path fill="none" stroke="black" d="M4484.48,-4588.21C4484.48,-4588.21 4484.48,-4458.58 4484.48,-4458.58"/>
<polygon fill="black" stroke="black" points="4487.98,-4458.58 4484.48,-4448.58 4480.98,-4458.58 4487.98,-4458.58"/>
</g>
<!-- l2_mha_qkv_9 -->
<g id="node71" class="node">
<title>l2_mha_qkv_9</title>
<polygon fill="lightgreen" stroke="black" points="3201.5,-4448.33 2660.5,-4448.33 2660.5,-4380.33 3201.5,-4380.33 3201.5,-4448.33"/>
<text text-anchor="middle" x="2931" y="-4433.13" font-family="Helvetica,sans-Serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="2931" y="-4418.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2931" y="-4403.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="2931" y="-4388.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_mha_split&#45;&gt;l2_mha_qkv_9 -->
<g id="edge96" class="edge">
<title>l2_mha_split&#45;&gt;l2_mha_qkv_9</title>
<path fill="none" stroke="black" d="M3692.82,-4588C3436.21,-4588 3148.24,-4588 3148.24,-4588 3148.24,-4588 3148.24,-4458.64 3148.24,-4458.64"/>
<polygon fill="black" stroke="black" points="3151.74,-4458.64 3148.24,-4448.64 3144.74,-4458.64 3151.74,-4458.64"/>
</g>
<!-- l2_mha_qkv_10 -->
<g id="node72" class="node">
<title>l2_mha_qkv_10</title>
<polygon fill="lightgreen" stroke="black" points="3778.5,-4448.33 3237.5,-4448.33 3237.5,-4380.33 3778.5,-4380.33 3778.5,-4448.33"/>
<text text-anchor="middle" x="3508" y="-4433.13" font-family="Helvetica,sans-Serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="3508" y="-4418.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3508" y="-4403.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="3508" y="-4388.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_mha_split&#45;&gt;l2_mha_qkv_10 -->
<g id="edge97" class="edge">
<title>l2_mha_split&#45;&gt;l2_mha_qkv_10</title>
<path fill="none" stroke="black" d="M3685.52,-4520.06C3685.52,-4520.06 3685.52,-4458.44 3685.52,-4458.44"/>
<polygon fill="black" stroke="black" points="3689.02,-4458.44 3685.52,-4448.44 3682.02,-4458.44 3689.02,-4458.44"/>
</g>
<!-- l2_mha_qkv_11 -->
<g id="node73" class="node">
<title>l2_mha_qkv_11</title>
<polygon fill="lightgreen" stroke="black" points="4355.5,-4448.33 3814.5,-4448.33 3814.5,-4380.33 4355.5,-4380.33 4355.5,-4448.33"/>
<text text-anchor="middle" x="4085" y="-4433.13" font-family="Helvetica,sans-Serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="4085" y="-4418.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4085" y="-4403.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="4085" y="-4388.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_mha_split&#45;&gt;l2_mha_qkv_11 -->
<g id="edge98" class="edge">
<title>l2_mha_split&#45;&gt;l2_mha_qkv_11</title>
<path fill="none" stroke="black" d="M4085,-4520.06C4085,-4520.06 4085,-4458.44 4085,-4458.44"/>
<polygon fill="black" stroke="black" points="4088.5,-4458.44 4085,-4448.44 4081.5,-4458.44 4088.5,-4458.44"/>
</g>
<!-- l2_mha_attn_8 -->
<g id="node74" class="node">
<title>l2_mha_attn_8</title>
<polygon fill="lightgreen" stroke="black" points="4920.5,-4308.33 4391.5,-4308.33 4391.5,-4240.33 4920.5,-4240.33 4920.5,-4308.33"/>
<text text-anchor="middle" x="4656" y="-4293.13" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="4656" y="-4278.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="4656" y="-4263.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4656" y="-4248.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_mha_qkv_8&#45;&gt;l2_mha_attn_8 -->
<g id="edge99" class="edge">
<title>l2_mha_qkv_8&#45;&gt;l2_mha_attn_8</title>
<path fill="none" stroke="black" d="M4656,-4380.09C4656,-4380.09 4656,-4318.71 4656,-4318.71"/>
<polygon fill="black" stroke="black" points="4659.5,-4318.71 4656,-4308.71 4652.5,-4318.71 4659.5,-4318.71"/>
</g>
<!-- l2_mha_attn_9 -->
<g id="node75" class="node">
<title>l2_mha_attn_9</title>
<polygon fill="lightgreen" stroke="black" points="3201.5,-4308.33 2672.5,-4308.33 2672.5,-4240.33 3201.5,-4240.33 3201.5,-4308.33"/>
<text text-anchor="middle" x="2937" y="-4293.13" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="2937" y="-4278.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="2937" y="-4263.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2937" y="-4248.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_mha_qkv_9&#45;&gt;l2_mha_attn_9 -->
<g id="edge100" class="edge">
<title>l2_mha_qkv_9&#45;&gt;l2_mha_attn_9</title>
<path fill="none" stroke="black" d="M2937,-4380.09C2937,-4380.09 2937,-4318.71 2937,-4318.71"/>
<polygon fill="black" stroke="black" points="2940.5,-4318.71 2937,-4308.71 2933.5,-4318.71 2940.5,-4318.71"/>
</g>
<!-- l2_mha_attn_10 -->
<g id="node76" class="node">
<title>l2_mha_attn_10</title>
<polygon fill="lightgreen" stroke="black" points="3778.5,-4308.33 3249.5,-4308.33 3249.5,-4240.33 3778.5,-4240.33 3778.5,-4308.33"/>
<text text-anchor="middle" x="3514" y="-4293.13" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="3514" y="-4278.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="3514" y="-4263.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3514" y="-4248.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_mha_qkv_10&#45;&gt;l2_mha_attn_10 -->
<g id="edge101" class="edge">
<title>l2_mha_qkv_10&#45;&gt;l2_mha_attn_10</title>
<path fill="none" stroke="black" d="M3514,-4380.09C3514,-4380.09 3514,-4318.71 3514,-4318.71"/>
<polygon fill="black" stroke="black" points="3517.5,-4318.71 3514,-4308.71 3510.5,-4318.71 3517.5,-4318.71"/>
</g>
<!-- l2_mha_attn_11 -->
<g id="node77" class="node">
<title>l2_mha_attn_11</title>
<polygon fill="lightgreen" stroke="black" points="4349.5,-4308.33 3820.5,-4308.33 3820.5,-4240.33 4349.5,-4240.33 4349.5,-4308.33"/>
<text text-anchor="middle" x="4085" y="-4293.13" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="4085" y="-4278.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="4085" y="-4263.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4085" y="-4248.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_mha_qkv_11&#45;&gt;l2_mha_attn_11 -->
<g id="edge102" class="edge">
<title>l2_mha_qkv_11&#45;&gt;l2_mha_attn_11</title>
<path fill="none" stroke="black" d="M4085,-4380.09C4085,-4380.09 4085,-4318.71 4085,-4318.71"/>
<polygon fill="black" stroke="black" points="4088.5,-4318.71 4085,-4308.71 4081.5,-4318.71 4088.5,-4318.71"/>
</g>
<!-- l2_mha_allreduce -->
<g id="node78" class="node">
<title>l2_mha_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="4565.03,-4168.33 3801.41,-4168.33 3604.97,-4032.33 4368.59,-4032.33 4565.03,-4168.33"/>
<text text-anchor="middle" x="4085" y="-4119.13" font-family="Helvetica,sans-Serif" font-size="14.00">MHA All&#45;Reduce</text>
<text text-anchor="middle" x="4085" y="-4104.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="4085" y="-4089.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4085" y="-4074.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;11</text>
</g>
<!-- l2_mha_attn_8&#45;&gt;l2_mha_allreduce -->
<g id="edge103" class="edge">
<title>l2_mha_attn_8&#45;&gt;l2_mha_allreduce</title>
<path fill="none" stroke="black" d="M4478.26,-4239.96C4478.26,-4239.96 4478.26,-4178.47 4478.26,-4178.47"/>
<polygon fill="black" stroke="black" points="4481.76,-4178.47 4478.26,-4168.47 4474.76,-4178.47 4481.76,-4178.47"/>
</g>
<!-- l2_mha_attn_9&#45;&gt;l2_mha_allreduce -->
<g id="edge104" class="edge">
<title>l2_mha_attn_9&#45;&gt;l2_mha_allreduce</title>
<path fill="none" stroke="black" d="M3054,-4240.31C3054,-4189.57 3054,-4100 3054,-4100 3054,-4100 3692.56,-4100 3692.56,-4100"/>
<polygon fill="black" stroke="black" points="3692.56,-4103.5 3702.56,-4100 3692.56,-4096.5 3692.56,-4103.5"/>
</g>
<!-- l2_mha_attn_10&#45;&gt;l2_mha_allreduce -->
<g id="edge105" class="edge">
<title>l2_mha_attn_10&#45;&gt;l2_mha_allreduce</title>
<path fill="none" stroke="black" d="M3691.74,-4239.96C3691.74,-4239.96 3691.74,-4110.4 3691.74,-4110.4"/>
<polygon fill="black" stroke="black" points="3695.24,-4110.4 3691.74,-4100.4 3688.24,-4110.4 3695.24,-4110.4"/>
</g>
<!-- l2_mha_attn_11&#45;&gt;l2_mha_allreduce -->
<g id="edge106" class="edge">
<title>l2_mha_attn_11&#45;&gt;l2_mha_allreduce</title>
<path fill="none" stroke="black" d="M4085,-4239.96C4085,-4239.96 4085,-4178.47 4085,-4178.47"/>
<polygon fill="black" stroke="black" points="4088.5,-4178.47 4085,-4168.47 4081.5,-4178.47 4088.5,-4178.47"/>
</g>
<!-- l2_mha_allreduce&#45;&gt;l2_mha_residual -->
<g id="edge108" class="edge">
<title>l2_mha_allreduce&#45;&gt;l2_mha_residual</title>
<path fill="none" stroke="black" d="M4427.51,-4072.76C4427.51,-4072.76 4427.51,-3970.35 4427.51,-3970.35"/>
<polygon fill="black" stroke="black" points="4431.01,-3970.35 4427.51,-3960.35 4424.01,-3970.35 4431.01,-3970.35"/>
</g>
<!-- l2_mha_layernorm -->
<g id="node80" class="node">
<title>l2_mha_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="4754,-3820.33 4300,-3820.33 4300,-3752.33 4754,-3752.33 4754,-3820.33"/>
<text text-anchor="middle" x="4527" y="-3805.13" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="4527" y="-3790.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4527" y="-3775.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4527" y="-3760.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l2_mha_residual&#45;&gt;l2_mha_layernorm -->
<g id="edge109" class="edge">
<title>l2_mha_residual&#45;&gt;l2_mha_layernorm</title>
<path fill="none" stroke="black" d="M4527,-3892.09C4527,-3892.09 4527,-3830.71 4527,-3830.71"/>
<polygon fill="black" stroke="black" points="4530.5,-3830.71 4527,-3820.71 4523.5,-3830.71 4530.5,-3830.71"/>
</g>
<!-- l2_ffn_split -->
<g id="node81" class="node">
<title>l2_ffn_split</title>
<polygon fill="lightyellow" stroke="black" points="4688.42,-3680.33 3905.09,-3680.33 3703.58,-3544.33 4486.91,-3544.33 4688.42,-3680.33"/>
<text text-anchor="middle" x="4196" y="-3631.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Input Split</text>
<text text-anchor="middle" x="4196" y="-3616.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4196" y="-3601.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="4196" y="-3586.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;11</text>
</g>
<!-- l2_mha_layernorm&#45;&gt;l2_ffn_split -->
<g id="edge110" class="edge">
<title>l2_mha_layernorm&#45;&gt;l2_ffn_split</title>
<path fill="none" stroke="black" d="M4494.23,-3751.96C4494.23,-3751.96 4494.23,-3690.47 4494.23,-3690.47"/>
<polygon fill="black" stroke="black" points="4497.73,-3690.47 4494.23,-3680.47 4490.73,-3690.47 4497.73,-3690.47"/>
</g>
<!-- l2_ffn_residual -->
<g id="node99" class="node">
<title>l2_ffn_residual</title>
<polygon fill="lightgreen" stroke="black" points="4734,-2844.33 4260,-2844.33 4260,-2776.33 4734,-2776.33 4734,-2844.33"/>
<text text-anchor="middle" x="4497" y="-2829.13" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4497" y="-2814.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096] (x2)</text>
<text text-anchor="middle" x="4497" y="-2799.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4497" y="-2784.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l2_mha_layernorm&#45;&gt;l2_ffn_residual -->
<g id="edge135" class="edge">
<title>l2_mha_layernorm&#45;&gt;l2_ffn_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4754.08,-3786C4867.35,-3786 4980.5,-3786 4980.5,-3786 4980.5,-3786 4980.5,-3368 4980.5,-3368 4980.5,-3368 4705.01,-3368 4705.01,-3368 4705.01,-3368 4705.01,-2854.38 4705.01,-2854.38"/>
<polygon fill="black" stroke="black" points="4708.51,-2854.38 4705.01,-2844.38 4701.51,-2854.38 4708.51,-2854.38"/>
</g>
<!-- l2_ffn_up_8 -->
<g id="node82" class="node">
<title>l2_ffn_up_8</title>
<polygon fill="lightgreen" stroke="black" points="6008.5,-3472.33 5521.5,-3472.33 5521.5,-3404.33 6008.5,-3404.33 6008.5,-3472.33"/>
<text text-anchor="middle" x="5765" y="-3457.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="5765" y="-3442.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="5765" y="-3427.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="5765" y="-3412.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_ffn_split&#45;&gt;l2_ffn_up_8 -->
<g id="edge111" class="edge">
<title>l2_ffn_split&#45;&gt;l2_ffn_up_8</title>
<path fill="none" stroke="black" d="M4619.82,-3634C5084.5,-3634 5765,-3634 5765,-3634 5765,-3634 5765,-3482.42 5765,-3482.42"/>
<polygon fill="black" stroke="black" points="5768.5,-3482.42 5765,-3472.42 5761.5,-3482.42 5768.5,-3482.42"/>
</g>
<!-- l2_ffn_up_9 -->
<g id="node83" class="node">
<title>l2_ffn_up_9</title>
<polygon fill="lightgreen" stroke="black" points="2347.5,-3472.33 1860.5,-3472.33 1860.5,-3404.33 2347.5,-3404.33 2347.5,-3472.33"/>
<text text-anchor="middle" x="2104" y="-3457.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="2104" y="-3442.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2104" y="-3427.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="2104" y="-3412.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_ffn_split&#45;&gt;l2_ffn_up_9 -->
<g id="edge112" class="edge">
<title>l2_ffn_split&#45;&gt;l2_ffn_up_9</title>
<path fill="none" stroke="black" d="M3854.21,-3646C3316.23,-3646 2332.5,-3646 2332.5,-3646 2332.5,-3646 2332.5,-3482.63 2332.5,-3482.63"/>
<polygon fill="black" stroke="black" points="2336,-3482.62 2332.5,-3472.63 2329,-3482.63 2336,-3482.62"/>
</g>
<!-- l2_ffn_up_10 -->
<g id="node84" class="node">
<title>l2_ffn_up_10</title>
<polygon fill="lightgreen" stroke="black" points="3393.5,-3472.33 2906.5,-3472.33 2906.5,-3404.33 3393.5,-3404.33 3393.5,-3472.33"/>
<text text-anchor="middle" x="3150" y="-3457.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="3150" y="-3442.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3150" y="-3427.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3150" y="-3412.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_ffn_split&#45;&gt;l2_ffn_up_10 -->
<g id="edge113" class="edge">
<title>l2_ffn_split&#45;&gt;l2_ffn_up_10</title>
<path fill="none" stroke="black" d="M3753.31,-3578C3536.51,-3578 3321.5,-3578 3321.5,-3578 3321.5,-3578 3321.5,-3482.5 3321.5,-3482.5"/>
<polygon fill="black" stroke="black" points="3325,-3482.5 3321.5,-3472.5 3318,-3482.5 3325,-3482.5"/>
</g>
<!-- l2_ffn_up_11 -->
<g id="node85" class="node">
<title>l2_ffn_up_11</title>
<polygon fill="lightgreen" stroke="black" points="4439.5,-3472.33 3952.5,-3472.33 3952.5,-3404.33 4439.5,-3404.33 4439.5,-3472.33"/>
<text text-anchor="middle" x="4196" y="-3457.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="4196" y="-3442.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4196" y="-3427.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4196" y="-3412.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_ffn_split&#45;&gt;l2_ffn_up_11 -->
<g id="edge114" class="edge">
<title>l2_ffn_split&#45;&gt;l2_ffn_up_11</title>
<path fill="none" stroke="black" d="M4196,-3544.06C4196,-3544.06 4196,-3482.44 4196,-3482.44"/>
<polygon fill="black" stroke="black" points="4199.5,-3482.44 4196,-3472.44 4192.5,-3482.44 4199.5,-3482.44"/>
</g>
<!-- l2_ffn_gate_8 -->
<g id="node86" class="node">
<title>l2_ffn_gate_8</title>
<polygon fill="lightgreen" stroke="black" points="5485.5,-3472.33 4998.5,-3472.33 4998.5,-3404.33 5485.5,-3404.33 5485.5,-3472.33"/>
<text text-anchor="middle" x="5242" y="-3457.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="5242" y="-3442.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="5242" y="-3427.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="5242" y="-3412.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_ffn_split&#45;&gt;l2_ffn_gate_8 -->
<g id="edge115" class="edge">
<title>l2_ffn_split&#45;&gt;l2_ffn_gate_8</title>
<path fill="none" stroke="black" d="M4553.13,-3589C4791.89,-3589 5062.5,-3589 5062.5,-3589 5062.5,-3589 5062.5,-3482.52 5062.5,-3482.52"/>
<polygon fill="black" stroke="black" points="5066,-3482.52 5062.5,-3472.52 5059,-3482.52 5066,-3482.52"/>
</g>
<!-- l2_ffn_gate_9 -->
<g id="node87" class="node">
<title>l2_ffn_gate_9</title>
<polygon fill="lightgreen" stroke="black" points="2870.5,-3472.33 2383.5,-3472.33 2383.5,-3404.33 2870.5,-3404.33 2870.5,-3472.33"/>
<text text-anchor="middle" x="2627" y="-3457.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="2627" y="-3442.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2627" y="-3427.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="2627" y="-3412.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_ffn_split&#45;&gt;l2_ffn_gate_9 -->
<g id="edge116" class="edge">
<title>l2_ffn_split&#45;&gt;l2_ffn_gate_9</title>
<path fill="none" stroke="black" d="M3803.45,-3612C3381.79,-3612 2771.5,-3612 2771.5,-3612 2771.5,-3612 2771.5,-3482.64 2771.5,-3482.64"/>
<polygon fill="black" stroke="black" points="2775,-3482.64 2771.5,-3472.64 2768,-3482.64 2775,-3482.64"/>
</g>
<!-- l2_ffn_gate_10 -->
<g id="node88" class="node">
<title>l2_ffn_gate_10</title>
<polygon fill="lightgreen" stroke="black" points="3916.5,-3472.33 3429.5,-3472.33 3429.5,-3404.33 3916.5,-3404.33 3916.5,-3472.33"/>
<text text-anchor="middle" x="3673" y="-3457.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="3673" y="-3442.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3673" y="-3427.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3673" y="-3412.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_ffn_split&#45;&gt;l2_ffn_gate_10 -->
<g id="edge117" class="edge">
<title>l2_ffn_split&#45;&gt;l2_ffn_gate_10</title>
<path fill="none" stroke="black" d="M3810.02,-3544.06C3810.02,-3544.06 3810.02,-3482.44 3810.02,-3482.44"/>
<polygon fill="black" stroke="black" points="3813.52,-3482.44 3810.02,-3472.44 3806.52,-3482.44 3813.52,-3482.44"/>
</g>
<!-- l2_ffn_gate_11 -->
<g id="node89" class="node">
<title>l2_ffn_gate_11</title>
<polygon fill="lightgreen" stroke="black" points="4962.5,-3472.33 4475.5,-3472.33 4475.5,-3404.33 4962.5,-3404.33 4962.5,-3472.33"/>
<text text-anchor="middle" x="4719" y="-3457.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="4719" y="-3442.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4719" y="-3427.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4719" y="-3412.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_ffn_split&#45;&gt;l2_ffn_gate_11 -->
<g id="edge118" class="edge">
<title>l2_ffn_split&#45;&gt;l2_ffn_gate_11</title>
<path fill="none" stroke="black" d="M4581.98,-3608.37C4581.98,-3608.37 4581.98,-3482.55 4581.98,-3482.55"/>
<polygon fill="black" stroke="black" points="4585.48,-3482.55 4581.98,-3472.55 4578.48,-3482.55 4585.48,-3482.55"/>
</g>
<!-- l2_ffn_act_8 -->
<g id="node90" class="node">
<title>l2_ffn_act_8</title>
<polygon fill="lightgreen" stroke="black" points="5485.5,-3332.33 4998.5,-3332.33 4998.5,-3264.33 5485.5,-3264.33 5485.5,-3332.33"/>
<text text-anchor="middle" x="5242" y="-3317.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="5242" y="-3302.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="5242" y="-3287.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="5242" y="-3272.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_ffn_up_8&#45;&gt;l2_ffn_act_8 -->
<g id="edge119" class="edge">
<title>l2_ffn_up_8&#45;&gt;l2_ffn_act_8</title>
<path fill="none" stroke="black" d="M5614,-3404C5614,-3362.46 5614,-3298 5614,-3298 5614,-3298 5495.72,-3298 5495.72,-3298"/>
<polygon fill="black" stroke="black" points="5495.72,-3294.5 5485.72,-3298 5495.72,-3301.5 5495.72,-3294.5"/>
</g>
<!-- l2_ffn_act_9 -->
<g id="node91" class="node">
<title>l2_ffn_act_9</title>
<polygon fill="lightgreen" stroke="black" points="2870.5,-3332.33 2383.5,-3332.33 2383.5,-3264.33 2870.5,-3264.33 2870.5,-3332.33"/>
<text text-anchor="middle" x="2627" y="-3317.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="2627" y="-3302.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="2627" y="-3287.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="2627" y="-3272.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_ffn_up_9&#45;&gt;l2_ffn_act_9 -->
<g id="edge120" class="edge">
<title>l2_ffn_up_9&#45;&gt;l2_ffn_act_9</title>
<path fill="none" stroke="black" d="M2214.5,-3404C2214.5,-3362.46 2214.5,-3298 2214.5,-3298 2214.5,-3298 2373.47,-3298 2373.47,-3298"/>
<polygon fill="black" stroke="black" points="2373.47,-3301.5 2383.47,-3298 2373.47,-3294.5 2373.47,-3301.5"/>
</g>
<!-- l2_ffn_act_10 -->
<g id="node92" class="node">
<title>l2_ffn_act_10</title>
<polygon fill="lightgreen" stroke="black" points="3916.5,-3332.33 3429.5,-3332.33 3429.5,-3264.33 3916.5,-3264.33 3916.5,-3332.33"/>
<text text-anchor="middle" x="3673" y="-3317.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="3673" y="-3302.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3673" y="-3287.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3673" y="-3272.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_ffn_up_10&#45;&gt;l2_ffn_act_10 -->
<g id="edge121" class="edge">
<title>l2_ffn_up_10&#45;&gt;l2_ffn_act_10</title>
<path fill="none" stroke="black" d="M3340.5,-3404C3340.5,-3362.46 3340.5,-3298 3340.5,-3298 3340.5,-3298 3419.17,-3298 3419.17,-3298"/>
<polygon fill="black" stroke="black" points="3419.17,-3301.5 3429.17,-3298 3419.17,-3294.5 3419.17,-3301.5"/>
</g>
<!-- l2_ffn_act_11 -->
<g id="node93" class="node">
<title>l2_ffn_act_11</title>
<polygon fill="lightgreen" stroke="black" points="4439.5,-3332.33 3952.5,-3332.33 3952.5,-3264.33 4439.5,-3264.33 4439.5,-3332.33"/>
<text text-anchor="middle" x="4196" y="-3317.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="4196" y="-3302.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4196" y="-3287.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4196" y="-3272.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_ffn_up_11&#45;&gt;l2_ffn_act_11 -->
<g id="edge122" class="edge">
<title>l2_ffn_up_11&#45;&gt;l2_ffn_act_11</title>
<path fill="none" stroke="black" d="M4196,-3404.09C4196,-3404.09 4196,-3342.71 4196,-3342.71"/>
<polygon fill="black" stroke="black" points="4199.5,-3342.71 4196,-3332.71 4192.5,-3342.71 4199.5,-3342.71"/>
</g>
<!-- l2_ffn_gate_8&#45;&gt;l2_ffn_act_8 -->
<g id="edge123" class="edge">
<title>l2_ffn_gate_8&#45;&gt;l2_ffn_act_8</title>
<path fill="none" stroke="black" d="M5242,-3404.09C5242,-3404.09 5242,-3342.71 5242,-3342.71"/>
<polygon fill="black" stroke="black" points="5245.5,-3342.71 5242,-3332.71 5238.5,-3342.71 5245.5,-3342.71"/>
</g>
<!-- l2_ffn_gate_9&#45;&gt;l2_ffn_act_9 -->
<g id="edge124" class="edge">
<title>l2_ffn_gate_9&#45;&gt;l2_ffn_act_9</title>
<path fill="none" stroke="black" d="M2627,-3404.09C2627,-3404.09 2627,-3342.71 2627,-3342.71"/>
<polygon fill="black" stroke="black" points="2630.5,-3342.71 2627,-3332.71 2623.5,-3342.71 2630.5,-3342.71"/>
</g>
<!-- l2_ffn_gate_10&#45;&gt;l2_ffn_act_10 -->
<g id="edge125" class="edge">
<title>l2_ffn_gate_10&#45;&gt;l2_ffn_act_10</title>
<path fill="none" stroke="black" d="M3673,-3404.09C3673,-3404.09 3673,-3342.71 3673,-3342.71"/>
<polygon fill="black" stroke="black" points="3676.5,-3342.71 3673,-3332.71 3669.5,-3342.71 3676.5,-3342.71"/>
</g>
<!-- l2_ffn_gate_11&#45;&gt;l2_ffn_act_11 -->
<g id="edge126" class="edge">
<title>l2_ffn_gate_11&#45;&gt;l2_ffn_act_11</title>
<path fill="none" stroke="black" d="M4575.76,-3404C4575.76,-3362.46 4575.76,-3298 4575.76,-3298 4575.76,-3298 4449.73,-3298 4449.73,-3298"/>
<polygon fill="black" stroke="black" points="4449.73,-3294.5 4439.73,-3298 4449.73,-3301.5 4449.73,-3294.5"/>
</g>
<!-- l2_ffn_down_8 -->
<g id="node94" class="node">
<title>l2_ffn_down_8</title>
<polygon fill="lightgreen" stroke="black" points="5212.5,-3192.33 4737.5,-3192.33 4737.5,-3124.33 5212.5,-3124.33 5212.5,-3192.33"/>
<text text-anchor="middle" x="4975" y="-3177.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="4975" y="-3162.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4975" y="-3147.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4975" y="-3132.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8</text>
</g>
<!-- l2_ffn_act_8&#45;&gt;l2_ffn_down_8 -->
<g id="edge127" class="edge">
<title>l2_ffn_act_8&#45;&gt;l2_ffn_down_8</title>
<path fill="none" stroke="black" d="M5105.5,-3264.09C5105.5,-3264.09 5105.5,-3202.71 5105.5,-3202.71"/>
<polygon fill="black" stroke="black" points="5109,-3202.71 5105.5,-3192.71 5102,-3202.71 5109,-3202.71"/>
</g>
<!-- l2_ffn_down_9 -->
<g id="node95" class="node">
<title>l2_ffn_down_9</title>
<polygon fill="lightgreen" stroke="black" points="3134.5,-3192.33 2659.5,-3192.33 2659.5,-3124.33 3134.5,-3124.33 3134.5,-3192.33"/>
<text text-anchor="middle" x="2897" y="-3177.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="2897" y="-3162.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="2897" y="-3147.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2897" y="-3132.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 9</text>
</g>
<!-- l2_ffn_act_9&#45;&gt;l2_ffn_down_9 -->
<g id="edge128" class="edge">
<title>l2_ffn_act_9&#45;&gt;l2_ffn_down_9</title>
<path fill="none" stroke="black" d="M2765,-3264.09C2765,-3264.09 2765,-3202.71 2765,-3202.71"/>
<polygon fill="black" stroke="black" points="2768.5,-3202.71 2765,-3192.71 2761.5,-3202.71 2768.5,-3202.71"/>
</g>
<!-- l2_ffn_down_10 -->
<g id="node96" class="node">
<title>l2_ffn_down_10</title>
<polygon fill="lightgreen" stroke="black" points="3916.5,-3192.33 3441.5,-3192.33 3441.5,-3124.33 3916.5,-3124.33 3916.5,-3192.33"/>
<text text-anchor="middle" x="3679" y="-3177.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="3679" y="-3162.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3679" y="-3147.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3679" y="-3132.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 10</text>
</g>
<!-- l2_ffn_act_10&#45;&gt;l2_ffn_down_10 -->
<g id="edge129" class="edge">
<title>l2_ffn_act_10&#45;&gt;l2_ffn_down_10</title>
<path fill="none" stroke="black" d="M3679,-3264.09C3679,-3264.09 3679,-3202.71 3679,-3202.71"/>
<polygon fill="black" stroke="black" points="3682.5,-3202.71 3679,-3192.71 3675.5,-3202.71 3682.5,-3202.71"/>
</g>
<!-- l2_ffn_down_11 -->
<g id="node97" class="node">
<title>l2_ffn_down_11</title>
<polygon fill="lightgreen" stroke="black" points="4433.5,-3192.33 3958.5,-3192.33 3958.5,-3124.33 4433.5,-3124.33 4433.5,-3192.33"/>
<text text-anchor="middle" x="4196" y="-3177.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="4196" y="-3162.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4196" y="-3147.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4196" y="-3132.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 11</text>
</g>
<!-- l2_ffn_act_11&#45;&gt;l2_ffn_down_11 -->
<g id="edge130" class="edge">
<title>l2_ffn_act_11&#45;&gt;l2_ffn_down_11</title>
<path fill="none" stroke="black" d="M4196,-3264.09C4196,-3264.09 4196,-3202.71 4196,-3202.71"/>
<polygon fill="black" stroke="black" points="4199.5,-3202.71 4196,-3192.71 4192.5,-3202.71 4199.5,-3202.71"/>
</g>
<!-- l2_ffn_allreduce -->
<g id="node98" class="node">
<title>l2_ffn_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="4676.03,-3052.33 3912.41,-3052.33 3715.97,-2916.33 4479.59,-2916.33 4676.03,-3052.33"/>
<text text-anchor="middle" x="4196" y="-3003.13" font-family="Helvetica,sans-Serif" font-size="14.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="4196" y="-2988.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="4196" y="-2973.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4196" y="-2958.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8&#45;11</text>
</g>
<!-- l2_ffn_down_8&#45;&gt;l2_ffn_allreduce -->
<g id="edge131" class="edge">
<title>l2_ffn_down_8&#45;&gt;l2_ffn_allreduce</title>
<path fill="none" stroke="black" d="M4777.76,-3124.31C4777.76,-3073.57 4777.76,-2984 4777.76,-2984 4777.76,-2984 4587.55,-2984 4587.55,-2984"/>
<polygon fill="black" stroke="black" points="4587.55,-2980.5 4577.55,-2984 4587.55,-2987.5 4587.55,-2980.5"/>
</g>
<!-- l2_ffn_down_9&#45;&gt;l2_ffn_allreduce -->
<g id="edge132" class="edge">
<title>l2_ffn_down_9&#45;&gt;l2_ffn_allreduce</title>
<path fill="none" stroke="black" d="M2922.5,-3124.31C2922.5,-3073.57 2922.5,-2984 2922.5,-2984 2922.5,-2984 3803.48,-2984 3803.48,-2984"/>
<polygon fill="black" stroke="black" points="3803.48,-2987.5 3813.48,-2984 3803.48,-2980.5 3803.48,-2987.5"/>
</g>
<!-- l2_ffn_down_10&#45;&gt;l2_ffn_allreduce -->
<g id="edge133" class="edge">
<title>l2_ffn_down_10&#45;&gt;l2_ffn_allreduce</title>
<path fill="none" stroke="black" d="M3816.24,-3123.96C3816.24,-3123.96 3816.24,-2995.9 3816.24,-2995.9"/>
<polygon fill="black" stroke="black" points="3819.74,-2995.9 3816.24,-2985.9 3812.74,-2995.9 3819.74,-2995.9"/>
</g>
<!-- l2_ffn_down_11&#45;&gt;l2_ffn_allreduce -->
<g id="edge134" class="edge">
<title>l2_ffn_down_11&#45;&gt;l2_ffn_allreduce</title>
<path fill="none" stroke="black" d="M4196,-3123.96C4196,-3123.96 4196,-3062.47 4196,-3062.47"/>
<polygon fill="black" stroke="black" points="4199.5,-3062.47 4196,-3052.47 4192.5,-3062.47 4199.5,-3062.47"/>
</g>
<!-- l2_ffn_allreduce&#45;&gt;l2_ffn_residual -->
<g id="edge136" class="edge">
<title>l2_ffn_allreduce&#45;&gt;l2_ffn_residual</title>
<path fill="none" stroke="black" d="M4468.01,-2916.06C4468.01,-2916.06 4468.01,-2854.44 4468.01,-2854.44"/>
<polygon fill="black" stroke="black" points="4471.51,-2854.44 4468.01,-2844.44 4464.51,-2854.44 4471.51,-2854.44"/>
</g>
<!-- l2_layernorm -->
<g id="node100" class="node">
<title>l2_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="4724,-2704.33 4270,-2704.33 4270,-2636.33 4724,-2636.33 4724,-2704.33"/>
<text text-anchor="middle" x="4497" y="-2689.13" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="4497" y="-2674.13" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4497" y="-2659.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4497" y="-2644.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l2_ffn_residual&#45;&gt;l2_layernorm -->
<g id="edge137" class="edge">
<title>l2_ffn_residual&#45;&gt;l2_layernorm</title>
<path fill="none" stroke="black" d="M4497,-2776.09C4497,-2776.09 4497,-2714.71 4497,-2714.71"/>
<polygon fill="black" stroke="black" points="4500.5,-2714.71 4497,-2704.71 4493.5,-2714.71 4500.5,-2714.71"/>
</g>
<!-- send_l2_l3 -->
<g id="node137" class="node">
<title>send_l2_l3</title>
<ellipse fill="orange" stroke="black" cx="4497" cy="-2516.25" rx="321.05" ry="48.17"/>
<text text-anchor="middle" x="4497" y="-2535.05" font-family="Helvetica,sans-Serif" font-size="14.00">Pipeline Send</text>
<text text-anchor="middle" x="4497" y="-2520.05" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4497" y="-2505.05" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4497" y="-2490.05" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- l2_layernorm&#45;&gt;send_l2_l3 -->
<g id="edge138" class="edge">
<title>l2_layernorm&#45;&gt;send_l2_l3</title>
<path fill="none" stroke="black" d="M4497,-2636.14C4497,-2636.14 4497,-2574.38 4497,-2574.38"/>
<polygon fill="black" stroke="black" points="4500.5,-2574.38 4497,-2564.38 4493.5,-2574.38 4500.5,-2574.38"/>
</g>
<!-- l3_input_broadcast -->
<g id="node101" class="node">
<title>l3_input_broadcast</title>
<polygon fill="lightyellow" stroke="black" points="4989.42,-2396.17 4206.09,-2396.17 4004.58,-2260.17 4787.91,-2260.17 4989.42,-2396.17"/>
<text text-anchor="middle" x="4497" y="-2346.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input Broadcast</text>
<text text-anchor="middle" x="4497" y="-2331.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4497" y="-2316.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]×4</text>
<text text-anchor="middle" x="4497" y="-2301.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12&#45;15</text>
</g>
<!-- l3_mha_split -->
<g id="node102" class="node">
<title>l3_mha_split</title>
<polygon fill="lightyellow" stroke="black" points="4627.42,-2188.17 3844.09,-2188.17 3642.58,-2052.17 4425.91,-2052.17 4627.42,-2188.17"/>
<text text-anchor="middle" x="4135" y="-2138.97" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Input Split</text>
<text text-anchor="middle" x="4135" y="-2123.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4135" y="-2108.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="4135" y="-2093.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12&#45;15</text>
</g>
<!-- l3_input_broadcast&#45;&gt;l3_mha_split -->
<g id="edge140" class="edge">
<title>l3_input_broadcast&#45;&gt;l3_mha_split</title>
<path fill="none" stroke="black" d="M4316,-2260.06C4316,-2260.06 4316,-2198.43 4316,-2198.43"/>
<polygon fill="black" stroke="black" points="4319.5,-2198.43 4316,-2188.43 4312.5,-2198.43 4319.5,-2198.43"/>
</g>
<!-- l3_mha_residual -->
<g id="node112" class="node">
<title>l3_mha_residual</title>
<polygon fill="lightgreen" stroke="black" points="4613,-1492.17 4139,-1492.17 4139,-1424.17 4613,-1424.17 4613,-1492.17"/>
<text text-anchor="middle" x="4376" y="-1476.97" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4376" y="-1461.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096] (x2)</text>
<text text-anchor="middle" x="4376" y="-1446.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4376" y="-1431.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l3_input_broadcast&#45;&gt;l3_mha_residual -->
<g id="edge153" class="edge">
<title>l3_input_broadcast&#45;&gt;l3_mha_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4888.55,-2328C4997.43,-2328 5086.48,-2328 5086.48,-2328 5086.48,-2328 5086.48,-1458 5086.48,-1458 5086.48,-1458 4623.07,-1458 4623.07,-1458"/>
<polygon fill="black" stroke="black" points="4623.07,-1454.5 4613.07,-1458 4623.07,-1461.5 4623.07,-1454.5"/>
</g>
<!-- l3_mha_qkv_12 -->
<g id="node103" class="node">
<title>l3_mha_qkv_12</title>
<polygon fill="lightgreen" stroke="black" points="4982.5,-1980.17 4441.5,-1980.17 4441.5,-1912.17 4982.5,-1912.17 4982.5,-1980.17"/>
<text text-anchor="middle" x="4712" y="-1964.97" font-family="Helvetica,sans-Serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="4712" y="-1949.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4712" y="-1934.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="4712" y="-1919.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_mha_split&#45;&gt;l3_mha_qkv_12 -->
<g id="edge141" class="edge">
<title>l3_mha_split&#45;&gt;l3_mha_qkv_12</title>
<path fill="none" stroke="black" d="M4534.48,-2120.04C4534.48,-2120.04 4534.48,-1990.41 4534.48,-1990.41"/>
<polygon fill="black" stroke="black" points="4537.98,-1990.41 4534.48,-1980.41 4530.98,-1990.41 4537.98,-1990.41"/>
</g>
<!-- l3_mha_qkv_13 -->
<g id="node104" class="node">
<title>l3_mha_qkv_13</title>
<polygon fill="lightgreen" stroke="black" points="3251.5,-1980.17 2710.5,-1980.17 2710.5,-1912.17 3251.5,-1912.17 3251.5,-1980.17"/>
<text text-anchor="middle" x="2981" y="-1964.97" font-family="Helvetica,sans-Serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="2981" y="-1949.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2981" y="-1934.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="2981" y="-1919.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_mha_split&#45;&gt;l3_mha_qkv_13 -->
<g id="edge142" class="edge">
<title>l3_mha_split&#45;&gt;l3_mha_qkv_13</title>
<path fill="none" stroke="black" d="M3743.01,-2120C3484.37,-2120 3193,-2120 3193,-2120 3193,-2120 3193,-1990.51 3193,-1990.51"/>
<polygon fill="black" stroke="black" points="3196.5,-1990.51 3193,-1980.51 3189.5,-1990.51 3196.5,-1990.51"/>
</g>
<!-- l3_mha_qkv_14 -->
<g id="node105" class="node">
<title>l3_mha_qkv_14</title>
<polygon fill="lightgreen" stroke="black" points="3828.5,-1980.17 3287.5,-1980.17 3287.5,-1912.17 3828.5,-1912.17 3828.5,-1980.17"/>
<text text-anchor="middle" x="3558" y="-1964.97" font-family="Helvetica,sans-Serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="3558" y="-1949.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3558" y="-1934.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="3558" y="-1919.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_mha_split&#45;&gt;l3_mha_qkv_14 -->
<g id="edge143" class="edge">
<title>l3_mha_split&#45;&gt;l3_mha_qkv_14</title>
<path fill="none" stroke="black" d="M3735.52,-2051.9C3735.52,-2051.9 3735.52,-1990.28 3735.52,-1990.28"/>
<polygon fill="black" stroke="black" points="3739.02,-1990.28 3735.52,-1980.28 3732.02,-1990.28 3739.02,-1990.28"/>
</g>
<!-- l3_mha_qkv_15 -->
<g id="node106" class="node">
<title>l3_mha_qkv_15</title>
<polygon fill="lightgreen" stroke="black" points="4405.5,-1980.17 3864.5,-1980.17 3864.5,-1912.17 4405.5,-1912.17 4405.5,-1980.17"/>
<text text-anchor="middle" x="4135" y="-1964.97" font-family="Helvetica,sans-Serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="4135" y="-1949.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4135" y="-1934.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="4135" y="-1919.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_mha_split&#45;&gt;l3_mha_qkv_15 -->
<g id="edge144" class="edge">
<title>l3_mha_split&#45;&gt;l3_mha_qkv_15</title>
<path fill="none" stroke="black" d="M4135,-2051.9C4135,-2051.9 4135,-1990.28 4135,-1990.28"/>
<polygon fill="black" stroke="black" points="4138.5,-1990.28 4135,-1980.28 4131.5,-1990.28 4138.5,-1990.28"/>
</g>
<!-- l3_mha_attn_12 -->
<g id="node107" class="node">
<title>l3_mha_attn_12</title>
<polygon fill="lightgreen" stroke="black" points="4970.5,-1840.17 4441.5,-1840.17 4441.5,-1772.17 4970.5,-1772.17 4970.5,-1840.17"/>
<text text-anchor="middle" x="4706" y="-1824.97" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="4706" y="-1809.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="4706" y="-1794.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4706" y="-1779.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_mha_qkv_12&#45;&gt;l3_mha_attn_12 -->
<g id="edge145" class="edge">
<title>l3_mha_qkv_12&#45;&gt;l3_mha_attn_12</title>
<path fill="none" stroke="black" d="M4706,-1911.92C4706,-1911.92 4706,-1850.55 4706,-1850.55"/>
<polygon fill="black" stroke="black" points="4709.5,-1850.55 4706,-1840.55 4702.5,-1850.55 4709.5,-1850.55"/>
</g>
<!-- l3_mha_attn_13 -->
<g id="node108" class="node">
<title>l3_mha_attn_13</title>
<polygon fill="lightgreen" stroke="black" points="3254.5,-1840.17 2725.5,-1840.17 2725.5,-1772.17 3254.5,-1772.17 3254.5,-1840.17"/>
<text text-anchor="middle" x="2990" y="-1824.97" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="2990" y="-1809.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="2990" y="-1794.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2990" y="-1779.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_mha_qkv_13&#45;&gt;l3_mha_attn_13 -->
<g id="edge146" class="edge">
<title>l3_mha_qkv_13&#45;&gt;l3_mha_attn_13</title>
<path fill="none" stroke="black" d="M2988.5,-1911.92C2988.5,-1911.92 2988.5,-1850.55 2988.5,-1850.55"/>
<polygon fill="black" stroke="black" points="2992,-1850.55 2988.5,-1840.55 2985,-1850.55 2992,-1850.55"/>
</g>
<!-- l3_mha_attn_14 -->
<g id="node109" class="node">
<title>l3_mha_attn_14</title>
<polygon fill="lightgreen" stroke="black" points="3828.5,-1840.17 3299.5,-1840.17 3299.5,-1772.17 3828.5,-1772.17 3828.5,-1840.17"/>
<text text-anchor="middle" x="3564" y="-1824.97" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="3564" y="-1809.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="3564" y="-1794.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3564" y="-1779.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_mha_qkv_14&#45;&gt;l3_mha_attn_14 -->
<g id="edge147" class="edge">
<title>l3_mha_qkv_14&#45;&gt;l3_mha_attn_14</title>
<path fill="none" stroke="black" d="M3564,-1911.92C3564,-1911.92 3564,-1850.55 3564,-1850.55"/>
<polygon fill="black" stroke="black" points="3567.5,-1850.55 3564,-1840.55 3560.5,-1850.55 3567.5,-1850.55"/>
</g>
<!-- l3_mha_attn_15 -->
<g id="node110" class="node">
<title>l3_mha_attn_15</title>
<polygon fill="lightgreen" stroke="black" points="4399.5,-1840.17 3870.5,-1840.17 3870.5,-1772.17 4399.5,-1772.17 4399.5,-1840.17"/>
<text text-anchor="middle" x="4135" y="-1824.97" font-family="Helvetica,sans-Serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="4135" y="-1809.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, num_heads=8, head_dim=128]</text>
<text text-anchor="middle" x="4135" y="-1794.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4135" y="-1779.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_mha_qkv_15&#45;&gt;l3_mha_attn_15 -->
<g id="edge148" class="edge">
<title>l3_mha_qkv_15&#45;&gt;l3_mha_attn_15</title>
<path fill="none" stroke="black" d="M4135,-1911.92C4135,-1911.92 4135,-1850.55 4135,-1850.55"/>
<polygon fill="black" stroke="black" points="4138.5,-1850.55 4135,-1840.55 4131.5,-1850.55 4138.5,-1850.55"/>
</g>
<!-- l3_mha_allreduce -->
<g id="node111" class="node">
<title>l3_mha_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="4615.03,-1700.17 3851.41,-1700.17 3654.97,-1564.17 4418.59,-1564.17 4615.03,-1700.17"/>
<text text-anchor="middle" x="4135" y="-1650.97" font-family="Helvetica,sans-Serif" font-size="14.00">MHA All&#45;Reduce</text>
<text text-anchor="middle" x="4135" y="-1635.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="4135" y="-1620.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4135" y="-1605.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12&#45;15</text>
</g>
<!-- l3_mha_attn_12&#45;&gt;l3_mha_allreduce -->
<g id="edge149" class="edge">
<title>l3_mha_attn_12&#45;&gt;l3_mha_allreduce</title>
<path fill="none" stroke="black" d="M4528.26,-1771.79C4528.26,-1771.79 4528.26,-1710.31 4528.26,-1710.31"/>
<polygon fill="black" stroke="black" points="4531.76,-1710.31 4528.26,-1700.31 4524.76,-1710.31 4531.76,-1710.31"/>
</g>
<!-- l3_mha_attn_13&#45;&gt;l3_mha_allreduce -->
<g id="edge150" class="edge">
<title>l3_mha_attn_13&#45;&gt;l3_mha_allreduce</title>
<path fill="none" stroke="black" d="M3191,-1771.76C3191,-1721 3191,-1632 3191,-1632 3191,-1632 3742.74,-1632 3742.74,-1632"/>
<polygon fill="black" stroke="black" points="3742.74,-1635.5 3752.74,-1632 3742.74,-1628.5 3742.74,-1635.5"/>
</g>
<!-- l3_mha_attn_14&#45;&gt;l3_mha_allreduce -->
<g id="edge151" class="edge">
<title>l3_mha_attn_14&#45;&gt;l3_mha_allreduce</title>
<path fill="none" stroke="black" d="M3741.74,-1771.79C3741.74,-1771.79 3741.74,-1642.23 3741.74,-1642.23"/>
<polygon fill="black" stroke="black" points="3745.24,-1642.23 3741.74,-1632.23 3738.24,-1642.23 3745.24,-1642.23"/>
</g>
<!-- l3_mha_attn_15&#45;&gt;l3_mha_allreduce -->
<g id="edge152" class="edge">
<title>l3_mha_attn_15&#45;&gt;l3_mha_allreduce</title>
<path fill="none" stroke="black" d="M4135,-1771.79C4135,-1771.79 4135,-1710.31 4135,-1710.31"/>
<polygon fill="black" stroke="black" points="4138.5,-1710.31 4135,-1700.31 4131.5,-1710.31 4138.5,-1710.31"/>
</g>
<!-- l3_mha_allreduce&#45;&gt;l3_mha_residual -->
<g id="edge154" class="edge">
<title>l3_mha_allreduce&#45;&gt;l3_mha_residual</title>
<path fill="none" stroke="black" d="M4376,-1563.9C4376,-1563.9 4376,-1502.28 4376,-1502.28"/>
<polygon fill="black" stroke="black" points="4379.5,-1502.28 4376,-1492.28 4372.5,-1502.28 4379.5,-1502.28"/>
</g>
<!-- l3_mha_layernorm -->
<g id="node113" class="node">
<title>l3_mha_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="4603,-1352.17 4149,-1352.17 4149,-1284.17 4603,-1284.17 4603,-1352.17"/>
<text text-anchor="middle" x="4376" y="-1336.97" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="4376" y="-1321.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4376" y="-1306.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4376" y="-1291.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l3_mha_residual&#45;&gt;l3_mha_layernorm -->
<g id="edge155" class="edge">
<title>l3_mha_residual&#45;&gt;l3_mha_layernorm</title>
<path fill="none" stroke="black" d="M4376,-1423.92C4376,-1423.92 4376,-1362.55 4376,-1362.55"/>
<polygon fill="black" stroke="black" points="4379.5,-1362.55 4376,-1352.55 4372.5,-1362.55 4379.5,-1362.55"/>
</g>
<!-- l3_ffn_split -->
<g id="node114" class="node">
<title>l3_ffn_split</title>
<polygon fill="lightyellow" stroke="black" points="4386.42,-1212.17 3603.09,-1212.17 3401.58,-1076.17 4184.91,-1076.17 4386.42,-1212.17"/>
<text text-anchor="middle" x="3894" y="-1162.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Input Split</text>
<text text-anchor="middle" x="3894" y="-1147.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3894" y="-1132.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="3894" y="-1117.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12&#45;15</text>
</g>
<!-- l3_mha_layernorm&#45;&gt;l3_ffn_split -->
<g id="edge156" class="edge">
<title>l3_mha_layernorm&#45;&gt;l3_ffn_split</title>
<path fill="none" stroke="black" d="M4267.73,-1283.79C4267.73,-1283.79 4267.73,-1222.31 4267.73,-1222.31"/>
<polygon fill="black" stroke="black" points="4271.23,-1222.31 4267.73,-1212.31 4264.23,-1222.31 4271.23,-1222.31"/>
</g>
<!-- l3_ffn_residual -->
<g id="node132" class="node">
<title>l3_ffn_residual</title>
<polygon fill="lightgreen" stroke="black" points="5068,-376.17 4594,-376.17 4594,-308.17 5068,-308.17 5068,-376.17"/>
<text text-anchor="middle" x="4831" y="-360.97" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4831" y="-345.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096] (x2)</text>
<text text-anchor="middle" x="4831" y="-330.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4831" y="-315.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l3_mha_layernorm&#45;&gt;l3_ffn_residual -->
<g id="edge181" class="edge">
<title>l3_mha_layernorm&#45;&gt;l3_ffn_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4603.06,-1318C4846.36,-1318 5198,-1318 5198,-1318 5198,-1318 5198,-342 5198,-342 5198,-342 5078.09,-342 5078.09,-342"/>
<polygon fill="black" stroke="black" points="5078.09,-338.5 5068.09,-342 5078.09,-345.5 5078.09,-338.5"/>
</g>
<!-- l3_ffn_up_12 -->
<g id="node115" class="node">
<title>l3_ffn_up_12</title>
<polygon fill="lightgreen" stroke="black" points="5706.5,-1004.17 5219.5,-1004.17 5219.5,-936.17 5706.5,-936.17 5706.5,-1004.17"/>
<text text-anchor="middle" x="5463" y="-988.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="5463" y="-973.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="5463" y="-958.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="5463" y="-943.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_ffn_split&#45;&gt;l3_ffn_up_12 -->
<g id="edge157" class="edge">
<title>l3_ffn_split&#45;&gt;l3_ffn_up_12</title>
<path fill="none" stroke="black" d="M4318.31,-1166C4748.9,-1166 5352.5,-1166 5352.5,-1166 5352.5,-1166 5352.5,-1014.28 5352.5,-1014.28"/>
<polygon fill="black" stroke="black" points="5356,-1014.28 5352.5,-1004.28 5349,-1014.28 5356,-1014.28"/>
</g>
<!-- l3_ffn_up_13 -->
<g id="node116" class="node">
<title>l3_ffn_up_13</title>
<polygon fill="lightgreen" stroke="black" points="2045.5,-1004.17 1558.5,-1004.17 1558.5,-936.17 2045.5,-936.17 2045.5,-1004.17"/>
<text text-anchor="middle" x="1802" y="-988.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="1802" y="-973.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1802" y="-958.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="1802" y="-943.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_ffn_split&#45;&gt;l3_ffn_up_13 -->
<g id="edge158" class="edge">
<title>l3_ffn_split&#45;&gt;l3_ffn_up_13</title>
<path fill="none" stroke="black" d="M3552.29,-1178C2995.28,-1178 1953,-1178 1953,-1178 1953,-1178 1953,-1014.49 1953,-1014.49"/>
<polygon fill="black" stroke="black" points="1956.5,-1014.49 1953,-1004.49 1949.5,-1014.49 1956.5,-1014.49"/>
</g>
<!-- l3_ffn_up_14 -->
<g id="node117" class="node">
<title>l3_ffn_up_14</title>
<polygon fill="lightgreen" stroke="black" points="3091.5,-1004.17 2604.5,-1004.17 2604.5,-936.17 3091.5,-936.17 3091.5,-1004.17"/>
<text text-anchor="middle" x="2848" y="-988.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="2848" y="-973.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2848" y="-958.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="2848" y="-943.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_ffn_split&#45;&gt;l3_ffn_up_14 -->
<g id="edge159" class="edge">
<title>l3_ffn_split&#45;&gt;l3_ffn_up_14</title>
<path fill="none" stroke="black" d="M3451.7,-1110C3189.71,-1110 2908.5,-1110 2908.5,-1110 2908.5,-1110 2908.5,-1014.37 2908.5,-1014.37"/>
<polygon fill="black" stroke="black" points="2912,-1014.37 2908.5,-1004.37 2905,-1014.37 2912,-1014.37"/>
</g>
<!-- l3_ffn_up_15 -->
<g id="node118" class="node">
<title>l3_ffn_up_15</title>
<polygon fill="lightgreen" stroke="black" points="4137.5,-1004.17 3650.5,-1004.17 3650.5,-936.17 4137.5,-936.17 4137.5,-1004.17"/>
<text text-anchor="middle" x="3894" y="-988.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="3894" y="-973.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3894" y="-958.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3894" y="-943.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_ffn_split&#45;&gt;l3_ffn_up_15 -->
<g id="edge160" class="edge">
<title>l3_ffn_split&#45;&gt;l3_ffn_up_15</title>
<path fill="none" stroke="black" d="M3894,-1075.9C3894,-1075.9 3894,-1014.28 3894,-1014.28"/>
<polygon fill="black" stroke="black" points="3897.5,-1014.28 3894,-1004.28 3890.5,-1014.28 3897.5,-1014.28"/>
</g>
<!-- l3_ffn_gate_12 -->
<g id="node119" class="node">
<title>l3_ffn_gate_12</title>
<polygon fill="lightgreen" stroke="black" points="5183.5,-1004.17 4696.5,-1004.17 4696.5,-936.17 5183.5,-936.17 5183.5,-1004.17"/>
<text text-anchor="middle" x="4940" y="-988.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="4940" y="-973.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4940" y="-958.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4940" y="-943.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_ffn_split&#45;&gt;l3_ffn_gate_12 -->
<g id="edge161" class="edge">
<title>l3_ffn_split&#45;&gt;l3_ffn_gate_12</title>
<path fill="none" stroke="black" d="M4251.53,-1121C4517.1,-1121 4833.5,-1121 4833.5,-1121 4833.5,-1121 4833.5,-1014.39 4833.5,-1014.39"/>
<polygon fill="black" stroke="black" points="4837,-1014.39 4833.5,-1004.39 4830,-1014.39 4837,-1014.39"/>
</g>
<!-- l3_ffn_gate_13 -->
<g id="node120" class="node">
<title>l3_ffn_gate_13</title>
<polygon fill="lightgreen" stroke="black" points="2568.5,-1004.17 2081.5,-1004.17 2081.5,-936.17 2568.5,-936.17 2568.5,-1004.17"/>
<text text-anchor="middle" x="2325" y="-988.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="2325" y="-973.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2325" y="-958.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="2325" y="-943.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_ffn_split&#45;&gt;l3_ffn_gate_13 -->
<g id="edge162" class="edge">
<title>l3_ffn_split&#45;&gt;l3_ffn_gate_13</title>
<path fill="none" stroke="black" d="M3501.83,-1144C3082.15,-1144 2476,-1144 2476,-1144 2476,-1144 2476,-1014.51 2476,-1014.51"/>
<polygon fill="black" stroke="black" points="2479.5,-1014.51 2476,-1004.51 2472.5,-1014.51 2479.5,-1014.51"/>
</g>
<!-- l3_ffn_gate_14 -->
<g id="node121" class="node">
<title>l3_ffn_gate_14</title>
<polygon fill="lightgreen" stroke="black" points="3614.5,-1004.17 3127.5,-1004.17 3127.5,-936.17 3614.5,-936.17 3614.5,-1004.17"/>
<text text-anchor="middle" x="3371" y="-988.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="3371" y="-973.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3371" y="-958.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3371" y="-943.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_ffn_split&#45;&gt;l3_ffn_gate_14 -->
<g id="edge163" class="edge">
<title>l3_ffn_split&#45;&gt;l3_ffn_gate_14</title>
<path fill="none" stroke="black" d="M3508.02,-1075.9C3508.02,-1075.9 3508.02,-1014.28 3508.02,-1014.28"/>
<polygon fill="black" stroke="black" points="3511.52,-1014.28 3508.02,-1004.28 3504.52,-1014.28 3511.52,-1014.28"/>
</g>
<!-- l3_ffn_gate_15 -->
<g id="node122" class="node">
<title>l3_ffn_gate_15</title>
<polygon fill="lightgreen" stroke="black" points="4660.5,-1004.17 4173.5,-1004.17 4173.5,-936.17 4660.5,-936.17 4660.5,-1004.17"/>
<text text-anchor="middle" x="4417" y="-988.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="4417" y="-973.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4417" y="-958.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4417" y="-943.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_ffn_split&#45;&gt;l3_ffn_gate_15 -->
<g id="edge164" class="edge">
<title>l3_ffn_split&#45;&gt;l3_ffn_gate_15</title>
<path fill="none" stroke="black" d="M4279.98,-1140.21C4279.98,-1140.21 4279.98,-1014.39 4279.98,-1014.39"/>
<polygon fill="black" stroke="black" points="4283.48,-1014.39 4279.98,-1004.39 4276.48,-1014.39 4283.48,-1014.39"/>
</g>
<!-- l3_ffn_act_12 -->
<g id="node123" class="node">
<title>l3_ffn_act_12</title>
<polygon fill="lightgreen" stroke="black" points="5183.5,-864.17 4696.5,-864.17 4696.5,-796.17 5183.5,-796.17 5183.5,-864.17"/>
<text text-anchor="middle" x="4940" y="-848.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="4940" y="-833.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4940" y="-818.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4940" y="-803.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_ffn_up_12&#45;&gt;l3_ffn_act_12 -->
<g id="edge165" class="edge">
<title>l3_ffn_up_12&#45;&gt;l3_ffn_act_12</title>
<path fill="none" stroke="black" d="M5463,-935.88C5463,-894.38 5463,-830 5463,-830 5463,-830 5193.51,-830 5193.51,-830"/>
<polygon fill="black" stroke="black" points="5193.51,-826.5 5183.51,-830 5193.51,-833.5 5193.51,-826.5"/>
</g>
<!-- l3_ffn_act_13 -->
<g id="node124" class="node">
<title>l3_ffn_act_13</title>
<polygon fill="lightgreen" stroke="black" points="2568.5,-864.17 2081.5,-864.17 2081.5,-796.17 2568.5,-796.17 2568.5,-864.17"/>
<text text-anchor="middle" x="2325" y="-848.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="2325" y="-833.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="2325" y="-818.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="2325" y="-803.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_ffn_up_13&#45;&gt;l3_ffn_act_13 -->
<g id="edge166" class="edge">
<title>l3_ffn_up_13&#45;&gt;l3_ffn_act_13</title>
<path fill="none" stroke="black" d="M1802,-935.88C1802,-894.38 1802,-830 1802,-830 1802,-830 2071.49,-830 2071.49,-830"/>
<polygon fill="black" stroke="black" points="2071.49,-833.5 2081.49,-830 2071.49,-826.5 2071.49,-833.5"/>
</g>
<!-- l3_ffn_act_14 -->
<g id="node125" class="node">
<title>l3_ffn_act_14</title>
<polygon fill="lightgreen" stroke="black" points="3614.5,-864.17 3127.5,-864.17 3127.5,-796.17 3614.5,-796.17 3614.5,-864.17"/>
<text text-anchor="middle" x="3371" y="-848.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="3371" y="-833.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3371" y="-818.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3371" y="-803.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_ffn_up_14&#45;&gt;l3_ffn_act_14 -->
<g id="edge167" class="edge">
<title>l3_ffn_up_14&#45;&gt;l3_ffn_act_14</title>
<path fill="none" stroke="black" d="M2994.5,-935.88C2994.5,-894.38 2994.5,-830 2994.5,-830 2994.5,-830 3117.24,-830 3117.24,-830"/>
<polygon fill="black" stroke="black" points="3117.24,-833.5 3127.24,-830 3117.24,-826.5 3117.24,-833.5"/>
</g>
<!-- l3_ffn_act_15 -->
<g id="node126" class="node">
<title>l3_ffn_act_15</title>
<polygon fill="lightgreen" stroke="black" points="4398.5,-864.17 3911.5,-864.17 3911.5,-796.17 4398.5,-796.17 4398.5,-864.17"/>
<text text-anchor="middle" x="4155" y="-848.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Activation</text>
<text text-anchor="middle" x="4155" y="-833.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4155" y="-818.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4155" y="-803.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_ffn_up_15&#45;&gt;l3_ffn_act_15 -->
<g id="edge168" class="edge">
<title>l3_ffn_up_15&#45;&gt;l3_ffn_act_15</title>
<path fill="none" stroke="black" d="M4024.5,-935.92C4024.5,-935.92 4024.5,-874.55 4024.5,-874.55"/>
<polygon fill="black" stroke="black" points="4028,-874.55 4024.5,-864.55 4021,-874.55 4028,-874.55"/>
</g>
<!-- l3_ffn_gate_12&#45;&gt;l3_ffn_act_12 -->
<g id="edge169" class="edge">
<title>l3_ffn_gate_12&#45;&gt;l3_ffn_act_12</title>
<path fill="none" stroke="black" d="M4940,-935.92C4940,-935.92 4940,-874.55 4940,-874.55"/>
<polygon fill="black" stroke="black" points="4943.5,-874.55 4940,-864.55 4936.5,-874.55 4943.5,-874.55"/>
</g>
<!-- l3_ffn_gate_13&#45;&gt;l3_ffn_act_13 -->
<g id="edge170" class="edge">
<title>l3_ffn_gate_13&#45;&gt;l3_ffn_act_13</title>
<path fill="none" stroke="black" d="M2325,-935.92C2325,-935.92 2325,-874.55 2325,-874.55"/>
<polygon fill="black" stroke="black" points="2328.5,-874.55 2325,-864.55 2321.5,-874.55 2328.5,-874.55"/>
</g>
<!-- l3_ffn_gate_14&#45;&gt;l3_ffn_act_14 -->
<g id="edge171" class="edge">
<title>l3_ffn_gate_14&#45;&gt;l3_ffn_act_14</title>
<path fill="none" stroke="black" d="M3371,-935.92C3371,-935.92 3371,-874.55 3371,-874.55"/>
<polygon fill="black" stroke="black" points="3374.5,-874.55 3371,-864.55 3367.5,-874.55 3374.5,-874.55"/>
</g>
<!-- l3_ffn_gate_15&#45;&gt;l3_ffn_act_15 -->
<g id="edge172" class="edge">
<title>l3_ffn_gate_15&#45;&gt;l3_ffn_act_15</title>
<path fill="none" stroke="black" d="M4286,-935.92C4286,-935.92 4286,-874.55 4286,-874.55"/>
<polygon fill="black" stroke="black" points="4289.5,-874.55 4286,-864.55 4282.5,-874.55 4289.5,-874.55"/>
</g>
<!-- l3_ffn_down_12 -->
<g id="node127" class="node">
<title>l3_ffn_down_12</title>
<polygon fill="lightgreen" stroke="black" points="5040.5,-724.17 4565.5,-724.17 4565.5,-656.17 5040.5,-656.17 5040.5,-724.17"/>
<text text-anchor="middle" x="4803" y="-708.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="4803" y="-693.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4803" y="-678.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4803" y="-663.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12</text>
</g>
<!-- l3_ffn_act_12&#45;&gt;l3_ffn_down_12 -->
<g id="edge173" class="edge">
<title>l3_ffn_act_12&#45;&gt;l3_ffn_down_12</title>
<path fill="none" stroke="black" d="M4868.5,-795.92C4868.5,-795.92 4868.5,-734.55 4868.5,-734.55"/>
<polygon fill="black" stroke="black" points="4872,-734.55 4868.5,-724.55 4865,-734.55 4872,-734.55"/>
</g>
<!-- l3_ffn_down_13 -->
<g id="node128" class="node">
<title>l3_ffn_down_13</title>
<polygon fill="lightgreen" stroke="black" points="2897.5,-724.17 2422.5,-724.17 2422.5,-656.17 2897.5,-656.17 2897.5,-724.17"/>
<text text-anchor="middle" x="2660" y="-708.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="2660" y="-693.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="2660" y="-678.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2660" y="-663.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 13</text>
</g>
<!-- l3_ffn_act_13&#45;&gt;l3_ffn_down_13 -->
<g id="edge174" class="edge">
<title>l3_ffn_act_13&#45;&gt;l3_ffn_down_13</title>
<path fill="none" stroke="black" d="M2495.5,-795.92C2495.5,-795.92 2495.5,-734.55 2495.5,-734.55"/>
<polygon fill="black" stroke="black" points="2499,-734.55 2495.5,-724.55 2492,-734.55 2499,-734.55"/>
</g>
<!-- l3_ffn_down_14 -->
<g id="node129" class="node">
<title>l3_ffn_down_14</title>
<polygon fill="lightgreen" stroke="black" points="3744.5,-724.17 3269.5,-724.17 3269.5,-656.17 3744.5,-656.17 3744.5,-724.17"/>
<text text-anchor="middle" x="3507" y="-708.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="3507" y="-693.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="3507" y="-678.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3507" y="-663.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 14</text>
</g>
<!-- l3_ffn_act_14&#45;&gt;l3_ffn_down_14 -->
<g id="edge175" class="edge">
<title>l3_ffn_act_14&#45;&gt;l3_ffn_down_14</title>
<path fill="none" stroke="black" d="M3442,-795.92C3442,-795.92 3442,-734.55 3442,-734.55"/>
<polygon fill="black" stroke="black" points="3445.5,-734.55 3442,-724.55 3438.5,-734.55 3445.5,-734.55"/>
</g>
<!-- l3_ffn_down_15 -->
<g id="node130" class="node">
<title>l3_ffn_down_15</title>
<polygon fill="lightgreen" stroke="black" points="4392.5,-724.17 3917.5,-724.17 3917.5,-656.17 4392.5,-656.17 4392.5,-724.17"/>
<text text-anchor="middle" x="4155" y="-708.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="4155" y="-693.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, mlp_hidden_size=4096]</text>
<text text-anchor="middle" x="4155" y="-678.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4155" y="-663.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 15</text>
</g>
<!-- l3_ffn_act_15&#45;&gt;l3_ffn_down_15 -->
<g id="edge176" class="edge">
<title>l3_ffn_act_15&#45;&gt;l3_ffn_down_15</title>
<path fill="none" stroke="black" d="M4155,-795.92C4155,-795.92 4155,-734.55 4155,-734.55"/>
<polygon fill="black" stroke="black" points="4158.5,-734.55 4155,-724.55 4151.5,-734.55 4158.5,-734.55"/>
</g>
<!-- l3_ffn_allreduce -->
<g id="node131" class="node">
<title>l3_ffn_allreduce</title>
<polygon fill="lightyellow" stroke="black" points="4635.03,-584.17 3871.41,-584.17 3674.97,-448.17 4438.59,-448.17 4635.03,-584.17"/>
<text text-anchor="middle" x="4155" y="-534.97" font-family="Helvetica,sans-Serif" font-size="14.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="4155" y="-519.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=1024]×4</text>
<text text-anchor="middle" x="4155" y="-504.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4155" y="-489.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12&#45;15</text>
</g>
<!-- l3_ffn_down_12&#45;&gt;l3_ffn_allreduce -->
<g id="edge177" class="edge">
<title>l3_ffn_down_12&#45;&gt;l3_ffn_allreduce</title>
<path fill="none" stroke="black" d="M4600.26,-655.79C4600.26,-655.79 4600.26,-594.31 4600.26,-594.31"/>
<polygon fill="black" stroke="black" points="4603.76,-594.31 4600.26,-584.31 4596.76,-594.31 4603.76,-594.31"/>
</g>
<!-- l3_ffn_down_13&#45;&gt;l3_ffn_allreduce -->
<g id="edge178" class="edge">
<title>l3_ffn_down_13&#45;&gt;l3_ffn_allreduce</title>
<path fill="none" stroke="black" d="M2660,-655.76C2660,-605 2660,-516 2660,-516 2660,-516 3762.91,-516 3762.91,-516"/>
<polygon fill="black" stroke="black" points="3762.91,-519.5 3772.91,-516 3762.91,-512.5 3762.91,-519.5"/>
</g>
<!-- l3_ffn_down_14&#45;&gt;l3_ffn_allreduce -->
<g id="edge179" class="edge">
<title>l3_ffn_down_14&#45;&gt;l3_ffn_allreduce</title>
<path fill="none" stroke="black" d="M3709.74,-655.79C3709.74,-655.79 3709.74,-526.23 3709.74,-526.23"/>
<polygon fill="black" stroke="black" points="3713.24,-526.23 3709.74,-516.23 3706.24,-526.23 3713.24,-526.23"/>
</g>
<!-- l3_ffn_down_15&#45;&gt;l3_ffn_allreduce -->
<g id="edge180" class="edge">
<title>l3_ffn_down_15&#45;&gt;l3_ffn_allreduce</title>
<path fill="none" stroke="black" d="M4155,-655.79C4155,-655.79 4155,-594.31 4155,-594.31"/>
<polygon fill="black" stroke="black" points="4158.5,-594.31 4155,-584.31 4151.5,-594.31 4158.5,-594.31"/>
</g>
<!-- l3_ffn_allreduce&#45;&gt;l3_ffn_residual -->
<g id="edge182" class="edge">
<title>l3_ffn_allreduce&#45;&gt;l3_ffn_residual</title>
<path fill="none" stroke="black" d="M4614.51,-516.04C4614.51,-516.04 4614.51,-386.41 4614.51,-386.41"/>
<polygon fill="black" stroke="black" points="4618.01,-386.41 4614.51,-376.41 4611.01,-386.41 4618.01,-386.41"/>
</g>
<!-- l3_layernorm -->
<g id="node133" class="node">
<title>l3_layernorm</title>
<polygon fill="lightgreen" stroke="black" points="5058,-236.17 4604,-236.17 4604,-168.17 5058,-168.17 5058,-236.17"/>
<text text-anchor="middle" x="4831" y="-220.97" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="4831" y="-205.97" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4831" y="-190.97" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4831" y="-175.97" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: All</text>
</g>
<!-- l3_ffn_residual&#45;&gt;l3_layernorm -->
<g id="edge183" class="edge">
<title>l3_ffn_residual&#45;&gt;l3_layernorm</title>
<path fill="none" stroke="black" d="M4831,-307.92C4831,-307.92 4831,-246.55 4831,-246.55"/>
<polygon fill="black" stroke="black" points="4834.5,-246.55 4831,-236.55 4827.5,-246.55 4834.5,-246.55"/>
</g>
<!-- output -->
<g id="node134" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="4831" cy="-48.08" rx="321.05" ry="48.17"/>
<text text-anchor="middle" x="4831" y="-66.88" font-family="Helvetica,sans-Serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="4831" y="-51.88" font-family="Helvetica,sans-Serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4831" y="-36.88" font-family="Helvetica,sans-Serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4831" y="-21.88" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12&#45;15</text>
</g>
<!-- l3_layernorm&#45;&gt;output -->
<g id="edge184" class="edge">
<title>l3_layernorm&#45;&gt;output</title>
<path fill="none" stroke="black" d="M4831,-167.97C4831,-167.97 4831,-106.21 4831,-106.21"/>
<polygon fill="black" stroke="black" points="4834.5,-106.21 4831,-96.21 4827.5,-106.21 4834.5,-106.21"/>
</g>
<!-- send_l0_l1&#45;&gt;l1_input_broadcast -->
<g id="edge47" class="edge">
<title>send_l0_l1&#45;&gt;l1_input_broadcast</title>
<path fill="none" stroke="black" d="M3289,-7404.15C3289,-7404.15 3289,-7342.62 3289,-7342.62"/>
<polygon fill="black" stroke="black" points="3292.5,-7342.62 3289,-7332.62 3285.5,-7342.62 3292.5,-7342.62"/>
</g>
<!-- send_l1_l2&#45;&gt;l2_input_broadcast -->
<g id="edge93" class="edge">
<title>send_l1_l2&#45;&gt;l2_input_broadcast</title>
<path fill="none" stroke="black" d="M4251,-4935.98C4251,-4935.98 4251,-4874.45 4251,-4874.45"/>
<polygon fill="black" stroke="black" points="4254.5,-4874.45 4251,-4864.45 4247.5,-4874.45 4254.5,-4874.45"/>
</g>
<!-- send_l2_l3&#45;&gt;l3_input_broadcast -->
<g id="edge139" class="edge">
<title>send_l2_l3&#45;&gt;l3_input_broadcast</title>
<path fill="none" stroke="black" d="M4497,-2467.81C4497,-2467.81 4497,-2406.28 4497,-2406.28"/>
<polygon fill="black" stroke="black" points="4500.5,-2406.28 4497,-2396.28 4493.5,-2406.28 4500.5,-2406.28"/>
</g>
</g>
</svg>
