<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Llama_405B_Helix_Parallelism Pages: 1 -->
<svg width="2880pt" height="783pt"
 viewBox="0.00 0.00 2880.00 783.49" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.3 0.3) rotate(0) translate(4 2590.09)">
<title>Llama_405B_Helix_Parallelism</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2590.09 9531.48,-2590.09 9531.48,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="4156" cy="-2538.01" rx="306.77" ry="48.17"/>
<text text-anchor="middle" x="4156" y="-2556.81" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="4156" y="-2541.81" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="4156" y="-2526.81" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="4156" y="-2511.81" font-family="Times,serif" font-size="14.00">Device: CPU</text>
</g>
<!-- split_all_gpus -->
<g id="node2" class="node">
<title>split_all_gpus</title>
<polygon fill="yellow" stroke="black" points="4605.9,-2453.93 3890.21,-2453.93 3706.1,-2317.93 4421.79,-2317.93 4605.9,-2453.93"/>
<text text-anchor="middle" x="4156" y="-2404.73" font-family="Times,serif" font-size="14.00">Split Input</text>
<text text-anchor="middle" x="4156" y="-2389.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="4156" y="-2374.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="4156" y="-2359.73" font-family="Times,serif" font-size="14.00">Device: all GPUs</text>
</g>
<!-- input&#45;&gt;split_all_gpus -->
<g id="edge1" class="edge">
<title>input&#45;&gt;split_all_gpus</title>
<path fill="none" stroke="black" d="M4156,-2489.52C4156,-2481.44 4156,-2472.85 4156,-2464.23"/>
<polygon fill="black" stroke="black" points="4159.5,-2464.12 4156,-2454.12 4152.5,-2464.12 4159.5,-2464.12"/>
</g>
<!-- qkv_proj_gpu_0 -->
<g id="node3" class="node">
<title>qkv_proj_gpu_0</title>
<polygon fill="lightcoral" stroke="black" points="472,-2281.93 0,-2281.93 0,-2198.93 472,-2198.93 472,-2281.93"/>
<text text-anchor="middle" x="236" y="-2266.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="236" y="-2251.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="236" y="-2236.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="236" y="-2221.73" font-family="Times,serif" font-size="14.00">Device: gpu_0</text>
<text text-anchor="middle" x="236" y="-2206.73" font-family="Times,serif" font-size="14.00">Queries: 0&#45;31, KV: 0&#45;1</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_0 -->
<g id="edge2" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_0</title>
<path fill="none" stroke="black" d="M3791.35,-2381.01C2997.85,-2371.46 1134.18,-2343.21 482.24,-2282"/>
<polygon fill="black" stroke="black" points="482.55,-2278.51 472.26,-2281.05 481.88,-2285.48 482.55,-2278.51"/>
</g>
<!-- qkv_proj_gpu_1 -->
<g id="node4" class="node">
<title>qkv_proj_gpu_1</title>
<polygon fill="lightcoral" stroke="black" points="962,-2281.93 490,-2281.93 490,-2198.93 962,-2198.93 962,-2281.93"/>
<text text-anchor="middle" x="726" y="-2266.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="726" y="-2251.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="726" y="-2236.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="726" y="-2221.73" font-family="Times,serif" font-size="14.00">Device: gpu_1</text>
<text text-anchor="middle" x="726" y="-2206.73" font-family="Times,serif" font-size="14.00">Queries: 0&#45;31, KV: 0&#45;1</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_1 -->
<g id="edge5" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_1</title>
<path fill="none" stroke="black" d="M3788.69,-2379.12C3075.68,-2366.86 1526.28,-2335.08 972.35,-2282.01"/>
<polygon fill="black" stroke="black" points="972.55,-2278.52 962.26,-2281.03 971.88,-2285.48 972.55,-2278.52"/>
</g>
<!-- qkv_proj_gpu_2 -->
<g id="node5" class="node">
<title>qkv_proj_gpu_2</title>
<polygon fill="lightcoral" stroke="black" points="1452,-2281.93 980,-2281.93 980,-2198.93 1452,-2198.93 1452,-2281.93"/>
<text text-anchor="middle" x="1216" y="-2266.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1216" y="-2251.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="1216" y="-2236.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1216" y="-2221.73" font-family="Times,serif" font-size="14.00">Device: gpu_2</text>
<text text-anchor="middle" x="1216" y="-2206.73" font-family="Times,serif" font-size="14.00">Queries: 0&#45;31, KV: 0&#45;1</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_2 -->
<g id="edge8" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_2</title>
<path fill="none" stroke="black" d="M3797.54,-2385.52C3282.3,-2383.14 2302.78,-2366.58 1462.45,-2282.04"/>
<polygon fill="black" stroke="black" points="1462.57,-2278.53 1452.26,-2281.01 1461.86,-2285.5 1462.57,-2278.53"/>
</g>
<!-- qkv_proj_gpu_3 -->
<g id="node6" class="node">
<title>qkv_proj_gpu_3</title>
<polygon fill="lightcoral" stroke="black" points="1942,-2281.93 1470,-2281.93 1470,-2198.93 1942,-2198.93 1942,-2281.93"/>
<text text-anchor="middle" x="1706" y="-2266.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1706" y="-2251.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="1706" y="-2236.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1706" y="-2221.73" font-family="Times,serif" font-size="14.00">Device: gpu_3</text>
<text text-anchor="middle" x="1706" y="-2206.73" font-family="Times,serif" font-size="14.00">Queries: 0&#45;31, KV: 0&#45;1</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_3 -->
<g id="edge11" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_3</title>
<path fill="none" stroke="black" d="M3791.17,-2380.95C3355.32,-2373.2 2604.25,-2350.35 1952.34,-2282.03"/>
<polygon fill="black" stroke="black" points="1952.58,-2278.54 1942.27,-2280.97 1951.85,-2285.5 1952.58,-2278.54"/>
</g>
<!-- qkv_proj_gpu_4 -->
<g id="node7" class="node">
<title>qkv_proj_gpu_4</title>
<polygon fill="lightcoral" stroke="black" points="2432,-2281.93 1960,-2281.93 1960,-2198.93 2432,-2198.93 2432,-2281.93"/>
<text text-anchor="middle" x="2196" y="-2266.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2196" y="-2251.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="2196" y="-2236.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2196" y="-2221.73" font-family="Times,serif" font-size="14.00">Device: gpu_4</text>
<text text-anchor="middle" x="2196" y="-2206.73" font-family="Times,serif" font-size="14.00">Queries: 32&#45;63, KV: 2&#45;3</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_4 -->
<g id="edge14" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_4</title>
<path fill="none" stroke="black" d="M3781.18,-2373.62C3435.56,-2360.56 2908.34,-2333.98 2442.24,-2282.03"/>
<polygon fill="black" stroke="black" points="2442.6,-2278.55 2432.27,-2280.92 2441.82,-2285.51 2442.6,-2278.55"/>
</g>
<!-- qkv_proj_gpu_5 -->
<g id="node8" class="node">
<title>qkv_proj_gpu_5</title>
<polygon fill="lightcoral" stroke="black" points="2922,-2281.93 2450,-2281.93 2450,-2198.93 2922,-2198.93 2922,-2281.93"/>
<text text-anchor="middle" x="2686" y="-2266.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2686" y="-2251.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="2686" y="-2236.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2686" y="-2221.73" font-family="Times,serif" font-size="14.00">Device: gpu_5</text>
<text text-anchor="middle" x="2686" y="-2206.73" font-family="Times,serif" font-size="14.00">Queries: 32&#45;63, KV: 2&#45;3</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_5 -->
<g id="edge17" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_5</title>
<path fill="none" stroke="black" d="M3762.78,-2359.89C3524.94,-2342.78 3215.53,-2317.04 2932.35,-2282.07"/>
<polygon fill="black" stroke="black" points="2932.64,-2278.58 2922.29,-2280.82 2931.78,-2285.52 2932.64,-2278.58"/>
</g>
<!-- qkv_proj_gpu_6 -->
<g id="node9" class="node">
<title>qkv_proj_gpu_6</title>
<polygon fill="lightcoral" stroke="black" points="3412,-2281.93 2940,-2281.93 2940,-2198.93 3412,-2198.93 3412,-2281.93"/>
<text text-anchor="middle" x="3176" y="-2266.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3176" y="-2251.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="3176" y="-2236.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3176" y="-2221.73" font-family="Times,serif" font-size="14.00">Device: gpu_6</text>
<text text-anchor="middle" x="3176" y="-2206.73" font-family="Times,serif" font-size="14.00">Queries: 32&#45;63, KV: 2&#45;3</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_6 -->
<g id="edge20" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_6</title>
<path fill="none" stroke="black" d="M3715.58,-2325.01C3621.62,-2311.74 3522.8,-2297.42 3422.36,-2282.12"/>
<polygon fill="black" stroke="black" points="3422.73,-2278.64 3412.32,-2280.59 3421.67,-2285.56 3422.73,-2278.64"/>
</g>
<!-- qkv_proj_gpu_7 -->
<g id="node10" class="node">
<title>qkv_proj_gpu_7</title>
<polygon fill="lightcoral" stroke="black" points="3902,-2281.93 3430,-2281.93 3430,-2198.93 3902,-2198.93 3902,-2281.93"/>
<text text-anchor="middle" x="3666" y="-2266.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3666" y="-2251.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="3666" y="-2236.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3666" y="-2221.73" font-family="Times,serif" font-size="14.00">Device: gpu_7</text>
<text text-anchor="middle" x="3666" y="-2206.73" font-family="Times,serif" font-size="14.00">Queries: 32&#45;63, KV: 2&#45;3</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_7 -->
<g id="edge23" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_7</title>
<path fill="none" stroke="black" d="M3927.14,-2317.9C3888.86,-2306.69 3850.05,-2295.33 3814.47,-2284.91"/>
<polygon fill="black" stroke="black" points="3815.11,-2281.45 3804.53,-2281.99 3813.14,-2288.16 3815.11,-2281.45"/>
</g>
<!-- qkv_proj_gpu_8 -->
<g id="node11" class="node">
<title>qkv_proj_gpu_8</title>
<polygon fill="lightcoral" stroke="black" points="4392,-2281.93 3920,-2281.93 3920,-2198.93 4392,-2198.93 4392,-2281.93"/>
<text text-anchor="middle" x="4156" y="-2266.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4156" y="-2251.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="4156" y="-2236.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4156" y="-2221.73" font-family="Times,serif" font-size="14.00">Device: gpu_8</text>
<text text-anchor="middle" x="4156" y="-2206.73" font-family="Times,serif" font-size="14.00">Queries: 64&#45;95, KV: 4&#45;5</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_8 -->
<g id="edge26" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_8</title>
<path fill="none" stroke="black" d="M4156,-2317.8C4156,-2309.18 4156,-2300.48 4156,-2292.18"/>
<polygon fill="black" stroke="black" points="4159.5,-2291.93 4156,-2281.93 4152.5,-2291.93 4159.5,-2291.93"/>
</g>
<!-- qkv_proj_gpu_9 -->
<g id="node12" class="node">
<title>qkv_proj_gpu_9</title>
<polygon fill="lightcoral" stroke="black" points="4882,-2281.93 4410,-2281.93 4410,-2198.93 4882,-2198.93 4882,-2281.93"/>
<text text-anchor="middle" x="4646" y="-2266.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4646" y="-2251.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="4646" y="-2236.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4646" y="-2221.73" font-family="Times,serif" font-size="14.00">Device: gpu_9</text>
<text text-anchor="middle" x="4646" y="-2206.73" font-family="Times,serif" font-size="14.00">Queries: 64&#45;95, KV: 4&#45;5</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_9 -->
<g id="edge29" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_9</title>
<path fill="none" stroke="black" d="M4384.86,-2317.9C4423.14,-2306.69 4461.95,-2295.33 4497.53,-2284.91"/>
<polygon fill="black" stroke="black" points="4498.86,-2288.16 4507.47,-2281.99 4496.89,-2281.45 4498.86,-2288.16"/>
</g>
<!-- qkv_proj_gpu_10 -->
<g id="node13" class="node">
<title>qkv_proj_gpu_10</title>
<polygon fill="lightcoral" stroke="black" points="5372,-2281.93 4900,-2281.93 4900,-2198.93 5372,-2198.93 5372,-2281.93"/>
<text text-anchor="middle" x="5136" y="-2266.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5136" y="-2251.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="5136" y="-2236.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5136" y="-2221.73" font-family="Times,serif" font-size="14.00">Device: gpu_10</text>
<text text-anchor="middle" x="5136" y="-2206.73" font-family="Times,serif" font-size="14.00">Queries: 64&#45;95, KV: 4&#45;5</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_10 -->
<g id="edge32" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_10</title>
<path fill="none" stroke="black" d="M4457.97,-2344.31C4587.9,-2326.41 4741.74,-2304.64 4889.51,-2282.15"/>
<polygon fill="black" stroke="black" points="4890.32,-2285.56 4899.68,-2280.59 4889.27,-2278.64 4890.32,-2285.56"/>
</g>
<!-- qkv_proj_gpu_11 -->
<g id="node14" class="node">
<title>qkv_proj_gpu_11</title>
<polygon fill="lightcoral" stroke="black" points="5862,-2281.93 5390,-2281.93 5390,-2198.93 5862,-2198.93 5862,-2281.93"/>
<text text-anchor="middle" x="5626" y="-2266.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5626" y="-2251.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="5626" y="-2236.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5626" y="-2221.73" font-family="Times,serif" font-size="14.00">Device: gpu_11</text>
<text text-anchor="middle" x="5626" y="-2206.73" font-family="Times,serif" font-size="14.00">Queries: 64&#45;95, KV: 4&#45;5</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_11 -->
<g id="edge35" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_11</title>
<path fill="none" stroke="black" d="M4484.95,-2364.43C4729.35,-2347.49 5070.98,-2320.19 5379.67,-2282.07"/>
<polygon fill="black" stroke="black" points="5380.22,-2285.52 5389.71,-2280.82 5379.36,-2278.58 5380.22,-2285.52"/>
</g>
<!-- qkv_proj_gpu_12 -->
<g id="node15" class="node">
<title>qkv_proj_gpu_12</title>
<polygon fill="lightcoral" stroke="black" points="6352,-2281.93 5880,-2281.93 5880,-2198.93 6352,-2198.93 6352,-2281.93"/>
<text text-anchor="middle" x="6116" y="-2266.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6116" y="-2251.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="6116" y="-2236.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6116" y="-2221.73" font-family="Times,serif" font-size="14.00">Device: gpu_12</text>
<text text-anchor="middle" x="6116" y="-2206.73" font-family="Times,serif" font-size="14.00">Queries: 96&#45;127, KV: 6&#45;7</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_12 -->
<g id="edge38" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_12</title>
<path fill="none" stroke="black" d="M4498.96,-2374.81C4843.36,-2362.2 5389.13,-2335.58 5869.46,-2282.07"/>
<polygon fill="black" stroke="black" points="5870.18,-2285.51 5879.73,-2280.92 5869.4,-2278.55 5870.18,-2285.51"/>
</g>
<!-- qkv_proj_gpu_13 -->
<g id="node16" class="node">
<title>qkv_proj_gpu_13</title>
<polygon fill="lightcoral" stroke="black" points="6842,-2281.93 6370,-2281.93 6370,-2198.93 6842,-2198.93 6842,-2281.93"/>
<text text-anchor="middle" x="6606" y="-2266.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6606" y="-2251.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="6606" y="-2236.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6606" y="-2221.73" font-family="Times,serif" font-size="14.00">Device: gpu_13</text>
<text text-anchor="middle" x="6606" y="-2206.73" font-family="Times,serif" font-size="14.00">Queries: 96&#45;127, KV: 6&#45;7</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_13 -->
<g id="edge41" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_13</title>
<path fill="none" stroke="black" d="M4507.83,-2381.18C4941.61,-2373.66 5701.23,-2351.03 6359.56,-2282.04"/>
<polygon fill="black" stroke="black" points="6360.15,-2285.5 6369.73,-2280.97 6359.42,-2278.54 6360.15,-2285.5"/>
</g>
<!-- qkv_proj_gpu_14 -->
<g id="node17" class="node">
<title>qkv_proj_gpu_14</title>
<polygon fill="lightcoral" stroke="black" points="7332,-2281.93 6860,-2281.93 6860,-2198.93 7332,-2198.93 7332,-2281.93"/>
<text text-anchor="middle" x="7096" y="-2266.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7096" y="-2251.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="7096" y="-2236.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7096" y="-2221.73" font-family="Times,serif" font-size="14.00">Device: gpu_14</text>
<text text-anchor="middle" x="7096" y="-2206.73" font-family="Times,serif" font-size="14.00">Queries: 96&#45;127, KV: 6&#45;7</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_14 -->
<g id="edge44" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_14</title>
<path fill="none" stroke="black" d="M4513.38,-2385.52C5028.33,-2383.16 6008.63,-2366.64 6849.54,-2282.04"/>
<polygon fill="black" stroke="black" points="6850.14,-2285.5 6859.74,-2281.01 6849.43,-2278.53 6850.14,-2285.5"/>
</g>
<!-- qkv_proj_gpu_15 -->
<g id="node18" class="node">
<title>qkv_proj_gpu_15</title>
<polygon fill="lightcoral" stroke="black" points="7822,-2281.93 7350,-2281.93 7350,-2198.93 7822,-2198.93 7822,-2281.93"/>
<text text-anchor="middle" x="7586" y="-2266.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7586" y="-2251.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="7586" y="-2236.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7586" y="-2221.73" font-family="Times,serif" font-size="14.00">Device: gpu_15</text>
<text text-anchor="middle" x="7586" y="-2206.73" font-family="Times,serif" font-size="14.00">Queries: 96&#45;127, KV: 6&#45;7</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_15 -->
<g id="edge47" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_15</title>
<path fill="none" stroke="black" d="M4505.19,-2379.43C5209.7,-2367.41 6780.9,-2335.53 7339.56,-2282.02"/>
<polygon fill="black" stroke="black" points="7340.12,-2285.48 7349.74,-2281.03 7339.45,-2278.52 7340.12,-2285.48"/>
</g>
<!-- residual_attn -->
<g id="node73" class="node">
<title>residual_attn</title>
<ellipse fill="lightgreen" stroke="black" cx="6179" cy="-1096.24" rx="306.77" ry="58.88"/>
<text text-anchor="middle" x="6179" y="-1122.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6179" y="-1107.54" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6179" y="-1092.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="6179" y="-1077.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="6179" y="-1062.54" font-family="Times,serif" font-size="14.00">Device: all GPUs</text>
</g>
<!-- split_all_gpus&#45;&gt;residual_attn -->
<g id="edge115" class="edge">
<title>split_all_gpus&#45;&gt;residual_attn</title>
<path fill="none" stroke="black" d="M4507.42,-2381.1C5414.84,-2370.45 7770.16,-2337.5 7831,-2281.93 7883.71,-2233.78 7850,-2193.82 7850,-2122.43 7850,-2122.43 7850,-2122.43 7850,-1433.43 7850,-1413.54 7846.77,-1405.03 7831,-1392.93 7623.3,-1233.51 6892.98,-1152.19 6476.24,-1117.88"/>
<polygon fill="black" stroke="black" points="6476.4,-1114.39 6466.15,-1117.06 6475.83,-1121.36 6476.4,-1114.39"/>
</g>
<!-- kv_cache_gpu_0 -->
<g id="node19" class="node">
<title>kv_cache_gpu_0</title>
<polygon fill="lightpink" stroke="black" points="467.5,-2162.93 22.5,-2162.93 22.5,-2079.93 467.5,-2079.93 467.5,-2162.93"/>
<text text-anchor="middle" x="245" y="-2147.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="245" y="-2132.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="245" y="-2117.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="245" y="-2102.73" font-family="Times,serif" font-size="14.00">Device: gpu_0</text>
<text text-anchor="middle" x="245" y="-2087.73" font-family="Times,serif" font-size="14.00">Sequence: 0&#45;249999</text>
</g>
<!-- qkv_proj_gpu_0&#45;&gt;kv_cache_gpu_0 -->
<g id="edge3" class="edge">
<title>qkv_proj_gpu_0&#45;&gt;kv_cache_gpu_0</title>
<path fill="none" stroke="black" d="M239.12,-2198.83C239.76,-2190.48 240.45,-2181.6 241.11,-2172.95"/>
<polygon fill="black" stroke="black" points="244.61,-2173.19 241.88,-2162.95 237.63,-2172.65 244.61,-2173.19"/>
</g>
<!-- kv_cache_gpu_1 -->
<g id="node20" class="node">
<title>kv_cache_gpu_1</title>
<polygon fill="lightpink" stroke="black" points="962.5,-2162.93 517.5,-2162.93 517.5,-2079.93 962.5,-2079.93 962.5,-2162.93"/>
<text text-anchor="middle" x="740" y="-2147.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="740" y="-2132.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="740" y="-2117.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="740" y="-2102.73" font-family="Times,serif" font-size="14.00">Device: gpu_1</text>
<text text-anchor="middle" x="740" y="-2087.73" font-family="Times,serif" font-size="14.00">Sequence: 0&#45;249999</text>
</g>
<!-- qkv_proj_gpu_1&#45;&gt;kv_cache_gpu_1 -->
<g id="edge6" class="edge">
<title>qkv_proj_gpu_1&#45;&gt;kv_cache_gpu_1</title>
<path fill="none" stroke="black" d="M730.86,-2198.83C731.86,-2190.48 732.92,-2181.6 733.95,-2172.95"/>
<polygon fill="black" stroke="black" points="737.44,-2173.29 735.15,-2162.95 730.49,-2172.46 737.44,-2173.29"/>
</g>
<!-- kv_cache_gpu_2 -->
<g id="node21" class="node">
<title>kv_cache_gpu_2</title>
<polygon fill="lightpink" stroke="black" points="1446.5,-2162.93 1001.5,-2162.93 1001.5,-2079.93 1446.5,-2079.93 1446.5,-2162.93"/>
<text text-anchor="middle" x="1224" y="-2147.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="1224" y="-2132.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="1224" y="-2117.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="1224" y="-2102.73" font-family="Times,serif" font-size="14.00">Device: gpu_2</text>
<text text-anchor="middle" x="1224" y="-2087.73" font-family="Times,serif" font-size="14.00">Sequence: 0&#45;249999</text>
</g>
<!-- qkv_proj_gpu_2&#45;&gt;kv_cache_gpu_2 -->
<g id="edge9" class="edge">
<title>qkv_proj_gpu_2&#45;&gt;kv_cache_gpu_2</title>
<path fill="none" stroke="black" d="M1218.78,-2198.83C1219.35,-2190.48 1219.95,-2181.6 1220.55,-2172.95"/>
<polygon fill="black" stroke="black" points="1224.04,-2173.16 1221.23,-2162.95 1217.06,-2172.68 1224.04,-2173.16"/>
</g>
<!-- kv_cache_gpu_3 -->
<g id="node22" class="node">
<title>kv_cache_gpu_3</title>
<polygon fill="lightpink" stroke="black" points="1935.5,-2162.93 1490.5,-2162.93 1490.5,-2079.93 1935.5,-2079.93 1935.5,-2162.93"/>
<text text-anchor="middle" x="1713" y="-2147.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="1713" y="-2132.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="1713" y="-2117.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="1713" y="-2102.73" font-family="Times,serif" font-size="14.00">Device: gpu_3</text>
<text text-anchor="middle" x="1713" y="-2087.73" font-family="Times,serif" font-size="14.00">Sequence: 0&#45;249999</text>
</g>
<!-- qkv_proj_gpu_3&#45;&gt;kv_cache_gpu_3 -->
<g id="edge12" class="edge">
<title>qkv_proj_gpu_3&#45;&gt;kv_cache_gpu_3</title>
<path fill="none" stroke="black" d="M1708.43,-2198.83C1708.93,-2190.48 1709.46,-2181.6 1709.98,-2172.95"/>
<polygon fill="black" stroke="black" points="1713.47,-2173.14 1710.58,-2162.95 1706.48,-2172.72 1713.47,-2173.14"/>
</g>
<!-- kv_cache_gpu_4 -->
<g id="node23" class="node">
<title>kv_cache_gpu_4</title>
<polygon fill="lightpink" stroke="black" points="2436.5,-2162.93 1991.5,-2162.93 1991.5,-2079.93 2436.5,-2079.93 2436.5,-2162.93"/>
<text text-anchor="middle" x="2214" y="-2147.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="2214" y="-2132.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="2214" y="-2117.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="2214" y="-2102.73" font-family="Times,serif" font-size="14.00">Device: gpu_4</text>
<text text-anchor="middle" x="2214" y="-2087.73" font-family="Times,serif" font-size="14.00">Sequence: 250000&#45;499999</text>
</g>
<!-- qkv_proj_gpu_4&#45;&gt;kv_cache_gpu_4 -->
<g id="edge15" class="edge">
<title>qkv_proj_gpu_4&#45;&gt;kv_cache_gpu_4</title>
<path fill="none" stroke="black" d="M2202.25,-2198.83C2203.53,-2190.48 2204.9,-2181.6 2206.23,-2172.95"/>
<polygon fill="black" stroke="black" points="2209.7,-2173.36 2207.77,-2162.95 2202.79,-2172.3 2209.7,-2173.36"/>
</g>
<!-- kv_cache_gpu_5 -->
<g id="node24" class="node">
<title>kv_cache_gpu_5</title>
<polygon fill="lightpink" stroke="black" points="2924.5,-2162.93 2479.5,-2162.93 2479.5,-2079.93 2924.5,-2079.93 2924.5,-2162.93"/>
<text text-anchor="middle" x="2702" y="-2147.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="2702" y="-2132.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="2702" y="-2117.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="2702" y="-2102.73" font-family="Times,serif" font-size="14.00">Device: gpu_5</text>
<text text-anchor="middle" x="2702" y="-2087.73" font-family="Times,serif" font-size="14.00">Sequence: 250000&#45;499999</text>
</g>
<!-- qkv_proj_gpu_5&#45;&gt;kv_cache_gpu_5 -->
<g id="edge18" class="edge">
<title>qkv_proj_gpu_5&#45;&gt;kv_cache_gpu_5</title>
<path fill="none" stroke="black" d="M2691.55,-2198.83C2692.69,-2190.48 2693.91,-2181.6 2695.09,-2172.95"/>
<polygon fill="black" stroke="black" points="2698.57,-2173.33 2696.46,-2162.95 2691.64,-2172.38 2698.57,-2173.33"/>
</g>
<!-- kv_cache_gpu_6 -->
<g id="node25" class="node">
<title>kv_cache_gpu_6</title>
<polygon fill="lightpink" stroke="black" points="3400.5,-2162.93 2955.5,-2162.93 2955.5,-2079.93 3400.5,-2079.93 3400.5,-2162.93"/>
<text text-anchor="middle" x="3178" y="-2147.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="3178" y="-2132.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3178" y="-2117.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3178" y="-2102.73" font-family="Times,serif" font-size="14.00">Device: gpu_6</text>
<text text-anchor="middle" x="3178" y="-2087.73" font-family="Times,serif" font-size="14.00">Sequence: 250000&#45;499999</text>
</g>
<!-- qkv_proj_gpu_6&#45;&gt;kv_cache_gpu_6 -->
<g id="edge21" class="edge">
<title>qkv_proj_gpu_6&#45;&gt;kv_cache_gpu_6</title>
<path fill="none" stroke="black" d="M3176.69,-2198.83C3176.84,-2190.48 3176.99,-2181.6 3177.14,-2172.95"/>
<polygon fill="black" stroke="black" points="3180.64,-2173.01 3177.31,-2162.95 3173.64,-2172.89 3180.64,-2173.01"/>
</g>
<!-- kv_cache_gpu_7 -->
<g id="node26" class="node">
<title>kv_cache_gpu_7</title>
<polygon fill="lightpink" stroke="black" points="3884.5,-2162.93 3439.5,-2162.93 3439.5,-2079.93 3884.5,-2079.93 3884.5,-2162.93"/>
<text text-anchor="middle" x="3662" y="-2147.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="3662" y="-2132.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3662" y="-2117.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3662" y="-2102.73" font-family="Times,serif" font-size="14.00">Device: gpu_7</text>
<text text-anchor="middle" x="3662" y="-2087.73" font-family="Times,serif" font-size="14.00">Sequence: 250000&#45;499999</text>
</g>
<!-- qkv_proj_gpu_7&#45;&gt;kv_cache_gpu_7 -->
<g id="edge24" class="edge">
<title>qkv_proj_gpu_7&#45;&gt;kv_cache_gpu_7</title>
<path fill="none" stroke="black" d="M3664.61,-2198.83C3664.33,-2190.48 3664.02,-2181.6 3663.73,-2172.95"/>
<polygon fill="black" stroke="black" points="3667.23,-2172.82 3663.39,-2162.95 3660.23,-2173.06 3667.23,-2172.82"/>
</g>
<!-- kv_cache_gpu_8 -->
<g id="node27" class="node">
<title>kv_cache_gpu_8</title>
<polygon fill="lightpink" stroke="black" points="4380.5,-2162.93 3935.5,-2162.93 3935.5,-2079.93 4380.5,-2079.93 4380.5,-2162.93"/>
<text text-anchor="middle" x="4158" y="-2147.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="4158" y="-2132.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="4158" y="-2117.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="4158" y="-2102.73" font-family="Times,serif" font-size="14.00">Device: gpu_8</text>
<text text-anchor="middle" x="4158" y="-2087.73" font-family="Times,serif" font-size="14.00">Sequence: 500000&#45;749999</text>
</g>
<!-- qkv_proj_gpu_8&#45;&gt;kv_cache_gpu_8 -->
<g id="edge27" class="edge">
<title>qkv_proj_gpu_8&#45;&gt;kv_cache_gpu_8</title>
<path fill="none" stroke="black" d="M4156.69,-2198.83C4156.84,-2190.48 4156.99,-2181.6 4157.14,-2172.95"/>
<polygon fill="black" stroke="black" points="4160.64,-2173.01 4157.31,-2162.95 4153.64,-2172.89 4160.64,-2173.01"/>
</g>
<!-- kv_cache_gpu_9 -->
<g id="node28" class="node">
<title>kv_cache_gpu_9</title>
<polygon fill="lightpink" stroke="black" points="4864.5,-2162.93 4419.5,-2162.93 4419.5,-2079.93 4864.5,-2079.93 4864.5,-2162.93"/>
<text text-anchor="middle" x="4642" y="-2147.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="4642" y="-2132.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="4642" y="-2117.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="4642" y="-2102.73" font-family="Times,serif" font-size="14.00">Device: gpu_9</text>
<text text-anchor="middle" x="4642" y="-2087.73" font-family="Times,serif" font-size="14.00">Sequence: 500000&#45;749999</text>
</g>
<!-- qkv_proj_gpu_9&#45;&gt;kv_cache_gpu_9 -->
<g id="edge30" class="edge">
<title>qkv_proj_gpu_9&#45;&gt;kv_cache_gpu_9</title>
<path fill="none" stroke="black" d="M4644.61,-2198.83C4644.33,-2190.48 4644.02,-2181.6 4643.73,-2172.95"/>
<polygon fill="black" stroke="black" points="4647.23,-2172.82 4643.39,-2162.95 4640.23,-2173.06 4647.23,-2172.82"/>
</g>
<!-- kv_cache_gpu_10 -->
<g id="node29" class="node">
<title>kv_cache_gpu_10</title>
<polygon fill="lightpink" stroke="black" points="5353.5,-2162.93 4908.5,-2162.93 4908.5,-2079.93 5353.5,-2079.93 5353.5,-2162.93"/>
<text text-anchor="middle" x="5131" y="-2147.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="5131" y="-2132.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="5131" y="-2117.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="5131" y="-2102.73" font-family="Times,serif" font-size="14.00">Device: gpu_10</text>
<text text-anchor="middle" x="5131" y="-2087.73" font-family="Times,serif" font-size="14.00">Sequence: 500000&#45;749999</text>
</g>
<!-- qkv_proj_gpu_10&#45;&gt;kv_cache_gpu_10 -->
<g id="edge33" class="edge">
<title>qkv_proj_gpu_10&#45;&gt;kv_cache_gpu_10</title>
<path fill="none" stroke="black" d="M5134.27,-2198.83C5133.91,-2190.48 5133.53,-2181.6 5133.16,-2172.95"/>
<polygon fill="black" stroke="black" points="5136.66,-2172.79 5132.73,-2162.95 5129.66,-2173.09 5136.66,-2172.79"/>
</g>
<!-- kv_cache_gpu_11 -->
<g id="node30" class="node">
<title>kv_cache_gpu_11</title>
<polygon fill="lightpink" stroke="black" points="5832.5,-2162.93 5387.5,-2162.93 5387.5,-2079.93 5832.5,-2079.93 5832.5,-2162.93"/>
<text text-anchor="middle" x="5610" y="-2147.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="5610" y="-2132.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="5610" y="-2117.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="5610" y="-2102.73" font-family="Times,serif" font-size="14.00">Device: gpu_11</text>
<text text-anchor="middle" x="5610" y="-2087.73" font-family="Times,serif" font-size="14.00">Sequence: 500000&#45;749999</text>
</g>
<!-- qkv_proj_gpu_11&#45;&gt;kv_cache_gpu_11 -->
<g id="edge36" class="edge">
<title>qkv_proj_gpu_11&#45;&gt;kv_cache_gpu_11</title>
<path fill="none" stroke="black" d="M5620.45,-2198.83C5619.31,-2190.48 5618.09,-2181.6 5616.91,-2172.95"/>
<polygon fill="black" stroke="black" points="5620.36,-2172.38 5615.54,-2162.95 5613.43,-2173.33 5620.36,-2172.38"/>
</g>
<!-- kv_cache_gpu_12 -->
<g id="node31" class="node">
<title>kv_cache_gpu_12</title>
<polygon fill="lightpink" stroke="black" points="6321.5,-2162.93 5876.5,-2162.93 5876.5,-2079.93 6321.5,-2079.93 6321.5,-2162.93"/>
<text text-anchor="middle" x="6099" y="-2147.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="6099" y="-2132.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="6099" y="-2117.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="6099" y="-2102.73" font-family="Times,serif" font-size="14.00">Device: gpu_12</text>
<text text-anchor="middle" x="6099" y="-2087.73" font-family="Times,serif" font-size="14.00">Sequence: 750000&#45;999999</text>
</g>
<!-- qkv_proj_gpu_12&#45;&gt;kv_cache_gpu_12 -->
<g id="edge39" class="edge">
<title>qkv_proj_gpu_12&#45;&gt;kv_cache_gpu_12</title>
<path fill="none" stroke="black" d="M6110.1,-2198.83C6108.89,-2190.48 6107.6,-2181.6 6106.34,-2172.95"/>
<polygon fill="black" stroke="black" points="6109.79,-2172.34 6104.89,-2162.95 6102.86,-2173.35 6109.79,-2172.34"/>
</g>
<!-- kv_cache_gpu_13 -->
<g id="node32" class="node">
<title>kv_cache_gpu_13</title>
<polygon fill="lightpink" stroke="black" points="6811.5,-2162.93 6366.5,-2162.93 6366.5,-2079.93 6811.5,-2079.93 6811.5,-2162.93"/>
<text text-anchor="middle" x="6589" y="-2147.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="6589" y="-2132.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="6589" y="-2117.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="6589" y="-2102.73" font-family="Times,serif" font-size="14.00">Device: gpu_13</text>
<text text-anchor="middle" x="6589" y="-2087.73" font-family="Times,serif" font-size="14.00">Sequence: 750000&#45;999999</text>
</g>
<!-- qkv_proj_gpu_13&#45;&gt;kv_cache_gpu_13 -->
<g id="edge42" class="edge">
<title>qkv_proj_gpu_13&#45;&gt;kv_cache_gpu_13</title>
<path fill="none" stroke="black" d="M6600.1,-2198.83C6598.89,-2190.48 6597.6,-2181.6 6596.34,-2172.95"/>
<polygon fill="black" stroke="black" points="6599.79,-2172.34 6594.89,-2162.95 6592.86,-2173.35 6599.79,-2172.34"/>
</g>
<!-- kv_cache_gpu_14 -->
<g id="node33" class="node">
<title>kv_cache_gpu_14</title>
<polygon fill="lightpink" stroke="black" points="7305.5,-2162.93 6860.5,-2162.93 6860.5,-2079.93 7305.5,-2079.93 7305.5,-2162.93"/>
<text text-anchor="middle" x="7083" y="-2147.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="7083" y="-2132.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="7083" y="-2117.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="7083" y="-2102.73" font-family="Times,serif" font-size="14.00">Device: gpu_14</text>
<text text-anchor="middle" x="7083" y="-2087.73" font-family="Times,serif" font-size="14.00">Sequence: 750000&#45;999999</text>
</g>
<!-- qkv_proj_gpu_14&#45;&gt;kv_cache_gpu_14 -->
<g id="edge45" class="edge">
<title>qkv_proj_gpu_14&#45;&gt;kv_cache_gpu_14</title>
<path fill="none" stroke="black" d="M7091.49,-2198.83C7090.56,-2190.48 7089.57,-2181.6 7088.61,-2172.95"/>
<polygon fill="black" stroke="black" points="7092.09,-2172.5 7087.5,-2162.95 7085.13,-2173.27 7092.09,-2172.5"/>
</g>
<!-- kv_cache_gpu_15 -->
<g id="node34" class="node">
<title>kv_cache_gpu_15</title>
<polygon fill="lightpink" stroke="black" points="7788.5,-2162.93 7343.5,-2162.93 7343.5,-2079.93 7788.5,-2079.93 7788.5,-2162.93"/>
<text text-anchor="middle" x="7566" y="-2147.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="7566" y="-2132.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="7566" y="-2117.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=2, d_k=128]</text>
<text text-anchor="middle" x="7566" y="-2102.73" font-family="Times,serif" font-size="14.00">Device: gpu_15</text>
<text text-anchor="middle" x="7566" y="-2087.73" font-family="Times,serif" font-size="14.00">Sequence: 750000&#45;999999</text>
</g>
<!-- qkv_proj_gpu_15&#45;&gt;kv_cache_gpu_15 -->
<g id="edge48" class="edge">
<title>qkv_proj_gpu_15&#45;&gt;kv_cache_gpu_15</title>
<path fill="none" stroke="black" d="M7579.06,-2198.83C7577.63,-2190.48 7576.11,-2181.6 7574.64,-2172.95"/>
<polygon fill="black" stroke="black" points="7578.06,-2172.21 7572.93,-2162.95 7571.16,-2173.39 7578.06,-2172.21"/>
</g>
<!-- flash_attn_gpu_0 -->
<g id="node35" class="node">
<title>flash_attn_gpu_0</title>
<polygon fill="lightblue" stroke="black" points="500,-2043.93 46,-2043.93 46,-1975.93 500,-1975.93 500,-2043.93"/>
<text text-anchor="middle" x="273" y="-2028.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="273" y="-2013.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="273" y="-1998.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="273" y="-1983.73" font-family="Times,serif" font-size="14.00">Device: gpu_0</text>
</g>
<!-- kv_cache_gpu_0&#45;&gt;flash_attn_gpu_0 -->
<g id="edge4" class="edge">
<title>kv_cache_gpu_0&#45;&gt;flash_attn_gpu_0</title>
<path fill="none" stroke="black" d="M255.43,-2079.65C257.57,-2071.26 259.84,-2062.4 262,-2053.93"/>
<polygon fill="black" stroke="black" points="265.4,-2054.78 264.49,-2044.23 258.62,-2053.05 265.4,-2054.78"/>
</g>
<!-- flash_attn_gpu_1 -->
<g id="node36" class="node">
<title>flash_attn_gpu_1</title>
<polygon fill="lightblue" stroke="black" points="985,-2043.93 531,-2043.93 531,-1975.93 985,-1975.93 985,-2043.93"/>
<text text-anchor="middle" x="758" y="-2028.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="758" y="-2013.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="758" y="-1998.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="758" y="-1983.73" font-family="Times,serif" font-size="14.00">Device: gpu_1</text>
</g>
<!-- kv_cache_gpu_1&#45;&gt;flash_attn_gpu_1 -->
<g id="edge7" class="edge">
<title>kv_cache_gpu_1&#45;&gt;flash_attn_gpu_1</title>
<path fill="none" stroke="black" d="M746.7,-2079.65C748.07,-2071.35 749.51,-2062.59 750.88,-2054.21"/>
<polygon fill="black" stroke="black" points="754.36,-2054.66 752.53,-2044.23 747.45,-2053.53 754.36,-2054.66"/>
</g>
<!-- flash_attn_gpu_2 -->
<g id="node37" class="node">
<title>flash_attn_gpu_2</title>
<polygon fill="lightblue" stroke="black" points="1465,-2043.93 1011,-2043.93 1011,-1975.93 1465,-1975.93 1465,-2043.93"/>
<text text-anchor="middle" x="1238" y="-2028.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="1238" y="-2013.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1238" y="-1998.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1238" y="-1983.73" font-family="Times,serif" font-size="14.00">Device: gpu_2</text>
</g>
<!-- kv_cache_gpu_2&#45;&gt;flash_attn_gpu_2 -->
<g id="edge10" class="edge">
<title>kv_cache_gpu_2&#45;&gt;flash_attn_gpu_2</title>
<path fill="none" stroke="black" d="M1229.21,-2079.65C1230.27,-2071.35 1231.39,-2062.59 1232.47,-2054.21"/>
<polygon fill="black" stroke="black" points="1235.95,-2054.59 1233.74,-2044.23 1229,-2053.7 1235.95,-2054.59"/>
</g>
<!-- flash_attn_gpu_3 -->
<g id="node38" class="node">
<title>flash_attn_gpu_3</title>
<polygon fill="lightblue" stroke="black" points="1944,-2043.93 1490,-2043.93 1490,-1975.93 1944,-1975.93 1944,-2043.93"/>
<text text-anchor="middle" x="1717" y="-2028.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="1717" y="-2013.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1717" y="-1998.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1717" y="-1983.73" font-family="Times,serif" font-size="14.00">Device: gpu_3</text>
</g>
<!-- kv_cache_gpu_3&#45;&gt;flash_attn_gpu_3 -->
<g id="edge13" class="edge">
<title>kv_cache_gpu_3&#45;&gt;flash_attn_gpu_3</title>
<path fill="none" stroke="black" d="M1714.49,-2079.65C1714.79,-2071.44 1715.11,-2062.79 1715.41,-2054.49"/>
<polygon fill="black" stroke="black" points="1718.92,-2054.35 1715.78,-2044.23 1711.92,-2054.09 1718.92,-2054.35"/>
</g>
<!-- flash_attn_gpu_4 -->
<g id="node39" class="node">
<title>flash_attn_gpu_4</title>
<polygon fill="lightblue" stroke="black" points="2451,-2043.93 1997,-2043.93 1997,-1975.93 2451,-1975.93 2451,-2043.93"/>
<text text-anchor="middle" x="2224" y="-2028.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="2224" y="-2013.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2224" y="-1998.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2224" y="-1983.73" font-family="Times,serif" font-size="14.00">Device: gpu_4</text>
</g>
<!-- kv_cache_gpu_4&#45;&gt;flash_attn_gpu_4 -->
<g id="edge16" class="edge">
<title>kv_cache_gpu_4&#45;&gt;flash_attn_gpu_4</title>
<path fill="none" stroke="black" d="M2217.72,-2079.65C2218.48,-2071.35 2219.28,-2062.59 2220.05,-2054.21"/>
<polygon fill="black" stroke="black" points="2223.53,-2054.5 2220.96,-2044.23 2216.56,-2053.87 2223.53,-2054.5"/>
</g>
<!-- flash_attn_gpu_5 -->
<g id="node40" class="node">
<title>flash_attn_gpu_5</title>
<polygon fill="lightblue" stroke="black" points="2933,-2043.93 2479,-2043.93 2479,-1975.93 2933,-1975.93 2933,-2043.93"/>
<text text-anchor="middle" x="2706" y="-2028.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="2706" y="-2013.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2706" y="-1998.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2706" y="-1983.73" font-family="Times,serif" font-size="14.00">Device: gpu_5</text>
</g>
<!-- kv_cache_gpu_5&#45;&gt;flash_attn_gpu_5 -->
<g id="edge19" class="edge">
<title>kv_cache_gpu_5&#45;&gt;flash_attn_gpu_5</title>
<path fill="none" stroke="black" d="M2703.49,-2079.65C2703.79,-2071.44 2704.11,-2062.79 2704.41,-2054.49"/>
<polygon fill="black" stroke="black" points="2707.92,-2054.35 2704.78,-2044.23 2700.92,-2054.09 2707.92,-2054.35"/>
</g>
<!-- flash_attn_gpu_6 -->
<g id="node41" class="node">
<title>flash_attn_gpu_6</title>
<polygon fill="lightblue" stroke="black" points="3407,-2043.93 2953,-2043.93 2953,-1975.93 3407,-1975.93 3407,-2043.93"/>
<text text-anchor="middle" x="3180" y="-2028.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="3180" y="-2013.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3180" y="-1998.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3180" y="-1983.73" font-family="Times,serif" font-size="14.00">Device: gpu_6</text>
</g>
<!-- kv_cache_gpu_6&#45;&gt;flash_attn_gpu_6 -->
<g id="edge22" class="edge">
<title>kv_cache_gpu_6&#45;&gt;flash_attn_gpu_6</title>
<path fill="none" stroke="black" d="M3178.74,-2079.65C3178.89,-2071.44 3179.05,-2062.79 3179.2,-2054.49"/>
<polygon fill="black" stroke="black" points="3182.71,-2054.29 3179.39,-2044.23 3175.71,-2054.16 3182.71,-2054.29"/>
</g>
<!-- flash_attn_gpu_7 -->
<g id="node42" class="node">
<title>flash_attn_gpu_7</title>
<polygon fill="lightblue" stroke="black" points="3888,-2043.93 3434,-2043.93 3434,-1975.93 3888,-1975.93 3888,-2043.93"/>
<text text-anchor="middle" x="3661" y="-2028.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="3661" y="-2013.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3661" y="-1998.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3661" y="-1983.73" font-family="Times,serif" font-size="14.00">Device: gpu_7</text>
</g>
<!-- kv_cache_gpu_7&#45;&gt;flash_attn_gpu_7 -->
<g id="edge25" class="edge">
<title>kv_cache_gpu_7&#45;&gt;flash_attn_gpu_7</title>
<path fill="none" stroke="black" d="M3661.63,-2079.65C3661.55,-2071.44 3661.47,-2062.79 3661.4,-2054.49"/>
<polygon fill="black" stroke="black" points="3664.9,-2054.19 3661.3,-2044.23 3657.9,-2054.26 3664.9,-2054.19"/>
</g>
<!-- flash_attn_gpu_8 -->
<g id="node43" class="node">
<title>flash_attn_gpu_8</title>
<polygon fill="lightblue" stroke="black" points="4394,-2043.93 3940,-2043.93 3940,-1975.93 4394,-1975.93 4394,-2043.93"/>
<text text-anchor="middle" x="4167" y="-2028.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="4167" y="-2013.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4167" y="-1998.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4167" y="-1983.73" font-family="Times,serif" font-size="14.00">Device: gpu_8</text>
</g>
<!-- kv_cache_gpu_8&#45;&gt;flash_attn_gpu_8 -->
<g id="edge28" class="edge">
<title>kv_cache_gpu_8&#45;&gt;flash_attn_gpu_8</title>
<path fill="none" stroke="black" d="M4161.35,-2079.65C4162.03,-2071.35 4162.75,-2062.59 4163.44,-2054.21"/>
<polygon fill="black" stroke="black" points="4166.93,-2054.48 4164.26,-2044.23 4159.96,-2053.91 4166.93,-2054.48"/>
</g>
<!-- flash_attn_gpu_9 -->
<g id="node44" class="node">
<title>flash_attn_gpu_9</title>
<polygon fill="lightblue" stroke="black" points="4868,-2043.93 4414,-2043.93 4414,-1975.93 4868,-1975.93 4868,-2043.93"/>
<text text-anchor="middle" x="4641" y="-2028.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="4641" y="-2013.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4641" y="-1998.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4641" y="-1983.73" font-family="Times,serif" font-size="14.00">Device: gpu_9</text>
</g>
<!-- kv_cache_gpu_9&#45;&gt;flash_attn_gpu_9 -->
<g id="edge31" class="edge">
<title>kv_cache_gpu_9&#45;&gt;flash_attn_gpu_9</title>
<path fill="none" stroke="black" d="M4641.63,-2079.65C4641.55,-2071.44 4641.47,-2062.79 4641.4,-2054.49"/>
<polygon fill="black" stroke="black" points="4644.9,-2054.19 4641.3,-2044.23 4637.9,-2054.26 4644.9,-2054.19"/>
</g>
<!-- flash_attn_gpu_10 -->
<g id="node45" class="node">
<title>flash_attn_gpu_10</title>
<polygon fill="lightblue" stroke="black" points="5347,-2043.93 4893,-2043.93 4893,-1975.93 5347,-1975.93 5347,-2043.93"/>
<text text-anchor="middle" x="5120" y="-2028.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="5120" y="-2013.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5120" y="-1998.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5120" y="-1983.73" font-family="Times,serif" font-size="14.00">Device: gpu_10</text>
</g>
<!-- kv_cache_gpu_10&#45;&gt;flash_attn_gpu_10 -->
<g id="edge34" class="edge">
<title>kv_cache_gpu_10&#45;&gt;flash_attn_gpu_10</title>
<path fill="none" stroke="black" d="M5126.9,-2079.65C5126.07,-2071.35 5125.19,-2062.59 5124.35,-2054.21"/>
<polygon fill="black" stroke="black" points="5127.83,-2053.83 5123.35,-2044.23 5120.86,-2054.53 5127.83,-2053.83"/>
</g>
<!-- flash_attn_gpu_11 -->
<g id="node46" class="node">
<title>flash_attn_gpu_11</title>
<polygon fill="lightblue" stroke="black" points="5828,-2043.93 5374,-2043.93 5374,-1975.93 5828,-1975.93 5828,-2043.93"/>
<text text-anchor="middle" x="5601" y="-2028.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="5601" y="-2013.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5601" y="-1998.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5601" y="-1983.73" font-family="Times,serif" font-size="14.00">Device: gpu_11</text>
</g>
<!-- kv_cache_gpu_11&#45;&gt;flash_attn_gpu_11 -->
<g id="edge37" class="edge">
<title>kv_cache_gpu_11&#45;&gt;flash_attn_gpu_11</title>
<path fill="none" stroke="black" d="M5606.65,-2079.65C5605.97,-2071.35 5605.25,-2062.59 5604.56,-2054.21"/>
<polygon fill="black" stroke="black" points="5608.04,-2053.91 5603.74,-2044.23 5601.07,-2054.48 5608.04,-2053.91"/>
</g>
<!-- flash_attn_gpu_12 -->
<g id="node47" class="node">
<title>flash_attn_gpu_12</title>
<polygon fill="lightblue" stroke="black" points="6313,-2043.93 5859,-2043.93 5859,-1975.93 6313,-1975.93 6313,-2043.93"/>
<text text-anchor="middle" x="6086" y="-2028.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="6086" y="-2013.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6086" y="-1998.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6086" y="-1983.73" font-family="Times,serif" font-size="14.00">Device: gpu_12</text>
</g>
<!-- kv_cache_gpu_12&#45;&gt;flash_attn_gpu_12 -->
<g id="edge40" class="edge">
<title>kv_cache_gpu_12&#45;&gt;flash_attn_gpu_12</title>
<path fill="none" stroke="black" d="M6094.16,-2079.65C6093.17,-2071.35 6092.13,-2062.59 6091.14,-2054.21"/>
<polygon fill="black" stroke="black" points="6094.61,-2053.74 6089.95,-2044.23 6087.66,-2054.57 6094.61,-2053.74"/>
</g>
<!-- flash_attn_gpu_13 -->
<g id="node48" class="node">
<title>flash_attn_gpu_13</title>
<polygon fill="lightblue" stroke="black" points="6801,-2043.93 6347,-2043.93 6347,-1975.93 6801,-1975.93 6801,-2043.93"/>
<text text-anchor="middle" x="6574" y="-2028.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="6574" y="-2013.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6574" y="-1998.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6574" y="-1983.73" font-family="Times,serif" font-size="14.00">Device: gpu_13</text>
</g>
<!-- kv_cache_gpu_13&#45;&gt;flash_attn_gpu_13 -->
<g id="edge43" class="edge">
<title>kv_cache_gpu_13&#45;&gt;flash_attn_gpu_13</title>
<path fill="none" stroke="black" d="M6583.41,-2079.65C6582.28,-2071.35 6581.08,-2062.59 6579.93,-2054.21"/>
<polygon fill="black" stroke="black" points="6583.39,-2053.66 6578.56,-2044.23 6576.45,-2054.61 6583.39,-2053.66"/>
</g>
<!-- flash_attn_gpu_14 -->
<g id="node49" class="node">
<title>flash_attn_gpu_14</title>
<polygon fill="lightblue" stroke="black" points="7301,-2043.93 6847,-2043.93 6847,-1975.93 7301,-1975.93 7301,-2043.93"/>
<text text-anchor="middle" x="7074" y="-2028.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="7074" y="-2013.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7074" y="-1998.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7074" y="-1983.73" font-family="Times,serif" font-size="14.00">Device: gpu_14</text>
</g>
<!-- kv_cache_gpu_14&#45;&gt;flash_attn_gpu_14 -->
<g id="edge46" class="edge">
<title>kv_cache_gpu_14&#45;&gt;flash_attn_gpu_14</title>
<path fill="none" stroke="black" d="M7079.65,-2079.65C7078.97,-2071.35 7078.25,-2062.59 7077.56,-2054.21"/>
<polygon fill="black" stroke="black" points="7081.04,-2053.91 7076.74,-2044.23 7074.07,-2054.48 7081.04,-2053.91"/>
</g>
<!-- flash_attn_gpu_15 -->
<g id="node50" class="node">
<title>flash_attn_gpu_15</title>
<polygon fill="lightblue" stroke="black" points="7783,-2043.93 7329,-2043.93 7329,-1975.93 7783,-1975.93 7783,-2043.93"/>
<text text-anchor="middle" x="7556" y="-2028.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="7556" y="-2013.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7556" y="-1998.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=62500, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7556" y="-1983.73" font-family="Times,serif" font-size="14.00">Device: gpu_15</text>
</g>
<!-- kv_cache_gpu_15&#45;&gt;flash_attn_gpu_15 -->
<g id="edge49" class="edge">
<title>kv_cache_gpu_15&#45;&gt;flash_attn_gpu_15</title>
<path fill="none" stroke="black" d="M7562.28,-2079.65C7561.52,-2071.35 7560.72,-2062.59 7559.95,-2054.21"/>
<polygon fill="black" stroke="black" points="7563.44,-2053.87 7559.04,-2044.23 7556.47,-2054.5 7563.44,-2053.87"/>
</g>
<!-- all2all_group_0 -->
<g id="node51" class="node">
<title>all2all_group_0</title>
<polygon fill="yellow" stroke="black" points="2451.2,-1939.93 1673,-1939.93 1472.8,-1743.93 2251,-1743.93 2451.2,-1939.93"/>
<text text-anchor="middle" x="1962" y="-1875.73" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="1962" y="-1860.73" font-family="Times,serif" font-size="14.00">Group 0</text>
<text text-anchor="middle" x="1962" y="-1845.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=250000, heads=128, d_k=128]</text>
<text text-anchor="middle" x="1962" y="-1830.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=250000, heads=128, d_k=128]</text>
<text text-anchor="middle" x="1962" y="-1815.73" font-family="Times,serif" font-size="14.00">Volume: 1163840.5 bytes</text>
<text text-anchor="middle" x="1962" y="-1800.73" font-family="Times,serif" font-size="14.00">Device: group_0</text>
</g>
<!-- flash_attn_gpu_0&#45;&gt;all2all_group_0 -->
<g id="edge50" class="edge">
<title>flash_attn_gpu_0&#45;&gt;all2all_group_0</title>
<path fill="none" stroke="black" d="M500.26,-1978.43C507.59,-1977.57 514.85,-1976.73 522,-1975.93 885.69,-1935.05 1302.1,-1897.6 1593.27,-1872.93"/>
<polygon fill="black" stroke="black" points="1593.9,-1876.39 1603.57,-1872.06 1593.31,-1869.41 1593.9,-1876.39"/>
</g>
<!-- flash_attn_gpu_1&#45;&gt;all2all_group_0 -->
<g id="edge51" class="edge">
<title>flash_attn_gpu_1&#45;&gt;all2all_group_0</title>
<path fill="none" stroke="black" d="M985.17,-1977.61C1161.67,-1953.27 1409.57,-1919.09 1611.47,-1891.26"/>
<polygon fill="black" stroke="black" points="1612.22,-1894.68 1621.65,-1889.85 1611.27,-1887.75 1612.22,-1894.68"/>
</g>
<!-- flash_attn_gpu_2&#45;&gt;all2all_group_0 -->
<g id="edge52" class="edge">
<title>flash_attn_gpu_2&#45;&gt;all2all_group_0</title>
<path fill="none" stroke="black" d="M1382.34,-1975.83C1455.77,-1958.99 1548.21,-1937.8 1637.57,-1917.31"/>
<polygon fill="black" stroke="black" points="1638.36,-1920.72 1647.32,-1915.08 1636.8,-1913.9 1638.36,-1920.72"/>
</g>
<!-- flash_attn_gpu_3&#45;&gt;all2all_group_0 -->
<g id="edge53" class="edge">
<title>flash_attn_gpu_3&#45;&gt;all2all_group_0</title>
<path fill="none" stroke="black" d="M1765.99,-1975.73C1779.31,-1966.71 1794.47,-1956.44 1810.32,-1945.7"/>
<polygon fill="black" stroke="black" points="1812.35,-1948.55 1818.66,-1940.04 1808.42,-1942.76 1812.35,-1948.55"/>
</g>
<!-- all2all_group_1 -->
<g id="node52" class="node">
<title>all2all_group_1</title>
<polygon fill="yellow" stroke="black" points="3900.2,-1939.93 3122,-1939.93 2921.8,-1743.93 3700,-1743.93 3900.2,-1939.93"/>
<text text-anchor="middle" x="3411" y="-1875.73" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="3411" y="-1860.73" font-family="Times,serif" font-size="14.00">Group 1</text>
<text text-anchor="middle" x="3411" y="-1845.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=250000, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3411" y="-1830.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=250000, heads=128, d_k=128]</text>
<text text-anchor="middle" x="3411" y="-1815.73" font-family="Times,serif" font-size="14.00">Volume: 1163840.5 bytes</text>
<text text-anchor="middle" x="3411" y="-1800.73" font-family="Times,serif" font-size="14.00">Device: group_1</text>
</g>
<!-- flash_attn_gpu_4&#45;&gt;all2all_group_1 -->
<g id="edge58" class="edge">
<title>flash_attn_gpu_4&#45;&gt;all2all_group_1</title>
<path fill="none" stroke="black" d="M2451.11,-1977.16C2623.69,-1953.03 2864.17,-1919.4 3061.25,-1891.84"/>
<polygon fill="black" stroke="black" points="3061.78,-1895.3 3071.19,-1890.45 3060.81,-1888.37 3061.78,-1895.3"/>
</g>
<!-- flash_attn_gpu_5&#45;&gt;all2all_group_1 -->
<g id="edge59" class="edge">
<title>flash_attn_gpu_5&#45;&gt;all2all_group_1</title>
<path fill="none" stroke="black" d="M2846.55,-1975.83C2916.17,-1959.44 3003.34,-1938.91 3088.2,-1918.93"/>
<polygon fill="black" stroke="black" points="3089.06,-1922.33 3098,-1916.63 3087.46,-1915.51 3089.06,-1922.33"/>
</g>
<!-- flash_attn_gpu_6&#45;&gt;all2all_group_1 -->
<g id="edge60" class="edge">
<title>flash_attn_gpu_6&#45;&gt;all2all_group_1</title>
<path fill="none" stroke="black" d="M3226.19,-1975.73C3238.63,-1966.79 3252.78,-1956.63 3267.57,-1945.99"/>
<polygon fill="black" stroke="black" points="3269.78,-1948.72 3275.85,-1940.04 3265.69,-1943.04 3269.78,-1948.72"/>
</g>
<!-- flash_attn_gpu_7&#45;&gt;all2all_group_1 -->
<g id="edge61" class="edge">
<title>flash_attn_gpu_7&#45;&gt;all2all_group_1</title>
<path fill="none" stroke="black" d="M3611.01,-1975.73C3597.42,-1966.71 3581.95,-1956.44 3565.78,-1945.7"/>
<polygon fill="black" stroke="black" points="3567.53,-1942.66 3557.26,-1940.04 3563.66,-1948.49 3567.53,-1942.66"/>
</g>
<!-- all2all_group_2 -->
<g id="node53" class="node">
<title>all2all_group_2</title>
<polygon fill="yellow" stroke="black" points="4897.2,-1939.93 4119,-1939.93 3918.8,-1743.93 4697,-1743.93 4897.2,-1939.93"/>
<text text-anchor="middle" x="4408" y="-1875.73" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="4408" y="-1860.73" font-family="Times,serif" font-size="14.00">Group 2</text>
<text text-anchor="middle" x="4408" y="-1845.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=250000, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4408" y="-1830.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=250000, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4408" y="-1815.73" font-family="Times,serif" font-size="14.00">Volume: 1163840.5 bytes</text>
<text text-anchor="middle" x="4408" y="-1800.73" font-family="Times,serif" font-size="14.00">Device: group_2</text>
</g>
<!-- flash_attn_gpu_8&#45;&gt;all2all_group_2 -->
<g id="edge66" class="edge">
<title>flash_attn_gpu_8&#45;&gt;all2all_group_2</title>
<path fill="none" stroke="black" d="M4215.19,-1975.73C4228.17,-1966.79 4242.93,-1956.63 4258.36,-1945.99"/>
<polygon fill="black" stroke="black" points="4260.75,-1948.6 4267,-1940.04 4256.78,-1942.83 4260.75,-1948.6"/>
</g>
<!-- flash_attn_gpu_9&#45;&gt;all2all_group_2 -->
<g id="edge67" class="edge">
<title>flash_attn_gpu_9&#45;&gt;all2all_group_2</title>
<path fill="none" stroke="black" d="M4594.41,-1975.73C4581.86,-1966.79 4567.59,-1956.63 4552.67,-1945.99"/>
<polygon fill="black" stroke="black" points="4554.49,-1943 4544.32,-1940.04 4550.43,-1948.7 4554.49,-1943"/>
</g>
<!-- flash_attn_gpu_10&#45;&gt;all2all_group_2 -->
<g id="edge68" class="edge">
<title>flash_attn_gpu_10&#45;&gt;all2all_group_2</title>
<path fill="none" stroke="black" d="M4978.05,-1975.83C4935.18,-1965.84 4885.71,-1954.3 4834.21,-1942.29"/>
<polygon fill="black" stroke="black" points="4834.76,-1938.83 4824.22,-1939.97 4833.17,-1945.65 4834.76,-1938.83"/>
</g>
<!-- flash_attn_gpu_11&#45;&gt;all2all_group_2 -->
<g id="edge69" class="edge">
<title>flash_attn_gpu_11&#45;&gt;all2all_group_2</title>
<path fill="none" stroke="black" d="M5373.8,-1977.31C5232.21,-1957.61 5044.85,-1931.54 4872.87,-1907.61"/>
<polygon fill="black" stroke="black" points="4873.25,-1904.13 4862.87,-1906.22 4872.29,-1911.06 4873.25,-1904.13"/>
</g>
<!-- all2all_group_3 -->
<g id="node54" class="node">
<title>all2all_group_3</title>
<polygon fill="yellow" stroke="black" points="6113.2,-1939.93 5335,-1939.93 5134.8,-1743.93 5913,-1743.93 6113.2,-1939.93"/>
<text text-anchor="middle" x="5624" y="-1875.73" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="5624" y="-1860.73" font-family="Times,serif" font-size="14.00">Group 3</text>
<text text-anchor="middle" x="5624" y="-1845.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=250000, heads=128, d_k=128]</text>
<text text-anchor="middle" x="5624" y="-1830.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=250000, heads=128, d_k=128]</text>
<text text-anchor="middle" x="5624" y="-1815.73" font-family="Times,serif" font-size="14.00">Volume: 1163840.5 bytes</text>
<text text-anchor="middle" x="5624" y="-1800.73" font-family="Times,serif" font-size="14.00">Device: group_3</text>
</g>
<!-- flash_attn_gpu_12&#45;&gt;all2all_group_3 -->
<g id="edge74" class="edge">
<title>flash_attn_gpu_12&#45;&gt;all2all_group_3</title>
<path fill="none" stroke="black" d="M5993.89,-1975.83C5966.94,-1966.15 5935.97,-1955.02 5903.68,-1943.42"/>
<polygon fill="black" stroke="black" points="5904.67,-1940.05 5894.08,-1939.97 5902.3,-1946.64 5904.67,-1940.05"/>
</g>
<!-- flash_attn_gpu_13&#45;&gt;all2all_group_3 -->
<g id="edge75" class="edge">
<title>flash_attn_gpu_13&#45;&gt;all2all_group_3</title>
<path fill="none" stroke="black" d="M6384.89,-1975.88C6304.71,-1961.87 6207.21,-1944.83 6109.14,-1927.7"/>
<polygon fill="black" stroke="black" points="6109.49,-1924.21 6099.03,-1925.93 6108.28,-1931.1 6109.49,-1924.21"/>
</g>
<!-- flash_attn_gpu_14&#45;&gt;all2all_group_3 -->
<g id="edge76" class="edge">
<title>flash_attn_gpu_14&#45;&gt;all2all_group_3</title>
<path fill="none" stroke="black" d="M6846.85,-1980.35C6834.39,-1978.84 6822.04,-1977.35 6810,-1975.93 6566.71,-1947.08 6295.14,-1916.51 6073.32,-1891.96"/>
<polygon fill="black" stroke="black" points="6073.45,-1888.45 6063.12,-1890.83 6072.68,-1895.41 6073.45,-1888.45"/>
</g>
<!-- flash_attn_gpu_15&#45;&gt;all2all_group_3 -->
<g id="edge77" class="edge">
<title>flash_attn_gpu_15&#45;&gt;all2all_group_3</title>
<path fill="none" stroke="black" d="M7328.87,-1978C7322.51,-1977.28 7316.21,-1976.59 7310,-1975.93 6882.65,-1930.44 6392.82,-1893.49 6051.66,-1870.18"/>
<polygon fill="black" stroke="black" points="6051.82,-1866.69 6041.61,-1869.5 6051.35,-1873.67 6051.82,-1866.69"/>
</g>
<!-- global_all2all -->
<g id="node55" class="node">
<title>global_all2all</title>
<polygon fill="yellow" stroke="black" points="4619.86,-1707.93 3826.29,-1707.93 3622.14,-1511.93 4415.71,-1511.93 4619.86,-1707.93"/>
<text text-anchor="middle" x="4121" y="-1643.73" font-family="Times,serif" font-size="14.00">Global All&#45;to&#45;All</text>
<text text-anchor="middle" x="4121" y="-1628.73" font-family="Times,serif" font-size="14.00">Cross&#45;Group Exchange</text>
<text text-anchor="middle" x="4121" y="-1613.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4121" y="-1598.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=128, d_k=128]</text>
<text text-anchor="middle" x="4121" y="-1583.73" font-family="Times,serif" font-size="14.00">Volume: 1163840.5 bytes</text>
<text text-anchor="middle" x="4121" y="-1568.73" font-family="Times,serif" font-size="14.00">Device: all GPUs</text>
</g>
<!-- all2all_group_0&#45;&gt;global_all2all -->
<g id="edge54" class="edge">
<title>all2all_group_0&#45;&gt;global_all2all</title>
<path fill="none" stroke="black" d="M2310.49,-1802.14C2706.24,-1759.31 3348.99,-1690.85 3752.75,-1648.51"/>
<polygon fill="black" stroke="black" points="3753.26,-1651.98 3762.84,-1647.45 3752.53,-1645.02 3753.26,-1651.98"/>
</g>
<!-- all2all_group_0&#45;&gt;global_all2all -->
<g id="edge55" class="edge">
<title>all2all_group_0&#45;&gt;global_all2all</title>
<path fill="none" stroke="black" d="M2311.54,-1803.14C2707.72,-1760.71 3350.66,-1692.22 3753.94,-1649.48"/>
<polygon fill="black" stroke="black" points="3754.44,-1652.94 3764.02,-1648.41 3753.7,-1645.98 3754.44,-1652.94"/>
</g>
<!-- all2all_group_0&#45;&gt;global_all2all -->
<g id="edge56" class="edge">
<title>all2all_group_0&#45;&gt;global_all2all</title>
<path fill="none" stroke="black" d="M2312.79,-1804.1C2709.36,-1762.08 3352.03,-1693.62 3754.83,-1650.49"/>
<polygon fill="black" stroke="black" points="3755.33,-1653.96 3764.9,-1649.41 3754.58,-1647 3755.33,-1653.96"/>
</g>
<!-- all2all_group_0&#45;&gt;global_all2all -->
<g id="edge57" class="edge">
<title>all2all_group_0&#45;&gt;global_all2all</title>
<path fill="none" stroke="black" d="M2313.63,-1805.08C2710.73,-1763.47 3353.63,-1695.01 3756.11,-1651.49"/>
<polygon fill="black" stroke="black" points="3756.6,-1654.96 3766.17,-1650.4 3755.85,-1648 3756.6,-1654.96"/>
</g>
<!-- all2all_group_1&#45;&gt;global_all2all -->
<g id="edge62" class="edge">
<title>all2all_group_1&#45;&gt;global_all2all</title>
<path fill="none" stroke="black" d="M3690.53,-1743.89C3729.83,-1731.05 3770.42,-1717.91 3810.26,-1705.12"/>
<polygon fill="black" stroke="black" points="3811.37,-1708.44 3819.83,-1702.06 3809.23,-1701.78 3811.37,-1708.44"/>
</g>
<!-- all2all_group_1&#45;&gt;global_all2all -->
<g id="edge63" class="edge">
<title>all2all_group_1&#45;&gt;global_all2all</title>
<path fill="none" stroke="black" d="M3701.06,-1744.8C3738.04,-1732.79 3775.98,-1720.5 3813.22,-1708.47"/>
<polygon fill="black" stroke="black" points="3814.74,-1711.65 3823.18,-1705.25 3812.59,-1704.99 3814.74,-1711.65"/>
</g>
<!-- all2all_group_1&#45;&gt;global_all2all -->
<g id="edge64" class="edge">
<title>all2all_group_1&#45;&gt;global_all2all</title>
<path fill="none" stroke="black" d="M3704.38,-1748.04C3742.02,-1735.88 3780.62,-1723.39 3818.41,-1711.12"/>
<polygon fill="black" stroke="black" points="3819.56,-1714.42 3827.99,-1708.01 3817.4,-1707.77 3819.56,-1714.42"/>
</g>
<!-- all2all_group_1&#45;&gt;global_all2all -->
<g id="edge65" class="edge">
<title>all2all_group_1&#45;&gt;global_all2all</title>
<path fill="none" stroke="black" d="M3707.6,-1751.26C3748.69,-1738.1 3790.86,-1724.47 3831.81,-1711.12"/>
<polygon fill="black" stroke="black" points="3832.94,-1714.43 3841.36,-1708 3830.77,-1707.78 3832.94,-1714.43"/>
</g>
<!-- all2all_group_2&#45;&gt;global_all2all -->
<g id="edge70" class="edge">
<title>all2all_group_2&#45;&gt;global_all2all</title>
<path fill="none" stroke="black" d="M4266.67,-1743.72C4254.38,-1734.06 4242.08,-1724.24 4230.11,-1714.52"/>
<polygon fill="black" stroke="black" points="4232.25,-1711.76 4222.29,-1708.15 4227.83,-1717.18 4232.25,-1711.76"/>
</g>
<!-- all2all_group_2&#45;&gt;global_all2all -->
<g id="edge71" class="edge">
<title>all2all_group_2&#45;&gt;global_all2all</title>
<path fill="none" stroke="black" d="M4280.02,-1743.72C4267.9,-1734.06 4255.62,-1724.24 4243.55,-1714.52"/>
<polygon fill="black" stroke="black" points="4245.63,-1711.7 4235.65,-1708.15 4241.24,-1717.15 4245.63,-1711.7"/>
</g>
<!-- all2all_group_2&#45;&gt;global_all2all -->
<g id="edge72" class="edge">
<title>all2all_group_2&#45;&gt;global_all2all</title>
<path fill="none" stroke="black" d="M4293.38,-1743.72C4281.41,-1734.06 4269.16,-1724.24 4256.99,-1714.52"/>
<polygon fill="black" stroke="black" points="4259,-1711.65 4249,-1708.15 4254.64,-1717.12 4259,-1711.65"/>
</g>
<!-- all2all_group_2&#45;&gt;global_all2all -->
<g id="edge73" class="edge">
<title>all2all_group_2&#45;&gt;global_all2all</title>
<path fill="none" stroke="black" d="M4306.74,-1743.72C4294.92,-1734.06 4282.71,-1724.24 4270.43,-1714.52"/>
<polygon fill="black" stroke="black" points="4272.38,-1711.6 4262.36,-1708.15 4268.04,-1717.1 4272.38,-1711.6"/>
</g>
<!-- all2all_group_3&#45;&gt;global_all2all -->
<g id="edge78" class="edge">
<title>all2all_group_3&#45;&gt;global_all2all</title>
<path fill="none" stroke="black" d="M5164.84,-1773.51C4988.62,-1746.84 4787.04,-1716.03 4608.28,-1688.44"/>
<polygon fill="black" stroke="black" points="4608.58,-1684.95 4598.17,-1686.88 4607.52,-1691.86 4608.58,-1684.95"/>
</g>
<!-- all2all_group_3&#45;&gt;global_all2all -->
<g id="edge79" class="edge">
<title>all2all_group_3&#45;&gt;global_all2all</title>
<path fill="none" stroke="black" d="M5162.71,-1771.29C4986.14,-1744.37 4784.33,-1713.49 4605.64,-1686.06"/>
<polygon fill="black" stroke="black" points="4605.95,-1682.57 4595.53,-1684.51 4604.88,-1689.49 4605.95,-1682.57"/>
</g>
<!-- all2all_group_3&#45;&gt;global_all2all -->
<g id="edge80" class="edge">
<title>all2all_group_3&#45;&gt;global_all2all</title>
<path fill="none" stroke="black" d="M5160.42,-1769.02C4983.61,-1741.87 4781.74,-1710.98 4603.23,-1683.75"/>
<polygon fill="black" stroke="black" points="4603.55,-1680.26 4593.13,-1682.21 4602.49,-1687.18 4603.55,-1680.26"/>
</g>
<!-- all2all_group_3&#45;&gt;global_all2all -->
<g id="edge81" class="edge">
<title>all2all_group_3&#45;&gt;global_all2all</title>
<path fill="none" stroke="black" d="M5157.95,-1766.69C4980.99,-1739.36 4779.27,-1708.5 4601.05,-1681.5"/>
<polygon fill="black" stroke="black" points="4601.37,-1678.01 4590.96,-1679.98 4600.33,-1684.93 4601.37,-1678.01"/>
</g>
<!-- attn_out_gpu_0 -->
<g id="node56" class="node">
<title>attn_out_gpu_0</title>
<polygon fill="lightcoral" stroke="black" points="1176.5,-1475.93 751.5,-1475.93 751.5,-1392.93 1176.5,-1392.93 1176.5,-1475.93"/>
<text text-anchor="middle" x="964" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="964" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="964" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="964" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_0</text>
<text text-anchor="middle" x="964" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 0&#45;1023</text>
</g>
<!-- global_all2all&#45;&gt;attn_out_gpu_0 -->
<g id="edge82" class="edge">
<title>global_all2all&#45;&gt;attn_out_gpu_0</title>
<path fill="none" stroke="black" d="M3721.93,-1608.01C3157.92,-1602.83 2095.86,-1578.82 1186.54,-1476.06"/>
<polygon fill="black" stroke="black" points="1186.85,-1472.57 1176.52,-1474.93 1186.06,-1479.53 1186.85,-1472.57"/>
</g>
<!-- attn_out_gpu_1 -->
<g id="node57" class="node">
<title>attn_out_gpu_1</title>
<polygon fill="lightcoral" stroke="black" points="1619.5,-1475.93 1194.5,-1475.93 1194.5,-1392.93 1619.5,-1392.93 1619.5,-1475.93"/>
<text text-anchor="middle" x="1407" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1407" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="1407" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="1407" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_1</text>
<text text-anchor="middle" x="1407" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 1024&#45;2047</text>
</g>
<!-- global_all2all&#45;&gt;attn_out_gpu_1 -->
<g id="edge84" class="edge">
<title>global_all2all&#45;&gt;attn_out_gpu_1</title>
<path fill="none" stroke="black" d="M3717.01,-1603.24C3225.04,-1592.68 2369.15,-1562.6 1629.58,-1476.07"/>
<polygon fill="black" stroke="black" points="1629.86,-1472.58 1619.52,-1474.89 1629.05,-1479.54 1629.86,-1472.58"/>
</g>
<!-- attn_out_gpu_2 -->
<g id="node58" class="node">
<title>attn_out_gpu_2</title>
<polygon fill="lightcoral" stroke="black" points="2062.5,-1475.93 1637.5,-1475.93 1637.5,-1392.93 2062.5,-1392.93 2062.5,-1475.93"/>
<text text-anchor="middle" x="1850" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1850" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="1850" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="1850" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_2</text>
<text text-anchor="middle" x="1850" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 2048&#45;3071</text>
</g>
<!-- global_all2all&#45;&gt;attn_out_gpu_2 -->
<g id="edge86" class="edge">
<title>global_all2all&#45;&gt;attn_out_gpu_2</title>
<path fill="none" stroke="black" d="M3709.55,-1596.2C3297.32,-1580.19 2644.9,-1545.99 2072.71,-1475.97"/>
<polygon fill="black" stroke="black" points="2072.96,-1472.48 2062.61,-1474.73 2072.1,-1479.42 2072.96,-1472.48"/>
</g>
<!-- attn_out_gpu_3 -->
<g id="node59" class="node">
<title>attn_out_gpu_3</title>
<polygon fill="lightcoral" stroke="black" points="2505.5,-1475.93 2080.5,-1475.93 2080.5,-1392.93 2505.5,-1392.93 2505.5,-1475.93"/>
<text text-anchor="middle" x="2293" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="2293" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="2293" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="2293" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_3</text>
<text text-anchor="middle" x="2293" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 3072&#45;4095</text>
</g>
<!-- global_all2all&#45;&gt;attn_out_gpu_3 -->
<g id="edge88" class="edge">
<title>global_all2all&#45;&gt;attn_out_gpu_3</title>
<path fill="none" stroke="black" d="M3698.38,-1585.25C3376.51,-1564.51 2922.52,-1529.42 2515.82,-1476"/>
<polygon fill="black" stroke="black" points="2515.99,-1472.49 2505.62,-1474.65 2515.07,-1479.43 2515.99,-1472.49"/>
</g>
<!-- attn_out_gpu_4 -->
<g id="node60" class="node">
<title>attn_out_gpu_4</title>
<polygon fill="lightcoral" stroke="black" points="2948.5,-1475.93 2523.5,-1475.93 2523.5,-1392.93 2948.5,-1392.93 2948.5,-1475.93"/>
<text text-anchor="middle" x="2736" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="2736" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="2736" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="2736" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_4</text>
<text text-anchor="middle" x="2736" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 4096&#45;5119</text>
</g>
<!-- global_all2all&#45;&gt;attn_out_gpu_4 -->
<g id="edge90" class="edge">
<title>global_all2all&#45;&gt;attn_out_gpu_4</title>
<path fill="none" stroke="black" d="M3677.6,-1565.23C3463.25,-1542.34 3202.21,-1511.9 2958.75,-1476.01"/>
<polygon fill="black" stroke="black" points="2959.04,-1472.52 2948.63,-1474.52 2958.01,-1479.44 2959.04,-1472.52"/>
</g>
<!-- attn_out_gpu_5 -->
<g id="node61" class="node">
<title>attn_out_gpu_5</title>
<polygon fill="lightcoral" stroke="black" points="3391.5,-1475.93 2966.5,-1475.93 2966.5,-1392.93 3391.5,-1392.93 3391.5,-1475.93"/>
<text text-anchor="middle" x="3179" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="3179" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="3179" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="3179" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_5</text>
<text text-anchor="middle" x="3179" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 5120&#45;6143</text>
</g>
<!-- global_all2all&#45;&gt;attn_out_gpu_5 -->
<g id="edge92" class="edge">
<title>global_all2all&#45;&gt;attn_out_gpu_5</title>
<path fill="none" stroke="black" d="M3628.62,-1518.24C3549.19,-1503.61 3470.58,-1489.13 3401.84,-1476.47"/>
<polygon fill="black" stroke="black" points="3402.24,-1472.98 3391.77,-1474.61 3400.97,-1479.87 3402.24,-1472.98"/>
</g>
<!-- attn_out_gpu_6 -->
<g id="node62" class="node">
<title>attn_out_gpu_6</title>
<polygon fill="lightcoral" stroke="black" points="3834.5,-1475.93 3409.5,-1475.93 3409.5,-1392.93 3834.5,-1392.93 3834.5,-1475.93"/>
<text text-anchor="middle" x="3622" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="3622" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="3622" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="3622" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_6</text>
<text text-anchor="middle" x="3622" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 6144&#45;7167</text>
</g>
<!-- global_all2all&#45;&gt;attn_out_gpu_6 -->
<g id="edge94" class="edge">
<title>global_all2all&#45;&gt;attn_out_gpu_6</title>
<path fill="none" stroke="black" d="M3841.96,-1511.9C3809.3,-1500.55 3777.34,-1489.44 3748.33,-1479.35"/>
<polygon fill="black" stroke="black" points="3749.21,-1475.95 3738.61,-1475.97 3746.91,-1482.56 3749.21,-1475.95"/>
</g>
<!-- attn_out_gpu_7 -->
<g id="node63" class="node">
<title>attn_out_gpu_7</title>
<polygon fill="lightcoral" stroke="black" points="4277.5,-1475.93 3852.5,-1475.93 3852.5,-1392.93 4277.5,-1392.93 4277.5,-1475.93"/>
<text text-anchor="middle" x="4065" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="4065" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="4065" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="4065" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_7</text>
<text text-anchor="middle" x="4065" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 7168&#45;8191</text>
</g>
<!-- global_all2all&#45;&gt;attn_out_gpu_7 -->
<g id="edge96" class="edge">
<title>global_all2all&#45;&gt;attn_out_gpu_7</title>
<path fill="none" stroke="black" d="M4089.64,-1511.78C4086.77,-1502.86 4083.93,-1494.09 4081.28,-1485.85"/>
<polygon fill="black" stroke="black" points="4084.53,-1484.54 4078.13,-1476.1 4077.87,-1486.69 4084.53,-1484.54"/>
</g>
<!-- attn_out_gpu_8 -->
<g id="node64" class="node">
<title>attn_out_gpu_8</title>
<polygon fill="lightcoral" stroke="black" points="4720.5,-1475.93 4295.5,-1475.93 4295.5,-1392.93 4720.5,-1392.93 4720.5,-1475.93"/>
<text text-anchor="middle" x="4508" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="4508" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="4508" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="4508" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_8</text>
<text text-anchor="middle" x="4508" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 8192&#45;9215</text>
</g>
<!-- global_all2all&#45;&gt;attn_out_gpu_8 -->
<g id="edge98" class="edge">
<title>global_all2all&#45;&gt;attn_out_gpu_8</title>
<path fill="none" stroke="black" d="M4337.41,-1511.9C4362.08,-1500.85 4386.24,-1490.02 4408.26,-1480.14"/>
<polygon fill="black" stroke="black" points="4409.87,-1483.26 4417.56,-1475.97 4407.01,-1476.87 4409.87,-1483.26"/>
</g>
<!-- attn_out_gpu_9 -->
<g id="node65" class="node">
<title>attn_out_gpu_9</title>
<polygon fill="lightcoral" stroke="black" points="5163.5,-1475.93 4738.5,-1475.93 4738.5,-1392.93 5163.5,-1392.93 5163.5,-1475.93"/>
<text text-anchor="middle" x="4951" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="4951" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="4951" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="4951" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_9</text>
<text text-anchor="middle" x="4951" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 9216&#45;10239</text>
</g>
<!-- global_all2all&#45;&gt;attn_out_gpu_9 -->
<g id="edge100" class="edge">
<title>global_all2all&#45;&gt;attn_out_gpu_9</title>
<path fill="none" stroke="black" d="M4446.06,-1540.98C4547.56,-1519.76 4656.6,-1496.97 4747.28,-1478.01"/>
<polygon fill="black" stroke="black" points="4748.05,-1481.43 4757.12,-1475.95 4746.62,-1474.57 4748.05,-1481.43"/>
</g>
<!-- attn_out_gpu_10 -->
<g id="node66" class="node">
<title>attn_out_gpu_10</title>
<polygon fill="lightcoral" stroke="black" points="5606.5,-1475.93 5181.5,-1475.93 5181.5,-1392.93 5606.5,-1392.93 5606.5,-1475.93"/>
<text text-anchor="middle" x="5394" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5394" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="5394" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="5394" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_10</text>
<text text-anchor="middle" x="5394" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 10240&#45;11263</text>
</g>
<!-- global_all2all&#45;&gt;attn_out_gpu_10 -->
<g id="edge102" class="edge">
<title>global_all2all&#45;&gt;attn_out_gpu_10</title>
<path fill="none" stroke="black" d="M4475.35,-1569.09C4676.81,-1545.22 4933.87,-1512.71 5171.22,-1476.18"/>
<polygon fill="black" stroke="black" points="5172.09,-1479.59 5181.44,-1474.61 5171.02,-1472.67 5172.09,-1479.59"/>
</g>
<!-- attn_out_gpu_11 -->
<g id="node67" class="node">
<title>attn_out_gpu_11</title>
<polygon fill="lightcoral" stroke="black" points="6049.5,-1475.93 5624.5,-1475.93 5624.5,-1392.93 6049.5,-1392.93 6049.5,-1475.93"/>
<text text-anchor="middle" x="5837" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5837" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="5837" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="5837" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_11</text>
<text text-anchor="middle" x="5837" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 11264&#45;12287</text>
</g>
<!-- global_all2all&#45;&gt;attn_out_gpu_11 -->
<g id="edge104" class="edge">
<title>global_all2all&#45;&gt;attn_out_gpu_11</title>
<path fill="none" stroke="black" d="M4492.61,-1585.46C4793.16,-1564.2 5227.18,-1528.34 5614.46,-1476.11"/>
<polygon fill="black" stroke="black" points="5615.02,-1479.56 5624.46,-1474.75 5614.08,-1472.63 5615.02,-1479.56"/>
</g>
<!-- attn_out_gpu_12 -->
<g id="node68" class="node">
<title>attn_out_gpu_12</title>
<polygon fill="lightcoral" stroke="black" points="6492.5,-1475.93 6067.5,-1475.93 6067.5,-1392.93 6492.5,-1392.93 6492.5,-1475.93"/>
<text text-anchor="middle" x="6280" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="6280" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="6280" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="6280" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_12</text>
<text text-anchor="middle" x="6280" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 12288&#45;13311</text>
</g>
<!-- global_all2all&#45;&gt;attn_out_gpu_12 -->
<g id="edge106" class="edge">
<title>global_all2all&#45;&gt;attn_out_gpu_12</title>
<path fill="none" stroke="black" d="M4502.83,-1595.44C4892.19,-1578.72 5513.45,-1543.88 6057.46,-1476.09"/>
<polygon fill="black" stroke="black" points="6057.98,-1479.55 6067.47,-1474.83 6057.11,-1472.6 6057.98,-1479.55"/>
</g>
<!-- attn_out_gpu_13 -->
<g id="node69" class="node">
<title>attn_out_gpu_13</title>
<polygon fill="lightcoral" stroke="black" points="6935.5,-1475.93 6510.5,-1475.93 6510.5,-1392.93 6935.5,-1392.93 6935.5,-1475.93"/>
<text text-anchor="middle" x="6723" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="6723" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="6723" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="6723" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_13</text>
<text text-anchor="middle" x="6723" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 13312&#45;14335</text>
</g>
<!-- global_all2all&#45;&gt;attn_out_gpu_13 -->
<g id="edge108" class="edge">
<title>global_all2all&#45;&gt;attn_out_gpu_13</title>
<path fill="none" stroke="black" d="M4509.7,-1602.16C4979.92,-1590.56 5795.18,-1559.46 6500.36,-1476.08"/>
<polygon fill="black" stroke="black" points="6500.96,-1479.54 6510.48,-1474.88 6500.13,-1472.59 6500.96,-1479.54"/>
</g>
<!-- attn_out_gpu_14 -->
<g id="node70" class="node">
<title>attn_out_gpu_14</title>
<polygon fill="lightcoral" stroke="black" points="7378.5,-1475.93 6953.5,-1475.93 6953.5,-1392.93 7378.5,-1392.93 7378.5,-1475.93"/>
<text text-anchor="middle" x="7166" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="7166" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="7166" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="7166" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_14</text>
<text text-anchor="middle" x="7166" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 14336&#45;15359</text>
</g>
<!-- global_all2all&#45;&gt;attn_out_gpu_14 -->
<g id="edge110" class="edge">
<title>global_all2all&#45;&gt;attn_out_gpu_14</title>
<path fill="none" stroke="black" d="M4514.94,-1607.02C5059.82,-1600.61 6073.79,-1575.1 6943.26,-1476.09"/>
<polygon fill="black" stroke="black" points="6943.94,-1479.53 6953.48,-1474.92 6943.15,-1472.58 6943.94,-1479.53"/>
</g>
<!-- attn_out_gpu_15 -->
<g id="node71" class="node">
<title>attn_out_gpu_15</title>
<polygon fill="lightcoral" stroke="black" points="7821.5,-1475.93 7396.5,-1475.93 7396.5,-1392.93 7821.5,-1392.93 7821.5,-1475.93"/>
<text text-anchor="middle" x="7609" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="7609" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="7609" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="7609" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_15</text>
<text text-anchor="middle" x="7609" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 15360&#45;16383</text>
</g>
<!-- global_all2all&#45;&gt;attn_out_gpu_15 -->
<g id="edge112" class="edge">
<title>global_all2all&#45;&gt;attn_out_gpu_15</title>
<path fill="none" stroke="black" d="M4507.48,-1600.01C5243.27,-1581.92 6821.52,-1537.43 7386.19,-1476.08"/>
<polygon fill="black" stroke="black" points="7386.93,-1479.52 7396.48,-1474.94 7386.16,-1472.56 7386.93,-1479.52"/>
</g>
<!-- attn_all_reduce -->
<g id="node72" class="node">
<title>attn_all_reduce</title>
<polygon fill="yellow" stroke="black" points="4957.9,-1356.93 4242.21,-1356.93 4058.1,-1190.93 4773.79,-1190.93 4957.9,-1356.93"/>
<text text-anchor="middle" x="4508" y="-1300.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="4508" y="-1285.23" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="4508" y="-1270.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="4508" y="-1255.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="4508" y="-1240.23" font-family="Times,serif" font-size="14.00">Device: all GPUs</text>
</g>
<!-- attn_out_gpu_0&#45;&gt;attn_all_reduce -->
<g id="edge83" class="edge">
<title>attn_out_gpu_0&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M1176.51,-1393.89C1179.36,-1393.55 1182.19,-1393.23 1185,-1392.93 1749.62,-1331.5 3409.49,-1294.79 4147.34,-1281.09"/>
<polygon fill="black" stroke="black" points="4147.67,-1284.58 4157.6,-1280.9 4147.54,-1277.58 4147.67,-1284.58"/>
</g>
<!-- attn_out_gpu_1&#45;&gt;attn_all_reduce -->
<g id="edge85" class="edge">
<title>attn_out_gpu_1&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M1619.52,-1393.91C1622.36,-1393.57 1625.19,-1393.24 1628,-1392.93 2106.01,-1339.6 3490,-1299.83 4149.87,-1283.32"/>
<polygon fill="black" stroke="black" points="4150.11,-1286.81 4160.02,-1283.06 4149.93,-1279.82 4150.11,-1286.81"/>
</g>
<!-- attn_out_gpu_2&#45;&gt;attn_all_reduce -->
<g id="edge87" class="edge">
<title>attn_out_gpu_2&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M2062.6,-1394.05C2065.75,-1393.66 2068.89,-1393.28 2072,-1392.93 2803.96,-1308.8 3666.35,-1284.52 4143.67,-1277.6"/>
<polygon fill="black" stroke="black" points="4143.88,-1281.1 4153.83,-1277.45 4143.78,-1274.1 4143.88,-1281.1"/>
</g>
<!-- attn_out_gpu_3&#45;&gt;attn_all_reduce -->
<g id="edge89" class="edge">
<title>attn_out_gpu_3&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M2505.6,-1394.1C2508.75,-1393.69 2511.89,-1393.3 2515,-1392.93 3084.14,-1324.42 3749.73,-1295.18 4149.6,-1283.06"/>
<polygon fill="black" stroke="black" points="4149.99,-1286.55 4159.88,-1282.75 4149.78,-1279.56 4149.99,-1286.55"/>
</g>
<!-- attn_out_gpu_4&#45;&gt;attn_all_reduce -->
<g id="edge91" class="edge">
<title>attn_out_gpu_4&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M2948.61,-1394.17C2951.76,-1393.74 2954.89,-1393.33 2958,-1392.93 3368.42,-1340.01 3843.26,-1308.15 4158.11,-1291.11"/>
<polygon fill="black" stroke="black" points="4158.51,-1294.59 4168.31,-1290.56 4158.14,-1287.6 4158.51,-1294.59"/>
</g>
<!-- attn_out_gpu_5&#45;&gt;attn_all_reduce -->
<g id="edge93" class="edge">
<title>attn_out_gpu_5&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M3391.63,-1394.3C3394.77,-1393.83 3397.9,-1393.37 3401,-1392.93 3658.99,-1355.7 3952.38,-1324.94 4172.28,-1304.18"/>
<polygon fill="black" stroke="black" points="4172.74,-1307.65 4182.36,-1303.23 4172.08,-1300.68 4172.74,-1307.65"/>
</g>
<!-- attn_out_gpu_6&#45;&gt;attn_all_reduce -->
<g id="edge95" class="edge">
<title>attn_out_gpu_6&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M3834.68,-1394.61C3837.81,-1394.04 3840.92,-1393.48 3844,-1392.93 3960.05,-1372.03 4087.55,-1349.31 4199.54,-1329.44"/>
<polygon fill="black" stroke="black" points="4200.4,-1332.84 4209.64,-1327.65 4199.18,-1325.95 4200.4,-1332.84"/>
</g>
<!-- attn_out_gpu_7&#45;&gt;attn_all_reduce -->
<g id="edge97" class="edge">
<title>attn_out_gpu_7&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M4178.22,-1392.92C4206.22,-1382.9 4237.27,-1371.79 4268.81,-1360.51"/>
<polygon fill="black" stroke="black" points="4270.37,-1363.66 4278.61,-1357 4268.01,-1357.07 4270.37,-1363.66"/>
</g>
<!-- attn_out_gpu_8&#45;&gt;attn_all_reduce -->
<g id="edge99" class="edge">
<title>attn_out_gpu_8&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M4508,-1392.61C4508,-1384.68 4508,-1376.07 4508,-1367.24"/>
<polygon fill="black" stroke="black" points="4511.5,-1367.2 4508,-1357.2 4504.5,-1367.2 4511.5,-1367.2"/>
</g>
<!-- attn_out_gpu_9&#45;&gt;attn_all_reduce -->
<g id="edge101" class="edge">
<title>attn_out_gpu_9&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M4837.78,-1392.92C4809.78,-1382.9 4778.73,-1371.79 4747.19,-1360.51"/>
<polygon fill="black" stroke="black" points="4747.99,-1357.07 4737.39,-1357 4745.63,-1363.66 4747.99,-1357.07"/>
</g>
<!-- attn_out_gpu_10&#45;&gt;attn_all_reduce -->
<g id="edge103" class="edge">
<title>attn_out_gpu_10&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M5181.4,-1394.44C5178.59,-1393.93 5175.78,-1393.43 5173,-1392.93 5105.77,-1380.8 5034.7,-1368.08 4965.02,-1355.67"/>
<polygon fill="black" stroke="black" points="4965.21,-1352.15 4954.75,-1353.84 4963.98,-1359.04 4965.21,-1352.15"/>
</g>
<!-- attn_out_gpu_11&#45;&gt;attn_all_reduce -->
<g id="edge105" class="edge">
<title>attn_out_gpu_11&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M5624.45,-1394.17C5621.62,-1393.75 5618.8,-1393.33 5616,-1392.93 5385.13,-1359.53 5125.91,-1331.41 4916.28,-1311.01"/>
<polygon fill="black" stroke="black" points="4916.31,-1307.5 4906.02,-1310.01 4915.64,-1314.46 4916.31,-1307.5"/>
</g>
<!-- attn_out_gpu_12&#45;&gt;attn_all_reduce -->
<g id="edge107" class="edge">
<title>attn_out_gpu_12&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M6067.47,-1394.05C6064.63,-1393.66 6061.8,-1393.29 6059,-1392.93 5664.9,-1341.97 5211.4,-1310.6 4897,-1293.15"/>
<polygon fill="black" stroke="black" points="4896.99,-1289.64 4886.81,-1292.58 4896.6,-1296.63 4896.99,-1289.64"/>
</g>
<!-- attn_out_gpu_13&#45;&gt;attn_all_reduce -->
<g id="edge109" class="edge">
<title>attn_out_gpu_13&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M6510.47,-1393.98C6507.63,-1393.62 6504.81,-1393.27 6502,-1392.93 5941.85,-1325.28 5288.28,-1295.96 4886.3,-1283.57"/>
<polygon fill="black" stroke="black" points="4886.36,-1280.07 4876.26,-1283.26 4886.15,-1287.06 4886.36,-1280.07"/>
</g>
<!-- attn_out_gpu_14&#45;&gt;attn_all_reduce -->
<g id="edge111" class="edge">
<title>attn_out_gpu_14&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M6953.48,-1393.94C6950.64,-1393.59 6947.81,-1393.25 6945,-1392.93 6216.69,-1308.94 5359.24,-1284.58 4880.18,-1277.61"/>
<polygon fill="black" stroke="black" points="4880.04,-1274.11 4869.99,-1277.46 4879.94,-1281.11 4880.04,-1274.11"/>
</g>
<!-- attn_out_gpu_15&#45;&gt;attn_all_reduce -->
<g id="edge113" class="edge">
<title>attn_out_gpu_15&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M7396.48,-1393.91C7393.64,-1393.57 7390.81,-1393.24 7388,-1392.93 6914.94,-1340.15 5554.55,-1300.65 4886.85,-1283.84"/>
<polygon fill="black" stroke="black" points="4886.67,-1280.33 4876.58,-1283.58 4886.49,-1287.33 4886.67,-1280.33"/>
</g>
<!-- attn_all_reduce&#45;&gt;residual_attn -->
<g id="edge114" class="edge">
<title>attn_all_reduce&#45;&gt;residual_attn</title>
<path fill="none" stroke="black" d="M4827.71,-1239.31C5138.75,-1206.61 5606.42,-1157.44 5902.02,-1126.36"/>
<polygon fill="black" stroke="black" points="5902.45,-1129.83 5912.03,-1125.31 5901.72,-1122.87 5902.45,-1129.83"/>
</g>
<!-- rmsnorm1 -->
<g id="node74" class="node">
<title>rmsnorm1</title>
<polygon fill="lightgray" stroke="black" points="6396,-1001.55 5962,-1001.55 5962,-933.55 6396,-933.55 6396,-1001.55"/>
<text text-anchor="middle" x="6179" y="-986.35" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="6179" y="-971.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="6179" y="-956.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="6179" y="-941.35" font-family="Times,serif" font-size="14.00">Device: all GPUs</text>
</g>
<!-- residual_attn&#45;&gt;rmsnorm1 -->
<g id="edge116" class="edge">
<title>residual_attn&#45;&gt;rmsnorm1</title>
<path fill="none" stroke="black" d="M6179,-1037.45C6179,-1028.83 6179,-1020.06 6179,-1011.8"/>
<polygon fill="black" stroke="black" points="6182.5,-1011.66 6179,-1001.66 6175.5,-1011.66 6182.5,-1011.66"/>
</g>
<!-- ffn_fc1_gpu_0 -->
<g id="node75" class="node">
<title>ffn_fc1_gpu_0</title>
<polygon fill="lightblue" stroke="black" points="2859,-897.55 2437,-897.55 2437,-814.55 2859,-814.55 2859,-897.55"/>
<text text-anchor="middle" x="2648" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="2648" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="2648" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="2648" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_0</text>
<text text-anchor="middle" x="2648" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 0&#45;4095</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_0 -->
<g id="edge117" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_0</title>
<path fill="none" stroke="black" d="M5961.85,-966.45C5326.08,-965.46 3475.7,-957.37 2874,-897.55 2872.48,-897.4 2870.96,-897.24 2869.43,-897.08"/>
<polygon fill="black" stroke="black" points="2869.6,-893.58 2859.28,-895.96 2868.84,-900.54 2869.6,-893.58"/>
</g>
<!-- ffn_fc1_gpu_1 -->
<g id="node76" class="node">
<title>ffn_fc1_gpu_1</title>
<polygon fill="lightblue" stroke="black" points="3305,-897.55 2883,-897.55 2883,-814.55 3305,-814.55 3305,-897.55"/>
<text text-anchor="middle" x="3094" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="3094" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="3094" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="3094" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_1</text>
<text text-anchor="middle" x="3094" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 4096&#45;8191</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_1 -->
<g id="edge121" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_1</title>
<path fill="none" stroke="black" d="M5961.87,-965.69C5386.03,-962.7 3829.06,-949.9 3317,-897.55 3316.39,-897.48 3315.78,-897.42 3315.16,-897.36"/>
<polygon fill="black" stroke="black" points="3315.48,-893.87 3305.16,-896.26 3314.72,-900.83 3315.48,-893.87"/>
</g>
<!-- ffn_fc1_gpu_2 -->
<g id="node77" class="node">
<title>ffn_fc1_gpu_2</title>
<polygon fill="lightblue" stroke="black" points="3748,-897.55 3326,-897.55 3326,-814.55 3748,-814.55 3748,-897.55"/>
<text text-anchor="middle" x="3537" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="3537" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="3537" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="3537" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_2</text>
<text text-anchor="middle" x="3537" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 8192&#45;12287</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_2 -->
<g id="edge125" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_2</title>
<path fill="none" stroke="black" d="M5961.94,-964.61C5450.58,-959.36 4181.53,-942.13 3758,-897.55 3757.9,-897.54 3757.79,-897.52 3757.69,-897.51"/>
<polygon fill="black" stroke="black" points="3758.36,-894.07 3748.04,-896.44 3757.59,-901.02 3758.36,-894.07"/>
</g>
<!-- ffn_fc1_gpu_3 -->
<g id="node78" class="node">
<title>ffn_fc1_gpu_3</title>
<polygon fill="lightblue" stroke="black" points="4189,-897.55 3767,-897.55 3767,-814.55 4189,-814.55 4189,-897.55"/>
<text text-anchor="middle" x="3978" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="3978" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="3978" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="3978" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_3</text>
<text text-anchor="middle" x="3978" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 12288&#45;16383</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_3 -->
<g id="edge129" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_3</title>
<path fill="none" stroke="black" d="M5961.87,-962.99C5521.11,-955.12 4534.86,-933.97 4199,-897.55 4198.9,-897.54 4198.79,-897.52 4198.69,-897.51"/>
<polygon fill="black" stroke="black" points="4199.37,-894.07 4189.04,-896.41 4198.58,-901.02 4199.37,-894.07"/>
</g>
<!-- ffn_fc1_gpu_4 -->
<g id="node79" class="node">
<title>ffn_fc1_gpu_4</title>
<polygon fill="lightblue" stroke="black" points="4630,-897.55 4208,-897.55 4208,-814.55 4630,-814.55 4630,-897.55"/>
<text text-anchor="middle" x="4419" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="4419" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="4419" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="4419" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_4</text>
<text text-anchor="middle" x="4419" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 16384&#45;20479</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_4 -->
<g id="edge133" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_4</title>
<path fill="none" stroke="black" d="M5961.8,-966.19C5665.04,-963.58 5116.34,-951.2 4640.43,-897.66"/>
<polygon fill="black" stroke="black" points="4640.59,-894.16 4630.26,-896.51 4639.81,-901.12 4640.59,-894.16"/>
</g>
<!-- ffn_fc1_gpu_5 -->
<g id="node80" class="node">
<title>ffn_fc1_gpu_5</title>
<polygon fill="lightblue" stroke="black" points="5070,-897.55 4648,-897.55 4648,-814.55 5070,-814.55 5070,-897.55"/>
<text text-anchor="middle" x="4859" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="4859" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="4859" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="4859" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_5</text>
<text text-anchor="middle" x="4859" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 20480&#45;24575</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_5 -->
<g id="edge137" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_5</title>
<path fill="none" stroke="black" d="M5961.75,-960.57C5741.74,-952.74 5391.67,-935.43 5080.4,-897.68"/>
<polygon fill="black" stroke="black" points="5080.62,-894.18 5070.27,-896.44 5079.77,-901.13 5080.62,-894.18"/>
</g>
<!-- ffn_fc1_gpu_6 -->
<g id="node81" class="node">
<title>ffn_fc1_gpu_6</title>
<polygon fill="lightblue" stroke="black" points="5510,-897.55 5088,-897.55 5088,-814.55 5510,-814.55 5510,-897.55"/>
<text text-anchor="middle" x="5299" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="5299" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="5299" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="5299" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_6</text>
<text text-anchor="middle" x="5299" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 24576&#45;28671</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_6 -->
<g id="edge141" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_6</title>
<path fill="none" stroke="black" d="M5961.85,-948.14C5835.63,-936.39 5673.38,-919.51 5520.09,-897.67"/>
<polygon fill="black" stroke="black" points="5520.4,-894.18 5510,-896.23 5519.41,-901.11 5520.4,-894.18"/>
</g>
<!-- ffn_fc1_gpu_7 -->
<g id="node82" class="node">
<title>ffn_fc1_gpu_7</title>
<polygon fill="lightblue" stroke="black" points="5950,-897.55 5528,-897.55 5528,-814.55 5950,-814.55 5950,-897.55"/>
<text text-anchor="middle" x="5739" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="5739" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="5739" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="5739" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_7</text>
<text text-anchor="middle" x="5739" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 28672&#45;32767</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_7 -->
<g id="edge145" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_7</title>
<path fill="none" stroke="black" d="M6046.39,-933.54C6004.07,-923.01 5956.61,-911.2 5911.87,-900.07"/>
<polygon fill="black" stroke="black" points="5912.62,-896.65 5902.07,-897.63 5910.93,-903.44 5912.62,-896.65"/>
</g>
<!-- ffn_fc1_gpu_8 -->
<g id="node83" class="node">
<title>ffn_fc1_gpu_8</title>
<polygon fill="lightblue" stroke="black" points="6390,-897.55 5968,-897.55 5968,-814.55 6390,-814.55 6390,-897.55"/>
<text text-anchor="middle" x="6179" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="6179" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="6179" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="6179" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_8</text>
<text text-anchor="middle" x="6179" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 32768&#45;36863</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_8 -->
<g id="edge149" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_8</title>
<path fill="none" stroke="black" d="M6179,-933.4C6179,-925.34 6179,-916.55 6179,-907.88"/>
<polygon fill="black" stroke="black" points="6182.5,-907.82 6179,-897.82 6175.5,-907.82 6182.5,-907.82"/>
</g>
<!-- ffn_fc1_gpu_9 -->
<g id="node84" class="node">
<title>ffn_fc1_gpu_9</title>
<polygon fill="lightblue" stroke="black" points="6831,-897.55 6409,-897.55 6409,-814.55 6831,-814.55 6831,-897.55"/>
<text text-anchor="middle" x="6620" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="6620" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="6620" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="6620" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_9</text>
<text text-anchor="middle" x="6620" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 36864&#45;40959</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_9 -->
<g id="edge153" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_9</title>
<path fill="none" stroke="black" d="M6311.91,-933.54C6354.32,-923.01 6401.9,-911.2 6446.74,-900.07"/>
<polygon fill="black" stroke="black" points="6447.7,-903.44 6456.56,-897.63 6446.01,-896.64 6447.7,-903.44"/>
</g>
<!-- ffn_fc1_gpu_10 -->
<g id="node85" class="node">
<title>ffn_fc1_gpu_10</title>
<polygon fill="lightblue" stroke="black" points="7272,-897.55 6850,-897.55 6850,-814.55 7272,-814.55 7272,-897.55"/>
<text text-anchor="middle" x="7061" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="7061" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="7061" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="7061" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_10</text>
<text text-anchor="middle" x="7061" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 40960&#45;45055</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_10 -->
<g id="edge157" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_10</title>
<path fill="none" stroke="black" d="M6396.1,-948.14C6525.33,-936.13 6692.39,-918.74 6840,-897.55 6840.1,-897.53 6840.21,-897.52 6840.31,-897.5"/>
<polygon fill="black" stroke="black" points="6840.53,-901.01 6849.92,-896.09 6839.52,-894.08 6840.53,-901.01"/>
</g>
<!-- ffn_fc1_gpu_11 -->
<g id="node86" class="node">
<title>ffn_fc1_gpu_11</title>
<polygon fill="lightblue" stroke="black" points="7714,-897.55 7292,-897.55 7292,-814.55 7714,-814.55 7714,-897.55"/>
<text text-anchor="middle" x="7503" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="7503" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="7503" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="7503" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_11</text>
<text text-anchor="middle" x="7503" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 45056&#45;49151</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_11 -->
<g id="edge161" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_11</title>
<path fill="none" stroke="black" d="M6396.11,-960.51C6618.87,-952.54 6975.12,-934.89 7281,-897.55 7281.22,-897.52 7281.45,-897.49 7281.67,-897.46"/>
<polygon fill="black" stroke="black" points="7282.4,-900.9 7291.87,-896.17 7281.51,-893.96 7282.4,-900.9"/>
</g>
<!-- ffn_fc1_gpu_12 -->
<g id="node87" class="node">
<title>ffn_fc1_gpu_12</title>
<polygon fill="lightblue" stroke="black" points="8157,-897.55 7735,-897.55 7735,-814.55 8157,-814.55 8157,-897.55"/>
<text text-anchor="middle" x="7946" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="7946" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="7946" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="7946" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_12</text>
<text text-anchor="middle" x="7946" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 49152&#45;53247</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_12 -->
<g id="edge165" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_12</title>
<path fill="none" stroke="black" d="M6396.11,-966.06C6695.59,-963.29 7251.89,-950.61 7723,-897.55 7723.61,-897.48 7724.22,-897.41 7724.84,-897.34"/>
<polygon fill="black" stroke="black" points="7725.31,-900.81 7734.83,-896.15 7724.48,-893.86 7725.31,-900.81"/>
</g>
<!-- ffn_fc1_gpu_13 -->
<g id="node88" class="node">
<title>ffn_fc1_gpu_13</title>
<polygon fill="lightblue" stroke="black" points="8600,-897.55 8178,-897.55 8178,-814.55 8600,-814.55 8600,-897.55"/>
<text text-anchor="middle" x="8389" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="8389" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="8389" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="8389" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_13</text>
<text text-anchor="middle" x="8389" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 53248&#45;57343</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_13 -->
<g id="edge169" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_13</title>
<path fill="none" stroke="black" d="M6396.05,-962.98C6837.94,-955.08 7828.71,-933.84 8166,-897.55 8166.61,-897.48 8167.22,-897.41 8167.84,-897.35"/>
<polygon fill="black" stroke="black" points="8168.3,-900.82 8177.83,-896.2 8167.5,-893.86 8168.3,-900.82"/>
</g>
<!-- ffn_fc1_gpu_14 -->
<g id="node89" class="node">
<title>ffn_fc1_gpu_14</title>
<polygon fill="lightblue" stroke="black" points="9043,-897.55 8621,-897.55 8621,-814.55 9043,-814.55 9043,-897.55"/>
<text text-anchor="middle" x="8832" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="8832" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="8832" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="8832" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_14</text>
<text text-anchor="middle" x="8832" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 57344&#45;61439</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_14 -->
<g id="edge173" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_14</title>
<path fill="none" stroke="black" d="M6396.39,-964.59C6909.32,-959.29 8183.73,-941.94 8609,-897.55 8609.61,-897.48 8610.22,-897.42 8610.84,-897.35"/>
<polygon fill="black" stroke="black" points="8611.29,-900.82 8620.84,-896.23 8610.51,-893.87 8611.29,-900.82"/>
</g>
<!-- ffn_fc1_gpu_15 -->
<g id="node90" class="node">
<title>ffn_fc1_gpu_15</title>
<polygon fill="lightblue" stroke="black" points="9486,-897.55 9064,-897.55 9064,-814.55 9486,-814.55 9486,-897.55"/>
<text text-anchor="middle" x="9275" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="9275" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="9275" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="9275" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_15</text>
<text text-anchor="middle" x="9275" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 61440&#45;65535</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_15 -->
<g id="edge177" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_15</title>
<path fill="none" stroke="black" d="M6396.18,-965.71C6973.61,-962.78 8537.74,-950.1 9052,-897.55 9052.61,-897.48 9053.22,-897.42 9053.84,-897.36"/>
<polygon fill="black" stroke="black" points="9054.28,-900.83 9063.84,-896.26 9053.52,-893.87 9054.28,-900.83"/>
</g>
<!-- residual_ffn -->
<g id="node124" class="node">
<title>residual_ffn</title>
<ellipse fill="lightgreen" stroke="black" cx="7850" cy="-294.86" rx="306.77" ry="58.88"/>
<text text-anchor="middle" x="7850" y="-321.16" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7850" y="-306.16" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="7850" y="-291.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="7850" y="-276.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="7850" y="-261.16" font-family="Times,serif" font-size="14.00">Device: all GPUs</text>
</g>
<!-- rmsnorm1&#45;&gt;residual_ffn -->
<g id="edge182" class="edge">
<title>rmsnorm1&#45;&gt;residual_ffn</title>
<path fill="none" stroke="black" d="M6396.04,-965.72C7123.94,-962.47 9436.21,-948.19 9495,-897.55 9546.93,-852.81 9521,-814.08 9521,-745.55 9521,-745.55 9521,-745.55 9521,-632.05 9521,-612.16 9517.77,-603.65 9502,-591.55 9294.3,-432.13 8563.98,-350.81 8147.24,-316.51"/>
<polygon fill="black" stroke="black" points="8147.4,-313.01 8137.15,-315.68 8146.83,-319.98 8147.4,-313.01"/>
</g>
<!-- ffn_act_gpu_0 -->
<g id="node91" class="node">
<title>ffn_act_gpu_0</title>
<polygon fill="lightblue" stroke="black" points="2833.5,-778.55 2438.5,-778.55 2438.5,-710.55 2833.5,-710.55 2833.5,-778.55"/>
<text text-anchor="middle" x="2636" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="2636" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="2636" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="2636" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_0</text>
</g>
<!-- ffn_fc1_gpu_0&#45;&gt;ffn_act_gpu_0 -->
<g id="edge118" class="edge">
<title>ffn_fc1_gpu_0&#45;&gt;ffn_act_gpu_0</title>
<path fill="none" stroke="black" d="M2643.53,-814.27C2642.62,-805.97 2641.66,-797.21 2640.74,-788.83"/>
<polygon fill="black" stroke="black" points="2644.22,-788.41 2639.65,-778.85 2637.26,-789.17 2644.22,-788.41"/>
</g>
<!-- ffn_act_gpu_1 -->
<g id="node92" class="node">
<title>ffn_act_gpu_1</title>
<polygon fill="lightblue" stroke="black" points="3283.5,-778.55 2888.5,-778.55 2888.5,-710.55 3283.5,-710.55 3283.5,-778.55"/>
<text text-anchor="middle" x="3086" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="3086" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="3086" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="3086" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_1</text>
</g>
<!-- ffn_fc1_gpu_1&#45;&gt;ffn_act_gpu_1 -->
<g id="edge122" class="edge">
<title>ffn_fc1_gpu_1&#45;&gt;ffn_act_gpu_1</title>
<path fill="none" stroke="black" d="M3091.02,-814.27C3090.41,-805.97 3089.77,-797.21 3089.16,-788.83"/>
<polygon fill="black" stroke="black" points="3092.65,-788.56 3088.43,-778.85 3085.67,-789.07 3092.65,-788.56"/>
</g>
<!-- ffn_act_gpu_2 -->
<g id="node93" class="node">
<title>ffn_act_gpu_2</title>
<polygon fill="lightblue" stroke="black" points="3726.5,-778.55 3331.5,-778.55 3331.5,-710.55 3726.5,-710.55 3726.5,-778.55"/>
<text text-anchor="middle" x="3529" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="3529" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="3529" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="3529" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_2</text>
</g>
<!-- ffn_fc1_gpu_2&#45;&gt;ffn_act_gpu_2 -->
<g id="edge126" class="edge">
<title>ffn_fc1_gpu_2&#45;&gt;ffn_act_gpu_2</title>
<path fill="none" stroke="black" d="M3534.02,-814.27C3533.41,-805.97 3532.77,-797.21 3532.16,-788.83"/>
<polygon fill="black" stroke="black" points="3535.65,-788.56 3531.43,-778.85 3528.67,-789.07 3535.65,-788.56"/>
</g>
<!-- ffn_act_gpu_3 -->
<g id="node94" class="node">
<title>ffn_act_gpu_3</title>
<polygon fill="lightblue" stroke="black" points="4168.5,-778.55 3773.5,-778.55 3773.5,-710.55 4168.5,-710.55 4168.5,-778.55"/>
<text text-anchor="middle" x="3971" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="3971" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="3971" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="3971" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_3</text>
</g>
<!-- ffn_fc1_gpu_3&#45;&gt;ffn_act_gpu_3 -->
<g id="edge130" class="edge">
<title>ffn_fc1_gpu_3&#45;&gt;ffn_act_gpu_3</title>
<path fill="none" stroke="black" d="M3975.39,-814.27C3974.86,-805.97 3974.3,-797.21 3973.77,-788.83"/>
<polygon fill="black" stroke="black" points="3977.26,-788.6 3973.13,-778.85 3970.27,-789.05 3977.26,-788.6"/>
</g>
<!-- ffn_act_gpu_4 -->
<g id="node95" class="node">
<title>ffn_act_gpu_4</title>
<polygon fill="lightblue" stroke="black" points="4610.5,-778.55 4215.5,-778.55 4215.5,-710.55 4610.5,-710.55 4610.5,-778.55"/>
<text text-anchor="middle" x="4413" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="4413" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="4413" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="4413" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_4</text>
</g>
<!-- ffn_fc1_gpu_4&#45;&gt;ffn_act_gpu_4 -->
<g id="edge134" class="edge">
<title>ffn_fc1_gpu_4&#45;&gt;ffn_act_gpu_4</title>
<path fill="none" stroke="black" d="M4416.77,-814.27C4416.32,-806.06 4415.84,-797.41 4415.39,-789.11"/>
<polygon fill="black" stroke="black" points="4418.87,-788.64 4414.82,-778.85 4411.88,-789.02 4418.87,-788.64"/>
</g>
<!-- ffn_act_gpu_5 -->
<g id="node96" class="node">
<title>ffn_act_gpu_5</title>
<polygon fill="lightblue" stroke="black" points="5052.5,-778.55 4657.5,-778.55 4657.5,-710.55 5052.5,-710.55 5052.5,-778.55"/>
<text text-anchor="middle" x="4855" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="4855" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="4855" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="4855" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_5</text>
</g>
<!-- ffn_fc1_gpu_5&#45;&gt;ffn_act_gpu_5 -->
<g id="edge138" class="edge">
<title>ffn_fc1_gpu_5&#45;&gt;ffn_act_gpu_5</title>
<path fill="none" stroke="black" d="M4857.51,-814.27C4857.21,-806.06 4856.89,-797.41 4856.59,-789.11"/>
<polygon fill="black" stroke="black" points="4860.08,-788.71 4856.22,-778.85 4853.08,-788.97 4860.08,-788.71"/>
</g>
<!-- ffn_act_gpu_6 -->
<g id="node97" class="node">
<title>ffn_act_gpu_6</title>
<polygon fill="lightblue" stroke="black" points="5493.5,-778.55 5098.5,-778.55 5098.5,-710.55 5493.5,-710.55 5493.5,-778.55"/>
<text text-anchor="middle" x="5296" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="5296" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="5296" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="5296" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_6</text>
</g>
<!-- ffn_fc1_gpu_6&#45;&gt;ffn_act_gpu_6 -->
<g id="edge142" class="edge">
<title>ffn_fc1_gpu_6&#45;&gt;ffn_act_gpu_6</title>
<path fill="none" stroke="black" d="M5297.88,-814.27C5297.66,-806.06 5297.42,-797.41 5297.19,-789.11"/>
<polygon fill="black" stroke="black" points="5300.68,-788.75 5296.91,-778.85 5293.69,-788.94 5300.68,-788.75"/>
</g>
<!-- ffn_act_gpu_7 -->
<g id="node98" class="node">
<title>ffn_act_gpu_7</title>
<polygon fill="lightblue" stroke="black" points="5934.5,-778.55 5539.5,-778.55 5539.5,-710.55 5934.5,-710.55 5934.5,-778.55"/>
<text text-anchor="middle" x="5737" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="5737" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="5737" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="5737" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_7</text>
</g>
<!-- ffn_fc1_gpu_7&#45;&gt;ffn_act_gpu_7 -->
<g id="edge146" class="edge">
<title>ffn_fc1_gpu_7&#45;&gt;ffn_act_gpu_7</title>
<path fill="none" stroke="black" d="M5738.26,-814.27C5738.11,-806.06 5737.95,-797.41 5737.8,-789.11"/>
<polygon fill="black" stroke="black" points="5741.29,-788.78 5737.61,-778.85 5734.29,-788.91 5741.29,-788.78"/>
</g>
<!-- ffn_act_gpu_8 -->
<g id="node99" class="node">
<title>ffn_act_gpu_8</title>
<polygon fill="lightblue" stroke="black" points="6376.5,-778.55 5981.5,-778.55 5981.5,-710.55 6376.5,-710.55 6376.5,-778.55"/>
<text text-anchor="middle" x="6179" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="6179" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="6179" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="6179" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_8</text>
</g>
<!-- ffn_fc1_gpu_8&#45;&gt;ffn_act_gpu_8 -->
<g id="edge150" class="edge">
<title>ffn_fc1_gpu_8&#45;&gt;ffn_act_gpu_8</title>
<path fill="none" stroke="black" d="M6179,-814.27C6179,-806.06 6179,-797.41 6179,-789.11"/>
<polygon fill="black" stroke="black" points="6182.5,-788.85 6179,-778.85 6175.5,-788.85 6182.5,-788.85"/>
</g>
<!-- ffn_act_gpu_9 -->
<g id="node100" class="node">
<title>ffn_act_gpu_9</title>
<polygon fill="lightblue" stroke="black" points="6818.5,-778.55 6423.5,-778.55 6423.5,-710.55 6818.5,-710.55 6818.5,-778.55"/>
<text text-anchor="middle" x="6621" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="6621" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="6621" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="6621" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_9</text>
</g>
<!-- ffn_fc1_gpu_9&#45;&gt;ffn_act_gpu_9 -->
<g id="edge154" class="edge">
<title>ffn_fc1_gpu_9&#45;&gt;ffn_act_gpu_9</title>
<path fill="none" stroke="black" d="M6620.37,-814.27C6620.45,-806.06 6620.53,-797.41 6620.6,-789.11"/>
<polygon fill="black" stroke="black" points="6624.1,-788.88 6620.7,-778.85 6617.1,-788.81 6624.1,-788.88"/>
</g>
<!-- ffn_act_gpu_10 -->
<g id="node101" class="node">
<title>ffn_act_gpu_10</title>
<polygon fill="lightblue" stroke="black" points="7259.5,-778.55 6864.5,-778.55 6864.5,-710.55 7259.5,-710.55 7259.5,-778.55"/>
<text text-anchor="middle" x="7062" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="7062" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="7062" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="7062" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_10</text>
</g>
<!-- ffn_fc1_gpu_10&#45;&gt;ffn_act_gpu_10 -->
<g id="edge158" class="edge">
<title>ffn_fc1_gpu_10&#45;&gt;ffn_act_gpu_10</title>
<path fill="none" stroke="black" d="M7061.37,-814.27C7061.45,-806.06 7061.53,-797.41 7061.6,-789.11"/>
<polygon fill="black" stroke="black" points="7065.1,-788.88 7061.7,-778.85 7058.1,-788.81 7065.1,-788.88"/>
</g>
<!-- ffn_act_gpu_11 -->
<g id="node102" class="node">
<title>ffn_act_gpu_11</title>
<polygon fill="lightblue" stroke="black" points="7702.5,-778.55 7307.5,-778.55 7307.5,-710.55 7702.5,-710.55 7702.5,-778.55"/>
<text text-anchor="middle" x="7505" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="7505" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="7505" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="7505" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_11</text>
</g>
<!-- ffn_fc1_gpu_11&#45;&gt;ffn_act_gpu_11 -->
<g id="edge162" class="edge">
<title>ffn_fc1_gpu_11&#45;&gt;ffn_act_gpu_11</title>
<path fill="none" stroke="black" d="M7503.74,-814.27C7503.89,-806.06 7504.05,-797.41 7504.2,-789.11"/>
<polygon fill="black" stroke="black" points="7507.71,-788.91 7504.39,-778.85 7500.71,-788.78 7507.71,-788.91"/>
</g>
<!-- ffn_act_gpu_12 -->
<g id="node103" class="node">
<title>ffn_act_gpu_12</title>
<polygon fill="lightblue" stroke="black" points="8146.5,-778.55 7751.5,-778.55 7751.5,-710.55 8146.5,-710.55 8146.5,-778.55"/>
<text text-anchor="middle" x="7949" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="7949" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="7949" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="7949" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_12</text>
</g>
<!-- ffn_fc1_gpu_12&#45;&gt;ffn_act_gpu_12 -->
<g id="edge166" class="edge">
<title>ffn_fc1_gpu_12&#45;&gt;ffn_act_gpu_12</title>
<path fill="none" stroke="black" d="M7947.12,-814.27C7947.34,-806.06 7947.58,-797.41 7947.81,-789.11"/>
<polygon fill="black" stroke="black" points="7951.31,-788.94 7948.09,-778.85 7944.32,-788.75 7951.31,-788.94"/>
</g>
<!-- ffn_act_gpu_13 -->
<g id="node104" class="node">
<title>ffn_act_gpu_13</title>
<polygon fill="lightblue" stroke="black" points="8588.5,-778.55 8193.5,-778.55 8193.5,-710.55 8588.5,-710.55 8588.5,-778.55"/>
<text text-anchor="middle" x="8391" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="8391" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="8391" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="8391" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_13</text>
</g>
<!-- ffn_fc1_gpu_13&#45;&gt;ffn_act_gpu_13 -->
<g id="edge170" class="edge">
<title>ffn_fc1_gpu_13&#45;&gt;ffn_act_gpu_13</title>
<path fill="none" stroke="black" d="M8389.74,-814.27C8389.89,-806.06 8390.05,-797.41 8390.2,-789.11"/>
<polygon fill="black" stroke="black" points="8393.71,-788.91 8390.39,-778.85 8386.71,-788.78 8393.71,-788.91"/>
</g>
<!-- ffn_act_gpu_14 -->
<g id="node105" class="node">
<title>ffn_act_gpu_14</title>
<polygon fill="lightblue" stroke="black" points="9032.5,-778.55 8637.5,-778.55 8637.5,-710.55 9032.5,-710.55 9032.5,-778.55"/>
<text text-anchor="middle" x="8835" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="8835" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="8835" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="8835" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_14</text>
</g>
<!-- ffn_fc1_gpu_14&#45;&gt;ffn_act_gpu_14 -->
<g id="edge174" class="edge">
<title>ffn_fc1_gpu_14&#45;&gt;ffn_act_gpu_14</title>
<path fill="none" stroke="black" d="M8833.12,-814.27C8833.34,-806.06 8833.58,-797.41 8833.81,-789.11"/>
<polygon fill="black" stroke="black" points="8837.31,-788.94 8834.09,-778.85 8830.32,-788.75 8837.31,-788.94"/>
</g>
<!-- ffn_act_gpu_15 -->
<g id="node106" class="node">
<title>ffn_act_gpu_15</title>
<polygon fill="lightblue" stroke="black" points="9474.5,-778.55 9079.5,-778.55 9079.5,-710.55 9474.5,-710.55 9474.5,-778.55"/>
<text text-anchor="middle" x="9277" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="9277" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="9277" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="9277" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_15</text>
</g>
<!-- ffn_fc1_gpu_15&#45;&gt;ffn_act_gpu_15 -->
<g id="edge178" class="edge">
<title>ffn_fc1_gpu_15&#45;&gt;ffn_act_gpu_15</title>
<path fill="none" stroke="black" d="M9275.74,-814.27C9275.89,-806.06 9276.05,-797.41 9276.2,-789.11"/>
<polygon fill="black" stroke="black" points="9279.71,-788.91 9276.39,-778.85 9272.71,-788.78 9279.71,-788.91"/>
</g>
<!-- ffn_fc2_gpu_0 -->
<g id="node107" class="node">
<title>ffn_fc2_gpu_0</title>
<polygon fill="lightblue" stroke="black" points="2847.5,-674.55 2422.5,-674.55 2422.5,-591.55 2847.5,-591.55 2847.5,-674.55"/>
<text text-anchor="middle" x="2635" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="2635" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="2635" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="2635" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_0</text>
<text text-anchor="middle" x="2635" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 0&#45;1023</text>
</g>
<!-- ffn_act_gpu_0&#45;&gt;ffn_fc2_gpu_0 -->
<g id="edge119" class="edge">
<title>ffn_act_gpu_0&#45;&gt;ffn_fc2_gpu_0</title>
<path fill="none" stroke="black" d="M2635.7,-710.4C2635.62,-702.34 2635.54,-693.55 2635.46,-684.88"/>
<polygon fill="black" stroke="black" points="2638.96,-684.79 2635.37,-674.82 2631.96,-684.86 2638.96,-684.79"/>
</g>
<!-- ffn_fc2_gpu_1 -->
<g id="node108" class="node">
<title>ffn_fc2_gpu_1</title>
<polygon fill="lightblue" stroke="black" points="3290.5,-674.55 2865.5,-674.55 2865.5,-591.55 3290.5,-591.55 3290.5,-674.55"/>
<text text-anchor="middle" x="3078" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="3078" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="3078" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="3078" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_1</text>
<text text-anchor="middle" x="3078" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 1024&#45;2047</text>
</g>
<!-- ffn_act_gpu_1&#45;&gt;ffn_fc2_gpu_1 -->
<g id="edge123" class="edge">
<title>ffn_act_gpu_1&#45;&gt;ffn_fc2_gpu_1</title>
<path fill="none" stroke="black" d="M3083.58,-710.4C3082.99,-702.34 3082.35,-693.55 3081.71,-684.88"/>
<polygon fill="black" stroke="black" points="3085.2,-684.54 3080.98,-674.82 3078.22,-685.05 3085.2,-684.54"/>
</g>
<!-- ffn_fc2_gpu_2 -->
<g id="node109" class="node">
<title>ffn_fc2_gpu_2</title>
<polygon fill="lightblue" stroke="black" points="3733.5,-674.55 3308.5,-674.55 3308.5,-591.55 3733.5,-591.55 3733.5,-674.55"/>
<text text-anchor="middle" x="3521" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="3521" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="3521" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="3521" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_2</text>
<text text-anchor="middle" x="3521" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 2048&#45;3071</text>
</g>
<!-- ffn_act_gpu_2&#45;&gt;ffn_fc2_gpu_2 -->
<g id="edge127" class="edge">
<title>ffn_act_gpu_2&#45;&gt;ffn_fc2_gpu_2</title>
<path fill="none" stroke="black" d="M3526.58,-710.4C3525.99,-702.34 3525.35,-693.55 3524.71,-684.88"/>
<polygon fill="black" stroke="black" points="3528.2,-684.54 3523.98,-674.82 3521.22,-685.05 3528.2,-684.54"/>
</g>
<!-- ffn_fc2_gpu_3 -->
<g id="node110" class="node">
<title>ffn_fc2_gpu_3</title>
<polygon fill="lightblue" stroke="black" points="4176.5,-674.55 3751.5,-674.55 3751.5,-591.55 4176.5,-591.55 4176.5,-674.55"/>
<text text-anchor="middle" x="3964" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="3964" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="3964" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="3964" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_3</text>
<text text-anchor="middle" x="3964" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 3072&#45;4095</text>
</g>
<!-- ffn_act_gpu_3&#45;&gt;ffn_fc2_gpu_3 -->
<g id="edge131" class="edge">
<title>ffn_act_gpu_3&#45;&gt;ffn_fc2_gpu_3</title>
<path fill="none" stroke="black" d="M3968.88,-710.4C3968.37,-702.34 3967.8,-693.55 3967.25,-684.88"/>
<polygon fill="black" stroke="black" points="3970.74,-684.58 3966.61,-674.82 3963.75,-685.03 3970.74,-684.58"/>
</g>
<!-- ffn_fc2_gpu_4 -->
<g id="node111" class="node">
<title>ffn_fc2_gpu_4</title>
<polygon fill="lightblue" stroke="black" points="4619.5,-674.55 4194.5,-674.55 4194.5,-591.55 4619.5,-591.55 4619.5,-674.55"/>
<text text-anchor="middle" x="4407" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="4407" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="4407" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="4407" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_4</text>
<text text-anchor="middle" x="4407" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 4096&#45;5119</text>
</g>
<!-- ffn_act_gpu_4&#45;&gt;ffn_fc2_gpu_4 -->
<g id="edge135" class="edge">
<title>ffn_act_gpu_4&#45;&gt;ffn_fc2_gpu_4</title>
<path fill="none" stroke="black" d="M4411.18,-710.4C4410.74,-702.34 4410.26,-693.55 4409.79,-684.88"/>
<polygon fill="black" stroke="black" points="4413.28,-684.62 4409.23,-674.82 4406.29,-685 4413.28,-684.62"/>
</g>
<!-- ffn_fc2_gpu_5 -->
<g id="node112" class="node">
<title>ffn_fc2_gpu_5</title>
<polygon fill="lightblue" stroke="black" points="5062.5,-674.55 4637.5,-674.55 4637.5,-591.55 5062.5,-591.55 5062.5,-674.55"/>
<text text-anchor="middle" x="4850" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="4850" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="4850" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="4850" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_5</text>
<text text-anchor="middle" x="4850" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 5120&#45;6143</text>
</g>
<!-- ffn_act_gpu_5&#45;&gt;ffn_fc2_gpu_5 -->
<g id="edge139" class="edge">
<title>ffn_act_gpu_5&#45;&gt;ffn_fc2_gpu_5</title>
<path fill="none" stroke="black" d="M4853.49,-710.4C4853.12,-702.34 4852.72,-693.55 4852.32,-684.88"/>
<polygon fill="black" stroke="black" points="4855.81,-684.65 4851.86,-674.82 4848.82,-684.97 4855.81,-684.65"/>
</g>
<!-- ffn_fc2_gpu_6 -->
<g id="node113" class="node">
<title>ffn_fc2_gpu_6</title>
<polygon fill="lightblue" stroke="black" points="5505.5,-674.55 5080.5,-674.55 5080.5,-591.55 5505.5,-591.55 5505.5,-674.55"/>
<text text-anchor="middle" x="5293" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="5293" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="5293" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="5293" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_6</text>
<text text-anchor="middle" x="5293" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 6144&#45;7167</text>
</g>
<!-- ffn_act_gpu_6&#45;&gt;ffn_fc2_gpu_6 -->
<g id="edge143" class="edge">
<title>ffn_act_gpu_6&#45;&gt;ffn_fc2_gpu_6</title>
<path fill="none" stroke="black" d="M5295.09,-710.4C5294.87,-702.34 5294.63,-693.55 5294.39,-684.88"/>
<polygon fill="black" stroke="black" points="5297.89,-684.72 5294.12,-674.82 5290.89,-684.92 5297.89,-684.72"/>
</g>
<!-- ffn_fc2_gpu_7 -->
<g id="node114" class="node">
<title>ffn_fc2_gpu_7</title>
<polygon fill="lightblue" stroke="black" points="5948.5,-674.55 5523.5,-674.55 5523.5,-591.55 5948.5,-591.55 5948.5,-674.55"/>
<text text-anchor="middle" x="5736" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="5736" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="5736" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="5736" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_7</text>
<text text-anchor="middle" x="5736" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 7168&#45;8191</text>
</g>
<!-- ffn_act_gpu_7&#45;&gt;ffn_fc2_gpu_7 -->
<g id="edge147" class="edge">
<title>ffn_act_gpu_7&#45;&gt;ffn_fc2_gpu_7</title>
<path fill="none" stroke="black" d="M5736.7,-710.4C5736.62,-702.34 5736.54,-693.55 5736.46,-684.88"/>
<polygon fill="black" stroke="black" points="5739.96,-684.79 5736.37,-674.82 5732.96,-684.86 5739.96,-684.79"/>
</g>
<!-- ffn_fc2_gpu_8 -->
<g id="node115" class="node">
<title>ffn_fc2_gpu_8</title>
<polygon fill="lightblue" stroke="black" points="6391.5,-674.55 5966.5,-674.55 5966.5,-591.55 6391.5,-591.55 6391.5,-674.55"/>
<text text-anchor="middle" x="6179" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="6179" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="6179" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="6179" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_8</text>
<text text-anchor="middle" x="6179" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 8192&#45;9215</text>
</g>
<!-- ffn_act_gpu_8&#45;&gt;ffn_fc2_gpu_8 -->
<g id="edge151" class="edge">
<title>ffn_act_gpu_8&#45;&gt;ffn_fc2_gpu_8</title>
<path fill="none" stroke="black" d="M6179,-710.4C6179,-702.34 6179,-693.55 6179,-684.88"/>
<polygon fill="black" stroke="black" points="6182.5,-684.82 6179,-674.82 6175.5,-684.82 6182.5,-684.82"/>
</g>
<!-- ffn_fc2_gpu_9 -->
<g id="node116" class="node">
<title>ffn_fc2_gpu_9</title>
<polygon fill="lightblue" stroke="black" points="6834.5,-674.55 6409.5,-674.55 6409.5,-591.55 6834.5,-591.55 6834.5,-674.55"/>
<text text-anchor="middle" x="6622" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="6622" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="6622" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="6622" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_9</text>
<text text-anchor="middle" x="6622" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 9216&#45;10239</text>
</g>
<!-- ffn_act_gpu_9&#45;&gt;ffn_fc2_gpu_9 -->
<g id="edge155" class="edge">
<title>ffn_act_gpu_9&#45;&gt;ffn_fc2_gpu_9</title>
<path fill="none" stroke="black" d="M6621.3,-710.4C6621.38,-702.34 6621.46,-693.55 6621.54,-684.88"/>
<polygon fill="black" stroke="black" points="6625.04,-684.86 6621.63,-674.82 6618.04,-684.79 6625.04,-684.86"/>
</g>
<!-- ffn_fc2_gpu_10 -->
<g id="node117" class="node">
<title>ffn_fc2_gpu_10</title>
<polygon fill="lightblue" stroke="black" points="7277.5,-674.55 6852.5,-674.55 6852.5,-591.55 7277.5,-591.55 7277.5,-674.55"/>
<text text-anchor="middle" x="7065" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="7065" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="7065" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="7065" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_10</text>
<text text-anchor="middle" x="7065" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 10240&#45;11263</text>
</g>
<!-- ffn_act_gpu_10&#45;&gt;ffn_fc2_gpu_10 -->
<g id="edge159" class="edge">
<title>ffn_act_gpu_10&#45;&gt;ffn_fc2_gpu_10</title>
<path fill="none" stroke="black" d="M7062.91,-710.4C7063.13,-702.34 7063.37,-693.55 7063.61,-684.88"/>
<polygon fill="black" stroke="black" points="7067.11,-684.92 7063.88,-674.82 7060.11,-684.72 7067.11,-684.92"/>
</g>
<!-- ffn_fc2_gpu_11 -->
<g id="node118" class="node">
<title>ffn_fc2_gpu_11</title>
<polygon fill="lightblue" stroke="black" points="7720.5,-674.55 7295.5,-674.55 7295.5,-591.55 7720.5,-591.55 7720.5,-674.55"/>
<text text-anchor="middle" x="7508" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="7508" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="7508" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="7508" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_11</text>
<text text-anchor="middle" x="7508" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 11264&#45;12287</text>
</g>
<!-- ffn_act_gpu_11&#45;&gt;ffn_fc2_gpu_11 -->
<g id="edge163" class="edge">
<title>ffn_act_gpu_11&#45;&gt;ffn_fc2_gpu_11</title>
<path fill="none" stroke="black" d="M7505.91,-710.4C7506.13,-702.34 7506.37,-693.55 7506.61,-684.88"/>
<polygon fill="black" stroke="black" points="7510.11,-684.92 7506.88,-674.82 7503.11,-684.72 7510.11,-684.92"/>
</g>
<!-- ffn_fc2_gpu_12 -->
<g id="node119" class="node">
<title>ffn_fc2_gpu_12</title>
<polygon fill="lightblue" stroke="black" points="8163.5,-674.55 7738.5,-674.55 7738.5,-591.55 8163.5,-591.55 8163.5,-674.55"/>
<text text-anchor="middle" x="7951" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="7951" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="7951" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="7951" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_12</text>
<text text-anchor="middle" x="7951" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 12288&#45;13311</text>
</g>
<!-- ffn_act_gpu_12&#45;&gt;ffn_fc2_gpu_12 -->
<g id="edge167" class="edge">
<title>ffn_act_gpu_12&#45;&gt;ffn_fc2_gpu_12</title>
<path fill="none" stroke="black" d="M7949.61,-710.4C7949.75,-702.34 7949.91,-693.55 7950.07,-684.88"/>
<polygon fill="black" stroke="black" points="7953.57,-684.89 7950.26,-674.82 7946.57,-684.76 7953.57,-684.89"/>
</g>
<!-- ffn_fc2_gpu_13 -->
<g id="node120" class="node">
<title>ffn_fc2_gpu_13</title>
<polygon fill="lightblue" stroke="black" points="8606.5,-674.55 8181.5,-674.55 8181.5,-591.55 8606.5,-591.55 8606.5,-674.55"/>
<text text-anchor="middle" x="8394" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="8394" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="8394" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="8394" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_13</text>
<text text-anchor="middle" x="8394" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 13312&#45;14335</text>
</g>
<!-- ffn_act_gpu_13&#45;&gt;ffn_fc2_gpu_13 -->
<g id="edge171" class="edge">
<title>ffn_act_gpu_13&#45;&gt;ffn_fc2_gpu_13</title>
<path fill="none" stroke="black" d="M8391.91,-710.4C8392.13,-702.34 8392.37,-693.55 8392.61,-684.88"/>
<polygon fill="black" stroke="black" points="8396.11,-684.92 8392.88,-674.82 8389.11,-684.72 8396.11,-684.92"/>
</g>
<!-- ffn_fc2_gpu_14 -->
<g id="node121" class="node">
<title>ffn_fc2_gpu_14</title>
<polygon fill="lightblue" stroke="black" points="9049.5,-674.55 8624.5,-674.55 8624.5,-591.55 9049.5,-591.55 9049.5,-674.55"/>
<text text-anchor="middle" x="8837" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="8837" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="8837" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="8837" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_14</text>
<text text-anchor="middle" x="8837" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 14336&#45;15359</text>
</g>
<!-- ffn_act_gpu_14&#45;&gt;ffn_fc2_gpu_14 -->
<g id="edge175" class="edge">
<title>ffn_act_gpu_14&#45;&gt;ffn_fc2_gpu_14</title>
<path fill="none" stroke="black" d="M8835.61,-710.4C8835.75,-702.34 8835.91,-693.55 8836.07,-684.88"/>
<polygon fill="black" stroke="black" points="8839.57,-684.89 8836.26,-674.82 8832.57,-684.76 8839.57,-684.89"/>
</g>
<!-- ffn_fc2_gpu_15 -->
<g id="node122" class="node">
<title>ffn_fc2_gpu_15</title>
<polygon fill="lightblue" stroke="black" points="9492.5,-674.55 9067.5,-674.55 9067.5,-591.55 9492.5,-591.55 9492.5,-674.55"/>
<text text-anchor="middle" x="9280" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="9280" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=4096]</text>
<text text-anchor="middle" x="9280" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=1024]</text>
<text text-anchor="middle" x="9280" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_15</text>
<text text-anchor="middle" x="9280" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 15360&#45;16383</text>
</g>
<!-- ffn_act_gpu_15&#45;&gt;ffn_fc2_gpu_15 -->
<g id="edge179" class="edge">
<title>ffn_act_gpu_15&#45;&gt;ffn_fc2_gpu_15</title>
<path fill="none" stroke="black" d="M9277.91,-710.4C9278.13,-702.34 9278.37,-693.55 9278.61,-684.88"/>
<polygon fill="black" stroke="black" points="9282.11,-684.92 9278.88,-674.82 9275.11,-684.72 9282.11,-684.92"/>
</g>
<!-- ffn_all_reduce -->
<g id="node123" class="node">
<title>ffn_all_reduce</title>
<polygon fill="yellow" stroke="black" points="6628.9,-555.55 5913.21,-555.55 5729.1,-389.55 6444.79,-389.55 6628.9,-555.55"/>
<text text-anchor="middle" x="6179" y="-498.85" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="6179" y="-483.85" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="6179" y="-468.85" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="6179" y="-453.85" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="6179" y="-438.85" font-family="Times,serif" font-size="14.00">Device: all GPUs</text>
</g>
<!-- ffn_fc2_gpu_0&#45;&gt;ffn_all_reduce -->
<g id="edge120" class="edge">
<title>ffn_fc2_gpu_0&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M2847.59,-592.61C2850.75,-592.24 2853.88,-591.88 2857,-591.55 3421.47,-530.36 5080.84,-493.52 5818.46,-479.75"/>
<polygon fill="black" stroke="black" points="5818.77,-483.24 5828.71,-479.56 5818.64,-476.24 5818.77,-483.24"/>
</g>
<!-- ffn_fc2_gpu_1&#45;&gt;ffn_all_reduce -->
<g id="edge124" class="edge">
<title>ffn_fc2_gpu_1&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M3290.59,-592.64C3293.75,-592.26 3296.88,-591.89 3300,-591.55 3777.86,-538.43 5161.37,-498.55 5821,-481.98"/>
<polygon fill="black" stroke="black" points="5821.23,-485.47 5831.14,-481.72 5821.06,-478.47 5821.23,-485.47"/>
</g>
<!-- ffn_fc2_gpu_2&#45;&gt;ffn_all_reduce -->
<g id="edge128" class="edge">
<title>ffn_fc2_gpu_2&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M3733.6,-592.67C3736.75,-592.28 3739.89,-591.9 3743,-591.55 4474.96,-507.42 5337.35,-483.14 5814.67,-476.22"/>
<polygon fill="black" stroke="black" points="5814.88,-479.72 5824.83,-476.07 5814.78,-472.72 5814.88,-479.72"/>
</g>
<!-- ffn_fc2_gpu_3&#45;&gt;ffn_all_reduce -->
<g id="edge132" class="edge">
<title>ffn_fc2_gpu_3&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M4176.6,-592.72C4179.75,-592.31 4182.89,-591.92 4186,-591.55 4755.14,-523.04 5420.73,-493.8 5820.6,-481.68"/>
<polygon fill="black" stroke="black" points="5820.99,-485.17 5830.88,-481.37 5820.78,-478.18 5820.99,-485.17"/>
</g>
<!-- ffn_fc2_gpu_4&#45;&gt;ffn_all_reduce -->
<g id="edge136" class="edge">
<title>ffn_fc2_gpu_4&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M4619.61,-592.79C4622.76,-592.36 4625.89,-591.95 4629,-591.55 5039.42,-538.63 5514.26,-506.77 5829.11,-489.73"/>
<polygon fill="black" stroke="black" points="5829.51,-493.21 5839.31,-489.18 5829.14,-486.22 5829.51,-493.21"/>
</g>
<!-- ffn_fc2_gpu_5&#45;&gt;ffn_all_reduce -->
<g id="edge140" class="edge">
<title>ffn_fc2_gpu_5&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M5062.63,-592.92C5065.77,-592.45 5068.9,-591.99 5072,-591.55 5329.99,-554.32 5623.38,-523.56 5843.28,-502.8"/>
<polygon fill="black" stroke="black" points="5843.74,-506.27 5853.36,-501.85 5843.08,-499.3 5843.74,-506.27"/>
</g>
<!-- ffn_fc2_gpu_6&#45;&gt;ffn_all_reduce -->
<g id="edge144" class="edge">
<title>ffn_fc2_gpu_6&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M5505.68,-593.23C5508.81,-592.66 5511.92,-592.1 5515,-591.55 5631.05,-570.65 5758.55,-547.93 5870.54,-528.06"/>
<polygon fill="black" stroke="black" points="5871.4,-531.46 5880.64,-526.27 5870.18,-524.57 5871.4,-531.46"/>
</g>
<!-- ffn_fc2_gpu_7&#45;&gt;ffn_all_reduce -->
<g id="edge148" class="edge">
<title>ffn_fc2_gpu_7&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M5849.22,-591.54C5877.22,-581.52 5908.27,-570.41 5939.81,-559.13"/>
<polygon fill="black" stroke="black" points="5941.37,-562.28 5949.61,-555.62 5939.01,-555.69 5941.37,-562.28"/>
</g>
<!-- ffn_fc2_gpu_8&#45;&gt;ffn_all_reduce -->
<g id="edge152" class="edge">
<title>ffn_fc2_gpu_8&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M6179,-591.23C6179,-583.3 6179,-574.69 6179,-565.86"/>
<polygon fill="black" stroke="black" points="6182.5,-565.82 6179,-555.82 6175.5,-565.82 6182.5,-565.82"/>
</g>
<!-- ffn_fc2_gpu_9&#45;&gt;ffn_all_reduce -->
<g id="edge156" class="edge">
<title>ffn_fc2_gpu_9&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M6508.78,-591.54C6480.78,-581.52 6449.73,-570.41 6418.19,-559.13"/>
<polygon fill="black" stroke="black" points="6418.99,-555.69 6408.39,-555.62 6416.63,-562.28 6418.99,-555.69"/>
</g>
<!-- ffn_fc2_gpu_10&#45;&gt;ffn_all_reduce -->
<g id="edge160" class="edge">
<title>ffn_fc2_gpu_10&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M6852.4,-593.06C6849.59,-592.55 6846.78,-592.05 6844,-591.55 6776.77,-579.42 6705.7,-566.7 6636.02,-554.29"/>
<polygon fill="black" stroke="black" points="6636.21,-550.77 6625.75,-552.46 6634.98,-557.66 6636.21,-550.77"/>
</g>
<!-- ffn_fc2_gpu_11&#45;&gt;ffn_all_reduce -->
<g id="edge164" class="edge">
<title>ffn_fc2_gpu_11&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M7295.45,-592.79C7292.62,-592.37 7289.8,-591.95 7287,-591.55 7056.13,-558.15 6796.91,-530.03 6587.28,-509.63"/>
<polygon fill="black" stroke="black" points="6587.31,-506.12 6577.02,-508.63 6586.64,-513.08 6587.31,-506.12"/>
</g>
<!-- ffn_fc2_gpu_12&#45;&gt;ffn_all_reduce -->
<g id="edge168" class="edge">
<title>ffn_fc2_gpu_12&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M7738.47,-592.67C7735.63,-592.28 7732.8,-591.91 7730,-591.55 7335.9,-540.59 6882.4,-509.22 6568,-491.77"/>
<polygon fill="black" stroke="black" points="6567.99,-488.26 6557.81,-491.2 6567.6,-495.25 6567.99,-488.26"/>
</g>
<!-- ffn_fc2_gpu_13&#45;&gt;ffn_all_reduce -->
<g id="edge172" class="edge">
<title>ffn_fc2_gpu_13&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M8181.47,-592.6C8178.63,-592.24 8175.81,-591.89 8173,-591.55 7612.85,-523.9 6959.28,-494.58 6557.3,-482.19"/>
<polygon fill="black" stroke="black" points="6557.36,-478.69 6547.26,-481.88 6557.15,-485.68 6557.36,-478.69"/>
</g>
<!-- ffn_fc2_gpu_14&#45;&gt;ffn_all_reduce -->
<g id="edge176" class="edge">
<title>ffn_fc2_gpu_14&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M8624.48,-592.56C8621.64,-592.21 8618.81,-591.87 8616,-591.55 7887.69,-507.56 7030.24,-483.2 6551.18,-476.23"/>
<polygon fill="black" stroke="black" points="6551.04,-472.73 6540.99,-476.08 6550.94,-479.73 6551.04,-472.73"/>
</g>
<!-- ffn_fc2_gpu_15&#45;&gt;ffn_all_reduce -->
<g id="edge180" class="edge">
<title>ffn_fc2_gpu_15&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M9067.48,-592.53C9064.64,-592.19 9061.81,-591.86 9059,-591.55 8585.94,-538.77 7225.55,-499.27 6557.85,-482.46"/>
<polygon fill="black" stroke="black" points="6557.67,-478.95 6547.58,-482.2 6557.49,-485.95 6557.67,-478.95"/>
</g>
<!-- ffn_all_reduce&#45;&gt;residual_ffn -->
<g id="edge181" class="edge">
<title>ffn_all_reduce&#45;&gt;residual_ffn</title>
<path fill="none" stroke="black" d="M6498.71,-437.93C6809.75,-405.23 7277.42,-356.06 7573.02,-324.98"/>
<polygon fill="black" stroke="black" points="7573.45,-328.45 7583.03,-323.93 7572.72,-321.49 7573.45,-328.45"/>
</g>
<!-- rmsnorm2 -->
<g id="node125" class="node">
<title>rmsnorm2</title>
<polygon fill="lightgray" stroke="black" points="8067,-200.17 7633,-200.17 7633,-132.17 8067,-132.17 8067,-200.17"/>
<text text-anchor="middle" x="7850" y="-184.97" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="7850" y="-169.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="7850" y="-154.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="7850" y="-139.97" font-family="Times,serif" font-size="14.00">Device: all GPUs</text>
</g>
<!-- residual_ffn&#45;&gt;rmsnorm2 -->
<g id="edge183" class="edge">
<title>residual_ffn&#45;&gt;rmsnorm2</title>
<path fill="none" stroke="black" d="M7850,-236.07C7850,-227.45 7850,-218.68 7850,-210.42"/>
<polygon fill="black" stroke="black" points="7853.5,-210.28 7850,-200.28 7846.5,-210.28 7853.5,-210.28"/>
</g>
<!-- output -->
<g id="node126" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="7850" cy="-48.08" rx="332.18" ry="48.17"/>
<text text-anchor="middle" x="7850" y="-66.88" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="7850" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="7850" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, vocab_size=128000]</text>
<text text-anchor="middle" x="7850" y="-21.88" font-family="Times,serif" font-size="14.00">Device: CPU</text>
</g>
<!-- rmsnorm2&#45;&gt;output -->
<g id="edge184" class="edge">
<title>rmsnorm2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M7850,-131.9C7850,-123.91 7850,-115.14 7850,-106.4"/>
<polygon fill="black" stroke="black" points="7853.5,-106.19 7850,-96.19 7846.5,-106.19 7853.5,-106.19"/>
</g>
</g>
</svg>
