<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Llama_405B_Baseline_TP Pages: 1 -->
<svg width="2160pt" height="1073pt"
 viewBox="0.00 0.00 2160.00 1072.82" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.46 0.46) rotate(0) translate(4 2343.09)">
<title>Llama_405B_Baseline_TP</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2343.09 4721.6,-2343.09 4721.6,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="2196" cy="-2291.01" rx="306.77" ry="48.17"/>
<text text-anchor="middle" x="2196" y="-2309.81" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="2196" y="-2294.81" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="2196" y="-2279.81" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="2196" y="-2264.81" font-family="Times,serif" font-size="14.00">Device: CPU</text>
</g>
<!-- split_all_gpus -->
<g id="node2" class="node">
<title>split_all_gpus</title>
<polygon fill="yellow" stroke="black" points="2645.9,-2206.93 1930.21,-2206.93 1746.1,-2070.93 2461.79,-2070.93 2645.9,-2206.93"/>
<text text-anchor="middle" x="2196" y="-2157.73" font-family="Times,serif" font-size="14.00">Split Input</text>
<text text-anchor="middle" x="2196" y="-2142.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="2196" y="-2127.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="2196" y="-2112.73" font-family="Times,serif" font-size="14.00">Device: all GPUs</text>
</g>
<!-- input&#45;&gt;split_all_gpus -->
<g id="edge1" class="edge">
<title>input&#45;&gt;split_all_gpus</title>
<path fill="none" stroke="black" d="M2196,-2242.52C2196,-2234.44 2196,-2225.85 2196,-2217.23"/>
<polygon fill="black" stroke="black" points="2199.5,-2217.12 2196,-2207.12 2192.5,-2217.12 2199.5,-2217.12"/>
</g>
<!-- qkv_proj_gpu_0 -->
<g id="node3" class="node">
<title>qkv_proj_gpu_0</title>
<polygon fill="lightcoral" stroke="black" points="472,-2034.93 0,-2034.93 0,-1936.93 472,-1936.93 472,-2034.93"/>
<text text-anchor="middle" x="236" y="-2019.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="236" y="-2004.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="236" y="-1989.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="236" y="-1974.73" font-family="Times,serif" font-size="14.00">Device: gpu_0</text>
<text text-anchor="middle" x="236" y="-1959.73" font-family="Times,serif" font-size="14.00">Columns: 0&#45;2047</text>
<text text-anchor="middle" x="236" y="-1944.73" font-family="Times,serif" font-size="14.00">Queries: 0&#45;15, KV: 0&#45;0</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_0 -->
<g id="edge2" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_0</title>
<path fill="none" stroke="black" d="M1825.84,-2129.95C1480.06,-2119.16 949.79,-2094.05 482.24,-2035.04"/>
<polygon fill="black" stroke="black" points="482.61,-2031.56 472.24,-2033.78 481.72,-2038.51 482.61,-2031.56"/>
</g>
<!-- qkv_proj_gpu_1 -->
<g id="node4" class="node">
<title>qkv_proj_gpu_1</title>
<polygon fill="lightcoral" stroke="black" points="962,-2034.93 490,-2034.93 490,-1936.93 962,-1936.93 962,-2034.93"/>
<text text-anchor="middle" x="726" y="-2019.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="726" y="-2004.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="726" y="-1989.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="726" y="-1974.73" font-family="Times,serif" font-size="14.00">Device: gpu_1</text>
<text text-anchor="middle" x="726" y="-1959.73" font-family="Times,serif" font-size="14.00">Columns: 2048&#45;4095</text>
<text text-anchor="middle" x="726" y="-1944.73" font-family="Times,serif" font-size="14.00">Queries: 16&#45;31, KV: 1&#45;1</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_1 -->
<g id="edge5" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_1</title>
<path fill="none" stroke="black" d="M1807.21,-2116.16C1568.61,-2100.13 1256.89,-2074.41 972.37,-2035.08"/>
<polygon fill="black" stroke="black" points="972.64,-2031.59 962.26,-2033.68 971.68,-2038.52 972.64,-2031.59"/>
</g>
<!-- qkv_proj_gpu_2 -->
<g id="node5" class="node">
<title>qkv_proj_gpu_2</title>
<polygon fill="lightcoral" stroke="black" points="1452,-2034.93 980,-2034.93 980,-1936.93 1452,-1936.93 1452,-2034.93"/>
<text text-anchor="middle" x="1216" y="-2019.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1216" y="-2004.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="1216" y="-1989.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="1216" y="-1974.73" font-family="Times,serif" font-size="14.00">Device: gpu_2</text>
<text text-anchor="middle" x="1216" y="-1959.73" font-family="Times,serif" font-size="14.00">Columns: 4096&#45;6143</text>
<text text-anchor="middle" x="1216" y="-1944.73" font-family="Times,serif" font-size="14.00">Queries: 32&#45;47, KV: 2&#45;2</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_2 -->
<g id="edge8" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_2</title>
<path fill="none" stroke="black" d="M1759.14,-2080.68C1664.07,-2067.15 1563.93,-2052.09 1462.44,-2035.15"/>
<polygon fill="black" stroke="black" points="1462.73,-2031.65 1452.29,-2033.45 1461.58,-2038.55 1462.73,-2031.65"/>
</g>
<!-- qkv_proj_gpu_3 -->
<g id="node6" class="node">
<title>qkv_proj_gpu_3</title>
<polygon fill="lightcoral" stroke="black" points="1942,-2034.93 1470,-2034.93 1470,-1936.93 1942,-1936.93 1942,-2034.93"/>
<text text-anchor="middle" x="1706" y="-2019.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1706" y="-2004.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="1706" y="-1989.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="1706" y="-1974.73" font-family="Times,serif" font-size="14.00">Device: gpu_3</text>
<text text-anchor="middle" x="1706" y="-1959.73" font-family="Times,serif" font-size="14.00">Columns: 6144&#45;8191</text>
<text text-anchor="middle" x="1706" y="-1944.73" font-family="Times,serif" font-size="14.00">Queries: 48&#45;63, KV: 3&#45;3</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_3 -->
<g id="edge11" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_3</title>
<path fill="none" stroke="black" d="M1978.58,-2070.93C1942.69,-2059.87 1906,-2048.56 1871.65,-2037.97"/>
<polygon fill="black" stroke="black" points="1872.61,-2034.61 1862.02,-2035.01 1870.55,-2041.3 1872.61,-2034.61"/>
</g>
<!-- qkv_proj_gpu_4 -->
<g id="node7" class="node">
<title>qkv_proj_gpu_4</title>
<polygon fill="lightcoral" stroke="black" points="2432,-2034.93 1960,-2034.93 1960,-1936.93 2432,-1936.93 2432,-2034.93"/>
<text text-anchor="middle" x="2196" y="-2019.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2196" y="-2004.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="2196" y="-1989.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="2196" y="-1974.73" font-family="Times,serif" font-size="14.00">Device: gpu_4</text>
<text text-anchor="middle" x="2196" y="-1959.73" font-family="Times,serif" font-size="14.00">Columns: 8192&#45;10239</text>
<text text-anchor="middle" x="2196" y="-1944.73" font-family="Times,serif" font-size="14.00">Queries: 64&#45;79, KV: 4&#45;4</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_4 -->
<g id="edge14" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_4</title>
<path fill="none" stroke="black" d="M2196,-2070.82C2196,-2062.3 2196,-2053.65 2196,-2045.29"/>
<polygon fill="black" stroke="black" points="2199.5,-2045.27 2196,-2035.27 2192.5,-2045.27 2199.5,-2045.27"/>
</g>
<!-- qkv_proj_gpu_5 -->
<g id="node8" class="node">
<title>qkv_proj_gpu_5</title>
<polygon fill="lightcoral" stroke="black" points="2922,-2034.93 2450,-2034.93 2450,-1936.93 2922,-1936.93 2922,-2034.93"/>
<text text-anchor="middle" x="2686" y="-2019.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2686" y="-2004.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="2686" y="-1989.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="2686" y="-1974.73" font-family="Times,serif" font-size="14.00">Device: gpu_5</text>
<text text-anchor="middle" x="2686" y="-1959.73" font-family="Times,serif" font-size="14.00">Columns: 10240&#45;12287</text>
<text text-anchor="middle" x="2686" y="-1944.73" font-family="Times,serif" font-size="14.00">Queries: 80&#45;95, KV: 5&#45;5</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_5 -->
<g id="edge17" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_5</title>
<path fill="none" stroke="black" d="M2413.42,-2070.93C2449.31,-2059.87 2486,-2048.56 2520.35,-2037.97"/>
<polygon fill="black" stroke="black" points="2521.45,-2041.3 2529.98,-2035.01 2519.39,-2034.61 2521.45,-2041.3"/>
</g>
<!-- qkv_proj_gpu_6 -->
<g id="node9" class="node">
<title>qkv_proj_gpu_6</title>
<polygon fill="lightcoral" stroke="black" points="3412,-2034.93 2940,-2034.93 2940,-1936.93 3412,-1936.93 3412,-2034.93"/>
<text text-anchor="middle" x="3176" y="-2019.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3176" y="-2004.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="3176" y="-1989.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="3176" y="-1974.73" font-family="Times,serif" font-size="14.00">Device: gpu_6</text>
<text text-anchor="middle" x="3176" y="-1959.73" font-family="Times,serif" font-size="14.00">Columns: 12288&#45;14335</text>
<text text-anchor="middle" x="3176" y="-1944.73" font-family="Times,serif" font-size="14.00">Queries: 96&#45;111, KV: 6&#45;6</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_6 -->
<g id="edge20" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_6</title>
<path fill="none" stroke="black" d="M2500.08,-2099.08C2629.7,-2081.57 2782.75,-2059.64 2929.6,-2035.14"/>
<polygon fill="black" stroke="black" points="2930.42,-2038.55 2939.71,-2033.45 2929.27,-2031.65 2930.42,-2038.55"/>
</g>
<!-- qkv_proj_gpu_7 -->
<g id="node10" class="node">
<title>qkv_proj_gpu_7</title>
<polygon fill="lightcoral" stroke="black" points="3902,-2034.93 3430,-2034.93 3430,-1936.93 3902,-1936.93 3902,-2034.93"/>
<text text-anchor="middle" x="3666" y="-2019.73" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3666" y="-2004.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="3666" y="-1989.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="3666" y="-1974.73" font-family="Times,serif" font-size="14.00">Device: gpu_7</text>
<text text-anchor="middle" x="3666" y="-1959.73" font-family="Times,serif" font-size="14.00">Columns: 14336&#45;16383</text>
<text text-anchor="middle" x="3666" y="-1944.73" font-family="Times,serif" font-size="14.00">Queries: 112&#45;127, KV: 7&#45;7</text>
</g>
<!-- split_all_gpus&#45;&gt;qkv_proj_gpu_7 -->
<g id="edge23" class="edge">
<title>split_all_gpus&#45;&gt;qkv_proj_gpu_7</title>
<path fill="none" stroke="black" d="M2528.22,-2119.87C2772.6,-2104.22 3112.79,-2077.49 3419.75,-2035.07"/>
<polygon fill="black" stroke="black" points="3420.32,-2038.52 3429.74,-2033.68 3419.36,-2031.59 3420.32,-2038.52"/>
</g>
<!-- residual_attn -->
<g id="node37" class="node">
<title>residual_attn</title>
<ellipse fill="lightgreen" stroke="black" cx="3145" cy="-1096.24" rx="306.77" ry="58.88"/>
<text text-anchor="middle" x="3145" y="-1122.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3145" y="-1107.54" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3145" y="-1092.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="3145" y="-1077.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="3145" y="-1062.54" font-family="Times,serif" font-size="14.00">Device: all GPUs</text>
</g>
<!-- split_all_gpus&#45;&gt;residual_attn -->
<g id="edge51" class="edge">
<title>split_all_gpus&#45;&gt;residual_attn</title>
<path fill="none" stroke="black" d="M2540.03,-2128.53C3026.5,-2113.63 3862.18,-2081.44 3911,-2034.93 3967.48,-1981.11 3930,-1938.44 3930,-1860.43 3930,-1860.43 3930,-1860.43 3930,-1433.43 3930,-1307.82 3586.1,-1201.21 3353.55,-1143.47"/>
<polygon fill="black" stroke="black" points="3354.14,-1140.01 3343.6,-1141.01 3352.46,-1146.81 3354.14,-1140.01"/>
</g>
<!-- kv_cache_gpu_0 -->
<g id="node11" class="node">
<title>kv_cache_gpu_0</title>
<polygon fill="lightpink" stroke="black" points="467.5,-1900.93 4.5,-1900.93 4.5,-1817.93 467.5,-1817.93 467.5,-1900.93"/>
<text text-anchor="middle" x="236" y="-1885.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="236" y="-1870.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="236" y="-1855.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="236" y="-1840.73" font-family="Times,serif" font-size="14.00">Device: gpu_0</text>
<text text-anchor="middle" x="236" y="-1825.73" font-family="Times,serif" font-size="14.00">DUPLICATED ACROSS GPUS</text>
</g>
<!-- qkv_proj_gpu_0&#45;&gt;kv_cache_gpu_0 -->
<g id="edge3" class="edge">
<title>qkv_proj_gpu_0&#45;&gt;kv_cache_gpu_0</title>
<path fill="none" stroke="black" d="M236,-1936.79C236,-1928.42 236,-1919.7 236,-1911.26"/>
<polygon fill="black" stroke="black" points="239.5,-1911.16 236,-1901.16 232.5,-1911.16 239.5,-1911.16"/>
</g>
<!-- kv_cache_gpu_1 -->
<g id="node12" class="node">
<title>kv_cache_gpu_1</title>
<polygon fill="lightpink" stroke="black" points="957.5,-1900.93 494.5,-1900.93 494.5,-1817.93 957.5,-1817.93 957.5,-1900.93"/>
<text text-anchor="middle" x="726" y="-1885.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="726" y="-1870.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="726" y="-1855.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="726" y="-1840.73" font-family="Times,serif" font-size="14.00">Device: gpu_1</text>
<text text-anchor="middle" x="726" y="-1825.73" font-family="Times,serif" font-size="14.00">DUPLICATED ACROSS GPUS</text>
</g>
<!-- qkv_proj_gpu_1&#45;&gt;kv_cache_gpu_1 -->
<g id="edge6" class="edge">
<title>qkv_proj_gpu_1&#45;&gt;kv_cache_gpu_1</title>
<path fill="none" stroke="black" d="M726,-1936.79C726,-1928.42 726,-1919.7 726,-1911.26"/>
<polygon fill="black" stroke="black" points="729.5,-1911.16 726,-1901.16 722.5,-1911.16 729.5,-1911.16"/>
</g>
<!-- kv_cache_gpu_2 -->
<g id="node13" class="node">
<title>kv_cache_gpu_2</title>
<polygon fill="lightpink" stroke="black" points="1447.5,-1900.93 984.5,-1900.93 984.5,-1817.93 1447.5,-1817.93 1447.5,-1900.93"/>
<text text-anchor="middle" x="1216" y="-1885.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="1216" y="-1870.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="1216" y="-1855.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="1216" y="-1840.73" font-family="Times,serif" font-size="14.00">Device: gpu_2</text>
<text text-anchor="middle" x="1216" y="-1825.73" font-family="Times,serif" font-size="14.00">DUPLICATED ACROSS GPUS</text>
</g>
<!-- qkv_proj_gpu_2&#45;&gt;kv_cache_gpu_2 -->
<g id="edge9" class="edge">
<title>qkv_proj_gpu_2&#45;&gt;kv_cache_gpu_2</title>
<path fill="none" stroke="black" d="M1216,-1936.79C1216,-1928.42 1216,-1919.7 1216,-1911.26"/>
<polygon fill="black" stroke="black" points="1219.5,-1911.16 1216,-1901.16 1212.5,-1911.16 1219.5,-1911.16"/>
</g>
<!-- kv_cache_gpu_3 -->
<g id="node14" class="node">
<title>kv_cache_gpu_3</title>
<polygon fill="lightpink" stroke="black" points="1937.5,-1900.93 1474.5,-1900.93 1474.5,-1817.93 1937.5,-1817.93 1937.5,-1900.93"/>
<text text-anchor="middle" x="1706" y="-1885.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="1706" y="-1870.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="1706" y="-1855.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="1706" y="-1840.73" font-family="Times,serif" font-size="14.00">Device: gpu_3</text>
<text text-anchor="middle" x="1706" y="-1825.73" font-family="Times,serif" font-size="14.00">DUPLICATED ACROSS GPUS</text>
</g>
<!-- qkv_proj_gpu_3&#45;&gt;kv_cache_gpu_3 -->
<g id="edge12" class="edge">
<title>qkv_proj_gpu_3&#45;&gt;kv_cache_gpu_3</title>
<path fill="none" stroke="black" d="M1706,-1936.79C1706,-1928.42 1706,-1919.7 1706,-1911.26"/>
<polygon fill="black" stroke="black" points="1709.5,-1911.16 1706,-1901.16 1702.5,-1911.16 1709.5,-1911.16"/>
</g>
<!-- kv_cache_gpu_4 -->
<g id="node15" class="node">
<title>kv_cache_gpu_4</title>
<polygon fill="lightpink" stroke="black" points="2427.5,-1900.93 1964.5,-1900.93 1964.5,-1817.93 2427.5,-1817.93 2427.5,-1900.93"/>
<text text-anchor="middle" x="2196" y="-1885.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="2196" y="-1870.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="2196" y="-1855.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="2196" y="-1840.73" font-family="Times,serif" font-size="14.00">Device: gpu_4</text>
<text text-anchor="middle" x="2196" y="-1825.73" font-family="Times,serif" font-size="14.00">DUPLICATED ACROSS GPUS</text>
</g>
<!-- qkv_proj_gpu_4&#45;&gt;kv_cache_gpu_4 -->
<g id="edge15" class="edge">
<title>qkv_proj_gpu_4&#45;&gt;kv_cache_gpu_4</title>
<path fill="none" stroke="black" d="M2196,-1936.79C2196,-1928.42 2196,-1919.7 2196,-1911.26"/>
<polygon fill="black" stroke="black" points="2199.5,-1911.16 2196,-1901.16 2192.5,-1911.16 2199.5,-1911.16"/>
</g>
<!-- kv_cache_gpu_5 -->
<g id="node16" class="node">
<title>kv_cache_gpu_5</title>
<polygon fill="lightpink" stroke="black" points="2917.5,-1900.93 2454.5,-1900.93 2454.5,-1817.93 2917.5,-1817.93 2917.5,-1900.93"/>
<text text-anchor="middle" x="2686" y="-1885.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="2686" y="-1870.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="2686" y="-1855.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="2686" y="-1840.73" font-family="Times,serif" font-size="14.00">Device: gpu_5</text>
<text text-anchor="middle" x="2686" y="-1825.73" font-family="Times,serif" font-size="14.00">DUPLICATED ACROSS GPUS</text>
</g>
<!-- qkv_proj_gpu_5&#45;&gt;kv_cache_gpu_5 -->
<g id="edge18" class="edge">
<title>qkv_proj_gpu_5&#45;&gt;kv_cache_gpu_5</title>
<path fill="none" stroke="black" d="M2686,-1936.79C2686,-1928.42 2686,-1919.7 2686,-1911.26"/>
<polygon fill="black" stroke="black" points="2689.5,-1911.16 2686,-1901.16 2682.5,-1911.16 2689.5,-1911.16"/>
</g>
<!-- kv_cache_gpu_6 -->
<g id="node17" class="node">
<title>kv_cache_gpu_6</title>
<polygon fill="lightpink" stroke="black" points="3407.5,-1900.93 2944.5,-1900.93 2944.5,-1817.93 3407.5,-1817.93 3407.5,-1900.93"/>
<text text-anchor="middle" x="3176" y="-1885.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="3176" y="-1870.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="3176" y="-1855.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="3176" y="-1840.73" font-family="Times,serif" font-size="14.00">Device: gpu_6</text>
<text text-anchor="middle" x="3176" y="-1825.73" font-family="Times,serif" font-size="14.00">DUPLICATED ACROSS GPUS</text>
</g>
<!-- qkv_proj_gpu_6&#45;&gt;kv_cache_gpu_6 -->
<g id="edge21" class="edge">
<title>qkv_proj_gpu_6&#45;&gt;kv_cache_gpu_6</title>
<path fill="none" stroke="black" d="M3176,-1936.79C3176,-1928.42 3176,-1919.7 3176,-1911.26"/>
<polygon fill="black" stroke="black" points="3179.5,-1911.16 3176,-1901.16 3172.5,-1911.16 3179.5,-1911.16"/>
</g>
<!-- kv_cache_gpu_7 -->
<g id="node18" class="node">
<title>kv_cache_gpu_7</title>
<polygon fill="lightpink" stroke="black" points="3897.5,-1900.93 3434.5,-1900.93 3434.5,-1817.93 3897.5,-1817.93 3897.5,-1900.93"/>
<text text-anchor="middle" x="3666" y="-1885.73" font-family="Times,serif" font-size="14.00">KV Cache</text>
<text text-anchor="middle" x="3666" y="-1870.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="3666" y="-1855.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=8, d_k=128]</text>
<text text-anchor="middle" x="3666" y="-1840.73" font-family="Times,serif" font-size="14.00">Device: gpu_7</text>
<text text-anchor="middle" x="3666" y="-1825.73" font-family="Times,serif" font-size="14.00">DUPLICATED ACROSS GPUS</text>
</g>
<!-- qkv_proj_gpu_7&#45;&gt;kv_cache_gpu_7 -->
<g id="edge24" class="edge">
<title>qkv_proj_gpu_7&#45;&gt;kv_cache_gpu_7</title>
<path fill="none" stroke="black" d="M3666,-1936.79C3666,-1928.42 3666,-1919.7 3666,-1911.26"/>
<polygon fill="black" stroke="black" points="3669.5,-1911.16 3666,-1901.16 3662.5,-1911.16 3669.5,-1911.16"/>
</g>
<!-- flash_attn_gpu_0 -->
<g id="node19" class="node">
<title>flash_attn_gpu_0</title>
<polygon fill="lightblue" stroke="black" points="472,-1781.93 0,-1781.93 0,-1713.93 472,-1713.93 472,-1781.93"/>
<text text-anchor="middle" x="236" y="-1766.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="236" y="-1751.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="236" y="-1736.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="236" y="-1721.73" font-family="Times,serif" font-size="14.00">Device: gpu_0</text>
</g>
<!-- kv_cache_gpu_0&#45;&gt;flash_attn_gpu_0 -->
<g id="edge4" class="edge">
<title>kv_cache_gpu_0&#45;&gt;flash_attn_gpu_0</title>
<path fill="none" stroke="black" d="M236,-1817.65C236,-1809.44 236,-1800.79 236,-1792.49"/>
<polygon fill="black" stroke="black" points="239.5,-1792.23 236,-1782.23 232.5,-1792.23 239.5,-1792.23"/>
</g>
<!-- flash_attn_gpu_1 -->
<g id="node20" class="node">
<title>flash_attn_gpu_1</title>
<polygon fill="lightblue" stroke="black" points="962,-1781.93 490,-1781.93 490,-1713.93 962,-1713.93 962,-1781.93"/>
<text text-anchor="middle" x="726" y="-1766.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="726" y="-1751.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="726" y="-1736.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="726" y="-1721.73" font-family="Times,serif" font-size="14.00">Device: gpu_1</text>
</g>
<!-- kv_cache_gpu_1&#45;&gt;flash_attn_gpu_1 -->
<g id="edge7" class="edge">
<title>kv_cache_gpu_1&#45;&gt;flash_attn_gpu_1</title>
<path fill="none" stroke="black" d="M726,-1817.65C726,-1809.44 726,-1800.79 726,-1792.49"/>
<polygon fill="black" stroke="black" points="729.5,-1792.23 726,-1782.23 722.5,-1792.23 729.5,-1792.23"/>
</g>
<!-- flash_attn_gpu_2 -->
<g id="node21" class="node">
<title>flash_attn_gpu_2</title>
<polygon fill="lightblue" stroke="black" points="1452,-1781.93 980,-1781.93 980,-1713.93 1452,-1713.93 1452,-1781.93"/>
<text text-anchor="middle" x="1216" y="-1766.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="1216" y="-1751.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="1216" y="-1736.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="1216" y="-1721.73" font-family="Times,serif" font-size="14.00">Device: gpu_2</text>
</g>
<!-- kv_cache_gpu_2&#45;&gt;flash_attn_gpu_2 -->
<g id="edge10" class="edge">
<title>kv_cache_gpu_2&#45;&gt;flash_attn_gpu_2</title>
<path fill="none" stroke="black" d="M1216,-1817.65C1216,-1809.44 1216,-1800.79 1216,-1792.49"/>
<polygon fill="black" stroke="black" points="1219.5,-1792.23 1216,-1782.23 1212.5,-1792.23 1219.5,-1792.23"/>
</g>
<!-- flash_attn_gpu_3 -->
<g id="node22" class="node">
<title>flash_attn_gpu_3</title>
<polygon fill="lightblue" stroke="black" points="1942,-1781.93 1470,-1781.93 1470,-1713.93 1942,-1713.93 1942,-1781.93"/>
<text text-anchor="middle" x="1706" y="-1766.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="1706" y="-1751.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="1706" y="-1736.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="1706" y="-1721.73" font-family="Times,serif" font-size="14.00">Device: gpu_3</text>
</g>
<!-- kv_cache_gpu_3&#45;&gt;flash_attn_gpu_3 -->
<g id="edge13" class="edge">
<title>kv_cache_gpu_3&#45;&gt;flash_attn_gpu_3</title>
<path fill="none" stroke="black" d="M1706,-1817.65C1706,-1809.44 1706,-1800.79 1706,-1792.49"/>
<polygon fill="black" stroke="black" points="1709.5,-1792.23 1706,-1782.23 1702.5,-1792.23 1709.5,-1792.23"/>
</g>
<!-- flash_attn_gpu_4 -->
<g id="node23" class="node">
<title>flash_attn_gpu_4</title>
<polygon fill="lightblue" stroke="black" points="2432,-1781.93 1960,-1781.93 1960,-1713.93 2432,-1713.93 2432,-1781.93"/>
<text text-anchor="middle" x="2196" y="-1766.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="2196" y="-1751.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="2196" y="-1736.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="2196" y="-1721.73" font-family="Times,serif" font-size="14.00">Device: gpu_4</text>
</g>
<!-- kv_cache_gpu_4&#45;&gt;flash_attn_gpu_4 -->
<g id="edge16" class="edge">
<title>kv_cache_gpu_4&#45;&gt;flash_attn_gpu_4</title>
<path fill="none" stroke="black" d="M2196,-1817.65C2196,-1809.44 2196,-1800.79 2196,-1792.49"/>
<polygon fill="black" stroke="black" points="2199.5,-1792.23 2196,-1782.23 2192.5,-1792.23 2199.5,-1792.23"/>
</g>
<!-- flash_attn_gpu_5 -->
<g id="node24" class="node">
<title>flash_attn_gpu_5</title>
<polygon fill="lightblue" stroke="black" points="2922,-1781.93 2450,-1781.93 2450,-1713.93 2922,-1713.93 2922,-1781.93"/>
<text text-anchor="middle" x="2686" y="-1766.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="2686" y="-1751.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="2686" y="-1736.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="2686" y="-1721.73" font-family="Times,serif" font-size="14.00">Device: gpu_5</text>
</g>
<!-- kv_cache_gpu_5&#45;&gt;flash_attn_gpu_5 -->
<g id="edge19" class="edge">
<title>kv_cache_gpu_5&#45;&gt;flash_attn_gpu_5</title>
<path fill="none" stroke="black" d="M2686,-1817.65C2686,-1809.44 2686,-1800.79 2686,-1792.49"/>
<polygon fill="black" stroke="black" points="2689.5,-1792.23 2686,-1782.23 2682.5,-1792.23 2689.5,-1792.23"/>
</g>
<!-- flash_attn_gpu_6 -->
<g id="node25" class="node">
<title>flash_attn_gpu_6</title>
<polygon fill="lightblue" stroke="black" points="3412,-1781.93 2940,-1781.93 2940,-1713.93 3412,-1713.93 3412,-1781.93"/>
<text text-anchor="middle" x="3176" y="-1766.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="3176" y="-1751.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="3176" y="-1736.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="3176" y="-1721.73" font-family="Times,serif" font-size="14.00">Device: gpu_6</text>
</g>
<!-- kv_cache_gpu_6&#45;&gt;flash_attn_gpu_6 -->
<g id="edge22" class="edge">
<title>kv_cache_gpu_6&#45;&gt;flash_attn_gpu_6</title>
<path fill="none" stroke="black" d="M3176,-1817.65C3176,-1809.44 3176,-1800.79 3176,-1792.49"/>
<polygon fill="black" stroke="black" points="3179.5,-1792.23 3176,-1782.23 3172.5,-1792.23 3179.5,-1792.23"/>
</g>
<!-- flash_attn_gpu_7 -->
<g id="node26" class="node">
<title>flash_attn_gpu_7</title>
<polygon fill="lightblue" stroke="black" points="3902,-1781.93 3430,-1781.93 3430,-1713.93 3902,-1713.93 3902,-1781.93"/>
<text text-anchor="middle" x="3666" y="-1766.73" font-family="Times,serif" font-size="14.00">FlashAttention</text>
<text text-anchor="middle" x="3666" y="-1751.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="3666" y="-1736.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=16, d_k=128]</text>
<text text-anchor="middle" x="3666" y="-1721.73" font-family="Times,serif" font-size="14.00">Device: gpu_7</text>
</g>
<!-- kv_cache_gpu_7&#45;&gt;flash_attn_gpu_7 -->
<g id="edge25" class="edge">
<title>kv_cache_gpu_7&#45;&gt;flash_attn_gpu_7</title>
<path fill="none" stroke="black" d="M3666,-1817.65C3666,-1809.44 3666,-1800.79 3666,-1792.49"/>
<polygon fill="black" stroke="black" points="3669.5,-1792.23 3666,-1782.23 3662.5,-1792.23 3669.5,-1792.23"/>
</g>
<!-- attn_all_reduce -->
<g id="node27" class="node">
<title>attn_all_reduce</title>
<polygon fill="yellow" stroke="black" points="2554.86,-1677.93 1761.29,-1677.93 1557.14,-1511.93 2350.71,-1511.93 2554.86,-1677.93"/>
<text text-anchor="middle" x="2056" y="-1621.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="2056" y="-1606.23" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="2056" y="-1591.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, heads=128, d_k=128]</text>
<text text-anchor="middle" x="2056" y="-1576.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, heads=128, d_k=128]</text>
<text text-anchor="middle" x="2056" y="-1561.23" font-family="Times,serif" font-size="14.00">Device: all GPUs</text>
</g>
<!-- flash_attn_gpu_0&#45;&gt;attn_all_reduce -->
<g id="edge26" class="edge">
<title>flash_attn_gpu_0&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M472.3,-1714.85C475.22,-1714.54 478.12,-1714.23 481,-1713.93 888.54,-1671.25 1356.98,-1638.19 1676.34,-1618.06"/>
<polygon fill="black" stroke="black" points="1676.93,-1621.53 1686.7,-1617.41 1676.5,-1614.54 1676.93,-1621.53"/>
</g>
<!-- flash_attn_gpu_1&#45;&gt;attn_all_reduce -->
<g id="edge29" class="edge">
<title>flash_attn_gpu_1&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M962.32,-1714.99C965.23,-1714.63 968.12,-1714.28 971,-1713.93 1211.93,-1684.6 1483.4,-1655.08 1694.52,-1632.9"/>
<polygon fill="black" stroke="black" points="1694.95,-1636.38 1704.53,-1631.85 1694.22,-1629.42 1694.95,-1636.38"/>
</g>
<!-- flash_attn_gpu_2&#45;&gt;attn_all_reduce -->
<g id="edge32" class="edge">
<title>flash_attn_gpu_2&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M1399.82,-1713.88C1494.15,-1696.93 1612.02,-1675.74 1721.74,-1656.01"/>
<polygon fill="black" stroke="black" points="1722.43,-1659.45 1731.65,-1654.23 1721.19,-1652.56 1722.43,-1659.45"/>
</g>
<!-- flash_attn_gpu_3&#45;&gt;attn_all_reduce -->
<g id="edge35" class="edge">
<title>flash_attn_gpu_3&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M1782.81,-1713.79C1805.04,-1704.2 1830.4,-1693.26 1856.49,-1682"/>
<polygon fill="black" stroke="black" points="1857.96,-1685.18 1865.75,-1678 1855.18,-1678.75 1857.96,-1685.18"/>
</g>
<!-- flash_attn_gpu_4&#45;&gt;attn_all_reduce -->
<g id="edge38" class="edge">
<title>flash_attn_gpu_4&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M2165.28,-1713.79C2157.31,-1705.2 2148.34,-1695.52 2139.05,-1685.5"/>
<polygon fill="black" stroke="black" points="2141.61,-1683.11 2132.24,-1678.16 2136.47,-1687.87 2141.61,-1683.11"/>
</g>
<!-- flash_attn_gpu_5&#45;&gt;attn_all_reduce -->
<g id="edge41" class="edge">
<title>flash_attn_gpu_5&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M2548.13,-1713.88C2506.04,-1703.79 2457.68,-1692.2 2408.09,-1680.32"/>
<polygon fill="black" stroke="black" points="2408.69,-1676.86 2398.15,-1677.93 2407.06,-1683.67 2408.69,-1676.86"/>
</g>
<!-- flash_attn_gpu_6&#45;&gt;attn_all_reduce -->
<g id="edge44" class="edge">
<title>flash_attn_gpu_6&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M2939.85,-1715.09C2824.4,-1699.52 2680.99,-1680.19 2543.5,-1661.65"/>
<polygon fill="black" stroke="black" points="2543.57,-1658.13 2533.19,-1660.26 2542.64,-1665.07 2543.57,-1658.13"/>
</g>
<!-- flash_attn_gpu_7&#45;&gt;attn_all_reduce -->
<g id="edge47" class="edge">
<title>flash_attn_gpu_7&#45;&gt;attn_all_reduce</title>
<path fill="none" stroke="black" d="M3429.69,-1714.9C3426.78,-1714.57 3423.88,-1714.24 3421,-1713.93 3115.65,-1680.18 2770.98,-1650.45 2504.38,-1629.28"/>
<polygon fill="black" stroke="black" points="2504.38,-1625.77 2494.14,-1628.46 2503.83,-1632.74 2504.38,-1625.77"/>
</g>
<!-- attn_out_gpu_0 -->
<g id="node28" class="node">
<title>attn_out_gpu_0</title>
<polygon fill="lightcoral" stroke="black" points="800.5,-1475.93 375.5,-1475.93 375.5,-1392.93 800.5,-1392.93 800.5,-1475.93"/>
<text text-anchor="middle" x="588" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="588" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="588" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="588" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_0</text>
<text text-anchor="middle" x="588" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 0&#45;2047</text>
</g>
<!-- attn_all_reduce&#45;&gt;attn_out_gpu_0 -->
<g id="edge27" class="edge">
<title>attn_all_reduce&#45;&gt;attn_out_gpu_0</title>
<path fill="none" stroke="black" d="M1618.49,-1561.88C1381.76,-1542.23 1084.26,-1513.78 810.68,-1476.13"/>
<polygon fill="black" stroke="black" points="810.93,-1472.63 800.54,-1474.73 809.97,-1479.57 810.93,-1472.63"/>
</g>
<!-- attn_out_gpu_1 -->
<g id="node29" class="node">
<title>attn_out_gpu_1</title>
<polygon fill="lightcoral" stroke="black" points="1243.5,-1475.93 818.5,-1475.93 818.5,-1392.93 1243.5,-1392.93 1243.5,-1475.93"/>
<text text-anchor="middle" x="1031" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1031" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="1031" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="1031" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_1</text>
<text text-anchor="middle" x="1031" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 2048&#45;4095</text>
</g>
<!-- attn_all_reduce&#45;&gt;attn_out_gpu_1 -->
<g id="edge30" class="edge">
<title>attn_all_reduce&#45;&gt;attn_out_gpu_1</title>
<path fill="none" stroke="black" d="M1574.35,-1526.08C1471.19,-1510.78 1362.69,-1494.11 1253.47,-1476.16"/>
<polygon fill="black" stroke="black" points="1254.01,-1472.7 1243.57,-1474.53 1252.87,-1479.61 1254.01,-1472.7"/>
</g>
<!-- attn_out_gpu_2 -->
<g id="node30" class="node">
<title>attn_out_gpu_2</title>
<polygon fill="lightcoral" stroke="black" points="1686.5,-1475.93 1261.5,-1475.93 1261.5,-1392.93 1686.5,-1392.93 1686.5,-1475.93"/>
<text text-anchor="middle" x="1474" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1474" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="1474" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="1474" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_2</text>
<text text-anchor="middle" x="1474" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 4096&#45;6143</text>
</g>
<!-- attn_all_reduce&#45;&gt;attn_out_gpu_2 -->
<g id="edge33" class="edge">
<title>attn_all_reduce&#45;&gt;attn_out_gpu_2</title>
<path fill="none" stroke="black" d="M1754.77,-1511.89C1712.76,-1500.45 1671.03,-1489.09 1633.1,-1478.75"/>
<polygon fill="black" stroke="black" points="1633.59,-1475.26 1623.02,-1476.01 1631.75,-1482.02 1633.59,-1475.26"/>
</g>
<!-- attn_out_gpu_3 -->
<g id="node31" class="node">
<title>attn_out_gpu_3</title>
<polygon fill="lightcoral" stroke="black" points="2129.5,-1475.93 1704.5,-1475.93 1704.5,-1392.93 2129.5,-1392.93 2129.5,-1475.93"/>
<text text-anchor="middle" x="1917" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1917" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="1917" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="1917" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_3</text>
<text text-anchor="middle" x="1917" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 6144&#45;8191</text>
</g>
<!-- attn_all_reduce&#45;&gt;attn_out_gpu_3 -->
<g id="edge36" class="edge">
<title>attn_all_reduce&#45;&gt;attn_out_gpu_3</title>
<path fill="none" stroke="black" d="M1984.06,-1511.89C1975.65,-1502.31 1967.3,-1492.78 1959.48,-1483.87"/>
<polygon fill="black" stroke="black" points="1961.99,-1481.42 1952.77,-1476.21 1956.73,-1486.04 1961.99,-1481.42"/>
</g>
<!-- attn_out_gpu_4 -->
<g id="node32" class="node">
<title>attn_out_gpu_4</title>
<polygon fill="lightcoral" stroke="black" points="2572.5,-1475.93 2147.5,-1475.93 2147.5,-1392.93 2572.5,-1392.93 2572.5,-1475.93"/>
<text text-anchor="middle" x="2360" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="2360" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="2360" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="2360" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_4</text>
<text text-anchor="middle" x="2360" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 8192&#45;10239</text>
</g>
<!-- attn_all_reduce&#45;&gt;attn_out_gpu_4 -->
<g id="edge39" class="edge">
<title>attn_all_reduce&#45;&gt;attn_out_gpu_4</title>
<path fill="none" stroke="black" d="M2213.34,-1511.89C2233.89,-1501.18 2254.3,-1490.54 2273.08,-1480.75"/>
<polygon fill="black" stroke="black" points="2274.91,-1483.74 2282.16,-1476.01 2271.67,-1477.53 2274.91,-1483.74"/>
</g>
<!-- attn_out_gpu_5 -->
<g id="node33" class="node">
<title>attn_out_gpu_5</title>
<polygon fill="lightcoral" stroke="black" points="3015.5,-1475.93 2590.5,-1475.93 2590.5,-1392.93 3015.5,-1392.93 3015.5,-1475.93"/>
<text text-anchor="middle" x="2803" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="2803" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="2803" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="2803" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_5</text>
<text text-anchor="middle" x="2803" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 10240&#45;12287</text>
</g>
<!-- attn_all_reduce&#45;&gt;attn_out_gpu_5 -->
<g id="edge42" class="edge">
<title>attn_all_reduce&#45;&gt;attn_out_gpu_5</title>
<path fill="none" stroke="black" d="M2369.82,-1527.34C2448.35,-1510.68 2530.49,-1493.25 2601.87,-1478.1"/>
<polygon fill="black" stroke="black" points="2602.81,-1481.48 2611.87,-1475.98 2601.36,-1474.63 2602.81,-1481.48"/>
</g>
<!-- attn_out_gpu_6 -->
<g id="node34" class="node">
<title>attn_out_gpu_6</title>
<polygon fill="lightcoral" stroke="black" points="3458.5,-1475.93 3033.5,-1475.93 3033.5,-1392.93 3458.5,-1392.93 3458.5,-1475.93"/>
<text text-anchor="middle" x="3246" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="3246" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="3246" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="3246" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_6</text>
<text text-anchor="middle" x="3246" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 12288&#45;14335</text>
</g>
<!-- attn_all_reduce&#45;&gt;attn_out_gpu_6 -->
<g id="edge45" class="edge">
<title>attn_all_reduce&#45;&gt;attn_out_gpu_6</title>
<path fill="none" stroke="black" d="M2405.6,-1556.36C2587.03,-1535.61 2812.43,-1507.88 3023.33,-1476"/>
<polygon fill="black" stroke="black" points="3024,-1479.44 3033.36,-1474.48 3022.95,-1472.52 3024,-1479.44"/>
</g>
<!-- attn_out_gpu_7 -->
<g id="node35" class="node">
<title>attn_out_gpu_7</title>
<polygon fill="lightcoral" stroke="black" points="3901.5,-1475.93 3476.5,-1475.93 3476.5,-1392.93 3901.5,-1392.93 3901.5,-1475.93"/>
<text text-anchor="middle" x="3689" y="-1460.73" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="3689" y="-1445.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="3689" y="-1430.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="3689" y="-1415.73" font-family="Times,serif" font-size="14.00">Device: gpu_7</text>
<text text-anchor="middle" x="3689" y="-1400.73" font-family="Times,serif" font-size="14.00">Rows: 14336&#45;16383</text>
</g>
<!-- attn_all_reduce&#45;&gt;attn_out_gpu_7 -->
<g id="edge48" class="edge">
<title>attn_all_reduce&#45;&gt;attn_out_gpu_7</title>
<path fill="none" stroke="black" d="M2425.82,-1572.84C2708.42,-1554.37 3107.54,-1523.22 3466.32,-1475.98"/>
<polygon fill="black" stroke="black" points="3466.93,-1479.43 3476.38,-1474.65 3466.01,-1472.49 3466.93,-1479.43"/>
</g>
<!-- attn_out_all_reduce -->
<g id="node36" class="node">
<title>attn_out_all_reduce</title>
<polygon fill="yellow" stroke="black" points="2809.9,-1356.93 2094.21,-1356.93 1910.1,-1190.93 2625.79,-1190.93 2809.9,-1356.93"/>
<text text-anchor="middle" x="2360" y="-1300.23" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="2360" y="-1285.23" font-family="Times,serif" font-size="14.00">Final Attention</text>
<text text-anchor="middle" x="2360" y="-1270.23" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="2360" y="-1255.23" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="2360" y="-1240.23" font-family="Times,serif" font-size="14.00">Device: all GPUs</text>
</g>
<!-- attn_out_gpu_0&#45;&gt;attn_out_all_reduce -->
<g id="edge28" class="edge">
<title>attn_out_gpu_0&#45;&gt;attn_out_all_reduce</title>
<path fill="none" stroke="black" d="M800.53,-1394.05C803.37,-1393.66 806.2,-1393.29 809,-1392.93 1219.83,-1339.8 1695.2,-1307.98 2010.25,-1291"/>
<polygon fill="black" stroke="black" points="2010.66,-1294.48 2020.46,-1290.45 2010.29,-1287.49 2010.66,-1294.48"/>
</g>
<!-- attn_out_gpu_1&#45;&gt;attn_out_all_reduce -->
<g id="edge31" class="edge">
<title>attn_out_gpu_1&#45;&gt;attn_out_all_reduce</title>
<path fill="none" stroke="black" d="M1243.55,-1394.17C1246.38,-1393.75 1249.2,-1393.33 1252,-1392.93 1510.32,-1355.55 1804.13,-1324.8 2024.27,-1304.06"/>
<polygon fill="black" stroke="black" points="2024.73,-1307.54 2034.36,-1303.12 2024.08,-1300.57 2024.73,-1307.54"/>
</g>
<!-- attn_out_gpu_2&#45;&gt;attn_out_all_reduce -->
<g id="edge34" class="edge">
<title>attn_out_gpu_2&#45;&gt;attn_out_all_reduce</title>
<path fill="none" stroke="black" d="M1686.6,-1394.44C1689.41,-1393.93 1692.22,-1393.43 1695,-1392.93 1811.21,-1371.97 1938.91,-1349.24 2051.06,-1329.37"/>
<polygon fill="black" stroke="black" points="2051.94,-1332.77 2061.18,-1327.58 2050.72,-1325.88 2051.94,-1332.77"/>
</g>
<!-- attn_out_gpu_3&#45;&gt;attn_out_all_reduce -->
<g id="edge37" class="edge">
<title>attn_out_gpu_3&#45;&gt;attn_out_all_reduce</title>
<path fill="none" stroke="black" d="M2030.22,-1392.92C2058.22,-1382.9 2089.27,-1371.79 2120.81,-1360.51"/>
<polygon fill="black" stroke="black" points="2122.37,-1363.66 2130.61,-1357 2120.01,-1357.07 2122.37,-1363.66"/>
</g>
<!-- attn_out_gpu_4&#45;&gt;attn_out_all_reduce -->
<g id="edge40" class="edge">
<title>attn_out_gpu_4&#45;&gt;attn_out_all_reduce</title>
<path fill="none" stroke="black" d="M2360,-1392.61C2360,-1384.68 2360,-1376.07 2360,-1367.24"/>
<polygon fill="black" stroke="black" points="2363.5,-1367.2 2360,-1357.2 2356.5,-1367.2 2363.5,-1367.2"/>
</g>
<!-- attn_out_gpu_5&#45;&gt;attn_out_all_reduce -->
<g id="edge43" class="edge">
<title>attn_out_gpu_5&#45;&gt;attn_out_all_reduce</title>
<path fill="none" stroke="black" d="M2689.78,-1392.92C2661.78,-1382.9 2630.73,-1371.79 2599.19,-1360.51"/>
<polygon fill="black" stroke="black" points="2599.99,-1357.07 2589.39,-1357 2597.63,-1363.66 2599.99,-1357.07"/>
</g>
<!-- attn_out_gpu_6&#45;&gt;attn_out_all_reduce -->
<g id="edge46" class="edge">
<title>attn_out_gpu_6&#45;&gt;attn_out_all_reduce</title>
<path fill="none" stroke="black" d="M3033.32,-1394.61C3030.19,-1394.04 3027.08,-1393.48 3024,-1392.93 2957.14,-1380.89 2886.48,-1368.24 2817.18,-1355.89"/>
<polygon fill="black" stroke="black" points="2817.42,-1352.38 2806.96,-1354.07 2816.19,-1359.27 2817.42,-1352.38"/>
</g>
<!-- attn_out_gpu_7&#45;&gt;attn_out_all_reduce -->
<g id="edge49" class="edge">
<title>attn_out_gpu_7&#45;&gt;attn_out_all_reduce</title>
<path fill="none" stroke="black" d="M3476.37,-1394.3C3473.23,-1393.83 3470.1,-1393.37 3467,-1392.93 3236.56,-1359.67 2977.87,-1331.58 2768.54,-1311.17"/>
<polygon fill="black" stroke="black" points="2768.59,-1307.65 2758.3,-1310.17 2767.91,-1314.62 2768.59,-1307.65"/>
</g>
<!-- attn_out_all_reduce&#45;&gt;residual_attn -->
<g id="edge50" class="edge">
<title>attn_out_all_reduce&#45;&gt;residual_attn</title>
<path fill="none" stroke="black" d="M2645.9,-1208.94C2742.64,-1187.29 2848.73,-1163.54 2938.13,-1143.54"/>
<polygon fill="black" stroke="black" points="2939.11,-1146.9 2948.11,-1141.3 2937.58,-1140.07 2939.11,-1146.9"/>
</g>
<!-- rmsnorm1 -->
<g id="node38" class="node">
<title>rmsnorm1</title>
<polygon fill="lightgray" stroke="black" points="3362,-1001.55 2928,-1001.55 2928,-933.55 3362,-933.55 3362,-1001.55"/>
<text text-anchor="middle" x="3145" y="-986.35" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="3145" y="-971.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="3145" y="-956.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="3145" y="-941.35" font-family="Times,serif" font-size="14.00">Device: all GPUs</text>
</g>
<!-- residual_attn&#45;&gt;rmsnorm1 -->
<g id="edge52" class="edge">
<title>residual_attn&#45;&gt;rmsnorm1</title>
<path fill="none" stroke="black" d="M3145,-1037.45C3145,-1028.83 3145,-1020.06 3145,-1011.8"/>
<polygon fill="black" stroke="black" points="3148.5,-1011.66 3145,-1001.66 3141.5,-1011.66 3148.5,-1011.66"/>
</g>
<!-- ffn_fc1_gpu_0 -->
<g id="node39" class="node">
<title>ffn_fc1_gpu_0</title>
<polygon fill="lightblue" stroke="black" points="1605.5,-897.55 1192.5,-897.55 1192.5,-814.55 1605.5,-814.55 1605.5,-897.55"/>
<text text-anchor="middle" x="1399" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="1399" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="1399" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="1399" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_0</text>
<text text-anchor="middle" x="1399" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 0&#45;8191</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_0 -->
<g id="edge53" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_0</title>
<path fill="none" stroke="black" d="M2927.97,-965.62C2632.56,-962.32 2087.76,-949 1626,-897.55 1622.67,-897.17 1619.31,-896.78 1615.93,-896.38"/>
<polygon fill="black" stroke="black" points="1616.11,-892.87 1605.75,-895.1 1615.24,-899.82 1616.11,-892.87"/>
</g>
<!-- ffn_fc1_gpu_1 -->
<g id="node40" class="node">
<title>ffn_fc1_gpu_1</title>
<polygon fill="lightblue" stroke="black" points="2048.5,-897.55 1635.5,-897.55 1635.5,-814.55 2048.5,-814.55 2048.5,-897.55"/>
<text text-anchor="middle" x="1842" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="1842" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="1842" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="1842" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_1</text>
<text text-anchor="middle" x="1842" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 8192&#45;16383</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_1 -->
<g id="edge57" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_1</title>
<path fill="none" stroke="black" d="M2927.98,-960.21C2709.02,-952.05 2361.56,-934.29 2063,-897.55 2061.67,-897.38 2060.33,-897.21 2058.99,-897.05"/>
<polygon fill="black" stroke="black" points="2059,-893.52 2048.63,-895.69 2058.09,-900.46 2059,-893.52"/>
</g>
<!-- ffn_fc1_gpu_2 -->
<g id="node41" class="node">
<title>ffn_fc1_gpu_2</title>
<polygon fill="lightblue" stroke="black" points="2485.5,-897.55 2072.5,-897.55 2072.5,-814.55 2485.5,-814.55 2485.5,-897.55"/>
<text text-anchor="middle" x="2279" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="2279" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="2279" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="2279" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_2</text>
<text text-anchor="middle" x="2279" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 16384&#45;24575</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_2 -->
<g id="edge61" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_2</title>
<path fill="none" stroke="black" d="M2927.73,-947.66C2801.66,-935.64 2640.02,-918.41 2497,-897.55 2496.65,-897.5 2496.3,-897.44 2495.95,-897.39"/>
<polygon fill="black" stroke="black" points="2496.17,-893.89 2485.77,-895.87 2495.14,-900.81 2496.17,-893.89"/>
</g>
<!-- ffn_fc1_gpu_3 -->
<g id="node42" class="node">
<title>ffn_fc1_gpu_3</title>
<polygon fill="lightblue" stroke="black" points="2919.5,-897.55 2506.5,-897.55 2506.5,-814.55 2919.5,-814.55 2919.5,-897.55"/>
<text text-anchor="middle" x="2713" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="2713" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="2713" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="2713" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_3</text>
<text text-anchor="middle" x="2713" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 24576&#45;32767</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_3 -->
<g id="edge65" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_3</title>
<path fill="none" stroke="black" d="M3014.8,-933.54C2973.34,-923.04 2926.85,-911.25 2883,-900.14"/>
<polygon fill="black" stroke="black" points="2883.66,-896.69 2873.1,-897.63 2881.94,-903.48 2883.66,-896.69"/>
</g>
<!-- ffn_fc1_gpu_4 -->
<g id="node43" class="node">
<title>ffn_fc1_gpu_4</title>
<polygon fill="lightblue" stroke="black" points="3351.5,-897.55 2938.5,-897.55 2938.5,-814.55 3351.5,-814.55 3351.5,-897.55"/>
<text text-anchor="middle" x="3145" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="3145" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="3145" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="3145" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_4</text>
<text text-anchor="middle" x="3145" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 32768&#45;40959</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_4 -->
<g id="edge69" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_4</title>
<path fill="none" stroke="black" d="M3145,-933.4C3145,-925.34 3145,-916.55 3145,-907.88"/>
<polygon fill="black" stroke="black" points="3148.5,-907.82 3145,-897.82 3141.5,-907.82 3148.5,-907.82"/>
</g>
<!-- ffn_fc1_gpu_5 -->
<g id="node44" class="node">
<title>ffn_fc1_gpu_5</title>
<polygon fill="lightblue" stroke="black" points="3785.5,-897.55 3372.5,-897.55 3372.5,-814.55 3785.5,-814.55 3785.5,-897.55"/>
<text text-anchor="middle" x="3579" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="3579" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="3579" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="3579" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_5</text>
<text text-anchor="middle" x="3579" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 40960&#45;49151</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_5 -->
<g id="edge73" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_5</title>
<path fill="none" stroke="black" d="M3275.8,-933.54C3317.45,-923.04 3364.16,-911.25 3408.21,-900.14"/>
<polygon fill="black" stroke="black" points="3409.31,-903.47 3418.15,-897.63 3407.6,-896.68 3409.31,-903.47"/>
</g>
<!-- ffn_fc1_gpu_6 -->
<g id="node45" class="node">
<title>ffn_fc1_gpu_6</title>
<polygon fill="lightblue" stroke="black" points="4222.5,-897.55 3809.5,-897.55 3809.5,-814.55 4222.5,-814.55 4222.5,-897.55"/>
<text text-anchor="middle" x="4016" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="4016" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="4016" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="4016" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_6</text>
<text text-anchor="middle" x="4016" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 49152&#45;57343</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_6 -->
<g id="edge77" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_6</title>
<path fill="none" stroke="black" d="M3362.18,-947.63C3488.74,-935.57 3651.24,-918.32 3795,-897.55 3796.33,-897.35 3797.66,-897.16 3799,-896.96"/>
<polygon fill="black" stroke="black" points="3799.96,-900.36 3809.33,-895.42 3798.92,-893.44 3799.96,-900.36"/>
</g>
<!-- ffn_fc1_gpu_7 -->
<g id="node46" class="node">
<title>ffn_fc1_gpu_7</title>
<polygon fill="lightblue" stroke="black" points="4667.5,-897.55 4254.5,-897.55 4254.5,-814.55 4667.5,-814.55 4667.5,-897.55"/>
<text text-anchor="middle" x="4461" y="-882.35" font-family="Times,serif" font-size="14.00">FFN FC1</text>
<text text-anchor="middle" x="4461" y="-867.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="4461" y="-852.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="4461" y="-837.35" font-family="Times,serif" font-size="14.00">Device: gpu_7</text>
<text text-anchor="middle" x="4461" y="-822.35" font-family="Times,serif" font-size="14.00">Columns: 57344&#45;65535</text>
</g>
<!-- rmsnorm1&#45;&gt;ffn_fc1_gpu_7 -->
<g id="edge81" class="edge">
<title>rmsnorm1&#45;&gt;ffn_fc1_gpu_7</title>
<path fill="none" stroke="black" d="M3362.2,-959.9C3582.09,-951.49 3931.6,-933.53 4232,-897.55 4236,-897.07 4240.04,-896.56 4244.1,-896.04"/>
<polygon fill="black" stroke="black" points="4244.8,-899.48 4254.26,-894.69 4243.88,-892.54 4244.8,-899.48"/>
</g>
<!-- residual_ffn -->
<g id="node64" class="node">
<title>residual_ffn</title>
<ellipse fill="lightgreen" stroke="black" cx="3930" cy="-294.86" rx="306.77" ry="58.88"/>
<text text-anchor="middle" x="3930" y="-321.16" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3930" y="-306.16" font-family="Times,serif" font-size="14.00">FFN</text>
<text text-anchor="middle" x="3930" y="-291.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="3930" y="-276.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="3930" y="-261.16" font-family="Times,serif" font-size="14.00">Device: all GPUs</text>
</g>
<!-- rmsnorm1&#45;&gt;residual_ffn -->
<g id="edge86" class="edge">
<title>rmsnorm1&#45;&gt;residual_ffn</title>
<path fill="none" stroke="black" d="M3362.26,-963.56C3772.99,-956.97 4627.02,-938.41 4677,-897.55 4730.91,-853.47 4715,-815.18 4715,-745.55 4715,-745.55 4715,-745.55 4715,-632.05 4715,-506.44 4371.1,-399.83 4138.55,-342.09"/>
<polygon fill="black" stroke="black" points="4139.14,-338.63 4128.6,-339.63 4137.46,-345.43 4139.14,-338.63"/>
</g>
<!-- ffn_act_gpu_0 -->
<g id="node47" class="node">
<title>ffn_act_gpu_0</title>
<polygon fill="lightblue" stroke="black" points="1594.5,-778.55 1199.5,-778.55 1199.5,-710.55 1594.5,-710.55 1594.5,-778.55"/>
<text text-anchor="middle" x="1397" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="1397" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="1397" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="1397" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_0</text>
</g>
<!-- ffn_fc1_gpu_0&#45;&gt;ffn_act_gpu_0 -->
<g id="edge54" class="edge">
<title>ffn_fc1_gpu_0&#45;&gt;ffn_act_gpu_0</title>
<path fill="none" stroke="black" d="M1398.26,-814.27C1398.11,-806.06 1397.95,-797.41 1397.8,-789.11"/>
<polygon fill="black" stroke="black" points="1401.29,-788.78 1397.61,-778.85 1394.29,-788.91 1401.29,-788.78"/>
</g>
<!-- ffn_act_gpu_1 -->
<g id="node48" class="node">
<title>ffn_act_gpu_1</title>
<polygon fill="lightblue" stroke="black" points="2021.5,-778.55 1626.5,-778.55 1626.5,-710.55 2021.5,-710.55 2021.5,-778.55"/>
<text text-anchor="middle" x="1824" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="1824" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="1824" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="1824" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_1</text>
</g>
<!-- ffn_fc1_gpu_1&#45;&gt;ffn_act_gpu_1 -->
<g id="edge58" class="edge">
<title>ffn_fc1_gpu_1&#45;&gt;ffn_act_gpu_1</title>
<path fill="none" stroke="black" d="M1835.3,-814.27C1833.93,-805.97 1832.49,-797.21 1831.12,-788.83"/>
<polygon fill="black" stroke="black" points="1834.55,-788.15 1829.47,-778.85 1827.64,-789.28 1834.55,-788.15"/>
</g>
<!-- ffn_act_gpu_2 -->
<g id="node49" class="node">
<title>ffn_act_gpu_2</title>
<polygon fill="lightblue" stroke="black" points="2464.5,-778.55 2069.5,-778.55 2069.5,-710.55 2464.5,-710.55 2464.5,-778.55"/>
<text text-anchor="middle" x="2267" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="2267" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="2267" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="2267" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_2</text>
</g>
<!-- ffn_fc1_gpu_2&#45;&gt;ffn_act_gpu_2 -->
<g id="edge62" class="edge">
<title>ffn_fc1_gpu_2&#45;&gt;ffn_act_gpu_2</title>
<path fill="none" stroke="black" d="M2274.53,-814.27C2273.62,-805.97 2272.66,-797.21 2271.74,-788.83"/>
<polygon fill="black" stroke="black" points="2275.22,-788.41 2270.65,-778.85 2268.26,-789.17 2275.22,-788.41"/>
</g>
<!-- ffn_act_gpu_3 -->
<g id="node50" class="node">
<title>ffn_act_gpu_3</title>
<polygon fill="lightblue" stroke="black" points="2904.5,-778.55 2509.5,-778.55 2509.5,-710.55 2904.5,-710.55 2904.5,-778.55"/>
<text text-anchor="middle" x="2707" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="2707" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="2707" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="2707" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_3</text>
</g>
<!-- ffn_fc1_gpu_3&#45;&gt;ffn_act_gpu_3 -->
<g id="edge66" class="edge">
<title>ffn_fc1_gpu_3&#45;&gt;ffn_act_gpu_3</title>
<path fill="none" stroke="black" d="M2710.77,-814.27C2710.32,-806.06 2709.84,-797.41 2709.39,-789.11"/>
<polygon fill="black" stroke="black" points="2712.87,-788.64 2708.82,-778.85 2705.88,-789.02 2712.87,-788.64"/>
</g>
<!-- ffn_act_gpu_4 -->
<g id="node51" class="node">
<title>ffn_act_gpu_4</title>
<polygon fill="lightblue" stroke="black" points="3342.5,-778.55 2947.5,-778.55 2947.5,-710.55 3342.5,-710.55 3342.5,-778.55"/>
<text text-anchor="middle" x="3145" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="3145" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="3145" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="3145" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_4</text>
</g>
<!-- ffn_fc1_gpu_4&#45;&gt;ffn_act_gpu_4 -->
<g id="edge70" class="edge">
<title>ffn_fc1_gpu_4&#45;&gt;ffn_act_gpu_4</title>
<path fill="none" stroke="black" d="M3145,-814.27C3145,-806.06 3145,-797.41 3145,-789.11"/>
<polygon fill="black" stroke="black" points="3148.5,-788.85 3145,-778.85 3141.5,-788.85 3148.5,-788.85"/>
</g>
<!-- ffn_act_gpu_5 -->
<g id="node52" class="node">
<title>ffn_act_gpu_5</title>
<polygon fill="lightblue" stroke="black" points="3779.5,-778.55 3384.5,-778.55 3384.5,-710.55 3779.5,-710.55 3779.5,-778.55"/>
<text text-anchor="middle" x="3582" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="3582" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="3582" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="3582" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_5</text>
</g>
<!-- ffn_fc1_gpu_5&#45;&gt;ffn_act_gpu_5 -->
<g id="edge74" class="edge">
<title>ffn_fc1_gpu_5&#45;&gt;ffn_act_gpu_5</title>
<path fill="none" stroke="black" d="M3580.12,-814.27C3580.34,-806.06 3580.58,-797.41 3580.81,-789.11"/>
<polygon fill="black" stroke="black" points="3584.31,-788.94 3581.09,-778.85 3577.32,-788.75 3584.31,-788.94"/>
</g>
<!-- ffn_act_gpu_6 -->
<g id="node53" class="node">
<title>ffn_act_gpu_6</title>
<polygon fill="lightblue" stroke="black" points="4219.5,-778.55 3824.5,-778.55 3824.5,-710.55 4219.5,-710.55 4219.5,-778.55"/>
<text text-anchor="middle" x="4022" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="4022" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="4022" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="4022" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_6</text>
</g>
<!-- ffn_fc1_gpu_6&#45;&gt;ffn_act_gpu_6 -->
<g id="edge78" class="edge">
<title>ffn_fc1_gpu_6&#45;&gt;ffn_act_gpu_6</title>
<path fill="none" stroke="black" d="M4018.23,-814.27C4018.68,-806.06 4019.16,-797.41 4019.61,-789.11"/>
<polygon fill="black" stroke="black" points="4023.12,-789.02 4020.18,-778.85 4016.13,-788.64 4023.12,-789.02"/>
</g>
<!-- ffn_act_gpu_7 -->
<g id="node54" class="node">
<title>ffn_act_gpu_7</title>
<polygon fill="lightblue" stroke="black" points="4664.5,-778.55 4269.5,-778.55 4269.5,-710.55 4664.5,-710.55 4664.5,-778.55"/>
<text text-anchor="middle" x="4467" y="-763.35" font-family="Times,serif" font-size="14.00">SwiGLU Activation</text>
<text text-anchor="middle" x="4467" y="-748.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="4467" y="-733.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="4467" y="-718.35" font-family="Times,serif" font-size="14.00">Device: gpu_7</text>
</g>
<!-- ffn_fc1_gpu_7&#45;&gt;ffn_act_gpu_7 -->
<g id="edge82" class="edge">
<title>ffn_fc1_gpu_7&#45;&gt;ffn_act_gpu_7</title>
<path fill="none" stroke="black" d="M4463.23,-814.27C4463.68,-806.06 4464.16,-797.41 4464.61,-789.11"/>
<polygon fill="black" stroke="black" points="4468.12,-789.02 4465.18,-778.85 4461.13,-788.64 4468.12,-789.02"/>
</g>
<!-- ffn_fc2_gpu_0 -->
<g id="node55" class="node">
<title>ffn_fc2_gpu_0</title>
<polygon fill="lightblue" stroke="black" points="1585.5,-674.55 1160.5,-674.55 1160.5,-591.55 1585.5,-591.55 1585.5,-674.55"/>
<text text-anchor="middle" x="1373" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="1373" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="1373" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="1373" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_0</text>
<text text-anchor="middle" x="1373" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 0&#45;2047</text>
</g>
<!-- ffn_act_gpu_0&#45;&gt;ffn_fc2_gpu_0 -->
<g id="edge55" class="edge">
<title>ffn_act_gpu_0&#45;&gt;ffn_fc2_gpu_0</title>
<path fill="none" stroke="black" d="M1389.73,-710.4C1387.95,-702.25 1386,-693.36 1384.08,-684.6"/>
<polygon fill="black" stroke="black" points="1387.5,-683.84 1381.94,-674.82 1380.66,-685.34 1387.5,-683.84"/>
</g>
<!-- ffn_fc2_gpu_1 -->
<g id="node56" class="node">
<title>ffn_fc2_gpu_1</title>
<polygon fill="lightblue" stroke="black" points="2028.5,-674.55 1603.5,-674.55 1603.5,-591.55 2028.5,-591.55 2028.5,-674.55"/>
<text text-anchor="middle" x="1816" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="1816" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="1816" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="1816" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_1</text>
<text text-anchor="middle" x="1816" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 2048&#45;4095</text>
</g>
<!-- ffn_act_gpu_1&#45;&gt;ffn_fc2_gpu_1 -->
<g id="edge59" class="edge">
<title>ffn_act_gpu_1&#45;&gt;ffn_fc2_gpu_1</title>
<path fill="none" stroke="black" d="M1821.58,-710.4C1820.99,-702.34 1820.35,-693.55 1819.71,-684.88"/>
<polygon fill="black" stroke="black" points="1823.2,-684.54 1818.98,-674.82 1816.22,-685.05 1823.2,-684.54"/>
</g>
<!-- ffn_fc2_gpu_2 -->
<g id="node57" class="node">
<title>ffn_fc2_gpu_2</title>
<polygon fill="lightblue" stroke="black" points="2471.5,-674.55 2046.5,-674.55 2046.5,-591.55 2471.5,-591.55 2471.5,-674.55"/>
<text text-anchor="middle" x="2259" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="2259" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="2259" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="2259" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_2</text>
<text text-anchor="middle" x="2259" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 4096&#45;6143</text>
</g>
<!-- ffn_act_gpu_2&#45;&gt;ffn_fc2_gpu_2 -->
<g id="edge63" class="edge">
<title>ffn_act_gpu_2&#45;&gt;ffn_fc2_gpu_2</title>
<path fill="none" stroke="black" d="M2264.58,-710.4C2263.99,-702.34 2263.35,-693.55 2262.71,-684.88"/>
<polygon fill="black" stroke="black" points="2266.2,-684.54 2261.98,-674.82 2259.22,-685.05 2266.2,-684.54"/>
</g>
<!-- ffn_fc2_gpu_3 -->
<g id="node58" class="node">
<title>ffn_fc2_gpu_3</title>
<polygon fill="lightblue" stroke="black" points="2914.5,-674.55 2489.5,-674.55 2489.5,-591.55 2914.5,-591.55 2914.5,-674.55"/>
<text text-anchor="middle" x="2702" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="2702" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="2702" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="2702" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_3</text>
<text text-anchor="middle" x="2702" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 6144&#45;8191</text>
</g>
<!-- ffn_act_gpu_3&#45;&gt;ffn_fc2_gpu_3 -->
<g id="edge67" class="edge">
<title>ffn_act_gpu_3&#45;&gt;ffn_fc2_gpu_3</title>
<path fill="none" stroke="black" d="M2705.49,-710.4C2705.12,-702.34 2704.72,-693.55 2704.32,-684.88"/>
<polygon fill="black" stroke="black" points="2707.81,-684.65 2703.86,-674.82 2700.82,-684.97 2707.81,-684.65"/>
</g>
<!-- ffn_fc2_gpu_4 -->
<g id="node59" class="node">
<title>ffn_fc2_gpu_4</title>
<polygon fill="lightblue" stroke="black" points="3357.5,-674.55 2932.5,-674.55 2932.5,-591.55 3357.5,-591.55 3357.5,-674.55"/>
<text text-anchor="middle" x="3145" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="3145" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="3145" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="3145" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_4</text>
<text text-anchor="middle" x="3145" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 8192&#45;10239</text>
</g>
<!-- ffn_act_gpu_4&#45;&gt;ffn_fc2_gpu_4 -->
<g id="edge71" class="edge">
<title>ffn_act_gpu_4&#45;&gt;ffn_fc2_gpu_4</title>
<path fill="none" stroke="black" d="M3145,-710.4C3145,-702.34 3145,-693.55 3145,-684.88"/>
<polygon fill="black" stroke="black" points="3148.5,-684.82 3145,-674.82 3141.5,-684.82 3148.5,-684.82"/>
</g>
<!-- ffn_fc2_gpu_5 -->
<g id="node60" class="node">
<title>ffn_fc2_gpu_5</title>
<polygon fill="lightblue" stroke="black" points="3800.5,-674.55 3375.5,-674.55 3375.5,-591.55 3800.5,-591.55 3800.5,-674.55"/>
<text text-anchor="middle" x="3588" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="3588" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="3588" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="3588" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_5</text>
<text text-anchor="middle" x="3588" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 10240&#45;12287</text>
</g>
<!-- ffn_act_gpu_5&#45;&gt;ffn_fc2_gpu_5 -->
<g id="edge75" class="edge">
<title>ffn_act_gpu_5&#45;&gt;ffn_fc2_gpu_5</title>
<path fill="none" stroke="black" d="M3583.82,-710.4C3584.26,-702.34 3584.74,-693.55 3585.21,-684.88"/>
<polygon fill="black" stroke="black" points="3588.71,-685 3585.77,-674.82 3581.72,-684.62 3588.71,-685"/>
</g>
<!-- ffn_fc2_gpu_6 -->
<g id="node61" class="node">
<title>ffn_fc2_gpu_6</title>
<polygon fill="lightblue" stroke="black" points="4243.5,-674.55 3818.5,-674.55 3818.5,-591.55 4243.5,-591.55 4243.5,-674.55"/>
<text text-anchor="middle" x="4031" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="4031" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="4031" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="4031" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_6</text>
<text text-anchor="middle" x="4031" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 12288&#45;14335</text>
</g>
<!-- ffn_act_gpu_6&#45;&gt;ffn_fc2_gpu_6 -->
<g id="edge79" class="edge">
<title>ffn_act_gpu_6&#45;&gt;ffn_fc2_gpu_6</title>
<path fill="none" stroke="black" d="M4024.72,-710.4C4025.39,-702.34 4026.11,-693.55 4026.82,-684.88"/>
<polygon fill="black" stroke="black" points="4030.32,-685.08 4027.65,-674.82 4023.34,-684.5 4030.32,-685.08"/>
</g>
<!-- ffn_fc2_gpu_7 -->
<g id="node62" class="node">
<title>ffn_fc2_gpu_7</title>
<polygon fill="lightblue" stroke="black" points="4686.5,-674.55 4261.5,-674.55 4261.5,-591.55 4686.5,-591.55 4686.5,-674.55"/>
<text text-anchor="middle" x="4474" y="-659.35" font-family="Times,serif" font-size="14.00">FFN FC2</text>
<text text-anchor="middle" x="4474" y="-644.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, ffn=8192]</text>
<text text-anchor="middle" x="4474" y="-629.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=2048]</text>
<text text-anchor="middle" x="4474" y="-614.35" font-family="Times,serif" font-size="14.00">Device: gpu_7</text>
<text text-anchor="middle" x="4474" y="-599.35" font-family="Times,serif" font-size="14.00">Rows: 14336&#45;16383</text>
</g>
<!-- ffn_act_gpu_7&#45;&gt;ffn_fc2_gpu_7 -->
<g id="edge83" class="edge">
<title>ffn_act_gpu_7&#45;&gt;ffn_fc2_gpu_7</title>
<path fill="none" stroke="black" d="M4469.12,-710.4C4469.63,-702.34 4470.2,-693.55 4470.75,-684.88"/>
<polygon fill="black" stroke="black" points="4474.25,-685.03 4471.39,-674.82 4467.26,-684.58 4474.25,-685.03"/>
</g>
<!-- ffn_all_reduce -->
<g id="node63" class="node">
<title>ffn_all_reduce</title>
<polygon fill="yellow" stroke="black" points="3594.9,-555.55 2879.21,-555.55 2695.1,-389.55 3410.79,-389.55 3594.9,-555.55"/>
<text text-anchor="middle" x="3145" y="-498.85" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="3145" y="-483.85" font-family="Times,serif" font-size="14.00">FFN Output</text>
<text text-anchor="middle" x="3145" y="-468.85" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="3145" y="-453.85" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="3145" y="-438.85" font-family="Times,serif" font-size="14.00">Device: all GPUs</text>
</g>
<!-- ffn_fc2_gpu_0&#45;&gt;ffn_all_reduce -->
<g id="edge56" class="edge">
<title>ffn_fc2_gpu_0&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M1585.53,-592.67C1588.37,-592.28 1591.2,-591.91 1594,-591.55 2004.83,-538.42 2480.2,-506.6 2795.25,-489.62"/>
<polygon fill="black" stroke="black" points="2795.66,-493.1 2805.46,-489.07 2795.29,-486.11 2795.66,-493.1"/>
</g>
<!-- ffn_fc2_gpu_1&#45;&gt;ffn_all_reduce -->
<g id="edge60" class="edge">
<title>ffn_fc2_gpu_1&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M2028.55,-592.79C2031.38,-592.37 2034.2,-591.95 2037,-591.55 2295.32,-554.17 2589.13,-523.42 2809.27,-502.68"/>
<polygon fill="black" stroke="black" points="2809.73,-506.16 2819.36,-501.74 2809.08,-499.19 2809.73,-506.16"/>
</g>
<!-- ffn_fc2_gpu_2&#45;&gt;ffn_all_reduce -->
<g id="edge64" class="edge">
<title>ffn_fc2_gpu_2&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M2471.6,-593.06C2474.41,-592.55 2477.22,-592.05 2480,-591.55 2596.21,-570.59 2723.91,-547.86 2836.06,-527.99"/>
<polygon fill="black" stroke="black" points="2836.94,-531.39 2846.18,-526.2 2835.72,-524.5 2836.94,-531.39"/>
</g>
<!-- ffn_fc2_gpu_3&#45;&gt;ffn_all_reduce -->
<g id="edge68" class="edge">
<title>ffn_fc2_gpu_3&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M2815.22,-591.54C2843.22,-581.52 2874.27,-570.41 2905.81,-559.13"/>
<polygon fill="black" stroke="black" points="2907.37,-562.28 2915.61,-555.62 2905.01,-555.69 2907.37,-562.28"/>
</g>
<!-- ffn_fc2_gpu_4&#45;&gt;ffn_all_reduce -->
<g id="edge72" class="edge">
<title>ffn_fc2_gpu_4&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M3145,-591.23C3145,-583.3 3145,-574.69 3145,-565.86"/>
<polygon fill="black" stroke="black" points="3148.5,-565.82 3145,-555.82 3141.5,-565.82 3148.5,-565.82"/>
</g>
<!-- ffn_fc2_gpu_5&#45;&gt;ffn_all_reduce -->
<g id="edge76" class="edge">
<title>ffn_fc2_gpu_5&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M3474.78,-591.54C3446.78,-581.52 3415.73,-570.41 3384.19,-559.13"/>
<polygon fill="black" stroke="black" points="3384.99,-555.69 3374.39,-555.62 3382.63,-562.28 3384.99,-555.69"/>
</g>
<!-- ffn_fc2_gpu_6&#45;&gt;ffn_all_reduce -->
<g id="edge80" class="edge">
<title>ffn_fc2_gpu_6&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M3818.4,-593.06C3815.59,-592.55 3812.78,-592.05 3810,-591.55 3742.77,-579.42 3671.7,-566.7 3602.02,-554.29"/>
<polygon fill="black" stroke="black" points="3602.21,-550.77 3591.75,-552.46 3600.98,-557.66 3602.21,-550.77"/>
</g>
<!-- ffn_fc2_gpu_7&#45;&gt;ffn_all_reduce -->
<g id="edge84" class="edge">
<title>ffn_fc2_gpu_7&#45;&gt;ffn_all_reduce</title>
<path fill="none" stroke="black" d="M4261.45,-592.79C4258.62,-592.37 4255.8,-591.95 4253,-591.55 4022.13,-558.15 3762.91,-530.03 3553.28,-509.63"/>
<polygon fill="black" stroke="black" points="3553.31,-506.12 3543.02,-508.63 3552.64,-513.08 3553.31,-506.12"/>
</g>
<!-- ffn_all_reduce&#45;&gt;residual_ffn -->
<g id="edge85" class="edge">
<title>ffn_all_reduce&#45;&gt;residual_ffn</title>
<path fill="none" stroke="black" d="M3430.9,-407.56C3527.64,-385.91 3633.73,-362.16 3723.13,-342.16"/>
<polygon fill="black" stroke="black" points="3724.11,-345.52 3733.11,-339.92 3722.58,-338.69 3724.11,-345.52"/>
</g>
<!-- rmsnorm2 -->
<g id="node65" class="node">
<title>rmsnorm2</title>
<polygon fill="lightgray" stroke="black" points="4147,-200.17 3713,-200.17 3713,-132.17 4147,-132.17 4147,-200.17"/>
<text text-anchor="middle" x="3930" y="-184.97" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<text text-anchor="middle" x="3930" y="-169.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="3930" y="-154.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="3930" y="-139.97" font-family="Times,serif" font-size="14.00">Device: all GPUs</text>
</g>
<!-- residual_ffn&#45;&gt;rmsnorm2 -->
<g id="edge87" class="edge">
<title>residual_ffn&#45;&gt;rmsnorm2</title>
<path fill="none" stroke="black" d="M3930,-236.07C3930,-227.45 3930,-218.68 3930,-210.42"/>
<polygon fill="black" stroke="black" points="3933.5,-210.28 3930,-200.28 3926.5,-210.28 3933.5,-210.28"/>
</g>
<!-- output -->
<g id="node66" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="3930" cy="-48.08" rx="332.18" ry="48.17"/>
<text text-anchor="middle" x="3930" y="-66.88" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="3930" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1000000, hidden=16384]</text>
<text text-anchor="middle" x="3930" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1000000, vocab_size=128000]</text>
<text text-anchor="middle" x="3930" y="-21.88" font-family="Times,serif" font-size="14.00">Device: CPU</text>
</g>
<!-- rmsnorm2&#45;&gt;output -->
<g id="edge88" class="edge">
<title>rmsnorm2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3930,-131.9C3930,-123.91 3930,-115.14 3930,-106.4"/>
<polygon fill="black" stroke="black" points="3933.5,-106.19 3930,-96.19 3926.5,-106.19 3933.5,-106.19"/>
</g>
</g>
</svg>
