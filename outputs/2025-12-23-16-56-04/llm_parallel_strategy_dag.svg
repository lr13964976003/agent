<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="767pt" height="81419pt"
 viewBox="0.00 0.00 767.00 81418.94" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 81414.94)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-81414.94 763,-81414.94 763,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="#e8f5e8" stroke="black" cx="419" cy="-81377.7" rx="186.85" ry="33.47"/>
<text text-anchor="middle" x="419" y="-81386.2" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="419" y="-81375.2" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?]</text>
<text text-anchor="middle" x="419" y="-81364.2" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=8192]</text>
</g>
<!-- embed_0 -->
<g id="node2" class="node">
<title>embed_0</title>
<path fill="#e6f3ff" stroke="black" d="M389,-81272.47C389,-81272.47 149,-81272.47 149,-81272.47 143,-81272.47 137,-81266.47 137,-81260.47 137,-81260.47 137,-81237.47 137,-81237.47 137,-81231.47 143,-81225.47 149,-81225.47 149,-81225.47 389,-81225.47 389,-81225.47 395,-81225.47 401,-81231.47 401,-81237.47 401,-81237.47 401,-81260.47 401,-81260.47 401,-81266.47 395,-81272.47 389,-81272.47"/>
<text text-anchor="middle" x="269" y="-81257.47" font-family="Arial" font-size="10.00">Embedding GPU0</text>
<text text-anchor="middle" x="269" y="-81246.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?]</text>
<text text-anchor="middle" x="269" y="-81235.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- input&#45;&gt;embed_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embed_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M381.54,-81345.05C357.63,-81324.85 326.86,-81298.86 303.54,-81279.15"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="305.53,-81276.25 295.63,-81272.47 301.01,-81281.6 305.53,-81276.25"/>
</g>
<!-- embed_1 -->
<g id="node3" class="node">
<title>embed_1</title>
<path fill="#e6f3ff" stroke="black" d="M689,-81272.47C689,-81272.47 449,-81272.47 449,-81272.47 443,-81272.47 437,-81266.47 437,-81260.47 437,-81260.47 437,-81237.47 437,-81237.47 437,-81231.47 443,-81225.47 449,-81225.47 449,-81225.47 689,-81225.47 689,-81225.47 695,-81225.47 701,-81231.47 701,-81237.47 701,-81237.47 701,-81260.47 701,-81260.47 701,-81266.47 695,-81272.47 689,-81272.47"/>
<text text-anchor="middle" x="569" y="-81257.47" font-family="Arial" font-size="10.00">Embedding GPU1</text>
<text text-anchor="middle" x="569" y="-81246.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?]</text>
<text text-anchor="middle" x="569" y="-81235.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- input&#45;&gt;embed_1 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;embed_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M456.46,-81345.05C480.37,-81324.85 511.14,-81298.86 534.46,-81279.15"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="536.99,-81281.6 542.37,-81272.47 532.47,-81276.25 536.99,-81281.6"/>
</g>
<!-- embed_ag -->
<g id="node4" class="node">
<title>embed_ag</title>
<path fill="#ffe6e6" stroke="black" d="M521.09,-81153.47C521.09,-81153.47 363.6,-81153.47 363.6,-81153.47 357.6,-81153.47 348.93,-81148.09 346.26,-81142.72 346.26,-81142.72 310.25,-81070.22 310.25,-81070.22 307.58,-81064.84 310.91,-81059.47 316.91,-81059.47 316.91,-81059.47 474.4,-81059.47 474.4,-81059.47 480.4,-81059.47 489.07,-81064.84 491.74,-81070.22 491.74,-81070.22 527.75,-81142.72 527.75,-81142.72 530.42,-81148.09 527.09,-81153.47 521.09,-81153.47"/>
<text text-anchor="middle" x="419" y="-81114.97" font-family="Arial" font-size="10.00">All&#45;Gather</text>
<text text-anchor="middle" x="419" y="-81103.97" font-family="Arial" font-size="10.00">Embedding Output</text>
<text text-anchor="middle" x="419" y="-81092.97" font-family="Arial" font-size="10.00">[TP All&#45;Gather]</text>
</g>
<!-- embed_0&#45;&gt;embed_ag -->
<g id="edge3" class="edge">
<title>embed_0&#45;&gt;embed_ag</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M293.1,-81225.39C311.79,-81207.89 338.46,-81182.91 362.45,-81160.44"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="364.89,-81162.95 369.79,-81153.56 360.1,-81157.84 364.89,-81162.95"/>
</g>
<!-- embed_1&#45;&gt;embed_ag -->
<g id="edge4" class="edge">
<title>embed_1&#45;&gt;embed_ag</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M544.9,-81225.39C526.21,-81207.89 499.54,-81182.91 475.55,-81160.44"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="477.9,-81157.84 468.21,-81153.56 473.11,-81162.95 477.9,-81157.84"/>
</g>
<!-- layer0_qkv_0 -->
<g id="node5" class="node">
<title>layer0_qkv_0</title>
<path fill="#e6f3ff" stroke="black" d="M389,-80987.47C389,-80987.47 91,-80987.47 91,-80987.47 85,-80987.47 79,-80981.47 79,-80975.47 79,-80975.47 79,-80952.47 79,-80952.47 79,-80946.47 85,-80940.47 91,-80940.47 91,-80940.47 389,-80940.47 389,-80940.47 395,-80940.47 401,-80946.47 401,-80952.47 401,-80952.47 401,-80975.47 401,-80975.47 401,-80981.47 395,-80987.47 389,-80987.47"/>
<text text-anchor="middle" x="240" y="-80972.47" font-family="Arial" font-size="10.00">Layer 0 QKV Proj GPU0</text>
<text text-anchor="middle" x="240" y="-80961.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="240" y="-80950.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- embed_ag&#45;&gt;layer0_qkv_0 -->
<g id="edge5" class="edge">
<title>embed_ag&#45;&gt;layer0_qkv_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M360.39,-81059.46C333.03,-81037.99 301.27,-81013.06 277.25,-80994.21"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="279.12,-80991.23 269.1,-80987.81 274.8,-80996.73 279.12,-80991.23"/>
</g>
<!-- layer0_qkv_1 -->
<g id="node6" class="node">
<title>layer0_qkv_1</title>
<path fill="#e6f3ff" stroke="black" d="M747,-80987.47C747,-80987.47 449,-80987.47 449,-80987.47 443,-80987.47 437,-80981.47 437,-80975.47 437,-80975.47 437,-80952.47 437,-80952.47 437,-80946.47 443,-80940.47 449,-80940.47 449,-80940.47 747,-80940.47 747,-80940.47 753,-80940.47 759,-80946.47 759,-80952.47 759,-80952.47 759,-80975.47 759,-80975.47 759,-80981.47 753,-80987.47 747,-80987.47"/>
<text text-anchor="middle" x="598" y="-80972.47" font-family="Arial" font-size="10.00">Layer 0 QKV Proj GPU1</text>
<text text-anchor="middle" x="598" y="-80961.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="598" y="-80950.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- embed_ag&#45;&gt;layer0_qkv_1 -->
<g id="edge6" class="edge">
<title>embed_ag&#45;&gt;layer0_qkv_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M477.61,-81059.46C504.97,-81037.99 536.73,-81013.06 560.75,-80994.21"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="563.2,-80996.73 568.9,-80987.81 558.88,-80991.23 563.2,-80996.73"/>
</g>
<!-- layer0_attn_0 -->
<g id="node7" class="node">
<title>layer0_attn_0</title>
<path fill="#e6f3ff" stroke="black" d="M389,-80868.47C389,-80868.47 91,-80868.47 91,-80868.47 85,-80868.47 79,-80862.47 79,-80856.47 79,-80856.47 79,-80833.47 79,-80833.47 79,-80827.47 85,-80821.47 91,-80821.47 91,-80821.47 389,-80821.47 389,-80821.47 395,-80821.47 401,-80827.47 401,-80833.47 401,-80833.47 401,-80856.47 401,-80856.47 401,-80862.47 395,-80868.47 389,-80868.47"/>
<text text-anchor="middle" x="240" y="-80853.47" font-family="Arial" font-size="10.00">Layer 0 Attention GPU0</text>
<text text-anchor="middle" x="240" y="-80842.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="240" y="-80831.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer0_qkv_0&#45;&gt;layer0_attn_0 -->
<g id="edge7" class="edge">
<title>layer0_qkv_0&#45;&gt;layer0_attn_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M240,-80940.41C240,-80922.96 240,-80898.55 240,-80878.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="243.5,-80878.86 240,-80868.86 236.5,-80878.86 243.5,-80878.86"/>
</g>
<!-- layer0_attn_1 -->
<g id="node8" class="node">
<title>layer0_attn_1</title>
<path fill="#e6f3ff" stroke="black" d="M747,-80868.47C747,-80868.47 449,-80868.47 449,-80868.47 443,-80868.47 437,-80862.47 437,-80856.47 437,-80856.47 437,-80833.47 437,-80833.47 437,-80827.47 443,-80821.47 449,-80821.47 449,-80821.47 747,-80821.47 747,-80821.47 753,-80821.47 759,-80827.47 759,-80833.47 759,-80833.47 759,-80856.47 759,-80856.47 759,-80862.47 753,-80868.47 747,-80868.47"/>
<text text-anchor="middle" x="598" y="-80853.47" font-family="Arial" font-size="10.00">Layer 0 Attention GPU1</text>
<text text-anchor="middle" x="598" y="-80842.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="598" y="-80831.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer0_qkv_1&#45;&gt;layer0_attn_1 -->
<g id="edge8" class="edge">
<title>layer0_qkv_1&#45;&gt;layer0_attn_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M598,-80940.41C598,-80922.96 598,-80898.55 598,-80878.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="601.5,-80878.86 598,-80868.86 594.5,-80878.86 601.5,-80878.86"/>
</g>
<!-- layer0_attn_out_0 -->
<g id="node9" class="node">
<title>layer0_attn_out_0</title>
<path fill="#e6f3ff" stroke="black" d="M389,-80749.47C389,-80749.47 99,-80749.47 99,-80749.47 93,-80749.47 87,-80743.47 87,-80737.47 87,-80737.47 87,-80714.47 87,-80714.47 87,-80708.47 93,-80702.47 99,-80702.47 99,-80702.47 389,-80702.47 389,-80702.47 395,-80702.47 401,-80708.47 401,-80714.47 401,-80714.47 401,-80737.47 401,-80737.47 401,-80743.47 395,-80749.47 389,-80749.47"/>
<text text-anchor="middle" x="244" y="-80734.47" font-family="Arial" font-size="10.00">Layer 0 Attn Out GPU0</text>
<text text-anchor="middle" x="244" y="-80723.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="244" y="-80712.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer0_attn_0&#45;&gt;layer0_attn_out_0 -->
<g id="edge9" class="edge">
<title>layer0_attn_0&#45;&gt;layer0_attn_out_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M240.77,-80821.41C241.37,-80803.96 242.2,-80779.55 242.87,-80759.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="246.37,-80759.97 243.22,-80749.86 239.38,-80759.73 246.37,-80759.97"/>
</g>
<!-- layer0_attn_out_1 -->
<g id="node10" class="node">
<title>layer0_attn_out_1</title>
<path fill="#e6f3ff" stroke="black" d="M741,-80749.47C741,-80749.47 451,-80749.47 451,-80749.47 445,-80749.47 439,-80743.47 439,-80737.47 439,-80737.47 439,-80714.47 439,-80714.47 439,-80708.47 445,-80702.47 451,-80702.47 451,-80702.47 741,-80702.47 741,-80702.47 747,-80702.47 753,-80708.47 753,-80714.47 753,-80714.47 753,-80737.47 753,-80737.47 753,-80743.47 747,-80749.47 741,-80749.47"/>
<text text-anchor="middle" x="596" y="-80734.47" font-family="Arial" font-size="10.00">Layer 0 Attn Out GPU1</text>
<text text-anchor="middle" x="596" y="-80723.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="596" y="-80712.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer0_attn_1&#45;&gt;layer0_attn_out_1 -->
<g id="edge10" class="edge">
<title>layer0_attn_1&#45;&gt;layer0_attn_out_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M597.61,-80821.41C597.32,-80803.96 596.9,-80779.55 596.56,-80759.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="600.06,-80759.8 596.39,-80749.86 593.06,-80759.92 600.06,-80759.8"/>
</g>
<!-- layer0_attn_ar -->
<g id="node11" class="node">
<title>layer0_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M542.63,-80630.47C542.63,-80630.47 350.87,-80630.47 350.87,-80630.47 344.87,-80630.47 335.21,-80625.72 331.55,-80620.96 331.55,-80620.96 290.7,-80567.97 290.7,-80567.97 287.03,-80563.22 289.37,-80558.47 295.37,-80558.47 295.37,-80558.47 487.13,-80558.47 487.13,-80558.47 493.13,-80558.47 502.79,-80563.22 506.45,-80567.97 506.45,-80567.97 547.3,-80620.96 547.3,-80620.96 550.97,-80625.72 548.63,-80630.47 542.63,-80630.47"/>
<text text-anchor="middle" x="419" y="-80597.47" font-family="Arial" font-size="10.00">Layer 0 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="419" y="-80586.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer0_attn_out_0&#45;&gt;layer0_attn_ar -->
<g id="edge11" class="edge">
<title>layer0_attn_out_0&#45;&gt;layer0_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M274.48,-80702.41C298.92,-80684.33 333.86,-80658.47 363.27,-80636.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="365.45,-80639.45 371.4,-80630.69 361.28,-80633.82 365.45,-80639.45"/>
</g>
<!-- layer0_attn_out_1&#45;&gt;layer0_attn_ar -->
<g id="edge12" class="edge">
<title>layer0_attn_out_1&#45;&gt;layer0_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M565.17,-80702.41C540.45,-80684.33 505.11,-80658.47 475.37,-80636.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="477.28,-80633.77 467.14,-80630.69 473.14,-80639.42 477.28,-80633.77"/>
</g>
<!-- layer0_ffn1_0 -->
<g id="node12" class="node">
<title>layer0_ffn1_0</title>
<path fill="#e6f3ff" stroke="black" d="M389,-80486.47C389,-80486.47 119,-80486.47 119,-80486.47 113,-80486.47 107,-80480.47 107,-80474.47 107,-80474.47 107,-80451.47 107,-80451.47 107,-80445.47 113,-80439.47 119,-80439.47 119,-80439.47 389,-80439.47 389,-80439.47 395,-80439.47 401,-80445.47 401,-80451.47 401,-80451.47 401,-80474.47 401,-80474.47 401,-80480.47 395,-80486.47 389,-80486.47"/>
<text text-anchor="middle" x="254" y="-80471.47" font-family="Arial" font-size="10.00">Layer 0 FFN1 GPU0</text>
<text text-anchor="middle" x="254" y="-80460.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="254" y="-80449.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer0_attn_ar&#45;&gt;layer0_ffn1_0 -->
<g id="edge13" class="edge">
<title>layer0_attn_ar&#45;&gt;layer0_ffn1_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M374.35,-80558.42C348.28,-80537.96 315.78,-80512.45 291.12,-80493.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="293.11,-80490.21 283.08,-80486.79 288.79,-80495.72 293.11,-80490.21"/>
</g>
<!-- layer0_ffn1_1 -->
<g id="node13" class="node">
<title>layer0_ffn1_1</title>
<path fill="#e6f3ff" stroke="black" d="M719,-80486.47C719,-80486.47 449,-80486.47 449,-80486.47 443,-80486.47 437,-80480.47 437,-80474.47 437,-80474.47 437,-80451.47 437,-80451.47 437,-80445.47 443,-80439.47 449,-80439.47 449,-80439.47 719,-80439.47 719,-80439.47 725,-80439.47 731,-80445.47 731,-80451.47 731,-80451.47 731,-80474.47 731,-80474.47 731,-80480.47 725,-80486.47 719,-80486.47"/>
<text text-anchor="middle" x="584" y="-80471.47" font-family="Arial" font-size="10.00">Layer 0 FFN1 GPU1</text>
<text text-anchor="middle" x="584" y="-80460.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-80449.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer0_attn_ar&#45;&gt;layer0_ffn1_1 -->
<g id="edge14" class="edge">
<title>layer0_attn_ar&#45;&gt;layer0_ffn1_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M463.65,-80558.42C489.72,-80537.96 522.22,-80512.45 546.88,-80493.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="549.21,-80495.72 554.92,-80486.79 544.89,-80490.21 549.21,-80495.72"/>
</g>
<!-- layer0_act_0 -->
<g id="node14" class="node">
<title>layer0_act_0</title>
<path fill="#e6f3ff" stroke="black" d="M389,-80367.47C389,-80367.47 119,-80367.47 119,-80367.47 113,-80367.47 107,-80361.47 107,-80355.47 107,-80355.47 107,-80332.47 107,-80332.47 107,-80326.47 113,-80320.47 119,-80320.47 119,-80320.47 389,-80320.47 389,-80320.47 395,-80320.47 401,-80326.47 401,-80332.47 401,-80332.47 401,-80355.47 401,-80355.47 401,-80361.47 395,-80367.47 389,-80367.47"/>
<text text-anchor="middle" x="254" y="-80352.47" font-family="Arial" font-size="10.00">Layer 0 SiLU GPU0</text>
<text text-anchor="middle" x="254" y="-80341.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="254" y="-80330.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer0_ffn1_0&#45;&gt;layer0_act_0 -->
<g id="edge15" class="edge">
<title>layer0_ffn1_0&#45;&gt;layer0_act_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M254,-80439.41C254,-80421.96 254,-80397.55 254,-80377.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="257.5,-80377.86 254,-80367.86 250.5,-80377.86 257.5,-80377.86"/>
</g>
<!-- layer0_act_1 -->
<g id="node15" class="node">
<title>layer0_act_1</title>
<path fill="#e6f3ff" stroke="black" d="M719,-80367.47C719,-80367.47 449,-80367.47 449,-80367.47 443,-80367.47 437,-80361.47 437,-80355.47 437,-80355.47 437,-80332.47 437,-80332.47 437,-80326.47 443,-80320.47 449,-80320.47 449,-80320.47 719,-80320.47 719,-80320.47 725,-80320.47 731,-80326.47 731,-80332.47 731,-80332.47 731,-80355.47 731,-80355.47 731,-80361.47 725,-80367.47 719,-80367.47"/>
<text text-anchor="middle" x="584" y="-80352.47" font-family="Arial" font-size="10.00">Layer 0 SiLU GPU1</text>
<text text-anchor="middle" x="584" y="-80341.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="584" y="-80330.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer0_ffn1_1&#45;&gt;layer0_act_1 -->
<g id="edge16" class="edge">
<title>layer0_ffn1_1&#45;&gt;layer0_act_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M584,-80439.41C584,-80421.96 584,-80397.55 584,-80377.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="587.5,-80377.86 584,-80367.86 580.5,-80377.86 587.5,-80377.86"/>
</g>
<!-- layer0_ffn2_0 -->
<g id="node16" class="node">
<title>layer0_ffn2_0</title>
<path fill="#e6f3ff" stroke="black" d="M388.5,-80248.47C388.5,-80248.47 125.5,-80248.47 125.5,-80248.47 119.5,-80248.47 113.5,-80242.47 113.5,-80236.47 113.5,-80236.47 113.5,-80213.47 113.5,-80213.47 113.5,-80207.47 119.5,-80201.47 125.5,-80201.47 125.5,-80201.47 388.5,-80201.47 388.5,-80201.47 394.5,-80201.47 400.5,-80207.47 400.5,-80213.47 400.5,-80213.47 400.5,-80236.47 400.5,-80236.47 400.5,-80242.47 394.5,-80248.47 388.5,-80248.47"/>
<text text-anchor="middle" x="257" y="-80233.47" font-family="Arial" font-size="10.00">Layer 0 FFN2 GPU0</text>
<text text-anchor="middle" x="257" y="-80222.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="257" y="-80211.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer0_act_0&#45;&gt;layer0_ffn2_0 -->
<g id="edge17" class="edge">
<title>layer0_act_0&#45;&gt;layer0_ffn2_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M254.58,-80320.41C255.03,-80302.96 255.65,-80278.55 256.16,-80258.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="259.66,-80258.94 256.41,-80248.86 252.66,-80258.76 259.66,-80258.94"/>
</g>
<!-- layer0_ffn2_1 -->
<g id="node17" class="node">
<title>layer0_ffn2_1</title>
<path fill="#e6f3ff" stroke="black" d="M713.5,-80248.47C713.5,-80248.47 450.5,-80248.47 450.5,-80248.47 444.5,-80248.47 438.5,-80242.47 438.5,-80236.47 438.5,-80236.47 438.5,-80213.47 438.5,-80213.47 438.5,-80207.47 444.5,-80201.47 450.5,-80201.47 450.5,-80201.47 713.5,-80201.47 713.5,-80201.47 719.5,-80201.47 725.5,-80207.47 725.5,-80213.47 725.5,-80213.47 725.5,-80236.47 725.5,-80236.47 725.5,-80242.47 719.5,-80248.47 713.5,-80248.47"/>
<text text-anchor="middle" x="582" y="-80233.47" font-family="Arial" font-size="10.00">Layer 0 FFN2 GPU1</text>
<text text-anchor="middle" x="582" y="-80222.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="582" y="-80211.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer0_act_1&#45;&gt;layer0_ffn2_1 -->
<g id="edge18" class="edge">
<title>layer0_act_1&#45;&gt;layer0_ffn2_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M583.61,-80320.41C583.32,-80302.96 582.9,-80278.55 582.56,-80258.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="586.06,-80258.8 582.39,-80248.86 579.06,-80258.92 586.06,-80258.8"/>
</g>
<!-- layer0_ffn_ar -->
<g id="node18" class="node">
<title>layer0_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M544.85,-80129.47C544.85,-80129.47 347.97,-80129.47 347.97,-80129.47 341.97,-80129.47 332.25,-80124.76 328.54,-80120.05 328.54,-80120.05 286.58,-80066.89 286.58,-80066.89 282.87,-80062.18 285.15,-80057.47 291.15,-80057.47 291.15,-80057.47 488.03,-80057.47 488.03,-80057.47 494.03,-80057.47 503.75,-80062.18 507.46,-80066.89 507.46,-80066.89 549.42,-80120.05 549.42,-80120.05 553.13,-80124.76 550.85,-80129.47 544.85,-80129.47"/>
<text text-anchor="middle" x="418" y="-80096.47" font-family="Arial" font-size="10.00">Layer 0 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="418" y="-80085.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer0_ffn2_0&#45;&gt;layer0_ffn_ar -->
<g id="edge19" class="edge">
<title>layer0_ffn2_0&#45;&gt;layer0_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M285.04,-80201.41C307.43,-80183.41 339.4,-80157.69 366.38,-80135.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="368.61,-80138.68 374.21,-80129.69 364.23,-80133.23 368.61,-80138.68"/>
</g>
<!-- layer0_ffn2_1&#45;&gt;layer0_ffn_ar -->
<g id="edge20" class="edge">
<title>layer0_ffn2_1&#45;&gt;layer0_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M553.43,-80201.41C530.63,-80183.41 498.06,-80157.69 470.58,-80135.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="472.62,-80133.14 462.6,-80129.69 468.28,-80138.63 472.62,-80133.14"/>
</g>
<!-- layer1_qkv_0 -->
<g id="node19" class="node">
<title>layer1_qkv_0</title>
<path fill="#e6f3ff" stroke="black" d="M388,-79985.47C388,-79985.47 90,-79985.47 90,-79985.47 84,-79985.47 78,-79979.47 78,-79973.47 78,-79973.47 78,-79950.47 78,-79950.47 78,-79944.47 84,-79938.47 90,-79938.47 90,-79938.47 388,-79938.47 388,-79938.47 394,-79938.47 400,-79944.47 400,-79950.47 400,-79950.47 400,-79973.47 400,-79973.47 400,-79979.47 394,-79985.47 388,-79985.47"/>
<text text-anchor="middle" x="239" y="-79970.47" font-family="Arial" font-size="10.00">Layer 1 QKV Proj GPU0</text>
<text text-anchor="middle" x="239" y="-79959.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="239" y="-79948.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer0_ffn_ar&#45;&gt;layer1_qkv_0 -->
<g id="edge21" class="edge">
<title>layer0_ffn_ar&#45;&gt;layer1_qkv_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M369.56,-80057.42C341.06,-80036.81 305.48,-80011.06 278.66,-79991.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="280.43,-79988.62 270.28,-79985.6 276.33,-79994.3 280.43,-79988.62"/>
</g>
<!-- layer1_qkv_1 -->
<g id="node20" class="node">
<title>layer1_qkv_1</title>
<path fill="#e6f3ff" stroke="black" d="M746,-79985.47C746,-79985.47 448,-79985.47 448,-79985.47 442,-79985.47 436,-79979.47 436,-79973.47 436,-79973.47 436,-79950.47 436,-79950.47 436,-79944.47 442,-79938.47 448,-79938.47 448,-79938.47 746,-79938.47 746,-79938.47 752,-79938.47 758,-79944.47 758,-79950.47 758,-79950.47 758,-79973.47 758,-79973.47 758,-79979.47 752,-79985.47 746,-79985.47"/>
<text text-anchor="middle" x="597" y="-79970.47" font-family="Arial" font-size="10.00">Layer 1 QKV Proj GPU1</text>
<text text-anchor="middle" x="597" y="-79959.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="597" y="-79948.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer0_ffn_ar&#45;&gt;layer1_qkv_1 -->
<g id="edge22" class="edge">
<title>layer0_ffn_ar&#45;&gt;layer1_qkv_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M466.44,-80057.42C494.94,-80036.81 530.52,-80011.06 557.34,-79991.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="559.67,-79994.3 565.72,-79985.6 555.57,-79988.62 559.67,-79994.3"/>
</g>
<!-- layer1_attn_0 -->
<g id="node21" class="node">
<title>layer1_attn_0</title>
<path fill="#e6f3ff" stroke="black" d="M388,-79866.47C388,-79866.47 90,-79866.47 90,-79866.47 84,-79866.47 78,-79860.47 78,-79854.47 78,-79854.47 78,-79831.47 78,-79831.47 78,-79825.47 84,-79819.47 90,-79819.47 90,-79819.47 388,-79819.47 388,-79819.47 394,-79819.47 400,-79825.47 400,-79831.47 400,-79831.47 400,-79854.47 400,-79854.47 400,-79860.47 394,-79866.47 388,-79866.47"/>
<text text-anchor="middle" x="239" y="-79851.47" font-family="Arial" font-size="10.00">Layer 1 Attention GPU0</text>
<text text-anchor="middle" x="239" y="-79840.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="239" y="-79829.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer1_qkv_0&#45;&gt;layer1_attn_0 -->
<g id="edge23" class="edge">
<title>layer1_qkv_0&#45;&gt;layer1_attn_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M239,-79938.41C239,-79920.96 239,-79896.55 239,-79876.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="242.5,-79876.86 239,-79866.86 235.5,-79876.86 242.5,-79876.86"/>
</g>
<!-- layer1_attn_1 -->
<g id="node22" class="node">
<title>layer1_attn_1</title>
<path fill="#e6f3ff" stroke="black" d="M746,-79866.47C746,-79866.47 448,-79866.47 448,-79866.47 442,-79866.47 436,-79860.47 436,-79854.47 436,-79854.47 436,-79831.47 436,-79831.47 436,-79825.47 442,-79819.47 448,-79819.47 448,-79819.47 746,-79819.47 746,-79819.47 752,-79819.47 758,-79825.47 758,-79831.47 758,-79831.47 758,-79854.47 758,-79854.47 758,-79860.47 752,-79866.47 746,-79866.47"/>
<text text-anchor="middle" x="597" y="-79851.47" font-family="Arial" font-size="10.00">Layer 1 Attention GPU1</text>
<text text-anchor="middle" x="597" y="-79840.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="597" y="-79829.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer1_qkv_1&#45;&gt;layer1_attn_1 -->
<g id="edge24" class="edge">
<title>layer1_qkv_1&#45;&gt;layer1_attn_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M597,-79938.41C597,-79920.96 597,-79896.55 597,-79876.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="600.5,-79876.86 597,-79866.86 593.5,-79876.86 600.5,-79876.86"/>
</g>
<!-- layer1_attn_out_0 -->
<g id="node23" class="node">
<title>layer1_attn_out_0</title>
<path fill="#e6f3ff" stroke="black" d="M388,-79747.47C388,-79747.47 98,-79747.47 98,-79747.47 92,-79747.47 86,-79741.47 86,-79735.47 86,-79735.47 86,-79712.47 86,-79712.47 86,-79706.47 92,-79700.47 98,-79700.47 98,-79700.47 388,-79700.47 388,-79700.47 394,-79700.47 400,-79706.47 400,-79712.47 400,-79712.47 400,-79735.47 400,-79735.47 400,-79741.47 394,-79747.47 388,-79747.47"/>
<text text-anchor="middle" x="243" y="-79732.47" font-family="Arial" font-size="10.00">Layer 1 Attn Out GPU0</text>
<text text-anchor="middle" x="243" y="-79721.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="243" y="-79710.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer1_attn_0&#45;&gt;layer1_attn_out_0 -->
<g id="edge25" class="edge">
<title>layer1_attn_0&#45;&gt;layer1_attn_out_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M239.77,-79819.41C240.37,-79801.96 241.2,-79777.55 241.87,-79757.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="245.37,-79757.97 242.22,-79747.86 238.38,-79757.73 245.37,-79757.97"/>
</g>
<!-- layer1_attn_out_1 -->
<g id="node24" class="node">
<title>layer1_attn_out_1</title>
<path fill="#e6f3ff" stroke="black" d="M740,-79747.47C740,-79747.47 450,-79747.47 450,-79747.47 444,-79747.47 438,-79741.47 438,-79735.47 438,-79735.47 438,-79712.47 438,-79712.47 438,-79706.47 444,-79700.47 450,-79700.47 450,-79700.47 740,-79700.47 740,-79700.47 746,-79700.47 752,-79706.47 752,-79712.47 752,-79712.47 752,-79735.47 752,-79735.47 752,-79741.47 746,-79747.47 740,-79747.47"/>
<text text-anchor="middle" x="595" y="-79732.47" font-family="Arial" font-size="10.00">Layer 1 Attn Out GPU1</text>
<text text-anchor="middle" x="595" y="-79721.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="595" y="-79710.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer1_attn_1&#45;&gt;layer1_attn_out_1 -->
<g id="edge26" class="edge">
<title>layer1_attn_1&#45;&gt;layer1_attn_out_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M596.61,-79819.41C596.32,-79801.96 595.9,-79777.55 595.56,-79757.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="599.06,-79757.8 595.39,-79747.86 592.06,-79757.92 599.06,-79757.8"/>
</g>
<!-- layer1_attn_ar -->
<g id="node25" class="node">
<title>layer1_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M541.63,-79628.47C541.63,-79628.47 349.87,-79628.47 349.87,-79628.47 343.87,-79628.47 334.21,-79623.72 330.55,-79618.96 330.55,-79618.96 289.7,-79565.97 289.7,-79565.97 286.03,-79561.22 288.37,-79556.47 294.37,-79556.47 294.37,-79556.47 486.13,-79556.47 486.13,-79556.47 492.13,-79556.47 501.79,-79561.22 505.45,-79565.97 505.45,-79565.97 546.3,-79618.96 546.3,-79618.96 549.97,-79623.72 547.63,-79628.47 541.63,-79628.47"/>
<text text-anchor="middle" x="418" y="-79595.47" font-family="Arial" font-size="10.00">Layer 1 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="418" y="-79584.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer1_attn_out_0&#45;&gt;layer1_attn_ar -->
<g id="edge27" class="edge">
<title>layer1_attn_out_0&#45;&gt;layer1_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M273.48,-79700.41C297.92,-79682.33 332.86,-79656.47 362.27,-79634.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="364.45,-79637.45 370.4,-79628.69 360.28,-79631.82 364.45,-79637.45"/>
</g>
<!-- layer1_attn_out_1&#45;&gt;layer1_attn_ar -->
<g id="edge28" class="edge">
<title>layer1_attn_out_1&#45;&gt;layer1_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M564.17,-79700.41C539.45,-79682.33 504.11,-79656.47 474.37,-79634.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="476.28,-79631.77 466.14,-79628.69 472.14,-79637.42 476.28,-79631.77"/>
</g>
<!-- layer1_ffn1_0 -->
<g id="node26" class="node">
<title>layer1_ffn1_0</title>
<path fill="#e6f3ff" stroke="black" d="M388,-79484.47C388,-79484.47 118,-79484.47 118,-79484.47 112,-79484.47 106,-79478.47 106,-79472.47 106,-79472.47 106,-79449.47 106,-79449.47 106,-79443.47 112,-79437.47 118,-79437.47 118,-79437.47 388,-79437.47 388,-79437.47 394,-79437.47 400,-79443.47 400,-79449.47 400,-79449.47 400,-79472.47 400,-79472.47 400,-79478.47 394,-79484.47 388,-79484.47"/>
<text text-anchor="middle" x="253" y="-79469.47" font-family="Arial" font-size="10.00">Layer 1 FFN1 GPU0</text>
<text text-anchor="middle" x="253" y="-79458.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="253" y="-79447.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer1_attn_ar&#45;&gt;layer1_ffn1_0 -->
<g id="edge29" class="edge">
<title>layer1_attn_ar&#45;&gt;layer1_ffn1_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M373.35,-79556.42C347.28,-79535.96 314.78,-79510.45 290.12,-79491.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="292.11,-79488.21 282.08,-79484.79 287.79,-79493.72 292.11,-79488.21"/>
</g>
<!-- layer1_ffn1_1 -->
<g id="node27" class="node">
<title>layer1_ffn1_1</title>
<path fill="#e6f3ff" stroke="black" d="M718,-79484.47C718,-79484.47 448,-79484.47 448,-79484.47 442,-79484.47 436,-79478.47 436,-79472.47 436,-79472.47 436,-79449.47 436,-79449.47 436,-79443.47 442,-79437.47 448,-79437.47 448,-79437.47 718,-79437.47 718,-79437.47 724,-79437.47 730,-79443.47 730,-79449.47 730,-79449.47 730,-79472.47 730,-79472.47 730,-79478.47 724,-79484.47 718,-79484.47"/>
<text text-anchor="middle" x="583" y="-79469.47" font-family="Arial" font-size="10.00">Layer 1 FFN1 GPU1</text>
<text text-anchor="middle" x="583" y="-79458.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="583" y="-79447.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer1_attn_ar&#45;&gt;layer1_ffn1_1 -->
<g id="edge30" class="edge">
<title>layer1_attn_ar&#45;&gt;layer1_ffn1_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M462.65,-79556.42C488.72,-79535.96 521.22,-79510.45 545.88,-79491.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="548.21,-79493.72 553.92,-79484.79 543.89,-79488.21 548.21,-79493.72"/>
</g>
<!-- layer1_act_0 -->
<g id="node28" class="node">
<title>layer1_act_0</title>
<path fill="#e6f3ff" stroke="black" d="M388,-79365.47C388,-79365.47 118,-79365.47 118,-79365.47 112,-79365.47 106,-79359.47 106,-79353.47 106,-79353.47 106,-79330.47 106,-79330.47 106,-79324.47 112,-79318.47 118,-79318.47 118,-79318.47 388,-79318.47 388,-79318.47 394,-79318.47 400,-79324.47 400,-79330.47 400,-79330.47 400,-79353.47 400,-79353.47 400,-79359.47 394,-79365.47 388,-79365.47"/>
<text text-anchor="middle" x="253" y="-79350.47" font-family="Arial" font-size="10.00">Layer 1 SiLU GPU0</text>
<text text-anchor="middle" x="253" y="-79339.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="253" y="-79328.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer1_ffn1_0&#45;&gt;layer1_act_0 -->
<g id="edge31" class="edge">
<title>layer1_ffn1_0&#45;&gt;layer1_act_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M253,-79437.41C253,-79419.96 253,-79395.55 253,-79375.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="256.5,-79375.86 253,-79365.86 249.5,-79375.86 256.5,-79375.86"/>
</g>
<!-- layer1_act_1 -->
<g id="node29" class="node">
<title>layer1_act_1</title>
<path fill="#e6f3ff" stroke="black" d="M718,-79365.47C718,-79365.47 448,-79365.47 448,-79365.47 442,-79365.47 436,-79359.47 436,-79353.47 436,-79353.47 436,-79330.47 436,-79330.47 436,-79324.47 442,-79318.47 448,-79318.47 448,-79318.47 718,-79318.47 718,-79318.47 724,-79318.47 730,-79324.47 730,-79330.47 730,-79330.47 730,-79353.47 730,-79353.47 730,-79359.47 724,-79365.47 718,-79365.47"/>
<text text-anchor="middle" x="583" y="-79350.47" font-family="Arial" font-size="10.00">Layer 1 SiLU GPU1</text>
<text text-anchor="middle" x="583" y="-79339.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="583" y="-79328.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer1_ffn1_1&#45;&gt;layer1_act_1 -->
<g id="edge32" class="edge">
<title>layer1_ffn1_1&#45;&gt;layer1_act_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M583,-79437.41C583,-79419.96 583,-79395.55 583,-79375.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="586.5,-79375.86 583,-79365.86 579.5,-79375.86 586.5,-79375.86"/>
</g>
<!-- layer1_ffn2_0 -->
<g id="node30" class="node">
<title>layer1_ffn2_0</title>
<path fill="#e6f3ff" stroke="black" d="M387.5,-79246.47C387.5,-79246.47 124.5,-79246.47 124.5,-79246.47 118.5,-79246.47 112.5,-79240.47 112.5,-79234.47 112.5,-79234.47 112.5,-79211.47 112.5,-79211.47 112.5,-79205.47 118.5,-79199.47 124.5,-79199.47 124.5,-79199.47 387.5,-79199.47 387.5,-79199.47 393.5,-79199.47 399.5,-79205.47 399.5,-79211.47 399.5,-79211.47 399.5,-79234.47 399.5,-79234.47 399.5,-79240.47 393.5,-79246.47 387.5,-79246.47"/>
<text text-anchor="middle" x="256" y="-79231.47" font-family="Arial" font-size="10.00">Layer 1 FFN2 GPU0</text>
<text text-anchor="middle" x="256" y="-79220.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="256" y="-79209.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer1_act_0&#45;&gt;layer1_ffn2_0 -->
<g id="edge33" class="edge">
<title>layer1_act_0&#45;&gt;layer1_ffn2_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M253.58,-79318.41C254.03,-79300.96 254.65,-79276.55 255.16,-79256.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="258.66,-79256.94 255.41,-79246.86 251.66,-79256.76 258.66,-79256.94"/>
</g>
<!-- layer1_ffn2_1 -->
<g id="node31" class="node">
<title>layer1_ffn2_1</title>
<path fill="#e6f3ff" stroke="black" d="M712.5,-79246.47C712.5,-79246.47 449.5,-79246.47 449.5,-79246.47 443.5,-79246.47 437.5,-79240.47 437.5,-79234.47 437.5,-79234.47 437.5,-79211.47 437.5,-79211.47 437.5,-79205.47 443.5,-79199.47 449.5,-79199.47 449.5,-79199.47 712.5,-79199.47 712.5,-79199.47 718.5,-79199.47 724.5,-79205.47 724.5,-79211.47 724.5,-79211.47 724.5,-79234.47 724.5,-79234.47 724.5,-79240.47 718.5,-79246.47 712.5,-79246.47"/>
<text text-anchor="middle" x="581" y="-79231.47" font-family="Arial" font-size="10.00">Layer 1 FFN2 GPU1</text>
<text text-anchor="middle" x="581" y="-79220.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="581" y="-79209.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer1_act_1&#45;&gt;layer1_ffn2_1 -->
<g id="edge34" class="edge">
<title>layer1_act_1&#45;&gt;layer1_ffn2_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M582.61,-79318.41C582.32,-79300.96 581.9,-79276.55 581.56,-79256.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="585.06,-79256.8 581.39,-79246.86 578.06,-79256.92 585.06,-79256.8"/>
</g>
<!-- layer1_ffn_ar -->
<g id="node32" class="node">
<title>layer1_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M543.85,-79127.47C543.85,-79127.47 346.97,-79127.47 346.97,-79127.47 340.97,-79127.47 331.25,-79122.76 327.54,-79118.05 327.54,-79118.05 285.58,-79064.89 285.58,-79064.89 281.87,-79060.18 284.15,-79055.47 290.15,-79055.47 290.15,-79055.47 487.03,-79055.47 487.03,-79055.47 493.03,-79055.47 502.75,-79060.18 506.46,-79064.89 506.46,-79064.89 548.42,-79118.05 548.42,-79118.05 552.13,-79122.76 549.85,-79127.47 543.85,-79127.47"/>
<text text-anchor="middle" x="417" y="-79094.47" font-family="Arial" font-size="10.00">Layer 1 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="417" y="-79083.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer1_ffn2_0&#45;&gt;layer1_ffn_ar -->
<g id="edge35" class="edge">
<title>layer1_ffn2_0&#45;&gt;layer1_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M284.04,-79199.41C306.43,-79181.41 338.4,-79155.69 365.38,-79133.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="367.61,-79136.68 373.21,-79127.69 363.23,-79131.23 367.61,-79136.68"/>
</g>
<!-- layer1_ffn2_1&#45;&gt;layer1_ffn_ar -->
<g id="edge36" class="edge">
<title>layer1_ffn2_1&#45;&gt;layer1_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M552.43,-79199.41C529.63,-79181.41 497.06,-79155.69 469.58,-79133.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="471.62,-79131.14 461.6,-79127.69 467.28,-79136.63 471.62,-79131.14"/>
</g>
<!-- layer2_qkv_0 -->
<g id="node33" class="node">
<title>layer2_qkv_0</title>
<path fill="#e6f3ff" stroke="black" d="M387,-78983.47C387,-78983.47 89,-78983.47 89,-78983.47 83,-78983.47 77,-78977.47 77,-78971.47 77,-78971.47 77,-78948.47 77,-78948.47 77,-78942.47 83,-78936.47 89,-78936.47 89,-78936.47 387,-78936.47 387,-78936.47 393,-78936.47 399,-78942.47 399,-78948.47 399,-78948.47 399,-78971.47 399,-78971.47 399,-78977.47 393,-78983.47 387,-78983.47"/>
<text text-anchor="middle" x="238" y="-78968.47" font-family="Arial" font-size="10.00">Layer 2 QKV Proj GPU0</text>
<text text-anchor="middle" x="238" y="-78957.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="238" y="-78946.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer1_ffn_ar&#45;&gt;layer2_qkv_0 -->
<g id="edge37" class="edge">
<title>layer1_ffn_ar&#45;&gt;layer2_qkv_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M368.56,-79055.42C340.06,-79034.81 304.48,-79009.06 277.66,-78989.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="279.43,-78986.62 269.28,-78983.6 275.33,-78992.3 279.43,-78986.62"/>
</g>
<!-- layer2_qkv_1 -->
<g id="node34" class="node">
<title>layer2_qkv_1</title>
<path fill="#e6f3ff" stroke="black" d="M745,-78983.47C745,-78983.47 447,-78983.47 447,-78983.47 441,-78983.47 435,-78977.47 435,-78971.47 435,-78971.47 435,-78948.47 435,-78948.47 435,-78942.47 441,-78936.47 447,-78936.47 447,-78936.47 745,-78936.47 745,-78936.47 751,-78936.47 757,-78942.47 757,-78948.47 757,-78948.47 757,-78971.47 757,-78971.47 757,-78977.47 751,-78983.47 745,-78983.47"/>
<text text-anchor="middle" x="596" y="-78968.47" font-family="Arial" font-size="10.00">Layer 2 QKV Proj GPU1</text>
<text text-anchor="middle" x="596" y="-78957.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="596" y="-78946.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer1_ffn_ar&#45;&gt;layer2_qkv_1 -->
<g id="edge38" class="edge">
<title>layer1_ffn_ar&#45;&gt;layer2_qkv_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M465.44,-79055.42C493.94,-79034.81 529.52,-79009.06 556.34,-78989.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="558.67,-78992.3 564.72,-78983.6 554.57,-78986.62 558.67,-78992.3"/>
</g>
<!-- layer2_attn_0 -->
<g id="node35" class="node">
<title>layer2_attn_0</title>
<path fill="#e6f3ff" stroke="black" d="M387,-78864.47C387,-78864.47 89,-78864.47 89,-78864.47 83,-78864.47 77,-78858.47 77,-78852.47 77,-78852.47 77,-78829.47 77,-78829.47 77,-78823.47 83,-78817.47 89,-78817.47 89,-78817.47 387,-78817.47 387,-78817.47 393,-78817.47 399,-78823.47 399,-78829.47 399,-78829.47 399,-78852.47 399,-78852.47 399,-78858.47 393,-78864.47 387,-78864.47"/>
<text text-anchor="middle" x="238" y="-78849.47" font-family="Arial" font-size="10.00">Layer 2 Attention GPU0</text>
<text text-anchor="middle" x="238" y="-78838.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="238" y="-78827.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer2_qkv_0&#45;&gt;layer2_attn_0 -->
<g id="edge39" class="edge">
<title>layer2_qkv_0&#45;&gt;layer2_attn_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M238,-78936.41C238,-78918.96 238,-78894.55 238,-78874.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="241.5,-78874.86 238,-78864.86 234.5,-78874.86 241.5,-78874.86"/>
</g>
<!-- layer2_attn_1 -->
<g id="node36" class="node">
<title>layer2_attn_1</title>
<path fill="#e6f3ff" stroke="black" d="M745,-78864.47C745,-78864.47 447,-78864.47 447,-78864.47 441,-78864.47 435,-78858.47 435,-78852.47 435,-78852.47 435,-78829.47 435,-78829.47 435,-78823.47 441,-78817.47 447,-78817.47 447,-78817.47 745,-78817.47 745,-78817.47 751,-78817.47 757,-78823.47 757,-78829.47 757,-78829.47 757,-78852.47 757,-78852.47 757,-78858.47 751,-78864.47 745,-78864.47"/>
<text text-anchor="middle" x="596" y="-78849.47" font-family="Arial" font-size="10.00">Layer 2 Attention GPU1</text>
<text text-anchor="middle" x="596" y="-78838.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="596" y="-78827.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer2_qkv_1&#45;&gt;layer2_attn_1 -->
<g id="edge40" class="edge">
<title>layer2_qkv_1&#45;&gt;layer2_attn_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M596,-78936.41C596,-78918.96 596,-78894.55 596,-78874.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="599.5,-78874.86 596,-78864.86 592.5,-78874.86 599.5,-78874.86"/>
</g>
<!-- layer2_attn_out_0 -->
<g id="node37" class="node">
<title>layer2_attn_out_0</title>
<path fill="#e6f3ff" stroke="black" d="M387,-78745.47C387,-78745.47 97,-78745.47 97,-78745.47 91,-78745.47 85,-78739.47 85,-78733.47 85,-78733.47 85,-78710.47 85,-78710.47 85,-78704.47 91,-78698.47 97,-78698.47 97,-78698.47 387,-78698.47 387,-78698.47 393,-78698.47 399,-78704.47 399,-78710.47 399,-78710.47 399,-78733.47 399,-78733.47 399,-78739.47 393,-78745.47 387,-78745.47"/>
<text text-anchor="middle" x="242" y="-78730.47" font-family="Arial" font-size="10.00">Layer 2 Attn Out GPU0</text>
<text text-anchor="middle" x="242" y="-78719.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="242" y="-78708.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer2_attn_0&#45;&gt;layer2_attn_out_0 -->
<g id="edge41" class="edge">
<title>layer2_attn_0&#45;&gt;layer2_attn_out_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M238.77,-78817.41C239.37,-78799.96 240.2,-78775.55 240.87,-78755.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="244.37,-78755.97 241.22,-78745.86 237.38,-78755.73 244.37,-78755.97"/>
</g>
<!-- layer2_attn_out_1 -->
<g id="node38" class="node">
<title>layer2_attn_out_1</title>
<path fill="#e6f3ff" stroke="black" d="M739,-78745.47C739,-78745.47 449,-78745.47 449,-78745.47 443,-78745.47 437,-78739.47 437,-78733.47 437,-78733.47 437,-78710.47 437,-78710.47 437,-78704.47 443,-78698.47 449,-78698.47 449,-78698.47 739,-78698.47 739,-78698.47 745,-78698.47 751,-78704.47 751,-78710.47 751,-78710.47 751,-78733.47 751,-78733.47 751,-78739.47 745,-78745.47 739,-78745.47"/>
<text text-anchor="middle" x="594" y="-78730.47" font-family="Arial" font-size="10.00">Layer 2 Attn Out GPU1</text>
<text text-anchor="middle" x="594" y="-78719.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="594" y="-78708.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer2_attn_1&#45;&gt;layer2_attn_out_1 -->
<g id="edge42" class="edge">
<title>layer2_attn_1&#45;&gt;layer2_attn_out_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M595.61,-78817.41C595.32,-78799.96 594.9,-78775.55 594.56,-78755.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="598.06,-78755.8 594.39,-78745.86 591.06,-78755.92 598.06,-78755.8"/>
</g>
<!-- layer2_attn_ar -->
<g id="node39" class="node">
<title>layer2_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M540.63,-78626.47C540.63,-78626.47 348.87,-78626.47 348.87,-78626.47 342.87,-78626.47 333.21,-78621.72 329.55,-78616.96 329.55,-78616.96 288.7,-78563.97 288.7,-78563.97 285.03,-78559.22 287.37,-78554.47 293.37,-78554.47 293.37,-78554.47 485.13,-78554.47 485.13,-78554.47 491.13,-78554.47 500.79,-78559.22 504.45,-78563.97 504.45,-78563.97 545.3,-78616.96 545.3,-78616.96 548.97,-78621.72 546.63,-78626.47 540.63,-78626.47"/>
<text text-anchor="middle" x="417" y="-78593.47" font-family="Arial" font-size="10.00">Layer 2 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="417" y="-78582.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer2_attn_out_0&#45;&gt;layer2_attn_ar -->
<g id="edge43" class="edge">
<title>layer2_attn_out_0&#45;&gt;layer2_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M272.48,-78698.41C296.92,-78680.33 331.86,-78654.47 361.27,-78632.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="363.45,-78635.45 369.4,-78626.69 359.28,-78629.82 363.45,-78635.45"/>
</g>
<!-- layer2_attn_out_1&#45;&gt;layer2_attn_ar -->
<g id="edge44" class="edge">
<title>layer2_attn_out_1&#45;&gt;layer2_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M563.17,-78698.41C538.45,-78680.33 503.11,-78654.47 473.37,-78632.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="475.28,-78629.77 465.14,-78626.69 471.14,-78635.42 475.28,-78629.77"/>
</g>
<!-- layer2_ffn1_0 -->
<g id="node40" class="node">
<title>layer2_ffn1_0</title>
<path fill="#e6f3ff" stroke="black" d="M387,-78482.47C387,-78482.47 117,-78482.47 117,-78482.47 111,-78482.47 105,-78476.47 105,-78470.47 105,-78470.47 105,-78447.47 105,-78447.47 105,-78441.47 111,-78435.47 117,-78435.47 117,-78435.47 387,-78435.47 387,-78435.47 393,-78435.47 399,-78441.47 399,-78447.47 399,-78447.47 399,-78470.47 399,-78470.47 399,-78476.47 393,-78482.47 387,-78482.47"/>
<text text-anchor="middle" x="252" y="-78467.47" font-family="Arial" font-size="10.00">Layer 2 FFN1 GPU0</text>
<text text-anchor="middle" x="252" y="-78456.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="252" y="-78445.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer2_attn_ar&#45;&gt;layer2_ffn1_0 -->
<g id="edge45" class="edge">
<title>layer2_attn_ar&#45;&gt;layer2_ffn1_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M372.35,-78554.42C346.28,-78533.96 313.78,-78508.45 289.12,-78489.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="291.11,-78486.21 281.08,-78482.79 286.79,-78491.72 291.11,-78486.21"/>
</g>
<!-- layer2_ffn1_1 -->
<g id="node41" class="node">
<title>layer2_ffn1_1</title>
<path fill="#e6f3ff" stroke="black" d="M717,-78482.47C717,-78482.47 447,-78482.47 447,-78482.47 441,-78482.47 435,-78476.47 435,-78470.47 435,-78470.47 435,-78447.47 435,-78447.47 435,-78441.47 441,-78435.47 447,-78435.47 447,-78435.47 717,-78435.47 717,-78435.47 723,-78435.47 729,-78441.47 729,-78447.47 729,-78447.47 729,-78470.47 729,-78470.47 729,-78476.47 723,-78482.47 717,-78482.47"/>
<text text-anchor="middle" x="582" y="-78467.47" font-family="Arial" font-size="10.00">Layer 2 FFN1 GPU1</text>
<text text-anchor="middle" x="582" y="-78456.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="582" y="-78445.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer2_attn_ar&#45;&gt;layer2_ffn1_1 -->
<g id="edge46" class="edge">
<title>layer2_attn_ar&#45;&gt;layer2_ffn1_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M461.65,-78554.42C487.72,-78533.96 520.22,-78508.45 544.88,-78489.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="547.21,-78491.72 552.92,-78482.79 542.89,-78486.21 547.21,-78491.72"/>
</g>
<!-- layer2_act_0 -->
<g id="node42" class="node">
<title>layer2_act_0</title>
<path fill="#e6f3ff" stroke="black" d="M387,-78363.47C387,-78363.47 117,-78363.47 117,-78363.47 111,-78363.47 105,-78357.47 105,-78351.47 105,-78351.47 105,-78328.47 105,-78328.47 105,-78322.47 111,-78316.47 117,-78316.47 117,-78316.47 387,-78316.47 387,-78316.47 393,-78316.47 399,-78322.47 399,-78328.47 399,-78328.47 399,-78351.47 399,-78351.47 399,-78357.47 393,-78363.47 387,-78363.47"/>
<text text-anchor="middle" x="252" y="-78348.47" font-family="Arial" font-size="10.00">Layer 2 SiLU GPU0</text>
<text text-anchor="middle" x="252" y="-78337.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="252" y="-78326.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer2_ffn1_0&#45;&gt;layer2_act_0 -->
<g id="edge47" class="edge">
<title>layer2_ffn1_0&#45;&gt;layer2_act_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M252,-78435.41C252,-78417.96 252,-78393.55 252,-78373.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="255.5,-78373.86 252,-78363.86 248.5,-78373.86 255.5,-78373.86"/>
</g>
<!-- layer2_act_1 -->
<g id="node43" class="node">
<title>layer2_act_1</title>
<path fill="#e6f3ff" stroke="black" d="M717,-78363.47C717,-78363.47 447,-78363.47 447,-78363.47 441,-78363.47 435,-78357.47 435,-78351.47 435,-78351.47 435,-78328.47 435,-78328.47 435,-78322.47 441,-78316.47 447,-78316.47 447,-78316.47 717,-78316.47 717,-78316.47 723,-78316.47 729,-78322.47 729,-78328.47 729,-78328.47 729,-78351.47 729,-78351.47 729,-78357.47 723,-78363.47 717,-78363.47"/>
<text text-anchor="middle" x="582" y="-78348.47" font-family="Arial" font-size="10.00">Layer 2 SiLU GPU1</text>
<text text-anchor="middle" x="582" y="-78337.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="582" y="-78326.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer2_ffn1_1&#45;&gt;layer2_act_1 -->
<g id="edge48" class="edge">
<title>layer2_ffn1_1&#45;&gt;layer2_act_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M582,-78435.41C582,-78417.96 582,-78393.55 582,-78373.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="585.5,-78373.86 582,-78363.86 578.5,-78373.86 585.5,-78373.86"/>
</g>
<!-- layer2_ffn2_0 -->
<g id="node44" class="node">
<title>layer2_ffn2_0</title>
<path fill="#e6f3ff" stroke="black" d="M386.5,-78244.47C386.5,-78244.47 123.5,-78244.47 123.5,-78244.47 117.5,-78244.47 111.5,-78238.47 111.5,-78232.47 111.5,-78232.47 111.5,-78209.47 111.5,-78209.47 111.5,-78203.47 117.5,-78197.47 123.5,-78197.47 123.5,-78197.47 386.5,-78197.47 386.5,-78197.47 392.5,-78197.47 398.5,-78203.47 398.5,-78209.47 398.5,-78209.47 398.5,-78232.47 398.5,-78232.47 398.5,-78238.47 392.5,-78244.47 386.5,-78244.47"/>
<text text-anchor="middle" x="255" y="-78229.47" font-family="Arial" font-size="10.00">Layer 2 FFN2 GPU0</text>
<text text-anchor="middle" x="255" y="-78218.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="255" y="-78207.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer2_act_0&#45;&gt;layer2_ffn2_0 -->
<g id="edge49" class="edge">
<title>layer2_act_0&#45;&gt;layer2_ffn2_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M252.58,-78316.41C253.03,-78298.96 253.65,-78274.55 254.16,-78254.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="257.66,-78254.94 254.41,-78244.86 250.66,-78254.76 257.66,-78254.94"/>
</g>
<!-- layer2_ffn2_1 -->
<g id="node45" class="node">
<title>layer2_ffn2_1</title>
<path fill="#e6f3ff" stroke="black" d="M711.5,-78244.47C711.5,-78244.47 448.5,-78244.47 448.5,-78244.47 442.5,-78244.47 436.5,-78238.47 436.5,-78232.47 436.5,-78232.47 436.5,-78209.47 436.5,-78209.47 436.5,-78203.47 442.5,-78197.47 448.5,-78197.47 448.5,-78197.47 711.5,-78197.47 711.5,-78197.47 717.5,-78197.47 723.5,-78203.47 723.5,-78209.47 723.5,-78209.47 723.5,-78232.47 723.5,-78232.47 723.5,-78238.47 717.5,-78244.47 711.5,-78244.47"/>
<text text-anchor="middle" x="580" y="-78229.47" font-family="Arial" font-size="10.00">Layer 2 FFN2 GPU1</text>
<text text-anchor="middle" x="580" y="-78218.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="580" y="-78207.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer2_act_1&#45;&gt;layer2_ffn2_1 -->
<g id="edge50" class="edge">
<title>layer2_act_1&#45;&gt;layer2_ffn2_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M581.61,-78316.41C581.32,-78298.96 580.9,-78274.55 580.56,-78254.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="584.06,-78254.8 580.39,-78244.86 577.06,-78254.92 584.06,-78254.8"/>
</g>
<!-- layer2_ffn_ar -->
<g id="node46" class="node">
<title>layer2_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M542.85,-78125.47C542.85,-78125.47 345.97,-78125.47 345.97,-78125.47 339.97,-78125.47 330.25,-78120.76 326.54,-78116.05 326.54,-78116.05 284.58,-78062.89 284.58,-78062.89 280.87,-78058.18 283.15,-78053.47 289.15,-78053.47 289.15,-78053.47 486.03,-78053.47 486.03,-78053.47 492.03,-78053.47 501.75,-78058.18 505.46,-78062.89 505.46,-78062.89 547.42,-78116.05 547.42,-78116.05 551.13,-78120.76 548.85,-78125.47 542.85,-78125.47"/>
<text text-anchor="middle" x="416" y="-78092.47" font-family="Arial" font-size="10.00">Layer 2 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="416" y="-78081.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer2_ffn2_0&#45;&gt;layer2_ffn_ar -->
<g id="edge51" class="edge">
<title>layer2_ffn2_0&#45;&gt;layer2_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M283.04,-78197.41C305.43,-78179.41 337.4,-78153.69 364.38,-78131.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="366.61,-78134.68 372.21,-78125.69 362.23,-78129.23 366.61,-78134.68"/>
</g>
<!-- layer2_ffn2_1&#45;&gt;layer2_ffn_ar -->
<g id="edge52" class="edge">
<title>layer2_ffn2_1&#45;&gt;layer2_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M551.43,-78197.41C528.63,-78179.41 496.06,-78153.69 468.58,-78131.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="470.62,-78129.14 460.6,-78125.69 466.28,-78134.63 470.62,-78129.14"/>
</g>
<!-- layer3_qkv_0 -->
<g id="node47" class="node">
<title>layer3_qkv_0</title>
<path fill="#e6f3ff" stroke="black" d="M386,-77981.47C386,-77981.47 88,-77981.47 88,-77981.47 82,-77981.47 76,-77975.47 76,-77969.47 76,-77969.47 76,-77946.47 76,-77946.47 76,-77940.47 82,-77934.47 88,-77934.47 88,-77934.47 386,-77934.47 386,-77934.47 392,-77934.47 398,-77940.47 398,-77946.47 398,-77946.47 398,-77969.47 398,-77969.47 398,-77975.47 392,-77981.47 386,-77981.47"/>
<text text-anchor="middle" x="237" y="-77966.47" font-family="Arial" font-size="10.00">Layer 3 QKV Proj GPU0</text>
<text text-anchor="middle" x="237" y="-77955.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="237" y="-77944.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer2_ffn_ar&#45;&gt;layer3_qkv_0 -->
<g id="edge53" class="edge">
<title>layer2_ffn_ar&#45;&gt;layer3_qkv_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M367.56,-78053.42C339.06,-78032.81 303.48,-78007.06 276.66,-77987.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="278.43,-77984.62 268.28,-77981.6 274.33,-77990.3 278.43,-77984.62"/>
</g>
<!-- layer3_qkv_1 -->
<g id="node48" class="node">
<title>layer3_qkv_1</title>
<path fill="#e6f3ff" stroke="black" d="M744,-77981.47C744,-77981.47 446,-77981.47 446,-77981.47 440,-77981.47 434,-77975.47 434,-77969.47 434,-77969.47 434,-77946.47 434,-77946.47 434,-77940.47 440,-77934.47 446,-77934.47 446,-77934.47 744,-77934.47 744,-77934.47 750,-77934.47 756,-77940.47 756,-77946.47 756,-77946.47 756,-77969.47 756,-77969.47 756,-77975.47 750,-77981.47 744,-77981.47"/>
<text text-anchor="middle" x="595" y="-77966.47" font-family="Arial" font-size="10.00">Layer 3 QKV Proj GPU1</text>
<text text-anchor="middle" x="595" y="-77955.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="595" y="-77944.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer2_ffn_ar&#45;&gt;layer3_qkv_1 -->
<g id="edge54" class="edge">
<title>layer2_ffn_ar&#45;&gt;layer3_qkv_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M464.44,-78053.42C492.94,-78032.81 528.52,-78007.06 555.34,-77987.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="557.67,-77990.3 563.72,-77981.6 553.57,-77984.62 557.67,-77990.3"/>
</g>
<!-- layer3_attn_0 -->
<g id="node49" class="node">
<title>layer3_attn_0</title>
<path fill="#e6f3ff" stroke="black" d="M386,-77862.47C386,-77862.47 88,-77862.47 88,-77862.47 82,-77862.47 76,-77856.47 76,-77850.47 76,-77850.47 76,-77827.47 76,-77827.47 76,-77821.47 82,-77815.47 88,-77815.47 88,-77815.47 386,-77815.47 386,-77815.47 392,-77815.47 398,-77821.47 398,-77827.47 398,-77827.47 398,-77850.47 398,-77850.47 398,-77856.47 392,-77862.47 386,-77862.47"/>
<text text-anchor="middle" x="237" y="-77847.47" font-family="Arial" font-size="10.00">Layer 3 Attention GPU0</text>
<text text-anchor="middle" x="237" y="-77836.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="237" y="-77825.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer3_qkv_0&#45;&gt;layer3_attn_0 -->
<g id="edge55" class="edge">
<title>layer3_qkv_0&#45;&gt;layer3_attn_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M237,-77934.41C237,-77916.96 237,-77892.55 237,-77872.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="240.5,-77872.86 237,-77862.86 233.5,-77872.86 240.5,-77872.86"/>
</g>
<!-- layer3_attn_1 -->
<g id="node50" class="node">
<title>layer3_attn_1</title>
<path fill="#e6f3ff" stroke="black" d="M744,-77862.47C744,-77862.47 446,-77862.47 446,-77862.47 440,-77862.47 434,-77856.47 434,-77850.47 434,-77850.47 434,-77827.47 434,-77827.47 434,-77821.47 440,-77815.47 446,-77815.47 446,-77815.47 744,-77815.47 744,-77815.47 750,-77815.47 756,-77821.47 756,-77827.47 756,-77827.47 756,-77850.47 756,-77850.47 756,-77856.47 750,-77862.47 744,-77862.47"/>
<text text-anchor="middle" x="595" y="-77847.47" font-family="Arial" font-size="10.00">Layer 3 Attention GPU1</text>
<text text-anchor="middle" x="595" y="-77836.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="595" y="-77825.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer3_qkv_1&#45;&gt;layer3_attn_1 -->
<g id="edge56" class="edge">
<title>layer3_qkv_1&#45;&gt;layer3_attn_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M595,-77934.41C595,-77916.96 595,-77892.55 595,-77872.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="598.5,-77872.86 595,-77862.86 591.5,-77872.86 598.5,-77872.86"/>
</g>
<!-- layer3_attn_out_0 -->
<g id="node51" class="node">
<title>layer3_attn_out_0</title>
<path fill="#e6f3ff" stroke="black" d="M386,-77743.47C386,-77743.47 96,-77743.47 96,-77743.47 90,-77743.47 84,-77737.47 84,-77731.47 84,-77731.47 84,-77708.47 84,-77708.47 84,-77702.47 90,-77696.47 96,-77696.47 96,-77696.47 386,-77696.47 386,-77696.47 392,-77696.47 398,-77702.47 398,-77708.47 398,-77708.47 398,-77731.47 398,-77731.47 398,-77737.47 392,-77743.47 386,-77743.47"/>
<text text-anchor="middle" x="241" y="-77728.47" font-family="Arial" font-size="10.00">Layer 3 Attn Out GPU0</text>
<text text-anchor="middle" x="241" y="-77717.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="241" y="-77706.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer3_attn_0&#45;&gt;layer3_attn_out_0 -->
<g id="edge57" class="edge">
<title>layer3_attn_0&#45;&gt;layer3_attn_out_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M237.77,-77815.41C238.37,-77797.96 239.2,-77773.55 239.87,-77753.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="243.37,-77753.97 240.22,-77743.86 236.38,-77753.73 243.37,-77753.97"/>
</g>
<!-- layer3_attn_out_1 -->
<g id="node52" class="node">
<title>layer3_attn_out_1</title>
<path fill="#e6f3ff" stroke="black" d="M738,-77743.47C738,-77743.47 448,-77743.47 448,-77743.47 442,-77743.47 436,-77737.47 436,-77731.47 436,-77731.47 436,-77708.47 436,-77708.47 436,-77702.47 442,-77696.47 448,-77696.47 448,-77696.47 738,-77696.47 738,-77696.47 744,-77696.47 750,-77702.47 750,-77708.47 750,-77708.47 750,-77731.47 750,-77731.47 750,-77737.47 744,-77743.47 738,-77743.47"/>
<text text-anchor="middle" x="593" y="-77728.47" font-family="Arial" font-size="10.00">Layer 3 Attn Out GPU1</text>
<text text-anchor="middle" x="593" y="-77717.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="593" y="-77706.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer3_attn_1&#45;&gt;layer3_attn_out_1 -->
<g id="edge58" class="edge">
<title>layer3_attn_1&#45;&gt;layer3_attn_out_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M594.61,-77815.41C594.32,-77797.96 593.9,-77773.55 593.56,-77753.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="597.06,-77753.8 593.39,-77743.86 590.06,-77753.92 597.06,-77753.8"/>
</g>
<!-- layer3_attn_ar -->
<g id="node53" class="node">
<title>layer3_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M539.63,-77624.47C539.63,-77624.47 347.87,-77624.47 347.87,-77624.47 341.87,-77624.47 332.21,-77619.72 328.55,-77614.96 328.55,-77614.96 287.7,-77561.97 287.7,-77561.97 284.03,-77557.22 286.37,-77552.47 292.37,-77552.47 292.37,-77552.47 484.13,-77552.47 484.13,-77552.47 490.13,-77552.47 499.79,-77557.22 503.45,-77561.97 503.45,-77561.97 544.3,-77614.96 544.3,-77614.96 547.97,-77619.72 545.63,-77624.47 539.63,-77624.47"/>
<text text-anchor="middle" x="416" y="-77591.47" font-family="Arial" font-size="10.00">Layer 3 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="416" y="-77580.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer3_attn_out_0&#45;&gt;layer3_attn_ar -->
<g id="edge59" class="edge">
<title>layer3_attn_out_0&#45;&gt;layer3_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M271.48,-77696.41C295.92,-77678.33 330.86,-77652.47 360.27,-77630.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="362.45,-77633.45 368.4,-77624.69 358.28,-77627.82 362.45,-77633.45"/>
</g>
<!-- layer3_attn_out_1&#45;&gt;layer3_attn_ar -->
<g id="edge60" class="edge">
<title>layer3_attn_out_1&#45;&gt;layer3_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M562.17,-77696.41C537.45,-77678.33 502.11,-77652.47 472.37,-77630.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="474.28,-77627.77 464.14,-77624.69 470.14,-77633.42 474.28,-77627.77"/>
</g>
<!-- layer3_ffn1_0 -->
<g id="node54" class="node">
<title>layer3_ffn1_0</title>
<path fill="#e6f3ff" stroke="black" d="M386,-77480.47C386,-77480.47 116,-77480.47 116,-77480.47 110,-77480.47 104,-77474.47 104,-77468.47 104,-77468.47 104,-77445.47 104,-77445.47 104,-77439.47 110,-77433.47 116,-77433.47 116,-77433.47 386,-77433.47 386,-77433.47 392,-77433.47 398,-77439.47 398,-77445.47 398,-77445.47 398,-77468.47 398,-77468.47 398,-77474.47 392,-77480.47 386,-77480.47"/>
<text text-anchor="middle" x="251" y="-77465.47" font-family="Arial" font-size="10.00">Layer 3 FFN1 GPU0</text>
<text text-anchor="middle" x="251" y="-77454.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="251" y="-77443.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer3_attn_ar&#45;&gt;layer3_ffn1_0 -->
<g id="edge61" class="edge">
<title>layer3_attn_ar&#45;&gt;layer3_ffn1_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M371.35,-77552.42C345.28,-77531.96 312.78,-77506.45 288.12,-77487.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="290.11,-77484.21 280.08,-77480.79 285.79,-77489.72 290.11,-77484.21"/>
</g>
<!-- layer3_ffn1_1 -->
<g id="node55" class="node">
<title>layer3_ffn1_1</title>
<path fill="#e6f3ff" stroke="black" d="M716,-77480.47C716,-77480.47 446,-77480.47 446,-77480.47 440,-77480.47 434,-77474.47 434,-77468.47 434,-77468.47 434,-77445.47 434,-77445.47 434,-77439.47 440,-77433.47 446,-77433.47 446,-77433.47 716,-77433.47 716,-77433.47 722,-77433.47 728,-77439.47 728,-77445.47 728,-77445.47 728,-77468.47 728,-77468.47 728,-77474.47 722,-77480.47 716,-77480.47"/>
<text text-anchor="middle" x="581" y="-77465.47" font-family="Arial" font-size="10.00">Layer 3 FFN1 GPU1</text>
<text text-anchor="middle" x="581" y="-77454.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="581" y="-77443.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer3_attn_ar&#45;&gt;layer3_ffn1_1 -->
<g id="edge62" class="edge">
<title>layer3_attn_ar&#45;&gt;layer3_ffn1_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M460.65,-77552.42C486.72,-77531.96 519.22,-77506.45 543.88,-77487.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="546.21,-77489.72 551.92,-77480.79 541.89,-77484.21 546.21,-77489.72"/>
</g>
<!-- layer3_act_0 -->
<g id="node56" class="node">
<title>layer3_act_0</title>
<path fill="#e6f3ff" stroke="black" d="M386,-77361.47C386,-77361.47 116,-77361.47 116,-77361.47 110,-77361.47 104,-77355.47 104,-77349.47 104,-77349.47 104,-77326.47 104,-77326.47 104,-77320.47 110,-77314.47 116,-77314.47 116,-77314.47 386,-77314.47 386,-77314.47 392,-77314.47 398,-77320.47 398,-77326.47 398,-77326.47 398,-77349.47 398,-77349.47 398,-77355.47 392,-77361.47 386,-77361.47"/>
<text text-anchor="middle" x="251" y="-77346.47" font-family="Arial" font-size="10.00">Layer 3 SiLU GPU0</text>
<text text-anchor="middle" x="251" y="-77335.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="251" y="-77324.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer3_ffn1_0&#45;&gt;layer3_act_0 -->
<g id="edge63" class="edge">
<title>layer3_ffn1_0&#45;&gt;layer3_act_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M251,-77433.41C251,-77415.96 251,-77391.55 251,-77371.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="254.5,-77371.86 251,-77361.86 247.5,-77371.86 254.5,-77371.86"/>
</g>
<!-- layer3_act_1 -->
<g id="node57" class="node">
<title>layer3_act_1</title>
<path fill="#e6f3ff" stroke="black" d="M716,-77361.47C716,-77361.47 446,-77361.47 446,-77361.47 440,-77361.47 434,-77355.47 434,-77349.47 434,-77349.47 434,-77326.47 434,-77326.47 434,-77320.47 440,-77314.47 446,-77314.47 446,-77314.47 716,-77314.47 716,-77314.47 722,-77314.47 728,-77320.47 728,-77326.47 728,-77326.47 728,-77349.47 728,-77349.47 728,-77355.47 722,-77361.47 716,-77361.47"/>
<text text-anchor="middle" x="581" y="-77346.47" font-family="Arial" font-size="10.00">Layer 3 SiLU GPU1</text>
<text text-anchor="middle" x="581" y="-77335.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="581" y="-77324.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer3_ffn1_1&#45;&gt;layer3_act_1 -->
<g id="edge64" class="edge">
<title>layer3_ffn1_1&#45;&gt;layer3_act_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M581,-77433.41C581,-77415.96 581,-77391.55 581,-77371.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="584.5,-77371.86 581,-77361.86 577.5,-77371.86 584.5,-77371.86"/>
</g>
<!-- layer3_ffn2_0 -->
<g id="node58" class="node">
<title>layer3_ffn2_0</title>
<path fill="#e6f3ff" stroke="black" d="M385.5,-77242.47C385.5,-77242.47 122.5,-77242.47 122.5,-77242.47 116.5,-77242.47 110.5,-77236.47 110.5,-77230.47 110.5,-77230.47 110.5,-77207.47 110.5,-77207.47 110.5,-77201.47 116.5,-77195.47 122.5,-77195.47 122.5,-77195.47 385.5,-77195.47 385.5,-77195.47 391.5,-77195.47 397.5,-77201.47 397.5,-77207.47 397.5,-77207.47 397.5,-77230.47 397.5,-77230.47 397.5,-77236.47 391.5,-77242.47 385.5,-77242.47"/>
<text text-anchor="middle" x="254" y="-77227.47" font-family="Arial" font-size="10.00">Layer 3 FFN2 GPU0</text>
<text text-anchor="middle" x="254" y="-77216.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="254" y="-77205.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer3_act_0&#45;&gt;layer3_ffn2_0 -->
<g id="edge65" class="edge">
<title>layer3_act_0&#45;&gt;layer3_ffn2_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M251.58,-77314.41C252.03,-77296.96 252.65,-77272.55 253.16,-77252.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="256.66,-77252.94 253.41,-77242.86 249.66,-77252.76 256.66,-77252.94"/>
</g>
<!-- layer3_ffn2_1 -->
<g id="node59" class="node">
<title>layer3_ffn2_1</title>
<path fill="#e6f3ff" stroke="black" d="M710.5,-77242.47C710.5,-77242.47 447.5,-77242.47 447.5,-77242.47 441.5,-77242.47 435.5,-77236.47 435.5,-77230.47 435.5,-77230.47 435.5,-77207.47 435.5,-77207.47 435.5,-77201.47 441.5,-77195.47 447.5,-77195.47 447.5,-77195.47 710.5,-77195.47 710.5,-77195.47 716.5,-77195.47 722.5,-77201.47 722.5,-77207.47 722.5,-77207.47 722.5,-77230.47 722.5,-77230.47 722.5,-77236.47 716.5,-77242.47 710.5,-77242.47"/>
<text text-anchor="middle" x="579" y="-77227.47" font-family="Arial" font-size="10.00">Layer 3 FFN2 GPU1</text>
<text text-anchor="middle" x="579" y="-77216.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="579" y="-77205.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer3_act_1&#45;&gt;layer3_ffn2_1 -->
<g id="edge66" class="edge">
<title>layer3_act_1&#45;&gt;layer3_ffn2_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M580.61,-77314.41C580.32,-77296.96 579.9,-77272.55 579.56,-77252.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="583.06,-77252.8 579.39,-77242.86 576.06,-77252.92 583.06,-77252.8"/>
</g>
<!-- layer3_ffn_ar -->
<g id="node60" class="node">
<title>layer3_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M541.85,-77123.47C541.85,-77123.47 344.97,-77123.47 344.97,-77123.47 338.97,-77123.47 329.25,-77118.76 325.54,-77114.05 325.54,-77114.05 283.58,-77060.89 283.58,-77060.89 279.87,-77056.18 282.15,-77051.47 288.15,-77051.47 288.15,-77051.47 485.03,-77051.47 485.03,-77051.47 491.03,-77051.47 500.75,-77056.18 504.46,-77060.89 504.46,-77060.89 546.42,-77114.05 546.42,-77114.05 550.13,-77118.76 547.85,-77123.47 541.85,-77123.47"/>
<text text-anchor="middle" x="415" y="-77090.47" font-family="Arial" font-size="10.00">Layer 3 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="415" y="-77079.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer3_ffn2_0&#45;&gt;layer3_ffn_ar -->
<g id="edge67" class="edge">
<title>layer3_ffn2_0&#45;&gt;layer3_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M282.04,-77195.41C304.43,-77177.41 336.4,-77151.69 363.38,-77129.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="365.61,-77132.68 371.21,-77123.69 361.23,-77127.23 365.61,-77132.68"/>
</g>
<!-- layer3_ffn2_1&#45;&gt;layer3_ffn_ar -->
<g id="edge68" class="edge">
<title>layer3_ffn2_1&#45;&gt;layer3_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M550.43,-77195.41C527.63,-77177.41 495.06,-77151.69 467.58,-77129.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="469.62,-77127.14 459.6,-77123.69 465.28,-77132.63 469.62,-77127.14"/>
</g>
<!-- layer4_qkv_0 -->
<g id="node61" class="node">
<title>layer4_qkv_0</title>
<path fill="#e6f3ff" stroke="black" d="M385,-76979.47C385,-76979.47 87,-76979.47 87,-76979.47 81,-76979.47 75,-76973.47 75,-76967.47 75,-76967.47 75,-76944.47 75,-76944.47 75,-76938.47 81,-76932.47 87,-76932.47 87,-76932.47 385,-76932.47 385,-76932.47 391,-76932.47 397,-76938.47 397,-76944.47 397,-76944.47 397,-76967.47 397,-76967.47 397,-76973.47 391,-76979.47 385,-76979.47"/>
<text text-anchor="middle" x="236" y="-76964.47" font-family="Arial" font-size="10.00">Layer 4 QKV Proj GPU0</text>
<text text-anchor="middle" x="236" y="-76953.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="236" y="-76942.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer3_ffn_ar&#45;&gt;layer4_qkv_0 -->
<g id="edge69" class="edge">
<title>layer3_ffn_ar&#45;&gt;layer4_qkv_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M366.56,-77051.42C338.06,-77030.81 302.48,-77005.06 275.66,-76985.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="277.43,-76982.62 267.28,-76979.6 273.33,-76988.3 277.43,-76982.62"/>
</g>
<!-- layer4_qkv_1 -->
<g id="node62" class="node">
<title>layer4_qkv_1</title>
<path fill="#e6f3ff" stroke="black" d="M743,-76979.47C743,-76979.47 445,-76979.47 445,-76979.47 439,-76979.47 433,-76973.47 433,-76967.47 433,-76967.47 433,-76944.47 433,-76944.47 433,-76938.47 439,-76932.47 445,-76932.47 445,-76932.47 743,-76932.47 743,-76932.47 749,-76932.47 755,-76938.47 755,-76944.47 755,-76944.47 755,-76967.47 755,-76967.47 755,-76973.47 749,-76979.47 743,-76979.47"/>
<text text-anchor="middle" x="594" y="-76964.47" font-family="Arial" font-size="10.00">Layer 4 QKV Proj GPU1</text>
<text text-anchor="middle" x="594" y="-76953.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="594" y="-76942.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer3_ffn_ar&#45;&gt;layer4_qkv_1 -->
<g id="edge70" class="edge">
<title>layer3_ffn_ar&#45;&gt;layer4_qkv_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M463.44,-77051.42C491.94,-77030.81 527.52,-77005.06 554.34,-76985.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="556.67,-76988.3 562.72,-76979.6 552.57,-76982.62 556.67,-76988.3"/>
</g>
<!-- layer4_attn_0 -->
<g id="node63" class="node">
<title>layer4_attn_0</title>
<path fill="#e6f3ff" stroke="black" d="M385,-76860.47C385,-76860.47 87,-76860.47 87,-76860.47 81,-76860.47 75,-76854.47 75,-76848.47 75,-76848.47 75,-76825.47 75,-76825.47 75,-76819.47 81,-76813.47 87,-76813.47 87,-76813.47 385,-76813.47 385,-76813.47 391,-76813.47 397,-76819.47 397,-76825.47 397,-76825.47 397,-76848.47 397,-76848.47 397,-76854.47 391,-76860.47 385,-76860.47"/>
<text text-anchor="middle" x="236" y="-76845.47" font-family="Arial" font-size="10.00">Layer 4 Attention GPU0</text>
<text text-anchor="middle" x="236" y="-76834.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="236" y="-76823.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer4_qkv_0&#45;&gt;layer4_attn_0 -->
<g id="edge71" class="edge">
<title>layer4_qkv_0&#45;&gt;layer4_attn_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M236,-76932.41C236,-76914.96 236,-76890.55 236,-76870.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="239.5,-76870.86 236,-76860.86 232.5,-76870.86 239.5,-76870.86"/>
</g>
<!-- layer4_attn_1 -->
<g id="node64" class="node">
<title>layer4_attn_1</title>
<path fill="#e6f3ff" stroke="black" d="M743,-76860.47C743,-76860.47 445,-76860.47 445,-76860.47 439,-76860.47 433,-76854.47 433,-76848.47 433,-76848.47 433,-76825.47 433,-76825.47 433,-76819.47 439,-76813.47 445,-76813.47 445,-76813.47 743,-76813.47 743,-76813.47 749,-76813.47 755,-76819.47 755,-76825.47 755,-76825.47 755,-76848.47 755,-76848.47 755,-76854.47 749,-76860.47 743,-76860.47"/>
<text text-anchor="middle" x="594" y="-76845.47" font-family="Arial" font-size="10.00">Layer 4 Attention GPU1</text>
<text text-anchor="middle" x="594" y="-76834.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="594" y="-76823.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer4_qkv_1&#45;&gt;layer4_attn_1 -->
<g id="edge72" class="edge">
<title>layer4_qkv_1&#45;&gt;layer4_attn_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M594,-76932.41C594,-76914.96 594,-76890.55 594,-76870.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="597.5,-76870.86 594,-76860.86 590.5,-76870.86 597.5,-76870.86"/>
</g>
<!-- layer4_attn_out_0 -->
<g id="node65" class="node">
<title>layer4_attn_out_0</title>
<path fill="#e6f3ff" stroke="black" d="M385,-76741.47C385,-76741.47 95,-76741.47 95,-76741.47 89,-76741.47 83,-76735.47 83,-76729.47 83,-76729.47 83,-76706.47 83,-76706.47 83,-76700.47 89,-76694.47 95,-76694.47 95,-76694.47 385,-76694.47 385,-76694.47 391,-76694.47 397,-76700.47 397,-76706.47 397,-76706.47 397,-76729.47 397,-76729.47 397,-76735.47 391,-76741.47 385,-76741.47"/>
<text text-anchor="middle" x="240" y="-76726.47" font-family="Arial" font-size="10.00">Layer 4 Attn Out GPU0</text>
<text text-anchor="middle" x="240" y="-76715.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="240" y="-76704.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer4_attn_0&#45;&gt;layer4_attn_out_0 -->
<g id="edge73" class="edge">
<title>layer4_attn_0&#45;&gt;layer4_attn_out_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M236.77,-76813.41C237.37,-76795.96 238.2,-76771.55 238.87,-76751.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="242.37,-76751.97 239.22,-76741.86 235.38,-76751.73 242.37,-76751.97"/>
</g>
<!-- layer4_attn_out_1 -->
<g id="node66" class="node">
<title>layer4_attn_out_1</title>
<path fill="#e6f3ff" stroke="black" d="M737,-76741.47C737,-76741.47 447,-76741.47 447,-76741.47 441,-76741.47 435,-76735.47 435,-76729.47 435,-76729.47 435,-76706.47 435,-76706.47 435,-76700.47 441,-76694.47 447,-76694.47 447,-76694.47 737,-76694.47 737,-76694.47 743,-76694.47 749,-76700.47 749,-76706.47 749,-76706.47 749,-76729.47 749,-76729.47 749,-76735.47 743,-76741.47 737,-76741.47"/>
<text text-anchor="middle" x="592" y="-76726.47" font-family="Arial" font-size="10.00">Layer 4 Attn Out GPU1</text>
<text text-anchor="middle" x="592" y="-76715.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="592" y="-76704.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer4_attn_1&#45;&gt;layer4_attn_out_1 -->
<g id="edge74" class="edge">
<title>layer4_attn_1&#45;&gt;layer4_attn_out_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M593.61,-76813.41C593.32,-76795.96 592.9,-76771.55 592.56,-76751.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="596.06,-76751.8 592.39,-76741.86 589.06,-76751.92 596.06,-76751.8"/>
</g>
<!-- layer4_attn_ar -->
<g id="node67" class="node">
<title>layer4_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M538.63,-76622.47C538.63,-76622.47 346.87,-76622.47 346.87,-76622.47 340.87,-76622.47 331.21,-76617.72 327.55,-76612.96 327.55,-76612.96 286.7,-76559.97 286.7,-76559.97 283.03,-76555.22 285.37,-76550.47 291.37,-76550.47 291.37,-76550.47 483.13,-76550.47 483.13,-76550.47 489.13,-76550.47 498.79,-76555.22 502.45,-76559.97 502.45,-76559.97 543.3,-76612.96 543.3,-76612.96 546.97,-76617.72 544.63,-76622.47 538.63,-76622.47"/>
<text text-anchor="middle" x="415" y="-76589.47" font-family="Arial" font-size="10.00">Layer 4 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="415" y="-76578.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer4_attn_out_0&#45;&gt;layer4_attn_ar -->
<g id="edge75" class="edge">
<title>layer4_attn_out_0&#45;&gt;layer4_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M270.48,-76694.41C294.92,-76676.33 329.86,-76650.47 359.27,-76628.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="361.45,-76631.45 367.4,-76622.69 357.28,-76625.82 361.45,-76631.45"/>
</g>
<!-- layer4_attn_out_1&#45;&gt;layer4_attn_ar -->
<g id="edge76" class="edge">
<title>layer4_attn_out_1&#45;&gt;layer4_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M561.17,-76694.41C536.45,-76676.33 501.11,-76650.47 471.37,-76628.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="473.28,-76625.77 463.14,-76622.69 469.14,-76631.42 473.28,-76625.77"/>
</g>
<!-- layer4_ffn1_0 -->
<g id="node68" class="node">
<title>layer4_ffn1_0</title>
<path fill="#e6f3ff" stroke="black" d="M385,-76478.47C385,-76478.47 115,-76478.47 115,-76478.47 109,-76478.47 103,-76472.47 103,-76466.47 103,-76466.47 103,-76443.47 103,-76443.47 103,-76437.47 109,-76431.47 115,-76431.47 115,-76431.47 385,-76431.47 385,-76431.47 391,-76431.47 397,-76437.47 397,-76443.47 397,-76443.47 397,-76466.47 397,-76466.47 397,-76472.47 391,-76478.47 385,-76478.47"/>
<text text-anchor="middle" x="250" y="-76463.47" font-family="Arial" font-size="10.00">Layer 4 FFN1 GPU0</text>
<text text-anchor="middle" x="250" y="-76452.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="250" y="-76441.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer4_attn_ar&#45;&gt;layer4_ffn1_0 -->
<g id="edge77" class="edge">
<title>layer4_attn_ar&#45;&gt;layer4_ffn1_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M370.35,-76550.42C344.28,-76529.96 311.78,-76504.45 287.12,-76485.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="289.11,-76482.21 279.08,-76478.79 284.79,-76487.72 289.11,-76482.21"/>
</g>
<!-- layer4_ffn1_1 -->
<g id="node69" class="node">
<title>layer4_ffn1_1</title>
<path fill="#e6f3ff" stroke="black" d="M715,-76478.47C715,-76478.47 445,-76478.47 445,-76478.47 439,-76478.47 433,-76472.47 433,-76466.47 433,-76466.47 433,-76443.47 433,-76443.47 433,-76437.47 439,-76431.47 445,-76431.47 445,-76431.47 715,-76431.47 715,-76431.47 721,-76431.47 727,-76437.47 727,-76443.47 727,-76443.47 727,-76466.47 727,-76466.47 727,-76472.47 721,-76478.47 715,-76478.47"/>
<text text-anchor="middle" x="580" y="-76463.47" font-family="Arial" font-size="10.00">Layer 4 FFN1 GPU1</text>
<text text-anchor="middle" x="580" y="-76452.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="580" y="-76441.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer4_attn_ar&#45;&gt;layer4_ffn1_1 -->
<g id="edge78" class="edge">
<title>layer4_attn_ar&#45;&gt;layer4_ffn1_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M459.65,-76550.42C485.72,-76529.96 518.22,-76504.45 542.88,-76485.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="545.21,-76487.72 550.92,-76478.79 540.89,-76482.21 545.21,-76487.72"/>
</g>
<!-- layer4_act_0 -->
<g id="node70" class="node">
<title>layer4_act_0</title>
<path fill="#e6f3ff" stroke="black" d="M385,-76359.47C385,-76359.47 115,-76359.47 115,-76359.47 109,-76359.47 103,-76353.47 103,-76347.47 103,-76347.47 103,-76324.47 103,-76324.47 103,-76318.47 109,-76312.47 115,-76312.47 115,-76312.47 385,-76312.47 385,-76312.47 391,-76312.47 397,-76318.47 397,-76324.47 397,-76324.47 397,-76347.47 397,-76347.47 397,-76353.47 391,-76359.47 385,-76359.47"/>
<text text-anchor="middle" x="250" y="-76344.47" font-family="Arial" font-size="10.00">Layer 4 SiLU GPU0</text>
<text text-anchor="middle" x="250" y="-76333.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="250" y="-76322.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer4_ffn1_0&#45;&gt;layer4_act_0 -->
<g id="edge79" class="edge">
<title>layer4_ffn1_0&#45;&gt;layer4_act_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M250,-76431.41C250,-76413.96 250,-76389.55 250,-76369.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="253.5,-76369.86 250,-76359.86 246.5,-76369.86 253.5,-76369.86"/>
</g>
<!-- layer4_act_1 -->
<g id="node71" class="node">
<title>layer4_act_1</title>
<path fill="#e6f3ff" stroke="black" d="M715,-76359.47C715,-76359.47 445,-76359.47 445,-76359.47 439,-76359.47 433,-76353.47 433,-76347.47 433,-76347.47 433,-76324.47 433,-76324.47 433,-76318.47 439,-76312.47 445,-76312.47 445,-76312.47 715,-76312.47 715,-76312.47 721,-76312.47 727,-76318.47 727,-76324.47 727,-76324.47 727,-76347.47 727,-76347.47 727,-76353.47 721,-76359.47 715,-76359.47"/>
<text text-anchor="middle" x="580" y="-76344.47" font-family="Arial" font-size="10.00">Layer 4 SiLU GPU1</text>
<text text-anchor="middle" x="580" y="-76333.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="580" y="-76322.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer4_ffn1_1&#45;&gt;layer4_act_1 -->
<g id="edge80" class="edge">
<title>layer4_ffn1_1&#45;&gt;layer4_act_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M580,-76431.41C580,-76413.96 580,-76389.55 580,-76369.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="583.5,-76369.86 580,-76359.86 576.5,-76369.86 583.5,-76369.86"/>
</g>
<!-- layer4_ffn2_0 -->
<g id="node72" class="node">
<title>layer4_ffn2_0</title>
<path fill="#e6f3ff" stroke="black" d="M384.5,-76240.47C384.5,-76240.47 121.5,-76240.47 121.5,-76240.47 115.5,-76240.47 109.5,-76234.47 109.5,-76228.47 109.5,-76228.47 109.5,-76205.47 109.5,-76205.47 109.5,-76199.47 115.5,-76193.47 121.5,-76193.47 121.5,-76193.47 384.5,-76193.47 384.5,-76193.47 390.5,-76193.47 396.5,-76199.47 396.5,-76205.47 396.5,-76205.47 396.5,-76228.47 396.5,-76228.47 396.5,-76234.47 390.5,-76240.47 384.5,-76240.47"/>
<text text-anchor="middle" x="253" y="-76225.47" font-family="Arial" font-size="10.00">Layer 4 FFN2 GPU0</text>
<text text-anchor="middle" x="253" y="-76214.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="253" y="-76203.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer4_act_0&#45;&gt;layer4_ffn2_0 -->
<g id="edge81" class="edge">
<title>layer4_act_0&#45;&gt;layer4_ffn2_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M250.58,-76312.41C251.03,-76294.96 251.65,-76270.55 252.16,-76250.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="255.66,-76250.94 252.41,-76240.86 248.66,-76250.76 255.66,-76250.94"/>
</g>
<!-- layer4_ffn2_1 -->
<g id="node73" class="node">
<title>layer4_ffn2_1</title>
<path fill="#e6f3ff" stroke="black" d="M709.5,-76240.47C709.5,-76240.47 446.5,-76240.47 446.5,-76240.47 440.5,-76240.47 434.5,-76234.47 434.5,-76228.47 434.5,-76228.47 434.5,-76205.47 434.5,-76205.47 434.5,-76199.47 440.5,-76193.47 446.5,-76193.47 446.5,-76193.47 709.5,-76193.47 709.5,-76193.47 715.5,-76193.47 721.5,-76199.47 721.5,-76205.47 721.5,-76205.47 721.5,-76228.47 721.5,-76228.47 721.5,-76234.47 715.5,-76240.47 709.5,-76240.47"/>
<text text-anchor="middle" x="578" y="-76225.47" font-family="Arial" font-size="10.00">Layer 4 FFN2 GPU1</text>
<text text-anchor="middle" x="578" y="-76214.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="578" y="-76203.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer4_act_1&#45;&gt;layer4_ffn2_1 -->
<g id="edge82" class="edge">
<title>layer4_act_1&#45;&gt;layer4_ffn2_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M579.61,-76312.41C579.32,-76294.96 578.9,-76270.55 578.56,-76250.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="582.06,-76250.8 578.39,-76240.86 575.06,-76250.92 582.06,-76250.8"/>
</g>
<!-- layer4_ffn_ar -->
<g id="node74" class="node">
<title>layer4_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M540.85,-76121.47C540.85,-76121.47 343.97,-76121.47 343.97,-76121.47 337.97,-76121.47 328.25,-76116.76 324.54,-76112.05 324.54,-76112.05 282.58,-76058.89 282.58,-76058.89 278.87,-76054.18 281.15,-76049.47 287.15,-76049.47 287.15,-76049.47 484.03,-76049.47 484.03,-76049.47 490.03,-76049.47 499.75,-76054.18 503.46,-76058.89 503.46,-76058.89 545.42,-76112.05 545.42,-76112.05 549.13,-76116.76 546.85,-76121.47 540.85,-76121.47"/>
<text text-anchor="middle" x="414" y="-76088.47" font-family="Arial" font-size="10.00">Layer 4 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="414" y="-76077.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer4_ffn2_0&#45;&gt;layer4_ffn_ar -->
<g id="edge83" class="edge">
<title>layer4_ffn2_0&#45;&gt;layer4_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M281.04,-76193.41C303.43,-76175.41 335.4,-76149.69 362.38,-76127.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="364.61,-76130.68 370.21,-76121.69 360.23,-76125.23 364.61,-76130.68"/>
</g>
<!-- layer4_ffn2_1&#45;&gt;layer4_ffn_ar -->
<g id="edge84" class="edge">
<title>layer4_ffn2_1&#45;&gt;layer4_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M549.43,-76193.41C526.63,-76175.41 494.06,-76149.69 466.58,-76127.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="468.62,-76125.14 458.6,-76121.69 464.28,-76130.63 468.62,-76125.14"/>
</g>
<!-- layer5_qkv_0 -->
<g id="node75" class="node">
<title>layer5_qkv_0</title>
<path fill="#e6f3ff" stroke="black" d="M384,-75977.47C384,-75977.47 86,-75977.47 86,-75977.47 80,-75977.47 74,-75971.47 74,-75965.47 74,-75965.47 74,-75942.47 74,-75942.47 74,-75936.47 80,-75930.47 86,-75930.47 86,-75930.47 384,-75930.47 384,-75930.47 390,-75930.47 396,-75936.47 396,-75942.47 396,-75942.47 396,-75965.47 396,-75965.47 396,-75971.47 390,-75977.47 384,-75977.47"/>
<text text-anchor="middle" x="235" y="-75962.47" font-family="Arial" font-size="10.00">Layer 5 QKV Proj GPU0</text>
<text text-anchor="middle" x="235" y="-75951.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="235" y="-75940.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer4_ffn_ar&#45;&gt;layer5_qkv_0 -->
<g id="edge85" class="edge">
<title>layer4_ffn_ar&#45;&gt;layer5_qkv_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M365.56,-76049.42C337.06,-76028.81 301.48,-76003.06 274.66,-75983.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="276.43,-75980.62 266.28,-75977.6 272.33,-75986.3 276.43,-75980.62"/>
</g>
<!-- layer5_qkv_1 -->
<g id="node76" class="node">
<title>layer5_qkv_1</title>
<path fill="#e6f3ff" stroke="black" d="M742,-75977.47C742,-75977.47 444,-75977.47 444,-75977.47 438,-75977.47 432,-75971.47 432,-75965.47 432,-75965.47 432,-75942.47 432,-75942.47 432,-75936.47 438,-75930.47 444,-75930.47 444,-75930.47 742,-75930.47 742,-75930.47 748,-75930.47 754,-75936.47 754,-75942.47 754,-75942.47 754,-75965.47 754,-75965.47 754,-75971.47 748,-75977.47 742,-75977.47"/>
<text text-anchor="middle" x="593" y="-75962.47" font-family="Arial" font-size="10.00">Layer 5 QKV Proj GPU1</text>
<text text-anchor="middle" x="593" y="-75951.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="593" y="-75940.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer4_ffn_ar&#45;&gt;layer5_qkv_1 -->
<g id="edge86" class="edge">
<title>layer4_ffn_ar&#45;&gt;layer5_qkv_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M462.44,-76049.42C490.94,-76028.81 526.52,-76003.06 553.34,-75983.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="555.67,-75986.3 561.72,-75977.6 551.57,-75980.62 555.67,-75986.3"/>
</g>
<!-- layer5_attn_0 -->
<g id="node77" class="node">
<title>layer5_attn_0</title>
<path fill="#e6f3ff" stroke="black" d="M384,-75858.47C384,-75858.47 86,-75858.47 86,-75858.47 80,-75858.47 74,-75852.47 74,-75846.47 74,-75846.47 74,-75823.47 74,-75823.47 74,-75817.47 80,-75811.47 86,-75811.47 86,-75811.47 384,-75811.47 384,-75811.47 390,-75811.47 396,-75817.47 396,-75823.47 396,-75823.47 396,-75846.47 396,-75846.47 396,-75852.47 390,-75858.47 384,-75858.47"/>
<text text-anchor="middle" x="235" y="-75843.47" font-family="Arial" font-size="10.00">Layer 5 Attention GPU0</text>
<text text-anchor="middle" x="235" y="-75832.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="235" y="-75821.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer5_qkv_0&#45;&gt;layer5_attn_0 -->
<g id="edge87" class="edge">
<title>layer5_qkv_0&#45;&gt;layer5_attn_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M235,-75930.41C235,-75912.96 235,-75888.55 235,-75868.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="238.5,-75868.86 235,-75858.86 231.5,-75868.86 238.5,-75868.86"/>
</g>
<!-- layer5_attn_1 -->
<g id="node78" class="node">
<title>layer5_attn_1</title>
<path fill="#e6f3ff" stroke="black" d="M742,-75858.47C742,-75858.47 444,-75858.47 444,-75858.47 438,-75858.47 432,-75852.47 432,-75846.47 432,-75846.47 432,-75823.47 432,-75823.47 432,-75817.47 438,-75811.47 444,-75811.47 444,-75811.47 742,-75811.47 742,-75811.47 748,-75811.47 754,-75817.47 754,-75823.47 754,-75823.47 754,-75846.47 754,-75846.47 754,-75852.47 748,-75858.47 742,-75858.47"/>
<text text-anchor="middle" x="593" y="-75843.47" font-family="Arial" font-size="10.00">Layer 5 Attention GPU1</text>
<text text-anchor="middle" x="593" y="-75832.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="593" y="-75821.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer5_qkv_1&#45;&gt;layer5_attn_1 -->
<g id="edge88" class="edge">
<title>layer5_qkv_1&#45;&gt;layer5_attn_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M593,-75930.41C593,-75912.96 593,-75888.55 593,-75868.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="596.5,-75868.86 593,-75858.86 589.5,-75868.86 596.5,-75868.86"/>
</g>
<!-- layer5_attn_out_0 -->
<g id="node79" class="node">
<title>layer5_attn_out_0</title>
<path fill="#e6f3ff" stroke="black" d="M384,-75739.47C384,-75739.47 94,-75739.47 94,-75739.47 88,-75739.47 82,-75733.47 82,-75727.47 82,-75727.47 82,-75704.47 82,-75704.47 82,-75698.47 88,-75692.47 94,-75692.47 94,-75692.47 384,-75692.47 384,-75692.47 390,-75692.47 396,-75698.47 396,-75704.47 396,-75704.47 396,-75727.47 396,-75727.47 396,-75733.47 390,-75739.47 384,-75739.47"/>
<text text-anchor="middle" x="239" y="-75724.47" font-family="Arial" font-size="10.00">Layer 5 Attn Out GPU0</text>
<text text-anchor="middle" x="239" y="-75713.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="239" y="-75702.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer5_attn_0&#45;&gt;layer5_attn_out_0 -->
<g id="edge89" class="edge">
<title>layer5_attn_0&#45;&gt;layer5_attn_out_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M235.77,-75811.41C236.37,-75793.96 237.2,-75769.55 237.87,-75749.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="241.37,-75749.97 238.22,-75739.86 234.38,-75749.73 241.37,-75749.97"/>
</g>
<!-- layer5_attn_out_1 -->
<g id="node80" class="node">
<title>layer5_attn_out_1</title>
<path fill="#e6f3ff" stroke="black" d="M736,-75739.47C736,-75739.47 446,-75739.47 446,-75739.47 440,-75739.47 434,-75733.47 434,-75727.47 434,-75727.47 434,-75704.47 434,-75704.47 434,-75698.47 440,-75692.47 446,-75692.47 446,-75692.47 736,-75692.47 736,-75692.47 742,-75692.47 748,-75698.47 748,-75704.47 748,-75704.47 748,-75727.47 748,-75727.47 748,-75733.47 742,-75739.47 736,-75739.47"/>
<text text-anchor="middle" x="591" y="-75724.47" font-family="Arial" font-size="10.00">Layer 5 Attn Out GPU1</text>
<text text-anchor="middle" x="591" y="-75713.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="591" y="-75702.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer5_attn_1&#45;&gt;layer5_attn_out_1 -->
<g id="edge90" class="edge">
<title>layer5_attn_1&#45;&gt;layer5_attn_out_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M592.61,-75811.41C592.32,-75793.96 591.9,-75769.55 591.56,-75749.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="595.06,-75749.8 591.39,-75739.86 588.06,-75749.92 595.06,-75749.8"/>
</g>
<!-- layer5_attn_ar -->
<g id="node81" class="node">
<title>layer5_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M537.63,-75620.47C537.63,-75620.47 345.87,-75620.47 345.87,-75620.47 339.87,-75620.47 330.21,-75615.72 326.55,-75610.96 326.55,-75610.96 285.7,-75557.97 285.7,-75557.97 282.03,-75553.22 284.37,-75548.47 290.37,-75548.47 290.37,-75548.47 482.13,-75548.47 482.13,-75548.47 488.13,-75548.47 497.79,-75553.22 501.45,-75557.97 501.45,-75557.97 542.3,-75610.96 542.3,-75610.96 545.97,-75615.72 543.63,-75620.47 537.63,-75620.47"/>
<text text-anchor="middle" x="414" y="-75587.47" font-family="Arial" font-size="10.00">Layer 5 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="414" y="-75576.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer5_attn_out_0&#45;&gt;layer5_attn_ar -->
<g id="edge91" class="edge">
<title>layer5_attn_out_0&#45;&gt;layer5_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M269.48,-75692.41C293.92,-75674.33 328.86,-75648.47 358.27,-75626.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="360.45,-75629.45 366.4,-75620.69 356.28,-75623.82 360.45,-75629.45"/>
</g>
<!-- layer5_attn_out_1&#45;&gt;layer5_attn_ar -->
<g id="edge92" class="edge">
<title>layer5_attn_out_1&#45;&gt;layer5_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M560.17,-75692.41C535.45,-75674.33 500.11,-75648.47 470.37,-75626.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="472.28,-75623.77 462.14,-75620.69 468.14,-75629.42 472.28,-75623.77"/>
</g>
<!-- layer5_ffn1_0 -->
<g id="node82" class="node">
<title>layer5_ffn1_0</title>
<path fill="#e6f3ff" stroke="black" d="M384,-75476.47C384,-75476.47 114,-75476.47 114,-75476.47 108,-75476.47 102,-75470.47 102,-75464.47 102,-75464.47 102,-75441.47 102,-75441.47 102,-75435.47 108,-75429.47 114,-75429.47 114,-75429.47 384,-75429.47 384,-75429.47 390,-75429.47 396,-75435.47 396,-75441.47 396,-75441.47 396,-75464.47 396,-75464.47 396,-75470.47 390,-75476.47 384,-75476.47"/>
<text text-anchor="middle" x="249" y="-75461.47" font-family="Arial" font-size="10.00">Layer 5 FFN1 GPU0</text>
<text text-anchor="middle" x="249" y="-75450.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="249" y="-75439.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer5_attn_ar&#45;&gt;layer5_ffn1_0 -->
<g id="edge93" class="edge">
<title>layer5_attn_ar&#45;&gt;layer5_ffn1_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M369.35,-75548.42C343.28,-75527.96 310.78,-75502.45 286.12,-75483.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="288.11,-75480.21 278.08,-75476.79 283.79,-75485.72 288.11,-75480.21"/>
</g>
<!-- layer5_ffn1_1 -->
<g id="node83" class="node">
<title>layer5_ffn1_1</title>
<path fill="#e6f3ff" stroke="black" d="M714,-75476.47C714,-75476.47 444,-75476.47 444,-75476.47 438,-75476.47 432,-75470.47 432,-75464.47 432,-75464.47 432,-75441.47 432,-75441.47 432,-75435.47 438,-75429.47 444,-75429.47 444,-75429.47 714,-75429.47 714,-75429.47 720,-75429.47 726,-75435.47 726,-75441.47 726,-75441.47 726,-75464.47 726,-75464.47 726,-75470.47 720,-75476.47 714,-75476.47"/>
<text text-anchor="middle" x="579" y="-75461.47" font-family="Arial" font-size="10.00">Layer 5 FFN1 GPU1</text>
<text text-anchor="middle" x="579" y="-75450.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="579" y="-75439.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer5_attn_ar&#45;&gt;layer5_ffn1_1 -->
<g id="edge94" class="edge">
<title>layer5_attn_ar&#45;&gt;layer5_ffn1_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M458.65,-75548.42C484.72,-75527.96 517.22,-75502.45 541.88,-75483.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="544.21,-75485.72 549.92,-75476.79 539.89,-75480.21 544.21,-75485.72"/>
</g>
<!-- layer5_act_0 -->
<g id="node84" class="node">
<title>layer5_act_0</title>
<path fill="#e6f3ff" stroke="black" d="M384,-75357.47C384,-75357.47 114,-75357.47 114,-75357.47 108,-75357.47 102,-75351.47 102,-75345.47 102,-75345.47 102,-75322.47 102,-75322.47 102,-75316.47 108,-75310.47 114,-75310.47 114,-75310.47 384,-75310.47 384,-75310.47 390,-75310.47 396,-75316.47 396,-75322.47 396,-75322.47 396,-75345.47 396,-75345.47 396,-75351.47 390,-75357.47 384,-75357.47"/>
<text text-anchor="middle" x="249" y="-75342.47" font-family="Arial" font-size="10.00">Layer 5 SiLU GPU0</text>
<text text-anchor="middle" x="249" y="-75331.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="249" y="-75320.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer5_ffn1_0&#45;&gt;layer5_act_0 -->
<g id="edge95" class="edge">
<title>layer5_ffn1_0&#45;&gt;layer5_act_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M249,-75429.41C249,-75411.96 249,-75387.55 249,-75367.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="252.5,-75367.86 249,-75357.86 245.5,-75367.86 252.5,-75367.86"/>
</g>
<!-- layer5_act_1 -->
<g id="node85" class="node">
<title>layer5_act_1</title>
<path fill="#e6f3ff" stroke="black" d="M714,-75357.47C714,-75357.47 444,-75357.47 444,-75357.47 438,-75357.47 432,-75351.47 432,-75345.47 432,-75345.47 432,-75322.47 432,-75322.47 432,-75316.47 438,-75310.47 444,-75310.47 444,-75310.47 714,-75310.47 714,-75310.47 720,-75310.47 726,-75316.47 726,-75322.47 726,-75322.47 726,-75345.47 726,-75345.47 726,-75351.47 720,-75357.47 714,-75357.47"/>
<text text-anchor="middle" x="579" y="-75342.47" font-family="Arial" font-size="10.00">Layer 5 SiLU GPU1</text>
<text text-anchor="middle" x="579" y="-75331.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="579" y="-75320.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer5_ffn1_1&#45;&gt;layer5_act_1 -->
<g id="edge96" class="edge">
<title>layer5_ffn1_1&#45;&gt;layer5_act_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M579,-75429.41C579,-75411.96 579,-75387.55 579,-75367.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="582.5,-75367.86 579,-75357.86 575.5,-75367.86 582.5,-75367.86"/>
</g>
<!-- layer5_ffn2_0 -->
<g id="node86" class="node">
<title>layer5_ffn2_0</title>
<path fill="#e6f3ff" stroke="black" d="M383.5,-75238.47C383.5,-75238.47 120.5,-75238.47 120.5,-75238.47 114.5,-75238.47 108.5,-75232.47 108.5,-75226.47 108.5,-75226.47 108.5,-75203.47 108.5,-75203.47 108.5,-75197.47 114.5,-75191.47 120.5,-75191.47 120.5,-75191.47 383.5,-75191.47 383.5,-75191.47 389.5,-75191.47 395.5,-75197.47 395.5,-75203.47 395.5,-75203.47 395.5,-75226.47 395.5,-75226.47 395.5,-75232.47 389.5,-75238.47 383.5,-75238.47"/>
<text text-anchor="middle" x="252" y="-75223.47" font-family="Arial" font-size="10.00">Layer 5 FFN2 GPU0</text>
<text text-anchor="middle" x="252" y="-75212.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="252" y="-75201.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer5_act_0&#45;&gt;layer5_ffn2_0 -->
<g id="edge97" class="edge">
<title>layer5_act_0&#45;&gt;layer5_ffn2_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M249.58,-75310.41C250.03,-75292.96 250.65,-75268.55 251.16,-75248.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="254.66,-75248.94 251.41,-75238.86 247.66,-75248.76 254.66,-75248.94"/>
</g>
<!-- layer5_ffn2_1 -->
<g id="node87" class="node">
<title>layer5_ffn2_1</title>
<path fill="#e6f3ff" stroke="black" d="M708.5,-75238.47C708.5,-75238.47 445.5,-75238.47 445.5,-75238.47 439.5,-75238.47 433.5,-75232.47 433.5,-75226.47 433.5,-75226.47 433.5,-75203.47 433.5,-75203.47 433.5,-75197.47 439.5,-75191.47 445.5,-75191.47 445.5,-75191.47 708.5,-75191.47 708.5,-75191.47 714.5,-75191.47 720.5,-75197.47 720.5,-75203.47 720.5,-75203.47 720.5,-75226.47 720.5,-75226.47 720.5,-75232.47 714.5,-75238.47 708.5,-75238.47"/>
<text text-anchor="middle" x="577" y="-75223.47" font-family="Arial" font-size="10.00">Layer 5 FFN2 GPU1</text>
<text text-anchor="middle" x="577" y="-75212.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="577" y="-75201.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer5_act_1&#45;&gt;layer5_ffn2_1 -->
<g id="edge98" class="edge">
<title>layer5_act_1&#45;&gt;layer5_ffn2_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M578.61,-75310.41C578.32,-75292.96 577.9,-75268.55 577.56,-75248.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="581.06,-75248.8 577.39,-75238.86 574.06,-75248.92 581.06,-75248.8"/>
</g>
<!-- layer5_ffn_ar -->
<g id="node88" class="node">
<title>layer5_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M539.85,-75119.47C539.85,-75119.47 342.97,-75119.47 342.97,-75119.47 336.97,-75119.47 327.25,-75114.76 323.54,-75110.05 323.54,-75110.05 281.58,-75056.89 281.58,-75056.89 277.87,-75052.18 280.15,-75047.47 286.15,-75047.47 286.15,-75047.47 483.03,-75047.47 483.03,-75047.47 489.03,-75047.47 498.75,-75052.18 502.46,-75056.89 502.46,-75056.89 544.42,-75110.05 544.42,-75110.05 548.13,-75114.76 545.85,-75119.47 539.85,-75119.47"/>
<text text-anchor="middle" x="413" y="-75086.47" font-family="Arial" font-size="10.00">Layer 5 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="413" y="-75075.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer5_ffn2_0&#45;&gt;layer5_ffn_ar -->
<g id="edge99" class="edge">
<title>layer5_ffn2_0&#45;&gt;layer5_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M280.04,-75191.41C302.43,-75173.41 334.4,-75147.69 361.38,-75125.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="363.61,-75128.68 369.21,-75119.69 359.23,-75123.23 363.61,-75128.68"/>
</g>
<!-- layer5_ffn2_1&#45;&gt;layer5_ffn_ar -->
<g id="edge100" class="edge">
<title>layer5_ffn2_1&#45;&gt;layer5_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M548.43,-75191.41C525.63,-75173.41 493.06,-75147.69 465.58,-75125.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="467.62,-75123.14 457.6,-75119.69 463.28,-75128.63 467.62,-75123.14"/>
</g>
<!-- layer6_qkv_0 -->
<g id="node89" class="node">
<title>layer6_qkv_0</title>
<path fill="#e6f3ff" stroke="black" d="M383,-74975.47C383,-74975.47 85,-74975.47 85,-74975.47 79,-74975.47 73,-74969.47 73,-74963.47 73,-74963.47 73,-74940.47 73,-74940.47 73,-74934.47 79,-74928.47 85,-74928.47 85,-74928.47 383,-74928.47 383,-74928.47 389,-74928.47 395,-74934.47 395,-74940.47 395,-74940.47 395,-74963.47 395,-74963.47 395,-74969.47 389,-74975.47 383,-74975.47"/>
<text text-anchor="middle" x="234" y="-74960.47" font-family="Arial" font-size="10.00">Layer 6 QKV Proj GPU0</text>
<text text-anchor="middle" x="234" y="-74949.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="234" y="-74938.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer5_ffn_ar&#45;&gt;layer6_qkv_0 -->
<g id="edge101" class="edge">
<title>layer5_ffn_ar&#45;&gt;layer6_qkv_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M364.56,-75047.42C336.06,-75026.81 300.48,-75001.06 273.66,-74981.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="275.43,-74978.62 265.28,-74975.6 271.33,-74984.3 275.43,-74978.62"/>
</g>
<!-- layer6_qkv_1 -->
<g id="node90" class="node">
<title>layer6_qkv_1</title>
<path fill="#e6f3ff" stroke="black" d="M741,-74975.47C741,-74975.47 443,-74975.47 443,-74975.47 437,-74975.47 431,-74969.47 431,-74963.47 431,-74963.47 431,-74940.47 431,-74940.47 431,-74934.47 437,-74928.47 443,-74928.47 443,-74928.47 741,-74928.47 741,-74928.47 747,-74928.47 753,-74934.47 753,-74940.47 753,-74940.47 753,-74963.47 753,-74963.47 753,-74969.47 747,-74975.47 741,-74975.47"/>
<text text-anchor="middle" x="592" y="-74960.47" font-family="Arial" font-size="10.00">Layer 6 QKV Proj GPU1</text>
<text text-anchor="middle" x="592" y="-74949.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="592" y="-74938.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer5_ffn_ar&#45;&gt;layer6_qkv_1 -->
<g id="edge102" class="edge">
<title>layer5_ffn_ar&#45;&gt;layer6_qkv_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M461.44,-75047.42C489.94,-75026.81 525.52,-75001.06 552.34,-74981.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="554.67,-74984.3 560.72,-74975.6 550.57,-74978.62 554.67,-74984.3"/>
</g>
<!-- layer6_attn_0 -->
<g id="node91" class="node">
<title>layer6_attn_0</title>
<path fill="#e6f3ff" stroke="black" d="M383,-74856.47C383,-74856.47 85,-74856.47 85,-74856.47 79,-74856.47 73,-74850.47 73,-74844.47 73,-74844.47 73,-74821.47 73,-74821.47 73,-74815.47 79,-74809.47 85,-74809.47 85,-74809.47 383,-74809.47 383,-74809.47 389,-74809.47 395,-74815.47 395,-74821.47 395,-74821.47 395,-74844.47 395,-74844.47 395,-74850.47 389,-74856.47 383,-74856.47"/>
<text text-anchor="middle" x="234" y="-74841.47" font-family="Arial" font-size="10.00">Layer 6 Attention GPU0</text>
<text text-anchor="middle" x="234" y="-74830.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="234" y="-74819.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer6_qkv_0&#45;&gt;layer6_attn_0 -->
<g id="edge103" class="edge">
<title>layer6_qkv_0&#45;&gt;layer6_attn_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M234,-74928.41C234,-74910.96 234,-74886.55 234,-74866.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="237.5,-74866.86 234,-74856.86 230.5,-74866.86 237.5,-74866.86"/>
</g>
<!-- layer6_attn_1 -->
<g id="node92" class="node">
<title>layer6_attn_1</title>
<path fill="#e6f3ff" stroke="black" d="M741,-74856.47C741,-74856.47 443,-74856.47 443,-74856.47 437,-74856.47 431,-74850.47 431,-74844.47 431,-74844.47 431,-74821.47 431,-74821.47 431,-74815.47 437,-74809.47 443,-74809.47 443,-74809.47 741,-74809.47 741,-74809.47 747,-74809.47 753,-74815.47 753,-74821.47 753,-74821.47 753,-74844.47 753,-74844.47 753,-74850.47 747,-74856.47 741,-74856.47"/>
<text text-anchor="middle" x="592" y="-74841.47" font-family="Arial" font-size="10.00">Layer 6 Attention GPU1</text>
<text text-anchor="middle" x="592" y="-74830.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="592" y="-74819.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer6_qkv_1&#45;&gt;layer6_attn_1 -->
<g id="edge104" class="edge">
<title>layer6_qkv_1&#45;&gt;layer6_attn_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M592,-74928.41C592,-74910.96 592,-74886.55 592,-74866.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="595.5,-74866.86 592,-74856.86 588.5,-74866.86 595.5,-74866.86"/>
</g>
<!-- layer6_attn_out_0 -->
<g id="node93" class="node">
<title>layer6_attn_out_0</title>
<path fill="#e6f3ff" stroke="black" d="M383,-74737.47C383,-74737.47 93,-74737.47 93,-74737.47 87,-74737.47 81,-74731.47 81,-74725.47 81,-74725.47 81,-74702.47 81,-74702.47 81,-74696.47 87,-74690.47 93,-74690.47 93,-74690.47 383,-74690.47 383,-74690.47 389,-74690.47 395,-74696.47 395,-74702.47 395,-74702.47 395,-74725.47 395,-74725.47 395,-74731.47 389,-74737.47 383,-74737.47"/>
<text text-anchor="middle" x="238" y="-74722.47" font-family="Arial" font-size="10.00">Layer 6 Attn Out GPU0</text>
<text text-anchor="middle" x="238" y="-74711.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="238" y="-74700.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer6_attn_0&#45;&gt;layer6_attn_out_0 -->
<g id="edge105" class="edge">
<title>layer6_attn_0&#45;&gt;layer6_attn_out_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M234.77,-74809.41C235.37,-74791.96 236.2,-74767.55 236.87,-74747.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="240.37,-74747.97 237.22,-74737.86 233.38,-74747.73 240.37,-74747.97"/>
</g>
<!-- layer6_attn_out_1 -->
<g id="node94" class="node">
<title>layer6_attn_out_1</title>
<path fill="#e6f3ff" stroke="black" d="M735,-74737.47C735,-74737.47 445,-74737.47 445,-74737.47 439,-74737.47 433,-74731.47 433,-74725.47 433,-74725.47 433,-74702.47 433,-74702.47 433,-74696.47 439,-74690.47 445,-74690.47 445,-74690.47 735,-74690.47 735,-74690.47 741,-74690.47 747,-74696.47 747,-74702.47 747,-74702.47 747,-74725.47 747,-74725.47 747,-74731.47 741,-74737.47 735,-74737.47"/>
<text text-anchor="middle" x="590" y="-74722.47" font-family="Arial" font-size="10.00">Layer 6 Attn Out GPU1</text>
<text text-anchor="middle" x="590" y="-74711.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="590" y="-74700.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer6_attn_1&#45;&gt;layer6_attn_out_1 -->
<g id="edge106" class="edge">
<title>layer6_attn_1&#45;&gt;layer6_attn_out_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M591.61,-74809.41C591.32,-74791.96 590.9,-74767.55 590.56,-74747.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="594.06,-74747.8 590.39,-74737.86 587.06,-74747.92 594.06,-74747.8"/>
</g>
<!-- layer6_attn_ar -->
<g id="node95" class="node">
<title>layer6_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M536.63,-74618.47C536.63,-74618.47 344.87,-74618.47 344.87,-74618.47 338.87,-74618.47 329.21,-74613.72 325.55,-74608.96 325.55,-74608.96 284.7,-74555.97 284.7,-74555.97 281.03,-74551.22 283.37,-74546.47 289.37,-74546.47 289.37,-74546.47 481.13,-74546.47 481.13,-74546.47 487.13,-74546.47 496.79,-74551.22 500.45,-74555.97 500.45,-74555.97 541.3,-74608.96 541.3,-74608.96 544.97,-74613.72 542.63,-74618.47 536.63,-74618.47"/>
<text text-anchor="middle" x="413" y="-74585.47" font-family="Arial" font-size="10.00">Layer 6 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="413" y="-74574.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer6_attn_out_0&#45;&gt;layer6_attn_ar -->
<g id="edge107" class="edge">
<title>layer6_attn_out_0&#45;&gt;layer6_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M268.48,-74690.41C292.92,-74672.33 327.86,-74646.47 357.27,-74624.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="359.45,-74627.45 365.4,-74618.69 355.28,-74621.82 359.45,-74627.45"/>
</g>
<!-- layer6_attn_out_1&#45;&gt;layer6_attn_ar -->
<g id="edge108" class="edge">
<title>layer6_attn_out_1&#45;&gt;layer6_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M559.17,-74690.41C534.45,-74672.33 499.11,-74646.47 469.37,-74624.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="471.28,-74621.77 461.14,-74618.69 467.14,-74627.42 471.28,-74621.77"/>
</g>
<!-- layer6_ffn1_0 -->
<g id="node96" class="node">
<title>layer6_ffn1_0</title>
<path fill="#e6f3ff" stroke="black" d="M383,-74474.47C383,-74474.47 113,-74474.47 113,-74474.47 107,-74474.47 101,-74468.47 101,-74462.47 101,-74462.47 101,-74439.47 101,-74439.47 101,-74433.47 107,-74427.47 113,-74427.47 113,-74427.47 383,-74427.47 383,-74427.47 389,-74427.47 395,-74433.47 395,-74439.47 395,-74439.47 395,-74462.47 395,-74462.47 395,-74468.47 389,-74474.47 383,-74474.47"/>
<text text-anchor="middle" x="248" y="-74459.47" font-family="Arial" font-size="10.00">Layer 6 FFN1 GPU0</text>
<text text-anchor="middle" x="248" y="-74448.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="248" y="-74437.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer6_attn_ar&#45;&gt;layer6_ffn1_0 -->
<g id="edge109" class="edge">
<title>layer6_attn_ar&#45;&gt;layer6_ffn1_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M368.35,-74546.42C342.28,-74525.96 309.78,-74500.45 285.12,-74481.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="287.11,-74478.21 277.08,-74474.79 282.79,-74483.72 287.11,-74478.21"/>
</g>
<!-- layer6_ffn1_1 -->
<g id="node97" class="node">
<title>layer6_ffn1_1</title>
<path fill="#e6f3ff" stroke="black" d="M713,-74474.47C713,-74474.47 443,-74474.47 443,-74474.47 437,-74474.47 431,-74468.47 431,-74462.47 431,-74462.47 431,-74439.47 431,-74439.47 431,-74433.47 437,-74427.47 443,-74427.47 443,-74427.47 713,-74427.47 713,-74427.47 719,-74427.47 725,-74433.47 725,-74439.47 725,-74439.47 725,-74462.47 725,-74462.47 725,-74468.47 719,-74474.47 713,-74474.47"/>
<text text-anchor="middle" x="578" y="-74459.47" font-family="Arial" font-size="10.00">Layer 6 FFN1 GPU1</text>
<text text-anchor="middle" x="578" y="-74448.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="578" y="-74437.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer6_attn_ar&#45;&gt;layer6_ffn1_1 -->
<g id="edge110" class="edge">
<title>layer6_attn_ar&#45;&gt;layer6_ffn1_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M457.65,-74546.42C483.72,-74525.96 516.22,-74500.45 540.88,-74481.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="543.21,-74483.72 548.92,-74474.79 538.89,-74478.21 543.21,-74483.72"/>
</g>
<!-- layer6_act_0 -->
<g id="node98" class="node">
<title>layer6_act_0</title>
<path fill="#e6f3ff" stroke="black" d="M383,-74355.47C383,-74355.47 113,-74355.47 113,-74355.47 107,-74355.47 101,-74349.47 101,-74343.47 101,-74343.47 101,-74320.47 101,-74320.47 101,-74314.47 107,-74308.47 113,-74308.47 113,-74308.47 383,-74308.47 383,-74308.47 389,-74308.47 395,-74314.47 395,-74320.47 395,-74320.47 395,-74343.47 395,-74343.47 395,-74349.47 389,-74355.47 383,-74355.47"/>
<text text-anchor="middle" x="248" y="-74340.47" font-family="Arial" font-size="10.00">Layer 6 SiLU GPU0</text>
<text text-anchor="middle" x="248" y="-74329.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="248" y="-74318.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer6_ffn1_0&#45;&gt;layer6_act_0 -->
<g id="edge111" class="edge">
<title>layer6_ffn1_0&#45;&gt;layer6_act_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M248,-74427.41C248,-74409.96 248,-74385.55 248,-74365.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="251.5,-74365.86 248,-74355.86 244.5,-74365.86 251.5,-74365.86"/>
</g>
<!-- layer6_act_1 -->
<g id="node99" class="node">
<title>layer6_act_1</title>
<path fill="#e6f3ff" stroke="black" d="M713,-74355.47C713,-74355.47 443,-74355.47 443,-74355.47 437,-74355.47 431,-74349.47 431,-74343.47 431,-74343.47 431,-74320.47 431,-74320.47 431,-74314.47 437,-74308.47 443,-74308.47 443,-74308.47 713,-74308.47 713,-74308.47 719,-74308.47 725,-74314.47 725,-74320.47 725,-74320.47 725,-74343.47 725,-74343.47 725,-74349.47 719,-74355.47 713,-74355.47"/>
<text text-anchor="middle" x="578" y="-74340.47" font-family="Arial" font-size="10.00">Layer 6 SiLU GPU1</text>
<text text-anchor="middle" x="578" y="-74329.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="578" y="-74318.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer6_ffn1_1&#45;&gt;layer6_act_1 -->
<g id="edge112" class="edge">
<title>layer6_ffn1_1&#45;&gt;layer6_act_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M578,-74427.41C578,-74409.96 578,-74385.55 578,-74365.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="581.5,-74365.86 578,-74355.86 574.5,-74365.86 581.5,-74365.86"/>
</g>
<!-- layer6_ffn2_0 -->
<g id="node100" class="node">
<title>layer6_ffn2_0</title>
<path fill="#e6f3ff" stroke="black" d="M382.5,-74236.47C382.5,-74236.47 119.5,-74236.47 119.5,-74236.47 113.5,-74236.47 107.5,-74230.47 107.5,-74224.47 107.5,-74224.47 107.5,-74201.47 107.5,-74201.47 107.5,-74195.47 113.5,-74189.47 119.5,-74189.47 119.5,-74189.47 382.5,-74189.47 382.5,-74189.47 388.5,-74189.47 394.5,-74195.47 394.5,-74201.47 394.5,-74201.47 394.5,-74224.47 394.5,-74224.47 394.5,-74230.47 388.5,-74236.47 382.5,-74236.47"/>
<text text-anchor="middle" x="251" y="-74221.47" font-family="Arial" font-size="10.00">Layer 6 FFN2 GPU0</text>
<text text-anchor="middle" x="251" y="-74210.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="251" y="-74199.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer6_act_0&#45;&gt;layer6_ffn2_0 -->
<g id="edge113" class="edge">
<title>layer6_act_0&#45;&gt;layer6_ffn2_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M248.58,-74308.41C249.03,-74290.96 249.65,-74266.55 250.16,-74246.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="253.66,-74246.94 250.41,-74236.86 246.66,-74246.76 253.66,-74246.94"/>
</g>
<!-- layer6_ffn2_1 -->
<g id="node101" class="node">
<title>layer6_ffn2_1</title>
<path fill="#e6f3ff" stroke="black" d="M707.5,-74236.47C707.5,-74236.47 444.5,-74236.47 444.5,-74236.47 438.5,-74236.47 432.5,-74230.47 432.5,-74224.47 432.5,-74224.47 432.5,-74201.47 432.5,-74201.47 432.5,-74195.47 438.5,-74189.47 444.5,-74189.47 444.5,-74189.47 707.5,-74189.47 707.5,-74189.47 713.5,-74189.47 719.5,-74195.47 719.5,-74201.47 719.5,-74201.47 719.5,-74224.47 719.5,-74224.47 719.5,-74230.47 713.5,-74236.47 707.5,-74236.47"/>
<text text-anchor="middle" x="576" y="-74221.47" font-family="Arial" font-size="10.00">Layer 6 FFN2 GPU1</text>
<text text-anchor="middle" x="576" y="-74210.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="576" y="-74199.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer6_act_1&#45;&gt;layer6_ffn2_1 -->
<g id="edge114" class="edge">
<title>layer6_act_1&#45;&gt;layer6_ffn2_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M577.61,-74308.41C577.32,-74290.96 576.9,-74266.55 576.56,-74246.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="580.06,-74246.8 576.39,-74236.86 573.06,-74246.92 580.06,-74246.8"/>
</g>
<!-- layer6_ffn_ar -->
<g id="node102" class="node">
<title>layer6_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M538.85,-74117.47C538.85,-74117.47 341.97,-74117.47 341.97,-74117.47 335.97,-74117.47 326.25,-74112.76 322.54,-74108.05 322.54,-74108.05 280.58,-74054.89 280.58,-74054.89 276.87,-74050.18 279.15,-74045.47 285.15,-74045.47 285.15,-74045.47 482.03,-74045.47 482.03,-74045.47 488.03,-74045.47 497.75,-74050.18 501.46,-74054.89 501.46,-74054.89 543.42,-74108.05 543.42,-74108.05 547.13,-74112.76 544.85,-74117.47 538.85,-74117.47"/>
<text text-anchor="middle" x="412" y="-74084.47" font-family="Arial" font-size="10.00">Layer 6 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="412" y="-74073.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer6_ffn2_0&#45;&gt;layer6_ffn_ar -->
<g id="edge115" class="edge">
<title>layer6_ffn2_0&#45;&gt;layer6_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M279.04,-74189.41C301.43,-74171.41 333.4,-74145.69 360.38,-74123.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="362.61,-74126.68 368.21,-74117.69 358.23,-74121.23 362.61,-74126.68"/>
</g>
<!-- layer6_ffn2_1&#45;&gt;layer6_ffn_ar -->
<g id="edge116" class="edge">
<title>layer6_ffn2_1&#45;&gt;layer6_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M547.43,-74189.41C524.63,-74171.41 492.06,-74145.69 464.58,-74123.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="466.62,-74121.14 456.6,-74117.69 462.28,-74126.63 466.62,-74121.14"/>
</g>
<!-- layer7_qkv_0 -->
<g id="node103" class="node">
<title>layer7_qkv_0</title>
<path fill="#e6f3ff" stroke="black" d="M382,-73973.47C382,-73973.47 84,-73973.47 84,-73973.47 78,-73973.47 72,-73967.47 72,-73961.47 72,-73961.47 72,-73938.47 72,-73938.47 72,-73932.47 78,-73926.47 84,-73926.47 84,-73926.47 382,-73926.47 382,-73926.47 388,-73926.47 394,-73932.47 394,-73938.47 394,-73938.47 394,-73961.47 394,-73961.47 394,-73967.47 388,-73973.47 382,-73973.47"/>
<text text-anchor="middle" x="233" y="-73958.47" font-family="Arial" font-size="10.00">Layer 7 QKV Proj GPU0</text>
<text text-anchor="middle" x="233" y="-73947.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="233" y="-73936.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer6_ffn_ar&#45;&gt;layer7_qkv_0 -->
<g id="edge117" class="edge">
<title>layer6_ffn_ar&#45;&gt;layer7_qkv_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M363.56,-74045.42C335.06,-74024.81 299.48,-73999.06 272.66,-73979.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="274.43,-73976.62 264.28,-73973.6 270.33,-73982.3 274.43,-73976.62"/>
</g>
<!-- layer7_qkv_1 -->
<g id="node104" class="node">
<title>layer7_qkv_1</title>
<path fill="#e6f3ff" stroke="black" d="M740,-73973.47C740,-73973.47 442,-73973.47 442,-73973.47 436,-73973.47 430,-73967.47 430,-73961.47 430,-73961.47 430,-73938.47 430,-73938.47 430,-73932.47 436,-73926.47 442,-73926.47 442,-73926.47 740,-73926.47 740,-73926.47 746,-73926.47 752,-73932.47 752,-73938.47 752,-73938.47 752,-73961.47 752,-73961.47 752,-73967.47 746,-73973.47 740,-73973.47"/>
<text text-anchor="middle" x="591" y="-73958.47" font-family="Arial" font-size="10.00">Layer 7 QKV Proj GPU1</text>
<text text-anchor="middle" x="591" y="-73947.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="591" y="-73936.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer6_ffn_ar&#45;&gt;layer7_qkv_1 -->
<g id="edge118" class="edge">
<title>layer6_ffn_ar&#45;&gt;layer7_qkv_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M460.44,-74045.42C488.94,-74024.81 524.52,-73999.06 551.34,-73979.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="553.67,-73982.3 559.72,-73973.6 549.57,-73976.62 553.67,-73982.3"/>
</g>
<!-- layer7_attn_0 -->
<g id="node105" class="node">
<title>layer7_attn_0</title>
<path fill="#e6f3ff" stroke="black" d="M382,-73854.47C382,-73854.47 84,-73854.47 84,-73854.47 78,-73854.47 72,-73848.47 72,-73842.47 72,-73842.47 72,-73819.47 72,-73819.47 72,-73813.47 78,-73807.47 84,-73807.47 84,-73807.47 382,-73807.47 382,-73807.47 388,-73807.47 394,-73813.47 394,-73819.47 394,-73819.47 394,-73842.47 394,-73842.47 394,-73848.47 388,-73854.47 382,-73854.47"/>
<text text-anchor="middle" x="233" y="-73839.47" font-family="Arial" font-size="10.00">Layer 7 Attention GPU0</text>
<text text-anchor="middle" x="233" y="-73828.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="233" y="-73817.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer7_qkv_0&#45;&gt;layer7_attn_0 -->
<g id="edge119" class="edge">
<title>layer7_qkv_0&#45;&gt;layer7_attn_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M233,-73926.41C233,-73908.96 233,-73884.55 233,-73864.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="236.5,-73864.86 233,-73854.86 229.5,-73864.86 236.5,-73864.86"/>
</g>
<!-- layer7_attn_1 -->
<g id="node106" class="node">
<title>layer7_attn_1</title>
<path fill="#e6f3ff" stroke="black" d="M740,-73854.47C740,-73854.47 442,-73854.47 442,-73854.47 436,-73854.47 430,-73848.47 430,-73842.47 430,-73842.47 430,-73819.47 430,-73819.47 430,-73813.47 436,-73807.47 442,-73807.47 442,-73807.47 740,-73807.47 740,-73807.47 746,-73807.47 752,-73813.47 752,-73819.47 752,-73819.47 752,-73842.47 752,-73842.47 752,-73848.47 746,-73854.47 740,-73854.47"/>
<text text-anchor="middle" x="591" y="-73839.47" font-family="Arial" font-size="10.00">Layer 7 Attention GPU1</text>
<text text-anchor="middle" x="591" y="-73828.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="591" y="-73817.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer7_qkv_1&#45;&gt;layer7_attn_1 -->
<g id="edge120" class="edge">
<title>layer7_qkv_1&#45;&gt;layer7_attn_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M591,-73926.41C591,-73908.96 591,-73884.55 591,-73864.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="594.5,-73864.86 591,-73854.86 587.5,-73864.86 594.5,-73864.86"/>
</g>
<!-- layer7_attn_out_0 -->
<g id="node107" class="node">
<title>layer7_attn_out_0</title>
<path fill="#e6f3ff" stroke="black" d="M382,-73735.47C382,-73735.47 92,-73735.47 92,-73735.47 86,-73735.47 80,-73729.47 80,-73723.47 80,-73723.47 80,-73700.47 80,-73700.47 80,-73694.47 86,-73688.47 92,-73688.47 92,-73688.47 382,-73688.47 382,-73688.47 388,-73688.47 394,-73694.47 394,-73700.47 394,-73700.47 394,-73723.47 394,-73723.47 394,-73729.47 388,-73735.47 382,-73735.47"/>
<text text-anchor="middle" x="237" y="-73720.47" font-family="Arial" font-size="10.00">Layer 7 Attn Out GPU0</text>
<text text-anchor="middle" x="237" y="-73709.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="237" y="-73698.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer7_attn_0&#45;&gt;layer7_attn_out_0 -->
<g id="edge121" class="edge">
<title>layer7_attn_0&#45;&gt;layer7_attn_out_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M233.77,-73807.41C234.37,-73789.96 235.2,-73765.55 235.87,-73745.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="239.37,-73745.97 236.22,-73735.86 232.38,-73745.73 239.37,-73745.97"/>
</g>
<!-- layer7_attn_out_1 -->
<g id="node108" class="node">
<title>layer7_attn_out_1</title>
<path fill="#e6f3ff" stroke="black" d="M734,-73735.47C734,-73735.47 444,-73735.47 444,-73735.47 438,-73735.47 432,-73729.47 432,-73723.47 432,-73723.47 432,-73700.47 432,-73700.47 432,-73694.47 438,-73688.47 444,-73688.47 444,-73688.47 734,-73688.47 734,-73688.47 740,-73688.47 746,-73694.47 746,-73700.47 746,-73700.47 746,-73723.47 746,-73723.47 746,-73729.47 740,-73735.47 734,-73735.47"/>
<text text-anchor="middle" x="589" y="-73720.47" font-family="Arial" font-size="10.00">Layer 7 Attn Out GPU1</text>
<text text-anchor="middle" x="589" y="-73709.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="589" y="-73698.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer7_attn_1&#45;&gt;layer7_attn_out_1 -->
<g id="edge122" class="edge">
<title>layer7_attn_1&#45;&gt;layer7_attn_out_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M590.61,-73807.41C590.32,-73789.96 589.9,-73765.55 589.56,-73745.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="593.06,-73745.8 589.39,-73735.86 586.06,-73745.92 593.06,-73745.8"/>
</g>
<!-- layer7_attn_ar -->
<g id="node109" class="node">
<title>layer7_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M535.63,-73616.47C535.63,-73616.47 343.87,-73616.47 343.87,-73616.47 337.87,-73616.47 328.21,-73611.72 324.55,-73606.96 324.55,-73606.96 283.7,-73553.97 283.7,-73553.97 280.03,-73549.22 282.37,-73544.47 288.37,-73544.47 288.37,-73544.47 480.13,-73544.47 480.13,-73544.47 486.13,-73544.47 495.79,-73549.22 499.45,-73553.97 499.45,-73553.97 540.3,-73606.96 540.3,-73606.96 543.97,-73611.72 541.63,-73616.47 535.63,-73616.47"/>
<text text-anchor="middle" x="412" y="-73583.47" font-family="Arial" font-size="10.00">Layer 7 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="412" y="-73572.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer7_attn_out_0&#45;&gt;layer7_attn_ar -->
<g id="edge123" class="edge">
<title>layer7_attn_out_0&#45;&gt;layer7_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M267.48,-73688.41C291.92,-73670.33 326.86,-73644.47 356.27,-73622.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="358.45,-73625.45 364.4,-73616.69 354.28,-73619.82 358.45,-73625.45"/>
</g>
<!-- layer7_attn_out_1&#45;&gt;layer7_attn_ar -->
<g id="edge124" class="edge">
<title>layer7_attn_out_1&#45;&gt;layer7_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M558.17,-73688.41C533.45,-73670.33 498.11,-73644.47 468.37,-73622.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="470.28,-73619.77 460.14,-73616.69 466.14,-73625.42 470.28,-73619.77"/>
</g>
<!-- layer7_ffn1_0 -->
<g id="node110" class="node">
<title>layer7_ffn1_0</title>
<path fill="#e6f3ff" stroke="black" d="M382,-73472.47C382,-73472.47 112,-73472.47 112,-73472.47 106,-73472.47 100,-73466.47 100,-73460.47 100,-73460.47 100,-73437.47 100,-73437.47 100,-73431.47 106,-73425.47 112,-73425.47 112,-73425.47 382,-73425.47 382,-73425.47 388,-73425.47 394,-73431.47 394,-73437.47 394,-73437.47 394,-73460.47 394,-73460.47 394,-73466.47 388,-73472.47 382,-73472.47"/>
<text text-anchor="middle" x="247" y="-73457.47" font-family="Arial" font-size="10.00">Layer 7 FFN1 GPU0</text>
<text text-anchor="middle" x="247" y="-73446.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="247" y="-73435.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer7_attn_ar&#45;&gt;layer7_ffn1_0 -->
<g id="edge125" class="edge">
<title>layer7_attn_ar&#45;&gt;layer7_ffn1_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M367.35,-73544.42C341.28,-73523.96 308.78,-73498.45 284.12,-73479.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="286.11,-73476.21 276.08,-73472.79 281.79,-73481.72 286.11,-73476.21"/>
</g>
<!-- layer7_ffn1_1 -->
<g id="node111" class="node">
<title>layer7_ffn1_1</title>
<path fill="#e6f3ff" stroke="black" d="M712,-73472.47C712,-73472.47 442,-73472.47 442,-73472.47 436,-73472.47 430,-73466.47 430,-73460.47 430,-73460.47 430,-73437.47 430,-73437.47 430,-73431.47 436,-73425.47 442,-73425.47 442,-73425.47 712,-73425.47 712,-73425.47 718,-73425.47 724,-73431.47 724,-73437.47 724,-73437.47 724,-73460.47 724,-73460.47 724,-73466.47 718,-73472.47 712,-73472.47"/>
<text text-anchor="middle" x="577" y="-73457.47" font-family="Arial" font-size="10.00">Layer 7 FFN1 GPU1</text>
<text text-anchor="middle" x="577" y="-73446.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="577" y="-73435.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer7_attn_ar&#45;&gt;layer7_ffn1_1 -->
<g id="edge126" class="edge">
<title>layer7_attn_ar&#45;&gt;layer7_ffn1_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M456.65,-73544.42C482.72,-73523.96 515.22,-73498.45 539.88,-73479.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="542.21,-73481.72 547.92,-73472.79 537.89,-73476.21 542.21,-73481.72"/>
</g>
<!-- layer7_act_0 -->
<g id="node112" class="node">
<title>layer7_act_0</title>
<path fill="#e6f3ff" stroke="black" d="M382,-73353.47C382,-73353.47 112,-73353.47 112,-73353.47 106,-73353.47 100,-73347.47 100,-73341.47 100,-73341.47 100,-73318.47 100,-73318.47 100,-73312.47 106,-73306.47 112,-73306.47 112,-73306.47 382,-73306.47 382,-73306.47 388,-73306.47 394,-73312.47 394,-73318.47 394,-73318.47 394,-73341.47 394,-73341.47 394,-73347.47 388,-73353.47 382,-73353.47"/>
<text text-anchor="middle" x="247" y="-73338.47" font-family="Arial" font-size="10.00">Layer 7 SiLU GPU0</text>
<text text-anchor="middle" x="247" y="-73327.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="247" y="-73316.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer7_ffn1_0&#45;&gt;layer7_act_0 -->
<g id="edge127" class="edge">
<title>layer7_ffn1_0&#45;&gt;layer7_act_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M247,-73425.41C247,-73407.96 247,-73383.55 247,-73363.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="250.5,-73363.86 247,-73353.86 243.5,-73363.86 250.5,-73363.86"/>
</g>
<!-- layer7_act_1 -->
<g id="node113" class="node">
<title>layer7_act_1</title>
<path fill="#e6f3ff" stroke="black" d="M712,-73353.47C712,-73353.47 442,-73353.47 442,-73353.47 436,-73353.47 430,-73347.47 430,-73341.47 430,-73341.47 430,-73318.47 430,-73318.47 430,-73312.47 436,-73306.47 442,-73306.47 442,-73306.47 712,-73306.47 712,-73306.47 718,-73306.47 724,-73312.47 724,-73318.47 724,-73318.47 724,-73341.47 724,-73341.47 724,-73347.47 718,-73353.47 712,-73353.47"/>
<text text-anchor="middle" x="577" y="-73338.47" font-family="Arial" font-size="10.00">Layer 7 SiLU GPU1</text>
<text text-anchor="middle" x="577" y="-73327.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="577" y="-73316.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer7_ffn1_1&#45;&gt;layer7_act_1 -->
<g id="edge128" class="edge">
<title>layer7_ffn1_1&#45;&gt;layer7_act_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M577,-73425.41C577,-73407.96 577,-73383.55 577,-73363.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="580.5,-73363.86 577,-73353.86 573.5,-73363.86 580.5,-73363.86"/>
</g>
<!-- layer7_ffn2_0 -->
<g id="node114" class="node">
<title>layer7_ffn2_0</title>
<path fill="#e6f3ff" stroke="black" d="M381.5,-73234.47C381.5,-73234.47 118.5,-73234.47 118.5,-73234.47 112.5,-73234.47 106.5,-73228.47 106.5,-73222.47 106.5,-73222.47 106.5,-73199.47 106.5,-73199.47 106.5,-73193.47 112.5,-73187.47 118.5,-73187.47 118.5,-73187.47 381.5,-73187.47 381.5,-73187.47 387.5,-73187.47 393.5,-73193.47 393.5,-73199.47 393.5,-73199.47 393.5,-73222.47 393.5,-73222.47 393.5,-73228.47 387.5,-73234.47 381.5,-73234.47"/>
<text text-anchor="middle" x="250" y="-73219.47" font-family="Arial" font-size="10.00">Layer 7 FFN2 GPU0</text>
<text text-anchor="middle" x="250" y="-73208.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="250" y="-73197.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer7_act_0&#45;&gt;layer7_ffn2_0 -->
<g id="edge129" class="edge">
<title>layer7_act_0&#45;&gt;layer7_ffn2_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M247.58,-73306.41C248.03,-73288.96 248.65,-73264.55 249.16,-73244.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="252.66,-73244.94 249.41,-73234.86 245.66,-73244.76 252.66,-73244.94"/>
</g>
<!-- layer7_ffn2_1 -->
<g id="node115" class="node">
<title>layer7_ffn2_1</title>
<path fill="#e6f3ff" stroke="black" d="M706.5,-73234.47C706.5,-73234.47 443.5,-73234.47 443.5,-73234.47 437.5,-73234.47 431.5,-73228.47 431.5,-73222.47 431.5,-73222.47 431.5,-73199.47 431.5,-73199.47 431.5,-73193.47 437.5,-73187.47 443.5,-73187.47 443.5,-73187.47 706.5,-73187.47 706.5,-73187.47 712.5,-73187.47 718.5,-73193.47 718.5,-73199.47 718.5,-73199.47 718.5,-73222.47 718.5,-73222.47 718.5,-73228.47 712.5,-73234.47 706.5,-73234.47"/>
<text text-anchor="middle" x="575" y="-73219.47" font-family="Arial" font-size="10.00">Layer 7 FFN2 GPU1</text>
<text text-anchor="middle" x="575" y="-73208.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="575" y="-73197.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer7_act_1&#45;&gt;layer7_ffn2_1 -->
<g id="edge130" class="edge">
<title>layer7_act_1&#45;&gt;layer7_ffn2_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M576.61,-73306.41C576.32,-73288.96 575.9,-73264.55 575.56,-73244.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="579.06,-73244.8 575.39,-73234.86 572.06,-73244.92 579.06,-73244.8"/>
</g>
<!-- layer7_ffn_ar -->
<g id="node116" class="node">
<title>layer7_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M537.85,-73115.47C537.85,-73115.47 340.97,-73115.47 340.97,-73115.47 334.97,-73115.47 325.25,-73110.76 321.54,-73106.05 321.54,-73106.05 279.58,-73052.89 279.58,-73052.89 275.87,-73048.18 278.15,-73043.47 284.15,-73043.47 284.15,-73043.47 481.03,-73043.47 481.03,-73043.47 487.03,-73043.47 496.75,-73048.18 500.46,-73052.89 500.46,-73052.89 542.42,-73106.05 542.42,-73106.05 546.13,-73110.76 543.85,-73115.47 537.85,-73115.47"/>
<text text-anchor="middle" x="411" y="-73082.47" font-family="Arial" font-size="10.00">Layer 7 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="411" y="-73071.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer7_ffn2_0&#45;&gt;layer7_ffn_ar -->
<g id="edge131" class="edge">
<title>layer7_ffn2_0&#45;&gt;layer7_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M278.04,-73187.41C300.43,-73169.41 332.4,-73143.69 359.38,-73121.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="361.61,-73124.68 367.21,-73115.69 357.23,-73119.23 361.61,-73124.68"/>
</g>
<!-- layer7_ffn2_1&#45;&gt;layer7_ffn_ar -->
<g id="edge132" class="edge">
<title>layer7_ffn2_1&#45;&gt;layer7_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M546.43,-73187.41C523.63,-73169.41 491.06,-73143.69 463.58,-73121.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="465.62,-73119.14 455.6,-73115.69 461.28,-73124.63 465.62,-73119.14"/>
</g>
<!-- layer8_qkv_0 -->
<g id="node117" class="node">
<title>layer8_qkv_0</title>
<path fill="#e6f3ff" stroke="black" d="M381,-72971.47C381,-72971.47 83,-72971.47 83,-72971.47 77,-72971.47 71,-72965.47 71,-72959.47 71,-72959.47 71,-72936.47 71,-72936.47 71,-72930.47 77,-72924.47 83,-72924.47 83,-72924.47 381,-72924.47 381,-72924.47 387,-72924.47 393,-72930.47 393,-72936.47 393,-72936.47 393,-72959.47 393,-72959.47 393,-72965.47 387,-72971.47 381,-72971.47"/>
<text text-anchor="middle" x="232" y="-72956.47" font-family="Arial" font-size="10.00">Layer 8 QKV Proj GPU0</text>
<text text-anchor="middle" x="232" y="-72945.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="232" y="-72934.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer7_ffn_ar&#45;&gt;layer8_qkv_0 -->
<g id="edge133" class="edge">
<title>layer7_ffn_ar&#45;&gt;layer8_qkv_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M362.56,-73043.42C334.06,-73022.81 298.48,-72997.06 271.66,-72977.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="273.43,-72974.62 263.28,-72971.6 269.33,-72980.3 273.43,-72974.62"/>
</g>
<!-- layer8_qkv_1 -->
<g id="node118" class="node">
<title>layer8_qkv_1</title>
<path fill="#e6f3ff" stroke="black" d="M739,-72971.47C739,-72971.47 441,-72971.47 441,-72971.47 435,-72971.47 429,-72965.47 429,-72959.47 429,-72959.47 429,-72936.47 429,-72936.47 429,-72930.47 435,-72924.47 441,-72924.47 441,-72924.47 739,-72924.47 739,-72924.47 745,-72924.47 751,-72930.47 751,-72936.47 751,-72936.47 751,-72959.47 751,-72959.47 751,-72965.47 745,-72971.47 739,-72971.47"/>
<text text-anchor="middle" x="590" y="-72956.47" font-family="Arial" font-size="10.00">Layer 8 QKV Proj GPU1</text>
<text text-anchor="middle" x="590" y="-72945.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="590" y="-72934.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer7_ffn_ar&#45;&gt;layer8_qkv_1 -->
<g id="edge134" class="edge">
<title>layer7_ffn_ar&#45;&gt;layer8_qkv_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M459.44,-73043.42C487.94,-73022.81 523.52,-72997.06 550.34,-72977.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="552.67,-72980.3 558.72,-72971.6 548.57,-72974.62 552.67,-72980.3"/>
</g>
<!-- layer8_attn_0 -->
<g id="node119" class="node">
<title>layer8_attn_0</title>
<path fill="#e6f3ff" stroke="black" d="M381,-72852.47C381,-72852.47 83,-72852.47 83,-72852.47 77,-72852.47 71,-72846.47 71,-72840.47 71,-72840.47 71,-72817.47 71,-72817.47 71,-72811.47 77,-72805.47 83,-72805.47 83,-72805.47 381,-72805.47 381,-72805.47 387,-72805.47 393,-72811.47 393,-72817.47 393,-72817.47 393,-72840.47 393,-72840.47 393,-72846.47 387,-72852.47 381,-72852.47"/>
<text text-anchor="middle" x="232" y="-72837.47" font-family="Arial" font-size="10.00">Layer 8 Attention GPU0</text>
<text text-anchor="middle" x="232" y="-72826.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="232" y="-72815.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer8_qkv_0&#45;&gt;layer8_attn_0 -->
<g id="edge135" class="edge">
<title>layer8_qkv_0&#45;&gt;layer8_attn_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M232,-72924.41C232,-72906.96 232,-72882.55 232,-72862.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="235.5,-72862.86 232,-72852.86 228.5,-72862.86 235.5,-72862.86"/>
</g>
<!-- layer8_attn_1 -->
<g id="node120" class="node">
<title>layer8_attn_1</title>
<path fill="#e6f3ff" stroke="black" d="M739,-72852.47C739,-72852.47 441,-72852.47 441,-72852.47 435,-72852.47 429,-72846.47 429,-72840.47 429,-72840.47 429,-72817.47 429,-72817.47 429,-72811.47 435,-72805.47 441,-72805.47 441,-72805.47 739,-72805.47 739,-72805.47 745,-72805.47 751,-72811.47 751,-72817.47 751,-72817.47 751,-72840.47 751,-72840.47 751,-72846.47 745,-72852.47 739,-72852.47"/>
<text text-anchor="middle" x="590" y="-72837.47" font-family="Arial" font-size="10.00">Layer 8 Attention GPU1</text>
<text text-anchor="middle" x="590" y="-72826.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="590" y="-72815.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer8_qkv_1&#45;&gt;layer8_attn_1 -->
<g id="edge136" class="edge">
<title>layer8_qkv_1&#45;&gt;layer8_attn_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M590,-72924.41C590,-72906.96 590,-72882.55 590,-72862.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="593.5,-72862.86 590,-72852.86 586.5,-72862.86 593.5,-72862.86"/>
</g>
<!-- layer8_attn_out_0 -->
<g id="node121" class="node">
<title>layer8_attn_out_0</title>
<path fill="#e6f3ff" stroke="black" d="M381,-72733.47C381,-72733.47 91,-72733.47 91,-72733.47 85,-72733.47 79,-72727.47 79,-72721.47 79,-72721.47 79,-72698.47 79,-72698.47 79,-72692.47 85,-72686.47 91,-72686.47 91,-72686.47 381,-72686.47 381,-72686.47 387,-72686.47 393,-72692.47 393,-72698.47 393,-72698.47 393,-72721.47 393,-72721.47 393,-72727.47 387,-72733.47 381,-72733.47"/>
<text text-anchor="middle" x="236" y="-72718.47" font-family="Arial" font-size="10.00">Layer 8 Attn Out GPU0</text>
<text text-anchor="middle" x="236" y="-72707.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="236" y="-72696.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer8_attn_0&#45;&gt;layer8_attn_out_0 -->
<g id="edge137" class="edge">
<title>layer8_attn_0&#45;&gt;layer8_attn_out_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M232.77,-72805.41C233.37,-72787.96 234.2,-72763.55 234.87,-72743.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="238.37,-72743.97 235.22,-72733.86 231.38,-72743.73 238.37,-72743.97"/>
</g>
<!-- layer8_attn_out_1 -->
<g id="node122" class="node">
<title>layer8_attn_out_1</title>
<path fill="#e6f3ff" stroke="black" d="M733,-72733.47C733,-72733.47 443,-72733.47 443,-72733.47 437,-72733.47 431,-72727.47 431,-72721.47 431,-72721.47 431,-72698.47 431,-72698.47 431,-72692.47 437,-72686.47 443,-72686.47 443,-72686.47 733,-72686.47 733,-72686.47 739,-72686.47 745,-72692.47 745,-72698.47 745,-72698.47 745,-72721.47 745,-72721.47 745,-72727.47 739,-72733.47 733,-72733.47"/>
<text text-anchor="middle" x="588" y="-72718.47" font-family="Arial" font-size="10.00">Layer 8 Attn Out GPU1</text>
<text text-anchor="middle" x="588" y="-72707.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="588" y="-72696.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer8_attn_1&#45;&gt;layer8_attn_out_1 -->
<g id="edge138" class="edge">
<title>layer8_attn_1&#45;&gt;layer8_attn_out_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M589.61,-72805.41C589.32,-72787.96 588.9,-72763.55 588.56,-72743.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="592.06,-72743.8 588.39,-72733.86 585.06,-72743.92 592.06,-72743.8"/>
</g>
<!-- layer8_attn_ar -->
<g id="node123" class="node">
<title>layer8_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M534.63,-72614.47C534.63,-72614.47 342.87,-72614.47 342.87,-72614.47 336.87,-72614.47 327.21,-72609.72 323.55,-72604.96 323.55,-72604.96 282.7,-72551.97 282.7,-72551.97 279.03,-72547.22 281.37,-72542.47 287.37,-72542.47 287.37,-72542.47 479.13,-72542.47 479.13,-72542.47 485.13,-72542.47 494.79,-72547.22 498.45,-72551.97 498.45,-72551.97 539.3,-72604.96 539.3,-72604.96 542.97,-72609.72 540.63,-72614.47 534.63,-72614.47"/>
<text text-anchor="middle" x="411" y="-72581.47" font-family="Arial" font-size="10.00">Layer 8 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="411" y="-72570.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer8_attn_out_0&#45;&gt;layer8_attn_ar -->
<g id="edge139" class="edge">
<title>layer8_attn_out_0&#45;&gt;layer8_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M266.48,-72686.41C290.92,-72668.33 325.86,-72642.47 355.27,-72620.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="357.45,-72623.45 363.4,-72614.69 353.28,-72617.82 357.45,-72623.45"/>
</g>
<!-- layer8_attn_out_1&#45;&gt;layer8_attn_ar -->
<g id="edge140" class="edge">
<title>layer8_attn_out_1&#45;&gt;layer8_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M557.17,-72686.41C532.45,-72668.33 497.11,-72642.47 467.37,-72620.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="469.28,-72617.77 459.14,-72614.69 465.14,-72623.42 469.28,-72617.77"/>
</g>
<!-- layer8_ffn1_0 -->
<g id="node124" class="node">
<title>layer8_ffn1_0</title>
<path fill="#e6f3ff" stroke="black" d="M381,-72470.47C381,-72470.47 111,-72470.47 111,-72470.47 105,-72470.47 99,-72464.47 99,-72458.47 99,-72458.47 99,-72435.47 99,-72435.47 99,-72429.47 105,-72423.47 111,-72423.47 111,-72423.47 381,-72423.47 381,-72423.47 387,-72423.47 393,-72429.47 393,-72435.47 393,-72435.47 393,-72458.47 393,-72458.47 393,-72464.47 387,-72470.47 381,-72470.47"/>
<text text-anchor="middle" x="246" y="-72455.47" font-family="Arial" font-size="10.00">Layer 8 FFN1 GPU0</text>
<text text-anchor="middle" x="246" y="-72444.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="246" y="-72433.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer8_attn_ar&#45;&gt;layer8_ffn1_0 -->
<g id="edge141" class="edge">
<title>layer8_attn_ar&#45;&gt;layer8_ffn1_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M366.35,-72542.42C340.28,-72521.96 307.78,-72496.45 283.12,-72477.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="285.11,-72474.21 275.08,-72470.79 280.79,-72479.72 285.11,-72474.21"/>
</g>
<!-- layer8_ffn1_1 -->
<g id="node125" class="node">
<title>layer8_ffn1_1</title>
<path fill="#e6f3ff" stroke="black" d="M711,-72470.47C711,-72470.47 441,-72470.47 441,-72470.47 435,-72470.47 429,-72464.47 429,-72458.47 429,-72458.47 429,-72435.47 429,-72435.47 429,-72429.47 435,-72423.47 441,-72423.47 441,-72423.47 711,-72423.47 711,-72423.47 717,-72423.47 723,-72429.47 723,-72435.47 723,-72435.47 723,-72458.47 723,-72458.47 723,-72464.47 717,-72470.47 711,-72470.47"/>
<text text-anchor="middle" x="576" y="-72455.47" font-family="Arial" font-size="10.00">Layer 8 FFN1 GPU1</text>
<text text-anchor="middle" x="576" y="-72444.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="576" y="-72433.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer8_attn_ar&#45;&gt;layer8_ffn1_1 -->
<g id="edge142" class="edge">
<title>layer8_attn_ar&#45;&gt;layer8_ffn1_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M455.65,-72542.42C481.72,-72521.96 514.22,-72496.45 538.88,-72477.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="541.21,-72479.72 546.92,-72470.79 536.89,-72474.21 541.21,-72479.72"/>
</g>
<!-- layer8_act_0 -->
<g id="node126" class="node">
<title>layer8_act_0</title>
<path fill="#e6f3ff" stroke="black" d="M381,-72351.47C381,-72351.47 111,-72351.47 111,-72351.47 105,-72351.47 99,-72345.47 99,-72339.47 99,-72339.47 99,-72316.47 99,-72316.47 99,-72310.47 105,-72304.47 111,-72304.47 111,-72304.47 381,-72304.47 381,-72304.47 387,-72304.47 393,-72310.47 393,-72316.47 393,-72316.47 393,-72339.47 393,-72339.47 393,-72345.47 387,-72351.47 381,-72351.47"/>
<text text-anchor="middle" x="246" y="-72336.47" font-family="Arial" font-size="10.00">Layer 8 SiLU GPU0</text>
<text text-anchor="middle" x="246" y="-72325.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="246" y="-72314.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer8_ffn1_0&#45;&gt;layer8_act_0 -->
<g id="edge143" class="edge">
<title>layer8_ffn1_0&#45;&gt;layer8_act_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M246,-72423.41C246,-72405.96 246,-72381.55 246,-72361.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="249.5,-72361.86 246,-72351.86 242.5,-72361.86 249.5,-72361.86"/>
</g>
<!-- layer8_act_1 -->
<g id="node127" class="node">
<title>layer8_act_1</title>
<path fill="#e6f3ff" stroke="black" d="M711,-72351.47C711,-72351.47 441,-72351.47 441,-72351.47 435,-72351.47 429,-72345.47 429,-72339.47 429,-72339.47 429,-72316.47 429,-72316.47 429,-72310.47 435,-72304.47 441,-72304.47 441,-72304.47 711,-72304.47 711,-72304.47 717,-72304.47 723,-72310.47 723,-72316.47 723,-72316.47 723,-72339.47 723,-72339.47 723,-72345.47 717,-72351.47 711,-72351.47"/>
<text text-anchor="middle" x="576" y="-72336.47" font-family="Arial" font-size="10.00">Layer 8 SiLU GPU1</text>
<text text-anchor="middle" x="576" y="-72325.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="576" y="-72314.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer8_ffn1_1&#45;&gt;layer8_act_1 -->
<g id="edge144" class="edge">
<title>layer8_ffn1_1&#45;&gt;layer8_act_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M576,-72423.41C576,-72405.96 576,-72381.55 576,-72361.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="579.5,-72361.86 576,-72351.86 572.5,-72361.86 579.5,-72361.86"/>
</g>
<!-- layer8_ffn2_0 -->
<g id="node128" class="node">
<title>layer8_ffn2_0</title>
<path fill="#e6f3ff" stroke="black" d="M380.5,-72232.47C380.5,-72232.47 117.5,-72232.47 117.5,-72232.47 111.5,-72232.47 105.5,-72226.47 105.5,-72220.47 105.5,-72220.47 105.5,-72197.47 105.5,-72197.47 105.5,-72191.47 111.5,-72185.47 117.5,-72185.47 117.5,-72185.47 380.5,-72185.47 380.5,-72185.47 386.5,-72185.47 392.5,-72191.47 392.5,-72197.47 392.5,-72197.47 392.5,-72220.47 392.5,-72220.47 392.5,-72226.47 386.5,-72232.47 380.5,-72232.47"/>
<text text-anchor="middle" x="249" y="-72217.47" font-family="Arial" font-size="10.00">Layer 8 FFN2 GPU0</text>
<text text-anchor="middle" x="249" y="-72206.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="249" y="-72195.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer8_act_0&#45;&gt;layer8_ffn2_0 -->
<g id="edge145" class="edge">
<title>layer8_act_0&#45;&gt;layer8_ffn2_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M246.58,-72304.41C247.03,-72286.96 247.65,-72262.55 248.16,-72242.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="251.66,-72242.94 248.41,-72232.86 244.66,-72242.76 251.66,-72242.94"/>
</g>
<!-- layer8_ffn2_1 -->
<g id="node129" class="node">
<title>layer8_ffn2_1</title>
<path fill="#e6f3ff" stroke="black" d="M705.5,-72232.47C705.5,-72232.47 442.5,-72232.47 442.5,-72232.47 436.5,-72232.47 430.5,-72226.47 430.5,-72220.47 430.5,-72220.47 430.5,-72197.47 430.5,-72197.47 430.5,-72191.47 436.5,-72185.47 442.5,-72185.47 442.5,-72185.47 705.5,-72185.47 705.5,-72185.47 711.5,-72185.47 717.5,-72191.47 717.5,-72197.47 717.5,-72197.47 717.5,-72220.47 717.5,-72220.47 717.5,-72226.47 711.5,-72232.47 705.5,-72232.47"/>
<text text-anchor="middle" x="574" y="-72217.47" font-family="Arial" font-size="10.00">Layer 8 FFN2 GPU1</text>
<text text-anchor="middle" x="574" y="-72206.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="574" y="-72195.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer8_act_1&#45;&gt;layer8_ffn2_1 -->
<g id="edge146" class="edge">
<title>layer8_act_1&#45;&gt;layer8_ffn2_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M575.61,-72304.41C575.32,-72286.96 574.9,-72262.55 574.56,-72242.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="578.06,-72242.8 574.39,-72232.86 571.06,-72242.92 578.06,-72242.8"/>
</g>
<!-- layer8_ffn_ar -->
<g id="node130" class="node">
<title>layer8_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M536.85,-72113.47C536.85,-72113.47 339.97,-72113.47 339.97,-72113.47 333.97,-72113.47 324.25,-72108.76 320.54,-72104.05 320.54,-72104.05 278.58,-72050.89 278.58,-72050.89 274.87,-72046.18 277.15,-72041.47 283.15,-72041.47 283.15,-72041.47 480.03,-72041.47 480.03,-72041.47 486.03,-72041.47 495.75,-72046.18 499.46,-72050.89 499.46,-72050.89 541.42,-72104.05 541.42,-72104.05 545.13,-72108.76 542.85,-72113.47 536.85,-72113.47"/>
<text text-anchor="middle" x="410" y="-72080.47" font-family="Arial" font-size="10.00">Layer 8 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="410" y="-72069.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer8_ffn2_0&#45;&gt;layer8_ffn_ar -->
<g id="edge147" class="edge">
<title>layer8_ffn2_0&#45;&gt;layer8_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M277.04,-72185.41C299.43,-72167.41 331.4,-72141.69 358.38,-72119.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="360.61,-72122.68 366.21,-72113.69 356.23,-72117.23 360.61,-72122.68"/>
</g>
<!-- layer8_ffn2_1&#45;&gt;layer8_ffn_ar -->
<g id="edge148" class="edge">
<title>layer8_ffn2_1&#45;&gt;layer8_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M545.43,-72185.41C522.63,-72167.41 490.06,-72141.69 462.58,-72119.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="464.62,-72117.14 454.6,-72113.69 460.28,-72122.63 464.62,-72117.14"/>
</g>
<!-- layer9_qkv_0 -->
<g id="node131" class="node">
<title>layer9_qkv_0</title>
<path fill="#e6f3ff" stroke="black" d="M380,-71969.47C380,-71969.47 82,-71969.47 82,-71969.47 76,-71969.47 70,-71963.47 70,-71957.47 70,-71957.47 70,-71934.47 70,-71934.47 70,-71928.47 76,-71922.47 82,-71922.47 82,-71922.47 380,-71922.47 380,-71922.47 386,-71922.47 392,-71928.47 392,-71934.47 392,-71934.47 392,-71957.47 392,-71957.47 392,-71963.47 386,-71969.47 380,-71969.47"/>
<text text-anchor="middle" x="231" y="-71954.47" font-family="Arial" font-size="10.00">Layer 9 QKV Proj GPU0</text>
<text text-anchor="middle" x="231" y="-71943.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="231" y="-71932.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer8_ffn_ar&#45;&gt;layer9_qkv_0 -->
<g id="edge149" class="edge">
<title>layer8_ffn_ar&#45;&gt;layer9_qkv_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M361.56,-72041.42C333.06,-72020.81 297.48,-71995.06 270.66,-71975.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="272.43,-71972.62 262.28,-71969.6 268.33,-71978.3 272.43,-71972.62"/>
</g>
<!-- layer9_qkv_1 -->
<g id="node132" class="node">
<title>layer9_qkv_1</title>
<path fill="#e6f3ff" stroke="black" d="M738,-71969.47C738,-71969.47 440,-71969.47 440,-71969.47 434,-71969.47 428,-71963.47 428,-71957.47 428,-71957.47 428,-71934.47 428,-71934.47 428,-71928.47 434,-71922.47 440,-71922.47 440,-71922.47 738,-71922.47 738,-71922.47 744,-71922.47 750,-71928.47 750,-71934.47 750,-71934.47 750,-71957.47 750,-71957.47 750,-71963.47 744,-71969.47 738,-71969.47"/>
<text text-anchor="middle" x="589" y="-71954.47" font-family="Arial" font-size="10.00">Layer 9 QKV Proj GPU1</text>
<text text-anchor="middle" x="589" y="-71943.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="589" y="-71932.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer8_ffn_ar&#45;&gt;layer9_qkv_1 -->
<g id="edge150" class="edge">
<title>layer8_ffn_ar&#45;&gt;layer9_qkv_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M458.44,-72041.42C486.94,-72020.81 522.52,-71995.06 549.34,-71975.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="551.67,-71978.3 557.72,-71969.6 547.57,-71972.62 551.67,-71978.3"/>
</g>
<!-- layer9_attn_0 -->
<g id="node133" class="node">
<title>layer9_attn_0</title>
<path fill="#e6f3ff" stroke="black" d="M380,-71850.47C380,-71850.47 82,-71850.47 82,-71850.47 76,-71850.47 70,-71844.47 70,-71838.47 70,-71838.47 70,-71815.47 70,-71815.47 70,-71809.47 76,-71803.47 82,-71803.47 82,-71803.47 380,-71803.47 380,-71803.47 386,-71803.47 392,-71809.47 392,-71815.47 392,-71815.47 392,-71838.47 392,-71838.47 392,-71844.47 386,-71850.47 380,-71850.47"/>
<text text-anchor="middle" x="231" y="-71835.47" font-family="Arial" font-size="10.00">Layer 9 Attention GPU0</text>
<text text-anchor="middle" x="231" y="-71824.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="231" y="-71813.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer9_qkv_0&#45;&gt;layer9_attn_0 -->
<g id="edge151" class="edge">
<title>layer9_qkv_0&#45;&gt;layer9_attn_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M231,-71922.41C231,-71904.96 231,-71880.55 231,-71860.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="234.5,-71860.86 231,-71850.86 227.5,-71860.86 234.5,-71860.86"/>
</g>
<!-- layer9_attn_1 -->
<g id="node134" class="node">
<title>layer9_attn_1</title>
<path fill="#e6f3ff" stroke="black" d="M738,-71850.47C738,-71850.47 440,-71850.47 440,-71850.47 434,-71850.47 428,-71844.47 428,-71838.47 428,-71838.47 428,-71815.47 428,-71815.47 428,-71809.47 434,-71803.47 440,-71803.47 440,-71803.47 738,-71803.47 738,-71803.47 744,-71803.47 750,-71809.47 750,-71815.47 750,-71815.47 750,-71838.47 750,-71838.47 750,-71844.47 744,-71850.47 738,-71850.47"/>
<text text-anchor="middle" x="589" y="-71835.47" font-family="Arial" font-size="10.00">Layer 9 Attention GPU1</text>
<text text-anchor="middle" x="589" y="-71824.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="589" y="-71813.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer9_qkv_1&#45;&gt;layer9_attn_1 -->
<g id="edge152" class="edge">
<title>layer9_qkv_1&#45;&gt;layer9_attn_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M589,-71922.41C589,-71904.96 589,-71880.55 589,-71860.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="592.5,-71860.86 589,-71850.86 585.5,-71860.86 592.5,-71860.86"/>
</g>
<!-- layer9_attn_out_0 -->
<g id="node135" class="node">
<title>layer9_attn_out_0</title>
<path fill="#e6f3ff" stroke="black" d="M380,-71731.47C380,-71731.47 90,-71731.47 90,-71731.47 84,-71731.47 78,-71725.47 78,-71719.47 78,-71719.47 78,-71696.47 78,-71696.47 78,-71690.47 84,-71684.47 90,-71684.47 90,-71684.47 380,-71684.47 380,-71684.47 386,-71684.47 392,-71690.47 392,-71696.47 392,-71696.47 392,-71719.47 392,-71719.47 392,-71725.47 386,-71731.47 380,-71731.47"/>
<text text-anchor="middle" x="235" y="-71716.47" font-family="Arial" font-size="10.00">Layer 9 Attn Out GPU0</text>
<text text-anchor="middle" x="235" y="-71705.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="235" y="-71694.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer9_attn_0&#45;&gt;layer9_attn_out_0 -->
<g id="edge153" class="edge">
<title>layer9_attn_0&#45;&gt;layer9_attn_out_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M231.77,-71803.41C232.37,-71785.96 233.2,-71761.55 233.87,-71741.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="237.37,-71741.97 234.22,-71731.86 230.38,-71741.73 237.37,-71741.97"/>
</g>
<!-- layer9_attn_out_1 -->
<g id="node136" class="node">
<title>layer9_attn_out_1</title>
<path fill="#e6f3ff" stroke="black" d="M732,-71731.47C732,-71731.47 442,-71731.47 442,-71731.47 436,-71731.47 430,-71725.47 430,-71719.47 430,-71719.47 430,-71696.47 430,-71696.47 430,-71690.47 436,-71684.47 442,-71684.47 442,-71684.47 732,-71684.47 732,-71684.47 738,-71684.47 744,-71690.47 744,-71696.47 744,-71696.47 744,-71719.47 744,-71719.47 744,-71725.47 738,-71731.47 732,-71731.47"/>
<text text-anchor="middle" x="587" y="-71716.47" font-family="Arial" font-size="10.00">Layer 9 Attn Out GPU1</text>
<text text-anchor="middle" x="587" y="-71705.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="587" y="-71694.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer9_attn_1&#45;&gt;layer9_attn_out_1 -->
<g id="edge154" class="edge">
<title>layer9_attn_1&#45;&gt;layer9_attn_out_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M588.61,-71803.41C588.32,-71785.96 587.9,-71761.55 587.56,-71741.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="591.06,-71741.8 587.39,-71731.86 584.06,-71741.92 591.06,-71741.8"/>
</g>
<!-- layer9_attn_ar -->
<g id="node137" class="node">
<title>layer9_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M533.63,-71612.47C533.63,-71612.47 341.87,-71612.47 341.87,-71612.47 335.87,-71612.47 326.21,-71607.72 322.55,-71602.96 322.55,-71602.96 281.7,-71549.97 281.7,-71549.97 278.03,-71545.22 280.37,-71540.47 286.37,-71540.47 286.37,-71540.47 478.13,-71540.47 478.13,-71540.47 484.13,-71540.47 493.79,-71545.22 497.45,-71549.97 497.45,-71549.97 538.3,-71602.96 538.3,-71602.96 541.97,-71607.72 539.63,-71612.47 533.63,-71612.47"/>
<text text-anchor="middle" x="410" y="-71579.47" font-family="Arial" font-size="10.00">Layer 9 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="410" y="-71568.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer9_attn_out_0&#45;&gt;layer9_attn_ar -->
<g id="edge155" class="edge">
<title>layer9_attn_out_0&#45;&gt;layer9_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M265.48,-71684.41C289.92,-71666.33 324.86,-71640.47 354.27,-71618.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="356.45,-71621.45 362.4,-71612.69 352.28,-71615.82 356.45,-71621.45"/>
</g>
<!-- layer9_attn_out_1&#45;&gt;layer9_attn_ar -->
<g id="edge156" class="edge">
<title>layer9_attn_out_1&#45;&gt;layer9_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M556.17,-71684.41C531.45,-71666.33 496.11,-71640.47 466.37,-71618.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="468.28,-71615.77 458.14,-71612.69 464.14,-71621.42 468.28,-71615.77"/>
</g>
<!-- layer9_ffn1_0 -->
<g id="node138" class="node">
<title>layer9_ffn1_0</title>
<path fill="#e6f3ff" stroke="black" d="M380,-71468.47C380,-71468.47 110,-71468.47 110,-71468.47 104,-71468.47 98,-71462.47 98,-71456.47 98,-71456.47 98,-71433.47 98,-71433.47 98,-71427.47 104,-71421.47 110,-71421.47 110,-71421.47 380,-71421.47 380,-71421.47 386,-71421.47 392,-71427.47 392,-71433.47 392,-71433.47 392,-71456.47 392,-71456.47 392,-71462.47 386,-71468.47 380,-71468.47"/>
<text text-anchor="middle" x="245" y="-71453.47" font-family="Arial" font-size="10.00">Layer 9 FFN1 GPU0</text>
<text text-anchor="middle" x="245" y="-71442.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="245" y="-71431.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer9_attn_ar&#45;&gt;layer9_ffn1_0 -->
<g id="edge157" class="edge">
<title>layer9_attn_ar&#45;&gt;layer9_ffn1_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M365.35,-71540.42C339.28,-71519.96 306.78,-71494.45 282.12,-71475.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="284.11,-71472.21 274.08,-71468.79 279.79,-71477.72 284.11,-71472.21"/>
</g>
<!-- layer9_ffn1_1 -->
<g id="node139" class="node">
<title>layer9_ffn1_1</title>
<path fill="#e6f3ff" stroke="black" d="M710,-71468.47C710,-71468.47 440,-71468.47 440,-71468.47 434,-71468.47 428,-71462.47 428,-71456.47 428,-71456.47 428,-71433.47 428,-71433.47 428,-71427.47 434,-71421.47 440,-71421.47 440,-71421.47 710,-71421.47 710,-71421.47 716,-71421.47 722,-71427.47 722,-71433.47 722,-71433.47 722,-71456.47 722,-71456.47 722,-71462.47 716,-71468.47 710,-71468.47"/>
<text text-anchor="middle" x="575" y="-71453.47" font-family="Arial" font-size="10.00">Layer 9 FFN1 GPU1</text>
<text text-anchor="middle" x="575" y="-71442.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="575" y="-71431.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer9_attn_ar&#45;&gt;layer9_ffn1_1 -->
<g id="edge158" class="edge">
<title>layer9_attn_ar&#45;&gt;layer9_ffn1_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M454.65,-71540.42C480.72,-71519.96 513.22,-71494.45 537.88,-71475.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="540.21,-71477.72 545.92,-71468.79 535.89,-71472.21 540.21,-71477.72"/>
</g>
<!-- layer9_act_0 -->
<g id="node140" class="node">
<title>layer9_act_0</title>
<path fill="#e6f3ff" stroke="black" d="M380,-71349.47C380,-71349.47 110,-71349.47 110,-71349.47 104,-71349.47 98,-71343.47 98,-71337.47 98,-71337.47 98,-71314.47 98,-71314.47 98,-71308.47 104,-71302.47 110,-71302.47 110,-71302.47 380,-71302.47 380,-71302.47 386,-71302.47 392,-71308.47 392,-71314.47 392,-71314.47 392,-71337.47 392,-71337.47 392,-71343.47 386,-71349.47 380,-71349.47"/>
<text text-anchor="middle" x="245" y="-71334.47" font-family="Arial" font-size="10.00">Layer 9 SiLU GPU0</text>
<text text-anchor="middle" x="245" y="-71323.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="245" y="-71312.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer9_ffn1_0&#45;&gt;layer9_act_0 -->
<g id="edge159" class="edge">
<title>layer9_ffn1_0&#45;&gt;layer9_act_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M245,-71421.41C245,-71403.96 245,-71379.55 245,-71359.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="248.5,-71359.86 245,-71349.86 241.5,-71359.86 248.5,-71359.86"/>
</g>
<!-- layer9_act_1 -->
<g id="node141" class="node">
<title>layer9_act_1</title>
<path fill="#e6f3ff" stroke="black" d="M710,-71349.47C710,-71349.47 440,-71349.47 440,-71349.47 434,-71349.47 428,-71343.47 428,-71337.47 428,-71337.47 428,-71314.47 428,-71314.47 428,-71308.47 434,-71302.47 440,-71302.47 440,-71302.47 710,-71302.47 710,-71302.47 716,-71302.47 722,-71308.47 722,-71314.47 722,-71314.47 722,-71337.47 722,-71337.47 722,-71343.47 716,-71349.47 710,-71349.47"/>
<text text-anchor="middle" x="575" y="-71334.47" font-family="Arial" font-size="10.00">Layer 9 SiLU GPU1</text>
<text text-anchor="middle" x="575" y="-71323.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="575" y="-71312.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer9_ffn1_1&#45;&gt;layer9_act_1 -->
<g id="edge160" class="edge">
<title>layer9_ffn1_1&#45;&gt;layer9_act_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M575,-71421.41C575,-71403.96 575,-71379.55 575,-71359.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="578.5,-71359.86 575,-71349.86 571.5,-71359.86 578.5,-71359.86"/>
</g>
<!-- layer9_ffn2_0 -->
<g id="node142" class="node">
<title>layer9_ffn2_0</title>
<path fill="#e6f3ff" stroke="black" d="M379.5,-71230.47C379.5,-71230.47 116.5,-71230.47 116.5,-71230.47 110.5,-71230.47 104.5,-71224.47 104.5,-71218.47 104.5,-71218.47 104.5,-71195.47 104.5,-71195.47 104.5,-71189.47 110.5,-71183.47 116.5,-71183.47 116.5,-71183.47 379.5,-71183.47 379.5,-71183.47 385.5,-71183.47 391.5,-71189.47 391.5,-71195.47 391.5,-71195.47 391.5,-71218.47 391.5,-71218.47 391.5,-71224.47 385.5,-71230.47 379.5,-71230.47"/>
<text text-anchor="middle" x="248" y="-71215.47" font-family="Arial" font-size="10.00">Layer 9 FFN2 GPU0</text>
<text text-anchor="middle" x="248" y="-71204.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="248" y="-71193.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer9_act_0&#45;&gt;layer9_ffn2_0 -->
<g id="edge161" class="edge">
<title>layer9_act_0&#45;&gt;layer9_ffn2_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M245.58,-71302.41C246.03,-71284.96 246.65,-71260.55 247.16,-71240.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="250.66,-71240.94 247.41,-71230.86 243.66,-71240.76 250.66,-71240.94"/>
</g>
<!-- layer9_ffn2_1 -->
<g id="node143" class="node">
<title>layer9_ffn2_1</title>
<path fill="#e6f3ff" stroke="black" d="M704.5,-71230.47C704.5,-71230.47 441.5,-71230.47 441.5,-71230.47 435.5,-71230.47 429.5,-71224.47 429.5,-71218.47 429.5,-71218.47 429.5,-71195.47 429.5,-71195.47 429.5,-71189.47 435.5,-71183.47 441.5,-71183.47 441.5,-71183.47 704.5,-71183.47 704.5,-71183.47 710.5,-71183.47 716.5,-71189.47 716.5,-71195.47 716.5,-71195.47 716.5,-71218.47 716.5,-71218.47 716.5,-71224.47 710.5,-71230.47 704.5,-71230.47"/>
<text text-anchor="middle" x="573" y="-71215.47" font-family="Arial" font-size="10.00">Layer 9 FFN2 GPU1</text>
<text text-anchor="middle" x="573" y="-71204.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="573" y="-71193.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer9_act_1&#45;&gt;layer9_ffn2_1 -->
<g id="edge162" class="edge">
<title>layer9_act_1&#45;&gt;layer9_ffn2_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M574.61,-71302.41C574.32,-71284.96 573.9,-71260.55 573.56,-71240.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="577.06,-71240.8 573.39,-71230.86 570.06,-71240.92 577.06,-71240.8"/>
</g>
<!-- layer9_ffn_ar -->
<g id="node144" class="node">
<title>layer9_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M535.85,-71111.47C535.85,-71111.47 338.97,-71111.47 338.97,-71111.47 332.97,-71111.47 323.25,-71106.76 319.54,-71102.05 319.54,-71102.05 277.58,-71048.89 277.58,-71048.89 273.87,-71044.18 276.15,-71039.47 282.15,-71039.47 282.15,-71039.47 479.03,-71039.47 479.03,-71039.47 485.03,-71039.47 494.75,-71044.18 498.46,-71048.89 498.46,-71048.89 540.42,-71102.05 540.42,-71102.05 544.13,-71106.76 541.85,-71111.47 535.85,-71111.47"/>
<text text-anchor="middle" x="409" y="-71078.47" font-family="Arial" font-size="10.00">Layer 9 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="409" y="-71067.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer9_ffn2_0&#45;&gt;layer9_ffn_ar -->
<g id="edge163" class="edge">
<title>layer9_ffn2_0&#45;&gt;layer9_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M276.04,-71183.41C298.43,-71165.41 330.4,-71139.69 357.38,-71117.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="359.61,-71120.68 365.21,-71111.69 355.23,-71115.23 359.61,-71120.68"/>
</g>
<!-- layer9_ffn2_1&#45;&gt;layer9_ffn_ar -->
<g id="edge164" class="edge">
<title>layer9_ffn2_1&#45;&gt;layer9_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M544.43,-71183.41C521.63,-71165.41 489.06,-71139.69 461.58,-71117.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="463.62,-71115.14 453.6,-71111.69 459.28,-71120.63 463.62,-71115.14"/>
</g>
<!-- layer10_qkv_0 -->
<g id="node145" class="node">
<title>layer10_qkv_0</title>
<path fill="#e6f3ff" stroke="black" d="M379,-70967.47C379,-70967.47 81,-70967.47 81,-70967.47 75,-70967.47 69,-70961.47 69,-70955.47 69,-70955.47 69,-70932.47 69,-70932.47 69,-70926.47 75,-70920.47 81,-70920.47 81,-70920.47 379,-70920.47 379,-70920.47 385,-70920.47 391,-70926.47 391,-70932.47 391,-70932.47 391,-70955.47 391,-70955.47 391,-70961.47 385,-70967.47 379,-70967.47"/>
<text text-anchor="middle" x="230" y="-70952.47" font-family="Arial" font-size="10.00">Layer 10 QKV Proj GPU0</text>
<text text-anchor="middle" x="230" y="-70941.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="230" y="-70930.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer9_ffn_ar&#45;&gt;layer10_qkv_0 -->
<g id="edge165" class="edge">
<title>layer9_ffn_ar&#45;&gt;layer10_qkv_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M360.56,-71039.42C332.06,-71018.81 296.48,-70993.06 269.66,-70973.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="271.43,-70970.62 261.28,-70967.6 267.33,-70976.3 271.43,-70970.62"/>
</g>
<!-- layer10_qkv_1 -->
<g id="node146" class="node">
<title>layer10_qkv_1</title>
<path fill="#e6f3ff" stroke="black" d="M737,-70967.47C737,-70967.47 439,-70967.47 439,-70967.47 433,-70967.47 427,-70961.47 427,-70955.47 427,-70955.47 427,-70932.47 427,-70932.47 427,-70926.47 433,-70920.47 439,-70920.47 439,-70920.47 737,-70920.47 737,-70920.47 743,-70920.47 749,-70926.47 749,-70932.47 749,-70932.47 749,-70955.47 749,-70955.47 749,-70961.47 743,-70967.47 737,-70967.47"/>
<text text-anchor="middle" x="588" y="-70952.47" font-family="Arial" font-size="10.00">Layer 10 QKV Proj GPU1</text>
<text text-anchor="middle" x="588" y="-70941.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="588" y="-70930.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer9_ffn_ar&#45;&gt;layer10_qkv_1 -->
<g id="edge166" class="edge">
<title>layer9_ffn_ar&#45;&gt;layer10_qkv_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M457.44,-71039.42C485.94,-71018.81 521.52,-70993.06 548.34,-70973.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="550.67,-70976.3 556.72,-70967.6 546.57,-70970.62 550.67,-70976.3"/>
</g>
<!-- layer10_attn_0 -->
<g id="node147" class="node">
<title>layer10_attn_0</title>
<path fill="#e6f3ff" stroke="black" d="M379,-70848.47C379,-70848.47 81,-70848.47 81,-70848.47 75,-70848.47 69,-70842.47 69,-70836.47 69,-70836.47 69,-70813.47 69,-70813.47 69,-70807.47 75,-70801.47 81,-70801.47 81,-70801.47 379,-70801.47 379,-70801.47 385,-70801.47 391,-70807.47 391,-70813.47 391,-70813.47 391,-70836.47 391,-70836.47 391,-70842.47 385,-70848.47 379,-70848.47"/>
<text text-anchor="middle" x="230" y="-70833.47" font-family="Arial" font-size="10.00">Layer 10 Attention GPU0</text>
<text text-anchor="middle" x="230" y="-70822.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="230" y="-70811.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer10_qkv_0&#45;&gt;layer10_attn_0 -->
<g id="edge167" class="edge">
<title>layer10_qkv_0&#45;&gt;layer10_attn_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M230,-70920.41C230,-70902.96 230,-70878.55 230,-70858.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="233.5,-70858.86 230,-70848.86 226.5,-70858.86 233.5,-70858.86"/>
</g>
<!-- layer10_attn_1 -->
<g id="node148" class="node">
<title>layer10_attn_1</title>
<path fill="#e6f3ff" stroke="black" d="M737,-70848.47C737,-70848.47 439,-70848.47 439,-70848.47 433,-70848.47 427,-70842.47 427,-70836.47 427,-70836.47 427,-70813.47 427,-70813.47 427,-70807.47 433,-70801.47 439,-70801.47 439,-70801.47 737,-70801.47 737,-70801.47 743,-70801.47 749,-70807.47 749,-70813.47 749,-70813.47 749,-70836.47 749,-70836.47 749,-70842.47 743,-70848.47 737,-70848.47"/>
<text text-anchor="middle" x="588" y="-70833.47" font-family="Arial" font-size="10.00">Layer 10 Attention GPU1</text>
<text text-anchor="middle" x="588" y="-70822.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="588" y="-70811.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer10_qkv_1&#45;&gt;layer10_attn_1 -->
<g id="edge168" class="edge">
<title>layer10_qkv_1&#45;&gt;layer10_attn_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M588,-70920.41C588,-70902.96 588,-70878.55 588,-70858.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="591.5,-70858.86 588,-70848.86 584.5,-70858.86 591.5,-70858.86"/>
</g>
<!-- layer10_attn_out_0 -->
<g id="node149" class="node">
<title>layer10_attn_out_0</title>
<path fill="#e6f3ff" stroke="black" d="M379,-70729.47C379,-70729.47 89,-70729.47 89,-70729.47 83,-70729.47 77,-70723.47 77,-70717.47 77,-70717.47 77,-70694.47 77,-70694.47 77,-70688.47 83,-70682.47 89,-70682.47 89,-70682.47 379,-70682.47 379,-70682.47 385,-70682.47 391,-70688.47 391,-70694.47 391,-70694.47 391,-70717.47 391,-70717.47 391,-70723.47 385,-70729.47 379,-70729.47"/>
<text text-anchor="middle" x="234" y="-70714.47" font-family="Arial" font-size="10.00">Layer 10 Attn Out GPU0</text>
<text text-anchor="middle" x="234" y="-70703.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="234" y="-70692.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer10_attn_0&#45;&gt;layer10_attn_out_0 -->
<g id="edge169" class="edge">
<title>layer10_attn_0&#45;&gt;layer10_attn_out_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M230.77,-70801.41C231.37,-70783.96 232.2,-70759.55 232.87,-70739.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="236.37,-70739.97 233.22,-70729.86 229.38,-70739.73 236.37,-70739.97"/>
</g>
<!-- layer10_attn_out_1 -->
<g id="node150" class="node">
<title>layer10_attn_out_1</title>
<path fill="#e6f3ff" stroke="black" d="M731,-70729.47C731,-70729.47 441,-70729.47 441,-70729.47 435,-70729.47 429,-70723.47 429,-70717.47 429,-70717.47 429,-70694.47 429,-70694.47 429,-70688.47 435,-70682.47 441,-70682.47 441,-70682.47 731,-70682.47 731,-70682.47 737,-70682.47 743,-70688.47 743,-70694.47 743,-70694.47 743,-70717.47 743,-70717.47 743,-70723.47 737,-70729.47 731,-70729.47"/>
<text text-anchor="middle" x="586" y="-70714.47" font-family="Arial" font-size="10.00">Layer 10 Attn Out GPU1</text>
<text text-anchor="middle" x="586" y="-70703.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="586" y="-70692.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer10_attn_1&#45;&gt;layer10_attn_out_1 -->
<g id="edge170" class="edge">
<title>layer10_attn_1&#45;&gt;layer10_attn_out_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M587.61,-70801.41C587.32,-70783.96 586.9,-70759.55 586.56,-70739.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="590.06,-70739.8 586.39,-70729.86 583.06,-70739.92 590.06,-70739.8"/>
</g>
<!-- layer10_attn_ar -->
<g id="node151" class="node">
<title>layer10_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M539.07,-70610.47C539.07,-70610.47 337.07,-70610.47 337.07,-70610.47 331.07,-70610.47 321.3,-70605.8 317.53,-70601.13 317.53,-70601.13 274.47,-70547.8 274.47,-70547.8 270.7,-70543.14 272.93,-70538.47 278.93,-70538.47 278.93,-70538.47 480.93,-70538.47 480.93,-70538.47 486.93,-70538.47 496.7,-70543.14 500.47,-70547.8 500.47,-70547.8 543.53,-70601.13 543.53,-70601.13 547.3,-70605.8 545.07,-70610.47 539.07,-70610.47"/>
<text text-anchor="middle" x="409" y="-70577.47" font-family="Arial" font-size="10.00">Layer 10 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="409" y="-70566.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer10_attn_out_0&#45;&gt;layer10_attn_ar -->
<g id="edge171" class="edge">
<title>layer10_attn_out_0&#45;&gt;layer10_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M264.48,-70682.41C288.92,-70664.33 323.86,-70638.47 353.27,-70616.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="355.45,-70619.45 361.4,-70610.69 351.28,-70613.82 355.45,-70619.45"/>
</g>
<!-- layer10_attn_out_1&#45;&gt;layer10_attn_ar -->
<g id="edge172" class="edge">
<title>layer10_attn_out_1&#45;&gt;layer10_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M555.17,-70682.41C530.45,-70664.33 495.11,-70638.47 465.37,-70616.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="467.28,-70613.77 457.14,-70610.69 463.14,-70619.42 467.28,-70613.77"/>
</g>
<!-- layer10_ffn1_0 -->
<g id="node152" class="node">
<title>layer10_ffn1_0</title>
<path fill="#e6f3ff" stroke="black" d="M379,-70466.47C379,-70466.47 109,-70466.47 109,-70466.47 103,-70466.47 97,-70460.47 97,-70454.47 97,-70454.47 97,-70431.47 97,-70431.47 97,-70425.47 103,-70419.47 109,-70419.47 109,-70419.47 379,-70419.47 379,-70419.47 385,-70419.47 391,-70425.47 391,-70431.47 391,-70431.47 391,-70454.47 391,-70454.47 391,-70460.47 385,-70466.47 379,-70466.47"/>
<text text-anchor="middle" x="244" y="-70451.47" font-family="Arial" font-size="10.00">Layer 10 FFN1 GPU0</text>
<text text-anchor="middle" x="244" y="-70440.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="244" y="-70429.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer10_attn_ar&#45;&gt;layer10_ffn1_0 -->
<g id="edge173" class="edge">
<title>layer10_attn_ar&#45;&gt;layer10_ffn1_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M364.35,-70538.42C338.28,-70517.96 305.78,-70492.45 281.12,-70473.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="283.11,-70470.21 273.08,-70466.79 278.79,-70475.72 283.11,-70470.21"/>
</g>
<!-- layer10_ffn1_1 -->
<g id="node153" class="node">
<title>layer10_ffn1_1</title>
<path fill="#e6f3ff" stroke="black" d="M709,-70466.47C709,-70466.47 439,-70466.47 439,-70466.47 433,-70466.47 427,-70460.47 427,-70454.47 427,-70454.47 427,-70431.47 427,-70431.47 427,-70425.47 433,-70419.47 439,-70419.47 439,-70419.47 709,-70419.47 709,-70419.47 715,-70419.47 721,-70425.47 721,-70431.47 721,-70431.47 721,-70454.47 721,-70454.47 721,-70460.47 715,-70466.47 709,-70466.47"/>
<text text-anchor="middle" x="574" y="-70451.47" font-family="Arial" font-size="10.00">Layer 10 FFN1 GPU1</text>
<text text-anchor="middle" x="574" y="-70440.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="574" y="-70429.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer10_attn_ar&#45;&gt;layer10_ffn1_1 -->
<g id="edge174" class="edge">
<title>layer10_attn_ar&#45;&gt;layer10_ffn1_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M453.65,-70538.42C479.72,-70517.96 512.22,-70492.45 536.88,-70473.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="539.21,-70475.72 544.92,-70466.79 534.89,-70470.21 539.21,-70475.72"/>
</g>
<!-- layer10_act_0 -->
<g id="node154" class="node">
<title>layer10_act_0</title>
<path fill="#e6f3ff" stroke="black" d="M379,-70347.47C379,-70347.47 109,-70347.47 109,-70347.47 103,-70347.47 97,-70341.47 97,-70335.47 97,-70335.47 97,-70312.47 97,-70312.47 97,-70306.47 103,-70300.47 109,-70300.47 109,-70300.47 379,-70300.47 379,-70300.47 385,-70300.47 391,-70306.47 391,-70312.47 391,-70312.47 391,-70335.47 391,-70335.47 391,-70341.47 385,-70347.47 379,-70347.47"/>
<text text-anchor="middle" x="244" y="-70332.47" font-family="Arial" font-size="10.00">Layer 10 SiLU GPU0</text>
<text text-anchor="middle" x="244" y="-70321.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="244" y="-70310.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer10_ffn1_0&#45;&gt;layer10_act_0 -->
<g id="edge175" class="edge">
<title>layer10_ffn1_0&#45;&gt;layer10_act_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M244,-70419.41C244,-70401.96 244,-70377.55 244,-70357.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="247.5,-70357.86 244,-70347.86 240.5,-70357.86 247.5,-70357.86"/>
</g>
<!-- layer10_act_1 -->
<g id="node155" class="node">
<title>layer10_act_1</title>
<path fill="#e6f3ff" stroke="black" d="M709,-70347.47C709,-70347.47 439,-70347.47 439,-70347.47 433,-70347.47 427,-70341.47 427,-70335.47 427,-70335.47 427,-70312.47 427,-70312.47 427,-70306.47 433,-70300.47 439,-70300.47 439,-70300.47 709,-70300.47 709,-70300.47 715,-70300.47 721,-70306.47 721,-70312.47 721,-70312.47 721,-70335.47 721,-70335.47 721,-70341.47 715,-70347.47 709,-70347.47"/>
<text text-anchor="middle" x="574" y="-70332.47" font-family="Arial" font-size="10.00">Layer 10 SiLU GPU1</text>
<text text-anchor="middle" x="574" y="-70321.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="574" y="-70310.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer10_ffn1_1&#45;&gt;layer10_act_1 -->
<g id="edge176" class="edge">
<title>layer10_ffn1_1&#45;&gt;layer10_act_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M574,-70419.41C574,-70401.96 574,-70377.55 574,-70357.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="577.5,-70357.86 574,-70347.86 570.5,-70357.86 577.5,-70357.86"/>
</g>
<!-- layer10_ffn2_0 -->
<g id="node156" class="node">
<title>layer10_ffn2_0</title>
<path fill="#e6f3ff" stroke="black" d="M378.5,-70228.47C378.5,-70228.47 115.5,-70228.47 115.5,-70228.47 109.5,-70228.47 103.5,-70222.47 103.5,-70216.47 103.5,-70216.47 103.5,-70193.47 103.5,-70193.47 103.5,-70187.47 109.5,-70181.47 115.5,-70181.47 115.5,-70181.47 378.5,-70181.47 378.5,-70181.47 384.5,-70181.47 390.5,-70187.47 390.5,-70193.47 390.5,-70193.47 390.5,-70216.47 390.5,-70216.47 390.5,-70222.47 384.5,-70228.47 378.5,-70228.47"/>
<text text-anchor="middle" x="247" y="-70213.47" font-family="Arial" font-size="10.00">Layer 10 FFN2 GPU0</text>
<text text-anchor="middle" x="247" y="-70202.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="247" y="-70191.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer10_act_0&#45;&gt;layer10_ffn2_0 -->
<g id="edge177" class="edge">
<title>layer10_act_0&#45;&gt;layer10_ffn2_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M244.58,-70300.41C245.03,-70282.96 245.65,-70258.55 246.16,-70238.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="249.66,-70238.94 246.41,-70228.86 242.66,-70238.76 249.66,-70238.94"/>
</g>
<!-- layer10_ffn2_1 -->
<g id="node157" class="node">
<title>layer10_ffn2_1</title>
<path fill="#e6f3ff" stroke="black" d="M703.5,-70228.47C703.5,-70228.47 440.5,-70228.47 440.5,-70228.47 434.5,-70228.47 428.5,-70222.47 428.5,-70216.47 428.5,-70216.47 428.5,-70193.47 428.5,-70193.47 428.5,-70187.47 434.5,-70181.47 440.5,-70181.47 440.5,-70181.47 703.5,-70181.47 703.5,-70181.47 709.5,-70181.47 715.5,-70187.47 715.5,-70193.47 715.5,-70193.47 715.5,-70216.47 715.5,-70216.47 715.5,-70222.47 709.5,-70228.47 703.5,-70228.47"/>
<text text-anchor="middle" x="572" y="-70213.47" font-family="Arial" font-size="10.00">Layer 10 FFN2 GPU1</text>
<text text-anchor="middle" x="572" y="-70202.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="572" y="-70191.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer10_act_1&#45;&gt;layer10_ffn2_1 -->
<g id="edge178" class="edge">
<title>layer10_act_1&#45;&gt;layer10_ffn2_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M573.61,-70300.41C573.32,-70282.96 572.9,-70258.55 572.56,-70238.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="576.06,-70238.8 572.39,-70228.86 569.06,-70238.92 576.06,-70238.8"/>
</g>
<!-- layer10_ffn_ar -->
<g id="node158" class="node">
<title>layer10_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M540.22,-70109.47C540.22,-70109.47 334.8,-70109.47 334.8,-70109.47 328.8,-70109.47 319,-70104.83 315.19,-70100.19 315.19,-70100.19 271.39,-70046.75 271.39,-70046.75 267.59,-70042.11 269.78,-70037.47 275.78,-70037.47 275.78,-70037.47 481.2,-70037.47 481.2,-70037.47 487.2,-70037.47 497,-70042.11 500.81,-70046.75 500.81,-70046.75 544.61,-70100.19 544.61,-70100.19 548.41,-70104.83 546.22,-70109.47 540.22,-70109.47"/>
<text text-anchor="middle" x="408" y="-70076.47" font-family="Arial" font-size="10.00">Layer 10 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="408" y="-70065.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer10_ffn2_0&#45;&gt;layer10_ffn_ar -->
<g id="edge179" class="edge">
<title>layer10_ffn2_0&#45;&gt;layer10_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M275.04,-70181.41C297.43,-70163.41 329.4,-70137.69 356.38,-70115.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="358.61,-70118.68 364.21,-70109.69 354.23,-70113.23 358.61,-70118.68"/>
</g>
<!-- layer10_ffn2_1&#45;&gt;layer10_ffn_ar -->
<g id="edge180" class="edge">
<title>layer10_ffn2_1&#45;&gt;layer10_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M543.43,-70181.41C520.63,-70163.41 488.06,-70137.69 460.58,-70115.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="462.62,-70113.14 452.6,-70109.69 458.28,-70118.63 462.62,-70113.14"/>
</g>
<!-- layer11_qkv_0 -->
<g id="node159" class="node">
<title>layer11_qkv_0</title>
<path fill="#e6f3ff" stroke="black" d="M378,-69965.47C378,-69965.47 80,-69965.47 80,-69965.47 74,-69965.47 68,-69959.47 68,-69953.47 68,-69953.47 68,-69930.47 68,-69930.47 68,-69924.47 74,-69918.47 80,-69918.47 80,-69918.47 378,-69918.47 378,-69918.47 384,-69918.47 390,-69924.47 390,-69930.47 390,-69930.47 390,-69953.47 390,-69953.47 390,-69959.47 384,-69965.47 378,-69965.47"/>
<text text-anchor="middle" x="229" y="-69950.47" font-family="Arial" font-size="10.00">Layer 11 QKV Proj GPU0</text>
<text text-anchor="middle" x="229" y="-69939.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="229" y="-69928.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer10_ffn_ar&#45;&gt;layer11_qkv_0 -->
<g id="edge181" class="edge">
<title>layer10_ffn_ar&#45;&gt;layer11_qkv_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M359.56,-70037.42C331.06,-70016.81 295.48,-69991.06 268.66,-69971.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="270.43,-69968.62 260.28,-69965.6 266.33,-69974.3 270.43,-69968.62"/>
</g>
<!-- layer11_qkv_1 -->
<g id="node160" class="node">
<title>layer11_qkv_1</title>
<path fill="#e6f3ff" stroke="black" d="M736,-69965.47C736,-69965.47 438,-69965.47 438,-69965.47 432,-69965.47 426,-69959.47 426,-69953.47 426,-69953.47 426,-69930.47 426,-69930.47 426,-69924.47 432,-69918.47 438,-69918.47 438,-69918.47 736,-69918.47 736,-69918.47 742,-69918.47 748,-69924.47 748,-69930.47 748,-69930.47 748,-69953.47 748,-69953.47 748,-69959.47 742,-69965.47 736,-69965.47"/>
<text text-anchor="middle" x="587" y="-69950.47" font-family="Arial" font-size="10.00">Layer 11 QKV Proj GPU1</text>
<text text-anchor="middle" x="587" y="-69939.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="587" y="-69928.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer10_ffn_ar&#45;&gt;layer11_qkv_1 -->
<g id="edge182" class="edge">
<title>layer10_ffn_ar&#45;&gt;layer11_qkv_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M456.44,-70037.42C484.94,-70016.81 520.52,-69991.06 547.34,-69971.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="549.67,-69974.3 555.72,-69965.6 545.57,-69968.62 549.67,-69974.3"/>
</g>
<!-- layer11_attn_0 -->
<g id="node161" class="node">
<title>layer11_attn_0</title>
<path fill="#e6f3ff" stroke="black" d="M378,-69846.47C378,-69846.47 80,-69846.47 80,-69846.47 74,-69846.47 68,-69840.47 68,-69834.47 68,-69834.47 68,-69811.47 68,-69811.47 68,-69805.47 74,-69799.47 80,-69799.47 80,-69799.47 378,-69799.47 378,-69799.47 384,-69799.47 390,-69805.47 390,-69811.47 390,-69811.47 390,-69834.47 390,-69834.47 390,-69840.47 384,-69846.47 378,-69846.47"/>
<text text-anchor="middle" x="229" y="-69831.47" font-family="Arial" font-size="10.00">Layer 11 Attention GPU0</text>
<text text-anchor="middle" x="229" y="-69820.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="229" y="-69809.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer11_qkv_0&#45;&gt;layer11_attn_0 -->
<g id="edge183" class="edge">
<title>layer11_qkv_0&#45;&gt;layer11_attn_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M229,-69918.41C229,-69900.96 229,-69876.55 229,-69856.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="232.5,-69856.86 229,-69846.86 225.5,-69856.86 232.5,-69856.86"/>
</g>
<!-- layer11_attn_1 -->
<g id="node162" class="node">
<title>layer11_attn_1</title>
<path fill="#e6f3ff" stroke="black" d="M736,-69846.47C736,-69846.47 438,-69846.47 438,-69846.47 432,-69846.47 426,-69840.47 426,-69834.47 426,-69834.47 426,-69811.47 426,-69811.47 426,-69805.47 432,-69799.47 438,-69799.47 438,-69799.47 736,-69799.47 736,-69799.47 742,-69799.47 748,-69805.47 748,-69811.47 748,-69811.47 748,-69834.47 748,-69834.47 748,-69840.47 742,-69846.47 736,-69846.47"/>
<text text-anchor="middle" x="587" y="-69831.47" font-family="Arial" font-size="10.00">Layer 11 Attention GPU1</text>
<text text-anchor="middle" x="587" y="-69820.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="587" y="-69809.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer11_qkv_1&#45;&gt;layer11_attn_1 -->
<g id="edge184" class="edge">
<title>layer11_qkv_1&#45;&gt;layer11_attn_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M587,-69918.41C587,-69900.96 587,-69876.55 587,-69856.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="590.5,-69856.86 587,-69846.86 583.5,-69856.86 590.5,-69856.86"/>
</g>
<!-- layer11_attn_out_0 -->
<g id="node163" class="node">
<title>layer11_attn_out_0</title>
<path fill="#e6f3ff" stroke="black" d="M378,-69727.47C378,-69727.47 88,-69727.47 88,-69727.47 82,-69727.47 76,-69721.47 76,-69715.47 76,-69715.47 76,-69692.47 76,-69692.47 76,-69686.47 82,-69680.47 88,-69680.47 88,-69680.47 378,-69680.47 378,-69680.47 384,-69680.47 390,-69686.47 390,-69692.47 390,-69692.47 390,-69715.47 390,-69715.47 390,-69721.47 384,-69727.47 378,-69727.47"/>
<text text-anchor="middle" x="233" y="-69712.47" font-family="Arial" font-size="10.00">Layer 11 Attn Out GPU0</text>
<text text-anchor="middle" x="233" y="-69701.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="233" y="-69690.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer11_attn_0&#45;&gt;layer11_attn_out_0 -->
<g id="edge185" class="edge">
<title>layer11_attn_0&#45;&gt;layer11_attn_out_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M229.77,-69799.41C230.37,-69781.96 231.2,-69757.55 231.87,-69737.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="235.37,-69737.97 232.22,-69727.86 228.38,-69737.73 235.37,-69737.97"/>
</g>
<!-- layer11_attn_out_1 -->
<g id="node164" class="node">
<title>layer11_attn_out_1</title>
<path fill="#e6f3ff" stroke="black" d="M730,-69727.47C730,-69727.47 440,-69727.47 440,-69727.47 434,-69727.47 428,-69721.47 428,-69715.47 428,-69715.47 428,-69692.47 428,-69692.47 428,-69686.47 434,-69680.47 440,-69680.47 440,-69680.47 730,-69680.47 730,-69680.47 736,-69680.47 742,-69686.47 742,-69692.47 742,-69692.47 742,-69715.47 742,-69715.47 742,-69721.47 736,-69727.47 730,-69727.47"/>
<text text-anchor="middle" x="585" y="-69712.47" font-family="Arial" font-size="10.00">Layer 11 Attn Out GPU1</text>
<text text-anchor="middle" x="585" y="-69701.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="585" y="-69690.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer11_attn_1&#45;&gt;layer11_attn_out_1 -->
<g id="edge186" class="edge">
<title>layer11_attn_1&#45;&gt;layer11_attn_out_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M586.61,-69799.41C586.32,-69781.96 585.9,-69757.55 585.56,-69737.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="589.06,-69737.8 585.39,-69727.86 582.06,-69737.92 589.06,-69737.8"/>
</g>
<!-- layer11_attn_ar -->
<g id="node165" class="node">
<title>layer11_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M538.07,-69608.47C538.07,-69608.47 336.07,-69608.47 336.07,-69608.47 330.07,-69608.47 320.3,-69603.8 316.53,-69599.13 316.53,-69599.13 273.47,-69545.8 273.47,-69545.8 269.7,-69541.14 271.93,-69536.47 277.93,-69536.47 277.93,-69536.47 479.93,-69536.47 479.93,-69536.47 485.93,-69536.47 495.7,-69541.14 499.47,-69545.8 499.47,-69545.8 542.53,-69599.13 542.53,-69599.13 546.3,-69603.8 544.07,-69608.47 538.07,-69608.47"/>
<text text-anchor="middle" x="408" y="-69575.47" font-family="Arial" font-size="10.00">Layer 11 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="408" y="-69564.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer11_attn_out_0&#45;&gt;layer11_attn_ar -->
<g id="edge187" class="edge">
<title>layer11_attn_out_0&#45;&gt;layer11_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M263.48,-69680.41C287.92,-69662.33 322.86,-69636.47 352.27,-69614.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="354.45,-69617.45 360.4,-69608.69 350.28,-69611.82 354.45,-69617.45"/>
</g>
<!-- layer11_attn_out_1&#45;&gt;layer11_attn_ar -->
<g id="edge188" class="edge">
<title>layer11_attn_out_1&#45;&gt;layer11_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M554.17,-69680.41C529.45,-69662.33 494.11,-69636.47 464.37,-69614.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="466.28,-69611.77 456.14,-69608.69 462.14,-69617.42 466.28,-69611.77"/>
</g>
<!-- layer11_ffn1_0 -->
<g id="node166" class="node">
<title>layer11_ffn1_0</title>
<path fill="#e6f3ff" stroke="black" d="M378,-69464.47C378,-69464.47 108,-69464.47 108,-69464.47 102,-69464.47 96,-69458.47 96,-69452.47 96,-69452.47 96,-69429.47 96,-69429.47 96,-69423.47 102,-69417.47 108,-69417.47 108,-69417.47 378,-69417.47 378,-69417.47 384,-69417.47 390,-69423.47 390,-69429.47 390,-69429.47 390,-69452.47 390,-69452.47 390,-69458.47 384,-69464.47 378,-69464.47"/>
<text text-anchor="middle" x="243" y="-69449.47" font-family="Arial" font-size="10.00">Layer 11 FFN1 GPU0</text>
<text text-anchor="middle" x="243" y="-69438.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="243" y="-69427.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer11_attn_ar&#45;&gt;layer11_ffn1_0 -->
<g id="edge189" class="edge">
<title>layer11_attn_ar&#45;&gt;layer11_ffn1_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M363.35,-69536.42C337.28,-69515.96 304.78,-69490.45 280.12,-69471.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="282.11,-69468.21 272.08,-69464.79 277.79,-69473.72 282.11,-69468.21"/>
</g>
<!-- layer11_ffn1_1 -->
<g id="node167" class="node">
<title>layer11_ffn1_1</title>
<path fill="#e6f3ff" stroke="black" d="M708,-69464.47C708,-69464.47 438,-69464.47 438,-69464.47 432,-69464.47 426,-69458.47 426,-69452.47 426,-69452.47 426,-69429.47 426,-69429.47 426,-69423.47 432,-69417.47 438,-69417.47 438,-69417.47 708,-69417.47 708,-69417.47 714,-69417.47 720,-69423.47 720,-69429.47 720,-69429.47 720,-69452.47 720,-69452.47 720,-69458.47 714,-69464.47 708,-69464.47"/>
<text text-anchor="middle" x="573" y="-69449.47" font-family="Arial" font-size="10.00">Layer 11 FFN1 GPU1</text>
<text text-anchor="middle" x="573" y="-69438.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="573" y="-69427.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer11_attn_ar&#45;&gt;layer11_ffn1_1 -->
<g id="edge190" class="edge">
<title>layer11_attn_ar&#45;&gt;layer11_ffn1_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M452.65,-69536.42C478.72,-69515.96 511.22,-69490.45 535.88,-69471.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="538.21,-69473.72 543.92,-69464.79 533.89,-69468.21 538.21,-69473.72"/>
</g>
<!-- layer11_act_0 -->
<g id="node168" class="node">
<title>layer11_act_0</title>
<path fill="#e6f3ff" stroke="black" d="M378,-69345.47C378,-69345.47 108,-69345.47 108,-69345.47 102,-69345.47 96,-69339.47 96,-69333.47 96,-69333.47 96,-69310.47 96,-69310.47 96,-69304.47 102,-69298.47 108,-69298.47 108,-69298.47 378,-69298.47 378,-69298.47 384,-69298.47 390,-69304.47 390,-69310.47 390,-69310.47 390,-69333.47 390,-69333.47 390,-69339.47 384,-69345.47 378,-69345.47"/>
<text text-anchor="middle" x="243" y="-69330.47" font-family="Arial" font-size="10.00">Layer 11 SiLU GPU0</text>
<text text-anchor="middle" x="243" y="-69319.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="243" y="-69308.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer11_ffn1_0&#45;&gt;layer11_act_0 -->
<g id="edge191" class="edge">
<title>layer11_ffn1_0&#45;&gt;layer11_act_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M243,-69417.41C243,-69399.96 243,-69375.55 243,-69355.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="246.5,-69355.86 243,-69345.86 239.5,-69355.86 246.5,-69355.86"/>
</g>
<!-- layer11_act_1 -->
<g id="node169" class="node">
<title>layer11_act_1</title>
<path fill="#e6f3ff" stroke="black" d="M708,-69345.47C708,-69345.47 438,-69345.47 438,-69345.47 432,-69345.47 426,-69339.47 426,-69333.47 426,-69333.47 426,-69310.47 426,-69310.47 426,-69304.47 432,-69298.47 438,-69298.47 438,-69298.47 708,-69298.47 708,-69298.47 714,-69298.47 720,-69304.47 720,-69310.47 720,-69310.47 720,-69333.47 720,-69333.47 720,-69339.47 714,-69345.47 708,-69345.47"/>
<text text-anchor="middle" x="573" y="-69330.47" font-family="Arial" font-size="10.00">Layer 11 SiLU GPU1</text>
<text text-anchor="middle" x="573" y="-69319.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="573" y="-69308.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer11_ffn1_1&#45;&gt;layer11_act_1 -->
<g id="edge192" class="edge">
<title>layer11_ffn1_1&#45;&gt;layer11_act_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M573,-69417.41C573,-69399.96 573,-69375.55 573,-69355.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="576.5,-69355.86 573,-69345.86 569.5,-69355.86 576.5,-69355.86"/>
</g>
<!-- layer11_ffn2_0 -->
<g id="node170" class="node">
<title>layer11_ffn2_0</title>
<path fill="#e6f3ff" stroke="black" d="M377.5,-69226.47C377.5,-69226.47 114.5,-69226.47 114.5,-69226.47 108.5,-69226.47 102.5,-69220.47 102.5,-69214.47 102.5,-69214.47 102.5,-69191.47 102.5,-69191.47 102.5,-69185.47 108.5,-69179.47 114.5,-69179.47 114.5,-69179.47 377.5,-69179.47 377.5,-69179.47 383.5,-69179.47 389.5,-69185.47 389.5,-69191.47 389.5,-69191.47 389.5,-69214.47 389.5,-69214.47 389.5,-69220.47 383.5,-69226.47 377.5,-69226.47"/>
<text text-anchor="middle" x="246" y="-69211.47" font-family="Arial" font-size="10.00">Layer 11 FFN2 GPU0</text>
<text text-anchor="middle" x="246" y="-69200.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="246" y="-69189.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer11_act_0&#45;&gt;layer11_ffn2_0 -->
<g id="edge193" class="edge">
<title>layer11_act_0&#45;&gt;layer11_ffn2_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M243.58,-69298.41C244.03,-69280.96 244.65,-69256.55 245.16,-69236.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="248.66,-69236.94 245.41,-69226.86 241.66,-69236.76 248.66,-69236.94"/>
</g>
<!-- layer11_ffn2_1 -->
<g id="node171" class="node">
<title>layer11_ffn2_1</title>
<path fill="#e6f3ff" stroke="black" d="M702.5,-69226.47C702.5,-69226.47 439.5,-69226.47 439.5,-69226.47 433.5,-69226.47 427.5,-69220.47 427.5,-69214.47 427.5,-69214.47 427.5,-69191.47 427.5,-69191.47 427.5,-69185.47 433.5,-69179.47 439.5,-69179.47 439.5,-69179.47 702.5,-69179.47 702.5,-69179.47 708.5,-69179.47 714.5,-69185.47 714.5,-69191.47 714.5,-69191.47 714.5,-69214.47 714.5,-69214.47 714.5,-69220.47 708.5,-69226.47 702.5,-69226.47"/>
<text text-anchor="middle" x="571" y="-69211.47" font-family="Arial" font-size="10.00">Layer 11 FFN2 GPU1</text>
<text text-anchor="middle" x="571" y="-69200.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="571" y="-69189.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer11_act_1&#45;&gt;layer11_ffn2_1 -->
<g id="edge194" class="edge">
<title>layer11_act_1&#45;&gt;layer11_ffn2_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M572.61,-69298.41C572.32,-69280.96 571.9,-69256.55 571.56,-69236.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="575.06,-69236.8 571.39,-69226.86 568.06,-69236.92 575.06,-69236.8"/>
</g>
<!-- layer11_ffn_ar -->
<g id="node172" class="node">
<title>layer11_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M539.22,-69107.47C539.22,-69107.47 333.8,-69107.47 333.8,-69107.47 327.8,-69107.47 318,-69102.83 314.19,-69098.19 314.19,-69098.19 270.39,-69044.75 270.39,-69044.75 266.59,-69040.11 268.78,-69035.47 274.78,-69035.47 274.78,-69035.47 480.2,-69035.47 480.2,-69035.47 486.2,-69035.47 496,-69040.11 499.81,-69044.75 499.81,-69044.75 543.61,-69098.19 543.61,-69098.19 547.41,-69102.83 545.22,-69107.47 539.22,-69107.47"/>
<text text-anchor="middle" x="407" y="-69074.47" font-family="Arial" font-size="10.00">Layer 11 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="407" y="-69063.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer11_ffn2_0&#45;&gt;layer11_ffn_ar -->
<g id="edge195" class="edge">
<title>layer11_ffn2_0&#45;&gt;layer11_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M274.04,-69179.41C296.43,-69161.41 328.4,-69135.69 355.38,-69113.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="357.61,-69116.68 363.21,-69107.69 353.23,-69111.23 357.61,-69116.68"/>
</g>
<!-- layer11_ffn2_1&#45;&gt;layer11_ffn_ar -->
<g id="edge196" class="edge">
<title>layer11_ffn2_1&#45;&gt;layer11_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M542.43,-69179.41C519.63,-69161.41 487.06,-69135.69 459.58,-69113.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="461.62,-69111.14 451.6,-69107.69 457.28,-69116.63 461.62,-69111.14"/>
</g>
<!-- layer12_qkv_0 -->
<g id="node173" class="node">
<title>layer12_qkv_0</title>
<path fill="#e6f3ff" stroke="black" d="M377,-68963.47C377,-68963.47 79,-68963.47 79,-68963.47 73,-68963.47 67,-68957.47 67,-68951.47 67,-68951.47 67,-68928.47 67,-68928.47 67,-68922.47 73,-68916.47 79,-68916.47 79,-68916.47 377,-68916.47 377,-68916.47 383,-68916.47 389,-68922.47 389,-68928.47 389,-68928.47 389,-68951.47 389,-68951.47 389,-68957.47 383,-68963.47 377,-68963.47"/>
<text text-anchor="middle" x="228" y="-68948.47" font-family="Arial" font-size="10.00">Layer 12 QKV Proj GPU0</text>
<text text-anchor="middle" x="228" y="-68937.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="228" y="-68926.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer11_ffn_ar&#45;&gt;layer12_qkv_0 -->
<g id="edge197" class="edge">
<title>layer11_ffn_ar&#45;&gt;layer12_qkv_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M358.56,-69035.42C330.06,-69014.81 294.48,-68989.06 267.66,-68969.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="269.43,-68966.62 259.28,-68963.6 265.33,-68972.3 269.43,-68966.62"/>
</g>
<!-- layer12_qkv_1 -->
<g id="node174" class="node">
<title>layer12_qkv_1</title>
<path fill="#e6f3ff" stroke="black" d="M735,-68963.47C735,-68963.47 437,-68963.47 437,-68963.47 431,-68963.47 425,-68957.47 425,-68951.47 425,-68951.47 425,-68928.47 425,-68928.47 425,-68922.47 431,-68916.47 437,-68916.47 437,-68916.47 735,-68916.47 735,-68916.47 741,-68916.47 747,-68922.47 747,-68928.47 747,-68928.47 747,-68951.47 747,-68951.47 747,-68957.47 741,-68963.47 735,-68963.47"/>
<text text-anchor="middle" x="586" y="-68948.47" font-family="Arial" font-size="10.00">Layer 12 QKV Proj GPU1</text>
<text text-anchor="middle" x="586" y="-68937.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="586" y="-68926.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer11_ffn_ar&#45;&gt;layer12_qkv_1 -->
<g id="edge198" class="edge">
<title>layer11_ffn_ar&#45;&gt;layer12_qkv_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M455.44,-69035.42C483.94,-69014.81 519.52,-68989.06 546.34,-68969.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="548.67,-68972.3 554.72,-68963.6 544.57,-68966.62 548.67,-68972.3"/>
</g>
<!-- layer12_attn_0 -->
<g id="node175" class="node">
<title>layer12_attn_0</title>
<path fill="#e6f3ff" stroke="black" d="M377,-68844.47C377,-68844.47 79,-68844.47 79,-68844.47 73,-68844.47 67,-68838.47 67,-68832.47 67,-68832.47 67,-68809.47 67,-68809.47 67,-68803.47 73,-68797.47 79,-68797.47 79,-68797.47 377,-68797.47 377,-68797.47 383,-68797.47 389,-68803.47 389,-68809.47 389,-68809.47 389,-68832.47 389,-68832.47 389,-68838.47 383,-68844.47 377,-68844.47"/>
<text text-anchor="middle" x="228" y="-68829.47" font-family="Arial" font-size="10.00">Layer 12 Attention GPU0</text>
<text text-anchor="middle" x="228" y="-68818.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="228" y="-68807.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer12_qkv_0&#45;&gt;layer12_attn_0 -->
<g id="edge199" class="edge">
<title>layer12_qkv_0&#45;&gt;layer12_attn_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M228,-68916.41C228,-68898.96 228,-68874.55 228,-68854.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="231.5,-68854.86 228,-68844.86 224.5,-68854.86 231.5,-68854.86"/>
</g>
<!-- layer12_attn_1 -->
<g id="node176" class="node">
<title>layer12_attn_1</title>
<path fill="#e6f3ff" stroke="black" d="M735,-68844.47C735,-68844.47 437,-68844.47 437,-68844.47 431,-68844.47 425,-68838.47 425,-68832.47 425,-68832.47 425,-68809.47 425,-68809.47 425,-68803.47 431,-68797.47 437,-68797.47 437,-68797.47 735,-68797.47 735,-68797.47 741,-68797.47 747,-68803.47 747,-68809.47 747,-68809.47 747,-68832.47 747,-68832.47 747,-68838.47 741,-68844.47 735,-68844.47"/>
<text text-anchor="middle" x="586" y="-68829.47" font-family="Arial" font-size="10.00">Layer 12 Attention GPU1</text>
<text text-anchor="middle" x="586" y="-68818.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="586" y="-68807.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer12_qkv_1&#45;&gt;layer12_attn_1 -->
<g id="edge200" class="edge">
<title>layer12_qkv_1&#45;&gt;layer12_attn_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M586,-68916.41C586,-68898.96 586,-68874.55 586,-68854.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="589.5,-68854.86 586,-68844.86 582.5,-68854.86 589.5,-68854.86"/>
</g>
<!-- layer12_attn_out_0 -->
<g id="node177" class="node">
<title>layer12_attn_out_0</title>
<path fill="#e6f3ff" stroke="black" d="M377,-68725.47C377,-68725.47 87,-68725.47 87,-68725.47 81,-68725.47 75,-68719.47 75,-68713.47 75,-68713.47 75,-68690.47 75,-68690.47 75,-68684.47 81,-68678.47 87,-68678.47 87,-68678.47 377,-68678.47 377,-68678.47 383,-68678.47 389,-68684.47 389,-68690.47 389,-68690.47 389,-68713.47 389,-68713.47 389,-68719.47 383,-68725.47 377,-68725.47"/>
<text text-anchor="middle" x="232" y="-68710.47" font-family="Arial" font-size="10.00">Layer 12 Attn Out GPU0</text>
<text text-anchor="middle" x="232" y="-68699.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="232" y="-68688.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer12_attn_0&#45;&gt;layer12_attn_out_0 -->
<g id="edge201" class="edge">
<title>layer12_attn_0&#45;&gt;layer12_attn_out_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M228.77,-68797.41C229.37,-68779.96 230.2,-68755.55 230.87,-68735.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="234.37,-68735.97 231.22,-68725.86 227.38,-68735.73 234.37,-68735.97"/>
</g>
<!-- layer12_attn_out_1 -->
<g id="node178" class="node">
<title>layer12_attn_out_1</title>
<path fill="#e6f3ff" stroke="black" d="M729,-68725.47C729,-68725.47 439,-68725.47 439,-68725.47 433,-68725.47 427,-68719.47 427,-68713.47 427,-68713.47 427,-68690.47 427,-68690.47 427,-68684.47 433,-68678.47 439,-68678.47 439,-68678.47 729,-68678.47 729,-68678.47 735,-68678.47 741,-68684.47 741,-68690.47 741,-68690.47 741,-68713.47 741,-68713.47 741,-68719.47 735,-68725.47 729,-68725.47"/>
<text text-anchor="middle" x="584" y="-68710.47" font-family="Arial" font-size="10.00">Layer 12 Attn Out GPU1</text>
<text text-anchor="middle" x="584" y="-68699.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="584" y="-68688.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer12_attn_1&#45;&gt;layer12_attn_out_1 -->
<g id="edge202" class="edge">
<title>layer12_attn_1&#45;&gt;layer12_attn_out_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M585.61,-68797.41C585.32,-68779.96 584.9,-68755.55 584.56,-68735.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="588.06,-68735.8 584.39,-68725.86 581.06,-68735.92 588.06,-68735.8"/>
</g>
<!-- layer12_attn_ar -->
<g id="node179" class="node">
<title>layer12_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M537.07,-68606.47C537.07,-68606.47 335.07,-68606.47 335.07,-68606.47 329.07,-68606.47 319.3,-68601.8 315.53,-68597.13 315.53,-68597.13 272.47,-68543.8 272.47,-68543.8 268.7,-68539.14 270.93,-68534.47 276.93,-68534.47 276.93,-68534.47 478.93,-68534.47 478.93,-68534.47 484.93,-68534.47 494.7,-68539.14 498.47,-68543.8 498.47,-68543.8 541.53,-68597.13 541.53,-68597.13 545.3,-68601.8 543.07,-68606.47 537.07,-68606.47"/>
<text text-anchor="middle" x="407" y="-68573.47" font-family="Arial" font-size="10.00">Layer 12 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="407" y="-68562.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer12_attn_out_0&#45;&gt;layer12_attn_ar -->
<g id="edge203" class="edge">
<title>layer12_attn_out_0&#45;&gt;layer12_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M262.48,-68678.41C286.92,-68660.33 321.86,-68634.47 351.27,-68612.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="353.45,-68615.45 359.4,-68606.69 349.28,-68609.82 353.45,-68615.45"/>
</g>
<!-- layer12_attn_out_1&#45;&gt;layer12_attn_ar -->
<g id="edge204" class="edge">
<title>layer12_attn_out_1&#45;&gt;layer12_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M553.17,-68678.41C528.45,-68660.33 493.11,-68634.47 463.37,-68612.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="465.28,-68609.77 455.14,-68606.69 461.14,-68615.42 465.28,-68609.77"/>
</g>
<!-- layer12_ffn1_0 -->
<g id="node180" class="node">
<title>layer12_ffn1_0</title>
<path fill="#e6f3ff" stroke="black" d="M377,-68462.47C377,-68462.47 107,-68462.47 107,-68462.47 101,-68462.47 95,-68456.47 95,-68450.47 95,-68450.47 95,-68427.47 95,-68427.47 95,-68421.47 101,-68415.47 107,-68415.47 107,-68415.47 377,-68415.47 377,-68415.47 383,-68415.47 389,-68421.47 389,-68427.47 389,-68427.47 389,-68450.47 389,-68450.47 389,-68456.47 383,-68462.47 377,-68462.47"/>
<text text-anchor="middle" x="242" y="-68447.47" font-family="Arial" font-size="10.00">Layer 12 FFN1 GPU0</text>
<text text-anchor="middle" x="242" y="-68436.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="242" y="-68425.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer12_attn_ar&#45;&gt;layer12_ffn1_0 -->
<g id="edge205" class="edge">
<title>layer12_attn_ar&#45;&gt;layer12_ffn1_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M362.35,-68534.42C336.28,-68513.96 303.78,-68488.45 279.12,-68469.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="281.11,-68466.21 271.08,-68462.79 276.79,-68471.72 281.11,-68466.21"/>
</g>
<!-- layer12_ffn1_1 -->
<g id="node181" class="node">
<title>layer12_ffn1_1</title>
<path fill="#e6f3ff" stroke="black" d="M707,-68462.47C707,-68462.47 437,-68462.47 437,-68462.47 431,-68462.47 425,-68456.47 425,-68450.47 425,-68450.47 425,-68427.47 425,-68427.47 425,-68421.47 431,-68415.47 437,-68415.47 437,-68415.47 707,-68415.47 707,-68415.47 713,-68415.47 719,-68421.47 719,-68427.47 719,-68427.47 719,-68450.47 719,-68450.47 719,-68456.47 713,-68462.47 707,-68462.47"/>
<text text-anchor="middle" x="572" y="-68447.47" font-family="Arial" font-size="10.00">Layer 12 FFN1 GPU1</text>
<text text-anchor="middle" x="572" y="-68436.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="572" y="-68425.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer12_attn_ar&#45;&gt;layer12_ffn1_1 -->
<g id="edge206" class="edge">
<title>layer12_attn_ar&#45;&gt;layer12_ffn1_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M451.65,-68534.42C477.72,-68513.96 510.22,-68488.45 534.88,-68469.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="537.21,-68471.72 542.92,-68462.79 532.89,-68466.21 537.21,-68471.72"/>
</g>
<!-- layer12_act_0 -->
<g id="node182" class="node">
<title>layer12_act_0</title>
<path fill="#e6f3ff" stroke="black" d="M377,-68343.47C377,-68343.47 107,-68343.47 107,-68343.47 101,-68343.47 95,-68337.47 95,-68331.47 95,-68331.47 95,-68308.47 95,-68308.47 95,-68302.47 101,-68296.47 107,-68296.47 107,-68296.47 377,-68296.47 377,-68296.47 383,-68296.47 389,-68302.47 389,-68308.47 389,-68308.47 389,-68331.47 389,-68331.47 389,-68337.47 383,-68343.47 377,-68343.47"/>
<text text-anchor="middle" x="242" y="-68328.47" font-family="Arial" font-size="10.00">Layer 12 SiLU GPU0</text>
<text text-anchor="middle" x="242" y="-68317.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="242" y="-68306.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer12_ffn1_0&#45;&gt;layer12_act_0 -->
<g id="edge207" class="edge">
<title>layer12_ffn1_0&#45;&gt;layer12_act_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M242,-68415.41C242,-68397.96 242,-68373.55 242,-68353.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="245.5,-68353.86 242,-68343.86 238.5,-68353.86 245.5,-68353.86"/>
</g>
<!-- layer12_act_1 -->
<g id="node183" class="node">
<title>layer12_act_1</title>
<path fill="#e6f3ff" stroke="black" d="M707,-68343.47C707,-68343.47 437,-68343.47 437,-68343.47 431,-68343.47 425,-68337.47 425,-68331.47 425,-68331.47 425,-68308.47 425,-68308.47 425,-68302.47 431,-68296.47 437,-68296.47 437,-68296.47 707,-68296.47 707,-68296.47 713,-68296.47 719,-68302.47 719,-68308.47 719,-68308.47 719,-68331.47 719,-68331.47 719,-68337.47 713,-68343.47 707,-68343.47"/>
<text text-anchor="middle" x="572" y="-68328.47" font-family="Arial" font-size="10.00">Layer 12 SiLU GPU1</text>
<text text-anchor="middle" x="572" y="-68317.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="572" y="-68306.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer12_ffn1_1&#45;&gt;layer12_act_1 -->
<g id="edge208" class="edge">
<title>layer12_ffn1_1&#45;&gt;layer12_act_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M572,-68415.41C572,-68397.96 572,-68373.55 572,-68353.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="575.5,-68353.86 572,-68343.86 568.5,-68353.86 575.5,-68353.86"/>
</g>
<!-- layer12_ffn2_0 -->
<g id="node184" class="node">
<title>layer12_ffn2_0</title>
<path fill="#e6f3ff" stroke="black" d="M376.5,-68224.47C376.5,-68224.47 113.5,-68224.47 113.5,-68224.47 107.5,-68224.47 101.5,-68218.47 101.5,-68212.47 101.5,-68212.47 101.5,-68189.47 101.5,-68189.47 101.5,-68183.47 107.5,-68177.47 113.5,-68177.47 113.5,-68177.47 376.5,-68177.47 376.5,-68177.47 382.5,-68177.47 388.5,-68183.47 388.5,-68189.47 388.5,-68189.47 388.5,-68212.47 388.5,-68212.47 388.5,-68218.47 382.5,-68224.47 376.5,-68224.47"/>
<text text-anchor="middle" x="245" y="-68209.47" font-family="Arial" font-size="10.00">Layer 12 FFN2 GPU0</text>
<text text-anchor="middle" x="245" y="-68198.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="245" y="-68187.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer12_act_0&#45;&gt;layer12_ffn2_0 -->
<g id="edge209" class="edge">
<title>layer12_act_0&#45;&gt;layer12_ffn2_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M242.58,-68296.41C243.03,-68278.96 243.65,-68254.55 244.16,-68234.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="247.66,-68234.94 244.41,-68224.86 240.66,-68234.76 247.66,-68234.94"/>
</g>
<!-- layer12_ffn2_1 -->
<g id="node185" class="node">
<title>layer12_ffn2_1</title>
<path fill="#e6f3ff" stroke="black" d="M701.5,-68224.47C701.5,-68224.47 438.5,-68224.47 438.5,-68224.47 432.5,-68224.47 426.5,-68218.47 426.5,-68212.47 426.5,-68212.47 426.5,-68189.47 426.5,-68189.47 426.5,-68183.47 432.5,-68177.47 438.5,-68177.47 438.5,-68177.47 701.5,-68177.47 701.5,-68177.47 707.5,-68177.47 713.5,-68183.47 713.5,-68189.47 713.5,-68189.47 713.5,-68212.47 713.5,-68212.47 713.5,-68218.47 707.5,-68224.47 701.5,-68224.47"/>
<text text-anchor="middle" x="570" y="-68209.47" font-family="Arial" font-size="10.00">Layer 12 FFN2 GPU1</text>
<text text-anchor="middle" x="570" y="-68198.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="570" y="-68187.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer12_act_1&#45;&gt;layer12_ffn2_1 -->
<g id="edge210" class="edge">
<title>layer12_act_1&#45;&gt;layer12_ffn2_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M571.61,-68296.41C571.32,-68278.96 570.9,-68254.55 570.56,-68234.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="574.06,-68234.8 570.39,-68224.86 567.06,-68234.92 574.06,-68234.8"/>
</g>
<!-- layer12_ffn_ar -->
<g id="node186" class="node">
<title>layer12_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M538.22,-68105.47C538.22,-68105.47 332.8,-68105.47 332.8,-68105.47 326.8,-68105.47 317,-68100.83 313.19,-68096.19 313.19,-68096.19 269.39,-68042.75 269.39,-68042.75 265.59,-68038.11 267.78,-68033.47 273.78,-68033.47 273.78,-68033.47 479.2,-68033.47 479.2,-68033.47 485.2,-68033.47 495,-68038.11 498.81,-68042.75 498.81,-68042.75 542.61,-68096.19 542.61,-68096.19 546.41,-68100.83 544.22,-68105.47 538.22,-68105.47"/>
<text text-anchor="middle" x="406" y="-68072.47" font-family="Arial" font-size="10.00">Layer 12 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="406" y="-68061.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer12_ffn2_0&#45;&gt;layer12_ffn_ar -->
<g id="edge211" class="edge">
<title>layer12_ffn2_0&#45;&gt;layer12_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M273.04,-68177.41C295.43,-68159.41 327.4,-68133.69 354.38,-68111.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="356.61,-68114.68 362.21,-68105.69 352.23,-68109.23 356.61,-68114.68"/>
</g>
<!-- layer12_ffn2_1&#45;&gt;layer12_ffn_ar -->
<g id="edge212" class="edge">
<title>layer12_ffn2_1&#45;&gt;layer12_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M541.43,-68177.41C518.63,-68159.41 486.06,-68133.69 458.58,-68111.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="460.62,-68109.14 450.6,-68105.69 456.28,-68114.63 460.62,-68109.14"/>
</g>
<!-- layer13_qkv_0 -->
<g id="node187" class="node">
<title>layer13_qkv_0</title>
<path fill="#e6f3ff" stroke="black" d="M376,-67961.47C376,-67961.47 78,-67961.47 78,-67961.47 72,-67961.47 66,-67955.47 66,-67949.47 66,-67949.47 66,-67926.47 66,-67926.47 66,-67920.47 72,-67914.47 78,-67914.47 78,-67914.47 376,-67914.47 376,-67914.47 382,-67914.47 388,-67920.47 388,-67926.47 388,-67926.47 388,-67949.47 388,-67949.47 388,-67955.47 382,-67961.47 376,-67961.47"/>
<text text-anchor="middle" x="227" y="-67946.47" font-family="Arial" font-size="10.00">Layer 13 QKV Proj GPU0</text>
<text text-anchor="middle" x="227" y="-67935.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="227" y="-67924.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer12_ffn_ar&#45;&gt;layer13_qkv_0 -->
<g id="edge213" class="edge">
<title>layer12_ffn_ar&#45;&gt;layer13_qkv_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M357.56,-68033.42C329.06,-68012.81 293.48,-67987.06 266.66,-67967.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="268.43,-67964.62 258.28,-67961.6 264.33,-67970.3 268.43,-67964.62"/>
</g>
<!-- layer13_qkv_1 -->
<g id="node188" class="node">
<title>layer13_qkv_1</title>
<path fill="#e6f3ff" stroke="black" d="M734,-67961.47C734,-67961.47 436,-67961.47 436,-67961.47 430,-67961.47 424,-67955.47 424,-67949.47 424,-67949.47 424,-67926.47 424,-67926.47 424,-67920.47 430,-67914.47 436,-67914.47 436,-67914.47 734,-67914.47 734,-67914.47 740,-67914.47 746,-67920.47 746,-67926.47 746,-67926.47 746,-67949.47 746,-67949.47 746,-67955.47 740,-67961.47 734,-67961.47"/>
<text text-anchor="middle" x="585" y="-67946.47" font-family="Arial" font-size="10.00">Layer 13 QKV Proj GPU1</text>
<text text-anchor="middle" x="585" y="-67935.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="585" y="-67924.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer12_ffn_ar&#45;&gt;layer13_qkv_1 -->
<g id="edge214" class="edge">
<title>layer12_ffn_ar&#45;&gt;layer13_qkv_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M454.44,-68033.42C482.94,-68012.81 518.52,-67987.06 545.34,-67967.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="547.67,-67970.3 553.72,-67961.6 543.57,-67964.62 547.67,-67970.3"/>
</g>
<!-- layer13_attn_0 -->
<g id="node189" class="node">
<title>layer13_attn_0</title>
<path fill="#e6f3ff" stroke="black" d="M376,-67842.47C376,-67842.47 78,-67842.47 78,-67842.47 72,-67842.47 66,-67836.47 66,-67830.47 66,-67830.47 66,-67807.47 66,-67807.47 66,-67801.47 72,-67795.47 78,-67795.47 78,-67795.47 376,-67795.47 376,-67795.47 382,-67795.47 388,-67801.47 388,-67807.47 388,-67807.47 388,-67830.47 388,-67830.47 388,-67836.47 382,-67842.47 376,-67842.47"/>
<text text-anchor="middle" x="227" y="-67827.47" font-family="Arial" font-size="10.00">Layer 13 Attention GPU0</text>
<text text-anchor="middle" x="227" y="-67816.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="227" y="-67805.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer13_qkv_0&#45;&gt;layer13_attn_0 -->
<g id="edge215" class="edge">
<title>layer13_qkv_0&#45;&gt;layer13_attn_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M227,-67914.41C227,-67896.96 227,-67872.55 227,-67852.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="230.5,-67852.86 227,-67842.86 223.5,-67852.86 230.5,-67852.86"/>
</g>
<!-- layer13_attn_1 -->
<g id="node190" class="node">
<title>layer13_attn_1</title>
<path fill="#e6f3ff" stroke="black" d="M734,-67842.47C734,-67842.47 436,-67842.47 436,-67842.47 430,-67842.47 424,-67836.47 424,-67830.47 424,-67830.47 424,-67807.47 424,-67807.47 424,-67801.47 430,-67795.47 436,-67795.47 436,-67795.47 734,-67795.47 734,-67795.47 740,-67795.47 746,-67801.47 746,-67807.47 746,-67807.47 746,-67830.47 746,-67830.47 746,-67836.47 740,-67842.47 734,-67842.47"/>
<text text-anchor="middle" x="585" y="-67827.47" font-family="Arial" font-size="10.00">Layer 13 Attention GPU1</text>
<text text-anchor="middle" x="585" y="-67816.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="585" y="-67805.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer13_qkv_1&#45;&gt;layer13_attn_1 -->
<g id="edge216" class="edge">
<title>layer13_qkv_1&#45;&gt;layer13_attn_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M585,-67914.41C585,-67896.96 585,-67872.55 585,-67852.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="588.5,-67852.86 585,-67842.86 581.5,-67852.86 588.5,-67852.86"/>
</g>
<!-- layer13_attn_out_0 -->
<g id="node191" class="node">
<title>layer13_attn_out_0</title>
<path fill="#e6f3ff" stroke="black" d="M376,-67723.47C376,-67723.47 86,-67723.47 86,-67723.47 80,-67723.47 74,-67717.47 74,-67711.47 74,-67711.47 74,-67688.47 74,-67688.47 74,-67682.47 80,-67676.47 86,-67676.47 86,-67676.47 376,-67676.47 376,-67676.47 382,-67676.47 388,-67682.47 388,-67688.47 388,-67688.47 388,-67711.47 388,-67711.47 388,-67717.47 382,-67723.47 376,-67723.47"/>
<text text-anchor="middle" x="231" y="-67708.47" font-family="Arial" font-size="10.00">Layer 13 Attn Out GPU0</text>
<text text-anchor="middle" x="231" y="-67697.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="231" y="-67686.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer13_attn_0&#45;&gt;layer13_attn_out_0 -->
<g id="edge217" class="edge">
<title>layer13_attn_0&#45;&gt;layer13_attn_out_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M227.77,-67795.41C228.37,-67777.96 229.2,-67753.55 229.87,-67733.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="233.37,-67733.97 230.22,-67723.86 226.38,-67733.73 233.37,-67733.97"/>
</g>
<!-- layer13_attn_out_1 -->
<g id="node192" class="node">
<title>layer13_attn_out_1</title>
<path fill="#e6f3ff" stroke="black" d="M728,-67723.47C728,-67723.47 438,-67723.47 438,-67723.47 432,-67723.47 426,-67717.47 426,-67711.47 426,-67711.47 426,-67688.47 426,-67688.47 426,-67682.47 432,-67676.47 438,-67676.47 438,-67676.47 728,-67676.47 728,-67676.47 734,-67676.47 740,-67682.47 740,-67688.47 740,-67688.47 740,-67711.47 740,-67711.47 740,-67717.47 734,-67723.47 728,-67723.47"/>
<text text-anchor="middle" x="583" y="-67708.47" font-family="Arial" font-size="10.00">Layer 13 Attn Out GPU1</text>
<text text-anchor="middle" x="583" y="-67697.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="583" y="-67686.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer13_attn_1&#45;&gt;layer13_attn_out_1 -->
<g id="edge218" class="edge">
<title>layer13_attn_1&#45;&gt;layer13_attn_out_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M584.61,-67795.41C584.32,-67777.96 583.9,-67753.55 583.56,-67733.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="587.06,-67733.8 583.39,-67723.86 580.06,-67733.92 587.06,-67733.8"/>
</g>
<!-- layer13_attn_ar -->
<g id="node193" class="node">
<title>layer13_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M536.07,-67604.47C536.07,-67604.47 334.07,-67604.47 334.07,-67604.47 328.07,-67604.47 318.3,-67599.8 314.53,-67595.13 314.53,-67595.13 271.47,-67541.8 271.47,-67541.8 267.7,-67537.14 269.93,-67532.47 275.93,-67532.47 275.93,-67532.47 477.93,-67532.47 477.93,-67532.47 483.93,-67532.47 493.7,-67537.14 497.47,-67541.8 497.47,-67541.8 540.53,-67595.13 540.53,-67595.13 544.3,-67599.8 542.07,-67604.47 536.07,-67604.47"/>
<text text-anchor="middle" x="406" y="-67571.47" font-family="Arial" font-size="10.00">Layer 13 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="406" y="-67560.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer13_attn_out_0&#45;&gt;layer13_attn_ar -->
<g id="edge219" class="edge">
<title>layer13_attn_out_0&#45;&gt;layer13_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M261.48,-67676.41C285.92,-67658.33 320.86,-67632.47 350.27,-67610.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="352.45,-67613.45 358.4,-67604.69 348.28,-67607.82 352.45,-67613.45"/>
</g>
<!-- layer13_attn_out_1&#45;&gt;layer13_attn_ar -->
<g id="edge220" class="edge">
<title>layer13_attn_out_1&#45;&gt;layer13_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M552.17,-67676.41C527.45,-67658.33 492.11,-67632.47 462.37,-67610.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="464.28,-67607.77 454.14,-67604.69 460.14,-67613.42 464.28,-67607.77"/>
</g>
<!-- layer13_ffn1_0 -->
<g id="node194" class="node">
<title>layer13_ffn1_0</title>
<path fill="#e6f3ff" stroke="black" d="M376,-67460.47C376,-67460.47 106,-67460.47 106,-67460.47 100,-67460.47 94,-67454.47 94,-67448.47 94,-67448.47 94,-67425.47 94,-67425.47 94,-67419.47 100,-67413.47 106,-67413.47 106,-67413.47 376,-67413.47 376,-67413.47 382,-67413.47 388,-67419.47 388,-67425.47 388,-67425.47 388,-67448.47 388,-67448.47 388,-67454.47 382,-67460.47 376,-67460.47"/>
<text text-anchor="middle" x="241" y="-67445.47" font-family="Arial" font-size="10.00">Layer 13 FFN1 GPU0</text>
<text text-anchor="middle" x="241" y="-67434.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="241" y="-67423.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer13_attn_ar&#45;&gt;layer13_ffn1_0 -->
<g id="edge221" class="edge">
<title>layer13_attn_ar&#45;&gt;layer13_ffn1_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M361.35,-67532.42C335.28,-67511.96 302.78,-67486.45 278.12,-67467.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="280.11,-67464.21 270.08,-67460.79 275.79,-67469.72 280.11,-67464.21"/>
</g>
<!-- layer13_ffn1_1 -->
<g id="node195" class="node">
<title>layer13_ffn1_1</title>
<path fill="#e6f3ff" stroke="black" d="M706,-67460.47C706,-67460.47 436,-67460.47 436,-67460.47 430,-67460.47 424,-67454.47 424,-67448.47 424,-67448.47 424,-67425.47 424,-67425.47 424,-67419.47 430,-67413.47 436,-67413.47 436,-67413.47 706,-67413.47 706,-67413.47 712,-67413.47 718,-67419.47 718,-67425.47 718,-67425.47 718,-67448.47 718,-67448.47 718,-67454.47 712,-67460.47 706,-67460.47"/>
<text text-anchor="middle" x="571" y="-67445.47" font-family="Arial" font-size="10.00">Layer 13 FFN1 GPU1</text>
<text text-anchor="middle" x="571" y="-67434.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="571" y="-67423.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer13_attn_ar&#45;&gt;layer13_ffn1_1 -->
<g id="edge222" class="edge">
<title>layer13_attn_ar&#45;&gt;layer13_ffn1_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M450.65,-67532.42C476.72,-67511.96 509.22,-67486.45 533.88,-67467.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="536.21,-67469.72 541.92,-67460.79 531.89,-67464.21 536.21,-67469.72"/>
</g>
<!-- layer13_act_0 -->
<g id="node196" class="node">
<title>layer13_act_0</title>
<path fill="#e6f3ff" stroke="black" d="M376,-67341.47C376,-67341.47 106,-67341.47 106,-67341.47 100,-67341.47 94,-67335.47 94,-67329.47 94,-67329.47 94,-67306.47 94,-67306.47 94,-67300.47 100,-67294.47 106,-67294.47 106,-67294.47 376,-67294.47 376,-67294.47 382,-67294.47 388,-67300.47 388,-67306.47 388,-67306.47 388,-67329.47 388,-67329.47 388,-67335.47 382,-67341.47 376,-67341.47"/>
<text text-anchor="middle" x="241" y="-67326.47" font-family="Arial" font-size="10.00">Layer 13 SiLU GPU0</text>
<text text-anchor="middle" x="241" y="-67315.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="241" y="-67304.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer13_ffn1_0&#45;&gt;layer13_act_0 -->
<g id="edge223" class="edge">
<title>layer13_ffn1_0&#45;&gt;layer13_act_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M241,-67413.41C241,-67395.96 241,-67371.55 241,-67351.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="244.5,-67351.86 241,-67341.86 237.5,-67351.86 244.5,-67351.86"/>
</g>
<!-- layer13_act_1 -->
<g id="node197" class="node">
<title>layer13_act_1</title>
<path fill="#e6f3ff" stroke="black" d="M706,-67341.47C706,-67341.47 436,-67341.47 436,-67341.47 430,-67341.47 424,-67335.47 424,-67329.47 424,-67329.47 424,-67306.47 424,-67306.47 424,-67300.47 430,-67294.47 436,-67294.47 436,-67294.47 706,-67294.47 706,-67294.47 712,-67294.47 718,-67300.47 718,-67306.47 718,-67306.47 718,-67329.47 718,-67329.47 718,-67335.47 712,-67341.47 706,-67341.47"/>
<text text-anchor="middle" x="571" y="-67326.47" font-family="Arial" font-size="10.00">Layer 13 SiLU GPU1</text>
<text text-anchor="middle" x="571" y="-67315.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="571" y="-67304.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer13_ffn1_1&#45;&gt;layer13_act_1 -->
<g id="edge224" class="edge">
<title>layer13_ffn1_1&#45;&gt;layer13_act_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M571,-67413.41C571,-67395.96 571,-67371.55 571,-67351.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="574.5,-67351.86 571,-67341.86 567.5,-67351.86 574.5,-67351.86"/>
</g>
<!-- layer13_ffn2_0 -->
<g id="node198" class="node">
<title>layer13_ffn2_0</title>
<path fill="#e6f3ff" stroke="black" d="M375.5,-67222.47C375.5,-67222.47 112.5,-67222.47 112.5,-67222.47 106.5,-67222.47 100.5,-67216.47 100.5,-67210.47 100.5,-67210.47 100.5,-67187.47 100.5,-67187.47 100.5,-67181.47 106.5,-67175.47 112.5,-67175.47 112.5,-67175.47 375.5,-67175.47 375.5,-67175.47 381.5,-67175.47 387.5,-67181.47 387.5,-67187.47 387.5,-67187.47 387.5,-67210.47 387.5,-67210.47 387.5,-67216.47 381.5,-67222.47 375.5,-67222.47"/>
<text text-anchor="middle" x="244" y="-67207.47" font-family="Arial" font-size="10.00">Layer 13 FFN2 GPU0</text>
<text text-anchor="middle" x="244" y="-67196.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="244" y="-67185.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer13_act_0&#45;&gt;layer13_ffn2_0 -->
<g id="edge225" class="edge">
<title>layer13_act_0&#45;&gt;layer13_ffn2_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M241.58,-67294.41C242.03,-67276.96 242.65,-67252.55 243.16,-67232.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="246.66,-67232.94 243.41,-67222.86 239.66,-67232.76 246.66,-67232.94"/>
</g>
<!-- layer13_ffn2_1 -->
<g id="node199" class="node">
<title>layer13_ffn2_1</title>
<path fill="#e6f3ff" stroke="black" d="M700.5,-67222.47C700.5,-67222.47 437.5,-67222.47 437.5,-67222.47 431.5,-67222.47 425.5,-67216.47 425.5,-67210.47 425.5,-67210.47 425.5,-67187.47 425.5,-67187.47 425.5,-67181.47 431.5,-67175.47 437.5,-67175.47 437.5,-67175.47 700.5,-67175.47 700.5,-67175.47 706.5,-67175.47 712.5,-67181.47 712.5,-67187.47 712.5,-67187.47 712.5,-67210.47 712.5,-67210.47 712.5,-67216.47 706.5,-67222.47 700.5,-67222.47"/>
<text text-anchor="middle" x="569" y="-67207.47" font-family="Arial" font-size="10.00">Layer 13 FFN2 GPU1</text>
<text text-anchor="middle" x="569" y="-67196.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="569" y="-67185.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer13_act_1&#45;&gt;layer13_ffn2_1 -->
<g id="edge226" class="edge">
<title>layer13_act_1&#45;&gt;layer13_ffn2_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M570.61,-67294.41C570.32,-67276.96 569.9,-67252.55 569.56,-67232.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="573.06,-67232.8 569.39,-67222.86 566.06,-67232.92 573.06,-67232.8"/>
</g>
<!-- layer13_ffn_ar -->
<g id="node200" class="node">
<title>layer13_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M537.22,-67103.47C537.22,-67103.47 331.8,-67103.47 331.8,-67103.47 325.8,-67103.47 316,-67098.83 312.19,-67094.19 312.19,-67094.19 268.39,-67040.75 268.39,-67040.75 264.59,-67036.11 266.78,-67031.47 272.78,-67031.47 272.78,-67031.47 478.2,-67031.47 478.2,-67031.47 484.2,-67031.47 494,-67036.11 497.81,-67040.75 497.81,-67040.75 541.61,-67094.19 541.61,-67094.19 545.41,-67098.83 543.22,-67103.47 537.22,-67103.47"/>
<text text-anchor="middle" x="405" y="-67070.47" font-family="Arial" font-size="10.00">Layer 13 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="405" y="-67059.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer13_ffn2_0&#45;&gt;layer13_ffn_ar -->
<g id="edge227" class="edge">
<title>layer13_ffn2_0&#45;&gt;layer13_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M272.04,-67175.41C294.43,-67157.41 326.4,-67131.69 353.38,-67109.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="355.61,-67112.68 361.21,-67103.69 351.23,-67107.23 355.61,-67112.68"/>
</g>
<!-- layer13_ffn2_1&#45;&gt;layer13_ffn_ar -->
<g id="edge228" class="edge">
<title>layer13_ffn2_1&#45;&gt;layer13_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M540.43,-67175.41C517.63,-67157.41 485.06,-67131.69 457.58,-67109.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="459.62,-67107.14 449.6,-67103.69 455.28,-67112.63 459.62,-67107.14"/>
</g>
<!-- layer14_qkv_0 -->
<g id="node201" class="node">
<title>layer14_qkv_0</title>
<path fill="#e6f3ff" stroke="black" d="M375,-66959.47C375,-66959.47 77,-66959.47 77,-66959.47 71,-66959.47 65,-66953.47 65,-66947.47 65,-66947.47 65,-66924.47 65,-66924.47 65,-66918.47 71,-66912.47 77,-66912.47 77,-66912.47 375,-66912.47 375,-66912.47 381,-66912.47 387,-66918.47 387,-66924.47 387,-66924.47 387,-66947.47 387,-66947.47 387,-66953.47 381,-66959.47 375,-66959.47"/>
<text text-anchor="middle" x="226" y="-66944.47" font-family="Arial" font-size="10.00">Layer 14 QKV Proj GPU0</text>
<text text-anchor="middle" x="226" y="-66933.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="226" y="-66922.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer13_ffn_ar&#45;&gt;layer14_qkv_0 -->
<g id="edge229" class="edge">
<title>layer13_ffn_ar&#45;&gt;layer14_qkv_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M356.56,-67031.42C328.06,-67010.81 292.48,-66985.06 265.66,-66965.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="267.43,-66962.62 257.28,-66959.6 263.33,-66968.3 267.43,-66962.62"/>
</g>
<!-- layer14_qkv_1 -->
<g id="node202" class="node">
<title>layer14_qkv_1</title>
<path fill="#e6f3ff" stroke="black" d="M733,-66959.47C733,-66959.47 435,-66959.47 435,-66959.47 429,-66959.47 423,-66953.47 423,-66947.47 423,-66947.47 423,-66924.47 423,-66924.47 423,-66918.47 429,-66912.47 435,-66912.47 435,-66912.47 733,-66912.47 733,-66912.47 739,-66912.47 745,-66918.47 745,-66924.47 745,-66924.47 745,-66947.47 745,-66947.47 745,-66953.47 739,-66959.47 733,-66959.47"/>
<text text-anchor="middle" x="584" y="-66944.47" font-family="Arial" font-size="10.00">Layer 14 QKV Proj GPU1</text>
<text text-anchor="middle" x="584" y="-66933.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-66922.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer13_ffn_ar&#45;&gt;layer14_qkv_1 -->
<g id="edge230" class="edge">
<title>layer13_ffn_ar&#45;&gt;layer14_qkv_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M453.44,-67031.42C481.94,-67010.81 517.52,-66985.06 544.34,-66965.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="546.67,-66968.3 552.72,-66959.6 542.57,-66962.62 546.67,-66968.3"/>
</g>
<!-- layer14_attn_0 -->
<g id="node203" class="node">
<title>layer14_attn_0</title>
<path fill="#e6f3ff" stroke="black" d="M375,-66840.47C375,-66840.47 77,-66840.47 77,-66840.47 71,-66840.47 65,-66834.47 65,-66828.47 65,-66828.47 65,-66805.47 65,-66805.47 65,-66799.47 71,-66793.47 77,-66793.47 77,-66793.47 375,-66793.47 375,-66793.47 381,-66793.47 387,-66799.47 387,-66805.47 387,-66805.47 387,-66828.47 387,-66828.47 387,-66834.47 381,-66840.47 375,-66840.47"/>
<text text-anchor="middle" x="226" y="-66825.47" font-family="Arial" font-size="10.00">Layer 14 Attention GPU0</text>
<text text-anchor="middle" x="226" y="-66814.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="226" y="-66803.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer14_qkv_0&#45;&gt;layer14_attn_0 -->
<g id="edge231" class="edge">
<title>layer14_qkv_0&#45;&gt;layer14_attn_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M226,-66912.41C226,-66894.96 226,-66870.55 226,-66850.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="229.5,-66850.86 226,-66840.86 222.5,-66850.86 229.5,-66850.86"/>
</g>
<!-- layer14_attn_1 -->
<g id="node204" class="node">
<title>layer14_attn_1</title>
<path fill="#e6f3ff" stroke="black" d="M733,-66840.47C733,-66840.47 435,-66840.47 435,-66840.47 429,-66840.47 423,-66834.47 423,-66828.47 423,-66828.47 423,-66805.47 423,-66805.47 423,-66799.47 429,-66793.47 435,-66793.47 435,-66793.47 733,-66793.47 733,-66793.47 739,-66793.47 745,-66799.47 745,-66805.47 745,-66805.47 745,-66828.47 745,-66828.47 745,-66834.47 739,-66840.47 733,-66840.47"/>
<text text-anchor="middle" x="584" y="-66825.47" font-family="Arial" font-size="10.00">Layer 14 Attention GPU1</text>
<text text-anchor="middle" x="584" y="-66814.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="584" y="-66803.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer14_qkv_1&#45;&gt;layer14_attn_1 -->
<g id="edge232" class="edge">
<title>layer14_qkv_1&#45;&gt;layer14_attn_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M584,-66912.41C584,-66894.96 584,-66870.55 584,-66850.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="587.5,-66850.86 584,-66840.86 580.5,-66850.86 587.5,-66850.86"/>
</g>
<!-- layer14_attn_out_0 -->
<g id="node205" class="node">
<title>layer14_attn_out_0</title>
<path fill="#e6f3ff" stroke="black" d="M375,-66721.47C375,-66721.47 85,-66721.47 85,-66721.47 79,-66721.47 73,-66715.47 73,-66709.47 73,-66709.47 73,-66686.47 73,-66686.47 73,-66680.47 79,-66674.47 85,-66674.47 85,-66674.47 375,-66674.47 375,-66674.47 381,-66674.47 387,-66680.47 387,-66686.47 387,-66686.47 387,-66709.47 387,-66709.47 387,-66715.47 381,-66721.47 375,-66721.47"/>
<text text-anchor="middle" x="230" y="-66706.47" font-family="Arial" font-size="10.00">Layer 14 Attn Out GPU0</text>
<text text-anchor="middle" x="230" y="-66695.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="230" y="-66684.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer14_attn_0&#45;&gt;layer14_attn_out_0 -->
<g id="edge233" class="edge">
<title>layer14_attn_0&#45;&gt;layer14_attn_out_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M226.77,-66793.41C227.37,-66775.96 228.2,-66751.55 228.87,-66731.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="232.37,-66731.97 229.22,-66721.86 225.38,-66731.73 232.37,-66731.97"/>
</g>
<!-- layer14_attn_out_1 -->
<g id="node206" class="node">
<title>layer14_attn_out_1</title>
<path fill="#e6f3ff" stroke="black" d="M727,-66721.47C727,-66721.47 437,-66721.47 437,-66721.47 431,-66721.47 425,-66715.47 425,-66709.47 425,-66709.47 425,-66686.47 425,-66686.47 425,-66680.47 431,-66674.47 437,-66674.47 437,-66674.47 727,-66674.47 727,-66674.47 733,-66674.47 739,-66680.47 739,-66686.47 739,-66686.47 739,-66709.47 739,-66709.47 739,-66715.47 733,-66721.47 727,-66721.47"/>
<text text-anchor="middle" x="582" y="-66706.47" font-family="Arial" font-size="10.00">Layer 14 Attn Out GPU1</text>
<text text-anchor="middle" x="582" y="-66695.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="582" y="-66684.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer14_attn_1&#45;&gt;layer14_attn_out_1 -->
<g id="edge234" class="edge">
<title>layer14_attn_1&#45;&gt;layer14_attn_out_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M583.61,-66793.41C583.32,-66775.96 582.9,-66751.55 582.56,-66731.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="586.06,-66731.8 582.39,-66721.86 579.06,-66731.92 586.06,-66731.8"/>
</g>
<!-- layer14_attn_ar -->
<g id="node207" class="node">
<title>layer14_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M535.07,-66602.47C535.07,-66602.47 333.07,-66602.47 333.07,-66602.47 327.07,-66602.47 317.3,-66597.8 313.53,-66593.13 313.53,-66593.13 270.47,-66539.8 270.47,-66539.8 266.7,-66535.14 268.93,-66530.47 274.93,-66530.47 274.93,-66530.47 476.93,-66530.47 476.93,-66530.47 482.93,-66530.47 492.7,-66535.14 496.47,-66539.8 496.47,-66539.8 539.53,-66593.13 539.53,-66593.13 543.3,-66597.8 541.07,-66602.47 535.07,-66602.47"/>
<text text-anchor="middle" x="405" y="-66569.47" font-family="Arial" font-size="10.00">Layer 14 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="405" y="-66558.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer14_attn_out_0&#45;&gt;layer14_attn_ar -->
<g id="edge235" class="edge">
<title>layer14_attn_out_0&#45;&gt;layer14_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M260.48,-66674.41C284.92,-66656.33 319.86,-66630.47 349.27,-66608.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="351.45,-66611.45 357.4,-66602.69 347.28,-66605.82 351.45,-66611.45"/>
</g>
<!-- layer14_attn_out_1&#45;&gt;layer14_attn_ar -->
<g id="edge236" class="edge">
<title>layer14_attn_out_1&#45;&gt;layer14_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M551.17,-66674.41C526.45,-66656.33 491.11,-66630.47 461.37,-66608.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="463.28,-66605.77 453.14,-66602.69 459.14,-66611.42 463.28,-66605.77"/>
</g>
<!-- layer14_ffn1_0 -->
<g id="node208" class="node">
<title>layer14_ffn1_0</title>
<path fill="#e6f3ff" stroke="black" d="M375,-66458.47C375,-66458.47 105,-66458.47 105,-66458.47 99,-66458.47 93,-66452.47 93,-66446.47 93,-66446.47 93,-66423.47 93,-66423.47 93,-66417.47 99,-66411.47 105,-66411.47 105,-66411.47 375,-66411.47 375,-66411.47 381,-66411.47 387,-66417.47 387,-66423.47 387,-66423.47 387,-66446.47 387,-66446.47 387,-66452.47 381,-66458.47 375,-66458.47"/>
<text text-anchor="middle" x="240" y="-66443.47" font-family="Arial" font-size="10.00">Layer 14 FFN1 GPU0</text>
<text text-anchor="middle" x="240" y="-66432.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="240" y="-66421.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer14_attn_ar&#45;&gt;layer14_ffn1_0 -->
<g id="edge237" class="edge">
<title>layer14_attn_ar&#45;&gt;layer14_ffn1_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M360.35,-66530.42C334.28,-66509.96 301.78,-66484.45 277.12,-66465.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="279.11,-66462.21 269.08,-66458.79 274.79,-66467.72 279.11,-66462.21"/>
</g>
<!-- layer14_ffn1_1 -->
<g id="node209" class="node">
<title>layer14_ffn1_1</title>
<path fill="#e6f3ff" stroke="black" d="M705,-66458.47C705,-66458.47 435,-66458.47 435,-66458.47 429,-66458.47 423,-66452.47 423,-66446.47 423,-66446.47 423,-66423.47 423,-66423.47 423,-66417.47 429,-66411.47 435,-66411.47 435,-66411.47 705,-66411.47 705,-66411.47 711,-66411.47 717,-66417.47 717,-66423.47 717,-66423.47 717,-66446.47 717,-66446.47 717,-66452.47 711,-66458.47 705,-66458.47"/>
<text text-anchor="middle" x="570" y="-66443.47" font-family="Arial" font-size="10.00">Layer 14 FFN1 GPU1</text>
<text text-anchor="middle" x="570" y="-66432.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="570" y="-66421.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer14_attn_ar&#45;&gt;layer14_ffn1_1 -->
<g id="edge238" class="edge">
<title>layer14_attn_ar&#45;&gt;layer14_ffn1_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M449.65,-66530.42C475.72,-66509.96 508.22,-66484.45 532.88,-66465.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="535.21,-66467.72 540.92,-66458.79 530.89,-66462.21 535.21,-66467.72"/>
</g>
<!-- layer14_act_0 -->
<g id="node210" class="node">
<title>layer14_act_0</title>
<path fill="#e6f3ff" stroke="black" d="M375,-66339.47C375,-66339.47 105,-66339.47 105,-66339.47 99,-66339.47 93,-66333.47 93,-66327.47 93,-66327.47 93,-66304.47 93,-66304.47 93,-66298.47 99,-66292.47 105,-66292.47 105,-66292.47 375,-66292.47 375,-66292.47 381,-66292.47 387,-66298.47 387,-66304.47 387,-66304.47 387,-66327.47 387,-66327.47 387,-66333.47 381,-66339.47 375,-66339.47"/>
<text text-anchor="middle" x="240" y="-66324.47" font-family="Arial" font-size="10.00">Layer 14 SiLU GPU0</text>
<text text-anchor="middle" x="240" y="-66313.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="240" y="-66302.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer14_ffn1_0&#45;&gt;layer14_act_0 -->
<g id="edge239" class="edge">
<title>layer14_ffn1_0&#45;&gt;layer14_act_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M240,-66411.41C240,-66393.96 240,-66369.55 240,-66349.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="243.5,-66349.86 240,-66339.86 236.5,-66349.86 243.5,-66349.86"/>
</g>
<!-- layer14_act_1 -->
<g id="node211" class="node">
<title>layer14_act_1</title>
<path fill="#e6f3ff" stroke="black" d="M705,-66339.47C705,-66339.47 435,-66339.47 435,-66339.47 429,-66339.47 423,-66333.47 423,-66327.47 423,-66327.47 423,-66304.47 423,-66304.47 423,-66298.47 429,-66292.47 435,-66292.47 435,-66292.47 705,-66292.47 705,-66292.47 711,-66292.47 717,-66298.47 717,-66304.47 717,-66304.47 717,-66327.47 717,-66327.47 717,-66333.47 711,-66339.47 705,-66339.47"/>
<text text-anchor="middle" x="570" y="-66324.47" font-family="Arial" font-size="10.00">Layer 14 SiLU GPU1</text>
<text text-anchor="middle" x="570" y="-66313.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="570" y="-66302.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer14_ffn1_1&#45;&gt;layer14_act_1 -->
<g id="edge240" class="edge">
<title>layer14_ffn1_1&#45;&gt;layer14_act_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M570,-66411.41C570,-66393.96 570,-66369.55 570,-66349.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="573.5,-66349.86 570,-66339.86 566.5,-66349.86 573.5,-66349.86"/>
</g>
<!-- layer14_ffn2_0 -->
<g id="node212" class="node">
<title>layer14_ffn2_0</title>
<path fill="#e6f3ff" stroke="black" d="M374.5,-66220.47C374.5,-66220.47 111.5,-66220.47 111.5,-66220.47 105.5,-66220.47 99.5,-66214.47 99.5,-66208.47 99.5,-66208.47 99.5,-66185.47 99.5,-66185.47 99.5,-66179.47 105.5,-66173.47 111.5,-66173.47 111.5,-66173.47 374.5,-66173.47 374.5,-66173.47 380.5,-66173.47 386.5,-66179.47 386.5,-66185.47 386.5,-66185.47 386.5,-66208.47 386.5,-66208.47 386.5,-66214.47 380.5,-66220.47 374.5,-66220.47"/>
<text text-anchor="middle" x="243" y="-66205.47" font-family="Arial" font-size="10.00">Layer 14 FFN2 GPU0</text>
<text text-anchor="middle" x="243" y="-66194.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="243" y="-66183.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer14_act_0&#45;&gt;layer14_ffn2_0 -->
<g id="edge241" class="edge">
<title>layer14_act_0&#45;&gt;layer14_ffn2_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M240.58,-66292.41C241.03,-66274.96 241.65,-66250.55 242.16,-66230.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="245.66,-66230.94 242.41,-66220.86 238.66,-66230.76 245.66,-66230.94"/>
</g>
<!-- layer14_ffn2_1 -->
<g id="node213" class="node">
<title>layer14_ffn2_1</title>
<path fill="#e6f3ff" stroke="black" d="M699.5,-66220.47C699.5,-66220.47 436.5,-66220.47 436.5,-66220.47 430.5,-66220.47 424.5,-66214.47 424.5,-66208.47 424.5,-66208.47 424.5,-66185.47 424.5,-66185.47 424.5,-66179.47 430.5,-66173.47 436.5,-66173.47 436.5,-66173.47 699.5,-66173.47 699.5,-66173.47 705.5,-66173.47 711.5,-66179.47 711.5,-66185.47 711.5,-66185.47 711.5,-66208.47 711.5,-66208.47 711.5,-66214.47 705.5,-66220.47 699.5,-66220.47"/>
<text text-anchor="middle" x="568" y="-66205.47" font-family="Arial" font-size="10.00">Layer 14 FFN2 GPU1</text>
<text text-anchor="middle" x="568" y="-66194.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="568" y="-66183.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer14_act_1&#45;&gt;layer14_ffn2_1 -->
<g id="edge242" class="edge">
<title>layer14_act_1&#45;&gt;layer14_ffn2_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M569.61,-66292.41C569.32,-66274.96 568.9,-66250.55 568.56,-66230.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="572.06,-66230.8 568.39,-66220.86 565.06,-66230.92 572.06,-66230.8"/>
</g>
<!-- layer14_ffn_ar -->
<g id="node214" class="node">
<title>layer14_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M536.22,-66101.47C536.22,-66101.47 330.8,-66101.47 330.8,-66101.47 324.8,-66101.47 315,-66096.83 311.19,-66092.19 311.19,-66092.19 267.39,-66038.75 267.39,-66038.75 263.59,-66034.11 265.78,-66029.47 271.78,-66029.47 271.78,-66029.47 477.2,-66029.47 477.2,-66029.47 483.2,-66029.47 493,-66034.11 496.81,-66038.75 496.81,-66038.75 540.61,-66092.19 540.61,-66092.19 544.41,-66096.83 542.22,-66101.47 536.22,-66101.47"/>
<text text-anchor="middle" x="404" y="-66068.47" font-family="Arial" font-size="10.00">Layer 14 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="404" y="-66057.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer14_ffn2_0&#45;&gt;layer14_ffn_ar -->
<g id="edge243" class="edge">
<title>layer14_ffn2_0&#45;&gt;layer14_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M271.04,-66173.41C293.43,-66155.41 325.4,-66129.69 352.38,-66107.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="354.61,-66110.68 360.21,-66101.69 350.23,-66105.23 354.61,-66110.68"/>
</g>
<!-- layer14_ffn2_1&#45;&gt;layer14_ffn_ar -->
<g id="edge244" class="edge">
<title>layer14_ffn2_1&#45;&gt;layer14_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M539.43,-66173.41C516.63,-66155.41 484.06,-66129.69 456.58,-66107.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="458.62,-66105.14 448.6,-66101.69 454.28,-66110.63 458.62,-66105.14"/>
</g>
<!-- layer15_qkv_0 -->
<g id="node215" class="node">
<title>layer15_qkv_0</title>
<path fill="#e6f3ff" stroke="black" d="M374,-65957.47C374,-65957.47 76,-65957.47 76,-65957.47 70,-65957.47 64,-65951.47 64,-65945.47 64,-65945.47 64,-65922.47 64,-65922.47 64,-65916.47 70,-65910.47 76,-65910.47 76,-65910.47 374,-65910.47 374,-65910.47 380,-65910.47 386,-65916.47 386,-65922.47 386,-65922.47 386,-65945.47 386,-65945.47 386,-65951.47 380,-65957.47 374,-65957.47"/>
<text text-anchor="middle" x="225" y="-65942.47" font-family="Arial" font-size="10.00">Layer 15 QKV Proj GPU0</text>
<text text-anchor="middle" x="225" y="-65931.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="225" y="-65920.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer14_ffn_ar&#45;&gt;layer15_qkv_0 -->
<g id="edge245" class="edge">
<title>layer14_ffn_ar&#45;&gt;layer15_qkv_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M355.56,-66029.42C327.06,-66008.81 291.48,-65983.06 264.66,-65963.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="266.43,-65960.62 256.28,-65957.6 262.33,-65966.3 266.43,-65960.62"/>
</g>
<!-- layer15_qkv_1 -->
<g id="node216" class="node">
<title>layer15_qkv_1</title>
<path fill="#e6f3ff" stroke="black" d="M732,-65957.47C732,-65957.47 434,-65957.47 434,-65957.47 428,-65957.47 422,-65951.47 422,-65945.47 422,-65945.47 422,-65922.47 422,-65922.47 422,-65916.47 428,-65910.47 434,-65910.47 434,-65910.47 732,-65910.47 732,-65910.47 738,-65910.47 744,-65916.47 744,-65922.47 744,-65922.47 744,-65945.47 744,-65945.47 744,-65951.47 738,-65957.47 732,-65957.47"/>
<text text-anchor="middle" x="583" y="-65942.47" font-family="Arial" font-size="10.00">Layer 15 QKV Proj GPU1</text>
<text text-anchor="middle" x="583" y="-65931.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="583" y="-65920.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer14_ffn_ar&#45;&gt;layer15_qkv_1 -->
<g id="edge246" class="edge">
<title>layer14_ffn_ar&#45;&gt;layer15_qkv_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M452.44,-66029.42C480.94,-66008.81 516.52,-65983.06 543.34,-65963.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="545.67,-65966.3 551.72,-65957.6 541.57,-65960.62 545.67,-65966.3"/>
</g>
<!-- layer15_attn_0 -->
<g id="node217" class="node">
<title>layer15_attn_0</title>
<path fill="#e6f3ff" stroke="black" d="M374,-65838.47C374,-65838.47 76,-65838.47 76,-65838.47 70,-65838.47 64,-65832.47 64,-65826.47 64,-65826.47 64,-65803.47 64,-65803.47 64,-65797.47 70,-65791.47 76,-65791.47 76,-65791.47 374,-65791.47 374,-65791.47 380,-65791.47 386,-65797.47 386,-65803.47 386,-65803.47 386,-65826.47 386,-65826.47 386,-65832.47 380,-65838.47 374,-65838.47"/>
<text text-anchor="middle" x="225" y="-65823.47" font-family="Arial" font-size="10.00">Layer 15 Attention GPU0</text>
<text text-anchor="middle" x="225" y="-65812.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="225" y="-65801.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer15_qkv_0&#45;&gt;layer15_attn_0 -->
<g id="edge247" class="edge">
<title>layer15_qkv_0&#45;&gt;layer15_attn_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M225,-65910.41C225,-65892.96 225,-65868.55 225,-65848.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="228.5,-65848.86 225,-65838.86 221.5,-65848.86 228.5,-65848.86"/>
</g>
<!-- layer15_attn_1 -->
<g id="node218" class="node">
<title>layer15_attn_1</title>
<path fill="#e6f3ff" stroke="black" d="M732,-65838.47C732,-65838.47 434,-65838.47 434,-65838.47 428,-65838.47 422,-65832.47 422,-65826.47 422,-65826.47 422,-65803.47 422,-65803.47 422,-65797.47 428,-65791.47 434,-65791.47 434,-65791.47 732,-65791.47 732,-65791.47 738,-65791.47 744,-65797.47 744,-65803.47 744,-65803.47 744,-65826.47 744,-65826.47 744,-65832.47 738,-65838.47 732,-65838.47"/>
<text text-anchor="middle" x="583" y="-65823.47" font-family="Arial" font-size="10.00">Layer 15 Attention GPU1</text>
<text text-anchor="middle" x="583" y="-65812.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="583" y="-65801.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer15_qkv_1&#45;&gt;layer15_attn_1 -->
<g id="edge248" class="edge">
<title>layer15_qkv_1&#45;&gt;layer15_attn_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M583,-65910.41C583,-65892.96 583,-65868.55 583,-65848.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="586.5,-65848.86 583,-65838.86 579.5,-65848.86 586.5,-65848.86"/>
</g>
<!-- layer15_attn_out_0 -->
<g id="node219" class="node">
<title>layer15_attn_out_0</title>
<path fill="#e6f3ff" stroke="black" d="M374,-65719.47C374,-65719.47 84,-65719.47 84,-65719.47 78,-65719.47 72,-65713.47 72,-65707.47 72,-65707.47 72,-65684.47 72,-65684.47 72,-65678.47 78,-65672.47 84,-65672.47 84,-65672.47 374,-65672.47 374,-65672.47 380,-65672.47 386,-65678.47 386,-65684.47 386,-65684.47 386,-65707.47 386,-65707.47 386,-65713.47 380,-65719.47 374,-65719.47"/>
<text text-anchor="middle" x="229" y="-65704.47" font-family="Arial" font-size="10.00">Layer 15 Attn Out GPU0</text>
<text text-anchor="middle" x="229" y="-65693.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="229" y="-65682.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer15_attn_0&#45;&gt;layer15_attn_out_0 -->
<g id="edge249" class="edge">
<title>layer15_attn_0&#45;&gt;layer15_attn_out_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M225.77,-65791.41C226.37,-65773.96 227.2,-65749.55 227.87,-65729.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="231.37,-65729.97 228.22,-65719.86 224.38,-65729.73 231.37,-65729.97"/>
</g>
<!-- layer15_attn_out_1 -->
<g id="node220" class="node">
<title>layer15_attn_out_1</title>
<path fill="#e6f3ff" stroke="black" d="M726,-65719.47C726,-65719.47 436,-65719.47 436,-65719.47 430,-65719.47 424,-65713.47 424,-65707.47 424,-65707.47 424,-65684.47 424,-65684.47 424,-65678.47 430,-65672.47 436,-65672.47 436,-65672.47 726,-65672.47 726,-65672.47 732,-65672.47 738,-65678.47 738,-65684.47 738,-65684.47 738,-65707.47 738,-65707.47 738,-65713.47 732,-65719.47 726,-65719.47"/>
<text text-anchor="middle" x="581" y="-65704.47" font-family="Arial" font-size="10.00">Layer 15 Attn Out GPU1</text>
<text text-anchor="middle" x="581" y="-65693.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="581" y="-65682.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer15_attn_1&#45;&gt;layer15_attn_out_1 -->
<g id="edge250" class="edge">
<title>layer15_attn_1&#45;&gt;layer15_attn_out_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M582.61,-65791.41C582.32,-65773.96 581.9,-65749.55 581.56,-65729.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="585.06,-65729.8 581.39,-65719.86 578.06,-65729.92 585.06,-65729.8"/>
</g>
<!-- layer15_attn_ar -->
<g id="node221" class="node">
<title>layer15_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M534.07,-65600.47C534.07,-65600.47 332.07,-65600.47 332.07,-65600.47 326.07,-65600.47 316.3,-65595.8 312.53,-65591.13 312.53,-65591.13 269.47,-65537.8 269.47,-65537.8 265.7,-65533.14 267.93,-65528.47 273.93,-65528.47 273.93,-65528.47 475.93,-65528.47 475.93,-65528.47 481.93,-65528.47 491.7,-65533.14 495.47,-65537.8 495.47,-65537.8 538.53,-65591.13 538.53,-65591.13 542.3,-65595.8 540.07,-65600.47 534.07,-65600.47"/>
<text text-anchor="middle" x="404" y="-65567.47" font-family="Arial" font-size="10.00">Layer 15 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="404" y="-65556.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer15_attn_out_0&#45;&gt;layer15_attn_ar -->
<g id="edge251" class="edge">
<title>layer15_attn_out_0&#45;&gt;layer15_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M259.48,-65672.41C283.92,-65654.33 318.86,-65628.47 348.27,-65606.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="350.45,-65609.45 356.4,-65600.69 346.28,-65603.82 350.45,-65609.45"/>
</g>
<!-- layer15_attn_out_1&#45;&gt;layer15_attn_ar -->
<g id="edge252" class="edge">
<title>layer15_attn_out_1&#45;&gt;layer15_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M550.17,-65672.41C525.45,-65654.33 490.11,-65628.47 460.37,-65606.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="462.28,-65603.77 452.14,-65600.69 458.14,-65609.42 462.28,-65603.77"/>
</g>
<!-- layer15_ffn1_0 -->
<g id="node222" class="node">
<title>layer15_ffn1_0</title>
<path fill="#e6f3ff" stroke="black" d="M374,-65456.47C374,-65456.47 104,-65456.47 104,-65456.47 98,-65456.47 92,-65450.47 92,-65444.47 92,-65444.47 92,-65421.47 92,-65421.47 92,-65415.47 98,-65409.47 104,-65409.47 104,-65409.47 374,-65409.47 374,-65409.47 380,-65409.47 386,-65415.47 386,-65421.47 386,-65421.47 386,-65444.47 386,-65444.47 386,-65450.47 380,-65456.47 374,-65456.47"/>
<text text-anchor="middle" x="239" y="-65441.47" font-family="Arial" font-size="10.00">Layer 15 FFN1 GPU0</text>
<text text-anchor="middle" x="239" y="-65430.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="239" y="-65419.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer15_attn_ar&#45;&gt;layer15_ffn1_0 -->
<g id="edge253" class="edge">
<title>layer15_attn_ar&#45;&gt;layer15_ffn1_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M359.35,-65528.42C333.28,-65507.96 300.78,-65482.45 276.12,-65463.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="278.11,-65460.21 268.08,-65456.79 273.79,-65465.72 278.11,-65460.21"/>
</g>
<!-- layer15_ffn1_1 -->
<g id="node223" class="node">
<title>layer15_ffn1_1</title>
<path fill="#e6f3ff" stroke="black" d="M704,-65456.47C704,-65456.47 434,-65456.47 434,-65456.47 428,-65456.47 422,-65450.47 422,-65444.47 422,-65444.47 422,-65421.47 422,-65421.47 422,-65415.47 428,-65409.47 434,-65409.47 434,-65409.47 704,-65409.47 704,-65409.47 710,-65409.47 716,-65415.47 716,-65421.47 716,-65421.47 716,-65444.47 716,-65444.47 716,-65450.47 710,-65456.47 704,-65456.47"/>
<text text-anchor="middle" x="569" y="-65441.47" font-family="Arial" font-size="10.00">Layer 15 FFN1 GPU1</text>
<text text-anchor="middle" x="569" y="-65430.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="569" y="-65419.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer15_attn_ar&#45;&gt;layer15_ffn1_1 -->
<g id="edge254" class="edge">
<title>layer15_attn_ar&#45;&gt;layer15_ffn1_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M448.65,-65528.42C474.72,-65507.96 507.22,-65482.45 531.88,-65463.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="534.21,-65465.72 539.92,-65456.79 529.89,-65460.21 534.21,-65465.72"/>
</g>
<!-- layer15_act_0 -->
<g id="node224" class="node">
<title>layer15_act_0</title>
<path fill="#e6f3ff" stroke="black" d="M374,-65337.47C374,-65337.47 104,-65337.47 104,-65337.47 98,-65337.47 92,-65331.47 92,-65325.47 92,-65325.47 92,-65302.47 92,-65302.47 92,-65296.47 98,-65290.47 104,-65290.47 104,-65290.47 374,-65290.47 374,-65290.47 380,-65290.47 386,-65296.47 386,-65302.47 386,-65302.47 386,-65325.47 386,-65325.47 386,-65331.47 380,-65337.47 374,-65337.47"/>
<text text-anchor="middle" x="239" y="-65322.47" font-family="Arial" font-size="10.00">Layer 15 SiLU GPU0</text>
<text text-anchor="middle" x="239" y="-65311.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="239" y="-65300.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer15_ffn1_0&#45;&gt;layer15_act_0 -->
<g id="edge255" class="edge">
<title>layer15_ffn1_0&#45;&gt;layer15_act_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M239,-65409.41C239,-65391.96 239,-65367.55 239,-65347.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="242.5,-65347.86 239,-65337.86 235.5,-65347.86 242.5,-65347.86"/>
</g>
<!-- layer15_act_1 -->
<g id="node225" class="node">
<title>layer15_act_1</title>
<path fill="#e6f3ff" stroke="black" d="M704,-65337.47C704,-65337.47 434,-65337.47 434,-65337.47 428,-65337.47 422,-65331.47 422,-65325.47 422,-65325.47 422,-65302.47 422,-65302.47 422,-65296.47 428,-65290.47 434,-65290.47 434,-65290.47 704,-65290.47 704,-65290.47 710,-65290.47 716,-65296.47 716,-65302.47 716,-65302.47 716,-65325.47 716,-65325.47 716,-65331.47 710,-65337.47 704,-65337.47"/>
<text text-anchor="middle" x="569" y="-65322.47" font-family="Arial" font-size="10.00">Layer 15 SiLU GPU1</text>
<text text-anchor="middle" x="569" y="-65311.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="569" y="-65300.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer15_ffn1_1&#45;&gt;layer15_act_1 -->
<g id="edge256" class="edge">
<title>layer15_ffn1_1&#45;&gt;layer15_act_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M569,-65409.41C569,-65391.96 569,-65367.55 569,-65347.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="572.5,-65347.86 569,-65337.86 565.5,-65347.86 572.5,-65347.86"/>
</g>
<!-- layer15_ffn2_0 -->
<g id="node226" class="node">
<title>layer15_ffn2_0</title>
<path fill="#e6f3ff" stroke="black" d="M373.5,-65218.47C373.5,-65218.47 110.5,-65218.47 110.5,-65218.47 104.5,-65218.47 98.5,-65212.47 98.5,-65206.47 98.5,-65206.47 98.5,-65183.47 98.5,-65183.47 98.5,-65177.47 104.5,-65171.47 110.5,-65171.47 110.5,-65171.47 373.5,-65171.47 373.5,-65171.47 379.5,-65171.47 385.5,-65177.47 385.5,-65183.47 385.5,-65183.47 385.5,-65206.47 385.5,-65206.47 385.5,-65212.47 379.5,-65218.47 373.5,-65218.47"/>
<text text-anchor="middle" x="242" y="-65203.47" font-family="Arial" font-size="10.00">Layer 15 FFN2 GPU0</text>
<text text-anchor="middle" x="242" y="-65192.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="242" y="-65181.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer15_act_0&#45;&gt;layer15_ffn2_0 -->
<g id="edge257" class="edge">
<title>layer15_act_0&#45;&gt;layer15_ffn2_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M239.58,-65290.41C240.03,-65272.96 240.65,-65248.55 241.16,-65228.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="244.66,-65228.94 241.41,-65218.86 237.66,-65228.76 244.66,-65228.94"/>
</g>
<!-- layer15_ffn2_1 -->
<g id="node227" class="node">
<title>layer15_ffn2_1</title>
<path fill="#e6f3ff" stroke="black" d="M698.5,-65218.47C698.5,-65218.47 435.5,-65218.47 435.5,-65218.47 429.5,-65218.47 423.5,-65212.47 423.5,-65206.47 423.5,-65206.47 423.5,-65183.47 423.5,-65183.47 423.5,-65177.47 429.5,-65171.47 435.5,-65171.47 435.5,-65171.47 698.5,-65171.47 698.5,-65171.47 704.5,-65171.47 710.5,-65177.47 710.5,-65183.47 710.5,-65183.47 710.5,-65206.47 710.5,-65206.47 710.5,-65212.47 704.5,-65218.47 698.5,-65218.47"/>
<text text-anchor="middle" x="567" y="-65203.47" font-family="Arial" font-size="10.00">Layer 15 FFN2 GPU1</text>
<text text-anchor="middle" x="567" y="-65192.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="567" y="-65181.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer15_act_1&#45;&gt;layer15_ffn2_1 -->
<g id="edge258" class="edge">
<title>layer15_act_1&#45;&gt;layer15_ffn2_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M568.61,-65290.41C568.32,-65272.96 567.9,-65248.55 567.56,-65228.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="571.06,-65228.8 567.39,-65218.86 564.06,-65228.92 571.06,-65228.8"/>
</g>
<!-- layer15_ffn_ar -->
<g id="node228" class="node">
<title>layer15_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M535.22,-65099.47C535.22,-65099.47 329.8,-65099.47 329.8,-65099.47 323.8,-65099.47 314,-65094.83 310.19,-65090.19 310.19,-65090.19 266.39,-65036.75 266.39,-65036.75 262.59,-65032.11 264.78,-65027.47 270.78,-65027.47 270.78,-65027.47 476.2,-65027.47 476.2,-65027.47 482.2,-65027.47 492,-65032.11 495.81,-65036.75 495.81,-65036.75 539.61,-65090.19 539.61,-65090.19 543.41,-65094.83 541.22,-65099.47 535.22,-65099.47"/>
<text text-anchor="middle" x="403" y="-65066.47" font-family="Arial" font-size="10.00">Layer 15 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="403" y="-65055.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer15_ffn2_0&#45;&gt;layer15_ffn_ar -->
<g id="edge259" class="edge">
<title>layer15_ffn2_0&#45;&gt;layer15_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M270.04,-65171.41C292.43,-65153.41 324.4,-65127.69 351.38,-65105.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="353.61,-65108.68 359.21,-65099.69 349.23,-65103.23 353.61,-65108.68"/>
</g>
<!-- layer15_ffn2_1&#45;&gt;layer15_ffn_ar -->
<g id="edge260" class="edge">
<title>layer15_ffn2_1&#45;&gt;layer15_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M538.43,-65171.41C515.63,-65153.41 483.06,-65127.69 455.58,-65105.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="457.62,-65103.14 447.6,-65099.69 453.28,-65108.63 457.62,-65103.14"/>
</g>
<!-- layer16_qkv_0 -->
<g id="node229" class="node">
<title>layer16_qkv_0</title>
<path fill="#e6f3ff" stroke="black" d="M373,-64955.47C373,-64955.47 75,-64955.47 75,-64955.47 69,-64955.47 63,-64949.47 63,-64943.47 63,-64943.47 63,-64920.47 63,-64920.47 63,-64914.47 69,-64908.47 75,-64908.47 75,-64908.47 373,-64908.47 373,-64908.47 379,-64908.47 385,-64914.47 385,-64920.47 385,-64920.47 385,-64943.47 385,-64943.47 385,-64949.47 379,-64955.47 373,-64955.47"/>
<text text-anchor="middle" x="224" y="-64940.47" font-family="Arial" font-size="10.00">Layer 16 QKV Proj GPU0</text>
<text text-anchor="middle" x="224" y="-64929.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="224" y="-64918.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer15_ffn_ar&#45;&gt;layer16_qkv_0 -->
<g id="edge261" class="edge">
<title>layer15_ffn_ar&#45;&gt;layer16_qkv_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M354.56,-65027.42C326.06,-65006.81 290.48,-64981.06 263.66,-64961.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="265.43,-64958.62 255.28,-64955.6 261.33,-64964.3 265.43,-64958.62"/>
</g>
<!-- layer16_qkv_1 -->
<g id="node230" class="node">
<title>layer16_qkv_1</title>
<path fill="#e6f3ff" stroke="black" d="M731,-64955.47C731,-64955.47 433,-64955.47 433,-64955.47 427,-64955.47 421,-64949.47 421,-64943.47 421,-64943.47 421,-64920.47 421,-64920.47 421,-64914.47 427,-64908.47 433,-64908.47 433,-64908.47 731,-64908.47 731,-64908.47 737,-64908.47 743,-64914.47 743,-64920.47 743,-64920.47 743,-64943.47 743,-64943.47 743,-64949.47 737,-64955.47 731,-64955.47"/>
<text text-anchor="middle" x="582" y="-64940.47" font-family="Arial" font-size="10.00">Layer 16 QKV Proj GPU1</text>
<text text-anchor="middle" x="582" y="-64929.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="582" y="-64918.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer15_ffn_ar&#45;&gt;layer16_qkv_1 -->
<g id="edge262" class="edge">
<title>layer15_ffn_ar&#45;&gt;layer16_qkv_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M451.44,-65027.42C479.94,-65006.81 515.52,-64981.06 542.34,-64961.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="544.67,-64964.3 550.72,-64955.6 540.57,-64958.62 544.67,-64964.3"/>
</g>
<!-- layer16_attn_0 -->
<g id="node231" class="node">
<title>layer16_attn_0</title>
<path fill="#e6f3ff" stroke="black" d="M373,-64836.47C373,-64836.47 75,-64836.47 75,-64836.47 69,-64836.47 63,-64830.47 63,-64824.47 63,-64824.47 63,-64801.47 63,-64801.47 63,-64795.47 69,-64789.47 75,-64789.47 75,-64789.47 373,-64789.47 373,-64789.47 379,-64789.47 385,-64795.47 385,-64801.47 385,-64801.47 385,-64824.47 385,-64824.47 385,-64830.47 379,-64836.47 373,-64836.47"/>
<text text-anchor="middle" x="224" y="-64821.47" font-family="Arial" font-size="10.00">Layer 16 Attention GPU0</text>
<text text-anchor="middle" x="224" y="-64810.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="224" y="-64799.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer16_qkv_0&#45;&gt;layer16_attn_0 -->
<g id="edge263" class="edge">
<title>layer16_qkv_0&#45;&gt;layer16_attn_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M224,-64908.41C224,-64890.96 224,-64866.55 224,-64846.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="227.5,-64846.86 224,-64836.86 220.5,-64846.86 227.5,-64846.86"/>
</g>
<!-- layer16_attn_1 -->
<g id="node232" class="node">
<title>layer16_attn_1</title>
<path fill="#e6f3ff" stroke="black" d="M731,-64836.47C731,-64836.47 433,-64836.47 433,-64836.47 427,-64836.47 421,-64830.47 421,-64824.47 421,-64824.47 421,-64801.47 421,-64801.47 421,-64795.47 427,-64789.47 433,-64789.47 433,-64789.47 731,-64789.47 731,-64789.47 737,-64789.47 743,-64795.47 743,-64801.47 743,-64801.47 743,-64824.47 743,-64824.47 743,-64830.47 737,-64836.47 731,-64836.47"/>
<text text-anchor="middle" x="582" y="-64821.47" font-family="Arial" font-size="10.00">Layer 16 Attention GPU1</text>
<text text-anchor="middle" x="582" y="-64810.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="582" y="-64799.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer16_qkv_1&#45;&gt;layer16_attn_1 -->
<g id="edge264" class="edge">
<title>layer16_qkv_1&#45;&gt;layer16_attn_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M582,-64908.41C582,-64890.96 582,-64866.55 582,-64846.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="585.5,-64846.86 582,-64836.86 578.5,-64846.86 585.5,-64846.86"/>
</g>
<!-- layer16_attn_out_0 -->
<g id="node233" class="node">
<title>layer16_attn_out_0</title>
<path fill="#e6f3ff" stroke="black" d="M373,-64717.47C373,-64717.47 83,-64717.47 83,-64717.47 77,-64717.47 71,-64711.47 71,-64705.47 71,-64705.47 71,-64682.47 71,-64682.47 71,-64676.47 77,-64670.47 83,-64670.47 83,-64670.47 373,-64670.47 373,-64670.47 379,-64670.47 385,-64676.47 385,-64682.47 385,-64682.47 385,-64705.47 385,-64705.47 385,-64711.47 379,-64717.47 373,-64717.47"/>
<text text-anchor="middle" x="228" y="-64702.47" font-family="Arial" font-size="10.00">Layer 16 Attn Out GPU0</text>
<text text-anchor="middle" x="228" y="-64691.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="228" y="-64680.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer16_attn_0&#45;&gt;layer16_attn_out_0 -->
<g id="edge265" class="edge">
<title>layer16_attn_0&#45;&gt;layer16_attn_out_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M224.77,-64789.41C225.37,-64771.96 226.2,-64747.55 226.87,-64727.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="230.37,-64727.97 227.22,-64717.86 223.38,-64727.73 230.37,-64727.97"/>
</g>
<!-- layer16_attn_out_1 -->
<g id="node234" class="node">
<title>layer16_attn_out_1</title>
<path fill="#e6f3ff" stroke="black" d="M725,-64717.47C725,-64717.47 435,-64717.47 435,-64717.47 429,-64717.47 423,-64711.47 423,-64705.47 423,-64705.47 423,-64682.47 423,-64682.47 423,-64676.47 429,-64670.47 435,-64670.47 435,-64670.47 725,-64670.47 725,-64670.47 731,-64670.47 737,-64676.47 737,-64682.47 737,-64682.47 737,-64705.47 737,-64705.47 737,-64711.47 731,-64717.47 725,-64717.47"/>
<text text-anchor="middle" x="580" y="-64702.47" font-family="Arial" font-size="10.00">Layer 16 Attn Out GPU1</text>
<text text-anchor="middle" x="580" y="-64691.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="580" y="-64680.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer16_attn_1&#45;&gt;layer16_attn_out_1 -->
<g id="edge266" class="edge">
<title>layer16_attn_1&#45;&gt;layer16_attn_out_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M581.61,-64789.41C581.32,-64771.96 580.9,-64747.55 580.56,-64727.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="584.06,-64727.8 580.39,-64717.86 577.06,-64727.92 584.06,-64727.8"/>
</g>
<!-- layer16_attn_ar -->
<g id="node235" class="node">
<title>layer16_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M533.07,-64598.47C533.07,-64598.47 331.07,-64598.47 331.07,-64598.47 325.07,-64598.47 315.3,-64593.8 311.53,-64589.13 311.53,-64589.13 268.47,-64535.8 268.47,-64535.8 264.7,-64531.14 266.93,-64526.47 272.93,-64526.47 272.93,-64526.47 474.93,-64526.47 474.93,-64526.47 480.93,-64526.47 490.7,-64531.14 494.47,-64535.8 494.47,-64535.8 537.53,-64589.13 537.53,-64589.13 541.3,-64593.8 539.07,-64598.47 533.07,-64598.47"/>
<text text-anchor="middle" x="403" y="-64565.47" font-family="Arial" font-size="10.00">Layer 16 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="403" y="-64554.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer16_attn_out_0&#45;&gt;layer16_attn_ar -->
<g id="edge267" class="edge">
<title>layer16_attn_out_0&#45;&gt;layer16_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M258.48,-64670.41C282.92,-64652.33 317.86,-64626.47 347.27,-64604.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="349.45,-64607.45 355.4,-64598.69 345.28,-64601.82 349.45,-64607.45"/>
</g>
<!-- layer16_attn_out_1&#45;&gt;layer16_attn_ar -->
<g id="edge268" class="edge">
<title>layer16_attn_out_1&#45;&gt;layer16_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M549.17,-64670.41C524.45,-64652.33 489.11,-64626.47 459.37,-64604.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="461.28,-64601.77 451.14,-64598.69 457.14,-64607.42 461.28,-64601.77"/>
</g>
<!-- layer16_ffn1_0 -->
<g id="node236" class="node">
<title>layer16_ffn1_0</title>
<path fill="#e6f3ff" stroke="black" d="M373,-64454.47C373,-64454.47 103,-64454.47 103,-64454.47 97,-64454.47 91,-64448.47 91,-64442.47 91,-64442.47 91,-64419.47 91,-64419.47 91,-64413.47 97,-64407.47 103,-64407.47 103,-64407.47 373,-64407.47 373,-64407.47 379,-64407.47 385,-64413.47 385,-64419.47 385,-64419.47 385,-64442.47 385,-64442.47 385,-64448.47 379,-64454.47 373,-64454.47"/>
<text text-anchor="middle" x="238" y="-64439.47" font-family="Arial" font-size="10.00">Layer 16 FFN1 GPU0</text>
<text text-anchor="middle" x="238" y="-64428.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="238" y="-64417.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer16_attn_ar&#45;&gt;layer16_ffn1_0 -->
<g id="edge269" class="edge">
<title>layer16_attn_ar&#45;&gt;layer16_ffn1_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M358.35,-64526.42C332.28,-64505.96 299.78,-64480.45 275.12,-64461.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="277.11,-64458.21 267.08,-64454.79 272.79,-64463.72 277.11,-64458.21"/>
</g>
<!-- layer16_ffn1_1 -->
<g id="node237" class="node">
<title>layer16_ffn1_1</title>
<path fill="#e6f3ff" stroke="black" d="M703,-64454.47C703,-64454.47 433,-64454.47 433,-64454.47 427,-64454.47 421,-64448.47 421,-64442.47 421,-64442.47 421,-64419.47 421,-64419.47 421,-64413.47 427,-64407.47 433,-64407.47 433,-64407.47 703,-64407.47 703,-64407.47 709,-64407.47 715,-64413.47 715,-64419.47 715,-64419.47 715,-64442.47 715,-64442.47 715,-64448.47 709,-64454.47 703,-64454.47"/>
<text text-anchor="middle" x="568" y="-64439.47" font-family="Arial" font-size="10.00">Layer 16 FFN1 GPU1</text>
<text text-anchor="middle" x="568" y="-64428.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-64417.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer16_attn_ar&#45;&gt;layer16_ffn1_1 -->
<g id="edge270" class="edge">
<title>layer16_attn_ar&#45;&gt;layer16_ffn1_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M447.65,-64526.42C473.72,-64505.96 506.22,-64480.45 530.88,-64461.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="533.21,-64463.72 538.92,-64454.79 528.89,-64458.21 533.21,-64463.72"/>
</g>
<!-- layer16_act_0 -->
<g id="node238" class="node">
<title>layer16_act_0</title>
<path fill="#e6f3ff" stroke="black" d="M373,-64335.47C373,-64335.47 103,-64335.47 103,-64335.47 97,-64335.47 91,-64329.47 91,-64323.47 91,-64323.47 91,-64300.47 91,-64300.47 91,-64294.47 97,-64288.47 103,-64288.47 103,-64288.47 373,-64288.47 373,-64288.47 379,-64288.47 385,-64294.47 385,-64300.47 385,-64300.47 385,-64323.47 385,-64323.47 385,-64329.47 379,-64335.47 373,-64335.47"/>
<text text-anchor="middle" x="238" y="-64320.47" font-family="Arial" font-size="10.00">Layer 16 SiLU GPU0</text>
<text text-anchor="middle" x="238" y="-64309.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="238" y="-64298.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer16_ffn1_0&#45;&gt;layer16_act_0 -->
<g id="edge271" class="edge">
<title>layer16_ffn1_0&#45;&gt;layer16_act_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M238,-64407.41C238,-64389.96 238,-64365.55 238,-64345.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="241.5,-64345.86 238,-64335.86 234.5,-64345.86 241.5,-64345.86"/>
</g>
<!-- layer16_act_1 -->
<g id="node239" class="node">
<title>layer16_act_1</title>
<path fill="#e6f3ff" stroke="black" d="M703,-64335.47C703,-64335.47 433,-64335.47 433,-64335.47 427,-64335.47 421,-64329.47 421,-64323.47 421,-64323.47 421,-64300.47 421,-64300.47 421,-64294.47 427,-64288.47 433,-64288.47 433,-64288.47 703,-64288.47 703,-64288.47 709,-64288.47 715,-64294.47 715,-64300.47 715,-64300.47 715,-64323.47 715,-64323.47 715,-64329.47 709,-64335.47 703,-64335.47"/>
<text text-anchor="middle" x="568" y="-64320.47" font-family="Arial" font-size="10.00">Layer 16 SiLU GPU1</text>
<text text-anchor="middle" x="568" y="-64309.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="568" y="-64298.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer16_ffn1_1&#45;&gt;layer16_act_1 -->
<g id="edge272" class="edge">
<title>layer16_ffn1_1&#45;&gt;layer16_act_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M568,-64407.41C568,-64389.96 568,-64365.55 568,-64345.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="571.5,-64345.86 568,-64335.86 564.5,-64345.86 571.5,-64345.86"/>
</g>
<!-- layer16_ffn2_0 -->
<g id="node240" class="node">
<title>layer16_ffn2_0</title>
<path fill="#e6f3ff" stroke="black" d="M372.5,-64216.47C372.5,-64216.47 109.5,-64216.47 109.5,-64216.47 103.5,-64216.47 97.5,-64210.47 97.5,-64204.47 97.5,-64204.47 97.5,-64181.47 97.5,-64181.47 97.5,-64175.47 103.5,-64169.47 109.5,-64169.47 109.5,-64169.47 372.5,-64169.47 372.5,-64169.47 378.5,-64169.47 384.5,-64175.47 384.5,-64181.47 384.5,-64181.47 384.5,-64204.47 384.5,-64204.47 384.5,-64210.47 378.5,-64216.47 372.5,-64216.47"/>
<text text-anchor="middle" x="241" y="-64201.47" font-family="Arial" font-size="10.00">Layer 16 FFN2 GPU0</text>
<text text-anchor="middle" x="241" y="-64190.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="241" y="-64179.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer16_act_0&#45;&gt;layer16_ffn2_0 -->
<g id="edge273" class="edge">
<title>layer16_act_0&#45;&gt;layer16_ffn2_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M238.58,-64288.41C239.03,-64270.96 239.65,-64246.55 240.16,-64226.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="243.66,-64226.94 240.41,-64216.86 236.66,-64226.76 243.66,-64226.94"/>
</g>
<!-- layer16_ffn2_1 -->
<g id="node241" class="node">
<title>layer16_ffn2_1</title>
<path fill="#e6f3ff" stroke="black" d="M697.5,-64216.47C697.5,-64216.47 434.5,-64216.47 434.5,-64216.47 428.5,-64216.47 422.5,-64210.47 422.5,-64204.47 422.5,-64204.47 422.5,-64181.47 422.5,-64181.47 422.5,-64175.47 428.5,-64169.47 434.5,-64169.47 434.5,-64169.47 697.5,-64169.47 697.5,-64169.47 703.5,-64169.47 709.5,-64175.47 709.5,-64181.47 709.5,-64181.47 709.5,-64204.47 709.5,-64204.47 709.5,-64210.47 703.5,-64216.47 697.5,-64216.47"/>
<text text-anchor="middle" x="566" y="-64201.47" font-family="Arial" font-size="10.00">Layer 16 FFN2 GPU1</text>
<text text-anchor="middle" x="566" y="-64190.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="566" y="-64179.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer16_act_1&#45;&gt;layer16_ffn2_1 -->
<g id="edge274" class="edge">
<title>layer16_act_1&#45;&gt;layer16_ffn2_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M567.61,-64288.41C567.32,-64270.96 566.9,-64246.55 566.56,-64226.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="570.06,-64226.8 566.39,-64216.86 563.06,-64226.92 570.06,-64226.8"/>
</g>
<!-- layer16_ffn_ar -->
<g id="node242" class="node">
<title>layer16_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M534.22,-64097.47C534.22,-64097.47 328.8,-64097.47 328.8,-64097.47 322.8,-64097.47 313,-64092.83 309.19,-64088.19 309.19,-64088.19 265.39,-64034.75 265.39,-64034.75 261.59,-64030.11 263.78,-64025.47 269.78,-64025.47 269.78,-64025.47 475.2,-64025.47 475.2,-64025.47 481.2,-64025.47 491,-64030.11 494.81,-64034.75 494.81,-64034.75 538.61,-64088.19 538.61,-64088.19 542.41,-64092.83 540.22,-64097.47 534.22,-64097.47"/>
<text text-anchor="middle" x="402" y="-64064.47" font-family="Arial" font-size="10.00">Layer 16 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="402" y="-64053.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer16_ffn2_0&#45;&gt;layer16_ffn_ar -->
<g id="edge275" class="edge">
<title>layer16_ffn2_0&#45;&gt;layer16_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M269.04,-64169.41C291.43,-64151.41 323.4,-64125.69 350.38,-64103.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="352.61,-64106.68 358.21,-64097.69 348.23,-64101.23 352.61,-64106.68"/>
</g>
<!-- layer16_ffn2_1&#45;&gt;layer16_ffn_ar -->
<g id="edge276" class="edge">
<title>layer16_ffn2_1&#45;&gt;layer16_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M537.43,-64169.41C514.63,-64151.41 482.06,-64125.69 454.58,-64103.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="456.62,-64101.14 446.6,-64097.69 452.28,-64106.63 456.62,-64101.14"/>
</g>
<!-- layer17_qkv_0 -->
<g id="node243" class="node">
<title>layer17_qkv_0</title>
<path fill="#e6f3ff" stroke="black" d="M372,-63953.47C372,-63953.47 74,-63953.47 74,-63953.47 68,-63953.47 62,-63947.47 62,-63941.47 62,-63941.47 62,-63918.47 62,-63918.47 62,-63912.47 68,-63906.47 74,-63906.47 74,-63906.47 372,-63906.47 372,-63906.47 378,-63906.47 384,-63912.47 384,-63918.47 384,-63918.47 384,-63941.47 384,-63941.47 384,-63947.47 378,-63953.47 372,-63953.47"/>
<text text-anchor="middle" x="223" y="-63938.47" font-family="Arial" font-size="10.00">Layer 17 QKV Proj GPU0</text>
<text text-anchor="middle" x="223" y="-63927.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="223" y="-63916.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer16_ffn_ar&#45;&gt;layer17_qkv_0 -->
<g id="edge277" class="edge">
<title>layer16_ffn_ar&#45;&gt;layer17_qkv_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M353.56,-64025.42C325.06,-64004.81 289.48,-63979.06 262.66,-63959.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="264.43,-63956.62 254.28,-63953.6 260.33,-63962.3 264.43,-63956.62"/>
</g>
<!-- layer17_qkv_1 -->
<g id="node244" class="node">
<title>layer17_qkv_1</title>
<path fill="#e6f3ff" stroke="black" d="M730,-63953.47C730,-63953.47 432,-63953.47 432,-63953.47 426,-63953.47 420,-63947.47 420,-63941.47 420,-63941.47 420,-63918.47 420,-63918.47 420,-63912.47 426,-63906.47 432,-63906.47 432,-63906.47 730,-63906.47 730,-63906.47 736,-63906.47 742,-63912.47 742,-63918.47 742,-63918.47 742,-63941.47 742,-63941.47 742,-63947.47 736,-63953.47 730,-63953.47"/>
<text text-anchor="middle" x="581" y="-63938.47" font-family="Arial" font-size="10.00">Layer 17 QKV Proj GPU1</text>
<text text-anchor="middle" x="581" y="-63927.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="581" y="-63916.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer16_ffn_ar&#45;&gt;layer17_qkv_1 -->
<g id="edge278" class="edge">
<title>layer16_ffn_ar&#45;&gt;layer17_qkv_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M450.44,-64025.42C478.94,-64004.81 514.52,-63979.06 541.34,-63959.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="543.67,-63962.3 549.72,-63953.6 539.57,-63956.62 543.67,-63962.3"/>
</g>
<!-- layer17_attn_0 -->
<g id="node245" class="node">
<title>layer17_attn_0</title>
<path fill="#e6f3ff" stroke="black" d="M372,-63834.47C372,-63834.47 74,-63834.47 74,-63834.47 68,-63834.47 62,-63828.47 62,-63822.47 62,-63822.47 62,-63799.47 62,-63799.47 62,-63793.47 68,-63787.47 74,-63787.47 74,-63787.47 372,-63787.47 372,-63787.47 378,-63787.47 384,-63793.47 384,-63799.47 384,-63799.47 384,-63822.47 384,-63822.47 384,-63828.47 378,-63834.47 372,-63834.47"/>
<text text-anchor="middle" x="223" y="-63819.47" font-family="Arial" font-size="10.00">Layer 17 Attention GPU0</text>
<text text-anchor="middle" x="223" y="-63808.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="223" y="-63797.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer17_qkv_0&#45;&gt;layer17_attn_0 -->
<g id="edge279" class="edge">
<title>layer17_qkv_0&#45;&gt;layer17_attn_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M223,-63906.41C223,-63888.96 223,-63864.55 223,-63844.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="226.5,-63844.86 223,-63834.86 219.5,-63844.86 226.5,-63844.86"/>
</g>
<!-- layer17_attn_1 -->
<g id="node246" class="node">
<title>layer17_attn_1</title>
<path fill="#e6f3ff" stroke="black" d="M730,-63834.47C730,-63834.47 432,-63834.47 432,-63834.47 426,-63834.47 420,-63828.47 420,-63822.47 420,-63822.47 420,-63799.47 420,-63799.47 420,-63793.47 426,-63787.47 432,-63787.47 432,-63787.47 730,-63787.47 730,-63787.47 736,-63787.47 742,-63793.47 742,-63799.47 742,-63799.47 742,-63822.47 742,-63822.47 742,-63828.47 736,-63834.47 730,-63834.47"/>
<text text-anchor="middle" x="581" y="-63819.47" font-family="Arial" font-size="10.00">Layer 17 Attention GPU1</text>
<text text-anchor="middle" x="581" y="-63808.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="581" y="-63797.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer17_qkv_1&#45;&gt;layer17_attn_1 -->
<g id="edge280" class="edge">
<title>layer17_qkv_1&#45;&gt;layer17_attn_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M581,-63906.41C581,-63888.96 581,-63864.55 581,-63844.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="584.5,-63844.86 581,-63834.86 577.5,-63844.86 584.5,-63844.86"/>
</g>
<!-- layer17_attn_out_0 -->
<g id="node247" class="node">
<title>layer17_attn_out_0</title>
<path fill="#e6f3ff" stroke="black" d="M372,-63715.47C372,-63715.47 82,-63715.47 82,-63715.47 76,-63715.47 70,-63709.47 70,-63703.47 70,-63703.47 70,-63680.47 70,-63680.47 70,-63674.47 76,-63668.47 82,-63668.47 82,-63668.47 372,-63668.47 372,-63668.47 378,-63668.47 384,-63674.47 384,-63680.47 384,-63680.47 384,-63703.47 384,-63703.47 384,-63709.47 378,-63715.47 372,-63715.47"/>
<text text-anchor="middle" x="227" y="-63700.47" font-family="Arial" font-size="10.00">Layer 17 Attn Out GPU0</text>
<text text-anchor="middle" x="227" y="-63689.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="227" y="-63678.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer17_attn_0&#45;&gt;layer17_attn_out_0 -->
<g id="edge281" class="edge">
<title>layer17_attn_0&#45;&gt;layer17_attn_out_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M223.77,-63787.41C224.37,-63769.96 225.2,-63745.55 225.87,-63725.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="229.37,-63725.97 226.22,-63715.86 222.38,-63725.73 229.37,-63725.97"/>
</g>
<!-- layer17_attn_out_1 -->
<g id="node248" class="node">
<title>layer17_attn_out_1</title>
<path fill="#e6f3ff" stroke="black" d="M724,-63715.47C724,-63715.47 434,-63715.47 434,-63715.47 428,-63715.47 422,-63709.47 422,-63703.47 422,-63703.47 422,-63680.47 422,-63680.47 422,-63674.47 428,-63668.47 434,-63668.47 434,-63668.47 724,-63668.47 724,-63668.47 730,-63668.47 736,-63674.47 736,-63680.47 736,-63680.47 736,-63703.47 736,-63703.47 736,-63709.47 730,-63715.47 724,-63715.47"/>
<text text-anchor="middle" x="579" y="-63700.47" font-family="Arial" font-size="10.00">Layer 17 Attn Out GPU1</text>
<text text-anchor="middle" x="579" y="-63689.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="579" y="-63678.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer17_attn_1&#45;&gt;layer17_attn_out_1 -->
<g id="edge282" class="edge">
<title>layer17_attn_1&#45;&gt;layer17_attn_out_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M580.61,-63787.41C580.32,-63769.96 579.9,-63745.55 579.56,-63725.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="583.06,-63725.8 579.39,-63715.86 576.06,-63725.92 583.06,-63725.8"/>
</g>
<!-- layer17_attn_ar -->
<g id="node249" class="node">
<title>layer17_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M532.07,-63596.47C532.07,-63596.47 330.07,-63596.47 330.07,-63596.47 324.07,-63596.47 314.3,-63591.8 310.53,-63587.13 310.53,-63587.13 267.47,-63533.8 267.47,-63533.8 263.7,-63529.14 265.93,-63524.47 271.93,-63524.47 271.93,-63524.47 473.93,-63524.47 473.93,-63524.47 479.93,-63524.47 489.7,-63529.14 493.47,-63533.8 493.47,-63533.8 536.53,-63587.13 536.53,-63587.13 540.3,-63591.8 538.07,-63596.47 532.07,-63596.47"/>
<text text-anchor="middle" x="402" y="-63563.47" font-family="Arial" font-size="10.00">Layer 17 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="402" y="-63552.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer17_attn_out_0&#45;&gt;layer17_attn_ar -->
<g id="edge283" class="edge">
<title>layer17_attn_out_0&#45;&gt;layer17_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M257.48,-63668.41C281.92,-63650.33 316.86,-63624.47 346.27,-63602.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="348.45,-63605.45 354.4,-63596.69 344.28,-63599.82 348.45,-63605.45"/>
</g>
<!-- layer17_attn_out_1&#45;&gt;layer17_attn_ar -->
<g id="edge284" class="edge">
<title>layer17_attn_out_1&#45;&gt;layer17_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M548.17,-63668.41C523.45,-63650.33 488.11,-63624.47 458.37,-63602.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="460.28,-63599.77 450.14,-63596.69 456.14,-63605.42 460.28,-63599.77"/>
</g>
<!-- layer17_ffn1_0 -->
<g id="node250" class="node">
<title>layer17_ffn1_0</title>
<path fill="#e6f3ff" stroke="black" d="M372,-63452.47C372,-63452.47 102,-63452.47 102,-63452.47 96,-63452.47 90,-63446.47 90,-63440.47 90,-63440.47 90,-63417.47 90,-63417.47 90,-63411.47 96,-63405.47 102,-63405.47 102,-63405.47 372,-63405.47 372,-63405.47 378,-63405.47 384,-63411.47 384,-63417.47 384,-63417.47 384,-63440.47 384,-63440.47 384,-63446.47 378,-63452.47 372,-63452.47"/>
<text text-anchor="middle" x="237" y="-63437.47" font-family="Arial" font-size="10.00">Layer 17 FFN1 GPU0</text>
<text text-anchor="middle" x="237" y="-63426.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="237" y="-63415.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer17_attn_ar&#45;&gt;layer17_ffn1_0 -->
<g id="edge285" class="edge">
<title>layer17_attn_ar&#45;&gt;layer17_ffn1_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M357.35,-63524.42C331.28,-63503.96 298.78,-63478.45 274.12,-63459.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="276.11,-63456.21 266.08,-63452.79 271.79,-63461.72 276.11,-63456.21"/>
</g>
<!-- layer17_ffn1_1 -->
<g id="node251" class="node">
<title>layer17_ffn1_1</title>
<path fill="#e6f3ff" stroke="black" d="M702,-63452.47C702,-63452.47 432,-63452.47 432,-63452.47 426,-63452.47 420,-63446.47 420,-63440.47 420,-63440.47 420,-63417.47 420,-63417.47 420,-63411.47 426,-63405.47 432,-63405.47 432,-63405.47 702,-63405.47 702,-63405.47 708,-63405.47 714,-63411.47 714,-63417.47 714,-63417.47 714,-63440.47 714,-63440.47 714,-63446.47 708,-63452.47 702,-63452.47"/>
<text text-anchor="middle" x="567" y="-63437.47" font-family="Arial" font-size="10.00">Layer 17 FFN1 GPU1</text>
<text text-anchor="middle" x="567" y="-63426.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="567" y="-63415.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer17_attn_ar&#45;&gt;layer17_ffn1_1 -->
<g id="edge286" class="edge">
<title>layer17_attn_ar&#45;&gt;layer17_ffn1_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M446.65,-63524.42C472.72,-63503.96 505.22,-63478.45 529.88,-63459.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="532.21,-63461.72 537.92,-63452.79 527.89,-63456.21 532.21,-63461.72"/>
</g>
<!-- layer17_act_0 -->
<g id="node252" class="node">
<title>layer17_act_0</title>
<path fill="#e6f3ff" stroke="black" d="M372,-63333.47C372,-63333.47 102,-63333.47 102,-63333.47 96,-63333.47 90,-63327.47 90,-63321.47 90,-63321.47 90,-63298.47 90,-63298.47 90,-63292.47 96,-63286.47 102,-63286.47 102,-63286.47 372,-63286.47 372,-63286.47 378,-63286.47 384,-63292.47 384,-63298.47 384,-63298.47 384,-63321.47 384,-63321.47 384,-63327.47 378,-63333.47 372,-63333.47"/>
<text text-anchor="middle" x="237" y="-63318.47" font-family="Arial" font-size="10.00">Layer 17 SiLU GPU0</text>
<text text-anchor="middle" x="237" y="-63307.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="237" y="-63296.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer17_ffn1_0&#45;&gt;layer17_act_0 -->
<g id="edge287" class="edge">
<title>layer17_ffn1_0&#45;&gt;layer17_act_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M237,-63405.41C237,-63387.96 237,-63363.55 237,-63343.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="240.5,-63343.86 237,-63333.86 233.5,-63343.86 240.5,-63343.86"/>
</g>
<!-- layer17_act_1 -->
<g id="node253" class="node">
<title>layer17_act_1</title>
<path fill="#e6f3ff" stroke="black" d="M702,-63333.47C702,-63333.47 432,-63333.47 432,-63333.47 426,-63333.47 420,-63327.47 420,-63321.47 420,-63321.47 420,-63298.47 420,-63298.47 420,-63292.47 426,-63286.47 432,-63286.47 432,-63286.47 702,-63286.47 702,-63286.47 708,-63286.47 714,-63292.47 714,-63298.47 714,-63298.47 714,-63321.47 714,-63321.47 714,-63327.47 708,-63333.47 702,-63333.47"/>
<text text-anchor="middle" x="567" y="-63318.47" font-family="Arial" font-size="10.00">Layer 17 SiLU GPU1</text>
<text text-anchor="middle" x="567" y="-63307.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="567" y="-63296.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer17_ffn1_1&#45;&gt;layer17_act_1 -->
<g id="edge288" class="edge">
<title>layer17_ffn1_1&#45;&gt;layer17_act_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M567,-63405.41C567,-63387.96 567,-63363.55 567,-63343.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="570.5,-63343.86 567,-63333.86 563.5,-63343.86 570.5,-63343.86"/>
</g>
<!-- layer17_ffn2_0 -->
<g id="node254" class="node">
<title>layer17_ffn2_0</title>
<path fill="#e6f3ff" stroke="black" d="M371.5,-63214.47C371.5,-63214.47 108.5,-63214.47 108.5,-63214.47 102.5,-63214.47 96.5,-63208.47 96.5,-63202.47 96.5,-63202.47 96.5,-63179.47 96.5,-63179.47 96.5,-63173.47 102.5,-63167.47 108.5,-63167.47 108.5,-63167.47 371.5,-63167.47 371.5,-63167.47 377.5,-63167.47 383.5,-63173.47 383.5,-63179.47 383.5,-63179.47 383.5,-63202.47 383.5,-63202.47 383.5,-63208.47 377.5,-63214.47 371.5,-63214.47"/>
<text text-anchor="middle" x="240" y="-63199.47" font-family="Arial" font-size="10.00">Layer 17 FFN2 GPU0</text>
<text text-anchor="middle" x="240" y="-63188.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="240" y="-63177.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer17_act_0&#45;&gt;layer17_ffn2_0 -->
<g id="edge289" class="edge">
<title>layer17_act_0&#45;&gt;layer17_ffn2_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M237.58,-63286.41C238.03,-63268.96 238.65,-63244.55 239.16,-63224.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="242.66,-63224.94 239.41,-63214.86 235.66,-63224.76 242.66,-63224.94"/>
</g>
<!-- layer17_ffn2_1 -->
<g id="node255" class="node">
<title>layer17_ffn2_1</title>
<path fill="#e6f3ff" stroke="black" d="M696.5,-63214.47C696.5,-63214.47 433.5,-63214.47 433.5,-63214.47 427.5,-63214.47 421.5,-63208.47 421.5,-63202.47 421.5,-63202.47 421.5,-63179.47 421.5,-63179.47 421.5,-63173.47 427.5,-63167.47 433.5,-63167.47 433.5,-63167.47 696.5,-63167.47 696.5,-63167.47 702.5,-63167.47 708.5,-63173.47 708.5,-63179.47 708.5,-63179.47 708.5,-63202.47 708.5,-63202.47 708.5,-63208.47 702.5,-63214.47 696.5,-63214.47"/>
<text text-anchor="middle" x="565" y="-63199.47" font-family="Arial" font-size="10.00">Layer 17 FFN2 GPU1</text>
<text text-anchor="middle" x="565" y="-63188.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="565" y="-63177.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer17_act_1&#45;&gt;layer17_ffn2_1 -->
<g id="edge290" class="edge">
<title>layer17_act_1&#45;&gt;layer17_ffn2_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M566.61,-63286.41C566.32,-63268.96 565.9,-63244.55 565.56,-63224.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="569.06,-63224.8 565.39,-63214.86 562.06,-63224.92 569.06,-63224.8"/>
</g>
<!-- layer17_ffn_ar -->
<g id="node256" class="node">
<title>layer17_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M533.22,-63095.47C533.22,-63095.47 327.8,-63095.47 327.8,-63095.47 321.8,-63095.47 312,-63090.83 308.19,-63086.19 308.19,-63086.19 264.39,-63032.75 264.39,-63032.75 260.59,-63028.11 262.78,-63023.47 268.78,-63023.47 268.78,-63023.47 474.2,-63023.47 474.2,-63023.47 480.2,-63023.47 490,-63028.11 493.81,-63032.75 493.81,-63032.75 537.61,-63086.19 537.61,-63086.19 541.41,-63090.83 539.22,-63095.47 533.22,-63095.47"/>
<text text-anchor="middle" x="401" y="-63062.47" font-family="Arial" font-size="10.00">Layer 17 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="401" y="-63051.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer17_ffn2_0&#45;&gt;layer17_ffn_ar -->
<g id="edge291" class="edge">
<title>layer17_ffn2_0&#45;&gt;layer17_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M268.04,-63167.41C290.43,-63149.41 322.4,-63123.69 349.38,-63101.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="351.61,-63104.68 357.21,-63095.69 347.23,-63099.23 351.61,-63104.68"/>
</g>
<!-- layer17_ffn2_1&#45;&gt;layer17_ffn_ar -->
<g id="edge292" class="edge">
<title>layer17_ffn2_1&#45;&gt;layer17_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M536.43,-63167.41C513.63,-63149.41 481.06,-63123.69 453.58,-63101.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="455.62,-63099.14 445.6,-63095.69 451.28,-63104.63 455.62,-63099.14"/>
</g>
<!-- layer18_qkv_0 -->
<g id="node257" class="node">
<title>layer18_qkv_0</title>
<path fill="#e6f3ff" stroke="black" d="M371,-62951.47C371,-62951.47 73,-62951.47 73,-62951.47 67,-62951.47 61,-62945.47 61,-62939.47 61,-62939.47 61,-62916.47 61,-62916.47 61,-62910.47 67,-62904.47 73,-62904.47 73,-62904.47 371,-62904.47 371,-62904.47 377,-62904.47 383,-62910.47 383,-62916.47 383,-62916.47 383,-62939.47 383,-62939.47 383,-62945.47 377,-62951.47 371,-62951.47"/>
<text text-anchor="middle" x="222" y="-62936.47" font-family="Arial" font-size="10.00">Layer 18 QKV Proj GPU0</text>
<text text-anchor="middle" x="222" y="-62925.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="222" y="-62914.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer17_ffn_ar&#45;&gt;layer18_qkv_0 -->
<g id="edge293" class="edge">
<title>layer17_ffn_ar&#45;&gt;layer18_qkv_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M352.56,-63023.42C324.06,-63002.81 288.48,-62977.06 261.66,-62957.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="263.43,-62954.62 253.28,-62951.6 259.33,-62960.3 263.43,-62954.62"/>
</g>
<!-- layer18_qkv_1 -->
<g id="node258" class="node">
<title>layer18_qkv_1</title>
<path fill="#e6f3ff" stroke="black" d="M729,-62951.47C729,-62951.47 431,-62951.47 431,-62951.47 425,-62951.47 419,-62945.47 419,-62939.47 419,-62939.47 419,-62916.47 419,-62916.47 419,-62910.47 425,-62904.47 431,-62904.47 431,-62904.47 729,-62904.47 729,-62904.47 735,-62904.47 741,-62910.47 741,-62916.47 741,-62916.47 741,-62939.47 741,-62939.47 741,-62945.47 735,-62951.47 729,-62951.47"/>
<text text-anchor="middle" x="580" y="-62936.47" font-family="Arial" font-size="10.00">Layer 18 QKV Proj GPU1</text>
<text text-anchor="middle" x="580" y="-62925.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="580" y="-62914.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer17_ffn_ar&#45;&gt;layer18_qkv_1 -->
<g id="edge294" class="edge">
<title>layer17_ffn_ar&#45;&gt;layer18_qkv_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M449.44,-63023.42C477.94,-63002.81 513.52,-62977.06 540.34,-62957.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="542.67,-62960.3 548.72,-62951.6 538.57,-62954.62 542.67,-62960.3"/>
</g>
<!-- layer18_attn_0 -->
<g id="node259" class="node">
<title>layer18_attn_0</title>
<path fill="#e6f3ff" stroke="black" d="M371,-62832.47C371,-62832.47 73,-62832.47 73,-62832.47 67,-62832.47 61,-62826.47 61,-62820.47 61,-62820.47 61,-62797.47 61,-62797.47 61,-62791.47 67,-62785.47 73,-62785.47 73,-62785.47 371,-62785.47 371,-62785.47 377,-62785.47 383,-62791.47 383,-62797.47 383,-62797.47 383,-62820.47 383,-62820.47 383,-62826.47 377,-62832.47 371,-62832.47"/>
<text text-anchor="middle" x="222" y="-62817.47" font-family="Arial" font-size="10.00">Layer 18 Attention GPU0</text>
<text text-anchor="middle" x="222" y="-62806.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="222" y="-62795.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer18_qkv_0&#45;&gt;layer18_attn_0 -->
<g id="edge295" class="edge">
<title>layer18_qkv_0&#45;&gt;layer18_attn_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M222,-62904.41C222,-62886.96 222,-62862.55 222,-62842.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="225.5,-62842.86 222,-62832.86 218.5,-62842.86 225.5,-62842.86"/>
</g>
<!-- layer18_attn_1 -->
<g id="node260" class="node">
<title>layer18_attn_1</title>
<path fill="#e6f3ff" stroke="black" d="M729,-62832.47C729,-62832.47 431,-62832.47 431,-62832.47 425,-62832.47 419,-62826.47 419,-62820.47 419,-62820.47 419,-62797.47 419,-62797.47 419,-62791.47 425,-62785.47 431,-62785.47 431,-62785.47 729,-62785.47 729,-62785.47 735,-62785.47 741,-62791.47 741,-62797.47 741,-62797.47 741,-62820.47 741,-62820.47 741,-62826.47 735,-62832.47 729,-62832.47"/>
<text text-anchor="middle" x="580" y="-62817.47" font-family="Arial" font-size="10.00">Layer 18 Attention GPU1</text>
<text text-anchor="middle" x="580" y="-62806.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="580" y="-62795.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer18_qkv_1&#45;&gt;layer18_attn_1 -->
<g id="edge296" class="edge">
<title>layer18_qkv_1&#45;&gt;layer18_attn_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M580,-62904.41C580,-62886.96 580,-62862.55 580,-62842.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="583.5,-62842.86 580,-62832.86 576.5,-62842.86 583.5,-62842.86"/>
</g>
<!-- layer18_attn_out_0 -->
<g id="node261" class="node">
<title>layer18_attn_out_0</title>
<path fill="#e6f3ff" stroke="black" d="M371,-62713.47C371,-62713.47 81,-62713.47 81,-62713.47 75,-62713.47 69,-62707.47 69,-62701.47 69,-62701.47 69,-62678.47 69,-62678.47 69,-62672.47 75,-62666.47 81,-62666.47 81,-62666.47 371,-62666.47 371,-62666.47 377,-62666.47 383,-62672.47 383,-62678.47 383,-62678.47 383,-62701.47 383,-62701.47 383,-62707.47 377,-62713.47 371,-62713.47"/>
<text text-anchor="middle" x="226" y="-62698.47" font-family="Arial" font-size="10.00">Layer 18 Attn Out GPU0</text>
<text text-anchor="middle" x="226" y="-62687.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="226" y="-62676.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer18_attn_0&#45;&gt;layer18_attn_out_0 -->
<g id="edge297" class="edge">
<title>layer18_attn_0&#45;&gt;layer18_attn_out_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M222.77,-62785.41C223.37,-62767.96 224.2,-62743.55 224.87,-62723.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="228.37,-62723.97 225.22,-62713.86 221.38,-62723.73 228.37,-62723.97"/>
</g>
<!-- layer18_attn_out_1 -->
<g id="node262" class="node">
<title>layer18_attn_out_1</title>
<path fill="#e6f3ff" stroke="black" d="M723,-62713.47C723,-62713.47 433,-62713.47 433,-62713.47 427,-62713.47 421,-62707.47 421,-62701.47 421,-62701.47 421,-62678.47 421,-62678.47 421,-62672.47 427,-62666.47 433,-62666.47 433,-62666.47 723,-62666.47 723,-62666.47 729,-62666.47 735,-62672.47 735,-62678.47 735,-62678.47 735,-62701.47 735,-62701.47 735,-62707.47 729,-62713.47 723,-62713.47"/>
<text text-anchor="middle" x="578" y="-62698.47" font-family="Arial" font-size="10.00">Layer 18 Attn Out GPU1</text>
<text text-anchor="middle" x="578" y="-62687.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="578" y="-62676.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer18_attn_1&#45;&gt;layer18_attn_out_1 -->
<g id="edge298" class="edge">
<title>layer18_attn_1&#45;&gt;layer18_attn_out_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M579.61,-62785.41C579.32,-62767.96 578.9,-62743.55 578.56,-62723.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="582.06,-62723.8 578.39,-62713.86 575.06,-62723.92 582.06,-62723.8"/>
</g>
<!-- layer18_attn_ar -->
<g id="node263" class="node">
<title>layer18_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M531.07,-62594.47C531.07,-62594.47 329.07,-62594.47 329.07,-62594.47 323.07,-62594.47 313.3,-62589.8 309.53,-62585.13 309.53,-62585.13 266.47,-62531.8 266.47,-62531.8 262.7,-62527.14 264.93,-62522.47 270.93,-62522.47 270.93,-62522.47 472.93,-62522.47 472.93,-62522.47 478.93,-62522.47 488.7,-62527.14 492.47,-62531.8 492.47,-62531.8 535.53,-62585.13 535.53,-62585.13 539.3,-62589.8 537.07,-62594.47 531.07,-62594.47"/>
<text text-anchor="middle" x="401" y="-62561.47" font-family="Arial" font-size="10.00">Layer 18 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="401" y="-62550.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer18_attn_out_0&#45;&gt;layer18_attn_ar -->
<g id="edge299" class="edge">
<title>layer18_attn_out_0&#45;&gt;layer18_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M256.48,-62666.41C280.92,-62648.33 315.86,-62622.47 345.27,-62600.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="347.45,-62603.45 353.4,-62594.69 343.28,-62597.82 347.45,-62603.45"/>
</g>
<!-- layer18_attn_out_1&#45;&gt;layer18_attn_ar -->
<g id="edge300" class="edge">
<title>layer18_attn_out_1&#45;&gt;layer18_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M547.17,-62666.41C522.45,-62648.33 487.11,-62622.47 457.37,-62600.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="459.28,-62597.77 449.14,-62594.69 455.14,-62603.42 459.28,-62597.77"/>
</g>
<!-- layer18_ffn1_0 -->
<g id="node264" class="node">
<title>layer18_ffn1_0</title>
<path fill="#e6f3ff" stroke="black" d="M371,-62450.47C371,-62450.47 101,-62450.47 101,-62450.47 95,-62450.47 89,-62444.47 89,-62438.47 89,-62438.47 89,-62415.47 89,-62415.47 89,-62409.47 95,-62403.47 101,-62403.47 101,-62403.47 371,-62403.47 371,-62403.47 377,-62403.47 383,-62409.47 383,-62415.47 383,-62415.47 383,-62438.47 383,-62438.47 383,-62444.47 377,-62450.47 371,-62450.47"/>
<text text-anchor="middle" x="236" y="-62435.47" font-family="Arial" font-size="10.00">Layer 18 FFN1 GPU0</text>
<text text-anchor="middle" x="236" y="-62424.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="236" y="-62413.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer18_attn_ar&#45;&gt;layer18_ffn1_0 -->
<g id="edge301" class="edge">
<title>layer18_attn_ar&#45;&gt;layer18_ffn1_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M356.35,-62522.42C330.28,-62501.96 297.78,-62476.45 273.12,-62457.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="275.11,-62454.21 265.08,-62450.79 270.79,-62459.72 275.11,-62454.21"/>
</g>
<!-- layer18_ffn1_1 -->
<g id="node265" class="node">
<title>layer18_ffn1_1</title>
<path fill="#e6f3ff" stroke="black" d="M701,-62450.47C701,-62450.47 431,-62450.47 431,-62450.47 425,-62450.47 419,-62444.47 419,-62438.47 419,-62438.47 419,-62415.47 419,-62415.47 419,-62409.47 425,-62403.47 431,-62403.47 431,-62403.47 701,-62403.47 701,-62403.47 707,-62403.47 713,-62409.47 713,-62415.47 713,-62415.47 713,-62438.47 713,-62438.47 713,-62444.47 707,-62450.47 701,-62450.47"/>
<text text-anchor="middle" x="566" y="-62435.47" font-family="Arial" font-size="10.00">Layer 18 FFN1 GPU1</text>
<text text-anchor="middle" x="566" y="-62424.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="566" y="-62413.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer18_attn_ar&#45;&gt;layer18_ffn1_1 -->
<g id="edge302" class="edge">
<title>layer18_attn_ar&#45;&gt;layer18_ffn1_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M445.65,-62522.42C471.72,-62501.96 504.22,-62476.45 528.88,-62457.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="531.21,-62459.72 536.92,-62450.79 526.89,-62454.21 531.21,-62459.72"/>
</g>
<!-- layer18_act_0 -->
<g id="node266" class="node">
<title>layer18_act_0</title>
<path fill="#e6f3ff" stroke="black" d="M371,-62331.47C371,-62331.47 101,-62331.47 101,-62331.47 95,-62331.47 89,-62325.47 89,-62319.47 89,-62319.47 89,-62296.47 89,-62296.47 89,-62290.47 95,-62284.47 101,-62284.47 101,-62284.47 371,-62284.47 371,-62284.47 377,-62284.47 383,-62290.47 383,-62296.47 383,-62296.47 383,-62319.47 383,-62319.47 383,-62325.47 377,-62331.47 371,-62331.47"/>
<text text-anchor="middle" x="236" y="-62316.47" font-family="Arial" font-size="10.00">Layer 18 SiLU GPU0</text>
<text text-anchor="middle" x="236" y="-62305.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="236" y="-62294.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer18_ffn1_0&#45;&gt;layer18_act_0 -->
<g id="edge303" class="edge">
<title>layer18_ffn1_0&#45;&gt;layer18_act_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M236,-62403.41C236,-62385.96 236,-62361.55 236,-62341.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="239.5,-62341.86 236,-62331.86 232.5,-62341.86 239.5,-62341.86"/>
</g>
<!-- layer18_act_1 -->
<g id="node267" class="node">
<title>layer18_act_1</title>
<path fill="#e6f3ff" stroke="black" d="M701,-62331.47C701,-62331.47 431,-62331.47 431,-62331.47 425,-62331.47 419,-62325.47 419,-62319.47 419,-62319.47 419,-62296.47 419,-62296.47 419,-62290.47 425,-62284.47 431,-62284.47 431,-62284.47 701,-62284.47 701,-62284.47 707,-62284.47 713,-62290.47 713,-62296.47 713,-62296.47 713,-62319.47 713,-62319.47 713,-62325.47 707,-62331.47 701,-62331.47"/>
<text text-anchor="middle" x="566" y="-62316.47" font-family="Arial" font-size="10.00">Layer 18 SiLU GPU1</text>
<text text-anchor="middle" x="566" y="-62305.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="566" y="-62294.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer18_ffn1_1&#45;&gt;layer18_act_1 -->
<g id="edge304" class="edge">
<title>layer18_ffn1_1&#45;&gt;layer18_act_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M566,-62403.41C566,-62385.96 566,-62361.55 566,-62341.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="569.5,-62341.86 566,-62331.86 562.5,-62341.86 569.5,-62341.86"/>
</g>
<!-- layer18_ffn2_0 -->
<g id="node268" class="node">
<title>layer18_ffn2_0</title>
<path fill="#e6f3ff" stroke="black" d="M370.5,-62212.47C370.5,-62212.47 107.5,-62212.47 107.5,-62212.47 101.5,-62212.47 95.5,-62206.47 95.5,-62200.47 95.5,-62200.47 95.5,-62177.47 95.5,-62177.47 95.5,-62171.47 101.5,-62165.47 107.5,-62165.47 107.5,-62165.47 370.5,-62165.47 370.5,-62165.47 376.5,-62165.47 382.5,-62171.47 382.5,-62177.47 382.5,-62177.47 382.5,-62200.47 382.5,-62200.47 382.5,-62206.47 376.5,-62212.47 370.5,-62212.47"/>
<text text-anchor="middle" x="239" y="-62197.47" font-family="Arial" font-size="10.00">Layer 18 FFN2 GPU0</text>
<text text-anchor="middle" x="239" y="-62186.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="239" y="-62175.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer18_act_0&#45;&gt;layer18_ffn2_0 -->
<g id="edge305" class="edge">
<title>layer18_act_0&#45;&gt;layer18_ffn2_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M236.58,-62284.41C237.03,-62266.96 237.65,-62242.55 238.16,-62222.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="241.66,-62222.94 238.41,-62212.86 234.66,-62222.76 241.66,-62222.94"/>
</g>
<!-- layer18_ffn2_1 -->
<g id="node269" class="node">
<title>layer18_ffn2_1</title>
<path fill="#e6f3ff" stroke="black" d="M695.5,-62212.47C695.5,-62212.47 432.5,-62212.47 432.5,-62212.47 426.5,-62212.47 420.5,-62206.47 420.5,-62200.47 420.5,-62200.47 420.5,-62177.47 420.5,-62177.47 420.5,-62171.47 426.5,-62165.47 432.5,-62165.47 432.5,-62165.47 695.5,-62165.47 695.5,-62165.47 701.5,-62165.47 707.5,-62171.47 707.5,-62177.47 707.5,-62177.47 707.5,-62200.47 707.5,-62200.47 707.5,-62206.47 701.5,-62212.47 695.5,-62212.47"/>
<text text-anchor="middle" x="564" y="-62197.47" font-family="Arial" font-size="10.00">Layer 18 FFN2 GPU1</text>
<text text-anchor="middle" x="564" y="-62186.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="564" y="-62175.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer18_act_1&#45;&gt;layer18_ffn2_1 -->
<g id="edge306" class="edge">
<title>layer18_act_1&#45;&gt;layer18_ffn2_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M565.61,-62284.41C565.32,-62266.96 564.9,-62242.55 564.56,-62222.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="568.06,-62222.8 564.39,-62212.86 561.06,-62222.92 568.06,-62222.8"/>
</g>
<!-- layer18_ffn_ar -->
<g id="node270" class="node">
<title>layer18_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M532.22,-62093.47C532.22,-62093.47 326.8,-62093.47 326.8,-62093.47 320.8,-62093.47 311,-62088.83 307.19,-62084.19 307.19,-62084.19 263.39,-62030.75 263.39,-62030.75 259.59,-62026.11 261.78,-62021.47 267.78,-62021.47 267.78,-62021.47 473.2,-62021.47 473.2,-62021.47 479.2,-62021.47 489,-62026.11 492.81,-62030.75 492.81,-62030.75 536.61,-62084.19 536.61,-62084.19 540.41,-62088.83 538.22,-62093.47 532.22,-62093.47"/>
<text text-anchor="middle" x="400" y="-62060.47" font-family="Arial" font-size="10.00">Layer 18 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="400" y="-62049.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer18_ffn2_0&#45;&gt;layer18_ffn_ar -->
<g id="edge307" class="edge">
<title>layer18_ffn2_0&#45;&gt;layer18_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M267.04,-62165.41C289.43,-62147.41 321.4,-62121.69 348.38,-62099.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="350.61,-62102.68 356.21,-62093.69 346.23,-62097.23 350.61,-62102.68"/>
</g>
<!-- layer18_ffn2_1&#45;&gt;layer18_ffn_ar -->
<g id="edge308" class="edge">
<title>layer18_ffn2_1&#45;&gt;layer18_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M535.43,-62165.41C512.63,-62147.41 480.06,-62121.69 452.58,-62099.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="454.62,-62097.14 444.6,-62093.69 450.28,-62102.63 454.62,-62097.14"/>
</g>
<!-- layer19_qkv_0 -->
<g id="node271" class="node">
<title>layer19_qkv_0</title>
<path fill="#e6f3ff" stroke="black" d="M370,-61949.47C370,-61949.47 72,-61949.47 72,-61949.47 66,-61949.47 60,-61943.47 60,-61937.47 60,-61937.47 60,-61914.47 60,-61914.47 60,-61908.47 66,-61902.47 72,-61902.47 72,-61902.47 370,-61902.47 370,-61902.47 376,-61902.47 382,-61908.47 382,-61914.47 382,-61914.47 382,-61937.47 382,-61937.47 382,-61943.47 376,-61949.47 370,-61949.47"/>
<text text-anchor="middle" x="221" y="-61934.47" font-family="Arial" font-size="10.00">Layer 19 QKV Proj GPU0</text>
<text text-anchor="middle" x="221" y="-61923.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="221" y="-61912.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer18_ffn_ar&#45;&gt;layer19_qkv_0 -->
<g id="edge309" class="edge">
<title>layer18_ffn_ar&#45;&gt;layer19_qkv_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M351.56,-62021.42C323.06,-62000.81 287.48,-61975.06 260.66,-61955.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="262.43,-61952.62 252.28,-61949.6 258.33,-61958.3 262.43,-61952.62"/>
</g>
<!-- layer19_qkv_1 -->
<g id="node272" class="node">
<title>layer19_qkv_1</title>
<path fill="#e6f3ff" stroke="black" d="M728,-61949.47C728,-61949.47 430,-61949.47 430,-61949.47 424,-61949.47 418,-61943.47 418,-61937.47 418,-61937.47 418,-61914.47 418,-61914.47 418,-61908.47 424,-61902.47 430,-61902.47 430,-61902.47 728,-61902.47 728,-61902.47 734,-61902.47 740,-61908.47 740,-61914.47 740,-61914.47 740,-61937.47 740,-61937.47 740,-61943.47 734,-61949.47 728,-61949.47"/>
<text text-anchor="middle" x="579" y="-61934.47" font-family="Arial" font-size="10.00">Layer 19 QKV Proj GPU1</text>
<text text-anchor="middle" x="579" y="-61923.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="579" y="-61912.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer18_ffn_ar&#45;&gt;layer19_qkv_1 -->
<g id="edge310" class="edge">
<title>layer18_ffn_ar&#45;&gt;layer19_qkv_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M448.44,-62021.42C476.94,-62000.81 512.52,-61975.06 539.34,-61955.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="541.67,-61958.3 547.72,-61949.6 537.57,-61952.62 541.67,-61958.3"/>
</g>
<!-- layer19_attn_0 -->
<g id="node273" class="node">
<title>layer19_attn_0</title>
<path fill="#e6f3ff" stroke="black" d="M370,-61830.47C370,-61830.47 72,-61830.47 72,-61830.47 66,-61830.47 60,-61824.47 60,-61818.47 60,-61818.47 60,-61795.47 60,-61795.47 60,-61789.47 66,-61783.47 72,-61783.47 72,-61783.47 370,-61783.47 370,-61783.47 376,-61783.47 382,-61789.47 382,-61795.47 382,-61795.47 382,-61818.47 382,-61818.47 382,-61824.47 376,-61830.47 370,-61830.47"/>
<text text-anchor="middle" x="221" y="-61815.47" font-family="Arial" font-size="10.00">Layer 19 Attention GPU0</text>
<text text-anchor="middle" x="221" y="-61804.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="221" y="-61793.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer19_qkv_0&#45;&gt;layer19_attn_0 -->
<g id="edge311" class="edge">
<title>layer19_qkv_0&#45;&gt;layer19_attn_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M221,-61902.41C221,-61884.96 221,-61860.55 221,-61840.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="224.5,-61840.86 221,-61830.86 217.5,-61840.86 224.5,-61840.86"/>
</g>
<!-- layer19_attn_1 -->
<g id="node274" class="node">
<title>layer19_attn_1</title>
<path fill="#e6f3ff" stroke="black" d="M728,-61830.47C728,-61830.47 430,-61830.47 430,-61830.47 424,-61830.47 418,-61824.47 418,-61818.47 418,-61818.47 418,-61795.47 418,-61795.47 418,-61789.47 424,-61783.47 430,-61783.47 430,-61783.47 728,-61783.47 728,-61783.47 734,-61783.47 740,-61789.47 740,-61795.47 740,-61795.47 740,-61818.47 740,-61818.47 740,-61824.47 734,-61830.47 728,-61830.47"/>
<text text-anchor="middle" x="579" y="-61815.47" font-family="Arial" font-size="10.00">Layer 19 Attention GPU1</text>
<text text-anchor="middle" x="579" y="-61804.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="579" y="-61793.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer19_qkv_1&#45;&gt;layer19_attn_1 -->
<g id="edge312" class="edge">
<title>layer19_qkv_1&#45;&gt;layer19_attn_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M579,-61902.41C579,-61884.96 579,-61860.55 579,-61840.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="582.5,-61840.86 579,-61830.86 575.5,-61840.86 582.5,-61840.86"/>
</g>
<!-- layer19_attn_out_0 -->
<g id="node275" class="node">
<title>layer19_attn_out_0</title>
<path fill="#e6f3ff" stroke="black" d="M370,-61711.47C370,-61711.47 80,-61711.47 80,-61711.47 74,-61711.47 68,-61705.47 68,-61699.47 68,-61699.47 68,-61676.47 68,-61676.47 68,-61670.47 74,-61664.47 80,-61664.47 80,-61664.47 370,-61664.47 370,-61664.47 376,-61664.47 382,-61670.47 382,-61676.47 382,-61676.47 382,-61699.47 382,-61699.47 382,-61705.47 376,-61711.47 370,-61711.47"/>
<text text-anchor="middle" x="225" y="-61696.47" font-family="Arial" font-size="10.00">Layer 19 Attn Out GPU0</text>
<text text-anchor="middle" x="225" y="-61685.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="225" y="-61674.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer19_attn_0&#45;&gt;layer19_attn_out_0 -->
<g id="edge313" class="edge">
<title>layer19_attn_0&#45;&gt;layer19_attn_out_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M221.77,-61783.41C222.37,-61765.96 223.2,-61741.55 223.87,-61721.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="227.37,-61721.97 224.22,-61711.86 220.38,-61721.73 227.37,-61721.97"/>
</g>
<!-- layer19_attn_out_1 -->
<g id="node276" class="node">
<title>layer19_attn_out_1</title>
<path fill="#e6f3ff" stroke="black" d="M722,-61711.47C722,-61711.47 432,-61711.47 432,-61711.47 426,-61711.47 420,-61705.47 420,-61699.47 420,-61699.47 420,-61676.47 420,-61676.47 420,-61670.47 426,-61664.47 432,-61664.47 432,-61664.47 722,-61664.47 722,-61664.47 728,-61664.47 734,-61670.47 734,-61676.47 734,-61676.47 734,-61699.47 734,-61699.47 734,-61705.47 728,-61711.47 722,-61711.47"/>
<text text-anchor="middle" x="577" y="-61696.47" font-family="Arial" font-size="10.00">Layer 19 Attn Out GPU1</text>
<text text-anchor="middle" x="577" y="-61685.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="577" y="-61674.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer19_attn_1&#45;&gt;layer19_attn_out_1 -->
<g id="edge314" class="edge">
<title>layer19_attn_1&#45;&gt;layer19_attn_out_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M578.61,-61783.41C578.32,-61765.96 577.9,-61741.55 577.56,-61721.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="581.06,-61721.8 577.39,-61711.86 574.06,-61721.92 581.06,-61721.8"/>
</g>
<!-- layer19_attn_ar -->
<g id="node277" class="node">
<title>layer19_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M530.07,-61592.47C530.07,-61592.47 328.07,-61592.47 328.07,-61592.47 322.07,-61592.47 312.3,-61587.8 308.53,-61583.13 308.53,-61583.13 265.47,-61529.8 265.47,-61529.8 261.7,-61525.14 263.93,-61520.47 269.93,-61520.47 269.93,-61520.47 471.93,-61520.47 471.93,-61520.47 477.93,-61520.47 487.7,-61525.14 491.47,-61529.8 491.47,-61529.8 534.53,-61583.13 534.53,-61583.13 538.3,-61587.8 536.07,-61592.47 530.07,-61592.47"/>
<text text-anchor="middle" x="400" y="-61559.47" font-family="Arial" font-size="10.00">Layer 19 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="400" y="-61548.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer19_attn_out_0&#45;&gt;layer19_attn_ar -->
<g id="edge315" class="edge">
<title>layer19_attn_out_0&#45;&gt;layer19_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M255.48,-61664.41C279.92,-61646.33 314.86,-61620.47 344.27,-61598.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="346.45,-61601.45 352.4,-61592.69 342.28,-61595.82 346.45,-61601.45"/>
</g>
<!-- layer19_attn_out_1&#45;&gt;layer19_attn_ar -->
<g id="edge316" class="edge">
<title>layer19_attn_out_1&#45;&gt;layer19_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M546.17,-61664.41C521.45,-61646.33 486.11,-61620.47 456.37,-61598.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="458.28,-61595.77 448.14,-61592.69 454.14,-61601.42 458.28,-61595.77"/>
</g>
<!-- layer19_ffn1_0 -->
<g id="node278" class="node">
<title>layer19_ffn1_0</title>
<path fill="#e6f3ff" stroke="black" d="M370,-61448.47C370,-61448.47 100,-61448.47 100,-61448.47 94,-61448.47 88,-61442.47 88,-61436.47 88,-61436.47 88,-61413.47 88,-61413.47 88,-61407.47 94,-61401.47 100,-61401.47 100,-61401.47 370,-61401.47 370,-61401.47 376,-61401.47 382,-61407.47 382,-61413.47 382,-61413.47 382,-61436.47 382,-61436.47 382,-61442.47 376,-61448.47 370,-61448.47"/>
<text text-anchor="middle" x="235" y="-61433.47" font-family="Arial" font-size="10.00">Layer 19 FFN1 GPU0</text>
<text text-anchor="middle" x="235" y="-61422.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="235" y="-61411.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer19_attn_ar&#45;&gt;layer19_ffn1_0 -->
<g id="edge317" class="edge">
<title>layer19_attn_ar&#45;&gt;layer19_ffn1_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M355.35,-61520.42C329.28,-61499.96 296.78,-61474.45 272.12,-61455.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="274.11,-61452.21 264.08,-61448.79 269.79,-61457.72 274.11,-61452.21"/>
</g>
<!-- layer19_ffn1_1 -->
<g id="node279" class="node">
<title>layer19_ffn1_1</title>
<path fill="#e6f3ff" stroke="black" d="M700,-61448.47C700,-61448.47 430,-61448.47 430,-61448.47 424,-61448.47 418,-61442.47 418,-61436.47 418,-61436.47 418,-61413.47 418,-61413.47 418,-61407.47 424,-61401.47 430,-61401.47 430,-61401.47 700,-61401.47 700,-61401.47 706,-61401.47 712,-61407.47 712,-61413.47 712,-61413.47 712,-61436.47 712,-61436.47 712,-61442.47 706,-61448.47 700,-61448.47"/>
<text text-anchor="middle" x="565" y="-61433.47" font-family="Arial" font-size="10.00">Layer 19 FFN1 GPU1</text>
<text text-anchor="middle" x="565" y="-61422.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="565" y="-61411.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer19_attn_ar&#45;&gt;layer19_ffn1_1 -->
<g id="edge318" class="edge">
<title>layer19_attn_ar&#45;&gt;layer19_ffn1_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M444.65,-61520.42C470.72,-61499.96 503.22,-61474.45 527.88,-61455.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="530.21,-61457.72 535.92,-61448.79 525.89,-61452.21 530.21,-61457.72"/>
</g>
<!-- layer19_act_0 -->
<g id="node280" class="node">
<title>layer19_act_0</title>
<path fill="#e6f3ff" stroke="black" d="M370,-61329.47C370,-61329.47 100,-61329.47 100,-61329.47 94,-61329.47 88,-61323.47 88,-61317.47 88,-61317.47 88,-61294.47 88,-61294.47 88,-61288.47 94,-61282.47 100,-61282.47 100,-61282.47 370,-61282.47 370,-61282.47 376,-61282.47 382,-61288.47 382,-61294.47 382,-61294.47 382,-61317.47 382,-61317.47 382,-61323.47 376,-61329.47 370,-61329.47"/>
<text text-anchor="middle" x="235" y="-61314.47" font-family="Arial" font-size="10.00">Layer 19 SiLU GPU0</text>
<text text-anchor="middle" x="235" y="-61303.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="235" y="-61292.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer19_ffn1_0&#45;&gt;layer19_act_0 -->
<g id="edge319" class="edge">
<title>layer19_ffn1_0&#45;&gt;layer19_act_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M235,-61401.41C235,-61383.96 235,-61359.55 235,-61339.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="238.5,-61339.86 235,-61329.86 231.5,-61339.86 238.5,-61339.86"/>
</g>
<!-- layer19_act_1 -->
<g id="node281" class="node">
<title>layer19_act_1</title>
<path fill="#e6f3ff" stroke="black" d="M700,-61329.47C700,-61329.47 430,-61329.47 430,-61329.47 424,-61329.47 418,-61323.47 418,-61317.47 418,-61317.47 418,-61294.47 418,-61294.47 418,-61288.47 424,-61282.47 430,-61282.47 430,-61282.47 700,-61282.47 700,-61282.47 706,-61282.47 712,-61288.47 712,-61294.47 712,-61294.47 712,-61317.47 712,-61317.47 712,-61323.47 706,-61329.47 700,-61329.47"/>
<text text-anchor="middle" x="565" y="-61314.47" font-family="Arial" font-size="10.00">Layer 19 SiLU GPU1</text>
<text text-anchor="middle" x="565" y="-61303.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="565" y="-61292.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer19_ffn1_1&#45;&gt;layer19_act_1 -->
<g id="edge320" class="edge">
<title>layer19_ffn1_1&#45;&gt;layer19_act_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M565,-61401.41C565,-61383.96 565,-61359.55 565,-61339.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="568.5,-61339.86 565,-61329.86 561.5,-61339.86 568.5,-61339.86"/>
</g>
<!-- layer19_ffn2_0 -->
<g id="node282" class="node">
<title>layer19_ffn2_0</title>
<path fill="#e6f3ff" stroke="black" d="M369.5,-61210.47C369.5,-61210.47 106.5,-61210.47 106.5,-61210.47 100.5,-61210.47 94.5,-61204.47 94.5,-61198.47 94.5,-61198.47 94.5,-61175.47 94.5,-61175.47 94.5,-61169.47 100.5,-61163.47 106.5,-61163.47 106.5,-61163.47 369.5,-61163.47 369.5,-61163.47 375.5,-61163.47 381.5,-61169.47 381.5,-61175.47 381.5,-61175.47 381.5,-61198.47 381.5,-61198.47 381.5,-61204.47 375.5,-61210.47 369.5,-61210.47"/>
<text text-anchor="middle" x="238" y="-61195.47" font-family="Arial" font-size="10.00">Layer 19 FFN2 GPU0</text>
<text text-anchor="middle" x="238" y="-61184.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="238" y="-61173.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer19_act_0&#45;&gt;layer19_ffn2_0 -->
<g id="edge321" class="edge">
<title>layer19_act_0&#45;&gt;layer19_ffn2_0</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M235.58,-61282.41C236.03,-61264.96 236.65,-61240.55 237.16,-61220.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="240.66,-61220.94 237.41,-61210.86 233.66,-61220.76 240.66,-61220.94"/>
</g>
<!-- layer19_ffn2_1 -->
<g id="node283" class="node">
<title>layer19_ffn2_1</title>
<path fill="#e6f3ff" stroke="black" d="M694.5,-61210.47C694.5,-61210.47 431.5,-61210.47 431.5,-61210.47 425.5,-61210.47 419.5,-61204.47 419.5,-61198.47 419.5,-61198.47 419.5,-61175.47 419.5,-61175.47 419.5,-61169.47 425.5,-61163.47 431.5,-61163.47 431.5,-61163.47 694.5,-61163.47 694.5,-61163.47 700.5,-61163.47 706.5,-61169.47 706.5,-61175.47 706.5,-61175.47 706.5,-61198.47 706.5,-61198.47 706.5,-61204.47 700.5,-61210.47 694.5,-61210.47"/>
<text text-anchor="middle" x="563" y="-61195.47" font-family="Arial" font-size="10.00">Layer 19 FFN2 GPU1</text>
<text text-anchor="middle" x="563" y="-61184.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="563" y="-61173.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer19_act_1&#45;&gt;layer19_ffn2_1 -->
<g id="edge322" class="edge">
<title>layer19_act_1&#45;&gt;layer19_ffn2_1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M564.61,-61282.41C564.32,-61264.96 563.9,-61240.55 563.56,-61220.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="567.06,-61220.8 563.39,-61210.86 560.06,-61220.92 567.06,-61220.8"/>
</g>
<!-- layer19_ffn_ar -->
<g id="node284" class="node">
<title>layer19_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M531.22,-61091.47C531.22,-61091.47 325.8,-61091.47 325.8,-61091.47 319.8,-61091.47 310,-61086.83 306.19,-61082.19 306.19,-61082.19 262.39,-61028.75 262.39,-61028.75 258.59,-61024.11 260.78,-61019.47 266.78,-61019.47 266.78,-61019.47 472.2,-61019.47 472.2,-61019.47 478.2,-61019.47 488,-61024.11 491.81,-61028.75 491.81,-61028.75 535.61,-61082.19 535.61,-61082.19 539.41,-61086.83 537.22,-61091.47 531.22,-61091.47"/>
<text text-anchor="middle" x="399" y="-61058.47" font-family="Arial" font-size="10.00">Layer 19 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="399" y="-61047.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer19_ffn2_0&#45;&gt;layer19_ffn_ar -->
<g id="edge323" class="edge">
<title>layer19_ffn2_0&#45;&gt;layer19_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M266.04,-61163.41C288.43,-61145.41 320.4,-61119.69 347.38,-61097.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="349.61,-61100.68 355.21,-61091.69 345.23,-61095.23 349.61,-61100.68"/>
</g>
<!-- layer19_ffn2_1&#45;&gt;layer19_ffn_ar -->
<g id="edge324" class="edge">
<title>layer19_ffn2_1&#45;&gt;layer19_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M534.43,-61163.41C511.63,-61145.41 479.06,-61119.69 451.58,-61097.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="453.62,-61095.14 443.6,-61091.69 449.28,-61100.63 453.62,-61095.14"/>
</g>
<!-- stage0_to_stage1 -->
<g id="node285" class="node">
<title>stage0_to_stage1</title>
<path fill="#ffe6e6" stroke="black" d="M503.23,-60947.47C503.23,-60947.47 342.33,-60947.47 342.33,-60947.47 336.33,-60947.47 327.62,-60942.11 324.91,-60936.76 324.91,-60936.76 288.19,-60864.18 288.19,-60864.18 285.48,-60858.82 288.77,-60853.47 294.77,-60853.47 294.77,-60853.47 455.67,-60853.47 455.67,-60853.47 461.67,-60853.47 470.38,-60858.82 473.09,-60864.18 473.09,-60864.18 509.81,-60936.76 509.81,-60936.76 512.52,-60942.11 509.23,-60947.47 503.23,-60947.47"/>
<text text-anchor="middle" x="399" y="-60908.97" font-family="Arial" font-size="10.00">Pipeline Forward</text>
<text text-anchor="middle" x="399" y="-60897.97" font-family="Arial" font-size="10.00">Stage 0  Stage 1</text>
<text text-anchor="middle" x="399" y="-60886.97" font-family="Arial" font-size="10.00">[PP Forward]</text>
</g>
<!-- layer19_ffn_ar&#45;&gt;stage0_to_stage1 -->
<g id="edge325" class="edge">
<title>layer19_ffn_ar&#45;&gt;stage0_to_stage1</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M399,-61019.37C399,-61001.18 399,-60978.52 399,-60957.94"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="402.5,-60957.72 399,-60947.72 395.5,-60957.72 402.5,-60957.72"/>
</g>
<!-- layer20_qkv_2 -->
<g id="node286" class="node">
<title>layer20_qkv_2</title>
<path fill="#e6f3ff" stroke="black" d="M369,-60781.47C369,-60781.47 71,-60781.47 71,-60781.47 65,-60781.47 59,-60775.47 59,-60769.47 59,-60769.47 59,-60746.47 59,-60746.47 59,-60740.47 65,-60734.47 71,-60734.47 71,-60734.47 369,-60734.47 369,-60734.47 375,-60734.47 381,-60740.47 381,-60746.47 381,-60746.47 381,-60769.47 381,-60769.47 381,-60775.47 375,-60781.47 369,-60781.47"/>
<text text-anchor="middle" x="220" y="-60766.47" font-family="Arial" font-size="10.00">Layer 20 QKV Proj GPU2</text>
<text text-anchor="middle" x="220" y="-60755.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="220" y="-60744.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- stage0_to_stage1&#45;&gt;layer20_qkv_2 -->
<g id="edge326" class="edge">
<title>stage0_to_stage1&#45;&gt;layer20_qkv_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M340.39,-60853.46C313.03,-60831.99 281.27,-60807.06 257.25,-60788.21"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="259.12,-60785.23 249.1,-60781.81 254.8,-60790.73 259.12,-60785.23"/>
</g>
<!-- layer20_qkv_3 -->
<g id="node287" class="node">
<title>layer20_qkv_3</title>
<path fill="#e6f3ff" stroke="black" d="M727,-60781.47C727,-60781.47 429,-60781.47 429,-60781.47 423,-60781.47 417,-60775.47 417,-60769.47 417,-60769.47 417,-60746.47 417,-60746.47 417,-60740.47 423,-60734.47 429,-60734.47 429,-60734.47 727,-60734.47 727,-60734.47 733,-60734.47 739,-60740.47 739,-60746.47 739,-60746.47 739,-60769.47 739,-60769.47 739,-60775.47 733,-60781.47 727,-60781.47"/>
<text text-anchor="middle" x="578" y="-60766.47" font-family="Arial" font-size="10.00">Layer 20 QKV Proj GPU3</text>
<text text-anchor="middle" x="578" y="-60755.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="578" y="-60744.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- stage0_to_stage1&#45;&gt;layer20_qkv_3 -->
<g id="edge327" class="edge">
<title>stage0_to_stage1&#45;&gt;layer20_qkv_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M457.61,-60853.46C484.97,-60831.99 516.73,-60807.06 540.75,-60788.21"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="543.2,-60790.73 548.9,-60781.81 538.88,-60785.23 543.2,-60790.73"/>
</g>
<!-- layer20_attn_2 -->
<g id="node288" class="node">
<title>layer20_attn_2</title>
<path fill="#e6f3ff" stroke="black" d="M369,-60662.47C369,-60662.47 71,-60662.47 71,-60662.47 65,-60662.47 59,-60656.47 59,-60650.47 59,-60650.47 59,-60627.47 59,-60627.47 59,-60621.47 65,-60615.47 71,-60615.47 71,-60615.47 369,-60615.47 369,-60615.47 375,-60615.47 381,-60621.47 381,-60627.47 381,-60627.47 381,-60650.47 381,-60650.47 381,-60656.47 375,-60662.47 369,-60662.47"/>
<text text-anchor="middle" x="220" y="-60647.47" font-family="Arial" font-size="10.00">Layer 20 Attention GPU2</text>
<text text-anchor="middle" x="220" y="-60636.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="220" y="-60625.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer20_qkv_2&#45;&gt;layer20_attn_2 -->
<g id="edge328" class="edge">
<title>layer20_qkv_2&#45;&gt;layer20_attn_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M220,-60734.41C220,-60716.96 220,-60692.55 220,-60672.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="223.5,-60672.86 220,-60662.86 216.5,-60672.86 223.5,-60672.86"/>
</g>
<!-- layer20_attn_3 -->
<g id="node289" class="node">
<title>layer20_attn_3</title>
<path fill="#e6f3ff" stroke="black" d="M727,-60662.47C727,-60662.47 429,-60662.47 429,-60662.47 423,-60662.47 417,-60656.47 417,-60650.47 417,-60650.47 417,-60627.47 417,-60627.47 417,-60621.47 423,-60615.47 429,-60615.47 429,-60615.47 727,-60615.47 727,-60615.47 733,-60615.47 739,-60621.47 739,-60627.47 739,-60627.47 739,-60650.47 739,-60650.47 739,-60656.47 733,-60662.47 727,-60662.47"/>
<text text-anchor="middle" x="578" y="-60647.47" font-family="Arial" font-size="10.00">Layer 20 Attention GPU3</text>
<text text-anchor="middle" x="578" y="-60636.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="578" y="-60625.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer20_qkv_3&#45;&gt;layer20_attn_3 -->
<g id="edge329" class="edge">
<title>layer20_qkv_3&#45;&gt;layer20_attn_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M578,-60734.41C578,-60716.96 578,-60692.55 578,-60672.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="581.5,-60672.86 578,-60662.86 574.5,-60672.86 581.5,-60672.86"/>
</g>
<!-- layer20_attn_out_2 -->
<g id="node290" class="node">
<title>layer20_attn_out_2</title>
<path fill="#e6f3ff" stroke="black" d="M369,-60543.47C369,-60543.47 79,-60543.47 79,-60543.47 73,-60543.47 67,-60537.47 67,-60531.47 67,-60531.47 67,-60508.47 67,-60508.47 67,-60502.47 73,-60496.47 79,-60496.47 79,-60496.47 369,-60496.47 369,-60496.47 375,-60496.47 381,-60502.47 381,-60508.47 381,-60508.47 381,-60531.47 381,-60531.47 381,-60537.47 375,-60543.47 369,-60543.47"/>
<text text-anchor="middle" x="224" y="-60528.47" font-family="Arial" font-size="10.00">Layer 20 Attn Out GPU2</text>
<text text-anchor="middle" x="224" y="-60517.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="224" y="-60506.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer20_attn_2&#45;&gt;layer20_attn_out_2 -->
<g id="edge330" class="edge">
<title>layer20_attn_2&#45;&gt;layer20_attn_out_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M220.77,-60615.41C221.37,-60597.96 222.2,-60573.55 222.87,-60553.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="226.37,-60553.97 223.22,-60543.86 219.38,-60553.73 226.37,-60553.97"/>
</g>
<!-- layer20_attn_out_3 -->
<g id="node291" class="node">
<title>layer20_attn_out_3</title>
<path fill="#e6f3ff" stroke="black" d="M721,-60543.47C721,-60543.47 431,-60543.47 431,-60543.47 425,-60543.47 419,-60537.47 419,-60531.47 419,-60531.47 419,-60508.47 419,-60508.47 419,-60502.47 425,-60496.47 431,-60496.47 431,-60496.47 721,-60496.47 721,-60496.47 727,-60496.47 733,-60502.47 733,-60508.47 733,-60508.47 733,-60531.47 733,-60531.47 733,-60537.47 727,-60543.47 721,-60543.47"/>
<text text-anchor="middle" x="576" y="-60528.47" font-family="Arial" font-size="10.00">Layer 20 Attn Out GPU3</text>
<text text-anchor="middle" x="576" y="-60517.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="576" y="-60506.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer20_attn_3&#45;&gt;layer20_attn_out_3 -->
<g id="edge331" class="edge">
<title>layer20_attn_3&#45;&gt;layer20_attn_out_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M577.61,-60615.41C577.32,-60597.96 576.9,-60573.55 576.56,-60553.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="580.06,-60553.8 576.39,-60543.86 573.06,-60553.92 580.06,-60553.8"/>
</g>
<!-- layer20_attn_ar -->
<g id="node292" class="node">
<title>layer20_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M529.07,-60424.47C529.07,-60424.47 327.07,-60424.47 327.07,-60424.47 321.07,-60424.47 311.3,-60419.8 307.53,-60415.13 307.53,-60415.13 264.47,-60361.8 264.47,-60361.8 260.7,-60357.14 262.93,-60352.47 268.93,-60352.47 268.93,-60352.47 470.93,-60352.47 470.93,-60352.47 476.93,-60352.47 486.7,-60357.14 490.47,-60361.8 490.47,-60361.8 533.53,-60415.13 533.53,-60415.13 537.3,-60419.8 535.07,-60424.47 529.07,-60424.47"/>
<text text-anchor="middle" x="399" y="-60391.47" font-family="Arial" font-size="10.00">Layer 20 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="399" y="-60380.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer20_attn_out_2&#45;&gt;layer20_attn_ar -->
<g id="edge332" class="edge">
<title>layer20_attn_out_2&#45;&gt;layer20_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M254.48,-60496.41C278.92,-60478.33 313.86,-60452.47 343.27,-60430.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="345.45,-60433.45 351.4,-60424.69 341.28,-60427.82 345.45,-60433.45"/>
</g>
<!-- layer20_attn_out_3&#45;&gt;layer20_attn_ar -->
<g id="edge333" class="edge">
<title>layer20_attn_out_3&#45;&gt;layer20_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M545.17,-60496.41C520.45,-60478.33 485.11,-60452.47 455.37,-60430.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="457.28,-60427.77 447.14,-60424.69 453.14,-60433.42 457.28,-60427.77"/>
</g>
<!-- layer20_ffn1_2 -->
<g id="node293" class="node">
<title>layer20_ffn1_2</title>
<path fill="#e6f3ff" stroke="black" d="M369,-60280.47C369,-60280.47 99,-60280.47 99,-60280.47 93,-60280.47 87,-60274.47 87,-60268.47 87,-60268.47 87,-60245.47 87,-60245.47 87,-60239.47 93,-60233.47 99,-60233.47 99,-60233.47 369,-60233.47 369,-60233.47 375,-60233.47 381,-60239.47 381,-60245.47 381,-60245.47 381,-60268.47 381,-60268.47 381,-60274.47 375,-60280.47 369,-60280.47"/>
<text text-anchor="middle" x="234" y="-60265.47" font-family="Arial" font-size="10.00">Layer 20 FFN1 GPU2</text>
<text text-anchor="middle" x="234" y="-60254.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="234" y="-60243.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer20_attn_ar&#45;&gt;layer20_ffn1_2 -->
<g id="edge334" class="edge">
<title>layer20_attn_ar&#45;&gt;layer20_ffn1_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M354.35,-60352.42C328.28,-60331.96 295.78,-60306.45 271.12,-60287.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="273.11,-60284.21 263.08,-60280.79 268.79,-60289.72 273.11,-60284.21"/>
</g>
<!-- layer20_ffn1_3 -->
<g id="node294" class="node">
<title>layer20_ffn1_3</title>
<path fill="#e6f3ff" stroke="black" d="M699,-60280.47C699,-60280.47 429,-60280.47 429,-60280.47 423,-60280.47 417,-60274.47 417,-60268.47 417,-60268.47 417,-60245.47 417,-60245.47 417,-60239.47 423,-60233.47 429,-60233.47 429,-60233.47 699,-60233.47 699,-60233.47 705,-60233.47 711,-60239.47 711,-60245.47 711,-60245.47 711,-60268.47 711,-60268.47 711,-60274.47 705,-60280.47 699,-60280.47"/>
<text text-anchor="middle" x="564" y="-60265.47" font-family="Arial" font-size="10.00">Layer 20 FFN1 GPU3</text>
<text text-anchor="middle" x="564" y="-60254.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="564" y="-60243.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer20_attn_ar&#45;&gt;layer20_ffn1_3 -->
<g id="edge335" class="edge">
<title>layer20_attn_ar&#45;&gt;layer20_ffn1_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M443.65,-60352.42C469.72,-60331.96 502.22,-60306.45 526.88,-60287.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="529.21,-60289.72 534.92,-60280.79 524.89,-60284.21 529.21,-60289.72"/>
</g>
<!-- layer20_act_2 -->
<g id="node295" class="node">
<title>layer20_act_2</title>
<path fill="#e6f3ff" stroke="black" d="M369,-60161.47C369,-60161.47 99,-60161.47 99,-60161.47 93,-60161.47 87,-60155.47 87,-60149.47 87,-60149.47 87,-60126.47 87,-60126.47 87,-60120.47 93,-60114.47 99,-60114.47 99,-60114.47 369,-60114.47 369,-60114.47 375,-60114.47 381,-60120.47 381,-60126.47 381,-60126.47 381,-60149.47 381,-60149.47 381,-60155.47 375,-60161.47 369,-60161.47"/>
<text text-anchor="middle" x="234" y="-60146.47" font-family="Arial" font-size="10.00">Layer 20 SiLU GPU2</text>
<text text-anchor="middle" x="234" y="-60135.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="234" y="-60124.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer20_ffn1_2&#45;&gt;layer20_act_2 -->
<g id="edge336" class="edge">
<title>layer20_ffn1_2&#45;&gt;layer20_act_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M234,-60233.41C234,-60215.96 234,-60191.55 234,-60171.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="237.5,-60171.86 234,-60161.86 230.5,-60171.86 237.5,-60171.86"/>
</g>
<!-- layer20_act_3 -->
<g id="node296" class="node">
<title>layer20_act_3</title>
<path fill="#e6f3ff" stroke="black" d="M699,-60161.47C699,-60161.47 429,-60161.47 429,-60161.47 423,-60161.47 417,-60155.47 417,-60149.47 417,-60149.47 417,-60126.47 417,-60126.47 417,-60120.47 423,-60114.47 429,-60114.47 429,-60114.47 699,-60114.47 699,-60114.47 705,-60114.47 711,-60120.47 711,-60126.47 711,-60126.47 711,-60149.47 711,-60149.47 711,-60155.47 705,-60161.47 699,-60161.47"/>
<text text-anchor="middle" x="564" y="-60146.47" font-family="Arial" font-size="10.00">Layer 20 SiLU GPU3</text>
<text text-anchor="middle" x="564" y="-60135.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="564" y="-60124.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer20_ffn1_3&#45;&gt;layer20_act_3 -->
<g id="edge337" class="edge">
<title>layer20_ffn1_3&#45;&gt;layer20_act_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M564,-60233.41C564,-60215.96 564,-60191.55 564,-60171.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="567.5,-60171.86 564,-60161.86 560.5,-60171.86 567.5,-60171.86"/>
</g>
<!-- layer20_ffn2_2 -->
<g id="node297" class="node">
<title>layer20_ffn2_2</title>
<path fill="#e6f3ff" stroke="black" d="M368.5,-60042.47C368.5,-60042.47 105.5,-60042.47 105.5,-60042.47 99.5,-60042.47 93.5,-60036.47 93.5,-60030.47 93.5,-60030.47 93.5,-60007.47 93.5,-60007.47 93.5,-60001.47 99.5,-59995.47 105.5,-59995.47 105.5,-59995.47 368.5,-59995.47 368.5,-59995.47 374.5,-59995.47 380.5,-60001.47 380.5,-60007.47 380.5,-60007.47 380.5,-60030.47 380.5,-60030.47 380.5,-60036.47 374.5,-60042.47 368.5,-60042.47"/>
<text text-anchor="middle" x="237" y="-60027.47" font-family="Arial" font-size="10.00">Layer 20 FFN2 GPU2</text>
<text text-anchor="middle" x="237" y="-60016.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="237" y="-60005.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer20_act_2&#45;&gt;layer20_ffn2_2 -->
<g id="edge338" class="edge">
<title>layer20_act_2&#45;&gt;layer20_ffn2_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M234.58,-60114.41C235.03,-60096.96 235.65,-60072.55 236.16,-60052.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="239.66,-60052.94 236.41,-60042.86 232.66,-60052.76 239.66,-60052.94"/>
</g>
<!-- layer20_ffn2_3 -->
<g id="node298" class="node">
<title>layer20_ffn2_3</title>
<path fill="#e6f3ff" stroke="black" d="M693.5,-60042.47C693.5,-60042.47 430.5,-60042.47 430.5,-60042.47 424.5,-60042.47 418.5,-60036.47 418.5,-60030.47 418.5,-60030.47 418.5,-60007.47 418.5,-60007.47 418.5,-60001.47 424.5,-59995.47 430.5,-59995.47 430.5,-59995.47 693.5,-59995.47 693.5,-59995.47 699.5,-59995.47 705.5,-60001.47 705.5,-60007.47 705.5,-60007.47 705.5,-60030.47 705.5,-60030.47 705.5,-60036.47 699.5,-60042.47 693.5,-60042.47"/>
<text text-anchor="middle" x="562" y="-60027.47" font-family="Arial" font-size="10.00">Layer 20 FFN2 GPU3</text>
<text text-anchor="middle" x="562" y="-60016.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="562" y="-60005.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer20_act_3&#45;&gt;layer20_ffn2_3 -->
<g id="edge339" class="edge">
<title>layer20_act_3&#45;&gt;layer20_ffn2_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M563.61,-60114.41C563.32,-60096.96 562.9,-60072.55 562.56,-60052.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="566.06,-60052.8 562.39,-60042.86 559.06,-60052.92 566.06,-60052.8"/>
</g>
<!-- layer20_ffn_ar -->
<g id="node299" class="node">
<title>layer20_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M530.22,-59923.47C530.22,-59923.47 324.8,-59923.47 324.8,-59923.47 318.8,-59923.47 309,-59918.83 305.19,-59914.19 305.19,-59914.19 261.39,-59860.75 261.39,-59860.75 257.59,-59856.11 259.78,-59851.47 265.78,-59851.47 265.78,-59851.47 471.2,-59851.47 471.2,-59851.47 477.2,-59851.47 487,-59856.11 490.81,-59860.75 490.81,-59860.75 534.61,-59914.19 534.61,-59914.19 538.41,-59918.83 536.22,-59923.47 530.22,-59923.47"/>
<text text-anchor="middle" x="398" y="-59890.47" font-family="Arial" font-size="10.00">Layer 20 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="398" y="-59879.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer20_ffn2_2&#45;&gt;layer20_ffn_ar -->
<g id="edge340" class="edge">
<title>layer20_ffn2_2&#45;&gt;layer20_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M265.04,-59995.41C287.43,-59977.41 319.4,-59951.69 346.38,-59929.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="348.61,-59932.68 354.21,-59923.69 344.23,-59927.23 348.61,-59932.68"/>
</g>
<!-- layer20_ffn2_3&#45;&gt;layer20_ffn_ar -->
<g id="edge341" class="edge">
<title>layer20_ffn2_3&#45;&gt;layer20_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M533.43,-59995.41C510.63,-59977.41 478.06,-59951.69 450.58,-59929.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="452.62,-59927.14 442.6,-59923.69 448.28,-59932.63 452.62,-59927.14"/>
</g>
<!-- layer21_qkv_2 -->
<g id="node300" class="node">
<title>layer21_qkv_2</title>
<path fill="#e6f3ff" stroke="black" d="M368,-59779.47C368,-59779.47 70,-59779.47 70,-59779.47 64,-59779.47 58,-59773.47 58,-59767.47 58,-59767.47 58,-59744.47 58,-59744.47 58,-59738.47 64,-59732.47 70,-59732.47 70,-59732.47 368,-59732.47 368,-59732.47 374,-59732.47 380,-59738.47 380,-59744.47 380,-59744.47 380,-59767.47 380,-59767.47 380,-59773.47 374,-59779.47 368,-59779.47"/>
<text text-anchor="middle" x="219" y="-59764.47" font-family="Arial" font-size="10.00">Layer 21 QKV Proj GPU2</text>
<text text-anchor="middle" x="219" y="-59753.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="219" y="-59742.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer20_ffn_ar&#45;&gt;layer21_qkv_2 -->
<g id="edge342" class="edge">
<title>layer20_ffn_ar&#45;&gt;layer21_qkv_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M349.56,-59851.42C321.06,-59830.81 285.48,-59805.06 258.66,-59785.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="260.43,-59782.62 250.28,-59779.6 256.33,-59788.3 260.43,-59782.62"/>
</g>
<!-- layer21_qkv_3 -->
<g id="node301" class="node">
<title>layer21_qkv_3</title>
<path fill="#e6f3ff" stroke="black" d="M726,-59779.47C726,-59779.47 428,-59779.47 428,-59779.47 422,-59779.47 416,-59773.47 416,-59767.47 416,-59767.47 416,-59744.47 416,-59744.47 416,-59738.47 422,-59732.47 428,-59732.47 428,-59732.47 726,-59732.47 726,-59732.47 732,-59732.47 738,-59738.47 738,-59744.47 738,-59744.47 738,-59767.47 738,-59767.47 738,-59773.47 732,-59779.47 726,-59779.47"/>
<text text-anchor="middle" x="577" y="-59764.47" font-family="Arial" font-size="10.00">Layer 21 QKV Proj GPU3</text>
<text text-anchor="middle" x="577" y="-59753.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="577" y="-59742.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer20_ffn_ar&#45;&gt;layer21_qkv_3 -->
<g id="edge343" class="edge">
<title>layer20_ffn_ar&#45;&gt;layer21_qkv_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M446.44,-59851.42C474.94,-59830.81 510.52,-59805.06 537.34,-59785.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="539.67,-59788.3 545.72,-59779.6 535.57,-59782.62 539.67,-59788.3"/>
</g>
<!-- layer21_attn_2 -->
<g id="node302" class="node">
<title>layer21_attn_2</title>
<path fill="#e6f3ff" stroke="black" d="M368,-59660.47C368,-59660.47 70,-59660.47 70,-59660.47 64,-59660.47 58,-59654.47 58,-59648.47 58,-59648.47 58,-59625.47 58,-59625.47 58,-59619.47 64,-59613.47 70,-59613.47 70,-59613.47 368,-59613.47 368,-59613.47 374,-59613.47 380,-59619.47 380,-59625.47 380,-59625.47 380,-59648.47 380,-59648.47 380,-59654.47 374,-59660.47 368,-59660.47"/>
<text text-anchor="middle" x="219" y="-59645.47" font-family="Arial" font-size="10.00">Layer 21 Attention GPU2</text>
<text text-anchor="middle" x="219" y="-59634.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="219" y="-59623.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer21_qkv_2&#45;&gt;layer21_attn_2 -->
<g id="edge344" class="edge">
<title>layer21_qkv_2&#45;&gt;layer21_attn_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M219,-59732.41C219,-59714.96 219,-59690.55 219,-59670.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="222.5,-59670.86 219,-59660.86 215.5,-59670.86 222.5,-59670.86"/>
</g>
<!-- layer21_attn_3 -->
<g id="node303" class="node">
<title>layer21_attn_3</title>
<path fill="#e6f3ff" stroke="black" d="M726,-59660.47C726,-59660.47 428,-59660.47 428,-59660.47 422,-59660.47 416,-59654.47 416,-59648.47 416,-59648.47 416,-59625.47 416,-59625.47 416,-59619.47 422,-59613.47 428,-59613.47 428,-59613.47 726,-59613.47 726,-59613.47 732,-59613.47 738,-59619.47 738,-59625.47 738,-59625.47 738,-59648.47 738,-59648.47 738,-59654.47 732,-59660.47 726,-59660.47"/>
<text text-anchor="middle" x="577" y="-59645.47" font-family="Arial" font-size="10.00">Layer 21 Attention GPU3</text>
<text text-anchor="middle" x="577" y="-59634.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="577" y="-59623.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer21_qkv_3&#45;&gt;layer21_attn_3 -->
<g id="edge345" class="edge">
<title>layer21_qkv_3&#45;&gt;layer21_attn_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M577,-59732.41C577,-59714.96 577,-59690.55 577,-59670.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="580.5,-59670.86 577,-59660.86 573.5,-59670.86 580.5,-59670.86"/>
</g>
<!-- layer21_attn_out_2 -->
<g id="node304" class="node">
<title>layer21_attn_out_2</title>
<path fill="#e6f3ff" stroke="black" d="M368,-59541.47C368,-59541.47 78,-59541.47 78,-59541.47 72,-59541.47 66,-59535.47 66,-59529.47 66,-59529.47 66,-59506.47 66,-59506.47 66,-59500.47 72,-59494.47 78,-59494.47 78,-59494.47 368,-59494.47 368,-59494.47 374,-59494.47 380,-59500.47 380,-59506.47 380,-59506.47 380,-59529.47 380,-59529.47 380,-59535.47 374,-59541.47 368,-59541.47"/>
<text text-anchor="middle" x="223" y="-59526.47" font-family="Arial" font-size="10.00">Layer 21 Attn Out GPU2</text>
<text text-anchor="middle" x="223" y="-59515.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="223" y="-59504.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer21_attn_2&#45;&gt;layer21_attn_out_2 -->
<g id="edge346" class="edge">
<title>layer21_attn_2&#45;&gt;layer21_attn_out_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M219.77,-59613.41C220.37,-59595.96 221.2,-59571.55 221.87,-59551.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="225.37,-59551.97 222.22,-59541.86 218.38,-59551.73 225.37,-59551.97"/>
</g>
<!-- layer21_attn_out_3 -->
<g id="node305" class="node">
<title>layer21_attn_out_3</title>
<path fill="#e6f3ff" stroke="black" d="M720,-59541.47C720,-59541.47 430,-59541.47 430,-59541.47 424,-59541.47 418,-59535.47 418,-59529.47 418,-59529.47 418,-59506.47 418,-59506.47 418,-59500.47 424,-59494.47 430,-59494.47 430,-59494.47 720,-59494.47 720,-59494.47 726,-59494.47 732,-59500.47 732,-59506.47 732,-59506.47 732,-59529.47 732,-59529.47 732,-59535.47 726,-59541.47 720,-59541.47"/>
<text text-anchor="middle" x="575" y="-59526.47" font-family="Arial" font-size="10.00">Layer 21 Attn Out GPU3</text>
<text text-anchor="middle" x="575" y="-59515.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="575" y="-59504.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer21_attn_3&#45;&gt;layer21_attn_out_3 -->
<g id="edge347" class="edge">
<title>layer21_attn_3&#45;&gt;layer21_attn_out_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M576.61,-59613.41C576.32,-59595.96 575.9,-59571.55 575.56,-59551.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="579.06,-59551.8 575.39,-59541.86 572.06,-59551.92 579.06,-59551.8"/>
</g>
<!-- layer21_attn_ar -->
<g id="node306" class="node">
<title>layer21_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M528.07,-59422.47C528.07,-59422.47 326.07,-59422.47 326.07,-59422.47 320.07,-59422.47 310.3,-59417.8 306.53,-59413.13 306.53,-59413.13 263.47,-59359.8 263.47,-59359.8 259.7,-59355.14 261.93,-59350.47 267.93,-59350.47 267.93,-59350.47 469.93,-59350.47 469.93,-59350.47 475.93,-59350.47 485.7,-59355.14 489.47,-59359.8 489.47,-59359.8 532.53,-59413.13 532.53,-59413.13 536.3,-59417.8 534.07,-59422.47 528.07,-59422.47"/>
<text text-anchor="middle" x="398" y="-59389.47" font-family="Arial" font-size="10.00">Layer 21 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="398" y="-59378.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer21_attn_out_2&#45;&gt;layer21_attn_ar -->
<g id="edge348" class="edge">
<title>layer21_attn_out_2&#45;&gt;layer21_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M253.48,-59494.41C277.92,-59476.33 312.86,-59450.47 342.27,-59428.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="344.45,-59431.45 350.4,-59422.69 340.28,-59425.82 344.45,-59431.45"/>
</g>
<!-- layer21_attn_out_3&#45;&gt;layer21_attn_ar -->
<g id="edge349" class="edge">
<title>layer21_attn_out_3&#45;&gt;layer21_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M544.17,-59494.41C519.45,-59476.33 484.11,-59450.47 454.37,-59428.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="456.28,-59425.77 446.14,-59422.69 452.14,-59431.42 456.28,-59425.77"/>
</g>
<!-- layer21_ffn1_2 -->
<g id="node307" class="node">
<title>layer21_ffn1_2</title>
<path fill="#e6f3ff" stroke="black" d="M368,-59278.47C368,-59278.47 98,-59278.47 98,-59278.47 92,-59278.47 86,-59272.47 86,-59266.47 86,-59266.47 86,-59243.47 86,-59243.47 86,-59237.47 92,-59231.47 98,-59231.47 98,-59231.47 368,-59231.47 368,-59231.47 374,-59231.47 380,-59237.47 380,-59243.47 380,-59243.47 380,-59266.47 380,-59266.47 380,-59272.47 374,-59278.47 368,-59278.47"/>
<text text-anchor="middle" x="233" y="-59263.47" font-family="Arial" font-size="10.00">Layer 21 FFN1 GPU2</text>
<text text-anchor="middle" x="233" y="-59252.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="233" y="-59241.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer21_attn_ar&#45;&gt;layer21_ffn1_2 -->
<g id="edge350" class="edge">
<title>layer21_attn_ar&#45;&gt;layer21_ffn1_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M353.35,-59350.42C327.28,-59329.96 294.78,-59304.45 270.12,-59285.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="272.11,-59282.21 262.08,-59278.79 267.79,-59287.72 272.11,-59282.21"/>
</g>
<!-- layer21_ffn1_3 -->
<g id="node308" class="node">
<title>layer21_ffn1_3</title>
<path fill="#e6f3ff" stroke="black" d="M698,-59278.47C698,-59278.47 428,-59278.47 428,-59278.47 422,-59278.47 416,-59272.47 416,-59266.47 416,-59266.47 416,-59243.47 416,-59243.47 416,-59237.47 422,-59231.47 428,-59231.47 428,-59231.47 698,-59231.47 698,-59231.47 704,-59231.47 710,-59237.47 710,-59243.47 710,-59243.47 710,-59266.47 710,-59266.47 710,-59272.47 704,-59278.47 698,-59278.47"/>
<text text-anchor="middle" x="563" y="-59263.47" font-family="Arial" font-size="10.00">Layer 21 FFN1 GPU3</text>
<text text-anchor="middle" x="563" y="-59252.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="563" y="-59241.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer21_attn_ar&#45;&gt;layer21_ffn1_3 -->
<g id="edge351" class="edge">
<title>layer21_attn_ar&#45;&gt;layer21_ffn1_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M442.65,-59350.42C468.72,-59329.96 501.22,-59304.45 525.88,-59285.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="528.21,-59287.72 533.92,-59278.79 523.89,-59282.21 528.21,-59287.72"/>
</g>
<!-- layer21_act_2 -->
<g id="node309" class="node">
<title>layer21_act_2</title>
<path fill="#e6f3ff" stroke="black" d="M368,-59159.47C368,-59159.47 98,-59159.47 98,-59159.47 92,-59159.47 86,-59153.47 86,-59147.47 86,-59147.47 86,-59124.47 86,-59124.47 86,-59118.47 92,-59112.47 98,-59112.47 98,-59112.47 368,-59112.47 368,-59112.47 374,-59112.47 380,-59118.47 380,-59124.47 380,-59124.47 380,-59147.47 380,-59147.47 380,-59153.47 374,-59159.47 368,-59159.47"/>
<text text-anchor="middle" x="233" y="-59144.47" font-family="Arial" font-size="10.00">Layer 21 SiLU GPU2</text>
<text text-anchor="middle" x="233" y="-59133.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="233" y="-59122.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer21_ffn1_2&#45;&gt;layer21_act_2 -->
<g id="edge352" class="edge">
<title>layer21_ffn1_2&#45;&gt;layer21_act_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M233,-59231.41C233,-59213.96 233,-59189.55 233,-59169.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="236.5,-59169.86 233,-59159.86 229.5,-59169.86 236.5,-59169.86"/>
</g>
<!-- layer21_act_3 -->
<g id="node310" class="node">
<title>layer21_act_3</title>
<path fill="#e6f3ff" stroke="black" d="M698,-59159.47C698,-59159.47 428,-59159.47 428,-59159.47 422,-59159.47 416,-59153.47 416,-59147.47 416,-59147.47 416,-59124.47 416,-59124.47 416,-59118.47 422,-59112.47 428,-59112.47 428,-59112.47 698,-59112.47 698,-59112.47 704,-59112.47 710,-59118.47 710,-59124.47 710,-59124.47 710,-59147.47 710,-59147.47 710,-59153.47 704,-59159.47 698,-59159.47"/>
<text text-anchor="middle" x="563" y="-59144.47" font-family="Arial" font-size="10.00">Layer 21 SiLU GPU3</text>
<text text-anchor="middle" x="563" y="-59133.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="563" y="-59122.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer21_ffn1_3&#45;&gt;layer21_act_3 -->
<g id="edge353" class="edge">
<title>layer21_ffn1_3&#45;&gt;layer21_act_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M563,-59231.41C563,-59213.96 563,-59189.55 563,-59169.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="566.5,-59169.86 563,-59159.86 559.5,-59169.86 566.5,-59169.86"/>
</g>
<!-- layer21_ffn2_2 -->
<g id="node311" class="node">
<title>layer21_ffn2_2</title>
<path fill="#e6f3ff" stroke="black" d="M367.5,-59040.47C367.5,-59040.47 104.5,-59040.47 104.5,-59040.47 98.5,-59040.47 92.5,-59034.47 92.5,-59028.47 92.5,-59028.47 92.5,-59005.47 92.5,-59005.47 92.5,-58999.47 98.5,-58993.47 104.5,-58993.47 104.5,-58993.47 367.5,-58993.47 367.5,-58993.47 373.5,-58993.47 379.5,-58999.47 379.5,-59005.47 379.5,-59005.47 379.5,-59028.47 379.5,-59028.47 379.5,-59034.47 373.5,-59040.47 367.5,-59040.47"/>
<text text-anchor="middle" x="236" y="-59025.47" font-family="Arial" font-size="10.00">Layer 21 FFN2 GPU2</text>
<text text-anchor="middle" x="236" y="-59014.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="236" y="-59003.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer21_act_2&#45;&gt;layer21_ffn2_2 -->
<g id="edge354" class="edge">
<title>layer21_act_2&#45;&gt;layer21_ffn2_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M233.58,-59112.41C234.03,-59094.96 234.65,-59070.55 235.16,-59050.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="238.66,-59050.94 235.41,-59040.86 231.66,-59050.76 238.66,-59050.94"/>
</g>
<!-- layer21_ffn2_3 -->
<g id="node312" class="node">
<title>layer21_ffn2_3</title>
<path fill="#e6f3ff" stroke="black" d="M692.5,-59040.47C692.5,-59040.47 429.5,-59040.47 429.5,-59040.47 423.5,-59040.47 417.5,-59034.47 417.5,-59028.47 417.5,-59028.47 417.5,-59005.47 417.5,-59005.47 417.5,-58999.47 423.5,-58993.47 429.5,-58993.47 429.5,-58993.47 692.5,-58993.47 692.5,-58993.47 698.5,-58993.47 704.5,-58999.47 704.5,-59005.47 704.5,-59005.47 704.5,-59028.47 704.5,-59028.47 704.5,-59034.47 698.5,-59040.47 692.5,-59040.47"/>
<text text-anchor="middle" x="561" y="-59025.47" font-family="Arial" font-size="10.00">Layer 21 FFN2 GPU3</text>
<text text-anchor="middle" x="561" y="-59014.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="561" y="-59003.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer21_act_3&#45;&gt;layer21_ffn2_3 -->
<g id="edge355" class="edge">
<title>layer21_act_3&#45;&gt;layer21_ffn2_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M562.61,-59112.41C562.32,-59094.96 561.9,-59070.55 561.56,-59050.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="565.06,-59050.8 561.39,-59040.86 558.06,-59050.92 565.06,-59050.8"/>
</g>
<!-- layer21_ffn_ar -->
<g id="node313" class="node">
<title>layer21_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M529.22,-58921.47C529.22,-58921.47 323.8,-58921.47 323.8,-58921.47 317.8,-58921.47 308,-58916.83 304.19,-58912.19 304.19,-58912.19 260.39,-58858.75 260.39,-58858.75 256.59,-58854.11 258.78,-58849.47 264.78,-58849.47 264.78,-58849.47 470.2,-58849.47 470.2,-58849.47 476.2,-58849.47 486,-58854.11 489.81,-58858.75 489.81,-58858.75 533.61,-58912.19 533.61,-58912.19 537.41,-58916.83 535.22,-58921.47 529.22,-58921.47"/>
<text text-anchor="middle" x="397" y="-58888.47" font-family="Arial" font-size="10.00">Layer 21 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="397" y="-58877.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer21_ffn2_2&#45;&gt;layer21_ffn_ar -->
<g id="edge356" class="edge">
<title>layer21_ffn2_2&#45;&gt;layer21_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M264.04,-58993.41C286.43,-58975.41 318.4,-58949.69 345.38,-58927.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="347.61,-58930.68 353.21,-58921.69 343.23,-58925.23 347.61,-58930.68"/>
</g>
<!-- layer21_ffn2_3&#45;&gt;layer21_ffn_ar -->
<g id="edge357" class="edge">
<title>layer21_ffn2_3&#45;&gt;layer21_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M532.43,-58993.41C509.63,-58975.41 477.06,-58949.69 449.58,-58927.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="451.62,-58925.14 441.6,-58921.69 447.28,-58930.63 451.62,-58925.14"/>
</g>
<!-- layer22_qkv_2 -->
<g id="node314" class="node">
<title>layer22_qkv_2</title>
<path fill="#e6f3ff" stroke="black" d="M367,-58777.47C367,-58777.47 69,-58777.47 69,-58777.47 63,-58777.47 57,-58771.47 57,-58765.47 57,-58765.47 57,-58742.47 57,-58742.47 57,-58736.47 63,-58730.47 69,-58730.47 69,-58730.47 367,-58730.47 367,-58730.47 373,-58730.47 379,-58736.47 379,-58742.47 379,-58742.47 379,-58765.47 379,-58765.47 379,-58771.47 373,-58777.47 367,-58777.47"/>
<text text-anchor="middle" x="218" y="-58762.47" font-family="Arial" font-size="10.00">Layer 22 QKV Proj GPU2</text>
<text text-anchor="middle" x="218" y="-58751.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="218" y="-58740.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer21_ffn_ar&#45;&gt;layer22_qkv_2 -->
<g id="edge358" class="edge">
<title>layer21_ffn_ar&#45;&gt;layer22_qkv_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M348.56,-58849.42C320.06,-58828.81 284.48,-58803.06 257.66,-58783.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="259.43,-58780.62 249.28,-58777.6 255.33,-58786.3 259.43,-58780.62"/>
</g>
<!-- layer22_qkv_3 -->
<g id="node315" class="node">
<title>layer22_qkv_3</title>
<path fill="#e6f3ff" stroke="black" d="M725,-58777.47C725,-58777.47 427,-58777.47 427,-58777.47 421,-58777.47 415,-58771.47 415,-58765.47 415,-58765.47 415,-58742.47 415,-58742.47 415,-58736.47 421,-58730.47 427,-58730.47 427,-58730.47 725,-58730.47 725,-58730.47 731,-58730.47 737,-58736.47 737,-58742.47 737,-58742.47 737,-58765.47 737,-58765.47 737,-58771.47 731,-58777.47 725,-58777.47"/>
<text text-anchor="middle" x="576" y="-58762.47" font-family="Arial" font-size="10.00">Layer 22 QKV Proj GPU3</text>
<text text-anchor="middle" x="576" y="-58751.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="576" y="-58740.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer21_ffn_ar&#45;&gt;layer22_qkv_3 -->
<g id="edge359" class="edge">
<title>layer21_ffn_ar&#45;&gt;layer22_qkv_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M445.44,-58849.42C473.94,-58828.81 509.52,-58803.06 536.34,-58783.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="538.67,-58786.3 544.72,-58777.6 534.57,-58780.62 538.67,-58786.3"/>
</g>
<!-- layer22_attn_2 -->
<g id="node316" class="node">
<title>layer22_attn_2</title>
<path fill="#e6f3ff" stroke="black" d="M367,-58658.47C367,-58658.47 69,-58658.47 69,-58658.47 63,-58658.47 57,-58652.47 57,-58646.47 57,-58646.47 57,-58623.47 57,-58623.47 57,-58617.47 63,-58611.47 69,-58611.47 69,-58611.47 367,-58611.47 367,-58611.47 373,-58611.47 379,-58617.47 379,-58623.47 379,-58623.47 379,-58646.47 379,-58646.47 379,-58652.47 373,-58658.47 367,-58658.47"/>
<text text-anchor="middle" x="218" y="-58643.47" font-family="Arial" font-size="10.00">Layer 22 Attention GPU2</text>
<text text-anchor="middle" x="218" y="-58632.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="218" y="-58621.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer22_qkv_2&#45;&gt;layer22_attn_2 -->
<g id="edge360" class="edge">
<title>layer22_qkv_2&#45;&gt;layer22_attn_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M218,-58730.41C218,-58712.96 218,-58688.55 218,-58668.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="221.5,-58668.86 218,-58658.86 214.5,-58668.86 221.5,-58668.86"/>
</g>
<!-- layer22_attn_3 -->
<g id="node317" class="node">
<title>layer22_attn_3</title>
<path fill="#e6f3ff" stroke="black" d="M725,-58658.47C725,-58658.47 427,-58658.47 427,-58658.47 421,-58658.47 415,-58652.47 415,-58646.47 415,-58646.47 415,-58623.47 415,-58623.47 415,-58617.47 421,-58611.47 427,-58611.47 427,-58611.47 725,-58611.47 725,-58611.47 731,-58611.47 737,-58617.47 737,-58623.47 737,-58623.47 737,-58646.47 737,-58646.47 737,-58652.47 731,-58658.47 725,-58658.47"/>
<text text-anchor="middle" x="576" y="-58643.47" font-family="Arial" font-size="10.00">Layer 22 Attention GPU3</text>
<text text-anchor="middle" x="576" y="-58632.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="576" y="-58621.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer22_qkv_3&#45;&gt;layer22_attn_3 -->
<g id="edge361" class="edge">
<title>layer22_qkv_3&#45;&gt;layer22_attn_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M576,-58730.41C576,-58712.96 576,-58688.55 576,-58668.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="579.5,-58668.86 576,-58658.86 572.5,-58668.86 579.5,-58668.86"/>
</g>
<!-- layer22_attn_out_2 -->
<g id="node318" class="node">
<title>layer22_attn_out_2</title>
<path fill="#e6f3ff" stroke="black" d="M367,-58539.47C367,-58539.47 77,-58539.47 77,-58539.47 71,-58539.47 65,-58533.47 65,-58527.47 65,-58527.47 65,-58504.47 65,-58504.47 65,-58498.47 71,-58492.47 77,-58492.47 77,-58492.47 367,-58492.47 367,-58492.47 373,-58492.47 379,-58498.47 379,-58504.47 379,-58504.47 379,-58527.47 379,-58527.47 379,-58533.47 373,-58539.47 367,-58539.47"/>
<text text-anchor="middle" x="222" y="-58524.47" font-family="Arial" font-size="10.00">Layer 22 Attn Out GPU2</text>
<text text-anchor="middle" x="222" y="-58513.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="222" y="-58502.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer22_attn_2&#45;&gt;layer22_attn_out_2 -->
<g id="edge362" class="edge">
<title>layer22_attn_2&#45;&gt;layer22_attn_out_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M218.77,-58611.41C219.37,-58593.96 220.2,-58569.55 220.87,-58549.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="224.37,-58549.97 221.22,-58539.86 217.38,-58549.73 224.37,-58549.97"/>
</g>
<!-- layer22_attn_out_3 -->
<g id="node319" class="node">
<title>layer22_attn_out_3</title>
<path fill="#e6f3ff" stroke="black" d="M719,-58539.47C719,-58539.47 429,-58539.47 429,-58539.47 423,-58539.47 417,-58533.47 417,-58527.47 417,-58527.47 417,-58504.47 417,-58504.47 417,-58498.47 423,-58492.47 429,-58492.47 429,-58492.47 719,-58492.47 719,-58492.47 725,-58492.47 731,-58498.47 731,-58504.47 731,-58504.47 731,-58527.47 731,-58527.47 731,-58533.47 725,-58539.47 719,-58539.47"/>
<text text-anchor="middle" x="574" y="-58524.47" font-family="Arial" font-size="10.00">Layer 22 Attn Out GPU3</text>
<text text-anchor="middle" x="574" y="-58513.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="574" y="-58502.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer22_attn_3&#45;&gt;layer22_attn_out_3 -->
<g id="edge363" class="edge">
<title>layer22_attn_3&#45;&gt;layer22_attn_out_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M575.61,-58611.41C575.32,-58593.96 574.9,-58569.55 574.56,-58549.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="578.06,-58549.8 574.39,-58539.86 571.06,-58549.92 578.06,-58549.8"/>
</g>
<!-- layer22_attn_ar -->
<g id="node320" class="node">
<title>layer22_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M527.07,-58420.47C527.07,-58420.47 325.07,-58420.47 325.07,-58420.47 319.07,-58420.47 309.3,-58415.8 305.53,-58411.13 305.53,-58411.13 262.47,-58357.8 262.47,-58357.8 258.7,-58353.14 260.93,-58348.47 266.93,-58348.47 266.93,-58348.47 468.93,-58348.47 468.93,-58348.47 474.93,-58348.47 484.7,-58353.14 488.47,-58357.8 488.47,-58357.8 531.53,-58411.13 531.53,-58411.13 535.3,-58415.8 533.07,-58420.47 527.07,-58420.47"/>
<text text-anchor="middle" x="397" y="-58387.47" font-family="Arial" font-size="10.00">Layer 22 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="397" y="-58376.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer22_attn_out_2&#45;&gt;layer22_attn_ar -->
<g id="edge364" class="edge">
<title>layer22_attn_out_2&#45;&gt;layer22_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M252.48,-58492.41C276.92,-58474.33 311.86,-58448.47 341.27,-58426.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="343.45,-58429.45 349.4,-58420.69 339.28,-58423.82 343.45,-58429.45"/>
</g>
<!-- layer22_attn_out_3&#45;&gt;layer22_attn_ar -->
<g id="edge365" class="edge">
<title>layer22_attn_out_3&#45;&gt;layer22_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M543.17,-58492.41C518.45,-58474.33 483.11,-58448.47 453.37,-58426.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="455.28,-58423.77 445.14,-58420.69 451.14,-58429.42 455.28,-58423.77"/>
</g>
<!-- layer22_ffn1_2 -->
<g id="node321" class="node">
<title>layer22_ffn1_2</title>
<path fill="#e6f3ff" stroke="black" d="M367,-58276.47C367,-58276.47 97,-58276.47 97,-58276.47 91,-58276.47 85,-58270.47 85,-58264.47 85,-58264.47 85,-58241.47 85,-58241.47 85,-58235.47 91,-58229.47 97,-58229.47 97,-58229.47 367,-58229.47 367,-58229.47 373,-58229.47 379,-58235.47 379,-58241.47 379,-58241.47 379,-58264.47 379,-58264.47 379,-58270.47 373,-58276.47 367,-58276.47"/>
<text text-anchor="middle" x="232" y="-58261.47" font-family="Arial" font-size="10.00">Layer 22 FFN1 GPU2</text>
<text text-anchor="middle" x="232" y="-58250.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="232" y="-58239.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer22_attn_ar&#45;&gt;layer22_ffn1_2 -->
<g id="edge366" class="edge">
<title>layer22_attn_ar&#45;&gt;layer22_ffn1_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M352.35,-58348.42C326.28,-58327.96 293.78,-58302.45 269.12,-58283.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="271.11,-58280.21 261.08,-58276.79 266.79,-58285.72 271.11,-58280.21"/>
</g>
<!-- layer22_ffn1_3 -->
<g id="node322" class="node">
<title>layer22_ffn1_3</title>
<path fill="#e6f3ff" stroke="black" d="M697,-58276.47C697,-58276.47 427,-58276.47 427,-58276.47 421,-58276.47 415,-58270.47 415,-58264.47 415,-58264.47 415,-58241.47 415,-58241.47 415,-58235.47 421,-58229.47 427,-58229.47 427,-58229.47 697,-58229.47 697,-58229.47 703,-58229.47 709,-58235.47 709,-58241.47 709,-58241.47 709,-58264.47 709,-58264.47 709,-58270.47 703,-58276.47 697,-58276.47"/>
<text text-anchor="middle" x="562" y="-58261.47" font-family="Arial" font-size="10.00">Layer 22 FFN1 GPU3</text>
<text text-anchor="middle" x="562" y="-58250.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="562" y="-58239.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer22_attn_ar&#45;&gt;layer22_ffn1_3 -->
<g id="edge367" class="edge">
<title>layer22_attn_ar&#45;&gt;layer22_ffn1_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M441.65,-58348.42C467.72,-58327.96 500.22,-58302.45 524.88,-58283.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="527.21,-58285.72 532.92,-58276.79 522.89,-58280.21 527.21,-58285.72"/>
</g>
<!-- layer22_act_2 -->
<g id="node323" class="node">
<title>layer22_act_2</title>
<path fill="#e6f3ff" stroke="black" d="M367,-58157.47C367,-58157.47 97,-58157.47 97,-58157.47 91,-58157.47 85,-58151.47 85,-58145.47 85,-58145.47 85,-58122.47 85,-58122.47 85,-58116.47 91,-58110.47 97,-58110.47 97,-58110.47 367,-58110.47 367,-58110.47 373,-58110.47 379,-58116.47 379,-58122.47 379,-58122.47 379,-58145.47 379,-58145.47 379,-58151.47 373,-58157.47 367,-58157.47"/>
<text text-anchor="middle" x="232" y="-58142.47" font-family="Arial" font-size="10.00">Layer 22 SiLU GPU2</text>
<text text-anchor="middle" x="232" y="-58131.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="232" y="-58120.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer22_ffn1_2&#45;&gt;layer22_act_2 -->
<g id="edge368" class="edge">
<title>layer22_ffn1_2&#45;&gt;layer22_act_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M232,-58229.41C232,-58211.96 232,-58187.55 232,-58167.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="235.5,-58167.86 232,-58157.86 228.5,-58167.86 235.5,-58167.86"/>
</g>
<!-- layer22_act_3 -->
<g id="node324" class="node">
<title>layer22_act_3</title>
<path fill="#e6f3ff" stroke="black" d="M697,-58157.47C697,-58157.47 427,-58157.47 427,-58157.47 421,-58157.47 415,-58151.47 415,-58145.47 415,-58145.47 415,-58122.47 415,-58122.47 415,-58116.47 421,-58110.47 427,-58110.47 427,-58110.47 697,-58110.47 697,-58110.47 703,-58110.47 709,-58116.47 709,-58122.47 709,-58122.47 709,-58145.47 709,-58145.47 709,-58151.47 703,-58157.47 697,-58157.47"/>
<text text-anchor="middle" x="562" y="-58142.47" font-family="Arial" font-size="10.00">Layer 22 SiLU GPU3</text>
<text text-anchor="middle" x="562" y="-58131.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="562" y="-58120.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer22_ffn1_3&#45;&gt;layer22_act_3 -->
<g id="edge369" class="edge">
<title>layer22_ffn1_3&#45;&gt;layer22_act_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M562,-58229.41C562,-58211.96 562,-58187.55 562,-58167.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="565.5,-58167.86 562,-58157.86 558.5,-58167.86 565.5,-58167.86"/>
</g>
<!-- layer22_ffn2_2 -->
<g id="node325" class="node">
<title>layer22_ffn2_2</title>
<path fill="#e6f3ff" stroke="black" d="M366.5,-58038.47C366.5,-58038.47 103.5,-58038.47 103.5,-58038.47 97.5,-58038.47 91.5,-58032.47 91.5,-58026.47 91.5,-58026.47 91.5,-58003.47 91.5,-58003.47 91.5,-57997.47 97.5,-57991.47 103.5,-57991.47 103.5,-57991.47 366.5,-57991.47 366.5,-57991.47 372.5,-57991.47 378.5,-57997.47 378.5,-58003.47 378.5,-58003.47 378.5,-58026.47 378.5,-58026.47 378.5,-58032.47 372.5,-58038.47 366.5,-58038.47"/>
<text text-anchor="middle" x="235" y="-58023.47" font-family="Arial" font-size="10.00">Layer 22 FFN2 GPU2</text>
<text text-anchor="middle" x="235" y="-58012.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="235" y="-58001.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer22_act_2&#45;&gt;layer22_ffn2_2 -->
<g id="edge370" class="edge">
<title>layer22_act_2&#45;&gt;layer22_ffn2_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M232.58,-58110.41C233.03,-58092.96 233.65,-58068.55 234.16,-58048.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="237.66,-58048.94 234.41,-58038.86 230.66,-58048.76 237.66,-58048.94"/>
</g>
<!-- layer22_ffn2_3 -->
<g id="node326" class="node">
<title>layer22_ffn2_3</title>
<path fill="#e6f3ff" stroke="black" d="M691.5,-58038.47C691.5,-58038.47 428.5,-58038.47 428.5,-58038.47 422.5,-58038.47 416.5,-58032.47 416.5,-58026.47 416.5,-58026.47 416.5,-58003.47 416.5,-58003.47 416.5,-57997.47 422.5,-57991.47 428.5,-57991.47 428.5,-57991.47 691.5,-57991.47 691.5,-57991.47 697.5,-57991.47 703.5,-57997.47 703.5,-58003.47 703.5,-58003.47 703.5,-58026.47 703.5,-58026.47 703.5,-58032.47 697.5,-58038.47 691.5,-58038.47"/>
<text text-anchor="middle" x="560" y="-58023.47" font-family="Arial" font-size="10.00">Layer 22 FFN2 GPU3</text>
<text text-anchor="middle" x="560" y="-58012.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="560" y="-58001.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer22_act_3&#45;&gt;layer22_ffn2_3 -->
<g id="edge371" class="edge">
<title>layer22_act_3&#45;&gt;layer22_ffn2_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M561.61,-58110.41C561.32,-58092.96 560.9,-58068.55 560.56,-58048.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="564.06,-58048.8 560.39,-58038.86 557.06,-58048.92 564.06,-58048.8"/>
</g>
<!-- layer22_ffn_ar -->
<g id="node327" class="node">
<title>layer22_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M528.22,-57919.47C528.22,-57919.47 322.8,-57919.47 322.8,-57919.47 316.8,-57919.47 307,-57914.83 303.19,-57910.19 303.19,-57910.19 259.39,-57856.75 259.39,-57856.75 255.59,-57852.11 257.78,-57847.47 263.78,-57847.47 263.78,-57847.47 469.2,-57847.47 469.2,-57847.47 475.2,-57847.47 485,-57852.11 488.81,-57856.75 488.81,-57856.75 532.61,-57910.19 532.61,-57910.19 536.41,-57914.83 534.22,-57919.47 528.22,-57919.47"/>
<text text-anchor="middle" x="396" y="-57886.47" font-family="Arial" font-size="10.00">Layer 22 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="396" y="-57875.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer22_ffn2_2&#45;&gt;layer22_ffn_ar -->
<g id="edge372" class="edge">
<title>layer22_ffn2_2&#45;&gt;layer22_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M263.04,-57991.41C285.43,-57973.41 317.4,-57947.69 344.38,-57925.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="346.61,-57928.68 352.21,-57919.69 342.23,-57923.23 346.61,-57928.68"/>
</g>
<!-- layer22_ffn2_3&#45;&gt;layer22_ffn_ar -->
<g id="edge373" class="edge">
<title>layer22_ffn2_3&#45;&gt;layer22_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M531.43,-57991.41C508.63,-57973.41 476.06,-57947.69 448.58,-57925.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="450.62,-57923.14 440.6,-57919.69 446.28,-57928.63 450.62,-57923.14"/>
</g>
<!-- layer23_qkv_2 -->
<g id="node328" class="node">
<title>layer23_qkv_2</title>
<path fill="#e6f3ff" stroke="black" d="M366,-57775.47C366,-57775.47 68,-57775.47 68,-57775.47 62,-57775.47 56,-57769.47 56,-57763.47 56,-57763.47 56,-57740.47 56,-57740.47 56,-57734.47 62,-57728.47 68,-57728.47 68,-57728.47 366,-57728.47 366,-57728.47 372,-57728.47 378,-57734.47 378,-57740.47 378,-57740.47 378,-57763.47 378,-57763.47 378,-57769.47 372,-57775.47 366,-57775.47"/>
<text text-anchor="middle" x="217" y="-57760.47" font-family="Arial" font-size="10.00">Layer 23 QKV Proj GPU2</text>
<text text-anchor="middle" x="217" y="-57749.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="217" y="-57738.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer22_ffn_ar&#45;&gt;layer23_qkv_2 -->
<g id="edge374" class="edge">
<title>layer22_ffn_ar&#45;&gt;layer23_qkv_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M347.56,-57847.42C319.06,-57826.81 283.48,-57801.06 256.66,-57781.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="258.43,-57778.62 248.28,-57775.6 254.33,-57784.3 258.43,-57778.62"/>
</g>
<!-- layer23_qkv_3 -->
<g id="node329" class="node">
<title>layer23_qkv_3</title>
<path fill="#e6f3ff" stroke="black" d="M724,-57775.47C724,-57775.47 426,-57775.47 426,-57775.47 420,-57775.47 414,-57769.47 414,-57763.47 414,-57763.47 414,-57740.47 414,-57740.47 414,-57734.47 420,-57728.47 426,-57728.47 426,-57728.47 724,-57728.47 724,-57728.47 730,-57728.47 736,-57734.47 736,-57740.47 736,-57740.47 736,-57763.47 736,-57763.47 736,-57769.47 730,-57775.47 724,-57775.47"/>
<text text-anchor="middle" x="575" y="-57760.47" font-family="Arial" font-size="10.00">Layer 23 QKV Proj GPU3</text>
<text text-anchor="middle" x="575" y="-57749.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="575" y="-57738.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer22_ffn_ar&#45;&gt;layer23_qkv_3 -->
<g id="edge375" class="edge">
<title>layer22_ffn_ar&#45;&gt;layer23_qkv_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M444.44,-57847.42C472.94,-57826.81 508.52,-57801.06 535.34,-57781.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="537.67,-57784.3 543.72,-57775.6 533.57,-57778.62 537.67,-57784.3"/>
</g>
<!-- layer23_attn_2 -->
<g id="node330" class="node">
<title>layer23_attn_2</title>
<path fill="#e6f3ff" stroke="black" d="M366,-57656.47C366,-57656.47 68,-57656.47 68,-57656.47 62,-57656.47 56,-57650.47 56,-57644.47 56,-57644.47 56,-57621.47 56,-57621.47 56,-57615.47 62,-57609.47 68,-57609.47 68,-57609.47 366,-57609.47 366,-57609.47 372,-57609.47 378,-57615.47 378,-57621.47 378,-57621.47 378,-57644.47 378,-57644.47 378,-57650.47 372,-57656.47 366,-57656.47"/>
<text text-anchor="middle" x="217" y="-57641.47" font-family="Arial" font-size="10.00">Layer 23 Attention GPU2</text>
<text text-anchor="middle" x="217" y="-57630.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="217" y="-57619.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer23_qkv_2&#45;&gt;layer23_attn_2 -->
<g id="edge376" class="edge">
<title>layer23_qkv_2&#45;&gt;layer23_attn_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M217,-57728.41C217,-57710.96 217,-57686.55 217,-57666.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="220.5,-57666.86 217,-57656.86 213.5,-57666.86 220.5,-57666.86"/>
</g>
<!-- layer23_attn_3 -->
<g id="node331" class="node">
<title>layer23_attn_3</title>
<path fill="#e6f3ff" stroke="black" d="M724,-57656.47C724,-57656.47 426,-57656.47 426,-57656.47 420,-57656.47 414,-57650.47 414,-57644.47 414,-57644.47 414,-57621.47 414,-57621.47 414,-57615.47 420,-57609.47 426,-57609.47 426,-57609.47 724,-57609.47 724,-57609.47 730,-57609.47 736,-57615.47 736,-57621.47 736,-57621.47 736,-57644.47 736,-57644.47 736,-57650.47 730,-57656.47 724,-57656.47"/>
<text text-anchor="middle" x="575" y="-57641.47" font-family="Arial" font-size="10.00">Layer 23 Attention GPU3</text>
<text text-anchor="middle" x="575" y="-57630.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="575" y="-57619.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer23_qkv_3&#45;&gt;layer23_attn_3 -->
<g id="edge377" class="edge">
<title>layer23_qkv_3&#45;&gt;layer23_attn_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M575,-57728.41C575,-57710.96 575,-57686.55 575,-57666.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="578.5,-57666.86 575,-57656.86 571.5,-57666.86 578.5,-57666.86"/>
</g>
<!-- layer23_attn_out_2 -->
<g id="node332" class="node">
<title>layer23_attn_out_2</title>
<path fill="#e6f3ff" stroke="black" d="M366,-57537.47C366,-57537.47 76,-57537.47 76,-57537.47 70,-57537.47 64,-57531.47 64,-57525.47 64,-57525.47 64,-57502.47 64,-57502.47 64,-57496.47 70,-57490.47 76,-57490.47 76,-57490.47 366,-57490.47 366,-57490.47 372,-57490.47 378,-57496.47 378,-57502.47 378,-57502.47 378,-57525.47 378,-57525.47 378,-57531.47 372,-57537.47 366,-57537.47"/>
<text text-anchor="middle" x="221" y="-57522.47" font-family="Arial" font-size="10.00">Layer 23 Attn Out GPU2</text>
<text text-anchor="middle" x="221" y="-57511.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="221" y="-57500.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer23_attn_2&#45;&gt;layer23_attn_out_2 -->
<g id="edge378" class="edge">
<title>layer23_attn_2&#45;&gt;layer23_attn_out_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M217.77,-57609.41C218.37,-57591.96 219.2,-57567.55 219.87,-57547.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="223.37,-57547.97 220.22,-57537.86 216.38,-57547.73 223.37,-57547.97"/>
</g>
<!-- layer23_attn_out_3 -->
<g id="node333" class="node">
<title>layer23_attn_out_3</title>
<path fill="#e6f3ff" stroke="black" d="M718,-57537.47C718,-57537.47 428,-57537.47 428,-57537.47 422,-57537.47 416,-57531.47 416,-57525.47 416,-57525.47 416,-57502.47 416,-57502.47 416,-57496.47 422,-57490.47 428,-57490.47 428,-57490.47 718,-57490.47 718,-57490.47 724,-57490.47 730,-57496.47 730,-57502.47 730,-57502.47 730,-57525.47 730,-57525.47 730,-57531.47 724,-57537.47 718,-57537.47"/>
<text text-anchor="middle" x="573" y="-57522.47" font-family="Arial" font-size="10.00">Layer 23 Attn Out GPU3</text>
<text text-anchor="middle" x="573" y="-57511.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="573" y="-57500.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer23_attn_3&#45;&gt;layer23_attn_out_3 -->
<g id="edge379" class="edge">
<title>layer23_attn_3&#45;&gt;layer23_attn_out_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M574.61,-57609.41C574.32,-57591.96 573.9,-57567.55 573.56,-57547.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="577.06,-57547.8 573.39,-57537.86 570.06,-57547.92 577.06,-57547.8"/>
</g>
<!-- layer23_attn_ar -->
<g id="node334" class="node">
<title>layer23_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M526.07,-57418.47C526.07,-57418.47 324.07,-57418.47 324.07,-57418.47 318.07,-57418.47 308.3,-57413.8 304.53,-57409.13 304.53,-57409.13 261.47,-57355.8 261.47,-57355.8 257.7,-57351.14 259.93,-57346.47 265.93,-57346.47 265.93,-57346.47 467.93,-57346.47 467.93,-57346.47 473.93,-57346.47 483.7,-57351.14 487.47,-57355.8 487.47,-57355.8 530.53,-57409.13 530.53,-57409.13 534.3,-57413.8 532.07,-57418.47 526.07,-57418.47"/>
<text text-anchor="middle" x="396" y="-57385.47" font-family="Arial" font-size="10.00">Layer 23 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="396" y="-57374.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer23_attn_out_2&#45;&gt;layer23_attn_ar -->
<g id="edge380" class="edge">
<title>layer23_attn_out_2&#45;&gt;layer23_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M251.48,-57490.41C275.92,-57472.33 310.86,-57446.47 340.27,-57424.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="342.45,-57427.45 348.4,-57418.69 338.28,-57421.82 342.45,-57427.45"/>
</g>
<!-- layer23_attn_out_3&#45;&gt;layer23_attn_ar -->
<g id="edge381" class="edge">
<title>layer23_attn_out_3&#45;&gt;layer23_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M542.17,-57490.41C517.45,-57472.33 482.11,-57446.47 452.37,-57424.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="454.28,-57421.77 444.14,-57418.69 450.14,-57427.42 454.28,-57421.77"/>
</g>
<!-- layer23_ffn1_2 -->
<g id="node335" class="node">
<title>layer23_ffn1_2</title>
<path fill="#e6f3ff" stroke="black" d="M366,-57274.47C366,-57274.47 96,-57274.47 96,-57274.47 90,-57274.47 84,-57268.47 84,-57262.47 84,-57262.47 84,-57239.47 84,-57239.47 84,-57233.47 90,-57227.47 96,-57227.47 96,-57227.47 366,-57227.47 366,-57227.47 372,-57227.47 378,-57233.47 378,-57239.47 378,-57239.47 378,-57262.47 378,-57262.47 378,-57268.47 372,-57274.47 366,-57274.47"/>
<text text-anchor="middle" x="231" y="-57259.47" font-family="Arial" font-size="10.00">Layer 23 FFN1 GPU2</text>
<text text-anchor="middle" x="231" y="-57248.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="231" y="-57237.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer23_attn_ar&#45;&gt;layer23_ffn1_2 -->
<g id="edge382" class="edge">
<title>layer23_attn_ar&#45;&gt;layer23_ffn1_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M351.35,-57346.42C325.28,-57325.96 292.78,-57300.45 268.12,-57281.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="270.11,-57278.21 260.08,-57274.79 265.79,-57283.72 270.11,-57278.21"/>
</g>
<!-- layer23_ffn1_3 -->
<g id="node336" class="node">
<title>layer23_ffn1_3</title>
<path fill="#e6f3ff" stroke="black" d="M696,-57274.47C696,-57274.47 426,-57274.47 426,-57274.47 420,-57274.47 414,-57268.47 414,-57262.47 414,-57262.47 414,-57239.47 414,-57239.47 414,-57233.47 420,-57227.47 426,-57227.47 426,-57227.47 696,-57227.47 696,-57227.47 702,-57227.47 708,-57233.47 708,-57239.47 708,-57239.47 708,-57262.47 708,-57262.47 708,-57268.47 702,-57274.47 696,-57274.47"/>
<text text-anchor="middle" x="561" y="-57259.47" font-family="Arial" font-size="10.00">Layer 23 FFN1 GPU3</text>
<text text-anchor="middle" x="561" y="-57248.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="561" y="-57237.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer23_attn_ar&#45;&gt;layer23_ffn1_3 -->
<g id="edge383" class="edge">
<title>layer23_attn_ar&#45;&gt;layer23_ffn1_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M440.65,-57346.42C466.72,-57325.96 499.22,-57300.45 523.88,-57281.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="526.21,-57283.72 531.92,-57274.79 521.89,-57278.21 526.21,-57283.72"/>
</g>
<!-- layer23_act_2 -->
<g id="node337" class="node">
<title>layer23_act_2</title>
<path fill="#e6f3ff" stroke="black" d="M366,-57155.47C366,-57155.47 96,-57155.47 96,-57155.47 90,-57155.47 84,-57149.47 84,-57143.47 84,-57143.47 84,-57120.47 84,-57120.47 84,-57114.47 90,-57108.47 96,-57108.47 96,-57108.47 366,-57108.47 366,-57108.47 372,-57108.47 378,-57114.47 378,-57120.47 378,-57120.47 378,-57143.47 378,-57143.47 378,-57149.47 372,-57155.47 366,-57155.47"/>
<text text-anchor="middle" x="231" y="-57140.47" font-family="Arial" font-size="10.00">Layer 23 SiLU GPU2</text>
<text text-anchor="middle" x="231" y="-57129.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="231" y="-57118.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer23_ffn1_2&#45;&gt;layer23_act_2 -->
<g id="edge384" class="edge">
<title>layer23_ffn1_2&#45;&gt;layer23_act_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M231,-57227.41C231,-57209.96 231,-57185.55 231,-57165.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="234.5,-57165.86 231,-57155.86 227.5,-57165.86 234.5,-57165.86"/>
</g>
<!-- layer23_act_3 -->
<g id="node338" class="node">
<title>layer23_act_3</title>
<path fill="#e6f3ff" stroke="black" d="M696,-57155.47C696,-57155.47 426,-57155.47 426,-57155.47 420,-57155.47 414,-57149.47 414,-57143.47 414,-57143.47 414,-57120.47 414,-57120.47 414,-57114.47 420,-57108.47 426,-57108.47 426,-57108.47 696,-57108.47 696,-57108.47 702,-57108.47 708,-57114.47 708,-57120.47 708,-57120.47 708,-57143.47 708,-57143.47 708,-57149.47 702,-57155.47 696,-57155.47"/>
<text text-anchor="middle" x="561" y="-57140.47" font-family="Arial" font-size="10.00">Layer 23 SiLU GPU3</text>
<text text-anchor="middle" x="561" y="-57129.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="561" y="-57118.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer23_ffn1_3&#45;&gt;layer23_act_3 -->
<g id="edge385" class="edge">
<title>layer23_ffn1_3&#45;&gt;layer23_act_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M561,-57227.41C561,-57209.96 561,-57185.55 561,-57165.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="564.5,-57165.86 561,-57155.86 557.5,-57165.86 564.5,-57165.86"/>
</g>
<!-- layer23_ffn2_2 -->
<g id="node339" class="node">
<title>layer23_ffn2_2</title>
<path fill="#e6f3ff" stroke="black" d="M365.5,-57036.47C365.5,-57036.47 102.5,-57036.47 102.5,-57036.47 96.5,-57036.47 90.5,-57030.47 90.5,-57024.47 90.5,-57024.47 90.5,-57001.47 90.5,-57001.47 90.5,-56995.47 96.5,-56989.47 102.5,-56989.47 102.5,-56989.47 365.5,-56989.47 365.5,-56989.47 371.5,-56989.47 377.5,-56995.47 377.5,-57001.47 377.5,-57001.47 377.5,-57024.47 377.5,-57024.47 377.5,-57030.47 371.5,-57036.47 365.5,-57036.47"/>
<text text-anchor="middle" x="234" y="-57021.47" font-family="Arial" font-size="10.00">Layer 23 FFN2 GPU2</text>
<text text-anchor="middle" x="234" y="-57010.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="234" y="-56999.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer23_act_2&#45;&gt;layer23_ffn2_2 -->
<g id="edge386" class="edge">
<title>layer23_act_2&#45;&gt;layer23_ffn2_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M231.58,-57108.41C232.03,-57090.96 232.65,-57066.55 233.16,-57046.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="236.66,-57046.94 233.41,-57036.86 229.66,-57046.76 236.66,-57046.94"/>
</g>
<!-- layer23_ffn2_3 -->
<g id="node340" class="node">
<title>layer23_ffn2_3</title>
<path fill="#e6f3ff" stroke="black" d="M690.5,-57036.47C690.5,-57036.47 427.5,-57036.47 427.5,-57036.47 421.5,-57036.47 415.5,-57030.47 415.5,-57024.47 415.5,-57024.47 415.5,-57001.47 415.5,-57001.47 415.5,-56995.47 421.5,-56989.47 427.5,-56989.47 427.5,-56989.47 690.5,-56989.47 690.5,-56989.47 696.5,-56989.47 702.5,-56995.47 702.5,-57001.47 702.5,-57001.47 702.5,-57024.47 702.5,-57024.47 702.5,-57030.47 696.5,-57036.47 690.5,-57036.47"/>
<text text-anchor="middle" x="559" y="-57021.47" font-family="Arial" font-size="10.00">Layer 23 FFN2 GPU3</text>
<text text-anchor="middle" x="559" y="-57010.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="559" y="-56999.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer23_act_3&#45;&gt;layer23_ffn2_3 -->
<g id="edge387" class="edge">
<title>layer23_act_3&#45;&gt;layer23_ffn2_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M560.61,-57108.41C560.32,-57090.96 559.9,-57066.55 559.56,-57046.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="563.06,-57046.8 559.39,-57036.86 556.06,-57046.92 563.06,-57046.8"/>
</g>
<!-- layer23_ffn_ar -->
<g id="node341" class="node">
<title>layer23_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M527.22,-56917.47C527.22,-56917.47 321.8,-56917.47 321.8,-56917.47 315.8,-56917.47 306,-56912.83 302.19,-56908.19 302.19,-56908.19 258.39,-56854.75 258.39,-56854.75 254.59,-56850.11 256.78,-56845.47 262.78,-56845.47 262.78,-56845.47 468.2,-56845.47 468.2,-56845.47 474.2,-56845.47 484,-56850.11 487.81,-56854.75 487.81,-56854.75 531.61,-56908.19 531.61,-56908.19 535.41,-56912.83 533.22,-56917.47 527.22,-56917.47"/>
<text text-anchor="middle" x="395" y="-56884.47" font-family="Arial" font-size="10.00">Layer 23 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="395" y="-56873.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer23_ffn2_2&#45;&gt;layer23_ffn_ar -->
<g id="edge388" class="edge">
<title>layer23_ffn2_2&#45;&gt;layer23_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M262.04,-56989.41C284.43,-56971.41 316.4,-56945.69 343.38,-56923.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="345.61,-56926.68 351.21,-56917.69 341.23,-56921.23 345.61,-56926.68"/>
</g>
<!-- layer23_ffn2_3&#45;&gt;layer23_ffn_ar -->
<g id="edge389" class="edge">
<title>layer23_ffn2_3&#45;&gt;layer23_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M530.43,-56989.41C507.63,-56971.41 475.06,-56945.69 447.58,-56923.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="449.62,-56921.14 439.6,-56917.69 445.28,-56926.63 449.62,-56921.14"/>
</g>
<!-- layer24_qkv_2 -->
<g id="node342" class="node">
<title>layer24_qkv_2</title>
<path fill="#e6f3ff" stroke="black" d="M365,-56773.47C365,-56773.47 67,-56773.47 67,-56773.47 61,-56773.47 55,-56767.47 55,-56761.47 55,-56761.47 55,-56738.47 55,-56738.47 55,-56732.47 61,-56726.47 67,-56726.47 67,-56726.47 365,-56726.47 365,-56726.47 371,-56726.47 377,-56732.47 377,-56738.47 377,-56738.47 377,-56761.47 377,-56761.47 377,-56767.47 371,-56773.47 365,-56773.47"/>
<text text-anchor="middle" x="216" y="-56758.47" font-family="Arial" font-size="10.00">Layer 24 QKV Proj GPU2</text>
<text text-anchor="middle" x="216" y="-56747.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="216" y="-56736.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer23_ffn_ar&#45;&gt;layer24_qkv_2 -->
<g id="edge390" class="edge">
<title>layer23_ffn_ar&#45;&gt;layer24_qkv_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M346.56,-56845.42C318.06,-56824.81 282.48,-56799.06 255.66,-56779.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="257.43,-56776.62 247.28,-56773.6 253.33,-56782.3 257.43,-56776.62"/>
</g>
<!-- layer24_qkv_3 -->
<g id="node343" class="node">
<title>layer24_qkv_3</title>
<path fill="#e6f3ff" stroke="black" d="M723,-56773.47C723,-56773.47 425,-56773.47 425,-56773.47 419,-56773.47 413,-56767.47 413,-56761.47 413,-56761.47 413,-56738.47 413,-56738.47 413,-56732.47 419,-56726.47 425,-56726.47 425,-56726.47 723,-56726.47 723,-56726.47 729,-56726.47 735,-56732.47 735,-56738.47 735,-56738.47 735,-56761.47 735,-56761.47 735,-56767.47 729,-56773.47 723,-56773.47"/>
<text text-anchor="middle" x="574" y="-56758.47" font-family="Arial" font-size="10.00">Layer 24 QKV Proj GPU3</text>
<text text-anchor="middle" x="574" y="-56747.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="574" y="-56736.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer23_ffn_ar&#45;&gt;layer24_qkv_3 -->
<g id="edge391" class="edge">
<title>layer23_ffn_ar&#45;&gt;layer24_qkv_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M443.44,-56845.42C471.94,-56824.81 507.52,-56799.06 534.34,-56779.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="536.67,-56782.3 542.72,-56773.6 532.57,-56776.62 536.67,-56782.3"/>
</g>
<!-- layer24_attn_2 -->
<g id="node344" class="node">
<title>layer24_attn_2</title>
<path fill="#e6f3ff" stroke="black" d="M365,-56654.47C365,-56654.47 67,-56654.47 67,-56654.47 61,-56654.47 55,-56648.47 55,-56642.47 55,-56642.47 55,-56619.47 55,-56619.47 55,-56613.47 61,-56607.47 67,-56607.47 67,-56607.47 365,-56607.47 365,-56607.47 371,-56607.47 377,-56613.47 377,-56619.47 377,-56619.47 377,-56642.47 377,-56642.47 377,-56648.47 371,-56654.47 365,-56654.47"/>
<text text-anchor="middle" x="216" y="-56639.47" font-family="Arial" font-size="10.00">Layer 24 Attention GPU2</text>
<text text-anchor="middle" x="216" y="-56628.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="216" y="-56617.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer24_qkv_2&#45;&gt;layer24_attn_2 -->
<g id="edge392" class="edge">
<title>layer24_qkv_2&#45;&gt;layer24_attn_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M216,-56726.41C216,-56708.96 216,-56684.55 216,-56664.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="219.5,-56664.86 216,-56654.86 212.5,-56664.86 219.5,-56664.86"/>
</g>
<!-- layer24_attn_3 -->
<g id="node345" class="node">
<title>layer24_attn_3</title>
<path fill="#e6f3ff" stroke="black" d="M723,-56654.47C723,-56654.47 425,-56654.47 425,-56654.47 419,-56654.47 413,-56648.47 413,-56642.47 413,-56642.47 413,-56619.47 413,-56619.47 413,-56613.47 419,-56607.47 425,-56607.47 425,-56607.47 723,-56607.47 723,-56607.47 729,-56607.47 735,-56613.47 735,-56619.47 735,-56619.47 735,-56642.47 735,-56642.47 735,-56648.47 729,-56654.47 723,-56654.47"/>
<text text-anchor="middle" x="574" y="-56639.47" font-family="Arial" font-size="10.00">Layer 24 Attention GPU3</text>
<text text-anchor="middle" x="574" y="-56628.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="574" y="-56617.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer24_qkv_3&#45;&gt;layer24_attn_3 -->
<g id="edge393" class="edge">
<title>layer24_qkv_3&#45;&gt;layer24_attn_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M574,-56726.41C574,-56708.96 574,-56684.55 574,-56664.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="577.5,-56664.86 574,-56654.86 570.5,-56664.86 577.5,-56664.86"/>
</g>
<!-- layer24_attn_out_2 -->
<g id="node346" class="node">
<title>layer24_attn_out_2</title>
<path fill="#e6f3ff" stroke="black" d="M365,-56535.47C365,-56535.47 75,-56535.47 75,-56535.47 69,-56535.47 63,-56529.47 63,-56523.47 63,-56523.47 63,-56500.47 63,-56500.47 63,-56494.47 69,-56488.47 75,-56488.47 75,-56488.47 365,-56488.47 365,-56488.47 371,-56488.47 377,-56494.47 377,-56500.47 377,-56500.47 377,-56523.47 377,-56523.47 377,-56529.47 371,-56535.47 365,-56535.47"/>
<text text-anchor="middle" x="220" y="-56520.47" font-family="Arial" font-size="10.00">Layer 24 Attn Out GPU2</text>
<text text-anchor="middle" x="220" y="-56509.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="220" y="-56498.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer24_attn_2&#45;&gt;layer24_attn_out_2 -->
<g id="edge394" class="edge">
<title>layer24_attn_2&#45;&gt;layer24_attn_out_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M216.77,-56607.41C217.37,-56589.96 218.2,-56565.55 218.87,-56545.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="222.37,-56545.97 219.22,-56535.86 215.38,-56545.73 222.37,-56545.97"/>
</g>
<!-- layer24_attn_out_3 -->
<g id="node347" class="node">
<title>layer24_attn_out_3</title>
<path fill="#e6f3ff" stroke="black" d="M717,-56535.47C717,-56535.47 427,-56535.47 427,-56535.47 421,-56535.47 415,-56529.47 415,-56523.47 415,-56523.47 415,-56500.47 415,-56500.47 415,-56494.47 421,-56488.47 427,-56488.47 427,-56488.47 717,-56488.47 717,-56488.47 723,-56488.47 729,-56494.47 729,-56500.47 729,-56500.47 729,-56523.47 729,-56523.47 729,-56529.47 723,-56535.47 717,-56535.47"/>
<text text-anchor="middle" x="572" y="-56520.47" font-family="Arial" font-size="10.00">Layer 24 Attn Out GPU3</text>
<text text-anchor="middle" x="572" y="-56509.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="572" y="-56498.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer24_attn_3&#45;&gt;layer24_attn_out_3 -->
<g id="edge395" class="edge">
<title>layer24_attn_3&#45;&gt;layer24_attn_out_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M573.61,-56607.41C573.32,-56589.96 572.9,-56565.55 572.56,-56545.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="576.06,-56545.8 572.39,-56535.86 569.06,-56545.92 576.06,-56545.8"/>
</g>
<!-- layer24_attn_ar -->
<g id="node348" class="node">
<title>layer24_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M525.07,-56416.47C525.07,-56416.47 323.07,-56416.47 323.07,-56416.47 317.07,-56416.47 307.3,-56411.8 303.53,-56407.13 303.53,-56407.13 260.47,-56353.8 260.47,-56353.8 256.7,-56349.14 258.93,-56344.47 264.93,-56344.47 264.93,-56344.47 466.93,-56344.47 466.93,-56344.47 472.93,-56344.47 482.7,-56349.14 486.47,-56353.8 486.47,-56353.8 529.53,-56407.13 529.53,-56407.13 533.3,-56411.8 531.07,-56416.47 525.07,-56416.47"/>
<text text-anchor="middle" x="395" y="-56383.47" font-family="Arial" font-size="10.00">Layer 24 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="395" y="-56372.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer24_attn_out_2&#45;&gt;layer24_attn_ar -->
<g id="edge396" class="edge">
<title>layer24_attn_out_2&#45;&gt;layer24_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M250.48,-56488.41C274.92,-56470.33 309.86,-56444.47 339.27,-56422.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="341.45,-56425.45 347.4,-56416.69 337.28,-56419.82 341.45,-56425.45"/>
</g>
<!-- layer24_attn_out_3&#45;&gt;layer24_attn_ar -->
<g id="edge397" class="edge">
<title>layer24_attn_out_3&#45;&gt;layer24_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M541.17,-56488.41C516.45,-56470.33 481.11,-56444.47 451.37,-56422.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="453.28,-56419.77 443.14,-56416.69 449.14,-56425.42 453.28,-56419.77"/>
</g>
<!-- layer24_ffn1_2 -->
<g id="node349" class="node">
<title>layer24_ffn1_2</title>
<path fill="#e6f3ff" stroke="black" d="M365,-56272.47C365,-56272.47 95,-56272.47 95,-56272.47 89,-56272.47 83,-56266.47 83,-56260.47 83,-56260.47 83,-56237.47 83,-56237.47 83,-56231.47 89,-56225.47 95,-56225.47 95,-56225.47 365,-56225.47 365,-56225.47 371,-56225.47 377,-56231.47 377,-56237.47 377,-56237.47 377,-56260.47 377,-56260.47 377,-56266.47 371,-56272.47 365,-56272.47"/>
<text text-anchor="middle" x="230" y="-56257.47" font-family="Arial" font-size="10.00">Layer 24 FFN1 GPU2</text>
<text text-anchor="middle" x="230" y="-56246.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="230" y="-56235.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer24_attn_ar&#45;&gt;layer24_ffn1_2 -->
<g id="edge398" class="edge">
<title>layer24_attn_ar&#45;&gt;layer24_ffn1_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M350.35,-56344.42C324.28,-56323.96 291.78,-56298.45 267.12,-56279.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="269.11,-56276.21 259.08,-56272.79 264.79,-56281.72 269.11,-56276.21"/>
</g>
<!-- layer24_ffn1_3 -->
<g id="node350" class="node">
<title>layer24_ffn1_3</title>
<path fill="#e6f3ff" stroke="black" d="M695,-56272.47C695,-56272.47 425,-56272.47 425,-56272.47 419,-56272.47 413,-56266.47 413,-56260.47 413,-56260.47 413,-56237.47 413,-56237.47 413,-56231.47 419,-56225.47 425,-56225.47 425,-56225.47 695,-56225.47 695,-56225.47 701,-56225.47 707,-56231.47 707,-56237.47 707,-56237.47 707,-56260.47 707,-56260.47 707,-56266.47 701,-56272.47 695,-56272.47"/>
<text text-anchor="middle" x="560" y="-56257.47" font-family="Arial" font-size="10.00">Layer 24 FFN1 GPU3</text>
<text text-anchor="middle" x="560" y="-56246.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="560" y="-56235.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer24_attn_ar&#45;&gt;layer24_ffn1_3 -->
<g id="edge399" class="edge">
<title>layer24_attn_ar&#45;&gt;layer24_ffn1_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M439.65,-56344.42C465.72,-56323.96 498.22,-56298.45 522.88,-56279.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="525.21,-56281.72 530.92,-56272.79 520.89,-56276.21 525.21,-56281.72"/>
</g>
<!-- layer24_act_2 -->
<g id="node351" class="node">
<title>layer24_act_2</title>
<path fill="#e6f3ff" stroke="black" d="M365,-56153.47C365,-56153.47 95,-56153.47 95,-56153.47 89,-56153.47 83,-56147.47 83,-56141.47 83,-56141.47 83,-56118.47 83,-56118.47 83,-56112.47 89,-56106.47 95,-56106.47 95,-56106.47 365,-56106.47 365,-56106.47 371,-56106.47 377,-56112.47 377,-56118.47 377,-56118.47 377,-56141.47 377,-56141.47 377,-56147.47 371,-56153.47 365,-56153.47"/>
<text text-anchor="middle" x="230" y="-56138.47" font-family="Arial" font-size="10.00">Layer 24 SiLU GPU2</text>
<text text-anchor="middle" x="230" y="-56127.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="230" y="-56116.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer24_ffn1_2&#45;&gt;layer24_act_2 -->
<g id="edge400" class="edge">
<title>layer24_ffn1_2&#45;&gt;layer24_act_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M230,-56225.41C230,-56207.96 230,-56183.55 230,-56163.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="233.5,-56163.86 230,-56153.86 226.5,-56163.86 233.5,-56163.86"/>
</g>
<!-- layer24_act_3 -->
<g id="node352" class="node">
<title>layer24_act_3</title>
<path fill="#e6f3ff" stroke="black" d="M695,-56153.47C695,-56153.47 425,-56153.47 425,-56153.47 419,-56153.47 413,-56147.47 413,-56141.47 413,-56141.47 413,-56118.47 413,-56118.47 413,-56112.47 419,-56106.47 425,-56106.47 425,-56106.47 695,-56106.47 695,-56106.47 701,-56106.47 707,-56112.47 707,-56118.47 707,-56118.47 707,-56141.47 707,-56141.47 707,-56147.47 701,-56153.47 695,-56153.47"/>
<text text-anchor="middle" x="560" y="-56138.47" font-family="Arial" font-size="10.00">Layer 24 SiLU GPU3</text>
<text text-anchor="middle" x="560" y="-56127.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="560" y="-56116.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer24_ffn1_3&#45;&gt;layer24_act_3 -->
<g id="edge401" class="edge">
<title>layer24_ffn1_3&#45;&gt;layer24_act_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M560,-56225.41C560,-56207.96 560,-56183.55 560,-56163.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="563.5,-56163.86 560,-56153.86 556.5,-56163.86 563.5,-56163.86"/>
</g>
<!-- layer24_ffn2_2 -->
<g id="node353" class="node">
<title>layer24_ffn2_2</title>
<path fill="#e6f3ff" stroke="black" d="M364.5,-56034.47C364.5,-56034.47 101.5,-56034.47 101.5,-56034.47 95.5,-56034.47 89.5,-56028.47 89.5,-56022.47 89.5,-56022.47 89.5,-55999.47 89.5,-55999.47 89.5,-55993.47 95.5,-55987.47 101.5,-55987.47 101.5,-55987.47 364.5,-55987.47 364.5,-55987.47 370.5,-55987.47 376.5,-55993.47 376.5,-55999.47 376.5,-55999.47 376.5,-56022.47 376.5,-56022.47 376.5,-56028.47 370.5,-56034.47 364.5,-56034.47"/>
<text text-anchor="middle" x="233" y="-56019.47" font-family="Arial" font-size="10.00">Layer 24 FFN2 GPU2</text>
<text text-anchor="middle" x="233" y="-56008.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="233" y="-55997.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer24_act_2&#45;&gt;layer24_ffn2_2 -->
<g id="edge402" class="edge">
<title>layer24_act_2&#45;&gt;layer24_ffn2_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M230.58,-56106.41C231.03,-56088.96 231.65,-56064.55 232.16,-56044.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="235.66,-56044.94 232.41,-56034.86 228.66,-56044.76 235.66,-56044.94"/>
</g>
<!-- layer24_ffn2_3 -->
<g id="node354" class="node">
<title>layer24_ffn2_3</title>
<path fill="#e6f3ff" stroke="black" d="M689.5,-56034.47C689.5,-56034.47 426.5,-56034.47 426.5,-56034.47 420.5,-56034.47 414.5,-56028.47 414.5,-56022.47 414.5,-56022.47 414.5,-55999.47 414.5,-55999.47 414.5,-55993.47 420.5,-55987.47 426.5,-55987.47 426.5,-55987.47 689.5,-55987.47 689.5,-55987.47 695.5,-55987.47 701.5,-55993.47 701.5,-55999.47 701.5,-55999.47 701.5,-56022.47 701.5,-56022.47 701.5,-56028.47 695.5,-56034.47 689.5,-56034.47"/>
<text text-anchor="middle" x="558" y="-56019.47" font-family="Arial" font-size="10.00">Layer 24 FFN2 GPU3</text>
<text text-anchor="middle" x="558" y="-56008.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="558" y="-55997.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer24_act_3&#45;&gt;layer24_ffn2_3 -->
<g id="edge403" class="edge">
<title>layer24_act_3&#45;&gt;layer24_ffn2_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M559.61,-56106.41C559.32,-56088.96 558.9,-56064.55 558.56,-56044.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="562.06,-56044.8 558.39,-56034.86 555.06,-56044.92 562.06,-56044.8"/>
</g>
<!-- layer24_ffn_ar -->
<g id="node355" class="node">
<title>layer24_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M526.22,-55915.47C526.22,-55915.47 320.8,-55915.47 320.8,-55915.47 314.8,-55915.47 305,-55910.83 301.19,-55906.19 301.19,-55906.19 257.39,-55852.75 257.39,-55852.75 253.59,-55848.11 255.78,-55843.47 261.78,-55843.47 261.78,-55843.47 467.2,-55843.47 467.2,-55843.47 473.2,-55843.47 483,-55848.11 486.81,-55852.75 486.81,-55852.75 530.61,-55906.19 530.61,-55906.19 534.41,-55910.83 532.22,-55915.47 526.22,-55915.47"/>
<text text-anchor="middle" x="394" y="-55882.47" font-family="Arial" font-size="10.00">Layer 24 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="394" y="-55871.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer24_ffn2_2&#45;&gt;layer24_ffn_ar -->
<g id="edge404" class="edge">
<title>layer24_ffn2_2&#45;&gt;layer24_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M261.04,-55987.41C283.43,-55969.41 315.4,-55943.69 342.38,-55921.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="344.61,-55924.68 350.21,-55915.69 340.23,-55919.23 344.61,-55924.68"/>
</g>
<!-- layer24_ffn2_3&#45;&gt;layer24_ffn_ar -->
<g id="edge405" class="edge">
<title>layer24_ffn2_3&#45;&gt;layer24_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M529.43,-55987.41C506.63,-55969.41 474.06,-55943.69 446.58,-55921.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="448.62,-55919.14 438.6,-55915.69 444.28,-55924.63 448.62,-55919.14"/>
</g>
<!-- layer25_qkv_2 -->
<g id="node356" class="node">
<title>layer25_qkv_2</title>
<path fill="#e6f3ff" stroke="black" d="M364,-55771.47C364,-55771.47 66,-55771.47 66,-55771.47 60,-55771.47 54,-55765.47 54,-55759.47 54,-55759.47 54,-55736.47 54,-55736.47 54,-55730.47 60,-55724.47 66,-55724.47 66,-55724.47 364,-55724.47 364,-55724.47 370,-55724.47 376,-55730.47 376,-55736.47 376,-55736.47 376,-55759.47 376,-55759.47 376,-55765.47 370,-55771.47 364,-55771.47"/>
<text text-anchor="middle" x="215" y="-55756.47" font-family="Arial" font-size="10.00">Layer 25 QKV Proj GPU2</text>
<text text-anchor="middle" x="215" y="-55745.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="215" y="-55734.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer24_ffn_ar&#45;&gt;layer25_qkv_2 -->
<g id="edge406" class="edge">
<title>layer24_ffn_ar&#45;&gt;layer25_qkv_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M345.56,-55843.42C317.06,-55822.81 281.48,-55797.06 254.66,-55777.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="256.43,-55774.62 246.28,-55771.6 252.33,-55780.3 256.43,-55774.62"/>
</g>
<!-- layer25_qkv_3 -->
<g id="node357" class="node">
<title>layer25_qkv_3</title>
<path fill="#e6f3ff" stroke="black" d="M722,-55771.47C722,-55771.47 424,-55771.47 424,-55771.47 418,-55771.47 412,-55765.47 412,-55759.47 412,-55759.47 412,-55736.47 412,-55736.47 412,-55730.47 418,-55724.47 424,-55724.47 424,-55724.47 722,-55724.47 722,-55724.47 728,-55724.47 734,-55730.47 734,-55736.47 734,-55736.47 734,-55759.47 734,-55759.47 734,-55765.47 728,-55771.47 722,-55771.47"/>
<text text-anchor="middle" x="573" y="-55756.47" font-family="Arial" font-size="10.00">Layer 25 QKV Proj GPU3</text>
<text text-anchor="middle" x="573" y="-55745.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="573" y="-55734.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer24_ffn_ar&#45;&gt;layer25_qkv_3 -->
<g id="edge407" class="edge">
<title>layer24_ffn_ar&#45;&gt;layer25_qkv_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M442.44,-55843.42C470.94,-55822.81 506.52,-55797.06 533.34,-55777.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="535.67,-55780.3 541.72,-55771.6 531.57,-55774.62 535.67,-55780.3"/>
</g>
<!-- layer25_attn_2 -->
<g id="node358" class="node">
<title>layer25_attn_2</title>
<path fill="#e6f3ff" stroke="black" d="M364,-55652.47C364,-55652.47 66,-55652.47 66,-55652.47 60,-55652.47 54,-55646.47 54,-55640.47 54,-55640.47 54,-55617.47 54,-55617.47 54,-55611.47 60,-55605.47 66,-55605.47 66,-55605.47 364,-55605.47 364,-55605.47 370,-55605.47 376,-55611.47 376,-55617.47 376,-55617.47 376,-55640.47 376,-55640.47 376,-55646.47 370,-55652.47 364,-55652.47"/>
<text text-anchor="middle" x="215" y="-55637.47" font-family="Arial" font-size="10.00">Layer 25 Attention GPU2</text>
<text text-anchor="middle" x="215" y="-55626.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="215" y="-55615.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer25_qkv_2&#45;&gt;layer25_attn_2 -->
<g id="edge408" class="edge">
<title>layer25_qkv_2&#45;&gt;layer25_attn_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M215,-55724.41C215,-55706.96 215,-55682.55 215,-55662.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="218.5,-55662.86 215,-55652.86 211.5,-55662.86 218.5,-55662.86"/>
</g>
<!-- layer25_attn_3 -->
<g id="node359" class="node">
<title>layer25_attn_3</title>
<path fill="#e6f3ff" stroke="black" d="M722,-55652.47C722,-55652.47 424,-55652.47 424,-55652.47 418,-55652.47 412,-55646.47 412,-55640.47 412,-55640.47 412,-55617.47 412,-55617.47 412,-55611.47 418,-55605.47 424,-55605.47 424,-55605.47 722,-55605.47 722,-55605.47 728,-55605.47 734,-55611.47 734,-55617.47 734,-55617.47 734,-55640.47 734,-55640.47 734,-55646.47 728,-55652.47 722,-55652.47"/>
<text text-anchor="middle" x="573" y="-55637.47" font-family="Arial" font-size="10.00">Layer 25 Attention GPU3</text>
<text text-anchor="middle" x="573" y="-55626.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="573" y="-55615.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer25_qkv_3&#45;&gt;layer25_attn_3 -->
<g id="edge409" class="edge">
<title>layer25_qkv_3&#45;&gt;layer25_attn_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M573,-55724.41C573,-55706.96 573,-55682.55 573,-55662.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="576.5,-55662.86 573,-55652.86 569.5,-55662.86 576.5,-55662.86"/>
</g>
<!-- layer25_attn_out_2 -->
<g id="node360" class="node">
<title>layer25_attn_out_2</title>
<path fill="#e6f3ff" stroke="black" d="M364,-55533.47C364,-55533.47 74,-55533.47 74,-55533.47 68,-55533.47 62,-55527.47 62,-55521.47 62,-55521.47 62,-55498.47 62,-55498.47 62,-55492.47 68,-55486.47 74,-55486.47 74,-55486.47 364,-55486.47 364,-55486.47 370,-55486.47 376,-55492.47 376,-55498.47 376,-55498.47 376,-55521.47 376,-55521.47 376,-55527.47 370,-55533.47 364,-55533.47"/>
<text text-anchor="middle" x="219" y="-55518.47" font-family="Arial" font-size="10.00">Layer 25 Attn Out GPU2</text>
<text text-anchor="middle" x="219" y="-55507.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="219" y="-55496.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer25_attn_2&#45;&gt;layer25_attn_out_2 -->
<g id="edge410" class="edge">
<title>layer25_attn_2&#45;&gt;layer25_attn_out_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M215.77,-55605.41C216.37,-55587.96 217.2,-55563.55 217.87,-55543.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="221.37,-55543.97 218.22,-55533.86 214.38,-55543.73 221.37,-55543.97"/>
</g>
<!-- layer25_attn_out_3 -->
<g id="node361" class="node">
<title>layer25_attn_out_3</title>
<path fill="#e6f3ff" stroke="black" d="M716,-55533.47C716,-55533.47 426,-55533.47 426,-55533.47 420,-55533.47 414,-55527.47 414,-55521.47 414,-55521.47 414,-55498.47 414,-55498.47 414,-55492.47 420,-55486.47 426,-55486.47 426,-55486.47 716,-55486.47 716,-55486.47 722,-55486.47 728,-55492.47 728,-55498.47 728,-55498.47 728,-55521.47 728,-55521.47 728,-55527.47 722,-55533.47 716,-55533.47"/>
<text text-anchor="middle" x="571" y="-55518.47" font-family="Arial" font-size="10.00">Layer 25 Attn Out GPU3</text>
<text text-anchor="middle" x="571" y="-55507.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="571" y="-55496.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer25_attn_3&#45;&gt;layer25_attn_out_3 -->
<g id="edge411" class="edge">
<title>layer25_attn_3&#45;&gt;layer25_attn_out_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M572.61,-55605.41C572.32,-55587.96 571.9,-55563.55 571.56,-55543.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="575.06,-55543.8 571.39,-55533.86 568.06,-55543.92 575.06,-55543.8"/>
</g>
<!-- layer25_attn_ar -->
<g id="node362" class="node">
<title>layer25_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M524.07,-55414.47C524.07,-55414.47 322.07,-55414.47 322.07,-55414.47 316.07,-55414.47 306.3,-55409.8 302.53,-55405.13 302.53,-55405.13 259.47,-55351.8 259.47,-55351.8 255.7,-55347.14 257.93,-55342.47 263.93,-55342.47 263.93,-55342.47 465.93,-55342.47 465.93,-55342.47 471.93,-55342.47 481.7,-55347.14 485.47,-55351.8 485.47,-55351.8 528.53,-55405.13 528.53,-55405.13 532.3,-55409.8 530.07,-55414.47 524.07,-55414.47"/>
<text text-anchor="middle" x="394" y="-55381.47" font-family="Arial" font-size="10.00">Layer 25 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="394" y="-55370.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer25_attn_out_2&#45;&gt;layer25_attn_ar -->
<g id="edge412" class="edge">
<title>layer25_attn_out_2&#45;&gt;layer25_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M249.48,-55486.41C273.92,-55468.33 308.86,-55442.47 338.27,-55420.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="340.45,-55423.45 346.4,-55414.69 336.28,-55417.82 340.45,-55423.45"/>
</g>
<!-- layer25_attn_out_3&#45;&gt;layer25_attn_ar -->
<g id="edge413" class="edge">
<title>layer25_attn_out_3&#45;&gt;layer25_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M540.17,-55486.41C515.45,-55468.33 480.11,-55442.47 450.37,-55420.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="452.28,-55417.77 442.14,-55414.69 448.14,-55423.42 452.28,-55417.77"/>
</g>
<!-- layer25_ffn1_2 -->
<g id="node363" class="node">
<title>layer25_ffn1_2</title>
<path fill="#e6f3ff" stroke="black" d="M364,-55270.47C364,-55270.47 94,-55270.47 94,-55270.47 88,-55270.47 82,-55264.47 82,-55258.47 82,-55258.47 82,-55235.47 82,-55235.47 82,-55229.47 88,-55223.47 94,-55223.47 94,-55223.47 364,-55223.47 364,-55223.47 370,-55223.47 376,-55229.47 376,-55235.47 376,-55235.47 376,-55258.47 376,-55258.47 376,-55264.47 370,-55270.47 364,-55270.47"/>
<text text-anchor="middle" x="229" y="-55255.47" font-family="Arial" font-size="10.00">Layer 25 FFN1 GPU2</text>
<text text-anchor="middle" x="229" y="-55244.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="229" y="-55233.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer25_attn_ar&#45;&gt;layer25_ffn1_2 -->
<g id="edge414" class="edge">
<title>layer25_attn_ar&#45;&gt;layer25_ffn1_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M349.35,-55342.42C323.28,-55321.96 290.78,-55296.45 266.12,-55277.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="268.11,-55274.21 258.08,-55270.79 263.79,-55279.72 268.11,-55274.21"/>
</g>
<!-- layer25_ffn1_3 -->
<g id="node364" class="node">
<title>layer25_ffn1_3</title>
<path fill="#e6f3ff" stroke="black" d="M694,-55270.47C694,-55270.47 424,-55270.47 424,-55270.47 418,-55270.47 412,-55264.47 412,-55258.47 412,-55258.47 412,-55235.47 412,-55235.47 412,-55229.47 418,-55223.47 424,-55223.47 424,-55223.47 694,-55223.47 694,-55223.47 700,-55223.47 706,-55229.47 706,-55235.47 706,-55235.47 706,-55258.47 706,-55258.47 706,-55264.47 700,-55270.47 694,-55270.47"/>
<text text-anchor="middle" x="559" y="-55255.47" font-family="Arial" font-size="10.00">Layer 25 FFN1 GPU3</text>
<text text-anchor="middle" x="559" y="-55244.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-55233.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer25_attn_ar&#45;&gt;layer25_ffn1_3 -->
<g id="edge415" class="edge">
<title>layer25_attn_ar&#45;&gt;layer25_ffn1_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M438.65,-55342.42C464.72,-55321.96 497.22,-55296.45 521.88,-55277.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="524.21,-55279.72 529.92,-55270.79 519.89,-55274.21 524.21,-55279.72"/>
</g>
<!-- layer25_act_2 -->
<g id="node365" class="node">
<title>layer25_act_2</title>
<path fill="#e6f3ff" stroke="black" d="M364,-55151.47C364,-55151.47 94,-55151.47 94,-55151.47 88,-55151.47 82,-55145.47 82,-55139.47 82,-55139.47 82,-55116.47 82,-55116.47 82,-55110.47 88,-55104.47 94,-55104.47 94,-55104.47 364,-55104.47 364,-55104.47 370,-55104.47 376,-55110.47 376,-55116.47 376,-55116.47 376,-55139.47 376,-55139.47 376,-55145.47 370,-55151.47 364,-55151.47"/>
<text text-anchor="middle" x="229" y="-55136.47" font-family="Arial" font-size="10.00">Layer 25 SiLU GPU2</text>
<text text-anchor="middle" x="229" y="-55125.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="229" y="-55114.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer25_ffn1_2&#45;&gt;layer25_act_2 -->
<g id="edge416" class="edge">
<title>layer25_ffn1_2&#45;&gt;layer25_act_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M229,-55223.41C229,-55205.96 229,-55181.55 229,-55161.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="232.5,-55161.86 229,-55151.86 225.5,-55161.86 232.5,-55161.86"/>
</g>
<!-- layer25_act_3 -->
<g id="node366" class="node">
<title>layer25_act_3</title>
<path fill="#e6f3ff" stroke="black" d="M694,-55151.47C694,-55151.47 424,-55151.47 424,-55151.47 418,-55151.47 412,-55145.47 412,-55139.47 412,-55139.47 412,-55116.47 412,-55116.47 412,-55110.47 418,-55104.47 424,-55104.47 424,-55104.47 694,-55104.47 694,-55104.47 700,-55104.47 706,-55110.47 706,-55116.47 706,-55116.47 706,-55139.47 706,-55139.47 706,-55145.47 700,-55151.47 694,-55151.47"/>
<text text-anchor="middle" x="559" y="-55136.47" font-family="Arial" font-size="10.00">Layer 25 SiLU GPU3</text>
<text text-anchor="middle" x="559" y="-55125.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="559" y="-55114.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer25_ffn1_3&#45;&gt;layer25_act_3 -->
<g id="edge417" class="edge">
<title>layer25_ffn1_3&#45;&gt;layer25_act_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M559,-55223.41C559,-55205.96 559,-55181.55 559,-55161.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="562.5,-55161.86 559,-55151.86 555.5,-55161.86 562.5,-55161.86"/>
</g>
<!-- layer25_ffn2_2 -->
<g id="node367" class="node">
<title>layer25_ffn2_2</title>
<path fill="#e6f3ff" stroke="black" d="M363.5,-55032.47C363.5,-55032.47 100.5,-55032.47 100.5,-55032.47 94.5,-55032.47 88.5,-55026.47 88.5,-55020.47 88.5,-55020.47 88.5,-54997.47 88.5,-54997.47 88.5,-54991.47 94.5,-54985.47 100.5,-54985.47 100.5,-54985.47 363.5,-54985.47 363.5,-54985.47 369.5,-54985.47 375.5,-54991.47 375.5,-54997.47 375.5,-54997.47 375.5,-55020.47 375.5,-55020.47 375.5,-55026.47 369.5,-55032.47 363.5,-55032.47"/>
<text text-anchor="middle" x="232" y="-55017.47" font-family="Arial" font-size="10.00">Layer 25 FFN2 GPU2</text>
<text text-anchor="middle" x="232" y="-55006.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="232" y="-54995.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer25_act_2&#45;&gt;layer25_ffn2_2 -->
<g id="edge418" class="edge">
<title>layer25_act_2&#45;&gt;layer25_ffn2_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M229.58,-55104.41C230.03,-55086.96 230.65,-55062.55 231.16,-55042.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="234.66,-55042.94 231.41,-55032.86 227.66,-55042.76 234.66,-55042.94"/>
</g>
<!-- layer25_ffn2_3 -->
<g id="node368" class="node">
<title>layer25_ffn2_3</title>
<path fill="#e6f3ff" stroke="black" d="M688.5,-55032.47C688.5,-55032.47 425.5,-55032.47 425.5,-55032.47 419.5,-55032.47 413.5,-55026.47 413.5,-55020.47 413.5,-55020.47 413.5,-54997.47 413.5,-54997.47 413.5,-54991.47 419.5,-54985.47 425.5,-54985.47 425.5,-54985.47 688.5,-54985.47 688.5,-54985.47 694.5,-54985.47 700.5,-54991.47 700.5,-54997.47 700.5,-54997.47 700.5,-55020.47 700.5,-55020.47 700.5,-55026.47 694.5,-55032.47 688.5,-55032.47"/>
<text text-anchor="middle" x="557" y="-55017.47" font-family="Arial" font-size="10.00">Layer 25 FFN2 GPU3</text>
<text text-anchor="middle" x="557" y="-55006.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="557" y="-54995.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer25_act_3&#45;&gt;layer25_ffn2_3 -->
<g id="edge419" class="edge">
<title>layer25_act_3&#45;&gt;layer25_ffn2_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M558.61,-55104.41C558.32,-55086.96 557.9,-55062.55 557.56,-55042.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="561.06,-55042.8 557.39,-55032.86 554.06,-55042.92 561.06,-55042.8"/>
</g>
<!-- layer25_ffn_ar -->
<g id="node369" class="node">
<title>layer25_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M525.22,-54913.47C525.22,-54913.47 319.8,-54913.47 319.8,-54913.47 313.8,-54913.47 304,-54908.83 300.19,-54904.19 300.19,-54904.19 256.39,-54850.75 256.39,-54850.75 252.59,-54846.11 254.78,-54841.47 260.78,-54841.47 260.78,-54841.47 466.2,-54841.47 466.2,-54841.47 472.2,-54841.47 482,-54846.11 485.81,-54850.75 485.81,-54850.75 529.61,-54904.19 529.61,-54904.19 533.41,-54908.83 531.22,-54913.47 525.22,-54913.47"/>
<text text-anchor="middle" x="393" y="-54880.47" font-family="Arial" font-size="10.00">Layer 25 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="393" y="-54869.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer25_ffn2_2&#45;&gt;layer25_ffn_ar -->
<g id="edge420" class="edge">
<title>layer25_ffn2_2&#45;&gt;layer25_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M260.04,-54985.41C282.43,-54967.41 314.4,-54941.69 341.38,-54919.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="343.61,-54922.68 349.21,-54913.69 339.23,-54917.23 343.61,-54922.68"/>
</g>
<!-- layer25_ffn2_3&#45;&gt;layer25_ffn_ar -->
<g id="edge421" class="edge">
<title>layer25_ffn2_3&#45;&gt;layer25_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M528.43,-54985.41C505.63,-54967.41 473.06,-54941.69 445.58,-54919.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="447.62,-54917.14 437.6,-54913.69 443.28,-54922.63 447.62,-54917.14"/>
</g>
<!-- layer26_qkv_2 -->
<g id="node370" class="node">
<title>layer26_qkv_2</title>
<path fill="#e6f3ff" stroke="black" d="M363,-54769.47C363,-54769.47 65,-54769.47 65,-54769.47 59,-54769.47 53,-54763.47 53,-54757.47 53,-54757.47 53,-54734.47 53,-54734.47 53,-54728.47 59,-54722.47 65,-54722.47 65,-54722.47 363,-54722.47 363,-54722.47 369,-54722.47 375,-54728.47 375,-54734.47 375,-54734.47 375,-54757.47 375,-54757.47 375,-54763.47 369,-54769.47 363,-54769.47"/>
<text text-anchor="middle" x="214" y="-54754.47" font-family="Arial" font-size="10.00">Layer 26 QKV Proj GPU2</text>
<text text-anchor="middle" x="214" y="-54743.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="214" y="-54732.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer25_ffn_ar&#45;&gt;layer26_qkv_2 -->
<g id="edge422" class="edge">
<title>layer25_ffn_ar&#45;&gt;layer26_qkv_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M344.56,-54841.42C316.06,-54820.81 280.48,-54795.06 253.66,-54775.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="255.43,-54772.62 245.28,-54769.6 251.33,-54778.3 255.43,-54772.62"/>
</g>
<!-- layer26_qkv_3 -->
<g id="node371" class="node">
<title>layer26_qkv_3</title>
<path fill="#e6f3ff" stroke="black" d="M721,-54769.47C721,-54769.47 423,-54769.47 423,-54769.47 417,-54769.47 411,-54763.47 411,-54757.47 411,-54757.47 411,-54734.47 411,-54734.47 411,-54728.47 417,-54722.47 423,-54722.47 423,-54722.47 721,-54722.47 721,-54722.47 727,-54722.47 733,-54728.47 733,-54734.47 733,-54734.47 733,-54757.47 733,-54757.47 733,-54763.47 727,-54769.47 721,-54769.47"/>
<text text-anchor="middle" x="572" y="-54754.47" font-family="Arial" font-size="10.00">Layer 26 QKV Proj GPU3</text>
<text text-anchor="middle" x="572" y="-54743.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="572" y="-54732.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer25_ffn_ar&#45;&gt;layer26_qkv_3 -->
<g id="edge423" class="edge">
<title>layer25_ffn_ar&#45;&gt;layer26_qkv_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M441.44,-54841.42C469.94,-54820.81 505.52,-54795.06 532.34,-54775.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="534.67,-54778.3 540.72,-54769.6 530.57,-54772.62 534.67,-54778.3"/>
</g>
<!-- layer26_attn_2 -->
<g id="node372" class="node">
<title>layer26_attn_2</title>
<path fill="#e6f3ff" stroke="black" d="M363,-54650.47C363,-54650.47 65,-54650.47 65,-54650.47 59,-54650.47 53,-54644.47 53,-54638.47 53,-54638.47 53,-54615.47 53,-54615.47 53,-54609.47 59,-54603.47 65,-54603.47 65,-54603.47 363,-54603.47 363,-54603.47 369,-54603.47 375,-54609.47 375,-54615.47 375,-54615.47 375,-54638.47 375,-54638.47 375,-54644.47 369,-54650.47 363,-54650.47"/>
<text text-anchor="middle" x="214" y="-54635.47" font-family="Arial" font-size="10.00">Layer 26 Attention GPU2</text>
<text text-anchor="middle" x="214" y="-54624.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="214" y="-54613.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer26_qkv_2&#45;&gt;layer26_attn_2 -->
<g id="edge424" class="edge">
<title>layer26_qkv_2&#45;&gt;layer26_attn_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M214,-54722.41C214,-54704.96 214,-54680.55 214,-54660.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="217.5,-54660.86 214,-54650.86 210.5,-54660.86 217.5,-54660.86"/>
</g>
<!-- layer26_attn_3 -->
<g id="node373" class="node">
<title>layer26_attn_3</title>
<path fill="#e6f3ff" stroke="black" d="M721,-54650.47C721,-54650.47 423,-54650.47 423,-54650.47 417,-54650.47 411,-54644.47 411,-54638.47 411,-54638.47 411,-54615.47 411,-54615.47 411,-54609.47 417,-54603.47 423,-54603.47 423,-54603.47 721,-54603.47 721,-54603.47 727,-54603.47 733,-54609.47 733,-54615.47 733,-54615.47 733,-54638.47 733,-54638.47 733,-54644.47 727,-54650.47 721,-54650.47"/>
<text text-anchor="middle" x="572" y="-54635.47" font-family="Arial" font-size="10.00">Layer 26 Attention GPU3</text>
<text text-anchor="middle" x="572" y="-54624.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="572" y="-54613.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer26_qkv_3&#45;&gt;layer26_attn_3 -->
<g id="edge425" class="edge">
<title>layer26_qkv_3&#45;&gt;layer26_attn_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M572,-54722.41C572,-54704.96 572,-54680.55 572,-54660.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="575.5,-54660.86 572,-54650.86 568.5,-54660.86 575.5,-54660.86"/>
</g>
<!-- layer26_attn_out_2 -->
<g id="node374" class="node">
<title>layer26_attn_out_2</title>
<path fill="#e6f3ff" stroke="black" d="M363,-54531.47C363,-54531.47 73,-54531.47 73,-54531.47 67,-54531.47 61,-54525.47 61,-54519.47 61,-54519.47 61,-54496.47 61,-54496.47 61,-54490.47 67,-54484.47 73,-54484.47 73,-54484.47 363,-54484.47 363,-54484.47 369,-54484.47 375,-54490.47 375,-54496.47 375,-54496.47 375,-54519.47 375,-54519.47 375,-54525.47 369,-54531.47 363,-54531.47"/>
<text text-anchor="middle" x="218" y="-54516.47" font-family="Arial" font-size="10.00">Layer 26 Attn Out GPU2</text>
<text text-anchor="middle" x="218" y="-54505.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="218" y="-54494.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer26_attn_2&#45;&gt;layer26_attn_out_2 -->
<g id="edge426" class="edge">
<title>layer26_attn_2&#45;&gt;layer26_attn_out_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M214.77,-54603.41C215.37,-54585.96 216.2,-54561.55 216.87,-54541.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="220.37,-54541.97 217.22,-54531.86 213.38,-54541.73 220.37,-54541.97"/>
</g>
<!-- layer26_attn_out_3 -->
<g id="node375" class="node">
<title>layer26_attn_out_3</title>
<path fill="#e6f3ff" stroke="black" d="M715,-54531.47C715,-54531.47 425,-54531.47 425,-54531.47 419,-54531.47 413,-54525.47 413,-54519.47 413,-54519.47 413,-54496.47 413,-54496.47 413,-54490.47 419,-54484.47 425,-54484.47 425,-54484.47 715,-54484.47 715,-54484.47 721,-54484.47 727,-54490.47 727,-54496.47 727,-54496.47 727,-54519.47 727,-54519.47 727,-54525.47 721,-54531.47 715,-54531.47"/>
<text text-anchor="middle" x="570" y="-54516.47" font-family="Arial" font-size="10.00">Layer 26 Attn Out GPU3</text>
<text text-anchor="middle" x="570" y="-54505.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="570" y="-54494.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer26_attn_3&#45;&gt;layer26_attn_out_3 -->
<g id="edge427" class="edge">
<title>layer26_attn_3&#45;&gt;layer26_attn_out_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M571.61,-54603.41C571.32,-54585.96 570.9,-54561.55 570.56,-54541.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="574.06,-54541.8 570.39,-54531.86 567.06,-54541.92 574.06,-54541.8"/>
</g>
<!-- layer26_attn_ar -->
<g id="node376" class="node">
<title>layer26_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M523.07,-54412.47C523.07,-54412.47 321.07,-54412.47 321.07,-54412.47 315.07,-54412.47 305.3,-54407.8 301.53,-54403.13 301.53,-54403.13 258.47,-54349.8 258.47,-54349.8 254.7,-54345.14 256.93,-54340.47 262.93,-54340.47 262.93,-54340.47 464.93,-54340.47 464.93,-54340.47 470.93,-54340.47 480.7,-54345.14 484.47,-54349.8 484.47,-54349.8 527.53,-54403.13 527.53,-54403.13 531.3,-54407.8 529.07,-54412.47 523.07,-54412.47"/>
<text text-anchor="middle" x="393" y="-54379.47" font-family="Arial" font-size="10.00">Layer 26 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="393" y="-54368.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer26_attn_out_2&#45;&gt;layer26_attn_ar -->
<g id="edge428" class="edge">
<title>layer26_attn_out_2&#45;&gt;layer26_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M248.48,-54484.41C272.92,-54466.33 307.86,-54440.47 337.27,-54418.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="339.45,-54421.45 345.4,-54412.69 335.28,-54415.82 339.45,-54421.45"/>
</g>
<!-- layer26_attn_out_3&#45;&gt;layer26_attn_ar -->
<g id="edge429" class="edge">
<title>layer26_attn_out_3&#45;&gt;layer26_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M539.17,-54484.41C514.45,-54466.33 479.11,-54440.47 449.37,-54418.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="451.28,-54415.77 441.14,-54412.69 447.14,-54421.42 451.28,-54415.77"/>
</g>
<!-- layer26_ffn1_2 -->
<g id="node377" class="node">
<title>layer26_ffn1_2</title>
<path fill="#e6f3ff" stroke="black" d="M363,-54268.47C363,-54268.47 93,-54268.47 93,-54268.47 87,-54268.47 81,-54262.47 81,-54256.47 81,-54256.47 81,-54233.47 81,-54233.47 81,-54227.47 87,-54221.47 93,-54221.47 93,-54221.47 363,-54221.47 363,-54221.47 369,-54221.47 375,-54227.47 375,-54233.47 375,-54233.47 375,-54256.47 375,-54256.47 375,-54262.47 369,-54268.47 363,-54268.47"/>
<text text-anchor="middle" x="228" y="-54253.47" font-family="Arial" font-size="10.00">Layer 26 FFN1 GPU2</text>
<text text-anchor="middle" x="228" y="-54242.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="228" y="-54231.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer26_attn_ar&#45;&gt;layer26_ffn1_2 -->
<g id="edge430" class="edge">
<title>layer26_attn_ar&#45;&gt;layer26_ffn1_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M348.35,-54340.42C322.28,-54319.96 289.78,-54294.45 265.12,-54275.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="267.11,-54272.21 257.08,-54268.79 262.79,-54277.72 267.11,-54272.21"/>
</g>
<!-- layer26_ffn1_3 -->
<g id="node378" class="node">
<title>layer26_ffn1_3</title>
<path fill="#e6f3ff" stroke="black" d="M693,-54268.47C693,-54268.47 423,-54268.47 423,-54268.47 417,-54268.47 411,-54262.47 411,-54256.47 411,-54256.47 411,-54233.47 411,-54233.47 411,-54227.47 417,-54221.47 423,-54221.47 423,-54221.47 693,-54221.47 693,-54221.47 699,-54221.47 705,-54227.47 705,-54233.47 705,-54233.47 705,-54256.47 705,-54256.47 705,-54262.47 699,-54268.47 693,-54268.47"/>
<text text-anchor="middle" x="558" y="-54253.47" font-family="Arial" font-size="10.00">Layer 26 FFN1 GPU3</text>
<text text-anchor="middle" x="558" y="-54242.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="558" y="-54231.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer26_attn_ar&#45;&gt;layer26_ffn1_3 -->
<g id="edge431" class="edge">
<title>layer26_attn_ar&#45;&gt;layer26_ffn1_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M437.65,-54340.42C463.72,-54319.96 496.22,-54294.45 520.88,-54275.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="523.21,-54277.72 528.92,-54268.79 518.89,-54272.21 523.21,-54277.72"/>
</g>
<!-- layer26_act_2 -->
<g id="node379" class="node">
<title>layer26_act_2</title>
<path fill="#e6f3ff" stroke="black" d="M363,-54149.47C363,-54149.47 93,-54149.47 93,-54149.47 87,-54149.47 81,-54143.47 81,-54137.47 81,-54137.47 81,-54114.47 81,-54114.47 81,-54108.47 87,-54102.47 93,-54102.47 93,-54102.47 363,-54102.47 363,-54102.47 369,-54102.47 375,-54108.47 375,-54114.47 375,-54114.47 375,-54137.47 375,-54137.47 375,-54143.47 369,-54149.47 363,-54149.47"/>
<text text-anchor="middle" x="228" y="-54134.47" font-family="Arial" font-size="10.00">Layer 26 SiLU GPU2</text>
<text text-anchor="middle" x="228" y="-54123.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="228" y="-54112.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer26_ffn1_2&#45;&gt;layer26_act_2 -->
<g id="edge432" class="edge">
<title>layer26_ffn1_2&#45;&gt;layer26_act_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M228,-54221.41C228,-54203.96 228,-54179.55 228,-54159.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="231.5,-54159.86 228,-54149.86 224.5,-54159.86 231.5,-54159.86"/>
</g>
<!-- layer26_act_3 -->
<g id="node380" class="node">
<title>layer26_act_3</title>
<path fill="#e6f3ff" stroke="black" d="M693,-54149.47C693,-54149.47 423,-54149.47 423,-54149.47 417,-54149.47 411,-54143.47 411,-54137.47 411,-54137.47 411,-54114.47 411,-54114.47 411,-54108.47 417,-54102.47 423,-54102.47 423,-54102.47 693,-54102.47 693,-54102.47 699,-54102.47 705,-54108.47 705,-54114.47 705,-54114.47 705,-54137.47 705,-54137.47 705,-54143.47 699,-54149.47 693,-54149.47"/>
<text text-anchor="middle" x="558" y="-54134.47" font-family="Arial" font-size="10.00">Layer 26 SiLU GPU3</text>
<text text-anchor="middle" x="558" y="-54123.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="558" y="-54112.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer26_ffn1_3&#45;&gt;layer26_act_3 -->
<g id="edge433" class="edge">
<title>layer26_ffn1_3&#45;&gt;layer26_act_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M558,-54221.41C558,-54203.96 558,-54179.55 558,-54159.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="561.5,-54159.86 558,-54149.86 554.5,-54159.86 561.5,-54159.86"/>
</g>
<!-- layer26_ffn2_2 -->
<g id="node381" class="node">
<title>layer26_ffn2_2</title>
<path fill="#e6f3ff" stroke="black" d="M362.5,-54030.47C362.5,-54030.47 99.5,-54030.47 99.5,-54030.47 93.5,-54030.47 87.5,-54024.47 87.5,-54018.47 87.5,-54018.47 87.5,-53995.47 87.5,-53995.47 87.5,-53989.47 93.5,-53983.47 99.5,-53983.47 99.5,-53983.47 362.5,-53983.47 362.5,-53983.47 368.5,-53983.47 374.5,-53989.47 374.5,-53995.47 374.5,-53995.47 374.5,-54018.47 374.5,-54018.47 374.5,-54024.47 368.5,-54030.47 362.5,-54030.47"/>
<text text-anchor="middle" x="231" y="-54015.47" font-family="Arial" font-size="10.00">Layer 26 FFN2 GPU2</text>
<text text-anchor="middle" x="231" y="-54004.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="231" y="-53993.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer26_act_2&#45;&gt;layer26_ffn2_2 -->
<g id="edge434" class="edge">
<title>layer26_act_2&#45;&gt;layer26_ffn2_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M228.58,-54102.41C229.03,-54084.96 229.65,-54060.55 230.16,-54040.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="233.66,-54040.94 230.41,-54030.86 226.66,-54040.76 233.66,-54040.94"/>
</g>
<!-- layer26_ffn2_3 -->
<g id="node382" class="node">
<title>layer26_ffn2_3</title>
<path fill="#e6f3ff" stroke="black" d="M687.5,-54030.47C687.5,-54030.47 424.5,-54030.47 424.5,-54030.47 418.5,-54030.47 412.5,-54024.47 412.5,-54018.47 412.5,-54018.47 412.5,-53995.47 412.5,-53995.47 412.5,-53989.47 418.5,-53983.47 424.5,-53983.47 424.5,-53983.47 687.5,-53983.47 687.5,-53983.47 693.5,-53983.47 699.5,-53989.47 699.5,-53995.47 699.5,-53995.47 699.5,-54018.47 699.5,-54018.47 699.5,-54024.47 693.5,-54030.47 687.5,-54030.47"/>
<text text-anchor="middle" x="556" y="-54015.47" font-family="Arial" font-size="10.00">Layer 26 FFN2 GPU3</text>
<text text-anchor="middle" x="556" y="-54004.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="556" y="-53993.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer26_act_3&#45;&gt;layer26_ffn2_3 -->
<g id="edge435" class="edge">
<title>layer26_act_3&#45;&gt;layer26_ffn2_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M557.61,-54102.41C557.32,-54084.96 556.9,-54060.55 556.56,-54040.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="560.06,-54040.8 556.39,-54030.86 553.06,-54040.92 560.06,-54040.8"/>
</g>
<!-- layer26_ffn_ar -->
<g id="node383" class="node">
<title>layer26_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M524.22,-53911.47C524.22,-53911.47 318.8,-53911.47 318.8,-53911.47 312.8,-53911.47 303,-53906.83 299.19,-53902.19 299.19,-53902.19 255.39,-53848.75 255.39,-53848.75 251.59,-53844.11 253.78,-53839.47 259.78,-53839.47 259.78,-53839.47 465.2,-53839.47 465.2,-53839.47 471.2,-53839.47 481,-53844.11 484.81,-53848.75 484.81,-53848.75 528.61,-53902.19 528.61,-53902.19 532.41,-53906.83 530.22,-53911.47 524.22,-53911.47"/>
<text text-anchor="middle" x="392" y="-53878.47" font-family="Arial" font-size="10.00">Layer 26 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="392" y="-53867.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer26_ffn2_2&#45;&gt;layer26_ffn_ar -->
<g id="edge436" class="edge">
<title>layer26_ffn2_2&#45;&gt;layer26_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M259.04,-53983.41C281.43,-53965.41 313.4,-53939.69 340.38,-53917.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="342.61,-53920.68 348.21,-53911.69 338.23,-53915.23 342.61,-53920.68"/>
</g>
<!-- layer26_ffn2_3&#45;&gt;layer26_ffn_ar -->
<g id="edge437" class="edge">
<title>layer26_ffn2_3&#45;&gt;layer26_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M527.43,-53983.41C504.63,-53965.41 472.06,-53939.69 444.58,-53917.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="446.62,-53915.14 436.6,-53911.69 442.28,-53920.63 446.62,-53915.14"/>
</g>
<!-- layer27_qkv_2 -->
<g id="node384" class="node">
<title>layer27_qkv_2</title>
<path fill="#e6f3ff" stroke="black" d="M362,-53767.47C362,-53767.47 64,-53767.47 64,-53767.47 58,-53767.47 52,-53761.47 52,-53755.47 52,-53755.47 52,-53732.47 52,-53732.47 52,-53726.47 58,-53720.47 64,-53720.47 64,-53720.47 362,-53720.47 362,-53720.47 368,-53720.47 374,-53726.47 374,-53732.47 374,-53732.47 374,-53755.47 374,-53755.47 374,-53761.47 368,-53767.47 362,-53767.47"/>
<text text-anchor="middle" x="213" y="-53752.47" font-family="Arial" font-size="10.00">Layer 27 QKV Proj GPU2</text>
<text text-anchor="middle" x="213" y="-53741.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="213" y="-53730.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer26_ffn_ar&#45;&gt;layer27_qkv_2 -->
<g id="edge438" class="edge">
<title>layer26_ffn_ar&#45;&gt;layer27_qkv_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M343.56,-53839.42C315.06,-53818.81 279.48,-53793.06 252.66,-53773.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="254.43,-53770.62 244.28,-53767.6 250.33,-53776.3 254.43,-53770.62"/>
</g>
<!-- layer27_qkv_3 -->
<g id="node385" class="node">
<title>layer27_qkv_3</title>
<path fill="#e6f3ff" stroke="black" d="M720,-53767.47C720,-53767.47 422,-53767.47 422,-53767.47 416,-53767.47 410,-53761.47 410,-53755.47 410,-53755.47 410,-53732.47 410,-53732.47 410,-53726.47 416,-53720.47 422,-53720.47 422,-53720.47 720,-53720.47 720,-53720.47 726,-53720.47 732,-53726.47 732,-53732.47 732,-53732.47 732,-53755.47 732,-53755.47 732,-53761.47 726,-53767.47 720,-53767.47"/>
<text text-anchor="middle" x="571" y="-53752.47" font-family="Arial" font-size="10.00">Layer 27 QKV Proj GPU3</text>
<text text-anchor="middle" x="571" y="-53741.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="571" y="-53730.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer26_ffn_ar&#45;&gt;layer27_qkv_3 -->
<g id="edge439" class="edge">
<title>layer26_ffn_ar&#45;&gt;layer27_qkv_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M440.44,-53839.42C468.94,-53818.81 504.52,-53793.06 531.34,-53773.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="533.67,-53776.3 539.72,-53767.6 529.57,-53770.62 533.67,-53776.3"/>
</g>
<!-- layer27_attn_2 -->
<g id="node386" class="node">
<title>layer27_attn_2</title>
<path fill="#e6f3ff" stroke="black" d="M362,-53648.47C362,-53648.47 64,-53648.47 64,-53648.47 58,-53648.47 52,-53642.47 52,-53636.47 52,-53636.47 52,-53613.47 52,-53613.47 52,-53607.47 58,-53601.47 64,-53601.47 64,-53601.47 362,-53601.47 362,-53601.47 368,-53601.47 374,-53607.47 374,-53613.47 374,-53613.47 374,-53636.47 374,-53636.47 374,-53642.47 368,-53648.47 362,-53648.47"/>
<text text-anchor="middle" x="213" y="-53633.47" font-family="Arial" font-size="10.00">Layer 27 Attention GPU2</text>
<text text-anchor="middle" x="213" y="-53622.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="213" y="-53611.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer27_qkv_2&#45;&gt;layer27_attn_2 -->
<g id="edge440" class="edge">
<title>layer27_qkv_2&#45;&gt;layer27_attn_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M213,-53720.41C213,-53702.96 213,-53678.55 213,-53658.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="216.5,-53658.86 213,-53648.86 209.5,-53658.86 216.5,-53658.86"/>
</g>
<!-- layer27_attn_3 -->
<g id="node387" class="node">
<title>layer27_attn_3</title>
<path fill="#e6f3ff" stroke="black" d="M720,-53648.47C720,-53648.47 422,-53648.47 422,-53648.47 416,-53648.47 410,-53642.47 410,-53636.47 410,-53636.47 410,-53613.47 410,-53613.47 410,-53607.47 416,-53601.47 422,-53601.47 422,-53601.47 720,-53601.47 720,-53601.47 726,-53601.47 732,-53607.47 732,-53613.47 732,-53613.47 732,-53636.47 732,-53636.47 732,-53642.47 726,-53648.47 720,-53648.47"/>
<text text-anchor="middle" x="571" y="-53633.47" font-family="Arial" font-size="10.00">Layer 27 Attention GPU3</text>
<text text-anchor="middle" x="571" y="-53622.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="571" y="-53611.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer27_qkv_3&#45;&gt;layer27_attn_3 -->
<g id="edge441" class="edge">
<title>layer27_qkv_3&#45;&gt;layer27_attn_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M571,-53720.41C571,-53702.96 571,-53678.55 571,-53658.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="574.5,-53658.86 571,-53648.86 567.5,-53658.86 574.5,-53658.86"/>
</g>
<!-- layer27_attn_out_2 -->
<g id="node388" class="node">
<title>layer27_attn_out_2</title>
<path fill="#e6f3ff" stroke="black" d="M362,-53529.47C362,-53529.47 72,-53529.47 72,-53529.47 66,-53529.47 60,-53523.47 60,-53517.47 60,-53517.47 60,-53494.47 60,-53494.47 60,-53488.47 66,-53482.47 72,-53482.47 72,-53482.47 362,-53482.47 362,-53482.47 368,-53482.47 374,-53488.47 374,-53494.47 374,-53494.47 374,-53517.47 374,-53517.47 374,-53523.47 368,-53529.47 362,-53529.47"/>
<text text-anchor="middle" x="217" y="-53514.47" font-family="Arial" font-size="10.00">Layer 27 Attn Out GPU2</text>
<text text-anchor="middle" x="217" y="-53503.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="217" y="-53492.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer27_attn_2&#45;&gt;layer27_attn_out_2 -->
<g id="edge442" class="edge">
<title>layer27_attn_2&#45;&gt;layer27_attn_out_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M213.77,-53601.41C214.37,-53583.96 215.2,-53559.55 215.87,-53539.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="219.37,-53539.97 216.22,-53529.86 212.38,-53539.73 219.37,-53539.97"/>
</g>
<!-- layer27_attn_out_3 -->
<g id="node389" class="node">
<title>layer27_attn_out_3</title>
<path fill="#e6f3ff" stroke="black" d="M714,-53529.47C714,-53529.47 424,-53529.47 424,-53529.47 418,-53529.47 412,-53523.47 412,-53517.47 412,-53517.47 412,-53494.47 412,-53494.47 412,-53488.47 418,-53482.47 424,-53482.47 424,-53482.47 714,-53482.47 714,-53482.47 720,-53482.47 726,-53488.47 726,-53494.47 726,-53494.47 726,-53517.47 726,-53517.47 726,-53523.47 720,-53529.47 714,-53529.47"/>
<text text-anchor="middle" x="569" y="-53514.47" font-family="Arial" font-size="10.00">Layer 27 Attn Out GPU3</text>
<text text-anchor="middle" x="569" y="-53503.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="569" y="-53492.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer27_attn_3&#45;&gt;layer27_attn_out_3 -->
<g id="edge443" class="edge">
<title>layer27_attn_3&#45;&gt;layer27_attn_out_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M570.61,-53601.41C570.32,-53583.96 569.9,-53559.55 569.56,-53539.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="573.06,-53539.8 569.39,-53529.86 566.06,-53539.92 573.06,-53539.8"/>
</g>
<!-- layer27_attn_ar -->
<g id="node390" class="node">
<title>layer27_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M522.07,-53410.47C522.07,-53410.47 320.07,-53410.47 320.07,-53410.47 314.07,-53410.47 304.3,-53405.8 300.53,-53401.13 300.53,-53401.13 257.47,-53347.8 257.47,-53347.8 253.7,-53343.14 255.93,-53338.47 261.93,-53338.47 261.93,-53338.47 463.93,-53338.47 463.93,-53338.47 469.93,-53338.47 479.7,-53343.14 483.47,-53347.8 483.47,-53347.8 526.53,-53401.13 526.53,-53401.13 530.3,-53405.8 528.07,-53410.47 522.07,-53410.47"/>
<text text-anchor="middle" x="392" y="-53377.47" font-family="Arial" font-size="10.00">Layer 27 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="392" y="-53366.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer27_attn_out_2&#45;&gt;layer27_attn_ar -->
<g id="edge444" class="edge">
<title>layer27_attn_out_2&#45;&gt;layer27_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M247.48,-53482.41C271.92,-53464.33 306.86,-53438.47 336.27,-53416.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="338.45,-53419.45 344.4,-53410.69 334.28,-53413.82 338.45,-53419.45"/>
</g>
<!-- layer27_attn_out_3&#45;&gt;layer27_attn_ar -->
<g id="edge445" class="edge">
<title>layer27_attn_out_3&#45;&gt;layer27_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M538.17,-53482.41C513.45,-53464.33 478.11,-53438.47 448.37,-53416.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="450.28,-53413.77 440.14,-53410.69 446.14,-53419.42 450.28,-53413.77"/>
</g>
<!-- layer27_ffn1_2 -->
<g id="node391" class="node">
<title>layer27_ffn1_2</title>
<path fill="#e6f3ff" stroke="black" d="M362,-53266.47C362,-53266.47 92,-53266.47 92,-53266.47 86,-53266.47 80,-53260.47 80,-53254.47 80,-53254.47 80,-53231.47 80,-53231.47 80,-53225.47 86,-53219.47 92,-53219.47 92,-53219.47 362,-53219.47 362,-53219.47 368,-53219.47 374,-53225.47 374,-53231.47 374,-53231.47 374,-53254.47 374,-53254.47 374,-53260.47 368,-53266.47 362,-53266.47"/>
<text text-anchor="middle" x="227" y="-53251.47" font-family="Arial" font-size="10.00">Layer 27 FFN1 GPU2</text>
<text text-anchor="middle" x="227" y="-53240.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="227" y="-53229.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer27_attn_ar&#45;&gt;layer27_ffn1_2 -->
<g id="edge446" class="edge">
<title>layer27_attn_ar&#45;&gt;layer27_ffn1_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M347.35,-53338.42C321.28,-53317.96 288.78,-53292.45 264.12,-53273.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="266.11,-53270.21 256.08,-53266.79 261.79,-53275.72 266.11,-53270.21"/>
</g>
<!-- layer27_ffn1_3 -->
<g id="node392" class="node">
<title>layer27_ffn1_3</title>
<path fill="#e6f3ff" stroke="black" d="M692,-53266.47C692,-53266.47 422,-53266.47 422,-53266.47 416,-53266.47 410,-53260.47 410,-53254.47 410,-53254.47 410,-53231.47 410,-53231.47 410,-53225.47 416,-53219.47 422,-53219.47 422,-53219.47 692,-53219.47 692,-53219.47 698,-53219.47 704,-53225.47 704,-53231.47 704,-53231.47 704,-53254.47 704,-53254.47 704,-53260.47 698,-53266.47 692,-53266.47"/>
<text text-anchor="middle" x="557" y="-53251.47" font-family="Arial" font-size="10.00">Layer 27 FFN1 GPU3</text>
<text text-anchor="middle" x="557" y="-53240.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="557" y="-53229.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer27_attn_ar&#45;&gt;layer27_ffn1_3 -->
<g id="edge447" class="edge">
<title>layer27_attn_ar&#45;&gt;layer27_ffn1_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M436.65,-53338.42C462.72,-53317.96 495.22,-53292.45 519.88,-53273.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="522.21,-53275.72 527.92,-53266.79 517.89,-53270.21 522.21,-53275.72"/>
</g>
<!-- layer27_act_2 -->
<g id="node393" class="node">
<title>layer27_act_2</title>
<path fill="#e6f3ff" stroke="black" d="M362,-53147.47C362,-53147.47 92,-53147.47 92,-53147.47 86,-53147.47 80,-53141.47 80,-53135.47 80,-53135.47 80,-53112.47 80,-53112.47 80,-53106.47 86,-53100.47 92,-53100.47 92,-53100.47 362,-53100.47 362,-53100.47 368,-53100.47 374,-53106.47 374,-53112.47 374,-53112.47 374,-53135.47 374,-53135.47 374,-53141.47 368,-53147.47 362,-53147.47"/>
<text text-anchor="middle" x="227" y="-53132.47" font-family="Arial" font-size="10.00">Layer 27 SiLU GPU2</text>
<text text-anchor="middle" x="227" y="-53121.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="227" y="-53110.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer27_ffn1_2&#45;&gt;layer27_act_2 -->
<g id="edge448" class="edge">
<title>layer27_ffn1_2&#45;&gt;layer27_act_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M227,-53219.41C227,-53201.96 227,-53177.55 227,-53157.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="230.5,-53157.86 227,-53147.86 223.5,-53157.86 230.5,-53157.86"/>
</g>
<!-- layer27_act_3 -->
<g id="node394" class="node">
<title>layer27_act_3</title>
<path fill="#e6f3ff" stroke="black" d="M692,-53147.47C692,-53147.47 422,-53147.47 422,-53147.47 416,-53147.47 410,-53141.47 410,-53135.47 410,-53135.47 410,-53112.47 410,-53112.47 410,-53106.47 416,-53100.47 422,-53100.47 422,-53100.47 692,-53100.47 692,-53100.47 698,-53100.47 704,-53106.47 704,-53112.47 704,-53112.47 704,-53135.47 704,-53135.47 704,-53141.47 698,-53147.47 692,-53147.47"/>
<text text-anchor="middle" x="557" y="-53132.47" font-family="Arial" font-size="10.00">Layer 27 SiLU GPU3</text>
<text text-anchor="middle" x="557" y="-53121.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="557" y="-53110.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer27_ffn1_3&#45;&gt;layer27_act_3 -->
<g id="edge449" class="edge">
<title>layer27_ffn1_3&#45;&gt;layer27_act_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M557,-53219.41C557,-53201.96 557,-53177.55 557,-53157.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="560.5,-53157.86 557,-53147.86 553.5,-53157.86 560.5,-53157.86"/>
</g>
<!-- layer27_ffn2_2 -->
<g id="node395" class="node">
<title>layer27_ffn2_2</title>
<path fill="#e6f3ff" stroke="black" d="M361.5,-53028.47C361.5,-53028.47 98.5,-53028.47 98.5,-53028.47 92.5,-53028.47 86.5,-53022.47 86.5,-53016.47 86.5,-53016.47 86.5,-52993.47 86.5,-52993.47 86.5,-52987.47 92.5,-52981.47 98.5,-52981.47 98.5,-52981.47 361.5,-52981.47 361.5,-52981.47 367.5,-52981.47 373.5,-52987.47 373.5,-52993.47 373.5,-52993.47 373.5,-53016.47 373.5,-53016.47 373.5,-53022.47 367.5,-53028.47 361.5,-53028.47"/>
<text text-anchor="middle" x="230" y="-53013.47" font-family="Arial" font-size="10.00">Layer 27 FFN2 GPU2</text>
<text text-anchor="middle" x="230" y="-53002.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="230" y="-52991.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer27_act_2&#45;&gt;layer27_ffn2_2 -->
<g id="edge450" class="edge">
<title>layer27_act_2&#45;&gt;layer27_ffn2_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M227.58,-53100.41C228.03,-53082.96 228.65,-53058.55 229.16,-53038.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="232.66,-53038.94 229.41,-53028.86 225.66,-53038.76 232.66,-53038.94"/>
</g>
<!-- layer27_ffn2_3 -->
<g id="node396" class="node">
<title>layer27_ffn2_3</title>
<path fill="#e6f3ff" stroke="black" d="M686.5,-53028.47C686.5,-53028.47 423.5,-53028.47 423.5,-53028.47 417.5,-53028.47 411.5,-53022.47 411.5,-53016.47 411.5,-53016.47 411.5,-52993.47 411.5,-52993.47 411.5,-52987.47 417.5,-52981.47 423.5,-52981.47 423.5,-52981.47 686.5,-52981.47 686.5,-52981.47 692.5,-52981.47 698.5,-52987.47 698.5,-52993.47 698.5,-52993.47 698.5,-53016.47 698.5,-53016.47 698.5,-53022.47 692.5,-53028.47 686.5,-53028.47"/>
<text text-anchor="middle" x="555" y="-53013.47" font-family="Arial" font-size="10.00">Layer 27 FFN2 GPU3</text>
<text text-anchor="middle" x="555" y="-53002.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="555" y="-52991.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer27_act_3&#45;&gt;layer27_ffn2_3 -->
<g id="edge451" class="edge">
<title>layer27_act_3&#45;&gt;layer27_ffn2_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M556.61,-53100.41C556.32,-53082.96 555.9,-53058.55 555.56,-53038.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="559.06,-53038.8 555.39,-53028.86 552.06,-53038.92 559.06,-53038.8"/>
</g>
<!-- layer27_ffn_ar -->
<g id="node397" class="node">
<title>layer27_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M523.22,-52909.47C523.22,-52909.47 317.8,-52909.47 317.8,-52909.47 311.8,-52909.47 302,-52904.83 298.19,-52900.19 298.19,-52900.19 254.39,-52846.75 254.39,-52846.75 250.59,-52842.11 252.78,-52837.47 258.78,-52837.47 258.78,-52837.47 464.2,-52837.47 464.2,-52837.47 470.2,-52837.47 480,-52842.11 483.81,-52846.75 483.81,-52846.75 527.61,-52900.19 527.61,-52900.19 531.41,-52904.83 529.22,-52909.47 523.22,-52909.47"/>
<text text-anchor="middle" x="391" y="-52876.47" font-family="Arial" font-size="10.00">Layer 27 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="391" y="-52865.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer27_ffn2_2&#45;&gt;layer27_ffn_ar -->
<g id="edge452" class="edge">
<title>layer27_ffn2_2&#45;&gt;layer27_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M258.04,-52981.41C280.43,-52963.41 312.4,-52937.69 339.38,-52915.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="341.61,-52918.68 347.21,-52909.69 337.23,-52913.23 341.61,-52918.68"/>
</g>
<!-- layer27_ffn2_3&#45;&gt;layer27_ffn_ar -->
<g id="edge453" class="edge">
<title>layer27_ffn2_3&#45;&gt;layer27_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M526.43,-52981.41C503.63,-52963.41 471.06,-52937.69 443.58,-52915.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="445.62,-52913.14 435.6,-52909.69 441.28,-52918.63 445.62,-52913.14"/>
</g>
<!-- layer28_qkv_2 -->
<g id="node398" class="node">
<title>layer28_qkv_2</title>
<path fill="#e6f3ff" stroke="black" d="M361,-52765.47C361,-52765.47 63,-52765.47 63,-52765.47 57,-52765.47 51,-52759.47 51,-52753.47 51,-52753.47 51,-52730.47 51,-52730.47 51,-52724.47 57,-52718.47 63,-52718.47 63,-52718.47 361,-52718.47 361,-52718.47 367,-52718.47 373,-52724.47 373,-52730.47 373,-52730.47 373,-52753.47 373,-52753.47 373,-52759.47 367,-52765.47 361,-52765.47"/>
<text text-anchor="middle" x="212" y="-52750.47" font-family="Arial" font-size="10.00">Layer 28 QKV Proj GPU2</text>
<text text-anchor="middle" x="212" y="-52739.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="212" y="-52728.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer27_ffn_ar&#45;&gt;layer28_qkv_2 -->
<g id="edge454" class="edge">
<title>layer27_ffn_ar&#45;&gt;layer28_qkv_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M342.56,-52837.42C314.06,-52816.81 278.48,-52791.06 251.66,-52771.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="253.43,-52768.62 243.28,-52765.6 249.33,-52774.3 253.43,-52768.62"/>
</g>
<!-- layer28_qkv_3 -->
<g id="node399" class="node">
<title>layer28_qkv_3</title>
<path fill="#e6f3ff" stroke="black" d="M719,-52765.47C719,-52765.47 421,-52765.47 421,-52765.47 415,-52765.47 409,-52759.47 409,-52753.47 409,-52753.47 409,-52730.47 409,-52730.47 409,-52724.47 415,-52718.47 421,-52718.47 421,-52718.47 719,-52718.47 719,-52718.47 725,-52718.47 731,-52724.47 731,-52730.47 731,-52730.47 731,-52753.47 731,-52753.47 731,-52759.47 725,-52765.47 719,-52765.47"/>
<text text-anchor="middle" x="570" y="-52750.47" font-family="Arial" font-size="10.00">Layer 28 QKV Proj GPU3</text>
<text text-anchor="middle" x="570" y="-52739.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="570" y="-52728.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer27_ffn_ar&#45;&gt;layer28_qkv_3 -->
<g id="edge455" class="edge">
<title>layer27_ffn_ar&#45;&gt;layer28_qkv_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M439.44,-52837.42C467.94,-52816.81 503.52,-52791.06 530.34,-52771.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="532.67,-52774.3 538.72,-52765.6 528.57,-52768.62 532.67,-52774.3"/>
</g>
<!-- layer28_attn_2 -->
<g id="node400" class="node">
<title>layer28_attn_2</title>
<path fill="#e6f3ff" stroke="black" d="M361,-52646.47C361,-52646.47 63,-52646.47 63,-52646.47 57,-52646.47 51,-52640.47 51,-52634.47 51,-52634.47 51,-52611.47 51,-52611.47 51,-52605.47 57,-52599.47 63,-52599.47 63,-52599.47 361,-52599.47 361,-52599.47 367,-52599.47 373,-52605.47 373,-52611.47 373,-52611.47 373,-52634.47 373,-52634.47 373,-52640.47 367,-52646.47 361,-52646.47"/>
<text text-anchor="middle" x="212" y="-52631.47" font-family="Arial" font-size="10.00">Layer 28 Attention GPU2</text>
<text text-anchor="middle" x="212" y="-52620.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="212" y="-52609.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer28_qkv_2&#45;&gt;layer28_attn_2 -->
<g id="edge456" class="edge">
<title>layer28_qkv_2&#45;&gt;layer28_attn_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M212,-52718.41C212,-52700.96 212,-52676.55 212,-52656.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="215.5,-52656.86 212,-52646.86 208.5,-52656.86 215.5,-52656.86"/>
</g>
<!-- layer28_attn_3 -->
<g id="node401" class="node">
<title>layer28_attn_3</title>
<path fill="#e6f3ff" stroke="black" d="M719,-52646.47C719,-52646.47 421,-52646.47 421,-52646.47 415,-52646.47 409,-52640.47 409,-52634.47 409,-52634.47 409,-52611.47 409,-52611.47 409,-52605.47 415,-52599.47 421,-52599.47 421,-52599.47 719,-52599.47 719,-52599.47 725,-52599.47 731,-52605.47 731,-52611.47 731,-52611.47 731,-52634.47 731,-52634.47 731,-52640.47 725,-52646.47 719,-52646.47"/>
<text text-anchor="middle" x="570" y="-52631.47" font-family="Arial" font-size="10.00">Layer 28 Attention GPU3</text>
<text text-anchor="middle" x="570" y="-52620.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="570" y="-52609.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer28_qkv_3&#45;&gt;layer28_attn_3 -->
<g id="edge457" class="edge">
<title>layer28_qkv_3&#45;&gt;layer28_attn_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M570,-52718.41C570,-52700.96 570,-52676.55 570,-52656.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="573.5,-52656.86 570,-52646.86 566.5,-52656.86 573.5,-52656.86"/>
</g>
<!-- layer28_attn_out_2 -->
<g id="node402" class="node">
<title>layer28_attn_out_2</title>
<path fill="#e6f3ff" stroke="black" d="M361,-52527.47C361,-52527.47 71,-52527.47 71,-52527.47 65,-52527.47 59,-52521.47 59,-52515.47 59,-52515.47 59,-52492.47 59,-52492.47 59,-52486.47 65,-52480.47 71,-52480.47 71,-52480.47 361,-52480.47 361,-52480.47 367,-52480.47 373,-52486.47 373,-52492.47 373,-52492.47 373,-52515.47 373,-52515.47 373,-52521.47 367,-52527.47 361,-52527.47"/>
<text text-anchor="middle" x="216" y="-52512.47" font-family="Arial" font-size="10.00">Layer 28 Attn Out GPU2</text>
<text text-anchor="middle" x="216" y="-52501.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="216" y="-52490.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer28_attn_2&#45;&gt;layer28_attn_out_2 -->
<g id="edge458" class="edge">
<title>layer28_attn_2&#45;&gt;layer28_attn_out_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M212.77,-52599.41C213.37,-52581.96 214.2,-52557.55 214.87,-52537.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="218.37,-52537.97 215.22,-52527.86 211.38,-52537.73 218.37,-52537.97"/>
</g>
<!-- layer28_attn_out_3 -->
<g id="node403" class="node">
<title>layer28_attn_out_3</title>
<path fill="#e6f3ff" stroke="black" d="M713,-52527.47C713,-52527.47 423,-52527.47 423,-52527.47 417,-52527.47 411,-52521.47 411,-52515.47 411,-52515.47 411,-52492.47 411,-52492.47 411,-52486.47 417,-52480.47 423,-52480.47 423,-52480.47 713,-52480.47 713,-52480.47 719,-52480.47 725,-52486.47 725,-52492.47 725,-52492.47 725,-52515.47 725,-52515.47 725,-52521.47 719,-52527.47 713,-52527.47"/>
<text text-anchor="middle" x="568" y="-52512.47" font-family="Arial" font-size="10.00">Layer 28 Attn Out GPU3</text>
<text text-anchor="middle" x="568" y="-52501.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="568" y="-52490.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer28_attn_3&#45;&gt;layer28_attn_out_3 -->
<g id="edge459" class="edge">
<title>layer28_attn_3&#45;&gt;layer28_attn_out_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M569.61,-52599.41C569.32,-52581.96 568.9,-52557.55 568.56,-52537.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="572.06,-52537.8 568.39,-52527.86 565.06,-52537.92 572.06,-52537.8"/>
</g>
<!-- layer28_attn_ar -->
<g id="node404" class="node">
<title>layer28_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M521.07,-52408.47C521.07,-52408.47 319.07,-52408.47 319.07,-52408.47 313.07,-52408.47 303.3,-52403.8 299.53,-52399.13 299.53,-52399.13 256.47,-52345.8 256.47,-52345.8 252.7,-52341.14 254.93,-52336.47 260.93,-52336.47 260.93,-52336.47 462.93,-52336.47 462.93,-52336.47 468.93,-52336.47 478.7,-52341.14 482.47,-52345.8 482.47,-52345.8 525.53,-52399.13 525.53,-52399.13 529.3,-52403.8 527.07,-52408.47 521.07,-52408.47"/>
<text text-anchor="middle" x="391" y="-52375.47" font-family="Arial" font-size="10.00">Layer 28 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="391" y="-52364.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer28_attn_out_2&#45;&gt;layer28_attn_ar -->
<g id="edge460" class="edge">
<title>layer28_attn_out_2&#45;&gt;layer28_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M246.48,-52480.41C270.92,-52462.33 305.86,-52436.47 335.27,-52414.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="337.45,-52417.45 343.4,-52408.69 333.28,-52411.82 337.45,-52417.45"/>
</g>
<!-- layer28_attn_out_3&#45;&gt;layer28_attn_ar -->
<g id="edge461" class="edge">
<title>layer28_attn_out_3&#45;&gt;layer28_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M537.17,-52480.41C512.45,-52462.33 477.11,-52436.47 447.37,-52414.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="449.28,-52411.77 439.14,-52408.69 445.14,-52417.42 449.28,-52411.77"/>
</g>
<!-- layer28_ffn1_2 -->
<g id="node405" class="node">
<title>layer28_ffn1_2</title>
<path fill="#e6f3ff" stroke="black" d="M361,-52264.47C361,-52264.47 91,-52264.47 91,-52264.47 85,-52264.47 79,-52258.47 79,-52252.47 79,-52252.47 79,-52229.47 79,-52229.47 79,-52223.47 85,-52217.47 91,-52217.47 91,-52217.47 361,-52217.47 361,-52217.47 367,-52217.47 373,-52223.47 373,-52229.47 373,-52229.47 373,-52252.47 373,-52252.47 373,-52258.47 367,-52264.47 361,-52264.47"/>
<text text-anchor="middle" x="226" y="-52249.47" font-family="Arial" font-size="10.00">Layer 28 FFN1 GPU2</text>
<text text-anchor="middle" x="226" y="-52238.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="226" y="-52227.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer28_attn_ar&#45;&gt;layer28_ffn1_2 -->
<g id="edge462" class="edge">
<title>layer28_attn_ar&#45;&gt;layer28_ffn1_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M346.35,-52336.42C320.28,-52315.96 287.78,-52290.45 263.12,-52271.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="265.11,-52268.21 255.08,-52264.79 260.79,-52273.72 265.11,-52268.21"/>
</g>
<!-- layer28_ffn1_3 -->
<g id="node406" class="node">
<title>layer28_ffn1_3</title>
<path fill="#e6f3ff" stroke="black" d="M691,-52264.47C691,-52264.47 421,-52264.47 421,-52264.47 415,-52264.47 409,-52258.47 409,-52252.47 409,-52252.47 409,-52229.47 409,-52229.47 409,-52223.47 415,-52217.47 421,-52217.47 421,-52217.47 691,-52217.47 691,-52217.47 697,-52217.47 703,-52223.47 703,-52229.47 703,-52229.47 703,-52252.47 703,-52252.47 703,-52258.47 697,-52264.47 691,-52264.47"/>
<text text-anchor="middle" x="556" y="-52249.47" font-family="Arial" font-size="10.00">Layer 28 FFN1 GPU3</text>
<text text-anchor="middle" x="556" y="-52238.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="556" y="-52227.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer28_attn_ar&#45;&gt;layer28_ffn1_3 -->
<g id="edge463" class="edge">
<title>layer28_attn_ar&#45;&gt;layer28_ffn1_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M435.65,-52336.42C461.72,-52315.96 494.22,-52290.45 518.88,-52271.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="521.21,-52273.72 526.92,-52264.79 516.89,-52268.21 521.21,-52273.72"/>
</g>
<!-- layer28_act_2 -->
<g id="node407" class="node">
<title>layer28_act_2</title>
<path fill="#e6f3ff" stroke="black" d="M361,-52145.47C361,-52145.47 91,-52145.47 91,-52145.47 85,-52145.47 79,-52139.47 79,-52133.47 79,-52133.47 79,-52110.47 79,-52110.47 79,-52104.47 85,-52098.47 91,-52098.47 91,-52098.47 361,-52098.47 361,-52098.47 367,-52098.47 373,-52104.47 373,-52110.47 373,-52110.47 373,-52133.47 373,-52133.47 373,-52139.47 367,-52145.47 361,-52145.47"/>
<text text-anchor="middle" x="226" y="-52130.47" font-family="Arial" font-size="10.00">Layer 28 SiLU GPU2</text>
<text text-anchor="middle" x="226" y="-52119.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="226" y="-52108.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer28_ffn1_2&#45;&gt;layer28_act_2 -->
<g id="edge464" class="edge">
<title>layer28_ffn1_2&#45;&gt;layer28_act_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M226,-52217.41C226,-52199.96 226,-52175.55 226,-52155.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="229.5,-52155.86 226,-52145.86 222.5,-52155.86 229.5,-52155.86"/>
</g>
<!-- layer28_act_3 -->
<g id="node408" class="node">
<title>layer28_act_3</title>
<path fill="#e6f3ff" stroke="black" d="M691,-52145.47C691,-52145.47 421,-52145.47 421,-52145.47 415,-52145.47 409,-52139.47 409,-52133.47 409,-52133.47 409,-52110.47 409,-52110.47 409,-52104.47 415,-52098.47 421,-52098.47 421,-52098.47 691,-52098.47 691,-52098.47 697,-52098.47 703,-52104.47 703,-52110.47 703,-52110.47 703,-52133.47 703,-52133.47 703,-52139.47 697,-52145.47 691,-52145.47"/>
<text text-anchor="middle" x="556" y="-52130.47" font-family="Arial" font-size="10.00">Layer 28 SiLU GPU3</text>
<text text-anchor="middle" x="556" y="-52119.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="556" y="-52108.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer28_ffn1_3&#45;&gt;layer28_act_3 -->
<g id="edge465" class="edge">
<title>layer28_ffn1_3&#45;&gt;layer28_act_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M556,-52217.41C556,-52199.96 556,-52175.55 556,-52155.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="559.5,-52155.86 556,-52145.86 552.5,-52155.86 559.5,-52155.86"/>
</g>
<!-- layer28_ffn2_2 -->
<g id="node409" class="node">
<title>layer28_ffn2_2</title>
<path fill="#e6f3ff" stroke="black" d="M360.5,-52026.47C360.5,-52026.47 97.5,-52026.47 97.5,-52026.47 91.5,-52026.47 85.5,-52020.47 85.5,-52014.47 85.5,-52014.47 85.5,-51991.47 85.5,-51991.47 85.5,-51985.47 91.5,-51979.47 97.5,-51979.47 97.5,-51979.47 360.5,-51979.47 360.5,-51979.47 366.5,-51979.47 372.5,-51985.47 372.5,-51991.47 372.5,-51991.47 372.5,-52014.47 372.5,-52014.47 372.5,-52020.47 366.5,-52026.47 360.5,-52026.47"/>
<text text-anchor="middle" x="229" y="-52011.47" font-family="Arial" font-size="10.00">Layer 28 FFN2 GPU2</text>
<text text-anchor="middle" x="229" y="-52000.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="229" y="-51989.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer28_act_2&#45;&gt;layer28_ffn2_2 -->
<g id="edge466" class="edge">
<title>layer28_act_2&#45;&gt;layer28_ffn2_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M226.58,-52098.41C227.03,-52080.96 227.65,-52056.55 228.16,-52036.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="231.66,-52036.94 228.41,-52026.86 224.66,-52036.76 231.66,-52036.94"/>
</g>
<!-- layer28_ffn2_3 -->
<g id="node410" class="node">
<title>layer28_ffn2_3</title>
<path fill="#e6f3ff" stroke="black" d="M685.5,-52026.47C685.5,-52026.47 422.5,-52026.47 422.5,-52026.47 416.5,-52026.47 410.5,-52020.47 410.5,-52014.47 410.5,-52014.47 410.5,-51991.47 410.5,-51991.47 410.5,-51985.47 416.5,-51979.47 422.5,-51979.47 422.5,-51979.47 685.5,-51979.47 685.5,-51979.47 691.5,-51979.47 697.5,-51985.47 697.5,-51991.47 697.5,-51991.47 697.5,-52014.47 697.5,-52014.47 697.5,-52020.47 691.5,-52026.47 685.5,-52026.47"/>
<text text-anchor="middle" x="554" y="-52011.47" font-family="Arial" font-size="10.00">Layer 28 FFN2 GPU3</text>
<text text-anchor="middle" x="554" y="-52000.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="554" y="-51989.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer28_act_3&#45;&gt;layer28_ffn2_3 -->
<g id="edge467" class="edge">
<title>layer28_act_3&#45;&gt;layer28_ffn2_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M555.61,-52098.41C555.32,-52080.96 554.9,-52056.55 554.56,-52036.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="558.06,-52036.8 554.39,-52026.86 551.06,-52036.92 558.06,-52036.8"/>
</g>
<!-- layer28_ffn_ar -->
<g id="node411" class="node">
<title>layer28_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M522.22,-51907.47C522.22,-51907.47 316.8,-51907.47 316.8,-51907.47 310.8,-51907.47 301,-51902.83 297.19,-51898.19 297.19,-51898.19 253.39,-51844.75 253.39,-51844.75 249.59,-51840.11 251.78,-51835.47 257.78,-51835.47 257.78,-51835.47 463.2,-51835.47 463.2,-51835.47 469.2,-51835.47 479,-51840.11 482.81,-51844.75 482.81,-51844.75 526.61,-51898.19 526.61,-51898.19 530.41,-51902.83 528.22,-51907.47 522.22,-51907.47"/>
<text text-anchor="middle" x="390" y="-51874.47" font-family="Arial" font-size="10.00">Layer 28 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="390" y="-51863.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer28_ffn2_2&#45;&gt;layer28_ffn_ar -->
<g id="edge468" class="edge">
<title>layer28_ffn2_2&#45;&gt;layer28_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M257.04,-51979.41C279.43,-51961.41 311.4,-51935.69 338.38,-51913.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="340.61,-51916.68 346.21,-51907.69 336.23,-51911.23 340.61,-51916.68"/>
</g>
<!-- layer28_ffn2_3&#45;&gt;layer28_ffn_ar -->
<g id="edge469" class="edge">
<title>layer28_ffn2_3&#45;&gt;layer28_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M525.43,-51979.41C502.63,-51961.41 470.06,-51935.69 442.58,-51913.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="444.62,-51911.14 434.6,-51907.69 440.28,-51916.63 444.62,-51911.14"/>
</g>
<!-- layer29_qkv_2 -->
<g id="node412" class="node">
<title>layer29_qkv_2</title>
<path fill="#e6f3ff" stroke="black" d="M360,-51763.47C360,-51763.47 62,-51763.47 62,-51763.47 56,-51763.47 50,-51757.47 50,-51751.47 50,-51751.47 50,-51728.47 50,-51728.47 50,-51722.47 56,-51716.47 62,-51716.47 62,-51716.47 360,-51716.47 360,-51716.47 366,-51716.47 372,-51722.47 372,-51728.47 372,-51728.47 372,-51751.47 372,-51751.47 372,-51757.47 366,-51763.47 360,-51763.47"/>
<text text-anchor="middle" x="211" y="-51748.47" font-family="Arial" font-size="10.00">Layer 29 QKV Proj GPU2</text>
<text text-anchor="middle" x="211" y="-51737.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="211" y="-51726.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer28_ffn_ar&#45;&gt;layer29_qkv_2 -->
<g id="edge470" class="edge">
<title>layer28_ffn_ar&#45;&gt;layer29_qkv_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M341.56,-51835.42C313.06,-51814.81 277.48,-51789.06 250.66,-51769.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="252.43,-51766.62 242.28,-51763.6 248.33,-51772.3 252.43,-51766.62"/>
</g>
<!-- layer29_qkv_3 -->
<g id="node413" class="node">
<title>layer29_qkv_3</title>
<path fill="#e6f3ff" stroke="black" d="M718,-51763.47C718,-51763.47 420,-51763.47 420,-51763.47 414,-51763.47 408,-51757.47 408,-51751.47 408,-51751.47 408,-51728.47 408,-51728.47 408,-51722.47 414,-51716.47 420,-51716.47 420,-51716.47 718,-51716.47 718,-51716.47 724,-51716.47 730,-51722.47 730,-51728.47 730,-51728.47 730,-51751.47 730,-51751.47 730,-51757.47 724,-51763.47 718,-51763.47"/>
<text text-anchor="middle" x="569" y="-51748.47" font-family="Arial" font-size="10.00">Layer 29 QKV Proj GPU3</text>
<text text-anchor="middle" x="569" y="-51737.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="569" y="-51726.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer28_ffn_ar&#45;&gt;layer29_qkv_3 -->
<g id="edge471" class="edge">
<title>layer28_ffn_ar&#45;&gt;layer29_qkv_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M438.44,-51835.42C466.94,-51814.81 502.52,-51789.06 529.34,-51769.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="531.67,-51772.3 537.72,-51763.6 527.57,-51766.62 531.67,-51772.3"/>
</g>
<!-- layer29_attn_2 -->
<g id="node414" class="node">
<title>layer29_attn_2</title>
<path fill="#e6f3ff" stroke="black" d="M360,-51644.47C360,-51644.47 62,-51644.47 62,-51644.47 56,-51644.47 50,-51638.47 50,-51632.47 50,-51632.47 50,-51609.47 50,-51609.47 50,-51603.47 56,-51597.47 62,-51597.47 62,-51597.47 360,-51597.47 360,-51597.47 366,-51597.47 372,-51603.47 372,-51609.47 372,-51609.47 372,-51632.47 372,-51632.47 372,-51638.47 366,-51644.47 360,-51644.47"/>
<text text-anchor="middle" x="211" y="-51629.47" font-family="Arial" font-size="10.00">Layer 29 Attention GPU2</text>
<text text-anchor="middle" x="211" y="-51618.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="211" y="-51607.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer29_qkv_2&#45;&gt;layer29_attn_2 -->
<g id="edge472" class="edge">
<title>layer29_qkv_2&#45;&gt;layer29_attn_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M211,-51716.41C211,-51698.96 211,-51674.55 211,-51654.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="214.5,-51654.86 211,-51644.86 207.5,-51654.86 214.5,-51654.86"/>
</g>
<!-- layer29_attn_3 -->
<g id="node415" class="node">
<title>layer29_attn_3</title>
<path fill="#e6f3ff" stroke="black" d="M718,-51644.47C718,-51644.47 420,-51644.47 420,-51644.47 414,-51644.47 408,-51638.47 408,-51632.47 408,-51632.47 408,-51609.47 408,-51609.47 408,-51603.47 414,-51597.47 420,-51597.47 420,-51597.47 718,-51597.47 718,-51597.47 724,-51597.47 730,-51603.47 730,-51609.47 730,-51609.47 730,-51632.47 730,-51632.47 730,-51638.47 724,-51644.47 718,-51644.47"/>
<text text-anchor="middle" x="569" y="-51629.47" font-family="Arial" font-size="10.00">Layer 29 Attention GPU3</text>
<text text-anchor="middle" x="569" y="-51618.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="569" y="-51607.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer29_qkv_3&#45;&gt;layer29_attn_3 -->
<g id="edge473" class="edge">
<title>layer29_qkv_3&#45;&gt;layer29_attn_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M569,-51716.41C569,-51698.96 569,-51674.55 569,-51654.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="572.5,-51654.86 569,-51644.86 565.5,-51654.86 572.5,-51654.86"/>
</g>
<!-- layer29_attn_out_2 -->
<g id="node416" class="node">
<title>layer29_attn_out_2</title>
<path fill="#e6f3ff" stroke="black" d="M360,-51525.47C360,-51525.47 70,-51525.47 70,-51525.47 64,-51525.47 58,-51519.47 58,-51513.47 58,-51513.47 58,-51490.47 58,-51490.47 58,-51484.47 64,-51478.47 70,-51478.47 70,-51478.47 360,-51478.47 360,-51478.47 366,-51478.47 372,-51484.47 372,-51490.47 372,-51490.47 372,-51513.47 372,-51513.47 372,-51519.47 366,-51525.47 360,-51525.47"/>
<text text-anchor="middle" x="215" y="-51510.47" font-family="Arial" font-size="10.00">Layer 29 Attn Out GPU2</text>
<text text-anchor="middle" x="215" y="-51499.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="215" y="-51488.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer29_attn_2&#45;&gt;layer29_attn_out_2 -->
<g id="edge474" class="edge">
<title>layer29_attn_2&#45;&gt;layer29_attn_out_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M211.77,-51597.41C212.37,-51579.96 213.2,-51555.55 213.87,-51535.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="217.37,-51535.97 214.22,-51525.86 210.38,-51535.73 217.37,-51535.97"/>
</g>
<!-- layer29_attn_out_3 -->
<g id="node417" class="node">
<title>layer29_attn_out_3</title>
<path fill="#e6f3ff" stroke="black" d="M712,-51525.47C712,-51525.47 422,-51525.47 422,-51525.47 416,-51525.47 410,-51519.47 410,-51513.47 410,-51513.47 410,-51490.47 410,-51490.47 410,-51484.47 416,-51478.47 422,-51478.47 422,-51478.47 712,-51478.47 712,-51478.47 718,-51478.47 724,-51484.47 724,-51490.47 724,-51490.47 724,-51513.47 724,-51513.47 724,-51519.47 718,-51525.47 712,-51525.47"/>
<text text-anchor="middle" x="567" y="-51510.47" font-family="Arial" font-size="10.00">Layer 29 Attn Out GPU3</text>
<text text-anchor="middle" x="567" y="-51499.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="567" y="-51488.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer29_attn_3&#45;&gt;layer29_attn_out_3 -->
<g id="edge475" class="edge">
<title>layer29_attn_3&#45;&gt;layer29_attn_out_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M568.61,-51597.41C568.32,-51579.96 567.9,-51555.55 567.56,-51535.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="571.06,-51535.8 567.39,-51525.86 564.06,-51535.92 571.06,-51535.8"/>
</g>
<!-- layer29_attn_ar -->
<g id="node418" class="node">
<title>layer29_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M520.07,-51406.47C520.07,-51406.47 318.07,-51406.47 318.07,-51406.47 312.07,-51406.47 302.3,-51401.8 298.53,-51397.13 298.53,-51397.13 255.47,-51343.8 255.47,-51343.8 251.7,-51339.14 253.93,-51334.47 259.93,-51334.47 259.93,-51334.47 461.93,-51334.47 461.93,-51334.47 467.93,-51334.47 477.7,-51339.14 481.47,-51343.8 481.47,-51343.8 524.53,-51397.13 524.53,-51397.13 528.3,-51401.8 526.07,-51406.47 520.07,-51406.47"/>
<text text-anchor="middle" x="390" y="-51373.47" font-family="Arial" font-size="10.00">Layer 29 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="390" y="-51362.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer29_attn_out_2&#45;&gt;layer29_attn_ar -->
<g id="edge476" class="edge">
<title>layer29_attn_out_2&#45;&gt;layer29_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M245.48,-51478.41C269.92,-51460.33 304.86,-51434.47 334.27,-51412.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="336.45,-51415.45 342.4,-51406.69 332.28,-51409.82 336.45,-51415.45"/>
</g>
<!-- layer29_attn_out_3&#45;&gt;layer29_attn_ar -->
<g id="edge477" class="edge">
<title>layer29_attn_out_3&#45;&gt;layer29_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M536.17,-51478.41C511.45,-51460.33 476.11,-51434.47 446.37,-51412.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="448.28,-51409.77 438.14,-51406.69 444.14,-51415.42 448.28,-51409.77"/>
</g>
<!-- layer29_ffn1_2 -->
<g id="node419" class="node">
<title>layer29_ffn1_2</title>
<path fill="#e6f3ff" stroke="black" d="M360,-51262.47C360,-51262.47 90,-51262.47 90,-51262.47 84,-51262.47 78,-51256.47 78,-51250.47 78,-51250.47 78,-51227.47 78,-51227.47 78,-51221.47 84,-51215.47 90,-51215.47 90,-51215.47 360,-51215.47 360,-51215.47 366,-51215.47 372,-51221.47 372,-51227.47 372,-51227.47 372,-51250.47 372,-51250.47 372,-51256.47 366,-51262.47 360,-51262.47"/>
<text text-anchor="middle" x="225" y="-51247.47" font-family="Arial" font-size="10.00">Layer 29 FFN1 GPU2</text>
<text text-anchor="middle" x="225" y="-51236.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="225" y="-51225.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer29_attn_ar&#45;&gt;layer29_ffn1_2 -->
<g id="edge478" class="edge">
<title>layer29_attn_ar&#45;&gt;layer29_ffn1_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M345.35,-51334.42C319.28,-51313.96 286.78,-51288.45 262.12,-51269.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="264.11,-51266.21 254.08,-51262.79 259.79,-51271.72 264.11,-51266.21"/>
</g>
<!-- layer29_ffn1_3 -->
<g id="node420" class="node">
<title>layer29_ffn1_3</title>
<path fill="#e6f3ff" stroke="black" d="M690,-51262.47C690,-51262.47 420,-51262.47 420,-51262.47 414,-51262.47 408,-51256.47 408,-51250.47 408,-51250.47 408,-51227.47 408,-51227.47 408,-51221.47 414,-51215.47 420,-51215.47 420,-51215.47 690,-51215.47 690,-51215.47 696,-51215.47 702,-51221.47 702,-51227.47 702,-51227.47 702,-51250.47 702,-51250.47 702,-51256.47 696,-51262.47 690,-51262.47"/>
<text text-anchor="middle" x="555" y="-51247.47" font-family="Arial" font-size="10.00">Layer 29 FFN1 GPU3</text>
<text text-anchor="middle" x="555" y="-51236.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="555" y="-51225.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer29_attn_ar&#45;&gt;layer29_ffn1_3 -->
<g id="edge479" class="edge">
<title>layer29_attn_ar&#45;&gt;layer29_ffn1_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M434.65,-51334.42C460.72,-51313.96 493.22,-51288.45 517.88,-51269.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="520.21,-51271.72 525.92,-51262.79 515.89,-51266.21 520.21,-51271.72"/>
</g>
<!-- layer29_act_2 -->
<g id="node421" class="node">
<title>layer29_act_2</title>
<path fill="#e6f3ff" stroke="black" d="M360,-51143.47C360,-51143.47 90,-51143.47 90,-51143.47 84,-51143.47 78,-51137.47 78,-51131.47 78,-51131.47 78,-51108.47 78,-51108.47 78,-51102.47 84,-51096.47 90,-51096.47 90,-51096.47 360,-51096.47 360,-51096.47 366,-51096.47 372,-51102.47 372,-51108.47 372,-51108.47 372,-51131.47 372,-51131.47 372,-51137.47 366,-51143.47 360,-51143.47"/>
<text text-anchor="middle" x="225" y="-51128.47" font-family="Arial" font-size="10.00">Layer 29 SiLU GPU2</text>
<text text-anchor="middle" x="225" y="-51117.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="225" y="-51106.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer29_ffn1_2&#45;&gt;layer29_act_2 -->
<g id="edge480" class="edge">
<title>layer29_ffn1_2&#45;&gt;layer29_act_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M225,-51215.41C225,-51197.96 225,-51173.55 225,-51153.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="228.5,-51153.86 225,-51143.86 221.5,-51153.86 228.5,-51153.86"/>
</g>
<!-- layer29_act_3 -->
<g id="node422" class="node">
<title>layer29_act_3</title>
<path fill="#e6f3ff" stroke="black" d="M690,-51143.47C690,-51143.47 420,-51143.47 420,-51143.47 414,-51143.47 408,-51137.47 408,-51131.47 408,-51131.47 408,-51108.47 408,-51108.47 408,-51102.47 414,-51096.47 420,-51096.47 420,-51096.47 690,-51096.47 690,-51096.47 696,-51096.47 702,-51102.47 702,-51108.47 702,-51108.47 702,-51131.47 702,-51131.47 702,-51137.47 696,-51143.47 690,-51143.47"/>
<text text-anchor="middle" x="555" y="-51128.47" font-family="Arial" font-size="10.00">Layer 29 SiLU GPU3</text>
<text text-anchor="middle" x="555" y="-51117.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="555" y="-51106.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer29_ffn1_3&#45;&gt;layer29_act_3 -->
<g id="edge481" class="edge">
<title>layer29_ffn1_3&#45;&gt;layer29_act_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M555,-51215.41C555,-51197.96 555,-51173.55 555,-51153.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="558.5,-51153.86 555,-51143.86 551.5,-51153.86 558.5,-51153.86"/>
</g>
<!-- layer29_ffn2_2 -->
<g id="node423" class="node">
<title>layer29_ffn2_2</title>
<path fill="#e6f3ff" stroke="black" d="M359.5,-51024.47C359.5,-51024.47 96.5,-51024.47 96.5,-51024.47 90.5,-51024.47 84.5,-51018.47 84.5,-51012.47 84.5,-51012.47 84.5,-50989.47 84.5,-50989.47 84.5,-50983.47 90.5,-50977.47 96.5,-50977.47 96.5,-50977.47 359.5,-50977.47 359.5,-50977.47 365.5,-50977.47 371.5,-50983.47 371.5,-50989.47 371.5,-50989.47 371.5,-51012.47 371.5,-51012.47 371.5,-51018.47 365.5,-51024.47 359.5,-51024.47"/>
<text text-anchor="middle" x="228" y="-51009.47" font-family="Arial" font-size="10.00">Layer 29 FFN2 GPU2</text>
<text text-anchor="middle" x="228" y="-50998.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="228" y="-50987.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer29_act_2&#45;&gt;layer29_ffn2_2 -->
<g id="edge482" class="edge">
<title>layer29_act_2&#45;&gt;layer29_ffn2_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M225.58,-51096.41C226.03,-51078.96 226.65,-51054.55 227.16,-51034.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="230.66,-51034.94 227.41,-51024.86 223.66,-51034.76 230.66,-51034.94"/>
</g>
<!-- layer29_ffn2_3 -->
<g id="node424" class="node">
<title>layer29_ffn2_3</title>
<path fill="#e6f3ff" stroke="black" d="M684.5,-51024.47C684.5,-51024.47 421.5,-51024.47 421.5,-51024.47 415.5,-51024.47 409.5,-51018.47 409.5,-51012.47 409.5,-51012.47 409.5,-50989.47 409.5,-50989.47 409.5,-50983.47 415.5,-50977.47 421.5,-50977.47 421.5,-50977.47 684.5,-50977.47 684.5,-50977.47 690.5,-50977.47 696.5,-50983.47 696.5,-50989.47 696.5,-50989.47 696.5,-51012.47 696.5,-51012.47 696.5,-51018.47 690.5,-51024.47 684.5,-51024.47"/>
<text text-anchor="middle" x="553" y="-51009.47" font-family="Arial" font-size="10.00">Layer 29 FFN2 GPU3</text>
<text text-anchor="middle" x="553" y="-50998.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="553" y="-50987.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer29_act_3&#45;&gt;layer29_ffn2_3 -->
<g id="edge483" class="edge">
<title>layer29_act_3&#45;&gt;layer29_ffn2_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M554.61,-51096.41C554.32,-51078.96 553.9,-51054.55 553.56,-51034.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="557.06,-51034.8 553.39,-51024.86 550.06,-51034.92 557.06,-51034.8"/>
</g>
<!-- layer29_ffn_ar -->
<g id="node425" class="node">
<title>layer29_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M521.22,-50905.47C521.22,-50905.47 315.8,-50905.47 315.8,-50905.47 309.8,-50905.47 300,-50900.83 296.19,-50896.19 296.19,-50896.19 252.39,-50842.75 252.39,-50842.75 248.59,-50838.11 250.78,-50833.47 256.78,-50833.47 256.78,-50833.47 462.2,-50833.47 462.2,-50833.47 468.2,-50833.47 478,-50838.11 481.81,-50842.75 481.81,-50842.75 525.61,-50896.19 525.61,-50896.19 529.41,-50900.83 527.22,-50905.47 521.22,-50905.47"/>
<text text-anchor="middle" x="389" y="-50872.47" font-family="Arial" font-size="10.00">Layer 29 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="389" y="-50861.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer29_ffn2_2&#45;&gt;layer29_ffn_ar -->
<g id="edge484" class="edge">
<title>layer29_ffn2_2&#45;&gt;layer29_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M256.04,-50977.41C278.43,-50959.41 310.4,-50933.69 337.38,-50911.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="339.61,-50914.68 345.21,-50905.69 335.23,-50909.23 339.61,-50914.68"/>
</g>
<!-- layer29_ffn2_3&#45;&gt;layer29_ffn_ar -->
<g id="edge485" class="edge">
<title>layer29_ffn2_3&#45;&gt;layer29_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M524.43,-50977.41C501.63,-50959.41 469.06,-50933.69 441.58,-50911.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="443.62,-50909.14 433.6,-50905.69 439.28,-50914.63 443.62,-50909.14"/>
</g>
<!-- layer30_qkv_2 -->
<g id="node426" class="node">
<title>layer30_qkv_2</title>
<path fill="#e6f3ff" stroke="black" d="M359,-50761.47C359,-50761.47 61,-50761.47 61,-50761.47 55,-50761.47 49,-50755.47 49,-50749.47 49,-50749.47 49,-50726.47 49,-50726.47 49,-50720.47 55,-50714.47 61,-50714.47 61,-50714.47 359,-50714.47 359,-50714.47 365,-50714.47 371,-50720.47 371,-50726.47 371,-50726.47 371,-50749.47 371,-50749.47 371,-50755.47 365,-50761.47 359,-50761.47"/>
<text text-anchor="middle" x="210" y="-50746.47" font-family="Arial" font-size="10.00">Layer 30 QKV Proj GPU2</text>
<text text-anchor="middle" x="210" y="-50735.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="210" y="-50724.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer29_ffn_ar&#45;&gt;layer30_qkv_2 -->
<g id="edge486" class="edge">
<title>layer29_ffn_ar&#45;&gt;layer30_qkv_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M340.56,-50833.42C312.06,-50812.81 276.48,-50787.06 249.66,-50767.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="251.43,-50764.62 241.28,-50761.6 247.33,-50770.3 251.43,-50764.62"/>
</g>
<!-- layer30_qkv_3 -->
<g id="node427" class="node">
<title>layer30_qkv_3</title>
<path fill="#e6f3ff" stroke="black" d="M717,-50761.47C717,-50761.47 419,-50761.47 419,-50761.47 413,-50761.47 407,-50755.47 407,-50749.47 407,-50749.47 407,-50726.47 407,-50726.47 407,-50720.47 413,-50714.47 419,-50714.47 419,-50714.47 717,-50714.47 717,-50714.47 723,-50714.47 729,-50720.47 729,-50726.47 729,-50726.47 729,-50749.47 729,-50749.47 729,-50755.47 723,-50761.47 717,-50761.47"/>
<text text-anchor="middle" x="568" y="-50746.47" font-family="Arial" font-size="10.00">Layer 30 QKV Proj GPU3</text>
<text text-anchor="middle" x="568" y="-50735.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-50724.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer29_ffn_ar&#45;&gt;layer30_qkv_3 -->
<g id="edge487" class="edge">
<title>layer29_ffn_ar&#45;&gt;layer30_qkv_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M437.44,-50833.42C465.94,-50812.81 501.52,-50787.06 528.34,-50767.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="530.67,-50770.3 536.72,-50761.6 526.57,-50764.62 530.67,-50770.3"/>
</g>
<!-- layer30_attn_2 -->
<g id="node428" class="node">
<title>layer30_attn_2</title>
<path fill="#e6f3ff" stroke="black" d="M359,-50642.47C359,-50642.47 61,-50642.47 61,-50642.47 55,-50642.47 49,-50636.47 49,-50630.47 49,-50630.47 49,-50607.47 49,-50607.47 49,-50601.47 55,-50595.47 61,-50595.47 61,-50595.47 359,-50595.47 359,-50595.47 365,-50595.47 371,-50601.47 371,-50607.47 371,-50607.47 371,-50630.47 371,-50630.47 371,-50636.47 365,-50642.47 359,-50642.47"/>
<text text-anchor="middle" x="210" y="-50627.47" font-family="Arial" font-size="10.00">Layer 30 Attention GPU2</text>
<text text-anchor="middle" x="210" y="-50616.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="210" y="-50605.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer30_qkv_2&#45;&gt;layer30_attn_2 -->
<g id="edge488" class="edge">
<title>layer30_qkv_2&#45;&gt;layer30_attn_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M210,-50714.41C210,-50696.96 210,-50672.55 210,-50652.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="213.5,-50652.86 210,-50642.86 206.5,-50652.86 213.5,-50652.86"/>
</g>
<!-- layer30_attn_3 -->
<g id="node429" class="node">
<title>layer30_attn_3</title>
<path fill="#e6f3ff" stroke="black" d="M717,-50642.47C717,-50642.47 419,-50642.47 419,-50642.47 413,-50642.47 407,-50636.47 407,-50630.47 407,-50630.47 407,-50607.47 407,-50607.47 407,-50601.47 413,-50595.47 419,-50595.47 419,-50595.47 717,-50595.47 717,-50595.47 723,-50595.47 729,-50601.47 729,-50607.47 729,-50607.47 729,-50630.47 729,-50630.47 729,-50636.47 723,-50642.47 717,-50642.47"/>
<text text-anchor="middle" x="568" y="-50627.47" font-family="Arial" font-size="10.00">Layer 30 Attention GPU3</text>
<text text-anchor="middle" x="568" y="-50616.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="568" y="-50605.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer30_qkv_3&#45;&gt;layer30_attn_3 -->
<g id="edge489" class="edge">
<title>layer30_qkv_3&#45;&gt;layer30_attn_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M568,-50714.41C568,-50696.96 568,-50672.55 568,-50652.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="571.5,-50652.86 568,-50642.86 564.5,-50652.86 571.5,-50652.86"/>
</g>
<!-- layer30_attn_out_2 -->
<g id="node430" class="node">
<title>layer30_attn_out_2</title>
<path fill="#e6f3ff" stroke="black" d="M359,-50523.47C359,-50523.47 69,-50523.47 69,-50523.47 63,-50523.47 57,-50517.47 57,-50511.47 57,-50511.47 57,-50488.47 57,-50488.47 57,-50482.47 63,-50476.47 69,-50476.47 69,-50476.47 359,-50476.47 359,-50476.47 365,-50476.47 371,-50482.47 371,-50488.47 371,-50488.47 371,-50511.47 371,-50511.47 371,-50517.47 365,-50523.47 359,-50523.47"/>
<text text-anchor="middle" x="214" y="-50508.47" font-family="Arial" font-size="10.00">Layer 30 Attn Out GPU2</text>
<text text-anchor="middle" x="214" y="-50497.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="214" y="-50486.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer30_attn_2&#45;&gt;layer30_attn_out_2 -->
<g id="edge490" class="edge">
<title>layer30_attn_2&#45;&gt;layer30_attn_out_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M210.77,-50595.41C211.37,-50577.96 212.2,-50553.55 212.87,-50533.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="216.37,-50533.97 213.22,-50523.86 209.38,-50533.73 216.37,-50533.97"/>
</g>
<!-- layer30_attn_out_3 -->
<g id="node431" class="node">
<title>layer30_attn_out_3</title>
<path fill="#e6f3ff" stroke="black" d="M711,-50523.47C711,-50523.47 421,-50523.47 421,-50523.47 415,-50523.47 409,-50517.47 409,-50511.47 409,-50511.47 409,-50488.47 409,-50488.47 409,-50482.47 415,-50476.47 421,-50476.47 421,-50476.47 711,-50476.47 711,-50476.47 717,-50476.47 723,-50482.47 723,-50488.47 723,-50488.47 723,-50511.47 723,-50511.47 723,-50517.47 717,-50523.47 711,-50523.47"/>
<text text-anchor="middle" x="566" y="-50508.47" font-family="Arial" font-size="10.00">Layer 30 Attn Out GPU3</text>
<text text-anchor="middle" x="566" y="-50497.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="566" y="-50486.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer30_attn_3&#45;&gt;layer30_attn_out_3 -->
<g id="edge491" class="edge">
<title>layer30_attn_3&#45;&gt;layer30_attn_out_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M567.61,-50595.41C567.32,-50577.96 566.9,-50553.55 566.56,-50533.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="570.06,-50533.8 566.39,-50523.86 563.06,-50533.92 570.06,-50533.8"/>
</g>
<!-- layer30_attn_ar -->
<g id="node432" class="node">
<title>layer30_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M519.07,-50404.47C519.07,-50404.47 317.07,-50404.47 317.07,-50404.47 311.07,-50404.47 301.3,-50399.8 297.53,-50395.13 297.53,-50395.13 254.47,-50341.8 254.47,-50341.8 250.7,-50337.14 252.93,-50332.47 258.93,-50332.47 258.93,-50332.47 460.93,-50332.47 460.93,-50332.47 466.93,-50332.47 476.7,-50337.14 480.47,-50341.8 480.47,-50341.8 523.53,-50395.13 523.53,-50395.13 527.3,-50399.8 525.07,-50404.47 519.07,-50404.47"/>
<text text-anchor="middle" x="389" y="-50371.47" font-family="Arial" font-size="10.00">Layer 30 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="389" y="-50360.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer30_attn_out_2&#45;&gt;layer30_attn_ar -->
<g id="edge492" class="edge">
<title>layer30_attn_out_2&#45;&gt;layer30_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M244.48,-50476.41C268.92,-50458.33 303.86,-50432.47 333.27,-50410.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="335.45,-50413.45 341.4,-50404.69 331.28,-50407.82 335.45,-50413.45"/>
</g>
<!-- layer30_attn_out_3&#45;&gt;layer30_attn_ar -->
<g id="edge493" class="edge">
<title>layer30_attn_out_3&#45;&gt;layer30_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M535.17,-50476.41C510.45,-50458.33 475.11,-50432.47 445.37,-50410.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="447.28,-50407.77 437.14,-50404.69 443.14,-50413.42 447.28,-50407.77"/>
</g>
<!-- layer30_ffn1_2 -->
<g id="node433" class="node">
<title>layer30_ffn1_2</title>
<path fill="#e6f3ff" stroke="black" d="M359,-50260.47C359,-50260.47 89,-50260.47 89,-50260.47 83,-50260.47 77,-50254.47 77,-50248.47 77,-50248.47 77,-50225.47 77,-50225.47 77,-50219.47 83,-50213.47 89,-50213.47 89,-50213.47 359,-50213.47 359,-50213.47 365,-50213.47 371,-50219.47 371,-50225.47 371,-50225.47 371,-50248.47 371,-50248.47 371,-50254.47 365,-50260.47 359,-50260.47"/>
<text text-anchor="middle" x="224" y="-50245.47" font-family="Arial" font-size="10.00">Layer 30 FFN1 GPU2</text>
<text text-anchor="middle" x="224" y="-50234.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="224" y="-50223.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer30_attn_ar&#45;&gt;layer30_ffn1_2 -->
<g id="edge494" class="edge">
<title>layer30_attn_ar&#45;&gt;layer30_ffn1_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M344.35,-50332.42C318.28,-50311.96 285.78,-50286.45 261.12,-50267.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="263.11,-50264.21 253.08,-50260.79 258.79,-50269.72 263.11,-50264.21"/>
</g>
<!-- layer30_ffn1_3 -->
<g id="node434" class="node">
<title>layer30_ffn1_3</title>
<path fill="#e6f3ff" stroke="black" d="M689,-50260.47C689,-50260.47 419,-50260.47 419,-50260.47 413,-50260.47 407,-50254.47 407,-50248.47 407,-50248.47 407,-50225.47 407,-50225.47 407,-50219.47 413,-50213.47 419,-50213.47 419,-50213.47 689,-50213.47 689,-50213.47 695,-50213.47 701,-50219.47 701,-50225.47 701,-50225.47 701,-50248.47 701,-50248.47 701,-50254.47 695,-50260.47 689,-50260.47"/>
<text text-anchor="middle" x="554" y="-50245.47" font-family="Arial" font-size="10.00">Layer 30 FFN1 GPU3</text>
<text text-anchor="middle" x="554" y="-50234.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="554" y="-50223.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer30_attn_ar&#45;&gt;layer30_ffn1_3 -->
<g id="edge495" class="edge">
<title>layer30_attn_ar&#45;&gt;layer30_ffn1_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M433.65,-50332.42C459.72,-50311.96 492.22,-50286.45 516.88,-50267.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="519.21,-50269.72 524.92,-50260.79 514.89,-50264.21 519.21,-50269.72"/>
</g>
<!-- layer30_act_2 -->
<g id="node435" class="node">
<title>layer30_act_2</title>
<path fill="#e6f3ff" stroke="black" d="M359,-50141.47C359,-50141.47 89,-50141.47 89,-50141.47 83,-50141.47 77,-50135.47 77,-50129.47 77,-50129.47 77,-50106.47 77,-50106.47 77,-50100.47 83,-50094.47 89,-50094.47 89,-50094.47 359,-50094.47 359,-50094.47 365,-50094.47 371,-50100.47 371,-50106.47 371,-50106.47 371,-50129.47 371,-50129.47 371,-50135.47 365,-50141.47 359,-50141.47"/>
<text text-anchor="middle" x="224" y="-50126.47" font-family="Arial" font-size="10.00">Layer 30 SiLU GPU2</text>
<text text-anchor="middle" x="224" y="-50115.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="224" y="-50104.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer30_ffn1_2&#45;&gt;layer30_act_2 -->
<g id="edge496" class="edge">
<title>layer30_ffn1_2&#45;&gt;layer30_act_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M224,-50213.41C224,-50195.96 224,-50171.55 224,-50151.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="227.5,-50151.86 224,-50141.86 220.5,-50151.86 227.5,-50151.86"/>
</g>
<!-- layer30_act_3 -->
<g id="node436" class="node">
<title>layer30_act_3</title>
<path fill="#e6f3ff" stroke="black" d="M689,-50141.47C689,-50141.47 419,-50141.47 419,-50141.47 413,-50141.47 407,-50135.47 407,-50129.47 407,-50129.47 407,-50106.47 407,-50106.47 407,-50100.47 413,-50094.47 419,-50094.47 419,-50094.47 689,-50094.47 689,-50094.47 695,-50094.47 701,-50100.47 701,-50106.47 701,-50106.47 701,-50129.47 701,-50129.47 701,-50135.47 695,-50141.47 689,-50141.47"/>
<text text-anchor="middle" x="554" y="-50126.47" font-family="Arial" font-size="10.00">Layer 30 SiLU GPU3</text>
<text text-anchor="middle" x="554" y="-50115.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="554" y="-50104.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer30_ffn1_3&#45;&gt;layer30_act_3 -->
<g id="edge497" class="edge">
<title>layer30_ffn1_3&#45;&gt;layer30_act_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M554,-50213.41C554,-50195.96 554,-50171.55 554,-50151.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="557.5,-50151.86 554,-50141.86 550.5,-50151.86 557.5,-50151.86"/>
</g>
<!-- layer30_ffn2_2 -->
<g id="node437" class="node">
<title>layer30_ffn2_2</title>
<path fill="#e6f3ff" stroke="black" d="M358.5,-50022.47C358.5,-50022.47 95.5,-50022.47 95.5,-50022.47 89.5,-50022.47 83.5,-50016.47 83.5,-50010.47 83.5,-50010.47 83.5,-49987.47 83.5,-49987.47 83.5,-49981.47 89.5,-49975.47 95.5,-49975.47 95.5,-49975.47 358.5,-49975.47 358.5,-49975.47 364.5,-49975.47 370.5,-49981.47 370.5,-49987.47 370.5,-49987.47 370.5,-50010.47 370.5,-50010.47 370.5,-50016.47 364.5,-50022.47 358.5,-50022.47"/>
<text text-anchor="middle" x="227" y="-50007.47" font-family="Arial" font-size="10.00">Layer 30 FFN2 GPU2</text>
<text text-anchor="middle" x="227" y="-49996.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="227" y="-49985.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer30_act_2&#45;&gt;layer30_ffn2_2 -->
<g id="edge498" class="edge">
<title>layer30_act_2&#45;&gt;layer30_ffn2_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M224.58,-50094.41C225.03,-50076.96 225.65,-50052.55 226.16,-50032.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="229.66,-50032.94 226.41,-50022.86 222.66,-50032.76 229.66,-50032.94"/>
</g>
<!-- layer30_ffn2_3 -->
<g id="node438" class="node">
<title>layer30_ffn2_3</title>
<path fill="#e6f3ff" stroke="black" d="M683.5,-50022.47C683.5,-50022.47 420.5,-50022.47 420.5,-50022.47 414.5,-50022.47 408.5,-50016.47 408.5,-50010.47 408.5,-50010.47 408.5,-49987.47 408.5,-49987.47 408.5,-49981.47 414.5,-49975.47 420.5,-49975.47 420.5,-49975.47 683.5,-49975.47 683.5,-49975.47 689.5,-49975.47 695.5,-49981.47 695.5,-49987.47 695.5,-49987.47 695.5,-50010.47 695.5,-50010.47 695.5,-50016.47 689.5,-50022.47 683.5,-50022.47"/>
<text text-anchor="middle" x="552" y="-50007.47" font-family="Arial" font-size="10.00">Layer 30 FFN2 GPU3</text>
<text text-anchor="middle" x="552" y="-49996.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="552" y="-49985.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer30_act_3&#45;&gt;layer30_ffn2_3 -->
<g id="edge499" class="edge">
<title>layer30_act_3&#45;&gt;layer30_ffn2_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M553.61,-50094.41C553.32,-50076.96 552.9,-50052.55 552.56,-50032.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="556.06,-50032.8 552.39,-50022.86 549.06,-50032.92 556.06,-50032.8"/>
</g>
<!-- layer30_ffn_ar -->
<g id="node439" class="node">
<title>layer30_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M520.22,-49903.47C520.22,-49903.47 314.8,-49903.47 314.8,-49903.47 308.8,-49903.47 299,-49898.83 295.19,-49894.19 295.19,-49894.19 251.39,-49840.75 251.39,-49840.75 247.59,-49836.11 249.78,-49831.47 255.78,-49831.47 255.78,-49831.47 461.2,-49831.47 461.2,-49831.47 467.2,-49831.47 477,-49836.11 480.81,-49840.75 480.81,-49840.75 524.61,-49894.19 524.61,-49894.19 528.41,-49898.83 526.22,-49903.47 520.22,-49903.47"/>
<text text-anchor="middle" x="388" y="-49870.47" font-family="Arial" font-size="10.00">Layer 30 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="388" y="-49859.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer30_ffn2_2&#45;&gt;layer30_ffn_ar -->
<g id="edge500" class="edge">
<title>layer30_ffn2_2&#45;&gt;layer30_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M255.04,-49975.41C277.43,-49957.41 309.4,-49931.69 336.38,-49909.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="338.61,-49912.68 344.21,-49903.69 334.23,-49907.23 338.61,-49912.68"/>
</g>
<!-- layer30_ffn2_3&#45;&gt;layer30_ffn_ar -->
<g id="edge501" class="edge">
<title>layer30_ffn2_3&#45;&gt;layer30_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M523.43,-49975.41C500.63,-49957.41 468.06,-49931.69 440.58,-49909.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="442.62,-49907.14 432.6,-49903.69 438.28,-49912.63 442.62,-49907.14"/>
</g>
<!-- layer31_qkv_2 -->
<g id="node440" class="node">
<title>layer31_qkv_2</title>
<path fill="#e6f3ff" stroke="black" d="M358,-49759.47C358,-49759.47 60,-49759.47 60,-49759.47 54,-49759.47 48,-49753.47 48,-49747.47 48,-49747.47 48,-49724.47 48,-49724.47 48,-49718.47 54,-49712.47 60,-49712.47 60,-49712.47 358,-49712.47 358,-49712.47 364,-49712.47 370,-49718.47 370,-49724.47 370,-49724.47 370,-49747.47 370,-49747.47 370,-49753.47 364,-49759.47 358,-49759.47"/>
<text text-anchor="middle" x="209" y="-49744.47" font-family="Arial" font-size="10.00">Layer 31 QKV Proj GPU2</text>
<text text-anchor="middle" x="209" y="-49733.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="209" y="-49722.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer30_ffn_ar&#45;&gt;layer31_qkv_2 -->
<g id="edge502" class="edge">
<title>layer30_ffn_ar&#45;&gt;layer31_qkv_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M339.56,-49831.42C311.06,-49810.81 275.48,-49785.06 248.66,-49765.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="250.43,-49762.62 240.28,-49759.6 246.33,-49768.3 250.43,-49762.62"/>
</g>
<!-- layer31_qkv_3 -->
<g id="node441" class="node">
<title>layer31_qkv_3</title>
<path fill="#e6f3ff" stroke="black" d="M716,-49759.47C716,-49759.47 418,-49759.47 418,-49759.47 412,-49759.47 406,-49753.47 406,-49747.47 406,-49747.47 406,-49724.47 406,-49724.47 406,-49718.47 412,-49712.47 418,-49712.47 418,-49712.47 716,-49712.47 716,-49712.47 722,-49712.47 728,-49718.47 728,-49724.47 728,-49724.47 728,-49747.47 728,-49747.47 728,-49753.47 722,-49759.47 716,-49759.47"/>
<text text-anchor="middle" x="567" y="-49744.47" font-family="Arial" font-size="10.00">Layer 31 QKV Proj GPU3</text>
<text text-anchor="middle" x="567" y="-49733.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="567" y="-49722.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer30_ffn_ar&#45;&gt;layer31_qkv_3 -->
<g id="edge503" class="edge">
<title>layer30_ffn_ar&#45;&gt;layer31_qkv_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M436.44,-49831.42C464.94,-49810.81 500.52,-49785.06 527.34,-49765.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="529.67,-49768.3 535.72,-49759.6 525.57,-49762.62 529.67,-49768.3"/>
</g>
<!-- layer31_attn_2 -->
<g id="node442" class="node">
<title>layer31_attn_2</title>
<path fill="#e6f3ff" stroke="black" d="M358,-49640.47C358,-49640.47 60,-49640.47 60,-49640.47 54,-49640.47 48,-49634.47 48,-49628.47 48,-49628.47 48,-49605.47 48,-49605.47 48,-49599.47 54,-49593.47 60,-49593.47 60,-49593.47 358,-49593.47 358,-49593.47 364,-49593.47 370,-49599.47 370,-49605.47 370,-49605.47 370,-49628.47 370,-49628.47 370,-49634.47 364,-49640.47 358,-49640.47"/>
<text text-anchor="middle" x="209" y="-49625.47" font-family="Arial" font-size="10.00">Layer 31 Attention GPU2</text>
<text text-anchor="middle" x="209" y="-49614.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="209" y="-49603.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer31_qkv_2&#45;&gt;layer31_attn_2 -->
<g id="edge504" class="edge">
<title>layer31_qkv_2&#45;&gt;layer31_attn_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M209,-49712.41C209,-49694.96 209,-49670.55 209,-49650.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="212.5,-49650.86 209,-49640.86 205.5,-49650.86 212.5,-49650.86"/>
</g>
<!-- layer31_attn_3 -->
<g id="node443" class="node">
<title>layer31_attn_3</title>
<path fill="#e6f3ff" stroke="black" d="M716,-49640.47C716,-49640.47 418,-49640.47 418,-49640.47 412,-49640.47 406,-49634.47 406,-49628.47 406,-49628.47 406,-49605.47 406,-49605.47 406,-49599.47 412,-49593.47 418,-49593.47 418,-49593.47 716,-49593.47 716,-49593.47 722,-49593.47 728,-49599.47 728,-49605.47 728,-49605.47 728,-49628.47 728,-49628.47 728,-49634.47 722,-49640.47 716,-49640.47"/>
<text text-anchor="middle" x="567" y="-49625.47" font-family="Arial" font-size="10.00">Layer 31 Attention GPU3</text>
<text text-anchor="middle" x="567" y="-49614.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="567" y="-49603.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer31_qkv_3&#45;&gt;layer31_attn_3 -->
<g id="edge505" class="edge">
<title>layer31_qkv_3&#45;&gt;layer31_attn_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M567,-49712.41C567,-49694.96 567,-49670.55 567,-49650.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="570.5,-49650.86 567,-49640.86 563.5,-49650.86 570.5,-49650.86"/>
</g>
<!-- layer31_attn_out_2 -->
<g id="node444" class="node">
<title>layer31_attn_out_2</title>
<path fill="#e6f3ff" stroke="black" d="M358,-49521.47C358,-49521.47 68,-49521.47 68,-49521.47 62,-49521.47 56,-49515.47 56,-49509.47 56,-49509.47 56,-49486.47 56,-49486.47 56,-49480.47 62,-49474.47 68,-49474.47 68,-49474.47 358,-49474.47 358,-49474.47 364,-49474.47 370,-49480.47 370,-49486.47 370,-49486.47 370,-49509.47 370,-49509.47 370,-49515.47 364,-49521.47 358,-49521.47"/>
<text text-anchor="middle" x="213" y="-49506.47" font-family="Arial" font-size="10.00">Layer 31 Attn Out GPU2</text>
<text text-anchor="middle" x="213" y="-49495.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="213" y="-49484.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer31_attn_2&#45;&gt;layer31_attn_out_2 -->
<g id="edge506" class="edge">
<title>layer31_attn_2&#45;&gt;layer31_attn_out_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M209.77,-49593.41C210.37,-49575.96 211.2,-49551.55 211.87,-49531.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="215.37,-49531.97 212.22,-49521.86 208.38,-49531.73 215.37,-49531.97"/>
</g>
<!-- layer31_attn_out_3 -->
<g id="node445" class="node">
<title>layer31_attn_out_3</title>
<path fill="#e6f3ff" stroke="black" d="M710,-49521.47C710,-49521.47 420,-49521.47 420,-49521.47 414,-49521.47 408,-49515.47 408,-49509.47 408,-49509.47 408,-49486.47 408,-49486.47 408,-49480.47 414,-49474.47 420,-49474.47 420,-49474.47 710,-49474.47 710,-49474.47 716,-49474.47 722,-49480.47 722,-49486.47 722,-49486.47 722,-49509.47 722,-49509.47 722,-49515.47 716,-49521.47 710,-49521.47"/>
<text text-anchor="middle" x="565" y="-49506.47" font-family="Arial" font-size="10.00">Layer 31 Attn Out GPU3</text>
<text text-anchor="middle" x="565" y="-49495.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="565" y="-49484.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer31_attn_3&#45;&gt;layer31_attn_out_3 -->
<g id="edge507" class="edge">
<title>layer31_attn_3&#45;&gt;layer31_attn_out_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M566.61,-49593.41C566.32,-49575.96 565.9,-49551.55 565.56,-49531.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="569.06,-49531.8 565.39,-49521.86 562.06,-49531.92 569.06,-49531.8"/>
</g>
<!-- layer31_attn_ar -->
<g id="node446" class="node">
<title>layer31_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M518.07,-49402.47C518.07,-49402.47 316.07,-49402.47 316.07,-49402.47 310.07,-49402.47 300.3,-49397.8 296.53,-49393.13 296.53,-49393.13 253.47,-49339.8 253.47,-49339.8 249.7,-49335.14 251.93,-49330.47 257.93,-49330.47 257.93,-49330.47 459.93,-49330.47 459.93,-49330.47 465.93,-49330.47 475.7,-49335.14 479.47,-49339.8 479.47,-49339.8 522.53,-49393.13 522.53,-49393.13 526.3,-49397.8 524.07,-49402.47 518.07,-49402.47"/>
<text text-anchor="middle" x="388" y="-49369.47" font-family="Arial" font-size="10.00">Layer 31 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="388" y="-49358.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer31_attn_out_2&#45;&gt;layer31_attn_ar -->
<g id="edge508" class="edge">
<title>layer31_attn_out_2&#45;&gt;layer31_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M243.48,-49474.41C267.92,-49456.33 302.86,-49430.47 332.27,-49408.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="334.45,-49411.45 340.4,-49402.69 330.28,-49405.82 334.45,-49411.45"/>
</g>
<!-- layer31_attn_out_3&#45;&gt;layer31_attn_ar -->
<g id="edge509" class="edge">
<title>layer31_attn_out_3&#45;&gt;layer31_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M534.17,-49474.41C509.45,-49456.33 474.11,-49430.47 444.37,-49408.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="446.28,-49405.77 436.14,-49402.69 442.14,-49411.42 446.28,-49405.77"/>
</g>
<!-- layer31_ffn1_2 -->
<g id="node447" class="node">
<title>layer31_ffn1_2</title>
<path fill="#e6f3ff" stroke="black" d="M358,-49258.47C358,-49258.47 88,-49258.47 88,-49258.47 82,-49258.47 76,-49252.47 76,-49246.47 76,-49246.47 76,-49223.47 76,-49223.47 76,-49217.47 82,-49211.47 88,-49211.47 88,-49211.47 358,-49211.47 358,-49211.47 364,-49211.47 370,-49217.47 370,-49223.47 370,-49223.47 370,-49246.47 370,-49246.47 370,-49252.47 364,-49258.47 358,-49258.47"/>
<text text-anchor="middle" x="223" y="-49243.47" font-family="Arial" font-size="10.00">Layer 31 FFN1 GPU2</text>
<text text-anchor="middle" x="223" y="-49232.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="223" y="-49221.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer31_attn_ar&#45;&gt;layer31_ffn1_2 -->
<g id="edge510" class="edge">
<title>layer31_attn_ar&#45;&gt;layer31_ffn1_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M343.35,-49330.42C317.28,-49309.96 284.78,-49284.45 260.12,-49265.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="262.11,-49262.21 252.08,-49258.79 257.79,-49267.72 262.11,-49262.21"/>
</g>
<!-- layer31_ffn1_3 -->
<g id="node448" class="node">
<title>layer31_ffn1_3</title>
<path fill="#e6f3ff" stroke="black" d="M688,-49258.47C688,-49258.47 418,-49258.47 418,-49258.47 412,-49258.47 406,-49252.47 406,-49246.47 406,-49246.47 406,-49223.47 406,-49223.47 406,-49217.47 412,-49211.47 418,-49211.47 418,-49211.47 688,-49211.47 688,-49211.47 694,-49211.47 700,-49217.47 700,-49223.47 700,-49223.47 700,-49246.47 700,-49246.47 700,-49252.47 694,-49258.47 688,-49258.47"/>
<text text-anchor="middle" x="553" y="-49243.47" font-family="Arial" font-size="10.00">Layer 31 FFN1 GPU3</text>
<text text-anchor="middle" x="553" y="-49232.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="553" y="-49221.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer31_attn_ar&#45;&gt;layer31_ffn1_3 -->
<g id="edge511" class="edge">
<title>layer31_attn_ar&#45;&gt;layer31_ffn1_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M432.65,-49330.42C458.72,-49309.96 491.22,-49284.45 515.88,-49265.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="518.21,-49267.72 523.92,-49258.79 513.89,-49262.21 518.21,-49267.72"/>
</g>
<!-- layer31_act_2 -->
<g id="node449" class="node">
<title>layer31_act_2</title>
<path fill="#e6f3ff" stroke="black" d="M358,-49139.47C358,-49139.47 88,-49139.47 88,-49139.47 82,-49139.47 76,-49133.47 76,-49127.47 76,-49127.47 76,-49104.47 76,-49104.47 76,-49098.47 82,-49092.47 88,-49092.47 88,-49092.47 358,-49092.47 358,-49092.47 364,-49092.47 370,-49098.47 370,-49104.47 370,-49104.47 370,-49127.47 370,-49127.47 370,-49133.47 364,-49139.47 358,-49139.47"/>
<text text-anchor="middle" x="223" y="-49124.47" font-family="Arial" font-size="10.00">Layer 31 SiLU GPU2</text>
<text text-anchor="middle" x="223" y="-49113.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="223" y="-49102.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer31_ffn1_2&#45;&gt;layer31_act_2 -->
<g id="edge512" class="edge">
<title>layer31_ffn1_2&#45;&gt;layer31_act_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M223,-49211.41C223,-49193.96 223,-49169.55 223,-49149.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="226.5,-49149.86 223,-49139.86 219.5,-49149.86 226.5,-49149.86"/>
</g>
<!-- layer31_act_3 -->
<g id="node450" class="node">
<title>layer31_act_3</title>
<path fill="#e6f3ff" stroke="black" d="M688,-49139.47C688,-49139.47 418,-49139.47 418,-49139.47 412,-49139.47 406,-49133.47 406,-49127.47 406,-49127.47 406,-49104.47 406,-49104.47 406,-49098.47 412,-49092.47 418,-49092.47 418,-49092.47 688,-49092.47 688,-49092.47 694,-49092.47 700,-49098.47 700,-49104.47 700,-49104.47 700,-49127.47 700,-49127.47 700,-49133.47 694,-49139.47 688,-49139.47"/>
<text text-anchor="middle" x="553" y="-49124.47" font-family="Arial" font-size="10.00">Layer 31 SiLU GPU3</text>
<text text-anchor="middle" x="553" y="-49113.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="553" y="-49102.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer31_ffn1_3&#45;&gt;layer31_act_3 -->
<g id="edge513" class="edge">
<title>layer31_ffn1_3&#45;&gt;layer31_act_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M553,-49211.41C553,-49193.96 553,-49169.55 553,-49149.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="556.5,-49149.86 553,-49139.86 549.5,-49149.86 556.5,-49149.86"/>
</g>
<!-- layer31_ffn2_2 -->
<g id="node451" class="node">
<title>layer31_ffn2_2</title>
<path fill="#e6f3ff" stroke="black" d="M357.5,-49020.47C357.5,-49020.47 94.5,-49020.47 94.5,-49020.47 88.5,-49020.47 82.5,-49014.47 82.5,-49008.47 82.5,-49008.47 82.5,-48985.47 82.5,-48985.47 82.5,-48979.47 88.5,-48973.47 94.5,-48973.47 94.5,-48973.47 357.5,-48973.47 357.5,-48973.47 363.5,-48973.47 369.5,-48979.47 369.5,-48985.47 369.5,-48985.47 369.5,-49008.47 369.5,-49008.47 369.5,-49014.47 363.5,-49020.47 357.5,-49020.47"/>
<text text-anchor="middle" x="226" y="-49005.47" font-family="Arial" font-size="10.00">Layer 31 FFN2 GPU2</text>
<text text-anchor="middle" x="226" y="-48994.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="226" y="-48983.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer31_act_2&#45;&gt;layer31_ffn2_2 -->
<g id="edge514" class="edge">
<title>layer31_act_2&#45;&gt;layer31_ffn2_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M223.58,-49092.41C224.03,-49074.96 224.65,-49050.55 225.16,-49030.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="228.66,-49030.94 225.41,-49020.86 221.66,-49030.76 228.66,-49030.94"/>
</g>
<!-- layer31_ffn2_3 -->
<g id="node452" class="node">
<title>layer31_ffn2_3</title>
<path fill="#e6f3ff" stroke="black" d="M682.5,-49020.47C682.5,-49020.47 419.5,-49020.47 419.5,-49020.47 413.5,-49020.47 407.5,-49014.47 407.5,-49008.47 407.5,-49008.47 407.5,-48985.47 407.5,-48985.47 407.5,-48979.47 413.5,-48973.47 419.5,-48973.47 419.5,-48973.47 682.5,-48973.47 682.5,-48973.47 688.5,-48973.47 694.5,-48979.47 694.5,-48985.47 694.5,-48985.47 694.5,-49008.47 694.5,-49008.47 694.5,-49014.47 688.5,-49020.47 682.5,-49020.47"/>
<text text-anchor="middle" x="551" y="-49005.47" font-family="Arial" font-size="10.00">Layer 31 FFN2 GPU3</text>
<text text-anchor="middle" x="551" y="-48994.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="551" y="-48983.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer31_act_3&#45;&gt;layer31_ffn2_3 -->
<g id="edge515" class="edge">
<title>layer31_act_3&#45;&gt;layer31_ffn2_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M552.61,-49092.41C552.32,-49074.96 551.9,-49050.55 551.56,-49030.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="555.06,-49030.8 551.39,-49020.86 548.06,-49030.92 555.06,-49030.8"/>
</g>
<!-- layer31_ffn_ar -->
<g id="node453" class="node">
<title>layer31_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M519.22,-48901.47C519.22,-48901.47 313.8,-48901.47 313.8,-48901.47 307.8,-48901.47 298,-48896.83 294.19,-48892.19 294.19,-48892.19 250.39,-48838.75 250.39,-48838.75 246.59,-48834.11 248.78,-48829.47 254.78,-48829.47 254.78,-48829.47 460.2,-48829.47 460.2,-48829.47 466.2,-48829.47 476,-48834.11 479.81,-48838.75 479.81,-48838.75 523.61,-48892.19 523.61,-48892.19 527.41,-48896.83 525.22,-48901.47 519.22,-48901.47"/>
<text text-anchor="middle" x="387" y="-48868.47" font-family="Arial" font-size="10.00">Layer 31 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="387" y="-48857.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer31_ffn2_2&#45;&gt;layer31_ffn_ar -->
<g id="edge516" class="edge">
<title>layer31_ffn2_2&#45;&gt;layer31_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M254.04,-48973.41C276.43,-48955.41 308.4,-48929.69 335.38,-48907.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="337.61,-48910.68 343.21,-48901.69 333.23,-48905.23 337.61,-48910.68"/>
</g>
<!-- layer31_ffn2_3&#45;&gt;layer31_ffn_ar -->
<g id="edge517" class="edge">
<title>layer31_ffn2_3&#45;&gt;layer31_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M522.43,-48973.41C499.63,-48955.41 467.06,-48929.69 439.58,-48907.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="441.62,-48905.14 431.6,-48901.69 437.28,-48910.63 441.62,-48905.14"/>
</g>
<!-- layer32_qkv_2 -->
<g id="node454" class="node">
<title>layer32_qkv_2</title>
<path fill="#e6f3ff" stroke="black" d="M357,-48757.47C357,-48757.47 59,-48757.47 59,-48757.47 53,-48757.47 47,-48751.47 47,-48745.47 47,-48745.47 47,-48722.47 47,-48722.47 47,-48716.47 53,-48710.47 59,-48710.47 59,-48710.47 357,-48710.47 357,-48710.47 363,-48710.47 369,-48716.47 369,-48722.47 369,-48722.47 369,-48745.47 369,-48745.47 369,-48751.47 363,-48757.47 357,-48757.47"/>
<text text-anchor="middle" x="208" y="-48742.47" font-family="Arial" font-size="10.00">Layer 32 QKV Proj GPU2</text>
<text text-anchor="middle" x="208" y="-48731.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="208" y="-48720.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer31_ffn_ar&#45;&gt;layer32_qkv_2 -->
<g id="edge518" class="edge">
<title>layer31_ffn_ar&#45;&gt;layer32_qkv_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M338.56,-48829.42C310.06,-48808.81 274.48,-48783.06 247.66,-48763.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="249.43,-48760.62 239.28,-48757.6 245.33,-48766.3 249.43,-48760.62"/>
</g>
<!-- layer32_qkv_3 -->
<g id="node455" class="node">
<title>layer32_qkv_3</title>
<path fill="#e6f3ff" stroke="black" d="M715,-48757.47C715,-48757.47 417,-48757.47 417,-48757.47 411,-48757.47 405,-48751.47 405,-48745.47 405,-48745.47 405,-48722.47 405,-48722.47 405,-48716.47 411,-48710.47 417,-48710.47 417,-48710.47 715,-48710.47 715,-48710.47 721,-48710.47 727,-48716.47 727,-48722.47 727,-48722.47 727,-48745.47 727,-48745.47 727,-48751.47 721,-48757.47 715,-48757.47"/>
<text text-anchor="middle" x="566" y="-48742.47" font-family="Arial" font-size="10.00">Layer 32 QKV Proj GPU3</text>
<text text-anchor="middle" x="566" y="-48731.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="566" y="-48720.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer31_ffn_ar&#45;&gt;layer32_qkv_3 -->
<g id="edge519" class="edge">
<title>layer31_ffn_ar&#45;&gt;layer32_qkv_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M435.44,-48829.42C463.94,-48808.81 499.52,-48783.06 526.34,-48763.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="528.67,-48766.3 534.72,-48757.6 524.57,-48760.62 528.67,-48766.3"/>
</g>
<!-- layer32_attn_2 -->
<g id="node456" class="node">
<title>layer32_attn_2</title>
<path fill="#e6f3ff" stroke="black" d="M357,-48638.47C357,-48638.47 59,-48638.47 59,-48638.47 53,-48638.47 47,-48632.47 47,-48626.47 47,-48626.47 47,-48603.47 47,-48603.47 47,-48597.47 53,-48591.47 59,-48591.47 59,-48591.47 357,-48591.47 357,-48591.47 363,-48591.47 369,-48597.47 369,-48603.47 369,-48603.47 369,-48626.47 369,-48626.47 369,-48632.47 363,-48638.47 357,-48638.47"/>
<text text-anchor="middle" x="208" y="-48623.47" font-family="Arial" font-size="10.00">Layer 32 Attention GPU2</text>
<text text-anchor="middle" x="208" y="-48612.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="208" y="-48601.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer32_qkv_2&#45;&gt;layer32_attn_2 -->
<g id="edge520" class="edge">
<title>layer32_qkv_2&#45;&gt;layer32_attn_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M208,-48710.41C208,-48692.96 208,-48668.55 208,-48648.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="211.5,-48648.86 208,-48638.86 204.5,-48648.86 211.5,-48648.86"/>
</g>
<!-- layer32_attn_3 -->
<g id="node457" class="node">
<title>layer32_attn_3</title>
<path fill="#e6f3ff" stroke="black" d="M715,-48638.47C715,-48638.47 417,-48638.47 417,-48638.47 411,-48638.47 405,-48632.47 405,-48626.47 405,-48626.47 405,-48603.47 405,-48603.47 405,-48597.47 411,-48591.47 417,-48591.47 417,-48591.47 715,-48591.47 715,-48591.47 721,-48591.47 727,-48597.47 727,-48603.47 727,-48603.47 727,-48626.47 727,-48626.47 727,-48632.47 721,-48638.47 715,-48638.47"/>
<text text-anchor="middle" x="566" y="-48623.47" font-family="Arial" font-size="10.00">Layer 32 Attention GPU3</text>
<text text-anchor="middle" x="566" y="-48612.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="566" y="-48601.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer32_qkv_3&#45;&gt;layer32_attn_3 -->
<g id="edge521" class="edge">
<title>layer32_qkv_3&#45;&gt;layer32_attn_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M566,-48710.41C566,-48692.96 566,-48668.55 566,-48648.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="569.5,-48648.86 566,-48638.86 562.5,-48648.86 569.5,-48648.86"/>
</g>
<!-- layer32_attn_out_2 -->
<g id="node458" class="node">
<title>layer32_attn_out_2</title>
<path fill="#e6f3ff" stroke="black" d="M357,-48519.47C357,-48519.47 67,-48519.47 67,-48519.47 61,-48519.47 55,-48513.47 55,-48507.47 55,-48507.47 55,-48484.47 55,-48484.47 55,-48478.47 61,-48472.47 67,-48472.47 67,-48472.47 357,-48472.47 357,-48472.47 363,-48472.47 369,-48478.47 369,-48484.47 369,-48484.47 369,-48507.47 369,-48507.47 369,-48513.47 363,-48519.47 357,-48519.47"/>
<text text-anchor="middle" x="212" y="-48504.47" font-family="Arial" font-size="10.00">Layer 32 Attn Out GPU2</text>
<text text-anchor="middle" x="212" y="-48493.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="212" y="-48482.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer32_attn_2&#45;&gt;layer32_attn_out_2 -->
<g id="edge522" class="edge">
<title>layer32_attn_2&#45;&gt;layer32_attn_out_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M208.77,-48591.41C209.37,-48573.96 210.2,-48549.55 210.87,-48529.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="214.37,-48529.97 211.22,-48519.86 207.38,-48529.73 214.37,-48529.97"/>
</g>
<!-- layer32_attn_out_3 -->
<g id="node459" class="node">
<title>layer32_attn_out_3</title>
<path fill="#e6f3ff" stroke="black" d="M709,-48519.47C709,-48519.47 419,-48519.47 419,-48519.47 413,-48519.47 407,-48513.47 407,-48507.47 407,-48507.47 407,-48484.47 407,-48484.47 407,-48478.47 413,-48472.47 419,-48472.47 419,-48472.47 709,-48472.47 709,-48472.47 715,-48472.47 721,-48478.47 721,-48484.47 721,-48484.47 721,-48507.47 721,-48507.47 721,-48513.47 715,-48519.47 709,-48519.47"/>
<text text-anchor="middle" x="564" y="-48504.47" font-family="Arial" font-size="10.00">Layer 32 Attn Out GPU3</text>
<text text-anchor="middle" x="564" y="-48493.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="564" y="-48482.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer32_attn_3&#45;&gt;layer32_attn_out_3 -->
<g id="edge523" class="edge">
<title>layer32_attn_3&#45;&gt;layer32_attn_out_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M565.61,-48591.41C565.32,-48573.96 564.9,-48549.55 564.56,-48529.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="568.06,-48529.8 564.39,-48519.86 561.06,-48529.92 568.06,-48529.8"/>
</g>
<!-- layer32_attn_ar -->
<g id="node460" class="node">
<title>layer32_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M517.07,-48400.47C517.07,-48400.47 315.07,-48400.47 315.07,-48400.47 309.07,-48400.47 299.3,-48395.8 295.53,-48391.13 295.53,-48391.13 252.47,-48337.8 252.47,-48337.8 248.7,-48333.14 250.93,-48328.47 256.93,-48328.47 256.93,-48328.47 458.93,-48328.47 458.93,-48328.47 464.93,-48328.47 474.7,-48333.14 478.47,-48337.8 478.47,-48337.8 521.53,-48391.13 521.53,-48391.13 525.3,-48395.8 523.07,-48400.47 517.07,-48400.47"/>
<text text-anchor="middle" x="387" y="-48367.47" font-family="Arial" font-size="10.00">Layer 32 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="387" y="-48356.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer32_attn_out_2&#45;&gt;layer32_attn_ar -->
<g id="edge524" class="edge">
<title>layer32_attn_out_2&#45;&gt;layer32_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M242.48,-48472.41C266.92,-48454.33 301.86,-48428.47 331.27,-48406.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="333.45,-48409.45 339.4,-48400.69 329.28,-48403.82 333.45,-48409.45"/>
</g>
<!-- layer32_attn_out_3&#45;&gt;layer32_attn_ar -->
<g id="edge525" class="edge">
<title>layer32_attn_out_3&#45;&gt;layer32_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M533.17,-48472.41C508.45,-48454.33 473.11,-48428.47 443.37,-48406.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="445.28,-48403.77 435.14,-48400.69 441.14,-48409.42 445.28,-48403.77"/>
</g>
<!-- layer32_ffn1_2 -->
<g id="node461" class="node">
<title>layer32_ffn1_2</title>
<path fill="#e6f3ff" stroke="black" d="M357,-48256.47C357,-48256.47 87,-48256.47 87,-48256.47 81,-48256.47 75,-48250.47 75,-48244.47 75,-48244.47 75,-48221.47 75,-48221.47 75,-48215.47 81,-48209.47 87,-48209.47 87,-48209.47 357,-48209.47 357,-48209.47 363,-48209.47 369,-48215.47 369,-48221.47 369,-48221.47 369,-48244.47 369,-48244.47 369,-48250.47 363,-48256.47 357,-48256.47"/>
<text text-anchor="middle" x="222" y="-48241.47" font-family="Arial" font-size="10.00">Layer 32 FFN1 GPU2</text>
<text text-anchor="middle" x="222" y="-48230.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="222" y="-48219.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer32_attn_ar&#45;&gt;layer32_ffn1_2 -->
<g id="edge526" class="edge">
<title>layer32_attn_ar&#45;&gt;layer32_ffn1_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M342.35,-48328.42C316.28,-48307.96 283.78,-48282.45 259.12,-48263.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="261.11,-48260.21 251.08,-48256.79 256.79,-48265.72 261.11,-48260.21"/>
</g>
<!-- layer32_ffn1_3 -->
<g id="node462" class="node">
<title>layer32_ffn1_3</title>
<path fill="#e6f3ff" stroke="black" d="M687,-48256.47C687,-48256.47 417,-48256.47 417,-48256.47 411,-48256.47 405,-48250.47 405,-48244.47 405,-48244.47 405,-48221.47 405,-48221.47 405,-48215.47 411,-48209.47 417,-48209.47 417,-48209.47 687,-48209.47 687,-48209.47 693,-48209.47 699,-48215.47 699,-48221.47 699,-48221.47 699,-48244.47 699,-48244.47 699,-48250.47 693,-48256.47 687,-48256.47"/>
<text text-anchor="middle" x="552" y="-48241.47" font-family="Arial" font-size="10.00">Layer 32 FFN1 GPU3</text>
<text text-anchor="middle" x="552" y="-48230.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="552" y="-48219.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer32_attn_ar&#45;&gt;layer32_ffn1_3 -->
<g id="edge527" class="edge">
<title>layer32_attn_ar&#45;&gt;layer32_ffn1_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M431.65,-48328.42C457.72,-48307.96 490.22,-48282.45 514.88,-48263.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="517.21,-48265.72 522.92,-48256.79 512.89,-48260.21 517.21,-48265.72"/>
</g>
<!-- layer32_act_2 -->
<g id="node463" class="node">
<title>layer32_act_2</title>
<path fill="#e6f3ff" stroke="black" d="M357,-48137.47C357,-48137.47 87,-48137.47 87,-48137.47 81,-48137.47 75,-48131.47 75,-48125.47 75,-48125.47 75,-48102.47 75,-48102.47 75,-48096.47 81,-48090.47 87,-48090.47 87,-48090.47 357,-48090.47 357,-48090.47 363,-48090.47 369,-48096.47 369,-48102.47 369,-48102.47 369,-48125.47 369,-48125.47 369,-48131.47 363,-48137.47 357,-48137.47"/>
<text text-anchor="middle" x="222" y="-48122.47" font-family="Arial" font-size="10.00">Layer 32 SiLU GPU2</text>
<text text-anchor="middle" x="222" y="-48111.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="222" y="-48100.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer32_ffn1_2&#45;&gt;layer32_act_2 -->
<g id="edge528" class="edge">
<title>layer32_ffn1_2&#45;&gt;layer32_act_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M222,-48209.41C222,-48191.96 222,-48167.55 222,-48147.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="225.5,-48147.86 222,-48137.86 218.5,-48147.86 225.5,-48147.86"/>
</g>
<!-- layer32_act_3 -->
<g id="node464" class="node">
<title>layer32_act_3</title>
<path fill="#e6f3ff" stroke="black" d="M687,-48137.47C687,-48137.47 417,-48137.47 417,-48137.47 411,-48137.47 405,-48131.47 405,-48125.47 405,-48125.47 405,-48102.47 405,-48102.47 405,-48096.47 411,-48090.47 417,-48090.47 417,-48090.47 687,-48090.47 687,-48090.47 693,-48090.47 699,-48096.47 699,-48102.47 699,-48102.47 699,-48125.47 699,-48125.47 699,-48131.47 693,-48137.47 687,-48137.47"/>
<text text-anchor="middle" x="552" y="-48122.47" font-family="Arial" font-size="10.00">Layer 32 SiLU GPU3</text>
<text text-anchor="middle" x="552" y="-48111.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="552" y="-48100.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer32_ffn1_3&#45;&gt;layer32_act_3 -->
<g id="edge529" class="edge">
<title>layer32_ffn1_3&#45;&gt;layer32_act_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M552,-48209.41C552,-48191.96 552,-48167.55 552,-48147.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="555.5,-48147.86 552,-48137.86 548.5,-48147.86 555.5,-48147.86"/>
</g>
<!-- layer32_ffn2_2 -->
<g id="node465" class="node">
<title>layer32_ffn2_2</title>
<path fill="#e6f3ff" stroke="black" d="M356.5,-48018.47C356.5,-48018.47 93.5,-48018.47 93.5,-48018.47 87.5,-48018.47 81.5,-48012.47 81.5,-48006.47 81.5,-48006.47 81.5,-47983.47 81.5,-47983.47 81.5,-47977.47 87.5,-47971.47 93.5,-47971.47 93.5,-47971.47 356.5,-47971.47 356.5,-47971.47 362.5,-47971.47 368.5,-47977.47 368.5,-47983.47 368.5,-47983.47 368.5,-48006.47 368.5,-48006.47 368.5,-48012.47 362.5,-48018.47 356.5,-48018.47"/>
<text text-anchor="middle" x="225" y="-48003.47" font-family="Arial" font-size="10.00">Layer 32 FFN2 GPU2</text>
<text text-anchor="middle" x="225" y="-47992.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="225" y="-47981.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer32_act_2&#45;&gt;layer32_ffn2_2 -->
<g id="edge530" class="edge">
<title>layer32_act_2&#45;&gt;layer32_ffn2_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M222.58,-48090.41C223.03,-48072.96 223.65,-48048.55 224.16,-48028.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="227.66,-48028.94 224.41,-48018.86 220.66,-48028.76 227.66,-48028.94"/>
</g>
<!-- layer32_ffn2_3 -->
<g id="node466" class="node">
<title>layer32_ffn2_3</title>
<path fill="#e6f3ff" stroke="black" d="M681.5,-48018.47C681.5,-48018.47 418.5,-48018.47 418.5,-48018.47 412.5,-48018.47 406.5,-48012.47 406.5,-48006.47 406.5,-48006.47 406.5,-47983.47 406.5,-47983.47 406.5,-47977.47 412.5,-47971.47 418.5,-47971.47 418.5,-47971.47 681.5,-47971.47 681.5,-47971.47 687.5,-47971.47 693.5,-47977.47 693.5,-47983.47 693.5,-47983.47 693.5,-48006.47 693.5,-48006.47 693.5,-48012.47 687.5,-48018.47 681.5,-48018.47"/>
<text text-anchor="middle" x="550" y="-48003.47" font-family="Arial" font-size="10.00">Layer 32 FFN2 GPU3</text>
<text text-anchor="middle" x="550" y="-47992.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="550" y="-47981.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer32_act_3&#45;&gt;layer32_ffn2_3 -->
<g id="edge531" class="edge">
<title>layer32_act_3&#45;&gt;layer32_ffn2_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M551.61,-48090.41C551.32,-48072.96 550.9,-48048.55 550.56,-48028.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="554.06,-48028.8 550.39,-48018.86 547.06,-48028.92 554.06,-48028.8"/>
</g>
<!-- layer32_ffn_ar -->
<g id="node467" class="node">
<title>layer32_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M518.22,-47899.47C518.22,-47899.47 312.8,-47899.47 312.8,-47899.47 306.8,-47899.47 297,-47894.83 293.19,-47890.19 293.19,-47890.19 249.39,-47836.75 249.39,-47836.75 245.59,-47832.11 247.78,-47827.47 253.78,-47827.47 253.78,-47827.47 459.2,-47827.47 459.2,-47827.47 465.2,-47827.47 475,-47832.11 478.81,-47836.75 478.81,-47836.75 522.61,-47890.19 522.61,-47890.19 526.41,-47894.83 524.22,-47899.47 518.22,-47899.47"/>
<text text-anchor="middle" x="386" y="-47866.47" font-family="Arial" font-size="10.00">Layer 32 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="386" y="-47855.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer32_ffn2_2&#45;&gt;layer32_ffn_ar -->
<g id="edge532" class="edge">
<title>layer32_ffn2_2&#45;&gt;layer32_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M253.04,-47971.41C275.43,-47953.41 307.4,-47927.69 334.38,-47905.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="336.61,-47908.68 342.21,-47899.69 332.23,-47903.23 336.61,-47908.68"/>
</g>
<!-- layer32_ffn2_3&#45;&gt;layer32_ffn_ar -->
<g id="edge533" class="edge">
<title>layer32_ffn2_3&#45;&gt;layer32_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M521.43,-47971.41C498.63,-47953.41 466.06,-47927.69 438.58,-47905.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="440.62,-47903.14 430.6,-47899.69 436.28,-47908.63 440.62,-47903.14"/>
</g>
<!-- layer33_qkv_2 -->
<g id="node468" class="node">
<title>layer33_qkv_2</title>
<path fill="#e6f3ff" stroke="black" d="M356,-47755.47C356,-47755.47 58,-47755.47 58,-47755.47 52,-47755.47 46,-47749.47 46,-47743.47 46,-47743.47 46,-47720.47 46,-47720.47 46,-47714.47 52,-47708.47 58,-47708.47 58,-47708.47 356,-47708.47 356,-47708.47 362,-47708.47 368,-47714.47 368,-47720.47 368,-47720.47 368,-47743.47 368,-47743.47 368,-47749.47 362,-47755.47 356,-47755.47"/>
<text text-anchor="middle" x="207" y="-47740.47" font-family="Arial" font-size="10.00">Layer 33 QKV Proj GPU2</text>
<text text-anchor="middle" x="207" y="-47729.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="207" y="-47718.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer32_ffn_ar&#45;&gt;layer33_qkv_2 -->
<g id="edge534" class="edge">
<title>layer32_ffn_ar&#45;&gt;layer33_qkv_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M337.56,-47827.42C309.06,-47806.81 273.48,-47781.06 246.66,-47761.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="248.43,-47758.62 238.28,-47755.6 244.33,-47764.3 248.43,-47758.62"/>
</g>
<!-- layer33_qkv_3 -->
<g id="node469" class="node">
<title>layer33_qkv_3</title>
<path fill="#e6f3ff" stroke="black" d="M714,-47755.47C714,-47755.47 416,-47755.47 416,-47755.47 410,-47755.47 404,-47749.47 404,-47743.47 404,-47743.47 404,-47720.47 404,-47720.47 404,-47714.47 410,-47708.47 416,-47708.47 416,-47708.47 714,-47708.47 714,-47708.47 720,-47708.47 726,-47714.47 726,-47720.47 726,-47720.47 726,-47743.47 726,-47743.47 726,-47749.47 720,-47755.47 714,-47755.47"/>
<text text-anchor="middle" x="565" y="-47740.47" font-family="Arial" font-size="10.00">Layer 33 QKV Proj GPU3</text>
<text text-anchor="middle" x="565" y="-47729.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="565" y="-47718.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer32_ffn_ar&#45;&gt;layer33_qkv_3 -->
<g id="edge535" class="edge">
<title>layer32_ffn_ar&#45;&gt;layer33_qkv_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M434.44,-47827.42C462.94,-47806.81 498.52,-47781.06 525.34,-47761.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="527.67,-47764.3 533.72,-47755.6 523.57,-47758.62 527.67,-47764.3"/>
</g>
<!-- layer33_attn_2 -->
<g id="node470" class="node">
<title>layer33_attn_2</title>
<path fill="#e6f3ff" stroke="black" d="M356,-47636.47C356,-47636.47 58,-47636.47 58,-47636.47 52,-47636.47 46,-47630.47 46,-47624.47 46,-47624.47 46,-47601.47 46,-47601.47 46,-47595.47 52,-47589.47 58,-47589.47 58,-47589.47 356,-47589.47 356,-47589.47 362,-47589.47 368,-47595.47 368,-47601.47 368,-47601.47 368,-47624.47 368,-47624.47 368,-47630.47 362,-47636.47 356,-47636.47"/>
<text text-anchor="middle" x="207" y="-47621.47" font-family="Arial" font-size="10.00">Layer 33 Attention GPU2</text>
<text text-anchor="middle" x="207" y="-47610.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="207" y="-47599.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer33_qkv_2&#45;&gt;layer33_attn_2 -->
<g id="edge536" class="edge">
<title>layer33_qkv_2&#45;&gt;layer33_attn_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M207,-47708.41C207,-47690.96 207,-47666.55 207,-47646.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="210.5,-47646.86 207,-47636.86 203.5,-47646.86 210.5,-47646.86"/>
</g>
<!-- layer33_attn_3 -->
<g id="node471" class="node">
<title>layer33_attn_3</title>
<path fill="#e6f3ff" stroke="black" d="M714,-47636.47C714,-47636.47 416,-47636.47 416,-47636.47 410,-47636.47 404,-47630.47 404,-47624.47 404,-47624.47 404,-47601.47 404,-47601.47 404,-47595.47 410,-47589.47 416,-47589.47 416,-47589.47 714,-47589.47 714,-47589.47 720,-47589.47 726,-47595.47 726,-47601.47 726,-47601.47 726,-47624.47 726,-47624.47 726,-47630.47 720,-47636.47 714,-47636.47"/>
<text text-anchor="middle" x="565" y="-47621.47" font-family="Arial" font-size="10.00">Layer 33 Attention GPU3</text>
<text text-anchor="middle" x="565" y="-47610.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="565" y="-47599.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer33_qkv_3&#45;&gt;layer33_attn_3 -->
<g id="edge537" class="edge">
<title>layer33_qkv_3&#45;&gt;layer33_attn_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M565,-47708.41C565,-47690.96 565,-47666.55 565,-47646.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="568.5,-47646.86 565,-47636.86 561.5,-47646.86 568.5,-47646.86"/>
</g>
<!-- layer33_attn_out_2 -->
<g id="node472" class="node">
<title>layer33_attn_out_2</title>
<path fill="#e6f3ff" stroke="black" d="M356,-47517.47C356,-47517.47 66,-47517.47 66,-47517.47 60,-47517.47 54,-47511.47 54,-47505.47 54,-47505.47 54,-47482.47 54,-47482.47 54,-47476.47 60,-47470.47 66,-47470.47 66,-47470.47 356,-47470.47 356,-47470.47 362,-47470.47 368,-47476.47 368,-47482.47 368,-47482.47 368,-47505.47 368,-47505.47 368,-47511.47 362,-47517.47 356,-47517.47"/>
<text text-anchor="middle" x="211" y="-47502.47" font-family="Arial" font-size="10.00">Layer 33 Attn Out GPU2</text>
<text text-anchor="middle" x="211" y="-47491.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="211" y="-47480.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer33_attn_2&#45;&gt;layer33_attn_out_2 -->
<g id="edge538" class="edge">
<title>layer33_attn_2&#45;&gt;layer33_attn_out_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M207.77,-47589.41C208.37,-47571.96 209.2,-47547.55 209.87,-47527.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="213.37,-47527.97 210.22,-47517.86 206.38,-47527.73 213.37,-47527.97"/>
</g>
<!-- layer33_attn_out_3 -->
<g id="node473" class="node">
<title>layer33_attn_out_3</title>
<path fill="#e6f3ff" stroke="black" d="M708,-47517.47C708,-47517.47 418,-47517.47 418,-47517.47 412,-47517.47 406,-47511.47 406,-47505.47 406,-47505.47 406,-47482.47 406,-47482.47 406,-47476.47 412,-47470.47 418,-47470.47 418,-47470.47 708,-47470.47 708,-47470.47 714,-47470.47 720,-47476.47 720,-47482.47 720,-47482.47 720,-47505.47 720,-47505.47 720,-47511.47 714,-47517.47 708,-47517.47"/>
<text text-anchor="middle" x="563" y="-47502.47" font-family="Arial" font-size="10.00">Layer 33 Attn Out GPU3</text>
<text text-anchor="middle" x="563" y="-47491.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="563" y="-47480.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer33_attn_3&#45;&gt;layer33_attn_out_3 -->
<g id="edge539" class="edge">
<title>layer33_attn_3&#45;&gt;layer33_attn_out_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M564.61,-47589.41C564.32,-47571.96 563.9,-47547.55 563.56,-47527.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="567.06,-47527.8 563.39,-47517.86 560.06,-47527.92 567.06,-47527.8"/>
</g>
<!-- layer33_attn_ar -->
<g id="node474" class="node">
<title>layer33_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M516.07,-47398.47C516.07,-47398.47 314.07,-47398.47 314.07,-47398.47 308.07,-47398.47 298.3,-47393.8 294.53,-47389.13 294.53,-47389.13 251.47,-47335.8 251.47,-47335.8 247.7,-47331.14 249.93,-47326.47 255.93,-47326.47 255.93,-47326.47 457.93,-47326.47 457.93,-47326.47 463.93,-47326.47 473.7,-47331.14 477.47,-47335.8 477.47,-47335.8 520.53,-47389.13 520.53,-47389.13 524.3,-47393.8 522.07,-47398.47 516.07,-47398.47"/>
<text text-anchor="middle" x="386" y="-47365.47" font-family="Arial" font-size="10.00">Layer 33 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="386" y="-47354.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer33_attn_out_2&#45;&gt;layer33_attn_ar -->
<g id="edge540" class="edge">
<title>layer33_attn_out_2&#45;&gt;layer33_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M241.48,-47470.41C265.92,-47452.33 300.86,-47426.47 330.27,-47404.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="332.45,-47407.45 338.4,-47398.69 328.28,-47401.82 332.45,-47407.45"/>
</g>
<!-- layer33_attn_out_3&#45;&gt;layer33_attn_ar -->
<g id="edge541" class="edge">
<title>layer33_attn_out_3&#45;&gt;layer33_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M532.17,-47470.41C507.45,-47452.33 472.11,-47426.47 442.37,-47404.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="444.28,-47401.77 434.14,-47398.69 440.14,-47407.42 444.28,-47401.77"/>
</g>
<!-- layer33_ffn1_2 -->
<g id="node475" class="node">
<title>layer33_ffn1_2</title>
<path fill="#e6f3ff" stroke="black" d="M356,-47254.47C356,-47254.47 86,-47254.47 86,-47254.47 80,-47254.47 74,-47248.47 74,-47242.47 74,-47242.47 74,-47219.47 74,-47219.47 74,-47213.47 80,-47207.47 86,-47207.47 86,-47207.47 356,-47207.47 356,-47207.47 362,-47207.47 368,-47213.47 368,-47219.47 368,-47219.47 368,-47242.47 368,-47242.47 368,-47248.47 362,-47254.47 356,-47254.47"/>
<text text-anchor="middle" x="221" y="-47239.47" font-family="Arial" font-size="10.00">Layer 33 FFN1 GPU2</text>
<text text-anchor="middle" x="221" y="-47228.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="221" y="-47217.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer33_attn_ar&#45;&gt;layer33_ffn1_2 -->
<g id="edge542" class="edge">
<title>layer33_attn_ar&#45;&gt;layer33_ffn1_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M341.35,-47326.42C315.28,-47305.96 282.78,-47280.45 258.12,-47261.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="260.11,-47258.21 250.08,-47254.79 255.79,-47263.72 260.11,-47258.21"/>
</g>
<!-- layer33_ffn1_3 -->
<g id="node476" class="node">
<title>layer33_ffn1_3</title>
<path fill="#e6f3ff" stroke="black" d="M686,-47254.47C686,-47254.47 416,-47254.47 416,-47254.47 410,-47254.47 404,-47248.47 404,-47242.47 404,-47242.47 404,-47219.47 404,-47219.47 404,-47213.47 410,-47207.47 416,-47207.47 416,-47207.47 686,-47207.47 686,-47207.47 692,-47207.47 698,-47213.47 698,-47219.47 698,-47219.47 698,-47242.47 698,-47242.47 698,-47248.47 692,-47254.47 686,-47254.47"/>
<text text-anchor="middle" x="551" y="-47239.47" font-family="Arial" font-size="10.00">Layer 33 FFN1 GPU3</text>
<text text-anchor="middle" x="551" y="-47228.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="551" y="-47217.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer33_attn_ar&#45;&gt;layer33_ffn1_3 -->
<g id="edge543" class="edge">
<title>layer33_attn_ar&#45;&gt;layer33_ffn1_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M430.65,-47326.42C456.72,-47305.96 489.22,-47280.45 513.88,-47261.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="516.21,-47263.72 521.92,-47254.79 511.89,-47258.21 516.21,-47263.72"/>
</g>
<!-- layer33_act_2 -->
<g id="node477" class="node">
<title>layer33_act_2</title>
<path fill="#e6f3ff" stroke="black" d="M356,-47135.47C356,-47135.47 86,-47135.47 86,-47135.47 80,-47135.47 74,-47129.47 74,-47123.47 74,-47123.47 74,-47100.47 74,-47100.47 74,-47094.47 80,-47088.47 86,-47088.47 86,-47088.47 356,-47088.47 356,-47088.47 362,-47088.47 368,-47094.47 368,-47100.47 368,-47100.47 368,-47123.47 368,-47123.47 368,-47129.47 362,-47135.47 356,-47135.47"/>
<text text-anchor="middle" x="221" y="-47120.47" font-family="Arial" font-size="10.00">Layer 33 SiLU GPU2</text>
<text text-anchor="middle" x="221" y="-47109.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="221" y="-47098.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer33_ffn1_2&#45;&gt;layer33_act_2 -->
<g id="edge544" class="edge">
<title>layer33_ffn1_2&#45;&gt;layer33_act_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M221,-47207.41C221,-47189.96 221,-47165.55 221,-47145.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="224.5,-47145.86 221,-47135.86 217.5,-47145.86 224.5,-47145.86"/>
</g>
<!-- layer33_act_3 -->
<g id="node478" class="node">
<title>layer33_act_3</title>
<path fill="#e6f3ff" stroke="black" d="M686,-47135.47C686,-47135.47 416,-47135.47 416,-47135.47 410,-47135.47 404,-47129.47 404,-47123.47 404,-47123.47 404,-47100.47 404,-47100.47 404,-47094.47 410,-47088.47 416,-47088.47 416,-47088.47 686,-47088.47 686,-47088.47 692,-47088.47 698,-47094.47 698,-47100.47 698,-47100.47 698,-47123.47 698,-47123.47 698,-47129.47 692,-47135.47 686,-47135.47"/>
<text text-anchor="middle" x="551" y="-47120.47" font-family="Arial" font-size="10.00">Layer 33 SiLU GPU3</text>
<text text-anchor="middle" x="551" y="-47109.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="551" y="-47098.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer33_ffn1_3&#45;&gt;layer33_act_3 -->
<g id="edge545" class="edge">
<title>layer33_ffn1_3&#45;&gt;layer33_act_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M551,-47207.41C551,-47189.96 551,-47165.55 551,-47145.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="554.5,-47145.86 551,-47135.86 547.5,-47145.86 554.5,-47145.86"/>
</g>
<!-- layer33_ffn2_2 -->
<g id="node479" class="node">
<title>layer33_ffn2_2</title>
<path fill="#e6f3ff" stroke="black" d="M355.5,-47016.47C355.5,-47016.47 92.5,-47016.47 92.5,-47016.47 86.5,-47016.47 80.5,-47010.47 80.5,-47004.47 80.5,-47004.47 80.5,-46981.47 80.5,-46981.47 80.5,-46975.47 86.5,-46969.47 92.5,-46969.47 92.5,-46969.47 355.5,-46969.47 355.5,-46969.47 361.5,-46969.47 367.5,-46975.47 367.5,-46981.47 367.5,-46981.47 367.5,-47004.47 367.5,-47004.47 367.5,-47010.47 361.5,-47016.47 355.5,-47016.47"/>
<text text-anchor="middle" x="224" y="-47001.47" font-family="Arial" font-size="10.00">Layer 33 FFN2 GPU2</text>
<text text-anchor="middle" x="224" y="-46990.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="224" y="-46979.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer33_act_2&#45;&gt;layer33_ffn2_2 -->
<g id="edge546" class="edge">
<title>layer33_act_2&#45;&gt;layer33_ffn2_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M221.58,-47088.41C222.03,-47070.96 222.65,-47046.55 223.16,-47026.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="226.66,-47026.94 223.41,-47016.86 219.66,-47026.76 226.66,-47026.94"/>
</g>
<!-- layer33_ffn2_3 -->
<g id="node480" class="node">
<title>layer33_ffn2_3</title>
<path fill="#e6f3ff" stroke="black" d="M680.5,-47016.47C680.5,-47016.47 417.5,-47016.47 417.5,-47016.47 411.5,-47016.47 405.5,-47010.47 405.5,-47004.47 405.5,-47004.47 405.5,-46981.47 405.5,-46981.47 405.5,-46975.47 411.5,-46969.47 417.5,-46969.47 417.5,-46969.47 680.5,-46969.47 680.5,-46969.47 686.5,-46969.47 692.5,-46975.47 692.5,-46981.47 692.5,-46981.47 692.5,-47004.47 692.5,-47004.47 692.5,-47010.47 686.5,-47016.47 680.5,-47016.47"/>
<text text-anchor="middle" x="549" y="-47001.47" font-family="Arial" font-size="10.00">Layer 33 FFN2 GPU3</text>
<text text-anchor="middle" x="549" y="-46990.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="549" y="-46979.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer33_act_3&#45;&gt;layer33_ffn2_3 -->
<g id="edge547" class="edge">
<title>layer33_act_3&#45;&gt;layer33_ffn2_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M550.61,-47088.41C550.32,-47070.96 549.9,-47046.55 549.56,-47026.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="553.06,-47026.8 549.39,-47016.86 546.06,-47026.92 553.06,-47026.8"/>
</g>
<!-- layer33_ffn_ar -->
<g id="node481" class="node">
<title>layer33_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M517.22,-46897.47C517.22,-46897.47 311.8,-46897.47 311.8,-46897.47 305.8,-46897.47 296,-46892.83 292.19,-46888.19 292.19,-46888.19 248.39,-46834.75 248.39,-46834.75 244.59,-46830.11 246.78,-46825.47 252.78,-46825.47 252.78,-46825.47 458.2,-46825.47 458.2,-46825.47 464.2,-46825.47 474,-46830.11 477.81,-46834.75 477.81,-46834.75 521.61,-46888.19 521.61,-46888.19 525.41,-46892.83 523.22,-46897.47 517.22,-46897.47"/>
<text text-anchor="middle" x="385" y="-46864.47" font-family="Arial" font-size="10.00">Layer 33 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="385" y="-46853.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer33_ffn2_2&#45;&gt;layer33_ffn_ar -->
<g id="edge548" class="edge">
<title>layer33_ffn2_2&#45;&gt;layer33_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M252.04,-46969.41C274.43,-46951.41 306.4,-46925.69 333.38,-46903.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="335.61,-46906.68 341.21,-46897.69 331.23,-46901.23 335.61,-46906.68"/>
</g>
<!-- layer33_ffn2_3&#45;&gt;layer33_ffn_ar -->
<g id="edge549" class="edge">
<title>layer33_ffn2_3&#45;&gt;layer33_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M520.43,-46969.41C497.63,-46951.41 465.06,-46925.69 437.58,-46903.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="439.62,-46901.14 429.6,-46897.69 435.28,-46906.63 439.62,-46901.14"/>
</g>
<!-- layer34_qkv_2 -->
<g id="node482" class="node">
<title>layer34_qkv_2</title>
<path fill="#e6f3ff" stroke="black" d="M355,-46753.47C355,-46753.47 57,-46753.47 57,-46753.47 51,-46753.47 45,-46747.47 45,-46741.47 45,-46741.47 45,-46718.47 45,-46718.47 45,-46712.47 51,-46706.47 57,-46706.47 57,-46706.47 355,-46706.47 355,-46706.47 361,-46706.47 367,-46712.47 367,-46718.47 367,-46718.47 367,-46741.47 367,-46741.47 367,-46747.47 361,-46753.47 355,-46753.47"/>
<text text-anchor="middle" x="206" y="-46738.47" font-family="Arial" font-size="10.00">Layer 34 QKV Proj GPU2</text>
<text text-anchor="middle" x="206" y="-46727.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="206" y="-46716.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer33_ffn_ar&#45;&gt;layer34_qkv_2 -->
<g id="edge550" class="edge">
<title>layer33_ffn_ar&#45;&gt;layer34_qkv_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M336.56,-46825.42C308.06,-46804.81 272.48,-46779.06 245.66,-46759.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="247.43,-46756.62 237.28,-46753.6 243.33,-46762.3 247.43,-46756.62"/>
</g>
<!-- layer34_qkv_3 -->
<g id="node483" class="node">
<title>layer34_qkv_3</title>
<path fill="#e6f3ff" stroke="black" d="M713,-46753.47C713,-46753.47 415,-46753.47 415,-46753.47 409,-46753.47 403,-46747.47 403,-46741.47 403,-46741.47 403,-46718.47 403,-46718.47 403,-46712.47 409,-46706.47 415,-46706.47 415,-46706.47 713,-46706.47 713,-46706.47 719,-46706.47 725,-46712.47 725,-46718.47 725,-46718.47 725,-46741.47 725,-46741.47 725,-46747.47 719,-46753.47 713,-46753.47"/>
<text text-anchor="middle" x="564" y="-46738.47" font-family="Arial" font-size="10.00">Layer 34 QKV Proj GPU3</text>
<text text-anchor="middle" x="564" y="-46727.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="564" y="-46716.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer33_ffn_ar&#45;&gt;layer34_qkv_3 -->
<g id="edge551" class="edge">
<title>layer33_ffn_ar&#45;&gt;layer34_qkv_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M433.44,-46825.42C461.94,-46804.81 497.52,-46779.06 524.34,-46759.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="526.67,-46762.3 532.72,-46753.6 522.57,-46756.62 526.67,-46762.3"/>
</g>
<!-- layer34_attn_2 -->
<g id="node484" class="node">
<title>layer34_attn_2</title>
<path fill="#e6f3ff" stroke="black" d="M355,-46634.47C355,-46634.47 57,-46634.47 57,-46634.47 51,-46634.47 45,-46628.47 45,-46622.47 45,-46622.47 45,-46599.47 45,-46599.47 45,-46593.47 51,-46587.47 57,-46587.47 57,-46587.47 355,-46587.47 355,-46587.47 361,-46587.47 367,-46593.47 367,-46599.47 367,-46599.47 367,-46622.47 367,-46622.47 367,-46628.47 361,-46634.47 355,-46634.47"/>
<text text-anchor="middle" x="206" y="-46619.47" font-family="Arial" font-size="10.00">Layer 34 Attention GPU2</text>
<text text-anchor="middle" x="206" y="-46608.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="206" y="-46597.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer34_qkv_2&#45;&gt;layer34_attn_2 -->
<g id="edge552" class="edge">
<title>layer34_qkv_2&#45;&gt;layer34_attn_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M206,-46706.41C206,-46688.96 206,-46664.55 206,-46644.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="209.5,-46644.86 206,-46634.86 202.5,-46644.86 209.5,-46644.86"/>
</g>
<!-- layer34_attn_3 -->
<g id="node485" class="node">
<title>layer34_attn_3</title>
<path fill="#e6f3ff" stroke="black" d="M713,-46634.47C713,-46634.47 415,-46634.47 415,-46634.47 409,-46634.47 403,-46628.47 403,-46622.47 403,-46622.47 403,-46599.47 403,-46599.47 403,-46593.47 409,-46587.47 415,-46587.47 415,-46587.47 713,-46587.47 713,-46587.47 719,-46587.47 725,-46593.47 725,-46599.47 725,-46599.47 725,-46622.47 725,-46622.47 725,-46628.47 719,-46634.47 713,-46634.47"/>
<text text-anchor="middle" x="564" y="-46619.47" font-family="Arial" font-size="10.00">Layer 34 Attention GPU3</text>
<text text-anchor="middle" x="564" y="-46608.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="564" y="-46597.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer34_qkv_3&#45;&gt;layer34_attn_3 -->
<g id="edge553" class="edge">
<title>layer34_qkv_3&#45;&gt;layer34_attn_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M564,-46706.41C564,-46688.96 564,-46664.55 564,-46644.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="567.5,-46644.86 564,-46634.86 560.5,-46644.86 567.5,-46644.86"/>
</g>
<!-- layer34_attn_out_2 -->
<g id="node486" class="node">
<title>layer34_attn_out_2</title>
<path fill="#e6f3ff" stroke="black" d="M355,-46515.47C355,-46515.47 65,-46515.47 65,-46515.47 59,-46515.47 53,-46509.47 53,-46503.47 53,-46503.47 53,-46480.47 53,-46480.47 53,-46474.47 59,-46468.47 65,-46468.47 65,-46468.47 355,-46468.47 355,-46468.47 361,-46468.47 367,-46474.47 367,-46480.47 367,-46480.47 367,-46503.47 367,-46503.47 367,-46509.47 361,-46515.47 355,-46515.47"/>
<text text-anchor="middle" x="210" y="-46500.47" font-family="Arial" font-size="10.00">Layer 34 Attn Out GPU2</text>
<text text-anchor="middle" x="210" y="-46489.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="210" y="-46478.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer34_attn_2&#45;&gt;layer34_attn_out_2 -->
<g id="edge554" class="edge">
<title>layer34_attn_2&#45;&gt;layer34_attn_out_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M206.77,-46587.41C207.37,-46569.96 208.2,-46545.55 208.87,-46525.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="212.37,-46525.97 209.22,-46515.86 205.38,-46525.73 212.37,-46525.97"/>
</g>
<!-- layer34_attn_out_3 -->
<g id="node487" class="node">
<title>layer34_attn_out_3</title>
<path fill="#e6f3ff" stroke="black" d="M707,-46515.47C707,-46515.47 417,-46515.47 417,-46515.47 411,-46515.47 405,-46509.47 405,-46503.47 405,-46503.47 405,-46480.47 405,-46480.47 405,-46474.47 411,-46468.47 417,-46468.47 417,-46468.47 707,-46468.47 707,-46468.47 713,-46468.47 719,-46474.47 719,-46480.47 719,-46480.47 719,-46503.47 719,-46503.47 719,-46509.47 713,-46515.47 707,-46515.47"/>
<text text-anchor="middle" x="562" y="-46500.47" font-family="Arial" font-size="10.00">Layer 34 Attn Out GPU3</text>
<text text-anchor="middle" x="562" y="-46489.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="562" y="-46478.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer34_attn_3&#45;&gt;layer34_attn_out_3 -->
<g id="edge555" class="edge">
<title>layer34_attn_3&#45;&gt;layer34_attn_out_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M563.61,-46587.41C563.32,-46569.96 562.9,-46545.55 562.56,-46525.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="566.06,-46525.8 562.39,-46515.86 559.06,-46525.92 566.06,-46525.8"/>
</g>
<!-- layer34_attn_ar -->
<g id="node488" class="node">
<title>layer34_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M515.07,-46396.47C515.07,-46396.47 313.07,-46396.47 313.07,-46396.47 307.07,-46396.47 297.3,-46391.8 293.53,-46387.13 293.53,-46387.13 250.47,-46333.8 250.47,-46333.8 246.7,-46329.14 248.93,-46324.47 254.93,-46324.47 254.93,-46324.47 456.93,-46324.47 456.93,-46324.47 462.93,-46324.47 472.7,-46329.14 476.47,-46333.8 476.47,-46333.8 519.53,-46387.13 519.53,-46387.13 523.3,-46391.8 521.07,-46396.47 515.07,-46396.47"/>
<text text-anchor="middle" x="385" y="-46363.47" font-family="Arial" font-size="10.00">Layer 34 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="385" y="-46352.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer34_attn_out_2&#45;&gt;layer34_attn_ar -->
<g id="edge556" class="edge">
<title>layer34_attn_out_2&#45;&gt;layer34_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M240.48,-46468.41C264.92,-46450.33 299.86,-46424.47 329.27,-46402.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="331.45,-46405.45 337.4,-46396.69 327.28,-46399.82 331.45,-46405.45"/>
</g>
<!-- layer34_attn_out_3&#45;&gt;layer34_attn_ar -->
<g id="edge557" class="edge">
<title>layer34_attn_out_3&#45;&gt;layer34_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M531.17,-46468.41C506.45,-46450.33 471.11,-46424.47 441.37,-46402.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="443.28,-46399.77 433.14,-46396.69 439.14,-46405.42 443.28,-46399.77"/>
</g>
<!-- layer34_ffn1_2 -->
<g id="node489" class="node">
<title>layer34_ffn1_2</title>
<path fill="#e6f3ff" stroke="black" d="M355,-46252.47C355,-46252.47 85,-46252.47 85,-46252.47 79,-46252.47 73,-46246.47 73,-46240.47 73,-46240.47 73,-46217.47 73,-46217.47 73,-46211.47 79,-46205.47 85,-46205.47 85,-46205.47 355,-46205.47 355,-46205.47 361,-46205.47 367,-46211.47 367,-46217.47 367,-46217.47 367,-46240.47 367,-46240.47 367,-46246.47 361,-46252.47 355,-46252.47"/>
<text text-anchor="middle" x="220" y="-46237.47" font-family="Arial" font-size="10.00">Layer 34 FFN1 GPU2</text>
<text text-anchor="middle" x="220" y="-46226.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="220" y="-46215.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer34_attn_ar&#45;&gt;layer34_ffn1_2 -->
<g id="edge558" class="edge">
<title>layer34_attn_ar&#45;&gt;layer34_ffn1_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M340.35,-46324.42C314.28,-46303.96 281.78,-46278.45 257.12,-46259.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="259.11,-46256.21 249.08,-46252.79 254.79,-46261.72 259.11,-46256.21"/>
</g>
<!-- layer34_ffn1_3 -->
<g id="node490" class="node">
<title>layer34_ffn1_3</title>
<path fill="#e6f3ff" stroke="black" d="M685,-46252.47C685,-46252.47 415,-46252.47 415,-46252.47 409,-46252.47 403,-46246.47 403,-46240.47 403,-46240.47 403,-46217.47 403,-46217.47 403,-46211.47 409,-46205.47 415,-46205.47 415,-46205.47 685,-46205.47 685,-46205.47 691,-46205.47 697,-46211.47 697,-46217.47 697,-46217.47 697,-46240.47 697,-46240.47 697,-46246.47 691,-46252.47 685,-46252.47"/>
<text text-anchor="middle" x="550" y="-46237.47" font-family="Arial" font-size="10.00">Layer 34 FFN1 GPU3</text>
<text text-anchor="middle" x="550" y="-46226.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-46215.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer34_attn_ar&#45;&gt;layer34_ffn1_3 -->
<g id="edge559" class="edge">
<title>layer34_attn_ar&#45;&gt;layer34_ffn1_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M429.65,-46324.42C455.72,-46303.96 488.22,-46278.45 512.88,-46259.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="515.21,-46261.72 520.92,-46252.79 510.89,-46256.21 515.21,-46261.72"/>
</g>
<!-- layer34_act_2 -->
<g id="node491" class="node">
<title>layer34_act_2</title>
<path fill="#e6f3ff" stroke="black" d="M355,-46133.47C355,-46133.47 85,-46133.47 85,-46133.47 79,-46133.47 73,-46127.47 73,-46121.47 73,-46121.47 73,-46098.47 73,-46098.47 73,-46092.47 79,-46086.47 85,-46086.47 85,-46086.47 355,-46086.47 355,-46086.47 361,-46086.47 367,-46092.47 367,-46098.47 367,-46098.47 367,-46121.47 367,-46121.47 367,-46127.47 361,-46133.47 355,-46133.47"/>
<text text-anchor="middle" x="220" y="-46118.47" font-family="Arial" font-size="10.00">Layer 34 SiLU GPU2</text>
<text text-anchor="middle" x="220" y="-46107.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="220" y="-46096.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer34_ffn1_2&#45;&gt;layer34_act_2 -->
<g id="edge560" class="edge">
<title>layer34_ffn1_2&#45;&gt;layer34_act_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M220,-46205.41C220,-46187.96 220,-46163.55 220,-46143.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="223.5,-46143.86 220,-46133.86 216.5,-46143.86 223.5,-46143.86"/>
</g>
<!-- layer34_act_3 -->
<g id="node492" class="node">
<title>layer34_act_3</title>
<path fill="#e6f3ff" stroke="black" d="M685,-46133.47C685,-46133.47 415,-46133.47 415,-46133.47 409,-46133.47 403,-46127.47 403,-46121.47 403,-46121.47 403,-46098.47 403,-46098.47 403,-46092.47 409,-46086.47 415,-46086.47 415,-46086.47 685,-46086.47 685,-46086.47 691,-46086.47 697,-46092.47 697,-46098.47 697,-46098.47 697,-46121.47 697,-46121.47 697,-46127.47 691,-46133.47 685,-46133.47"/>
<text text-anchor="middle" x="550" y="-46118.47" font-family="Arial" font-size="10.00">Layer 34 SiLU GPU3</text>
<text text-anchor="middle" x="550" y="-46107.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="550" y="-46096.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer34_ffn1_3&#45;&gt;layer34_act_3 -->
<g id="edge561" class="edge">
<title>layer34_ffn1_3&#45;&gt;layer34_act_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M550,-46205.41C550,-46187.96 550,-46163.55 550,-46143.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="553.5,-46143.86 550,-46133.86 546.5,-46143.86 553.5,-46143.86"/>
</g>
<!-- layer34_ffn2_2 -->
<g id="node493" class="node">
<title>layer34_ffn2_2</title>
<path fill="#e6f3ff" stroke="black" d="M354.5,-46014.47C354.5,-46014.47 91.5,-46014.47 91.5,-46014.47 85.5,-46014.47 79.5,-46008.47 79.5,-46002.47 79.5,-46002.47 79.5,-45979.47 79.5,-45979.47 79.5,-45973.47 85.5,-45967.47 91.5,-45967.47 91.5,-45967.47 354.5,-45967.47 354.5,-45967.47 360.5,-45967.47 366.5,-45973.47 366.5,-45979.47 366.5,-45979.47 366.5,-46002.47 366.5,-46002.47 366.5,-46008.47 360.5,-46014.47 354.5,-46014.47"/>
<text text-anchor="middle" x="223" y="-45999.47" font-family="Arial" font-size="10.00">Layer 34 FFN2 GPU2</text>
<text text-anchor="middle" x="223" y="-45988.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="223" y="-45977.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer34_act_2&#45;&gt;layer34_ffn2_2 -->
<g id="edge562" class="edge">
<title>layer34_act_2&#45;&gt;layer34_ffn2_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M220.58,-46086.41C221.03,-46068.96 221.65,-46044.55 222.16,-46024.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="225.66,-46024.94 222.41,-46014.86 218.66,-46024.76 225.66,-46024.94"/>
</g>
<!-- layer34_ffn2_3 -->
<g id="node494" class="node">
<title>layer34_ffn2_3</title>
<path fill="#e6f3ff" stroke="black" d="M679.5,-46014.47C679.5,-46014.47 416.5,-46014.47 416.5,-46014.47 410.5,-46014.47 404.5,-46008.47 404.5,-46002.47 404.5,-46002.47 404.5,-45979.47 404.5,-45979.47 404.5,-45973.47 410.5,-45967.47 416.5,-45967.47 416.5,-45967.47 679.5,-45967.47 679.5,-45967.47 685.5,-45967.47 691.5,-45973.47 691.5,-45979.47 691.5,-45979.47 691.5,-46002.47 691.5,-46002.47 691.5,-46008.47 685.5,-46014.47 679.5,-46014.47"/>
<text text-anchor="middle" x="548" y="-45999.47" font-family="Arial" font-size="10.00">Layer 34 FFN2 GPU3</text>
<text text-anchor="middle" x="548" y="-45988.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="548" y="-45977.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer34_act_3&#45;&gt;layer34_ffn2_3 -->
<g id="edge563" class="edge">
<title>layer34_act_3&#45;&gt;layer34_ffn2_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M549.61,-46086.41C549.32,-46068.96 548.9,-46044.55 548.56,-46024.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="552.06,-46024.8 548.39,-46014.86 545.06,-46024.92 552.06,-46024.8"/>
</g>
<!-- layer34_ffn_ar -->
<g id="node495" class="node">
<title>layer34_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M516.22,-45895.47C516.22,-45895.47 310.8,-45895.47 310.8,-45895.47 304.8,-45895.47 295,-45890.83 291.19,-45886.19 291.19,-45886.19 247.39,-45832.75 247.39,-45832.75 243.59,-45828.11 245.78,-45823.47 251.78,-45823.47 251.78,-45823.47 457.2,-45823.47 457.2,-45823.47 463.2,-45823.47 473,-45828.11 476.81,-45832.75 476.81,-45832.75 520.61,-45886.19 520.61,-45886.19 524.41,-45890.83 522.22,-45895.47 516.22,-45895.47"/>
<text text-anchor="middle" x="384" y="-45862.47" font-family="Arial" font-size="10.00">Layer 34 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="384" y="-45851.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer34_ffn2_2&#45;&gt;layer34_ffn_ar -->
<g id="edge564" class="edge">
<title>layer34_ffn2_2&#45;&gt;layer34_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M251.04,-45967.41C273.43,-45949.41 305.4,-45923.69 332.38,-45901.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="334.61,-45904.68 340.21,-45895.69 330.23,-45899.23 334.61,-45904.68"/>
</g>
<!-- layer34_ffn2_3&#45;&gt;layer34_ffn_ar -->
<g id="edge565" class="edge">
<title>layer34_ffn2_3&#45;&gt;layer34_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M519.43,-45967.41C496.63,-45949.41 464.06,-45923.69 436.58,-45901.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="438.62,-45899.14 428.6,-45895.69 434.28,-45904.63 438.62,-45899.14"/>
</g>
<!-- layer35_qkv_2 -->
<g id="node496" class="node">
<title>layer35_qkv_2</title>
<path fill="#e6f3ff" stroke="black" d="M354,-45751.47C354,-45751.47 56,-45751.47 56,-45751.47 50,-45751.47 44,-45745.47 44,-45739.47 44,-45739.47 44,-45716.47 44,-45716.47 44,-45710.47 50,-45704.47 56,-45704.47 56,-45704.47 354,-45704.47 354,-45704.47 360,-45704.47 366,-45710.47 366,-45716.47 366,-45716.47 366,-45739.47 366,-45739.47 366,-45745.47 360,-45751.47 354,-45751.47"/>
<text text-anchor="middle" x="205" y="-45736.47" font-family="Arial" font-size="10.00">Layer 35 QKV Proj GPU2</text>
<text text-anchor="middle" x="205" y="-45725.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="205" y="-45714.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer34_ffn_ar&#45;&gt;layer35_qkv_2 -->
<g id="edge566" class="edge">
<title>layer34_ffn_ar&#45;&gt;layer35_qkv_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M335.56,-45823.42C307.06,-45802.81 271.48,-45777.06 244.66,-45757.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="246.43,-45754.62 236.28,-45751.6 242.33,-45760.3 246.43,-45754.62"/>
</g>
<!-- layer35_qkv_3 -->
<g id="node497" class="node">
<title>layer35_qkv_3</title>
<path fill="#e6f3ff" stroke="black" d="M712,-45751.47C712,-45751.47 414,-45751.47 414,-45751.47 408,-45751.47 402,-45745.47 402,-45739.47 402,-45739.47 402,-45716.47 402,-45716.47 402,-45710.47 408,-45704.47 414,-45704.47 414,-45704.47 712,-45704.47 712,-45704.47 718,-45704.47 724,-45710.47 724,-45716.47 724,-45716.47 724,-45739.47 724,-45739.47 724,-45745.47 718,-45751.47 712,-45751.47"/>
<text text-anchor="middle" x="563" y="-45736.47" font-family="Arial" font-size="10.00">Layer 35 QKV Proj GPU3</text>
<text text-anchor="middle" x="563" y="-45725.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="563" y="-45714.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer34_ffn_ar&#45;&gt;layer35_qkv_3 -->
<g id="edge567" class="edge">
<title>layer34_ffn_ar&#45;&gt;layer35_qkv_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M432.44,-45823.42C460.94,-45802.81 496.52,-45777.06 523.34,-45757.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="525.67,-45760.3 531.72,-45751.6 521.57,-45754.62 525.67,-45760.3"/>
</g>
<!-- layer35_attn_2 -->
<g id="node498" class="node">
<title>layer35_attn_2</title>
<path fill="#e6f3ff" stroke="black" d="M354,-45632.47C354,-45632.47 56,-45632.47 56,-45632.47 50,-45632.47 44,-45626.47 44,-45620.47 44,-45620.47 44,-45597.47 44,-45597.47 44,-45591.47 50,-45585.47 56,-45585.47 56,-45585.47 354,-45585.47 354,-45585.47 360,-45585.47 366,-45591.47 366,-45597.47 366,-45597.47 366,-45620.47 366,-45620.47 366,-45626.47 360,-45632.47 354,-45632.47"/>
<text text-anchor="middle" x="205" y="-45617.47" font-family="Arial" font-size="10.00">Layer 35 Attention GPU2</text>
<text text-anchor="middle" x="205" y="-45606.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="205" y="-45595.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer35_qkv_2&#45;&gt;layer35_attn_2 -->
<g id="edge568" class="edge">
<title>layer35_qkv_2&#45;&gt;layer35_attn_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M205,-45704.41C205,-45686.96 205,-45662.55 205,-45642.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="208.5,-45642.86 205,-45632.86 201.5,-45642.86 208.5,-45642.86"/>
</g>
<!-- layer35_attn_3 -->
<g id="node499" class="node">
<title>layer35_attn_3</title>
<path fill="#e6f3ff" stroke="black" d="M712,-45632.47C712,-45632.47 414,-45632.47 414,-45632.47 408,-45632.47 402,-45626.47 402,-45620.47 402,-45620.47 402,-45597.47 402,-45597.47 402,-45591.47 408,-45585.47 414,-45585.47 414,-45585.47 712,-45585.47 712,-45585.47 718,-45585.47 724,-45591.47 724,-45597.47 724,-45597.47 724,-45620.47 724,-45620.47 724,-45626.47 718,-45632.47 712,-45632.47"/>
<text text-anchor="middle" x="563" y="-45617.47" font-family="Arial" font-size="10.00">Layer 35 Attention GPU3</text>
<text text-anchor="middle" x="563" y="-45606.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="563" y="-45595.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer35_qkv_3&#45;&gt;layer35_attn_3 -->
<g id="edge569" class="edge">
<title>layer35_qkv_3&#45;&gt;layer35_attn_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M563,-45704.41C563,-45686.96 563,-45662.55 563,-45642.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="566.5,-45642.86 563,-45632.86 559.5,-45642.86 566.5,-45642.86"/>
</g>
<!-- layer35_attn_out_2 -->
<g id="node500" class="node">
<title>layer35_attn_out_2</title>
<path fill="#e6f3ff" stroke="black" d="M354,-45513.47C354,-45513.47 64,-45513.47 64,-45513.47 58,-45513.47 52,-45507.47 52,-45501.47 52,-45501.47 52,-45478.47 52,-45478.47 52,-45472.47 58,-45466.47 64,-45466.47 64,-45466.47 354,-45466.47 354,-45466.47 360,-45466.47 366,-45472.47 366,-45478.47 366,-45478.47 366,-45501.47 366,-45501.47 366,-45507.47 360,-45513.47 354,-45513.47"/>
<text text-anchor="middle" x="209" y="-45498.47" font-family="Arial" font-size="10.00">Layer 35 Attn Out GPU2</text>
<text text-anchor="middle" x="209" y="-45487.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="209" y="-45476.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer35_attn_2&#45;&gt;layer35_attn_out_2 -->
<g id="edge570" class="edge">
<title>layer35_attn_2&#45;&gt;layer35_attn_out_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M205.77,-45585.41C206.37,-45567.96 207.2,-45543.55 207.87,-45523.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="211.37,-45523.97 208.22,-45513.86 204.38,-45523.73 211.37,-45523.97"/>
</g>
<!-- layer35_attn_out_3 -->
<g id="node501" class="node">
<title>layer35_attn_out_3</title>
<path fill="#e6f3ff" stroke="black" d="M706,-45513.47C706,-45513.47 416,-45513.47 416,-45513.47 410,-45513.47 404,-45507.47 404,-45501.47 404,-45501.47 404,-45478.47 404,-45478.47 404,-45472.47 410,-45466.47 416,-45466.47 416,-45466.47 706,-45466.47 706,-45466.47 712,-45466.47 718,-45472.47 718,-45478.47 718,-45478.47 718,-45501.47 718,-45501.47 718,-45507.47 712,-45513.47 706,-45513.47"/>
<text text-anchor="middle" x="561" y="-45498.47" font-family="Arial" font-size="10.00">Layer 35 Attn Out GPU3</text>
<text text-anchor="middle" x="561" y="-45487.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="561" y="-45476.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer35_attn_3&#45;&gt;layer35_attn_out_3 -->
<g id="edge571" class="edge">
<title>layer35_attn_3&#45;&gt;layer35_attn_out_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M562.61,-45585.41C562.32,-45567.96 561.9,-45543.55 561.56,-45523.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="565.06,-45523.8 561.39,-45513.86 558.06,-45523.92 565.06,-45523.8"/>
</g>
<!-- layer35_attn_ar -->
<g id="node502" class="node">
<title>layer35_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M514.07,-45394.47C514.07,-45394.47 312.07,-45394.47 312.07,-45394.47 306.07,-45394.47 296.3,-45389.8 292.53,-45385.13 292.53,-45385.13 249.47,-45331.8 249.47,-45331.8 245.7,-45327.14 247.93,-45322.47 253.93,-45322.47 253.93,-45322.47 455.93,-45322.47 455.93,-45322.47 461.93,-45322.47 471.7,-45327.14 475.47,-45331.8 475.47,-45331.8 518.53,-45385.13 518.53,-45385.13 522.3,-45389.8 520.07,-45394.47 514.07,-45394.47"/>
<text text-anchor="middle" x="384" y="-45361.47" font-family="Arial" font-size="10.00">Layer 35 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="384" y="-45350.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer35_attn_out_2&#45;&gt;layer35_attn_ar -->
<g id="edge572" class="edge">
<title>layer35_attn_out_2&#45;&gt;layer35_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M239.48,-45466.41C263.92,-45448.33 298.86,-45422.47 328.27,-45400.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="330.45,-45403.45 336.4,-45394.69 326.28,-45397.82 330.45,-45403.45"/>
</g>
<!-- layer35_attn_out_3&#45;&gt;layer35_attn_ar -->
<g id="edge573" class="edge">
<title>layer35_attn_out_3&#45;&gt;layer35_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M530.17,-45466.41C505.45,-45448.33 470.11,-45422.47 440.37,-45400.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="442.28,-45397.77 432.14,-45394.69 438.14,-45403.42 442.28,-45397.77"/>
</g>
<!-- layer35_ffn1_2 -->
<g id="node503" class="node">
<title>layer35_ffn1_2</title>
<path fill="#e6f3ff" stroke="black" d="M354,-45250.47C354,-45250.47 84,-45250.47 84,-45250.47 78,-45250.47 72,-45244.47 72,-45238.47 72,-45238.47 72,-45215.47 72,-45215.47 72,-45209.47 78,-45203.47 84,-45203.47 84,-45203.47 354,-45203.47 354,-45203.47 360,-45203.47 366,-45209.47 366,-45215.47 366,-45215.47 366,-45238.47 366,-45238.47 366,-45244.47 360,-45250.47 354,-45250.47"/>
<text text-anchor="middle" x="219" y="-45235.47" font-family="Arial" font-size="10.00">Layer 35 FFN1 GPU2</text>
<text text-anchor="middle" x="219" y="-45224.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="219" y="-45213.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer35_attn_ar&#45;&gt;layer35_ffn1_2 -->
<g id="edge574" class="edge">
<title>layer35_attn_ar&#45;&gt;layer35_ffn1_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M339.35,-45322.42C313.28,-45301.96 280.78,-45276.45 256.12,-45257.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="258.11,-45254.21 248.08,-45250.79 253.79,-45259.72 258.11,-45254.21"/>
</g>
<!-- layer35_ffn1_3 -->
<g id="node504" class="node">
<title>layer35_ffn1_3</title>
<path fill="#e6f3ff" stroke="black" d="M684,-45250.47C684,-45250.47 414,-45250.47 414,-45250.47 408,-45250.47 402,-45244.47 402,-45238.47 402,-45238.47 402,-45215.47 402,-45215.47 402,-45209.47 408,-45203.47 414,-45203.47 414,-45203.47 684,-45203.47 684,-45203.47 690,-45203.47 696,-45209.47 696,-45215.47 696,-45215.47 696,-45238.47 696,-45238.47 696,-45244.47 690,-45250.47 684,-45250.47"/>
<text text-anchor="middle" x="549" y="-45235.47" font-family="Arial" font-size="10.00">Layer 35 FFN1 GPU3</text>
<text text-anchor="middle" x="549" y="-45224.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-45213.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer35_attn_ar&#45;&gt;layer35_ffn1_3 -->
<g id="edge575" class="edge">
<title>layer35_attn_ar&#45;&gt;layer35_ffn1_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M428.65,-45322.42C454.72,-45301.96 487.22,-45276.45 511.88,-45257.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="514.21,-45259.72 519.92,-45250.79 509.89,-45254.21 514.21,-45259.72"/>
</g>
<!-- layer35_act_2 -->
<g id="node505" class="node">
<title>layer35_act_2</title>
<path fill="#e6f3ff" stroke="black" d="M354,-45131.47C354,-45131.47 84,-45131.47 84,-45131.47 78,-45131.47 72,-45125.47 72,-45119.47 72,-45119.47 72,-45096.47 72,-45096.47 72,-45090.47 78,-45084.47 84,-45084.47 84,-45084.47 354,-45084.47 354,-45084.47 360,-45084.47 366,-45090.47 366,-45096.47 366,-45096.47 366,-45119.47 366,-45119.47 366,-45125.47 360,-45131.47 354,-45131.47"/>
<text text-anchor="middle" x="219" y="-45116.47" font-family="Arial" font-size="10.00">Layer 35 SiLU GPU2</text>
<text text-anchor="middle" x="219" y="-45105.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="219" y="-45094.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer35_ffn1_2&#45;&gt;layer35_act_2 -->
<g id="edge576" class="edge">
<title>layer35_ffn1_2&#45;&gt;layer35_act_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M219,-45203.41C219,-45185.96 219,-45161.55 219,-45141.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="222.5,-45141.86 219,-45131.86 215.5,-45141.86 222.5,-45141.86"/>
</g>
<!-- layer35_act_3 -->
<g id="node506" class="node">
<title>layer35_act_3</title>
<path fill="#e6f3ff" stroke="black" d="M684,-45131.47C684,-45131.47 414,-45131.47 414,-45131.47 408,-45131.47 402,-45125.47 402,-45119.47 402,-45119.47 402,-45096.47 402,-45096.47 402,-45090.47 408,-45084.47 414,-45084.47 414,-45084.47 684,-45084.47 684,-45084.47 690,-45084.47 696,-45090.47 696,-45096.47 696,-45096.47 696,-45119.47 696,-45119.47 696,-45125.47 690,-45131.47 684,-45131.47"/>
<text text-anchor="middle" x="549" y="-45116.47" font-family="Arial" font-size="10.00">Layer 35 SiLU GPU3</text>
<text text-anchor="middle" x="549" y="-45105.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="549" y="-45094.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer35_ffn1_3&#45;&gt;layer35_act_3 -->
<g id="edge577" class="edge">
<title>layer35_ffn1_3&#45;&gt;layer35_act_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M549,-45203.41C549,-45185.96 549,-45161.55 549,-45141.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="552.5,-45141.86 549,-45131.86 545.5,-45141.86 552.5,-45141.86"/>
</g>
<!-- layer35_ffn2_2 -->
<g id="node507" class="node">
<title>layer35_ffn2_2</title>
<path fill="#e6f3ff" stroke="black" d="M353.5,-45012.47C353.5,-45012.47 90.5,-45012.47 90.5,-45012.47 84.5,-45012.47 78.5,-45006.47 78.5,-45000.47 78.5,-45000.47 78.5,-44977.47 78.5,-44977.47 78.5,-44971.47 84.5,-44965.47 90.5,-44965.47 90.5,-44965.47 353.5,-44965.47 353.5,-44965.47 359.5,-44965.47 365.5,-44971.47 365.5,-44977.47 365.5,-44977.47 365.5,-45000.47 365.5,-45000.47 365.5,-45006.47 359.5,-45012.47 353.5,-45012.47"/>
<text text-anchor="middle" x="222" y="-44997.47" font-family="Arial" font-size="10.00">Layer 35 FFN2 GPU2</text>
<text text-anchor="middle" x="222" y="-44986.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="222" y="-44975.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer35_act_2&#45;&gt;layer35_ffn2_2 -->
<g id="edge578" class="edge">
<title>layer35_act_2&#45;&gt;layer35_ffn2_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M219.58,-45084.41C220.03,-45066.96 220.65,-45042.55 221.16,-45022.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="224.66,-45022.94 221.41,-45012.86 217.66,-45022.76 224.66,-45022.94"/>
</g>
<!-- layer35_ffn2_3 -->
<g id="node508" class="node">
<title>layer35_ffn2_3</title>
<path fill="#e6f3ff" stroke="black" d="M678.5,-45012.47C678.5,-45012.47 415.5,-45012.47 415.5,-45012.47 409.5,-45012.47 403.5,-45006.47 403.5,-45000.47 403.5,-45000.47 403.5,-44977.47 403.5,-44977.47 403.5,-44971.47 409.5,-44965.47 415.5,-44965.47 415.5,-44965.47 678.5,-44965.47 678.5,-44965.47 684.5,-44965.47 690.5,-44971.47 690.5,-44977.47 690.5,-44977.47 690.5,-45000.47 690.5,-45000.47 690.5,-45006.47 684.5,-45012.47 678.5,-45012.47"/>
<text text-anchor="middle" x="547" y="-44997.47" font-family="Arial" font-size="10.00">Layer 35 FFN2 GPU3</text>
<text text-anchor="middle" x="547" y="-44986.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="547" y="-44975.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer35_act_3&#45;&gt;layer35_ffn2_3 -->
<g id="edge579" class="edge">
<title>layer35_act_3&#45;&gt;layer35_ffn2_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M548.61,-45084.41C548.32,-45066.96 547.9,-45042.55 547.56,-45022.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="551.06,-45022.8 547.39,-45012.86 544.06,-45022.92 551.06,-45022.8"/>
</g>
<!-- layer35_ffn_ar -->
<g id="node509" class="node">
<title>layer35_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M515.22,-44893.47C515.22,-44893.47 309.8,-44893.47 309.8,-44893.47 303.8,-44893.47 294,-44888.83 290.19,-44884.19 290.19,-44884.19 246.39,-44830.75 246.39,-44830.75 242.59,-44826.11 244.78,-44821.47 250.78,-44821.47 250.78,-44821.47 456.2,-44821.47 456.2,-44821.47 462.2,-44821.47 472,-44826.11 475.81,-44830.75 475.81,-44830.75 519.61,-44884.19 519.61,-44884.19 523.41,-44888.83 521.22,-44893.47 515.22,-44893.47"/>
<text text-anchor="middle" x="383" y="-44860.47" font-family="Arial" font-size="10.00">Layer 35 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="383" y="-44849.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer35_ffn2_2&#45;&gt;layer35_ffn_ar -->
<g id="edge580" class="edge">
<title>layer35_ffn2_2&#45;&gt;layer35_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M250.04,-44965.41C272.43,-44947.41 304.4,-44921.69 331.38,-44899.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="333.61,-44902.68 339.21,-44893.69 329.23,-44897.23 333.61,-44902.68"/>
</g>
<!-- layer35_ffn2_3&#45;&gt;layer35_ffn_ar -->
<g id="edge581" class="edge">
<title>layer35_ffn2_3&#45;&gt;layer35_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M518.43,-44965.41C495.63,-44947.41 463.06,-44921.69 435.58,-44899.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="437.62,-44897.14 427.6,-44893.69 433.28,-44902.63 437.62,-44897.14"/>
</g>
<!-- layer36_qkv_2 -->
<g id="node510" class="node">
<title>layer36_qkv_2</title>
<path fill="#e6f3ff" stroke="black" d="M353,-44749.47C353,-44749.47 55,-44749.47 55,-44749.47 49,-44749.47 43,-44743.47 43,-44737.47 43,-44737.47 43,-44714.47 43,-44714.47 43,-44708.47 49,-44702.47 55,-44702.47 55,-44702.47 353,-44702.47 353,-44702.47 359,-44702.47 365,-44708.47 365,-44714.47 365,-44714.47 365,-44737.47 365,-44737.47 365,-44743.47 359,-44749.47 353,-44749.47"/>
<text text-anchor="middle" x="204" y="-44734.47" font-family="Arial" font-size="10.00">Layer 36 QKV Proj GPU2</text>
<text text-anchor="middle" x="204" y="-44723.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="204" y="-44712.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer35_ffn_ar&#45;&gt;layer36_qkv_2 -->
<g id="edge582" class="edge">
<title>layer35_ffn_ar&#45;&gt;layer36_qkv_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M334.56,-44821.42C306.06,-44800.81 270.48,-44775.06 243.66,-44755.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="245.43,-44752.62 235.28,-44749.6 241.33,-44758.3 245.43,-44752.62"/>
</g>
<!-- layer36_qkv_3 -->
<g id="node511" class="node">
<title>layer36_qkv_3</title>
<path fill="#e6f3ff" stroke="black" d="M711,-44749.47C711,-44749.47 413,-44749.47 413,-44749.47 407,-44749.47 401,-44743.47 401,-44737.47 401,-44737.47 401,-44714.47 401,-44714.47 401,-44708.47 407,-44702.47 413,-44702.47 413,-44702.47 711,-44702.47 711,-44702.47 717,-44702.47 723,-44708.47 723,-44714.47 723,-44714.47 723,-44737.47 723,-44737.47 723,-44743.47 717,-44749.47 711,-44749.47"/>
<text text-anchor="middle" x="562" y="-44734.47" font-family="Arial" font-size="10.00">Layer 36 QKV Proj GPU3</text>
<text text-anchor="middle" x="562" y="-44723.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="562" y="-44712.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer35_ffn_ar&#45;&gt;layer36_qkv_3 -->
<g id="edge583" class="edge">
<title>layer35_ffn_ar&#45;&gt;layer36_qkv_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M431.44,-44821.42C459.94,-44800.81 495.52,-44775.06 522.34,-44755.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="524.67,-44758.3 530.72,-44749.6 520.57,-44752.62 524.67,-44758.3"/>
</g>
<!-- layer36_attn_2 -->
<g id="node512" class="node">
<title>layer36_attn_2</title>
<path fill="#e6f3ff" stroke="black" d="M353,-44630.47C353,-44630.47 55,-44630.47 55,-44630.47 49,-44630.47 43,-44624.47 43,-44618.47 43,-44618.47 43,-44595.47 43,-44595.47 43,-44589.47 49,-44583.47 55,-44583.47 55,-44583.47 353,-44583.47 353,-44583.47 359,-44583.47 365,-44589.47 365,-44595.47 365,-44595.47 365,-44618.47 365,-44618.47 365,-44624.47 359,-44630.47 353,-44630.47"/>
<text text-anchor="middle" x="204" y="-44615.47" font-family="Arial" font-size="10.00">Layer 36 Attention GPU2</text>
<text text-anchor="middle" x="204" y="-44604.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="204" y="-44593.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer36_qkv_2&#45;&gt;layer36_attn_2 -->
<g id="edge584" class="edge">
<title>layer36_qkv_2&#45;&gt;layer36_attn_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M204,-44702.41C204,-44684.96 204,-44660.55 204,-44640.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="207.5,-44640.86 204,-44630.86 200.5,-44640.86 207.5,-44640.86"/>
</g>
<!-- layer36_attn_3 -->
<g id="node513" class="node">
<title>layer36_attn_3</title>
<path fill="#e6f3ff" stroke="black" d="M711,-44630.47C711,-44630.47 413,-44630.47 413,-44630.47 407,-44630.47 401,-44624.47 401,-44618.47 401,-44618.47 401,-44595.47 401,-44595.47 401,-44589.47 407,-44583.47 413,-44583.47 413,-44583.47 711,-44583.47 711,-44583.47 717,-44583.47 723,-44589.47 723,-44595.47 723,-44595.47 723,-44618.47 723,-44618.47 723,-44624.47 717,-44630.47 711,-44630.47"/>
<text text-anchor="middle" x="562" y="-44615.47" font-family="Arial" font-size="10.00">Layer 36 Attention GPU3</text>
<text text-anchor="middle" x="562" y="-44604.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="562" y="-44593.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer36_qkv_3&#45;&gt;layer36_attn_3 -->
<g id="edge585" class="edge">
<title>layer36_qkv_3&#45;&gt;layer36_attn_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M562,-44702.41C562,-44684.96 562,-44660.55 562,-44640.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="565.5,-44640.86 562,-44630.86 558.5,-44640.86 565.5,-44640.86"/>
</g>
<!-- layer36_attn_out_2 -->
<g id="node514" class="node">
<title>layer36_attn_out_2</title>
<path fill="#e6f3ff" stroke="black" d="M353,-44511.47C353,-44511.47 63,-44511.47 63,-44511.47 57,-44511.47 51,-44505.47 51,-44499.47 51,-44499.47 51,-44476.47 51,-44476.47 51,-44470.47 57,-44464.47 63,-44464.47 63,-44464.47 353,-44464.47 353,-44464.47 359,-44464.47 365,-44470.47 365,-44476.47 365,-44476.47 365,-44499.47 365,-44499.47 365,-44505.47 359,-44511.47 353,-44511.47"/>
<text text-anchor="middle" x="208" y="-44496.47" font-family="Arial" font-size="10.00">Layer 36 Attn Out GPU2</text>
<text text-anchor="middle" x="208" y="-44485.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="208" y="-44474.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer36_attn_2&#45;&gt;layer36_attn_out_2 -->
<g id="edge586" class="edge">
<title>layer36_attn_2&#45;&gt;layer36_attn_out_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M204.77,-44583.41C205.37,-44565.96 206.2,-44541.55 206.87,-44521.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="210.37,-44521.97 207.22,-44511.86 203.38,-44521.73 210.37,-44521.97"/>
</g>
<!-- layer36_attn_out_3 -->
<g id="node515" class="node">
<title>layer36_attn_out_3</title>
<path fill="#e6f3ff" stroke="black" d="M705,-44511.47C705,-44511.47 415,-44511.47 415,-44511.47 409,-44511.47 403,-44505.47 403,-44499.47 403,-44499.47 403,-44476.47 403,-44476.47 403,-44470.47 409,-44464.47 415,-44464.47 415,-44464.47 705,-44464.47 705,-44464.47 711,-44464.47 717,-44470.47 717,-44476.47 717,-44476.47 717,-44499.47 717,-44499.47 717,-44505.47 711,-44511.47 705,-44511.47"/>
<text text-anchor="middle" x="560" y="-44496.47" font-family="Arial" font-size="10.00">Layer 36 Attn Out GPU3</text>
<text text-anchor="middle" x="560" y="-44485.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="560" y="-44474.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer36_attn_3&#45;&gt;layer36_attn_out_3 -->
<g id="edge587" class="edge">
<title>layer36_attn_3&#45;&gt;layer36_attn_out_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M561.61,-44583.41C561.32,-44565.96 560.9,-44541.55 560.56,-44521.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="564.06,-44521.8 560.39,-44511.86 557.06,-44521.92 564.06,-44521.8"/>
</g>
<!-- layer36_attn_ar -->
<g id="node516" class="node">
<title>layer36_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M513.07,-44392.47C513.07,-44392.47 311.07,-44392.47 311.07,-44392.47 305.07,-44392.47 295.3,-44387.8 291.53,-44383.13 291.53,-44383.13 248.47,-44329.8 248.47,-44329.8 244.7,-44325.14 246.93,-44320.47 252.93,-44320.47 252.93,-44320.47 454.93,-44320.47 454.93,-44320.47 460.93,-44320.47 470.7,-44325.14 474.47,-44329.8 474.47,-44329.8 517.53,-44383.13 517.53,-44383.13 521.3,-44387.8 519.07,-44392.47 513.07,-44392.47"/>
<text text-anchor="middle" x="383" y="-44359.47" font-family="Arial" font-size="10.00">Layer 36 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="383" y="-44348.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer36_attn_out_2&#45;&gt;layer36_attn_ar -->
<g id="edge588" class="edge">
<title>layer36_attn_out_2&#45;&gt;layer36_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M238.48,-44464.41C262.92,-44446.33 297.86,-44420.47 327.27,-44398.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="329.45,-44401.45 335.4,-44392.69 325.28,-44395.82 329.45,-44401.45"/>
</g>
<!-- layer36_attn_out_3&#45;&gt;layer36_attn_ar -->
<g id="edge589" class="edge">
<title>layer36_attn_out_3&#45;&gt;layer36_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M529.17,-44464.41C504.45,-44446.33 469.11,-44420.47 439.37,-44398.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="441.28,-44395.77 431.14,-44392.69 437.14,-44401.42 441.28,-44395.77"/>
</g>
<!-- layer36_ffn1_2 -->
<g id="node517" class="node">
<title>layer36_ffn1_2</title>
<path fill="#e6f3ff" stroke="black" d="M353,-44248.47C353,-44248.47 83,-44248.47 83,-44248.47 77,-44248.47 71,-44242.47 71,-44236.47 71,-44236.47 71,-44213.47 71,-44213.47 71,-44207.47 77,-44201.47 83,-44201.47 83,-44201.47 353,-44201.47 353,-44201.47 359,-44201.47 365,-44207.47 365,-44213.47 365,-44213.47 365,-44236.47 365,-44236.47 365,-44242.47 359,-44248.47 353,-44248.47"/>
<text text-anchor="middle" x="218" y="-44233.47" font-family="Arial" font-size="10.00">Layer 36 FFN1 GPU2</text>
<text text-anchor="middle" x="218" y="-44222.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="218" y="-44211.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer36_attn_ar&#45;&gt;layer36_ffn1_2 -->
<g id="edge590" class="edge">
<title>layer36_attn_ar&#45;&gt;layer36_ffn1_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M338.35,-44320.42C312.28,-44299.96 279.78,-44274.45 255.12,-44255.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="257.11,-44252.21 247.08,-44248.79 252.79,-44257.72 257.11,-44252.21"/>
</g>
<!-- layer36_ffn1_3 -->
<g id="node518" class="node">
<title>layer36_ffn1_3</title>
<path fill="#e6f3ff" stroke="black" d="M683,-44248.47C683,-44248.47 413,-44248.47 413,-44248.47 407,-44248.47 401,-44242.47 401,-44236.47 401,-44236.47 401,-44213.47 401,-44213.47 401,-44207.47 407,-44201.47 413,-44201.47 413,-44201.47 683,-44201.47 683,-44201.47 689,-44201.47 695,-44207.47 695,-44213.47 695,-44213.47 695,-44236.47 695,-44236.47 695,-44242.47 689,-44248.47 683,-44248.47"/>
<text text-anchor="middle" x="548" y="-44233.47" font-family="Arial" font-size="10.00">Layer 36 FFN1 GPU3</text>
<text text-anchor="middle" x="548" y="-44222.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="548" y="-44211.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer36_attn_ar&#45;&gt;layer36_ffn1_3 -->
<g id="edge591" class="edge">
<title>layer36_attn_ar&#45;&gt;layer36_ffn1_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M427.65,-44320.42C453.72,-44299.96 486.22,-44274.45 510.88,-44255.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="513.21,-44257.72 518.92,-44248.79 508.89,-44252.21 513.21,-44257.72"/>
</g>
<!-- layer36_act_2 -->
<g id="node519" class="node">
<title>layer36_act_2</title>
<path fill="#e6f3ff" stroke="black" d="M353,-44129.47C353,-44129.47 83,-44129.47 83,-44129.47 77,-44129.47 71,-44123.47 71,-44117.47 71,-44117.47 71,-44094.47 71,-44094.47 71,-44088.47 77,-44082.47 83,-44082.47 83,-44082.47 353,-44082.47 353,-44082.47 359,-44082.47 365,-44088.47 365,-44094.47 365,-44094.47 365,-44117.47 365,-44117.47 365,-44123.47 359,-44129.47 353,-44129.47"/>
<text text-anchor="middle" x="218" y="-44114.47" font-family="Arial" font-size="10.00">Layer 36 SiLU GPU2</text>
<text text-anchor="middle" x="218" y="-44103.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="218" y="-44092.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer36_ffn1_2&#45;&gt;layer36_act_2 -->
<g id="edge592" class="edge">
<title>layer36_ffn1_2&#45;&gt;layer36_act_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M218,-44201.41C218,-44183.96 218,-44159.55 218,-44139.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="221.5,-44139.86 218,-44129.86 214.5,-44139.86 221.5,-44139.86"/>
</g>
<!-- layer36_act_3 -->
<g id="node520" class="node">
<title>layer36_act_3</title>
<path fill="#e6f3ff" stroke="black" d="M683,-44129.47C683,-44129.47 413,-44129.47 413,-44129.47 407,-44129.47 401,-44123.47 401,-44117.47 401,-44117.47 401,-44094.47 401,-44094.47 401,-44088.47 407,-44082.47 413,-44082.47 413,-44082.47 683,-44082.47 683,-44082.47 689,-44082.47 695,-44088.47 695,-44094.47 695,-44094.47 695,-44117.47 695,-44117.47 695,-44123.47 689,-44129.47 683,-44129.47"/>
<text text-anchor="middle" x="548" y="-44114.47" font-family="Arial" font-size="10.00">Layer 36 SiLU GPU3</text>
<text text-anchor="middle" x="548" y="-44103.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="548" y="-44092.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer36_ffn1_3&#45;&gt;layer36_act_3 -->
<g id="edge593" class="edge">
<title>layer36_ffn1_3&#45;&gt;layer36_act_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M548,-44201.41C548,-44183.96 548,-44159.55 548,-44139.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="551.5,-44139.86 548,-44129.86 544.5,-44139.86 551.5,-44139.86"/>
</g>
<!-- layer36_ffn2_2 -->
<g id="node521" class="node">
<title>layer36_ffn2_2</title>
<path fill="#e6f3ff" stroke="black" d="M352.5,-44010.47C352.5,-44010.47 89.5,-44010.47 89.5,-44010.47 83.5,-44010.47 77.5,-44004.47 77.5,-43998.47 77.5,-43998.47 77.5,-43975.47 77.5,-43975.47 77.5,-43969.47 83.5,-43963.47 89.5,-43963.47 89.5,-43963.47 352.5,-43963.47 352.5,-43963.47 358.5,-43963.47 364.5,-43969.47 364.5,-43975.47 364.5,-43975.47 364.5,-43998.47 364.5,-43998.47 364.5,-44004.47 358.5,-44010.47 352.5,-44010.47"/>
<text text-anchor="middle" x="221" y="-43995.47" font-family="Arial" font-size="10.00">Layer 36 FFN2 GPU2</text>
<text text-anchor="middle" x="221" y="-43984.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="221" y="-43973.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer36_act_2&#45;&gt;layer36_ffn2_2 -->
<g id="edge594" class="edge">
<title>layer36_act_2&#45;&gt;layer36_ffn2_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M218.58,-44082.41C219.03,-44064.96 219.65,-44040.55 220.16,-44020.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="223.66,-44020.94 220.41,-44010.86 216.66,-44020.76 223.66,-44020.94"/>
</g>
<!-- layer36_ffn2_3 -->
<g id="node522" class="node">
<title>layer36_ffn2_3</title>
<path fill="#e6f3ff" stroke="black" d="M677.5,-44010.47C677.5,-44010.47 414.5,-44010.47 414.5,-44010.47 408.5,-44010.47 402.5,-44004.47 402.5,-43998.47 402.5,-43998.47 402.5,-43975.47 402.5,-43975.47 402.5,-43969.47 408.5,-43963.47 414.5,-43963.47 414.5,-43963.47 677.5,-43963.47 677.5,-43963.47 683.5,-43963.47 689.5,-43969.47 689.5,-43975.47 689.5,-43975.47 689.5,-43998.47 689.5,-43998.47 689.5,-44004.47 683.5,-44010.47 677.5,-44010.47"/>
<text text-anchor="middle" x="546" y="-43995.47" font-family="Arial" font-size="10.00">Layer 36 FFN2 GPU3</text>
<text text-anchor="middle" x="546" y="-43984.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="546" y="-43973.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer36_act_3&#45;&gt;layer36_ffn2_3 -->
<g id="edge595" class="edge">
<title>layer36_act_3&#45;&gt;layer36_ffn2_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M547.61,-44082.41C547.32,-44064.96 546.9,-44040.55 546.56,-44020.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="550.06,-44020.8 546.39,-44010.86 543.06,-44020.92 550.06,-44020.8"/>
</g>
<!-- layer36_ffn_ar -->
<g id="node523" class="node">
<title>layer36_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M514.22,-43891.47C514.22,-43891.47 308.8,-43891.47 308.8,-43891.47 302.8,-43891.47 293,-43886.83 289.19,-43882.19 289.19,-43882.19 245.39,-43828.75 245.39,-43828.75 241.59,-43824.11 243.78,-43819.47 249.78,-43819.47 249.78,-43819.47 455.2,-43819.47 455.2,-43819.47 461.2,-43819.47 471,-43824.11 474.81,-43828.75 474.81,-43828.75 518.61,-43882.19 518.61,-43882.19 522.41,-43886.83 520.22,-43891.47 514.22,-43891.47"/>
<text text-anchor="middle" x="382" y="-43858.47" font-family="Arial" font-size="10.00">Layer 36 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="382" y="-43847.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer36_ffn2_2&#45;&gt;layer36_ffn_ar -->
<g id="edge596" class="edge">
<title>layer36_ffn2_2&#45;&gt;layer36_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M249.04,-43963.41C271.43,-43945.41 303.4,-43919.69 330.38,-43897.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="332.61,-43900.68 338.21,-43891.69 328.23,-43895.23 332.61,-43900.68"/>
</g>
<!-- layer36_ffn2_3&#45;&gt;layer36_ffn_ar -->
<g id="edge597" class="edge">
<title>layer36_ffn2_3&#45;&gt;layer36_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M517.43,-43963.41C494.63,-43945.41 462.06,-43919.69 434.58,-43897.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="436.62,-43895.14 426.6,-43891.69 432.28,-43900.63 436.62,-43895.14"/>
</g>
<!-- layer37_qkv_2 -->
<g id="node524" class="node">
<title>layer37_qkv_2</title>
<path fill="#e6f3ff" stroke="black" d="M352,-43747.47C352,-43747.47 54,-43747.47 54,-43747.47 48,-43747.47 42,-43741.47 42,-43735.47 42,-43735.47 42,-43712.47 42,-43712.47 42,-43706.47 48,-43700.47 54,-43700.47 54,-43700.47 352,-43700.47 352,-43700.47 358,-43700.47 364,-43706.47 364,-43712.47 364,-43712.47 364,-43735.47 364,-43735.47 364,-43741.47 358,-43747.47 352,-43747.47"/>
<text text-anchor="middle" x="203" y="-43732.47" font-family="Arial" font-size="10.00">Layer 37 QKV Proj GPU2</text>
<text text-anchor="middle" x="203" y="-43721.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="203" y="-43710.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer36_ffn_ar&#45;&gt;layer37_qkv_2 -->
<g id="edge598" class="edge">
<title>layer36_ffn_ar&#45;&gt;layer37_qkv_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M333.56,-43819.42C305.06,-43798.81 269.48,-43773.06 242.66,-43753.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="244.43,-43750.62 234.28,-43747.6 240.33,-43756.3 244.43,-43750.62"/>
</g>
<!-- layer37_qkv_3 -->
<g id="node525" class="node">
<title>layer37_qkv_3</title>
<path fill="#e6f3ff" stroke="black" d="M710,-43747.47C710,-43747.47 412,-43747.47 412,-43747.47 406,-43747.47 400,-43741.47 400,-43735.47 400,-43735.47 400,-43712.47 400,-43712.47 400,-43706.47 406,-43700.47 412,-43700.47 412,-43700.47 710,-43700.47 710,-43700.47 716,-43700.47 722,-43706.47 722,-43712.47 722,-43712.47 722,-43735.47 722,-43735.47 722,-43741.47 716,-43747.47 710,-43747.47"/>
<text text-anchor="middle" x="561" y="-43732.47" font-family="Arial" font-size="10.00">Layer 37 QKV Proj GPU3</text>
<text text-anchor="middle" x="561" y="-43721.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="561" y="-43710.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer36_ffn_ar&#45;&gt;layer37_qkv_3 -->
<g id="edge599" class="edge">
<title>layer36_ffn_ar&#45;&gt;layer37_qkv_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M430.44,-43819.42C458.94,-43798.81 494.52,-43773.06 521.34,-43753.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="523.67,-43756.3 529.72,-43747.6 519.57,-43750.62 523.67,-43756.3"/>
</g>
<!-- layer37_attn_2 -->
<g id="node526" class="node">
<title>layer37_attn_2</title>
<path fill="#e6f3ff" stroke="black" d="M352,-43628.47C352,-43628.47 54,-43628.47 54,-43628.47 48,-43628.47 42,-43622.47 42,-43616.47 42,-43616.47 42,-43593.47 42,-43593.47 42,-43587.47 48,-43581.47 54,-43581.47 54,-43581.47 352,-43581.47 352,-43581.47 358,-43581.47 364,-43587.47 364,-43593.47 364,-43593.47 364,-43616.47 364,-43616.47 364,-43622.47 358,-43628.47 352,-43628.47"/>
<text text-anchor="middle" x="203" y="-43613.47" font-family="Arial" font-size="10.00">Layer 37 Attention GPU2</text>
<text text-anchor="middle" x="203" y="-43602.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="203" y="-43591.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer37_qkv_2&#45;&gt;layer37_attn_2 -->
<g id="edge600" class="edge">
<title>layer37_qkv_2&#45;&gt;layer37_attn_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M203,-43700.41C203,-43682.96 203,-43658.55 203,-43638.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="206.5,-43638.86 203,-43628.86 199.5,-43638.86 206.5,-43638.86"/>
</g>
<!-- layer37_attn_3 -->
<g id="node527" class="node">
<title>layer37_attn_3</title>
<path fill="#e6f3ff" stroke="black" d="M710,-43628.47C710,-43628.47 412,-43628.47 412,-43628.47 406,-43628.47 400,-43622.47 400,-43616.47 400,-43616.47 400,-43593.47 400,-43593.47 400,-43587.47 406,-43581.47 412,-43581.47 412,-43581.47 710,-43581.47 710,-43581.47 716,-43581.47 722,-43587.47 722,-43593.47 722,-43593.47 722,-43616.47 722,-43616.47 722,-43622.47 716,-43628.47 710,-43628.47"/>
<text text-anchor="middle" x="561" y="-43613.47" font-family="Arial" font-size="10.00">Layer 37 Attention GPU3</text>
<text text-anchor="middle" x="561" y="-43602.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="561" y="-43591.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer37_qkv_3&#45;&gt;layer37_attn_3 -->
<g id="edge601" class="edge">
<title>layer37_qkv_3&#45;&gt;layer37_attn_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M561,-43700.41C561,-43682.96 561,-43658.55 561,-43638.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="564.5,-43638.86 561,-43628.86 557.5,-43638.86 564.5,-43638.86"/>
</g>
<!-- layer37_attn_out_2 -->
<g id="node528" class="node">
<title>layer37_attn_out_2</title>
<path fill="#e6f3ff" stroke="black" d="M352,-43509.47C352,-43509.47 62,-43509.47 62,-43509.47 56,-43509.47 50,-43503.47 50,-43497.47 50,-43497.47 50,-43474.47 50,-43474.47 50,-43468.47 56,-43462.47 62,-43462.47 62,-43462.47 352,-43462.47 352,-43462.47 358,-43462.47 364,-43468.47 364,-43474.47 364,-43474.47 364,-43497.47 364,-43497.47 364,-43503.47 358,-43509.47 352,-43509.47"/>
<text text-anchor="middle" x="207" y="-43494.47" font-family="Arial" font-size="10.00">Layer 37 Attn Out GPU2</text>
<text text-anchor="middle" x="207" y="-43483.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="207" y="-43472.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer37_attn_2&#45;&gt;layer37_attn_out_2 -->
<g id="edge602" class="edge">
<title>layer37_attn_2&#45;&gt;layer37_attn_out_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M203.77,-43581.41C204.37,-43563.96 205.2,-43539.55 205.87,-43519.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="209.37,-43519.97 206.22,-43509.86 202.38,-43519.73 209.37,-43519.97"/>
</g>
<!-- layer37_attn_out_3 -->
<g id="node529" class="node">
<title>layer37_attn_out_3</title>
<path fill="#e6f3ff" stroke="black" d="M704,-43509.47C704,-43509.47 414,-43509.47 414,-43509.47 408,-43509.47 402,-43503.47 402,-43497.47 402,-43497.47 402,-43474.47 402,-43474.47 402,-43468.47 408,-43462.47 414,-43462.47 414,-43462.47 704,-43462.47 704,-43462.47 710,-43462.47 716,-43468.47 716,-43474.47 716,-43474.47 716,-43497.47 716,-43497.47 716,-43503.47 710,-43509.47 704,-43509.47"/>
<text text-anchor="middle" x="559" y="-43494.47" font-family="Arial" font-size="10.00">Layer 37 Attn Out GPU3</text>
<text text-anchor="middle" x="559" y="-43483.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="559" y="-43472.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer37_attn_3&#45;&gt;layer37_attn_out_3 -->
<g id="edge603" class="edge">
<title>layer37_attn_3&#45;&gt;layer37_attn_out_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M560.61,-43581.41C560.32,-43563.96 559.9,-43539.55 559.56,-43519.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="563.06,-43519.8 559.39,-43509.86 556.06,-43519.92 563.06,-43519.8"/>
</g>
<!-- layer37_attn_ar -->
<g id="node530" class="node">
<title>layer37_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M512.07,-43390.47C512.07,-43390.47 310.07,-43390.47 310.07,-43390.47 304.07,-43390.47 294.3,-43385.8 290.53,-43381.13 290.53,-43381.13 247.47,-43327.8 247.47,-43327.8 243.7,-43323.14 245.93,-43318.47 251.93,-43318.47 251.93,-43318.47 453.93,-43318.47 453.93,-43318.47 459.93,-43318.47 469.7,-43323.14 473.47,-43327.8 473.47,-43327.8 516.53,-43381.13 516.53,-43381.13 520.3,-43385.8 518.07,-43390.47 512.07,-43390.47"/>
<text text-anchor="middle" x="382" y="-43357.47" font-family="Arial" font-size="10.00">Layer 37 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="382" y="-43346.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer37_attn_out_2&#45;&gt;layer37_attn_ar -->
<g id="edge604" class="edge">
<title>layer37_attn_out_2&#45;&gt;layer37_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M237.48,-43462.41C261.92,-43444.33 296.86,-43418.47 326.27,-43396.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="328.45,-43399.45 334.4,-43390.69 324.28,-43393.82 328.45,-43399.45"/>
</g>
<!-- layer37_attn_out_3&#45;&gt;layer37_attn_ar -->
<g id="edge605" class="edge">
<title>layer37_attn_out_3&#45;&gt;layer37_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M528.17,-43462.41C503.45,-43444.33 468.11,-43418.47 438.37,-43396.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="440.28,-43393.77 430.14,-43390.69 436.14,-43399.42 440.28,-43393.77"/>
</g>
<!-- layer37_ffn1_2 -->
<g id="node531" class="node">
<title>layer37_ffn1_2</title>
<path fill="#e6f3ff" stroke="black" d="M352,-43246.47C352,-43246.47 82,-43246.47 82,-43246.47 76,-43246.47 70,-43240.47 70,-43234.47 70,-43234.47 70,-43211.47 70,-43211.47 70,-43205.47 76,-43199.47 82,-43199.47 82,-43199.47 352,-43199.47 352,-43199.47 358,-43199.47 364,-43205.47 364,-43211.47 364,-43211.47 364,-43234.47 364,-43234.47 364,-43240.47 358,-43246.47 352,-43246.47"/>
<text text-anchor="middle" x="217" y="-43231.47" font-family="Arial" font-size="10.00">Layer 37 FFN1 GPU2</text>
<text text-anchor="middle" x="217" y="-43220.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="217" y="-43209.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer37_attn_ar&#45;&gt;layer37_ffn1_2 -->
<g id="edge606" class="edge">
<title>layer37_attn_ar&#45;&gt;layer37_ffn1_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M337.35,-43318.42C311.28,-43297.96 278.78,-43272.45 254.12,-43253.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="256.11,-43250.21 246.08,-43246.79 251.79,-43255.72 256.11,-43250.21"/>
</g>
<!-- layer37_ffn1_3 -->
<g id="node532" class="node">
<title>layer37_ffn1_3</title>
<path fill="#e6f3ff" stroke="black" d="M682,-43246.47C682,-43246.47 412,-43246.47 412,-43246.47 406,-43246.47 400,-43240.47 400,-43234.47 400,-43234.47 400,-43211.47 400,-43211.47 400,-43205.47 406,-43199.47 412,-43199.47 412,-43199.47 682,-43199.47 682,-43199.47 688,-43199.47 694,-43205.47 694,-43211.47 694,-43211.47 694,-43234.47 694,-43234.47 694,-43240.47 688,-43246.47 682,-43246.47"/>
<text text-anchor="middle" x="547" y="-43231.47" font-family="Arial" font-size="10.00">Layer 37 FFN1 GPU3</text>
<text text-anchor="middle" x="547" y="-43220.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="547" y="-43209.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer37_attn_ar&#45;&gt;layer37_ffn1_3 -->
<g id="edge607" class="edge">
<title>layer37_attn_ar&#45;&gt;layer37_ffn1_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M426.65,-43318.42C452.72,-43297.96 485.22,-43272.45 509.88,-43253.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="512.21,-43255.72 517.92,-43246.79 507.89,-43250.21 512.21,-43255.72"/>
</g>
<!-- layer37_act_2 -->
<g id="node533" class="node">
<title>layer37_act_2</title>
<path fill="#e6f3ff" stroke="black" d="M352,-43127.47C352,-43127.47 82,-43127.47 82,-43127.47 76,-43127.47 70,-43121.47 70,-43115.47 70,-43115.47 70,-43092.47 70,-43092.47 70,-43086.47 76,-43080.47 82,-43080.47 82,-43080.47 352,-43080.47 352,-43080.47 358,-43080.47 364,-43086.47 364,-43092.47 364,-43092.47 364,-43115.47 364,-43115.47 364,-43121.47 358,-43127.47 352,-43127.47"/>
<text text-anchor="middle" x="217" y="-43112.47" font-family="Arial" font-size="10.00">Layer 37 SiLU GPU2</text>
<text text-anchor="middle" x="217" y="-43101.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="217" y="-43090.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer37_ffn1_2&#45;&gt;layer37_act_2 -->
<g id="edge608" class="edge">
<title>layer37_ffn1_2&#45;&gt;layer37_act_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M217,-43199.41C217,-43181.96 217,-43157.55 217,-43137.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="220.5,-43137.86 217,-43127.86 213.5,-43137.86 220.5,-43137.86"/>
</g>
<!-- layer37_act_3 -->
<g id="node534" class="node">
<title>layer37_act_3</title>
<path fill="#e6f3ff" stroke="black" d="M682,-43127.47C682,-43127.47 412,-43127.47 412,-43127.47 406,-43127.47 400,-43121.47 400,-43115.47 400,-43115.47 400,-43092.47 400,-43092.47 400,-43086.47 406,-43080.47 412,-43080.47 412,-43080.47 682,-43080.47 682,-43080.47 688,-43080.47 694,-43086.47 694,-43092.47 694,-43092.47 694,-43115.47 694,-43115.47 694,-43121.47 688,-43127.47 682,-43127.47"/>
<text text-anchor="middle" x="547" y="-43112.47" font-family="Arial" font-size="10.00">Layer 37 SiLU GPU3</text>
<text text-anchor="middle" x="547" y="-43101.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="547" y="-43090.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer37_ffn1_3&#45;&gt;layer37_act_3 -->
<g id="edge609" class="edge">
<title>layer37_ffn1_3&#45;&gt;layer37_act_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M547,-43199.41C547,-43181.96 547,-43157.55 547,-43137.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="550.5,-43137.86 547,-43127.86 543.5,-43137.86 550.5,-43137.86"/>
</g>
<!-- layer37_ffn2_2 -->
<g id="node535" class="node">
<title>layer37_ffn2_2</title>
<path fill="#e6f3ff" stroke="black" d="M351.5,-43008.47C351.5,-43008.47 88.5,-43008.47 88.5,-43008.47 82.5,-43008.47 76.5,-43002.47 76.5,-42996.47 76.5,-42996.47 76.5,-42973.47 76.5,-42973.47 76.5,-42967.47 82.5,-42961.47 88.5,-42961.47 88.5,-42961.47 351.5,-42961.47 351.5,-42961.47 357.5,-42961.47 363.5,-42967.47 363.5,-42973.47 363.5,-42973.47 363.5,-42996.47 363.5,-42996.47 363.5,-43002.47 357.5,-43008.47 351.5,-43008.47"/>
<text text-anchor="middle" x="220" y="-42993.47" font-family="Arial" font-size="10.00">Layer 37 FFN2 GPU2</text>
<text text-anchor="middle" x="220" y="-42982.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="220" y="-42971.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer37_act_2&#45;&gt;layer37_ffn2_2 -->
<g id="edge610" class="edge">
<title>layer37_act_2&#45;&gt;layer37_ffn2_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M217.58,-43080.41C218.03,-43062.96 218.65,-43038.55 219.16,-43018.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="222.66,-43018.94 219.41,-43008.86 215.66,-43018.76 222.66,-43018.94"/>
</g>
<!-- layer37_ffn2_3 -->
<g id="node536" class="node">
<title>layer37_ffn2_3</title>
<path fill="#e6f3ff" stroke="black" d="M676.5,-43008.47C676.5,-43008.47 413.5,-43008.47 413.5,-43008.47 407.5,-43008.47 401.5,-43002.47 401.5,-42996.47 401.5,-42996.47 401.5,-42973.47 401.5,-42973.47 401.5,-42967.47 407.5,-42961.47 413.5,-42961.47 413.5,-42961.47 676.5,-42961.47 676.5,-42961.47 682.5,-42961.47 688.5,-42967.47 688.5,-42973.47 688.5,-42973.47 688.5,-42996.47 688.5,-42996.47 688.5,-43002.47 682.5,-43008.47 676.5,-43008.47"/>
<text text-anchor="middle" x="545" y="-42993.47" font-family="Arial" font-size="10.00">Layer 37 FFN2 GPU3</text>
<text text-anchor="middle" x="545" y="-42982.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="545" y="-42971.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer37_act_3&#45;&gt;layer37_ffn2_3 -->
<g id="edge611" class="edge">
<title>layer37_act_3&#45;&gt;layer37_ffn2_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M546.61,-43080.41C546.32,-43062.96 545.9,-43038.55 545.56,-43018.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="549.06,-43018.8 545.39,-43008.86 542.06,-43018.92 549.06,-43018.8"/>
</g>
<!-- layer37_ffn_ar -->
<g id="node537" class="node">
<title>layer37_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M513.22,-42889.47C513.22,-42889.47 307.8,-42889.47 307.8,-42889.47 301.8,-42889.47 292,-42884.83 288.19,-42880.19 288.19,-42880.19 244.39,-42826.75 244.39,-42826.75 240.59,-42822.11 242.78,-42817.47 248.78,-42817.47 248.78,-42817.47 454.2,-42817.47 454.2,-42817.47 460.2,-42817.47 470,-42822.11 473.81,-42826.75 473.81,-42826.75 517.61,-42880.19 517.61,-42880.19 521.41,-42884.83 519.22,-42889.47 513.22,-42889.47"/>
<text text-anchor="middle" x="381" y="-42856.47" font-family="Arial" font-size="10.00">Layer 37 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="381" y="-42845.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer37_ffn2_2&#45;&gt;layer37_ffn_ar -->
<g id="edge612" class="edge">
<title>layer37_ffn2_2&#45;&gt;layer37_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M248.04,-42961.41C270.43,-42943.41 302.4,-42917.69 329.38,-42895.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="331.61,-42898.68 337.21,-42889.69 327.23,-42893.23 331.61,-42898.68"/>
</g>
<!-- layer37_ffn2_3&#45;&gt;layer37_ffn_ar -->
<g id="edge613" class="edge">
<title>layer37_ffn2_3&#45;&gt;layer37_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M516.43,-42961.41C493.63,-42943.41 461.06,-42917.69 433.58,-42895.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="435.62,-42893.14 425.6,-42889.69 431.28,-42898.63 435.62,-42893.14"/>
</g>
<!-- layer38_qkv_2 -->
<g id="node538" class="node">
<title>layer38_qkv_2</title>
<path fill="#e6f3ff" stroke="black" d="M351,-42745.47C351,-42745.47 53,-42745.47 53,-42745.47 47,-42745.47 41,-42739.47 41,-42733.47 41,-42733.47 41,-42710.47 41,-42710.47 41,-42704.47 47,-42698.47 53,-42698.47 53,-42698.47 351,-42698.47 351,-42698.47 357,-42698.47 363,-42704.47 363,-42710.47 363,-42710.47 363,-42733.47 363,-42733.47 363,-42739.47 357,-42745.47 351,-42745.47"/>
<text text-anchor="middle" x="202" y="-42730.47" font-family="Arial" font-size="10.00">Layer 38 QKV Proj GPU2</text>
<text text-anchor="middle" x="202" y="-42719.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="202" y="-42708.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer37_ffn_ar&#45;&gt;layer38_qkv_2 -->
<g id="edge614" class="edge">
<title>layer37_ffn_ar&#45;&gt;layer38_qkv_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M332.56,-42817.42C304.06,-42796.81 268.48,-42771.06 241.66,-42751.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="243.43,-42748.62 233.28,-42745.6 239.33,-42754.3 243.43,-42748.62"/>
</g>
<!-- layer38_qkv_3 -->
<g id="node539" class="node">
<title>layer38_qkv_3</title>
<path fill="#e6f3ff" stroke="black" d="M709,-42745.47C709,-42745.47 411,-42745.47 411,-42745.47 405,-42745.47 399,-42739.47 399,-42733.47 399,-42733.47 399,-42710.47 399,-42710.47 399,-42704.47 405,-42698.47 411,-42698.47 411,-42698.47 709,-42698.47 709,-42698.47 715,-42698.47 721,-42704.47 721,-42710.47 721,-42710.47 721,-42733.47 721,-42733.47 721,-42739.47 715,-42745.47 709,-42745.47"/>
<text text-anchor="middle" x="560" y="-42730.47" font-family="Arial" font-size="10.00">Layer 38 QKV Proj GPU3</text>
<text text-anchor="middle" x="560" y="-42719.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="560" y="-42708.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer37_ffn_ar&#45;&gt;layer38_qkv_3 -->
<g id="edge615" class="edge">
<title>layer37_ffn_ar&#45;&gt;layer38_qkv_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M429.44,-42817.42C457.94,-42796.81 493.52,-42771.06 520.34,-42751.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="522.67,-42754.3 528.72,-42745.6 518.57,-42748.62 522.67,-42754.3"/>
</g>
<!-- layer38_attn_2 -->
<g id="node540" class="node">
<title>layer38_attn_2</title>
<path fill="#e6f3ff" stroke="black" d="M351,-42626.47C351,-42626.47 53,-42626.47 53,-42626.47 47,-42626.47 41,-42620.47 41,-42614.47 41,-42614.47 41,-42591.47 41,-42591.47 41,-42585.47 47,-42579.47 53,-42579.47 53,-42579.47 351,-42579.47 351,-42579.47 357,-42579.47 363,-42585.47 363,-42591.47 363,-42591.47 363,-42614.47 363,-42614.47 363,-42620.47 357,-42626.47 351,-42626.47"/>
<text text-anchor="middle" x="202" y="-42611.47" font-family="Arial" font-size="10.00">Layer 38 Attention GPU2</text>
<text text-anchor="middle" x="202" y="-42600.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="202" y="-42589.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer38_qkv_2&#45;&gt;layer38_attn_2 -->
<g id="edge616" class="edge">
<title>layer38_qkv_2&#45;&gt;layer38_attn_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M202,-42698.41C202,-42680.96 202,-42656.55 202,-42636.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="205.5,-42636.86 202,-42626.86 198.5,-42636.86 205.5,-42636.86"/>
</g>
<!-- layer38_attn_3 -->
<g id="node541" class="node">
<title>layer38_attn_3</title>
<path fill="#e6f3ff" stroke="black" d="M709,-42626.47C709,-42626.47 411,-42626.47 411,-42626.47 405,-42626.47 399,-42620.47 399,-42614.47 399,-42614.47 399,-42591.47 399,-42591.47 399,-42585.47 405,-42579.47 411,-42579.47 411,-42579.47 709,-42579.47 709,-42579.47 715,-42579.47 721,-42585.47 721,-42591.47 721,-42591.47 721,-42614.47 721,-42614.47 721,-42620.47 715,-42626.47 709,-42626.47"/>
<text text-anchor="middle" x="560" y="-42611.47" font-family="Arial" font-size="10.00">Layer 38 Attention GPU3</text>
<text text-anchor="middle" x="560" y="-42600.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="560" y="-42589.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer38_qkv_3&#45;&gt;layer38_attn_3 -->
<g id="edge617" class="edge">
<title>layer38_qkv_3&#45;&gt;layer38_attn_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M560,-42698.41C560,-42680.96 560,-42656.55 560,-42636.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="563.5,-42636.86 560,-42626.86 556.5,-42636.86 563.5,-42636.86"/>
</g>
<!-- layer38_attn_out_2 -->
<g id="node542" class="node">
<title>layer38_attn_out_2</title>
<path fill="#e6f3ff" stroke="black" d="M351,-42507.47C351,-42507.47 61,-42507.47 61,-42507.47 55,-42507.47 49,-42501.47 49,-42495.47 49,-42495.47 49,-42472.47 49,-42472.47 49,-42466.47 55,-42460.47 61,-42460.47 61,-42460.47 351,-42460.47 351,-42460.47 357,-42460.47 363,-42466.47 363,-42472.47 363,-42472.47 363,-42495.47 363,-42495.47 363,-42501.47 357,-42507.47 351,-42507.47"/>
<text text-anchor="middle" x="206" y="-42492.47" font-family="Arial" font-size="10.00">Layer 38 Attn Out GPU2</text>
<text text-anchor="middle" x="206" y="-42481.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="206" y="-42470.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer38_attn_2&#45;&gt;layer38_attn_out_2 -->
<g id="edge618" class="edge">
<title>layer38_attn_2&#45;&gt;layer38_attn_out_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M202.77,-42579.41C203.37,-42561.96 204.2,-42537.55 204.87,-42517.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="208.37,-42517.97 205.22,-42507.86 201.38,-42517.73 208.37,-42517.97"/>
</g>
<!-- layer38_attn_out_3 -->
<g id="node543" class="node">
<title>layer38_attn_out_3</title>
<path fill="#e6f3ff" stroke="black" d="M703,-42507.47C703,-42507.47 413,-42507.47 413,-42507.47 407,-42507.47 401,-42501.47 401,-42495.47 401,-42495.47 401,-42472.47 401,-42472.47 401,-42466.47 407,-42460.47 413,-42460.47 413,-42460.47 703,-42460.47 703,-42460.47 709,-42460.47 715,-42466.47 715,-42472.47 715,-42472.47 715,-42495.47 715,-42495.47 715,-42501.47 709,-42507.47 703,-42507.47"/>
<text text-anchor="middle" x="558" y="-42492.47" font-family="Arial" font-size="10.00">Layer 38 Attn Out GPU3</text>
<text text-anchor="middle" x="558" y="-42481.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="558" y="-42470.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer38_attn_3&#45;&gt;layer38_attn_out_3 -->
<g id="edge619" class="edge">
<title>layer38_attn_3&#45;&gt;layer38_attn_out_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M559.61,-42579.41C559.32,-42561.96 558.9,-42537.55 558.56,-42517.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="562.06,-42517.8 558.39,-42507.86 555.06,-42517.92 562.06,-42517.8"/>
</g>
<!-- layer38_attn_ar -->
<g id="node544" class="node">
<title>layer38_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M511.07,-42388.47C511.07,-42388.47 309.07,-42388.47 309.07,-42388.47 303.07,-42388.47 293.3,-42383.8 289.53,-42379.13 289.53,-42379.13 246.47,-42325.8 246.47,-42325.8 242.7,-42321.14 244.93,-42316.47 250.93,-42316.47 250.93,-42316.47 452.93,-42316.47 452.93,-42316.47 458.93,-42316.47 468.7,-42321.14 472.47,-42325.8 472.47,-42325.8 515.53,-42379.13 515.53,-42379.13 519.3,-42383.8 517.07,-42388.47 511.07,-42388.47"/>
<text text-anchor="middle" x="381" y="-42355.47" font-family="Arial" font-size="10.00">Layer 38 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="381" y="-42344.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer38_attn_out_2&#45;&gt;layer38_attn_ar -->
<g id="edge620" class="edge">
<title>layer38_attn_out_2&#45;&gt;layer38_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M236.48,-42460.41C260.92,-42442.33 295.86,-42416.47 325.27,-42394.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="327.45,-42397.45 333.4,-42388.69 323.28,-42391.82 327.45,-42397.45"/>
</g>
<!-- layer38_attn_out_3&#45;&gt;layer38_attn_ar -->
<g id="edge621" class="edge">
<title>layer38_attn_out_3&#45;&gt;layer38_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M527.17,-42460.41C502.45,-42442.33 467.11,-42416.47 437.37,-42394.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="439.28,-42391.77 429.14,-42388.69 435.14,-42397.42 439.28,-42391.77"/>
</g>
<!-- layer38_ffn1_2 -->
<g id="node545" class="node">
<title>layer38_ffn1_2</title>
<path fill="#e6f3ff" stroke="black" d="M351,-42244.47C351,-42244.47 81,-42244.47 81,-42244.47 75,-42244.47 69,-42238.47 69,-42232.47 69,-42232.47 69,-42209.47 69,-42209.47 69,-42203.47 75,-42197.47 81,-42197.47 81,-42197.47 351,-42197.47 351,-42197.47 357,-42197.47 363,-42203.47 363,-42209.47 363,-42209.47 363,-42232.47 363,-42232.47 363,-42238.47 357,-42244.47 351,-42244.47"/>
<text text-anchor="middle" x="216" y="-42229.47" font-family="Arial" font-size="10.00">Layer 38 FFN1 GPU2</text>
<text text-anchor="middle" x="216" y="-42218.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="216" y="-42207.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer38_attn_ar&#45;&gt;layer38_ffn1_2 -->
<g id="edge622" class="edge">
<title>layer38_attn_ar&#45;&gt;layer38_ffn1_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M336.35,-42316.42C310.28,-42295.96 277.78,-42270.45 253.12,-42251.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="255.11,-42248.21 245.08,-42244.79 250.79,-42253.72 255.11,-42248.21"/>
</g>
<!-- layer38_ffn1_3 -->
<g id="node546" class="node">
<title>layer38_ffn1_3</title>
<path fill="#e6f3ff" stroke="black" d="M681,-42244.47C681,-42244.47 411,-42244.47 411,-42244.47 405,-42244.47 399,-42238.47 399,-42232.47 399,-42232.47 399,-42209.47 399,-42209.47 399,-42203.47 405,-42197.47 411,-42197.47 411,-42197.47 681,-42197.47 681,-42197.47 687,-42197.47 693,-42203.47 693,-42209.47 693,-42209.47 693,-42232.47 693,-42232.47 693,-42238.47 687,-42244.47 681,-42244.47"/>
<text text-anchor="middle" x="546" y="-42229.47" font-family="Arial" font-size="10.00">Layer 38 FFN1 GPU3</text>
<text text-anchor="middle" x="546" y="-42218.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="546" y="-42207.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer38_attn_ar&#45;&gt;layer38_ffn1_3 -->
<g id="edge623" class="edge">
<title>layer38_attn_ar&#45;&gt;layer38_ffn1_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M425.65,-42316.42C451.72,-42295.96 484.22,-42270.45 508.88,-42251.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="511.21,-42253.72 516.92,-42244.79 506.89,-42248.21 511.21,-42253.72"/>
</g>
<!-- layer38_act_2 -->
<g id="node547" class="node">
<title>layer38_act_2</title>
<path fill="#e6f3ff" stroke="black" d="M351,-42125.47C351,-42125.47 81,-42125.47 81,-42125.47 75,-42125.47 69,-42119.47 69,-42113.47 69,-42113.47 69,-42090.47 69,-42090.47 69,-42084.47 75,-42078.47 81,-42078.47 81,-42078.47 351,-42078.47 351,-42078.47 357,-42078.47 363,-42084.47 363,-42090.47 363,-42090.47 363,-42113.47 363,-42113.47 363,-42119.47 357,-42125.47 351,-42125.47"/>
<text text-anchor="middle" x="216" y="-42110.47" font-family="Arial" font-size="10.00">Layer 38 SiLU GPU2</text>
<text text-anchor="middle" x="216" y="-42099.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="216" y="-42088.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer38_ffn1_2&#45;&gt;layer38_act_2 -->
<g id="edge624" class="edge">
<title>layer38_ffn1_2&#45;&gt;layer38_act_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M216,-42197.41C216,-42179.96 216,-42155.55 216,-42135.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="219.5,-42135.86 216,-42125.86 212.5,-42135.86 219.5,-42135.86"/>
</g>
<!-- layer38_act_3 -->
<g id="node548" class="node">
<title>layer38_act_3</title>
<path fill="#e6f3ff" stroke="black" d="M681,-42125.47C681,-42125.47 411,-42125.47 411,-42125.47 405,-42125.47 399,-42119.47 399,-42113.47 399,-42113.47 399,-42090.47 399,-42090.47 399,-42084.47 405,-42078.47 411,-42078.47 411,-42078.47 681,-42078.47 681,-42078.47 687,-42078.47 693,-42084.47 693,-42090.47 693,-42090.47 693,-42113.47 693,-42113.47 693,-42119.47 687,-42125.47 681,-42125.47"/>
<text text-anchor="middle" x="546" y="-42110.47" font-family="Arial" font-size="10.00">Layer 38 SiLU GPU3</text>
<text text-anchor="middle" x="546" y="-42099.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="546" y="-42088.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer38_ffn1_3&#45;&gt;layer38_act_3 -->
<g id="edge625" class="edge">
<title>layer38_ffn1_3&#45;&gt;layer38_act_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M546,-42197.41C546,-42179.96 546,-42155.55 546,-42135.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="549.5,-42135.86 546,-42125.86 542.5,-42135.86 549.5,-42135.86"/>
</g>
<!-- layer38_ffn2_2 -->
<g id="node549" class="node">
<title>layer38_ffn2_2</title>
<path fill="#e6f3ff" stroke="black" d="M350.5,-42006.47C350.5,-42006.47 87.5,-42006.47 87.5,-42006.47 81.5,-42006.47 75.5,-42000.47 75.5,-41994.47 75.5,-41994.47 75.5,-41971.47 75.5,-41971.47 75.5,-41965.47 81.5,-41959.47 87.5,-41959.47 87.5,-41959.47 350.5,-41959.47 350.5,-41959.47 356.5,-41959.47 362.5,-41965.47 362.5,-41971.47 362.5,-41971.47 362.5,-41994.47 362.5,-41994.47 362.5,-42000.47 356.5,-42006.47 350.5,-42006.47"/>
<text text-anchor="middle" x="219" y="-41991.47" font-family="Arial" font-size="10.00">Layer 38 FFN2 GPU2</text>
<text text-anchor="middle" x="219" y="-41980.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="219" y="-41969.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer38_act_2&#45;&gt;layer38_ffn2_2 -->
<g id="edge626" class="edge">
<title>layer38_act_2&#45;&gt;layer38_ffn2_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M216.58,-42078.41C217.03,-42060.96 217.65,-42036.55 218.16,-42016.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="221.66,-42016.94 218.41,-42006.86 214.66,-42016.76 221.66,-42016.94"/>
</g>
<!-- layer38_ffn2_3 -->
<g id="node550" class="node">
<title>layer38_ffn2_3</title>
<path fill="#e6f3ff" stroke="black" d="M675.5,-42006.47C675.5,-42006.47 412.5,-42006.47 412.5,-42006.47 406.5,-42006.47 400.5,-42000.47 400.5,-41994.47 400.5,-41994.47 400.5,-41971.47 400.5,-41971.47 400.5,-41965.47 406.5,-41959.47 412.5,-41959.47 412.5,-41959.47 675.5,-41959.47 675.5,-41959.47 681.5,-41959.47 687.5,-41965.47 687.5,-41971.47 687.5,-41971.47 687.5,-41994.47 687.5,-41994.47 687.5,-42000.47 681.5,-42006.47 675.5,-42006.47"/>
<text text-anchor="middle" x="544" y="-41991.47" font-family="Arial" font-size="10.00">Layer 38 FFN2 GPU3</text>
<text text-anchor="middle" x="544" y="-41980.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="544" y="-41969.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer38_act_3&#45;&gt;layer38_ffn2_3 -->
<g id="edge627" class="edge">
<title>layer38_act_3&#45;&gt;layer38_ffn2_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M545.61,-42078.41C545.32,-42060.96 544.9,-42036.55 544.56,-42016.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="548.06,-42016.8 544.39,-42006.86 541.06,-42016.92 548.06,-42016.8"/>
</g>
<!-- layer38_ffn_ar -->
<g id="node551" class="node">
<title>layer38_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M512.22,-41887.47C512.22,-41887.47 306.8,-41887.47 306.8,-41887.47 300.8,-41887.47 291,-41882.83 287.19,-41878.19 287.19,-41878.19 243.39,-41824.75 243.39,-41824.75 239.59,-41820.11 241.78,-41815.47 247.78,-41815.47 247.78,-41815.47 453.2,-41815.47 453.2,-41815.47 459.2,-41815.47 469,-41820.11 472.81,-41824.75 472.81,-41824.75 516.61,-41878.19 516.61,-41878.19 520.41,-41882.83 518.22,-41887.47 512.22,-41887.47"/>
<text text-anchor="middle" x="380" y="-41854.47" font-family="Arial" font-size="10.00">Layer 38 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="380" y="-41843.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer38_ffn2_2&#45;&gt;layer38_ffn_ar -->
<g id="edge628" class="edge">
<title>layer38_ffn2_2&#45;&gt;layer38_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M247.04,-41959.41C269.43,-41941.41 301.4,-41915.69 328.38,-41893.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="330.61,-41896.68 336.21,-41887.69 326.23,-41891.23 330.61,-41896.68"/>
</g>
<!-- layer38_ffn2_3&#45;&gt;layer38_ffn_ar -->
<g id="edge629" class="edge">
<title>layer38_ffn2_3&#45;&gt;layer38_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M515.43,-41959.41C492.63,-41941.41 460.06,-41915.69 432.58,-41893.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="434.62,-41891.14 424.6,-41887.69 430.28,-41896.63 434.62,-41891.14"/>
</g>
<!-- layer39_qkv_2 -->
<g id="node552" class="node">
<title>layer39_qkv_2</title>
<path fill="#e6f3ff" stroke="black" d="M350,-41743.47C350,-41743.47 52,-41743.47 52,-41743.47 46,-41743.47 40,-41737.47 40,-41731.47 40,-41731.47 40,-41708.47 40,-41708.47 40,-41702.47 46,-41696.47 52,-41696.47 52,-41696.47 350,-41696.47 350,-41696.47 356,-41696.47 362,-41702.47 362,-41708.47 362,-41708.47 362,-41731.47 362,-41731.47 362,-41737.47 356,-41743.47 350,-41743.47"/>
<text text-anchor="middle" x="201" y="-41728.47" font-family="Arial" font-size="10.00">Layer 39 QKV Proj GPU2</text>
<text text-anchor="middle" x="201" y="-41717.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="201" y="-41706.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer38_ffn_ar&#45;&gt;layer39_qkv_2 -->
<g id="edge630" class="edge">
<title>layer38_ffn_ar&#45;&gt;layer39_qkv_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M331.56,-41815.42C303.06,-41794.81 267.48,-41769.06 240.66,-41749.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="242.43,-41746.62 232.28,-41743.6 238.33,-41752.3 242.43,-41746.62"/>
</g>
<!-- layer39_qkv_3 -->
<g id="node553" class="node">
<title>layer39_qkv_3</title>
<path fill="#e6f3ff" stroke="black" d="M708,-41743.47C708,-41743.47 410,-41743.47 410,-41743.47 404,-41743.47 398,-41737.47 398,-41731.47 398,-41731.47 398,-41708.47 398,-41708.47 398,-41702.47 404,-41696.47 410,-41696.47 410,-41696.47 708,-41696.47 708,-41696.47 714,-41696.47 720,-41702.47 720,-41708.47 720,-41708.47 720,-41731.47 720,-41731.47 720,-41737.47 714,-41743.47 708,-41743.47"/>
<text text-anchor="middle" x="559" y="-41728.47" font-family="Arial" font-size="10.00">Layer 39 QKV Proj GPU3</text>
<text text-anchor="middle" x="559" y="-41717.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-41706.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer38_ffn_ar&#45;&gt;layer39_qkv_3 -->
<g id="edge631" class="edge">
<title>layer38_ffn_ar&#45;&gt;layer39_qkv_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M428.44,-41815.42C456.94,-41794.81 492.52,-41769.06 519.34,-41749.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="521.67,-41752.3 527.72,-41743.6 517.57,-41746.62 521.67,-41752.3"/>
</g>
<!-- layer39_attn_2 -->
<g id="node554" class="node">
<title>layer39_attn_2</title>
<path fill="#e6f3ff" stroke="black" d="M350,-41624.47C350,-41624.47 52,-41624.47 52,-41624.47 46,-41624.47 40,-41618.47 40,-41612.47 40,-41612.47 40,-41589.47 40,-41589.47 40,-41583.47 46,-41577.47 52,-41577.47 52,-41577.47 350,-41577.47 350,-41577.47 356,-41577.47 362,-41583.47 362,-41589.47 362,-41589.47 362,-41612.47 362,-41612.47 362,-41618.47 356,-41624.47 350,-41624.47"/>
<text text-anchor="middle" x="201" y="-41609.47" font-family="Arial" font-size="10.00">Layer 39 Attention GPU2</text>
<text text-anchor="middle" x="201" y="-41598.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="201" y="-41587.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer39_qkv_2&#45;&gt;layer39_attn_2 -->
<g id="edge632" class="edge">
<title>layer39_qkv_2&#45;&gt;layer39_attn_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M201,-41696.41C201,-41678.96 201,-41654.55 201,-41634.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="204.5,-41634.86 201,-41624.86 197.5,-41634.86 204.5,-41634.86"/>
</g>
<!-- layer39_attn_3 -->
<g id="node555" class="node">
<title>layer39_attn_3</title>
<path fill="#e6f3ff" stroke="black" d="M708,-41624.47C708,-41624.47 410,-41624.47 410,-41624.47 404,-41624.47 398,-41618.47 398,-41612.47 398,-41612.47 398,-41589.47 398,-41589.47 398,-41583.47 404,-41577.47 410,-41577.47 410,-41577.47 708,-41577.47 708,-41577.47 714,-41577.47 720,-41583.47 720,-41589.47 720,-41589.47 720,-41612.47 720,-41612.47 720,-41618.47 714,-41624.47 708,-41624.47"/>
<text text-anchor="middle" x="559" y="-41609.47" font-family="Arial" font-size="10.00">Layer 39 Attention GPU3</text>
<text text-anchor="middle" x="559" y="-41598.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="559" y="-41587.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer39_qkv_3&#45;&gt;layer39_attn_3 -->
<g id="edge633" class="edge">
<title>layer39_qkv_3&#45;&gt;layer39_attn_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M559,-41696.41C559,-41678.96 559,-41654.55 559,-41634.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="562.5,-41634.86 559,-41624.86 555.5,-41634.86 562.5,-41634.86"/>
</g>
<!-- layer39_attn_out_2 -->
<g id="node556" class="node">
<title>layer39_attn_out_2</title>
<path fill="#e6f3ff" stroke="black" d="M350,-41505.47C350,-41505.47 60,-41505.47 60,-41505.47 54,-41505.47 48,-41499.47 48,-41493.47 48,-41493.47 48,-41470.47 48,-41470.47 48,-41464.47 54,-41458.47 60,-41458.47 60,-41458.47 350,-41458.47 350,-41458.47 356,-41458.47 362,-41464.47 362,-41470.47 362,-41470.47 362,-41493.47 362,-41493.47 362,-41499.47 356,-41505.47 350,-41505.47"/>
<text text-anchor="middle" x="205" y="-41490.47" font-family="Arial" font-size="10.00">Layer 39 Attn Out GPU2</text>
<text text-anchor="middle" x="205" y="-41479.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="205" y="-41468.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer39_attn_2&#45;&gt;layer39_attn_out_2 -->
<g id="edge634" class="edge">
<title>layer39_attn_2&#45;&gt;layer39_attn_out_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M201.77,-41577.41C202.37,-41559.96 203.2,-41535.55 203.87,-41515.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="207.37,-41515.97 204.22,-41505.86 200.38,-41515.73 207.37,-41515.97"/>
</g>
<!-- layer39_attn_out_3 -->
<g id="node557" class="node">
<title>layer39_attn_out_3</title>
<path fill="#e6f3ff" stroke="black" d="M702,-41505.47C702,-41505.47 412,-41505.47 412,-41505.47 406,-41505.47 400,-41499.47 400,-41493.47 400,-41493.47 400,-41470.47 400,-41470.47 400,-41464.47 406,-41458.47 412,-41458.47 412,-41458.47 702,-41458.47 702,-41458.47 708,-41458.47 714,-41464.47 714,-41470.47 714,-41470.47 714,-41493.47 714,-41493.47 714,-41499.47 708,-41505.47 702,-41505.47"/>
<text text-anchor="middle" x="557" y="-41490.47" font-family="Arial" font-size="10.00">Layer 39 Attn Out GPU3</text>
<text text-anchor="middle" x="557" y="-41479.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="557" y="-41468.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer39_attn_3&#45;&gt;layer39_attn_out_3 -->
<g id="edge635" class="edge">
<title>layer39_attn_3&#45;&gt;layer39_attn_out_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M558.61,-41577.41C558.32,-41559.96 557.9,-41535.55 557.56,-41515.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="561.06,-41515.8 557.39,-41505.86 554.06,-41515.92 561.06,-41515.8"/>
</g>
<!-- layer39_attn_ar -->
<g id="node558" class="node">
<title>layer39_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M510.07,-41386.47C510.07,-41386.47 308.07,-41386.47 308.07,-41386.47 302.07,-41386.47 292.3,-41381.8 288.53,-41377.13 288.53,-41377.13 245.47,-41323.8 245.47,-41323.8 241.7,-41319.14 243.93,-41314.47 249.93,-41314.47 249.93,-41314.47 451.93,-41314.47 451.93,-41314.47 457.93,-41314.47 467.7,-41319.14 471.47,-41323.8 471.47,-41323.8 514.53,-41377.13 514.53,-41377.13 518.3,-41381.8 516.07,-41386.47 510.07,-41386.47"/>
<text text-anchor="middle" x="380" y="-41353.47" font-family="Arial" font-size="10.00">Layer 39 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="380" y="-41342.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer39_attn_out_2&#45;&gt;layer39_attn_ar -->
<g id="edge636" class="edge">
<title>layer39_attn_out_2&#45;&gt;layer39_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M235.48,-41458.41C259.92,-41440.33 294.86,-41414.47 324.27,-41392.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="326.45,-41395.45 332.4,-41386.69 322.28,-41389.82 326.45,-41395.45"/>
</g>
<!-- layer39_attn_out_3&#45;&gt;layer39_attn_ar -->
<g id="edge637" class="edge">
<title>layer39_attn_out_3&#45;&gt;layer39_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M526.17,-41458.41C501.45,-41440.33 466.11,-41414.47 436.37,-41392.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="438.28,-41389.77 428.14,-41386.69 434.14,-41395.42 438.28,-41389.77"/>
</g>
<!-- layer39_ffn1_2 -->
<g id="node559" class="node">
<title>layer39_ffn1_2</title>
<path fill="#e6f3ff" stroke="black" d="M350,-41242.47C350,-41242.47 80,-41242.47 80,-41242.47 74,-41242.47 68,-41236.47 68,-41230.47 68,-41230.47 68,-41207.47 68,-41207.47 68,-41201.47 74,-41195.47 80,-41195.47 80,-41195.47 350,-41195.47 350,-41195.47 356,-41195.47 362,-41201.47 362,-41207.47 362,-41207.47 362,-41230.47 362,-41230.47 362,-41236.47 356,-41242.47 350,-41242.47"/>
<text text-anchor="middle" x="215" y="-41227.47" font-family="Arial" font-size="10.00">Layer 39 FFN1 GPU2</text>
<text text-anchor="middle" x="215" y="-41216.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="215" y="-41205.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer39_attn_ar&#45;&gt;layer39_ffn1_2 -->
<g id="edge638" class="edge">
<title>layer39_attn_ar&#45;&gt;layer39_ffn1_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M335.35,-41314.42C309.28,-41293.96 276.78,-41268.45 252.12,-41249.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="254.11,-41246.21 244.08,-41242.79 249.79,-41251.72 254.11,-41246.21"/>
</g>
<!-- layer39_ffn1_3 -->
<g id="node560" class="node">
<title>layer39_ffn1_3</title>
<path fill="#e6f3ff" stroke="black" d="M680,-41242.47C680,-41242.47 410,-41242.47 410,-41242.47 404,-41242.47 398,-41236.47 398,-41230.47 398,-41230.47 398,-41207.47 398,-41207.47 398,-41201.47 404,-41195.47 410,-41195.47 410,-41195.47 680,-41195.47 680,-41195.47 686,-41195.47 692,-41201.47 692,-41207.47 692,-41207.47 692,-41230.47 692,-41230.47 692,-41236.47 686,-41242.47 680,-41242.47"/>
<text text-anchor="middle" x="545" y="-41227.47" font-family="Arial" font-size="10.00">Layer 39 FFN1 GPU3</text>
<text text-anchor="middle" x="545" y="-41216.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="545" y="-41205.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer39_attn_ar&#45;&gt;layer39_ffn1_3 -->
<g id="edge639" class="edge">
<title>layer39_attn_ar&#45;&gt;layer39_ffn1_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M424.65,-41314.42C450.72,-41293.96 483.22,-41268.45 507.88,-41249.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="510.21,-41251.72 515.92,-41242.79 505.89,-41246.21 510.21,-41251.72"/>
</g>
<!-- layer39_act_2 -->
<g id="node561" class="node">
<title>layer39_act_2</title>
<path fill="#e6f3ff" stroke="black" d="M350,-41123.47C350,-41123.47 80,-41123.47 80,-41123.47 74,-41123.47 68,-41117.47 68,-41111.47 68,-41111.47 68,-41088.47 68,-41088.47 68,-41082.47 74,-41076.47 80,-41076.47 80,-41076.47 350,-41076.47 350,-41076.47 356,-41076.47 362,-41082.47 362,-41088.47 362,-41088.47 362,-41111.47 362,-41111.47 362,-41117.47 356,-41123.47 350,-41123.47"/>
<text text-anchor="middle" x="215" y="-41108.47" font-family="Arial" font-size="10.00">Layer 39 SiLU GPU2</text>
<text text-anchor="middle" x="215" y="-41097.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="215" y="-41086.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer39_ffn1_2&#45;&gt;layer39_act_2 -->
<g id="edge640" class="edge">
<title>layer39_ffn1_2&#45;&gt;layer39_act_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M215,-41195.41C215,-41177.96 215,-41153.55 215,-41133.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="218.5,-41133.86 215,-41123.86 211.5,-41133.86 218.5,-41133.86"/>
</g>
<!-- layer39_act_3 -->
<g id="node562" class="node">
<title>layer39_act_3</title>
<path fill="#e6f3ff" stroke="black" d="M680,-41123.47C680,-41123.47 410,-41123.47 410,-41123.47 404,-41123.47 398,-41117.47 398,-41111.47 398,-41111.47 398,-41088.47 398,-41088.47 398,-41082.47 404,-41076.47 410,-41076.47 410,-41076.47 680,-41076.47 680,-41076.47 686,-41076.47 692,-41082.47 692,-41088.47 692,-41088.47 692,-41111.47 692,-41111.47 692,-41117.47 686,-41123.47 680,-41123.47"/>
<text text-anchor="middle" x="545" y="-41108.47" font-family="Arial" font-size="10.00">Layer 39 SiLU GPU3</text>
<text text-anchor="middle" x="545" y="-41097.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="545" y="-41086.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer39_ffn1_3&#45;&gt;layer39_act_3 -->
<g id="edge641" class="edge">
<title>layer39_ffn1_3&#45;&gt;layer39_act_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M545,-41195.41C545,-41177.96 545,-41153.55 545,-41133.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="548.5,-41133.86 545,-41123.86 541.5,-41133.86 548.5,-41133.86"/>
</g>
<!-- layer39_ffn2_2 -->
<g id="node563" class="node">
<title>layer39_ffn2_2</title>
<path fill="#e6f3ff" stroke="black" d="M349.5,-41004.47C349.5,-41004.47 86.5,-41004.47 86.5,-41004.47 80.5,-41004.47 74.5,-40998.47 74.5,-40992.47 74.5,-40992.47 74.5,-40969.47 74.5,-40969.47 74.5,-40963.47 80.5,-40957.47 86.5,-40957.47 86.5,-40957.47 349.5,-40957.47 349.5,-40957.47 355.5,-40957.47 361.5,-40963.47 361.5,-40969.47 361.5,-40969.47 361.5,-40992.47 361.5,-40992.47 361.5,-40998.47 355.5,-41004.47 349.5,-41004.47"/>
<text text-anchor="middle" x="218" y="-40989.47" font-family="Arial" font-size="10.00">Layer 39 FFN2 GPU2</text>
<text text-anchor="middle" x="218" y="-40978.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="218" y="-40967.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer39_act_2&#45;&gt;layer39_ffn2_2 -->
<g id="edge642" class="edge">
<title>layer39_act_2&#45;&gt;layer39_ffn2_2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M215.58,-41076.41C216.03,-41058.96 216.65,-41034.55 217.16,-41014.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="220.66,-41014.94 217.41,-41004.86 213.66,-41014.76 220.66,-41014.94"/>
</g>
<!-- layer39_ffn2_3 -->
<g id="node564" class="node">
<title>layer39_ffn2_3</title>
<path fill="#e6f3ff" stroke="black" d="M674.5,-41004.47C674.5,-41004.47 411.5,-41004.47 411.5,-41004.47 405.5,-41004.47 399.5,-40998.47 399.5,-40992.47 399.5,-40992.47 399.5,-40969.47 399.5,-40969.47 399.5,-40963.47 405.5,-40957.47 411.5,-40957.47 411.5,-40957.47 674.5,-40957.47 674.5,-40957.47 680.5,-40957.47 686.5,-40963.47 686.5,-40969.47 686.5,-40969.47 686.5,-40992.47 686.5,-40992.47 686.5,-40998.47 680.5,-41004.47 674.5,-41004.47"/>
<text text-anchor="middle" x="543" y="-40989.47" font-family="Arial" font-size="10.00">Layer 39 FFN2 GPU3</text>
<text text-anchor="middle" x="543" y="-40978.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="543" y="-40967.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer39_act_3&#45;&gt;layer39_ffn2_3 -->
<g id="edge643" class="edge">
<title>layer39_act_3&#45;&gt;layer39_ffn2_3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M544.61,-41076.41C544.32,-41058.96 543.9,-41034.55 543.56,-41014.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="547.06,-41014.8 543.39,-41004.86 540.06,-41014.92 547.06,-41014.8"/>
</g>
<!-- layer39_ffn_ar -->
<g id="node565" class="node">
<title>layer39_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M511.22,-40885.47C511.22,-40885.47 305.8,-40885.47 305.8,-40885.47 299.8,-40885.47 290,-40880.83 286.19,-40876.19 286.19,-40876.19 242.39,-40822.75 242.39,-40822.75 238.59,-40818.11 240.78,-40813.47 246.78,-40813.47 246.78,-40813.47 452.2,-40813.47 452.2,-40813.47 458.2,-40813.47 468,-40818.11 471.81,-40822.75 471.81,-40822.75 515.61,-40876.19 515.61,-40876.19 519.41,-40880.83 517.22,-40885.47 511.22,-40885.47"/>
<text text-anchor="middle" x="379" y="-40852.47" font-family="Arial" font-size="10.00">Layer 39 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="379" y="-40841.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer39_ffn2_2&#45;&gt;layer39_ffn_ar -->
<g id="edge644" class="edge">
<title>layer39_ffn2_2&#45;&gt;layer39_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M246.04,-40957.41C268.43,-40939.41 300.4,-40913.69 327.38,-40891.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="329.61,-40894.68 335.21,-40885.69 325.23,-40889.23 329.61,-40894.68"/>
</g>
<!-- layer39_ffn2_3&#45;&gt;layer39_ffn_ar -->
<g id="edge645" class="edge">
<title>layer39_ffn2_3&#45;&gt;layer39_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M514.43,-40957.41C491.63,-40939.41 459.06,-40913.69 431.58,-40891.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="433.62,-40889.14 423.6,-40885.69 429.28,-40894.63 433.62,-40889.14"/>
</g>
<!-- stage1_to_stage2 -->
<g id="node566" class="node">
<title>stage1_to_stage2</title>
<path fill="#ffe6e6" stroke="black" d="M483.23,-40741.47C483.23,-40741.47 322.33,-40741.47 322.33,-40741.47 316.33,-40741.47 307.62,-40736.11 304.91,-40730.76 304.91,-40730.76 268.19,-40658.18 268.19,-40658.18 265.48,-40652.82 268.77,-40647.47 274.77,-40647.47 274.77,-40647.47 435.67,-40647.47 435.67,-40647.47 441.67,-40647.47 450.38,-40652.82 453.09,-40658.18 453.09,-40658.18 489.81,-40730.76 489.81,-40730.76 492.52,-40736.11 489.23,-40741.47 483.23,-40741.47"/>
<text text-anchor="middle" x="379" y="-40702.97" font-family="Arial" font-size="10.00">Pipeline Forward</text>
<text text-anchor="middle" x="379" y="-40691.97" font-family="Arial" font-size="10.00">Stage 1  Stage 2</text>
<text text-anchor="middle" x="379" y="-40680.97" font-family="Arial" font-size="10.00">[PP Forward]</text>
</g>
<!-- layer39_ffn_ar&#45;&gt;stage1_to_stage2 -->
<g id="edge646" class="edge">
<title>layer39_ffn_ar&#45;&gt;stage1_to_stage2</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M379,-40813.37C379,-40795.18 379,-40772.52 379,-40751.94"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="382.5,-40751.72 379,-40741.72 375.5,-40751.72 382.5,-40751.72"/>
</g>
<!-- layer40_qkv_4 -->
<g id="node567" class="node">
<title>layer40_qkv_4</title>
<path fill="#e6f3ff" stroke="black" d="M349,-40575.47C349,-40575.47 51,-40575.47 51,-40575.47 45,-40575.47 39,-40569.47 39,-40563.47 39,-40563.47 39,-40540.47 39,-40540.47 39,-40534.47 45,-40528.47 51,-40528.47 51,-40528.47 349,-40528.47 349,-40528.47 355,-40528.47 361,-40534.47 361,-40540.47 361,-40540.47 361,-40563.47 361,-40563.47 361,-40569.47 355,-40575.47 349,-40575.47"/>
<text text-anchor="middle" x="200" y="-40560.47" font-family="Arial" font-size="10.00">Layer 40 QKV Proj GPU4</text>
<text text-anchor="middle" x="200" y="-40549.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="200" y="-40538.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- stage1_to_stage2&#45;&gt;layer40_qkv_4 -->
<g id="edge647" class="edge">
<title>stage1_to_stage2&#45;&gt;layer40_qkv_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M320.39,-40647.46C293.03,-40625.99 261.27,-40601.06 237.25,-40582.21"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="239.12,-40579.23 229.1,-40575.81 234.8,-40584.73 239.12,-40579.23"/>
</g>
<!-- layer40_qkv_5 -->
<g id="node568" class="node">
<title>layer40_qkv_5</title>
<path fill="#e6f3ff" stroke="black" d="M707,-40575.47C707,-40575.47 409,-40575.47 409,-40575.47 403,-40575.47 397,-40569.47 397,-40563.47 397,-40563.47 397,-40540.47 397,-40540.47 397,-40534.47 403,-40528.47 409,-40528.47 409,-40528.47 707,-40528.47 707,-40528.47 713,-40528.47 719,-40534.47 719,-40540.47 719,-40540.47 719,-40563.47 719,-40563.47 719,-40569.47 713,-40575.47 707,-40575.47"/>
<text text-anchor="middle" x="558" y="-40560.47" font-family="Arial" font-size="10.00">Layer 40 QKV Proj GPU5</text>
<text text-anchor="middle" x="558" y="-40549.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="558" y="-40538.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- stage1_to_stage2&#45;&gt;layer40_qkv_5 -->
<g id="edge648" class="edge">
<title>stage1_to_stage2&#45;&gt;layer40_qkv_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M437.61,-40647.46C464.97,-40625.99 496.73,-40601.06 520.75,-40582.21"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="523.2,-40584.73 528.9,-40575.81 518.88,-40579.23 523.2,-40584.73"/>
</g>
<!-- layer40_attn_4 -->
<g id="node569" class="node">
<title>layer40_attn_4</title>
<path fill="#e6f3ff" stroke="black" d="M349,-40456.47C349,-40456.47 51,-40456.47 51,-40456.47 45,-40456.47 39,-40450.47 39,-40444.47 39,-40444.47 39,-40421.47 39,-40421.47 39,-40415.47 45,-40409.47 51,-40409.47 51,-40409.47 349,-40409.47 349,-40409.47 355,-40409.47 361,-40415.47 361,-40421.47 361,-40421.47 361,-40444.47 361,-40444.47 361,-40450.47 355,-40456.47 349,-40456.47"/>
<text text-anchor="middle" x="200" y="-40441.47" font-family="Arial" font-size="10.00">Layer 40 Attention GPU4</text>
<text text-anchor="middle" x="200" y="-40430.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="200" y="-40419.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer40_qkv_4&#45;&gt;layer40_attn_4 -->
<g id="edge649" class="edge">
<title>layer40_qkv_4&#45;&gt;layer40_attn_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M200,-40528.41C200,-40510.96 200,-40486.55 200,-40466.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="203.5,-40466.86 200,-40456.86 196.5,-40466.86 203.5,-40466.86"/>
</g>
<!-- layer40_attn_5 -->
<g id="node570" class="node">
<title>layer40_attn_5</title>
<path fill="#e6f3ff" stroke="black" d="M707,-40456.47C707,-40456.47 409,-40456.47 409,-40456.47 403,-40456.47 397,-40450.47 397,-40444.47 397,-40444.47 397,-40421.47 397,-40421.47 397,-40415.47 403,-40409.47 409,-40409.47 409,-40409.47 707,-40409.47 707,-40409.47 713,-40409.47 719,-40415.47 719,-40421.47 719,-40421.47 719,-40444.47 719,-40444.47 719,-40450.47 713,-40456.47 707,-40456.47"/>
<text text-anchor="middle" x="558" y="-40441.47" font-family="Arial" font-size="10.00">Layer 40 Attention GPU5</text>
<text text-anchor="middle" x="558" y="-40430.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="558" y="-40419.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer40_qkv_5&#45;&gt;layer40_attn_5 -->
<g id="edge650" class="edge">
<title>layer40_qkv_5&#45;&gt;layer40_attn_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M558,-40528.41C558,-40510.96 558,-40486.55 558,-40466.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="561.5,-40466.86 558,-40456.86 554.5,-40466.86 561.5,-40466.86"/>
</g>
<!-- layer40_attn_out_4 -->
<g id="node571" class="node">
<title>layer40_attn_out_4</title>
<path fill="#e6f3ff" stroke="black" d="M349,-40337.47C349,-40337.47 59,-40337.47 59,-40337.47 53,-40337.47 47,-40331.47 47,-40325.47 47,-40325.47 47,-40302.47 47,-40302.47 47,-40296.47 53,-40290.47 59,-40290.47 59,-40290.47 349,-40290.47 349,-40290.47 355,-40290.47 361,-40296.47 361,-40302.47 361,-40302.47 361,-40325.47 361,-40325.47 361,-40331.47 355,-40337.47 349,-40337.47"/>
<text text-anchor="middle" x="204" y="-40322.47" font-family="Arial" font-size="10.00">Layer 40 Attn Out GPU4</text>
<text text-anchor="middle" x="204" y="-40311.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="204" y="-40300.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer40_attn_4&#45;&gt;layer40_attn_out_4 -->
<g id="edge651" class="edge">
<title>layer40_attn_4&#45;&gt;layer40_attn_out_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M200.77,-40409.41C201.37,-40391.96 202.2,-40367.55 202.87,-40347.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="206.37,-40347.97 203.22,-40337.86 199.38,-40347.73 206.37,-40347.97"/>
</g>
<!-- layer40_attn_out_5 -->
<g id="node572" class="node">
<title>layer40_attn_out_5</title>
<path fill="#e6f3ff" stroke="black" d="M701,-40337.47C701,-40337.47 411,-40337.47 411,-40337.47 405,-40337.47 399,-40331.47 399,-40325.47 399,-40325.47 399,-40302.47 399,-40302.47 399,-40296.47 405,-40290.47 411,-40290.47 411,-40290.47 701,-40290.47 701,-40290.47 707,-40290.47 713,-40296.47 713,-40302.47 713,-40302.47 713,-40325.47 713,-40325.47 713,-40331.47 707,-40337.47 701,-40337.47"/>
<text text-anchor="middle" x="556" y="-40322.47" font-family="Arial" font-size="10.00">Layer 40 Attn Out GPU5</text>
<text text-anchor="middle" x="556" y="-40311.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="556" y="-40300.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer40_attn_5&#45;&gt;layer40_attn_out_5 -->
<g id="edge652" class="edge">
<title>layer40_attn_5&#45;&gt;layer40_attn_out_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M557.61,-40409.41C557.32,-40391.96 556.9,-40367.55 556.56,-40347.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="560.06,-40347.8 556.39,-40337.86 553.06,-40347.92 560.06,-40347.8"/>
</g>
<!-- layer40_attn_ar -->
<g id="node573" class="node">
<title>layer40_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M509.07,-40218.47C509.07,-40218.47 307.07,-40218.47 307.07,-40218.47 301.07,-40218.47 291.3,-40213.8 287.53,-40209.13 287.53,-40209.13 244.47,-40155.8 244.47,-40155.8 240.7,-40151.14 242.93,-40146.47 248.93,-40146.47 248.93,-40146.47 450.93,-40146.47 450.93,-40146.47 456.93,-40146.47 466.7,-40151.14 470.47,-40155.8 470.47,-40155.8 513.53,-40209.13 513.53,-40209.13 517.3,-40213.8 515.07,-40218.47 509.07,-40218.47"/>
<text text-anchor="middle" x="379" y="-40185.47" font-family="Arial" font-size="10.00">Layer 40 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="379" y="-40174.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer40_attn_out_4&#45;&gt;layer40_attn_ar -->
<g id="edge653" class="edge">
<title>layer40_attn_out_4&#45;&gt;layer40_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M234.48,-40290.41C258.92,-40272.33 293.86,-40246.47 323.27,-40224.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="325.45,-40227.45 331.4,-40218.69 321.28,-40221.82 325.45,-40227.45"/>
</g>
<!-- layer40_attn_out_5&#45;&gt;layer40_attn_ar -->
<g id="edge654" class="edge">
<title>layer40_attn_out_5&#45;&gt;layer40_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M525.17,-40290.41C500.45,-40272.33 465.11,-40246.47 435.37,-40224.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="437.28,-40221.77 427.14,-40218.69 433.14,-40227.42 437.28,-40221.77"/>
</g>
<!-- layer40_ffn1_4 -->
<g id="node574" class="node">
<title>layer40_ffn1_4</title>
<path fill="#e6f3ff" stroke="black" d="M349,-40074.47C349,-40074.47 79,-40074.47 79,-40074.47 73,-40074.47 67,-40068.47 67,-40062.47 67,-40062.47 67,-40039.47 67,-40039.47 67,-40033.47 73,-40027.47 79,-40027.47 79,-40027.47 349,-40027.47 349,-40027.47 355,-40027.47 361,-40033.47 361,-40039.47 361,-40039.47 361,-40062.47 361,-40062.47 361,-40068.47 355,-40074.47 349,-40074.47"/>
<text text-anchor="middle" x="214" y="-40059.47" font-family="Arial" font-size="10.00">Layer 40 FFN1 GPU4</text>
<text text-anchor="middle" x="214" y="-40048.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="214" y="-40037.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer40_attn_ar&#45;&gt;layer40_ffn1_4 -->
<g id="edge655" class="edge">
<title>layer40_attn_ar&#45;&gt;layer40_ffn1_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M334.35,-40146.42C308.28,-40125.96 275.78,-40100.45 251.12,-40081.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="253.11,-40078.21 243.08,-40074.79 248.79,-40083.72 253.11,-40078.21"/>
</g>
<!-- layer40_ffn1_5 -->
<g id="node575" class="node">
<title>layer40_ffn1_5</title>
<path fill="#e6f3ff" stroke="black" d="M679,-40074.47C679,-40074.47 409,-40074.47 409,-40074.47 403,-40074.47 397,-40068.47 397,-40062.47 397,-40062.47 397,-40039.47 397,-40039.47 397,-40033.47 403,-40027.47 409,-40027.47 409,-40027.47 679,-40027.47 679,-40027.47 685,-40027.47 691,-40033.47 691,-40039.47 691,-40039.47 691,-40062.47 691,-40062.47 691,-40068.47 685,-40074.47 679,-40074.47"/>
<text text-anchor="middle" x="544" y="-40059.47" font-family="Arial" font-size="10.00">Layer 40 FFN1 GPU5</text>
<text text-anchor="middle" x="544" y="-40048.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="544" y="-40037.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer40_attn_ar&#45;&gt;layer40_ffn1_5 -->
<g id="edge656" class="edge">
<title>layer40_attn_ar&#45;&gt;layer40_ffn1_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M423.65,-40146.42C449.72,-40125.96 482.22,-40100.45 506.88,-40081.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="509.21,-40083.72 514.92,-40074.79 504.89,-40078.21 509.21,-40083.72"/>
</g>
<!-- layer40_act_4 -->
<g id="node576" class="node">
<title>layer40_act_4</title>
<path fill="#e6f3ff" stroke="black" d="M349,-39955.47C349,-39955.47 79,-39955.47 79,-39955.47 73,-39955.47 67,-39949.47 67,-39943.47 67,-39943.47 67,-39920.47 67,-39920.47 67,-39914.47 73,-39908.47 79,-39908.47 79,-39908.47 349,-39908.47 349,-39908.47 355,-39908.47 361,-39914.47 361,-39920.47 361,-39920.47 361,-39943.47 361,-39943.47 361,-39949.47 355,-39955.47 349,-39955.47"/>
<text text-anchor="middle" x="214" y="-39940.47" font-family="Arial" font-size="10.00">Layer 40 SiLU GPU4</text>
<text text-anchor="middle" x="214" y="-39929.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="214" y="-39918.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer40_ffn1_4&#45;&gt;layer40_act_4 -->
<g id="edge657" class="edge">
<title>layer40_ffn1_4&#45;&gt;layer40_act_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M214,-40027.41C214,-40009.96 214,-39985.55 214,-39965.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="217.5,-39965.86 214,-39955.86 210.5,-39965.86 217.5,-39965.86"/>
</g>
<!-- layer40_act_5 -->
<g id="node577" class="node">
<title>layer40_act_5</title>
<path fill="#e6f3ff" stroke="black" d="M679,-39955.47C679,-39955.47 409,-39955.47 409,-39955.47 403,-39955.47 397,-39949.47 397,-39943.47 397,-39943.47 397,-39920.47 397,-39920.47 397,-39914.47 403,-39908.47 409,-39908.47 409,-39908.47 679,-39908.47 679,-39908.47 685,-39908.47 691,-39914.47 691,-39920.47 691,-39920.47 691,-39943.47 691,-39943.47 691,-39949.47 685,-39955.47 679,-39955.47"/>
<text text-anchor="middle" x="544" y="-39940.47" font-family="Arial" font-size="10.00">Layer 40 SiLU GPU5</text>
<text text-anchor="middle" x="544" y="-39929.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="544" y="-39918.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer40_ffn1_5&#45;&gt;layer40_act_5 -->
<g id="edge658" class="edge">
<title>layer40_ffn1_5&#45;&gt;layer40_act_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M544,-40027.41C544,-40009.96 544,-39985.55 544,-39965.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="547.5,-39965.86 544,-39955.86 540.5,-39965.86 547.5,-39965.86"/>
</g>
<!-- layer40_ffn2_4 -->
<g id="node578" class="node">
<title>layer40_ffn2_4</title>
<path fill="#e6f3ff" stroke="black" d="M348.5,-39836.47C348.5,-39836.47 85.5,-39836.47 85.5,-39836.47 79.5,-39836.47 73.5,-39830.47 73.5,-39824.47 73.5,-39824.47 73.5,-39801.47 73.5,-39801.47 73.5,-39795.47 79.5,-39789.47 85.5,-39789.47 85.5,-39789.47 348.5,-39789.47 348.5,-39789.47 354.5,-39789.47 360.5,-39795.47 360.5,-39801.47 360.5,-39801.47 360.5,-39824.47 360.5,-39824.47 360.5,-39830.47 354.5,-39836.47 348.5,-39836.47"/>
<text text-anchor="middle" x="217" y="-39821.47" font-family="Arial" font-size="10.00">Layer 40 FFN2 GPU4</text>
<text text-anchor="middle" x="217" y="-39810.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="217" y="-39799.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer40_act_4&#45;&gt;layer40_ffn2_4 -->
<g id="edge659" class="edge">
<title>layer40_act_4&#45;&gt;layer40_ffn2_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M214.58,-39908.41C215.03,-39890.96 215.65,-39866.55 216.16,-39846.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="219.66,-39846.94 216.41,-39836.86 212.66,-39846.76 219.66,-39846.94"/>
</g>
<!-- layer40_ffn2_5 -->
<g id="node579" class="node">
<title>layer40_ffn2_5</title>
<path fill="#e6f3ff" stroke="black" d="M673.5,-39836.47C673.5,-39836.47 410.5,-39836.47 410.5,-39836.47 404.5,-39836.47 398.5,-39830.47 398.5,-39824.47 398.5,-39824.47 398.5,-39801.47 398.5,-39801.47 398.5,-39795.47 404.5,-39789.47 410.5,-39789.47 410.5,-39789.47 673.5,-39789.47 673.5,-39789.47 679.5,-39789.47 685.5,-39795.47 685.5,-39801.47 685.5,-39801.47 685.5,-39824.47 685.5,-39824.47 685.5,-39830.47 679.5,-39836.47 673.5,-39836.47"/>
<text text-anchor="middle" x="542" y="-39821.47" font-family="Arial" font-size="10.00">Layer 40 FFN2 GPU5</text>
<text text-anchor="middle" x="542" y="-39810.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="542" y="-39799.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer40_act_5&#45;&gt;layer40_ffn2_5 -->
<g id="edge660" class="edge">
<title>layer40_act_5&#45;&gt;layer40_ffn2_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M543.61,-39908.41C543.32,-39890.96 542.9,-39866.55 542.56,-39846.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="546.06,-39846.8 542.39,-39836.86 539.06,-39846.92 546.06,-39846.8"/>
</g>
<!-- layer40_ffn_ar -->
<g id="node580" class="node">
<title>layer40_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M510.22,-39717.47C510.22,-39717.47 304.8,-39717.47 304.8,-39717.47 298.8,-39717.47 289,-39712.83 285.19,-39708.19 285.19,-39708.19 241.39,-39654.75 241.39,-39654.75 237.59,-39650.11 239.78,-39645.47 245.78,-39645.47 245.78,-39645.47 451.2,-39645.47 451.2,-39645.47 457.2,-39645.47 467,-39650.11 470.81,-39654.75 470.81,-39654.75 514.61,-39708.19 514.61,-39708.19 518.41,-39712.83 516.22,-39717.47 510.22,-39717.47"/>
<text text-anchor="middle" x="378" y="-39684.47" font-family="Arial" font-size="10.00">Layer 40 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="378" y="-39673.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer40_ffn2_4&#45;&gt;layer40_ffn_ar -->
<g id="edge661" class="edge">
<title>layer40_ffn2_4&#45;&gt;layer40_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M245.04,-39789.41C267.43,-39771.41 299.4,-39745.69 326.38,-39723.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="328.61,-39726.68 334.21,-39717.69 324.23,-39721.23 328.61,-39726.68"/>
</g>
<!-- layer40_ffn2_5&#45;&gt;layer40_ffn_ar -->
<g id="edge662" class="edge">
<title>layer40_ffn2_5&#45;&gt;layer40_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M513.43,-39789.41C490.63,-39771.41 458.06,-39745.69 430.58,-39723.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="432.62,-39721.14 422.6,-39717.69 428.28,-39726.63 432.62,-39721.14"/>
</g>
<!-- layer41_qkv_4 -->
<g id="node581" class="node">
<title>layer41_qkv_4</title>
<path fill="#e6f3ff" stroke="black" d="M348,-39573.47C348,-39573.47 50,-39573.47 50,-39573.47 44,-39573.47 38,-39567.47 38,-39561.47 38,-39561.47 38,-39538.47 38,-39538.47 38,-39532.47 44,-39526.47 50,-39526.47 50,-39526.47 348,-39526.47 348,-39526.47 354,-39526.47 360,-39532.47 360,-39538.47 360,-39538.47 360,-39561.47 360,-39561.47 360,-39567.47 354,-39573.47 348,-39573.47"/>
<text text-anchor="middle" x="199" y="-39558.47" font-family="Arial" font-size="10.00">Layer 41 QKV Proj GPU4</text>
<text text-anchor="middle" x="199" y="-39547.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="199" y="-39536.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer40_ffn_ar&#45;&gt;layer41_qkv_4 -->
<g id="edge663" class="edge">
<title>layer40_ffn_ar&#45;&gt;layer41_qkv_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M329.56,-39645.42C301.06,-39624.81 265.48,-39599.06 238.66,-39579.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="240.43,-39576.62 230.28,-39573.6 236.33,-39582.3 240.43,-39576.62"/>
</g>
<!-- layer41_qkv_5 -->
<g id="node582" class="node">
<title>layer41_qkv_5</title>
<path fill="#e6f3ff" stroke="black" d="M706,-39573.47C706,-39573.47 408,-39573.47 408,-39573.47 402,-39573.47 396,-39567.47 396,-39561.47 396,-39561.47 396,-39538.47 396,-39538.47 396,-39532.47 402,-39526.47 408,-39526.47 408,-39526.47 706,-39526.47 706,-39526.47 712,-39526.47 718,-39532.47 718,-39538.47 718,-39538.47 718,-39561.47 718,-39561.47 718,-39567.47 712,-39573.47 706,-39573.47"/>
<text text-anchor="middle" x="557" y="-39558.47" font-family="Arial" font-size="10.00">Layer 41 QKV Proj GPU5</text>
<text text-anchor="middle" x="557" y="-39547.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="557" y="-39536.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer40_ffn_ar&#45;&gt;layer41_qkv_5 -->
<g id="edge664" class="edge">
<title>layer40_ffn_ar&#45;&gt;layer41_qkv_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M426.44,-39645.42C454.94,-39624.81 490.52,-39599.06 517.34,-39579.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="519.67,-39582.3 525.72,-39573.6 515.57,-39576.62 519.67,-39582.3"/>
</g>
<!-- layer41_attn_4 -->
<g id="node583" class="node">
<title>layer41_attn_4</title>
<path fill="#e6f3ff" stroke="black" d="M348,-39454.47C348,-39454.47 50,-39454.47 50,-39454.47 44,-39454.47 38,-39448.47 38,-39442.47 38,-39442.47 38,-39419.47 38,-39419.47 38,-39413.47 44,-39407.47 50,-39407.47 50,-39407.47 348,-39407.47 348,-39407.47 354,-39407.47 360,-39413.47 360,-39419.47 360,-39419.47 360,-39442.47 360,-39442.47 360,-39448.47 354,-39454.47 348,-39454.47"/>
<text text-anchor="middle" x="199" y="-39439.47" font-family="Arial" font-size="10.00">Layer 41 Attention GPU4</text>
<text text-anchor="middle" x="199" y="-39428.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="199" y="-39417.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer41_qkv_4&#45;&gt;layer41_attn_4 -->
<g id="edge665" class="edge">
<title>layer41_qkv_4&#45;&gt;layer41_attn_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M199,-39526.41C199,-39508.96 199,-39484.55 199,-39464.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="202.5,-39464.86 199,-39454.86 195.5,-39464.86 202.5,-39464.86"/>
</g>
<!-- layer41_attn_5 -->
<g id="node584" class="node">
<title>layer41_attn_5</title>
<path fill="#e6f3ff" stroke="black" d="M706,-39454.47C706,-39454.47 408,-39454.47 408,-39454.47 402,-39454.47 396,-39448.47 396,-39442.47 396,-39442.47 396,-39419.47 396,-39419.47 396,-39413.47 402,-39407.47 408,-39407.47 408,-39407.47 706,-39407.47 706,-39407.47 712,-39407.47 718,-39413.47 718,-39419.47 718,-39419.47 718,-39442.47 718,-39442.47 718,-39448.47 712,-39454.47 706,-39454.47"/>
<text text-anchor="middle" x="557" y="-39439.47" font-family="Arial" font-size="10.00">Layer 41 Attention GPU5</text>
<text text-anchor="middle" x="557" y="-39428.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="557" y="-39417.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer41_qkv_5&#45;&gt;layer41_attn_5 -->
<g id="edge666" class="edge">
<title>layer41_qkv_5&#45;&gt;layer41_attn_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M557,-39526.41C557,-39508.96 557,-39484.55 557,-39464.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="560.5,-39464.86 557,-39454.86 553.5,-39464.86 560.5,-39464.86"/>
</g>
<!-- layer41_attn_out_4 -->
<g id="node585" class="node">
<title>layer41_attn_out_4</title>
<path fill="#e6f3ff" stroke="black" d="M348,-39335.47C348,-39335.47 58,-39335.47 58,-39335.47 52,-39335.47 46,-39329.47 46,-39323.47 46,-39323.47 46,-39300.47 46,-39300.47 46,-39294.47 52,-39288.47 58,-39288.47 58,-39288.47 348,-39288.47 348,-39288.47 354,-39288.47 360,-39294.47 360,-39300.47 360,-39300.47 360,-39323.47 360,-39323.47 360,-39329.47 354,-39335.47 348,-39335.47"/>
<text text-anchor="middle" x="203" y="-39320.47" font-family="Arial" font-size="10.00">Layer 41 Attn Out GPU4</text>
<text text-anchor="middle" x="203" y="-39309.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="203" y="-39298.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer41_attn_4&#45;&gt;layer41_attn_out_4 -->
<g id="edge667" class="edge">
<title>layer41_attn_4&#45;&gt;layer41_attn_out_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M199.77,-39407.41C200.37,-39389.96 201.2,-39365.55 201.87,-39345.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="205.37,-39345.97 202.22,-39335.86 198.38,-39345.73 205.37,-39345.97"/>
</g>
<!-- layer41_attn_out_5 -->
<g id="node586" class="node">
<title>layer41_attn_out_5</title>
<path fill="#e6f3ff" stroke="black" d="M700,-39335.47C700,-39335.47 410,-39335.47 410,-39335.47 404,-39335.47 398,-39329.47 398,-39323.47 398,-39323.47 398,-39300.47 398,-39300.47 398,-39294.47 404,-39288.47 410,-39288.47 410,-39288.47 700,-39288.47 700,-39288.47 706,-39288.47 712,-39294.47 712,-39300.47 712,-39300.47 712,-39323.47 712,-39323.47 712,-39329.47 706,-39335.47 700,-39335.47"/>
<text text-anchor="middle" x="555" y="-39320.47" font-family="Arial" font-size="10.00">Layer 41 Attn Out GPU5</text>
<text text-anchor="middle" x="555" y="-39309.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="555" y="-39298.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer41_attn_5&#45;&gt;layer41_attn_out_5 -->
<g id="edge668" class="edge">
<title>layer41_attn_5&#45;&gt;layer41_attn_out_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M556.61,-39407.41C556.32,-39389.96 555.9,-39365.55 555.56,-39345.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="559.06,-39345.8 555.39,-39335.86 552.06,-39345.92 559.06,-39345.8"/>
</g>
<!-- layer41_attn_ar -->
<g id="node587" class="node">
<title>layer41_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M508.07,-39216.47C508.07,-39216.47 306.07,-39216.47 306.07,-39216.47 300.07,-39216.47 290.3,-39211.8 286.53,-39207.13 286.53,-39207.13 243.47,-39153.8 243.47,-39153.8 239.7,-39149.14 241.93,-39144.47 247.93,-39144.47 247.93,-39144.47 449.93,-39144.47 449.93,-39144.47 455.93,-39144.47 465.7,-39149.14 469.47,-39153.8 469.47,-39153.8 512.53,-39207.13 512.53,-39207.13 516.3,-39211.8 514.07,-39216.47 508.07,-39216.47"/>
<text text-anchor="middle" x="378" y="-39183.47" font-family="Arial" font-size="10.00">Layer 41 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="378" y="-39172.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer41_attn_out_4&#45;&gt;layer41_attn_ar -->
<g id="edge669" class="edge">
<title>layer41_attn_out_4&#45;&gt;layer41_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M233.48,-39288.41C257.92,-39270.33 292.86,-39244.47 322.27,-39222.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="324.45,-39225.45 330.4,-39216.69 320.28,-39219.82 324.45,-39225.45"/>
</g>
<!-- layer41_attn_out_5&#45;&gt;layer41_attn_ar -->
<g id="edge670" class="edge">
<title>layer41_attn_out_5&#45;&gt;layer41_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M524.17,-39288.41C499.45,-39270.33 464.11,-39244.47 434.37,-39222.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="436.28,-39219.77 426.14,-39216.69 432.14,-39225.42 436.28,-39219.77"/>
</g>
<!-- layer41_ffn1_4 -->
<g id="node588" class="node">
<title>layer41_ffn1_4</title>
<path fill="#e6f3ff" stroke="black" d="M348,-39072.47C348,-39072.47 78,-39072.47 78,-39072.47 72,-39072.47 66,-39066.47 66,-39060.47 66,-39060.47 66,-39037.47 66,-39037.47 66,-39031.47 72,-39025.47 78,-39025.47 78,-39025.47 348,-39025.47 348,-39025.47 354,-39025.47 360,-39031.47 360,-39037.47 360,-39037.47 360,-39060.47 360,-39060.47 360,-39066.47 354,-39072.47 348,-39072.47"/>
<text text-anchor="middle" x="213" y="-39057.47" font-family="Arial" font-size="10.00">Layer 41 FFN1 GPU4</text>
<text text-anchor="middle" x="213" y="-39046.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="213" y="-39035.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer41_attn_ar&#45;&gt;layer41_ffn1_4 -->
<g id="edge671" class="edge">
<title>layer41_attn_ar&#45;&gt;layer41_ffn1_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M333.35,-39144.42C307.28,-39123.96 274.78,-39098.45 250.12,-39079.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="252.11,-39076.21 242.08,-39072.79 247.79,-39081.72 252.11,-39076.21"/>
</g>
<!-- layer41_ffn1_5 -->
<g id="node589" class="node">
<title>layer41_ffn1_5</title>
<path fill="#e6f3ff" stroke="black" d="M678,-39072.47C678,-39072.47 408,-39072.47 408,-39072.47 402,-39072.47 396,-39066.47 396,-39060.47 396,-39060.47 396,-39037.47 396,-39037.47 396,-39031.47 402,-39025.47 408,-39025.47 408,-39025.47 678,-39025.47 678,-39025.47 684,-39025.47 690,-39031.47 690,-39037.47 690,-39037.47 690,-39060.47 690,-39060.47 690,-39066.47 684,-39072.47 678,-39072.47"/>
<text text-anchor="middle" x="543" y="-39057.47" font-family="Arial" font-size="10.00">Layer 41 FFN1 GPU5</text>
<text text-anchor="middle" x="543" y="-39046.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="543" y="-39035.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer41_attn_ar&#45;&gt;layer41_ffn1_5 -->
<g id="edge672" class="edge">
<title>layer41_attn_ar&#45;&gt;layer41_ffn1_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M422.65,-39144.42C448.72,-39123.96 481.22,-39098.45 505.88,-39079.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="508.21,-39081.72 513.92,-39072.79 503.89,-39076.21 508.21,-39081.72"/>
</g>
<!-- layer41_act_4 -->
<g id="node590" class="node">
<title>layer41_act_4</title>
<path fill="#e6f3ff" stroke="black" d="M348,-38953.47C348,-38953.47 78,-38953.47 78,-38953.47 72,-38953.47 66,-38947.47 66,-38941.47 66,-38941.47 66,-38918.47 66,-38918.47 66,-38912.47 72,-38906.47 78,-38906.47 78,-38906.47 348,-38906.47 348,-38906.47 354,-38906.47 360,-38912.47 360,-38918.47 360,-38918.47 360,-38941.47 360,-38941.47 360,-38947.47 354,-38953.47 348,-38953.47"/>
<text text-anchor="middle" x="213" y="-38938.47" font-family="Arial" font-size="10.00">Layer 41 SiLU GPU4</text>
<text text-anchor="middle" x="213" y="-38927.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="213" y="-38916.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer41_ffn1_4&#45;&gt;layer41_act_4 -->
<g id="edge673" class="edge">
<title>layer41_ffn1_4&#45;&gt;layer41_act_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M213,-39025.41C213,-39007.96 213,-38983.55 213,-38963.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="216.5,-38963.86 213,-38953.86 209.5,-38963.86 216.5,-38963.86"/>
</g>
<!-- layer41_act_5 -->
<g id="node591" class="node">
<title>layer41_act_5</title>
<path fill="#e6f3ff" stroke="black" d="M678,-38953.47C678,-38953.47 408,-38953.47 408,-38953.47 402,-38953.47 396,-38947.47 396,-38941.47 396,-38941.47 396,-38918.47 396,-38918.47 396,-38912.47 402,-38906.47 408,-38906.47 408,-38906.47 678,-38906.47 678,-38906.47 684,-38906.47 690,-38912.47 690,-38918.47 690,-38918.47 690,-38941.47 690,-38941.47 690,-38947.47 684,-38953.47 678,-38953.47"/>
<text text-anchor="middle" x="543" y="-38938.47" font-family="Arial" font-size="10.00">Layer 41 SiLU GPU5</text>
<text text-anchor="middle" x="543" y="-38927.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="543" y="-38916.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer41_ffn1_5&#45;&gt;layer41_act_5 -->
<g id="edge674" class="edge">
<title>layer41_ffn1_5&#45;&gt;layer41_act_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M543,-39025.41C543,-39007.96 543,-38983.55 543,-38963.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="546.5,-38963.86 543,-38953.86 539.5,-38963.86 546.5,-38963.86"/>
</g>
<!-- layer41_ffn2_4 -->
<g id="node592" class="node">
<title>layer41_ffn2_4</title>
<path fill="#e6f3ff" stroke="black" d="M347.5,-38834.47C347.5,-38834.47 84.5,-38834.47 84.5,-38834.47 78.5,-38834.47 72.5,-38828.47 72.5,-38822.47 72.5,-38822.47 72.5,-38799.47 72.5,-38799.47 72.5,-38793.47 78.5,-38787.47 84.5,-38787.47 84.5,-38787.47 347.5,-38787.47 347.5,-38787.47 353.5,-38787.47 359.5,-38793.47 359.5,-38799.47 359.5,-38799.47 359.5,-38822.47 359.5,-38822.47 359.5,-38828.47 353.5,-38834.47 347.5,-38834.47"/>
<text text-anchor="middle" x="216" y="-38819.47" font-family="Arial" font-size="10.00">Layer 41 FFN2 GPU4</text>
<text text-anchor="middle" x="216" y="-38808.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="216" y="-38797.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer41_act_4&#45;&gt;layer41_ffn2_4 -->
<g id="edge675" class="edge">
<title>layer41_act_4&#45;&gt;layer41_ffn2_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M213.58,-38906.41C214.03,-38888.96 214.65,-38864.55 215.16,-38844.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="218.66,-38844.94 215.41,-38834.86 211.66,-38844.76 218.66,-38844.94"/>
</g>
<!-- layer41_ffn2_5 -->
<g id="node593" class="node">
<title>layer41_ffn2_5</title>
<path fill="#e6f3ff" stroke="black" d="M672.5,-38834.47C672.5,-38834.47 409.5,-38834.47 409.5,-38834.47 403.5,-38834.47 397.5,-38828.47 397.5,-38822.47 397.5,-38822.47 397.5,-38799.47 397.5,-38799.47 397.5,-38793.47 403.5,-38787.47 409.5,-38787.47 409.5,-38787.47 672.5,-38787.47 672.5,-38787.47 678.5,-38787.47 684.5,-38793.47 684.5,-38799.47 684.5,-38799.47 684.5,-38822.47 684.5,-38822.47 684.5,-38828.47 678.5,-38834.47 672.5,-38834.47"/>
<text text-anchor="middle" x="541" y="-38819.47" font-family="Arial" font-size="10.00">Layer 41 FFN2 GPU5</text>
<text text-anchor="middle" x="541" y="-38808.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="541" y="-38797.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer41_act_5&#45;&gt;layer41_ffn2_5 -->
<g id="edge676" class="edge">
<title>layer41_act_5&#45;&gt;layer41_ffn2_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M542.61,-38906.41C542.32,-38888.96 541.9,-38864.55 541.56,-38844.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="545.06,-38844.8 541.39,-38834.86 538.06,-38844.92 545.06,-38844.8"/>
</g>
<!-- layer41_ffn_ar -->
<g id="node594" class="node">
<title>layer41_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M509.22,-38715.47C509.22,-38715.47 303.8,-38715.47 303.8,-38715.47 297.8,-38715.47 288,-38710.83 284.19,-38706.19 284.19,-38706.19 240.39,-38652.75 240.39,-38652.75 236.59,-38648.11 238.78,-38643.47 244.78,-38643.47 244.78,-38643.47 450.2,-38643.47 450.2,-38643.47 456.2,-38643.47 466,-38648.11 469.81,-38652.75 469.81,-38652.75 513.61,-38706.19 513.61,-38706.19 517.41,-38710.83 515.22,-38715.47 509.22,-38715.47"/>
<text text-anchor="middle" x="377" y="-38682.47" font-family="Arial" font-size="10.00">Layer 41 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="377" y="-38671.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer41_ffn2_4&#45;&gt;layer41_ffn_ar -->
<g id="edge677" class="edge">
<title>layer41_ffn2_4&#45;&gt;layer41_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M244.04,-38787.41C266.43,-38769.41 298.4,-38743.69 325.38,-38721.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="327.61,-38724.68 333.21,-38715.69 323.23,-38719.23 327.61,-38724.68"/>
</g>
<!-- layer41_ffn2_5&#45;&gt;layer41_ffn_ar -->
<g id="edge678" class="edge">
<title>layer41_ffn2_5&#45;&gt;layer41_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M512.43,-38787.41C489.63,-38769.41 457.06,-38743.69 429.58,-38721.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="431.62,-38719.14 421.6,-38715.69 427.28,-38724.63 431.62,-38719.14"/>
</g>
<!-- layer42_qkv_4 -->
<g id="node595" class="node">
<title>layer42_qkv_4</title>
<path fill="#e6f3ff" stroke="black" d="M347,-38571.47C347,-38571.47 49,-38571.47 49,-38571.47 43,-38571.47 37,-38565.47 37,-38559.47 37,-38559.47 37,-38536.47 37,-38536.47 37,-38530.47 43,-38524.47 49,-38524.47 49,-38524.47 347,-38524.47 347,-38524.47 353,-38524.47 359,-38530.47 359,-38536.47 359,-38536.47 359,-38559.47 359,-38559.47 359,-38565.47 353,-38571.47 347,-38571.47"/>
<text text-anchor="middle" x="198" y="-38556.47" font-family="Arial" font-size="10.00">Layer 42 QKV Proj GPU4</text>
<text text-anchor="middle" x="198" y="-38545.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="198" y="-38534.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer41_ffn_ar&#45;&gt;layer42_qkv_4 -->
<g id="edge679" class="edge">
<title>layer41_ffn_ar&#45;&gt;layer42_qkv_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M328.56,-38643.42C300.06,-38622.81 264.48,-38597.06 237.66,-38577.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="239.43,-38574.62 229.28,-38571.6 235.33,-38580.3 239.43,-38574.62"/>
</g>
<!-- layer42_qkv_5 -->
<g id="node596" class="node">
<title>layer42_qkv_5</title>
<path fill="#e6f3ff" stroke="black" d="M705,-38571.47C705,-38571.47 407,-38571.47 407,-38571.47 401,-38571.47 395,-38565.47 395,-38559.47 395,-38559.47 395,-38536.47 395,-38536.47 395,-38530.47 401,-38524.47 407,-38524.47 407,-38524.47 705,-38524.47 705,-38524.47 711,-38524.47 717,-38530.47 717,-38536.47 717,-38536.47 717,-38559.47 717,-38559.47 717,-38565.47 711,-38571.47 705,-38571.47"/>
<text text-anchor="middle" x="556" y="-38556.47" font-family="Arial" font-size="10.00">Layer 42 QKV Proj GPU5</text>
<text text-anchor="middle" x="556" y="-38545.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="556" y="-38534.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer41_ffn_ar&#45;&gt;layer42_qkv_5 -->
<g id="edge680" class="edge">
<title>layer41_ffn_ar&#45;&gt;layer42_qkv_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M425.44,-38643.42C453.94,-38622.81 489.52,-38597.06 516.34,-38577.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="518.67,-38580.3 524.72,-38571.6 514.57,-38574.62 518.67,-38580.3"/>
</g>
<!-- layer42_attn_4 -->
<g id="node597" class="node">
<title>layer42_attn_4</title>
<path fill="#e6f3ff" stroke="black" d="M347,-38452.47C347,-38452.47 49,-38452.47 49,-38452.47 43,-38452.47 37,-38446.47 37,-38440.47 37,-38440.47 37,-38417.47 37,-38417.47 37,-38411.47 43,-38405.47 49,-38405.47 49,-38405.47 347,-38405.47 347,-38405.47 353,-38405.47 359,-38411.47 359,-38417.47 359,-38417.47 359,-38440.47 359,-38440.47 359,-38446.47 353,-38452.47 347,-38452.47"/>
<text text-anchor="middle" x="198" y="-38437.47" font-family="Arial" font-size="10.00">Layer 42 Attention GPU4</text>
<text text-anchor="middle" x="198" y="-38426.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="198" y="-38415.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer42_qkv_4&#45;&gt;layer42_attn_4 -->
<g id="edge681" class="edge">
<title>layer42_qkv_4&#45;&gt;layer42_attn_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M198,-38524.41C198,-38506.96 198,-38482.55 198,-38462.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="201.5,-38462.86 198,-38452.86 194.5,-38462.86 201.5,-38462.86"/>
</g>
<!-- layer42_attn_5 -->
<g id="node598" class="node">
<title>layer42_attn_5</title>
<path fill="#e6f3ff" stroke="black" d="M705,-38452.47C705,-38452.47 407,-38452.47 407,-38452.47 401,-38452.47 395,-38446.47 395,-38440.47 395,-38440.47 395,-38417.47 395,-38417.47 395,-38411.47 401,-38405.47 407,-38405.47 407,-38405.47 705,-38405.47 705,-38405.47 711,-38405.47 717,-38411.47 717,-38417.47 717,-38417.47 717,-38440.47 717,-38440.47 717,-38446.47 711,-38452.47 705,-38452.47"/>
<text text-anchor="middle" x="556" y="-38437.47" font-family="Arial" font-size="10.00">Layer 42 Attention GPU5</text>
<text text-anchor="middle" x="556" y="-38426.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="556" y="-38415.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer42_qkv_5&#45;&gt;layer42_attn_5 -->
<g id="edge682" class="edge">
<title>layer42_qkv_5&#45;&gt;layer42_attn_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M556,-38524.41C556,-38506.96 556,-38482.55 556,-38462.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="559.5,-38462.86 556,-38452.86 552.5,-38462.86 559.5,-38462.86"/>
</g>
<!-- layer42_attn_out_4 -->
<g id="node599" class="node">
<title>layer42_attn_out_4</title>
<path fill="#e6f3ff" stroke="black" d="M347,-38333.47C347,-38333.47 57,-38333.47 57,-38333.47 51,-38333.47 45,-38327.47 45,-38321.47 45,-38321.47 45,-38298.47 45,-38298.47 45,-38292.47 51,-38286.47 57,-38286.47 57,-38286.47 347,-38286.47 347,-38286.47 353,-38286.47 359,-38292.47 359,-38298.47 359,-38298.47 359,-38321.47 359,-38321.47 359,-38327.47 353,-38333.47 347,-38333.47"/>
<text text-anchor="middle" x="202" y="-38318.47" font-family="Arial" font-size="10.00">Layer 42 Attn Out GPU4</text>
<text text-anchor="middle" x="202" y="-38307.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="202" y="-38296.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer42_attn_4&#45;&gt;layer42_attn_out_4 -->
<g id="edge683" class="edge">
<title>layer42_attn_4&#45;&gt;layer42_attn_out_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M198.77,-38405.41C199.37,-38387.96 200.2,-38363.55 200.87,-38343.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="204.37,-38343.97 201.22,-38333.86 197.38,-38343.73 204.37,-38343.97"/>
</g>
<!-- layer42_attn_out_5 -->
<g id="node600" class="node">
<title>layer42_attn_out_5</title>
<path fill="#e6f3ff" stroke="black" d="M699,-38333.47C699,-38333.47 409,-38333.47 409,-38333.47 403,-38333.47 397,-38327.47 397,-38321.47 397,-38321.47 397,-38298.47 397,-38298.47 397,-38292.47 403,-38286.47 409,-38286.47 409,-38286.47 699,-38286.47 699,-38286.47 705,-38286.47 711,-38292.47 711,-38298.47 711,-38298.47 711,-38321.47 711,-38321.47 711,-38327.47 705,-38333.47 699,-38333.47"/>
<text text-anchor="middle" x="554" y="-38318.47" font-family="Arial" font-size="10.00">Layer 42 Attn Out GPU5</text>
<text text-anchor="middle" x="554" y="-38307.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="554" y="-38296.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer42_attn_5&#45;&gt;layer42_attn_out_5 -->
<g id="edge684" class="edge">
<title>layer42_attn_5&#45;&gt;layer42_attn_out_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M555.61,-38405.41C555.32,-38387.96 554.9,-38363.55 554.56,-38343.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="558.06,-38343.8 554.39,-38333.86 551.06,-38343.92 558.06,-38343.8"/>
</g>
<!-- layer42_attn_ar -->
<g id="node601" class="node">
<title>layer42_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M507.07,-38214.47C507.07,-38214.47 305.07,-38214.47 305.07,-38214.47 299.07,-38214.47 289.3,-38209.8 285.53,-38205.13 285.53,-38205.13 242.47,-38151.8 242.47,-38151.8 238.7,-38147.14 240.93,-38142.47 246.93,-38142.47 246.93,-38142.47 448.93,-38142.47 448.93,-38142.47 454.93,-38142.47 464.7,-38147.14 468.47,-38151.8 468.47,-38151.8 511.53,-38205.13 511.53,-38205.13 515.3,-38209.8 513.07,-38214.47 507.07,-38214.47"/>
<text text-anchor="middle" x="377" y="-38181.47" font-family="Arial" font-size="10.00">Layer 42 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="377" y="-38170.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer42_attn_out_4&#45;&gt;layer42_attn_ar -->
<g id="edge685" class="edge">
<title>layer42_attn_out_4&#45;&gt;layer42_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M232.48,-38286.41C256.92,-38268.33 291.86,-38242.47 321.27,-38220.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="323.45,-38223.45 329.4,-38214.69 319.28,-38217.82 323.45,-38223.45"/>
</g>
<!-- layer42_attn_out_5&#45;&gt;layer42_attn_ar -->
<g id="edge686" class="edge">
<title>layer42_attn_out_5&#45;&gt;layer42_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M523.17,-38286.41C498.45,-38268.33 463.11,-38242.47 433.37,-38220.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="435.28,-38217.77 425.14,-38214.69 431.14,-38223.42 435.28,-38217.77"/>
</g>
<!-- layer42_ffn1_4 -->
<g id="node602" class="node">
<title>layer42_ffn1_4</title>
<path fill="#e6f3ff" stroke="black" d="M347,-38070.47C347,-38070.47 77,-38070.47 77,-38070.47 71,-38070.47 65,-38064.47 65,-38058.47 65,-38058.47 65,-38035.47 65,-38035.47 65,-38029.47 71,-38023.47 77,-38023.47 77,-38023.47 347,-38023.47 347,-38023.47 353,-38023.47 359,-38029.47 359,-38035.47 359,-38035.47 359,-38058.47 359,-38058.47 359,-38064.47 353,-38070.47 347,-38070.47"/>
<text text-anchor="middle" x="212" y="-38055.47" font-family="Arial" font-size="10.00">Layer 42 FFN1 GPU4</text>
<text text-anchor="middle" x="212" y="-38044.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="212" y="-38033.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer42_attn_ar&#45;&gt;layer42_ffn1_4 -->
<g id="edge687" class="edge">
<title>layer42_attn_ar&#45;&gt;layer42_ffn1_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M332.35,-38142.42C306.28,-38121.96 273.78,-38096.45 249.12,-38077.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="251.11,-38074.21 241.08,-38070.79 246.79,-38079.72 251.11,-38074.21"/>
</g>
<!-- layer42_ffn1_5 -->
<g id="node603" class="node">
<title>layer42_ffn1_5</title>
<path fill="#e6f3ff" stroke="black" d="M677,-38070.47C677,-38070.47 407,-38070.47 407,-38070.47 401,-38070.47 395,-38064.47 395,-38058.47 395,-38058.47 395,-38035.47 395,-38035.47 395,-38029.47 401,-38023.47 407,-38023.47 407,-38023.47 677,-38023.47 677,-38023.47 683,-38023.47 689,-38029.47 689,-38035.47 689,-38035.47 689,-38058.47 689,-38058.47 689,-38064.47 683,-38070.47 677,-38070.47"/>
<text text-anchor="middle" x="542" y="-38055.47" font-family="Arial" font-size="10.00">Layer 42 FFN1 GPU5</text>
<text text-anchor="middle" x="542" y="-38044.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="542" y="-38033.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer42_attn_ar&#45;&gt;layer42_ffn1_5 -->
<g id="edge688" class="edge">
<title>layer42_attn_ar&#45;&gt;layer42_ffn1_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M421.65,-38142.42C447.72,-38121.96 480.22,-38096.45 504.88,-38077.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="507.21,-38079.72 512.92,-38070.79 502.89,-38074.21 507.21,-38079.72"/>
</g>
<!-- layer42_act_4 -->
<g id="node604" class="node">
<title>layer42_act_4</title>
<path fill="#e6f3ff" stroke="black" d="M347,-37951.47C347,-37951.47 77,-37951.47 77,-37951.47 71,-37951.47 65,-37945.47 65,-37939.47 65,-37939.47 65,-37916.47 65,-37916.47 65,-37910.47 71,-37904.47 77,-37904.47 77,-37904.47 347,-37904.47 347,-37904.47 353,-37904.47 359,-37910.47 359,-37916.47 359,-37916.47 359,-37939.47 359,-37939.47 359,-37945.47 353,-37951.47 347,-37951.47"/>
<text text-anchor="middle" x="212" y="-37936.47" font-family="Arial" font-size="10.00">Layer 42 SiLU GPU4</text>
<text text-anchor="middle" x="212" y="-37925.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="212" y="-37914.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer42_ffn1_4&#45;&gt;layer42_act_4 -->
<g id="edge689" class="edge">
<title>layer42_ffn1_4&#45;&gt;layer42_act_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M212,-38023.41C212,-38005.96 212,-37981.55 212,-37961.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="215.5,-37961.86 212,-37951.86 208.5,-37961.86 215.5,-37961.86"/>
</g>
<!-- layer42_act_5 -->
<g id="node605" class="node">
<title>layer42_act_5</title>
<path fill="#e6f3ff" stroke="black" d="M677,-37951.47C677,-37951.47 407,-37951.47 407,-37951.47 401,-37951.47 395,-37945.47 395,-37939.47 395,-37939.47 395,-37916.47 395,-37916.47 395,-37910.47 401,-37904.47 407,-37904.47 407,-37904.47 677,-37904.47 677,-37904.47 683,-37904.47 689,-37910.47 689,-37916.47 689,-37916.47 689,-37939.47 689,-37939.47 689,-37945.47 683,-37951.47 677,-37951.47"/>
<text text-anchor="middle" x="542" y="-37936.47" font-family="Arial" font-size="10.00">Layer 42 SiLU GPU5</text>
<text text-anchor="middle" x="542" y="-37925.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="542" y="-37914.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer42_ffn1_5&#45;&gt;layer42_act_5 -->
<g id="edge690" class="edge">
<title>layer42_ffn1_5&#45;&gt;layer42_act_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M542,-38023.41C542,-38005.96 542,-37981.55 542,-37961.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="545.5,-37961.86 542,-37951.86 538.5,-37961.86 545.5,-37961.86"/>
</g>
<!-- layer42_ffn2_4 -->
<g id="node606" class="node">
<title>layer42_ffn2_4</title>
<path fill="#e6f3ff" stroke="black" d="M346.5,-37832.47C346.5,-37832.47 83.5,-37832.47 83.5,-37832.47 77.5,-37832.47 71.5,-37826.47 71.5,-37820.47 71.5,-37820.47 71.5,-37797.47 71.5,-37797.47 71.5,-37791.47 77.5,-37785.47 83.5,-37785.47 83.5,-37785.47 346.5,-37785.47 346.5,-37785.47 352.5,-37785.47 358.5,-37791.47 358.5,-37797.47 358.5,-37797.47 358.5,-37820.47 358.5,-37820.47 358.5,-37826.47 352.5,-37832.47 346.5,-37832.47"/>
<text text-anchor="middle" x="215" y="-37817.47" font-family="Arial" font-size="10.00">Layer 42 FFN2 GPU4</text>
<text text-anchor="middle" x="215" y="-37806.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="215" y="-37795.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer42_act_4&#45;&gt;layer42_ffn2_4 -->
<g id="edge691" class="edge">
<title>layer42_act_4&#45;&gt;layer42_ffn2_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M212.58,-37904.41C213.03,-37886.96 213.65,-37862.55 214.16,-37842.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="217.66,-37842.94 214.41,-37832.86 210.66,-37842.76 217.66,-37842.94"/>
</g>
<!-- layer42_ffn2_5 -->
<g id="node607" class="node">
<title>layer42_ffn2_5</title>
<path fill="#e6f3ff" stroke="black" d="M671.5,-37832.47C671.5,-37832.47 408.5,-37832.47 408.5,-37832.47 402.5,-37832.47 396.5,-37826.47 396.5,-37820.47 396.5,-37820.47 396.5,-37797.47 396.5,-37797.47 396.5,-37791.47 402.5,-37785.47 408.5,-37785.47 408.5,-37785.47 671.5,-37785.47 671.5,-37785.47 677.5,-37785.47 683.5,-37791.47 683.5,-37797.47 683.5,-37797.47 683.5,-37820.47 683.5,-37820.47 683.5,-37826.47 677.5,-37832.47 671.5,-37832.47"/>
<text text-anchor="middle" x="540" y="-37817.47" font-family="Arial" font-size="10.00">Layer 42 FFN2 GPU5</text>
<text text-anchor="middle" x="540" y="-37806.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="540" y="-37795.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer42_act_5&#45;&gt;layer42_ffn2_5 -->
<g id="edge692" class="edge">
<title>layer42_act_5&#45;&gt;layer42_ffn2_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M541.61,-37904.41C541.32,-37886.96 540.9,-37862.55 540.56,-37842.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="544.06,-37842.8 540.39,-37832.86 537.06,-37842.92 544.06,-37842.8"/>
</g>
<!-- layer42_ffn_ar -->
<g id="node608" class="node">
<title>layer42_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M508.22,-37713.47C508.22,-37713.47 302.8,-37713.47 302.8,-37713.47 296.8,-37713.47 287,-37708.83 283.19,-37704.19 283.19,-37704.19 239.39,-37650.75 239.39,-37650.75 235.59,-37646.11 237.78,-37641.47 243.78,-37641.47 243.78,-37641.47 449.2,-37641.47 449.2,-37641.47 455.2,-37641.47 465,-37646.11 468.81,-37650.75 468.81,-37650.75 512.61,-37704.19 512.61,-37704.19 516.41,-37708.83 514.22,-37713.47 508.22,-37713.47"/>
<text text-anchor="middle" x="376" y="-37680.47" font-family="Arial" font-size="10.00">Layer 42 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="376" y="-37669.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer42_ffn2_4&#45;&gt;layer42_ffn_ar -->
<g id="edge693" class="edge">
<title>layer42_ffn2_4&#45;&gt;layer42_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M243.04,-37785.41C265.43,-37767.41 297.4,-37741.69 324.38,-37719.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="326.61,-37722.68 332.21,-37713.69 322.23,-37717.23 326.61,-37722.68"/>
</g>
<!-- layer42_ffn2_5&#45;&gt;layer42_ffn_ar -->
<g id="edge694" class="edge">
<title>layer42_ffn2_5&#45;&gt;layer42_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M511.43,-37785.41C488.63,-37767.41 456.06,-37741.69 428.58,-37719.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="430.62,-37717.14 420.6,-37713.69 426.28,-37722.63 430.62,-37717.14"/>
</g>
<!-- layer43_qkv_4 -->
<g id="node609" class="node">
<title>layer43_qkv_4</title>
<path fill="#e6f3ff" stroke="black" d="M346,-37569.47C346,-37569.47 48,-37569.47 48,-37569.47 42,-37569.47 36,-37563.47 36,-37557.47 36,-37557.47 36,-37534.47 36,-37534.47 36,-37528.47 42,-37522.47 48,-37522.47 48,-37522.47 346,-37522.47 346,-37522.47 352,-37522.47 358,-37528.47 358,-37534.47 358,-37534.47 358,-37557.47 358,-37557.47 358,-37563.47 352,-37569.47 346,-37569.47"/>
<text text-anchor="middle" x="197" y="-37554.47" font-family="Arial" font-size="10.00">Layer 43 QKV Proj GPU4</text>
<text text-anchor="middle" x="197" y="-37543.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="197" y="-37532.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer42_ffn_ar&#45;&gt;layer43_qkv_4 -->
<g id="edge695" class="edge">
<title>layer42_ffn_ar&#45;&gt;layer43_qkv_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M327.56,-37641.42C299.06,-37620.81 263.48,-37595.06 236.66,-37575.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="238.43,-37572.62 228.28,-37569.6 234.33,-37578.3 238.43,-37572.62"/>
</g>
<!-- layer43_qkv_5 -->
<g id="node610" class="node">
<title>layer43_qkv_5</title>
<path fill="#e6f3ff" stroke="black" d="M704,-37569.47C704,-37569.47 406,-37569.47 406,-37569.47 400,-37569.47 394,-37563.47 394,-37557.47 394,-37557.47 394,-37534.47 394,-37534.47 394,-37528.47 400,-37522.47 406,-37522.47 406,-37522.47 704,-37522.47 704,-37522.47 710,-37522.47 716,-37528.47 716,-37534.47 716,-37534.47 716,-37557.47 716,-37557.47 716,-37563.47 710,-37569.47 704,-37569.47"/>
<text text-anchor="middle" x="555" y="-37554.47" font-family="Arial" font-size="10.00">Layer 43 QKV Proj GPU5</text>
<text text-anchor="middle" x="555" y="-37543.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="555" y="-37532.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer42_ffn_ar&#45;&gt;layer43_qkv_5 -->
<g id="edge696" class="edge">
<title>layer42_ffn_ar&#45;&gt;layer43_qkv_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M424.44,-37641.42C452.94,-37620.81 488.52,-37595.06 515.34,-37575.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="517.67,-37578.3 523.72,-37569.6 513.57,-37572.62 517.67,-37578.3"/>
</g>
<!-- layer43_attn_4 -->
<g id="node611" class="node">
<title>layer43_attn_4</title>
<path fill="#e6f3ff" stroke="black" d="M346,-37450.47C346,-37450.47 48,-37450.47 48,-37450.47 42,-37450.47 36,-37444.47 36,-37438.47 36,-37438.47 36,-37415.47 36,-37415.47 36,-37409.47 42,-37403.47 48,-37403.47 48,-37403.47 346,-37403.47 346,-37403.47 352,-37403.47 358,-37409.47 358,-37415.47 358,-37415.47 358,-37438.47 358,-37438.47 358,-37444.47 352,-37450.47 346,-37450.47"/>
<text text-anchor="middle" x="197" y="-37435.47" font-family="Arial" font-size="10.00">Layer 43 Attention GPU4</text>
<text text-anchor="middle" x="197" y="-37424.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="197" y="-37413.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer43_qkv_4&#45;&gt;layer43_attn_4 -->
<g id="edge697" class="edge">
<title>layer43_qkv_4&#45;&gt;layer43_attn_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M197,-37522.41C197,-37504.96 197,-37480.55 197,-37460.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="200.5,-37460.86 197,-37450.86 193.5,-37460.86 200.5,-37460.86"/>
</g>
<!-- layer43_attn_5 -->
<g id="node612" class="node">
<title>layer43_attn_5</title>
<path fill="#e6f3ff" stroke="black" d="M704,-37450.47C704,-37450.47 406,-37450.47 406,-37450.47 400,-37450.47 394,-37444.47 394,-37438.47 394,-37438.47 394,-37415.47 394,-37415.47 394,-37409.47 400,-37403.47 406,-37403.47 406,-37403.47 704,-37403.47 704,-37403.47 710,-37403.47 716,-37409.47 716,-37415.47 716,-37415.47 716,-37438.47 716,-37438.47 716,-37444.47 710,-37450.47 704,-37450.47"/>
<text text-anchor="middle" x="555" y="-37435.47" font-family="Arial" font-size="10.00">Layer 43 Attention GPU5</text>
<text text-anchor="middle" x="555" y="-37424.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="555" y="-37413.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer43_qkv_5&#45;&gt;layer43_attn_5 -->
<g id="edge698" class="edge">
<title>layer43_qkv_5&#45;&gt;layer43_attn_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M555,-37522.41C555,-37504.96 555,-37480.55 555,-37460.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="558.5,-37460.86 555,-37450.86 551.5,-37460.86 558.5,-37460.86"/>
</g>
<!-- layer43_attn_out_4 -->
<g id="node613" class="node">
<title>layer43_attn_out_4</title>
<path fill="#e6f3ff" stroke="black" d="M346,-37331.47C346,-37331.47 56,-37331.47 56,-37331.47 50,-37331.47 44,-37325.47 44,-37319.47 44,-37319.47 44,-37296.47 44,-37296.47 44,-37290.47 50,-37284.47 56,-37284.47 56,-37284.47 346,-37284.47 346,-37284.47 352,-37284.47 358,-37290.47 358,-37296.47 358,-37296.47 358,-37319.47 358,-37319.47 358,-37325.47 352,-37331.47 346,-37331.47"/>
<text text-anchor="middle" x="201" y="-37316.47" font-family="Arial" font-size="10.00">Layer 43 Attn Out GPU4</text>
<text text-anchor="middle" x="201" y="-37305.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="201" y="-37294.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer43_attn_4&#45;&gt;layer43_attn_out_4 -->
<g id="edge699" class="edge">
<title>layer43_attn_4&#45;&gt;layer43_attn_out_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M197.77,-37403.41C198.37,-37385.96 199.2,-37361.55 199.87,-37341.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="203.37,-37341.97 200.22,-37331.86 196.38,-37341.73 203.37,-37341.97"/>
</g>
<!-- layer43_attn_out_5 -->
<g id="node614" class="node">
<title>layer43_attn_out_5</title>
<path fill="#e6f3ff" stroke="black" d="M698,-37331.47C698,-37331.47 408,-37331.47 408,-37331.47 402,-37331.47 396,-37325.47 396,-37319.47 396,-37319.47 396,-37296.47 396,-37296.47 396,-37290.47 402,-37284.47 408,-37284.47 408,-37284.47 698,-37284.47 698,-37284.47 704,-37284.47 710,-37290.47 710,-37296.47 710,-37296.47 710,-37319.47 710,-37319.47 710,-37325.47 704,-37331.47 698,-37331.47"/>
<text text-anchor="middle" x="553" y="-37316.47" font-family="Arial" font-size="10.00">Layer 43 Attn Out GPU5</text>
<text text-anchor="middle" x="553" y="-37305.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="553" y="-37294.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer43_attn_5&#45;&gt;layer43_attn_out_5 -->
<g id="edge700" class="edge">
<title>layer43_attn_5&#45;&gt;layer43_attn_out_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M554.61,-37403.41C554.32,-37385.96 553.9,-37361.55 553.56,-37341.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="557.06,-37341.8 553.39,-37331.86 550.06,-37341.92 557.06,-37341.8"/>
</g>
<!-- layer43_attn_ar -->
<g id="node615" class="node">
<title>layer43_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M506.07,-37212.47C506.07,-37212.47 304.07,-37212.47 304.07,-37212.47 298.07,-37212.47 288.3,-37207.8 284.53,-37203.13 284.53,-37203.13 241.47,-37149.8 241.47,-37149.8 237.7,-37145.14 239.93,-37140.47 245.93,-37140.47 245.93,-37140.47 447.93,-37140.47 447.93,-37140.47 453.93,-37140.47 463.7,-37145.14 467.47,-37149.8 467.47,-37149.8 510.53,-37203.13 510.53,-37203.13 514.3,-37207.8 512.07,-37212.47 506.07,-37212.47"/>
<text text-anchor="middle" x="376" y="-37179.47" font-family="Arial" font-size="10.00">Layer 43 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="376" y="-37168.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer43_attn_out_4&#45;&gt;layer43_attn_ar -->
<g id="edge701" class="edge">
<title>layer43_attn_out_4&#45;&gt;layer43_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M231.48,-37284.41C255.92,-37266.33 290.86,-37240.47 320.27,-37218.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="322.45,-37221.45 328.4,-37212.69 318.28,-37215.82 322.45,-37221.45"/>
</g>
<!-- layer43_attn_out_5&#45;&gt;layer43_attn_ar -->
<g id="edge702" class="edge">
<title>layer43_attn_out_5&#45;&gt;layer43_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M522.17,-37284.41C497.45,-37266.33 462.11,-37240.47 432.37,-37218.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="434.28,-37215.77 424.14,-37212.69 430.14,-37221.42 434.28,-37215.77"/>
</g>
<!-- layer43_ffn1_4 -->
<g id="node616" class="node">
<title>layer43_ffn1_4</title>
<path fill="#e6f3ff" stroke="black" d="M346,-37068.47C346,-37068.47 76,-37068.47 76,-37068.47 70,-37068.47 64,-37062.47 64,-37056.47 64,-37056.47 64,-37033.47 64,-37033.47 64,-37027.47 70,-37021.47 76,-37021.47 76,-37021.47 346,-37021.47 346,-37021.47 352,-37021.47 358,-37027.47 358,-37033.47 358,-37033.47 358,-37056.47 358,-37056.47 358,-37062.47 352,-37068.47 346,-37068.47"/>
<text text-anchor="middle" x="211" y="-37053.47" font-family="Arial" font-size="10.00">Layer 43 FFN1 GPU4</text>
<text text-anchor="middle" x="211" y="-37042.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="211" y="-37031.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer43_attn_ar&#45;&gt;layer43_ffn1_4 -->
<g id="edge703" class="edge">
<title>layer43_attn_ar&#45;&gt;layer43_ffn1_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M331.35,-37140.42C305.28,-37119.96 272.78,-37094.45 248.12,-37075.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="250.11,-37072.21 240.08,-37068.79 245.79,-37077.72 250.11,-37072.21"/>
</g>
<!-- layer43_ffn1_5 -->
<g id="node617" class="node">
<title>layer43_ffn1_5</title>
<path fill="#e6f3ff" stroke="black" d="M676,-37068.47C676,-37068.47 406,-37068.47 406,-37068.47 400,-37068.47 394,-37062.47 394,-37056.47 394,-37056.47 394,-37033.47 394,-37033.47 394,-37027.47 400,-37021.47 406,-37021.47 406,-37021.47 676,-37021.47 676,-37021.47 682,-37021.47 688,-37027.47 688,-37033.47 688,-37033.47 688,-37056.47 688,-37056.47 688,-37062.47 682,-37068.47 676,-37068.47"/>
<text text-anchor="middle" x="541" y="-37053.47" font-family="Arial" font-size="10.00">Layer 43 FFN1 GPU5</text>
<text text-anchor="middle" x="541" y="-37042.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="541" y="-37031.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer43_attn_ar&#45;&gt;layer43_ffn1_5 -->
<g id="edge704" class="edge">
<title>layer43_attn_ar&#45;&gt;layer43_ffn1_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M420.65,-37140.42C446.72,-37119.96 479.22,-37094.45 503.88,-37075.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="506.21,-37077.72 511.92,-37068.79 501.89,-37072.21 506.21,-37077.72"/>
</g>
<!-- layer43_act_4 -->
<g id="node618" class="node">
<title>layer43_act_4</title>
<path fill="#e6f3ff" stroke="black" d="M346,-36949.47C346,-36949.47 76,-36949.47 76,-36949.47 70,-36949.47 64,-36943.47 64,-36937.47 64,-36937.47 64,-36914.47 64,-36914.47 64,-36908.47 70,-36902.47 76,-36902.47 76,-36902.47 346,-36902.47 346,-36902.47 352,-36902.47 358,-36908.47 358,-36914.47 358,-36914.47 358,-36937.47 358,-36937.47 358,-36943.47 352,-36949.47 346,-36949.47"/>
<text text-anchor="middle" x="211" y="-36934.47" font-family="Arial" font-size="10.00">Layer 43 SiLU GPU4</text>
<text text-anchor="middle" x="211" y="-36923.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="211" y="-36912.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer43_ffn1_4&#45;&gt;layer43_act_4 -->
<g id="edge705" class="edge">
<title>layer43_ffn1_4&#45;&gt;layer43_act_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M211,-37021.41C211,-37003.96 211,-36979.55 211,-36959.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="214.5,-36959.86 211,-36949.86 207.5,-36959.86 214.5,-36959.86"/>
</g>
<!-- layer43_act_5 -->
<g id="node619" class="node">
<title>layer43_act_5</title>
<path fill="#e6f3ff" stroke="black" d="M676,-36949.47C676,-36949.47 406,-36949.47 406,-36949.47 400,-36949.47 394,-36943.47 394,-36937.47 394,-36937.47 394,-36914.47 394,-36914.47 394,-36908.47 400,-36902.47 406,-36902.47 406,-36902.47 676,-36902.47 676,-36902.47 682,-36902.47 688,-36908.47 688,-36914.47 688,-36914.47 688,-36937.47 688,-36937.47 688,-36943.47 682,-36949.47 676,-36949.47"/>
<text text-anchor="middle" x="541" y="-36934.47" font-family="Arial" font-size="10.00">Layer 43 SiLU GPU5</text>
<text text-anchor="middle" x="541" y="-36923.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="541" y="-36912.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer43_ffn1_5&#45;&gt;layer43_act_5 -->
<g id="edge706" class="edge">
<title>layer43_ffn1_5&#45;&gt;layer43_act_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M541,-37021.41C541,-37003.96 541,-36979.55 541,-36959.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="544.5,-36959.86 541,-36949.86 537.5,-36959.86 544.5,-36959.86"/>
</g>
<!-- layer43_ffn2_4 -->
<g id="node620" class="node">
<title>layer43_ffn2_4</title>
<path fill="#e6f3ff" stroke="black" d="M345.5,-36830.47C345.5,-36830.47 82.5,-36830.47 82.5,-36830.47 76.5,-36830.47 70.5,-36824.47 70.5,-36818.47 70.5,-36818.47 70.5,-36795.47 70.5,-36795.47 70.5,-36789.47 76.5,-36783.47 82.5,-36783.47 82.5,-36783.47 345.5,-36783.47 345.5,-36783.47 351.5,-36783.47 357.5,-36789.47 357.5,-36795.47 357.5,-36795.47 357.5,-36818.47 357.5,-36818.47 357.5,-36824.47 351.5,-36830.47 345.5,-36830.47"/>
<text text-anchor="middle" x="214" y="-36815.47" font-family="Arial" font-size="10.00">Layer 43 FFN2 GPU4</text>
<text text-anchor="middle" x="214" y="-36804.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="214" y="-36793.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer43_act_4&#45;&gt;layer43_ffn2_4 -->
<g id="edge707" class="edge">
<title>layer43_act_4&#45;&gt;layer43_ffn2_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M211.58,-36902.41C212.03,-36884.96 212.65,-36860.55 213.16,-36840.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="216.66,-36840.94 213.41,-36830.86 209.66,-36840.76 216.66,-36840.94"/>
</g>
<!-- layer43_ffn2_5 -->
<g id="node621" class="node">
<title>layer43_ffn2_5</title>
<path fill="#e6f3ff" stroke="black" d="M670.5,-36830.47C670.5,-36830.47 407.5,-36830.47 407.5,-36830.47 401.5,-36830.47 395.5,-36824.47 395.5,-36818.47 395.5,-36818.47 395.5,-36795.47 395.5,-36795.47 395.5,-36789.47 401.5,-36783.47 407.5,-36783.47 407.5,-36783.47 670.5,-36783.47 670.5,-36783.47 676.5,-36783.47 682.5,-36789.47 682.5,-36795.47 682.5,-36795.47 682.5,-36818.47 682.5,-36818.47 682.5,-36824.47 676.5,-36830.47 670.5,-36830.47"/>
<text text-anchor="middle" x="539" y="-36815.47" font-family="Arial" font-size="10.00">Layer 43 FFN2 GPU5</text>
<text text-anchor="middle" x="539" y="-36804.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="539" y="-36793.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer43_act_5&#45;&gt;layer43_ffn2_5 -->
<g id="edge708" class="edge">
<title>layer43_act_5&#45;&gt;layer43_ffn2_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M540.61,-36902.41C540.32,-36884.96 539.9,-36860.55 539.56,-36840.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="543.06,-36840.8 539.39,-36830.86 536.06,-36840.92 543.06,-36840.8"/>
</g>
<!-- layer43_ffn_ar -->
<g id="node622" class="node">
<title>layer43_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M507.22,-36711.47C507.22,-36711.47 301.8,-36711.47 301.8,-36711.47 295.8,-36711.47 286,-36706.83 282.19,-36702.19 282.19,-36702.19 238.39,-36648.75 238.39,-36648.75 234.59,-36644.11 236.78,-36639.47 242.78,-36639.47 242.78,-36639.47 448.2,-36639.47 448.2,-36639.47 454.2,-36639.47 464,-36644.11 467.81,-36648.75 467.81,-36648.75 511.61,-36702.19 511.61,-36702.19 515.41,-36706.83 513.22,-36711.47 507.22,-36711.47"/>
<text text-anchor="middle" x="375" y="-36678.47" font-family="Arial" font-size="10.00">Layer 43 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="375" y="-36667.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer43_ffn2_4&#45;&gt;layer43_ffn_ar -->
<g id="edge709" class="edge">
<title>layer43_ffn2_4&#45;&gt;layer43_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M242.04,-36783.41C264.43,-36765.41 296.4,-36739.69 323.38,-36717.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="325.61,-36720.68 331.21,-36711.69 321.23,-36715.23 325.61,-36720.68"/>
</g>
<!-- layer43_ffn2_5&#45;&gt;layer43_ffn_ar -->
<g id="edge710" class="edge">
<title>layer43_ffn2_5&#45;&gt;layer43_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M510.43,-36783.41C487.63,-36765.41 455.06,-36739.69 427.58,-36717.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="429.62,-36715.14 419.6,-36711.69 425.28,-36720.63 429.62,-36715.14"/>
</g>
<!-- layer44_qkv_4 -->
<g id="node623" class="node">
<title>layer44_qkv_4</title>
<path fill="#e6f3ff" stroke="black" d="M345,-36567.47C345,-36567.47 47,-36567.47 47,-36567.47 41,-36567.47 35,-36561.47 35,-36555.47 35,-36555.47 35,-36532.47 35,-36532.47 35,-36526.47 41,-36520.47 47,-36520.47 47,-36520.47 345,-36520.47 345,-36520.47 351,-36520.47 357,-36526.47 357,-36532.47 357,-36532.47 357,-36555.47 357,-36555.47 357,-36561.47 351,-36567.47 345,-36567.47"/>
<text text-anchor="middle" x="196" y="-36552.47" font-family="Arial" font-size="10.00">Layer 44 QKV Proj GPU4</text>
<text text-anchor="middle" x="196" y="-36541.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="196" y="-36530.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer43_ffn_ar&#45;&gt;layer44_qkv_4 -->
<g id="edge711" class="edge">
<title>layer43_ffn_ar&#45;&gt;layer44_qkv_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M326.56,-36639.42C298.06,-36618.81 262.48,-36593.06 235.66,-36573.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="237.43,-36570.62 227.28,-36567.6 233.33,-36576.3 237.43,-36570.62"/>
</g>
<!-- layer44_qkv_5 -->
<g id="node624" class="node">
<title>layer44_qkv_5</title>
<path fill="#e6f3ff" stroke="black" d="M703,-36567.47C703,-36567.47 405,-36567.47 405,-36567.47 399,-36567.47 393,-36561.47 393,-36555.47 393,-36555.47 393,-36532.47 393,-36532.47 393,-36526.47 399,-36520.47 405,-36520.47 405,-36520.47 703,-36520.47 703,-36520.47 709,-36520.47 715,-36526.47 715,-36532.47 715,-36532.47 715,-36555.47 715,-36555.47 715,-36561.47 709,-36567.47 703,-36567.47"/>
<text text-anchor="middle" x="554" y="-36552.47" font-family="Arial" font-size="10.00">Layer 44 QKV Proj GPU5</text>
<text text-anchor="middle" x="554" y="-36541.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="554" y="-36530.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer43_ffn_ar&#45;&gt;layer44_qkv_5 -->
<g id="edge712" class="edge">
<title>layer43_ffn_ar&#45;&gt;layer44_qkv_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M423.44,-36639.42C451.94,-36618.81 487.52,-36593.06 514.34,-36573.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="516.67,-36576.3 522.72,-36567.6 512.57,-36570.62 516.67,-36576.3"/>
</g>
<!-- layer44_attn_4 -->
<g id="node625" class="node">
<title>layer44_attn_4</title>
<path fill="#e6f3ff" stroke="black" d="M345,-36448.47C345,-36448.47 47,-36448.47 47,-36448.47 41,-36448.47 35,-36442.47 35,-36436.47 35,-36436.47 35,-36413.47 35,-36413.47 35,-36407.47 41,-36401.47 47,-36401.47 47,-36401.47 345,-36401.47 345,-36401.47 351,-36401.47 357,-36407.47 357,-36413.47 357,-36413.47 357,-36436.47 357,-36436.47 357,-36442.47 351,-36448.47 345,-36448.47"/>
<text text-anchor="middle" x="196" y="-36433.47" font-family="Arial" font-size="10.00">Layer 44 Attention GPU4</text>
<text text-anchor="middle" x="196" y="-36422.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="196" y="-36411.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer44_qkv_4&#45;&gt;layer44_attn_4 -->
<g id="edge713" class="edge">
<title>layer44_qkv_4&#45;&gt;layer44_attn_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M196,-36520.41C196,-36502.96 196,-36478.55 196,-36458.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="199.5,-36458.86 196,-36448.86 192.5,-36458.86 199.5,-36458.86"/>
</g>
<!-- layer44_attn_5 -->
<g id="node626" class="node">
<title>layer44_attn_5</title>
<path fill="#e6f3ff" stroke="black" d="M703,-36448.47C703,-36448.47 405,-36448.47 405,-36448.47 399,-36448.47 393,-36442.47 393,-36436.47 393,-36436.47 393,-36413.47 393,-36413.47 393,-36407.47 399,-36401.47 405,-36401.47 405,-36401.47 703,-36401.47 703,-36401.47 709,-36401.47 715,-36407.47 715,-36413.47 715,-36413.47 715,-36436.47 715,-36436.47 715,-36442.47 709,-36448.47 703,-36448.47"/>
<text text-anchor="middle" x="554" y="-36433.47" font-family="Arial" font-size="10.00">Layer 44 Attention GPU5</text>
<text text-anchor="middle" x="554" y="-36422.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="554" y="-36411.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer44_qkv_5&#45;&gt;layer44_attn_5 -->
<g id="edge714" class="edge">
<title>layer44_qkv_5&#45;&gt;layer44_attn_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M554,-36520.41C554,-36502.96 554,-36478.55 554,-36458.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="557.5,-36458.86 554,-36448.86 550.5,-36458.86 557.5,-36458.86"/>
</g>
<!-- layer44_attn_out_4 -->
<g id="node627" class="node">
<title>layer44_attn_out_4</title>
<path fill="#e6f3ff" stroke="black" d="M345,-36329.47C345,-36329.47 55,-36329.47 55,-36329.47 49,-36329.47 43,-36323.47 43,-36317.47 43,-36317.47 43,-36294.47 43,-36294.47 43,-36288.47 49,-36282.47 55,-36282.47 55,-36282.47 345,-36282.47 345,-36282.47 351,-36282.47 357,-36288.47 357,-36294.47 357,-36294.47 357,-36317.47 357,-36317.47 357,-36323.47 351,-36329.47 345,-36329.47"/>
<text text-anchor="middle" x="200" y="-36314.47" font-family="Arial" font-size="10.00">Layer 44 Attn Out GPU4</text>
<text text-anchor="middle" x="200" y="-36303.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="200" y="-36292.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer44_attn_4&#45;&gt;layer44_attn_out_4 -->
<g id="edge715" class="edge">
<title>layer44_attn_4&#45;&gt;layer44_attn_out_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M196.77,-36401.41C197.37,-36383.96 198.2,-36359.55 198.87,-36339.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="202.37,-36339.97 199.22,-36329.86 195.38,-36339.73 202.37,-36339.97"/>
</g>
<!-- layer44_attn_out_5 -->
<g id="node628" class="node">
<title>layer44_attn_out_5</title>
<path fill="#e6f3ff" stroke="black" d="M697,-36329.47C697,-36329.47 407,-36329.47 407,-36329.47 401,-36329.47 395,-36323.47 395,-36317.47 395,-36317.47 395,-36294.47 395,-36294.47 395,-36288.47 401,-36282.47 407,-36282.47 407,-36282.47 697,-36282.47 697,-36282.47 703,-36282.47 709,-36288.47 709,-36294.47 709,-36294.47 709,-36317.47 709,-36317.47 709,-36323.47 703,-36329.47 697,-36329.47"/>
<text text-anchor="middle" x="552" y="-36314.47" font-family="Arial" font-size="10.00">Layer 44 Attn Out GPU5</text>
<text text-anchor="middle" x="552" y="-36303.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="552" y="-36292.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer44_attn_5&#45;&gt;layer44_attn_out_5 -->
<g id="edge716" class="edge">
<title>layer44_attn_5&#45;&gt;layer44_attn_out_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M553.61,-36401.41C553.32,-36383.96 552.9,-36359.55 552.56,-36339.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="556.06,-36339.8 552.39,-36329.86 549.06,-36339.92 556.06,-36339.8"/>
</g>
<!-- layer44_attn_ar -->
<g id="node629" class="node">
<title>layer44_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M505.07,-36210.47C505.07,-36210.47 303.07,-36210.47 303.07,-36210.47 297.07,-36210.47 287.3,-36205.8 283.53,-36201.13 283.53,-36201.13 240.47,-36147.8 240.47,-36147.8 236.7,-36143.14 238.93,-36138.47 244.93,-36138.47 244.93,-36138.47 446.93,-36138.47 446.93,-36138.47 452.93,-36138.47 462.7,-36143.14 466.47,-36147.8 466.47,-36147.8 509.53,-36201.13 509.53,-36201.13 513.3,-36205.8 511.07,-36210.47 505.07,-36210.47"/>
<text text-anchor="middle" x="375" y="-36177.47" font-family="Arial" font-size="10.00">Layer 44 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="375" y="-36166.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer44_attn_out_4&#45;&gt;layer44_attn_ar -->
<g id="edge717" class="edge">
<title>layer44_attn_out_4&#45;&gt;layer44_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M230.48,-36282.41C254.92,-36264.33 289.86,-36238.47 319.27,-36216.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="321.45,-36219.45 327.4,-36210.69 317.28,-36213.82 321.45,-36219.45"/>
</g>
<!-- layer44_attn_out_5&#45;&gt;layer44_attn_ar -->
<g id="edge718" class="edge">
<title>layer44_attn_out_5&#45;&gt;layer44_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M521.17,-36282.41C496.45,-36264.33 461.11,-36238.47 431.37,-36216.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="433.28,-36213.77 423.14,-36210.69 429.14,-36219.42 433.28,-36213.77"/>
</g>
<!-- layer44_ffn1_4 -->
<g id="node630" class="node">
<title>layer44_ffn1_4</title>
<path fill="#e6f3ff" stroke="black" d="M345,-36066.47C345,-36066.47 75,-36066.47 75,-36066.47 69,-36066.47 63,-36060.47 63,-36054.47 63,-36054.47 63,-36031.47 63,-36031.47 63,-36025.47 69,-36019.47 75,-36019.47 75,-36019.47 345,-36019.47 345,-36019.47 351,-36019.47 357,-36025.47 357,-36031.47 357,-36031.47 357,-36054.47 357,-36054.47 357,-36060.47 351,-36066.47 345,-36066.47"/>
<text text-anchor="middle" x="210" y="-36051.47" font-family="Arial" font-size="10.00">Layer 44 FFN1 GPU4</text>
<text text-anchor="middle" x="210" y="-36040.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="210" y="-36029.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer44_attn_ar&#45;&gt;layer44_ffn1_4 -->
<g id="edge719" class="edge">
<title>layer44_attn_ar&#45;&gt;layer44_ffn1_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M330.35,-36138.42C304.28,-36117.96 271.78,-36092.45 247.12,-36073.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="249.11,-36070.21 239.08,-36066.79 244.79,-36075.72 249.11,-36070.21"/>
</g>
<!-- layer44_ffn1_5 -->
<g id="node631" class="node">
<title>layer44_ffn1_5</title>
<path fill="#e6f3ff" stroke="black" d="M675,-36066.47C675,-36066.47 405,-36066.47 405,-36066.47 399,-36066.47 393,-36060.47 393,-36054.47 393,-36054.47 393,-36031.47 393,-36031.47 393,-36025.47 399,-36019.47 405,-36019.47 405,-36019.47 675,-36019.47 675,-36019.47 681,-36019.47 687,-36025.47 687,-36031.47 687,-36031.47 687,-36054.47 687,-36054.47 687,-36060.47 681,-36066.47 675,-36066.47"/>
<text text-anchor="middle" x="540" y="-36051.47" font-family="Arial" font-size="10.00">Layer 44 FFN1 GPU5</text>
<text text-anchor="middle" x="540" y="-36040.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-36029.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer44_attn_ar&#45;&gt;layer44_ffn1_5 -->
<g id="edge720" class="edge">
<title>layer44_attn_ar&#45;&gt;layer44_ffn1_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M419.65,-36138.42C445.72,-36117.96 478.22,-36092.45 502.88,-36073.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="505.21,-36075.72 510.92,-36066.79 500.89,-36070.21 505.21,-36075.72"/>
</g>
<!-- layer44_act_4 -->
<g id="node632" class="node">
<title>layer44_act_4</title>
<path fill="#e6f3ff" stroke="black" d="M345,-35947.47C345,-35947.47 75,-35947.47 75,-35947.47 69,-35947.47 63,-35941.47 63,-35935.47 63,-35935.47 63,-35912.47 63,-35912.47 63,-35906.47 69,-35900.47 75,-35900.47 75,-35900.47 345,-35900.47 345,-35900.47 351,-35900.47 357,-35906.47 357,-35912.47 357,-35912.47 357,-35935.47 357,-35935.47 357,-35941.47 351,-35947.47 345,-35947.47"/>
<text text-anchor="middle" x="210" y="-35932.47" font-family="Arial" font-size="10.00">Layer 44 SiLU GPU4</text>
<text text-anchor="middle" x="210" y="-35921.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="210" y="-35910.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer44_ffn1_4&#45;&gt;layer44_act_4 -->
<g id="edge721" class="edge">
<title>layer44_ffn1_4&#45;&gt;layer44_act_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M210,-36019.41C210,-36001.96 210,-35977.55 210,-35957.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="213.5,-35957.86 210,-35947.86 206.5,-35957.86 213.5,-35957.86"/>
</g>
<!-- layer44_act_5 -->
<g id="node633" class="node">
<title>layer44_act_5</title>
<path fill="#e6f3ff" stroke="black" d="M675,-35947.47C675,-35947.47 405,-35947.47 405,-35947.47 399,-35947.47 393,-35941.47 393,-35935.47 393,-35935.47 393,-35912.47 393,-35912.47 393,-35906.47 399,-35900.47 405,-35900.47 405,-35900.47 675,-35900.47 675,-35900.47 681,-35900.47 687,-35906.47 687,-35912.47 687,-35912.47 687,-35935.47 687,-35935.47 687,-35941.47 681,-35947.47 675,-35947.47"/>
<text text-anchor="middle" x="540" y="-35932.47" font-family="Arial" font-size="10.00">Layer 44 SiLU GPU5</text>
<text text-anchor="middle" x="540" y="-35921.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="540" y="-35910.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer44_ffn1_5&#45;&gt;layer44_act_5 -->
<g id="edge722" class="edge">
<title>layer44_ffn1_5&#45;&gt;layer44_act_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M540,-36019.41C540,-36001.96 540,-35977.55 540,-35957.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="543.5,-35957.86 540,-35947.86 536.5,-35957.86 543.5,-35957.86"/>
</g>
<!-- layer44_ffn2_4 -->
<g id="node634" class="node">
<title>layer44_ffn2_4</title>
<path fill="#e6f3ff" stroke="black" d="M344.5,-35828.47C344.5,-35828.47 81.5,-35828.47 81.5,-35828.47 75.5,-35828.47 69.5,-35822.47 69.5,-35816.47 69.5,-35816.47 69.5,-35793.47 69.5,-35793.47 69.5,-35787.47 75.5,-35781.47 81.5,-35781.47 81.5,-35781.47 344.5,-35781.47 344.5,-35781.47 350.5,-35781.47 356.5,-35787.47 356.5,-35793.47 356.5,-35793.47 356.5,-35816.47 356.5,-35816.47 356.5,-35822.47 350.5,-35828.47 344.5,-35828.47"/>
<text text-anchor="middle" x="213" y="-35813.47" font-family="Arial" font-size="10.00">Layer 44 FFN2 GPU4</text>
<text text-anchor="middle" x="213" y="-35802.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="213" y="-35791.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer44_act_4&#45;&gt;layer44_ffn2_4 -->
<g id="edge723" class="edge">
<title>layer44_act_4&#45;&gt;layer44_ffn2_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M210.58,-35900.41C211.03,-35882.96 211.65,-35858.55 212.16,-35838.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="215.66,-35838.94 212.41,-35828.86 208.66,-35838.76 215.66,-35838.94"/>
</g>
<!-- layer44_ffn2_5 -->
<g id="node635" class="node">
<title>layer44_ffn2_5</title>
<path fill="#e6f3ff" stroke="black" d="M669.5,-35828.47C669.5,-35828.47 406.5,-35828.47 406.5,-35828.47 400.5,-35828.47 394.5,-35822.47 394.5,-35816.47 394.5,-35816.47 394.5,-35793.47 394.5,-35793.47 394.5,-35787.47 400.5,-35781.47 406.5,-35781.47 406.5,-35781.47 669.5,-35781.47 669.5,-35781.47 675.5,-35781.47 681.5,-35787.47 681.5,-35793.47 681.5,-35793.47 681.5,-35816.47 681.5,-35816.47 681.5,-35822.47 675.5,-35828.47 669.5,-35828.47"/>
<text text-anchor="middle" x="538" y="-35813.47" font-family="Arial" font-size="10.00">Layer 44 FFN2 GPU5</text>
<text text-anchor="middle" x="538" y="-35802.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="538" y="-35791.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer44_act_5&#45;&gt;layer44_ffn2_5 -->
<g id="edge724" class="edge">
<title>layer44_act_5&#45;&gt;layer44_ffn2_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M539.61,-35900.41C539.32,-35882.96 538.9,-35858.55 538.56,-35838.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="542.06,-35838.8 538.39,-35828.86 535.06,-35838.92 542.06,-35838.8"/>
</g>
<!-- layer44_ffn_ar -->
<g id="node636" class="node">
<title>layer44_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M506.22,-35709.47C506.22,-35709.47 300.8,-35709.47 300.8,-35709.47 294.8,-35709.47 285,-35704.83 281.19,-35700.19 281.19,-35700.19 237.39,-35646.75 237.39,-35646.75 233.59,-35642.11 235.78,-35637.47 241.78,-35637.47 241.78,-35637.47 447.2,-35637.47 447.2,-35637.47 453.2,-35637.47 463,-35642.11 466.81,-35646.75 466.81,-35646.75 510.61,-35700.19 510.61,-35700.19 514.41,-35704.83 512.22,-35709.47 506.22,-35709.47"/>
<text text-anchor="middle" x="374" y="-35676.47" font-family="Arial" font-size="10.00">Layer 44 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="374" y="-35665.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer44_ffn2_4&#45;&gt;layer44_ffn_ar -->
<g id="edge725" class="edge">
<title>layer44_ffn2_4&#45;&gt;layer44_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M241.04,-35781.41C263.43,-35763.41 295.4,-35737.69 322.38,-35715.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="324.61,-35718.68 330.21,-35709.69 320.23,-35713.23 324.61,-35718.68"/>
</g>
<!-- layer44_ffn2_5&#45;&gt;layer44_ffn_ar -->
<g id="edge726" class="edge">
<title>layer44_ffn2_5&#45;&gt;layer44_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M509.43,-35781.41C486.63,-35763.41 454.06,-35737.69 426.58,-35715.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="428.62,-35713.14 418.6,-35709.69 424.28,-35718.63 428.62,-35713.14"/>
</g>
<!-- layer45_qkv_4 -->
<g id="node637" class="node">
<title>layer45_qkv_4</title>
<path fill="#e6f3ff" stroke="black" d="M344,-35565.47C344,-35565.47 46,-35565.47 46,-35565.47 40,-35565.47 34,-35559.47 34,-35553.47 34,-35553.47 34,-35530.47 34,-35530.47 34,-35524.47 40,-35518.47 46,-35518.47 46,-35518.47 344,-35518.47 344,-35518.47 350,-35518.47 356,-35524.47 356,-35530.47 356,-35530.47 356,-35553.47 356,-35553.47 356,-35559.47 350,-35565.47 344,-35565.47"/>
<text text-anchor="middle" x="195" y="-35550.47" font-family="Arial" font-size="10.00">Layer 45 QKV Proj GPU4</text>
<text text-anchor="middle" x="195" y="-35539.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="195" y="-35528.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer44_ffn_ar&#45;&gt;layer45_qkv_4 -->
<g id="edge727" class="edge">
<title>layer44_ffn_ar&#45;&gt;layer45_qkv_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M325.56,-35637.42C297.06,-35616.81 261.48,-35591.06 234.66,-35571.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="236.43,-35568.62 226.28,-35565.6 232.33,-35574.3 236.43,-35568.62"/>
</g>
<!-- layer45_qkv_5 -->
<g id="node638" class="node">
<title>layer45_qkv_5</title>
<path fill="#e6f3ff" stroke="black" d="M702,-35565.47C702,-35565.47 404,-35565.47 404,-35565.47 398,-35565.47 392,-35559.47 392,-35553.47 392,-35553.47 392,-35530.47 392,-35530.47 392,-35524.47 398,-35518.47 404,-35518.47 404,-35518.47 702,-35518.47 702,-35518.47 708,-35518.47 714,-35524.47 714,-35530.47 714,-35530.47 714,-35553.47 714,-35553.47 714,-35559.47 708,-35565.47 702,-35565.47"/>
<text text-anchor="middle" x="553" y="-35550.47" font-family="Arial" font-size="10.00">Layer 45 QKV Proj GPU5</text>
<text text-anchor="middle" x="553" y="-35539.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="553" y="-35528.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer44_ffn_ar&#45;&gt;layer45_qkv_5 -->
<g id="edge728" class="edge">
<title>layer44_ffn_ar&#45;&gt;layer45_qkv_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M422.44,-35637.42C450.94,-35616.81 486.52,-35591.06 513.34,-35571.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="515.67,-35574.3 521.72,-35565.6 511.57,-35568.62 515.67,-35574.3"/>
</g>
<!-- layer45_attn_4 -->
<g id="node639" class="node">
<title>layer45_attn_4</title>
<path fill="#e6f3ff" stroke="black" d="M344,-35446.47C344,-35446.47 46,-35446.47 46,-35446.47 40,-35446.47 34,-35440.47 34,-35434.47 34,-35434.47 34,-35411.47 34,-35411.47 34,-35405.47 40,-35399.47 46,-35399.47 46,-35399.47 344,-35399.47 344,-35399.47 350,-35399.47 356,-35405.47 356,-35411.47 356,-35411.47 356,-35434.47 356,-35434.47 356,-35440.47 350,-35446.47 344,-35446.47"/>
<text text-anchor="middle" x="195" y="-35431.47" font-family="Arial" font-size="10.00">Layer 45 Attention GPU4</text>
<text text-anchor="middle" x="195" y="-35420.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="195" y="-35409.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer45_qkv_4&#45;&gt;layer45_attn_4 -->
<g id="edge729" class="edge">
<title>layer45_qkv_4&#45;&gt;layer45_attn_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M195,-35518.41C195,-35500.96 195,-35476.55 195,-35456.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="198.5,-35456.86 195,-35446.86 191.5,-35456.86 198.5,-35456.86"/>
</g>
<!-- layer45_attn_5 -->
<g id="node640" class="node">
<title>layer45_attn_5</title>
<path fill="#e6f3ff" stroke="black" d="M702,-35446.47C702,-35446.47 404,-35446.47 404,-35446.47 398,-35446.47 392,-35440.47 392,-35434.47 392,-35434.47 392,-35411.47 392,-35411.47 392,-35405.47 398,-35399.47 404,-35399.47 404,-35399.47 702,-35399.47 702,-35399.47 708,-35399.47 714,-35405.47 714,-35411.47 714,-35411.47 714,-35434.47 714,-35434.47 714,-35440.47 708,-35446.47 702,-35446.47"/>
<text text-anchor="middle" x="553" y="-35431.47" font-family="Arial" font-size="10.00">Layer 45 Attention GPU5</text>
<text text-anchor="middle" x="553" y="-35420.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="553" y="-35409.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer45_qkv_5&#45;&gt;layer45_attn_5 -->
<g id="edge730" class="edge">
<title>layer45_qkv_5&#45;&gt;layer45_attn_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M553,-35518.41C553,-35500.96 553,-35476.55 553,-35456.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="556.5,-35456.86 553,-35446.86 549.5,-35456.86 556.5,-35456.86"/>
</g>
<!-- layer45_attn_out_4 -->
<g id="node641" class="node">
<title>layer45_attn_out_4</title>
<path fill="#e6f3ff" stroke="black" d="M344,-35327.47C344,-35327.47 54,-35327.47 54,-35327.47 48,-35327.47 42,-35321.47 42,-35315.47 42,-35315.47 42,-35292.47 42,-35292.47 42,-35286.47 48,-35280.47 54,-35280.47 54,-35280.47 344,-35280.47 344,-35280.47 350,-35280.47 356,-35286.47 356,-35292.47 356,-35292.47 356,-35315.47 356,-35315.47 356,-35321.47 350,-35327.47 344,-35327.47"/>
<text text-anchor="middle" x="199" y="-35312.47" font-family="Arial" font-size="10.00">Layer 45 Attn Out GPU4</text>
<text text-anchor="middle" x="199" y="-35301.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="199" y="-35290.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer45_attn_4&#45;&gt;layer45_attn_out_4 -->
<g id="edge731" class="edge">
<title>layer45_attn_4&#45;&gt;layer45_attn_out_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M195.77,-35399.41C196.37,-35381.96 197.2,-35357.55 197.87,-35337.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="201.37,-35337.97 198.22,-35327.86 194.38,-35337.73 201.37,-35337.97"/>
</g>
<!-- layer45_attn_out_5 -->
<g id="node642" class="node">
<title>layer45_attn_out_5</title>
<path fill="#e6f3ff" stroke="black" d="M696,-35327.47C696,-35327.47 406,-35327.47 406,-35327.47 400,-35327.47 394,-35321.47 394,-35315.47 394,-35315.47 394,-35292.47 394,-35292.47 394,-35286.47 400,-35280.47 406,-35280.47 406,-35280.47 696,-35280.47 696,-35280.47 702,-35280.47 708,-35286.47 708,-35292.47 708,-35292.47 708,-35315.47 708,-35315.47 708,-35321.47 702,-35327.47 696,-35327.47"/>
<text text-anchor="middle" x="551" y="-35312.47" font-family="Arial" font-size="10.00">Layer 45 Attn Out GPU5</text>
<text text-anchor="middle" x="551" y="-35301.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="551" y="-35290.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer45_attn_5&#45;&gt;layer45_attn_out_5 -->
<g id="edge732" class="edge">
<title>layer45_attn_5&#45;&gt;layer45_attn_out_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M552.61,-35399.41C552.32,-35381.96 551.9,-35357.55 551.56,-35337.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="555.06,-35337.8 551.39,-35327.86 548.06,-35337.92 555.06,-35337.8"/>
</g>
<!-- layer45_attn_ar -->
<g id="node643" class="node">
<title>layer45_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M504.07,-35208.47C504.07,-35208.47 302.07,-35208.47 302.07,-35208.47 296.07,-35208.47 286.3,-35203.8 282.53,-35199.13 282.53,-35199.13 239.47,-35145.8 239.47,-35145.8 235.7,-35141.14 237.93,-35136.47 243.93,-35136.47 243.93,-35136.47 445.93,-35136.47 445.93,-35136.47 451.93,-35136.47 461.7,-35141.14 465.47,-35145.8 465.47,-35145.8 508.53,-35199.13 508.53,-35199.13 512.3,-35203.8 510.07,-35208.47 504.07,-35208.47"/>
<text text-anchor="middle" x="374" y="-35175.47" font-family="Arial" font-size="10.00">Layer 45 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="374" y="-35164.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer45_attn_out_4&#45;&gt;layer45_attn_ar -->
<g id="edge733" class="edge">
<title>layer45_attn_out_4&#45;&gt;layer45_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M229.48,-35280.41C253.92,-35262.33 288.86,-35236.47 318.27,-35214.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="320.45,-35217.45 326.4,-35208.69 316.28,-35211.82 320.45,-35217.45"/>
</g>
<!-- layer45_attn_out_5&#45;&gt;layer45_attn_ar -->
<g id="edge734" class="edge">
<title>layer45_attn_out_5&#45;&gt;layer45_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M520.17,-35280.41C495.45,-35262.33 460.11,-35236.47 430.37,-35214.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="432.28,-35211.77 422.14,-35208.69 428.14,-35217.42 432.28,-35211.77"/>
</g>
<!-- layer45_ffn1_4 -->
<g id="node644" class="node">
<title>layer45_ffn1_4</title>
<path fill="#e6f3ff" stroke="black" d="M344,-35064.47C344,-35064.47 74,-35064.47 74,-35064.47 68,-35064.47 62,-35058.47 62,-35052.47 62,-35052.47 62,-35029.47 62,-35029.47 62,-35023.47 68,-35017.47 74,-35017.47 74,-35017.47 344,-35017.47 344,-35017.47 350,-35017.47 356,-35023.47 356,-35029.47 356,-35029.47 356,-35052.47 356,-35052.47 356,-35058.47 350,-35064.47 344,-35064.47"/>
<text text-anchor="middle" x="209" y="-35049.47" font-family="Arial" font-size="10.00">Layer 45 FFN1 GPU4</text>
<text text-anchor="middle" x="209" y="-35038.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="209" y="-35027.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer45_attn_ar&#45;&gt;layer45_ffn1_4 -->
<g id="edge735" class="edge">
<title>layer45_attn_ar&#45;&gt;layer45_ffn1_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M329.35,-35136.42C303.28,-35115.96 270.78,-35090.45 246.12,-35071.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="248.11,-35068.21 238.08,-35064.79 243.79,-35073.72 248.11,-35068.21"/>
</g>
<!-- layer45_ffn1_5 -->
<g id="node645" class="node">
<title>layer45_ffn1_5</title>
<path fill="#e6f3ff" stroke="black" d="M674,-35064.47C674,-35064.47 404,-35064.47 404,-35064.47 398,-35064.47 392,-35058.47 392,-35052.47 392,-35052.47 392,-35029.47 392,-35029.47 392,-35023.47 398,-35017.47 404,-35017.47 404,-35017.47 674,-35017.47 674,-35017.47 680,-35017.47 686,-35023.47 686,-35029.47 686,-35029.47 686,-35052.47 686,-35052.47 686,-35058.47 680,-35064.47 674,-35064.47"/>
<text text-anchor="middle" x="539" y="-35049.47" font-family="Arial" font-size="10.00">Layer 45 FFN1 GPU5</text>
<text text-anchor="middle" x="539" y="-35038.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="539" y="-35027.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer45_attn_ar&#45;&gt;layer45_ffn1_5 -->
<g id="edge736" class="edge">
<title>layer45_attn_ar&#45;&gt;layer45_ffn1_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M418.65,-35136.42C444.72,-35115.96 477.22,-35090.45 501.88,-35071.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="504.21,-35073.72 509.92,-35064.79 499.89,-35068.21 504.21,-35073.72"/>
</g>
<!-- layer45_act_4 -->
<g id="node646" class="node">
<title>layer45_act_4</title>
<path fill="#e6f3ff" stroke="black" d="M344,-34945.47C344,-34945.47 74,-34945.47 74,-34945.47 68,-34945.47 62,-34939.47 62,-34933.47 62,-34933.47 62,-34910.47 62,-34910.47 62,-34904.47 68,-34898.47 74,-34898.47 74,-34898.47 344,-34898.47 344,-34898.47 350,-34898.47 356,-34904.47 356,-34910.47 356,-34910.47 356,-34933.47 356,-34933.47 356,-34939.47 350,-34945.47 344,-34945.47"/>
<text text-anchor="middle" x="209" y="-34930.47" font-family="Arial" font-size="10.00">Layer 45 SiLU GPU4</text>
<text text-anchor="middle" x="209" y="-34919.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="209" y="-34908.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer45_ffn1_4&#45;&gt;layer45_act_4 -->
<g id="edge737" class="edge">
<title>layer45_ffn1_4&#45;&gt;layer45_act_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M209,-35017.41C209,-34999.96 209,-34975.55 209,-34955.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="212.5,-34955.86 209,-34945.86 205.5,-34955.86 212.5,-34955.86"/>
</g>
<!-- layer45_act_5 -->
<g id="node647" class="node">
<title>layer45_act_5</title>
<path fill="#e6f3ff" stroke="black" d="M674,-34945.47C674,-34945.47 404,-34945.47 404,-34945.47 398,-34945.47 392,-34939.47 392,-34933.47 392,-34933.47 392,-34910.47 392,-34910.47 392,-34904.47 398,-34898.47 404,-34898.47 404,-34898.47 674,-34898.47 674,-34898.47 680,-34898.47 686,-34904.47 686,-34910.47 686,-34910.47 686,-34933.47 686,-34933.47 686,-34939.47 680,-34945.47 674,-34945.47"/>
<text text-anchor="middle" x="539" y="-34930.47" font-family="Arial" font-size="10.00">Layer 45 SiLU GPU5</text>
<text text-anchor="middle" x="539" y="-34919.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="539" y="-34908.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer45_ffn1_5&#45;&gt;layer45_act_5 -->
<g id="edge738" class="edge">
<title>layer45_ffn1_5&#45;&gt;layer45_act_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M539,-35017.41C539,-34999.96 539,-34975.55 539,-34955.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="542.5,-34955.86 539,-34945.86 535.5,-34955.86 542.5,-34955.86"/>
</g>
<!-- layer45_ffn2_4 -->
<g id="node648" class="node">
<title>layer45_ffn2_4</title>
<path fill="#e6f3ff" stroke="black" d="M343.5,-34826.47C343.5,-34826.47 80.5,-34826.47 80.5,-34826.47 74.5,-34826.47 68.5,-34820.47 68.5,-34814.47 68.5,-34814.47 68.5,-34791.47 68.5,-34791.47 68.5,-34785.47 74.5,-34779.47 80.5,-34779.47 80.5,-34779.47 343.5,-34779.47 343.5,-34779.47 349.5,-34779.47 355.5,-34785.47 355.5,-34791.47 355.5,-34791.47 355.5,-34814.47 355.5,-34814.47 355.5,-34820.47 349.5,-34826.47 343.5,-34826.47"/>
<text text-anchor="middle" x="212" y="-34811.47" font-family="Arial" font-size="10.00">Layer 45 FFN2 GPU4</text>
<text text-anchor="middle" x="212" y="-34800.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="212" y="-34789.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer45_act_4&#45;&gt;layer45_ffn2_4 -->
<g id="edge739" class="edge">
<title>layer45_act_4&#45;&gt;layer45_ffn2_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M209.58,-34898.41C210.03,-34880.96 210.65,-34856.55 211.16,-34836.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="214.66,-34836.94 211.41,-34826.86 207.66,-34836.76 214.66,-34836.94"/>
</g>
<!-- layer45_ffn2_5 -->
<g id="node649" class="node">
<title>layer45_ffn2_5</title>
<path fill="#e6f3ff" stroke="black" d="M668.5,-34826.47C668.5,-34826.47 405.5,-34826.47 405.5,-34826.47 399.5,-34826.47 393.5,-34820.47 393.5,-34814.47 393.5,-34814.47 393.5,-34791.47 393.5,-34791.47 393.5,-34785.47 399.5,-34779.47 405.5,-34779.47 405.5,-34779.47 668.5,-34779.47 668.5,-34779.47 674.5,-34779.47 680.5,-34785.47 680.5,-34791.47 680.5,-34791.47 680.5,-34814.47 680.5,-34814.47 680.5,-34820.47 674.5,-34826.47 668.5,-34826.47"/>
<text text-anchor="middle" x="537" y="-34811.47" font-family="Arial" font-size="10.00">Layer 45 FFN2 GPU5</text>
<text text-anchor="middle" x="537" y="-34800.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="537" y="-34789.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer45_act_5&#45;&gt;layer45_ffn2_5 -->
<g id="edge740" class="edge">
<title>layer45_act_5&#45;&gt;layer45_ffn2_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M538.61,-34898.41C538.32,-34880.96 537.9,-34856.55 537.56,-34836.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="541.06,-34836.8 537.39,-34826.86 534.06,-34836.92 541.06,-34836.8"/>
</g>
<!-- layer45_ffn_ar -->
<g id="node650" class="node">
<title>layer45_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M505.22,-34707.47C505.22,-34707.47 299.8,-34707.47 299.8,-34707.47 293.8,-34707.47 284,-34702.83 280.19,-34698.19 280.19,-34698.19 236.39,-34644.75 236.39,-34644.75 232.59,-34640.11 234.78,-34635.47 240.78,-34635.47 240.78,-34635.47 446.2,-34635.47 446.2,-34635.47 452.2,-34635.47 462,-34640.11 465.81,-34644.75 465.81,-34644.75 509.61,-34698.19 509.61,-34698.19 513.41,-34702.83 511.22,-34707.47 505.22,-34707.47"/>
<text text-anchor="middle" x="373" y="-34674.47" font-family="Arial" font-size="10.00">Layer 45 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="373" y="-34663.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer45_ffn2_4&#45;&gt;layer45_ffn_ar -->
<g id="edge741" class="edge">
<title>layer45_ffn2_4&#45;&gt;layer45_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M240.04,-34779.41C262.43,-34761.41 294.4,-34735.69 321.38,-34713.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="323.61,-34716.68 329.21,-34707.69 319.23,-34711.23 323.61,-34716.68"/>
</g>
<!-- layer45_ffn2_5&#45;&gt;layer45_ffn_ar -->
<g id="edge742" class="edge">
<title>layer45_ffn2_5&#45;&gt;layer45_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M508.43,-34779.41C485.63,-34761.41 453.06,-34735.69 425.58,-34713.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="427.62,-34711.14 417.6,-34707.69 423.28,-34716.63 427.62,-34711.14"/>
</g>
<!-- layer46_qkv_4 -->
<g id="node651" class="node">
<title>layer46_qkv_4</title>
<path fill="#e6f3ff" stroke="black" d="M343,-34563.47C343,-34563.47 45,-34563.47 45,-34563.47 39,-34563.47 33,-34557.47 33,-34551.47 33,-34551.47 33,-34528.47 33,-34528.47 33,-34522.47 39,-34516.47 45,-34516.47 45,-34516.47 343,-34516.47 343,-34516.47 349,-34516.47 355,-34522.47 355,-34528.47 355,-34528.47 355,-34551.47 355,-34551.47 355,-34557.47 349,-34563.47 343,-34563.47"/>
<text text-anchor="middle" x="194" y="-34548.47" font-family="Arial" font-size="10.00">Layer 46 QKV Proj GPU4</text>
<text text-anchor="middle" x="194" y="-34537.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="194" y="-34526.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer45_ffn_ar&#45;&gt;layer46_qkv_4 -->
<g id="edge743" class="edge">
<title>layer45_ffn_ar&#45;&gt;layer46_qkv_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M324.56,-34635.42C296.06,-34614.81 260.48,-34589.06 233.66,-34569.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="235.43,-34566.62 225.28,-34563.6 231.33,-34572.3 235.43,-34566.62"/>
</g>
<!-- layer46_qkv_5 -->
<g id="node652" class="node">
<title>layer46_qkv_5</title>
<path fill="#e6f3ff" stroke="black" d="M701,-34563.47C701,-34563.47 403,-34563.47 403,-34563.47 397,-34563.47 391,-34557.47 391,-34551.47 391,-34551.47 391,-34528.47 391,-34528.47 391,-34522.47 397,-34516.47 403,-34516.47 403,-34516.47 701,-34516.47 701,-34516.47 707,-34516.47 713,-34522.47 713,-34528.47 713,-34528.47 713,-34551.47 713,-34551.47 713,-34557.47 707,-34563.47 701,-34563.47"/>
<text text-anchor="middle" x="552" y="-34548.47" font-family="Arial" font-size="10.00">Layer 46 QKV Proj GPU5</text>
<text text-anchor="middle" x="552" y="-34537.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="552" y="-34526.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer45_ffn_ar&#45;&gt;layer46_qkv_5 -->
<g id="edge744" class="edge">
<title>layer45_ffn_ar&#45;&gt;layer46_qkv_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M421.44,-34635.42C449.94,-34614.81 485.52,-34589.06 512.34,-34569.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="514.67,-34572.3 520.72,-34563.6 510.57,-34566.62 514.67,-34572.3"/>
</g>
<!-- layer46_attn_4 -->
<g id="node653" class="node">
<title>layer46_attn_4</title>
<path fill="#e6f3ff" stroke="black" d="M343,-34444.47C343,-34444.47 45,-34444.47 45,-34444.47 39,-34444.47 33,-34438.47 33,-34432.47 33,-34432.47 33,-34409.47 33,-34409.47 33,-34403.47 39,-34397.47 45,-34397.47 45,-34397.47 343,-34397.47 343,-34397.47 349,-34397.47 355,-34403.47 355,-34409.47 355,-34409.47 355,-34432.47 355,-34432.47 355,-34438.47 349,-34444.47 343,-34444.47"/>
<text text-anchor="middle" x="194" y="-34429.47" font-family="Arial" font-size="10.00">Layer 46 Attention GPU4</text>
<text text-anchor="middle" x="194" y="-34418.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="194" y="-34407.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer46_qkv_4&#45;&gt;layer46_attn_4 -->
<g id="edge745" class="edge">
<title>layer46_qkv_4&#45;&gt;layer46_attn_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M194,-34516.41C194,-34498.96 194,-34474.55 194,-34454.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="197.5,-34454.86 194,-34444.86 190.5,-34454.86 197.5,-34454.86"/>
</g>
<!-- layer46_attn_5 -->
<g id="node654" class="node">
<title>layer46_attn_5</title>
<path fill="#e6f3ff" stroke="black" d="M701,-34444.47C701,-34444.47 403,-34444.47 403,-34444.47 397,-34444.47 391,-34438.47 391,-34432.47 391,-34432.47 391,-34409.47 391,-34409.47 391,-34403.47 397,-34397.47 403,-34397.47 403,-34397.47 701,-34397.47 701,-34397.47 707,-34397.47 713,-34403.47 713,-34409.47 713,-34409.47 713,-34432.47 713,-34432.47 713,-34438.47 707,-34444.47 701,-34444.47"/>
<text text-anchor="middle" x="552" y="-34429.47" font-family="Arial" font-size="10.00">Layer 46 Attention GPU5</text>
<text text-anchor="middle" x="552" y="-34418.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="552" y="-34407.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer46_qkv_5&#45;&gt;layer46_attn_5 -->
<g id="edge746" class="edge">
<title>layer46_qkv_5&#45;&gt;layer46_attn_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M552,-34516.41C552,-34498.96 552,-34474.55 552,-34454.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="555.5,-34454.86 552,-34444.86 548.5,-34454.86 555.5,-34454.86"/>
</g>
<!-- layer46_attn_out_4 -->
<g id="node655" class="node">
<title>layer46_attn_out_4</title>
<path fill="#e6f3ff" stroke="black" d="M343,-34325.47C343,-34325.47 53,-34325.47 53,-34325.47 47,-34325.47 41,-34319.47 41,-34313.47 41,-34313.47 41,-34290.47 41,-34290.47 41,-34284.47 47,-34278.47 53,-34278.47 53,-34278.47 343,-34278.47 343,-34278.47 349,-34278.47 355,-34284.47 355,-34290.47 355,-34290.47 355,-34313.47 355,-34313.47 355,-34319.47 349,-34325.47 343,-34325.47"/>
<text text-anchor="middle" x="198" y="-34310.47" font-family="Arial" font-size="10.00">Layer 46 Attn Out GPU4</text>
<text text-anchor="middle" x="198" y="-34299.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="198" y="-34288.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer46_attn_4&#45;&gt;layer46_attn_out_4 -->
<g id="edge747" class="edge">
<title>layer46_attn_4&#45;&gt;layer46_attn_out_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M194.77,-34397.41C195.37,-34379.96 196.2,-34355.55 196.87,-34335.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="200.37,-34335.97 197.22,-34325.86 193.38,-34335.73 200.37,-34335.97"/>
</g>
<!-- layer46_attn_out_5 -->
<g id="node656" class="node">
<title>layer46_attn_out_5</title>
<path fill="#e6f3ff" stroke="black" d="M695,-34325.47C695,-34325.47 405,-34325.47 405,-34325.47 399,-34325.47 393,-34319.47 393,-34313.47 393,-34313.47 393,-34290.47 393,-34290.47 393,-34284.47 399,-34278.47 405,-34278.47 405,-34278.47 695,-34278.47 695,-34278.47 701,-34278.47 707,-34284.47 707,-34290.47 707,-34290.47 707,-34313.47 707,-34313.47 707,-34319.47 701,-34325.47 695,-34325.47"/>
<text text-anchor="middle" x="550" y="-34310.47" font-family="Arial" font-size="10.00">Layer 46 Attn Out GPU5</text>
<text text-anchor="middle" x="550" y="-34299.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="550" y="-34288.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer46_attn_5&#45;&gt;layer46_attn_out_5 -->
<g id="edge748" class="edge">
<title>layer46_attn_5&#45;&gt;layer46_attn_out_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M551.61,-34397.41C551.32,-34379.96 550.9,-34355.55 550.56,-34335.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="554.06,-34335.8 550.39,-34325.86 547.06,-34335.92 554.06,-34335.8"/>
</g>
<!-- layer46_attn_ar -->
<g id="node657" class="node">
<title>layer46_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M503.07,-34206.47C503.07,-34206.47 301.07,-34206.47 301.07,-34206.47 295.07,-34206.47 285.3,-34201.8 281.53,-34197.13 281.53,-34197.13 238.47,-34143.8 238.47,-34143.8 234.7,-34139.14 236.93,-34134.47 242.93,-34134.47 242.93,-34134.47 444.93,-34134.47 444.93,-34134.47 450.93,-34134.47 460.7,-34139.14 464.47,-34143.8 464.47,-34143.8 507.53,-34197.13 507.53,-34197.13 511.3,-34201.8 509.07,-34206.47 503.07,-34206.47"/>
<text text-anchor="middle" x="373" y="-34173.47" font-family="Arial" font-size="10.00">Layer 46 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="373" y="-34162.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer46_attn_out_4&#45;&gt;layer46_attn_ar -->
<g id="edge749" class="edge">
<title>layer46_attn_out_4&#45;&gt;layer46_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M228.48,-34278.41C252.92,-34260.33 287.86,-34234.47 317.27,-34212.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="319.45,-34215.45 325.4,-34206.69 315.28,-34209.82 319.45,-34215.45"/>
</g>
<!-- layer46_attn_out_5&#45;&gt;layer46_attn_ar -->
<g id="edge750" class="edge">
<title>layer46_attn_out_5&#45;&gt;layer46_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M519.17,-34278.41C494.45,-34260.33 459.11,-34234.47 429.37,-34212.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="431.28,-34209.77 421.14,-34206.69 427.14,-34215.42 431.28,-34209.77"/>
</g>
<!-- layer46_ffn1_4 -->
<g id="node658" class="node">
<title>layer46_ffn1_4</title>
<path fill="#e6f3ff" stroke="black" d="M343,-34062.47C343,-34062.47 73,-34062.47 73,-34062.47 67,-34062.47 61,-34056.47 61,-34050.47 61,-34050.47 61,-34027.47 61,-34027.47 61,-34021.47 67,-34015.47 73,-34015.47 73,-34015.47 343,-34015.47 343,-34015.47 349,-34015.47 355,-34021.47 355,-34027.47 355,-34027.47 355,-34050.47 355,-34050.47 355,-34056.47 349,-34062.47 343,-34062.47"/>
<text text-anchor="middle" x="208" y="-34047.47" font-family="Arial" font-size="10.00">Layer 46 FFN1 GPU4</text>
<text text-anchor="middle" x="208" y="-34036.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="208" y="-34025.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer46_attn_ar&#45;&gt;layer46_ffn1_4 -->
<g id="edge751" class="edge">
<title>layer46_attn_ar&#45;&gt;layer46_ffn1_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M328.35,-34134.42C302.28,-34113.96 269.78,-34088.45 245.12,-34069.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="247.11,-34066.21 237.08,-34062.79 242.79,-34071.72 247.11,-34066.21"/>
</g>
<!-- layer46_ffn1_5 -->
<g id="node659" class="node">
<title>layer46_ffn1_5</title>
<path fill="#e6f3ff" stroke="black" d="M673,-34062.47C673,-34062.47 403,-34062.47 403,-34062.47 397,-34062.47 391,-34056.47 391,-34050.47 391,-34050.47 391,-34027.47 391,-34027.47 391,-34021.47 397,-34015.47 403,-34015.47 403,-34015.47 673,-34015.47 673,-34015.47 679,-34015.47 685,-34021.47 685,-34027.47 685,-34027.47 685,-34050.47 685,-34050.47 685,-34056.47 679,-34062.47 673,-34062.47"/>
<text text-anchor="middle" x="538" y="-34047.47" font-family="Arial" font-size="10.00">Layer 46 FFN1 GPU5</text>
<text text-anchor="middle" x="538" y="-34036.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="538" y="-34025.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer46_attn_ar&#45;&gt;layer46_ffn1_5 -->
<g id="edge752" class="edge">
<title>layer46_attn_ar&#45;&gt;layer46_ffn1_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M417.65,-34134.42C443.72,-34113.96 476.22,-34088.45 500.88,-34069.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="503.21,-34071.72 508.92,-34062.79 498.89,-34066.21 503.21,-34071.72"/>
</g>
<!-- layer46_act_4 -->
<g id="node660" class="node">
<title>layer46_act_4</title>
<path fill="#e6f3ff" stroke="black" d="M343,-33943.47C343,-33943.47 73,-33943.47 73,-33943.47 67,-33943.47 61,-33937.47 61,-33931.47 61,-33931.47 61,-33908.47 61,-33908.47 61,-33902.47 67,-33896.47 73,-33896.47 73,-33896.47 343,-33896.47 343,-33896.47 349,-33896.47 355,-33902.47 355,-33908.47 355,-33908.47 355,-33931.47 355,-33931.47 355,-33937.47 349,-33943.47 343,-33943.47"/>
<text text-anchor="middle" x="208" y="-33928.47" font-family="Arial" font-size="10.00">Layer 46 SiLU GPU4</text>
<text text-anchor="middle" x="208" y="-33917.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="208" y="-33906.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer46_ffn1_4&#45;&gt;layer46_act_4 -->
<g id="edge753" class="edge">
<title>layer46_ffn1_4&#45;&gt;layer46_act_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M208,-34015.41C208,-33997.96 208,-33973.55 208,-33953.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="211.5,-33953.86 208,-33943.86 204.5,-33953.86 211.5,-33953.86"/>
</g>
<!-- layer46_act_5 -->
<g id="node661" class="node">
<title>layer46_act_5</title>
<path fill="#e6f3ff" stroke="black" d="M673,-33943.47C673,-33943.47 403,-33943.47 403,-33943.47 397,-33943.47 391,-33937.47 391,-33931.47 391,-33931.47 391,-33908.47 391,-33908.47 391,-33902.47 397,-33896.47 403,-33896.47 403,-33896.47 673,-33896.47 673,-33896.47 679,-33896.47 685,-33902.47 685,-33908.47 685,-33908.47 685,-33931.47 685,-33931.47 685,-33937.47 679,-33943.47 673,-33943.47"/>
<text text-anchor="middle" x="538" y="-33928.47" font-family="Arial" font-size="10.00">Layer 46 SiLU GPU5</text>
<text text-anchor="middle" x="538" y="-33917.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="538" y="-33906.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer46_ffn1_5&#45;&gt;layer46_act_5 -->
<g id="edge754" class="edge">
<title>layer46_ffn1_5&#45;&gt;layer46_act_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M538,-34015.41C538,-33997.96 538,-33973.55 538,-33953.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="541.5,-33953.86 538,-33943.86 534.5,-33953.86 541.5,-33953.86"/>
</g>
<!-- layer46_ffn2_4 -->
<g id="node662" class="node">
<title>layer46_ffn2_4</title>
<path fill="#e6f3ff" stroke="black" d="M342.5,-33824.47C342.5,-33824.47 79.5,-33824.47 79.5,-33824.47 73.5,-33824.47 67.5,-33818.47 67.5,-33812.47 67.5,-33812.47 67.5,-33789.47 67.5,-33789.47 67.5,-33783.47 73.5,-33777.47 79.5,-33777.47 79.5,-33777.47 342.5,-33777.47 342.5,-33777.47 348.5,-33777.47 354.5,-33783.47 354.5,-33789.47 354.5,-33789.47 354.5,-33812.47 354.5,-33812.47 354.5,-33818.47 348.5,-33824.47 342.5,-33824.47"/>
<text text-anchor="middle" x="211" y="-33809.47" font-family="Arial" font-size="10.00">Layer 46 FFN2 GPU4</text>
<text text-anchor="middle" x="211" y="-33798.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="211" y="-33787.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer46_act_4&#45;&gt;layer46_ffn2_4 -->
<g id="edge755" class="edge">
<title>layer46_act_4&#45;&gt;layer46_ffn2_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M208.58,-33896.41C209.03,-33878.96 209.65,-33854.55 210.16,-33834.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="213.66,-33834.94 210.41,-33824.86 206.66,-33834.76 213.66,-33834.94"/>
</g>
<!-- layer46_ffn2_5 -->
<g id="node663" class="node">
<title>layer46_ffn2_5</title>
<path fill="#e6f3ff" stroke="black" d="M667.5,-33824.47C667.5,-33824.47 404.5,-33824.47 404.5,-33824.47 398.5,-33824.47 392.5,-33818.47 392.5,-33812.47 392.5,-33812.47 392.5,-33789.47 392.5,-33789.47 392.5,-33783.47 398.5,-33777.47 404.5,-33777.47 404.5,-33777.47 667.5,-33777.47 667.5,-33777.47 673.5,-33777.47 679.5,-33783.47 679.5,-33789.47 679.5,-33789.47 679.5,-33812.47 679.5,-33812.47 679.5,-33818.47 673.5,-33824.47 667.5,-33824.47"/>
<text text-anchor="middle" x="536" y="-33809.47" font-family="Arial" font-size="10.00">Layer 46 FFN2 GPU5</text>
<text text-anchor="middle" x="536" y="-33798.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="536" y="-33787.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer46_act_5&#45;&gt;layer46_ffn2_5 -->
<g id="edge756" class="edge">
<title>layer46_act_5&#45;&gt;layer46_ffn2_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M537.61,-33896.41C537.32,-33878.96 536.9,-33854.55 536.56,-33834.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="540.06,-33834.8 536.39,-33824.86 533.06,-33834.92 540.06,-33834.8"/>
</g>
<!-- layer46_ffn_ar -->
<g id="node664" class="node">
<title>layer46_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M504.22,-33705.47C504.22,-33705.47 298.8,-33705.47 298.8,-33705.47 292.8,-33705.47 283,-33700.83 279.19,-33696.19 279.19,-33696.19 235.39,-33642.75 235.39,-33642.75 231.59,-33638.11 233.78,-33633.47 239.78,-33633.47 239.78,-33633.47 445.2,-33633.47 445.2,-33633.47 451.2,-33633.47 461,-33638.11 464.81,-33642.75 464.81,-33642.75 508.61,-33696.19 508.61,-33696.19 512.41,-33700.83 510.22,-33705.47 504.22,-33705.47"/>
<text text-anchor="middle" x="372" y="-33672.47" font-family="Arial" font-size="10.00">Layer 46 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="372" y="-33661.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer46_ffn2_4&#45;&gt;layer46_ffn_ar -->
<g id="edge757" class="edge">
<title>layer46_ffn2_4&#45;&gt;layer46_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M239.04,-33777.41C261.43,-33759.41 293.4,-33733.69 320.38,-33711.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="322.61,-33714.68 328.21,-33705.69 318.23,-33709.23 322.61,-33714.68"/>
</g>
<!-- layer46_ffn2_5&#45;&gt;layer46_ffn_ar -->
<g id="edge758" class="edge">
<title>layer46_ffn2_5&#45;&gt;layer46_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M507.43,-33777.41C484.63,-33759.41 452.06,-33733.69 424.58,-33711.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="426.62,-33709.14 416.6,-33705.69 422.28,-33714.63 426.62,-33709.14"/>
</g>
<!-- layer47_qkv_4 -->
<g id="node665" class="node">
<title>layer47_qkv_4</title>
<path fill="#e6f3ff" stroke="black" d="M342,-33561.47C342,-33561.47 44,-33561.47 44,-33561.47 38,-33561.47 32,-33555.47 32,-33549.47 32,-33549.47 32,-33526.47 32,-33526.47 32,-33520.47 38,-33514.47 44,-33514.47 44,-33514.47 342,-33514.47 342,-33514.47 348,-33514.47 354,-33520.47 354,-33526.47 354,-33526.47 354,-33549.47 354,-33549.47 354,-33555.47 348,-33561.47 342,-33561.47"/>
<text text-anchor="middle" x="193" y="-33546.47" font-family="Arial" font-size="10.00">Layer 47 QKV Proj GPU4</text>
<text text-anchor="middle" x="193" y="-33535.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="193" y="-33524.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer46_ffn_ar&#45;&gt;layer47_qkv_4 -->
<g id="edge759" class="edge">
<title>layer46_ffn_ar&#45;&gt;layer47_qkv_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M323.56,-33633.42C295.06,-33612.81 259.48,-33587.06 232.66,-33567.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="234.43,-33564.62 224.28,-33561.6 230.33,-33570.3 234.43,-33564.62"/>
</g>
<!-- layer47_qkv_5 -->
<g id="node666" class="node">
<title>layer47_qkv_5</title>
<path fill="#e6f3ff" stroke="black" d="M700,-33561.47C700,-33561.47 402,-33561.47 402,-33561.47 396,-33561.47 390,-33555.47 390,-33549.47 390,-33549.47 390,-33526.47 390,-33526.47 390,-33520.47 396,-33514.47 402,-33514.47 402,-33514.47 700,-33514.47 700,-33514.47 706,-33514.47 712,-33520.47 712,-33526.47 712,-33526.47 712,-33549.47 712,-33549.47 712,-33555.47 706,-33561.47 700,-33561.47"/>
<text text-anchor="middle" x="551" y="-33546.47" font-family="Arial" font-size="10.00">Layer 47 QKV Proj GPU5</text>
<text text-anchor="middle" x="551" y="-33535.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="551" y="-33524.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer46_ffn_ar&#45;&gt;layer47_qkv_5 -->
<g id="edge760" class="edge">
<title>layer46_ffn_ar&#45;&gt;layer47_qkv_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M420.44,-33633.42C448.94,-33612.81 484.52,-33587.06 511.34,-33567.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="513.67,-33570.3 519.72,-33561.6 509.57,-33564.62 513.67,-33570.3"/>
</g>
<!-- layer47_attn_4 -->
<g id="node667" class="node">
<title>layer47_attn_4</title>
<path fill="#e6f3ff" stroke="black" d="M342,-33442.47C342,-33442.47 44,-33442.47 44,-33442.47 38,-33442.47 32,-33436.47 32,-33430.47 32,-33430.47 32,-33407.47 32,-33407.47 32,-33401.47 38,-33395.47 44,-33395.47 44,-33395.47 342,-33395.47 342,-33395.47 348,-33395.47 354,-33401.47 354,-33407.47 354,-33407.47 354,-33430.47 354,-33430.47 354,-33436.47 348,-33442.47 342,-33442.47"/>
<text text-anchor="middle" x="193" y="-33427.47" font-family="Arial" font-size="10.00">Layer 47 Attention GPU4</text>
<text text-anchor="middle" x="193" y="-33416.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="193" y="-33405.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer47_qkv_4&#45;&gt;layer47_attn_4 -->
<g id="edge761" class="edge">
<title>layer47_qkv_4&#45;&gt;layer47_attn_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M193,-33514.41C193,-33496.96 193,-33472.55 193,-33452.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="196.5,-33452.86 193,-33442.86 189.5,-33452.86 196.5,-33452.86"/>
</g>
<!-- layer47_attn_5 -->
<g id="node668" class="node">
<title>layer47_attn_5</title>
<path fill="#e6f3ff" stroke="black" d="M700,-33442.47C700,-33442.47 402,-33442.47 402,-33442.47 396,-33442.47 390,-33436.47 390,-33430.47 390,-33430.47 390,-33407.47 390,-33407.47 390,-33401.47 396,-33395.47 402,-33395.47 402,-33395.47 700,-33395.47 700,-33395.47 706,-33395.47 712,-33401.47 712,-33407.47 712,-33407.47 712,-33430.47 712,-33430.47 712,-33436.47 706,-33442.47 700,-33442.47"/>
<text text-anchor="middle" x="551" y="-33427.47" font-family="Arial" font-size="10.00">Layer 47 Attention GPU5</text>
<text text-anchor="middle" x="551" y="-33416.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="551" y="-33405.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer47_qkv_5&#45;&gt;layer47_attn_5 -->
<g id="edge762" class="edge">
<title>layer47_qkv_5&#45;&gt;layer47_attn_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M551,-33514.41C551,-33496.96 551,-33472.55 551,-33452.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="554.5,-33452.86 551,-33442.86 547.5,-33452.86 554.5,-33452.86"/>
</g>
<!-- layer47_attn_out_4 -->
<g id="node669" class="node">
<title>layer47_attn_out_4</title>
<path fill="#e6f3ff" stroke="black" d="M342,-33323.47C342,-33323.47 52,-33323.47 52,-33323.47 46,-33323.47 40,-33317.47 40,-33311.47 40,-33311.47 40,-33288.47 40,-33288.47 40,-33282.47 46,-33276.47 52,-33276.47 52,-33276.47 342,-33276.47 342,-33276.47 348,-33276.47 354,-33282.47 354,-33288.47 354,-33288.47 354,-33311.47 354,-33311.47 354,-33317.47 348,-33323.47 342,-33323.47"/>
<text text-anchor="middle" x="197" y="-33308.47" font-family="Arial" font-size="10.00">Layer 47 Attn Out GPU4</text>
<text text-anchor="middle" x="197" y="-33297.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="197" y="-33286.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer47_attn_4&#45;&gt;layer47_attn_out_4 -->
<g id="edge763" class="edge">
<title>layer47_attn_4&#45;&gt;layer47_attn_out_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M193.77,-33395.41C194.37,-33377.96 195.2,-33353.55 195.87,-33333.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="199.37,-33333.97 196.22,-33323.86 192.38,-33333.73 199.37,-33333.97"/>
</g>
<!-- layer47_attn_out_5 -->
<g id="node670" class="node">
<title>layer47_attn_out_5</title>
<path fill="#e6f3ff" stroke="black" d="M694,-33323.47C694,-33323.47 404,-33323.47 404,-33323.47 398,-33323.47 392,-33317.47 392,-33311.47 392,-33311.47 392,-33288.47 392,-33288.47 392,-33282.47 398,-33276.47 404,-33276.47 404,-33276.47 694,-33276.47 694,-33276.47 700,-33276.47 706,-33282.47 706,-33288.47 706,-33288.47 706,-33311.47 706,-33311.47 706,-33317.47 700,-33323.47 694,-33323.47"/>
<text text-anchor="middle" x="549" y="-33308.47" font-family="Arial" font-size="10.00">Layer 47 Attn Out GPU5</text>
<text text-anchor="middle" x="549" y="-33297.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="549" y="-33286.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer47_attn_5&#45;&gt;layer47_attn_out_5 -->
<g id="edge764" class="edge">
<title>layer47_attn_5&#45;&gt;layer47_attn_out_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M550.61,-33395.41C550.32,-33377.96 549.9,-33353.55 549.56,-33333.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="553.06,-33333.8 549.39,-33323.86 546.06,-33333.92 553.06,-33333.8"/>
</g>
<!-- layer47_attn_ar -->
<g id="node671" class="node">
<title>layer47_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M502.07,-33204.47C502.07,-33204.47 300.07,-33204.47 300.07,-33204.47 294.07,-33204.47 284.3,-33199.8 280.53,-33195.13 280.53,-33195.13 237.47,-33141.8 237.47,-33141.8 233.7,-33137.14 235.93,-33132.47 241.93,-33132.47 241.93,-33132.47 443.93,-33132.47 443.93,-33132.47 449.93,-33132.47 459.7,-33137.14 463.47,-33141.8 463.47,-33141.8 506.53,-33195.13 506.53,-33195.13 510.3,-33199.8 508.07,-33204.47 502.07,-33204.47"/>
<text text-anchor="middle" x="372" y="-33171.47" font-family="Arial" font-size="10.00">Layer 47 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="372" y="-33160.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer47_attn_out_4&#45;&gt;layer47_attn_ar -->
<g id="edge765" class="edge">
<title>layer47_attn_out_4&#45;&gt;layer47_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M227.48,-33276.41C251.92,-33258.33 286.86,-33232.47 316.27,-33210.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="318.45,-33213.45 324.4,-33204.69 314.28,-33207.82 318.45,-33213.45"/>
</g>
<!-- layer47_attn_out_5&#45;&gt;layer47_attn_ar -->
<g id="edge766" class="edge">
<title>layer47_attn_out_5&#45;&gt;layer47_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M518.17,-33276.41C493.45,-33258.33 458.11,-33232.47 428.37,-33210.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="430.28,-33207.77 420.14,-33204.69 426.14,-33213.42 430.28,-33207.77"/>
</g>
<!-- layer47_ffn1_4 -->
<g id="node672" class="node">
<title>layer47_ffn1_4</title>
<path fill="#e6f3ff" stroke="black" d="M342,-33060.47C342,-33060.47 72,-33060.47 72,-33060.47 66,-33060.47 60,-33054.47 60,-33048.47 60,-33048.47 60,-33025.47 60,-33025.47 60,-33019.47 66,-33013.47 72,-33013.47 72,-33013.47 342,-33013.47 342,-33013.47 348,-33013.47 354,-33019.47 354,-33025.47 354,-33025.47 354,-33048.47 354,-33048.47 354,-33054.47 348,-33060.47 342,-33060.47"/>
<text text-anchor="middle" x="207" y="-33045.47" font-family="Arial" font-size="10.00">Layer 47 FFN1 GPU4</text>
<text text-anchor="middle" x="207" y="-33034.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="207" y="-33023.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer47_attn_ar&#45;&gt;layer47_ffn1_4 -->
<g id="edge767" class="edge">
<title>layer47_attn_ar&#45;&gt;layer47_ffn1_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M327.35,-33132.42C301.28,-33111.96 268.78,-33086.45 244.12,-33067.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="246.11,-33064.21 236.08,-33060.79 241.79,-33069.72 246.11,-33064.21"/>
</g>
<!-- layer47_ffn1_5 -->
<g id="node673" class="node">
<title>layer47_ffn1_5</title>
<path fill="#e6f3ff" stroke="black" d="M672,-33060.47C672,-33060.47 402,-33060.47 402,-33060.47 396,-33060.47 390,-33054.47 390,-33048.47 390,-33048.47 390,-33025.47 390,-33025.47 390,-33019.47 396,-33013.47 402,-33013.47 402,-33013.47 672,-33013.47 672,-33013.47 678,-33013.47 684,-33019.47 684,-33025.47 684,-33025.47 684,-33048.47 684,-33048.47 684,-33054.47 678,-33060.47 672,-33060.47"/>
<text text-anchor="middle" x="537" y="-33045.47" font-family="Arial" font-size="10.00">Layer 47 FFN1 GPU5</text>
<text text-anchor="middle" x="537" y="-33034.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="537" y="-33023.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer47_attn_ar&#45;&gt;layer47_ffn1_5 -->
<g id="edge768" class="edge">
<title>layer47_attn_ar&#45;&gt;layer47_ffn1_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M416.65,-33132.42C442.72,-33111.96 475.22,-33086.45 499.88,-33067.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="502.21,-33069.72 507.92,-33060.79 497.89,-33064.21 502.21,-33069.72"/>
</g>
<!-- layer47_act_4 -->
<g id="node674" class="node">
<title>layer47_act_4</title>
<path fill="#e6f3ff" stroke="black" d="M342,-32941.47C342,-32941.47 72,-32941.47 72,-32941.47 66,-32941.47 60,-32935.47 60,-32929.47 60,-32929.47 60,-32906.47 60,-32906.47 60,-32900.47 66,-32894.47 72,-32894.47 72,-32894.47 342,-32894.47 342,-32894.47 348,-32894.47 354,-32900.47 354,-32906.47 354,-32906.47 354,-32929.47 354,-32929.47 354,-32935.47 348,-32941.47 342,-32941.47"/>
<text text-anchor="middle" x="207" y="-32926.47" font-family="Arial" font-size="10.00">Layer 47 SiLU GPU4</text>
<text text-anchor="middle" x="207" y="-32915.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="207" y="-32904.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer47_ffn1_4&#45;&gt;layer47_act_4 -->
<g id="edge769" class="edge">
<title>layer47_ffn1_4&#45;&gt;layer47_act_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M207,-33013.41C207,-32995.96 207,-32971.55 207,-32951.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="210.5,-32951.86 207,-32941.86 203.5,-32951.86 210.5,-32951.86"/>
</g>
<!-- layer47_act_5 -->
<g id="node675" class="node">
<title>layer47_act_5</title>
<path fill="#e6f3ff" stroke="black" d="M672,-32941.47C672,-32941.47 402,-32941.47 402,-32941.47 396,-32941.47 390,-32935.47 390,-32929.47 390,-32929.47 390,-32906.47 390,-32906.47 390,-32900.47 396,-32894.47 402,-32894.47 402,-32894.47 672,-32894.47 672,-32894.47 678,-32894.47 684,-32900.47 684,-32906.47 684,-32906.47 684,-32929.47 684,-32929.47 684,-32935.47 678,-32941.47 672,-32941.47"/>
<text text-anchor="middle" x="537" y="-32926.47" font-family="Arial" font-size="10.00">Layer 47 SiLU GPU5</text>
<text text-anchor="middle" x="537" y="-32915.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="537" y="-32904.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer47_ffn1_5&#45;&gt;layer47_act_5 -->
<g id="edge770" class="edge">
<title>layer47_ffn1_5&#45;&gt;layer47_act_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M537,-33013.41C537,-32995.96 537,-32971.55 537,-32951.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="540.5,-32951.86 537,-32941.86 533.5,-32951.86 540.5,-32951.86"/>
</g>
<!-- layer47_ffn2_4 -->
<g id="node676" class="node">
<title>layer47_ffn2_4</title>
<path fill="#e6f3ff" stroke="black" d="M341.5,-32822.47C341.5,-32822.47 78.5,-32822.47 78.5,-32822.47 72.5,-32822.47 66.5,-32816.47 66.5,-32810.47 66.5,-32810.47 66.5,-32787.47 66.5,-32787.47 66.5,-32781.47 72.5,-32775.47 78.5,-32775.47 78.5,-32775.47 341.5,-32775.47 341.5,-32775.47 347.5,-32775.47 353.5,-32781.47 353.5,-32787.47 353.5,-32787.47 353.5,-32810.47 353.5,-32810.47 353.5,-32816.47 347.5,-32822.47 341.5,-32822.47"/>
<text text-anchor="middle" x="210" y="-32807.47" font-family="Arial" font-size="10.00">Layer 47 FFN2 GPU4</text>
<text text-anchor="middle" x="210" y="-32796.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="210" y="-32785.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer47_act_4&#45;&gt;layer47_ffn2_4 -->
<g id="edge771" class="edge">
<title>layer47_act_4&#45;&gt;layer47_ffn2_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M207.58,-32894.41C208.03,-32876.96 208.65,-32852.55 209.16,-32832.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="212.66,-32832.94 209.41,-32822.86 205.66,-32832.76 212.66,-32832.94"/>
</g>
<!-- layer47_ffn2_5 -->
<g id="node677" class="node">
<title>layer47_ffn2_5</title>
<path fill="#e6f3ff" stroke="black" d="M666.5,-32822.47C666.5,-32822.47 403.5,-32822.47 403.5,-32822.47 397.5,-32822.47 391.5,-32816.47 391.5,-32810.47 391.5,-32810.47 391.5,-32787.47 391.5,-32787.47 391.5,-32781.47 397.5,-32775.47 403.5,-32775.47 403.5,-32775.47 666.5,-32775.47 666.5,-32775.47 672.5,-32775.47 678.5,-32781.47 678.5,-32787.47 678.5,-32787.47 678.5,-32810.47 678.5,-32810.47 678.5,-32816.47 672.5,-32822.47 666.5,-32822.47"/>
<text text-anchor="middle" x="535" y="-32807.47" font-family="Arial" font-size="10.00">Layer 47 FFN2 GPU5</text>
<text text-anchor="middle" x="535" y="-32796.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="535" y="-32785.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer47_act_5&#45;&gt;layer47_ffn2_5 -->
<g id="edge772" class="edge">
<title>layer47_act_5&#45;&gt;layer47_ffn2_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M536.61,-32894.41C536.32,-32876.96 535.9,-32852.55 535.56,-32832.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="539.06,-32832.8 535.39,-32822.86 532.06,-32832.92 539.06,-32832.8"/>
</g>
<!-- layer47_ffn_ar -->
<g id="node678" class="node">
<title>layer47_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M503.22,-32703.47C503.22,-32703.47 297.8,-32703.47 297.8,-32703.47 291.8,-32703.47 282,-32698.83 278.19,-32694.19 278.19,-32694.19 234.39,-32640.75 234.39,-32640.75 230.59,-32636.11 232.78,-32631.47 238.78,-32631.47 238.78,-32631.47 444.2,-32631.47 444.2,-32631.47 450.2,-32631.47 460,-32636.11 463.81,-32640.75 463.81,-32640.75 507.61,-32694.19 507.61,-32694.19 511.41,-32698.83 509.22,-32703.47 503.22,-32703.47"/>
<text text-anchor="middle" x="371" y="-32670.47" font-family="Arial" font-size="10.00">Layer 47 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="371" y="-32659.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer47_ffn2_4&#45;&gt;layer47_ffn_ar -->
<g id="edge773" class="edge">
<title>layer47_ffn2_4&#45;&gt;layer47_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M238.04,-32775.41C260.43,-32757.41 292.4,-32731.69 319.38,-32709.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="321.61,-32712.68 327.21,-32703.69 317.23,-32707.23 321.61,-32712.68"/>
</g>
<!-- layer47_ffn2_5&#45;&gt;layer47_ffn_ar -->
<g id="edge774" class="edge">
<title>layer47_ffn2_5&#45;&gt;layer47_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M506.43,-32775.41C483.63,-32757.41 451.06,-32731.69 423.58,-32709.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="425.62,-32707.14 415.6,-32703.69 421.28,-32712.63 425.62,-32707.14"/>
</g>
<!-- layer48_qkv_4 -->
<g id="node679" class="node">
<title>layer48_qkv_4</title>
<path fill="#e6f3ff" stroke="black" d="M341,-32559.47C341,-32559.47 43,-32559.47 43,-32559.47 37,-32559.47 31,-32553.47 31,-32547.47 31,-32547.47 31,-32524.47 31,-32524.47 31,-32518.47 37,-32512.47 43,-32512.47 43,-32512.47 341,-32512.47 341,-32512.47 347,-32512.47 353,-32518.47 353,-32524.47 353,-32524.47 353,-32547.47 353,-32547.47 353,-32553.47 347,-32559.47 341,-32559.47"/>
<text text-anchor="middle" x="192" y="-32544.47" font-family="Arial" font-size="10.00">Layer 48 QKV Proj GPU4</text>
<text text-anchor="middle" x="192" y="-32533.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="192" y="-32522.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer47_ffn_ar&#45;&gt;layer48_qkv_4 -->
<g id="edge775" class="edge">
<title>layer47_ffn_ar&#45;&gt;layer48_qkv_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M322.56,-32631.42C294.06,-32610.81 258.48,-32585.06 231.66,-32565.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="233.43,-32562.62 223.28,-32559.6 229.33,-32568.3 233.43,-32562.62"/>
</g>
<!-- layer48_qkv_5 -->
<g id="node680" class="node">
<title>layer48_qkv_5</title>
<path fill="#e6f3ff" stroke="black" d="M699,-32559.47C699,-32559.47 401,-32559.47 401,-32559.47 395,-32559.47 389,-32553.47 389,-32547.47 389,-32547.47 389,-32524.47 389,-32524.47 389,-32518.47 395,-32512.47 401,-32512.47 401,-32512.47 699,-32512.47 699,-32512.47 705,-32512.47 711,-32518.47 711,-32524.47 711,-32524.47 711,-32547.47 711,-32547.47 711,-32553.47 705,-32559.47 699,-32559.47"/>
<text text-anchor="middle" x="550" y="-32544.47" font-family="Arial" font-size="10.00">Layer 48 QKV Proj GPU5</text>
<text text-anchor="middle" x="550" y="-32533.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-32522.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer47_ffn_ar&#45;&gt;layer48_qkv_5 -->
<g id="edge776" class="edge">
<title>layer47_ffn_ar&#45;&gt;layer48_qkv_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M419.44,-32631.42C447.94,-32610.81 483.52,-32585.06 510.34,-32565.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="512.67,-32568.3 518.72,-32559.6 508.57,-32562.62 512.67,-32568.3"/>
</g>
<!-- layer48_attn_4 -->
<g id="node681" class="node">
<title>layer48_attn_4</title>
<path fill="#e6f3ff" stroke="black" d="M341,-32440.47C341,-32440.47 43,-32440.47 43,-32440.47 37,-32440.47 31,-32434.47 31,-32428.47 31,-32428.47 31,-32405.47 31,-32405.47 31,-32399.47 37,-32393.47 43,-32393.47 43,-32393.47 341,-32393.47 341,-32393.47 347,-32393.47 353,-32399.47 353,-32405.47 353,-32405.47 353,-32428.47 353,-32428.47 353,-32434.47 347,-32440.47 341,-32440.47"/>
<text text-anchor="middle" x="192" y="-32425.47" font-family="Arial" font-size="10.00">Layer 48 Attention GPU4</text>
<text text-anchor="middle" x="192" y="-32414.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="192" y="-32403.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer48_qkv_4&#45;&gt;layer48_attn_4 -->
<g id="edge777" class="edge">
<title>layer48_qkv_4&#45;&gt;layer48_attn_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M192,-32512.41C192,-32494.96 192,-32470.55 192,-32450.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="195.5,-32450.86 192,-32440.86 188.5,-32450.86 195.5,-32450.86"/>
</g>
<!-- layer48_attn_5 -->
<g id="node682" class="node">
<title>layer48_attn_5</title>
<path fill="#e6f3ff" stroke="black" d="M699,-32440.47C699,-32440.47 401,-32440.47 401,-32440.47 395,-32440.47 389,-32434.47 389,-32428.47 389,-32428.47 389,-32405.47 389,-32405.47 389,-32399.47 395,-32393.47 401,-32393.47 401,-32393.47 699,-32393.47 699,-32393.47 705,-32393.47 711,-32399.47 711,-32405.47 711,-32405.47 711,-32428.47 711,-32428.47 711,-32434.47 705,-32440.47 699,-32440.47"/>
<text text-anchor="middle" x="550" y="-32425.47" font-family="Arial" font-size="10.00">Layer 48 Attention GPU5</text>
<text text-anchor="middle" x="550" y="-32414.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="550" y="-32403.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer48_qkv_5&#45;&gt;layer48_attn_5 -->
<g id="edge778" class="edge">
<title>layer48_qkv_5&#45;&gt;layer48_attn_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M550,-32512.41C550,-32494.96 550,-32470.55 550,-32450.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="553.5,-32450.86 550,-32440.86 546.5,-32450.86 553.5,-32450.86"/>
</g>
<!-- layer48_attn_out_4 -->
<g id="node683" class="node">
<title>layer48_attn_out_4</title>
<path fill="#e6f3ff" stroke="black" d="M341,-32321.47C341,-32321.47 51,-32321.47 51,-32321.47 45,-32321.47 39,-32315.47 39,-32309.47 39,-32309.47 39,-32286.47 39,-32286.47 39,-32280.47 45,-32274.47 51,-32274.47 51,-32274.47 341,-32274.47 341,-32274.47 347,-32274.47 353,-32280.47 353,-32286.47 353,-32286.47 353,-32309.47 353,-32309.47 353,-32315.47 347,-32321.47 341,-32321.47"/>
<text text-anchor="middle" x="196" y="-32306.47" font-family="Arial" font-size="10.00">Layer 48 Attn Out GPU4</text>
<text text-anchor="middle" x="196" y="-32295.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="196" y="-32284.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer48_attn_4&#45;&gt;layer48_attn_out_4 -->
<g id="edge779" class="edge">
<title>layer48_attn_4&#45;&gt;layer48_attn_out_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M192.77,-32393.41C193.37,-32375.96 194.2,-32351.55 194.87,-32331.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="198.37,-32331.97 195.22,-32321.86 191.38,-32331.73 198.37,-32331.97"/>
</g>
<!-- layer48_attn_out_5 -->
<g id="node684" class="node">
<title>layer48_attn_out_5</title>
<path fill="#e6f3ff" stroke="black" d="M693,-32321.47C693,-32321.47 403,-32321.47 403,-32321.47 397,-32321.47 391,-32315.47 391,-32309.47 391,-32309.47 391,-32286.47 391,-32286.47 391,-32280.47 397,-32274.47 403,-32274.47 403,-32274.47 693,-32274.47 693,-32274.47 699,-32274.47 705,-32280.47 705,-32286.47 705,-32286.47 705,-32309.47 705,-32309.47 705,-32315.47 699,-32321.47 693,-32321.47"/>
<text text-anchor="middle" x="548" y="-32306.47" font-family="Arial" font-size="10.00">Layer 48 Attn Out GPU5</text>
<text text-anchor="middle" x="548" y="-32295.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="548" y="-32284.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer48_attn_5&#45;&gt;layer48_attn_out_5 -->
<g id="edge780" class="edge">
<title>layer48_attn_5&#45;&gt;layer48_attn_out_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M549.61,-32393.41C549.32,-32375.96 548.9,-32351.55 548.56,-32331.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="552.06,-32331.8 548.39,-32321.86 545.06,-32331.92 552.06,-32331.8"/>
</g>
<!-- layer48_attn_ar -->
<g id="node685" class="node">
<title>layer48_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M501.07,-32202.47C501.07,-32202.47 299.07,-32202.47 299.07,-32202.47 293.07,-32202.47 283.3,-32197.8 279.53,-32193.13 279.53,-32193.13 236.47,-32139.8 236.47,-32139.8 232.7,-32135.14 234.93,-32130.47 240.93,-32130.47 240.93,-32130.47 442.93,-32130.47 442.93,-32130.47 448.93,-32130.47 458.7,-32135.14 462.47,-32139.8 462.47,-32139.8 505.53,-32193.13 505.53,-32193.13 509.3,-32197.8 507.07,-32202.47 501.07,-32202.47"/>
<text text-anchor="middle" x="371" y="-32169.47" font-family="Arial" font-size="10.00">Layer 48 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="371" y="-32158.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer48_attn_out_4&#45;&gt;layer48_attn_ar -->
<g id="edge781" class="edge">
<title>layer48_attn_out_4&#45;&gt;layer48_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M226.48,-32274.41C250.92,-32256.33 285.86,-32230.47 315.27,-32208.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="317.45,-32211.45 323.4,-32202.69 313.28,-32205.82 317.45,-32211.45"/>
</g>
<!-- layer48_attn_out_5&#45;&gt;layer48_attn_ar -->
<g id="edge782" class="edge">
<title>layer48_attn_out_5&#45;&gt;layer48_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M517.17,-32274.41C492.45,-32256.33 457.11,-32230.47 427.37,-32208.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="429.28,-32205.77 419.14,-32202.69 425.14,-32211.42 429.28,-32205.77"/>
</g>
<!-- layer48_ffn1_4 -->
<g id="node686" class="node">
<title>layer48_ffn1_4</title>
<path fill="#e6f3ff" stroke="black" d="M341,-32058.47C341,-32058.47 71,-32058.47 71,-32058.47 65,-32058.47 59,-32052.47 59,-32046.47 59,-32046.47 59,-32023.47 59,-32023.47 59,-32017.47 65,-32011.47 71,-32011.47 71,-32011.47 341,-32011.47 341,-32011.47 347,-32011.47 353,-32017.47 353,-32023.47 353,-32023.47 353,-32046.47 353,-32046.47 353,-32052.47 347,-32058.47 341,-32058.47"/>
<text text-anchor="middle" x="206" y="-32043.47" font-family="Arial" font-size="10.00">Layer 48 FFN1 GPU4</text>
<text text-anchor="middle" x="206" y="-32032.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="206" y="-32021.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer48_attn_ar&#45;&gt;layer48_ffn1_4 -->
<g id="edge783" class="edge">
<title>layer48_attn_ar&#45;&gt;layer48_ffn1_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M326.35,-32130.42C300.28,-32109.96 267.78,-32084.45 243.12,-32065.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="245.11,-32062.21 235.08,-32058.79 240.79,-32067.72 245.11,-32062.21"/>
</g>
<!-- layer48_ffn1_5 -->
<g id="node687" class="node">
<title>layer48_ffn1_5</title>
<path fill="#e6f3ff" stroke="black" d="M671,-32058.47C671,-32058.47 401,-32058.47 401,-32058.47 395,-32058.47 389,-32052.47 389,-32046.47 389,-32046.47 389,-32023.47 389,-32023.47 389,-32017.47 395,-32011.47 401,-32011.47 401,-32011.47 671,-32011.47 671,-32011.47 677,-32011.47 683,-32017.47 683,-32023.47 683,-32023.47 683,-32046.47 683,-32046.47 683,-32052.47 677,-32058.47 671,-32058.47"/>
<text text-anchor="middle" x="536" y="-32043.47" font-family="Arial" font-size="10.00">Layer 48 FFN1 GPU5</text>
<text text-anchor="middle" x="536" y="-32032.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="536" y="-32021.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer48_attn_ar&#45;&gt;layer48_ffn1_5 -->
<g id="edge784" class="edge">
<title>layer48_attn_ar&#45;&gt;layer48_ffn1_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M415.65,-32130.42C441.72,-32109.96 474.22,-32084.45 498.88,-32065.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="501.21,-32067.72 506.92,-32058.79 496.89,-32062.21 501.21,-32067.72"/>
</g>
<!-- layer48_act_4 -->
<g id="node688" class="node">
<title>layer48_act_4</title>
<path fill="#e6f3ff" stroke="black" d="M341,-31939.47C341,-31939.47 71,-31939.47 71,-31939.47 65,-31939.47 59,-31933.47 59,-31927.47 59,-31927.47 59,-31904.47 59,-31904.47 59,-31898.47 65,-31892.47 71,-31892.47 71,-31892.47 341,-31892.47 341,-31892.47 347,-31892.47 353,-31898.47 353,-31904.47 353,-31904.47 353,-31927.47 353,-31927.47 353,-31933.47 347,-31939.47 341,-31939.47"/>
<text text-anchor="middle" x="206" y="-31924.47" font-family="Arial" font-size="10.00">Layer 48 SiLU GPU4</text>
<text text-anchor="middle" x="206" y="-31913.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="206" y="-31902.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer48_ffn1_4&#45;&gt;layer48_act_4 -->
<g id="edge785" class="edge">
<title>layer48_ffn1_4&#45;&gt;layer48_act_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M206,-32011.41C206,-31993.96 206,-31969.55 206,-31949.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="209.5,-31949.86 206,-31939.86 202.5,-31949.86 209.5,-31949.86"/>
</g>
<!-- layer48_act_5 -->
<g id="node689" class="node">
<title>layer48_act_5</title>
<path fill="#e6f3ff" stroke="black" d="M671,-31939.47C671,-31939.47 401,-31939.47 401,-31939.47 395,-31939.47 389,-31933.47 389,-31927.47 389,-31927.47 389,-31904.47 389,-31904.47 389,-31898.47 395,-31892.47 401,-31892.47 401,-31892.47 671,-31892.47 671,-31892.47 677,-31892.47 683,-31898.47 683,-31904.47 683,-31904.47 683,-31927.47 683,-31927.47 683,-31933.47 677,-31939.47 671,-31939.47"/>
<text text-anchor="middle" x="536" y="-31924.47" font-family="Arial" font-size="10.00">Layer 48 SiLU GPU5</text>
<text text-anchor="middle" x="536" y="-31913.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="536" y="-31902.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer48_ffn1_5&#45;&gt;layer48_act_5 -->
<g id="edge786" class="edge">
<title>layer48_ffn1_5&#45;&gt;layer48_act_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M536,-32011.41C536,-31993.96 536,-31969.55 536,-31949.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="539.5,-31949.86 536,-31939.86 532.5,-31949.86 539.5,-31949.86"/>
</g>
<!-- layer48_ffn2_4 -->
<g id="node690" class="node">
<title>layer48_ffn2_4</title>
<path fill="#e6f3ff" stroke="black" d="M340.5,-31820.47C340.5,-31820.47 77.5,-31820.47 77.5,-31820.47 71.5,-31820.47 65.5,-31814.47 65.5,-31808.47 65.5,-31808.47 65.5,-31785.47 65.5,-31785.47 65.5,-31779.47 71.5,-31773.47 77.5,-31773.47 77.5,-31773.47 340.5,-31773.47 340.5,-31773.47 346.5,-31773.47 352.5,-31779.47 352.5,-31785.47 352.5,-31785.47 352.5,-31808.47 352.5,-31808.47 352.5,-31814.47 346.5,-31820.47 340.5,-31820.47"/>
<text text-anchor="middle" x="209" y="-31805.47" font-family="Arial" font-size="10.00">Layer 48 FFN2 GPU4</text>
<text text-anchor="middle" x="209" y="-31794.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="209" y="-31783.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer48_act_4&#45;&gt;layer48_ffn2_4 -->
<g id="edge787" class="edge">
<title>layer48_act_4&#45;&gt;layer48_ffn2_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M206.58,-31892.41C207.03,-31874.96 207.65,-31850.55 208.16,-31830.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="211.66,-31830.94 208.41,-31820.86 204.66,-31830.76 211.66,-31830.94"/>
</g>
<!-- layer48_ffn2_5 -->
<g id="node691" class="node">
<title>layer48_ffn2_5</title>
<path fill="#e6f3ff" stroke="black" d="M665.5,-31820.47C665.5,-31820.47 402.5,-31820.47 402.5,-31820.47 396.5,-31820.47 390.5,-31814.47 390.5,-31808.47 390.5,-31808.47 390.5,-31785.47 390.5,-31785.47 390.5,-31779.47 396.5,-31773.47 402.5,-31773.47 402.5,-31773.47 665.5,-31773.47 665.5,-31773.47 671.5,-31773.47 677.5,-31779.47 677.5,-31785.47 677.5,-31785.47 677.5,-31808.47 677.5,-31808.47 677.5,-31814.47 671.5,-31820.47 665.5,-31820.47"/>
<text text-anchor="middle" x="534" y="-31805.47" font-family="Arial" font-size="10.00">Layer 48 FFN2 GPU5</text>
<text text-anchor="middle" x="534" y="-31794.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="534" y="-31783.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer48_act_5&#45;&gt;layer48_ffn2_5 -->
<g id="edge788" class="edge">
<title>layer48_act_5&#45;&gt;layer48_ffn2_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M535.61,-31892.41C535.32,-31874.96 534.9,-31850.55 534.56,-31830.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="538.06,-31830.8 534.39,-31820.86 531.06,-31830.92 538.06,-31830.8"/>
</g>
<!-- layer48_ffn_ar -->
<g id="node692" class="node">
<title>layer48_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M502.22,-31701.47C502.22,-31701.47 296.8,-31701.47 296.8,-31701.47 290.8,-31701.47 281,-31696.83 277.19,-31692.19 277.19,-31692.19 233.39,-31638.75 233.39,-31638.75 229.59,-31634.11 231.78,-31629.47 237.78,-31629.47 237.78,-31629.47 443.2,-31629.47 443.2,-31629.47 449.2,-31629.47 459,-31634.11 462.81,-31638.75 462.81,-31638.75 506.61,-31692.19 506.61,-31692.19 510.41,-31696.83 508.22,-31701.47 502.22,-31701.47"/>
<text text-anchor="middle" x="370" y="-31668.47" font-family="Arial" font-size="10.00">Layer 48 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="370" y="-31657.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer48_ffn2_4&#45;&gt;layer48_ffn_ar -->
<g id="edge789" class="edge">
<title>layer48_ffn2_4&#45;&gt;layer48_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M237.04,-31773.41C259.43,-31755.41 291.4,-31729.69 318.38,-31707.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="320.61,-31710.68 326.21,-31701.69 316.23,-31705.23 320.61,-31710.68"/>
</g>
<!-- layer48_ffn2_5&#45;&gt;layer48_ffn_ar -->
<g id="edge790" class="edge">
<title>layer48_ffn2_5&#45;&gt;layer48_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M505.43,-31773.41C482.63,-31755.41 450.06,-31729.69 422.58,-31707.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="424.62,-31705.14 414.6,-31701.69 420.28,-31710.63 424.62,-31705.14"/>
</g>
<!-- layer49_qkv_4 -->
<g id="node693" class="node">
<title>layer49_qkv_4</title>
<path fill="#e6f3ff" stroke="black" d="M340,-31557.47C340,-31557.47 42,-31557.47 42,-31557.47 36,-31557.47 30,-31551.47 30,-31545.47 30,-31545.47 30,-31522.47 30,-31522.47 30,-31516.47 36,-31510.47 42,-31510.47 42,-31510.47 340,-31510.47 340,-31510.47 346,-31510.47 352,-31516.47 352,-31522.47 352,-31522.47 352,-31545.47 352,-31545.47 352,-31551.47 346,-31557.47 340,-31557.47"/>
<text text-anchor="middle" x="191" y="-31542.47" font-family="Arial" font-size="10.00">Layer 49 QKV Proj GPU4</text>
<text text-anchor="middle" x="191" y="-31531.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="191" y="-31520.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer48_ffn_ar&#45;&gt;layer49_qkv_4 -->
<g id="edge791" class="edge">
<title>layer48_ffn_ar&#45;&gt;layer49_qkv_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M321.56,-31629.42C293.06,-31608.81 257.48,-31583.06 230.66,-31563.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="232.43,-31560.62 222.28,-31557.6 228.33,-31566.3 232.43,-31560.62"/>
</g>
<!-- layer49_qkv_5 -->
<g id="node694" class="node">
<title>layer49_qkv_5</title>
<path fill="#e6f3ff" stroke="black" d="M698,-31557.47C698,-31557.47 400,-31557.47 400,-31557.47 394,-31557.47 388,-31551.47 388,-31545.47 388,-31545.47 388,-31522.47 388,-31522.47 388,-31516.47 394,-31510.47 400,-31510.47 400,-31510.47 698,-31510.47 698,-31510.47 704,-31510.47 710,-31516.47 710,-31522.47 710,-31522.47 710,-31545.47 710,-31545.47 710,-31551.47 704,-31557.47 698,-31557.47"/>
<text text-anchor="middle" x="549" y="-31542.47" font-family="Arial" font-size="10.00">Layer 49 QKV Proj GPU5</text>
<text text-anchor="middle" x="549" y="-31531.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-31520.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer48_ffn_ar&#45;&gt;layer49_qkv_5 -->
<g id="edge792" class="edge">
<title>layer48_ffn_ar&#45;&gt;layer49_qkv_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M418.44,-31629.42C446.94,-31608.81 482.52,-31583.06 509.34,-31563.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="511.67,-31566.3 517.72,-31557.6 507.57,-31560.62 511.67,-31566.3"/>
</g>
<!-- layer49_attn_4 -->
<g id="node695" class="node">
<title>layer49_attn_4</title>
<path fill="#e6f3ff" stroke="black" d="M340,-31438.47C340,-31438.47 42,-31438.47 42,-31438.47 36,-31438.47 30,-31432.47 30,-31426.47 30,-31426.47 30,-31403.47 30,-31403.47 30,-31397.47 36,-31391.47 42,-31391.47 42,-31391.47 340,-31391.47 340,-31391.47 346,-31391.47 352,-31397.47 352,-31403.47 352,-31403.47 352,-31426.47 352,-31426.47 352,-31432.47 346,-31438.47 340,-31438.47"/>
<text text-anchor="middle" x="191" y="-31423.47" font-family="Arial" font-size="10.00">Layer 49 Attention GPU4</text>
<text text-anchor="middle" x="191" y="-31412.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="191" y="-31401.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer49_qkv_4&#45;&gt;layer49_attn_4 -->
<g id="edge793" class="edge">
<title>layer49_qkv_4&#45;&gt;layer49_attn_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M191,-31510.41C191,-31492.96 191,-31468.55 191,-31448.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="194.5,-31448.86 191,-31438.86 187.5,-31448.86 194.5,-31448.86"/>
</g>
<!-- layer49_attn_5 -->
<g id="node696" class="node">
<title>layer49_attn_5</title>
<path fill="#e6f3ff" stroke="black" d="M698,-31438.47C698,-31438.47 400,-31438.47 400,-31438.47 394,-31438.47 388,-31432.47 388,-31426.47 388,-31426.47 388,-31403.47 388,-31403.47 388,-31397.47 394,-31391.47 400,-31391.47 400,-31391.47 698,-31391.47 698,-31391.47 704,-31391.47 710,-31397.47 710,-31403.47 710,-31403.47 710,-31426.47 710,-31426.47 710,-31432.47 704,-31438.47 698,-31438.47"/>
<text text-anchor="middle" x="549" y="-31423.47" font-family="Arial" font-size="10.00">Layer 49 Attention GPU5</text>
<text text-anchor="middle" x="549" y="-31412.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="549" y="-31401.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer49_qkv_5&#45;&gt;layer49_attn_5 -->
<g id="edge794" class="edge">
<title>layer49_qkv_5&#45;&gt;layer49_attn_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M549,-31510.41C549,-31492.96 549,-31468.55 549,-31448.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="552.5,-31448.86 549,-31438.86 545.5,-31448.86 552.5,-31448.86"/>
</g>
<!-- layer49_attn_out_4 -->
<g id="node697" class="node">
<title>layer49_attn_out_4</title>
<path fill="#e6f3ff" stroke="black" d="M340,-31319.47C340,-31319.47 50,-31319.47 50,-31319.47 44,-31319.47 38,-31313.47 38,-31307.47 38,-31307.47 38,-31284.47 38,-31284.47 38,-31278.47 44,-31272.47 50,-31272.47 50,-31272.47 340,-31272.47 340,-31272.47 346,-31272.47 352,-31278.47 352,-31284.47 352,-31284.47 352,-31307.47 352,-31307.47 352,-31313.47 346,-31319.47 340,-31319.47"/>
<text text-anchor="middle" x="195" y="-31304.47" font-family="Arial" font-size="10.00">Layer 49 Attn Out GPU4</text>
<text text-anchor="middle" x="195" y="-31293.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="195" y="-31282.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer49_attn_4&#45;&gt;layer49_attn_out_4 -->
<g id="edge795" class="edge">
<title>layer49_attn_4&#45;&gt;layer49_attn_out_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M191.77,-31391.41C192.37,-31373.96 193.2,-31349.55 193.87,-31329.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="197.37,-31329.97 194.22,-31319.86 190.38,-31329.73 197.37,-31329.97"/>
</g>
<!-- layer49_attn_out_5 -->
<g id="node698" class="node">
<title>layer49_attn_out_5</title>
<path fill="#e6f3ff" stroke="black" d="M692,-31319.47C692,-31319.47 402,-31319.47 402,-31319.47 396,-31319.47 390,-31313.47 390,-31307.47 390,-31307.47 390,-31284.47 390,-31284.47 390,-31278.47 396,-31272.47 402,-31272.47 402,-31272.47 692,-31272.47 692,-31272.47 698,-31272.47 704,-31278.47 704,-31284.47 704,-31284.47 704,-31307.47 704,-31307.47 704,-31313.47 698,-31319.47 692,-31319.47"/>
<text text-anchor="middle" x="547" y="-31304.47" font-family="Arial" font-size="10.00">Layer 49 Attn Out GPU5</text>
<text text-anchor="middle" x="547" y="-31293.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="547" y="-31282.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer49_attn_5&#45;&gt;layer49_attn_out_5 -->
<g id="edge796" class="edge">
<title>layer49_attn_5&#45;&gt;layer49_attn_out_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M548.61,-31391.41C548.32,-31373.96 547.9,-31349.55 547.56,-31329.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="551.06,-31329.8 547.39,-31319.86 544.06,-31329.92 551.06,-31329.8"/>
</g>
<!-- layer49_attn_ar -->
<g id="node699" class="node">
<title>layer49_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M500.07,-31200.47C500.07,-31200.47 298.07,-31200.47 298.07,-31200.47 292.07,-31200.47 282.3,-31195.8 278.53,-31191.13 278.53,-31191.13 235.47,-31137.8 235.47,-31137.8 231.7,-31133.14 233.93,-31128.47 239.93,-31128.47 239.93,-31128.47 441.93,-31128.47 441.93,-31128.47 447.93,-31128.47 457.7,-31133.14 461.47,-31137.8 461.47,-31137.8 504.53,-31191.13 504.53,-31191.13 508.3,-31195.8 506.07,-31200.47 500.07,-31200.47"/>
<text text-anchor="middle" x="370" y="-31167.47" font-family="Arial" font-size="10.00">Layer 49 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="370" y="-31156.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer49_attn_out_4&#45;&gt;layer49_attn_ar -->
<g id="edge797" class="edge">
<title>layer49_attn_out_4&#45;&gt;layer49_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M225.48,-31272.41C249.92,-31254.33 284.86,-31228.47 314.27,-31206.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="316.45,-31209.45 322.4,-31200.69 312.28,-31203.82 316.45,-31209.45"/>
</g>
<!-- layer49_attn_out_5&#45;&gt;layer49_attn_ar -->
<g id="edge798" class="edge">
<title>layer49_attn_out_5&#45;&gt;layer49_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M516.17,-31272.41C491.45,-31254.33 456.11,-31228.47 426.37,-31206.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="428.28,-31203.77 418.14,-31200.69 424.14,-31209.42 428.28,-31203.77"/>
</g>
<!-- layer49_ffn1_4 -->
<g id="node700" class="node">
<title>layer49_ffn1_4</title>
<path fill="#e6f3ff" stroke="black" d="M340,-31056.47C340,-31056.47 70,-31056.47 70,-31056.47 64,-31056.47 58,-31050.47 58,-31044.47 58,-31044.47 58,-31021.47 58,-31021.47 58,-31015.47 64,-31009.47 70,-31009.47 70,-31009.47 340,-31009.47 340,-31009.47 346,-31009.47 352,-31015.47 352,-31021.47 352,-31021.47 352,-31044.47 352,-31044.47 352,-31050.47 346,-31056.47 340,-31056.47"/>
<text text-anchor="middle" x="205" y="-31041.47" font-family="Arial" font-size="10.00">Layer 49 FFN1 GPU4</text>
<text text-anchor="middle" x="205" y="-31030.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="205" y="-31019.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer49_attn_ar&#45;&gt;layer49_ffn1_4 -->
<g id="edge799" class="edge">
<title>layer49_attn_ar&#45;&gt;layer49_ffn1_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M325.35,-31128.42C299.28,-31107.96 266.78,-31082.45 242.12,-31063.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="244.11,-31060.21 234.08,-31056.79 239.79,-31065.72 244.11,-31060.21"/>
</g>
<!-- layer49_ffn1_5 -->
<g id="node701" class="node">
<title>layer49_ffn1_5</title>
<path fill="#e6f3ff" stroke="black" d="M670,-31056.47C670,-31056.47 400,-31056.47 400,-31056.47 394,-31056.47 388,-31050.47 388,-31044.47 388,-31044.47 388,-31021.47 388,-31021.47 388,-31015.47 394,-31009.47 400,-31009.47 400,-31009.47 670,-31009.47 670,-31009.47 676,-31009.47 682,-31015.47 682,-31021.47 682,-31021.47 682,-31044.47 682,-31044.47 682,-31050.47 676,-31056.47 670,-31056.47"/>
<text text-anchor="middle" x="535" y="-31041.47" font-family="Arial" font-size="10.00">Layer 49 FFN1 GPU5</text>
<text text-anchor="middle" x="535" y="-31030.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="535" y="-31019.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer49_attn_ar&#45;&gt;layer49_ffn1_5 -->
<g id="edge800" class="edge">
<title>layer49_attn_ar&#45;&gt;layer49_ffn1_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M414.65,-31128.42C440.72,-31107.96 473.22,-31082.45 497.88,-31063.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="500.21,-31065.72 505.92,-31056.79 495.89,-31060.21 500.21,-31065.72"/>
</g>
<!-- layer49_act_4 -->
<g id="node702" class="node">
<title>layer49_act_4</title>
<path fill="#e6f3ff" stroke="black" d="M340,-30937.47C340,-30937.47 70,-30937.47 70,-30937.47 64,-30937.47 58,-30931.47 58,-30925.47 58,-30925.47 58,-30902.47 58,-30902.47 58,-30896.47 64,-30890.47 70,-30890.47 70,-30890.47 340,-30890.47 340,-30890.47 346,-30890.47 352,-30896.47 352,-30902.47 352,-30902.47 352,-30925.47 352,-30925.47 352,-30931.47 346,-30937.47 340,-30937.47"/>
<text text-anchor="middle" x="205" y="-30922.47" font-family="Arial" font-size="10.00">Layer 49 SiLU GPU4</text>
<text text-anchor="middle" x="205" y="-30911.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="205" y="-30900.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer49_ffn1_4&#45;&gt;layer49_act_4 -->
<g id="edge801" class="edge">
<title>layer49_ffn1_4&#45;&gt;layer49_act_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M205,-31009.41C205,-30991.96 205,-30967.55 205,-30947.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="208.5,-30947.86 205,-30937.86 201.5,-30947.86 208.5,-30947.86"/>
</g>
<!-- layer49_act_5 -->
<g id="node703" class="node">
<title>layer49_act_5</title>
<path fill="#e6f3ff" stroke="black" d="M670,-30937.47C670,-30937.47 400,-30937.47 400,-30937.47 394,-30937.47 388,-30931.47 388,-30925.47 388,-30925.47 388,-30902.47 388,-30902.47 388,-30896.47 394,-30890.47 400,-30890.47 400,-30890.47 670,-30890.47 670,-30890.47 676,-30890.47 682,-30896.47 682,-30902.47 682,-30902.47 682,-30925.47 682,-30925.47 682,-30931.47 676,-30937.47 670,-30937.47"/>
<text text-anchor="middle" x="535" y="-30922.47" font-family="Arial" font-size="10.00">Layer 49 SiLU GPU5</text>
<text text-anchor="middle" x="535" y="-30911.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="535" y="-30900.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer49_ffn1_5&#45;&gt;layer49_act_5 -->
<g id="edge802" class="edge">
<title>layer49_ffn1_5&#45;&gt;layer49_act_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M535,-31009.41C535,-30991.96 535,-30967.55 535,-30947.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="538.5,-30947.86 535,-30937.86 531.5,-30947.86 538.5,-30947.86"/>
</g>
<!-- layer49_ffn2_4 -->
<g id="node704" class="node">
<title>layer49_ffn2_4</title>
<path fill="#e6f3ff" stroke="black" d="M339.5,-30818.47C339.5,-30818.47 76.5,-30818.47 76.5,-30818.47 70.5,-30818.47 64.5,-30812.47 64.5,-30806.47 64.5,-30806.47 64.5,-30783.47 64.5,-30783.47 64.5,-30777.47 70.5,-30771.47 76.5,-30771.47 76.5,-30771.47 339.5,-30771.47 339.5,-30771.47 345.5,-30771.47 351.5,-30777.47 351.5,-30783.47 351.5,-30783.47 351.5,-30806.47 351.5,-30806.47 351.5,-30812.47 345.5,-30818.47 339.5,-30818.47"/>
<text text-anchor="middle" x="208" y="-30803.47" font-family="Arial" font-size="10.00">Layer 49 FFN2 GPU4</text>
<text text-anchor="middle" x="208" y="-30792.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="208" y="-30781.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer49_act_4&#45;&gt;layer49_ffn2_4 -->
<g id="edge803" class="edge">
<title>layer49_act_4&#45;&gt;layer49_ffn2_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M205.58,-30890.41C206.03,-30872.96 206.65,-30848.55 207.16,-30828.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="210.66,-30828.94 207.41,-30818.86 203.66,-30828.76 210.66,-30828.94"/>
</g>
<!-- layer49_ffn2_5 -->
<g id="node705" class="node">
<title>layer49_ffn2_5</title>
<path fill="#e6f3ff" stroke="black" d="M664.5,-30818.47C664.5,-30818.47 401.5,-30818.47 401.5,-30818.47 395.5,-30818.47 389.5,-30812.47 389.5,-30806.47 389.5,-30806.47 389.5,-30783.47 389.5,-30783.47 389.5,-30777.47 395.5,-30771.47 401.5,-30771.47 401.5,-30771.47 664.5,-30771.47 664.5,-30771.47 670.5,-30771.47 676.5,-30777.47 676.5,-30783.47 676.5,-30783.47 676.5,-30806.47 676.5,-30806.47 676.5,-30812.47 670.5,-30818.47 664.5,-30818.47"/>
<text text-anchor="middle" x="533" y="-30803.47" font-family="Arial" font-size="10.00">Layer 49 FFN2 GPU5</text>
<text text-anchor="middle" x="533" y="-30792.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="533" y="-30781.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer49_act_5&#45;&gt;layer49_ffn2_5 -->
<g id="edge804" class="edge">
<title>layer49_act_5&#45;&gt;layer49_ffn2_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M534.61,-30890.41C534.32,-30872.96 533.9,-30848.55 533.56,-30828.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="537.06,-30828.8 533.39,-30818.86 530.06,-30828.92 537.06,-30828.8"/>
</g>
<!-- layer49_ffn_ar -->
<g id="node706" class="node">
<title>layer49_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M501.22,-30699.47C501.22,-30699.47 295.8,-30699.47 295.8,-30699.47 289.8,-30699.47 280,-30694.83 276.19,-30690.19 276.19,-30690.19 232.39,-30636.75 232.39,-30636.75 228.59,-30632.11 230.78,-30627.47 236.78,-30627.47 236.78,-30627.47 442.2,-30627.47 442.2,-30627.47 448.2,-30627.47 458,-30632.11 461.81,-30636.75 461.81,-30636.75 505.61,-30690.19 505.61,-30690.19 509.41,-30694.83 507.22,-30699.47 501.22,-30699.47"/>
<text text-anchor="middle" x="369" y="-30666.47" font-family="Arial" font-size="10.00">Layer 49 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="369" y="-30655.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer49_ffn2_4&#45;&gt;layer49_ffn_ar -->
<g id="edge805" class="edge">
<title>layer49_ffn2_4&#45;&gt;layer49_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M236.04,-30771.41C258.43,-30753.41 290.4,-30727.69 317.38,-30705.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="319.61,-30708.68 325.21,-30699.69 315.23,-30703.23 319.61,-30708.68"/>
</g>
<!-- layer49_ffn2_5&#45;&gt;layer49_ffn_ar -->
<g id="edge806" class="edge">
<title>layer49_ffn2_5&#45;&gt;layer49_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M504.43,-30771.41C481.63,-30753.41 449.06,-30727.69 421.58,-30705.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="423.62,-30703.14 413.6,-30699.69 419.28,-30708.63 423.62,-30703.14"/>
</g>
<!-- layer50_qkv_4 -->
<g id="node707" class="node">
<title>layer50_qkv_4</title>
<path fill="#e6f3ff" stroke="black" d="M339,-30555.47C339,-30555.47 41,-30555.47 41,-30555.47 35,-30555.47 29,-30549.47 29,-30543.47 29,-30543.47 29,-30520.47 29,-30520.47 29,-30514.47 35,-30508.47 41,-30508.47 41,-30508.47 339,-30508.47 339,-30508.47 345,-30508.47 351,-30514.47 351,-30520.47 351,-30520.47 351,-30543.47 351,-30543.47 351,-30549.47 345,-30555.47 339,-30555.47"/>
<text text-anchor="middle" x="190" y="-30540.47" font-family="Arial" font-size="10.00">Layer 50 QKV Proj GPU4</text>
<text text-anchor="middle" x="190" y="-30529.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="190" y="-30518.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer49_ffn_ar&#45;&gt;layer50_qkv_4 -->
<g id="edge807" class="edge">
<title>layer49_ffn_ar&#45;&gt;layer50_qkv_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M320.56,-30627.42C292.06,-30606.81 256.48,-30581.06 229.66,-30561.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="231.43,-30558.62 221.28,-30555.6 227.33,-30564.3 231.43,-30558.62"/>
</g>
<!-- layer50_qkv_5 -->
<g id="node708" class="node">
<title>layer50_qkv_5</title>
<path fill="#e6f3ff" stroke="black" d="M697,-30555.47C697,-30555.47 399,-30555.47 399,-30555.47 393,-30555.47 387,-30549.47 387,-30543.47 387,-30543.47 387,-30520.47 387,-30520.47 387,-30514.47 393,-30508.47 399,-30508.47 399,-30508.47 697,-30508.47 697,-30508.47 703,-30508.47 709,-30514.47 709,-30520.47 709,-30520.47 709,-30543.47 709,-30543.47 709,-30549.47 703,-30555.47 697,-30555.47"/>
<text text-anchor="middle" x="548" y="-30540.47" font-family="Arial" font-size="10.00">Layer 50 QKV Proj GPU5</text>
<text text-anchor="middle" x="548" y="-30529.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="548" y="-30518.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer49_ffn_ar&#45;&gt;layer50_qkv_5 -->
<g id="edge808" class="edge">
<title>layer49_ffn_ar&#45;&gt;layer50_qkv_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M417.44,-30627.42C445.94,-30606.81 481.52,-30581.06 508.34,-30561.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="510.67,-30564.3 516.72,-30555.6 506.57,-30558.62 510.67,-30564.3"/>
</g>
<!-- layer50_attn_4 -->
<g id="node709" class="node">
<title>layer50_attn_4</title>
<path fill="#e6f3ff" stroke="black" d="M339,-30436.47C339,-30436.47 41,-30436.47 41,-30436.47 35,-30436.47 29,-30430.47 29,-30424.47 29,-30424.47 29,-30401.47 29,-30401.47 29,-30395.47 35,-30389.47 41,-30389.47 41,-30389.47 339,-30389.47 339,-30389.47 345,-30389.47 351,-30395.47 351,-30401.47 351,-30401.47 351,-30424.47 351,-30424.47 351,-30430.47 345,-30436.47 339,-30436.47"/>
<text text-anchor="middle" x="190" y="-30421.47" font-family="Arial" font-size="10.00">Layer 50 Attention GPU4</text>
<text text-anchor="middle" x="190" y="-30410.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="190" y="-30399.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer50_qkv_4&#45;&gt;layer50_attn_4 -->
<g id="edge809" class="edge">
<title>layer50_qkv_4&#45;&gt;layer50_attn_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M190,-30508.41C190,-30490.96 190,-30466.55 190,-30446.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="193.5,-30446.86 190,-30436.86 186.5,-30446.86 193.5,-30446.86"/>
</g>
<!-- layer50_attn_5 -->
<g id="node710" class="node">
<title>layer50_attn_5</title>
<path fill="#e6f3ff" stroke="black" d="M697,-30436.47C697,-30436.47 399,-30436.47 399,-30436.47 393,-30436.47 387,-30430.47 387,-30424.47 387,-30424.47 387,-30401.47 387,-30401.47 387,-30395.47 393,-30389.47 399,-30389.47 399,-30389.47 697,-30389.47 697,-30389.47 703,-30389.47 709,-30395.47 709,-30401.47 709,-30401.47 709,-30424.47 709,-30424.47 709,-30430.47 703,-30436.47 697,-30436.47"/>
<text text-anchor="middle" x="548" y="-30421.47" font-family="Arial" font-size="10.00">Layer 50 Attention GPU5</text>
<text text-anchor="middle" x="548" y="-30410.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="548" y="-30399.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer50_qkv_5&#45;&gt;layer50_attn_5 -->
<g id="edge810" class="edge">
<title>layer50_qkv_5&#45;&gt;layer50_attn_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M548,-30508.41C548,-30490.96 548,-30466.55 548,-30446.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="551.5,-30446.86 548,-30436.86 544.5,-30446.86 551.5,-30446.86"/>
</g>
<!-- layer50_attn_out_4 -->
<g id="node711" class="node">
<title>layer50_attn_out_4</title>
<path fill="#e6f3ff" stroke="black" d="M339,-30317.47C339,-30317.47 49,-30317.47 49,-30317.47 43,-30317.47 37,-30311.47 37,-30305.47 37,-30305.47 37,-30282.47 37,-30282.47 37,-30276.47 43,-30270.47 49,-30270.47 49,-30270.47 339,-30270.47 339,-30270.47 345,-30270.47 351,-30276.47 351,-30282.47 351,-30282.47 351,-30305.47 351,-30305.47 351,-30311.47 345,-30317.47 339,-30317.47"/>
<text text-anchor="middle" x="194" y="-30302.47" font-family="Arial" font-size="10.00">Layer 50 Attn Out GPU4</text>
<text text-anchor="middle" x="194" y="-30291.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="194" y="-30280.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer50_attn_4&#45;&gt;layer50_attn_out_4 -->
<g id="edge811" class="edge">
<title>layer50_attn_4&#45;&gt;layer50_attn_out_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M190.77,-30389.41C191.37,-30371.96 192.2,-30347.55 192.87,-30327.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="196.37,-30327.97 193.22,-30317.86 189.38,-30327.73 196.37,-30327.97"/>
</g>
<!-- layer50_attn_out_5 -->
<g id="node712" class="node">
<title>layer50_attn_out_5</title>
<path fill="#e6f3ff" stroke="black" d="M691,-30317.47C691,-30317.47 401,-30317.47 401,-30317.47 395,-30317.47 389,-30311.47 389,-30305.47 389,-30305.47 389,-30282.47 389,-30282.47 389,-30276.47 395,-30270.47 401,-30270.47 401,-30270.47 691,-30270.47 691,-30270.47 697,-30270.47 703,-30276.47 703,-30282.47 703,-30282.47 703,-30305.47 703,-30305.47 703,-30311.47 697,-30317.47 691,-30317.47"/>
<text text-anchor="middle" x="546" y="-30302.47" font-family="Arial" font-size="10.00">Layer 50 Attn Out GPU5</text>
<text text-anchor="middle" x="546" y="-30291.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="546" y="-30280.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer50_attn_5&#45;&gt;layer50_attn_out_5 -->
<g id="edge812" class="edge">
<title>layer50_attn_5&#45;&gt;layer50_attn_out_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M547.61,-30389.41C547.32,-30371.96 546.9,-30347.55 546.56,-30327.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="550.06,-30327.8 546.39,-30317.86 543.06,-30327.92 550.06,-30327.8"/>
</g>
<!-- layer50_attn_ar -->
<g id="node713" class="node">
<title>layer50_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M499.07,-30198.47C499.07,-30198.47 297.07,-30198.47 297.07,-30198.47 291.07,-30198.47 281.3,-30193.8 277.53,-30189.13 277.53,-30189.13 234.47,-30135.8 234.47,-30135.8 230.7,-30131.14 232.93,-30126.47 238.93,-30126.47 238.93,-30126.47 440.93,-30126.47 440.93,-30126.47 446.93,-30126.47 456.7,-30131.14 460.47,-30135.8 460.47,-30135.8 503.53,-30189.13 503.53,-30189.13 507.3,-30193.8 505.07,-30198.47 499.07,-30198.47"/>
<text text-anchor="middle" x="369" y="-30165.47" font-family="Arial" font-size="10.00">Layer 50 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="369" y="-30154.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer50_attn_out_4&#45;&gt;layer50_attn_ar -->
<g id="edge813" class="edge">
<title>layer50_attn_out_4&#45;&gt;layer50_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M224.48,-30270.41C248.92,-30252.33 283.86,-30226.47 313.27,-30204.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="315.45,-30207.45 321.4,-30198.69 311.28,-30201.82 315.45,-30207.45"/>
</g>
<!-- layer50_attn_out_5&#45;&gt;layer50_attn_ar -->
<g id="edge814" class="edge">
<title>layer50_attn_out_5&#45;&gt;layer50_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M515.17,-30270.41C490.45,-30252.33 455.11,-30226.47 425.37,-30204.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="427.28,-30201.77 417.14,-30198.69 423.14,-30207.42 427.28,-30201.77"/>
</g>
<!-- layer50_ffn1_4 -->
<g id="node714" class="node">
<title>layer50_ffn1_4</title>
<path fill="#e6f3ff" stroke="black" d="M339,-30054.47C339,-30054.47 69,-30054.47 69,-30054.47 63,-30054.47 57,-30048.47 57,-30042.47 57,-30042.47 57,-30019.47 57,-30019.47 57,-30013.47 63,-30007.47 69,-30007.47 69,-30007.47 339,-30007.47 339,-30007.47 345,-30007.47 351,-30013.47 351,-30019.47 351,-30019.47 351,-30042.47 351,-30042.47 351,-30048.47 345,-30054.47 339,-30054.47"/>
<text text-anchor="middle" x="204" y="-30039.47" font-family="Arial" font-size="10.00">Layer 50 FFN1 GPU4</text>
<text text-anchor="middle" x="204" y="-30028.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="204" y="-30017.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer50_attn_ar&#45;&gt;layer50_ffn1_4 -->
<g id="edge815" class="edge">
<title>layer50_attn_ar&#45;&gt;layer50_ffn1_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M324.35,-30126.42C298.28,-30105.96 265.78,-30080.45 241.12,-30061.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="243.11,-30058.21 233.08,-30054.79 238.79,-30063.72 243.11,-30058.21"/>
</g>
<!-- layer50_ffn1_5 -->
<g id="node715" class="node">
<title>layer50_ffn1_5</title>
<path fill="#e6f3ff" stroke="black" d="M669,-30054.47C669,-30054.47 399,-30054.47 399,-30054.47 393,-30054.47 387,-30048.47 387,-30042.47 387,-30042.47 387,-30019.47 387,-30019.47 387,-30013.47 393,-30007.47 399,-30007.47 399,-30007.47 669,-30007.47 669,-30007.47 675,-30007.47 681,-30013.47 681,-30019.47 681,-30019.47 681,-30042.47 681,-30042.47 681,-30048.47 675,-30054.47 669,-30054.47"/>
<text text-anchor="middle" x="534" y="-30039.47" font-family="Arial" font-size="10.00">Layer 50 FFN1 GPU5</text>
<text text-anchor="middle" x="534" y="-30028.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="534" y="-30017.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer50_attn_ar&#45;&gt;layer50_ffn1_5 -->
<g id="edge816" class="edge">
<title>layer50_attn_ar&#45;&gt;layer50_ffn1_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M413.65,-30126.42C439.72,-30105.96 472.22,-30080.45 496.88,-30061.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="499.21,-30063.72 504.92,-30054.79 494.89,-30058.21 499.21,-30063.72"/>
</g>
<!-- layer50_act_4 -->
<g id="node716" class="node">
<title>layer50_act_4</title>
<path fill="#e6f3ff" stroke="black" d="M339,-29935.47C339,-29935.47 69,-29935.47 69,-29935.47 63,-29935.47 57,-29929.47 57,-29923.47 57,-29923.47 57,-29900.47 57,-29900.47 57,-29894.47 63,-29888.47 69,-29888.47 69,-29888.47 339,-29888.47 339,-29888.47 345,-29888.47 351,-29894.47 351,-29900.47 351,-29900.47 351,-29923.47 351,-29923.47 351,-29929.47 345,-29935.47 339,-29935.47"/>
<text text-anchor="middle" x="204" y="-29920.47" font-family="Arial" font-size="10.00">Layer 50 SiLU GPU4</text>
<text text-anchor="middle" x="204" y="-29909.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="204" y="-29898.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer50_ffn1_4&#45;&gt;layer50_act_4 -->
<g id="edge817" class="edge">
<title>layer50_ffn1_4&#45;&gt;layer50_act_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M204,-30007.41C204,-29989.96 204,-29965.55 204,-29945.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="207.5,-29945.86 204,-29935.86 200.5,-29945.86 207.5,-29945.86"/>
</g>
<!-- layer50_act_5 -->
<g id="node717" class="node">
<title>layer50_act_5</title>
<path fill="#e6f3ff" stroke="black" d="M669,-29935.47C669,-29935.47 399,-29935.47 399,-29935.47 393,-29935.47 387,-29929.47 387,-29923.47 387,-29923.47 387,-29900.47 387,-29900.47 387,-29894.47 393,-29888.47 399,-29888.47 399,-29888.47 669,-29888.47 669,-29888.47 675,-29888.47 681,-29894.47 681,-29900.47 681,-29900.47 681,-29923.47 681,-29923.47 681,-29929.47 675,-29935.47 669,-29935.47"/>
<text text-anchor="middle" x="534" y="-29920.47" font-family="Arial" font-size="10.00">Layer 50 SiLU GPU5</text>
<text text-anchor="middle" x="534" y="-29909.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="534" y="-29898.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer50_ffn1_5&#45;&gt;layer50_act_5 -->
<g id="edge818" class="edge">
<title>layer50_ffn1_5&#45;&gt;layer50_act_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M534,-30007.41C534,-29989.96 534,-29965.55 534,-29945.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="537.5,-29945.86 534,-29935.86 530.5,-29945.86 537.5,-29945.86"/>
</g>
<!-- layer50_ffn2_4 -->
<g id="node718" class="node">
<title>layer50_ffn2_4</title>
<path fill="#e6f3ff" stroke="black" d="M338.5,-29816.47C338.5,-29816.47 75.5,-29816.47 75.5,-29816.47 69.5,-29816.47 63.5,-29810.47 63.5,-29804.47 63.5,-29804.47 63.5,-29781.47 63.5,-29781.47 63.5,-29775.47 69.5,-29769.47 75.5,-29769.47 75.5,-29769.47 338.5,-29769.47 338.5,-29769.47 344.5,-29769.47 350.5,-29775.47 350.5,-29781.47 350.5,-29781.47 350.5,-29804.47 350.5,-29804.47 350.5,-29810.47 344.5,-29816.47 338.5,-29816.47"/>
<text text-anchor="middle" x="207" y="-29801.47" font-family="Arial" font-size="10.00">Layer 50 FFN2 GPU4</text>
<text text-anchor="middle" x="207" y="-29790.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="207" y="-29779.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer50_act_4&#45;&gt;layer50_ffn2_4 -->
<g id="edge819" class="edge">
<title>layer50_act_4&#45;&gt;layer50_ffn2_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M204.58,-29888.41C205.03,-29870.96 205.65,-29846.55 206.16,-29826.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="209.66,-29826.94 206.41,-29816.86 202.66,-29826.76 209.66,-29826.94"/>
</g>
<!-- layer50_ffn2_5 -->
<g id="node719" class="node">
<title>layer50_ffn2_5</title>
<path fill="#e6f3ff" stroke="black" d="M663.5,-29816.47C663.5,-29816.47 400.5,-29816.47 400.5,-29816.47 394.5,-29816.47 388.5,-29810.47 388.5,-29804.47 388.5,-29804.47 388.5,-29781.47 388.5,-29781.47 388.5,-29775.47 394.5,-29769.47 400.5,-29769.47 400.5,-29769.47 663.5,-29769.47 663.5,-29769.47 669.5,-29769.47 675.5,-29775.47 675.5,-29781.47 675.5,-29781.47 675.5,-29804.47 675.5,-29804.47 675.5,-29810.47 669.5,-29816.47 663.5,-29816.47"/>
<text text-anchor="middle" x="532" y="-29801.47" font-family="Arial" font-size="10.00">Layer 50 FFN2 GPU5</text>
<text text-anchor="middle" x="532" y="-29790.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="532" y="-29779.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer50_act_5&#45;&gt;layer50_ffn2_5 -->
<g id="edge820" class="edge">
<title>layer50_act_5&#45;&gt;layer50_ffn2_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M533.61,-29888.41C533.32,-29870.96 532.9,-29846.55 532.56,-29826.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="536.06,-29826.8 532.39,-29816.86 529.06,-29826.92 536.06,-29826.8"/>
</g>
<!-- layer50_ffn_ar -->
<g id="node720" class="node">
<title>layer50_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M500.22,-29697.47C500.22,-29697.47 294.8,-29697.47 294.8,-29697.47 288.8,-29697.47 279,-29692.83 275.19,-29688.19 275.19,-29688.19 231.39,-29634.75 231.39,-29634.75 227.59,-29630.11 229.78,-29625.47 235.78,-29625.47 235.78,-29625.47 441.2,-29625.47 441.2,-29625.47 447.2,-29625.47 457,-29630.11 460.81,-29634.75 460.81,-29634.75 504.61,-29688.19 504.61,-29688.19 508.41,-29692.83 506.22,-29697.47 500.22,-29697.47"/>
<text text-anchor="middle" x="368" y="-29664.47" font-family="Arial" font-size="10.00">Layer 50 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="368" y="-29653.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer50_ffn2_4&#45;&gt;layer50_ffn_ar -->
<g id="edge821" class="edge">
<title>layer50_ffn2_4&#45;&gt;layer50_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M235.04,-29769.41C257.43,-29751.41 289.4,-29725.69 316.38,-29703.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="318.61,-29706.68 324.21,-29697.69 314.23,-29701.23 318.61,-29706.68"/>
</g>
<!-- layer50_ffn2_5&#45;&gt;layer50_ffn_ar -->
<g id="edge822" class="edge">
<title>layer50_ffn2_5&#45;&gt;layer50_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M503.43,-29769.41C480.63,-29751.41 448.06,-29725.69 420.58,-29703.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="422.62,-29701.14 412.6,-29697.69 418.28,-29706.63 422.62,-29701.14"/>
</g>
<!-- layer51_qkv_4 -->
<g id="node721" class="node">
<title>layer51_qkv_4</title>
<path fill="#e6f3ff" stroke="black" d="M338,-29553.47C338,-29553.47 40,-29553.47 40,-29553.47 34,-29553.47 28,-29547.47 28,-29541.47 28,-29541.47 28,-29518.47 28,-29518.47 28,-29512.47 34,-29506.47 40,-29506.47 40,-29506.47 338,-29506.47 338,-29506.47 344,-29506.47 350,-29512.47 350,-29518.47 350,-29518.47 350,-29541.47 350,-29541.47 350,-29547.47 344,-29553.47 338,-29553.47"/>
<text text-anchor="middle" x="189" y="-29538.47" font-family="Arial" font-size="10.00">Layer 51 QKV Proj GPU4</text>
<text text-anchor="middle" x="189" y="-29527.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="189" y="-29516.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer50_ffn_ar&#45;&gt;layer51_qkv_4 -->
<g id="edge823" class="edge">
<title>layer50_ffn_ar&#45;&gt;layer51_qkv_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M319.56,-29625.42C291.06,-29604.81 255.48,-29579.06 228.66,-29559.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="230.43,-29556.62 220.28,-29553.6 226.33,-29562.3 230.43,-29556.62"/>
</g>
<!-- layer51_qkv_5 -->
<g id="node722" class="node">
<title>layer51_qkv_5</title>
<path fill="#e6f3ff" stroke="black" d="M696,-29553.47C696,-29553.47 398,-29553.47 398,-29553.47 392,-29553.47 386,-29547.47 386,-29541.47 386,-29541.47 386,-29518.47 386,-29518.47 386,-29512.47 392,-29506.47 398,-29506.47 398,-29506.47 696,-29506.47 696,-29506.47 702,-29506.47 708,-29512.47 708,-29518.47 708,-29518.47 708,-29541.47 708,-29541.47 708,-29547.47 702,-29553.47 696,-29553.47"/>
<text text-anchor="middle" x="547" y="-29538.47" font-family="Arial" font-size="10.00">Layer 51 QKV Proj GPU5</text>
<text text-anchor="middle" x="547" y="-29527.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="547" y="-29516.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer50_ffn_ar&#45;&gt;layer51_qkv_5 -->
<g id="edge824" class="edge">
<title>layer50_ffn_ar&#45;&gt;layer51_qkv_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M416.44,-29625.42C444.94,-29604.81 480.52,-29579.06 507.34,-29559.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="509.67,-29562.3 515.72,-29553.6 505.57,-29556.62 509.67,-29562.3"/>
</g>
<!-- layer51_attn_4 -->
<g id="node723" class="node">
<title>layer51_attn_4</title>
<path fill="#e6f3ff" stroke="black" d="M338,-29434.47C338,-29434.47 40,-29434.47 40,-29434.47 34,-29434.47 28,-29428.47 28,-29422.47 28,-29422.47 28,-29399.47 28,-29399.47 28,-29393.47 34,-29387.47 40,-29387.47 40,-29387.47 338,-29387.47 338,-29387.47 344,-29387.47 350,-29393.47 350,-29399.47 350,-29399.47 350,-29422.47 350,-29422.47 350,-29428.47 344,-29434.47 338,-29434.47"/>
<text text-anchor="middle" x="189" y="-29419.47" font-family="Arial" font-size="10.00">Layer 51 Attention GPU4</text>
<text text-anchor="middle" x="189" y="-29408.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="189" y="-29397.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer51_qkv_4&#45;&gt;layer51_attn_4 -->
<g id="edge825" class="edge">
<title>layer51_qkv_4&#45;&gt;layer51_attn_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M189,-29506.41C189,-29488.96 189,-29464.55 189,-29444.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="192.5,-29444.86 189,-29434.86 185.5,-29444.86 192.5,-29444.86"/>
</g>
<!-- layer51_attn_5 -->
<g id="node724" class="node">
<title>layer51_attn_5</title>
<path fill="#e6f3ff" stroke="black" d="M696,-29434.47C696,-29434.47 398,-29434.47 398,-29434.47 392,-29434.47 386,-29428.47 386,-29422.47 386,-29422.47 386,-29399.47 386,-29399.47 386,-29393.47 392,-29387.47 398,-29387.47 398,-29387.47 696,-29387.47 696,-29387.47 702,-29387.47 708,-29393.47 708,-29399.47 708,-29399.47 708,-29422.47 708,-29422.47 708,-29428.47 702,-29434.47 696,-29434.47"/>
<text text-anchor="middle" x="547" y="-29419.47" font-family="Arial" font-size="10.00">Layer 51 Attention GPU5</text>
<text text-anchor="middle" x="547" y="-29408.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="547" y="-29397.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer51_qkv_5&#45;&gt;layer51_attn_5 -->
<g id="edge826" class="edge">
<title>layer51_qkv_5&#45;&gt;layer51_attn_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M547,-29506.41C547,-29488.96 547,-29464.55 547,-29444.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="550.5,-29444.86 547,-29434.86 543.5,-29444.86 550.5,-29444.86"/>
</g>
<!-- layer51_attn_out_4 -->
<g id="node725" class="node">
<title>layer51_attn_out_4</title>
<path fill="#e6f3ff" stroke="black" d="M338,-29315.47C338,-29315.47 48,-29315.47 48,-29315.47 42,-29315.47 36,-29309.47 36,-29303.47 36,-29303.47 36,-29280.47 36,-29280.47 36,-29274.47 42,-29268.47 48,-29268.47 48,-29268.47 338,-29268.47 338,-29268.47 344,-29268.47 350,-29274.47 350,-29280.47 350,-29280.47 350,-29303.47 350,-29303.47 350,-29309.47 344,-29315.47 338,-29315.47"/>
<text text-anchor="middle" x="193" y="-29300.47" font-family="Arial" font-size="10.00">Layer 51 Attn Out GPU4</text>
<text text-anchor="middle" x="193" y="-29289.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="193" y="-29278.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer51_attn_4&#45;&gt;layer51_attn_out_4 -->
<g id="edge827" class="edge">
<title>layer51_attn_4&#45;&gt;layer51_attn_out_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M189.77,-29387.41C190.37,-29369.96 191.2,-29345.55 191.87,-29325.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="195.37,-29325.97 192.22,-29315.86 188.38,-29325.73 195.37,-29325.97"/>
</g>
<!-- layer51_attn_out_5 -->
<g id="node726" class="node">
<title>layer51_attn_out_5</title>
<path fill="#e6f3ff" stroke="black" d="M690,-29315.47C690,-29315.47 400,-29315.47 400,-29315.47 394,-29315.47 388,-29309.47 388,-29303.47 388,-29303.47 388,-29280.47 388,-29280.47 388,-29274.47 394,-29268.47 400,-29268.47 400,-29268.47 690,-29268.47 690,-29268.47 696,-29268.47 702,-29274.47 702,-29280.47 702,-29280.47 702,-29303.47 702,-29303.47 702,-29309.47 696,-29315.47 690,-29315.47"/>
<text text-anchor="middle" x="545" y="-29300.47" font-family="Arial" font-size="10.00">Layer 51 Attn Out GPU5</text>
<text text-anchor="middle" x="545" y="-29289.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="545" y="-29278.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer51_attn_5&#45;&gt;layer51_attn_out_5 -->
<g id="edge828" class="edge">
<title>layer51_attn_5&#45;&gt;layer51_attn_out_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M546.61,-29387.41C546.32,-29369.96 545.9,-29345.55 545.56,-29325.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="549.06,-29325.8 545.39,-29315.86 542.06,-29325.92 549.06,-29325.8"/>
</g>
<!-- layer51_attn_ar -->
<g id="node727" class="node">
<title>layer51_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M498.07,-29196.47C498.07,-29196.47 296.07,-29196.47 296.07,-29196.47 290.07,-29196.47 280.3,-29191.8 276.53,-29187.13 276.53,-29187.13 233.47,-29133.8 233.47,-29133.8 229.7,-29129.14 231.93,-29124.47 237.93,-29124.47 237.93,-29124.47 439.93,-29124.47 439.93,-29124.47 445.93,-29124.47 455.7,-29129.14 459.47,-29133.8 459.47,-29133.8 502.53,-29187.13 502.53,-29187.13 506.3,-29191.8 504.07,-29196.47 498.07,-29196.47"/>
<text text-anchor="middle" x="368" y="-29163.47" font-family="Arial" font-size="10.00">Layer 51 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="368" y="-29152.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer51_attn_out_4&#45;&gt;layer51_attn_ar -->
<g id="edge829" class="edge">
<title>layer51_attn_out_4&#45;&gt;layer51_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M223.48,-29268.41C247.92,-29250.33 282.86,-29224.47 312.27,-29202.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="314.45,-29205.45 320.4,-29196.69 310.28,-29199.82 314.45,-29205.45"/>
</g>
<!-- layer51_attn_out_5&#45;&gt;layer51_attn_ar -->
<g id="edge830" class="edge">
<title>layer51_attn_out_5&#45;&gt;layer51_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M514.17,-29268.41C489.45,-29250.33 454.11,-29224.47 424.37,-29202.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="426.28,-29199.77 416.14,-29196.69 422.14,-29205.42 426.28,-29199.77"/>
</g>
<!-- layer51_ffn1_4 -->
<g id="node728" class="node">
<title>layer51_ffn1_4</title>
<path fill="#e6f3ff" stroke="black" d="M338,-29052.47C338,-29052.47 68,-29052.47 68,-29052.47 62,-29052.47 56,-29046.47 56,-29040.47 56,-29040.47 56,-29017.47 56,-29017.47 56,-29011.47 62,-29005.47 68,-29005.47 68,-29005.47 338,-29005.47 338,-29005.47 344,-29005.47 350,-29011.47 350,-29017.47 350,-29017.47 350,-29040.47 350,-29040.47 350,-29046.47 344,-29052.47 338,-29052.47"/>
<text text-anchor="middle" x="203" y="-29037.47" font-family="Arial" font-size="10.00">Layer 51 FFN1 GPU4</text>
<text text-anchor="middle" x="203" y="-29026.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="203" y="-29015.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer51_attn_ar&#45;&gt;layer51_ffn1_4 -->
<g id="edge831" class="edge">
<title>layer51_attn_ar&#45;&gt;layer51_ffn1_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M323.35,-29124.42C297.28,-29103.96 264.78,-29078.45 240.12,-29059.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="242.11,-29056.21 232.08,-29052.79 237.79,-29061.72 242.11,-29056.21"/>
</g>
<!-- layer51_ffn1_5 -->
<g id="node729" class="node">
<title>layer51_ffn1_5</title>
<path fill="#e6f3ff" stroke="black" d="M668,-29052.47C668,-29052.47 398,-29052.47 398,-29052.47 392,-29052.47 386,-29046.47 386,-29040.47 386,-29040.47 386,-29017.47 386,-29017.47 386,-29011.47 392,-29005.47 398,-29005.47 398,-29005.47 668,-29005.47 668,-29005.47 674,-29005.47 680,-29011.47 680,-29017.47 680,-29017.47 680,-29040.47 680,-29040.47 680,-29046.47 674,-29052.47 668,-29052.47"/>
<text text-anchor="middle" x="533" y="-29037.47" font-family="Arial" font-size="10.00">Layer 51 FFN1 GPU5</text>
<text text-anchor="middle" x="533" y="-29026.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="533" y="-29015.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer51_attn_ar&#45;&gt;layer51_ffn1_5 -->
<g id="edge832" class="edge">
<title>layer51_attn_ar&#45;&gt;layer51_ffn1_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M412.65,-29124.42C438.72,-29103.96 471.22,-29078.45 495.88,-29059.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="498.21,-29061.72 503.92,-29052.79 493.89,-29056.21 498.21,-29061.72"/>
</g>
<!-- layer51_act_4 -->
<g id="node730" class="node">
<title>layer51_act_4</title>
<path fill="#e6f3ff" stroke="black" d="M338,-28933.47C338,-28933.47 68,-28933.47 68,-28933.47 62,-28933.47 56,-28927.47 56,-28921.47 56,-28921.47 56,-28898.47 56,-28898.47 56,-28892.47 62,-28886.47 68,-28886.47 68,-28886.47 338,-28886.47 338,-28886.47 344,-28886.47 350,-28892.47 350,-28898.47 350,-28898.47 350,-28921.47 350,-28921.47 350,-28927.47 344,-28933.47 338,-28933.47"/>
<text text-anchor="middle" x="203" y="-28918.47" font-family="Arial" font-size="10.00">Layer 51 SiLU GPU4</text>
<text text-anchor="middle" x="203" y="-28907.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="203" y="-28896.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer51_ffn1_4&#45;&gt;layer51_act_4 -->
<g id="edge833" class="edge">
<title>layer51_ffn1_4&#45;&gt;layer51_act_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M203,-29005.41C203,-28987.96 203,-28963.55 203,-28943.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="206.5,-28943.86 203,-28933.86 199.5,-28943.86 206.5,-28943.86"/>
</g>
<!-- layer51_act_5 -->
<g id="node731" class="node">
<title>layer51_act_5</title>
<path fill="#e6f3ff" stroke="black" d="M668,-28933.47C668,-28933.47 398,-28933.47 398,-28933.47 392,-28933.47 386,-28927.47 386,-28921.47 386,-28921.47 386,-28898.47 386,-28898.47 386,-28892.47 392,-28886.47 398,-28886.47 398,-28886.47 668,-28886.47 668,-28886.47 674,-28886.47 680,-28892.47 680,-28898.47 680,-28898.47 680,-28921.47 680,-28921.47 680,-28927.47 674,-28933.47 668,-28933.47"/>
<text text-anchor="middle" x="533" y="-28918.47" font-family="Arial" font-size="10.00">Layer 51 SiLU GPU5</text>
<text text-anchor="middle" x="533" y="-28907.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="533" y="-28896.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer51_ffn1_5&#45;&gt;layer51_act_5 -->
<g id="edge834" class="edge">
<title>layer51_ffn1_5&#45;&gt;layer51_act_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M533,-29005.41C533,-28987.96 533,-28963.55 533,-28943.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="536.5,-28943.86 533,-28933.86 529.5,-28943.86 536.5,-28943.86"/>
</g>
<!-- layer51_ffn2_4 -->
<g id="node732" class="node">
<title>layer51_ffn2_4</title>
<path fill="#e6f3ff" stroke="black" d="M337.5,-28814.47C337.5,-28814.47 74.5,-28814.47 74.5,-28814.47 68.5,-28814.47 62.5,-28808.47 62.5,-28802.47 62.5,-28802.47 62.5,-28779.47 62.5,-28779.47 62.5,-28773.47 68.5,-28767.47 74.5,-28767.47 74.5,-28767.47 337.5,-28767.47 337.5,-28767.47 343.5,-28767.47 349.5,-28773.47 349.5,-28779.47 349.5,-28779.47 349.5,-28802.47 349.5,-28802.47 349.5,-28808.47 343.5,-28814.47 337.5,-28814.47"/>
<text text-anchor="middle" x="206" y="-28799.47" font-family="Arial" font-size="10.00">Layer 51 FFN2 GPU4</text>
<text text-anchor="middle" x="206" y="-28788.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="206" y="-28777.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer51_act_4&#45;&gt;layer51_ffn2_4 -->
<g id="edge835" class="edge">
<title>layer51_act_4&#45;&gt;layer51_ffn2_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M203.58,-28886.41C204.03,-28868.96 204.65,-28844.55 205.16,-28824.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="208.66,-28824.94 205.41,-28814.86 201.66,-28824.76 208.66,-28824.94"/>
</g>
<!-- layer51_ffn2_5 -->
<g id="node733" class="node">
<title>layer51_ffn2_5</title>
<path fill="#e6f3ff" stroke="black" d="M662.5,-28814.47C662.5,-28814.47 399.5,-28814.47 399.5,-28814.47 393.5,-28814.47 387.5,-28808.47 387.5,-28802.47 387.5,-28802.47 387.5,-28779.47 387.5,-28779.47 387.5,-28773.47 393.5,-28767.47 399.5,-28767.47 399.5,-28767.47 662.5,-28767.47 662.5,-28767.47 668.5,-28767.47 674.5,-28773.47 674.5,-28779.47 674.5,-28779.47 674.5,-28802.47 674.5,-28802.47 674.5,-28808.47 668.5,-28814.47 662.5,-28814.47"/>
<text text-anchor="middle" x="531" y="-28799.47" font-family="Arial" font-size="10.00">Layer 51 FFN2 GPU5</text>
<text text-anchor="middle" x="531" y="-28788.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="531" y="-28777.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer51_act_5&#45;&gt;layer51_ffn2_5 -->
<g id="edge836" class="edge">
<title>layer51_act_5&#45;&gt;layer51_ffn2_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M532.61,-28886.41C532.32,-28868.96 531.9,-28844.55 531.56,-28824.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="535.06,-28824.8 531.39,-28814.86 528.06,-28824.92 535.06,-28824.8"/>
</g>
<!-- layer51_ffn_ar -->
<g id="node734" class="node">
<title>layer51_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M499.22,-28695.47C499.22,-28695.47 293.8,-28695.47 293.8,-28695.47 287.8,-28695.47 278,-28690.83 274.19,-28686.19 274.19,-28686.19 230.39,-28632.75 230.39,-28632.75 226.59,-28628.11 228.78,-28623.47 234.78,-28623.47 234.78,-28623.47 440.2,-28623.47 440.2,-28623.47 446.2,-28623.47 456,-28628.11 459.81,-28632.75 459.81,-28632.75 503.61,-28686.19 503.61,-28686.19 507.41,-28690.83 505.22,-28695.47 499.22,-28695.47"/>
<text text-anchor="middle" x="367" y="-28662.47" font-family="Arial" font-size="10.00">Layer 51 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="367" y="-28651.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer51_ffn2_4&#45;&gt;layer51_ffn_ar -->
<g id="edge837" class="edge">
<title>layer51_ffn2_4&#45;&gt;layer51_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M234.04,-28767.41C256.43,-28749.41 288.4,-28723.69 315.38,-28701.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="317.61,-28704.68 323.21,-28695.69 313.23,-28699.23 317.61,-28704.68"/>
</g>
<!-- layer51_ffn2_5&#45;&gt;layer51_ffn_ar -->
<g id="edge838" class="edge">
<title>layer51_ffn2_5&#45;&gt;layer51_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M502.43,-28767.41C479.63,-28749.41 447.06,-28723.69 419.58,-28701.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="421.62,-28699.14 411.6,-28695.69 417.28,-28704.63 421.62,-28699.14"/>
</g>
<!-- layer52_qkv_4 -->
<g id="node735" class="node">
<title>layer52_qkv_4</title>
<path fill="#e6f3ff" stroke="black" d="M337,-28551.47C337,-28551.47 39,-28551.47 39,-28551.47 33,-28551.47 27,-28545.47 27,-28539.47 27,-28539.47 27,-28516.47 27,-28516.47 27,-28510.47 33,-28504.47 39,-28504.47 39,-28504.47 337,-28504.47 337,-28504.47 343,-28504.47 349,-28510.47 349,-28516.47 349,-28516.47 349,-28539.47 349,-28539.47 349,-28545.47 343,-28551.47 337,-28551.47"/>
<text text-anchor="middle" x="188" y="-28536.47" font-family="Arial" font-size="10.00">Layer 52 QKV Proj GPU4</text>
<text text-anchor="middle" x="188" y="-28525.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="188" y="-28514.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer51_ffn_ar&#45;&gt;layer52_qkv_4 -->
<g id="edge839" class="edge">
<title>layer51_ffn_ar&#45;&gt;layer52_qkv_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M318.56,-28623.42C290.06,-28602.81 254.48,-28577.06 227.66,-28557.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="229.43,-28554.62 219.28,-28551.6 225.33,-28560.3 229.43,-28554.62"/>
</g>
<!-- layer52_qkv_5 -->
<g id="node736" class="node">
<title>layer52_qkv_5</title>
<path fill="#e6f3ff" stroke="black" d="M695,-28551.47C695,-28551.47 397,-28551.47 397,-28551.47 391,-28551.47 385,-28545.47 385,-28539.47 385,-28539.47 385,-28516.47 385,-28516.47 385,-28510.47 391,-28504.47 397,-28504.47 397,-28504.47 695,-28504.47 695,-28504.47 701,-28504.47 707,-28510.47 707,-28516.47 707,-28516.47 707,-28539.47 707,-28539.47 707,-28545.47 701,-28551.47 695,-28551.47"/>
<text text-anchor="middle" x="546" y="-28536.47" font-family="Arial" font-size="10.00">Layer 52 QKV Proj GPU5</text>
<text text-anchor="middle" x="546" y="-28525.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="546" y="-28514.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer51_ffn_ar&#45;&gt;layer52_qkv_5 -->
<g id="edge840" class="edge">
<title>layer51_ffn_ar&#45;&gt;layer52_qkv_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M415.44,-28623.42C443.94,-28602.81 479.52,-28577.06 506.34,-28557.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="508.67,-28560.3 514.72,-28551.6 504.57,-28554.62 508.67,-28560.3"/>
</g>
<!-- layer52_attn_4 -->
<g id="node737" class="node">
<title>layer52_attn_4</title>
<path fill="#e6f3ff" stroke="black" d="M337,-28432.47C337,-28432.47 39,-28432.47 39,-28432.47 33,-28432.47 27,-28426.47 27,-28420.47 27,-28420.47 27,-28397.47 27,-28397.47 27,-28391.47 33,-28385.47 39,-28385.47 39,-28385.47 337,-28385.47 337,-28385.47 343,-28385.47 349,-28391.47 349,-28397.47 349,-28397.47 349,-28420.47 349,-28420.47 349,-28426.47 343,-28432.47 337,-28432.47"/>
<text text-anchor="middle" x="188" y="-28417.47" font-family="Arial" font-size="10.00">Layer 52 Attention GPU4</text>
<text text-anchor="middle" x="188" y="-28406.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="188" y="-28395.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer52_qkv_4&#45;&gt;layer52_attn_4 -->
<g id="edge841" class="edge">
<title>layer52_qkv_4&#45;&gt;layer52_attn_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M188,-28504.41C188,-28486.96 188,-28462.55 188,-28442.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="191.5,-28442.86 188,-28432.86 184.5,-28442.86 191.5,-28442.86"/>
</g>
<!-- layer52_attn_5 -->
<g id="node738" class="node">
<title>layer52_attn_5</title>
<path fill="#e6f3ff" stroke="black" d="M695,-28432.47C695,-28432.47 397,-28432.47 397,-28432.47 391,-28432.47 385,-28426.47 385,-28420.47 385,-28420.47 385,-28397.47 385,-28397.47 385,-28391.47 391,-28385.47 397,-28385.47 397,-28385.47 695,-28385.47 695,-28385.47 701,-28385.47 707,-28391.47 707,-28397.47 707,-28397.47 707,-28420.47 707,-28420.47 707,-28426.47 701,-28432.47 695,-28432.47"/>
<text text-anchor="middle" x="546" y="-28417.47" font-family="Arial" font-size="10.00">Layer 52 Attention GPU5</text>
<text text-anchor="middle" x="546" y="-28406.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="546" y="-28395.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer52_qkv_5&#45;&gt;layer52_attn_5 -->
<g id="edge842" class="edge">
<title>layer52_qkv_5&#45;&gt;layer52_attn_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M546,-28504.41C546,-28486.96 546,-28462.55 546,-28442.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="549.5,-28442.86 546,-28432.86 542.5,-28442.86 549.5,-28442.86"/>
</g>
<!-- layer52_attn_out_4 -->
<g id="node739" class="node">
<title>layer52_attn_out_4</title>
<path fill="#e6f3ff" stroke="black" d="M337,-28313.47C337,-28313.47 47,-28313.47 47,-28313.47 41,-28313.47 35,-28307.47 35,-28301.47 35,-28301.47 35,-28278.47 35,-28278.47 35,-28272.47 41,-28266.47 47,-28266.47 47,-28266.47 337,-28266.47 337,-28266.47 343,-28266.47 349,-28272.47 349,-28278.47 349,-28278.47 349,-28301.47 349,-28301.47 349,-28307.47 343,-28313.47 337,-28313.47"/>
<text text-anchor="middle" x="192" y="-28298.47" font-family="Arial" font-size="10.00">Layer 52 Attn Out GPU4</text>
<text text-anchor="middle" x="192" y="-28287.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="192" y="-28276.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer52_attn_4&#45;&gt;layer52_attn_out_4 -->
<g id="edge843" class="edge">
<title>layer52_attn_4&#45;&gt;layer52_attn_out_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M188.77,-28385.41C189.37,-28367.96 190.2,-28343.55 190.87,-28323.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="194.37,-28323.97 191.22,-28313.86 187.38,-28323.73 194.37,-28323.97"/>
</g>
<!-- layer52_attn_out_5 -->
<g id="node740" class="node">
<title>layer52_attn_out_5</title>
<path fill="#e6f3ff" stroke="black" d="M689,-28313.47C689,-28313.47 399,-28313.47 399,-28313.47 393,-28313.47 387,-28307.47 387,-28301.47 387,-28301.47 387,-28278.47 387,-28278.47 387,-28272.47 393,-28266.47 399,-28266.47 399,-28266.47 689,-28266.47 689,-28266.47 695,-28266.47 701,-28272.47 701,-28278.47 701,-28278.47 701,-28301.47 701,-28301.47 701,-28307.47 695,-28313.47 689,-28313.47"/>
<text text-anchor="middle" x="544" y="-28298.47" font-family="Arial" font-size="10.00">Layer 52 Attn Out GPU5</text>
<text text-anchor="middle" x="544" y="-28287.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="544" y="-28276.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer52_attn_5&#45;&gt;layer52_attn_out_5 -->
<g id="edge844" class="edge">
<title>layer52_attn_5&#45;&gt;layer52_attn_out_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M545.61,-28385.41C545.32,-28367.96 544.9,-28343.55 544.56,-28323.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="548.06,-28323.8 544.39,-28313.86 541.06,-28323.92 548.06,-28323.8"/>
</g>
<!-- layer52_attn_ar -->
<g id="node741" class="node">
<title>layer52_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M497.07,-28194.47C497.07,-28194.47 295.07,-28194.47 295.07,-28194.47 289.07,-28194.47 279.3,-28189.8 275.53,-28185.13 275.53,-28185.13 232.47,-28131.8 232.47,-28131.8 228.7,-28127.14 230.93,-28122.47 236.93,-28122.47 236.93,-28122.47 438.93,-28122.47 438.93,-28122.47 444.93,-28122.47 454.7,-28127.14 458.47,-28131.8 458.47,-28131.8 501.53,-28185.13 501.53,-28185.13 505.3,-28189.8 503.07,-28194.47 497.07,-28194.47"/>
<text text-anchor="middle" x="367" y="-28161.47" font-family="Arial" font-size="10.00">Layer 52 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="367" y="-28150.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer52_attn_out_4&#45;&gt;layer52_attn_ar -->
<g id="edge845" class="edge">
<title>layer52_attn_out_4&#45;&gt;layer52_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M222.48,-28266.41C246.92,-28248.33 281.86,-28222.47 311.27,-28200.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="313.45,-28203.45 319.4,-28194.69 309.28,-28197.82 313.45,-28203.45"/>
</g>
<!-- layer52_attn_out_5&#45;&gt;layer52_attn_ar -->
<g id="edge846" class="edge">
<title>layer52_attn_out_5&#45;&gt;layer52_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M513.17,-28266.41C488.45,-28248.33 453.11,-28222.47 423.37,-28200.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="425.28,-28197.77 415.14,-28194.69 421.14,-28203.42 425.28,-28197.77"/>
</g>
<!-- layer52_ffn1_4 -->
<g id="node742" class="node">
<title>layer52_ffn1_4</title>
<path fill="#e6f3ff" stroke="black" d="M337,-28050.47C337,-28050.47 67,-28050.47 67,-28050.47 61,-28050.47 55,-28044.47 55,-28038.47 55,-28038.47 55,-28015.47 55,-28015.47 55,-28009.47 61,-28003.47 67,-28003.47 67,-28003.47 337,-28003.47 337,-28003.47 343,-28003.47 349,-28009.47 349,-28015.47 349,-28015.47 349,-28038.47 349,-28038.47 349,-28044.47 343,-28050.47 337,-28050.47"/>
<text text-anchor="middle" x="202" y="-28035.47" font-family="Arial" font-size="10.00">Layer 52 FFN1 GPU4</text>
<text text-anchor="middle" x="202" y="-28024.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="202" y="-28013.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer52_attn_ar&#45;&gt;layer52_ffn1_4 -->
<g id="edge847" class="edge">
<title>layer52_attn_ar&#45;&gt;layer52_ffn1_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M322.35,-28122.42C296.28,-28101.96 263.78,-28076.45 239.12,-28057.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="241.11,-28054.21 231.08,-28050.79 236.79,-28059.72 241.11,-28054.21"/>
</g>
<!-- layer52_ffn1_5 -->
<g id="node743" class="node">
<title>layer52_ffn1_5</title>
<path fill="#e6f3ff" stroke="black" d="M667,-28050.47C667,-28050.47 397,-28050.47 397,-28050.47 391,-28050.47 385,-28044.47 385,-28038.47 385,-28038.47 385,-28015.47 385,-28015.47 385,-28009.47 391,-28003.47 397,-28003.47 397,-28003.47 667,-28003.47 667,-28003.47 673,-28003.47 679,-28009.47 679,-28015.47 679,-28015.47 679,-28038.47 679,-28038.47 679,-28044.47 673,-28050.47 667,-28050.47"/>
<text text-anchor="middle" x="532" y="-28035.47" font-family="Arial" font-size="10.00">Layer 52 FFN1 GPU5</text>
<text text-anchor="middle" x="532" y="-28024.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="532" y="-28013.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer52_attn_ar&#45;&gt;layer52_ffn1_5 -->
<g id="edge848" class="edge">
<title>layer52_attn_ar&#45;&gt;layer52_ffn1_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M411.65,-28122.42C437.72,-28101.96 470.22,-28076.45 494.88,-28057.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="497.21,-28059.72 502.92,-28050.79 492.89,-28054.21 497.21,-28059.72"/>
</g>
<!-- layer52_act_4 -->
<g id="node744" class="node">
<title>layer52_act_4</title>
<path fill="#e6f3ff" stroke="black" d="M337,-27931.47C337,-27931.47 67,-27931.47 67,-27931.47 61,-27931.47 55,-27925.47 55,-27919.47 55,-27919.47 55,-27896.47 55,-27896.47 55,-27890.47 61,-27884.47 67,-27884.47 67,-27884.47 337,-27884.47 337,-27884.47 343,-27884.47 349,-27890.47 349,-27896.47 349,-27896.47 349,-27919.47 349,-27919.47 349,-27925.47 343,-27931.47 337,-27931.47"/>
<text text-anchor="middle" x="202" y="-27916.47" font-family="Arial" font-size="10.00">Layer 52 SiLU GPU4</text>
<text text-anchor="middle" x="202" y="-27905.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="202" y="-27894.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer52_ffn1_4&#45;&gt;layer52_act_4 -->
<g id="edge849" class="edge">
<title>layer52_ffn1_4&#45;&gt;layer52_act_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M202,-28003.41C202,-27985.96 202,-27961.55 202,-27941.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="205.5,-27941.86 202,-27931.86 198.5,-27941.86 205.5,-27941.86"/>
</g>
<!-- layer52_act_5 -->
<g id="node745" class="node">
<title>layer52_act_5</title>
<path fill="#e6f3ff" stroke="black" d="M667,-27931.47C667,-27931.47 397,-27931.47 397,-27931.47 391,-27931.47 385,-27925.47 385,-27919.47 385,-27919.47 385,-27896.47 385,-27896.47 385,-27890.47 391,-27884.47 397,-27884.47 397,-27884.47 667,-27884.47 667,-27884.47 673,-27884.47 679,-27890.47 679,-27896.47 679,-27896.47 679,-27919.47 679,-27919.47 679,-27925.47 673,-27931.47 667,-27931.47"/>
<text text-anchor="middle" x="532" y="-27916.47" font-family="Arial" font-size="10.00">Layer 52 SiLU GPU5</text>
<text text-anchor="middle" x="532" y="-27905.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="532" y="-27894.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer52_ffn1_5&#45;&gt;layer52_act_5 -->
<g id="edge850" class="edge">
<title>layer52_ffn1_5&#45;&gt;layer52_act_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M532,-28003.41C532,-27985.96 532,-27961.55 532,-27941.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="535.5,-27941.86 532,-27931.86 528.5,-27941.86 535.5,-27941.86"/>
</g>
<!-- layer52_ffn2_4 -->
<g id="node746" class="node">
<title>layer52_ffn2_4</title>
<path fill="#e6f3ff" stroke="black" d="M336.5,-27812.47C336.5,-27812.47 73.5,-27812.47 73.5,-27812.47 67.5,-27812.47 61.5,-27806.47 61.5,-27800.47 61.5,-27800.47 61.5,-27777.47 61.5,-27777.47 61.5,-27771.47 67.5,-27765.47 73.5,-27765.47 73.5,-27765.47 336.5,-27765.47 336.5,-27765.47 342.5,-27765.47 348.5,-27771.47 348.5,-27777.47 348.5,-27777.47 348.5,-27800.47 348.5,-27800.47 348.5,-27806.47 342.5,-27812.47 336.5,-27812.47"/>
<text text-anchor="middle" x="205" y="-27797.47" font-family="Arial" font-size="10.00">Layer 52 FFN2 GPU4</text>
<text text-anchor="middle" x="205" y="-27786.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="205" y="-27775.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer52_act_4&#45;&gt;layer52_ffn2_4 -->
<g id="edge851" class="edge">
<title>layer52_act_4&#45;&gt;layer52_ffn2_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M202.58,-27884.41C203.03,-27866.96 203.65,-27842.55 204.16,-27822.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="207.66,-27822.94 204.41,-27812.86 200.66,-27822.76 207.66,-27822.94"/>
</g>
<!-- layer52_ffn2_5 -->
<g id="node747" class="node">
<title>layer52_ffn2_5</title>
<path fill="#e6f3ff" stroke="black" d="M661.5,-27812.47C661.5,-27812.47 398.5,-27812.47 398.5,-27812.47 392.5,-27812.47 386.5,-27806.47 386.5,-27800.47 386.5,-27800.47 386.5,-27777.47 386.5,-27777.47 386.5,-27771.47 392.5,-27765.47 398.5,-27765.47 398.5,-27765.47 661.5,-27765.47 661.5,-27765.47 667.5,-27765.47 673.5,-27771.47 673.5,-27777.47 673.5,-27777.47 673.5,-27800.47 673.5,-27800.47 673.5,-27806.47 667.5,-27812.47 661.5,-27812.47"/>
<text text-anchor="middle" x="530" y="-27797.47" font-family="Arial" font-size="10.00">Layer 52 FFN2 GPU5</text>
<text text-anchor="middle" x="530" y="-27786.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="530" y="-27775.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer52_act_5&#45;&gt;layer52_ffn2_5 -->
<g id="edge852" class="edge">
<title>layer52_act_5&#45;&gt;layer52_ffn2_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M531.61,-27884.41C531.32,-27866.96 530.9,-27842.55 530.56,-27822.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="534.06,-27822.8 530.39,-27812.86 527.06,-27822.92 534.06,-27822.8"/>
</g>
<!-- layer52_ffn_ar -->
<g id="node748" class="node">
<title>layer52_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M498.22,-27693.47C498.22,-27693.47 292.8,-27693.47 292.8,-27693.47 286.8,-27693.47 277,-27688.83 273.19,-27684.19 273.19,-27684.19 229.39,-27630.75 229.39,-27630.75 225.59,-27626.11 227.78,-27621.47 233.78,-27621.47 233.78,-27621.47 439.2,-27621.47 439.2,-27621.47 445.2,-27621.47 455,-27626.11 458.81,-27630.75 458.81,-27630.75 502.61,-27684.19 502.61,-27684.19 506.41,-27688.83 504.22,-27693.47 498.22,-27693.47"/>
<text text-anchor="middle" x="366" y="-27660.47" font-family="Arial" font-size="10.00">Layer 52 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="366" y="-27649.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer52_ffn2_4&#45;&gt;layer52_ffn_ar -->
<g id="edge853" class="edge">
<title>layer52_ffn2_4&#45;&gt;layer52_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M233.04,-27765.41C255.43,-27747.41 287.4,-27721.69 314.38,-27699.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="316.61,-27702.68 322.21,-27693.69 312.23,-27697.23 316.61,-27702.68"/>
</g>
<!-- layer52_ffn2_5&#45;&gt;layer52_ffn_ar -->
<g id="edge854" class="edge">
<title>layer52_ffn2_5&#45;&gt;layer52_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M501.43,-27765.41C478.63,-27747.41 446.06,-27721.69 418.58,-27699.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="420.62,-27697.14 410.6,-27693.69 416.28,-27702.63 420.62,-27697.14"/>
</g>
<!-- layer53_qkv_4 -->
<g id="node749" class="node">
<title>layer53_qkv_4</title>
<path fill="#e6f3ff" stroke="black" d="M336,-27549.47C336,-27549.47 38,-27549.47 38,-27549.47 32,-27549.47 26,-27543.47 26,-27537.47 26,-27537.47 26,-27514.47 26,-27514.47 26,-27508.47 32,-27502.47 38,-27502.47 38,-27502.47 336,-27502.47 336,-27502.47 342,-27502.47 348,-27508.47 348,-27514.47 348,-27514.47 348,-27537.47 348,-27537.47 348,-27543.47 342,-27549.47 336,-27549.47"/>
<text text-anchor="middle" x="187" y="-27534.47" font-family="Arial" font-size="10.00">Layer 53 QKV Proj GPU4</text>
<text text-anchor="middle" x="187" y="-27523.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="187" y="-27512.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer52_ffn_ar&#45;&gt;layer53_qkv_4 -->
<g id="edge855" class="edge">
<title>layer52_ffn_ar&#45;&gt;layer53_qkv_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M317.56,-27621.42C289.06,-27600.81 253.48,-27575.06 226.66,-27555.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="228.43,-27552.62 218.28,-27549.6 224.33,-27558.3 228.43,-27552.62"/>
</g>
<!-- layer53_qkv_5 -->
<g id="node750" class="node">
<title>layer53_qkv_5</title>
<path fill="#e6f3ff" stroke="black" d="M694,-27549.47C694,-27549.47 396,-27549.47 396,-27549.47 390,-27549.47 384,-27543.47 384,-27537.47 384,-27537.47 384,-27514.47 384,-27514.47 384,-27508.47 390,-27502.47 396,-27502.47 396,-27502.47 694,-27502.47 694,-27502.47 700,-27502.47 706,-27508.47 706,-27514.47 706,-27514.47 706,-27537.47 706,-27537.47 706,-27543.47 700,-27549.47 694,-27549.47"/>
<text text-anchor="middle" x="545" y="-27534.47" font-family="Arial" font-size="10.00">Layer 53 QKV Proj GPU5</text>
<text text-anchor="middle" x="545" y="-27523.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="545" y="-27512.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer52_ffn_ar&#45;&gt;layer53_qkv_5 -->
<g id="edge856" class="edge">
<title>layer52_ffn_ar&#45;&gt;layer53_qkv_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M414.44,-27621.42C442.94,-27600.81 478.52,-27575.06 505.34,-27555.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="507.67,-27558.3 513.72,-27549.6 503.57,-27552.62 507.67,-27558.3"/>
</g>
<!-- layer53_attn_4 -->
<g id="node751" class="node">
<title>layer53_attn_4</title>
<path fill="#e6f3ff" stroke="black" d="M336,-27430.47C336,-27430.47 38,-27430.47 38,-27430.47 32,-27430.47 26,-27424.47 26,-27418.47 26,-27418.47 26,-27395.47 26,-27395.47 26,-27389.47 32,-27383.47 38,-27383.47 38,-27383.47 336,-27383.47 336,-27383.47 342,-27383.47 348,-27389.47 348,-27395.47 348,-27395.47 348,-27418.47 348,-27418.47 348,-27424.47 342,-27430.47 336,-27430.47"/>
<text text-anchor="middle" x="187" y="-27415.47" font-family="Arial" font-size="10.00">Layer 53 Attention GPU4</text>
<text text-anchor="middle" x="187" y="-27404.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="187" y="-27393.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer53_qkv_4&#45;&gt;layer53_attn_4 -->
<g id="edge857" class="edge">
<title>layer53_qkv_4&#45;&gt;layer53_attn_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M187,-27502.41C187,-27484.96 187,-27460.55 187,-27440.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="190.5,-27440.86 187,-27430.86 183.5,-27440.86 190.5,-27440.86"/>
</g>
<!-- layer53_attn_5 -->
<g id="node752" class="node">
<title>layer53_attn_5</title>
<path fill="#e6f3ff" stroke="black" d="M694,-27430.47C694,-27430.47 396,-27430.47 396,-27430.47 390,-27430.47 384,-27424.47 384,-27418.47 384,-27418.47 384,-27395.47 384,-27395.47 384,-27389.47 390,-27383.47 396,-27383.47 396,-27383.47 694,-27383.47 694,-27383.47 700,-27383.47 706,-27389.47 706,-27395.47 706,-27395.47 706,-27418.47 706,-27418.47 706,-27424.47 700,-27430.47 694,-27430.47"/>
<text text-anchor="middle" x="545" y="-27415.47" font-family="Arial" font-size="10.00">Layer 53 Attention GPU5</text>
<text text-anchor="middle" x="545" y="-27404.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="545" y="-27393.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer53_qkv_5&#45;&gt;layer53_attn_5 -->
<g id="edge858" class="edge">
<title>layer53_qkv_5&#45;&gt;layer53_attn_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M545,-27502.41C545,-27484.96 545,-27460.55 545,-27440.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="548.5,-27440.86 545,-27430.86 541.5,-27440.86 548.5,-27440.86"/>
</g>
<!-- layer53_attn_out_4 -->
<g id="node753" class="node">
<title>layer53_attn_out_4</title>
<path fill="#e6f3ff" stroke="black" d="M336,-27311.47C336,-27311.47 46,-27311.47 46,-27311.47 40,-27311.47 34,-27305.47 34,-27299.47 34,-27299.47 34,-27276.47 34,-27276.47 34,-27270.47 40,-27264.47 46,-27264.47 46,-27264.47 336,-27264.47 336,-27264.47 342,-27264.47 348,-27270.47 348,-27276.47 348,-27276.47 348,-27299.47 348,-27299.47 348,-27305.47 342,-27311.47 336,-27311.47"/>
<text text-anchor="middle" x="191" y="-27296.47" font-family="Arial" font-size="10.00">Layer 53 Attn Out GPU4</text>
<text text-anchor="middle" x="191" y="-27285.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="191" y="-27274.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer53_attn_4&#45;&gt;layer53_attn_out_4 -->
<g id="edge859" class="edge">
<title>layer53_attn_4&#45;&gt;layer53_attn_out_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M187.77,-27383.41C188.37,-27365.96 189.2,-27341.55 189.87,-27321.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="193.37,-27321.97 190.22,-27311.86 186.38,-27321.73 193.37,-27321.97"/>
</g>
<!-- layer53_attn_out_5 -->
<g id="node754" class="node">
<title>layer53_attn_out_5</title>
<path fill="#e6f3ff" stroke="black" d="M688,-27311.47C688,-27311.47 398,-27311.47 398,-27311.47 392,-27311.47 386,-27305.47 386,-27299.47 386,-27299.47 386,-27276.47 386,-27276.47 386,-27270.47 392,-27264.47 398,-27264.47 398,-27264.47 688,-27264.47 688,-27264.47 694,-27264.47 700,-27270.47 700,-27276.47 700,-27276.47 700,-27299.47 700,-27299.47 700,-27305.47 694,-27311.47 688,-27311.47"/>
<text text-anchor="middle" x="543" y="-27296.47" font-family="Arial" font-size="10.00">Layer 53 Attn Out GPU5</text>
<text text-anchor="middle" x="543" y="-27285.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="543" y="-27274.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer53_attn_5&#45;&gt;layer53_attn_out_5 -->
<g id="edge860" class="edge">
<title>layer53_attn_5&#45;&gt;layer53_attn_out_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M544.61,-27383.41C544.32,-27365.96 543.9,-27341.55 543.56,-27321.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="547.06,-27321.8 543.39,-27311.86 540.06,-27321.92 547.06,-27321.8"/>
</g>
<!-- layer53_attn_ar -->
<g id="node755" class="node">
<title>layer53_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M496.07,-27192.47C496.07,-27192.47 294.07,-27192.47 294.07,-27192.47 288.07,-27192.47 278.3,-27187.8 274.53,-27183.13 274.53,-27183.13 231.47,-27129.8 231.47,-27129.8 227.7,-27125.14 229.93,-27120.47 235.93,-27120.47 235.93,-27120.47 437.93,-27120.47 437.93,-27120.47 443.93,-27120.47 453.7,-27125.14 457.47,-27129.8 457.47,-27129.8 500.53,-27183.13 500.53,-27183.13 504.3,-27187.8 502.07,-27192.47 496.07,-27192.47"/>
<text text-anchor="middle" x="366" y="-27159.47" font-family="Arial" font-size="10.00">Layer 53 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="366" y="-27148.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer53_attn_out_4&#45;&gt;layer53_attn_ar -->
<g id="edge861" class="edge">
<title>layer53_attn_out_4&#45;&gt;layer53_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M221.48,-27264.41C245.92,-27246.33 280.86,-27220.47 310.27,-27198.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="312.45,-27201.45 318.4,-27192.69 308.28,-27195.82 312.45,-27201.45"/>
</g>
<!-- layer53_attn_out_5&#45;&gt;layer53_attn_ar -->
<g id="edge862" class="edge">
<title>layer53_attn_out_5&#45;&gt;layer53_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M512.17,-27264.41C487.45,-27246.33 452.11,-27220.47 422.37,-27198.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="424.28,-27195.77 414.14,-27192.69 420.14,-27201.42 424.28,-27195.77"/>
</g>
<!-- layer53_ffn1_4 -->
<g id="node756" class="node">
<title>layer53_ffn1_4</title>
<path fill="#e6f3ff" stroke="black" d="M336,-27048.47C336,-27048.47 66,-27048.47 66,-27048.47 60,-27048.47 54,-27042.47 54,-27036.47 54,-27036.47 54,-27013.47 54,-27013.47 54,-27007.47 60,-27001.47 66,-27001.47 66,-27001.47 336,-27001.47 336,-27001.47 342,-27001.47 348,-27007.47 348,-27013.47 348,-27013.47 348,-27036.47 348,-27036.47 348,-27042.47 342,-27048.47 336,-27048.47"/>
<text text-anchor="middle" x="201" y="-27033.47" font-family="Arial" font-size="10.00">Layer 53 FFN1 GPU4</text>
<text text-anchor="middle" x="201" y="-27022.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="201" y="-27011.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer53_attn_ar&#45;&gt;layer53_ffn1_4 -->
<g id="edge863" class="edge">
<title>layer53_attn_ar&#45;&gt;layer53_ffn1_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M321.35,-27120.42C295.28,-27099.96 262.78,-27074.45 238.12,-27055.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="240.11,-27052.21 230.08,-27048.79 235.79,-27057.72 240.11,-27052.21"/>
</g>
<!-- layer53_ffn1_5 -->
<g id="node757" class="node">
<title>layer53_ffn1_5</title>
<path fill="#e6f3ff" stroke="black" d="M666,-27048.47C666,-27048.47 396,-27048.47 396,-27048.47 390,-27048.47 384,-27042.47 384,-27036.47 384,-27036.47 384,-27013.47 384,-27013.47 384,-27007.47 390,-27001.47 396,-27001.47 396,-27001.47 666,-27001.47 666,-27001.47 672,-27001.47 678,-27007.47 678,-27013.47 678,-27013.47 678,-27036.47 678,-27036.47 678,-27042.47 672,-27048.47 666,-27048.47"/>
<text text-anchor="middle" x="531" y="-27033.47" font-family="Arial" font-size="10.00">Layer 53 FFN1 GPU5</text>
<text text-anchor="middle" x="531" y="-27022.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="531" y="-27011.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer53_attn_ar&#45;&gt;layer53_ffn1_5 -->
<g id="edge864" class="edge">
<title>layer53_attn_ar&#45;&gt;layer53_ffn1_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M410.65,-27120.42C436.72,-27099.96 469.22,-27074.45 493.88,-27055.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="496.21,-27057.72 501.92,-27048.79 491.89,-27052.21 496.21,-27057.72"/>
</g>
<!-- layer53_act_4 -->
<g id="node758" class="node">
<title>layer53_act_4</title>
<path fill="#e6f3ff" stroke="black" d="M336,-26929.47C336,-26929.47 66,-26929.47 66,-26929.47 60,-26929.47 54,-26923.47 54,-26917.47 54,-26917.47 54,-26894.47 54,-26894.47 54,-26888.47 60,-26882.47 66,-26882.47 66,-26882.47 336,-26882.47 336,-26882.47 342,-26882.47 348,-26888.47 348,-26894.47 348,-26894.47 348,-26917.47 348,-26917.47 348,-26923.47 342,-26929.47 336,-26929.47"/>
<text text-anchor="middle" x="201" y="-26914.47" font-family="Arial" font-size="10.00">Layer 53 SiLU GPU4</text>
<text text-anchor="middle" x="201" y="-26903.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="201" y="-26892.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer53_ffn1_4&#45;&gt;layer53_act_4 -->
<g id="edge865" class="edge">
<title>layer53_ffn1_4&#45;&gt;layer53_act_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M201,-27001.41C201,-26983.96 201,-26959.55 201,-26939.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="204.5,-26939.86 201,-26929.86 197.5,-26939.86 204.5,-26939.86"/>
</g>
<!-- layer53_act_5 -->
<g id="node759" class="node">
<title>layer53_act_5</title>
<path fill="#e6f3ff" stroke="black" d="M666,-26929.47C666,-26929.47 396,-26929.47 396,-26929.47 390,-26929.47 384,-26923.47 384,-26917.47 384,-26917.47 384,-26894.47 384,-26894.47 384,-26888.47 390,-26882.47 396,-26882.47 396,-26882.47 666,-26882.47 666,-26882.47 672,-26882.47 678,-26888.47 678,-26894.47 678,-26894.47 678,-26917.47 678,-26917.47 678,-26923.47 672,-26929.47 666,-26929.47"/>
<text text-anchor="middle" x="531" y="-26914.47" font-family="Arial" font-size="10.00">Layer 53 SiLU GPU5</text>
<text text-anchor="middle" x="531" y="-26903.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="531" y="-26892.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer53_ffn1_5&#45;&gt;layer53_act_5 -->
<g id="edge866" class="edge">
<title>layer53_ffn1_5&#45;&gt;layer53_act_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M531,-27001.41C531,-26983.96 531,-26959.55 531,-26939.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="534.5,-26939.86 531,-26929.86 527.5,-26939.86 534.5,-26939.86"/>
</g>
<!-- layer53_ffn2_4 -->
<g id="node760" class="node">
<title>layer53_ffn2_4</title>
<path fill="#e6f3ff" stroke="black" d="M335.5,-26810.47C335.5,-26810.47 72.5,-26810.47 72.5,-26810.47 66.5,-26810.47 60.5,-26804.47 60.5,-26798.47 60.5,-26798.47 60.5,-26775.47 60.5,-26775.47 60.5,-26769.47 66.5,-26763.47 72.5,-26763.47 72.5,-26763.47 335.5,-26763.47 335.5,-26763.47 341.5,-26763.47 347.5,-26769.47 347.5,-26775.47 347.5,-26775.47 347.5,-26798.47 347.5,-26798.47 347.5,-26804.47 341.5,-26810.47 335.5,-26810.47"/>
<text text-anchor="middle" x="204" y="-26795.47" font-family="Arial" font-size="10.00">Layer 53 FFN2 GPU4</text>
<text text-anchor="middle" x="204" y="-26784.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="204" y="-26773.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer53_act_4&#45;&gt;layer53_ffn2_4 -->
<g id="edge867" class="edge">
<title>layer53_act_4&#45;&gt;layer53_ffn2_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M201.58,-26882.41C202.03,-26864.96 202.65,-26840.55 203.16,-26820.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="206.66,-26820.94 203.41,-26810.86 199.66,-26820.76 206.66,-26820.94"/>
</g>
<!-- layer53_ffn2_5 -->
<g id="node761" class="node">
<title>layer53_ffn2_5</title>
<path fill="#e6f3ff" stroke="black" d="M660.5,-26810.47C660.5,-26810.47 397.5,-26810.47 397.5,-26810.47 391.5,-26810.47 385.5,-26804.47 385.5,-26798.47 385.5,-26798.47 385.5,-26775.47 385.5,-26775.47 385.5,-26769.47 391.5,-26763.47 397.5,-26763.47 397.5,-26763.47 660.5,-26763.47 660.5,-26763.47 666.5,-26763.47 672.5,-26769.47 672.5,-26775.47 672.5,-26775.47 672.5,-26798.47 672.5,-26798.47 672.5,-26804.47 666.5,-26810.47 660.5,-26810.47"/>
<text text-anchor="middle" x="529" y="-26795.47" font-family="Arial" font-size="10.00">Layer 53 FFN2 GPU5</text>
<text text-anchor="middle" x="529" y="-26784.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="529" y="-26773.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer53_act_5&#45;&gt;layer53_ffn2_5 -->
<g id="edge868" class="edge">
<title>layer53_act_5&#45;&gt;layer53_ffn2_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M530.61,-26882.41C530.32,-26864.96 529.9,-26840.55 529.56,-26820.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="533.06,-26820.8 529.39,-26810.86 526.06,-26820.92 533.06,-26820.8"/>
</g>
<!-- layer53_ffn_ar -->
<g id="node762" class="node">
<title>layer53_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M497.22,-26691.47C497.22,-26691.47 291.8,-26691.47 291.8,-26691.47 285.8,-26691.47 276,-26686.83 272.19,-26682.19 272.19,-26682.19 228.39,-26628.75 228.39,-26628.75 224.59,-26624.11 226.78,-26619.47 232.78,-26619.47 232.78,-26619.47 438.2,-26619.47 438.2,-26619.47 444.2,-26619.47 454,-26624.11 457.81,-26628.75 457.81,-26628.75 501.61,-26682.19 501.61,-26682.19 505.41,-26686.83 503.22,-26691.47 497.22,-26691.47"/>
<text text-anchor="middle" x="365" y="-26658.47" font-family="Arial" font-size="10.00">Layer 53 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="365" y="-26647.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer53_ffn2_4&#45;&gt;layer53_ffn_ar -->
<g id="edge869" class="edge">
<title>layer53_ffn2_4&#45;&gt;layer53_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M232.04,-26763.41C254.43,-26745.41 286.4,-26719.69 313.38,-26697.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="315.61,-26700.68 321.21,-26691.69 311.23,-26695.23 315.61,-26700.68"/>
</g>
<!-- layer53_ffn2_5&#45;&gt;layer53_ffn_ar -->
<g id="edge870" class="edge">
<title>layer53_ffn2_5&#45;&gt;layer53_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M500.43,-26763.41C477.63,-26745.41 445.06,-26719.69 417.58,-26697.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="419.62,-26695.14 409.6,-26691.69 415.28,-26700.63 419.62,-26695.14"/>
</g>
<!-- layer54_qkv_4 -->
<g id="node763" class="node">
<title>layer54_qkv_4</title>
<path fill="#e6f3ff" stroke="black" d="M335,-26547.47C335,-26547.47 37,-26547.47 37,-26547.47 31,-26547.47 25,-26541.47 25,-26535.47 25,-26535.47 25,-26512.47 25,-26512.47 25,-26506.47 31,-26500.47 37,-26500.47 37,-26500.47 335,-26500.47 335,-26500.47 341,-26500.47 347,-26506.47 347,-26512.47 347,-26512.47 347,-26535.47 347,-26535.47 347,-26541.47 341,-26547.47 335,-26547.47"/>
<text text-anchor="middle" x="186" y="-26532.47" font-family="Arial" font-size="10.00">Layer 54 QKV Proj GPU4</text>
<text text-anchor="middle" x="186" y="-26521.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="186" y="-26510.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer53_ffn_ar&#45;&gt;layer54_qkv_4 -->
<g id="edge871" class="edge">
<title>layer53_ffn_ar&#45;&gt;layer54_qkv_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M316.56,-26619.42C288.06,-26598.81 252.48,-26573.06 225.66,-26553.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="227.43,-26550.62 217.28,-26547.6 223.33,-26556.3 227.43,-26550.62"/>
</g>
<!-- layer54_qkv_5 -->
<g id="node764" class="node">
<title>layer54_qkv_5</title>
<path fill="#e6f3ff" stroke="black" d="M693,-26547.47C693,-26547.47 395,-26547.47 395,-26547.47 389,-26547.47 383,-26541.47 383,-26535.47 383,-26535.47 383,-26512.47 383,-26512.47 383,-26506.47 389,-26500.47 395,-26500.47 395,-26500.47 693,-26500.47 693,-26500.47 699,-26500.47 705,-26506.47 705,-26512.47 705,-26512.47 705,-26535.47 705,-26535.47 705,-26541.47 699,-26547.47 693,-26547.47"/>
<text text-anchor="middle" x="544" y="-26532.47" font-family="Arial" font-size="10.00">Layer 54 QKV Proj GPU5</text>
<text text-anchor="middle" x="544" y="-26521.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="544" y="-26510.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer53_ffn_ar&#45;&gt;layer54_qkv_5 -->
<g id="edge872" class="edge">
<title>layer53_ffn_ar&#45;&gt;layer54_qkv_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M413.44,-26619.42C441.94,-26598.81 477.52,-26573.06 504.34,-26553.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="506.67,-26556.3 512.72,-26547.6 502.57,-26550.62 506.67,-26556.3"/>
</g>
<!-- layer54_attn_4 -->
<g id="node765" class="node">
<title>layer54_attn_4</title>
<path fill="#e6f3ff" stroke="black" d="M335,-26428.47C335,-26428.47 37,-26428.47 37,-26428.47 31,-26428.47 25,-26422.47 25,-26416.47 25,-26416.47 25,-26393.47 25,-26393.47 25,-26387.47 31,-26381.47 37,-26381.47 37,-26381.47 335,-26381.47 335,-26381.47 341,-26381.47 347,-26387.47 347,-26393.47 347,-26393.47 347,-26416.47 347,-26416.47 347,-26422.47 341,-26428.47 335,-26428.47"/>
<text text-anchor="middle" x="186" y="-26413.47" font-family="Arial" font-size="10.00">Layer 54 Attention GPU4</text>
<text text-anchor="middle" x="186" y="-26402.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="186" y="-26391.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer54_qkv_4&#45;&gt;layer54_attn_4 -->
<g id="edge873" class="edge">
<title>layer54_qkv_4&#45;&gt;layer54_attn_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M186,-26500.41C186,-26482.96 186,-26458.55 186,-26438.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="189.5,-26438.86 186,-26428.86 182.5,-26438.86 189.5,-26438.86"/>
</g>
<!-- layer54_attn_5 -->
<g id="node766" class="node">
<title>layer54_attn_5</title>
<path fill="#e6f3ff" stroke="black" d="M693,-26428.47C693,-26428.47 395,-26428.47 395,-26428.47 389,-26428.47 383,-26422.47 383,-26416.47 383,-26416.47 383,-26393.47 383,-26393.47 383,-26387.47 389,-26381.47 395,-26381.47 395,-26381.47 693,-26381.47 693,-26381.47 699,-26381.47 705,-26387.47 705,-26393.47 705,-26393.47 705,-26416.47 705,-26416.47 705,-26422.47 699,-26428.47 693,-26428.47"/>
<text text-anchor="middle" x="544" y="-26413.47" font-family="Arial" font-size="10.00">Layer 54 Attention GPU5</text>
<text text-anchor="middle" x="544" y="-26402.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="544" y="-26391.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer54_qkv_5&#45;&gt;layer54_attn_5 -->
<g id="edge874" class="edge">
<title>layer54_qkv_5&#45;&gt;layer54_attn_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M544,-26500.41C544,-26482.96 544,-26458.55 544,-26438.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="547.5,-26438.86 544,-26428.86 540.5,-26438.86 547.5,-26438.86"/>
</g>
<!-- layer54_attn_out_4 -->
<g id="node767" class="node">
<title>layer54_attn_out_4</title>
<path fill="#e6f3ff" stroke="black" d="M335,-26309.47C335,-26309.47 45,-26309.47 45,-26309.47 39,-26309.47 33,-26303.47 33,-26297.47 33,-26297.47 33,-26274.47 33,-26274.47 33,-26268.47 39,-26262.47 45,-26262.47 45,-26262.47 335,-26262.47 335,-26262.47 341,-26262.47 347,-26268.47 347,-26274.47 347,-26274.47 347,-26297.47 347,-26297.47 347,-26303.47 341,-26309.47 335,-26309.47"/>
<text text-anchor="middle" x="190" y="-26294.47" font-family="Arial" font-size="10.00">Layer 54 Attn Out GPU4</text>
<text text-anchor="middle" x="190" y="-26283.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="190" y="-26272.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer54_attn_4&#45;&gt;layer54_attn_out_4 -->
<g id="edge875" class="edge">
<title>layer54_attn_4&#45;&gt;layer54_attn_out_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M186.77,-26381.41C187.37,-26363.96 188.2,-26339.55 188.87,-26319.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="192.37,-26319.97 189.22,-26309.86 185.38,-26319.73 192.37,-26319.97"/>
</g>
<!-- layer54_attn_out_5 -->
<g id="node768" class="node">
<title>layer54_attn_out_5</title>
<path fill="#e6f3ff" stroke="black" d="M687,-26309.47C687,-26309.47 397,-26309.47 397,-26309.47 391,-26309.47 385,-26303.47 385,-26297.47 385,-26297.47 385,-26274.47 385,-26274.47 385,-26268.47 391,-26262.47 397,-26262.47 397,-26262.47 687,-26262.47 687,-26262.47 693,-26262.47 699,-26268.47 699,-26274.47 699,-26274.47 699,-26297.47 699,-26297.47 699,-26303.47 693,-26309.47 687,-26309.47"/>
<text text-anchor="middle" x="542" y="-26294.47" font-family="Arial" font-size="10.00">Layer 54 Attn Out GPU5</text>
<text text-anchor="middle" x="542" y="-26283.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="542" y="-26272.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer54_attn_5&#45;&gt;layer54_attn_out_5 -->
<g id="edge876" class="edge">
<title>layer54_attn_5&#45;&gt;layer54_attn_out_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M543.61,-26381.41C543.32,-26363.96 542.9,-26339.55 542.56,-26319.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="546.06,-26319.8 542.39,-26309.86 539.06,-26319.92 546.06,-26319.8"/>
</g>
<!-- layer54_attn_ar -->
<g id="node769" class="node">
<title>layer54_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M495.07,-26190.47C495.07,-26190.47 293.07,-26190.47 293.07,-26190.47 287.07,-26190.47 277.3,-26185.8 273.53,-26181.13 273.53,-26181.13 230.47,-26127.8 230.47,-26127.8 226.7,-26123.14 228.93,-26118.47 234.93,-26118.47 234.93,-26118.47 436.93,-26118.47 436.93,-26118.47 442.93,-26118.47 452.7,-26123.14 456.47,-26127.8 456.47,-26127.8 499.53,-26181.13 499.53,-26181.13 503.3,-26185.8 501.07,-26190.47 495.07,-26190.47"/>
<text text-anchor="middle" x="365" y="-26157.47" font-family="Arial" font-size="10.00">Layer 54 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="365" y="-26146.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer54_attn_out_4&#45;&gt;layer54_attn_ar -->
<g id="edge877" class="edge">
<title>layer54_attn_out_4&#45;&gt;layer54_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M220.48,-26262.41C244.92,-26244.33 279.86,-26218.47 309.27,-26196.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="311.45,-26199.45 317.4,-26190.69 307.28,-26193.82 311.45,-26199.45"/>
</g>
<!-- layer54_attn_out_5&#45;&gt;layer54_attn_ar -->
<g id="edge878" class="edge">
<title>layer54_attn_out_5&#45;&gt;layer54_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M511.17,-26262.41C486.45,-26244.33 451.11,-26218.47 421.37,-26196.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="423.28,-26193.77 413.14,-26190.69 419.14,-26199.42 423.28,-26193.77"/>
</g>
<!-- layer54_ffn1_4 -->
<g id="node770" class="node">
<title>layer54_ffn1_4</title>
<path fill="#e6f3ff" stroke="black" d="M335,-26046.47C335,-26046.47 65,-26046.47 65,-26046.47 59,-26046.47 53,-26040.47 53,-26034.47 53,-26034.47 53,-26011.47 53,-26011.47 53,-26005.47 59,-25999.47 65,-25999.47 65,-25999.47 335,-25999.47 335,-25999.47 341,-25999.47 347,-26005.47 347,-26011.47 347,-26011.47 347,-26034.47 347,-26034.47 347,-26040.47 341,-26046.47 335,-26046.47"/>
<text text-anchor="middle" x="200" y="-26031.47" font-family="Arial" font-size="10.00">Layer 54 FFN1 GPU4</text>
<text text-anchor="middle" x="200" y="-26020.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="200" y="-26009.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer54_attn_ar&#45;&gt;layer54_ffn1_4 -->
<g id="edge879" class="edge">
<title>layer54_attn_ar&#45;&gt;layer54_ffn1_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M320.35,-26118.42C294.28,-26097.96 261.78,-26072.45 237.12,-26053.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="239.11,-26050.21 229.08,-26046.79 234.79,-26055.72 239.11,-26050.21"/>
</g>
<!-- layer54_ffn1_5 -->
<g id="node771" class="node">
<title>layer54_ffn1_5</title>
<path fill="#e6f3ff" stroke="black" d="M665,-26046.47C665,-26046.47 395,-26046.47 395,-26046.47 389,-26046.47 383,-26040.47 383,-26034.47 383,-26034.47 383,-26011.47 383,-26011.47 383,-26005.47 389,-25999.47 395,-25999.47 395,-25999.47 665,-25999.47 665,-25999.47 671,-25999.47 677,-26005.47 677,-26011.47 677,-26011.47 677,-26034.47 677,-26034.47 677,-26040.47 671,-26046.47 665,-26046.47"/>
<text text-anchor="middle" x="530" y="-26031.47" font-family="Arial" font-size="10.00">Layer 54 FFN1 GPU5</text>
<text text-anchor="middle" x="530" y="-26020.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="530" y="-26009.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer54_attn_ar&#45;&gt;layer54_ffn1_5 -->
<g id="edge880" class="edge">
<title>layer54_attn_ar&#45;&gt;layer54_ffn1_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M409.65,-26118.42C435.72,-26097.96 468.22,-26072.45 492.88,-26053.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="495.21,-26055.72 500.92,-26046.79 490.89,-26050.21 495.21,-26055.72"/>
</g>
<!-- layer54_act_4 -->
<g id="node772" class="node">
<title>layer54_act_4</title>
<path fill="#e6f3ff" stroke="black" d="M335,-25927.47C335,-25927.47 65,-25927.47 65,-25927.47 59,-25927.47 53,-25921.47 53,-25915.47 53,-25915.47 53,-25892.47 53,-25892.47 53,-25886.47 59,-25880.47 65,-25880.47 65,-25880.47 335,-25880.47 335,-25880.47 341,-25880.47 347,-25886.47 347,-25892.47 347,-25892.47 347,-25915.47 347,-25915.47 347,-25921.47 341,-25927.47 335,-25927.47"/>
<text text-anchor="middle" x="200" y="-25912.47" font-family="Arial" font-size="10.00">Layer 54 SiLU GPU4</text>
<text text-anchor="middle" x="200" y="-25901.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="200" y="-25890.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer54_ffn1_4&#45;&gt;layer54_act_4 -->
<g id="edge881" class="edge">
<title>layer54_ffn1_4&#45;&gt;layer54_act_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M200,-25999.41C200,-25981.96 200,-25957.55 200,-25937.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="203.5,-25937.86 200,-25927.86 196.5,-25937.86 203.5,-25937.86"/>
</g>
<!-- layer54_act_5 -->
<g id="node773" class="node">
<title>layer54_act_5</title>
<path fill="#e6f3ff" stroke="black" d="M665,-25927.47C665,-25927.47 395,-25927.47 395,-25927.47 389,-25927.47 383,-25921.47 383,-25915.47 383,-25915.47 383,-25892.47 383,-25892.47 383,-25886.47 389,-25880.47 395,-25880.47 395,-25880.47 665,-25880.47 665,-25880.47 671,-25880.47 677,-25886.47 677,-25892.47 677,-25892.47 677,-25915.47 677,-25915.47 677,-25921.47 671,-25927.47 665,-25927.47"/>
<text text-anchor="middle" x="530" y="-25912.47" font-family="Arial" font-size="10.00">Layer 54 SiLU GPU5</text>
<text text-anchor="middle" x="530" y="-25901.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="530" y="-25890.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer54_ffn1_5&#45;&gt;layer54_act_5 -->
<g id="edge882" class="edge">
<title>layer54_ffn1_5&#45;&gt;layer54_act_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M530,-25999.41C530,-25981.96 530,-25957.55 530,-25937.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="533.5,-25937.86 530,-25927.86 526.5,-25937.86 533.5,-25937.86"/>
</g>
<!-- layer54_ffn2_4 -->
<g id="node774" class="node">
<title>layer54_ffn2_4</title>
<path fill="#e6f3ff" stroke="black" d="M334.5,-25808.47C334.5,-25808.47 71.5,-25808.47 71.5,-25808.47 65.5,-25808.47 59.5,-25802.47 59.5,-25796.47 59.5,-25796.47 59.5,-25773.47 59.5,-25773.47 59.5,-25767.47 65.5,-25761.47 71.5,-25761.47 71.5,-25761.47 334.5,-25761.47 334.5,-25761.47 340.5,-25761.47 346.5,-25767.47 346.5,-25773.47 346.5,-25773.47 346.5,-25796.47 346.5,-25796.47 346.5,-25802.47 340.5,-25808.47 334.5,-25808.47"/>
<text text-anchor="middle" x="203" y="-25793.47" font-family="Arial" font-size="10.00">Layer 54 FFN2 GPU4</text>
<text text-anchor="middle" x="203" y="-25782.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="203" y="-25771.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer54_act_4&#45;&gt;layer54_ffn2_4 -->
<g id="edge883" class="edge">
<title>layer54_act_4&#45;&gt;layer54_ffn2_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M200.58,-25880.41C201.03,-25862.96 201.65,-25838.55 202.16,-25818.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="205.66,-25818.94 202.41,-25808.86 198.66,-25818.76 205.66,-25818.94"/>
</g>
<!-- layer54_ffn2_5 -->
<g id="node775" class="node">
<title>layer54_ffn2_5</title>
<path fill="#e6f3ff" stroke="black" d="M659.5,-25808.47C659.5,-25808.47 396.5,-25808.47 396.5,-25808.47 390.5,-25808.47 384.5,-25802.47 384.5,-25796.47 384.5,-25796.47 384.5,-25773.47 384.5,-25773.47 384.5,-25767.47 390.5,-25761.47 396.5,-25761.47 396.5,-25761.47 659.5,-25761.47 659.5,-25761.47 665.5,-25761.47 671.5,-25767.47 671.5,-25773.47 671.5,-25773.47 671.5,-25796.47 671.5,-25796.47 671.5,-25802.47 665.5,-25808.47 659.5,-25808.47"/>
<text text-anchor="middle" x="528" y="-25793.47" font-family="Arial" font-size="10.00">Layer 54 FFN2 GPU5</text>
<text text-anchor="middle" x="528" y="-25782.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="528" y="-25771.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer54_act_5&#45;&gt;layer54_ffn2_5 -->
<g id="edge884" class="edge">
<title>layer54_act_5&#45;&gt;layer54_ffn2_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M529.61,-25880.41C529.32,-25862.96 528.9,-25838.55 528.56,-25818.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="532.06,-25818.8 528.39,-25808.86 525.06,-25818.92 532.06,-25818.8"/>
</g>
<!-- layer54_ffn_ar -->
<g id="node776" class="node">
<title>layer54_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M496.22,-25689.47C496.22,-25689.47 290.8,-25689.47 290.8,-25689.47 284.8,-25689.47 275,-25684.83 271.19,-25680.19 271.19,-25680.19 227.39,-25626.75 227.39,-25626.75 223.59,-25622.11 225.78,-25617.47 231.78,-25617.47 231.78,-25617.47 437.2,-25617.47 437.2,-25617.47 443.2,-25617.47 453,-25622.11 456.81,-25626.75 456.81,-25626.75 500.61,-25680.19 500.61,-25680.19 504.41,-25684.83 502.22,-25689.47 496.22,-25689.47"/>
<text text-anchor="middle" x="364" y="-25656.47" font-family="Arial" font-size="10.00">Layer 54 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="364" y="-25645.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer54_ffn2_4&#45;&gt;layer54_ffn_ar -->
<g id="edge885" class="edge">
<title>layer54_ffn2_4&#45;&gt;layer54_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M231.04,-25761.41C253.43,-25743.41 285.4,-25717.69 312.38,-25695.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="314.61,-25698.68 320.21,-25689.69 310.23,-25693.23 314.61,-25698.68"/>
</g>
<!-- layer54_ffn2_5&#45;&gt;layer54_ffn_ar -->
<g id="edge886" class="edge">
<title>layer54_ffn2_5&#45;&gt;layer54_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M499.43,-25761.41C476.63,-25743.41 444.06,-25717.69 416.58,-25695.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="418.62,-25693.14 408.6,-25689.69 414.28,-25698.63 418.62,-25693.14"/>
</g>
<!-- layer55_qkv_4 -->
<g id="node777" class="node">
<title>layer55_qkv_4</title>
<path fill="#e6f3ff" stroke="black" d="M334,-25545.47C334,-25545.47 36,-25545.47 36,-25545.47 30,-25545.47 24,-25539.47 24,-25533.47 24,-25533.47 24,-25510.47 24,-25510.47 24,-25504.47 30,-25498.47 36,-25498.47 36,-25498.47 334,-25498.47 334,-25498.47 340,-25498.47 346,-25504.47 346,-25510.47 346,-25510.47 346,-25533.47 346,-25533.47 346,-25539.47 340,-25545.47 334,-25545.47"/>
<text text-anchor="middle" x="185" y="-25530.47" font-family="Arial" font-size="10.00">Layer 55 QKV Proj GPU4</text>
<text text-anchor="middle" x="185" y="-25519.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="185" y="-25508.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer54_ffn_ar&#45;&gt;layer55_qkv_4 -->
<g id="edge887" class="edge">
<title>layer54_ffn_ar&#45;&gt;layer55_qkv_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M315.56,-25617.42C287.06,-25596.81 251.48,-25571.06 224.66,-25551.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="226.43,-25548.62 216.28,-25545.6 222.33,-25554.3 226.43,-25548.62"/>
</g>
<!-- layer55_qkv_5 -->
<g id="node778" class="node">
<title>layer55_qkv_5</title>
<path fill="#e6f3ff" stroke="black" d="M692,-25545.47C692,-25545.47 394,-25545.47 394,-25545.47 388,-25545.47 382,-25539.47 382,-25533.47 382,-25533.47 382,-25510.47 382,-25510.47 382,-25504.47 388,-25498.47 394,-25498.47 394,-25498.47 692,-25498.47 692,-25498.47 698,-25498.47 704,-25504.47 704,-25510.47 704,-25510.47 704,-25533.47 704,-25533.47 704,-25539.47 698,-25545.47 692,-25545.47"/>
<text text-anchor="middle" x="543" y="-25530.47" font-family="Arial" font-size="10.00">Layer 55 QKV Proj GPU5</text>
<text text-anchor="middle" x="543" y="-25519.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="543" y="-25508.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer54_ffn_ar&#45;&gt;layer55_qkv_5 -->
<g id="edge888" class="edge">
<title>layer54_ffn_ar&#45;&gt;layer55_qkv_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M412.44,-25617.42C440.94,-25596.81 476.52,-25571.06 503.34,-25551.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="505.67,-25554.3 511.72,-25545.6 501.57,-25548.62 505.67,-25554.3"/>
</g>
<!-- layer55_attn_4 -->
<g id="node779" class="node">
<title>layer55_attn_4</title>
<path fill="#e6f3ff" stroke="black" d="M334,-25426.47C334,-25426.47 36,-25426.47 36,-25426.47 30,-25426.47 24,-25420.47 24,-25414.47 24,-25414.47 24,-25391.47 24,-25391.47 24,-25385.47 30,-25379.47 36,-25379.47 36,-25379.47 334,-25379.47 334,-25379.47 340,-25379.47 346,-25385.47 346,-25391.47 346,-25391.47 346,-25414.47 346,-25414.47 346,-25420.47 340,-25426.47 334,-25426.47"/>
<text text-anchor="middle" x="185" y="-25411.47" font-family="Arial" font-size="10.00">Layer 55 Attention GPU4</text>
<text text-anchor="middle" x="185" y="-25400.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="185" y="-25389.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer55_qkv_4&#45;&gt;layer55_attn_4 -->
<g id="edge889" class="edge">
<title>layer55_qkv_4&#45;&gt;layer55_attn_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M185,-25498.41C185,-25480.96 185,-25456.55 185,-25436.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="188.5,-25436.86 185,-25426.86 181.5,-25436.86 188.5,-25436.86"/>
</g>
<!-- layer55_attn_5 -->
<g id="node780" class="node">
<title>layer55_attn_5</title>
<path fill="#e6f3ff" stroke="black" d="M692,-25426.47C692,-25426.47 394,-25426.47 394,-25426.47 388,-25426.47 382,-25420.47 382,-25414.47 382,-25414.47 382,-25391.47 382,-25391.47 382,-25385.47 388,-25379.47 394,-25379.47 394,-25379.47 692,-25379.47 692,-25379.47 698,-25379.47 704,-25385.47 704,-25391.47 704,-25391.47 704,-25414.47 704,-25414.47 704,-25420.47 698,-25426.47 692,-25426.47"/>
<text text-anchor="middle" x="543" y="-25411.47" font-family="Arial" font-size="10.00">Layer 55 Attention GPU5</text>
<text text-anchor="middle" x="543" y="-25400.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="543" y="-25389.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer55_qkv_5&#45;&gt;layer55_attn_5 -->
<g id="edge890" class="edge">
<title>layer55_qkv_5&#45;&gt;layer55_attn_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M543,-25498.41C543,-25480.96 543,-25456.55 543,-25436.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="546.5,-25436.86 543,-25426.86 539.5,-25436.86 546.5,-25436.86"/>
</g>
<!-- layer55_attn_out_4 -->
<g id="node781" class="node">
<title>layer55_attn_out_4</title>
<path fill="#e6f3ff" stroke="black" d="M334,-25307.47C334,-25307.47 44,-25307.47 44,-25307.47 38,-25307.47 32,-25301.47 32,-25295.47 32,-25295.47 32,-25272.47 32,-25272.47 32,-25266.47 38,-25260.47 44,-25260.47 44,-25260.47 334,-25260.47 334,-25260.47 340,-25260.47 346,-25266.47 346,-25272.47 346,-25272.47 346,-25295.47 346,-25295.47 346,-25301.47 340,-25307.47 334,-25307.47"/>
<text text-anchor="middle" x="189" y="-25292.47" font-family="Arial" font-size="10.00">Layer 55 Attn Out GPU4</text>
<text text-anchor="middle" x="189" y="-25281.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="189" y="-25270.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer55_attn_4&#45;&gt;layer55_attn_out_4 -->
<g id="edge891" class="edge">
<title>layer55_attn_4&#45;&gt;layer55_attn_out_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M185.77,-25379.41C186.37,-25361.96 187.2,-25337.55 187.87,-25317.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="191.37,-25317.97 188.22,-25307.86 184.38,-25317.73 191.37,-25317.97"/>
</g>
<!-- layer55_attn_out_5 -->
<g id="node782" class="node">
<title>layer55_attn_out_5</title>
<path fill="#e6f3ff" stroke="black" d="M686,-25307.47C686,-25307.47 396,-25307.47 396,-25307.47 390,-25307.47 384,-25301.47 384,-25295.47 384,-25295.47 384,-25272.47 384,-25272.47 384,-25266.47 390,-25260.47 396,-25260.47 396,-25260.47 686,-25260.47 686,-25260.47 692,-25260.47 698,-25266.47 698,-25272.47 698,-25272.47 698,-25295.47 698,-25295.47 698,-25301.47 692,-25307.47 686,-25307.47"/>
<text text-anchor="middle" x="541" y="-25292.47" font-family="Arial" font-size="10.00">Layer 55 Attn Out GPU5</text>
<text text-anchor="middle" x="541" y="-25281.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="541" y="-25270.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer55_attn_5&#45;&gt;layer55_attn_out_5 -->
<g id="edge892" class="edge">
<title>layer55_attn_5&#45;&gt;layer55_attn_out_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M542.61,-25379.41C542.32,-25361.96 541.9,-25337.55 541.56,-25317.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="545.06,-25317.8 541.39,-25307.86 538.06,-25317.92 545.06,-25317.8"/>
</g>
<!-- layer55_attn_ar -->
<g id="node783" class="node">
<title>layer55_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M494.07,-25188.47C494.07,-25188.47 292.07,-25188.47 292.07,-25188.47 286.07,-25188.47 276.3,-25183.8 272.53,-25179.13 272.53,-25179.13 229.47,-25125.8 229.47,-25125.8 225.7,-25121.14 227.93,-25116.47 233.93,-25116.47 233.93,-25116.47 435.93,-25116.47 435.93,-25116.47 441.93,-25116.47 451.7,-25121.14 455.47,-25125.8 455.47,-25125.8 498.53,-25179.13 498.53,-25179.13 502.3,-25183.8 500.07,-25188.47 494.07,-25188.47"/>
<text text-anchor="middle" x="364" y="-25155.47" font-family="Arial" font-size="10.00">Layer 55 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="364" y="-25144.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer55_attn_out_4&#45;&gt;layer55_attn_ar -->
<g id="edge893" class="edge">
<title>layer55_attn_out_4&#45;&gt;layer55_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M219.48,-25260.41C243.92,-25242.33 278.86,-25216.47 308.27,-25194.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="310.45,-25197.45 316.4,-25188.69 306.28,-25191.82 310.45,-25197.45"/>
</g>
<!-- layer55_attn_out_5&#45;&gt;layer55_attn_ar -->
<g id="edge894" class="edge">
<title>layer55_attn_out_5&#45;&gt;layer55_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M510.17,-25260.41C485.45,-25242.33 450.11,-25216.47 420.37,-25194.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="422.28,-25191.77 412.14,-25188.69 418.14,-25197.42 422.28,-25191.77"/>
</g>
<!-- layer55_ffn1_4 -->
<g id="node784" class="node">
<title>layer55_ffn1_4</title>
<path fill="#e6f3ff" stroke="black" d="M334,-25044.47C334,-25044.47 64,-25044.47 64,-25044.47 58,-25044.47 52,-25038.47 52,-25032.47 52,-25032.47 52,-25009.47 52,-25009.47 52,-25003.47 58,-24997.47 64,-24997.47 64,-24997.47 334,-24997.47 334,-24997.47 340,-24997.47 346,-25003.47 346,-25009.47 346,-25009.47 346,-25032.47 346,-25032.47 346,-25038.47 340,-25044.47 334,-25044.47"/>
<text text-anchor="middle" x="199" y="-25029.47" font-family="Arial" font-size="10.00">Layer 55 FFN1 GPU4</text>
<text text-anchor="middle" x="199" y="-25018.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="199" y="-25007.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer55_attn_ar&#45;&gt;layer55_ffn1_4 -->
<g id="edge895" class="edge">
<title>layer55_attn_ar&#45;&gt;layer55_ffn1_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M319.35,-25116.42C293.28,-25095.96 260.78,-25070.45 236.12,-25051.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="238.11,-25048.21 228.08,-25044.79 233.79,-25053.72 238.11,-25048.21"/>
</g>
<!-- layer55_ffn1_5 -->
<g id="node785" class="node">
<title>layer55_ffn1_5</title>
<path fill="#e6f3ff" stroke="black" d="M664,-25044.47C664,-25044.47 394,-25044.47 394,-25044.47 388,-25044.47 382,-25038.47 382,-25032.47 382,-25032.47 382,-25009.47 382,-25009.47 382,-25003.47 388,-24997.47 394,-24997.47 394,-24997.47 664,-24997.47 664,-24997.47 670,-24997.47 676,-25003.47 676,-25009.47 676,-25009.47 676,-25032.47 676,-25032.47 676,-25038.47 670,-25044.47 664,-25044.47"/>
<text text-anchor="middle" x="529" y="-25029.47" font-family="Arial" font-size="10.00">Layer 55 FFN1 GPU5</text>
<text text-anchor="middle" x="529" y="-25018.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="529" y="-25007.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer55_attn_ar&#45;&gt;layer55_ffn1_5 -->
<g id="edge896" class="edge">
<title>layer55_attn_ar&#45;&gt;layer55_ffn1_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M408.65,-25116.42C434.72,-25095.96 467.22,-25070.45 491.88,-25051.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="494.21,-25053.72 499.92,-25044.79 489.89,-25048.21 494.21,-25053.72"/>
</g>
<!-- layer55_act_4 -->
<g id="node786" class="node">
<title>layer55_act_4</title>
<path fill="#e6f3ff" stroke="black" d="M334,-24925.47C334,-24925.47 64,-24925.47 64,-24925.47 58,-24925.47 52,-24919.47 52,-24913.47 52,-24913.47 52,-24890.47 52,-24890.47 52,-24884.47 58,-24878.47 64,-24878.47 64,-24878.47 334,-24878.47 334,-24878.47 340,-24878.47 346,-24884.47 346,-24890.47 346,-24890.47 346,-24913.47 346,-24913.47 346,-24919.47 340,-24925.47 334,-24925.47"/>
<text text-anchor="middle" x="199" y="-24910.47" font-family="Arial" font-size="10.00">Layer 55 SiLU GPU4</text>
<text text-anchor="middle" x="199" y="-24899.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="199" y="-24888.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer55_ffn1_4&#45;&gt;layer55_act_4 -->
<g id="edge897" class="edge">
<title>layer55_ffn1_4&#45;&gt;layer55_act_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M199,-24997.41C199,-24979.96 199,-24955.55 199,-24935.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="202.5,-24935.86 199,-24925.86 195.5,-24935.86 202.5,-24935.86"/>
</g>
<!-- layer55_act_5 -->
<g id="node787" class="node">
<title>layer55_act_5</title>
<path fill="#e6f3ff" stroke="black" d="M664,-24925.47C664,-24925.47 394,-24925.47 394,-24925.47 388,-24925.47 382,-24919.47 382,-24913.47 382,-24913.47 382,-24890.47 382,-24890.47 382,-24884.47 388,-24878.47 394,-24878.47 394,-24878.47 664,-24878.47 664,-24878.47 670,-24878.47 676,-24884.47 676,-24890.47 676,-24890.47 676,-24913.47 676,-24913.47 676,-24919.47 670,-24925.47 664,-24925.47"/>
<text text-anchor="middle" x="529" y="-24910.47" font-family="Arial" font-size="10.00">Layer 55 SiLU GPU5</text>
<text text-anchor="middle" x="529" y="-24899.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="529" y="-24888.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer55_ffn1_5&#45;&gt;layer55_act_5 -->
<g id="edge898" class="edge">
<title>layer55_ffn1_5&#45;&gt;layer55_act_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M529,-24997.41C529,-24979.96 529,-24955.55 529,-24935.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="532.5,-24935.86 529,-24925.86 525.5,-24935.86 532.5,-24935.86"/>
</g>
<!-- layer55_ffn2_4 -->
<g id="node788" class="node">
<title>layer55_ffn2_4</title>
<path fill="#e6f3ff" stroke="black" d="M333.5,-24806.47C333.5,-24806.47 70.5,-24806.47 70.5,-24806.47 64.5,-24806.47 58.5,-24800.47 58.5,-24794.47 58.5,-24794.47 58.5,-24771.47 58.5,-24771.47 58.5,-24765.47 64.5,-24759.47 70.5,-24759.47 70.5,-24759.47 333.5,-24759.47 333.5,-24759.47 339.5,-24759.47 345.5,-24765.47 345.5,-24771.47 345.5,-24771.47 345.5,-24794.47 345.5,-24794.47 345.5,-24800.47 339.5,-24806.47 333.5,-24806.47"/>
<text text-anchor="middle" x="202" y="-24791.47" font-family="Arial" font-size="10.00">Layer 55 FFN2 GPU4</text>
<text text-anchor="middle" x="202" y="-24780.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="202" y="-24769.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer55_act_4&#45;&gt;layer55_ffn2_4 -->
<g id="edge899" class="edge">
<title>layer55_act_4&#45;&gt;layer55_ffn2_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M199.58,-24878.41C200.03,-24860.96 200.65,-24836.55 201.16,-24816.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="204.66,-24816.94 201.41,-24806.86 197.66,-24816.76 204.66,-24816.94"/>
</g>
<!-- layer55_ffn2_5 -->
<g id="node789" class="node">
<title>layer55_ffn2_5</title>
<path fill="#e6f3ff" stroke="black" d="M658.5,-24806.47C658.5,-24806.47 395.5,-24806.47 395.5,-24806.47 389.5,-24806.47 383.5,-24800.47 383.5,-24794.47 383.5,-24794.47 383.5,-24771.47 383.5,-24771.47 383.5,-24765.47 389.5,-24759.47 395.5,-24759.47 395.5,-24759.47 658.5,-24759.47 658.5,-24759.47 664.5,-24759.47 670.5,-24765.47 670.5,-24771.47 670.5,-24771.47 670.5,-24794.47 670.5,-24794.47 670.5,-24800.47 664.5,-24806.47 658.5,-24806.47"/>
<text text-anchor="middle" x="527" y="-24791.47" font-family="Arial" font-size="10.00">Layer 55 FFN2 GPU5</text>
<text text-anchor="middle" x="527" y="-24780.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="527" y="-24769.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer55_act_5&#45;&gt;layer55_ffn2_5 -->
<g id="edge900" class="edge">
<title>layer55_act_5&#45;&gt;layer55_ffn2_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M528.61,-24878.41C528.32,-24860.96 527.9,-24836.55 527.56,-24816.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="531.06,-24816.8 527.39,-24806.86 524.06,-24816.92 531.06,-24816.8"/>
</g>
<!-- layer55_ffn_ar -->
<g id="node790" class="node">
<title>layer55_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M495.22,-24687.47C495.22,-24687.47 289.8,-24687.47 289.8,-24687.47 283.8,-24687.47 274,-24682.83 270.19,-24678.19 270.19,-24678.19 226.39,-24624.75 226.39,-24624.75 222.59,-24620.11 224.78,-24615.47 230.78,-24615.47 230.78,-24615.47 436.2,-24615.47 436.2,-24615.47 442.2,-24615.47 452,-24620.11 455.81,-24624.75 455.81,-24624.75 499.61,-24678.19 499.61,-24678.19 503.41,-24682.83 501.22,-24687.47 495.22,-24687.47"/>
<text text-anchor="middle" x="363" y="-24654.47" font-family="Arial" font-size="10.00">Layer 55 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="363" y="-24643.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer55_ffn2_4&#45;&gt;layer55_ffn_ar -->
<g id="edge901" class="edge">
<title>layer55_ffn2_4&#45;&gt;layer55_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M230.04,-24759.41C252.43,-24741.41 284.4,-24715.69 311.38,-24693.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="313.61,-24696.68 319.21,-24687.69 309.23,-24691.23 313.61,-24696.68"/>
</g>
<!-- layer55_ffn2_5&#45;&gt;layer55_ffn_ar -->
<g id="edge902" class="edge">
<title>layer55_ffn2_5&#45;&gt;layer55_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M498.43,-24759.41C475.63,-24741.41 443.06,-24715.69 415.58,-24693.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="417.62,-24691.14 407.6,-24687.69 413.28,-24696.63 417.62,-24691.14"/>
</g>
<!-- layer56_qkv_4 -->
<g id="node791" class="node">
<title>layer56_qkv_4</title>
<path fill="#e6f3ff" stroke="black" d="M333,-24543.47C333,-24543.47 35,-24543.47 35,-24543.47 29,-24543.47 23,-24537.47 23,-24531.47 23,-24531.47 23,-24508.47 23,-24508.47 23,-24502.47 29,-24496.47 35,-24496.47 35,-24496.47 333,-24496.47 333,-24496.47 339,-24496.47 345,-24502.47 345,-24508.47 345,-24508.47 345,-24531.47 345,-24531.47 345,-24537.47 339,-24543.47 333,-24543.47"/>
<text text-anchor="middle" x="184" y="-24528.47" font-family="Arial" font-size="10.00">Layer 56 QKV Proj GPU4</text>
<text text-anchor="middle" x="184" y="-24517.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="184" y="-24506.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer55_ffn_ar&#45;&gt;layer56_qkv_4 -->
<g id="edge903" class="edge">
<title>layer55_ffn_ar&#45;&gt;layer56_qkv_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M314.56,-24615.42C286.06,-24594.81 250.48,-24569.06 223.66,-24549.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="225.43,-24546.62 215.28,-24543.6 221.33,-24552.3 225.43,-24546.62"/>
</g>
<!-- layer56_qkv_5 -->
<g id="node792" class="node">
<title>layer56_qkv_5</title>
<path fill="#e6f3ff" stroke="black" d="M691,-24543.47C691,-24543.47 393,-24543.47 393,-24543.47 387,-24543.47 381,-24537.47 381,-24531.47 381,-24531.47 381,-24508.47 381,-24508.47 381,-24502.47 387,-24496.47 393,-24496.47 393,-24496.47 691,-24496.47 691,-24496.47 697,-24496.47 703,-24502.47 703,-24508.47 703,-24508.47 703,-24531.47 703,-24531.47 703,-24537.47 697,-24543.47 691,-24543.47"/>
<text text-anchor="middle" x="542" y="-24528.47" font-family="Arial" font-size="10.00">Layer 56 QKV Proj GPU5</text>
<text text-anchor="middle" x="542" y="-24517.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="542" y="-24506.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer55_ffn_ar&#45;&gt;layer56_qkv_5 -->
<g id="edge904" class="edge">
<title>layer55_ffn_ar&#45;&gt;layer56_qkv_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M411.44,-24615.42C439.94,-24594.81 475.52,-24569.06 502.34,-24549.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="504.67,-24552.3 510.72,-24543.6 500.57,-24546.62 504.67,-24552.3"/>
</g>
<!-- layer56_attn_4 -->
<g id="node793" class="node">
<title>layer56_attn_4</title>
<path fill="#e6f3ff" stroke="black" d="M333,-24424.47C333,-24424.47 35,-24424.47 35,-24424.47 29,-24424.47 23,-24418.47 23,-24412.47 23,-24412.47 23,-24389.47 23,-24389.47 23,-24383.47 29,-24377.47 35,-24377.47 35,-24377.47 333,-24377.47 333,-24377.47 339,-24377.47 345,-24383.47 345,-24389.47 345,-24389.47 345,-24412.47 345,-24412.47 345,-24418.47 339,-24424.47 333,-24424.47"/>
<text text-anchor="middle" x="184" y="-24409.47" font-family="Arial" font-size="10.00">Layer 56 Attention GPU4</text>
<text text-anchor="middle" x="184" y="-24398.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="184" y="-24387.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer56_qkv_4&#45;&gt;layer56_attn_4 -->
<g id="edge905" class="edge">
<title>layer56_qkv_4&#45;&gt;layer56_attn_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M184,-24496.41C184,-24478.96 184,-24454.55 184,-24434.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="187.5,-24434.86 184,-24424.86 180.5,-24434.86 187.5,-24434.86"/>
</g>
<!-- layer56_attn_5 -->
<g id="node794" class="node">
<title>layer56_attn_5</title>
<path fill="#e6f3ff" stroke="black" d="M691,-24424.47C691,-24424.47 393,-24424.47 393,-24424.47 387,-24424.47 381,-24418.47 381,-24412.47 381,-24412.47 381,-24389.47 381,-24389.47 381,-24383.47 387,-24377.47 393,-24377.47 393,-24377.47 691,-24377.47 691,-24377.47 697,-24377.47 703,-24383.47 703,-24389.47 703,-24389.47 703,-24412.47 703,-24412.47 703,-24418.47 697,-24424.47 691,-24424.47"/>
<text text-anchor="middle" x="542" y="-24409.47" font-family="Arial" font-size="10.00">Layer 56 Attention GPU5</text>
<text text-anchor="middle" x="542" y="-24398.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="542" y="-24387.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer56_qkv_5&#45;&gt;layer56_attn_5 -->
<g id="edge906" class="edge">
<title>layer56_qkv_5&#45;&gt;layer56_attn_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M542,-24496.41C542,-24478.96 542,-24454.55 542,-24434.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="545.5,-24434.86 542,-24424.86 538.5,-24434.86 545.5,-24434.86"/>
</g>
<!-- layer56_attn_out_4 -->
<g id="node795" class="node">
<title>layer56_attn_out_4</title>
<path fill="#e6f3ff" stroke="black" d="M333,-24305.47C333,-24305.47 43,-24305.47 43,-24305.47 37,-24305.47 31,-24299.47 31,-24293.47 31,-24293.47 31,-24270.47 31,-24270.47 31,-24264.47 37,-24258.47 43,-24258.47 43,-24258.47 333,-24258.47 333,-24258.47 339,-24258.47 345,-24264.47 345,-24270.47 345,-24270.47 345,-24293.47 345,-24293.47 345,-24299.47 339,-24305.47 333,-24305.47"/>
<text text-anchor="middle" x="188" y="-24290.47" font-family="Arial" font-size="10.00">Layer 56 Attn Out GPU4</text>
<text text-anchor="middle" x="188" y="-24279.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="188" y="-24268.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer56_attn_4&#45;&gt;layer56_attn_out_4 -->
<g id="edge907" class="edge">
<title>layer56_attn_4&#45;&gt;layer56_attn_out_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M184.77,-24377.41C185.37,-24359.96 186.2,-24335.55 186.87,-24315.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="190.37,-24315.97 187.22,-24305.86 183.38,-24315.73 190.37,-24315.97"/>
</g>
<!-- layer56_attn_out_5 -->
<g id="node796" class="node">
<title>layer56_attn_out_5</title>
<path fill="#e6f3ff" stroke="black" d="M685,-24305.47C685,-24305.47 395,-24305.47 395,-24305.47 389,-24305.47 383,-24299.47 383,-24293.47 383,-24293.47 383,-24270.47 383,-24270.47 383,-24264.47 389,-24258.47 395,-24258.47 395,-24258.47 685,-24258.47 685,-24258.47 691,-24258.47 697,-24264.47 697,-24270.47 697,-24270.47 697,-24293.47 697,-24293.47 697,-24299.47 691,-24305.47 685,-24305.47"/>
<text text-anchor="middle" x="540" y="-24290.47" font-family="Arial" font-size="10.00">Layer 56 Attn Out GPU5</text>
<text text-anchor="middle" x="540" y="-24279.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="540" y="-24268.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer56_attn_5&#45;&gt;layer56_attn_out_5 -->
<g id="edge908" class="edge">
<title>layer56_attn_5&#45;&gt;layer56_attn_out_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M541.61,-24377.41C541.32,-24359.96 540.9,-24335.55 540.56,-24315.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="544.06,-24315.8 540.39,-24305.86 537.06,-24315.92 544.06,-24315.8"/>
</g>
<!-- layer56_attn_ar -->
<g id="node797" class="node">
<title>layer56_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M493.07,-24186.47C493.07,-24186.47 291.07,-24186.47 291.07,-24186.47 285.07,-24186.47 275.3,-24181.8 271.53,-24177.13 271.53,-24177.13 228.47,-24123.8 228.47,-24123.8 224.7,-24119.14 226.93,-24114.47 232.93,-24114.47 232.93,-24114.47 434.93,-24114.47 434.93,-24114.47 440.93,-24114.47 450.7,-24119.14 454.47,-24123.8 454.47,-24123.8 497.53,-24177.13 497.53,-24177.13 501.3,-24181.8 499.07,-24186.47 493.07,-24186.47"/>
<text text-anchor="middle" x="363" y="-24153.47" font-family="Arial" font-size="10.00">Layer 56 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="363" y="-24142.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer56_attn_out_4&#45;&gt;layer56_attn_ar -->
<g id="edge909" class="edge">
<title>layer56_attn_out_4&#45;&gt;layer56_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M218.48,-24258.41C242.92,-24240.33 277.86,-24214.47 307.27,-24192.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="309.45,-24195.45 315.4,-24186.69 305.28,-24189.82 309.45,-24195.45"/>
</g>
<!-- layer56_attn_out_5&#45;&gt;layer56_attn_ar -->
<g id="edge910" class="edge">
<title>layer56_attn_out_5&#45;&gt;layer56_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M509.17,-24258.41C484.45,-24240.33 449.11,-24214.47 419.37,-24192.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="421.28,-24189.77 411.14,-24186.69 417.14,-24195.42 421.28,-24189.77"/>
</g>
<!-- layer56_ffn1_4 -->
<g id="node798" class="node">
<title>layer56_ffn1_4</title>
<path fill="#e6f3ff" stroke="black" d="M333,-24042.47C333,-24042.47 63,-24042.47 63,-24042.47 57,-24042.47 51,-24036.47 51,-24030.47 51,-24030.47 51,-24007.47 51,-24007.47 51,-24001.47 57,-23995.47 63,-23995.47 63,-23995.47 333,-23995.47 333,-23995.47 339,-23995.47 345,-24001.47 345,-24007.47 345,-24007.47 345,-24030.47 345,-24030.47 345,-24036.47 339,-24042.47 333,-24042.47"/>
<text text-anchor="middle" x="198" y="-24027.47" font-family="Arial" font-size="10.00">Layer 56 FFN1 GPU4</text>
<text text-anchor="middle" x="198" y="-24016.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="198" y="-24005.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer56_attn_ar&#45;&gt;layer56_ffn1_4 -->
<g id="edge911" class="edge">
<title>layer56_attn_ar&#45;&gt;layer56_ffn1_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M318.35,-24114.42C292.28,-24093.96 259.78,-24068.45 235.12,-24049.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="237.11,-24046.21 227.08,-24042.79 232.79,-24051.72 237.11,-24046.21"/>
</g>
<!-- layer56_ffn1_5 -->
<g id="node799" class="node">
<title>layer56_ffn1_5</title>
<path fill="#e6f3ff" stroke="black" d="M663,-24042.47C663,-24042.47 393,-24042.47 393,-24042.47 387,-24042.47 381,-24036.47 381,-24030.47 381,-24030.47 381,-24007.47 381,-24007.47 381,-24001.47 387,-23995.47 393,-23995.47 393,-23995.47 663,-23995.47 663,-23995.47 669,-23995.47 675,-24001.47 675,-24007.47 675,-24007.47 675,-24030.47 675,-24030.47 675,-24036.47 669,-24042.47 663,-24042.47"/>
<text text-anchor="middle" x="528" y="-24027.47" font-family="Arial" font-size="10.00">Layer 56 FFN1 GPU5</text>
<text text-anchor="middle" x="528" y="-24016.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="528" y="-24005.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer56_attn_ar&#45;&gt;layer56_ffn1_5 -->
<g id="edge912" class="edge">
<title>layer56_attn_ar&#45;&gt;layer56_ffn1_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M407.65,-24114.42C433.72,-24093.96 466.22,-24068.45 490.88,-24049.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="493.21,-24051.72 498.92,-24042.79 488.89,-24046.21 493.21,-24051.72"/>
</g>
<!-- layer56_act_4 -->
<g id="node800" class="node">
<title>layer56_act_4</title>
<path fill="#e6f3ff" stroke="black" d="M333,-23923.47C333,-23923.47 63,-23923.47 63,-23923.47 57,-23923.47 51,-23917.47 51,-23911.47 51,-23911.47 51,-23888.47 51,-23888.47 51,-23882.47 57,-23876.47 63,-23876.47 63,-23876.47 333,-23876.47 333,-23876.47 339,-23876.47 345,-23882.47 345,-23888.47 345,-23888.47 345,-23911.47 345,-23911.47 345,-23917.47 339,-23923.47 333,-23923.47"/>
<text text-anchor="middle" x="198" y="-23908.47" font-family="Arial" font-size="10.00">Layer 56 SiLU GPU4</text>
<text text-anchor="middle" x="198" y="-23897.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="198" y="-23886.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer56_ffn1_4&#45;&gt;layer56_act_4 -->
<g id="edge913" class="edge">
<title>layer56_ffn1_4&#45;&gt;layer56_act_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M198,-23995.41C198,-23977.96 198,-23953.55 198,-23933.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="201.5,-23933.86 198,-23923.86 194.5,-23933.86 201.5,-23933.86"/>
</g>
<!-- layer56_act_5 -->
<g id="node801" class="node">
<title>layer56_act_5</title>
<path fill="#e6f3ff" stroke="black" d="M663,-23923.47C663,-23923.47 393,-23923.47 393,-23923.47 387,-23923.47 381,-23917.47 381,-23911.47 381,-23911.47 381,-23888.47 381,-23888.47 381,-23882.47 387,-23876.47 393,-23876.47 393,-23876.47 663,-23876.47 663,-23876.47 669,-23876.47 675,-23882.47 675,-23888.47 675,-23888.47 675,-23911.47 675,-23911.47 675,-23917.47 669,-23923.47 663,-23923.47"/>
<text text-anchor="middle" x="528" y="-23908.47" font-family="Arial" font-size="10.00">Layer 56 SiLU GPU5</text>
<text text-anchor="middle" x="528" y="-23897.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="528" y="-23886.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer56_ffn1_5&#45;&gt;layer56_act_5 -->
<g id="edge914" class="edge">
<title>layer56_ffn1_5&#45;&gt;layer56_act_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M528,-23995.41C528,-23977.96 528,-23953.55 528,-23933.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="531.5,-23933.86 528,-23923.86 524.5,-23933.86 531.5,-23933.86"/>
</g>
<!-- layer56_ffn2_4 -->
<g id="node802" class="node">
<title>layer56_ffn2_4</title>
<path fill="#e6f3ff" stroke="black" d="M332.5,-23804.47C332.5,-23804.47 69.5,-23804.47 69.5,-23804.47 63.5,-23804.47 57.5,-23798.47 57.5,-23792.47 57.5,-23792.47 57.5,-23769.47 57.5,-23769.47 57.5,-23763.47 63.5,-23757.47 69.5,-23757.47 69.5,-23757.47 332.5,-23757.47 332.5,-23757.47 338.5,-23757.47 344.5,-23763.47 344.5,-23769.47 344.5,-23769.47 344.5,-23792.47 344.5,-23792.47 344.5,-23798.47 338.5,-23804.47 332.5,-23804.47"/>
<text text-anchor="middle" x="201" y="-23789.47" font-family="Arial" font-size="10.00">Layer 56 FFN2 GPU4</text>
<text text-anchor="middle" x="201" y="-23778.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="201" y="-23767.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer56_act_4&#45;&gt;layer56_ffn2_4 -->
<g id="edge915" class="edge">
<title>layer56_act_4&#45;&gt;layer56_ffn2_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M198.58,-23876.41C199.03,-23858.96 199.65,-23834.55 200.16,-23814.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="203.66,-23814.94 200.41,-23804.86 196.66,-23814.76 203.66,-23814.94"/>
</g>
<!-- layer56_ffn2_5 -->
<g id="node803" class="node">
<title>layer56_ffn2_5</title>
<path fill="#e6f3ff" stroke="black" d="M657.5,-23804.47C657.5,-23804.47 394.5,-23804.47 394.5,-23804.47 388.5,-23804.47 382.5,-23798.47 382.5,-23792.47 382.5,-23792.47 382.5,-23769.47 382.5,-23769.47 382.5,-23763.47 388.5,-23757.47 394.5,-23757.47 394.5,-23757.47 657.5,-23757.47 657.5,-23757.47 663.5,-23757.47 669.5,-23763.47 669.5,-23769.47 669.5,-23769.47 669.5,-23792.47 669.5,-23792.47 669.5,-23798.47 663.5,-23804.47 657.5,-23804.47"/>
<text text-anchor="middle" x="526" y="-23789.47" font-family="Arial" font-size="10.00">Layer 56 FFN2 GPU5</text>
<text text-anchor="middle" x="526" y="-23778.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="526" y="-23767.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer56_act_5&#45;&gt;layer56_ffn2_5 -->
<g id="edge916" class="edge">
<title>layer56_act_5&#45;&gt;layer56_ffn2_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M527.61,-23876.41C527.32,-23858.96 526.9,-23834.55 526.56,-23814.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="530.06,-23814.8 526.39,-23804.86 523.06,-23814.92 530.06,-23814.8"/>
</g>
<!-- layer56_ffn_ar -->
<g id="node804" class="node">
<title>layer56_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M494.22,-23685.47C494.22,-23685.47 288.8,-23685.47 288.8,-23685.47 282.8,-23685.47 273,-23680.83 269.19,-23676.19 269.19,-23676.19 225.39,-23622.75 225.39,-23622.75 221.59,-23618.11 223.78,-23613.47 229.78,-23613.47 229.78,-23613.47 435.2,-23613.47 435.2,-23613.47 441.2,-23613.47 451,-23618.11 454.81,-23622.75 454.81,-23622.75 498.61,-23676.19 498.61,-23676.19 502.41,-23680.83 500.22,-23685.47 494.22,-23685.47"/>
<text text-anchor="middle" x="362" y="-23652.47" font-family="Arial" font-size="10.00">Layer 56 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="362" y="-23641.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer56_ffn2_4&#45;&gt;layer56_ffn_ar -->
<g id="edge917" class="edge">
<title>layer56_ffn2_4&#45;&gt;layer56_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M229.04,-23757.41C251.43,-23739.41 283.4,-23713.69 310.38,-23691.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="312.61,-23694.68 318.21,-23685.69 308.23,-23689.23 312.61,-23694.68"/>
</g>
<!-- layer56_ffn2_5&#45;&gt;layer56_ffn_ar -->
<g id="edge918" class="edge">
<title>layer56_ffn2_5&#45;&gt;layer56_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M497.43,-23757.41C474.63,-23739.41 442.06,-23713.69 414.58,-23691.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="416.62,-23689.14 406.6,-23685.69 412.28,-23694.63 416.62,-23689.14"/>
</g>
<!-- layer57_qkv_4 -->
<g id="node805" class="node">
<title>layer57_qkv_4</title>
<path fill="#e6f3ff" stroke="black" d="M332,-23541.47C332,-23541.47 34,-23541.47 34,-23541.47 28,-23541.47 22,-23535.47 22,-23529.47 22,-23529.47 22,-23506.47 22,-23506.47 22,-23500.47 28,-23494.47 34,-23494.47 34,-23494.47 332,-23494.47 332,-23494.47 338,-23494.47 344,-23500.47 344,-23506.47 344,-23506.47 344,-23529.47 344,-23529.47 344,-23535.47 338,-23541.47 332,-23541.47"/>
<text text-anchor="middle" x="183" y="-23526.47" font-family="Arial" font-size="10.00">Layer 57 QKV Proj GPU4</text>
<text text-anchor="middle" x="183" y="-23515.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="183" y="-23504.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer56_ffn_ar&#45;&gt;layer57_qkv_4 -->
<g id="edge919" class="edge">
<title>layer56_ffn_ar&#45;&gt;layer57_qkv_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M313.56,-23613.42C285.06,-23592.81 249.48,-23567.06 222.66,-23547.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="224.43,-23544.62 214.28,-23541.6 220.33,-23550.3 224.43,-23544.62"/>
</g>
<!-- layer57_qkv_5 -->
<g id="node806" class="node">
<title>layer57_qkv_5</title>
<path fill="#e6f3ff" stroke="black" d="M690,-23541.47C690,-23541.47 392,-23541.47 392,-23541.47 386,-23541.47 380,-23535.47 380,-23529.47 380,-23529.47 380,-23506.47 380,-23506.47 380,-23500.47 386,-23494.47 392,-23494.47 392,-23494.47 690,-23494.47 690,-23494.47 696,-23494.47 702,-23500.47 702,-23506.47 702,-23506.47 702,-23529.47 702,-23529.47 702,-23535.47 696,-23541.47 690,-23541.47"/>
<text text-anchor="middle" x="541" y="-23526.47" font-family="Arial" font-size="10.00">Layer 57 QKV Proj GPU5</text>
<text text-anchor="middle" x="541" y="-23515.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="541" y="-23504.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer56_ffn_ar&#45;&gt;layer57_qkv_5 -->
<g id="edge920" class="edge">
<title>layer56_ffn_ar&#45;&gt;layer57_qkv_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M410.44,-23613.42C438.94,-23592.81 474.52,-23567.06 501.34,-23547.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="503.67,-23550.3 509.72,-23541.6 499.57,-23544.62 503.67,-23550.3"/>
</g>
<!-- layer57_attn_4 -->
<g id="node807" class="node">
<title>layer57_attn_4</title>
<path fill="#e6f3ff" stroke="black" d="M332,-23422.47C332,-23422.47 34,-23422.47 34,-23422.47 28,-23422.47 22,-23416.47 22,-23410.47 22,-23410.47 22,-23387.47 22,-23387.47 22,-23381.47 28,-23375.47 34,-23375.47 34,-23375.47 332,-23375.47 332,-23375.47 338,-23375.47 344,-23381.47 344,-23387.47 344,-23387.47 344,-23410.47 344,-23410.47 344,-23416.47 338,-23422.47 332,-23422.47"/>
<text text-anchor="middle" x="183" y="-23407.47" font-family="Arial" font-size="10.00">Layer 57 Attention GPU4</text>
<text text-anchor="middle" x="183" y="-23396.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="183" y="-23385.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer57_qkv_4&#45;&gt;layer57_attn_4 -->
<g id="edge921" class="edge">
<title>layer57_qkv_4&#45;&gt;layer57_attn_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M183,-23494.41C183,-23476.96 183,-23452.55 183,-23432.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="186.5,-23432.86 183,-23422.86 179.5,-23432.86 186.5,-23432.86"/>
</g>
<!-- layer57_attn_5 -->
<g id="node808" class="node">
<title>layer57_attn_5</title>
<path fill="#e6f3ff" stroke="black" d="M690,-23422.47C690,-23422.47 392,-23422.47 392,-23422.47 386,-23422.47 380,-23416.47 380,-23410.47 380,-23410.47 380,-23387.47 380,-23387.47 380,-23381.47 386,-23375.47 392,-23375.47 392,-23375.47 690,-23375.47 690,-23375.47 696,-23375.47 702,-23381.47 702,-23387.47 702,-23387.47 702,-23410.47 702,-23410.47 702,-23416.47 696,-23422.47 690,-23422.47"/>
<text text-anchor="middle" x="541" y="-23407.47" font-family="Arial" font-size="10.00">Layer 57 Attention GPU5</text>
<text text-anchor="middle" x="541" y="-23396.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="541" y="-23385.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer57_qkv_5&#45;&gt;layer57_attn_5 -->
<g id="edge922" class="edge">
<title>layer57_qkv_5&#45;&gt;layer57_attn_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M541,-23494.41C541,-23476.96 541,-23452.55 541,-23432.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="544.5,-23432.86 541,-23422.86 537.5,-23432.86 544.5,-23432.86"/>
</g>
<!-- layer57_attn_out_4 -->
<g id="node809" class="node">
<title>layer57_attn_out_4</title>
<path fill="#e6f3ff" stroke="black" d="M332,-23303.47C332,-23303.47 42,-23303.47 42,-23303.47 36,-23303.47 30,-23297.47 30,-23291.47 30,-23291.47 30,-23268.47 30,-23268.47 30,-23262.47 36,-23256.47 42,-23256.47 42,-23256.47 332,-23256.47 332,-23256.47 338,-23256.47 344,-23262.47 344,-23268.47 344,-23268.47 344,-23291.47 344,-23291.47 344,-23297.47 338,-23303.47 332,-23303.47"/>
<text text-anchor="middle" x="187" y="-23288.47" font-family="Arial" font-size="10.00">Layer 57 Attn Out GPU4</text>
<text text-anchor="middle" x="187" y="-23277.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="187" y="-23266.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer57_attn_4&#45;&gt;layer57_attn_out_4 -->
<g id="edge923" class="edge">
<title>layer57_attn_4&#45;&gt;layer57_attn_out_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M183.77,-23375.41C184.37,-23357.96 185.2,-23333.55 185.87,-23313.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="189.37,-23313.97 186.22,-23303.86 182.38,-23313.73 189.37,-23313.97"/>
</g>
<!-- layer57_attn_out_5 -->
<g id="node810" class="node">
<title>layer57_attn_out_5</title>
<path fill="#e6f3ff" stroke="black" d="M684,-23303.47C684,-23303.47 394,-23303.47 394,-23303.47 388,-23303.47 382,-23297.47 382,-23291.47 382,-23291.47 382,-23268.47 382,-23268.47 382,-23262.47 388,-23256.47 394,-23256.47 394,-23256.47 684,-23256.47 684,-23256.47 690,-23256.47 696,-23262.47 696,-23268.47 696,-23268.47 696,-23291.47 696,-23291.47 696,-23297.47 690,-23303.47 684,-23303.47"/>
<text text-anchor="middle" x="539" y="-23288.47" font-family="Arial" font-size="10.00">Layer 57 Attn Out GPU5</text>
<text text-anchor="middle" x="539" y="-23277.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="539" y="-23266.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer57_attn_5&#45;&gt;layer57_attn_out_5 -->
<g id="edge924" class="edge">
<title>layer57_attn_5&#45;&gt;layer57_attn_out_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M540.61,-23375.41C540.32,-23357.96 539.9,-23333.55 539.56,-23313.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="543.06,-23313.8 539.39,-23303.86 536.06,-23313.92 543.06,-23313.8"/>
</g>
<!-- layer57_attn_ar -->
<g id="node811" class="node">
<title>layer57_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M492.07,-23184.47C492.07,-23184.47 290.07,-23184.47 290.07,-23184.47 284.07,-23184.47 274.3,-23179.8 270.53,-23175.13 270.53,-23175.13 227.47,-23121.8 227.47,-23121.8 223.7,-23117.14 225.93,-23112.47 231.93,-23112.47 231.93,-23112.47 433.93,-23112.47 433.93,-23112.47 439.93,-23112.47 449.7,-23117.14 453.47,-23121.8 453.47,-23121.8 496.53,-23175.13 496.53,-23175.13 500.3,-23179.8 498.07,-23184.47 492.07,-23184.47"/>
<text text-anchor="middle" x="362" y="-23151.47" font-family="Arial" font-size="10.00">Layer 57 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="362" y="-23140.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer57_attn_out_4&#45;&gt;layer57_attn_ar -->
<g id="edge925" class="edge">
<title>layer57_attn_out_4&#45;&gt;layer57_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M217.48,-23256.41C241.92,-23238.33 276.86,-23212.47 306.27,-23190.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="308.45,-23193.45 314.4,-23184.69 304.28,-23187.82 308.45,-23193.45"/>
</g>
<!-- layer57_attn_out_5&#45;&gt;layer57_attn_ar -->
<g id="edge926" class="edge">
<title>layer57_attn_out_5&#45;&gt;layer57_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M508.17,-23256.41C483.45,-23238.33 448.11,-23212.47 418.37,-23190.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="420.28,-23187.77 410.14,-23184.69 416.14,-23193.42 420.28,-23187.77"/>
</g>
<!-- layer57_ffn1_4 -->
<g id="node812" class="node">
<title>layer57_ffn1_4</title>
<path fill="#e6f3ff" stroke="black" d="M332,-23040.47C332,-23040.47 62,-23040.47 62,-23040.47 56,-23040.47 50,-23034.47 50,-23028.47 50,-23028.47 50,-23005.47 50,-23005.47 50,-22999.47 56,-22993.47 62,-22993.47 62,-22993.47 332,-22993.47 332,-22993.47 338,-22993.47 344,-22999.47 344,-23005.47 344,-23005.47 344,-23028.47 344,-23028.47 344,-23034.47 338,-23040.47 332,-23040.47"/>
<text text-anchor="middle" x="197" y="-23025.47" font-family="Arial" font-size="10.00">Layer 57 FFN1 GPU4</text>
<text text-anchor="middle" x="197" y="-23014.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="197" y="-23003.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer57_attn_ar&#45;&gt;layer57_ffn1_4 -->
<g id="edge927" class="edge">
<title>layer57_attn_ar&#45;&gt;layer57_ffn1_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M317.35,-23112.42C291.28,-23091.96 258.78,-23066.45 234.12,-23047.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="236.11,-23044.21 226.08,-23040.79 231.79,-23049.72 236.11,-23044.21"/>
</g>
<!-- layer57_ffn1_5 -->
<g id="node813" class="node">
<title>layer57_ffn1_5</title>
<path fill="#e6f3ff" stroke="black" d="M662,-23040.47C662,-23040.47 392,-23040.47 392,-23040.47 386,-23040.47 380,-23034.47 380,-23028.47 380,-23028.47 380,-23005.47 380,-23005.47 380,-22999.47 386,-22993.47 392,-22993.47 392,-22993.47 662,-22993.47 662,-22993.47 668,-22993.47 674,-22999.47 674,-23005.47 674,-23005.47 674,-23028.47 674,-23028.47 674,-23034.47 668,-23040.47 662,-23040.47"/>
<text text-anchor="middle" x="527" y="-23025.47" font-family="Arial" font-size="10.00">Layer 57 FFN1 GPU5</text>
<text text-anchor="middle" x="527" y="-23014.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="527" y="-23003.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer57_attn_ar&#45;&gt;layer57_ffn1_5 -->
<g id="edge928" class="edge">
<title>layer57_attn_ar&#45;&gt;layer57_ffn1_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M406.65,-23112.42C432.72,-23091.96 465.22,-23066.45 489.88,-23047.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="492.21,-23049.72 497.92,-23040.79 487.89,-23044.21 492.21,-23049.72"/>
</g>
<!-- layer57_act_4 -->
<g id="node814" class="node">
<title>layer57_act_4</title>
<path fill="#e6f3ff" stroke="black" d="M332,-22921.47C332,-22921.47 62,-22921.47 62,-22921.47 56,-22921.47 50,-22915.47 50,-22909.47 50,-22909.47 50,-22886.47 50,-22886.47 50,-22880.47 56,-22874.47 62,-22874.47 62,-22874.47 332,-22874.47 332,-22874.47 338,-22874.47 344,-22880.47 344,-22886.47 344,-22886.47 344,-22909.47 344,-22909.47 344,-22915.47 338,-22921.47 332,-22921.47"/>
<text text-anchor="middle" x="197" y="-22906.47" font-family="Arial" font-size="10.00">Layer 57 SiLU GPU4</text>
<text text-anchor="middle" x="197" y="-22895.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="197" y="-22884.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer57_ffn1_4&#45;&gt;layer57_act_4 -->
<g id="edge929" class="edge">
<title>layer57_ffn1_4&#45;&gt;layer57_act_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M197,-22993.41C197,-22975.96 197,-22951.55 197,-22931.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="200.5,-22931.86 197,-22921.86 193.5,-22931.86 200.5,-22931.86"/>
</g>
<!-- layer57_act_5 -->
<g id="node815" class="node">
<title>layer57_act_5</title>
<path fill="#e6f3ff" stroke="black" d="M662,-22921.47C662,-22921.47 392,-22921.47 392,-22921.47 386,-22921.47 380,-22915.47 380,-22909.47 380,-22909.47 380,-22886.47 380,-22886.47 380,-22880.47 386,-22874.47 392,-22874.47 392,-22874.47 662,-22874.47 662,-22874.47 668,-22874.47 674,-22880.47 674,-22886.47 674,-22886.47 674,-22909.47 674,-22909.47 674,-22915.47 668,-22921.47 662,-22921.47"/>
<text text-anchor="middle" x="527" y="-22906.47" font-family="Arial" font-size="10.00">Layer 57 SiLU GPU5</text>
<text text-anchor="middle" x="527" y="-22895.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="527" y="-22884.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer57_ffn1_5&#45;&gt;layer57_act_5 -->
<g id="edge930" class="edge">
<title>layer57_ffn1_5&#45;&gt;layer57_act_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M527,-22993.41C527,-22975.96 527,-22951.55 527,-22931.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="530.5,-22931.86 527,-22921.86 523.5,-22931.86 530.5,-22931.86"/>
</g>
<!-- layer57_ffn2_4 -->
<g id="node816" class="node">
<title>layer57_ffn2_4</title>
<path fill="#e6f3ff" stroke="black" d="M331.5,-22802.47C331.5,-22802.47 68.5,-22802.47 68.5,-22802.47 62.5,-22802.47 56.5,-22796.47 56.5,-22790.47 56.5,-22790.47 56.5,-22767.47 56.5,-22767.47 56.5,-22761.47 62.5,-22755.47 68.5,-22755.47 68.5,-22755.47 331.5,-22755.47 331.5,-22755.47 337.5,-22755.47 343.5,-22761.47 343.5,-22767.47 343.5,-22767.47 343.5,-22790.47 343.5,-22790.47 343.5,-22796.47 337.5,-22802.47 331.5,-22802.47"/>
<text text-anchor="middle" x="200" y="-22787.47" font-family="Arial" font-size="10.00">Layer 57 FFN2 GPU4</text>
<text text-anchor="middle" x="200" y="-22776.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="200" y="-22765.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer57_act_4&#45;&gt;layer57_ffn2_4 -->
<g id="edge931" class="edge">
<title>layer57_act_4&#45;&gt;layer57_ffn2_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M197.58,-22874.41C198.03,-22856.96 198.65,-22832.55 199.16,-22812.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="202.66,-22812.94 199.41,-22802.86 195.66,-22812.76 202.66,-22812.94"/>
</g>
<!-- layer57_ffn2_5 -->
<g id="node817" class="node">
<title>layer57_ffn2_5</title>
<path fill="#e6f3ff" stroke="black" d="M656.5,-22802.47C656.5,-22802.47 393.5,-22802.47 393.5,-22802.47 387.5,-22802.47 381.5,-22796.47 381.5,-22790.47 381.5,-22790.47 381.5,-22767.47 381.5,-22767.47 381.5,-22761.47 387.5,-22755.47 393.5,-22755.47 393.5,-22755.47 656.5,-22755.47 656.5,-22755.47 662.5,-22755.47 668.5,-22761.47 668.5,-22767.47 668.5,-22767.47 668.5,-22790.47 668.5,-22790.47 668.5,-22796.47 662.5,-22802.47 656.5,-22802.47"/>
<text text-anchor="middle" x="525" y="-22787.47" font-family="Arial" font-size="10.00">Layer 57 FFN2 GPU5</text>
<text text-anchor="middle" x="525" y="-22776.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="525" y="-22765.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer57_act_5&#45;&gt;layer57_ffn2_5 -->
<g id="edge932" class="edge">
<title>layer57_act_5&#45;&gt;layer57_ffn2_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M526.61,-22874.41C526.32,-22856.96 525.9,-22832.55 525.56,-22812.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="529.06,-22812.8 525.39,-22802.86 522.06,-22812.92 529.06,-22812.8"/>
</g>
<!-- layer57_ffn_ar -->
<g id="node818" class="node">
<title>layer57_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M493.22,-22683.47C493.22,-22683.47 287.8,-22683.47 287.8,-22683.47 281.8,-22683.47 272,-22678.83 268.19,-22674.19 268.19,-22674.19 224.39,-22620.75 224.39,-22620.75 220.59,-22616.11 222.78,-22611.47 228.78,-22611.47 228.78,-22611.47 434.2,-22611.47 434.2,-22611.47 440.2,-22611.47 450,-22616.11 453.81,-22620.75 453.81,-22620.75 497.61,-22674.19 497.61,-22674.19 501.41,-22678.83 499.22,-22683.47 493.22,-22683.47"/>
<text text-anchor="middle" x="361" y="-22650.47" font-family="Arial" font-size="10.00">Layer 57 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="361" y="-22639.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer57_ffn2_4&#45;&gt;layer57_ffn_ar -->
<g id="edge933" class="edge">
<title>layer57_ffn2_4&#45;&gt;layer57_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M228.04,-22755.41C250.43,-22737.41 282.4,-22711.69 309.38,-22689.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="311.61,-22692.68 317.21,-22683.69 307.23,-22687.23 311.61,-22692.68"/>
</g>
<!-- layer57_ffn2_5&#45;&gt;layer57_ffn_ar -->
<g id="edge934" class="edge">
<title>layer57_ffn2_5&#45;&gt;layer57_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M496.43,-22755.41C473.63,-22737.41 441.06,-22711.69 413.58,-22689.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="415.62,-22687.14 405.6,-22683.69 411.28,-22692.63 415.62,-22687.14"/>
</g>
<!-- layer58_qkv_4 -->
<g id="node819" class="node">
<title>layer58_qkv_4</title>
<path fill="#e6f3ff" stroke="black" d="M331,-22539.47C331,-22539.47 33,-22539.47 33,-22539.47 27,-22539.47 21,-22533.47 21,-22527.47 21,-22527.47 21,-22504.47 21,-22504.47 21,-22498.47 27,-22492.47 33,-22492.47 33,-22492.47 331,-22492.47 331,-22492.47 337,-22492.47 343,-22498.47 343,-22504.47 343,-22504.47 343,-22527.47 343,-22527.47 343,-22533.47 337,-22539.47 331,-22539.47"/>
<text text-anchor="middle" x="182" y="-22524.47" font-family="Arial" font-size="10.00">Layer 58 QKV Proj GPU4</text>
<text text-anchor="middle" x="182" y="-22513.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="182" y="-22502.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer57_ffn_ar&#45;&gt;layer58_qkv_4 -->
<g id="edge935" class="edge">
<title>layer57_ffn_ar&#45;&gt;layer58_qkv_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M312.56,-22611.42C284.06,-22590.81 248.48,-22565.06 221.66,-22545.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="223.43,-22542.62 213.28,-22539.6 219.33,-22548.3 223.43,-22542.62"/>
</g>
<!-- layer58_qkv_5 -->
<g id="node820" class="node">
<title>layer58_qkv_5</title>
<path fill="#e6f3ff" stroke="black" d="M689,-22539.47C689,-22539.47 391,-22539.47 391,-22539.47 385,-22539.47 379,-22533.47 379,-22527.47 379,-22527.47 379,-22504.47 379,-22504.47 379,-22498.47 385,-22492.47 391,-22492.47 391,-22492.47 689,-22492.47 689,-22492.47 695,-22492.47 701,-22498.47 701,-22504.47 701,-22504.47 701,-22527.47 701,-22527.47 701,-22533.47 695,-22539.47 689,-22539.47"/>
<text text-anchor="middle" x="540" y="-22524.47" font-family="Arial" font-size="10.00">Layer 58 QKV Proj GPU5</text>
<text text-anchor="middle" x="540" y="-22513.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-22502.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer57_ffn_ar&#45;&gt;layer58_qkv_5 -->
<g id="edge936" class="edge">
<title>layer57_ffn_ar&#45;&gt;layer58_qkv_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M409.44,-22611.42C437.94,-22590.81 473.52,-22565.06 500.34,-22545.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="502.67,-22548.3 508.72,-22539.6 498.57,-22542.62 502.67,-22548.3"/>
</g>
<!-- layer58_attn_4 -->
<g id="node821" class="node">
<title>layer58_attn_4</title>
<path fill="#e6f3ff" stroke="black" d="M331,-22420.47C331,-22420.47 33,-22420.47 33,-22420.47 27,-22420.47 21,-22414.47 21,-22408.47 21,-22408.47 21,-22385.47 21,-22385.47 21,-22379.47 27,-22373.47 33,-22373.47 33,-22373.47 331,-22373.47 331,-22373.47 337,-22373.47 343,-22379.47 343,-22385.47 343,-22385.47 343,-22408.47 343,-22408.47 343,-22414.47 337,-22420.47 331,-22420.47"/>
<text text-anchor="middle" x="182" y="-22405.47" font-family="Arial" font-size="10.00">Layer 58 Attention GPU4</text>
<text text-anchor="middle" x="182" y="-22394.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="182" y="-22383.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer58_qkv_4&#45;&gt;layer58_attn_4 -->
<g id="edge937" class="edge">
<title>layer58_qkv_4&#45;&gt;layer58_attn_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M182,-22492.41C182,-22474.96 182,-22450.55 182,-22430.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="185.5,-22430.86 182,-22420.86 178.5,-22430.86 185.5,-22430.86"/>
</g>
<!-- layer58_attn_5 -->
<g id="node822" class="node">
<title>layer58_attn_5</title>
<path fill="#e6f3ff" stroke="black" d="M689,-22420.47C689,-22420.47 391,-22420.47 391,-22420.47 385,-22420.47 379,-22414.47 379,-22408.47 379,-22408.47 379,-22385.47 379,-22385.47 379,-22379.47 385,-22373.47 391,-22373.47 391,-22373.47 689,-22373.47 689,-22373.47 695,-22373.47 701,-22379.47 701,-22385.47 701,-22385.47 701,-22408.47 701,-22408.47 701,-22414.47 695,-22420.47 689,-22420.47"/>
<text text-anchor="middle" x="540" y="-22405.47" font-family="Arial" font-size="10.00">Layer 58 Attention GPU5</text>
<text text-anchor="middle" x="540" y="-22394.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="540" y="-22383.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer58_qkv_5&#45;&gt;layer58_attn_5 -->
<g id="edge938" class="edge">
<title>layer58_qkv_5&#45;&gt;layer58_attn_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M540,-22492.41C540,-22474.96 540,-22450.55 540,-22430.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="543.5,-22430.86 540,-22420.86 536.5,-22430.86 543.5,-22430.86"/>
</g>
<!-- layer58_attn_out_4 -->
<g id="node823" class="node">
<title>layer58_attn_out_4</title>
<path fill="#e6f3ff" stroke="black" d="M331,-22301.47C331,-22301.47 41,-22301.47 41,-22301.47 35,-22301.47 29,-22295.47 29,-22289.47 29,-22289.47 29,-22266.47 29,-22266.47 29,-22260.47 35,-22254.47 41,-22254.47 41,-22254.47 331,-22254.47 331,-22254.47 337,-22254.47 343,-22260.47 343,-22266.47 343,-22266.47 343,-22289.47 343,-22289.47 343,-22295.47 337,-22301.47 331,-22301.47"/>
<text text-anchor="middle" x="186" y="-22286.47" font-family="Arial" font-size="10.00">Layer 58 Attn Out GPU4</text>
<text text-anchor="middle" x="186" y="-22275.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="186" y="-22264.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer58_attn_4&#45;&gt;layer58_attn_out_4 -->
<g id="edge939" class="edge">
<title>layer58_attn_4&#45;&gt;layer58_attn_out_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M182.77,-22373.41C183.37,-22355.96 184.2,-22331.55 184.87,-22311.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="188.37,-22311.97 185.22,-22301.86 181.38,-22311.73 188.37,-22311.97"/>
</g>
<!-- layer58_attn_out_5 -->
<g id="node824" class="node">
<title>layer58_attn_out_5</title>
<path fill="#e6f3ff" stroke="black" d="M683,-22301.47C683,-22301.47 393,-22301.47 393,-22301.47 387,-22301.47 381,-22295.47 381,-22289.47 381,-22289.47 381,-22266.47 381,-22266.47 381,-22260.47 387,-22254.47 393,-22254.47 393,-22254.47 683,-22254.47 683,-22254.47 689,-22254.47 695,-22260.47 695,-22266.47 695,-22266.47 695,-22289.47 695,-22289.47 695,-22295.47 689,-22301.47 683,-22301.47"/>
<text text-anchor="middle" x="538" y="-22286.47" font-family="Arial" font-size="10.00">Layer 58 Attn Out GPU5</text>
<text text-anchor="middle" x="538" y="-22275.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="538" y="-22264.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer58_attn_5&#45;&gt;layer58_attn_out_5 -->
<g id="edge940" class="edge">
<title>layer58_attn_5&#45;&gt;layer58_attn_out_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M539.61,-22373.41C539.32,-22355.96 538.9,-22331.55 538.56,-22311.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="542.06,-22311.8 538.39,-22301.86 535.06,-22311.92 542.06,-22311.8"/>
</g>
<!-- layer58_attn_ar -->
<g id="node825" class="node">
<title>layer58_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M491.07,-22182.47C491.07,-22182.47 289.07,-22182.47 289.07,-22182.47 283.07,-22182.47 273.3,-22177.8 269.53,-22173.13 269.53,-22173.13 226.47,-22119.8 226.47,-22119.8 222.7,-22115.14 224.93,-22110.47 230.93,-22110.47 230.93,-22110.47 432.93,-22110.47 432.93,-22110.47 438.93,-22110.47 448.7,-22115.14 452.47,-22119.8 452.47,-22119.8 495.53,-22173.13 495.53,-22173.13 499.3,-22177.8 497.07,-22182.47 491.07,-22182.47"/>
<text text-anchor="middle" x="361" y="-22149.47" font-family="Arial" font-size="10.00">Layer 58 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="361" y="-22138.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer58_attn_out_4&#45;&gt;layer58_attn_ar -->
<g id="edge941" class="edge">
<title>layer58_attn_out_4&#45;&gt;layer58_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M216.48,-22254.41C240.92,-22236.33 275.86,-22210.47 305.27,-22188.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="307.45,-22191.45 313.4,-22182.69 303.28,-22185.82 307.45,-22191.45"/>
</g>
<!-- layer58_attn_out_5&#45;&gt;layer58_attn_ar -->
<g id="edge942" class="edge">
<title>layer58_attn_out_5&#45;&gt;layer58_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M507.17,-22254.41C482.45,-22236.33 447.11,-22210.47 417.37,-22188.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="419.28,-22185.77 409.14,-22182.69 415.14,-22191.42 419.28,-22185.77"/>
</g>
<!-- layer58_ffn1_4 -->
<g id="node826" class="node">
<title>layer58_ffn1_4</title>
<path fill="#e6f3ff" stroke="black" d="M331,-22038.47C331,-22038.47 61,-22038.47 61,-22038.47 55,-22038.47 49,-22032.47 49,-22026.47 49,-22026.47 49,-22003.47 49,-22003.47 49,-21997.47 55,-21991.47 61,-21991.47 61,-21991.47 331,-21991.47 331,-21991.47 337,-21991.47 343,-21997.47 343,-22003.47 343,-22003.47 343,-22026.47 343,-22026.47 343,-22032.47 337,-22038.47 331,-22038.47"/>
<text text-anchor="middle" x="196" y="-22023.47" font-family="Arial" font-size="10.00">Layer 58 FFN1 GPU4</text>
<text text-anchor="middle" x="196" y="-22012.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="196" y="-22001.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer58_attn_ar&#45;&gt;layer58_ffn1_4 -->
<g id="edge943" class="edge">
<title>layer58_attn_ar&#45;&gt;layer58_ffn1_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M316.35,-22110.42C290.28,-22089.96 257.78,-22064.45 233.12,-22045.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="235.11,-22042.21 225.08,-22038.79 230.79,-22047.72 235.11,-22042.21"/>
</g>
<!-- layer58_ffn1_5 -->
<g id="node827" class="node">
<title>layer58_ffn1_5</title>
<path fill="#e6f3ff" stroke="black" d="M661,-22038.47C661,-22038.47 391,-22038.47 391,-22038.47 385,-22038.47 379,-22032.47 379,-22026.47 379,-22026.47 379,-22003.47 379,-22003.47 379,-21997.47 385,-21991.47 391,-21991.47 391,-21991.47 661,-21991.47 661,-21991.47 667,-21991.47 673,-21997.47 673,-22003.47 673,-22003.47 673,-22026.47 673,-22026.47 673,-22032.47 667,-22038.47 661,-22038.47"/>
<text text-anchor="middle" x="526" y="-22023.47" font-family="Arial" font-size="10.00">Layer 58 FFN1 GPU5</text>
<text text-anchor="middle" x="526" y="-22012.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="526" y="-22001.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer58_attn_ar&#45;&gt;layer58_ffn1_5 -->
<g id="edge944" class="edge">
<title>layer58_attn_ar&#45;&gt;layer58_ffn1_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M405.65,-22110.42C431.72,-22089.96 464.22,-22064.45 488.88,-22045.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="491.21,-22047.72 496.92,-22038.79 486.89,-22042.21 491.21,-22047.72"/>
</g>
<!-- layer58_act_4 -->
<g id="node828" class="node">
<title>layer58_act_4</title>
<path fill="#e6f3ff" stroke="black" d="M331,-21919.47C331,-21919.47 61,-21919.47 61,-21919.47 55,-21919.47 49,-21913.47 49,-21907.47 49,-21907.47 49,-21884.47 49,-21884.47 49,-21878.47 55,-21872.47 61,-21872.47 61,-21872.47 331,-21872.47 331,-21872.47 337,-21872.47 343,-21878.47 343,-21884.47 343,-21884.47 343,-21907.47 343,-21907.47 343,-21913.47 337,-21919.47 331,-21919.47"/>
<text text-anchor="middle" x="196" y="-21904.47" font-family="Arial" font-size="10.00">Layer 58 SiLU GPU4</text>
<text text-anchor="middle" x="196" y="-21893.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="196" y="-21882.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer58_ffn1_4&#45;&gt;layer58_act_4 -->
<g id="edge945" class="edge">
<title>layer58_ffn1_4&#45;&gt;layer58_act_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M196,-21991.41C196,-21973.96 196,-21949.55 196,-21929.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="199.5,-21929.86 196,-21919.86 192.5,-21929.86 199.5,-21929.86"/>
</g>
<!-- layer58_act_5 -->
<g id="node829" class="node">
<title>layer58_act_5</title>
<path fill="#e6f3ff" stroke="black" d="M661,-21919.47C661,-21919.47 391,-21919.47 391,-21919.47 385,-21919.47 379,-21913.47 379,-21907.47 379,-21907.47 379,-21884.47 379,-21884.47 379,-21878.47 385,-21872.47 391,-21872.47 391,-21872.47 661,-21872.47 661,-21872.47 667,-21872.47 673,-21878.47 673,-21884.47 673,-21884.47 673,-21907.47 673,-21907.47 673,-21913.47 667,-21919.47 661,-21919.47"/>
<text text-anchor="middle" x="526" y="-21904.47" font-family="Arial" font-size="10.00">Layer 58 SiLU GPU5</text>
<text text-anchor="middle" x="526" y="-21893.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="526" y="-21882.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer58_ffn1_5&#45;&gt;layer58_act_5 -->
<g id="edge946" class="edge">
<title>layer58_ffn1_5&#45;&gt;layer58_act_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M526,-21991.41C526,-21973.96 526,-21949.55 526,-21929.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="529.5,-21929.86 526,-21919.86 522.5,-21929.86 529.5,-21929.86"/>
</g>
<!-- layer58_ffn2_4 -->
<g id="node830" class="node">
<title>layer58_ffn2_4</title>
<path fill="#e6f3ff" stroke="black" d="M330.5,-21800.47C330.5,-21800.47 67.5,-21800.47 67.5,-21800.47 61.5,-21800.47 55.5,-21794.47 55.5,-21788.47 55.5,-21788.47 55.5,-21765.47 55.5,-21765.47 55.5,-21759.47 61.5,-21753.47 67.5,-21753.47 67.5,-21753.47 330.5,-21753.47 330.5,-21753.47 336.5,-21753.47 342.5,-21759.47 342.5,-21765.47 342.5,-21765.47 342.5,-21788.47 342.5,-21788.47 342.5,-21794.47 336.5,-21800.47 330.5,-21800.47"/>
<text text-anchor="middle" x="199" y="-21785.47" font-family="Arial" font-size="10.00">Layer 58 FFN2 GPU4</text>
<text text-anchor="middle" x="199" y="-21774.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="199" y="-21763.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer58_act_4&#45;&gt;layer58_ffn2_4 -->
<g id="edge947" class="edge">
<title>layer58_act_4&#45;&gt;layer58_ffn2_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M196.58,-21872.41C197.03,-21854.96 197.65,-21830.55 198.16,-21810.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="201.66,-21810.94 198.41,-21800.86 194.66,-21810.76 201.66,-21810.94"/>
</g>
<!-- layer58_ffn2_5 -->
<g id="node831" class="node">
<title>layer58_ffn2_5</title>
<path fill="#e6f3ff" stroke="black" d="M655.5,-21800.47C655.5,-21800.47 392.5,-21800.47 392.5,-21800.47 386.5,-21800.47 380.5,-21794.47 380.5,-21788.47 380.5,-21788.47 380.5,-21765.47 380.5,-21765.47 380.5,-21759.47 386.5,-21753.47 392.5,-21753.47 392.5,-21753.47 655.5,-21753.47 655.5,-21753.47 661.5,-21753.47 667.5,-21759.47 667.5,-21765.47 667.5,-21765.47 667.5,-21788.47 667.5,-21788.47 667.5,-21794.47 661.5,-21800.47 655.5,-21800.47"/>
<text text-anchor="middle" x="524" y="-21785.47" font-family="Arial" font-size="10.00">Layer 58 FFN2 GPU5</text>
<text text-anchor="middle" x="524" y="-21774.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="524" y="-21763.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer58_act_5&#45;&gt;layer58_ffn2_5 -->
<g id="edge948" class="edge">
<title>layer58_act_5&#45;&gt;layer58_ffn2_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M525.61,-21872.41C525.32,-21854.96 524.9,-21830.55 524.56,-21810.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="528.06,-21810.8 524.39,-21800.86 521.06,-21810.92 528.06,-21810.8"/>
</g>
<!-- layer58_ffn_ar -->
<g id="node832" class="node">
<title>layer58_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M492.22,-21681.47C492.22,-21681.47 286.8,-21681.47 286.8,-21681.47 280.8,-21681.47 271,-21676.83 267.19,-21672.19 267.19,-21672.19 223.39,-21618.75 223.39,-21618.75 219.59,-21614.11 221.78,-21609.47 227.78,-21609.47 227.78,-21609.47 433.2,-21609.47 433.2,-21609.47 439.2,-21609.47 449,-21614.11 452.81,-21618.75 452.81,-21618.75 496.61,-21672.19 496.61,-21672.19 500.41,-21676.83 498.22,-21681.47 492.22,-21681.47"/>
<text text-anchor="middle" x="360" y="-21648.47" font-family="Arial" font-size="10.00">Layer 58 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="360" y="-21637.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer58_ffn2_4&#45;&gt;layer58_ffn_ar -->
<g id="edge949" class="edge">
<title>layer58_ffn2_4&#45;&gt;layer58_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M227.04,-21753.41C249.43,-21735.41 281.4,-21709.69 308.38,-21687.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="310.61,-21690.68 316.21,-21681.69 306.23,-21685.23 310.61,-21690.68"/>
</g>
<!-- layer58_ffn2_5&#45;&gt;layer58_ffn_ar -->
<g id="edge950" class="edge">
<title>layer58_ffn2_5&#45;&gt;layer58_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M495.43,-21753.41C472.63,-21735.41 440.06,-21709.69 412.58,-21687.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="414.62,-21685.14 404.6,-21681.69 410.28,-21690.63 414.62,-21685.14"/>
</g>
<!-- layer59_qkv_4 -->
<g id="node833" class="node">
<title>layer59_qkv_4</title>
<path fill="#e6f3ff" stroke="black" d="M330,-21537.47C330,-21537.47 32,-21537.47 32,-21537.47 26,-21537.47 20,-21531.47 20,-21525.47 20,-21525.47 20,-21502.47 20,-21502.47 20,-21496.47 26,-21490.47 32,-21490.47 32,-21490.47 330,-21490.47 330,-21490.47 336,-21490.47 342,-21496.47 342,-21502.47 342,-21502.47 342,-21525.47 342,-21525.47 342,-21531.47 336,-21537.47 330,-21537.47"/>
<text text-anchor="middle" x="181" y="-21522.47" font-family="Arial" font-size="10.00">Layer 59 QKV Proj GPU4</text>
<text text-anchor="middle" x="181" y="-21511.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="181" y="-21500.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer58_ffn_ar&#45;&gt;layer59_qkv_4 -->
<g id="edge951" class="edge">
<title>layer58_ffn_ar&#45;&gt;layer59_qkv_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M311.56,-21609.42C283.06,-21588.81 247.48,-21563.06 220.66,-21543.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="222.43,-21540.62 212.28,-21537.6 218.33,-21546.3 222.43,-21540.62"/>
</g>
<!-- layer59_qkv_5 -->
<g id="node834" class="node">
<title>layer59_qkv_5</title>
<path fill="#e6f3ff" stroke="black" d="M688,-21537.47C688,-21537.47 390,-21537.47 390,-21537.47 384,-21537.47 378,-21531.47 378,-21525.47 378,-21525.47 378,-21502.47 378,-21502.47 378,-21496.47 384,-21490.47 390,-21490.47 390,-21490.47 688,-21490.47 688,-21490.47 694,-21490.47 700,-21496.47 700,-21502.47 700,-21502.47 700,-21525.47 700,-21525.47 700,-21531.47 694,-21537.47 688,-21537.47"/>
<text text-anchor="middle" x="539" y="-21522.47" font-family="Arial" font-size="10.00">Layer 59 QKV Proj GPU5</text>
<text text-anchor="middle" x="539" y="-21511.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="539" y="-21500.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer58_ffn_ar&#45;&gt;layer59_qkv_5 -->
<g id="edge952" class="edge">
<title>layer58_ffn_ar&#45;&gt;layer59_qkv_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M408.44,-21609.42C436.94,-21588.81 472.52,-21563.06 499.34,-21543.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="501.67,-21546.3 507.72,-21537.6 497.57,-21540.62 501.67,-21546.3"/>
</g>
<!-- layer59_attn_4 -->
<g id="node835" class="node">
<title>layer59_attn_4</title>
<path fill="#e6f3ff" stroke="black" d="M330,-21418.47C330,-21418.47 32,-21418.47 32,-21418.47 26,-21418.47 20,-21412.47 20,-21406.47 20,-21406.47 20,-21383.47 20,-21383.47 20,-21377.47 26,-21371.47 32,-21371.47 32,-21371.47 330,-21371.47 330,-21371.47 336,-21371.47 342,-21377.47 342,-21383.47 342,-21383.47 342,-21406.47 342,-21406.47 342,-21412.47 336,-21418.47 330,-21418.47"/>
<text text-anchor="middle" x="181" y="-21403.47" font-family="Arial" font-size="10.00">Layer 59 Attention GPU4</text>
<text text-anchor="middle" x="181" y="-21392.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="181" y="-21381.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer59_qkv_4&#45;&gt;layer59_attn_4 -->
<g id="edge953" class="edge">
<title>layer59_qkv_4&#45;&gt;layer59_attn_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M181,-21490.41C181,-21472.96 181,-21448.55 181,-21428.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="184.5,-21428.86 181,-21418.86 177.5,-21428.86 184.5,-21428.86"/>
</g>
<!-- layer59_attn_5 -->
<g id="node836" class="node">
<title>layer59_attn_5</title>
<path fill="#e6f3ff" stroke="black" d="M688,-21418.47C688,-21418.47 390,-21418.47 390,-21418.47 384,-21418.47 378,-21412.47 378,-21406.47 378,-21406.47 378,-21383.47 378,-21383.47 378,-21377.47 384,-21371.47 390,-21371.47 390,-21371.47 688,-21371.47 688,-21371.47 694,-21371.47 700,-21377.47 700,-21383.47 700,-21383.47 700,-21406.47 700,-21406.47 700,-21412.47 694,-21418.47 688,-21418.47"/>
<text text-anchor="middle" x="539" y="-21403.47" font-family="Arial" font-size="10.00">Layer 59 Attention GPU5</text>
<text text-anchor="middle" x="539" y="-21392.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="539" y="-21381.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer59_qkv_5&#45;&gt;layer59_attn_5 -->
<g id="edge954" class="edge">
<title>layer59_qkv_5&#45;&gt;layer59_attn_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M539,-21490.41C539,-21472.96 539,-21448.55 539,-21428.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="542.5,-21428.86 539,-21418.86 535.5,-21428.86 542.5,-21428.86"/>
</g>
<!-- layer59_attn_out_4 -->
<g id="node837" class="node">
<title>layer59_attn_out_4</title>
<path fill="#e6f3ff" stroke="black" d="M330,-21299.47C330,-21299.47 40,-21299.47 40,-21299.47 34,-21299.47 28,-21293.47 28,-21287.47 28,-21287.47 28,-21264.47 28,-21264.47 28,-21258.47 34,-21252.47 40,-21252.47 40,-21252.47 330,-21252.47 330,-21252.47 336,-21252.47 342,-21258.47 342,-21264.47 342,-21264.47 342,-21287.47 342,-21287.47 342,-21293.47 336,-21299.47 330,-21299.47"/>
<text text-anchor="middle" x="185" y="-21284.47" font-family="Arial" font-size="10.00">Layer 59 Attn Out GPU4</text>
<text text-anchor="middle" x="185" y="-21273.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="185" y="-21262.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer59_attn_4&#45;&gt;layer59_attn_out_4 -->
<g id="edge955" class="edge">
<title>layer59_attn_4&#45;&gt;layer59_attn_out_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M181.77,-21371.41C182.37,-21353.96 183.2,-21329.55 183.87,-21309.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="187.37,-21309.97 184.22,-21299.86 180.38,-21309.73 187.37,-21309.97"/>
</g>
<!-- layer59_attn_out_5 -->
<g id="node838" class="node">
<title>layer59_attn_out_5</title>
<path fill="#e6f3ff" stroke="black" d="M682,-21299.47C682,-21299.47 392,-21299.47 392,-21299.47 386,-21299.47 380,-21293.47 380,-21287.47 380,-21287.47 380,-21264.47 380,-21264.47 380,-21258.47 386,-21252.47 392,-21252.47 392,-21252.47 682,-21252.47 682,-21252.47 688,-21252.47 694,-21258.47 694,-21264.47 694,-21264.47 694,-21287.47 694,-21287.47 694,-21293.47 688,-21299.47 682,-21299.47"/>
<text text-anchor="middle" x="537" y="-21284.47" font-family="Arial" font-size="10.00">Layer 59 Attn Out GPU5</text>
<text text-anchor="middle" x="537" y="-21273.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="537" y="-21262.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer59_attn_5&#45;&gt;layer59_attn_out_5 -->
<g id="edge956" class="edge">
<title>layer59_attn_5&#45;&gt;layer59_attn_out_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M538.61,-21371.41C538.32,-21353.96 537.9,-21329.55 537.56,-21309.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="541.06,-21309.8 537.39,-21299.86 534.06,-21309.92 541.06,-21309.8"/>
</g>
<!-- layer59_attn_ar -->
<g id="node839" class="node">
<title>layer59_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M490.07,-21180.47C490.07,-21180.47 288.07,-21180.47 288.07,-21180.47 282.07,-21180.47 272.3,-21175.8 268.53,-21171.13 268.53,-21171.13 225.47,-21117.8 225.47,-21117.8 221.7,-21113.14 223.93,-21108.47 229.93,-21108.47 229.93,-21108.47 431.93,-21108.47 431.93,-21108.47 437.93,-21108.47 447.7,-21113.14 451.47,-21117.8 451.47,-21117.8 494.53,-21171.13 494.53,-21171.13 498.3,-21175.8 496.07,-21180.47 490.07,-21180.47"/>
<text text-anchor="middle" x="360" y="-21147.47" font-family="Arial" font-size="10.00">Layer 59 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="360" y="-21136.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer59_attn_out_4&#45;&gt;layer59_attn_ar -->
<g id="edge957" class="edge">
<title>layer59_attn_out_4&#45;&gt;layer59_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M215.48,-21252.41C239.92,-21234.33 274.86,-21208.47 304.27,-21186.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="306.45,-21189.45 312.4,-21180.69 302.28,-21183.82 306.45,-21189.45"/>
</g>
<!-- layer59_attn_out_5&#45;&gt;layer59_attn_ar -->
<g id="edge958" class="edge">
<title>layer59_attn_out_5&#45;&gt;layer59_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M506.17,-21252.41C481.45,-21234.33 446.11,-21208.47 416.37,-21186.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="418.28,-21183.77 408.14,-21180.69 414.14,-21189.42 418.28,-21183.77"/>
</g>
<!-- layer59_ffn1_4 -->
<g id="node840" class="node">
<title>layer59_ffn1_4</title>
<path fill="#e6f3ff" stroke="black" d="M330,-21036.47C330,-21036.47 60,-21036.47 60,-21036.47 54,-21036.47 48,-21030.47 48,-21024.47 48,-21024.47 48,-21001.47 48,-21001.47 48,-20995.47 54,-20989.47 60,-20989.47 60,-20989.47 330,-20989.47 330,-20989.47 336,-20989.47 342,-20995.47 342,-21001.47 342,-21001.47 342,-21024.47 342,-21024.47 342,-21030.47 336,-21036.47 330,-21036.47"/>
<text text-anchor="middle" x="195" y="-21021.47" font-family="Arial" font-size="10.00">Layer 59 FFN1 GPU4</text>
<text text-anchor="middle" x="195" y="-21010.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="195" y="-20999.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer59_attn_ar&#45;&gt;layer59_ffn1_4 -->
<g id="edge959" class="edge">
<title>layer59_attn_ar&#45;&gt;layer59_ffn1_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M315.35,-21108.42C289.28,-21087.96 256.78,-21062.45 232.12,-21043.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="234.11,-21040.21 224.08,-21036.79 229.79,-21045.72 234.11,-21040.21"/>
</g>
<!-- layer59_ffn1_5 -->
<g id="node841" class="node">
<title>layer59_ffn1_5</title>
<path fill="#e6f3ff" stroke="black" d="M660,-21036.47C660,-21036.47 390,-21036.47 390,-21036.47 384,-21036.47 378,-21030.47 378,-21024.47 378,-21024.47 378,-21001.47 378,-21001.47 378,-20995.47 384,-20989.47 390,-20989.47 390,-20989.47 660,-20989.47 660,-20989.47 666,-20989.47 672,-20995.47 672,-21001.47 672,-21001.47 672,-21024.47 672,-21024.47 672,-21030.47 666,-21036.47 660,-21036.47"/>
<text text-anchor="middle" x="525" y="-21021.47" font-family="Arial" font-size="10.00">Layer 59 FFN1 GPU5</text>
<text text-anchor="middle" x="525" y="-21010.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="525" y="-20999.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer59_attn_ar&#45;&gt;layer59_ffn1_5 -->
<g id="edge960" class="edge">
<title>layer59_attn_ar&#45;&gt;layer59_ffn1_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M404.65,-21108.42C430.72,-21087.96 463.22,-21062.45 487.88,-21043.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="490.21,-21045.72 495.92,-21036.79 485.89,-21040.21 490.21,-21045.72"/>
</g>
<!-- layer59_act_4 -->
<g id="node842" class="node">
<title>layer59_act_4</title>
<path fill="#e6f3ff" stroke="black" d="M330,-20917.47C330,-20917.47 60,-20917.47 60,-20917.47 54,-20917.47 48,-20911.47 48,-20905.47 48,-20905.47 48,-20882.47 48,-20882.47 48,-20876.47 54,-20870.47 60,-20870.47 60,-20870.47 330,-20870.47 330,-20870.47 336,-20870.47 342,-20876.47 342,-20882.47 342,-20882.47 342,-20905.47 342,-20905.47 342,-20911.47 336,-20917.47 330,-20917.47"/>
<text text-anchor="middle" x="195" y="-20902.47" font-family="Arial" font-size="10.00">Layer 59 SiLU GPU4</text>
<text text-anchor="middle" x="195" y="-20891.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="195" y="-20880.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer59_ffn1_4&#45;&gt;layer59_act_4 -->
<g id="edge961" class="edge">
<title>layer59_ffn1_4&#45;&gt;layer59_act_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M195,-20989.41C195,-20971.96 195,-20947.55 195,-20927.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="198.5,-20927.86 195,-20917.86 191.5,-20927.86 198.5,-20927.86"/>
</g>
<!-- layer59_act_5 -->
<g id="node843" class="node">
<title>layer59_act_5</title>
<path fill="#e6f3ff" stroke="black" d="M660,-20917.47C660,-20917.47 390,-20917.47 390,-20917.47 384,-20917.47 378,-20911.47 378,-20905.47 378,-20905.47 378,-20882.47 378,-20882.47 378,-20876.47 384,-20870.47 390,-20870.47 390,-20870.47 660,-20870.47 660,-20870.47 666,-20870.47 672,-20876.47 672,-20882.47 672,-20882.47 672,-20905.47 672,-20905.47 672,-20911.47 666,-20917.47 660,-20917.47"/>
<text text-anchor="middle" x="525" y="-20902.47" font-family="Arial" font-size="10.00">Layer 59 SiLU GPU5</text>
<text text-anchor="middle" x="525" y="-20891.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="525" y="-20880.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer59_ffn1_5&#45;&gt;layer59_act_5 -->
<g id="edge962" class="edge">
<title>layer59_ffn1_5&#45;&gt;layer59_act_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M525,-20989.41C525,-20971.96 525,-20947.55 525,-20927.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="528.5,-20927.86 525,-20917.86 521.5,-20927.86 528.5,-20927.86"/>
</g>
<!-- layer59_ffn2_4 -->
<g id="node844" class="node">
<title>layer59_ffn2_4</title>
<path fill="#e6f3ff" stroke="black" d="M329.5,-20798.47C329.5,-20798.47 66.5,-20798.47 66.5,-20798.47 60.5,-20798.47 54.5,-20792.47 54.5,-20786.47 54.5,-20786.47 54.5,-20763.47 54.5,-20763.47 54.5,-20757.47 60.5,-20751.47 66.5,-20751.47 66.5,-20751.47 329.5,-20751.47 329.5,-20751.47 335.5,-20751.47 341.5,-20757.47 341.5,-20763.47 341.5,-20763.47 341.5,-20786.47 341.5,-20786.47 341.5,-20792.47 335.5,-20798.47 329.5,-20798.47"/>
<text text-anchor="middle" x="198" y="-20783.47" font-family="Arial" font-size="10.00">Layer 59 FFN2 GPU4</text>
<text text-anchor="middle" x="198" y="-20772.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="198" y="-20761.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer59_act_4&#45;&gt;layer59_ffn2_4 -->
<g id="edge963" class="edge">
<title>layer59_act_4&#45;&gt;layer59_ffn2_4</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M195.58,-20870.41C196.03,-20852.96 196.65,-20828.55 197.16,-20808.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="200.66,-20808.94 197.41,-20798.86 193.66,-20808.76 200.66,-20808.94"/>
</g>
<!-- layer59_ffn2_5 -->
<g id="node845" class="node">
<title>layer59_ffn2_5</title>
<path fill="#e6f3ff" stroke="black" d="M654.5,-20798.47C654.5,-20798.47 391.5,-20798.47 391.5,-20798.47 385.5,-20798.47 379.5,-20792.47 379.5,-20786.47 379.5,-20786.47 379.5,-20763.47 379.5,-20763.47 379.5,-20757.47 385.5,-20751.47 391.5,-20751.47 391.5,-20751.47 654.5,-20751.47 654.5,-20751.47 660.5,-20751.47 666.5,-20757.47 666.5,-20763.47 666.5,-20763.47 666.5,-20786.47 666.5,-20786.47 666.5,-20792.47 660.5,-20798.47 654.5,-20798.47"/>
<text text-anchor="middle" x="523" y="-20783.47" font-family="Arial" font-size="10.00">Layer 59 FFN2 GPU5</text>
<text text-anchor="middle" x="523" y="-20772.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="523" y="-20761.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer59_act_5&#45;&gt;layer59_ffn2_5 -->
<g id="edge964" class="edge">
<title>layer59_act_5&#45;&gt;layer59_ffn2_5</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M524.61,-20870.41C524.32,-20852.96 523.9,-20828.55 523.56,-20808.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="527.06,-20808.8 523.39,-20798.86 520.06,-20808.92 527.06,-20808.8"/>
</g>
<!-- layer59_ffn_ar -->
<g id="node846" class="node">
<title>layer59_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M491.22,-20679.47C491.22,-20679.47 285.8,-20679.47 285.8,-20679.47 279.8,-20679.47 270,-20674.83 266.19,-20670.19 266.19,-20670.19 222.39,-20616.75 222.39,-20616.75 218.59,-20612.11 220.78,-20607.47 226.78,-20607.47 226.78,-20607.47 432.2,-20607.47 432.2,-20607.47 438.2,-20607.47 448,-20612.11 451.81,-20616.75 451.81,-20616.75 495.61,-20670.19 495.61,-20670.19 499.41,-20674.83 497.22,-20679.47 491.22,-20679.47"/>
<text text-anchor="middle" x="359" y="-20646.47" font-family="Arial" font-size="10.00">Layer 59 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="359" y="-20635.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer59_ffn2_4&#45;&gt;layer59_ffn_ar -->
<g id="edge965" class="edge">
<title>layer59_ffn2_4&#45;&gt;layer59_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M226.04,-20751.41C248.43,-20733.41 280.4,-20707.69 307.38,-20685.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="309.61,-20688.68 315.21,-20679.69 305.23,-20683.23 309.61,-20688.68"/>
</g>
<!-- layer59_ffn2_5&#45;&gt;layer59_ffn_ar -->
<g id="edge966" class="edge">
<title>layer59_ffn2_5&#45;&gt;layer59_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M494.43,-20751.41C471.63,-20733.41 439.06,-20707.69 411.58,-20685.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="413.62,-20683.14 403.6,-20679.69 409.28,-20688.63 413.62,-20683.14"/>
</g>
<!-- stage2_to_stage3 -->
<g id="node847" class="node">
<title>stage2_to_stage3</title>
<path fill="#ffe6e6" stroke="black" d="M463.23,-20535.47C463.23,-20535.47 302.33,-20535.47 302.33,-20535.47 296.33,-20535.47 287.62,-20530.11 284.91,-20524.76 284.91,-20524.76 248.19,-20452.18 248.19,-20452.18 245.48,-20446.82 248.77,-20441.47 254.77,-20441.47 254.77,-20441.47 415.67,-20441.47 415.67,-20441.47 421.67,-20441.47 430.38,-20446.82 433.09,-20452.18 433.09,-20452.18 469.81,-20524.76 469.81,-20524.76 472.52,-20530.11 469.23,-20535.47 463.23,-20535.47"/>
<text text-anchor="middle" x="359" y="-20496.97" font-family="Arial" font-size="10.00">Pipeline Forward</text>
<text text-anchor="middle" x="359" y="-20485.97" font-family="Arial" font-size="10.00">Stage 2  Stage 3</text>
<text text-anchor="middle" x="359" y="-20474.97" font-family="Arial" font-size="10.00">[PP Forward]</text>
</g>
<!-- layer59_ffn_ar&#45;&gt;stage2_to_stage3 -->
<g id="edge967" class="edge">
<title>layer59_ffn_ar&#45;&gt;stage2_to_stage3</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M359,-20607.37C359,-20589.18 359,-20566.52 359,-20545.94"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="362.5,-20545.72 359,-20535.72 355.5,-20545.72 362.5,-20545.72"/>
</g>
<!-- layer60_qkv_6 -->
<g id="node848" class="node">
<title>layer60_qkv_6</title>
<path fill="#e6f3ff" stroke="black" d="M329,-20369.47C329,-20369.47 31,-20369.47 31,-20369.47 25,-20369.47 19,-20363.47 19,-20357.47 19,-20357.47 19,-20334.47 19,-20334.47 19,-20328.47 25,-20322.47 31,-20322.47 31,-20322.47 329,-20322.47 329,-20322.47 335,-20322.47 341,-20328.47 341,-20334.47 341,-20334.47 341,-20357.47 341,-20357.47 341,-20363.47 335,-20369.47 329,-20369.47"/>
<text text-anchor="middle" x="180" y="-20354.47" font-family="Arial" font-size="10.00">Layer 60 QKV Proj GPU6</text>
<text text-anchor="middle" x="180" y="-20343.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="180" y="-20332.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- stage2_to_stage3&#45;&gt;layer60_qkv_6 -->
<g id="edge968" class="edge">
<title>stage2_to_stage3&#45;&gt;layer60_qkv_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M300.39,-20441.46C273.03,-20419.99 241.27,-20395.06 217.25,-20376.21"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="219.12,-20373.23 209.1,-20369.81 214.8,-20378.73 219.12,-20373.23"/>
</g>
<!-- layer60_qkv_7 -->
<g id="node849" class="node">
<title>layer60_qkv_7</title>
<path fill="#e6f3ff" stroke="black" d="M687,-20369.47C687,-20369.47 389,-20369.47 389,-20369.47 383,-20369.47 377,-20363.47 377,-20357.47 377,-20357.47 377,-20334.47 377,-20334.47 377,-20328.47 383,-20322.47 389,-20322.47 389,-20322.47 687,-20322.47 687,-20322.47 693,-20322.47 699,-20328.47 699,-20334.47 699,-20334.47 699,-20357.47 699,-20357.47 699,-20363.47 693,-20369.47 687,-20369.47"/>
<text text-anchor="middle" x="538" y="-20354.47" font-family="Arial" font-size="10.00">Layer 60 QKV Proj GPU7</text>
<text text-anchor="middle" x="538" y="-20343.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="538" y="-20332.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- stage2_to_stage3&#45;&gt;layer60_qkv_7 -->
<g id="edge969" class="edge">
<title>stage2_to_stage3&#45;&gt;layer60_qkv_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M417.61,-20441.46C444.97,-20419.99 476.73,-20395.06 500.75,-20376.21"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="503.2,-20378.73 508.9,-20369.81 498.88,-20373.23 503.2,-20378.73"/>
</g>
<!-- layer60_attn_6 -->
<g id="node850" class="node">
<title>layer60_attn_6</title>
<path fill="#e6f3ff" stroke="black" d="M329,-20250.47C329,-20250.47 31,-20250.47 31,-20250.47 25,-20250.47 19,-20244.47 19,-20238.47 19,-20238.47 19,-20215.47 19,-20215.47 19,-20209.47 25,-20203.47 31,-20203.47 31,-20203.47 329,-20203.47 329,-20203.47 335,-20203.47 341,-20209.47 341,-20215.47 341,-20215.47 341,-20238.47 341,-20238.47 341,-20244.47 335,-20250.47 329,-20250.47"/>
<text text-anchor="middle" x="180" y="-20235.47" font-family="Arial" font-size="10.00">Layer 60 Attention GPU6</text>
<text text-anchor="middle" x="180" y="-20224.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="180" y="-20213.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer60_qkv_6&#45;&gt;layer60_attn_6 -->
<g id="edge970" class="edge">
<title>layer60_qkv_6&#45;&gt;layer60_attn_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M180,-20322.41C180,-20304.96 180,-20280.55 180,-20260.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="183.5,-20260.86 180,-20250.86 176.5,-20260.86 183.5,-20260.86"/>
</g>
<!-- layer60_attn_7 -->
<g id="node851" class="node">
<title>layer60_attn_7</title>
<path fill="#e6f3ff" stroke="black" d="M687,-20250.47C687,-20250.47 389,-20250.47 389,-20250.47 383,-20250.47 377,-20244.47 377,-20238.47 377,-20238.47 377,-20215.47 377,-20215.47 377,-20209.47 383,-20203.47 389,-20203.47 389,-20203.47 687,-20203.47 687,-20203.47 693,-20203.47 699,-20209.47 699,-20215.47 699,-20215.47 699,-20238.47 699,-20238.47 699,-20244.47 693,-20250.47 687,-20250.47"/>
<text text-anchor="middle" x="538" y="-20235.47" font-family="Arial" font-size="10.00">Layer 60 Attention GPU7</text>
<text text-anchor="middle" x="538" y="-20224.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="538" y="-20213.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer60_qkv_7&#45;&gt;layer60_attn_7 -->
<g id="edge971" class="edge">
<title>layer60_qkv_7&#45;&gt;layer60_attn_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M538,-20322.41C538,-20304.96 538,-20280.55 538,-20260.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="541.5,-20260.86 538,-20250.86 534.5,-20260.86 541.5,-20260.86"/>
</g>
<!-- layer60_attn_out_6 -->
<g id="node852" class="node">
<title>layer60_attn_out_6</title>
<path fill="#e6f3ff" stroke="black" d="M329,-20131.47C329,-20131.47 39,-20131.47 39,-20131.47 33,-20131.47 27,-20125.47 27,-20119.47 27,-20119.47 27,-20096.47 27,-20096.47 27,-20090.47 33,-20084.47 39,-20084.47 39,-20084.47 329,-20084.47 329,-20084.47 335,-20084.47 341,-20090.47 341,-20096.47 341,-20096.47 341,-20119.47 341,-20119.47 341,-20125.47 335,-20131.47 329,-20131.47"/>
<text text-anchor="middle" x="184" y="-20116.47" font-family="Arial" font-size="10.00">Layer 60 Attn Out GPU6</text>
<text text-anchor="middle" x="184" y="-20105.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="184" y="-20094.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer60_attn_6&#45;&gt;layer60_attn_out_6 -->
<g id="edge972" class="edge">
<title>layer60_attn_6&#45;&gt;layer60_attn_out_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M180.77,-20203.41C181.37,-20185.96 182.2,-20161.55 182.87,-20141.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="186.37,-20141.97 183.22,-20131.86 179.38,-20141.73 186.37,-20141.97"/>
</g>
<!-- layer60_attn_out_7 -->
<g id="node853" class="node">
<title>layer60_attn_out_7</title>
<path fill="#e6f3ff" stroke="black" d="M681,-20131.47C681,-20131.47 391,-20131.47 391,-20131.47 385,-20131.47 379,-20125.47 379,-20119.47 379,-20119.47 379,-20096.47 379,-20096.47 379,-20090.47 385,-20084.47 391,-20084.47 391,-20084.47 681,-20084.47 681,-20084.47 687,-20084.47 693,-20090.47 693,-20096.47 693,-20096.47 693,-20119.47 693,-20119.47 693,-20125.47 687,-20131.47 681,-20131.47"/>
<text text-anchor="middle" x="536" y="-20116.47" font-family="Arial" font-size="10.00">Layer 60 Attn Out GPU7</text>
<text text-anchor="middle" x="536" y="-20105.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="536" y="-20094.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer60_attn_7&#45;&gt;layer60_attn_out_7 -->
<g id="edge973" class="edge">
<title>layer60_attn_7&#45;&gt;layer60_attn_out_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M537.61,-20203.41C537.32,-20185.96 536.9,-20161.55 536.56,-20141.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="540.06,-20141.8 536.39,-20131.86 533.06,-20141.92 540.06,-20141.8"/>
</g>
<!-- layer60_attn_ar -->
<g id="node854" class="node">
<title>layer60_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M489.07,-20012.47C489.07,-20012.47 287.07,-20012.47 287.07,-20012.47 281.07,-20012.47 271.3,-20007.8 267.53,-20003.13 267.53,-20003.13 224.47,-19949.8 224.47,-19949.8 220.7,-19945.14 222.93,-19940.47 228.93,-19940.47 228.93,-19940.47 430.93,-19940.47 430.93,-19940.47 436.93,-19940.47 446.7,-19945.14 450.47,-19949.8 450.47,-19949.8 493.53,-20003.13 493.53,-20003.13 497.3,-20007.8 495.07,-20012.47 489.07,-20012.47"/>
<text text-anchor="middle" x="359" y="-19979.47" font-family="Arial" font-size="10.00">Layer 60 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="359" y="-19968.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer60_attn_out_6&#45;&gt;layer60_attn_ar -->
<g id="edge974" class="edge">
<title>layer60_attn_out_6&#45;&gt;layer60_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M214.48,-20084.41C238.92,-20066.33 273.86,-20040.47 303.27,-20018.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="305.45,-20021.45 311.4,-20012.69 301.28,-20015.82 305.45,-20021.45"/>
</g>
<!-- layer60_attn_out_7&#45;&gt;layer60_attn_ar -->
<g id="edge975" class="edge">
<title>layer60_attn_out_7&#45;&gt;layer60_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M505.17,-20084.41C480.45,-20066.33 445.11,-20040.47 415.37,-20018.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="417.28,-20015.77 407.14,-20012.69 413.14,-20021.42 417.28,-20015.77"/>
</g>
<!-- layer60_ffn1_6 -->
<g id="node855" class="node">
<title>layer60_ffn1_6</title>
<path fill="#e6f3ff" stroke="black" d="M329,-19868.47C329,-19868.47 59,-19868.47 59,-19868.47 53,-19868.47 47,-19862.47 47,-19856.47 47,-19856.47 47,-19833.47 47,-19833.47 47,-19827.47 53,-19821.47 59,-19821.47 59,-19821.47 329,-19821.47 329,-19821.47 335,-19821.47 341,-19827.47 341,-19833.47 341,-19833.47 341,-19856.47 341,-19856.47 341,-19862.47 335,-19868.47 329,-19868.47"/>
<text text-anchor="middle" x="194" y="-19853.47" font-family="Arial" font-size="10.00">Layer 60 FFN1 GPU6</text>
<text text-anchor="middle" x="194" y="-19842.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="194" y="-19831.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer60_attn_ar&#45;&gt;layer60_ffn1_6 -->
<g id="edge976" class="edge">
<title>layer60_attn_ar&#45;&gt;layer60_ffn1_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M314.35,-19940.42C288.28,-19919.96 255.78,-19894.45 231.12,-19875.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="233.11,-19872.21 223.08,-19868.79 228.79,-19877.72 233.11,-19872.21"/>
</g>
<!-- layer60_ffn1_7 -->
<g id="node856" class="node">
<title>layer60_ffn1_7</title>
<path fill="#e6f3ff" stroke="black" d="M659,-19868.47C659,-19868.47 389,-19868.47 389,-19868.47 383,-19868.47 377,-19862.47 377,-19856.47 377,-19856.47 377,-19833.47 377,-19833.47 377,-19827.47 383,-19821.47 389,-19821.47 389,-19821.47 659,-19821.47 659,-19821.47 665,-19821.47 671,-19827.47 671,-19833.47 671,-19833.47 671,-19856.47 671,-19856.47 671,-19862.47 665,-19868.47 659,-19868.47"/>
<text text-anchor="middle" x="524" y="-19853.47" font-family="Arial" font-size="10.00">Layer 60 FFN1 GPU7</text>
<text text-anchor="middle" x="524" y="-19842.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="524" y="-19831.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer60_attn_ar&#45;&gt;layer60_ffn1_7 -->
<g id="edge977" class="edge">
<title>layer60_attn_ar&#45;&gt;layer60_ffn1_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M403.65,-19940.42C429.72,-19919.96 462.22,-19894.45 486.88,-19875.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="489.21,-19877.72 494.92,-19868.79 484.89,-19872.21 489.21,-19877.72"/>
</g>
<!-- layer60_act_6 -->
<g id="node857" class="node">
<title>layer60_act_6</title>
<path fill="#e6f3ff" stroke="black" d="M329,-19749.47C329,-19749.47 59,-19749.47 59,-19749.47 53,-19749.47 47,-19743.47 47,-19737.47 47,-19737.47 47,-19714.47 47,-19714.47 47,-19708.47 53,-19702.47 59,-19702.47 59,-19702.47 329,-19702.47 329,-19702.47 335,-19702.47 341,-19708.47 341,-19714.47 341,-19714.47 341,-19737.47 341,-19737.47 341,-19743.47 335,-19749.47 329,-19749.47"/>
<text text-anchor="middle" x="194" y="-19734.47" font-family="Arial" font-size="10.00">Layer 60 SiLU GPU6</text>
<text text-anchor="middle" x="194" y="-19723.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="194" y="-19712.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer60_ffn1_6&#45;&gt;layer60_act_6 -->
<g id="edge978" class="edge">
<title>layer60_ffn1_6&#45;&gt;layer60_act_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M194,-19821.41C194,-19803.96 194,-19779.55 194,-19759.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="197.5,-19759.86 194,-19749.86 190.5,-19759.86 197.5,-19759.86"/>
</g>
<!-- layer60_act_7 -->
<g id="node858" class="node">
<title>layer60_act_7</title>
<path fill="#e6f3ff" stroke="black" d="M659,-19749.47C659,-19749.47 389,-19749.47 389,-19749.47 383,-19749.47 377,-19743.47 377,-19737.47 377,-19737.47 377,-19714.47 377,-19714.47 377,-19708.47 383,-19702.47 389,-19702.47 389,-19702.47 659,-19702.47 659,-19702.47 665,-19702.47 671,-19708.47 671,-19714.47 671,-19714.47 671,-19737.47 671,-19737.47 671,-19743.47 665,-19749.47 659,-19749.47"/>
<text text-anchor="middle" x="524" y="-19734.47" font-family="Arial" font-size="10.00">Layer 60 SiLU GPU7</text>
<text text-anchor="middle" x="524" y="-19723.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="524" y="-19712.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer60_ffn1_7&#45;&gt;layer60_act_7 -->
<g id="edge979" class="edge">
<title>layer60_ffn1_7&#45;&gt;layer60_act_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M524,-19821.41C524,-19803.96 524,-19779.55 524,-19759.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="527.5,-19759.86 524,-19749.86 520.5,-19759.86 527.5,-19759.86"/>
</g>
<!-- layer60_ffn2_6 -->
<g id="node859" class="node">
<title>layer60_ffn2_6</title>
<path fill="#e6f3ff" stroke="black" d="M328.5,-19630.47C328.5,-19630.47 65.5,-19630.47 65.5,-19630.47 59.5,-19630.47 53.5,-19624.47 53.5,-19618.47 53.5,-19618.47 53.5,-19595.47 53.5,-19595.47 53.5,-19589.47 59.5,-19583.47 65.5,-19583.47 65.5,-19583.47 328.5,-19583.47 328.5,-19583.47 334.5,-19583.47 340.5,-19589.47 340.5,-19595.47 340.5,-19595.47 340.5,-19618.47 340.5,-19618.47 340.5,-19624.47 334.5,-19630.47 328.5,-19630.47"/>
<text text-anchor="middle" x="197" y="-19615.47" font-family="Arial" font-size="10.00">Layer 60 FFN2 GPU6</text>
<text text-anchor="middle" x="197" y="-19604.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="197" y="-19593.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer60_act_6&#45;&gt;layer60_ffn2_6 -->
<g id="edge980" class="edge">
<title>layer60_act_6&#45;&gt;layer60_ffn2_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M194.58,-19702.41C195.03,-19684.96 195.65,-19660.55 196.16,-19640.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="199.66,-19640.94 196.41,-19630.86 192.66,-19640.76 199.66,-19640.94"/>
</g>
<!-- layer60_ffn2_7 -->
<g id="node860" class="node">
<title>layer60_ffn2_7</title>
<path fill="#e6f3ff" stroke="black" d="M653.5,-19630.47C653.5,-19630.47 390.5,-19630.47 390.5,-19630.47 384.5,-19630.47 378.5,-19624.47 378.5,-19618.47 378.5,-19618.47 378.5,-19595.47 378.5,-19595.47 378.5,-19589.47 384.5,-19583.47 390.5,-19583.47 390.5,-19583.47 653.5,-19583.47 653.5,-19583.47 659.5,-19583.47 665.5,-19589.47 665.5,-19595.47 665.5,-19595.47 665.5,-19618.47 665.5,-19618.47 665.5,-19624.47 659.5,-19630.47 653.5,-19630.47"/>
<text text-anchor="middle" x="522" y="-19615.47" font-family="Arial" font-size="10.00">Layer 60 FFN2 GPU7</text>
<text text-anchor="middle" x="522" y="-19604.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="522" y="-19593.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer60_act_7&#45;&gt;layer60_ffn2_7 -->
<g id="edge981" class="edge">
<title>layer60_act_7&#45;&gt;layer60_ffn2_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M523.61,-19702.41C523.32,-19684.96 522.9,-19660.55 522.56,-19640.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="526.06,-19640.8 522.39,-19630.86 519.06,-19640.92 526.06,-19640.8"/>
</g>
<!-- layer60_ffn_ar -->
<g id="node861" class="node">
<title>layer60_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M490.22,-19511.47C490.22,-19511.47 284.8,-19511.47 284.8,-19511.47 278.8,-19511.47 269,-19506.83 265.19,-19502.19 265.19,-19502.19 221.39,-19448.75 221.39,-19448.75 217.59,-19444.11 219.78,-19439.47 225.78,-19439.47 225.78,-19439.47 431.2,-19439.47 431.2,-19439.47 437.2,-19439.47 447,-19444.11 450.81,-19448.75 450.81,-19448.75 494.61,-19502.19 494.61,-19502.19 498.41,-19506.83 496.22,-19511.47 490.22,-19511.47"/>
<text text-anchor="middle" x="358" y="-19478.47" font-family="Arial" font-size="10.00">Layer 60 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="358" y="-19467.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer60_ffn2_6&#45;&gt;layer60_ffn_ar -->
<g id="edge982" class="edge">
<title>layer60_ffn2_6&#45;&gt;layer60_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M225.04,-19583.41C247.43,-19565.41 279.4,-19539.69 306.38,-19517.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="308.61,-19520.68 314.21,-19511.69 304.23,-19515.23 308.61,-19520.68"/>
</g>
<!-- layer60_ffn2_7&#45;&gt;layer60_ffn_ar -->
<g id="edge983" class="edge">
<title>layer60_ffn2_7&#45;&gt;layer60_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M493.43,-19583.41C470.63,-19565.41 438.06,-19539.69 410.58,-19517.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="412.62,-19515.14 402.6,-19511.69 408.28,-19520.63 412.62,-19515.14"/>
</g>
<!-- layer61_qkv_6 -->
<g id="node862" class="node">
<title>layer61_qkv_6</title>
<path fill="#e6f3ff" stroke="black" d="M328,-19367.47C328,-19367.47 30,-19367.47 30,-19367.47 24,-19367.47 18,-19361.47 18,-19355.47 18,-19355.47 18,-19332.47 18,-19332.47 18,-19326.47 24,-19320.47 30,-19320.47 30,-19320.47 328,-19320.47 328,-19320.47 334,-19320.47 340,-19326.47 340,-19332.47 340,-19332.47 340,-19355.47 340,-19355.47 340,-19361.47 334,-19367.47 328,-19367.47"/>
<text text-anchor="middle" x="179" y="-19352.47" font-family="Arial" font-size="10.00">Layer 61 QKV Proj GPU6</text>
<text text-anchor="middle" x="179" y="-19341.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="179" y="-19330.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer60_ffn_ar&#45;&gt;layer61_qkv_6 -->
<g id="edge984" class="edge">
<title>layer60_ffn_ar&#45;&gt;layer61_qkv_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M309.56,-19439.42C281.06,-19418.81 245.48,-19393.06 218.66,-19373.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="220.43,-19370.62 210.28,-19367.6 216.33,-19376.3 220.43,-19370.62"/>
</g>
<!-- layer61_qkv_7 -->
<g id="node863" class="node">
<title>layer61_qkv_7</title>
<path fill="#e6f3ff" stroke="black" d="M686,-19367.47C686,-19367.47 388,-19367.47 388,-19367.47 382,-19367.47 376,-19361.47 376,-19355.47 376,-19355.47 376,-19332.47 376,-19332.47 376,-19326.47 382,-19320.47 388,-19320.47 388,-19320.47 686,-19320.47 686,-19320.47 692,-19320.47 698,-19326.47 698,-19332.47 698,-19332.47 698,-19355.47 698,-19355.47 698,-19361.47 692,-19367.47 686,-19367.47"/>
<text text-anchor="middle" x="537" y="-19352.47" font-family="Arial" font-size="10.00">Layer 61 QKV Proj GPU7</text>
<text text-anchor="middle" x="537" y="-19341.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="537" y="-19330.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer60_ffn_ar&#45;&gt;layer61_qkv_7 -->
<g id="edge985" class="edge">
<title>layer60_ffn_ar&#45;&gt;layer61_qkv_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M406.44,-19439.42C434.94,-19418.81 470.52,-19393.06 497.34,-19373.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="499.67,-19376.3 505.72,-19367.6 495.57,-19370.62 499.67,-19376.3"/>
</g>
<!-- layer61_attn_6 -->
<g id="node864" class="node">
<title>layer61_attn_6</title>
<path fill="#e6f3ff" stroke="black" d="M328,-19248.47C328,-19248.47 30,-19248.47 30,-19248.47 24,-19248.47 18,-19242.47 18,-19236.47 18,-19236.47 18,-19213.47 18,-19213.47 18,-19207.47 24,-19201.47 30,-19201.47 30,-19201.47 328,-19201.47 328,-19201.47 334,-19201.47 340,-19207.47 340,-19213.47 340,-19213.47 340,-19236.47 340,-19236.47 340,-19242.47 334,-19248.47 328,-19248.47"/>
<text text-anchor="middle" x="179" y="-19233.47" font-family="Arial" font-size="10.00">Layer 61 Attention GPU6</text>
<text text-anchor="middle" x="179" y="-19222.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="179" y="-19211.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer61_qkv_6&#45;&gt;layer61_attn_6 -->
<g id="edge986" class="edge">
<title>layer61_qkv_6&#45;&gt;layer61_attn_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M179,-19320.41C179,-19302.96 179,-19278.55 179,-19258.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="182.5,-19258.86 179,-19248.86 175.5,-19258.86 182.5,-19258.86"/>
</g>
<!-- layer61_attn_7 -->
<g id="node865" class="node">
<title>layer61_attn_7</title>
<path fill="#e6f3ff" stroke="black" d="M686,-19248.47C686,-19248.47 388,-19248.47 388,-19248.47 382,-19248.47 376,-19242.47 376,-19236.47 376,-19236.47 376,-19213.47 376,-19213.47 376,-19207.47 382,-19201.47 388,-19201.47 388,-19201.47 686,-19201.47 686,-19201.47 692,-19201.47 698,-19207.47 698,-19213.47 698,-19213.47 698,-19236.47 698,-19236.47 698,-19242.47 692,-19248.47 686,-19248.47"/>
<text text-anchor="middle" x="537" y="-19233.47" font-family="Arial" font-size="10.00">Layer 61 Attention GPU7</text>
<text text-anchor="middle" x="537" y="-19222.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="537" y="-19211.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer61_qkv_7&#45;&gt;layer61_attn_7 -->
<g id="edge987" class="edge">
<title>layer61_qkv_7&#45;&gt;layer61_attn_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M537,-19320.41C537,-19302.96 537,-19278.55 537,-19258.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="540.5,-19258.86 537,-19248.86 533.5,-19258.86 540.5,-19258.86"/>
</g>
<!-- layer61_attn_out_6 -->
<g id="node866" class="node">
<title>layer61_attn_out_6</title>
<path fill="#e6f3ff" stroke="black" d="M328,-19129.47C328,-19129.47 38,-19129.47 38,-19129.47 32,-19129.47 26,-19123.47 26,-19117.47 26,-19117.47 26,-19094.47 26,-19094.47 26,-19088.47 32,-19082.47 38,-19082.47 38,-19082.47 328,-19082.47 328,-19082.47 334,-19082.47 340,-19088.47 340,-19094.47 340,-19094.47 340,-19117.47 340,-19117.47 340,-19123.47 334,-19129.47 328,-19129.47"/>
<text text-anchor="middle" x="183" y="-19114.47" font-family="Arial" font-size="10.00">Layer 61 Attn Out GPU6</text>
<text text-anchor="middle" x="183" y="-19103.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="183" y="-19092.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer61_attn_6&#45;&gt;layer61_attn_out_6 -->
<g id="edge988" class="edge">
<title>layer61_attn_6&#45;&gt;layer61_attn_out_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M179.77,-19201.41C180.37,-19183.96 181.2,-19159.55 181.87,-19139.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="185.37,-19139.97 182.22,-19129.86 178.38,-19139.73 185.37,-19139.97"/>
</g>
<!-- layer61_attn_out_7 -->
<g id="node867" class="node">
<title>layer61_attn_out_7</title>
<path fill="#e6f3ff" stroke="black" d="M680,-19129.47C680,-19129.47 390,-19129.47 390,-19129.47 384,-19129.47 378,-19123.47 378,-19117.47 378,-19117.47 378,-19094.47 378,-19094.47 378,-19088.47 384,-19082.47 390,-19082.47 390,-19082.47 680,-19082.47 680,-19082.47 686,-19082.47 692,-19088.47 692,-19094.47 692,-19094.47 692,-19117.47 692,-19117.47 692,-19123.47 686,-19129.47 680,-19129.47"/>
<text text-anchor="middle" x="535" y="-19114.47" font-family="Arial" font-size="10.00">Layer 61 Attn Out GPU7</text>
<text text-anchor="middle" x="535" y="-19103.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="535" y="-19092.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer61_attn_7&#45;&gt;layer61_attn_out_7 -->
<g id="edge989" class="edge">
<title>layer61_attn_7&#45;&gt;layer61_attn_out_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M536.61,-19201.41C536.32,-19183.96 535.9,-19159.55 535.56,-19139.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="539.06,-19139.8 535.39,-19129.86 532.06,-19139.92 539.06,-19139.8"/>
</g>
<!-- layer61_attn_ar -->
<g id="node868" class="node">
<title>layer61_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M488.07,-19010.47C488.07,-19010.47 286.07,-19010.47 286.07,-19010.47 280.07,-19010.47 270.3,-19005.8 266.53,-19001.13 266.53,-19001.13 223.47,-18947.8 223.47,-18947.8 219.7,-18943.14 221.93,-18938.47 227.93,-18938.47 227.93,-18938.47 429.93,-18938.47 429.93,-18938.47 435.93,-18938.47 445.7,-18943.14 449.47,-18947.8 449.47,-18947.8 492.53,-19001.13 492.53,-19001.13 496.3,-19005.8 494.07,-19010.47 488.07,-19010.47"/>
<text text-anchor="middle" x="358" y="-18977.47" font-family="Arial" font-size="10.00">Layer 61 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="358" y="-18966.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer61_attn_out_6&#45;&gt;layer61_attn_ar -->
<g id="edge990" class="edge">
<title>layer61_attn_out_6&#45;&gt;layer61_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M213.48,-19082.41C237.92,-19064.33 272.86,-19038.47 302.27,-19016.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="304.45,-19019.45 310.4,-19010.69 300.28,-19013.82 304.45,-19019.45"/>
</g>
<!-- layer61_attn_out_7&#45;&gt;layer61_attn_ar -->
<g id="edge991" class="edge">
<title>layer61_attn_out_7&#45;&gt;layer61_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M504.17,-19082.41C479.45,-19064.33 444.11,-19038.47 414.37,-19016.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="416.28,-19013.77 406.14,-19010.69 412.14,-19019.42 416.28,-19013.77"/>
</g>
<!-- layer61_ffn1_6 -->
<g id="node869" class="node">
<title>layer61_ffn1_6</title>
<path fill="#e6f3ff" stroke="black" d="M328,-18866.47C328,-18866.47 58,-18866.47 58,-18866.47 52,-18866.47 46,-18860.47 46,-18854.47 46,-18854.47 46,-18831.47 46,-18831.47 46,-18825.47 52,-18819.47 58,-18819.47 58,-18819.47 328,-18819.47 328,-18819.47 334,-18819.47 340,-18825.47 340,-18831.47 340,-18831.47 340,-18854.47 340,-18854.47 340,-18860.47 334,-18866.47 328,-18866.47"/>
<text text-anchor="middle" x="193" y="-18851.47" font-family="Arial" font-size="10.00">Layer 61 FFN1 GPU6</text>
<text text-anchor="middle" x="193" y="-18840.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="193" y="-18829.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer61_attn_ar&#45;&gt;layer61_ffn1_6 -->
<g id="edge992" class="edge">
<title>layer61_attn_ar&#45;&gt;layer61_ffn1_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M313.35,-18938.42C287.28,-18917.96 254.78,-18892.45 230.12,-18873.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="232.11,-18870.21 222.08,-18866.79 227.79,-18875.72 232.11,-18870.21"/>
</g>
<!-- layer61_ffn1_7 -->
<g id="node870" class="node">
<title>layer61_ffn1_7</title>
<path fill="#e6f3ff" stroke="black" d="M658,-18866.47C658,-18866.47 388,-18866.47 388,-18866.47 382,-18866.47 376,-18860.47 376,-18854.47 376,-18854.47 376,-18831.47 376,-18831.47 376,-18825.47 382,-18819.47 388,-18819.47 388,-18819.47 658,-18819.47 658,-18819.47 664,-18819.47 670,-18825.47 670,-18831.47 670,-18831.47 670,-18854.47 670,-18854.47 670,-18860.47 664,-18866.47 658,-18866.47"/>
<text text-anchor="middle" x="523" y="-18851.47" font-family="Arial" font-size="10.00">Layer 61 FFN1 GPU7</text>
<text text-anchor="middle" x="523" y="-18840.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="523" y="-18829.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer61_attn_ar&#45;&gt;layer61_ffn1_7 -->
<g id="edge993" class="edge">
<title>layer61_attn_ar&#45;&gt;layer61_ffn1_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M402.65,-18938.42C428.72,-18917.96 461.22,-18892.45 485.88,-18873.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="488.21,-18875.72 493.92,-18866.79 483.89,-18870.21 488.21,-18875.72"/>
</g>
<!-- layer61_act_6 -->
<g id="node871" class="node">
<title>layer61_act_6</title>
<path fill="#e6f3ff" stroke="black" d="M328,-18747.47C328,-18747.47 58,-18747.47 58,-18747.47 52,-18747.47 46,-18741.47 46,-18735.47 46,-18735.47 46,-18712.47 46,-18712.47 46,-18706.47 52,-18700.47 58,-18700.47 58,-18700.47 328,-18700.47 328,-18700.47 334,-18700.47 340,-18706.47 340,-18712.47 340,-18712.47 340,-18735.47 340,-18735.47 340,-18741.47 334,-18747.47 328,-18747.47"/>
<text text-anchor="middle" x="193" y="-18732.47" font-family="Arial" font-size="10.00">Layer 61 SiLU GPU6</text>
<text text-anchor="middle" x="193" y="-18721.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="193" y="-18710.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer61_ffn1_6&#45;&gt;layer61_act_6 -->
<g id="edge994" class="edge">
<title>layer61_ffn1_6&#45;&gt;layer61_act_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M193,-18819.41C193,-18801.96 193,-18777.55 193,-18757.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="196.5,-18757.86 193,-18747.86 189.5,-18757.86 196.5,-18757.86"/>
</g>
<!-- layer61_act_7 -->
<g id="node872" class="node">
<title>layer61_act_7</title>
<path fill="#e6f3ff" stroke="black" d="M658,-18747.47C658,-18747.47 388,-18747.47 388,-18747.47 382,-18747.47 376,-18741.47 376,-18735.47 376,-18735.47 376,-18712.47 376,-18712.47 376,-18706.47 382,-18700.47 388,-18700.47 388,-18700.47 658,-18700.47 658,-18700.47 664,-18700.47 670,-18706.47 670,-18712.47 670,-18712.47 670,-18735.47 670,-18735.47 670,-18741.47 664,-18747.47 658,-18747.47"/>
<text text-anchor="middle" x="523" y="-18732.47" font-family="Arial" font-size="10.00">Layer 61 SiLU GPU7</text>
<text text-anchor="middle" x="523" y="-18721.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="523" y="-18710.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer61_ffn1_7&#45;&gt;layer61_act_7 -->
<g id="edge995" class="edge">
<title>layer61_ffn1_7&#45;&gt;layer61_act_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M523,-18819.41C523,-18801.96 523,-18777.55 523,-18757.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="526.5,-18757.86 523,-18747.86 519.5,-18757.86 526.5,-18757.86"/>
</g>
<!-- layer61_ffn2_6 -->
<g id="node873" class="node">
<title>layer61_ffn2_6</title>
<path fill="#e6f3ff" stroke="black" d="M327.5,-18628.47C327.5,-18628.47 64.5,-18628.47 64.5,-18628.47 58.5,-18628.47 52.5,-18622.47 52.5,-18616.47 52.5,-18616.47 52.5,-18593.47 52.5,-18593.47 52.5,-18587.47 58.5,-18581.47 64.5,-18581.47 64.5,-18581.47 327.5,-18581.47 327.5,-18581.47 333.5,-18581.47 339.5,-18587.47 339.5,-18593.47 339.5,-18593.47 339.5,-18616.47 339.5,-18616.47 339.5,-18622.47 333.5,-18628.47 327.5,-18628.47"/>
<text text-anchor="middle" x="196" y="-18613.47" font-family="Arial" font-size="10.00">Layer 61 FFN2 GPU6</text>
<text text-anchor="middle" x="196" y="-18602.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="196" y="-18591.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer61_act_6&#45;&gt;layer61_ffn2_6 -->
<g id="edge996" class="edge">
<title>layer61_act_6&#45;&gt;layer61_ffn2_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M193.58,-18700.41C194.03,-18682.96 194.65,-18658.55 195.16,-18638.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="198.66,-18638.94 195.41,-18628.86 191.66,-18638.76 198.66,-18638.94"/>
</g>
<!-- layer61_ffn2_7 -->
<g id="node874" class="node">
<title>layer61_ffn2_7</title>
<path fill="#e6f3ff" stroke="black" d="M652.5,-18628.47C652.5,-18628.47 389.5,-18628.47 389.5,-18628.47 383.5,-18628.47 377.5,-18622.47 377.5,-18616.47 377.5,-18616.47 377.5,-18593.47 377.5,-18593.47 377.5,-18587.47 383.5,-18581.47 389.5,-18581.47 389.5,-18581.47 652.5,-18581.47 652.5,-18581.47 658.5,-18581.47 664.5,-18587.47 664.5,-18593.47 664.5,-18593.47 664.5,-18616.47 664.5,-18616.47 664.5,-18622.47 658.5,-18628.47 652.5,-18628.47"/>
<text text-anchor="middle" x="521" y="-18613.47" font-family="Arial" font-size="10.00">Layer 61 FFN2 GPU7</text>
<text text-anchor="middle" x="521" y="-18602.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="521" y="-18591.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer61_act_7&#45;&gt;layer61_ffn2_7 -->
<g id="edge997" class="edge">
<title>layer61_act_7&#45;&gt;layer61_ffn2_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M522.61,-18700.41C522.32,-18682.96 521.9,-18658.55 521.56,-18638.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="525.06,-18638.8 521.39,-18628.86 518.06,-18638.92 525.06,-18638.8"/>
</g>
<!-- layer61_ffn_ar -->
<g id="node875" class="node">
<title>layer61_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M489.22,-18509.47C489.22,-18509.47 283.8,-18509.47 283.8,-18509.47 277.8,-18509.47 268,-18504.83 264.19,-18500.19 264.19,-18500.19 220.39,-18446.75 220.39,-18446.75 216.59,-18442.11 218.78,-18437.47 224.78,-18437.47 224.78,-18437.47 430.2,-18437.47 430.2,-18437.47 436.2,-18437.47 446,-18442.11 449.81,-18446.75 449.81,-18446.75 493.61,-18500.19 493.61,-18500.19 497.41,-18504.83 495.22,-18509.47 489.22,-18509.47"/>
<text text-anchor="middle" x="357" y="-18476.47" font-family="Arial" font-size="10.00">Layer 61 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="357" y="-18465.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer61_ffn2_6&#45;&gt;layer61_ffn_ar -->
<g id="edge998" class="edge">
<title>layer61_ffn2_6&#45;&gt;layer61_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M224.04,-18581.41C246.43,-18563.41 278.4,-18537.69 305.38,-18515.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="307.61,-18518.68 313.21,-18509.69 303.23,-18513.23 307.61,-18518.68"/>
</g>
<!-- layer61_ffn2_7&#45;&gt;layer61_ffn_ar -->
<g id="edge999" class="edge">
<title>layer61_ffn2_7&#45;&gt;layer61_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M492.43,-18581.41C469.63,-18563.41 437.06,-18537.69 409.58,-18515.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="411.62,-18513.14 401.6,-18509.69 407.28,-18518.63 411.62,-18513.14"/>
</g>
<!-- layer62_qkv_6 -->
<g id="node876" class="node">
<title>layer62_qkv_6</title>
<path fill="#e6f3ff" stroke="black" d="M327,-18365.47C327,-18365.47 29,-18365.47 29,-18365.47 23,-18365.47 17,-18359.47 17,-18353.47 17,-18353.47 17,-18330.47 17,-18330.47 17,-18324.47 23,-18318.47 29,-18318.47 29,-18318.47 327,-18318.47 327,-18318.47 333,-18318.47 339,-18324.47 339,-18330.47 339,-18330.47 339,-18353.47 339,-18353.47 339,-18359.47 333,-18365.47 327,-18365.47"/>
<text text-anchor="middle" x="178" y="-18350.47" font-family="Arial" font-size="10.00">Layer 62 QKV Proj GPU6</text>
<text text-anchor="middle" x="178" y="-18339.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="178" y="-18328.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer61_ffn_ar&#45;&gt;layer62_qkv_6 -->
<g id="edge1000" class="edge">
<title>layer61_ffn_ar&#45;&gt;layer62_qkv_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M308.56,-18437.42C280.06,-18416.81 244.48,-18391.06 217.66,-18371.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="219.43,-18368.62 209.28,-18365.6 215.33,-18374.3 219.43,-18368.62"/>
</g>
<!-- layer62_qkv_7 -->
<g id="node877" class="node">
<title>layer62_qkv_7</title>
<path fill="#e6f3ff" stroke="black" d="M685,-18365.47C685,-18365.47 387,-18365.47 387,-18365.47 381,-18365.47 375,-18359.47 375,-18353.47 375,-18353.47 375,-18330.47 375,-18330.47 375,-18324.47 381,-18318.47 387,-18318.47 387,-18318.47 685,-18318.47 685,-18318.47 691,-18318.47 697,-18324.47 697,-18330.47 697,-18330.47 697,-18353.47 697,-18353.47 697,-18359.47 691,-18365.47 685,-18365.47"/>
<text text-anchor="middle" x="536" y="-18350.47" font-family="Arial" font-size="10.00">Layer 62 QKV Proj GPU7</text>
<text text-anchor="middle" x="536" y="-18339.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="536" y="-18328.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer61_ffn_ar&#45;&gt;layer62_qkv_7 -->
<g id="edge1001" class="edge">
<title>layer61_ffn_ar&#45;&gt;layer62_qkv_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M405.44,-18437.42C433.94,-18416.81 469.52,-18391.06 496.34,-18371.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="498.67,-18374.3 504.72,-18365.6 494.57,-18368.62 498.67,-18374.3"/>
</g>
<!-- layer62_attn_6 -->
<g id="node878" class="node">
<title>layer62_attn_6</title>
<path fill="#e6f3ff" stroke="black" d="M327,-18246.47C327,-18246.47 29,-18246.47 29,-18246.47 23,-18246.47 17,-18240.47 17,-18234.47 17,-18234.47 17,-18211.47 17,-18211.47 17,-18205.47 23,-18199.47 29,-18199.47 29,-18199.47 327,-18199.47 327,-18199.47 333,-18199.47 339,-18205.47 339,-18211.47 339,-18211.47 339,-18234.47 339,-18234.47 339,-18240.47 333,-18246.47 327,-18246.47"/>
<text text-anchor="middle" x="178" y="-18231.47" font-family="Arial" font-size="10.00">Layer 62 Attention GPU6</text>
<text text-anchor="middle" x="178" y="-18220.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="178" y="-18209.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer62_qkv_6&#45;&gt;layer62_attn_6 -->
<g id="edge1002" class="edge">
<title>layer62_qkv_6&#45;&gt;layer62_attn_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M178,-18318.41C178,-18300.96 178,-18276.55 178,-18256.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="181.5,-18256.86 178,-18246.86 174.5,-18256.86 181.5,-18256.86"/>
</g>
<!-- layer62_attn_7 -->
<g id="node879" class="node">
<title>layer62_attn_7</title>
<path fill="#e6f3ff" stroke="black" d="M685,-18246.47C685,-18246.47 387,-18246.47 387,-18246.47 381,-18246.47 375,-18240.47 375,-18234.47 375,-18234.47 375,-18211.47 375,-18211.47 375,-18205.47 381,-18199.47 387,-18199.47 387,-18199.47 685,-18199.47 685,-18199.47 691,-18199.47 697,-18205.47 697,-18211.47 697,-18211.47 697,-18234.47 697,-18234.47 697,-18240.47 691,-18246.47 685,-18246.47"/>
<text text-anchor="middle" x="536" y="-18231.47" font-family="Arial" font-size="10.00">Layer 62 Attention GPU7</text>
<text text-anchor="middle" x="536" y="-18220.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="536" y="-18209.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer62_qkv_7&#45;&gt;layer62_attn_7 -->
<g id="edge1003" class="edge">
<title>layer62_qkv_7&#45;&gt;layer62_attn_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M536,-18318.41C536,-18300.96 536,-18276.55 536,-18256.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="539.5,-18256.86 536,-18246.86 532.5,-18256.86 539.5,-18256.86"/>
</g>
<!-- layer62_attn_out_6 -->
<g id="node880" class="node">
<title>layer62_attn_out_6</title>
<path fill="#e6f3ff" stroke="black" d="M327,-18127.47C327,-18127.47 37,-18127.47 37,-18127.47 31,-18127.47 25,-18121.47 25,-18115.47 25,-18115.47 25,-18092.47 25,-18092.47 25,-18086.47 31,-18080.47 37,-18080.47 37,-18080.47 327,-18080.47 327,-18080.47 333,-18080.47 339,-18086.47 339,-18092.47 339,-18092.47 339,-18115.47 339,-18115.47 339,-18121.47 333,-18127.47 327,-18127.47"/>
<text text-anchor="middle" x="182" y="-18112.47" font-family="Arial" font-size="10.00">Layer 62 Attn Out GPU6</text>
<text text-anchor="middle" x="182" y="-18101.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="182" y="-18090.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer62_attn_6&#45;&gt;layer62_attn_out_6 -->
<g id="edge1004" class="edge">
<title>layer62_attn_6&#45;&gt;layer62_attn_out_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M178.77,-18199.41C179.37,-18181.96 180.2,-18157.55 180.87,-18137.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="184.37,-18137.97 181.22,-18127.86 177.38,-18137.73 184.37,-18137.97"/>
</g>
<!-- layer62_attn_out_7 -->
<g id="node881" class="node">
<title>layer62_attn_out_7</title>
<path fill="#e6f3ff" stroke="black" d="M679,-18127.47C679,-18127.47 389,-18127.47 389,-18127.47 383,-18127.47 377,-18121.47 377,-18115.47 377,-18115.47 377,-18092.47 377,-18092.47 377,-18086.47 383,-18080.47 389,-18080.47 389,-18080.47 679,-18080.47 679,-18080.47 685,-18080.47 691,-18086.47 691,-18092.47 691,-18092.47 691,-18115.47 691,-18115.47 691,-18121.47 685,-18127.47 679,-18127.47"/>
<text text-anchor="middle" x="534" y="-18112.47" font-family="Arial" font-size="10.00">Layer 62 Attn Out GPU7</text>
<text text-anchor="middle" x="534" y="-18101.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="534" y="-18090.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer62_attn_7&#45;&gt;layer62_attn_out_7 -->
<g id="edge1005" class="edge">
<title>layer62_attn_7&#45;&gt;layer62_attn_out_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M535.61,-18199.41C535.32,-18181.96 534.9,-18157.55 534.56,-18137.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="538.06,-18137.8 534.39,-18127.86 531.06,-18137.92 538.06,-18137.8"/>
</g>
<!-- layer62_attn_ar -->
<g id="node882" class="node">
<title>layer62_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M487.07,-18008.47C487.07,-18008.47 285.07,-18008.47 285.07,-18008.47 279.07,-18008.47 269.3,-18003.8 265.53,-17999.13 265.53,-17999.13 222.47,-17945.8 222.47,-17945.8 218.7,-17941.14 220.93,-17936.47 226.93,-17936.47 226.93,-17936.47 428.93,-17936.47 428.93,-17936.47 434.93,-17936.47 444.7,-17941.14 448.47,-17945.8 448.47,-17945.8 491.53,-17999.13 491.53,-17999.13 495.3,-18003.8 493.07,-18008.47 487.07,-18008.47"/>
<text text-anchor="middle" x="357" y="-17975.47" font-family="Arial" font-size="10.00">Layer 62 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="357" y="-17964.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer62_attn_out_6&#45;&gt;layer62_attn_ar -->
<g id="edge1006" class="edge">
<title>layer62_attn_out_6&#45;&gt;layer62_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M212.48,-18080.41C236.92,-18062.33 271.86,-18036.47 301.27,-18014.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="303.45,-18017.45 309.4,-18008.69 299.28,-18011.82 303.45,-18017.45"/>
</g>
<!-- layer62_attn_out_7&#45;&gt;layer62_attn_ar -->
<g id="edge1007" class="edge">
<title>layer62_attn_out_7&#45;&gt;layer62_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M503.17,-18080.41C478.45,-18062.33 443.11,-18036.47 413.37,-18014.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="415.28,-18011.77 405.14,-18008.69 411.14,-18017.42 415.28,-18011.77"/>
</g>
<!-- layer62_ffn1_6 -->
<g id="node883" class="node">
<title>layer62_ffn1_6</title>
<path fill="#e6f3ff" stroke="black" d="M327,-17864.47C327,-17864.47 57,-17864.47 57,-17864.47 51,-17864.47 45,-17858.47 45,-17852.47 45,-17852.47 45,-17829.47 45,-17829.47 45,-17823.47 51,-17817.47 57,-17817.47 57,-17817.47 327,-17817.47 327,-17817.47 333,-17817.47 339,-17823.47 339,-17829.47 339,-17829.47 339,-17852.47 339,-17852.47 339,-17858.47 333,-17864.47 327,-17864.47"/>
<text text-anchor="middle" x="192" y="-17849.47" font-family="Arial" font-size="10.00">Layer 62 FFN1 GPU6</text>
<text text-anchor="middle" x="192" y="-17838.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="192" y="-17827.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer62_attn_ar&#45;&gt;layer62_ffn1_6 -->
<g id="edge1008" class="edge">
<title>layer62_attn_ar&#45;&gt;layer62_ffn1_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M312.35,-17936.42C286.28,-17915.96 253.78,-17890.45 229.12,-17871.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="231.11,-17868.21 221.08,-17864.79 226.79,-17873.72 231.11,-17868.21"/>
</g>
<!-- layer62_ffn1_7 -->
<g id="node884" class="node">
<title>layer62_ffn1_7</title>
<path fill="#e6f3ff" stroke="black" d="M657,-17864.47C657,-17864.47 387,-17864.47 387,-17864.47 381,-17864.47 375,-17858.47 375,-17852.47 375,-17852.47 375,-17829.47 375,-17829.47 375,-17823.47 381,-17817.47 387,-17817.47 387,-17817.47 657,-17817.47 657,-17817.47 663,-17817.47 669,-17823.47 669,-17829.47 669,-17829.47 669,-17852.47 669,-17852.47 669,-17858.47 663,-17864.47 657,-17864.47"/>
<text text-anchor="middle" x="522" y="-17849.47" font-family="Arial" font-size="10.00">Layer 62 FFN1 GPU7</text>
<text text-anchor="middle" x="522" y="-17838.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="522" y="-17827.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer62_attn_ar&#45;&gt;layer62_ffn1_7 -->
<g id="edge1009" class="edge">
<title>layer62_attn_ar&#45;&gt;layer62_ffn1_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M401.65,-17936.42C427.72,-17915.96 460.22,-17890.45 484.88,-17871.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="487.21,-17873.72 492.92,-17864.79 482.89,-17868.21 487.21,-17873.72"/>
</g>
<!-- layer62_act_6 -->
<g id="node885" class="node">
<title>layer62_act_6</title>
<path fill="#e6f3ff" stroke="black" d="M327,-17745.47C327,-17745.47 57,-17745.47 57,-17745.47 51,-17745.47 45,-17739.47 45,-17733.47 45,-17733.47 45,-17710.47 45,-17710.47 45,-17704.47 51,-17698.47 57,-17698.47 57,-17698.47 327,-17698.47 327,-17698.47 333,-17698.47 339,-17704.47 339,-17710.47 339,-17710.47 339,-17733.47 339,-17733.47 339,-17739.47 333,-17745.47 327,-17745.47"/>
<text text-anchor="middle" x="192" y="-17730.47" font-family="Arial" font-size="10.00">Layer 62 SiLU GPU6</text>
<text text-anchor="middle" x="192" y="-17719.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="192" y="-17708.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer62_ffn1_6&#45;&gt;layer62_act_6 -->
<g id="edge1010" class="edge">
<title>layer62_ffn1_6&#45;&gt;layer62_act_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M192,-17817.41C192,-17799.96 192,-17775.55 192,-17755.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="195.5,-17755.86 192,-17745.86 188.5,-17755.86 195.5,-17755.86"/>
</g>
<!-- layer62_act_7 -->
<g id="node886" class="node">
<title>layer62_act_7</title>
<path fill="#e6f3ff" stroke="black" d="M657,-17745.47C657,-17745.47 387,-17745.47 387,-17745.47 381,-17745.47 375,-17739.47 375,-17733.47 375,-17733.47 375,-17710.47 375,-17710.47 375,-17704.47 381,-17698.47 387,-17698.47 387,-17698.47 657,-17698.47 657,-17698.47 663,-17698.47 669,-17704.47 669,-17710.47 669,-17710.47 669,-17733.47 669,-17733.47 669,-17739.47 663,-17745.47 657,-17745.47"/>
<text text-anchor="middle" x="522" y="-17730.47" font-family="Arial" font-size="10.00">Layer 62 SiLU GPU7</text>
<text text-anchor="middle" x="522" y="-17719.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="522" y="-17708.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer62_ffn1_7&#45;&gt;layer62_act_7 -->
<g id="edge1011" class="edge">
<title>layer62_ffn1_7&#45;&gt;layer62_act_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M522,-17817.41C522,-17799.96 522,-17775.55 522,-17755.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="525.5,-17755.86 522,-17745.86 518.5,-17755.86 525.5,-17755.86"/>
</g>
<!-- layer62_ffn2_6 -->
<g id="node887" class="node">
<title>layer62_ffn2_6</title>
<path fill="#e6f3ff" stroke="black" d="M326.5,-17626.47C326.5,-17626.47 63.5,-17626.47 63.5,-17626.47 57.5,-17626.47 51.5,-17620.47 51.5,-17614.47 51.5,-17614.47 51.5,-17591.47 51.5,-17591.47 51.5,-17585.47 57.5,-17579.47 63.5,-17579.47 63.5,-17579.47 326.5,-17579.47 326.5,-17579.47 332.5,-17579.47 338.5,-17585.47 338.5,-17591.47 338.5,-17591.47 338.5,-17614.47 338.5,-17614.47 338.5,-17620.47 332.5,-17626.47 326.5,-17626.47"/>
<text text-anchor="middle" x="195" y="-17611.47" font-family="Arial" font-size="10.00">Layer 62 FFN2 GPU6</text>
<text text-anchor="middle" x="195" y="-17600.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="195" y="-17589.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer62_act_6&#45;&gt;layer62_ffn2_6 -->
<g id="edge1012" class="edge">
<title>layer62_act_6&#45;&gt;layer62_ffn2_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M192.58,-17698.41C193.03,-17680.96 193.65,-17656.55 194.16,-17636.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="197.66,-17636.94 194.41,-17626.86 190.66,-17636.76 197.66,-17636.94"/>
</g>
<!-- layer62_ffn2_7 -->
<g id="node888" class="node">
<title>layer62_ffn2_7</title>
<path fill="#e6f3ff" stroke="black" d="M651.5,-17626.47C651.5,-17626.47 388.5,-17626.47 388.5,-17626.47 382.5,-17626.47 376.5,-17620.47 376.5,-17614.47 376.5,-17614.47 376.5,-17591.47 376.5,-17591.47 376.5,-17585.47 382.5,-17579.47 388.5,-17579.47 388.5,-17579.47 651.5,-17579.47 651.5,-17579.47 657.5,-17579.47 663.5,-17585.47 663.5,-17591.47 663.5,-17591.47 663.5,-17614.47 663.5,-17614.47 663.5,-17620.47 657.5,-17626.47 651.5,-17626.47"/>
<text text-anchor="middle" x="520" y="-17611.47" font-family="Arial" font-size="10.00">Layer 62 FFN2 GPU7</text>
<text text-anchor="middle" x="520" y="-17600.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="520" y="-17589.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer62_act_7&#45;&gt;layer62_ffn2_7 -->
<g id="edge1013" class="edge">
<title>layer62_act_7&#45;&gt;layer62_ffn2_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M521.61,-17698.41C521.32,-17680.96 520.9,-17656.55 520.56,-17636.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="524.06,-17636.8 520.39,-17626.86 517.06,-17636.92 524.06,-17636.8"/>
</g>
<!-- layer62_ffn_ar -->
<g id="node889" class="node">
<title>layer62_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M488.22,-17507.47C488.22,-17507.47 282.8,-17507.47 282.8,-17507.47 276.8,-17507.47 267,-17502.83 263.19,-17498.19 263.19,-17498.19 219.39,-17444.75 219.39,-17444.75 215.59,-17440.11 217.78,-17435.47 223.78,-17435.47 223.78,-17435.47 429.2,-17435.47 429.2,-17435.47 435.2,-17435.47 445,-17440.11 448.81,-17444.75 448.81,-17444.75 492.61,-17498.19 492.61,-17498.19 496.41,-17502.83 494.22,-17507.47 488.22,-17507.47"/>
<text text-anchor="middle" x="356" y="-17474.47" font-family="Arial" font-size="10.00">Layer 62 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="356" y="-17463.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer62_ffn2_6&#45;&gt;layer62_ffn_ar -->
<g id="edge1014" class="edge">
<title>layer62_ffn2_6&#45;&gt;layer62_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M223.04,-17579.41C245.43,-17561.41 277.4,-17535.69 304.38,-17513.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="306.61,-17516.68 312.21,-17507.69 302.23,-17511.23 306.61,-17516.68"/>
</g>
<!-- layer62_ffn2_7&#45;&gt;layer62_ffn_ar -->
<g id="edge1015" class="edge">
<title>layer62_ffn2_7&#45;&gt;layer62_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M491.43,-17579.41C468.63,-17561.41 436.06,-17535.69 408.58,-17513.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="410.62,-17511.14 400.6,-17507.69 406.28,-17516.63 410.62,-17511.14"/>
</g>
<!-- layer63_qkv_6 -->
<g id="node890" class="node">
<title>layer63_qkv_6</title>
<path fill="#e6f3ff" stroke="black" d="M326,-17363.47C326,-17363.47 28,-17363.47 28,-17363.47 22,-17363.47 16,-17357.47 16,-17351.47 16,-17351.47 16,-17328.47 16,-17328.47 16,-17322.47 22,-17316.47 28,-17316.47 28,-17316.47 326,-17316.47 326,-17316.47 332,-17316.47 338,-17322.47 338,-17328.47 338,-17328.47 338,-17351.47 338,-17351.47 338,-17357.47 332,-17363.47 326,-17363.47"/>
<text text-anchor="middle" x="177" y="-17348.47" font-family="Arial" font-size="10.00">Layer 63 QKV Proj GPU6</text>
<text text-anchor="middle" x="177" y="-17337.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="177" y="-17326.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer62_ffn_ar&#45;&gt;layer63_qkv_6 -->
<g id="edge1016" class="edge">
<title>layer62_ffn_ar&#45;&gt;layer63_qkv_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M307.56,-17435.42C279.06,-17414.81 243.48,-17389.06 216.66,-17369.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="218.43,-17366.62 208.28,-17363.6 214.33,-17372.3 218.43,-17366.62"/>
</g>
<!-- layer63_qkv_7 -->
<g id="node891" class="node">
<title>layer63_qkv_7</title>
<path fill="#e6f3ff" stroke="black" d="M684,-17363.47C684,-17363.47 386,-17363.47 386,-17363.47 380,-17363.47 374,-17357.47 374,-17351.47 374,-17351.47 374,-17328.47 374,-17328.47 374,-17322.47 380,-17316.47 386,-17316.47 386,-17316.47 684,-17316.47 684,-17316.47 690,-17316.47 696,-17322.47 696,-17328.47 696,-17328.47 696,-17351.47 696,-17351.47 696,-17357.47 690,-17363.47 684,-17363.47"/>
<text text-anchor="middle" x="535" y="-17348.47" font-family="Arial" font-size="10.00">Layer 63 QKV Proj GPU7</text>
<text text-anchor="middle" x="535" y="-17337.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="535" y="-17326.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer62_ffn_ar&#45;&gt;layer63_qkv_7 -->
<g id="edge1017" class="edge">
<title>layer62_ffn_ar&#45;&gt;layer63_qkv_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M404.44,-17435.42C432.94,-17414.81 468.52,-17389.06 495.34,-17369.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="497.67,-17372.3 503.72,-17363.6 493.57,-17366.62 497.67,-17372.3"/>
</g>
<!-- layer63_attn_6 -->
<g id="node892" class="node">
<title>layer63_attn_6</title>
<path fill="#e6f3ff" stroke="black" d="M326,-17244.47C326,-17244.47 28,-17244.47 28,-17244.47 22,-17244.47 16,-17238.47 16,-17232.47 16,-17232.47 16,-17209.47 16,-17209.47 16,-17203.47 22,-17197.47 28,-17197.47 28,-17197.47 326,-17197.47 326,-17197.47 332,-17197.47 338,-17203.47 338,-17209.47 338,-17209.47 338,-17232.47 338,-17232.47 338,-17238.47 332,-17244.47 326,-17244.47"/>
<text text-anchor="middle" x="177" y="-17229.47" font-family="Arial" font-size="10.00">Layer 63 Attention GPU6</text>
<text text-anchor="middle" x="177" y="-17218.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="177" y="-17207.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer63_qkv_6&#45;&gt;layer63_attn_6 -->
<g id="edge1018" class="edge">
<title>layer63_qkv_6&#45;&gt;layer63_attn_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M177,-17316.41C177,-17298.96 177,-17274.55 177,-17254.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="180.5,-17254.86 177,-17244.86 173.5,-17254.86 180.5,-17254.86"/>
</g>
<!-- layer63_attn_7 -->
<g id="node893" class="node">
<title>layer63_attn_7</title>
<path fill="#e6f3ff" stroke="black" d="M684,-17244.47C684,-17244.47 386,-17244.47 386,-17244.47 380,-17244.47 374,-17238.47 374,-17232.47 374,-17232.47 374,-17209.47 374,-17209.47 374,-17203.47 380,-17197.47 386,-17197.47 386,-17197.47 684,-17197.47 684,-17197.47 690,-17197.47 696,-17203.47 696,-17209.47 696,-17209.47 696,-17232.47 696,-17232.47 696,-17238.47 690,-17244.47 684,-17244.47"/>
<text text-anchor="middle" x="535" y="-17229.47" font-family="Arial" font-size="10.00">Layer 63 Attention GPU7</text>
<text text-anchor="middle" x="535" y="-17218.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="535" y="-17207.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer63_qkv_7&#45;&gt;layer63_attn_7 -->
<g id="edge1019" class="edge">
<title>layer63_qkv_7&#45;&gt;layer63_attn_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M535,-17316.41C535,-17298.96 535,-17274.55 535,-17254.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="538.5,-17254.86 535,-17244.86 531.5,-17254.86 538.5,-17254.86"/>
</g>
<!-- layer63_attn_out_6 -->
<g id="node894" class="node">
<title>layer63_attn_out_6</title>
<path fill="#e6f3ff" stroke="black" d="M326,-17125.47C326,-17125.47 36,-17125.47 36,-17125.47 30,-17125.47 24,-17119.47 24,-17113.47 24,-17113.47 24,-17090.47 24,-17090.47 24,-17084.47 30,-17078.47 36,-17078.47 36,-17078.47 326,-17078.47 326,-17078.47 332,-17078.47 338,-17084.47 338,-17090.47 338,-17090.47 338,-17113.47 338,-17113.47 338,-17119.47 332,-17125.47 326,-17125.47"/>
<text text-anchor="middle" x="181" y="-17110.47" font-family="Arial" font-size="10.00">Layer 63 Attn Out GPU6</text>
<text text-anchor="middle" x="181" y="-17099.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="181" y="-17088.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer63_attn_6&#45;&gt;layer63_attn_out_6 -->
<g id="edge1020" class="edge">
<title>layer63_attn_6&#45;&gt;layer63_attn_out_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M177.77,-17197.41C178.37,-17179.96 179.2,-17155.55 179.87,-17135.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="183.37,-17135.97 180.22,-17125.86 176.38,-17135.73 183.37,-17135.97"/>
</g>
<!-- layer63_attn_out_7 -->
<g id="node895" class="node">
<title>layer63_attn_out_7</title>
<path fill="#e6f3ff" stroke="black" d="M678,-17125.47C678,-17125.47 388,-17125.47 388,-17125.47 382,-17125.47 376,-17119.47 376,-17113.47 376,-17113.47 376,-17090.47 376,-17090.47 376,-17084.47 382,-17078.47 388,-17078.47 388,-17078.47 678,-17078.47 678,-17078.47 684,-17078.47 690,-17084.47 690,-17090.47 690,-17090.47 690,-17113.47 690,-17113.47 690,-17119.47 684,-17125.47 678,-17125.47"/>
<text text-anchor="middle" x="533" y="-17110.47" font-family="Arial" font-size="10.00">Layer 63 Attn Out GPU7</text>
<text text-anchor="middle" x="533" y="-17099.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="533" y="-17088.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer63_attn_7&#45;&gt;layer63_attn_out_7 -->
<g id="edge1021" class="edge">
<title>layer63_attn_7&#45;&gt;layer63_attn_out_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M534.61,-17197.41C534.32,-17179.96 533.9,-17155.55 533.56,-17135.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="537.06,-17135.8 533.39,-17125.86 530.06,-17135.92 537.06,-17135.8"/>
</g>
<!-- layer63_attn_ar -->
<g id="node896" class="node">
<title>layer63_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M486.07,-17006.47C486.07,-17006.47 284.07,-17006.47 284.07,-17006.47 278.07,-17006.47 268.3,-17001.8 264.53,-16997.13 264.53,-16997.13 221.47,-16943.8 221.47,-16943.8 217.7,-16939.14 219.93,-16934.47 225.93,-16934.47 225.93,-16934.47 427.93,-16934.47 427.93,-16934.47 433.93,-16934.47 443.7,-16939.14 447.47,-16943.8 447.47,-16943.8 490.53,-16997.13 490.53,-16997.13 494.3,-17001.8 492.07,-17006.47 486.07,-17006.47"/>
<text text-anchor="middle" x="356" y="-16973.47" font-family="Arial" font-size="10.00">Layer 63 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="356" y="-16962.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer63_attn_out_6&#45;&gt;layer63_attn_ar -->
<g id="edge1022" class="edge">
<title>layer63_attn_out_6&#45;&gt;layer63_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M211.48,-17078.41C235.92,-17060.33 270.86,-17034.47 300.27,-17012.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="302.45,-17015.45 308.4,-17006.69 298.28,-17009.82 302.45,-17015.45"/>
</g>
<!-- layer63_attn_out_7&#45;&gt;layer63_attn_ar -->
<g id="edge1023" class="edge">
<title>layer63_attn_out_7&#45;&gt;layer63_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M502.17,-17078.41C477.45,-17060.33 442.11,-17034.47 412.37,-17012.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="414.28,-17009.77 404.14,-17006.69 410.14,-17015.42 414.28,-17009.77"/>
</g>
<!-- layer63_ffn1_6 -->
<g id="node897" class="node">
<title>layer63_ffn1_6</title>
<path fill="#e6f3ff" stroke="black" d="M326,-16862.47C326,-16862.47 56,-16862.47 56,-16862.47 50,-16862.47 44,-16856.47 44,-16850.47 44,-16850.47 44,-16827.47 44,-16827.47 44,-16821.47 50,-16815.47 56,-16815.47 56,-16815.47 326,-16815.47 326,-16815.47 332,-16815.47 338,-16821.47 338,-16827.47 338,-16827.47 338,-16850.47 338,-16850.47 338,-16856.47 332,-16862.47 326,-16862.47"/>
<text text-anchor="middle" x="191" y="-16847.47" font-family="Arial" font-size="10.00">Layer 63 FFN1 GPU6</text>
<text text-anchor="middle" x="191" y="-16836.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="191" y="-16825.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer63_attn_ar&#45;&gt;layer63_ffn1_6 -->
<g id="edge1024" class="edge">
<title>layer63_attn_ar&#45;&gt;layer63_ffn1_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M311.35,-16934.42C285.28,-16913.96 252.78,-16888.45 228.12,-16869.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="230.11,-16866.21 220.08,-16862.79 225.79,-16871.72 230.11,-16866.21"/>
</g>
<!-- layer63_ffn1_7 -->
<g id="node898" class="node">
<title>layer63_ffn1_7</title>
<path fill="#e6f3ff" stroke="black" d="M656,-16862.47C656,-16862.47 386,-16862.47 386,-16862.47 380,-16862.47 374,-16856.47 374,-16850.47 374,-16850.47 374,-16827.47 374,-16827.47 374,-16821.47 380,-16815.47 386,-16815.47 386,-16815.47 656,-16815.47 656,-16815.47 662,-16815.47 668,-16821.47 668,-16827.47 668,-16827.47 668,-16850.47 668,-16850.47 668,-16856.47 662,-16862.47 656,-16862.47"/>
<text text-anchor="middle" x="521" y="-16847.47" font-family="Arial" font-size="10.00">Layer 63 FFN1 GPU7</text>
<text text-anchor="middle" x="521" y="-16836.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="521" y="-16825.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer63_attn_ar&#45;&gt;layer63_ffn1_7 -->
<g id="edge1025" class="edge">
<title>layer63_attn_ar&#45;&gt;layer63_ffn1_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M400.65,-16934.42C426.72,-16913.96 459.22,-16888.45 483.88,-16869.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="486.21,-16871.72 491.92,-16862.79 481.89,-16866.21 486.21,-16871.72"/>
</g>
<!-- layer63_act_6 -->
<g id="node899" class="node">
<title>layer63_act_6</title>
<path fill="#e6f3ff" stroke="black" d="M326,-16743.47C326,-16743.47 56,-16743.47 56,-16743.47 50,-16743.47 44,-16737.47 44,-16731.47 44,-16731.47 44,-16708.47 44,-16708.47 44,-16702.47 50,-16696.47 56,-16696.47 56,-16696.47 326,-16696.47 326,-16696.47 332,-16696.47 338,-16702.47 338,-16708.47 338,-16708.47 338,-16731.47 338,-16731.47 338,-16737.47 332,-16743.47 326,-16743.47"/>
<text text-anchor="middle" x="191" y="-16728.47" font-family="Arial" font-size="10.00">Layer 63 SiLU GPU6</text>
<text text-anchor="middle" x="191" y="-16717.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="191" y="-16706.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer63_ffn1_6&#45;&gt;layer63_act_6 -->
<g id="edge1026" class="edge">
<title>layer63_ffn1_6&#45;&gt;layer63_act_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M191,-16815.41C191,-16797.96 191,-16773.55 191,-16753.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="194.5,-16753.86 191,-16743.86 187.5,-16753.86 194.5,-16753.86"/>
</g>
<!-- layer63_act_7 -->
<g id="node900" class="node">
<title>layer63_act_7</title>
<path fill="#e6f3ff" stroke="black" d="M656,-16743.47C656,-16743.47 386,-16743.47 386,-16743.47 380,-16743.47 374,-16737.47 374,-16731.47 374,-16731.47 374,-16708.47 374,-16708.47 374,-16702.47 380,-16696.47 386,-16696.47 386,-16696.47 656,-16696.47 656,-16696.47 662,-16696.47 668,-16702.47 668,-16708.47 668,-16708.47 668,-16731.47 668,-16731.47 668,-16737.47 662,-16743.47 656,-16743.47"/>
<text text-anchor="middle" x="521" y="-16728.47" font-family="Arial" font-size="10.00">Layer 63 SiLU GPU7</text>
<text text-anchor="middle" x="521" y="-16717.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="521" y="-16706.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer63_ffn1_7&#45;&gt;layer63_act_7 -->
<g id="edge1027" class="edge">
<title>layer63_ffn1_7&#45;&gt;layer63_act_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M521,-16815.41C521,-16797.96 521,-16773.55 521,-16753.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="524.5,-16753.86 521,-16743.86 517.5,-16753.86 524.5,-16753.86"/>
</g>
<!-- layer63_ffn2_6 -->
<g id="node901" class="node">
<title>layer63_ffn2_6</title>
<path fill="#e6f3ff" stroke="black" d="M325.5,-16624.47C325.5,-16624.47 62.5,-16624.47 62.5,-16624.47 56.5,-16624.47 50.5,-16618.47 50.5,-16612.47 50.5,-16612.47 50.5,-16589.47 50.5,-16589.47 50.5,-16583.47 56.5,-16577.47 62.5,-16577.47 62.5,-16577.47 325.5,-16577.47 325.5,-16577.47 331.5,-16577.47 337.5,-16583.47 337.5,-16589.47 337.5,-16589.47 337.5,-16612.47 337.5,-16612.47 337.5,-16618.47 331.5,-16624.47 325.5,-16624.47"/>
<text text-anchor="middle" x="194" y="-16609.47" font-family="Arial" font-size="10.00">Layer 63 FFN2 GPU6</text>
<text text-anchor="middle" x="194" y="-16598.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="194" y="-16587.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer63_act_6&#45;&gt;layer63_ffn2_6 -->
<g id="edge1028" class="edge">
<title>layer63_act_6&#45;&gt;layer63_ffn2_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M191.58,-16696.41C192.03,-16678.96 192.65,-16654.55 193.16,-16634.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="196.66,-16634.94 193.41,-16624.86 189.66,-16634.76 196.66,-16634.94"/>
</g>
<!-- layer63_ffn2_7 -->
<g id="node902" class="node">
<title>layer63_ffn2_7</title>
<path fill="#e6f3ff" stroke="black" d="M650.5,-16624.47C650.5,-16624.47 387.5,-16624.47 387.5,-16624.47 381.5,-16624.47 375.5,-16618.47 375.5,-16612.47 375.5,-16612.47 375.5,-16589.47 375.5,-16589.47 375.5,-16583.47 381.5,-16577.47 387.5,-16577.47 387.5,-16577.47 650.5,-16577.47 650.5,-16577.47 656.5,-16577.47 662.5,-16583.47 662.5,-16589.47 662.5,-16589.47 662.5,-16612.47 662.5,-16612.47 662.5,-16618.47 656.5,-16624.47 650.5,-16624.47"/>
<text text-anchor="middle" x="519" y="-16609.47" font-family="Arial" font-size="10.00">Layer 63 FFN2 GPU7</text>
<text text-anchor="middle" x="519" y="-16598.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="519" y="-16587.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer63_act_7&#45;&gt;layer63_ffn2_7 -->
<g id="edge1029" class="edge">
<title>layer63_act_7&#45;&gt;layer63_ffn2_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M520.61,-16696.41C520.32,-16678.96 519.9,-16654.55 519.56,-16634.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="523.06,-16634.8 519.39,-16624.86 516.06,-16634.92 523.06,-16634.8"/>
</g>
<!-- layer63_ffn_ar -->
<g id="node903" class="node">
<title>layer63_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M487.22,-16505.47C487.22,-16505.47 281.8,-16505.47 281.8,-16505.47 275.8,-16505.47 266,-16500.83 262.19,-16496.19 262.19,-16496.19 218.39,-16442.75 218.39,-16442.75 214.59,-16438.11 216.78,-16433.47 222.78,-16433.47 222.78,-16433.47 428.2,-16433.47 428.2,-16433.47 434.2,-16433.47 444,-16438.11 447.81,-16442.75 447.81,-16442.75 491.61,-16496.19 491.61,-16496.19 495.41,-16500.83 493.22,-16505.47 487.22,-16505.47"/>
<text text-anchor="middle" x="355" y="-16472.47" font-family="Arial" font-size="10.00">Layer 63 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="355" y="-16461.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer63_ffn2_6&#45;&gt;layer63_ffn_ar -->
<g id="edge1030" class="edge">
<title>layer63_ffn2_6&#45;&gt;layer63_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M222.04,-16577.41C244.43,-16559.41 276.4,-16533.69 303.38,-16511.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="305.61,-16514.68 311.21,-16505.69 301.23,-16509.23 305.61,-16514.68"/>
</g>
<!-- layer63_ffn2_7&#45;&gt;layer63_ffn_ar -->
<g id="edge1031" class="edge">
<title>layer63_ffn2_7&#45;&gt;layer63_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M490.43,-16577.41C467.63,-16559.41 435.06,-16533.69 407.58,-16511.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="409.62,-16509.14 399.6,-16505.69 405.28,-16514.63 409.62,-16509.14"/>
</g>
<!-- layer64_qkv_6 -->
<g id="node904" class="node">
<title>layer64_qkv_6</title>
<path fill="#e6f3ff" stroke="black" d="M325,-16361.47C325,-16361.47 27,-16361.47 27,-16361.47 21,-16361.47 15,-16355.47 15,-16349.47 15,-16349.47 15,-16326.47 15,-16326.47 15,-16320.47 21,-16314.47 27,-16314.47 27,-16314.47 325,-16314.47 325,-16314.47 331,-16314.47 337,-16320.47 337,-16326.47 337,-16326.47 337,-16349.47 337,-16349.47 337,-16355.47 331,-16361.47 325,-16361.47"/>
<text text-anchor="middle" x="176" y="-16346.47" font-family="Arial" font-size="10.00">Layer 64 QKV Proj GPU6</text>
<text text-anchor="middle" x="176" y="-16335.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="176" y="-16324.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer63_ffn_ar&#45;&gt;layer64_qkv_6 -->
<g id="edge1032" class="edge">
<title>layer63_ffn_ar&#45;&gt;layer64_qkv_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M306.56,-16433.42C278.06,-16412.81 242.48,-16387.06 215.66,-16367.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="217.43,-16364.62 207.28,-16361.6 213.33,-16370.3 217.43,-16364.62"/>
</g>
<!-- layer64_qkv_7 -->
<g id="node905" class="node">
<title>layer64_qkv_7</title>
<path fill="#e6f3ff" stroke="black" d="M683,-16361.47C683,-16361.47 385,-16361.47 385,-16361.47 379,-16361.47 373,-16355.47 373,-16349.47 373,-16349.47 373,-16326.47 373,-16326.47 373,-16320.47 379,-16314.47 385,-16314.47 385,-16314.47 683,-16314.47 683,-16314.47 689,-16314.47 695,-16320.47 695,-16326.47 695,-16326.47 695,-16349.47 695,-16349.47 695,-16355.47 689,-16361.47 683,-16361.47"/>
<text text-anchor="middle" x="534" y="-16346.47" font-family="Arial" font-size="10.00">Layer 64 QKV Proj GPU7</text>
<text text-anchor="middle" x="534" y="-16335.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="534" y="-16324.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer63_ffn_ar&#45;&gt;layer64_qkv_7 -->
<g id="edge1033" class="edge">
<title>layer63_ffn_ar&#45;&gt;layer64_qkv_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M403.44,-16433.42C431.94,-16412.81 467.52,-16387.06 494.34,-16367.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="496.67,-16370.3 502.72,-16361.6 492.57,-16364.62 496.67,-16370.3"/>
</g>
<!-- layer64_attn_6 -->
<g id="node906" class="node">
<title>layer64_attn_6</title>
<path fill="#e6f3ff" stroke="black" d="M325,-16242.47C325,-16242.47 27,-16242.47 27,-16242.47 21,-16242.47 15,-16236.47 15,-16230.47 15,-16230.47 15,-16207.47 15,-16207.47 15,-16201.47 21,-16195.47 27,-16195.47 27,-16195.47 325,-16195.47 325,-16195.47 331,-16195.47 337,-16201.47 337,-16207.47 337,-16207.47 337,-16230.47 337,-16230.47 337,-16236.47 331,-16242.47 325,-16242.47"/>
<text text-anchor="middle" x="176" y="-16227.47" font-family="Arial" font-size="10.00">Layer 64 Attention GPU6</text>
<text text-anchor="middle" x="176" y="-16216.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="176" y="-16205.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer64_qkv_6&#45;&gt;layer64_attn_6 -->
<g id="edge1034" class="edge">
<title>layer64_qkv_6&#45;&gt;layer64_attn_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M176,-16314.41C176,-16296.96 176,-16272.55 176,-16252.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="179.5,-16252.86 176,-16242.86 172.5,-16252.86 179.5,-16252.86"/>
</g>
<!-- layer64_attn_7 -->
<g id="node907" class="node">
<title>layer64_attn_7</title>
<path fill="#e6f3ff" stroke="black" d="M683,-16242.47C683,-16242.47 385,-16242.47 385,-16242.47 379,-16242.47 373,-16236.47 373,-16230.47 373,-16230.47 373,-16207.47 373,-16207.47 373,-16201.47 379,-16195.47 385,-16195.47 385,-16195.47 683,-16195.47 683,-16195.47 689,-16195.47 695,-16201.47 695,-16207.47 695,-16207.47 695,-16230.47 695,-16230.47 695,-16236.47 689,-16242.47 683,-16242.47"/>
<text text-anchor="middle" x="534" y="-16227.47" font-family="Arial" font-size="10.00">Layer 64 Attention GPU7</text>
<text text-anchor="middle" x="534" y="-16216.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="534" y="-16205.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer64_qkv_7&#45;&gt;layer64_attn_7 -->
<g id="edge1035" class="edge">
<title>layer64_qkv_7&#45;&gt;layer64_attn_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M534,-16314.41C534,-16296.96 534,-16272.55 534,-16252.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="537.5,-16252.86 534,-16242.86 530.5,-16252.86 537.5,-16252.86"/>
</g>
<!-- layer64_attn_out_6 -->
<g id="node908" class="node">
<title>layer64_attn_out_6</title>
<path fill="#e6f3ff" stroke="black" d="M325,-16123.47C325,-16123.47 35,-16123.47 35,-16123.47 29,-16123.47 23,-16117.47 23,-16111.47 23,-16111.47 23,-16088.47 23,-16088.47 23,-16082.47 29,-16076.47 35,-16076.47 35,-16076.47 325,-16076.47 325,-16076.47 331,-16076.47 337,-16082.47 337,-16088.47 337,-16088.47 337,-16111.47 337,-16111.47 337,-16117.47 331,-16123.47 325,-16123.47"/>
<text text-anchor="middle" x="180" y="-16108.47" font-family="Arial" font-size="10.00">Layer 64 Attn Out GPU6</text>
<text text-anchor="middle" x="180" y="-16097.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="180" y="-16086.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer64_attn_6&#45;&gt;layer64_attn_out_6 -->
<g id="edge1036" class="edge">
<title>layer64_attn_6&#45;&gt;layer64_attn_out_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M176.77,-16195.41C177.37,-16177.96 178.2,-16153.55 178.87,-16133.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="182.37,-16133.97 179.22,-16123.86 175.38,-16133.73 182.37,-16133.97"/>
</g>
<!-- layer64_attn_out_7 -->
<g id="node909" class="node">
<title>layer64_attn_out_7</title>
<path fill="#e6f3ff" stroke="black" d="M677,-16123.47C677,-16123.47 387,-16123.47 387,-16123.47 381,-16123.47 375,-16117.47 375,-16111.47 375,-16111.47 375,-16088.47 375,-16088.47 375,-16082.47 381,-16076.47 387,-16076.47 387,-16076.47 677,-16076.47 677,-16076.47 683,-16076.47 689,-16082.47 689,-16088.47 689,-16088.47 689,-16111.47 689,-16111.47 689,-16117.47 683,-16123.47 677,-16123.47"/>
<text text-anchor="middle" x="532" y="-16108.47" font-family="Arial" font-size="10.00">Layer 64 Attn Out GPU7</text>
<text text-anchor="middle" x="532" y="-16097.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="532" y="-16086.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer64_attn_7&#45;&gt;layer64_attn_out_7 -->
<g id="edge1037" class="edge">
<title>layer64_attn_7&#45;&gt;layer64_attn_out_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M533.61,-16195.41C533.32,-16177.96 532.9,-16153.55 532.56,-16133.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="536.06,-16133.8 532.39,-16123.86 529.06,-16133.92 536.06,-16133.8"/>
</g>
<!-- layer64_attn_ar -->
<g id="node910" class="node">
<title>layer64_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M485.07,-16004.47C485.07,-16004.47 283.07,-16004.47 283.07,-16004.47 277.07,-16004.47 267.3,-15999.8 263.53,-15995.13 263.53,-15995.13 220.47,-15941.8 220.47,-15941.8 216.7,-15937.14 218.93,-15932.47 224.93,-15932.47 224.93,-15932.47 426.93,-15932.47 426.93,-15932.47 432.93,-15932.47 442.7,-15937.14 446.47,-15941.8 446.47,-15941.8 489.53,-15995.13 489.53,-15995.13 493.3,-15999.8 491.07,-16004.47 485.07,-16004.47"/>
<text text-anchor="middle" x="355" y="-15971.47" font-family="Arial" font-size="10.00">Layer 64 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="355" y="-15960.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer64_attn_out_6&#45;&gt;layer64_attn_ar -->
<g id="edge1038" class="edge">
<title>layer64_attn_out_6&#45;&gt;layer64_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M210.48,-16076.41C234.92,-16058.33 269.86,-16032.47 299.27,-16010.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="301.45,-16013.45 307.4,-16004.69 297.28,-16007.82 301.45,-16013.45"/>
</g>
<!-- layer64_attn_out_7&#45;&gt;layer64_attn_ar -->
<g id="edge1039" class="edge">
<title>layer64_attn_out_7&#45;&gt;layer64_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M501.17,-16076.41C476.45,-16058.33 441.11,-16032.47 411.37,-16010.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="413.28,-16007.77 403.14,-16004.69 409.14,-16013.42 413.28,-16007.77"/>
</g>
<!-- layer64_ffn1_6 -->
<g id="node911" class="node">
<title>layer64_ffn1_6</title>
<path fill="#e6f3ff" stroke="black" d="M325,-15860.47C325,-15860.47 55,-15860.47 55,-15860.47 49,-15860.47 43,-15854.47 43,-15848.47 43,-15848.47 43,-15825.47 43,-15825.47 43,-15819.47 49,-15813.47 55,-15813.47 55,-15813.47 325,-15813.47 325,-15813.47 331,-15813.47 337,-15819.47 337,-15825.47 337,-15825.47 337,-15848.47 337,-15848.47 337,-15854.47 331,-15860.47 325,-15860.47"/>
<text text-anchor="middle" x="190" y="-15845.47" font-family="Arial" font-size="10.00">Layer 64 FFN1 GPU6</text>
<text text-anchor="middle" x="190" y="-15834.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="190" y="-15823.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer64_attn_ar&#45;&gt;layer64_ffn1_6 -->
<g id="edge1040" class="edge">
<title>layer64_attn_ar&#45;&gt;layer64_ffn1_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M310.35,-15932.42C284.28,-15911.96 251.78,-15886.45 227.12,-15867.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="229.11,-15864.21 219.08,-15860.79 224.79,-15869.72 229.11,-15864.21"/>
</g>
<!-- layer64_ffn1_7 -->
<g id="node912" class="node">
<title>layer64_ffn1_7</title>
<path fill="#e6f3ff" stroke="black" d="M655,-15860.47C655,-15860.47 385,-15860.47 385,-15860.47 379,-15860.47 373,-15854.47 373,-15848.47 373,-15848.47 373,-15825.47 373,-15825.47 373,-15819.47 379,-15813.47 385,-15813.47 385,-15813.47 655,-15813.47 655,-15813.47 661,-15813.47 667,-15819.47 667,-15825.47 667,-15825.47 667,-15848.47 667,-15848.47 667,-15854.47 661,-15860.47 655,-15860.47"/>
<text text-anchor="middle" x="520" y="-15845.47" font-family="Arial" font-size="10.00">Layer 64 FFN1 GPU7</text>
<text text-anchor="middle" x="520" y="-15834.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="520" y="-15823.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer64_attn_ar&#45;&gt;layer64_ffn1_7 -->
<g id="edge1041" class="edge">
<title>layer64_attn_ar&#45;&gt;layer64_ffn1_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M399.65,-15932.42C425.72,-15911.96 458.22,-15886.45 482.88,-15867.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="485.21,-15869.72 490.92,-15860.79 480.89,-15864.21 485.21,-15869.72"/>
</g>
<!-- layer64_act_6 -->
<g id="node913" class="node">
<title>layer64_act_6</title>
<path fill="#e6f3ff" stroke="black" d="M325,-15741.47C325,-15741.47 55,-15741.47 55,-15741.47 49,-15741.47 43,-15735.47 43,-15729.47 43,-15729.47 43,-15706.47 43,-15706.47 43,-15700.47 49,-15694.47 55,-15694.47 55,-15694.47 325,-15694.47 325,-15694.47 331,-15694.47 337,-15700.47 337,-15706.47 337,-15706.47 337,-15729.47 337,-15729.47 337,-15735.47 331,-15741.47 325,-15741.47"/>
<text text-anchor="middle" x="190" y="-15726.47" font-family="Arial" font-size="10.00">Layer 64 SiLU GPU6</text>
<text text-anchor="middle" x="190" y="-15715.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="190" y="-15704.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer64_ffn1_6&#45;&gt;layer64_act_6 -->
<g id="edge1042" class="edge">
<title>layer64_ffn1_6&#45;&gt;layer64_act_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M190,-15813.41C190,-15795.96 190,-15771.55 190,-15751.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="193.5,-15751.86 190,-15741.86 186.5,-15751.86 193.5,-15751.86"/>
</g>
<!-- layer64_act_7 -->
<g id="node914" class="node">
<title>layer64_act_7</title>
<path fill="#e6f3ff" stroke="black" d="M655,-15741.47C655,-15741.47 385,-15741.47 385,-15741.47 379,-15741.47 373,-15735.47 373,-15729.47 373,-15729.47 373,-15706.47 373,-15706.47 373,-15700.47 379,-15694.47 385,-15694.47 385,-15694.47 655,-15694.47 655,-15694.47 661,-15694.47 667,-15700.47 667,-15706.47 667,-15706.47 667,-15729.47 667,-15729.47 667,-15735.47 661,-15741.47 655,-15741.47"/>
<text text-anchor="middle" x="520" y="-15726.47" font-family="Arial" font-size="10.00">Layer 64 SiLU GPU7</text>
<text text-anchor="middle" x="520" y="-15715.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="520" y="-15704.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer64_ffn1_7&#45;&gt;layer64_act_7 -->
<g id="edge1043" class="edge">
<title>layer64_ffn1_7&#45;&gt;layer64_act_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M520,-15813.41C520,-15795.96 520,-15771.55 520,-15751.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="523.5,-15751.86 520,-15741.86 516.5,-15751.86 523.5,-15751.86"/>
</g>
<!-- layer64_ffn2_6 -->
<g id="node915" class="node">
<title>layer64_ffn2_6</title>
<path fill="#e6f3ff" stroke="black" d="M324.5,-15622.47C324.5,-15622.47 61.5,-15622.47 61.5,-15622.47 55.5,-15622.47 49.5,-15616.47 49.5,-15610.47 49.5,-15610.47 49.5,-15587.47 49.5,-15587.47 49.5,-15581.47 55.5,-15575.47 61.5,-15575.47 61.5,-15575.47 324.5,-15575.47 324.5,-15575.47 330.5,-15575.47 336.5,-15581.47 336.5,-15587.47 336.5,-15587.47 336.5,-15610.47 336.5,-15610.47 336.5,-15616.47 330.5,-15622.47 324.5,-15622.47"/>
<text text-anchor="middle" x="193" y="-15607.47" font-family="Arial" font-size="10.00">Layer 64 FFN2 GPU6</text>
<text text-anchor="middle" x="193" y="-15596.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="193" y="-15585.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer64_act_6&#45;&gt;layer64_ffn2_6 -->
<g id="edge1044" class="edge">
<title>layer64_act_6&#45;&gt;layer64_ffn2_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M190.58,-15694.41C191.03,-15676.96 191.65,-15652.55 192.16,-15632.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="195.66,-15632.94 192.41,-15622.86 188.66,-15632.76 195.66,-15632.94"/>
</g>
<!-- layer64_ffn2_7 -->
<g id="node916" class="node">
<title>layer64_ffn2_7</title>
<path fill="#e6f3ff" stroke="black" d="M649.5,-15622.47C649.5,-15622.47 386.5,-15622.47 386.5,-15622.47 380.5,-15622.47 374.5,-15616.47 374.5,-15610.47 374.5,-15610.47 374.5,-15587.47 374.5,-15587.47 374.5,-15581.47 380.5,-15575.47 386.5,-15575.47 386.5,-15575.47 649.5,-15575.47 649.5,-15575.47 655.5,-15575.47 661.5,-15581.47 661.5,-15587.47 661.5,-15587.47 661.5,-15610.47 661.5,-15610.47 661.5,-15616.47 655.5,-15622.47 649.5,-15622.47"/>
<text text-anchor="middle" x="518" y="-15607.47" font-family="Arial" font-size="10.00">Layer 64 FFN2 GPU7</text>
<text text-anchor="middle" x="518" y="-15596.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="518" y="-15585.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer64_act_7&#45;&gt;layer64_ffn2_7 -->
<g id="edge1045" class="edge">
<title>layer64_act_7&#45;&gt;layer64_ffn2_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M519.61,-15694.41C519.32,-15676.96 518.9,-15652.55 518.56,-15632.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="522.06,-15632.8 518.39,-15622.86 515.06,-15632.92 522.06,-15632.8"/>
</g>
<!-- layer64_ffn_ar -->
<g id="node917" class="node">
<title>layer64_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M486.22,-15503.47C486.22,-15503.47 280.8,-15503.47 280.8,-15503.47 274.8,-15503.47 265,-15498.83 261.19,-15494.19 261.19,-15494.19 217.39,-15440.75 217.39,-15440.75 213.59,-15436.11 215.78,-15431.47 221.78,-15431.47 221.78,-15431.47 427.2,-15431.47 427.2,-15431.47 433.2,-15431.47 443,-15436.11 446.81,-15440.75 446.81,-15440.75 490.61,-15494.19 490.61,-15494.19 494.41,-15498.83 492.22,-15503.47 486.22,-15503.47"/>
<text text-anchor="middle" x="354" y="-15470.47" font-family="Arial" font-size="10.00">Layer 64 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="354" y="-15459.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer64_ffn2_6&#45;&gt;layer64_ffn_ar -->
<g id="edge1046" class="edge">
<title>layer64_ffn2_6&#45;&gt;layer64_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M221.04,-15575.41C243.43,-15557.41 275.4,-15531.69 302.38,-15509.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="304.61,-15512.68 310.21,-15503.69 300.23,-15507.23 304.61,-15512.68"/>
</g>
<!-- layer64_ffn2_7&#45;&gt;layer64_ffn_ar -->
<g id="edge1047" class="edge">
<title>layer64_ffn2_7&#45;&gt;layer64_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M489.43,-15575.41C466.63,-15557.41 434.06,-15531.69 406.58,-15509.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="408.62,-15507.14 398.6,-15503.69 404.28,-15512.63 408.62,-15507.14"/>
</g>
<!-- layer65_qkv_6 -->
<g id="node918" class="node">
<title>layer65_qkv_6</title>
<path fill="#e6f3ff" stroke="black" d="M324,-15359.47C324,-15359.47 26,-15359.47 26,-15359.47 20,-15359.47 14,-15353.47 14,-15347.47 14,-15347.47 14,-15324.47 14,-15324.47 14,-15318.47 20,-15312.47 26,-15312.47 26,-15312.47 324,-15312.47 324,-15312.47 330,-15312.47 336,-15318.47 336,-15324.47 336,-15324.47 336,-15347.47 336,-15347.47 336,-15353.47 330,-15359.47 324,-15359.47"/>
<text text-anchor="middle" x="175" y="-15344.47" font-family="Arial" font-size="10.00">Layer 65 QKV Proj GPU6</text>
<text text-anchor="middle" x="175" y="-15333.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="175" y="-15322.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer64_ffn_ar&#45;&gt;layer65_qkv_6 -->
<g id="edge1048" class="edge">
<title>layer64_ffn_ar&#45;&gt;layer65_qkv_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M305.56,-15431.42C277.06,-15410.81 241.48,-15385.06 214.66,-15365.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="216.43,-15362.62 206.28,-15359.6 212.33,-15368.3 216.43,-15362.62"/>
</g>
<!-- layer65_qkv_7 -->
<g id="node919" class="node">
<title>layer65_qkv_7</title>
<path fill="#e6f3ff" stroke="black" d="M682,-15359.47C682,-15359.47 384,-15359.47 384,-15359.47 378,-15359.47 372,-15353.47 372,-15347.47 372,-15347.47 372,-15324.47 372,-15324.47 372,-15318.47 378,-15312.47 384,-15312.47 384,-15312.47 682,-15312.47 682,-15312.47 688,-15312.47 694,-15318.47 694,-15324.47 694,-15324.47 694,-15347.47 694,-15347.47 694,-15353.47 688,-15359.47 682,-15359.47"/>
<text text-anchor="middle" x="533" y="-15344.47" font-family="Arial" font-size="10.00">Layer 65 QKV Proj GPU7</text>
<text text-anchor="middle" x="533" y="-15333.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="533" y="-15322.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer64_ffn_ar&#45;&gt;layer65_qkv_7 -->
<g id="edge1049" class="edge">
<title>layer64_ffn_ar&#45;&gt;layer65_qkv_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M402.44,-15431.42C430.94,-15410.81 466.52,-15385.06 493.34,-15365.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="495.67,-15368.3 501.72,-15359.6 491.57,-15362.62 495.67,-15368.3"/>
</g>
<!-- layer65_attn_6 -->
<g id="node920" class="node">
<title>layer65_attn_6</title>
<path fill="#e6f3ff" stroke="black" d="M324,-15240.47C324,-15240.47 26,-15240.47 26,-15240.47 20,-15240.47 14,-15234.47 14,-15228.47 14,-15228.47 14,-15205.47 14,-15205.47 14,-15199.47 20,-15193.47 26,-15193.47 26,-15193.47 324,-15193.47 324,-15193.47 330,-15193.47 336,-15199.47 336,-15205.47 336,-15205.47 336,-15228.47 336,-15228.47 336,-15234.47 330,-15240.47 324,-15240.47"/>
<text text-anchor="middle" x="175" y="-15225.47" font-family="Arial" font-size="10.00">Layer 65 Attention GPU6</text>
<text text-anchor="middle" x="175" y="-15214.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="175" y="-15203.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer65_qkv_6&#45;&gt;layer65_attn_6 -->
<g id="edge1050" class="edge">
<title>layer65_qkv_6&#45;&gt;layer65_attn_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M175,-15312.41C175,-15294.96 175,-15270.55 175,-15250.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="178.5,-15250.86 175,-15240.86 171.5,-15250.86 178.5,-15250.86"/>
</g>
<!-- layer65_attn_7 -->
<g id="node921" class="node">
<title>layer65_attn_7</title>
<path fill="#e6f3ff" stroke="black" d="M682,-15240.47C682,-15240.47 384,-15240.47 384,-15240.47 378,-15240.47 372,-15234.47 372,-15228.47 372,-15228.47 372,-15205.47 372,-15205.47 372,-15199.47 378,-15193.47 384,-15193.47 384,-15193.47 682,-15193.47 682,-15193.47 688,-15193.47 694,-15199.47 694,-15205.47 694,-15205.47 694,-15228.47 694,-15228.47 694,-15234.47 688,-15240.47 682,-15240.47"/>
<text text-anchor="middle" x="533" y="-15225.47" font-family="Arial" font-size="10.00">Layer 65 Attention GPU7</text>
<text text-anchor="middle" x="533" y="-15214.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="533" y="-15203.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer65_qkv_7&#45;&gt;layer65_attn_7 -->
<g id="edge1051" class="edge">
<title>layer65_qkv_7&#45;&gt;layer65_attn_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M533,-15312.41C533,-15294.96 533,-15270.55 533,-15250.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="536.5,-15250.86 533,-15240.86 529.5,-15250.86 536.5,-15250.86"/>
</g>
<!-- layer65_attn_out_6 -->
<g id="node922" class="node">
<title>layer65_attn_out_6</title>
<path fill="#e6f3ff" stroke="black" d="M324,-15121.47C324,-15121.47 34,-15121.47 34,-15121.47 28,-15121.47 22,-15115.47 22,-15109.47 22,-15109.47 22,-15086.47 22,-15086.47 22,-15080.47 28,-15074.47 34,-15074.47 34,-15074.47 324,-15074.47 324,-15074.47 330,-15074.47 336,-15080.47 336,-15086.47 336,-15086.47 336,-15109.47 336,-15109.47 336,-15115.47 330,-15121.47 324,-15121.47"/>
<text text-anchor="middle" x="179" y="-15106.47" font-family="Arial" font-size="10.00">Layer 65 Attn Out GPU6</text>
<text text-anchor="middle" x="179" y="-15095.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="179" y="-15084.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer65_attn_6&#45;&gt;layer65_attn_out_6 -->
<g id="edge1052" class="edge">
<title>layer65_attn_6&#45;&gt;layer65_attn_out_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M175.77,-15193.41C176.37,-15175.96 177.2,-15151.55 177.87,-15131.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="181.37,-15131.97 178.22,-15121.86 174.38,-15131.73 181.37,-15131.97"/>
</g>
<!-- layer65_attn_out_7 -->
<g id="node923" class="node">
<title>layer65_attn_out_7</title>
<path fill="#e6f3ff" stroke="black" d="M676,-15121.47C676,-15121.47 386,-15121.47 386,-15121.47 380,-15121.47 374,-15115.47 374,-15109.47 374,-15109.47 374,-15086.47 374,-15086.47 374,-15080.47 380,-15074.47 386,-15074.47 386,-15074.47 676,-15074.47 676,-15074.47 682,-15074.47 688,-15080.47 688,-15086.47 688,-15086.47 688,-15109.47 688,-15109.47 688,-15115.47 682,-15121.47 676,-15121.47"/>
<text text-anchor="middle" x="531" y="-15106.47" font-family="Arial" font-size="10.00">Layer 65 Attn Out GPU7</text>
<text text-anchor="middle" x="531" y="-15095.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="531" y="-15084.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer65_attn_7&#45;&gt;layer65_attn_out_7 -->
<g id="edge1053" class="edge">
<title>layer65_attn_7&#45;&gt;layer65_attn_out_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M532.61,-15193.41C532.32,-15175.96 531.9,-15151.55 531.56,-15131.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="535.06,-15131.8 531.39,-15121.86 528.06,-15131.92 535.06,-15131.8"/>
</g>
<!-- layer65_attn_ar -->
<g id="node924" class="node">
<title>layer65_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M484.07,-15002.47C484.07,-15002.47 282.07,-15002.47 282.07,-15002.47 276.07,-15002.47 266.3,-14997.8 262.53,-14993.13 262.53,-14993.13 219.47,-14939.8 219.47,-14939.8 215.7,-14935.14 217.93,-14930.47 223.93,-14930.47 223.93,-14930.47 425.93,-14930.47 425.93,-14930.47 431.93,-14930.47 441.7,-14935.14 445.47,-14939.8 445.47,-14939.8 488.53,-14993.13 488.53,-14993.13 492.3,-14997.8 490.07,-15002.47 484.07,-15002.47"/>
<text text-anchor="middle" x="354" y="-14969.47" font-family="Arial" font-size="10.00">Layer 65 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="354" y="-14958.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer65_attn_out_6&#45;&gt;layer65_attn_ar -->
<g id="edge1054" class="edge">
<title>layer65_attn_out_6&#45;&gt;layer65_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M209.48,-15074.41C233.92,-15056.33 268.86,-15030.47 298.27,-15008.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="300.45,-15011.45 306.4,-15002.69 296.28,-15005.82 300.45,-15011.45"/>
</g>
<!-- layer65_attn_out_7&#45;&gt;layer65_attn_ar -->
<g id="edge1055" class="edge">
<title>layer65_attn_out_7&#45;&gt;layer65_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M500.17,-15074.41C475.45,-15056.33 440.11,-15030.47 410.37,-15008.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="412.28,-15005.77 402.14,-15002.69 408.14,-15011.42 412.28,-15005.77"/>
</g>
<!-- layer65_ffn1_6 -->
<g id="node925" class="node">
<title>layer65_ffn1_6</title>
<path fill="#e6f3ff" stroke="black" d="M324,-14858.47C324,-14858.47 54,-14858.47 54,-14858.47 48,-14858.47 42,-14852.47 42,-14846.47 42,-14846.47 42,-14823.47 42,-14823.47 42,-14817.47 48,-14811.47 54,-14811.47 54,-14811.47 324,-14811.47 324,-14811.47 330,-14811.47 336,-14817.47 336,-14823.47 336,-14823.47 336,-14846.47 336,-14846.47 336,-14852.47 330,-14858.47 324,-14858.47"/>
<text text-anchor="middle" x="189" y="-14843.47" font-family="Arial" font-size="10.00">Layer 65 FFN1 GPU6</text>
<text text-anchor="middle" x="189" y="-14832.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="189" y="-14821.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer65_attn_ar&#45;&gt;layer65_ffn1_6 -->
<g id="edge1056" class="edge">
<title>layer65_attn_ar&#45;&gt;layer65_ffn1_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M309.35,-14930.42C283.28,-14909.96 250.78,-14884.45 226.12,-14865.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="228.11,-14862.21 218.08,-14858.79 223.79,-14867.72 228.11,-14862.21"/>
</g>
<!-- layer65_ffn1_7 -->
<g id="node926" class="node">
<title>layer65_ffn1_7</title>
<path fill="#e6f3ff" stroke="black" d="M654,-14858.47C654,-14858.47 384,-14858.47 384,-14858.47 378,-14858.47 372,-14852.47 372,-14846.47 372,-14846.47 372,-14823.47 372,-14823.47 372,-14817.47 378,-14811.47 384,-14811.47 384,-14811.47 654,-14811.47 654,-14811.47 660,-14811.47 666,-14817.47 666,-14823.47 666,-14823.47 666,-14846.47 666,-14846.47 666,-14852.47 660,-14858.47 654,-14858.47"/>
<text text-anchor="middle" x="519" y="-14843.47" font-family="Arial" font-size="10.00">Layer 65 FFN1 GPU7</text>
<text text-anchor="middle" x="519" y="-14832.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="519" y="-14821.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer65_attn_ar&#45;&gt;layer65_ffn1_7 -->
<g id="edge1057" class="edge">
<title>layer65_attn_ar&#45;&gt;layer65_ffn1_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M398.65,-14930.42C424.72,-14909.96 457.22,-14884.45 481.88,-14865.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="484.21,-14867.72 489.92,-14858.79 479.89,-14862.21 484.21,-14867.72"/>
</g>
<!-- layer65_act_6 -->
<g id="node927" class="node">
<title>layer65_act_6</title>
<path fill="#e6f3ff" stroke="black" d="M324,-14739.47C324,-14739.47 54,-14739.47 54,-14739.47 48,-14739.47 42,-14733.47 42,-14727.47 42,-14727.47 42,-14704.47 42,-14704.47 42,-14698.47 48,-14692.47 54,-14692.47 54,-14692.47 324,-14692.47 324,-14692.47 330,-14692.47 336,-14698.47 336,-14704.47 336,-14704.47 336,-14727.47 336,-14727.47 336,-14733.47 330,-14739.47 324,-14739.47"/>
<text text-anchor="middle" x="189" y="-14724.47" font-family="Arial" font-size="10.00">Layer 65 SiLU GPU6</text>
<text text-anchor="middle" x="189" y="-14713.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="189" y="-14702.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer65_ffn1_6&#45;&gt;layer65_act_6 -->
<g id="edge1058" class="edge">
<title>layer65_ffn1_6&#45;&gt;layer65_act_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M189,-14811.41C189,-14793.96 189,-14769.55 189,-14749.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="192.5,-14749.86 189,-14739.86 185.5,-14749.86 192.5,-14749.86"/>
</g>
<!-- layer65_act_7 -->
<g id="node928" class="node">
<title>layer65_act_7</title>
<path fill="#e6f3ff" stroke="black" d="M654,-14739.47C654,-14739.47 384,-14739.47 384,-14739.47 378,-14739.47 372,-14733.47 372,-14727.47 372,-14727.47 372,-14704.47 372,-14704.47 372,-14698.47 378,-14692.47 384,-14692.47 384,-14692.47 654,-14692.47 654,-14692.47 660,-14692.47 666,-14698.47 666,-14704.47 666,-14704.47 666,-14727.47 666,-14727.47 666,-14733.47 660,-14739.47 654,-14739.47"/>
<text text-anchor="middle" x="519" y="-14724.47" font-family="Arial" font-size="10.00">Layer 65 SiLU GPU7</text>
<text text-anchor="middle" x="519" y="-14713.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="519" y="-14702.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer65_ffn1_7&#45;&gt;layer65_act_7 -->
<g id="edge1059" class="edge">
<title>layer65_ffn1_7&#45;&gt;layer65_act_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M519,-14811.41C519,-14793.96 519,-14769.55 519,-14749.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="522.5,-14749.86 519,-14739.86 515.5,-14749.86 522.5,-14749.86"/>
</g>
<!-- layer65_ffn2_6 -->
<g id="node929" class="node">
<title>layer65_ffn2_6</title>
<path fill="#e6f3ff" stroke="black" d="M323.5,-14620.47C323.5,-14620.47 60.5,-14620.47 60.5,-14620.47 54.5,-14620.47 48.5,-14614.47 48.5,-14608.47 48.5,-14608.47 48.5,-14585.47 48.5,-14585.47 48.5,-14579.47 54.5,-14573.47 60.5,-14573.47 60.5,-14573.47 323.5,-14573.47 323.5,-14573.47 329.5,-14573.47 335.5,-14579.47 335.5,-14585.47 335.5,-14585.47 335.5,-14608.47 335.5,-14608.47 335.5,-14614.47 329.5,-14620.47 323.5,-14620.47"/>
<text text-anchor="middle" x="192" y="-14605.47" font-family="Arial" font-size="10.00">Layer 65 FFN2 GPU6</text>
<text text-anchor="middle" x="192" y="-14594.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="192" y="-14583.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer65_act_6&#45;&gt;layer65_ffn2_6 -->
<g id="edge1060" class="edge">
<title>layer65_act_6&#45;&gt;layer65_ffn2_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M189.58,-14692.41C190.03,-14674.96 190.65,-14650.55 191.16,-14630.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="194.66,-14630.94 191.41,-14620.86 187.66,-14630.76 194.66,-14630.94"/>
</g>
<!-- layer65_ffn2_7 -->
<g id="node930" class="node">
<title>layer65_ffn2_7</title>
<path fill="#e6f3ff" stroke="black" d="M648.5,-14620.47C648.5,-14620.47 385.5,-14620.47 385.5,-14620.47 379.5,-14620.47 373.5,-14614.47 373.5,-14608.47 373.5,-14608.47 373.5,-14585.47 373.5,-14585.47 373.5,-14579.47 379.5,-14573.47 385.5,-14573.47 385.5,-14573.47 648.5,-14573.47 648.5,-14573.47 654.5,-14573.47 660.5,-14579.47 660.5,-14585.47 660.5,-14585.47 660.5,-14608.47 660.5,-14608.47 660.5,-14614.47 654.5,-14620.47 648.5,-14620.47"/>
<text text-anchor="middle" x="517" y="-14605.47" font-family="Arial" font-size="10.00">Layer 65 FFN2 GPU7</text>
<text text-anchor="middle" x="517" y="-14594.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="517" y="-14583.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer65_act_7&#45;&gt;layer65_ffn2_7 -->
<g id="edge1061" class="edge">
<title>layer65_act_7&#45;&gt;layer65_ffn2_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M518.61,-14692.41C518.32,-14674.96 517.9,-14650.55 517.56,-14630.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="521.06,-14630.8 517.39,-14620.86 514.06,-14630.92 521.06,-14630.8"/>
</g>
<!-- layer65_ffn_ar -->
<g id="node931" class="node">
<title>layer65_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M485.22,-14501.47C485.22,-14501.47 279.8,-14501.47 279.8,-14501.47 273.8,-14501.47 264,-14496.83 260.19,-14492.19 260.19,-14492.19 216.39,-14438.75 216.39,-14438.75 212.59,-14434.11 214.78,-14429.47 220.78,-14429.47 220.78,-14429.47 426.2,-14429.47 426.2,-14429.47 432.2,-14429.47 442,-14434.11 445.81,-14438.75 445.81,-14438.75 489.61,-14492.19 489.61,-14492.19 493.41,-14496.83 491.22,-14501.47 485.22,-14501.47"/>
<text text-anchor="middle" x="353" y="-14468.47" font-family="Arial" font-size="10.00">Layer 65 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="353" y="-14457.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer65_ffn2_6&#45;&gt;layer65_ffn_ar -->
<g id="edge1062" class="edge">
<title>layer65_ffn2_6&#45;&gt;layer65_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M220.04,-14573.41C242.43,-14555.41 274.4,-14529.69 301.38,-14507.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="303.61,-14510.68 309.21,-14501.69 299.23,-14505.23 303.61,-14510.68"/>
</g>
<!-- layer65_ffn2_7&#45;&gt;layer65_ffn_ar -->
<g id="edge1063" class="edge">
<title>layer65_ffn2_7&#45;&gt;layer65_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M488.43,-14573.41C465.63,-14555.41 433.06,-14529.69 405.58,-14507.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="407.62,-14505.14 397.6,-14501.69 403.28,-14510.63 407.62,-14505.14"/>
</g>
<!-- layer66_qkv_6 -->
<g id="node932" class="node">
<title>layer66_qkv_6</title>
<path fill="#e6f3ff" stroke="black" d="M323,-14357.47C323,-14357.47 25,-14357.47 25,-14357.47 19,-14357.47 13,-14351.47 13,-14345.47 13,-14345.47 13,-14322.47 13,-14322.47 13,-14316.47 19,-14310.47 25,-14310.47 25,-14310.47 323,-14310.47 323,-14310.47 329,-14310.47 335,-14316.47 335,-14322.47 335,-14322.47 335,-14345.47 335,-14345.47 335,-14351.47 329,-14357.47 323,-14357.47"/>
<text text-anchor="middle" x="174" y="-14342.47" font-family="Arial" font-size="10.00">Layer 66 QKV Proj GPU6</text>
<text text-anchor="middle" x="174" y="-14331.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="174" y="-14320.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer65_ffn_ar&#45;&gt;layer66_qkv_6 -->
<g id="edge1064" class="edge">
<title>layer65_ffn_ar&#45;&gt;layer66_qkv_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M304.56,-14429.42C276.06,-14408.81 240.48,-14383.06 213.66,-14363.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="215.43,-14360.62 205.28,-14357.6 211.33,-14366.3 215.43,-14360.62"/>
</g>
<!-- layer66_qkv_7 -->
<g id="node933" class="node">
<title>layer66_qkv_7</title>
<path fill="#e6f3ff" stroke="black" d="M681,-14357.47C681,-14357.47 383,-14357.47 383,-14357.47 377,-14357.47 371,-14351.47 371,-14345.47 371,-14345.47 371,-14322.47 371,-14322.47 371,-14316.47 377,-14310.47 383,-14310.47 383,-14310.47 681,-14310.47 681,-14310.47 687,-14310.47 693,-14316.47 693,-14322.47 693,-14322.47 693,-14345.47 693,-14345.47 693,-14351.47 687,-14357.47 681,-14357.47"/>
<text text-anchor="middle" x="532" y="-14342.47" font-family="Arial" font-size="10.00">Layer 66 QKV Proj GPU7</text>
<text text-anchor="middle" x="532" y="-14331.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="532" y="-14320.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer65_ffn_ar&#45;&gt;layer66_qkv_7 -->
<g id="edge1065" class="edge">
<title>layer65_ffn_ar&#45;&gt;layer66_qkv_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M401.44,-14429.42C429.94,-14408.81 465.52,-14383.06 492.34,-14363.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="494.67,-14366.3 500.72,-14357.6 490.57,-14360.62 494.67,-14366.3"/>
</g>
<!-- layer66_attn_6 -->
<g id="node934" class="node">
<title>layer66_attn_6</title>
<path fill="#e6f3ff" stroke="black" d="M323,-14238.47C323,-14238.47 25,-14238.47 25,-14238.47 19,-14238.47 13,-14232.47 13,-14226.47 13,-14226.47 13,-14203.47 13,-14203.47 13,-14197.47 19,-14191.47 25,-14191.47 25,-14191.47 323,-14191.47 323,-14191.47 329,-14191.47 335,-14197.47 335,-14203.47 335,-14203.47 335,-14226.47 335,-14226.47 335,-14232.47 329,-14238.47 323,-14238.47"/>
<text text-anchor="middle" x="174" y="-14223.47" font-family="Arial" font-size="10.00">Layer 66 Attention GPU6</text>
<text text-anchor="middle" x="174" y="-14212.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="174" y="-14201.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer66_qkv_6&#45;&gt;layer66_attn_6 -->
<g id="edge1066" class="edge">
<title>layer66_qkv_6&#45;&gt;layer66_attn_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M174,-14310.41C174,-14292.96 174,-14268.55 174,-14248.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="177.5,-14248.86 174,-14238.86 170.5,-14248.86 177.5,-14248.86"/>
</g>
<!-- layer66_attn_7 -->
<g id="node935" class="node">
<title>layer66_attn_7</title>
<path fill="#e6f3ff" stroke="black" d="M681,-14238.47C681,-14238.47 383,-14238.47 383,-14238.47 377,-14238.47 371,-14232.47 371,-14226.47 371,-14226.47 371,-14203.47 371,-14203.47 371,-14197.47 377,-14191.47 383,-14191.47 383,-14191.47 681,-14191.47 681,-14191.47 687,-14191.47 693,-14197.47 693,-14203.47 693,-14203.47 693,-14226.47 693,-14226.47 693,-14232.47 687,-14238.47 681,-14238.47"/>
<text text-anchor="middle" x="532" y="-14223.47" font-family="Arial" font-size="10.00">Layer 66 Attention GPU7</text>
<text text-anchor="middle" x="532" y="-14212.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="532" y="-14201.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer66_qkv_7&#45;&gt;layer66_attn_7 -->
<g id="edge1067" class="edge">
<title>layer66_qkv_7&#45;&gt;layer66_attn_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M532,-14310.41C532,-14292.96 532,-14268.55 532,-14248.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="535.5,-14248.86 532,-14238.86 528.5,-14248.86 535.5,-14248.86"/>
</g>
<!-- layer66_attn_out_6 -->
<g id="node936" class="node">
<title>layer66_attn_out_6</title>
<path fill="#e6f3ff" stroke="black" d="M323,-14119.47C323,-14119.47 33,-14119.47 33,-14119.47 27,-14119.47 21,-14113.47 21,-14107.47 21,-14107.47 21,-14084.47 21,-14084.47 21,-14078.47 27,-14072.47 33,-14072.47 33,-14072.47 323,-14072.47 323,-14072.47 329,-14072.47 335,-14078.47 335,-14084.47 335,-14084.47 335,-14107.47 335,-14107.47 335,-14113.47 329,-14119.47 323,-14119.47"/>
<text text-anchor="middle" x="178" y="-14104.47" font-family="Arial" font-size="10.00">Layer 66 Attn Out GPU6</text>
<text text-anchor="middle" x="178" y="-14093.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="178" y="-14082.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer66_attn_6&#45;&gt;layer66_attn_out_6 -->
<g id="edge1068" class="edge">
<title>layer66_attn_6&#45;&gt;layer66_attn_out_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M174.77,-14191.41C175.37,-14173.96 176.2,-14149.55 176.87,-14129.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="180.37,-14129.97 177.22,-14119.86 173.38,-14129.73 180.37,-14129.97"/>
</g>
<!-- layer66_attn_out_7 -->
<g id="node937" class="node">
<title>layer66_attn_out_7</title>
<path fill="#e6f3ff" stroke="black" d="M675,-14119.47C675,-14119.47 385,-14119.47 385,-14119.47 379,-14119.47 373,-14113.47 373,-14107.47 373,-14107.47 373,-14084.47 373,-14084.47 373,-14078.47 379,-14072.47 385,-14072.47 385,-14072.47 675,-14072.47 675,-14072.47 681,-14072.47 687,-14078.47 687,-14084.47 687,-14084.47 687,-14107.47 687,-14107.47 687,-14113.47 681,-14119.47 675,-14119.47"/>
<text text-anchor="middle" x="530" y="-14104.47" font-family="Arial" font-size="10.00">Layer 66 Attn Out GPU7</text>
<text text-anchor="middle" x="530" y="-14093.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="530" y="-14082.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer66_attn_7&#45;&gt;layer66_attn_out_7 -->
<g id="edge1069" class="edge">
<title>layer66_attn_7&#45;&gt;layer66_attn_out_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M531.61,-14191.41C531.32,-14173.96 530.9,-14149.55 530.56,-14129.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="534.06,-14129.8 530.39,-14119.86 527.06,-14129.92 534.06,-14129.8"/>
</g>
<!-- layer66_attn_ar -->
<g id="node938" class="node">
<title>layer66_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M483.07,-14000.47C483.07,-14000.47 281.07,-14000.47 281.07,-14000.47 275.07,-14000.47 265.3,-13995.8 261.53,-13991.13 261.53,-13991.13 218.47,-13937.8 218.47,-13937.8 214.7,-13933.14 216.93,-13928.47 222.93,-13928.47 222.93,-13928.47 424.93,-13928.47 424.93,-13928.47 430.93,-13928.47 440.7,-13933.14 444.47,-13937.8 444.47,-13937.8 487.53,-13991.13 487.53,-13991.13 491.3,-13995.8 489.07,-14000.47 483.07,-14000.47"/>
<text text-anchor="middle" x="353" y="-13967.47" font-family="Arial" font-size="10.00">Layer 66 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="353" y="-13956.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer66_attn_out_6&#45;&gt;layer66_attn_ar -->
<g id="edge1070" class="edge">
<title>layer66_attn_out_6&#45;&gt;layer66_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M208.48,-14072.41C232.92,-14054.33 267.86,-14028.47 297.27,-14006.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="299.45,-14009.45 305.4,-14000.69 295.28,-14003.82 299.45,-14009.45"/>
</g>
<!-- layer66_attn_out_7&#45;&gt;layer66_attn_ar -->
<g id="edge1071" class="edge">
<title>layer66_attn_out_7&#45;&gt;layer66_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M499.17,-14072.41C474.45,-14054.33 439.11,-14028.47 409.37,-14006.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="411.28,-14003.77 401.14,-14000.69 407.14,-14009.42 411.28,-14003.77"/>
</g>
<!-- layer66_ffn1_6 -->
<g id="node939" class="node">
<title>layer66_ffn1_6</title>
<path fill="#e6f3ff" stroke="black" d="M323,-13856.47C323,-13856.47 53,-13856.47 53,-13856.47 47,-13856.47 41,-13850.47 41,-13844.47 41,-13844.47 41,-13821.47 41,-13821.47 41,-13815.47 47,-13809.47 53,-13809.47 53,-13809.47 323,-13809.47 323,-13809.47 329,-13809.47 335,-13815.47 335,-13821.47 335,-13821.47 335,-13844.47 335,-13844.47 335,-13850.47 329,-13856.47 323,-13856.47"/>
<text text-anchor="middle" x="188" y="-13841.47" font-family="Arial" font-size="10.00">Layer 66 FFN1 GPU6</text>
<text text-anchor="middle" x="188" y="-13830.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="188" y="-13819.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer66_attn_ar&#45;&gt;layer66_ffn1_6 -->
<g id="edge1072" class="edge">
<title>layer66_attn_ar&#45;&gt;layer66_ffn1_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M308.35,-13928.42C282.28,-13907.96 249.78,-13882.45 225.12,-13863.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="227.11,-13860.21 217.08,-13856.79 222.79,-13865.72 227.11,-13860.21"/>
</g>
<!-- layer66_ffn1_7 -->
<g id="node940" class="node">
<title>layer66_ffn1_7</title>
<path fill="#e6f3ff" stroke="black" d="M653,-13856.47C653,-13856.47 383,-13856.47 383,-13856.47 377,-13856.47 371,-13850.47 371,-13844.47 371,-13844.47 371,-13821.47 371,-13821.47 371,-13815.47 377,-13809.47 383,-13809.47 383,-13809.47 653,-13809.47 653,-13809.47 659,-13809.47 665,-13815.47 665,-13821.47 665,-13821.47 665,-13844.47 665,-13844.47 665,-13850.47 659,-13856.47 653,-13856.47"/>
<text text-anchor="middle" x="518" y="-13841.47" font-family="Arial" font-size="10.00">Layer 66 FFN1 GPU7</text>
<text text-anchor="middle" x="518" y="-13830.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="518" y="-13819.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer66_attn_ar&#45;&gt;layer66_ffn1_7 -->
<g id="edge1073" class="edge">
<title>layer66_attn_ar&#45;&gt;layer66_ffn1_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M397.65,-13928.42C423.72,-13907.96 456.22,-13882.45 480.88,-13863.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="483.21,-13865.72 488.92,-13856.79 478.89,-13860.21 483.21,-13865.72"/>
</g>
<!-- layer66_act_6 -->
<g id="node941" class="node">
<title>layer66_act_6</title>
<path fill="#e6f3ff" stroke="black" d="M323,-13737.47C323,-13737.47 53,-13737.47 53,-13737.47 47,-13737.47 41,-13731.47 41,-13725.47 41,-13725.47 41,-13702.47 41,-13702.47 41,-13696.47 47,-13690.47 53,-13690.47 53,-13690.47 323,-13690.47 323,-13690.47 329,-13690.47 335,-13696.47 335,-13702.47 335,-13702.47 335,-13725.47 335,-13725.47 335,-13731.47 329,-13737.47 323,-13737.47"/>
<text text-anchor="middle" x="188" y="-13722.47" font-family="Arial" font-size="10.00">Layer 66 SiLU GPU6</text>
<text text-anchor="middle" x="188" y="-13711.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="188" y="-13700.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer66_ffn1_6&#45;&gt;layer66_act_6 -->
<g id="edge1074" class="edge">
<title>layer66_ffn1_6&#45;&gt;layer66_act_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M188,-13809.41C188,-13791.96 188,-13767.55 188,-13747.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="191.5,-13747.86 188,-13737.86 184.5,-13747.86 191.5,-13747.86"/>
</g>
<!-- layer66_act_7 -->
<g id="node942" class="node">
<title>layer66_act_7</title>
<path fill="#e6f3ff" stroke="black" d="M653,-13737.47C653,-13737.47 383,-13737.47 383,-13737.47 377,-13737.47 371,-13731.47 371,-13725.47 371,-13725.47 371,-13702.47 371,-13702.47 371,-13696.47 377,-13690.47 383,-13690.47 383,-13690.47 653,-13690.47 653,-13690.47 659,-13690.47 665,-13696.47 665,-13702.47 665,-13702.47 665,-13725.47 665,-13725.47 665,-13731.47 659,-13737.47 653,-13737.47"/>
<text text-anchor="middle" x="518" y="-13722.47" font-family="Arial" font-size="10.00">Layer 66 SiLU GPU7</text>
<text text-anchor="middle" x="518" y="-13711.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="518" y="-13700.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer66_ffn1_7&#45;&gt;layer66_act_7 -->
<g id="edge1075" class="edge">
<title>layer66_ffn1_7&#45;&gt;layer66_act_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M518,-13809.41C518,-13791.96 518,-13767.55 518,-13747.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="521.5,-13747.86 518,-13737.86 514.5,-13747.86 521.5,-13747.86"/>
</g>
<!-- layer66_ffn2_6 -->
<g id="node943" class="node">
<title>layer66_ffn2_6</title>
<path fill="#e6f3ff" stroke="black" d="M322.5,-13618.47C322.5,-13618.47 59.5,-13618.47 59.5,-13618.47 53.5,-13618.47 47.5,-13612.47 47.5,-13606.47 47.5,-13606.47 47.5,-13583.47 47.5,-13583.47 47.5,-13577.47 53.5,-13571.47 59.5,-13571.47 59.5,-13571.47 322.5,-13571.47 322.5,-13571.47 328.5,-13571.47 334.5,-13577.47 334.5,-13583.47 334.5,-13583.47 334.5,-13606.47 334.5,-13606.47 334.5,-13612.47 328.5,-13618.47 322.5,-13618.47"/>
<text text-anchor="middle" x="191" y="-13603.47" font-family="Arial" font-size="10.00">Layer 66 FFN2 GPU6</text>
<text text-anchor="middle" x="191" y="-13592.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="191" y="-13581.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer66_act_6&#45;&gt;layer66_ffn2_6 -->
<g id="edge1076" class="edge">
<title>layer66_act_6&#45;&gt;layer66_ffn2_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M188.58,-13690.41C189.03,-13672.96 189.65,-13648.55 190.16,-13628.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="193.66,-13628.94 190.41,-13618.86 186.66,-13628.76 193.66,-13628.94"/>
</g>
<!-- layer66_ffn2_7 -->
<g id="node944" class="node">
<title>layer66_ffn2_7</title>
<path fill="#e6f3ff" stroke="black" d="M647.5,-13618.47C647.5,-13618.47 384.5,-13618.47 384.5,-13618.47 378.5,-13618.47 372.5,-13612.47 372.5,-13606.47 372.5,-13606.47 372.5,-13583.47 372.5,-13583.47 372.5,-13577.47 378.5,-13571.47 384.5,-13571.47 384.5,-13571.47 647.5,-13571.47 647.5,-13571.47 653.5,-13571.47 659.5,-13577.47 659.5,-13583.47 659.5,-13583.47 659.5,-13606.47 659.5,-13606.47 659.5,-13612.47 653.5,-13618.47 647.5,-13618.47"/>
<text text-anchor="middle" x="516" y="-13603.47" font-family="Arial" font-size="10.00">Layer 66 FFN2 GPU7</text>
<text text-anchor="middle" x="516" y="-13592.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="516" y="-13581.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer66_act_7&#45;&gt;layer66_ffn2_7 -->
<g id="edge1077" class="edge">
<title>layer66_act_7&#45;&gt;layer66_ffn2_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M517.61,-13690.41C517.32,-13672.96 516.9,-13648.55 516.56,-13628.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="520.06,-13628.8 516.39,-13618.86 513.06,-13628.92 520.06,-13628.8"/>
</g>
<!-- layer66_ffn_ar -->
<g id="node945" class="node">
<title>layer66_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M484.22,-13499.47C484.22,-13499.47 278.8,-13499.47 278.8,-13499.47 272.8,-13499.47 263,-13494.83 259.19,-13490.19 259.19,-13490.19 215.39,-13436.75 215.39,-13436.75 211.59,-13432.11 213.78,-13427.47 219.78,-13427.47 219.78,-13427.47 425.2,-13427.47 425.2,-13427.47 431.2,-13427.47 441,-13432.11 444.81,-13436.75 444.81,-13436.75 488.61,-13490.19 488.61,-13490.19 492.41,-13494.83 490.22,-13499.47 484.22,-13499.47"/>
<text text-anchor="middle" x="352" y="-13466.47" font-family="Arial" font-size="10.00">Layer 66 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="352" y="-13455.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer66_ffn2_6&#45;&gt;layer66_ffn_ar -->
<g id="edge1078" class="edge">
<title>layer66_ffn2_6&#45;&gt;layer66_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M219.04,-13571.41C241.43,-13553.41 273.4,-13527.69 300.38,-13505.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="302.61,-13508.68 308.21,-13499.69 298.23,-13503.23 302.61,-13508.68"/>
</g>
<!-- layer66_ffn2_7&#45;&gt;layer66_ffn_ar -->
<g id="edge1079" class="edge">
<title>layer66_ffn2_7&#45;&gt;layer66_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M487.43,-13571.41C464.63,-13553.41 432.06,-13527.69 404.58,-13505.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="406.62,-13503.14 396.6,-13499.69 402.28,-13508.63 406.62,-13503.14"/>
</g>
<!-- layer67_qkv_6 -->
<g id="node946" class="node">
<title>layer67_qkv_6</title>
<path fill="#e6f3ff" stroke="black" d="M322,-13355.47C322,-13355.47 24,-13355.47 24,-13355.47 18,-13355.47 12,-13349.47 12,-13343.47 12,-13343.47 12,-13320.47 12,-13320.47 12,-13314.47 18,-13308.47 24,-13308.47 24,-13308.47 322,-13308.47 322,-13308.47 328,-13308.47 334,-13314.47 334,-13320.47 334,-13320.47 334,-13343.47 334,-13343.47 334,-13349.47 328,-13355.47 322,-13355.47"/>
<text text-anchor="middle" x="173" y="-13340.47" font-family="Arial" font-size="10.00">Layer 67 QKV Proj GPU6</text>
<text text-anchor="middle" x="173" y="-13329.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="173" y="-13318.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer66_ffn_ar&#45;&gt;layer67_qkv_6 -->
<g id="edge1080" class="edge">
<title>layer66_ffn_ar&#45;&gt;layer67_qkv_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M303.56,-13427.42C275.06,-13406.81 239.48,-13381.06 212.66,-13361.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="214.43,-13358.62 204.28,-13355.6 210.33,-13364.3 214.43,-13358.62"/>
</g>
<!-- layer67_qkv_7 -->
<g id="node947" class="node">
<title>layer67_qkv_7</title>
<path fill="#e6f3ff" stroke="black" d="M680,-13355.47C680,-13355.47 382,-13355.47 382,-13355.47 376,-13355.47 370,-13349.47 370,-13343.47 370,-13343.47 370,-13320.47 370,-13320.47 370,-13314.47 376,-13308.47 382,-13308.47 382,-13308.47 680,-13308.47 680,-13308.47 686,-13308.47 692,-13314.47 692,-13320.47 692,-13320.47 692,-13343.47 692,-13343.47 692,-13349.47 686,-13355.47 680,-13355.47"/>
<text text-anchor="middle" x="531" y="-13340.47" font-family="Arial" font-size="10.00">Layer 67 QKV Proj GPU7</text>
<text text-anchor="middle" x="531" y="-13329.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="531" y="-13318.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer66_ffn_ar&#45;&gt;layer67_qkv_7 -->
<g id="edge1081" class="edge">
<title>layer66_ffn_ar&#45;&gt;layer67_qkv_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M400.44,-13427.42C428.94,-13406.81 464.52,-13381.06 491.34,-13361.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="493.67,-13364.3 499.72,-13355.6 489.57,-13358.62 493.67,-13364.3"/>
</g>
<!-- layer67_attn_6 -->
<g id="node948" class="node">
<title>layer67_attn_6</title>
<path fill="#e6f3ff" stroke="black" d="M322,-13236.47C322,-13236.47 24,-13236.47 24,-13236.47 18,-13236.47 12,-13230.47 12,-13224.47 12,-13224.47 12,-13201.47 12,-13201.47 12,-13195.47 18,-13189.47 24,-13189.47 24,-13189.47 322,-13189.47 322,-13189.47 328,-13189.47 334,-13195.47 334,-13201.47 334,-13201.47 334,-13224.47 334,-13224.47 334,-13230.47 328,-13236.47 322,-13236.47"/>
<text text-anchor="middle" x="173" y="-13221.47" font-family="Arial" font-size="10.00">Layer 67 Attention GPU6</text>
<text text-anchor="middle" x="173" y="-13210.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="173" y="-13199.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer67_qkv_6&#45;&gt;layer67_attn_6 -->
<g id="edge1082" class="edge">
<title>layer67_qkv_6&#45;&gt;layer67_attn_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M173,-13308.41C173,-13290.96 173,-13266.55 173,-13246.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="176.5,-13246.86 173,-13236.86 169.5,-13246.86 176.5,-13246.86"/>
</g>
<!-- layer67_attn_7 -->
<g id="node949" class="node">
<title>layer67_attn_7</title>
<path fill="#e6f3ff" stroke="black" d="M680,-13236.47C680,-13236.47 382,-13236.47 382,-13236.47 376,-13236.47 370,-13230.47 370,-13224.47 370,-13224.47 370,-13201.47 370,-13201.47 370,-13195.47 376,-13189.47 382,-13189.47 382,-13189.47 680,-13189.47 680,-13189.47 686,-13189.47 692,-13195.47 692,-13201.47 692,-13201.47 692,-13224.47 692,-13224.47 692,-13230.47 686,-13236.47 680,-13236.47"/>
<text text-anchor="middle" x="531" y="-13221.47" font-family="Arial" font-size="10.00">Layer 67 Attention GPU7</text>
<text text-anchor="middle" x="531" y="-13210.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="531" y="-13199.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer67_qkv_7&#45;&gt;layer67_attn_7 -->
<g id="edge1083" class="edge">
<title>layer67_qkv_7&#45;&gt;layer67_attn_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M531,-13308.41C531,-13290.96 531,-13266.55 531,-13246.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="534.5,-13246.86 531,-13236.86 527.5,-13246.86 534.5,-13246.86"/>
</g>
<!-- layer67_attn_out_6 -->
<g id="node950" class="node">
<title>layer67_attn_out_6</title>
<path fill="#e6f3ff" stroke="black" d="M322,-13117.47C322,-13117.47 32,-13117.47 32,-13117.47 26,-13117.47 20,-13111.47 20,-13105.47 20,-13105.47 20,-13082.47 20,-13082.47 20,-13076.47 26,-13070.47 32,-13070.47 32,-13070.47 322,-13070.47 322,-13070.47 328,-13070.47 334,-13076.47 334,-13082.47 334,-13082.47 334,-13105.47 334,-13105.47 334,-13111.47 328,-13117.47 322,-13117.47"/>
<text text-anchor="middle" x="177" y="-13102.47" font-family="Arial" font-size="10.00">Layer 67 Attn Out GPU6</text>
<text text-anchor="middle" x="177" y="-13091.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="177" y="-13080.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer67_attn_6&#45;&gt;layer67_attn_out_6 -->
<g id="edge1084" class="edge">
<title>layer67_attn_6&#45;&gt;layer67_attn_out_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M173.77,-13189.41C174.37,-13171.96 175.2,-13147.55 175.87,-13127.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="179.37,-13127.97 176.22,-13117.86 172.38,-13127.73 179.37,-13127.97"/>
</g>
<!-- layer67_attn_out_7 -->
<g id="node951" class="node">
<title>layer67_attn_out_7</title>
<path fill="#e6f3ff" stroke="black" d="M674,-13117.47C674,-13117.47 384,-13117.47 384,-13117.47 378,-13117.47 372,-13111.47 372,-13105.47 372,-13105.47 372,-13082.47 372,-13082.47 372,-13076.47 378,-13070.47 384,-13070.47 384,-13070.47 674,-13070.47 674,-13070.47 680,-13070.47 686,-13076.47 686,-13082.47 686,-13082.47 686,-13105.47 686,-13105.47 686,-13111.47 680,-13117.47 674,-13117.47"/>
<text text-anchor="middle" x="529" y="-13102.47" font-family="Arial" font-size="10.00">Layer 67 Attn Out GPU7</text>
<text text-anchor="middle" x="529" y="-13091.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="529" y="-13080.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer67_attn_7&#45;&gt;layer67_attn_out_7 -->
<g id="edge1085" class="edge">
<title>layer67_attn_7&#45;&gt;layer67_attn_out_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M530.61,-13189.41C530.32,-13171.96 529.9,-13147.55 529.56,-13127.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="533.06,-13127.8 529.39,-13117.86 526.06,-13127.92 533.06,-13127.8"/>
</g>
<!-- layer67_attn_ar -->
<g id="node952" class="node">
<title>layer67_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M482.07,-12998.47C482.07,-12998.47 280.07,-12998.47 280.07,-12998.47 274.07,-12998.47 264.3,-12993.8 260.53,-12989.13 260.53,-12989.13 217.47,-12935.8 217.47,-12935.8 213.7,-12931.14 215.93,-12926.47 221.93,-12926.47 221.93,-12926.47 423.93,-12926.47 423.93,-12926.47 429.93,-12926.47 439.7,-12931.14 443.47,-12935.8 443.47,-12935.8 486.53,-12989.13 486.53,-12989.13 490.3,-12993.8 488.07,-12998.47 482.07,-12998.47"/>
<text text-anchor="middle" x="352" y="-12965.47" font-family="Arial" font-size="10.00">Layer 67 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="352" y="-12954.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer67_attn_out_6&#45;&gt;layer67_attn_ar -->
<g id="edge1086" class="edge">
<title>layer67_attn_out_6&#45;&gt;layer67_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M207.48,-13070.41C231.92,-13052.33 266.86,-13026.47 296.27,-13004.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="298.45,-13007.45 304.4,-12998.69 294.28,-13001.82 298.45,-13007.45"/>
</g>
<!-- layer67_attn_out_7&#45;&gt;layer67_attn_ar -->
<g id="edge1087" class="edge">
<title>layer67_attn_out_7&#45;&gt;layer67_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M498.17,-13070.41C473.45,-13052.33 438.11,-13026.47 408.37,-13004.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="410.28,-13001.77 400.14,-12998.69 406.14,-13007.42 410.28,-13001.77"/>
</g>
<!-- layer67_ffn1_6 -->
<g id="node953" class="node">
<title>layer67_ffn1_6</title>
<path fill="#e6f3ff" stroke="black" d="M322,-12854.47C322,-12854.47 52,-12854.47 52,-12854.47 46,-12854.47 40,-12848.47 40,-12842.47 40,-12842.47 40,-12819.47 40,-12819.47 40,-12813.47 46,-12807.47 52,-12807.47 52,-12807.47 322,-12807.47 322,-12807.47 328,-12807.47 334,-12813.47 334,-12819.47 334,-12819.47 334,-12842.47 334,-12842.47 334,-12848.47 328,-12854.47 322,-12854.47"/>
<text text-anchor="middle" x="187" y="-12839.47" font-family="Arial" font-size="10.00">Layer 67 FFN1 GPU6</text>
<text text-anchor="middle" x="187" y="-12828.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="187" y="-12817.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer67_attn_ar&#45;&gt;layer67_ffn1_6 -->
<g id="edge1088" class="edge">
<title>layer67_attn_ar&#45;&gt;layer67_ffn1_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M307.35,-12926.42C281.28,-12905.96 248.78,-12880.45 224.12,-12861.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="226.11,-12858.21 216.08,-12854.79 221.79,-12863.72 226.11,-12858.21"/>
</g>
<!-- layer67_ffn1_7 -->
<g id="node954" class="node">
<title>layer67_ffn1_7</title>
<path fill="#e6f3ff" stroke="black" d="M652,-12854.47C652,-12854.47 382,-12854.47 382,-12854.47 376,-12854.47 370,-12848.47 370,-12842.47 370,-12842.47 370,-12819.47 370,-12819.47 370,-12813.47 376,-12807.47 382,-12807.47 382,-12807.47 652,-12807.47 652,-12807.47 658,-12807.47 664,-12813.47 664,-12819.47 664,-12819.47 664,-12842.47 664,-12842.47 664,-12848.47 658,-12854.47 652,-12854.47"/>
<text text-anchor="middle" x="517" y="-12839.47" font-family="Arial" font-size="10.00">Layer 67 FFN1 GPU7</text>
<text text-anchor="middle" x="517" y="-12828.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="517" y="-12817.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer67_attn_ar&#45;&gt;layer67_ffn1_7 -->
<g id="edge1089" class="edge">
<title>layer67_attn_ar&#45;&gt;layer67_ffn1_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M396.65,-12926.42C422.72,-12905.96 455.22,-12880.45 479.88,-12861.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="482.21,-12863.72 487.92,-12854.79 477.89,-12858.21 482.21,-12863.72"/>
</g>
<!-- layer67_act_6 -->
<g id="node955" class="node">
<title>layer67_act_6</title>
<path fill="#e6f3ff" stroke="black" d="M322,-12735.47C322,-12735.47 52,-12735.47 52,-12735.47 46,-12735.47 40,-12729.47 40,-12723.47 40,-12723.47 40,-12700.47 40,-12700.47 40,-12694.47 46,-12688.47 52,-12688.47 52,-12688.47 322,-12688.47 322,-12688.47 328,-12688.47 334,-12694.47 334,-12700.47 334,-12700.47 334,-12723.47 334,-12723.47 334,-12729.47 328,-12735.47 322,-12735.47"/>
<text text-anchor="middle" x="187" y="-12720.47" font-family="Arial" font-size="10.00">Layer 67 SiLU GPU6</text>
<text text-anchor="middle" x="187" y="-12709.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="187" y="-12698.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer67_ffn1_6&#45;&gt;layer67_act_6 -->
<g id="edge1090" class="edge">
<title>layer67_ffn1_6&#45;&gt;layer67_act_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M187,-12807.41C187,-12789.96 187,-12765.55 187,-12745.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="190.5,-12745.86 187,-12735.86 183.5,-12745.86 190.5,-12745.86"/>
</g>
<!-- layer67_act_7 -->
<g id="node956" class="node">
<title>layer67_act_7</title>
<path fill="#e6f3ff" stroke="black" d="M652,-12735.47C652,-12735.47 382,-12735.47 382,-12735.47 376,-12735.47 370,-12729.47 370,-12723.47 370,-12723.47 370,-12700.47 370,-12700.47 370,-12694.47 376,-12688.47 382,-12688.47 382,-12688.47 652,-12688.47 652,-12688.47 658,-12688.47 664,-12694.47 664,-12700.47 664,-12700.47 664,-12723.47 664,-12723.47 664,-12729.47 658,-12735.47 652,-12735.47"/>
<text text-anchor="middle" x="517" y="-12720.47" font-family="Arial" font-size="10.00">Layer 67 SiLU GPU7</text>
<text text-anchor="middle" x="517" y="-12709.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="517" y="-12698.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer67_ffn1_7&#45;&gt;layer67_act_7 -->
<g id="edge1091" class="edge">
<title>layer67_ffn1_7&#45;&gt;layer67_act_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M517,-12807.41C517,-12789.96 517,-12765.55 517,-12745.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="520.5,-12745.86 517,-12735.86 513.5,-12745.86 520.5,-12745.86"/>
</g>
<!-- layer67_ffn2_6 -->
<g id="node957" class="node">
<title>layer67_ffn2_6</title>
<path fill="#e6f3ff" stroke="black" d="M321.5,-12616.47C321.5,-12616.47 58.5,-12616.47 58.5,-12616.47 52.5,-12616.47 46.5,-12610.47 46.5,-12604.47 46.5,-12604.47 46.5,-12581.47 46.5,-12581.47 46.5,-12575.47 52.5,-12569.47 58.5,-12569.47 58.5,-12569.47 321.5,-12569.47 321.5,-12569.47 327.5,-12569.47 333.5,-12575.47 333.5,-12581.47 333.5,-12581.47 333.5,-12604.47 333.5,-12604.47 333.5,-12610.47 327.5,-12616.47 321.5,-12616.47"/>
<text text-anchor="middle" x="190" y="-12601.47" font-family="Arial" font-size="10.00">Layer 67 FFN2 GPU6</text>
<text text-anchor="middle" x="190" y="-12590.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="190" y="-12579.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer67_act_6&#45;&gt;layer67_ffn2_6 -->
<g id="edge1092" class="edge">
<title>layer67_act_6&#45;&gt;layer67_ffn2_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M187.58,-12688.41C188.03,-12670.96 188.65,-12646.55 189.16,-12626.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="192.66,-12626.94 189.41,-12616.86 185.66,-12626.76 192.66,-12626.94"/>
</g>
<!-- layer67_ffn2_7 -->
<g id="node958" class="node">
<title>layer67_ffn2_7</title>
<path fill="#e6f3ff" stroke="black" d="M646.5,-12616.47C646.5,-12616.47 383.5,-12616.47 383.5,-12616.47 377.5,-12616.47 371.5,-12610.47 371.5,-12604.47 371.5,-12604.47 371.5,-12581.47 371.5,-12581.47 371.5,-12575.47 377.5,-12569.47 383.5,-12569.47 383.5,-12569.47 646.5,-12569.47 646.5,-12569.47 652.5,-12569.47 658.5,-12575.47 658.5,-12581.47 658.5,-12581.47 658.5,-12604.47 658.5,-12604.47 658.5,-12610.47 652.5,-12616.47 646.5,-12616.47"/>
<text text-anchor="middle" x="515" y="-12601.47" font-family="Arial" font-size="10.00">Layer 67 FFN2 GPU7</text>
<text text-anchor="middle" x="515" y="-12590.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="515" y="-12579.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer67_act_7&#45;&gt;layer67_ffn2_7 -->
<g id="edge1093" class="edge">
<title>layer67_act_7&#45;&gt;layer67_ffn2_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M516.61,-12688.41C516.32,-12670.96 515.9,-12646.55 515.56,-12626.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="519.06,-12626.8 515.39,-12616.86 512.06,-12626.92 519.06,-12626.8"/>
</g>
<!-- layer67_ffn_ar -->
<g id="node959" class="node">
<title>layer67_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M483.22,-12497.47C483.22,-12497.47 277.8,-12497.47 277.8,-12497.47 271.8,-12497.47 262,-12492.83 258.19,-12488.19 258.19,-12488.19 214.39,-12434.75 214.39,-12434.75 210.59,-12430.11 212.78,-12425.47 218.78,-12425.47 218.78,-12425.47 424.2,-12425.47 424.2,-12425.47 430.2,-12425.47 440,-12430.11 443.81,-12434.75 443.81,-12434.75 487.61,-12488.19 487.61,-12488.19 491.41,-12492.83 489.22,-12497.47 483.22,-12497.47"/>
<text text-anchor="middle" x="351" y="-12464.47" font-family="Arial" font-size="10.00">Layer 67 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="351" y="-12453.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer67_ffn2_6&#45;&gt;layer67_ffn_ar -->
<g id="edge1094" class="edge">
<title>layer67_ffn2_6&#45;&gt;layer67_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M218.04,-12569.41C240.43,-12551.41 272.4,-12525.69 299.38,-12503.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="301.61,-12506.68 307.21,-12497.69 297.23,-12501.23 301.61,-12506.68"/>
</g>
<!-- layer67_ffn2_7&#45;&gt;layer67_ffn_ar -->
<g id="edge1095" class="edge">
<title>layer67_ffn2_7&#45;&gt;layer67_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M486.43,-12569.41C463.63,-12551.41 431.06,-12525.69 403.58,-12503.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="405.62,-12501.14 395.6,-12497.69 401.28,-12506.63 405.62,-12501.14"/>
</g>
<!-- layer68_qkv_6 -->
<g id="node960" class="node">
<title>layer68_qkv_6</title>
<path fill="#e6f3ff" stroke="black" d="M321,-12353.47C321,-12353.47 23,-12353.47 23,-12353.47 17,-12353.47 11,-12347.47 11,-12341.47 11,-12341.47 11,-12318.47 11,-12318.47 11,-12312.47 17,-12306.47 23,-12306.47 23,-12306.47 321,-12306.47 321,-12306.47 327,-12306.47 333,-12312.47 333,-12318.47 333,-12318.47 333,-12341.47 333,-12341.47 333,-12347.47 327,-12353.47 321,-12353.47"/>
<text text-anchor="middle" x="172" y="-12338.47" font-family="Arial" font-size="10.00">Layer 68 QKV Proj GPU6</text>
<text text-anchor="middle" x="172" y="-12327.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="172" y="-12316.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer67_ffn_ar&#45;&gt;layer68_qkv_6 -->
<g id="edge1096" class="edge">
<title>layer67_ffn_ar&#45;&gt;layer68_qkv_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M302.56,-12425.42C274.06,-12404.81 238.48,-12379.06 211.66,-12359.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="213.43,-12356.62 203.28,-12353.6 209.33,-12362.3 213.43,-12356.62"/>
</g>
<!-- layer68_qkv_7 -->
<g id="node961" class="node">
<title>layer68_qkv_7</title>
<path fill="#e6f3ff" stroke="black" d="M679,-12353.47C679,-12353.47 381,-12353.47 381,-12353.47 375,-12353.47 369,-12347.47 369,-12341.47 369,-12341.47 369,-12318.47 369,-12318.47 369,-12312.47 375,-12306.47 381,-12306.47 381,-12306.47 679,-12306.47 679,-12306.47 685,-12306.47 691,-12312.47 691,-12318.47 691,-12318.47 691,-12341.47 691,-12341.47 691,-12347.47 685,-12353.47 679,-12353.47"/>
<text text-anchor="middle" x="530" y="-12338.47" font-family="Arial" font-size="10.00">Layer 68 QKV Proj GPU7</text>
<text text-anchor="middle" x="530" y="-12327.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="530" y="-12316.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer67_ffn_ar&#45;&gt;layer68_qkv_7 -->
<g id="edge1097" class="edge">
<title>layer67_ffn_ar&#45;&gt;layer68_qkv_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M399.44,-12425.42C427.94,-12404.81 463.52,-12379.06 490.34,-12359.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="492.67,-12362.3 498.72,-12353.6 488.57,-12356.62 492.67,-12362.3"/>
</g>
<!-- layer68_attn_6 -->
<g id="node962" class="node">
<title>layer68_attn_6</title>
<path fill="#e6f3ff" stroke="black" d="M321,-12234.47C321,-12234.47 23,-12234.47 23,-12234.47 17,-12234.47 11,-12228.47 11,-12222.47 11,-12222.47 11,-12199.47 11,-12199.47 11,-12193.47 17,-12187.47 23,-12187.47 23,-12187.47 321,-12187.47 321,-12187.47 327,-12187.47 333,-12193.47 333,-12199.47 333,-12199.47 333,-12222.47 333,-12222.47 333,-12228.47 327,-12234.47 321,-12234.47"/>
<text text-anchor="middle" x="172" y="-12219.47" font-family="Arial" font-size="10.00">Layer 68 Attention GPU6</text>
<text text-anchor="middle" x="172" y="-12208.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="172" y="-12197.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer68_qkv_6&#45;&gt;layer68_attn_6 -->
<g id="edge1098" class="edge">
<title>layer68_qkv_6&#45;&gt;layer68_attn_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M172,-12306.41C172,-12288.96 172,-12264.55 172,-12244.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="175.5,-12244.86 172,-12234.86 168.5,-12244.86 175.5,-12244.86"/>
</g>
<!-- layer68_attn_7 -->
<g id="node963" class="node">
<title>layer68_attn_7</title>
<path fill="#e6f3ff" stroke="black" d="M679,-12234.47C679,-12234.47 381,-12234.47 381,-12234.47 375,-12234.47 369,-12228.47 369,-12222.47 369,-12222.47 369,-12199.47 369,-12199.47 369,-12193.47 375,-12187.47 381,-12187.47 381,-12187.47 679,-12187.47 679,-12187.47 685,-12187.47 691,-12193.47 691,-12199.47 691,-12199.47 691,-12222.47 691,-12222.47 691,-12228.47 685,-12234.47 679,-12234.47"/>
<text text-anchor="middle" x="530" y="-12219.47" font-family="Arial" font-size="10.00">Layer 68 Attention GPU7</text>
<text text-anchor="middle" x="530" y="-12208.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="530" y="-12197.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer68_qkv_7&#45;&gt;layer68_attn_7 -->
<g id="edge1099" class="edge">
<title>layer68_qkv_7&#45;&gt;layer68_attn_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M530,-12306.41C530,-12288.96 530,-12264.55 530,-12244.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="533.5,-12244.86 530,-12234.86 526.5,-12244.86 533.5,-12244.86"/>
</g>
<!-- layer68_attn_out_6 -->
<g id="node964" class="node">
<title>layer68_attn_out_6</title>
<path fill="#e6f3ff" stroke="black" d="M321,-12115.47C321,-12115.47 31,-12115.47 31,-12115.47 25,-12115.47 19,-12109.47 19,-12103.47 19,-12103.47 19,-12080.47 19,-12080.47 19,-12074.47 25,-12068.47 31,-12068.47 31,-12068.47 321,-12068.47 321,-12068.47 327,-12068.47 333,-12074.47 333,-12080.47 333,-12080.47 333,-12103.47 333,-12103.47 333,-12109.47 327,-12115.47 321,-12115.47"/>
<text text-anchor="middle" x="176" y="-12100.47" font-family="Arial" font-size="10.00">Layer 68 Attn Out GPU6</text>
<text text-anchor="middle" x="176" y="-12089.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="176" y="-12078.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer68_attn_6&#45;&gt;layer68_attn_out_6 -->
<g id="edge1100" class="edge">
<title>layer68_attn_6&#45;&gt;layer68_attn_out_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M172.77,-12187.41C173.37,-12169.96 174.2,-12145.55 174.87,-12125.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="178.37,-12125.97 175.22,-12115.86 171.38,-12125.73 178.37,-12125.97"/>
</g>
<!-- layer68_attn_out_7 -->
<g id="node965" class="node">
<title>layer68_attn_out_7</title>
<path fill="#e6f3ff" stroke="black" d="M673,-12115.47C673,-12115.47 383,-12115.47 383,-12115.47 377,-12115.47 371,-12109.47 371,-12103.47 371,-12103.47 371,-12080.47 371,-12080.47 371,-12074.47 377,-12068.47 383,-12068.47 383,-12068.47 673,-12068.47 673,-12068.47 679,-12068.47 685,-12074.47 685,-12080.47 685,-12080.47 685,-12103.47 685,-12103.47 685,-12109.47 679,-12115.47 673,-12115.47"/>
<text text-anchor="middle" x="528" y="-12100.47" font-family="Arial" font-size="10.00">Layer 68 Attn Out GPU7</text>
<text text-anchor="middle" x="528" y="-12089.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="528" y="-12078.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer68_attn_7&#45;&gt;layer68_attn_out_7 -->
<g id="edge1101" class="edge">
<title>layer68_attn_7&#45;&gt;layer68_attn_out_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M529.61,-12187.41C529.32,-12169.96 528.9,-12145.55 528.56,-12125.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="532.06,-12125.8 528.39,-12115.86 525.06,-12125.92 532.06,-12125.8"/>
</g>
<!-- layer68_attn_ar -->
<g id="node966" class="node">
<title>layer68_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M481.07,-11996.47C481.07,-11996.47 279.07,-11996.47 279.07,-11996.47 273.07,-11996.47 263.3,-11991.8 259.53,-11987.13 259.53,-11987.13 216.47,-11933.8 216.47,-11933.8 212.7,-11929.14 214.93,-11924.47 220.93,-11924.47 220.93,-11924.47 422.93,-11924.47 422.93,-11924.47 428.93,-11924.47 438.7,-11929.14 442.47,-11933.8 442.47,-11933.8 485.53,-11987.13 485.53,-11987.13 489.3,-11991.8 487.07,-11996.47 481.07,-11996.47"/>
<text text-anchor="middle" x="351" y="-11963.47" font-family="Arial" font-size="10.00">Layer 68 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="351" y="-11952.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer68_attn_out_6&#45;&gt;layer68_attn_ar -->
<g id="edge1102" class="edge">
<title>layer68_attn_out_6&#45;&gt;layer68_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M206.48,-12068.41C230.92,-12050.33 265.86,-12024.47 295.27,-12002.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="297.45,-12005.45 303.4,-11996.69 293.28,-11999.82 297.45,-12005.45"/>
</g>
<!-- layer68_attn_out_7&#45;&gt;layer68_attn_ar -->
<g id="edge1103" class="edge">
<title>layer68_attn_out_7&#45;&gt;layer68_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M497.17,-12068.41C472.45,-12050.33 437.11,-12024.47 407.37,-12002.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="409.28,-11999.77 399.14,-11996.69 405.14,-12005.42 409.28,-11999.77"/>
</g>
<!-- layer68_ffn1_6 -->
<g id="node967" class="node">
<title>layer68_ffn1_6</title>
<path fill="#e6f3ff" stroke="black" d="M321,-11852.47C321,-11852.47 51,-11852.47 51,-11852.47 45,-11852.47 39,-11846.47 39,-11840.47 39,-11840.47 39,-11817.47 39,-11817.47 39,-11811.47 45,-11805.47 51,-11805.47 51,-11805.47 321,-11805.47 321,-11805.47 327,-11805.47 333,-11811.47 333,-11817.47 333,-11817.47 333,-11840.47 333,-11840.47 333,-11846.47 327,-11852.47 321,-11852.47"/>
<text text-anchor="middle" x="186" y="-11837.47" font-family="Arial" font-size="10.00">Layer 68 FFN1 GPU6</text>
<text text-anchor="middle" x="186" y="-11826.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="186" y="-11815.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer68_attn_ar&#45;&gt;layer68_ffn1_6 -->
<g id="edge1104" class="edge">
<title>layer68_attn_ar&#45;&gt;layer68_ffn1_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M306.35,-11924.42C280.28,-11903.96 247.78,-11878.45 223.12,-11859.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="225.11,-11856.21 215.08,-11852.79 220.79,-11861.72 225.11,-11856.21"/>
</g>
<!-- layer68_ffn1_7 -->
<g id="node968" class="node">
<title>layer68_ffn1_7</title>
<path fill="#e6f3ff" stroke="black" d="M651,-11852.47C651,-11852.47 381,-11852.47 381,-11852.47 375,-11852.47 369,-11846.47 369,-11840.47 369,-11840.47 369,-11817.47 369,-11817.47 369,-11811.47 375,-11805.47 381,-11805.47 381,-11805.47 651,-11805.47 651,-11805.47 657,-11805.47 663,-11811.47 663,-11817.47 663,-11817.47 663,-11840.47 663,-11840.47 663,-11846.47 657,-11852.47 651,-11852.47"/>
<text text-anchor="middle" x="516" y="-11837.47" font-family="Arial" font-size="10.00">Layer 68 FFN1 GPU7</text>
<text text-anchor="middle" x="516" y="-11826.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="516" y="-11815.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer68_attn_ar&#45;&gt;layer68_ffn1_7 -->
<g id="edge1105" class="edge">
<title>layer68_attn_ar&#45;&gt;layer68_ffn1_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M395.65,-11924.42C421.72,-11903.96 454.22,-11878.45 478.88,-11859.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="481.21,-11861.72 486.92,-11852.79 476.89,-11856.21 481.21,-11861.72"/>
</g>
<!-- layer68_act_6 -->
<g id="node969" class="node">
<title>layer68_act_6</title>
<path fill="#e6f3ff" stroke="black" d="M321,-11733.47C321,-11733.47 51,-11733.47 51,-11733.47 45,-11733.47 39,-11727.47 39,-11721.47 39,-11721.47 39,-11698.47 39,-11698.47 39,-11692.47 45,-11686.47 51,-11686.47 51,-11686.47 321,-11686.47 321,-11686.47 327,-11686.47 333,-11692.47 333,-11698.47 333,-11698.47 333,-11721.47 333,-11721.47 333,-11727.47 327,-11733.47 321,-11733.47"/>
<text text-anchor="middle" x="186" y="-11718.47" font-family="Arial" font-size="10.00">Layer 68 SiLU GPU6</text>
<text text-anchor="middle" x="186" y="-11707.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="186" y="-11696.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer68_ffn1_6&#45;&gt;layer68_act_6 -->
<g id="edge1106" class="edge">
<title>layer68_ffn1_6&#45;&gt;layer68_act_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M186,-11805.41C186,-11787.96 186,-11763.55 186,-11743.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="189.5,-11743.86 186,-11733.86 182.5,-11743.86 189.5,-11743.86"/>
</g>
<!-- layer68_act_7 -->
<g id="node970" class="node">
<title>layer68_act_7</title>
<path fill="#e6f3ff" stroke="black" d="M651,-11733.47C651,-11733.47 381,-11733.47 381,-11733.47 375,-11733.47 369,-11727.47 369,-11721.47 369,-11721.47 369,-11698.47 369,-11698.47 369,-11692.47 375,-11686.47 381,-11686.47 381,-11686.47 651,-11686.47 651,-11686.47 657,-11686.47 663,-11692.47 663,-11698.47 663,-11698.47 663,-11721.47 663,-11721.47 663,-11727.47 657,-11733.47 651,-11733.47"/>
<text text-anchor="middle" x="516" y="-11718.47" font-family="Arial" font-size="10.00">Layer 68 SiLU GPU7</text>
<text text-anchor="middle" x="516" y="-11707.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="516" y="-11696.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer68_ffn1_7&#45;&gt;layer68_act_7 -->
<g id="edge1107" class="edge">
<title>layer68_ffn1_7&#45;&gt;layer68_act_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M516,-11805.41C516,-11787.96 516,-11763.55 516,-11743.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="519.5,-11743.86 516,-11733.86 512.5,-11743.86 519.5,-11743.86"/>
</g>
<!-- layer68_ffn2_6 -->
<g id="node971" class="node">
<title>layer68_ffn2_6</title>
<path fill="#e6f3ff" stroke="black" d="M320.5,-11614.47C320.5,-11614.47 57.5,-11614.47 57.5,-11614.47 51.5,-11614.47 45.5,-11608.47 45.5,-11602.47 45.5,-11602.47 45.5,-11579.47 45.5,-11579.47 45.5,-11573.47 51.5,-11567.47 57.5,-11567.47 57.5,-11567.47 320.5,-11567.47 320.5,-11567.47 326.5,-11567.47 332.5,-11573.47 332.5,-11579.47 332.5,-11579.47 332.5,-11602.47 332.5,-11602.47 332.5,-11608.47 326.5,-11614.47 320.5,-11614.47"/>
<text text-anchor="middle" x="189" y="-11599.47" font-family="Arial" font-size="10.00">Layer 68 FFN2 GPU6</text>
<text text-anchor="middle" x="189" y="-11588.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="189" y="-11577.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer68_act_6&#45;&gt;layer68_ffn2_6 -->
<g id="edge1108" class="edge">
<title>layer68_act_6&#45;&gt;layer68_ffn2_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M186.58,-11686.41C187.03,-11668.96 187.65,-11644.55 188.16,-11624.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="191.66,-11624.94 188.41,-11614.86 184.66,-11624.76 191.66,-11624.94"/>
</g>
<!-- layer68_ffn2_7 -->
<g id="node972" class="node">
<title>layer68_ffn2_7</title>
<path fill="#e6f3ff" stroke="black" d="M645.5,-11614.47C645.5,-11614.47 382.5,-11614.47 382.5,-11614.47 376.5,-11614.47 370.5,-11608.47 370.5,-11602.47 370.5,-11602.47 370.5,-11579.47 370.5,-11579.47 370.5,-11573.47 376.5,-11567.47 382.5,-11567.47 382.5,-11567.47 645.5,-11567.47 645.5,-11567.47 651.5,-11567.47 657.5,-11573.47 657.5,-11579.47 657.5,-11579.47 657.5,-11602.47 657.5,-11602.47 657.5,-11608.47 651.5,-11614.47 645.5,-11614.47"/>
<text text-anchor="middle" x="514" y="-11599.47" font-family="Arial" font-size="10.00">Layer 68 FFN2 GPU7</text>
<text text-anchor="middle" x="514" y="-11588.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="514" y="-11577.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer68_act_7&#45;&gt;layer68_ffn2_7 -->
<g id="edge1109" class="edge">
<title>layer68_act_7&#45;&gt;layer68_ffn2_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M515.61,-11686.41C515.32,-11668.96 514.9,-11644.55 514.56,-11624.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="518.06,-11624.8 514.39,-11614.86 511.06,-11624.92 518.06,-11624.8"/>
</g>
<!-- layer68_ffn_ar -->
<g id="node973" class="node">
<title>layer68_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M482.22,-11495.47C482.22,-11495.47 276.8,-11495.47 276.8,-11495.47 270.8,-11495.47 261,-11490.83 257.19,-11486.19 257.19,-11486.19 213.39,-11432.75 213.39,-11432.75 209.59,-11428.11 211.78,-11423.47 217.78,-11423.47 217.78,-11423.47 423.2,-11423.47 423.2,-11423.47 429.2,-11423.47 439,-11428.11 442.81,-11432.75 442.81,-11432.75 486.61,-11486.19 486.61,-11486.19 490.41,-11490.83 488.22,-11495.47 482.22,-11495.47"/>
<text text-anchor="middle" x="350" y="-11462.47" font-family="Arial" font-size="10.00">Layer 68 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="350" y="-11451.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer68_ffn2_6&#45;&gt;layer68_ffn_ar -->
<g id="edge1110" class="edge">
<title>layer68_ffn2_6&#45;&gt;layer68_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M217.04,-11567.41C239.43,-11549.41 271.4,-11523.69 298.38,-11501.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="300.61,-11504.68 306.21,-11495.69 296.23,-11499.23 300.61,-11504.68"/>
</g>
<!-- layer68_ffn2_7&#45;&gt;layer68_ffn_ar -->
<g id="edge1111" class="edge">
<title>layer68_ffn2_7&#45;&gt;layer68_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M485.43,-11567.41C462.63,-11549.41 430.06,-11523.69 402.58,-11501.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="404.62,-11499.14 394.6,-11495.69 400.28,-11504.63 404.62,-11499.14"/>
</g>
<!-- layer69_qkv_6 -->
<g id="node974" class="node">
<title>layer69_qkv_6</title>
<path fill="#e6f3ff" stroke="black" d="M320,-11351.47C320,-11351.47 22,-11351.47 22,-11351.47 16,-11351.47 10,-11345.47 10,-11339.47 10,-11339.47 10,-11316.47 10,-11316.47 10,-11310.47 16,-11304.47 22,-11304.47 22,-11304.47 320,-11304.47 320,-11304.47 326,-11304.47 332,-11310.47 332,-11316.47 332,-11316.47 332,-11339.47 332,-11339.47 332,-11345.47 326,-11351.47 320,-11351.47"/>
<text text-anchor="middle" x="171" y="-11336.47" font-family="Arial" font-size="10.00">Layer 69 QKV Proj GPU6</text>
<text text-anchor="middle" x="171" y="-11325.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="171" y="-11314.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer68_ffn_ar&#45;&gt;layer69_qkv_6 -->
<g id="edge1112" class="edge">
<title>layer68_ffn_ar&#45;&gt;layer69_qkv_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M301.56,-11423.42C273.06,-11402.81 237.48,-11377.06 210.66,-11357.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="212.43,-11354.62 202.28,-11351.6 208.33,-11360.3 212.43,-11354.62"/>
</g>
<!-- layer69_qkv_7 -->
<g id="node975" class="node">
<title>layer69_qkv_7</title>
<path fill="#e6f3ff" stroke="black" d="M678,-11351.47C678,-11351.47 380,-11351.47 380,-11351.47 374,-11351.47 368,-11345.47 368,-11339.47 368,-11339.47 368,-11316.47 368,-11316.47 368,-11310.47 374,-11304.47 380,-11304.47 380,-11304.47 678,-11304.47 678,-11304.47 684,-11304.47 690,-11310.47 690,-11316.47 690,-11316.47 690,-11339.47 690,-11339.47 690,-11345.47 684,-11351.47 678,-11351.47"/>
<text text-anchor="middle" x="529" y="-11336.47" font-family="Arial" font-size="10.00">Layer 69 QKV Proj GPU7</text>
<text text-anchor="middle" x="529" y="-11325.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="529" y="-11314.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer68_ffn_ar&#45;&gt;layer69_qkv_7 -->
<g id="edge1113" class="edge">
<title>layer68_ffn_ar&#45;&gt;layer69_qkv_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M398.44,-11423.42C426.94,-11402.81 462.52,-11377.06 489.34,-11357.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="491.67,-11360.3 497.72,-11351.6 487.57,-11354.62 491.67,-11360.3"/>
</g>
<!-- layer69_attn_6 -->
<g id="node976" class="node">
<title>layer69_attn_6</title>
<path fill="#e6f3ff" stroke="black" d="M320,-11232.47C320,-11232.47 22,-11232.47 22,-11232.47 16,-11232.47 10,-11226.47 10,-11220.47 10,-11220.47 10,-11197.47 10,-11197.47 10,-11191.47 16,-11185.47 22,-11185.47 22,-11185.47 320,-11185.47 320,-11185.47 326,-11185.47 332,-11191.47 332,-11197.47 332,-11197.47 332,-11220.47 332,-11220.47 332,-11226.47 326,-11232.47 320,-11232.47"/>
<text text-anchor="middle" x="171" y="-11217.47" font-family="Arial" font-size="10.00">Layer 69 Attention GPU6</text>
<text text-anchor="middle" x="171" y="-11206.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="171" y="-11195.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer69_qkv_6&#45;&gt;layer69_attn_6 -->
<g id="edge1114" class="edge">
<title>layer69_qkv_6&#45;&gt;layer69_attn_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M171,-11304.41C171,-11286.96 171,-11262.55 171,-11242.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="174.5,-11242.86 171,-11232.86 167.5,-11242.86 174.5,-11242.86"/>
</g>
<!-- layer69_attn_7 -->
<g id="node977" class="node">
<title>layer69_attn_7</title>
<path fill="#e6f3ff" stroke="black" d="M678,-11232.47C678,-11232.47 380,-11232.47 380,-11232.47 374,-11232.47 368,-11226.47 368,-11220.47 368,-11220.47 368,-11197.47 368,-11197.47 368,-11191.47 374,-11185.47 380,-11185.47 380,-11185.47 678,-11185.47 678,-11185.47 684,-11185.47 690,-11191.47 690,-11197.47 690,-11197.47 690,-11220.47 690,-11220.47 690,-11226.47 684,-11232.47 678,-11232.47"/>
<text text-anchor="middle" x="529" y="-11217.47" font-family="Arial" font-size="10.00">Layer 69 Attention GPU7</text>
<text text-anchor="middle" x="529" y="-11206.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="529" y="-11195.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer69_qkv_7&#45;&gt;layer69_attn_7 -->
<g id="edge1115" class="edge">
<title>layer69_qkv_7&#45;&gt;layer69_attn_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M529,-11304.41C529,-11286.96 529,-11262.55 529,-11242.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="532.5,-11242.86 529,-11232.86 525.5,-11242.86 532.5,-11242.86"/>
</g>
<!-- layer69_attn_out_6 -->
<g id="node978" class="node">
<title>layer69_attn_out_6</title>
<path fill="#e6f3ff" stroke="black" d="M320,-11113.47C320,-11113.47 30,-11113.47 30,-11113.47 24,-11113.47 18,-11107.47 18,-11101.47 18,-11101.47 18,-11078.47 18,-11078.47 18,-11072.47 24,-11066.47 30,-11066.47 30,-11066.47 320,-11066.47 320,-11066.47 326,-11066.47 332,-11072.47 332,-11078.47 332,-11078.47 332,-11101.47 332,-11101.47 332,-11107.47 326,-11113.47 320,-11113.47"/>
<text text-anchor="middle" x="175" y="-11098.47" font-family="Arial" font-size="10.00">Layer 69 Attn Out GPU6</text>
<text text-anchor="middle" x="175" y="-11087.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="175" y="-11076.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer69_attn_6&#45;&gt;layer69_attn_out_6 -->
<g id="edge1116" class="edge">
<title>layer69_attn_6&#45;&gt;layer69_attn_out_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M171.77,-11185.41C172.37,-11167.96 173.2,-11143.55 173.87,-11123.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="177.37,-11123.97 174.22,-11113.86 170.38,-11123.73 177.37,-11123.97"/>
</g>
<!-- layer69_attn_out_7 -->
<g id="node979" class="node">
<title>layer69_attn_out_7</title>
<path fill="#e6f3ff" stroke="black" d="M672,-11113.47C672,-11113.47 382,-11113.47 382,-11113.47 376,-11113.47 370,-11107.47 370,-11101.47 370,-11101.47 370,-11078.47 370,-11078.47 370,-11072.47 376,-11066.47 382,-11066.47 382,-11066.47 672,-11066.47 672,-11066.47 678,-11066.47 684,-11072.47 684,-11078.47 684,-11078.47 684,-11101.47 684,-11101.47 684,-11107.47 678,-11113.47 672,-11113.47"/>
<text text-anchor="middle" x="527" y="-11098.47" font-family="Arial" font-size="10.00">Layer 69 Attn Out GPU7</text>
<text text-anchor="middle" x="527" y="-11087.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="527" y="-11076.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer69_attn_7&#45;&gt;layer69_attn_out_7 -->
<g id="edge1117" class="edge">
<title>layer69_attn_7&#45;&gt;layer69_attn_out_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M528.61,-11185.41C528.32,-11167.96 527.9,-11143.55 527.56,-11123.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="531.06,-11123.8 527.39,-11113.86 524.06,-11123.92 531.06,-11123.8"/>
</g>
<!-- layer69_attn_ar -->
<g id="node980" class="node">
<title>layer69_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M480.07,-10994.47C480.07,-10994.47 278.07,-10994.47 278.07,-10994.47 272.07,-10994.47 262.3,-10989.8 258.53,-10985.13 258.53,-10985.13 215.47,-10931.8 215.47,-10931.8 211.7,-10927.14 213.93,-10922.47 219.93,-10922.47 219.93,-10922.47 421.93,-10922.47 421.93,-10922.47 427.93,-10922.47 437.7,-10927.14 441.47,-10931.8 441.47,-10931.8 484.53,-10985.13 484.53,-10985.13 488.3,-10989.8 486.07,-10994.47 480.07,-10994.47"/>
<text text-anchor="middle" x="350" y="-10961.47" font-family="Arial" font-size="10.00">Layer 69 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="350" y="-10950.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer69_attn_out_6&#45;&gt;layer69_attn_ar -->
<g id="edge1118" class="edge">
<title>layer69_attn_out_6&#45;&gt;layer69_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M205.48,-11066.41C229.92,-11048.33 264.86,-11022.47 294.27,-11000.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="296.45,-11003.45 302.4,-10994.69 292.28,-10997.82 296.45,-11003.45"/>
</g>
<!-- layer69_attn_out_7&#45;&gt;layer69_attn_ar -->
<g id="edge1119" class="edge">
<title>layer69_attn_out_7&#45;&gt;layer69_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M496.17,-11066.41C471.45,-11048.33 436.11,-11022.47 406.37,-11000.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="408.28,-10997.77 398.14,-10994.69 404.14,-11003.42 408.28,-10997.77"/>
</g>
<!-- layer69_ffn1_6 -->
<g id="node981" class="node">
<title>layer69_ffn1_6</title>
<path fill="#e6f3ff" stroke="black" d="M320,-10850.47C320,-10850.47 50,-10850.47 50,-10850.47 44,-10850.47 38,-10844.47 38,-10838.47 38,-10838.47 38,-10815.47 38,-10815.47 38,-10809.47 44,-10803.47 50,-10803.47 50,-10803.47 320,-10803.47 320,-10803.47 326,-10803.47 332,-10809.47 332,-10815.47 332,-10815.47 332,-10838.47 332,-10838.47 332,-10844.47 326,-10850.47 320,-10850.47"/>
<text text-anchor="middle" x="185" y="-10835.47" font-family="Arial" font-size="10.00">Layer 69 FFN1 GPU6</text>
<text text-anchor="middle" x="185" y="-10824.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="185" y="-10813.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer69_attn_ar&#45;&gt;layer69_ffn1_6 -->
<g id="edge1120" class="edge">
<title>layer69_attn_ar&#45;&gt;layer69_ffn1_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M305.35,-10922.42C279.28,-10901.96 246.78,-10876.45 222.12,-10857.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="224.11,-10854.21 214.08,-10850.79 219.79,-10859.72 224.11,-10854.21"/>
</g>
<!-- layer69_ffn1_7 -->
<g id="node982" class="node">
<title>layer69_ffn1_7</title>
<path fill="#e6f3ff" stroke="black" d="M650,-10850.47C650,-10850.47 380,-10850.47 380,-10850.47 374,-10850.47 368,-10844.47 368,-10838.47 368,-10838.47 368,-10815.47 368,-10815.47 368,-10809.47 374,-10803.47 380,-10803.47 380,-10803.47 650,-10803.47 650,-10803.47 656,-10803.47 662,-10809.47 662,-10815.47 662,-10815.47 662,-10838.47 662,-10838.47 662,-10844.47 656,-10850.47 650,-10850.47"/>
<text text-anchor="middle" x="515" y="-10835.47" font-family="Arial" font-size="10.00">Layer 69 FFN1 GPU7</text>
<text text-anchor="middle" x="515" y="-10824.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="515" y="-10813.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer69_attn_ar&#45;&gt;layer69_ffn1_7 -->
<g id="edge1121" class="edge">
<title>layer69_attn_ar&#45;&gt;layer69_ffn1_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M394.65,-10922.42C420.72,-10901.96 453.22,-10876.45 477.88,-10857.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="480.21,-10859.72 485.92,-10850.79 475.89,-10854.21 480.21,-10859.72"/>
</g>
<!-- layer69_act_6 -->
<g id="node983" class="node">
<title>layer69_act_6</title>
<path fill="#e6f3ff" stroke="black" d="M320,-10731.47C320,-10731.47 50,-10731.47 50,-10731.47 44,-10731.47 38,-10725.47 38,-10719.47 38,-10719.47 38,-10696.47 38,-10696.47 38,-10690.47 44,-10684.47 50,-10684.47 50,-10684.47 320,-10684.47 320,-10684.47 326,-10684.47 332,-10690.47 332,-10696.47 332,-10696.47 332,-10719.47 332,-10719.47 332,-10725.47 326,-10731.47 320,-10731.47"/>
<text text-anchor="middle" x="185" y="-10716.47" font-family="Arial" font-size="10.00">Layer 69 SiLU GPU6</text>
<text text-anchor="middle" x="185" y="-10705.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="185" y="-10694.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer69_ffn1_6&#45;&gt;layer69_act_6 -->
<g id="edge1122" class="edge">
<title>layer69_ffn1_6&#45;&gt;layer69_act_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M185,-10803.41C185,-10785.96 185,-10761.55 185,-10741.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="188.5,-10741.86 185,-10731.86 181.5,-10741.86 188.5,-10741.86"/>
</g>
<!-- layer69_act_7 -->
<g id="node984" class="node">
<title>layer69_act_7</title>
<path fill="#e6f3ff" stroke="black" d="M650,-10731.47C650,-10731.47 380,-10731.47 380,-10731.47 374,-10731.47 368,-10725.47 368,-10719.47 368,-10719.47 368,-10696.47 368,-10696.47 368,-10690.47 374,-10684.47 380,-10684.47 380,-10684.47 650,-10684.47 650,-10684.47 656,-10684.47 662,-10690.47 662,-10696.47 662,-10696.47 662,-10719.47 662,-10719.47 662,-10725.47 656,-10731.47 650,-10731.47"/>
<text text-anchor="middle" x="515" y="-10716.47" font-family="Arial" font-size="10.00">Layer 69 SiLU GPU7</text>
<text text-anchor="middle" x="515" y="-10705.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="515" y="-10694.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer69_ffn1_7&#45;&gt;layer69_act_7 -->
<g id="edge1123" class="edge">
<title>layer69_ffn1_7&#45;&gt;layer69_act_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M515,-10803.41C515,-10785.96 515,-10761.55 515,-10741.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="518.5,-10741.86 515,-10731.86 511.5,-10741.86 518.5,-10741.86"/>
</g>
<!-- layer69_ffn2_6 -->
<g id="node985" class="node">
<title>layer69_ffn2_6</title>
<path fill="#e6f3ff" stroke="black" d="M319.5,-10612.47C319.5,-10612.47 56.5,-10612.47 56.5,-10612.47 50.5,-10612.47 44.5,-10606.47 44.5,-10600.47 44.5,-10600.47 44.5,-10577.47 44.5,-10577.47 44.5,-10571.47 50.5,-10565.47 56.5,-10565.47 56.5,-10565.47 319.5,-10565.47 319.5,-10565.47 325.5,-10565.47 331.5,-10571.47 331.5,-10577.47 331.5,-10577.47 331.5,-10600.47 331.5,-10600.47 331.5,-10606.47 325.5,-10612.47 319.5,-10612.47"/>
<text text-anchor="middle" x="188" y="-10597.47" font-family="Arial" font-size="10.00">Layer 69 FFN2 GPU6</text>
<text text-anchor="middle" x="188" y="-10586.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="188" y="-10575.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer69_act_6&#45;&gt;layer69_ffn2_6 -->
<g id="edge1124" class="edge">
<title>layer69_act_6&#45;&gt;layer69_ffn2_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M185.58,-10684.41C186.03,-10666.96 186.65,-10642.55 187.16,-10622.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="190.66,-10622.94 187.41,-10612.86 183.66,-10622.76 190.66,-10622.94"/>
</g>
<!-- layer69_ffn2_7 -->
<g id="node986" class="node">
<title>layer69_ffn2_7</title>
<path fill="#e6f3ff" stroke="black" d="M644.5,-10612.47C644.5,-10612.47 381.5,-10612.47 381.5,-10612.47 375.5,-10612.47 369.5,-10606.47 369.5,-10600.47 369.5,-10600.47 369.5,-10577.47 369.5,-10577.47 369.5,-10571.47 375.5,-10565.47 381.5,-10565.47 381.5,-10565.47 644.5,-10565.47 644.5,-10565.47 650.5,-10565.47 656.5,-10571.47 656.5,-10577.47 656.5,-10577.47 656.5,-10600.47 656.5,-10600.47 656.5,-10606.47 650.5,-10612.47 644.5,-10612.47"/>
<text text-anchor="middle" x="513" y="-10597.47" font-family="Arial" font-size="10.00">Layer 69 FFN2 GPU7</text>
<text text-anchor="middle" x="513" y="-10586.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="513" y="-10575.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer69_act_7&#45;&gt;layer69_ffn2_7 -->
<g id="edge1125" class="edge">
<title>layer69_act_7&#45;&gt;layer69_ffn2_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M514.61,-10684.41C514.32,-10666.96 513.9,-10642.55 513.56,-10622.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="517.06,-10622.8 513.39,-10612.86 510.06,-10622.92 517.06,-10622.8"/>
</g>
<!-- layer69_ffn_ar -->
<g id="node987" class="node">
<title>layer69_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M481.22,-10493.47C481.22,-10493.47 275.8,-10493.47 275.8,-10493.47 269.8,-10493.47 260,-10488.83 256.19,-10484.19 256.19,-10484.19 212.39,-10430.75 212.39,-10430.75 208.59,-10426.11 210.78,-10421.47 216.78,-10421.47 216.78,-10421.47 422.2,-10421.47 422.2,-10421.47 428.2,-10421.47 438,-10426.11 441.81,-10430.75 441.81,-10430.75 485.61,-10484.19 485.61,-10484.19 489.41,-10488.83 487.22,-10493.47 481.22,-10493.47"/>
<text text-anchor="middle" x="349" y="-10460.47" font-family="Arial" font-size="10.00">Layer 69 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="349" y="-10449.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer69_ffn2_6&#45;&gt;layer69_ffn_ar -->
<g id="edge1126" class="edge">
<title>layer69_ffn2_6&#45;&gt;layer69_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M216.04,-10565.41C238.43,-10547.41 270.4,-10521.69 297.38,-10499.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="299.61,-10502.68 305.21,-10493.69 295.23,-10497.23 299.61,-10502.68"/>
</g>
<!-- layer69_ffn2_7&#45;&gt;layer69_ffn_ar -->
<g id="edge1127" class="edge">
<title>layer69_ffn2_7&#45;&gt;layer69_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M484.43,-10565.41C461.63,-10547.41 429.06,-10521.69 401.58,-10499.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="403.62,-10497.14 393.6,-10493.69 399.28,-10502.63 403.62,-10497.14"/>
</g>
<!-- layer70_qkv_6 -->
<g id="node988" class="node">
<title>layer70_qkv_6</title>
<path fill="#e6f3ff" stroke="black" d="M319,-10349.47C319,-10349.47 21,-10349.47 21,-10349.47 15,-10349.47 9,-10343.47 9,-10337.47 9,-10337.47 9,-10314.47 9,-10314.47 9,-10308.47 15,-10302.47 21,-10302.47 21,-10302.47 319,-10302.47 319,-10302.47 325,-10302.47 331,-10308.47 331,-10314.47 331,-10314.47 331,-10337.47 331,-10337.47 331,-10343.47 325,-10349.47 319,-10349.47"/>
<text text-anchor="middle" x="170" y="-10334.47" font-family="Arial" font-size="10.00">Layer 70 QKV Proj GPU6</text>
<text text-anchor="middle" x="170" y="-10323.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="170" y="-10312.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer69_ffn_ar&#45;&gt;layer70_qkv_6 -->
<g id="edge1128" class="edge">
<title>layer69_ffn_ar&#45;&gt;layer70_qkv_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M300.56,-10421.42C272.06,-10400.81 236.48,-10375.06 209.66,-10355.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="211.43,-10352.62 201.28,-10349.6 207.33,-10358.3 211.43,-10352.62"/>
</g>
<!-- layer70_qkv_7 -->
<g id="node989" class="node">
<title>layer70_qkv_7</title>
<path fill="#e6f3ff" stroke="black" d="M677,-10349.47C677,-10349.47 379,-10349.47 379,-10349.47 373,-10349.47 367,-10343.47 367,-10337.47 367,-10337.47 367,-10314.47 367,-10314.47 367,-10308.47 373,-10302.47 379,-10302.47 379,-10302.47 677,-10302.47 677,-10302.47 683,-10302.47 689,-10308.47 689,-10314.47 689,-10314.47 689,-10337.47 689,-10337.47 689,-10343.47 683,-10349.47 677,-10349.47"/>
<text text-anchor="middle" x="528" y="-10334.47" font-family="Arial" font-size="10.00">Layer 70 QKV Proj GPU7</text>
<text text-anchor="middle" x="528" y="-10323.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="528" y="-10312.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer69_ffn_ar&#45;&gt;layer70_qkv_7 -->
<g id="edge1129" class="edge">
<title>layer69_ffn_ar&#45;&gt;layer70_qkv_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M397.44,-10421.42C425.94,-10400.81 461.52,-10375.06 488.34,-10355.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="490.67,-10358.3 496.72,-10349.6 486.57,-10352.62 490.67,-10358.3"/>
</g>
<!-- layer70_attn_6 -->
<g id="node990" class="node">
<title>layer70_attn_6</title>
<path fill="#e6f3ff" stroke="black" d="M319,-10230.47C319,-10230.47 21,-10230.47 21,-10230.47 15,-10230.47 9,-10224.47 9,-10218.47 9,-10218.47 9,-10195.47 9,-10195.47 9,-10189.47 15,-10183.47 21,-10183.47 21,-10183.47 319,-10183.47 319,-10183.47 325,-10183.47 331,-10189.47 331,-10195.47 331,-10195.47 331,-10218.47 331,-10218.47 331,-10224.47 325,-10230.47 319,-10230.47"/>
<text text-anchor="middle" x="170" y="-10215.47" font-family="Arial" font-size="10.00">Layer 70 Attention GPU6</text>
<text text-anchor="middle" x="170" y="-10204.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="170" y="-10193.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer70_qkv_6&#45;&gt;layer70_attn_6 -->
<g id="edge1130" class="edge">
<title>layer70_qkv_6&#45;&gt;layer70_attn_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M170,-10302.41C170,-10284.96 170,-10260.55 170,-10240.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="173.5,-10240.86 170,-10230.86 166.5,-10240.86 173.5,-10240.86"/>
</g>
<!-- layer70_attn_7 -->
<g id="node991" class="node">
<title>layer70_attn_7</title>
<path fill="#e6f3ff" stroke="black" d="M677,-10230.47C677,-10230.47 379,-10230.47 379,-10230.47 373,-10230.47 367,-10224.47 367,-10218.47 367,-10218.47 367,-10195.47 367,-10195.47 367,-10189.47 373,-10183.47 379,-10183.47 379,-10183.47 677,-10183.47 677,-10183.47 683,-10183.47 689,-10189.47 689,-10195.47 689,-10195.47 689,-10218.47 689,-10218.47 689,-10224.47 683,-10230.47 677,-10230.47"/>
<text text-anchor="middle" x="528" y="-10215.47" font-family="Arial" font-size="10.00">Layer 70 Attention GPU7</text>
<text text-anchor="middle" x="528" y="-10204.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="528" y="-10193.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer70_qkv_7&#45;&gt;layer70_attn_7 -->
<g id="edge1131" class="edge">
<title>layer70_qkv_7&#45;&gt;layer70_attn_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M528,-10302.41C528,-10284.96 528,-10260.55 528,-10240.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="531.5,-10240.86 528,-10230.86 524.5,-10240.86 531.5,-10240.86"/>
</g>
<!-- layer70_attn_out_6 -->
<g id="node992" class="node">
<title>layer70_attn_out_6</title>
<path fill="#e6f3ff" stroke="black" d="M319,-10111.47C319,-10111.47 29,-10111.47 29,-10111.47 23,-10111.47 17,-10105.47 17,-10099.47 17,-10099.47 17,-10076.47 17,-10076.47 17,-10070.47 23,-10064.47 29,-10064.47 29,-10064.47 319,-10064.47 319,-10064.47 325,-10064.47 331,-10070.47 331,-10076.47 331,-10076.47 331,-10099.47 331,-10099.47 331,-10105.47 325,-10111.47 319,-10111.47"/>
<text text-anchor="middle" x="174" y="-10096.47" font-family="Arial" font-size="10.00">Layer 70 Attn Out GPU6</text>
<text text-anchor="middle" x="174" y="-10085.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="174" y="-10074.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer70_attn_6&#45;&gt;layer70_attn_out_6 -->
<g id="edge1132" class="edge">
<title>layer70_attn_6&#45;&gt;layer70_attn_out_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M170.77,-10183.41C171.37,-10165.96 172.2,-10141.55 172.87,-10121.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="176.37,-10121.97 173.22,-10111.86 169.38,-10121.73 176.37,-10121.97"/>
</g>
<!-- layer70_attn_out_7 -->
<g id="node993" class="node">
<title>layer70_attn_out_7</title>
<path fill="#e6f3ff" stroke="black" d="M671,-10111.47C671,-10111.47 381,-10111.47 381,-10111.47 375,-10111.47 369,-10105.47 369,-10099.47 369,-10099.47 369,-10076.47 369,-10076.47 369,-10070.47 375,-10064.47 381,-10064.47 381,-10064.47 671,-10064.47 671,-10064.47 677,-10064.47 683,-10070.47 683,-10076.47 683,-10076.47 683,-10099.47 683,-10099.47 683,-10105.47 677,-10111.47 671,-10111.47"/>
<text text-anchor="middle" x="526" y="-10096.47" font-family="Arial" font-size="10.00">Layer 70 Attn Out GPU7</text>
<text text-anchor="middle" x="526" y="-10085.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="526" y="-10074.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer70_attn_7&#45;&gt;layer70_attn_out_7 -->
<g id="edge1133" class="edge">
<title>layer70_attn_7&#45;&gt;layer70_attn_out_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M527.61,-10183.41C527.32,-10165.96 526.9,-10141.55 526.56,-10121.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="530.06,-10121.8 526.39,-10111.86 523.06,-10121.92 530.06,-10121.8"/>
</g>
<!-- layer70_attn_ar -->
<g id="node994" class="node">
<title>layer70_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M479.07,-9992.47C479.07,-9992.47 277.07,-9992.47 277.07,-9992.47 271.07,-9992.47 261.3,-9987.8 257.53,-9983.13 257.53,-9983.13 214.47,-9929.8 214.47,-9929.8 210.7,-9925.14 212.93,-9920.47 218.93,-9920.47 218.93,-9920.47 420.93,-9920.47 420.93,-9920.47 426.93,-9920.47 436.7,-9925.14 440.47,-9929.8 440.47,-9929.8 483.53,-9983.13 483.53,-9983.13 487.3,-9987.8 485.07,-9992.47 479.07,-9992.47"/>
<text text-anchor="middle" x="349" y="-9959.47" font-family="Arial" font-size="10.00">Layer 70 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="349" y="-9948.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer70_attn_out_6&#45;&gt;layer70_attn_ar -->
<g id="edge1134" class="edge">
<title>layer70_attn_out_6&#45;&gt;layer70_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M204.48,-10064.41C228.92,-10046.33 263.86,-10020.47 293.27,-9998.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="295.45,-10001.45 301.4,-9992.69 291.28,-9995.82 295.45,-10001.45"/>
</g>
<!-- layer70_attn_out_7&#45;&gt;layer70_attn_ar -->
<g id="edge1135" class="edge">
<title>layer70_attn_out_7&#45;&gt;layer70_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M495.17,-10064.41C470.45,-10046.33 435.11,-10020.47 405.37,-9998.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="407.28,-9995.77 397.14,-9992.69 403.14,-10001.42 407.28,-9995.77"/>
</g>
<!-- layer70_ffn1_6 -->
<g id="node995" class="node">
<title>layer70_ffn1_6</title>
<path fill="#e6f3ff" stroke="black" d="M319,-9848.47C319,-9848.47 49,-9848.47 49,-9848.47 43,-9848.47 37,-9842.47 37,-9836.47 37,-9836.47 37,-9813.47 37,-9813.47 37,-9807.47 43,-9801.47 49,-9801.47 49,-9801.47 319,-9801.47 319,-9801.47 325,-9801.47 331,-9807.47 331,-9813.47 331,-9813.47 331,-9836.47 331,-9836.47 331,-9842.47 325,-9848.47 319,-9848.47"/>
<text text-anchor="middle" x="184" y="-9833.47" font-family="Arial" font-size="10.00">Layer 70 FFN1 GPU6</text>
<text text-anchor="middle" x="184" y="-9822.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="184" y="-9811.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer70_attn_ar&#45;&gt;layer70_ffn1_6 -->
<g id="edge1136" class="edge">
<title>layer70_attn_ar&#45;&gt;layer70_ffn1_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M304.35,-9920.42C278.28,-9899.96 245.78,-9874.45 221.12,-9855.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="223.11,-9852.21 213.08,-9848.79 218.79,-9857.72 223.11,-9852.21"/>
</g>
<!-- layer70_ffn1_7 -->
<g id="node996" class="node">
<title>layer70_ffn1_7</title>
<path fill="#e6f3ff" stroke="black" d="M649,-9848.47C649,-9848.47 379,-9848.47 379,-9848.47 373,-9848.47 367,-9842.47 367,-9836.47 367,-9836.47 367,-9813.47 367,-9813.47 367,-9807.47 373,-9801.47 379,-9801.47 379,-9801.47 649,-9801.47 649,-9801.47 655,-9801.47 661,-9807.47 661,-9813.47 661,-9813.47 661,-9836.47 661,-9836.47 661,-9842.47 655,-9848.47 649,-9848.47"/>
<text text-anchor="middle" x="514" y="-9833.47" font-family="Arial" font-size="10.00">Layer 70 FFN1 GPU7</text>
<text text-anchor="middle" x="514" y="-9822.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="514" y="-9811.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer70_attn_ar&#45;&gt;layer70_ffn1_7 -->
<g id="edge1137" class="edge">
<title>layer70_attn_ar&#45;&gt;layer70_ffn1_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M393.65,-9920.42C419.72,-9899.96 452.22,-9874.45 476.88,-9855.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="479.21,-9857.72 484.92,-9848.79 474.89,-9852.21 479.21,-9857.72"/>
</g>
<!-- layer70_act_6 -->
<g id="node997" class="node">
<title>layer70_act_6</title>
<path fill="#e6f3ff" stroke="black" d="M319,-9729.47C319,-9729.47 49,-9729.47 49,-9729.47 43,-9729.47 37,-9723.47 37,-9717.47 37,-9717.47 37,-9694.47 37,-9694.47 37,-9688.47 43,-9682.47 49,-9682.47 49,-9682.47 319,-9682.47 319,-9682.47 325,-9682.47 331,-9688.47 331,-9694.47 331,-9694.47 331,-9717.47 331,-9717.47 331,-9723.47 325,-9729.47 319,-9729.47"/>
<text text-anchor="middle" x="184" y="-9714.47" font-family="Arial" font-size="10.00">Layer 70 SiLU GPU6</text>
<text text-anchor="middle" x="184" y="-9703.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="184" y="-9692.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer70_ffn1_6&#45;&gt;layer70_act_6 -->
<g id="edge1138" class="edge">
<title>layer70_ffn1_6&#45;&gt;layer70_act_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M184,-9801.41C184,-9783.96 184,-9759.55 184,-9739.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="187.5,-9739.86 184,-9729.86 180.5,-9739.86 187.5,-9739.86"/>
</g>
<!-- layer70_act_7 -->
<g id="node998" class="node">
<title>layer70_act_7</title>
<path fill="#e6f3ff" stroke="black" d="M649,-9729.47C649,-9729.47 379,-9729.47 379,-9729.47 373,-9729.47 367,-9723.47 367,-9717.47 367,-9717.47 367,-9694.47 367,-9694.47 367,-9688.47 373,-9682.47 379,-9682.47 379,-9682.47 649,-9682.47 649,-9682.47 655,-9682.47 661,-9688.47 661,-9694.47 661,-9694.47 661,-9717.47 661,-9717.47 661,-9723.47 655,-9729.47 649,-9729.47"/>
<text text-anchor="middle" x="514" y="-9714.47" font-family="Arial" font-size="10.00">Layer 70 SiLU GPU7</text>
<text text-anchor="middle" x="514" y="-9703.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="514" y="-9692.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer70_ffn1_7&#45;&gt;layer70_act_7 -->
<g id="edge1139" class="edge">
<title>layer70_ffn1_7&#45;&gt;layer70_act_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M514,-9801.41C514,-9783.96 514,-9759.55 514,-9739.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="517.5,-9739.86 514,-9729.86 510.5,-9739.86 517.5,-9739.86"/>
</g>
<!-- layer70_ffn2_6 -->
<g id="node999" class="node">
<title>layer70_ffn2_6</title>
<path fill="#e6f3ff" stroke="black" d="M318.5,-9610.47C318.5,-9610.47 55.5,-9610.47 55.5,-9610.47 49.5,-9610.47 43.5,-9604.47 43.5,-9598.47 43.5,-9598.47 43.5,-9575.47 43.5,-9575.47 43.5,-9569.47 49.5,-9563.47 55.5,-9563.47 55.5,-9563.47 318.5,-9563.47 318.5,-9563.47 324.5,-9563.47 330.5,-9569.47 330.5,-9575.47 330.5,-9575.47 330.5,-9598.47 330.5,-9598.47 330.5,-9604.47 324.5,-9610.47 318.5,-9610.47"/>
<text text-anchor="middle" x="187" y="-9595.47" font-family="Arial" font-size="10.00">Layer 70 FFN2 GPU6</text>
<text text-anchor="middle" x="187" y="-9584.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="187" y="-9573.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer70_act_6&#45;&gt;layer70_ffn2_6 -->
<g id="edge1140" class="edge">
<title>layer70_act_6&#45;&gt;layer70_ffn2_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M184.58,-9682.41C185.03,-9664.96 185.65,-9640.55 186.16,-9620.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="189.66,-9620.94 186.41,-9610.86 182.66,-9620.76 189.66,-9620.94"/>
</g>
<!-- layer70_ffn2_7 -->
<g id="node1000" class="node">
<title>layer70_ffn2_7</title>
<path fill="#e6f3ff" stroke="black" d="M643.5,-9610.47C643.5,-9610.47 380.5,-9610.47 380.5,-9610.47 374.5,-9610.47 368.5,-9604.47 368.5,-9598.47 368.5,-9598.47 368.5,-9575.47 368.5,-9575.47 368.5,-9569.47 374.5,-9563.47 380.5,-9563.47 380.5,-9563.47 643.5,-9563.47 643.5,-9563.47 649.5,-9563.47 655.5,-9569.47 655.5,-9575.47 655.5,-9575.47 655.5,-9598.47 655.5,-9598.47 655.5,-9604.47 649.5,-9610.47 643.5,-9610.47"/>
<text text-anchor="middle" x="512" y="-9595.47" font-family="Arial" font-size="10.00">Layer 70 FFN2 GPU7</text>
<text text-anchor="middle" x="512" y="-9584.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="512" y="-9573.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer70_act_7&#45;&gt;layer70_ffn2_7 -->
<g id="edge1141" class="edge">
<title>layer70_act_7&#45;&gt;layer70_ffn2_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M513.61,-9682.41C513.32,-9664.96 512.9,-9640.55 512.56,-9620.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="516.06,-9620.8 512.39,-9610.86 509.06,-9620.92 516.06,-9620.8"/>
</g>
<!-- layer70_ffn_ar -->
<g id="node1001" class="node">
<title>layer70_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M480.22,-9491.47C480.22,-9491.47 274.8,-9491.47 274.8,-9491.47 268.8,-9491.47 259,-9486.83 255.19,-9482.19 255.19,-9482.19 211.39,-9428.75 211.39,-9428.75 207.59,-9424.11 209.78,-9419.47 215.78,-9419.47 215.78,-9419.47 421.2,-9419.47 421.2,-9419.47 427.2,-9419.47 437,-9424.11 440.81,-9428.75 440.81,-9428.75 484.61,-9482.19 484.61,-9482.19 488.41,-9486.83 486.22,-9491.47 480.22,-9491.47"/>
<text text-anchor="middle" x="348" y="-9458.47" font-family="Arial" font-size="10.00">Layer 70 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="348" y="-9447.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer70_ffn2_6&#45;&gt;layer70_ffn_ar -->
<g id="edge1142" class="edge">
<title>layer70_ffn2_6&#45;&gt;layer70_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M215.04,-9563.41C237.43,-9545.41 269.4,-9519.69 296.38,-9497.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="298.61,-9500.68 304.21,-9491.69 294.23,-9495.23 298.61,-9500.68"/>
</g>
<!-- layer70_ffn2_7&#45;&gt;layer70_ffn_ar -->
<g id="edge1143" class="edge">
<title>layer70_ffn2_7&#45;&gt;layer70_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M483.43,-9563.41C460.63,-9545.41 428.06,-9519.69 400.58,-9497.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="402.62,-9495.14 392.6,-9491.69 398.28,-9500.63 402.62,-9495.14"/>
</g>
<!-- layer71_qkv_6 -->
<g id="node1002" class="node">
<title>layer71_qkv_6</title>
<path fill="#e6f3ff" stroke="black" d="M318,-9347.47C318,-9347.47 20,-9347.47 20,-9347.47 14,-9347.47 8,-9341.47 8,-9335.47 8,-9335.47 8,-9312.47 8,-9312.47 8,-9306.47 14,-9300.47 20,-9300.47 20,-9300.47 318,-9300.47 318,-9300.47 324,-9300.47 330,-9306.47 330,-9312.47 330,-9312.47 330,-9335.47 330,-9335.47 330,-9341.47 324,-9347.47 318,-9347.47"/>
<text text-anchor="middle" x="169" y="-9332.47" font-family="Arial" font-size="10.00">Layer 71 QKV Proj GPU6</text>
<text text-anchor="middle" x="169" y="-9321.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="169" y="-9310.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer70_ffn_ar&#45;&gt;layer71_qkv_6 -->
<g id="edge1144" class="edge">
<title>layer70_ffn_ar&#45;&gt;layer71_qkv_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M299.56,-9419.42C271.06,-9398.81 235.48,-9373.06 208.66,-9353.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="210.43,-9350.62 200.28,-9347.6 206.33,-9356.3 210.43,-9350.62"/>
</g>
<!-- layer71_qkv_7 -->
<g id="node1003" class="node">
<title>layer71_qkv_7</title>
<path fill="#e6f3ff" stroke="black" d="M676,-9347.47C676,-9347.47 378,-9347.47 378,-9347.47 372,-9347.47 366,-9341.47 366,-9335.47 366,-9335.47 366,-9312.47 366,-9312.47 366,-9306.47 372,-9300.47 378,-9300.47 378,-9300.47 676,-9300.47 676,-9300.47 682,-9300.47 688,-9306.47 688,-9312.47 688,-9312.47 688,-9335.47 688,-9335.47 688,-9341.47 682,-9347.47 676,-9347.47"/>
<text text-anchor="middle" x="527" y="-9332.47" font-family="Arial" font-size="10.00">Layer 71 QKV Proj GPU7</text>
<text text-anchor="middle" x="527" y="-9321.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="527" y="-9310.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer70_ffn_ar&#45;&gt;layer71_qkv_7 -->
<g id="edge1145" class="edge">
<title>layer70_ffn_ar&#45;&gt;layer71_qkv_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M396.44,-9419.42C424.94,-9398.81 460.52,-9373.06 487.34,-9353.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="489.67,-9356.3 495.72,-9347.6 485.57,-9350.62 489.67,-9356.3"/>
</g>
<!-- layer71_attn_6 -->
<g id="node1004" class="node">
<title>layer71_attn_6</title>
<path fill="#e6f3ff" stroke="black" d="M318,-9228.47C318,-9228.47 20,-9228.47 20,-9228.47 14,-9228.47 8,-9222.47 8,-9216.47 8,-9216.47 8,-9193.47 8,-9193.47 8,-9187.47 14,-9181.47 20,-9181.47 20,-9181.47 318,-9181.47 318,-9181.47 324,-9181.47 330,-9187.47 330,-9193.47 330,-9193.47 330,-9216.47 330,-9216.47 330,-9222.47 324,-9228.47 318,-9228.47"/>
<text text-anchor="middle" x="169" y="-9213.47" font-family="Arial" font-size="10.00">Layer 71 Attention GPU6</text>
<text text-anchor="middle" x="169" y="-9202.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="169" y="-9191.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer71_qkv_6&#45;&gt;layer71_attn_6 -->
<g id="edge1146" class="edge">
<title>layer71_qkv_6&#45;&gt;layer71_attn_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M169,-9300.41C169,-9282.96 169,-9258.55 169,-9238.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="172.5,-9238.86 169,-9228.86 165.5,-9238.86 172.5,-9238.86"/>
</g>
<!-- layer71_attn_7 -->
<g id="node1005" class="node">
<title>layer71_attn_7</title>
<path fill="#e6f3ff" stroke="black" d="M676,-9228.47C676,-9228.47 378,-9228.47 378,-9228.47 372,-9228.47 366,-9222.47 366,-9216.47 366,-9216.47 366,-9193.47 366,-9193.47 366,-9187.47 372,-9181.47 378,-9181.47 378,-9181.47 676,-9181.47 676,-9181.47 682,-9181.47 688,-9187.47 688,-9193.47 688,-9193.47 688,-9216.47 688,-9216.47 688,-9222.47 682,-9228.47 676,-9228.47"/>
<text text-anchor="middle" x="527" y="-9213.47" font-family="Arial" font-size="10.00">Layer 71 Attention GPU7</text>
<text text-anchor="middle" x="527" y="-9202.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="527" y="-9191.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer71_qkv_7&#45;&gt;layer71_attn_7 -->
<g id="edge1147" class="edge">
<title>layer71_qkv_7&#45;&gt;layer71_attn_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M527,-9300.41C527,-9282.96 527,-9258.55 527,-9238.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="530.5,-9238.86 527,-9228.86 523.5,-9238.86 530.5,-9238.86"/>
</g>
<!-- layer71_attn_out_6 -->
<g id="node1006" class="node">
<title>layer71_attn_out_6</title>
<path fill="#e6f3ff" stroke="black" d="M318,-9109.47C318,-9109.47 28,-9109.47 28,-9109.47 22,-9109.47 16,-9103.47 16,-9097.47 16,-9097.47 16,-9074.47 16,-9074.47 16,-9068.47 22,-9062.47 28,-9062.47 28,-9062.47 318,-9062.47 318,-9062.47 324,-9062.47 330,-9068.47 330,-9074.47 330,-9074.47 330,-9097.47 330,-9097.47 330,-9103.47 324,-9109.47 318,-9109.47"/>
<text text-anchor="middle" x="173" y="-9094.47" font-family="Arial" font-size="10.00">Layer 71 Attn Out GPU6</text>
<text text-anchor="middle" x="173" y="-9083.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="173" y="-9072.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer71_attn_6&#45;&gt;layer71_attn_out_6 -->
<g id="edge1148" class="edge">
<title>layer71_attn_6&#45;&gt;layer71_attn_out_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M169.77,-9181.41C170.37,-9163.96 171.2,-9139.55 171.87,-9119.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="175.37,-9119.97 172.22,-9109.86 168.38,-9119.73 175.37,-9119.97"/>
</g>
<!-- layer71_attn_out_7 -->
<g id="node1007" class="node">
<title>layer71_attn_out_7</title>
<path fill="#e6f3ff" stroke="black" d="M670,-9109.47C670,-9109.47 380,-9109.47 380,-9109.47 374,-9109.47 368,-9103.47 368,-9097.47 368,-9097.47 368,-9074.47 368,-9074.47 368,-9068.47 374,-9062.47 380,-9062.47 380,-9062.47 670,-9062.47 670,-9062.47 676,-9062.47 682,-9068.47 682,-9074.47 682,-9074.47 682,-9097.47 682,-9097.47 682,-9103.47 676,-9109.47 670,-9109.47"/>
<text text-anchor="middle" x="525" y="-9094.47" font-family="Arial" font-size="10.00">Layer 71 Attn Out GPU7</text>
<text text-anchor="middle" x="525" y="-9083.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="525" y="-9072.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer71_attn_7&#45;&gt;layer71_attn_out_7 -->
<g id="edge1149" class="edge">
<title>layer71_attn_7&#45;&gt;layer71_attn_out_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M526.61,-9181.41C526.32,-9163.96 525.9,-9139.55 525.56,-9119.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="529.06,-9119.8 525.39,-9109.86 522.06,-9119.92 529.06,-9119.8"/>
</g>
<!-- layer71_attn_ar -->
<g id="node1008" class="node">
<title>layer71_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M478.07,-8990.47C478.07,-8990.47 276.07,-8990.47 276.07,-8990.47 270.07,-8990.47 260.3,-8985.8 256.53,-8981.13 256.53,-8981.13 213.47,-8927.8 213.47,-8927.8 209.7,-8923.14 211.93,-8918.47 217.93,-8918.47 217.93,-8918.47 419.93,-8918.47 419.93,-8918.47 425.93,-8918.47 435.7,-8923.14 439.47,-8927.8 439.47,-8927.8 482.53,-8981.13 482.53,-8981.13 486.3,-8985.8 484.07,-8990.47 478.07,-8990.47"/>
<text text-anchor="middle" x="348" y="-8957.47" font-family="Arial" font-size="10.00">Layer 71 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="348" y="-8946.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer71_attn_out_6&#45;&gt;layer71_attn_ar -->
<g id="edge1150" class="edge">
<title>layer71_attn_out_6&#45;&gt;layer71_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M203.48,-9062.41C227.92,-9044.33 262.86,-9018.47 292.27,-8996.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="294.45,-8999.45 300.4,-8990.69 290.28,-8993.82 294.45,-8999.45"/>
</g>
<!-- layer71_attn_out_7&#45;&gt;layer71_attn_ar -->
<g id="edge1151" class="edge">
<title>layer71_attn_out_7&#45;&gt;layer71_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M494.17,-9062.41C469.45,-9044.33 434.11,-9018.47 404.37,-8996.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="406.28,-8993.77 396.14,-8990.69 402.14,-8999.42 406.28,-8993.77"/>
</g>
<!-- layer71_ffn1_6 -->
<g id="node1009" class="node">
<title>layer71_ffn1_6</title>
<path fill="#e6f3ff" stroke="black" d="M318,-8846.47C318,-8846.47 48,-8846.47 48,-8846.47 42,-8846.47 36,-8840.47 36,-8834.47 36,-8834.47 36,-8811.47 36,-8811.47 36,-8805.47 42,-8799.47 48,-8799.47 48,-8799.47 318,-8799.47 318,-8799.47 324,-8799.47 330,-8805.47 330,-8811.47 330,-8811.47 330,-8834.47 330,-8834.47 330,-8840.47 324,-8846.47 318,-8846.47"/>
<text text-anchor="middle" x="183" y="-8831.47" font-family="Arial" font-size="10.00">Layer 71 FFN1 GPU6</text>
<text text-anchor="middle" x="183" y="-8820.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="183" y="-8809.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer71_attn_ar&#45;&gt;layer71_ffn1_6 -->
<g id="edge1152" class="edge">
<title>layer71_attn_ar&#45;&gt;layer71_ffn1_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M303.35,-8918.42C277.28,-8897.96 244.78,-8872.45 220.12,-8853.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="222.11,-8850.21 212.08,-8846.79 217.79,-8855.72 222.11,-8850.21"/>
</g>
<!-- layer71_ffn1_7 -->
<g id="node1010" class="node">
<title>layer71_ffn1_7</title>
<path fill="#e6f3ff" stroke="black" d="M648,-8846.47C648,-8846.47 378,-8846.47 378,-8846.47 372,-8846.47 366,-8840.47 366,-8834.47 366,-8834.47 366,-8811.47 366,-8811.47 366,-8805.47 372,-8799.47 378,-8799.47 378,-8799.47 648,-8799.47 648,-8799.47 654,-8799.47 660,-8805.47 660,-8811.47 660,-8811.47 660,-8834.47 660,-8834.47 660,-8840.47 654,-8846.47 648,-8846.47"/>
<text text-anchor="middle" x="513" y="-8831.47" font-family="Arial" font-size="10.00">Layer 71 FFN1 GPU7</text>
<text text-anchor="middle" x="513" y="-8820.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="513" y="-8809.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer71_attn_ar&#45;&gt;layer71_ffn1_7 -->
<g id="edge1153" class="edge">
<title>layer71_attn_ar&#45;&gt;layer71_ffn1_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M392.65,-8918.42C418.72,-8897.96 451.22,-8872.45 475.88,-8853.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="478.21,-8855.72 483.92,-8846.79 473.89,-8850.21 478.21,-8855.72"/>
</g>
<!-- layer71_act_6 -->
<g id="node1011" class="node">
<title>layer71_act_6</title>
<path fill="#e6f3ff" stroke="black" d="M318,-8727.47C318,-8727.47 48,-8727.47 48,-8727.47 42,-8727.47 36,-8721.47 36,-8715.47 36,-8715.47 36,-8692.47 36,-8692.47 36,-8686.47 42,-8680.47 48,-8680.47 48,-8680.47 318,-8680.47 318,-8680.47 324,-8680.47 330,-8686.47 330,-8692.47 330,-8692.47 330,-8715.47 330,-8715.47 330,-8721.47 324,-8727.47 318,-8727.47"/>
<text text-anchor="middle" x="183" y="-8712.47" font-family="Arial" font-size="10.00">Layer 71 SiLU GPU6</text>
<text text-anchor="middle" x="183" y="-8701.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="183" y="-8690.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer71_ffn1_6&#45;&gt;layer71_act_6 -->
<g id="edge1154" class="edge">
<title>layer71_ffn1_6&#45;&gt;layer71_act_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M183,-8799.41C183,-8781.96 183,-8757.55 183,-8737.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="186.5,-8737.86 183,-8727.86 179.5,-8737.86 186.5,-8737.86"/>
</g>
<!-- layer71_act_7 -->
<g id="node1012" class="node">
<title>layer71_act_7</title>
<path fill="#e6f3ff" stroke="black" d="M648,-8727.47C648,-8727.47 378,-8727.47 378,-8727.47 372,-8727.47 366,-8721.47 366,-8715.47 366,-8715.47 366,-8692.47 366,-8692.47 366,-8686.47 372,-8680.47 378,-8680.47 378,-8680.47 648,-8680.47 648,-8680.47 654,-8680.47 660,-8686.47 660,-8692.47 660,-8692.47 660,-8715.47 660,-8715.47 660,-8721.47 654,-8727.47 648,-8727.47"/>
<text text-anchor="middle" x="513" y="-8712.47" font-family="Arial" font-size="10.00">Layer 71 SiLU GPU7</text>
<text text-anchor="middle" x="513" y="-8701.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="513" y="-8690.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer71_ffn1_7&#45;&gt;layer71_act_7 -->
<g id="edge1155" class="edge">
<title>layer71_ffn1_7&#45;&gt;layer71_act_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M513,-8799.41C513,-8781.96 513,-8757.55 513,-8737.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="516.5,-8737.86 513,-8727.86 509.5,-8737.86 516.5,-8737.86"/>
</g>
<!-- layer71_ffn2_6 -->
<g id="node1013" class="node">
<title>layer71_ffn2_6</title>
<path fill="#e6f3ff" stroke="black" d="M317.5,-8608.47C317.5,-8608.47 54.5,-8608.47 54.5,-8608.47 48.5,-8608.47 42.5,-8602.47 42.5,-8596.47 42.5,-8596.47 42.5,-8573.47 42.5,-8573.47 42.5,-8567.47 48.5,-8561.47 54.5,-8561.47 54.5,-8561.47 317.5,-8561.47 317.5,-8561.47 323.5,-8561.47 329.5,-8567.47 329.5,-8573.47 329.5,-8573.47 329.5,-8596.47 329.5,-8596.47 329.5,-8602.47 323.5,-8608.47 317.5,-8608.47"/>
<text text-anchor="middle" x="186" y="-8593.47" font-family="Arial" font-size="10.00">Layer 71 FFN2 GPU6</text>
<text text-anchor="middle" x="186" y="-8582.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="186" y="-8571.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer71_act_6&#45;&gt;layer71_ffn2_6 -->
<g id="edge1156" class="edge">
<title>layer71_act_6&#45;&gt;layer71_ffn2_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M183.58,-8680.41C184.03,-8662.96 184.65,-8638.55 185.16,-8618.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="188.66,-8618.94 185.41,-8608.86 181.66,-8618.76 188.66,-8618.94"/>
</g>
<!-- layer71_ffn2_7 -->
<g id="node1014" class="node">
<title>layer71_ffn2_7</title>
<path fill="#e6f3ff" stroke="black" d="M642.5,-8608.47C642.5,-8608.47 379.5,-8608.47 379.5,-8608.47 373.5,-8608.47 367.5,-8602.47 367.5,-8596.47 367.5,-8596.47 367.5,-8573.47 367.5,-8573.47 367.5,-8567.47 373.5,-8561.47 379.5,-8561.47 379.5,-8561.47 642.5,-8561.47 642.5,-8561.47 648.5,-8561.47 654.5,-8567.47 654.5,-8573.47 654.5,-8573.47 654.5,-8596.47 654.5,-8596.47 654.5,-8602.47 648.5,-8608.47 642.5,-8608.47"/>
<text text-anchor="middle" x="511" y="-8593.47" font-family="Arial" font-size="10.00">Layer 71 FFN2 GPU7</text>
<text text-anchor="middle" x="511" y="-8582.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="511" y="-8571.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer71_act_7&#45;&gt;layer71_ffn2_7 -->
<g id="edge1157" class="edge">
<title>layer71_act_7&#45;&gt;layer71_ffn2_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M512.61,-8680.41C512.32,-8662.96 511.9,-8638.55 511.56,-8618.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="515.06,-8618.8 511.39,-8608.86 508.06,-8618.92 515.06,-8618.8"/>
</g>
<!-- layer71_ffn_ar -->
<g id="node1015" class="node">
<title>layer71_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M479.22,-8489.47C479.22,-8489.47 273.8,-8489.47 273.8,-8489.47 267.8,-8489.47 258,-8484.83 254.19,-8480.19 254.19,-8480.19 210.39,-8426.75 210.39,-8426.75 206.59,-8422.11 208.78,-8417.47 214.78,-8417.47 214.78,-8417.47 420.2,-8417.47 420.2,-8417.47 426.2,-8417.47 436,-8422.11 439.81,-8426.75 439.81,-8426.75 483.61,-8480.19 483.61,-8480.19 487.41,-8484.83 485.22,-8489.47 479.22,-8489.47"/>
<text text-anchor="middle" x="347" y="-8456.47" font-family="Arial" font-size="10.00">Layer 71 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="347" y="-8445.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer71_ffn2_6&#45;&gt;layer71_ffn_ar -->
<g id="edge1158" class="edge">
<title>layer71_ffn2_6&#45;&gt;layer71_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M214.04,-8561.41C236.43,-8543.41 268.4,-8517.69 295.38,-8495.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="297.61,-8498.68 303.21,-8489.69 293.23,-8493.23 297.61,-8498.68"/>
</g>
<!-- layer71_ffn2_7&#45;&gt;layer71_ffn_ar -->
<g id="edge1159" class="edge">
<title>layer71_ffn2_7&#45;&gt;layer71_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M482.43,-8561.41C459.63,-8543.41 427.06,-8517.69 399.58,-8495.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="401.62,-8493.14 391.6,-8489.69 397.28,-8498.63 401.62,-8493.14"/>
</g>
<!-- layer72_qkv_6 -->
<g id="node1016" class="node">
<title>layer72_qkv_6</title>
<path fill="#e6f3ff" stroke="black" d="M317,-8345.47C317,-8345.47 19,-8345.47 19,-8345.47 13,-8345.47 7,-8339.47 7,-8333.47 7,-8333.47 7,-8310.47 7,-8310.47 7,-8304.47 13,-8298.47 19,-8298.47 19,-8298.47 317,-8298.47 317,-8298.47 323,-8298.47 329,-8304.47 329,-8310.47 329,-8310.47 329,-8333.47 329,-8333.47 329,-8339.47 323,-8345.47 317,-8345.47"/>
<text text-anchor="middle" x="168" y="-8330.47" font-family="Arial" font-size="10.00">Layer 72 QKV Proj GPU6</text>
<text text-anchor="middle" x="168" y="-8319.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="168" y="-8308.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer71_ffn_ar&#45;&gt;layer72_qkv_6 -->
<g id="edge1160" class="edge">
<title>layer71_ffn_ar&#45;&gt;layer72_qkv_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M298.56,-8417.42C270.06,-8396.81 234.48,-8371.06 207.66,-8351.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="209.43,-8348.62 199.28,-8345.6 205.33,-8354.3 209.43,-8348.62"/>
</g>
<!-- layer72_qkv_7 -->
<g id="node1017" class="node">
<title>layer72_qkv_7</title>
<path fill="#e6f3ff" stroke="black" d="M675,-8345.47C675,-8345.47 377,-8345.47 377,-8345.47 371,-8345.47 365,-8339.47 365,-8333.47 365,-8333.47 365,-8310.47 365,-8310.47 365,-8304.47 371,-8298.47 377,-8298.47 377,-8298.47 675,-8298.47 675,-8298.47 681,-8298.47 687,-8304.47 687,-8310.47 687,-8310.47 687,-8333.47 687,-8333.47 687,-8339.47 681,-8345.47 675,-8345.47"/>
<text text-anchor="middle" x="526" y="-8330.47" font-family="Arial" font-size="10.00">Layer 72 QKV Proj GPU7</text>
<text text-anchor="middle" x="526" y="-8319.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="526" y="-8308.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer71_ffn_ar&#45;&gt;layer72_qkv_7 -->
<g id="edge1161" class="edge">
<title>layer71_ffn_ar&#45;&gt;layer72_qkv_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M395.44,-8417.42C423.94,-8396.81 459.52,-8371.06 486.34,-8351.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="488.67,-8354.3 494.72,-8345.6 484.57,-8348.62 488.67,-8354.3"/>
</g>
<!-- layer72_attn_6 -->
<g id="node1018" class="node">
<title>layer72_attn_6</title>
<path fill="#e6f3ff" stroke="black" d="M317,-8226.47C317,-8226.47 19,-8226.47 19,-8226.47 13,-8226.47 7,-8220.47 7,-8214.47 7,-8214.47 7,-8191.47 7,-8191.47 7,-8185.47 13,-8179.47 19,-8179.47 19,-8179.47 317,-8179.47 317,-8179.47 323,-8179.47 329,-8185.47 329,-8191.47 329,-8191.47 329,-8214.47 329,-8214.47 329,-8220.47 323,-8226.47 317,-8226.47"/>
<text text-anchor="middle" x="168" y="-8211.47" font-family="Arial" font-size="10.00">Layer 72 Attention GPU6</text>
<text text-anchor="middle" x="168" y="-8200.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="168" y="-8189.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer72_qkv_6&#45;&gt;layer72_attn_6 -->
<g id="edge1162" class="edge">
<title>layer72_qkv_6&#45;&gt;layer72_attn_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M168,-8298.41C168,-8280.96 168,-8256.55 168,-8236.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="171.5,-8236.86 168,-8226.86 164.5,-8236.86 171.5,-8236.86"/>
</g>
<!-- layer72_attn_7 -->
<g id="node1019" class="node">
<title>layer72_attn_7</title>
<path fill="#e6f3ff" stroke="black" d="M675,-8226.47C675,-8226.47 377,-8226.47 377,-8226.47 371,-8226.47 365,-8220.47 365,-8214.47 365,-8214.47 365,-8191.47 365,-8191.47 365,-8185.47 371,-8179.47 377,-8179.47 377,-8179.47 675,-8179.47 675,-8179.47 681,-8179.47 687,-8185.47 687,-8191.47 687,-8191.47 687,-8214.47 687,-8214.47 687,-8220.47 681,-8226.47 675,-8226.47"/>
<text text-anchor="middle" x="526" y="-8211.47" font-family="Arial" font-size="10.00">Layer 72 Attention GPU7</text>
<text text-anchor="middle" x="526" y="-8200.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="526" y="-8189.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer72_qkv_7&#45;&gt;layer72_attn_7 -->
<g id="edge1163" class="edge">
<title>layer72_qkv_7&#45;&gt;layer72_attn_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M526,-8298.41C526,-8280.96 526,-8256.55 526,-8236.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="529.5,-8236.86 526,-8226.86 522.5,-8236.86 529.5,-8236.86"/>
</g>
<!-- layer72_attn_out_6 -->
<g id="node1020" class="node">
<title>layer72_attn_out_6</title>
<path fill="#e6f3ff" stroke="black" d="M317,-8107.47C317,-8107.47 27,-8107.47 27,-8107.47 21,-8107.47 15,-8101.47 15,-8095.47 15,-8095.47 15,-8072.47 15,-8072.47 15,-8066.47 21,-8060.47 27,-8060.47 27,-8060.47 317,-8060.47 317,-8060.47 323,-8060.47 329,-8066.47 329,-8072.47 329,-8072.47 329,-8095.47 329,-8095.47 329,-8101.47 323,-8107.47 317,-8107.47"/>
<text text-anchor="middle" x="172" y="-8092.47" font-family="Arial" font-size="10.00">Layer 72 Attn Out GPU6</text>
<text text-anchor="middle" x="172" y="-8081.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="172" y="-8070.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer72_attn_6&#45;&gt;layer72_attn_out_6 -->
<g id="edge1164" class="edge">
<title>layer72_attn_6&#45;&gt;layer72_attn_out_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M168.77,-8179.41C169.37,-8161.96 170.2,-8137.55 170.87,-8117.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="174.37,-8117.97 171.22,-8107.86 167.38,-8117.73 174.37,-8117.97"/>
</g>
<!-- layer72_attn_out_7 -->
<g id="node1021" class="node">
<title>layer72_attn_out_7</title>
<path fill="#e6f3ff" stroke="black" d="M669,-8107.47C669,-8107.47 379,-8107.47 379,-8107.47 373,-8107.47 367,-8101.47 367,-8095.47 367,-8095.47 367,-8072.47 367,-8072.47 367,-8066.47 373,-8060.47 379,-8060.47 379,-8060.47 669,-8060.47 669,-8060.47 675,-8060.47 681,-8066.47 681,-8072.47 681,-8072.47 681,-8095.47 681,-8095.47 681,-8101.47 675,-8107.47 669,-8107.47"/>
<text text-anchor="middle" x="524" y="-8092.47" font-family="Arial" font-size="10.00">Layer 72 Attn Out GPU7</text>
<text text-anchor="middle" x="524" y="-8081.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="524" y="-8070.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer72_attn_7&#45;&gt;layer72_attn_out_7 -->
<g id="edge1165" class="edge">
<title>layer72_attn_7&#45;&gt;layer72_attn_out_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M525.61,-8179.41C525.32,-8161.96 524.9,-8137.55 524.56,-8117.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="528.06,-8117.8 524.39,-8107.86 521.06,-8117.92 528.06,-8117.8"/>
</g>
<!-- layer72_attn_ar -->
<g id="node1022" class="node">
<title>layer72_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M477.07,-7988.47C477.07,-7988.47 275.07,-7988.47 275.07,-7988.47 269.07,-7988.47 259.3,-7983.8 255.53,-7979.13 255.53,-7979.13 212.47,-7925.8 212.47,-7925.8 208.7,-7921.14 210.93,-7916.47 216.93,-7916.47 216.93,-7916.47 418.93,-7916.47 418.93,-7916.47 424.93,-7916.47 434.7,-7921.14 438.47,-7925.8 438.47,-7925.8 481.53,-7979.13 481.53,-7979.13 485.3,-7983.8 483.07,-7988.47 477.07,-7988.47"/>
<text text-anchor="middle" x="347" y="-7955.47" font-family="Arial" font-size="10.00">Layer 72 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="347" y="-7944.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer72_attn_out_6&#45;&gt;layer72_attn_ar -->
<g id="edge1166" class="edge">
<title>layer72_attn_out_6&#45;&gt;layer72_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M202.48,-8060.41C226.92,-8042.33 261.86,-8016.47 291.27,-7994.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="293.45,-7997.45 299.4,-7988.69 289.28,-7991.82 293.45,-7997.45"/>
</g>
<!-- layer72_attn_out_7&#45;&gt;layer72_attn_ar -->
<g id="edge1167" class="edge">
<title>layer72_attn_out_7&#45;&gt;layer72_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M493.17,-8060.41C468.45,-8042.33 433.11,-8016.47 403.37,-7994.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="405.28,-7991.77 395.14,-7988.69 401.14,-7997.42 405.28,-7991.77"/>
</g>
<!-- layer72_ffn1_6 -->
<g id="node1023" class="node">
<title>layer72_ffn1_6</title>
<path fill="#e6f3ff" stroke="black" d="M317,-7844.47C317,-7844.47 47,-7844.47 47,-7844.47 41,-7844.47 35,-7838.47 35,-7832.47 35,-7832.47 35,-7809.47 35,-7809.47 35,-7803.47 41,-7797.47 47,-7797.47 47,-7797.47 317,-7797.47 317,-7797.47 323,-7797.47 329,-7803.47 329,-7809.47 329,-7809.47 329,-7832.47 329,-7832.47 329,-7838.47 323,-7844.47 317,-7844.47"/>
<text text-anchor="middle" x="182" y="-7829.47" font-family="Arial" font-size="10.00">Layer 72 FFN1 GPU6</text>
<text text-anchor="middle" x="182" y="-7818.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="182" y="-7807.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer72_attn_ar&#45;&gt;layer72_ffn1_6 -->
<g id="edge1168" class="edge">
<title>layer72_attn_ar&#45;&gt;layer72_ffn1_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M302.35,-7916.42C276.28,-7895.96 243.78,-7870.45 219.12,-7851.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="221.11,-7848.21 211.08,-7844.79 216.79,-7853.72 221.11,-7848.21"/>
</g>
<!-- layer72_ffn1_7 -->
<g id="node1024" class="node">
<title>layer72_ffn1_7</title>
<path fill="#e6f3ff" stroke="black" d="M647,-7844.47C647,-7844.47 377,-7844.47 377,-7844.47 371,-7844.47 365,-7838.47 365,-7832.47 365,-7832.47 365,-7809.47 365,-7809.47 365,-7803.47 371,-7797.47 377,-7797.47 377,-7797.47 647,-7797.47 647,-7797.47 653,-7797.47 659,-7803.47 659,-7809.47 659,-7809.47 659,-7832.47 659,-7832.47 659,-7838.47 653,-7844.47 647,-7844.47"/>
<text text-anchor="middle" x="512" y="-7829.47" font-family="Arial" font-size="10.00">Layer 72 FFN1 GPU7</text>
<text text-anchor="middle" x="512" y="-7818.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="512" y="-7807.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer72_attn_ar&#45;&gt;layer72_ffn1_7 -->
<g id="edge1169" class="edge">
<title>layer72_attn_ar&#45;&gt;layer72_ffn1_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M391.65,-7916.42C417.72,-7895.96 450.22,-7870.45 474.88,-7851.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="477.21,-7853.72 482.92,-7844.79 472.89,-7848.21 477.21,-7853.72"/>
</g>
<!-- layer72_act_6 -->
<g id="node1025" class="node">
<title>layer72_act_6</title>
<path fill="#e6f3ff" stroke="black" d="M317,-7725.47C317,-7725.47 47,-7725.47 47,-7725.47 41,-7725.47 35,-7719.47 35,-7713.47 35,-7713.47 35,-7690.47 35,-7690.47 35,-7684.47 41,-7678.47 47,-7678.47 47,-7678.47 317,-7678.47 317,-7678.47 323,-7678.47 329,-7684.47 329,-7690.47 329,-7690.47 329,-7713.47 329,-7713.47 329,-7719.47 323,-7725.47 317,-7725.47"/>
<text text-anchor="middle" x="182" y="-7710.47" font-family="Arial" font-size="10.00">Layer 72 SiLU GPU6</text>
<text text-anchor="middle" x="182" y="-7699.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="182" y="-7688.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer72_ffn1_6&#45;&gt;layer72_act_6 -->
<g id="edge1170" class="edge">
<title>layer72_ffn1_6&#45;&gt;layer72_act_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M182,-7797.41C182,-7779.96 182,-7755.55 182,-7735.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="185.5,-7735.86 182,-7725.86 178.5,-7735.86 185.5,-7735.86"/>
</g>
<!-- layer72_act_7 -->
<g id="node1026" class="node">
<title>layer72_act_7</title>
<path fill="#e6f3ff" stroke="black" d="M647,-7725.47C647,-7725.47 377,-7725.47 377,-7725.47 371,-7725.47 365,-7719.47 365,-7713.47 365,-7713.47 365,-7690.47 365,-7690.47 365,-7684.47 371,-7678.47 377,-7678.47 377,-7678.47 647,-7678.47 647,-7678.47 653,-7678.47 659,-7684.47 659,-7690.47 659,-7690.47 659,-7713.47 659,-7713.47 659,-7719.47 653,-7725.47 647,-7725.47"/>
<text text-anchor="middle" x="512" y="-7710.47" font-family="Arial" font-size="10.00">Layer 72 SiLU GPU7</text>
<text text-anchor="middle" x="512" y="-7699.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="512" y="-7688.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer72_ffn1_7&#45;&gt;layer72_act_7 -->
<g id="edge1171" class="edge">
<title>layer72_ffn1_7&#45;&gt;layer72_act_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M512,-7797.41C512,-7779.96 512,-7755.55 512,-7735.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="515.5,-7735.86 512,-7725.86 508.5,-7735.86 515.5,-7735.86"/>
</g>
<!-- layer72_ffn2_6 -->
<g id="node1027" class="node">
<title>layer72_ffn2_6</title>
<path fill="#e6f3ff" stroke="black" d="M316.5,-7606.47C316.5,-7606.47 53.5,-7606.47 53.5,-7606.47 47.5,-7606.47 41.5,-7600.47 41.5,-7594.47 41.5,-7594.47 41.5,-7571.47 41.5,-7571.47 41.5,-7565.47 47.5,-7559.47 53.5,-7559.47 53.5,-7559.47 316.5,-7559.47 316.5,-7559.47 322.5,-7559.47 328.5,-7565.47 328.5,-7571.47 328.5,-7571.47 328.5,-7594.47 328.5,-7594.47 328.5,-7600.47 322.5,-7606.47 316.5,-7606.47"/>
<text text-anchor="middle" x="185" y="-7591.47" font-family="Arial" font-size="10.00">Layer 72 FFN2 GPU6</text>
<text text-anchor="middle" x="185" y="-7580.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="185" y="-7569.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer72_act_6&#45;&gt;layer72_ffn2_6 -->
<g id="edge1172" class="edge">
<title>layer72_act_6&#45;&gt;layer72_ffn2_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M182.58,-7678.41C183.03,-7660.96 183.65,-7636.55 184.16,-7616.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="187.66,-7616.94 184.41,-7606.86 180.66,-7616.76 187.66,-7616.94"/>
</g>
<!-- layer72_ffn2_7 -->
<g id="node1028" class="node">
<title>layer72_ffn2_7</title>
<path fill="#e6f3ff" stroke="black" d="M641.5,-7606.47C641.5,-7606.47 378.5,-7606.47 378.5,-7606.47 372.5,-7606.47 366.5,-7600.47 366.5,-7594.47 366.5,-7594.47 366.5,-7571.47 366.5,-7571.47 366.5,-7565.47 372.5,-7559.47 378.5,-7559.47 378.5,-7559.47 641.5,-7559.47 641.5,-7559.47 647.5,-7559.47 653.5,-7565.47 653.5,-7571.47 653.5,-7571.47 653.5,-7594.47 653.5,-7594.47 653.5,-7600.47 647.5,-7606.47 641.5,-7606.47"/>
<text text-anchor="middle" x="510" y="-7591.47" font-family="Arial" font-size="10.00">Layer 72 FFN2 GPU7</text>
<text text-anchor="middle" x="510" y="-7580.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="510" y="-7569.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer72_act_7&#45;&gt;layer72_ffn2_7 -->
<g id="edge1173" class="edge">
<title>layer72_act_7&#45;&gt;layer72_ffn2_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M511.61,-7678.41C511.32,-7660.96 510.9,-7636.55 510.56,-7616.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="514.06,-7616.8 510.39,-7606.86 507.06,-7616.92 514.06,-7616.8"/>
</g>
<!-- layer72_ffn_ar -->
<g id="node1029" class="node">
<title>layer72_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M478.22,-7487.47C478.22,-7487.47 272.8,-7487.47 272.8,-7487.47 266.8,-7487.47 257,-7482.83 253.19,-7478.19 253.19,-7478.19 209.39,-7424.75 209.39,-7424.75 205.59,-7420.11 207.78,-7415.47 213.78,-7415.47 213.78,-7415.47 419.2,-7415.47 419.2,-7415.47 425.2,-7415.47 435,-7420.11 438.81,-7424.75 438.81,-7424.75 482.61,-7478.19 482.61,-7478.19 486.41,-7482.83 484.22,-7487.47 478.22,-7487.47"/>
<text text-anchor="middle" x="346" y="-7454.47" font-family="Arial" font-size="10.00">Layer 72 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="346" y="-7443.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer72_ffn2_6&#45;&gt;layer72_ffn_ar -->
<g id="edge1174" class="edge">
<title>layer72_ffn2_6&#45;&gt;layer72_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M213.04,-7559.41C235.43,-7541.41 267.4,-7515.69 294.38,-7493.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="296.61,-7496.68 302.21,-7487.69 292.23,-7491.23 296.61,-7496.68"/>
</g>
<!-- layer72_ffn2_7&#45;&gt;layer72_ffn_ar -->
<g id="edge1175" class="edge">
<title>layer72_ffn2_7&#45;&gt;layer72_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M481.43,-7559.41C458.63,-7541.41 426.06,-7515.69 398.58,-7493.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="400.62,-7491.14 390.6,-7487.69 396.28,-7496.63 400.62,-7491.14"/>
</g>
<!-- layer73_qkv_6 -->
<g id="node1030" class="node">
<title>layer73_qkv_6</title>
<path fill="#e6f3ff" stroke="black" d="M316,-7343.47C316,-7343.47 18,-7343.47 18,-7343.47 12,-7343.47 6,-7337.47 6,-7331.47 6,-7331.47 6,-7308.47 6,-7308.47 6,-7302.47 12,-7296.47 18,-7296.47 18,-7296.47 316,-7296.47 316,-7296.47 322,-7296.47 328,-7302.47 328,-7308.47 328,-7308.47 328,-7331.47 328,-7331.47 328,-7337.47 322,-7343.47 316,-7343.47"/>
<text text-anchor="middle" x="167" y="-7328.47" font-family="Arial" font-size="10.00">Layer 73 QKV Proj GPU6</text>
<text text-anchor="middle" x="167" y="-7317.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="167" y="-7306.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer72_ffn_ar&#45;&gt;layer73_qkv_6 -->
<g id="edge1176" class="edge">
<title>layer72_ffn_ar&#45;&gt;layer73_qkv_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M297.56,-7415.42C269.06,-7394.81 233.48,-7369.06 206.66,-7349.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="208.43,-7346.62 198.28,-7343.6 204.33,-7352.3 208.43,-7346.62"/>
</g>
<!-- layer73_qkv_7 -->
<g id="node1031" class="node">
<title>layer73_qkv_7</title>
<path fill="#e6f3ff" stroke="black" d="M674,-7343.47C674,-7343.47 376,-7343.47 376,-7343.47 370,-7343.47 364,-7337.47 364,-7331.47 364,-7331.47 364,-7308.47 364,-7308.47 364,-7302.47 370,-7296.47 376,-7296.47 376,-7296.47 674,-7296.47 674,-7296.47 680,-7296.47 686,-7302.47 686,-7308.47 686,-7308.47 686,-7331.47 686,-7331.47 686,-7337.47 680,-7343.47 674,-7343.47"/>
<text text-anchor="middle" x="525" y="-7328.47" font-family="Arial" font-size="10.00">Layer 73 QKV Proj GPU7</text>
<text text-anchor="middle" x="525" y="-7317.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="525" y="-7306.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer72_ffn_ar&#45;&gt;layer73_qkv_7 -->
<g id="edge1177" class="edge">
<title>layer72_ffn_ar&#45;&gt;layer73_qkv_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M394.44,-7415.42C422.94,-7394.81 458.52,-7369.06 485.34,-7349.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="487.67,-7352.3 493.72,-7343.6 483.57,-7346.62 487.67,-7352.3"/>
</g>
<!-- layer73_attn_6 -->
<g id="node1032" class="node">
<title>layer73_attn_6</title>
<path fill="#e6f3ff" stroke="black" d="M316,-7224.47C316,-7224.47 18,-7224.47 18,-7224.47 12,-7224.47 6,-7218.47 6,-7212.47 6,-7212.47 6,-7189.47 6,-7189.47 6,-7183.47 12,-7177.47 18,-7177.47 18,-7177.47 316,-7177.47 316,-7177.47 322,-7177.47 328,-7183.47 328,-7189.47 328,-7189.47 328,-7212.47 328,-7212.47 328,-7218.47 322,-7224.47 316,-7224.47"/>
<text text-anchor="middle" x="167" y="-7209.47" font-family="Arial" font-size="10.00">Layer 73 Attention GPU6</text>
<text text-anchor="middle" x="167" y="-7198.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="167" y="-7187.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer73_qkv_6&#45;&gt;layer73_attn_6 -->
<g id="edge1178" class="edge">
<title>layer73_qkv_6&#45;&gt;layer73_attn_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M167,-7296.41C167,-7278.96 167,-7254.55 167,-7234.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="170.5,-7234.86 167,-7224.86 163.5,-7234.86 170.5,-7234.86"/>
</g>
<!-- layer73_attn_7 -->
<g id="node1033" class="node">
<title>layer73_attn_7</title>
<path fill="#e6f3ff" stroke="black" d="M674,-7224.47C674,-7224.47 376,-7224.47 376,-7224.47 370,-7224.47 364,-7218.47 364,-7212.47 364,-7212.47 364,-7189.47 364,-7189.47 364,-7183.47 370,-7177.47 376,-7177.47 376,-7177.47 674,-7177.47 674,-7177.47 680,-7177.47 686,-7183.47 686,-7189.47 686,-7189.47 686,-7212.47 686,-7212.47 686,-7218.47 680,-7224.47 674,-7224.47"/>
<text text-anchor="middle" x="525" y="-7209.47" font-family="Arial" font-size="10.00">Layer 73 Attention GPU7</text>
<text text-anchor="middle" x="525" y="-7198.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="525" y="-7187.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer73_qkv_7&#45;&gt;layer73_attn_7 -->
<g id="edge1179" class="edge">
<title>layer73_qkv_7&#45;&gt;layer73_attn_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M525,-7296.41C525,-7278.96 525,-7254.55 525,-7234.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="528.5,-7234.86 525,-7224.86 521.5,-7234.86 528.5,-7234.86"/>
</g>
<!-- layer73_attn_out_6 -->
<g id="node1034" class="node">
<title>layer73_attn_out_6</title>
<path fill="#e6f3ff" stroke="black" d="M316,-7105.47C316,-7105.47 26,-7105.47 26,-7105.47 20,-7105.47 14,-7099.47 14,-7093.47 14,-7093.47 14,-7070.47 14,-7070.47 14,-7064.47 20,-7058.47 26,-7058.47 26,-7058.47 316,-7058.47 316,-7058.47 322,-7058.47 328,-7064.47 328,-7070.47 328,-7070.47 328,-7093.47 328,-7093.47 328,-7099.47 322,-7105.47 316,-7105.47"/>
<text text-anchor="middle" x="171" y="-7090.47" font-family="Arial" font-size="10.00">Layer 73 Attn Out GPU6</text>
<text text-anchor="middle" x="171" y="-7079.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="171" y="-7068.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer73_attn_6&#45;&gt;layer73_attn_out_6 -->
<g id="edge1180" class="edge">
<title>layer73_attn_6&#45;&gt;layer73_attn_out_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M167.77,-7177.41C168.37,-7159.96 169.2,-7135.55 169.87,-7115.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="173.37,-7115.97 170.22,-7105.86 166.38,-7115.73 173.37,-7115.97"/>
</g>
<!-- layer73_attn_out_7 -->
<g id="node1035" class="node">
<title>layer73_attn_out_7</title>
<path fill="#e6f3ff" stroke="black" d="M668,-7105.47C668,-7105.47 378,-7105.47 378,-7105.47 372,-7105.47 366,-7099.47 366,-7093.47 366,-7093.47 366,-7070.47 366,-7070.47 366,-7064.47 372,-7058.47 378,-7058.47 378,-7058.47 668,-7058.47 668,-7058.47 674,-7058.47 680,-7064.47 680,-7070.47 680,-7070.47 680,-7093.47 680,-7093.47 680,-7099.47 674,-7105.47 668,-7105.47"/>
<text text-anchor="middle" x="523" y="-7090.47" font-family="Arial" font-size="10.00">Layer 73 Attn Out GPU7</text>
<text text-anchor="middle" x="523" y="-7079.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="523" y="-7068.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer73_attn_7&#45;&gt;layer73_attn_out_7 -->
<g id="edge1181" class="edge">
<title>layer73_attn_7&#45;&gt;layer73_attn_out_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M524.61,-7177.41C524.32,-7159.96 523.9,-7135.55 523.56,-7115.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="527.06,-7115.8 523.39,-7105.86 520.06,-7115.92 527.06,-7115.8"/>
</g>
<!-- layer73_attn_ar -->
<g id="node1036" class="node">
<title>layer73_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M476.07,-6986.47C476.07,-6986.47 274.07,-6986.47 274.07,-6986.47 268.07,-6986.47 258.3,-6981.8 254.53,-6977.13 254.53,-6977.13 211.47,-6923.8 211.47,-6923.8 207.7,-6919.14 209.93,-6914.47 215.93,-6914.47 215.93,-6914.47 417.93,-6914.47 417.93,-6914.47 423.93,-6914.47 433.7,-6919.14 437.47,-6923.8 437.47,-6923.8 480.53,-6977.13 480.53,-6977.13 484.3,-6981.8 482.07,-6986.47 476.07,-6986.47"/>
<text text-anchor="middle" x="346" y="-6953.47" font-family="Arial" font-size="10.00">Layer 73 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="346" y="-6942.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer73_attn_out_6&#45;&gt;layer73_attn_ar -->
<g id="edge1182" class="edge">
<title>layer73_attn_out_6&#45;&gt;layer73_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M201.48,-7058.41C225.92,-7040.33 260.86,-7014.47 290.27,-6992.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="292.45,-6995.45 298.4,-6986.69 288.28,-6989.82 292.45,-6995.45"/>
</g>
<!-- layer73_attn_out_7&#45;&gt;layer73_attn_ar -->
<g id="edge1183" class="edge">
<title>layer73_attn_out_7&#45;&gt;layer73_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M492.17,-7058.41C467.45,-7040.33 432.11,-7014.47 402.37,-6992.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="404.28,-6989.77 394.14,-6986.69 400.14,-6995.42 404.28,-6989.77"/>
</g>
<!-- layer73_ffn1_6 -->
<g id="node1037" class="node">
<title>layer73_ffn1_6</title>
<path fill="#e6f3ff" stroke="black" d="M316,-6842.47C316,-6842.47 46,-6842.47 46,-6842.47 40,-6842.47 34,-6836.47 34,-6830.47 34,-6830.47 34,-6807.47 34,-6807.47 34,-6801.47 40,-6795.47 46,-6795.47 46,-6795.47 316,-6795.47 316,-6795.47 322,-6795.47 328,-6801.47 328,-6807.47 328,-6807.47 328,-6830.47 328,-6830.47 328,-6836.47 322,-6842.47 316,-6842.47"/>
<text text-anchor="middle" x="181" y="-6827.47" font-family="Arial" font-size="10.00">Layer 73 FFN1 GPU6</text>
<text text-anchor="middle" x="181" y="-6816.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="181" y="-6805.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer73_attn_ar&#45;&gt;layer73_ffn1_6 -->
<g id="edge1184" class="edge">
<title>layer73_attn_ar&#45;&gt;layer73_ffn1_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M301.35,-6914.42C275.28,-6893.96 242.78,-6868.45 218.12,-6849.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="220.11,-6846.21 210.08,-6842.79 215.79,-6851.72 220.11,-6846.21"/>
</g>
<!-- layer73_ffn1_7 -->
<g id="node1038" class="node">
<title>layer73_ffn1_7</title>
<path fill="#e6f3ff" stroke="black" d="M646,-6842.47C646,-6842.47 376,-6842.47 376,-6842.47 370,-6842.47 364,-6836.47 364,-6830.47 364,-6830.47 364,-6807.47 364,-6807.47 364,-6801.47 370,-6795.47 376,-6795.47 376,-6795.47 646,-6795.47 646,-6795.47 652,-6795.47 658,-6801.47 658,-6807.47 658,-6807.47 658,-6830.47 658,-6830.47 658,-6836.47 652,-6842.47 646,-6842.47"/>
<text text-anchor="middle" x="511" y="-6827.47" font-family="Arial" font-size="10.00">Layer 73 FFN1 GPU7</text>
<text text-anchor="middle" x="511" y="-6816.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="511" y="-6805.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer73_attn_ar&#45;&gt;layer73_ffn1_7 -->
<g id="edge1185" class="edge">
<title>layer73_attn_ar&#45;&gt;layer73_ffn1_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M390.65,-6914.42C416.72,-6893.96 449.22,-6868.45 473.88,-6849.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="476.21,-6851.72 481.92,-6842.79 471.89,-6846.21 476.21,-6851.72"/>
</g>
<!-- layer73_act_6 -->
<g id="node1039" class="node">
<title>layer73_act_6</title>
<path fill="#e6f3ff" stroke="black" d="M316,-6723.47C316,-6723.47 46,-6723.47 46,-6723.47 40,-6723.47 34,-6717.47 34,-6711.47 34,-6711.47 34,-6688.47 34,-6688.47 34,-6682.47 40,-6676.47 46,-6676.47 46,-6676.47 316,-6676.47 316,-6676.47 322,-6676.47 328,-6682.47 328,-6688.47 328,-6688.47 328,-6711.47 328,-6711.47 328,-6717.47 322,-6723.47 316,-6723.47"/>
<text text-anchor="middle" x="181" y="-6708.47" font-family="Arial" font-size="10.00">Layer 73 SiLU GPU6</text>
<text text-anchor="middle" x="181" y="-6697.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="181" y="-6686.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer73_ffn1_6&#45;&gt;layer73_act_6 -->
<g id="edge1186" class="edge">
<title>layer73_ffn1_6&#45;&gt;layer73_act_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M181,-6795.41C181,-6777.96 181,-6753.55 181,-6733.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="184.5,-6733.86 181,-6723.86 177.5,-6733.86 184.5,-6733.86"/>
</g>
<!-- layer73_act_7 -->
<g id="node1040" class="node">
<title>layer73_act_7</title>
<path fill="#e6f3ff" stroke="black" d="M646,-6723.47C646,-6723.47 376,-6723.47 376,-6723.47 370,-6723.47 364,-6717.47 364,-6711.47 364,-6711.47 364,-6688.47 364,-6688.47 364,-6682.47 370,-6676.47 376,-6676.47 376,-6676.47 646,-6676.47 646,-6676.47 652,-6676.47 658,-6682.47 658,-6688.47 658,-6688.47 658,-6711.47 658,-6711.47 658,-6717.47 652,-6723.47 646,-6723.47"/>
<text text-anchor="middle" x="511" y="-6708.47" font-family="Arial" font-size="10.00">Layer 73 SiLU GPU7</text>
<text text-anchor="middle" x="511" y="-6697.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="511" y="-6686.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer73_ffn1_7&#45;&gt;layer73_act_7 -->
<g id="edge1187" class="edge">
<title>layer73_ffn1_7&#45;&gt;layer73_act_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M511,-6795.41C511,-6777.96 511,-6753.55 511,-6733.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="514.5,-6733.86 511,-6723.86 507.5,-6733.86 514.5,-6733.86"/>
</g>
<!-- layer73_ffn2_6 -->
<g id="node1041" class="node">
<title>layer73_ffn2_6</title>
<path fill="#e6f3ff" stroke="black" d="M315.5,-6604.47C315.5,-6604.47 52.5,-6604.47 52.5,-6604.47 46.5,-6604.47 40.5,-6598.47 40.5,-6592.47 40.5,-6592.47 40.5,-6569.47 40.5,-6569.47 40.5,-6563.47 46.5,-6557.47 52.5,-6557.47 52.5,-6557.47 315.5,-6557.47 315.5,-6557.47 321.5,-6557.47 327.5,-6563.47 327.5,-6569.47 327.5,-6569.47 327.5,-6592.47 327.5,-6592.47 327.5,-6598.47 321.5,-6604.47 315.5,-6604.47"/>
<text text-anchor="middle" x="184" y="-6589.47" font-family="Arial" font-size="10.00">Layer 73 FFN2 GPU6</text>
<text text-anchor="middle" x="184" y="-6578.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="184" y="-6567.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer73_act_6&#45;&gt;layer73_ffn2_6 -->
<g id="edge1188" class="edge">
<title>layer73_act_6&#45;&gt;layer73_ffn2_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M181.58,-6676.41C182.03,-6658.96 182.65,-6634.55 183.16,-6614.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="186.66,-6614.94 183.41,-6604.86 179.66,-6614.76 186.66,-6614.94"/>
</g>
<!-- layer73_ffn2_7 -->
<g id="node1042" class="node">
<title>layer73_ffn2_7</title>
<path fill="#e6f3ff" stroke="black" d="M640.5,-6604.47C640.5,-6604.47 377.5,-6604.47 377.5,-6604.47 371.5,-6604.47 365.5,-6598.47 365.5,-6592.47 365.5,-6592.47 365.5,-6569.47 365.5,-6569.47 365.5,-6563.47 371.5,-6557.47 377.5,-6557.47 377.5,-6557.47 640.5,-6557.47 640.5,-6557.47 646.5,-6557.47 652.5,-6563.47 652.5,-6569.47 652.5,-6569.47 652.5,-6592.47 652.5,-6592.47 652.5,-6598.47 646.5,-6604.47 640.5,-6604.47"/>
<text text-anchor="middle" x="509" y="-6589.47" font-family="Arial" font-size="10.00">Layer 73 FFN2 GPU7</text>
<text text-anchor="middle" x="509" y="-6578.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="509" y="-6567.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer73_act_7&#45;&gt;layer73_ffn2_7 -->
<g id="edge1189" class="edge">
<title>layer73_act_7&#45;&gt;layer73_ffn2_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M510.61,-6676.41C510.32,-6658.96 509.9,-6634.55 509.56,-6614.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="513.06,-6614.8 509.39,-6604.86 506.06,-6614.92 513.06,-6614.8"/>
</g>
<!-- layer73_ffn_ar -->
<g id="node1043" class="node">
<title>layer73_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M477.22,-6485.47C477.22,-6485.47 271.8,-6485.47 271.8,-6485.47 265.8,-6485.47 256,-6480.83 252.19,-6476.19 252.19,-6476.19 208.39,-6422.75 208.39,-6422.75 204.59,-6418.11 206.78,-6413.47 212.78,-6413.47 212.78,-6413.47 418.2,-6413.47 418.2,-6413.47 424.2,-6413.47 434,-6418.11 437.81,-6422.75 437.81,-6422.75 481.61,-6476.19 481.61,-6476.19 485.41,-6480.83 483.22,-6485.47 477.22,-6485.47"/>
<text text-anchor="middle" x="345" y="-6452.47" font-family="Arial" font-size="10.00">Layer 73 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="345" y="-6441.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer73_ffn2_6&#45;&gt;layer73_ffn_ar -->
<g id="edge1190" class="edge">
<title>layer73_ffn2_6&#45;&gt;layer73_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M212.04,-6557.41C234.43,-6539.41 266.4,-6513.69 293.38,-6491.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="295.61,-6494.68 301.21,-6485.69 291.23,-6489.23 295.61,-6494.68"/>
</g>
<!-- layer73_ffn2_7&#45;&gt;layer73_ffn_ar -->
<g id="edge1191" class="edge">
<title>layer73_ffn2_7&#45;&gt;layer73_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M480.43,-6557.41C457.63,-6539.41 425.06,-6513.69 397.58,-6491.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="399.62,-6489.14 389.6,-6485.69 395.28,-6494.63 399.62,-6489.14"/>
</g>
<!-- layer74_qkv_6 -->
<g id="node1044" class="node">
<title>layer74_qkv_6</title>
<path fill="#e6f3ff" stroke="black" d="M315,-6341.47C315,-6341.47 17,-6341.47 17,-6341.47 11,-6341.47 5,-6335.47 5,-6329.47 5,-6329.47 5,-6306.47 5,-6306.47 5,-6300.47 11,-6294.47 17,-6294.47 17,-6294.47 315,-6294.47 315,-6294.47 321,-6294.47 327,-6300.47 327,-6306.47 327,-6306.47 327,-6329.47 327,-6329.47 327,-6335.47 321,-6341.47 315,-6341.47"/>
<text text-anchor="middle" x="166" y="-6326.47" font-family="Arial" font-size="10.00">Layer 74 QKV Proj GPU6</text>
<text text-anchor="middle" x="166" y="-6315.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="166" y="-6304.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer73_ffn_ar&#45;&gt;layer74_qkv_6 -->
<g id="edge1192" class="edge">
<title>layer73_ffn_ar&#45;&gt;layer74_qkv_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M296.56,-6413.42C268.06,-6392.81 232.48,-6367.06 205.66,-6347.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="207.43,-6344.62 197.28,-6341.6 203.33,-6350.3 207.43,-6344.62"/>
</g>
<!-- layer74_qkv_7 -->
<g id="node1045" class="node">
<title>layer74_qkv_7</title>
<path fill="#e6f3ff" stroke="black" d="M673,-6341.47C673,-6341.47 375,-6341.47 375,-6341.47 369,-6341.47 363,-6335.47 363,-6329.47 363,-6329.47 363,-6306.47 363,-6306.47 363,-6300.47 369,-6294.47 375,-6294.47 375,-6294.47 673,-6294.47 673,-6294.47 679,-6294.47 685,-6300.47 685,-6306.47 685,-6306.47 685,-6329.47 685,-6329.47 685,-6335.47 679,-6341.47 673,-6341.47"/>
<text text-anchor="middle" x="524" y="-6326.47" font-family="Arial" font-size="10.00">Layer 74 QKV Proj GPU7</text>
<text text-anchor="middle" x="524" y="-6315.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="524" y="-6304.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer73_ffn_ar&#45;&gt;layer74_qkv_7 -->
<g id="edge1193" class="edge">
<title>layer73_ffn_ar&#45;&gt;layer74_qkv_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M393.44,-6413.42C421.94,-6392.81 457.52,-6367.06 484.34,-6347.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="486.67,-6350.3 492.72,-6341.6 482.57,-6344.62 486.67,-6350.3"/>
</g>
<!-- layer74_attn_6 -->
<g id="node1046" class="node">
<title>layer74_attn_6</title>
<path fill="#e6f3ff" stroke="black" d="M315,-6222.47C315,-6222.47 17,-6222.47 17,-6222.47 11,-6222.47 5,-6216.47 5,-6210.47 5,-6210.47 5,-6187.47 5,-6187.47 5,-6181.47 11,-6175.47 17,-6175.47 17,-6175.47 315,-6175.47 315,-6175.47 321,-6175.47 327,-6181.47 327,-6187.47 327,-6187.47 327,-6210.47 327,-6210.47 327,-6216.47 321,-6222.47 315,-6222.47"/>
<text text-anchor="middle" x="166" y="-6207.47" font-family="Arial" font-size="10.00">Layer 74 Attention GPU6</text>
<text text-anchor="middle" x="166" y="-6196.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="166" y="-6185.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer74_qkv_6&#45;&gt;layer74_attn_6 -->
<g id="edge1194" class="edge">
<title>layer74_qkv_6&#45;&gt;layer74_attn_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M166,-6294.41C166,-6276.96 166,-6252.55 166,-6232.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="169.5,-6232.86 166,-6222.86 162.5,-6232.86 169.5,-6232.86"/>
</g>
<!-- layer74_attn_7 -->
<g id="node1047" class="node">
<title>layer74_attn_7</title>
<path fill="#e6f3ff" stroke="black" d="M673,-6222.47C673,-6222.47 375,-6222.47 375,-6222.47 369,-6222.47 363,-6216.47 363,-6210.47 363,-6210.47 363,-6187.47 363,-6187.47 363,-6181.47 369,-6175.47 375,-6175.47 375,-6175.47 673,-6175.47 673,-6175.47 679,-6175.47 685,-6181.47 685,-6187.47 685,-6187.47 685,-6210.47 685,-6210.47 685,-6216.47 679,-6222.47 673,-6222.47"/>
<text text-anchor="middle" x="524" y="-6207.47" font-family="Arial" font-size="10.00">Layer 74 Attention GPU7</text>
<text text-anchor="middle" x="524" y="-6196.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="524" y="-6185.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer74_qkv_7&#45;&gt;layer74_attn_7 -->
<g id="edge1195" class="edge">
<title>layer74_qkv_7&#45;&gt;layer74_attn_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M524,-6294.41C524,-6276.96 524,-6252.55 524,-6232.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="527.5,-6232.86 524,-6222.86 520.5,-6232.86 527.5,-6232.86"/>
</g>
<!-- layer74_attn_out_6 -->
<g id="node1048" class="node">
<title>layer74_attn_out_6</title>
<path fill="#e6f3ff" stroke="black" d="M315,-6103.47C315,-6103.47 25,-6103.47 25,-6103.47 19,-6103.47 13,-6097.47 13,-6091.47 13,-6091.47 13,-6068.47 13,-6068.47 13,-6062.47 19,-6056.47 25,-6056.47 25,-6056.47 315,-6056.47 315,-6056.47 321,-6056.47 327,-6062.47 327,-6068.47 327,-6068.47 327,-6091.47 327,-6091.47 327,-6097.47 321,-6103.47 315,-6103.47"/>
<text text-anchor="middle" x="170" y="-6088.47" font-family="Arial" font-size="10.00">Layer 74 Attn Out GPU6</text>
<text text-anchor="middle" x="170" y="-6077.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="170" y="-6066.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer74_attn_6&#45;&gt;layer74_attn_out_6 -->
<g id="edge1196" class="edge">
<title>layer74_attn_6&#45;&gt;layer74_attn_out_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M166.77,-6175.41C167.37,-6157.96 168.2,-6133.55 168.87,-6113.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="172.37,-6113.97 169.22,-6103.86 165.38,-6113.73 172.37,-6113.97"/>
</g>
<!-- layer74_attn_out_7 -->
<g id="node1049" class="node">
<title>layer74_attn_out_7</title>
<path fill="#e6f3ff" stroke="black" d="M667,-6103.47C667,-6103.47 377,-6103.47 377,-6103.47 371,-6103.47 365,-6097.47 365,-6091.47 365,-6091.47 365,-6068.47 365,-6068.47 365,-6062.47 371,-6056.47 377,-6056.47 377,-6056.47 667,-6056.47 667,-6056.47 673,-6056.47 679,-6062.47 679,-6068.47 679,-6068.47 679,-6091.47 679,-6091.47 679,-6097.47 673,-6103.47 667,-6103.47"/>
<text text-anchor="middle" x="522" y="-6088.47" font-family="Arial" font-size="10.00">Layer 74 Attn Out GPU7</text>
<text text-anchor="middle" x="522" y="-6077.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="522" y="-6066.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer74_attn_7&#45;&gt;layer74_attn_out_7 -->
<g id="edge1197" class="edge">
<title>layer74_attn_7&#45;&gt;layer74_attn_out_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M523.61,-6175.41C523.32,-6157.96 522.9,-6133.55 522.56,-6113.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="526.06,-6113.8 522.39,-6103.86 519.06,-6113.92 526.06,-6113.8"/>
</g>
<!-- layer74_attn_ar -->
<g id="node1050" class="node">
<title>layer74_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M475.07,-5984.47C475.07,-5984.47 273.07,-5984.47 273.07,-5984.47 267.07,-5984.47 257.3,-5979.8 253.53,-5975.13 253.53,-5975.13 210.47,-5921.8 210.47,-5921.8 206.7,-5917.14 208.93,-5912.47 214.93,-5912.47 214.93,-5912.47 416.93,-5912.47 416.93,-5912.47 422.93,-5912.47 432.7,-5917.14 436.47,-5921.8 436.47,-5921.8 479.53,-5975.13 479.53,-5975.13 483.3,-5979.8 481.07,-5984.47 475.07,-5984.47"/>
<text text-anchor="middle" x="345" y="-5951.47" font-family="Arial" font-size="10.00">Layer 74 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="345" y="-5940.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer74_attn_out_6&#45;&gt;layer74_attn_ar -->
<g id="edge1198" class="edge">
<title>layer74_attn_out_6&#45;&gt;layer74_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M200.48,-6056.41C224.92,-6038.33 259.86,-6012.47 289.27,-5990.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="291.45,-5993.45 297.4,-5984.69 287.28,-5987.82 291.45,-5993.45"/>
</g>
<!-- layer74_attn_out_7&#45;&gt;layer74_attn_ar -->
<g id="edge1199" class="edge">
<title>layer74_attn_out_7&#45;&gt;layer74_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M491.17,-6056.41C466.45,-6038.33 431.11,-6012.47 401.37,-5990.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="403.28,-5987.77 393.14,-5984.69 399.14,-5993.42 403.28,-5987.77"/>
</g>
<!-- layer74_ffn1_6 -->
<g id="node1051" class="node">
<title>layer74_ffn1_6</title>
<path fill="#e6f3ff" stroke="black" d="M315,-5840.47C315,-5840.47 45,-5840.47 45,-5840.47 39,-5840.47 33,-5834.47 33,-5828.47 33,-5828.47 33,-5805.47 33,-5805.47 33,-5799.47 39,-5793.47 45,-5793.47 45,-5793.47 315,-5793.47 315,-5793.47 321,-5793.47 327,-5799.47 327,-5805.47 327,-5805.47 327,-5828.47 327,-5828.47 327,-5834.47 321,-5840.47 315,-5840.47"/>
<text text-anchor="middle" x="180" y="-5825.47" font-family="Arial" font-size="10.00">Layer 74 FFN1 GPU6</text>
<text text-anchor="middle" x="180" y="-5814.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="180" y="-5803.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer74_attn_ar&#45;&gt;layer74_ffn1_6 -->
<g id="edge1200" class="edge">
<title>layer74_attn_ar&#45;&gt;layer74_ffn1_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M300.35,-5912.42C274.28,-5891.96 241.78,-5866.45 217.12,-5847.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="219.11,-5844.21 209.08,-5840.79 214.79,-5849.72 219.11,-5844.21"/>
</g>
<!-- layer74_ffn1_7 -->
<g id="node1052" class="node">
<title>layer74_ffn1_7</title>
<path fill="#e6f3ff" stroke="black" d="M645,-5840.47C645,-5840.47 375,-5840.47 375,-5840.47 369,-5840.47 363,-5834.47 363,-5828.47 363,-5828.47 363,-5805.47 363,-5805.47 363,-5799.47 369,-5793.47 375,-5793.47 375,-5793.47 645,-5793.47 645,-5793.47 651,-5793.47 657,-5799.47 657,-5805.47 657,-5805.47 657,-5828.47 657,-5828.47 657,-5834.47 651,-5840.47 645,-5840.47"/>
<text text-anchor="middle" x="510" y="-5825.47" font-family="Arial" font-size="10.00">Layer 74 FFN1 GPU7</text>
<text text-anchor="middle" x="510" y="-5814.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="510" y="-5803.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer74_attn_ar&#45;&gt;layer74_ffn1_7 -->
<g id="edge1201" class="edge">
<title>layer74_attn_ar&#45;&gt;layer74_ffn1_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M389.65,-5912.42C415.72,-5891.96 448.22,-5866.45 472.88,-5847.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="475.21,-5849.72 480.92,-5840.79 470.89,-5844.21 475.21,-5849.72"/>
</g>
<!-- layer74_act_6 -->
<g id="node1053" class="node">
<title>layer74_act_6</title>
<path fill="#e6f3ff" stroke="black" d="M315,-5721.47C315,-5721.47 45,-5721.47 45,-5721.47 39,-5721.47 33,-5715.47 33,-5709.47 33,-5709.47 33,-5686.47 33,-5686.47 33,-5680.47 39,-5674.47 45,-5674.47 45,-5674.47 315,-5674.47 315,-5674.47 321,-5674.47 327,-5680.47 327,-5686.47 327,-5686.47 327,-5709.47 327,-5709.47 327,-5715.47 321,-5721.47 315,-5721.47"/>
<text text-anchor="middle" x="180" y="-5706.47" font-family="Arial" font-size="10.00">Layer 74 SiLU GPU6</text>
<text text-anchor="middle" x="180" y="-5695.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="180" y="-5684.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer74_ffn1_6&#45;&gt;layer74_act_6 -->
<g id="edge1202" class="edge">
<title>layer74_ffn1_6&#45;&gt;layer74_act_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M180,-5793.41C180,-5775.96 180,-5751.55 180,-5731.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="183.5,-5731.86 180,-5721.86 176.5,-5731.86 183.5,-5731.86"/>
</g>
<!-- layer74_act_7 -->
<g id="node1054" class="node">
<title>layer74_act_7</title>
<path fill="#e6f3ff" stroke="black" d="M645,-5721.47C645,-5721.47 375,-5721.47 375,-5721.47 369,-5721.47 363,-5715.47 363,-5709.47 363,-5709.47 363,-5686.47 363,-5686.47 363,-5680.47 369,-5674.47 375,-5674.47 375,-5674.47 645,-5674.47 645,-5674.47 651,-5674.47 657,-5680.47 657,-5686.47 657,-5686.47 657,-5709.47 657,-5709.47 657,-5715.47 651,-5721.47 645,-5721.47"/>
<text text-anchor="middle" x="510" y="-5706.47" font-family="Arial" font-size="10.00">Layer 74 SiLU GPU7</text>
<text text-anchor="middle" x="510" y="-5695.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="510" y="-5684.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer74_ffn1_7&#45;&gt;layer74_act_7 -->
<g id="edge1203" class="edge">
<title>layer74_ffn1_7&#45;&gt;layer74_act_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M510,-5793.41C510,-5775.96 510,-5751.55 510,-5731.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="513.5,-5731.86 510,-5721.86 506.5,-5731.86 513.5,-5731.86"/>
</g>
<!-- layer74_ffn2_6 -->
<g id="node1055" class="node">
<title>layer74_ffn2_6</title>
<path fill="#e6f3ff" stroke="black" d="M314.5,-5602.47C314.5,-5602.47 51.5,-5602.47 51.5,-5602.47 45.5,-5602.47 39.5,-5596.47 39.5,-5590.47 39.5,-5590.47 39.5,-5567.47 39.5,-5567.47 39.5,-5561.47 45.5,-5555.47 51.5,-5555.47 51.5,-5555.47 314.5,-5555.47 314.5,-5555.47 320.5,-5555.47 326.5,-5561.47 326.5,-5567.47 326.5,-5567.47 326.5,-5590.47 326.5,-5590.47 326.5,-5596.47 320.5,-5602.47 314.5,-5602.47"/>
<text text-anchor="middle" x="183" y="-5587.47" font-family="Arial" font-size="10.00">Layer 74 FFN2 GPU6</text>
<text text-anchor="middle" x="183" y="-5576.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="183" y="-5565.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer74_act_6&#45;&gt;layer74_ffn2_6 -->
<g id="edge1204" class="edge">
<title>layer74_act_6&#45;&gt;layer74_ffn2_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M180.58,-5674.41C181.03,-5656.96 181.65,-5632.55 182.16,-5612.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="185.66,-5612.94 182.41,-5602.86 178.66,-5612.76 185.66,-5612.94"/>
</g>
<!-- layer74_ffn2_7 -->
<g id="node1056" class="node">
<title>layer74_ffn2_7</title>
<path fill="#e6f3ff" stroke="black" d="M639.5,-5602.47C639.5,-5602.47 376.5,-5602.47 376.5,-5602.47 370.5,-5602.47 364.5,-5596.47 364.5,-5590.47 364.5,-5590.47 364.5,-5567.47 364.5,-5567.47 364.5,-5561.47 370.5,-5555.47 376.5,-5555.47 376.5,-5555.47 639.5,-5555.47 639.5,-5555.47 645.5,-5555.47 651.5,-5561.47 651.5,-5567.47 651.5,-5567.47 651.5,-5590.47 651.5,-5590.47 651.5,-5596.47 645.5,-5602.47 639.5,-5602.47"/>
<text text-anchor="middle" x="508" y="-5587.47" font-family="Arial" font-size="10.00">Layer 74 FFN2 GPU7</text>
<text text-anchor="middle" x="508" y="-5576.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="508" y="-5565.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer74_act_7&#45;&gt;layer74_ffn2_7 -->
<g id="edge1205" class="edge">
<title>layer74_act_7&#45;&gt;layer74_ffn2_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M509.61,-5674.41C509.32,-5656.96 508.9,-5632.55 508.56,-5612.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="512.06,-5612.8 508.39,-5602.86 505.06,-5612.92 512.06,-5612.8"/>
</g>
<!-- layer74_ffn_ar -->
<g id="node1057" class="node">
<title>layer74_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M476.22,-5483.47C476.22,-5483.47 270.8,-5483.47 270.8,-5483.47 264.8,-5483.47 255,-5478.83 251.19,-5474.19 251.19,-5474.19 207.39,-5420.75 207.39,-5420.75 203.59,-5416.11 205.78,-5411.47 211.78,-5411.47 211.78,-5411.47 417.2,-5411.47 417.2,-5411.47 423.2,-5411.47 433,-5416.11 436.81,-5420.75 436.81,-5420.75 480.61,-5474.19 480.61,-5474.19 484.41,-5478.83 482.22,-5483.47 476.22,-5483.47"/>
<text text-anchor="middle" x="344" y="-5450.47" font-family="Arial" font-size="10.00">Layer 74 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="344" y="-5439.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer74_ffn2_6&#45;&gt;layer74_ffn_ar -->
<g id="edge1206" class="edge">
<title>layer74_ffn2_6&#45;&gt;layer74_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M211.04,-5555.41C233.43,-5537.41 265.4,-5511.69 292.38,-5489.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="294.61,-5492.68 300.21,-5483.69 290.23,-5487.23 294.61,-5492.68"/>
</g>
<!-- layer74_ffn2_7&#45;&gt;layer74_ffn_ar -->
<g id="edge1207" class="edge">
<title>layer74_ffn2_7&#45;&gt;layer74_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M479.43,-5555.41C456.63,-5537.41 424.06,-5511.69 396.58,-5489.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="398.62,-5487.14 388.6,-5483.69 394.28,-5492.63 398.62,-5487.14"/>
</g>
<!-- layer75_qkv_6 -->
<g id="node1058" class="node">
<title>layer75_qkv_6</title>
<path fill="#e6f3ff" stroke="black" d="M314,-5339.47C314,-5339.47 16,-5339.47 16,-5339.47 10,-5339.47 4,-5333.47 4,-5327.47 4,-5327.47 4,-5304.47 4,-5304.47 4,-5298.47 10,-5292.47 16,-5292.47 16,-5292.47 314,-5292.47 314,-5292.47 320,-5292.47 326,-5298.47 326,-5304.47 326,-5304.47 326,-5327.47 326,-5327.47 326,-5333.47 320,-5339.47 314,-5339.47"/>
<text text-anchor="middle" x="165" y="-5324.47" font-family="Arial" font-size="10.00">Layer 75 QKV Proj GPU6</text>
<text text-anchor="middle" x="165" y="-5313.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="165" y="-5302.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer74_ffn_ar&#45;&gt;layer75_qkv_6 -->
<g id="edge1208" class="edge">
<title>layer74_ffn_ar&#45;&gt;layer75_qkv_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M295.56,-5411.42C267.06,-5390.81 231.48,-5365.06 204.66,-5345.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="206.43,-5342.62 196.28,-5339.6 202.33,-5348.3 206.43,-5342.62"/>
</g>
<!-- layer75_qkv_7 -->
<g id="node1059" class="node">
<title>layer75_qkv_7</title>
<path fill="#e6f3ff" stroke="black" d="M672,-5339.47C672,-5339.47 374,-5339.47 374,-5339.47 368,-5339.47 362,-5333.47 362,-5327.47 362,-5327.47 362,-5304.47 362,-5304.47 362,-5298.47 368,-5292.47 374,-5292.47 374,-5292.47 672,-5292.47 672,-5292.47 678,-5292.47 684,-5298.47 684,-5304.47 684,-5304.47 684,-5327.47 684,-5327.47 684,-5333.47 678,-5339.47 672,-5339.47"/>
<text text-anchor="middle" x="523" y="-5324.47" font-family="Arial" font-size="10.00">Layer 75 QKV Proj GPU7</text>
<text text-anchor="middle" x="523" y="-5313.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="523" y="-5302.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer74_ffn_ar&#45;&gt;layer75_qkv_7 -->
<g id="edge1209" class="edge">
<title>layer74_ffn_ar&#45;&gt;layer75_qkv_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M392.44,-5411.42C420.94,-5390.81 456.52,-5365.06 483.34,-5345.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="485.67,-5348.3 491.72,-5339.6 481.57,-5342.62 485.67,-5348.3"/>
</g>
<!-- layer75_attn_6 -->
<g id="node1060" class="node">
<title>layer75_attn_6</title>
<path fill="#e6f3ff" stroke="black" d="M314,-5220.47C314,-5220.47 16,-5220.47 16,-5220.47 10,-5220.47 4,-5214.47 4,-5208.47 4,-5208.47 4,-5185.47 4,-5185.47 4,-5179.47 10,-5173.47 16,-5173.47 16,-5173.47 314,-5173.47 314,-5173.47 320,-5173.47 326,-5179.47 326,-5185.47 326,-5185.47 326,-5208.47 326,-5208.47 326,-5214.47 320,-5220.47 314,-5220.47"/>
<text text-anchor="middle" x="165" y="-5205.47" font-family="Arial" font-size="10.00">Layer 75 Attention GPU6</text>
<text text-anchor="middle" x="165" y="-5194.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="165" y="-5183.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer75_qkv_6&#45;&gt;layer75_attn_6 -->
<g id="edge1210" class="edge">
<title>layer75_qkv_6&#45;&gt;layer75_attn_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M165,-5292.41C165,-5274.96 165,-5250.55 165,-5230.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="168.5,-5230.86 165,-5220.86 161.5,-5230.86 168.5,-5230.86"/>
</g>
<!-- layer75_attn_7 -->
<g id="node1061" class="node">
<title>layer75_attn_7</title>
<path fill="#e6f3ff" stroke="black" d="M672,-5220.47C672,-5220.47 374,-5220.47 374,-5220.47 368,-5220.47 362,-5214.47 362,-5208.47 362,-5208.47 362,-5185.47 362,-5185.47 362,-5179.47 368,-5173.47 374,-5173.47 374,-5173.47 672,-5173.47 672,-5173.47 678,-5173.47 684,-5179.47 684,-5185.47 684,-5185.47 684,-5208.47 684,-5208.47 684,-5214.47 678,-5220.47 672,-5220.47"/>
<text text-anchor="middle" x="523" y="-5205.47" font-family="Arial" font-size="10.00">Layer 75 Attention GPU7</text>
<text text-anchor="middle" x="523" y="-5194.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="523" y="-5183.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer75_qkv_7&#45;&gt;layer75_attn_7 -->
<g id="edge1211" class="edge">
<title>layer75_qkv_7&#45;&gt;layer75_attn_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M523,-5292.41C523,-5274.96 523,-5250.55 523,-5230.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="526.5,-5230.86 523,-5220.86 519.5,-5230.86 526.5,-5230.86"/>
</g>
<!-- layer75_attn_out_6 -->
<g id="node1062" class="node">
<title>layer75_attn_out_6</title>
<path fill="#e6f3ff" stroke="black" d="M314,-5101.47C314,-5101.47 24,-5101.47 24,-5101.47 18,-5101.47 12,-5095.47 12,-5089.47 12,-5089.47 12,-5066.47 12,-5066.47 12,-5060.47 18,-5054.47 24,-5054.47 24,-5054.47 314,-5054.47 314,-5054.47 320,-5054.47 326,-5060.47 326,-5066.47 326,-5066.47 326,-5089.47 326,-5089.47 326,-5095.47 320,-5101.47 314,-5101.47"/>
<text text-anchor="middle" x="169" y="-5086.47" font-family="Arial" font-size="10.00">Layer 75 Attn Out GPU6</text>
<text text-anchor="middle" x="169" y="-5075.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="169" y="-5064.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer75_attn_6&#45;&gt;layer75_attn_out_6 -->
<g id="edge1212" class="edge">
<title>layer75_attn_6&#45;&gt;layer75_attn_out_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M165.77,-5173.41C166.37,-5155.96 167.2,-5131.55 167.87,-5111.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="171.37,-5111.97 168.22,-5101.86 164.38,-5111.73 171.37,-5111.97"/>
</g>
<!-- layer75_attn_out_7 -->
<g id="node1063" class="node">
<title>layer75_attn_out_7</title>
<path fill="#e6f3ff" stroke="black" d="M666,-5101.47C666,-5101.47 376,-5101.47 376,-5101.47 370,-5101.47 364,-5095.47 364,-5089.47 364,-5089.47 364,-5066.47 364,-5066.47 364,-5060.47 370,-5054.47 376,-5054.47 376,-5054.47 666,-5054.47 666,-5054.47 672,-5054.47 678,-5060.47 678,-5066.47 678,-5066.47 678,-5089.47 678,-5089.47 678,-5095.47 672,-5101.47 666,-5101.47"/>
<text text-anchor="middle" x="521" y="-5086.47" font-family="Arial" font-size="10.00">Layer 75 Attn Out GPU7</text>
<text text-anchor="middle" x="521" y="-5075.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="521" y="-5064.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer75_attn_7&#45;&gt;layer75_attn_out_7 -->
<g id="edge1213" class="edge">
<title>layer75_attn_7&#45;&gt;layer75_attn_out_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M522.61,-5173.41C522.32,-5155.96 521.9,-5131.55 521.56,-5111.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="525.06,-5111.8 521.39,-5101.86 518.06,-5111.92 525.06,-5111.8"/>
</g>
<!-- layer75_attn_ar -->
<g id="node1064" class="node">
<title>layer75_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M474.07,-4982.47C474.07,-4982.47 272.07,-4982.47 272.07,-4982.47 266.07,-4982.47 256.3,-4977.8 252.53,-4973.13 252.53,-4973.13 209.47,-4919.8 209.47,-4919.8 205.7,-4915.14 207.93,-4910.47 213.93,-4910.47 213.93,-4910.47 415.93,-4910.47 415.93,-4910.47 421.93,-4910.47 431.7,-4915.14 435.47,-4919.8 435.47,-4919.8 478.53,-4973.13 478.53,-4973.13 482.3,-4977.8 480.07,-4982.47 474.07,-4982.47"/>
<text text-anchor="middle" x="344" y="-4949.47" font-family="Arial" font-size="10.00">Layer 75 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="344" y="-4938.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer75_attn_out_6&#45;&gt;layer75_attn_ar -->
<g id="edge1214" class="edge">
<title>layer75_attn_out_6&#45;&gt;layer75_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M199.48,-5054.41C223.92,-5036.33 258.86,-5010.47 288.27,-4988.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="290.45,-4991.45 296.4,-4982.69 286.28,-4985.82 290.45,-4991.45"/>
</g>
<!-- layer75_attn_out_7&#45;&gt;layer75_attn_ar -->
<g id="edge1215" class="edge">
<title>layer75_attn_out_7&#45;&gt;layer75_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M490.17,-5054.41C465.45,-5036.33 430.11,-5010.47 400.37,-4988.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="402.28,-4985.77 392.14,-4982.69 398.14,-4991.42 402.28,-4985.77"/>
</g>
<!-- layer75_ffn1_6 -->
<g id="node1065" class="node">
<title>layer75_ffn1_6</title>
<path fill="#e6f3ff" stroke="black" d="M314,-4838.47C314,-4838.47 44,-4838.47 44,-4838.47 38,-4838.47 32,-4832.47 32,-4826.47 32,-4826.47 32,-4803.47 32,-4803.47 32,-4797.47 38,-4791.47 44,-4791.47 44,-4791.47 314,-4791.47 314,-4791.47 320,-4791.47 326,-4797.47 326,-4803.47 326,-4803.47 326,-4826.47 326,-4826.47 326,-4832.47 320,-4838.47 314,-4838.47"/>
<text text-anchor="middle" x="179" y="-4823.47" font-family="Arial" font-size="10.00">Layer 75 FFN1 GPU6</text>
<text text-anchor="middle" x="179" y="-4812.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="179" y="-4801.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer75_attn_ar&#45;&gt;layer75_ffn1_6 -->
<g id="edge1216" class="edge">
<title>layer75_attn_ar&#45;&gt;layer75_ffn1_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M299.35,-4910.42C273.28,-4889.96 240.78,-4864.45 216.12,-4845.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="218.11,-4842.21 208.08,-4838.79 213.79,-4847.72 218.11,-4842.21"/>
</g>
<!-- layer75_ffn1_7 -->
<g id="node1066" class="node">
<title>layer75_ffn1_7</title>
<path fill="#e6f3ff" stroke="black" d="M644,-4838.47C644,-4838.47 374,-4838.47 374,-4838.47 368,-4838.47 362,-4832.47 362,-4826.47 362,-4826.47 362,-4803.47 362,-4803.47 362,-4797.47 368,-4791.47 374,-4791.47 374,-4791.47 644,-4791.47 644,-4791.47 650,-4791.47 656,-4797.47 656,-4803.47 656,-4803.47 656,-4826.47 656,-4826.47 656,-4832.47 650,-4838.47 644,-4838.47"/>
<text text-anchor="middle" x="509" y="-4823.47" font-family="Arial" font-size="10.00">Layer 75 FFN1 GPU7</text>
<text text-anchor="middle" x="509" y="-4812.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="509" y="-4801.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer75_attn_ar&#45;&gt;layer75_ffn1_7 -->
<g id="edge1217" class="edge">
<title>layer75_attn_ar&#45;&gt;layer75_ffn1_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M388.65,-4910.42C414.72,-4889.96 447.22,-4864.45 471.88,-4845.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="474.21,-4847.72 479.92,-4838.79 469.89,-4842.21 474.21,-4847.72"/>
</g>
<!-- layer75_act_6 -->
<g id="node1067" class="node">
<title>layer75_act_6</title>
<path fill="#e6f3ff" stroke="black" d="M314,-4719.47C314,-4719.47 44,-4719.47 44,-4719.47 38,-4719.47 32,-4713.47 32,-4707.47 32,-4707.47 32,-4684.47 32,-4684.47 32,-4678.47 38,-4672.47 44,-4672.47 44,-4672.47 314,-4672.47 314,-4672.47 320,-4672.47 326,-4678.47 326,-4684.47 326,-4684.47 326,-4707.47 326,-4707.47 326,-4713.47 320,-4719.47 314,-4719.47"/>
<text text-anchor="middle" x="179" y="-4704.47" font-family="Arial" font-size="10.00">Layer 75 SiLU GPU6</text>
<text text-anchor="middle" x="179" y="-4693.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="179" y="-4682.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer75_ffn1_6&#45;&gt;layer75_act_6 -->
<g id="edge1218" class="edge">
<title>layer75_ffn1_6&#45;&gt;layer75_act_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M179,-4791.41C179,-4773.96 179,-4749.55 179,-4729.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="182.5,-4729.86 179,-4719.86 175.5,-4729.86 182.5,-4729.86"/>
</g>
<!-- layer75_act_7 -->
<g id="node1068" class="node">
<title>layer75_act_7</title>
<path fill="#e6f3ff" stroke="black" d="M644,-4719.47C644,-4719.47 374,-4719.47 374,-4719.47 368,-4719.47 362,-4713.47 362,-4707.47 362,-4707.47 362,-4684.47 362,-4684.47 362,-4678.47 368,-4672.47 374,-4672.47 374,-4672.47 644,-4672.47 644,-4672.47 650,-4672.47 656,-4678.47 656,-4684.47 656,-4684.47 656,-4707.47 656,-4707.47 656,-4713.47 650,-4719.47 644,-4719.47"/>
<text text-anchor="middle" x="509" y="-4704.47" font-family="Arial" font-size="10.00">Layer 75 SiLU GPU7</text>
<text text-anchor="middle" x="509" y="-4693.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="509" y="-4682.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer75_ffn1_7&#45;&gt;layer75_act_7 -->
<g id="edge1219" class="edge">
<title>layer75_ffn1_7&#45;&gt;layer75_act_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M509,-4791.41C509,-4773.96 509,-4749.55 509,-4729.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="512.5,-4729.86 509,-4719.86 505.5,-4729.86 512.5,-4729.86"/>
</g>
<!-- layer75_ffn2_6 -->
<g id="node1069" class="node">
<title>layer75_ffn2_6</title>
<path fill="#e6f3ff" stroke="black" d="M313.5,-4600.47C313.5,-4600.47 50.5,-4600.47 50.5,-4600.47 44.5,-4600.47 38.5,-4594.47 38.5,-4588.47 38.5,-4588.47 38.5,-4565.47 38.5,-4565.47 38.5,-4559.47 44.5,-4553.47 50.5,-4553.47 50.5,-4553.47 313.5,-4553.47 313.5,-4553.47 319.5,-4553.47 325.5,-4559.47 325.5,-4565.47 325.5,-4565.47 325.5,-4588.47 325.5,-4588.47 325.5,-4594.47 319.5,-4600.47 313.5,-4600.47"/>
<text text-anchor="middle" x="182" y="-4585.47" font-family="Arial" font-size="10.00">Layer 75 FFN2 GPU6</text>
<text text-anchor="middle" x="182" y="-4574.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="182" y="-4563.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer75_act_6&#45;&gt;layer75_ffn2_6 -->
<g id="edge1220" class="edge">
<title>layer75_act_6&#45;&gt;layer75_ffn2_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M179.58,-4672.41C180.03,-4654.96 180.65,-4630.55 181.16,-4610.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="184.66,-4610.94 181.41,-4600.86 177.66,-4610.76 184.66,-4610.94"/>
</g>
<!-- layer75_ffn2_7 -->
<g id="node1070" class="node">
<title>layer75_ffn2_7</title>
<path fill="#e6f3ff" stroke="black" d="M638.5,-4600.47C638.5,-4600.47 375.5,-4600.47 375.5,-4600.47 369.5,-4600.47 363.5,-4594.47 363.5,-4588.47 363.5,-4588.47 363.5,-4565.47 363.5,-4565.47 363.5,-4559.47 369.5,-4553.47 375.5,-4553.47 375.5,-4553.47 638.5,-4553.47 638.5,-4553.47 644.5,-4553.47 650.5,-4559.47 650.5,-4565.47 650.5,-4565.47 650.5,-4588.47 650.5,-4588.47 650.5,-4594.47 644.5,-4600.47 638.5,-4600.47"/>
<text text-anchor="middle" x="507" y="-4585.47" font-family="Arial" font-size="10.00">Layer 75 FFN2 GPU7</text>
<text text-anchor="middle" x="507" y="-4574.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="507" y="-4563.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer75_act_7&#45;&gt;layer75_ffn2_7 -->
<g id="edge1221" class="edge">
<title>layer75_act_7&#45;&gt;layer75_ffn2_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M508.61,-4672.41C508.32,-4654.96 507.9,-4630.55 507.56,-4610.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="511.06,-4610.8 507.39,-4600.86 504.06,-4610.92 511.06,-4610.8"/>
</g>
<!-- layer75_ffn_ar -->
<g id="node1071" class="node">
<title>layer75_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M475.22,-4481.47C475.22,-4481.47 269.8,-4481.47 269.8,-4481.47 263.8,-4481.47 254,-4476.83 250.19,-4472.19 250.19,-4472.19 206.39,-4418.75 206.39,-4418.75 202.59,-4414.11 204.78,-4409.47 210.78,-4409.47 210.78,-4409.47 416.2,-4409.47 416.2,-4409.47 422.2,-4409.47 432,-4414.11 435.81,-4418.75 435.81,-4418.75 479.61,-4472.19 479.61,-4472.19 483.41,-4476.83 481.22,-4481.47 475.22,-4481.47"/>
<text text-anchor="middle" x="343" y="-4448.47" font-family="Arial" font-size="10.00">Layer 75 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="343" y="-4437.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer75_ffn2_6&#45;&gt;layer75_ffn_ar -->
<g id="edge1222" class="edge">
<title>layer75_ffn2_6&#45;&gt;layer75_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M210.04,-4553.41C232.43,-4535.41 264.4,-4509.69 291.38,-4487.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="293.61,-4490.68 299.21,-4481.69 289.23,-4485.23 293.61,-4490.68"/>
</g>
<!-- layer75_ffn2_7&#45;&gt;layer75_ffn_ar -->
<g id="edge1223" class="edge">
<title>layer75_ffn2_7&#45;&gt;layer75_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M478.43,-4553.41C455.63,-4535.41 423.06,-4509.69 395.58,-4487.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="397.62,-4485.14 387.6,-4481.69 393.28,-4490.63 397.62,-4485.14"/>
</g>
<!-- layer76_qkv_6 -->
<g id="node1072" class="node">
<title>layer76_qkv_6</title>
<path fill="#e6f3ff" stroke="black" d="M313,-4337.47C313,-4337.47 15,-4337.47 15,-4337.47 9,-4337.47 3,-4331.47 3,-4325.47 3,-4325.47 3,-4302.47 3,-4302.47 3,-4296.47 9,-4290.47 15,-4290.47 15,-4290.47 313,-4290.47 313,-4290.47 319,-4290.47 325,-4296.47 325,-4302.47 325,-4302.47 325,-4325.47 325,-4325.47 325,-4331.47 319,-4337.47 313,-4337.47"/>
<text text-anchor="middle" x="164" y="-4322.47" font-family="Arial" font-size="10.00">Layer 76 QKV Proj GPU6</text>
<text text-anchor="middle" x="164" y="-4311.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="164" y="-4300.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer75_ffn_ar&#45;&gt;layer76_qkv_6 -->
<g id="edge1224" class="edge">
<title>layer75_ffn_ar&#45;&gt;layer76_qkv_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M294.56,-4409.42C266.06,-4388.81 230.48,-4363.06 203.66,-4343.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="205.43,-4340.62 195.28,-4337.6 201.33,-4346.3 205.43,-4340.62"/>
</g>
<!-- layer76_qkv_7 -->
<g id="node1073" class="node">
<title>layer76_qkv_7</title>
<path fill="#e6f3ff" stroke="black" d="M671,-4337.47C671,-4337.47 373,-4337.47 373,-4337.47 367,-4337.47 361,-4331.47 361,-4325.47 361,-4325.47 361,-4302.47 361,-4302.47 361,-4296.47 367,-4290.47 373,-4290.47 373,-4290.47 671,-4290.47 671,-4290.47 677,-4290.47 683,-4296.47 683,-4302.47 683,-4302.47 683,-4325.47 683,-4325.47 683,-4331.47 677,-4337.47 671,-4337.47"/>
<text text-anchor="middle" x="522" y="-4322.47" font-family="Arial" font-size="10.00">Layer 76 QKV Proj GPU7</text>
<text text-anchor="middle" x="522" y="-4311.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="522" y="-4300.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer75_ffn_ar&#45;&gt;layer76_qkv_7 -->
<g id="edge1225" class="edge">
<title>layer75_ffn_ar&#45;&gt;layer76_qkv_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M391.44,-4409.42C419.94,-4388.81 455.52,-4363.06 482.34,-4343.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="484.67,-4346.3 490.72,-4337.6 480.57,-4340.62 484.67,-4346.3"/>
</g>
<!-- layer76_attn_6 -->
<g id="node1074" class="node">
<title>layer76_attn_6</title>
<path fill="#e6f3ff" stroke="black" d="M313,-4218.47C313,-4218.47 15,-4218.47 15,-4218.47 9,-4218.47 3,-4212.47 3,-4206.47 3,-4206.47 3,-4183.47 3,-4183.47 3,-4177.47 9,-4171.47 15,-4171.47 15,-4171.47 313,-4171.47 313,-4171.47 319,-4171.47 325,-4177.47 325,-4183.47 325,-4183.47 325,-4206.47 325,-4206.47 325,-4212.47 319,-4218.47 313,-4218.47"/>
<text text-anchor="middle" x="164" y="-4203.47" font-family="Arial" font-size="10.00">Layer 76 Attention GPU6</text>
<text text-anchor="middle" x="164" y="-4192.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="164" y="-4181.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer76_qkv_6&#45;&gt;layer76_attn_6 -->
<g id="edge1226" class="edge">
<title>layer76_qkv_6&#45;&gt;layer76_attn_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M164,-4290.41C164,-4272.96 164,-4248.55 164,-4228.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="167.5,-4228.86 164,-4218.86 160.5,-4228.86 167.5,-4228.86"/>
</g>
<!-- layer76_attn_7 -->
<g id="node1075" class="node">
<title>layer76_attn_7</title>
<path fill="#e6f3ff" stroke="black" d="M671,-4218.47C671,-4218.47 373,-4218.47 373,-4218.47 367,-4218.47 361,-4212.47 361,-4206.47 361,-4206.47 361,-4183.47 361,-4183.47 361,-4177.47 367,-4171.47 373,-4171.47 373,-4171.47 671,-4171.47 671,-4171.47 677,-4171.47 683,-4177.47 683,-4183.47 683,-4183.47 683,-4206.47 683,-4206.47 683,-4212.47 677,-4218.47 671,-4218.47"/>
<text text-anchor="middle" x="522" y="-4203.47" font-family="Arial" font-size="10.00">Layer 76 Attention GPU7</text>
<text text-anchor="middle" x="522" y="-4192.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="522" y="-4181.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer76_qkv_7&#45;&gt;layer76_attn_7 -->
<g id="edge1227" class="edge">
<title>layer76_qkv_7&#45;&gt;layer76_attn_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M522,-4290.41C522,-4272.96 522,-4248.55 522,-4228.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="525.5,-4228.86 522,-4218.86 518.5,-4228.86 525.5,-4228.86"/>
</g>
<!-- layer76_attn_out_6 -->
<g id="node1076" class="node">
<title>layer76_attn_out_6</title>
<path fill="#e6f3ff" stroke="black" d="M313,-4099.47C313,-4099.47 23,-4099.47 23,-4099.47 17,-4099.47 11,-4093.47 11,-4087.47 11,-4087.47 11,-4064.47 11,-4064.47 11,-4058.47 17,-4052.47 23,-4052.47 23,-4052.47 313,-4052.47 313,-4052.47 319,-4052.47 325,-4058.47 325,-4064.47 325,-4064.47 325,-4087.47 325,-4087.47 325,-4093.47 319,-4099.47 313,-4099.47"/>
<text text-anchor="middle" x="168" y="-4084.47" font-family="Arial" font-size="10.00">Layer 76 Attn Out GPU6</text>
<text text-anchor="middle" x="168" y="-4073.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="168" y="-4062.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer76_attn_6&#45;&gt;layer76_attn_out_6 -->
<g id="edge1228" class="edge">
<title>layer76_attn_6&#45;&gt;layer76_attn_out_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M164.77,-4171.41C165.37,-4153.96 166.2,-4129.55 166.87,-4109.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="170.37,-4109.97 167.22,-4099.86 163.38,-4109.73 170.37,-4109.97"/>
</g>
<!-- layer76_attn_out_7 -->
<g id="node1077" class="node">
<title>layer76_attn_out_7</title>
<path fill="#e6f3ff" stroke="black" d="M665,-4099.47C665,-4099.47 375,-4099.47 375,-4099.47 369,-4099.47 363,-4093.47 363,-4087.47 363,-4087.47 363,-4064.47 363,-4064.47 363,-4058.47 369,-4052.47 375,-4052.47 375,-4052.47 665,-4052.47 665,-4052.47 671,-4052.47 677,-4058.47 677,-4064.47 677,-4064.47 677,-4087.47 677,-4087.47 677,-4093.47 671,-4099.47 665,-4099.47"/>
<text text-anchor="middle" x="520" y="-4084.47" font-family="Arial" font-size="10.00">Layer 76 Attn Out GPU7</text>
<text text-anchor="middle" x="520" y="-4073.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="520" y="-4062.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer76_attn_7&#45;&gt;layer76_attn_out_7 -->
<g id="edge1229" class="edge">
<title>layer76_attn_7&#45;&gt;layer76_attn_out_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M521.61,-4171.41C521.32,-4153.96 520.9,-4129.55 520.56,-4109.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="524.06,-4109.8 520.39,-4099.86 517.06,-4109.92 524.06,-4109.8"/>
</g>
<!-- layer76_attn_ar -->
<g id="node1078" class="node">
<title>layer76_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M473.07,-3980.47C473.07,-3980.47 271.07,-3980.47 271.07,-3980.47 265.07,-3980.47 255.3,-3975.8 251.53,-3971.13 251.53,-3971.13 208.47,-3917.8 208.47,-3917.8 204.7,-3913.14 206.93,-3908.47 212.93,-3908.47 212.93,-3908.47 414.93,-3908.47 414.93,-3908.47 420.93,-3908.47 430.7,-3913.14 434.47,-3917.8 434.47,-3917.8 477.53,-3971.13 477.53,-3971.13 481.3,-3975.8 479.07,-3980.47 473.07,-3980.47"/>
<text text-anchor="middle" x="343" y="-3947.47" font-family="Arial" font-size="10.00">Layer 76 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="343" y="-3936.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer76_attn_out_6&#45;&gt;layer76_attn_ar -->
<g id="edge1230" class="edge">
<title>layer76_attn_out_6&#45;&gt;layer76_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M198.48,-4052.41C222.92,-4034.33 257.86,-4008.47 287.27,-3986.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="289.45,-3989.45 295.4,-3980.69 285.28,-3983.82 289.45,-3989.45"/>
</g>
<!-- layer76_attn_out_7&#45;&gt;layer76_attn_ar -->
<g id="edge1231" class="edge">
<title>layer76_attn_out_7&#45;&gt;layer76_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M489.17,-4052.41C464.45,-4034.33 429.11,-4008.47 399.37,-3986.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="401.28,-3983.77 391.14,-3980.69 397.14,-3989.42 401.28,-3983.77"/>
</g>
<!-- layer76_ffn1_6 -->
<g id="node1079" class="node">
<title>layer76_ffn1_6</title>
<path fill="#e6f3ff" stroke="black" d="M313,-3836.47C313,-3836.47 43,-3836.47 43,-3836.47 37,-3836.47 31,-3830.47 31,-3824.47 31,-3824.47 31,-3801.47 31,-3801.47 31,-3795.47 37,-3789.47 43,-3789.47 43,-3789.47 313,-3789.47 313,-3789.47 319,-3789.47 325,-3795.47 325,-3801.47 325,-3801.47 325,-3824.47 325,-3824.47 325,-3830.47 319,-3836.47 313,-3836.47"/>
<text text-anchor="middle" x="178" y="-3821.47" font-family="Arial" font-size="10.00">Layer 76 FFN1 GPU6</text>
<text text-anchor="middle" x="178" y="-3810.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="178" y="-3799.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer76_attn_ar&#45;&gt;layer76_ffn1_6 -->
<g id="edge1232" class="edge">
<title>layer76_attn_ar&#45;&gt;layer76_ffn1_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M298.35,-3908.42C272.28,-3887.96 239.78,-3862.45 215.12,-3843.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="217.11,-3840.21 207.08,-3836.79 212.79,-3845.72 217.11,-3840.21"/>
</g>
<!-- layer76_ffn1_7 -->
<g id="node1080" class="node">
<title>layer76_ffn1_7</title>
<path fill="#e6f3ff" stroke="black" d="M643,-3836.47C643,-3836.47 373,-3836.47 373,-3836.47 367,-3836.47 361,-3830.47 361,-3824.47 361,-3824.47 361,-3801.47 361,-3801.47 361,-3795.47 367,-3789.47 373,-3789.47 373,-3789.47 643,-3789.47 643,-3789.47 649,-3789.47 655,-3795.47 655,-3801.47 655,-3801.47 655,-3824.47 655,-3824.47 655,-3830.47 649,-3836.47 643,-3836.47"/>
<text text-anchor="middle" x="508" y="-3821.47" font-family="Arial" font-size="10.00">Layer 76 FFN1 GPU7</text>
<text text-anchor="middle" x="508" y="-3810.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="508" y="-3799.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer76_attn_ar&#45;&gt;layer76_ffn1_7 -->
<g id="edge1233" class="edge">
<title>layer76_attn_ar&#45;&gt;layer76_ffn1_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M387.65,-3908.42C413.72,-3887.96 446.22,-3862.45 470.88,-3843.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="473.21,-3845.72 478.92,-3836.79 468.89,-3840.21 473.21,-3845.72"/>
</g>
<!-- layer76_act_6 -->
<g id="node1081" class="node">
<title>layer76_act_6</title>
<path fill="#e6f3ff" stroke="black" d="M313,-3717.47C313,-3717.47 43,-3717.47 43,-3717.47 37,-3717.47 31,-3711.47 31,-3705.47 31,-3705.47 31,-3682.47 31,-3682.47 31,-3676.47 37,-3670.47 43,-3670.47 43,-3670.47 313,-3670.47 313,-3670.47 319,-3670.47 325,-3676.47 325,-3682.47 325,-3682.47 325,-3705.47 325,-3705.47 325,-3711.47 319,-3717.47 313,-3717.47"/>
<text text-anchor="middle" x="178" y="-3702.47" font-family="Arial" font-size="10.00">Layer 76 SiLU GPU6</text>
<text text-anchor="middle" x="178" y="-3691.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="178" y="-3680.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer76_ffn1_6&#45;&gt;layer76_act_6 -->
<g id="edge1234" class="edge">
<title>layer76_ffn1_6&#45;&gt;layer76_act_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M178,-3789.41C178,-3771.96 178,-3747.55 178,-3727.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="181.5,-3727.86 178,-3717.86 174.5,-3727.86 181.5,-3727.86"/>
</g>
<!-- layer76_act_7 -->
<g id="node1082" class="node">
<title>layer76_act_7</title>
<path fill="#e6f3ff" stroke="black" d="M643,-3717.47C643,-3717.47 373,-3717.47 373,-3717.47 367,-3717.47 361,-3711.47 361,-3705.47 361,-3705.47 361,-3682.47 361,-3682.47 361,-3676.47 367,-3670.47 373,-3670.47 373,-3670.47 643,-3670.47 643,-3670.47 649,-3670.47 655,-3676.47 655,-3682.47 655,-3682.47 655,-3705.47 655,-3705.47 655,-3711.47 649,-3717.47 643,-3717.47"/>
<text text-anchor="middle" x="508" y="-3702.47" font-family="Arial" font-size="10.00">Layer 76 SiLU GPU7</text>
<text text-anchor="middle" x="508" y="-3691.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="508" y="-3680.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer76_ffn1_7&#45;&gt;layer76_act_7 -->
<g id="edge1235" class="edge">
<title>layer76_ffn1_7&#45;&gt;layer76_act_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M508,-3789.41C508,-3771.96 508,-3747.55 508,-3727.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="511.5,-3727.86 508,-3717.86 504.5,-3727.86 511.5,-3727.86"/>
</g>
<!-- layer76_ffn2_6 -->
<g id="node1083" class="node">
<title>layer76_ffn2_6</title>
<path fill="#e6f3ff" stroke="black" d="M312.5,-3598.47C312.5,-3598.47 49.5,-3598.47 49.5,-3598.47 43.5,-3598.47 37.5,-3592.47 37.5,-3586.47 37.5,-3586.47 37.5,-3563.47 37.5,-3563.47 37.5,-3557.47 43.5,-3551.47 49.5,-3551.47 49.5,-3551.47 312.5,-3551.47 312.5,-3551.47 318.5,-3551.47 324.5,-3557.47 324.5,-3563.47 324.5,-3563.47 324.5,-3586.47 324.5,-3586.47 324.5,-3592.47 318.5,-3598.47 312.5,-3598.47"/>
<text text-anchor="middle" x="181" y="-3583.47" font-family="Arial" font-size="10.00">Layer 76 FFN2 GPU6</text>
<text text-anchor="middle" x="181" y="-3572.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="181" y="-3561.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer76_act_6&#45;&gt;layer76_ffn2_6 -->
<g id="edge1236" class="edge">
<title>layer76_act_6&#45;&gt;layer76_ffn2_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M178.58,-3670.41C179.03,-3652.96 179.65,-3628.55 180.16,-3608.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="183.66,-3608.94 180.41,-3598.86 176.66,-3608.76 183.66,-3608.94"/>
</g>
<!-- layer76_ffn2_7 -->
<g id="node1084" class="node">
<title>layer76_ffn2_7</title>
<path fill="#e6f3ff" stroke="black" d="M637.5,-3598.47C637.5,-3598.47 374.5,-3598.47 374.5,-3598.47 368.5,-3598.47 362.5,-3592.47 362.5,-3586.47 362.5,-3586.47 362.5,-3563.47 362.5,-3563.47 362.5,-3557.47 368.5,-3551.47 374.5,-3551.47 374.5,-3551.47 637.5,-3551.47 637.5,-3551.47 643.5,-3551.47 649.5,-3557.47 649.5,-3563.47 649.5,-3563.47 649.5,-3586.47 649.5,-3586.47 649.5,-3592.47 643.5,-3598.47 637.5,-3598.47"/>
<text text-anchor="middle" x="506" y="-3583.47" font-family="Arial" font-size="10.00">Layer 76 FFN2 GPU7</text>
<text text-anchor="middle" x="506" y="-3572.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="506" y="-3561.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer76_act_7&#45;&gt;layer76_ffn2_7 -->
<g id="edge1237" class="edge">
<title>layer76_act_7&#45;&gt;layer76_ffn2_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M507.61,-3670.41C507.32,-3652.96 506.9,-3628.55 506.56,-3608.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="510.06,-3608.8 506.39,-3598.86 503.06,-3608.92 510.06,-3608.8"/>
</g>
<!-- layer76_ffn_ar -->
<g id="node1085" class="node">
<title>layer76_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M474.22,-3479.47C474.22,-3479.47 268.8,-3479.47 268.8,-3479.47 262.8,-3479.47 253,-3474.83 249.19,-3470.19 249.19,-3470.19 205.39,-3416.75 205.39,-3416.75 201.59,-3412.11 203.78,-3407.47 209.78,-3407.47 209.78,-3407.47 415.2,-3407.47 415.2,-3407.47 421.2,-3407.47 431,-3412.11 434.81,-3416.75 434.81,-3416.75 478.61,-3470.19 478.61,-3470.19 482.41,-3474.83 480.22,-3479.47 474.22,-3479.47"/>
<text text-anchor="middle" x="342" y="-3446.47" font-family="Arial" font-size="10.00">Layer 76 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="342" y="-3435.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer76_ffn2_6&#45;&gt;layer76_ffn_ar -->
<g id="edge1238" class="edge">
<title>layer76_ffn2_6&#45;&gt;layer76_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M209.04,-3551.41C231.43,-3533.41 263.4,-3507.69 290.38,-3485.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="292.61,-3488.68 298.21,-3479.69 288.23,-3483.23 292.61,-3488.68"/>
</g>
<!-- layer76_ffn2_7&#45;&gt;layer76_ffn_ar -->
<g id="edge1239" class="edge">
<title>layer76_ffn2_7&#45;&gt;layer76_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M477.43,-3551.41C454.63,-3533.41 422.06,-3507.69 394.58,-3485.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="396.62,-3483.14 386.6,-3479.69 392.28,-3488.63 396.62,-3483.14"/>
</g>
<!-- layer77_qkv_6 -->
<g id="node1086" class="node">
<title>layer77_qkv_6</title>
<path fill="#e6f3ff" stroke="black" d="M312,-3335.47C312,-3335.47 14,-3335.47 14,-3335.47 8,-3335.47 2,-3329.47 2,-3323.47 2,-3323.47 2,-3300.47 2,-3300.47 2,-3294.47 8,-3288.47 14,-3288.47 14,-3288.47 312,-3288.47 312,-3288.47 318,-3288.47 324,-3294.47 324,-3300.47 324,-3300.47 324,-3323.47 324,-3323.47 324,-3329.47 318,-3335.47 312,-3335.47"/>
<text text-anchor="middle" x="163" y="-3320.47" font-family="Arial" font-size="10.00">Layer 77 QKV Proj GPU6</text>
<text text-anchor="middle" x="163" y="-3309.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="163" y="-3298.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer76_ffn_ar&#45;&gt;layer77_qkv_6 -->
<g id="edge1240" class="edge">
<title>layer76_ffn_ar&#45;&gt;layer77_qkv_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M293.56,-3407.42C265.06,-3386.81 229.48,-3361.06 202.66,-3341.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="204.43,-3338.62 194.28,-3335.6 200.33,-3344.3 204.43,-3338.62"/>
</g>
<!-- layer77_qkv_7 -->
<g id="node1087" class="node">
<title>layer77_qkv_7</title>
<path fill="#e6f3ff" stroke="black" d="M670,-3335.47C670,-3335.47 372,-3335.47 372,-3335.47 366,-3335.47 360,-3329.47 360,-3323.47 360,-3323.47 360,-3300.47 360,-3300.47 360,-3294.47 366,-3288.47 372,-3288.47 372,-3288.47 670,-3288.47 670,-3288.47 676,-3288.47 682,-3294.47 682,-3300.47 682,-3300.47 682,-3323.47 682,-3323.47 682,-3329.47 676,-3335.47 670,-3335.47"/>
<text text-anchor="middle" x="521" y="-3320.47" font-family="Arial" font-size="10.00">Layer 77 QKV Proj GPU7</text>
<text text-anchor="middle" x="521" y="-3309.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="521" y="-3298.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer76_ffn_ar&#45;&gt;layer77_qkv_7 -->
<g id="edge1241" class="edge">
<title>layer76_ffn_ar&#45;&gt;layer77_qkv_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M390.44,-3407.42C418.94,-3386.81 454.52,-3361.06 481.34,-3341.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="483.67,-3344.3 489.72,-3335.6 479.57,-3338.62 483.67,-3344.3"/>
</g>
<!-- layer77_attn_6 -->
<g id="node1088" class="node">
<title>layer77_attn_6</title>
<path fill="#e6f3ff" stroke="black" d="M312,-3216.47C312,-3216.47 14,-3216.47 14,-3216.47 8,-3216.47 2,-3210.47 2,-3204.47 2,-3204.47 2,-3181.47 2,-3181.47 2,-3175.47 8,-3169.47 14,-3169.47 14,-3169.47 312,-3169.47 312,-3169.47 318,-3169.47 324,-3175.47 324,-3181.47 324,-3181.47 324,-3204.47 324,-3204.47 324,-3210.47 318,-3216.47 312,-3216.47"/>
<text text-anchor="middle" x="163" y="-3201.47" font-family="Arial" font-size="10.00">Layer 77 Attention GPU6</text>
<text text-anchor="middle" x="163" y="-3190.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="163" y="-3179.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer77_qkv_6&#45;&gt;layer77_attn_6 -->
<g id="edge1242" class="edge">
<title>layer77_qkv_6&#45;&gt;layer77_attn_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M163,-3288.41C163,-3270.96 163,-3246.55 163,-3226.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="166.5,-3226.86 163,-3216.86 159.5,-3226.86 166.5,-3226.86"/>
</g>
<!-- layer77_attn_7 -->
<g id="node1089" class="node">
<title>layer77_attn_7</title>
<path fill="#e6f3ff" stroke="black" d="M670,-3216.47C670,-3216.47 372,-3216.47 372,-3216.47 366,-3216.47 360,-3210.47 360,-3204.47 360,-3204.47 360,-3181.47 360,-3181.47 360,-3175.47 366,-3169.47 372,-3169.47 372,-3169.47 670,-3169.47 670,-3169.47 676,-3169.47 682,-3175.47 682,-3181.47 682,-3181.47 682,-3204.47 682,-3204.47 682,-3210.47 676,-3216.47 670,-3216.47"/>
<text text-anchor="middle" x="521" y="-3201.47" font-family="Arial" font-size="10.00">Layer 77 Attention GPU7</text>
<text text-anchor="middle" x="521" y="-3190.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="521" y="-3179.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer77_qkv_7&#45;&gt;layer77_attn_7 -->
<g id="edge1243" class="edge">
<title>layer77_qkv_7&#45;&gt;layer77_attn_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M521,-3288.41C521,-3270.96 521,-3246.55 521,-3226.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="524.5,-3226.86 521,-3216.86 517.5,-3226.86 524.5,-3226.86"/>
</g>
<!-- layer77_attn_out_6 -->
<g id="node1090" class="node">
<title>layer77_attn_out_6</title>
<path fill="#e6f3ff" stroke="black" d="M312,-3097.47C312,-3097.47 22,-3097.47 22,-3097.47 16,-3097.47 10,-3091.47 10,-3085.47 10,-3085.47 10,-3062.47 10,-3062.47 10,-3056.47 16,-3050.47 22,-3050.47 22,-3050.47 312,-3050.47 312,-3050.47 318,-3050.47 324,-3056.47 324,-3062.47 324,-3062.47 324,-3085.47 324,-3085.47 324,-3091.47 318,-3097.47 312,-3097.47"/>
<text text-anchor="middle" x="167" y="-3082.47" font-family="Arial" font-size="10.00">Layer 77 Attn Out GPU6</text>
<text text-anchor="middle" x="167" y="-3071.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="167" y="-3060.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer77_attn_6&#45;&gt;layer77_attn_out_6 -->
<g id="edge1244" class="edge">
<title>layer77_attn_6&#45;&gt;layer77_attn_out_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M163.77,-3169.41C164.37,-3151.96 165.2,-3127.55 165.87,-3107.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="169.37,-3107.97 166.22,-3097.86 162.38,-3107.73 169.37,-3107.97"/>
</g>
<!-- layer77_attn_out_7 -->
<g id="node1091" class="node">
<title>layer77_attn_out_7</title>
<path fill="#e6f3ff" stroke="black" d="M664,-3097.47C664,-3097.47 374,-3097.47 374,-3097.47 368,-3097.47 362,-3091.47 362,-3085.47 362,-3085.47 362,-3062.47 362,-3062.47 362,-3056.47 368,-3050.47 374,-3050.47 374,-3050.47 664,-3050.47 664,-3050.47 670,-3050.47 676,-3056.47 676,-3062.47 676,-3062.47 676,-3085.47 676,-3085.47 676,-3091.47 670,-3097.47 664,-3097.47"/>
<text text-anchor="middle" x="519" y="-3082.47" font-family="Arial" font-size="10.00">Layer 77 Attn Out GPU7</text>
<text text-anchor="middle" x="519" y="-3071.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="519" y="-3060.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer77_attn_7&#45;&gt;layer77_attn_out_7 -->
<g id="edge1245" class="edge">
<title>layer77_attn_7&#45;&gt;layer77_attn_out_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M520.61,-3169.41C520.32,-3151.96 519.9,-3127.55 519.56,-3107.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="523.06,-3107.8 519.39,-3097.86 516.06,-3107.92 523.06,-3107.8"/>
</g>
<!-- layer77_attn_ar -->
<g id="node1092" class="node">
<title>layer77_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M472.07,-2978.47C472.07,-2978.47 270.07,-2978.47 270.07,-2978.47 264.07,-2978.47 254.3,-2973.8 250.53,-2969.13 250.53,-2969.13 207.47,-2915.8 207.47,-2915.8 203.7,-2911.14 205.93,-2906.47 211.93,-2906.47 211.93,-2906.47 413.93,-2906.47 413.93,-2906.47 419.93,-2906.47 429.7,-2911.14 433.47,-2915.8 433.47,-2915.8 476.53,-2969.13 476.53,-2969.13 480.3,-2973.8 478.07,-2978.47 472.07,-2978.47"/>
<text text-anchor="middle" x="342" y="-2945.47" font-family="Arial" font-size="10.00">Layer 77 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="342" y="-2934.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer77_attn_out_6&#45;&gt;layer77_attn_ar -->
<g id="edge1246" class="edge">
<title>layer77_attn_out_6&#45;&gt;layer77_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M197.48,-3050.41C221.92,-3032.33 256.86,-3006.47 286.27,-2984.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="288.45,-2987.45 294.4,-2978.69 284.28,-2981.82 288.45,-2987.45"/>
</g>
<!-- layer77_attn_out_7&#45;&gt;layer77_attn_ar -->
<g id="edge1247" class="edge">
<title>layer77_attn_out_7&#45;&gt;layer77_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M488.17,-3050.41C463.45,-3032.33 428.11,-3006.47 398.37,-2984.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="400.28,-2981.77 390.14,-2978.69 396.14,-2987.42 400.28,-2981.77"/>
</g>
<!-- layer77_ffn1_6 -->
<g id="node1093" class="node">
<title>layer77_ffn1_6</title>
<path fill="#e6f3ff" stroke="black" d="M312,-2834.47C312,-2834.47 42,-2834.47 42,-2834.47 36,-2834.47 30,-2828.47 30,-2822.47 30,-2822.47 30,-2799.47 30,-2799.47 30,-2793.47 36,-2787.47 42,-2787.47 42,-2787.47 312,-2787.47 312,-2787.47 318,-2787.47 324,-2793.47 324,-2799.47 324,-2799.47 324,-2822.47 324,-2822.47 324,-2828.47 318,-2834.47 312,-2834.47"/>
<text text-anchor="middle" x="177" y="-2819.47" font-family="Arial" font-size="10.00">Layer 77 FFN1 GPU6</text>
<text text-anchor="middle" x="177" y="-2808.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="177" y="-2797.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer77_attn_ar&#45;&gt;layer77_ffn1_6 -->
<g id="edge1248" class="edge">
<title>layer77_attn_ar&#45;&gt;layer77_ffn1_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M297.35,-2906.42C271.28,-2885.96 238.78,-2860.45 214.12,-2841.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="216.11,-2838.21 206.08,-2834.79 211.79,-2843.72 216.11,-2838.21"/>
</g>
<!-- layer77_ffn1_7 -->
<g id="node1094" class="node">
<title>layer77_ffn1_7</title>
<path fill="#e6f3ff" stroke="black" d="M642,-2834.47C642,-2834.47 372,-2834.47 372,-2834.47 366,-2834.47 360,-2828.47 360,-2822.47 360,-2822.47 360,-2799.47 360,-2799.47 360,-2793.47 366,-2787.47 372,-2787.47 372,-2787.47 642,-2787.47 642,-2787.47 648,-2787.47 654,-2793.47 654,-2799.47 654,-2799.47 654,-2822.47 654,-2822.47 654,-2828.47 648,-2834.47 642,-2834.47"/>
<text text-anchor="middle" x="507" y="-2819.47" font-family="Arial" font-size="10.00">Layer 77 FFN1 GPU7</text>
<text text-anchor="middle" x="507" y="-2808.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="507" y="-2797.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer77_attn_ar&#45;&gt;layer77_ffn1_7 -->
<g id="edge1249" class="edge">
<title>layer77_attn_ar&#45;&gt;layer77_ffn1_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M386.65,-2906.42C412.72,-2885.96 445.22,-2860.45 469.88,-2841.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="472.21,-2843.72 477.92,-2834.79 467.89,-2838.21 472.21,-2843.72"/>
</g>
<!-- layer77_act_6 -->
<g id="node1095" class="node">
<title>layer77_act_6</title>
<path fill="#e6f3ff" stroke="black" d="M312,-2715.47C312,-2715.47 42,-2715.47 42,-2715.47 36,-2715.47 30,-2709.47 30,-2703.47 30,-2703.47 30,-2680.47 30,-2680.47 30,-2674.47 36,-2668.47 42,-2668.47 42,-2668.47 312,-2668.47 312,-2668.47 318,-2668.47 324,-2674.47 324,-2680.47 324,-2680.47 324,-2703.47 324,-2703.47 324,-2709.47 318,-2715.47 312,-2715.47"/>
<text text-anchor="middle" x="177" y="-2700.47" font-family="Arial" font-size="10.00">Layer 77 SiLU GPU6</text>
<text text-anchor="middle" x="177" y="-2689.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="177" y="-2678.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer77_ffn1_6&#45;&gt;layer77_act_6 -->
<g id="edge1250" class="edge">
<title>layer77_ffn1_6&#45;&gt;layer77_act_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M177,-2787.41C177,-2769.96 177,-2745.55 177,-2725.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="180.5,-2725.86 177,-2715.86 173.5,-2725.86 180.5,-2725.86"/>
</g>
<!-- layer77_act_7 -->
<g id="node1096" class="node">
<title>layer77_act_7</title>
<path fill="#e6f3ff" stroke="black" d="M642,-2715.47C642,-2715.47 372,-2715.47 372,-2715.47 366,-2715.47 360,-2709.47 360,-2703.47 360,-2703.47 360,-2680.47 360,-2680.47 360,-2674.47 366,-2668.47 372,-2668.47 372,-2668.47 642,-2668.47 642,-2668.47 648,-2668.47 654,-2674.47 654,-2680.47 654,-2680.47 654,-2703.47 654,-2703.47 654,-2709.47 648,-2715.47 642,-2715.47"/>
<text text-anchor="middle" x="507" y="-2700.47" font-family="Arial" font-size="10.00">Layer 77 SiLU GPU7</text>
<text text-anchor="middle" x="507" y="-2689.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="507" y="-2678.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer77_ffn1_7&#45;&gt;layer77_act_7 -->
<g id="edge1251" class="edge">
<title>layer77_ffn1_7&#45;&gt;layer77_act_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M507,-2787.41C507,-2769.96 507,-2745.55 507,-2725.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="510.5,-2725.86 507,-2715.86 503.5,-2725.86 510.5,-2725.86"/>
</g>
<!-- layer77_ffn2_6 -->
<g id="node1097" class="node">
<title>layer77_ffn2_6</title>
<path fill="#e6f3ff" stroke="black" d="M311.5,-2596.47C311.5,-2596.47 48.5,-2596.47 48.5,-2596.47 42.5,-2596.47 36.5,-2590.47 36.5,-2584.47 36.5,-2584.47 36.5,-2561.47 36.5,-2561.47 36.5,-2555.47 42.5,-2549.47 48.5,-2549.47 48.5,-2549.47 311.5,-2549.47 311.5,-2549.47 317.5,-2549.47 323.5,-2555.47 323.5,-2561.47 323.5,-2561.47 323.5,-2584.47 323.5,-2584.47 323.5,-2590.47 317.5,-2596.47 311.5,-2596.47"/>
<text text-anchor="middle" x="180" y="-2581.47" font-family="Arial" font-size="10.00">Layer 77 FFN2 GPU6</text>
<text text-anchor="middle" x="180" y="-2570.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="180" y="-2559.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer77_act_6&#45;&gt;layer77_ffn2_6 -->
<g id="edge1252" class="edge">
<title>layer77_act_6&#45;&gt;layer77_ffn2_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M177.58,-2668.41C178.03,-2650.96 178.65,-2626.55 179.16,-2606.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="182.66,-2606.94 179.41,-2596.86 175.66,-2606.76 182.66,-2606.94"/>
</g>
<!-- layer77_ffn2_7 -->
<g id="node1098" class="node">
<title>layer77_ffn2_7</title>
<path fill="#e6f3ff" stroke="black" d="M636.5,-2596.47C636.5,-2596.47 373.5,-2596.47 373.5,-2596.47 367.5,-2596.47 361.5,-2590.47 361.5,-2584.47 361.5,-2584.47 361.5,-2561.47 361.5,-2561.47 361.5,-2555.47 367.5,-2549.47 373.5,-2549.47 373.5,-2549.47 636.5,-2549.47 636.5,-2549.47 642.5,-2549.47 648.5,-2555.47 648.5,-2561.47 648.5,-2561.47 648.5,-2584.47 648.5,-2584.47 648.5,-2590.47 642.5,-2596.47 636.5,-2596.47"/>
<text text-anchor="middle" x="505" y="-2581.47" font-family="Arial" font-size="10.00">Layer 77 FFN2 GPU7</text>
<text text-anchor="middle" x="505" y="-2570.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="505" y="-2559.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer77_act_7&#45;&gt;layer77_ffn2_7 -->
<g id="edge1253" class="edge">
<title>layer77_act_7&#45;&gt;layer77_ffn2_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M506.61,-2668.41C506.32,-2650.96 505.9,-2626.55 505.56,-2606.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="509.06,-2606.8 505.39,-2596.86 502.06,-2606.92 509.06,-2606.8"/>
</g>
<!-- layer77_ffn_ar -->
<g id="node1099" class="node">
<title>layer77_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M473.22,-2477.47C473.22,-2477.47 267.8,-2477.47 267.8,-2477.47 261.8,-2477.47 252,-2472.83 248.19,-2468.19 248.19,-2468.19 204.39,-2414.75 204.39,-2414.75 200.59,-2410.11 202.78,-2405.47 208.78,-2405.47 208.78,-2405.47 414.2,-2405.47 414.2,-2405.47 420.2,-2405.47 430,-2410.11 433.81,-2414.75 433.81,-2414.75 477.61,-2468.19 477.61,-2468.19 481.41,-2472.83 479.22,-2477.47 473.22,-2477.47"/>
<text text-anchor="middle" x="341" y="-2444.47" font-family="Arial" font-size="10.00">Layer 77 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="341" y="-2433.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer77_ffn2_6&#45;&gt;layer77_ffn_ar -->
<g id="edge1254" class="edge">
<title>layer77_ffn2_6&#45;&gt;layer77_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M208.04,-2549.41C230.43,-2531.41 262.4,-2505.69 289.38,-2483.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="291.61,-2486.68 297.21,-2477.69 287.23,-2481.23 291.61,-2486.68"/>
</g>
<!-- layer77_ffn2_7&#45;&gt;layer77_ffn_ar -->
<g id="edge1255" class="edge">
<title>layer77_ffn2_7&#45;&gt;layer77_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M476.43,-2549.41C453.63,-2531.41 421.06,-2505.69 393.58,-2483.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="395.62,-2481.14 385.6,-2477.69 391.28,-2486.63 395.62,-2481.14"/>
</g>
<!-- layer78_qkv_6 -->
<g id="node1100" class="node">
<title>layer78_qkv_6</title>
<path fill="#e6f3ff" stroke="black" d="M311,-2333.47C311,-2333.47 13,-2333.47 13,-2333.47 7,-2333.47 1,-2327.47 1,-2321.47 1,-2321.47 1,-2298.47 1,-2298.47 1,-2292.47 7,-2286.47 13,-2286.47 13,-2286.47 311,-2286.47 311,-2286.47 317,-2286.47 323,-2292.47 323,-2298.47 323,-2298.47 323,-2321.47 323,-2321.47 323,-2327.47 317,-2333.47 311,-2333.47"/>
<text text-anchor="middle" x="162" y="-2318.47" font-family="Arial" font-size="10.00">Layer 78 QKV Proj GPU6</text>
<text text-anchor="middle" x="162" y="-2307.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="162" y="-2296.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer77_ffn_ar&#45;&gt;layer78_qkv_6 -->
<g id="edge1256" class="edge">
<title>layer77_ffn_ar&#45;&gt;layer78_qkv_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M292.56,-2405.42C264.06,-2384.81 228.48,-2359.06 201.66,-2339.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="203.43,-2336.62 193.28,-2333.6 199.33,-2342.3 203.43,-2336.62"/>
</g>
<!-- layer78_qkv_7 -->
<g id="node1101" class="node">
<title>layer78_qkv_7</title>
<path fill="#e6f3ff" stroke="black" d="M669,-2333.47C669,-2333.47 371,-2333.47 371,-2333.47 365,-2333.47 359,-2327.47 359,-2321.47 359,-2321.47 359,-2298.47 359,-2298.47 359,-2292.47 365,-2286.47 371,-2286.47 371,-2286.47 669,-2286.47 669,-2286.47 675,-2286.47 681,-2292.47 681,-2298.47 681,-2298.47 681,-2321.47 681,-2321.47 681,-2327.47 675,-2333.47 669,-2333.47"/>
<text text-anchor="middle" x="520" y="-2318.47" font-family="Arial" font-size="10.00">Layer 78 QKV Proj GPU7</text>
<text text-anchor="middle" x="520" y="-2307.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="520" y="-2296.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer77_ffn_ar&#45;&gt;layer78_qkv_7 -->
<g id="edge1257" class="edge">
<title>layer77_ffn_ar&#45;&gt;layer78_qkv_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M389.44,-2405.42C417.94,-2384.81 453.52,-2359.06 480.34,-2339.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="482.67,-2342.3 488.72,-2333.6 478.57,-2336.62 482.67,-2342.3"/>
</g>
<!-- layer78_attn_6 -->
<g id="node1102" class="node">
<title>layer78_attn_6</title>
<path fill="#e6f3ff" stroke="black" d="M311,-2214.47C311,-2214.47 13,-2214.47 13,-2214.47 7,-2214.47 1,-2208.47 1,-2202.47 1,-2202.47 1,-2179.47 1,-2179.47 1,-2173.47 7,-2167.47 13,-2167.47 13,-2167.47 311,-2167.47 311,-2167.47 317,-2167.47 323,-2173.47 323,-2179.47 323,-2179.47 323,-2202.47 323,-2202.47 323,-2208.47 317,-2214.47 311,-2214.47"/>
<text text-anchor="middle" x="162" y="-2199.47" font-family="Arial" font-size="10.00">Layer 78 Attention GPU6</text>
<text text-anchor="middle" x="162" y="-2188.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="162" y="-2177.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer78_qkv_6&#45;&gt;layer78_attn_6 -->
<g id="edge1258" class="edge">
<title>layer78_qkv_6&#45;&gt;layer78_attn_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M162,-2286.41C162,-2268.96 162,-2244.55 162,-2224.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="165.5,-2224.86 162,-2214.86 158.5,-2224.86 165.5,-2224.86"/>
</g>
<!-- layer78_attn_7 -->
<g id="node1103" class="node">
<title>layer78_attn_7</title>
<path fill="#e6f3ff" stroke="black" d="M669,-2214.47C669,-2214.47 371,-2214.47 371,-2214.47 365,-2214.47 359,-2208.47 359,-2202.47 359,-2202.47 359,-2179.47 359,-2179.47 359,-2173.47 365,-2167.47 371,-2167.47 371,-2167.47 669,-2167.47 669,-2167.47 675,-2167.47 681,-2173.47 681,-2179.47 681,-2179.47 681,-2202.47 681,-2202.47 681,-2208.47 675,-2214.47 669,-2214.47"/>
<text text-anchor="middle" x="520" y="-2199.47" font-family="Arial" font-size="10.00">Layer 78 Attention GPU7</text>
<text text-anchor="middle" x="520" y="-2188.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="520" y="-2177.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer78_qkv_7&#45;&gt;layer78_attn_7 -->
<g id="edge1259" class="edge">
<title>layer78_qkv_7&#45;&gt;layer78_attn_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M520,-2286.41C520,-2268.96 520,-2244.55 520,-2224.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="523.5,-2224.86 520,-2214.86 516.5,-2224.86 523.5,-2224.86"/>
</g>
<!-- layer78_attn_out_6 -->
<g id="node1104" class="node">
<title>layer78_attn_out_6</title>
<path fill="#e6f3ff" stroke="black" d="M311,-2095.47C311,-2095.47 21,-2095.47 21,-2095.47 15,-2095.47 9,-2089.47 9,-2083.47 9,-2083.47 9,-2060.47 9,-2060.47 9,-2054.47 15,-2048.47 21,-2048.47 21,-2048.47 311,-2048.47 311,-2048.47 317,-2048.47 323,-2054.47 323,-2060.47 323,-2060.47 323,-2083.47 323,-2083.47 323,-2089.47 317,-2095.47 311,-2095.47"/>
<text text-anchor="middle" x="166" y="-2080.47" font-family="Arial" font-size="10.00">Layer 78 Attn Out GPU6</text>
<text text-anchor="middle" x="166" y="-2069.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="166" y="-2058.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer78_attn_6&#45;&gt;layer78_attn_out_6 -->
<g id="edge1260" class="edge">
<title>layer78_attn_6&#45;&gt;layer78_attn_out_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M162.77,-2167.41C163.37,-2149.96 164.2,-2125.55 164.87,-2105.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="168.37,-2105.97 165.22,-2095.86 161.38,-2105.73 168.37,-2105.97"/>
</g>
<!-- layer78_attn_out_7 -->
<g id="node1105" class="node">
<title>layer78_attn_out_7</title>
<path fill="#e6f3ff" stroke="black" d="M663,-2095.47C663,-2095.47 373,-2095.47 373,-2095.47 367,-2095.47 361,-2089.47 361,-2083.47 361,-2083.47 361,-2060.47 361,-2060.47 361,-2054.47 367,-2048.47 373,-2048.47 373,-2048.47 663,-2048.47 663,-2048.47 669,-2048.47 675,-2054.47 675,-2060.47 675,-2060.47 675,-2083.47 675,-2083.47 675,-2089.47 669,-2095.47 663,-2095.47"/>
<text text-anchor="middle" x="518" y="-2080.47" font-family="Arial" font-size="10.00">Layer 78 Attn Out GPU7</text>
<text text-anchor="middle" x="518" y="-2069.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="518" y="-2058.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer78_attn_7&#45;&gt;layer78_attn_out_7 -->
<g id="edge1261" class="edge">
<title>layer78_attn_7&#45;&gt;layer78_attn_out_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M519.61,-2167.41C519.32,-2149.96 518.9,-2125.55 518.56,-2105.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="522.06,-2105.8 518.39,-2095.86 515.06,-2105.92 522.06,-2105.8"/>
</g>
<!-- layer78_attn_ar -->
<g id="node1106" class="node">
<title>layer78_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M471.07,-1976.47C471.07,-1976.47 269.07,-1976.47 269.07,-1976.47 263.07,-1976.47 253.3,-1971.8 249.53,-1967.13 249.53,-1967.13 206.47,-1913.8 206.47,-1913.8 202.7,-1909.14 204.93,-1904.47 210.93,-1904.47 210.93,-1904.47 412.93,-1904.47 412.93,-1904.47 418.93,-1904.47 428.7,-1909.14 432.47,-1913.8 432.47,-1913.8 475.53,-1967.13 475.53,-1967.13 479.3,-1971.8 477.07,-1976.47 471.07,-1976.47"/>
<text text-anchor="middle" x="341" y="-1943.47" font-family="Arial" font-size="10.00">Layer 78 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="341" y="-1932.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer78_attn_out_6&#45;&gt;layer78_attn_ar -->
<g id="edge1262" class="edge">
<title>layer78_attn_out_6&#45;&gt;layer78_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M196.48,-2048.41C220.92,-2030.33 255.86,-2004.47 285.27,-1982.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="287.45,-1985.45 293.4,-1976.69 283.28,-1979.82 287.45,-1985.45"/>
</g>
<!-- layer78_attn_out_7&#45;&gt;layer78_attn_ar -->
<g id="edge1263" class="edge">
<title>layer78_attn_out_7&#45;&gt;layer78_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M487.17,-2048.41C462.45,-2030.33 427.11,-2004.47 397.37,-1982.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="399.28,-1979.77 389.14,-1976.69 395.14,-1985.42 399.28,-1979.77"/>
</g>
<!-- layer78_ffn1_6 -->
<g id="node1107" class="node">
<title>layer78_ffn1_6</title>
<path fill="#e6f3ff" stroke="black" d="M311,-1832.47C311,-1832.47 41,-1832.47 41,-1832.47 35,-1832.47 29,-1826.47 29,-1820.47 29,-1820.47 29,-1797.47 29,-1797.47 29,-1791.47 35,-1785.47 41,-1785.47 41,-1785.47 311,-1785.47 311,-1785.47 317,-1785.47 323,-1791.47 323,-1797.47 323,-1797.47 323,-1820.47 323,-1820.47 323,-1826.47 317,-1832.47 311,-1832.47"/>
<text text-anchor="middle" x="176" y="-1817.47" font-family="Arial" font-size="10.00">Layer 78 FFN1 GPU6</text>
<text text-anchor="middle" x="176" y="-1806.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="176" y="-1795.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer78_attn_ar&#45;&gt;layer78_ffn1_6 -->
<g id="edge1264" class="edge">
<title>layer78_attn_ar&#45;&gt;layer78_ffn1_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M296.35,-1904.42C270.28,-1883.96 237.78,-1858.45 213.12,-1839.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="215.11,-1836.21 205.08,-1832.79 210.79,-1841.72 215.11,-1836.21"/>
</g>
<!-- layer78_ffn1_7 -->
<g id="node1108" class="node">
<title>layer78_ffn1_7</title>
<path fill="#e6f3ff" stroke="black" d="M641,-1832.47C641,-1832.47 371,-1832.47 371,-1832.47 365,-1832.47 359,-1826.47 359,-1820.47 359,-1820.47 359,-1797.47 359,-1797.47 359,-1791.47 365,-1785.47 371,-1785.47 371,-1785.47 641,-1785.47 641,-1785.47 647,-1785.47 653,-1791.47 653,-1797.47 653,-1797.47 653,-1820.47 653,-1820.47 653,-1826.47 647,-1832.47 641,-1832.47"/>
<text text-anchor="middle" x="506" y="-1817.47" font-family="Arial" font-size="10.00">Layer 78 FFN1 GPU7</text>
<text text-anchor="middle" x="506" y="-1806.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="506" y="-1795.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer78_attn_ar&#45;&gt;layer78_ffn1_7 -->
<g id="edge1265" class="edge">
<title>layer78_attn_ar&#45;&gt;layer78_ffn1_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M385.65,-1904.42C411.72,-1883.96 444.22,-1858.45 468.88,-1839.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="471.21,-1841.72 476.92,-1832.79 466.89,-1836.21 471.21,-1841.72"/>
</g>
<!-- layer78_act_6 -->
<g id="node1109" class="node">
<title>layer78_act_6</title>
<path fill="#e6f3ff" stroke="black" d="M311,-1713.47C311,-1713.47 41,-1713.47 41,-1713.47 35,-1713.47 29,-1707.47 29,-1701.47 29,-1701.47 29,-1678.47 29,-1678.47 29,-1672.47 35,-1666.47 41,-1666.47 41,-1666.47 311,-1666.47 311,-1666.47 317,-1666.47 323,-1672.47 323,-1678.47 323,-1678.47 323,-1701.47 323,-1701.47 323,-1707.47 317,-1713.47 311,-1713.47"/>
<text text-anchor="middle" x="176" y="-1698.47" font-family="Arial" font-size="10.00">Layer 78 SiLU GPU6</text>
<text text-anchor="middle" x="176" y="-1687.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="176" y="-1676.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer78_ffn1_6&#45;&gt;layer78_act_6 -->
<g id="edge1266" class="edge">
<title>layer78_ffn1_6&#45;&gt;layer78_act_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M176,-1785.41C176,-1767.96 176,-1743.55 176,-1723.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="179.5,-1723.86 176,-1713.86 172.5,-1723.86 179.5,-1723.86"/>
</g>
<!-- layer78_act_7 -->
<g id="node1110" class="node">
<title>layer78_act_7</title>
<path fill="#e6f3ff" stroke="black" d="M641,-1713.47C641,-1713.47 371,-1713.47 371,-1713.47 365,-1713.47 359,-1707.47 359,-1701.47 359,-1701.47 359,-1678.47 359,-1678.47 359,-1672.47 365,-1666.47 371,-1666.47 371,-1666.47 641,-1666.47 641,-1666.47 647,-1666.47 653,-1672.47 653,-1678.47 653,-1678.47 653,-1701.47 653,-1701.47 653,-1707.47 647,-1713.47 641,-1713.47"/>
<text text-anchor="middle" x="506" y="-1698.47" font-family="Arial" font-size="10.00">Layer 78 SiLU GPU7</text>
<text text-anchor="middle" x="506" y="-1687.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="506" y="-1676.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer78_ffn1_7&#45;&gt;layer78_act_7 -->
<g id="edge1267" class="edge">
<title>layer78_ffn1_7&#45;&gt;layer78_act_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M506,-1785.41C506,-1767.96 506,-1743.55 506,-1723.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="509.5,-1723.86 506,-1713.86 502.5,-1723.86 509.5,-1723.86"/>
</g>
<!-- layer78_ffn2_6 -->
<g id="node1111" class="node">
<title>layer78_ffn2_6</title>
<path fill="#e6f3ff" stroke="black" d="M310.5,-1594.47C310.5,-1594.47 47.5,-1594.47 47.5,-1594.47 41.5,-1594.47 35.5,-1588.47 35.5,-1582.47 35.5,-1582.47 35.5,-1559.47 35.5,-1559.47 35.5,-1553.47 41.5,-1547.47 47.5,-1547.47 47.5,-1547.47 310.5,-1547.47 310.5,-1547.47 316.5,-1547.47 322.5,-1553.47 322.5,-1559.47 322.5,-1559.47 322.5,-1582.47 322.5,-1582.47 322.5,-1588.47 316.5,-1594.47 310.5,-1594.47"/>
<text text-anchor="middle" x="179" y="-1579.47" font-family="Arial" font-size="10.00">Layer 78 FFN2 GPU6</text>
<text text-anchor="middle" x="179" y="-1568.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="179" y="-1557.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer78_act_6&#45;&gt;layer78_ffn2_6 -->
<g id="edge1268" class="edge">
<title>layer78_act_6&#45;&gt;layer78_ffn2_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M176.58,-1666.41C177.03,-1648.96 177.65,-1624.55 178.16,-1604.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="181.66,-1604.94 178.41,-1594.86 174.66,-1604.76 181.66,-1604.94"/>
</g>
<!-- layer78_ffn2_7 -->
<g id="node1112" class="node">
<title>layer78_ffn2_7</title>
<path fill="#e6f3ff" stroke="black" d="M635.5,-1594.47C635.5,-1594.47 372.5,-1594.47 372.5,-1594.47 366.5,-1594.47 360.5,-1588.47 360.5,-1582.47 360.5,-1582.47 360.5,-1559.47 360.5,-1559.47 360.5,-1553.47 366.5,-1547.47 372.5,-1547.47 372.5,-1547.47 635.5,-1547.47 635.5,-1547.47 641.5,-1547.47 647.5,-1553.47 647.5,-1559.47 647.5,-1559.47 647.5,-1582.47 647.5,-1582.47 647.5,-1588.47 641.5,-1594.47 635.5,-1594.47"/>
<text text-anchor="middle" x="504" y="-1579.47" font-family="Arial" font-size="10.00">Layer 78 FFN2 GPU7</text>
<text text-anchor="middle" x="504" y="-1568.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="504" y="-1557.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer78_act_7&#45;&gt;layer78_ffn2_7 -->
<g id="edge1269" class="edge">
<title>layer78_act_7&#45;&gt;layer78_ffn2_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M505.61,-1666.41C505.32,-1648.96 504.9,-1624.55 504.56,-1604.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="508.06,-1604.8 504.39,-1594.86 501.06,-1604.92 508.06,-1604.8"/>
</g>
<!-- layer78_ffn_ar -->
<g id="node1113" class="node">
<title>layer78_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M472.22,-1475.47C472.22,-1475.47 266.8,-1475.47 266.8,-1475.47 260.8,-1475.47 251,-1470.83 247.19,-1466.19 247.19,-1466.19 203.39,-1412.75 203.39,-1412.75 199.59,-1408.11 201.78,-1403.47 207.78,-1403.47 207.78,-1403.47 413.2,-1403.47 413.2,-1403.47 419.2,-1403.47 429,-1408.11 432.81,-1412.75 432.81,-1412.75 476.61,-1466.19 476.61,-1466.19 480.41,-1470.83 478.22,-1475.47 472.22,-1475.47"/>
<text text-anchor="middle" x="340" y="-1442.47" font-family="Arial" font-size="10.00">Layer 78 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="340" y="-1431.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer78_ffn2_6&#45;&gt;layer78_ffn_ar -->
<g id="edge1270" class="edge">
<title>layer78_ffn2_6&#45;&gt;layer78_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M207.04,-1547.41C229.43,-1529.41 261.4,-1503.69 288.38,-1481.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="290.61,-1484.68 296.21,-1475.69 286.23,-1479.23 290.61,-1484.68"/>
</g>
<!-- layer78_ffn2_7&#45;&gt;layer78_ffn_ar -->
<g id="edge1271" class="edge">
<title>layer78_ffn2_7&#45;&gt;layer78_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M475.43,-1547.41C452.63,-1529.41 420.06,-1503.69 392.58,-1481.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="394.62,-1479.14 384.6,-1475.69 390.28,-1484.63 394.62,-1479.14"/>
</g>
<!-- layer79_qkv_6 -->
<g id="node1114" class="node">
<title>layer79_qkv_6</title>
<path fill="#e6f3ff" stroke="black" d="M310,-1331.47C310,-1331.47 12,-1331.47 12,-1331.47 6,-1331.47 0,-1325.47 0,-1319.47 0,-1319.47 0,-1296.47 0,-1296.47 0,-1290.47 6,-1284.47 12,-1284.47 12,-1284.47 310,-1284.47 310,-1284.47 316,-1284.47 322,-1290.47 322,-1296.47 322,-1296.47 322,-1319.47 322,-1319.47 322,-1325.47 316,-1331.47 310,-1331.47"/>
<text text-anchor="middle" x="161" y="-1316.47" font-family="Arial" font-size="10.00">Layer 79 QKV Proj GPU6</text>
<text text-anchor="middle" x="161" y="-1305.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="161" y="-1294.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer78_ffn_ar&#45;&gt;layer79_qkv_6 -->
<g id="edge1272" class="edge">
<title>layer78_ffn_ar&#45;&gt;layer79_qkv_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M291.56,-1403.42C263.06,-1382.81 227.48,-1357.06 200.66,-1337.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="202.43,-1334.62 192.28,-1331.6 198.33,-1340.3 202.43,-1334.62"/>
</g>
<!-- layer79_qkv_7 -->
<g id="node1115" class="node">
<title>layer79_qkv_7</title>
<path fill="#e6f3ff" stroke="black" d="M668,-1331.47C668,-1331.47 370,-1331.47 370,-1331.47 364,-1331.47 358,-1325.47 358,-1319.47 358,-1319.47 358,-1296.47 358,-1296.47 358,-1290.47 364,-1284.47 370,-1284.47 370,-1284.47 668,-1284.47 668,-1284.47 674,-1284.47 680,-1290.47 680,-1296.47 680,-1296.47 680,-1319.47 680,-1319.47 680,-1325.47 674,-1331.47 668,-1331.47"/>
<text text-anchor="middle" x="519" y="-1316.47" font-family="Arial" font-size="10.00">Layer 79 QKV Proj GPU7</text>
<text text-anchor="middle" x="519" y="-1305.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="519" y="-1294.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer78_ffn_ar&#45;&gt;layer79_qkv_7 -->
<g id="edge1273" class="edge">
<title>layer78_ffn_ar&#45;&gt;layer79_qkv_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M388.44,-1403.42C416.94,-1382.81 452.52,-1357.06 479.34,-1337.66"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="481.67,-1340.3 487.72,-1331.6 477.57,-1334.62 481.67,-1340.3"/>
</g>
<!-- layer79_attn_6 -->
<g id="node1116" class="node">
<title>layer79_attn_6</title>
<path fill="#e6f3ff" stroke="black" d="M310,-1212.47C310,-1212.47 12,-1212.47 12,-1212.47 6,-1212.47 0,-1206.47 0,-1200.47 0,-1200.47 0,-1177.47 0,-1177.47 0,-1171.47 6,-1165.47 12,-1165.47 12,-1165.47 310,-1165.47 310,-1165.47 316,-1165.47 322,-1171.47 322,-1177.47 322,-1177.47 322,-1200.47 322,-1200.47 322,-1206.47 316,-1212.47 310,-1212.47"/>
<text text-anchor="middle" x="161" y="-1197.47" font-family="Arial" font-size="10.00">Layer 79 Attention GPU6</text>
<text text-anchor="middle" x="161" y="-1186.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="161" y="-1175.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer79_qkv_6&#45;&gt;layer79_attn_6 -->
<g id="edge1274" class="edge">
<title>layer79_qkv_6&#45;&gt;layer79_attn_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M161,-1284.41C161,-1266.96 161,-1242.55 161,-1222.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="164.5,-1222.86 161,-1212.86 157.5,-1222.86 164.5,-1222.86"/>
</g>
<!-- layer79_attn_7 -->
<g id="node1117" class="node">
<title>layer79_attn_7</title>
<path fill="#e6f3ff" stroke="black" d="M668,-1212.47C668,-1212.47 370,-1212.47 370,-1212.47 364,-1212.47 358,-1206.47 358,-1200.47 358,-1200.47 358,-1177.47 358,-1177.47 358,-1171.47 364,-1165.47 370,-1165.47 370,-1165.47 668,-1165.47 668,-1165.47 674,-1165.47 680,-1171.47 680,-1177.47 680,-1177.47 680,-1200.47 680,-1200.47 680,-1206.47 674,-1212.47 668,-1212.47"/>
<text text-anchor="middle" x="519" y="-1197.47" font-family="Arial" font-size="10.00">Layer 79 Attention GPU7</text>
<text text-anchor="middle" x="519" y="-1186.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="519" y="-1175.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
</g>
<!-- layer79_qkv_7&#45;&gt;layer79_attn_7 -->
<g id="edge1275" class="edge">
<title>layer79_qkv_7&#45;&gt;layer79_attn_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M519,-1284.41C519,-1266.96 519,-1242.55 519,-1222.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="522.5,-1222.86 519,-1212.86 515.5,-1222.86 522.5,-1222.86"/>
</g>
<!-- layer79_attn_out_6 -->
<g id="node1118" class="node">
<title>layer79_attn_out_6</title>
<path fill="#e6f3ff" stroke="black" d="M310,-1093.47C310,-1093.47 20,-1093.47 20,-1093.47 14,-1093.47 8,-1087.47 8,-1081.47 8,-1081.47 8,-1058.47 8,-1058.47 8,-1052.47 14,-1046.47 20,-1046.47 20,-1046.47 310,-1046.47 310,-1046.47 316,-1046.47 322,-1052.47 322,-1058.47 322,-1058.47 322,-1081.47 322,-1081.47 322,-1087.47 316,-1093.47 310,-1093.47"/>
<text text-anchor="middle" x="165" y="-1078.47" font-family="Arial" font-size="10.00">Layer 79 Attn Out GPU6</text>
<text text-anchor="middle" x="165" y="-1067.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="165" y="-1056.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer79_attn_6&#45;&gt;layer79_attn_out_6 -->
<g id="edge1276" class="edge">
<title>layer79_attn_6&#45;&gt;layer79_attn_out_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M161.77,-1165.41C162.37,-1147.96 163.2,-1123.55 163.87,-1103.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="167.37,-1103.97 164.22,-1093.86 160.38,-1103.73 167.37,-1103.97"/>
</g>
<!-- layer79_attn_out_7 -->
<g id="node1119" class="node">
<title>layer79_attn_out_7</title>
<path fill="#e6f3ff" stroke="black" d="M662,-1093.47C662,-1093.47 372,-1093.47 372,-1093.47 366,-1093.47 360,-1087.47 360,-1081.47 360,-1081.47 360,-1058.47 360,-1058.47 360,-1052.47 366,-1046.47 372,-1046.47 372,-1046.47 662,-1046.47 662,-1046.47 668,-1046.47 674,-1052.47 674,-1058.47 674,-1058.47 674,-1081.47 674,-1081.47 674,-1087.47 668,-1093.47 662,-1093.47"/>
<text text-anchor="middle" x="517" y="-1078.47" font-family="Arial" font-size="10.00">Layer 79 Attn Out GPU7</text>
<text text-anchor="middle" x="517" y="-1067.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, num_heads=32, head_dim=128]</text>
<text text-anchor="middle" x="517" y="-1056.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer79_attn_7&#45;&gt;layer79_attn_out_7 -->
<g id="edge1277" class="edge">
<title>layer79_attn_7&#45;&gt;layer79_attn_out_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M518.61,-1165.41C518.32,-1147.96 517.9,-1123.55 517.56,-1103.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="521.06,-1103.8 517.39,-1093.86 514.06,-1103.92 521.06,-1103.8"/>
</g>
<!-- layer79_attn_ar -->
<g id="node1120" class="node">
<title>layer79_attn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M470.07,-974.47C470.07,-974.47 268.07,-974.47 268.07,-974.47 262.07,-974.47 252.3,-969.8 248.53,-965.13 248.53,-965.13 205.47,-911.8 205.47,-911.8 201.7,-907.14 203.93,-902.47 209.93,-902.47 209.93,-902.47 411.93,-902.47 411.93,-902.47 417.93,-902.47 427.7,-907.14 431.47,-911.8 431.47,-911.8 474.53,-965.13 474.53,-965.13 478.3,-969.8 476.07,-974.47 470.07,-974.47"/>
<text text-anchor="middle" x="340" y="-941.47" font-family="Arial" font-size="10.00">Layer 79 Attn All&#45;Reduce</text>
<text text-anchor="middle" x="340" y="-930.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer79_attn_out_6&#45;&gt;layer79_attn_ar -->
<g id="edge1278" class="edge">
<title>layer79_attn_out_6&#45;&gt;layer79_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M195.48,-1046.41C219.92,-1028.33 254.86,-1002.47 284.27,-980.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="286.45,-983.45 292.4,-974.69 282.28,-977.82 286.45,-983.45"/>
</g>
<!-- layer79_attn_out_7&#45;&gt;layer79_attn_ar -->
<g id="edge1279" class="edge">
<title>layer79_attn_out_7&#45;&gt;layer79_attn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M486.17,-1046.41C461.45,-1028.33 426.11,-1002.47 396.37,-980.71"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="398.28,-977.77 388.14,-974.69 394.14,-983.42 398.28,-977.77"/>
</g>
<!-- layer79_ffn1_6 -->
<g id="node1121" class="node">
<title>layer79_ffn1_6</title>
<path fill="#e6f3ff" stroke="black" d="M310,-830.47C310,-830.47 40,-830.47 40,-830.47 34,-830.47 28,-824.47 28,-818.47 28,-818.47 28,-795.47 28,-795.47 28,-789.47 34,-783.47 40,-783.47 40,-783.47 310,-783.47 310,-783.47 316,-783.47 322,-789.47 322,-795.47 322,-795.47 322,-818.47 322,-818.47 322,-824.47 316,-830.47 310,-830.47"/>
<text text-anchor="middle" x="175" y="-815.47" font-family="Arial" font-size="10.00">Layer 79 FFN1 GPU6</text>
<text text-anchor="middle" x="175" y="-804.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="175" y="-793.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer79_attn_ar&#45;&gt;layer79_ffn1_6 -->
<g id="edge1280" class="edge">
<title>layer79_attn_ar&#45;&gt;layer79_ffn1_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M295.35,-902.42C269.28,-881.96 236.78,-856.45 212.12,-837.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="214.11,-834.21 204.08,-830.79 209.79,-839.72 214.11,-834.21"/>
</g>
<!-- layer79_ffn1_7 -->
<g id="node1122" class="node">
<title>layer79_ffn1_7</title>
<path fill="#e6f3ff" stroke="black" d="M640,-830.47C640,-830.47 370,-830.47 370,-830.47 364,-830.47 358,-824.47 358,-818.47 358,-818.47 358,-795.47 358,-795.47 358,-789.47 364,-783.47 370,-783.47 370,-783.47 640,-783.47 640,-783.47 646,-783.47 652,-789.47 652,-795.47 652,-795.47 652,-818.47 652,-818.47 652,-824.47 646,-830.47 640,-830.47"/>
<text text-anchor="middle" x="505" y="-815.47" font-family="Arial" font-size="10.00">Layer 79 FFN1 GPU7</text>
<text text-anchor="middle" x="505" y="-804.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="505" y="-793.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer79_attn_ar&#45;&gt;layer79_ffn1_7 -->
<g id="edge1281" class="edge">
<title>layer79_attn_ar&#45;&gt;layer79_ffn1_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M384.65,-902.42C410.72,-881.96 443.22,-856.45 467.88,-837.1"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="470.21,-839.72 475.92,-830.79 465.89,-834.21 470.21,-839.72"/>
</g>
<!-- layer79_act_6 -->
<g id="node1123" class="node">
<title>layer79_act_6</title>
<path fill="#e6f3ff" stroke="black" d="M310,-711.47C310,-711.47 40,-711.47 40,-711.47 34,-711.47 28,-705.47 28,-699.47 28,-699.47 28,-676.47 28,-676.47 28,-670.47 34,-664.47 40,-664.47 40,-664.47 310,-664.47 310,-664.47 316,-664.47 322,-670.47 322,-676.47 322,-676.47 322,-699.47 322,-699.47 322,-705.47 316,-711.47 310,-711.47"/>
<text text-anchor="middle" x="175" y="-696.47" font-family="Arial" font-size="10.00">Layer 79 SiLU GPU6</text>
<text text-anchor="middle" x="175" y="-685.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="175" y="-674.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer79_ffn1_6&#45;&gt;layer79_act_6 -->
<g id="edge1282" class="edge">
<title>layer79_ffn1_6&#45;&gt;layer79_act_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M175,-783.41C175,-765.96 175,-741.55 175,-721.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="178.5,-721.86 175,-711.86 171.5,-721.86 178.5,-721.86"/>
</g>
<!-- layer79_act_7 -->
<g id="node1124" class="node">
<title>layer79_act_7</title>
<path fill="#e6f3ff" stroke="black" d="M640,-711.47C640,-711.47 370,-711.47 370,-711.47 364,-711.47 358,-705.47 358,-699.47 358,-699.47 358,-676.47 358,-676.47 358,-670.47 364,-664.47 370,-664.47 370,-664.47 640,-664.47 640,-664.47 646,-664.47 652,-670.47 652,-676.47 652,-676.47 652,-699.47 652,-699.47 652,-705.47 646,-711.47 640,-711.47"/>
<text text-anchor="middle" x="505" y="-696.47" font-family="Arial" font-size="10.00">Layer 79 SiLU GPU7</text>
<text text-anchor="middle" x="505" y="-685.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="505" y="-674.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
</g>
<!-- layer79_ffn1_7&#45;&gt;layer79_act_7 -->
<g id="edge1283" class="edge">
<title>layer79_ffn1_7&#45;&gt;layer79_act_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M505,-783.41C505,-765.96 505,-741.55 505,-721.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="508.5,-721.86 505,-711.86 501.5,-721.86 508.5,-721.86"/>
</g>
<!-- layer79_ffn2_6 -->
<g id="node1125" class="node">
<title>layer79_ffn2_6</title>
<path fill="#e6f3ff" stroke="black" d="M309.5,-592.47C309.5,-592.47 46.5,-592.47 46.5,-592.47 40.5,-592.47 34.5,-586.47 34.5,-580.47 34.5,-580.47 34.5,-557.47 34.5,-557.47 34.5,-551.47 40.5,-545.47 46.5,-545.47 46.5,-545.47 309.5,-545.47 309.5,-545.47 315.5,-545.47 321.5,-551.47 321.5,-557.47 321.5,-557.47 321.5,-580.47 321.5,-580.47 321.5,-586.47 315.5,-592.47 309.5,-592.47"/>
<text text-anchor="middle" x="178" y="-577.47" font-family="Arial" font-size="10.00">Layer 79 FFN2 GPU6</text>
<text text-anchor="middle" x="178" y="-566.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="178" y="-555.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer79_act_6&#45;&gt;layer79_ffn2_6 -->
<g id="edge1284" class="edge">
<title>layer79_act_6&#45;&gt;layer79_ffn2_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M175.58,-664.41C176.03,-646.96 176.65,-622.55 177.16,-602.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="180.66,-602.94 177.41,-592.86 173.66,-602.76 180.66,-602.94"/>
</g>
<!-- layer79_ffn2_7 -->
<g id="node1126" class="node">
<title>layer79_ffn2_7</title>
<path fill="#e6f3ff" stroke="black" d="M634.5,-592.47C634.5,-592.47 371.5,-592.47 371.5,-592.47 365.5,-592.47 359.5,-586.47 359.5,-580.47 359.5,-580.47 359.5,-557.47 359.5,-557.47 359.5,-551.47 365.5,-545.47 371.5,-545.47 371.5,-545.47 634.5,-545.47 634.5,-545.47 640.5,-545.47 646.5,-551.47 646.5,-557.47 646.5,-557.47 646.5,-580.47 646.5,-580.47 646.5,-586.47 640.5,-592.47 634.5,-592.47"/>
<text text-anchor="middle" x="503" y="-577.47" font-family="Arial" font-size="10.00">Layer 79 FFN2 GPU7</text>
<text text-anchor="middle" x="503" y="-566.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, intermediate_size=14336]</text>
<text text-anchor="middle" x="503" y="-555.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer79_act_7&#45;&gt;layer79_ffn2_7 -->
<g id="edge1285" class="edge">
<title>layer79_act_7&#45;&gt;layer79_ffn2_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M504.61,-664.41C504.32,-646.96 503.9,-622.55 503.56,-602.91"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="507.06,-602.8 503.39,-592.86 500.06,-602.92 507.06,-602.8"/>
</g>
<!-- layer79_ffn_ar -->
<g id="node1127" class="node">
<title>layer79_ffn_ar</title>
<path fill="#ffe6e6" stroke="black" d="M471.22,-473.47C471.22,-473.47 265.8,-473.47 265.8,-473.47 259.8,-473.47 250,-468.83 246.19,-464.19 246.19,-464.19 202.39,-410.75 202.39,-410.75 198.59,-406.11 200.78,-401.47 206.78,-401.47 206.78,-401.47 412.2,-401.47 412.2,-401.47 418.2,-401.47 428,-406.11 431.81,-410.75 431.81,-410.75 475.61,-464.19 475.61,-464.19 479.41,-468.83 477.22,-473.47 471.22,-473.47"/>
<text text-anchor="middle" x="339" y="-440.47" font-family="Arial" font-size="10.00">Layer 79 FFN All&#45;Reduce</text>
<text text-anchor="middle" x="339" y="-429.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- layer79_ffn2_6&#45;&gt;layer79_ffn_ar -->
<g id="edge1286" class="edge">
<title>layer79_ffn2_6&#45;&gt;layer79_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M206.04,-545.41C228.43,-527.41 260.4,-501.69 287.38,-479.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="289.61,-482.68 295.21,-473.69 285.23,-477.23 289.61,-482.68"/>
</g>
<!-- layer79_ffn2_7&#45;&gt;layer79_ffn_ar -->
<g id="edge1287" class="edge">
<title>layer79_ffn2_7&#45;&gt;layer79_ffn_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M474.43,-545.41C451.63,-527.41 419.06,-501.69 391.58,-479.99"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="393.62,-477.14 383.6,-473.69 389.28,-482.63 393.62,-477.14"/>
</g>
<!-- output_proj_6 -->
<g id="node1128" class="node">
<title>output_proj_6</title>
<path fill="#e6f3ff" stroke="black" d="M309,-329.47C309,-329.47 69,-329.47 69,-329.47 63,-329.47 57,-323.47 57,-317.47 57,-317.47 57,-294.47 57,-294.47 57,-288.47 63,-282.47 69,-282.47 69,-282.47 309,-282.47 309,-282.47 315,-282.47 321,-288.47 321,-294.47 321,-294.47 321,-317.47 321,-317.47 321,-323.47 315,-329.47 309,-329.47"/>
<text text-anchor="middle" x="189" y="-314.47" font-family="Arial" font-size="10.00">Output Projection GPU6</text>
<text text-anchor="middle" x="189" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="189" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer79_ffn_ar&#45;&gt;output_proj_6 -->
<g id="edge1288" class="edge">
<title>layer79_ffn_ar&#45;&gt;output_proj_6</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M298.41,-401.42C274.81,-381.05 245.42,-355.68 223.04,-336.36"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="225.3,-333.68 215.44,-329.79 220.72,-338.98 225.3,-333.68"/>
</g>
<!-- output_proj_7 -->
<g id="node1129" class="node">
<title>output_proj_7</title>
<path fill="#e6f3ff" stroke="black" d="M609,-329.47C609,-329.47 369,-329.47 369,-329.47 363,-329.47 357,-323.47 357,-317.47 357,-317.47 357,-294.47 357,-294.47 357,-288.47 363,-282.47 369,-282.47 369,-282.47 609,-282.47 609,-282.47 615,-282.47 621,-288.47 621,-294.47 621,-294.47 621,-317.47 621,-317.47 621,-323.47 615,-329.47 609,-329.47"/>
<text text-anchor="middle" x="489" y="-314.47" font-family="Arial" font-size="10.00">Output Projection GPU7</text>
<text text-anchor="middle" x="489" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="489" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden_size=4096]</text>
</g>
<!-- layer79_ffn_ar&#45;&gt;output_proj_7 -->
<g id="edge1289" class="edge">
<title>layer79_ffn_ar&#45;&gt;output_proj_7</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M379.59,-401.42C403.19,-381.05 432.58,-355.68 454.96,-336.36"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="457.28,-338.98 462.56,-329.79 452.7,-333.68 457.28,-338.98"/>
</g>
<!-- final_output_ar -->
<g id="node1130" class="node">
<title>final_output_ar</title>
<path fill="#ffe6e6" stroke="black" d="M463.7,-210.47C463.7,-210.47 270.24,-210.47 270.24,-210.47 264.24,-210.47 254.56,-205.73 250.88,-200.99 250.88,-200.99 209.66,-147.94 209.66,-147.94 205.98,-143.21 208.3,-138.47 214.3,-138.47 214.3,-138.47 407.76,-138.47 407.76,-138.47 413.76,-138.47 423.44,-143.21 427.12,-147.94 427.12,-147.94 468.34,-200.99 468.34,-200.99 472.02,-205.73 469.7,-210.47 463.7,-210.47"/>
<text text-anchor="middle" x="339" y="-177.47" font-family="Arial" font-size="10.00">Final Output All&#45;Reduce</text>
<text text-anchor="middle" x="339" y="-166.47" font-family="Arial" font-size="10.00">[TP All&#45;Reduce]</text>
</g>
<!-- output_proj_6&#45;&gt;final_output_ar -->
<g id="edge1290" class="edge">
<title>output_proj_6&#45;&gt;final_output_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M215.13,-282.41C235.89,-264.48 265.52,-238.91 290.58,-217.27"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="292.92,-219.87 298.2,-210.69 288.35,-214.57 292.92,-219.87"/>
</g>
<!-- output_proj_7&#45;&gt;final_output_ar -->
<g id="edge1291" class="edge">
<title>output_proj_7&#45;&gt;final_output_ar</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M462.87,-282.41C442.11,-264.48 412.48,-238.91 387.42,-217.27"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="389.65,-214.57 379.8,-210.69 385.08,-219.87 389.65,-214.57"/>
</g>
<!-- output -->
<g id="node1131" class="node">
<title>output</title>
<ellipse fill="#f0e6ff" stroke="black" cx="339" cy="-33.23" rx="192.17" ry="33.47"/>
<text text-anchor="middle" x="339" y="-41.73" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="339" y="-30.73" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden_size=8192]</text>
<text text-anchor="middle" x="339" y="-19.73" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, vocab_size=128256]</text>
</g>
<!-- final_output_ar&#45;&gt;output -->
<g id="edge1292" class="edge">
<title>final_output_ar&#45;&gt;output</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M339,-138.33C339,-119.62 339,-96.47 339,-76.75"/>
<polygon fill="black" stroke="black" stroke-width="1.5" points="342.5,-76.49 339,-66.49 335.5,-76.49 342.5,-76.49"/>
</g>
</g>
</svg>
