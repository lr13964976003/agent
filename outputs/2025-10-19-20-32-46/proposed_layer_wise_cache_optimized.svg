<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proposed_layer_wise_cache_optimized Pages: 1 -->
<svg width="1143pt" height="24330pt"
 viewBox="0.00 0.00 1143.00 24330.16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 24326.16)">
<title>proposed_layer_wise_cache_optimized</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-24326.16 1139,-24326.16 1139,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_gpu_0</title>
<polygon fill="#000000" stroke="lightgreen" points="36,-22834.63 36,-24240.63 1100,-24240.63 1100,-22834.63 36,-22834.63"/>
<text text-anchor="middle" x="568" y="-24225.43" font-family="Times,serif" font-size="14.00">GPU 0 &#45; Layer 1</text>
<text text-anchor="middle" x="568" y="-24210.43" font-family="Times,serif" font-size="14.00">100% SRAM/L2 Cache</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_gpu_1</title>
<polygon fill="#000000" stroke="lightgreen" points="36,-21319.09 36,-22725.09 1100,-22725.09 1100,-21319.09 36,-21319.09"/>
<text text-anchor="middle" x="568" y="-22709.89" font-family="Times,serif" font-size="14.00">GPU 1 &#45; Layer 2</text>
<text text-anchor="middle" x="568" y="-22694.89" font-family="Times,serif" font-size="14.00">100% SRAM/L2 Cache</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_gpu_2</title>
<polygon fill="#000000" stroke="lightgreen" points="27,-19803.55 27,-21209.55 1091,-21209.55 1091,-19803.55 27,-19803.55"/>
<text text-anchor="middle" x="559" y="-21194.35" font-family="Times,serif" font-size="14.00">GPU 2 &#45; Layer 3</text>
<text text-anchor="middle" x="559" y="-21179.35" font-family="Times,serif" font-size="14.00">100% SRAM/L2 Cache</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_gpu_3</title>
<polygon fill="#000000" stroke="lightgreen" points="27,-18288.01 27,-19694.01 1091,-19694.01 1091,-18288.01 27,-18288.01"/>
<text text-anchor="middle" x="559" y="-19678.81" font-family="Times,serif" font-size="14.00">GPU 3 &#45; Layer 4</text>
<text text-anchor="middle" x="559" y="-19663.81" font-family="Times,serif" font-size="14.00">100% SRAM/L2 Cache</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_gpu_4</title>
<polygon fill="#000000" stroke="lightgreen" points="17,-16772.47 17,-18178.47 1081,-18178.47 1081,-16772.47 17,-16772.47"/>
<text text-anchor="middle" x="549" y="-18163.27" font-family="Times,serif" font-size="14.00">GPU 4 &#45; Layer 5</text>
<text text-anchor="middle" x="549" y="-18148.27" font-family="Times,serif" font-size="14.00">100% SRAM/L2 Cache</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_gpu_5</title>
<polygon fill="#000000" stroke="lightgreen" points="17,-15256.93 17,-16662.93 1081,-16662.93 1081,-15256.93 17,-15256.93"/>
<text text-anchor="middle" x="549" y="-16647.73" font-family="Times,serif" font-size="14.00">GPU 5 &#45; Layer 6</text>
<text text-anchor="middle" x="549" y="-16632.73" font-family="Times,serif" font-size="14.00">100% SRAM/L2 Cache</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_gpu_6</title>
<polygon fill="#000000" stroke="lightgreen" points="52,-13741.39 52,-15147.39 1116,-15147.39 1116,-13741.39 52,-13741.39"/>
<text text-anchor="middle" x="584" y="-15132.19" font-family="Times,serif" font-size="14.00">GPU 6 &#45; Layer 7</text>
<text text-anchor="middle" x="584" y="-15117.19" font-family="Times,serif" font-size="14.00">100% SRAM/L2 Cache</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_gpu_7</title>
<polygon fill="#000000" stroke="lightgreen" points="48,-12225.85 48,-13631.85 1112,-13631.85 1112,-12225.85 48,-12225.85"/>
<text text-anchor="middle" x="580" y="-13616.65" font-family="Times,serif" font-size="14.00">GPU 7 &#45; Layer 8</text>
<text text-anchor="middle" x="580" y="-13601.65" font-family="Times,serif" font-size="14.00">100% SRAM/L2 Cache</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_gpu_8</title>
<polygon fill="#000000" stroke="lightgreen" points="36,-10710.31 36,-12116.31 1100,-12116.31 1100,-10710.31 36,-10710.31"/>
<text text-anchor="middle" x="568" y="-12101.11" font-family="Times,serif" font-size="14.00">GPU 8 &#45; Layer 9</text>
<text text-anchor="middle" x="568" y="-12086.11" font-family="Times,serif" font-size="14.00">100% SRAM/L2 Cache</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_gpu_9</title>
<polygon fill="#000000" stroke="lightgreen" points="36,-9194.77 36,-10600.77 1100,-10600.77 1100,-9194.77 36,-9194.77"/>
<text text-anchor="middle" x="568" y="-10585.57" font-family="Times,serif" font-size="14.00">GPU 9 &#45; Layer 10</text>
<text text-anchor="middle" x="568" y="-10570.57" font-family="Times,serif" font-size="14.00">100% SRAM/L2 Cache</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_gpu_10</title>
<polygon fill="#000000" stroke="lightgreen" points="17,-7679.23 17,-9085.23 1081,-9085.23 1081,-7679.23 17,-7679.23"/>
<text text-anchor="middle" x="549" y="-9070.03" font-family="Times,serif" font-size="14.00">GPU 10 &#45; Layer 11</text>
<text text-anchor="middle" x="549" y="-9055.03" font-family="Times,serif" font-size="14.00">100% SRAM/L2 Cache</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_gpu_11</title>
<polygon fill="#000000" stroke="lightgreen" points="52,-6163.7 52,-7569.7 1116,-7569.7 1116,-6163.7 52,-6163.7"/>
<text text-anchor="middle" x="584" y="-7554.5" font-family="Times,serif" font-size="14.00">GPU 11 &#45; Layer 12</text>
<text text-anchor="middle" x="584" y="-7539.5" font-family="Times,serif" font-size="14.00">100% SRAM/L2 Cache</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_gpu_12</title>
<polygon fill="#000000" stroke="lightgreen" points="63,-4648.16 63,-6054.16 1127,-6054.16 1127,-4648.16 63,-4648.16"/>
<text text-anchor="middle" x="595" y="-6038.96" font-family="Times,serif" font-size="14.00">GPU 12 &#45; Layer 13</text>
<text text-anchor="middle" x="595" y="-6023.96" font-family="Times,serif" font-size="14.00">100% SRAM/L2 Cache</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_gpu_13</title>
<polygon fill="#000000" stroke="lightgreen" points="27,-3132.62 27,-4538.62 1091,-4538.62 1091,-3132.62 27,-3132.62"/>
<text text-anchor="middle" x="559" y="-4523.42" font-family="Times,serif" font-size="14.00">GPU 13 &#45; Layer 14</text>
<text text-anchor="middle" x="559" y="-4508.42" font-family="Times,serif" font-size="14.00">100% SRAM/L2 Cache</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_gpu_14</title>
<polygon fill="#000000" stroke="lightgreen" points="8,-1617.08 8,-3023.08 1072,-3023.08 1072,-1617.08 8,-1617.08"/>
<text text-anchor="middle" x="540" y="-3007.88" font-family="Times,serif" font-size="14.00">GPU 14 &#45; Layer 15</text>
<text text-anchor="middle" x="540" y="-2992.88" font-family="Times,serif" font-size="14.00">100% SRAM/L2 Cache</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_gpu_15</title>
<polygon fill="#000000" stroke="lightgreen" points="39,-101.54 39,-1507.54 1103,-1507.54 1103,-101.54 39,-101.54"/>
<text text-anchor="middle" x="571" y="-1492.34" font-family="Times,serif" font-size="14.00">GPU 15 &#45; Layer 16</text>
<text text-anchor="middle" x="571" y="-1477.34" font-family="Times,serif" font-size="14.00">100% SRAM/L2 Cache</text>
</g>
<!-- layer1_transfer -->
<g id="node1" class="node">
<title>layer1_transfer</title>
<ellipse fill="gray" stroke="black" cx="568" cy="-22769.86" rx="209.11" ry="36.54"/>
<text text-anchor="middle" x="568" y="-22783.86" font-family="Arial" font-size="10.00">Layer 1 â†’ 2 Transfer</text>
<text text-anchor="middle" x="568" y="-22772.86" font-family="Arial" font-size="10.00">Transfer: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-22761.86" font-family="Arial" font-size="10.00">From: GPU 0</text>
<text text-anchor="middle" x="568" y="-22750.86" font-family="Arial" font-size="10.00">To: GPU 1</text>
</g>
<!-- layer2_input -->
<g id="node20" class="node">
<title>layer2_input</title>
<polygon fill="lightyellow" stroke="black" points="867.74,-22679.09 390.92,-22679.09 268.26,-22575.09 745.08,-22575.09 867.74,-22679.09"/>
<text text-anchor="middle" x="568" y="-22641.09" font-family="Arial" font-size="10.00">Layer 2 Input</text>
<text text-anchor="middle" x="568" y="-22630.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-22619.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-22608.09" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- layer1_transfer&#45;&gt;layer2_input -->
<g id="edge24" class="edge">
<title>layer1_transfer&#45;&gt;layer2_input</title>
<path fill="none" stroke="black" d="M568,-22732.97C568,-22719.73 568,-22704.33 568,-22689.48"/>
<polygon fill="black" stroke="black" points="571.5,-22689.31 568,-22679.31 564.5,-22689.31 571.5,-22689.31"/>
</g>
<!-- layer1_input -->
<g id="node2" class="node">
<title>layer1_input</title>
<polygon fill="lightyellow" stroke="black" points="892.74,-24194.63 415.92,-24194.63 293.26,-24090.63 770.08,-24090.63 892.74,-24194.63"/>
<text text-anchor="middle" x="593" y="-24156.63" font-family="Arial" font-size="10.00">Layer 1 Input</text>
<text text-anchor="middle" x="593" y="-24145.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="593" y="-24134.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="593" y="-24123.63" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- layer1_mha_query -->
<g id="node3" class="node">
<title>layer1_mha_query</title>
<polygon fill="pink" stroke="black" points="344,-24054.63 48,-24054.63 48,-24002.63 344,-24002.63 344,-24054.63"/>
<text text-anchor="middle" x="196" y="-24042.63" font-family="Arial" font-size="10.00">Layer 1 MHA Query Linear</text>
<text text-anchor="middle" x="196" y="-24031.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="196" y="-24020.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_q=512]</text>
<text text-anchor="middle" x="196" y="-24009.63" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- layer1_input&#45;&gt;layer1_mha_query -->
<g id="edge2" class="edge">
<title>layer1_input&#45;&gt;layer1_mha_query</title>
<path fill="none" stroke="black" d="M412.22,-24090.62C371.71,-24079.2 330.22,-24067.49 294.55,-24057.43"/>
<polygon fill="black" stroke="black" points="295.23,-24053.98 284.65,-24054.64 293.33,-24060.72 295.23,-24053.98"/>
</g>
<!-- layer1_mha_key -->
<g id="node4" class="node">
<title>layer1_mha_key</title>
<polygon fill="pink" stroke="black" points="658,-24054.63 362,-24054.63 362,-24002.63 658,-24002.63 658,-24054.63"/>
<text text-anchor="middle" x="510" y="-24042.63" font-family="Arial" font-size="10.00">Layer 1 MHA Key Linear</text>
<text text-anchor="middle" x="510" y="-24031.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="510" y="-24020.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="510" y="-24009.63" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- layer1_input&#45;&gt;layer1_mha_key -->
<g id="edge3" class="edge">
<title>layer1_input&#45;&gt;layer1_mha_key</title>
<path fill="none" stroke="black" d="M555.14,-24090.54C548.14,-24081.1 541.01,-24071.47 534.53,-24062.73"/>
<polygon fill="black" stroke="black" points="537.33,-24060.62 528.56,-24054.67 531.7,-24064.79 537.33,-24060.62"/>
</g>
<!-- layer1_mha_value -->
<g id="node5" class="node">
<title>layer1_mha_value</title>
<polygon fill="pink" stroke="black" points="683,-23966.63 387,-23966.63 387,-23914.63 683,-23914.63 683,-23966.63"/>
<text text-anchor="middle" x="535" y="-23954.63" font-family="Arial" font-size="10.00">Layer 1 MHA Value Linear</text>
<text text-anchor="middle" x="535" y="-23943.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="535" y="-23932.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_v=512]</text>
<text text-anchor="middle" x="535" y="-23921.63" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- layer1_input&#45;&gt;layer1_mha_value -->
<g id="edge4" class="edge">
<title>layer1_input&#45;&gt;layer1_mha_value</title>
<path fill="none" stroke="black" d="M647.37,-24090.34C669.01,-24063.61 684.97,-24030.72 667,-24002.63 658.93,-23990.01 647.52,-23979.97 634.74,-23971.98"/>
<polygon fill="black" stroke="black" points="636.11,-23968.73 625.7,-23966.77 632.62,-23974.8 636.11,-23968.73"/>
</g>
<!-- layer1_residual1 -->
<g id="node10" class="node">
<title>layer1_residual1</title>
<polygon fill="lightblue" stroke="black" points="568,-23614.63 44,-23562.63 568,-23510.63 1092,-23562.63 568,-23614.63"/>
<text text-anchor="middle" x="568" y="-23576.63" font-family="Arial" font-size="10.00">Layer 1 Residual Add 1</text>
<text text-anchor="middle" x="568" y="-23565.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-23554.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-23543.63" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- layer1_input&#45;&gt;layer1_residual1 -->
<g id="edge12" class="edge">
<title>layer1_input&#45;&gt;layer1_residual1</title>
<path fill="none" stroke="black" d="M649.45,-24090.35C659.1,-24079.36 668.19,-24067.23 675,-24054.63 699.54,-24009.19 702,-23993.26 702,-23941.63 702,-23941.63 702,-23941.63 702,-23763.63 702,-23706.81 664.22,-23653.94 628.78,-23616.85"/>
<polygon fill="black" stroke="black" points="631.22,-23614.34 621.73,-23609.64 626.22,-23619.24 631.22,-23614.34"/>
</g>
<!-- layer1_mha_qkt -->
<g id="node6" class="node">
<title>layer1_mha_qkt</title>
<polygon fill="lightcoral" stroke="black" points="368.5,-23966.63 43.5,-23966.63 43.5,-23914.63 368.5,-23914.63 368.5,-23966.63"/>
<text text-anchor="middle" x="206" y="-23954.63" font-family="Arial" font-size="10.00">Layer 1 MHA QKT Calculation</text>
<text text-anchor="middle" x="206" y="-23943.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="206" y="-23932.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="206" y="-23921.63" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- layer1_mha_query&#45;&gt;layer1_mha_qkt -->
<g id="edge5" class="edge">
<title>layer1_mha_query&#45;&gt;layer1_mha_qkt</title>
<path fill="none" stroke="black" d="M198.95,-24002.29C199.87,-23994.33 200.91,-23985.39 201.9,-23976.87"/>
<polygon fill="black" stroke="black" points="205.4,-23977.12 203.07,-23966.78 198.44,-23976.31 205.4,-23977.12"/>
</g>
<!-- layer1_mha_key&#45;&gt;layer1_mha_qkt -->
<g id="edge6" class="edge">
<title>layer1_mha_key&#45;&gt;layer1_mha_qkt</title>
<path fill="none" stroke="black" d="M421.25,-24002.52C384.65,-23992.17 342.1,-23980.13 304.54,-23969.5"/>
<polygon fill="black" stroke="black" points="305.17,-23966.04 294.59,-23966.69 303.26,-23972.78 305.17,-23966.04"/>
</g>
<!-- layer1_mha_apply -->
<g id="node8" class="node">
<title>layer1_mha_apply</title>
<polygon fill="lightcoral" stroke="black" points="683,-23790.63 115,-23790.63 115,-23738.63 683,-23738.63 683,-23790.63"/>
<text text-anchor="middle" x="399" y="-23778.63" font-family="Arial" font-size="10.00">Layer 1 MHA Apply Attention</text>
<text text-anchor="middle" x="399" y="-23767.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000], [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="399" y="-23756.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="399" y="-23745.63" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- layer1_mha_value&#45;&gt;layer1_mha_apply -->
<g id="edge9" class="edge">
<title>layer1_mha_value&#45;&gt;layer1_mha_apply</title>
<path fill="none" stroke="black" d="M517.11,-23914.58C500.42,-23891.44 474.61,-23856.26 451,-23826.63 443.62,-23817.36 435.41,-23807.52 427.72,-23798.51"/>
<polygon fill="black" stroke="black" points="430.31,-23796.15 421.14,-23790.83 425,-23800.7 430.31,-23796.15"/>
</g>
<!-- layer1_mha_softmax -->
<g id="node7" class="node">
<title>layer1_mha_softmax</title>
<polygon fill="lightcoral" stroke="black" points="442.5,-23878.63 117.5,-23878.63 117.5,-23826.63 442.5,-23826.63 442.5,-23878.63"/>
<text text-anchor="middle" x="280" y="-23866.63" font-family="Arial" font-size="10.00">Layer 1 MHA Softmax</text>
<text text-anchor="middle" x="280" y="-23855.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="280" y="-23844.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="280" y="-23833.63" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- layer1_mha_qkt&#45;&gt;layer1_mha_softmax -->
<g id="edge7" class="edge">
<title>layer1_mha_qkt&#45;&gt;layer1_mha_softmax</title>
<path fill="none" stroke="black" d="M227.8,-23914.29C235.25,-23905.63 243.7,-23895.81 251.6,-23886.63"/>
<polygon fill="black" stroke="black" points="254.48,-23888.65 258.35,-23878.78 249.18,-23884.08 254.48,-23888.65"/>
</g>
<!-- layer1_mha_softmax&#45;&gt;layer1_mha_apply -->
<g id="edge8" class="edge">
<title>layer1_mha_softmax&#45;&gt;layer1_mha_apply</title>
<path fill="none" stroke="black" d="M314.74,-23826.52C327.58,-23817.24 342.29,-23806.61 355.79,-23796.85"/>
<polygon fill="black" stroke="black" points="357.96,-23799.61 364.01,-23790.91 353.86,-23793.93 357.96,-23799.61"/>
</g>
<!-- layer1_mha_out -->
<g id="node9" class="node">
<title>layer1_mha_out</title>
<polygon fill="pink" stroke="black" points="613.5,-23702.63 324.5,-23702.63 324.5,-23650.63 613.5,-23650.63 613.5,-23702.63"/>
<text text-anchor="middle" x="469" y="-23690.63" font-family="Arial" font-size="10.00">Layer 1 MHA Output Linear</text>
<text text-anchor="middle" x="469" y="-23679.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="469" y="-23668.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="469" y="-23657.63" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- layer1_mha_apply&#45;&gt;layer1_mha_out -->
<g id="edge10" class="edge">
<title>layer1_mha_apply&#45;&gt;layer1_mha_out</title>
<path fill="none" stroke="black" d="M419.62,-23738.29C426.67,-23729.63 434.66,-23719.81 442.13,-23710.63"/>
<polygon fill="black" stroke="black" points="444.93,-23712.75 448.52,-23702.78 439.5,-23708.33 444.93,-23712.75"/>
</g>
<!-- layer1_mha_out&#45;&gt;layer1_residual1 -->
<g id="edge11" class="edge">
<title>layer1_mha_out&#45;&gt;layer1_residual1</title>
<path fill="none" stroke="black" d="M491.22,-23650.49C499.65,-23640.95 509.61,-23629.68 519.52,-23618.47"/>
<polygon fill="black" stroke="black" points="522.36,-23620.55 526.36,-23610.74 517.11,-23615.91 522.36,-23620.55"/>
</g>
<!-- layer1_layernorm1 -->
<g id="node11" class="node">
<title>layer1_layernorm1</title>
<polygon fill="lightgreen" stroke="black" points="712.5,-23474.63 423.5,-23474.63 423.5,-23422.63 712.5,-23422.63 712.5,-23474.63"/>
<text text-anchor="middle" x="568" y="-23462.63" font-family="Arial" font-size="10.00">Layer 1 Layer Norm 1</text>
<text text-anchor="middle" x="568" y="-23451.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-23440.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-23429.63" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- layer1_residual1&#45;&gt;layer1_layernorm1 -->
<g id="edge13" class="edge">
<title>layer1_residual1&#45;&gt;layer1_layernorm1</title>
<path fill="none" stroke="black" d="M568,-23510.54C568,-23501.88 568,-23493.05 568,-23484.91"/>
<polygon fill="black" stroke="black" points="571.5,-23484.67 568,-23474.67 564.5,-23484.67 571.5,-23484.67"/>
</g>
<!-- layer1_mlp_gate -->
<g id="node12" class="node">
<title>layer1_mlp_gate</title>
<polygon fill="lightyellow" stroke="black" points="477,-23386.63 185,-23386.63 185,-23334.63 477,-23334.63 477,-23386.63"/>
<text text-anchor="middle" x="331" y="-23374.63" font-family="Arial" font-size="10.00">Layer 1 MLP Gate Linear</text>
<text text-anchor="middle" x="331" y="-23363.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="331" y="-23352.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="331" y="-23341.63" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- layer1_layernorm1&#45;&gt;layer1_mlp_gate -->
<g id="edge14" class="edge">
<title>layer1_layernorm1&#45;&gt;layer1_mlp_gate</title>
<path fill="none" stroke="black" d="M498.81,-23422.52C470.95,-23412.41 438.66,-23400.69 409.88,-23390.25"/>
<polygon fill="black" stroke="black" points="410.87,-23386.88 400.27,-23386.76 408.48,-23393.46 410.87,-23386.88"/>
</g>
<!-- layer1_mlp_up -->
<g id="node13" class="node">
<title>layer1_mlp_up</title>
<polygon fill="lightyellow" stroke="black" points="714,-23298.63 422,-23298.63 422,-23246.63 714,-23246.63 714,-23298.63"/>
<text text-anchor="middle" x="568" y="-23286.63" font-family="Arial" font-size="10.00">Layer 1 MLP Up Linear</text>
<text text-anchor="middle" x="568" y="-23275.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-23264.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="568" y="-23253.63" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- layer1_layernorm1&#45;&gt;layer1_mlp_up -->
<g id="edge15" class="edge">
<title>layer1_layernorm1&#45;&gt;layer1_mlp_up</title>
<path fill="none" stroke="black" d="M568,-23422.32C568,-23392.47 568,-23342.65 568,-23308.99"/>
<polygon fill="black" stroke="black" points="571.5,-23308.67 568,-23298.68 564.5,-23308.68 571.5,-23308.67"/>
</g>
<!-- layer1_residual2 -->
<g id="node17" class="node">
<title>layer1_residual2</title>
<polygon fill="lightblue" stroke="black" points="568,-23034.63 44,-22982.63 568,-22930.63 1092,-22982.63 568,-23034.63"/>
<text text-anchor="middle" x="568" y="-22996.63" font-family="Arial" font-size="10.00">Layer 1 Residual Add 2</text>
<text text-anchor="middle" x="568" y="-22985.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-22974.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-22963.63" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- layer1_layernorm1&#45;&gt;layer1_residual2 -->
<g id="edge21" class="edge">
<title>layer1_layernorm1&#45;&gt;layer1_residual2</title>
<path fill="none" stroke="black" d="M617.06,-23422.55C665.7,-23393.79 733,-23341.69 733,-23273.63 733,-23273.63 733,-23273.63 733,-23183.63 733,-23122.69 686.86,-23070.27 643.38,-23034.41"/>
<polygon fill="black" stroke="black" points="645.57,-23031.68 635.59,-23028.13 641.18,-23037.13 645.57,-23031.68"/>
</g>
<!-- layer1_mlp_gelu -->
<g id="node14" class="node">
<title>layer1_mlp_gelu</title>
<polygon fill="orange" stroke="black" points="404,-23298.63 112,-23298.63 112,-23246.63 404,-23246.63 404,-23298.63"/>
<text text-anchor="middle" x="258" y="-23286.63" font-family="Arial" font-size="10.00">Layer 1 MLP GELU</text>
<text text-anchor="middle" x="258" y="-23275.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="258" y="-23264.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="258" y="-23253.63" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- layer1_mlp_gate&#45;&gt;layer1_mlp_gelu -->
<g id="edge16" class="edge">
<title>layer1_mlp_gate&#45;&gt;layer1_mlp_gelu</title>
<path fill="none" stroke="black" d="M309.49,-23334.29C302.14,-23325.63 293.81,-23315.81 286.02,-23306.63"/>
<polygon fill="black" stroke="black" points="288.49,-23304.14 279.35,-23298.78 283.16,-23308.67 288.49,-23304.14"/>
</g>
<!-- layer1_mlp_multiply -->
<g id="node15" class="node">
<title>layer1_mlp_multiply</title>
<polygon fill="orange" stroke="black" points="714,-23210.63 184,-23210.63 184,-23158.63 714,-23158.63 714,-23210.63"/>
<text text-anchor="middle" x="449" y="-23198.63" font-family="Arial" font-size="10.00">Layer 1 MLP Element&#45;wise Multiply</text>
<text text-anchor="middle" x="449" y="-23187.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768], [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="449" y="-23176.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="449" y="-23165.63" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- layer1_mlp_up&#45;&gt;layer1_mlp_multiply -->
<g id="edge17" class="edge">
<title>layer1_mlp_up&#45;&gt;layer1_mlp_multiply</title>
<path fill="none" stroke="black" d="M533.26,-23246.52C520.42,-23237.24 505.71,-23226.61 492.21,-23216.85"/>
<polygon fill="black" stroke="black" points="494.14,-23213.93 483.99,-23210.91 490.04,-23219.61 494.14,-23213.93"/>
</g>
<!-- layer1_mlp_gelu&#45;&gt;layer1_mlp_multiply -->
<g id="edge18" class="edge">
<title>layer1_mlp_gelu&#45;&gt;layer1_mlp_multiply</title>
<path fill="none" stroke="black" d="M313.76,-23246.52C335.73,-23236.63 361.11,-23225.2 383.91,-23214.93"/>
<polygon fill="black" stroke="black" points="385.49,-23218.06 393.17,-23210.76 382.62,-23211.68 385.49,-23218.06"/>
</g>
<!-- layer1_mlp_down -->
<g id="node16" class="node">
<title>layer1_mlp_down</title>
<polygon fill="lightyellow" stroke="black" points="652.5,-23122.63 363.5,-23122.63 363.5,-23070.63 652.5,-23070.63 652.5,-23122.63"/>
<text text-anchor="middle" x="508" y="-23110.63" font-family="Arial" font-size="10.00">Layer 1 MLP Down Linear</text>
<text text-anchor="middle" x="508" y="-23099.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="508" y="-23088.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="508" y="-23077.63" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- layer1_mlp_multiply&#45;&gt;layer1_mlp_down -->
<g id="edge19" class="edge">
<title>layer1_mlp_multiply&#45;&gt;layer1_mlp_down</title>
<path fill="none" stroke="black" d="M466.38,-23158.29C472.2,-23149.8 478.79,-23140.21 484.97,-23131.19"/>
<polygon fill="black" stroke="black" points="487.97,-23133.01 490.74,-23122.78 482.2,-23129.05 487.97,-23133.01"/>
</g>
<!-- layer1_mlp_down&#45;&gt;layer1_residual2 -->
<g id="edge20" class="edge">
<title>layer1_mlp_down&#45;&gt;layer1_residual2</title>
<path fill="none" stroke="black" d="M521.47,-23070.49C526.17,-23061.71 531.66,-23051.46 537.19,-23041.14"/>
<polygon fill="black" stroke="black" points="540.4,-23042.56 542.04,-23032.09 534.23,-23039.25 540.4,-23042.56"/>
</g>
<!-- layer1_layernorm2 -->
<g id="node18" class="node">
<title>layer1_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="712.5,-22894.63 423.5,-22894.63 423.5,-22842.63 712.5,-22842.63 712.5,-22894.63"/>
<text text-anchor="middle" x="568" y="-22882.63" font-family="Arial" font-size="10.00">Layer 1 Layer Norm 2</text>
<text text-anchor="middle" x="568" y="-22871.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-22860.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-22849.63" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- layer1_residual2&#45;&gt;layer1_layernorm2 -->
<g id="edge22" class="edge">
<title>layer1_residual2&#45;&gt;layer1_layernorm2</title>
<path fill="none" stroke="black" d="M568,-22930.54C568,-22921.88 568,-22913.05 568,-22904.91"/>
<polygon fill="black" stroke="black" points="571.5,-22904.67 568,-22894.67 564.5,-22904.67 571.5,-22904.67"/>
</g>
<!-- layer1_layernorm2&#45;&gt;layer1_transfer -->
<g id="edge23" class="edge">
<title>layer1_layernorm2&#45;&gt;layer1_transfer</title>
<path fill="none" stroke="black" d="M568,-22842.45C568,-22834.64 568,-22825.78 568,-22817.01"/>
<polygon fill="black" stroke="black" points="571.5,-22816.83 568,-22806.83 564.5,-22816.83 571.5,-22816.83"/>
</g>
<!-- layer2_transfer -->
<g id="node19" class="node">
<title>layer2_transfer</title>
<ellipse fill="gray" stroke="black" cx="568" cy="-21254.32" rx="209.11" ry="36.54"/>
<text text-anchor="middle" x="568" y="-21268.32" font-family="Arial" font-size="10.00">Layer 2 â†’ 3 Transfer</text>
<text text-anchor="middle" x="568" y="-21257.32" font-family="Arial" font-size="10.00">Transfer: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-21246.32" font-family="Arial" font-size="10.00">From: GPU 1</text>
<text text-anchor="middle" x="568" y="-21235.32" font-family="Arial" font-size="10.00">To: GPU 2</text>
</g>
<!-- layer3_input -->
<g id="node38" class="node">
<title>layer3_input</title>
<polygon fill="lightyellow" stroke="black" points="867.74,-21163.55 390.92,-21163.55 268.26,-21059.55 745.08,-21059.55 867.74,-21163.55"/>
<text text-anchor="middle" x="568" y="-21125.55" font-family="Arial" font-size="10.00">Layer 3 Input</text>
<text text-anchor="middle" x="568" y="-21114.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-21103.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-21092.55" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- layer2_transfer&#45;&gt;layer3_input -->
<g id="edge47" class="edge">
<title>layer2_transfer&#45;&gt;layer3_input</title>
<path fill="none" stroke="black" d="M568,-21217.43C568,-21204.19 568,-21188.79 568,-21173.94"/>
<polygon fill="black" stroke="black" points="571.5,-21173.77 568,-21163.77 564.5,-21173.77 571.5,-21173.77"/>
</g>
<!-- layer2_mha_query -->
<g id="node21" class="node">
<title>layer2_mha_query</title>
<polygon fill="pink" stroke="black" points="344,-22539.09 48,-22539.09 48,-22487.09 344,-22487.09 344,-22539.09"/>
<text text-anchor="middle" x="196" y="-22527.09" font-family="Arial" font-size="10.00">Layer 2 MHA Query Linear</text>
<text text-anchor="middle" x="196" y="-22516.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="196" y="-22505.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_q=512]</text>
<text text-anchor="middle" x="196" y="-22494.09" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- layer2_input&#45;&gt;layer2_mha_query -->
<g id="edge25" class="edge">
<title>layer2_input&#45;&gt;layer2_mha_query</title>
<path fill="none" stroke="black" d="M398.6,-22575.08C360.9,-22563.73 322.28,-22552.11 289.01,-22542.09"/>
<polygon fill="black" stroke="black" points="289.9,-22538.7 279.31,-22539.17 287.88,-22545.4 289.9,-22538.7"/>
</g>
<!-- layer2_mha_key -->
<g id="node22" class="node">
<title>layer2_mha_key</title>
<polygon fill="pink" stroke="black" points="658,-22539.09 362,-22539.09 362,-22487.09 658,-22487.09 658,-22539.09"/>
<text text-anchor="middle" x="510" y="-22527.09" font-family="Arial" font-size="10.00">Layer 2 MHA Key Linear</text>
<text text-anchor="middle" x="510" y="-22516.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="510" y="-22505.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="510" y="-22494.09" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- layer2_input&#45;&gt;layer2_mha_key -->
<g id="edge26" class="edge">
<title>layer2_input&#45;&gt;layer2_mha_key</title>
<path fill="none" stroke="black" d="M541.55,-22575C536.86,-22565.95 532.08,-22556.72 527.71,-22548.28"/>
<polygon fill="black" stroke="black" points="530.68,-22546.4 522.97,-22539.13 524.46,-22549.62 530.68,-22546.4"/>
</g>
<!-- layer2_mha_value -->
<g id="node23" class="node">
<title>layer2_mha_value</title>
<polygon fill="pink" stroke="black" points="754,-22451.09 458,-22451.09 458,-22399.09 754,-22399.09 754,-22451.09"/>
<text text-anchor="middle" x="606" y="-22439.09" font-family="Arial" font-size="10.00">Layer 2 MHA Value Linear</text>
<text text-anchor="middle" x="606" y="-22428.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="606" y="-22417.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_v=512]</text>
<text text-anchor="middle" x="606" y="-22406.09" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- layer2_input&#45;&gt;layer2_mha_value -->
<g id="edge27" class="edge">
<title>layer2_input&#45;&gt;layer2_mha_value</title>
<path fill="none" stroke="black" d="M641.59,-22574.94C651.9,-22564.35 661.01,-22552.32 667,-22539.09 676.53,-22518.03 675.84,-22508.44 667,-22487.09 662.61,-22476.49 655.39,-22466.78 647.43,-22458.36"/>
<polygon fill="black" stroke="black" points="649.86,-22455.85 640.29,-22451.32 644.94,-22460.83 649.86,-22455.85"/>
</g>
<!-- layer2_residual1 -->
<g id="node28" class="node">
<title>layer2_residual1</title>
<polygon fill="lightblue" stroke="black" points="568,-22099.09 44,-22047.09 568,-21995.09 1092,-22047.09 568,-22099.09"/>
<text text-anchor="middle" x="568" y="-22061.09" font-family="Arial" font-size="10.00">Layer 2 Residual Add 1</text>
<text text-anchor="middle" x="568" y="-22050.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-22039.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-22028.09" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- layer2_input&#45;&gt;layer2_residual1 -->
<g id="edge35" class="edge">
<title>layer2_input&#45;&gt;layer2_residual1</title>
<path fill="none" stroke="black" d="M668.7,-22575.01C720.54,-22540.9 773,-22490.48 773,-22426.09 773,-22426.09 773,-22426.09 773,-22248.09 773,-22181.54 716.97,-22129.91 663.49,-22095.79"/>
<polygon fill="black" stroke="black" points="665.28,-22092.78 654.94,-22090.46 661.58,-22098.72 665.28,-22092.78"/>
</g>
<!-- layer2_mha_qkt -->
<g id="node24" class="node">
<title>layer2_mha_qkt</title>
<polygon fill="lightcoral" stroke="black" points="439.5,-22451.09 114.5,-22451.09 114.5,-22399.09 439.5,-22399.09 439.5,-22451.09"/>
<text text-anchor="middle" x="277" y="-22439.09" font-family="Arial" font-size="10.00">Layer 2 MHA QKT Calculation</text>
<text text-anchor="middle" x="277" y="-22428.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="277" y="-22417.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="277" y="-22406.09" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- layer2_mha_query&#45;&gt;layer2_mha_qkt -->
<g id="edge28" class="edge">
<title>layer2_mha_query&#45;&gt;layer2_mha_qkt</title>
<path fill="none" stroke="black" d="M219.86,-22486.75C228.19,-22477.91 237.64,-22467.87 246.43,-22458.54"/>
<polygon fill="black" stroke="black" points="249,-22460.92 253.31,-22451.24 243.9,-22456.12 249,-22460.92"/>
</g>
<!-- layer2_mha_key&#45;&gt;layer2_mha_qkt -->
<g id="edge29" class="edge">
<title>layer2_mha_key&#45;&gt;layer2_mha_qkt</title>
<path fill="none" stroke="black" d="M441.98,-22486.98C414.59,-22476.87 382.84,-22465.15 354.55,-22454.71"/>
<polygon fill="black" stroke="black" points="355.7,-22451.4 345.1,-22451.22 353.27,-22457.97 355.7,-22451.4"/>
</g>
<!-- layer2_mha_apply -->
<g id="node26" class="node">
<title>layer2_mha_apply</title>
<polygon fill="lightcoral" stroke="black" points="754,-22275.09 186,-22275.09 186,-22223.09 754,-22223.09 754,-22275.09"/>
<text text-anchor="middle" x="470" y="-22263.09" font-family="Arial" font-size="10.00">Layer 2 MHA Apply Attention</text>
<text text-anchor="middle" x="470" y="-22252.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000], [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="470" y="-22241.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="470" y="-22230.09" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- layer2_mha_value&#45;&gt;layer2_mha_apply -->
<g id="edge32" class="edge">
<title>layer2_mha_value&#45;&gt;layer2_mha_apply</title>
<path fill="none" stroke="black" d="M586.22,-22398.79C562.39,-22368.29 522.26,-22316.95 495.95,-22283.29"/>
<polygon fill="black" stroke="black" points="498.49,-22280.86 489.58,-22275.14 492.98,-22285.17 498.49,-22280.86"/>
</g>
<!-- layer2_mha_softmax -->
<g id="node25" class="node">
<title>layer2_mha_softmax</title>
<polygon fill="lightcoral" stroke="black" points="479.5,-22363.09 154.5,-22363.09 154.5,-22311.09 479.5,-22311.09 479.5,-22363.09"/>
<text text-anchor="middle" x="317" y="-22351.09" font-family="Arial" font-size="10.00">Layer 2 MHA Softmax</text>
<text text-anchor="middle" x="317" y="-22340.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="317" y="-22329.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="317" y="-22318.09" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- layer2_mha_qkt&#45;&gt;layer2_mha_softmax -->
<g id="edge30" class="edge">
<title>layer2_mha_qkt&#45;&gt;layer2_mha_softmax</title>
<path fill="none" stroke="black" d="M288.78,-22398.75C292.61,-22390.53 296.92,-22381.26 301,-22372.49"/>
<polygon fill="black" stroke="black" points="304.26,-22373.79 305.3,-22363.24 297.91,-22370.83 304.26,-22373.79"/>
</g>
<!-- layer2_mha_softmax&#45;&gt;layer2_mha_apply -->
<g id="edge31" class="edge">
<title>layer2_mha_softmax&#45;&gt;layer2_mha_apply</title>
<path fill="none" stroke="black" d="M361.67,-22310.98C378.72,-22301.4 398.33,-22290.37 416.15,-22280.36"/>
<polygon fill="black" stroke="black" points="418.28,-22283.17 425.28,-22275.22 414.85,-22277.07 418.28,-22283.17"/>
</g>
<!-- layer2_mha_out -->
<g id="node27" class="node">
<title>layer2_mha_out</title>
<polygon fill="pink" stroke="black" points="663.5,-22187.09 374.5,-22187.09 374.5,-22135.09 663.5,-22135.09 663.5,-22187.09"/>
<text text-anchor="middle" x="519" y="-22175.09" font-family="Arial" font-size="10.00">Layer 2 MHA Output Linear</text>
<text text-anchor="middle" x="519" y="-22164.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="519" y="-22153.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="519" y="-22142.09" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- layer2_mha_apply&#45;&gt;layer2_mha_out -->
<g id="edge33" class="edge">
<title>layer2_mha_apply&#45;&gt;layer2_mha_out</title>
<path fill="none" stroke="black" d="M484.44,-22222.75C489.17,-22214.44 494.51,-22205.06 499.56,-22196.21"/>
<polygon fill="black" stroke="black" points="502.76,-22197.66 504.67,-22187.24 496.68,-22194.2 502.76,-22197.66"/>
</g>
<!-- layer2_mha_out&#45;&gt;layer2_residual1 -->
<g id="edge34" class="edge">
<title>layer2_mha_out&#45;&gt;layer2_residual1</title>
<path fill="none" stroke="black" d="M530,-22134.95C533.76,-22126.36 538.13,-22116.36 542.55,-22106.26"/>
<polygon fill="black" stroke="black" points="545.8,-22107.57 546.6,-22097 539.38,-22104.76 545.8,-22107.57"/>
</g>
<!-- layer2_layernorm1 -->
<g id="node29" class="node">
<title>layer2_layernorm1</title>
<polygon fill="lightgreen" stroke="black" points="712.5,-21959.09 423.5,-21959.09 423.5,-21907.09 712.5,-21907.09 712.5,-21959.09"/>
<text text-anchor="middle" x="568" y="-21947.09" font-family="Arial" font-size="10.00">Layer 2 Layer Norm 1</text>
<text text-anchor="middle" x="568" y="-21936.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-21925.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-21914.09" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- layer2_residual1&#45;&gt;layer2_layernorm1 -->
<g id="edge36" class="edge">
<title>layer2_residual1&#45;&gt;layer2_layernorm1</title>
<path fill="none" stroke="black" d="M568,-21995C568,-21986.34 568,-21977.52 568,-21969.37"/>
<polygon fill="black" stroke="black" points="571.5,-21969.13 568,-21959.13 564.5,-21969.13 571.5,-21969.13"/>
</g>
<!-- layer2_mlp_gate -->
<g id="node30" class="node">
<title>layer2_mlp_gate</title>
<polygon fill="lightyellow" stroke="black" points="477,-21871.09 185,-21871.09 185,-21819.09 477,-21819.09 477,-21871.09"/>
<text text-anchor="middle" x="331" y="-21859.09" font-family="Arial" font-size="10.00">Layer 2 MLP Gate Linear</text>
<text text-anchor="middle" x="331" y="-21848.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="331" y="-21837.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="331" y="-21826.09" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- layer2_layernorm1&#45;&gt;layer2_mlp_gate -->
<g id="edge37" class="edge">
<title>layer2_layernorm1&#45;&gt;layer2_mlp_gate</title>
<path fill="none" stroke="black" d="M498.81,-21906.98C470.95,-21896.87 438.66,-21885.15 409.88,-21874.71"/>
<polygon fill="black" stroke="black" points="410.87,-21871.34 400.27,-21871.22 408.48,-21877.92 410.87,-21871.34"/>
</g>
<!-- layer2_mlp_up -->
<g id="node31" class="node">
<title>layer2_mlp_up</title>
<polygon fill="lightyellow" stroke="black" points="714,-21783.09 422,-21783.09 422,-21731.09 714,-21731.09 714,-21783.09"/>
<text text-anchor="middle" x="568" y="-21771.09" font-family="Arial" font-size="10.00">Layer 2 MLP Up Linear</text>
<text text-anchor="middle" x="568" y="-21760.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-21749.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="568" y="-21738.09" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- layer2_layernorm1&#45;&gt;layer2_mlp_up -->
<g id="edge38" class="edge">
<title>layer2_layernorm1&#45;&gt;layer2_mlp_up</title>
<path fill="none" stroke="black" d="M568,-21906.79C568,-21876.93 568,-21827.11 568,-21793.45"/>
<polygon fill="black" stroke="black" points="571.5,-21793.14 568,-21783.14 564.5,-21793.14 571.5,-21793.14"/>
</g>
<!-- layer2_residual2 -->
<g id="node35" class="node">
<title>layer2_residual2</title>
<polygon fill="lightblue" stroke="black" points="568,-21519.09 44,-21467.09 568,-21415.09 1092,-21467.09 568,-21519.09"/>
<text text-anchor="middle" x="568" y="-21481.09" font-family="Arial" font-size="10.00">Layer 2 Residual Add 2</text>
<text text-anchor="middle" x="568" y="-21470.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-21459.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-21448.09" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- layer2_layernorm1&#45;&gt;layer2_residual2 -->
<g id="edge44" class="edge">
<title>layer2_layernorm1&#45;&gt;layer2_residual2</title>
<path fill="none" stroke="black" d="M617.06,-21907.01C665.7,-21878.25 733,-21826.15 733,-21758.09 733,-21758.09 733,-21758.09 733,-21668.09 733,-21607.15 686.86,-21554.74 643.38,-21518.87"/>
<polygon fill="black" stroke="black" points="645.57,-21516.14 635.59,-21512.59 641.18,-21521.59 645.57,-21516.14"/>
</g>
<!-- layer2_mlp_gelu -->
<g id="node32" class="node">
<title>layer2_mlp_gelu</title>
<polygon fill="orange" stroke="black" points="404,-21783.09 112,-21783.09 112,-21731.09 404,-21731.09 404,-21783.09"/>
<text text-anchor="middle" x="258" y="-21771.09" font-family="Arial" font-size="10.00">Layer 2 MLP GELU</text>
<text text-anchor="middle" x="258" y="-21760.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="258" y="-21749.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="258" y="-21738.09" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- layer2_mlp_gate&#45;&gt;layer2_mlp_gelu -->
<g id="edge39" class="edge">
<title>layer2_mlp_gate&#45;&gt;layer2_mlp_gelu</title>
<path fill="none" stroke="black" d="M309.49,-21818.75C302.14,-21810.09 293.81,-21800.27 286.02,-21791.1"/>
<polygon fill="black" stroke="black" points="288.49,-21788.6 279.35,-21783.24 283.16,-21793.13 288.49,-21788.6"/>
</g>
<!-- layer2_mlp_multiply -->
<g id="node33" class="node">
<title>layer2_mlp_multiply</title>
<polygon fill="orange" stroke="black" points="714,-21695.09 184,-21695.09 184,-21643.09 714,-21643.09 714,-21695.09"/>
<text text-anchor="middle" x="449" y="-21683.09" font-family="Arial" font-size="10.00">Layer 2 MLP Element&#45;wise Multiply</text>
<text text-anchor="middle" x="449" y="-21672.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768], [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="449" y="-21661.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="449" y="-21650.09" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- layer2_mlp_up&#45;&gt;layer2_mlp_multiply -->
<g id="edge40" class="edge">
<title>layer2_mlp_up&#45;&gt;layer2_mlp_multiply</title>
<path fill="none" stroke="black" d="M533.26,-21730.98C520.42,-21721.7 505.71,-21711.07 492.21,-21701.31"/>
<polygon fill="black" stroke="black" points="494.14,-21698.39 483.99,-21695.37 490.04,-21704.07 494.14,-21698.39"/>
</g>
<!-- layer2_mlp_gelu&#45;&gt;layer2_mlp_multiply -->
<g id="edge41" class="edge">
<title>layer2_mlp_gelu&#45;&gt;layer2_mlp_multiply</title>
<path fill="none" stroke="black" d="M313.76,-21730.98C335.73,-21721.09 361.11,-21709.66 383.91,-21699.39"/>
<polygon fill="black" stroke="black" points="385.49,-21702.52 393.17,-21695.22 382.62,-21696.14 385.49,-21702.52"/>
</g>
<!-- layer2_mlp_down -->
<g id="node34" class="node">
<title>layer2_mlp_down</title>
<polygon fill="lightyellow" stroke="black" points="653.5,-21607.09 364.5,-21607.09 364.5,-21555.09 653.5,-21555.09 653.5,-21607.09"/>
<text text-anchor="middle" x="509" y="-21595.09" font-family="Arial" font-size="10.00">Layer 2 MLP Down Linear</text>
<text text-anchor="middle" x="509" y="-21584.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="509" y="-21573.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="509" y="-21562.09" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- layer2_mlp_multiply&#45;&gt;layer2_mlp_down -->
<g id="edge42" class="edge">
<title>layer2_mlp_multiply&#45;&gt;layer2_mlp_down</title>
<path fill="none" stroke="black" d="M466.68,-21642.75C472.6,-21634.26 479.29,-21624.67 485.58,-21615.65"/>
<polygon fill="black" stroke="black" points="488.6,-21617.45 491.45,-21607.24 482.86,-21613.44 488.6,-21617.45"/>
</g>
<!-- layer2_mlp_down&#45;&gt;layer2_residual2 -->
<g id="edge43" class="edge">
<title>layer2_mlp_down&#45;&gt;layer2_residual2</title>
<path fill="none" stroke="black" d="M522.24,-21554.95C526.81,-21546.27 532.14,-21536.15 537.52,-21525.95"/>
<polygon fill="black" stroke="black" points="540.67,-21527.48 542.23,-21517 534.47,-21524.22 540.67,-21527.48"/>
</g>
<!-- layer2_layernorm2 -->
<g id="node36" class="node">
<title>layer2_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="712.5,-21379.09 423.5,-21379.09 423.5,-21327.09 712.5,-21327.09 712.5,-21379.09"/>
<text text-anchor="middle" x="568" y="-21367.09" font-family="Arial" font-size="10.00">Layer 2 Layer Norm 2</text>
<text text-anchor="middle" x="568" y="-21356.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-21345.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-21334.09" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- layer2_residual2&#45;&gt;layer2_layernorm2 -->
<g id="edge45" class="edge">
<title>layer2_residual2&#45;&gt;layer2_layernorm2</title>
<path fill="none" stroke="black" d="M568,-21415C568,-21406.34 568,-21397.52 568,-21389.37"/>
<polygon fill="black" stroke="black" points="571.5,-21389.13 568,-21379.13 564.5,-21389.13 571.5,-21389.13"/>
</g>
<!-- layer2_layernorm2&#45;&gt;layer2_transfer -->
<g id="edge46" class="edge">
<title>layer2_layernorm2&#45;&gt;layer2_transfer</title>
<path fill="none" stroke="black" d="M568,-21326.91C568,-21319.11 568,-21310.24 568,-21301.47"/>
<polygon fill="black" stroke="black" points="571.5,-21301.29 568,-21291.29 564.5,-21301.29 571.5,-21301.29"/>
</g>
<!-- layer3_transfer -->
<g id="node37" class="node">
<title>layer3_transfer</title>
<ellipse fill="gray" stroke="black" cx="559" cy="-19738.78" rx="209.11" ry="36.54"/>
<text text-anchor="middle" x="559" y="-19752.78" font-family="Arial" font-size="10.00">Layer 3 â†’ 4 Transfer</text>
<text text-anchor="middle" x="559" y="-19741.78" font-family="Arial" font-size="10.00">Transfer: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-19730.78" font-family="Arial" font-size="10.00">From: GPU 2</text>
<text text-anchor="middle" x="559" y="-19719.78" font-family="Arial" font-size="10.00">To: GPU 3</text>
</g>
<!-- layer4_input -->
<g id="node56" class="node">
<title>layer4_input</title>
<polygon fill="lightyellow" stroke="black" points="858.74,-19648.01 381.92,-19648.01 259.26,-19544.01 736.08,-19544.01 858.74,-19648.01"/>
<text text-anchor="middle" x="559" y="-19610.01" font-family="Arial" font-size="10.00">Layer 4 Input</text>
<text text-anchor="middle" x="559" y="-19599.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-19588.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-19577.01" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- layer3_transfer&#45;&gt;layer4_input -->
<g id="edge70" class="edge">
<title>layer3_transfer&#45;&gt;layer4_input</title>
<path fill="none" stroke="black" d="M559,-19701.89C559,-19688.65 559,-19673.25 559,-19658.4"/>
<polygon fill="black" stroke="black" points="562.5,-19658.23 559,-19648.23 555.5,-19658.23 562.5,-19658.23"/>
</g>
<!-- layer3_mha_query -->
<g id="node39" class="node">
<title>layer3_mha_query</title>
<polygon fill="pink" stroke="black" points="335,-21023.55 39,-21023.55 39,-20971.55 335,-20971.55 335,-21023.55"/>
<text text-anchor="middle" x="187" y="-21011.55" font-family="Arial" font-size="10.00">Layer 3 MHA Query Linear</text>
<text text-anchor="middle" x="187" y="-21000.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="187" y="-20989.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_q=512]</text>
<text text-anchor="middle" x="187" y="-20978.55" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- layer3_input&#45;&gt;layer3_mha_query -->
<g id="edge48" class="edge">
<title>layer3_input&#45;&gt;layer3_mha_query</title>
<path fill="none" stroke="black" d="M394.5,-21059.55C355.8,-21048.17 316.15,-21036.51 282.02,-21026.48"/>
<polygon fill="black" stroke="black" points="282.66,-21023.02 272.08,-21023.56 280.69,-21029.74 282.66,-21023.02"/>
</g>
<!-- layer3_mha_key -->
<g id="node40" class="node">
<title>layer3_mha_key</title>
<polygon fill="pink" stroke="black" points="649,-21023.55 353,-21023.55 353,-20971.55 649,-20971.55 649,-21023.55"/>
<text text-anchor="middle" x="501" y="-21011.55" font-family="Arial" font-size="10.00">Layer 3 MHA Key Linear</text>
<text text-anchor="middle" x="501" y="-21000.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="501" y="-20989.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="501" y="-20978.55" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- layer3_input&#45;&gt;layer3_mha_key -->
<g id="edge49" class="edge">
<title>layer3_input&#45;&gt;layer3_mha_key</title>
<path fill="none" stroke="black" d="M537.44,-21059.46C531.91,-21050.21 526.27,-21040.79 521.13,-21032.2"/>
<polygon fill="black" stroke="black" points="524.12,-21030.38 515.98,-21023.59 518.11,-21033.97 524.12,-21030.38"/>
</g>
<!-- layer3_mha_value -->
<g id="node41" class="node">
<title>layer3_mha_value</title>
<polygon fill="pink" stroke="black" points="745,-20935.55 449,-20935.55 449,-20883.55 745,-20883.55 745,-20935.55"/>
<text text-anchor="middle" x="597" y="-20923.55" font-family="Arial" font-size="10.00">Layer 3 MHA Value Linear</text>
<text text-anchor="middle" x="597" y="-20912.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="597" y="-20901.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_v=512]</text>
<text text-anchor="middle" x="597" y="-20890.55" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- layer3_input&#45;&gt;layer3_mha_value -->
<g id="edge50" class="edge">
<title>layer3_input&#45;&gt;layer3_mha_value</title>
<path fill="none" stroke="black" d="M634.33,-21059.24C643.97,-21048.56 652.48,-21036.55 658,-21023.55 667.02,-21002.27 666.84,-20992.9 658,-20971.55 653.61,-20960.95 646.39,-20951.24 638.43,-20942.83"/>
<polygon fill="black" stroke="black" points="640.86,-20940.31 631.29,-20935.78 635.94,-20945.29 640.86,-20940.31"/>
</g>
<!-- layer3_residual1 -->
<g id="node46" class="node">
<title>layer3_residual1</title>
<polygon fill="lightblue" stroke="black" points="559,-20583.55 35,-20531.55 559,-20479.55 1083,-20531.55 559,-20583.55"/>
<text text-anchor="middle" x="559" y="-20545.55" font-family="Arial" font-size="10.00">Layer 3 Residual Add 1</text>
<text text-anchor="middle" x="559" y="-20534.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-20523.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-20512.55" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- layer3_input&#45;&gt;layer3_residual1 -->
<g id="edge58" class="edge">
<title>layer3_input&#45;&gt;layer3_residual1</title>
<path fill="none" stroke="black" d="M662.84,-21059.42C712.87,-21024.92 764,-20974.11 764,-20910.55 764,-20910.55 764,-20910.55 764,-20732.55 764,-20666 707.97,-20614.37 654.49,-20580.25"/>
<polygon fill="black" stroke="black" points="656.28,-20577.24 645.94,-20574.92 652.58,-20583.18 656.28,-20577.24"/>
</g>
<!-- layer3_mha_qkt -->
<g id="node42" class="node">
<title>layer3_mha_qkt</title>
<polygon fill="lightcoral" stroke="black" points="430.5,-20935.55 105.5,-20935.55 105.5,-20883.55 430.5,-20883.55 430.5,-20935.55"/>
<text text-anchor="middle" x="268" y="-20923.55" font-family="Arial" font-size="10.00">Layer 3 MHA QKT Calculation</text>
<text text-anchor="middle" x="268" y="-20912.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="268" y="-20901.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="268" y="-20890.55" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- layer3_mha_query&#45;&gt;layer3_mha_qkt -->
<g id="edge51" class="edge">
<title>layer3_mha_query&#45;&gt;layer3_mha_qkt</title>
<path fill="none" stroke="black" d="M210.86,-20971.21C219.19,-20962.37 228.64,-20952.33 237.43,-20943"/>
<polygon fill="black" stroke="black" points="240,-20945.38 244.31,-20935.7 234.9,-20940.58 240,-20945.38"/>
</g>
<!-- layer3_mha_key&#45;&gt;layer3_mha_qkt -->
<g id="edge52" class="edge">
<title>layer3_mha_key&#45;&gt;layer3_mha_qkt</title>
<path fill="none" stroke="black" d="M432.98,-20971.44C405.59,-20961.33 373.84,-20949.61 345.55,-20939.17"/>
<polygon fill="black" stroke="black" points="346.7,-20935.86 336.1,-20935.68 344.27,-20942.43 346.7,-20935.86"/>
</g>
<!-- layer3_mha_apply -->
<g id="node44" class="node">
<title>layer3_mha_apply</title>
<polygon fill="lightcoral" stroke="black" points="745,-20759.55 177,-20759.55 177,-20707.55 745,-20707.55 745,-20759.55"/>
<text text-anchor="middle" x="461" y="-20747.55" font-family="Arial" font-size="10.00">Layer 3 MHA Apply Attention</text>
<text text-anchor="middle" x="461" y="-20736.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000], [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="461" y="-20725.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="461" y="-20714.55" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- layer3_mha_value&#45;&gt;layer3_mha_apply -->
<g id="edge55" class="edge">
<title>layer3_mha_value&#45;&gt;layer3_mha_apply</title>
<path fill="none" stroke="black" d="M577.22,-20883.25C553.39,-20852.75 513.26,-20801.41 486.95,-20767.75"/>
<polygon fill="black" stroke="black" points="489.49,-20765.32 480.58,-20759.6 483.98,-20769.63 489.49,-20765.32"/>
</g>
<!-- layer3_mha_softmax -->
<g id="node43" class="node">
<title>layer3_mha_softmax</title>
<polygon fill="lightcoral" stroke="black" points="470.5,-20847.55 145.5,-20847.55 145.5,-20795.55 470.5,-20795.55 470.5,-20847.55"/>
<text text-anchor="middle" x="308" y="-20835.55" font-family="Arial" font-size="10.00">Layer 3 MHA Softmax</text>
<text text-anchor="middle" x="308" y="-20824.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="308" y="-20813.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="308" y="-20802.55" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- layer3_mha_qkt&#45;&gt;layer3_mha_softmax -->
<g id="edge53" class="edge">
<title>layer3_mha_qkt&#45;&gt;layer3_mha_softmax</title>
<path fill="none" stroke="black" d="M279.78,-20883.21C283.61,-20874.99 287.92,-20865.72 292,-20856.95"/>
<polygon fill="black" stroke="black" points="295.26,-20858.25 296.3,-20847.7 288.91,-20855.3 295.26,-20858.25"/>
</g>
<!-- layer3_mha_softmax&#45;&gt;layer3_mha_apply -->
<g id="edge54" class="edge">
<title>layer3_mha_softmax&#45;&gt;layer3_mha_apply</title>
<path fill="none" stroke="black" d="M352.67,-20795.44C369.72,-20785.86 389.33,-20774.83 407.15,-20764.82"/>
<polygon fill="black" stroke="black" points="409.28,-20767.64 416.28,-20759.68 405.85,-20761.53 409.28,-20767.64"/>
</g>
<!-- layer3_mha_out -->
<g id="node45" class="node">
<title>layer3_mha_out</title>
<polygon fill="pink" stroke="black" points="654.5,-20671.55 365.5,-20671.55 365.5,-20619.55 654.5,-20619.55 654.5,-20671.55"/>
<text text-anchor="middle" x="510" y="-20659.55" font-family="Arial" font-size="10.00">Layer 3 MHA Output Linear</text>
<text text-anchor="middle" x="510" y="-20648.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="510" y="-20637.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="510" y="-20626.55" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- layer3_mha_apply&#45;&gt;layer3_mha_out -->
<g id="edge56" class="edge">
<title>layer3_mha_apply&#45;&gt;layer3_mha_out</title>
<path fill="none" stroke="black" d="M475.44,-20707.21C480.17,-20698.9 485.51,-20689.52 490.56,-20680.67"/>
<polygon fill="black" stroke="black" points="493.76,-20682.13 495.67,-20671.7 487.68,-20678.66 493.76,-20682.13"/>
</g>
<!-- layer3_mha_out&#45;&gt;layer3_residual1 -->
<g id="edge57" class="edge">
<title>layer3_mha_out&#45;&gt;layer3_residual1</title>
<path fill="none" stroke="black" d="M521,-20619.41C524.76,-20610.82 529.13,-20600.82 533.55,-20590.72"/>
<polygon fill="black" stroke="black" points="536.8,-20592.03 537.6,-20581.46 530.38,-20589.22 536.8,-20592.03"/>
</g>
<!-- layer3_layernorm1 -->
<g id="node47" class="node">
<title>layer3_layernorm1</title>
<polygon fill="lightgreen" stroke="black" points="703.5,-20443.55 414.5,-20443.55 414.5,-20391.55 703.5,-20391.55 703.5,-20443.55"/>
<text text-anchor="middle" x="559" y="-20431.55" font-family="Arial" font-size="10.00">Layer 3 Layer Norm 1</text>
<text text-anchor="middle" x="559" y="-20420.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-20409.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-20398.55" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- layer3_residual1&#45;&gt;layer3_layernorm1 -->
<g id="edge59" class="edge">
<title>layer3_residual1&#45;&gt;layer3_layernorm1</title>
<path fill="none" stroke="black" d="M559,-20479.46C559,-20470.8 559,-20461.98 559,-20453.83"/>
<polygon fill="black" stroke="black" points="562.5,-20453.59 559,-20443.59 555.5,-20453.59 562.5,-20453.59"/>
</g>
<!-- layer3_mlp_gate -->
<g id="node48" class="node">
<title>layer3_mlp_gate</title>
<polygon fill="lightyellow" stroke="black" points="468,-20355.55 176,-20355.55 176,-20303.55 468,-20303.55 468,-20355.55"/>
<text text-anchor="middle" x="322" y="-20343.55" font-family="Arial" font-size="10.00">Layer 3 MLP Gate Linear</text>
<text text-anchor="middle" x="322" y="-20332.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="322" y="-20321.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="322" y="-20310.55" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- layer3_layernorm1&#45;&gt;layer3_mlp_gate -->
<g id="edge60" class="edge">
<title>layer3_layernorm1&#45;&gt;layer3_mlp_gate</title>
<path fill="none" stroke="black" d="M489.81,-20391.44C461.95,-20381.33 429.66,-20369.61 400.88,-20359.17"/>
<polygon fill="black" stroke="black" points="401.87,-20355.81 391.27,-20355.68 399.48,-20362.39 401.87,-20355.81"/>
</g>
<!-- layer3_mlp_up -->
<g id="node49" class="node">
<title>layer3_mlp_up</title>
<polygon fill="lightyellow" stroke="black" points="705,-20267.55 413,-20267.55 413,-20215.55 705,-20215.55 705,-20267.55"/>
<text text-anchor="middle" x="559" y="-20255.55" font-family="Arial" font-size="10.00">Layer 3 MLP Up Linear</text>
<text text-anchor="middle" x="559" y="-20244.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-20233.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="559" y="-20222.55" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- layer3_layernorm1&#45;&gt;layer3_mlp_up -->
<g id="edge61" class="edge">
<title>layer3_layernorm1&#45;&gt;layer3_mlp_up</title>
<path fill="none" stroke="black" d="M559,-20391.25C559,-20361.39 559,-20311.57 559,-20277.91"/>
<polygon fill="black" stroke="black" points="562.5,-20277.6 559,-20267.6 555.5,-20277.6 562.5,-20277.6"/>
</g>
<!-- layer3_residual2 -->
<g id="node53" class="node">
<title>layer3_residual2</title>
<polygon fill="lightblue" stroke="black" points="559,-20003.55 35,-19951.55 559,-19899.55 1083,-19951.55 559,-20003.55"/>
<text text-anchor="middle" x="559" y="-19965.55" font-family="Arial" font-size="10.00">Layer 3 Residual Add 2</text>
<text text-anchor="middle" x="559" y="-19954.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-19943.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-19932.55" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- layer3_layernorm1&#45;&gt;layer3_residual2 -->
<g id="edge67" class="edge">
<title>layer3_layernorm1&#45;&gt;layer3_residual2</title>
<path fill="none" stroke="black" d="M608.06,-20391.47C656.7,-20362.71 724,-20310.61 724,-20242.55 724,-20242.55 724,-20242.55 724,-20152.55 724,-20091.61 677.86,-20039.2 634.38,-20003.33"/>
<polygon fill="black" stroke="black" points="636.57,-20000.6 626.59,-19997.05 632.18,-20006.05 636.57,-20000.6"/>
</g>
<!-- layer3_mlp_gelu -->
<g id="node50" class="node">
<title>layer3_mlp_gelu</title>
<polygon fill="orange" stroke="black" points="395,-20267.55 103,-20267.55 103,-20215.55 395,-20215.55 395,-20267.55"/>
<text text-anchor="middle" x="249" y="-20255.55" font-family="Arial" font-size="10.00">Layer 3 MLP GELU</text>
<text text-anchor="middle" x="249" y="-20244.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="249" y="-20233.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="249" y="-20222.55" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- layer3_mlp_gate&#45;&gt;layer3_mlp_gelu -->
<g id="edge62" class="edge">
<title>layer3_mlp_gate&#45;&gt;layer3_mlp_gelu</title>
<path fill="none" stroke="black" d="M300.49,-20303.21C293.14,-20294.55 284.81,-20284.73 277.02,-20275.56"/>
<polygon fill="black" stroke="black" points="279.49,-20273.06 270.35,-20267.7 274.16,-20277.59 279.49,-20273.06"/>
</g>
<!-- layer3_mlp_multiply -->
<g id="node51" class="node">
<title>layer3_mlp_multiply</title>
<polygon fill="orange" stroke="black" points="705,-20179.55 175,-20179.55 175,-20127.55 705,-20127.55 705,-20179.55"/>
<text text-anchor="middle" x="440" y="-20167.55" font-family="Arial" font-size="10.00">Layer 3 MLP Element&#45;wise Multiply</text>
<text text-anchor="middle" x="440" y="-20156.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768], [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="440" y="-20145.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="440" y="-20134.55" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- layer3_mlp_up&#45;&gt;layer3_mlp_multiply -->
<g id="edge63" class="edge">
<title>layer3_mlp_up&#45;&gt;layer3_mlp_multiply</title>
<path fill="none" stroke="black" d="M524.26,-20215.44C511.42,-20206.16 496.71,-20195.53 483.21,-20185.77"/>
<polygon fill="black" stroke="black" points="485.14,-20182.85 474.99,-20179.83 481.04,-20188.53 485.14,-20182.85"/>
</g>
<!-- layer3_mlp_gelu&#45;&gt;layer3_mlp_multiply -->
<g id="edge64" class="edge">
<title>layer3_mlp_gelu&#45;&gt;layer3_mlp_multiply</title>
<path fill="none" stroke="black" d="M304.76,-20215.44C326.73,-20205.55 352.11,-20194.12 374.91,-20183.85"/>
<polygon fill="black" stroke="black" points="376.49,-20186.98 384.17,-20179.68 373.62,-20180.6 376.49,-20186.98"/>
</g>
<!-- layer3_mlp_down -->
<g id="node52" class="node">
<title>layer3_mlp_down</title>
<polygon fill="lightyellow" stroke="black" points="643.5,-20091.55 354.5,-20091.55 354.5,-20039.55 643.5,-20039.55 643.5,-20091.55"/>
<text text-anchor="middle" x="499" y="-20079.55" font-family="Arial" font-size="10.00">Layer 3 MLP Down Linear</text>
<text text-anchor="middle" x="499" y="-20068.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="499" y="-20057.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="499" y="-20046.55" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- layer3_mlp_multiply&#45;&gt;layer3_mlp_down -->
<g id="edge65" class="edge">
<title>layer3_mlp_multiply&#45;&gt;layer3_mlp_down</title>
<path fill="none" stroke="black" d="M457.38,-20127.21C463.2,-20118.72 469.79,-20109.13 475.97,-20100.11"/>
<polygon fill="black" stroke="black" points="478.97,-20101.93 481.74,-20091.7 473.2,-20097.97 478.97,-20101.93"/>
</g>
<!-- layer3_mlp_down&#45;&gt;layer3_residual2 -->
<g id="edge66" class="edge">
<title>layer3_mlp_down&#45;&gt;layer3_residual2</title>
<path fill="none" stroke="black" d="M512.47,-20039.41C517.17,-20030.63 522.66,-20020.38 528.19,-20010.06"/>
<polygon fill="black" stroke="black" points="531.4,-20011.48 533.04,-20001.01 525.23,-20008.17 531.4,-20011.48"/>
</g>
<!-- layer3_layernorm2 -->
<g id="node54" class="node">
<title>layer3_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="703.5,-19863.55 414.5,-19863.55 414.5,-19811.55 703.5,-19811.55 703.5,-19863.55"/>
<text text-anchor="middle" x="559" y="-19851.55" font-family="Arial" font-size="10.00">Layer 3 Layer Norm 2</text>
<text text-anchor="middle" x="559" y="-19840.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-19829.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-19818.55" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- layer3_residual2&#45;&gt;layer3_layernorm2 -->
<g id="edge68" class="edge">
<title>layer3_residual2&#45;&gt;layer3_layernorm2</title>
<path fill="none" stroke="black" d="M559,-19899.46C559,-19890.8 559,-19881.98 559,-19873.83"/>
<polygon fill="black" stroke="black" points="562.5,-19873.59 559,-19863.59 555.5,-19873.59 562.5,-19873.59"/>
</g>
<!-- layer3_layernorm2&#45;&gt;layer3_transfer -->
<g id="edge69" class="edge">
<title>layer3_layernorm2&#45;&gt;layer3_transfer</title>
<path fill="none" stroke="black" d="M559,-19811.38C559,-19803.57 559,-19794.7 559,-19785.93"/>
<polygon fill="black" stroke="black" points="562.5,-19785.75 559,-19775.75 555.5,-19785.75 562.5,-19785.75"/>
</g>
<!-- layer4_transfer -->
<g id="node55" class="node">
<title>layer4_transfer</title>
<ellipse fill="gray" stroke="black" cx="559" cy="-18223.24" rx="209.11" ry="36.54"/>
<text text-anchor="middle" x="559" y="-18237.24" font-family="Arial" font-size="10.00">Layer 4 â†’ 5 Transfer</text>
<text text-anchor="middle" x="559" y="-18226.24" font-family="Arial" font-size="10.00">Transfer: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-18215.24" font-family="Arial" font-size="10.00">From: GPU 3</text>
<text text-anchor="middle" x="559" y="-18204.24" font-family="Arial" font-size="10.00">To: GPU 4</text>
</g>
<!-- layer5_input -->
<g id="node74" class="node">
<title>layer5_input</title>
<polygon fill="lightyellow" stroke="black" points="858.74,-18132.47 381.92,-18132.47 259.26,-18028.47 736.08,-18028.47 858.74,-18132.47"/>
<text text-anchor="middle" x="559" y="-18094.47" font-family="Arial" font-size="10.00">Layer 5 Input</text>
<text text-anchor="middle" x="559" y="-18083.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-18072.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-18061.47" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- layer4_transfer&#45;&gt;layer5_input -->
<g id="edge93" class="edge">
<title>layer4_transfer&#45;&gt;layer5_input</title>
<path fill="none" stroke="black" d="M559,-18186.35C559,-18173.12 559,-18157.72 559,-18142.86"/>
<polygon fill="black" stroke="black" points="562.5,-18142.69 559,-18132.69 555.5,-18142.69 562.5,-18142.69"/>
</g>
<!-- layer4_mha_query -->
<g id="node57" class="node">
<title>layer4_mha_query</title>
<polygon fill="pink" stroke="black" points="335,-19508.01 39,-19508.01 39,-19456.01 335,-19456.01 335,-19508.01"/>
<text text-anchor="middle" x="187" y="-19496.01" font-family="Arial" font-size="10.00">Layer 4 MHA Query Linear</text>
<text text-anchor="middle" x="187" y="-19485.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="187" y="-19474.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_q=512]</text>
<text text-anchor="middle" x="187" y="-19463.01" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- layer4_input&#45;&gt;layer4_mha_query -->
<g id="edge71" class="edge">
<title>layer4_input&#45;&gt;layer4_mha_query</title>
<path fill="none" stroke="black" d="M389.6,-19544.01C351.9,-19532.66 313.28,-19521.03 280.01,-19511.01"/>
<polygon fill="black" stroke="black" points="280.9,-19507.62 270.31,-19508.09 278.88,-19514.33 280.9,-19507.62"/>
</g>
<!-- layer4_mha_key -->
<g id="node58" class="node">
<title>layer4_mha_key</title>
<polygon fill="pink" stroke="black" points="649,-19508.01 353,-19508.01 353,-19456.01 649,-19456.01 649,-19508.01"/>
<text text-anchor="middle" x="501" y="-19496.01" font-family="Arial" font-size="10.00">Layer 4 MHA Key Linear</text>
<text text-anchor="middle" x="501" y="-19485.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="501" y="-19474.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="501" y="-19463.01" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- layer4_input&#45;&gt;layer4_mha_key -->
<g id="edge72" class="edge">
<title>layer4_input&#45;&gt;layer4_mha_key</title>
<path fill="none" stroke="black" d="M532.55,-19543.92C527.86,-19534.87 523.08,-19525.64 518.71,-19517.2"/>
<polygon fill="black" stroke="black" points="521.68,-19515.32 513.97,-19508.05 515.46,-19518.54 521.68,-19515.32"/>
</g>
<!-- layer4_mha_value -->
<g id="node59" class="node">
<title>layer4_mha_value</title>
<polygon fill="pink" stroke="black" points="688,-19420.01 392,-19420.01 392,-19368.01 688,-19368.01 688,-19420.01"/>
<text text-anchor="middle" x="540" y="-19408.01" font-family="Arial" font-size="10.00">Layer 4 MHA Value Linear</text>
<text text-anchor="middle" x="540" y="-19397.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-19386.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_v=512]</text>
<text text-anchor="middle" x="540" y="-19375.01" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- layer4_input&#45;&gt;layer4_mha_value -->
<g id="edge73" class="edge">
<title>layer4_input&#45;&gt;layer4_mha_value</title>
<path fill="none" stroke="black" d="M632.59,-19543.87C642.9,-19533.27 652.01,-19521.25 658,-19508.01 667.53,-19486.95 670.02,-19475.75 658,-19456.01 650.35,-19443.44 639.19,-19433.35 626.74,-19425.29"/>
<polygon fill="black" stroke="black" points="628.32,-19422.15 617.94,-19420.02 624.72,-19428.16 628.32,-19422.15"/>
</g>
<!-- layer4_residual1 -->
<g id="node64" class="node">
<title>layer4_residual1</title>
<polygon fill="lightblue" stroke="black" points="559,-19068.01 35,-19016.01 559,-18964.01 1083,-19016.01 559,-19068.01"/>
<text text-anchor="middle" x="559" y="-19030.01" font-family="Arial" font-size="10.00">Layer 4 Residual Add 1</text>
<text text-anchor="middle" x="559" y="-19019.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-19008.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-18997.01" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- layer4_input&#45;&gt;layer4_residual1 -->
<g id="edge81" class="edge">
<title>layer4_input&#45;&gt;layer4_residual1</title>
<path fill="none" stroke="black" d="M633.98,-19543.8C646.18,-19533.04 657.81,-19520.97 667,-19508.01 697.8,-19464.54 707,-19448.28 707,-19395.01 707,-19395.01 707,-19395.01 707,-19217.01 707,-19158.49 665.56,-19105.9 626.53,-19069.35"/>
<polygon fill="black" stroke="black" points="628.51,-19066.42 618.77,-19062.26 623.79,-19071.59 628.51,-19066.42"/>
</g>
<!-- layer4_mha_qkt -->
<g id="node60" class="node">
<title>layer4_mha_qkt</title>
<polygon fill="lightcoral" stroke="black" points="373.5,-19420.01 48.5,-19420.01 48.5,-19368.01 373.5,-19368.01 373.5,-19420.01"/>
<text text-anchor="middle" x="211" y="-19408.01" font-family="Arial" font-size="10.00">Layer 4 MHA QKT Calculation</text>
<text text-anchor="middle" x="211" y="-19397.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="211" y="-19386.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="211" y="-19375.01" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- layer4_mha_query&#45;&gt;layer4_mha_qkt -->
<g id="edge74" class="edge">
<title>layer4_mha_query&#45;&gt;layer4_mha_qkt</title>
<path fill="none" stroke="black" d="M194.07,-19455.67C196.32,-19447.62 198.84,-19438.58 201.24,-19429.97"/>
<polygon fill="black" stroke="black" points="204.66,-19430.74 203.98,-19420.16 197.92,-19428.86 204.66,-19430.74"/>
</g>
<!-- layer4_mha_key&#45;&gt;layer4_mha_qkt -->
<g id="edge75" class="edge">
<title>layer4_mha_key&#45;&gt;layer4_mha_qkt</title>
<path fill="none" stroke="black" d="M416.34,-19455.9C381.57,-19445.59 341.18,-19433.61 305.46,-19423.02"/>
<polygon fill="black" stroke="black" points="306.1,-19419.56 295.51,-19420.07 304.11,-19426.27 306.1,-19419.56"/>
</g>
<!-- layer4_mha_apply -->
<g id="node62" class="node">
<title>layer4_mha_apply</title>
<polygon fill="lightcoral" stroke="black" points="688,-19244.01 120,-19244.01 120,-19192.01 688,-19192.01 688,-19244.01"/>
<text text-anchor="middle" x="404" y="-19232.01" font-family="Arial" font-size="10.00">Layer 4 MHA Apply Attention</text>
<text text-anchor="middle" x="404" y="-19221.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000], [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="404" y="-19210.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="404" y="-19199.01" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- layer4_mha_value&#45;&gt;layer4_mha_apply -->
<g id="edge78" class="edge">
<title>layer4_mha_value&#45;&gt;layer4_mha_apply</title>
<path fill="none" stroke="black" d="M520.22,-19367.71C496.39,-19337.21 456.26,-19285.87 429.95,-19252.21"/>
<polygon fill="black" stroke="black" points="432.49,-19249.78 423.58,-19244.06 426.98,-19254.09 432.49,-19249.78"/>
</g>
<!-- layer4_mha_softmax -->
<g id="node61" class="node">
<title>layer4_mha_softmax</title>
<polygon fill="lightcoral" stroke="black" points="410.5,-19332.01 85.5,-19332.01 85.5,-19280.01 410.5,-19280.01 410.5,-19332.01"/>
<text text-anchor="middle" x="248" y="-19320.01" font-family="Arial" font-size="10.00">Layer 4 MHA Softmax</text>
<text text-anchor="middle" x="248" y="-19309.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="248" y="-19298.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="248" y="-19287.01" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- layer4_mha_qkt&#45;&gt;layer4_mha_softmax -->
<g id="edge76" class="edge">
<title>layer4_mha_qkt&#45;&gt;layer4_mha_softmax</title>
<path fill="none" stroke="black" d="M221.9,-19367.67C225.44,-19359.45 229.43,-19350.18 233.2,-19341.41"/>
<polygon fill="black" stroke="black" points="236.44,-19342.73 237.18,-19332.16 230.01,-19339.97 236.44,-19342.73"/>
</g>
<!-- layer4_mha_softmax&#45;&gt;layer4_mha_apply -->
<g id="edge77" class="edge">
<title>layer4_mha_softmax&#45;&gt;layer4_mha_apply</title>
<path fill="none" stroke="black" d="M293.54,-19279.9C311.08,-19270.23 331.3,-19259.09 349.59,-19249"/>
<polygon fill="black" stroke="black" points="351.33,-19252.04 358.4,-19244.15 347.96,-19245.91 351.33,-19252.04"/>
</g>
<!-- layer4_mha_out -->
<g id="node63" class="node">
<title>layer4_mha_out</title>
<polygon fill="pink" stroke="black" points="618.5,-19156.01 329.5,-19156.01 329.5,-19104.01 618.5,-19104.01 618.5,-19156.01"/>
<text text-anchor="middle" x="474" y="-19144.01" font-family="Arial" font-size="10.00">Layer 4 MHA Output Linear</text>
<text text-anchor="middle" x="474" y="-19133.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="474" y="-19122.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="474" y="-19111.01" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- layer4_mha_apply&#45;&gt;layer4_mha_out -->
<g id="edge79" class="edge">
<title>layer4_mha_apply&#45;&gt;layer4_mha_out</title>
<path fill="none" stroke="black" d="M424.62,-19191.67C431.67,-19183.01 439.66,-19173.19 447.13,-19164.02"/>
<polygon fill="black" stroke="black" points="449.93,-19166.13 453.52,-19156.16 444.5,-19161.71 449.93,-19166.13"/>
</g>
<!-- layer4_mha_out&#45;&gt;layer4_residual1 -->
<g id="edge80" class="edge">
<title>layer4_mha_out&#45;&gt;layer4_residual1</title>
<path fill="none" stroke="black" d="M493.08,-19103.87C500.17,-19094.53 508.52,-19083.52 516.86,-19072.54"/>
<polygon fill="black" stroke="black" points="519.65,-19074.65 522.9,-19064.57 514.07,-19070.42 519.65,-19074.65"/>
</g>
<!-- layer4_layernorm1 -->
<g id="node65" class="node">
<title>layer4_layernorm1</title>
<polygon fill="lightgreen" stroke="black" points="703.5,-18928.01 414.5,-18928.01 414.5,-18876.01 703.5,-18876.01 703.5,-18928.01"/>
<text text-anchor="middle" x="559" y="-18916.01" font-family="Arial" font-size="10.00">Layer 4 Layer Norm 1</text>
<text text-anchor="middle" x="559" y="-18905.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-18894.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-18883.01" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- layer4_residual1&#45;&gt;layer4_layernorm1 -->
<g id="edge82" class="edge">
<title>layer4_residual1&#45;&gt;layer4_layernorm1</title>
<path fill="none" stroke="black" d="M559,-18963.92C559,-18955.26 559,-18946.44 559,-18938.29"/>
<polygon fill="black" stroke="black" points="562.5,-18938.05 559,-18928.05 555.5,-18938.05 562.5,-18938.05"/>
</g>
<!-- layer4_mlp_gate -->
<g id="node66" class="node">
<title>layer4_mlp_gate</title>
<polygon fill="lightyellow" stroke="black" points="468,-18840.01 176,-18840.01 176,-18788.01 468,-18788.01 468,-18840.01"/>
<text text-anchor="middle" x="322" y="-18828.01" font-family="Arial" font-size="10.00">Layer 4 MLP Gate Linear</text>
<text text-anchor="middle" x="322" y="-18817.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="322" y="-18806.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="322" y="-18795.01" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- layer4_layernorm1&#45;&gt;layer4_mlp_gate -->
<g id="edge83" class="edge">
<title>layer4_layernorm1&#45;&gt;layer4_mlp_gate</title>
<path fill="none" stroke="black" d="M489.81,-18875.9C461.95,-18865.79 429.66,-18854.07 400.88,-18843.63"/>
<polygon fill="black" stroke="black" points="401.87,-18840.27 391.27,-18840.15 399.48,-18846.85 401.87,-18840.27"/>
</g>
<!-- layer4_mlp_up -->
<g id="node67" class="node">
<title>layer4_mlp_up</title>
<polygon fill="lightyellow" stroke="black" points="705,-18752.01 413,-18752.01 413,-18700.01 705,-18700.01 705,-18752.01"/>
<text text-anchor="middle" x="559" y="-18740.01" font-family="Arial" font-size="10.00">Layer 4 MLP Up Linear</text>
<text text-anchor="middle" x="559" y="-18729.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-18718.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="559" y="-18707.01" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- layer4_layernorm1&#45;&gt;layer4_mlp_up -->
<g id="edge84" class="edge">
<title>layer4_layernorm1&#45;&gt;layer4_mlp_up</title>
<path fill="none" stroke="black" d="M559,-18875.71C559,-18845.85 559,-18796.03 559,-18762.37"/>
<polygon fill="black" stroke="black" points="562.5,-18762.06 559,-18752.06 555.5,-18762.06 562.5,-18762.06"/>
</g>
<!-- layer4_residual2 -->
<g id="node71" class="node">
<title>layer4_residual2</title>
<polygon fill="lightblue" stroke="black" points="559,-18488.01 35,-18436.01 559,-18384.01 1083,-18436.01 559,-18488.01"/>
<text text-anchor="middle" x="559" y="-18450.01" font-family="Arial" font-size="10.00">Layer 4 Residual Add 2</text>
<text text-anchor="middle" x="559" y="-18439.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-18428.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-18417.01" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- layer4_layernorm1&#45;&gt;layer4_residual2 -->
<g id="edge90" class="edge">
<title>layer4_layernorm1&#45;&gt;layer4_residual2</title>
<path fill="none" stroke="black" d="M608.06,-18875.93C656.7,-18847.17 724,-18795.07 724,-18727.01 724,-18727.01 724,-18727.01 724,-18637.01 724,-18576.07 677.86,-18523.66 634.38,-18487.79"/>
<polygon fill="black" stroke="black" points="636.57,-18485.06 626.59,-18481.51 632.18,-18490.51 636.57,-18485.06"/>
</g>
<!-- layer4_mlp_gelu -->
<g id="node68" class="node">
<title>layer4_mlp_gelu</title>
<polygon fill="orange" stroke="black" points="395,-18752.01 103,-18752.01 103,-18700.01 395,-18700.01 395,-18752.01"/>
<text text-anchor="middle" x="249" y="-18740.01" font-family="Arial" font-size="10.00">Layer 4 MLP GELU</text>
<text text-anchor="middle" x="249" y="-18729.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="249" y="-18718.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="249" y="-18707.01" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- layer4_mlp_gate&#45;&gt;layer4_mlp_gelu -->
<g id="edge85" class="edge">
<title>layer4_mlp_gate&#45;&gt;layer4_mlp_gelu</title>
<path fill="none" stroke="black" d="M300.49,-18787.67C293.14,-18779.01 284.81,-18769.19 277.02,-18760.02"/>
<polygon fill="black" stroke="black" points="279.49,-18757.52 270.35,-18752.16 274.16,-18762.05 279.49,-18757.52"/>
</g>
<!-- layer4_mlp_multiply -->
<g id="node69" class="node">
<title>layer4_mlp_multiply</title>
<polygon fill="orange" stroke="black" points="705,-18664.01 175,-18664.01 175,-18612.01 705,-18612.01 705,-18664.01"/>
<text text-anchor="middle" x="440" y="-18652.01" font-family="Arial" font-size="10.00">Layer 4 MLP Element&#45;wise Multiply</text>
<text text-anchor="middle" x="440" y="-18641.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768], [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="440" y="-18630.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="440" y="-18619.01" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- layer4_mlp_up&#45;&gt;layer4_mlp_multiply -->
<g id="edge86" class="edge">
<title>layer4_mlp_up&#45;&gt;layer4_mlp_multiply</title>
<path fill="none" stroke="black" d="M524.26,-18699.9C511.42,-18690.62 496.71,-18679.99 483.21,-18670.24"/>
<polygon fill="black" stroke="black" points="485.14,-18667.32 474.99,-18664.29 481.04,-18672.99 485.14,-18667.32"/>
</g>
<!-- layer4_mlp_gelu&#45;&gt;layer4_mlp_multiply -->
<g id="edge87" class="edge">
<title>layer4_mlp_gelu&#45;&gt;layer4_mlp_multiply</title>
<path fill="none" stroke="black" d="M304.76,-18699.9C326.73,-18690.01 352.11,-18678.58 374.91,-18668.32"/>
<polygon fill="black" stroke="black" points="376.49,-18671.44 384.17,-18664.15 373.62,-18665.06 376.49,-18671.44"/>
</g>
<!-- layer4_mlp_down -->
<g id="node70" class="node">
<title>layer4_mlp_down</title>
<polygon fill="lightyellow" stroke="black" points="643.5,-18576.01 354.5,-18576.01 354.5,-18524.01 643.5,-18524.01 643.5,-18576.01"/>
<text text-anchor="middle" x="499" y="-18564.01" font-family="Arial" font-size="10.00">Layer 4 MLP Down Linear</text>
<text text-anchor="middle" x="499" y="-18553.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="499" y="-18542.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="499" y="-18531.01" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- layer4_mlp_multiply&#45;&gt;layer4_mlp_down -->
<g id="edge88" class="edge">
<title>layer4_mlp_multiply&#45;&gt;layer4_mlp_down</title>
<path fill="none" stroke="black" d="M457.38,-18611.67C463.2,-18603.19 469.79,-18593.59 475.97,-18584.57"/>
<polygon fill="black" stroke="black" points="478.97,-18586.39 481.74,-18576.16 473.2,-18582.43 478.97,-18586.39"/>
</g>
<!-- layer4_mlp_down&#45;&gt;layer4_residual2 -->
<g id="edge89" class="edge">
<title>layer4_mlp_down&#45;&gt;layer4_residual2</title>
<path fill="none" stroke="black" d="M512.47,-18523.87C517.17,-18515.09 522.66,-18504.84 528.19,-18494.52"/>
<polygon fill="black" stroke="black" points="531.4,-18495.94 533.04,-18485.47 525.23,-18492.63 531.4,-18495.94"/>
</g>
<!-- layer4_layernorm2 -->
<g id="node72" class="node">
<title>layer4_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="703.5,-18348.01 414.5,-18348.01 414.5,-18296.01 703.5,-18296.01 703.5,-18348.01"/>
<text text-anchor="middle" x="559" y="-18336.01" font-family="Arial" font-size="10.00">Layer 4 Layer Norm 2</text>
<text text-anchor="middle" x="559" y="-18325.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-18314.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-18303.01" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- layer4_residual2&#45;&gt;layer4_layernorm2 -->
<g id="edge91" class="edge">
<title>layer4_residual2&#45;&gt;layer4_layernorm2</title>
<path fill="none" stroke="black" d="M559,-18383.92C559,-18375.26 559,-18366.44 559,-18358.29"/>
<polygon fill="black" stroke="black" points="562.5,-18358.05 559,-18348.05 555.5,-18358.05 562.5,-18358.05"/>
</g>
<!-- layer4_layernorm2&#45;&gt;layer4_transfer -->
<g id="edge92" class="edge">
<title>layer4_layernorm2&#45;&gt;layer4_transfer</title>
<path fill="none" stroke="black" d="M559,-18295.84C559,-18288.03 559,-18279.16 559,-18270.39"/>
<polygon fill="black" stroke="black" points="562.5,-18270.22 559,-18260.22 555.5,-18270.22 562.5,-18270.22"/>
</g>
<!-- layer5_transfer -->
<g id="node73" class="node">
<title>layer5_transfer</title>
<ellipse fill="gray" stroke="black" cx="549" cy="-16707.7" rx="209.11" ry="36.54"/>
<text text-anchor="middle" x="549" y="-16721.7" font-family="Arial" font-size="10.00">Layer 5 â†’ 6 Transfer</text>
<text text-anchor="middle" x="549" y="-16710.7" font-family="Arial" font-size="10.00">Transfer: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-16699.7" font-family="Arial" font-size="10.00">From: GPU 4</text>
<text text-anchor="middle" x="549" y="-16688.7" font-family="Arial" font-size="10.00">To: GPU 5</text>
</g>
<!-- layer6_input -->
<g id="node92" class="node">
<title>layer6_input</title>
<polygon fill="lightyellow" stroke="black" points="848.74,-16616.93 371.92,-16616.93 249.26,-16512.93 726.08,-16512.93 848.74,-16616.93"/>
<text text-anchor="middle" x="549" y="-16578.93" font-family="Arial" font-size="10.00">Layer 6 Input</text>
<text text-anchor="middle" x="549" y="-16567.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-16556.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-16545.93" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- layer5_transfer&#45;&gt;layer6_input -->
<g id="edge116" class="edge">
<title>layer5_transfer&#45;&gt;layer6_input</title>
<path fill="none" stroke="black" d="M549,-16670.81C549,-16657.58 549,-16642.18 549,-16627.32"/>
<polygon fill="black" stroke="black" points="552.5,-16627.16 549,-16617.16 545.5,-16627.16 552.5,-16627.16"/>
</g>
<!-- layer5_mha_query -->
<g id="node75" class="node">
<title>layer5_mha_query</title>
<polygon fill="pink" stroke="black" points="325,-17992.47 29,-17992.47 29,-17940.47 325,-17940.47 325,-17992.47"/>
<text text-anchor="middle" x="177" y="-17980.47" font-family="Arial" font-size="10.00">Layer 5 MHA Query Linear</text>
<text text-anchor="middle" x="177" y="-17969.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="177" y="-17958.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_q=512]</text>
<text text-anchor="middle" x="177" y="-17947.47" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- layer5_input&#45;&gt;layer5_mha_query -->
<g id="edge94" class="edge">
<title>layer5_input&#45;&gt;layer5_mha_query</title>
<path fill="none" stroke="black" d="M385.05,-18028.47C346.24,-18017.09 306.49,-18005.43 272.27,-17995.4"/>
<polygon fill="black" stroke="black" points="272.88,-17991.93 262.3,-17992.48 270.91,-17998.65 272.88,-17991.93"/>
</g>
<!-- layer5_mha_key -->
<g id="node76" class="node">
<title>layer5_mha_key</title>
<polygon fill="pink" stroke="black" points="639,-17992.47 343,-17992.47 343,-17940.47 639,-17940.47 639,-17992.47"/>
<text text-anchor="middle" x="491" y="-17980.47" font-family="Arial" font-size="10.00">Layer 5 MHA Key Linear</text>
<text text-anchor="middle" x="491" y="-17969.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="491" y="-17958.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="491" y="-17947.47" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- layer5_input&#45;&gt;layer5_mha_key -->
<g id="edge95" class="edge">
<title>layer5_input&#45;&gt;layer5_mha_key</title>
<path fill="none" stroke="black" d="M527.98,-18028.39C522.37,-18019.14 516.64,-18009.71 511.43,-18001.12"/>
<polygon fill="black" stroke="black" points="514.39,-17999.24 506.2,-17992.51 508.4,-18002.88 514.39,-17999.24"/>
</g>
<!-- layer5_mha_value -->
<g id="node77" class="node">
<title>layer5_mha_value</title>
<polygon fill="pink" stroke="black" points="735,-17904.47 439,-17904.47 439,-17852.47 735,-17852.47 735,-17904.47"/>
<text text-anchor="middle" x="587" y="-17892.47" font-family="Arial" font-size="10.00">Layer 5 MHA Value Linear</text>
<text text-anchor="middle" x="587" y="-17881.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="587" y="-17870.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_v=512]</text>
<text text-anchor="middle" x="587" y="-17859.47" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- layer5_input&#45;&gt;layer5_mha_value -->
<g id="edge96" class="edge">
<title>layer5_input&#45;&gt;layer5_mha_value</title>
<path fill="none" stroke="black" d="M624.6,-18028.07C634.13,-18017.39 642.55,-18005.41 648,-17992.47 656.97,-17971.17 656.84,-17961.82 648,-17940.47 643.61,-17929.87 636.39,-17920.16 628.43,-17911.75"/>
<polygon fill="black" stroke="black" points="630.86,-17909.23 621.29,-17904.7 625.94,-17914.22 630.86,-17909.23"/>
</g>
<!-- layer5_residual1 -->
<g id="node82" class="node">
<title>layer5_residual1</title>
<polygon fill="lightblue" stroke="black" points="549,-17552.47 25,-17500.47 549,-17448.47 1073,-17500.47 549,-17552.47"/>
<text text-anchor="middle" x="549" y="-17514.47" font-family="Arial" font-size="10.00">Layer 5 Residual Add 1</text>
<text text-anchor="middle" x="549" y="-17503.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-17492.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-17481.47" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- layer5_input&#45;&gt;layer5_residual1 -->
<g id="edge104" class="edge">
<title>layer5_input&#45;&gt;layer5_residual1</title>
<path fill="none" stroke="black" d="M653.07,-18028.42C702.94,-17993.88 754,-17943 754,-17879.47 754,-17879.47 754,-17879.47 754,-17701.47 754,-17634.92 697.97,-17583.29 644.49,-17549.17"/>
<polygon fill="black" stroke="black" points="646.28,-17546.16 635.94,-17543.84 642.58,-17552.1 646.28,-17546.16"/>
</g>
<!-- layer5_mha_qkt -->
<g id="node78" class="node">
<title>layer5_mha_qkt</title>
<polygon fill="lightcoral" stroke="black" points="420.5,-17904.47 95.5,-17904.47 95.5,-17852.47 420.5,-17852.47 420.5,-17904.47"/>
<text text-anchor="middle" x="258" y="-17892.47" font-family="Arial" font-size="10.00">Layer 5 MHA QKT Calculation</text>
<text text-anchor="middle" x="258" y="-17881.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="258" y="-17870.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="258" y="-17859.47" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- layer5_mha_query&#45;&gt;layer5_mha_qkt -->
<g id="edge97" class="edge">
<title>layer5_mha_query&#45;&gt;layer5_mha_qkt</title>
<path fill="none" stroke="black" d="M200.86,-17940.13C209.19,-17931.3 218.64,-17921.26 227.43,-17911.92"/>
<polygon fill="black" stroke="black" points="230,-17914.31 234.31,-17904.63 224.9,-17909.51 230,-17914.31"/>
</g>
<!-- layer5_mha_key&#45;&gt;layer5_mha_qkt -->
<g id="edge98" class="edge">
<title>layer5_mha_key&#45;&gt;layer5_mha_qkt</title>
<path fill="none" stroke="black" d="M422.98,-17940.36C395.59,-17930.25 363.84,-17918.53 335.55,-17908.09"/>
<polygon fill="black" stroke="black" points="336.7,-17904.79 326.1,-17904.61 334.27,-17911.35 336.7,-17904.79"/>
</g>
<!-- layer5_mha_apply -->
<g id="node80" class="node">
<title>layer5_mha_apply</title>
<polygon fill="lightcoral" stroke="black" points="735,-17728.47 167,-17728.47 167,-17676.47 735,-17676.47 735,-17728.47"/>
<text text-anchor="middle" x="451" y="-17716.47" font-family="Arial" font-size="10.00">Layer 5 MHA Apply Attention</text>
<text text-anchor="middle" x="451" y="-17705.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000], [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="451" y="-17694.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="451" y="-17683.47" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- layer5_mha_value&#45;&gt;layer5_mha_apply -->
<g id="edge101" class="edge">
<title>layer5_mha_value&#45;&gt;layer5_mha_apply</title>
<path fill="none" stroke="black" d="M569.11,-17852.42C552.42,-17829.28 526.61,-17794.11 503,-17764.47 495.62,-17755.21 487.41,-17745.37 479.72,-17736.35"/>
<polygon fill="black" stroke="black" points="482.31,-17733.99 473.14,-17728.68 477,-17738.55 482.31,-17733.99"/>
</g>
<!-- layer5_mha_softmax -->
<g id="node79" class="node">
<title>layer5_mha_softmax</title>
<polygon fill="lightcoral" stroke="black" points="494.5,-17816.47 169.5,-17816.47 169.5,-17764.47 494.5,-17764.47 494.5,-17816.47"/>
<text text-anchor="middle" x="332" y="-17804.47" font-family="Arial" font-size="10.00">Layer 5 MHA Softmax</text>
<text text-anchor="middle" x="332" y="-17793.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="332" y="-17782.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="332" y="-17771.47" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- layer5_mha_qkt&#45;&gt;layer5_mha_softmax -->
<g id="edge99" class="edge">
<title>layer5_mha_qkt&#45;&gt;layer5_mha_softmax</title>
<path fill="none" stroke="black" d="M279.8,-17852.13C287.25,-17843.47 295.7,-17833.65 303.6,-17824.48"/>
<polygon fill="black" stroke="black" points="306.48,-17826.49 310.35,-17816.63 301.18,-17821.92 306.48,-17826.49"/>
</g>
<!-- layer5_mha_softmax&#45;&gt;layer5_mha_apply -->
<g id="edge100" class="edge">
<title>layer5_mha_softmax&#45;&gt;layer5_mha_apply</title>
<path fill="none" stroke="black" d="M366.74,-17764.36C379.58,-17755.08 394.29,-17744.45 407.79,-17734.7"/>
<polygon fill="black" stroke="black" points="409.96,-17737.45 416.01,-17728.76 405.86,-17731.78 409.96,-17737.45"/>
</g>
<!-- layer5_mha_out -->
<g id="node81" class="node">
<title>layer5_mha_out</title>
<polygon fill="pink" stroke="black" points="644.5,-17640.47 355.5,-17640.47 355.5,-17588.47 644.5,-17588.47 644.5,-17640.47"/>
<text text-anchor="middle" x="500" y="-17628.47" font-family="Arial" font-size="10.00">Layer 5 MHA Output Linear</text>
<text text-anchor="middle" x="500" y="-17617.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="500" y="-17606.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="500" y="-17595.47" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- layer5_mha_apply&#45;&gt;layer5_mha_out -->
<g id="edge102" class="edge">
<title>layer5_mha_apply&#45;&gt;layer5_mha_out</title>
<path fill="none" stroke="black" d="M465.44,-17676.13C470.17,-17667.82 475.51,-17658.44 480.56,-17649.59"/>
<polygon fill="black" stroke="black" points="483.76,-17651.05 485.67,-17640.63 477.68,-17647.58 483.76,-17651.05"/>
</g>
<!-- layer5_mha_out&#45;&gt;layer5_residual1 -->
<g id="edge103" class="edge">
<title>layer5_mha_out&#45;&gt;layer5_residual1</title>
<path fill="none" stroke="black" d="M511,-17588.33C514.76,-17579.74 519.13,-17569.74 523.55,-17559.64"/>
<polygon fill="black" stroke="black" points="526.8,-17560.95 527.6,-17550.38 520.38,-17558.14 526.8,-17560.95"/>
</g>
<!-- layer5_layernorm1 -->
<g id="node83" class="node">
<title>layer5_layernorm1</title>
<polygon fill="lightgreen" stroke="black" points="693.5,-17412.47 404.5,-17412.47 404.5,-17360.47 693.5,-17360.47 693.5,-17412.47"/>
<text text-anchor="middle" x="549" y="-17400.47" font-family="Arial" font-size="10.00">Layer 5 Layer Norm 1</text>
<text text-anchor="middle" x="549" y="-17389.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-17378.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-17367.47" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- layer5_residual1&#45;&gt;layer5_layernorm1 -->
<g id="edge105" class="edge">
<title>layer5_residual1&#45;&gt;layer5_layernorm1</title>
<path fill="none" stroke="black" d="M549,-17448.39C549,-17439.72 549,-17430.9 549,-17422.75"/>
<polygon fill="black" stroke="black" points="552.5,-17422.51 549,-17412.51 545.5,-17422.51 552.5,-17422.51"/>
</g>
<!-- layer5_mlp_gate -->
<g id="node84" class="node">
<title>layer5_mlp_gate</title>
<polygon fill="lightyellow" stroke="black" points="458,-17324.47 166,-17324.47 166,-17272.47 458,-17272.47 458,-17324.47"/>
<text text-anchor="middle" x="312" y="-17312.47" font-family="Arial" font-size="10.00">Layer 5 MLP Gate Linear</text>
<text text-anchor="middle" x="312" y="-17301.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="312" y="-17290.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="312" y="-17279.47" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- layer5_layernorm1&#45;&gt;layer5_mlp_gate -->
<g id="edge106" class="edge">
<title>layer5_layernorm1&#45;&gt;layer5_mlp_gate</title>
<path fill="none" stroke="black" d="M479.81,-17360.36C451.95,-17350.25 419.66,-17338.53 390.88,-17328.09"/>
<polygon fill="black" stroke="black" points="391.87,-17324.73 381.27,-17324.61 389.48,-17331.31 391.87,-17324.73"/>
</g>
<!-- layer5_mlp_up -->
<g id="node85" class="node">
<title>layer5_mlp_up</title>
<polygon fill="lightyellow" stroke="black" points="695,-17236.47 403,-17236.47 403,-17184.47 695,-17184.47 695,-17236.47"/>
<text text-anchor="middle" x="549" y="-17224.47" font-family="Arial" font-size="10.00">Layer 5 MLP Up Linear</text>
<text text-anchor="middle" x="549" y="-17213.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-17202.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="549" y="-17191.47" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- layer5_layernorm1&#45;&gt;layer5_mlp_up -->
<g id="edge107" class="edge">
<title>layer5_layernorm1&#45;&gt;layer5_mlp_up</title>
<path fill="none" stroke="black" d="M549,-17360.17C549,-17330.32 549,-17280.49 549,-17246.83"/>
<polygon fill="black" stroke="black" points="552.5,-17246.52 549,-17236.52 545.5,-17246.52 552.5,-17246.52"/>
</g>
<!-- layer5_residual2 -->
<g id="node89" class="node">
<title>layer5_residual2</title>
<polygon fill="lightblue" stroke="black" points="549,-16972.47 25,-16920.47 549,-16868.47 1073,-16920.47 549,-16972.47"/>
<text text-anchor="middle" x="549" y="-16934.47" font-family="Arial" font-size="10.00">Layer 5 Residual Add 2</text>
<text text-anchor="middle" x="549" y="-16923.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-16912.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-16901.47" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- layer5_layernorm1&#45;&gt;layer5_residual2 -->
<g id="edge113" class="edge">
<title>layer5_layernorm1&#45;&gt;layer5_residual2</title>
<path fill="none" stroke="black" d="M598.06,-17360.39C646.7,-17331.63 714,-17279.54 714,-17211.47 714,-17211.47 714,-17211.47 714,-17121.47 714,-17060.53 667.86,-17008.12 624.38,-16972.25"/>
<polygon fill="black" stroke="black" points="626.57,-16969.52 616.59,-16965.97 622.18,-16974.97 626.57,-16969.52"/>
</g>
<!-- layer5_mlp_gelu -->
<g id="node86" class="node">
<title>layer5_mlp_gelu</title>
<polygon fill="orange" stroke="black" points="385,-17236.47 93,-17236.47 93,-17184.47 385,-17184.47 385,-17236.47"/>
<text text-anchor="middle" x="239" y="-17224.47" font-family="Arial" font-size="10.00">Layer 5 MLP GELU</text>
<text text-anchor="middle" x="239" y="-17213.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="239" y="-17202.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="239" y="-17191.47" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- layer5_mlp_gate&#45;&gt;layer5_mlp_gelu -->
<g id="edge108" class="edge">
<title>layer5_mlp_gate&#45;&gt;layer5_mlp_gelu</title>
<path fill="none" stroke="black" d="M290.49,-17272.13C283.14,-17263.47 274.81,-17253.65 267.02,-17244.48"/>
<polygon fill="black" stroke="black" points="269.49,-17241.98 260.35,-17236.63 264.16,-17246.51 269.49,-17241.98"/>
</g>
<!-- layer5_mlp_multiply -->
<g id="node87" class="node">
<title>layer5_mlp_multiply</title>
<polygon fill="orange" stroke="black" points="695,-17148.47 165,-17148.47 165,-17096.47 695,-17096.47 695,-17148.47"/>
<text text-anchor="middle" x="430" y="-17136.47" font-family="Arial" font-size="10.00">Layer 5 MLP Element&#45;wise Multiply</text>
<text text-anchor="middle" x="430" y="-17125.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768], [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="430" y="-17114.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="430" y="-17103.47" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- layer5_mlp_up&#45;&gt;layer5_mlp_multiply -->
<g id="edge109" class="edge">
<title>layer5_mlp_up&#45;&gt;layer5_mlp_multiply</title>
<path fill="none" stroke="black" d="M514.26,-17184.36C501.42,-17175.08 486.71,-17164.45 473.21,-17154.7"/>
<polygon fill="black" stroke="black" points="475.14,-17151.78 464.99,-17148.76 471.04,-17157.45 475.14,-17151.78"/>
</g>
<!-- layer5_mlp_gelu&#45;&gt;layer5_mlp_multiply -->
<g id="edge110" class="edge">
<title>layer5_mlp_gelu&#45;&gt;layer5_mlp_multiply</title>
<path fill="none" stroke="black" d="M294.76,-17184.36C316.73,-17174.47 342.11,-17163.04 364.91,-17152.78"/>
<polygon fill="black" stroke="black" points="366.49,-17155.9 374.17,-17148.61 363.62,-17149.52 366.49,-17155.9"/>
</g>
<!-- layer5_mlp_down -->
<g id="node88" class="node">
<title>layer5_mlp_down</title>
<polygon fill="lightyellow" stroke="black" points="633.5,-17060.47 344.5,-17060.47 344.5,-17008.47 633.5,-17008.47 633.5,-17060.47"/>
<text text-anchor="middle" x="489" y="-17048.47" font-family="Arial" font-size="10.00">Layer 5 MLP Down Linear</text>
<text text-anchor="middle" x="489" y="-17037.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="489" y="-17026.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="489" y="-17015.47" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- layer5_mlp_multiply&#45;&gt;layer5_mlp_down -->
<g id="edge111" class="edge">
<title>layer5_mlp_multiply&#45;&gt;layer5_mlp_down</title>
<path fill="none" stroke="black" d="M447.38,-17096.13C453.2,-17087.65 459.79,-17078.05 465.97,-17069.04"/>
<polygon fill="black" stroke="black" points="468.97,-17070.85 471.74,-17060.63 463.2,-17066.89 468.97,-17070.85"/>
</g>
<!-- layer5_mlp_down&#45;&gt;layer5_residual2 -->
<g id="edge112" class="edge">
<title>layer5_mlp_down&#45;&gt;layer5_residual2</title>
<path fill="none" stroke="black" d="M502.47,-17008.33C507.17,-16999.55 512.66,-16989.3 518.19,-16978.98"/>
<polygon fill="black" stroke="black" points="521.4,-16980.4 523.04,-16969.93 515.23,-16977.09 521.4,-16980.4"/>
</g>
<!-- layer5_layernorm2 -->
<g id="node90" class="node">
<title>layer5_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="693.5,-16832.47 404.5,-16832.47 404.5,-16780.47 693.5,-16780.47 693.5,-16832.47"/>
<text text-anchor="middle" x="549" y="-16820.47" font-family="Arial" font-size="10.00">Layer 5 Layer Norm 2</text>
<text text-anchor="middle" x="549" y="-16809.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-16798.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-16787.47" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- layer5_residual2&#45;&gt;layer5_layernorm2 -->
<g id="edge114" class="edge">
<title>layer5_residual2&#45;&gt;layer5_layernorm2</title>
<path fill="none" stroke="black" d="M549,-16868.39C549,-16859.72 549,-16850.9 549,-16842.75"/>
<polygon fill="black" stroke="black" points="552.5,-16842.51 549,-16832.51 545.5,-16842.51 552.5,-16842.51"/>
</g>
<!-- layer5_layernorm2&#45;&gt;layer5_transfer -->
<g id="edge115" class="edge">
<title>layer5_layernorm2&#45;&gt;layer5_transfer</title>
<path fill="none" stroke="black" d="M549,-16780.3C549,-16772.49 549,-16763.62 549,-16754.85"/>
<polygon fill="black" stroke="black" points="552.5,-16754.68 549,-16744.68 545.5,-16754.68 552.5,-16754.68"/>
</g>
<!-- layer6_transfer -->
<g id="node91" class="node">
<title>layer6_transfer</title>
<ellipse fill="gray" stroke="black" cx="549" cy="-15192.16" rx="209.11" ry="36.54"/>
<text text-anchor="middle" x="549" y="-15206.16" font-family="Arial" font-size="10.00">Layer 6 â†’ 7 Transfer</text>
<text text-anchor="middle" x="549" y="-15195.16" font-family="Arial" font-size="10.00">Transfer: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-15184.16" font-family="Arial" font-size="10.00">From: GPU 5</text>
<text text-anchor="middle" x="549" y="-15173.16" font-family="Arial" font-size="10.00">To: GPU 6</text>
</g>
<!-- layer7_input -->
<g id="node110" class="node">
<title>layer7_input</title>
<polygon fill="lightyellow" stroke="black" points="848.74,-15101.39 371.92,-15101.39 249.26,-14997.39 726.08,-14997.39 848.74,-15101.39"/>
<text text-anchor="middle" x="549" y="-15063.39" font-family="Arial" font-size="10.00">Layer 7 Input</text>
<text text-anchor="middle" x="549" y="-15052.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-15041.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-15030.39" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- layer6_transfer&#45;&gt;layer7_input -->
<g id="edge139" class="edge">
<title>layer6_transfer&#45;&gt;layer7_input</title>
<path fill="none" stroke="black" d="M549,-15155.27C549,-15142.04 549,-15126.64 549,-15111.78"/>
<polygon fill="black" stroke="black" points="552.5,-15111.62 549,-15101.62 545.5,-15111.62 552.5,-15111.62"/>
</g>
<!-- layer6_mha_query -->
<g id="node93" class="node">
<title>layer6_mha_query</title>
<polygon fill="pink" stroke="black" points="325,-16476.93 29,-16476.93 29,-16424.93 325,-16424.93 325,-16476.93"/>
<text text-anchor="middle" x="177" y="-16464.93" font-family="Arial" font-size="10.00">Layer 6 MHA Query Linear</text>
<text text-anchor="middle" x="177" y="-16453.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="177" y="-16442.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_q=512]</text>
<text text-anchor="middle" x="177" y="-16431.93" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- layer6_input&#45;&gt;layer6_mha_query -->
<g id="edge117" class="edge">
<title>layer6_input&#45;&gt;layer6_mha_query</title>
<path fill="none" stroke="black" d="M379.6,-16512.93C341.9,-16501.58 303.28,-16489.95 270.01,-16479.93"/>
<polygon fill="black" stroke="black" points="270.9,-16476.55 260.31,-16477.01 268.88,-16483.25 270.9,-16476.55"/>
</g>
<!-- layer6_mha_key -->
<g id="node94" class="node">
<title>layer6_mha_key</title>
<polygon fill="pink" stroke="black" points="639,-16476.93 343,-16476.93 343,-16424.93 639,-16424.93 639,-16476.93"/>
<text text-anchor="middle" x="491" y="-16464.93" font-family="Arial" font-size="10.00">Layer 6 MHA Key Linear</text>
<text text-anchor="middle" x="491" y="-16453.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="491" y="-16442.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="491" y="-16431.93" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- layer6_input&#45;&gt;layer6_mha_key -->
<g id="edge118" class="edge">
<title>layer6_input&#45;&gt;layer6_mha_key</title>
<path fill="none" stroke="black" d="M522.55,-16512.85C517.86,-16503.79 513.08,-16494.57 508.71,-16486.12"/>
<polygon fill="black" stroke="black" points="511.68,-16484.24 503.97,-16476.97 505.46,-16487.46 511.68,-16484.24"/>
</g>
<!-- layer6_mha_value -->
<g id="node95" class="node">
<title>layer6_mha_value</title>
<polygon fill="pink" stroke="black" points="735,-16388.93 439,-16388.93 439,-16336.93 735,-16336.93 735,-16388.93"/>
<text text-anchor="middle" x="587" y="-16376.93" font-family="Arial" font-size="10.00">Layer 6 MHA Value Linear</text>
<text text-anchor="middle" x="587" y="-16365.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="587" y="-16354.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_v=512]</text>
<text text-anchor="middle" x="587" y="-16343.93" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- layer6_input&#45;&gt;layer6_mha_value -->
<g id="edge119" class="edge">
<title>layer6_input&#45;&gt;layer6_mha_value</title>
<path fill="none" stroke="black" d="M622.59,-16512.79C632.9,-16502.19 642.01,-16490.17 648,-16476.93 657.53,-16455.87 656.84,-16446.28 648,-16424.93 643.61,-16414.34 636.39,-16404.62 628.43,-16396.21"/>
<polygon fill="black" stroke="black" points="630.86,-16393.7 621.29,-16389.16 625.94,-16398.68 630.86,-16393.7"/>
</g>
<!-- layer6_residual1 -->
<g id="node100" class="node">
<title>layer6_residual1</title>
<polygon fill="lightblue" stroke="black" points="549,-16036.93 25,-15984.93 549,-15932.93 1073,-15984.93 549,-16036.93"/>
<text text-anchor="middle" x="549" y="-15998.93" font-family="Arial" font-size="10.00">Layer 6 Residual Add 1</text>
<text text-anchor="middle" x="549" y="-15987.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-15976.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-15965.93" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- layer6_input&#45;&gt;layer6_residual1 -->
<g id="edge127" class="edge">
<title>layer6_input&#45;&gt;layer6_residual1</title>
<path fill="none" stroke="black" d="M649.7,-16512.86C701.54,-16478.74 754,-16428.32 754,-16363.93 754,-16363.93 754,-16363.93 754,-16185.93 754,-16119.38 697.97,-16067.75 644.49,-16033.63"/>
<polygon fill="black" stroke="black" points="646.28,-16030.62 635.94,-16028.31 642.58,-16036.56 646.28,-16030.62"/>
</g>
<!-- layer6_mha_qkt -->
<g id="node96" class="node">
<title>layer6_mha_qkt</title>
<polygon fill="lightcoral" stroke="black" points="420.5,-16388.93 95.5,-16388.93 95.5,-16336.93 420.5,-16336.93 420.5,-16388.93"/>
<text text-anchor="middle" x="258" y="-16376.93" font-family="Arial" font-size="10.00">Layer 6 MHA QKT Calculation</text>
<text text-anchor="middle" x="258" y="-16365.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="258" y="-16354.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="258" y="-16343.93" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- layer6_mha_query&#45;&gt;layer6_mha_qkt -->
<g id="edge120" class="edge">
<title>layer6_mha_query&#45;&gt;layer6_mha_qkt</title>
<path fill="none" stroke="black" d="M200.86,-16424.59C209.19,-16415.76 218.64,-16405.72 227.43,-16396.38"/>
<polygon fill="black" stroke="black" points="230,-16398.77 234.31,-16389.09 224.9,-16393.97 230,-16398.77"/>
</g>
<!-- layer6_mha_key&#45;&gt;layer6_mha_qkt -->
<g id="edge121" class="edge">
<title>layer6_mha_key&#45;&gt;layer6_mha_qkt</title>
<path fill="none" stroke="black" d="M422.98,-16424.82C395.59,-16414.71 363.84,-16403 335.55,-16392.55"/>
<polygon fill="black" stroke="black" points="336.7,-16389.25 326.1,-16389.07 334.27,-16395.81 336.7,-16389.25"/>
</g>
<!-- layer6_mha_apply -->
<g id="node98" class="node">
<title>layer6_mha_apply</title>
<polygon fill="lightcoral" stroke="black" points="735,-16212.93 167,-16212.93 167,-16160.93 735,-16160.93 735,-16212.93"/>
<text text-anchor="middle" x="451" y="-16200.93" font-family="Arial" font-size="10.00">Layer 6 MHA Apply Attention</text>
<text text-anchor="middle" x="451" y="-16189.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000], [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="451" y="-16178.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="451" y="-16167.93" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- layer6_mha_value&#45;&gt;layer6_mha_apply -->
<g id="edge124" class="edge">
<title>layer6_mha_value&#45;&gt;layer6_mha_apply</title>
<path fill="none" stroke="black" d="M567.22,-16336.63C543.39,-16306.13 503.26,-16254.79 476.95,-16221.13"/>
<polygon fill="black" stroke="black" points="479.49,-16218.7 470.58,-16212.98 473.98,-16223.01 479.49,-16218.7"/>
</g>
<!-- layer6_mha_softmax -->
<g id="node97" class="node">
<title>layer6_mha_softmax</title>
<polygon fill="lightcoral" stroke="black" points="460.5,-16300.93 135.5,-16300.93 135.5,-16248.93 460.5,-16248.93 460.5,-16300.93"/>
<text text-anchor="middle" x="298" y="-16288.93" font-family="Arial" font-size="10.00">Layer 6 MHA Softmax</text>
<text text-anchor="middle" x="298" y="-16277.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="298" y="-16266.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="298" y="-16255.93" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- layer6_mha_qkt&#45;&gt;layer6_mha_softmax -->
<g id="edge122" class="edge">
<title>layer6_mha_qkt&#45;&gt;layer6_mha_softmax</title>
<path fill="none" stroke="black" d="M269.78,-16336.59C273.61,-16328.37 277.92,-16319.1 282,-16310.33"/>
<polygon fill="black" stroke="black" points="285.26,-16311.63 286.3,-16301.09 278.91,-16308.68 285.26,-16311.63"/>
</g>
<!-- layer6_mha_softmax&#45;&gt;layer6_mha_apply -->
<g id="edge123" class="edge">
<title>layer6_mha_softmax&#45;&gt;layer6_mha_apply</title>
<path fill="none" stroke="black" d="M342.67,-16248.82C359.72,-16239.24 379.33,-16228.21 397.15,-16218.2"/>
<polygon fill="black" stroke="black" points="399.28,-16221.02 406.28,-16213.07 395.85,-16214.92 399.28,-16221.02"/>
</g>
<!-- layer6_mha_out -->
<g id="node99" class="node">
<title>layer6_mha_out</title>
<polygon fill="pink" stroke="black" points="644.5,-16124.93 355.5,-16124.93 355.5,-16072.93 644.5,-16072.93 644.5,-16124.93"/>
<text text-anchor="middle" x="500" y="-16112.93" font-family="Arial" font-size="10.00">Layer 6 MHA Output Linear</text>
<text text-anchor="middle" x="500" y="-16101.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="500" y="-16090.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="500" y="-16079.93" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- layer6_mha_apply&#45;&gt;layer6_mha_out -->
<g id="edge125" class="edge">
<title>layer6_mha_apply&#45;&gt;layer6_mha_out</title>
<path fill="none" stroke="black" d="M465.44,-16160.59C470.17,-16152.28 475.51,-16142.91 480.56,-16134.05"/>
<polygon fill="black" stroke="black" points="483.76,-16135.51 485.67,-16125.09 477.68,-16132.04 483.76,-16135.51"/>
</g>
<!-- layer6_mha_out&#45;&gt;layer6_residual1 -->
<g id="edge126" class="edge">
<title>layer6_mha_out&#45;&gt;layer6_residual1</title>
<path fill="none" stroke="black" d="M511,-16072.8C514.76,-16064.2 519.13,-16054.2 523.55,-16044.11"/>
<polygon fill="black" stroke="black" points="526.8,-16045.41 527.6,-16034.84 520.38,-16042.6 526.8,-16045.41"/>
</g>
<!-- layer6_layernorm1 -->
<g id="node101" class="node">
<title>layer6_layernorm1</title>
<polygon fill="lightgreen" stroke="black" points="693.5,-15896.93 404.5,-15896.93 404.5,-15844.93 693.5,-15844.93 693.5,-15896.93"/>
<text text-anchor="middle" x="549" y="-15884.93" font-family="Arial" font-size="10.00">Layer 6 Layer Norm 1</text>
<text text-anchor="middle" x="549" y="-15873.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-15862.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-15851.93" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- layer6_residual1&#45;&gt;layer6_layernorm1 -->
<g id="edge128" class="edge">
<title>layer6_residual1&#45;&gt;layer6_layernorm1</title>
<path fill="none" stroke="black" d="M549,-15932.85C549,-15924.18 549,-15915.36 549,-15907.22"/>
<polygon fill="black" stroke="black" points="552.5,-15906.97 549,-15896.97 545.5,-15906.97 552.5,-15906.97"/>
</g>
<!-- layer6_mlp_gate -->
<g id="node102" class="node">
<title>layer6_mlp_gate</title>
<polygon fill="lightyellow" stroke="black" points="458,-15808.93 166,-15808.93 166,-15756.93 458,-15756.93 458,-15808.93"/>
<text text-anchor="middle" x="312" y="-15796.93" font-family="Arial" font-size="10.00">Layer 6 MLP Gate Linear</text>
<text text-anchor="middle" x="312" y="-15785.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="312" y="-15774.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="312" y="-15763.93" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- layer6_layernorm1&#45;&gt;layer6_mlp_gate -->
<g id="edge129" class="edge">
<title>layer6_layernorm1&#45;&gt;layer6_mlp_gate</title>
<path fill="none" stroke="black" d="M479.81,-15844.82C451.95,-15834.71 419.66,-15823 390.88,-15812.55"/>
<polygon fill="black" stroke="black" points="391.87,-15809.19 381.27,-15809.07 389.48,-15815.77 391.87,-15809.19"/>
</g>
<!-- layer6_mlp_up -->
<g id="node103" class="node">
<title>layer6_mlp_up</title>
<polygon fill="lightyellow" stroke="black" points="695,-15720.93 403,-15720.93 403,-15668.93 695,-15668.93 695,-15720.93"/>
<text text-anchor="middle" x="549" y="-15708.93" font-family="Arial" font-size="10.00">Layer 6 MLP Up Linear</text>
<text text-anchor="middle" x="549" y="-15697.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-15686.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="549" y="-15675.93" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- layer6_layernorm1&#45;&gt;layer6_mlp_up -->
<g id="edge130" class="edge">
<title>layer6_layernorm1&#45;&gt;layer6_mlp_up</title>
<path fill="none" stroke="black" d="M549,-15844.63C549,-15814.78 549,-15764.96 549,-15731.29"/>
<polygon fill="black" stroke="black" points="552.5,-15730.98 549,-15720.98 545.5,-15730.98 552.5,-15730.98"/>
</g>
<!-- layer6_residual2 -->
<g id="node107" class="node">
<title>layer6_residual2</title>
<polygon fill="lightblue" stroke="black" points="549,-15456.93 25,-15404.93 549,-15352.93 1073,-15404.93 549,-15456.93"/>
<text text-anchor="middle" x="549" y="-15418.93" font-family="Arial" font-size="10.00">Layer 6 Residual Add 2</text>
<text text-anchor="middle" x="549" y="-15407.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-15396.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-15385.93" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- layer6_layernorm1&#45;&gt;layer6_residual2 -->
<g id="edge136" class="edge">
<title>layer6_layernorm1&#45;&gt;layer6_residual2</title>
<path fill="none" stroke="black" d="M598.06,-15844.86C646.7,-15816.09 714,-15764 714,-15695.93 714,-15695.93 714,-15695.93 714,-15605.93 714,-15544.99 667.86,-15492.58 624.38,-15456.71"/>
<polygon fill="black" stroke="black" points="626.57,-15453.98 616.59,-15450.43 622.18,-15459.43 626.57,-15453.98"/>
</g>
<!-- layer6_mlp_gelu -->
<g id="node104" class="node">
<title>layer6_mlp_gelu</title>
<polygon fill="orange" stroke="black" points="385,-15720.93 93,-15720.93 93,-15668.93 385,-15668.93 385,-15720.93"/>
<text text-anchor="middle" x="239" y="-15708.93" font-family="Arial" font-size="10.00">Layer 6 MLP GELU</text>
<text text-anchor="middle" x="239" y="-15697.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="239" y="-15686.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="239" y="-15675.93" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- layer6_mlp_gate&#45;&gt;layer6_mlp_gelu -->
<g id="edge131" class="edge">
<title>layer6_mlp_gate&#45;&gt;layer6_mlp_gelu</title>
<path fill="none" stroke="black" d="M290.49,-15756.59C283.14,-15747.93 274.81,-15738.11 267.02,-15728.94"/>
<polygon fill="black" stroke="black" points="269.49,-15726.45 260.35,-15721.09 264.16,-15730.98 269.49,-15726.45"/>
</g>
<!-- layer6_mlp_multiply -->
<g id="node105" class="node">
<title>layer6_mlp_multiply</title>
<polygon fill="orange" stroke="black" points="695,-15632.93 165,-15632.93 165,-15580.93 695,-15580.93 695,-15632.93"/>
<text text-anchor="middle" x="430" y="-15620.93" font-family="Arial" font-size="10.00">Layer 6 MLP Element&#45;wise Multiply</text>
<text text-anchor="middle" x="430" y="-15609.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768], [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="430" y="-15598.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="430" y="-15587.93" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- layer6_mlp_up&#45;&gt;layer6_mlp_multiply -->
<g id="edge132" class="edge">
<title>layer6_mlp_up&#45;&gt;layer6_mlp_multiply</title>
<path fill="none" stroke="black" d="M514.26,-15668.82C501.42,-15659.55 486.71,-15648.91 473.21,-15639.16"/>
<polygon fill="black" stroke="black" points="475.14,-15636.24 464.99,-15633.22 471.04,-15641.91 475.14,-15636.24"/>
</g>
<!-- layer6_mlp_gelu&#45;&gt;layer6_mlp_multiply -->
<g id="edge133" class="edge">
<title>layer6_mlp_gelu&#45;&gt;layer6_mlp_multiply</title>
<path fill="none" stroke="black" d="M294.76,-15668.82C316.73,-15658.93 342.11,-15647.5 364.91,-15637.24"/>
<polygon fill="black" stroke="black" points="366.49,-15640.36 374.17,-15633.07 363.62,-15633.98 366.49,-15640.36"/>
</g>
<!-- layer6_mlp_down -->
<g id="node106" class="node">
<title>layer6_mlp_down</title>
<polygon fill="lightyellow" stroke="black" points="633.5,-15544.93 344.5,-15544.93 344.5,-15492.93 633.5,-15492.93 633.5,-15544.93"/>
<text text-anchor="middle" x="489" y="-15532.93" font-family="Arial" font-size="10.00">Layer 6 MLP Down Linear</text>
<text text-anchor="middle" x="489" y="-15521.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="489" y="-15510.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="489" y="-15499.93" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- layer6_mlp_multiply&#45;&gt;layer6_mlp_down -->
<g id="edge134" class="edge">
<title>layer6_mlp_multiply&#45;&gt;layer6_mlp_down</title>
<path fill="none" stroke="black" d="M447.38,-15580.59C453.2,-15572.11 459.79,-15562.51 465.97,-15553.5"/>
<polygon fill="black" stroke="black" points="468.97,-15555.31 471.74,-15545.09 463.2,-15551.35 468.97,-15555.31"/>
</g>
<!-- layer6_mlp_down&#45;&gt;layer6_residual2 -->
<g id="edge135" class="edge">
<title>layer6_mlp_down&#45;&gt;layer6_residual2</title>
<path fill="none" stroke="black" d="M502.47,-15492.8C507.17,-15484.02 512.66,-15473.76 518.19,-15463.44"/>
<polygon fill="black" stroke="black" points="521.4,-15464.86 523.04,-15454.39 515.23,-15461.56 521.4,-15464.86"/>
</g>
<!-- layer6_layernorm2 -->
<g id="node108" class="node">
<title>layer6_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="693.5,-15316.93 404.5,-15316.93 404.5,-15264.93 693.5,-15264.93 693.5,-15316.93"/>
<text text-anchor="middle" x="549" y="-15304.93" font-family="Arial" font-size="10.00">Layer 6 Layer Norm 2</text>
<text text-anchor="middle" x="549" y="-15293.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-15282.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-15271.93" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- layer6_residual2&#45;&gt;layer6_layernorm2 -->
<g id="edge137" class="edge">
<title>layer6_residual2&#45;&gt;layer6_layernorm2</title>
<path fill="none" stroke="black" d="M549,-15352.85C549,-15344.18 549,-15335.36 549,-15327.22"/>
<polygon fill="black" stroke="black" points="552.5,-15326.97 549,-15316.97 545.5,-15326.97 552.5,-15326.97"/>
</g>
<!-- layer6_layernorm2&#45;&gt;layer6_transfer -->
<g id="edge138" class="edge">
<title>layer6_layernorm2&#45;&gt;layer6_transfer</title>
<path fill="none" stroke="black" d="M549,-15264.76C549,-15256.95 549,-15248.08 549,-15239.32"/>
<polygon fill="black" stroke="black" points="552.5,-15239.14 549,-15229.14 545.5,-15239.14 552.5,-15239.14"/>
</g>
<!-- layer7_transfer -->
<g id="node109" class="node">
<title>layer7_transfer</title>
<ellipse fill="gray" stroke="black" cx="584" cy="-13676.62" rx="209.11" ry="36.54"/>
<text text-anchor="middle" x="584" y="-13690.62" font-family="Arial" font-size="10.00">Layer 7 â†’ 8 Transfer</text>
<text text-anchor="middle" x="584" y="-13679.62" font-family="Arial" font-size="10.00">Transfer: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-13668.62" font-family="Arial" font-size="10.00">From: GPU 6</text>
<text text-anchor="middle" x="584" y="-13657.62" font-family="Arial" font-size="10.00">To: GPU 7</text>
</g>
<!-- layer8_input -->
<g id="node128" class="node">
<title>layer8_input</title>
<polygon fill="lightyellow" stroke="black" points="883.74,-13585.85 406.92,-13585.85 284.26,-13481.85 761.08,-13481.85 883.74,-13585.85"/>
<text text-anchor="middle" x="584" y="-13547.85" font-family="Arial" font-size="10.00">Layer 8 Input</text>
<text text-anchor="middle" x="584" y="-13536.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-13525.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-13514.85" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- layer7_transfer&#45;&gt;layer8_input -->
<g id="edge162" class="edge">
<title>layer7_transfer&#45;&gt;layer8_input</title>
<path fill="none" stroke="black" d="M584,-13639.74C584,-13626.5 584,-13611.1 584,-13596.24"/>
<polygon fill="black" stroke="black" points="587.5,-13596.08 584,-13586.08 580.5,-13596.08 587.5,-13596.08"/>
</g>
<!-- layer7_mha_query -->
<g id="node111" class="node">
<title>layer7_mha_query</title>
<polygon fill="pink" stroke="black" points="370,-14961.39 74,-14961.39 74,-14909.39 370,-14909.39 370,-14961.39"/>
<text text-anchor="middle" x="222" y="-14949.39" font-family="Arial" font-size="10.00">Layer 7 MHA Query Linear</text>
<text text-anchor="middle" x="222" y="-14938.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="222" y="-14927.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_q=512]</text>
<text text-anchor="middle" x="222" y="-14916.39" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- layer7_input&#45;&gt;layer7_mha_query -->
<g id="edge140" class="edge">
<title>layer7_input&#45;&gt;layer7_mha_query</title>
<path fill="none" stroke="black" d="M399.85,-14997.31C367.17,-14986.11 333.71,-14974.65 304.76,-14964.74"/>
<polygon fill="black" stroke="black" points="305.71,-14961.36 295.12,-14961.43 303.44,-14967.99 305.71,-14961.36"/>
</g>
<!-- layer7_mha_key -->
<g id="node112" class="node">
<title>layer7_mha_key</title>
<polygon fill="pink" stroke="black" points="684,-14961.39 388,-14961.39 388,-14909.39 684,-14909.39 684,-14961.39"/>
<text text-anchor="middle" x="536" y="-14949.39" font-family="Arial" font-size="10.00">Layer 7 MHA Key Linear</text>
<text text-anchor="middle" x="536" y="-14938.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="536" y="-14927.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="536" y="-14916.39" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- layer7_input&#45;&gt;layer7_mha_key -->
<g id="edge141" class="edge">
<title>layer7_input&#45;&gt;layer7_mha_key</title>
<path fill="none" stroke="black" d="M543.07,-14997.31C542.05,-14988.55 541.02,-14979.62 540.06,-14971.4"/>
<polygon fill="black" stroke="black" points="543.54,-14970.96 538.91,-14961.43 536.58,-14971.77 543.54,-14970.96"/>
</g>
<!-- layer7_mha_value -->
<g id="node113" class="node">
<title>layer7_mha_value</title>
<polygon fill="pink" stroke="black" points="765,-14873.39 469,-14873.39 469,-14821.39 765,-14821.39 765,-14873.39"/>
<text text-anchor="middle" x="617" y="-14861.39" font-family="Arial" font-size="10.00">Layer 7 MHA Value Linear</text>
<text text-anchor="middle" x="617" y="-14850.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="617" y="-14839.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_v=512]</text>
<text text-anchor="middle" x="617" y="-14828.39" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- layer7_input&#45;&gt;layer7_mha_value -->
<g id="edge142" class="edge">
<title>layer7_input&#45;&gt;layer7_mha_value</title>
<path fill="none" stroke="black" d="M661.66,-14997.31C674.16,-14987.16 685.18,-14975.26 693,-14961.39 704.36,-14941.26 702.99,-14930.23 693,-14909.39 687.57,-14898.08 678.91,-14888.2 669.34,-14879.87"/>
<polygon fill="black" stroke="black" points="671.49,-14877.11 661.52,-14873.53 667.09,-14882.55 671.49,-14877.11"/>
</g>
<!-- layer7_residual1 -->
<g id="node118" class="node">
<title>layer7_residual1</title>
<polygon fill="lightblue" stroke="black" points="584,-14521.39 60,-14469.39 584,-14417.39 1108,-14469.39 584,-14521.39"/>
<text text-anchor="middle" x="584" y="-14483.39" font-family="Arial" font-size="10.00">Layer 7 Residual Add 1</text>
<text text-anchor="middle" x="584" y="-14472.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-14461.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-14450.39" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- layer7_input&#45;&gt;layer7_residual1 -->
<g id="edge150" class="edge">
<title>layer7_input&#45;&gt;layer7_residual1</title>
<path fill="none" stroke="black" d="M670.97,-14997.29C728.2,-14964.41 784,-14915.22 784,-14848.39 784,-14848.39 784,-14848.39 784,-14670.39 784,-14604.69 729.37,-14553.03 677.21,-14518.69"/>
<polygon fill="black" stroke="black" points="678.83,-14515.57 668.53,-14513.11 675.05,-14521.46 678.83,-14515.57"/>
</g>
<!-- layer7_mha_qkt -->
<g id="node114" class="node">
<title>layer7_mha_qkt</title>
<polygon fill="lightcoral" stroke="black" points="450.5,-14873.39 125.5,-14873.39 125.5,-14821.39 450.5,-14821.39 450.5,-14873.39"/>
<text text-anchor="middle" x="288" y="-14861.39" font-family="Arial" font-size="10.00">Layer 7 MHA QKT Calculation</text>
<text text-anchor="middle" x="288" y="-14850.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="288" y="-14839.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="288" y="-14828.39" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- layer7_mha_query&#45;&gt;layer7_mha_qkt -->
<g id="edge143" class="edge">
<title>layer7_mha_query&#45;&gt;layer7_mha_qkt</title>
<path fill="none" stroke="black" d="M241.45,-14909.05C248.02,-14900.48 255.47,-14890.77 262.45,-14881.68"/>
<polygon fill="black" stroke="black" points="265.38,-14883.61 268.69,-14873.55 259.83,-14879.35 265.38,-14883.61"/>
</g>
<!-- layer7_mha_key&#45;&gt;layer7_mha_qkt -->
<g id="edge144" class="edge">
<title>layer7_mha_key&#45;&gt;layer7_mha_qkt</title>
<path fill="none" stroke="black" d="M463.6,-14909.29C434.32,-14899.13 400.36,-14887.35 370.15,-14876.88"/>
<polygon fill="black" stroke="black" points="371.08,-14873.5 360.49,-14873.53 368.79,-14880.11 371.08,-14873.5"/>
</g>
<!-- layer7_mha_apply -->
<g id="node116" class="node">
<title>layer7_mha_apply</title>
<polygon fill="lightcoral" stroke="black" points="765,-14697.39 197,-14697.39 197,-14645.39 765,-14645.39 765,-14697.39"/>
<text text-anchor="middle" x="481" y="-14685.39" font-family="Arial" font-size="10.00">Layer 7 MHA Apply Attention</text>
<text text-anchor="middle" x="481" y="-14674.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000], [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="481" y="-14663.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="481" y="-14652.39" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- layer7_mha_value&#45;&gt;layer7_mha_apply -->
<g id="edge147" class="edge">
<title>layer7_mha_value&#45;&gt;layer7_mha_apply</title>
<path fill="none" stroke="black" d="M597.22,-14821.09C573.39,-14790.59 533.26,-14739.25 506.95,-14705.59"/>
<polygon fill="black" stroke="black" points="509.49,-14703.16 500.58,-14697.44 503.98,-14707.47 509.49,-14703.16"/>
</g>
<!-- layer7_mha_softmax -->
<g id="node115" class="node">
<title>layer7_mha_softmax</title>
<polygon fill="lightcoral" stroke="black" points="490.5,-14785.39 165.5,-14785.39 165.5,-14733.39 490.5,-14733.39 490.5,-14785.39"/>
<text text-anchor="middle" x="328" y="-14773.39" font-family="Arial" font-size="10.00">Layer 7 MHA Softmax</text>
<text text-anchor="middle" x="328" y="-14762.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="328" y="-14751.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="328" y="-14740.39" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- layer7_mha_qkt&#45;&gt;layer7_mha_softmax -->
<g id="edge145" class="edge">
<title>layer7_mha_qkt&#45;&gt;layer7_mha_softmax</title>
<path fill="none" stroke="black" d="M299.78,-14821.05C303.61,-14812.83 307.92,-14803.56 312,-14794.79"/>
<polygon fill="black" stroke="black" points="315.26,-14796.09 316.3,-14785.55 308.91,-14793.14 315.26,-14796.09"/>
</g>
<!-- layer7_mha_softmax&#45;&gt;layer7_mha_apply -->
<g id="edge146" class="edge">
<title>layer7_mha_softmax&#45;&gt;layer7_mha_apply</title>
<path fill="none" stroke="black" d="M372.67,-14733.29C389.72,-14723.7 409.33,-14712.67 427.15,-14702.66"/>
<polygon fill="black" stroke="black" points="429.28,-14705.48 436.28,-14697.53 425.85,-14699.38 429.28,-14705.48"/>
</g>
<!-- layer7_mha_out -->
<g id="node117" class="node">
<title>layer7_mha_out</title>
<polygon fill="pink" stroke="black" points="670.5,-14609.39 381.5,-14609.39 381.5,-14557.39 670.5,-14557.39 670.5,-14609.39"/>
<text text-anchor="middle" x="526" y="-14597.39" font-family="Arial" font-size="10.00">Layer 7 MHA Output Linear</text>
<text text-anchor="middle" x="526" y="-14586.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="526" y="-14575.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="526" y="-14564.39" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- layer7_mha_apply&#45;&gt;layer7_mha_out -->
<g id="edge148" class="edge">
<title>layer7_mha_apply&#45;&gt;layer7_mha_out</title>
<path fill="none" stroke="black" d="M494.26,-14645.05C498.61,-14636.74 503.51,-14627.37 508.14,-14618.52"/>
<polygon fill="black" stroke="black" points="511.3,-14620.03 512.84,-14609.55 505.1,-14616.79 511.3,-14620.03"/>
</g>
<!-- layer7_mha_out&#45;&gt;layer7_residual1 -->
<g id="edge149" class="edge">
<title>layer7_mha_out&#45;&gt;layer7_residual1</title>
<path fill="none" stroke="black" d="M539.02,-14557.26C543.51,-14548.58 548.75,-14538.46 554.03,-14528.26"/>
<polygon fill="black" stroke="black" points="557.18,-14529.8 558.67,-14519.31 550.96,-14526.58 557.18,-14529.8"/>
</g>
<!-- layer7_layernorm1 -->
<g id="node119" class="node">
<title>layer7_layernorm1</title>
<polygon fill="lightgreen" stroke="black" points="728.5,-14381.39 439.5,-14381.39 439.5,-14329.39 728.5,-14329.39 728.5,-14381.39"/>
<text text-anchor="middle" x="584" y="-14369.39" font-family="Arial" font-size="10.00">Layer 7 Layer Norm 1</text>
<text text-anchor="middle" x="584" y="-14358.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-14347.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-14336.39" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- layer7_residual1&#45;&gt;layer7_layernorm1 -->
<g id="edge151" class="edge">
<title>layer7_residual1&#45;&gt;layer7_layernorm1</title>
<path fill="none" stroke="black" d="M584,-14417.31C584,-14408.64 584,-14399.82 584,-14391.68"/>
<polygon fill="black" stroke="black" points="587.5,-14391.43 584,-14381.43 580.5,-14391.43 587.5,-14391.43"/>
</g>
<!-- layer7_mlp_gate -->
<g id="node120" class="node">
<title>layer7_mlp_gate</title>
<polygon fill="lightyellow" stroke="black" points="493,-14293.39 201,-14293.39 201,-14241.39 493,-14241.39 493,-14293.39"/>
<text text-anchor="middle" x="347" y="-14281.39" font-family="Arial" font-size="10.00">Layer 7 MLP Gate Linear</text>
<text text-anchor="middle" x="347" y="-14270.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="347" y="-14259.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="347" y="-14248.39" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- layer7_layernorm1&#45;&gt;layer7_mlp_gate -->
<g id="edge152" class="edge">
<title>layer7_layernorm1&#45;&gt;layer7_mlp_gate</title>
<path fill="none" stroke="black" d="M514.81,-14329.29C486.95,-14319.17 454.66,-14307.46 425.88,-14297.02"/>
<polygon fill="black" stroke="black" points="426.87,-14293.65 416.27,-14293.53 424.48,-14300.23 426.87,-14293.65"/>
</g>
<!-- layer7_mlp_up -->
<g id="node121" class="node">
<title>layer7_mlp_up</title>
<polygon fill="lightyellow" stroke="black" points="730,-14205.39 438,-14205.39 438,-14153.39 730,-14153.39 730,-14205.39"/>
<text text-anchor="middle" x="584" y="-14193.39" font-family="Arial" font-size="10.00">Layer 7 MLP Up Linear</text>
<text text-anchor="middle" x="584" y="-14182.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-14171.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="584" y="-14160.39" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- layer7_layernorm1&#45;&gt;layer7_mlp_up -->
<g id="edge153" class="edge">
<title>layer7_layernorm1&#45;&gt;layer7_mlp_up</title>
<path fill="none" stroke="black" d="M584,-14329.09C584,-14299.24 584,-14249.42 584,-14215.76"/>
<polygon fill="black" stroke="black" points="587.5,-14215.44 584,-14205.44 580.5,-14215.44 587.5,-14215.44"/>
</g>
<!-- layer7_residual2 -->
<g id="node125" class="node">
<title>layer7_residual2</title>
<polygon fill="lightblue" stroke="black" points="584,-13941.39 60,-13889.39 584,-13837.39 1108,-13889.39 584,-13941.39"/>
<text text-anchor="middle" x="584" y="-13903.39" font-family="Arial" font-size="10.00">Layer 7 Residual Add 2</text>
<text text-anchor="middle" x="584" y="-13892.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-13881.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-13870.39" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- layer7_layernorm1&#45;&gt;layer7_residual2 -->
<g id="edge159" class="edge">
<title>layer7_layernorm1&#45;&gt;layer7_residual2</title>
<path fill="none" stroke="black" d="M633.06,-14329.32C681.7,-14300.55 749,-14248.46 749,-14180.39 749,-14180.39 749,-14180.39 749,-14090.39 749,-14029.46 702.86,-13977.04 659.38,-13941.17"/>
<polygon fill="black" stroke="black" points="661.57,-13938.44 651.59,-13934.89 657.18,-13943.89 661.57,-13938.44"/>
</g>
<!-- layer7_mlp_gelu -->
<g id="node122" class="node">
<title>layer7_mlp_gelu</title>
<polygon fill="orange" stroke="black" points="420,-14205.39 128,-14205.39 128,-14153.39 420,-14153.39 420,-14205.39"/>
<text text-anchor="middle" x="274" y="-14193.39" font-family="Arial" font-size="10.00">Layer 7 MLP GELU</text>
<text text-anchor="middle" x="274" y="-14182.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="274" y="-14171.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="274" y="-14160.39" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- layer7_mlp_gate&#45;&gt;layer7_mlp_gelu -->
<g id="edge154" class="edge">
<title>layer7_mlp_gate&#45;&gt;layer7_mlp_gelu</title>
<path fill="none" stroke="black" d="M325.49,-14241.05C318.14,-14232.39 309.81,-14222.58 302.02,-14213.4"/>
<polygon fill="black" stroke="black" points="304.49,-14210.91 295.35,-14205.55 299.16,-14215.44 304.49,-14210.91"/>
</g>
<!-- layer7_mlp_multiply -->
<g id="node123" class="node">
<title>layer7_mlp_multiply</title>
<polygon fill="orange" stroke="black" points="730,-14117.39 200,-14117.39 200,-14065.39 730,-14065.39 730,-14117.39"/>
<text text-anchor="middle" x="465" y="-14105.39" font-family="Arial" font-size="10.00">Layer 7 MLP Element&#45;wise Multiply</text>
<text text-anchor="middle" x="465" y="-14094.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768], [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="465" y="-14083.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="465" y="-14072.39" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- layer7_mlp_up&#45;&gt;layer7_mlp_multiply -->
<g id="edge155" class="edge">
<title>layer7_mlp_up&#45;&gt;layer7_mlp_multiply</title>
<path fill="none" stroke="black" d="M549.26,-14153.29C536.42,-14144.01 521.71,-14133.37 508.21,-14123.62"/>
<polygon fill="black" stroke="black" points="510.14,-14120.7 499.99,-14117.68 506.04,-14126.37 510.14,-14120.7"/>
</g>
<!-- layer7_mlp_gelu&#45;&gt;layer7_mlp_multiply -->
<g id="edge156" class="edge">
<title>layer7_mlp_gelu&#45;&gt;layer7_mlp_multiply</title>
<path fill="none" stroke="black" d="M329.76,-14153.29C351.73,-14143.39 377.11,-14131.96 399.91,-14121.7"/>
<polygon fill="black" stroke="black" points="401.49,-14124.83 409.17,-14117.53 398.62,-14118.44 401.49,-14124.83"/>
</g>
<!-- layer7_mlp_down -->
<g id="node124" class="node">
<title>layer7_mlp_down</title>
<polygon fill="lightyellow" stroke="black" points="669.5,-14029.39 380.5,-14029.39 380.5,-13977.39 669.5,-13977.39 669.5,-14029.39"/>
<text text-anchor="middle" x="525" y="-14017.39" font-family="Arial" font-size="10.00">Layer 7 MLP Down Linear</text>
<text text-anchor="middle" x="525" y="-14006.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="525" y="-13995.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="525" y="-13984.39" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- layer7_mlp_multiply&#45;&gt;layer7_mlp_down -->
<g id="edge157" class="edge">
<title>layer7_mlp_multiply&#45;&gt;layer7_mlp_down</title>
<path fill="none" stroke="black" d="M482.68,-14065.05C488.6,-14056.57 495.29,-14046.97 501.58,-14037.96"/>
<polygon fill="black" stroke="black" points="504.6,-14039.75 507.45,-14029.55 498.86,-14035.75 504.6,-14039.75"/>
</g>
<!-- layer7_mlp_down&#45;&gt;layer7_residual2 -->
<g id="edge158" class="edge">
<title>layer7_mlp_down&#45;&gt;layer7_residual2</title>
<path fill="none" stroke="black" d="M538.24,-13977.26C542.81,-13968.58 548.14,-13958.46 553.52,-13948.26"/>
<polygon fill="black" stroke="black" points="556.67,-13949.78 558.23,-13939.31 550.47,-13946.52 556.67,-13949.78"/>
</g>
<!-- layer7_layernorm2 -->
<g id="node126" class="node">
<title>layer7_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="728.5,-13801.39 439.5,-13801.39 439.5,-13749.39 728.5,-13749.39 728.5,-13801.39"/>
<text text-anchor="middle" x="584" y="-13789.39" font-family="Arial" font-size="10.00">Layer 7 Layer Norm 2</text>
<text text-anchor="middle" x="584" y="-13778.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-13767.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-13756.39" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- layer7_residual2&#45;&gt;layer7_layernorm2 -->
<g id="edge160" class="edge">
<title>layer7_residual2&#45;&gt;layer7_layernorm2</title>
<path fill="none" stroke="black" d="M584,-13837.31C584,-13828.64 584,-13819.82 584,-13811.68"/>
<polygon fill="black" stroke="black" points="587.5,-13811.43 584,-13801.43 580.5,-13811.43 587.5,-13811.43"/>
</g>
<!-- layer7_layernorm2&#45;&gt;layer7_transfer -->
<g id="edge161" class="edge">
<title>layer7_layernorm2&#45;&gt;layer7_transfer</title>
<path fill="none" stroke="black" d="M584,-13749.22C584,-13741.41 584,-13732.54 584,-13723.78"/>
<polygon fill="black" stroke="black" points="587.5,-13723.6 584,-13713.6 580.5,-13723.6 587.5,-13723.6"/>
</g>
<!-- layer8_transfer -->
<g id="node127" class="node">
<title>layer8_transfer</title>
<ellipse fill="gray" stroke="black" cx="580" cy="-12161.08" rx="209.11" ry="36.54"/>
<text text-anchor="middle" x="580" y="-12175.08" font-family="Arial" font-size="10.00">Layer 8 â†’ 9 Transfer</text>
<text text-anchor="middle" x="580" y="-12164.08" font-family="Arial" font-size="10.00">Transfer: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="580" y="-12153.08" font-family="Arial" font-size="10.00">From: GPU 7</text>
<text text-anchor="middle" x="580" y="-12142.08" font-family="Arial" font-size="10.00">To: GPU 8</text>
</g>
<!-- layer9_input -->
<g id="node146" class="node">
<title>layer9_input</title>
<polygon fill="lightyellow" stroke="black" points="879.74,-12070.31 402.92,-12070.31 280.26,-11966.31 757.08,-11966.31 879.74,-12070.31"/>
<text text-anchor="middle" x="580" y="-12032.31" font-family="Arial" font-size="10.00">Layer 9 Input</text>
<text text-anchor="middle" x="580" y="-12021.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="580" y="-12010.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="580" y="-11999.31" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- layer8_transfer&#45;&gt;layer9_input -->
<g id="edge185" class="edge">
<title>layer8_transfer&#45;&gt;layer9_input</title>
<path fill="none" stroke="black" d="M580,-12124.2C580,-12110.96 580,-12095.56 580,-12080.7"/>
<polygon fill="black" stroke="black" points="583.5,-12080.54 580,-12070.54 576.5,-12080.54 583.5,-12080.54"/>
</g>
<!-- layer8_mha_query -->
<g id="node129" class="node">
<title>layer8_mha_query</title>
<polygon fill="pink" stroke="black" points="404,-13445.85 108,-13445.85 108,-13393.85 404,-13393.85 404,-13445.85"/>
<text text-anchor="middle" x="256" y="-13433.85" font-family="Arial" font-size="10.00">Layer 8 MHA Query Linear</text>
<text text-anchor="middle" x="256" y="-13422.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="256" y="-13411.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_q=512]</text>
<text text-anchor="middle" x="256" y="-13400.85" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- layer8_input&#45;&gt;layer8_mha_query -->
<g id="edge163" class="edge">
<title>layer8_input&#45;&gt;layer8_mha_query</title>
<path fill="none" stroke="black" d="M434.4,-13481.77C401.61,-13470.57 368.05,-13459.11 339.01,-13449.2"/>
<polygon fill="black" stroke="black" points="339.94,-13445.81 329.34,-13445.9 337.67,-13452.44 339.94,-13445.81"/>
</g>
<!-- layer8_mha_key -->
<g id="node130" class="node">
<title>layer8_mha_key</title>
<polygon fill="pink" stroke="black" points="718,-13445.85 422,-13445.85 422,-13393.85 718,-13393.85 718,-13445.85"/>
<text text-anchor="middle" x="570" y="-13433.85" font-family="Arial" font-size="10.00">Layer 8 MHA Key Linear</text>
<text text-anchor="middle" x="570" y="-13422.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="570" y="-13411.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="570" y="-13400.85" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- layer8_input&#45;&gt;layer8_mha_key -->
<g id="edge164" class="edge">
<title>layer8_input&#45;&gt;layer8_mha_key</title>
<path fill="none" stroke="black" d="M577.61,-13481.77C576.52,-13473.01 575.4,-13464.08 574.38,-13455.86"/>
<polygon fill="black" stroke="black" points="577.84,-13455.38 573.13,-13445.9 570.9,-13456.25 577.84,-13455.38"/>
</g>
<!-- layer8_mha_value -->
<g id="node131" class="node">
<title>layer8_mha_value</title>
<polygon fill="pink" stroke="black" points="747,-13357.85 451,-13357.85 451,-13305.85 747,-13305.85 747,-13357.85"/>
<text text-anchor="middle" x="599" y="-13345.85" font-family="Arial" font-size="10.00">Layer 8 MHA Value Linear</text>
<text text-anchor="middle" x="599" y="-13334.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="599" y="-13323.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_v=512]</text>
<text text-anchor="middle" x="599" y="-13312.85" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- layer8_input&#45;&gt;layer8_mha_value -->
<g id="edge165" class="edge">
<title>layer8_input&#45;&gt;layer8_mha_value</title>
<path fill="none" stroke="black" d="M695.89,-13481.66C708.3,-13471.53 719.24,-13459.66 727,-13445.85 738.32,-13425.71 739.34,-13413.4 727,-13393.85 719.05,-13381.25 707.7,-13371.2 695,-13363.19"/>
<polygon fill="black" stroke="black" points="696.43,-13359.98 686.03,-13357.97 692.91,-13366.03 696.43,-13359.98"/>
</g>
<!-- layer8_residual1 -->
<g id="node136" class="node">
<title>layer8_residual1</title>
<polygon fill="lightblue" stroke="black" points="580,-13005.85 56,-12953.85 580,-12901.85 1104,-12953.85 580,-13005.85"/>
<text text-anchor="middle" x="580" y="-12967.85" font-family="Arial" font-size="10.00">Layer 8 Residual Add 1</text>
<text text-anchor="middle" x="580" y="-12956.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="580" y="-12945.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="580" y="-12934.85" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- layer8_input&#45;&gt;layer8_residual1 -->
<g id="edge173" class="edge">
<title>layer8_input&#45;&gt;layer8_residual1</title>
<path fill="none" stroke="black" d="M697.61,-13481.78C712.05,-13471.53 725.44,-13459.59 736,-13445.85 767.66,-13404.65 766,-13384.81 766,-13332.85 766,-13332.85 766,-13332.85 766,-13154.85 766,-13102.01 762.2,-13082.96 729,-13041.85 716.66,-13026.57 700.87,-13013.41 684.2,-13002.29"/>
<polygon fill="black" stroke="black" points="685.72,-12999.11 675.41,-12996.66 681.94,-13005 685.72,-12999.11"/>
</g>
<!-- layer8_mha_qkt -->
<g id="node132" class="node">
<title>layer8_mha_qkt</title>
<polygon fill="lightcoral" stroke="black" points="432.5,-13357.85 107.5,-13357.85 107.5,-13305.85 432.5,-13305.85 432.5,-13357.85"/>
<text text-anchor="middle" x="270" y="-13345.85" font-family="Arial" font-size="10.00">Layer 8 MHA QKT Calculation</text>
<text text-anchor="middle" x="270" y="-13334.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="270" y="-13323.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="270" y="-13312.85" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- layer8_mha_query&#45;&gt;layer8_mha_qkt -->
<g id="edge166" class="edge">
<title>layer8_mha_query&#45;&gt;layer8_mha_qkt</title>
<path fill="none" stroke="black" d="M260.12,-13393.51C261.42,-13385.55 262.88,-13376.62 264.26,-13368.1"/>
<polygon fill="black" stroke="black" points="267.75,-13368.44 265.9,-13358.01 260.84,-13367.32 267.75,-13368.44"/>
</g>
<!-- layer8_mha_key&#45;&gt;layer8_mha_qkt -->
<g id="edge167" class="edge">
<title>layer8_mha_key&#45;&gt;layer8_mha_qkt</title>
<path fill="none" stroke="black" d="M482.42,-13393.75C446.3,-13383.39 404.31,-13371.35 367.24,-13360.73"/>
<polygon fill="black" stroke="black" points="368.01,-13357.31 357.43,-13357.91 366.08,-13364.03 368.01,-13357.31"/>
</g>
<!-- layer8_mha_apply -->
<g id="node134" class="node">
<title>layer8_mha_apply</title>
<polygon fill="lightcoral" stroke="black" points="747,-13181.85 179,-13181.85 179,-13129.85 747,-13129.85 747,-13181.85"/>
<text text-anchor="middle" x="463" y="-13169.85" font-family="Arial" font-size="10.00">Layer 8 MHA Apply Attention</text>
<text text-anchor="middle" x="463" y="-13158.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000], [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="463" y="-13147.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="463" y="-13136.85" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- layer8_mha_value&#45;&gt;layer8_mha_apply -->
<g id="edge170" class="edge">
<title>layer8_mha_value&#45;&gt;layer8_mha_apply</title>
<path fill="none" stroke="black" d="M579.22,-13305.55C555.39,-13275.05 515.26,-13223.71 488.95,-13190.05"/>
<polygon fill="black" stroke="black" points="491.49,-13187.62 482.58,-13181.9 485.98,-13191.94 491.49,-13187.62"/>
</g>
<!-- layer8_mha_softmax -->
<g id="node133" class="node">
<title>layer8_mha_softmax</title>
<polygon fill="lightcoral" stroke="black" points="472.5,-13269.85 147.5,-13269.85 147.5,-13217.85 472.5,-13217.85 472.5,-13269.85"/>
<text text-anchor="middle" x="310" y="-13257.85" font-family="Arial" font-size="10.00">Layer 8 MHA Softmax</text>
<text text-anchor="middle" x="310" y="-13246.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="310" y="-13235.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="310" y="-13224.85" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- layer8_mha_qkt&#45;&gt;layer8_mha_softmax -->
<g id="edge168" class="edge">
<title>layer8_mha_qkt&#45;&gt;layer8_mha_softmax</title>
<path fill="none" stroke="black" d="M281.78,-13305.51C285.61,-13297.29 289.92,-13288.02 294,-13279.26"/>
<polygon fill="black" stroke="black" points="297.26,-13280.55 298.3,-13270.01 290.91,-13277.6 297.26,-13280.55"/>
</g>
<!-- layer8_mha_softmax&#45;&gt;layer8_mha_apply -->
<g id="edge169" class="edge">
<title>layer8_mha_softmax&#45;&gt;layer8_mha_apply</title>
<path fill="none" stroke="black" d="M354.67,-13217.75C371.72,-13208.16 391.33,-13197.14 409.15,-13187.12"/>
<polygon fill="black" stroke="black" points="411.28,-13189.94 418.28,-13181.99 407.85,-13183.84 411.28,-13189.94"/>
</g>
<!-- layer8_mha_out -->
<g id="node135" class="node">
<title>layer8_mha_out</title>
<polygon fill="pink" stroke="black" points="719.5,-13093.85 430.5,-13093.85 430.5,-13041.85 719.5,-13041.85 719.5,-13093.85"/>
<text text-anchor="middle" x="575" y="-13081.85" font-family="Arial" font-size="10.00">Layer 8 MHA Output Linear</text>
<text text-anchor="middle" x="575" y="-13070.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="575" y="-13059.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="575" y="-13048.85" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- layer8_mha_apply&#45;&gt;layer8_mha_out -->
<g id="edge171" class="edge">
<title>layer8_mha_apply&#45;&gt;layer8_mha_out</title>
<path fill="none" stroke="black" d="M495.7,-13129.75C507.67,-13120.55 521.37,-13110.04 533.97,-13100.36"/>
<polygon fill="black" stroke="black" points="536.27,-13103 542.07,-13094.14 532.01,-13097.45 536.27,-13103"/>
</g>
<!-- layer8_mha_out&#45;&gt;layer8_residual1 -->
<g id="edge172" class="edge">
<title>layer8_mha_out&#45;&gt;layer8_residual1</title>
<path fill="none" stroke="black" d="M576.12,-13041.72C576.47,-13034.03 576.86,-13025.22 577.26,-13016.22"/>
<polygon fill="black" stroke="black" points="580.77,-13016.18 577.72,-13006.03 573.77,-13015.86 580.77,-13016.18"/>
</g>
<!-- layer8_layernorm1 -->
<g id="node137" class="node">
<title>layer8_layernorm1</title>
<polygon fill="lightgreen" stroke="black" points="724.5,-12865.85 435.5,-12865.85 435.5,-12813.85 724.5,-12813.85 724.5,-12865.85"/>
<text text-anchor="middle" x="580" y="-12853.85" font-family="Arial" font-size="10.00">Layer 8 Layer Norm 1</text>
<text text-anchor="middle" x="580" y="-12842.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="580" y="-12831.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="580" y="-12820.85" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- layer8_residual1&#45;&gt;layer8_layernorm1 -->
<g id="edge174" class="edge">
<title>layer8_residual1&#45;&gt;layer8_layernorm1</title>
<path fill="none" stroke="black" d="M580,-12901.77C580,-12893.1 580,-12884.28 580,-12876.14"/>
<polygon fill="black" stroke="black" points="583.5,-12875.9 580,-12865.9 576.5,-12875.9 583.5,-12875.9"/>
</g>
<!-- layer8_mlp_gate -->
<g id="node138" class="node">
<title>layer8_mlp_gate</title>
<polygon fill="lightyellow" stroke="black" points="489,-12777.85 197,-12777.85 197,-12725.85 489,-12725.85 489,-12777.85"/>
<text text-anchor="middle" x="343" y="-12765.85" font-family="Arial" font-size="10.00">Layer 8 MLP Gate Linear</text>
<text text-anchor="middle" x="343" y="-12754.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="343" y="-12743.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="343" y="-12732.85" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- layer8_layernorm1&#45;&gt;layer8_mlp_gate -->
<g id="edge175" class="edge">
<title>layer8_layernorm1&#45;&gt;layer8_mlp_gate</title>
<path fill="none" stroke="black" d="M510.81,-12813.75C482.95,-12803.63 450.66,-12791.92 421.88,-12781.48"/>
<polygon fill="black" stroke="black" points="422.87,-12778.11 412.27,-12777.99 420.48,-12784.69 422.87,-12778.11"/>
</g>
<!-- layer8_mlp_up -->
<g id="node139" class="node">
<title>layer8_mlp_up</title>
<polygon fill="lightyellow" stroke="black" points="726,-12689.85 434,-12689.85 434,-12637.85 726,-12637.85 726,-12689.85"/>
<text text-anchor="middle" x="580" y="-12677.85" font-family="Arial" font-size="10.00">Layer 8 MLP Up Linear</text>
<text text-anchor="middle" x="580" y="-12666.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="580" y="-12655.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="580" y="-12644.85" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- layer8_layernorm1&#45;&gt;layer8_mlp_up -->
<g id="edge176" class="edge">
<title>layer8_layernorm1&#45;&gt;layer8_mlp_up</title>
<path fill="none" stroke="black" d="M580,-12813.55C580,-12783.7 580,-12733.88 580,-12700.22"/>
<polygon fill="black" stroke="black" points="583.5,-12699.9 580,-12689.9 576.5,-12699.9 583.5,-12699.9"/>
</g>
<!-- layer8_residual2 -->
<g id="node143" class="node">
<title>layer8_residual2</title>
<polygon fill="lightblue" stroke="black" points="580,-12425.85 56,-12373.85 580,-12321.85 1104,-12373.85 580,-12425.85"/>
<text text-anchor="middle" x="580" y="-12387.85" font-family="Arial" font-size="10.00">Layer 8 Residual Add 2</text>
<text text-anchor="middle" x="580" y="-12376.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="580" y="-12365.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="580" y="-12354.85" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- layer8_layernorm1&#45;&gt;layer8_residual2 -->
<g id="edge182" class="edge">
<title>layer8_layernorm1&#45;&gt;layer8_residual2</title>
<path fill="none" stroke="black" d="M629.06,-12813.78C677.7,-12785.02 745,-12732.92 745,-12664.85 745,-12664.85 745,-12664.85 745,-12574.85 745,-12513.92 698.86,-12461.5 655.38,-12425.63"/>
<polygon fill="black" stroke="black" points="657.57,-12422.9 647.59,-12419.35 653.18,-12428.35 657.57,-12422.9"/>
</g>
<!-- layer8_mlp_gelu -->
<g id="node140" class="node">
<title>layer8_mlp_gelu</title>
<polygon fill="orange" stroke="black" points="416,-12689.85 124,-12689.85 124,-12637.85 416,-12637.85 416,-12689.85"/>
<text text-anchor="middle" x="270" y="-12677.85" font-family="Arial" font-size="10.00">Layer 8 MLP GELU</text>
<text text-anchor="middle" x="270" y="-12666.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="270" y="-12655.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="270" y="-12644.85" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- layer8_mlp_gate&#45;&gt;layer8_mlp_gelu -->
<g id="edge177" class="edge">
<title>layer8_mlp_gate&#45;&gt;layer8_mlp_gelu</title>
<path fill="none" stroke="black" d="M321.49,-12725.51C314.14,-12716.85 305.81,-12707.04 298.02,-12697.86"/>
<polygon fill="black" stroke="black" points="300.49,-12695.37 291.35,-12690.01 295.16,-12699.9 300.49,-12695.37"/>
</g>
<!-- layer8_mlp_multiply -->
<g id="node141" class="node">
<title>layer8_mlp_multiply</title>
<polygon fill="orange" stroke="black" points="726,-12601.85 196,-12601.85 196,-12549.85 726,-12549.85 726,-12601.85"/>
<text text-anchor="middle" x="461" y="-12589.85" font-family="Arial" font-size="10.00">Layer 8 MLP Element&#45;wise Multiply</text>
<text text-anchor="middle" x="461" y="-12578.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768], [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="461" y="-12567.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="461" y="-12556.85" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- layer8_mlp_up&#45;&gt;layer8_mlp_multiply -->
<g id="edge178" class="edge">
<title>layer8_mlp_up&#45;&gt;layer8_mlp_multiply</title>
<path fill="none" stroke="black" d="M545.26,-12637.75C532.42,-12628.47 517.71,-12617.84 504.21,-12608.08"/>
<polygon fill="black" stroke="black" points="506.14,-12605.16 495.99,-12602.14 502.04,-12610.83 506.14,-12605.16"/>
</g>
<!-- layer8_mlp_gelu&#45;&gt;layer8_mlp_multiply -->
<g id="edge179" class="edge">
<title>layer8_mlp_gelu&#45;&gt;layer8_mlp_multiply</title>
<path fill="none" stroke="black" d="M325.76,-12637.75C347.73,-12627.85 373.11,-12616.43 395.91,-12606.16"/>
<polygon fill="black" stroke="black" points="397.49,-12609.29 405.17,-12601.99 394.62,-12602.9 397.49,-12609.29"/>
</g>
<!-- layer8_mlp_down -->
<g id="node142" class="node">
<title>layer8_mlp_down</title>
<polygon fill="lightyellow" stroke="black" points="664.5,-12513.85 375.5,-12513.85 375.5,-12461.85 664.5,-12461.85 664.5,-12513.85"/>
<text text-anchor="middle" x="520" y="-12501.85" font-family="Arial" font-size="10.00">Layer 8 MLP Down Linear</text>
<text text-anchor="middle" x="520" y="-12490.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="520" y="-12479.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="520" y="-12468.85" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- layer8_mlp_multiply&#45;&gt;layer8_mlp_down -->
<g id="edge180" class="edge">
<title>layer8_mlp_multiply&#45;&gt;layer8_mlp_down</title>
<path fill="none" stroke="black" d="M478.38,-12549.51C484.2,-12541.03 490.79,-12531.43 496.97,-12522.42"/>
<polygon fill="black" stroke="black" points="499.97,-12524.23 502.74,-12514.01 494.2,-12520.27 499.97,-12524.23"/>
</g>
<!-- layer8_mlp_down&#45;&gt;layer8_residual2 -->
<g id="edge181" class="edge">
<title>layer8_mlp_down&#45;&gt;layer8_residual2</title>
<path fill="none" stroke="black" d="M533.47,-12461.72C538.17,-12452.94 543.66,-12442.69 549.19,-12432.37"/>
<polygon fill="black" stroke="black" points="552.4,-12433.78 554.04,-12423.32 546.23,-12430.48 552.4,-12433.78"/>
</g>
<!-- layer8_layernorm2 -->
<g id="node144" class="node">
<title>layer8_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="724.5,-12285.85 435.5,-12285.85 435.5,-12233.85 724.5,-12233.85 724.5,-12285.85"/>
<text text-anchor="middle" x="580" y="-12273.85" font-family="Arial" font-size="10.00">Layer 8 Layer Norm 2</text>
<text text-anchor="middle" x="580" y="-12262.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="580" y="-12251.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="580" y="-12240.85" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- layer8_residual2&#45;&gt;layer8_layernorm2 -->
<g id="edge183" class="edge">
<title>layer8_residual2&#45;&gt;layer8_layernorm2</title>
<path fill="none" stroke="black" d="M580,-12321.77C580,-12313.1 580,-12304.28 580,-12296.14"/>
<polygon fill="black" stroke="black" points="583.5,-12295.9 580,-12285.9 576.5,-12295.9 583.5,-12295.9"/>
</g>
<!-- layer8_layernorm2&#45;&gt;layer8_transfer -->
<g id="edge184" class="edge">
<title>layer8_layernorm2&#45;&gt;layer8_transfer</title>
<path fill="none" stroke="black" d="M580,-12233.68C580,-12225.87 580,-12217.01 580,-12208.24"/>
<polygon fill="black" stroke="black" points="583.5,-12208.06 580,-12198.06 576.5,-12208.06 583.5,-12208.06"/>
</g>
<!-- layer9_transfer -->
<g id="node145" class="node">
<title>layer9_transfer</title>
<ellipse fill="gray" stroke="black" cx="568" cy="-10645.54" rx="209.11" ry="36.54"/>
<text text-anchor="middle" x="568" y="-10659.54" font-family="Arial" font-size="10.00">Layer 9 â†’ 10 Transfer</text>
<text text-anchor="middle" x="568" y="-10648.54" font-family="Arial" font-size="10.00">Transfer: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-10637.54" font-family="Arial" font-size="10.00">From: GPU 8</text>
<text text-anchor="middle" x="568" y="-10626.54" font-family="Arial" font-size="10.00">To: GPU 9</text>
</g>
<!-- layer10_input -->
<g id="node164" class="node">
<title>layer10_input</title>
<polygon fill="lightyellow" stroke="black" points="867.74,-10554.77 390.92,-10554.77 268.26,-10450.77 745.08,-10450.77 867.74,-10554.77"/>
<text text-anchor="middle" x="568" y="-10516.77" font-family="Arial" font-size="10.00">Layer 10 Input</text>
<text text-anchor="middle" x="568" y="-10505.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-10494.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-10483.77" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- layer9_transfer&#45;&gt;layer10_input -->
<g id="edge208" class="edge">
<title>layer9_transfer&#45;&gt;layer10_input</title>
<path fill="none" stroke="black" d="M568,-10608.66C568,-10595.42 568,-10580.02 568,-10565.16"/>
<polygon fill="black" stroke="black" points="571.5,-10565 568,-10555 564.5,-10565 571.5,-10565"/>
</g>
<!-- layer9_mha_query -->
<g id="node147" class="node">
<title>layer9_mha_query</title>
<polygon fill="pink" stroke="black" points="344,-11930.31 48,-11930.31 48,-11878.31 344,-11878.31 344,-11930.31"/>
<text text-anchor="middle" x="196" y="-11918.31" font-family="Arial" font-size="10.00">Layer 9 MHA Query Linear</text>
<text text-anchor="middle" x="196" y="-11907.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="196" y="-11896.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_q=512]</text>
<text text-anchor="middle" x="196" y="-11885.31" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- layer9_input&#45;&gt;layer9_mha_query -->
<g id="edge186" class="edge">
<title>layer9_input&#45;&gt;layer9_mha_query</title>
<path fill="none" stroke="black" d="M405.14,-11966.31C366.13,-11954.93 326.17,-11943.28 291.77,-11933.24"/>
<polygon fill="black" stroke="black" points="292.33,-11929.76 281.75,-11930.32 290.37,-11936.48 292.33,-11929.76"/>
</g>
<!-- layer9_mha_key -->
<g id="node148" class="node">
<title>layer9_mha_key</title>
<polygon fill="pink" stroke="black" points="658,-11930.31 362,-11930.31 362,-11878.31 658,-11878.31 658,-11930.31"/>
<text text-anchor="middle" x="510" y="-11918.31" font-family="Arial" font-size="10.00">Layer 9 MHA Key Linear</text>
<text text-anchor="middle" x="510" y="-11907.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="510" y="-11896.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="510" y="-11885.31" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- layer9_input&#45;&gt;layer9_mha_key -->
<g id="edge187" class="edge">
<title>layer9_input&#45;&gt;layer9_mha_key</title>
<path fill="none" stroke="black" d="M548.07,-11966.23C542.29,-11956.98 536.4,-11947.55 531.03,-11938.96"/>
<polygon fill="black" stroke="black" points="533.92,-11936.98 525.65,-11930.36 527.98,-11940.69 533.92,-11936.98"/>
</g>
<!-- layer9_mha_value -->
<g id="node149" class="node">
<title>layer9_mha_value</title>
<polygon fill="pink" stroke="black" points="754,-11842.31 458,-11842.31 458,-11790.31 754,-11790.31 754,-11842.31"/>
<text text-anchor="middle" x="606" y="-11830.31" font-family="Arial" font-size="10.00">Layer 9 MHA Value Linear</text>
<text text-anchor="middle" x="606" y="-11819.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="606" y="-11808.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_v=512]</text>
<text text-anchor="middle" x="606" y="-11797.31" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- layer9_input&#45;&gt;layer9_mha_value -->
<g id="edge188" class="edge">
<title>layer9_input&#45;&gt;layer9_mha_value</title>
<path fill="none" stroke="black" d="M643.72,-11966.2C653.21,-11955.43 661.6,-11943.34 667,-11930.31 675.84,-11908.96 675.84,-11899.66 667,-11878.31 662.61,-11867.72 655.39,-11858 647.43,-11849.59"/>
<polygon fill="black" stroke="black" points="649.86,-11847.08 640.29,-11842.54 644.94,-11852.06 649.86,-11847.08"/>
</g>
<!-- layer9_residual1 -->
<g id="node154" class="node">
<title>layer9_residual1</title>
<polygon fill="lightblue" stroke="black" points="568,-11490.31 44,-11438.31 568,-11386.31 1092,-11438.31 568,-11490.31"/>
<text text-anchor="middle" x="568" y="-11452.31" font-family="Arial" font-size="10.00">Layer 9 Residual Add 1</text>
<text text-anchor="middle" x="568" y="-11441.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-11430.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-11419.31" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- layer9_input&#45;&gt;layer9_residual1 -->
<g id="edge196" class="edge">
<title>layer9_input&#45;&gt;layer9_residual1</title>
<path fill="none" stroke="black" d="M672.83,-11966.24C722.27,-11931.61 773,-11880.64 773,-11817.31 773,-11817.31 773,-11817.31 773,-11639.31 773,-11572.76 716.97,-11521.13 663.49,-11487.01"/>
<polygon fill="black" stroke="black" points="665.28,-11484 654.94,-11481.69 661.58,-11489.95 665.28,-11484"/>
</g>
<!-- layer9_mha_qkt -->
<g id="node150" class="node">
<title>layer9_mha_qkt</title>
<polygon fill="lightcoral" stroke="black" points="439.5,-11842.31 114.5,-11842.31 114.5,-11790.31 439.5,-11790.31 439.5,-11842.31"/>
<text text-anchor="middle" x="277" y="-11830.31" font-family="Arial" font-size="10.00">Layer 9 MHA QKT Calculation</text>
<text text-anchor="middle" x="277" y="-11819.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="277" y="-11808.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="277" y="-11797.31" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- layer9_mha_query&#45;&gt;layer9_mha_qkt -->
<g id="edge189" class="edge">
<title>layer9_mha_query&#45;&gt;layer9_mha_qkt</title>
<path fill="none" stroke="black" d="M219.86,-11877.98C228.19,-11869.14 237.64,-11859.1 246.43,-11849.77"/>
<polygon fill="black" stroke="black" points="249,-11852.15 253.31,-11842.47 243.9,-11847.35 249,-11852.15"/>
</g>
<!-- layer9_mha_key&#45;&gt;layer9_mha_qkt -->
<g id="edge190" class="edge">
<title>layer9_mha_key&#45;&gt;layer9_mha_qkt</title>
<path fill="none" stroke="black" d="M441.98,-11878.21C414.59,-11868.1 382.84,-11856.38 354.55,-11845.94"/>
<polygon fill="black" stroke="black" points="355.7,-11842.63 345.1,-11842.45 353.27,-11849.2 355.7,-11842.63"/>
</g>
<!-- layer9_mha_apply -->
<g id="node152" class="node">
<title>layer9_mha_apply</title>
<polygon fill="lightcoral" stroke="black" points="754,-11666.31 186,-11666.31 186,-11614.31 754,-11614.31 754,-11666.31"/>
<text text-anchor="middle" x="470" y="-11654.31" font-family="Arial" font-size="10.00">Layer 9 MHA Apply Attention</text>
<text text-anchor="middle" x="470" y="-11643.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000], [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="470" y="-11632.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="470" y="-11621.31" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- layer9_mha_value&#45;&gt;layer9_mha_apply -->
<g id="edge193" class="edge">
<title>layer9_mha_value&#45;&gt;layer9_mha_apply</title>
<path fill="none" stroke="black" d="M586.22,-11790.01C562.39,-11759.51 522.26,-11708.17 495.95,-11674.51"/>
<polygon fill="black" stroke="black" points="498.49,-11672.09 489.58,-11666.36 492.98,-11676.4 498.49,-11672.09"/>
</g>
<!-- layer9_mha_softmax -->
<g id="node151" class="node">
<title>layer9_mha_softmax</title>
<polygon fill="lightcoral" stroke="black" points="476.5,-11754.31 151.5,-11754.31 151.5,-11702.31 476.5,-11702.31 476.5,-11754.31"/>
<text text-anchor="middle" x="314" y="-11742.31" font-family="Arial" font-size="10.00">Layer 9 MHA Softmax</text>
<text text-anchor="middle" x="314" y="-11731.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="314" y="-11720.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="314" y="-11709.31" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- layer9_mha_qkt&#45;&gt;layer9_mha_softmax -->
<g id="edge191" class="edge">
<title>layer9_mha_qkt&#45;&gt;layer9_mha_softmax</title>
<path fill="none" stroke="black" d="M287.9,-11789.98C291.44,-11781.75 295.43,-11772.49 299.2,-11763.72"/>
<polygon fill="black" stroke="black" points="302.44,-11765.04 303.18,-11754.47 296.01,-11762.27 302.44,-11765.04"/>
</g>
<!-- layer9_mha_softmax&#45;&gt;layer9_mha_apply -->
<g id="edge192" class="edge">
<title>layer9_mha_softmax&#45;&gt;layer9_mha_apply</title>
<path fill="none" stroke="black" d="M359.54,-11702.21C377.08,-11692.54 397.3,-11681.39 415.59,-11671.31"/>
<polygon fill="black" stroke="black" points="417.33,-11674.34 424.4,-11666.45 413.96,-11668.21 417.33,-11674.34"/>
</g>
<!-- layer9_mha_out -->
<g id="node153" class="node">
<title>layer9_mha_out</title>
<polygon fill="pink" stroke="black" points="663.5,-11578.31 374.5,-11578.31 374.5,-11526.31 663.5,-11526.31 663.5,-11578.31"/>
<text text-anchor="middle" x="519" y="-11566.31" font-family="Arial" font-size="10.00">Layer 9 MHA Output Linear</text>
<text text-anchor="middle" x="519" y="-11555.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="519" y="-11544.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="519" y="-11533.31" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- layer9_mha_apply&#45;&gt;layer9_mha_out -->
<g id="edge194" class="edge">
<title>layer9_mha_apply&#45;&gt;layer9_mha_out</title>
<path fill="none" stroke="black" d="M484.44,-11613.98C489.17,-11605.66 494.51,-11596.29 499.56,-11587.44"/>
<polygon fill="black" stroke="black" points="502.76,-11588.89 504.67,-11578.47 496.68,-11585.43 502.76,-11588.89"/>
</g>
<!-- layer9_mha_out&#45;&gt;layer9_residual1 -->
<g id="edge195" class="edge">
<title>layer9_mha_out&#45;&gt;layer9_residual1</title>
<path fill="none" stroke="black" d="M530,-11526.18C533.76,-11517.59 538.13,-11507.58 542.55,-11497.49"/>
<polygon fill="black" stroke="black" points="545.8,-11498.79 546.6,-11488.23 539.38,-11495.99 545.8,-11498.79"/>
</g>
<!-- layer9_layernorm1 -->
<g id="node155" class="node">
<title>layer9_layernorm1</title>
<polygon fill="lightgreen" stroke="black" points="712.5,-11350.31 423.5,-11350.31 423.5,-11298.31 712.5,-11298.31 712.5,-11350.31"/>
<text text-anchor="middle" x="568" y="-11338.31" font-family="Arial" font-size="10.00">Layer 9 Layer Norm 1</text>
<text text-anchor="middle" x="568" y="-11327.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-11316.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-11305.31" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- layer9_residual1&#45;&gt;layer9_layernorm1 -->
<g id="edge197" class="edge">
<title>layer9_residual1&#45;&gt;layer9_layernorm1</title>
<path fill="none" stroke="black" d="M568,-11386.23C568,-11377.56 568,-11368.74 568,-11360.6"/>
<polygon fill="black" stroke="black" points="571.5,-11360.36 568,-11350.36 564.5,-11360.36 571.5,-11360.36"/>
</g>
<!-- layer9_mlp_gate -->
<g id="node156" class="node">
<title>layer9_mlp_gate</title>
<polygon fill="lightyellow" stroke="black" points="477,-11262.31 185,-11262.31 185,-11210.31 477,-11210.31 477,-11262.31"/>
<text text-anchor="middle" x="331" y="-11250.31" font-family="Arial" font-size="10.00">Layer 9 MLP Gate Linear</text>
<text text-anchor="middle" x="331" y="-11239.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="331" y="-11228.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="331" y="-11217.31" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- layer9_layernorm1&#45;&gt;layer9_mlp_gate -->
<g id="edge198" class="edge">
<title>layer9_layernorm1&#45;&gt;layer9_mlp_gate</title>
<path fill="none" stroke="black" d="M498.81,-11298.21C470.95,-11288.1 438.66,-11276.38 409.88,-11265.94"/>
<polygon fill="black" stroke="black" points="410.87,-11262.57 400.27,-11262.45 408.48,-11269.15 410.87,-11262.57"/>
</g>
<!-- layer9_mlp_up -->
<g id="node157" class="node">
<title>layer9_mlp_up</title>
<polygon fill="lightyellow" stroke="black" points="714,-11174.31 422,-11174.31 422,-11122.31 714,-11122.31 714,-11174.31"/>
<text text-anchor="middle" x="568" y="-11162.31" font-family="Arial" font-size="10.00">Layer 9 MLP Up Linear</text>
<text text-anchor="middle" x="568" y="-11151.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-11140.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="568" y="-11129.31" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- layer9_layernorm1&#45;&gt;layer9_mlp_up -->
<g id="edge199" class="edge">
<title>layer9_layernorm1&#45;&gt;layer9_mlp_up</title>
<path fill="none" stroke="black" d="M568,-11298.01C568,-11268.16 568,-11218.34 568,-11184.68"/>
<polygon fill="black" stroke="black" points="571.5,-11184.36 568,-11174.36 564.5,-11184.36 571.5,-11184.36"/>
</g>
<!-- layer9_residual2 -->
<g id="node161" class="node">
<title>layer9_residual2</title>
<polygon fill="lightblue" stroke="black" points="568,-10910.31 44,-10858.31 568,-10806.31 1092,-10858.31 568,-10910.31"/>
<text text-anchor="middle" x="568" y="-10872.31" font-family="Arial" font-size="10.00">Layer 9 Residual Add 2</text>
<text text-anchor="middle" x="568" y="-10861.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-10850.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-10839.31" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- layer9_layernorm1&#45;&gt;layer9_residual2 -->
<g id="edge205" class="edge">
<title>layer9_layernorm1&#45;&gt;layer9_residual2</title>
<path fill="none" stroke="black" d="M617.06,-11298.24C665.7,-11269.48 733,-11217.38 733,-11149.31 733,-11149.31 733,-11149.31 733,-11059.31 733,-10998.38 686.86,-10945.96 643.38,-10910.09"/>
<polygon fill="black" stroke="black" points="645.57,-10907.36 635.59,-10903.81 641.18,-10912.81 645.57,-10907.36"/>
</g>
<!-- layer9_mlp_gelu -->
<g id="node158" class="node">
<title>layer9_mlp_gelu</title>
<polygon fill="orange" stroke="black" points="404,-11174.31 112,-11174.31 112,-11122.31 404,-11122.31 404,-11174.31"/>
<text text-anchor="middle" x="258" y="-11162.31" font-family="Arial" font-size="10.00">Layer 9 MLP GELU</text>
<text text-anchor="middle" x="258" y="-11151.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="258" y="-11140.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="258" y="-11129.31" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- layer9_mlp_gate&#45;&gt;layer9_mlp_gelu -->
<g id="edge200" class="edge">
<title>layer9_mlp_gate&#45;&gt;layer9_mlp_gelu</title>
<path fill="none" stroke="black" d="M309.49,-11209.98C302.14,-11201.31 293.81,-11191.5 286.02,-11182.32"/>
<polygon fill="black" stroke="black" points="288.49,-11179.83 279.35,-11174.47 283.16,-11184.36 288.49,-11179.83"/>
</g>
<!-- layer9_mlp_multiply -->
<g id="node159" class="node">
<title>layer9_mlp_multiply</title>
<polygon fill="orange" stroke="black" points="714,-11086.31 184,-11086.31 184,-11034.31 714,-11034.31 714,-11086.31"/>
<text text-anchor="middle" x="449" y="-11074.31" font-family="Arial" font-size="10.00">Layer 9 MLP Element&#45;wise Multiply</text>
<text text-anchor="middle" x="449" y="-11063.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768], [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="449" y="-11052.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="449" y="-11041.31" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- layer9_mlp_up&#45;&gt;layer9_mlp_multiply -->
<g id="edge201" class="edge">
<title>layer9_mlp_up&#45;&gt;layer9_mlp_multiply</title>
<path fill="none" stroke="black" d="M533.26,-11122.21C520.42,-11112.93 505.71,-11102.3 492.21,-11092.54"/>
<polygon fill="black" stroke="black" points="494.14,-11089.62 483.99,-11086.6 490.04,-11095.29 494.14,-11089.62"/>
</g>
<!-- layer9_mlp_gelu&#45;&gt;layer9_mlp_multiply -->
<g id="edge202" class="edge">
<title>layer9_mlp_gelu&#45;&gt;layer9_mlp_multiply</title>
<path fill="none" stroke="black" d="M313.76,-11122.21C335.73,-11112.32 361.11,-11100.89 383.91,-11090.62"/>
<polygon fill="black" stroke="black" points="385.49,-11093.75 393.17,-11086.45 382.62,-11087.36 385.49,-11093.75"/>
</g>
<!-- layer9_mlp_down -->
<g id="node160" class="node">
<title>layer9_mlp_down</title>
<polygon fill="lightyellow" stroke="black" points="653.5,-10998.31 364.5,-10998.31 364.5,-10946.31 653.5,-10946.31 653.5,-10998.31"/>
<text text-anchor="middle" x="509" y="-10986.31" font-family="Arial" font-size="10.00">Layer 9 MLP Down Linear</text>
<text text-anchor="middle" x="509" y="-10975.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="509" y="-10964.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="509" y="-10953.31" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- layer9_mlp_multiply&#45;&gt;layer9_mlp_down -->
<g id="edge203" class="edge">
<title>layer9_mlp_multiply&#45;&gt;layer9_mlp_down</title>
<path fill="none" stroke="black" d="M466.68,-11033.98C472.6,-11025.49 479.29,-11015.89 485.58,-11006.88"/>
<polygon fill="black" stroke="black" points="488.6,-11008.67 491.45,-10998.47 482.86,-11004.67 488.6,-11008.67"/>
</g>
<!-- layer9_mlp_down&#45;&gt;layer9_residual2 -->
<g id="edge204" class="edge">
<title>layer9_mlp_down&#45;&gt;layer9_residual2</title>
<path fill="none" stroke="black" d="M522.24,-10946.18C526.81,-10937.5 532.14,-10927.38 537.52,-10917.18"/>
<polygon fill="black" stroke="black" points="540.67,-10918.71 542.23,-10908.23 534.47,-10915.44 540.67,-10918.71"/>
</g>
<!-- layer9_layernorm2 -->
<g id="node162" class="node">
<title>layer9_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="712.5,-10770.31 423.5,-10770.31 423.5,-10718.31 712.5,-10718.31 712.5,-10770.31"/>
<text text-anchor="middle" x="568" y="-10758.31" font-family="Arial" font-size="10.00">Layer 9 Layer Norm 2</text>
<text text-anchor="middle" x="568" y="-10747.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-10736.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-10725.31" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- layer9_residual2&#45;&gt;layer9_layernorm2 -->
<g id="edge206" class="edge">
<title>layer9_residual2&#45;&gt;layer9_layernorm2</title>
<path fill="none" stroke="black" d="M568,-10806.23C568,-10797.56 568,-10788.74 568,-10780.6"/>
<polygon fill="black" stroke="black" points="571.5,-10780.36 568,-10770.36 564.5,-10780.36 571.5,-10780.36"/>
</g>
<!-- layer9_layernorm2&#45;&gt;layer9_transfer -->
<g id="edge207" class="edge">
<title>layer9_layernorm2&#45;&gt;layer9_transfer</title>
<path fill="none" stroke="black" d="M568,-10718.14C568,-10710.33 568,-10701.47 568,-10692.7"/>
<polygon fill="black" stroke="black" points="571.5,-10692.52 568,-10682.52 564.5,-10692.52 571.5,-10692.52"/>
</g>
<!-- layer10_transfer -->
<g id="node163" class="node">
<title>layer10_transfer</title>
<ellipse fill="gray" stroke="black" cx="568" cy="-9130" rx="209.11" ry="36.54"/>
<text text-anchor="middle" x="568" y="-9144" font-family="Arial" font-size="10.00">Layer 10 â†’ 11 Transfer</text>
<text text-anchor="middle" x="568" y="-9133" font-family="Arial" font-size="10.00">Transfer: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-9122" font-family="Arial" font-size="10.00">From: GPU 9</text>
<text text-anchor="middle" x="568" y="-9111" font-family="Arial" font-size="10.00">To: GPU 10</text>
</g>
<!-- layer11_input -->
<g id="node182" class="node">
<title>layer11_input</title>
<polygon fill="lightyellow" stroke="black" points="867.74,-9039.23 390.92,-9039.23 268.26,-8935.23 745.08,-8935.23 867.74,-9039.23"/>
<text text-anchor="middle" x="568" y="-9001.23" font-family="Arial" font-size="10.00">Layer 11 Input</text>
<text text-anchor="middle" x="568" y="-8990.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-8979.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-8968.23" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- layer10_transfer&#45;&gt;layer11_input -->
<g id="edge231" class="edge">
<title>layer10_transfer&#45;&gt;layer11_input</title>
<path fill="none" stroke="black" d="M568,-9093.12C568,-9079.88 568,-9064.48 568,-9049.63"/>
<polygon fill="black" stroke="black" points="571.5,-9049.46 568,-9039.46 564.5,-9049.46 571.5,-9049.46"/>
</g>
<!-- layer10_mha_query -->
<g id="node165" class="node">
<title>layer10_mha_query</title>
<polygon fill="pink" stroke="black" points="344,-10414.77 48,-10414.77 48,-10362.77 344,-10362.77 344,-10414.77"/>
<text text-anchor="middle" x="196" y="-10402.77" font-family="Arial" font-size="10.00">Layer 10 MHA Query Linear</text>
<text text-anchor="middle" x="196" y="-10391.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="196" y="-10380.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_q=512]</text>
<text text-anchor="middle" x="196" y="-10369.77" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- layer10_input&#45;&gt;layer10_mha_query -->
<g id="edge209" class="edge">
<title>layer10_input&#45;&gt;layer10_mha_query</title>
<path fill="none" stroke="black" d="M398.6,-10450.77C360.9,-10439.42 322.28,-10427.79 289.01,-10417.78"/>
<polygon fill="black" stroke="black" points="289.9,-10414.39 279.31,-10414.86 287.88,-10421.09 289.9,-10414.39"/>
</g>
<!-- layer10_mha_key -->
<g id="node166" class="node">
<title>layer10_mha_key</title>
<polygon fill="pink" stroke="black" points="658,-10414.77 362,-10414.77 362,-10362.77 658,-10362.77 658,-10414.77"/>
<text text-anchor="middle" x="510" y="-10402.77" font-family="Arial" font-size="10.00">Layer 10 MHA Key Linear</text>
<text text-anchor="middle" x="510" y="-10391.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="510" y="-10380.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="510" y="-10369.77" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- layer10_input&#45;&gt;layer10_mha_key -->
<g id="edge210" class="edge">
<title>layer10_input&#45;&gt;layer10_mha_key</title>
<path fill="none" stroke="black" d="M541.55,-10450.69C536.86,-10441.64 532.08,-10432.41 527.71,-10423.97"/>
<polygon fill="black" stroke="black" points="530.68,-10422.09 522.97,-10414.82 524.46,-10425.31 530.68,-10422.09"/>
</g>
<!-- layer10_mha_value -->
<g id="node167" class="node">
<title>layer10_mha_value</title>
<polygon fill="pink" stroke="black" points="754,-10326.77 458,-10326.77 458,-10274.77 754,-10274.77 754,-10326.77"/>
<text text-anchor="middle" x="606" y="-10314.77" font-family="Arial" font-size="10.00">Layer 10 MHA Value Linear</text>
<text text-anchor="middle" x="606" y="-10303.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="606" y="-10292.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_v=512]</text>
<text text-anchor="middle" x="606" y="-10281.77" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- layer10_input&#45;&gt;layer10_mha_value -->
<g id="edge211" class="edge">
<title>layer10_input&#45;&gt;layer10_mha_value</title>
<path fill="none" stroke="black" d="M641.59,-10450.63C651.9,-10440.03 661.01,-10428.01 667,-10414.77 676.53,-10393.72 675.84,-10384.13 667,-10362.77 662.61,-10352.18 655.39,-10342.46 647.43,-10334.05"/>
<polygon fill="black" stroke="black" points="649.86,-10331.54 640.29,-10327.01 644.94,-10336.52 649.86,-10331.54"/>
</g>
<!-- layer10_residual1 -->
<g id="node172" class="node">
<title>layer10_residual1</title>
<polygon fill="lightblue" stroke="black" points="568,-9974.77 44,-9922.77 568,-9870.77 1092,-9922.77 568,-9974.77"/>
<text text-anchor="middle" x="568" y="-9936.77" font-family="Arial" font-size="10.00">Layer 10 Residual Add 1</text>
<text text-anchor="middle" x="568" y="-9925.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-9914.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-9903.77" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- layer10_input&#45;&gt;layer10_residual1 -->
<g id="edge219" class="edge">
<title>layer10_input&#45;&gt;layer10_residual1</title>
<path fill="none" stroke="black" d="M668.7,-10450.7C720.54,-10416.59 773,-10366.16 773,-10301.77 773,-10301.77 773,-10301.77 773,-10123.77 773,-10057.23 716.97,-10005.6 663.49,-9971.47"/>
<polygon fill="black" stroke="black" points="665.28,-9968.46 654.94,-9966.15 661.58,-9974.41 665.28,-9968.46"/>
</g>
<!-- layer10_mha_qkt -->
<g id="node168" class="node">
<title>layer10_mha_qkt</title>
<polygon fill="lightcoral" stroke="black" points="439.5,-10326.77 114.5,-10326.77 114.5,-10274.77 439.5,-10274.77 439.5,-10326.77"/>
<text text-anchor="middle" x="277" y="-10314.77" font-family="Arial" font-size="10.00">Layer 10 MHA QKT Calculation</text>
<text text-anchor="middle" x="277" y="-10303.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="277" y="-10292.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="277" y="-10281.77" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- layer10_mha_query&#45;&gt;layer10_mha_qkt -->
<g id="edge212" class="edge">
<title>layer10_mha_query&#45;&gt;layer10_mha_qkt</title>
<path fill="none" stroke="black" d="M219.86,-10362.44C228.19,-10353.6 237.64,-10343.56 246.43,-10334.23"/>
<polygon fill="black" stroke="black" points="249,-10336.61 253.31,-10326.93 243.9,-10331.81 249,-10336.61"/>
</g>
<!-- layer10_mha_key&#45;&gt;layer10_mha_qkt -->
<g id="edge213" class="edge">
<title>layer10_mha_key&#45;&gt;layer10_mha_qkt</title>
<path fill="none" stroke="black" d="M441.98,-10362.67C414.59,-10352.56 382.84,-10340.84 354.55,-10330.4"/>
<polygon fill="black" stroke="black" points="355.7,-10327.09 345.1,-10326.91 353.27,-10333.66 355.7,-10327.09"/>
</g>
<!-- layer10_mha_apply -->
<g id="node170" class="node">
<title>layer10_mha_apply</title>
<polygon fill="lightcoral" stroke="black" points="754,-10150.77 186,-10150.77 186,-10098.77 754,-10098.77 754,-10150.77"/>
<text text-anchor="middle" x="470" y="-10138.77" font-family="Arial" font-size="10.00">Layer 10 MHA Apply Attention</text>
<text text-anchor="middle" x="470" y="-10127.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000], [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="470" y="-10116.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="470" y="-10105.77" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- layer10_mha_value&#45;&gt;layer10_mha_apply -->
<g id="edge216" class="edge">
<title>layer10_mha_value&#45;&gt;layer10_mha_apply</title>
<path fill="none" stroke="black" d="M586.22,-10274.47C562.39,-10243.97 522.26,-10192.63 495.95,-10158.98"/>
<polygon fill="black" stroke="black" points="498.49,-10156.55 489.58,-10150.82 492.98,-10160.86 498.49,-10156.55"/>
</g>
<!-- layer10_mha_softmax -->
<g id="node169" class="node">
<title>layer10_mha_softmax</title>
<polygon fill="lightcoral" stroke="black" points="479.5,-10238.77 154.5,-10238.77 154.5,-10186.77 479.5,-10186.77 479.5,-10238.77"/>
<text text-anchor="middle" x="317" y="-10226.77" font-family="Arial" font-size="10.00">Layer 10 MHA Softmax</text>
<text text-anchor="middle" x="317" y="-10215.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="317" y="-10204.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="317" y="-10193.77" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- layer10_mha_qkt&#45;&gt;layer10_mha_softmax -->
<g id="edge214" class="edge">
<title>layer10_mha_qkt&#45;&gt;layer10_mha_softmax</title>
<path fill="none" stroke="black" d="M288.78,-10274.44C292.61,-10266.21 296.92,-10256.95 301,-10248.18"/>
<polygon fill="black" stroke="black" points="304.26,-10249.47 305.3,-10238.93 297.91,-10246.52 304.26,-10249.47"/>
</g>
<!-- layer10_mha_softmax&#45;&gt;layer10_mha_apply -->
<g id="edge215" class="edge">
<title>layer10_mha_softmax&#45;&gt;layer10_mha_apply</title>
<path fill="none" stroke="black" d="M361.67,-10186.67C378.72,-10177.08 398.33,-10166.06 416.15,-10156.04"/>
<polygon fill="black" stroke="black" points="418.28,-10158.86 425.28,-10150.91 414.85,-10152.76 418.28,-10158.86"/>
</g>
<!-- layer10_mha_out -->
<g id="node171" class="node">
<title>layer10_mha_out</title>
<polygon fill="pink" stroke="black" points="663.5,-10062.77 374.5,-10062.77 374.5,-10010.77 663.5,-10010.77 663.5,-10062.77"/>
<text text-anchor="middle" x="519" y="-10050.77" font-family="Arial" font-size="10.00">Layer 10 MHA Output Linear</text>
<text text-anchor="middle" x="519" y="-10039.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="519" y="-10028.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="519" y="-10017.77" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- layer10_mha_apply&#45;&gt;layer10_mha_out -->
<g id="edge217" class="edge">
<title>layer10_mha_apply&#45;&gt;layer10_mha_out</title>
<path fill="none" stroke="black" d="M484.44,-10098.44C489.17,-10090.13 494.51,-10080.75 499.56,-10071.9"/>
<polygon fill="black" stroke="black" points="502.76,-10073.35 504.67,-10062.93 496.68,-10069.89 502.76,-10073.35"/>
</g>
<!-- layer10_mha_out&#45;&gt;layer10_residual1 -->
<g id="edge218" class="edge">
<title>layer10_mha_out&#45;&gt;layer10_residual1</title>
<path fill="none" stroke="black" d="M530,-10010.64C533.76,-10002.05 538.13,-9992.05 542.55,-9981.95"/>
<polygon fill="black" stroke="black" points="545.8,-9983.25 546.6,-9972.69 539.38,-9980.45 545.8,-9983.25"/>
</g>
<!-- layer10_layernorm1 -->
<g id="node173" class="node">
<title>layer10_layernorm1</title>
<polygon fill="lightgreen" stroke="black" points="712.5,-9834.77 423.5,-9834.77 423.5,-9782.77 712.5,-9782.77 712.5,-9834.77"/>
<text text-anchor="middle" x="568" y="-9822.77" font-family="Arial" font-size="10.00">Layer 10 Layer Norm 1</text>
<text text-anchor="middle" x="568" y="-9811.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-9800.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-9789.77" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- layer10_residual1&#45;&gt;layer10_layernorm1 -->
<g id="edge220" class="edge">
<title>layer10_residual1&#45;&gt;layer10_layernorm1</title>
<path fill="none" stroke="black" d="M568,-9870.69C568,-9862.03 568,-9853.2 568,-9845.06"/>
<polygon fill="black" stroke="black" points="571.5,-9844.82 568,-9834.82 564.5,-9844.82 571.5,-9844.82"/>
</g>
<!-- layer10_mlp_gate -->
<g id="node174" class="node">
<title>layer10_mlp_gate</title>
<polygon fill="lightyellow" stroke="black" points="477,-9746.77 185,-9746.77 185,-9694.77 477,-9694.77 477,-9746.77"/>
<text text-anchor="middle" x="331" y="-9734.77" font-family="Arial" font-size="10.00">Layer 10 MLP Gate Linear</text>
<text text-anchor="middle" x="331" y="-9723.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="331" y="-9712.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="331" y="-9701.77" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- layer10_layernorm1&#45;&gt;layer10_mlp_gate -->
<g id="edge221" class="edge">
<title>layer10_layernorm1&#45;&gt;layer10_mlp_gate</title>
<path fill="none" stroke="black" d="M498.81,-9782.67C470.95,-9772.56 438.66,-9760.84 409.88,-9750.4"/>
<polygon fill="black" stroke="black" points="410.87,-9747.03 400.27,-9746.91 408.48,-9753.61 410.87,-9747.03"/>
</g>
<!-- layer10_mlp_up -->
<g id="node175" class="node">
<title>layer10_mlp_up</title>
<polygon fill="lightyellow" stroke="black" points="714,-9658.77 422,-9658.77 422,-9606.77 714,-9606.77 714,-9658.77"/>
<text text-anchor="middle" x="568" y="-9646.77" font-family="Arial" font-size="10.00">Layer 10 MLP Up Linear</text>
<text text-anchor="middle" x="568" y="-9635.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-9624.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="568" y="-9613.77" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- layer10_layernorm1&#45;&gt;layer10_mlp_up -->
<g id="edge222" class="edge">
<title>layer10_layernorm1&#45;&gt;layer10_mlp_up</title>
<path fill="none" stroke="black" d="M568,-9782.47C568,-9752.62 568,-9702.8 568,-9669.14"/>
<polygon fill="black" stroke="black" points="571.5,-9668.82 568,-9658.82 564.5,-9668.82 571.5,-9668.82"/>
</g>
<!-- layer10_residual2 -->
<g id="node179" class="node">
<title>layer10_residual2</title>
<polygon fill="lightblue" stroke="black" points="568,-9394.77 44,-9342.77 568,-9290.77 1092,-9342.77 568,-9394.77"/>
<text text-anchor="middle" x="568" y="-9356.77" font-family="Arial" font-size="10.00">Layer 10 Residual Add 2</text>
<text text-anchor="middle" x="568" y="-9345.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-9334.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-9323.77" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- layer10_layernorm1&#45;&gt;layer10_residual2 -->
<g id="edge228" class="edge">
<title>layer10_layernorm1&#45;&gt;layer10_residual2</title>
<path fill="none" stroke="black" d="M617.06,-9782.7C665.7,-9753.94 733,-9701.84 733,-9633.77 733,-9633.77 733,-9633.77 733,-9543.77 733,-9482.84 686.86,-9430.42 643.38,-9394.56"/>
<polygon fill="black" stroke="black" points="645.57,-9391.82 635.59,-9388.28 641.18,-9397.28 645.57,-9391.82"/>
</g>
<!-- layer10_mlp_gelu -->
<g id="node176" class="node">
<title>layer10_mlp_gelu</title>
<polygon fill="orange" stroke="black" points="404,-9658.77 112,-9658.77 112,-9606.77 404,-9606.77 404,-9658.77"/>
<text text-anchor="middle" x="258" y="-9646.77" font-family="Arial" font-size="10.00">Layer 10 MLP GELU</text>
<text text-anchor="middle" x="258" y="-9635.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="258" y="-9624.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="258" y="-9613.77" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- layer10_mlp_gate&#45;&gt;layer10_mlp_gelu -->
<g id="edge223" class="edge">
<title>layer10_mlp_gate&#45;&gt;layer10_mlp_gelu</title>
<path fill="none" stroke="black" d="M309.49,-9694.44C302.14,-9685.78 293.81,-9675.96 286.02,-9666.78"/>
<polygon fill="black" stroke="black" points="288.49,-9664.29 279.35,-9658.93 283.16,-9668.82 288.49,-9664.29"/>
</g>
<!-- layer10_mlp_multiply -->
<g id="node177" class="node">
<title>layer10_mlp_multiply</title>
<polygon fill="orange" stroke="black" points="714,-9570.77 184,-9570.77 184,-9518.77 714,-9518.77 714,-9570.77"/>
<text text-anchor="middle" x="449" y="-9558.77" font-family="Arial" font-size="10.00">Layer 10 MLP Element&#45;wise Multiply</text>
<text text-anchor="middle" x="449" y="-9547.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768], [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="449" y="-9536.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="449" y="-9525.77" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- layer10_mlp_up&#45;&gt;layer10_mlp_multiply -->
<g id="edge224" class="edge">
<title>layer10_mlp_up&#45;&gt;layer10_mlp_multiply</title>
<path fill="none" stroke="black" d="M533.26,-9606.67C520.42,-9597.39 505.71,-9586.76 492.21,-9577"/>
<polygon fill="black" stroke="black" points="494.14,-9574.08 483.99,-9571.06 490.04,-9579.75 494.14,-9574.08"/>
</g>
<!-- layer10_mlp_gelu&#45;&gt;layer10_mlp_multiply -->
<g id="edge225" class="edge">
<title>layer10_mlp_gelu&#45;&gt;layer10_mlp_multiply</title>
<path fill="none" stroke="black" d="M313.76,-9606.67C335.73,-9596.78 361.11,-9585.35 383.91,-9575.08"/>
<polygon fill="black" stroke="black" points="385.49,-9578.21 393.17,-9570.91 382.62,-9571.83 385.49,-9578.21"/>
</g>
<!-- layer10_mlp_down -->
<g id="node178" class="node">
<title>layer10_mlp_down</title>
<polygon fill="lightyellow" stroke="black" points="653.5,-9482.77 364.5,-9482.77 364.5,-9430.77 653.5,-9430.77 653.5,-9482.77"/>
<text text-anchor="middle" x="509" y="-9470.77" font-family="Arial" font-size="10.00">Layer 10 MLP Down Linear</text>
<text text-anchor="middle" x="509" y="-9459.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="509" y="-9448.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="509" y="-9437.77" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- layer10_mlp_multiply&#45;&gt;layer10_mlp_down -->
<g id="edge226" class="edge">
<title>layer10_mlp_multiply&#45;&gt;layer10_mlp_down</title>
<path fill="none" stroke="black" d="M466.68,-9518.44C472.6,-9509.95 479.29,-9500.35 485.58,-9491.34"/>
<polygon fill="black" stroke="black" points="488.6,-9493.13 491.45,-9482.93 482.86,-9489.13 488.6,-9493.13"/>
</g>
<!-- layer10_mlp_down&#45;&gt;layer10_residual2 -->
<g id="edge227" class="edge">
<title>layer10_mlp_down&#45;&gt;layer10_residual2</title>
<path fill="none" stroke="black" d="M522.24,-9430.64C526.81,-9421.96 532.14,-9411.84 537.52,-9401.64"/>
<polygon fill="black" stroke="black" points="540.67,-9403.17 542.23,-9392.69 534.47,-9399.9 540.67,-9403.17"/>
</g>
<!-- layer10_layernorm2 -->
<g id="node180" class="node">
<title>layer10_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="712.5,-9254.77 423.5,-9254.77 423.5,-9202.77 712.5,-9202.77 712.5,-9254.77"/>
<text text-anchor="middle" x="568" y="-9242.77" font-family="Arial" font-size="10.00">Layer 10 Layer Norm 2</text>
<text text-anchor="middle" x="568" y="-9231.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-9220.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="568" y="-9209.77" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- layer10_residual2&#45;&gt;layer10_layernorm2 -->
<g id="edge229" class="edge">
<title>layer10_residual2&#45;&gt;layer10_layernorm2</title>
<path fill="none" stroke="black" d="M568,-9290.69C568,-9282.03 568,-9273.2 568,-9265.06"/>
<polygon fill="black" stroke="black" points="571.5,-9264.82 568,-9254.82 564.5,-9264.82 571.5,-9264.82"/>
</g>
<!-- layer10_layernorm2&#45;&gt;layer10_transfer -->
<g id="edge230" class="edge">
<title>layer10_layernorm2&#45;&gt;layer10_transfer</title>
<path fill="none" stroke="black" d="M568,-9202.6C568,-9194.79 568,-9185.93 568,-9177.16"/>
<polygon fill="black" stroke="black" points="571.5,-9176.98 568,-9166.98 564.5,-9176.98 571.5,-9176.98"/>
</g>
<!-- layer11_transfer -->
<g id="node181" class="node">
<title>layer11_transfer</title>
<ellipse fill="gray" stroke="black" cx="549" cy="-7614.47" rx="209.11" ry="36.54"/>
<text text-anchor="middle" x="549" y="-7628.47" font-family="Arial" font-size="10.00">Layer 11 â†’ 12 Transfer</text>
<text text-anchor="middle" x="549" y="-7617.47" font-family="Arial" font-size="10.00">Transfer: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-7606.47" font-family="Arial" font-size="10.00">From: GPU 10</text>
<text text-anchor="middle" x="549" y="-7595.47" font-family="Arial" font-size="10.00">To: GPU 11</text>
</g>
<!-- layer12_input -->
<g id="node200" class="node">
<title>layer12_input</title>
<polygon fill="lightyellow" stroke="black" points="848.74,-7523.7 371.92,-7523.7 249.26,-7419.7 726.08,-7419.7 848.74,-7523.7"/>
<text text-anchor="middle" x="549" y="-7485.7" font-family="Arial" font-size="10.00">Layer 12 Input</text>
<text text-anchor="middle" x="549" y="-7474.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-7463.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-7452.7" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- layer11_transfer&#45;&gt;layer12_input -->
<g id="edge254" class="edge">
<title>layer11_transfer&#45;&gt;layer12_input</title>
<path fill="none" stroke="black" d="M549,-7577.58C549,-7564.34 549,-7548.94 549,-7534.09"/>
<polygon fill="black" stroke="black" points="552.5,-7533.92 549,-7523.92 545.5,-7533.92 552.5,-7533.92"/>
</g>
<!-- layer11_mha_query -->
<g id="node183" class="node">
<title>layer11_mha_query</title>
<polygon fill="pink" stroke="black" points="325,-8899.23 29,-8899.23 29,-8847.23 325,-8847.23 325,-8899.23"/>
<text text-anchor="middle" x="177" y="-8887.23" font-family="Arial" font-size="10.00">Layer 11 MHA Query Linear</text>
<text text-anchor="middle" x="177" y="-8876.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="177" y="-8865.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_q=512]</text>
<text text-anchor="middle" x="177" y="-8854.23" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- layer11_input&#45;&gt;layer11_mha_query -->
<g id="edge232" class="edge">
<title>layer11_input&#45;&gt;layer11_mha_query</title>
<path fill="none" stroke="black" d="M389.95,-8935.23C350.06,-8923.81 309.19,-8912.1 274.06,-8902.04"/>
<polygon fill="black" stroke="black" points="274.89,-8898.63 264.31,-8899.24 272.96,-8905.36 274.89,-8898.63"/>
</g>
<!-- layer11_mha_key -->
<g id="node184" class="node">
<title>layer11_mha_key</title>
<polygon fill="pink" stroke="black" points="639,-8899.23 343,-8899.23 343,-8847.23 639,-8847.23 639,-8899.23"/>
<text text-anchor="middle" x="491" y="-8887.23" font-family="Arial" font-size="10.00">Layer 11 MHA Key Linear</text>
<text text-anchor="middle" x="491" y="-8876.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="491" y="-8865.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="491" y="-8854.23" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- layer11_input&#45;&gt;layer11_mha_key -->
<g id="edge233" class="edge">
<title>layer11_input&#45;&gt;layer11_mha_key</title>
<path fill="none" stroke="black" d="M532.88,-8935.15C526.45,-8925.8 519.9,-8916.27 513.95,-8907.61"/>
<polygon fill="black" stroke="black" points="516.77,-8905.54 508.22,-8899.28 511,-8909.5 516.77,-8905.54"/>
</g>
<!-- layer11_mha_value -->
<g id="node185" class="node">
<title>layer11_mha_value</title>
<polygon fill="pink" stroke="black" points="735,-8811.23 439,-8811.23 439,-8759.23 735,-8759.23 735,-8811.23"/>
<text text-anchor="middle" x="587" y="-8799.23" font-family="Arial" font-size="10.00">Layer 11 MHA Value Linear</text>
<text text-anchor="middle" x="587" y="-8788.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="587" y="-8777.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_v=512]</text>
<text text-anchor="middle" x="587" y="-8766.23" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- layer11_input&#45;&gt;layer11_mha_value -->
<g id="edge234" class="edge">
<title>layer11_input&#45;&gt;layer11_mha_value</title>
<path fill="none" stroke="black" d="M626.26,-8934.94C635.15,-8924.11 643.01,-8912.04 648,-8899.23 656.4,-8877.7 656.84,-8868.59 648,-8847.23 643.61,-8836.64 636.39,-8826.93 628.43,-8818.51"/>
<polygon fill="black" stroke="black" points="630.86,-8816 621.29,-8811.47 625.94,-8820.98 630.86,-8816"/>
</g>
<!-- layer11_residual1 -->
<g id="node190" class="node">
<title>layer11_residual1</title>
<polygon fill="lightblue" stroke="black" points="549,-8459.23 25,-8407.23 549,-8355.23 1073,-8407.23 549,-8459.23"/>
<text text-anchor="middle" x="549" y="-8421.23" font-family="Arial" font-size="10.00">Layer 11 Residual Add 1</text>
<text text-anchor="middle" x="549" y="-8410.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-8399.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-8388.23" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- layer11_input&#45;&gt;layer11_residual1 -->
<g id="edge242" class="edge">
<title>layer11_input&#45;&gt;layer11_residual1</title>
<path fill="none" stroke="black" d="M656.37,-8935.17C704.36,-8900.24 754,-8848.94 754,-8786.23 754,-8786.23 754,-8786.23 754,-8608.23 754,-8541.69 697.97,-8490.06 644.49,-8455.94"/>
<polygon fill="black" stroke="black" points="646.28,-8452.92 635.94,-8450.61 642.58,-8458.87 646.28,-8452.92"/>
</g>
<!-- layer11_mha_qkt -->
<g id="node186" class="node">
<title>layer11_mha_qkt</title>
<polygon fill="lightcoral" stroke="black" points="420.5,-8811.23 95.5,-8811.23 95.5,-8759.23 420.5,-8759.23 420.5,-8811.23"/>
<text text-anchor="middle" x="258" y="-8799.23" font-family="Arial" font-size="10.00">Layer 11 MHA QKT Calculation</text>
<text text-anchor="middle" x="258" y="-8788.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="258" y="-8777.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="258" y="-8766.23" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- layer11_mha_query&#45;&gt;layer11_mha_qkt -->
<g id="edge235" class="edge">
<title>layer11_mha_query&#45;&gt;layer11_mha_qkt</title>
<path fill="none" stroke="black" d="M200.86,-8846.9C209.19,-8838.06 218.64,-8828.02 227.43,-8818.69"/>
<polygon fill="black" stroke="black" points="230,-8821.07 234.31,-8811.39 224.9,-8816.27 230,-8821.07"/>
</g>
<!-- layer11_mha_key&#45;&gt;layer11_mha_qkt -->
<g id="edge236" class="edge">
<title>layer11_mha_key&#45;&gt;layer11_mha_qkt</title>
<path fill="none" stroke="black" d="M422.98,-8847.13C395.59,-8837.02 363.84,-8825.3 335.55,-8814.86"/>
<polygon fill="black" stroke="black" points="336.7,-8811.55 326.1,-8811.37 334.27,-8818.12 336.7,-8811.55"/>
</g>
<!-- layer11_mha_apply -->
<g id="node188" class="node">
<title>layer11_mha_apply</title>
<polygon fill="lightcoral" stroke="black" points="735,-8635.23 167,-8635.23 167,-8583.23 735,-8583.23 735,-8635.23"/>
<text text-anchor="middle" x="451" y="-8623.23" font-family="Arial" font-size="10.00">Layer 11 MHA Apply Attention</text>
<text text-anchor="middle" x="451" y="-8612.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000], [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="451" y="-8601.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="451" y="-8590.23" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- layer11_mha_value&#45;&gt;layer11_mha_apply -->
<g id="edge239" class="edge">
<title>layer11_mha_value&#45;&gt;layer11_mha_apply</title>
<path fill="none" stroke="black" d="M567.22,-8758.93C543.39,-8728.43 503.26,-8677.09 476.95,-8643.44"/>
<polygon fill="black" stroke="black" points="479.49,-8641.01 470.58,-8635.28 473.98,-8645.32 479.49,-8641.01"/>
</g>
<!-- layer11_mha_softmax -->
<g id="node187" class="node">
<title>layer11_mha_softmax</title>
<polygon fill="lightcoral" stroke="black" points="460.5,-8723.23 135.5,-8723.23 135.5,-8671.23 460.5,-8671.23 460.5,-8723.23"/>
<text text-anchor="middle" x="298" y="-8711.23" font-family="Arial" font-size="10.00">Layer 11 MHA Softmax</text>
<text text-anchor="middle" x="298" y="-8700.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="298" y="-8689.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="298" y="-8678.23" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- layer11_mha_qkt&#45;&gt;layer11_mha_softmax -->
<g id="edge237" class="edge">
<title>layer11_mha_qkt&#45;&gt;layer11_mha_softmax</title>
<path fill="none" stroke="black" d="M269.78,-8758.9C273.61,-8750.67 277.92,-8741.41 282,-8732.64"/>
<polygon fill="black" stroke="black" points="285.26,-8733.93 286.3,-8723.39 278.91,-8730.98 285.26,-8733.93"/>
</g>
<!-- layer11_mha_softmax&#45;&gt;layer11_mha_apply -->
<g id="edge238" class="edge">
<title>layer11_mha_softmax&#45;&gt;layer11_mha_apply</title>
<path fill="none" stroke="black" d="M342.67,-8671.13C359.72,-8661.54 379.33,-8650.52 397.15,-8640.5"/>
<polygon fill="black" stroke="black" points="399.28,-8643.32 406.28,-8635.37 395.85,-8637.22 399.28,-8643.32"/>
</g>
<!-- layer11_mha_out -->
<g id="node189" class="node">
<title>layer11_mha_out</title>
<polygon fill="pink" stroke="black" points="644.5,-8547.23 355.5,-8547.23 355.5,-8495.23 644.5,-8495.23 644.5,-8547.23"/>
<text text-anchor="middle" x="500" y="-8535.23" font-family="Arial" font-size="10.00">Layer 11 MHA Output Linear</text>
<text text-anchor="middle" x="500" y="-8524.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="500" y="-8513.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="500" y="-8502.23" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- layer11_mha_apply&#45;&gt;layer11_mha_out -->
<g id="edge240" class="edge">
<title>layer11_mha_apply&#45;&gt;layer11_mha_out</title>
<path fill="none" stroke="black" d="M465.44,-8582.9C470.17,-8574.59 475.51,-8565.21 480.56,-8556.36"/>
<polygon fill="black" stroke="black" points="483.76,-8557.81 485.67,-8547.39 477.68,-8554.35 483.76,-8557.81"/>
</g>
<!-- layer11_mha_out&#45;&gt;layer11_residual1 -->
<g id="edge241" class="edge">
<title>layer11_mha_out&#45;&gt;layer11_residual1</title>
<path fill="none" stroke="black" d="M511,-8495.1C514.76,-8486.51 519.13,-8476.51 523.55,-8466.41"/>
<polygon fill="black" stroke="black" points="526.8,-8467.71 527.6,-8457.15 520.38,-8464.91 526.8,-8467.71"/>
</g>
<!-- layer11_layernorm1 -->
<g id="node191" class="node">
<title>layer11_layernorm1</title>
<polygon fill="lightgreen" stroke="black" points="693.5,-8319.23 404.5,-8319.23 404.5,-8267.23 693.5,-8267.23 693.5,-8319.23"/>
<text text-anchor="middle" x="549" y="-8307.23" font-family="Arial" font-size="10.00">Layer 11 Layer Norm 1</text>
<text text-anchor="middle" x="549" y="-8296.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-8285.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-8274.23" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- layer11_residual1&#45;&gt;layer11_layernorm1 -->
<g id="edge243" class="edge">
<title>layer11_residual1&#45;&gt;layer11_layernorm1</title>
<path fill="none" stroke="black" d="M549,-8355.15C549,-8346.49 549,-8337.66 549,-8329.52"/>
<polygon fill="black" stroke="black" points="552.5,-8329.28 549,-8319.28 545.5,-8329.28 552.5,-8329.28"/>
</g>
<!-- layer11_mlp_gate -->
<g id="node192" class="node">
<title>layer11_mlp_gate</title>
<polygon fill="lightyellow" stroke="black" points="458,-8231.23 166,-8231.23 166,-8179.23 458,-8179.23 458,-8231.23"/>
<text text-anchor="middle" x="312" y="-8219.23" font-family="Arial" font-size="10.00">Layer 11 MLP Gate Linear</text>
<text text-anchor="middle" x="312" y="-8208.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="312" y="-8197.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="312" y="-8186.23" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- layer11_layernorm1&#45;&gt;layer11_mlp_gate -->
<g id="edge244" class="edge">
<title>layer11_layernorm1&#45;&gt;layer11_mlp_gate</title>
<path fill="none" stroke="black" d="M479.81,-8267.13C451.95,-8257.02 419.66,-8245.3 390.88,-8234.86"/>
<polygon fill="black" stroke="black" points="391.87,-8231.49 381.27,-8231.37 389.48,-8238.07 391.87,-8231.49"/>
</g>
<!-- layer11_mlp_up -->
<g id="node193" class="node">
<title>layer11_mlp_up</title>
<polygon fill="lightyellow" stroke="black" points="695,-8143.23 403,-8143.23 403,-8091.23 695,-8091.23 695,-8143.23"/>
<text text-anchor="middle" x="549" y="-8131.23" font-family="Arial" font-size="10.00">Layer 11 MLP Up Linear</text>
<text text-anchor="middle" x="549" y="-8120.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-8109.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="549" y="-8098.23" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- layer11_layernorm1&#45;&gt;layer11_mlp_up -->
<g id="edge245" class="edge">
<title>layer11_layernorm1&#45;&gt;layer11_mlp_up</title>
<path fill="none" stroke="black" d="M549,-8266.93C549,-8237.08 549,-8187.26 549,-8153.6"/>
<polygon fill="black" stroke="black" points="552.5,-8153.28 549,-8143.28 545.5,-8153.28 552.5,-8153.28"/>
</g>
<!-- layer11_residual2 -->
<g id="node197" class="node">
<title>layer11_residual2</title>
<polygon fill="lightblue" stroke="black" points="549,-7879.23 25,-7827.23 549,-7775.23 1073,-7827.23 549,-7879.23"/>
<text text-anchor="middle" x="549" y="-7841.23" font-family="Arial" font-size="10.00">Layer 11 Residual Add 2</text>
<text text-anchor="middle" x="549" y="-7830.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-7819.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-7808.23" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- layer11_layernorm1&#45;&gt;layer11_residual2 -->
<g id="edge251" class="edge">
<title>layer11_layernorm1&#45;&gt;layer11_residual2</title>
<path fill="none" stroke="black" d="M598.06,-8267.16C646.7,-8238.4 714,-8186.3 714,-8118.23 714,-8118.23 714,-8118.23 714,-8028.23 714,-7967.3 667.86,-7914.88 624.38,-7879.02"/>
<polygon fill="black" stroke="black" points="626.57,-7876.29 616.59,-7872.74 622.18,-7881.74 626.57,-7876.29"/>
</g>
<!-- layer11_mlp_gelu -->
<g id="node194" class="node">
<title>layer11_mlp_gelu</title>
<polygon fill="orange" stroke="black" points="385,-8143.23 93,-8143.23 93,-8091.23 385,-8091.23 385,-8143.23"/>
<text text-anchor="middle" x="239" y="-8131.23" font-family="Arial" font-size="10.00">Layer 11 MLP GELU</text>
<text text-anchor="middle" x="239" y="-8120.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="239" y="-8109.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="239" y="-8098.23" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- layer11_mlp_gate&#45;&gt;layer11_mlp_gelu -->
<g id="edge246" class="edge">
<title>layer11_mlp_gate&#45;&gt;layer11_mlp_gelu</title>
<path fill="none" stroke="black" d="M290.49,-8178.9C283.14,-8170.24 274.81,-8160.42 267.02,-8151.24"/>
<polygon fill="black" stroke="black" points="269.49,-8148.75 260.35,-8143.39 264.16,-8153.28 269.49,-8148.75"/>
</g>
<!-- layer11_mlp_multiply -->
<g id="node195" class="node">
<title>layer11_mlp_multiply</title>
<polygon fill="orange" stroke="black" points="695,-8055.23 165,-8055.23 165,-8003.23 695,-8003.23 695,-8055.23"/>
<text text-anchor="middle" x="430" y="-8043.23" font-family="Arial" font-size="10.00">Layer 11 MLP Element&#45;wise Multiply</text>
<text text-anchor="middle" x="430" y="-8032.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768], [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="430" y="-8021.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="430" y="-8010.23" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- layer11_mlp_up&#45;&gt;layer11_mlp_multiply -->
<g id="edge247" class="edge">
<title>layer11_mlp_up&#45;&gt;layer11_mlp_multiply</title>
<path fill="none" stroke="black" d="M514.26,-8091.13C501.42,-8081.85 486.71,-8071.22 473.21,-8061.46"/>
<polygon fill="black" stroke="black" points="475.14,-8058.54 464.99,-8055.52 471.04,-8064.21 475.14,-8058.54"/>
</g>
<!-- layer11_mlp_gelu&#45;&gt;layer11_mlp_multiply -->
<g id="edge248" class="edge">
<title>layer11_mlp_gelu&#45;&gt;layer11_mlp_multiply</title>
<path fill="none" stroke="black" d="M294.76,-8091.13C316.73,-8081.24 342.11,-8069.81 364.91,-8059.54"/>
<polygon fill="black" stroke="black" points="366.49,-8062.67 374.17,-8055.37 363.62,-8056.29 366.49,-8062.67"/>
</g>
<!-- layer11_mlp_down -->
<g id="node196" class="node">
<title>layer11_mlp_down</title>
<polygon fill="lightyellow" stroke="black" points="634.5,-7967.23 345.5,-7967.23 345.5,-7915.23 634.5,-7915.23 634.5,-7967.23"/>
<text text-anchor="middle" x="490" y="-7955.23" font-family="Arial" font-size="10.00">Layer 11 MLP Down Linear</text>
<text text-anchor="middle" x="490" y="-7944.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="490" y="-7933.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-7922.23" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- layer11_mlp_multiply&#45;&gt;layer11_mlp_down -->
<g id="edge249" class="edge">
<title>layer11_mlp_multiply&#45;&gt;layer11_mlp_down</title>
<path fill="none" stroke="black" d="M447.68,-8002.9C453.6,-7994.41 460.29,-7984.81 466.58,-7975.8"/>
<polygon fill="black" stroke="black" points="469.6,-7977.6 472.45,-7967.39 463.86,-7973.59 469.6,-7977.6"/>
</g>
<!-- layer11_mlp_down&#45;&gt;layer11_residual2 -->
<g id="edge250" class="edge">
<title>layer11_mlp_down&#45;&gt;layer11_residual2</title>
<path fill="none" stroke="black" d="M503.24,-7915.1C507.81,-7906.42 513.14,-7896.3 518.52,-7886.1"/>
<polygon fill="black" stroke="black" points="521.67,-7887.63 523.23,-7877.15 515.47,-7884.37 521.67,-7887.63"/>
</g>
<!-- layer11_layernorm2 -->
<g id="node198" class="node">
<title>layer11_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="693.5,-7739.23 404.5,-7739.23 404.5,-7687.23 693.5,-7687.23 693.5,-7739.23"/>
<text text-anchor="middle" x="549" y="-7727.23" font-family="Arial" font-size="10.00">Layer 11 Layer Norm 2</text>
<text text-anchor="middle" x="549" y="-7716.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-7705.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-7694.23" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- layer11_residual2&#45;&gt;layer11_layernorm2 -->
<g id="edge252" class="edge">
<title>layer11_residual2&#45;&gt;layer11_layernorm2</title>
<path fill="none" stroke="black" d="M549,-7775.15C549,-7766.49 549,-7757.66 549,-7749.52"/>
<polygon fill="black" stroke="black" points="552.5,-7749.28 549,-7739.28 545.5,-7749.28 552.5,-7749.28"/>
</g>
<!-- layer11_layernorm2&#45;&gt;layer11_transfer -->
<g id="edge253" class="edge">
<title>layer11_layernorm2&#45;&gt;layer11_transfer</title>
<path fill="none" stroke="black" d="M549,-7687.06C549,-7679.25 549,-7670.39 549,-7661.62"/>
<polygon fill="black" stroke="black" points="552.5,-7661.44 549,-7651.44 545.5,-7661.44 552.5,-7661.44"/>
</g>
<!-- layer12_transfer -->
<g id="node199" class="node">
<title>layer12_transfer</title>
<ellipse fill="gray" stroke="black" cx="584" cy="-6098.93" rx="209.11" ry="36.54"/>
<text text-anchor="middle" x="584" y="-6112.93" font-family="Arial" font-size="10.00">Layer 12 â†’ 13 Transfer</text>
<text text-anchor="middle" x="584" y="-6101.93" font-family="Arial" font-size="10.00">Transfer: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-6090.93" font-family="Arial" font-size="10.00">From: GPU 11</text>
<text text-anchor="middle" x="584" y="-6079.93" font-family="Arial" font-size="10.00">To: GPU 12</text>
</g>
<!-- layer13_input -->
<g id="node218" class="node">
<title>layer13_input</title>
<polygon fill="lightyellow" stroke="black" points="883.74,-6008.16 406.92,-6008.16 284.26,-5904.16 761.08,-5904.16 883.74,-6008.16"/>
<text text-anchor="middle" x="584" y="-5970.16" font-family="Arial" font-size="10.00">Layer 13 Input</text>
<text text-anchor="middle" x="584" y="-5959.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-5948.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-5937.16" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- layer12_transfer&#45;&gt;layer13_input -->
<g id="edge277" class="edge">
<title>layer12_transfer&#45;&gt;layer13_input</title>
<path fill="none" stroke="black" d="M584,-6062.04C584,-6048.8 584,-6033.4 584,-6018.55"/>
<polygon fill="black" stroke="black" points="587.5,-6018.38 584,-6008.38 580.5,-6018.38 587.5,-6018.38"/>
</g>
<!-- layer12_mha_query -->
<g id="node201" class="node">
<title>layer12_mha_query</title>
<polygon fill="pink" stroke="black" points="360,-7383.7 64,-7383.7 64,-7331.7 360,-7331.7 360,-7383.7"/>
<text text-anchor="middle" x="212" y="-7371.7" font-family="Arial" font-size="10.00">Layer 12 MHA Query Linear</text>
<text text-anchor="middle" x="212" y="-7360.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="212" y="-7349.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_q=512]</text>
<text text-anchor="middle" x="212" y="-7338.7" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- layer12_input&#45;&gt;layer12_mha_query -->
<g id="edge255" class="edge">
<title>layer12_input&#45;&gt;layer12_mha_query</title>
<path fill="none" stroke="black" d="M395.29,-7419.61C361.46,-7408.37 326.82,-7396.86 296.9,-7386.91"/>
<polygon fill="black" stroke="black" points="297.95,-7383.57 287.35,-7383.74 295.74,-7390.21 297.95,-7383.57"/>
</g>
<!-- layer12_mha_key -->
<g id="node202" class="node">
<title>layer12_mha_key</title>
<polygon fill="pink" stroke="black" points="674,-7383.7 378,-7383.7 378,-7331.7 674,-7331.7 674,-7383.7"/>
<text text-anchor="middle" x="526" y="-7371.7" font-family="Arial" font-size="10.00">Layer 12 MHA Key Linear</text>
<text text-anchor="middle" x="526" y="-7360.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="526" y="-7349.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="526" y="-7338.7" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- layer12_input&#45;&gt;layer12_mha_key -->
<g id="edge256" class="edge">
<title>layer12_input&#45;&gt;layer12_mha_key</title>
<path fill="none" stroke="black" d="M538.51,-7419.61C536.71,-7410.85 534.88,-7401.93 533.19,-7393.71"/>
<polygon fill="black" stroke="black" points="536.58,-7392.83 531.14,-7383.74 529.73,-7394.24 536.58,-7392.83"/>
</g>
<!-- layer12_mha_value -->
<g id="node203" class="node">
<title>layer12_mha_value</title>
<polygon fill="pink" stroke="black" points="713,-7295.7 417,-7295.7 417,-7243.7 713,-7243.7 713,-7295.7"/>
<text text-anchor="middle" x="565" y="-7283.7" font-family="Arial" font-size="10.00">Layer 12 MHA Value Linear</text>
<text text-anchor="middle" x="565" y="-7272.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="565" y="-7261.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_v=512]</text>
<text text-anchor="middle" x="565" y="-7250.7" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- layer12_input&#45;&gt;layer12_mha_value -->
<g id="edge257" class="edge">
<title>layer12_input&#45;&gt;layer12_mha_value</title>
<path fill="none" stroke="black" d="M652.67,-7419.63C664.82,-7409.4 675.52,-7397.47 683,-7383.7 694.03,-7363.39 695.02,-7351.44 683,-7331.7 675.35,-7319.13 664.19,-7309.04 651.74,-7300.97"/>
<polygon fill="black" stroke="black" points="653.32,-7297.84 642.94,-7295.7 649.72,-7303.84 653.32,-7297.84"/>
</g>
<!-- layer12_residual1 -->
<g id="node208" class="node">
<title>layer12_residual1</title>
<polygon fill="lightblue" stroke="black" points="584,-6943.7 60,-6891.7 584,-6839.7 1108,-6891.7 584,-6943.7"/>
<text text-anchor="middle" x="584" y="-6905.7" font-family="Arial" font-size="10.00">Layer 12 Residual Add 1</text>
<text text-anchor="middle" x="584" y="-6894.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-6883.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-6872.7" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- layer12_input&#45;&gt;layer12_residual1 -->
<g id="edge265" class="edge">
<title>layer12_input&#45;&gt;layer12_residual1</title>
<path fill="none" stroke="black" d="M652.78,-7419.59C667.31,-7409.2 681.01,-7397.23 692,-7383.7 725.59,-7342.34 732,-7323.97 732,-7270.7 732,-7270.7 732,-7270.7 732,-7092.7 732,-7034.18 690.56,-6981.59 651.53,-6945.04"/>
<polygon fill="black" stroke="black" points="653.51,-6942.11 643.77,-6937.94 648.79,-6947.28 653.51,-6942.11"/>
</g>
<!-- layer12_mha_qkt -->
<g id="node204" class="node">
<title>layer12_mha_qkt</title>
<polygon fill="lightcoral" stroke="black" points="398.5,-7295.7 73.5,-7295.7 73.5,-7243.7 398.5,-7243.7 398.5,-7295.7"/>
<text text-anchor="middle" x="236" y="-7283.7" font-family="Arial" font-size="10.00">Layer 12 MHA QKT Calculation</text>
<text text-anchor="middle" x="236" y="-7272.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="236" y="-7261.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="236" y="-7250.7" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- layer12_mha_query&#45;&gt;layer12_mha_qkt -->
<g id="edge258" class="edge">
<title>layer12_mha_query&#45;&gt;layer12_mha_qkt</title>
<path fill="none" stroke="black" d="M219.07,-7331.36C221.32,-7323.31 223.84,-7314.26 226.24,-7305.66"/>
<polygon fill="black" stroke="black" points="229.66,-7306.42 228.98,-7295.85 222.92,-7304.54 229.66,-7306.42"/>
</g>
<!-- layer12_mha_key&#45;&gt;layer12_mha_qkt -->
<g id="edge259" class="edge">
<title>layer12_mha_key&#45;&gt;layer12_mha_qkt</title>
<path fill="none" stroke="black" d="M441.34,-7331.59C406.57,-7321.28 366.18,-7309.3 330.46,-7298.71"/>
<polygon fill="black" stroke="black" points="331.1,-7295.25 320.51,-7295.76 329.11,-7301.96 331.1,-7295.25"/>
</g>
<!-- layer12_mha_apply -->
<g id="node206" class="node">
<title>layer12_mha_apply</title>
<polygon fill="lightcoral" stroke="black" points="713,-7119.7 145,-7119.7 145,-7067.7 713,-7067.7 713,-7119.7"/>
<text text-anchor="middle" x="429" y="-7107.7" font-family="Arial" font-size="10.00">Layer 12 MHA Apply Attention</text>
<text text-anchor="middle" x="429" y="-7096.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000], [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="429" y="-7085.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="429" y="-7074.7" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- layer12_mha_value&#45;&gt;layer12_mha_apply -->
<g id="edge262" class="edge">
<title>layer12_mha_value&#45;&gt;layer12_mha_apply</title>
<path fill="none" stroke="black" d="M545.22,-7243.39C521.39,-7212.9 481.26,-7161.55 454.95,-7127.9"/>
<polygon fill="black" stroke="black" points="457.49,-7125.47 448.58,-7119.74 451.98,-7129.78 457.49,-7125.47"/>
</g>
<!-- layer12_mha_softmax -->
<g id="node205" class="node">
<title>layer12_mha_softmax</title>
<polygon fill="lightcoral" stroke="black" points="438.5,-7207.7 113.5,-7207.7 113.5,-7155.7 438.5,-7155.7 438.5,-7207.7"/>
<text text-anchor="middle" x="276" y="-7195.7" font-family="Arial" font-size="10.00">Layer 12 MHA Softmax</text>
<text text-anchor="middle" x="276" y="-7184.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="276" y="-7173.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="276" y="-7162.7" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- layer12_mha_qkt&#45;&gt;layer12_mha_softmax -->
<g id="edge260" class="edge">
<title>layer12_mha_qkt&#45;&gt;layer12_mha_softmax</title>
<path fill="none" stroke="black" d="M247.78,-7243.36C251.61,-7235.13 255.92,-7225.87 260,-7217.1"/>
<polygon fill="black" stroke="black" points="263.26,-7218.4 264.3,-7207.85 256.91,-7215.44 263.26,-7218.4"/>
</g>
<!-- layer12_mha_softmax&#45;&gt;layer12_mha_apply -->
<g id="edge261" class="edge">
<title>layer12_mha_softmax&#45;&gt;layer12_mha_apply</title>
<path fill="none" stroke="black" d="M320.67,-7155.59C337.72,-7146.01 357.33,-7134.98 375.15,-7124.96"/>
<polygon fill="black" stroke="black" points="377.28,-7127.78 384.28,-7119.83 373.85,-7121.68 377.28,-7127.78"/>
</g>
<!-- layer12_mha_out -->
<g id="node207" class="node">
<title>layer12_mha_out</title>
<polygon fill="pink" stroke="black" points="643.5,-7031.7 354.5,-7031.7 354.5,-6979.7 643.5,-6979.7 643.5,-7031.7"/>
<text text-anchor="middle" x="499" y="-7019.7" font-family="Arial" font-size="10.00">Layer 12 MHA Output Linear</text>
<text text-anchor="middle" x="499" y="-7008.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="499" y="-6997.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="499" y="-6986.7" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- layer12_mha_apply&#45;&gt;layer12_mha_out -->
<g id="edge263" class="edge">
<title>layer12_mha_apply&#45;&gt;layer12_mha_out</title>
<path fill="none" stroke="black" d="M449.62,-7067.36C456.67,-7058.7 464.66,-7048.88 472.13,-7039.7"/>
<polygon fill="black" stroke="black" points="474.93,-7041.82 478.52,-7031.85 469.5,-7037.4 474.93,-7041.82"/>
</g>
<!-- layer12_mha_out&#45;&gt;layer12_residual1 -->
<g id="edge264" class="edge">
<title>layer12_mha_out&#45;&gt;layer12_residual1</title>
<path fill="none" stroke="black" d="M518.08,-6979.56C525.17,-6970.22 533.52,-6959.21 541.86,-6948.23"/>
<polygon fill="black" stroke="black" points="544.65,-6950.34 547.9,-6940.26 539.07,-6946.11 544.65,-6950.34"/>
</g>
<!-- layer12_layernorm1 -->
<g id="node209" class="node">
<title>layer12_layernorm1</title>
<polygon fill="lightgreen" stroke="black" points="728.5,-6803.7 439.5,-6803.7 439.5,-6751.7 728.5,-6751.7 728.5,-6803.7"/>
<text text-anchor="middle" x="584" y="-6791.7" font-family="Arial" font-size="10.00">Layer 12 Layer Norm 1</text>
<text text-anchor="middle" x="584" y="-6780.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-6769.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-6758.7" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- layer12_residual1&#45;&gt;layer12_layernorm1 -->
<g id="edge266" class="edge">
<title>layer12_residual1&#45;&gt;layer12_layernorm1</title>
<path fill="none" stroke="black" d="M584,-6839.61C584,-6830.95 584,-6822.12 584,-6813.98"/>
<polygon fill="black" stroke="black" points="587.5,-6813.74 584,-6803.74 580.5,-6813.74 587.5,-6813.74"/>
</g>
<!-- layer12_mlp_gate -->
<g id="node210" class="node">
<title>layer12_mlp_gate</title>
<polygon fill="lightyellow" stroke="black" points="493,-6715.7 201,-6715.7 201,-6663.7 493,-6663.7 493,-6715.7"/>
<text text-anchor="middle" x="347" y="-6703.7" font-family="Arial" font-size="10.00">Layer 12 MLP Gate Linear</text>
<text text-anchor="middle" x="347" y="-6692.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="347" y="-6681.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="347" y="-6670.7" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- layer12_layernorm1&#45;&gt;layer12_mlp_gate -->
<g id="edge267" class="edge">
<title>layer12_layernorm1&#45;&gt;layer12_mlp_gate</title>
<path fill="none" stroke="black" d="M514.81,-6751.59C486.95,-6741.48 454.66,-6729.76 425.88,-6719.32"/>
<polygon fill="black" stroke="black" points="426.87,-6715.95 416.27,-6715.83 424.48,-6722.53 426.87,-6715.95"/>
</g>
<!-- layer12_mlp_up -->
<g id="node211" class="node">
<title>layer12_mlp_up</title>
<polygon fill="lightyellow" stroke="black" points="730,-6627.7 438,-6627.7 438,-6575.7 730,-6575.7 730,-6627.7"/>
<text text-anchor="middle" x="584" y="-6615.7" font-family="Arial" font-size="10.00">Layer 12 MLP Up Linear</text>
<text text-anchor="middle" x="584" y="-6604.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-6593.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="584" y="-6582.7" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- layer12_layernorm1&#45;&gt;layer12_mlp_up -->
<g id="edge268" class="edge">
<title>layer12_layernorm1&#45;&gt;layer12_mlp_up</title>
<path fill="none" stroke="black" d="M584,-6751.39C584,-6721.54 584,-6671.72 584,-6638.06"/>
<polygon fill="black" stroke="black" points="587.5,-6637.74 584,-6627.74 580.5,-6637.74 587.5,-6637.74"/>
</g>
<!-- layer12_residual2 -->
<g id="node215" class="node">
<title>layer12_residual2</title>
<polygon fill="lightblue" stroke="black" points="584,-6363.7 60,-6311.7 584,-6259.7 1108,-6311.7 584,-6363.7"/>
<text text-anchor="middle" x="584" y="-6325.7" font-family="Arial" font-size="10.00">Layer 12 Residual Add 2</text>
<text text-anchor="middle" x="584" y="-6314.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-6303.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-6292.7" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- layer12_layernorm1&#45;&gt;layer12_residual2 -->
<g id="edge274" class="edge">
<title>layer12_layernorm1&#45;&gt;layer12_residual2</title>
<path fill="none" stroke="black" d="M633.06,-6751.62C681.7,-6722.86 749,-6670.76 749,-6602.7 749,-6602.7 749,-6602.7 749,-6512.7 749,-6451.76 702.86,-6399.34 659.38,-6363.48"/>
<polygon fill="black" stroke="black" points="661.57,-6360.75 651.59,-6357.2 657.18,-6366.2 661.57,-6360.75"/>
</g>
<!-- layer12_mlp_gelu -->
<g id="node212" class="node">
<title>layer12_mlp_gelu</title>
<polygon fill="orange" stroke="black" points="420,-6627.7 128,-6627.7 128,-6575.7 420,-6575.7 420,-6627.7"/>
<text text-anchor="middle" x="274" y="-6615.7" font-family="Arial" font-size="10.00">Layer 12 MLP GELU</text>
<text text-anchor="middle" x="274" y="-6604.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="274" y="-6593.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="274" y="-6582.7" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- layer12_mlp_gate&#45;&gt;layer12_mlp_gelu -->
<g id="edge269" class="edge">
<title>layer12_mlp_gate&#45;&gt;layer12_mlp_gelu</title>
<path fill="none" stroke="black" d="M325.49,-6663.36C318.14,-6654.7 309.81,-6644.88 302.02,-6635.7"/>
<polygon fill="black" stroke="black" points="304.49,-6633.21 295.35,-6627.85 299.16,-6637.74 304.49,-6633.21"/>
</g>
<!-- layer12_mlp_multiply -->
<g id="node213" class="node">
<title>layer12_mlp_multiply</title>
<polygon fill="orange" stroke="black" points="730,-6539.7 200,-6539.7 200,-6487.7 730,-6487.7 730,-6539.7"/>
<text text-anchor="middle" x="465" y="-6527.7" font-family="Arial" font-size="10.00">Layer 12 MLP Element&#45;wise Multiply</text>
<text text-anchor="middle" x="465" y="-6516.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768], [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="465" y="-6505.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="465" y="-6494.7" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- layer12_mlp_up&#45;&gt;layer12_mlp_multiply -->
<g id="edge270" class="edge">
<title>layer12_mlp_up&#45;&gt;layer12_mlp_multiply</title>
<path fill="none" stroke="black" d="M549.26,-6575.59C536.42,-6566.31 521.71,-6555.68 508.21,-6545.92"/>
<polygon fill="black" stroke="black" points="510.14,-6543 499.99,-6539.98 506.04,-6548.68 510.14,-6543"/>
</g>
<!-- layer12_mlp_gelu&#45;&gt;layer12_mlp_multiply -->
<g id="edge271" class="edge">
<title>layer12_mlp_gelu&#45;&gt;layer12_mlp_multiply</title>
<path fill="none" stroke="black" d="M329.76,-6575.59C351.73,-6565.7 377.11,-6554.27 399.91,-6544"/>
<polygon fill="black" stroke="black" points="401.49,-6547.13 409.17,-6539.83 398.62,-6540.75 401.49,-6547.13"/>
</g>
<!-- layer12_mlp_down -->
<g id="node214" class="node">
<title>layer12_mlp_down</title>
<polygon fill="lightyellow" stroke="black" points="669.5,-6451.7 380.5,-6451.7 380.5,-6399.7 669.5,-6399.7 669.5,-6451.7"/>
<text text-anchor="middle" x="525" y="-6439.7" font-family="Arial" font-size="10.00">Layer 12 MLP Down Linear</text>
<text text-anchor="middle" x="525" y="-6428.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="525" y="-6417.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="525" y="-6406.7" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- layer12_mlp_multiply&#45;&gt;layer12_mlp_down -->
<g id="edge272" class="edge">
<title>layer12_mlp_multiply&#45;&gt;layer12_mlp_down</title>
<path fill="none" stroke="black" d="M482.68,-6487.36C488.6,-6478.87 495.29,-6469.28 501.58,-6460.26"/>
<polygon fill="black" stroke="black" points="504.6,-6462.06 507.45,-6451.85 498.86,-6458.05 504.6,-6462.06"/>
</g>
<!-- layer12_mlp_down&#45;&gt;layer12_residual2 -->
<g id="edge273" class="edge">
<title>layer12_mlp_down&#45;&gt;layer12_residual2</title>
<path fill="none" stroke="black" d="M538.24,-6399.56C542.81,-6390.88 548.14,-6380.76 553.52,-6370.56"/>
<polygon fill="black" stroke="black" points="556.67,-6372.09 558.23,-6361.61 550.47,-6368.83 556.67,-6372.09"/>
</g>
<!-- layer12_layernorm2 -->
<g id="node216" class="node">
<title>layer12_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="728.5,-6223.7 439.5,-6223.7 439.5,-6171.7 728.5,-6171.7 728.5,-6223.7"/>
<text text-anchor="middle" x="584" y="-6211.7" font-family="Arial" font-size="10.00">Layer 12 Layer Norm 2</text>
<text text-anchor="middle" x="584" y="-6200.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-6189.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="584" y="-6178.7" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- layer12_residual2&#45;&gt;layer12_layernorm2 -->
<g id="edge275" class="edge">
<title>layer12_residual2&#45;&gt;layer12_layernorm2</title>
<path fill="none" stroke="black" d="M584,-6259.61C584,-6250.95 584,-6242.12 584,-6233.98"/>
<polygon fill="black" stroke="black" points="587.5,-6233.74 584,-6223.74 580.5,-6233.74 587.5,-6233.74"/>
</g>
<!-- layer12_layernorm2&#45;&gt;layer12_transfer -->
<g id="edge276" class="edge">
<title>layer12_layernorm2&#45;&gt;layer12_transfer</title>
<path fill="none" stroke="black" d="M584,-6171.52C584,-6163.71 584,-6154.85 584,-6146.08"/>
<polygon fill="black" stroke="black" points="587.5,-6145.9 584,-6135.9 580.5,-6145.9 587.5,-6145.9"/>
</g>
<!-- layer13_transfer -->
<g id="node217" class="node">
<title>layer13_transfer</title>
<ellipse fill="gray" stroke="black" cx="595" cy="-4583.39" rx="209.11" ry="36.54"/>
<text text-anchor="middle" x="595" y="-4597.39" font-family="Arial" font-size="10.00">Layer 13 â†’ 14 Transfer</text>
<text text-anchor="middle" x="595" y="-4586.39" font-family="Arial" font-size="10.00">Transfer: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="595" y="-4575.39" font-family="Arial" font-size="10.00">From: GPU 12</text>
<text text-anchor="middle" x="595" y="-4564.39" font-family="Arial" font-size="10.00">To: GPU 13</text>
</g>
<!-- layer14_input -->
<g id="node236" class="node">
<title>layer14_input</title>
<polygon fill="lightyellow" stroke="black" points="894.74,-4492.62 417.92,-4492.62 295.26,-4388.62 772.08,-4388.62 894.74,-4492.62"/>
<text text-anchor="middle" x="595" y="-4454.62" font-family="Arial" font-size="10.00">Layer 14 Input</text>
<text text-anchor="middle" x="595" y="-4443.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="595" y="-4432.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="595" y="-4421.62" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- layer13_transfer&#45;&gt;layer14_input -->
<g id="edge300" class="edge">
<title>layer13_transfer&#45;&gt;layer14_input</title>
<path fill="none" stroke="black" d="M595,-4546.5C595,-4533.26 595,-4517.86 595,-4503.01"/>
<polygon fill="black" stroke="black" points="598.5,-4502.84 595,-4492.84 591.5,-4502.84 598.5,-4502.84"/>
</g>
<!-- layer13_mha_query -->
<g id="node219" class="node">
<title>layer13_mha_query</title>
<polygon fill="pink" stroke="black" points="403,-5868.16 107,-5868.16 107,-5816.16 403,-5816.16 403,-5868.16"/>
<text text-anchor="middle" x="255" y="-5856.16" font-family="Arial" font-size="10.00">Layer 13 MHA Query Linear</text>
<text text-anchor="middle" x="255" y="-5845.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="255" y="-5834.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_q=512]</text>
<text text-anchor="middle" x="255" y="-5823.16" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- layer13_input&#45;&gt;layer13_mha_query -->
<g id="edge278" class="edge">
<title>layer13_input&#45;&gt;layer13_mha_query</title>
<path fill="none" stroke="black" d="M433.94,-5904.07C401.05,-5892.88 367.39,-5881.42 338.26,-5871.5"/>
<polygon fill="black" stroke="black" points="339.16,-5868.11 328.57,-5868.2 336.9,-5874.74 339.16,-5868.11"/>
</g>
<!-- layer13_mha_key -->
<g id="node220" class="node">
<title>layer13_mha_key</title>
<polygon fill="pink" stroke="black" points="717,-5868.16 421,-5868.16 421,-5816.16 717,-5816.16 717,-5868.16"/>
<text text-anchor="middle" x="569" y="-5856.16" font-family="Arial" font-size="10.00">Layer 13 MHA Key Linear</text>
<text text-anchor="middle" x="569" y="-5845.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="569" y="-5834.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="569" y="-5823.16" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- layer13_input&#45;&gt;layer13_mha_key -->
<g id="edge279" class="edge">
<title>layer13_input&#45;&gt;layer13_mha_key</title>
<path fill="none" stroke="black" d="M577.16,-5904.07C575.98,-5895.31 574.79,-5886.39 573.69,-5878.17"/>
<polygon fill="black" stroke="black" points="577.15,-5877.65 572.35,-5868.2 570.21,-5878.58 577.15,-5877.65"/>
</g>
<!-- layer13_mha_value -->
<g id="node221" class="node">
<title>layer13_mha_value</title>
<polygon fill="pink" stroke="black" points="739,-5780.16 443,-5780.16 443,-5728.16 739,-5728.16 739,-5780.16"/>
<text text-anchor="middle" x="591" y="-5768.16" font-family="Arial" font-size="10.00">Layer 13 MHA Value Linear</text>
<text text-anchor="middle" x="591" y="-5757.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="591" y="-5746.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_v=512]</text>
<text text-anchor="middle" x="591" y="-5735.16" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- layer13_input&#45;&gt;layer13_mha_value -->
<g id="edge280" class="edge">
<title>layer13_input&#45;&gt;layer13_mha_value</title>
<path fill="none" stroke="black" d="M694.78,-5904.14C707.24,-5893.96 718.23,-5882.03 726,-5868.16 737.29,-5847.99 738.53,-5835.57 726,-5816.16 717.76,-5803.39 706.14,-5793.27 693.13,-5785.26"/>
<polygon fill="black" stroke="black" points="694.83,-5782.19 684.41,-5780.28 691.36,-5788.28 694.83,-5782.19"/>
</g>
<!-- layer13_residual1 -->
<g id="node226" class="node">
<title>layer13_residual1</title>
<polygon fill="lightblue" stroke="black" points="595,-5428.16 71,-5376.16 595,-5324.16 1119,-5376.16 595,-5428.16"/>
<text text-anchor="middle" x="595" y="-5390.16" font-family="Arial" font-size="10.00">Layer 13 Residual Add 1</text>
<text text-anchor="middle" x="595" y="-5379.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="595" y="-5368.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="595" y="-5357.16" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- layer13_input&#45;&gt;layer13_residual1 -->
<g id="edge288" class="edge">
<title>layer13_input&#45;&gt;layer13_residual1</title>
<path fill="none" stroke="black" d="M698.35,-5903.99C712.3,-5893.8 725.09,-5881.9 735,-5868.16 764.96,-5826.58 758,-5806.41 758,-5755.16 758,-5755.16 758,-5755.16 758,-5577.16 758,-5516.64 712.61,-5464.3 669.73,-5428.36"/>
<polygon fill="black" stroke="black" points="671.72,-5425.47 661.77,-5421.84 667.29,-5430.88 671.72,-5425.47"/>
</g>
<!-- layer13_mha_qkt -->
<g id="node222" class="node">
<title>layer13_mha_qkt</title>
<polygon fill="lightcoral" stroke="black" points="424.5,-5780.16 99.5,-5780.16 99.5,-5728.16 424.5,-5728.16 424.5,-5780.16"/>
<text text-anchor="middle" x="262" y="-5768.16" font-family="Arial" font-size="10.00">Layer 13 MHA QKT Calculation</text>
<text text-anchor="middle" x="262" y="-5757.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="262" y="-5746.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="262" y="-5735.16" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- layer13_mha_query&#45;&gt;layer13_mha_qkt -->
<g id="edge281" class="edge">
<title>layer13_mha_query&#45;&gt;layer13_mha_qkt</title>
<path fill="none" stroke="black" d="M257.06,-5815.82C257.71,-5807.86 258.44,-5798.92 259.13,-5790.4"/>
<polygon fill="black" stroke="black" points="262.63,-5790.56 259.95,-5780.31 255.65,-5790 262.63,-5790.56"/>
</g>
<!-- layer13_mha_key&#45;&gt;layer13_mha_qkt -->
<g id="edge282" class="edge">
<title>layer13_mha_key&#45;&gt;layer13_mha_qkt</title>
<path fill="none" stroke="black" d="M479.38,-5816.05C442.42,-5805.7 399.44,-5793.66 361.51,-5783.03"/>
<polygon fill="black" stroke="black" points="362.04,-5779.55 351.47,-5780.22 360.15,-5786.29 362.04,-5779.55"/>
</g>
<!-- layer13_mha_apply -->
<g id="node224" class="node">
<title>layer13_mha_apply</title>
<polygon fill="lightcoral" stroke="black" points="739,-5604.16 171,-5604.16 171,-5552.16 739,-5552.16 739,-5604.16"/>
<text text-anchor="middle" x="455" y="-5592.16" font-family="Arial" font-size="10.00">Layer 13 MHA Apply Attention</text>
<text text-anchor="middle" x="455" y="-5581.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000], [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="455" y="-5570.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="455" y="-5559.16" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- layer13_mha_value&#45;&gt;layer13_mha_apply -->
<g id="edge285" class="edge">
<title>layer13_mha_value&#45;&gt;layer13_mha_apply</title>
<path fill="none" stroke="black" d="M571.22,-5727.86C547.39,-5697.36 507.26,-5646.02 480.95,-5612.36"/>
<polygon fill="black" stroke="black" points="483.49,-5609.93 474.58,-5604.21 477.98,-5614.24 483.49,-5609.93"/>
</g>
<!-- layer13_mha_softmax -->
<g id="node223" class="node">
<title>layer13_mha_softmax</title>
<polygon fill="lightcoral" stroke="black" points="424.5,-5692.16 99.5,-5692.16 99.5,-5640.16 424.5,-5640.16 424.5,-5692.16"/>
<text text-anchor="middle" x="262" y="-5680.16" font-family="Arial" font-size="10.00">Layer 13 MHA Softmax</text>
<text text-anchor="middle" x="262" y="-5669.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="262" y="-5658.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="262" y="-5647.16" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- layer13_mha_qkt&#45;&gt;layer13_mha_softmax -->
<g id="edge283" class="edge">
<title>layer13_mha_qkt&#45;&gt;layer13_mha_softmax</title>
<path fill="none" stroke="black" d="M262,-5727.82C262,-5719.86 262,-5710.92 262,-5702.4"/>
<polygon fill="black" stroke="black" points="265.5,-5702.31 262,-5692.31 258.5,-5702.31 265.5,-5702.31"/>
</g>
<!-- layer13_mha_softmax&#45;&gt;layer13_mha_apply -->
<g id="edge284" class="edge">
<title>layer13_mha_softmax&#45;&gt;layer13_mha_apply</title>
<path fill="none" stroke="black" d="M318.34,-5640.05C340.54,-5630.16 366.19,-5618.73 389.23,-5608.46"/>
<polygon fill="black" stroke="black" points="390.88,-5611.56 398.59,-5604.29 388.03,-5605.17 390.88,-5611.56"/>
</g>
<!-- layer13_mha_out -->
<g id="node225" class="node">
<title>layer13_mha_out</title>
<polygon fill="pink" stroke="black" points="669.5,-5516.16 380.5,-5516.16 380.5,-5464.16 669.5,-5464.16 669.5,-5516.16"/>
<text text-anchor="middle" x="525" y="-5504.16" font-family="Arial" font-size="10.00">Layer 13 MHA Output Linear</text>
<text text-anchor="middle" x="525" y="-5493.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="525" y="-5482.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="525" y="-5471.16" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- layer13_mha_apply&#45;&gt;layer13_mha_out -->
<g id="edge286" class="edge">
<title>layer13_mha_apply&#45;&gt;layer13_mha_out</title>
<path fill="none" stroke="black" d="M475.62,-5551.82C482.67,-5543.16 490.66,-5533.34 498.13,-5524.17"/>
<polygon fill="black" stroke="black" points="500.93,-5526.28 504.52,-5516.31 495.5,-5521.86 500.93,-5526.28"/>
</g>
<!-- layer13_mha_out&#45;&gt;layer13_residual1 -->
<g id="edge287" class="edge">
<title>layer13_mha_out&#45;&gt;layer13_residual1</title>
<path fill="none" stroke="black" d="M540.71,-5464.02C546.25,-5455.15 552.73,-5444.78 559.25,-5434.36"/>
<polygon fill="black" stroke="black" points="562.38,-5435.95 564.71,-5425.62 556.44,-5432.24 562.38,-5435.95"/>
</g>
<!-- layer13_layernorm1 -->
<g id="node227" class="node">
<title>layer13_layernorm1</title>
<polygon fill="lightgreen" stroke="black" points="739.5,-5288.16 450.5,-5288.16 450.5,-5236.16 739.5,-5236.16 739.5,-5288.16"/>
<text text-anchor="middle" x="595" y="-5276.16" font-family="Arial" font-size="10.00">Layer 13 Layer Norm 1</text>
<text text-anchor="middle" x="595" y="-5265.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="595" y="-5254.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="595" y="-5243.16" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- layer13_residual1&#45;&gt;layer13_layernorm1 -->
<g id="edge289" class="edge">
<title>layer13_residual1&#45;&gt;layer13_layernorm1</title>
<path fill="none" stroke="black" d="M595,-5324.07C595,-5315.41 595,-5306.58 595,-5298.44"/>
<polygon fill="black" stroke="black" points="598.5,-5298.2 595,-5288.2 591.5,-5298.2 598.5,-5298.2"/>
</g>
<!-- layer13_mlp_gate -->
<g id="node228" class="node">
<title>layer13_mlp_gate</title>
<polygon fill="lightyellow" stroke="black" points="504,-5200.16 212,-5200.16 212,-5148.16 504,-5148.16 504,-5200.16"/>
<text text-anchor="middle" x="358" y="-5188.16" font-family="Arial" font-size="10.00">Layer 13 MLP Gate Linear</text>
<text text-anchor="middle" x="358" y="-5177.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="358" y="-5166.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="358" y="-5155.16" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- layer13_layernorm1&#45;&gt;layer13_mlp_gate -->
<g id="edge290" class="edge">
<title>layer13_layernorm1&#45;&gt;layer13_mlp_gate</title>
<path fill="none" stroke="black" d="M525.81,-5236.05C497.95,-5225.94 465.66,-5214.22 436.88,-5203.78"/>
<polygon fill="black" stroke="black" points="437.87,-5200.41 427.27,-5200.29 435.48,-5206.99 437.87,-5200.41"/>
</g>
<!-- layer13_mlp_up -->
<g id="node229" class="node">
<title>layer13_mlp_up</title>
<polygon fill="lightyellow" stroke="black" points="741,-5112.16 449,-5112.16 449,-5060.16 741,-5060.16 741,-5112.16"/>
<text text-anchor="middle" x="595" y="-5100.16" font-family="Arial" font-size="10.00">Layer 13 MLP Up Linear</text>
<text text-anchor="middle" x="595" y="-5089.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="595" y="-5078.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="595" y="-5067.16" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- layer13_layernorm1&#45;&gt;layer13_mlp_up -->
<g id="edge291" class="edge">
<title>layer13_layernorm1&#45;&gt;layer13_mlp_up</title>
<path fill="none" stroke="black" d="M595,-5235.86C595,-5206 595,-5156.18 595,-5122.52"/>
<polygon fill="black" stroke="black" points="598.5,-5122.21 595,-5112.21 591.5,-5122.21 598.5,-5122.21"/>
</g>
<!-- layer13_residual2 -->
<g id="node233" class="node">
<title>layer13_residual2</title>
<polygon fill="lightblue" stroke="black" points="595,-4848.16 71,-4796.16 595,-4744.16 1119,-4796.16 595,-4848.16"/>
<text text-anchor="middle" x="595" y="-4810.16" font-family="Arial" font-size="10.00">Layer 13 Residual Add 2</text>
<text text-anchor="middle" x="595" y="-4799.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="595" y="-4788.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="595" y="-4777.16" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- layer13_layernorm1&#45;&gt;layer13_residual2 -->
<g id="edge297" class="edge">
<title>layer13_layernorm1&#45;&gt;layer13_residual2</title>
<path fill="none" stroke="black" d="M644.06,-5236.08C692.7,-5207.32 760,-5155.22 760,-5087.16 760,-5087.16 760,-5087.16 760,-4997.16 760,-4936.22 713.86,-4883.8 670.38,-4847.94"/>
<polygon fill="black" stroke="black" points="672.57,-4845.21 662.59,-4841.66 668.18,-4850.66 672.57,-4845.21"/>
</g>
<!-- layer13_mlp_gelu -->
<g id="node230" class="node">
<title>layer13_mlp_gelu</title>
<polygon fill="orange" stroke="black" points="431,-5112.16 139,-5112.16 139,-5060.16 431,-5060.16 431,-5112.16"/>
<text text-anchor="middle" x="285" y="-5100.16" font-family="Arial" font-size="10.00">Layer 13 MLP GELU</text>
<text text-anchor="middle" x="285" y="-5089.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="285" y="-5078.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="285" y="-5067.16" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- layer13_mlp_gate&#45;&gt;layer13_mlp_gelu -->
<g id="edge292" class="edge">
<title>layer13_mlp_gate&#45;&gt;layer13_mlp_gelu</title>
<path fill="none" stroke="black" d="M336.49,-5147.82C329.14,-5139.16 320.81,-5129.34 313.02,-5120.17"/>
<polygon fill="black" stroke="black" points="315.49,-5117.67 306.35,-5112.31 310.16,-5122.2 315.49,-5117.67"/>
</g>
<!-- layer13_mlp_multiply -->
<g id="node231" class="node">
<title>layer13_mlp_multiply</title>
<polygon fill="orange" stroke="black" points="741,-5024.16 211,-5024.16 211,-4972.16 741,-4972.16 741,-5024.16"/>
<text text-anchor="middle" x="476" y="-5012.16" font-family="Arial" font-size="10.00">Layer 13 MLP Element&#45;wise Multiply</text>
<text text-anchor="middle" x="476" y="-5001.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768], [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="476" y="-4990.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="476" y="-4979.16" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- layer13_mlp_up&#45;&gt;layer13_mlp_multiply -->
<g id="edge293" class="edge">
<title>layer13_mlp_up&#45;&gt;layer13_mlp_multiply</title>
<path fill="none" stroke="black" d="M560.26,-5060.05C547.42,-5050.77 532.71,-5040.14 519.21,-5030.38"/>
<polygon fill="black" stroke="black" points="521.14,-5027.46 510.99,-5024.44 517.04,-5033.14 521.14,-5027.46"/>
</g>
<!-- layer13_mlp_gelu&#45;&gt;layer13_mlp_multiply -->
<g id="edge294" class="edge">
<title>layer13_mlp_gelu&#45;&gt;layer13_mlp_multiply</title>
<path fill="none" stroke="black" d="M340.76,-5060.05C362.73,-5050.16 388.11,-5038.73 410.91,-5028.46"/>
<polygon fill="black" stroke="black" points="412.49,-5031.59 420.17,-5024.29 409.62,-5025.21 412.49,-5031.59"/>
</g>
<!-- layer13_mlp_down -->
<g id="node232" class="node">
<title>layer13_mlp_down</title>
<polygon fill="lightyellow" stroke="black" points="679.5,-4936.16 390.5,-4936.16 390.5,-4884.16 679.5,-4884.16 679.5,-4936.16"/>
<text text-anchor="middle" x="535" y="-4924.16" font-family="Arial" font-size="10.00">Layer 13 MLP Down Linear</text>
<text text-anchor="middle" x="535" y="-4913.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="535" y="-4902.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="535" y="-4891.16" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- layer13_mlp_multiply&#45;&gt;layer13_mlp_down -->
<g id="edge295" class="edge">
<title>layer13_mlp_multiply&#45;&gt;layer13_mlp_down</title>
<path fill="none" stroke="black" d="M493.38,-4971.82C499.2,-4963.33 505.79,-4953.74 511.97,-4944.72"/>
<polygon fill="black" stroke="black" points="514.97,-4946.54 517.74,-4936.31 509.2,-4942.58 514.97,-4946.54"/>
</g>
<!-- layer13_mlp_down&#45;&gt;layer13_residual2 -->
<g id="edge296" class="edge">
<title>layer13_mlp_down&#45;&gt;layer13_residual2</title>
<path fill="none" stroke="black" d="M548.47,-4884.02C553.17,-4875.24 558.66,-4864.99 564.19,-4854.67"/>
<polygon fill="black" stroke="black" points="567.4,-4856.09 569.04,-4845.62 561.23,-4852.78 567.4,-4856.09"/>
</g>
<!-- layer13_layernorm2 -->
<g id="node234" class="node">
<title>layer13_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="739.5,-4708.16 450.5,-4708.16 450.5,-4656.16 739.5,-4656.16 739.5,-4708.16"/>
<text text-anchor="middle" x="595" y="-4696.16" font-family="Arial" font-size="10.00">Layer 13 Layer Norm 2</text>
<text text-anchor="middle" x="595" y="-4685.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="595" y="-4674.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="595" y="-4663.16" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- layer13_residual2&#45;&gt;layer13_layernorm2 -->
<g id="edge298" class="edge">
<title>layer13_residual2&#45;&gt;layer13_layernorm2</title>
<path fill="none" stroke="black" d="M595,-4744.07C595,-4735.41 595,-4726.58 595,-4718.44"/>
<polygon fill="black" stroke="black" points="598.5,-4718.2 595,-4708.2 591.5,-4718.2 598.5,-4718.2"/>
</g>
<!-- layer13_layernorm2&#45;&gt;layer13_transfer -->
<g id="edge299" class="edge">
<title>layer13_layernorm2&#45;&gt;layer13_transfer</title>
<path fill="none" stroke="black" d="M595,-4655.98C595,-4648.18 595,-4639.31 595,-4630.54"/>
<polygon fill="black" stroke="black" points="598.5,-4630.36 595,-4620.36 591.5,-4630.36 598.5,-4630.36"/>
</g>
<!-- layer14_transfer -->
<g id="node235" class="node">
<title>layer14_transfer</title>
<ellipse fill="gray" stroke="black" cx="559" cy="-3067.85" rx="209.11" ry="36.54"/>
<text text-anchor="middle" x="559" y="-3081.85" font-family="Arial" font-size="10.00">Layer 14 â†’ 15 Transfer</text>
<text text-anchor="middle" x="559" y="-3070.85" font-family="Arial" font-size="10.00">Transfer: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-3059.85" font-family="Arial" font-size="10.00">From: GPU 13</text>
<text text-anchor="middle" x="559" y="-3048.85" font-family="Arial" font-size="10.00">To: GPU 14</text>
</g>
<!-- layer15_input -->
<g id="node254" class="node">
<title>layer15_input</title>
<polygon fill="lightyellow" stroke="black" points="858.74,-2977.08 381.92,-2977.08 259.26,-2873.08 736.08,-2873.08 858.74,-2977.08"/>
<text text-anchor="middle" x="559" y="-2939.08" font-family="Arial" font-size="10.00">Layer 15 Input</text>
<text text-anchor="middle" x="559" y="-2928.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-2917.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-2906.08" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- layer14_transfer&#45;&gt;layer15_input -->
<g id="edge323" class="edge">
<title>layer14_transfer&#45;&gt;layer15_input</title>
<path fill="none" stroke="black" d="M559,-3030.96C559,-3017.72 559,-3002.32 559,-2987.47"/>
<polygon fill="black" stroke="black" points="562.5,-2987.3 559,-2977.3 555.5,-2987.3 562.5,-2987.3"/>
</g>
<!-- layer14_mha_query -->
<g id="node237" class="node">
<title>layer14_mha_query</title>
<polygon fill="pink" stroke="black" points="335,-4352.62 39,-4352.62 39,-4300.62 335,-4300.62 335,-4352.62"/>
<text text-anchor="middle" x="187" y="-4340.62" font-family="Arial" font-size="10.00">Layer 14 MHA Query Linear</text>
<text text-anchor="middle" x="187" y="-4329.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="187" y="-4318.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_q=512]</text>
<text text-anchor="middle" x="187" y="-4307.62" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- layer14_input&#45;&gt;layer14_mha_query -->
<g id="edge301" class="edge">
<title>layer14_input&#45;&gt;layer14_mha_query</title>
<path fill="none" stroke="black" d="M409.21,-4388.62C367.4,-4377.14 324.57,-4365.38 287.81,-4355.29"/>
<polygon fill="black" stroke="black" points="288.68,-4351.9 278.11,-4352.63 286.82,-4358.65 288.68,-4351.9"/>
</g>
<!-- layer14_mha_key -->
<g id="node238" class="node">
<title>layer14_mha_key</title>
<polygon fill="pink" stroke="black" points="649,-4352.62 353,-4352.62 353,-4300.62 649,-4300.62 649,-4352.62"/>
<text text-anchor="middle" x="501" y="-4340.62" font-family="Arial" font-size="10.00">Layer 14 MHA Key Linear</text>
<text text-anchor="middle" x="501" y="-4329.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="501" y="-4318.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="501" y="-4307.62" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- layer14_input&#45;&gt;layer14_mha_key -->
<g id="edge302" class="edge">
<title>layer14_input&#45;&gt;layer14_mha_key</title>
<path fill="none" stroke="black" d="M552.13,-4388.53C544.12,-4378.99 535.95,-4369.26 528.56,-4360.45"/>
<polygon fill="black" stroke="black" points="531.13,-4358.07 522.02,-4352.66 525.77,-4362.57 531.13,-4358.07"/>
</g>
<!-- layer14_mha_value -->
<g id="node239" class="node">
<title>layer14_mha_value</title>
<polygon fill="pink" stroke="black" points="745,-4264.62 449,-4264.62 449,-4212.62 745,-4212.62 745,-4264.62"/>
<text text-anchor="middle" x="597" y="-4252.62" font-family="Arial" font-size="10.00">Layer 14 MHA Value Linear</text>
<text text-anchor="middle" x="597" y="-4241.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="597" y="-4230.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_v=512]</text>
<text text-anchor="middle" x="597" y="-4219.62" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- layer14_input&#45;&gt;layer14_mha_value -->
<g id="edge303" class="edge">
<title>layer14_input&#45;&gt;layer14_mha_value</title>
<path fill="none" stroke="black" d="M640.07,-4388.24C647.44,-4377.17 653.98,-4365.04 658,-4352.62 665.12,-4330.63 666.84,-4321.97 658,-4300.62 653.61,-4290.02 646.39,-4280.31 638.43,-4271.9"/>
<polygon fill="black" stroke="black" points="640.86,-4269.38 631.29,-4264.85 635.94,-4274.36 640.86,-4269.38"/>
</g>
<!-- layer14_residual1 -->
<g id="node244" class="node">
<title>layer14_residual1</title>
<polygon fill="lightblue" stroke="black" points="559,-3912.62 35,-3860.62 559,-3808.62 1083,-3860.62 559,-3912.62"/>
<text text-anchor="middle" x="559" y="-3874.62" font-family="Arial" font-size="10.00">Layer 14 Residual Add 1</text>
<text text-anchor="middle" x="559" y="-3863.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-3852.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-3841.62" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- layer14_input&#45;&gt;layer14_residual1 -->
<g id="edge311" class="edge">
<title>layer14_input&#45;&gt;layer14_residual1</title>
<path fill="none" stroke="black" d="M673.07,-4388.55C717.35,-4352.86 764,-4300.76 764,-4239.62 764,-4239.62 764,-4239.62 764,-4061.62 764,-3995.07 707.97,-3943.44 654.49,-3909.32"/>
<polygon fill="black" stroke="black" points="656.28,-3906.31 645.94,-3903.99 652.58,-3912.25 656.28,-3906.31"/>
</g>
<!-- layer14_mha_qkt -->
<g id="node240" class="node">
<title>layer14_mha_qkt</title>
<polygon fill="lightcoral" stroke="black" points="430.5,-4264.62 105.5,-4264.62 105.5,-4212.62 430.5,-4212.62 430.5,-4264.62"/>
<text text-anchor="middle" x="268" y="-4252.62" font-family="Arial" font-size="10.00">Layer 14 MHA QKT Calculation</text>
<text text-anchor="middle" x="268" y="-4241.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="268" y="-4230.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="268" y="-4219.62" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- layer14_mha_query&#45;&gt;layer14_mha_qkt -->
<g id="edge304" class="edge">
<title>layer14_mha_query&#45;&gt;layer14_mha_qkt</title>
<path fill="none" stroke="black" d="M210.86,-4300.28C219.19,-4291.44 228.64,-4281.4 237.43,-4272.07"/>
<polygon fill="black" stroke="black" points="240,-4274.45 244.31,-4264.77 234.9,-4269.65 240,-4274.45"/>
</g>
<!-- layer14_mha_key&#45;&gt;layer14_mha_qkt -->
<g id="edge305" class="edge">
<title>layer14_mha_key&#45;&gt;layer14_mha_qkt</title>
<path fill="none" stroke="black" d="M432.98,-4300.51C405.59,-4290.4 373.84,-4278.68 345.55,-4268.24"/>
<polygon fill="black" stroke="black" points="346.7,-4264.93 336.1,-4264.75 344.27,-4271.5 346.7,-4264.93"/>
</g>
<!-- layer14_mha_apply -->
<g id="node242" class="node">
<title>layer14_mha_apply</title>
<polygon fill="lightcoral" stroke="black" points="745,-4088.62 177,-4088.62 177,-4036.62 745,-4036.62 745,-4088.62"/>
<text text-anchor="middle" x="461" y="-4076.62" font-family="Arial" font-size="10.00">Layer 14 MHA Apply Attention</text>
<text text-anchor="middle" x="461" y="-4065.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000], [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="461" y="-4054.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="461" y="-4043.62" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- layer14_mha_value&#45;&gt;layer14_mha_apply -->
<g id="edge308" class="edge">
<title>layer14_mha_value&#45;&gt;layer14_mha_apply</title>
<path fill="none" stroke="black" d="M577.22,-4212.32C553.39,-4181.82 513.26,-4130.48 486.95,-4096.82"/>
<polygon fill="black" stroke="black" points="489.49,-4094.39 480.58,-4088.67 483.98,-4098.7 489.49,-4094.39"/>
</g>
<!-- layer14_mha_softmax -->
<g id="node241" class="node">
<title>layer14_mha_softmax</title>
<polygon fill="lightcoral" stroke="black" points="470.5,-4176.62 145.5,-4176.62 145.5,-4124.62 470.5,-4124.62 470.5,-4176.62"/>
<text text-anchor="middle" x="308" y="-4164.62" font-family="Arial" font-size="10.00">Layer 14 MHA Softmax</text>
<text text-anchor="middle" x="308" y="-4153.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="308" y="-4142.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="308" y="-4131.62" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- layer14_mha_qkt&#45;&gt;layer14_mha_softmax -->
<g id="edge306" class="edge">
<title>layer14_mha_qkt&#45;&gt;layer14_mha_softmax</title>
<path fill="none" stroke="black" d="M279.78,-4212.28C283.61,-4204.06 287.92,-4194.79 292,-4186.02"/>
<polygon fill="black" stroke="black" points="295.26,-4187.32 296.3,-4176.77 288.91,-4184.37 295.26,-4187.32"/>
</g>
<!-- layer14_mha_softmax&#45;&gt;layer14_mha_apply -->
<g id="edge307" class="edge">
<title>layer14_mha_softmax&#45;&gt;layer14_mha_apply</title>
<path fill="none" stroke="black" d="M352.67,-4124.51C369.72,-4114.93 389.33,-4103.9 407.15,-4093.89"/>
<polygon fill="black" stroke="black" points="409.28,-4096.71 416.28,-4088.75 405.85,-4090.6 409.28,-4096.71"/>
</g>
<!-- layer14_mha_out -->
<g id="node243" class="node">
<title>layer14_mha_out</title>
<polygon fill="pink" stroke="black" points="654.5,-4000.62 365.5,-4000.62 365.5,-3948.62 654.5,-3948.62 654.5,-4000.62"/>
<text text-anchor="middle" x="510" y="-3988.62" font-family="Arial" font-size="10.00">Layer 14 MHA Output Linear</text>
<text text-anchor="middle" x="510" y="-3977.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="510" y="-3966.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="510" y="-3955.62" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- layer14_mha_apply&#45;&gt;layer14_mha_out -->
<g id="edge309" class="edge">
<title>layer14_mha_apply&#45;&gt;layer14_mha_out</title>
<path fill="none" stroke="black" d="M475.44,-4036.28C480.17,-4027.97 485.51,-4018.59 490.56,-4009.74"/>
<polygon fill="black" stroke="black" points="493.76,-4011.2 495.67,-4000.77 487.68,-4007.73 493.76,-4011.2"/>
</g>
<!-- layer14_mha_out&#45;&gt;layer14_residual1 -->
<g id="edge310" class="edge">
<title>layer14_mha_out&#45;&gt;layer14_residual1</title>
<path fill="none" stroke="black" d="M521,-3948.48C524.76,-3939.89 529.13,-3929.89 533.55,-3919.79"/>
<polygon fill="black" stroke="black" points="536.8,-3921.1 537.6,-3910.53 530.38,-3918.29 536.8,-3921.1"/>
</g>
<!-- layer14_layernorm1 -->
<g id="node245" class="node">
<title>layer14_layernorm1</title>
<polygon fill="lightgreen" stroke="black" points="703.5,-3772.62 414.5,-3772.62 414.5,-3720.62 703.5,-3720.62 703.5,-3772.62"/>
<text text-anchor="middle" x="559" y="-3760.62" font-family="Arial" font-size="10.00">Layer 14 Layer Norm 1</text>
<text text-anchor="middle" x="559" y="-3749.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-3738.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-3727.62" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- layer14_residual1&#45;&gt;layer14_layernorm1 -->
<g id="edge312" class="edge">
<title>layer14_residual1&#45;&gt;layer14_layernorm1</title>
<path fill="none" stroke="black" d="M559,-3808.53C559,-3799.87 559,-3791.05 559,-3782.9"/>
<polygon fill="black" stroke="black" points="562.5,-3782.66 559,-3772.66 555.5,-3782.66 562.5,-3782.66"/>
</g>
<!-- layer14_mlp_gate -->
<g id="node246" class="node">
<title>layer14_mlp_gate</title>
<polygon fill="lightyellow" stroke="black" points="468,-3684.62 176,-3684.62 176,-3632.62 468,-3632.62 468,-3684.62"/>
<text text-anchor="middle" x="322" y="-3672.62" font-family="Arial" font-size="10.00">Layer 14 MLP Gate Linear</text>
<text text-anchor="middle" x="322" y="-3661.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="322" y="-3650.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="322" y="-3639.62" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- layer14_layernorm1&#45;&gt;layer14_mlp_gate -->
<g id="edge313" class="edge">
<title>layer14_layernorm1&#45;&gt;layer14_mlp_gate</title>
<path fill="none" stroke="black" d="M489.81,-3720.51C461.95,-3710.4 429.66,-3698.68 400.88,-3688.24"/>
<polygon fill="black" stroke="black" points="401.87,-3684.88 391.27,-3684.75 399.48,-3691.46 401.87,-3684.88"/>
</g>
<!-- layer14_mlp_up -->
<g id="node247" class="node">
<title>layer14_mlp_up</title>
<polygon fill="lightyellow" stroke="black" points="705,-3596.62 413,-3596.62 413,-3544.62 705,-3544.62 705,-3596.62"/>
<text text-anchor="middle" x="559" y="-3584.62" font-family="Arial" font-size="10.00">Layer 14 MLP Up Linear</text>
<text text-anchor="middle" x="559" y="-3573.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-3562.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="559" y="-3551.62" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- layer14_layernorm1&#45;&gt;layer14_mlp_up -->
<g id="edge314" class="edge">
<title>layer14_layernorm1&#45;&gt;layer14_mlp_up</title>
<path fill="none" stroke="black" d="M559,-3720.32C559,-3690.46 559,-3640.64 559,-3606.98"/>
<polygon fill="black" stroke="black" points="562.5,-3606.67 559,-3596.67 555.5,-3606.67 562.5,-3606.67"/>
</g>
<!-- layer14_residual2 -->
<g id="node251" class="node">
<title>layer14_residual2</title>
<polygon fill="lightblue" stroke="black" points="559,-3332.62 35,-3280.62 559,-3228.62 1083,-3280.62 559,-3332.62"/>
<text text-anchor="middle" x="559" y="-3294.62" font-family="Arial" font-size="10.00">Layer 14 Residual Add 2</text>
<text text-anchor="middle" x="559" y="-3283.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-3272.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-3261.62" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- layer14_layernorm1&#45;&gt;layer14_residual2 -->
<g id="edge320" class="edge">
<title>layer14_layernorm1&#45;&gt;layer14_residual2</title>
<path fill="none" stroke="black" d="M608.06,-3720.54C656.7,-3691.78 724,-3639.68 724,-3571.62 724,-3571.62 724,-3571.62 724,-3481.62 724,-3420.68 677.86,-3368.27 634.38,-3332.4"/>
<polygon fill="black" stroke="black" points="636.57,-3329.67 626.59,-3326.12 632.18,-3335.12 636.57,-3329.67"/>
</g>
<!-- layer14_mlp_gelu -->
<g id="node248" class="node">
<title>layer14_mlp_gelu</title>
<polygon fill="orange" stroke="black" points="395,-3596.62 103,-3596.62 103,-3544.62 395,-3544.62 395,-3596.62"/>
<text text-anchor="middle" x="249" y="-3584.62" font-family="Arial" font-size="10.00">Layer 14 MLP GELU</text>
<text text-anchor="middle" x="249" y="-3573.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="249" y="-3562.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="249" y="-3551.62" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- layer14_mlp_gate&#45;&gt;layer14_mlp_gelu -->
<g id="edge315" class="edge">
<title>layer14_mlp_gate&#45;&gt;layer14_mlp_gelu</title>
<path fill="none" stroke="black" d="M300.49,-3632.28C293.14,-3623.62 284.81,-3613.8 277.02,-3604.63"/>
<polygon fill="black" stroke="black" points="279.49,-3602.13 270.35,-3596.77 274.16,-3606.66 279.49,-3602.13"/>
</g>
<!-- layer14_mlp_multiply -->
<g id="node249" class="node">
<title>layer14_mlp_multiply</title>
<polygon fill="orange" stroke="black" points="705,-3508.62 175,-3508.62 175,-3456.62 705,-3456.62 705,-3508.62"/>
<text text-anchor="middle" x="440" y="-3496.62" font-family="Arial" font-size="10.00">Layer 14 MLP Element&#45;wise Multiply</text>
<text text-anchor="middle" x="440" y="-3485.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768], [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="440" y="-3474.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="440" y="-3463.62" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- layer14_mlp_up&#45;&gt;layer14_mlp_multiply -->
<g id="edge316" class="edge">
<title>layer14_mlp_up&#45;&gt;layer14_mlp_multiply</title>
<path fill="none" stroke="black" d="M524.26,-3544.51C511.42,-3535.23 496.71,-3524.6 483.21,-3514.84"/>
<polygon fill="black" stroke="black" points="485.14,-3511.92 474.99,-3508.9 481.04,-3517.6 485.14,-3511.92"/>
</g>
<!-- layer14_mlp_gelu&#45;&gt;layer14_mlp_multiply -->
<g id="edge317" class="edge">
<title>layer14_mlp_gelu&#45;&gt;layer14_mlp_multiply</title>
<path fill="none" stroke="black" d="M304.76,-3544.51C326.73,-3534.62 352.11,-3523.19 374.91,-3512.92"/>
<polygon fill="black" stroke="black" points="376.49,-3516.05 384.17,-3508.75 373.62,-3509.67 376.49,-3516.05"/>
</g>
<!-- layer14_mlp_down -->
<g id="node250" class="node">
<title>layer14_mlp_down</title>
<polygon fill="lightyellow" stroke="black" points="644.5,-3420.62 355.5,-3420.62 355.5,-3368.62 644.5,-3368.62 644.5,-3420.62"/>
<text text-anchor="middle" x="500" y="-3408.62" font-family="Arial" font-size="10.00">Layer 14 MLP Down Linear</text>
<text text-anchor="middle" x="500" y="-3397.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="500" y="-3386.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="500" y="-3375.62" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- layer14_mlp_multiply&#45;&gt;layer14_mlp_down -->
<g id="edge318" class="edge">
<title>layer14_mlp_multiply&#45;&gt;layer14_mlp_down</title>
<path fill="none" stroke="black" d="M457.68,-3456.28C463.6,-3447.79 470.29,-3438.2 476.58,-3429.18"/>
<polygon fill="black" stroke="black" points="479.6,-3430.98 482.45,-3420.77 473.86,-3426.97 479.6,-3430.98"/>
</g>
<!-- layer14_mlp_down&#45;&gt;layer14_residual2 -->
<g id="edge319" class="edge">
<title>layer14_mlp_down&#45;&gt;layer14_residual2</title>
<path fill="none" stroke="black" d="M513.24,-3368.48C517.81,-3359.8 523.14,-3349.68 528.52,-3339.48"/>
<polygon fill="black" stroke="black" points="531.67,-3341.01 533.23,-3330.53 525.47,-3337.75 531.67,-3341.01"/>
</g>
<!-- layer14_layernorm2 -->
<g id="node252" class="node">
<title>layer14_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="703.5,-3192.62 414.5,-3192.62 414.5,-3140.62 703.5,-3140.62 703.5,-3192.62"/>
<text text-anchor="middle" x="559" y="-3180.62" font-family="Arial" font-size="10.00">Layer 14 Layer Norm 2</text>
<text text-anchor="middle" x="559" y="-3169.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-3158.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-3147.62" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- layer14_residual2&#45;&gt;layer14_layernorm2 -->
<g id="edge321" class="edge">
<title>layer14_residual2&#45;&gt;layer14_layernorm2</title>
<path fill="none" stroke="black" d="M559,-3228.53C559,-3219.87 559,-3211.05 559,-3202.9"/>
<polygon fill="black" stroke="black" points="562.5,-3202.66 559,-3192.66 555.5,-3202.66 562.5,-3202.66"/>
</g>
<!-- layer14_layernorm2&#45;&gt;layer14_transfer -->
<g id="edge322" class="edge">
<title>layer14_layernorm2&#45;&gt;layer14_transfer</title>
<path fill="none" stroke="black" d="M559,-3140.44C559,-3132.64 559,-3123.77 559,-3115"/>
<polygon fill="black" stroke="black" points="562.5,-3114.82 559,-3104.82 555.5,-3114.82 562.5,-3114.82"/>
</g>
<!-- layer15_transfer -->
<g id="node253" class="node">
<title>layer15_transfer</title>
<ellipse fill="gray" stroke="black" cx="540" cy="-1552.31" rx="209.11" ry="36.54"/>
<text text-anchor="middle" x="540" y="-1566.31" font-family="Arial" font-size="10.00">Layer 15 â†’ 16 Transfer</text>
<text text-anchor="middle" x="540" y="-1555.31" font-family="Arial" font-size="10.00">Transfer: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-1544.31" font-family="Arial" font-size="10.00">From: GPU 14</text>
<text text-anchor="middle" x="540" y="-1533.31" font-family="Arial" font-size="10.00">To: GPU 15</text>
</g>
<!-- layer16_input -->
<g id="node271" class="node">
<title>layer16_input</title>
<polygon fill="lightyellow" stroke="black" points="839.74,-1461.54 362.92,-1461.54 240.26,-1357.54 717.08,-1357.54 839.74,-1461.54"/>
<text text-anchor="middle" x="540" y="-1423.54" font-family="Arial" font-size="10.00">Layer 16 Input</text>
<text text-anchor="middle" x="540" y="-1412.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-1401.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-1390.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- layer15_transfer&#45;&gt;layer16_input -->
<g id="edge346" class="edge">
<title>layer15_transfer&#45;&gt;layer16_input</title>
<path fill="none" stroke="black" d="M540,-1515.42C540,-1502.19 540,-1486.79 540,-1471.93"/>
<polygon fill="black" stroke="black" points="543.5,-1471.76 540,-1461.76 536.5,-1471.76 543.5,-1471.76"/>
</g>
<!-- layer15_mha_query -->
<g id="node255" class="node">
<title>layer15_mha_query</title>
<polygon fill="pink" stroke="black" points="331,-2837.08 35,-2837.08 35,-2785.08 331,-2785.08 331,-2837.08"/>
<text text-anchor="middle" x="183" y="-2825.08" font-family="Arial" font-size="10.00">Layer 15 MHA Query Linear</text>
<text text-anchor="middle" x="183" y="-2814.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="183" y="-2803.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_q=512]</text>
<text text-anchor="middle" x="183" y="-2792.08" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- layer15_input&#45;&gt;layer15_mha_query -->
<g id="edge324" class="edge">
<title>layer15_input&#45;&gt;layer15_mha_query</title>
<path fill="none" stroke="black" d="M387.78,-2873.08C349.67,-2861.72 310.64,-2850.1 277.01,-2840.08"/>
<polygon fill="black" stroke="black" points="277.79,-2836.66 267.21,-2837.16 275.79,-2843.37 277.79,-2836.66"/>
</g>
<!-- layer15_mha_key -->
<g id="node256" class="node">
<title>layer15_mha_key</title>
<polygon fill="pink" stroke="black" points="645,-2837.08 349,-2837.08 349,-2785.08 645,-2785.08 645,-2837.08"/>
<text text-anchor="middle" x="497" y="-2825.08" font-family="Arial" font-size="10.00">Layer 15 MHA Key Linear</text>
<text text-anchor="middle" x="497" y="-2814.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="497" y="-2803.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="497" y="-2792.08" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- layer15_input&#45;&gt;layer15_mha_key -->
<g id="edge325" class="edge">
<title>layer15_input&#45;&gt;layer15_mha_key</title>
<path fill="none" stroke="black" d="M530.72,-2872.99C525.66,-2863.84 520.49,-2854.51 515.78,-2846"/>
<polygon fill="black" stroke="black" points="518.77,-2844.18 510.86,-2837.12 512.64,-2847.57 518.77,-2844.18"/>
</g>
<!-- layer15_mha_value -->
<g id="node257" class="node">
<title>layer15_mha_value</title>
<polygon fill="pink" stroke="black" points="669,-2749.08 373,-2749.08 373,-2697.08 669,-2697.08 669,-2749.08"/>
<text text-anchor="middle" x="521" y="-2737.08" font-family="Arial" font-size="10.00">Layer 15 MHA Value Linear</text>
<text text-anchor="middle" x="521" y="-2726.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="521" y="-2715.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_v=512]</text>
<text text-anchor="middle" x="521" y="-2704.08" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- layer15_input&#45;&gt;layer15_mha_value -->
<g id="edge326" class="edge">
<title>layer15_input&#45;&gt;layer15_mha_value</title>
<path fill="none" stroke="black" d="M626.98,-2873.07C653.25,-2846.99 672.94,-2814.6 654,-2785.08 645.79,-2772.27 634.14,-2762.12 621.11,-2754.08"/>
<polygon fill="black" stroke="black" points="622.79,-2751.01 612.37,-2749.1 619.32,-2757.09 622.79,-2751.01"/>
</g>
<!-- layer15_residual1 -->
<g id="node262" class="node">
<title>layer15_residual1</title>
<polygon fill="lightblue" stroke="black" points="540,-2397.08 16,-2345.08 540,-2293.08 1064,-2345.08 540,-2397.08"/>
<text text-anchor="middle" x="540" y="-2359.08" font-family="Arial" font-size="10.00">Layer 15 Residual Add 1</text>
<text text-anchor="middle" x="540" y="-2348.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-2337.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-2326.08" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- layer15_input&#45;&gt;layer15_residual1 -->
<g id="edge334" class="edge">
<title>layer15_input&#45;&gt;layer15_residual1</title>
<path fill="none" stroke="black" d="M631.96,-2872.99C643.37,-2862.25 654.02,-2850.17 662,-2837.08 688.84,-2793.08 688,-2775.61 688,-2724.08 688,-2724.08 688,-2724.08 688,-2546.08 688,-2487.56 646.56,-2434.97 607.53,-2398.42"/>
<polygon fill="black" stroke="black" points="609.51,-2395.49 599.77,-2391.33 604.79,-2400.66 609.51,-2395.49"/>
</g>
<!-- layer15_mha_qkt -->
<g id="node258" class="node">
<title>layer15_mha_qkt</title>
<polygon fill="lightcoral" stroke="black" points="354.5,-2749.08 29.5,-2749.08 29.5,-2697.08 354.5,-2697.08 354.5,-2749.08"/>
<text text-anchor="middle" x="192" y="-2737.08" font-family="Arial" font-size="10.00">Layer 15 MHA QKT Calculation</text>
<text text-anchor="middle" x="192" y="-2726.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="192" y="-2715.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="192" y="-2704.08" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- layer15_mha_query&#45;&gt;layer15_mha_qkt -->
<g id="edge327" class="edge">
<title>layer15_mha_query&#45;&gt;layer15_mha_qkt</title>
<path fill="none" stroke="black" d="M185.65,-2784.74C186.48,-2776.78 187.42,-2767.84 188.31,-2759.32"/>
<polygon fill="black" stroke="black" points="191.81,-2759.54 189.37,-2749.23 184.85,-2758.82 191.81,-2759.54"/>
</g>
<!-- layer15_mha_key&#45;&gt;layer15_mha_qkt -->
<g id="edge328" class="edge">
<title>layer15_mha_key&#45;&gt;layer15_mha_qkt</title>
<path fill="none" stroke="black" d="M407.96,-2784.97C371.24,-2774.62 328.55,-2762.58 290.86,-2751.95"/>
<polygon fill="black" stroke="black" points="291.46,-2748.49 280.89,-2749.14 289.56,-2755.22 291.46,-2748.49"/>
</g>
<!-- layer15_mha_apply -->
<g id="node260" class="node">
<title>layer15_mha_apply</title>
<polygon fill="lightcoral" stroke="black" points="669,-2573.08 101,-2573.08 101,-2521.08 669,-2521.08 669,-2573.08"/>
<text text-anchor="middle" x="385" y="-2561.08" font-family="Arial" font-size="10.00">Layer 15 MHA Apply Attention</text>
<text text-anchor="middle" x="385" y="-2550.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000], [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="385" y="-2539.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="385" y="-2528.08" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- layer15_mha_value&#45;&gt;layer15_mha_apply -->
<g id="edge331" class="edge">
<title>layer15_mha_value&#45;&gt;layer15_mha_apply</title>
<path fill="none" stroke="black" d="M501.22,-2696.78C477.39,-2666.28 437.26,-2614.94 410.95,-2581.28"/>
<polygon fill="black" stroke="black" points="413.49,-2578.85 404.58,-2573.13 407.98,-2583.16 413.49,-2578.85"/>
</g>
<!-- layer15_mha_softmax -->
<g id="node259" class="node">
<title>layer15_mha_softmax</title>
<polygon fill="lightcoral" stroke="black" points="394.5,-2661.08 69.5,-2661.08 69.5,-2609.08 394.5,-2609.08 394.5,-2661.08"/>
<text text-anchor="middle" x="232" y="-2649.08" font-family="Arial" font-size="10.00">Layer 15 MHA Softmax</text>
<text text-anchor="middle" x="232" y="-2638.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="232" y="-2627.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="232" y="-2616.08" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- layer15_mha_qkt&#45;&gt;layer15_mha_softmax -->
<g id="edge329" class="edge">
<title>layer15_mha_qkt&#45;&gt;layer15_mha_softmax</title>
<path fill="none" stroke="black" d="M203.78,-2696.74C207.61,-2688.52 211.92,-2679.25 216,-2670.48"/>
<polygon fill="black" stroke="black" points="219.26,-2671.78 220.3,-2661.23 212.91,-2668.83 219.26,-2671.78"/>
</g>
<!-- layer15_mha_softmax&#45;&gt;layer15_mha_apply -->
<g id="edge330" class="edge">
<title>layer15_mha_softmax&#45;&gt;layer15_mha_apply</title>
<path fill="none" stroke="black" d="M276.67,-2608.97C293.72,-2599.39 313.33,-2588.36 331.15,-2578.35"/>
<polygon fill="black" stroke="black" points="333.28,-2581.17 340.28,-2573.22 329.85,-2575.06 333.28,-2581.17"/>
</g>
<!-- layer15_mha_out -->
<g id="node261" class="node">
<title>layer15_mha_out</title>
<polygon fill="pink" stroke="black" points="599.5,-2485.08 310.5,-2485.08 310.5,-2433.08 599.5,-2433.08 599.5,-2485.08"/>
<text text-anchor="middle" x="455" y="-2473.08" font-family="Arial" font-size="10.00">Layer 15 MHA Output Linear</text>
<text text-anchor="middle" x="455" y="-2462.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="455" y="-2451.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="455" y="-2440.08" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- layer15_mha_apply&#45;&gt;layer15_mha_out -->
<g id="edge332" class="edge">
<title>layer15_mha_apply&#45;&gt;layer15_mha_out</title>
<path fill="none" stroke="black" d="M405.62,-2520.74C412.67,-2512.08 420.66,-2502.26 428.13,-2493.09"/>
<polygon fill="black" stroke="black" points="430.93,-2495.2 434.52,-2485.23 425.5,-2490.78 430.93,-2495.2"/>
</g>
<!-- layer15_mha_out&#45;&gt;layer15_residual1 -->
<g id="edge333" class="edge">
<title>layer15_mha_out&#45;&gt;layer15_residual1</title>
<path fill="none" stroke="black" d="M474.08,-2432.94C481.17,-2423.6 489.52,-2412.59 497.86,-2401.61"/>
<polygon fill="black" stroke="black" points="500.65,-2403.72 503.9,-2393.64 495.07,-2399.49 500.65,-2403.72"/>
</g>
<!-- layer15_layernorm1 -->
<g id="node263" class="node">
<title>layer15_layernorm1</title>
<polygon fill="lightgreen" stroke="black" points="684.5,-2257.08 395.5,-2257.08 395.5,-2205.08 684.5,-2205.08 684.5,-2257.08"/>
<text text-anchor="middle" x="540" y="-2245.08" font-family="Arial" font-size="10.00">Layer 15 Layer Norm 1</text>
<text text-anchor="middle" x="540" y="-2234.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-2223.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-2212.08" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- layer15_residual1&#45;&gt;layer15_layernorm1 -->
<g id="edge335" class="edge">
<title>layer15_residual1&#45;&gt;layer15_layernorm1</title>
<path fill="none" stroke="black" d="M540,-2292.99C540,-2284.33 540,-2275.51 540,-2267.36"/>
<polygon fill="black" stroke="black" points="543.5,-2267.12 540,-2257.12 536.5,-2267.12 543.5,-2267.12"/>
</g>
<!-- layer15_mlp_gate -->
<g id="node264" class="node">
<title>layer15_mlp_gate</title>
<polygon fill="lightyellow" stroke="black" points="449,-2169.08 157,-2169.08 157,-2117.08 449,-2117.08 449,-2169.08"/>
<text text-anchor="middle" x="303" y="-2157.08" font-family="Arial" font-size="10.00">Layer 15 MLP Gate Linear</text>
<text text-anchor="middle" x="303" y="-2146.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="303" y="-2135.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="303" y="-2124.08" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- layer15_layernorm1&#45;&gt;layer15_mlp_gate -->
<g id="edge336" class="edge">
<title>layer15_layernorm1&#45;&gt;layer15_mlp_gate</title>
<path fill="none" stroke="black" d="M470.81,-2204.97C442.95,-2194.86 410.66,-2183.14 381.88,-2172.7"/>
<polygon fill="black" stroke="black" points="382.87,-2169.34 372.27,-2169.22 380.48,-2175.92 382.87,-2169.34"/>
</g>
<!-- layer15_mlp_up -->
<g id="node265" class="node">
<title>layer15_mlp_up</title>
<polygon fill="lightyellow" stroke="black" points="686,-2081.08 394,-2081.08 394,-2029.08 686,-2029.08 686,-2081.08"/>
<text text-anchor="middle" x="540" y="-2069.08" font-family="Arial" font-size="10.00">Layer 15 MLP Up Linear</text>
<text text-anchor="middle" x="540" y="-2058.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-2047.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="540" y="-2036.08" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- layer15_layernorm1&#45;&gt;layer15_mlp_up -->
<g id="edge337" class="edge">
<title>layer15_layernorm1&#45;&gt;layer15_mlp_up</title>
<path fill="none" stroke="black" d="M540,-2204.78C540,-2174.92 540,-2125.1 540,-2091.44"/>
<polygon fill="black" stroke="black" points="543.5,-2091.13 540,-2081.13 536.5,-2091.13 543.5,-2091.13"/>
</g>
<!-- layer15_residual2 -->
<g id="node269" class="node">
<title>layer15_residual2</title>
<polygon fill="lightblue" stroke="black" points="540,-1817.08 16,-1765.08 540,-1713.08 1064,-1765.08 540,-1817.08"/>
<text text-anchor="middle" x="540" y="-1779.08" font-family="Arial" font-size="10.00">Layer 15 Residual Add 2</text>
<text text-anchor="middle" x="540" y="-1768.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-1757.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-1746.08" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- layer15_layernorm1&#45;&gt;layer15_residual2 -->
<g id="edge343" class="edge">
<title>layer15_layernorm1&#45;&gt;layer15_residual2</title>
<path fill="none" stroke="black" d="M589.06,-2205C637.7,-2176.24 705,-2124.14 705,-2056.08 705,-2056.08 705,-2056.08 705,-1966.08 705,-1905.14 658.86,-1852.73 615.38,-1816.86"/>
<polygon fill="black" stroke="black" points="617.57,-1814.13 607.59,-1810.58 613.18,-1819.58 617.57,-1814.13"/>
</g>
<!-- layer15_mlp_gelu -->
<g id="node266" class="node">
<title>layer15_mlp_gelu</title>
<polygon fill="orange" stroke="black" points="376,-2081.08 84,-2081.08 84,-2029.08 376,-2029.08 376,-2081.08"/>
<text text-anchor="middle" x="230" y="-2069.08" font-family="Arial" font-size="10.00">Layer 15 MLP GELU</text>
<text text-anchor="middle" x="230" y="-2058.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="230" y="-2047.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="230" y="-2036.08" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- layer15_mlp_gate&#45;&gt;layer15_mlp_gelu -->
<g id="edge338" class="edge">
<title>layer15_mlp_gate&#45;&gt;layer15_mlp_gelu</title>
<path fill="none" stroke="black" d="M281.49,-2116.74C274.14,-2108.08 265.81,-2098.26 258.02,-2089.09"/>
<polygon fill="black" stroke="black" points="260.49,-2086.59 251.35,-2081.23 255.16,-2091.12 260.49,-2086.59"/>
</g>
<!-- layer15_mlp_multiply -->
<g id="node267" class="node">
<title>layer15_mlp_multiply</title>
<polygon fill="orange" stroke="black" points="686,-1993.08 156,-1993.08 156,-1941.08 686,-1941.08 686,-1993.08"/>
<text text-anchor="middle" x="421" y="-1981.08" font-family="Arial" font-size="10.00">Layer 15 MLP Element&#45;wise Multiply</text>
<text text-anchor="middle" x="421" y="-1970.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768], [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="421" y="-1959.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="421" y="-1948.08" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- layer15_mlp_up&#45;&gt;layer15_mlp_multiply -->
<g id="edge339" class="edge">
<title>layer15_mlp_up&#45;&gt;layer15_mlp_multiply</title>
<path fill="none" stroke="black" d="M505.26,-2028.97C492.42,-2019.69 477.71,-2009.06 464.21,-1999.31"/>
<polygon fill="black" stroke="black" points="466.14,-1996.38 455.99,-1993.36 462.04,-2002.06 466.14,-1996.38"/>
</g>
<!-- layer15_mlp_gelu&#45;&gt;layer15_mlp_multiply -->
<g id="edge340" class="edge">
<title>layer15_mlp_gelu&#45;&gt;layer15_mlp_multiply</title>
<path fill="none" stroke="black" d="M285.76,-2028.97C307.73,-2019.08 333.11,-2007.65 355.91,-1997.39"/>
<polygon fill="black" stroke="black" points="357.49,-2000.51 365.17,-1993.22 354.62,-1994.13 357.49,-2000.51"/>
</g>
<!-- layer15_mlp_down -->
<g id="node268" class="node">
<title>layer15_mlp_down</title>
<polygon fill="lightyellow" stroke="black" points="624.5,-1905.08 335.5,-1905.08 335.5,-1853.08 624.5,-1853.08 624.5,-1905.08"/>
<text text-anchor="middle" x="480" y="-1893.08" font-family="Arial" font-size="10.00">Layer 15 MLP Down Linear</text>
<text text-anchor="middle" x="480" y="-1882.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="480" y="-1871.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-1860.08" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- layer15_mlp_multiply&#45;&gt;layer15_mlp_down -->
<g id="edge341" class="edge">
<title>layer15_mlp_multiply&#45;&gt;layer15_mlp_down</title>
<path fill="none" stroke="black" d="M438.38,-1940.74C444.2,-1932.25 450.79,-1922.66 456.97,-1913.64"/>
<polygon fill="black" stroke="black" points="459.97,-1915.46 462.74,-1905.23 454.2,-1911.5 459.97,-1915.46"/>
</g>
<!-- layer15_mlp_down&#45;&gt;layer15_residual2 -->
<g id="edge342" class="edge">
<title>layer15_mlp_down&#45;&gt;layer15_residual2</title>
<path fill="none" stroke="black" d="M493.47,-1852.94C498.17,-1844.16 503.66,-1833.91 509.19,-1823.59"/>
<polygon fill="black" stroke="black" points="512.4,-1825.01 514.04,-1814.54 506.23,-1821.7 512.4,-1825.01"/>
</g>
<!-- layer15_layernorm2 -->
<g id="node270" class="node">
<title>layer15_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="684.5,-1677.08 395.5,-1677.08 395.5,-1625.08 684.5,-1625.08 684.5,-1677.08"/>
<text text-anchor="middle" x="540" y="-1665.08" font-family="Arial" font-size="10.00">Layer 15 Layer Norm 2</text>
<text text-anchor="middle" x="540" y="-1654.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-1643.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-1632.08" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- layer15_residual2&#45;&gt;layer15_layernorm2 -->
<g id="edge344" class="edge">
<title>layer15_residual2&#45;&gt;layer15_layernorm2</title>
<path fill="none" stroke="black" d="M540,-1712.99C540,-1704.33 540,-1695.51 540,-1687.36"/>
<polygon fill="black" stroke="black" points="543.5,-1687.12 540,-1677.12 536.5,-1687.12 543.5,-1687.12"/>
</g>
<!-- layer15_layernorm2&#45;&gt;layer15_transfer -->
<g id="edge345" class="edge">
<title>layer15_layernorm2&#45;&gt;layer15_transfer</title>
<path fill="none" stroke="black" d="M540,-1624.91C540,-1617.1 540,-1608.23 540,-1599.46"/>
<polygon fill="black" stroke="black" points="543.5,-1599.29 540,-1589.29 536.5,-1599.29 543.5,-1599.29"/>
</g>
<!-- layer16_mha_query -->
<g id="node272" class="node">
<title>layer16_mha_query</title>
<polygon fill="pink" stroke="black" points="347,-1321.54 51,-1321.54 51,-1269.54 347,-1269.54 347,-1321.54"/>
<text text-anchor="middle" x="199" y="-1309.54" font-family="Arial" font-size="10.00">Layer 16 MHA Query Linear</text>
<text text-anchor="middle" x="199" y="-1298.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="199" y="-1287.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_q=512]</text>
<text text-anchor="middle" x="199" y="-1276.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- layer16_input&#45;&gt;layer16_mha_query -->
<g id="edge347" class="edge">
<title>layer16_input&#45;&gt;layer16_mha_query</title>
<path fill="none" stroke="black" d="M384.47,-1357.46C350.23,-1346.21 315.18,-1334.7 284.9,-1324.75"/>
<polygon fill="black" stroke="black" points="285.84,-1321.38 275.25,-1321.58 283.66,-1328.03 285.84,-1321.38"/>
</g>
<!-- layer16_mha_key -->
<g id="node273" class="node">
<title>layer16_mha_key</title>
<polygon fill="pink" stroke="black" points="661,-1321.54 365,-1321.54 365,-1269.54 661,-1269.54 661,-1321.54"/>
<text text-anchor="middle" x="513" y="-1309.54" font-family="Arial" font-size="10.00">Layer 16 MHA Key Linear</text>
<text text-anchor="middle" x="513" y="-1298.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="513" y="-1287.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="513" y="-1276.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- layer16_input&#45;&gt;layer16_mha_key -->
<g id="edge348" class="edge">
<title>layer16_input&#45;&gt;layer16_mha_key</title>
<path fill="none" stroke="black" d="M527.69,-1357.46C525.57,-1348.69 523.42,-1339.77 521.44,-1331.55"/>
<polygon fill="black" stroke="black" points="524.78,-1330.48 519.04,-1321.58 517.98,-1332.12 524.78,-1330.48"/>
</g>
<!-- layer16_mha_value -->
<g id="node274" class="node">
<title>layer16_mha_value</title>
<polygon fill="pink" stroke="black" points="700,-1233.54 404,-1233.54 404,-1181.54 700,-1181.54 700,-1233.54"/>
<text text-anchor="middle" x="552" y="-1221.54" font-family="Arial" font-size="10.00">Layer 16 MHA Value Linear</text>
<text text-anchor="middle" x="552" y="-1210.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="552" y="-1199.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_v=512]</text>
<text text-anchor="middle" x="552" y="-1188.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- layer16_input&#45;&gt;layer16_mha_value -->
<g id="edge349" class="edge">
<title>layer16_input&#45;&gt;layer16_mha_value</title>
<path fill="none" stroke="black" d="M640.32,-1357.31C652.22,-1347.08 662.71,-1335.19 670,-1321.54 680.89,-1301.15 682.02,-1289.28 670,-1269.54 662.35,-1256.98 651.19,-1246.89 638.74,-1238.82"/>
<polygon fill="black" stroke="black" points="640.32,-1235.68 629.94,-1233.55 636.72,-1241.69 640.32,-1235.68"/>
</g>
<!-- layer16_residual1 -->
<g id="node279" class="node">
<title>layer16_residual1</title>
<polygon fill="lightblue" stroke="black" points="571,-881.54 47,-829.54 571,-777.54 1095,-829.54 571,-881.54"/>
<text text-anchor="middle" x="571" y="-843.54" font-family="Arial" font-size="10.00">Layer 16 Residual Add 1</text>
<text text-anchor="middle" x="571" y="-832.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="571" y="-821.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="571" y="-810.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- layer16_input&#45;&gt;layer16_residual1 -->
<g id="edge357" class="edge">
<title>layer16_input&#45;&gt;layer16_residual1</title>
<path fill="none" stroke="black" d="M640.53,-1357.33C654.78,-1346.92 668.23,-1334.98 679,-1321.54 712.33,-1279.98 719,-1261.82 719,-1208.54 719,-1208.54 719,-1208.54 719,-1030.54 719,-972.02 677.56,-919.43 638.53,-882.88"/>
<polygon fill="black" stroke="black" points="640.51,-879.95 630.77,-875.79 635.79,-885.12 640.51,-879.95"/>
</g>
<!-- layer16_mha_qkt -->
<g id="node275" class="node">
<title>layer16_mha_qkt</title>
<polygon fill="lightcoral" stroke="black" points="385.5,-1233.54 60.5,-1233.54 60.5,-1181.54 385.5,-1181.54 385.5,-1233.54"/>
<text text-anchor="middle" x="223" y="-1221.54" font-family="Arial" font-size="10.00">Layer 16 MHA QKT Calculation</text>
<text text-anchor="middle" x="223" y="-1210.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="223" y="-1199.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="223" y="-1188.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- layer16_mha_query&#45;&gt;layer16_mha_qkt -->
<g id="edge350" class="edge">
<title>layer16_mha_query&#45;&gt;layer16_mha_qkt</title>
<path fill="none" stroke="black" d="M206.07,-1269.2C208.32,-1261.15 210.84,-1252.11 213.24,-1243.5"/>
<polygon fill="black" stroke="black" points="216.66,-1244.27 215.98,-1233.7 209.92,-1242.39 216.66,-1244.27"/>
</g>
<!-- layer16_mha_key&#45;&gt;layer16_mha_qkt -->
<g id="edge351" class="edge">
<title>layer16_mha_key&#45;&gt;layer16_mha_qkt</title>
<path fill="none" stroke="black" d="M428.34,-1269.43C393.57,-1259.12 353.18,-1247.14 317.46,-1236.55"/>
<polygon fill="black" stroke="black" points="318.1,-1233.09 307.51,-1233.6 316.11,-1239.8 318.1,-1233.09"/>
</g>
<!-- layer16_mha_apply -->
<g id="node277" class="node">
<title>layer16_mha_apply</title>
<polygon fill="lightcoral" stroke="black" points="700,-1057.54 132,-1057.54 132,-1005.54 700,-1005.54 700,-1057.54"/>
<text text-anchor="middle" x="416" y="-1045.54" font-family="Arial" font-size="10.00">Layer 16 MHA Apply Attention</text>
<text text-anchor="middle" x="416" y="-1034.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000], [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="416" y="-1023.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="416" y="-1012.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- layer16_mha_value&#45;&gt;layer16_mha_apply -->
<g id="edge354" class="edge">
<title>layer16_mha_value&#45;&gt;layer16_mha_apply</title>
<path fill="none" stroke="black" d="M532.22,-1181.24C508.39,-1150.74 468.26,-1099.4 441.95,-1065.74"/>
<polygon fill="black" stroke="black" points="444.49,-1063.31 435.58,-1057.59 438.98,-1067.62 444.49,-1063.31"/>
</g>
<!-- layer16_mha_softmax -->
<g id="node276" class="node">
<title>layer16_mha_softmax</title>
<polygon fill="lightcoral" stroke="black" points="425.5,-1145.54 100.5,-1145.54 100.5,-1093.54 425.5,-1093.54 425.5,-1145.54"/>
<text text-anchor="middle" x="263" y="-1133.54" font-family="Arial" font-size="10.00">Layer 16 MHA Softmax</text>
<text text-anchor="middle" x="263" y="-1122.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="263" y="-1111.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="263" y="-1100.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- layer16_mha_qkt&#45;&gt;layer16_mha_softmax -->
<g id="edge352" class="edge">
<title>layer16_mha_qkt&#45;&gt;layer16_mha_softmax</title>
<path fill="none" stroke="black" d="M234.78,-1181.2C238.61,-1172.98 242.92,-1163.71 247,-1154.94"/>
<polygon fill="black" stroke="black" points="250.26,-1156.24 251.3,-1145.7 243.91,-1153.29 250.26,-1156.24"/>
</g>
<!-- layer16_mha_softmax&#45;&gt;layer16_mha_apply -->
<g id="edge353" class="edge">
<title>layer16_mha_softmax&#45;&gt;layer16_mha_apply</title>
<path fill="none" stroke="black" d="M307.67,-1093.43C324.72,-1083.85 344.33,-1072.82 362.15,-1062.81"/>
<polygon fill="black" stroke="black" points="364.28,-1065.63 371.28,-1057.68 360.85,-1059.53 364.28,-1065.63"/>
</g>
<!-- layer16_mha_out -->
<g id="node278" class="node">
<title>layer16_mha_out</title>
<polygon fill="pink" stroke="black" points="630.5,-969.54 341.5,-969.54 341.5,-917.54 630.5,-917.54 630.5,-969.54"/>
<text text-anchor="middle" x="486" y="-957.54" font-family="Arial" font-size="10.00">Layer 16 MHA Output Linear</text>
<text text-anchor="middle" x="486" y="-946.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=16, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="486" y="-935.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="486" y="-924.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- layer16_mha_apply&#45;&gt;layer16_mha_out -->
<g id="edge355" class="edge">
<title>layer16_mha_apply&#45;&gt;layer16_mha_out</title>
<path fill="none" stroke="black" d="M436.62,-1005.2C443.67,-996.54 451.66,-986.72 459.13,-977.55"/>
<polygon fill="black" stroke="black" points="461.93,-979.66 465.52,-969.7 456.5,-975.24 461.93,-979.66"/>
</g>
<!-- layer16_mha_out&#45;&gt;layer16_residual1 -->
<g id="edge356" class="edge">
<title>layer16_mha_out&#45;&gt;layer16_residual1</title>
<path fill="none" stroke="black" d="M505.08,-917.4C512.17,-908.06 520.52,-897.05 528.86,-886.07"/>
<polygon fill="black" stroke="black" points="531.65,-888.18 534.9,-878.1 526.07,-883.95 531.65,-888.18"/>
</g>
<!-- layer16_layernorm1 -->
<g id="node280" class="node">
<title>layer16_layernorm1</title>
<polygon fill="lightgreen" stroke="black" points="715.5,-741.54 426.5,-741.54 426.5,-689.54 715.5,-689.54 715.5,-741.54"/>
<text text-anchor="middle" x="571" y="-729.54" font-family="Arial" font-size="10.00">Layer 16 Layer Norm 1</text>
<text text-anchor="middle" x="571" y="-718.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="571" y="-707.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="571" y="-696.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- layer16_residual1&#45;&gt;layer16_layernorm1 -->
<g id="edge358" class="edge">
<title>layer16_residual1&#45;&gt;layer16_layernorm1</title>
<path fill="none" stroke="black" d="M571,-777.46C571,-768.79 571,-759.97 571,-751.82"/>
<polygon fill="black" stroke="black" points="574.5,-751.58 571,-741.58 567.5,-751.58 574.5,-751.58"/>
</g>
<!-- layer16_mlp_gate -->
<g id="node281" class="node">
<title>layer16_mlp_gate</title>
<polygon fill="lightyellow" stroke="black" points="480,-653.54 188,-653.54 188,-601.54 480,-601.54 480,-653.54"/>
<text text-anchor="middle" x="334" y="-641.54" font-family="Arial" font-size="10.00">Layer 16 MLP Gate Linear</text>
<text text-anchor="middle" x="334" y="-630.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="334" y="-619.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="334" y="-608.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- layer16_layernorm1&#45;&gt;layer16_mlp_gate -->
<g id="edge359" class="edge">
<title>layer16_layernorm1&#45;&gt;layer16_mlp_gate</title>
<path fill="none" stroke="black" d="M501.81,-689.43C473.95,-679.32 441.66,-667.6 412.88,-657.16"/>
<polygon fill="black" stroke="black" points="413.87,-653.8 403.27,-653.68 411.48,-660.38 413.87,-653.8"/>
</g>
<!-- layer16_mlp_up -->
<g id="node282" class="node">
<title>layer16_mlp_up</title>
<polygon fill="lightyellow" stroke="black" points="717,-565.54 425,-565.54 425,-513.54 717,-513.54 717,-565.54"/>
<text text-anchor="middle" x="571" y="-553.54" font-family="Arial" font-size="10.00">Layer 16 MLP Up Linear</text>
<text text-anchor="middle" x="571" y="-542.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="571" y="-531.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="571" y="-520.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- layer16_layernorm1&#45;&gt;layer16_mlp_up -->
<g id="edge360" class="edge">
<title>layer16_layernorm1&#45;&gt;layer16_mlp_up</title>
<path fill="none" stroke="black" d="M571,-689.24C571,-659.39 571,-609.56 571,-575.9"/>
<polygon fill="black" stroke="black" points="574.5,-575.59 571,-565.59 567.5,-575.59 574.5,-575.59"/>
</g>
<!-- layer16_residual2 -->
<g id="node286" class="node">
<title>layer16_residual2</title>
<polygon fill="lightblue" stroke="black" points="571,-301.54 47,-249.54 571,-197.54 1095,-249.54 571,-301.54"/>
<text text-anchor="middle" x="571" y="-263.54" font-family="Arial" font-size="10.00">Layer 16 Residual Add 2</text>
<text text-anchor="middle" x="571" y="-252.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="571" y="-241.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="571" y="-230.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- layer16_layernorm1&#45;&gt;layer16_residual2 -->
<g id="edge366" class="edge">
<title>layer16_layernorm1&#45;&gt;layer16_residual2</title>
<path fill="none" stroke="black" d="M620.06,-689.46C668.7,-660.7 736,-608.61 736,-540.54 736,-540.54 736,-540.54 736,-450.54 736,-389.6 689.86,-337.19 646.38,-301.32"/>
<polygon fill="black" stroke="black" points="648.57,-298.59 638.59,-295.04 644.18,-304.04 648.57,-298.59"/>
</g>
<!-- layer16_mlp_gelu -->
<g id="node283" class="node">
<title>layer16_mlp_gelu</title>
<polygon fill="orange" stroke="black" points="407,-565.54 115,-565.54 115,-513.54 407,-513.54 407,-565.54"/>
<text text-anchor="middle" x="261" y="-553.54" font-family="Arial" font-size="10.00">Layer 16 MLP GELU</text>
<text text-anchor="middle" x="261" y="-542.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="261" y="-531.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="261" y="-520.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- layer16_mlp_gate&#45;&gt;layer16_mlp_gelu -->
<g id="edge361" class="edge">
<title>layer16_mlp_gate&#45;&gt;layer16_mlp_gelu</title>
<path fill="none" stroke="black" d="M312.49,-601.2C305.14,-592.54 296.81,-582.72 289.02,-573.55"/>
<polygon fill="black" stroke="black" points="291.49,-571.05 282.35,-565.7 286.16,-575.58 291.49,-571.05"/>
</g>
<!-- layer16_mlp_multiply -->
<g id="node284" class="node">
<title>layer16_mlp_multiply</title>
<polygon fill="orange" stroke="black" points="717,-477.54 187,-477.54 187,-425.54 717,-425.54 717,-477.54"/>
<text text-anchor="middle" x="452" y="-465.54" font-family="Arial" font-size="10.00">Layer 16 MLP Element&#45;wise Multiply</text>
<text text-anchor="middle" x="452" y="-454.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768], [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="452" y="-443.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="452" y="-432.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- layer16_mlp_up&#45;&gt;layer16_mlp_multiply -->
<g id="edge362" class="edge">
<title>layer16_mlp_up&#45;&gt;layer16_mlp_multiply</title>
<path fill="none" stroke="black" d="M536.26,-513.43C523.42,-504.15 508.71,-493.52 495.21,-483.77"/>
<polygon fill="black" stroke="black" points="497.14,-480.85 486.99,-477.83 493.04,-486.52 497.14,-480.85"/>
</g>
<!-- layer16_mlp_gelu&#45;&gt;layer16_mlp_multiply -->
<g id="edge363" class="edge">
<title>layer16_mlp_gelu&#45;&gt;layer16_mlp_multiply</title>
<path fill="none" stroke="black" d="M316.76,-513.43C338.73,-503.54 364.11,-492.11 386.91,-481.85"/>
<polygon fill="black" stroke="black" points="388.49,-484.97 396.17,-477.68 385.62,-478.59 388.49,-484.97"/>
</g>
<!-- layer16_mlp_down -->
<g id="node285" class="node">
<title>layer16_mlp_down</title>
<polygon fill="lightyellow" stroke="black" points="655.5,-389.54 366.5,-389.54 366.5,-337.54 655.5,-337.54 655.5,-389.54"/>
<text text-anchor="middle" x="511" y="-377.54" font-family="Arial" font-size="10.00">Layer 16 MLP Down Linear</text>
<text text-anchor="middle" x="511" y="-366.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="511" y="-355.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="511" y="-344.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- layer16_mlp_multiply&#45;&gt;layer16_mlp_down -->
<g id="edge364" class="edge">
<title>layer16_mlp_multiply&#45;&gt;layer16_mlp_down</title>
<path fill="none" stroke="black" d="M469.38,-425.2C475.2,-416.72 481.79,-407.12 487.97,-398.1"/>
<polygon fill="black" stroke="black" points="490.97,-399.92 493.74,-389.7 485.2,-395.96 490.97,-399.92"/>
</g>
<!-- layer16_mlp_down&#45;&gt;layer16_residual2 -->
<g id="edge365" class="edge">
<title>layer16_mlp_down&#45;&gt;layer16_residual2</title>
<path fill="none" stroke="black" d="M524.47,-337.4C529.17,-328.62 534.66,-318.37 540.19,-308.05"/>
<polygon fill="black" stroke="black" points="543.4,-309.47 545.04,-299 537.23,-306.16 543.4,-309.47"/>
</g>
<!-- layer16_layernorm2 -->
<g id="node287" class="node">
<title>layer16_layernorm2</title>
<polygon fill="lightgreen" stroke="black" points="715.5,-161.54 426.5,-161.54 426.5,-109.54 715.5,-109.54 715.5,-161.54"/>
<text text-anchor="middle" x="571" y="-149.54" font-family="Arial" font-size="10.00">Layer 16 Layer Norm 2</text>
<text text-anchor="middle" x="571" y="-138.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="571" y="-127.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="571" y="-116.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- layer16_residual2&#45;&gt;layer16_layernorm2 -->
<g id="edge367" class="edge">
<title>layer16_residual2&#45;&gt;layer16_layernorm2</title>
<path fill="none" stroke="black" d="M571,-197.46C571,-188.79 571,-179.97 571,-171.82"/>
<polygon fill="black" stroke="black" points="574.5,-171.58 571,-161.58 567.5,-171.58 574.5,-171.58"/>
</g>
<!-- output -->
<g id="node289" class="node">
<title>output</title>
<ellipse fill="red" stroke="black" cx="571" cy="-36.77" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="571" y="-50.77" font-family="Arial" font-size="10.00">Model Output</text>
<text text-anchor="middle" x="571" y="-39.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="571" y="-28.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="571" y="-17.77" font-family="Arial" font-size="10.00">GPU: GPU 15 â†’ Host</text>
</g>
<!-- layer16_layernorm2&#45;&gt;output -->
<g id="edge368" class="edge">
<title>layer16_layernorm2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M571,-109.37C571,-101.56 571,-92.69 571,-83.92"/>
<polygon fill="black" stroke="black" points="574.5,-83.75 571,-73.75 567.5,-83.75 574.5,-83.75"/>
</g>
<!-- input -->
<g id="node288" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="593" cy="-24285.4" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="593" y="-24299.4" font-family="Arial" font-size="10.00">Model Input</text>
<text text-anchor="middle" x="593" y="-24288.4" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="593" y="-24277.4" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="593" y="-24266.4" font-family="Arial" font-size="10.00">GPU: Host â†’ GPU 0</text>
</g>
<!-- input&#45;&gt;layer1_input -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer1_input</title>
<path fill="none" stroke="black" d="M593,-24248.51C593,-24235.27 593,-24219.87 593,-24205.02"/>
<polygon fill="black" stroke="black" points="596.5,-24204.85 593,-24194.85 589.5,-24204.85 596.5,-24204.85"/>
</g>
</g>
</svg>
