<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_tensor_pipeline_parallel Pages: 1 -->
<svg width="641pt" height="14400pt"
 viewBox="0.00 0.00 640.70 14400.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.58 0.58) rotate(0) translate(4 24673.87)">
<title>baseline_tensor_pipeline_parallel</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-24673.87 1094,-24673.87 1094,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_pipeline_stage_0</title>
<polygon fill="#bfefff" stroke="lightblue" points="18,-12381.7 18,-24661.87 1082,-24661.87 1082,-12381.7 18,-12381.7"/>
<text text-anchor="middle" x="550" y="-24646.67" font-family="Times,serif" font-size="14.00">Pipeline Stage 0 (Layers 1&#45;8)</text>
<text text-anchor="middle" x="550" y="-24631.67" font-family="Times,serif" font-size="14.00">Devices 0&#45;7 (TP=8)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_pipeline_stage_1</title>
<polygon fill="#000000" stroke="lightcoral" points="8,-101.54 8,-12272.16 1072,-12272.16 1072,-101.54 8,-101.54"/>
<text text-anchor="middle" x="540" y="-12256.96" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (Layers 9&#45;16)</text>
<text text-anchor="middle" x="540" y="-12241.96" font-family="Times,serif" font-size="14.00">Devices 8&#45;15 (TP=8)</text>
</g>
<!-- input_stage0 -->
<g id="node1" class="node">
<title>input_stage0</title>
<ellipse fill="lightgreen" stroke="black" cx="567" cy="-24579.1" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="567" y="-24593.1" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="567" y="-24582.1" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="567" y="-24571.1" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="567" y="-24560.1" font-family="Arial" font-size="10.00">GPU: Host</text>
</g>
<!-- layer1_input_stage0 -->
<g id="node2" class="node">
<title>layer1_input_stage0</title>
<polygon fill="lightyellow" stroke="black" points="866.74,-24506.33 389.92,-24506.33 267.26,-24402.33 744.08,-24402.33 866.74,-24506.33"/>
<text text-anchor="middle" x="567" y="-24468.33" font-family="Arial" font-size="10.00">Layer 1 Input</text>
<text text-anchor="middle" x="567" y="-24457.33" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="567" y="-24446.33" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="567" y="-24435.33" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- input_stage0&#45;&gt;layer1_input_stage0 -->
<g id="edge1" class="edge">
<title>input_stage0&#45;&gt;layer1_input_stage0</title>
<path fill="none" stroke="black" d="M567,-24542.26C567,-24534.22 567,-24525.47 567,-24516.72"/>
<polygon fill="black" stroke="black" points="570.5,-24516.5 567,-24506.5 563.5,-24516.5 570.5,-24516.5"/>
</g>
<!-- layer1_mha_query_stage0 -->
<g id="node3" class="node">
<title>layer1_mha_query_stage0</title>
<polygon fill="pink" stroke="black" points="321.5,-24366.33 30.5,-24366.33 30.5,-24314.33 321.5,-24314.33 321.5,-24366.33"/>
<text text-anchor="middle" x="176" y="-24354.33" font-family="Arial" font-size="10.00">Layer 1 MHA Query Linear</text>
<text text-anchor="middle" x="176" y="-24343.33" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="176" y="-24332.33" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_q=512]</text>
<text text-anchor="middle" x="176" y="-24321.33" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer1_input_stage0&#45;&gt;layer1_mha_query_stage0 -->
<g id="edge2" class="edge">
<title>layer1_input_stage0&#45;&gt;layer1_mha_query_stage0</title>
<path fill="none" stroke="black" d="M388.95,-24402.33C349.06,-24390.9 308.19,-24379.2 273.06,-24369.13"/>
<polygon fill="black" stroke="black" points="273.89,-24365.73 263.31,-24366.34 271.96,-24372.46 273.89,-24365.73"/>
</g>
<!-- layer1_mha_key_stage0 -->
<g id="node4" class="node">
<title>layer1_mha_key_stage0</title>
<polygon fill="pink" stroke="black" points="630.5,-24366.33 339.5,-24366.33 339.5,-24314.33 630.5,-24314.33 630.5,-24366.33"/>
<text text-anchor="middle" x="485" y="-24354.33" font-family="Arial" font-size="10.00">Layer 1 MHA Key Linear</text>
<text text-anchor="middle" x="485" y="-24343.33" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="485" y="-24332.33" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="485" y="-24321.33" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer1_input_stage0&#45;&gt;layer1_mha_key_stage0 -->
<g id="edge3" class="edge">
<title>layer1_input_stage0&#45;&gt;layer1_mha_key_stage0</title>
<path fill="none" stroke="black" d="M529.6,-24402.25C522.76,-24392.9 515.78,-24383.37 509.44,-24374.71"/>
<polygon fill="black" stroke="black" points="512.07,-24372.37 503.34,-24366.37 506.42,-24376.51 512.07,-24372.37"/>
</g>
<!-- layer1_mha_value_stage0 -->
<g id="node5" class="node">
<title>layer1_mha_value_stage0</title>
<polygon fill="pink" stroke="black" points="704.5,-24278.33 413.5,-24278.33 413.5,-24226.33 704.5,-24226.33 704.5,-24278.33"/>
<text text-anchor="middle" x="559" y="-24266.33" font-family="Arial" font-size="10.00">Layer 1 MHA Value Linear</text>
<text text-anchor="middle" x="559" y="-24255.33" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-24244.33" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_v=512]</text>
<text text-anchor="middle" x="559" y="-24233.33" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer1_input_stage0&#45;&gt;layer1_mha_value_stage0 -->
<g id="edge4" class="edge">
<title>layer1_input_stage0&#45;&gt;layer1_mha_value_stage0</title>
<path fill="none" stroke="black" d="M619.28,-24402.1C639.47,-24375.97 654.6,-24343.6 640,-24314.33 634.3,-24302.89 625.31,-24293.04 615.37,-24284.79"/>
<polygon fill="black" stroke="black" points="617.29,-24281.85 607.24,-24278.51 613.02,-24287.39 617.29,-24281.85"/>
</g>
<!-- layer1_residual1_stage0 -->
<g id="node11" class="node">
<title>layer1_residual1_stage0</title>
<polygon fill="lightblue" stroke="black" points="550,-23816.79 26,-23764.79 550,-23712.79 1074,-23764.79 550,-23816.79"/>
<text text-anchor="middle" x="550" y="-23778.79" font-family="Arial" font-size="10.00">Layer 1 Residual Add 1</text>
<text text-anchor="middle" x="550" y="-23767.79" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-23756.79" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-23745.79" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer1_input_stage0&#45;&gt;layer1_residual1_stage0 -->
<g id="edge13" class="edge">
<title>layer1_input_stage0&#45;&gt;layer1_residual1_stage0</title>
<path fill="none" stroke="black" d="M637.7,-24402.17C678.97,-24365.92 723,-24313.22 723,-24253.33 723,-24253.33 723,-24253.33 723,-23987.33 723,-23927.37 745.73,-23903.03 713,-23852.79 702.19,-23836.2 687.12,-23822.55 670.46,-23811.39"/>
<polygon fill="black" stroke="black" points="671.94,-23808.18 661.62,-23805.77 668.19,-23814.09 671.94,-23808.18"/>
</g>
<!-- layer1_mha_qkt_stage0 -->
<g id="node6" class="node">
<title>layer1_mha_qkt_stage0</title>
<polygon fill="lightcoral" stroke="black" points="395,-24278.33 75,-24278.33 75,-24226.33 395,-24226.33 395,-24278.33"/>
<text text-anchor="middle" x="235" y="-24266.33" font-family="Arial" font-size="10.00">Layer 1 MHA QKT Calculation</text>
<text text-anchor="middle" x="235" y="-24255.33" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="235" y="-24244.33" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="235" y="-24233.33" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer1_mha_query_stage0&#45;&gt;layer1_mha_qkt_stage0 -->
<g id="edge5" class="edge">
<title>layer1_mha_query_stage0&#45;&gt;layer1_mha_qkt_stage0</title>
<path fill="none" stroke="black" d="M193.38,-24313.99C199.2,-24305.51 205.79,-24295.91 211.97,-24286.9"/>
<polygon fill="black" stroke="black" points="214.97,-24288.71 217.74,-24278.49 209.2,-24284.75 214.97,-24288.71"/>
</g>
<!-- layer1_mha_key_stage0&#45;&gt;layer1_mha_qkt_stage0 -->
<g id="edge6" class="edge">
<title>layer1_mha_key_stage0&#45;&gt;layer1_mha_qkt_stage0</title>
<path fill="none" stroke="black" d="M412.02,-24314.22C382.5,-24304.07 348.26,-24292.29 317.82,-24281.82"/>
<polygon fill="black" stroke="black" points="318.67,-24278.41 308.07,-24278.47 316.39,-24285.03 318.67,-24278.41"/>
</g>
<!-- layer1_mha_apply_stage0 -->
<g id="node8" class="node">
<title>layer1_mha_apply_stage0</title>
<polygon fill="lightcoral" stroke="black" points="656,-24102.33 344,-24102.33 344,-24050.33 656,-24050.33 656,-24102.33"/>
<text text-anchor="middle" x="500" y="-24090.33" font-family="Arial" font-size="10.00">Layer 1 MHA Apply Attention</text>
<text text-anchor="middle" x="500" y="-24079.33" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="500" y="-24068.33" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="500" y="-24057.33" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer1_mha_value_stage0&#45;&gt;layer1_mha_apply_stage0 -->
<g id="edge9" class="edge">
<title>layer1_mha_value_stage0&#45;&gt;layer1_mha_apply_stage0</title>
<path fill="none" stroke="black" d="M550.42,-24226.03C540.25,-24196.05 523.26,-24145.92 511.84,-24112.26"/>
<polygon fill="black" stroke="black" points="515.02,-24110.73 508.49,-24102.38 508.39,-24112.97 515.02,-24110.73"/>
</g>
<!-- layer1_mha_weights_stage0 -->
<g id="node7" class="node">
<title>layer1_mha_weights_stage0</title>
<polygon fill="lightcoral" stroke="black" points="453,-24190.33 133,-24190.33 133,-24138.33 453,-24138.33 453,-24190.33"/>
<text text-anchor="middle" x="293" y="-24178.33" font-family="Arial" font-size="10.00">Layer 1 MHA Attention Weights</text>
<text text-anchor="middle" x="293" y="-24167.33" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="293" y="-24156.33" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="293" y="-24145.33" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer1_mha_qkt_stage0&#45;&gt;layer1_mha_weights_stage0 -->
<g id="edge7" class="edge">
<title>layer1_mha_qkt_stage0&#45;&gt;layer1_mha_weights_stage0</title>
<path fill="none" stroke="black" d="M252.09,-24225.99C257.81,-24217.51 264.28,-24207.91 270.36,-24198.9"/>
<polygon fill="black" stroke="black" points="273.34,-24200.73 276.03,-24190.49 267.54,-24196.82 273.34,-24200.73"/>
</g>
<!-- layer1_mha_weights_stage0&#45;&gt;layer1_mha_apply_stage0 -->
<g id="edge8" class="edge">
<title>layer1_mha_weights_stage0&#45;&gt;layer1_mha_apply_stage0</title>
<path fill="none" stroke="black" d="M353.43,-24138.22C377.45,-24128.24 405.24,-24116.7 430.12,-24106.36"/>
<polygon fill="black" stroke="black" points="431.6,-24109.54 439.5,-24102.47 428.92,-24103.07 431.6,-24109.54"/>
</g>
<!-- layer1_mha_out_stage0 -->
<g id="node9" class="node">
<title>layer1_mha_out_stage0</title>
<polygon fill="pink" stroke="black" points="644.5,-24014.33 355.5,-24014.33 355.5,-23962.33 644.5,-23962.33 644.5,-24014.33"/>
<text text-anchor="middle" x="500" y="-24002.33" font-family="Arial" font-size="10.00">Layer 1 MHA Output Linear</text>
<text text-anchor="middle" x="500" y="-23991.33" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="500" y="-23980.33" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="500" y="-23969.33" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer1_mha_apply_stage0&#45;&gt;layer1_mha_out_stage0 -->
<g id="edge10" class="edge">
<title>layer1_mha_apply_stage0&#45;&gt;layer1_mha_out_stage0</title>
<path fill="none" stroke="black" d="M500,-24049.99C500,-24042.03 500,-24033.09 500,-24024.57"/>
<polygon fill="black" stroke="black" points="503.5,-24024.49 500,-24014.49 496.5,-24024.49 503.5,-24024.49"/>
</g>
<!-- layer1_mha_allreduce_stage0 -->
<g id="node10" class="node">
<title>layer1_mha_allreduce_stage0</title>
<ellipse fill="lightgray" stroke="black" cx="500" cy="-23889.56" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="500" y="-23903.56" font-family="Arial" font-size="10.00">Layer 1 MHA All&#45;reduce</text>
<text text-anchor="middle" x="500" y="-23892.56" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="500" y="-23881.56" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="500" y="-23870.56" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer1_mha_out_stage0&#45;&gt;layer1_mha_allreduce_stage0 -->
<g id="edge11" class="edge">
<title>layer1_mha_out_stage0&#45;&gt;layer1_mha_allreduce_stage0</title>
<path fill="none" stroke="black" d="M500,-23962.16C500,-23954.35 500,-23945.48 500,-23936.72"/>
<polygon fill="black" stroke="black" points="503.5,-23936.54 500,-23926.54 496.5,-23936.54 503.5,-23936.54"/>
</g>
<!-- layer1_mha_allreduce_stage0&#45;&gt;layer1_residual1_stage0 -->
<g id="edge12" class="edge">
<title>layer1_mha_allreduce_stage0&#45;&gt;layer1_residual1_stage0</title>
<path fill="none" stroke="black" d="M514.6,-23852.72C518.19,-23843.91 522.12,-23834.24 526.03,-23824.66"/>
<polygon fill="black" stroke="black" points="529.37,-23825.72 529.9,-23815.14 522.89,-23823.08 529.37,-23825.72"/>
</g>
<!-- layer1_layernorm1_stage0 -->
<g id="node12" class="node">
<title>layer1_layernorm1_stage0</title>
<polygon fill="lightgreen" stroke="black" points="694.5,-23676.79 405.5,-23676.79 405.5,-23624.79 694.5,-23624.79 694.5,-23676.79"/>
<text text-anchor="middle" x="550" y="-23664.79" font-family="Arial" font-size="10.00">Layer 1 Layer Norm 1</text>
<text text-anchor="middle" x="550" y="-23653.79" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-23642.79" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-23631.79" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer1_residual1_stage0&#45;&gt;layer1_layernorm1_stage0 -->
<g id="edge14" class="edge">
<title>layer1_residual1_stage0&#45;&gt;layer1_layernorm1_stage0</title>
<path fill="none" stroke="black" d="M550,-23712.71C550,-23704.04 550,-23695.22 550,-23687.08"/>
<polygon fill="black" stroke="black" points="553.5,-23686.83 550,-23676.83 546.5,-23686.83 553.5,-23686.83"/>
</g>
<!-- layer1_mlp_gate_stage0 -->
<g id="node13" class="node">
<title>layer1_mlp_gate_stage0</title>
<polygon fill="lightyellow" stroke="black" points="459.5,-23588.79 172.5,-23588.79 172.5,-23536.79 459.5,-23536.79 459.5,-23588.79"/>
<text text-anchor="middle" x="316" y="-23576.79" font-family="Arial" font-size="10.00">Layer 1 MLP Gate Linear</text>
<text text-anchor="middle" x="316" y="-23565.79" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="316" y="-23554.79" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="316" y="-23543.79" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer1_layernorm1_stage0&#45;&gt;layer1_mlp_gate_stage0 -->
<g id="edge15" class="edge">
<title>layer1_layernorm1_stage0&#45;&gt;layer1_mlp_gate_stage0</title>
<path fill="none" stroke="black" d="M481.69,-23624.68C454.18,-23614.57 422.29,-23602.86 393.89,-23592.42"/>
<polygon fill="black" stroke="black" points="394.99,-23589.09 384.4,-23588.93 392.58,-23595.66 394.99,-23589.09"/>
</g>
<!-- layer1_mlp_up_stage0 -->
<g id="node14" class="node">
<title>layer1_mlp_up_stage0</title>
<polygon fill="lightyellow" stroke="black" points="693.5,-23500.79 406.5,-23500.79 406.5,-23448.79 693.5,-23448.79 693.5,-23500.79"/>
<text text-anchor="middle" x="550" y="-23488.79" font-family="Arial" font-size="10.00">Layer 1 MLP Up Linear</text>
<text text-anchor="middle" x="550" y="-23477.79" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-23466.79" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="550" y="-23455.79" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer1_layernorm1_stage0&#45;&gt;layer1_mlp_up_stage0 -->
<g id="edge16" class="edge">
<title>layer1_layernorm1_stage0&#45;&gt;layer1_mlp_up_stage0</title>
<path fill="none" stroke="black" d="M550,-23624.49C550,-23594.64 550,-23544.82 550,-23511.16"/>
<polygon fill="black" stroke="black" points="553.5,-23510.84 550,-23500.84 546.5,-23510.84 553.5,-23510.84"/>
</g>
<!-- layer1_residual2_stage0 -->
<g id="node18" class="node">
<title>layer1_residual2_stage0</title>
<polygon fill="lightblue" stroke="black" points="550,-23215.25 26,-23163.25 550,-23111.25 1074,-23163.25 550,-23215.25"/>
<text text-anchor="middle" x="550" y="-23177.25" font-family="Arial" font-size="10.00">Layer 1 Residual Add 2</text>
<text text-anchor="middle" x="550" y="-23166.25" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-23155.25" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-23144.25" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer1_layernorm1_stage0&#45;&gt;layer1_residual2_stage0 -->
<g id="edge22" class="edge">
<title>layer1_layernorm1_stage0&#45;&gt;layer1_residual2_stage0</title>
<path fill="none" stroke="black" d="M598.46,-23624.56C646.51,-23595.67 713,-23543.47 713,-23475.79 713,-23475.79 713,-23475.79 713,-23385.79 713,-23325.83 735.05,-23301.93 703,-23251.25 692.85,-23235.2 678.6,-23221.81 662.85,-23210.74"/>
<polygon fill="black" stroke="black" points="664.75,-23207.8 654.49,-23205.16 660.87,-23213.63 664.75,-23207.8"/>
</g>
<!-- layer1_mlp_gelu_stage0 -->
<g id="node15" class="node">
<title>layer1_mlp_gelu_stage0</title>
<polygon fill="orange" stroke="black" points="388.5,-23500.79 101.5,-23500.79 101.5,-23448.79 388.5,-23448.79 388.5,-23500.79"/>
<text text-anchor="middle" x="245" y="-23488.79" font-family="Arial" font-size="10.00">Layer 1 MLP GELU</text>
<text text-anchor="middle" x="245" y="-23477.79" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="245" y="-23466.79" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="245" y="-23455.79" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer1_mlp_gate_stage0&#45;&gt;layer1_mlp_gelu_stage0 -->
<g id="edge17" class="edge">
<title>layer1_mlp_gate_stage0&#45;&gt;layer1_mlp_gelu_stage0</title>
<path fill="none" stroke="black" d="M295.08,-23536.45C287.93,-23527.79 279.83,-23517.97 272.25,-23508.8"/>
<polygon fill="black" stroke="black" points="274.83,-23506.43 265.77,-23500.95 269.44,-23510.89 274.83,-23506.43"/>
</g>
<!-- layer1_mlp_down_stage0 -->
<g id="node16" class="node">
<title>layer1_mlp_down_stage0</title>
<polygon fill="lightyellow" stroke="black" points="634.5,-23412.79 345.5,-23412.79 345.5,-23360.79 634.5,-23360.79 634.5,-23412.79"/>
<text text-anchor="middle" x="490" y="-23400.79" font-family="Arial" font-size="10.00">Layer 1 MLP Down Linear</text>
<text text-anchor="middle" x="490" y="-23389.79" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="490" y="-23378.79" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-23367.79" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer1_mlp_up_stage0&#45;&gt;layer1_mlp_down_stage0 -->
<g id="edge19" class="edge">
<title>layer1_mlp_up_stage0&#45;&gt;layer1_mlp_down_stage0</title>
<path fill="none" stroke="black" d="M532.32,-23448.45C526.4,-23439.97 519.71,-23430.37 513.42,-23421.36"/>
<polygon fill="black" stroke="black" points="516.14,-23419.15 507.55,-23412.95 510.4,-23423.15 516.14,-23419.15"/>
</g>
<!-- layer1_mlp_gelu_stage0&#45;&gt;layer1_mlp_down_stage0 -->
<g id="edge18" class="edge">
<title>layer1_mlp_gelu_stage0&#45;&gt;layer1_mlp_down_stage0</title>
<path fill="none" stroke="black" d="M316.52,-23448.68C345.45,-23438.53 379,-23426.75 408.84,-23416.28"/>
<polygon fill="black" stroke="black" points="410.11,-23419.54 418.39,-23412.93 407.79,-23412.94 410.11,-23419.54"/>
</g>
<!-- layer1_mlp_allreduce_stage0 -->
<g id="node17" class="node">
<title>layer1_mlp_allreduce_stage0</title>
<ellipse fill="lightgray" stroke="black" cx="490" cy="-23288.02" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="490" y="-23302.02" font-family="Arial" font-size="10.00">Layer 1 MLP All&#45;reduce</text>
<text text-anchor="middle" x="490" y="-23291.02" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-23280.02" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-23269.02" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer1_mlp_down_stage0&#45;&gt;layer1_mlp_allreduce_stage0 -->
<g id="edge20" class="edge">
<title>layer1_mlp_down_stage0&#45;&gt;layer1_mlp_allreduce_stage0</title>
<path fill="none" stroke="black" d="M490,-23360.62C490,-23352.81 490,-23343.94 490,-23335.18"/>
<polygon fill="black" stroke="black" points="493.5,-23335 490,-23325 486.5,-23335 493.5,-23335"/>
</g>
<!-- layer1_mlp_allreduce_stage0&#45;&gt;layer1_residual2_stage0 -->
<g id="edge21" class="edge">
<title>layer1_mlp_allreduce_stage0&#45;&gt;layer1_residual2_stage0</title>
<path fill="none" stroke="black" d="M507.52,-23251.18C511.96,-23242.08 516.86,-23232.06 521.7,-23222.17"/>
<polygon fill="black" stroke="black" points="524.86,-23223.66 526.11,-23213.14 518.57,-23220.59 524.86,-23223.66"/>
</g>
<!-- layer1_layernorm2_stage0 -->
<g id="node19" class="node">
<title>layer1_layernorm2_stage0</title>
<polygon fill="lightgreen" stroke="black" points="694.5,-23075.25 405.5,-23075.25 405.5,-23023.25 694.5,-23023.25 694.5,-23075.25"/>
<text text-anchor="middle" x="550" y="-23063.25" font-family="Arial" font-size="10.00">Layer 1 Layer Norm 2</text>
<text text-anchor="middle" x="550" y="-23052.25" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-23041.25" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-23030.25" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer1_residual2_stage0&#45;&gt;layer1_layernorm2_stage0 -->
<g id="edge23" class="edge">
<title>layer1_residual2_stage0&#45;&gt;layer1_layernorm2_stage0</title>
<path fill="none" stroke="black" d="M550,-23111.17C550,-23102.5 550,-23093.68 550,-23085.54"/>
<polygon fill="black" stroke="black" points="553.5,-23085.29 550,-23075.29 546.5,-23085.29 553.5,-23085.29"/>
</g>
<!-- layer2_input_stage0 -->
<g id="node20" class="node">
<title>layer2_input_stage0</title>
<polygon fill="lightyellow" stroke="black" points="849.74,-22987.25 372.92,-22987.25 250.26,-22883.25 727.08,-22883.25 849.74,-22987.25"/>
<text text-anchor="middle" x="550" y="-22949.25" font-family="Arial" font-size="10.00">Layer 2 Input</text>
<text text-anchor="middle" x="550" y="-22938.25" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-22927.25" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-22916.25" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer1_layernorm2_stage0&#45;&gt;layer2_input_stage0 -->
<g id="edge24" class="edge">
<title>layer1_layernorm2_stage0&#45;&gt;layer2_input_stage0</title>
<path fill="none" stroke="black" d="M550,-23023.12C550,-23015.43 550,-23006.62 550,-22997.62"/>
<polygon fill="black" stroke="black" points="553.5,-22997.43 550,-22987.43 546.5,-22997.43 553.5,-22997.43"/>
</g>
<!-- layer2_mha_query_stage0 -->
<g id="node21" class="node">
<title>layer2_mha_query_stage0</title>
<polygon fill="pink" stroke="black" points="353.5,-22847.25 62.5,-22847.25 62.5,-22795.25 353.5,-22795.25 353.5,-22847.25"/>
<text text-anchor="middle" x="208" y="-22835.25" font-family="Arial" font-size="10.00">Layer 2 MHA Query Linear</text>
<text text-anchor="middle" x="208" y="-22824.25" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="208" y="-22813.25" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_q=512]</text>
<text text-anchor="middle" x="208" y="-22802.25" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer2_input_stage0&#45;&gt;layer2_mha_query_stage0 -->
<g id="edge25" class="edge">
<title>layer2_input_stage0&#45;&gt;layer2_mha_query_stage0</title>
<path fill="none" stroke="black" d="M394.01,-22883.17C359.68,-22871.92 324.53,-22860.41 294.16,-22850.47"/>
<polygon fill="black" stroke="black" points="295.06,-22847.08 284.47,-22847.29 292.89,-22853.73 295.06,-22847.08"/>
</g>
<!-- layer2_mha_key_stage0 -->
<g id="node22" class="node">
<title>layer2_mha_key_stage0</title>
<polygon fill="pink" stroke="black" points="662.5,-22847.25 371.5,-22847.25 371.5,-22795.25 662.5,-22795.25 662.5,-22847.25"/>
<text text-anchor="middle" x="517" y="-22835.25" font-family="Arial" font-size="10.00">Layer 2 MHA Key Linear</text>
<text text-anchor="middle" x="517" y="-22824.25" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="517" y="-22813.25" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="517" y="-22802.25" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer2_input_stage0&#45;&gt;layer2_mha_key_stage0 -->
<g id="edge26" class="edge">
<title>layer2_input_stage0&#45;&gt;layer2_mha_key_stage0</title>
<path fill="none" stroke="black" d="M534.95,-22883.17C532.34,-22874.31 529.68,-22865.28 527.24,-22856.99"/>
<polygon fill="black" stroke="black" points="530.56,-22855.9 524.38,-22847.29 523.85,-22857.88 530.56,-22855.9"/>
</g>
<!-- layer2_mha_value_stage0 -->
<g id="node23" class="node">
<title>layer2_mha_value_stage0</title>
<polygon fill="pink" stroke="black" points="687.5,-22759.25 396.5,-22759.25 396.5,-22707.25 687.5,-22707.25 687.5,-22759.25"/>
<text text-anchor="middle" x="542" y="-22747.25" font-family="Arial" font-size="10.00">Layer 2 MHA Value Linear</text>
<text text-anchor="middle" x="542" y="-22736.25" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="542" y="-22725.25" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_v=512]</text>
<text text-anchor="middle" x="542" y="-22714.25" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer2_input_stage0&#45;&gt;layer2_mha_value_stage0 -->
<g id="edge27" class="edge">
<title>layer2_input_stage0&#45;&gt;layer2_mha_value_stage0</title>
<path fill="none" stroke="black" d="M643.06,-22883.22C654.7,-22872.87 664.97,-22860.9 672,-22847.25 682.58,-22826.71 684.39,-22814.76 672,-22795.25 663.88,-22782.48 652.31,-22772.33 639.37,-22764.29"/>
<polygon fill="black" stroke="black" points="641.1,-22761.25 630.69,-22759.3 637.61,-22767.32 641.1,-22761.25"/>
</g>
<!-- layer2_residual1_stage0 -->
<g id="node29" class="node">
<title>layer2_residual1_stage0</title>
<polygon fill="lightblue" stroke="black" points="550,-22297.71 26,-22245.71 550,-22193.71 1074,-22245.71 550,-22297.71"/>
<text text-anchor="middle" x="550" y="-22259.71" font-family="Arial" font-size="10.00">Layer 2 Residual Add 1</text>
<text text-anchor="middle" x="550" y="-22248.71" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-22237.71" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-22226.71" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer2_input_stage0&#45;&gt;layer2_residual1_stage0 -->
<g id="edge36" class="edge">
<title>layer2_input_stage0&#45;&gt;layer2_residual1_stage0</title>
<path fill="none" stroke="black" d="M646.49,-22883.1C659.62,-22872.72 671.74,-22860.76 681,-22847.25 710.09,-22804.83 706,-22785.69 706,-22734.25 706,-22734.25 706,-22734.25 706,-22468.25 706,-22408.29 727.53,-22384.71 696,-22333.71 686.31,-22318.04 672.66,-22304.84 657.56,-22293.84"/>
<polygon fill="black" stroke="black" points="659.26,-22290.75 649.04,-22287.95 655.28,-22296.51 659.26,-22290.75"/>
</g>
<!-- layer2_mha_qkt_stage0 -->
<g id="node24" class="node">
<title>layer2_mha_qkt_stage0</title>
<polygon fill="lightcoral" stroke="black" points="378,-22759.25 58,-22759.25 58,-22707.25 378,-22707.25 378,-22759.25"/>
<text text-anchor="middle" x="218" y="-22747.25" font-family="Arial" font-size="10.00">Layer 2 MHA QKT Calculation</text>
<text text-anchor="middle" x="218" y="-22736.25" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="218" y="-22725.25" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="218" y="-22714.25" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer2_mha_query_stage0&#45;&gt;layer2_mha_qkt_stage0 -->
<g id="edge28" class="edge">
<title>layer2_mha_query_stage0&#45;&gt;layer2_mha_qkt_stage0</title>
<path fill="none" stroke="black" d="M210.95,-22794.91C211.87,-22786.95 212.91,-22778.01 213.9,-22769.5"/>
<polygon fill="black" stroke="black" points="217.4,-22769.75 215.07,-22759.41 210.44,-22768.94 217.4,-22769.75"/>
</g>
<!-- layer2_mha_key_stage0&#45;&gt;layer2_mha_qkt_stage0 -->
<g id="edge29" class="edge">
<title>layer2_mha_key_stage0&#45;&gt;layer2_mha_qkt_stage0</title>
<path fill="none" stroke="black" d="M429.71,-22795.15C393.72,-22784.79 351.86,-22772.75 314.92,-22762.13"/>
<polygon fill="black" stroke="black" points="315.71,-22758.71 305.14,-22759.31 313.78,-22765.44 315.71,-22758.71"/>
</g>
<!-- layer2_mha_apply_stage0 -->
<g id="node26" class="node">
<title>layer2_mha_apply_stage0</title>
<polygon fill="lightcoral" stroke="black" points="639,-22583.25 327,-22583.25 327,-22531.25 639,-22531.25 639,-22583.25"/>
<text text-anchor="middle" x="483" y="-22571.25" font-family="Arial" font-size="10.00">Layer 2 MHA Apply Attention</text>
<text text-anchor="middle" x="483" y="-22560.25" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="483" y="-22549.25" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="483" y="-22538.25" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer2_mha_value_stage0&#45;&gt;layer2_mha_apply_stage0 -->
<g id="edge32" class="edge">
<title>layer2_mha_value_stage0&#45;&gt;layer2_mha_apply_stage0</title>
<path fill="none" stroke="black" d="M533.42,-22706.95C523.25,-22676.97 506.26,-22626.85 494.84,-22593.18"/>
<polygon fill="black" stroke="black" points="498.02,-22591.65 491.49,-22583.3 491.39,-22593.9 498.02,-22591.65"/>
</g>
<!-- layer2_mha_weights_stage0 -->
<g id="node25" class="node">
<title>layer2_mha_weights_stage0</title>
<polygon fill="lightcoral" stroke="black" points="436,-22671.25 116,-22671.25 116,-22619.25 436,-22619.25 436,-22671.25"/>
<text text-anchor="middle" x="276" y="-22659.25" font-family="Arial" font-size="10.00">Layer 2 MHA Attention Weights</text>
<text text-anchor="middle" x="276" y="-22648.25" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="276" y="-22637.25" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="276" y="-22626.25" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer2_mha_qkt_stage0&#45;&gt;layer2_mha_weights_stage0 -->
<g id="edge30" class="edge">
<title>layer2_mha_qkt_stage0&#45;&gt;layer2_mha_weights_stage0</title>
<path fill="none" stroke="black" d="M235.09,-22706.91C240.81,-22698.43 247.28,-22688.83 253.36,-22679.82"/>
<polygon fill="black" stroke="black" points="256.34,-22681.66 259.03,-22671.41 250.54,-22677.74 256.34,-22681.66"/>
</g>
<!-- layer2_mha_weights_stage0&#45;&gt;layer2_mha_apply_stage0 -->
<g id="edge31" class="edge">
<title>layer2_mha_weights_stage0&#45;&gt;layer2_mha_apply_stage0</title>
<path fill="none" stroke="black" d="M336.43,-22619.15C360.45,-22609.17 388.24,-22597.62 413.12,-22587.29"/>
<polygon fill="black" stroke="black" points="414.6,-22590.46 422.5,-22583.39 411.92,-22583.99 414.6,-22590.46"/>
</g>
<!-- layer2_mha_out_stage0 -->
<g id="node27" class="node">
<title>layer2_mha_out_stage0</title>
<polygon fill="pink" stroke="black" points="627.5,-22495.25 338.5,-22495.25 338.5,-22443.25 627.5,-22443.25 627.5,-22495.25"/>
<text text-anchor="middle" x="483" y="-22483.25" font-family="Arial" font-size="10.00">Layer 2 MHA Output Linear</text>
<text text-anchor="middle" x="483" y="-22472.25" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="483" y="-22461.25" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="483" y="-22450.25" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer2_mha_apply_stage0&#45;&gt;layer2_mha_out_stage0 -->
<g id="edge33" class="edge">
<title>layer2_mha_apply_stage0&#45;&gt;layer2_mha_out_stage0</title>
<path fill="none" stroke="black" d="M483,-22530.91C483,-22522.95 483,-22514.01 483,-22505.5"/>
<polygon fill="black" stroke="black" points="486.5,-22505.41 483,-22495.41 479.5,-22505.41 486.5,-22505.41"/>
</g>
<!-- layer2_mha_allreduce_stage0 -->
<g id="node28" class="node">
<title>layer2_mha_allreduce_stage0</title>
<ellipse fill="lightgray" stroke="black" cx="483" cy="-22370.48" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="483" y="-22384.48" font-family="Arial" font-size="10.00">Layer 2 MHA All&#45;reduce</text>
<text text-anchor="middle" x="483" y="-22373.48" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="483" y="-22362.48" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="483" y="-22351.48" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer2_mha_out_stage0&#45;&gt;layer2_mha_allreduce_stage0 -->
<g id="edge34" class="edge">
<title>layer2_mha_out_stage0&#45;&gt;layer2_mha_allreduce_stage0</title>
<path fill="none" stroke="black" d="M483,-22443.08C483,-22435.27 483,-22426.4 483,-22417.64"/>
<polygon fill="black" stroke="black" points="486.5,-22417.46 483,-22407.46 479.5,-22417.46 486.5,-22417.46"/>
</g>
<!-- layer2_mha_allreduce_stage0&#45;&gt;layer2_residual1_stage0 -->
<g id="edge35" class="edge">
<title>layer2_mha_allreduce_stage0&#45;&gt;layer2_residual1_stage0</title>
<path fill="none" stroke="black" d="M502.56,-22333.64C507.64,-22324.34 513.24,-22314.08 518.75,-22303.97"/>
<polygon fill="black" stroke="black" points="521.85,-22305.6 523.57,-22295.15 515.7,-22302.25 521.85,-22305.6"/>
</g>
<!-- layer2_layernorm1_stage0 -->
<g id="node30" class="node">
<title>layer2_layernorm1_stage0</title>
<polygon fill="lightgreen" stroke="black" points="694.5,-22157.71 405.5,-22157.71 405.5,-22105.71 694.5,-22105.71 694.5,-22157.71"/>
<text text-anchor="middle" x="550" y="-22145.71" font-family="Arial" font-size="10.00">Layer 2 Layer Norm 1</text>
<text text-anchor="middle" x="550" y="-22134.71" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-22123.71" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-22112.71" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer2_residual1_stage0&#45;&gt;layer2_layernorm1_stage0 -->
<g id="edge37" class="edge">
<title>layer2_residual1_stage0&#45;&gt;layer2_layernorm1_stage0</title>
<path fill="none" stroke="black" d="M550,-22193.63C550,-22184.96 550,-22176.14 550,-22168"/>
<polygon fill="black" stroke="black" points="553.5,-22167.76 550,-22157.76 546.5,-22167.76 553.5,-22167.76"/>
</g>
<!-- layer2_mlp_gate_stage0 -->
<g id="node31" class="node">
<title>layer2_mlp_gate_stage0</title>
<polygon fill="lightyellow" stroke="black" points="459.5,-22069.71 172.5,-22069.71 172.5,-22017.71 459.5,-22017.71 459.5,-22069.71"/>
<text text-anchor="middle" x="316" y="-22057.71" font-family="Arial" font-size="10.00">Layer 2 MLP Gate Linear</text>
<text text-anchor="middle" x="316" y="-22046.71" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="316" y="-22035.71" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="316" y="-22024.71" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer2_layernorm1_stage0&#45;&gt;layer2_mlp_gate_stage0 -->
<g id="edge38" class="edge">
<title>layer2_layernorm1_stage0&#45;&gt;layer2_mlp_gate_stage0</title>
<path fill="none" stroke="black" d="M481.69,-22105.61C454.18,-22095.5 422.29,-22083.78 393.89,-22073.34"/>
<polygon fill="black" stroke="black" points="394.99,-22070.01 384.4,-22069.85 392.58,-22076.58 394.99,-22070.01"/>
</g>
<!-- layer2_mlp_up_stage0 -->
<g id="node32" class="node">
<title>layer2_mlp_up_stage0</title>
<polygon fill="lightyellow" stroke="black" points="693.5,-21981.71 406.5,-21981.71 406.5,-21929.71 693.5,-21929.71 693.5,-21981.71"/>
<text text-anchor="middle" x="550" y="-21969.71" font-family="Arial" font-size="10.00">Layer 2 MLP Up Linear</text>
<text text-anchor="middle" x="550" y="-21958.71" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-21947.71" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="550" y="-21936.71" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer2_layernorm1_stage0&#45;&gt;layer2_mlp_up_stage0 -->
<g id="edge39" class="edge">
<title>layer2_layernorm1_stage0&#45;&gt;layer2_mlp_up_stage0</title>
<path fill="none" stroke="black" d="M550,-22105.41C550,-22075.56 550,-22025.74 550,-21992.08"/>
<polygon fill="black" stroke="black" points="553.5,-21991.76 550,-21981.76 546.5,-21991.76 553.5,-21991.76"/>
</g>
<!-- layer2_residual2_stage0 -->
<g id="node36" class="node">
<title>layer2_residual2_stage0</title>
<polygon fill="lightblue" stroke="black" points="550,-21696.17 26,-21644.17 550,-21592.17 1074,-21644.17 550,-21696.17"/>
<text text-anchor="middle" x="550" y="-21658.17" font-family="Arial" font-size="10.00">Layer 2 Residual Add 2</text>
<text text-anchor="middle" x="550" y="-21647.17" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-21636.17" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-21625.17" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer2_layernorm1_stage0&#45;&gt;layer2_residual2_stage0 -->
<g id="edge45" class="edge">
<title>layer2_layernorm1_stage0&#45;&gt;layer2_residual2_stage0</title>
<path fill="none" stroke="black" d="M598.46,-22105.48C646.51,-22076.59 713,-22024.39 713,-21956.71 713,-21956.71 713,-21956.71 713,-21866.71 713,-21806.75 735.05,-21782.85 703,-21732.17 692.85,-21716.12 678.6,-21702.73 662.85,-21691.66"/>
<polygon fill="black" stroke="black" points="664.75,-21688.72 654.49,-21686.08 660.87,-21694.55 664.75,-21688.72"/>
</g>
<!-- layer2_mlp_gelu_stage0 -->
<g id="node33" class="node">
<title>layer2_mlp_gelu_stage0</title>
<polygon fill="orange" stroke="black" points="388.5,-21981.71 101.5,-21981.71 101.5,-21929.71 388.5,-21929.71 388.5,-21981.71"/>
<text text-anchor="middle" x="245" y="-21969.71" font-family="Arial" font-size="10.00">Layer 2 MLP GELU</text>
<text text-anchor="middle" x="245" y="-21958.71" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="245" y="-21947.71" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="245" y="-21936.71" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer2_mlp_gate_stage0&#45;&gt;layer2_mlp_gelu_stage0 -->
<g id="edge40" class="edge">
<title>layer2_mlp_gate_stage0&#45;&gt;layer2_mlp_gelu_stage0</title>
<path fill="none" stroke="black" d="M295.08,-22017.37C287.93,-22008.71 279.83,-21998.9 272.25,-21989.72"/>
<polygon fill="black" stroke="black" points="274.83,-21987.35 265.77,-21981.87 269.44,-21991.81 274.83,-21987.35"/>
</g>
<!-- layer2_mlp_down_stage0 -->
<g id="node34" class="node">
<title>layer2_mlp_down_stage0</title>
<polygon fill="lightyellow" stroke="black" points="634.5,-21893.71 345.5,-21893.71 345.5,-21841.71 634.5,-21841.71 634.5,-21893.71"/>
<text text-anchor="middle" x="490" y="-21881.71" font-family="Arial" font-size="10.00">Layer 2 MLP Down Linear</text>
<text text-anchor="middle" x="490" y="-21870.71" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="490" y="-21859.71" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-21848.71" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer2_mlp_up_stage0&#45;&gt;layer2_mlp_down_stage0 -->
<g id="edge42" class="edge">
<title>layer2_mlp_up_stage0&#45;&gt;layer2_mlp_down_stage0</title>
<path fill="none" stroke="black" d="M532.32,-21929.37C526.4,-21920.89 519.71,-21911.29 513.42,-21902.28"/>
<polygon fill="black" stroke="black" points="516.14,-21900.07 507.55,-21893.87 510.4,-21904.07 516.14,-21900.07"/>
</g>
<!-- layer2_mlp_gelu_stage0&#45;&gt;layer2_mlp_down_stage0 -->
<g id="edge41" class="edge">
<title>layer2_mlp_gelu_stage0&#45;&gt;layer2_mlp_down_stage0</title>
<path fill="none" stroke="black" d="M316.52,-21929.61C345.45,-21919.45 379,-21907.68 408.84,-21897.2"/>
<polygon fill="black" stroke="black" points="410.11,-21900.46 418.39,-21893.85 407.79,-21893.86 410.11,-21900.46"/>
</g>
<!-- layer2_mlp_allreduce_stage0 -->
<g id="node35" class="node">
<title>layer2_mlp_allreduce_stage0</title>
<ellipse fill="lightgray" stroke="black" cx="490" cy="-21768.94" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="490" y="-21782.94" font-family="Arial" font-size="10.00">Layer 2 MLP All&#45;reduce</text>
<text text-anchor="middle" x="490" y="-21771.94" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-21760.94" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-21749.94" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer2_mlp_down_stage0&#45;&gt;layer2_mlp_allreduce_stage0 -->
<g id="edge43" class="edge">
<title>layer2_mlp_down_stage0&#45;&gt;layer2_mlp_allreduce_stage0</title>
<path fill="none" stroke="black" d="M490,-21841.54C490,-21833.73 490,-21824.87 490,-21816.1"/>
<polygon fill="black" stroke="black" points="493.5,-21815.92 490,-21805.92 486.5,-21815.92 493.5,-21815.92"/>
</g>
<!-- layer2_mlp_allreduce_stage0&#45;&gt;layer2_residual2_stage0 -->
<g id="edge44" class="edge">
<title>layer2_mlp_allreduce_stage0&#45;&gt;layer2_residual2_stage0</title>
<path fill="none" stroke="black" d="M507.52,-21732.1C511.96,-21723 516.86,-21712.98 521.7,-21703.09"/>
<polygon fill="black" stroke="black" points="524.86,-21704.59 526.11,-21694.06 518.57,-21701.51 524.86,-21704.59"/>
</g>
<!-- layer2_layernorm2_stage0 -->
<g id="node37" class="node">
<title>layer2_layernorm2_stage0</title>
<polygon fill="lightgreen" stroke="black" points="694.5,-21556.17 405.5,-21556.17 405.5,-21504.17 694.5,-21504.17 694.5,-21556.17"/>
<text text-anchor="middle" x="550" y="-21544.17" font-family="Arial" font-size="10.00">Layer 2 Layer Norm 2</text>
<text text-anchor="middle" x="550" y="-21533.17" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-21522.17" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-21511.17" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer2_residual2_stage0&#45;&gt;layer2_layernorm2_stage0 -->
<g id="edge46" class="edge">
<title>layer2_residual2_stage0&#45;&gt;layer2_layernorm2_stage0</title>
<path fill="none" stroke="black" d="M550,-21592.09C550,-21583.42 550,-21574.6 550,-21566.46"/>
<polygon fill="black" stroke="black" points="553.5,-21566.22 550,-21556.22 546.5,-21566.22 553.5,-21566.22"/>
</g>
<!-- layer3_input_stage0 -->
<g id="node38" class="node">
<title>layer3_input_stage0</title>
<polygon fill="lightyellow" stroke="black" points="849.74,-21468.17 372.92,-21468.17 250.26,-21364.17 727.08,-21364.17 849.74,-21468.17"/>
<text text-anchor="middle" x="550" y="-21430.17" font-family="Arial" font-size="10.00">Layer 3 Input</text>
<text text-anchor="middle" x="550" y="-21419.17" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-21408.17" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-21397.17" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer2_layernorm2_stage0&#45;&gt;layer3_input_stage0 -->
<g id="edge47" class="edge">
<title>layer2_layernorm2_stage0&#45;&gt;layer3_input_stage0</title>
<path fill="none" stroke="black" d="M550,-21504.04C550,-21496.35 550,-21487.54 550,-21478.54"/>
<polygon fill="black" stroke="black" points="553.5,-21478.35 550,-21468.35 546.5,-21478.35 553.5,-21478.35"/>
</g>
<!-- layer3_mha_query_stage0 -->
<g id="node39" class="node">
<title>layer3_mha_query_stage0</title>
<polygon fill="pink" stroke="black" points="353.5,-21328.17 62.5,-21328.17 62.5,-21276.17 353.5,-21276.17 353.5,-21328.17"/>
<text text-anchor="middle" x="208" y="-21316.17" font-family="Arial" font-size="10.00">Layer 3 MHA Query Linear</text>
<text text-anchor="middle" x="208" y="-21305.17" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="208" y="-21294.17" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_q=512]</text>
<text text-anchor="middle" x="208" y="-21283.17" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer3_input_stage0&#45;&gt;layer3_mha_query_stage0 -->
<g id="edge48" class="edge">
<title>layer3_input_stage0&#45;&gt;layer3_mha_query_stage0</title>
<path fill="none" stroke="black" d="M394.01,-21364.09C359.68,-21352.84 324.53,-21341.33 294.16,-21331.39"/>
<polygon fill="black" stroke="black" points="295.06,-21328 284.47,-21328.22 292.89,-21334.66 295.06,-21328"/>
</g>
<!-- layer3_mha_key_stage0 -->
<g id="node40" class="node">
<title>layer3_mha_key_stage0</title>
<polygon fill="pink" stroke="black" points="662.5,-21328.17 371.5,-21328.17 371.5,-21276.17 662.5,-21276.17 662.5,-21328.17"/>
<text text-anchor="middle" x="517" y="-21316.17" font-family="Arial" font-size="10.00">Layer 3 MHA Key Linear</text>
<text text-anchor="middle" x="517" y="-21305.17" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="517" y="-21294.17" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="517" y="-21283.17" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer3_input_stage0&#45;&gt;layer3_mha_key_stage0 -->
<g id="edge49" class="edge">
<title>layer3_input_stage0&#45;&gt;layer3_mha_key_stage0</title>
<path fill="none" stroke="black" d="M534.95,-21364.09C532.34,-21355.23 529.68,-21346.21 527.24,-21337.91"/>
<polygon fill="black" stroke="black" points="530.56,-21336.82 524.38,-21328.22 523.85,-21338.8 530.56,-21336.82"/>
</g>
<!-- layer3_mha_value_stage0 -->
<g id="node41" class="node">
<title>layer3_mha_value_stage0</title>
<polygon fill="pink" stroke="black" points="687.5,-21240.17 396.5,-21240.17 396.5,-21188.17 687.5,-21188.17 687.5,-21240.17"/>
<text text-anchor="middle" x="542" y="-21228.17" font-family="Arial" font-size="10.00">Layer 3 MHA Value Linear</text>
<text text-anchor="middle" x="542" y="-21217.17" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="542" y="-21206.17" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_v=512]</text>
<text text-anchor="middle" x="542" y="-21195.17" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer3_input_stage0&#45;&gt;layer3_mha_value_stage0 -->
<g id="edge50" class="edge">
<title>layer3_input_stage0&#45;&gt;layer3_mha_value_stage0</title>
<path fill="none" stroke="black" d="M643.06,-21364.15C654.7,-21353.79 664.97,-21341.82 672,-21328.17 682.58,-21307.63 684.39,-21295.68 672,-21276.17 663.88,-21263.4 652.31,-21253.25 639.37,-21245.21"/>
<polygon fill="black" stroke="black" points="641.1,-21242.17 630.69,-21240.22 637.61,-21248.24 641.1,-21242.17"/>
</g>
<!-- layer3_residual1_stage0 -->
<g id="node47" class="node">
<title>layer3_residual1_stage0</title>
<polygon fill="lightblue" stroke="black" points="550,-20778.63 26,-20726.63 550,-20674.63 1074,-20726.63 550,-20778.63"/>
<text text-anchor="middle" x="550" y="-20740.63" font-family="Arial" font-size="10.00">Layer 3 Residual Add 1</text>
<text text-anchor="middle" x="550" y="-20729.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-20718.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-20707.63" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer3_input_stage0&#45;&gt;layer3_residual1_stage0 -->
<g id="edge59" class="edge">
<title>layer3_input_stage0&#45;&gt;layer3_residual1_stage0</title>
<path fill="none" stroke="black" d="M646.49,-21364.03C659.62,-21353.64 671.74,-21341.68 681,-21328.17 710.09,-21285.75 706,-21266.61 706,-21215.17 706,-21215.17 706,-21215.17 706,-20949.17 706,-20889.21 727.53,-20865.63 696,-20814.63 686.31,-20798.96 672.66,-20785.76 657.56,-20774.76"/>
<polygon fill="black" stroke="black" points="659.26,-20771.68 649.04,-20768.87 655.28,-20777.43 659.26,-20771.68"/>
</g>
<!-- layer3_mha_qkt_stage0 -->
<g id="node42" class="node">
<title>layer3_mha_qkt_stage0</title>
<polygon fill="lightcoral" stroke="black" points="378,-21240.17 58,-21240.17 58,-21188.17 378,-21188.17 378,-21240.17"/>
<text text-anchor="middle" x="218" y="-21228.17" font-family="Arial" font-size="10.00">Layer 3 MHA QKT Calculation</text>
<text text-anchor="middle" x="218" y="-21217.17" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="218" y="-21206.17" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="218" y="-21195.17" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer3_mha_query_stage0&#45;&gt;layer3_mha_qkt_stage0 -->
<g id="edge51" class="edge">
<title>layer3_mha_query_stage0&#45;&gt;layer3_mha_qkt_stage0</title>
<path fill="none" stroke="black" d="M210.95,-21275.84C211.87,-21267.87 212.91,-21258.94 213.9,-21250.42"/>
<polygon fill="black" stroke="black" points="217.4,-21250.67 215.07,-21240.33 210.44,-21249.86 217.4,-21250.67"/>
</g>
<!-- layer3_mha_key_stage0&#45;&gt;layer3_mha_qkt_stage0 -->
<g id="edge52" class="edge">
<title>layer3_mha_key_stage0&#45;&gt;layer3_mha_qkt_stage0</title>
<path fill="none" stroke="black" d="M429.71,-21276.07C393.72,-21265.71 351.86,-21253.67 314.92,-21243.05"/>
<polygon fill="black" stroke="black" points="315.71,-21239.64 305.14,-21240.24 313.78,-21246.36 315.71,-21239.64"/>
</g>
<!-- layer3_mha_apply_stage0 -->
<g id="node44" class="node">
<title>layer3_mha_apply_stage0</title>
<polygon fill="lightcoral" stroke="black" points="639,-21064.17 327,-21064.17 327,-21012.17 639,-21012.17 639,-21064.17"/>
<text text-anchor="middle" x="483" y="-21052.17" font-family="Arial" font-size="10.00">Layer 3 MHA Apply Attention</text>
<text text-anchor="middle" x="483" y="-21041.17" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="483" y="-21030.17" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="483" y="-21019.17" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer3_mha_value_stage0&#45;&gt;layer3_mha_apply_stage0 -->
<g id="edge55" class="edge">
<title>layer3_mha_value_stage0&#45;&gt;layer3_mha_apply_stage0</title>
<path fill="none" stroke="black" d="M533.42,-21187.87C523.25,-21157.89 506.26,-21107.77 494.84,-21074.1"/>
<polygon fill="black" stroke="black" points="498.02,-21072.57 491.49,-21064.22 491.39,-21074.82 498.02,-21072.57"/>
</g>
<!-- layer3_mha_weights_stage0 -->
<g id="node43" class="node">
<title>layer3_mha_weights_stage0</title>
<polygon fill="lightcoral" stroke="black" points="436,-21152.17 116,-21152.17 116,-21100.17 436,-21100.17 436,-21152.17"/>
<text text-anchor="middle" x="276" y="-21140.17" font-family="Arial" font-size="10.00">Layer 3 MHA Attention Weights</text>
<text text-anchor="middle" x="276" y="-21129.17" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="276" y="-21118.17" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="276" y="-21107.17" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer3_mha_qkt_stage0&#45;&gt;layer3_mha_weights_stage0 -->
<g id="edge53" class="edge">
<title>layer3_mha_qkt_stage0&#45;&gt;layer3_mha_weights_stage0</title>
<path fill="none" stroke="black" d="M235.09,-21187.84C240.81,-21179.35 247.28,-21169.75 253.36,-21160.74"/>
<polygon fill="black" stroke="black" points="256.34,-21162.58 259.03,-21152.33 250.54,-21158.66 256.34,-21162.58"/>
</g>
<!-- layer3_mha_weights_stage0&#45;&gt;layer3_mha_apply_stage0 -->
<g id="edge54" class="edge">
<title>layer3_mha_weights_stage0&#45;&gt;layer3_mha_apply_stage0</title>
<path fill="none" stroke="black" d="M336.43,-21100.07C360.45,-21090.09 388.24,-21078.54 413.12,-21068.21"/>
<polygon fill="black" stroke="black" points="414.6,-21071.38 422.5,-21064.31 411.92,-21064.91 414.6,-21071.38"/>
</g>
<!-- layer3_mha_out_stage0 -->
<g id="node45" class="node">
<title>layer3_mha_out_stage0</title>
<polygon fill="pink" stroke="black" points="627.5,-20976.17 338.5,-20976.17 338.5,-20924.17 627.5,-20924.17 627.5,-20976.17"/>
<text text-anchor="middle" x="483" y="-20964.17" font-family="Arial" font-size="10.00">Layer 3 MHA Output Linear</text>
<text text-anchor="middle" x="483" y="-20953.17" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="483" y="-20942.17" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="483" y="-20931.17" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer3_mha_apply_stage0&#45;&gt;layer3_mha_out_stage0 -->
<g id="edge56" class="edge">
<title>layer3_mha_apply_stage0&#45;&gt;layer3_mha_out_stage0</title>
<path fill="none" stroke="black" d="M483,-21011.84C483,-21003.87 483,-20994.94 483,-20986.42"/>
<polygon fill="black" stroke="black" points="486.5,-20986.33 483,-20976.33 479.5,-20986.33 486.5,-20986.33"/>
</g>
<!-- layer3_mha_allreduce_stage0 -->
<g id="node46" class="node">
<title>layer3_mha_allreduce_stage0</title>
<ellipse fill="lightgray" stroke="black" cx="483" cy="-20851.4" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="483" y="-20865.4" font-family="Arial" font-size="10.00">Layer 3 MHA All&#45;reduce</text>
<text text-anchor="middle" x="483" y="-20854.4" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="483" y="-20843.4" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="483" y="-20832.4" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer3_mha_out_stage0&#45;&gt;layer3_mha_allreduce_stage0 -->
<g id="edge57" class="edge">
<title>layer3_mha_out_stage0&#45;&gt;layer3_mha_allreduce_stage0</title>
<path fill="none" stroke="black" d="M483,-20924C483,-20916.19 483,-20907.33 483,-20898.56"/>
<polygon fill="black" stroke="black" points="486.5,-20898.38 483,-20888.38 479.5,-20898.38 486.5,-20898.38"/>
</g>
<!-- layer3_mha_allreduce_stage0&#45;&gt;layer3_residual1_stage0 -->
<g id="edge58" class="edge">
<title>layer3_mha_allreduce_stage0&#45;&gt;layer3_residual1_stage0</title>
<path fill="none" stroke="black" d="M502.56,-20814.56C507.64,-20805.26 513.24,-20795 518.75,-20784.89"/>
<polygon fill="black" stroke="black" points="521.85,-20786.53 523.57,-20776.07 515.7,-20783.17 521.85,-20786.53"/>
</g>
<!-- layer3_layernorm1_stage0 -->
<g id="node48" class="node">
<title>layer3_layernorm1_stage0</title>
<polygon fill="lightgreen" stroke="black" points="694.5,-20638.63 405.5,-20638.63 405.5,-20586.63 694.5,-20586.63 694.5,-20638.63"/>
<text text-anchor="middle" x="550" y="-20626.63" font-family="Arial" font-size="10.00">Layer 3 Layer Norm 1</text>
<text text-anchor="middle" x="550" y="-20615.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-20604.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-20593.63" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer3_residual1_stage0&#45;&gt;layer3_layernorm1_stage0 -->
<g id="edge60" class="edge">
<title>layer3_residual1_stage0&#45;&gt;layer3_layernorm1_stage0</title>
<path fill="none" stroke="black" d="M550,-20674.55C550,-20665.89 550,-20657.06 550,-20648.92"/>
<polygon fill="black" stroke="black" points="553.5,-20648.68 550,-20638.68 546.5,-20648.68 553.5,-20648.68"/>
</g>
<!-- layer3_mlp_gate_stage0 -->
<g id="node49" class="node">
<title>layer3_mlp_gate_stage0</title>
<polygon fill="lightyellow" stroke="black" points="459.5,-20550.63 172.5,-20550.63 172.5,-20498.63 459.5,-20498.63 459.5,-20550.63"/>
<text text-anchor="middle" x="316" y="-20538.63" font-family="Arial" font-size="10.00">Layer 3 MLP Gate Linear</text>
<text text-anchor="middle" x="316" y="-20527.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="316" y="-20516.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="316" y="-20505.63" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer3_layernorm1_stage0&#45;&gt;layer3_mlp_gate_stage0 -->
<g id="edge61" class="edge">
<title>layer3_layernorm1_stage0&#45;&gt;layer3_mlp_gate_stage0</title>
<path fill="none" stroke="black" d="M481.69,-20586.53C454.18,-20576.42 422.29,-20564.7 393.89,-20554.26"/>
<polygon fill="black" stroke="black" points="394.99,-20550.94 384.4,-20550.77 392.58,-20557.51 394.99,-20550.94"/>
</g>
<!-- layer3_mlp_up_stage0 -->
<g id="node50" class="node">
<title>layer3_mlp_up_stage0</title>
<polygon fill="lightyellow" stroke="black" points="693.5,-20462.63 406.5,-20462.63 406.5,-20410.63 693.5,-20410.63 693.5,-20462.63"/>
<text text-anchor="middle" x="550" y="-20450.63" font-family="Arial" font-size="10.00">Layer 3 MLP Up Linear</text>
<text text-anchor="middle" x="550" y="-20439.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-20428.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="550" y="-20417.63" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer3_layernorm1_stage0&#45;&gt;layer3_mlp_up_stage0 -->
<g id="edge62" class="edge">
<title>layer3_layernorm1_stage0&#45;&gt;layer3_mlp_up_stage0</title>
<path fill="none" stroke="black" d="M550,-20586.33C550,-20556.48 550,-20506.66 550,-20473"/>
<polygon fill="black" stroke="black" points="553.5,-20472.68 550,-20462.68 546.5,-20472.68 553.5,-20472.68"/>
</g>
<!-- layer3_residual2_stage0 -->
<g id="node54" class="node">
<title>layer3_residual2_stage0</title>
<polygon fill="lightblue" stroke="black" points="550,-20177.09 26,-20125.09 550,-20073.09 1074,-20125.09 550,-20177.09"/>
<text text-anchor="middle" x="550" y="-20139.09" font-family="Arial" font-size="10.00">Layer 3 Residual Add 2</text>
<text text-anchor="middle" x="550" y="-20128.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-20117.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-20106.09" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer3_layernorm1_stage0&#45;&gt;layer3_residual2_stage0 -->
<g id="edge68" class="edge">
<title>layer3_layernorm1_stage0&#45;&gt;layer3_residual2_stage0</title>
<path fill="none" stroke="black" d="M598.46,-20586.41C646.51,-20557.52 713,-20505.31 713,-20437.63 713,-20437.63 713,-20437.63 713,-20347.63 713,-20287.67 735.05,-20263.77 703,-20213.09 692.85,-20197.04 678.6,-20183.65 662.85,-20172.59"/>
<polygon fill="black" stroke="black" points="664.75,-20169.65 654.49,-20167.01 660.87,-20175.47 664.75,-20169.65"/>
</g>
<!-- layer3_mlp_gelu_stage0 -->
<g id="node51" class="node">
<title>layer3_mlp_gelu_stage0</title>
<polygon fill="orange" stroke="black" points="388.5,-20462.63 101.5,-20462.63 101.5,-20410.63 388.5,-20410.63 388.5,-20462.63"/>
<text text-anchor="middle" x="245" y="-20450.63" font-family="Arial" font-size="10.00">Layer 3 MLP GELU</text>
<text text-anchor="middle" x="245" y="-20439.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="245" y="-20428.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="245" y="-20417.63" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer3_mlp_gate_stage0&#45;&gt;layer3_mlp_gelu_stage0 -->
<g id="edge63" class="edge">
<title>layer3_mlp_gate_stage0&#45;&gt;layer3_mlp_gelu_stage0</title>
<path fill="none" stroke="black" d="M295.08,-20498.3C287.93,-20489.64 279.83,-20479.82 272.25,-20470.64"/>
<polygon fill="black" stroke="black" points="274.83,-20468.27 265.77,-20462.79 269.44,-20472.73 274.83,-20468.27"/>
</g>
<!-- layer3_mlp_down_stage0 -->
<g id="node52" class="node">
<title>layer3_mlp_down_stage0</title>
<polygon fill="lightyellow" stroke="black" points="634.5,-20374.63 345.5,-20374.63 345.5,-20322.63 634.5,-20322.63 634.5,-20374.63"/>
<text text-anchor="middle" x="490" y="-20362.63" font-family="Arial" font-size="10.00">Layer 3 MLP Down Linear</text>
<text text-anchor="middle" x="490" y="-20351.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="490" y="-20340.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-20329.63" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer3_mlp_up_stage0&#45;&gt;layer3_mlp_down_stage0 -->
<g id="edge65" class="edge">
<title>layer3_mlp_up_stage0&#45;&gt;layer3_mlp_down_stage0</title>
<path fill="none" stroke="black" d="M532.32,-20410.3C526.4,-20401.81 519.71,-20392.21 513.42,-20383.2"/>
<polygon fill="black" stroke="black" points="516.14,-20380.99 507.55,-20374.79 510.4,-20384.99 516.14,-20380.99"/>
</g>
<!-- layer3_mlp_gelu_stage0&#45;&gt;layer3_mlp_down_stage0 -->
<g id="edge64" class="edge">
<title>layer3_mlp_gelu_stage0&#45;&gt;layer3_mlp_down_stage0</title>
<path fill="none" stroke="black" d="M316.52,-20410.53C345.45,-20400.37 379,-20388.6 408.84,-20378.12"/>
<polygon fill="black" stroke="black" points="410.11,-20381.39 418.39,-20374.77 407.79,-20374.78 410.11,-20381.39"/>
</g>
<!-- layer3_mlp_allreduce_stage0 -->
<g id="node53" class="node">
<title>layer3_mlp_allreduce_stage0</title>
<ellipse fill="lightgray" stroke="black" cx="490" cy="-20249.86" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="490" y="-20263.86" font-family="Arial" font-size="10.00">Layer 3 MLP All&#45;reduce</text>
<text text-anchor="middle" x="490" y="-20252.86" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-20241.86" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-20230.86" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer3_mlp_down_stage0&#45;&gt;layer3_mlp_allreduce_stage0 -->
<g id="edge66" class="edge">
<title>layer3_mlp_down_stage0&#45;&gt;layer3_mlp_allreduce_stage0</title>
<path fill="none" stroke="black" d="M490,-20322.46C490,-20314.65 490,-20305.79 490,-20297.02"/>
<polygon fill="black" stroke="black" points="493.5,-20296.84 490,-20286.84 486.5,-20296.84 493.5,-20296.84"/>
</g>
<!-- layer3_mlp_allreduce_stage0&#45;&gt;layer3_residual2_stage0 -->
<g id="edge67" class="edge">
<title>layer3_mlp_allreduce_stage0&#45;&gt;layer3_residual2_stage0</title>
<path fill="none" stroke="black" d="M507.52,-20213.02C511.96,-20203.92 516.86,-20193.91 521.7,-20184.01"/>
<polygon fill="black" stroke="black" points="524.86,-20185.51 526.11,-20174.99 518.57,-20182.43 524.86,-20185.51"/>
</g>
<!-- layer3_layernorm2_stage0 -->
<g id="node55" class="node">
<title>layer3_layernorm2_stage0</title>
<polygon fill="lightgreen" stroke="black" points="694.5,-20037.09 405.5,-20037.09 405.5,-19985.09 694.5,-19985.09 694.5,-20037.09"/>
<text text-anchor="middle" x="550" y="-20025.09" font-family="Arial" font-size="10.00">Layer 3 Layer Norm 2</text>
<text text-anchor="middle" x="550" y="-20014.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-20003.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-19992.09" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer3_residual2_stage0&#45;&gt;layer3_layernorm2_stage0 -->
<g id="edge69" class="edge">
<title>layer3_residual2_stage0&#45;&gt;layer3_layernorm2_stage0</title>
<path fill="none" stroke="black" d="M550,-20073.01C550,-20064.35 550,-20055.52 550,-20047.38"/>
<polygon fill="black" stroke="black" points="553.5,-20047.14 550,-20037.14 546.5,-20047.14 553.5,-20047.14"/>
</g>
<!-- layer4_input_stage0 -->
<g id="node56" class="node">
<title>layer4_input_stage0</title>
<polygon fill="lightyellow" stroke="black" points="849.74,-19949.09 372.92,-19949.09 250.26,-19845.09 727.08,-19845.09 849.74,-19949.09"/>
<text text-anchor="middle" x="550" y="-19911.09" font-family="Arial" font-size="10.00">Layer 4 Input</text>
<text text-anchor="middle" x="550" y="-19900.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-19889.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-19878.09" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer3_layernorm2_stage0&#45;&gt;layer4_input_stage0 -->
<g id="edge70" class="edge">
<title>layer3_layernorm2_stage0&#45;&gt;layer4_input_stage0</title>
<path fill="none" stroke="black" d="M550,-19984.96C550,-19977.28 550,-19968.46 550,-19959.46"/>
<polygon fill="black" stroke="black" points="553.5,-19959.27 550,-19949.27 546.5,-19959.27 553.5,-19959.27"/>
</g>
<!-- layer4_mha_query_stage0 -->
<g id="node57" class="node">
<title>layer4_mha_query_stage0</title>
<polygon fill="pink" stroke="black" points="321.5,-19809.09 30.5,-19809.09 30.5,-19757.09 321.5,-19757.09 321.5,-19809.09"/>
<text text-anchor="middle" x="176" y="-19797.09" font-family="Arial" font-size="10.00">Layer 4 MHA Query Linear</text>
<text text-anchor="middle" x="176" y="-19786.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="176" y="-19775.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_q=512]</text>
<text text-anchor="middle" x="176" y="-19764.09" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer4_input_stage0&#45;&gt;layer4_mha_query_stage0 -->
<g id="edge71" class="edge">
<title>layer4_input_stage0&#45;&gt;layer4_mha_query_stage0</title>
<path fill="none" stroke="black" d="M379.69,-19845.09C341.78,-19833.74 302.96,-19822.11 269.51,-19812.1"/>
<polygon fill="black" stroke="black" points="270.35,-19808.69 259.76,-19809.18 268.34,-19815.4 270.35,-19808.69"/>
</g>
<!-- layer4_mha_key_stage0 -->
<g id="node58" class="node">
<title>layer4_mha_key_stage0</title>
<polygon fill="pink" stroke="black" points="630.5,-19809.09 339.5,-19809.09 339.5,-19757.09 630.5,-19757.09 630.5,-19809.09"/>
<text text-anchor="middle" x="485" y="-19797.09" font-family="Arial" font-size="10.00">Layer 4 MHA Key Linear</text>
<text text-anchor="middle" x="485" y="-19786.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="485" y="-19775.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="485" y="-19764.09" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer4_input_stage0&#45;&gt;layer4_mha_key_stage0 -->
<g id="edge72" class="edge">
<title>layer4_input_stage0&#45;&gt;layer4_mha_key_stage0</title>
<path fill="none" stroke="black" d="M520.35,-19845.01C515.04,-19835.86 509.63,-19826.53 504.69,-19818.01"/>
<polygon fill="black" stroke="black" points="507.58,-19816.03 499.53,-19809.14 501.53,-19819.54 507.58,-19816.03"/>
</g>
<!-- layer4_mha_value_stage0 -->
<g id="node59" class="node">
<title>layer4_mha_value_stage0</title>
<polygon fill="pink" stroke="black" points="704.5,-19721.09 413.5,-19721.09 413.5,-19669.09 704.5,-19669.09 704.5,-19721.09"/>
<text text-anchor="middle" x="559" y="-19709.09" font-family="Arial" font-size="10.00">Layer 4 MHA Value Linear</text>
<text text-anchor="middle" x="559" y="-19698.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-19687.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_v=512]</text>
<text text-anchor="middle" x="559" y="-19676.09" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer4_input_stage0&#45;&gt;layer4_mha_value_stage0 -->
<g id="edge73" class="edge">
<title>layer4_input_stage0&#45;&gt;layer4_mha_value_stage0</title>
<path fill="none" stroke="black" d="M616.33,-19844.79C625.97,-19834.11 634.48,-19822.1 640,-19809.09 649.02,-19787.82 650.32,-19777.78 640,-19757.09 634.3,-19745.66 625.31,-19735.8 615.37,-19727.55"/>
<polygon fill="black" stroke="black" points="617.29,-19724.61 607.24,-19721.28 613.02,-19730.16 617.29,-19724.61"/>
</g>
<!-- layer4_residual1_stage0 -->
<g id="node65" class="node">
<title>layer4_residual1_stage0</title>
<polygon fill="lightblue" stroke="black" points="550,-19259.56 26,-19207.56 550,-19155.56 1074,-19207.56 550,-19259.56"/>
<text text-anchor="middle" x="550" y="-19221.56" font-family="Arial" font-size="10.00">Layer 4 Residual Add 1</text>
<text text-anchor="middle" x="550" y="-19210.56" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-19199.56" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-19188.56" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer4_input_stage0&#45;&gt;layer4_residual1_stage0 -->
<g id="edge82" class="edge">
<title>layer4_input_stage0&#45;&gt;layer4_residual1_stage0</title>
<path fill="none" stroke="black" d="M630.42,-19845.04C675.6,-19809.53 723,-19757.61 723,-19696.09 723,-19696.09 723,-19696.09 723,-19430.09 723,-19370.13 745.73,-19345.8 713,-19295.56 702.19,-19278.96 687.12,-19265.31 670.46,-19254.15"/>
<polygon fill="black" stroke="black" points="671.94,-19250.94 661.62,-19248.54 668.19,-19256.85 671.94,-19250.94"/>
</g>
<!-- layer4_mha_qkt_stage0 -->
<g id="node60" class="node">
<title>layer4_mha_qkt_stage0</title>
<polygon fill="lightcoral" stroke="black" points="395,-19721.09 75,-19721.09 75,-19669.09 395,-19669.09 395,-19721.09"/>
<text text-anchor="middle" x="235" y="-19709.09" font-family="Arial" font-size="10.00">Layer 4 MHA QKT Calculation</text>
<text text-anchor="middle" x="235" y="-19698.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="235" y="-19687.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="235" y="-19676.09" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer4_mha_query_stage0&#45;&gt;layer4_mha_qkt_stage0 -->
<g id="edge74" class="edge">
<title>layer4_mha_query_stage0&#45;&gt;layer4_mha_qkt_stage0</title>
<path fill="none" stroke="black" d="M193.38,-19756.76C199.2,-19748.27 205.79,-19738.68 211.97,-19729.66"/>
<polygon fill="black" stroke="black" points="214.97,-19731.48 217.74,-19721.25 209.2,-19727.52 214.97,-19731.48"/>
</g>
<!-- layer4_mha_key_stage0&#45;&gt;layer4_mha_qkt_stage0 -->
<g id="edge75" class="edge">
<title>layer4_mha_key_stage0&#45;&gt;layer4_mha_qkt_stage0</title>
<path fill="none" stroke="black" d="M412.02,-19756.99C382.5,-19746.83 348.26,-19735.06 317.82,-19724.58"/>
<polygon fill="black" stroke="black" points="318.67,-19721.18 308.07,-19721.23 316.39,-19727.79 318.67,-19721.18"/>
</g>
<!-- layer4_mha_apply_stage0 -->
<g id="node62" class="node">
<title>layer4_mha_apply_stage0</title>
<polygon fill="lightcoral" stroke="black" points="656,-19545.09 344,-19545.09 344,-19493.09 656,-19493.09 656,-19545.09"/>
<text text-anchor="middle" x="500" y="-19533.09" font-family="Arial" font-size="10.00">Layer 4 MHA Apply Attention</text>
<text text-anchor="middle" x="500" y="-19522.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="500" y="-19511.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="500" y="-19500.09" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer4_mha_value_stage0&#45;&gt;layer4_mha_apply_stage0 -->
<g id="edge78" class="edge">
<title>layer4_mha_value_stage0&#45;&gt;layer4_mha_apply_stage0</title>
<path fill="none" stroke="black" d="M550.42,-19668.79C540.25,-19638.81 523.26,-19588.69 511.84,-19555.02"/>
<polygon fill="black" stroke="black" points="515.02,-19553.49 508.49,-19545.14 508.39,-19555.74 515.02,-19553.49"/>
</g>
<!-- layer4_mha_weights_stage0 -->
<g id="node61" class="node">
<title>layer4_mha_weights_stage0</title>
<polygon fill="lightcoral" stroke="black" points="439,-19633.09 119,-19633.09 119,-19581.09 439,-19581.09 439,-19633.09"/>
<text text-anchor="middle" x="279" y="-19621.09" font-family="Arial" font-size="10.00">Layer 4 MHA Attention Weights</text>
<text text-anchor="middle" x="279" y="-19610.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="279" y="-19599.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="279" y="-19588.09" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer4_mha_qkt_stage0&#45;&gt;layer4_mha_weights_stage0 -->
<g id="edge76" class="edge">
<title>layer4_mha_qkt_stage0&#45;&gt;layer4_mha_weights_stage0</title>
<path fill="none" stroke="black" d="M247.96,-19668.76C252.22,-19660.45 257.01,-19651.07 261.54,-19642.22"/>
<polygon fill="black" stroke="black" points="264.69,-19643.75 266.13,-19633.25 258.46,-19640.56 264.69,-19643.75"/>
</g>
<!-- layer4_mha_weights_stage0&#45;&gt;layer4_mha_apply_stage0 -->
<g id="edge77" class="edge">
<title>layer4_mha_weights_stage0&#45;&gt;layer4_mha_apply_stage0</title>
<path fill="none" stroke="black" d="M343.52,-19580.99C369.27,-19570.97 399.09,-19559.36 425.74,-19548.99"/>
<polygon fill="black" stroke="black" points="427.35,-19552.12 435.4,-19545.23 424.81,-19545.6 427.35,-19552.12"/>
</g>
<!-- layer4_mha_out_stage0 -->
<g id="node63" class="node">
<title>layer4_mha_out_stage0</title>
<polygon fill="pink" stroke="black" points="644.5,-19457.09 355.5,-19457.09 355.5,-19405.09 644.5,-19405.09 644.5,-19457.09"/>
<text text-anchor="middle" x="500" y="-19445.09" font-family="Arial" font-size="10.00">Layer 4 MHA Output Linear</text>
<text text-anchor="middle" x="500" y="-19434.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="500" y="-19423.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="500" y="-19412.09" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer4_mha_apply_stage0&#45;&gt;layer4_mha_out_stage0 -->
<g id="edge79" class="edge">
<title>layer4_mha_apply_stage0&#45;&gt;layer4_mha_out_stage0</title>
<path fill="none" stroke="black" d="M500,-19492.76C500,-19484.8 500,-19475.86 500,-19467.34"/>
<polygon fill="black" stroke="black" points="503.5,-19467.25 500,-19457.25 496.5,-19467.25 503.5,-19467.25"/>
</g>
<!-- layer4_mha_allreduce_stage0 -->
<g id="node64" class="node">
<title>layer4_mha_allreduce_stage0</title>
<ellipse fill="lightgray" stroke="black" cx="500" cy="-19332.33" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="500" y="-19346.33" font-family="Arial" font-size="10.00">Layer 4 MHA All&#45;reduce</text>
<text text-anchor="middle" x="500" y="-19335.33" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="500" y="-19324.33" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="500" y="-19313.33" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer4_mha_out_stage0&#45;&gt;layer4_mha_allreduce_stage0 -->
<g id="edge80" class="edge">
<title>layer4_mha_out_stage0&#45;&gt;layer4_mha_allreduce_stage0</title>
<path fill="none" stroke="black" d="M500,-19404.92C500,-19397.11 500,-19388.25 500,-19379.48"/>
<polygon fill="black" stroke="black" points="503.5,-19379.3 500,-19369.3 496.5,-19379.3 503.5,-19379.3"/>
</g>
<!-- layer4_mha_allreduce_stage0&#45;&gt;layer4_residual1_stage0 -->
<g id="edge81" class="edge">
<title>layer4_mha_allreduce_stage0&#45;&gt;layer4_residual1_stage0</title>
<path fill="none" stroke="black" d="M514.6,-19295.49C518.19,-19286.67 522.12,-19277.01 526.03,-19267.42"/>
<polygon fill="black" stroke="black" points="529.37,-19268.48 529.9,-19257.9 522.89,-19265.84 529.37,-19268.48"/>
</g>
<!-- layer4_layernorm1_stage0 -->
<g id="node66" class="node">
<title>layer4_layernorm1_stage0</title>
<polygon fill="lightgreen" stroke="black" points="694.5,-19119.56 405.5,-19119.56 405.5,-19067.56 694.5,-19067.56 694.5,-19119.56"/>
<text text-anchor="middle" x="550" y="-19107.56" font-family="Arial" font-size="10.00">Layer 4 Layer Norm 1</text>
<text text-anchor="middle" x="550" y="-19096.56" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-19085.56" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-19074.56" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer4_residual1_stage0&#45;&gt;layer4_layernorm1_stage0 -->
<g id="edge83" class="edge">
<title>layer4_residual1_stage0&#45;&gt;layer4_layernorm1_stage0</title>
<path fill="none" stroke="black" d="M550,-19155.47C550,-19146.81 550,-19137.98 550,-19129.84"/>
<polygon fill="black" stroke="black" points="553.5,-19129.6 550,-19119.6 546.5,-19129.6 553.5,-19129.6"/>
</g>
<!-- layer4_mlp_gate_stage0 -->
<g id="node67" class="node">
<title>layer4_mlp_gate_stage0</title>
<polygon fill="lightyellow" stroke="black" points="459.5,-19031.56 172.5,-19031.56 172.5,-18979.56 459.5,-18979.56 459.5,-19031.56"/>
<text text-anchor="middle" x="316" y="-19019.56" font-family="Arial" font-size="10.00">Layer 4 MLP Gate Linear</text>
<text text-anchor="middle" x="316" y="-19008.56" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="316" y="-18997.56" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="316" y="-18986.56" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer4_layernorm1_stage0&#45;&gt;layer4_mlp_gate_stage0 -->
<g id="edge84" class="edge">
<title>layer4_layernorm1_stage0&#45;&gt;layer4_mlp_gate_stage0</title>
<path fill="none" stroke="black" d="M481.69,-19067.45C454.18,-19057.34 422.29,-19045.62 393.89,-19035.18"/>
<polygon fill="black" stroke="black" points="394.99,-19031.86 384.4,-19031.69 392.58,-19038.43 394.99,-19031.86"/>
</g>
<!-- layer4_mlp_up_stage0 -->
<g id="node68" class="node">
<title>layer4_mlp_up_stage0</title>
<polygon fill="lightyellow" stroke="black" points="693.5,-18943.56 406.5,-18943.56 406.5,-18891.56 693.5,-18891.56 693.5,-18943.56"/>
<text text-anchor="middle" x="550" y="-18931.56" font-family="Arial" font-size="10.00">Layer 4 MLP Up Linear</text>
<text text-anchor="middle" x="550" y="-18920.56" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-18909.56" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="550" y="-18898.56" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer4_layernorm1_stage0&#45;&gt;layer4_mlp_up_stage0 -->
<g id="edge85" class="edge">
<title>layer4_layernorm1_stage0&#45;&gt;layer4_mlp_up_stage0</title>
<path fill="none" stroke="black" d="M550,-19067.25C550,-19037.4 550,-18987.58 550,-18953.92"/>
<polygon fill="black" stroke="black" points="553.5,-18953.61 550,-18943.61 546.5,-18953.61 553.5,-18953.61"/>
</g>
<!-- layer4_residual2_stage0 -->
<g id="node72" class="node">
<title>layer4_residual2_stage0</title>
<polygon fill="lightblue" stroke="black" points="550,-18658.02 26,-18606.02 550,-18554.02 1074,-18606.02 550,-18658.02"/>
<text text-anchor="middle" x="550" y="-18620.02" font-family="Arial" font-size="10.00">Layer 4 Residual Add 2</text>
<text text-anchor="middle" x="550" y="-18609.02" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-18598.02" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-18587.02" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer4_layernorm1_stage0&#45;&gt;layer4_residual2_stage0 -->
<g id="edge91" class="edge">
<title>layer4_layernorm1_stage0&#45;&gt;layer4_residual2_stage0</title>
<path fill="none" stroke="black" d="M598.46,-19067.33C646.51,-19038.44 713,-18986.23 713,-18918.56 713,-18918.56 713,-18918.56 713,-18828.56 713,-18768.6 735.05,-18744.69 703,-18694.02 692.85,-18677.96 678.6,-18664.58 662.85,-18653.51"/>
<polygon fill="black" stroke="black" points="664.75,-18650.57 654.49,-18647.93 660.87,-18656.39 664.75,-18650.57"/>
</g>
<!-- layer4_mlp_gelu_stage0 -->
<g id="node69" class="node">
<title>layer4_mlp_gelu_stage0</title>
<polygon fill="orange" stroke="black" points="388.5,-18943.56 101.5,-18943.56 101.5,-18891.56 388.5,-18891.56 388.5,-18943.56"/>
<text text-anchor="middle" x="245" y="-18931.56" font-family="Arial" font-size="10.00">Layer 4 MLP GELU</text>
<text text-anchor="middle" x="245" y="-18920.56" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="245" y="-18909.56" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="245" y="-18898.56" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer4_mlp_gate_stage0&#45;&gt;layer4_mlp_gelu_stage0 -->
<g id="edge86" class="edge">
<title>layer4_mlp_gate_stage0&#45;&gt;layer4_mlp_gelu_stage0</title>
<path fill="none" stroke="black" d="M295.08,-18979.22C287.93,-18970.56 279.83,-18960.74 272.25,-18951.56"/>
<polygon fill="black" stroke="black" points="274.83,-18949.2 265.77,-18943.71 269.44,-18953.65 274.83,-18949.2"/>
</g>
<!-- layer4_mlp_down_stage0 -->
<g id="node70" class="node">
<title>layer4_mlp_down_stage0</title>
<polygon fill="lightyellow" stroke="black" points="634.5,-18855.56 345.5,-18855.56 345.5,-18803.56 634.5,-18803.56 634.5,-18855.56"/>
<text text-anchor="middle" x="490" y="-18843.56" font-family="Arial" font-size="10.00">Layer 4 MLP Down Linear</text>
<text text-anchor="middle" x="490" y="-18832.56" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="490" y="-18821.56" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-18810.56" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer4_mlp_up_stage0&#45;&gt;layer4_mlp_down_stage0 -->
<g id="edge88" class="edge">
<title>layer4_mlp_up_stage0&#45;&gt;layer4_mlp_down_stage0</title>
<path fill="none" stroke="black" d="M532.32,-18891.22C526.4,-18882.73 519.71,-18873.14 513.42,-18864.12"/>
<polygon fill="black" stroke="black" points="516.14,-18861.91 507.55,-18855.71 510.4,-18865.92 516.14,-18861.91"/>
</g>
<!-- layer4_mlp_gelu_stage0&#45;&gt;layer4_mlp_down_stage0 -->
<g id="edge87" class="edge">
<title>layer4_mlp_gelu_stage0&#45;&gt;layer4_mlp_down_stage0</title>
<path fill="none" stroke="black" d="M316.52,-18891.45C345.45,-18881.29 379,-18869.52 408.84,-18859.04"/>
<polygon fill="black" stroke="black" points="410.11,-18862.31 418.39,-18855.69 407.79,-18855.7 410.11,-18862.31"/>
</g>
<!-- layer4_mlp_allreduce_stage0 -->
<g id="node71" class="node">
<title>layer4_mlp_allreduce_stage0</title>
<ellipse fill="lightgray" stroke="black" cx="490" cy="-18730.79" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="490" y="-18744.79" font-family="Arial" font-size="10.00">Layer 4 MLP All&#45;reduce</text>
<text text-anchor="middle" x="490" y="-18733.79" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-18722.79" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-18711.79" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer4_mlp_down_stage0&#45;&gt;layer4_mlp_allreduce_stage0 -->
<g id="edge89" class="edge">
<title>layer4_mlp_down_stage0&#45;&gt;layer4_mlp_allreduce_stage0</title>
<path fill="none" stroke="black" d="M490,-18803.38C490,-18795.57 490,-18786.71 490,-18777.94"/>
<polygon fill="black" stroke="black" points="493.5,-18777.76 490,-18767.76 486.5,-18777.76 493.5,-18777.76"/>
</g>
<!-- layer4_mlp_allreduce_stage0&#45;&gt;layer4_residual2_stage0 -->
<g id="edge90" class="edge">
<title>layer4_mlp_allreduce_stage0&#45;&gt;layer4_residual2_stage0</title>
<path fill="none" stroke="black" d="M507.52,-18693.95C511.96,-18684.84 516.86,-18674.83 521.7,-18664.93"/>
<polygon fill="black" stroke="black" points="524.86,-18666.43 526.11,-18655.91 518.57,-18663.36 524.86,-18666.43"/>
</g>
<!-- layer4_layernorm2_stage0 -->
<g id="node73" class="node">
<title>layer4_layernorm2_stage0</title>
<polygon fill="lightgreen" stroke="black" points="694.5,-18518.02 405.5,-18518.02 405.5,-18466.02 694.5,-18466.02 694.5,-18518.02"/>
<text text-anchor="middle" x="550" y="-18506.02" font-family="Arial" font-size="10.00">Layer 4 Layer Norm 2</text>
<text text-anchor="middle" x="550" y="-18495.02" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-18484.02" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-18473.02" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer4_residual2_stage0&#45;&gt;layer4_layernorm2_stage0 -->
<g id="edge92" class="edge">
<title>layer4_residual2_stage0&#45;&gt;layer4_layernorm2_stage0</title>
<path fill="none" stroke="black" d="M550,-18553.93C550,-18545.27 550,-18536.45 550,-18528.3"/>
<polygon fill="black" stroke="black" points="553.5,-18528.06 550,-18518.06 546.5,-18528.06 553.5,-18528.06"/>
</g>
<!-- layer5_input_stage0 -->
<g id="node74" class="node">
<title>layer5_input_stage0</title>
<polygon fill="lightyellow" stroke="black" points="849.74,-18430.02 372.92,-18430.02 250.26,-18326.02 727.08,-18326.02 849.74,-18430.02"/>
<text text-anchor="middle" x="550" y="-18392.02" font-family="Arial" font-size="10.00">Layer 5 Input</text>
<text text-anchor="middle" x="550" y="-18381.02" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-18370.02" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-18359.02" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer4_layernorm2_stage0&#45;&gt;layer5_input_stage0 -->
<g id="edge93" class="edge">
<title>layer4_layernorm2_stage0&#45;&gt;layer5_input_stage0</title>
<path fill="none" stroke="black" d="M550,-18465.88C550,-18458.2 550,-18449.38 550,-18440.38"/>
<polygon fill="black" stroke="black" points="553.5,-18440.19 550,-18430.2 546.5,-18440.2 553.5,-18440.19"/>
</g>
<!-- layer5_mha_query_stage0 -->
<g id="node75" class="node">
<title>layer5_mha_query_stage0</title>
<polygon fill="pink" stroke="black" points="351.5,-18290.02 60.5,-18290.02 60.5,-18238.02 351.5,-18238.02 351.5,-18290.02"/>
<text text-anchor="middle" x="206" y="-18278.02" font-family="Arial" font-size="10.00">Layer 5 MHA Query Linear</text>
<text text-anchor="middle" x="206" y="-18267.02" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="206" y="-18256.02" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_q=512]</text>
<text text-anchor="middle" x="206" y="-18245.02" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer5_input_stage0&#45;&gt;layer5_mha_query_stage0 -->
<g id="edge94" class="edge">
<title>layer5_input_stage0&#45;&gt;layer5_mha_query_stage0</title>
<path fill="none" stroke="black" d="M393.35,-18326.01C358.79,-18314.76 323.39,-18303.24 292.8,-18293.28"/>
<polygon fill="black" stroke="black" points="293.64,-18289.87 283.04,-18290.1 291.47,-18296.52 293.64,-18289.87"/>
</g>
<!-- layer5_mha_key_stage0 -->
<g id="node76" class="node">
<title>layer5_mha_key_stage0</title>
<polygon fill="pink" stroke="black" points="660.5,-18290.02 369.5,-18290.02 369.5,-18238.02 660.5,-18238.02 660.5,-18290.02"/>
<text text-anchor="middle" x="515" y="-18278.02" font-family="Arial" font-size="10.00">Layer 5 MHA Key Linear</text>
<text text-anchor="middle" x="515" y="-18267.02" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="515" y="-18256.02" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="515" y="-18245.02" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer5_input_stage0&#45;&gt;layer5_mha_key_stage0 -->
<g id="edge95" class="edge">
<title>layer5_input_stage0&#45;&gt;layer5_mha_key_stage0</title>
<path fill="none" stroke="black" d="M534.04,-18325.93C531.27,-18317.07 528.45,-18308.05 525.86,-18299.75"/>
<polygon fill="black" stroke="black" points="529.15,-18298.56 522.83,-18290.06 522.47,-18300.65 529.15,-18298.56"/>
</g>
<!-- layer5_mha_value_stage0 -->
<g id="node77" class="node">
<title>layer5_mha_value_stage0</title>
<polygon fill="pink" stroke="black" points="699.5,-18202.02 408.5,-18202.02 408.5,-18150.02 699.5,-18150.02 699.5,-18202.02"/>
<text text-anchor="middle" x="554" y="-18190.02" font-family="Arial" font-size="10.00">Layer 5 MHA Value Linear</text>
<text text-anchor="middle" x="554" y="-18179.02" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="554" y="-18168.02" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_v=512]</text>
<text text-anchor="middle" x="554" y="-18157.02" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer5_input_stage0&#45;&gt;layer5_mha_value_stage0 -->
<g id="edge96" class="edge">
<title>layer5_input_stage0&#45;&gt;layer5_mha_value_stage0</title>
<path fill="none" stroke="black" d="M641.56,-18325.78C653.01,-18315.45 663.1,-18303.54 670,-18290.02 680.5,-18269.43 681.95,-18257.8 670,-18238.02 662.45,-18225.52 651.39,-18215.45 639.06,-18207.38"/>
<polygon fill="black" stroke="black" points="640.72,-18204.29 630.35,-18202.11 637.09,-18210.28 640.72,-18204.29"/>
</g>
<!-- layer5_residual1_stage0 -->
<g id="node83" class="node">
<title>layer5_residual1_stage0</title>
<polygon fill="lightblue" stroke="black" points="550,-17740.48 26,-17688.48 550,-17636.48 1074,-17688.48 550,-17740.48"/>
<text text-anchor="middle" x="550" y="-17702.48" font-family="Arial" font-size="10.00">Layer 5 Residual Add 1</text>
<text text-anchor="middle" x="550" y="-17691.48" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-17680.48" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-17669.48" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer5_input_stage0&#45;&gt;layer5_residual1_stage0 -->
<g id="edge105" class="edge">
<title>layer5_input_stage0&#45;&gt;layer5_residual1_stage0</title>
<path fill="none" stroke="black" d="M642.06,-18325.99C655.77,-18315.44 668.72,-18303.41 679,-18290.02 711.36,-18247.88 718,-18230.15 718,-18177.02 718,-18177.02 718,-18177.02 718,-17911.02 718,-17851.06 740.4,-17826.93 708,-17776.48 697.48,-17760.1 682.76,-17746.54 666.48,-17735.41"/>
<polygon fill="black" stroke="black" points="668.14,-17732.31 657.85,-17729.8 664.33,-17738.18 668.14,-17732.31"/>
</g>
<!-- layer5_mha_qkt_stage0 -->
<g id="node78" class="node">
<title>layer5_mha_qkt_stage0</title>
<polygon fill="lightcoral" stroke="black" points="390,-18202.02 70,-18202.02 70,-18150.02 390,-18150.02 390,-18202.02"/>
<text text-anchor="middle" x="230" y="-18190.02" font-family="Arial" font-size="10.00">Layer 5 MHA QKT Calculation</text>
<text text-anchor="middle" x="230" y="-18179.02" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="230" y="-18168.02" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="230" y="-18157.02" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer5_mha_query_stage0&#45;&gt;layer5_mha_qkt_stage0 -->
<g id="edge97" class="edge">
<title>layer5_mha_query_stage0&#45;&gt;layer5_mha_qkt_stage0</title>
<path fill="none" stroke="black" d="M213.07,-18237.68C215.32,-18229.63 217.84,-18220.58 220.24,-18211.98"/>
<polygon fill="black" stroke="black" points="223.66,-18212.75 222.98,-18202.17 216.92,-18210.86 223.66,-18212.75"/>
</g>
<!-- layer5_mha_key_stage0&#45;&gt;layer5_mha_qkt_stage0 -->
<g id="edge98" class="edge">
<title>layer5_mha_key_stage0&#45;&gt;layer5_mha_qkt_stage0</title>
<path fill="none" stroke="black" d="M431.8,-18237.91C397.71,-18227.62 358.11,-18215.67 323.06,-18205.1"/>
<polygon fill="black" stroke="black" points="323.89,-18201.69 313.3,-18202.15 321.87,-18208.39 323.89,-18201.69"/>
</g>
<!-- layer5_mha_apply_stage0 -->
<g id="node80" class="node">
<title>layer5_mha_apply_stage0</title>
<polygon fill="lightcoral" stroke="black" points="651,-18026.02 339,-18026.02 339,-17974.02 651,-17974.02 651,-18026.02"/>
<text text-anchor="middle" x="495" y="-18014.02" font-family="Arial" font-size="10.00">Layer 5 MHA Apply Attention</text>
<text text-anchor="middle" x="495" y="-18003.02" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="495" y="-17992.02" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="495" y="-17981.02" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer5_mha_value_stage0&#45;&gt;layer5_mha_apply_stage0 -->
<g id="edge101" class="edge">
<title>layer5_mha_value_stage0&#45;&gt;layer5_mha_apply_stage0</title>
<path fill="none" stroke="black" d="M545.42,-18149.72C535.25,-18119.73 518.26,-18069.61 506.84,-18035.95"/>
<polygon fill="black" stroke="black" points="510.02,-18034.41 503.49,-18026.07 503.39,-18036.66 510.02,-18034.41"/>
</g>
<!-- layer5_mha_weights_stage0 -->
<g id="node79" class="node">
<title>layer5_mha_weights_stage0</title>
<polygon fill="lightcoral" stroke="black" points="434,-18114.02 114,-18114.02 114,-18062.02 434,-18062.02 434,-18114.02"/>
<text text-anchor="middle" x="274" y="-18102.02" font-family="Arial" font-size="10.00">Layer 5 MHA Attention Weights</text>
<text text-anchor="middle" x="274" y="-18091.02" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="274" y="-18080.02" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="274" y="-18069.02" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer5_mha_qkt_stage0&#45;&gt;layer5_mha_weights_stage0 -->
<g id="edge99" class="edge">
<title>layer5_mha_qkt_stage0&#45;&gt;layer5_mha_weights_stage0</title>
<path fill="none" stroke="black" d="M242.96,-18149.68C247.22,-18141.37 252.01,-18131.99 256.54,-18123.14"/>
<polygon fill="black" stroke="black" points="259.69,-18124.67 261.13,-18114.17 253.46,-18121.48 259.69,-18124.67"/>
</g>
<!-- layer5_mha_weights_stage0&#45;&gt;layer5_mha_apply_stage0 -->
<g id="edge100" class="edge">
<title>layer5_mha_weights_stage0&#45;&gt;layer5_mha_apply_stage0</title>
<path fill="none" stroke="black" d="M338.52,-18061.91C364.27,-18051.89 394.09,-18040.29 420.74,-18029.91"/>
<polygon fill="black" stroke="black" points="422.35,-18033.04 430.4,-18026.15 419.81,-18026.52 422.35,-18033.04"/>
</g>
<!-- layer5_mha_out_stage0 -->
<g id="node81" class="node">
<title>layer5_mha_out_stage0</title>
<polygon fill="pink" stroke="black" points="639.5,-17938.02 350.5,-17938.02 350.5,-17886.02 639.5,-17886.02 639.5,-17938.02"/>
<text text-anchor="middle" x="495" y="-17926.02" font-family="Arial" font-size="10.00">Layer 5 MHA Output Linear</text>
<text text-anchor="middle" x="495" y="-17915.02" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="495" y="-17904.02" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="495" y="-17893.02" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer5_mha_apply_stage0&#45;&gt;layer5_mha_out_stage0 -->
<g id="edge102" class="edge">
<title>layer5_mha_apply_stage0&#45;&gt;layer5_mha_out_stage0</title>
<path fill="none" stroke="black" d="M495,-17973.68C495,-17965.72 495,-17956.78 495,-17948.26"/>
<polygon fill="black" stroke="black" points="498.5,-17948.17 495,-17938.17 491.5,-17948.17 498.5,-17948.17"/>
</g>
<!-- layer5_mha_allreduce_stage0 -->
<g id="node82" class="node">
<title>layer5_mha_allreduce_stage0</title>
<ellipse fill="lightgray" stroke="black" cx="495" cy="-17813.25" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="495" y="-17827.25" font-family="Arial" font-size="10.00">Layer 5 MHA All&#45;reduce</text>
<text text-anchor="middle" x="495" y="-17816.25" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="495" y="-17805.25" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="495" y="-17794.25" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer5_mha_out_stage0&#45;&gt;layer5_mha_allreduce_stage0 -->
<g id="edge103" class="edge">
<title>layer5_mha_out_stage0&#45;&gt;layer5_mha_allreduce_stage0</title>
<path fill="none" stroke="black" d="M495,-17885.84C495,-17878.04 495,-17869.17 495,-17860.4"/>
<polygon fill="black" stroke="black" points="498.5,-17860.22 495,-17850.22 491.5,-17860.22 498.5,-17860.22"/>
</g>
<!-- layer5_mha_allreduce_stage0&#45;&gt;layer5_residual1_stage0 -->
<g id="edge104" class="edge">
<title>layer5_mha_allreduce_stage0&#45;&gt;layer5_residual1_stage0</title>
<path fill="none" stroke="black" d="M511.06,-17776.41C515.09,-17767.4 519.53,-17757.49 523.92,-17747.7"/>
<polygon fill="black" stroke="black" points="527.2,-17748.93 528.1,-17738.37 520.81,-17746.06 527.2,-17748.93"/>
</g>
<!-- layer5_layernorm1_stage0 -->
<g id="node84" class="node">
<title>layer5_layernorm1_stage0</title>
<polygon fill="lightgreen" stroke="black" points="694.5,-17600.48 405.5,-17600.48 405.5,-17548.48 694.5,-17548.48 694.5,-17600.48"/>
<text text-anchor="middle" x="550" y="-17588.48" font-family="Arial" font-size="10.00">Layer 5 Layer Norm 1</text>
<text text-anchor="middle" x="550" y="-17577.48" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-17566.48" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-17555.48" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer5_residual1_stage0&#45;&gt;layer5_layernorm1_stage0 -->
<g id="edge106" class="edge">
<title>layer5_residual1_stage0&#45;&gt;layer5_layernorm1_stage0</title>
<path fill="none" stroke="black" d="M550,-17636.39C550,-17627.73 550,-17618.91 550,-17610.76"/>
<polygon fill="black" stroke="black" points="553.5,-17610.52 550,-17600.52 546.5,-17610.52 553.5,-17610.52"/>
</g>
<!-- layer5_mlp_gate_stage0 -->
<g id="node85" class="node">
<title>layer5_mlp_gate_stage0</title>
<polygon fill="lightyellow" stroke="black" points="459.5,-17512.48 172.5,-17512.48 172.5,-17460.48 459.5,-17460.48 459.5,-17512.48"/>
<text text-anchor="middle" x="316" y="-17500.48" font-family="Arial" font-size="10.00">Layer 5 MLP Gate Linear</text>
<text text-anchor="middle" x="316" y="-17489.48" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="316" y="-17478.48" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="316" y="-17467.48" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer5_layernorm1_stage0&#45;&gt;layer5_mlp_gate_stage0 -->
<g id="edge107" class="edge">
<title>layer5_layernorm1_stage0&#45;&gt;layer5_mlp_gate_stage0</title>
<path fill="none" stroke="black" d="M481.69,-17548.37C454.18,-17538.26 422.29,-17526.54 393.89,-17516.1"/>
<polygon fill="black" stroke="black" points="394.99,-17512.78 384.4,-17512.61 392.58,-17519.35 394.99,-17512.78"/>
</g>
<!-- layer5_mlp_up_stage0 -->
<g id="node86" class="node">
<title>layer5_mlp_up_stage0</title>
<polygon fill="lightyellow" stroke="black" points="693.5,-17424.48 406.5,-17424.48 406.5,-17372.48 693.5,-17372.48 693.5,-17424.48"/>
<text text-anchor="middle" x="550" y="-17412.48" font-family="Arial" font-size="10.00">Layer 5 MLP Up Linear</text>
<text text-anchor="middle" x="550" y="-17401.48" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-17390.48" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="550" y="-17379.48" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer5_layernorm1_stage0&#45;&gt;layer5_mlp_up_stage0 -->
<g id="edge108" class="edge">
<title>layer5_layernorm1_stage0&#45;&gt;layer5_mlp_up_stage0</title>
<path fill="none" stroke="black" d="M550,-17548.18C550,-17518.32 550,-17468.5 550,-17434.84"/>
<polygon fill="black" stroke="black" points="553.5,-17434.53 550,-17424.53 546.5,-17434.53 553.5,-17434.53"/>
</g>
<!-- layer5_residual2_stage0 -->
<g id="node90" class="node">
<title>layer5_residual2_stage0</title>
<polygon fill="lightblue" stroke="black" points="550,-17138.94 26,-17086.94 550,-17034.94 1074,-17086.94 550,-17138.94"/>
<text text-anchor="middle" x="550" y="-17100.94" font-family="Arial" font-size="10.00">Layer 5 Residual Add 2</text>
<text text-anchor="middle" x="550" y="-17089.94" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-17078.94" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-17067.94" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer5_layernorm1_stage0&#45;&gt;layer5_residual2_stage0 -->
<g id="edge114" class="edge">
<title>layer5_layernorm1_stage0&#45;&gt;layer5_residual2_stage0</title>
<path fill="none" stroke="black" d="M598.46,-17548.25C646.51,-17519.36 713,-17467.15 713,-17399.48 713,-17399.48 713,-17399.48 713,-17309.48 713,-17249.52 735.05,-17225.61 703,-17174.94 692.85,-17158.89 678.6,-17145.5 662.85,-17134.43"/>
<polygon fill="black" stroke="black" points="664.75,-17131.49 654.49,-17128.85 660.87,-17137.31 664.75,-17131.49"/>
</g>
<!-- layer5_mlp_gelu_stage0 -->
<g id="node87" class="node">
<title>layer5_mlp_gelu_stage0</title>
<polygon fill="orange" stroke="black" points="388.5,-17424.48 101.5,-17424.48 101.5,-17372.48 388.5,-17372.48 388.5,-17424.48"/>
<text text-anchor="middle" x="245" y="-17412.48" font-family="Arial" font-size="10.00">Layer 5 MLP GELU</text>
<text text-anchor="middle" x="245" y="-17401.48" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="245" y="-17390.48" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="245" y="-17379.48" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer5_mlp_gate_stage0&#45;&gt;layer5_mlp_gelu_stage0 -->
<g id="edge109" class="edge">
<title>layer5_mlp_gate_stage0&#45;&gt;layer5_mlp_gelu_stage0</title>
<path fill="none" stroke="black" d="M295.08,-17460.14C287.93,-17451.48 279.83,-17441.66 272.25,-17432.49"/>
<polygon fill="black" stroke="black" points="274.83,-17430.12 265.77,-17424.63 269.44,-17434.57 274.83,-17430.12"/>
</g>
<!-- layer5_mlp_down_stage0 -->
<g id="node88" class="node">
<title>layer5_mlp_down_stage0</title>
<polygon fill="lightyellow" stroke="black" points="634.5,-17336.48 345.5,-17336.48 345.5,-17284.48 634.5,-17284.48 634.5,-17336.48"/>
<text text-anchor="middle" x="490" y="-17324.48" font-family="Arial" font-size="10.00">Layer 5 MLP Down Linear</text>
<text text-anchor="middle" x="490" y="-17313.48" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="490" y="-17302.48" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-17291.48" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer5_mlp_up_stage0&#45;&gt;layer5_mlp_down_stage0 -->
<g id="edge111" class="edge">
<title>layer5_mlp_up_stage0&#45;&gt;layer5_mlp_down_stage0</title>
<path fill="none" stroke="black" d="M532.32,-17372.14C526.4,-17363.65 519.71,-17354.06 513.42,-17345.04"/>
<polygon fill="black" stroke="black" points="516.14,-17342.83 507.55,-17336.63 510.4,-17346.84 516.14,-17342.83"/>
</g>
<!-- layer5_mlp_gelu_stage0&#45;&gt;layer5_mlp_down_stage0 -->
<g id="edge110" class="edge">
<title>layer5_mlp_gelu_stage0&#45;&gt;layer5_mlp_down_stage0</title>
<path fill="none" stroke="black" d="M316.52,-17372.37C345.45,-17362.22 379,-17350.44 408.84,-17339.97"/>
<polygon fill="black" stroke="black" points="410.11,-17343.23 418.39,-17336.61 407.79,-17336.62 410.11,-17343.23"/>
</g>
<!-- layer5_mlp_allreduce_stage0 -->
<g id="node89" class="node">
<title>layer5_mlp_allreduce_stage0</title>
<ellipse fill="lightgray" stroke="black" cx="490" cy="-17211.71" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="490" y="-17225.71" font-family="Arial" font-size="10.00">Layer 5 MLP All&#45;reduce</text>
<text text-anchor="middle" x="490" y="-17214.71" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-17203.71" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-17192.71" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer5_mlp_down_stage0&#45;&gt;layer5_mlp_allreduce_stage0 -->
<g id="edge112" class="edge">
<title>layer5_mlp_down_stage0&#45;&gt;layer5_mlp_allreduce_stage0</title>
<path fill="none" stroke="black" d="M490,-17284.31C490,-17276.5 490,-17267.63 490,-17258.86"/>
<polygon fill="black" stroke="black" points="493.5,-17258.68 490,-17248.68 486.5,-17258.68 493.5,-17258.68"/>
</g>
<!-- layer5_mlp_allreduce_stage0&#45;&gt;layer5_residual2_stage0 -->
<g id="edge113" class="edge">
<title>layer5_mlp_allreduce_stage0&#45;&gt;layer5_residual2_stage0</title>
<path fill="none" stroke="black" d="M507.52,-17174.87C511.96,-17165.76 516.86,-17155.75 521.7,-17145.85"/>
<polygon fill="black" stroke="black" points="524.86,-17147.35 526.11,-17136.83 518.57,-17144.28 524.86,-17147.35"/>
</g>
<!-- layer5_layernorm2_stage0 -->
<g id="node91" class="node">
<title>layer5_layernorm2_stage0</title>
<polygon fill="lightgreen" stroke="black" points="694.5,-16998.94 405.5,-16998.94 405.5,-16946.94 694.5,-16946.94 694.5,-16998.94"/>
<text text-anchor="middle" x="550" y="-16986.94" font-family="Arial" font-size="10.00">Layer 5 Layer Norm 2</text>
<text text-anchor="middle" x="550" y="-16975.94" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-16964.94" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-16953.94" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer5_residual2_stage0&#45;&gt;layer5_layernorm2_stage0 -->
<g id="edge115" class="edge">
<title>layer5_residual2_stage0&#45;&gt;layer5_layernorm2_stage0</title>
<path fill="none" stroke="black" d="M550,-17034.85C550,-17026.19 550,-17017.37 550,-17009.22"/>
<polygon fill="black" stroke="black" points="553.5,-17008.98 550,-16998.98 546.5,-17008.98 553.5,-17008.98"/>
</g>
<!-- layer6_input_stage0 -->
<g id="node92" class="node">
<title>layer6_input_stage0</title>
<polygon fill="lightyellow" stroke="black" points="849.74,-16910.94 372.92,-16910.94 250.26,-16806.94 727.08,-16806.94 849.74,-16910.94"/>
<text text-anchor="middle" x="550" y="-16872.94" font-family="Arial" font-size="10.00">Layer 6 Input</text>
<text text-anchor="middle" x="550" y="-16861.94" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-16850.94" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-16839.94" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer5_layernorm2_stage0&#45;&gt;layer6_input_stage0 -->
<g id="edge116" class="edge">
<title>layer5_layernorm2_stage0&#45;&gt;layer6_input_stage0</title>
<path fill="none" stroke="black" d="M550,-16946.8C550,-16939.12 550,-16930.31 550,-16921.31"/>
<polygon fill="black" stroke="black" points="553.5,-16921.12 550,-16911.12 546.5,-16921.12 553.5,-16921.12"/>
</g>
<!-- layer6_mha_query_stage0 -->
<g id="node93" class="node">
<title>layer6_mha_query_stage0</title>
<polygon fill="pink" stroke="black" points="321.5,-16770.94 30.5,-16770.94 30.5,-16718.94 321.5,-16718.94 321.5,-16770.94"/>
<text text-anchor="middle" x="176" y="-16758.94" font-family="Arial" font-size="10.00">Layer 6 MHA Query Linear</text>
<text text-anchor="middle" x="176" y="-16747.94" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="176" y="-16736.94" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_q=512]</text>
<text text-anchor="middle" x="176" y="-16725.94" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer6_input_stage0&#45;&gt;layer6_mha_query_stage0 -->
<g id="edge117" class="edge">
<title>layer6_input_stage0&#45;&gt;layer6_mha_query_stage0</title>
<path fill="none" stroke="black" d="M379.69,-16806.94C341.78,-16795.59 302.96,-16783.96 269.51,-16773.94"/>
<polygon fill="black" stroke="black" points="270.35,-16770.54 259.76,-16771.02 268.34,-16777.24 270.35,-16770.54"/>
</g>
<!-- layer6_mha_key_stage0 -->
<g id="node94" class="node">
<title>layer6_mha_key_stage0</title>
<polygon fill="pink" stroke="black" points="630.5,-16770.94 339.5,-16770.94 339.5,-16718.94 630.5,-16718.94 630.5,-16770.94"/>
<text text-anchor="middle" x="485" y="-16758.94" font-family="Arial" font-size="10.00">Layer 6 MHA Key Linear</text>
<text text-anchor="middle" x="485" y="-16747.94" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="485" y="-16736.94" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="485" y="-16725.94" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer6_input_stage0&#45;&gt;layer6_mha_key_stage0 -->
<g id="edge118" class="edge">
<title>layer6_input_stage0&#45;&gt;layer6_mha_key_stage0</title>
<path fill="none" stroke="black" d="M520.35,-16806.85C515.04,-16797.7 509.63,-16788.38 504.69,-16779.86"/>
<polygon fill="black" stroke="black" points="507.58,-16777.87 499.53,-16770.98 501.53,-16781.39 507.58,-16777.87"/>
</g>
<!-- layer6_mha_value_stage0 -->
<g id="node95" class="node">
<title>layer6_mha_value_stage0</title>
<polygon fill="pink" stroke="black" points="655.5,-16682.94 364.5,-16682.94 364.5,-16630.94 655.5,-16630.94 655.5,-16682.94"/>
<text text-anchor="middle" x="510" y="-16670.94" font-family="Arial" font-size="10.00">Layer 6 MHA Value Linear</text>
<text text-anchor="middle" x="510" y="-16659.94" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="510" y="-16648.94" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_v=512]</text>
<text text-anchor="middle" x="510" y="-16637.94" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer6_input_stage0&#45;&gt;layer6_mha_value_stage0 -->
<g id="edge119" class="edge">
<title>layer6_input_stage0&#45;&gt;layer6_mha_value_stage0</title>
<path fill="none" stroke="black" d="M614.56,-16806.91C639.73,-16780.69 658.58,-16748.18 640,-16718.94 631.88,-16706.17 620.31,-16696.02 607.37,-16687.97"/>
<polygon fill="black" stroke="black" points="609.1,-16684.94 598.69,-16682.98 605.61,-16691 609.1,-16684.94"/>
</g>
<!-- layer6_residual1_stage0 -->
<g id="node101" class="node">
<title>layer6_residual1_stage0</title>
<polygon fill="lightblue" stroke="black" points="550,-16221.4 26,-16169.4 550,-16117.4 1074,-16169.4 550,-16221.4"/>
<text text-anchor="middle" x="550" y="-16183.4" font-family="Arial" font-size="10.00">Layer 6 Residual Add 1</text>
<text text-anchor="middle" x="550" y="-16172.4" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-16161.4" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-16150.4" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer6_input_stage0&#45;&gt;layer6_residual1_stage0 -->
<g id="edge128" class="edge">
<title>layer6_input_stage0&#45;&gt;layer6_residual1_stage0</title>
<path fill="none" stroke="black" d="M619.16,-16806.65C630.11,-16795.89 640.34,-16783.85 648,-16770.94 674.3,-16726.62 674,-16709.47 674,-16657.94 674,-16657.94 674,-16657.94 674,-16391.94 674,-16331.98 692.57,-16310.12 664,-16257.4 656.56,-16243.66 645.91,-16231.43 634.08,-16220.8"/>
<polygon fill="black" stroke="black" points="636.04,-16217.86 626.16,-16214.04 631.5,-16223.19 636.04,-16217.86"/>
</g>
<!-- layer6_mha_qkt_stage0 -->
<g id="node96" class="node">
<title>layer6_mha_qkt_stage0</title>
<polygon fill="lightcoral" stroke="black" points="346,-16682.94 26,-16682.94 26,-16630.94 346,-16630.94 346,-16682.94"/>
<text text-anchor="middle" x="186" y="-16670.94" font-family="Arial" font-size="10.00">Layer 6 MHA QKT Calculation</text>
<text text-anchor="middle" x="186" y="-16659.94" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="186" y="-16648.94" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="186" y="-16637.94" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer6_mha_query_stage0&#45;&gt;layer6_mha_qkt_stage0 -->
<g id="edge120" class="edge">
<title>layer6_mha_query_stage0&#45;&gt;layer6_mha_qkt_stage0</title>
<path fill="none" stroke="black" d="M178.95,-16718.6C179.87,-16710.64 180.91,-16701.7 181.9,-16693.18"/>
<polygon fill="black" stroke="black" points="185.4,-16693.43 183.07,-16683.1 178.44,-16692.62 185.4,-16693.43"/>
</g>
<!-- layer6_mha_key_stage0&#45;&gt;layer6_mha_qkt_stage0 -->
<g id="edge121" class="edge">
<title>layer6_mha_key_stage0&#45;&gt;layer6_mha_qkt_stage0</title>
<path fill="none" stroke="black" d="M397.71,-16718.83C361.72,-16708.48 319.86,-16696.44 282.92,-16685.81"/>
<polygon fill="black" stroke="black" points="283.71,-16682.4 273.14,-16683 281.78,-16689.13 283.71,-16682.4"/>
</g>
<!-- layer6_mha_apply_stage0 -->
<g id="node98" class="node">
<title>layer6_mha_apply_stage0</title>
<polygon fill="lightcoral" stroke="black" points="607,-16506.94 295,-16506.94 295,-16454.94 607,-16454.94 607,-16506.94"/>
<text text-anchor="middle" x="451" y="-16494.94" font-family="Arial" font-size="10.00">Layer 6 MHA Apply Attention</text>
<text text-anchor="middle" x="451" y="-16483.94" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="451" y="-16472.94" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="451" y="-16461.94" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer6_mha_value_stage0&#45;&gt;layer6_mha_apply_stage0 -->
<g id="edge124" class="edge">
<title>layer6_mha_value_stage0&#45;&gt;layer6_mha_apply_stage0</title>
<path fill="none" stroke="black" d="M501.42,-16630.64C491.25,-16600.66 474.26,-16550.53 462.84,-16516.87"/>
<polygon fill="black" stroke="black" points="466.02,-16515.33 459.49,-16506.99 459.39,-16517.58 466.02,-16515.33"/>
</g>
<!-- layer6_mha_weights_stage0 -->
<g id="node97" class="node">
<title>layer6_mha_weights_stage0</title>
<polygon fill="lightcoral" stroke="black" points="418,-16594.94 98,-16594.94 98,-16542.94 418,-16542.94 418,-16594.94"/>
<text text-anchor="middle" x="258" y="-16582.94" font-family="Arial" font-size="10.00">Layer 6 MHA Attention Weights</text>
<text text-anchor="middle" x="258" y="-16571.94" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="258" y="-16560.94" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="258" y="-16549.94" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer6_mha_qkt_stage0&#45;&gt;layer6_mha_weights_stage0 -->
<g id="edge122" class="edge">
<title>layer6_mha_qkt_stage0&#45;&gt;layer6_mha_weights_stage0</title>
<path fill="none" stroke="black" d="M207.21,-16630.6C214.46,-16621.94 222.68,-16612.12 230.36,-16602.95"/>
<polygon fill="black" stroke="black" points="233.2,-16605.01 236.94,-16595.1 227.84,-16600.52 233.2,-16605.01"/>
</g>
<!-- layer6_mha_weights_stage0&#45;&gt;layer6_mha_apply_stage0 -->
<g id="edge123" class="edge">
<title>layer6_mha_weights_stage0&#45;&gt;layer6_mha_apply_stage0</title>
<path fill="none" stroke="black" d="M314.34,-16542.83C336.54,-16532.94 362.19,-16521.51 385.23,-16511.25"/>
<polygon fill="black" stroke="black" points="386.88,-16514.34 394.59,-16507.08 384.03,-16507.95 386.88,-16514.34"/>
</g>
<!-- layer6_mha_out_stage0 -->
<g id="node99" class="node">
<title>layer6_mha_out_stage0</title>
<polygon fill="pink" stroke="black" points="595.5,-16418.94 306.5,-16418.94 306.5,-16366.94 595.5,-16366.94 595.5,-16418.94"/>
<text text-anchor="middle" x="451" y="-16406.94" font-family="Arial" font-size="10.00">Layer 6 MHA Output Linear</text>
<text text-anchor="middle" x="451" y="-16395.94" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="451" y="-16384.94" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="451" y="-16373.94" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer6_mha_apply_stage0&#45;&gt;layer6_mha_out_stage0 -->
<g id="edge125" class="edge">
<title>layer6_mha_apply_stage0&#45;&gt;layer6_mha_out_stage0</title>
<path fill="none" stroke="black" d="M451,-16454.6C451,-16446.64 451,-16437.7 451,-16429.18"/>
<polygon fill="black" stroke="black" points="454.5,-16429.1 451,-16419.1 447.5,-16429.1 454.5,-16429.1"/>
</g>
<!-- layer6_mha_allreduce_stage0 -->
<g id="node100" class="node">
<title>layer6_mha_allreduce_stage0</title>
<ellipse fill="lightgray" stroke="black" cx="451" cy="-16294.17" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="451" y="-16308.17" font-family="Arial" font-size="10.00">Layer 6 MHA All&#45;reduce</text>
<text text-anchor="middle" x="451" y="-16297.17" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="451" y="-16286.17" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="451" y="-16275.17" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer6_mha_out_stage0&#45;&gt;layer6_mha_allreduce_stage0 -->
<g id="edge126" class="edge">
<title>layer6_mha_out_stage0&#45;&gt;layer6_mha_allreduce_stage0</title>
<path fill="none" stroke="black" d="M451,-16366.77C451,-16358.96 451,-16350.09 451,-16341.32"/>
<polygon fill="black" stroke="black" points="454.5,-16341.15 451,-16331.15 447.5,-16341.15 454.5,-16341.15"/>
</g>
<!-- layer6_mha_allreduce_stage0&#45;&gt;layer6_residual1_stage0 -->
<g id="edge127" class="edge">
<title>layer6_mha_allreduce_stage0&#45;&gt;layer6_residual1_stage0</title>
<path fill="none" stroke="black" d="M479.63,-16257.66C487.72,-16247.63 496.72,-16236.47 505.5,-16225.58"/>
<polygon fill="black" stroke="black" points="508.3,-16227.69 511.85,-16217.71 502.85,-16223.3 508.3,-16227.69"/>
</g>
<!-- layer6_layernorm1_stage0 -->
<g id="node102" class="node">
<title>layer6_layernorm1_stage0</title>
<polygon fill="lightgreen" stroke="black" points="694.5,-16081.4 405.5,-16081.4 405.5,-16029.4 694.5,-16029.4 694.5,-16081.4"/>
<text text-anchor="middle" x="550" y="-16069.4" font-family="Arial" font-size="10.00">Layer 6 Layer Norm 1</text>
<text text-anchor="middle" x="550" y="-16058.4" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-16047.4" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-16036.4" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer6_residual1_stage0&#45;&gt;layer6_layernorm1_stage0 -->
<g id="edge129" class="edge">
<title>layer6_residual1_stage0&#45;&gt;layer6_layernorm1_stage0</title>
<path fill="none" stroke="black" d="M550,-16117.32C550,-16108.65 550,-16099.83 550,-16091.69"/>
<polygon fill="black" stroke="black" points="553.5,-16091.44 550,-16081.44 546.5,-16091.44 553.5,-16091.44"/>
</g>
<!-- layer6_mlp_gate_stage0 -->
<g id="node103" class="node">
<title>layer6_mlp_gate_stage0</title>
<polygon fill="lightyellow" stroke="black" points="459.5,-15993.4 172.5,-15993.4 172.5,-15941.4 459.5,-15941.4 459.5,-15993.4"/>
<text text-anchor="middle" x="316" y="-15981.4" font-family="Arial" font-size="10.00">Layer 6 MLP Gate Linear</text>
<text text-anchor="middle" x="316" y="-15970.4" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="316" y="-15959.4" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="316" y="-15948.4" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer6_layernorm1_stage0&#45;&gt;layer6_mlp_gate_stage0 -->
<g id="edge130" class="edge">
<title>layer6_layernorm1_stage0&#45;&gt;layer6_mlp_gate_stage0</title>
<path fill="none" stroke="black" d="M481.69,-16029.29C454.18,-16019.18 422.29,-16007.46 393.89,-15997.02"/>
<polygon fill="black" stroke="black" points="394.99,-15993.7 384.4,-15993.54 392.58,-16000.27 394.99,-15993.7"/>
</g>
<!-- layer6_mlp_up_stage0 -->
<g id="node104" class="node">
<title>layer6_mlp_up_stage0</title>
<polygon fill="lightyellow" stroke="black" points="693.5,-15905.4 406.5,-15905.4 406.5,-15853.4 693.5,-15853.4 693.5,-15905.4"/>
<text text-anchor="middle" x="550" y="-15893.4" font-family="Arial" font-size="10.00">Layer 6 MLP Up Linear</text>
<text text-anchor="middle" x="550" y="-15882.4" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-15871.4" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="550" y="-15860.4" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer6_layernorm1_stage0&#45;&gt;layer6_mlp_up_stage0 -->
<g id="edge131" class="edge">
<title>layer6_layernorm1_stage0&#45;&gt;layer6_mlp_up_stage0</title>
<path fill="none" stroke="black" d="M550,-16029.1C550,-15999.25 550,-15949.42 550,-15915.76"/>
<polygon fill="black" stroke="black" points="553.5,-15915.45 550,-15905.45 546.5,-15915.45 553.5,-15915.45"/>
</g>
<!-- layer6_residual2_stage0 -->
<g id="node108" class="node">
<title>layer6_residual2_stage0</title>
<polygon fill="lightblue" stroke="black" points="550,-15619.86 26,-15567.86 550,-15515.86 1074,-15567.86 550,-15619.86"/>
<text text-anchor="middle" x="550" y="-15581.86" font-family="Arial" font-size="10.00">Layer 6 Residual Add 2</text>
<text text-anchor="middle" x="550" y="-15570.86" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-15559.86" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-15548.86" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer6_layernorm1_stage0&#45;&gt;layer6_residual2_stage0 -->
<g id="edge137" class="edge">
<title>layer6_layernorm1_stage0&#45;&gt;layer6_residual2_stage0</title>
<path fill="none" stroke="black" d="M598.46,-16029.17C646.51,-16000.28 713,-15948.08 713,-15880.4 713,-15880.4 713,-15880.4 713,-15790.4 713,-15730.44 735.05,-15706.53 703,-15655.86 692.85,-15639.81 678.6,-15626.42 662.85,-15615.35"/>
<polygon fill="black" stroke="black" points="664.75,-15612.41 654.49,-15609.77 660.87,-15618.23 664.75,-15612.41"/>
</g>
<!-- layer6_mlp_gelu_stage0 -->
<g id="node105" class="node">
<title>layer6_mlp_gelu_stage0</title>
<polygon fill="orange" stroke="black" points="388.5,-15905.4 101.5,-15905.4 101.5,-15853.4 388.5,-15853.4 388.5,-15905.4"/>
<text text-anchor="middle" x="245" y="-15893.4" font-family="Arial" font-size="10.00">Layer 6 MLP GELU</text>
<text text-anchor="middle" x="245" y="-15882.4" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="245" y="-15871.4" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="245" y="-15860.4" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer6_mlp_gate_stage0&#45;&gt;layer6_mlp_gelu_stage0 -->
<g id="edge132" class="edge">
<title>layer6_mlp_gate_stage0&#45;&gt;layer6_mlp_gelu_stage0</title>
<path fill="none" stroke="black" d="M295.08,-15941.06C287.93,-15932.4 279.83,-15922.58 272.25,-15913.41"/>
<polygon fill="black" stroke="black" points="274.83,-15911.04 265.77,-15905.56 269.44,-15915.5 274.83,-15911.04"/>
</g>
<!-- layer6_mlp_down_stage0 -->
<g id="node106" class="node">
<title>layer6_mlp_down_stage0</title>
<polygon fill="lightyellow" stroke="black" points="634.5,-15817.4 345.5,-15817.4 345.5,-15765.4 634.5,-15765.4 634.5,-15817.4"/>
<text text-anchor="middle" x="490" y="-15805.4" font-family="Arial" font-size="10.00">Layer 6 MLP Down Linear</text>
<text text-anchor="middle" x="490" y="-15794.4" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="490" y="-15783.4" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-15772.4" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer6_mlp_up_stage0&#45;&gt;layer6_mlp_down_stage0 -->
<g id="edge134" class="edge">
<title>layer6_mlp_up_stage0&#45;&gt;layer6_mlp_down_stage0</title>
<path fill="none" stroke="black" d="M532.32,-15853.06C526.4,-15844.58 519.71,-15834.98 513.42,-15825.97"/>
<polygon fill="black" stroke="black" points="516.14,-15823.75 507.55,-15817.56 510.4,-15827.76 516.14,-15823.75"/>
</g>
<!-- layer6_mlp_gelu_stage0&#45;&gt;layer6_mlp_down_stage0 -->
<g id="edge133" class="edge">
<title>layer6_mlp_gelu_stage0&#45;&gt;layer6_mlp_down_stage0</title>
<path fill="none" stroke="black" d="M316.52,-15853.29C345.45,-15843.14 379,-15831.36 408.84,-15820.89"/>
<polygon fill="black" stroke="black" points="410.11,-15824.15 418.39,-15817.54 407.79,-15817.55 410.11,-15824.15"/>
</g>
<!-- layer6_mlp_allreduce_stage0 -->
<g id="node107" class="node">
<title>layer6_mlp_allreduce_stage0</title>
<ellipse fill="lightgray" stroke="black" cx="490" cy="-15692.63" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="490" y="-15706.63" font-family="Arial" font-size="10.00">Layer 6 MLP All&#45;reduce</text>
<text text-anchor="middle" x="490" y="-15695.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-15684.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-15673.63" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer6_mlp_down_stage0&#45;&gt;layer6_mlp_allreduce_stage0 -->
<g id="edge135" class="edge">
<title>layer6_mlp_down_stage0&#45;&gt;layer6_mlp_allreduce_stage0</title>
<path fill="none" stroke="black" d="M490,-15765.23C490,-15757.42 490,-15748.55 490,-15739.78"/>
<polygon fill="black" stroke="black" points="493.5,-15739.61 490,-15729.61 486.5,-15739.61 493.5,-15739.61"/>
</g>
<!-- layer6_mlp_allreduce_stage0&#45;&gt;layer6_residual2_stage0 -->
<g id="edge136" class="edge">
<title>layer6_mlp_allreduce_stage0&#45;&gt;layer6_residual2_stage0</title>
<path fill="none" stroke="black" d="M507.52,-15655.79C511.96,-15646.69 516.86,-15636.67 521.7,-15626.78"/>
<polygon fill="black" stroke="black" points="524.86,-15628.27 526.11,-15617.75 518.57,-15625.2 524.86,-15628.27"/>
</g>
<!-- layer6_layernorm2_stage0 -->
<g id="node109" class="node">
<title>layer6_layernorm2_stage0</title>
<polygon fill="lightgreen" stroke="black" points="694.5,-15479.86 405.5,-15479.86 405.5,-15427.86 694.5,-15427.86 694.5,-15479.86"/>
<text text-anchor="middle" x="550" y="-15467.86" font-family="Arial" font-size="10.00">Layer 6 Layer Norm 2</text>
<text text-anchor="middle" x="550" y="-15456.86" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-15445.86" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-15434.86" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer6_residual2_stage0&#45;&gt;layer6_layernorm2_stage0 -->
<g id="edge138" class="edge">
<title>layer6_residual2_stage0&#45;&gt;layer6_layernorm2_stage0</title>
<path fill="none" stroke="black" d="M550,-15515.78C550,-15507.11 550,-15498.29 550,-15490.15"/>
<polygon fill="black" stroke="black" points="553.5,-15489.9 550,-15479.9 546.5,-15489.9 553.5,-15489.9"/>
</g>
<!-- layer7_input_stage0 -->
<g id="node110" class="node">
<title>layer7_input_stage0</title>
<polygon fill="lightyellow" stroke="black" points="849.74,-15391.86 372.92,-15391.86 250.26,-15287.86 727.08,-15287.86 849.74,-15391.86"/>
<text text-anchor="middle" x="550" y="-15353.86" font-family="Arial" font-size="10.00">Layer 7 Input</text>
<text text-anchor="middle" x="550" y="-15342.86" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-15331.86" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-15320.86" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer6_layernorm2_stage0&#45;&gt;layer7_input_stage0 -->
<g id="edge139" class="edge">
<title>layer6_layernorm2_stage0&#45;&gt;layer7_input_stage0</title>
<path fill="none" stroke="black" d="M550,-15427.73C550,-15420.04 550,-15411.23 550,-15402.23"/>
<polygon fill="black" stroke="black" points="553.5,-15402.04 550,-15392.04 546.5,-15402.04 553.5,-15402.04"/>
</g>
<!-- layer7_mha_query_stage0 -->
<g id="node111" class="node">
<title>layer7_mha_query_stage0</title>
<polygon fill="pink" stroke="black" points="353.5,-15251.86 62.5,-15251.86 62.5,-15199.86 353.5,-15199.86 353.5,-15251.86"/>
<text text-anchor="middle" x="208" y="-15239.86" font-family="Arial" font-size="10.00">Layer 7 MHA Query Linear</text>
<text text-anchor="middle" x="208" y="-15228.86" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="208" y="-15217.86" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_q=512]</text>
<text text-anchor="middle" x="208" y="-15206.86" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer7_input_stage0&#45;&gt;layer7_mha_query_stage0 -->
<g id="edge140" class="edge">
<title>layer7_input_stage0&#45;&gt;layer7_mha_query_stage0</title>
<path fill="none" stroke="black" d="M394.01,-15287.78C359.68,-15276.53 324.53,-15265.02 294.16,-15255.08"/>
<polygon fill="black" stroke="black" points="295.06,-15251.69 284.47,-15251.9 292.89,-15258.34 295.06,-15251.69"/>
</g>
<!-- layer7_mha_key_stage0 -->
<g id="node112" class="node">
<title>layer7_mha_key_stage0</title>
<polygon fill="pink" stroke="black" points="662.5,-15251.86 371.5,-15251.86 371.5,-15199.86 662.5,-15199.86 662.5,-15251.86"/>
<text text-anchor="middle" x="517" y="-15239.86" font-family="Arial" font-size="10.00">Layer 7 MHA Key Linear</text>
<text text-anchor="middle" x="517" y="-15228.86" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="517" y="-15217.86" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="517" y="-15206.86" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer7_input_stage0&#45;&gt;layer7_mha_key_stage0 -->
<g id="edge141" class="edge">
<title>layer7_input_stage0&#45;&gt;layer7_mha_key_stage0</title>
<path fill="none" stroke="black" d="M534.95,-15287.78C532.34,-15278.92 529.68,-15269.89 527.24,-15261.6"/>
<polygon fill="black" stroke="black" points="530.56,-15260.51 524.38,-15251.9 523.85,-15262.49 530.56,-15260.51"/>
</g>
<!-- layer7_mha_value_stage0 -->
<g id="node113" class="node">
<title>layer7_mha_value_stage0</title>
<polygon fill="pink" stroke="black" points="687.5,-15163.86 396.5,-15163.86 396.5,-15111.86 687.5,-15111.86 687.5,-15163.86"/>
<text text-anchor="middle" x="542" y="-15151.86" font-family="Arial" font-size="10.00">Layer 7 MHA Value Linear</text>
<text text-anchor="middle" x="542" y="-15140.86" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="542" y="-15129.86" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_v=512]</text>
<text text-anchor="middle" x="542" y="-15118.86" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer7_input_stage0&#45;&gt;layer7_mha_value_stage0 -->
<g id="edge142" class="edge">
<title>layer7_input_stage0&#45;&gt;layer7_mha_value_stage0</title>
<path fill="none" stroke="black" d="M643.06,-15287.83C654.7,-15277.48 664.97,-15265.51 672,-15251.86 682.58,-15231.31 684.39,-15219.37 672,-15199.86 663.88,-15187.09 652.31,-15176.94 639.37,-15168.9"/>
<polygon fill="black" stroke="black" points="641.1,-15165.86 630.69,-15163.91 637.61,-15171.92 641.1,-15165.86"/>
</g>
<!-- layer7_residual1_stage0 -->
<g id="node119" class="node">
<title>layer7_residual1_stage0</title>
<polygon fill="lightblue" stroke="black" points="550,-14702.32 26,-14650.32 550,-14598.32 1074,-14650.32 550,-14702.32"/>
<text text-anchor="middle" x="550" y="-14664.32" font-family="Arial" font-size="10.00">Layer 7 Residual Add 1</text>
<text text-anchor="middle" x="550" y="-14653.32" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-14642.32" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-14631.32" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer7_input_stage0&#45;&gt;layer7_residual1_stage0 -->
<g id="edge151" class="edge">
<title>layer7_input_stage0&#45;&gt;layer7_residual1_stage0</title>
<path fill="none" stroke="black" d="M646.49,-15287.71C659.62,-15277.33 671.74,-15265.37 681,-15251.86 710.09,-15209.44 706,-15190.3 706,-15138.86 706,-15138.86 706,-15138.86 706,-14872.86 706,-14812.9 727.53,-14789.32 696,-14738.32 686.31,-14722.65 672.66,-14709.45 657.56,-14698.45"/>
<polygon fill="black" stroke="black" points="659.26,-14695.36 649.04,-14692.56 655.28,-14701.12 659.26,-14695.36"/>
</g>
<!-- layer7_mha_qkt_stage0 -->
<g id="node114" class="node">
<title>layer7_mha_qkt_stage0</title>
<polygon fill="lightcoral" stroke="black" points="378,-15163.86 58,-15163.86 58,-15111.86 378,-15111.86 378,-15163.86"/>
<text text-anchor="middle" x="218" y="-15151.86" font-family="Arial" font-size="10.00">Layer 7 MHA QKT Calculation</text>
<text text-anchor="middle" x="218" y="-15140.86" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="218" y="-15129.86" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="218" y="-15118.86" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer7_mha_query_stage0&#45;&gt;layer7_mha_qkt_stage0 -->
<g id="edge143" class="edge">
<title>layer7_mha_query_stage0&#45;&gt;layer7_mha_qkt_stage0</title>
<path fill="none" stroke="black" d="M210.95,-15199.52C211.87,-15191.56 212.91,-15182.62 213.9,-15174.11"/>
<polygon fill="black" stroke="black" points="217.4,-15174.35 215.07,-15164.02 210.44,-15173.55 217.4,-15174.35"/>
</g>
<!-- layer7_mha_key_stage0&#45;&gt;layer7_mha_qkt_stage0 -->
<g id="edge144" class="edge">
<title>layer7_mha_key_stage0&#45;&gt;layer7_mha_qkt_stage0</title>
<path fill="none" stroke="black" d="M429.71,-15199.75C393.72,-15189.4 351.86,-15177.36 314.92,-15166.74"/>
<polygon fill="black" stroke="black" points="315.71,-15163.32 305.14,-15163.92 313.78,-15170.05 315.71,-15163.32"/>
</g>
<!-- layer7_mha_apply_stage0 -->
<g id="node116" class="node">
<title>layer7_mha_apply_stage0</title>
<polygon fill="lightcoral" stroke="black" points="639,-14987.86 327,-14987.86 327,-14935.86 639,-14935.86 639,-14987.86"/>
<text text-anchor="middle" x="483" y="-14975.86" font-family="Arial" font-size="10.00">Layer 7 MHA Apply Attention</text>
<text text-anchor="middle" x="483" y="-14964.86" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="483" y="-14953.86" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="483" y="-14942.86" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer7_mha_value_stage0&#45;&gt;layer7_mha_apply_stage0 -->
<g id="edge147" class="edge">
<title>layer7_mha_value_stage0&#45;&gt;layer7_mha_apply_stage0</title>
<path fill="none" stroke="black" d="M533.42,-15111.56C523.25,-15081.58 506.26,-15031.45 494.84,-14997.79"/>
<polygon fill="black" stroke="black" points="498.02,-14996.26 491.49,-14987.91 491.39,-14998.5 498.02,-14996.26"/>
</g>
<!-- layer7_mha_weights_stage0 -->
<g id="node115" class="node">
<title>layer7_mha_weights_stage0</title>
<polygon fill="lightcoral" stroke="black" points="436,-15075.86 116,-15075.86 116,-15023.86 436,-15023.86 436,-15075.86"/>
<text text-anchor="middle" x="276" y="-15063.86" font-family="Arial" font-size="10.00">Layer 7 MHA Attention Weights</text>
<text text-anchor="middle" x="276" y="-15052.86" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="276" y="-15041.86" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="276" y="-15030.86" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer7_mha_qkt_stage0&#45;&gt;layer7_mha_weights_stage0 -->
<g id="edge145" class="edge">
<title>layer7_mha_qkt_stage0&#45;&gt;layer7_mha_weights_stage0</title>
<path fill="none" stroke="black" d="M235.09,-15111.52C240.81,-15103.04 247.28,-15093.44 253.36,-15084.43"/>
<polygon fill="black" stroke="black" points="256.34,-15086.26 259.03,-15076.02 250.54,-15082.35 256.34,-15086.26"/>
</g>
<!-- layer7_mha_weights_stage0&#45;&gt;layer7_mha_apply_stage0 -->
<g id="edge146" class="edge">
<title>layer7_mha_weights_stage0&#45;&gt;layer7_mha_apply_stage0</title>
<path fill="none" stroke="black" d="M336.43,-15023.75C360.45,-15013.77 388.24,-15002.23 413.12,-14991.89"/>
<polygon fill="black" stroke="black" points="414.6,-14995.07 422.5,-14988 411.92,-14988.6 414.6,-14995.07"/>
</g>
<!-- layer7_mha_out_stage0 -->
<g id="node117" class="node">
<title>layer7_mha_out_stage0</title>
<polygon fill="pink" stroke="black" points="627.5,-14899.86 338.5,-14899.86 338.5,-14847.86 627.5,-14847.86 627.5,-14899.86"/>
<text text-anchor="middle" x="483" y="-14887.86" font-family="Arial" font-size="10.00">Layer 7 MHA Output Linear</text>
<text text-anchor="middle" x="483" y="-14876.86" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="483" y="-14865.86" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="483" y="-14854.86" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer7_mha_apply_stage0&#45;&gt;layer7_mha_out_stage0 -->
<g id="edge148" class="edge">
<title>layer7_mha_apply_stage0&#45;&gt;layer7_mha_out_stage0</title>
<path fill="none" stroke="black" d="M483,-14935.52C483,-14927.56 483,-14918.62 483,-14910.11"/>
<polygon fill="black" stroke="black" points="486.5,-14910.02 483,-14900.02 479.5,-14910.02 486.5,-14910.02"/>
</g>
<!-- layer7_mha_allreduce_stage0 -->
<g id="node118" class="node">
<title>layer7_mha_allreduce_stage0</title>
<ellipse fill="lightgray" stroke="black" cx="483" cy="-14775.09" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="483" y="-14789.09" font-family="Arial" font-size="10.00">Layer 7 MHA All&#45;reduce</text>
<text text-anchor="middle" x="483" y="-14778.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="483" y="-14767.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="483" y="-14756.09" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer7_mha_out_stage0&#45;&gt;layer7_mha_allreduce_stage0 -->
<g id="edge149" class="edge">
<title>layer7_mha_out_stage0&#45;&gt;layer7_mha_allreduce_stage0</title>
<path fill="none" stroke="black" d="M483,-14847.69C483,-14839.88 483,-14831.01 483,-14822.25"/>
<polygon fill="black" stroke="black" points="486.5,-14822.07 483,-14812.07 479.5,-14822.07 486.5,-14822.07"/>
</g>
<!-- layer7_mha_allreduce_stage0&#45;&gt;layer7_residual1_stage0 -->
<g id="edge150" class="edge">
<title>layer7_mha_allreduce_stage0&#45;&gt;layer7_residual1_stage0</title>
<path fill="none" stroke="black" d="M502.56,-14738.25C507.64,-14728.94 513.24,-14718.69 518.75,-14708.58"/>
<polygon fill="black" stroke="black" points="521.85,-14710.21 523.57,-14699.76 515.7,-14706.86 521.85,-14710.21"/>
</g>
<!-- layer7_layernorm1_stage0 -->
<g id="node120" class="node">
<title>layer7_layernorm1_stage0</title>
<polygon fill="lightgreen" stroke="black" points="694.5,-14562.32 405.5,-14562.32 405.5,-14510.32 694.5,-14510.32 694.5,-14562.32"/>
<text text-anchor="middle" x="550" y="-14550.32" font-family="Arial" font-size="10.00">Layer 7 Layer Norm 1</text>
<text text-anchor="middle" x="550" y="-14539.32" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-14528.32" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-14517.32" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer7_residual1_stage0&#45;&gt;layer7_layernorm1_stage0 -->
<g id="edge152" class="edge">
<title>layer7_residual1_stage0&#45;&gt;layer7_layernorm1_stage0</title>
<path fill="none" stroke="black" d="M550,-14598.24C550,-14589.57 550,-14580.75 550,-14572.61"/>
<polygon fill="black" stroke="black" points="553.5,-14572.36 550,-14562.36 546.5,-14572.36 553.5,-14572.36"/>
</g>
<!-- layer7_mlp_gate_stage0 -->
<g id="node121" class="node">
<title>layer7_mlp_gate_stage0</title>
<polygon fill="lightyellow" stroke="black" points="459.5,-14474.32 172.5,-14474.32 172.5,-14422.32 459.5,-14422.32 459.5,-14474.32"/>
<text text-anchor="middle" x="316" y="-14462.32" font-family="Arial" font-size="10.00">Layer 7 MLP Gate Linear</text>
<text text-anchor="middle" x="316" y="-14451.32" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="316" y="-14440.32" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="316" y="-14429.32" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer7_layernorm1_stage0&#45;&gt;layer7_mlp_gate_stage0 -->
<g id="edge153" class="edge">
<title>layer7_layernorm1_stage0&#45;&gt;layer7_mlp_gate_stage0</title>
<path fill="none" stroke="black" d="M481.69,-14510.22C454.18,-14500.1 422.29,-14488.39 393.89,-14477.95"/>
<polygon fill="black" stroke="black" points="394.99,-14474.62 384.4,-14474.46 392.58,-14481.19 394.99,-14474.62"/>
</g>
<!-- layer7_mlp_up_stage0 -->
<g id="node122" class="node">
<title>layer7_mlp_up_stage0</title>
<polygon fill="lightyellow" stroke="black" points="693.5,-14386.32 406.5,-14386.32 406.5,-14334.32 693.5,-14334.32 693.5,-14386.32"/>
<text text-anchor="middle" x="550" y="-14374.32" font-family="Arial" font-size="10.00">Layer 7 MLP Up Linear</text>
<text text-anchor="middle" x="550" y="-14363.32" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-14352.32" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="550" y="-14341.32" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer7_layernorm1_stage0&#45;&gt;layer7_mlp_up_stage0 -->
<g id="edge154" class="edge">
<title>layer7_layernorm1_stage0&#45;&gt;layer7_mlp_up_stage0</title>
<path fill="none" stroke="black" d="M550,-14510.02C550,-14480.17 550,-14430.35 550,-14396.69"/>
<polygon fill="black" stroke="black" points="553.5,-14396.37 550,-14386.37 546.5,-14396.37 553.5,-14396.37"/>
</g>
<!-- layer7_residual2_stage0 -->
<g id="node126" class="node">
<title>layer7_residual2_stage0</title>
<polygon fill="lightblue" stroke="black" points="550,-14100.78 26,-14048.78 550,-13996.78 1074,-14048.78 550,-14100.78"/>
<text text-anchor="middle" x="550" y="-14062.78" font-family="Arial" font-size="10.00">Layer 7 Residual Add 2</text>
<text text-anchor="middle" x="550" y="-14051.78" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-14040.78" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-14029.78" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer7_layernorm1_stage0&#45;&gt;layer7_residual2_stage0 -->
<g id="edge160" class="edge">
<title>layer7_layernorm1_stage0&#45;&gt;layer7_residual2_stage0</title>
<path fill="none" stroke="black" d="M598.46,-14510.09C646.51,-14481.2 713,-14429 713,-14361.32 713,-14361.32 713,-14361.32 713,-14271.32 713,-14211.36 735.05,-14187.46 703,-14136.78 692.85,-14120.73 678.6,-14107.34 662.85,-14096.27"/>
<polygon fill="black" stroke="black" points="664.75,-14093.33 654.49,-14090.69 660.87,-14099.16 664.75,-14093.33"/>
</g>
<!-- layer7_mlp_gelu_stage0 -->
<g id="node123" class="node">
<title>layer7_mlp_gelu_stage0</title>
<polygon fill="orange" stroke="black" points="388.5,-14386.32 101.5,-14386.32 101.5,-14334.32 388.5,-14334.32 388.5,-14386.32"/>
<text text-anchor="middle" x="245" y="-14374.32" font-family="Arial" font-size="10.00">Layer 7 MLP GELU</text>
<text text-anchor="middle" x="245" y="-14363.32" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="245" y="-14352.32" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="245" y="-14341.32" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer7_mlp_gate_stage0&#45;&gt;layer7_mlp_gelu_stage0 -->
<g id="edge155" class="edge">
<title>layer7_mlp_gate_stage0&#45;&gt;layer7_mlp_gelu_stage0</title>
<path fill="none" stroke="black" d="M295.08,-14421.98C287.93,-14413.32 279.83,-14403.51 272.25,-14394.33"/>
<polygon fill="black" stroke="black" points="274.83,-14391.96 265.77,-14386.48 269.44,-14396.42 274.83,-14391.96"/>
</g>
<!-- layer7_mlp_down_stage0 -->
<g id="node124" class="node">
<title>layer7_mlp_down_stage0</title>
<polygon fill="lightyellow" stroke="black" points="634.5,-14298.32 345.5,-14298.32 345.5,-14246.32 634.5,-14246.32 634.5,-14298.32"/>
<text text-anchor="middle" x="490" y="-14286.32" font-family="Arial" font-size="10.00">Layer 7 MLP Down Linear</text>
<text text-anchor="middle" x="490" y="-14275.32" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="490" y="-14264.32" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-14253.32" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer7_mlp_up_stage0&#45;&gt;layer7_mlp_down_stage0 -->
<g id="edge157" class="edge">
<title>layer7_mlp_up_stage0&#45;&gt;layer7_mlp_down_stage0</title>
<path fill="none" stroke="black" d="M532.32,-14333.98C526.4,-14325.5 519.71,-14315.9 513.42,-14306.89"/>
<polygon fill="black" stroke="black" points="516.14,-14304.68 507.55,-14298.48 510.4,-14308.68 516.14,-14304.68"/>
</g>
<!-- layer7_mlp_gelu_stage0&#45;&gt;layer7_mlp_down_stage0 -->
<g id="edge156" class="edge">
<title>layer7_mlp_gelu_stage0&#45;&gt;layer7_mlp_down_stage0</title>
<path fill="none" stroke="black" d="M316.52,-14334.22C345.45,-14324.06 379,-14312.28 408.84,-14301.81"/>
<polygon fill="black" stroke="black" points="410.11,-14305.07 418.39,-14298.46 407.79,-14298.47 410.11,-14305.07"/>
</g>
<!-- layer7_mlp_allreduce_stage0 -->
<g id="node125" class="node">
<title>layer7_mlp_allreduce_stage0</title>
<ellipse fill="lightgray" stroke="black" cx="490" cy="-14173.55" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="490" y="-14187.55" font-family="Arial" font-size="10.00">Layer 7 MLP All&#45;reduce</text>
<text text-anchor="middle" x="490" y="-14176.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-14165.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-14154.55" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer7_mlp_down_stage0&#45;&gt;layer7_mlp_allreduce_stage0 -->
<g id="edge158" class="edge">
<title>layer7_mlp_down_stage0&#45;&gt;layer7_mlp_allreduce_stage0</title>
<path fill="none" stroke="black" d="M490,-14246.15C490,-14238.34 490,-14229.47 490,-14220.71"/>
<polygon fill="black" stroke="black" points="493.5,-14220.53 490,-14210.53 486.5,-14220.53 493.5,-14220.53"/>
</g>
<!-- layer7_mlp_allreduce_stage0&#45;&gt;layer7_residual2_stage0 -->
<g id="edge159" class="edge">
<title>layer7_mlp_allreduce_stage0&#45;&gt;layer7_residual2_stage0</title>
<path fill="none" stroke="black" d="M507.52,-14136.71C511.96,-14127.61 516.86,-14117.59 521.7,-14107.7"/>
<polygon fill="black" stroke="black" points="524.86,-14109.19 526.11,-14098.67 518.57,-14106.12 524.86,-14109.19"/>
</g>
<!-- layer7_layernorm2_stage0 -->
<g id="node127" class="node">
<title>layer7_layernorm2_stage0</title>
<polygon fill="lightgreen" stroke="black" points="694.5,-13960.78 405.5,-13960.78 405.5,-13908.78 694.5,-13908.78 694.5,-13960.78"/>
<text text-anchor="middle" x="550" y="-13948.78" font-family="Arial" font-size="10.00">Layer 7 Layer Norm 2</text>
<text text-anchor="middle" x="550" y="-13937.78" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-13926.78" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-13915.78" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer7_residual2_stage0&#45;&gt;layer7_layernorm2_stage0 -->
<g id="edge161" class="edge">
<title>layer7_residual2_stage0&#45;&gt;layer7_layernorm2_stage0</title>
<path fill="none" stroke="black" d="M550,-13996.7C550,-13988.03 550,-13979.21 550,-13971.07"/>
<polygon fill="black" stroke="black" points="553.5,-13970.83 550,-13960.83 546.5,-13970.83 553.5,-13970.83"/>
</g>
<!-- layer8_input_stage0 -->
<g id="node128" class="node">
<title>layer8_input_stage0</title>
<polygon fill="lightyellow" stroke="black" points="849.74,-13872.78 372.92,-13872.78 250.26,-13768.78 727.08,-13768.78 849.74,-13872.78"/>
<text text-anchor="middle" x="550" y="-13834.78" font-family="Arial" font-size="10.00">Layer 8 Input</text>
<text text-anchor="middle" x="550" y="-13823.78" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-13812.78" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-13801.78" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer7_layernorm2_stage0&#45;&gt;layer8_input_stage0 -->
<g id="edge162" class="edge">
<title>layer7_layernorm2_stage0&#45;&gt;layer8_input_stage0</title>
<path fill="none" stroke="black" d="M550,-13908.65C550,-13900.96 550,-13892.15 550,-13883.15"/>
<polygon fill="black" stroke="black" points="553.5,-13882.96 550,-13872.96 546.5,-13882.96 553.5,-13882.96"/>
</g>
<!-- layer8_mha_query_stage0 -->
<g id="node129" class="node">
<title>layer8_mha_query_stage0</title>
<polygon fill="pink" stroke="black" points="321.5,-13732.78 30.5,-13732.78 30.5,-13680.78 321.5,-13680.78 321.5,-13732.78"/>
<text text-anchor="middle" x="176" y="-13720.78" font-family="Arial" font-size="10.00">Layer 8 MHA Query Linear</text>
<text text-anchor="middle" x="176" y="-13709.78" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="176" y="-13698.78" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_q=512]</text>
<text text-anchor="middle" x="176" y="-13687.78" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer8_input_stage0&#45;&gt;layer8_mha_query_stage0 -->
<g id="edge163" class="edge">
<title>layer8_input_stage0&#45;&gt;layer8_mha_query_stage0</title>
<path fill="none" stroke="black" d="M379.69,-13768.78C341.78,-13757.43 302.96,-13745.8 269.51,-13735.78"/>
<polygon fill="black" stroke="black" points="270.35,-13732.38 259.76,-13732.87 268.34,-13739.09 270.35,-13732.38"/>
</g>
<!-- layer8_mha_key_stage0 -->
<g id="node130" class="node">
<title>layer8_mha_key_stage0</title>
<polygon fill="pink" stroke="black" points="630.5,-13732.78 339.5,-13732.78 339.5,-13680.78 630.5,-13680.78 630.5,-13732.78"/>
<text text-anchor="middle" x="485" y="-13720.78" font-family="Arial" font-size="10.00">Layer 8 MHA Key Linear</text>
<text text-anchor="middle" x="485" y="-13709.78" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="485" y="-13698.78" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="485" y="-13687.78" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer8_input_stage0&#45;&gt;layer8_mha_key_stage0 -->
<g id="edge164" class="edge">
<title>layer8_input_stage0&#45;&gt;layer8_mha_key_stage0</title>
<path fill="none" stroke="black" d="M520.35,-13768.7C515.04,-13759.55 509.63,-13750.22 504.69,-13741.7"/>
<polygon fill="black" stroke="black" points="507.58,-13739.72 499.53,-13732.83 501.53,-13743.23 507.58,-13739.72"/>
</g>
<!-- layer8_mha_value_stage0 -->
<g id="node131" class="node">
<title>layer8_mha_value_stage0</title>
<polygon fill="pink" stroke="black" points="704.5,-13644.78 413.5,-13644.78 413.5,-13592.78 704.5,-13592.78 704.5,-13644.78"/>
<text text-anchor="middle" x="559" y="-13632.78" font-family="Arial" font-size="10.00">Layer 8 MHA Value Linear</text>
<text text-anchor="middle" x="559" y="-13621.78" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="559" y="-13610.78" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_v=512]</text>
<text text-anchor="middle" x="559" y="-13599.78" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer8_input_stage0&#45;&gt;layer8_mha_value_stage0 -->
<g id="edge165" class="edge">
<title>layer8_input_stage0&#45;&gt;layer8_mha_value_stage0</title>
<path fill="none" stroke="black" d="M616.33,-13768.48C625.97,-13757.8 634.48,-13745.79 640,-13732.78 649.02,-13711.51 650.32,-13701.46 640,-13680.78 634.3,-13669.35 625.31,-13659.49 615.37,-13651.24"/>
<polygon fill="black" stroke="black" points="617.29,-13648.3 607.24,-13644.97 613.02,-13653.84 617.29,-13648.3"/>
</g>
<!-- layer8_residual1_stage0 -->
<g id="node137" class="node">
<title>layer8_residual1_stage0</title>
<polygon fill="lightblue" stroke="black" points="550,-13183.24 26,-13131.24 550,-13079.24 1074,-13131.24 550,-13183.24"/>
<text text-anchor="middle" x="550" y="-13145.24" font-family="Arial" font-size="10.00">Layer 8 Residual Add 1</text>
<text text-anchor="middle" x="550" y="-13134.24" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-13123.24" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-13112.24" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer8_input_stage0&#45;&gt;layer8_residual1_stage0 -->
<g id="edge174" class="edge">
<title>layer8_input_stage0&#45;&gt;layer8_residual1_stage0</title>
<path fill="none" stroke="black" d="M630.42,-13768.72C675.6,-13733.21 723,-13681.3 723,-13619.78 723,-13619.78 723,-13619.78 723,-13353.78 723,-13293.82 745.73,-13269.48 713,-13219.24 702.19,-13202.65 687.12,-13189 670.46,-13177.84"/>
<polygon fill="black" stroke="black" points="671.94,-13174.63 661.62,-13172.23 668.19,-13180.54 671.94,-13174.63"/>
</g>
<!-- layer8_mha_qkt_stage0 -->
<g id="node132" class="node">
<title>layer8_mha_qkt_stage0</title>
<polygon fill="lightcoral" stroke="black" points="395,-13644.78 75,-13644.78 75,-13592.78 395,-13592.78 395,-13644.78"/>
<text text-anchor="middle" x="235" y="-13632.78" font-family="Arial" font-size="10.00">Layer 8 MHA QKT Calculation</text>
<text text-anchor="middle" x="235" y="-13621.78" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="235" y="-13610.78" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="235" y="-13599.78" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer8_mha_query_stage0&#45;&gt;layer8_mha_qkt_stage0 -->
<g id="edge166" class="edge">
<title>layer8_mha_query_stage0&#45;&gt;layer8_mha_qkt_stage0</title>
<path fill="none" stroke="black" d="M193.38,-13680.44C199.2,-13671.96 205.79,-13662.36 211.97,-13653.35"/>
<polygon fill="black" stroke="black" points="214.97,-13655.16 217.74,-13644.94 209.2,-13651.2 214.97,-13655.16"/>
</g>
<!-- layer8_mha_key_stage0&#45;&gt;layer8_mha_qkt_stage0 -->
<g id="edge167" class="edge">
<title>layer8_mha_key_stage0&#45;&gt;layer8_mha_qkt_stage0</title>
<path fill="none" stroke="black" d="M412.02,-13680.68C382.5,-13670.52 348.26,-13658.75 317.82,-13648.27"/>
<polygon fill="black" stroke="black" points="318.67,-13644.86 308.07,-13644.92 316.39,-13651.48 318.67,-13644.86"/>
</g>
<!-- layer8_mha_apply_stage0 -->
<g id="node134" class="node">
<title>layer8_mha_apply_stage0</title>
<polygon fill="lightcoral" stroke="black" points="656,-13468.78 344,-13468.78 344,-13416.78 656,-13416.78 656,-13468.78"/>
<text text-anchor="middle" x="500" y="-13456.78" font-family="Arial" font-size="10.00">Layer 8 MHA Apply Attention</text>
<text text-anchor="middle" x="500" y="-13445.78" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="500" y="-13434.78" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="500" y="-13423.78" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer8_mha_value_stage0&#45;&gt;layer8_mha_apply_stage0 -->
<g id="edge170" class="edge">
<title>layer8_mha_value_stage0&#45;&gt;layer8_mha_apply_stage0</title>
<path fill="none" stroke="black" d="M550.42,-13592.48C540.25,-13562.5 523.26,-13512.38 511.84,-13478.71"/>
<polygon fill="black" stroke="black" points="515.02,-13477.18 508.49,-13468.83 508.39,-13479.43 515.02,-13477.18"/>
</g>
<!-- layer8_mha_weights_stage0 -->
<g id="node133" class="node">
<title>layer8_mha_weights_stage0</title>
<polygon fill="lightcoral" stroke="black" points="453,-13556.78 133,-13556.78 133,-13504.78 453,-13504.78 453,-13556.78"/>
<text text-anchor="middle" x="293" y="-13544.78" font-family="Arial" font-size="10.00">Layer 8 MHA Attention Weights</text>
<text text-anchor="middle" x="293" y="-13533.78" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="293" y="-13522.78" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="293" y="-13511.78" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer8_mha_qkt_stage0&#45;&gt;layer8_mha_weights_stage0 -->
<g id="edge168" class="edge">
<title>layer8_mha_qkt_stage0&#45;&gt;layer8_mha_weights_stage0</title>
<path fill="none" stroke="black" d="M252.09,-13592.44C257.81,-13583.96 264.28,-13574.36 270.36,-13565.35"/>
<polygon fill="black" stroke="black" points="273.34,-13567.19 276.03,-13556.94 267.54,-13563.27 273.34,-13567.19"/>
</g>
<!-- layer8_mha_weights_stage0&#45;&gt;layer8_mha_apply_stage0 -->
<g id="edge169" class="edge">
<title>layer8_mha_weights_stage0&#45;&gt;layer8_mha_apply_stage0</title>
<path fill="none" stroke="black" d="M353.43,-13504.68C377.45,-13494.7 405.24,-13483.15 430.12,-13472.82"/>
<polygon fill="black" stroke="black" points="431.6,-13475.99 439.5,-13468.92 428.92,-13469.52 431.6,-13475.99"/>
</g>
<!-- layer8_mha_out_stage0 -->
<g id="node135" class="node">
<title>layer8_mha_out_stage0</title>
<polygon fill="pink" stroke="black" points="644.5,-13380.78 355.5,-13380.78 355.5,-13328.78 644.5,-13328.78 644.5,-13380.78"/>
<text text-anchor="middle" x="500" y="-13368.78" font-family="Arial" font-size="10.00">Layer 8 MHA Output Linear</text>
<text text-anchor="middle" x="500" y="-13357.78" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="500" y="-13346.78" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="500" y="-13335.78" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer8_mha_apply_stage0&#45;&gt;layer8_mha_out_stage0 -->
<g id="edge171" class="edge">
<title>layer8_mha_apply_stage0&#45;&gt;layer8_mha_out_stage0</title>
<path fill="none" stroke="black" d="M500,-13416.44C500,-13408.48 500,-13399.55 500,-13391.03"/>
<polygon fill="black" stroke="black" points="503.5,-13390.94 500,-13380.94 496.5,-13390.94 503.5,-13390.94"/>
</g>
<!-- layer8_mha_allreduce_stage0 -->
<g id="node136" class="node">
<title>layer8_mha_allreduce_stage0</title>
<ellipse fill="lightgray" stroke="black" cx="500" cy="-13256.01" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="500" y="-13270.01" font-family="Arial" font-size="10.00">Layer 8 MHA All&#45;reduce</text>
<text text-anchor="middle" x="500" y="-13259.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="500" y="-13248.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="500" y="-13237.01" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer8_mha_out_stage0&#45;&gt;layer8_mha_allreduce_stage0 -->
<g id="edge172" class="edge">
<title>layer8_mha_out_stage0&#45;&gt;layer8_mha_allreduce_stage0</title>
<path fill="none" stroke="black" d="M500,-13328.61C500,-13320.8 500,-13311.94 500,-13303.17"/>
<polygon fill="black" stroke="black" points="503.5,-13302.99 500,-13292.99 496.5,-13302.99 503.5,-13302.99"/>
</g>
<!-- layer8_mha_allreduce_stage0&#45;&gt;layer8_residual1_stage0 -->
<g id="edge173" class="edge">
<title>layer8_mha_allreduce_stage0&#45;&gt;layer8_residual1_stage0</title>
<path fill="none" stroke="black" d="M514.6,-13219.17C518.19,-13210.36 522.12,-13200.69 526.03,-13191.11"/>
<polygon fill="black" stroke="black" points="529.37,-13192.17 529.9,-13181.59 522.89,-13189.53 529.37,-13192.17"/>
</g>
<!-- layer8_layernorm1_stage0 -->
<g id="node138" class="node">
<title>layer8_layernorm1_stage0</title>
<polygon fill="lightgreen" stroke="black" points="694.5,-13043.24 405.5,-13043.24 405.5,-12991.24 694.5,-12991.24 694.5,-13043.24"/>
<text text-anchor="middle" x="550" y="-13031.24" font-family="Arial" font-size="10.00">Layer 8 Layer Norm 1</text>
<text text-anchor="middle" x="550" y="-13020.24" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-13009.24" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-12998.24" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer8_residual1_stage0&#45;&gt;layer8_layernorm1_stage0 -->
<g id="edge175" class="edge">
<title>layer8_residual1_stage0&#45;&gt;layer8_layernorm1_stage0</title>
<path fill="none" stroke="black" d="M550,-13079.16C550,-13070.49 550,-13061.67 550,-13053.53"/>
<polygon fill="black" stroke="black" points="553.5,-13053.29 550,-13043.29 546.5,-13053.29 553.5,-13053.29"/>
</g>
<!-- layer8_mlp_gate_stage0 -->
<g id="node139" class="node">
<title>layer8_mlp_gate_stage0</title>
<polygon fill="lightyellow" stroke="black" points="459.5,-12955.24 172.5,-12955.24 172.5,-12903.24 459.5,-12903.24 459.5,-12955.24"/>
<text text-anchor="middle" x="316" y="-12943.24" font-family="Arial" font-size="10.00">Layer 8 MLP Gate Linear</text>
<text text-anchor="middle" x="316" y="-12932.24" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="316" y="-12921.24" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="316" y="-12910.24" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer8_layernorm1_stage0&#45;&gt;layer8_mlp_gate_stage0 -->
<g id="edge176" class="edge">
<title>layer8_layernorm1_stage0&#45;&gt;layer8_mlp_gate_stage0</title>
<path fill="none" stroke="black" d="M481.69,-12991.14C454.18,-12981.03 422.29,-12969.31 393.89,-12958.87"/>
<polygon fill="black" stroke="black" points="394.99,-12955.54 384.4,-12955.38 392.58,-12962.11 394.99,-12955.54"/>
</g>
<!-- layer8_mlp_up_stage0 -->
<g id="node140" class="node">
<title>layer8_mlp_up_stage0</title>
<polygon fill="lightyellow" stroke="black" points="693.5,-12867.24 406.5,-12867.24 406.5,-12815.24 693.5,-12815.24 693.5,-12867.24"/>
<text text-anchor="middle" x="550" y="-12855.24" font-family="Arial" font-size="10.00">Layer 8 MLP Up Linear</text>
<text text-anchor="middle" x="550" y="-12844.24" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-12833.24" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="550" y="-12822.24" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer8_layernorm1_stage0&#45;&gt;layer8_mlp_up_stage0 -->
<g id="edge177" class="edge">
<title>layer8_layernorm1_stage0&#45;&gt;layer8_mlp_up_stage0</title>
<path fill="none" stroke="black" d="M550,-12990.94C550,-12961.09 550,-12911.27 550,-12877.61"/>
<polygon fill="black" stroke="black" points="553.5,-12877.29 550,-12867.29 546.5,-12877.29 553.5,-12877.29"/>
</g>
<!-- layer8_residual2_stage0 -->
<g id="node144" class="node">
<title>layer8_residual2_stage0</title>
<polygon fill="lightblue" stroke="black" points="550,-12581.7 26,-12529.7 550,-12477.7 1074,-12529.7 550,-12581.7"/>
<text text-anchor="middle" x="550" y="-12543.7" font-family="Arial" font-size="10.00">Layer 8 Residual Add 2</text>
<text text-anchor="middle" x="550" y="-12532.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-12521.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-12510.7" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer8_layernorm1_stage0&#45;&gt;layer8_residual2_stage0 -->
<g id="edge183" class="edge">
<title>layer8_layernorm1_stage0&#45;&gt;layer8_residual2_stage0</title>
<path fill="none" stroke="black" d="M598.46,-12991.02C646.51,-12962.13 713,-12909.92 713,-12842.24 713,-12842.24 713,-12842.24 713,-12752.24 713,-12692.28 735.05,-12668.38 703,-12617.7 692.85,-12601.65 678.6,-12588.26 662.85,-12577.19"/>
<polygon fill="black" stroke="black" points="664.75,-12574.26 654.49,-12571.62 660.87,-12580.08 664.75,-12574.26"/>
</g>
<!-- layer8_mlp_gelu_stage0 -->
<g id="node141" class="node">
<title>layer8_mlp_gelu_stage0</title>
<polygon fill="orange" stroke="black" points="388.5,-12867.24 101.5,-12867.24 101.5,-12815.24 388.5,-12815.24 388.5,-12867.24"/>
<text text-anchor="middle" x="245" y="-12855.24" font-family="Arial" font-size="10.00">Layer 8 MLP GELU</text>
<text text-anchor="middle" x="245" y="-12844.24" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="245" y="-12833.24" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="245" y="-12822.24" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer8_mlp_gate_stage0&#45;&gt;layer8_mlp_gelu_stage0 -->
<g id="edge178" class="edge">
<title>layer8_mlp_gate_stage0&#45;&gt;layer8_mlp_gelu_stage0</title>
<path fill="none" stroke="black" d="M295.08,-12902.91C287.93,-12894.24 279.83,-12884.43 272.25,-12875.25"/>
<polygon fill="black" stroke="black" points="274.83,-12872.88 265.77,-12867.4 269.44,-12877.34 274.83,-12872.88"/>
</g>
<!-- layer8_mlp_down_stage0 -->
<g id="node142" class="node">
<title>layer8_mlp_down_stage0</title>
<polygon fill="lightyellow" stroke="black" points="634.5,-12779.24 345.5,-12779.24 345.5,-12727.24 634.5,-12727.24 634.5,-12779.24"/>
<text text-anchor="middle" x="490" y="-12767.24" font-family="Arial" font-size="10.00">Layer 8 MLP Down Linear</text>
<text text-anchor="middle" x="490" y="-12756.24" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="490" y="-12745.24" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-12734.24" font-family="Arial" font-size="10.00">GPU: Each shard 0&#45;7</text>
</g>
<!-- layer8_mlp_up_stage0&#45;&gt;layer8_mlp_down_stage0 -->
<g id="edge180" class="edge">
<title>layer8_mlp_up_stage0&#45;&gt;layer8_mlp_down_stage0</title>
<path fill="none" stroke="black" d="M532.32,-12814.91C526.4,-12806.42 519.71,-12796.82 513.42,-12787.81"/>
<polygon fill="black" stroke="black" points="516.14,-12785.6 507.55,-12779.4 510.4,-12789.6 516.14,-12785.6"/>
</g>
<!-- layer8_mlp_gelu_stage0&#45;&gt;layer8_mlp_down_stage0 -->
<g id="edge179" class="edge">
<title>layer8_mlp_gelu_stage0&#45;&gt;layer8_mlp_down_stage0</title>
<path fill="none" stroke="black" d="M316.52,-12815.14C345.45,-12804.98 379,-12793.21 408.84,-12782.73"/>
<polygon fill="black" stroke="black" points="410.11,-12785.99 418.39,-12779.38 407.79,-12779.39 410.11,-12785.99"/>
</g>
<!-- layer8_mlp_allreduce_stage0 -->
<g id="node143" class="node">
<title>layer8_mlp_allreduce_stage0</title>
<ellipse fill="lightgray" stroke="black" cx="490" cy="-12654.47" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="490" y="-12668.47" font-family="Arial" font-size="10.00">Layer 8 MLP All&#45;reduce</text>
<text text-anchor="middle" x="490" y="-12657.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-12646.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-12635.47" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer8_mlp_down_stage0&#45;&gt;layer8_mlp_allreduce_stage0 -->
<g id="edge181" class="edge">
<title>layer8_mlp_down_stage0&#45;&gt;layer8_mlp_allreduce_stage0</title>
<path fill="none" stroke="black" d="M490,-12727.07C490,-12719.26 490,-12710.4 490,-12701.63"/>
<polygon fill="black" stroke="black" points="493.5,-12701.45 490,-12691.45 486.5,-12701.45 493.5,-12701.45"/>
</g>
<!-- layer8_mlp_allreduce_stage0&#45;&gt;layer8_residual2_stage0 -->
<g id="edge182" class="edge">
<title>layer8_mlp_allreduce_stage0&#45;&gt;layer8_residual2_stage0</title>
<path fill="none" stroke="black" d="M507.52,-12617.63C511.96,-12608.53 516.86,-12598.51 521.7,-12588.62"/>
<polygon fill="black" stroke="black" points="524.86,-12590.12 526.11,-12579.59 518.57,-12587.04 524.86,-12590.12"/>
</g>
<!-- layer8_layernorm2_stage0 -->
<g id="node145" class="node">
<title>layer8_layernorm2_stage0</title>
<polygon fill="lightgreen" stroke="black" points="694.5,-12441.7 405.5,-12441.7 405.5,-12389.7 694.5,-12389.7 694.5,-12441.7"/>
<text text-anchor="middle" x="550" y="-12429.7" font-family="Arial" font-size="10.00">Layer 8 Layer Norm 2</text>
<text text-anchor="middle" x="550" y="-12418.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-12407.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-12396.7" font-family="Arial" font-size="10.00">GPU: All devices 0&#45;7</text>
</g>
<!-- layer8_residual2_stage0&#45;&gt;layer8_layernorm2_stage0 -->
<g id="edge184" class="edge">
<title>layer8_residual2_stage0&#45;&gt;layer8_layernorm2_stage0</title>
<path fill="none" stroke="black" d="M550,-12477.62C550,-12468.96 550,-12460.13 550,-12451.99"/>
<polygon fill="black" stroke="black" points="553.5,-12451.75 550,-12441.75 546.5,-12451.75 553.5,-12451.75"/>
</g>
<!-- pipeline_communication -->
<g id="node290" class="node">
<title>pipeline_communication</title>
<ellipse fill="gray" stroke="black" cx="550" cy="-12316.93" rx="209.11" ry="36.54"/>
<text text-anchor="middle" x="550" y="-12330.93" font-family="Arial" font-size="10.00">Pipeline Communication</text>
<text text-anchor="middle" x="550" y="-12319.93" font-family="Arial" font-size="10.00">Transfer: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-12308.93" font-family="Arial" font-size="10.00">From: Devices 0&#45;7</text>
<text text-anchor="middle" x="550" y="-12297.93" font-family="Arial" font-size="10.00">To: Devices 8&#45;15</text>
</g>
<!-- layer8_layernorm2_stage0&#45;&gt;pipeline_communication -->
<g id="edge185" class="edge">
<title>layer8_layernorm2_stage0&#45;&gt;pipeline_communication</title>
<path fill="none" stroke="black" d="M550,-12389.53C550,-12381.72 550,-12372.86 550,-12364.09"/>
<polygon fill="black" stroke="black" points="553.5,-12363.91 550,-12353.91 546.5,-12363.91 553.5,-12363.91"/>
</g>
<!-- layer9_input_stage1 -->
<g id="node146" class="node">
<title>layer9_input_stage1</title>
<polygon fill="lightyellow" stroke="black" points="849.74,-12226.16 372.92,-12226.16 250.26,-12122.16 727.08,-12122.16 849.74,-12226.16"/>
<text text-anchor="middle" x="550" y="-12188.16" font-family="Arial" font-size="10.00">Layer 9 Input</text>
<text text-anchor="middle" x="550" y="-12177.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-12166.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="550" y="-12155.16" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer9_mha_query_stage1 -->
<g id="node147" class="node">
<title>layer9_mha_query_stage1</title>
<polygon fill="pink" stroke="black" points="346.5,-12086.16 55.5,-12086.16 55.5,-12034.16 346.5,-12034.16 346.5,-12086.16"/>
<text text-anchor="middle" x="201" y="-12074.16" font-family="Arial" font-size="10.00">Layer 9 MHA Query Linear</text>
<text text-anchor="middle" x="201" y="-12063.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="201" y="-12052.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_q=512]</text>
<text text-anchor="middle" x="201" y="-12041.16" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer9_input_stage1&#45;&gt;layer9_mha_query_stage1 -->
<g id="edge187" class="edge">
<title>layer9_input_stage1&#45;&gt;layer9_mha_query_stage1</title>
<path fill="none" stroke="black" d="M391.07,-12122.16C356.01,-12110.91 320.09,-12099.38 289.06,-12089.42"/>
<polygon fill="black" stroke="black" points="289.75,-12085.97 279.16,-12086.25 287.62,-12092.64 289.75,-12085.97"/>
</g>
<!-- layer9_mha_key_stage1 -->
<g id="node148" class="node">
<title>layer9_mha_key_stage1</title>
<polygon fill="pink" stroke="black" points="655.5,-12086.16 364.5,-12086.16 364.5,-12034.16 655.5,-12034.16 655.5,-12086.16"/>
<text text-anchor="middle" x="510" y="-12074.16" font-family="Arial" font-size="10.00">Layer 9 MHA Key Linear</text>
<text text-anchor="middle" x="510" y="-12063.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="510" y="-12052.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="510" y="-12041.16" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer9_input_stage1&#45;&gt;layer9_mha_key_stage1 -->
<g id="edge188" class="edge">
<title>layer9_input_stage1&#45;&gt;layer9_mha_key_stage1</title>
<path fill="none" stroke="black" d="M531.76,-12122.08C528.56,-12113.12 525.3,-12104 522.31,-12095.63"/>
<polygon fill="black" stroke="black" points="525.6,-12094.45 518.94,-12086.21 519.01,-12096.8 525.6,-12094.45"/>
</g>
<!-- layer9_mha_value_stage1 -->
<g id="node149" class="node">
<title>layer9_mha_value_stage1</title>
<polygon fill="pink" stroke="black" points="689.5,-11998.16 398.5,-11998.16 398.5,-11946.16 689.5,-11946.16 689.5,-11998.16"/>
<text text-anchor="middle" x="544" y="-11986.16" font-family="Arial" font-size="10.00">Layer 9 MHA Value Linear</text>
<text text-anchor="middle" x="544" y="-11975.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="544" y="-11964.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_v=512]</text>
<text text-anchor="middle" x="544" y="-11953.16" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer9_input_stage1&#45;&gt;layer9_mha_value_stage1 -->
<g id="edge189" class="edge">
<title>layer9_input_stage1&#45;&gt;layer9_mha_value_stage1</title>
<path fill="none" stroke="black" d="M637.25,-12121.91C648.44,-12111.54 658.31,-12099.61 665,-12086.16 675.29,-12065.47 677.12,-12053.84 665,-12034.16 657.28,-12021.63 646.11,-12011.58 633.63,-12003.55"/>
<polygon fill="black" stroke="black" points="635.2,-12000.41 624.81,-11998.3 631.62,-12006.42 635.2,-12000.41"/>
</g>
<!-- layer9_residual1_stage1 -->
<g id="node155" class="node">
<title>layer9_residual1_stage1</title>
<polygon fill="lightblue" stroke="black" points="540,-11536.63 16,-11484.63 540,-11432.63 1064,-11484.63 540,-11536.63"/>
<text text-anchor="middle" x="540" y="-11498.63" font-family="Arial" font-size="10.00">Layer 9 Residual Add 1</text>
<text text-anchor="middle" x="540" y="-11487.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-11476.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-11465.63" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer9_input_stage1&#45;&gt;layer9_residual1_stage1 -->
<g id="edge198" class="edge">
<title>layer9_input_stage1&#45;&gt;layer9_residual1_stage1</title>
<path fill="none" stroke="black" d="M638.94,-12122.02C652.06,-12111.49 664.37,-12099.49 674,-12086.16 704.71,-12043.65 708,-12025.61 708,-11973.16 708,-11973.16 708,-11973.16 708,-11707.16 708,-11647.2 730.4,-11623.08 698,-11572.63 687.48,-11556.25 672.76,-11542.69 656.48,-11531.56"/>
<polygon fill="black" stroke="black" points="658.14,-11528.46 647.85,-11525.95 654.33,-11534.33 658.14,-11528.46"/>
</g>
<!-- layer9_mha_qkt_stage1 -->
<g id="node150" class="node">
<title>layer9_mha_qkt_stage1</title>
<polygon fill="lightcoral" stroke="black" points="380,-11998.16 60,-11998.16 60,-11946.16 380,-11946.16 380,-11998.16"/>
<text text-anchor="middle" x="220" y="-11986.16" font-family="Arial" font-size="10.00">Layer 9 MHA QKT Calculation</text>
<text text-anchor="middle" x="220" y="-11975.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="220" y="-11964.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="220" y="-11953.16" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer9_mha_query_stage1&#45;&gt;layer9_mha_qkt_stage1 -->
<g id="edge190" class="edge">
<title>layer9_mha_query_stage1&#45;&gt;layer9_mha_qkt_stage1</title>
<path fill="none" stroke="black" d="M206.6,-12033.83C208.38,-12025.78 210.37,-12016.73 212.28,-12008.13"/>
<polygon fill="black" stroke="black" points="215.7,-12008.84 214.44,-11998.32 208.87,-12007.33 215.7,-12008.84"/>
</g>
<!-- layer9_mha_key_stage1&#45;&gt;layer9_mha_qkt_stage1 -->
<g id="edge191" class="edge">
<title>layer9_mha_key_stage1&#45;&gt;layer9_mha_qkt_stage1</title>
<path fill="none" stroke="black" d="M425.34,-12034.06C390.57,-12023.75 350.18,-12011.77 314.46,-12001.18"/>
<polygon fill="black" stroke="black" points="315.1,-11997.72 304.51,-11998.23 313.11,-12004.43 315.1,-11997.72"/>
</g>
<!-- layer9_mha_apply_stage1 -->
<g id="node152" class="node">
<title>layer9_mha_apply_stage1</title>
<polygon fill="lightcoral" stroke="black" points="641,-11822.16 329,-11822.16 329,-11770.16 641,-11770.16 641,-11822.16"/>
<text text-anchor="middle" x="485" y="-11810.16" font-family="Arial" font-size="10.00">Layer 9 MHA Apply Attention</text>
<text text-anchor="middle" x="485" y="-11799.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="485" y="-11788.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="485" y="-11777.16" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer9_mha_value_stage1&#45;&gt;layer9_mha_apply_stage1 -->
<g id="edge194" class="edge">
<title>layer9_mha_value_stage1&#45;&gt;layer9_mha_apply_stage1</title>
<path fill="none" stroke="black" d="M535.42,-11945.86C525.25,-11915.88 508.26,-11865.76 496.84,-11832.09"/>
<polygon fill="black" stroke="black" points="500.02,-11830.56 493.49,-11822.21 493.39,-11832.81 500.02,-11830.56"/>
</g>
<!-- layer9_mha_weights_stage1 -->
<g id="node151" class="node">
<title>layer9_mha_weights_stage1</title>
<polygon fill="lightcoral" stroke="black" points="438,-11910.16 118,-11910.16 118,-11858.16 438,-11858.16 438,-11910.16"/>
<text text-anchor="middle" x="278" y="-11898.16" font-family="Arial" font-size="10.00">Layer 9 MHA Attention Weights</text>
<text text-anchor="middle" x="278" y="-11887.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="278" y="-11876.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="278" y="-11865.16" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer9_mha_qkt_stage1&#45;&gt;layer9_mha_weights_stage1 -->
<g id="edge192" class="edge">
<title>layer9_mha_qkt_stage1&#45;&gt;layer9_mha_weights_stage1</title>
<path fill="none" stroke="black" d="M237.09,-11945.83C242.81,-11937.34 249.28,-11927.75 255.36,-11918.73"/>
<polygon fill="black" stroke="black" points="258.34,-11920.57 261.03,-11910.32 252.54,-11916.66 258.34,-11920.57"/>
</g>
<!-- layer9_mha_weights_stage1&#45;&gt;layer9_mha_apply_stage1 -->
<g id="edge193" class="edge">
<title>layer9_mha_weights_stage1&#45;&gt;layer9_mha_apply_stage1</title>
<path fill="none" stroke="black" d="M338.43,-11858.06C362.45,-11848.08 390.24,-11836.54 415.12,-11826.2"/>
<polygon fill="black" stroke="black" points="416.6,-11829.37 424.5,-11822.3 413.92,-11822.91 416.6,-11829.37"/>
</g>
<!-- layer9_mha_out_stage1 -->
<g id="node153" class="node">
<title>layer9_mha_out_stage1</title>
<polygon fill="pink" stroke="black" points="629.5,-11734.16 340.5,-11734.16 340.5,-11682.16 629.5,-11682.16 629.5,-11734.16"/>
<text text-anchor="middle" x="485" y="-11722.16" font-family="Arial" font-size="10.00">Layer 9 MHA Output Linear</text>
<text text-anchor="middle" x="485" y="-11711.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="485" y="-11700.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="485" y="-11689.16" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer9_mha_apply_stage1&#45;&gt;layer9_mha_out_stage1 -->
<g id="edge195" class="edge">
<title>layer9_mha_apply_stage1&#45;&gt;layer9_mha_out_stage1</title>
<path fill="none" stroke="black" d="M485,-11769.83C485,-11761.87 485,-11752.93 485,-11744.41"/>
<polygon fill="black" stroke="black" points="488.5,-11744.32 485,-11734.32 481.5,-11744.32 488.5,-11744.32"/>
</g>
<!-- layer9_mha_allreduce_stage1 -->
<g id="node154" class="node">
<title>layer9_mha_allreduce_stage1</title>
<ellipse fill="lightgray" stroke="black" cx="485" cy="-11609.4" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="485" y="-11623.4" font-family="Arial" font-size="10.00">Layer 9 MHA All&#45;reduce</text>
<text text-anchor="middle" x="485" y="-11612.4" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="485" y="-11601.4" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="485" y="-11590.4" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer9_mha_out_stage1&#45;&gt;layer9_mha_allreduce_stage1 -->
<g id="edge196" class="edge">
<title>layer9_mha_out_stage1&#45;&gt;layer9_mha_allreduce_stage1</title>
<path fill="none" stroke="black" d="M485,-11681.99C485,-11674.18 485,-11665.32 485,-11656.55"/>
<polygon fill="black" stroke="black" points="488.5,-11656.37 485,-11646.37 481.5,-11656.37 488.5,-11656.37"/>
</g>
<!-- layer9_mha_allreduce_stage1&#45;&gt;layer9_residual1_stage1 -->
<g id="edge197" class="edge">
<title>layer9_mha_allreduce_stage1&#45;&gt;layer9_residual1_stage1</title>
<path fill="none" stroke="black" d="M501.06,-11572.56C505.09,-11563.54 509.53,-11553.64 513.92,-11543.84"/>
<polygon fill="black" stroke="black" points="517.2,-11545.07 518.1,-11534.52 510.81,-11542.21 517.2,-11545.07"/>
</g>
<!-- layer9_layernorm1_stage1 -->
<g id="node156" class="node">
<title>layer9_layernorm1_stage1</title>
<polygon fill="lightgreen" stroke="black" points="684.5,-11396.63 395.5,-11396.63 395.5,-11344.63 684.5,-11344.63 684.5,-11396.63"/>
<text text-anchor="middle" x="540" y="-11384.63" font-family="Arial" font-size="10.00">Layer 9 Layer Norm 1</text>
<text text-anchor="middle" x="540" y="-11373.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-11362.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-11351.63" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer9_residual1_stage1&#45;&gt;layer9_layernorm1_stage1 -->
<g id="edge199" class="edge">
<title>layer9_residual1_stage1&#45;&gt;layer9_layernorm1_stage1</title>
<path fill="none" stroke="black" d="M540,-11432.54C540,-11423.88 540,-11415.05 540,-11406.91"/>
<polygon fill="black" stroke="black" points="543.5,-11406.67 540,-11396.67 536.5,-11406.67 543.5,-11406.67"/>
</g>
<!-- layer9_mlp_gate_stage1 -->
<g id="node157" class="node">
<title>layer9_mlp_gate_stage1</title>
<polygon fill="lightyellow" stroke="black" points="449.5,-11308.63 162.5,-11308.63 162.5,-11256.63 449.5,-11256.63 449.5,-11308.63"/>
<text text-anchor="middle" x="306" y="-11296.63" font-family="Arial" font-size="10.00">Layer 9 MLP Gate Linear</text>
<text text-anchor="middle" x="306" y="-11285.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="306" y="-11274.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="306" y="-11263.63" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer9_layernorm1_stage1&#45;&gt;layer9_mlp_gate_stage1 -->
<g id="edge200" class="edge">
<title>layer9_layernorm1_stage1&#45;&gt;layer9_mlp_gate_stage1</title>
<path fill="none" stroke="black" d="M471.69,-11344.52C444.18,-11334.41 412.29,-11322.69 383.89,-11312.25"/>
<polygon fill="black" stroke="black" points="384.99,-11308.93 374.4,-11308.76 382.58,-11315.5 384.99,-11308.93"/>
</g>
<!-- layer9_mlp_up_stage1 -->
<g id="node158" class="node">
<title>layer9_mlp_up_stage1</title>
<polygon fill="lightyellow" stroke="black" points="683.5,-11220.63 396.5,-11220.63 396.5,-11168.63 683.5,-11168.63 683.5,-11220.63"/>
<text text-anchor="middle" x="540" y="-11208.63" font-family="Arial" font-size="10.00">Layer 9 MLP Up Linear</text>
<text text-anchor="middle" x="540" y="-11197.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-11186.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="540" y="-11175.63" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer9_layernorm1_stage1&#45;&gt;layer9_mlp_up_stage1 -->
<g id="edge201" class="edge">
<title>layer9_layernorm1_stage1&#45;&gt;layer9_mlp_up_stage1</title>
<path fill="none" stroke="black" d="M540,-11344.32C540,-11314.47 540,-11264.65 540,-11230.99"/>
<polygon fill="black" stroke="black" points="543.5,-11230.67 540,-11220.68 536.5,-11230.68 543.5,-11230.67"/>
</g>
<!-- layer9_residual2_stage1 -->
<g id="node162" class="node">
<title>layer9_residual2_stage1</title>
<polygon fill="lightblue" stroke="black" points="540,-10935.09 16,-10883.09 540,-10831.09 1064,-10883.09 540,-10935.09"/>
<text text-anchor="middle" x="540" y="-10897.09" font-family="Arial" font-size="10.00">Layer 9 Residual Add 2</text>
<text text-anchor="middle" x="540" y="-10886.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-10875.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-10864.09" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer9_layernorm1_stage1&#45;&gt;layer9_residual2_stage1 -->
<g id="edge207" class="edge">
<title>layer9_layernorm1_stage1&#45;&gt;layer9_residual2_stage1</title>
<path fill="none" stroke="black" d="M588.46,-11344.4C636.51,-11315.51 703,-11263.3 703,-11195.63 703,-11195.63 703,-11195.63 703,-11105.63 703,-11045.67 725.05,-11021.76 693,-10971.09 682.85,-10955.03 668.6,-10941.65 652.85,-10930.58"/>
<polygon fill="black" stroke="black" points="654.75,-10927.64 644.49,-10925 650.87,-10933.46 654.75,-10927.64"/>
</g>
<!-- layer9_mlp_gelu_stage1 -->
<g id="node159" class="node">
<title>layer9_mlp_gelu_stage1</title>
<polygon fill="orange" stroke="black" points="378.5,-11220.63 91.5,-11220.63 91.5,-11168.63 378.5,-11168.63 378.5,-11220.63"/>
<text text-anchor="middle" x="235" y="-11208.63" font-family="Arial" font-size="10.00">Layer 9 MLP GELU</text>
<text text-anchor="middle" x="235" y="-11197.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="235" y="-11186.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="235" y="-11175.63" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer9_mlp_gate_stage1&#45;&gt;layer9_mlp_gelu_stage1 -->
<g id="edge202" class="edge">
<title>layer9_mlp_gate_stage1&#45;&gt;layer9_mlp_gelu_stage1</title>
<path fill="none" stroke="black" d="M285.08,-11256.29C277.93,-11247.63 269.83,-11237.81 262.25,-11228.63"/>
<polygon fill="black" stroke="black" points="264.83,-11226.27 255.77,-11220.78 259.44,-11230.72 264.83,-11226.27"/>
</g>
<!-- layer9_mlp_down_stage1 -->
<g id="node160" class="node">
<title>layer9_mlp_down_stage1</title>
<polygon fill="lightyellow" stroke="black" points="624.5,-11132.63 335.5,-11132.63 335.5,-11080.63 624.5,-11080.63 624.5,-11132.63"/>
<text text-anchor="middle" x="480" y="-11120.63" font-family="Arial" font-size="10.00">Layer 9 MLP Down Linear</text>
<text text-anchor="middle" x="480" y="-11109.63" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="480" y="-11098.63" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-11087.63" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer9_mlp_up_stage1&#45;&gt;layer9_mlp_down_stage1 -->
<g id="edge204" class="edge">
<title>layer9_mlp_up_stage1&#45;&gt;layer9_mlp_down_stage1</title>
<path fill="none" stroke="black" d="M522.32,-11168.29C516.4,-11159.8 509.71,-11150.21 503.42,-11141.19"/>
<polygon fill="black" stroke="black" points="506.14,-11138.98 497.55,-11132.78 500.4,-11142.99 506.14,-11138.98"/>
</g>
<!-- layer9_mlp_gelu_stage1&#45;&gt;layer9_mlp_down_stage1 -->
<g id="edge203" class="edge">
<title>layer9_mlp_gelu_stage1&#45;&gt;layer9_mlp_down_stage1</title>
<path fill="none" stroke="black" d="M306.52,-11168.52C335.45,-11158.36 369,-11146.59 398.84,-11136.11"/>
<polygon fill="black" stroke="black" points="400.11,-11139.38 408.39,-11132.76 397.79,-11132.77 400.11,-11139.38"/>
</g>
<!-- layer9_mlp_allreduce_stage1 -->
<g id="node161" class="node">
<title>layer9_mlp_allreduce_stage1</title>
<ellipse fill="lightgray" stroke="black" cx="480" cy="-11007.86" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="480" y="-11021.86" font-family="Arial" font-size="10.00">Layer 9 MLP All&#45;reduce</text>
<text text-anchor="middle" x="480" y="-11010.86" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-10999.86" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-10988.86" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer9_mlp_down_stage1&#45;&gt;layer9_mlp_allreduce_stage1 -->
<g id="edge205" class="edge">
<title>layer9_mlp_down_stage1&#45;&gt;layer9_mlp_allreduce_stage1</title>
<path fill="none" stroke="black" d="M480,-11080.45C480,-11072.64 480,-11063.78 480,-11055.01"/>
<polygon fill="black" stroke="black" points="483.5,-11054.83 480,-11044.83 476.5,-11054.83 483.5,-11054.83"/>
</g>
<!-- layer9_mlp_allreduce_stage1&#45;&gt;layer9_residual2_stage1 -->
<g id="edge206" class="edge">
<title>layer9_mlp_allreduce_stage1&#45;&gt;layer9_residual2_stage1</title>
<path fill="none" stroke="black" d="M497.52,-10971.02C501.96,-10961.91 506.86,-10951.9 511.7,-10942"/>
<polygon fill="black" stroke="black" points="514.86,-10943.5 516.11,-10932.98 508.57,-10940.43 514.86,-10943.5"/>
</g>
<!-- layer9_layernorm2_stage1 -->
<g id="node163" class="node">
<title>layer9_layernorm2_stage1</title>
<polygon fill="lightgreen" stroke="black" points="684.5,-10795.09 395.5,-10795.09 395.5,-10743.09 684.5,-10743.09 684.5,-10795.09"/>
<text text-anchor="middle" x="540" y="-10783.09" font-family="Arial" font-size="10.00">Layer 9 Layer Norm 2</text>
<text text-anchor="middle" x="540" y="-10772.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-10761.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-10750.09" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer9_residual2_stage1&#45;&gt;layer9_layernorm2_stage1 -->
<g id="edge208" class="edge">
<title>layer9_residual2_stage1&#45;&gt;layer9_layernorm2_stage1</title>
<path fill="none" stroke="black" d="M540,-10831C540,-10822.34 540,-10813.52 540,-10805.37"/>
<polygon fill="black" stroke="black" points="543.5,-10805.13 540,-10795.13 536.5,-10805.13 543.5,-10805.13"/>
</g>
<!-- layer10_input_stage1 -->
<g id="node164" class="node">
<title>layer10_input_stage1</title>
<polygon fill="lightyellow" stroke="black" points="839.74,-10707.09 362.92,-10707.09 240.26,-10603.09 717.08,-10603.09 839.74,-10707.09"/>
<text text-anchor="middle" x="540" y="-10669.09" font-family="Arial" font-size="10.00">Layer 10 Input</text>
<text text-anchor="middle" x="540" y="-10658.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-10647.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-10636.09" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer9_layernorm2_stage1&#45;&gt;layer10_input_stage1 -->
<g id="edge209" class="edge">
<title>layer9_layernorm2_stage1&#45;&gt;layer10_input_stage1</title>
<path fill="none" stroke="black" d="M540,-10742.95C540,-10735.27 540,-10726.45 540,-10717.45"/>
<polygon fill="black" stroke="black" points="543.5,-10717.26 540,-10707.26 536.5,-10717.26 543.5,-10717.26"/>
</g>
<!-- layer10_mha_query_stage1 -->
<g id="node165" class="node">
<title>layer10_mha_query_stage1</title>
<polygon fill="pink" stroke="black" points="311.5,-10567.09 20.5,-10567.09 20.5,-10515.09 311.5,-10515.09 311.5,-10567.09"/>
<text text-anchor="middle" x="166" y="-10555.09" font-family="Arial" font-size="10.00">Layer 10 MHA Query Linear</text>
<text text-anchor="middle" x="166" y="-10544.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="166" y="-10533.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_q=512]</text>
<text text-anchor="middle" x="166" y="-10522.09" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer10_input_stage1&#45;&gt;layer10_mha_query_stage1 -->
<g id="edge210" class="edge">
<title>layer10_input_stage1&#45;&gt;layer10_mha_query_stage1</title>
<path fill="none" stroke="black" d="M369.69,-10603.08C331.78,-10591.73 292.96,-10580.11 259.51,-10570.09"/>
<polygon fill="black" stroke="black" points="260.35,-10566.69 249.76,-10567.17 258.34,-10573.39 260.35,-10566.69"/>
</g>
<!-- layer10_mha_key_stage1 -->
<g id="node166" class="node">
<title>layer10_mha_key_stage1</title>
<polygon fill="pink" stroke="black" points="620.5,-10567.09 329.5,-10567.09 329.5,-10515.09 620.5,-10515.09 620.5,-10567.09"/>
<text text-anchor="middle" x="475" y="-10555.09" font-family="Arial" font-size="10.00">Layer 10 MHA Key Linear</text>
<text text-anchor="middle" x="475" y="-10544.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="475" y="-10533.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="475" y="-10522.09" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer10_input_stage1&#45;&gt;layer10_mha_key_stage1 -->
<g id="edge211" class="edge">
<title>layer10_input_stage1&#45;&gt;layer10_mha_key_stage1</title>
<path fill="none" stroke="black" d="M510.35,-10603C505.04,-10593.85 499.63,-10584.52 494.69,-10576.01"/>
<polygon fill="black" stroke="black" points="497.58,-10574.02 489.53,-10567.13 491.53,-10577.54 497.58,-10574.02"/>
</g>
<!-- layer10_mha_value_stage1 -->
<g id="node167" class="node">
<title>layer10_mha_value_stage1</title>
<polygon fill="pink" stroke="black" points="694.5,-10479.09 403.5,-10479.09 403.5,-10427.09 694.5,-10427.09 694.5,-10479.09"/>
<text text-anchor="middle" x="549" y="-10467.09" font-family="Arial" font-size="10.00">Layer 10 MHA Value Linear</text>
<text text-anchor="middle" x="549" y="-10456.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-10445.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_v=512]</text>
<text text-anchor="middle" x="549" y="-10434.09" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer10_input_stage1&#45;&gt;layer10_mha_value_stage1 -->
<g id="edge212" class="edge">
<title>layer10_input_stage1&#45;&gt;layer10_mha_value_stage1</title>
<path fill="none" stroke="black" d="M606.33,-10602.78C615.97,-10592.1 624.48,-10580.09 630,-10567.09 639.02,-10545.81 640.32,-10535.77 630,-10515.09 624.3,-10503.65 615.31,-10493.8 605.37,-10485.54"/>
<polygon fill="black" stroke="black" points="607.29,-10482.61 597.24,-10479.27 603.02,-10488.15 607.29,-10482.61"/>
</g>
<!-- layer10_residual1_stage1 -->
<g id="node173" class="node">
<title>layer10_residual1_stage1</title>
<polygon fill="lightblue" stroke="black" points="540,-10017.55 16,-9965.55 540,-9913.55 1064,-9965.55 540,-10017.55"/>
<text text-anchor="middle" x="540" y="-9979.55" font-family="Arial" font-size="10.00">Layer 10 Residual Add 1</text>
<text text-anchor="middle" x="540" y="-9968.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-9957.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-9946.55" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer10_input_stage1&#45;&gt;layer10_residual1_stage1 -->
<g id="edge221" class="edge">
<title>layer10_input_stage1&#45;&gt;layer10_residual1_stage1</title>
<path fill="none" stroke="black" d="M620.42,-10603.03C665.6,-10567.52 713,-10515.61 713,-10454.09 713,-10454.09 713,-10454.09 713,-10188.09 713,-10128.13 735.73,-10103.79 703,-10053.55 692.19,-10036.95 677.12,-10023.3 660.46,-10012.14"/>
<polygon fill="black" stroke="black" points="661.94,-10008.94 651.62,-10006.53 658.19,-10014.84 661.94,-10008.94"/>
</g>
<!-- layer10_mha_qkt_stage1 -->
<g id="node168" class="node">
<title>layer10_mha_qkt_stage1</title>
<polygon fill="lightcoral" stroke="black" points="385,-10479.09 65,-10479.09 65,-10427.09 385,-10427.09 385,-10479.09"/>
<text text-anchor="middle" x="225" y="-10467.09" font-family="Arial" font-size="10.00">Layer 10 MHA QKT Calculation</text>
<text text-anchor="middle" x="225" y="-10456.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="225" y="-10445.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="225" y="-10434.09" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer10_mha_query_stage1&#45;&gt;layer10_mha_qkt_stage1 -->
<g id="edge213" class="edge">
<title>layer10_mha_query_stage1&#45;&gt;layer10_mha_qkt_stage1</title>
<path fill="none" stroke="black" d="M183.38,-10514.75C189.2,-10506.26 195.79,-10496.67 201.97,-10487.65"/>
<polygon fill="black" stroke="black" points="204.97,-10489.47 207.74,-10479.24 199.2,-10485.51 204.97,-10489.47"/>
</g>
<!-- layer10_mha_key_stage1&#45;&gt;layer10_mha_qkt_stage1 -->
<g id="edge214" class="edge">
<title>layer10_mha_key_stage1&#45;&gt;layer10_mha_qkt_stage1</title>
<path fill="none" stroke="black" d="M402.02,-10514.98C372.5,-10504.83 338.26,-10493.05 307.82,-10482.58"/>
<polygon fill="black" stroke="black" points="308.67,-10479.17 298.07,-10479.22 306.39,-10485.79 308.67,-10479.17"/>
</g>
<!-- layer10_mha_apply_stage1 -->
<g id="node170" class="node">
<title>layer10_mha_apply_stage1</title>
<polygon fill="lightcoral" stroke="black" points="646,-10303.09 334,-10303.09 334,-10251.09 646,-10251.09 646,-10303.09"/>
<text text-anchor="middle" x="490" y="-10291.09" font-family="Arial" font-size="10.00">Layer 10 MHA Apply Attention</text>
<text text-anchor="middle" x="490" y="-10280.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="490" y="-10269.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="490" y="-10258.09" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer10_mha_value_stage1&#45;&gt;layer10_mha_apply_stage1 -->
<g id="edge217" class="edge">
<title>layer10_mha_value_stage1&#45;&gt;layer10_mha_apply_stage1</title>
<path fill="none" stroke="black" d="M540.42,-10426.79C530.25,-10396.8 513.26,-10346.68 501.84,-10313.01"/>
<polygon fill="black" stroke="black" points="505.02,-10311.48 498.49,-10303.14 498.39,-10313.73 505.02,-10311.48"/>
</g>
<!-- layer10_mha_weights_stage1 -->
<g id="node169" class="node">
<title>layer10_mha_weights_stage1</title>
<polygon fill="lightcoral" stroke="black" points="443,-10391.09 123,-10391.09 123,-10339.09 443,-10339.09 443,-10391.09"/>
<text text-anchor="middle" x="283" y="-10379.09" font-family="Arial" font-size="10.00">Layer 10 MHA Attention Weights</text>
<text text-anchor="middle" x="283" y="-10368.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="283" y="-10357.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="283" y="-10346.09" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer10_mha_qkt_stage1&#45;&gt;layer10_mha_weights_stage1 -->
<g id="edge215" class="edge">
<title>layer10_mha_qkt_stage1&#45;&gt;layer10_mha_weights_stage1</title>
<path fill="none" stroke="black" d="M242.09,-10426.75C247.81,-10418.26 254.28,-10408.67 260.36,-10399.65"/>
<polygon fill="black" stroke="black" points="263.34,-10401.49 266.03,-10391.24 257.54,-10397.58 263.34,-10401.49"/>
</g>
<!-- layer10_mha_weights_stage1&#45;&gt;layer10_mha_apply_stage1 -->
<g id="edge216" class="edge">
<title>layer10_mha_weights_stage1&#45;&gt;layer10_mha_apply_stage1</title>
<path fill="none" stroke="black" d="M343.43,-10338.98C367.45,-10329 395.24,-10317.46 420.12,-10307.12"/>
<polygon fill="black" stroke="black" points="421.6,-10310.29 429.5,-10303.22 418.92,-10303.83 421.6,-10310.29"/>
</g>
<!-- layer10_mha_out_stage1 -->
<g id="node171" class="node">
<title>layer10_mha_out_stage1</title>
<polygon fill="pink" stroke="black" points="634.5,-10215.09 345.5,-10215.09 345.5,-10163.09 634.5,-10163.09 634.5,-10215.09"/>
<text text-anchor="middle" x="490" y="-10203.09" font-family="Arial" font-size="10.00">Layer 10 MHA Output Linear</text>
<text text-anchor="middle" x="490" y="-10192.09" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="490" y="-10181.09" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-10170.09" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer10_mha_apply_stage1&#45;&gt;layer10_mha_out_stage1 -->
<g id="edge218" class="edge">
<title>layer10_mha_apply_stage1&#45;&gt;layer10_mha_out_stage1</title>
<path fill="none" stroke="black" d="M490,-10250.75C490,-10242.79 490,-10233.85 490,-10225.33"/>
<polygon fill="black" stroke="black" points="493.5,-10225.24 490,-10215.24 486.5,-10225.24 493.5,-10225.24"/>
</g>
<!-- layer10_mha_allreduce_stage1 -->
<g id="node172" class="node">
<title>layer10_mha_allreduce_stage1</title>
<ellipse fill="lightgray" stroke="black" cx="490" cy="-10090.32" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="490" y="-10104.32" font-family="Arial" font-size="10.00">Layer 10 MHA All&#45;reduce</text>
<text text-anchor="middle" x="490" y="-10093.32" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-10082.32" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-10071.32" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer10_mha_out_stage1&#45;&gt;layer10_mha_allreduce_stage1 -->
<g id="edge219" class="edge">
<title>layer10_mha_out_stage1&#45;&gt;layer10_mha_allreduce_stage1</title>
<path fill="none" stroke="black" d="M490,-10162.91C490,-10155.11 490,-10146.24 490,-10137.47"/>
<polygon fill="black" stroke="black" points="493.5,-10137.29 490,-10127.29 486.5,-10137.29 493.5,-10137.29"/>
</g>
<!-- layer10_mha_allreduce_stage1&#45;&gt;layer10_residual1_stage1 -->
<g id="edge220" class="edge">
<title>layer10_mha_allreduce_stage1&#45;&gt;layer10_residual1_stage1</title>
<path fill="none" stroke="black" d="M504.6,-10053.48C508.19,-10044.67 512.12,-10035 516.03,-10025.41"/>
<polygon fill="black" stroke="black" points="519.37,-10026.47 519.9,-10015.89 512.89,-10023.83 519.37,-10026.47"/>
</g>
<!-- layer10_layernorm1_stage1 -->
<g id="node174" class="node">
<title>layer10_layernorm1_stage1</title>
<polygon fill="lightgreen" stroke="black" points="684.5,-9877.55 395.5,-9877.55 395.5,-9825.55 684.5,-9825.55 684.5,-9877.55"/>
<text text-anchor="middle" x="540" y="-9865.55" font-family="Arial" font-size="10.00">Layer 10 Layer Norm 1</text>
<text text-anchor="middle" x="540" y="-9854.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-9843.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-9832.55" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer10_residual1_stage1&#45;&gt;layer10_layernorm1_stage1 -->
<g id="edge222" class="edge">
<title>layer10_residual1_stage1&#45;&gt;layer10_layernorm1_stage1</title>
<path fill="none" stroke="black" d="M540,-9913.46C540,-9904.8 540,-9895.98 540,-9887.83"/>
<polygon fill="black" stroke="black" points="543.5,-9887.59 540,-9877.59 536.5,-9887.59 543.5,-9887.59"/>
</g>
<!-- layer10_mlp_gate_stage1 -->
<g id="node175" class="node">
<title>layer10_mlp_gate_stage1</title>
<polygon fill="lightyellow" stroke="black" points="449.5,-9789.55 162.5,-9789.55 162.5,-9737.55 449.5,-9737.55 449.5,-9789.55"/>
<text text-anchor="middle" x="306" y="-9777.55" font-family="Arial" font-size="10.00">Layer 10 MLP Gate Linear</text>
<text text-anchor="middle" x="306" y="-9766.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="306" y="-9755.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="306" y="-9744.55" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer10_layernorm1_stage1&#45;&gt;layer10_mlp_gate_stage1 -->
<g id="edge223" class="edge">
<title>layer10_layernorm1_stage1&#45;&gt;layer10_mlp_gate_stage1</title>
<path fill="none" stroke="black" d="M471.69,-9825.44C444.18,-9815.33 412.29,-9803.61 383.89,-9793.17"/>
<polygon fill="black" stroke="black" points="384.99,-9789.85 374.4,-9789.68 382.58,-9796.42 384.99,-9789.85"/>
</g>
<!-- layer10_mlp_up_stage1 -->
<g id="node176" class="node">
<title>layer10_mlp_up_stage1</title>
<polygon fill="lightyellow" stroke="black" points="683.5,-9701.55 396.5,-9701.55 396.5,-9649.55 683.5,-9649.55 683.5,-9701.55"/>
<text text-anchor="middle" x="540" y="-9689.55" font-family="Arial" font-size="10.00">Layer 10 MLP Up Linear</text>
<text text-anchor="middle" x="540" y="-9678.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-9667.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="540" y="-9656.55" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer10_layernorm1_stage1&#45;&gt;layer10_mlp_up_stage1 -->
<g id="edge224" class="edge">
<title>layer10_layernorm1_stage1&#45;&gt;layer10_mlp_up_stage1</title>
<path fill="none" stroke="black" d="M540,-9825.25C540,-9795.39 540,-9745.57 540,-9711.91"/>
<polygon fill="black" stroke="black" points="543.5,-9711.6 540,-9701.6 536.5,-9711.6 543.5,-9711.6"/>
</g>
<!-- layer10_residual2_stage1 -->
<g id="node180" class="node">
<title>layer10_residual2_stage1</title>
<polygon fill="lightblue" stroke="black" points="540,-9416.01 16,-9364.01 540,-9312.01 1064,-9364.01 540,-9416.01"/>
<text text-anchor="middle" x="540" y="-9378.01" font-family="Arial" font-size="10.00">Layer 10 Residual Add 2</text>
<text text-anchor="middle" x="540" y="-9367.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-9356.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-9345.01" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer10_layernorm1_stage1&#45;&gt;layer10_residual2_stage1 -->
<g id="edge230" class="edge">
<title>layer10_layernorm1_stage1&#45;&gt;layer10_residual2_stage1</title>
<path fill="none" stroke="black" d="M588.46,-9825.32C636.51,-9796.43 703,-9744.22 703,-9676.55 703,-9676.55 703,-9676.55 703,-9586.55 703,-9526.59 725.05,-9502.68 693,-9452.01 682.85,-9435.95 668.6,-9422.57 652.85,-9411.5"/>
<polygon fill="black" stroke="black" points="654.75,-9408.56 644.49,-9405.92 650.87,-9414.38 654.75,-9408.56"/>
</g>
<!-- layer10_mlp_gelu_stage1 -->
<g id="node177" class="node">
<title>layer10_mlp_gelu_stage1</title>
<polygon fill="orange" stroke="black" points="378.5,-9701.55 91.5,-9701.55 91.5,-9649.55 378.5,-9649.55 378.5,-9701.55"/>
<text text-anchor="middle" x="235" y="-9689.55" font-family="Arial" font-size="10.00">Layer 10 MLP GELU</text>
<text text-anchor="middle" x="235" y="-9678.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="235" y="-9667.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="235" y="-9656.55" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer10_mlp_gate_stage1&#45;&gt;layer10_mlp_gelu_stage1 -->
<g id="edge225" class="edge">
<title>layer10_mlp_gate_stage1&#45;&gt;layer10_mlp_gelu_stage1</title>
<path fill="none" stroke="black" d="M285.08,-9737.21C277.93,-9728.55 269.83,-9718.73 262.25,-9709.56"/>
<polygon fill="black" stroke="black" points="264.83,-9707.19 255.77,-9701.7 259.44,-9711.64 264.83,-9707.19"/>
</g>
<!-- layer10_mlp_down_stage1 -->
<g id="node178" class="node">
<title>layer10_mlp_down_stage1</title>
<polygon fill="lightyellow" stroke="black" points="624.5,-9613.55 335.5,-9613.55 335.5,-9561.55 624.5,-9561.55 624.5,-9613.55"/>
<text text-anchor="middle" x="480" y="-9601.55" font-family="Arial" font-size="10.00">Layer 10 MLP Down Linear</text>
<text text-anchor="middle" x="480" y="-9590.55" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="480" y="-9579.55" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-9568.55" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer10_mlp_up_stage1&#45;&gt;layer10_mlp_down_stage1 -->
<g id="edge227" class="edge">
<title>layer10_mlp_up_stage1&#45;&gt;layer10_mlp_down_stage1</title>
<path fill="none" stroke="black" d="M522.32,-9649.21C516.4,-9640.72 509.71,-9631.13 503.42,-9622.11"/>
<polygon fill="black" stroke="black" points="506.14,-9619.9 497.55,-9613.7 500.4,-9623.91 506.14,-9619.9"/>
</g>
<!-- layer10_mlp_gelu_stage1&#45;&gt;layer10_mlp_down_stage1 -->
<g id="edge226" class="edge">
<title>layer10_mlp_gelu_stage1&#45;&gt;layer10_mlp_down_stage1</title>
<path fill="none" stroke="black" d="M306.52,-9649.44C335.45,-9639.29 369,-9627.51 398.84,-9617.04"/>
<polygon fill="black" stroke="black" points="400.11,-9620.3 408.39,-9613.68 397.79,-9613.69 400.11,-9620.3"/>
</g>
<!-- layer10_mlp_allreduce_stage1 -->
<g id="node179" class="node">
<title>layer10_mlp_allreduce_stage1</title>
<ellipse fill="lightgray" stroke="black" cx="480" cy="-9488.78" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="480" y="-9502.78" font-family="Arial" font-size="10.00">Layer 10 MLP All&#45;reduce</text>
<text text-anchor="middle" x="480" y="-9491.78" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-9480.78" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-9469.78" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer10_mlp_down_stage1&#45;&gt;layer10_mlp_allreduce_stage1 -->
<g id="edge228" class="edge">
<title>layer10_mlp_down_stage1&#45;&gt;layer10_mlp_allreduce_stage1</title>
<path fill="none" stroke="black" d="M480,-9561.38C480,-9553.57 480,-9544.7 480,-9535.93"/>
<polygon fill="black" stroke="black" points="483.5,-9535.75 480,-9525.75 476.5,-9535.75 483.5,-9535.75"/>
</g>
<!-- layer10_mlp_allreduce_stage1&#45;&gt;layer10_residual2_stage1 -->
<g id="edge229" class="edge">
<title>layer10_mlp_allreduce_stage1&#45;&gt;layer10_residual2_stage1</title>
<path fill="none" stroke="black" d="M497.52,-9451.94C501.96,-9442.83 506.86,-9432.82 511.7,-9422.92"/>
<polygon fill="black" stroke="black" points="514.86,-9424.42 516.11,-9413.9 508.57,-9421.35 514.86,-9424.42"/>
</g>
<!-- layer10_layernorm2_stage1 -->
<g id="node181" class="node">
<title>layer10_layernorm2_stage1</title>
<polygon fill="lightgreen" stroke="black" points="684.5,-9276.01 395.5,-9276.01 395.5,-9224.01 684.5,-9224.01 684.5,-9276.01"/>
<text text-anchor="middle" x="540" y="-9264.01" font-family="Arial" font-size="10.00">Layer 10 Layer Norm 2</text>
<text text-anchor="middle" x="540" y="-9253.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-9242.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-9231.01" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer10_residual2_stage1&#45;&gt;layer10_layernorm2_stage1 -->
<g id="edge231" class="edge">
<title>layer10_residual2_stage1&#45;&gt;layer10_layernorm2_stage1</title>
<path fill="none" stroke="black" d="M540,-9311.92C540,-9303.26 540,-9294.44 540,-9286.29"/>
<polygon fill="black" stroke="black" points="543.5,-9286.05 540,-9276.05 536.5,-9286.05 543.5,-9286.05"/>
</g>
<!-- layer11_input_stage1 -->
<g id="node182" class="node">
<title>layer11_input_stage1</title>
<polygon fill="lightyellow" stroke="black" points="839.74,-9188.01 362.92,-9188.01 240.26,-9084.01 717.08,-9084.01 839.74,-9188.01"/>
<text text-anchor="middle" x="540" y="-9150.01" font-family="Arial" font-size="10.00">Layer 11 Input</text>
<text text-anchor="middle" x="540" y="-9139.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-9128.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-9117.01" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer10_layernorm2_stage1&#45;&gt;layer11_input_stage1 -->
<g id="edge232" class="edge">
<title>layer10_layernorm2_stage1&#45;&gt;layer11_input_stage1</title>
<path fill="none" stroke="black" d="M540,-9223.87C540,-9216.19 540,-9207.38 540,-9198.38"/>
<polygon fill="black" stroke="black" points="543.5,-9198.19 540,-9188.19 536.5,-9198.19 543.5,-9198.19"/>
</g>
<!-- layer11_mha_query_stage1 -->
<g id="node183" class="node">
<title>layer11_mha_query_stage1</title>
<polygon fill="pink" stroke="black" points="311.5,-9048.01 20.5,-9048.01 20.5,-8996.01 311.5,-8996.01 311.5,-9048.01"/>
<text text-anchor="middle" x="166" y="-9036.01" font-family="Arial" font-size="10.00">Layer 11 MHA Query Linear</text>
<text text-anchor="middle" x="166" y="-9025.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="166" y="-9014.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_q=512]</text>
<text text-anchor="middle" x="166" y="-9003.01" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer11_input_stage1&#45;&gt;layer11_mha_query_stage1 -->
<g id="edge233" class="edge">
<title>layer11_input_stage1&#45;&gt;layer11_mha_query_stage1</title>
<path fill="none" stroke="black" d="M369.69,-9084.01C331.78,-9072.66 292.96,-9061.03 259.51,-9051.01"/>
<polygon fill="black" stroke="black" points="260.35,-9047.61 249.76,-9048.09 258.34,-9054.31 260.35,-9047.61"/>
</g>
<!-- layer11_mha_key_stage1 -->
<g id="node184" class="node">
<title>layer11_mha_key_stage1</title>
<polygon fill="pink" stroke="black" points="620.5,-9048.01 329.5,-9048.01 329.5,-8996.01 620.5,-8996.01 620.5,-9048.01"/>
<text text-anchor="middle" x="475" y="-9036.01" font-family="Arial" font-size="10.00">Layer 11 MHA Key Linear</text>
<text text-anchor="middle" x="475" y="-9025.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="475" y="-9014.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="475" y="-9003.01" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer11_input_stage1&#45;&gt;layer11_mha_key_stage1 -->
<g id="edge234" class="edge">
<title>layer11_input_stage1&#45;&gt;layer11_mha_key_stage1</title>
<path fill="none" stroke="black" d="M510.35,-9083.92C505.04,-9074.77 499.63,-9065.45 494.69,-9056.93"/>
<polygon fill="black" stroke="black" points="497.58,-9054.94 489.53,-9048.05 491.53,-9058.46 497.58,-9054.94"/>
</g>
<!-- layer11_mha_value_stage1 -->
<g id="node185" class="node">
<title>layer11_mha_value_stage1</title>
<polygon fill="pink" stroke="black" points="694.5,-8960.01 403.5,-8960.01 403.5,-8908.01 694.5,-8908.01 694.5,-8960.01"/>
<text text-anchor="middle" x="549" y="-8948.01" font-family="Arial" font-size="10.00">Layer 11 MHA Value Linear</text>
<text text-anchor="middle" x="549" y="-8937.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-8926.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_v=512]</text>
<text text-anchor="middle" x="549" y="-8915.01" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer11_input_stage1&#45;&gt;layer11_mha_value_stage1 -->
<g id="edge235" class="edge">
<title>layer11_input_stage1&#45;&gt;layer11_mha_value_stage1</title>
<path fill="none" stroke="black" d="M606.33,-9083.7C615.97,-9073.02 624.48,-9061.01 630,-9048.01 639.02,-9026.73 640.32,-9016.69 630,-8996.01 624.3,-8984.57 615.31,-8974.72 605.37,-8966.47"/>
<polygon fill="black" stroke="black" points="607.29,-8963.53 597.24,-8960.19 603.02,-8969.07 607.29,-8963.53"/>
</g>
<!-- layer11_residual1_stage1 -->
<g id="node191" class="node">
<title>layer11_residual1_stage1</title>
<polygon fill="lightblue" stroke="black" points="540,-8498.47 16,-8446.47 540,-8394.47 1064,-8446.47 540,-8498.47"/>
<text text-anchor="middle" x="540" y="-8460.47" font-family="Arial" font-size="10.00">Layer 11 Residual Add 1</text>
<text text-anchor="middle" x="540" y="-8449.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-8438.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-8427.47" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer11_input_stage1&#45;&gt;layer11_residual1_stage1 -->
<g id="edge244" class="edge">
<title>layer11_input_stage1&#45;&gt;layer11_residual1_stage1</title>
<path fill="none" stroke="black" d="M620.42,-9083.95C665.6,-9048.44 713,-8996.53 713,-8935.01 713,-8935.01 713,-8935.01 713,-8669.01 713,-8609.05 735.73,-8584.71 703,-8534.47 692.19,-8517.88 677.12,-8504.23 660.46,-8493.06"/>
<polygon fill="black" stroke="black" points="661.94,-8489.86 651.62,-8487.45 658.19,-8495.77 661.94,-8489.86"/>
</g>
<!-- layer11_mha_qkt_stage1 -->
<g id="node186" class="node">
<title>layer11_mha_qkt_stage1</title>
<polygon fill="lightcoral" stroke="black" points="385,-8960.01 65,-8960.01 65,-8908.01 385,-8908.01 385,-8960.01"/>
<text text-anchor="middle" x="225" y="-8948.01" font-family="Arial" font-size="10.00">Layer 11 MHA QKT Calculation</text>
<text text-anchor="middle" x="225" y="-8937.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="225" y="-8926.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="225" y="-8915.01" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer11_mha_query_stage1&#45;&gt;layer11_mha_qkt_stage1 -->
<g id="edge236" class="edge">
<title>layer11_mha_query_stage1&#45;&gt;layer11_mha_qkt_stage1</title>
<path fill="none" stroke="black" d="M183.38,-8995.67C189.2,-8987.19 195.79,-8977.59 201.97,-8968.57"/>
<polygon fill="black" stroke="black" points="204.97,-8970.39 207.74,-8960.16 199.2,-8966.43 204.97,-8970.39"/>
</g>
<!-- layer11_mha_key_stage1&#45;&gt;layer11_mha_qkt_stage1 -->
<g id="edge237" class="edge">
<title>layer11_mha_key_stage1&#45;&gt;layer11_mha_qkt_stage1</title>
<path fill="none" stroke="black" d="M402.02,-8995.9C372.5,-8985.75 338.26,-8973.97 307.82,-8963.5"/>
<polygon fill="black" stroke="black" points="308.67,-8960.09 298.07,-8960.15 306.39,-8966.71 308.67,-8960.09"/>
</g>
<!-- layer11_mha_apply_stage1 -->
<g id="node188" class="node">
<title>layer11_mha_apply_stage1</title>
<polygon fill="lightcoral" stroke="black" points="646,-8784.01 334,-8784.01 334,-8732.01 646,-8732.01 646,-8784.01"/>
<text text-anchor="middle" x="490" y="-8772.01" font-family="Arial" font-size="10.00">Layer 11 MHA Apply Attention</text>
<text text-anchor="middle" x="490" y="-8761.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="490" y="-8750.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="490" y="-8739.01" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer11_mha_value_stage1&#45;&gt;layer11_mha_apply_stage1 -->
<g id="edge240" class="edge">
<title>layer11_mha_value_stage1&#45;&gt;layer11_mha_apply_stage1</title>
<path fill="none" stroke="black" d="M540.42,-8907.71C530.25,-8877.73 513.26,-8827.6 501.84,-8793.94"/>
<polygon fill="black" stroke="black" points="505.02,-8792.4 498.49,-8784.06 498.39,-8794.65 505.02,-8792.4"/>
</g>
<!-- layer11_mha_weights_stage1 -->
<g id="node187" class="node">
<title>layer11_mha_weights_stage1</title>
<polygon fill="lightcoral" stroke="black" points="443,-8872.01 123,-8872.01 123,-8820.01 443,-8820.01 443,-8872.01"/>
<text text-anchor="middle" x="283" y="-8860.01" font-family="Arial" font-size="10.00">Layer 11 MHA Attention Weights</text>
<text text-anchor="middle" x="283" y="-8849.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="283" y="-8838.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="283" y="-8827.01" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer11_mha_qkt_stage1&#45;&gt;layer11_mha_weights_stage1 -->
<g id="edge238" class="edge">
<title>layer11_mha_qkt_stage1&#45;&gt;layer11_mha_weights_stage1</title>
<path fill="none" stroke="black" d="M242.09,-8907.67C247.81,-8899.19 254.28,-8889.59 260.36,-8880.57"/>
<polygon fill="black" stroke="black" points="263.34,-8882.41 266.03,-8872.16 257.54,-8878.5 263.34,-8882.41"/>
</g>
<!-- layer11_mha_weights_stage1&#45;&gt;layer11_mha_apply_stage1 -->
<g id="edge239" class="edge">
<title>layer11_mha_weights_stage1&#45;&gt;layer11_mha_apply_stage1</title>
<path fill="none" stroke="black" d="M343.43,-8819.9C367.45,-8809.92 395.24,-8798.38 420.12,-8788.04"/>
<polygon fill="black" stroke="black" points="421.6,-8791.21 429.5,-8784.15 418.92,-8784.75 421.6,-8791.21"/>
</g>
<!-- layer11_mha_out_stage1 -->
<g id="node189" class="node">
<title>layer11_mha_out_stage1</title>
<polygon fill="pink" stroke="black" points="634.5,-8696.01 345.5,-8696.01 345.5,-8644.01 634.5,-8644.01 634.5,-8696.01"/>
<text text-anchor="middle" x="490" y="-8684.01" font-family="Arial" font-size="10.00">Layer 11 MHA Output Linear</text>
<text text-anchor="middle" x="490" y="-8673.01" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="490" y="-8662.01" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-8651.01" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer11_mha_apply_stage1&#45;&gt;layer11_mha_out_stage1 -->
<g id="edge241" class="edge">
<title>layer11_mha_apply_stage1&#45;&gt;layer11_mha_out_stage1</title>
<path fill="none" stroke="black" d="M490,-8731.67C490,-8723.71 490,-8714.77 490,-8706.25"/>
<polygon fill="black" stroke="black" points="493.5,-8706.16 490,-8696.16 486.5,-8706.16 493.5,-8706.16"/>
</g>
<!-- layer11_mha_allreduce_stage1 -->
<g id="node190" class="node">
<title>layer11_mha_allreduce_stage1</title>
<ellipse fill="lightgray" stroke="black" cx="490" cy="-8571.24" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="490" y="-8585.24" font-family="Arial" font-size="10.00">Layer 11 MHA All&#45;reduce</text>
<text text-anchor="middle" x="490" y="-8574.24" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-8563.24" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-8552.24" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer11_mha_out_stage1&#45;&gt;layer11_mha_allreduce_stage1 -->
<g id="edge242" class="edge">
<title>layer11_mha_out_stage1&#45;&gt;layer11_mha_allreduce_stage1</title>
<path fill="none" stroke="black" d="M490,-8643.84C490,-8636.03 490,-8627.16 490,-8618.39"/>
<polygon fill="black" stroke="black" points="493.5,-8618.22 490,-8608.22 486.5,-8618.22 493.5,-8618.22"/>
</g>
<!-- layer11_mha_allreduce_stage1&#45;&gt;layer11_residual1_stage1 -->
<g id="edge243" class="edge">
<title>layer11_mha_allreduce_stage1&#45;&gt;layer11_residual1_stage1</title>
<path fill="none" stroke="black" d="M504.6,-8534.4C508.19,-8525.59 512.12,-8515.92 516.03,-8506.34"/>
<polygon fill="black" stroke="black" points="519.37,-8507.4 519.9,-8496.81 512.89,-8504.76 519.37,-8507.4"/>
</g>
<!-- layer11_layernorm1_stage1 -->
<g id="node192" class="node">
<title>layer11_layernorm1_stage1</title>
<polygon fill="lightgreen" stroke="black" points="684.5,-8358.47 395.5,-8358.47 395.5,-8306.47 684.5,-8306.47 684.5,-8358.47"/>
<text text-anchor="middle" x="540" y="-8346.47" font-family="Arial" font-size="10.00">Layer 11 Layer Norm 1</text>
<text text-anchor="middle" x="540" y="-8335.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-8324.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-8313.47" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer11_residual1_stage1&#45;&gt;layer11_layernorm1_stage1 -->
<g id="edge245" class="edge">
<title>layer11_residual1_stage1&#45;&gt;layer11_layernorm1_stage1</title>
<path fill="none" stroke="black" d="M540,-8394.39C540,-8385.72 540,-8376.9 540,-8368.75"/>
<polygon fill="black" stroke="black" points="543.5,-8368.51 540,-8358.51 536.5,-8368.51 543.5,-8368.51"/>
</g>
<!-- layer11_mlp_gate_stage1 -->
<g id="node193" class="node">
<title>layer11_mlp_gate_stage1</title>
<polygon fill="lightyellow" stroke="black" points="449.5,-8270.47 162.5,-8270.47 162.5,-8218.47 449.5,-8218.47 449.5,-8270.47"/>
<text text-anchor="middle" x="306" y="-8258.47" font-family="Arial" font-size="10.00">Layer 11 MLP Gate Linear</text>
<text text-anchor="middle" x="306" y="-8247.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="306" y="-8236.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="306" y="-8225.47" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer11_layernorm1_stage1&#45;&gt;layer11_mlp_gate_stage1 -->
<g id="edge246" class="edge">
<title>layer11_layernorm1_stage1&#45;&gt;layer11_mlp_gate_stage1</title>
<path fill="none" stroke="black" d="M471.69,-8306.36C444.18,-8296.25 412.29,-8284.53 383.89,-8274.09"/>
<polygon fill="black" stroke="black" points="384.99,-8270.77 374.4,-8270.61 382.58,-8277.34 384.99,-8270.77"/>
</g>
<!-- layer11_mlp_up_stage1 -->
<g id="node194" class="node">
<title>layer11_mlp_up_stage1</title>
<polygon fill="lightyellow" stroke="black" points="683.5,-8182.47 396.5,-8182.47 396.5,-8130.47 683.5,-8130.47 683.5,-8182.47"/>
<text text-anchor="middle" x="540" y="-8170.47" font-family="Arial" font-size="10.00">Layer 11 MLP Up Linear</text>
<text text-anchor="middle" x="540" y="-8159.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-8148.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="540" y="-8137.47" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer11_layernorm1_stage1&#45;&gt;layer11_mlp_up_stage1 -->
<g id="edge247" class="edge">
<title>layer11_layernorm1_stage1&#45;&gt;layer11_mlp_up_stage1</title>
<path fill="none" stroke="black" d="M540,-8306.17C540,-8276.32 540,-8226.49 540,-8192.83"/>
<polygon fill="black" stroke="black" points="543.5,-8192.52 540,-8182.52 536.5,-8192.52 543.5,-8192.52"/>
</g>
<!-- layer11_residual2_stage1 -->
<g id="node198" class="node">
<title>layer11_residual2_stage1</title>
<polygon fill="lightblue" stroke="black" points="540,-7896.93 16,-7844.93 540,-7792.93 1064,-7844.93 540,-7896.93"/>
<text text-anchor="middle" x="540" y="-7858.93" font-family="Arial" font-size="10.00">Layer 11 Residual Add 2</text>
<text text-anchor="middle" x="540" y="-7847.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-7836.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-7825.93" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer11_layernorm1_stage1&#45;&gt;layer11_residual2_stage1 -->
<g id="edge253" class="edge">
<title>layer11_layernorm1_stage1&#45;&gt;layer11_residual2_stage1</title>
<path fill="none" stroke="black" d="M588.46,-8306.24C636.51,-8277.35 703,-8225.15 703,-8157.47 703,-8157.47 703,-8157.47 703,-8067.47 703,-8007.51 725.05,-7983.6 693,-7932.93 682.85,-7916.88 668.6,-7903.49 652.85,-7892.42"/>
<polygon fill="black" stroke="black" points="654.75,-7889.48 644.49,-7886.84 650.87,-7895.3 654.75,-7889.48"/>
</g>
<!-- layer11_mlp_gelu_stage1 -->
<g id="node195" class="node">
<title>layer11_mlp_gelu_stage1</title>
<polygon fill="orange" stroke="black" points="378.5,-8182.47 91.5,-8182.47 91.5,-8130.47 378.5,-8130.47 378.5,-8182.47"/>
<text text-anchor="middle" x="235" y="-8170.47" font-family="Arial" font-size="10.00">Layer 11 MLP GELU</text>
<text text-anchor="middle" x="235" y="-8159.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="235" y="-8148.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="235" y="-8137.47" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer11_mlp_gate_stage1&#45;&gt;layer11_mlp_gelu_stage1 -->
<g id="edge248" class="edge">
<title>layer11_mlp_gate_stage1&#45;&gt;layer11_mlp_gelu_stage1</title>
<path fill="none" stroke="black" d="M285.08,-8218.13C277.93,-8209.47 269.83,-8199.65 262.25,-8190.48"/>
<polygon fill="black" stroke="black" points="264.83,-8188.11 255.77,-8182.63 259.44,-8192.57 264.83,-8188.11"/>
</g>
<!-- layer11_mlp_down_stage1 -->
<g id="node196" class="node">
<title>layer11_mlp_down_stage1</title>
<polygon fill="lightyellow" stroke="black" points="624.5,-8094.47 335.5,-8094.47 335.5,-8042.47 624.5,-8042.47 624.5,-8094.47"/>
<text text-anchor="middle" x="480" y="-8082.47" font-family="Arial" font-size="10.00">Layer 11 MLP Down Linear</text>
<text text-anchor="middle" x="480" y="-8071.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="480" y="-8060.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-8049.47" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer11_mlp_up_stage1&#45;&gt;layer11_mlp_down_stage1 -->
<g id="edge250" class="edge">
<title>layer11_mlp_up_stage1&#45;&gt;layer11_mlp_down_stage1</title>
<path fill="none" stroke="black" d="M522.32,-8130.13C516.4,-8121.65 509.71,-8112.05 503.42,-8103.04"/>
<polygon fill="black" stroke="black" points="506.14,-8100.82 497.55,-8094.63 500.4,-8104.83 506.14,-8100.82"/>
</g>
<!-- layer11_mlp_gelu_stage1&#45;&gt;layer11_mlp_down_stage1 -->
<g id="edge249" class="edge">
<title>layer11_mlp_gelu_stage1&#45;&gt;layer11_mlp_down_stage1</title>
<path fill="none" stroke="black" d="M306.52,-8130.36C335.45,-8120.21 369,-8108.43 398.84,-8097.96"/>
<polygon fill="black" stroke="black" points="400.11,-8101.22 408.39,-8094.61 397.79,-8094.62 400.11,-8101.22"/>
</g>
<!-- layer11_mlp_allreduce_stage1 -->
<g id="node197" class="node">
<title>layer11_mlp_allreduce_stage1</title>
<ellipse fill="lightgray" stroke="black" cx="480" cy="-7969.7" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="480" y="-7983.7" font-family="Arial" font-size="10.00">Layer 11 MLP All&#45;reduce</text>
<text text-anchor="middle" x="480" y="-7972.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-7961.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-7950.7" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer11_mlp_down_stage1&#45;&gt;layer11_mlp_allreduce_stage1 -->
<g id="edge251" class="edge">
<title>layer11_mlp_down_stage1&#45;&gt;layer11_mlp_allreduce_stage1</title>
<path fill="none" stroke="black" d="M480,-8042.3C480,-8034.49 480,-8025.62 480,-8016.85"/>
<polygon fill="black" stroke="black" points="483.5,-8016.68 480,-8006.68 476.5,-8016.68 483.5,-8016.68"/>
</g>
<!-- layer11_mlp_allreduce_stage1&#45;&gt;layer11_residual2_stage1 -->
<g id="edge252" class="edge">
<title>layer11_mlp_allreduce_stage1&#45;&gt;layer11_residual2_stage1</title>
<path fill="none" stroke="black" d="M497.52,-7932.86C501.96,-7923.76 506.86,-7913.74 511.7,-7903.85"/>
<polygon fill="black" stroke="black" points="514.86,-7905.34 516.11,-7894.82 508.57,-7902.27 514.86,-7905.34"/>
</g>
<!-- layer11_layernorm2_stage1 -->
<g id="node199" class="node">
<title>layer11_layernorm2_stage1</title>
<polygon fill="lightgreen" stroke="black" points="684.5,-7756.93 395.5,-7756.93 395.5,-7704.93 684.5,-7704.93 684.5,-7756.93"/>
<text text-anchor="middle" x="540" y="-7744.93" font-family="Arial" font-size="10.00">Layer 11 Layer Norm 2</text>
<text text-anchor="middle" x="540" y="-7733.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-7722.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-7711.93" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer11_residual2_stage1&#45;&gt;layer11_layernorm2_stage1 -->
<g id="edge254" class="edge">
<title>layer11_residual2_stage1&#45;&gt;layer11_layernorm2_stage1</title>
<path fill="none" stroke="black" d="M540,-7792.85C540,-7784.18 540,-7775.36 540,-7767.22"/>
<polygon fill="black" stroke="black" points="543.5,-7766.97 540,-7756.97 536.5,-7766.97 543.5,-7766.97"/>
</g>
<!-- layer12_input_stage1 -->
<g id="node200" class="node">
<title>layer12_input_stage1</title>
<polygon fill="lightyellow" stroke="black" points="839.74,-7668.93 362.92,-7668.93 240.26,-7564.93 717.08,-7564.93 839.74,-7668.93"/>
<text text-anchor="middle" x="540" y="-7630.93" font-family="Arial" font-size="10.00">Layer 12 Input</text>
<text text-anchor="middle" x="540" y="-7619.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-7608.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-7597.93" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer11_layernorm2_stage1&#45;&gt;layer12_input_stage1 -->
<g id="edge255" class="edge">
<title>layer11_layernorm2_stage1&#45;&gt;layer12_input_stage1</title>
<path fill="none" stroke="black" d="M540,-7704.8C540,-7697.11 540,-7688.3 540,-7679.3"/>
<polygon fill="black" stroke="black" points="543.5,-7679.11 540,-7669.11 536.5,-7679.11 543.5,-7679.11"/>
</g>
<!-- layer12_mha_query_stage1 -->
<g id="node201" class="node">
<title>layer12_mha_query_stage1</title>
<polygon fill="pink" stroke="black" points="311.5,-7528.93 20.5,-7528.93 20.5,-7476.93 311.5,-7476.93 311.5,-7528.93"/>
<text text-anchor="middle" x="166" y="-7516.93" font-family="Arial" font-size="10.00">Layer 12 MHA Query Linear</text>
<text text-anchor="middle" x="166" y="-7505.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="166" y="-7494.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_q=512]</text>
<text text-anchor="middle" x="166" y="-7483.93" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer12_input_stage1&#45;&gt;layer12_mha_query_stage1 -->
<g id="edge256" class="edge">
<title>layer12_input_stage1&#45;&gt;layer12_mha_query_stage1</title>
<path fill="none" stroke="black" d="M369.69,-7564.93C331.78,-7553.58 292.96,-7541.95 259.51,-7531.93"/>
<polygon fill="black" stroke="black" points="260.35,-7528.53 249.76,-7529.01 258.34,-7535.24 260.35,-7528.53"/>
</g>
<!-- layer12_mha_key_stage1 -->
<g id="node202" class="node">
<title>layer12_mha_key_stage1</title>
<polygon fill="pink" stroke="black" points="620.5,-7528.93 329.5,-7528.93 329.5,-7476.93 620.5,-7476.93 620.5,-7528.93"/>
<text text-anchor="middle" x="475" y="-7516.93" font-family="Arial" font-size="10.00">Layer 12 MHA Key Linear</text>
<text text-anchor="middle" x="475" y="-7505.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="475" y="-7494.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="475" y="-7483.93" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer12_input_stage1&#45;&gt;layer12_mha_key_stage1 -->
<g id="edge257" class="edge">
<title>layer12_input_stage1&#45;&gt;layer12_mha_key_stage1</title>
<path fill="none" stroke="black" d="M510.35,-7564.85C505.04,-7555.69 499.63,-7546.37 494.69,-7537.85"/>
<polygon fill="black" stroke="black" points="497.58,-7535.87 489.53,-7528.97 491.53,-7539.38 497.58,-7535.87"/>
</g>
<!-- layer12_mha_value_stage1 -->
<g id="node203" class="node">
<title>layer12_mha_value_stage1</title>
<polygon fill="pink" stroke="black" points="694.5,-7440.93 403.5,-7440.93 403.5,-7388.93 694.5,-7388.93 694.5,-7440.93"/>
<text text-anchor="middle" x="549" y="-7428.93" font-family="Arial" font-size="10.00">Layer 12 MHA Value Linear</text>
<text text-anchor="middle" x="549" y="-7417.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-7406.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_v=512]</text>
<text text-anchor="middle" x="549" y="-7395.93" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer12_input_stage1&#45;&gt;layer12_mha_value_stage1 -->
<g id="edge258" class="edge">
<title>layer12_input_stage1&#45;&gt;layer12_mha_value_stage1</title>
<path fill="none" stroke="black" d="M606.33,-7564.62C615.97,-7553.94 624.48,-7541.93 630,-7528.93 639.02,-7507.65 640.32,-7497.61 630,-7476.93 624.3,-7465.49 615.31,-7455.64 605.37,-7447.39"/>
<polygon fill="black" stroke="black" points="607.29,-7444.45 597.24,-7441.11 603.02,-7449.99 607.29,-7444.45"/>
</g>
<!-- layer12_residual1_stage1 -->
<g id="node209" class="node">
<title>layer12_residual1_stage1</title>
<polygon fill="lightblue" stroke="black" points="540,-6979.39 16,-6927.39 540,-6875.39 1064,-6927.39 540,-6979.39"/>
<text text-anchor="middle" x="540" y="-6941.39" font-family="Arial" font-size="10.00">Layer 12 Residual Add 1</text>
<text text-anchor="middle" x="540" y="-6930.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-6919.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-6908.39" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer12_input_stage1&#45;&gt;layer12_residual1_stage1 -->
<g id="edge267" class="edge">
<title>layer12_input_stage1&#45;&gt;layer12_residual1_stage1</title>
<path fill="none" stroke="black" d="M620.42,-7564.87C665.6,-7529.36 713,-7477.45 713,-7415.93 713,-7415.93 713,-7415.93 713,-7149.93 713,-7089.97 735.73,-7065.63 703,-7015.39 692.19,-6998.8 677.12,-6985.15 660.46,-6973.99"/>
<polygon fill="black" stroke="black" points="661.94,-6970.78 651.62,-6968.37 658.19,-6976.69 661.94,-6970.78"/>
</g>
<!-- layer12_mha_qkt_stage1 -->
<g id="node204" class="node">
<title>layer12_mha_qkt_stage1</title>
<polygon fill="lightcoral" stroke="black" points="385,-7440.93 65,-7440.93 65,-7388.93 385,-7388.93 385,-7440.93"/>
<text text-anchor="middle" x="225" y="-7428.93" font-family="Arial" font-size="10.00">Layer 12 MHA QKT Calculation</text>
<text text-anchor="middle" x="225" y="-7417.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="225" y="-7406.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="225" y="-7395.93" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer12_mha_query_stage1&#45;&gt;layer12_mha_qkt_stage1 -->
<g id="edge259" class="edge">
<title>layer12_mha_query_stage1&#45;&gt;layer12_mha_qkt_stage1</title>
<path fill="none" stroke="black" d="M183.38,-7476.59C189.2,-7468.11 195.79,-7458.51 201.97,-7449.5"/>
<polygon fill="black" stroke="black" points="204.97,-7451.31 207.74,-7441.09 199.2,-7447.35 204.97,-7451.31"/>
</g>
<!-- layer12_mha_key_stage1&#45;&gt;layer12_mha_qkt_stage1 -->
<g id="edge260" class="edge">
<title>layer12_mha_key_stage1&#45;&gt;layer12_mha_qkt_stage1</title>
<path fill="none" stroke="black" d="M402.02,-7476.82C372.5,-7466.67 338.26,-7454.89 307.82,-7444.42"/>
<polygon fill="black" stroke="black" points="308.67,-7441.01 298.07,-7441.07 306.39,-7447.63 308.67,-7441.01"/>
</g>
<!-- layer12_mha_apply_stage1 -->
<g id="node206" class="node">
<title>layer12_mha_apply_stage1</title>
<polygon fill="lightcoral" stroke="black" points="646,-7264.93 334,-7264.93 334,-7212.93 646,-7212.93 646,-7264.93"/>
<text text-anchor="middle" x="490" y="-7252.93" font-family="Arial" font-size="10.00">Layer 12 MHA Apply Attention</text>
<text text-anchor="middle" x="490" y="-7241.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="490" y="-7230.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="490" y="-7219.93" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer12_mha_value_stage1&#45;&gt;layer12_mha_apply_stage1 -->
<g id="edge263" class="edge">
<title>layer12_mha_value_stage1&#45;&gt;layer12_mha_apply_stage1</title>
<path fill="none" stroke="black" d="M540.42,-7388.63C530.25,-7358.65 513.26,-7308.52 501.84,-7274.86"/>
<polygon fill="black" stroke="black" points="505.02,-7273.33 498.49,-7264.98 498.39,-7275.57 505.02,-7273.33"/>
</g>
<!-- layer12_mha_weights_stage1 -->
<g id="node205" class="node">
<title>layer12_mha_weights_stage1</title>
<polygon fill="lightcoral" stroke="black" points="443,-7352.93 123,-7352.93 123,-7300.93 443,-7300.93 443,-7352.93"/>
<text text-anchor="middle" x="283" y="-7340.93" font-family="Arial" font-size="10.00">Layer 12 MHA Attention Weights</text>
<text text-anchor="middle" x="283" y="-7329.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="283" y="-7318.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="283" y="-7307.93" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer12_mha_qkt_stage1&#45;&gt;layer12_mha_weights_stage1 -->
<g id="edge261" class="edge">
<title>layer12_mha_qkt_stage1&#45;&gt;layer12_mha_weights_stage1</title>
<path fill="none" stroke="black" d="M242.09,-7388.59C247.81,-7380.11 254.28,-7370.51 260.36,-7361.5"/>
<polygon fill="black" stroke="black" points="263.34,-7363.33 266.03,-7353.09 257.54,-7359.42 263.34,-7363.33"/>
</g>
<!-- layer12_mha_weights_stage1&#45;&gt;layer12_mha_apply_stage1 -->
<g id="edge262" class="edge">
<title>layer12_mha_weights_stage1&#45;&gt;layer12_mha_apply_stage1</title>
<path fill="none" stroke="black" d="M343.43,-7300.82C367.45,-7290.84 395.24,-7279.3 420.12,-7268.96"/>
<polygon fill="black" stroke="black" points="421.6,-7272.14 429.5,-7265.07 418.92,-7265.67 421.6,-7272.14"/>
</g>
<!-- layer12_mha_out_stage1 -->
<g id="node207" class="node">
<title>layer12_mha_out_stage1</title>
<polygon fill="pink" stroke="black" points="634.5,-7176.93 345.5,-7176.93 345.5,-7124.93 634.5,-7124.93 634.5,-7176.93"/>
<text text-anchor="middle" x="490" y="-7164.93" font-family="Arial" font-size="10.00">Layer 12 MHA Output Linear</text>
<text text-anchor="middle" x="490" y="-7153.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="490" y="-7142.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-7131.93" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer12_mha_apply_stage1&#45;&gt;layer12_mha_out_stage1 -->
<g id="edge264" class="edge">
<title>layer12_mha_apply_stage1&#45;&gt;layer12_mha_out_stage1</title>
<path fill="none" stroke="black" d="M490,-7212.59C490,-7204.63 490,-7195.69 490,-7187.18"/>
<polygon fill="black" stroke="black" points="493.5,-7187.09 490,-7177.09 486.5,-7187.09 493.5,-7187.09"/>
</g>
<!-- layer12_mha_allreduce_stage1 -->
<g id="node208" class="node">
<title>layer12_mha_allreduce_stage1</title>
<ellipse fill="lightgray" stroke="black" cx="490" cy="-7052.16" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="490" y="-7066.16" font-family="Arial" font-size="10.00">Layer 12 MHA All&#45;reduce</text>
<text text-anchor="middle" x="490" y="-7055.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-7044.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-7033.16" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer12_mha_out_stage1&#45;&gt;layer12_mha_allreduce_stage1 -->
<g id="edge265" class="edge">
<title>layer12_mha_out_stage1&#45;&gt;layer12_mha_allreduce_stage1</title>
<path fill="none" stroke="black" d="M490,-7124.76C490,-7116.95 490,-7108.08 490,-7099.32"/>
<polygon fill="black" stroke="black" points="493.5,-7099.14 490,-7089.14 486.5,-7099.14 493.5,-7099.14"/>
</g>
<!-- layer12_mha_allreduce_stage1&#45;&gt;layer12_residual1_stage1 -->
<g id="edge266" class="edge">
<title>layer12_mha_allreduce_stage1&#45;&gt;layer12_residual1_stage1</title>
<path fill="none" stroke="black" d="M504.6,-7015.32C508.19,-7006.51 512.12,-6996.84 516.03,-6987.26"/>
<polygon fill="black" stroke="black" points="519.37,-6988.32 519.9,-6977.74 512.89,-6985.68 519.37,-6988.32"/>
</g>
<!-- layer12_layernorm1_stage1 -->
<g id="node210" class="node">
<title>layer12_layernorm1_stage1</title>
<polygon fill="lightgreen" stroke="black" points="684.5,-6839.39 395.5,-6839.39 395.5,-6787.39 684.5,-6787.39 684.5,-6839.39"/>
<text text-anchor="middle" x="540" y="-6827.39" font-family="Arial" font-size="10.00">Layer 12 Layer Norm 1</text>
<text text-anchor="middle" x="540" y="-6816.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-6805.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-6794.39" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer12_residual1_stage1&#45;&gt;layer12_layernorm1_stage1 -->
<g id="edge268" class="edge">
<title>layer12_residual1_stage1&#45;&gt;layer12_layernorm1_stage1</title>
<path fill="none" stroke="black" d="M540,-6875.31C540,-6866.64 540,-6857.82 540,-6849.68"/>
<polygon fill="black" stroke="black" points="543.5,-6849.43 540,-6839.43 536.5,-6849.43 543.5,-6849.43"/>
</g>
<!-- layer12_mlp_gate_stage1 -->
<g id="node211" class="node">
<title>layer12_mlp_gate_stage1</title>
<polygon fill="lightyellow" stroke="black" points="449.5,-6751.39 162.5,-6751.39 162.5,-6699.39 449.5,-6699.39 449.5,-6751.39"/>
<text text-anchor="middle" x="306" y="-6739.39" font-family="Arial" font-size="10.00">Layer 12 MLP Gate Linear</text>
<text text-anchor="middle" x="306" y="-6728.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="306" y="-6717.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="306" y="-6706.39" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer12_layernorm1_stage1&#45;&gt;layer12_mlp_gate_stage1 -->
<g id="edge269" class="edge">
<title>layer12_layernorm1_stage1&#45;&gt;layer12_mlp_gate_stage1</title>
<path fill="none" stroke="black" d="M471.69,-6787.29C444.18,-6777.17 412.29,-6765.46 383.89,-6755.02"/>
<polygon fill="black" stroke="black" points="384.99,-6751.69 374.4,-6751.53 382.58,-6758.26 384.99,-6751.69"/>
</g>
<!-- layer12_mlp_up_stage1 -->
<g id="node212" class="node">
<title>layer12_mlp_up_stage1</title>
<polygon fill="lightyellow" stroke="black" points="683.5,-6663.39 396.5,-6663.39 396.5,-6611.39 683.5,-6611.39 683.5,-6663.39"/>
<text text-anchor="middle" x="540" y="-6651.39" font-family="Arial" font-size="10.00">Layer 12 MLP Up Linear</text>
<text text-anchor="middle" x="540" y="-6640.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-6629.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="540" y="-6618.39" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer12_layernorm1_stage1&#45;&gt;layer12_mlp_up_stage1 -->
<g id="edge270" class="edge">
<title>layer12_layernorm1_stage1&#45;&gt;layer12_mlp_up_stage1</title>
<path fill="none" stroke="black" d="M540,-6787.09C540,-6757.24 540,-6707.42 540,-6673.76"/>
<polygon fill="black" stroke="black" points="543.5,-6673.44 540,-6663.44 536.5,-6673.44 543.5,-6673.44"/>
</g>
<!-- layer12_residual2_stage1 -->
<g id="node216" class="node">
<title>layer12_residual2_stage1</title>
<polygon fill="lightblue" stroke="black" points="540,-6377.85 16,-6325.85 540,-6273.85 1064,-6325.85 540,-6377.85"/>
<text text-anchor="middle" x="540" y="-6339.85" font-family="Arial" font-size="10.00">Layer 12 Residual Add 2</text>
<text text-anchor="middle" x="540" y="-6328.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-6317.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-6306.85" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer12_layernorm1_stage1&#45;&gt;layer12_residual2_stage1 -->
<g id="edge276" class="edge">
<title>layer12_layernorm1_stage1&#45;&gt;layer12_residual2_stage1</title>
<path fill="none" stroke="black" d="M588.46,-6787.16C636.51,-6758.27 703,-6706.07 703,-6638.39 703,-6638.39 703,-6638.39 703,-6548.39 703,-6488.43 725.05,-6464.53 693,-6413.85 682.85,-6397.8 668.6,-6384.41 652.85,-6373.34"/>
<polygon fill="black" stroke="black" points="654.75,-6370.4 644.49,-6367.76 650.87,-6376.23 654.75,-6370.4"/>
</g>
<!-- layer12_mlp_gelu_stage1 -->
<g id="node213" class="node">
<title>layer12_mlp_gelu_stage1</title>
<polygon fill="orange" stroke="black" points="378.5,-6663.39 91.5,-6663.39 91.5,-6611.39 378.5,-6611.39 378.5,-6663.39"/>
<text text-anchor="middle" x="235" y="-6651.39" font-family="Arial" font-size="10.00">Layer 12 MLP GELU</text>
<text text-anchor="middle" x="235" y="-6640.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="235" y="-6629.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="235" y="-6618.39" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer12_mlp_gate_stage1&#45;&gt;layer12_mlp_gelu_stage1 -->
<g id="edge271" class="edge">
<title>layer12_mlp_gate_stage1&#45;&gt;layer12_mlp_gelu_stage1</title>
<path fill="none" stroke="black" d="M285.08,-6699.05C277.93,-6690.39 269.83,-6680.58 262.25,-6671.4"/>
<polygon fill="black" stroke="black" points="264.83,-6669.03 255.77,-6663.55 259.44,-6673.49 264.83,-6669.03"/>
</g>
<!-- layer12_mlp_down_stage1 -->
<g id="node214" class="node">
<title>layer12_mlp_down_stage1</title>
<polygon fill="lightyellow" stroke="black" points="624.5,-6575.39 335.5,-6575.39 335.5,-6523.39 624.5,-6523.39 624.5,-6575.39"/>
<text text-anchor="middle" x="480" y="-6563.39" font-family="Arial" font-size="10.00">Layer 12 MLP Down Linear</text>
<text text-anchor="middle" x="480" y="-6552.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="480" y="-6541.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-6530.39" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer12_mlp_up_stage1&#45;&gt;layer12_mlp_down_stage1 -->
<g id="edge273" class="edge">
<title>layer12_mlp_up_stage1&#45;&gt;layer12_mlp_down_stage1</title>
<path fill="none" stroke="black" d="M522.32,-6611.05C516.4,-6602.57 509.71,-6592.97 503.42,-6583.96"/>
<polygon fill="black" stroke="black" points="506.14,-6581.75 497.55,-6575.55 500.4,-6585.75 506.14,-6581.75"/>
</g>
<!-- layer12_mlp_gelu_stage1&#45;&gt;layer12_mlp_down_stage1 -->
<g id="edge272" class="edge">
<title>layer12_mlp_gelu_stage1&#45;&gt;layer12_mlp_down_stage1</title>
<path fill="none" stroke="black" d="M306.52,-6611.29C335.45,-6601.13 369,-6589.35 398.84,-6578.88"/>
<polygon fill="black" stroke="black" points="400.11,-6582.14 408.39,-6575.53 397.79,-6575.54 400.11,-6582.14"/>
</g>
<!-- layer12_mlp_allreduce_stage1 -->
<g id="node215" class="node">
<title>layer12_mlp_allreduce_stage1</title>
<ellipse fill="lightgray" stroke="black" cx="480" cy="-6450.62" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="480" y="-6464.62" font-family="Arial" font-size="10.00">Layer 12 MLP All&#45;reduce</text>
<text text-anchor="middle" x="480" y="-6453.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-6442.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-6431.62" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer12_mlp_down_stage1&#45;&gt;layer12_mlp_allreduce_stage1 -->
<g id="edge274" class="edge">
<title>layer12_mlp_down_stage1&#45;&gt;layer12_mlp_allreduce_stage1</title>
<path fill="none" stroke="black" d="M480,-6523.22C480,-6515.41 480,-6506.54 480,-6497.78"/>
<polygon fill="black" stroke="black" points="483.5,-6497.6 480,-6487.6 476.5,-6497.6 483.5,-6497.6"/>
</g>
<!-- layer12_mlp_allreduce_stage1&#45;&gt;layer12_residual2_stage1 -->
<g id="edge275" class="edge">
<title>layer12_mlp_allreduce_stage1&#45;&gt;layer12_residual2_stage1</title>
<path fill="none" stroke="black" d="M497.52,-6413.78C501.96,-6404.68 506.86,-6394.66 511.7,-6384.77"/>
<polygon fill="black" stroke="black" points="514.86,-6386.26 516.11,-6375.74 508.57,-6383.19 514.86,-6386.26"/>
</g>
<!-- layer12_layernorm2_stage1 -->
<g id="node217" class="node">
<title>layer12_layernorm2_stage1</title>
<polygon fill="lightgreen" stroke="black" points="684.5,-6237.85 395.5,-6237.85 395.5,-6185.85 684.5,-6185.85 684.5,-6237.85"/>
<text text-anchor="middle" x="540" y="-6225.85" font-family="Arial" font-size="10.00">Layer 12 Layer Norm 2</text>
<text text-anchor="middle" x="540" y="-6214.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-6203.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-6192.85" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer12_residual2_stage1&#45;&gt;layer12_layernorm2_stage1 -->
<g id="edge277" class="edge">
<title>layer12_residual2_stage1&#45;&gt;layer12_layernorm2_stage1</title>
<path fill="none" stroke="black" d="M540,-6273.77C540,-6265.1 540,-6256.28 540,-6248.14"/>
<polygon fill="black" stroke="black" points="543.5,-6247.9 540,-6237.9 536.5,-6247.9 543.5,-6247.9"/>
</g>
<!-- layer13_input_stage1 -->
<g id="node218" class="node">
<title>layer13_input_stage1</title>
<polygon fill="lightyellow" stroke="black" points="839.74,-6149.85 362.92,-6149.85 240.26,-6045.85 717.08,-6045.85 839.74,-6149.85"/>
<text text-anchor="middle" x="540" y="-6111.85" font-family="Arial" font-size="10.00">Layer 13 Input</text>
<text text-anchor="middle" x="540" y="-6100.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-6089.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-6078.85" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer12_layernorm2_stage1&#45;&gt;layer13_input_stage1 -->
<g id="edge278" class="edge">
<title>layer12_layernorm2_stage1&#45;&gt;layer13_input_stage1</title>
<path fill="none" stroke="black" d="M540,-6185.72C540,-6178.03 540,-6169.22 540,-6160.22"/>
<polygon fill="black" stroke="black" points="543.5,-6160.03 540,-6150.03 536.5,-6160.03 543.5,-6160.03"/>
</g>
<!-- layer13_mha_query_stage1 -->
<g id="node219" class="node">
<title>layer13_mha_query_stage1</title>
<polygon fill="pink" stroke="black" points="343.5,-6009.85 52.5,-6009.85 52.5,-5957.85 343.5,-5957.85 343.5,-6009.85"/>
<text text-anchor="middle" x="198" y="-5997.85" font-family="Arial" font-size="10.00">Layer 13 MHA Query Linear</text>
<text text-anchor="middle" x="198" y="-5986.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="198" y="-5975.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_q=512]</text>
<text text-anchor="middle" x="198" y="-5964.85" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer13_input_stage1&#45;&gt;layer13_mha_query_stage1 -->
<g id="edge279" class="edge">
<title>layer13_input_stage1&#45;&gt;layer13_mha_query_stage1</title>
<path fill="none" stroke="black" d="M384.01,-6045.77C349.68,-6034.52 314.53,-6023.01 284.16,-6013.07"/>
<polygon fill="black" stroke="black" points="285.06,-6009.68 274.47,-6009.9 282.89,-6016.33 285.06,-6009.68"/>
</g>
<!-- layer13_mha_key_stage1 -->
<g id="node220" class="node">
<title>layer13_mha_key_stage1</title>
<polygon fill="pink" stroke="black" points="652.5,-6009.85 361.5,-6009.85 361.5,-5957.85 652.5,-5957.85 652.5,-6009.85"/>
<text text-anchor="middle" x="507" y="-5997.85" font-family="Arial" font-size="10.00">Layer 13 MHA Key Linear</text>
<text text-anchor="middle" x="507" y="-5986.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="507" y="-5975.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="507" y="-5964.85" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer13_input_stage1&#45;&gt;layer13_mha_key_stage1 -->
<g id="edge280" class="edge">
<title>layer13_input_stage1&#45;&gt;layer13_mha_key_stage1</title>
<path fill="none" stroke="black" d="M524.95,-6045.77C522.34,-6036.91 519.68,-6027.88 517.24,-6019.59"/>
<polygon fill="black" stroke="black" points="520.56,-6018.5 514.38,-6009.9 513.85,-6020.48 520.56,-6018.5"/>
</g>
<!-- layer13_mha_value_stage1 -->
<g id="node221" class="node">
<title>layer13_mha_value_stage1</title>
<polygon fill="pink" stroke="black" points="677.5,-5921.85 386.5,-5921.85 386.5,-5869.85 677.5,-5869.85 677.5,-5921.85"/>
<text text-anchor="middle" x="532" y="-5909.85" font-family="Arial" font-size="10.00">Layer 13 MHA Value Linear</text>
<text text-anchor="middle" x="532" y="-5898.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="532" y="-5887.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_v=512]</text>
<text text-anchor="middle" x="532" y="-5876.85" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer13_input_stage1&#45;&gt;layer13_mha_value_stage1 -->
<g id="edge281" class="edge">
<title>layer13_input_stage1&#45;&gt;layer13_mha_value_stage1</title>
<path fill="none" stroke="black" d="M633.06,-6045.83C644.7,-6035.47 654.97,-6023.5 662,-6009.85 672.58,-5989.31 674.39,-5977.36 662,-5957.85 653.88,-5945.08 642.31,-5934.93 629.37,-5926.89"/>
<polygon fill="black" stroke="black" points="631.1,-5923.85 620.69,-5921.9 627.61,-5929.92 631.1,-5923.85"/>
</g>
<!-- layer13_residual1_stage1 -->
<g id="node227" class="node">
<title>layer13_residual1_stage1</title>
<polygon fill="lightblue" stroke="black" points="540,-5460.31 16,-5408.31 540,-5356.31 1064,-5408.31 540,-5460.31"/>
<text text-anchor="middle" x="540" y="-5422.31" font-family="Arial" font-size="10.00">Layer 13 Residual Add 1</text>
<text text-anchor="middle" x="540" y="-5411.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-5400.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-5389.31" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer13_input_stage1&#45;&gt;layer13_residual1_stage1 -->
<g id="edge290" class="edge">
<title>layer13_input_stage1&#45;&gt;layer13_residual1_stage1</title>
<path fill="none" stroke="black" d="M636.49,-6045.71C649.62,-6035.32 661.74,-6023.36 671,-6009.85 700.09,-5967.43 696,-5948.29 696,-5896.85 696,-5896.85 696,-5896.85 696,-5630.85 696,-5570.89 717.53,-5547.31 686,-5496.31 676.31,-5480.64 662.66,-5467.44 647.56,-5456.44"/>
<polygon fill="black" stroke="black" points="649.26,-5453.35 639.04,-5450.55 645.28,-5459.11 649.26,-5453.35"/>
</g>
<!-- layer13_mha_qkt_stage1 -->
<g id="node222" class="node">
<title>layer13_mha_qkt_stage1</title>
<polygon fill="lightcoral" stroke="black" points="368,-5921.85 48,-5921.85 48,-5869.85 368,-5869.85 368,-5921.85"/>
<text text-anchor="middle" x="208" y="-5909.85" font-family="Arial" font-size="10.00">Layer 13 MHA QKT Calculation</text>
<text text-anchor="middle" x="208" y="-5898.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="208" y="-5887.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="208" y="-5876.85" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer13_mha_query_stage1&#45;&gt;layer13_mha_qkt_stage1 -->
<g id="edge282" class="edge">
<title>layer13_mha_query_stage1&#45;&gt;layer13_mha_qkt_stage1</title>
<path fill="none" stroke="black" d="M200.95,-5957.51C201.87,-5949.55 202.91,-5940.62 203.9,-5932.1"/>
<polygon fill="black" stroke="black" points="207.4,-5932.35 205.07,-5922.01 200.44,-5931.54 207.4,-5932.35"/>
</g>
<!-- layer13_mha_key_stage1&#45;&gt;layer13_mha_qkt_stage1 -->
<g id="edge283" class="edge">
<title>layer13_mha_key_stage1&#45;&gt;layer13_mha_qkt_stage1</title>
<path fill="none" stroke="black" d="M419.71,-5957.75C383.72,-5947.39 341.86,-5935.35 304.92,-5924.73"/>
<polygon fill="black" stroke="black" points="305.71,-5921.32 295.14,-5921.91 303.78,-5928.04 305.71,-5921.32"/>
</g>
<!-- layer13_mha_apply_stage1 -->
<g id="node224" class="node">
<title>layer13_mha_apply_stage1</title>
<polygon fill="lightcoral" stroke="black" points="629,-5745.85 317,-5745.85 317,-5693.85 629,-5693.85 629,-5745.85"/>
<text text-anchor="middle" x="473" y="-5733.85" font-family="Arial" font-size="10.00">Layer 13 MHA Apply Attention</text>
<text text-anchor="middle" x="473" y="-5722.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="473" y="-5711.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="473" y="-5700.85" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer13_mha_value_stage1&#45;&gt;layer13_mha_apply_stage1 -->
<g id="edge286" class="edge">
<title>layer13_mha_value_stage1&#45;&gt;layer13_mha_apply_stage1</title>
<path fill="none" stroke="black" d="M523.42,-5869.55C513.25,-5839.57 496.26,-5789.45 484.84,-5755.78"/>
<polygon fill="black" stroke="black" points="488.02,-5754.25 481.49,-5745.9 481.39,-5756.5 488.02,-5754.25"/>
</g>
<!-- layer13_mha_weights_stage1 -->
<g id="node223" class="node">
<title>layer13_mha_weights_stage1</title>
<polygon fill="lightcoral" stroke="black" points="412,-5833.85 92,-5833.85 92,-5781.85 412,-5781.85 412,-5833.85"/>
<text text-anchor="middle" x="252" y="-5821.85" font-family="Arial" font-size="10.00">Layer 13 MHA Attention Weights</text>
<text text-anchor="middle" x="252" y="-5810.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="252" y="-5799.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="252" y="-5788.85" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer13_mha_qkt_stage1&#45;&gt;layer13_mha_weights_stage1 -->
<g id="edge284" class="edge">
<title>layer13_mha_qkt_stage1&#45;&gt;layer13_mha_weights_stage1</title>
<path fill="none" stroke="black" d="M220.96,-5869.51C225.22,-5861.2 230.01,-5851.83 234.54,-5842.98"/>
<polygon fill="black" stroke="black" points="237.69,-5844.51 239.13,-5834.01 231.46,-5841.32 237.69,-5844.51"/>
</g>
<!-- layer13_mha_weights_stage1&#45;&gt;layer13_mha_apply_stage1 -->
<g id="edge285" class="edge">
<title>layer13_mha_weights_stage1&#45;&gt;layer13_mha_apply_stage1</title>
<path fill="none" stroke="black" d="M316.52,-5781.75C342.27,-5771.72 372.09,-5760.12 398.74,-5749.75"/>
<polygon fill="black" stroke="black" points="400.35,-5752.88 408.4,-5745.99 397.81,-5746.35 400.35,-5752.88"/>
</g>
<!-- layer13_mha_out_stage1 -->
<g id="node225" class="node">
<title>layer13_mha_out_stage1</title>
<polygon fill="pink" stroke="black" points="617.5,-5657.85 328.5,-5657.85 328.5,-5605.85 617.5,-5605.85 617.5,-5657.85"/>
<text text-anchor="middle" x="473" y="-5645.85" font-family="Arial" font-size="10.00">Layer 13 MHA Output Linear</text>
<text text-anchor="middle" x="473" y="-5634.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="473" y="-5623.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="473" y="-5612.85" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer13_mha_apply_stage1&#45;&gt;layer13_mha_out_stage1 -->
<g id="edge287" class="edge">
<title>layer13_mha_apply_stage1&#45;&gt;layer13_mha_out_stage1</title>
<path fill="none" stroke="black" d="M473,-5693.51C473,-5685.55 473,-5676.62 473,-5668.1"/>
<polygon fill="black" stroke="black" points="476.5,-5668.01 473,-5658.01 469.5,-5668.01 476.5,-5668.01"/>
</g>
<!-- layer13_mha_allreduce_stage1 -->
<g id="node226" class="node">
<title>layer13_mha_allreduce_stage1</title>
<ellipse fill="lightgray" stroke="black" cx="473" cy="-5533.08" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="473" y="-5547.08" font-family="Arial" font-size="10.00">Layer 13 MHA All&#45;reduce</text>
<text text-anchor="middle" x="473" y="-5536.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="473" y="-5525.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="473" y="-5514.08" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer13_mha_out_stage1&#45;&gt;layer13_mha_allreduce_stage1 -->
<g id="edge288" class="edge">
<title>layer13_mha_out_stage1&#45;&gt;layer13_mha_allreduce_stage1</title>
<path fill="none" stroke="black" d="M473,-5605.68C473,-5597.87 473,-5589.01 473,-5580.24"/>
<polygon fill="black" stroke="black" points="476.5,-5580.06 473,-5570.06 469.5,-5580.06 476.5,-5580.06"/>
</g>
<!-- layer13_mha_allreduce_stage1&#45;&gt;layer13_residual1_stage1 -->
<g id="edge289" class="edge">
<title>layer13_mha_allreduce_stage1&#45;&gt;layer13_residual1_stage1</title>
<path fill="none" stroke="black" d="M492.56,-5496.24C497.64,-5486.94 503.24,-5476.68 508.75,-5466.57"/>
<polygon fill="black" stroke="black" points="511.85,-5468.21 513.57,-5457.75 505.7,-5464.85 511.85,-5468.21"/>
</g>
<!-- layer13_layernorm1_stage1 -->
<g id="node228" class="node">
<title>layer13_layernorm1_stage1</title>
<polygon fill="lightgreen" stroke="black" points="684.5,-5320.31 395.5,-5320.31 395.5,-5268.31 684.5,-5268.31 684.5,-5320.31"/>
<text text-anchor="middle" x="540" y="-5308.31" font-family="Arial" font-size="10.00">Layer 13 Layer Norm 1</text>
<text text-anchor="middle" x="540" y="-5297.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-5286.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-5275.31" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer13_residual1_stage1&#45;&gt;layer13_layernorm1_stage1 -->
<g id="edge291" class="edge">
<title>layer13_residual1_stage1&#45;&gt;layer13_layernorm1_stage1</title>
<path fill="none" stroke="black" d="M540,-5356.23C540,-5347.56 540,-5338.74 540,-5330.6"/>
<polygon fill="black" stroke="black" points="543.5,-5330.36 540,-5320.36 536.5,-5330.36 543.5,-5330.36"/>
</g>
<!-- layer13_mlp_gate_stage1 -->
<g id="node229" class="node">
<title>layer13_mlp_gate_stage1</title>
<polygon fill="lightyellow" stroke="black" points="449.5,-5232.31 162.5,-5232.31 162.5,-5180.31 449.5,-5180.31 449.5,-5232.31"/>
<text text-anchor="middle" x="306" y="-5220.31" font-family="Arial" font-size="10.00">Layer 13 MLP Gate Linear</text>
<text text-anchor="middle" x="306" y="-5209.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="306" y="-5198.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="306" y="-5187.31" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer13_layernorm1_stage1&#45;&gt;layer13_mlp_gate_stage1 -->
<g id="edge292" class="edge">
<title>layer13_layernorm1_stage1&#45;&gt;layer13_mlp_gate_stage1</title>
<path fill="none" stroke="black" d="M471.69,-5268.21C444.18,-5258.1 412.29,-5246.38 383.89,-5235.94"/>
<polygon fill="black" stroke="black" points="384.99,-5232.61 374.4,-5232.45 382.58,-5239.18 384.99,-5232.61"/>
</g>
<!-- layer13_mlp_up_stage1 -->
<g id="node230" class="node">
<title>layer13_mlp_up_stage1</title>
<polygon fill="lightyellow" stroke="black" points="683.5,-5144.31 396.5,-5144.31 396.5,-5092.31 683.5,-5092.31 683.5,-5144.31"/>
<text text-anchor="middle" x="540" y="-5132.31" font-family="Arial" font-size="10.00">Layer 13 MLP Up Linear</text>
<text text-anchor="middle" x="540" y="-5121.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-5110.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="540" y="-5099.31" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer13_layernorm1_stage1&#45;&gt;layer13_mlp_up_stage1 -->
<g id="edge293" class="edge">
<title>layer13_layernorm1_stage1&#45;&gt;layer13_mlp_up_stage1</title>
<path fill="none" stroke="black" d="M540,-5268.01C540,-5238.16 540,-5188.34 540,-5154.68"/>
<polygon fill="black" stroke="black" points="543.5,-5154.36 540,-5144.36 536.5,-5154.36 543.5,-5154.36"/>
</g>
<!-- layer13_residual2_stage1 -->
<g id="node234" class="node">
<title>layer13_residual2_stage1</title>
<polygon fill="lightblue" stroke="black" points="540,-4858.77 16,-4806.77 540,-4754.77 1064,-4806.77 540,-4858.77"/>
<text text-anchor="middle" x="540" y="-4820.77" font-family="Arial" font-size="10.00">Layer 13 Residual Add 2</text>
<text text-anchor="middle" x="540" y="-4809.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-4798.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-4787.77" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer13_layernorm1_stage1&#45;&gt;layer13_residual2_stage1 -->
<g id="edge299" class="edge">
<title>layer13_layernorm1_stage1&#45;&gt;layer13_residual2_stage1</title>
<path fill="none" stroke="black" d="M588.46,-5268.09C636.51,-5239.19 703,-5186.99 703,-5119.31 703,-5119.31 703,-5119.31 703,-5029.31 703,-4969.35 725.05,-4945.45 693,-4894.77 682.85,-4878.72 668.6,-4865.33 652.85,-4854.26"/>
<polygon fill="black" stroke="black" points="654.75,-4851.33 644.49,-4848.69 650.87,-4857.15 654.75,-4851.33"/>
</g>
<!-- layer13_mlp_gelu_stage1 -->
<g id="node231" class="node">
<title>layer13_mlp_gelu_stage1</title>
<polygon fill="orange" stroke="black" points="378.5,-5144.31 91.5,-5144.31 91.5,-5092.31 378.5,-5092.31 378.5,-5144.31"/>
<text text-anchor="middle" x="235" y="-5132.31" font-family="Arial" font-size="10.00">Layer 13 MLP GELU</text>
<text text-anchor="middle" x="235" y="-5121.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="235" y="-5110.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="235" y="-5099.31" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer13_mlp_gate_stage1&#45;&gt;layer13_mlp_gelu_stage1 -->
<g id="edge294" class="edge">
<title>layer13_mlp_gate_stage1&#45;&gt;layer13_mlp_gelu_stage1</title>
<path fill="none" stroke="black" d="M285.08,-5179.98C277.93,-5171.31 269.83,-5161.5 262.25,-5152.32"/>
<polygon fill="black" stroke="black" points="264.83,-5149.95 255.77,-5144.47 259.44,-5154.41 264.83,-5149.95"/>
</g>
<!-- layer13_mlp_down_stage1 -->
<g id="node232" class="node">
<title>layer13_mlp_down_stage1</title>
<polygon fill="lightyellow" stroke="black" points="624.5,-5056.31 335.5,-5056.31 335.5,-5004.31 624.5,-5004.31 624.5,-5056.31"/>
<text text-anchor="middle" x="480" y="-5044.31" font-family="Arial" font-size="10.00">Layer 13 MLP Down Linear</text>
<text text-anchor="middle" x="480" y="-5033.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="480" y="-5022.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-5011.31" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer13_mlp_up_stage1&#45;&gt;layer13_mlp_down_stage1 -->
<g id="edge296" class="edge">
<title>layer13_mlp_up_stage1&#45;&gt;layer13_mlp_down_stage1</title>
<path fill="none" stroke="black" d="M522.32,-5091.98C516.4,-5083.49 509.71,-5073.89 503.42,-5064.88"/>
<polygon fill="black" stroke="black" points="506.14,-5062.67 497.55,-5056.47 500.4,-5066.67 506.14,-5062.67"/>
</g>
<!-- layer13_mlp_gelu_stage1&#45;&gt;layer13_mlp_down_stage1 -->
<g id="edge295" class="edge">
<title>layer13_mlp_gelu_stage1&#45;&gt;layer13_mlp_down_stage1</title>
<path fill="none" stroke="black" d="M306.52,-5092.21C335.45,-5082.05 369,-5070.28 398.84,-5059.8"/>
<polygon fill="black" stroke="black" points="400.11,-5063.06 408.39,-5056.45 397.79,-5056.46 400.11,-5063.06"/>
</g>
<!-- layer13_mlp_allreduce_stage1 -->
<g id="node233" class="node">
<title>layer13_mlp_allreduce_stage1</title>
<ellipse fill="lightgray" stroke="black" cx="480" cy="-4931.54" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="480" y="-4945.54" font-family="Arial" font-size="10.00">Layer 13 MLP All&#45;reduce</text>
<text text-anchor="middle" x="480" y="-4934.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-4923.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-4912.54" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer13_mlp_down_stage1&#45;&gt;layer13_mlp_allreduce_stage1 -->
<g id="edge297" class="edge">
<title>layer13_mlp_down_stage1&#45;&gt;layer13_mlp_allreduce_stage1</title>
<path fill="none" stroke="black" d="M480,-5004.14C480,-4996.33 480,-4987.47 480,-4978.7"/>
<polygon fill="black" stroke="black" points="483.5,-4978.52 480,-4968.52 476.5,-4978.52 483.5,-4978.52"/>
</g>
<!-- layer13_mlp_allreduce_stage1&#45;&gt;layer13_residual2_stage1 -->
<g id="edge298" class="edge">
<title>layer13_mlp_allreduce_stage1&#45;&gt;layer13_residual2_stage1</title>
<path fill="none" stroke="black" d="M497.52,-4894.7C501.96,-4885.6 506.86,-4875.58 511.7,-4865.69"/>
<polygon fill="black" stroke="black" points="514.86,-4867.19 516.11,-4856.66 508.57,-4864.11 514.86,-4867.19"/>
</g>
<!-- layer13_layernorm2_stage1 -->
<g id="node235" class="node">
<title>layer13_layernorm2_stage1</title>
<polygon fill="lightgreen" stroke="black" points="684.5,-4718.77 395.5,-4718.77 395.5,-4666.77 684.5,-4666.77 684.5,-4718.77"/>
<text text-anchor="middle" x="540" y="-4706.77" font-family="Arial" font-size="10.00">Layer 13 Layer Norm 2</text>
<text text-anchor="middle" x="540" y="-4695.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-4684.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-4673.77" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer13_residual2_stage1&#45;&gt;layer13_layernorm2_stage1 -->
<g id="edge300" class="edge">
<title>layer13_residual2_stage1&#45;&gt;layer13_layernorm2_stage1</title>
<path fill="none" stroke="black" d="M540,-4754.69C540,-4746.03 540,-4737.2 540,-4729.06"/>
<polygon fill="black" stroke="black" points="543.5,-4728.82 540,-4718.82 536.5,-4728.82 543.5,-4728.82"/>
</g>
<!-- layer14_input_stage1 -->
<g id="node236" class="node">
<title>layer14_input_stage1</title>
<polygon fill="lightyellow" stroke="black" points="839.74,-4630.77 362.92,-4630.77 240.26,-4526.77 717.08,-4526.77 839.74,-4630.77"/>
<text text-anchor="middle" x="540" y="-4592.77" font-family="Arial" font-size="10.00">Layer 14 Input</text>
<text text-anchor="middle" x="540" y="-4581.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-4570.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-4559.77" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer13_layernorm2_stage1&#45;&gt;layer14_input_stage1 -->
<g id="edge301" class="edge">
<title>layer13_layernorm2_stage1&#45;&gt;layer14_input_stage1</title>
<path fill="none" stroke="black" d="M540,-4666.64C540,-4658.95 540,-4650.14 540,-4641.14"/>
<polygon fill="black" stroke="black" points="543.5,-4640.95 540,-4630.95 536.5,-4640.95 543.5,-4640.95"/>
</g>
<!-- layer14_mha_query_stage1 -->
<g id="node237" class="node">
<title>layer14_mha_query_stage1</title>
<polygon fill="pink" stroke="black" points="343.5,-4490.77 52.5,-4490.77 52.5,-4438.77 343.5,-4438.77 343.5,-4490.77"/>
<text text-anchor="middle" x="198" y="-4478.77" font-family="Arial" font-size="10.00">Layer 14 MHA Query Linear</text>
<text text-anchor="middle" x="198" y="-4467.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="198" y="-4456.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_q=512]</text>
<text text-anchor="middle" x="198" y="-4445.77" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer14_input_stage1&#45;&gt;layer14_mha_query_stage1 -->
<g id="edge302" class="edge">
<title>layer14_input_stage1&#45;&gt;layer14_mha_query_stage1</title>
<path fill="none" stroke="black" d="M384.01,-4526.69C349.68,-4515.45 314.53,-4503.93 284.16,-4493.99"/>
<polygon fill="black" stroke="black" points="285.06,-4490.6 274.47,-4490.82 282.89,-4497.26 285.06,-4490.6"/>
</g>
<!-- layer14_mha_key_stage1 -->
<g id="node238" class="node">
<title>layer14_mha_key_stage1</title>
<polygon fill="pink" stroke="black" points="652.5,-4490.77 361.5,-4490.77 361.5,-4438.77 652.5,-4438.77 652.5,-4490.77"/>
<text text-anchor="middle" x="507" y="-4478.77" font-family="Arial" font-size="10.00">Layer 14 MHA Key Linear</text>
<text text-anchor="middle" x="507" y="-4467.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="507" y="-4456.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="507" y="-4445.77" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer14_input_stage1&#45;&gt;layer14_mha_key_stage1 -->
<g id="edge303" class="edge">
<title>layer14_input_stage1&#45;&gt;layer14_mha_key_stage1</title>
<path fill="none" stroke="black" d="M524.95,-4526.69C522.34,-4517.83 519.68,-4508.81 517.24,-4500.51"/>
<polygon fill="black" stroke="black" points="520.56,-4499.42 514.38,-4490.82 513.85,-4501.4 520.56,-4499.42"/>
</g>
<!-- layer14_mha_value_stage1 -->
<g id="node239" class="node">
<title>layer14_mha_value_stage1</title>
<polygon fill="pink" stroke="black" points="677.5,-4402.77 386.5,-4402.77 386.5,-4350.77 677.5,-4350.77 677.5,-4402.77"/>
<text text-anchor="middle" x="532" y="-4390.77" font-family="Arial" font-size="10.00">Layer 14 MHA Value Linear</text>
<text text-anchor="middle" x="532" y="-4379.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="532" y="-4368.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_v=512]</text>
<text text-anchor="middle" x="532" y="-4357.77" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer14_input_stage1&#45;&gt;layer14_mha_value_stage1 -->
<g id="edge304" class="edge">
<title>layer14_input_stage1&#45;&gt;layer14_mha_value_stage1</title>
<path fill="none" stroke="black" d="M633.06,-4526.75C644.7,-4516.39 654.97,-4504.42 662,-4490.77 672.58,-4470.23 674.39,-4458.28 662,-4438.77 653.88,-4426 642.31,-4415.85 629.37,-4407.81"/>
<polygon fill="black" stroke="black" points="631.1,-4404.77 620.69,-4402.82 627.61,-4410.84 631.1,-4404.77"/>
</g>
<!-- layer14_residual1_stage1 -->
<g id="node245" class="node">
<title>layer14_residual1_stage1</title>
<polygon fill="lightblue" stroke="black" points="540,-3941.23 16,-3889.23 540,-3837.23 1064,-3889.23 540,-3941.23"/>
<text text-anchor="middle" x="540" y="-3903.23" font-family="Arial" font-size="10.00">Layer 14 Residual Add 1</text>
<text text-anchor="middle" x="540" y="-3892.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-3881.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-3870.23" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer14_input_stage1&#45;&gt;layer14_residual1_stage1 -->
<g id="edge313" class="edge">
<title>layer14_input_stage1&#45;&gt;layer14_residual1_stage1</title>
<path fill="none" stroke="black" d="M636.49,-4526.63C649.62,-4516.24 661.74,-4504.28 671,-4490.77 700.09,-4448.35 696,-4429.21 696,-4377.77 696,-4377.77 696,-4377.77 696,-4111.77 696,-4051.81 717.53,-4028.23 686,-3977.23 676.31,-3961.57 662.66,-3948.36 647.56,-3937.36"/>
<polygon fill="black" stroke="black" points="649.26,-3934.28 639.04,-3931.47 645.28,-3940.03 649.26,-3934.28"/>
</g>
<!-- layer14_mha_qkt_stage1 -->
<g id="node240" class="node">
<title>layer14_mha_qkt_stage1</title>
<polygon fill="lightcoral" stroke="black" points="368,-4402.77 48,-4402.77 48,-4350.77 368,-4350.77 368,-4402.77"/>
<text text-anchor="middle" x="208" y="-4390.77" font-family="Arial" font-size="10.00">Layer 14 MHA QKT Calculation</text>
<text text-anchor="middle" x="208" y="-4379.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="208" y="-4368.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="208" y="-4357.77" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer14_mha_query_stage1&#45;&gt;layer14_mha_qkt_stage1 -->
<g id="edge305" class="edge">
<title>layer14_mha_query_stage1&#45;&gt;layer14_mha_qkt_stage1</title>
<path fill="none" stroke="black" d="M200.95,-4438.44C201.87,-4430.48 202.91,-4421.54 203.9,-4413.02"/>
<polygon fill="black" stroke="black" points="207.4,-4413.27 205.07,-4402.93 200.44,-4412.46 207.4,-4413.27"/>
</g>
<!-- layer14_mha_key_stage1&#45;&gt;layer14_mha_qkt_stage1 -->
<g id="edge306" class="edge">
<title>layer14_mha_key_stage1&#45;&gt;layer14_mha_qkt_stage1</title>
<path fill="none" stroke="black" d="M419.71,-4438.67C383.72,-4428.31 341.86,-4416.28 304.92,-4405.65"/>
<polygon fill="black" stroke="black" points="305.71,-4402.24 295.14,-4402.84 303.78,-4408.96 305.71,-4402.24"/>
</g>
<!-- layer14_mha_apply_stage1 -->
<g id="node242" class="node">
<title>layer14_mha_apply_stage1</title>
<polygon fill="lightcoral" stroke="black" points="629,-4226.77 317,-4226.77 317,-4174.77 629,-4174.77 629,-4226.77"/>
<text text-anchor="middle" x="473" y="-4214.77" font-family="Arial" font-size="10.00">Layer 14 MHA Apply Attention</text>
<text text-anchor="middle" x="473" y="-4203.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="473" y="-4192.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="473" y="-4181.77" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer14_mha_value_stage1&#45;&gt;layer14_mha_apply_stage1 -->
<g id="edge309" class="edge">
<title>layer14_mha_value_stage1&#45;&gt;layer14_mha_apply_stage1</title>
<path fill="none" stroke="black" d="M523.42,-4350.47C513.25,-4320.49 496.26,-4270.37 484.84,-4236.7"/>
<polygon fill="black" stroke="black" points="488.02,-4235.17 481.49,-4226.82 481.39,-4237.42 488.02,-4235.17"/>
</g>
<!-- layer14_mha_weights_stage1 -->
<g id="node241" class="node">
<title>layer14_mha_weights_stage1</title>
<polygon fill="lightcoral" stroke="black" points="412,-4314.77 92,-4314.77 92,-4262.77 412,-4262.77 412,-4314.77"/>
<text text-anchor="middle" x="252" y="-4302.77" font-family="Arial" font-size="10.00">Layer 14 MHA Attention Weights</text>
<text text-anchor="middle" x="252" y="-4291.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="252" y="-4280.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="252" y="-4269.77" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer14_mha_qkt_stage1&#45;&gt;layer14_mha_weights_stage1 -->
<g id="edge307" class="edge">
<title>layer14_mha_qkt_stage1&#45;&gt;layer14_mha_weights_stage1</title>
<path fill="none" stroke="black" d="M220.96,-4350.44C225.22,-4342.13 230.01,-4332.75 234.54,-4323.9"/>
<polygon fill="black" stroke="black" points="237.69,-4325.43 239.13,-4314.93 231.46,-4322.24 237.69,-4325.43"/>
</g>
<!-- layer14_mha_weights_stage1&#45;&gt;layer14_mha_apply_stage1 -->
<g id="edge308" class="edge">
<title>layer14_mha_weights_stage1&#45;&gt;layer14_mha_apply_stage1</title>
<path fill="none" stroke="black" d="M316.52,-4262.67C342.27,-4252.64 372.09,-4241.04 398.74,-4230.67"/>
<polygon fill="black" stroke="black" points="400.35,-4233.8 408.4,-4226.91 397.81,-4227.28 400.35,-4233.8"/>
</g>
<!-- layer14_mha_out_stage1 -->
<g id="node243" class="node">
<title>layer14_mha_out_stage1</title>
<polygon fill="pink" stroke="black" points="617.5,-4138.77 328.5,-4138.77 328.5,-4086.77 617.5,-4086.77 617.5,-4138.77"/>
<text text-anchor="middle" x="473" y="-4126.77" font-family="Arial" font-size="10.00">Layer 14 MHA Output Linear</text>
<text text-anchor="middle" x="473" y="-4115.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="473" y="-4104.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="473" y="-4093.77" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer14_mha_apply_stage1&#45;&gt;layer14_mha_out_stage1 -->
<g id="edge310" class="edge">
<title>layer14_mha_apply_stage1&#45;&gt;layer14_mha_out_stage1</title>
<path fill="none" stroke="black" d="M473,-4174.44C473,-4166.48 473,-4157.54 473,-4149.02"/>
<polygon fill="black" stroke="black" points="476.5,-4148.93 473,-4138.93 469.5,-4148.93 476.5,-4148.93"/>
</g>
<!-- layer14_mha_allreduce_stage1 -->
<g id="node244" class="node">
<title>layer14_mha_allreduce_stage1</title>
<ellipse fill="lightgray" stroke="black" cx="473" cy="-4014" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="473" y="-4028" font-family="Arial" font-size="10.00">Layer 14 MHA All&#45;reduce</text>
<text text-anchor="middle" x="473" y="-4017" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="473" y="-4006" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="473" y="-3995" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer14_mha_out_stage1&#45;&gt;layer14_mha_allreduce_stage1 -->
<g id="edge311" class="edge">
<title>layer14_mha_out_stage1&#45;&gt;layer14_mha_allreduce_stage1</title>
<path fill="none" stroke="black" d="M473,-4086.6C473,-4078.79 473,-4069.93 473,-4061.16"/>
<polygon fill="black" stroke="black" points="476.5,-4060.98 473,-4050.98 469.5,-4060.98 476.5,-4060.98"/>
</g>
<!-- layer14_mha_allreduce_stage1&#45;&gt;layer14_residual1_stage1 -->
<g id="edge312" class="edge">
<title>layer14_mha_allreduce_stage1&#45;&gt;layer14_residual1_stage1</title>
<path fill="none" stroke="black" d="M492.56,-3977.16C497.64,-3967.86 503.24,-3957.6 508.75,-3947.49"/>
<polygon fill="black" stroke="black" points="511.85,-3949.13 513.57,-3938.67 505.7,-3945.77 511.85,-3949.13"/>
</g>
<!-- layer14_layernorm1_stage1 -->
<g id="node246" class="node">
<title>layer14_layernorm1_stage1</title>
<polygon fill="lightgreen" stroke="black" points="684.5,-3801.23 395.5,-3801.23 395.5,-3749.23 684.5,-3749.23 684.5,-3801.23"/>
<text text-anchor="middle" x="540" y="-3789.23" font-family="Arial" font-size="10.00">Layer 14 Layer Norm 1</text>
<text text-anchor="middle" x="540" y="-3778.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-3767.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-3756.23" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer14_residual1_stage1&#45;&gt;layer14_layernorm1_stage1 -->
<g id="edge314" class="edge">
<title>layer14_residual1_stage1&#45;&gt;layer14_layernorm1_stage1</title>
<path fill="none" stroke="black" d="M540,-3837.15C540,-3828.49 540,-3819.66 540,-3811.52"/>
<polygon fill="black" stroke="black" points="543.5,-3811.28 540,-3801.28 536.5,-3811.28 543.5,-3811.28"/>
</g>
<!-- layer14_mlp_gate_stage1 -->
<g id="node247" class="node">
<title>layer14_mlp_gate_stage1</title>
<polygon fill="lightyellow" stroke="black" points="449.5,-3713.23 162.5,-3713.23 162.5,-3661.23 449.5,-3661.23 449.5,-3713.23"/>
<text text-anchor="middle" x="306" y="-3701.23" font-family="Arial" font-size="10.00">Layer 14 MLP Gate Linear</text>
<text text-anchor="middle" x="306" y="-3690.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="306" y="-3679.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="306" y="-3668.23" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer14_layernorm1_stage1&#45;&gt;layer14_mlp_gate_stage1 -->
<g id="edge315" class="edge">
<title>layer14_layernorm1_stage1&#45;&gt;layer14_mlp_gate_stage1</title>
<path fill="none" stroke="black" d="M471.69,-3749.13C444.18,-3739.02 412.29,-3727.3 383.89,-3716.86"/>
<polygon fill="black" stroke="black" points="384.99,-3713.54 374.4,-3713.37 382.58,-3720.11 384.99,-3713.54"/>
</g>
<!-- layer14_mlp_up_stage1 -->
<g id="node248" class="node">
<title>layer14_mlp_up_stage1</title>
<polygon fill="lightyellow" stroke="black" points="683.5,-3625.23 396.5,-3625.23 396.5,-3573.23 683.5,-3573.23 683.5,-3625.23"/>
<text text-anchor="middle" x="540" y="-3613.23" font-family="Arial" font-size="10.00">Layer 14 MLP Up Linear</text>
<text text-anchor="middle" x="540" y="-3602.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-3591.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="540" y="-3580.23" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer14_layernorm1_stage1&#45;&gt;layer14_mlp_up_stage1 -->
<g id="edge316" class="edge">
<title>layer14_layernorm1_stage1&#45;&gt;layer14_mlp_up_stage1</title>
<path fill="none" stroke="black" d="M540,-3748.93C540,-3719.08 540,-3669.26 540,-3635.6"/>
<polygon fill="black" stroke="black" points="543.5,-3635.28 540,-3625.28 536.5,-3635.28 543.5,-3635.28"/>
</g>
<!-- layer14_residual2_stage1 -->
<g id="node252" class="node">
<title>layer14_residual2_stage1</title>
<polygon fill="lightblue" stroke="black" points="540,-3339.7 16,-3287.7 540,-3235.7 1064,-3287.7 540,-3339.7"/>
<text text-anchor="middle" x="540" y="-3301.7" font-family="Arial" font-size="10.00">Layer 14 Residual Add 2</text>
<text text-anchor="middle" x="540" y="-3290.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-3279.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-3268.7" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer14_layernorm1_stage1&#45;&gt;layer14_residual2_stage1 -->
<g id="edge322" class="edge">
<title>layer14_layernorm1_stage1&#45;&gt;layer14_residual2_stage1</title>
<path fill="none" stroke="black" d="M588.46,-3749.01C636.51,-3720.12 703,-3667.91 703,-3600.23 703,-3600.23 703,-3600.23 703,-3510.23 703,-3450.27 725.05,-3426.37 693,-3375.7 682.85,-3359.64 668.6,-3346.25 652.85,-3335.19"/>
<polygon fill="black" stroke="black" points="654.75,-3332.25 644.49,-3329.61 650.87,-3338.07 654.75,-3332.25"/>
</g>
<!-- layer14_mlp_gelu_stage1 -->
<g id="node249" class="node">
<title>layer14_mlp_gelu_stage1</title>
<polygon fill="orange" stroke="black" points="378.5,-3625.23 91.5,-3625.23 91.5,-3573.23 378.5,-3573.23 378.5,-3625.23"/>
<text text-anchor="middle" x="235" y="-3613.23" font-family="Arial" font-size="10.00">Layer 14 MLP GELU</text>
<text text-anchor="middle" x="235" y="-3602.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="235" y="-3591.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="235" y="-3580.23" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer14_mlp_gate_stage1&#45;&gt;layer14_mlp_gelu_stage1 -->
<g id="edge317" class="edge">
<title>layer14_mlp_gate_stage1&#45;&gt;layer14_mlp_gelu_stage1</title>
<path fill="none" stroke="black" d="M285.08,-3660.9C277.93,-3652.24 269.83,-3642.42 262.25,-3633.24"/>
<polygon fill="black" stroke="black" points="264.83,-3630.87 255.77,-3625.39 259.44,-3635.33 264.83,-3630.87"/>
</g>
<!-- layer14_mlp_down_stage1 -->
<g id="node250" class="node">
<title>layer14_mlp_down_stage1</title>
<polygon fill="lightyellow" stroke="black" points="624.5,-3537.23 335.5,-3537.23 335.5,-3485.23 624.5,-3485.23 624.5,-3537.23"/>
<text text-anchor="middle" x="480" y="-3525.23" font-family="Arial" font-size="10.00">Layer 14 MLP Down Linear</text>
<text text-anchor="middle" x="480" y="-3514.23" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="480" y="-3503.23" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-3492.23" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer14_mlp_up_stage1&#45;&gt;layer14_mlp_down_stage1 -->
<g id="edge319" class="edge">
<title>layer14_mlp_up_stage1&#45;&gt;layer14_mlp_down_stage1</title>
<path fill="none" stroke="black" d="M522.32,-3572.9C516.4,-3564.41 509.71,-3554.81 503.42,-3545.8"/>
<polygon fill="black" stroke="black" points="506.14,-3543.59 497.55,-3537.39 500.4,-3547.6 506.14,-3543.59"/>
</g>
<!-- layer14_mlp_gelu_stage1&#45;&gt;layer14_mlp_down_stage1 -->
<g id="edge318" class="edge">
<title>layer14_mlp_gelu_stage1&#45;&gt;layer14_mlp_down_stage1</title>
<path fill="none" stroke="black" d="M306.52,-3573.13C335.45,-3562.97 369,-3551.2 398.84,-3540.72"/>
<polygon fill="black" stroke="black" points="400.11,-3543.99 408.39,-3537.37 397.79,-3537.38 400.11,-3543.99"/>
</g>
<!-- layer14_mlp_allreduce_stage1 -->
<g id="node251" class="node">
<title>layer14_mlp_allreduce_stage1</title>
<ellipse fill="lightgray" stroke="black" cx="480" cy="-3412.47" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="480" y="-3426.47" font-family="Arial" font-size="10.00">Layer 14 MLP All&#45;reduce</text>
<text text-anchor="middle" x="480" y="-3415.47" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-3404.47" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-3393.47" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer14_mlp_down_stage1&#45;&gt;layer14_mlp_allreduce_stage1 -->
<g id="edge320" class="edge">
<title>layer14_mlp_down_stage1&#45;&gt;layer14_mlp_allreduce_stage1</title>
<path fill="none" stroke="black" d="M480,-3485.06C480,-3477.25 480,-3468.39 480,-3459.62"/>
<polygon fill="black" stroke="black" points="483.5,-3459.44 480,-3449.44 476.5,-3459.44 483.5,-3459.44"/>
</g>
<!-- layer14_mlp_allreduce_stage1&#45;&gt;layer14_residual2_stage1 -->
<g id="edge321" class="edge">
<title>layer14_mlp_allreduce_stage1&#45;&gt;layer14_residual2_stage1</title>
<path fill="none" stroke="black" d="M497.52,-3375.63C501.96,-3366.52 506.86,-3356.51 511.7,-3346.61"/>
<polygon fill="black" stroke="black" points="514.86,-3348.11 516.11,-3337.59 508.57,-3345.03 514.86,-3348.11"/>
</g>
<!-- layer14_layernorm2_stage1 -->
<g id="node253" class="node">
<title>layer14_layernorm2_stage1</title>
<polygon fill="lightgreen" stroke="black" points="684.5,-3199.7 395.5,-3199.7 395.5,-3147.7 684.5,-3147.7 684.5,-3199.7"/>
<text text-anchor="middle" x="540" y="-3187.7" font-family="Arial" font-size="10.00">Layer 14 Layer Norm 2</text>
<text text-anchor="middle" x="540" y="-3176.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-3165.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-3154.7" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer14_residual2_stage1&#45;&gt;layer14_layernorm2_stage1 -->
<g id="edge323" class="edge">
<title>layer14_residual2_stage1&#45;&gt;layer14_layernorm2_stage1</title>
<path fill="none" stroke="black" d="M540,-3235.61C540,-3226.95 540,-3218.12 540,-3209.98"/>
<polygon fill="black" stroke="black" points="543.5,-3209.74 540,-3199.74 536.5,-3209.74 543.5,-3209.74"/>
</g>
<!-- layer15_input_stage1 -->
<g id="node254" class="node">
<title>layer15_input_stage1</title>
<polygon fill="lightyellow" stroke="black" points="839.74,-3111.7 362.92,-3111.7 240.26,-3007.7 717.08,-3007.7 839.74,-3111.7"/>
<text text-anchor="middle" x="540" y="-3073.7" font-family="Arial" font-size="10.00">Layer 15 Input</text>
<text text-anchor="middle" x="540" y="-3062.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-3051.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-3040.7" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer14_layernorm2_stage1&#45;&gt;layer15_input_stage1 -->
<g id="edge324" class="edge">
<title>layer14_layernorm2_stage1&#45;&gt;layer15_input_stage1</title>
<path fill="none" stroke="black" d="M540,-3147.56C540,-3139.88 540,-3131.06 540,-3122.06"/>
<polygon fill="black" stroke="black" points="543.5,-3121.87 540,-3111.87 536.5,-3121.87 543.5,-3121.87"/>
</g>
<!-- layer15_mha_query_stage1 -->
<g id="node255" class="node">
<title>layer15_mha_query_stage1</title>
<polygon fill="pink" stroke="black" points="311.5,-2971.7 20.5,-2971.7 20.5,-2919.7 311.5,-2919.7 311.5,-2971.7"/>
<text text-anchor="middle" x="166" y="-2959.7" font-family="Arial" font-size="10.00">Layer 15 MHA Query Linear</text>
<text text-anchor="middle" x="166" y="-2948.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="166" y="-2937.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_q=512]</text>
<text text-anchor="middle" x="166" y="-2926.7" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer15_input_stage1&#45;&gt;layer15_mha_query_stage1 -->
<g id="edge325" class="edge">
<title>layer15_input_stage1&#45;&gt;layer15_mha_query_stage1</title>
<path fill="none" stroke="black" d="M369.69,-3007.69C331.78,-2996.34 292.96,-2984.71 259.51,-2974.7"/>
<polygon fill="black" stroke="black" points="260.35,-2971.3 249.76,-2971.78 258.34,-2978 260.35,-2971.3"/>
</g>
<!-- layer15_mha_key_stage1 -->
<g id="node256" class="node">
<title>layer15_mha_key_stage1</title>
<polygon fill="pink" stroke="black" points="620.5,-2971.7 329.5,-2971.7 329.5,-2919.7 620.5,-2919.7 620.5,-2971.7"/>
<text text-anchor="middle" x="475" y="-2959.7" font-family="Arial" font-size="10.00">Layer 15 MHA Key Linear</text>
<text text-anchor="middle" x="475" y="-2948.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="475" y="-2937.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="475" y="-2926.7" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer15_input_stage1&#45;&gt;layer15_mha_key_stage1 -->
<g id="edge326" class="edge">
<title>layer15_input_stage1&#45;&gt;layer15_mha_key_stage1</title>
<path fill="none" stroke="black" d="M510.35,-3007.61C505.04,-2998.46 499.63,-2989.13 494.69,-2980.62"/>
<polygon fill="black" stroke="black" points="497.58,-2978.63 489.53,-2971.74 491.53,-2982.14 497.58,-2978.63"/>
</g>
<!-- layer15_mha_value_stage1 -->
<g id="node257" class="node">
<title>layer15_mha_value_stage1</title>
<polygon fill="pink" stroke="black" points="694.5,-2883.7 403.5,-2883.7 403.5,-2831.7 694.5,-2831.7 694.5,-2883.7"/>
<text text-anchor="middle" x="549" y="-2871.7" font-family="Arial" font-size="10.00">Layer 15 MHA Value Linear</text>
<text text-anchor="middle" x="549" y="-2860.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-2849.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_v=512]</text>
<text text-anchor="middle" x="549" y="-2838.7" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer15_input_stage1&#45;&gt;layer15_mha_value_stage1 -->
<g id="edge327" class="edge">
<title>layer15_input_stage1&#45;&gt;layer15_mha_value_stage1</title>
<path fill="none" stroke="black" d="M606.33,-3007.39C615.97,-2996.71 624.48,-2984.7 630,-2971.7 639.02,-2950.42 640.32,-2940.38 630,-2919.7 624.3,-2908.26 615.31,-2898.4 605.37,-2890.15"/>
<polygon fill="black" stroke="black" points="607.29,-2887.21 597.24,-2883.88 603.02,-2892.76 607.29,-2887.21"/>
</g>
<!-- layer15_residual1_stage1 -->
<g id="node263" class="node">
<title>layer15_residual1_stage1</title>
<polygon fill="lightblue" stroke="black" points="540,-2422.16 16,-2370.16 540,-2318.16 1064,-2370.16 540,-2422.16"/>
<text text-anchor="middle" x="540" y="-2384.16" font-family="Arial" font-size="10.00">Layer 15 Residual Add 1</text>
<text text-anchor="middle" x="540" y="-2373.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-2362.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-2351.16" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer15_input_stage1&#45;&gt;layer15_residual1_stage1 -->
<g id="edge336" class="edge">
<title>layer15_input_stage1&#45;&gt;layer15_residual1_stage1</title>
<path fill="none" stroke="black" d="M620.42,-3007.64C665.6,-2972.13 713,-2920.21 713,-2858.7 713,-2858.7 713,-2858.7 713,-2592.7 713,-2532.74 735.73,-2508.4 703,-2458.16 692.19,-2441.56 677.12,-2427.91 660.46,-2416.75"/>
<polygon fill="black" stroke="black" points="661.94,-2413.54 651.62,-2411.14 658.19,-2419.45 661.94,-2413.54"/>
</g>
<!-- layer15_mha_qkt_stage1 -->
<g id="node258" class="node">
<title>layer15_mha_qkt_stage1</title>
<polygon fill="lightcoral" stroke="black" points="385,-2883.7 65,-2883.7 65,-2831.7 385,-2831.7 385,-2883.7"/>
<text text-anchor="middle" x="225" y="-2871.7" font-family="Arial" font-size="10.00">Layer 15 MHA QKT Calculation</text>
<text text-anchor="middle" x="225" y="-2860.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="225" y="-2849.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="225" y="-2838.7" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer15_mha_query_stage1&#45;&gt;layer15_mha_qkt_stage1 -->
<g id="edge328" class="edge">
<title>layer15_mha_query_stage1&#45;&gt;layer15_mha_qkt_stage1</title>
<path fill="none" stroke="black" d="M183.38,-2919.36C189.2,-2910.87 195.79,-2901.28 201.97,-2892.26"/>
<polygon fill="black" stroke="black" points="204.97,-2894.08 207.74,-2883.85 199.2,-2890.12 204.97,-2894.08"/>
</g>
<!-- layer15_mha_key_stage1&#45;&gt;layer15_mha_qkt_stage1 -->
<g id="edge329" class="edge">
<title>layer15_mha_key_stage1&#45;&gt;layer15_mha_qkt_stage1</title>
<path fill="none" stroke="black" d="M402.02,-2919.59C372.5,-2909.43 338.26,-2897.66 307.82,-2887.18"/>
<polygon fill="black" stroke="black" points="308.67,-2883.78 298.07,-2883.83 306.39,-2890.4 308.67,-2883.78"/>
</g>
<!-- layer15_mha_apply_stage1 -->
<g id="node260" class="node">
<title>layer15_mha_apply_stage1</title>
<polygon fill="lightcoral" stroke="black" points="646,-2707.7 334,-2707.7 334,-2655.7 646,-2655.7 646,-2707.7"/>
<text text-anchor="middle" x="490" y="-2695.7" font-family="Arial" font-size="10.00">Layer 15 MHA Apply Attention</text>
<text text-anchor="middle" x="490" y="-2684.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="490" y="-2673.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="490" y="-2662.7" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer15_mha_value_stage1&#45;&gt;layer15_mha_apply_stage1 -->
<g id="edge332" class="edge">
<title>layer15_mha_value_stage1&#45;&gt;layer15_mha_apply_stage1</title>
<path fill="none" stroke="black" d="M540.42,-2831.39C530.25,-2801.41 513.26,-2751.29 501.84,-2717.62"/>
<polygon fill="black" stroke="black" points="505.02,-2716.09 498.49,-2707.74 498.39,-2718.34 505.02,-2716.09"/>
</g>
<!-- layer15_mha_weights_stage1 -->
<g id="node259" class="node">
<title>layer15_mha_weights_stage1</title>
<polygon fill="lightcoral" stroke="black" points="429,-2795.7 109,-2795.7 109,-2743.7 429,-2743.7 429,-2795.7"/>
<text text-anchor="middle" x="269" y="-2783.7" font-family="Arial" font-size="10.00">Layer 15 MHA Attention Weights</text>
<text text-anchor="middle" x="269" y="-2772.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="269" y="-2761.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="269" y="-2750.7" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer15_mha_qkt_stage1&#45;&gt;layer15_mha_weights_stage1 -->
<g id="edge330" class="edge">
<title>layer15_mha_qkt_stage1&#45;&gt;layer15_mha_weights_stage1</title>
<path fill="none" stroke="black" d="M237.96,-2831.36C242.22,-2823.05 247.01,-2813.67 251.54,-2804.82"/>
<polygon fill="black" stroke="black" points="254.69,-2806.35 256.13,-2795.85 248.46,-2803.16 254.69,-2806.35"/>
</g>
<!-- layer15_mha_weights_stage1&#45;&gt;layer15_mha_apply_stage1 -->
<g id="edge331" class="edge">
<title>layer15_mha_weights_stage1&#45;&gt;layer15_mha_apply_stage1</title>
<path fill="none" stroke="black" d="M333.52,-2743.59C359.27,-2733.57 389.09,-2721.96 415.74,-2711.59"/>
<polygon fill="black" stroke="black" points="417.35,-2714.72 425.4,-2707.83 414.81,-2708.2 417.35,-2714.72"/>
</g>
<!-- layer15_mha_out_stage1 -->
<g id="node261" class="node">
<title>layer15_mha_out_stage1</title>
<polygon fill="pink" stroke="black" points="634.5,-2619.7 345.5,-2619.7 345.5,-2567.7 634.5,-2567.7 634.5,-2619.7"/>
<text text-anchor="middle" x="490" y="-2607.7" font-family="Arial" font-size="10.00">Layer 15 MHA Output Linear</text>
<text text-anchor="middle" x="490" y="-2596.7" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="490" y="-2585.7" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-2574.7" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer15_mha_apply_stage1&#45;&gt;layer15_mha_out_stage1 -->
<g id="edge333" class="edge">
<title>layer15_mha_apply_stage1&#45;&gt;layer15_mha_out_stage1</title>
<path fill="none" stroke="black" d="M490,-2655.36C490,-2647.4 490,-2638.46 490,-2629.94"/>
<polygon fill="black" stroke="black" points="493.5,-2629.85 490,-2619.85 486.5,-2629.85 493.5,-2629.85"/>
</g>
<!-- layer15_mha_allreduce_stage1 -->
<g id="node262" class="node">
<title>layer15_mha_allreduce_stage1</title>
<ellipse fill="lightgray" stroke="black" cx="490" cy="-2494.93" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="490" y="-2508.93" font-family="Arial" font-size="10.00">Layer 15 MHA All&#45;reduce</text>
<text text-anchor="middle" x="490" y="-2497.93" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-2486.93" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-2475.93" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer15_mha_out_stage1&#45;&gt;layer15_mha_allreduce_stage1 -->
<g id="edge334" class="edge">
<title>layer15_mha_out_stage1&#45;&gt;layer15_mha_allreduce_stage1</title>
<path fill="none" stroke="black" d="M490,-2567.52C490,-2559.71 490,-2550.85 490,-2542.08"/>
<polygon fill="black" stroke="black" points="493.5,-2541.9 490,-2531.9 486.5,-2541.9 493.5,-2541.9"/>
</g>
<!-- layer15_mha_allreduce_stage1&#45;&gt;layer15_residual1_stage1 -->
<g id="edge335" class="edge">
<title>layer15_mha_allreduce_stage1&#45;&gt;layer15_residual1_stage1</title>
<path fill="none" stroke="black" d="M504.6,-2458.09C508.19,-2449.27 512.12,-2439.61 516.03,-2430.02"/>
<polygon fill="black" stroke="black" points="519.37,-2431.08 519.9,-2420.5 512.89,-2428.44 519.37,-2431.08"/>
</g>
<!-- layer15_layernorm1_stage1 -->
<g id="node264" class="node">
<title>layer15_layernorm1_stage1</title>
<polygon fill="lightgreen" stroke="black" points="684.5,-2282.16 395.5,-2282.16 395.5,-2230.16 684.5,-2230.16 684.5,-2282.16"/>
<text text-anchor="middle" x="540" y="-2270.16" font-family="Arial" font-size="10.00">Layer 15 Layer Norm 1</text>
<text text-anchor="middle" x="540" y="-2259.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-2248.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-2237.16" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer15_residual1_stage1&#45;&gt;layer15_layernorm1_stage1 -->
<g id="edge337" class="edge">
<title>layer15_residual1_stage1&#45;&gt;layer15_layernorm1_stage1</title>
<path fill="none" stroke="black" d="M540,-2318.07C540,-2309.41 540,-2300.58 540,-2292.44"/>
<polygon fill="black" stroke="black" points="543.5,-2292.2 540,-2282.2 536.5,-2292.2 543.5,-2292.2"/>
</g>
<!-- layer15_mlp_gate_stage1 -->
<g id="node265" class="node">
<title>layer15_mlp_gate_stage1</title>
<polygon fill="lightyellow" stroke="black" points="449.5,-2194.16 162.5,-2194.16 162.5,-2142.16 449.5,-2142.16 449.5,-2194.16"/>
<text text-anchor="middle" x="306" y="-2182.16" font-family="Arial" font-size="10.00">Layer 15 MLP Gate Linear</text>
<text text-anchor="middle" x="306" y="-2171.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="306" y="-2160.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="306" y="-2149.16" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer15_layernorm1_stage1&#45;&gt;layer15_mlp_gate_stage1 -->
<g id="edge338" class="edge">
<title>layer15_layernorm1_stage1&#45;&gt;layer15_mlp_gate_stage1</title>
<path fill="none" stroke="black" d="M471.69,-2230.05C444.18,-2219.94 412.29,-2208.22 383.89,-2197.78"/>
<polygon fill="black" stroke="black" points="384.99,-2194.46 374.4,-2194.29 382.58,-2201.03 384.99,-2194.46"/>
</g>
<!-- layer15_mlp_up_stage1 -->
<g id="node266" class="node">
<title>layer15_mlp_up_stage1</title>
<polygon fill="lightyellow" stroke="black" points="683.5,-2106.16 396.5,-2106.16 396.5,-2054.16 683.5,-2054.16 683.5,-2106.16"/>
<text text-anchor="middle" x="540" y="-2094.16" font-family="Arial" font-size="10.00">Layer 15 MLP Up Linear</text>
<text text-anchor="middle" x="540" y="-2083.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-2072.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="540" y="-2061.16" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer15_layernorm1_stage1&#45;&gt;layer15_mlp_up_stage1 -->
<g id="edge339" class="edge">
<title>layer15_layernorm1_stage1&#45;&gt;layer15_mlp_up_stage1</title>
<path fill="none" stroke="black" d="M540,-2229.86C540,-2200 540,-2150.18 540,-2116.52"/>
<polygon fill="black" stroke="black" points="543.5,-2116.21 540,-2106.21 536.5,-2116.21 543.5,-2116.21"/>
</g>
<!-- layer15_residual2_stage1 -->
<g id="node270" class="node">
<title>layer15_residual2_stage1</title>
<polygon fill="lightblue" stroke="black" points="540,-1820.62 16,-1768.62 540,-1716.62 1064,-1768.62 540,-1820.62"/>
<text text-anchor="middle" x="540" y="-1782.62" font-family="Arial" font-size="10.00">Layer 15 Residual Add 2</text>
<text text-anchor="middle" x="540" y="-1771.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-1760.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-1749.62" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer15_layernorm1_stage1&#45;&gt;layer15_residual2_stage1 -->
<g id="edge345" class="edge">
<title>layer15_layernorm1_stage1&#45;&gt;layer15_residual2_stage1</title>
<path fill="none" stroke="black" d="M588.46,-2229.93C636.51,-2201.04 703,-2148.83 703,-2081.16 703,-2081.16 703,-2081.16 703,-1991.16 703,-1931.2 725.05,-1907.29 693,-1856.62 682.85,-1840.56 668.6,-1827.18 652.85,-1816.11"/>
<polygon fill="black" stroke="black" points="654.75,-1813.17 644.49,-1810.53 650.87,-1818.99 654.75,-1813.17"/>
</g>
<!-- layer15_mlp_gelu_stage1 -->
<g id="node267" class="node">
<title>layer15_mlp_gelu_stage1</title>
<polygon fill="orange" stroke="black" points="378.5,-2106.16 91.5,-2106.16 91.5,-2054.16 378.5,-2054.16 378.5,-2106.16"/>
<text text-anchor="middle" x="235" y="-2094.16" font-family="Arial" font-size="10.00">Layer 15 MLP GELU</text>
<text text-anchor="middle" x="235" y="-2083.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="235" y="-2072.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="235" y="-2061.16" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer15_mlp_gate_stage1&#45;&gt;layer15_mlp_gelu_stage1 -->
<g id="edge340" class="edge">
<title>layer15_mlp_gate_stage1&#45;&gt;layer15_mlp_gelu_stage1</title>
<path fill="none" stroke="black" d="M285.08,-2141.82C277.93,-2133.16 269.83,-2123.34 262.25,-2114.17"/>
<polygon fill="black" stroke="black" points="264.83,-2111.8 255.77,-2106.31 259.44,-2116.25 264.83,-2111.8"/>
</g>
<!-- layer15_mlp_down_stage1 -->
<g id="node268" class="node">
<title>layer15_mlp_down_stage1</title>
<polygon fill="lightyellow" stroke="black" points="624.5,-2018.16 335.5,-2018.16 335.5,-1966.16 624.5,-1966.16 624.5,-2018.16"/>
<text text-anchor="middle" x="480" y="-2006.16" font-family="Arial" font-size="10.00">Layer 15 MLP Down Linear</text>
<text text-anchor="middle" x="480" y="-1995.16" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="480" y="-1984.16" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-1973.16" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer15_mlp_up_stage1&#45;&gt;layer15_mlp_down_stage1 -->
<g id="edge342" class="edge">
<title>layer15_mlp_up_stage1&#45;&gt;layer15_mlp_down_stage1</title>
<path fill="none" stroke="black" d="M522.32,-2053.82C516.4,-2045.33 509.71,-2035.74 503.42,-2026.72"/>
<polygon fill="black" stroke="black" points="506.14,-2024.51 497.55,-2018.31 500.4,-2028.52 506.14,-2024.51"/>
</g>
<!-- layer15_mlp_gelu_stage1&#45;&gt;layer15_mlp_down_stage1 -->
<g id="edge341" class="edge">
<title>layer15_mlp_gelu_stage1&#45;&gt;layer15_mlp_down_stage1</title>
<path fill="none" stroke="black" d="M306.52,-2054.05C335.45,-2043.9 369,-2032.12 398.84,-2021.64"/>
<polygon fill="black" stroke="black" points="400.11,-2024.91 408.39,-2018.29 397.79,-2018.3 400.11,-2024.91"/>
</g>
<!-- layer15_mlp_allreduce_stage1 -->
<g id="node269" class="node">
<title>layer15_mlp_allreduce_stage1</title>
<ellipse fill="lightgray" stroke="black" cx="480" cy="-1893.39" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="480" y="-1907.39" font-family="Arial" font-size="10.00">Layer 15 MLP All&#45;reduce</text>
<text text-anchor="middle" x="480" y="-1896.39" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-1885.39" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-1874.39" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer15_mlp_down_stage1&#45;&gt;layer15_mlp_allreduce_stage1 -->
<g id="edge343" class="edge">
<title>layer15_mlp_down_stage1&#45;&gt;layer15_mlp_allreduce_stage1</title>
<path fill="none" stroke="black" d="M480,-1965.98C480,-1958.18 480,-1949.31 480,-1940.54"/>
<polygon fill="black" stroke="black" points="483.5,-1940.36 480,-1930.36 476.5,-1940.36 483.5,-1940.36"/>
</g>
<!-- layer15_mlp_allreduce_stage1&#45;&gt;layer15_residual2_stage1 -->
<g id="edge344" class="edge">
<title>layer15_mlp_allreduce_stage1&#45;&gt;layer15_residual2_stage1</title>
<path fill="none" stroke="black" d="M497.52,-1856.55C501.96,-1847.44 506.86,-1837.43 511.7,-1827.53"/>
<polygon fill="black" stroke="black" points="514.86,-1829.03 516.11,-1818.51 508.57,-1825.96 514.86,-1829.03"/>
</g>
<!-- layer15_layernorm2_stage1 -->
<g id="node271" class="node">
<title>layer15_layernorm2_stage1</title>
<polygon fill="lightgreen" stroke="black" points="684.5,-1680.62 395.5,-1680.62 395.5,-1628.62 684.5,-1628.62 684.5,-1680.62"/>
<text text-anchor="middle" x="540" y="-1668.62" font-family="Arial" font-size="10.00">Layer 15 Layer Norm 2</text>
<text text-anchor="middle" x="540" y="-1657.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-1646.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-1635.62" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer15_residual2_stage1&#45;&gt;layer15_layernorm2_stage1 -->
<g id="edge346" class="edge">
<title>layer15_residual2_stage1&#45;&gt;layer15_layernorm2_stage1</title>
<path fill="none" stroke="black" d="M540,-1716.53C540,-1707.87 540,-1699.05 540,-1690.9"/>
<polygon fill="black" stroke="black" points="543.5,-1690.66 540,-1680.66 536.5,-1690.66 543.5,-1690.66"/>
</g>
<!-- layer16_input_stage1 -->
<g id="node272" class="node">
<title>layer16_input_stage1</title>
<polygon fill="lightyellow" stroke="black" points="839.74,-1592.62 362.92,-1592.62 240.26,-1488.62 717.08,-1488.62 839.74,-1592.62"/>
<text text-anchor="middle" x="540" y="-1554.62" font-family="Arial" font-size="10.00">Layer 16 Input</text>
<text text-anchor="middle" x="540" y="-1543.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-1532.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-1521.62" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer15_layernorm2_stage1&#45;&gt;layer16_input_stage1 -->
<g id="edge347" class="edge">
<title>layer15_layernorm2_stage1&#45;&gt;layer16_input_stage1</title>
<path fill="none" stroke="black" d="M540,-1628.48C540,-1620.8 540,-1611.98 540,-1602.99"/>
<polygon fill="black" stroke="black" points="543.5,-1602.8 540,-1592.8 536.5,-1602.8 543.5,-1602.8"/>
</g>
<!-- layer16_mha_query_stage1 -->
<g id="node273" class="node">
<title>layer16_mha_query_stage1</title>
<polygon fill="pink" stroke="black" points="311.5,-1452.62 20.5,-1452.62 20.5,-1400.62 311.5,-1400.62 311.5,-1452.62"/>
<text text-anchor="middle" x="166" y="-1440.62" font-family="Arial" font-size="10.00">Layer 16 MHA Query Linear</text>
<text text-anchor="middle" x="166" y="-1429.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="166" y="-1418.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_q=512]</text>
<text text-anchor="middle" x="166" y="-1407.62" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer16_input_stage1&#45;&gt;layer16_mha_query_stage1 -->
<g id="edge348" class="edge">
<title>layer16_input_stage1&#45;&gt;layer16_mha_query_stage1</title>
<path fill="none" stroke="black" d="M369.69,-1488.62C331.78,-1477.26 292.96,-1465.64 259.51,-1455.62"/>
<polygon fill="black" stroke="black" points="260.35,-1452.22 249.76,-1452.7 258.34,-1458.92 260.35,-1452.22"/>
</g>
<!-- layer16_mha_key_stage1 -->
<g id="node274" class="node">
<title>layer16_mha_key_stage1</title>
<polygon fill="pink" stroke="black" points="620.5,-1452.62 329.5,-1452.62 329.5,-1400.62 620.5,-1400.62 620.5,-1452.62"/>
<text text-anchor="middle" x="475" y="-1440.62" font-family="Arial" font-size="10.00">Layer 16 MHA Key Linear</text>
<text text-anchor="middle" x="475" y="-1429.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="475" y="-1418.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="475" y="-1407.62" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer16_input_stage1&#45;&gt;layer16_mha_key_stage1 -->
<g id="edge349" class="edge">
<title>layer16_input_stage1&#45;&gt;layer16_mha_key_stage1</title>
<path fill="none" stroke="black" d="M510.35,-1488.53C505.04,-1479.38 499.63,-1470.05 494.69,-1461.54"/>
<polygon fill="black" stroke="black" points="497.58,-1459.55 489.53,-1452.66 491.53,-1463.07 497.58,-1459.55"/>
</g>
<!-- layer16_mha_value_stage1 -->
<g id="node275" class="node">
<title>layer16_mha_value_stage1</title>
<polygon fill="pink" stroke="black" points="694.5,-1364.62 403.5,-1364.62 403.5,-1312.62 694.5,-1312.62 694.5,-1364.62"/>
<text text-anchor="middle" x="549" y="-1352.62" font-family="Arial" font-size="10.00">Layer 16 MHA Value Linear</text>
<text text-anchor="middle" x="549" y="-1341.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="549" y="-1330.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_v=512]</text>
<text text-anchor="middle" x="549" y="-1319.62" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer16_input_stage1&#45;&gt;layer16_mha_value_stage1 -->
<g id="edge350" class="edge">
<title>layer16_input_stage1&#45;&gt;layer16_mha_value_stage1</title>
<path fill="none" stroke="black" d="M606.33,-1488.31C615.97,-1477.63 624.48,-1465.62 630,-1452.62 639.02,-1431.34 640.32,-1421.3 630,-1400.62 624.3,-1389.18 615.31,-1379.33 605.37,-1371.07"/>
<polygon fill="black" stroke="black" points="607.29,-1368.14 597.24,-1364.8 603.02,-1373.68 607.29,-1368.14"/>
</g>
<!-- layer16_residual1_stage1 -->
<g id="node281" class="node">
<title>layer16_residual1_stage1</title>
<polygon fill="lightblue" stroke="black" points="540,-903.08 16,-851.08 540,-799.08 1064,-851.08 540,-903.08"/>
<text text-anchor="middle" x="540" y="-865.08" font-family="Arial" font-size="10.00">Layer 16 Residual Add 1</text>
<text text-anchor="middle" x="540" y="-854.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-843.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-832.08" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer16_input_stage1&#45;&gt;layer16_residual1_stage1 -->
<g id="edge359" class="edge">
<title>layer16_input_stage1&#45;&gt;layer16_residual1_stage1</title>
<path fill="none" stroke="black" d="M620.42,-1488.56C665.6,-1453.05 713,-1401.14 713,-1339.62 713,-1339.62 713,-1339.62 713,-1073.62 713,-1013.66 735.73,-989.32 703,-939.08 692.19,-922.48 677.12,-908.83 660.46,-897.67"/>
<polygon fill="black" stroke="black" points="661.94,-894.47 651.62,-892.06 658.19,-900.38 661.94,-894.47"/>
</g>
<!-- layer16_mha_qkt_stage1 -->
<g id="node276" class="node">
<title>layer16_mha_qkt_stage1</title>
<polygon fill="lightcoral" stroke="black" points="385,-1364.62 65,-1364.62 65,-1312.62 385,-1312.62 385,-1364.62"/>
<text text-anchor="middle" x="225" y="-1352.62" font-family="Arial" font-size="10.00">Layer 16 MHA QKT Calculation</text>
<text text-anchor="middle" x="225" y="-1341.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_k=512]</text>
<text text-anchor="middle" x="225" y="-1330.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="225" y="-1319.62" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer16_mha_query_stage1&#45;&gt;layer16_mha_qkt_stage1 -->
<g id="edge351" class="edge">
<title>layer16_mha_query_stage1&#45;&gt;layer16_mha_qkt_stage1</title>
<path fill="none" stroke="black" d="M183.38,-1400.28C189.2,-1391.79 195.79,-1382.2 201.97,-1373.18"/>
<polygon fill="black" stroke="black" points="204.97,-1375 207.74,-1364.77 199.2,-1371.04 204.97,-1375"/>
</g>
<!-- layer16_mha_key_stage1&#45;&gt;layer16_mha_qkt_stage1 -->
<g id="edge352" class="edge">
<title>layer16_mha_key_stage1&#45;&gt;layer16_mha_qkt_stage1</title>
<path fill="none" stroke="black" d="M402.02,-1400.51C372.5,-1390.36 338.26,-1378.58 307.82,-1368.11"/>
<polygon fill="black" stroke="black" points="308.67,-1364.7 298.07,-1364.75 306.39,-1371.32 308.67,-1364.7"/>
</g>
<!-- layer16_mha_apply_stage1 -->
<g id="node278" class="node">
<title>layer16_mha_apply_stage1</title>
<polygon fill="lightcoral" stroke="black" points="646,-1188.62 334,-1188.62 334,-1136.62 646,-1136.62 646,-1188.62"/>
<text text-anchor="middle" x="490" y="-1176.62" font-family="Arial" font-size="10.00">Layer 16 MHA Apply Attention</text>
<text text-anchor="middle" x="490" y="-1165.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="490" y="-1154.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="490" y="-1143.62" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer16_mha_value_stage1&#45;&gt;layer16_mha_apply_stage1 -->
<g id="edge355" class="edge">
<title>layer16_mha_value_stage1&#45;&gt;layer16_mha_apply_stage1</title>
<path fill="none" stroke="black" d="M540.42,-1312.32C530.25,-1282.33 513.26,-1232.21 501.84,-1198.55"/>
<polygon fill="black" stroke="black" points="505.02,-1197.01 498.49,-1188.67 498.39,-1199.26 505.02,-1197.01"/>
</g>
<!-- layer16_mha_weights_stage1 -->
<g id="node277" class="node">
<title>layer16_mha_weights_stage1</title>
<polygon fill="lightcoral" stroke="black" points="457,-1276.62 137,-1276.62 137,-1224.62 457,-1224.62 457,-1276.62"/>
<text text-anchor="middle" x="297" y="-1264.62" font-family="Arial" font-size="10.00">Layer 16 MHA Attention Weights</text>
<text text-anchor="middle" x="297" y="-1253.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="297" y="-1242.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, heads=2, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="297" y="-1231.62" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer16_mha_qkt_stage1&#45;&gt;layer16_mha_weights_stage1 -->
<g id="edge353" class="edge">
<title>layer16_mha_qkt_stage1&#45;&gt;layer16_mha_weights_stage1</title>
<path fill="none" stroke="black" d="M246.21,-1312.28C253.46,-1303.62 261.68,-1293.8 269.36,-1284.63"/>
<polygon fill="black" stroke="black" points="272.2,-1286.69 275.94,-1276.77 266.84,-1282.19 272.2,-1286.69"/>
</g>
<!-- layer16_mha_weights_stage1&#45;&gt;layer16_mha_apply_stage1 -->
<g id="edge354" class="edge">
<title>layer16_mha_weights_stage1&#45;&gt;layer16_mha_apply_stage1</title>
<path fill="none" stroke="black" d="M353.34,-1224.51C375.54,-1214.62 401.19,-1203.19 424.23,-1192.92"/>
<polygon fill="black" stroke="black" points="425.88,-1196.02 433.59,-1188.75 423.03,-1189.63 425.88,-1196.02"/>
</g>
<!-- layer16_mha_out_stage1 -->
<g id="node279" class="node">
<title>layer16_mha_out_stage1</title>
<polygon fill="pink" stroke="black" points="634.5,-1100.62 345.5,-1100.62 345.5,-1048.62 634.5,-1048.62 634.5,-1100.62"/>
<text text-anchor="middle" x="490" y="-1088.62" font-family="Arial" font-size="10.00">Layer 16 MHA Output Linear</text>
<text text-anchor="middle" x="490" y="-1077.62" font-family="Arial" font-size="10.00">Input: [batch_size=1024, heads=2, seq_len=10000, d_v=512]</text>
<text text-anchor="middle" x="490" y="-1066.62" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-1055.62" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer16_mha_apply_stage1&#45;&gt;layer16_mha_out_stage1 -->
<g id="edge356" class="edge">
<title>layer16_mha_apply_stage1&#45;&gt;layer16_mha_out_stage1</title>
<path fill="none" stroke="black" d="M490,-1136.28C490,-1128.32 490,-1119.38 490,-1110.86"/>
<polygon fill="black" stroke="black" points="493.5,-1110.77 490,-1100.77 486.5,-1110.77 493.5,-1110.77"/>
</g>
<!-- layer16_mha_allreduce_stage1 -->
<g id="node280" class="node">
<title>layer16_mha_allreduce_stage1</title>
<ellipse fill="lightgray" stroke="black" cx="490" cy="-975.85" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="490" y="-989.85" font-family="Arial" font-size="10.00">Layer 16 MHA All&#45;reduce</text>
<text text-anchor="middle" x="490" y="-978.85" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-967.85" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="490" y="-956.85" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer16_mha_out_stage1&#45;&gt;layer16_mha_allreduce_stage1 -->
<g id="edge357" class="edge">
<title>layer16_mha_out_stage1&#45;&gt;layer16_mha_allreduce_stage1</title>
<path fill="none" stroke="black" d="M490,-1048.44C490,-1040.64 490,-1031.77 490,-1023"/>
<polygon fill="black" stroke="black" points="493.5,-1022.82 490,-1012.82 486.5,-1022.82 493.5,-1022.82"/>
</g>
<!-- layer16_mha_allreduce_stage1&#45;&gt;layer16_residual1_stage1 -->
<g id="edge358" class="edge">
<title>layer16_mha_allreduce_stage1&#45;&gt;layer16_residual1_stage1</title>
<path fill="none" stroke="black" d="M504.6,-939.01C508.19,-930.2 512.12,-920.53 516.03,-910.95"/>
<polygon fill="black" stroke="black" points="519.37,-912 519.9,-901.42 512.89,-909.36 519.37,-912"/>
</g>
<!-- layer16_layernorm1_stage1 -->
<g id="node282" class="node">
<title>layer16_layernorm1_stage1</title>
<polygon fill="lightgreen" stroke="black" points="684.5,-763.08 395.5,-763.08 395.5,-711.08 684.5,-711.08 684.5,-763.08"/>
<text text-anchor="middle" x="540" y="-751.08" font-family="Arial" font-size="10.00">Layer 16 Layer Norm 1</text>
<text text-anchor="middle" x="540" y="-740.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-729.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-718.08" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer16_residual1_stage1&#45;&gt;layer16_layernorm1_stage1 -->
<g id="edge360" class="edge">
<title>layer16_residual1_stage1&#45;&gt;layer16_layernorm1_stage1</title>
<path fill="none" stroke="black" d="M540,-798.99C540,-790.33 540,-781.51 540,-773.36"/>
<polygon fill="black" stroke="black" points="543.5,-773.12 540,-763.12 536.5,-773.12 543.5,-773.12"/>
</g>
<!-- layer16_mlp_gate_stage1 -->
<g id="node283" class="node">
<title>layer16_mlp_gate_stage1</title>
<polygon fill="lightyellow" stroke="black" points="449.5,-675.08 162.5,-675.08 162.5,-623.08 449.5,-623.08 449.5,-675.08"/>
<text text-anchor="middle" x="306" y="-663.08" font-family="Arial" font-size="10.00">Layer 16 MLP Gate Linear</text>
<text text-anchor="middle" x="306" y="-652.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="306" y="-641.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="306" y="-630.08" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer16_layernorm1_stage1&#45;&gt;layer16_mlp_gate_stage1 -->
<g id="edge361" class="edge">
<title>layer16_layernorm1_stage1&#45;&gt;layer16_mlp_gate_stage1</title>
<path fill="none" stroke="black" d="M471.69,-710.97C444.18,-700.86 412.29,-689.14 383.89,-678.7"/>
<polygon fill="black" stroke="black" points="384.99,-675.38 374.4,-675.22 382.58,-681.95 384.99,-675.38"/>
</g>
<!-- layer16_mlp_up_stage1 -->
<g id="node284" class="node">
<title>layer16_mlp_up_stage1</title>
<polygon fill="lightyellow" stroke="black" points="683.5,-587.08 396.5,-587.08 396.5,-535.08 683.5,-535.08 683.5,-587.08"/>
<text text-anchor="middle" x="540" y="-575.08" font-family="Arial" font-size="10.00">Layer 16 MLP Up Linear</text>
<text text-anchor="middle" x="540" y="-564.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-553.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="540" y="-542.08" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer16_layernorm1_stage1&#45;&gt;layer16_mlp_up_stage1 -->
<g id="edge362" class="edge">
<title>layer16_layernorm1_stage1&#45;&gt;layer16_mlp_up_stage1</title>
<path fill="none" stroke="black" d="M540,-710.78C540,-680.92 540,-631.1 540,-597.44"/>
<polygon fill="black" stroke="black" points="543.5,-597.13 540,-587.13 536.5,-597.13 543.5,-597.13"/>
</g>
<!-- layer16_residual2_stage1 -->
<g id="node288" class="node">
<title>layer16_residual2_stage1</title>
<polygon fill="lightblue" stroke="black" points="540,-301.54 16,-249.54 540,-197.54 1064,-249.54 540,-301.54"/>
<text text-anchor="middle" x="540" y="-263.54" font-family="Arial" font-size="10.00">Layer 16 Residual Add 2</text>
<text text-anchor="middle" x="540" y="-252.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192], [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-241.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-230.54" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer16_layernorm1_stage1&#45;&gt;layer16_residual2_stage1 -->
<g id="edge368" class="edge">
<title>layer16_layernorm1_stage1&#45;&gt;layer16_residual2_stage1</title>
<path fill="none" stroke="black" d="M588.46,-710.85C636.51,-681.96 703,-629.76 703,-562.08 703,-562.08 703,-562.08 703,-472.08 703,-412.12 725.05,-388.21 693,-337.54 682.85,-321.49 668.6,-308.1 652.85,-297.03"/>
<polygon fill="black" stroke="black" points="654.75,-294.09 644.49,-291.45 650.87,-299.91 654.75,-294.09"/>
</g>
<!-- layer16_mlp_gelu_stage1 -->
<g id="node285" class="node">
<title>layer16_mlp_gelu_stage1</title>
<polygon fill="orange" stroke="black" points="378.5,-587.08 91.5,-587.08 91.5,-535.08 378.5,-535.08 378.5,-587.08"/>
<text text-anchor="middle" x="235" y="-575.08" font-family="Arial" font-size="10.00">Layer 16 MLP GELU</text>
<text text-anchor="middle" x="235" y="-564.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="235" y="-553.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="235" y="-542.08" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer16_mlp_gate_stage1&#45;&gt;layer16_mlp_gelu_stage1 -->
<g id="edge363" class="edge">
<title>layer16_mlp_gate_stage1&#45;&gt;layer16_mlp_gelu_stage1</title>
<path fill="none" stroke="black" d="M285.08,-622.74C277.93,-614.08 269.83,-604.26 262.25,-595.09"/>
<polygon fill="black" stroke="black" points="264.83,-592.72 255.77,-587.23 259.44,-597.17 264.83,-592.72"/>
</g>
<!-- layer16_mlp_down_stage1 -->
<g id="node286" class="node">
<title>layer16_mlp_down_stage1</title>
<polygon fill="lightyellow" stroke="black" points="624.5,-499.08 335.5,-499.08 335.5,-447.08 624.5,-447.08 624.5,-499.08"/>
<text text-anchor="middle" x="480" y="-487.08" font-family="Arial" font-size="10.00">Layer 16 MLP Down Linear</text>
<text text-anchor="middle" x="480" y="-476.08" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, mlp_hidden=4096]</text>
<text text-anchor="middle" x="480" y="-465.08" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-454.08" font-family="Arial" font-size="10.00">GPU: Each shard 8&#45;15</text>
</g>
<!-- layer16_mlp_up_stage1&#45;&gt;layer16_mlp_down_stage1 -->
<g id="edge365" class="edge">
<title>layer16_mlp_up_stage1&#45;&gt;layer16_mlp_down_stage1</title>
<path fill="none" stroke="black" d="M522.32,-534.74C516.4,-526.25 509.71,-516.66 503.42,-507.64"/>
<polygon fill="black" stroke="black" points="506.14,-505.43 497.55,-499.23 500.4,-509.44 506.14,-505.43"/>
</g>
<!-- layer16_mlp_gelu_stage1&#45;&gt;layer16_mlp_down_stage1 -->
<g id="edge364" class="edge">
<title>layer16_mlp_gelu_stage1&#45;&gt;layer16_mlp_down_stage1</title>
<path fill="none" stroke="black" d="M306.52,-534.97C335.45,-524.82 369,-513.04 398.84,-502.57"/>
<polygon fill="black" stroke="black" points="400.11,-505.83 408.39,-499.22 397.79,-499.23 400.11,-505.83"/>
</g>
<!-- layer16_mlp_allreduce_stage1 -->
<g id="node287" class="node">
<title>layer16_mlp_allreduce_stage1</title>
<ellipse fill="lightgray" stroke="black" cx="480" cy="-374.31" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="480" y="-388.31" font-family="Arial" font-size="10.00">Layer 16 MLP All&#45;reduce</text>
<text text-anchor="middle" x="480" y="-377.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-366.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="480" y="-355.31" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer16_mlp_down_stage1&#45;&gt;layer16_mlp_allreduce_stage1 -->
<g id="edge366" class="edge">
<title>layer16_mlp_down_stage1&#45;&gt;layer16_mlp_allreduce_stage1</title>
<path fill="none" stroke="black" d="M480,-446.91C480,-439.1 480,-430.23 480,-421.46"/>
<polygon fill="black" stroke="black" points="483.5,-421.29 480,-411.29 476.5,-421.29 483.5,-421.29"/>
</g>
<!-- layer16_mlp_allreduce_stage1&#45;&gt;layer16_residual2_stage1 -->
<g id="edge367" class="edge">
<title>layer16_mlp_allreduce_stage1&#45;&gt;layer16_residual2_stage1</title>
<path fill="none" stroke="black" d="M497.52,-337.47C501.96,-328.37 506.86,-318.35 511.7,-308.45"/>
<polygon fill="black" stroke="black" points="514.86,-309.95 516.11,-299.43 508.57,-306.88 514.86,-309.95"/>
</g>
<!-- layer16_layernorm2_stage1 -->
<g id="node289" class="node">
<title>layer16_layernorm2_stage1</title>
<polygon fill="lightgreen" stroke="black" points="684.5,-161.54 395.5,-161.54 395.5,-109.54 684.5,-109.54 684.5,-161.54"/>
<text text-anchor="middle" x="540" y="-149.54" font-family="Arial" font-size="10.00">Layer 16 Layer Norm 2</text>
<text text-anchor="middle" x="540" y="-138.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-127.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-116.54" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer16_residual2_stage1&#45;&gt;layer16_layernorm2_stage1 -->
<g id="edge369" class="edge">
<title>layer16_residual2_stage1&#45;&gt;layer16_layernorm2_stage1</title>
<path fill="none" stroke="black" d="M540,-197.46C540,-188.79 540,-179.97 540,-171.82"/>
<polygon fill="black" stroke="black" points="543.5,-171.58 540,-161.58 536.5,-171.58 543.5,-171.58"/>
</g>
<!-- output -->
<g id="node291" class="node">
<title>output</title>
<ellipse fill="red" stroke="black" cx="540" cy="-36.77" rx="204.21" ry="36.54"/>
<text text-anchor="middle" x="540" y="-50.77" font-family="Arial" font-size="10.00">Final Output</text>
<text text-anchor="middle" x="540" y="-39.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-28.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="540" y="-17.77" font-family="Arial" font-size="10.00">GPU: All devices 8&#45;15</text>
</g>
<!-- layer16_layernorm2_stage1&#45;&gt;output -->
<g id="edge370" class="edge">
<title>layer16_layernorm2_stage1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M540,-109.37C540,-101.56 540,-92.69 540,-83.92"/>
<polygon fill="black" stroke="black" points="543.5,-83.75 540,-73.75 536.5,-83.75 543.5,-83.75"/>
</g>
<!-- pipeline_communication&#45;&gt;layer9_input_stage1 -->
<g id="edge186" class="edge">
<title>pipeline_communication&#45;&gt;layer9_input_stage1</title>
<path fill="none" stroke="black" d="M550,-12280.05C550,-12266.81 550,-12251.41 550,-12236.56"/>
<polygon fill="black" stroke="black" points="553.5,-12236.39 550,-12226.39 546.5,-12236.39 553.5,-12236.39"/>
</g>
</g>
</svg>
