digraph baseline_dag {
	compound=true concentrate=true rankdir=TB
	node [fontname=Arial fontsize=10]
	edge [fontname=Arial fontsize=8]
	input [label="Input\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=4096]\nGPU: all GPUs" fillcolor=lightblue shape=ellipse style=filled]
	subgraph cluster_pipeline_stage_0 {
		bgcolor=lightgray fillcolor=lightgray label="Pipeline Stage 0\nDevices: 0-7\nLayers: 0,1" style=rounded
		subgraph cluster_layer_0 {
			label="Layer 0" style=rounded
			l0_split_q_0 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 0" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_k_0 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 0" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_v_0 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 0" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_q_proj_0 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 0" fillcolor=lightcoral shape=rectangle style=filled]
			l0_k_proj_0 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 0" fillcolor=lightcoral shape=rectangle style=filled]
			l0_v_proj_0 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 0" fillcolor=lightcoral shape=rectangle style=filled]
			l0_mha_0 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 0" fillcolor=lightgreen shape=rectangle style=filled]
			l0_mlp_fc_0 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 0" fillcolor=lightpink shape=rectangle style=filled]
			l0_mlp_proj_0 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 0" fillcolor=lightpink shape=rectangle style=filled]
			l0_residual_0 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 0" fillcolor=lightsteelblue shape=rectangle style=filled]
			l0_concat_0 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 0" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_q_1 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 1" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_k_1 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 1" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_v_1 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 1" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_q_proj_1 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 1" fillcolor=lightcoral shape=rectangle style=filled]
			l0_k_proj_1 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 1" fillcolor=lightcoral shape=rectangle style=filled]
			l0_v_proj_1 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 1" fillcolor=lightcoral shape=rectangle style=filled]
			l0_mha_1 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 1" fillcolor=lightgreen shape=rectangle style=filled]
			l0_mlp_fc_1 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 1" fillcolor=lightpink shape=rectangle style=filled]
			l0_mlp_proj_1 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 1" fillcolor=lightpink shape=rectangle style=filled]
			l0_residual_1 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 1" fillcolor=lightsteelblue shape=rectangle style=filled]
			l0_concat_1 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 1" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_q_2 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 2" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_k_2 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 2" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_v_2 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 2" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_q_proj_2 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 2" fillcolor=lightcoral shape=rectangle style=filled]
			l0_k_proj_2 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 2" fillcolor=lightcoral shape=rectangle style=filled]
			l0_v_proj_2 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 2" fillcolor=lightcoral shape=rectangle style=filled]
			l0_mha_2 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 2" fillcolor=lightgreen shape=rectangle style=filled]
			l0_mlp_fc_2 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 2" fillcolor=lightpink shape=rectangle style=filled]
			l0_mlp_proj_2 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 2" fillcolor=lightpink shape=rectangle style=filled]
			l0_residual_2 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 2" fillcolor=lightsteelblue shape=rectangle style=filled]
			l0_concat_2 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 2" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_q_3 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 3" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_k_3 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 3" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_v_3 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 3" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_q_proj_3 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 3" fillcolor=lightcoral shape=rectangle style=filled]
			l0_k_proj_3 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 3" fillcolor=lightcoral shape=rectangle style=filled]
			l0_v_proj_3 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 3" fillcolor=lightcoral shape=rectangle style=filled]
			l0_mha_3 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 3" fillcolor=lightgreen shape=rectangle style=filled]
			l0_mlp_fc_3 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 3" fillcolor=lightpink shape=rectangle style=filled]
			l0_mlp_proj_3 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 3" fillcolor=lightpink shape=rectangle style=filled]
			l0_residual_3 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 3" fillcolor=lightsteelblue shape=rectangle style=filled]
			l0_concat_3 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 3" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_q_4 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 4" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_k_4 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 4" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_v_4 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 4" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_q_proj_4 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 4" fillcolor=lightcoral shape=rectangle style=filled]
			l0_k_proj_4 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 4" fillcolor=lightcoral shape=rectangle style=filled]
			l0_v_proj_4 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 4" fillcolor=lightcoral shape=rectangle style=filled]
			l0_mha_4 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 4" fillcolor=lightgreen shape=rectangle style=filled]
			l0_mlp_fc_4 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 4" fillcolor=lightpink shape=rectangle style=filled]
			l0_mlp_proj_4 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 4" fillcolor=lightpink shape=rectangle style=filled]
			l0_residual_4 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 4" fillcolor=lightsteelblue shape=rectangle style=filled]
			l0_concat_4 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 4" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_q_5 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 5" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_k_5 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 5" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_v_5 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 5" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_q_proj_5 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 5" fillcolor=lightcoral shape=rectangle style=filled]
			l0_k_proj_5 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 5" fillcolor=lightcoral shape=rectangle style=filled]
			l0_v_proj_5 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 5" fillcolor=lightcoral shape=rectangle style=filled]
			l0_mha_5 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 5" fillcolor=lightgreen shape=rectangle style=filled]
			l0_mlp_fc_5 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 5" fillcolor=lightpink shape=rectangle style=filled]
			l0_mlp_proj_5 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 5" fillcolor=lightpink shape=rectangle style=filled]
			l0_residual_5 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 5" fillcolor=lightsteelblue shape=rectangle style=filled]
			l0_concat_5 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 5" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_q_6 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 6" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_k_6 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 6" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_v_6 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 6" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_q_proj_6 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 6" fillcolor=lightcoral shape=rectangle style=filled]
			l0_k_proj_6 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 6" fillcolor=lightcoral shape=rectangle style=filled]
			l0_v_proj_6 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 6" fillcolor=lightcoral shape=rectangle style=filled]
			l0_mha_6 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 6" fillcolor=lightgreen shape=rectangle style=filled]
			l0_mlp_fc_6 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 6" fillcolor=lightpink shape=rectangle style=filled]
			l0_mlp_proj_6 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 6" fillcolor=lightpink shape=rectangle style=filled]
			l0_residual_6 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 6" fillcolor=lightsteelblue shape=rectangle style=filled]
			l0_concat_6 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 6" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_q_7 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 7" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_k_7 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 7" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_split_v_7 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 7" fillcolor=lightyellow shape=parallelogram style=filled]
			l0_q_proj_7 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 7" fillcolor=lightcoral shape=rectangle style=filled]
			l0_k_proj_7 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 7" fillcolor=lightcoral shape=rectangle style=filled]
			l0_v_proj_7 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 7" fillcolor=lightcoral shape=rectangle style=filled]
			l0_mha_7 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 7" fillcolor=lightgreen shape=rectangle style=filled]
			l0_mlp_fc_7 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 7" fillcolor=lightpink shape=rectangle style=filled]
			l0_mlp_proj_7 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 7" fillcolor=lightpink shape=rectangle style=filled]
			l0_residual_7 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 7" fillcolor=lightsteelblue shape=rectangle style=filled]
			l0_concat_7 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 7" fillcolor=lightyellow shape=parallelogram style=filled]
		}
		subgraph cluster_layer_1 {
			label="Layer 1" style=rounded
			l1_split_q_0 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 0" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_k_0 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 0" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_v_0 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 0" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_q_proj_0 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 0" fillcolor=lightcoral shape=rectangle style=filled]
			l1_k_proj_0 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 0" fillcolor=lightcoral shape=rectangle style=filled]
			l1_v_proj_0 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 0" fillcolor=lightcoral shape=rectangle style=filled]
			l1_mha_0 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 0" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mlp_fc_0 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 0" fillcolor=lightpink shape=rectangle style=filled]
			l1_mlp_proj_0 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 0" fillcolor=lightpink shape=rectangle style=filled]
			l1_residual_0 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 0" fillcolor=lightsteelblue shape=rectangle style=filled]
			l1_concat_0 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 0" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_q_1 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 1" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_k_1 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 1" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_v_1 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 1" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_q_proj_1 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 1" fillcolor=lightcoral shape=rectangle style=filled]
			l1_k_proj_1 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 1" fillcolor=lightcoral shape=rectangle style=filled]
			l1_v_proj_1 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 1" fillcolor=lightcoral shape=rectangle style=filled]
			l1_mha_1 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 1" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mlp_fc_1 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 1" fillcolor=lightpink shape=rectangle style=filled]
			l1_mlp_proj_1 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 1" fillcolor=lightpink shape=rectangle style=filled]
			l1_residual_1 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 1" fillcolor=lightsteelblue shape=rectangle style=filled]
			l1_concat_1 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 1" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_q_2 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 2" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_k_2 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 2" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_v_2 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 2" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_q_proj_2 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 2" fillcolor=lightcoral shape=rectangle style=filled]
			l1_k_proj_2 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 2" fillcolor=lightcoral shape=rectangle style=filled]
			l1_v_proj_2 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 2" fillcolor=lightcoral shape=rectangle style=filled]
			l1_mha_2 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 2" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mlp_fc_2 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 2" fillcolor=lightpink shape=rectangle style=filled]
			l1_mlp_proj_2 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 2" fillcolor=lightpink shape=rectangle style=filled]
			l1_residual_2 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 2" fillcolor=lightsteelblue shape=rectangle style=filled]
			l1_concat_2 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 2" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_q_3 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 3" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_k_3 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 3" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_v_3 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 3" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_q_proj_3 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 3" fillcolor=lightcoral shape=rectangle style=filled]
			l1_k_proj_3 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 3" fillcolor=lightcoral shape=rectangle style=filled]
			l1_v_proj_3 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 3" fillcolor=lightcoral shape=rectangle style=filled]
			l1_mha_3 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 3" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mlp_fc_3 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 3" fillcolor=lightpink shape=rectangle style=filled]
			l1_mlp_proj_3 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 3" fillcolor=lightpink shape=rectangle style=filled]
			l1_residual_3 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 3" fillcolor=lightsteelblue shape=rectangle style=filled]
			l1_concat_3 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 3" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_q_4 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 4" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_k_4 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 4" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_v_4 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 4" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_q_proj_4 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 4" fillcolor=lightcoral shape=rectangle style=filled]
			l1_k_proj_4 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 4" fillcolor=lightcoral shape=rectangle style=filled]
			l1_v_proj_4 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 4" fillcolor=lightcoral shape=rectangle style=filled]
			l1_mha_4 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 4" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mlp_fc_4 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 4" fillcolor=lightpink shape=rectangle style=filled]
			l1_mlp_proj_4 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 4" fillcolor=lightpink shape=rectangle style=filled]
			l1_residual_4 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 4" fillcolor=lightsteelblue shape=rectangle style=filled]
			l1_concat_4 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 4" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_q_5 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 5" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_k_5 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 5" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_v_5 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 5" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_q_proj_5 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 5" fillcolor=lightcoral shape=rectangle style=filled]
			l1_k_proj_5 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 5" fillcolor=lightcoral shape=rectangle style=filled]
			l1_v_proj_5 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 5" fillcolor=lightcoral shape=rectangle style=filled]
			l1_mha_5 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 5" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mlp_fc_5 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 5" fillcolor=lightpink shape=rectangle style=filled]
			l1_mlp_proj_5 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 5" fillcolor=lightpink shape=rectangle style=filled]
			l1_residual_5 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 5" fillcolor=lightsteelblue shape=rectangle style=filled]
			l1_concat_5 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 5" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_q_6 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 6" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_k_6 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 6" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_v_6 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 6" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_q_proj_6 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 6" fillcolor=lightcoral shape=rectangle style=filled]
			l1_k_proj_6 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 6" fillcolor=lightcoral shape=rectangle style=filled]
			l1_v_proj_6 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 6" fillcolor=lightcoral shape=rectangle style=filled]
			l1_mha_6 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 6" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mlp_fc_6 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 6" fillcolor=lightpink shape=rectangle style=filled]
			l1_mlp_proj_6 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 6" fillcolor=lightpink shape=rectangle style=filled]
			l1_residual_6 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 6" fillcolor=lightsteelblue shape=rectangle style=filled]
			l1_concat_6 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 6" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_q_7 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 7" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_k_7 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 7" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_split_v_7 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 7" fillcolor=lightyellow shape=parallelogram style=filled]
			l1_q_proj_7 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 7" fillcolor=lightcoral shape=rectangle style=filled]
			l1_k_proj_7 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 7" fillcolor=lightcoral shape=rectangle style=filled]
			l1_v_proj_7 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 7" fillcolor=lightcoral shape=rectangle style=filled]
			l1_mha_7 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 7" fillcolor=lightgreen shape=rectangle style=filled]
			l1_mlp_fc_7 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 7" fillcolor=lightpink shape=rectangle style=filled]
			l1_mlp_proj_7 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 7" fillcolor=lightpink shape=rectangle style=filled]
			l1_residual_7 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 7" fillcolor=lightsteelblue shape=rectangle style=filled]
			l1_concat_7 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 7" fillcolor=lightyellow shape=parallelogram style=filled]
		}
	}
	subgraph cluster_pipeline_stage_1 {
		bgcolor=lightgray fillcolor=lightgray label="Pipeline Stage 1\nDevices: 8-15\nLayers: 2,3" style=rounded
		subgraph cluster_layer_2 {
			label="Layer 2" style=rounded
			l2_split_q_0 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 8" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_k_0 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 8" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_v_0 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 8" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_q_proj_0 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 8" fillcolor=lightcoral shape=rectangle style=filled]
			l2_k_proj_0 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 8" fillcolor=lightcoral shape=rectangle style=filled]
			l2_v_proj_0 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 8" fillcolor=lightcoral shape=rectangle style=filled]
			l2_mha_0 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 8" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mlp_fc_0 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 8" fillcolor=lightpink shape=rectangle style=filled]
			l2_mlp_proj_0 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 8" fillcolor=lightpink shape=rectangle style=filled]
			l2_residual_0 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 8" fillcolor=lightsteelblue shape=rectangle style=filled]
			l2_concat_0 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 8" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_q_1 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 9" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_k_1 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 9" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_v_1 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 9" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_q_proj_1 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 9" fillcolor=lightcoral shape=rectangle style=filled]
			l2_k_proj_1 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 9" fillcolor=lightcoral shape=rectangle style=filled]
			l2_v_proj_1 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 9" fillcolor=lightcoral shape=rectangle style=filled]
			l2_mha_1 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 9" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mlp_fc_1 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 9" fillcolor=lightpink shape=rectangle style=filled]
			l2_mlp_proj_1 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 9" fillcolor=lightpink shape=rectangle style=filled]
			l2_residual_1 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 9" fillcolor=lightsteelblue shape=rectangle style=filled]
			l2_concat_1 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 9" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_q_2 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 10" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_k_2 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 10" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_v_2 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 10" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_q_proj_2 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 10" fillcolor=lightcoral shape=rectangle style=filled]
			l2_k_proj_2 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 10" fillcolor=lightcoral shape=rectangle style=filled]
			l2_v_proj_2 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 10" fillcolor=lightcoral shape=rectangle style=filled]
			l2_mha_2 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 10" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mlp_fc_2 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 10" fillcolor=lightpink shape=rectangle style=filled]
			l2_mlp_proj_2 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 10" fillcolor=lightpink shape=rectangle style=filled]
			l2_residual_2 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 10" fillcolor=lightsteelblue shape=rectangle style=filled]
			l2_concat_2 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 10" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_q_3 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 11" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_k_3 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 11" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_v_3 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 11" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_q_proj_3 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 11" fillcolor=lightcoral shape=rectangle style=filled]
			l2_k_proj_3 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 11" fillcolor=lightcoral shape=rectangle style=filled]
			l2_v_proj_3 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 11" fillcolor=lightcoral shape=rectangle style=filled]
			l2_mha_3 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 11" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mlp_fc_3 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 11" fillcolor=lightpink shape=rectangle style=filled]
			l2_mlp_proj_3 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 11" fillcolor=lightpink shape=rectangle style=filled]
			l2_residual_3 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 11" fillcolor=lightsteelblue shape=rectangle style=filled]
			l2_concat_3 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 11" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_q_4 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 12" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_k_4 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 12" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_v_4 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 12" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_q_proj_4 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 12" fillcolor=lightcoral shape=rectangle style=filled]
			l2_k_proj_4 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 12" fillcolor=lightcoral shape=rectangle style=filled]
			l2_v_proj_4 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 12" fillcolor=lightcoral shape=rectangle style=filled]
			l2_mha_4 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 12" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mlp_fc_4 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 12" fillcolor=lightpink shape=rectangle style=filled]
			l2_mlp_proj_4 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 12" fillcolor=lightpink shape=rectangle style=filled]
			l2_residual_4 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 12" fillcolor=lightsteelblue shape=rectangle style=filled]
			l2_concat_4 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 12" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_q_5 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 13" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_k_5 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 13" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_v_5 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 13" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_q_proj_5 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 13" fillcolor=lightcoral shape=rectangle style=filled]
			l2_k_proj_5 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 13" fillcolor=lightcoral shape=rectangle style=filled]
			l2_v_proj_5 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 13" fillcolor=lightcoral shape=rectangle style=filled]
			l2_mha_5 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 13" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mlp_fc_5 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 13" fillcolor=lightpink shape=rectangle style=filled]
			l2_mlp_proj_5 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 13" fillcolor=lightpink shape=rectangle style=filled]
			l2_residual_5 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 13" fillcolor=lightsteelblue shape=rectangle style=filled]
			l2_concat_5 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 13" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_q_6 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 14" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_k_6 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 14" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_v_6 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 14" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_q_proj_6 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 14" fillcolor=lightcoral shape=rectangle style=filled]
			l2_k_proj_6 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 14" fillcolor=lightcoral shape=rectangle style=filled]
			l2_v_proj_6 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 14" fillcolor=lightcoral shape=rectangle style=filled]
			l2_mha_6 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 14" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mlp_fc_6 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 14" fillcolor=lightpink shape=rectangle style=filled]
			l2_mlp_proj_6 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 14" fillcolor=lightpink shape=rectangle style=filled]
			l2_residual_6 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 14" fillcolor=lightsteelblue shape=rectangle style=filled]
			l2_concat_6 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 14" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_q_7 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 15" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_k_7 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 15" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_split_v_7 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 15" fillcolor=lightyellow shape=parallelogram style=filled]
			l2_q_proj_7 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 15" fillcolor=lightcoral shape=rectangle style=filled]
			l2_k_proj_7 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 15" fillcolor=lightcoral shape=rectangle style=filled]
			l2_v_proj_7 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 15" fillcolor=lightcoral shape=rectangle style=filled]
			l2_mha_7 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 15" fillcolor=lightgreen shape=rectangle style=filled]
			l2_mlp_fc_7 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 15" fillcolor=lightpink shape=rectangle style=filled]
			l2_mlp_proj_7 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 15" fillcolor=lightpink shape=rectangle style=filled]
			l2_residual_7 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 15" fillcolor=lightsteelblue shape=rectangle style=filled]
			l2_concat_7 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 15" fillcolor=lightyellow shape=parallelogram style=filled]
		}
		subgraph cluster_layer_3 {
			label="Layer 3" style=rounded
			l3_split_q_0 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 8" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_k_0 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 8" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_v_0 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 8" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_q_proj_0 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 8" fillcolor=lightcoral shape=rectangle style=filled]
			l3_k_proj_0 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 8" fillcolor=lightcoral shape=rectangle style=filled]
			l3_v_proj_0 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 8" fillcolor=lightcoral shape=rectangle style=filled]
			l3_mha_0 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 8" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mlp_fc_0 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 8" fillcolor=lightpink shape=rectangle style=filled]
			l3_mlp_proj_0 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 8" fillcolor=lightpink shape=rectangle style=filled]
			l3_residual_0 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 8" fillcolor=lightsteelblue shape=rectangle style=filled]
			l3_concat_0 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 8" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_q_1 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 9" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_k_1 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 9" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_v_1 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 9" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_q_proj_1 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 9" fillcolor=lightcoral shape=rectangle style=filled]
			l3_k_proj_1 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 9" fillcolor=lightcoral shape=rectangle style=filled]
			l3_v_proj_1 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 9" fillcolor=lightcoral shape=rectangle style=filled]
			l3_mha_1 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 9" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mlp_fc_1 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 9" fillcolor=lightpink shape=rectangle style=filled]
			l3_mlp_proj_1 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 9" fillcolor=lightpink shape=rectangle style=filled]
			l3_residual_1 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 9" fillcolor=lightsteelblue shape=rectangle style=filled]
			l3_concat_1 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 9" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_q_2 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 10" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_k_2 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 10" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_v_2 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 10" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_q_proj_2 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 10" fillcolor=lightcoral shape=rectangle style=filled]
			l3_k_proj_2 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 10" fillcolor=lightcoral shape=rectangle style=filled]
			l3_v_proj_2 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 10" fillcolor=lightcoral shape=rectangle style=filled]
			l3_mha_2 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 10" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mlp_fc_2 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 10" fillcolor=lightpink shape=rectangle style=filled]
			l3_mlp_proj_2 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 10" fillcolor=lightpink shape=rectangle style=filled]
			l3_residual_2 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 10" fillcolor=lightsteelblue shape=rectangle style=filled]
			l3_concat_2 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 10" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_q_3 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 11" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_k_3 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 11" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_v_3 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 11" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_q_proj_3 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 11" fillcolor=lightcoral shape=rectangle style=filled]
			l3_k_proj_3 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 11" fillcolor=lightcoral shape=rectangle style=filled]
			l3_v_proj_3 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 11" fillcolor=lightcoral shape=rectangle style=filled]
			l3_mha_3 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 11" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mlp_fc_3 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 11" fillcolor=lightpink shape=rectangle style=filled]
			l3_mlp_proj_3 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 11" fillcolor=lightpink shape=rectangle style=filled]
			l3_residual_3 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 11" fillcolor=lightsteelblue shape=rectangle style=filled]
			l3_concat_3 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 11" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_q_4 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 12" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_k_4 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 12" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_v_4 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 12" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_q_proj_4 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 12" fillcolor=lightcoral shape=rectangle style=filled]
			l3_k_proj_4 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 12" fillcolor=lightcoral shape=rectangle style=filled]
			l3_v_proj_4 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 12" fillcolor=lightcoral shape=rectangle style=filled]
			l3_mha_4 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 12" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mlp_fc_4 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 12" fillcolor=lightpink shape=rectangle style=filled]
			l3_mlp_proj_4 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 12" fillcolor=lightpink shape=rectangle style=filled]
			l3_residual_4 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 12" fillcolor=lightsteelblue shape=rectangle style=filled]
			l3_concat_4 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 12" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_q_5 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 13" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_k_5 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 13" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_v_5 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 13" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_q_proj_5 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 13" fillcolor=lightcoral shape=rectangle style=filled]
			l3_k_proj_5 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 13" fillcolor=lightcoral shape=rectangle style=filled]
			l3_v_proj_5 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 13" fillcolor=lightcoral shape=rectangle style=filled]
			l3_mha_5 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 13" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mlp_fc_5 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 13" fillcolor=lightpink shape=rectangle style=filled]
			l3_mlp_proj_5 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 13" fillcolor=lightpink shape=rectangle style=filled]
			l3_residual_5 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 13" fillcolor=lightsteelblue shape=rectangle style=filled]
			l3_concat_5 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 13" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_q_6 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 14" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_k_6 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 14" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_v_6 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 14" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_q_proj_6 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 14" fillcolor=lightcoral shape=rectangle style=filled]
			l3_k_proj_6 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 14" fillcolor=lightcoral shape=rectangle style=filled]
			l3_v_proj_6 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 14" fillcolor=lightcoral shape=rectangle style=filled]
			l3_mha_6 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 14" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mlp_fc_6 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 14" fillcolor=lightpink shape=rectangle style=filled]
			l3_mlp_proj_6 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 14" fillcolor=lightpink shape=rectangle style=filled]
			l3_residual_6 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 14" fillcolor=lightsteelblue shape=rectangle style=filled]
			l3_concat_6 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 14" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_q_7 [label="Q Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 15" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_k_7 [label="K Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 15" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_split_v_7 [label="V Split\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 15" fillcolor=lightyellow shape=parallelogram style=filled]
			l3_q_proj_7 [label="Q Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 15" fillcolor=lightcoral shape=rectangle style=filled]
			l3_k_proj_7 [label="K Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 15" fillcolor=lightcoral shape=rectangle style=filled]
			l3_v_proj_7 [label="V Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 15" fillcolor=lightcoral shape=rectangle style=filled]
			l3_mha_7 [label="MHA\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 15" fillcolor=lightgreen shape=rectangle style=filled]
			l3_mlp_fc_7 [label="MLP FC\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=2048]\nGPU: 15" fillcolor=lightpink shape=rectangle style=filled]
			l3_mlp_proj_7 [label="MLP Projection\nInput: [batch_size=128, seq_len=10000, hidden_size=2048]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 15" fillcolor=lightpink shape=rectangle style=filled]
			l3_residual_7 [label="Residual Add\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 15" fillcolor=lightsteelblue shape=rectangle style=filled]
			l3_concat_7 [label="TP Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=512]\nGPU: 15" fillcolor=lightyellow shape=parallelogram style=filled]
		}
	}
	final_concat [label="Final Concat\nInput: [batch_size=128, seq_len=10000, hidden_size=512]\nOutput: [batch_size=128, seq_len=10000, hidden_size=4096]\nGPU: all GPUs" fillcolor=lightyellow shape=parallelogram style=filled]
	output [label="Output\nInput: [batch_size=128, seq_len=10000, hidden_size=4096]\nOutput: [batch_size=128, seq_len=10000, hidden_size=4096]\nGPU: all GPUs" fillcolor=lightgreen shape=ellipse style=filled]
	input -> l0_split_q_0
	input -> l0_split_k_0
	input -> l0_split_v_0
	l0_split_q_0 -> l0_q_proj_0
	l0_split_k_0 -> l0_k_proj_0
	l0_split_v_0 -> l0_v_proj_0
	l0_q_proj_0 -> l0_mha_0
	l0_k_proj_0 -> l0_mha_0
	l0_v_proj_0 -> l0_mha_0
	l0_mha_0 -> l0_residual_0
	l0_residual_0 -> l0_mlp_fc_0
	l0_mlp_fc_0 -> l0_mlp_proj_0
	l0_mlp_proj_0 -> l0_residual_0
	l0_residual_0 -> l0_concat_0
	l0_concat_0 -> l1_split_q_0
	l0_concat_0 -> l1_split_k_0
	l0_concat_0 -> l1_split_v_0
	l1_concat_0 -> l2_split_q_0 [label="PP Send" style=dashed]
	input -> l0_split_q_1
	input -> l0_split_k_1
	input -> l0_split_v_1
	l0_split_q_1 -> l0_q_proj_1
	l0_split_k_1 -> l0_k_proj_1
	l0_split_v_1 -> l0_v_proj_1
	l0_q_proj_1 -> l0_mha_1
	l0_k_proj_1 -> l0_mha_1
	l0_v_proj_1 -> l0_mha_1
	l0_mha_1 -> l0_residual_1
	l0_residual_1 -> l0_mlp_fc_1
	l0_mlp_fc_1 -> l0_mlp_proj_1
	l0_mlp_proj_1 -> l0_residual_1
	l0_residual_1 -> l0_concat_1
	l0_concat_1 -> l1_split_q_1
	l0_concat_1 -> l1_split_k_1
	l0_concat_1 -> l1_split_v_1
	l1_concat_1 -> l2_split_q_1 [label="PP Send" style=dashed]
	input -> l0_split_q_2
	input -> l0_split_k_2
	input -> l0_split_v_2
	l0_split_q_2 -> l0_q_proj_2
	l0_split_k_2 -> l0_k_proj_2
	l0_split_v_2 -> l0_v_proj_2
	l0_q_proj_2 -> l0_mha_2
	l0_k_proj_2 -> l0_mha_2
	l0_v_proj_2 -> l0_mha_2
	l0_mha_2 -> l0_residual_2
	l0_residual_2 -> l0_mlp_fc_2
	l0_mlp_fc_2 -> l0_mlp_proj_2
	l0_mlp_proj_2 -> l0_residual_2
	l0_residual_2 -> l0_concat_2
	l0_concat_2 -> l1_split_q_2
	l0_concat_2 -> l1_split_k_2
	l0_concat_2 -> l1_split_v_2
	l1_concat_2 -> l2_split_q_2 [label="PP Send" style=dashed]
	input -> l0_split_q_3
	input -> l0_split_k_3
	input -> l0_split_v_3
	l0_split_q_3 -> l0_q_proj_3
	l0_split_k_3 -> l0_k_proj_3
	l0_split_v_3 -> l0_v_proj_3
	l0_q_proj_3 -> l0_mha_3
	l0_k_proj_3 -> l0_mha_3
	l0_v_proj_3 -> l0_mha_3
	l0_mha_3 -> l0_residual_3
	l0_residual_3 -> l0_mlp_fc_3
	l0_mlp_fc_3 -> l0_mlp_proj_3
	l0_mlp_proj_3 -> l0_residual_3
	l0_residual_3 -> l0_concat_3
	l0_concat_3 -> l1_split_q_3
	l0_concat_3 -> l1_split_k_3
	l0_concat_3 -> l1_split_v_3
	l1_concat_3 -> l2_split_q_3 [label="PP Send" style=dashed]
	input -> l0_split_q_4
	input -> l0_split_k_4
	input -> l0_split_v_4
	l0_split_q_4 -> l0_q_proj_4
	l0_split_k_4 -> l0_k_proj_4
	l0_split_v_4 -> l0_v_proj_4
	l0_q_proj_4 -> l0_mha_4
	l0_k_proj_4 -> l0_mha_4
	l0_v_proj_4 -> l0_mha_4
	l0_mha_4 -> l0_residual_4
	l0_residual_4 -> l0_mlp_fc_4
	l0_mlp_fc_4 -> l0_mlp_proj_4
	l0_mlp_proj_4 -> l0_residual_4
	l0_residual_4 -> l0_concat_4
	l0_concat_4 -> l1_split_q_4
	l0_concat_4 -> l1_split_k_4
	l0_concat_4 -> l1_split_v_4
	l1_concat_4 -> l2_split_q_4 [label="PP Send" style=dashed]
	input -> l0_split_q_5
	input -> l0_split_k_5
	input -> l0_split_v_5
	l0_split_q_5 -> l0_q_proj_5
	l0_split_k_5 -> l0_k_proj_5
	l0_split_v_5 -> l0_v_proj_5
	l0_q_proj_5 -> l0_mha_5
	l0_k_proj_5 -> l0_mha_5
	l0_v_proj_5 -> l0_mha_5
	l0_mha_5 -> l0_residual_5
	l0_residual_5 -> l0_mlp_fc_5
	l0_mlp_fc_5 -> l0_mlp_proj_5
	l0_mlp_proj_5 -> l0_residual_5
	l0_residual_5 -> l0_concat_5
	l0_concat_5 -> l1_split_q_5
	l0_concat_5 -> l1_split_k_5
	l0_concat_5 -> l1_split_v_5
	l1_concat_5 -> l2_split_q_5 [label="PP Send" style=dashed]
	input -> l0_split_q_6
	input -> l0_split_k_6
	input -> l0_split_v_6
	l0_split_q_6 -> l0_q_proj_6
	l0_split_k_6 -> l0_k_proj_6
	l0_split_v_6 -> l0_v_proj_6
	l0_q_proj_6 -> l0_mha_6
	l0_k_proj_6 -> l0_mha_6
	l0_v_proj_6 -> l0_mha_6
	l0_mha_6 -> l0_residual_6
	l0_residual_6 -> l0_mlp_fc_6
	l0_mlp_fc_6 -> l0_mlp_proj_6
	l0_mlp_proj_6 -> l0_residual_6
	l0_residual_6 -> l0_concat_6
	l0_concat_6 -> l1_split_q_6
	l0_concat_6 -> l1_split_k_6
	l0_concat_6 -> l1_split_v_6
	l1_concat_6 -> l2_split_q_6 [label="PP Send" style=dashed]
	input -> l0_split_q_7
	input -> l0_split_k_7
	input -> l0_split_v_7
	l0_split_q_7 -> l0_q_proj_7
	l0_split_k_7 -> l0_k_proj_7
	l0_split_v_7 -> l0_v_proj_7
	l0_q_proj_7 -> l0_mha_7
	l0_k_proj_7 -> l0_mha_7
	l0_v_proj_7 -> l0_mha_7
	l0_mha_7 -> l0_residual_7
	l0_residual_7 -> l0_mlp_fc_7
	l0_mlp_fc_7 -> l0_mlp_proj_7
	l0_mlp_proj_7 -> l0_residual_7
	l0_residual_7 -> l0_concat_7
	l0_concat_7 -> l1_split_q_7
	l0_concat_7 -> l1_split_k_7
	l0_concat_7 -> l1_split_v_7
	l1_concat_7 -> l2_split_q_7 [label="PP Send" style=dashed]
}
