<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_dag Pages: 1 -->
<svg width="75168pt" height="1166pt"
 viewBox="0.00 0.00 75168.00 1166.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1162)">
<title>baseline_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1162 75164,-1162 75164,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_pipeline_stage_0</title>
<path fill="lightgray" stroke="black" d="M25256,-245C25256,-245 75140,-245 75140,-245 75146,-245 75152,-251 75152,-257 75152,-257 75152,-1015 75152,-1015 75152,-1021 75146,-1027 75140,-1027 75140,-1027 25256,-1027 25256,-1027 25250,-1027 25244,-1021 25244,-1015 25244,-1015 25244,-257 25244,-257 25244,-251 25250,-245 25256,-245"/>
<text text-anchor="middle" x="50198" y="-1011.8" font-family="Times,serif" font-size="14.00">Pipeline Stage 0</text>
<text text-anchor="middle" x="50198" y="-996.8" font-family="Times,serif" font-size="14.00">Devices: 0&#45;7</text>
<text text-anchor="middle" x="50198" y="-981.8" font-family="Times,serif" font-size="14.00">Layers: 0,1</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_0</title>
<path fill="lightgray" stroke="black" d="M25264,-279C25264,-279 39494,-279 39494,-279 39500,-279 39506,-285 39506,-291 39506,-291 39506,-954 39506,-954 39506,-960 39500,-966 39494,-966 39494,-966 25264,-966 25264,-966 25258,-966 25252,-960 25252,-954 25252,-954 25252,-291 25252,-291 25252,-285 25258,-279 25264,-279"/>
<text text-anchor="middle" x="32379" y="-950.8" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer_1</title>
<path fill="lightgray" stroke="black" d="M39526,-253C39526,-253 75132,-253 75132,-253 75138,-253 75144,-259 75144,-265 75144,-265 75144,-384 75144,-384 75144,-390 75138,-396 75132,-396 75132,-396 39526,-396 39526,-396 39520,-396 39514,-390 39514,-384 39514,-384 39514,-265 39514,-265 39514,-259 39520,-253 39526,-253"/>
<text text-anchor="middle" x="57329" y="-380.8" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_pipeline_stage_1</title>
<path fill="lightgray" stroke="black" d="M20,-8C20,-8 71280,-8 71280,-8 71286,-8 71292,-14 71292,-20 71292,-20 71292,-208 71292,-208 71292,-214 71286,-220 71280,-220 71280,-220 20,-220 20,-220 14,-220 8,-214 8,-208 8,-208 8,-20 8,-20 8,-14 14,-8 20,-8"/>
<text text-anchor="middle" x="35650" y="-204.8" font-family="Times,serif" font-size="14.00">Pipeline Stage 1</text>
<text text-anchor="middle" x="35650" y="-189.8" font-family="Times,serif" font-size="14.00">Devices: 8&#45;15</text>
<text text-anchor="middle" x="35650" y="-174.8" font-family="Times,serif" font-size="14.00">Layers: 2,3</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer_2</title>
<path fill="lightgray" stroke="black" d="M35666,-16C35666,-16 71272,-16 71272,-16 71278,-16 71284,-22 71284,-28 71284,-28 71284,-147 71284,-147 71284,-153 71278,-159 71272,-159 71272,-159 35666,-159 35666,-159 35660,-159 35654,-153 35654,-147 35654,-147 35654,-28 35654,-28 35654,-22 35660,-16 35666,-16"/>
<text text-anchor="middle" x="53469" y="-143.8" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer_3</title>
<path fill="lightgray" stroke="black" d="M28,-16C28,-16 35634,-16 35634,-16 35640,-16 35646,-22 35646,-28 35646,-28 35646,-147 35646,-147 35646,-153 35640,-159 35634,-159 35634,-159 28,-159 28,-159 22,-159 16,-153 16,-147 16,-147 16,-28 16,-28 16,-22 22,-16 28,-16"/>
<text text-anchor="middle" x="17831" y="-143.8" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="32676" cy="-1106" rx="200.64" ry="36.54"/>
<text text-anchor="middle" x="32676" y="-1120" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="32676" y="-1109" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="32676" y="-1098" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="32676" y="-1087" font-family="Arial" font-size="10.00">GPU: all GPUs</text>
</g>
<!-- l0_split_q_0 -->
<g id="node2" class="node">
<title>l0_split_q_0</title>
<polygon fill="lightyellow" stroke="black" points="25836.43,-935 25377.6,-935 25259.57,-831 25718.4,-831 25836.43,-935"/>
<text text-anchor="middle" x="25548" y="-897" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="25548" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="25548" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="25548" y="-864" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;l0_split_q_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;l0_split_q_0</title>
<path fill="none" stroke="black" d="M32683.04,-1068.98C32683.46,-1057.72 32681.93,-1045.71 32676,-1036"/>
<path fill="none" stroke="black" d="M32676,-1035C32669.82,-1024.88 25856.56,-1029.65 25845,-1027 25771.26,-1010.13 25694.49,-972.56 25637.48,-940.16"/>
<polygon fill="black" stroke="black" points="25638.92,-936.95 25628.5,-935.01 25635.43,-943.02 25638.92,-936.95"/>
</g>
<!-- l0_split_k_0 -->
<g id="node3" class="node">
<title>l0_split_k_0</title>
<polygon fill="lightyellow" stroke="black" points="26430.43,-935 25971.6,-935 25853.57,-831 26312.4,-831 26430.43,-935"/>
<text text-anchor="middle" x="26142" y="-897" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="26142" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="26142" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="26142" y="-864" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;l0_split_k_0 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;l0_split_k_0</title>
<path fill="none" stroke="black" d="M32676,-1035C32670.36,-1025.76 26449.56,-1029.42 26439,-1027 26365.26,-1010.12 26288.49,-972.55 26231.48,-940.16"/>
<polygon fill="black" stroke="black" points="26232.92,-936.95 26222.5,-935 26229.43,-943.02 26232.92,-936.95"/>
</g>
<!-- l0_split_v_0 -->
<g id="node4" class="node">
<title>l0_split_v_0</title>
<polygon fill="lightyellow" stroke="black" points="27024.43,-935 26565.6,-935 26447.57,-831 26906.4,-831 27024.43,-935"/>
<text text-anchor="middle" x="26736" y="-897" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="26736" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="26736" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="26736" y="-864" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;l0_split_v_0 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;l0_split_v_0</title>
<path fill="none" stroke="black" d="M32676,-1035C32670.89,-1026.64 27042.55,-1029.19 27033,-1027 26959.26,-1010.12 26882.49,-972.55 26825.48,-940.15"/>
<polygon fill="black" stroke="black" points="26826.92,-936.94 26816.5,-935 26823.44,-943.01 26826.92,-936.94"/>
</g>
<!-- l0_split_q_1 -->
<g id="node13" class="node">
<title>l0_split_q_1</title>
<polygon fill="lightyellow" stroke="black" points="27618.43,-935 27159.6,-935 27041.57,-831 27500.4,-831 27618.43,-935"/>
<text text-anchor="middle" x="27330" y="-897" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="27330" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="27330" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="27330" y="-864" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- input&#45;&gt;l0_split_q_1 -->
<g id="edge19" class="edge">
<title>input&#45;&gt;l0_split_q_1</title>
<path fill="none" stroke="black" d="M32676,-1035C32671.43,-1027.52 27635.54,-1028.96 27627,-1027 27553.4,-1010.14 27476.77,-972.68 27419.79,-940.32"/>
<polygon fill="black" stroke="black" points="27421.23,-937.11 27410.82,-935.18 27417.75,-943.19 27421.23,-937.11"/>
</g>
<!-- l0_split_k_1 -->
<g id="node14" class="node">
<title>l0_split_k_1</title>
<polygon fill="lightyellow" stroke="black" points="28212.43,-935 27753.6,-935 27635.57,-831 28094.4,-831 28212.43,-935"/>
<text text-anchor="middle" x="27924" y="-897" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="27924" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="27924" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="27924" y="-864" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- input&#45;&gt;l0_split_k_1 -->
<g id="edge20" class="edge">
<title>input&#45;&gt;l0_split_k_1</title>
<path fill="none" stroke="black" d="M32676,-1035C32667.94,-1021.8 28236.08,-1030.46 28221,-1027 28147.4,-1010.13 28070.77,-972.67 28013.79,-940.32"/>
<polygon fill="black" stroke="black" points="28015.23,-937.11 28004.82,-935.17 28011.75,-943.18 28015.23,-937.11"/>
</g>
<!-- l0_split_v_1 -->
<g id="node15" class="node">
<title>l0_split_v_1</title>
<polygon fill="lightyellow" stroke="black" points="28806.43,-935 28347.6,-935 28229.57,-831 28688.4,-831 28806.43,-935"/>
<text text-anchor="middle" x="28518" y="-897" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="28518" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="28518" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="28518" y="-864" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- input&#45;&gt;l0_split_v_1 -->
<g id="edge21" class="edge">
<title>input&#45;&gt;l0_split_v_1</title>
<path fill="none" stroke="black" d="M32676,-1035C32669.01,-1023.56 28828.07,-1030 28815,-1027 28741.4,-1010.12 28664.78,-972.66 28607.79,-940.31"/>
<polygon fill="black" stroke="black" points="28609.24,-937.1 28598.82,-935.17 28605.75,-943.18 28609.24,-937.1"/>
</g>
<!-- l0_split_q_2 -->
<g id="node24" class="node">
<title>l0_split_q_2</title>
<polygon fill="lightyellow" stroke="black" points="29400.43,-935 28941.6,-935 28823.57,-831 29282.4,-831 29400.43,-935"/>
<text text-anchor="middle" x="29112" y="-897" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="29112" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="29112" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="29112" y="-864" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- input&#45;&gt;l0_split_q_2 -->
<g id="edge37" class="edge">
<title>input&#45;&gt;l0_split_q_2</title>
<path fill="none" stroke="black" d="M32676,-1035C32670.09,-1025.32 29420.06,-1029.54 29409,-1027 29335.41,-1010.11 29258.78,-972.65 29201.79,-940.3"/>
<polygon fill="black" stroke="black" points="29203.24,-937.09 29192.82,-935.16 29199.76,-943.17 29203.24,-937.09"/>
</g>
<!-- l0_split_k_2 -->
<g id="node25" class="node">
<title>l0_split_k_2</title>
<polygon fill="lightyellow" stroke="black" points="29994.43,-935 29535.6,-935 29417.57,-831 29876.4,-831 29994.43,-935"/>
<text text-anchor="middle" x="29706" y="-897" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="29706" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="29706" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="29706" y="-864" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- input&#45;&gt;l0_split_k_2 -->
<g id="edge38" class="edge">
<title>input&#45;&gt;l0_split_k_2</title>
<path fill="none" stroke="black" d="M32676,-1035C32671.16,-1027.08 30012.05,-1029.08 30003,-1027 29929.41,-1010.09 29852.78,-972.63 29795.8,-940.29"/>
<polygon fill="black" stroke="black" points="29797.24,-937.08 29786.82,-935.14 29793.76,-943.15 29797.24,-937.08"/>
</g>
<!-- l0_split_v_2 -->
<g id="node26" class="node">
<title>l0_split_v_2</title>
<polygon fill="lightyellow" stroke="black" points="30588.43,-935 30129.6,-935 30011.57,-831 30470.4,-831 30588.43,-935"/>
<text text-anchor="middle" x="30300" y="-897" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="30300" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="30300" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="30300" y="-864" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- input&#45;&gt;l0_split_v_2 -->
<g id="edge39" class="edge">
<title>input&#45;&gt;l0_split_v_2</title>
<path fill="none" stroke="black" d="M32676,-1035C32668.48,-1022.68 30611.07,-1030.24 30597,-1027 30523.42,-1010.06 30446.79,-972.6 30389.8,-940.26"/>
<polygon fill="black" stroke="black" points="30391.25,-937.06 30380.83,-935.12 30387.77,-943.13 30391.25,-937.06"/>
</g>
<!-- l0_split_q_3 -->
<g id="node35" class="node">
<title>l0_split_q_3</title>
<polygon fill="lightyellow" stroke="black" points="31182.43,-935 30723.6,-935 30605.57,-831 31064.4,-831 31182.43,-935"/>
<text text-anchor="middle" x="30894" y="-897" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="30894" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="30894" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="30894" y="-864" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- input&#45;&gt;l0_split_q_3 -->
<g id="edge55" class="edge">
<title>input&#45;&gt;l0_split_q_3</title>
<path fill="none" stroke="black" d="M32676,-1035C32670.63,-1026.2 31201.05,-1029.32 31191,-1027 31117.43,-1010 31040.8,-972.54 30983.81,-940.22"/>
<polygon fill="black" stroke="black" points="30985.25,-937.02 30974.84,-935.08 30981.78,-943.09 30985.25,-937.02"/>
</g>
<!-- l0_split_k_3 -->
<g id="node36" class="node">
<title>l0_split_k_3</title>
<polygon fill="lightyellow" stroke="black" points="31776.43,-935 31317.6,-935 31199.57,-831 31658.4,-831 31776.43,-935"/>
<text text-anchor="middle" x="31488" y="-897" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="31488" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="31488" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="31488" y="-864" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- input&#45;&gt;l0_split_k_3 -->
<g id="edge56" class="edge">
<title>input&#45;&gt;l0_split_k_3</title>
<path fill="none" stroke="black" d="M32676,-1035C32669.55,-1024.44 31797.05,-1029.81 31785,-1027 31711.59,-1009.9 31635.11,-972.55 31578.14,-940.3"/>
<polygon fill="black" stroke="black" points="31579.59,-937.1 31569.17,-935.18 31576.12,-943.18 31579.59,-937.1"/>
</g>
<!-- l0_split_v_3 -->
<g id="node37" class="node">
<title>l0_split_v_3</title>
<polygon fill="lightyellow" stroke="black" points="32370.43,-935 31911.6,-935 31793.57,-831 32252.4,-831 32370.43,-935"/>
<text text-anchor="middle" x="32082" y="-897" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="32082" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="32082" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="32082" y="-864" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- input&#45;&gt;l0_split_v_3 -->
<g id="edge57" class="edge">
<title>input&#45;&gt;l0_split_v_3</title>
<path fill="none" stroke="black" d="M32676,-1035C32667.4,-1020.91 32395.04,-1030.89 32379,-1027 32306.01,-1009.31 32229.81,-972.18 32172.87,-940.19"/>
<polygon fill="black" stroke="black" points="32174.32,-936.99 32163.9,-935.1 32170.87,-943.08 32174.32,-936.99"/>
</g>
<!-- l0_split_q_4 -->
<g id="node46" class="node">
<title>l0_split_q_4</title>
<polygon fill="lightyellow" stroke="black" points="32964.43,-935 32505.6,-935 32387.57,-831 32846.4,-831 32964.43,-935"/>
<text text-anchor="middle" x="32676" y="-897" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="32676" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="32676" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="32676" y="-864" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- input&#45;&gt;l0_split_q_4 -->
<g id="edge73" class="edge">
<title>input&#45;&gt;l0_split_q_4</title>
<path fill="none" stroke="black" d="M32676,-1035C32659.87,-1008.58 32658.62,-974.41 32661.95,-945.26"/>
<polygon fill="black" stroke="black" points="32665.44,-945.55 32663.31,-935.17 32658.51,-944.62 32665.44,-945.55"/>
</g>
<!-- l0_split_k_4 -->
<g id="node47" class="node">
<title>l0_split_k_4</title>
<polygon fill="lightyellow" stroke="black" points="33558.43,-935 33099.6,-935 32981.57,-831 33440.4,-831 33558.43,-935"/>
<text text-anchor="middle" x="33270" y="-897" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="33270" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="33270" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="33270" y="-864" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- input&#45;&gt;l0_split_k_4 -->
<g id="edge74" class="edge">
<title>input&#45;&gt;l0_split_k_4</title>
<path fill="none" stroke="black" d="M32676,-1035C32667.4,-1020.91 32956.96,-1030.89 32973,-1027 33045.99,-1009.31 33122.19,-972.18 33179.13,-940.19"/>
<polygon fill="black" stroke="black" points="33181.13,-943.08 33188.1,-935.1 33177.68,-936.99 33181.13,-943.08"/>
</g>
<!-- l0_split_v_4 -->
<g id="node48" class="node">
<title>l0_split_v_4</title>
<polygon fill="lightyellow" stroke="black" points="34152.43,-935 33693.6,-935 33575.57,-831 34034.4,-831 34152.43,-935"/>
<text text-anchor="middle" x="33864" y="-897" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="33864" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="33864" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="33864" y="-864" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- input&#45;&gt;l0_split_v_4 -->
<g id="edge75" class="edge">
<title>input&#45;&gt;l0_split_v_4</title>
<path fill="none" stroke="black" d="M32676,-1035C32669.55,-1024.44 33554.95,-1029.81 33567,-1027 33640.41,-1009.9 33716.89,-972.55 33773.86,-940.3"/>
<polygon fill="black" stroke="black" points="33775.88,-943.18 33782.83,-935.18 33772.41,-937.1 33775.88,-943.18"/>
</g>
<!-- l0_split_q_5 -->
<g id="node57" class="node">
<title>l0_split_q_5</title>
<polygon fill="lightyellow" stroke="black" points="34746.43,-935 34287.6,-935 34169.57,-831 34628.4,-831 34746.43,-935"/>
<text text-anchor="middle" x="34458" y="-897" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="34458" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="34458" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="34458" y="-864" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- input&#45;&gt;l0_split_q_5 -->
<g id="edge91" class="edge">
<title>input&#45;&gt;l0_split_q_5</title>
<path fill="none" stroke="black" d="M32676,-1035C32670.63,-1026.2 34150.95,-1029.32 34161,-1027 34234.57,-1010 34311.2,-972.54 34368.19,-940.22"/>
<polygon fill="black" stroke="black" points="34370.22,-943.09 34377.16,-935.08 34366.75,-937.02 34370.22,-943.09"/>
</g>
<!-- l0_split_k_5 -->
<g id="node58" class="node">
<title>l0_split_k_5</title>
<polygon fill="lightyellow" stroke="black" points="35340.43,-935 34881.6,-935 34763.57,-831 35222.4,-831 35340.43,-935"/>
<text text-anchor="middle" x="35052" y="-897" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="35052" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="35052" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="35052" y="-864" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- input&#45;&gt;l0_split_k_5 -->
<g id="edge92" class="edge">
<title>input&#45;&gt;l0_split_k_5</title>
<path fill="none" stroke="black" d="M32676,-1035C32668.48,-1022.68 34740.93,-1030.24 34755,-1027 34828.58,-1010.06 34905.21,-972.6 34962.2,-940.26"/>
<polygon fill="black" stroke="black" points="34964.23,-943.13 34971.17,-935.12 34960.75,-937.06 34964.23,-943.13"/>
</g>
<!-- l0_split_v_5 -->
<g id="node59" class="node">
<title>l0_split_v_5</title>
<polygon fill="lightyellow" stroke="black" points="35934.43,-935 35475.6,-935 35357.57,-831 35816.4,-831 35934.43,-935"/>
<text text-anchor="middle" x="35646" y="-897" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="35646" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="35646" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="35646" y="-864" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- input&#45;&gt;l0_split_v_5 -->
<g id="edge93" class="edge">
<title>input&#45;&gt;l0_split_v_5</title>
<path fill="none" stroke="black" d="M32676,-1035C32671.16,-1027.08 35339.95,-1029.08 35349,-1027 35422.59,-1010.09 35499.22,-972.63 35556.2,-940.29"/>
<polygon fill="black" stroke="black" points="35558.24,-943.15 35565.18,-935.14 35554.76,-937.08 35558.24,-943.15"/>
</g>
<!-- l0_split_q_6 -->
<g id="node68" class="node">
<title>l0_split_q_6</title>
<polygon fill="lightyellow" stroke="black" points="36528.43,-935 36069.6,-935 35951.57,-831 36410.4,-831 36528.43,-935"/>
<text text-anchor="middle" x="36240" y="-897" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="36240" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="36240" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="36240" y="-864" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- input&#45;&gt;l0_split_q_6 -->
<g id="edge109" class="edge">
<title>input&#45;&gt;l0_split_q_6</title>
<path fill="none" stroke="black" d="M32676,-1035C32670.09,-1025.32 35931.94,-1029.54 35943,-1027 36016.59,-1010.11 36093.22,-972.65 36150.21,-940.3"/>
<polygon fill="black" stroke="black" points="36152.24,-943.17 36159.18,-935.16 36148.76,-937.09 36152.24,-943.17"/>
</g>
<!-- l0_split_k_6 -->
<g id="node69" class="node">
<title>l0_split_k_6</title>
<polygon fill="lightyellow" stroke="black" points="37122.43,-935 36663.6,-935 36545.57,-831 37004.4,-831 37122.43,-935"/>
<text text-anchor="middle" x="36834" y="-897" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="36834" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="36834" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="36834" y="-864" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- input&#45;&gt;l0_split_k_6 -->
<g id="edge110" class="edge">
<title>input&#45;&gt;l0_split_k_6</title>
<path fill="none" stroke="black" d="M32676,-1035C32669.01,-1023.56 36523.93,-1030 36537,-1027 36610.6,-1010.12 36687.22,-972.66 36744.21,-940.31"/>
<polygon fill="black" stroke="black" points="36746.25,-943.18 36753.18,-935.17 36742.76,-937.1 36746.25,-943.18"/>
</g>
<!-- l0_split_v_6 -->
<g id="node70" class="node">
<title>l0_split_v_6</title>
<polygon fill="lightyellow" stroke="black" points="37716.43,-935 37257.6,-935 37139.57,-831 37598.4,-831 37716.43,-935"/>
<text text-anchor="middle" x="37428" y="-897" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="37428" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="37428" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="37428" y="-864" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- input&#45;&gt;l0_split_v_6 -->
<g id="edge111" class="edge">
<title>input&#45;&gt;l0_split_v_6</title>
<path fill="none" stroke="black" d="M32676,-1035C32667.94,-1021.8 37115.92,-1030.46 37131,-1027 37204.6,-1010.13 37281.23,-972.67 37338.21,-940.32"/>
<polygon fill="black" stroke="black" points="37340.25,-943.18 37347.18,-935.17 37336.77,-937.11 37340.25,-943.18"/>
</g>
<!-- l0_split_q_7 -->
<g id="node79" class="node">
<title>l0_split_q_7</title>
<polygon fill="lightyellow" stroke="black" points="38310.43,-935 37851.6,-935 37733.57,-831 38192.4,-831 38310.43,-935"/>
<text text-anchor="middle" x="38022" y="-897" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="38022" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="38022" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="38022" y="-864" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- input&#45;&gt;l0_split_q_7 -->
<g id="edge127" class="edge">
<title>input&#45;&gt;l0_split_q_7</title>
<path fill="none" stroke="black" d="M32676,-1035C32671.43,-1027.52 37716.46,-1028.96 37725,-1027 37798.6,-1010.14 37875.23,-972.68 37932.21,-940.32"/>
<polygon fill="black" stroke="black" points="37934.25,-943.19 37941.18,-935.18 37930.77,-937.11 37934.25,-943.19"/>
</g>
<!-- l0_split_k_7 -->
<g id="node80" class="node">
<title>l0_split_k_7</title>
<polygon fill="lightyellow" stroke="black" points="38904.43,-935 38445.6,-935 38327.57,-831 38786.4,-831 38904.43,-935"/>
<text text-anchor="middle" x="38616" y="-897" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="38616" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="38616" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="38616" y="-864" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- input&#45;&gt;l0_split_k_7 -->
<g id="edge128" class="edge">
<title>input&#45;&gt;l0_split_k_7</title>
<path fill="none" stroke="black" d="M32676,-1035C32670.89,-1026.64 38309.45,-1029.19 38319,-1027 38392.74,-1010.12 38469.51,-972.55 38526.52,-940.15"/>
<polygon fill="black" stroke="black" points="38528.56,-943.01 38535.5,-935 38525.08,-936.94 38528.56,-943.01"/>
</g>
<!-- l0_split_v_7 -->
<g id="node81" class="node">
<title>l0_split_v_7</title>
<polygon fill="lightyellow" stroke="black" points="39498.43,-935 39039.6,-935 38921.57,-831 39380.4,-831 39498.43,-935"/>
<text text-anchor="middle" x="39210" y="-897" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="39210" y="-886" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="39210" y="-875" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="39210" y="-864" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- input&#45;&gt;l0_split_v_7 -->
<g id="edge129" class="edge">
<title>input&#45;&gt;l0_split_v_7</title>
<path fill="none" stroke="black" d="M32676,-1035C32670.36,-1025.76 38902.44,-1029.42 38913,-1027 38986.74,-1010.12 39063.51,-972.55 39120.52,-940.16"/>
<polygon fill="black" stroke="black" points="39122.57,-943.02 39129.5,-935 39119.08,-936.95 39122.57,-943.02"/>
</g>
<!-- l0_q_proj_0 -->
<g id="node5" class="node">
<title>l0_q_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="26023,-794 25745,-794 25745,-742 26023,-742 26023,-794"/>
<text text-anchor="middle" x="25884" y="-782" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="25884" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="25884" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="25884" y="-749" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- l0_split_q_0&#45;&gt;l0_q_proj_0 -->
<g id="edge4" class="edge">
<title>l0_split_q_0&#45;&gt;l0_q_proj_0</title>
<path fill="none" stroke="black" d="M25699.78,-830.95C25734.15,-819.4 25769.43,-807.53 25799.8,-797.32"/>
<polygon fill="black" stroke="black" points="25801.12,-800.57 25809.48,-794.06 25798.88,-793.93 25801.12,-800.57"/>
</g>
<!-- l0_k_proj_0 -->
<g id="node6" class="node">
<title>l0_k_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="26468,-794 26190,-794 26190,-742 26468,-742 26468,-794"/>
<text text-anchor="middle" x="26329" y="-782" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="26329" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="26329" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="26329" y="-749" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- l0_split_k_0&#45;&gt;l0_k_proj_0 -->
<g id="edge5" class="edge">
<title>l0_split_k_0&#45;&gt;l0_k_proj_0</title>
<path fill="none" stroke="black" d="M26226.47,-830.95C26244.28,-820.2 26262.52,-809.17 26278.59,-799.46"/>
<polygon fill="black" stroke="black" points="26280.53,-802.38 26287.28,-794.21 26276.91,-796.39 26280.53,-802.38"/>
</g>
<!-- l0_v_proj_0 -->
<g id="node7" class="node">
<title>l0_v_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="26764,-794 26486,-794 26486,-742 26764,-742 26764,-794"/>
<text text-anchor="middle" x="26625" y="-782" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="26625" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="26625" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="26625" y="-749" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- l0_split_v_0&#45;&gt;l0_v_proj_0 -->
<g id="edge6" class="edge">
<title>l0_split_v_0&#45;&gt;l0_v_proj_0</title>
<path fill="none" stroke="black" d="M26685.7,-830.79C26675.83,-820.75 26665.74,-810.48 26656.69,-801.27"/>
<polygon fill="black" stroke="black" points="26659.19,-798.81 26649.69,-794.13 26654.2,-803.72 26659.19,-798.81"/>
</g>
<!-- l0_mha_0 -->
<g id="node8" class="node">
<title>l0_mha_0</title>
<polygon fill="lightgreen" stroke="black" points="27332,-705 27054,-705 27054,-653 27332,-653 27332,-705"/>
<text text-anchor="middle" x="27193" y="-693" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="27193" y="-682" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="27193" y="-671" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="27193" y="-660" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- l0_q_proj_0&#45;&gt;l0_mha_0 -->
<g id="edge7" class="edge">
<title>l0_q_proj_0&#45;&gt;l0_mha_0</title>
<path fill="none" stroke="black" d="M26023.33,-754.6C26073.07,-750.35 26129.52,-745.73 26181,-742 26312.45,-732.47 26346.52,-742.62 26477,-724"/>
<path fill="none" stroke="black" d="M26477,-723C26671.43,-695.25 26898.05,-685.37 27043.4,-681.88"/>
<polygon fill="black" stroke="black" points="27043.81,-685.37 27053.72,-681.64 27043.65,-678.37 27043.81,-685.37"/>
</g>
<!-- l0_k_proj_0&#45;&gt;l0_mha_0 -->
<g id="edge8" class="edge">
<title>l0_k_proj_0&#45;&gt;l0_mha_0</title>
<path fill="none" stroke="black" d="M26400,-741.97C26424.12,-734.66 26451.44,-727.65 26477,-724"/>
</g>
<!-- l0_v_proj_0&#45;&gt;l0_mha_0 -->
<g id="edge9" class="edge">
<title>l0_v_proj_0&#45;&gt;l0_mha_0</title>
<path fill="none" stroke="black" d="M26494.47,-741.97C26466.18,-734.66 26451.44,-727.65 26477,-724"/>
</g>
<!-- l0_residual_0 -->
<g id="node11" class="node">
<title>l0_residual_0</title>
<polygon fill="lightsteelblue" stroke="black" points="27690,-616 27412,-616 27412,-564 27690,-564 27690,-616"/>
<text text-anchor="middle" x="27551" y="-604" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="27551" y="-593" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="27551" y="-582" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="27551" y="-571" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- l0_mha_0&#45;&gt;l0_residual_0 -->
<g id="edge10" class="edge">
<title>l0_mha_0&#45;&gt;l0_residual_0</title>
<path fill="none" stroke="black" d="M27296.07,-652.95C27340.52,-642.15 27392.65,-629.48 27438.14,-618.43"/>
<polygon fill="black" stroke="black" points="27439.15,-621.78 27448.04,-616.02 27437.5,-614.98 27439.15,-621.78"/>
</g>
<!-- l0_mlp_fc_0 -->
<g id="node9" class="node">
<title>l0_mlp_fc_0</title>
<polygon fill="lightpink" stroke="black" points="27574,-501 27290,-501 27290,-449 27574,-449 27574,-501"/>
<text text-anchor="middle" x="27432" y="-489" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="27432" y="-478" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="27432" y="-467" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="27432" y="-456" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- l0_mlp_proj_0 -->
<g id="node10" class="node">
<title>l0_mlp_proj_0</title>
<polygon fill="lightpink" stroke="black" points="27691,-339 27413,-339 27413,-287 27691,-287 27691,-339"/>
<text text-anchor="middle" x="27552" y="-327" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="27552" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="27552" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="27552" y="-294" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- l0_mlp_fc_0&#45;&gt;l0_mlp_proj_0 -->
<g id="edge12" class="edge">
<title>l0_mlp_fc_0&#45;&gt;l0_mlp_proj_0</title>
<path fill="none" stroke="black" d="M27451.01,-448.65C27471.55,-421.26 27504.37,-377.51 27526.98,-347.35"/>
<polygon fill="black" stroke="black" points="27529.87,-349.33 27533.07,-339.23 27524.27,-345.13 27529.87,-349.33"/>
</g>
<!-- l0_mlp_proj_0&#45;&gt;l0_residual_0 -->
<g id="edge13" class="edge">
<title>l0_mlp_proj_0&#45;&gt;l0_residual_0</title>
<path fill="none" stroke="black" d="M27561.83,-339.21C27576.11,-379.38 27599.23,-460.18 27583,-527 27580.69,-536.52 27576.64,-546.22 27572.19,-555.03"/>
<polygon fill="black" stroke="black" points="27569.1,-553.37 27567.45,-563.84 27575.27,-556.69 27569.1,-553.37"/>
</g>
<!-- l0_residual_0&#45;&gt;l0_mlp_fc_0 -->
<g id="edge11" class="edge">
<title>l0_residual_0&#45;&gt;l0_mlp_fc_0</title>
<path fill="none" stroke="black" d="M27524.59,-563.92C27507.33,-547.54 27484.64,-525.98 27466.03,-508.32"/>
<polygon fill="black" stroke="black" points="27468,-505.36 27458.34,-501.01 27463.18,-510.43 27468,-505.36"/>
</g>
<!-- l0_concat_0 -->
<g id="node12" class="node">
<title>l0_concat_0</title>
<polygon fill="lightyellow" stroke="black" points="35340.43,-527 34881.6,-527 34763.57,-423 35222.4,-423 35340.43,-527"/>
<text text-anchor="middle" x="35052" y="-489" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="35052" y="-478" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="35052" y="-467" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="35052" y="-456" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- l0_residual_0&#45;&gt;l0_concat_0 -->
<g id="edge14" class="edge">
<title>l0_residual_0&#45;&gt;l0_concat_0</title>
<path fill="none" stroke="black" d="M27690.01,-587.67C28089.82,-583.86 29277.19,-572.6 30263,-564 30762.11,-559.64 34257.85,-571.44 34755,-527 34787.47,-524.1 34821.72,-519.59 34854.97,-514.42"/>
<polygon fill="black" stroke="black" points="34855.92,-517.82 34865.26,-512.8 34854.83,-510.9 34855.92,-517.82"/>
</g>
<!-- l1_split_q_0 -->
<g id="node90" class="node">
<title>l1_split_q_0</title>
<polygon fill="lightyellow" stroke="black" points="43364.43,-365 42905.6,-365 42787.57,-261 43246.4,-261 43364.43,-365"/>
<text text-anchor="middle" x="43076" y="-327" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="43076" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="43076" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="43076" y="-294" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- l0_concat_0&#45;&gt;l1_split_q_0 -->
<g id="edge15" class="edge">
<title>l0_concat_0&#45;&gt;l1_split_q_0</title>
<path fill="none" stroke="black" d="M43076,-404C43083.59,-396.35 43087.08,-386.29 43088.15,-375.67"/>
<polygon fill="black" stroke="black" points="43091.66,-375.49 43088.47,-365.38 43084.66,-375.27 43091.66,-375.49"/>
</g>
<!-- l1_split_k_0 -->
<g id="node91" class="node">
<title>l1_split_k_0</title>
<polygon fill="lightyellow" stroke="black" points="43958.43,-365 43499.6,-365 43381.57,-261 43840.4,-261 43958.43,-365"/>
<text text-anchor="middle" x="43670" y="-327" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="43670" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="43670" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="43670" y="-294" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- l0_concat_0&#45;&gt;l1_split_k_0 -->
<g id="edge16" class="edge">
<title>l0_concat_0&#45;&gt;l1_split_k_0</title>
<path fill="none" stroke="black" d="M43076,-404C43087.62,-392.28 43356.67,-398.44 43373,-396 43415.7,-389.63 43461,-379.12 43503.01,-367.72"/>
<polygon fill="black" stroke="black" points="43504.05,-371.07 43512.77,-365.04 43502.2,-364.32 43504.05,-371.07"/>
</g>
<!-- l1_split_v_0 -->
<g id="node92" class="node">
<title>l1_split_v_0</title>
<polygon fill="lightyellow" stroke="black" points="42770.43,-365 42311.6,-365 42193.57,-261 42652.4,-261 42770.43,-365"/>
<text text-anchor="middle" x="42482" y="-327" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="42482" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="42482" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="42482" y="-294" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- l0_concat_0&#45;&gt;l1_split_v_0 -->
<g id="edge17" class="edge">
<title>l0_concat_0&#45;&gt;l1_split_v_0</title>
<path fill="none" stroke="black" d="M35238.73,-437.03C35275.16,-431.21 35313.17,-426.1 35349,-423 35375.73,-420.69 43057.11,-424.05 43076,-405"/>
<path fill="none" stroke="black" d="M43076,-404C43087.62,-392.28 42795.33,-398.44 42779,-396 42736.3,-389.63 42691,-379.12 42648.99,-367.72"/>
<polygon fill="black" stroke="black" points="42649.8,-364.32 42639.23,-365.04 42647.95,-371.07 42649.8,-364.32"/>
</g>
<!-- l0_q_proj_1 -->
<g id="node16" class="node">
<title>l0_q_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="27728,-794 27450,-794 27450,-742 27728,-742 27728,-794"/>
<text text-anchor="middle" x="27589" y="-782" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="27589" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="27589" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="27589" y="-749" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- l0_split_q_1&#45;&gt;l0_q_proj_1 -->
<g id="edge22" class="edge">
<title>l0_split_q_1&#45;&gt;l0_q_proj_1</title>
<path fill="none" stroke="black" d="M27447,-830.95C27472.8,-819.7 27499.27,-808.15 27522.26,-798.12"/>
<polygon fill="black" stroke="black" points="27523.79,-801.27 27531.56,-794.06 27520.99,-794.85 27523.79,-801.27"/>
</g>
<!-- l0_k_proj_1 -->
<g id="node17" class="node">
<title>l0_k_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="28245,-794 27967,-794 27967,-742 28245,-742 28245,-794"/>
<text text-anchor="middle" x="28106" y="-782" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="28106" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="28106" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="28106" y="-749" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- l0_split_k_1&#45;&gt;l0_k_proj_1 -->
<g id="edge23" class="edge">
<title>l0_split_k_1&#45;&gt;l0_k_proj_1</title>
<path fill="none" stroke="black" d="M28006.21,-830.95C28023.38,-820.3 28040.97,-809.38 28056.5,-799.73"/>
<polygon fill="black" stroke="black" points="28058.74,-802.46 28065.39,-794.21 28055.05,-796.51 28058.74,-802.46"/>
</g>
<!-- l0_v_proj_1 -->
<g id="node18" class="node">
<title>l0_v_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="28541,-794 28263,-794 28263,-742 28541,-742 28541,-794"/>
<text text-anchor="middle" x="28402" y="-782" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="28402" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="28402" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="28402" y="-749" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- l0_split_v_1&#45;&gt;l0_v_proj_1 -->
<g id="edge24" class="edge">
<title>l0_split_v_1&#45;&gt;l0_v_proj_1</title>
<path fill="none" stroke="black" d="M28465.43,-830.79C28455.12,-820.75 28444.58,-810.48 28435.12,-801.27"/>
<polygon fill="black" stroke="black" points="28437.4,-798.6 28427.8,-794.13 28432.52,-803.62 28437.4,-798.6"/>
</g>
<!-- l0_mha_1 -->
<g id="node19" class="node">
<title>l0_mha_1</title>
<polygon fill="lightgreen" stroke="black" points="29745,-705 29467,-705 29467,-653 29745,-653 29745,-705"/>
<text text-anchor="middle" x="29606" y="-693" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="29606" y="-682" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="29606" y="-671" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="29606" y="-660" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- l0_q_proj_1&#45;&gt;l0_mha_1 -->
<g id="edge25" class="edge">
<title>l0_q_proj_1&#45;&gt;l0_mha_1</title>
<path fill="none" stroke="black" d="M27728.29,-757.34C27797.37,-752.6 27882.07,-746.88 27958,-742 28089.53,-733.55 28123.08,-739.19 28254,-724"/>
<path fill="none" stroke="black" d="M28254,-723C28482.85,-696.45 29155.11,-685.34 29456.65,-681.6"/>
<polygon fill="black" stroke="black" points="29456.82,-685.09 29466.78,-681.47 29456.74,-678.09 29456.82,-685.09"/>
</g>
<!-- l0_k_proj_1&#45;&gt;l0_mha_1 -->
<g id="edge26" class="edge">
<title>l0_k_proj_1&#45;&gt;l0_mha_1</title>
<path fill="none" stroke="black" d="M28174.28,-741.99C28199.02,-734.32 28227.42,-727.08 28254,-724"/>
</g>
<!-- l0_v_proj_1&#45;&gt;l0_mha_1 -->
<g id="edge27" class="edge">
<title>l0_v_proj_1&#45;&gt;l0_mha_1</title>
<path fill="none" stroke="black" d="M28274.5,-741.99C28244.19,-734.32 28227.42,-727.08 28254,-724"/>
</g>
<!-- l0_residual_1 -->
<g id="node22" class="node">
<title>l0_residual_1</title>
<polygon fill="lightsteelblue" stroke="black" points="30550,-616 30272,-616 30272,-564 30550,-564 30550,-616"/>
<text text-anchor="middle" x="30411" y="-604" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="30411" y="-593" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="30411" y="-582" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="30411" y="-571" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- l0_mha_1&#45;&gt;l0_residual_1 -->
<g id="edge28" class="edge">
<title>l0_mha_1&#45;&gt;l0_residual_1</title>
<path fill="none" stroke="black" d="M29745.3,-662.95C29889.48,-647.36 30113.88,-623.11 30261.66,-607.14"/>
<polygon fill="black" stroke="black" points="30262.15,-610.61 30271.72,-606.05 30261.4,-603.65 30262.15,-610.61"/>
</g>
<!-- l0_mlp_fc_1 -->
<g id="node20" class="node">
<title>l0_mlp_fc_1</title>
<polygon fill="lightpink" stroke="black" points="30672,-501 30388,-501 30388,-449 30672,-449 30672,-501"/>
<text text-anchor="middle" x="30530" y="-489" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="30530" y="-478" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="30530" y="-467" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="30530" y="-456" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- l0_mlp_proj_1 -->
<g id="node21" class="node">
<title>l0_mlp_proj_1</title>
<polygon fill="lightpink" stroke="black" points="30549,-339 30271,-339 30271,-287 30549,-287 30549,-339"/>
<text text-anchor="middle" x="30410" y="-327" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="30410" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="30410" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="30410" y="-294" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- l0_mlp_fc_1&#45;&gt;l0_mlp_proj_1 -->
<g id="edge30" class="edge">
<title>l0_mlp_fc_1&#45;&gt;l0_mlp_proj_1</title>
<path fill="none" stroke="black" d="M30510.99,-448.65C30490.45,-421.26 30457.63,-377.51 30435.02,-347.35"/>
<polygon fill="black" stroke="black" points="30437.73,-345.13 30428.93,-339.23 30432.13,-349.33 30437.73,-345.13"/>
</g>
<!-- l0_mlp_proj_1&#45;&gt;l0_residual_1 -->
<g id="edge31" class="edge">
<title>l0_mlp_proj_1&#45;&gt;l0_residual_1</title>
<path fill="none" stroke="black" d="M30400.17,-339.21C30385.89,-379.38 30362.77,-460.18 30379,-527 30381.31,-536.52 30385.36,-546.22 30389.81,-555.03"/>
<polygon fill="black" stroke="black" points="30386.73,-556.69 30394.55,-563.84 30392.9,-553.37 30386.73,-556.69"/>
</g>
<!-- l0_residual_1&#45;&gt;l0_mlp_fc_1 -->
<g id="edge29" class="edge">
<title>l0_residual_1&#45;&gt;l0_mlp_fc_1</title>
<path fill="none" stroke="black" d="M30437.41,-563.92C30454.67,-547.54 30477.36,-525.98 30495.97,-508.32"/>
<polygon fill="black" stroke="black" points="30498.82,-510.43 30503.66,-501.01 30494,-505.36 30498.82,-510.43"/>
</g>
<!-- l0_concat_1 -->
<g id="node23" class="node">
<title>l0_concat_1</title>
<polygon fill="lightyellow" stroke="black" points="35934.43,-527 35475.6,-527 35357.57,-423 35816.4,-423 35934.43,-527"/>
<text text-anchor="middle" x="35646" y="-489" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="35646" y="-478" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="35646" y="-467" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="35646" y="-456" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- l0_residual_1&#45;&gt;l0_concat_1 -->
<g id="edge32" class="edge">
<title>l0_residual_1&#45;&gt;l0_concat_1</title>
<path fill="none" stroke="black" d="M30550.09,-586.51C30835.29,-581.5 31507.01,-570.14 32071,-564 33264.29,-551.01 33562.86,-569.11 34756,-546 35019.64,-540.89 35086.65,-553.6 35349,-527 35381.19,-523.74 35415.17,-519.07 35448.18,-513.88"/>
<polygon fill="black" stroke="black" points="35449.07,-517.28 35458.4,-512.25 35447.97,-510.37 35449.07,-517.28"/>
</g>
<!-- l1_split_q_1 -->
<g id="node101" class="node">
<title>l1_split_q_1</title>
<polygon fill="lightyellow" stroke="black" points="47224.43,-365 46765.6,-365 46647.57,-261 47106.4,-261 47224.43,-365"/>
<text text-anchor="middle" x="46936" y="-327" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="46936" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="46936" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="46936" y="-294" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- l0_concat_1&#45;&gt;l1_split_q_1 -->
<g id="edge33" class="edge">
<title>l0_concat_1&#45;&gt;l1_split_q_1</title>
<path fill="none" stroke="black" d="M35832.73,-437.01C35869.16,-431.19 35907.16,-426.08 35943,-423 35963.04,-421.28 47515.82,-419.27 47530,-405"/>
<path fill="none" stroke="black" d="M47530,-404C47541.64,-392.29 47249.33,-398.44 47233,-396 47190.3,-389.63 47145,-379.12 47102.99,-367.72"/>
<polygon fill="black" stroke="black" points="47103.8,-364.32 47093.23,-365.04 47101.95,-371.07 47103.8,-364.32"/>
</g>
<!-- l1_split_k_1 -->
<g id="node102" class="node">
<title>l1_split_k_1</title>
<polygon fill="lightyellow" stroke="black" points="47818.43,-365 47359.6,-365 47241.57,-261 47700.4,-261 47818.43,-365"/>
<text text-anchor="middle" x="47530" y="-327" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="47530" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="47530" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="47530" y="-294" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- l0_concat_1&#45;&gt;l1_split_k_1 -->
<g id="edge34" class="edge">
<title>l0_concat_1&#45;&gt;l1_split_k_1</title>
<path fill="none" stroke="black" d="M47530,-404C47537.6,-396.36 47541.1,-386.3 47542.17,-375.69"/>
<polygon fill="black" stroke="black" points="47545.67,-375.51 47542.49,-365.4 47538.68,-375.28 47545.67,-375.51"/>
</g>
<!-- l1_split_v_1 -->
<g id="node103" class="node">
<title>l1_split_v_1</title>
<polygon fill="lightyellow" stroke="black" points="48412.43,-365 47953.6,-365 47835.57,-261 48294.4,-261 48412.43,-365"/>
<text text-anchor="middle" x="48124" y="-327" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="48124" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="48124" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="48124" y="-294" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- l0_concat_1&#45;&gt;l1_split_v_1 -->
<g id="edge35" class="edge">
<title>l0_concat_1&#45;&gt;l1_split_v_1</title>
<path fill="none" stroke="black" d="M47530,-404C47541.64,-392.29 47810.67,-398.44 47827,-396 47869.7,-389.63 47915,-379.12 47957.01,-367.72"/>
<polygon fill="black" stroke="black" points="47958.05,-371.07 47966.77,-365.04 47956.2,-364.32 47958.05,-371.07"/>
</g>
<!-- l0_q_proj_2 -->
<g id="node27" class="node">
<title>l0_q_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="29475,-794 29197,-794 29197,-742 29475,-742 29475,-794"/>
<text text-anchor="middle" x="29336" y="-782" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="29336" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="29336" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="29336" y="-749" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- l0_split_q_2&#45;&gt;l0_q_proj_2 -->
<g id="edge40" class="edge">
<title>l0_split_q_2&#45;&gt;l0_q_proj_2</title>
<path fill="none" stroke="black" d="M29213.19,-830.95C29235.11,-819.9 29257.58,-808.56 29277.22,-798.65"/>
<polygon fill="black" stroke="black" points="29278.97,-801.69 29286.32,-794.06 29275.81,-795.44 29278.97,-801.69"/>
</g>
<!-- l0_k_proj_2 -->
<g id="node28" class="node">
<title>l0_k_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="30032,-794 29754,-794 29754,-742 30032,-742 30032,-794"/>
<text text-anchor="middle" x="29893" y="-782" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="29893" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="29893" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="29893" y="-749" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- l0_split_k_2&#45;&gt;l0_k_proj_2 -->
<g id="edge41" class="edge">
<title>l0_split_k_2&#45;&gt;l0_k_proj_2</title>
<path fill="none" stroke="black" d="M29790.47,-830.95C29808.28,-820.2 29826.52,-809.17 29842.59,-799.46"/>
<polygon fill="black" stroke="black" points="29844.53,-802.38 29851.28,-794.21 29840.91,-796.39 29844.53,-802.38"/>
</g>
<!-- l0_v_proj_2 -->
<g id="node29" class="node">
<title>l0_v_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="30328,-794 30050,-794 30050,-742 30328,-742 30328,-794"/>
<text text-anchor="middle" x="30189" y="-782" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="30189" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="30189" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="30189" y="-749" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- l0_split_v_2&#45;&gt;l0_v_proj_2 -->
<g id="edge42" class="edge">
<title>l0_split_v_2&#45;&gt;l0_v_proj_2</title>
<path fill="none" stroke="black" d="M30249.7,-830.79C30239.83,-820.75 30229.74,-810.48 30220.69,-801.27"/>
<polygon fill="black" stroke="black" points="30223.19,-798.81 30213.69,-794.13 30218.2,-803.72 30223.19,-798.81"/>
</g>
<!-- l0_mha_2 -->
<g id="node30" class="node">
<title>l0_mha_2</title>
<polygon fill="lightgreen" stroke="black" points="31100,-705 30822,-705 30822,-653 31100,-653 31100,-705"/>
<text text-anchor="middle" x="30961" y="-693" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="30961" y="-682" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="30961" y="-671" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="30961" y="-660" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- l0_q_proj_2&#45;&gt;l0_mha_2 -->
<g id="edge43" class="edge">
<title>l0_q_proj_2&#45;&gt;l0_mha_2</title>
<path fill="none" stroke="black" d="M29475.14,-758.48C29554.26,-753.64 29655.18,-747.48 29745,-742 29876.55,-733.98 29910.11,-739.48 30041,-724"/>
<path fill="none" stroke="black" d="M30041,-723C30311.39,-691.02 30629.12,-682.56 30811.58,-680.48"/>
<polygon fill="black" stroke="black" points="30811.82,-683.97 30821.78,-680.37 30811.74,-676.98 30811.82,-683.97"/>
</g>
<!-- l0_k_proj_2&#45;&gt;l0_mha_2 -->
<g id="edge44" class="edge">
<title>l0_k_proj_2&#45;&gt;l0_mha_2</title>
<path fill="none" stroke="black" d="M29961.66,-741.94C29986.32,-734.32 30014.56,-727.13 30041,-724"/>
</g>
<!-- l0_v_proj_2&#45;&gt;l0_mha_2 -->
<g id="edge45" class="edge">
<title>l0_v_proj_2&#45;&gt;l0_mha_2</title>
<path fill="none" stroke="black" d="M30061.05,-741.94C30031.03,-734.32 30014.56,-727.13 30041,-724"/>
</g>
<!-- l0_residual_2 -->
<g id="node33" class="node">
<title>l0_residual_2</title>
<polygon fill="lightsteelblue" stroke="black" points="32358,-616 32080,-616 32080,-564 32358,-564 32358,-616"/>
<text text-anchor="middle" x="32219" y="-604" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="32219" y="-593" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="32219" y="-582" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="32219" y="-571" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- l0_mha_2&#45;&gt;l0_residual_2 -->
<g id="edge46" class="edge">
<title>l0_mha_2&#45;&gt;l0_residual_2</title>
<path fill="none" stroke="black" d="M31100.13,-668.38C31338.82,-651.87 31824.29,-618.3 32069.75,-601.32"/>
<polygon fill="black" stroke="black" points="32070.09,-604.81 32079.82,-600.63 32069.6,-597.82 32070.09,-604.81"/>
</g>
<!-- l0_mlp_fc_2 -->
<g id="node31" class="node">
<title>l0_mlp_fc_2</title>
<polygon fill="lightpink" stroke="black" points="32217,-501 31933,-501 31933,-449 32217,-449 32217,-501"/>
<text text-anchor="middle" x="32075" y="-489" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="32075" y="-478" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="32075" y="-467" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="32075" y="-456" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- l0_mlp_proj_2 -->
<g id="node32" class="node">
<title>l0_mlp_proj_2</title>
<polygon fill="lightpink" stroke="black" points="32334,-339 32056,-339 32056,-287 32334,-287 32334,-339"/>
<text text-anchor="middle" x="32195" y="-327" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="32195" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="32195" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="32195" y="-294" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- l0_mlp_fc_2&#45;&gt;l0_mlp_proj_2 -->
<g id="edge48" class="edge">
<title>l0_mlp_fc_2&#45;&gt;l0_mlp_proj_2</title>
<path fill="none" stroke="black" d="M32094.01,-448.65C32114.55,-421.26 32147.37,-377.51 32169.98,-347.35"/>
<polygon fill="black" stroke="black" points="32172.87,-349.33 32176.07,-339.23 32167.27,-345.13 32172.87,-349.33"/>
</g>
<!-- l0_mlp_proj_2&#45;&gt;l0_residual_2 -->
<g id="edge49" class="edge">
<title>l0_mlp_proj_2&#45;&gt;l0_residual_2</title>
<path fill="none" stroke="black" d="M32204.3,-339.12C32211.85,-360.94 32221.9,-393.58 32226,-423 32232.38,-468.78 32228.6,-480.85 32226,-527 32225.52,-535.61 32224.66,-544.86 32223.7,-553.53"/>
<polygon fill="black" stroke="black" points="32220.19,-553.38 32222.51,-563.72 32227.15,-554.19 32220.19,-553.38"/>
</g>
<!-- l0_residual_2&#45;&gt;l0_mlp_fc_2 -->
<g id="edge47" class="edge">
<title>l0_residual_2&#45;&gt;l0_mlp_fc_2</title>
<path fill="none" stroke="black" d="M32187.04,-563.92C32165.79,-547.24 32137.71,-525.21 32114.98,-507.37"/>
<polygon fill="black" stroke="black" points="32116.9,-504.43 32106.87,-501.01 32112.58,-509.94 32116.9,-504.43"/>
</g>
<!-- l0_concat_2 -->
<g id="node34" class="node">
<title>l0_concat_2</title>
<polygon fill="lightyellow" stroke="black" points="36528.43,-527 36069.6,-527 35951.57,-423 36410.4,-423 36528.43,-527"/>
<text text-anchor="middle" x="36240" y="-489" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="36240" y="-478" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="36240" y="-467" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="36240" y="-456" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- l0_residual_2&#45;&gt;l0_concat_2 -->
<g id="edge50" class="edge">
<title>l0_residual_2&#45;&gt;l0_concat_2</title>
<path fill="none" stroke="black" d="M32358.03,-569.71C32379.41,-567.37 32401.27,-565.34 32422,-564 32730.81,-544.05 34897.59,-550.99 35207,-546 35534.18,-540.72 35617.35,-558.99 35943,-527 35975.32,-523.82 36009.43,-519.19 36042.56,-513.99"/>
<polygon fill="black" stroke="black" points="36043.49,-517.39 36052.81,-512.36 36042.39,-510.48 36043.49,-517.39"/>
</g>
<!-- l1_split_q_2 -->
<g id="node112" class="node">
<title>l1_split_q_2</title>
<polygon fill="lightyellow" stroke="black" points="51678.43,-365 51219.6,-365 51101.57,-261 51560.4,-261 51678.43,-365"/>
<text text-anchor="middle" x="51390" y="-327" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="51390" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="51390" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="51390" y="-294" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- l0_concat_2&#45;&gt;l1_split_q_2 -->
<g id="edge51" class="edge">
<title>l0_concat_2&#45;&gt;l1_split_q_2</title>
<path fill="none" stroke="black" d="M36426.73,-437C36463.16,-431.18 36501.16,-426.08 36537,-423 36563.72,-420.71 51965.08,-424.01 51984,-405"/>
<path fill="none" stroke="black" d="M51984,-404C51995.65,-392.3 51703.33,-398.44 51687,-396 51644.3,-389.63 51599,-379.12 51556.99,-367.72"/>
<polygon fill="black" stroke="black" points="51557.8,-364.32 51547.23,-365.04 51555.95,-371.07 51557.8,-364.32"/>
</g>
<!-- l1_split_k_2 -->
<g id="node113" class="node">
<title>l1_split_k_2</title>
<polygon fill="lightyellow" stroke="black" points="52272.43,-365 51813.6,-365 51695.57,-261 52154.4,-261 52272.43,-365"/>
<text text-anchor="middle" x="51984" y="-327" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="51984" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="51984" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="51984" y="-294" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- l0_concat_2&#45;&gt;l1_split_k_2 -->
<g id="edge52" class="edge">
<title>l0_concat_2&#45;&gt;l1_split_k_2</title>
<path fill="none" stroke="black" d="M51984,-404C51991.6,-396.36 51995.11,-386.31 51996.17,-375.7"/>
<polygon fill="black" stroke="black" points="51999.68,-375.52 51996.5,-365.41 51992.69,-375.29 51999.68,-375.52"/>
</g>
<!-- l1_split_v_2 -->
<g id="node114" class="node">
<title>l1_split_v_2</title>
<polygon fill="lightyellow" stroke="black" points="52866.43,-365 52407.6,-365 52289.57,-261 52748.4,-261 52866.43,-365"/>
<text text-anchor="middle" x="52578" y="-327" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="52578" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="52578" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="52578" y="-294" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- l0_concat_2&#45;&gt;l1_split_v_2 -->
<g id="edge53" class="edge">
<title>l0_concat_2&#45;&gt;l1_split_v_2</title>
<path fill="none" stroke="black" d="M51984,-404C51995.65,-392.3 52264.67,-398.44 52281,-396 52323.7,-389.63 52369,-379.12 52411.01,-367.72"/>
<polygon fill="black" stroke="black" points="52412.05,-371.07 52420.77,-365.04 52410.2,-364.32 52412.05,-371.07"/>
</g>
<!-- l0_q_proj_3 -->
<g id="node38" class="node">
<title>l0_q_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="31220,-794 30942,-794 30942,-742 31220,-742 31220,-794"/>
<text text-anchor="middle" x="31081" y="-782" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="31081" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="31081" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="31081" y="-749" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- l0_split_q_3&#45;&gt;l0_q_proj_3 -->
<g id="edge58" class="edge">
<title>l0_split_q_3&#45;&gt;l0_q_proj_3</title>
<path fill="none" stroke="black" d="M30978.47,-830.95C30996.28,-820.2 31014.52,-809.17 31030.59,-799.46"/>
<polygon fill="black" stroke="black" points="31032.53,-802.38 31039.28,-794.21 31028.91,-796.39 31032.53,-802.38"/>
</g>
<!-- l0_k_proj_3 -->
<g id="node39" class="node">
<title>l0_k_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="31702,-794 31424,-794 31424,-742 31702,-742 31702,-794"/>
<text text-anchor="middle" x="31563" y="-782" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="31563" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="31563" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="31563" y="-749" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- l0_split_k_3&#45;&gt;l0_k_proj_3 -->
<g id="edge59" class="edge">
<title>l0_split_k_3&#45;&gt;l0_k_proj_3</title>
<path fill="none" stroke="black" d="M31521.99,-830.79C31528.33,-821.24 31534.8,-811.49 31540.67,-802.64"/>
<polygon fill="black" stroke="black" points="31543.71,-804.4 31546.32,-794.13 31537.87,-800.53 31543.71,-804.4"/>
</g>
<!-- l0_v_proj_3 -->
<g id="node40" class="node">
<title>l0_v_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="31998,-794 31720,-794 31720,-742 31998,-742 31998,-794"/>
<text text-anchor="middle" x="31859" y="-782" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="31859" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="31859" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="31859" y="-749" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- l0_split_v_3&#45;&gt;l0_v_proj_3 -->
<g id="edge60" class="edge">
<title>l0_split_v_3&#45;&gt;l0_v_proj_3</title>
<path fill="none" stroke="black" d="M31981.26,-830.95C31959.44,-819.9 31937.07,-808.56 31917.52,-798.65"/>
<polygon fill="black" stroke="black" points="31918.96,-795.46 31908.46,-794.06 31915.8,-801.7 31918.96,-795.46"/>
</g>
<!-- l0_mha_3 -->
<g id="node41" class="node">
<title>l0_mha_3</title>
<polygon fill="lightgreen" stroke="black" points="31916,-705 31638,-705 31638,-653 31916,-653 31916,-705"/>
<text text-anchor="middle" x="31777" y="-693" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="31777" y="-682" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="31777" y="-671" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="31777" y="-660" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- l0_q_proj_3&#45;&gt;l0_mha_3 -->
<g id="edge61" class="edge">
<title>l0_q_proj_3&#45;&gt;l0_mha_3</title>
<path fill="none" stroke="black" d="M31220.02,-756.58C31382.21,-744.37 31629.09,-725.59 31634,-724"/>
<path fill="none" stroke="black" d="M31634,-723C31649.42,-718.02 31665.85,-712.91 31681.85,-708.02"/>
<polygon fill="black" stroke="black" points="31683.21,-711.27 31691.76,-705.02 31681.17,-704.57 31683.21,-711.27"/>
</g>
<!-- l0_k_proj_3&#45;&gt;l0_mha_3 -->
<g id="edge62" class="edge">
<title>l0_k_proj_3&#45;&gt;l0_mha_3</title>
<path fill="none" stroke="black" d="M31597.19,-741.91C31608.39,-734.92 31621.25,-728.12 31634,-724"/>
</g>
<!-- l0_v_proj_3&#45;&gt;l0_mha_3 -->
<g id="edge63" class="edge">
<title>l0_v_proj_3&#45;&gt;l0_mha_3</title>
<path fill="none" stroke="black" d="M31719.83,-742.99C31670.73,-734.08 31628.73,-725.7 31634,-724"/>
</g>
<!-- l0_residual_3 -->
<g id="node44" class="node">
<title>l0_residual_3</title>
<polygon fill="lightsteelblue" stroke="black" points="32709,-616 32431,-616 32431,-564 32709,-564 32709,-616"/>
<text text-anchor="middle" x="32570" y="-604" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="32570" y="-593" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="32570" y="-582" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="32570" y="-571" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- l0_mha_3&#45;&gt;l0_residual_3 -->
<g id="edge64" class="edge">
<title>l0_mha_3&#45;&gt;l0_residual_3</title>
<path fill="none" stroke="black" d="M31916.25,-664.07C32035.86,-651.94 32212.86,-633.59 32367,-616 32384.41,-614.01 32402.66,-611.86 32420.77,-609.69"/>
<polygon fill="black" stroke="black" points="32421.3,-613.15 32430.81,-608.47 32420.46,-606.2 32421.3,-613.15"/>
</g>
<!-- l0_mlp_fc_3 -->
<g id="node42" class="node">
<title>l0_mlp_fc_3</title>
<polygon fill="lightpink" stroke="black" points="32606,-501 32322,-501 32322,-449 32606,-449 32606,-501"/>
<text text-anchor="middle" x="32464" y="-489" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="32464" y="-478" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="32464" y="-467" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="32464" y="-456" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- l0_mlp_proj_3 -->
<g id="node43" class="node">
<title>l0_mlp_proj_3</title>
<polygon fill="lightpink" stroke="black" points="32684,-339 32406,-339 32406,-287 32684,-287 32684,-339"/>
<text text-anchor="middle" x="32545" y="-327" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="32545" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="32545" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="32545" y="-294" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- l0_mlp_fc_3&#45;&gt;l0_mlp_proj_3 -->
<g id="edge66" class="edge">
<title>l0_mlp_fc_3&#45;&gt;l0_mlp_proj_3</title>
<path fill="none" stroke="black" d="M32476.83,-448.65C32490.52,-421.61 32512.28,-378.63 32527.52,-348.52"/>
<polygon fill="black" stroke="black" points="32530.83,-349.74 32532.23,-339.23 32524.59,-346.57 32530.83,-349.74"/>
</g>
<!-- l0_mlp_proj_3&#45;&gt;l0_residual_3 -->
<g id="edge67" class="edge">
<title>l0_mlp_proj_3&#45;&gt;l0_residual_3</title>
<path fill="none" stroke="black" d="M32567.2,-339.2C32583.99,-360.05 32605.69,-391.28 32615,-423 32628.02,-467.35 32629.27,-483.04 32615,-527 32611.7,-537.16 32606.04,-547.05 32599.83,-555.84"/>
<polygon fill="black" stroke="black" points="32596.98,-553.8 32593.76,-563.9 32602.57,-558.01 32596.98,-553.8"/>
</g>
<!-- l0_residual_3&#45;&gt;l0_mlp_fc_3 -->
<g id="edge65" class="edge">
<title>l0_residual_3&#45;&gt;l0_mlp_fc_3</title>
<path fill="none" stroke="black" d="M32546.48,-563.92C32531.1,-547.54 32510.89,-525.98 32494.31,-508.32"/>
<polygon fill="black" stroke="black" points="32496.85,-505.91 32487.46,-501.01 32491.75,-510.7 32496.85,-505.91"/>
</g>
<!-- l0_concat_3 -->
<g id="node45" class="node">
<title>l0_concat_3</title>
<polygon fill="lightyellow" stroke="black" points="37122.43,-527 36663.6,-527 36545.57,-423 37004.4,-423 37122.43,-527"/>
<text text-anchor="middle" x="36834" y="-489" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="36834" y="-478" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="36834" y="-467" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="36834" y="-456" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- l0_residual_3&#45;&gt;l0_concat_3 -->
<g id="edge68" class="edge">
<title>l0_residual_3&#45;&gt;l0_concat_3</title>
<path fill="none" stroke="black" d="M32709.02,-582.89C32849.87,-576.97 33074.03,-568.27 33268,-564 34235.8,-542.67 34478.05,-558.43 35446,-546 35930.92,-539.77 36054.17,-572.39 36537,-527 36569.33,-523.96 36603.45,-519.4 36636.59,-514.22"/>
<polygon fill="black" stroke="black" points="36637.51,-517.62 36646.83,-512.6 36636.41,-510.71 36637.51,-517.62"/>
</g>
<!-- l1_split_q_3 -->
<g id="node123" class="node">
<title>l1_split_q_3</title>
<polygon fill="lightyellow" stroke="black" points="56132.43,-365 55673.6,-365 55555.57,-261 56014.4,-261 56132.43,-365"/>
<text text-anchor="middle" x="55844" y="-327" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="55844" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="55844" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="55844" y="-294" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- l0_concat_3&#45;&gt;l1_split_q_3 -->
<g id="edge69" class="edge">
<title>l0_concat_3&#45;&gt;l1_split_q_3</title>
<path fill="none" stroke="black" d="M37020.73,-436.99C37057.15,-431.17 37095.16,-426.07 37131,-423 37164.4,-420.14 56414.34,-428.74 56438,-405"/>
<path fill="none" stroke="black" d="M56438,-404C56449.65,-392.31 56157.33,-398.44 56141,-396 56098.3,-389.63 56053,-379.12 56010.99,-367.72"/>
<polygon fill="black" stroke="black" points="56011.8,-364.32 56001.23,-365.04 56009.95,-371.07 56011.8,-364.32"/>
</g>
<!-- l1_split_k_3 -->
<g id="node124" class="node">
<title>l1_split_k_3</title>
<polygon fill="lightyellow" stroke="black" points="56726.43,-365 56267.6,-365 56149.57,-261 56608.4,-261 56726.43,-365"/>
<text text-anchor="middle" x="56438" y="-327" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="56438" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="56438" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="56438" y="-294" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- l0_concat_3&#45;&gt;l1_split_k_3 -->
<g id="edge70" class="edge">
<title>l0_concat_3&#45;&gt;l1_split_k_3</title>
<path fill="none" stroke="black" d="M56438,-404C56445.61,-396.37 56449.11,-386.32 56450.18,-375.7"/>
<polygon fill="black" stroke="black" points="56453.69,-375.52 56450.51,-365.42 56446.69,-375.3 56453.69,-375.52"/>
</g>
<!-- l1_split_v_3 -->
<g id="node125" class="node">
<title>l1_split_v_3</title>
<polygon fill="lightyellow" stroke="black" points="57320.43,-365 56861.6,-365 56743.57,-261 57202.4,-261 57320.43,-365"/>
<text text-anchor="middle" x="57032" y="-327" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="57032" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="57032" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="57032" y="-294" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- l0_concat_3&#45;&gt;l1_split_v_3 -->
<g id="edge71" class="edge">
<title>l0_concat_3&#45;&gt;l1_split_v_3</title>
<path fill="none" stroke="black" d="M56438,-404C56449.65,-392.31 56718.67,-398.44 56735,-396 56777.7,-389.63 56823,-379.12 56865.01,-367.72"/>
<polygon fill="black" stroke="black" points="56866.05,-371.07 56874.77,-365.04 56864.2,-364.32 56866.05,-371.07"/>
</g>
<!-- l0_q_proj_4 -->
<g id="node49" class="node">
<title>l0_q_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="32898,-794 32620,-794 32620,-742 32898,-742 32898,-794"/>
<text text-anchor="middle" x="32759" y="-782" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="32759" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="32759" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="32759" y="-749" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- l0_split_q_4&#45;&gt;l0_q_proj_4 -->
<g id="edge76" class="edge">
<title>l0_split_q_4&#45;&gt;l0_q_proj_4</title>
<path fill="none" stroke="black" d="M32713.61,-830.79C32720.7,-821.14 32727.94,-811.29 32734.49,-802.36"/>
<polygon fill="black" stroke="black" points="32737.44,-804.26 32740.54,-794.13 32731.8,-800.12 32737.44,-804.26"/>
</g>
<!-- l0_k_proj_4 -->
<g id="node50" class="node">
<title>l0_k_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="33446,-794 33168,-794 33168,-742 33446,-742 33446,-794"/>
<text text-anchor="middle" x="33307" y="-782" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="33307" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="33307" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="33307" y="-749" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- l0_split_k_4&#45;&gt;l0_k_proj_4 -->
<g id="edge77" class="edge">
<title>l0_split_k_4&#45;&gt;l0_k_proj_4</title>
<path fill="none" stroke="black" d="M33286.77,-830.79C33289.76,-821.64 33292.82,-812.3 33295.62,-803.75"/>
<polygon fill="black" stroke="black" points="33298.99,-804.72 33298.77,-794.13 33292.33,-802.55 33298.99,-804.72"/>
</g>
<!-- l0_v_proj_4 -->
<g id="node51" class="node">
<title>l0_v_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="33742,-794 33464,-794 33464,-742 33742,-742 33742,-794"/>
<text text-anchor="middle" x="33603" y="-782" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="33603" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="33603" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="33603" y="-749" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- l0_split_v_4&#45;&gt;l0_v_proj_4 -->
<g id="edge78" class="edge">
<title>l0_split_v_4&#45;&gt;l0_v_proj_4</title>
<path fill="none" stroke="black" d="M33746.1,-830.95C33720.1,-819.7 33693.42,-808.15 33670.25,-798.12"/>
<polygon fill="black" stroke="black" points="33671.45,-794.82 33660.89,-794.06 33668.67,-801.25 33671.45,-794.82"/>
</g>
<!-- l0_mha_4 -->
<g id="node52" class="node">
<title>l0_mha_4</title>
<polygon fill="lightgreen" stroke="black" points="33482,-705 33204,-705 33204,-653 33482,-653 33482,-705"/>
<text text-anchor="middle" x="33343" y="-693" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="33343" y="-682" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="33343" y="-671" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="33343" y="-660" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- l0_q_proj_4&#45;&gt;l0_mha_4 -->
<g id="edge79" class="edge">
<title>l0_q_proj_4&#45;&gt;l0_mha_4</title>
<path fill="none" stroke="black" d="M32898.3,-758.26C33060.15,-747.8 33306.25,-730.86 33314,-724"/>
<path fill="none" stroke="black" d="M33314,-723C33317.19,-720.18 33320.19,-716.94 33322.96,-713.52"/>
<polygon fill="black" stroke="black" points="33325.86,-715.49 33328.99,-705.36 33320.23,-711.32 33325.86,-715.49"/>
</g>
<!-- l0_k_proj_4&#45;&gt;l0_mha_4 -->
<g id="edge80" class="edge">
<title>l0_k_proj_4&#45;&gt;l0_mha_4</title>
<path fill="none" stroke="black" d="M33305.58,-741.89C33306.52,-735.16 33308.9,-728.51 33314,-724"/>
</g>
<!-- l0_v_proj_4&#45;&gt;l0_mha_4 -->
<g id="edge81" class="edge">
<title>l0_v_proj_4&#45;&gt;l0_mha_4</title>
<path fill="none" stroke="black" d="M33463.98,-743.35C33460.96,-742.89 33457.96,-742.44 33455,-742 33423.75,-737.37 33290.34,-744.92 33314,-724"/>
</g>
<!-- l0_residual_4 -->
<g id="node55" class="node">
<title>l0_residual_4</title>
<polygon fill="lightsteelblue" stroke="black" points="33555,-616 33277,-616 33277,-564 33555,-564 33555,-616"/>
<text text-anchor="middle" x="33416" y="-604" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="33416" y="-593" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="33416" y="-582" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="33416" y="-571" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- l0_mha_4&#45;&gt;l0_residual_4 -->
<g id="edge82" class="edge">
<title>l0_mha_4&#45;&gt;l0_residual_4</title>
<path fill="none" stroke="black" d="M33364.11,-652.84C33371.68,-643.82 33380.33,-633.51 33388.36,-623.94"/>
<polygon fill="black" stroke="black" points="33391.19,-626.02 33394.93,-616.11 33385.82,-621.52 33391.19,-626.02"/>
</g>
<!-- l0_mlp_fc_4 -->
<g id="node53" class="node">
<title>l0_mlp_fc_4</title>
<polygon fill="lightpink" stroke="black" points="33677,-501 33393,-501 33393,-449 33677,-449 33677,-501"/>
<text text-anchor="middle" x="33535" y="-489" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="33535" y="-478" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="33535" y="-467" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="33535" y="-456" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- l0_mlp_proj_4 -->
<g id="node54" class="node">
<title>l0_mlp_proj_4</title>
<polygon fill="lightpink" stroke="black" points="33538,-339 33260,-339 33260,-287 33538,-287 33538,-339"/>
<text text-anchor="middle" x="33399" y="-327" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="33399" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="33399" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="33399" y="-294" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- l0_mlp_fc_4&#45;&gt;l0_mlp_proj_4 -->
<g id="edge84" class="edge">
<title>l0_mlp_fc_4&#45;&gt;l0_mlp_proj_4</title>
<path fill="none" stroke="black" d="M33513.45,-448.65C33490.07,-421.15 33452.67,-377.14 33427.02,-346.97"/>
<polygon fill="black" stroke="black" points="33429.59,-344.59 33420.45,-339.23 33424.26,-349.12 33429.59,-344.59"/>
</g>
<!-- l0_mlp_proj_4&#45;&gt;l0_residual_4 -->
<g id="edge85" class="edge">
<title>l0_mlp_proj_4&#45;&gt;l0_residual_4</title>
<path fill="none" stroke="black" d="M33392.37,-339.01C33382.78,-379.24 33367.86,-460.54 33384,-527 33386.31,-536.52 33390.36,-546.22 33394.81,-555.03"/>
<polygon fill="black" stroke="black" points="33391.73,-556.69 33399.55,-563.84 33397.9,-553.37 33391.73,-556.69"/>
</g>
<!-- l0_residual_4&#45;&gt;l0_mlp_fc_4 -->
<g id="edge83" class="edge">
<title>l0_residual_4&#45;&gt;l0_mlp_fc_4</title>
<path fill="none" stroke="black" d="M33442.41,-563.92C33459.67,-547.54 33482.36,-525.98 33500.97,-508.32"/>
<polygon fill="black" stroke="black" points="33503.82,-510.43 33508.66,-501.01 33499,-505.36 33503.82,-510.43"/>
</g>
<!-- l0_concat_4 -->
<g id="node56" class="node">
<title>l0_concat_4</title>
<polygon fill="lightyellow" stroke="black" points="37716.43,-527 37257.6,-527 37139.57,-423 37598.4,-423 37716.43,-527"/>
<text text-anchor="middle" x="37428" y="-489" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="37428" y="-478" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="37428" y="-467" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="37428" y="-456" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- l0_residual_4&#45;&gt;l0_concat_4 -->
<g id="edge86" class="edge">
<title>l0_residual_4&#45;&gt;l0_concat_4</title>
<path fill="none" stroke="black" d="M33555.28,-582.6C33691.17,-576.65 33903.73,-568.1 34088,-564 35180.2,-539.69 35453.74,-567.73 36546,-546 36806.09,-540.82 36872.2,-553.3 37131,-527 37163.19,-523.73 37197.17,-519.06 37230.18,-513.86"/>
<polygon fill="black" stroke="black" points="37231.07,-517.27 37240.39,-512.23 37229.97,-510.35 37231.07,-517.27"/>
</g>
<!-- l1_split_q_4 -->
<g id="node134" class="node">
<title>l1_split_q_4</title>
<polygon fill="lightyellow" stroke="black" points="60586.43,-365 60127.6,-365 60009.57,-261 60468.4,-261 60586.43,-365"/>
<text text-anchor="middle" x="60298" y="-327" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="60298" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="60298" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="60298" y="-294" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- l0_concat_4&#45;&gt;l1_split_q_4 -->
<g id="edge87" class="edge">
<title>l0_concat_4&#45;&gt;l1_split_q_4</title>
<path fill="none" stroke="black" d="M37614.72,-436.98C37651.15,-431.17 37689.16,-426.07 37725,-423 37745.04,-421.28 60877.8,-419.24 60892,-405"/>
<path fill="none" stroke="black" d="M60892,-404C60903.65,-392.31 60611.33,-398.44 60595,-396 60552.3,-389.63 60507,-379.12 60464.99,-367.72"/>
<polygon fill="black" stroke="black" points="60465.8,-364.32 60455.23,-365.04 60463.95,-371.07 60465.8,-364.32"/>
</g>
<!-- l1_split_k_4 -->
<g id="node135" class="node">
<title>l1_split_k_4</title>
<polygon fill="lightyellow" stroke="black" points="61180.43,-365 60721.6,-365 60603.57,-261 61062.4,-261 61180.43,-365"/>
<text text-anchor="middle" x="60892" y="-327" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="60892" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="60892" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="60892" y="-294" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- l0_concat_4&#45;&gt;l1_split_k_4 -->
<g id="edge88" class="edge">
<title>l0_concat_4&#45;&gt;l1_split_k_4</title>
<path fill="none" stroke="black" d="M60892,-404C60899.61,-396.37 60903.12,-386.32 60904.18,-375.71"/>
<polygon fill="black" stroke="black" points="60907.69,-375.53 60904.51,-365.42 60900.69,-375.3 60907.69,-375.53"/>
</g>
<!-- l1_split_v_4 -->
<g id="node136" class="node">
<title>l1_split_v_4</title>
<polygon fill="lightyellow" stroke="black" points="61774.43,-365 61315.6,-365 61197.57,-261 61656.4,-261 61774.43,-365"/>
<text text-anchor="middle" x="61486" y="-327" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="61486" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="61486" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="61486" y="-294" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- l0_concat_4&#45;&gt;l1_split_v_4 -->
<g id="edge89" class="edge">
<title>l0_concat_4&#45;&gt;l1_split_v_4</title>
<path fill="none" stroke="black" d="M60892,-404C60903.65,-392.31 61172.67,-398.44 61189,-396 61231.7,-389.63 61277,-379.12 61319.01,-367.72"/>
<polygon fill="black" stroke="black" points="61320.05,-371.07 61328.77,-365.04 61318.2,-364.32 61320.05,-371.07"/>
</g>
<!-- l0_q_proj_5 -->
<g id="node60" class="node">
<title>l0_q_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="34690,-794 34412,-794 34412,-742 34690,-742 34690,-794"/>
<text text-anchor="middle" x="34551" y="-782" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="34551" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="34551" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="34551" y="-749" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- l0_split_q_5&#45;&gt;l0_q_proj_5 -->
<g id="edge94" class="edge">
<title>l0_split_q_5&#45;&gt;l0_q_proj_5</title>
<path fill="none" stroke="black" d="M34500.15,-830.79C34508.17,-821.04 34516.36,-811.09 34523.77,-802.09"/>
<polygon fill="black" stroke="black" points="34526.66,-804.08 34530.32,-794.13 34521.26,-799.63 34526.66,-804.08"/>
</g>
<!-- l0_k_proj_5 -->
<g id="node61" class="node">
<title>l0_k_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="35135,-794 34857,-794 34857,-742 35135,-742 35135,-794"/>
<text text-anchor="middle" x="34996" y="-782" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="34996" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="34996" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="34996" y="-749" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- l0_split_k_5&#45;&gt;l0_k_proj_5 -->
<g id="edge95" class="edge">
<title>l0_split_k_5&#45;&gt;l0_k_proj_5</title>
<path fill="none" stroke="black" d="M35026.62,-830.79C35021.99,-821.44 35017.26,-811.9 35012.95,-803.2"/>
<polygon fill="black" stroke="black" points="35016.03,-801.54 35008.45,-794.13 35009.76,-804.65 35016.03,-801.54"/>
</g>
<!-- l0_v_proj_5 -->
<g id="node62" class="node">
<title>l0_v_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="35431,-794 35153,-794 35153,-742 35431,-742 35431,-794"/>
<text text-anchor="middle" x="35292" y="-782" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="35292" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="35292" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="35292" y="-749" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- l0_split_v_5&#45;&gt;l0_v_proj_5 -->
<g id="edge96" class="edge">
<title>l0_split_v_5&#45;&gt;l0_v_proj_5</title>
<path fill="none" stroke="black" d="M35486.09,-830.95C35449.72,-819.35 35412.39,-807.43 35380.3,-797.19"/>
<polygon fill="black" stroke="black" points="35381.1,-793.77 35370.51,-794.06 35378.98,-800.44 35381.1,-793.77"/>
</g>
<!-- l0_mha_5 -->
<g id="node63" class="node">
<title>l0_mha_5</title>
<polygon fill="lightgreen" stroke="black" points="34673,-705 34395,-705 34395,-653 34673,-653 34673,-705"/>
<text text-anchor="middle" x="34534" y="-693" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="34534" y="-682" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="34534" y="-671" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="34534" y="-660" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- l0_q_proj_5&#45;&gt;l0_mha_5 -->
<g id="edge97" class="edge">
<title>l0_q_proj_5&#45;&gt;l0_mha_5</title>
<path fill="none" stroke="black" d="M34690.17,-755.14C34821.17,-743.74 34997.22,-727.71 34996,-724"/>
<path fill="none" stroke="black" d="M34996,-723C34986.13,-692.95 34814.53,-683.59 34683.33,-680.84"/>
<polygon fill="black" stroke="black" points="34683.23,-677.34 34673.16,-680.64 34683.09,-684.34 34683.23,-677.34"/>
</g>
<!-- l0_k_proj_5&#45;&gt;l0_mha_5 -->
<g id="edge98" class="edge">
<title>l0_k_proj_5&#45;&gt;l0_mha_5</title>
<path fill="none" stroke="black" d="M34998.63,-741.57C34998.53,-735.69 34997.82,-729.53 34996,-724"/>
</g>
<!-- l0_v_proj_5&#45;&gt;l0_mha_5 -->
<g id="edge99" class="edge">
<title>l0_v_proj_5&#45;&gt;l0_mha_5</title>
<path fill="none" stroke="black" d="M35152.98,-743.33C35149.96,-742.87 35146.97,-742.43 35144,-742 35127.61,-739.62 35001.17,-739.74 34996,-724"/>
</g>
<!-- l0_residual_5 -->
<g id="node66" class="node">
<title>l0_residual_5</title>
<polygon fill="lightsteelblue" stroke="black" points="34375,-616 34097,-616 34097,-564 34375,-564 34375,-616"/>
<text text-anchor="middle" x="34236" y="-604" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="34236" y="-593" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="34236" y="-582" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="34236" y="-571" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- l0_mha_5&#45;&gt;l0_residual_5 -->
<g id="edge100" class="edge">
<title>l0_mha_5&#45;&gt;l0_residual_5</title>
<path fill="none" stroke="black" d="M34448.21,-652.95C34411.75,-642.31 34369.09,-629.85 34331.62,-618.91"/>
<polygon fill="black" stroke="black" points="34332.28,-615.46 34321.7,-616.02 34330.32,-622.18 34332.28,-615.46"/>
</g>
<!-- l0_mlp_fc_5 -->
<g id="node64" class="node">
<title>l0_mlp_fc_5</title>
<polygon fill="lightpink" stroke="black" points="34082,-501 33798,-501 33798,-449 34082,-449 34082,-501"/>
<text text-anchor="middle" x="33940" y="-489" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="33940" y="-478" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="33940" y="-467" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="33940" y="-456" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- l0_mlp_proj_5 -->
<g id="node65" class="node">
<title>l0_mlp_proj_5</title>
<polygon fill="lightpink" stroke="black" points="34104,-339 33826,-339 33826,-287 34104,-287 34104,-339"/>
<text text-anchor="middle" x="33965" y="-327" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="33965" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="33965" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="33965" y="-294" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- l0_mlp_fc_5&#45;&gt;l0_mlp_proj_5 -->
<g id="edge102" class="edge">
<title>l0_mlp_fc_5&#45;&gt;l0_mlp_proj_5</title>
<path fill="none" stroke="black" d="M33943.96,-448.65C33948.15,-421.85 33954.79,-379.37 33959.48,-349.31"/>
<polygon fill="black" stroke="black" points="33962.97,-349.65 33961.06,-339.23 33956.06,-348.57 33962.97,-349.65"/>
</g>
<!-- l0_mlp_proj_5&#45;&gt;l0_residual_5 -->
<g id="edge103" class="edge">
<title>l0_mlp_proj_5&#45;&gt;l0_residual_5</title>
<path fill="none" stroke="black" d="M34006.39,-339.05C34034.71,-358.41 34070.67,-387.81 34091,-423 34114.54,-463.76 34082.51,-489.53 34111,-527 34120.96,-540.09 34134.43,-550.6 34148.85,-558.98"/>
<polygon fill="black" stroke="black" points="34147.47,-562.21 34157.92,-563.92 34150.81,-556.07 34147.47,-562.21"/>
</g>
<!-- l0_residual_5&#45;&gt;l0_mlp_fc_5 -->
<g id="edge101" class="edge">
<title>l0_residual_5&#45;&gt;l0_mlp_fc_5</title>
<path fill="none" stroke="black" d="M34148.43,-563.93C34130.93,-558.41 34112.78,-552.31 34096,-546 34064.17,-534.02 34029.6,-518.75 34001.1,-505.53"/>
<polygon fill="black" stroke="black" points="34002.22,-502.19 33991.68,-501.13 33999.26,-508.53 34002.22,-502.19"/>
</g>
<!-- l0_concat_5 -->
<g id="node67" class="node">
<title>l0_concat_5</title>
<polygon fill="lightyellow" stroke="black" points="38310.43,-527 37851.6,-527 37733.57,-423 38192.4,-423 38310.43,-527"/>
<text text-anchor="middle" x="38022" y="-489" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="38022" y="-478" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="38022" y="-467" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="38022" y="-456" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- l0_residual_5&#45;&gt;l0_concat_5 -->
<g id="edge104" class="edge">
<title>l0_residual_5&#45;&gt;l0_concat_5</title>
<path fill="none" stroke="black" d="M34375.04,-566.1C34382.46,-565.29 34389.81,-564.58 34397,-564 34700.8,-539.55 36835.27,-551.95 37140,-546 37400.09,-540.92 37466.2,-553.3 37725,-527 37757.19,-523.73 37791.17,-519.06 37824.18,-513.86"/>
<polygon fill="black" stroke="black" points="37825.07,-517.27 37834.39,-512.23 37823.97,-510.35 37825.07,-517.27"/>
</g>
<!-- l1_split_q_5 -->
<g id="node145" class="node">
<title>l1_split_q_5</title>
<polygon fill="lightyellow" stroke="black" points="65040.43,-365 64581.6,-365 64463.57,-261 64922.4,-261 65040.43,-365"/>
<text text-anchor="middle" x="64752" y="-327" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="64752" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="64752" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="64752" y="-294" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- l0_concat_5&#45;&gt;l1_split_q_5 -->
<g id="edge105" class="edge">
<title>l0_concat_5&#45;&gt;l1_split_q_5</title>
<path fill="none" stroke="black" d="M38208.72,-436.98C38245.15,-431.16 38283.16,-426.07 38319,-423 38342.38,-421 65329.43,-421.61 65346,-405"/>
<path fill="none" stroke="black" d="M65346,-404C65357.66,-392.31 65065.33,-398.44 65049,-396 65006.3,-389.63 64961,-379.12 64918.99,-367.72"/>
<polygon fill="black" stroke="black" points="64919.8,-364.32 64909.23,-365.04 64917.95,-371.07 64919.8,-364.32"/>
</g>
<!-- l1_split_k_5 -->
<g id="node146" class="node">
<title>l1_split_k_5</title>
<polygon fill="lightyellow" stroke="black" points="65634.43,-365 65175.6,-365 65057.57,-261 65516.4,-261 65634.43,-365"/>
<text text-anchor="middle" x="65346" y="-327" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="65346" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="65346" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="65346" y="-294" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- l0_concat_5&#45;&gt;l1_split_k_5 -->
<g id="edge106" class="edge">
<title>l0_concat_5&#45;&gt;l1_split_k_5</title>
<path fill="none" stroke="black" d="M65346,-404C65353.61,-396.37 65357.12,-386.32 65358.19,-375.71"/>
<polygon fill="black" stroke="black" points="65361.69,-375.53 65358.51,-365.42 65354.7,-375.31 65361.69,-375.53"/>
</g>
<!-- l1_split_v_5 -->
<g id="node147" class="node">
<title>l1_split_v_5</title>
<polygon fill="lightyellow" stroke="black" points="66228.43,-365 65769.6,-365 65651.57,-261 66110.4,-261 66228.43,-365"/>
<text text-anchor="middle" x="65940" y="-327" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="65940" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="65940" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="65940" y="-294" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- l0_concat_5&#45;&gt;l1_split_v_5 -->
<g id="edge107" class="edge">
<title>l0_concat_5&#45;&gt;l1_split_v_5</title>
<path fill="none" stroke="black" d="M65346,-404C65357.66,-392.31 65626.67,-398.44 65643,-396 65685.7,-389.63 65731,-379.12 65773.01,-367.72"/>
<polygon fill="black" stroke="black" points="65774.05,-371.07 65782.77,-365.04 65772.2,-364.32 65774.05,-371.07"/>
</g>
<!-- l0_q_proj_6 -->
<g id="node71" class="node">
<title>l0_q_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="36547,-794 36269,-794 36269,-742 36547,-742 36547,-794"/>
<text text-anchor="middle" x="36408" y="-782" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="36408" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="36408" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="36408" y="-749" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- l0_split_q_6&#45;&gt;l0_q_proj_6 -->
<g id="edge112" class="edge">
<title>l0_split_q_6&#45;&gt;l0_q_proj_6</title>
<path fill="none" stroke="black" d="M36316.14,-830.79C36331.81,-820.25 36347.85,-809.46 36362.05,-799.91"/>
<polygon fill="black" stroke="black" points="36364.29,-802.62 36370.64,-794.13 36360.39,-796.81 36364.29,-802.62"/>
</g>
<!-- l0_k_proj_6 -->
<g id="node72" class="node">
<title>l0_k_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="36917,-794 36639,-794 36639,-742 36917,-742 36917,-794"/>
<text text-anchor="middle" x="36778" y="-782" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="36778" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="36778" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="36778" y="-749" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- l0_split_k_6&#45;&gt;l0_k_proj_6 -->
<g id="edge113" class="edge">
<title>l0_split_k_6&#45;&gt;l0_k_proj_6</title>
<path fill="none" stroke="black" d="M36808.62,-830.79C36803.99,-821.44 36799.26,-811.9 36794.95,-803.2"/>
<polygon fill="black" stroke="black" points="36798.03,-801.54 36790.45,-794.13 36791.76,-804.65 36798.03,-801.54"/>
</g>
<!-- l0_v_proj_6 -->
<g id="node73" class="node">
<title>l0_v_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="37213,-794 36935,-794 36935,-742 37213,-742 37213,-794"/>
<text text-anchor="middle" x="37074" y="-782" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="37074" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="37074" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="37074" y="-749" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- l0_split_v_6&#45;&gt;l0_v_proj_6 -->
<g id="edge114" class="edge">
<title>l0_split_v_6&#45;&gt;l0_v_proj_6</title>
<path fill="none" stroke="black" d="M37268.09,-830.95C37231.72,-819.35 37194.39,-807.43 37162.3,-797.19"/>
<polygon fill="black" stroke="black" points="37163.1,-793.77 37152.51,-794.06 37160.98,-800.44 37163.1,-793.77"/>
</g>
<!-- l0_mha_6 -->
<g id="node74" class="node">
<title>l0_mha_6</title>
<polygon fill="lightgreen" stroke="black" points="35943,-705 35665,-705 35665,-653 35943,-653 35943,-705"/>
<text text-anchor="middle" x="35804" y="-693" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="35804" y="-682" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="35804" y="-671" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="35804" y="-660" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- l0_q_proj_6&#45;&gt;l0_mha_6 -->
<g id="edge115" class="edge">
<title>l0_q_proj_6&#45;&gt;l0_mha_6</title>
<path fill="none" stroke="black" d="M36547.02,-751.21C36652.12,-739.21 36778.37,-724.66 36778,-724"/>
<path fill="none" stroke="black" d="M36778,-723C36758.21,-687.58 36221.43,-681.1 35953.38,-680.07"/>
<polygon fill="black" stroke="black" points="35953.18,-676.57 35943.17,-680.04 35953.16,-683.57 35953.18,-676.57"/>
</g>
<!-- l0_k_proj_6&#45;&gt;l0_mha_6 -->
<g id="edge116" class="edge">
<title>l0_k_proj_6&#45;&gt;l0_mha_6</title>
<path fill="none" stroke="black" d="M36782.14,-741.82C36782.06,-735.68 36780.99,-729.34 36778,-724"/>
</g>
<!-- l0_v_proj_6&#45;&gt;l0_mha_6 -->
<g id="edge117" class="edge">
<title>l0_v_proj_6&#45;&gt;l0_mha_6</title>
<path fill="none" stroke="black" d="M36934.98,-743.33C36931.96,-742.87 36928.97,-742.43 36926,-742 36909.61,-739.62 36786.08,-738.46 36778,-724"/>
</g>
<!-- l0_residual_6 -->
<g id="node77" class="node">
<title>l0_residual_6</title>
<polygon fill="lightsteelblue" stroke="black" points="34684,-616 34406,-616 34406,-564 34684,-564 34684,-616"/>
<text text-anchor="middle" x="34545" y="-604" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="34545" y="-593" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="34545" y="-582" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="34545" y="-571" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- l0_mha_6&#45;&gt;l0_residual_6 -->
<g id="edge118" class="edge">
<title>l0_mha_6&#45;&gt;l0_residual_6</title>
<path fill="none" stroke="black" d="M35664.76,-668.38C35425.88,-651.87 34940.03,-618.3 34694.36,-601.32"/>
<polygon fill="black" stroke="black" points="34694.51,-597.82 34684.29,-600.63 34694.02,-604.81 34694.51,-597.82"/>
</g>
<!-- l0_mlp_fc_6 -->
<g id="node75" class="node">
<title>l0_mlp_fc_6</title>
<polygon fill="lightpink" stroke="black" points="34404,-501 34120,-501 34120,-449 34404,-449 34404,-501"/>
<text text-anchor="middle" x="34262" y="-489" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="34262" y="-478" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="34262" y="-467" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="34262" y="-456" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- l0_mlp_proj_6 -->
<g id="node76" class="node">
<title>l0_mlp_proj_6</title>
<polygon fill="lightpink" stroke="black" points="34415,-339 34137,-339 34137,-287 34415,-287 34415,-339"/>
<text text-anchor="middle" x="34276" y="-327" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="34276" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="34276" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="34276" y="-294" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- l0_mlp_fc_6&#45;&gt;l0_mlp_proj_6 -->
<g id="edge120" class="edge">
<title>l0_mlp_fc_6&#45;&gt;l0_mlp_proj_6</title>
<path fill="none" stroke="black" d="M34264.22,-448.65C34266.56,-421.85 34270.28,-379.37 34272.91,-349.31"/>
<polygon fill="black" stroke="black" points="34276.41,-349.5 34273.79,-339.23 34269.43,-348.89 34276.41,-349.5"/>
</g>
<!-- l0_mlp_proj_6&#45;&gt;l0_residual_6 -->
<g id="edge121" class="edge">
<title>l0_mlp_proj_6&#45;&gt;l0_residual_6</title>
<path fill="none" stroke="black" d="M34322.19,-339.12C34352.71,-358.14 34391.01,-387.1 34413,-423 34442.14,-470.57 34402.29,-503.14 34438,-546 34441.78,-550.53 34446.1,-554.59 34450.8,-558.23"/>
<polygon fill="black" stroke="black" points="34448.82,-561.11 34459.02,-563.95 34452.81,-555.36 34448.82,-561.11"/>
</g>
<!-- l0_residual_6&#45;&gt;l0_mlp_fc_6 -->
<g id="edge119" class="edge">
<title>l0_residual_6&#45;&gt;l0_mlp_fc_6</title>
<path fill="none" stroke="black" d="M34467,-563.9C34450.71,-558.29 34433.71,-552.17 34418,-546 34386.6,-533.67 34352.33,-518.49 34323.93,-505.42"/>
<polygon fill="black" stroke="black" points="34325.08,-502.1 34314.54,-501.08 34322.15,-508.45 34325.08,-502.1"/>
</g>
<!-- l0_concat_6 -->
<g id="node78" class="node">
<title>l0_concat_6</title>
<polygon fill="lightyellow" stroke="black" points="38904.43,-527 38445.6,-527 38327.57,-423 38786.4,-423 38904.43,-527"/>
<text text-anchor="middle" x="38616" y="-489" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="38616" y="-478" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="38616" y="-467" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="38616" y="-456" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- l0_residual_6&#45;&gt;l0_concat_6 -->
<g id="edge122" class="edge">
<title>l0_residual_6&#45;&gt;l0_concat_6</title>
<path fill="none" stroke="black" d="M34684.3,-586.73C35076.26,-580.35 36222.07,-561.68 37174,-546 37682.89,-537.62 37812.26,-574.43 38319,-527 38351.34,-523.97 38385.45,-519.42 38418.59,-514.25"/>
<polygon fill="black" stroke="black" points="38419.51,-517.65 38428.84,-512.62 38418.41,-510.73 38419.51,-517.65"/>
</g>
<!-- l1_split_q_6 -->
<g id="node156" class="node">
<title>l1_split_q_6</title>
<polygon fill="lightyellow" stroke="black" points="69494.43,-365 69035.6,-365 68917.57,-261 69376.4,-261 69494.43,-365"/>
<text text-anchor="middle" x="69206" y="-327" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="69206" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="69206" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="69206" y="-294" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- l0_concat_6&#45;&gt;l1_split_q_6 -->
<g id="edge123" class="edge">
<title>l0_concat_6&#45;&gt;l1_split_q_6</title>
<path fill="none" stroke="black" d="M38802.72,-436.98C38839.15,-431.16 38877.16,-426.07 38913,-423 38939.71,-420.72 69781.06,-423.98 69800,-405"/>
<path fill="none" stroke="black" d="M69800,-404C69811.66,-392.32 69519.33,-398.44 69503,-396 69460.3,-389.63 69415,-379.12 69372.99,-367.72"/>
<polygon fill="black" stroke="black" points="69373.8,-364.32 69363.23,-365.04 69371.95,-371.07 69373.8,-364.32"/>
</g>
<!-- l1_split_k_6 -->
<g id="node157" class="node">
<title>l1_split_k_6</title>
<polygon fill="lightyellow" stroke="black" points="70088.43,-365 69629.6,-365 69511.57,-261 69970.4,-261 70088.43,-365"/>
<text text-anchor="middle" x="69800" y="-327" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="69800" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="69800" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="69800" y="-294" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- l0_concat_6&#45;&gt;l1_split_k_6 -->
<g id="edge124" class="edge">
<title>l0_concat_6&#45;&gt;l1_split_k_6</title>
<path fill="none" stroke="black" d="M69800,-404C69807.61,-396.37 69811.12,-386.32 69812.19,-375.71"/>
<polygon fill="black" stroke="black" points="69815.7,-375.53 69812.52,-365.42 69808.7,-375.31 69815.7,-375.53"/>
</g>
<!-- l1_split_v_6 -->
<g id="node158" class="node">
<title>l1_split_v_6</title>
<polygon fill="lightyellow" stroke="black" points="70682.43,-365 70223.6,-365 70105.57,-261 70564.4,-261 70682.43,-365"/>
<text text-anchor="middle" x="70394" y="-327" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="70394" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="70394" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="70394" y="-294" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- l0_concat_6&#45;&gt;l1_split_v_6 -->
<g id="edge125" class="edge">
<title>l0_concat_6&#45;&gt;l1_split_v_6</title>
<path fill="none" stroke="black" d="M69800,-404C69811.66,-392.32 70080.67,-398.44 70097,-396 70139.7,-389.63 70185,-379.12 70227.01,-367.72"/>
<polygon fill="black" stroke="black" points="70228.05,-371.07 70236.77,-365.04 70226.2,-364.32 70228.05,-371.07"/>
</g>
<!-- l0_q_proj_7 -->
<g id="node82" class="node">
<title>l0_q_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="38385,-794 38107,-794 38107,-742 38385,-742 38385,-794"/>
<text text-anchor="middle" x="38246" y="-782" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="38246" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="38246" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="38246" y="-749" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- l0_split_q_7&#45;&gt;l0_q_proj_7 -->
<g id="edge130" class="edge">
<title>l0_split_q_7&#45;&gt;l0_q_proj_7</title>
<path fill="none" stroke="black" d="M38123.19,-830.95C38145.11,-819.9 38167.58,-808.56 38187.22,-798.65"/>
<polygon fill="black" stroke="black" points="38188.97,-801.69 38196.32,-794.06 38185.81,-795.44 38188.97,-801.69"/>
</g>
<!-- l0_k_proj_7 -->
<g id="node83" class="node">
<title>l0_k_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="38755,-794 38477,-794 38477,-742 38755,-742 38755,-794"/>
<text text-anchor="middle" x="38616" y="-782" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="38616" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="38616" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="38616" y="-749" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- l0_split_k_7&#45;&gt;l0_k_proj_7 -->
<g id="edge131" class="edge">
<title>l0_split_k_7&#45;&gt;l0_k_proj_7</title>
<path fill="none" stroke="black" d="M38616,-830.79C38616,-821.84 38616,-812.71 38616,-804.31"/>
<polygon fill="black" stroke="black" points="38619.5,-804.13 38616,-794.13 38612.5,-804.13 38619.5,-804.13"/>
</g>
<!-- l0_v_proj_7 -->
<g id="node84" class="node">
<title>l0_v_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="39051,-794 38773,-794 38773,-742 39051,-742 39051,-794"/>
<text text-anchor="middle" x="38912" y="-782" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="38912" y="-771" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="38912" y="-760" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="38912" y="-749" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- l0_split_v_7&#45;&gt;l0_v_proj_7 -->
<g id="edge132" class="edge">
<title>l0_split_v_7&#45;&gt;l0_v_proj_7</title>
<path fill="none" stroke="black" d="M39075.39,-830.95C39045.3,-819.55 39014.43,-807.84 38987.73,-797.72"/>
<polygon fill="black" stroke="black" points="38988.68,-794.34 38978.09,-794.06 38986.2,-800.88 38988.68,-794.34"/>
</g>
<!-- l0_mha_7 -->
<g id="node85" class="node">
<title>l0_mha_7</title>
<polygon fill="lightgreen" stroke="black" points="38755,-705 38477,-705 38477,-653 38755,-653 38755,-705"/>
<text text-anchor="middle" x="38616" y="-693" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="38616" y="-682" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="38616" y="-671" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="38616" y="-660" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- l0_q_proj_7&#45;&gt;l0_mha_7 -->
<g id="edge133" class="edge">
<title>l0_q_proj_7&#45;&gt;l0_mha_7</title>
<path fill="none" stroke="black" d="M38385.26,-751.19C38490.08,-739.22 38615.81,-724.73 38616,-724"/>
<path fill="none" stroke="black" d="M38616,-723C38616.64,-720.53 38617.11,-717.96 38617.44,-715.35"/>
<polygon fill="black" stroke="black" points="38620.94,-715.49 38618.11,-705.28 38613.95,-715.02 38620.94,-715.49"/>
</g>
<!-- l0_k_proj_7&#45;&gt;l0_mha_7 -->
<g id="edge134" class="edge">
<title>l0_k_proj_7&#45;&gt;l0_mha_7</title>
<path fill="none" stroke="black" d="M38613.89,-741.72C38613.97,-735.83 38614.54,-729.64 38616,-724"/>
</g>
<!-- l0_v_proj_7&#45;&gt;l0_mha_7 -->
<g id="edge135" class="edge">
<title>l0_v_proj_7&#45;&gt;l0_mha_7</title>
<path fill="none" stroke="black" d="M38772.98,-743.33C38769.96,-742.87 38766.97,-742.43 38764,-742 38747.61,-739.62 38611.85,-740.04 38616,-724"/>
</g>
<!-- l0_residual_7 -->
<g id="node88" class="node">
<title>l0_residual_7</title>
<polygon fill="lightsteelblue" stroke="black" points="38755,-616 38477,-616 38477,-564 38755,-564 38755,-616"/>
<text text-anchor="middle" x="38616" y="-604" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="38616" y="-593" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="38616" y="-582" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="38616" y="-571" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- l0_mha_7&#45;&gt;l0_residual_7 -->
<g id="edge136" class="edge">
<title>l0_mha_7&#45;&gt;l0_residual_7</title>
<path fill="none" stroke="black" d="M38616,-652.84C38616,-644.54 38616,-635.15 38616,-626.25"/>
<polygon fill="black" stroke="black" points="38619.5,-626.11 38616,-616.11 38612.5,-626.11 38619.5,-626.11"/>
</g>
<!-- l0_mlp_fc_7 -->
<g id="node86" class="node">
<title>l0_mlp_fc_7</title>
<polygon fill="lightpink" stroke="black" points="34746,-501 34462,-501 34462,-449 34746,-449 34746,-501"/>
<text text-anchor="middle" x="34604" y="-489" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="34604" y="-478" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="34604" y="-467" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="34604" y="-456" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- l0_mlp_proj_7 -->
<g id="node87" class="node">
<title>l0_mlp_proj_7</title>
<polygon fill="lightpink" stroke="black" points="34734,-339 34456,-339 34456,-287 34734,-287 34734,-339"/>
<text text-anchor="middle" x="34595" y="-327" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="34595" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="34595" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="34595" y="-294" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- l0_mlp_fc_7&#45;&gt;l0_mlp_proj_7 -->
<g id="edge138" class="edge">
<title>l0_mlp_fc_7&#45;&gt;l0_mlp_proj_7</title>
<path fill="none" stroke="black" d="M34602.57,-448.65C34601.07,-421.85 34598.68,-379.37 34596.99,-349.31"/>
<polygon fill="black" stroke="black" points="34600.48,-349.02 34596.42,-339.23 34593.49,-349.41 34600.48,-349.02"/>
</g>
<!-- l0_mlp_proj_7&#45;&gt;l0_residual_7 -->
<g id="edge139" class="edge">
<title>l0_mlp_proj_7&#45;&gt;l0_residual_7</title>
<path fill="none" stroke="black" d="M34541.89,-339.02C34509.74,-357.32 34471.48,-385.51 34453,-423 34432.56,-464.46 34420.56,-494.07 34453,-527 34488.94,-563.48 37726.53,-583.97 38466.54,-588.18"/>
<polygon fill="black" stroke="black" points="38466.7,-591.69 38476.72,-588.24 38466.74,-584.69 38466.7,-591.69"/>
</g>
<!-- l0_residual_7&#45;&gt;l0_mlp_fc_7 -->
<g id="edge137" class="edge">
<title>l0_residual_7&#45;&gt;l0_mlp_fc_7</title>
<path fill="none" stroke="black" d="M38755.21,-577.3C38816.62,-570.19 38874.93,-559.79 38874,-546"/>
<path fill="none" stroke="black" d="M38874,-545C38872.07,-516.46 34783.22,-531.7 34755,-527 34727.53,-522.42 34698.32,-513.56 34672.99,-504.5"/>
<polygon fill="black" stroke="black" points="34674.07,-501.17 34663.48,-501.02 34671.67,-507.74 34674.07,-501.17"/>
</g>
<!-- l0_concat_7 -->
<g id="node89" class="node">
<title>l0_concat_7</title>
<polygon fill="lightyellow" stroke="black" points="39498.43,-527 39039.6,-527 38921.57,-423 39380.4,-423 39498.43,-527"/>
<text text-anchor="middle" x="39210" y="-489" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="39210" y="-478" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="39210" y="-467" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="39210" y="-456" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- l0_residual_7&#45;&gt;l0_concat_7 -->
<g id="edge140" class="edge">
<title>l0_residual_7&#45;&gt;l0_concat_7</title>
<path fill="none" stroke="black" d="M38874,-545C38873.45,-536.79 38936.03,-522.8 39007.32,-509.56"/>
<polygon fill="black" stroke="black" points="39008.23,-512.95 39017.43,-507.7 39006.96,-506.07 39008.23,-512.95"/>
</g>
<!-- l1_split_q_7 -->
<g id="node167" class="node">
<title>l1_split_q_7</title>
<polygon fill="lightyellow" stroke="black" points="73948.43,-365 73489.6,-365 73371.57,-261 73830.4,-261 73948.43,-365"/>
<text text-anchor="middle" x="73660" y="-327" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="73660" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="73660" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="73660" y="-294" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- l0_concat_7&#45;&gt;l1_split_q_7 -->
<g id="edge141" class="edge">
<title>l0_concat_7&#45;&gt;l1_split_q_7</title>
<path fill="none" stroke="black" d="M39438.12,-473.83C42447.11,-471.5 74213.06,-446.02 74254,-405"/>
<path fill="none" stroke="black" d="M74254,-404C74265.66,-392.32 73973.33,-398.44 73957,-396 73914.3,-389.63 73869,-379.12 73826.99,-367.72"/>
<polygon fill="black" stroke="black" points="73827.8,-364.32 73817.23,-365.04 73825.95,-371.07 73827.8,-364.32"/>
</g>
<!-- l1_split_k_7 -->
<g id="node168" class="node">
<title>l1_split_k_7</title>
<polygon fill="lightyellow" stroke="black" points="74542.43,-365 74083.6,-365 73965.57,-261 74424.4,-261 74542.43,-365"/>
<text text-anchor="middle" x="74254" y="-327" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="74254" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="74254" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="74254" y="-294" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- l0_concat_7&#45;&gt;l1_split_k_7 -->
<g id="edge142" class="edge">
<title>l0_concat_7&#45;&gt;l1_split_k_7</title>
<path fill="none" stroke="black" d="M74254,-404C74261.61,-396.37 74265.12,-386.32 74266.19,-375.71"/>
<polygon fill="black" stroke="black" points="74269.7,-375.53 74266.52,-365.43 74262.7,-375.31 74269.7,-375.53"/>
</g>
<!-- l1_split_v_7 -->
<g id="node169" class="node">
<title>l1_split_v_7</title>
<polygon fill="lightyellow" stroke="black" points="75136.43,-365 74677.6,-365 74559.57,-261 75018.4,-261 75136.43,-365"/>
<text text-anchor="middle" x="74848" y="-327" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="74848" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="74848" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="74848" y="-294" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- l0_concat_7&#45;&gt;l1_split_v_7 -->
<g id="edge143" class="edge">
<title>l0_concat_7&#45;&gt;l1_split_v_7</title>
<path fill="none" stroke="black" d="M74254,-404C74265.66,-392.32 74534.67,-398.44 74551,-396 74593.7,-389.63 74639,-379.12 74681.01,-367.72"/>
<polygon fill="black" stroke="black" points="74682.05,-371.07 74690.77,-365.04 74680.2,-364.32 74682.05,-371.07"/>
</g>
<!-- l1_q_proj_0 -->
<g id="node93" class="node">
<title>l1_q_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="73354,-339 73076,-339 73076,-287 73354,-287 73354,-339"/>
<text text-anchor="middle" x="73215" y="-327" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="73215" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="73215" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="73215" y="-294" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- l1_k_proj_0 -->
<g id="node94" class="node">
<title>l1_k_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="73058,-339 72780,-339 72780,-287 73058,-287 73058,-339"/>
<text text-anchor="middle" x="72919" y="-327" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="72919" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="72919" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="72919" y="-294" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- l1_v_proj_0 -->
<g id="node95" class="node">
<title>l1_v_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="72762,-339 72484,-339 72484,-287 72762,-287 72762,-339"/>
<text text-anchor="middle" x="72623" y="-327" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="72623" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="72623" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="72623" y="-294" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- l1_mha_0 -->
<g id="node96" class="node">
<title>l1_mha_0</title>
<polygon fill="lightgreen" stroke="black" points="72466,-339 72188,-339 72188,-287 72466,-287 72466,-339"/>
<text text-anchor="middle" x="72327" y="-327" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="72327" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="72327" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="72327" y="-294" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- l1_mlp_fc_0 -->
<g id="node97" class="node">
<title>l1_mlp_fc_0</title>
<polygon fill="lightpink" stroke="black" points="72170,-339 71886,-339 71886,-287 72170,-287 72170,-339"/>
<text text-anchor="middle" x="72028" y="-327" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="72028" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="72028" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="72028" y="-294" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- l1_mlp_proj_0 -->
<g id="node98" class="node">
<title>l1_mlp_proj_0</title>
<polygon fill="lightpink" stroke="black" points="71868,-339 71590,-339 71590,-287 71868,-287 71868,-339"/>
<text text-anchor="middle" x="71729" y="-327" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="71729" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="71729" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="71729" y="-294" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- l1_residual_0 -->
<g id="node99" class="node">
<title>l1_residual_0</title>
<polygon fill="lightsteelblue" stroke="black" points="71572,-339 71294,-339 71294,-287 71572,-287 71572,-339"/>
<text text-anchor="middle" x="71433" y="-327" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="71433" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="71433" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="71433" y="-294" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- l1_concat_0 -->
<g id="node100" class="node">
<title>l1_concat_0</title>
<polygon fill="lightyellow" stroke="black" points="40098.43,-365 39639.6,-365 39521.57,-261 39980.4,-261 40098.43,-365"/>
<text text-anchor="middle" x="39810" y="-327" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="39810" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="39810" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="39810" y="-294" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- l2_split_q_0 -->
<g id="node178" class="node">
<title>l2_split_q_0</title>
<polygon fill="lightyellow" stroke="black" points="40098.43,-128 39639.6,-128 39521.57,-24 39980.4,-24 40098.43,-128"/>
<text text-anchor="middle" x="39810" y="-90" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="39810" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="39810" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="39810" y="-57" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- l1_concat_0&#45;&gt;l2_split_q_0 -->
<g id="edge18" class="edge">
<title>l1_concat_0&#45;&gt;l2_split_q_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39810,-260.72C39810,-224.8 39810,-176.61 39810,-138.6"/>
<polygon fill="black" stroke="black" points="39813.5,-138.17 39810,-128.17 39806.5,-138.17 39813.5,-138.17"/>
<text text-anchor="middle" x="39826" y="-230.6" font-family="Arial" font-size="8.00">PP Send</text>
</g>
<!-- l1_q_proj_1 -->
<g id="node104" class="node">
<title>l1_q_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="68900,-339 68622,-339 68622,-287 68900,-287 68900,-339"/>
<text text-anchor="middle" x="68761" y="-327" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="68761" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="68761" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="68761" y="-294" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- l1_k_proj_1 -->
<g id="node105" class="node">
<title>l1_k_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="68604,-339 68326,-339 68326,-287 68604,-287 68604,-339"/>
<text text-anchor="middle" x="68465" y="-327" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="68465" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="68465" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="68465" y="-294" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- l1_v_proj_1 -->
<g id="node106" class="node">
<title>l1_v_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="68308,-339 68030,-339 68030,-287 68308,-287 68308,-339"/>
<text text-anchor="middle" x="68169" y="-327" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="68169" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="68169" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="68169" y="-294" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- l1_mha_1 -->
<g id="node107" class="node">
<title>l1_mha_1</title>
<polygon fill="lightgreen" stroke="black" points="68012,-339 67734,-339 67734,-287 68012,-287 68012,-339"/>
<text text-anchor="middle" x="67873" y="-327" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="67873" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="67873" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="67873" y="-294" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- l1_mlp_fc_1 -->
<g id="node108" class="node">
<title>l1_mlp_fc_1</title>
<polygon fill="lightpink" stroke="black" points="67716,-339 67432,-339 67432,-287 67716,-287 67716,-339"/>
<text text-anchor="middle" x="67574" y="-327" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="67574" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="67574" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="67574" y="-294" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- l1_mlp_proj_1 -->
<g id="node109" class="node">
<title>l1_mlp_proj_1</title>
<polygon fill="lightpink" stroke="black" points="67414,-339 67136,-339 67136,-287 67414,-287 67414,-339"/>
<text text-anchor="middle" x="67275" y="-327" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="67275" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="67275" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="67275" y="-294" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- l1_residual_1 -->
<g id="node110" class="node">
<title>l1_residual_1</title>
<polygon fill="lightsteelblue" stroke="black" points="67118,-339 66840,-339 66840,-287 67118,-287 67118,-339"/>
<text text-anchor="middle" x="66979" y="-327" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="66979" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="66979" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="66979" y="-294" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- l1_concat_1 -->
<g id="node111" class="node">
<title>l1_concat_1</title>
<polygon fill="lightyellow" stroke="black" points="44552.43,-365 44093.6,-365 43975.57,-261 44434.4,-261 44552.43,-365"/>
<text text-anchor="middle" x="44264" y="-327" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="44264" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="44264" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="44264" y="-294" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- l2_split_q_1 -->
<g id="node189" class="node">
<title>l2_split_q_1</title>
<polygon fill="lightyellow" stroke="black" points="44552.43,-128 44093.6,-128 43975.57,-24 44434.4,-24 44552.43,-128"/>
<text text-anchor="middle" x="44264" y="-90" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="44264" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="44264" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="44264" y="-57" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- l1_concat_1&#45;&gt;l2_split_q_1 -->
<g id="edge36" class="edge">
<title>l1_concat_1&#45;&gt;l2_split_q_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M44264,-260.72C44264,-224.8 44264,-176.61 44264,-138.6"/>
<polygon fill="black" stroke="black" points="44267.5,-138.17 44264,-128.17 44260.5,-138.17 44267.5,-138.17"/>
<text text-anchor="middle" x="44280" y="-230.6" font-family="Arial" font-size="8.00">PP Send</text>
</g>
<!-- l1_q_proj_2 -->
<g id="node115" class="node">
<title>l1_q_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="64446,-339 64168,-339 64168,-287 64446,-287 64446,-339"/>
<text text-anchor="middle" x="64307" y="-327" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="64307" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="64307" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="64307" y="-294" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- l1_k_proj_2 -->
<g id="node116" class="node">
<title>l1_k_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="64150,-339 63872,-339 63872,-287 64150,-287 64150,-339"/>
<text text-anchor="middle" x="64011" y="-327" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="64011" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="64011" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="64011" y="-294" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- l1_v_proj_2 -->
<g id="node117" class="node">
<title>l1_v_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="63854,-339 63576,-339 63576,-287 63854,-287 63854,-339"/>
<text text-anchor="middle" x="63715" y="-327" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="63715" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="63715" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="63715" y="-294" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- l1_mha_2 -->
<g id="node118" class="node">
<title>l1_mha_2</title>
<polygon fill="lightgreen" stroke="black" points="63558,-339 63280,-339 63280,-287 63558,-287 63558,-339"/>
<text text-anchor="middle" x="63419" y="-327" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="63419" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="63419" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="63419" y="-294" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- l1_mlp_fc_2 -->
<g id="node119" class="node">
<title>l1_mlp_fc_2</title>
<polygon fill="lightpink" stroke="black" points="63262,-339 62978,-339 62978,-287 63262,-287 63262,-339"/>
<text text-anchor="middle" x="63120" y="-327" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="63120" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="63120" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="63120" y="-294" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- l1_mlp_proj_2 -->
<g id="node120" class="node">
<title>l1_mlp_proj_2</title>
<polygon fill="lightpink" stroke="black" points="62960,-339 62682,-339 62682,-287 62960,-287 62960,-339"/>
<text text-anchor="middle" x="62821" y="-327" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="62821" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="62821" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="62821" y="-294" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- l1_residual_2 -->
<g id="node121" class="node">
<title>l1_residual_2</title>
<polygon fill="lightsteelblue" stroke="black" points="62664,-339 62386,-339 62386,-287 62664,-287 62664,-339"/>
<text text-anchor="middle" x="62525" y="-327" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="62525" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="62525" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="62525" y="-294" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- l1_concat_2 -->
<g id="node122" class="node">
<title>l1_concat_2</title>
<polygon fill="lightyellow" stroke="black" points="49006.43,-365 48547.6,-365 48429.57,-261 48888.4,-261 49006.43,-365"/>
<text text-anchor="middle" x="48718" y="-327" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="48718" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="48718" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="48718" y="-294" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- l2_split_q_2 -->
<g id="node200" class="node">
<title>l2_split_q_2</title>
<polygon fill="lightyellow" stroke="black" points="49006.43,-128 48547.6,-128 48429.57,-24 48888.4,-24 49006.43,-128"/>
<text text-anchor="middle" x="48718" y="-90" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="48718" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="48718" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="48718" y="-57" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- l1_concat_2&#45;&gt;l2_split_q_2 -->
<g id="edge54" class="edge">
<title>l1_concat_2&#45;&gt;l2_split_q_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M48718,-260.72C48718,-224.8 48718,-176.61 48718,-138.6"/>
<polygon fill="black" stroke="black" points="48721.5,-138.17 48718,-128.17 48714.5,-138.17 48721.5,-138.17"/>
<text text-anchor="middle" x="48734" y="-230.6" font-family="Arial" font-size="8.00">PP Send</text>
</g>
<!-- l1_q_proj_3 -->
<g id="node126" class="node">
<title>l1_q_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="59992,-339 59714,-339 59714,-287 59992,-287 59992,-339"/>
<text text-anchor="middle" x="59853" y="-327" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="59853" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="59853" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="59853" y="-294" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- l1_k_proj_3 -->
<g id="node127" class="node">
<title>l1_k_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="59696,-339 59418,-339 59418,-287 59696,-287 59696,-339"/>
<text text-anchor="middle" x="59557" y="-327" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="59557" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="59557" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="59557" y="-294" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- l1_v_proj_3 -->
<g id="node128" class="node">
<title>l1_v_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="59400,-339 59122,-339 59122,-287 59400,-287 59400,-339"/>
<text text-anchor="middle" x="59261" y="-327" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="59261" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="59261" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="59261" y="-294" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- l1_mha_3 -->
<g id="node129" class="node">
<title>l1_mha_3</title>
<polygon fill="lightgreen" stroke="black" points="59104,-339 58826,-339 58826,-287 59104,-287 59104,-339"/>
<text text-anchor="middle" x="58965" y="-327" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="58965" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="58965" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="58965" y="-294" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- l1_mlp_fc_3 -->
<g id="node130" class="node">
<title>l1_mlp_fc_3</title>
<polygon fill="lightpink" stroke="black" points="58808,-339 58524,-339 58524,-287 58808,-287 58808,-339"/>
<text text-anchor="middle" x="58666" y="-327" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="58666" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="58666" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="58666" y="-294" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- l1_mlp_proj_3 -->
<g id="node131" class="node">
<title>l1_mlp_proj_3</title>
<polygon fill="lightpink" stroke="black" points="58506,-339 58228,-339 58228,-287 58506,-287 58506,-339"/>
<text text-anchor="middle" x="58367" y="-327" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="58367" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="58367" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="58367" y="-294" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- l1_residual_3 -->
<g id="node132" class="node">
<title>l1_residual_3</title>
<polygon fill="lightsteelblue" stroke="black" points="58210,-339 57932,-339 57932,-287 58210,-287 58210,-339"/>
<text text-anchor="middle" x="58071" y="-327" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="58071" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="58071" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="58071" y="-294" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- l1_concat_3 -->
<g id="node133" class="node">
<title>l1_concat_3</title>
<polygon fill="lightyellow" stroke="black" points="53460.43,-365 53001.6,-365 52883.57,-261 53342.4,-261 53460.43,-365"/>
<text text-anchor="middle" x="53172" y="-327" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="53172" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="53172" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="53172" y="-294" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- l2_split_q_3 -->
<g id="node211" class="node">
<title>l2_split_q_3</title>
<polygon fill="lightyellow" stroke="black" points="53460.43,-128 53001.6,-128 52883.57,-24 53342.4,-24 53460.43,-128"/>
<text text-anchor="middle" x="53172" y="-90" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="53172" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="53172" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="53172" y="-57" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- l1_concat_3&#45;&gt;l2_split_q_3 -->
<g id="edge72" class="edge">
<title>l1_concat_3&#45;&gt;l2_split_q_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53172,-260.72C53172,-224.8 53172,-176.61 53172,-138.6"/>
<polygon fill="black" stroke="black" points="53175.5,-138.17 53172,-128.17 53168.5,-138.17 53175.5,-138.17"/>
<text text-anchor="middle" x="53188" y="-230.6" font-family="Arial" font-size="8.00">PP Send</text>
</g>
<!-- l1_q_proj_4 -->
<g id="node137" class="node">
<title>l1_q_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="55538,-339 55260,-339 55260,-287 55538,-287 55538,-339"/>
<text text-anchor="middle" x="55399" y="-327" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="55399" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="55399" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="55399" y="-294" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- l1_k_proj_4 -->
<g id="node138" class="node">
<title>l1_k_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="55242,-339 54964,-339 54964,-287 55242,-287 55242,-339"/>
<text text-anchor="middle" x="55103" y="-327" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="55103" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="55103" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="55103" y="-294" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- l1_v_proj_4 -->
<g id="node139" class="node">
<title>l1_v_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="54946,-339 54668,-339 54668,-287 54946,-287 54946,-339"/>
<text text-anchor="middle" x="54807" y="-327" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="54807" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="54807" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="54807" y="-294" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- l1_mha_4 -->
<g id="node140" class="node">
<title>l1_mha_4</title>
<polygon fill="lightgreen" stroke="black" points="54650,-339 54372,-339 54372,-287 54650,-287 54650,-339"/>
<text text-anchor="middle" x="54511" y="-327" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="54511" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="54511" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="54511" y="-294" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- l1_mlp_fc_4 -->
<g id="node141" class="node">
<title>l1_mlp_fc_4</title>
<polygon fill="lightpink" stroke="black" points="54354,-339 54070,-339 54070,-287 54354,-287 54354,-339"/>
<text text-anchor="middle" x="54212" y="-327" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="54212" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="54212" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="54212" y="-294" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- l1_mlp_proj_4 -->
<g id="node142" class="node">
<title>l1_mlp_proj_4</title>
<polygon fill="lightpink" stroke="black" points="54052,-339 53774,-339 53774,-287 54052,-287 54052,-339"/>
<text text-anchor="middle" x="53913" y="-327" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="53913" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="53913" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="53913" y="-294" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- l1_residual_4 -->
<g id="node143" class="node">
<title>l1_residual_4</title>
<polygon fill="lightsteelblue" stroke="black" points="53756,-339 53478,-339 53478,-287 53756,-287 53756,-339"/>
<text text-anchor="middle" x="53617" y="-327" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="53617" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="53617" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="53617" y="-294" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- l1_concat_4 -->
<g id="node144" class="node">
<title>l1_concat_4</title>
<polygon fill="lightyellow" stroke="black" points="57914.43,-365 57455.6,-365 57337.57,-261 57796.4,-261 57914.43,-365"/>
<text text-anchor="middle" x="57626" y="-327" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="57626" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="57626" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="57626" y="-294" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- l2_split_q_4 -->
<g id="node222" class="node">
<title>l2_split_q_4</title>
<polygon fill="lightyellow" stroke="black" points="57914.43,-128 57455.6,-128 57337.57,-24 57796.4,-24 57914.43,-128"/>
<text text-anchor="middle" x="57626" y="-90" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="57626" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="57626" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="57626" y="-57" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- l1_concat_4&#45;&gt;l2_split_q_4 -->
<g id="edge90" class="edge">
<title>l1_concat_4&#45;&gt;l2_split_q_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57626,-260.72C57626,-224.8 57626,-176.61 57626,-138.6"/>
<polygon fill="black" stroke="black" points="57629.5,-138.17 57626,-128.17 57622.5,-138.17 57629.5,-138.17"/>
<text text-anchor="middle" x="57642" y="-230.6" font-family="Arial" font-size="8.00">PP Send</text>
</g>
<!-- l1_q_proj_5 -->
<g id="node148" class="node">
<title>l1_q_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="51084,-339 50806,-339 50806,-287 51084,-287 51084,-339"/>
<text text-anchor="middle" x="50945" y="-327" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="50945" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="50945" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="50945" y="-294" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- l1_k_proj_5 -->
<g id="node149" class="node">
<title>l1_k_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="50788,-339 50510,-339 50510,-287 50788,-287 50788,-339"/>
<text text-anchor="middle" x="50649" y="-327" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="50649" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="50649" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="50649" y="-294" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- l1_v_proj_5 -->
<g id="node150" class="node">
<title>l1_v_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="50492,-339 50214,-339 50214,-287 50492,-287 50492,-339"/>
<text text-anchor="middle" x="50353" y="-327" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="50353" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="50353" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="50353" y="-294" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- l1_mha_5 -->
<g id="node151" class="node">
<title>l1_mha_5</title>
<polygon fill="lightgreen" stroke="black" points="50196,-339 49918,-339 49918,-287 50196,-287 50196,-339"/>
<text text-anchor="middle" x="50057" y="-327" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="50057" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="50057" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="50057" y="-294" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- l1_mlp_fc_5 -->
<g id="node152" class="node">
<title>l1_mlp_fc_5</title>
<polygon fill="lightpink" stroke="black" points="49900,-339 49616,-339 49616,-287 49900,-287 49900,-339"/>
<text text-anchor="middle" x="49758" y="-327" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="49758" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="49758" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="49758" y="-294" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- l1_mlp_proj_5 -->
<g id="node153" class="node">
<title>l1_mlp_proj_5</title>
<polygon fill="lightpink" stroke="black" points="49598,-339 49320,-339 49320,-287 49598,-287 49598,-339"/>
<text text-anchor="middle" x="49459" y="-327" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="49459" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="49459" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="49459" y="-294" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- l1_residual_5 -->
<g id="node154" class="node">
<title>l1_residual_5</title>
<polygon fill="lightsteelblue" stroke="black" points="49302,-339 49024,-339 49024,-287 49302,-287 49302,-339"/>
<text text-anchor="middle" x="49163" y="-327" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="49163" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="49163" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="49163" y="-294" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- l1_concat_5 -->
<g id="node155" class="node">
<title>l1_concat_5</title>
<polygon fill="lightyellow" stroke="black" points="62368.43,-365 61909.6,-365 61791.57,-261 62250.4,-261 62368.43,-365"/>
<text text-anchor="middle" x="62080" y="-327" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="62080" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="62080" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="62080" y="-294" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- l2_split_q_5 -->
<g id="node233" class="node">
<title>l2_split_q_5</title>
<polygon fill="lightyellow" stroke="black" points="62368.43,-128 61909.6,-128 61791.57,-24 62250.4,-24 62368.43,-128"/>
<text text-anchor="middle" x="62080" y="-90" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="62080" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="62080" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="62080" y="-57" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- l1_concat_5&#45;&gt;l2_split_q_5 -->
<g id="edge108" class="edge">
<title>l1_concat_5&#45;&gt;l2_split_q_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62080,-260.72C62080,-224.8 62080,-176.61 62080,-138.6"/>
<polygon fill="black" stroke="black" points="62083.5,-138.17 62080,-128.17 62076.5,-138.17 62083.5,-138.17"/>
<text text-anchor="middle" x="62096" y="-230.6" font-family="Arial" font-size="8.00">PP Send</text>
</g>
<!-- l1_q_proj_6 -->
<g id="node159" class="node">
<title>l1_q_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="46630,-339 46352,-339 46352,-287 46630,-287 46630,-339"/>
<text text-anchor="middle" x="46491" y="-327" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="46491" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="46491" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="46491" y="-294" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- l1_k_proj_6 -->
<g id="node160" class="node">
<title>l1_k_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="46334,-339 46056,-339 46056,-287 46334,-287 46334,-339"/>
<text text-anchor="middle" x="46195" y="-327" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="46195" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="46195" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="46195" y="-294" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- l1_v_proj_6 -->
<g id="node161" class="node">
<title>l1_v_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="46038,-339 45760,-339 45760,-287 46038,-287 46038,-339"/>
<text text-anchor="middle" x="45899" y="-327" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="45899" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="45899" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="45899" y="-294" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- l1_mha_6 -->
<g id="node162" class="node">
<title>l1_mha_6</title>
<polygon fill="lightgreen" stroke="black" points="45742,-339 45464,-339 45464,-287 45742,-287 45742,-339"/>
<text text-anchor="middle" x="45603" y="-327" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="45603" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="45603" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="45603" y="-294" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- l1_mlp_fc_6 -->
<g id="node163" class="node">
<title>l1_mlp_fc_6</title>
<polygon fill="lightpink" stroke="black" points="45446,-339 45162,-339 45162,-287 45446,-287 45446,-339"/>
<text text-anchor="middle" x="45304" y="-327" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="45304" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="45304" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="45304" y="-294" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- l1_mlp_proj_6 -->
<g id="node164" class="node">
<title>l1_mlp_proj_6</title>
<polygon fill="lightpink" stroke="black" points="45144,-339 44866,-339 44866,-287 45144,-287 45144,-339"/>
<text text-anchor="middle" x="45005" y="-327" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="45005" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="45005" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="45005" y="-294" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- l1_residual_6 -->
<g id="node165" class="node">
<title>l1_residual_6</title>
<polygon fill="lightsteelblue" stroke="black" points="44848,-339 44570,-339 44570,-287 44848,-287 44848,-339"/>
<text text-anchor="middle" x="44709" y="-327" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="44709" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="44709" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="44709" y="-294" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- l1_concat_6 -->
<g id="node166" class="node">
<title>l1_concat_6</title>
<polygon fill="lightyellow" stroke="black" points="66822.43,-365 66363.6,-365 66245.57,-261 66704.4,-261 66822.43,-365"/>
<text text-anchor="middle" x="66534" y="-327" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="66534" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="66534" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="66534" y="-294" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- l2_split_q_6 -->
<g id="node244" class="node">
<title>l2_split_q_6</title>
<polygon fill="lightyellow" stroke="black" points="66822.43,-128 66363.6,-128 66245.57,-24 66704.4,-24 66822.43,-128"/>
<text text-anchor="middle" x="66534" y="-90" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="66534" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="66534" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="66534" y="-57" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- l1_concat_6&#45;&gt;l2_split_q_6 -->
<g id="edge126" class="edge">
<title>l1_concat_6&#45;&gt;l2_split_q_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M66534,-260.72C66534,-224.8 66534,-176.61 66534,-138.6"/>
<polygon fill="black" stroke="black" points="66537.5,-138.17 66534,-128.17 66530.5,-138.17 66537.5,-138.17"/>
<text text-anchor="middle" x="66550" y="-230.6" font-family="Arial" font-size="8.00">PP Send</text>
</g>
<!-- l1_q_proj_7 -->
<g id="node170" class="node">
<title>l1_q_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="42176,-339 41898,-339 41898,-287 42176,-287 42176,-339"/>
<text text-anchor="middle" x="42037" y="-327" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="42037" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="42037" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="42037" y="-294" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- l1_k_proj_7 -->
<g id="node171" class="node">
<title>l1_k_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="41880,-339 41602,-339 41602,-287 41880,-287 41880,-339"/>
<text text-anchor="middle" x="41741" y="-327" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="41741" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="41741" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="41741" y="-294" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- l1_v_proj_7 -->
<g id="node172" class="node">
<title>l1_v_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="41584,-339 41306,-339 41306,-287 41584,-287 41584,-339"/>
<text text-anchor="middle" x="41445" y="-327" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="41445" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="41445" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="41445" y="-294" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- l1_mha_7 -->
<g id="node173" class="node">
<title>l1_mha_7</title>
<polygon fill="lightgreen" stroke="black" points="41288,-339 41010,-339 41010,-287 41288,-287 41288,-339"/>
<text text-anchor="middle" x="41149" y="-327" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="41149" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="41149" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="41149" y="-294" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- l1_mlp_fc_7 -->
<g id="node174" class="node">
<title>l1_mlp_fc_7</title>
<polygon fill="lightpink" stroke="black" points="40992,-339 40708,-339 40708,-287 40992,-287 40992,-339"/>
<text text-anchor="middle" x="40850" y="-327" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="40850" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="40850" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="40850" y="-294" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- l1_mlp_proj_7 -->
<g id="node175" class="node">
<title>l1_mlp_proj_7</title>
<polygon fill="lightpink" stroke="black" points="40690,-339 40412,-339 40412,-287 40690,-287 40690,-339"/>
<text text-anchor="middle" x="40551" y="-327" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="40551" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="40551" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="40551" y="-294" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- l1_residual_7 -->
<g id="node176" class="node">
<title>l1_residual_7</title>
<polygon fill="lightsteelblue" stroke="black" points="40394,-339 40116,-339 40116,-287 40394,-287 40394,-339"/>
<text text-anchor="middle" x="40255" y="-327" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="40255" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="40255" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="40255" y="-294" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- l1_concat_7 -->
<g id="node177" class="node">
<title>l1_concat_7</title>
<polygon fill="lightyellow" stroke="black" points="71276.43,-365 70817.6,-365 70699.57,-261 71158.4,-261 71276.43,-365"/>
<text text-anchor="middle" x="70988" y="-327" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="70988" y="-316" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="70988" y="-305" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="70988" y="-294" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- l2_split_q_7 -->
<g id="node255" class="node">
<title>l2_split_q_7</title>
<polygon fill="lightyellow" stroke="black" points="71276.43,-128 70817.6,-128 70699.57,-24 71158.4,-24 71276.43,-128"/>
<text text-anchor="middle" x="70988" y="-90" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="70988" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="70988" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="70988" y="-57" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- l1_concat_7&#45;&gt;l2_split_q_7 -->
<g id="edge144" class="edge">
<title>l1_concat_7&#45;&gt;l2_split_q_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M70988,-260.72C70988,-224.8 70988,-176.61 70988,-138.6"/>
<polygon fill="black" stroke="black" points="70991.5,-138.17 70988,-128.17 70984.5,-138.17 70991.5,-138.17"/>
<text text-anchor="middle" x="71004" y="-230.6" font-family="Arial" font-size="8.00">PP Send</text>
</g>
<!-- l2_split_k_0 -->
<g id="node179" class="node">
<title>l2_split_k_0</title>
<polygon fill="lightyellow" stroke="black" points="70682.43,-128 70223.6,-128 70105.57,-24 70564.4,-24 70682.43,-128"/>
<text text-anchor="middle" x="70394" y="-90" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="70394" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="70394" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="70394" y="-57" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- l2_split_v_0 -->
<g id="node180" class="node">
<title>l2_split_v_0</title>
<polygon fill="lightyellow" stroke="black" points="70088.43,-128 69629.6,-128 69511.57,-24 69970.4,-24 70088.43,-128"/>
<text text-anchor="middle" x="69800" y="-90" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="69800" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="69800" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="69800" y="-57" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- l2_q_proj_0 -->
<g id="node181" class="node">
<title>l2_q_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="69494,-102 69216,-102 69216,-50 69494,-50 69494,-102"/>
<text text-anchor="middle" x="69355" y="-90" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="69355" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="69355" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="69355" y="-57" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- l2_k_proj_0 -->
<g id="node182" class="node">
<title>l2_k_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="69198,-102 68920,-102 68920,-50 69198,-50 69198,-102"/>
<text text-anchor="middle" x="69059" y="-90" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="69059" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="69059" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="69059" y="-57" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- l2_v_proj_0 -->
<g id="node183" class="node">
<title>l2_v_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="68902,-102 68624,-102 68624,-50 68902,-50 68902,-102"/>
<text text-anchor="middle" x="68763" y="-90" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="68763" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="68763" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="68763" y="-57" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- l2_mha_0 -->
<g id="node184" class="node">
<title>l2_mha_0</title>
<polygon fill="lightgreen" stroke="black" points="68606,-102 68328,-102 68328,-50 68606,-50 68606,-102"/>
<text text-anchor="middle" x="68467" y="-90" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="68467" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="68467" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="68467" y="-57" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- l2_mlp_fc_0 -->
<g id="node185" class="node">
<title>l2_mlp_fc_0</title>
<polygon fill="lightpink" stroke="black" points="68310,-102 68026,-102 68026,-50 68310,-50 68310,-102"/>
<text text-anchor="middle" x="68168" y="-90" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="68168" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="68168" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="68168" y="-57" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- l2_mlp_proj_0 -->
<g id="node186" class="node">
<title>l2_mlp_proj_0</title>
<polygon fill="lightpink" stroke="black" points="68008,-102 67730,-102 67730,-50 68008,-50 68008,-102"/>
<text text-anchor="middle" x="67869" y="-90" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="67869" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="67869" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="67869" y="-57" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- l2_residual_0 -->
<g id="node187" class="node">
<title>l2_residual_0</title>
<polygon fill="lightsteelblue" stroke="black" points="67712,-102 67434,-102 67434,-50 67712,-50 67712,-102"/>
<text text-anchor="middle" x="67573" y="-90" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="67573" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="67573" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="67573" y="-57" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- l2_concat_0 -->
<g id="node188" class="node">
<title>l2_concat_0</title>
<polygon fill="lightyellow" stroke="black" points="67416.43,-128 66957.6,-128 66839.57,-24 67298.4,-24 67416.43,-128"/>
<text text-anchor="middle" x="67128" y="-90" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="67128" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="67128" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="67128" y="-57" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- l2_split_k_1 -->
<g id="node190" class="node">
<title>l2_split_k_1</title>
<polygon fill="lightyellow" stroke="black" points="66228.43,-128 65769.6,-128 65651.57,-24 66110.4,-24 66228.43,-128"/>
<text text-anchor="middle" x="65940" y="-90" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="65940" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="65940" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="65940" y="-57" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- l2_split_v_1 -->
<g id="node191" class="node">
<title>l2_split_v_1</title>
<polygon fill="lightyellow" stroke="black" points="65634.43,-128 65175.6,-128 65057.57,-24 65516.4,-24 65634.43,-128"/>
<text text-anchor="middle" x="65346" y="-90" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="65346" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="65346" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="65346" y="-57" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- l2_q_proj_1 -->
<g id="node192" class="node">
<title>l2_q_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="65040,-102 64762,-102 64762,-50 65040,-50 65040,-102"/>
<text text-anchor="middle" x="64901" y="-90" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="64901" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="64901" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="64901" y="-57" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- l2_k_proj_1 -->
<g id="node193" class="node">
<title>l2_k_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="64744,-102 64466,-102 64466,-50 64744,-50 64744,-102"/>
<text text-anchor="middle" x="64605" y="-90" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="64605" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="64605" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="64605" y="-57" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- l2_v_proj_1 -->
<g id="node194" class="node">
<title>l2_v_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="64448,-102 64170,-102 64170,-50 64448,-50 64448,-102"/>
<text text-anchor="middle" x="64309" y="-90" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="64309" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="64309" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="64309" y="-57" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- l2_mha_1 -->
<g id="node195" class="node">
<title>l2_mha_1</title>
<polygon fill="lightgreen" stroke="black" points="64152,-102 63874,-102 63874,-50 64152,-50 64152,-102"/>
<text text-anchor="middle" x="64013" y="-90" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="64013" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="64013" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="64013" y="-57" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- l2_mlp_fc_1 -->
<g id="node196" class="node">
<title>l2_mlp_fc_1</title>
<polygon fill="lightpink" stroke="black" points="63856,-102 63572,-102 63572,-50 63856,-50 63856,-102"/>
<text text-anchor="middle" x="63714" y="-90" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="63714" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="63714" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="63714" y="-57" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- l2_mlp_proj_1 -->
<g id="node197" class="node">
<title>l2_mlp_proj_1</title>
<polygon fill="lightpink" stroke="black" points="63554,-102 63276,-102 63276,-50 63554,-50 63554,-102"/>
<text text-anchor="middle" x="63415" y="-90" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="63415" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="63415" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="63415" y="-57" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- l2_residual_1 -->
<g id="node198" class="node">
<title>l2_residual_1</title>
<polygon fill="lightsteelblue" stroke="black" points="63258,-102 62980,-102 62980,-50 63258,-50 63258,-102"/>
<text text-anchor="middle" x="63119" y="-90" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="63119" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="63119" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="63119" y="-57" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- l2_concat_1 -->
<g id="node199" class="node">
<title>l2_concat_1</title>
<polygon fill="lightyellow" stroke="black" points="62962.43,-128 62503.6,-128 62385.57,-24 62844.4,-24 62962.43,-128"/>
<text text-anchor="middle" x="62674" y="-90" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="62674" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="62674" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="62674" y="-57" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- l2_split_k_2 -->
<g id="node201" class="node">
<title>l2_split_k_2</title>
<polygon fill="lightyellow" stroke="black" points="61774.43,-128 61315.6,-128 61197.57,-24 61656.4,-24 61774.43,-128"/>
<text text-anchor="middle" x="61486" y="-90" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="61486" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="61486" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="61486" y="-57" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- l2_split_v_2 -->
<g id="node202" class="node">
<title>l2_split_v_2</title>
<polygon fill="lightyellow" stroke="black" points="61180.43,-128 60721.6,-128 60603.57,-24 61062.4,-24 61180.43,-128"/>
<text text-anchor="middle" x="60892" y="-90" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="60892" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="60892" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="60892" y="-57" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- l2_q_proj_2 -->
<g id="node203" class="node">
<title>l2_q_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="60586,-102 60308,-102 60308,-50 60586,-50 60586,-102"/>
<text text-anchor="middle" x="60447" y="-90" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="60447" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="60447" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="60447" y="-57" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- l2_k_proj_2 -->
<g id="node204" class="node">
<title>l2_k_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="60290,-102 60012,-102 60012,-50 60290,-50 60290,-102"/>
<text text-anchor="middle" x="60151" y="-90" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="60151" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="60151" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="60151" y="-57" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- l2_v_proj_2 -->
<g id="node205" class="node">
<title>l2_v_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="59994,-102 59716,-102 59716,-50 59994,-50 59994,-102"/>
<text text-anchor="middle" x="59855" y="-90" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="59855" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="59855" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="59855" y="-57" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- l2_mha_2 -->
<g id="node206" class="node">
<title>l2_mha_2</title>
<polygon fill="lightgreen" stroke="black" points="59698,-102 59420,-102 59420,-50 59698,-50 59698,-102"/>
<text text-anchor="middle" x="59559" y="-90" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="59559" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="59559" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="59559" y="-57" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- l2_mlp_fc_2 -->
<g id="node207" class="node">
<title>l2_mlp_fc_2</title>
<polygon fill="lightpink" stroke="black" points="59402,-102 59118,-102 59118,-50 59402,-50 59402,-102"/>
<text text-anchor="middle" x="59260" y="-90" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="59260" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="59260" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="59260" y="-57" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- l2_mlp_proj_2 -->
<g id="node208" class="node">
<title>l2_mlp_proj_2</title>
<polygon fill="lightpink" stroke="black" points="59100,-102 58822,-102 58822,-50 59100,-50 59100,-102"/>
<text text-anchor="middle" x="58961" y="-90" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="58961" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="58961" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="58961" y="-57" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- l2_residual_2 -->
<g id="node209" class="node">
<title>l2_residual_2</title>
<polygon fill="lightsteelblue" stroke="black" points="58804,-102 58526,-102 58526,-50 58804,-50 58804,-102"/>
<text text-anchor="middle" x="58665" y="-90" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="58665" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="58665" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="58665" y="-57" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- l2_concat_2 -->
<g id="node210" class="node">
<title>l2_concat_2</title>
<polygon fill="lightyellow" stroke="black" points="58508.43,-128 58049.6,-128 57931.57,-24 58390.4,-24 58508.43,-128"/>
<text text-anchor="middle" x="58220" y="-90" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="58220" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="58220" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="58220" y="-57" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- l2_split_k_3 -->
<g id="node212" class="node">
<title>l2_split_k_3</title>
<polygon fill="lightyellow" stroke="black" points="57320.43,-128 56861.6,-128 56743.57,-24 57202.4,-24 57320.43,-128"/>
<text text-anchor="middle" x="57032" y="-90" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="57032" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="57032" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="57032" y="-57" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- l2_split_v_3 -->
<g id="node213" class="node">
<title>l2_split_v_3</title>
<polygon fill="lightyellow" stroke="black" points="56726.43,-128 56267.6,-128 56149.57,-24 56608.4,-24 56726.43,-128"/>
<text text-anchor="middle" x="56438" y="-90" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="56438" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="56438" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="56438" y="-57" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- l2_q_proj_3 -->
<g id="node214" class="node">
<title>l2_q_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="56132,-102 55854,-102 55854,-50 56132,-50 56132,-102"/>
<text text-anchor="middle" x="55993" y="-90" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="55993" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="55993" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="55993" y="-57" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- l2_k_proj_3 -->
<g id="node215" class="node">
<title>l2_k_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="55836,-102 55558,-102 55558,-50 55836,-50 55836,-102"/>
<text text-anchor="middle" x="55697" y="-90" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="55697" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="55697" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="55697" y="-57" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- l2_v_proj_3 -->
<g id="node216" class="node">
<title>l2_v_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="55540,-102 55262,-102 55262,-50 55540,-50 55540,-102"/>
<text text-anchor="middle" x="55401" y="-90" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="55401" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="55401" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="55401" y="-57" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- l2_mha_3 -->
<g id="node217" class="node">
<title>l2_mha_3</title>
<polygon fill="lightgreen" stroke="black" points="55244,-102 54966,-102 54966,-50 55244,-50 55244,-102"/>
<text text-anchor="middle" x="55105" y="-90" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="55105" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="55105" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="55105" y="-57" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- l2_mlp_fc_3 -->
<g id="node218" class="node">
<title>l2_mlp_fc_3</title>
<polygon fill="lightpink" stroke="black" points="54948,-102 54664,-102 54664,-50 54948,-50 54948,-102"/>
<text text-anchor="middle" x="54806" y="-90" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="54806" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="54806" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="54806" y="-57" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- l2_mlp_proj_3 -->
<g id="node219" class="node">
<title>l2_mlp_proj_3</title>
<polygon fill="lightpink" stroke="black" points="54646,-102 54368,-102 54368,-50 54646,-50 54646,-102"/>
<text text-anchor="middle" x="54507" y="-90" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="54507" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="54507" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="54507" y="-57" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- l2_residual_3 -->
<g id="node220" class="node">
<title>l2_residual_3</title>
<polygon fill="lightsteelblue" stroke="black" points="54350,-102 54072,-102 54072,-50 54350,-50 54350,-102"/>
<text text-anchor="middle" x="54211" y="-90" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="54211" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="54211" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="54211" y="-57" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- l2_concat_3 -->
<g id="node221" class="node">
<title>l2_concat_3</title>
<polygon fill="lightyellow" stroke="black" points="54054.43,-128 53595.6,-128 53477.57,-24 53936.4,-24 54054.43,-128"/>
<text text-anchor="middle" x="53766" y="-90" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="53766" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="53766" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="53766" y="-57" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- l2_split_k_4 -->
<g id="node223" class="node">
<title>l2_split_k_4</title>
<polygon fill="lightyellow" stroke="black" points="52866.43,-128 52407.6,-128 52289.57,-24 52748.4,-24 52866.43,-128"/>
<text text-anchor="middle" x="52578" y="-90" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="52578" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="52578" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="52578" y="-57" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- l2_split_v_4 -->
<g id="node224" class="node">
<title>l2_split_v_4</title>
<polygon fill="lightyellow" stroke="black" points="52272.43,-128 51813.6,-128 51695.57,-24 52154.4,-24 52272.43,-128"/>
<text text-anchor="middle" x="51984" y="-90" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="51984" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="51984" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="51984" y="-57" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- l2_q_proj_4 -->
<g id="node225" class="node">
<title>l2_q_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="51678,-102 51400,-102 51400,-50 51678,-50 51678,-102"/>
<text text-anchor="middle" x="51539" y="-90" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="51539" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="51539" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="51539" y="-57" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- l2_k_proj_4 -->
<g id="node226" class="node">
<title>l2_k_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="51382,-102 51104,-102 51104,-50 51382,-50 51382,-102"/>
<text text-anchor="middle" x="51243" y="-90" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="51243" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="51243" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="51243" y="-57" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- l2_v_proj_4 -->
<g id="node227" class="node">
<title>l2_v_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="51086,-102 50808,-102 50808,-50 51086,-50 51086,-102"/>
<text text-anchor="middle" x="50947" y="-90" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="50947" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="50947" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="50947" y="-57" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- l2_mha_4 -->
<g id="node228" class="node">
<title>l2_mha_4</title>
<polygon fill="lightgreen" stroke="black" points="50790,-102 50512,-102 50512,-50 50790,-50 50790,-102"/>
<text text-anchor="middle" x="50651" y="-90" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="50651" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="50651" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="50651" y="-57" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- l2_mlp_fc_4 -->
<g id="node229" class="node">
<title>l2_mlp_fc_4</title>
<polygon fill="lightpink" stroke="black" points="50494,-102 50210,-102 50210,-50 50494,-50 50494,-102"/>
<text text-anchor="middle" x="50352" y="-90" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="50352" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="50352" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="50352" y="-57" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- l2_mlp_proj_4 -->
<g id="node230" class="node">
<title>l2_mlp_proj_4</title>
<polygon fill="lightpink" stroke="black" points="50192,-102 49914,-102 49914,-50 50192,-50 50192,-102"/>
<text text-anchor="middle" x="50053" y="-90" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="50053" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="50053" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="50053" y="-57" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- l2_residual_4 -->
<g id="node231" class="node">
<title>l2_residual_4</title>
<polygon fill="lightsteelblue" stroke="black" points="49896,-102 49618,-102 49618,-50 49896,-50 49896,-102"/>
<text text-anchor="middle" x="49757" y="-90" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="49757" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="49757" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="49757" y="-57" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- l2_concat_4 -->
<g id="node232" class="node">
<title>l2_concat_4</title>
<polygon fill="lightyellow" stroke="black" points="49600.43,-128 49141.6,-128 49023.57,-24 49482.4,-24 49600.43,-128"/>
<text text-anchor="middle" x="49312" y="-90" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="49312" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="49312" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="49312" y="-57" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- l2_split_k_5 -->
<g id="node234" class="node">
<title>l2_split_k_5</title>
<polygon fill="lightyellow" stroke="black" points="48412.43,-128 47953.6,-128 47835.57,-24 48294.4,-24 48412.43,-128"/>
<text text-anchor="middle" x="48124" y="-90" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="48124" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="48124" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="48124" y="-57" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- l2_split_v_5 -->
<g id="node235" class="node">
<title>l2_split_v_5</title>
<polygon fill="lightyellow" stroke="black" points="47818.43,-128 47359.6,-128 47241.57,-24 47700.4,-24 47818.43,-128"/>
<text text-anchor="middle" x="47530" y="-90" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="47530" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="47530" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="47530" y="-57" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- l2_q_proj_5 -->
<g id="node236" class="node">
<title>l2_q_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="47224,-102 46946,-102 46946,-50 47224,-50 47224,-102"/>
<text text-anchor="middle" x="47085" y="-90" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="47085" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="47085" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="47085" y="-57" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- l2_k_proj_5 -->
<g id="node237" class="node">
<title>l2_k_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="46928,-102 46650,-102 46650,-50 46928,-50 46928,-102"/>
<text text-anchor="middle" x="46789" y="-90" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="46789" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="46789" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="46789" y="-57" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- l2_v_proj_5 -->
<g id="node238" class="node">
<title>l2_v_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="46632,-102 46354,-102 46354,-50 46632,-50 46632,-102"/>
<text text-anchor="middle" x="46493" y="-90" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="46493" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="46493" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="46493" y="-57" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- l2_mha_5 -->
<g id="node239" class="node">
<title>l2_mha_5</title>
<polygon fill="lightgreen" stroke="black" points="46336,-102 46058,-102 46058,-50 46336,-50 46336,-102"/>
<text text-anchor="middle" x="46197" y="-90" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="46197" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="46197" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="46197" y="-57" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- l2_mlp_fc_5 -->
<g id="node240" class="node">
<title>l2_mlp_fc_5</title>
<polygon fill="lightpink" stroke="black" points="46040,-102 45756,-102 45756,-50 46040,-50 46040,-102"/>
<text text-anchor="middle" x="45898" y="-90" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="45898" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="45898" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="45898" y="-57" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- l2_mlp_proj_5 -->
<g id="node241" class="node">
<title>l2_mlp_proj_5</title>
<polygon fill="lightpink" stroke="black" points="45738,-102 45460,-102 45460,-50 45738,-50 45738,-102"/>
<text text-anchor="middle" x="45599" y="-90" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="45599" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="45599" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="45599" y="-57" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- l2_residual_5 -->
<g id="node242" class="node">
<title>l2_residual_5</title>
<polygon fill="lightsteelblue" stroke="black" points="45442,-102 45164,-102 45164,-50 45442,-50 45442,-102"/>
<text text-anchor="middle" x="45303" y="-90" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="45303" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="45303" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="45303" y="-57" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- l2_concat_5 -->
<g id="node243" class="node">
<title>l2_concat_5</title>
<polygon fill="lightyellow" stroke="black" points="45146.43,-128 44687.6,-128 44569.57,-24 45028.4,-24 45146.43,-128"/>
<text text-anchor="middle" x="44858" y="-90" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="44858" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="44858" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="44858" y="-57" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- l2_split_k_6 -->
<g id="node245" class="node">
<title>l2_split_k_6</title>
<polygon fill="lightyellow" stroke="black" points="43958.43,-128 43499.6,-128 43381.57,-24 43840.4,-24 43958.43,-128"/>
<text text-anchor="middle" x="43670" y="-90" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="43670" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="43670" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="43670" y="-57" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- l2_split_v_6 -->
<g id="node246" class="node">
<title>l2_split_v_6</title>
<polygon fill="lightyellow" stroke="black" points="43364.43,-128 42905.6,-128 42787.57,-24 43246.4,-24 43364.43,-128"/>
<text text-anchor="middle" x="43076" y="-90" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="43076" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="43076" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="43076" y="-57" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- l2_q_proj_6 -->
<g id="node247" class="node">
<title>l2_q_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="42770,-102 42492,-102 42492,-50 42770,-50 42770,-102"/>
<text text-anchor="middle" x="42631" y="-90" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="42631" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="42631" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="42631" y="-57" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- l2_k_proj_6 -->
<g id="node248" class="node">
<title>l2_k_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="42474,-102 42196,-102 42196,-50 42474,-50 42474,-102"/>
<text text-anchor="middle" x="42335" y="-90" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="42335" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="42335" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="42335" y="-57" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- l2_v_proj_6 -->
<g id="node249" class="node">
<title>l2_v_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="42178,-102 41900,-102 41900,-50 42178,-50 42178,-102"/>
<text text-anchor="middle" x="42039" y="-90" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="42039" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="42039" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="42039" y="-57" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- l2_mha_6 -->
<g id="node250" class="node">
<title>l2_mha_6</title>
<polygon fill="lightgreen" stroke="black" points="41882,-102 41604,-102 41604,-50 41882,-50 41882,-102"/>
<text text-anchor="middle" x="41743" y="-90" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="41743" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="41743" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="41743" y="-57" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- l2_mlp_fc_6 -->
<g id="node251" class="node">
<title>l2_mlp_fc_6</title>
<polygon fill="lightpink" stroke="black" points="41586,-102 41302,-102 41302,-50 41586,-50 41586,-102"/>
<text text-anchor="middle" x="41444" y="-90" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="41444" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="41444" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="41444" y="-57" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- l2_mlp_proj_6 -->
<g id="node252" class="node">
<title>l2_mlp_proj_6</title>
<polygon fill="lightpink" stroke="black" points="41284,-102 41006,-102 41006,-50 41284,-50 41284,-102"/>
<text text-anchor="middle" x="41145" y="-90" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="41145" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="41145" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="41145" y="-57" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- l2_residual_6 -->
<g id="node253" class="node">
<title>l2_residual_6</title>
<polygon fill="lightsteelblue" stroke="black" points="40988,-102 40710,-102 40710,-50 40988,-50 40988,-102"/>
<text text-anchor="middle" x="40849" y="-90" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="40849" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="40849" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="40849" y="-57" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- l2_concat_6 -->
<g id="node254" class="node">
<title>l2_concat_6</title>
<polygon fill="lightyellow" stroke="black" points="40692.43,-128 40233.6,-128 40115.57,-24 40574.4,-24 40692.43,-128"/>
<text text-anchor="middle" x="40404" y="-90" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="40404" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="40404" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="40404" y="-57" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- l2_split_k_7 -->
<g id="node256" class="node">
<title>l2_split_k_7</title>
<polygon fill="lightyellow" stroke="black" points="39504.43,-128 39045.6,-128 38927.57,-24 39386.4,-24 39504.43,-128"/>
<text text-anchor="middle" x="39216" y="-90" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="39216" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="39216" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="39216" y="-57" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- l2_split_v_7 -->
<g id="node257" class="node">
<title>l2_split_v_7</title>
<polygon fill="lightyellow" stroke="black" points="38910.43,-128 38451.6,-128 38333.57,-24 38792.4,-24 38910.43,-128"/>
<text text-anchor="middle" x="38622" y="-90" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="38622" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="38622" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="38622" y="-57" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- l2_q_proj_7 -->
<g id="node258" class="node">
<title>l2_q_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="38316,-102 38038,-102 38038,-50 38316,-50 38316,-102"/>
<text text-anchor="middle" x="38177" y="-90" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="38177" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="38177" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="38177" y="-57" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- l2_k_proj_7 -->
<g id="node259" class="node">
<title>l2_k_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="38020,-102 37742,-102 37742,-50 38020,-50 38020,-102"/>
<text text-anchor="middle" x="37881" y="-90" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="37881" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="37881" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="37881" y="-57" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- l2_v_proj_7 -->
<g id="node260" class="node">
<title>l2_v_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="37724,-102 37446,-102 37446,-50 37724,-50 37724,-102"/>
<text text-anchor="middle" x="37585" y="-90" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="37585" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="37585" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="37585" y="-57" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- l2_mha_7 -->
<g id="node261" class="node">
<title>l2_mha_7</title>
<polygon fill="lightgreen" stroke="black" points="37428,-102 37150,-102 37150,-50 37428,-50 37428,-102"/>
<text text-anchor="middle" x="37289" y="-90" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="37289" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="37289" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="37289" y="-57" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- l2_mlp_fc_7 -->
<g id="node262" class="node">
<title>l2_mlp_fc_7</title>
<polygon fill="lightpink" stroke="black" points="37132,-102 36848,-102 36848,-50 37132,-50 37132,-102"/>
<text text-anchor="middle" x="36990" y="-90" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="36990" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="36990" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="36990" y="-57" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- l2_mlp_proj_7 -->
<g id="node263" class="node">
<title>l2_mlp_proj_7</title>
<polygon fill="lightpink" stroke="black" points="36830,-102 36552,-102 36552,-50 36830,-50 36830,-102"/>
<text text-anchor="middle" x="36691" y="-90" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="36691" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="36691" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="36691" y="-57" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- l2_residual_7 -->
<g id="node264" class="node">
<title>l2_residual_7</title>
<polygon fill="lightsteelblue" stroke="black" points="36534,-102 36256,-102 36256,-50 36534,-50 36534,-102"/>
<text text-anchor="middle" x="36395" y="-90" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="36395" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="36395" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="36395" y="-57" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- l2_concat_7 -->
<g id="node265" class="node">
<title>l2_concat_7</title>
<polygon fill="lightyellow" stroke="black" points="36238.43,-128 35779.6,-128 35661.57,-24 36120.4,-24 36238.43,-128"/>
<text text-anchor="middle" x="35950" y="-90" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="35950" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="35950" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="35950" y="-57" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- l3_split_q_0 -->
<g id="node266" class="node">
<title>l3_split_q_0</title>
<polygon fill="lightyellow" stroke="black" points="35638.43,-128 35179.6,-128 35061.57,-24 35520.4,-24 35638.43,-128"/>
<text text-anchor="middle" x="35350" y="-90" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="35350" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="35350" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="35350" y="-57" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- l3_split_k_0 -->
<g id="node267" class="node">
<title>l3_split_k_0</title>
<polygon fill="lightyellow" stroke="black" points="35044.43,-128 34585.6,-128 34467.57,-24 34926.4,-24 35044.43,-128"/>
<text text-anchor="middle" x="34756" y="-90" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="34756" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="34756" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="34756" y="-57" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- l3_split_v_0 -->
<g id="node268" class="node">
<title>l3_split_v_0</title>
<polygon fill="lightyellow" stroke="black" points="34450.43,-128 33991.6,-128 33873.57,-24 34332.4,-24 34450.43,-128"/>
<text text-anchor="middle" x="34162" y="-90" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="34162" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="34162" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="34162" y="-57" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- l3_q_proj_0 -->
<g id="node269" class="node">
<title>l3_q_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="33856,-102 33578,-102 33578,-50 33856,-50 33856,-102"/>
<text text-anchor="middle" x="33717" y="-90" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="33717" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="33717" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="33717" y="-57" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- l3_k_proj_0 -->
<g id="node270" class="node">
<title>l3_k_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="33560,-102 33282,-102 33282,-50 33560,-50 33560,-102"/>
<text text-anchor="middle" x="33421" y="-90" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="33421" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="33421" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="33421" y="-57" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- l3_v_proj_0 -->
<g id="node271" class="node">
<title>l3_v_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="33264,-102 32986,-102 32986,-50 33264,-50 33264,-102"/>
<text text-anchor="middle" x="33125" y="-90" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="33125" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="33125" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="33125" y="-57" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- l3_mha_0 -->
<g id="node272" class="node">
<title>l3_mha_0</title>
<polygon fill="lightgreen" stroke="black" points="32968,-102 32690,-102 32690,-50 32968,-50 32968,-102"/>
<text text-anchor="middle" x="32829" y="-90" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="32829" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="32829" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="32829" y="-57" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- l3_mlp_fc_0 -->
<g id="node273" class="node">
<title>l3_mlp_fc_0</title>
<polygon fill="lightpink" stroke="black" points="32672,-102 32388,-102 32388,-50 32672,-50 32672,-102"/>
<text text-anchor="middle" x="32530" y="-90" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="32530" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="32530" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="32530" y="-57" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- l3_mlp_proj_0 -->
<g id="node274" class="node">
<title>l3_mlp_proj_0</title>
<polygon fill="lightpink" stroke="black" points="32370,-102 32092,-102 32092,-50 32370,-50 32370,-102"/>
<text text-anchor="middle" x="32231" y="-90" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="32231" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="32231" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="32231" y="-57" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- l3_residual_0 -->
<g id="node275" class="node">
<title>l3_residual_0</title>
<polygon fill="lightsteelblue" stroke="black" points="32074,-102 31796,-102 31796,-50 32074,-50 32074,-102"/>
<text text-anchor="middle" x="31935" y="-90" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="31935" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="31935" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="31935" y="-57" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- l3_concat_0 -->
<g id="node276" class="node">
<title>l3_concat_0</title>
<polygon fill="lightyellow" stroke="black" points="31778.43,-128 31319.6,-128 31201.57,-24 31660.4,-24 31778.43,-128"/>
<text text-anchor="middle" x="31490" y="-90" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="31490" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="31490" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="31490" y="-57" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- l3_split_q_1 -->
<g id="node277" class="node">
<title>l3_split_q_1</title>
<polygon fill="lightyellow" stroke="black" points="31184.43,-128 30725.6,-128 30607.57,-24 31066.4,-24 31184.43,-128"/>
<text text-anchor="middle" x="30896" y="-90" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="30896" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="30896" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="30896" y="-57" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- l3_split_k_1 -->
<g id="node278" class="node">
<title>l3_split_k_1</title>
<polygon fill="lightyellow" stroke="black" points="30590.43,-128 30131.6,-128 30013.57,-24 30472.4,-24 30590.43,-128"/>
<text text-anchor="middle" x="30302" y="-90" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="30302" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="30302" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="30302" y="-57" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- l3_split_v_1 -->
<g id="node279" class="node">
<title>l3_split_v_1</title>
<polygon fill="lightyellow" stroke="black" points="29996.43,-128 29537.6,-128 29419.57,-24 29878.4,-24 29996.43,-128"/>
<text text-anchor="middle" x="29708" y="-90" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="29708" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="29708" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="29708" y="-57" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- l3_q_proj_1 -->
<g id="node280" class="node">
<title>l3_q_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="29402,-102 29124,-102 29124,-50 29402,-50 29402,-102"/>
<text text-anchor="middle" x="29263" y="-90" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="29263" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="29263" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="29263" y="-57" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- l3_k_proj_1 -->
<g id="node281" class="node">
<title>l3_k_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="29106,-102 28828,-102 28828,-50 29106,-50 29106,-102"/>
<text text-anchor="middle" x="28967" y="-90" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="28967" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="28967" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="28967" y="-57" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- l3_v_proj_1 -->
<g id="node282" class="node">
<title>l3_v_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="28810,-102 28532,-102 28532,-50 28810,-50 28810,-102"/>
<text text-anchor="middle" x="28671" y="-90" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="28671" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="28671" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="28671" y="-57" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- l3_mha_1 -->
<g id="node283" class="node">
<title>l3_mha_1</title>
<polygon fill="lightgreen" stroke="black" points="28514,-102 28236,-102 28236,-50 28514,-50 28514,-102"/>
<text text-anchor="middle" x="28375" y="-90" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="28375" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="28375" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="28375" y="-57" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- l3_mlp_fc_1 -->
<g id="node284" class="node">
<title>l3_mlp_fc_1</title>
<polygon fill="lightpink" stroke="black" points="28218,-102 27934,-102 27934,-50 28218,-50 28218,-102"/>
<text text-anchor="middle" x="28076" y="-90" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="28076" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="28076" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="28076" y="-57" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- l3_mlp_proj_1 -->
<g id="node285" class="node">
<title>l3_mlp_proj_1</title>
<polygon fill="lightpink" stroke="black" points="27916,-102 27638,-102 27638,-50 27916,-50 27916,-102"/>
<text text-anchor="middle" x="27777" y="-90" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="27777" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="27777" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="27777" y="-57" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- l3_residual_1 -->
<g id="node286" class="node">
<title>l3_residual_1</title>
<polygon fill="lightsteelblue" stroke="black" points="27620,-102 27342,-102 27342,-50 27620,-50 27620,-102"/>
<text text-anchor="middle" x="27481" y="-90" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="27481" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="27481" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="27481" y="-57" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- l3_concat_1 -->
<g id="node287" class="node">
<title>l3_concat_1</title>
<polygon fill="lightyellow" stroke="black" points="27324.43,-128 26865.6,-128 26747.57,-24 27206.4,-24 27324.43,-128"/>
<text text-anchor="middle" x="27036" y="-90" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="27036" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="27036" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="27036" y="-57" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- l3_split_q_2 -->
<g id="node288" class="node">
<title>l3_split_q_2</title>
<polygon fill="lightyellow" stroke="black" points="26730.43,-128 26271.6,-128 26153.57,-24 26612.4,-24 26730.43,-128"/>
<text text-anchor="middle" x="26442" y="-90" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="26442" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="26442" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="26442" y="-57" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- l3_split_k_2 -->
<g id="node289" class="node">
<title>l3_split_k_2</title>
<polygon fill="lightyellow" stroke="black" points="26136.43,-128 25677.6,-128 25559.57,-24 26018.4,-24 26136.43,-128"/>
<text text-anchor="middle" x="25848" y="-90" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="25848" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="25848" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="25848" y="-57" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- l3_split_v_2 -->
<g id="node290" class="node">
<title>l3_split_v_2</title>
<polygon fill="lightyellow" stroke="black" points="25542.43,-128 25083.6,-128 24965.57,-24 25424.4,-24 25542.43,-128"/>
<text text-anchor="middle" x="25254" y="-90" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="25254" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="25254" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="25254" y="-57" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- l3_q_proj_2 -->
<g id="node291" class="node">
<title>l3_q_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="24948,-102 24670,-102 24670,-50 24948,-50 24948,-102"/>
<text text-anchor="middle" x="24809" y="-90" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="24809" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="24809" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="24809" y="-57" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- l3_k_proj_2 -->
<g id="node292" class="node">
<title>l3_k_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="24652,-102 24374,-102 24374,-50 24652,-50 24652,-102"/>
<text text-anchor="middle" x="24513" y="-90" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="24513" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="24513" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="24513" y="-57" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- l3_v_proj_2 -->
<g id="node293" class="node">
<title>l3_v_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="24356,-102 24078,-102 24078,-50 24356,-50 24356,-102"/>
<text text-anchor="middle" x="24217" y="-90" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="24217" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="24217" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="24217" y="-57" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- l3_mha_2 -->
<g id="node294" class="node">
<title>l3_mha_2</title>
<polygon fill="lightgreen" stroke="black" points="24060,-102 23782,-102 23782,-50 24060,-50 24060,-102"/>
<text text-anchor="middle" x="23921" y="-90" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="23921" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="23921" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="23921" y="-57" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- l3_mlp_fc_2 -->
<g id="node295" class="node">
<title>l3_mlp_fc_2</title>
<polygon fill="lightpink" stroke="black" points="23764,-102 23480,-102 23480,-50 23764,-50 23764,-102"/>
<text text-anchor="middle" x="23622" y="-90" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="23622" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="23622" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="23622" y="-57" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- l3_mlp_proj_2 -->
<g id="node296" class="node">
<title>l3_mlp_proj_2</title>
<polygon fill="lightpink" stroke="black" points="23462,-102 23184,-102 23184,-50 23462,-50 23462,-102"/>
<text text-anchor="middle" x="23323" y="-90" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="23323" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="23323" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="23323" y="-57" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- l3_residual_2 -->
<g id="node297" class="node">
<title>l3_residual_2</title>
<polygon fill="lightsteelblue" stroke="black" points="23166,-102 22888,-102 22888,-50 23166,-50 23166,-102"/>
<text text-anchor="middle" x="23027" y="-90" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="23027" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="23027" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="23027" y="-57" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- l3_concat_2 -->
<g id="node298" class="node">
<title>l3_concat_2</title>
<polygon fill="lightyellow" stroke="black" points="22870.43,-128 22411.6,-128 22293.57,-24 22752.4,-24 22870.43,-128"/>
<text text-anchor="middle" x="22582" y="-90" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="22582" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="22582" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="22582" y="-57" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- l3_split_q_3 -->
<g id="node299" class="node">
<title>l3_split_q_3</title>
<polygon fill="lightyellow" stroke="black" points="22276.43,-128 21817.6,-128 21699.57,-24 22158.4,-24 22276.43,-128"/>
<text text-anchor="middle" x="21988" y="-90" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="21988" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="21988" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="21988" y="-57" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- l3_split_k_3 -->
<g id="node300" class="node">
<title>l3_split_k_3</title>
<polygon fill="lightyellow" stroke="black" points="21682.43,-128 21223.6,-128 21105.57,-24 21564.4,-24 21682.43,-128"/>
<text text-anchor="middle" x="21394" y="-90" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="21394" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="21394" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="21394" y="-57" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- l3_split_v_3 -->
<g id="node301" class="node">
<title>l3_split_v_3</title>
<polygon fill="lightyellow" stroke="black" points="21088.43,-128 20629.6,-128 20511.57,-24 20970.4,-24 21088.43,-128"/>
<text text-anchor="middle" x="20800" y="-90" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="20800" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="20800" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="20800" y="-57" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- l3_q_proj_3 -->
<g id="node302" class="node">
<title>l3_q_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="20494,-102 20216,-102 20216,-50 20494,-50 20494,-102"/>
<text text-anchor="middle" x="20355" y="-90" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="20355" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="20355" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="20355" y="-57" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- l3_k_proj_3 -->
<g id="node303" class="node">
<title>l3_k_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="20198,-102 19920,-102 19920,-50 20198,-50 20198,-102"/>
<text text-anchor="middle" x="20059" y="-90" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="20059" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="20059" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="20059" y="-57" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- l3_v_proj_3 -->
<g id="node304" class="node">
<title>l3_v_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="19902,-102 19624,-102 19624,-50 19902,-50 19902,-102"/>
<text text-anchor="middle" x="19763" y="-90" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="19763" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="19763" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="19763" y="-57" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- l3_mha_3 -->
<g id="node305" class="node">
<title>l3_mha_3</title>
<polygon fill="lightgreen" stroke="black" points="19606,-102 19328,-102 19328,-50 19606,-50 19606,-102"/>
<text text-anchor="middle" x="19467" y="-90" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="19467" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="19467" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="19467" y="-57" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- l3_mlp_fc_3 -->
<g id="node306" class="node">
<title>l3_mlp_fc_3</title>
<polygon fill="lightpink" stroke="black" points="19310,-102 19026,-102 19026,-50 19310,-50 19310,-102"/>
<text text-anchor="middle" x="19168" y="-90" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="19168" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="19168" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="19168" y="-57" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- l3_mlp_proj_3 -->
<g id="node307" class="node">
<title>l3_mlp_proj_3</title>
<polygon fill="lightpink" stroke="black" points="19008,-102 18730,-102 18730,-50 19008,-50 19008,-102"/>
<text text-anchor="middle" x="18869" y="-90" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="18869" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="18869" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="18869" y="-57" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- l3_residual_3 -->
<g id="node308" class="node">
<title>l3_residual_3</title>
<polygon fill="lightsteelblue" stroke="black" points="18712,-102 18434,-102 18434,-50 18712,-50 18712,-102"/>
<text text-anchor="middle" x="18573" y="-90" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="18573" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="18573" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="18573" y="-57" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- l3_concat_3 -->
<g id="node309" class="node">
<title>l3_concat_3</title>
<polygon fill="lightyellow" stroke="black" points="18416.43,-128 17957.6,-128 17839.57,-24 18298.4,-24 18416.43,-128"/>
<text text-anchor="middle" x="18128" y="-90" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="18128" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="18128" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="18128" y="-57" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- l3_split_q_4 -->
<g id="node310" class="node">
<title>l3_split_q_4</title>
<polygon fill="lightyellow" stroke="black" points="17822.43,-128 17363.6,-128 17245.57,-24 17704.4,-24 17822.43,-128"/>
<text text-anchor="middle" x="17534" y="-90" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="17534" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="17534" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="17534" y="-57" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- l3_split_k_4 -->
<g id="node311" class="node">
<title>l3_split_k_4</title>
<polygon fill="lightyellow" stroke="black" points="17228.43,-128 16769.6,-128 16651.57,-24 17110.4,-24 17228.43,-128"/>
<text text-anchor="middle" x="16940" y="-90" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="16940" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="16940" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="16940" y="-57" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- l3_split_v_4 -->
<g id="node312" class="node">
<title>l3_split_v_4</title>
<polygon fill="lightyellow" stroke="black" points="16634.43,-128 16175.6,-128 16057.57,-24 16516.4,-24 16634.43,-128"/>
<text text-anchor="middle" x="16346" y="-90" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="16346" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="16346" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="16346" y="-57" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- l3_q_proj_4 -->
<g id="node313" class="node">
<title>l3_q_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="16040,-102 15762,-102 15762,-50 16040,-50 16040,-102"/>
<text text-anchor="middle" x="15901" y="-90" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="15901" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="15901" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="15901" y="-57" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- l3_k_proj_4 -->
<g id="node314" class="node">
<title>l3_k_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="15744,-102 15466,-102 15466,-50 15744,-50 15744,-102"/>
<text text-anchor="middle" x="15605" y="-90" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="15605" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="15605" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="15605" y="-57" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- l3_v_proj_4 -->
<g id="node315" class="node">
<title>l3_v_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="15448,-102 15170,-102 15170,-50 15448,-50 15448,-102"/>
<text text-anchor="middle" x="15309" y="-90" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="15309" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="15309" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="15309" y="-57" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- l3_mha_4 -->
<g id="node316" class="node">
<title>l3_mha_4</title>
<polygon fill="lightgreen" stroke="black" points="15152,-102 14874,-102 14874,-50 15152,-50 15152,-102"/>
<text text-anchor="middle" x="15013" y="-90" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="15013" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="15013" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="15013" y="-57" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- l3_mlp_fc_4 -->
<g id="node317" class="node">
<title>l3_mlp_fc_4</title>
<polygon fill="lightpink" stroke="black" points="14856,-102 14572,-102 14572,-50 14856,-50 14856,-102"/>
<text text-anchor="middle" x="14714" y="-90" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="14714" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="14714" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="14714" y="-57" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- l3_mlp_proj_4 -->
<g id="node318" class="node">
<title>l3_mlp_proj_4</title>
<polygon fill="lightpink" stroke="black" points="14554,-102 14276,-102 14276,-50 14554,-50 14554,-102"/>
<text text-anchor="middle" x="14415" y="-90" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="14415" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="14415" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="14415" y="-57" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- l3_residual_4 -->
<g id="node319" class="node">
<title>l3_residual_4</title>
<polygon fill="lightsteelblue" stroke="black" points="14258,-102 13980,-102 13980,-50 14258,-50 14258,-102"/>
<text text-anchor="middle" x="14119" y="-90" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="14119" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="14119" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="14119" y="-57" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- l3_concat_4 -->
<g id="node320" class="node">
<title>l3_concat_4</title>
<polygon fill="lightyellow" stroke="black" points="13962.43,-128 13503.6,-128 13385.57,-24 13844.4,-24 13962.43,-128"/>
<text text-anchor="middle" x="13674" y="-90" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="13674" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="13674" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="13674" y="-57" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- l3_split_q_5 -->
<g id="node321" class="node">
<title>l3_split_q_5</title>
<polygon fill="lightyellow" stroke="black" points="13368.43,-128 12909.6,-128 12791.57,-24 13250.4,-24 13368.43,-128"/>
<text text-anchor="middle" x="13080" y="-90" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="13080" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="13080" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="13080" y="-57" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- l3_split_k_5 -->
<g id="node322" class="node">
<title>l3_split_k_5</title>
<polygon fill="lightyellow" stroke="black" points="12774.43,-128 12315.6,-128 12197.57,-24 12656.4,-24 12774.43,-128"/>
<text text-anchor="middle" x="12486" y="-90" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="12486" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="12486" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="12486" y="-57" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- l3_split_v_5 -->
<g id="node323" class="node">
<title>l3_split_v_5</title>
<polygon fill="lightyellow" stroke="black" points="12180.43,-128 11721.6,-128 11603.57,-24 12062.4,-24 12180.43,-128"/>
<text text-anchor="middle" x="11892" y="-90" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="11892" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="11892" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="11892" y="-57" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- l3_q_proj_5 -->
<g id="node324" class="node">
<title>l3_q_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="11586,-102 11308,-102 11308,-50 11586,-50 11586,-102"/>
<text text-anchor="middle" x="11447" y="-90" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="11447" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="11447" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="11447" y="-57" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- l3_k_proj_5 -->
<g id="node325" class="node">
<title>l3_k_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="11290,-102 11012,-102 11012,-50 11290,-50 11290,-102"/>
<text text-anchor="middle" x="11151" y="-90" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="11151" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="11151" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="11151" y="-57" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- l3_v_proj_5 -->
<g id="node326" class="node">
<title>l3_v_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="10994,-102 10716,-102 10716,-50 10994,-50 10994,-102"/>
<text text-anchor="middle" x="10855" y="-90" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="10855" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="10855" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="10855" y="-57" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- l3_mha_5 -->
<g id="node327" class="node">
<title>l3_mha_5</title>
<polygon fill="lightgreen" stroke="black" points="10698,-102 10420,-102 10420,-50 10698,-50 10698,-102"/>
<text text-anchor="middle" x="10559" y="-90" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="10559" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="10559" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="10559" y="-57" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- l3_mlp_fc_5 -->
<g id="node328" class="node">
<title>l3_mlp_fc_5</title>
<polygon fill="lightpink" stroke="black" points="10402,-102 10118,-102 10118,-50 10402,-50 10402,-102"/>
<text text-anchor="middle" x="10260" y="-90" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="10260" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="10260" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="10260" y="-57" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- l3_mlp_proj_5 -->
<g id="node329" class="node">
<title>l3_mlp_proj_5</title>
<polygon fill="lightpink" stroke="black" points="10100,-102 9822,-102 9822,-50 10100,-50 10100,-102"/>
<text text-anchor="middle" x="9961" y="-90" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="9961" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="9961" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="9961" y="-57" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- l3_residual_5 -->
<g id="node330" class="node">
<title>l3_residual_5</title>
<polygon fill="lightsteelblue" stroke="black" points="9804,-102 9526,-102 9526,-50 9804,-50 9804,-102"/>
<text text-anchor="middle" x="9665" y="-90" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="9665" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="9665" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="9665" y="-57" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- l3_concat_5 -->
<g id="node331" class="node">
<title>l3_concat_5</title>
<polygon fill="lightyellow" stroke="black" points="9508.43,-128 9049.6,-128 8931.57,-24 9390.4,-24 9508.43,-128"/>
<text text-anchor="middle" x="9220" y="-90" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="9220" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="9220" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="9220" y="-57" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- l3_split_q_6 -->
<g id="node332" class="node">
<title>l3_split_q_6</title>
<polygon fill="lightyellow" stroke="black" points="8914.43,-128 8455.6,-128 8337.57,-24 8796.4,-24 8914.43,-128"/>
<text text-anchor="middle" x="8626" y="-90" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="8626" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="8626" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="8626" y="-57" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- l3_split_k_6 -->
<g id="node333" class="node">
<title>l3_split_k_6</title>
<polygon fill="lightyellow" stroke="black" points="8320.43,-128 7861.6,-128 7743.57,-24 8202.4,-24 8320.43,-128"/>
<text text-anchor="middle" x="8032" y="-90" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="8032" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="8032" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="8032" y="-57" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- l3_split_v_6 -->
<g id="node334" class="node">
<title>l3_split_v_6</title>
<polygon fill="lightyellow" stroke="black" points="7726.43,-128 7267.6,-128 7149.57,-24 7608.4,-24 7726.43,-128"/>
<text text-anchor="middle" x="7438" y="-90" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="7438" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="7438" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="7438" y="-57" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- l3_q_proj_6 -->
<g id="node335" class="node">
<title>l3_q_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="7132,-102 6854,-102 6854,-50 7132,-50 7132,-102"/>
<text text-anchor="middle" x="6993" y="-90" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="6993" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="6993" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="6993" y="-57" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- l3_k_proj_6 -->
<g id="node336" class="node">
<title>l3_k_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="6836,-102 6558,-102 6558,-50 6836,-50 6836,-102"/>
<text text-anchor="middle" x="6697" y="-90" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="6697" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="6697" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="6697" y="-57" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- l3_v_proj_6 -->
<g id="node337" class="node">
<title>l3_v_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="6540,-102 6262,-102 6262,-50 6540,-50 6540,-102"/>
<text text-anchor="middle" x="6401" y="-90" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="6401" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="6401" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="6401" y="-57" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- l3_mha_6 -->
<g id="node338" class="node">
<title>l3_mha_6</title>
<polygon fill="lightgreen" stroke="black" points="6244,-102 5966,-102 5966,-50 6244,-50 6244,-102"/>
<text text-anchor="middle" x="6105" y="-90" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="6105" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="6105" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="6105" y="-57" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- l3_mlp_fc_6 -->
<g id="node339" class="node">
<title>l3_mlp_fc_6</title>
<polygon fill="lightpink" stroke="black" points="5948,-102 5664,-102 5664,-50 5948,-50 5948,-102"/>
<text text-anchor="middle" x="5806" y="-90" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="5806" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="5806" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="5806" y="-57" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- l3_mlp_proj_6 -->
<g id="node340" class="node">
<title>l3_mlp_proj_6</title>
<polygon fill="lightpink" stroke="black" points="5646,-102 5368,-102 5368,-50 5646,-50 5646,-102"/>
<text text-anchor="middle" x="5507" y="-90" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="5507" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="5507" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="5507" y="-57" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- l3_residual_6 -->
<g id="node341" class="node">
<title>l3_residual_6</title>
<polygon fill="lightsteelblue" stroke="black" points="5350,-102 5072,-102 5072,-50 5350,-50 5350,-102"/>
<text text-anchor="middle" x="5211" y="-90" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="5211" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="5211" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="5211" y="-57" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- l3_concat_6 -->
<g id="node342" class="node">
<title>l3_concat_6</title>
<polygon fill="lightyellow" stroke="black" points="5054.43,-128 4595.6,-128 4477.57,-24 4936.4,-24 5054.43,-128"/>
<text text-anchor="middle" x="4766" y="-90" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="4766" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="4766" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="4766" y="-57" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- l3_split_q_7 -->
<g id="node343" class="node">
<title>l3_split_q_7</title>
<polygon fill="lightyellow" stroke="black" points="4460.43,-128 4001.6,-128 3883.57,-24 4342.4,-24 4460.43,-128"/>
<text text-anchor="middle" x="4172" y="-90" font-family="Arial" font-size="10.00">Q Split</text>
<text text-anchor="middle" x="4172" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="4172" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="4172" y="-57" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- l3_split_k_7 -->
<g id="node344" class="node">
<title>l3_split_k_7</title>
<polygon fill="lightyellow" stroke="black" points="3866.43,-128 3407.6,-128 3289.57,-24 3748.4,-24 3866.43,-128"/>
<text text-anchor="middle" x="3578" y="-90" font-family="Arial" font-size="10.00">K Split</text>
<text text-anchor="middle" x="3578" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="3578" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="3578" y="-57" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- l3_split_v_7 -->
<g id="node345" class="node">
<title>l3_split_v_7</title>
<polygon fill="lightyellow" stroke="black" points="3272.43,-128 2813.6,-128 2695.57,-24 3154.4,-24 3272.43,-128"/>
<text text-anchor="middle" x="2984" y="-90" font-family="Arial" font-size="10.00">V Split</text>
<text text-anchor="middle" x="2984" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="2984" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="2984" y="-57" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- l3_q_proj_7 -->
<g id="node346" class="node">
<title>l3_q_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="2678,-102 2400,-102 2400,-50 2678,-50 2678,-102"/>
<text text-anchor="middle" x="2539" y="-90" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="2539" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="2539" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="2539" y="-57" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- l3_k_proj_7 -->
<g id="node347" class="node">
<title>l3_k_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="2382,-102 2104,-102 2104,-50 2382,-50 2382,-102"/>
<text text-anchor="middle" x="2243" y="-90" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="2243" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="2243" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="2243" y="-57" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- l3_v_proj_7 -->
<g id="node348" class="node">
<title>l3_v_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="2086,-102 1808,-102 1808,-50 2086,-50 2086,-102"/>
<text text-anchor="middle" x="1947" y="-90" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="1947" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="1947" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="1947" y="-57" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- l3_mha_7 -->
<g id="node349" class="node">
<title>l3_mha_7</title>
<polygon fill="lightgreen" stroke="black" points="1790,-102 1512,-102 1512,-50 1790,-50 1790,-102"/>
<text text-anchor="middle" x="1651" y="-90" font-family="Arial" font-size="10.00">MHA</text>
<text text-anchor="middle" x="1651" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="1651" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="1651" y="-57" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- l3_mlp_fc_7 -->
<g id="node350" class="node">
<title>l3_mlp_fc_7</title>
<polygon fill="lightpink" stroke="black" points="1494,-102 1210,-102 1210,-50 1494,-50 1494,-102"/>
<text text-anchor="middle" x="1352" y="-90" font-family="Arial" font-size="10.00">MLP FC</text>
<text text-anchor="middle" x="1352" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="1352" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="1352" y="-57" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- l3_mlp_proj_7 -->
<g id="node351" class="node">
<title>l3_mlp_proj_7</title>
<polygon fill="lightpink" stroke="black" points="1192,-102 914,-102 914,-50 1192,-50 1192,-102"/>
<text text-anchor="middle" x="1053" y="-90" font-family="Arial" font-size="10.00">MLP Projection</text>
<text text-anchor="middle" x="1053" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="1053" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="1053" y="-57" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- l3_residual_7 -->
<g id="node352" class="node">
<title>l3_residual_7</title>
<polygon fill="lightsteelblue" stroke="black" points="896,-102 618,-102 618,-50 896,-50 896,-102"/>
<text text-anchor="middle" x="757" y="-90" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="757" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="757" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="757" y="-57" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- l3_concat_7 -->
<g id="node353" class="node">
<title>l3_concat_7</title>
<polygon fill="lightyellow" stroke="black" points="600.43,-128 141.6,-128 23.57,-24 482.4,-24 600.43,-128"/>
<text text-anchor="middle" x="312" y="-90" font-family="Arial" font-size="10.00">TP Concat</text>
<text text-anchor="middle" x="312" y="-79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="312" y="-68" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="312" y="-57" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- final_concat -->
<g id="node354" class="node">
<title>final_concat</title>
<polygon fill="lightyellow" stroke="black" points="33483.38,-1158 33015.09,-1158 32894.62,-1054 33362.91,-1054 33483.38,-1158"/>
<text text-anchor="middle" x="33189" y="-1120" font-family="Arial" font-size="10.00">Final Concat</text>
<text text-anchor="middle" x="33189" y="-1109" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="33189" y="-1098" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="33189" y="-1087" font-family="Arial" font-size="10.00">GPU: all GPUs</text>
</g>
<!-- output -->
<g id="node355" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="33702" cy="-1106" rx="200.64" ry="36.54"/>
<text text-anchor="middle" x="33702" y="-1120" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="33702" y="-1109" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="33702" y="-1098" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="33702" y="-1087" font-family="Arial" font-size="10.00">GPU: all GPUs</text>
</g>
</g>
</svg>
