digraph {
	graph [bb="0,0,396.17,1970.6",
		bgcolor=white,
		rankdir=LR,
		size="25,20"
	];
	node [fontname=Arial,
		fontsize=11,
		label="\N"
	];
	edge [fontname=Arial,
		fontsize=9
	];
	subgraph cluster_node_0 {
		graph [bb="41,379.62,367.58,941.62",
			bgcolor=lightgray,
			label="Node 0 (GPUs 0-15)",
			lheight=0.21,
			lp="204.29,930.12",
			lwidth=1.97,
			style=rounded
		];
		gpu_0	[fillcolor=lightgreen,
			height=0.61111,
			label="GPU 0\nExpert 0\nTP Rank 0",
			pos="83,863.62",
			shape=rectangle,
			width=0.94444];
		gpu_1	[fillcolor=lightblue,
			height=0.61111,
			label="GPU 1\nExpert 0\nTP Rank 1",
			pos="325.58,877.62",
			shape=rectangle,
			width=0.94444];
		gpu_0 -> gpu_1	[color=red,
			label=TP_AllReduce,
			lp="207,873.62",
			pos="e,291.36,873.66 117.16,864.04 148.17,864.59 195.77,865.83 237,868.62 251.48,869.6 267.27,871.09 281.4,872.58",
			style=dashed];
		gpu_1 -> gpu_0	[color=red,
			label=TP_AllReduce,
			lp="207,883.62",
			pos="e,117.42,870.34 291.31,878.09 274.95,878.3 254.94,878.52 237,878.62 210.33,878.77 203.58,880.75 177,878.62 160.69,877.31 142.91,\
874.74 127.32,872.08",
			style=dashed];
		gpu_2	[fillcolor=lightgreen,
			height=0.61111,
			label="GPU 2\nExpert 1\nTP Rank 0",
			pos="83,797.62",
			shape=rectangle,
			width=0.94444];
		gpu_3	[fillcolor=lightblue,
			height=0.61111,
			label="GPU 3\nExpert 1\nTP Rank 1",
			pos="325.58,808.62",
			shape=rectangle,
			width=0.94444];
		gpu_2 -> gpu_3	[color=red,
			label=TP_AllReduce,
			lp="207,807.62",
			pos="e,291.33,806.06 117.14,798.36 148.14,799.14 195.73,800.53 237,802.62 251.31,803.35 266.93,804.35 280.96,805.33",
			style=dashed];
		gpu_3 -> gpu_2	[color=red,
			label=TP_AllReduce,
			lp="207,818.62",
			pos="e,117.42,804.34 291.33,810.5 274.97,811.33 254.96,812.21 237,812.62 210.34,813.23 203.58,814.75 177,812.62 160.69,811.31 142.91,\
808.74 127.32,806.08",
			style=dashed];
		gpu_4	[fillcolor=lightgreen,
			height=0.61111,
			label="GPU 4\nExpert 2\nTP Rank 0",
			pos="83,731.62",
			shape=rectangle,
			width=0.94444];
		gpu_5	[fillcolor=lightblue,
			height=0.61111,
			label="GPU 5\nExpert 2\nTP Rank 1",
			pos="325.58,740.62",
			shape=rectangle,
			width=0.94444];
		gpu_4 -> gpu_5	[color=red,
			label=TP_AllReduce,
			lp="207,741.62",
			pos="e,291.32,739 117.13,732.58 148.13,733.51 195.7,735 237,736.62 251.3,737.18 266.91,737.87 280.94,738.52",
			style=dashed];
		gpu_5 -> gpu_4	[color=red,
			label=TP_AllReduce,
			lp="207,752.62",
			pos="e,117.42,738.34 291.34,743.44 274.99,744.68 254.97,746.01 237,746.62 210.35,747.53 203.58,748.75 177,746.62 160.69,745.31 142.91,\
742.74 127.32,740.08",
			style=dashed];
		gpu_6	[fillcolor=lightgreen,
			height=0.61111,
			label="GPU 6\nExpert 3\nTP Rank 0",
			pos="83,665.62",
			shape=rectangle,
			width=0.94444];
		gpu_7	[fillcolor=lightblue,
			height=0.61111,
			label="GPU 7\nExpert 3\nTP Rank 1",
			pos="325.58,673.62",
			shape=rectangle,
			width=0.94444];
		gpu_6 -> gpu_7	[color=red,
			label=TP_AllReduce,
			lp="207,675.62",
			pos="e,291.31,672.47 117.13,666.69 148.12,667.69 195.7,669.24 237,670.62 251.3,671.1 266.91,671.63 280.94,672.11",
			style=dashed];
		gpu_7 -> gpu_6	[color=red,
			label=TP_AllReduce,
			lp="207,686.62",
			pos="e,117.42,672.34 291.35,676.91 275,678.36 254.99,679.9 237,680.62 210.35,681.69 203.58,682.75 177,680.62 160.69,679.31 142.91,676.74 \
127.32,674.08",
			style=dashed];
		gpu_8	[fillcolor=lightgreen,
			height=0.61111,
			label="GPU 8\nExpert 4\nTP Rank 0",
			pos="83,600.62",
			shape=rectangle,
			width=0.94444];
		gpu_9	[fillcolor=lightblue,
			height=0.61111,
			label="GPU 9\nExpert 4\nTP Rank 1",
			pos="325.58,607.62",
			shape=rectangle,
			width=0.94444];
		gpu_8 -> gpu_9	[color=red,
			label=TP_AllReduce,
			lp="207,609.62",
			pos="e,291.31,606.42 117.13,601.41 148.12,602.17 195.7,603.37 237,604.62 251.3,605.05 266.91,605.57 280.94,606.06",
			style=dashed];
		gpu_9 -> gpu_8	[color=red,
			label=TP_AllReduce,
			lp="207,620.62",
			pos="e,117.01,606.82 291.35,610.91 275,612.36 254.99,613.9 237,614.62 210.35,615.69 203.59,616.61 177,614.62 160.57,613.39 142.65,610.96 \
126.96,608.46",
			style=dashed];
		gpu_10	[fillcolor=lightgreen,
			height=0.61111,
			label="GPU 10\nExpert 5\nTP Rank 0",
			pos="83,535.62",
			shape=rectangle,
			width=0.94444];
		gpu_11	[fillcolor=lightblue,
			height=0.61111,
			label="GPU 11\nExpert 5\nTP Rank 1",
			pos="325.58,541.62",
			shape=rectangle,
			width=0.94444];
		gpu_10 -> gpu_11	[color=red,
			label=TP_AllReduce,
			lp="207,543.62",
			pos="e,291.32,540.37 117.13,536.13 148.12,536.64 195.7,537.51 237,538.62 251.3,539.01 266.91,539.51 280.94,540",
			style=dashed];
		gpu_11 -> gpu_10	[color=red,
			label=TP_AllReduce,
			lp="207,554.62",
			pos="e,117.03,541.38 291.35,544.91 275,546.36 254.99,547.9 237,548.62 210.35,549.69 203.6,550.47 177,548.62 160.59,547.48 142.67,545.22 \
126.98,542.9",
			style=dashed];
		gpu_12	[fillcolor=lightgreen,
			height=0.61111,
			label="GPU 12\nExpert 6\nTP Rank 0",
			pos="83,471.62",
			shape=rectangle,
			width=0.94444];
		gpu_13	[fillcolor=lightblue,
			height=0.61111,
			label="GPU 13\nExpert 6\nTP Rank 1",
			pos="325.58,475.62",
			shape=rectangle,
			width=0.94444];
		gpu_12 -> gpu_13	[color=red,
			label=TP_AllReduce,
			lp="207,477.62",
			pos="e,291.32,474.27 117.13,471.57 148.12,471.59 195.7,471.78 237,472.62 251.3,472.91 266.92,473.4 280.95,473.89",
			style=dashed];
		gpu_13 -> gpu_12	[color=red,
			label=TP_AllReduce,
			lp="207,487.62",
			pos="e,117.06,476.49 291.35,478.91 275,480.36 254.99,481.9 237,482.62 210.35,483.69 203.62,484.19 177,482.62 160.62,481.66 142.71,479.74 \
127.01,477.78",
			style=dashed];
		gpu_14	[fillcolor=lightgreen,
			height=0.61111,
			label="GPU 14\nExpert 7\nTP Rank 0",
			pos="83,409.62",
			shape=rectangle,
			width=0.94444];
		gpu_15	[fillcolor=lightblue,
			height=0.61111,
			label="GPU 15\nExpert 7\nTP Rank 1",
			pos="325.58,413.62",
			shape=rectangle,
			width=0.94444];
		gpu_14 -> gpu_15	[color=red,
			label=TP_AllReduce,
			lp="207,411.62",
			pos="e,291.35,410.34 117.14,407.84 148.14,406.44 195.72,404.98 237,406.62 251.33,407.19 266.95,408.29 280.98,409.45",
			style=dashed];
		gpu_15 -> gpu_14	[color=red,
			label=TP_AllReduce,
			lp="207,421.62",
			pos="e,117.11,412.72 291.32,415.03 274.96,415.65 254.95,416.31 237,416.62 210.34,417.08 203.65,417.62 177,416.62 160.83,416.01 143.11,\
414.81 127.52,413.58",
			style=dashed];
	}
	subgraph cluster_node_1 {
		graph [bb="0,949.62,167,1962.6",
			bgcolor=lightgray,
			label="Node 1 (GPUs 16-31)",
			lheight=0.21,
			lp="83.5,1951.1",
			lwidth=2.10,
			style=rounded
		];
		gpu_16	[fillcolor=lightgreen,
			height=0.61111,
			label="GPU 16\nExpert 8\nTP Rank 0",
			pos="83,1909.6",
			shape=rectangle,
			width=0.94444];
		gpu_17	[fillcolor=lightblue,
			height=0.61111,
			label="GPU 17\nExpert 8\nTP Rank 1",
			pos="83,1847.6",
			shape=rectangle,
			width=0.94444];
		gpu_18	[fillcolor=lightgreen,
			height=0.61111,
			label="GPU 18\nExpert 9\nTP Rank 0",
			pos="83,1785.6",
			shape=rectangle,
			width=0.94444];
		gpu_19	[fillcolor=lightblue,
			height=0.61111,
			label="GPU 19\nExpert 9\nTP Rank 1",
			pos="83,1723.6",
			shape=rectangle,
			width=0.94444];
		gpu_20	[fillcolor=lightgreen,
			height=0.61111,
			label="GPU 20\nExpert 10\nTP Rank 0",
			pos="83,1661.6",
			shape=rectangle,
			width=0.94444];
		gpu_21	[fillcolor=lightblue,
			height=0.61111,
			label="GPU 21\nExpert 10\nTP Rank 1",
			pos="83,1599.6",
			shape=rectangle,
			width=0.94444];
		gpu_22	[fillcolor=lightgreen,
			height=0.61111,
			label="GPU 22\nExpert 11\nTP Rank 0",
			pos="83,1537.6",
			shape=rectangle,
			width=0.94444];
		gpu_23	[fillcolor=lightblue,
			height=0.61111,
			label="GPU 23\nExpert 11\nTP Rank 1",
			pos="83,1475.6",
			shape=rectangle,
			width=0.94444];
		gpu_24	[fillcolor=lightgreen,
			height=0.61111,
			label="GPU 24\nExpert 12\nTP Rank 0",
			pos="83,1413.6",
			shape=rectangle,
			width=0.94444];
		gpu_25	[fillcolor=lightblue,
			height=0.61111,
			label="GPU 25\nExpert 12\nTP Rank 1",
			pos="83,1351.6",
			shape=rectangle,
			width=0.94444];
		gpu_26	[fillcolor=lightgreen,
			height=0.61111,
			label="GPU 26\nExpert 13\nTP Rank 0",
			pos="83,1289.6",
			shape=rectangle,
			width=0.94444];
		gpu_27	[fillcolor=lightblue,
			height=0.61111,
			label="GPU 27\nExpert 13\nTP Rank 1",
			pos="83,1227.6",
			shape=rectangle,
			width=0.94444];
		gpu_28	[fillcolor=lightgreen,
			height=0.61111,
			label="GPU 28\nExpert 14\nTP Rank 0",
			pos="83,1165.6",
			shape=rectangle,
			width=0.94444];
		gpu_29	[fillcolor=lightblue,
			height=0.61111,
			label="GPU 29\nExpert 14\nTP Rank 1",
			pos="83,1103.6",
			shape=rectangle,
			width=0.94444];
		gpu_30	[fillcolor=lightgreen,
			height=0.61111,
			label="GPU 30\nExpert 15\nTP Rank 0",
			pos="83,1041.6",
			shape=rectangle,
			width=0.94444];
		gpu_31	[fillcolor=lightblue,
			height=0.61111,
			label="GPU 31\nExpert 15\nTP Rank 1",
			pos="83,979.62",
			shape=rectangle,
			width=0.94444];
	}
	all2all	[fillcolor=yellow,
		height=0.5,
		label="All2All Router",
		pos="325.58,185.62",
		shape=diamond,
		width=1.9607];
	gpu_0 -> all2all	[color=blue,
		pos="e,319.23,202.17 117.05,858.53 134.99,853.92 155.74,845.17 167,828.62 193.7,789.39 154.82,443.58 177,401.62 192.33,372.62 215.64,\
383.53 237,358.62 275.79,313.38 302.82,247.98 315.8,211.94",
		style=dotted];
	gpu_2 -> all2all	[color=blue,
		pos="e,313.97,200.98 117.06,792.54 135,787.93 155.75,779.18 167,762.62 195.18,721.17 149.61,353.6 177,311.62 193.08,286.98 213.38,301.17 \
237,283.62 265.49,262.45 291.7,230.82 307.88,209.26",
		style=dotted];
	gpu_4 -> all2all	[color=blue,
		pos="e,310.01,199.81 117.05,726.53 134.98,721.91 155.73,713.16 167,696.62 192.66,658.96 152.05,324.76 177,286.62 193.11,262 212.16,274.4 \
237,258.62 260.84,243.49 285.31,222.55 302.3,206.98",
		style=dotted];
	gpu_6 -> all2all	[color=blue,
		pos="e,266.09,188.49 117.02,660.94 134.95,656.54 155.7,648.04 167,631.62 180.23,612.4 161.78,229.32 177,211.62 187.53,199.38 222.56,192.89 \
255.85,189.46",
		style=dotted];
	gpu_8 -> all2all	[color=blue,
		pos="e,295.15,175.21 117.01,595.92 134.93,591.53 155.68,583.03 167,566.62 179,549.24 161.92,201.41 177,186.62 204.85,159.31 251.78,164.13 \
285.24,172.52",
		style=dotted];
	gpu_10 -> all2all	[color=blue,
		pos="e,312.38,170.8 117.4,531.23 135.22,527.02 155.73,518.78 167,502.62 179.43,484.8 161.44,126.79 177,111.62 215,74.578 275.24,129.83 \
305.66,163.25",
		style=dotted];
	gpu_12 -> all2all	[color=blue,
		pos="e,314.75,170.15 117.33,468.05 135.12,464.27 155.64,456.51 167,440.62 178.44,424.62 162.89,100.34 177,86.622 219.25,45.548 280.6,\
120.86 309.04,161.76",
		style=dotted];
	gpu_14 -> all2all	[color=blue,
		pos="e,321.91,168.28 85.661,387.53 91.915,311.01 116.82,59.359 177,11.622 197.89,-4.9505 214.3,-2.3669 237,11.622 289.33,43.868 311.5,\
118.04 319.96,158.34",
		style=dotted];
	all2all -> gpu_0	[color=blue,
		pos="e,117.07,858.54 318.68,201.99 307.21,231.78 279.25,295.32 237,333.62 215.2,353.39 193.07,336.97 177,361.62 148.65,405.1 196.16,785.69 \
167,828.62 157.77,842.21 142.15,850.54 126.94,855.63",
		style=dotted];
	all2all -> gpu_2	[color=blue,
		pos="e,117.05,792.53 316.71,201.6 303.41,227.17 274.27,277.59 237,308.62 214.39,327.45 193.1,311.99 177,336.62 151.1,376.26 193.64,723.48 \
167,762.62 157.76,776.2 142.14,784.52 126.92,789.62",
		style=dotted];
	all2all -> gpu_4	[color=blue,
		pos="e,117.06,726.54 302.84,198.05 285.24,207.98 259.74,222.1 237,233.62 210.75,246.92 193.09,236.98 177,261.62 150.56,302.1 194.19,656.65 \
167,696.62 157.76,710.2 142.14,718.53 126.93,723.63",
		style=dotted];
	all2all -> gpu_6	[color=blue,
		pos="e,117.01,660.93 291.36,194.94 250.02,206.85 183.98,227.08 177,236.62 151.07,272.05 191.92,595.48 167,631.62 157.72,645.08 142.09,\
653.22 126.88,658.14",
		style=dotted];
	all2all -> gpu_8	[color=blue,
		pos="e,117.02,595.93 303.98,172.93 272.14,155.11 211.1,128.36 177,161.62 160.89,177.34 179.77,548.09 167,566.62 157.72,580.09 142.09,\
588.22 126.88,593.14",
		style=dotted];
	all2all -> gpu_10	[color=blue,
		pos="e,117.39,531.23 308.95,171.58 279.26,146.59 214.34,100.28 177,136.62 162.42,150.81 178.65,485.95 167,502.62 157.75,515.86 142.28,\
523.79 127.19,528.54",
		style=dotted];
	all2all -> gpu_12	[color=blue,
		pos="e,117.34,468.05 317.9,169.18 306.11,142.66 278.83,91.343 237,70.622 213.1,58.785 196.11,52.022 177,70.622 162.26,84.965 178.95,423.89 \
167,440.62 157.69,453.66 142.21,461.22 127.12,465.6",
		style=dotted];
	all2all -> gpu_14	[color=blue,
		pos="e,86.042,387.38 320.55,168.72 311.77,136.19 287.53,65.531 237,36.622 213.85,23.379 198.01,20.204 177,36.622 122.84,78.938 95.628,\
294.62 87.062,377.3",
		style=dotted];
}
