<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="294pt" height="1440pt"
 viewBox="0.00 0.00 294.15 1440.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.73 0.73) rotate(0) translate(4 1974.62)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1974.62 400.17,-1974.62 400.17,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_node_0</title>
<path fill="lightgray" stroke="black" d="M53,-379.62C53,-379.62 355.58,-379.62 355.58,-379.62 361.58,-379.62 367.58,-385.62 367.58,-391.62 367.58,-391.62 367.58,-929.62 367.58,-929.62 367.58,-935.62 361.58,-941.62 355.58,-941.62 355.58,-941.62 53,-941.62 53,-941.62 47,-941.62 41,-935.62 41,-929.62 41,-929.62 41,-391.62 41,-391.62 41,-385.62 47,-379.62 53,-379.62"/>
<text text-anchor="middle" x="204.29" y="-926.42" font-family="Times,serif" font-size="14.00">Node 0 (GPUs 0&#45;15)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_node_1</title>
<path fill="lightgray" stroke="black" d="M12,-949.62C12,-949.62 155,-949.62 155,-949.62 161,-949.62 167,-955.62 167,-961.62 167,-961.62 167,-1950.62 167,-1950.62 167,-1956.62 161,-1962.62 155,-1962.62 155,-1962.62 12,-1962.62 12,-1962.62 6,-1962.62 0,-1956.62 0,-1950.62 0,-1950.62 0,-961.62 0,-961.62 0,-955.62 6,-949.62 12,-949.62"/>
<text text-anchor="middle" x="83.5" y="-1947.42" font-family="Times,serif" font-size="14.00">Node 1 (GPUs 16&#45;31)</text>
</g>
<!-- gpu_0 -->
<g id="node1" class="node">
<title>gpu_0</title>
<polygon fill="none" stroke="black" points="117,-885.62 49,-885.62 49,-841.62 117,-841.62 117,-885.62"/>
<text text-anchor="middle" x="83" y="-872.82" font-family="Arial" font-size="11.00">GPU 0</text>
<text text-anchor="middle" x="83" y="-860.82" font-family="Arial" font-size="11.00">Expert 0</text>
<text text-anchor="middle" x="83" y="-848.82" font-family="Arial" font-size="11.00">TP Rank 0</text>
</g>
<!-- gpu_1 -->
<g id="node2" class="node">
<title>gpu_1</title>
<polygon fill="none" stroke="black" points="359.58,-899.62 291.58,-899.62 291.58,-855.62 359.58,-855.62 359.58,-899.62"/>
<text text-anchor="middle" x="325.58" y="-886.82" font-family="Arial" font-size="11.00">GPU 1</text>
<text text-anchor="middle" x="325.58" y="-874.82" font-family="Arial" font-size="11.00">Expert 0</text>
<text text-anchor="middle" x="325.58" y="-862.82" font-family="Arial" font-size="11.00">TP Rank 1</text>
</g>
<!-- gpu_0&#45;&gt;gpu_1 -->
<g id="edge1" class="edge">
<title>gpu_0&#45;&gt;gpu_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M117.16,-864.04C148.17,-864.59 195.77,-865.83 237,-868.62 251.48,-869.6 267.27,-871.09 281.4,-872.58"/>
<polygon fill="red" stroke="red" points="281.04,-876.06 291.36,-873.66 281.79,-869.1 281.04,-876.06"/>
<text text-anchor="middle" x="207" y="-871.42" font-family="Arial" font-size="9.00">TP_AllReduce</text>
</g>
<!-- all2all -->
<g id="node33" class="node">
<title>all2all</title>
<polygon fill="none" stroke="black" points="325.58,-203.62 254.92,-185.62 325.58,-167.62 396.25,-185.62 325.58,-203.62"/>
<text text-anchor="middle" x="325.58" y="-182.82" font-family="Arial" font-size="11.00">All2All Router</text>
</g>
<!-- gpu_0&#45;&gt;all2all -->
<g id="edge17" class="edge">
<title>gpu_0&#45;&gt;all2all</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M117.05,-858.53C134.99,-853.92 155.74,-845.17 167,-828.62 193.7,-789.39 154.82,-443.58 177,-401.62 192.33,-372.62 215.64,-383.53 237,-358.62 275.79,-313.38 302.82,-247.98 315.8,-211.94"/>
<polygon fill="blue" stroke="blue" points="319.22,-212.77 319.23,-202.17 312.61,-210.45 319.22,-212.77"/>
</g>
<!-- gpu_1&#45;&gt;gpu_0 -->
<g id="edge2" class="edge">
<title>gpu_1&#45;&gt;gpu_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M291.31,-878.09C274.95,-878.3 254.94,-878.52 237,-878.62 210.33,-878.77 203.58,-880.75 177,-878.62 160.69,-877.31 142.91,-874.74 127.32,-872.08"/>
<polygon fill="red" stroke="red" points="127.87,-868.63 117.42,-870.34 126.66,-875.52 127.87,-868.63"/>
<text text-anchor="middle" x="207" y="-881.42" font-family="Arial" font-size="9.00">TP_AllReduce</text>
</g>
<!-- gpu_2 -->
<g id="node3" class="node">
<title>gpu_2</title>
<polygon fill="none" stroke="black" points="117,-819.62 49,-819.62 49,-775.62 117,-775.62 117,-819.62"/>
<text text-anchor="middle" x="83" y="-806.82" font-family="Arial" font-size="11.00">GPU 2</text>
<text text-anchor="middle" x="83" y="-794.82" font-family="Arial" font-size="11.00">Expert 1</text>
<text text-anchor="middle" x="83" y="-782.82" font-family="Arial" font-size="11.00">TP Rank 0</text>
</g>
<!-- gpu_3 -->
<g id="node4" class="node">
<title>gpu_3</title>
<polygon fill="none" stroke="black" points="359.58,-830.62 291.58,-830.62 291.58,-786.62 359.58,-786.62 359.58,-830.62"/>
<text text-anchor="middle" x="325.58" y="-817.82" font-family="Arial" font-size="11.00">GPU 3</text>
<text text-anchor="middle" x="325.58" y="-805.82" font-family="Arial" font-size="11.00">Expert 1</text>
<text text-anchor="middle" x="325.58" y="-793.82" font-family="Arial" font-size="11.00">TP Rank 1</text>
</g>
<!-- gpu_2&#45;&gt;gpu_3 -->
<g id="edge3" class="edge">
<title>gpu_2&#45;&gt;gpu_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M117.14,-798.36C148.14,-799.14 195.73,-800.53 237,-802.62 251.31,-803.35 266.93,-804.35 280.96,-805.33"/>
<polygon fill="red" stroke="red" points="281.11,-808.84 291.33,-806.06 281.6,-801.86 281.11,-808.84"/>
<text text-anchor="middle" x="207" y="-805.42" font-family="Arial" font-size="9.00">TP_AllReduce</text>
</g>
<!-- gpu_2&#45;&gt;all2all -->
<g id="edge19" class="edge">
<title>gpu_2&#45;&gt;all2all</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M117.06,-792.54C135,-787.93 155.75,-779.18 167,-762.62 195.18,-721.17 149.61,-353.6 177,-311.62 193.08,-286.98 213.38,-301.17 237,-283.62 265.49,-262.45 291.7,-230.82 307.88,-209.26"/>
<polygon fill="blue" stroke="blue" points="310.86,-211.11 313.97,-200.98 305.23,-206.96 310.86,-211.11"/>
</g>
<!-- gpu_3&#45;&gt;gpu_2 -->
<g id="edge4" class="edge">
<title>gpu_3&#45;&gt;gpu_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M291.33,-810.5C274.97,-811.33 254.96,-812.21 237,-812.62 210.34,-813.23 203.58,-814.75 177,-812.62 160.69,-811.31 142.91,-808.74 127.32,-806.08"/>
<polygon fill="red" stroke="red" points="127.87,-802.63 117.42,-804.34 126.66,-809.52 127.87,-802.63"/>
<text text-anchor="middle" x="207" y="-816.42" font-family="Arial" font-size="9.00">TP_AllReduce</text>
</g>
<!-- gpu_4 -->
<g id="node5" class="node">
<title>gpu_4</title>
<polygon fill="none" stroke="black" points="117,-753.62 49,-753.62 49,-709.62 117,-709.62 117,-753.62"/>
<text text-anchor="middle" x="83" y="-740.82" font-family="Arial" font-size="11.00">GPU 4</text>
<text text-anchor="middle" x="83" y="-728.82" font-family="Arial" font-size="11.00">Expert 2</text>
<text text-anchor="middle" x="83" y="-716.82" font-family="Arial" font-size="11.00">TP Rank 0</text>
</g>
<!-- gpu_5 -->
<g id="node6" class="node">
<title>gpu_5</title>
<polygon fill="none" stroke="black" points="359.58,-762.62 291.58,-762.62 291.58,-718.62 359.58,-718.62 359.58,-762.62"/>
<text text-anchor="middle" x="325.58" y="-749.82" font-family="Arial" font-size="11.00">GPU 5</text>
<text text-anchor="middle" x="325.58" y="-737.82" font-family="Arial" font-size="11.00">Expert 2</text>
<text text-anchor="middle" x="325.58" y="-725.82" font-family="Arial" font-size="11.00">TP Rank 1</text>
</g>
<!-- gpu_4&#45;&gt;gpu_5 -->
<g id="edge5" class="edge">
<title>gpu_4&#45;&gt;gpu_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M117.13,-732.58C148.13,-733.51 195.7,-735 237,-736.62 251.3,-737.18 266.91,-737.87 280.94,-738.52"/>
<polygon fill="red" stroke="red" points="281.16,-742.03 291.32,-739 281.49,-735.04 281.16,-742.03"/>
<text text-anchor="middle" x="207" y="-739.42" font-family="Arial" font-size="9.00">TP_AllReduce</text>
</g>
<!-- gpu_4&#45;&gt;all2all -->
<g id="edge21" class="edge">
<title>gpu_4&#45;&gt;all2all</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M117.05,-726.53C134.98,-721.91 155.73,-713.16 167,-696.62 192.66,-658.96 152.05,-324.76 177,-286.62 193.11,-262 212.16,-274.4 237,-258.62 260.84,-243.49 285.31,-222.55 302.3,-206.98"/>
<polygon fill="blue" stroke="blue" points="305.07,-209.19 310.01,-199.81 300.3,-204.06 305.07,-209.19"/>
</g>
<!-- gpu_5&#45;&gt;gpu_4 -->
<g id="edge6" class="edge">
<title>gpu_5&#45;&gt;gpu_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M291.34,-743.44C274.99,-744.68 254.97,-746.01 237,-746.62 210.35,-747.53 203.58,-748.75 177,-746.62 160.69,-745.31 142.91,-742.74 127.32,-740.08"/>
<polygon fill="red" stroke="red" points="127.87,-736.63 117.42,-738.34 126.66,-743.52 127.87,-736.63"/>
<text text-anchor="middle" x="207" y="-750.42" font-family="Arial" font-size="9.00">TP_AllReduce</text>
</g>
<!-- gpu_6 -->
<g id="node7" class="node">
<title>gpu_6</title>
<polygon fill="none" stroke="black" points="117,-687.62 49,-687.62 49,-643.62 117,-643.62 117,-687.62"/>
<text text-anchor="middle" x="83" y="-674.82" font-family="Arial" font-size="11.00">GPU 6</text>
<text text-anchor="middle" x="83" y="-662.82" font-family="Arial" font-size="11.00">Expert 3</text>
<text text-anchor="middle" x="83" y="-650.82" font-family="Arial" font-size="11.00">TP Rank 0</text>
</g>
<!-- gpu_7 -->
<g id="node8" class="node">
<title>gpu_7</title>
<polygon fill="none" stroke="black" points="359.58,-695.62 291.58,-695.62 291.58,-651.62 359.58,-651.62 359.58,-695.62"/>
<text text-anchor="middle" x="325.58" y="-682.82" font-family="Arial" font-size="11.00">GPU 7</text>
<text text-anchor="middle" x="325.58" y="-670.82" font-family="Arial" font-size="11.00">Expert 3</text>
<text text-anchor="middle" x="325.58" y="-658.82" font-family="Arial" font-size="11.00">TP Rank 1</text>
</g>
<!-- gpu_6&#45;&gt;gpu_7 -->
<g id="edge7" class="edge">
<title>gpu_6&#45;&gt;gpu_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M117.13,-666.69C148.12,-667.69 195.7,-669.24 237,-670.62 251.3,-671.1 266.91,-671.63 280.94,-672.11"/>
<polygon fill="red" stroke="red" points="281.2,-675.62 291.31,-672.47 281.44,-668.63 281.2,-675.62"/>
<text text-anchor="middle" x="207" y="-673.42" font-family="Arial" font-size="9.00">TP_AllReduce</text>
</g>
<!-- gpu_6&#45;&gt;all2all -->
<g id="edge23" class="edge">
<title>gpu_6&#45;&gt;all2all</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M117.02,-660.94C134.95,-656.54 155.7,-648.04 167,-631.62 180.23,-612.4 161.78,-229.32 177,-211.62 187.53,-199.38 222.56,-192.89 255.85,-189.46"/>
<polygon fill="blue" stroke="blue" points="256.47,-192.92 266.09,-188.49 255.81,-185.95 256.47,-192.92"/>
</g>
<!-- gpu_7&#45;&gt;gpu_6 -->
<g id="edge8" class="edge">
<title>gpu_7&#45;&gt;gpu_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M291.35,-676.91C275,-678.36 254.99,-679.9 237,-680.62 210.35,-681.69 203.58,-682.75 177,-680.62 160.69,-679.31 142.91,-676.74 127.32,-674.08"/>
<polygon fill="red" stroke="red" points="127.87,-670.63 117.42,-672.34 126.66,-677.52 127.87,-670.63"/>
<text text-anchor="middle" x="207" y="-684.42" font-family="Arial" font-size="9.00">TP_AllReduce</text>
</g>
<!-- gpu_8 -->
<g id="node9" class="node">
<title>gpu_8</title>
<polygon fill="none" stroke="black" points="117,-622.62 49,-622.62 49,-578.62 117,-578.62 117,-622.62"/>
<text text-anchor="middle" x="83" y="-609.82" font-family="Arial" font-size="11.00">GPU 8</text>
<text text-anchor="middle" x="83" y="-597.82" font-family="Arial" font-size="11.00">Expert 4</text>
<text text-anchor="middle" x="83" y="-585.82" font-family="Arial" font-size="11.00">TP Rank 0</text>
</g>
<!-- gpu_9 -->
<g id="node10" class="node">
<title>gpu_9</title>
<polygon fill="none" stroke="black" points="359.58,-629.62 291.58,-629.62 291.58,-585.62 359.58,-585.62 359.58,-629.62"/>
<text text-anchor="middle" x="325.58" y="-616.82" font-family="Arial" font-size="11.00">GPU 9</text>
<text text-anchor="middle" x="325.58" y="-604.82" font-family="Arial" font-size="11.00">Expert 4</text>
<text text-anchor="middle" x="325.58" y="-592.82" font-family="Arial" font-size="11.00">TP Rank 1</text>
</g>
<!-- gpu_8&#45;&gt;gpu_9 -->
<g id="edge9" class="edge">
<title>gpu_8&#45;&gt;gpu_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M117.13,-601.41C148.12,-602.17 195.7,-603.37 237,-604.62 251.3,-605.05 266.91,-605.57 280.94,-606.06"/>
<polygon fill="red" stroke="red" points="281.2,-609.57 291.31,-606.42 281.44,-602.57 281.2,-609.57"/>
<text text-anchor="middle" x="207" y="-607.42" font-family="Arial" font-size="9.00">TP_AllReduce</text>
</g>
<!-- gpu_8&#45;&gt;all2all -->
<g id="edge25" class="edge">
<title>gpu_8&#45;&gt;all2all</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M117.01,-595.92C134.93,-591.53 155.68,-583.03 167,-566.62 179,-549.24 161.92,-201.41 177,-186.62 204.85,-159.31 251.78,-164.13 285.24,-172.52"/>
<polygon fill="blue" stroke="blue" points="284.58,-175.97 295.15,-175.21 286.42,-169.22 284.58,-175.97"/>
</g>
<!-- gpu_9&#45;&gt;gpu_8 -->
<g id="edge10" class="edge">
<title>gpu_9&#45;&gt;gpu_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M291.35,-610.91C275,-612.36 254.99,-613.9 237,-614.62 210.35,-615.69 203.59,-616.61 177,-614.62 160.57,-613.39 142.65,-610.96 126.96,-608.46"/>
<polygon fill="red" stroke="red" points="127.44,-604.99 117.01,-606.82 126.3,-611.9 127.44,-604.99"/>
<text text-anchor="middle" x="207" y="-618.42" font-family="Arial" font-size="9.00">TP_AllReduce</text>
</g>
<!-- gpu_10 -->
<g id="node11" class="node">
<title>gpu_10</title>
<polygon fill="none" stroke="black" points="117,-557.62 49,-557.62 49,-513.62 117,-513.62 117,-557.62"/>
<text text-anchor="middle" x="83" y="-544.82" font-family="Arial" font-size="11.00">GPU 10</text>
<text text-anchor="middle" x="83" y="-532.82" font-family="Arial" font-size="11.00">Expert 5</text>
<text text-anchor="middle" x="83" y="-520.82" font-family="Arial" font-size="11.00">TP Rank 0</text>
</g>
<!-- gpu_11 -->
<g id="node12" class="node">
<title>gpu_11</title>
<polygon fill="none" stroke="black" points="359.58,-563.62 291.58,-563.62 291.58,-519.62 359.58,-519.62 359.58,-563.62"/>
<text text-anchor="middle" x="325.58" y="-550.82" font-family="Arial" font-size="11.00">GPU 11</text>
<text text-anchor="middle" x="325.58" y="-538.82" font-family="Arial" font-size="11.00">Expert 5</text>
<text text-anchor="middle" x="325.58" y="-526.82" font-family="Arial" font-size="11.00">TP Rank 1</text>
</g>
<!-- gpu_10&#45;&gt;gpu_11 -->
<g id="edge11" class="edge">
<title>gpu_10&#45;&gt;gpu_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M117.13,-536.13C148.12,-536.64 195.7,-537.51 237,-538.62 251.3,-539.01 266.91,-539.51 280.94,-540"/>
<polygon fill="red" stroke="red" points="281.2,-543.51 291.32,-540.37 281.45,-536.52 281.2,-543.51"/>
<text text-anchor="middle" x="207" y="-541.42" font-family="Arial" font-size="9.00">TP_AllReduce</text>
</g>
<!-- gpu_10&#45;&gt;all2all -->
<g id="edge27" class="edge">
<title>gpu_10&#45;&gt;all2all</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M117.4,-531.23C135.22,-527.02 155.73,-518.78 167,-502.62 179.43,-484.8 161.44,-126.79 177,-111.62 215,-74.58 275.24,-129.83 305.66,-163.25"/>
<polygon fill="blue" stroke="blue" points="303.12,-165.65 312.38,-170.8 308.35,-161 303.12,-165.65"/>
</g>
<!-- gpu_11&#45;&gt;gpu_10 -->
<g id="edge12" class="edge">
<title>gpu_11&#45;&gt;gpu_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M291.35,-544.91C275,-546.36 254.99,-547.9 237,-548.62 210.35,-549.69 203.6,-550.47 177,-548.62 160.59,-547.48 142.67,-545.22 126.98,-542.9"/>
<polygon fill="red" stroke="red" points="127.44,-539.43 117.03,-541.38 126.38,-546.35 127.44,-539.43"/>
<text text-anchor="middle" x="207" y="-552.42" font-family="Arial" font-size="9.00">TP_AllReduce</text>
</g>
<!-- gpu_12 -->
<g id="node13" class="node">
<title>gpu_12</title>
<polygon fill="none" stroke="black" points="117,-493.62 49,-493.62 49,-449.62 117,-449.62 117,-493.62"/>
<text text-anchor="middle" x="83" y="-480.82" font-family="Arial" font-size="11.00">GPU 12</text>
<text text-anchor="middle" x="83" y="-468.82" font-family="Arial" font-size="11.00">Expert 6</text>
<text text-anchor="middle" x="83" y="-456.82" font-family="Arial" font-size="11.00">TP Rank 0</text>
</g>
<!-- gpu_13 -->
<g id="node14" class="node">
<title>gpu_13</title>
<polygon fill="none" stroke="black" points="359.58,-497.62 291.58,-497.62 291.58,-453.62 359.58,-453.62 359.58,-497.62"/>
<text text-anchor="middle" x="325.58" y="-484.82" font-family="Arial" font-size="11.00">GPU 13</text>
<text text-anchor="middle" x="325.58" y="-472.82" font-family="Arial" font-size="11.00">Expert 6</text>
<text text-anchor="middle" x="325.58" y="-460.82" font-family="Arial" font-size="11.00">TP Rank 1</text>
</g>
<!-- gpu_12&#45;&gt;gpu_13 -->
<g id="edge13" class="edge">
<title>gpu_12&#45;&gt;gpu_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M117.13,-471.57C148.12,-471.59 195.7,-471.78 237,-472.62 251.3,-472.91 266.92,-473.4 280.95,-473.89"/>
<polygon fill="red" stroke="red" points="281.2,-477.4 291.32,-474.27 281.45,-470.41 281.2,-477.4"/>
<text text-anchor="middle" x="207" y="-475.42" font-family="Arial" font-size="9.00">TP_AllReduce</text>
</g>
<!-- gpu_12&#45;&gt;all2all -->
<g id="edge29" class="edge">
<title>gpu_12&#45;&gt;all2all</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M117.33,-468.05C135.12,-464.27 155.64,-456.51 167,-440.62 178.44,-424.62 162.89,-100.34 177,-86.62 219.25,-45.55 280.6,-120.86 309.04,-161.76"/>
<polygon fill="blue" stroke="blue" points="306.23,-163.85 314.75,-170.15 312.01,-159.91 306.23,-163.85"/>
</g>
<!-- gpu_13&#45;&gt;gpu_12 -->
<g id="edge14" class="edge">
<title>gpu_13&#45;&gt;gpu_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M291.35,-478.91C275,-480.36 254.99,-481.9 237,-482.62 210.35,-483.69 203.62,-484.19 177,-482.62 160.62,-481.66 142.71,-479.74 127.01,-477.78"/>
<polygon fill="red" stroke="red" points="127.42,-474.3 117.06,-476.49 126.53,-481.25 127.42,-474.3"/>
<text text-anchor="middle" x="207" y="-485.42" font-family="Arial" font-size="9.00">TP_AllReduce</text>
</g>
<!-- gpu_14 -->
<g id="node15" class="node">
<title>gpu_14</title>
<polygon fill="none" stroke="black" points="117,-431.62 49,-431.62 49,-387.62 117,-387.62 117,-431.62"/>
<text text-anchor="middle" x="83" y="-418.82" font-family="Arial" font-size="11.00">GPU 14</text>
<text text-anchor="middle" x="83" y="-406.82" font-family="Arial" font-size="11.00">Expert 7</text>
<text text-anchor="middle" x="83" y="-394.82" font-family="Arial" font-size="11.00">TP Rank 0</text>
</g>
<!-- gpu_15 -->
<g id="node16" class="node">
<title>gpu_15</title>
<polygon fill="none" stroke="black" points="359.58,-435.62 291.58,-435.62 291.58,-391.62 359.58,-391.62 359.58,-435.62"/>
<text text-anchor="middle" x="325.58" y="-422.82" font-family="Arial" font-size="11.00">GPU 15</text>
<text text-anchor="middle" x="325.58" y="-410.82" font-family="Arial" font-size="11.00">Expert 7</text>
<text text-anchor="middle" x="325.58" y="-398.82" font-family="Arial" font-size="11.00">TP Rank 1</text>
</g>
<!-- gpu_14&#45;&gt;gpu_15 -->
<g id="edge15" class="edge">
<title>gpu_14&#45;&gt;gpu_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M117.14,-407.84C148.14,-406.44 195.72,-404.98 237,-406.62 251.33,-407.19 266.95,-408.29 280.98,-409.45"/>
<polygon fill="red" stroke="red" points="281.09,-412.97 291.35,-410.34 281.69,-406 281.09,-412.97"/>
<text text-anchor="middle" x="207" y="-409.42" font-family="Arial" font-size="9.00">TP_AllReduce</text>
</g>
<!-- gpu_14&#45;&gt;all2all -->
<g id="edge31" class="edge">
<title>gpu_14&#45;&gt;all2all</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M85.66,-387.53C91.91,-311.01 116.82,-59.36 177,-11.62 197.89,4.95 214.3,2.37 237,-11.62 289.33,-43.87 311.5,-118.04 319.96,-158.34"/>
<polygon fill="blue" stroke="blue" points="316.55,-159.15 321.91,-168.28 323.42,-157.8 316.55,-159.15"/>
</g>
<!-- gpu_15&#45;&gt;gpu_14 -->
<g id="edge16" class="edge">
<title>gpu_15&#45;&gt;gpu_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M291.32,-415.03C274.96,-415.65 254.95,-416.31 237,-416.62 210.34,-417.08 203.65,-417.62 177,-416.62 160.83,-416.01 143.11,-414.81 127.52,-413.58"/>
<polygon fill="red" stroke="red" points="127.36,-410.05 117.11,-412.72 126.79,-417.03 127.36,-410.05"/>
<text text-anchor="middle" x="207" y="-419.42" font-family="Arial" font-size="9.00">TP_AllReduce</text>
</g>
<!-- gpu_16 -->
<g id="node17" class="node">
<title>gpu_16</title>
<polygon fill="none" stroke="black" points="117,-1931.62 49,-1931.62 49,-1887.62 117,-1887.62 117,-1931.62"/>
<text text-anchor="middle" x="83" y="-1918.82" font-family="Arial" font-size="11.00">GPU 16</text>
<text text-anchor="middle" x="83" y="-1906.82" font-family="Arial" font-size="11.00">Expert 8</text>
<text text-anchor="middle" x="83" y="-1894.82" font-family="Arial" font-size="11.00">TP Rank 0</text>
</g>
<!-- gpu_17 -->
<g id="node18" class="node">
<title>gpu_17</title>
<polygon fill="none" stroke="black" points="117,-1869.62 49,-1869.62 49,-1825.62 117,-1825.62 117,-1869.62"/>
<text text-anchor="middle" x="83" y="-1856.82" font-family="Arial" font-size="11.00">GPU 17</text>
<text text-anchor="middle" x="83" y="-1844.82" font-family="Arial" font-size="11.00">Expert 8</text>
<text text-anchor="middle" x="83" y="-1832.82" font-family="Arial" font-size="11.00">TP Rank 1</text>
</g>
<!-- gpu_18 -->
<g id="node19" class="node">
<title>gpu_18</title>
<polygon fill="none" stroke="black" points="117,-1807.62 49,-1807.62 49,-1763.62 117,-1763.62 117,-1807.62"/>
<text text-anchor="middle" x="83" y="-1794.82" font-family="Arial" font-size="11.00">GPU 18</text>
<text text-anchor="middle" x="83" y="-1782.82" font-family="Arial" font-size="11.00">Expert 9</text>
<text text-anchor="middle" x="83" y="-1770.82" font-family="Arial" font-size="11.00">TP Rank 0</text>
</g>
<!-- gpu_19 -->
<g id="node20" class="node">
<title>gpu_19</title>
<polygon fill="none" stroke="black" points="117,-1745.62 49,-1745.62 49,-1701.62 117,-1701.62 117,-1745.62"/>
<text text-anchor="middle" x="83" y="-1732.82" font-family="Arial" font-size="11.00">GPU 19</text>
<text text-anchor="middle" x="83" y="-1720.82" font-family="Arial" font-size="11.00">Expert 9</text>
<text text-anchor="middle" x="83" y="-1708.82" font-family="Arial" font-size="11.00">TP Rank 1</text>
</g>
<!-- gpu_20 -->
<g id="node21" class="node">
<title>gpu_20</title>
<polygon fill="none" stroke="black" points="117,-1683.62 49,-1683.62 49,-1639.62 117,-1639.62 117,-1683.62"/>
<text text-anchor="middle" x="83" y="-1670.82" font-family="Arial" font-size="11.00">GPU 20</text>
<text text-anchor="middle" x="83" y="-1658.82" font-family="Arial" font-size="11.00">Expert 10</text>
<text text-anchor="middle" x="83" y="-1646.82" font-family="Arial" font-size="11.00">TP Rank 0</text>
</g>
<!-- gpu_21 -->
<g id="node22" class="node">
<title>gpu_21</title>
<polygon fill="none" stroke="black" points="117,-1621.62 49,-1621.62 49,-1577.62 117,-1577.62 117,-1621.62"/>
<text text-anchor="middle" x="83" y="-1608.82" font-family="Arial" font-size="11.00">GPU 21</text>
<text text-anchor="middle" x="83" y="-1596.82" font-family="Arial" font-size="11.00">Expert 10</text>
<text text-anchor="middle" x="83" y="-1584.82" font-family="Arial" font-size="11.00">TP Rank 1</text>
</g>
<!-- gpu_22 -->
<g id="node23" class="node">
<title>gpu_22</title>
<polygon fill="none" stroke="black" points="117,-1559.62 49,-1559.62 49,-1515.62 117,-1515.62 117,-1559.62"/>
<text text-anchor="middle" x="83" y="-1546.82" font-family="Arial" font-size="11.00">GPU 22</text>
<text text-anchor="middle" x="83" y="-1534.82" font-family="Arial" font-size="11.00">Expert 11</text>
<text text-anchor="middle" x="83" y="-1522.82" font-family="Arial" font-size="11.00">TP Rank 0</text>
</g>
<!-- gpu_23 -->
<g id="node24" class="node">
<title>gpu_23</title>
<polygon fill="none" stroke="black" points="117,-1497.62 49,-1497.62 49,-1453.62 117,-1453.62 117,-1497.62"/>
<text text-anchor="middle" x="83" y="-1484.82" font-family="Arial" font-size="11.00">GPU 23</text>
<text text-anchor="middle" x="83" y="-1472.82" font-family="Arial" font-size="11.00">Expert 11</text>
<text text-anchor="middle" x="83" y="-1460.82" font-family="Arial" font-size="11.00">TP Rank 1</text>
</g>
<!-- gpu_24 -->
<g id="node25" class="node">
<title>gpu_24</title>
<polygon fill="none" stroke="black" points="117,-1435.62 49,-1435.62 49,-1391.62 117,-1391.62 117,-1435.62"/>
<text text-anchor="middle" x="83" y="-1422.82" font-family="Arial" font-size="11.00">GPU 24</text>
<text text-anchor="middle" x="83" y="-1410.82" font-family="Arial" font-size="11.00">Expert 12</text>
<text text-anchor="middle" x="83" y="-1398.82" font-family="Arial" font-size="11.00">TP Rank 0</text>
</g>
<!-- gpu_25 -->
<g id="node26" class="node">
<title>gpu_25</title>
<polygon fill="none" stroke="black" points="117,-1373.62 49,-1373.62 49,-1329.62 117,-1329.62 117,-1373.62"/>
<text text-anchor="middle" x="83" y="-1360.82" font-family="Arial" font-size="11.00">GPU 25</text>
<text text-anchor="middle" x="83" y="-1348.82" font-family="Arial" font-size="11.00">Expert 12</text>
<text text-anchor="middle" x="83" y="-1336.82" font-family="Arial" font-size="11.00">TP Rank 1</text>
</g>
<!-- gpu_26 -->
<g id="node27" class="node">
<title>gpu_26</title>
<polygon fill="none" stroke="black" points="117,-1311.62 49,-1311.62 49,-1267.62 117,-1267.62 117,-1311.62"/>
<text text-anchor="middle" x="83" y="-1298.82" font-family="Arial" font-size="11.00">GPU 26</text>
<text text-anchor="middle" x="83" y="-1286.82" font-family="Arial" font-size="11.00">Expert 13</text>
<text text-anchor="middle" x="83" y="-1274.82" font-family="Arial" font-size="11.00">TP Rank 0</text>
</g>
<!-- gpu_27 -->
<g id="node28" class="node">
<title>gpu_27</title>
<polygon fill="none" stroke="black" points="117,-1249.62 49,-1249.62 49,-1205.62 117,-1205.62 117,-1249.62"/>
<text text-anchor="middle" x="83" y="-1236.82" font-family="Arial" font-size="11.00">GPU 27</text>
<text text-anchor="middle" x="83" y="-1224.82" font-family="Arial" font-size="11.00">Expert 13</text>
<text text-anchor="middle" x="83" y="-1212.82" font-family="Arial" font-size="11.00">TP Rank 1</text>
</g>
<!-- gpu_28 -->
<g id="node29" class="node">
<title>gpu_28</title>
<polygon fill="none" stroke="black" points="117,-1187.62 49,-1187.62 49,-1143.62 117,-1143.62 117,-1187.62"/>
<text text-anchor="middle" x="83" y="-1174.82" font-family="Arial" font-size="11.00">GPU 28</text>
<text text-anchor="middle" x="83" y="-1162.82" font-family="Arial" font-size="11.00">Expert 14</text>
<text text-anchor="middle" x="83" y="-1150.82" font-family="Arial" font-size="11.00">TP Rank 0</text>
</g>
<!-- gpu_29 -->
<g id="node30" class="node">
<title>gpu_29</title>
<polygon fill="none" stroke="black" points="117,-1125.62 49,-1125.62 49,-1081.62 117,-1081.62 117,-1125.62"/>
<text text-anchor="middle" x="83" y="-1112.82" font-family="Arial" font-size="11.00">GPU 29</text>
<text text-anchor="middle" x="83" y="-1100.82" font-family="Arial" font-size="11.00">Expert 14</text>
<text text-anchor="middle" x="83" y="-1088.82" font-family="Arial" font-size="11.00">TP Rank 1</text>
</g>
<!-- gpu_30 -->
<g id="node31" class="node">
<title>gpu_30</title>
<polygon fill="none" stroke="black" points="117,-1063.62 49,-1063.62 49,-1019.62 117,-1019.62 117,-1063.62"/>
<text text-anchor="middle" x="83" y="-1050.82" font-family="Arial" font-size="11.00">GPU 30</text>
<text text-anchor="middle" x="83" y="-1038.82" font-family="Arial" font-size="11.00">Expert 15</text>
<text text-anchor="middle" x="83" y="-1026.82" font-family="Arial" font-size="11.00">TP Rank 0</text>
</g>
<!-- gpu_31 -->
<g id="node32" class="node">
<title>gpu_31</title>
<polygon fill="none" stroke="black" points="117,-1001.62 49,-1001.62 49,-957.62 117,-957.62 117,-1001.62"/>
<text text-anchor="middle" x="83" y="-988.82" font-family="Arial" font-size="11.00">GPU 31</text>
<text text-anchor="middle" x="83" y="-976.82" font-family="Arial" font-size="11.00">Expert 15</text>
<text text-anchor="middle" x="83" y="-964.82" font-family="Arial" font-size="11.00">TP Rank 1</text>
</g>
<!-- all2all&#45;&gt;gpu_0 -->
<g id="edge18" class="edge">
<title>all2all&#45;&gt;gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M318.68,-201.99C307.21,-231.78 279.25,-295.32 237,-333.62 215.2,-353.39 193.07,-336.97 177,-361.62 148.65,-405.1 196.16,-785.69 167,-828.62 157.77,-842.21 142.15,-850.54 126.94,-855.63"/>
<polygon fill="blue" stroke="blue" points="125.67,-852.36 117.07,-858.54 127.65,-859.07 125.67,-852.36"/>
</g>
<!-- all2all&#45;&gt;gpu_2 -->
<g id="edge20" class="edge">
<title>all2all&#45;&gt;gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M316.71,-201.6C303.41,-227.17 274.27,-277.59 237,-308.62 214.39,-327.45 193.1,-311.99 177,-336.62 151.1,-376.26 193.64,-723.48 167,-762.62 157.76,-776.2 142.14,-784.52 126.92,-789.62"/>
<polygon fill="blue" stroke="blue" points="125.66,-786.35 117.05,-792.53 127.63,-793.06 125.66,-786.35"/>
</g>
<!-- all2all&#45;&gt;gpu_4 -->
<g id="edge22" class="edge">
<title>all2all&#45;&gt;gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M302.84,-198.05C285.24,-207.98 259.74,-222.1 237,-233.62 210.75,-246.92 193.09,-236.98 177,-261.62 150.56,-302.1 194.19,-656.65 167,-696.62 157.76,-710.2 142.14,-718.53 126.93,-723.63"/>
<polygon fill="blue" stroke="blue" points="125.66,-720.35 117.06,-726.54 127.64,-727.07 125.66,-720.35"/>
</g>
<!-- all2all&#45;&gt;gpu_6 -->
<g id="edge24" class="edge">
<title>all2all&#45;&gt;gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M291.36,-194.94C250.02,-206.85 183.98,-227.08 177,-236.62 151.07,-272.05 191.92,-595.48 167,-631.62 157.72,-645.08 142.09,-653.22 126.88,-658.14"/>
<polygon fill="blue" stroke="blue" points="125.68,-654.84 117.01,-660.93 127.59,-661.57 125.68,-654.84"/>
</g>
<!-- all2all&#45;&gt;gpu_8 -->
<g id="edge26" class="edge">
<title>all2all&#45;&gt;gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M303.98,-172.93C272.14,-155.11 211.1,-128.36 177,-161.62 160.89,-177.34 179.77,-548.09 167,-566.62 157.72,-580.09 142.09,-588.22 126.88,-593.14"/>
<polygon fill="blue" stroke="blue" points="125.69,-589.84 117.02,-595.93 127.59,-596.58 125.69,-589.84"/>
</g>
<!-- all2all&#45;&gt;gpu_10 -->
<g id="edge28" class="edge">
<title>all2all&#45;&gt;gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M308.95,-171.58C279.26,-146.59 214.34,-100.28 177,-136.62 162.42,-150.81 178.65,-485.95 167,-502.62 157.75,-515.86 142.28,-523.79 127.19,-528.54"/>
<polygon fill="blue" stroke="blue" points="126.11,-525.21 117.39,-531.23 127.96,-531.96 126.11,-525.21"/>
</g>
<!-- all2all&#45;&gt;gpu_12 -->
<g id="edge30" class="edge">
<title>all2all&#45;&gt;gpu_12</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M317.9,-169.18C306.11,-142.66 278.83,-91.34 237,-70.62 213.1,-58.78 196.11,-52.02 177,-70.62 162.26,-84.96 178.95,-423.89 167,-440.62 157.69,-453.66 142.21,-461.22 127.12,-465.6"/>
<polygon fill="blue" stroke="blue" points="126.19,-462.23 117.34,-468.05 127.89,-469.02 126.19,-462.23"/>
</g>
<!-- all2all&#45;&gt;gpu_14 -->
<g id="edge32" class="edge">
<title>all2all&#45;&gt;gpu_14</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M320.55,-168.72C311.77,-136.19 287.53,-65.53 237,-36.62 213.85,-23.38 198.01,-20.2 177,-36.62 122.84,-78.94 95.63,-294.62 87.06,-377.3"/>
<polygon fill="blue" stroke="blue" points="83.57,-377.08 86.04,-387.38 90.53,-377.79 83.57,-377.08"/>
</g>
</g>
</svg>
