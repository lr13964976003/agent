<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="596pt" height="1080pt"
 viewBox="0.00 0.00 596.50 1080.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.71 0.71) rotate(0) translate(4 1510.5)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1510.5 832.48,-1510.5 832.48,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="none" stroke="black" cx="463.55" cy="-1482.46" rx="139.1" ry="24.08"/>
<text text-anchor="middle" x="463.55" y="-1485.86" font-family="Arial" font-size="12.00">Input Tokens</text>
<text text-anchor="middle" x="463.55" y="-1472.86" font-family="Arial" font-size="12.00">[batch_size=128, seq_len=10000]</text>
</g>
<!-- embed -->
<g id="node2" class="node">
<title>embed</title>
<polygon fill="none" stroke="black" points="614.55,-1421.42 312.55,-1421.42 312.55,-1385.42 614.55,-1385.42 614.55,-1421.42"/>
<text text-anchor="middle" x="463.55" y="-1406.82" font-family="Arial" font-size="12.00">Embedding</text>
<text text-anchor="middle" x="463.55" y="-1393.82" font-family="Arial" font-size="12.00">[batch_size=128, seq_len=10000, hidden_size=4096]</text>
</g>
<!-- input&#45;&gt;embed -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embed</title>
<path fill="none" stroke="black" d="M463.55,-1458.34C463.55,-1450.02 463.55,-1440.56 463.55,-1431.9"/>
<polygon fill="black" stroke="black" points="467.05,-1431.88 463.55,-1421.88 460.05,-1431.88 467.05,-1431.88"/>
</g>
<!-- ln_0 -->
<g id="node3" class="node">
<title>ln_0</title>
<polygon fill="none" stroke="black" points="508.05,-1348.42 419.05,-1348.42 419.05,-1312.42 508.05,-1312.42 508.05,-1348.42"/>
<text text-anchor="middle" x="463.55" y="-1327.32" font-family="Arial" font-size="12.00">LayerNorm_0</text>
</g>
<!-- embed&#45;&gt;ln_0 -->
<g id="edge6" class="edge">
<title>embed&#45;&gt;ln_0</title>
<path fill="none" stroke="black" d="M463.55,-1385.23C463.55,-1377.21 463.55,-1367.46 463.55,-1358.49"/>
<polygon fill="black" stroke="black" points="467.05,-1358.45 463.55,-1348.45 460.05,-1358.45 467.05,-1358.45"/>
</g>
<!-- mha_0 -->
<g id="node4" class="node">
<title>mha_0</title>
<polygon fill="none" stroke="black" points="515.55,-1275.42 411.55,-1275.42 411.55,-1239.42 515.55,-1239.42 515.55,-1275.42"/>
<text text-anchor="middle" x="463.55" y="-1260.82" font-family="Arial" font-size="12.00">MHA_0</text>
<text text-anchor="middle" x="463.55" y="-1247.82" font-family="Arial" font-size="12.00">(Tensor Parallel)</text>
</g>
<!-- ln_0&#45;&gt;mha_0 -->
<g id="edge7" class="edge">
<title>ln_0&#45;&gt;mha_0</title>
<path fill="none" stroke="black" d="M463.55,-1312.23C463.55,-1304.21 463.55,-1294.46 463.55,-1285.49"/>
<polygon fill="black" stroke="black" points="467.05,-1285.45 463.55,-1275.45 460.05,-1285.45 467.05,-1285.45"/>
</g>
<!-- ar_mha_0 -->
<g id="node5" class="node">
<title>ar_mha_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="463.55" cy="-1178.37" rx="51.74" ry="24.08"/>
<text text-anchor="middle" x="463.55" y="-1181.77" font-family="Arial" font-size="12.00">AllReduce</text>
<text text-anchor="middle" x="463.55" y="-1168.77" font-family="Arial" font-size="12.00">MHA_0</text>
</g>
<!-- mha_0&#45;&gt;ar_mha_0 -->
<g id="edge8" class="edge">
<title>mha_0&#45;&gt;ar_mha_0</title>
<path fill="none" stroke="black" d="M463.55,-1239.32C463.55,-1231.46 463.55,-1221.86 463.55,-1212.66"/>
<polygon fill="black" stroke="black" points="467.05,-1212.56 463.55,-1202.56 460.05,-1212.56 467.05,-1212.56"/>
</g>
<!-- gate_0 -->
<g id="node6" class="node">
<title>gate_0</title>
<polygon fill="none" stroke="black" points="608.42,-1117.33 474.99,-1117.33 440.67,-1081.33 574.1,-1081.33 608.42,-1117.33"/>
<text text-anchor="middle" x="524.55" y="-1096.23" font-family="Arial" font-size="12.00">Expert Gate_0</text>
</g>
<!-- ar_mha_0&#45;&gt;gate_0 -->
<g id="edge9" class="edge">
<title>ar_mha_0&#45;&gt;gate_0</title>
<path fill="none" stroke="black" d="M480.86,-1155.5C488.27,-1146.14 496.97,-1135.16 504.64,-1125.47"/>
<polygon fill="black" stroke="black" points="507.6,-1127.37 511.07,-1117.36 502.11,-1123.03 507.6,-1127.37"/>
</g>
<!-- expert_0_0 -->
<g id="node7" class="node">
<title>expert_0_0</title>
<polygon fill="none" stroke="black" points="547.05,-1034.33 482.05,-1034.33 482.05,-998.33 547.05,-998.33 547.05,-1034.33"/>
<text text-anchor="middle" x="514.55" y="-1019.73" font-family="Arial" font-size="12.00">Expert_0</text>
<text text-anchor="middle" x="514.55" y="-1006.73" font-family="Arial" font-size="12.00">GPU0&#45;1</text>
</g>
<!-- ar_mha_0&#45;&gt;expert_0_0 -->
<g id="edge10" class="edge">
<title>ar_mha_0&#45;&gt;expert_0_0</title>
<path fill="none" stroke="black" d="M445.91,-1155.32C427.08,-1128.91 402.72,-1084.24 424.55,-1052.33 426.1,-1050.06 449.72,-1040.92 472.37,-1032.55"/>
<polygon fill="black" stroke="black" points="473.77,-1035.76 481.95,-1029.03 471.35,-1029.19 473.77,-1035.76"/>
</g>
<!-- expert_0_1 -->
<g id="node8" class="node">
<title>expert_0_1</title>
<polygon fill="none" stroke="black" points="659.05,-1034.33 594.05,-1034.33 594.05,-998.33 659.05,-998.33 659.05,-1034.33"/>
<text text-anchor="middle" x="626.55" y="-1019.73" font-family="Arial" font-size="12.00">Expert_1</text>
<text text-anchor="middle" x="626.55" y="-1006.73" font-family="Arial" font-size="12.00">GPU2&#45;3</text>
</g>
<!-- ar_mha_0&#45;&gt;expert_0_1 -->
<g id="edge12" class="edge">
<title>ar_mha_0&#45;&gt;expert_0_1</title>
<path fill="none" stroke="black" d="M515.24,-1176.39C589.78,-1171.84 725.34,-1151.17 787.55,-1063.33 824.45,-1011.22 890.28,-1080.72 687.55,-1034.33 681.64,-1032.98 675.45,-1031.43 669.38,-1029.81"/>
<polygon fill="black" stroke="black" points="669.89,-1026.33 659.33,-1027.08 668.06,-1033.08 669.89,-1026.33"/>
</g>
<!-- expert_0_2 -->
<g id="node9" class="node">
<title>expert_0_2</title>
<polygon fill="none" stroke="black" points="761.05,-1034.33 696.05,-1034.33 696.05,-998.33 761.05,-998.33 761.05,-1034.33"/>
<text text-anchor="middle" x="728.55" y="-1019.73" font-family="Arial" font-size="12.00">Expert_2</text>
<text text-anchor="middle" x="728.55" y="-1006.73" font-family="Arial" font-size="12.00">GPU4&#45;5</text>
</g>
<!-- ar_mha_0&#45;&gt;expert_0_2 -->
<g id="edge14" class="edge">
<title>ar_mha_0&#45;&gt;expert_0_2</title>
<path fill="none" stroke="black" d="M513.67,-1172.43C588.55,-1164.22 725.04,-1145.79 764.55,-1117.33 792.26,-1097.37 824.04,-1081.05 805.55,-1052.33 797.68,-1040.11 784.38,-1032.11 771.04,-1026.89"/>
<polygon fill="black" stroke="black" points="771.98,-1023.51 761.38,-1023.56 769.7,-1030.13 771.98,-1023.51"/>
</g>
<!-- expert_0_3 -->
<g id="node10" class="node">
<title>expert_0_3</title>
<polygon fill="none" stroke="black" points="455.05,-1034.33 390.05,-1034.33 390.05,-998.33 455.05,-998.33 455.05,-1034.33"/>
<text text-anchor="middle" x="422.55" y="-1019.73" font-family="Arial" font-size="12.00">Expert_3</text>
<text text-anchor="middle" x="422.55" y="-1006.73" font-family="Arial" font-size="12.00">GPU6&#45;7</text>
</g>
<!-- ar_mha_0&#45;&gt;expert_0_3 -->
<g id="edge16" class="edge">
<title>ar_mha_0&#45;&gt;expert_0_3</title>
<path fill="none" stroke="black" d="M422.53,-1163.46C409.72,-1157.13 396.8,-1148.31 388.55,-1136.33 367.22,-1105.37 362.21,-1086.2 378.55,-1052.33 380.41,-1048.48 382.92,-1044.91 385.81,-1041.66"/>
<polygon fill="black" stroke="black" points="388.34,-1044.08 393.11,-1034.62 383.48,-1039.04 388.34,-1044.08"/>
</g>
<!-- res_0 -->
<g id="node13" class="node">
<title>res_0</title>
<polygon fill="none" stroke="black" points="408.85,-771.25 297.01,-771.25 268.25,-735.25 380.08,-735.25 408.85,-771.25"/>
<text text-anchor="middle" x="338.55" y="-750.15" font-family="Arial" font-size="12.00">Residual_0</text>
</g>
<!-- ar_mha_0&#45;&gt;res_0 -->
<g id="edge20" class="edge">
<title>ar_mha_0&#45;&gt;res_0</title>
<path fill="none" stroke="black" d="M414.86,-1170.27C375.48,-1161.45 326.55,-1142.08 326.55,-1100.33 326.55,-1100.33 326.55,-1100.33 326.55,-831.29 326.55,-814.52 329.36,-795.93 332.26,-781.22"/>
<polygon fill="black" stroke="black" points="335.72,-781.77 334.35,-771.27 328.87,-780.33 335.72,-781.77"/>
</g>
<!-- gate_0&#45;&gt;expert_0_0 -->
<g id="edge2" class="edge">
<title>gate_0&#45;&gt;expert_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M522.43,-1081.16C521.11,-1070.52 519.4,-1056.64 517.9,-1044.54"/>
<polygon fill="black" stroke="black" points="521.36,-1043.98 516.66,-1034.49 514.42,-1044.84 521.36,-1043.98"/>
<text text-anchor="middle" x="559.05" y="-1055.33" font-family="Arial" font-size="10.00">route_to_expert_0</text>
</g>
<!-- gate_0&#45;&gt;expert_0_1 -->
<g id="edge3" class="edge">
<title>gate_0&#45;&gt;expert_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M574.64,-1081.84C584.66,-1076.97 594.55,-1070.87 602.55,-1063.33 608.31,-1057.9 612.95,-1050.76 616.56,-1043.74"/>
<polygon fill="black" stroke="black" points="619.85,-1044.95 620.84,-1034.4 613.49,-1042.03 619.85,-1044.95"/>
<text text-anchor="middle" x="650.05" y="-1055.33" font-family="Arial" font-size="10.00">route_to_expert_1</text>
</g>
<!-- gate_0&#45;&gt;expert_0_2 -->
<g id="edge4" class="edge">
<title>gate_0&#45;&gt;expert_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M587.93,-1095.81C621.48,-1091.97 662.11,-1083.14 693.55,-1063.33 701.48,-1058.33 708.28,-1050.86 713.73,-1043.38"/>
<polygon fill="black" stroke="black" points="716.85,-1045 719.48,-1034.74 711.02,-1041.12 716.85,-1045"/>
<text text-anchor="middle" x="744.05" y="-1055.33" font-family="Arial" font-size="10.00">route_to_expert_2</text>
</g>
<!-- gate_0&#45;&gt;expert_0_3 -->
<g id="edge5" class="edge">
<title>gate_0&#45;&gt;expert_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M459.68,-1081.19C450.67,-1076.56 442.23,-1070.72 435.55,-1063.33 430.76,-1058.04 427.72,-1051.11 425.79,-1044.25"/>
<polygon fill="black" stroke="black" points="429.21,-1043.48 423.7,-1034.43 422.36,-1044.94 429.21,-1043.48"/>
<text text-anchor="middle" x="475.05" y="-1055.33" font-family="Arial" font-size="10.00">route_to_expert_3</text>
</g>
<!-- agg_0 -->
<g id="node11" class="node">
<title>agg_0</title>
<polygon fill="none" stroke="black" points="603.87,-961.33 461.78,-961.33 425.22,-893.33 567.32,-893.33 603.87,-961.33"/>
<text text-anchor="middle" x="514.55" y="-930.73" font-family="Arial" font-size="12.00">Expert</text>
<text text-anchor="middle" x="514.55" y="-917.73" font-family="Arial" font-size="12.00">Aggregate_0</text>
</g>
<!-- expert_0_0&#45;&gt;agg_0 -->
<g id="edge11" class="edge">
<title>expert_0_0&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M514.55,-998.14C514.55,-990.43 514.55,-980.96 514.55,-971.5"/>
<polygon fill="black" stroke="black" points="518.05,-971.34 514.55,-961.34 511.05,-971.34 518.05,-971.34"/>
</g>
<!-- expert_0_1&#45;&gt;agg_0 -->
<g id="edge13" class="edge">
<title>expert_0_1&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M604.42,-998.14C593.12,-989.37 578.88,-978.3 565.08,-967.59"/>
<polygon fill="black" stroke="black" points="567.08,-964.71 557.03,-961.34 562.78,-970.24 567.08,-964.71"/>
</g>
<!-- expert_0_2&#45;&gt;agg_0 -->
<g id="edge15" class="edge">
<title>expert_0_2&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M696.04,-1002.12C671.89,-992.3 637.67,-978.39 605.45,-965.29"/>
<polygon fill="black" stroke="black" points="606.56,-961.96 595.98,-961.44 603.92,-968.45 606.56,-961.96"/>
</g>
<!-- expert_0_3&#45;&gt;agg_0 -->
<g id="edge17" class="edge">
<title>expert_0_3&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M440.72,-998.14C449.74,-989.61 461.05,-978.92 472.08,-968.49"/>
<polygon fill="black" stroke="black" points="474.79,-970.75 479.65,-961.34 469.98,-965.66 474.79,-970.75"/>
</g>
<!-- all2all_0 -->
<g id="node12" class="node">
<title>all2all_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="454.55" cy="-832.29" rx="50.41" ry="24.08"/>
<text text-anchor="middle" x="454.55" y="-835.69" font-family="Arial" font-size="12.00">All2All</text>
<text text-anchor="middle" x="454.55" y="-822.69" font-family="Arial" font-size="12.00">Experts_0</text>
</g>
<!-- agg_0&#45;&gt;all2all_0 -->
<g id="edge18" class="edge">
<title>agg_0&#45;&gt;all2all_0</title>
<path fill="none" stroke="black" d="M493.22,-893.27C487.1,-883.77 480.44,-873.45 474.41,-864.09"/>
<polygon fill="black" stroke="black" points="477.21,-861.98 468.85,-855.47 471.33,-865.77 477.21,-861.98"/>
</g>
<!-- all2all_0&#45;&gt;res_0 -->
<g id="edge19" class="edge">
<title>all2all_0&#45;&gt;res_0</title>
<path fill="none" stroke="black" d="M426.17,-812.44C410.06,-801.75 389.79,-788.28 372.8,-777"/>
<polygon fill="black" stroke="black" points="374.52,-773.94 364.26,-771.32 370.65,-779.77 374.52,-773.94"/>
</g>
<!-- ln_1 -->
<g id="node14" class="node">
<title>ln_1</title>
<polygon fill="none" stroke="black" points="383.05,-698.25 294.05,-698.25 294.05,-662.25 383.05,-662.25 383.05,-698.25"/>
<text text-anchor="middle" x="338.55" y="-677.15" font-family="Arial" font-size="12.00">LayerNorm_1</text>
</g>
<!-- res_0&#45;&gt;ln_1 -->
<g id="edge25" class="edge">
<title>res_0&#45;&gt;ln_1</title>
<path fill="none" stroke="black" d="M338.55,-735.06C338.55,-727.04 338.55,-717.3 338.55,-708.32"/>
<polygon fill="black" stroke="black" points="342.05,-708.28 338.55,-698.28 335.05,-708.28 342.05,-708.28"/>
</g>
<!-- mha_1 -->
<g id="node15" class="node">
<title>mha_1</title>
<polygon fill="none" stroke="black" points="390.55,-625.25 286.55,-625.25 286.55,-589.25 390.55,-589.25 390.55,-625.25"/>
<text text-anchor="middle" x="338.55" y="-610.65" font-family="Arial" font-size="12.00">MHA_1</text>
<text text-anchor="middle" x="338.55" y="-597.65" font-family="Arial" font-size="12.00">(Tensor Parallel)</text>
</g>
<!-- ln_1&#45;&gt;mha_1 -->
<g id="edge26" class="edge">
<title>ln_1&#45;&gt;mha_1</title>
<path fill="none" stroke="black" d="M338.55,-662.06C338.55,-654.04 338.55,-644.3 338.55,-635.32"/>
<polygon fill="black" stroke="black" points="342.05,-635.28 338.55,-625.28 335.05,-635.28 342.05,-635.28"/>
</g>
<!-- ar_mha_1 -->
<g id="node16" class="node">
<title>ar_mha_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="338.55" cy="-528.21" rx="51.74" ry="24.08"/>
<text text-anchor="middle" x="338.55" y="-531.61" font-family="Arial" font-size="12.00">AllReduce</text>
<text text-anchor="middle" x="338.55" y="-518.61" font-family="Arial" font-size="12.00">MHA_1</text>
</g>
<!-- mha_1&#45;&gt;ar_mha_1 -->
<g id="edge27" class="edge">
<title>mha_1&#45;&gt;ar_mha_1</title>
<path fill="none" stroke="black" d="M338.55,-589.15C338.55,-581.29 338.55,-571.69 338.55,-562.49"/>
<polygon fill="black" stroke="black" points="342.05,-562.39 338.55,-552.39 335.05,-562.4 342.05,-562.39"/>
</g>
<!-- gate_1 -->
<g id="node17" class="node">
<title>gate_1</title>
<polygon fill="none" stroke="black" points="483.42,-467.17 349.99,-467.17 315.67,-431.17 449.1,-431.17 483.42,-467.17"/>
<text text-anchor="middle" x="399.55" y="-446.07" font-family="Arial" font-size="12.00">Expert Gate_1</text>
</g>
<!-- ar_mha_1&#45;&gt;gate_1 -->
<g id="edge28" class="edge">
<title>ar_mha_1&#45;&gt;gate_1</title>
<path fill="none" stroke="black" d="M355.86,-505.34C363.27,-495.98 371.97,-485 379.64,-475.3"/>
<polygon fill="black" stroke="black" points="382.6,-477.21 386.07,-467.19 377.11,-472.86 382.6,-477.21"/>
</g>
<!-- expert_1_0 -->
<g id="node18" class="node">
<title>expert_1_0</title>
<polygon fill="none" stroke="black" points="425.05,-384.17 360.05,-384.17 360.05,-348.17 425.05,-348.17 425.05,-384.17"/>
<text text-anchor="middle" x="392.55" y="-369.57" font-family="Arial" font-size="12.00">Expert_4</text>
<text text-anchor="middle" x="392.55" y="-356.57" font-family="Arial" font-size="12.00">GPU8&#45;9</text>
</g>
<!-- ar_mha_1&#45;&gt;expert_1_0 -->
<g id="edge29" class="edge">
<title>ar_mha_1&#45;&gt;expert_1_0</title>
<path fill="none" stroke="black" d="M321.75,-505.09C303.85,-478.6 280.86,-433.86 302.55,-402.17 304.1,-399.9 327.72,-390.75 350.37,-382.38"/>
<polygon fill="black" stroke="black" points="351.77,-385.6 359.95,-378.86 349.35,-379.03 351.77,-385.6"/>
</g>
<!-- expert_1_1 -->
<g id="node19" class="node">
<title>expert_1_1</title>
<polygon fill="none" stroke="black" points="538.55,-384.17 464.55,-384.17 464.55,-348.17 538.55,-348.17 538.55,-384.17"/>
<text text-anchor="middle" x="501.55" y="-369.57" font-family="Arial" font-size="12.00">Expert_5</text>
<text text-anchor="middle" x="501.55" y="-356.57" font-family="Arial" font-size="12.00">GPU10&#45;11</text>
</g>
<!-- ar_mha_1&#45;&gt;expert_1_1 -->
<g id="edge31" class="edge">
<title>ar_mha_1&#45;&gt;expert_1_1</title>
<path fill="none" stroke="black" d="M390.23,-526.35C465.16,-521.98 601.83,-501.55 664.55,-413.17 683.98,-385.79 675.45,-411.86 557.55,-384.17 554.58,-383.47 551.53,-382.7 548.47,-381.89"/>
<polygon fill="black" stroke="black" points="549.29,-378.48 538.72,-379.18 547.41,-385.23 549.29,-378.48"/>
</g>
<!-- expert_1_2 -->
<g id="node20" class="node">
<title>expert_1_2</title>
<polygon fill="none" stroke="black" points="640.55,-384.17 566.55,-384.17 566.55,-348.17 640.55,-348.17 640.55,-384.17"/>
<text text-anchor="middle" x="603.55" y="-369.57" font-family="Arial" font-size="12.00">Expert_6</text>
<text text-anchor="middle" x="603.55" y="-356.57" font-family="Arial" font-size="12.00">GPU12&#45;13</text>
</g>
<!-- ar_mha_1&#45;&gt;expert_1_2 -->
<g id="edge33" class="edge">
<title>ar_mha_1&#45;&gt;expert_1_2</title>
<path fill="none" stroke="black" d="M388.72,-522.37C464.06,-514.28 601.83,-495.98 641.55,-467.17 669.01,-447.25 699.98,-430.64 681.55,-402.17 674.28,-390.95 662.48,-383.29 650.23,-378.08"/>
<polygon fill="black" stroke="black" points="651.43,-374.79 640.84,-374.55 648.97,-381.34 651.43,-374.79"/>
</g>
<!-- expert_1_3 -->
<g id="node21" class="node">
<title>expert_1_3</title>
<polygon fill="none" stroke="black" points="334.55,-384.17 260.55,-384.17 260.55,-348.17 334.55,-348.17 334.55,-384.17"/>
<text text-anchor="middle" x="297.55" y="-369.57" font-family="Arial" font-size="12.00">Expert_7</text>
<text text-anchor="middle" x="297.55" y="-356.57" font-family="Arial" font-size="12.00">GPU14&#45;15</text>
</g>
<!-- ar_mha_1&#45;&gt;expert_1_3 -->
<g id="edge35" class="edge">
<title>ar_mha_1&#45;&gt;expert_1_3</title>
<path fill="none" stroke="black" d="M297.53,-513.3C284.72,-506.97 271.8,-498.15 263.55,-486.17 242.22,-455.2 237.21,-436.03 253.55,-402.17 255.41,-398.31 257.92,-394.75 260.81,-391.49"/>
<polygon fill="black" stroke="black" points="263.34,-393.91 268.11,-384.45 258.48,-388.88 263.34,-393.91"/>
</g>
<!-- res_1 -->
<g id="node24" class="node">
<title>res_1</title>
<polygon fill="none" stroke="black" points="283.85,-121.08 172.01,-121.08 143.25,-85.08 255.08,-85.08 283.85,-121.08"/>
<text text-anchor="middle" x="213.55" y="-99.98" font-family="Arial" font-size="12.00">Residual_1</text>
</g>
<!-- ar_mha_1&#45;&gt;res_1 -->
<g id="edge39" class="edge">
<title>ar_mha_1&#45;&gt;res_1</title>
<path fill="none" stroke="black" d="M289.86,-520.1C250.48,-511.28 201.55,-491.92 201.55,-450.17 201.55,-450.17 201.55,-450.17 201.55,-181.12 201.55,-164.35 204.36,-145.76 207.26,-131.05"/>
<polygon fill="black" stroke="black" points="210.72,-131.61 209.35,-121.1 203.87,-130.17 210.72,-131.61"/>
</g>
<!-- gate_1&#45;&gt;expert_1_0 -->
<g id="edge21" class="edge">
<title>gate_1&#45;&gt;expert_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M398.06,-430.99C397.14,-420.36 395.94,-406.47 394.9,-394.37"/>
<polygon fill="black" stroke="black" points="398.38,-393.98 394.03,-384.32 391.4,-394.58 398.38,-393.98"/>
<text text-anchor="middle" x="436.05" y="-405.17" font-family="Arial" font-size="10.00">route_to_expert_4</text>
</g>
<!-- gate_1&#45;&gt;expert_1_1 -->
<g id="edge22" class="edge">
<title>gate_1&#45;&gt;expert_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M450.71,-432.27C461.12,-427.35 471.37,-421.07 479.55,-413.17 485.15,-407.75 489.5,-400.62 492.79,-393.6"/>
<polygon fill="black" stroke="black" points="496.07,-394.84 496.66,-384.26 489.6,-392.16 496.07,-394.84"/>
<text text-anchor="middle" x="527.05" y="-405.17" font-family="Arial" font-size="10.00">route_to_expert_5</text>
</g>
<!-- gate_1&#45;&gt;expert_1_2 -->
<g id="edge23" class="edge">
<title>gate_1&#45;&gt;expert_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M463.49,-446.19C497.58,-442.53 538.89,-433.69 570.55,-413.17 578.25,-408.17 584.73,-400.69 589.85,-393.21"/>
<polygon fill="black" stroke="black" points="592.91,-394.92 595.22,-384.58 586.97,-391.22 592.91,-394.92"/>
<text text-anchor="middle" x="621.05" y="-405.17" font-family="Arial" font-size="10.00">route_to_expert_6</text>
</g>
<!-- gate_1&#45;&gt;expert_1_3 -->
<g id="edge24" class="edge">
<title>gate_1&#45;&gt;expert_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M338.53,-431.04C329.3,-426.39 320.54,-420.53 313.55,-413.17 308.54,-407.89 305.09,-400.97 302.72,-394.1"/>
<polygon fill="black" stroke="black" points="306.03,-392.96 299.96,-384.28 299.29,-394.85 306.03,-392.96"/>
<text text-anchor="middle" x="353.05" y="-405.17" font-family="Arial" font-size="10.00">route_to_expert_7</text>
</g>
<!-- agg_1 -->
<g id="node22" class="node">
<title>agg_1</title>
<polygon fill="none" stroke="black" points="481.87,-311.17 339.78,-311.17 303.22,-243.17 445.32,-243.17 481.87,-311.17"/>
<text text-anchor="middle" x="392.55" y="-280.57" font-family="Arial" font-size="12.00">Expert</text>
<text text-anchor="middle" x="392.55" y="-267.57" font-family="Arial" font-size="12.00">Aggregate_1</text>
</g>
<!-- expert_1_0&#45;&gt;agg_1 -->
<g id="edge30" class="edge">
<title>expert_1_0&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M392.55,-347.98C392.55,-340.27 392.55,-330.79 392.55,-321.34"/>
<polygon fill="black" stroke="black" points="396.05,-321.17 392.55,-311.17 389.05,-321.17 396.05,-321.17"/>
</g>
<!-- expert_1_1&#45;&gt;agg_1 -->
<g id="edge32" class="edge">
<title>expert_1_1&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M480.01,-347.98C469.02,-339.2 455.15,-328.14 441.73,-317.42"/>
<polygon fill="black" stroke="black" points="443.89,-314.67 433.9,-311.17 439.53,-320.14 443.89,-314.67"/>
</g>
<!-- expert_1_2&#45;&gt;agg_1 -->
<g id="edge34" class="edge">
<title>expert_1_2&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M566.31,-349.81C542.93,-340.17 511.71,-327.3 482.19,-315.13"/>
<polygon fill="black" stroke="black" points="483.26,-311.78 472.68,-311.21 480.59,-318.25 483.26,-311.78"/>
</g>
<!-- expert_1_3&#45;&gt;agg_1 -->
<g id="edge36" class="edge">
<title>expert_1_3&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M316.32,-347.98C325.72,-339.37 337.53,-328.55 349.03,-318.02"/>
<polygon fill="black" stroke="black" points="351.5,-320.5 356.51,-311.17 346.77,-315.34 351.5,-320.5"/>
</g>
<!-- all2all_1 -->
<g id="node23" class="node">
<title>all2all_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="332.55" cy="-182.12" rx="50.41" ry="24.08"/>
<text text-anchor="middle" x="332.55" y="-185.52" font-family="Arial" font-size="12.00">All2All</text>
<text text-anchor="middle" x="332.55" y="-172.52" font-family="Arial" font-size="12.00">Experts_1</text>
</g>
<!-- agg_1&#45;&gt;all2all_1 -->
<g id="edge37" class="edge">
<title>agg_1&#45;&gt;all2all_1</title>
<path fill="none" stroke="black" d="M371.22,-243.1C365.1,-233.6 358.44,-223.28 352.41,-213.93"/>
<polygon fill="black" stroke="black" points="355.21,-211.81 346.85,-205.31 349.33,-215.61 355.21,-211.81"/>
</g>
<!-- all2all_1&#45;&gt;res_1 -->
<g id="edge38" class="edge">
<title>all2all_1&#45;&gt;res_1</title>
<path fill="none" stroke="black" d="M303.44,-162.28C286.91,-151.58 266.11,-138.12 248.69,-126.83"/>
<polygon fill="black" stroke="black" points="250.22,-123.65 239.92,-121.16 246.41,-129.53 250.22,-123.65"/>
</g>
<!-- output -->
<g id="node25" class="node">
<title>output</title>
<ellipse fill="none" stroke="black" cx="213.55" cy="-24.04" rx="213.59" ry="24.08"/>
<text text-anchor="middle" x="213.55" y="-27.44" font-family="Arial" font-size="12.00">Output</text>
<text text-anchor="middle" x="213.55" y="-14.44" font-family="Arial" font-size="12.00">[batch_size=128, seq_len=10000, hidden_size=4096]</text>
</g>
<!-- res_1&#45;&gt;output -->
<g id="edge40" class="edge">
<title>res_1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M213.55,-84.99C213.55,-77.13 213.55,-67.52 213.55,-58.33"/>
<polygon fill="black" stroke="black" points="217.05,-58.23 213.55,-48.23 210.05,-58.23 217.05,-58.23"/>
</g>
</g>
</svg>
