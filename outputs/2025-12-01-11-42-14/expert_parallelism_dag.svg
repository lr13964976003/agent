<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Cross_Node_Expert_Parallelism Pages: 1 -->
<svg width="5190pt" height="729pt"
 viewBox="0.00 0.00 5190.00 729.48" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 725.48)">
<title>Cross_Node_Expert_Parallelism</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-725.48 5186,-725.48 5186,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="2544.5" cy="-694.61" rx="265.74" ry="26.74"/>
<text text-anchor="middle" x="2544.5" y="-698.41" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="2544.5" y="-683.41" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- gating -->
<g id="node2" class="node">
<title>gating</title>
<polygon fill="yellow" stroke="black" points="3334.51,-630.74 2077.78,-630.74 1754.49,-524.74 3011.22,-524.74 3334.51,-630.74"/>
<text text-anchor="middle" x="2544.5" y="-589.04" font-family="Times,serif" font-size="14.00">Gating Mechanism</text>
<text text-anchor="middle" x="2544.5" y="-574.04" font-family="Times,serif" font-size="14.00">Select top&#45;K experts per token</text>
<text text-anchor="middle" x="2544.5" y="-559.04" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, num_experts=16]</text>
</g>
<!-- input&#45;&gt;gating -->
<g id="edge1" class="edge">
<title>input&#45;&gt;gating</title>
<path fill="none" stroke="black" d="M2544.5,-667.54C2544.5,-659.57 2544.5,-650.44 2544.5,-641.13"/>
<polygon fill="black" stroke="black" points="2548,-641 2544.5,-631 2541,-641 2548,-641"/>
</g>
<!-- token_split -->
<g id="node3" class="node">
<title>token_split</title>
<polygon fill="yellow" stroke="black" points="3217.21,-473.74 2147.08,-473.74 1871.79,-367.74 2941.92,-367.74 3217.21,-473.74"/>
<text text-anchor="middle" x="2544.5" y="-432.04" font-family="Times,serif" font-size="14.00">Token Split by Expert</text>
<text text-anchor="middle" x="2544.5" y="-417.04" font-family="Times,serif" font-size="14.00">Split tokens across 16 experts</text>
<text text-anchor="middle" x="2544.5" y="-402.04" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→16×[variable_batch, d_model=4096]</text>
</g>
<!-- gating&#45;&gt;token_split -->
<g id="edge2" class="edge">
<title>gating&#45;&gt;token_split</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2544.5,-524.7C2544.5,-511.66 2544.5,-497.54 2544.5,-484.07"/>
<polygon fill="black" stroke="black" points="2548,-483.91 2544.5,-473.91 2541,-483.91 2548,-483.91"/>
<text text-anchor="middle" x="2603.5" y="-495.54" font-family="Times,serif" font-size="14.00">expert_selection</text>
</g>
<!-- expert_0_gpu_0 -->
<g id="node4" class="node">
<title>expert_0_gpu_0</title>
<polygon fill="lightgreen" stroke="black" points="307,-316.74 0,-316.74 0,-233.74 307,-233.74 307,-316.74"/>
<text text-anchor="middle" x="153.5" y="-301.54" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="153.5" y="-286.54" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="153.5" y="-271.54" font-family="Times,serif" font-size="14.00">MLP: 4096→16384→4096</text>
<text text-anchor="middle" x="153.5" y="-256.54" font-family="Times,serif" font-size="14.00">Input: [variable_batch, d_model=4096]</text>
<text text-anchor="middle" x="153.5" y="-241.54" font-family="Times,serif" font-size="14.00">Output: [variable_batch, d_model=4096]</text>
</g>
<!-- token_split&#45;&gt;expert_0_gpu_0 -->
<g id="edge3" class="edge">
<title>token_split&#45;&gt;expert_0_gpu_0</title>
<path fill="none" stroke="black" d="M1976.41,-408.06C1599.04,-398.02 1092.77,-380.19 646.5,-349.74 502.32,-339.9 462.91,-341.97 317.49,-317.03"/>
<polygon fill="black" stroke="black" points="317.75,-313.52 307.3,-315.26 316.56,-320.42 317.75,-313.52"/>
<text text-anchor="middle" x="705" y="-338.54" font-family="Times,serif" font-size="14.00">expert_0_tokens</text>
</g>
<!-- expert_1_gpu_1 -->
<g id="node5" class="node">
<title>expert_1_gpu_1</title>
<polygon fill="lightgreen" stroke="black" points="632,-316.74 325,-316.74 325,-233.74 632,-233.74 632,-316.74"/>
<text text-anchor="middle" x="478.5" y="-301.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="478.5" y="-286.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="478.5" y="-271.54" font-family="Times,serif" font-size="14.00">MLP: 4096→16384→4096</text>
<text text-anchor="middle" x="478.5" y="-256.54" font-family="Times,serif" font-size="14.00">Input: [variable_batch, d_model=4096]</text>
<text text-anchor="middle" x="478.5" y="-241.54" font-family="Times,serif" font-size="14.00">Output: [variable_batch, d_model=4096]</text>
</g>
<!-- token_split&#45;&gt;expert_1_gpu_1 -->
<g id="edge4" class="edge">
<title>token_split&#45;&gt;expert_1_gpu_1</title>
<path fill="none" stroke="black" d="M1958.42,-401.18C1662.84,-389.9 1298.91,-373.1 973.5,-349.74 828.49,-339.33 788.8,-342.05 642.55,-317.04"/>
<polygon fill="black" stroke="black" points="642.75,-313.52 632.3,-315.27 641.56,-320.42 642.75,-313.52"/>
<text text-anchor="middle" x="1032" y="-338.54" font-family="Times,serif" font-size="14.00">expert_1_tokens</text>
</g>
<!-- expert_2_gpu_2 -->
<g id="node6" class="node">
<title>expert_2_gpu_2</title>
<polygon fill="lightgreen" stroke="black" points="957,-316.74 650,-316.74 650,-233.74 957,-233.74 957,-316.74"/>
<text text-anchor="middle" x="803.5" y="-301.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="803.5" y="-286.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="803.5" y="-271.54" font-family="Times,serif" font-size="14.00">MLP: 4096→16384→4096</text>
<text text-anchor="middle" x="803.5" y="-256.54" font-family="Times,serif" font-size="14.00">Input: [variable_batch, d_model=4096]</text>
<text text-anchor="middle" x="803.5" y="-241.54" font-family="Times,serif" font-size="14.00">Output: [variable_batch, d_model=4096]</text>
</g>
<!-- token_split&#45;&gt;expert_2_gpu_2 -->
<g id="edge5" class="edge">
<title>token_split&#45;&gt;expert_2_gpu_2</title>
<path fill="none" stroke="black" d="M1929.22,-389.96C1729.8,-378.98 1507.66,-365.36 1304.5,-349.74 1156.81,-338.39 1116.39,-342.32 967.28,-316.98"/>
<polygon fill="black" stroke="black" points="967.75,-313.51 957.3,-315.27 966.56,-320.41 967.75,-313.51"/>
<text text-anchor="middle" x="1363" y="-338.54" font-family="Times,serif" font-size="14.00">expert_2_tokens</text>
</g>
<!-- expert_3_gpu_3 -->
<g id="node7" class="node">
<title>expert_3_gpu_3</title>
<polygon fill="lightgreen" stroke="black" points="1282,-316.74 975,-316.74 975,-233.74 1282,-233.74 1282,-316.74"/>
<text text-anchor="middle" x="1128.5" y="-301.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1128.5" y="-286.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1128.5" y="-271.54" font-family="Times,serif" font-size="14.00">MLP: 4096→16384→4096</text>
<text text-anchor="middle" x="1128.5" y="-256.54" font-family="Times,serif" font-size="14.00">Input: [variable_batch, d_model=4096]</text>
<text text-anchor="middle" x="1128.5" y="-241.54" font-family="Times,serif" font-size="14.00">Output: [variable_batch, d_model=4096]</text>
</g>
<!-- token_split&#45;&gt;expert_3_gpu_3 -->
<g id="edge6" class="edge">
<title>token_split&#45;&gt;expert_3_gpu_3</title>
<path fill="none" stroke="black" d="M1934.16,-391.83C1731.87,-376.78 1505.89,-353.71 1292.45,-317.02"/>
<polygon fill="black" stroke="black" points="1292.75,-313.52 1282.3,-315.26 1291.56,-320.42 1292.75,-313.52"/>
<text text-anchor="middle" x="1553" y="-338.54" font-family="Times,serif" font-size="14.00">expert_3_tokens</text>
</g>
<!-- expert_4_gpu_4 -->
<g id="node8" class="node">
<title>expert_4_gpu_4</title>
<polygon fill="lightgreen" stroke="black" points="1607,-316.74 1300,-316.74 1300,-233.74 1607,-233.74 1607,-316.74"/>
<text text-anchor="middle" x="1453.5" y="-301.54" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1453.5" y="-286.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="1453.5" y="-271.54" font-family="Times,serif" font-size="14.00">MLP: 4096→16384→4096</text>
<text text-anchor="middle" x="1453.5" y="-256.54" font-family="Times,serif" font-size="14.00">Input: [variable_batch, d_model=4096]</text>
<text text-anchor="middle" x="1453.5" y="-241.54" font-family="Times,serif" font-size="14.00">Output: [variable_batch, d_model=4096]</text>
</g>
<!-- token_split&#45;&gt;expert_4_gpu_4 -->
<g id="edge7" class="edge">
<title>token_split&#45;&gt;expert_4_gpu_4</title>
<path fill="none" stroke="black" d="M1965.43,-367.73C1852.32,-354.24 1734.72,-337.88 1617.22,-317"/>
<polygon fill="black" stroke="black" points="1617.77,-313.54 1607.31,-315.22 1616.53,-320.43 1617.77,-313.54"/>
<text text-anchor="middle" x="1877" y="-338.54" font-family="Times,serif" font-size="14.00">expert_4_tokens</text>
</g>
<!-- expert_5_gpu_5 -->
<g id="node9" class="node">
<title>expert_5_gpu_5</title>
<polygon fill="lightgreen" stroke="black" points="1932,-316.74 1625,-316.74 1625,-233.74 1932,-233.74 1932,-316.74"/>
<text text-anchor="middle" x="1778.5" y="-301.54" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="1778.5" y="-286.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="1778.5" y="-271.54" font-family="Times,serif" font-size="14.00">MLP: 4096→16384→4096</text>
<text text-anchor="middle" x="1778.5" y="-256.54" font-family="Times,serif" font-size="14.00">Input: [variable_batch, d_model=4096]</text>
<text text-anchor="middle" x="1778.5" y="-241.54" font-family="Times,serif" font-size="14.00">Output: [variable_batch, d_model=4096]</text>
</g>
<!-- token_split&#45;&gt;expert_5_gpu_5 -->
<g id="edge8" class="edge">
<title>token_split&#45;&gt;expert_5_gpu_5</title>
<path fill="none" stroke="black" d="M2212.13,-367.73C2126.63,-353.12 2034.72,-336.34 1942.18,-317.06"/>
<polygon fill="black" stroke="black" points="1942.86,-313.63 1932.35,-315 1941.42,-320.48 1942.86,-313.63"/>
<text text-anchor="middle" x="2165" y="-338.54" font-family="Times,serif" font-size="14.00">expert_5_tokens</text>
</g>
<!-- expert_6_gpu_6 -->
<g id="node10" class="node">
<title>expert_6_gpu_6</title>
<polygon fill="lightgreen" stroke="black" points="2257,-316.74 1950,-316.74 1950,-233.74 2257,-233.74 2257,-316.74"/>
<text text-anchor="middle" x="2103.5" y="-301.54" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2103.5" y="-286.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="2103.5" y="-271.54" font-family="Times,serif" font-size="14.00">MLP: 4096→16384→4096</text>
<text text-anchor="middle" x="2103.5" y="-256.54" font-family="Times,serif" font-size="14.00">Input: [variable_batch, d_model=4096]</text>
<text text-anchor="middle" x="2103.5" y="-241.54" font-family="Times,serif" font-size="14.00">Output: [variable_batch, d_model=4096]</text>
</g>
<!-- token_split&#45;&gt;expert_6_gpu_6 -->
<g id="edge9" class="edge">
<title>token_split&#45;&gt;expert_6_gpu_6</title>
<path fill="none" stroke="black" d="M2384.67,-367.73C2336.57,-352.08 2284.3,-335.07 2238.02,-320.01"/>
<polygon fill="black" stroke="black" points="2238.83,-316.59 2228.23,-316.83 2236.66,-323.25 2238.83,-316.59"/>
<text text-anchor="middle" x="2383" y="-338.54" font-family="Times,serif" font-size="14.00">expert_6_tokens</text>
</g>
<!-- expert_7_gpu_7 -->
<g id="node11" class="node">
<title>expert_7_gpu_7</title>
<polygon fill="lightgreen" stroke="black" points="2582,-316.74 2275,-316.74 2275,-233.74 2582,-233.74 2582,-316.74"/>
<text text-anchor="middle" x="2428.5" y="-301.54" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2428.5" y="-286.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="2428.5" y="-271.54" font-family="Times,serif" font-size="14.00">MLP: 4096→16384→4096</text>
<text text-anchor="middle" x="2428.5" y="-256.54" font-family="Times,serif" font-size="14.00">Input: [variable_batch, d_model=4096]</text>
<text text-anchor="middle" x="2428.5" y="-241.54" font-family="Times,serif" font-size="14.00">Output: [variable_batch, d_model=4096]</text>
</g>
<!-- token_split&#45;&gt;expert_7_gpu_7 -->
<g id="edge10" class="edge">
<title>token_split&#45;&gt;expert_7_gpu_7</title>
<path fill="none" stroke="black" d="M2502.29,-367.53C2491.03,-353.59 2478.91,-338.6 2467.81,-324.86"/>
<polygon fill="black" stroke="black" points="2470.41,-322.52 2461.4,-316.94 2464.97,-326.92 2470.41,-322.52"/>
<text text-anchor="middle" x="2545" y="-338.54" font-family="Times,serif" font-size="14.00">expert_7_tokens</text>
</g>
<!-- expert_8_gpu_8 -->
<g id="node12" class="node">
<title>expert_8_gpu_8</title>
<polygon fill="lightgreen" stroke="black" points="2907,-316.74 2600,-316.74 2600,-233.74 2907,-233.74 2907,-316.74"/>
<text text-anchor="middle" x="2753.5" y="-301.54" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="2753.5" y="-286.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="2753.5" y="-271.54" font-family="Times,serif" font-size="14.00">MLP: 4096→16384→4096</text>
<text text-anchor="middle" x="2753.5" y="-256.54" font-family="Times,serif" font-size="14.00">Input: [variable_batch, d_model=4096]</text>
<text text-anchor="middle" x="2753.5" y="-241.54" font-family="Times,serif" font-size="14.00">Output: [variable_batch, d_model=4096]</text>
</g>
<!-- token_split&#45;&gt;expert_8_gpu_8 -->
<g id="edge11" class="edge">
<title>token_split&#45;&gt;expert_8_gpu_8</title>
<path fill="none" stroke="black" d="M2620.25,-367.73C2641.71,-353 2664.92,-337.06 2685.87,-322.68"/>
<polygon fill="black" stroke="black" points="2688.12,-325.37 2694.39,-316.83 2684.16,-319.6 2688.12,-325.37"/>
<text text-anchor="middle" x="2727" y="-338.54" font-family="Times,serif" font-size="14.00">expert_8_tokens</text>
</g>
<!-- expert_9_gpu_9 -->
<g id="node13" class="node">
<title>expert_9_gpu_9</title>
<polygon fill="lightgreen" stroke="black" points="3232,-316.74 2925,-316.74 2925,-233.74 3232,-233.74 3232,-316.74"/>
<text text-anchor="middle" x="3078.5" y="-301.54" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="3078.5" y="-286.54" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="3078.5" y="-271.54" font-family="Times,serif" font-size="14.00">MLP: 4096→16384→4096</text>
<text text-anchor="middle" x="3078.5" y="-256.54" font-family="Times,serif" font-size="14.00">Input: [variable_batch, d_model=4096]</text>
<text text-anchor="middle" x="3078.5" y="-241.54" font-family="Times,serif" font-size="14.00">Output: [variable_batch, d_model=4096]</text>
</g>
<!-- token_split&#45;&gt;expert_9_gpu_9 -->
<g id="edge12" class="edge">
<title>token_split&#45;&gt;expert_9_gpu_9</title>
<path fill="none" stroke="black" d="M2738.04,-367.73C2797.01,-351.88 2861.17,-334.64 2917.72,-319.44"/>
<polygon fill="black" stroke="black" points="2918.71,-322.8 2927.46,-316.83 2916.9,-316.04 2918.71,-322.8"/>
<text text-anchor="middle" x="2918" y="-338.54" font-family="Times,serif" font-size="14.00">expert_9_tokens</text>
</g>
<!-- expert_10_gpu_10 -->
<g id="node14" class="node">
<title>expert_10_gpu_10</title>
<polygon fill="lightgreen" stroke="black" points="3557,-316.74 3250,-316.74 3250,-233.74 3557,-233.74 3557,-316.74"/>
<text text-anchor="middle" x="3403.5" y="-301.54" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="3403.5" y="-286.54" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="3403.5" y="-271.54" font-family="Times,serif" font-size="14.00">MLP: 4096→16384→4096</text>
<text text-anchor="middle" x="3403.5" y="-256.54" font-family="Times,serif" font-size="14.00">Input: [variable_batch, d_model=4096]</text>
<text text-anchor="middle" x="3403.5" y="-241.54" font-family="Times,serif" font-size="14.00">Output: [variable_batch, d_model=4096]</text>
</g>
<!-- token_split&#45;&gt;expert_10_gpu_10 -->
<g id="edge13" class="edge">
<title>token_split&#45;&gt;expert_10_gpu_10</title>
<path fill="none" stroke="black" d="M2941.77,-367.72C3036.68,-353.48 3137.67,-336.86 3239.71,-316.85"/>
<polygon fill="black" stroke="black" points="3240.45,-320.27 3249.59,-314.9 3239.1,-313.4 3240.45,-320.27"/>
<text text-anchor="middle" x="3190.5" y="-338.54" font-family="Times,serif" font-size="14.00">expert_10_tokens</text>
</g>
<!-- expert_11_gpu_11 -->
<g id="node15" class="node">
<title>expert_11_gpu_11</title>
<polygon fill="lightgreen" stroke="black" points="3882,-316.74 3575,-316.74 3575,-233.74 3882,-233.74 3882,-316.74"/>
<text text-anchor="middle" x="3728.5" y="-301.54" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="3728.5" y="-286.54" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="3728.5" y="-271.54" font-family="Times,serif" font-size="14.00">MLP: 4096→16384→4096</text>
<text text-anchor="middle" x="3728.5" y="-256.54" font-family="Times,serif" font-size="14.00">Input: [variable_batch, d_model=4096]</text>
<text text-anchor="middle" x="3728.5" y="-241.54" font-family="Times,serif" font-size="14.00">Output: [variable_batch, d_model=4096]</text>
</g>
<!-- token_split&#45;&gt;expert_11_gpu_11 -->
<g id="edge14" class="edge">
<title>token_split&#45;&gt;expert_11_gpu_11</title>
<path fill="none" stroke="black" d="M2997.1,-388.87C3172.32,-373.14 3374.34,-350.4 3564.77,-316.99"/>
<polygon fill="black" stroke="black" points="3565.46,-320.42 3574.7,-315.24 3564.24,-313.53 3565.46,-320.42"/>
<text text-anchor="middle" x="3519.5" y="-338.54" font-family="Times,serif" font-size="14.00">expert_11_tokens</text>
</g>
<!-- expert_12_gpu_12 -->
<g id="node16" class="node">
<title>expert_12_gpu_12</title>
<polygon fill="lightgreen" stroke="black" points="4207,-316.74 3900,-316.74 3900,-233.74 4207,-233.74 4207,-316.74"/>
<text text-anchor="middle" x="4053.5" y="-301.54" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="4053.5" y="-286.54" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="4053.5" y="-271.54" font-family="Times,serif" font-size="14.00">MLP: 4096→16384→4096</text>
<text text-anchor="middle" x="4053.5" y="-256.54" font-family="Times,serif" font-size="14.00">Input: [variable_batch, d_model=4096]</text>
<text text-anchor="middle" x="4053.5" y="-241.54" font-family="Times,serif" font-size="14.00">Output: [variable_batch, d_model=4096]</text>
</g>
<!-- token_split&#45;&gt;expert_12_gpu_12 -->
<g id="edge15" class="edge">
<title>token_split&#45;&gt;expert_12_gpu_12</title>
<path fill="none" stroke="black" d="M3007.12,-392.72C3187.98,-381.09 3397.08,-366.34 3586.5,-349.74 3719.01,-338.13 3755.5,-340.53 3889.45,-317.05"/>
<polygon fill="black" stroke="black" points="3890.46,-320.42 3899.69,-315.23 3889.24,-313.53 3890.46,-320.42"/>
<text text-anchor="middle" x="3827.5" y="-338.54" font-family="Times,serif" font-size="14.00">expert_12_tokens</text>
</g>
<!-- expert_13_gpu_13 -->
<g id="node17" class="node">
<title>expert_13_gpu_13</title>
<polygon fill="lightgreen" stroke="black" points="4532,-316.74 4225,-316.74 4225,-233.74 4532,-233.74 4532,-316.74"/>
<text text-anchor="middle" x="4378.5" y="-301.54" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="4378.5" y="-286.54" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="4378.5" y="-271.54" font-family="Times,serif" font-size="14.00">MLP: 4096→16384→4096</text>
<text text-anchor="middle" x="4378.5" y="-256.54" font-family="Times,serif" font-size="14.00">Input: [variable_batch, d_model=4096]</text>
<text text-anchor="middle" x="4378.5" y="-241.54" font-family="Times,serif" font-size="14.00">Output: [variable_batch, d_model=4096]</text>
</g>
<!-- token_split&#45;&gt;expert_13_gpu_13 -->
<g id="edge16" class="edge">
<title>token_split&#45;&gt;expert_13_gpu_13</title>
<path fill="none" stroke="black" d="M3027.55,-400.59C3285.11,-388.89 3607.27,-371.89 3894.5,-349.74 4034.71,-338.93 4073.09,-341.46 4214.77,-316.98"/>
<polygon fill="black" stroke="black" points="4215.45,-320.42 4224.7,-315.25 4214.25,-313.52 4215.45,-320.42"/>
<text text-anchor="middle" x="4151.5" y="-338.54" font-family="Times,serif" font-size="14.00">expert_13_tokens</text>
</g>
<!-- expert_14_gpu_14 -->
<g id="node18" class="node">
<title>expert_14_gpu_14</title>
<polygon fill="lightgreen" stroke="black" points="4857,-316.74 4550,-316.74 4550,-233.74 4857,-233.74 4857,-316.74"/>
<text text-anchor="middle" x="4703.5" y="-301.54" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="4703.5" y="-286.54" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="4703.5" y="-271.54" font-family="Times,serif" font-size="14.00">MLP: 4096→16384→4096</text>
<text text-anchor="middle" x="4703.5" y="-256.54" font-family="Times,serif" font-size="14.00">Input: [variable_batch, d_model=4096]</text>
<text text-anchor="middle" x="4703.5" y="-241.54" font-family="Times,serif" font-size="14.00">Output: [variable_batch, d_model=4096]</text>
</g>
<!-- token_split&#45;&gt;expert_14_gpu_14 -->
<g id="edge17" class="edge">
<title>token_split&#45;&gt;expert_14_gpu_14</title>
<path fill="none" stroke="black" d="M3043.5,-406.71C3376.55,-396.09 3824.11,-378.11 4218.5,-349.74 4359.2,-339.62 4397.65,-341.54 4539.74,-316.99"/>
<polygon fill="black" stroke="black" points="4540.45,-320.42 4549.7,-315.26 4539.25,-313.52 4540.45,-320.42"/>
<text text-anchor="middle" x="4481.5" y="-338.54" font-family="Times,serif" font-size="14.00">expert_14_tokens</text>
</g>
<!-- expert_15_gpu_15 -->
<g id="node19" class="node">
<title>expert_15_gpu_15</title>
<polygon fill="lightgreen" stroke="black" points="5182,-316.74 4875,-316.74 4875,-233.74 5182,-233.74 5182,-316.74"/>
<text text-anchor="middle" x="5028.5" y="-301.54" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="5028.5" y="-286.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="5028.5" y="-271.54" font-family="Times,serif" font-size="14.00">MLP: 4096→16384→4096</text>
<text text-anchor="middle" x="5028.5" y="-256.54" font-family="Times,serif" font-size="14.00">Input: [variable_batch, d_model=4096]</text>
<text text-anchor="middle" x="5028.5" y="-241.54" font-family="Times,serif" font-size="14.00">Output: [variable_batch, d_model=4096]</text>
</g>
<!-- token_split&#45;&gt;expert_15_gpu_15 -->
<g id="edge18" class="edge">
<title>token_split&#45;&gt;expert_15_gpu_15</title>
<path fill="none" stroke="black" d="M3055.68,-411.53C3460.94,-402.69 4041.45,-384.86 4548.5,-349.74 4686.93,-340.15 4724.8,-341.3 4864.46,-317.04"/>
<polygon fill="black" stroke="black" points="4865.45,-320.42 4874.7,-315.25 4864.24,-313.53 4865.45,-320.42"/>
<text text-anchor="middle" x="4808.5" y="-338.54" font-family="Times,serif" font-size="14.00">expert_15_tokens</text>
</g>
<!-- expert_agg -->
<g id="node20" class="node">
<title>expert_agg</title>
<polygon fill="yellow" stroke="black" points="3263.21,-196.74 2193.08,-196.74 1917.79,-90.74 2987.92,-90.74 3263.21,-196.74"/>
<text text-anchor="middle" x="2590.5" y="-155.04" font-family="Times,serif" font-size="14.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="2590.5" y="-140.04" font-family="Times,serif" font-size="14.00">Combine outputs from 16 experts</text>
<text text-anchor="middle" x="2590.5" y="-125.04" font-family="Times,serif" font-size="14.00">16×[variable_batch, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- expert_0_gpu_0&#45;&gt;expert_agg -->
<g id="edge19" class="edge">
<title>expert_0_gpu_0&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M307.26,-234.99C310.03,-234.55 312.77,-234.13 315.5,-233.74 640.78,-187.22 1503.12,-163.59 2067.74,-152.73"/>
<polygon fill="black" stroke="black" points="2068.17,-156.23 2078.1,-152.54 2068.04,-149.23 2068.17,-156.23"/>
</g>
<!-- expert_1_gpu_1&#45;&gt;expert_agg -->
<g id="edge20" class="edge">
<title>expert_1_gpu_1&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M632.27,-235.01C635.03,-234.56 637.77,-234.14 640.5,-233.74 907.07,-194.73 1594.67,-169.85 2077.51,-156.59"/>
<polygon fill="black" stroke="black" points="2077.91,-160.08 2087.81,-156.31 2077.72,-153.08 2077.91,-160.08"/>
</g>
<!-- expert_2_gpu_2&#45;&gt;expert_agg -->
<g id="edge21" class="edge">
<title>expert_2_gpu_2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M957.27,-235.05C960.03,-234.59 962.78,-234.15 965.5,-233.74 1174.54,-202.18 1694.47,-177.1 2090.39,-161.72"/>
<polygon fill="black" stroke="black" points="2090.74,-165.21 2100.6,-161.32 2090.47,-158.21 2090.74,-165.21"/>
</g>
<!-- expert_3_gpu_3&#45;&gt;expert_agg -->
<g id="edge22" class="edge">
<title>expert_3_gpu_3&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M1282.28,-235.1C1285.04,-234.62 1287.78,-234.17 1290.5,-233.74 1550.02,-192.75 1841.63,-170.63 2082.8,-158.7"/>
<polygon fill="black" stroke="black" points="2082.98,-162.2 2092.8,-158.21 2082.64,-155.2 2082.98,-162.2"/>
</g>
<!-- expert_4_gpu_4&#45;&gt;expert_agg -->
<g id="edge23" class="edge">
<title>expert_4_gpu_4&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M1607.29,-235.18C1610.05,-234.68 1612.78,-234.2 1615.5,-233.74 1778.62,-206.07 1958.65,-186.58 2119.15,-173.04"/>
<polygon fill="black" stroke="black" points="2119.53,-176.52 2129.21,-172.2 2118.95,-169.55 2119.53,-176.52"/>
</g>
<!-- expert_5_gpu_5&#45;&gt;expert_agg -->
<g id="edge24" class="edge">
<title>expert_5_gpu_5&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M1932.33,-235.35C1935.07,-234.8 1937.8,-234.26 1940.5,-233.74 2015.71,-219.23 2096.26,-206.21 2174.16,-194.89"/>
<polygon fill="black" stroke="black" points="2174.74,-198.34 2184.14,-193.44 2173.74,-191.41 2174.74,-198.34"/>
</g>
<!-- expert_6_gpu_6&#45;&gt;expert_agg -->
<g id="edge25" class="edge">
<title>expert_6_gpu_6&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M2255.92,-233.71C2296.78,-222.85 2341.63,-210.92 2384.85,-199.43"/>
<polygon fill="black" stroke="black" points="2385.86,-202.78 2394.62,-196.83 2384.06,-196.01 2385.86,-202.78"/>
</g>
<!-- expert_7_gpu_7&#45;&gt;expert_agg -->
<g id="edge26" class="edge">
<title>expert_7_gpu_7&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M2479.31,-233.62C2491.38,-223.98 2504.48,-213.5 2517.33,-203.23"/>
<polygon fill="black" stroke="black" points="2519.65,-205.86 2525.28,-196.88 2515.28,-200.39 2519.65,-205.86"/>
</g>
<!-- expert_8_gpu_8&#45;&gt;expert_agg -->
<g id="edge27" class="edge">
<title>expert_8_gpu_8&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M2702.37,-233.62C2690.23,-223.98 2677.05,-213.5 2664.13,-203.23"/>
<polygon fill="black" stroke="black" points="2666.13,-200.36 2656.13,-196.88 2661.78,-205.84 2666.13,-200.36"/>
</g>
<!-- expert_9_gpu_9&#45;&gt;expert_agg -->
<g id="edge28" class="edge">
<title>expert_9_gpu_9&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M2925.77,-233.71C2884.83,-222.85 2839.88,-210.92 2796.57,-199.43"/>
<polygon fill="black" stroke="black" points="2797.34,-196.01 2786.78,-196.83 2795.55,-202.77 2797.34,-196.01"/>
</g>
<!-- expert_10_gpu_10&#45;&gt;expert_agg -->
<g id="edge29" class="edge">
<title>expert_10_gpu_10&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M3249.6,-235.53C3246.54,-234.92 3243.51,-234.32 3240.5,-233.74 3172.4,-220.66 3099.92,-208.76 3029,-198.23"/>
<polygon fill="black" stroke="black" points="3029.41,-194.75 3019.01,-196.75 3028.39,-201.68 3029.41,-194.75"/>
</g>
<!-- expert_11_gpu_11&#45;&gt;expert_agg -->
<g id="edge30" class="edge">
<title>expert_11_gpu_11&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M3574.71,-235.18C3571.95,-234.68 3569.22,-234.2 3566.5,-233.74 3467.06,-216.88 3361.35,-203.06 3257.59,-191.77"/>
<polygon fill="black" stroke="black" points="3257.88,-188.28 3247.56,-190.68 3257.13,-195.24 3257.88,-188.28"/>
</g>
<!-- expert_12_gpu_12&#45;&gt;expert_agg -->
<g id="edge31" class="edge">
<title>expert_12_gpu_12&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M3899.72,-235.1C3896.96,-234.62 3894.22,-234.17 3891.5,-233.74 3662.18,-197.52 3407.81,-176.04 3185.27,-163.3"/>
<polygon fill="black" stroke="black" points="3185.21,-159.79 3175.03,-162.72 3184.82,-166.78 3185.21,-159.79"/>
</g>
<!-- expert_13_gpu_13&#45;&gt;expert_agg -->
<g id="edge32" class="edge">
<title>expert_13_gpu_13&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M4224.73,-235.05C4221.97,-234.59 4219.22,-234.15 4216.5,-233.74 4024.7,-204.79 3571.34,-181.3 3191.93,-165.74"/>
<polygon fill="black" stroke="black" points="3191.99,-162.24 3181.86,-165.33 3191.71,-169.23 3191.99,-162.24"/>
</g>
<!-- expert_14_gpu_14&#45;&gt;expert_agg -->
<g id="edge33" class="edge">
<title>expert_14_gpu_14&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M4549.73,-235.01C4546.97,-234.56 4544.23,-234.14 4541.5,-233.74 4287.39,-196.56 3650.88,-172.22 3173.5,-158.54"/>
<polygon fill="black" stroke="black" points="3173.41,-155.04 3163.31,-158.25 3173.21,-162.03 3173.41,-155.04"/>
</g>
<!-- expert_15_gpu_15&#45;&gt;expert_agg -->
<g id="edge34" class="edge">
<title>expert_15_gpu_15&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M4874.74,-234.99C4871.97,-234.55 4869.23,-234.13 4866.5,-233.74 4655.16,-203.47 4599.84,-223.12 4386.5,-214.74 3991,-199.21 3546.51,-181.88 3198.66,-168.35"/>
<polygon fill="black" stroke="black" points="3198.79,-164.85 3188.66,-167.96 3198.52,-171.85 3198.79,-164.85"/>
</g>
<!-- output -->
<g id="node21" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="2590.5" cy="-26.87" rx="265.74" ry="26.74"/>
<text text-anchor="middle" x="2590.5" y="-30.67" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="2590.5" y="-15.67" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- expert_agg&#45;&gt;output -->
<g id="edge35" class="edge">
<title>expert_agg&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2590.5,-90.68C2590.5,-81.75 2590.5,-72.64 2590.5,-64.24"/>
<polygon fill="black" stroke="black" points="2594,-64.03 2590.5,-54.03 2587,-64.03 2594,-64.03"/>
</g>
</g>
</svg>
