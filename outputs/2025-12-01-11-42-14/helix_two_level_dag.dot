digraph Helix_Two_Level_Attention_Partitioning {
	fontname=Arial fontsize=12 rankdir=TB
	node [fillcolor=lightblue shape=ellipse style=filled]
	node [fillcolor=lightgreen shape=rectangle style=filled]
	node [fillcolor=yellow shape=parallelogram style=filled]
	node [fillcolor=orange shape=diamond style=filled]
	input [label="Input\n[batch_size=128, seq_len=10000, d_model=4096]" fillcolor=lightblue shape=ellipse]
	input_proj_split [label="Input Projection Split\nSplit Q,K,V across 16 devices\n[batch_size=128, seq_len=10000, d_model=4096]→16×[batch_size=128, seq_len=10000, 256]" fillcolor=yellow shape=parallelogram]
	input -> input_proj_split
	device_0_q_proj [label="Device 0 Q Projection\nHead Group 0, Dim Slice 0\nGPU 0\nW_Q[0,0]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_0_k_proj [label="Device 0 K Projection\nHead Group 0, Dim Slice 0\nGPU 0\nW_K[0,0]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_0_v_proj [label="Device 0 V Projection\nHead Group 0, Dim Slice 0\nGPU 0\nW_V[0,0]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_0_attn [label="Device 0 Attention Computation\nHead Group 0, Dim Slice 0\nGPU 0\nsoftmax(QK^T/√32)V\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	input_proj_split -> device_0_q_proj
	input_proj_split -> device_0_k_proj
	input_proj_split -> device_0_v_proj
	device_0_q_proj -> device_0_attn
	device_0_k_proj -> device_0_attn
	device_0_v_proj -> device_0_attn
	device_1_q_proj [label="Device 1 Q Projection\nHead Group 0, Dim Slice 1\nGPU 1\nW_Q[0,1]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_1_k_proj [label="Device 1 K Projection\nHead Group 0, Dim Slice 1\nGPU 1\nW_K[0,1]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_1_v_proj [label="Device 1 V Projection\nHead Group 0, Dim Slice 1\nGPU 1\nW_V[0,1]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_1_attn [label="Device 1 Attention Computation\nHead Group 0, Dim Slice 1\nGPU 1\nsoftmax(QK^T/√32)V\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	input_proj_split -> device_1_q_proj
	input_proj_split -> device_1_k_proj
	input_proj_split -> device_1_v_proj
	device_1_q_proj -> device_1_attn
	device_1_k_proj -> device_1_attn
	device_1_v_proj -> device_1_attn
	device_2_q_proj [label="Device 2 Q Projection\nHead Group 0, Dim Slice 2\nGPU 2\nW_Q[0,2]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_2_k_proj [label="Device 2 K Projection\nHead Group 0, Dim Slice 2\nGPU 2\nW_K[0,2]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_2_v_proj [label="Device 2 V Projection\nHead Group 0, Dim Slice 2\nGPU 2\nW_V[0,2]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_2_attn [label="Device 2 Attention Computation\nHead Group 0, Dim Slice 2\nGPU 2\nsoftmax(QK^T/√32)V\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	input_proj_split -> device_2_q_proj
	input_proj_split -> device_2_k_proj
	input_proj_split -> device_2_v_proj
	device_2_q_proj -> device_2_attn
	device_2_k_proj -> device_2_attn
	device_2_v_proj -> device_2_attn
	device_3_q_proj [label="Device 3 Q Projection\nHead Group 0, Dim Slice 3\nGPU 3\nW_Q[0,3]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_3_k_proj [label="Device 3 K Projection\nHead Group 0, Dim Slice 3\nGPU 3\nW_K[0,3]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_3_v_proj [label="Device 3 V Projection\nHead Group 0, Dim Slice 3\nGPU 3\nW_V[0,3]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_3_attn [label="Device 3 Attention Computation\nHead Group 0, Dim Slice 3\nGPU 3\nsoftmax(QK^T/√32)V\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	input_proj_split -> device_3_q_proj
	input_proj_split -> device_3_k_proj
	input_proj_split -> device_3_v_proj
	device_3_q_proj -> device_3_attn
	device_3_k_proj -> device_3_attn
	device_3_v_proj -> device_3_attn
	device_4_q_proj [label="Device 4 Q Projection\nHead Group 1, Dim Slice 0\nGPU 4\nW_Q[1,0]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_4_k_proj [label="Device 4 K Projection\nHead Group 1, Dim Slice 0\nGPU 4\nW_K[1,0]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_4_v_proj [label="Device 4 V Projection\nHead Group 1, Dim Slice 0\nGPU 4\nW_V[1,0]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_4_attn [label="Device 4 Attention Computation\nHead Group 1, Dim Slice 0\nGPU 4\nsoftmax(QK^T/√32)V\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	input_proj_split -> device_4_q_proj
	input_proj_split -> device_4_k_proj
	input_proj_split -> device_4_v_proj
	device_4_q_proj -> device_4_attn
	device_4_k_proj -> device_4_attn
	device_4_v_proj -> device_4_attn
	device_5_q_proj [label="Device 5 Q Projection\nHead Group 1, Dim Slice 1\nGPU 5\nW_Q[1,1]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_5_k_proj [label="Device 5 K Projection\nHead Group 1, Dim Slice 1\nGPU 5\nW_K[1,1]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_5_v_proj [label="Device 5 V Projection\nHead Group 1, Dim Slice 1\nGPU 5\nW_V[1,1]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_5_attn [label="Device 5 Attention Computation\nHead Group 1, Dim Slice 1\nGPU 5\nsoftmax(QK^T/√32)V\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	input_proj_split -> device_5_q_proj
	input_proj_split -> device_5_k_proj
	input_proj_split -> device_5_v_proj
	device_5_q_proj -> device_5_attn
	device_5_k_proj -> device_5_attn
	device_5_v_proj -> device_5_attn
	device_6_q_proj [label="Device 6 Q Projection\nHead Group 1, Dim Slice 2\nGPU 6\nW_Q[1,2]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_6_k_proj [label="Device 6 K Projection\nHead Group 1, Dim Slice 2\nGPU 6\nW_K[1,2]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_6_v_proj [label="Device 6 V Projection\nHead Group 1, Dim Slice 2\nGPU 6\nW_V[1,2]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_6_attn [label="Device 6 Attention Computation\nHead Group 1, Dim Slice 2\nGPU 6\nsoftmax(QK^T/√32)V\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	input_proj_split -> device_6_q_proj
	input_proj_split -> device_6_k_proj
	input_proj_split -> device_6_v_proj
	device_6_q_proj -> device_6_attn
	device_6_k_proj -> device_6_attn
	device_6_v_proj -> device_6_attn
	device_7_q_proj [label="Device 7 Q Projection\nHead Group 1, Dim Slice 3\nGPU 7\nW_Q[1,3]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_7_k_proj [label="Device 7 K Projection\nHead Group 1, Dim Slice 3\nGPU 7\nW_K[1,3]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_7_v_proj [label="Device 7 V Projection\nHead Group 1, Dim Slice 3\nGPU 7\nW_V[1,3]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_7_attn [label="Device 7 Attention Computation\nHead Group 1, Dim Slice 3\nGPU 7\nsoftmax(QK^T/√32)V\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	input_proj_split -> device_7_q_proj
	input_proj_split -> device_7_k_proj
	input_proj_split -> device_7_v_proj
	device_7_q_proj -> device_7_attn
	device_7_k_proj -> device_7_attn
	device_7_v_proj -> device_7_attn
	device_8_q_proj [label="Device 8 Q Projection\nHead Group 2, Dim Slice 0\nGPU 8\nW_Q[2,0]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_8_k_proj [label="Device 8 K Projection\nHead Group 2, Dim Slice 0\nGPU 8\nW_K[2,0]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_8_v_proj [label="Device 8 V Projection\nHead Group 2, Dim Slice 0\nGPU 8\nW_V[2,0]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_8_attn [label="Device 8 Attention Computation\nHead Group 2, Dim Slice 0\nGPU 8\nsoftmax(QK^T/√32)V\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	input_proj_split -> device_8_q_proj
	input_proj_split -> device_8_k_proj
	input_proj_split -> device_8_v_proj
	device_8_q_proj -> device_8_attn
	device_8_k_proj -> device_8_attn
	device_8_v_proj -> device_8_attn
	device_9_q_proj [label="Device 9 Q Projection\nHead Group 2, Dim Slice 1\nGPU 9\nW_Q[2,1]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_9_k_proj [label="Device 9 K Projection\nHead Group 2, Dim Slice 1\nGPU 9\nW_K[2,1]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_9_v_proj [label="Device 9 V Projection\nHead Group 2, Dim Slice 1\nGPU 9\nW_V[2,1]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_9_attn [label="Device 9 Attention Computation\nHead Group 2, Dim Slice 1\nGPU 9\nsoftmax(QK^T/√32)V\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	input_proj_split -> device_9_q_proj
	input_proj_split -> device_9_k_proj
	input_proj_split -> device_9_v_proj
	device_9_q_proj -> device_9_attn
	device_9_k_proj -> device_9_attn
	device_9_v_proj -> device_9_attn
	device_10_q_proj [label="Device 10 Q Projection\nHead Group 2, Dim Slice 2\nGPU 10\nW_Q[2,2]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_10_k_proj [label="Device 10 K Projection\nHead Group 2, Dim Slice 2\nGPU 10\nW_K[2,2]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_10_v_proj [label="Device 10 V Projection\nHead Group 2, Dim Slice 2\nGPU 10\nW_V[2,2]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_10_attn [label="Device 10 Attention Computation\nHead Group 2, Dim Slice 2\nGPU 10\nsoftmax(QK^T/√32)V\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	input_proj_split -> device_10_q_proj
	input_proj_split -> device_10_k_proj
	input_proj_split -> device_10_v_proj
	device_10_q_proj -> device_10_attn
	device_10_k_proj -> device_10_attn
	device_10_v_proj -> device_10_attn
	device_11_q_proj [label="Device 11 Q Projection\nHead Group 2, Dim Slice 3\nGPU 11\nW_Q[2,3]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_11_k_proj [label="Device 11 K Projection\nHead Group 2, Dim Slice 3\nGPU 11\nW_K[2,3]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_11_v_proj [label="Device 11 V Projection\nHead Group 2, Dim Slice 3\nGPU 11\nW_V[2,3]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_11_attn [label="Device 11 Attention Computation\nHead Group 2, Dim Slice 3\nGPU 11\nsoftmax(QK^T/√32)V\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	input_proj_split -> device_11_q_proj
	input_proj_split -> device_11_k_proj
	input_proj_split -> device_11_v_proj
	device_11_q_proj -> device_11_attn
	device_11_k_proj -> device_11_attn
	device_11_v_proj -> device_11_attn
	device_12_q_proj [label="Device 12 Q Projection\nHead Group 3, Dim Slice 0\nGPU 12\nW_Q[3,0]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_12_k_proj [label="Device 12 K Projection\nHead Group 3, Dim Slice 0\nGPU 12\nW_K[3,0]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_12_v_proj [label="Device 12 V Projection\nHead Group 3, Dim Slice 0\nGPU 12\nW_V[3,0]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_12_attn [label="Device 12 Attention Computation\nHead Group 3, Dim Slice 0\nGPU 12\nsoftmax(QK^T/√32)V\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	input_proj_split -> device_12_q_proj
	input_proj_split -> device_12_k_proj
	input_proj_split -> device_12_v_proj
	device_12_q_proj -> device_12_attn
	device_12_k_proj -> device_12_attn
	device_12_v_proj -> device_12_attn
	device_13_q_proj [label="Device 13 Q Projection\nHead Group 3, Dim Slice 1\nGPU 13\nW_Q[3,1]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_13_k_proj [label="Device 13 K Projection\nHead Group 3, Dim Slice 1\nGPU 13\nW_K[3,1]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_13_v_proj [label="Device 13 V Projection\nHead Group 3, Dim Slice 1\nGPU 13\nW_V[3,1]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_13_attn [label="Device 13 Attention Computation\nHead Group 3, Dim Slice 1\nGPU 13\nsoftmax(QK^T/√32)V\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	input_proj_split -> device_13_q_proj
	input_proj_split -> device_13_k_proj
	input_proj_split -> device_13_v_proj
	device_13_q_proj -> device_13_attn
	device_13_k_proj -> device_13_attn
	device_13_v_proj -> device_13_attn
	device_14_q_proj [label="Device 14 Q Projection\nHead Group 3, Dim Slice 2\nGPU 14\nW_Q[3,2]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_14_k_proj [label="Device 14 K Projection\nHead Group 3, Dim Slice 2\nGPU 14\nW_K[3,2]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_14_v_proj [label="Device 14 V Projection\nHead Group 3, Dim Slice 2\nGPU 14\nW_V[3,2]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_14_attn [label="Device 14 Attention Computation\nHead Group 3, Dim Slice 2\nGPU 14\nsoftmax(QK^T/√32)V\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	input_proj_split -> device_14_q_proj
	input_proj_split -> device_14_k_proj
	input_proj_split -> device_14_v_proj
	device_14_q_proj -> device_14_attn
	device_14_k_proj -> device_14_attn
	device_14_v_proj -> device_14_attn
	device_15_q_proj [label="Device 15 Q Projection\nHead Group 3, Dim Slice 3\nGPU 15\nW_Q[3,3]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_15_k_proj [label="Device 15 K Projection\nHead Group 3, Dim Slice 3\nGPU 15\nW_K[3,3]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_15_v_proj [label="Device 15 V Projection\nHead Group 3, Dim Slice 3\nGPU 15\nW_V[3,3]: 256×256\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	device_15_attn [label="Device 15 Attention Computation\nHead Group 3, Dim Slice 3\nGPU 15\nsoftmax(QK^T/√32)V\n[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 256]" fillcolor=lightgreen shape=rectangle]
	input_proj_split -> device_15_q_proj
	input_proj_split -> device_15_k_proj
	input_proj_split -> device_15_v_proj
	device_15_q_proj -> device_15_attn
	device_15_k_proj -> device_15_attn
	device_15_v_proj -> device_15_attn
	intra_group_0_concat [label="Intra-Group 0 Concatenation\nConcatenate 4 dimension slices\nGPU 0-3\n4×[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 1024]" fillcolor=yellow shape=parallelogram]
	device_0_attn -> intra_group_0_concat
	device_1_attn -> intra_group_0_concat
	device_2_attn -> intra_group_0_concat
	device_3_attn -> intra_group_0_concat
	intra_group_1_concat [label="Intra-Group 1 Concatenation\nConcatenate 4 dimension slices\nGPU 4-7\n4×[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 1024]" fillcolor=yellow shape=parallelogram]
	device_4_attn -> intra_group_1_concat
	device_5_attn -> intra_group_1_concat
	device_6_attn -> intra_group_1_concat
	device_7_attn -> intra_group_1_concat
	intra_group_2_concat [label="Intra-Group 2 Concatenation\nConcatenate 4 dimension slices\nGPU 8-11\n4×[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 1024]" fillcolor=yellow shape=parallelogram]
	device_8_attn -> intra_group_2_concat
	device_9_attn -> intra_group_2_concat
	device_10_attn -> intra_group_2_concat
	device_11_attn -> intra_group_2_concat
	intra_group_3_concat [label="Intra-Group 3 Concatenation\nConcatenate 4 dimension slices\nGPU 12-15\n4×[batch_size=128, seq_len=10000, 256]→[batch_size=128, seq_len=10000, 1024]" fillcolor=yellow shape=parallelogram]
	device_12_attn -> intra_group_3_concat
	device_13_attn -> intra_group_3_concat
	device_14_attn -> intra_group_3_concat
	device_15_attn -> intra_group_3_concat
	final_concat [label="Final Concatenation\nConcatenate 4 head groups\nGPU 0-15\n4×[batch_size=128, seq_len=10000, 1024]→[batch_size=128, seq_len=10000, 4096]" fillcolor=yellow shape=parallelogram]
	intra_group_0_concat -> final_concat
	intra_group_1_concat -> final_concat
	intra_group_2_concat -> final_concat
	intra_group_3_concat -> final_concat
	output [label="Output\n[batch_size=128, seq_len=10000, d_model=4096]" fillcolor=lightblue shape=ellipse]
	final_concat -> output
}
