<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Helix_Baseline_TP8_PP2 Pages: 1 -->
<svg width="1576pt" height="1053pt"
 viewBox="0.00 0.00 1575.57 1053.48" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1049.48)">
<title>Helix_Baseline_TP8_PP2</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1049.48 1571.57,-1049.48 1571.57,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="783.79" cy="-1018.61" rx="265.74" ry="26.74"/>
<text text-anchor="middle" x="783.79" y="-1022.41" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="783.79" y="-1007.41" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer0_mha_tp8 -->
<g id="node2" class="node">
<title>layer0_mha_tp8</title>
<polygon fill="lightcoral" stroke="black" points="956.29,-955.74 209.29,-955.74 209.29,-872.74 956.29,-872.74 956.29,-955.74"/>
<text text-anchor="middle" x="582.79" y="-940.54" font-family="Times,serif" font-size="14.00">Layer 0 MHA</text>
<text text-anchor="middle" x="582.79" y="-925.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="582.79" y="-910.54" font-family="Times,serif" font-size="14.00">GPU 0&#45;7</text>
<text text-anchor="middle" x="582.79" y="-895.54" font-family="Times,serif" font-size="14.00">32 heads split across 8 GPUs</text>
<text text-anchor="middle" x="582.79" y="-880.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- input&#45;&gt;layer0_mha_tp8 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_mha_tp8</title>
<path fill="none" stroke="black" d="M733.84,-992.17C715.02,-982.59 693,-971.37 671.69,-960.52"/>
<polygon fill="black" stroke="black" points="673.11,-957.31 662.61,-955.89 669.93,-963.55 673.11,-957.31"/>
</g>
<!-- residual0 -->
<g id="node4" class="node">
<title>residual0</title>
<polygon fill="yellow" stroke="black" points="1567.36,-717.74 320.87,-717.74 0.21,-611.74 1246.7,-611.74 1567.36,-717.74"/>
<text text-anchor="middle" x="783.79" y="-676.04" font-family="Times,serif" font-size="14.00">Residual Add Layer 0</text>
<text text-anchor="middle" x="783.79" y="-661.04" font-family="Times,serif" font-size="14.00">GPU 0&#45;7</text>
<text text-anchor="middle" x="783.79" y="-646.04" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096] + [batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- input&#45;&gt;residual0 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;residual0</title>
<path fill="none" stroke="black" d="M915.45,-995.13C935.2,-986.04 953.15,-973.38 965.79,-955.74 1018.06,-882.75 1013.49,-829.79 965.79,-753.74 958.8,-742.6 949.96,-732.84 939.97,-724.29"/>
<polygon fill="black" stroke="black" points="942.1,-721.52 932.11,-717.99 937.72,-726.98 942.1,-721.52"/>
</g>
<!-- layer0_mlp_tp8 -->
<g id="node3" class="node">
<title>layer0_mlp_tp8</title>
<polygon fill="lightcoral" stroke="black" points="956.29,-836.74 209.29,-836.74 209.29,-753.74 956.29,-753.74 956.29,-836.74"/>
<text text-anchor="middle" x="582.79" y="-821.54" font-family="Times,serif" font-size="14.00">Layer 0 MLP</text>
<text text-anchor="middle" x="582.79" y="-806.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="582.79" y="-791.54" font-family="Times,serif" font-size="14.00">GPU 0&#45;7</text>
<text text-anchor="middle" x="582.79" y="-776.54" font-family="Times,serif" font-size="14.00">Column+Row Parallel</text>
<text text-anchor="middle" x="582.79" y="-761.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer0_mha_tp8&#45;&gt;layer0_mlp_tp8 -->
<g id="edge2" class="edge">
<title>layer0_mha_tp8&#45;&gt;layer0_mlp_tp8</title>
<path fill="none" stroke="black" d="M582.79,-872.65C582.79,-864.39 582.79,-855.6 582.79,-847.04"/>
<polygon fill="black" stroke="black" points="586.29,-846.76 582.79,-836.76 579.29,-846.76 586.29,-846.76"/>
</g>
<!-- layer0_mlp_tp8&#45;&gt;residual0 -->
<g id="edge4" class="edge">
<title>layer0_mlp_tp8&#45;&gt;residual0</title>
<path fill="none" stroke="black" d="M646.38,-753.58C661.33,-744.03 677.54,-733.67 693.41,-723.52"/>
<polygon fill="black" stroke="black" points="695.64,-726.25 702.18,-717.91 691.87,-720.35 695.64,-726.25"/>
</g>
<!-- pipe_comm_0_1 -->
<g id="node5" class="node">
<title>pipe_comm_0_1</title>
<polygon fill="orange" stroke="black" points="783.79,-575.74 592.79,-522.74 783.79,-469.74 974.79,-522.74 783.79,-575.74"/>
<text text-anchor="middle" x="783.79" y="-534.04" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="783.79" y="-519.04" font-family="Times,serif" font-size="14.00">Stage 0 → Stage 1</text>
<text text-anchor="middle" x="783.79" y="-504.04" font-family="Times,serif" font-size="14.00">GPU 7 → GPU 8</text>
</g>
<!-- residual0&#45;&gt;pipe_comm_0_1 -->
<g id="edge5" class="edge">
<title>residual0&#45;&gt;pipe_comm_0_1</title>
<path fill="none" stroke="black" d="M783.79,-611.61C783.79,-603.32 783.79,-594.67 783.79,-586.17"/>
<polygon fill="black" stroke="black" points="787.29,-585.91 783.79,-575.91 780.29,-585.91 787.29,-585.91"/>
</g>
<!-- layer1_mha_tp8 -->
<g id="node6" class="node">
<title>layer1_mha_tp8</title>
<polygon fill="lightsteelblue" stroke="black" points="956.29,-433.74 209.29,-433.74 209.29,-350.74 956.29,-350.74 956.29,-433.74"/>
<text text-anchor="middle" x="582.79" y="-418.54" font-family="Times,serif" font-size="14.00">Layer 1 MHA</text>
<text text-anchor="middle" x="582.79" y="-403.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="582.79" y="-388.54" font-family="Times,serif" font-size="14.00">GPU 8&#45;15</text>
<text text-anchor="middle" x="582.79" y="-373.54" font-family="Times,serif" font-size="14.00">32 heads split across 8 GPUs</text>
<text text-anchor="middle" x="582.79" y="-358.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- pipe_comm_0_1&#45;&gt;layer1_mha_tp8 -->
<g id="edge6" class="edge">
<title>pipe_comm_0_1&#45;&gt;layer1_mha_tp8</title>
<path fill="none" stroke="black" d="M726.99,-485.43C704.56,-471.09 678.51,-454.44 654.78,-439.27"/>
<polygon fill="black" stroke="black" points="656.46,-436.19 646.15,-433.75 652.69,-442.08 656.46,-436.19"/>
</g>
<!-- residual1 -->
<g id="node8" class="node">
<title>residual1</title>
<polygon fill="yellow" stroke="black" points="1567.36,-195.74 320.87,-195.74 0.21,-89.74 1246.7,-89.74 1567.36,-195.74"/>
<text text-anchor="middle" x="783.79" y="-154.04" font-family="Times,serif" font-size="14.00">Residual Add Layer 1</text>
<text text-anchor="middle" x="783.79" y="-139.04" font-family="Times,serif" font-size="14.00">GPU 8&#45;15</text>
<text text-anchor="middle" x="783.79" y="-124.04" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096] + [batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- pipe_comm_0_1&#45;&gt;residual1 -->
<g id="edge8" class="edge">
<title>pipe_comm_0_1&#45;&gt;residual1</title>
<path fill="none" stroke="black" d="M882.44,-497.05C914.65,-483.8 946.95,-463.77 965.79,-433.74 1013.49,-357.69 1013.49,-307.79 965.79,-231.74 958.8,-220.6 949.96,-210.84 939.97,-202.29"/>
<polygon fill="black" stroke="black" points="942.1,-199.52 932.11,-195.99 937.72,-204.98 942.1,-199.52"/>
</g>
<!-- layer1_mlp_tp8 -->
<g id="node7" class="node">
<title>layer1_mlp_tp8</title>
<polygon fill="lightsteelblue" stroke="black" points="956.29,-314.74 209.29,-314.74 209.29,-231.74 956.29,-231.74 956.29,-314.74"/>
<text text-anchor="middle" x="582.79" y="-299.54" font-family="Times,serif" font-size="14.00">Layer 1 MLP</text>
<text text-anchor="middle" x="582.79" y="-284.54" font-family="Times,serif" font-size="14.00">Tensor Parallel=8</text>
<text text-anchor="middle" x="582.79" y="-269.54" font-family="Times,serif" font-size="14.00">GPU 8&#45;15</text>
<text text-anchor="middle" x="582.79" y="-254.54" font-family="Times,serif" font-size="14.00">Column+Row Parallel</text>
<text text-anchor="middle" x="582.79" y="-239.54" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]→[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer1_mha_tp8&#45;&gt;layer1_mlp_tp8 -->
<g id="edge7" class="edge">
<title>layer1_mha_tp8&#45;&gt;layer1_mlp_tp8</title>
<path fill="none" stroke="black" d="M582.79,-350.65C582.79,-342.39 582.79,-333.6 582.79,-325.04"/>
<polygon fill="black" stroke="black" points="586.29,-324.76 582.79,-314.76 579.29,-324.76 586.29,-324.76"/>
</g>
<!-- layer1_mlp_tp8&#45;&gt;residual1 -->
<g id="edge9" class="edge">
<title>layer1_mlp_tp8&#45;&gt;residual1</title>
<path fill="none" stroke="black" d="M646.38,-231.58C661.33,-222.03 677.54,-211.67 693.41,-201.52"/>
<polygon fill="black" stroke="black" points="695.64,-204.25 702.18,-195.91 691.87,-198.35 695.64,-204.25"/>
</g>
<!-- output -->
<g id="node9" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="783.79" cy="-26.87" rx="265.74" ry="26.74"/>
<text text-anchor="middle" x="783.79" y="-30.67" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="783.79" y="-15.67" font-family="Times,serif" font-size="14.00">[batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- residual1&#45;&gt;output -->
<g id="edge10" class="edge">
<title>residual1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M783.79,-89.47C783.79,-80.85 783.79,-72.09 783.79,-63.98"/>
<polygon fill="black" stroke="black" points="787.29,-63.77 783.79,-53.77 780.29,-63.77 787.29,-63.77"/>
</g>
</g>
</svg>
