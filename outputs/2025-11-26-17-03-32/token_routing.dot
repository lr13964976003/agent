digraph token_routing {
	graph [bb="0,0,2109.5,790",
		rankdir=LR
	];
	node [label="\N"];
	distributor	[fillcolor=gold,
		height=1.8889,
		label="Token Distributor\nLayer:3, DP:0\nInput: [batch_size=4, seq_len=2048, hidden=7168]\nOutput: [batch_size=4, seq_len=2048, hidden=\
7168]",
		pos="412.63,394.5",
		shape=parallelogram,
		style=filled,
		width=11.462];
	expert_0	[fillcolor=lightcoral,
		height=1.1528,
		label="Expert 0\nGPU:0\nNode:0\nInput: [batch_size=var,seq_len=var,hidden=7168]\nOutput: [batch_size=var,seq_len=var,hidden=7168]",
		pos="1054.8,748.5",
		shape=rectangle,
		style=filled,
		width=5.375];
	distributor -> expert_0	[pos="e,881.13,706.83 495.09,462.6 581.08,531.29 723.06,635.9 861.26,698.5 864.68,700.05 868.16,701.56 871.69,703.03",
		style=dashed];
	expert_1	[fillcolor=lightcoral,
		height=1.1528,
		label="Expert 1\nGPU:1\nNode:0\nInput: [batch_size=var,seq_len=var,hidden=7168]\nOutput: [batch_size=var,seq_len=var,hidden=7168]",
		pos="1054.8,647.5",
		shape=rectangle,
		style=filled,
		width=5.375];
	distributor -> expert_1	[pos="e,886.54,605.95 547.78,462.65 635.43,505.34 753.25,559.3 861.26,597.5 866.39,599.32 871.63,601.1 876.93,602.85",
		style=dashed];
	expert_2	[fillcolor=lightcoral,
		height=1.1528,
		label="Expert 2\nGPU:2\nNode:0\nInput: [batch_size=var,seq_len=var,hidden=7168]\nOutput: [batch_size=var,seq_len=var,hidden=7168]",
		pos="1054.8,546.5",
		shape=rectangle,
		style=filled,
		width=5.375];
	distributor -> expert_2	[pos="e,878.54,504.9 700.46,462.61 757.6,476.18 816.18,490.09 868.79,502.58",
		style=dashed];
	expert_3	[fillcolor=lightcoral,
		height=1.1528,
		label="Expert 3\nGPU:3\nNode:0\nInput: [batch_size=var,seq_len=var,hidden=7168]\nOutput: [batch_size=var,seq_len=var,hidden=7168]",
		pos="1054.8,445.5",
		shape=rectangle,
		style=filled,
		width=5.375];
	distributor -> expert_3	[pos="e,861.03,430.15 777.17,423.46 802.33,425.47 827.12,427.44 850.9,429.34",
		style=dashed];
	expert_4	[fillcolor=lightcoral,
		height=1.1528,
		label="Expert 4\nGPU:4\nNode:0\nInput: [batch_size=var,seq_len=var,hidden=7168]\nOutput: [batch_size=var,seq_len=var,hidden=7168]",
		pos="1054.8,344.5",
		shape=rectangle,
		style=filled,
		width=5.375];
	distributor -> expert_4	[pos="e,861.25,359.54 712.14,371.18 759.26,367.5 807.01,363.77 851.27,360.32",
		style=dashed];
	expert_5	[fillcolor=lightcoral,
		height=1.1528,
		label="Expert 5\nGPU:5\nNode:0\nInput: [batch_size=var,seq_len=var,hidden=7168]\nOutput: [batch_size=var,seq_len=var,hidden=7168]",
		pos="1054.8,243.5",
		shape=rectangle,
		style=filled,
		width=5.375];
	distributor -> expert_5	[pos="e,877.74,285.02 667.08,334.71 734.05,318.92 805.09,302.16 867.76,287.37",
		style=dashed];
	expert_6	[fillcolor=lightcoral,
		height=1.1528,
		label="Expert 6\nGPU:6\nNode:0\nInput: [batch_size=var,seq_len=var,hidden=7168]\nOutput: [batch_size=var,seq_len=var,hidden=7168]",
		pos="1054.8,142.5",
		shape=rectangle,
		style=filled,
		width=5.375];
	distributor -> expert_6	[pos="e,889.63,184.03 549.88,326.33 637.37,284.31 754.26,231.41 861.26,193.5 867.3,191.36 873.47,189.26 879.73,187.21",
		style=dashed];
	expert_7	[fillcolor=lightcoral,
		height=1.1528,
		label="Expert 7\nGPU:7\nNode:0\nInput: [batch_size=var,seq_len=var,hidden=7168]\nOutput: [batch_size=var,seq_len=var,hidden=7168]",
		pos="1054.8,41.5",
		shape=rectangle,
		style=filled,
		width=5.375];
	distributor -> expert_7	[pos="e,883.63,83.168 496.03,326.38 582.21,258.26 723.83,154.9 861.26,92.5 865.44,90.599 869.71,88.758 874.05,86.976",
		style=dashed];
	aggregator	[fillcolor=lightgrey,
		height=1.8889,
		label="Expert Aggregation\nLayer:3, DP:0\nInput: [batch_size=4, seq_len=2048, hidden=7168]\nOutput: [batch_size=4, seq_len=2048, hidden=\
7168]",
		pos="1696.9,394.5",
		shape=parallelogram,
		style=filled,
		width=11.462];
	expert_0 -> aggregator	[pos="e,1614.4,462.6 1228.4,706.83 1235.2,704.19 1241.8,701.42 1248.3,698.5 1382.3,637.79 1519.8,537.59 1606.5,468.93",
		style=dashed];
	expert_1 -> aggregator	[pos="e,1561.7,462.65 1223,605.95 1231.6,603.23 1240,600.41 1248.3,597.5 1352.6,560.61 1466,509.01 1552.6,467.07",
		style=dashed];
	expert_2 -> aggregator	[pos="e,1442.9,454.58 1230.7,504.97 1293,490.16 1364.7,473.13 1432.8,456.96",
		style=dashed];
	expert_3 -> aggregator	[pos="e,1397.8,418.25 1248.7,430.13 1292.6,426.63 1340.3,422.83 1387.7,419.06",
		style=dashed];
	expert_4 -> aggregator	[pos="e,1333.2,366.17 1248.7,359.57 1272.6,361.44 1297.6,363.39 1323.1,365.38",
		style=dashed];
	expert_5 -> aggregator	[pos="e,1407.4,326.44 1231.9,285.06 1283.3,297.17 1340.9,310.75 1397.5,324.12",
		style=dashed];
	expert_6 -> aggregator	[pos="e,1559.6,326.33 1219.9,184.03 1229.5,187.08 1239,190.24 1248.3,193.5 1351.6,230.11 1464.2,280.71 1550.6,321.98",
		style=dashed];
	expert_7 -> aggregator	[pos="e,1613.5,326.38 1225.9,83.168 1233.5,86.104 1241,89.212 1248.3,92.5 1381.5,153.02 1518.7,252.04 1605.5,320.1",
		style=dashed];
}
