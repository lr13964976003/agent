digraph detailed_attention {
	graph [bb="0,0,1181,796",
		rankdir=TB
	];
	node [label="\N"];
	ln	[fillcolor=lightblue,
		height=0.94444,
		label="LayerNorm\nGPU:0\nInput: [batch_size=4, seq_len=2048, heads=128, d_k=128]\nOutput: [batch_size=4, seq_len=2048, heads=128, d_k=128]",
		pos="699,762",
		shape=rectangle,
		style=filled,
		width=6.3056];
	q_proj	[fillcolor=lightgreen,
		height=0.94444,
		label="Q Projection\nGPU:0\nInput: [batch_size=4, seq_len=2048, heads=128, d_k=128]\nOutput: [batch_size=4, seq_len=2048, heads=128, d_\
k=128]",
		pos="227,658",
		shape=rectangle,
		style=filled,
		width=6.3056];
	ln -> q_proj	[pos="e,380.08,692.08 546.08,727.95 496.23,717.18 440.7,705.18 390.13,694.25"];
	k_proj	[fillcolor=lightgreen,
		height=0.94444,
		label="K Projection\nGPU:0\nInput: [batch_size=4, seq_len=2048, heads=128, d_k=128]\nOutput: [batch_size=4, seq_len=2048, heads=128, d_\
k=128]",
		pos="699,658",
		shape=rectangle,
		style=filled,
		width=6.3056];
	ln -> k_proj	[pos="e,699,692.3 699,727.88 699,719.78 699,710.98 699,702.47"];
	v_proj	[fillcolor=lightgreen,
		height=0.94444,
		label="V Projection\nGPU:0\nInput: [batch_size=4, seq_len=2048, heads=128, d_k=128]\nOutput: [batch_size=4, seq_len=2048, heads=128, d_\
k=128]",
		pos="954,554",
		shape=rectangle,
		style=filled,
		width=6.3056];
	ln -> v_proj	[pos="e,958.75,588.11 888.98,727.89 906.33,718.62 922.17,706.86 935,692 956.96,666.55 960.59,627.97 959.36,598.22"];
	scale	[fillcolor=yellow,
		height=0.94444,
		label="Scale\nGPU:0\nInput: [batch_size=4, seq_len=2048, heads=128, d_k=128]\nOutput: [batch_size=4, seq_len=2048, heads=128, d_k=128]",
		pos="336,554",
		shape=rectangle,
		style=filled,
		width=6.3056];
	q_proj -> scale	[pos="e,300.42,588.3 262.39,623.88 272.1,614.8 282.73,604.85 292.83,595.4"];
	matmul1	[fillcolor=yellow,
		height=0.94444,
		label="QK^T MatMul\nGPU:0\nInput: [batch_size=4, seq_len=2048, heads=128, d_k=128]\nOutput: [batch_size=4,seq_len=2048,seq_len=2048]",
		pos="699,450",
		shape=rectangle,
		style=filled,
		width=6.1389];
	k_proj -> matmul1	[pos="e,699,484.02 699,623.9 699,588.76 699,533.08 699,494.43"];
	matmul2	[fillcolor=yellow,
		height=0.94444,
		label="Attention V MatMul\nGPU:0\nInput: [batch_size=4,seq_len=2048,seq_len=2048]\nOutput: [batch_size=4, seq_len=2048, heads=128, d_k=\
128]",
		pos="826,242",
		shape=rectangle,
		style=filled,
		width=6.3056];
	v_proj -> matmul2	[pos="e,886.41,276.29 957.06,519.97 959.99,470.94 959.25,377.64 920,312 913.38,300.92 904.22,291.08 894.21,282.55"];
	scale -> matmul1	[pos="e,581.27,484.08 453.6,519.95 491.31,509.36 533.23,497.58 571.6,486.8"];
	softmax	[fillcolor=yellow,
		height=0.94444,
		label="Softmax\nGPU:0\nInput: [batch_size=4,seq_len=2048,seq_len=2048]\nOutput: [batch_size=4,seq_len=2048,seq_len=2048]",
		pos="714,346",
		shape=rectangle,
		style=filled,
		width=5.4583];
	matmul1 -> softmax	[pos="e,709.1,380.3 703.87,415.88 705.06,407.78 706.36,398.98 707.61,390.47"];
	softmax -> matmul2	[pos="e,789.44,276.3 750.36,311.88 760.44,302.71 771.48,292.65 781.94,283.12"];
	out_proj	[fillcolor=lightgreen,
		height=0.94444,
		label="Output Projection\nGPU:0\nInput: [batch_size=4, seq_len=2048, heads=128, d_k=128]\nOutput: [batch_size=4, seq_len=2048, hidden=7168]",
		pos="826,138",
		shape=rectangle,
		style=filled,
		width=6.1389];
	matmul2 -> out_proj	[pos="e,826,172.3 826,207.88 826,199.78 826,190.98 826,182.47"];
	residual	[fillcolor=lightgrey,
		height=0.94444,
		label="Residual Add\nGPU:0\nInput: [batch_size=4, seq_len=2048, hidden=7168]\nOutput: [batch_size=4, seq_len=2048, hidden=7168]",
		pos="826,34",
		shape=rectangle,
		style=filled,
		width=5.5278];
	out_proj -> residual	[pos="e,826,68.299 826,103.88 826,95.778 826,86.982 826,78.472"];
}
