<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MoE_EP64_Layer Pages: 1 -->
<svg width="633pt" height="1481pt"
 viewBox="0.00 0.00 632.79 1481.08" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1477.08)">
<title>MoE_EP64_Layer</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1477.08 628.79,-1477.08 628.79,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_attn</title>
<polygon fill="white" stroke="black" stroke-dasharray="5,2" points="116.79,-794.08 116.79,-1413.08 364.79,-1413.08 364.79,-794.08 116.79,-794.08"/>
<text text-anchor="middle" x="240.79" y="-1397.88" font-family="Times,serif" font-size="14.00">Attention (identical on all GPUs)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_experts</title>
<polygon fill="white" stroke="black" points="26.79,-417.54 26.79,-508.54 616.79,-508.54 616.79,-417.54 26.79,-417.54"/>
<text text-anchor="middle" x="321.79" y="-493.34" font-family="Times,serif" font-size="14.00">Experts (one per GPU)</text>
</g>
<!-- Input -->
<g id="node1" class="node">
<title>Input</title>
<polygon fill="none" stroke="black" points="352.79,-1473.08 86.79,-1473.08 86.79,-1421.08 352.79,-1421.08 352.79,-1473.08"/>
<text text-anchor="middle" x="219.79" y="-1461.08" font-family="Helvetica,sans-Serif" font-size="10.00">Input</text>
<text text-anchor="middle" x="219.79" y="-1450.08" font-family="Helvetica,sans-Serif" font-size="10.00">GPU:all</text>
<text text-anchor="middle" x="219.79" y="-1439.08" font-family="Helvetica,sans-Serif" font-size="10.00">Input:[batch_size=?,seq_len=4096,hidden=4096]</text>
<text text-anchor="middle" x="219.79" y="-1428.08" font-family="Helvetica,sans-Serif" font-size="10.00">Output:[batch_size=?,seq_len=4096,hidden=4096]</text>
</g>
<!-- LN1 -->
<g id="node2" class="node">
<title>LN1</title>
<polygon fill="none" stroke="black" points="271.29,-1382.08 168.29,-1382.08 168.29,-1330.08 271.29,-1330.08 271.29,-1382.08"/>
<text text-anchor="middle" x="219.79" y="-1370.08" font-family="Helvetica,sans-Serif" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="219.79" y="-1359.08" font-family="Helvetica,sans-Serif" font-size="10.00">GPU:all</text>
<text text-anchor="middle" x="219.79" y="-1348.08" font-family="Helvetica,sans-Serif" font-size="10.00">Input:[B,S,4096]</text>
<text text-anchor="middle" x="219.79" y="-1337.08" font-family="Helvetica,sans-Serif" font-size="10.00">Output:[B,S,4096]</text>
</g>
<!-- Input&#45;&gt;LN1 -->
<g id="edge1" class="edge">
<title>Input&#45;&gt;LN1</title>
<path fill="none" stroke="black" d="M219.79,-1420.81C219.79,-1411.91 219.79,-1401.73 219.79,-1392.16"/>
<polygon fill="black" stroke="black" points="223.29,-1392.1 219.79,-1382.1 216.29,-1392.1 223.29,-1392.1"/>
</g>
<!-- QKV -->
<g id="node3" class="node">
<title>QKV</title>
<polygon fill="none" stroke="black" points="274.29,-1294.08 165.29,-1294.08 165.29,-1242.08 274.29,-1242.08 274.29,-1294.08"/>
<text text-anchor="middle" x="219.79" y="-1282.08" font-family="Helvetica,sans-Serif" font-size="10.00">Linear QKV</text>
<text text-anchor="middle" x="219.79" y="-1271.08" font-family="Helvetica,sans-Serif" font-size="10.00">GPU:all</text>
<text text-anchor="middle" x="219.79" y="-1260.08" font-family="Helvetica,sans-Serif" font-size="10.00">Input:[B,S,4096]</text>
<text text-anchor="middle" x="219.79" y="-1249.08" font-family="Helvetica,sans-Serif" font-size="10.00">Output:[B,S,12288]</text>
</g>
<!-- LN1&#45;&gt;QKV -->
<g id="edge2" class="edge">
<title>LN1&#45;&gt;QKV</title>
<path fill="none" stroke="black" d="M219.79,-1329.74C219.79,-1321.78 219.79,-1312.84 219.79,-1304.32"/>
<polygon fill="black" stroke="black" points="223.29,-1304.23 219.79,-1294.23 216.29,-1304.23 223.29,-1304.23"/>
</g>
<!-- Reshape -->
<g id="node4" class="node">
<title>Reshape</title>
<polygon fill="none" stroke="black" points="282.79,-1206.08 156.79,-1206.08 156.79,-1154.08 282.79,-1154.08 282.79,-1206.08"/>
<text text-anchor="middle" x="219.79" y="-1194.08" font-family="Helvetica,sans-Serif" font-size="10.00">Reshape→[B,S,32,128]</text>
<text text-anchor="middle" x="219.79" y="-1183.08" font-family="Helvetica,sans-Serif" font-size="10.00">GPU:all</text>
<text text-anchor="middle" x="219.79" y="-1172.08" font-family="Helvetica,sans-Serif" font-size="10.00">Input:[B,S,12288]</text>
<text text-anchor="middle" x="219.79" y="-1161.08" font-family="Helvetica,sans-Serif" font-size="10.00">Output:[B,S,32,128]</text>
</g>
<!-- QKV&#45;&gt;Reshape -->
<g id="edge3" class="edge">
<title>QKV&#45;&gt;Reshape</title>
<path fill="none" stroke="black" d="M219.79,-1241.74C219.79,-1233.78 219.79,-1224.84 219.79,-1216.32"/>
<polygon fill="black" stroke="black" points="223.29,-1216.23 219.79,-1206.23 216.29,-1216.23 223.29,-1216.23"/>
</g>
<!-- Attn -->
<g id="node5" class="node">
<title>Attn</title>
<polygon fill="none" stroke="black" points="276.29,-1118.08 163.29,-1118.08 163.29,-1066.08 276.29,-1066.08 276.29,-1118.08"/>
<text text-anchor="middle" x="219.79" y="-1106.08" font-family="Helvetica,sans-Serif" font-size="10.00">Attention(32 heads)</text>
<text text-anchor="middle" x="219.79" y="-1095.08" font-family="Helvetica,sans-Serif" font-size="10.00">GPU:all</text>
<text text-anchor="middle" x="219.79" y="-1084.08" font-family="Helvetica,sans-Serif" font-size="10.00">Input:[B,S,32,128]</text>
<text text-anchor="middle" x="219.79" y="-1073.08" font-family="Helvetica,sans-Serif" font-size="10.00">Output:[B,S,32,128]</text>
</g>
<!-- Reshape&#45;&gt;Attn -->
<g id="edge4" class="edge">
<title>Reshape&#45;&gt;Attn</title>
<path fill="none" stroke="black" d="M219.79,-1153.74C219.79,-1145.78 219.79,-1136.84 219.79,-1128.32"/>
<polygon fill="black" stroke="black" points="223.29,-1128.23 219.79,-1118.23 216.29,-1128.23 223.29,-1128.23"/>
</g>
<!-- Proj -->
<g id="node6" class="node">
<title>Proj</title>
<polygon fill="none" stroke="black" points="271.29,-1030.08 168.29,-1030.08 168.29,-978.08 271.29,-978.08 271.29,-1030.08"/>
<text text-anchor="middle" x="219.79" y="-1018.08" font-family="Helvetica,sans-Serif" font-size="10.00">Linear Proj</text>
<text text-anchor="middle" x="219.79" y="-1007.08" font-family="Helvetica,sans-Serif" font-size="10.00">GPU:all</text>
<text text-anchor="middle" x="219.79" y="-996.08" font-family="Helvetica,sans-Serif" font-size="10.00">Input:[B,S,4096]</text>
<text text-anchor="middle" x="219.79" y="-985.08" font-family="Helvetica,sans-Serif" font-size="10.00">Output:[B,S,4096]</text>
</g>
<!-- Attn&#45;&gt;Proj -->
<g id="edge5" class="edge">
<title>Attn&#45;&gt;Proj</title>
<path fill="none" stroke="black" d="M219.79,-1065.74C219.79,-1057.78 219.79,-1048.84 219.79,-1040.32"/>
<polygon fill="black" stroke="black" points="223.29,-1040.23 219.79,-1030.23 216.29,-1040.23 223.29,-1040.23"/>
</g>
<!-- Add1 -->
<g id="node7" class="node">
<title>Add1</title>
<polygon fill="none" stroke="black" points="271.29,-942.08 168.29,-942.08 168.29,-890.08 271.29,-890.08 271.29,-942.08"/>
<text text-anchor="middle" x="219.79" y="-930.08" font-family="Helvetica,sans-Serif" font-size="10.00">Add</text>
<text text-anchor="middle" x="219.79" y="-919.08" font-family="Helvetica,sans-Serif" font-size="10.00">GPU:all</text>
<text text-anchor="middle" x="219.79" y="-908.08" font-family="Helvetica,sans-Serif" font-size="10.00">Input:[B,S,4096]</text>
<text text-anchor="middle" x="219.79" y="-897.08" font-family="Helvetica,sans-Serif" font-size="10.00">Output:[B,S,4096]</text>
</g>
<!-- Proj&#45;&gt;Add1 -->
<g id="edge6" class="edge">
<title>Proj&#45;&gt;Add1</title>
<path fill="none" stroke="black" d="M219.79,-977.74C219.79,-969.78 219.79,-960.84 219.79,-952.32"/>
<polygon fill="black" stroke="black" points="223.29,-952.23 219.79,-942.23 216.29,-952.23 223.29,-952.23"/>
</g>
<!-- LN2 -->
<g id="node8" class="node">
<title>LN2</title>
<polygon fill="none" stroke="black" points="271.29,-854.08 168.29,-854.08 168.29,-802.08 271.29,-802.08 271.29,-854.08"/>
<text text-anchor="middle" x="219.79" y="-842.08" font-family="Helvetica,sans-Serif" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="219.79" y="-831.08" font-family="Helvetica,sans-Serif" font-size="10.00">GPU:all</text>
<text text-anchor="middle" x="219.79" y="-820.08" font-family="Helvetica,sans-Serif" font-size="10.00">Input:[B,S,4096]</text>
<text text-anchor="middle" x="219.79" y="-809.08" font-family="Helvetica,sans-Serif" font-size="10.00">Output:[B,S,4096]</text>
</g>
<!-- Add1&#45;&gt;LN2 -->
<g id="edge7" class="edge">
<title>Add1&#45;&gt;LN2</title>
<path fill="none" stroke="black" d="M219.79,-889.74C219.79,-881.78 219.79,-872.84 219.79,-864.32"/>
<polygon fill="black" stroke="black" points="223.29,-864.23 219.79,-854.23 216.29,-864.23 223.29,-864.23"/>
</g>
<!-- Gate -->
<g id="node9" class="node">
<title>Gate</title>
<polygon fill="none" stroke="black" points="237.29,-766.08 112.29,-766.08 112.29,-714.08 237.29,-714.08 237.29,-766.08"/>
<text text-anchor="middle" x="174.79" y="-754.08" font-family="Helvetica,sans-Serif" font-size="10.00">Gate Linear(4096→64)</text>
<text text-anchor="middle" x="174.79" y="-743.08" font-family="Helvetica,sans-Serif" font-size="10.00">GPU:all</text>
<text text-anchor="middle" x="174.79" y="-732.08" font-family="Helvetica,sans-Serif" font-size="10.00">Input:[B,S,4096]</text>
<text text-anchor="middle" x="174.79" y="-721.08" font-family="Helvetica,sans-Serif" font-size="10.00">Output:[B,S,64]</text>
</g>
<!-- LN2&#45;&gt;Gate -->
<g id="edge8" class="edge">
<title>LN2&#45;&gt;Gate</title>
<path fill="none" stroke="black" d="M206.53,-801.74C202.18,-793.43 197.27,-784.05 192.64,-775.2"/>
<polygon fill="black" stroke="black" points="195.69,-773.47 187.95,-766.23 189.48,-776.72 195.69,-773.47"/>
</g>
<!-- Scatter -->
<g id="node11" class="node">
<title>Scatter</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="265.79" cy="-553.31" rx="125.32" ry="36.54"/>
<text text-anchor="middle" x="265.79" y="-567.31" font-family="Helvetica,sans-Serif" font-size="10.00">All&#45;to&#45;All Scatter</text>
<text text-anchor="middle" x="265.79" y="-556.31" font-family="Helvetica,sans-Serif" font-size="10.00">GPU:all→target</text>
<text text-anchor="middle" x="265.79" y="-545.31" font-family="Helvetica,sans-Serif" font-size="10.00">Input:[B,S,4096]</text>
<text text-anchor="middle" x="265.79" y="-534.31" font-family="Helvetica,sans-Serif" font-size="10.00">Output:[tokens_per_expert,4096]</text>
</g>
<!-- LN2&#45;&gt;Scatter -->
<g id="edge10" class="edge">
<title>LN2&#45;&gt;Scatter</title>
<path fill="none" stroke="black" d="M233.14,-801.93C238.26,-791.17 243.62,-778.3 246.79,-766.08 261.22,-710.28 265.11,-643.78 265.96,-600.38"/>
<polygon fill="black" stroke="black" points="269.46,-600.18 266.11,-590.13 262.46,-600.08 269.46,-600.18"/>
</g>
<!-- Softmax -->
<g id="node10" class="node">
<title>Softmax</title>
<polygon fill="none" stroke="black" points="226.79,-678.08 122.79,-678.08 122.79,-626.08 226.79,-626.08 226.79,-678.08"/>
<text text-anchor="middle" x="174.79" y="-666.08" font-family="Helvetica,sans-Serif" font-size="10.00">Softmax(top&#45;k=2)</text>
<text text-anchor="middle" x="174.79" y="-655.08" font-family="Helvetica,sans-Serif" font-size="10.00">GPU:all</text>
<text text-anchor="middle" x="174.79" y="-644.08" font-family="Helvetica,sans-Serif" font-size="10.00">Input:[B,S,64]</text>
<text text-anchor="middle" x="174.79" y="-633.08" font-family="Helvetica,sans-Serif" font-size="10.00">Output:[B,S,64]</text>
</g>
<!-- Gate&#45;&gt;Softmax -->
<g id="edge9" class="edge">
<title>Gate&#45;&gt;Softmax</title>
<path fill="none" stroke="black" d="M174.79,-713.74C174.79,-705.78 174.79,-696.84 174.79,-688.32"/>
<polygon fill="black" stroke="black" points="178.29,-688.23 174.79,-678.23 171.29,-688.23 178.29,-688.23"/>
</g>
<!-- Softmax&#45;&gt;Scatter -->
<g id="edge11" class="edge">
<title>Softmax&#45;&gt;Scatter</title>
<path fill="none" stroke="black" d="M198.46,-625.91C207.02,-616.8 216.93,-606.26 226.47,-596.12"/>
<polygon fill="black" stroke="black" points="229.03,-598.51 233.33,-588.83 223.93,-593.71 229.03,-598.51"/>
</g>
<!-- WeightedSum -->
<g id="node18" class="node">
<title>WeightedSum</title>
<polygon fill="none" stroke="black" points="213.36,-280 43.83,-280 0.21,-176 169.75,-176 213.36,-280"/>
<text text-anchor="middle" x="106.79" y="-242" font-family="Helvetica,sans-Serif" font-size="10.00">Weighted Sum</text>
<text text-anchor="middle" x="106.79" y="-231" font-family="Helvetica,sans-Serif" font-size="10.00">GPU:all</text>
<text text-anchor="middle" x="106.79" y="-220" font-family="Helvetica,sans-Serif" font-size="10.00">Input:[B,S,4096]</text>
<text text-anchor="middle" x="106.79" y="-209" font-family="Helvetica,sans-Serif" font-size="10.00">Output:[B,S,4096]</text>
</g>
<!-- Softmax&#45;&gt;WeightedSum -->
<g id="edge23" class="edge">
<title>Softmax&#45;&gt;WeightedSum</title>
<path fill="none" stroke="black" d="M132.88,-626.05C96.09,-601.39 45.07,-559.99 22.79,-508.54 -8.92,-435.34 30.13,-346.46 64.91,-288.87"/>
<polygon fill="black" stroke="black" points="67.95,-290.6 70.22,-280.25 61.99,-286.93 67.95,-290.6"/>
</g>
<!-- Exp0 -->
<g id="node12" class="node">
<title>Exp0</title>
<polygon fill="none" stroke="black" points="608.29,-477.54 509.29,-477.54 509.29,-425.54 608.29,-425.54 608.29,-477.54"/>
<text text-anchor="middle" x="558.79" y="-465.54" font-family="Helvetica,sans-Serif" font-size="10.00">Expert&#45;0 MLP</text>
<text text-anchor="middle" x="558.79" y="-454.54" font-family="Helvetica,sans-Serif" font-size="10.00">GPU:0</text>
<text text-anchor="middle" x="558.79" y="-443.54" font-family="Helvetica,sans-Serif" font-size="10.00">Input:[T0,4096]</text>
<text text-anchor="middle" x="558.79" y="-432.54" font-family="Helvetica,sans-Serif" font-size="10.00">Output:[T0,4096]</text>
</g>
<!-- Scatter&#45;&gt;Exp0 -->
<g id="edge12" class="edge">
<title>Scatter&#45;&gt;Exp0</title>
<path fill="none" stroke="black" d="M386.74,-543.48C424.78,-537.18 465.93,-526.51 500.79,-508.54 512.06,-502.73 522.62,-494.01 531.56,-485.18"/>
<polygon fill="black" stroke="black" points="534.26,-487.42 538.67,-477.79 529.21,-482.57 534.26,-487.42"/>
</g>
<!-- Exp1 -->
<g id="node13" class="node">
<title>Exp1</title>
<polygon fill="none" stroke="black" points="491.29,-477.54 392.29,-477.54 392.29,-425.54 491.29,-425.54 491.29,-477.54"/>
<text text-anchor="middle" x="441.79" y="-465.54" font-family="Helvetica,sans-Serif" font-size="10.00">Expert&#45;1 MLP</text>
<text text-anchor="middle" x="441.79" y="-454.54" font-family="Helvetica,sans-Serif" font-size="10.00">GPU:1</text>
<text text-anchor="middle" x="441.79" y="-443.54" font-family="Helvetica,sans-Serif" font-size="10.00">Input:[T1,4096]</text>
<text text-anchor="middle" x="441.79" y="-432.54" font-family="Helvetica,sans-Serif" font-size="10.00">Output:[T1,4096]</text>
</g>
<!-- Scatter&#45;&gt;Exp1 -->
<g id="edge13" class="edge">
<title>Scatter&#45;&gt;Exp1</title>
<path fill="none" stroke="black" d="M350.04,-525.97C361.75,-520.92 373.34,-515.11 383.79,-508.54 394.24,-501.96 404.39,-493.26 413.19,-484.68"/>
<polygon fill="black" stroke="black" points="415.7,-487.12 420.24,-477.55 410.72,-482.2 415.7,-487.12"/>
</g>
<!-- Exp2 -->
<g id="node14" class="node">
<title>Exp2</title>
<polygon fill="none" stroke="black" points="374.29,-477.54 275.29,-477.54 275.29,-425.54 374.29,-425.54 374.29,-477.54"/>
<text text-anchor="middle" x="324.79" y="-465.54" font-family="Helvetica,sans-Serif" font-size="10.00">Expert&#45;2 MLP</text>
<text text-anchor="middle" x="324.79" y="-454.54" font-family="Helvetica,sans-Serif" font-size="10.00">GPU:2</text>
<text text-anchor="middle" x="324.79" y="-443.54" font-family="Helvetica,sans-Serif" font-size="10.00">Input:[T2,4096]</text>
<text text-anchor="middle" x="324.79" y="-432.54" font-family="Helvetica,sans-Serif" font-size="10.00">Output:[T2,4096]</text>
</g>
<!-- Scatter&#45;&gt;Exp2 -->
<g id="edge14" class="edge">
<title>Scatter&#45;&gt;Exp2</title>
<path fill="none" stroke="black" d="M286.75,-516.85C292.64,-506.9 299.01,-496.12 304.84,-486.27"/>
<polygon fill="black" stroke="black" points="307.92,-487.94 310,-477.55 301.89,-484.37 307.92,-487.94"/>
</g>
<!-- Exp3 -->
<g id="node15" class="node">
<title>Exp3</title>
<polygon fill="none" stroke="black" points="257.29,-477.54 158.29,-477.54 158.29,-425.54 257.29,-425.54 257.29,-477.54"/>
<text text-anchor="middle" x="207.79" y="-465.54" font-family="Helvetica,sans-Serif" font-size="10.00">Expert&#45;3 MLP</text>
<text text-anchor="middle" x="207.79" y="-454.54" font-family="Helvetica,sans-Serif" font-size="10.00">GPU:3</text>
<text text-anchor="middle" x="207.79" y="-443.54" font-family="Helvetica,sans-Serif" font-size="10.00">Input:[T3,4096]</text>
<text text-anchor="middle" x="207.79" y="-432.54" font-family="Helvetica,sans-Serif" font-size="10.00">Output:[T3,4096]</text>
</g>
<!-- Scatter&#45;&gt;Exp3 -->
<g id="edge15" class="edge">
<title>Scatter&#45;&gt;Exp3</title>
<path fill="none" stroke="black" d="M245.17,-516.85C239.39,-506.9 233.12,-496.12 227.4,-486.27"/>
<polygon fill="black" stroke="black" points="230.37,-484.43 222.32,-477.55 224.32,-487.95 230.37,-484.43"/>
</g>
<!-- Exp63 -->
<g id="node16" class="node">
<title>Exp63</title>
<polygon fill="none" stroke="black" points="140.29,-477.54 35.29,-477.54 35.29,-425.54 140.29,-425.54 140.29,-477.54"/>
<text text-anchor="middle" x="87.79" y="-465.54" font-family="Helvetica,sans-Serif" font-size="10.00">Expert&#45;63 MLP</text>
<text text-anchor="middle" x="87.79" y="-454.54" font-family="Helvetica,sans-Serif" font-size="10.00">GPU:63</text>
<text text-anchor="middle" x="87.79" y="-443.54" font-family="Helvetica,sans-Serif" font-size="10.00">Input:[T63,4096]</text>
<text text-anchor="middle" x="87.79" y="-432.54" font-family="Helvetica,sans-Serif" font-size="10.00">Output:[T63,4096]</text>
</g>
<!-- Scatter&#45;&gt;Exp63 -->
<g id="edge16" class="edge">
<title>Scatter&#45;&gt;Exp63</title>
<path fill="none" stroke="black" d="M183.16,-525.53C171.62,-520.54 160.17,-514.87 149.79,-508.54 138.95,-501.93 128.28,-493.3 118.93,-484.8"/>
<polygon fill="black" stroke="black" points="121.09,-482.03 111.4,-477.73 116.3,-487.13 121.09,-482.03"/>
</g>
<!-- Gather -->
<g id="node17" class="node">
<title>Gather</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="265.79" cy="-352.77" rx="119.5" ry="36.54"/>
<text text-anchor="middle" x="265.79" y="-366.77" font-family="Helvetica,sans-Serif" font-size="10.00">All&#45;to&#45;All Gather</text>
<text text-anchor="middle" x="265.79" y="-355.77" font-family="Helvetica,sans-Serif" font-size="10.00">GPU:target→all</text>
<text text-anchor="middle" x="265.79" y="-344.77" font-family="Helvetica,sans-Serif" font-size="10.00">Input:[tokens_per_expert,4096]</text>
<text text-anchor="middle" x="265.79" y="-333.77" font-family="Helvetica,sans-Serif" font-size="10.00">Output:[B,S,4096]</text>
</g>
<!-- Exp0&#45;&gt;Gather -->
<g id="edge17" class="edge">
<title>Exp0&#45;&gt;Gather</title>
<path fill="none" stroke="black" d="M517.6,-425.45C512.05,-422.56 506.35,-419.84 500.79,-417.54 459.99,-400.72 413.4,-387.01 372.51,-376.68"/>
<polygon fill="black" stroke="black" points="373.34,-373.28 362.79,-374.26 371.65,-380.07 373.34,-373.28"/>
</g>
<!-- Exp1&#45;&gt;Gather -->
<g id="edge18" class="edge">
<title>Exp1&#45;&gt;Gather</title>
<path fill="none" stroke="black" d="M397.82,-425.39C393.09,-422.73 388.34,-420.07 383.79,-417.54 367.46,-408.49 349.79,-398.85 333.22,-389.88"/>
<polygon fill="black" stroke="black" points="334.6,-386.65 324.14,-384.98 331.28,-392.81 334.6,-386.65"/>
</g>
<!-- Exp2&#45;&gt;Gather -->
<g id="edge19" class="edge">
<title>Exp2&#45;&gt;Gather</title>
<path fill="none" stroke="black" d="M309.44,-425.37C304.26,-416.88 298.32,-407.14 292.53,-397.63"/>
<polygon fill="black" stroke="black" points="295.47,-395.73 287.27,-389.01 289.49,-399.37 295.47,-395.73"/>
</g>
<!-- Exp3&#45;&gt;Gather -->
<g id="edge20" class="edge">
<title>Exp3&#45;&gt;Gather</title>
<path fill="none" stroke="black" d="M222.87,-425.37C227.96,-416.88 233.8,-407.14 239.49,-397.63"/>
<polygon fill="black" stroke="black" points="242.52,-399.39 244.66,-389.01 236.52,-395.79 242.52,-399.39"/>
</g>
<!-- Exp63&#45;&gt;Gather -->
<g id="edge21" class="edge">
<title>Exp63&#45;&gt;Gather</title>
<path fill="none" stroke="black" d="M134.09,-425.37C154.01,-414.54 177.66,-401.68 199.39,-389.86"/>
<polygon fill="black" stroke="black" points="201.14,-392.9 208.25,-385.05 197.79,-386.75 201.14,-392.9"/>
</g>
<!-- Gather&#45;&gt;WeightedSum -->
<g id="edge22" class="edge">
<title>Gather&#45;&gt;WeightedSum</title>
<path fill="none" stroke="black" d="M222.34,-318.22C209.58,-308.37 195.25,-297.31 181.13,-286.41"/>
<polygon fill="black" stroke="black" points="182.92,-283.36 172.86,-280.02 178.64,-288.9 182.92,-283.36"/>
</g>
<!-- Add2 -->
<g id="node19" class="node">
<title>Add2</title>
<polygon fill="none" stroke="black" points="158.29,-140 55.29,-140 55.29,-88 158.29,-88 158.29,-140"/>
<text text-anchor="middle" x="106.79" y="-128" font-family="Helvetica,sans-Serif" font-size="10.00">Add</text>
<text text-anchor="middle" x="106.79" y="-117" font-family="Helvetica,sans-Serif" font-size="10.00">GPU:all</text>
<text text-anchor="middle" x="106.79" y="-106" font-family="Helvetica,sans-Serif" font-size="10.00">Input:[B,S,4096]</text>
<text text-anchor="middle" x="106.79" y="-95" font-family="Helvetica,sans-Serif" font-size="10.00">Output:[B,S,4096]</text>
</g>
<!-- WeightedSum&#45;&gt;Add2 -->
<g id="edge24" class="edge">
<title>WeightedSum&#45;&gt;Add2</title>
<path fill="none" stroke="black" d="M106.79,-175.92C106.79,-167.25 106.79,-158.43 106.79,-150.29"/>
<polygon fill="black" stroke="black" points="110.29,-150.04 106.79,-140.04 103.29,-150.04 110.29,-150.04"/>
</g>
<!-- Output -->
<g id="node20" class="node">
<title>Output</title>
<polygon fill="none" stroke="black" points="158.29,-52 55.29,-52 55.29,0 158.29,0 158.29,-52"/>
<text text-anchor="middle" x="106.79" y="-40" font-family="Helvetica,sans-Serif" font-size="10.00">Output</text>
<text text-anchor="middle" x="106.79" y="-29" font-family="Helvetica,sans-Serif" font-size="10.00">GPU:all</text>
<text text-anchor="middle" x="106.79" y="-18" font-family="Helvetica,sans-Serif" font-size="10.00">Input:[B,S,4096]</text>
<text text-anchor="middle" x="106.79" y="-7" font-family="Helvetica,sans-Serif" font-size="10.00">Output:[B,S,4096]</text>
</g>
<!-- Add2&#45;&gt;Output -->
<g id="edge25" class="edge">
<title>Add2&#45;&gt;Output</title>
<path fill="none" stroke="black" d="M106.79,-87.66C106.79,-79.7 106.79,-70.76 106.79,-62.24"/>
<polygon fill="black" stroke="black" points="110.29,-62.16 106.79,-52.16 103.29,-62.16 110.29,-62.16"/>
</g>
</g>
</svg>
