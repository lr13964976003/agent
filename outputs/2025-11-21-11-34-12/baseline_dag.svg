<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_transformer_dag Pages: 1 -->
<svg width="1440pt" height="1556pt"
 viewBox="0.00 0.00 1440.00 1555.60" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.13 0.13) rotate(0) translate(4 12269.5)">
<title>baseline_transformer_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-12269.5 11357.43,-12269.5 11357.43,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgreen" stroke="black" points="976.3,-12265.5 219.51,-12265.5 24.82,-12129.5 781.62,-12129.5 976.3,-12265.5"/>
<text text-anchor="middle" x="500.56" y="-12216.3" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="500.56" y="-12201.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="500.56" y="-12186.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="500.56" y="-12171.3" font-family="Times,serif" font-size="14.00">GPU: Host</text>
</g>
<!-- stage0_start -->
<g id="node2" class="node">
<title>stage0_start</title>
<polygon fill="lightgreen" stroke="black" points="639.41,-12093.5 418.53,-12093.5 361.71,-11987.5 582.59,-11987.5 639.41,-12093.5"/>
<text text-anchor="middle" x="500.56" y="-12051.8" font-family="Times,serif" font-size="14.00">Pipeline Stage 0</text>
<text text-anchor="middle" x="500.56" y="-12036.8" font-family="Times,serif" font-size="14.00">Layers 0&#45;7</text>
<text text-anchor="middle" x="500.56" y="-12021.8" font-family="Times,serif" font-size="14.00">Devices: 0&#45;7</text>
</g>
<!-- input&#45;&gt;stage0_start -->
<g id="edge1" class="edge">
<title>input&#45;&gt;stage0_start</title>
<path fill="none" stroke="black" d="M500.56,-12129.41C500.56,-12120.92 500.56,-12112.26 500.56,-12103.84"/>
<polygon fill="black" stroke="black" points="504.06,-12103.73 500.56,-12093.73 497.06,-12103.73 504.06,-12103.73"/>
</g>
<!-- layer_0_norm -->
<g id="node3" class="node">
<title>layer_0_norm</title>
<polygon fill="lightblue" stroke="black" points="730.06,-11951.5 271.06,-11951.5 271.06,-11883.5 730.06,-11883.5 730.06,-11951.5"/>
<text text-anchor="middle" x="500.56" y="-11936.3" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 0)</text>
<text text-anchor="middle" x="500.56" y="-11921.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="500.56" y="-11906.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="500.56" y="-11891.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- stage0_start&#45;&gt;layer_0_norm -->
<g id="edge2" class="edge">
<title>stage0_start&#45;&gt;layer_0_norm</title>
<path fill="none" stroke="black" d="M500.56,-11987.48C500.56,-11978.92 500.56,-11970.13 500.56,-11961.82"/>
<polygon fill="black" stroke="black" points="504.06,-11961.59 500.56,-11951.59 497.06,-11961.59 504.06,-11961.59"/>
</g>
<!-- layer_0_attn -->
<g id="node4" class="node">
<title>layer_0_attn</title>
<polygon fill="lightblue" stroke="black" points="599.56,-11847.5 149.56,-11847.5 149.56,-11764.5 599.56,-11764.5 599.56,-11847.5"/>
<text text-anchor="middle" x="374.56" y="-11832.3" font-family="Times,serif" font-size="14.00">MHA&#45;TP (Layer 0)</text>
<text text-anchor="middle" x="374.56" y="-11817.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="374.56" y="-11802.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="374.56" y="-11787.3" font-family="Times,serif" font-size="14.00">Per GPU: 4 heads, head_dim=128</text>
<text text-anchor="middle" x="374.56" y="-11772.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_0_norm&#45;&gt;layer_0_attn -->
<g id="edge3" class="edge">
<title>layer_0_norm&#45;&gt;layer_0_attn</title>
<path fill="none" stroke="black" d="M462.42,-11883.34C451.94,-11874.24 440.37,-11864.19 429.17,-11854.45"/>
<polygon fill="black" stroke="black" points="431.33,-11851.69 421.48,-11847.77 426.74,-11856.97 431.33,-11851.69"/>
</g>
<!-- layer_0_residual1 -->
<g id="node6" class="node">
<title>layer_0_residual1</title>
<polygon fill="lightblue" stroke="black" points="920.06,-11596.33 81.06,-11596.33 81.06,-11528.33 920.06,-11528.33 920.06,-11596.33"/>
<text text-anchor="middle" x="500.56" y="-11581.13" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="500.56" y="-11566.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="500.56" y="-11551.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="500.56" y="-11536.13" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_0_norm&#45;&gt;layer_0_residual1 -->
<g id="edge5" class="edge">
<title>layer_0_norm&#45;&gt;layer_0_residual1</title>
<path fill="none" stroke="black" d="M566.41,-11883.35C581.69,-11873.4 596.88,-11861.36 608.56,-11847.5 671.81,-11772.41 712.33,-11714.48 658.56,-11632.33 650.64,-11620.22 640.07,-11610.23 628.14,-11601.98"/>
<polygon fill="black" stroke="black" points="629.99,-11599 619.69,-11596.54 626.21,-11604.89 629.99,-11599"/>
</g>
<!-- layer_0_attn_reduce -->
<g id="node5" class="node">
<title>layer_0_attn_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="324.56" cy="-11680.41" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="324.56" y="-11699.21" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="324.56" y="-11684.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="324.56" y="-11669.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="324.56" y="-11654.21" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_0_attn&#45;&gt;layer_0_attn_reduce -->
<g id="edge4" class="edge">
<title>layer_0_attn&#45;&gt;layer_0_attn_reduce</title>
<path fill="none" stroke="black" d="M358.05,-11764.19C354.67,-11755.82 351.05,-11746.88 347.48,-11738.07"/>
<polygon fill="black" stroke="black" points="350.65,-11736.56 343.65,-11728.6 344.16,-11739.19 350.65,-11736.56"/>
</g>
<!-- layer_0_attn_reduce&#45;&gt;layer_0_residual1 -->
<g id="edge6" class="edge">
<title>layer_0_attn_reduce&#45;&gt;layer_0_residual1</title>
<path fill="none" stroke="black" d="M394.37,-11633.37C410.02,-11623.05 426.47,-11612.2 441.62,-11602.21"/>
<polygon fill="black" stroke="black" points="443.95,-11604.86 450.37,-11596.43 440.1,-11599.02 443.95,-11604.86"/>
</g>
<!-- layer_0_norm2 -->
<g id="node7" class="node">
<title>layer_0_norm2</title>
<polygon fill="lightblue" stroke="black" points="906.06,-11492.33 447.06,-11492.33 447.06,-11424.33 906.06,-11424.33 906.06,-11492.33"/>
<text text-anchor="middle" x="676.56" y="-11477.13" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 0)</text>
<text text-anchor="middle" x="676.56" y="-11462.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="676.56" y="-11447.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="676.56" y="-11432.13" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_0_residual1&#45;&gt;layer_0_norm2 -->
<g id="edge7" class="edge">
<title>layer_0_residual1&#45;&gt;layer_0_norm2</title>
<path fill="none" stroke="black" d="M557.7,-11528.21C574.54,-11518.45 593.11,-11507.69 610.46,-11497.64"/>
<polygon fill="black" stroke="black" points="612.51,-11500.5 619.41,-11492.45 609,-11494.44 612.51,-11500.5"/>
</g>
<!-- layer_0_residual2 -->
<g id="node10" class="node">
<title>layer_0_residual2</title>
<polygon fill="lightblue" stroke="black" points="922.06,-11144.66 83.06,-11144.66 83.06,-11076.66 922.06,-11076.66 922.06,-11144.66"/>
<text text-anchor="middle" x="502.56" y="-11129.46" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="502.56" y="-11114.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="502.56" y="-11099.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="502.56" y="-11084.46" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_0_residual1&#45;&gt;layer_0_residual2 -->
<g id="edge10" class="edge">
<title>layer_0_residual1&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M463.97,-11528.24C454.11,-11517.64 444.32,-11505.27 437.56,-11492.33 374.26,-11371.07 326.7,-11309.13 390.56,-11188.16 398.3,-11173.5 410.25,-11161.12 423.51,-11150.88"/>
<polygon fill="black" stroke="black" points="425.88,-11153.48 431.91,-11144.77 421.77,-11147.82 425.88,-11153.48"/>
</g>
<!-- layer_0_mlp -->
<g id="node8" class="node">
<title>layer_0_mlp</title>
<polygon fill="lightblue" stroke="black" points="954.06,-11388.33 495.06,-11388.33 495.06,-11320.33 954.06,-11320.33 954.06,-11388.33"/>
<text text-anchor="middle" x="724.56" y="-11373.13" font-family="Times,serif" font-size="14.00">MLP&#45;TP (Layer 0)</text>
<text text-anchor="middle" x="724.56" y="-11358.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="724.56" y="-11343.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="724.56" y="-11328.13" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_0_norm2&#45;&gt;layer_0_mlp -->
<g id="edge8" class="edge">
<title>layer_0_norm2&#45;&gt;layer_0_mlp</title>
<path fill="none" stroke="black" d="M692.15,-11424.21C696.13,-11415.75 700.46,-11406.54 704.63,-11397.68"/>
<polygon fill="black" stroke="black" points="707.8,-11399.17 708.89,-11388.63 701.47,-11396.19 707.8,-11399.17"/>
</g>
<!-- layer_0_mlp_reduce -->
<g id="node9" class="node">
<title>layer_0_mlp_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="724.56" cy="-11236.25" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="724.56" y="-11255.05" font-family="Times,serif" font-size="14.00">All&#45;Reduce MLP</text>
<text text-anchor="middle" x="724.56" y="-11240.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="724.56" y="-11225.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="724.56" y="-11210.05" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_0_mlp&#45;&gt;layer_0_mlp_reduce -->
<g id="edge9" class="edge">
<title>layer_0_mlp&#45;&gt;layer_0_mlp_reduce</title>
<path fill="none" stroke="black" d="M724.56,-11320.06C724.56,-11312.07 724.56,-11303.3 724.56,-11294.56"/>
<polygon fill="black" stroke="black" points="728.06,-11294.36 724.56,-11284.36 721.06,-11294.36 728.06,-11294.36"/>
</g>
<!-- layer_1_norm -->
<g id="node11" class="node">
<title>layer_1_norm</title>
<polygon fill="lightblue" stroke="black" points="1526.06,-11270.25 1067.06,-11270.25 1067.06,-11202.25 1526.06,-11202.25 1526.06,-11270.25"/>
<text text-anchor="middle" x="1296.56" y="-11255.05" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 1)</text>
<text text-anchor="middle" x="1296.56" y="-11240.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1296.56" y="-11225.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1296.56" y="-11210.05" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_0_mlp&#45;&gt;layer_1_norm -->
<g id="edge12" class="edge">
<title>layer_0_mlp&#45;&gt;layer_1_norm</title>
<path fill="none" stroke="black" d="M887.33,-11320.3C961.13,-11305.32 1048.46,-11287.6 1123.46,-11272.38"/>
<polygon fill="black" stroke="black" points="1124.38,-11275.76 1133.49,-11270.34 1122.99,-11268.9 1124.38,-11275.76"/>
</g>
<!-- layer_0_mlp_reduce&#45;&gt;layer_0_residual2 -->
<g id="edge11" class="edge">
<title>layer_0_mlp_reduce&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M642.53,-11189.58C618.98,-11176.47 593.55,-11162.31 570.92,-11149.71"/>
<polygon fill="black" stroke="black" points="572.5,-11146.59 562.06,-11144.79 569.1,-11152.71 572.5,-11146.59"/>
</g>
<!-- layer_1_attn -->
<g id="node12" class="node">
<title>layer_1_attn</title>
<polygon fill="lightblue" stroke="black" points="1455.56,-11152.16 1005.56,-11152.16 1005.56,-11069.16 1455.56,-11069.16 1455.56,-11152.16"/>
<text text-anchor="middle" x="1230.56" y="-11136.96" font-family="Times,serif" font-size="14.00">MHA&#45;TP (Layer 1)</text>
<text text-anchor="middle" x="1230.56" y="-11121.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="1230.56" y="-11106.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="1230.56" y="-11091.96" font-family="Times,serif" font-size="14.00">Per GPU: 4 heads, head_dim=128</text>
<text text-anchor="middle" x="1230.56" y="-11076.96" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_1_norm&#45;&gt;layer_1_attn -->
<g id="edge13" class="edge">
<title>layer_1_norm&#45;&gt;layer_1_attn</title>
<path fill="none" stroke="black" d="M1278.88,-11202.13C1272.17,-11189.58 1264.39,-11175 1257.05,-11161.26"/>
<polygon fill="black" stroke="black" points="1260.1,-11159.55 1252.31,-11152.38 1253.93,-11162.85 1260.1,-11159.55"/>
</g>
<!-- layer_1_residual1 -->
<g id="node14" class="node">
<title>layer_1_residual1</title>
<polygon fill="lightblue" stroke="black" points="1776.06,-10901 937.06,-10901 937.06,-10833 1776.06,-10833 1776.06,-10901"/>
<text text-anchor="middle" x="1356.56" y="-10885.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1356.56" y="-10870.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1356.56" y="-10855.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1356.56" y="-10840.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_1_norm&#45;&gt;layer_1_residual1 -->
<g id="edge15" class="edge">
<title>layer_1_norm&#45;&gt;layer_1_residual1</title>
<path fill="none" stroke="black" d="M1392.44,-11202.24C1418.37,-11189.73 1444.72,-11173.26 1464.56,-11152.16 1503.86,-11110.37 1503.23,-11089.4 1514.56,-11033.16 1523.01,-10991.26 1537.97,-10972.76 1514.56,-10937 1506.64,-10924.89 1496.07,-10914.89 1484.14,-10906.64"/>
<polygon fill="black" stroke="black" points="1485.99,-10903.67 1475.69,-10901.21 1482.21,-10909.56 1485.99,-10903.67"/>
</g>
<!-- layer_1_attn_reduce -->
<g id="node13" class="node">
<title>layer_1_attn_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="1180.56" cy="-10985.08" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="1180.56" y="-11003.88" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1180.56" y="-10988.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="1180.56" y="-10973.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1180.56" y="-10958.88" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_1_attn&#45;&gt;layer_1_attn_reduce -->
<g id="edge14" class="edge">
<title>layer_1_attn&#45;&gt;layer_1_attn_reduce</title>
<path fill="none" stroke="black" d="M1214.05,-11068.85C1210.67,-11060.49 1207.05,-11051.54 1203.48,-11042.74"/>
<polygon fill="black" stroke="black" points="1206.65,-11041.23 1199.65,-11033.27 1200.16,-11043.85 1206.65,-11041.23"/>
</g>
<!-- layer_1_attn_reduce&#45;&gt;layer_1_residual1 -->
<g id="edge16" class="edge">
<title>layer_1_attn_reduce&#45;&gt;layer_1_residual1</title>
<path fill="none" stroke="black" d="M1250.37,-10938.03C1266.02,-10927.71 1282.47,-10916.87 1297.62,-10906.87"/>
<polygon fill="black" stroke="black" points="1299.95,-10909.53 1306.37,-10901.1 1296.1,-10903.68 1299.95,-10909.53"/>
</g>
<!-- layer_1_norm2 -->
<g id="node15" class="node">
<title>layer_1_norm2</title>
<polygon fill="lightblue" stroke="black" points="1762.06,-10797 1303.06,-10797 1303.06,-10729 1762.06,-10729 1762.06,-10797"/>
<text text-anchor="middle" x="1532.56" y="-10781.8" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 1)</text>
<text text-anchor="middle" x="1532.56" y="-10766.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1532.56" y="-10751.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1532.56" y="-10736.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_1_residual1&#45;&gt;layer_1_norm2 -->
<g id="edge17" class="edge">
<title>layer_1_residual1&#45;&gt;layer_1_norm2</title>
<path fill="none" stroke="black" d="M1413.7,-10832.88C1430.54,-10823.12 1449.11,-10812.36 1466.46,-10802.31"/>
<polygon fill="black" stroke="black" points="1468.51,-10805.16 1475.41,-10797.12 1465,-10799.11 1468.51,-10805.16"/>
</g>
<!-- layer_1_residual2 -->
<g id="node18" class="node">
<title>layer_1_residual2</title>
<polygon fill="lightblue" stroke="black" points="1777.06,-10449.33 938.06,-10449.33 938.06,-10381.33 1777.06,-10381.33 1777.06,-10449.33"/>
<text text-anchor="middle" x="1357.56" y="-10434.13" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1357.56" y="-10419.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1357.56" y="-10404.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1357.56" y="-10389.13" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_1_residual1&#45;&gt;layer_1_residual2 -->
<g id="edge20" class="edge">
<title>layer_1_residual1&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M1319.97,-10832.91C1310.11,-10822.31 1300.32,-10809.94 1293.56,-10797 1230.26,-10675.73 1182.95,-10613.93 1246.56,-10492.83 1254.27,-10478.16 1266.2,-10465.75 1279.44,-10455.48"/>
<polygon fill="black" stroke="black" points="1281.81,-10458.08 1287.82,-10449.36 1277.68,-10452.43 1281.81,-10458.08"/>
</g>
<!-- layer_1_mlp -->
<g id="node16" class="node">
<title>layer_1_mlp</title>
<polygon fill="lightblue" stroke="black" points="1810.06,-10693 1351.06,-10693 1351.06,-10625 1810.06,-10625 1810.06,-10693"/>
<text text-anchor="middle" x="1580.56" y="-10677.8" font-family="Times,serif" font-size="14.00">MLP&#45;TP (Layer 1)</text>
<text text-anchor="middle" x="1580.56" y="-10662.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="1580.56" y="-10647.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="1580.56" y="-10632.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_1_norm2&#45;&gt;layer_1_mlp -->
<g id="edge18" class="edge">
<title>layer_1_norm2&#45;&gt;layer_1_mlp</title>
<path fill="none" stroke="black" d="M1548.15,-10728.88C1552.13,-10720.42 1556.46,-10711.2 1560.63,-10702.35"/>
<polygon fill="black" stroke="black" points="1563.8,-10703.83 1564.89,-10693.3 1557.47,-10700.85 1563.8,-10703.83"/>
</g>
<!-- layer_1_mlp_reduce -->
<g id="node17" class="node">
<title>layer_1_mlp_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="1580.56" cy="-10540.91" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="1580.56" y="-10559.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce MLP</text>
<text text-anchor="middle" x="1580.56" y="-10544.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="1580.56" y="-10529.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1580.56" y="-10514.71" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_1_mlp&#45;&gt;layer_1_mlp_reduce -->
<g id="edge19" class="edge">
<title>layer_1_mlp&#45;&gt;layer_1_mlp_reduce</title>
<path fill="none" stroke="black" d="M1580.56,-10624.73C1580.56,-10616.74 1580.56,-10607.97 1580.56,-10599.23"/>
<polygon fill="black" stroke="black" points="1584.06,-10599.02 1580.56,-10589.02 1577.06,-10599.02 1584.06,-10599.02"/>
</g>
<!-- layer_2_norm -->
<g id="node19" class="node">
<title>layer_2_norm</title>
<polygon fill="lightblue" stroke="black" points="2382.06,-10574.91 1923.06,-10574.91 1923.06,-10506.91 2382.06,-10506.91 2382.06,-10574.91"/>
<text text-anchor="middle" x="2152.56" y="-10559.71" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 2)</text>
<text text-anchor="middle" x="2152.56" y="-10544.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2152.56" y="-10529.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2152.56" y="-10514.71" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_1_mlp&#45;&gt;layer_2_norm -->
<g id="edge22" class="edge">
<title>layer_1_mlp&#45;&gt;layer_2_norm</title>
<path fill="none" stroke="black" d="M1743.33,-10624.96C1817.13,-10609.99 1904.46,-10592.26 1979.46,-10577.04"/>
<polygon fill="black" stroke="black" points="1980.38,-10580.43 1989.49,-10575.01 1978.99,-10573.57 1980.38,-10580.43"/>
</g>
<!-- layer_1_mlp_reduce&#45;&gt;layer_1_residual2 -->
<g id="edge21" class="edge">
<title>layer_1_mlp_reduce&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M1498.16,-10494.25C1474.5,-10481.13 1448.96,-10466.98 1426.23,-10454.38"/>
<polygon fill="black" stroke="black" points="1427.77,-10451.24 1417.33,-10449.45 1424.38,-10457.36 1427.77,-10451.24"/>
</g>
<!-- layer_2_attn -->
<g id="node20" class="node">
<title>layer_2_attn</title>
<polygon fill="lightblue" stroke="black" points="2249.56,-10456.83 1799.56,-10456.83 1799.56,-10373.83 2249.56,-10373.83 2249.56,-10456.83"/>
<text text-anchor="middle" x="2024.56" y="-10441.63" font-family="Times,serif" font-size="14.00">MHA&#45;TP (Layer 2)</text>
<text text-anchor="middle" x="2024.56" y="-10426.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="2024.56" y="-10411.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="2024.56" y="-10396.63" font-family="Times,serif" font-size="14.00">Per GPU: 4 heads, head_dim=128</text>
<text text-anchor="middle" x="2024.56" y="-10381.63" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_2_norm&#45;&gt;layer_2_attn -->
<g id="edge23" class="edge">
<title>layer_2_norm&#45;&gt;layer_2_attn</title>
<path fill="none" stroke="black" d="M2118.26,-10506.79C2104.77,-10493.77 2089.01,-10478.55 2074.31,-10464.36"/>
<polygon fill="black" stroke="black" points="2076.36,-10461.47 2066.73,-10457.04 2071.49,-10466.51 2076.36,-10461.47"/>
</g>
<!-- layer_2_residual1 -->
<g id="node22" class="node">
<title>layer_2_residual1</title>
<polygon fill="lightblue" stroke="black" points="2522.06,-10205.66 1683.06,-10205.66 1683.06,-10137.66 2522.06,-10137.66 2522.06,-10205.66"/>
<text text-anchor="middle" x="2102.56" y="-10190.46" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2102.56" y="-10175.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2102.56" y="-10160.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2102.56" y="-10145.46" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_2_norm&#45;&gt;layer_2_residual1 -->
<g id="edge25" class="edge">
<title>layer_2_norm&#45;&gt;layer_2_residual1</title>
<path fill="none" stroke="black" d="M2213.03,-10506.87C2230.98,-10493.81 2248.52,-10477.03 2258.56,-10456.83 2301.14,-10371.2 2312.93,-10321.68 2260.56,-10241.66 2252.64,-10229.55 2242.07,-10219.56 2230.14,-10211.31"/>
<polygon fill="black" stroke="black" points="2231.99,-10208.34 2221.69,-10205.87 2228.21,-10214.22 2231.99,-10208.34"/>
</g>
<!-- layer_2_attn_reduce -->
<g id="node21" class="node">
<title>layer_2_attn_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="1926.56" cy="-10289.75" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="1926.56" y="-10308.55" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="1926.56" y="-10293.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="1926.56" y="-10278.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1926.56" y="-10263.55" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_2_attn&#45;&gt;layer_2_attn_reduce -->
<g id="edge24" class="edge">
<title>layer_2_attn&#45;&gt;layer_2_attn_reduce</title>
<path fill="none" stroke="black" d="M1992.2,-10373.52C1985.22,-10364.71 1977.72,-10355.26 1970.38,-10346"/>
<polygon fill="black" stroke="black" points="1972.94,-10343.6 1963.98,-10337.94 1967.46,-10347.95 1972.94,-10343.6"/>
</g>
<!-- layer_2_attn_reduce&#45;&gt;layer_2_residual1 -->
<g id="edge26" class="edge">
<title>layer_2_attn_reduce&#45;&gt;layer_2_residual1</title>
<path fill="none" stroke="black" d="M1996.37,-10242.7C2012.02,-10232.38 2028.47,-10221.53 2043.62,-10211.54"/>
<polygon fill="black" stroke="black" points="2045.95,-10214.19 2052.37,-10205.77 2042.1,-10208.35 2045.95,-10214.19"/>
</g>
<!-- layer_2_norm2 -->
<g id="node23" class="node">
<title>layer_2_norm2</title>
<polygon fill="lightblue" stroke="black" points="2508.06,-10101.66 2049.06,-10101.66 2049.06,-10033.66 2508.06,-10033.66 2508.06,-10101.66"/>
<text text-anchor="middle" x="2278.56" y="-10086.46" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 2)</text>
<text text-anchor="middle" x="2278.56" y="-10071.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2278.56" y="-10056.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2278.56" y="-10041.46" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_2_residual1&#45;&gt;layer_2_norm2 -->
<g id="edge27" class="edge">
<title>layer_2_residual1&#45;&gt;layer_2_norm2</title>
<path fill="none" stroke="black" d="M2159.7,-10137.55C2176.54,-10127.79 2195.11,-10117.03 2212.46,-10106.97"/>
<polygon fill="black" stroke="black" points="2214.51,-10109.83 2221.41,-10101.79 2211,-10103.77 2214.51,-10109.83"/>
</g>
<!-- layer_2_residual2 -->
<g id="node26" class="node">
<title>layer_2_residual2</title>
<polygon fill="lightblue" stroke="black" points="2523.06,-9754 1684.06,-9754 1684.06,-9686 2523.06,-9686 2523.06,-9754"/>
<text text-anchor="middle" x="2103.56" y="-9738.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2103.56" y="-9723.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2103.56" y="-9708.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2103.56" y="-9693.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_2_residual1&#45;&gt;layer_2_residual2 -->
<g id="edge30" class="edge">
<title>layer_2_residual1&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M2065.97,-10137.58C2056.11,-10126.97 2046.32,-10114.6 2039.56,-10101.66 1976.26,-9980.4 1928.95,-9918.59 1992.56,-9797.5 2000.27,-9782.83 2012.2,-9770.42 2025.44,-9760.14"/>
<polygon fill="black" stroke="black" points="2027.81,-9762.75 2033.82,-9754.02 2023.68,-9757.09 2027.81,-9762.75"/>
</g>
<!-- layer_2_mlp -->
<g id="node24" class="node">
<title>layer_2_mlp</title>
<polygon fill="lightblue" stroke="black" points="2556.06,-9997.66 2097.06,-9997.66 2097.06,-9929.66 2556.06,-9929.66 2556.06,-9997.66"/>
<text text-anchor="middle" x="2326.56" y="-9982.46" font-family="Times,serif" font-size="14.00">MLP&#45;TP (Layer 2)</text>
<text text-anchor="middle" x="2326.56" y="-9967.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="2326.56" y="-9952.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="2326.56" y="-9937.46" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_2_norm2&#45;&gt;layer_2_mlp -->
<g id="edge28" class="edge">
<title>layer_2_norm2&#45;&gt;layer_2_mlp</title>
<path fill="none" stroke="black" d="M2294.15,-10033.55C2298.13,-10025.08 2302.46,-10015.87 2306.63,-10007.01"/>
<polygon fill="black" stroke="black" points="2309.8,-10008.5 2310.89,-9997.96 2303.47,-10005.52 2309.8,-10008.5"/>
</g>
<!-- layer_2_mlp_reduce -->
<g id="node25" class="node">
<title>layer_2_mlp_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="2326.56" cy="-9845.58" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="2326.56" y="-9864.38" font-family="Times,serif" font-size="14.00">All&#45;Reduce MLP</text>
<text text-anchor="middle" x="2326.56" y="-9849.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="2326.56" y="-9834.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2326.56" y="-9819.38" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_2_mlp&#45;&gt;layer_2_mlp_reduce -->
<g id="edge29" class="edge">
<title>layer_2_mlp&#45;&gt;layer_2_mlp_reduce</title>
<path fill="none" stroke="black" d="M2326.56,-9929.4C2326.56,-9921.4 2326.56,-9912.64 2326.56,-9903.9"/>
<polygon fill="black" stroke="black" points="2330.06,-9903.69 2326.56,-9893.69 2323.06,-9903.69 2330.06,-9903.69"/>
</g>
<!-- layer_3_norm -->
<g id="node27" class="node">
<title>layer_3_norm</title>
<polygon fill="lightblue" stroke="black" points="3128.06,-9879.58 2669.06,-9879.58 2669.06,-9811.58 3128.06,-9811.58 3128.06,-9879.58"/>
<text text-anchor="middle" x="2898.56" y="-9864.38" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 3)</text>
<text text-anchor="middle" x="2898.56" y="-9849.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2898.56" y="-9834.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2898.56" y="-9819.38" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_2_mlp&#45;&gt;layer_3_norm -->
<g id="edge32" class="edge">
<title>layer_2_mlp&#45;&gt;layer_3_norm</title>
<path fill="none" stroke="black" d="M2489.33,-9929.63C2563.13,-9914.65 2650.46,-9896.93 2725.46,-9881.71"/>
<polygon fill="black" stroke="black" points="2726.38,-9885.09 2735.49,-9879.67 2724.99,-9878.23 2726.38,-9885.09"/>
</g>
<!-- layer_2_mlp_reduce&#45;&gt;layer_2_residual2 -->
<g id="edge31" class="edge">
<title>layer_2_mlp_reduce&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M2244.16,-9798.91C2220.5,-9785.8 2194.96,-9771.65 2172.23,-9759.05"/>
<polygon fill="black" stroke="black" points="2173.77,-9755.91 2163.33,-9754.12 2170.38,-9762.03 2173.77,-9755.91"/>
</g>
<!-- layer_3_attn -->
<g id="node28" class="node">
<title>layer_3_attn</title>
<polygon fill="lightblue" stroke="black" points="2995.56,-9761.5 2545.56,-9761.5 2545.56,-9678.5 2995.56,-9678.5 2995.56,-9761.5"/>
<text text-anchor="middle" x="2770.56" y="-9746.3" font-family="Times,serif" font-size="14.00">MHA&#45;TP (Layer 3)</text>
<text text-anchor="middle" x="2770.56" y="-9731.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="2770.56" y="-9716.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="2770.56" y="-9701.3" font-family="Times,serif" font-size="14.00">Per GPU: 4 heads, head_dim=128</text>
<text text-anchor="middle" x="2770.56" y="-9686.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_3_norm&#45;&gt;layer_3_attn -->
<g id="edge33" class="edge">
<title>layer_3_norm&#45;&gt;layer_3_attn</title>
<path fill="none" stroke="black" d="M2864.26,-9811.46C2850.77,-9798.43 2835.01,-9783.22 2820.31,-9769.02"/>
<polygon fill="black" stroke="black" points="2822.36,-9766.14 2812.73,-9761.71 2817.49,-9771.17 2822.36,-9766.14"/>
</g>
<!-- layer_3_residual1 -->
<g id="node30" class="node">
<title>layer_3_residual1</title>
<polygon fill="lightblue" stroke="black" points="3268.06,-9510.33 2429.06,-9510.33 2429.06,-9442.33 3268.06,-9442.33 3268.06,-9510.33"/>
<text text-anchor="middle" x="2848.56" y="-9495.13" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2848.56" y="-9480.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2848.56" y="-9465.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2848.56" y="-9450.13" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_3_norm&#45;&gt;layer_3_residual1 -->
<g id="edge35" class="edge">
<title>layer_3_norm&#45;&gt;layer_3_residual1</title>
<path fill="none" stroke="black" d="M2959.03,-9811.54C2976.98,-9798.48 2994.52,-9781.7 3004.56,-9761.5 3047.14,-9675.86 3058.93,-9626.35 3006.56,-9546.33 2998.64,-9534.22 2988.07,-9524.23 2976.14,-9515.98"/>
<polygon fill="black" stroke="black" points="2977.99,-9513 2967.69,-9510.54 2974.21,-9518.89 2977.99,-9513"/>
</g>
<!-- layer_3_attn_reduce -->
<g id="node29" class="node">
<title>layer_3_attn_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="2672.56" cy="-9594.41" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="2672.56" y="-9613.21" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="2672.56" y="-9598.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="2672.56" y="-9583.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2672.56" y="-9568.21" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_3_attn&#45;&gt;layer_3_attn_reduce -->
<g id="edge34" class="edge">
<title>layer_3_attn&#45;&gt;layer_3_attn_reduce</title>
<path fill="none" stroke="black" d="M2738.2,-9678.19C2731.22,-9669.38 2723.72,-9659.92 2716.38,-9650.67"/>
<polygon fill="black" stroke="black" points="2718.94,-9648.26 2709.98,-9642.6 2713.46,-9652.61 2718.94,-9648.26"/>
</g>
<!-- layer_3_attn_reduce&#45;&gt;layer_3_residual1 -->
<g id="edge36" class="edge">
<title>layer_3_attn_reduce&#45;&gt;layer_3_residual1</title>
<path fill="none" stroke="black" d="M2742.37,-9547.37C2758.02,-9537.05 2774.47,-9526.2 2789.62,-9516.21"/>
<polygon fill="black" stroke="black" points="2791.95,-9518.86 2798.37,-9510.43 2788.1,-9513.02 2791.95,-9518.86"/>
</g>
<!-- layer_3_norm2 -->
<g id="node31" class="node">
<title>layer_3_norm2</title>
<polygon fill="lightblue" stroke="black" points="3254.06,-9406.33 2795.06,-9406.33 2795.06,-9338.33 3254.06,-9338.33 3254.06,-9406.33"/>
<text text-anchor="middle" x="3024.56" y="-9391.13" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 3)</text>
<text text-anchor="middle" x="3024.56" y="-9376.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3024.56" y="-9361.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3024.56" y="-9346.13" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_3_residual1&#45;&gt;layer_3_norm2 -->
<g id="edge37" class="edge">
<title>layer_3_residual1&#45;&gt;layer_3_norm2</title>
<path fill="none" stroke="black" d="M2905.7,-9442.21C2922.54,-9432.45 2941.11,-9421.7 2958.46,-9411.64"/>
<polygon fill="black" stroke="black" points="2960.51,-9414.5 2967.41,-9406.45 2957,-9408.44 2960.51,-9414.5"/>
</g>
<!-- layer_3_residual2 -->
<g id="node34" class="node">
<title>layer_3_residual2</title>
<polygon fill="lightblue" stroke="black" points="3270.06,-9058.66 2431.06,-9058.66 2431.06,-8990.66 3270.06,-8990.66 3270.06,-9058.66"/>
<text text-anchor="middle" x="2850.56" y="-9043.46" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2850.56" y="-9028.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2850.56" y="-9013.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2850.56" y="-8998.46" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_3_residual1&#45;&gt;layer_3_residual2 -->
<g id="edge40" class="edge">
<title>layer_3_residual1&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M2811.97,-9442.24C2802.11,-9431.64 2792.32,-9419.27 2785.56,-9406.33 2722.26,-9285.07 2674.7,-9223.13 2738.56,-9102.16 2746.3,-9087.51 2758.25,-9075.12 2771.51,-9064.88"/>
<polygon fill="black" stroke="black" points="2773.88,-9067.48 2779.91,-9058.77 2769.77,-9061.82 2773.88,-9067.48"/>
</g>
<!-- layer_3_mlp -->
<g id="node32" class="node">
<title>layer_3_mlp</title>
<polygon fill="lightblue" stroke="black" points="3302.06,-9302.33 2843.06,-9302.33 2843.06,-9234.33 3302.06,-9234.33 3302.06,-9302.33"/>
<text text-anchor="middle" x="3072.56" y="-9287.13" font-family="Times,serif" font-size="14.00">MLP&#45;TP (Layer 3)</text>
<text text-anchor="middle" x="3072.56" y="-9272.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="3072.56" y="-9257.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="3072.56" y="-9242.13" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_3_norm2&#45;&gt;layer_3_mlp -->
<g id="edge38" class="edge">
<title>layer_3_norm2&#45;&gt;layer_3_mlp</title>
<path fill="none" stroke="black" d="M3040.15,-9338.21C3044.13,-9329.75 3048.46,-9320.54 3052.63,-9311.68"/>
<polygon fill="black" stroke="black" points="3055.8,-9313.17 3056.89,-9302.63 3049.47,-9310.19 3055.8,-9313.17"/>
</g>
<!-- layer_3_mlp_reduce -->
<g id="node33" class="node">
<title>layer_3_mlp_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="3072.56" cy="-9150.25" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="3072.56" y="-9169.05" font-family="Times,serif" font-size="14.00">All&#45;Reduce MLP</text>
<text text-anchor="middle" x="3072.56" y="-9154.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="3072.56" y="-9139.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3072.56" y="-9124.05" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_3_mlp&#45;&gt;layer_3_mlp_reduce -->
<g id="edge39" class="edge">
<title>layer_3_mlp&#45;&gt;layer_3_mlp_reduce</title>
<path fill="none" stroke="black" d="M3072.56,-9234.06C3072.56,-9226.07 3072.56,-9217.31 3072.56,-9208.56"/>
<polygon fill="black" stroke="black" points="3076.06,-9208.36 3072.56,-9198.36 3069.06,-9208.36 3076.06,-9208.36"/>
</g>
<!-- layer_4_norm -->
<g id="node35" class="node">
<title>layer_4_norm</title>
<polygon fill="lightblue" stroke="black" points="3874.06,-9184.25 3415.06,-9184.25 3415.06,-9116.25 3874.06,-9116.25 3874.06,-9184.25"/>
<text text-anchor="middle" x="3644.56" y="-9169.05" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 4)</text>
<text text-anchor="middle" x="3644.56" y="-9154.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3644.56" y="-9139.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3644.56" y="-9124.05" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_3_mlp&#45;&gt;layer_4_norm -->
<g id="edge42" class="edge">
<title>layer_3_mlp&#45;&gt;layer_4_norm</title>
<path fill="none" stroke="black" d="M3235.33,-9234.3C3309.13,-9219.32 3396.46,-9201.6 3471.46,-9186.38"/>
<polygon fill="black" stroke="black" points="3472.38,-9189.76 3481.49,-9184.34 3470.99,-9182.9 3472.38,-9189.76"/>
</g>
<!-- layer_3_mlp_reduce&#45;&gt;layer_3_residual2 -->
<g id="edge41" class="edge">
<title>layer_3_mlp_reduce&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M2990.53,-9103.58C2966.98,-9090.47 2941.55,-9076.32 2918.92,-9063.72"/>
<polygon fill="black" stroke="black" points="2920.5,-9060.59 2910.06,-9058.79 2917.1,-9066.71 2920.5,-9060.59"/>
</g>
<!-- layer_4_attn -->
<g id="node36" class="node">
<title>layer_4_attn</title>
<polygon fill="lightblue" stroke="black" points="3803.56,-9066.16 3353.56,-9066.16 3353.56,-8983.16 3803.56,-8983.16 3803.56,-9066.16"/>
<text text-anchor="middle" x="3578.56" y="-9050.96" font-family="Times,serif" font-size="14.00">MHA&#45;TP (Layer 4)</text>
<text text-anchor="middle" x="3578.56" y="-9035.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="3578.56" y="-9020.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="3578.56" y="-9005.96" font-family="Times,serif" font-size="14.00">Per GPU: 4 heads, head_dim=128</text>
<text text-anchor="middle" x="3578.56" y="-8990.96" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_4_norm&#45;&gt;layer_4_attn -->
<g id="edge43" class="edge">
<title>layer_4_norm&#45;&gt;layer_4_attn</title>
<path fill="none" stroke="black" d="M3626.88,-9116.13C3620.17,-9103.58 3612.39,-9089 3605.05,-9075.26"/>
<polygon fill="black" stroke="black" points="3608.1,-9073.55 3600.31,-9066.38 3601.93,-9076.85 3608.1,-9073.55"/>
</g>
<!-- layer_4_residual1 -->
<g id="node38" class="node">
<title>layer_4_residual1</title>
<polygon fill="lightblue" stroke="black" points="4124.06,-8815 3285.06,-8815 3285.06,-8747 4124.06,-8747 4124.06,-8815"/>
<text text-anchor="middle" x="3704.56" y="-8799.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3704.56" y="-8784.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3704.56" y="-8769.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3704.56" y="-8754.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_4_norm&#45;&gt;layer_4_residual1 -->
<g id="edge45" class="edge">
<title>layer_4_norm&#45;&gt;layer_4_residual1</title>
<path fill="none" stroke="black" d="M3740.44,-9116.24C3766.37,-9103.73 3792.72,-9087.26 3812.56,-9066.16 3851.86,-9024.37 3851.23,-9003.4 3862.56,-8947.16 3871.01,-8905.26 3885.97,-8886.76 3862.56,-8851 3854.64,-8838.89 3844.07,-8828.89 3832.14,-8820.64"/>
<polygon fill="black" stroke="black" points="3833.99,-8817.67 3823.69,-8815.21 3830.21,-8823.56 3833.99,-8817.67"/>
</g>
<!-- layer_4_attn_reduce -->
<g id="node37" class="node">
<title>layer_4_attn_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="3528.56" cy="-8899.08" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="3528.56" y="-8917.88" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="3528.56" y="-8902.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="3528.56" y="-8887.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3528.56" y="-8872.88" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_4_attn&#45;&gt;layer_4_attn_reduce -->
<g id="edge44" class="edge">
<title>layer_4_attn&#45;&gt;layer_4_attn_reduce</title>
<path fill="none" stroke="black" d="M3562.05,-8982.85C3558.67,-8974.49 3555.05,-8965.54 3551.48,-8956.74"/>
<polygon fill="black" stroke="black" points="3554.65,-8955.23 3547.65,-8947.27 3548.16,-8957.85 3554.65,-8955.23"/>
</g>
<!-- layer_4_attn_reduce&#45;&gt;layer_4_residual1 -->
<g id="edge46" class="edge">
<title>layer_4_attn_reduce&#45;&gt;layer_4_residual1</title>
<path fill="none" stroke="black" d="M3598.37,-8852.03C3614.02,-8841.72 3630.47,-8830.87 3645.62,-8820.87"/>
<polygon fill="black" stroke="black" points="3647.95,-8823.53 3654.37,-8815.1 3644.1,-8817.68 3647.95,-8823.53"/>
</g>
<!-- layer_4_norm2 -->
<g id="node39" class="node">
<title>layer_4_norm2</title>
<polygon fill="lightblue" stroke="black" points="4110.06,-8711 3651.06,-8711 3651.06,-8643 4110.06,-8643 4110.06,-8711"/>
<text text-anchor="middle" x="3880.56" y="-8695.8" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 4)</text>
<text text-anchor="middle" x="3880.56" y="-8680.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3880.56" y="-8665.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3880.56" y="-8650.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_4_residual1&#45;&gt;layer_4_norm2 -->
<g id="edge47" class="edge">
<title>layer_4_residual1&#45;&gt;layer_4_norm2</title>
<path fill="none" stroke="black" d="M3761.7,-8746.88C3778.54,-8737.12 3797.11,-8726.36 3814.46,-8716.31"/>
<polygon fill="black" stroke="black" points="3816.51,-8719.16 3823.41,-8711.12 3813,-8713.11 3816.51,-8719.16"/>
</g>
<!-- layer_4_residual2 -->
<g id="node42" class="node">
<title>layer_4_residual2</title>
<polygon fill="lightblue" stroke="black" points="4125.06,-8363.33 3286.06,-8363.33 3286.06,-8295.33 4125.06,-8295.33 4125.06,-8363.33"/>
<text text-anchor="middle" x="3705.56" y="-8348.13" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3705.56" y="-8333.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3705.56" y="-8318.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3705.56" y="-8303.13" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_4_residual1&#45;&gt;layer_4_residual2 -->
<g id="edge50" class="edge">
<title>layer_4_residual1&#45;&gt;layer_4_residual2</title>
<path fill="none" stroke="black" d="M3667.97,-8746.91C3658.11,-8736.31 3648.32,-8723.94 3641.56,-8711 3578.26,-8589.73 3530.95,-8527.93 3594.56,-8406.83 3602.27,-8392.16 3614.2,-8379.75 3627.44,-8369.48"/>
<polygon fill="black" stroke="black" points="3629.81,-8372.08 3635.82,-8363.36 3625.68,-8366.43 3629.81,-8372.08"/>
</g>
<!-- layer_4_mlp -->
<g id="node40" class="node">
<title>layer_4_mlp</title>
<polygon fill="lightblue" stroke="black" points="4158.06,-8607 3699.06,-8607 3699.06,-8539 4158.06,-8539 4158.06,-8607"/>
<text text-anchor="middle" x="3928.56" y="-8591.8" font-family="Times,serif" font-size="14.00">MLP&#45;TP (Layer 4)</text>
<text text-anchor="middle" x="3928.56" y="-8576.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="3928.56" y="-8561.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="3928.56" y="-8546.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_4_norm2&#45;&gt;layer_4_mlp -->
<g id="edge48" class="edge">
<title>layer_4_norm2&#45;&gt;layer_4_mlp</title>
<path fill="none" stroke="black" d="M3896.15,-8642.88C3900.13,-8634.42 3904.46,-8625.2 3908.63,-8616.35"/>
<polygon fill="black" stroke="black" points="3911.8,-8617.83 3912.89,-8607.3 3905.47,-8614.85 3911.8,-8617.83"/>
</g>
<!-- layer_4_mlp_reduce -->
<g id="node41" class="node">
<title>layer_4_mlp_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="3928.56" cy="-8454.91" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="3928.56" y="-8473.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce MLP</text>
<text text-anchor="middle" x="3928.56" y="-8458.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="3928.56" y="-8443.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3928.56" y="-8428.71" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_4_mlp&#45;&gt;layer_4_mlp_reduce -->
<g id="edge49" class="edge">
<title>layer_4_mlp&#45;&gt;layer_4_mlp_reduce</title>
<path fill="none" stroke="black" d="M3928.56,-8538.73C3928.56,-8530.74 3928.56,-8521.97 3928.56,-8513.23"/>
<polygon fill="black" stroke="black" points="3932.06,-8513.02 3928.56,-8503.02 3925.06,-8513.02 3932.06,-8513.02"/>
</g>
<!-- layer_5_norm -->
<g id="node43" class="node">
<title>layer_5_norm</title>
<polygon fill="lightblue" stroke="black" points="4730.06,-8488.91 4271.06,-8488.91 4271.06,-8420.91 4730.06,-8420.91 4730.06,-8488.91"/>
<text text-anchor="middle" x="4500.56" y="-8473.71" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 5)</text>
<text text-anchor="middle" x="4500.56" y="-8458.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4500.56" y="-8443.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4500.56" y="-8428.71" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_4_mlp&#45;&gt;layer_5_norm -->
<g id="edge52" class="edge">
<title>layer_4_mlp&#45;&gt;layer_5_norm</title>
<path fill="none" stroke="black" d="M4091.33,-8538.96C4165.13,-8523.99 4252.46,-8506.26 4327.46,-8491.04"/>
<polygon fill="black" stroke="black" points="4328.38,-8494.43 4337.49,-8489.01 4326.99,-8487.57 4328.38,-8494.43"/>
</g>
<!-- layer_4_mlp_reduce&#45;&gt;layer_4_residual2 -->
<g id="edge51" class="edge">
<title>layer_4_mlp_reduce&#45;&gt;layer_4_residual2</title>
<path fill="none" stroke="black" d="M3846.16,-8408.25C3822.5,-8395.14 3796.96,-8380.98 3774.23,-8368.38"/>
<polygon fill="black" stroke="black" points="3775.77,-8365.24 3765.33,-8363.45 3772.38,-8371.36 3775.77,-8365.24"/>
</g>
<!-- layer_5_attn -->
<g id="node44" class="node">
<title>layer_5_attn</title>
<polygon fill="lightblue" stroke="black" points="4597.56,-8370.83 4147.56,-8370.83 4147.56,-8287.83 4597.56,-8287.83 4597.56,-8370.83"/>
<text text-anchor="middle" x="4372.56" y="-8355.63" font-family="Times,serif" font-size="14.00">MHA&#45;TP (Layer 5)</text>
<text text-anchor="middle" x="4372.56" y="-8340.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="4372.56" y="-8325.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="4372.56" y="-8310.63" font-family="Times,serif" font-size="14.00">Per GPU: 4 heads, head_dim=128</text>
<text text-anchor="middle" x="4372.56" y="-8295.63" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_5_norm&#45;&gt;layer_5_attn -->
<g id="edge53" class="edge">
<title>layer_5_norm&#45;&gt;layer_5_attn</title>
<path fill="none" stroke="black" d="M4466.26,-8420.8C4452.77,-8407.77 4437.01,-8392.55 4422.31,-8378.36"/>
<polygon fill="black" stroke="black" points="4424.36,-8375.47 4414.73,-8371.04 4419.49,-8380.51 4424.36,-8375.47"/>
</g>
<!-- layer_5_residual1 -->
<g id="node46" class="node">
<title>layer_5_residual1</title>
<polygon fill="lightblue" stroke="black" points="4870.06,-8119.66 4031.06,-8119.66 4031.06,-8051.66 4870.06,-8051.66 4870.06,-8119.66"/>
<text text-anchor="middle" x="4450.56" y="-8104.46" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4450.56" y="-8089.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4450.56" y="-8074.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4450.56" y="-8059.46" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_5_norm&#45;&gt;layer_5_residual1 -->
<g id="edge55" class="edge">
<title>layer_5_norm&#45;&gt;layer_5_residual1</title>
<path fill="none" stroke="black" d="M4561.03,-8420.88C4578.98,-8407.81 4596.52,-8391.03 4606.56,-8370.83 4649.14,-8285.2 4660.93,-8235.68 4608.56,-8155.66 4600.64,-8143.56 4590.07,-8133.56 4578.14,-8125.31"/>
<polygon fill="black" stroke="black" points="4579.99,-8122.34 4569.69,-8119.87 4576.21,-8128.23 4579.99,-8122.34"/>
</g>
<!-- layer_5_attn_reduce -->
<g id="node45" class="node">
<title>layer_5_attn_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="4274.56" cy="-8203.75" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="4274.56" y="-8222.55" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="4274.56" y="-8207.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="4274.56" y="-8192.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4274.56" y="-8177.55" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_5_attn&#45;&gt;layer_5_attn_reduce -->
<g id="edge54" class="edge">
<title>layer_5_attn&#45;&gt;layer_5_attn_reduce</title>
<path fill="none" stroke="black" d="M4340.2,-8287.52C4333.22,-8278.71 4325.72,-8269.26 4318.38,-8260"/>
<polygon fill="black" stroke="black" points="4320.94,-8257.6 4311.98,-8251.94 4315.46,-8261.95 4320.94,-8257.6"/>
</g>
<!-- layer_5_attn_reduce&#45;&gt;layer_5_residual1 -->
<g id="edge56" class="edge">
<title>layer_5_attn_reduce&#45;&gt;layer_5_residual1</title>
<path fill="none" stroke="black" d="M4344.37,-8156.7C4360.02,-8146.38 4376.47,-8135.54 4391.62,-8125.54"/>
<polygon fill="black" stroke="black" points="4393.95,-8128.19 4400.37,-8119.77 4390.1,-8122.35 4393.95,-8128.19"/>
</g>
<!-- layer_5_norm2 -->
<g id="node47" class="node">
<title>layer_5_norm2</title>
<polygon fill="lightblue" stroke="black" points="4856.06,-8015.66 4397.06,-8015.66 4397.06,-7947.66 4856.06,-7947.66 4856.06,-8015.66"/>
<text text-anchor="middle" x="4626.56" y="-8000.46" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 5)</text>
<text text-anchor="middle" x="4626.56" y="-7985.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4626.56" y="-7970.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4626.56" y="-7955.46" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_5_residual1&#45;&gt;layer_5_norm2 -->
<g id="edge57" class="edge">
<title>layer_5_residual1&#45;&gt;layer_5_norm2</title>
<path fill="none" stroke="black" d="M4507.7,-8051.55C4524.54,-8041.79 4543.11,-8031.03 4560.46,-8020.97"/>
<polygon fill="black" stroke="black" points="4562.51,-8023.83 4569.41,-8015.79 4559,-8017.77 4562.51,-8023.83"/>
</g>
<!-- layer_5_residual2 -->
<g id="node50" class="node">
<title>layer_5_residual2</title>
<polygon fill="lightblue" stroke="black" points="4745.06,-7668 3906.06,-7668 3906.06,-7600 4745.06,-7600 4745.06,-7668"/>
<text text-anchor="middle" x="4325.56" y="-7652.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4325.56" y="-7637.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4325.56" y="-7622.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4325.56" y="-7607.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_5_residual1&#45;&gt;layer_5_residual2 -->
<g id="edge60" class="edge">
<title>layer_5_residual1&#45;&gt;layer_5_residual2</title>
<path fill="none" stroke="black" d="M4414.6,-8051.47C4404.9,-8040.87 4395.25,-8028.52 4388.56,-8015.66 4330.69,-7904.35 4323.78,-7752.16 4324.23,-7678.49"/>
<polygon fill="black" stroke="black" points="4327.74,-7678.24 4324.35,-7668.2 4320.74,-7678.16 4327.74,-7678.24"/>
</g>
<!-- layer_5_mlp -->
<g id="node48" class="node">
<title>layer_5_mlp</title>
<polygon fill="lightblue" stroke="black" points="4904.06,-7911.66 4445.06,-7911.66 4445.06,-7843.66 4904.06,-7843.66 4904.06,-7911.66"/>
<text text-anchor="middle" x="4674.56" y="-7896.46" font-family="Times,serif" font-size="14.00">MLP&#45;TP (Layer 5)</text>
<text text-anchor="middle" x="4674.56" y="-7881.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="4674.56" y="-7866.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="4674.56" y="-7851.46" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_5_norm2&#45;&gt;layer_5_mlp -->
<g id="edge58" class="edge">
<title>layer_5_norm2&#45;&gt;layer_5_mlp</title>
<path fill="none" stroke="black" d="M4642.15,-7947.55C4646.13,-7939.09 4650.46,-7929.87 4654.63,-7921.02"/>
<polygon fill="black" stroke="black" points="4657.8,-7922.5 4658.89,-7911.96 4651.47,-7919.52 4657.8,-7922.5"/>
</g>
<!-- layer_5_mlp_reduce -->
<g id="node49" class="node">
<title>layer_5_mlp_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="4674.56" cy="-7759.58" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="4674.56" y="-7778.38" font-family="Times,serif" font-size="14.00">All&#45;Reduce MLP</text>
<text text-anchor="middle" x="4674.56" y="-7763.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="4674.56" y="-7748.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4674.56" y="-7733.38" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_5_mlp&#45;&gt;layer_5_mlp_reduce -->
<g id="edge59" class="edge">
<title>layer_5_mlp&#45;&gt;layer_5_mlp_reduce</title>
<path fill="none" stroke="black" d="M4674.56,-7843.4C4674.56,-7835.41 4674.56,-7826.64 4674.56,-7817.9"/>
<polygon fill="black" stroke="black" points="4678.06,-7817.69 4674.56,-7807.69 4671.06,-7817.69 4678.06,-7817.69"/>
</g>
<!-- layer_6_norm -->
<g id="node51" class="node">
<title>layer_6_norm</title>
<polygon fill="lightblue" stroke="black" points="5476.06,-7793.58 5017.06,-7793.58 5017.06,-7725.58 5476.06,-7725.58 5476.06,-7793.58"/>
<text text-anchor="middle" x="5246.56" y="-7778.38" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 6)</text>
<text text-anchor="middle" x="5246.56" y="-7763.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5246.56" y="-7748.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5246.56" y="-7733.38" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_5_mlp&#45;&gt;layer_6_norm -->
<g id="edge62" class="edge">
<title>layer_5_mlp&#45;&gt;layer_6_norm</title>
<path fill="none" stroke="black" d="M4837.33,-7843.63C4911.13,-7828.65 4998.46,-7810.93 5073.46,-7795.71"/>
<polygon fill="black" stroke="black" points="5074.38,-7799.09 5083.49,-7793.68 5072.99,-7792.23 5074.38,-7799.09"/>
</g>
<!-- layer_5_mlp_reduce&#45;&gt;layer_5_residual2 -->
<g id="edge61" class="edge">
<title>layer_5_mlp_reduce&#45;&gt;layer_5_residual2</title>
<path fill="none" stroke="black" d="M4551.52,-7715.01C4511.35,-7700.79 4467.2,-7685.15 4428.66,-7671.5"/>
<polygon fill="black" stroke="black" points="4429.58,-7668.12 4418.98,-7668.08 4427.24,-7674.72 4429.58,-7668.12"/>
</g>
<!-- layer_6_attn -->
<g id="node52" class="node">
<title>layer_6_attn</title>
<polygon fill="lightblue" stroke="black" points="5215.56,-7675.5 4765.56,-7675.5 4765.56,-7592.5 5215.56,-7592.5 5215.56,-7675.5"/>
<text text-anchor="middle" x="4990.56" y="-7660.3" font-family="Times,serif" font-size="14.00">MHA&#45;TP (Layer 6)</text>
<text text-anchor="middle" x="4990.56" y="-7645.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="4990.56" y="-7630.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="4990.56" y="-7615.3" font-family="Times,serif" font-size="14.00">Per GPU: 4 heads, head_dim=128</text>
<text text-anchor="middle" x="4990.56" y="-7600.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_6_norm&#45;&gt;layer_6_attn -->
<g id="edge63" class="edge">
<title>layer_6_norm&#45;&gt;layer_6_attn</title>
<path fill="none" stroke="black" d="M5177.96,-7725.46C5149.11,-7711.54 5115.09,-7695.11 5084.01,-7680.11"/>
<polygon fill="black" stroke="black" points="5085.43,-7676.91 5074.9,-7675.71 5082.39,-7683.21 5085.43,-7676.91"/>
</g>
<!-- layer_6_residual1 -->
<g id="node54" class="node">
<title>layer_6_residual1</title>
<polygon fill="lightblue" stroke="black" points="5537.06,-7424.33 4698.06,-7424.33 4698.06,-7356.33 5537.06,-7356.33 5537.06,-7424.33"/>
<text text-anchor="middle" x="5117.56" y="-7409.13" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5117.56" y="-7394.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5117.56" y="-7379.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5117.56" y="-7364.13" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_6_norm&#45;&gt;layer_6_residual1 -->
<g id="edge65" class="edge">
<title>layer_6_norm&#45;&gt;layer_6_residual1</title>
<path fill="none" stroke="black" d="M5262.34,-7725.36C5287.72,-7666.61 5329.55,-7542.82 5275.56,-7460.33 5267.64,-7448.22 5257.07,-7438.23 5245.14,-7429.98"/>
<polygon fill="black" stroke="black" points="5246.99,-7427 5236.69,-7424.54 5243.21,-7432.89 5246.99,-7427"/>
</g>
<!-- layer_6_attn_reduce -->
<g id="node53" class="node">
<title>layer_6_attn_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="4941.56" cy="-7508.41" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="4941.56" y="-7527.21" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="4941.56" y="-7512.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="4941.56" y="-7497.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4941.56" y="-7482.21" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_6_attn&#45;&gt;layer_6_attn_reduce -->
<g id="edge64" class="edge">
<title>layer_6_attn&#45;&gt;layer_6_attn_reduce</title>
<path fill="none" stroke="black" d="M4974.38,-7592.19C4971.07,-7583.82 4967.52,-7574.88 4964.03,-7566.07"/>
<polygon fill="black" stroke="black" points="4967.21,-7564.61 4960.27,-7556.6 4960.71,-7567.19 4967.21,-7564.61"/>
</g>
<!-- layer_6_attn_reduce&#45;&gt;layer_6_residual1 -->
<g id="edge66" class="edge">
<title>layer_6_attn_reduce&#45;&gt;layer_6_residual1</title>
<path fill="none" stroke="black" d="M5011.37,-7461.37C5027.02,-7451.05 5043.47,-7440.2 5058.62,-7430.21"/>
<polygon fill="black" stroke="black" points="5060.95,-7432.86 5067.37,-7424.43 5057.1,-7427.02 5060.95,-7432.86"/>
</g>
<!-- layer_6_norm2 -->
<g id="node55" class="node">
<title>layer_6_norm2</title>
<polygon fill="lightblue" stroke="black" points="5523.06,-7320.33 5064.06,-7320.33 5064.06,-7252.33 5523.06,-7252.33 5523.06,-7320.33"/>
<text text-anchor="middle" x="5293.56" y="-7305.13" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 6)</text>
<text text-anchor="middle" x="5293.56" y="-7290.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5293.56" y="-7275.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5293.56" y="-7260.13" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_6_residual1&#45;&gt;layer_6_norm2 -->
<g id="edge67" class="edge">
<title>layer_6_residual1&#45;&gt;layer_6_norm2</title>
<path fill="none" stroke="black" d="M5174.7,-7356.21C5191.54,-7346.46 5210.11,-7335.7 5227.46,-7325.64"/>
<polygon fill="black" stroke="black" points="5229.51,-7328.5 5236.41,-7320.46 5226,-7322.44 5229.51,-7328.5"/>
</g>
<!-- layer_6_residual2 -->
<g id="node58" class="node">
<title>layer_6_residual2</title>
<polygon fill="lightblue" stroke="black" points="5412.06,-6972.66 4573.06,-6972.66 4573.06,-6904.66 5412.06,-6904.66 5412.06,-6972.66"/>
<text text-anchor="middle" x="4992.56" y="-6957.46" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4992.56" y="-6942.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4992.56" y="-6927.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4992.56" y="-6912.46" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_6_residual1&#45;&gt;layer_6_residual2 -->
<g id="edge70" class="edge">
<title>layer_6_residual1&#45;&gt;layer_6_residual2</title>
<path fill="none" stroke="black" d="M5081.6,-7356.14C5071.9,-7345.54 5062.25,-7333.19 5055.56,-7320.33 4997.69,-7209.01 4990.78,-7056.83 4991.23,-6983.15"/>
<polygon fill="black" stroke="black" points="4994.74,-6982.91 4991.35,-6972.87 4987.74,-6982.83 4994.74,-6982.91"/>
</g>
<!-- layer_6_mlp -->
<g id="node56" class="node">
<title>layer_6_mlp</title>
<polygon fill="lightblue" stroke="black" points="5571.06,-7216.33 5112.06,-7216.33 5112.06,-7148.33 5571.06,-7148.33 5571.06,-7216.33"/>
<text text-anchor="middle" x="5341.56" y="-7201.13" font-family="Times,serif" font-size="14.00">MLP&#45;TP (Layer 6)</text>
<text text-anchor="middle" x="5341.56" y="-7186.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="5341.56" y="-7171.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="5341.56" y="-7156.13" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_6_norm2&#45;&gt;layer_6_mlp -->
<g id="edge68" class="edge">
<title>layer_6_norm2&#45;&gt;layer_6_mlp</title>
<path fill="none" stroke="black" d="M5309.15,-7252.21C5313.13,-7243.75 5317.46,-7234.54 5321.63,-7225.68"/>
<polygon fill="black" stroke="black" points="5324.8,-7227.17 5325.89,-7216.63 5318.47,-7224.19 5324.8,-7227.17"/>
</g>
<!-- layer_6_mlp_reduce -->
<g id="node57" class="node">
<title>layer_6_mlp_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="5341.56" cy="-7064.25" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="5341.56" y="-7083.05" font-family="Times,serif" font-size="14.00">All&#45;Reduce MLP</text>
<text text-anchor="middle" x="5341.56" y="-7068.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="5341.56" y="-7053.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5341.56" y="-7038.05" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_6_mlp&#45;&gt;layer_6_mlp_reduce -->
<g id="edge69" class="edge">
<title>layer_6_mlp&#45;&gt;layer_6_mlp_reduce</title>
<path fill="none" stroke="black" d="M5341.56,-7148.07C5341.56,-7140.07 5341.56,-7131.31 5341.56,-7122.56"/>
<polygon fill="black" stroke="black" points="5345.06,-7122.36 5341.56,-7112.36 5338.06,-7122.36 5345.06,-7122.36"/>
</g>
<!-- layer_7_norm -->
<g id="node59" class="node">
<title>layer_7_norm</title>
<polygon fill="lightblue" stroke="black" points="6143.06,-7098.25 5684.06,-7098.25 5684.06,-7030.25 6143.06,-7030.25 6143.06,-7098.25"/>
<text text-anchor="middle" x="5913.56" y="-7083.05" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 7)</text>
<text text-anchor="middle" x="5913.56" y="-7068.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5913.56" y="-7053.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5913.56" y="-7038.05" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_6_mlp&#45;&gt;layer_7_norm -->
<g id="edge72" class="edge">
<title>layer_6_mlp&#45;&gt;layer_7_norm</title>
<path fill="none" stroke="black" d="M5504.33,-7148.3C5578.13,-7133.32 5665.46,-7115.6 5740.46,-7100.38"/>
<polygon fill="black" stroke="black" points="5741.38,-7103.76 5750.49,-7098.34 5739.99,-7096.9 5741.38,-7103.76"/>
</g>
<!-- layer_6_mlp_reduce&#45;&gt;layer_6_residual2 -->
<g id="edge71" class="edge">
<title>layer_6_mlp_reduce&#45;&gt;layer_6_residual2</title>
<path fill="none" stroke="black" d="M5218.52,-7019.68C5178.35,-7005.45 5134.2,-6989.82 5095.66,-6976.17"/>
<polygon fill="black" stroke="black" points="5096.58,-6972.78 5085.98,-6972.75 5094.24,-6979.38 5096.58,-6972.78"/>
</g>
<!-- layer_7_attn -->
<g id="node60" class="node">
<title>layer_7_attn</title>
<polygon fill="lightblue" stroke="black" points="6010.56,-6980.16 5560.56,-6980.16 5560.56,-6897.16 6010.56,-6897.16 6010.56,-6980.16"/>
<text text-anchor="middle" x="5785.56" y="-6964.96" font-family="Times,serif" font-size="14.00">MHA&#45;TP (Layer 7)</text>
<text text-anchor="middle" x="5785.56" y="-6949.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="5785.56" y="-6934.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="5785.56" y="-6919.96" font-family="Times,serif" font-size="14.00">Per GPU: 4 heads, head_dim=128</text>
<text text-anchor="middle" x="5785.56" y="-6904.96" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_7_norm&#45;&gt;layer_7_attn -->
<g id="edge73" class="edge">
<title>layer_7_norm&#45;&gt;layer_7_attn</title>
<path fill="none" stroke="black" d="M5879.26,-7030.13C5865.77,-7017.1 5850.01,-7001.88 5835.31,-6987.69"/>
<polygon fill="black" stroke="black" points="5837.36,-6984.81 5827.73,-6980.38 5832.49,-6989.84 5837.36,-6984.81"/>
</g>
<!-- layer_7_residual1 -->
<g id="node62" class="node">
<title>layer_7_residual1</title>
<polygon fill="lightblue" stroke="black" points="6283.06,-6729 5444.06,-6729 5444.06,-6661 6283.06,-6661 6283.06,-6729"/>
<text text-anchor="middle" x="5863.56" y="-6713.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5863.56" y="-6698.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5863.56" y="-6683.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5863.56" y="-6668.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_7_norm&#45;&gt;layer_7_residual1 -->
<g id="edge75" class="edge">
<title>layer_7_norm&#45;&gt;layer_7_residual1</title>
<path fill="none" stroke="black" d="M5974.03,-7030.21C5991.98,-7017.15 6009.52,-7000.37 6019.56,-6980.16 6062.14,-6894.53 6073.93,-6845.02 6021.56,-6765 6013.64,-6752.89 6003.07,-6742.89 5991.14,-6734.65"/>
<polygon fill="black" stroke="black" points="5992.99,-6731.67 5982.69,-6729.21 5989.21,-6737.56 5992.99,-6731.67"/>
</g>
<!-- layer_7_attn_reduce -->
<g id="node61" class="node">
<title>layer_7_attn_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="5687.56" cy="-6813.08" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="5687.56" y="-6831.88" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="5687.56" y="-6816.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="5687.56" y="-6801.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5687.56" y="-6786.88" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_7_attn&#45;&gt;layer_7_attn_reduce -->
<g id="edge74" class="edge">
<title>layer_7_attn&#45;&gt;layer_7_attn_reduce</title>
<path fill="none" stroke="black" d="M5753.2,-6896.86C5746.22,-6888.05 5738.72,-6878.59 5731.38,-6869.33"/>
<polygon fill="black" stroke="black" points="5733.94,-6866.93 5724.98,-6861.27 5728.46,-6871.28 5733.94,-6866.93"/>
</g>
<!-- layer_7_attn_reduce&#45;&gt;layer_7_residual1 -->
<g id="edge76" class="edge">
<title>layer_7_attn_reduce&#45;&gt;layer_7_residual1</title>
<path fill="none" stroke="black" d="M5757.37,-6766.03C5773.02,-6755.72 5789.47,-6744.87 5804.62,-6734.88"/>
<polygon fill="black" stroke="black" points="5806.95,-6737.53 5813.37,-6729.1 5803.1,-6731.68 5806.95,-6737.53"/>
</g>
<!-- layer_7_norm2 -->
<g id="node63" class="node">
<title>layer_7_norm2</title>
<polygon fill="lightblue" stroke="black" points="5964.06,-6625 5505.06,-6625 5505.06,-6557 5964.06,-6557 5964.06,-6625"/>
<text text-anchor="middle" x="5734.56" y="-6609.8" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 7)</text>
<text text-anchor="middle" x="5734.56" y="-6594.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5734.56" y="-6579.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5734.56" y="-6564.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_7_residual1&#45;&gt;layer_7_norm2 -->
<g id="edge77" class="edge">
<title>layer_7_residual1&#45;&gt;layer_7_norm2</title>
<path fill="none" stroke="black" d="M5821.68,-6660.88C5809.85,-6651.53 5796.86,-6641.26 5784.6,-6631.57"/>
<polygon fill="black" stroke="black" points="5786.69,-6628.75 5776.68,-6625.3 5782.35,-6634.24 5786.69,-6628.75"/>
</g>
<!-- layer_7_residual2 -->
<g id="node66" class="node">
<title>layer_7_residual2</title>
<polygon fill="lightblue" stroke="black" points="6258.06,-6284.83 5419.06,-6284.83 5419.06,-6216.83 6258.06,-6216.83 6258.06,-6284.83"/>
<text text-anchor="middle" x="5838.56" y="-6269.63" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5838.56" y="-6254.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5838.56" y="-6239.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5838.56" y="-6224.63" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (all)</text>
</g>
<!-- layer_7_residual1&#45;&gt;layer_7_residual2 -->
<g id="edge80" class="edge">
<title>layer_7_residual1&#45;&gt;layer_7_residual2</title>
<path fill="none" stroke="black" d="M5937.01,-6660.96C5951.24,-6651.33 5964.52,-6639.41 5973.56,-6625 6045.62,-6510.16 6070.8,-6434.27 5996.56,-6320.83 5988.64,-6308.72 5978.07,-6298.73 5966.14,-6290.48"/>
<polygon fill="black" stroke="black" points="5967.99,-6287.5 5957.69,-6285.04 5964.21,-6293.39 5967.99,-6287.5"/>
</g>
<!-- layer_7_mlp -->
<g id="node64" class="node">
<title>layer_7_mlp</title>
<polygon fill="lightblue" stroke="black" points="5940.06,-6521 5481.06,-6521 5481.06,-6453 5940.06,-6453 5940.06,-6521"/>
<text text-anchor="middle" x="5710.56" y="-6505.8" font-family="Times,serif" font-size="14.00">MLP&#45;TP (Layer 7)</text>
<text text-anchor="middle" x="5710.56" y="-6490.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="5710.56" y="-6475.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="5710.56" y="-6460.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_7_norm2&#45;&gt;layer_7_mlp -->
<g id="edge78" class="edge">
<title>layer_7_norm2&#45;&gt;layer_7_mlp</title>
<path fill="none" stroke="black" d="M5726.77,-6556.88C5724.84,-6548.69 5722.75,-6539.79 5720.72,-6531.19"/>
<polygon fill="black" stroke="black" points="5724.09,-6530.23 5718.4,-6521.3 5717.28,-6531.83 5724.09,-6530.23"/>
</g>
<!-- layer_7_mlp_reduce -->
<g id="node65" class="node">
<title>layer_7_mlp_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="5662.56" cy="-6368.91" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="5662.56" y="-6387.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce MLP</text>
<text text-anchor="middle" x="5662.56" y="-6372.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="5662.56" y="-6357.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5662.56" y="-6342.71" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- layer_7_mlp&#45;&gt;layer_7_mlp_reduce -->
<g id="edge79" class="edge">
<title>layer_7_mlp&#45;&gt;layer_7_mlp_reduce</title>
<path fill="none" stroke="black" d="M5696.81,-6452.73C5693.39,-6444.48 5689.64,-6435.4 5685.91,-6426.37"/>
<polygon fill="black" stroke="black" points="5689.1,-6424.93 5682.04,-6417.02 5682.63,-6427.6 5689.1,-6424.93"/>
</g>
<!-- layer_7_mlp_reduce&#45;&gt;layer_7_residual2 -->
<g id="edge81" class="edge">
<title>layer_7_mlp_reduce&#45;&gt;layer_7_residual2</title>
<path fill="none" stroke="black" d="M5732.37,-6321.87C5748.02,-6311.55 5764.47,-6300.7 5779.62,-6290.71"/>
<polygon fill="black" stroke="black" points="5781.95,-6293.36 5788.37,-6284.93 5778.1,-6287.52 5781.95,-6293.36"/>
</g>
<!-- pipeline_send -->
<g id="node67" class="node">
<title>pipeline_send</title>
<ellipse fill="lightyellow" stroke="black" cx="5838.56" cy="-6132.75" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="5838.56" y="-6151.55" font-family="Times,serif" font-size="14.00">Send Pipeline</text>
<text text-anchor="middle" x="5838.56" y="-6136.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5838.56" y="-6121.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5838.56" y="-6106.55" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7  8&#45;15</text>
</g>
<!-- layer_7_residual2&#45;&gt;pipeline_send -->
<g id="edge82" class="edge">
<title>layer_7_residual2&#45;&gt;pipeline_send</title>
<path fill="none" stroke="black" d="M5838.56,-6216.57C5838.56,-6208.57 5838.56,-6199.81 5838.56,-6191.06"/>
<polygon fill="black" stroke="black" points="5842.06,-6190.86 5838.56,-6180.86 5835.06,-6190.86 5842.06,-6190.86"/>
</g>
<!-- stage1_start -->
<g id="node68" class="node">
<title>stage1_start</title>
<polygon fill="lightgreen" stroke="black" points="5977.41,-6048.66 5756.53,-6048.66 5699.71,-5942.66 5920.59,-5942.66 5977.41,-6048.66"/>
<text text-anchor="middle" x="5838.56" y="-6006.96" font-family="Times,serif" font-size="14.00">Pipeline Stage 1</text>
<text text-anchor="middle" x="5838.56" y="-5991.96" font-family="Times,serif" font-size="14.00">Layers 8&#45;15</text>
<text text-anchor="middle" x="5838.56" y="-5976.96" font-family="Times,serif" font-size="14.00">Devices: 8&#45;15</text>
</g>
<!-- pipeline_send&#45;&gt;stage1_start -->
<g id="edge83" class="edge">
<title>pipeline_send&#45;&gt;stage1_start</title>
<path fill="none" stroke="black" d="M5838.56,-6084.5C5838.56,-6076.19 5838.56,-6067.43 5838.56,-6058.78"/>
<polygon fill="black" stroke="black" points="5842.06,-6058.72 5838.56,-6048.72 5835.06,-6058.72 5842.06,-6058.72"/>
</g>
<!-- layer_8_norm -->
<g id="node69" class="node">
<title>layer_8_norm</title>
<polygon fill="lightblue" stroke="black" points="6068.06,-5906.66 5609.06,-5906.66 5609.06,-5838.66 6068.06,-5838.66 6068.06,-5906.66"/>
<text text-anchor="middle" x="5838.56" y="-5891.46" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 8)</text>
<text text-anchor="middle" x="5838.56" y="-5876.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5838.56" y="-5861.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5838.56" y="-5846.46" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- stage1_start&#45;&gt;layer_8_norm -->
<g id="edge84" class="edge">
<title>stage1_start&#45;&gt;layer_8_norm</title>
<path fill="none" stroke="black" d="M5838.56,-5942.65C5838.56,-5934.09 5838.56,-5925.3 5838.56,-5916.99"/>
<polygon fill="black" stroke="black" points="5842.06,-5916.76 5838.56,-5906.76 5835.06,-5916.76 5842.06,-5916.76"/>
</g>
<!-- layer_8_attn -->
<g id="node70" class="node">
<title>layer_8_attn</title>
<polygon fill="lightblue" stroke="black" points="5937.56,-5802.66 5487.56,-5802.66 5487.56,-5719.66 5937.56,-5719.66 5937.56,-5802.66"/>
<text text-anchor="middle" x="5712.56" y="-5787.46" font-family="Times,serif" font-size="14.00">MHA&#45;TP (Layer 8)</text>
<text text-anchor="middle" x="5712.56" y="-5772.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="5712.56" y="-5757.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="5712.56" y="-5742.46" font-family="Times,serif" font-size="14.00">Per GPU: 4 heads, head_dim=128</text>
<text text-anchor="middle" x="5712.56" y="-5727.46" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_8_norm&#45;&gt;layer_8_attn -->
<g id="edge85" class="edge">
<title>layer_8_norm&#45;&gt;layer_8_attn</title>
<path fill="none" stroke="black" d="M5800.42,-5838.51C5789.94,-5829.41 5778.37,-5819.36 5767.17,-5809.62"/>
<polygon fill="black" stroke="black" points="5769.33,-5806.86 5759.48,-5802.94 5764.74,-5812.14 5769.33,-5806.86"/>
</g>
<!-- layer_8_residual1 -->
<g id="node72" class="node">
<title>layer_8_residual1</title>
<polygon fill="lightblue" stroke="black" points="6258.06,-5551.5 5419.06,-5551.5 5419.06,-5483.5 6258.06,-5483.5 6258.06,-5551.5"/>
<text text-anchor="middle" x="5838.56" y="-5536.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5838.56" y="-5521.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5838.56" y="-5506.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5838.56" y="-5491.3" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_8_norm&#45;&gt;layer_8_residual1 -->
<g id="edge87" class="edge">
<title>layer_8_norm&#45;&gt;layer_8_residual1</title>
<path fill="none" stroke="black" d="M5904.41,-5838.52C5919.69,-5828.57 5934.88,-5816.53 5946.56,-5802.66 6009.81,-5727.58 6050.33,-5669.65 5996.56,-5587.5 5988.64,-5575.39 5978.07,-5565.39 5966.14,-5557.15"/>
<polygon fill="black" stroke="black" points="5967.99,-5554.17 5957.69,-5551.71 5964.21,-5560.06 5967.99,-5554.17"/>
</g>
<!-- layer_8_attn_reduce -->
<g id="node71" class="node">
<title>layer_8_attn_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="5662.56" cy="-5635.58" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="5662.56" y="-5654.38" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="5662.56" y="-5639.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="5662.56" y="-5624.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5662.56" y="-5609.38" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_8_attn&#45;&gt;layer_8_attn_reduce -->
<g id="edge86" class="edge">
<title>layer_8_attn&#45;&gt;layer_8_attn_reduce</title>
<path fill="none" stroke="black" d="M5696.05,-5719.36C5692.67,-5710.99 5689.05,-5702.05 5685.48,-5693.24"/>
<polygon fill="black" stroke="black" points="5688.65,-5691.73 5681.65,-5683.77 5682.16,-5694.36 5688.65,-5691.73"/>
</g>
<!-- layer_8_attn_reduce&#45;&gt;layer_8_residual1 -->
<g id="edge88" class="edge">
<title>layer_8_attn_reduce&#45;&gt;layer_8_residual1</title>
<path fill="none" stroke="black" d="M5732.37,-5588.54C5748.02,-5578.22 5764.47,-5567.37 5779.62,-5557.38"/>
<polygon fill="black" stroke="black" points="5781.95,-5560.03 5788.37,-5551.6 5778.1,-5554.19 5781.95,-5560.03"/>
</g>
<!-- layer_8_norm2 -->
<g id="node73" class="node">
<title>layer_8_norm2</title>
<polygon fill="lightblue" stroke="black" points="6244.06,-5447.5 5785.06,-5447.5 5785.06,-5379.5 6244.06,-5379.5 6244.06,-5447.5"/>
<text text-anchor="middle" x="6014.56" y="-5432.3" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 8)</text>
<text text-anchor="middle" x="6014.56" y="-5417.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6014.56" y="-5402.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6014.56" y="-5387.3" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_8_residual1&#45;&gt;layer_8_norm2 -->
<g id="edge89" class="edge">
<title>layer_8_residual1&#45;&gt;layer_8_norm2</title>
<path fill="none" stroke="black" d="M5895.7,-5483.38C5912.54,-5473.62 5931.11,-5462.86 5948.46,-5452.81"/>
<polygon fill="black" stroke="black" points="5950.51,-5455.67 5957.41,-5447.62 5947,-5449.61 5950.51,-5455.67"/>
</g>
<!-- layer_8_residual2 -->
<g id="node76" class="node">
<title>layer_8_residual2</title>
<polygon fill="lightblue" stroke="black" points="6259.06,-5099.83 5420.06,-5099.83 5420.06,-5031.83 6259.06,-5031.83 6259.06,-5099.83"/>
<text text-anchor="middle" x="5839.56" y="-5084.63" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5839.56" y="-5069.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5839.56" y="-5054.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5839.56" y="-5039.63" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_8_residual1&#45;&gt;layer_8_residual2 -->
<g id="edge92" class="edge">
<title>layer_8_residual1&#45;&gt;layer_8_residual2</title>
<path fill="none" stroke="black" d="M5802.6,-5483.31C5792.9,-5472.7 5783.25,-5460.36 5776.56,-5447.5 5713.44,-5326.07 5664.92,-5264.49 5728.56,-5143.33 5736.27,-5128.66 5748.2,-5116.25 5761.44,-5105.98"/>
<polygon fill="black" stroke="black" points="5763.81,-5108.58 5769.82,-5099.86 5759.68,-5102.93 5763.81,-5108.58"/>
</g>
<!-- layer_8_mlp -->
<g id="node74" class="node">
<title>layer_8_mlp</title>
<polygon fill="lightblue" stroke="black" points="6292.06,-5343.5 5833.06,-5343.5 5833.06,-5275.5 6292.06,-5275.5 6292.06,-5343.5"/>
<text text-anchor="middle" x="6062.56" y="-5328.3" font-family="Times,serif" font-size="14.00">MLP&#45;TP (Layer 8)</text>
<text text-anchor="middle" x="6062.56" y="-5313.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="6062.56" y="-5298.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="6062.56" y="-5283.3" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_8_norm2&#45;&gt;layer_8_mlp -->
<g id="edge90" class="edge">
<title>layer_8_norm2&#45;&gt;layer_8_mlp</title>
<path fill="none" stroke="black" d="M6030.15,-5379.38C6034.13,-5370.92 6038.46,-5361.71 6042.63,-5352.85"/>
<polygon fill="black" stroke="black" points="6045.8,-5354.34 6046.89,-5343.8 6039.47,-5351.36 6045.8,-5354.34"/>
</g>
<!-- layer_8_mlp_reduce -->
<g id="node75" class="node">
<title>layer_8_mlp_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="6062.56" cy="-5191.41" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="6062.56" y="-5210.21" font-family="Times,serif" font-size="14.00">All&#45;Reduce MLP</text>
<text text-anchor="middle" x="6062.56" y="-5195.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="6062.56" y="-5180.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6062.56" y="-5165.21" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_8_mlp&#45;&gt;layer_8_mlp_reduce -->
<g id="edge91" class="edge">
<title>layer_8_mlp&#45;&gt;layer_8_mlp_reduce</title>
<path fill="none" stroke="black" d="M6062.56,-5275.23C6062.56,-5267.24 6062.56,-5258.47 6062.56,-5249.73"/>
<polygon fill="black" stroke="black" points="6066.06,-5249.52 6062.56,-5239.52 6059.06,-5249.52 6066.06,-5249.52"/>
</g>
<!-- layer_9_norm -->
<g id="node77" class="node">
<title>layer_9_norm</title>
<polygon fill="lightblue" stroke="black" points="6864.06,-5225.41 6405.06,-5225.41 6405.06,-5157.41 6864.06,-5157.41 6864.06,-5225.41"/>
<text text-anchor="middle" x="6634.56" y="-5210.21" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 9)</text>
<text text-anchor="middle" x="6634.56" y="-5195.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6634.56" y="-5180.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6634.56" y="-5165.21" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_8_mlp&#45;&gt;layer_9_norm -->
<g id="edge94" class="edge">
<title>layer_8_mlp&#45;&gt;layer_9_norm</title>
<path fill="none" stroke="black" d="M6225.33,-5275.47C6299.13,-5260.49 6386.46,-5242.76 6461.46,-5227.54"/>
<polygon fill="black" stroke="black" points="6462.38,-5230.93 6471.49,-5225.51 6460.99,-5224.07 6462.38,-5230.93"/>
</g>
<!-- layer_8_mlp_reduce&#45;&gt;layer_8_residual2 -->
<g id="edge93" class="edge">
<title>layer_8_mlp_reduce&#45;&gt;layer_8_residual2</title>
<path fill="none" stroke="black" d="M5980.16,-5144.75C5956.5,-5131.64 5930.96,-5117.48 5908.23,-5104.88"/>
<polygon fill="black" stroke="black" points="5909.77,-5101.74 5899.33,-5099.95 5906.38,-5107.86 5909.77,-5101.74"/>
</g>
<!-- layer_9_attn -->
<g id="node78" class="node">
<title>layer_9_attn</title>
<polygon fill="lightblue" stroke="black" points="6731.56,-5107.33 6281.56,-5107.33 6281.56,-5024.33 6731.56,-5024.33 6731.56,-5107.33"/>
<text text-anchor="middle" x="6506.56" y="-5092.13" font-family="Times,serif" font-size="14.00">MHA&#45;TP (Layer 9)</text>
<text text-anchor="middle" x="6506.56" y="-5077.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="6506.56" y="-5062.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="6506.56" y="-5047.13" font-family="Times,serif" font-size="14.00">Per GPU: 4 heads, head_dim=128</text>
<text text-anchor="middle" x="6506.56" y="-5032.13" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_9_norm&#45;&gt;layer_9_attn -->
<g id="edge95" class="edge">
<title>layer_9_norm&#45;&gt;layer_9_attn</title>
<path fill="none" stroke="black" d="M6600.26,-5157.3C6586.77,-5144.27 6571.01,-5129.05 6556.31,-5114.86"/>
<polygon fill="black" stroke="black" points="6558.36,-5111.97 6548.73,-5107.55 6553.49,-5117.01 6558.36,-5111.97"/>
</g>
<!-- layer_9_residual1 -->
<g id="node80" class="node">
<title>layer_9_residual1</title>
<polygon fill="lightblue" stroke="black" points="7004.06,-4856.16 6165.06,-4856.16 6165.06,-4788.16 7004.06,-4788.16 7004.06,-4856.16"/>
<text text-anchor="middle" x="6584.56" y="-4840.96" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6584.56" y="-4825.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6584.56" y="-4810.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6584.56" y="-4795.96" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_9_norm&#45;&gt;layer_9_residual1 -->
<g id="edge97" class="edge">
<title>layer_9_norm&#45;&gt;layer_9_residual1</title>
<path fill="none" stroke="black" d="M6695.03,-5157.38C6712.98,-5144.31 6730.52,-5127.54 6740.56,-5107.33 6783.14,-5021.7 6794.93,-4972.18 6742.56,-4892.16 6734.64,-4880.06 6724.07,-4870.06 6712.14,-4861.81"/>
<polygon fill="black" stroke="black" points="6713.99,-4858.84 6703.69,-4856.38 6710.21,-4864.73 6713.99,-4858.84"/>
</g>
<!-- layer_9_attn_reduce -->
<g id="node79" class="node">
<title>layer_9_attn_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="6408.56" cy="-4940.25" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="6408.56" y="-4959.05" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="6408.56" y="-4944.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="6408.56" y="-4929.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6408.56" y="-4914.05" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_9_attn&#45;&gt;layer_9_attn_reduce -->
<g id="edge96" class="edge">
<title>layer_9_attn&#45;&gt;layer_9_attn_reduce</title>
<path fill="none" stroke="black" d="M6474.2,-5024.02C6467.22,-5015.21 6459.72,-5005.76 6452.38,-4996.5"/>
<polygon fill="black" stroke="black" points="6454.94,-4994.1 6445.98,-4988.44 6449.46,-4998.45 6454.94,-4994.1"/>
</g>
<!-- layer_9_attn_reduce&#45;&gt;layer_9_residual1 -->
<g id="edge98" class="edge">
<title>layer_9_attn_reduce&#45;&gt;layer_9_residual1</title>
<path fill="none" stroke="black" d="M6478.37,-4893.2C6494.02,-4882.88 6510.47,-4872.04 6525.62,-4862.04"/>
<polygon fill="black" stroke="black" points="6527.95,-4864.7 6534.37,-4856.27 6524.1,-4858.85 6527.95,-4864.7"/>
</g>
<!-- layer_9_norm2 -->
<g id="node81" class="node">
<title>layer_9_norm2</title>
<polygon fill="lightblue" stroke="black" points="6990.06,-4752.16 6531.06,-4752.16 6531.06,-4684.16 6990.06,-4684.16 6990.06,-4752.16"/>
<text text-anchor="middle" x="6760.56" y="-4736.96" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 9)</text>
<text text-anchor="middle" x="6760.56" y="-4721.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6760.56" y="-4706.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6760.56" y="-4691.96" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_9_residual1&#45;&gt;layer_9_norm2 -->
<g id="edge99" class="edge">
<title>layer_9_residual1&#45;&gt;layer_9_norm2</title>
<path fill="none" stroke="black" d="M6641.7,-4788.05C6658.54,-4778.29 6677.11,-4767.53 6694.46,-4757.48"/>
<polygon fill="black" stroke="black" points="6696.51,-4760.33 6703.41,-4752.29 6693,-4754.28 6696.51,-4760.33"/>
</g>
<!-- layer_9_residual2 -->
<g id="node84" class="node">
<title>layer_9_residual2</title>
<polygon fill="lightblue" stroke="black" points="6879.06,-4404.5 6040.06,-4404.5 6040.06,-4336.5 6879.06,-4336.5 6879.06,-4404.5"/>
<text text-anchor="middle" x="6459.56" y="-4389.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6459.56" y="-4374.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6459.56" y="-4359.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6459.56" y="-4344.3" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_9_residual1&#45;&gt;layer_9_residual2 -->
<g id="edge102" class="edge">
<title>layer_9_residual1&#45;&gt;layer_9_residual2</title>
<path fill="none" stroke="black" d="M6548.6,-4787.97C6538.9,-4777.37 6529.25,-4765.03 6522.56,-4752.16 6464.69,-4640.85 6457.78,-4488.66 6458.23,-4414.99"/>
<polygon fill="black" stroke="black" points="6461.74,-4414.74 6458.35,-4404.7 6454.74,-4414.66 6461.74,-4414.74"/>
</g>
<!-- layer_9_mlp -->
<g id="node82" class="node">
<title>layer_9_mlp</title>
<polygon fill="lightblue" stroke="black" points="7038.06,-4648.16 6579.06,-4648.16 6579.06,-4580.16 7038.06,-4580.16 7038.06,-4648.16"/>
<text text-anchor="middle" x="6808.56" y="-4632.96" font-family="Times,serif" font-size="14.00">MLP&#45;TP (Layer 9)</text>
<text text-anchor="middle" x="6808.56" y="-4617.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="6808.56" y="-4602.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="6808.56" y="-4587.96" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_9_norm2&#45;&gt;layer_9_mlp -->
<g id="edge100" class="edge">
<title>layer_9_norm2&#45;&gt;layer_9_mlp</title>
<path fill="none" stroke="black" d="M6776.15,-4684.05C6780.13,-4675.59 6784.46,-4666.37 6788.63,-4657.52"/>
<polygon fill="black" stroke="black" points="6791.8,-4659 6792.89,-4648.46 6785.47,-4656.02 6791.8,-4659"/>
</g>
<!-- layer_9_mlp_reduce -->
<g id="node83" class="node">
<title>layer_9_mlp_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="6808.56" cy="-4496.08" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="6808.56" y="-4514.88" font-family="Times,serif" font-size="14.00">All&#45;Reduce MLP</text>
<text text-anchor="middle" x="6808.56" y="-4499.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="6808.56" y="-4484.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6808.56" y="-4469.88" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_9_mlp&#45;&gt;layer_9_mlp_reduce -->
<g id="edge101" class="edge">
<title>layer_9_mlp&#45;&gt;layer_9_mlp_reduce</title>
<path fill="none" stroke="black" d="M6808.56,-4579.9C6808.56,-4571.91 6808.56,-4563.14 6808.56,-4554.4"/>
<polygon fill="black" stroke="black" points="6812.06,-4554.19 6808.56,-4544.19 6805.06,-4554.19 6812.06,-4554.19"/>
</g>
<!-- layer_10_norm -->
<g id="node85" class="node">
<title>layer_10_norm</title>
<polygon fill="lightblue" stroke="black" points="7610.06,-4530.08 7151.06,-4530.08 7151.06,-4462.08 7610.06,-4462.08 7610.06,-4530.08"/>
<text text-anchor="middle" x="7380.56" y="-4514.88" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 10)</text>
<text text-anchor="middle" x="7380.56" y="-4499.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7380.56" y="-4484.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7380.56" y="-4469.88" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_9_mlp&#45;&gt;layer_10_norm -->
<g id="edge104" class="edge">
<title>layer_9_mlp&#45;&gt;layer_10_norm</title>
<path fill="none" stroke="black" d="M6971.33,-4580.13C7045.13,-4565.16 7132.46,-4547.43 7207.46,-4532.21"/>
<polygon fill="black" stroke="black" points="7208.38,-4535.6 7217.49,-4530.18 7206.99,-4528.74 7208.38,-4535.6"/>
</g>
<!-- layer_9_mlp_reduce&#45;&gt;layer_9_residual2 -->
<g id="edge103" class="edge">
<title>layer_9_mlp_reduce&#45;&gt;layer_9_residual2</title>
<path fill="none" stroke="black" d="M6685.52,-4451.51C6645.35,-4437.29 6601.2,-4421.65 6562.66,-4408"/>
<polygon fill="black" stroke="black" points="6563.58,-4404.62 6552.98,-4404.58 6561.24,-4411.22 6563.58,-4404.62"/>
</g>
<!-- layer_10_attn -->
<g id="node86" class="node">
<title>layer_10_attn</title>
<polygon fill="lightblue" stroke="black" points="7477.56,-4412 7027.56,-4412 7027.56,-4329 7477.56,-4329 7477.56,-4412"/>
<text text-anchor="middle" x="7252.56" y="-4396.8" font-family="Times,serif" font-size="14.00">MHA&#45;TP (Layer 10)</text>
<text text-anchor="middle" x="7252.56" y="-4381.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="7252.56" y="-4366.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="7252.56" y="-4351.8" font-family="Times,serif" font-size="14.00">Per GPU: 4 heads, head_dim=128</text>
<text text-anchor="middle" x="7252.56" y="-4336.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_10_norm&#45;&gt;layer_10_attn -->
<g id="edge105" class="edge">
<title>layer_10_norm&#45;&gt;layer_10_attn</title>
<path fill="none" stroke="black" d="M7346.26,-4461.96C7332.77,-4448.93 7317.01,-4433.72 7302.31,-4419.53"/>
<polygon fill="black" stroke="black" points="7304.36,-4416.64 7294.73,-4412.21 7299.49,-4421.68 7304.36,-4416.64"/>
</g>
<!-- layer_10_residual1 -->
<g id="node88" class="node">
<title>layer_10_residual1</title>
<polygon fill="lightblue" stroke="black" points="7750.06,-4160.83 6911.06,-4160.83 6911.06,-4092.83 7750.06,-4092.83 7750.06,-4160.83"/>
<text text-anchor="middle" x="7330.56" y="-4145.63" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7330.56" y="-4130.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7330.56" y="-4115.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7330.56" y="-4100.63" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_10_norm&#45;&gt;layer_10_residual1 -->
<g id="edge107" class="edge">
<title>layer_10_norm&#45;&gt;layer_10_residual1</title>
<path fill="none" stroke="black" d="M7441.03,-4462.04C7458.98,-4448.98 7476.52,-4432.2 7486.56,-4412 7529.14,-4326.37 7540.93,-4276.85 7488.56,-4196.83 7480.64,-4184.72 7470.07,-4174.73 7458.14,-4166.48"/>
<polygon fill="black" stroke="black" points="7459.99,-4163.51 7449.69,-4161.04 7456.21,-4169.39 7459.99,-4163.51"/>
</g>
<!-- layer_10_attn_reduce -->
<g id="node87" class="node">
<title>layer_10_attn_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="7154.56" cy="-4244.92" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="7154.56" y="-4263.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="7154.56" y="-4248.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="7154.56" y="-4233.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7154.56" y="-4218.72" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_10_attn&#45;&gt;layer_10_attn_reduce -->
<g id="edge106" class="edge">
<title>layer_10_attn&#45;&gt;layer_10_attn_reduce</title>
<path fill="none" stroke="black" d="M7220.2,-4328.69C7213.22,-4319.88 7205.72,-4310.43 7198.38,-4301.17"/>
<polygon fill="black" stroke="black" points="7200.94,-4298.77 7191.98,-4293.11 7195.46,-4303.12 7200.94,-4298.77"/>
</g>
<!-- layer_10_attn_reduce&#45;&gt;layer_10_residual1 -->
<g id="edge108" class="edge">
<title>layer_10_attn_reduce&#45;&gt;layer_10_residual1</title>
<path fill="none" stroke="black" d="M7224.37,-4197.87C7240.02,-4187.55 7256.47,-4176.7 7271.62,-4166.71"/>
<polygon fill="black" stroke="black" points="7273.95,-4169.36 7280.37,-4160.93 7270.1,-4163.52 7273.95,-4169.36"/>
</g>
<!-- layer_10_norm2 -->
<g id="node89" class="node">
<title>layer_10_norm2</title>
<polygon fill="lightblue" stroke="black" points="7736.06,-4056.83 7277.06,-4056.83 7277.06,-3988.83 7736.06,-3988.83 7736.06,-4056.83"/>
<text text-anchor="middle" x="7506.56" y="-4041.63" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 10)</text>
<text text-anchor="middle" x="7506.56" y="-4026.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7506.56" y="-4011.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7506.56" y="-3996.63" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_10_residual1&#45;&gt;layer_10_norm2 -->
<g id="edge109" class="edge">
<title>layer_10_residual1&#45;&gt;layer_10_norm2</title>
<path fill="none" stroke="black" d="M7387.7,-4092.72C7404.54,-4082.96 7423.11,-4072.2 7440.46,-4062.14"/>
<polygon fill="black" stroke="black" points="7442.51,-4065 7449.41,-4056.96 7439,-4058.94 7442.51,-4065"/>
</g>
<!-- layer_10_residual2 -->
<g id="node92" class="node">
<title>layer_10_residual2</title>
<polygon fill="lightblue" stroke="black" points="7751.06,-3709.17 6912.06,-3709.17 6912.06,-3641.17 7751.06,-3641.17 7751.06,-3709.17"/>
<text text-anchor="middle" x="7331.56" y="-3693.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7331.56" y="-3678.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7331.56" y="-3663.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7331.56" y="-3648.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_10_residual1&#45;&gt;layer_10_residual2 -->
<g id="edge112" class="edge">
<title>layer_10_residual1&#45;&gt;layer_10_residual2</title>
<path fill="none" stroke="black" d="M7294.6,-4092.64C7284.9,-4082.04 7275.25,-4069.69 7268.56,-4056.83 7205.44,-3935.4 7156.92,-3873.82 7220.56,-3752.67 7228.27,-3737.99 7240.2,-3725.59 7253.44,-3715.31"/>
<polygon fill="black" stroke="black" points="7255.81,-3717.92 7261.82,-3709.19 7251.68,-3712.26 7255.81,-3717.92"/>
</g>
<!-- layer_10_mlp -->
<g id="node90" class="node">
<title>layer_10_mlp</title>
<polygon fill="lightblue" stroke="black" points="7784.06,-3952.83 7325.06,-3952.83 7325.06,-3884.83 7784.06,-3884.83 7784.06,-3952.83"/>
<text text-anchor="middle" x="7554.56" y="-3937.63" font-family="Times,serif" font-size="14.00">MLP&#45;TP (Layer 10)</text>
<text text-anchor="middle" x="7554.56" y="-3922.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="7554.56" y="-3907.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="7554.56" y="-3892.63" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_10_norm2&#45;&gt;layer_10_mlp -->
<g id="edge110" class="edge">
<title>layer_10_norm2&#45;&gt;layer_10_mlp</title>
<path fill="none" stroke="black" d="M7522.15,-3988.72C7526.13,-3980.25 7530.46,-3971.04 7534.63,-3962.18"/>
<polygon fill="black" stroke="black" points="7537.8,-3963.67 7538.89,-3953.13 7531.47,-3960.69 7537.8,-3963.67"/>
</g>
<!-- layer_10_mlp_reduce -->
<g id="node91" class="node">
<title>layer_10_mlp_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="7554.56" cy="-3800.75" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="7554.56" y="-3819.55" font-family="Times,serif" font-size="14.00">All&#45;Reduce MLP</text>
<text text-anchor="middle" x="7554.56" y="-3804.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="7554.56" y="-3789.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7554.56" y="-3774.55" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_10_mlp&#45;&gt;layer_10_mlp_reduce -->
<g id="edge111" class="edge">
<title>layer_10_mlp&#45;&gt;layer_10_mlp_reduce</title>
<path fill="none" stroke="black" d="M7554.56,-3884.57C7554.56,-3876.57 7554.56,-3867.81 7554.56,-3859.06"/>
<polygon fill="black" stroke="black" points="7558.06,-3858.86 7554.56,-3848.86 7551.06,-3858.86 7558.06,-3858.86"/>
</g>
<!-- layer_11_norm -->
<g id="node93" class="node">
<title>layer_11_norm</title>
<polygon fill="lightblue" stroke="black" points="8356.06,-3834.75 7897.06,-3834.75 7897.06,-3766.75 8356.06,-3766.75 8356.06,-3834.75"/>
<text text-anchor="middle" x="8126.56" y="-3819.55" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 11)</text>
<text text-anchor="middle" x="8126.56" y="-3804.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="8126.56" y="-3789.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="8126.56" y="-3774.55" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_10_mlp&#45;&gt;layer_11_norm -->
<g id="edge114" class="edge">
<title>layer_10_mlp&#45;&gt;layer_11_norm</title>
<path fill="none" stroke="black" d="M7717.33,-3884.8C7791.13,-3869.82 7878.46,-3852.1 7953.46,-3836.88"/>
<polygon fill="black" stroke="black" points="7954.38,-3840.26 7963.49,-3834.84 7952.99,-3833.4 7954.38,-3840.26"/>
</g>
<!-- layer_10_mlp_reduce&#45;&gt;layer_10_residual2 -->
<g id="edge113" class="edge">
<title>layer_10_mlp_reduce&#45;&gt;layer_10_residual2</title>
<path fill="none" stroke="black" d="M7472.16,-3754.08C7448.5,-3740.97 7422.96,-3726.82 7400.23,-3714.22"/>
<polygon fill="black" stroke="black" points="7401.77,-3711.07 7391.33,-3709.29 7398.38,-3717.2 7401.77,-3711.07"/>
</g>
<!-- layer_11_attn -->
<g id="node94" class="node">
<title>layer_11_attn</title>
<polygon fill="lightblue" stroke="black" points="8223.56,-3716.67 7773.56,-3716.67 7773.56,-3633.67 8223.56,-3633.67 8223.56,-3716.67"/>
<text text-anchor="middle" x="7998.56" y="-3701.47" font-family="Times,serif" font-size="14.00">MHA&#45;TP (Layer 11)</text>
<text text-anchor="middle" x="7998.56" y="-3686.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="7998.56" y="-3671.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="7998.56" y="-3656.47" font-family="Times,serif" font-size="14.00">Per GPU: 4 heads, head_dim=128</text>
<text text-anchor="middle" x="7998.56" y="-3641.47" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_11_norm&#45;&gt;layer_11_attn -->
<g id="edge115" class="edge">
<title>layer_11_norm&#45;&gt;layer_11_attn</title>
<path fill="none" stroke="black" d="M8092.26,-3766.63C8078.77,-3753.6 8063.01,-3738.39 8048.31,-3724.19"/>
<polygon fill="black" stroke="black" points="8050.36,-3721.31 8040.73,-3716.88 8045.49,-3726.34 8050.36,-3721.31"/>
</g>
<!-- layer_11_residual1 -->
<g id="node96" class="node">
<title>layer_11_residual1</title>
<polygon fill="lightblue" stroke="black" points="8496.06,-3465.5 7657.06,-3465.5 7657.06,-3397.5 8496.06,-3397.5 8496.06,-3465.5"/>
<text text-anchor="middle" x="8076.56" y="-3450.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8076.56" y="-3435.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="8076.56" y="-3420.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="8076.56" y="-3405.3" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_11_norm&#45;&gt;layer_11_residual1 -->
<g id="edge117" class="edge">
<title>layer_11_norm&#45;&gt;layer_11_residual1</title>
<path fill="none" stroke="black" d="M8187.03,-3766.71C8204.98,-3753.65 8222.52,-3736.87 8232.56,-3716.67 8275.14,-3631.03 8286.93,-3581.52 8234.56,-3501.5 8226.64,-3489.39 8216.07,-3479.4 8204.14,-3471.15"/>
<polygon fill="black" stroke="black" points="8205.99,-3468.17 8195.69,-3465.71 8202.21,-3474.06 8205.99,-3468.17"/>
</g>
<!-- layer_11_attn_reduce -->
<g id="node95" class="node">
<title>layer_11_attn_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="7900.56" cy="-3549.58" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="7900.56" y="-3568.38" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="7900.56" y="-3553.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="7900.56" y="-3538.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7900.56" y="-3523.38" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_11_attn&#45;&gt;layer_11_attn_reduce -->
<g id="edge116" class="edge">
<title>layer_11_attn&#45;&gt;layer_11_attn_reduce</title>
<path fill="none" stroke="black" d="M7966.2,-3633.36C7959.22,-3624.55 7951.72,-3615.09 7944.38,-3605.84"/>
<polygon fill="black" stroke="black" points="7946.94,-3603.43 7937.98,-3597.77 7941.46,-3607.78 7946.94,-3603.43"/>
</g>
<!-- layer_11_attn_reduce&#45;&gt;layer_11_residual1 -->
<g id="edge118" class="edge">
<title>layer_11_attn_reduce&#45;&gt;layer_11_residual1</title>
<path fill="none" stroke="black" d="M7970.37,-3502.54C7986.02,-3492.22 8002.47,-3481.37 8017.62,-3471.38"/>
<polygon fill="black" stroke="black" points="8019.95,-3474.03 8026.37,-3465.6 8016.1,-3468.19 8019.95,-3474.03"/>
</g>
<!-- layer_11_norm2 -->
<g id="node97" class="node">
<title>layer_11_norm2</title>
<polygon fill="lightblue" stroke="black" points="8482.06,-3361.5 8023.06,-3361.5 8023.06,-3293.5 8482.06,-3293.5 8482.06,-3361.5"/>
<text text-anchor="middle" x="8252.56" y="-3346.3" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 11)</text>
<text text-anchor="middle" x="8252.56" y="-3331.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="8252.56" y="-3316.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="8252.56" y="-3301.3" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_11_residual1&#45;&gt;layer_11_norm2 -->
<g id="edge119" class="edge">
<title>layer_11_residual1&#45;&gt;layer_11_norm2</title>
<path fill="none" stroke="black" d="M8133.7,-3397.38C8150.54,-3387.62 8169.11,-3376.86 8186.46,-3366.81"/>
<polygon fill="black" stroke="black" points="8188.51,-3369.67 8195.41,-3361.62 8185,-3363.61 8188.51,-3369.67"/>
</g>
<!-- layer_11_residual2 -->
<g id="node100" class="node">
<title>layer_11_residual2</title>
<polygon fill="lightblue" stroke="black" points="8371.06,-3013.83 7532.06,-3013.83 7532.06,-2945.83 8371.06,-2945.83 8371.06,-3013.83"/>
<text text-anchor="middle" x="7951.56" y="-2998.63" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7951.56" y="-2983.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7951.56" y="-2968.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7951.56" y="-2953.63" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_11_residual1&#45;&gt;layer_11_residual2 -->
<g id="edge122" class="edge">
<title>layer_11_residual1&#45;&gt;layer_11_residual2</title>
<path fill="none" stroke="black" d="M8040.6,-3397.31C8030.9,-3386.71 8021.25,-3374.36 8014.56,-3361.5 7956.69,-3250.18 7949.78,-3098 7950.23,-3024.32"/>
<polygon fill="black" stroke="black" points="7953.74,-3024.08 7950.35,-3014.04 7946.74,-3024 7953.74,-3024.08"/>
</g>
<!-- layer_11_mlp -->
<g id="node98" class="node">
<title>layer_11_mlp</title>
<polygon fill="lightblue" stroke="black" points="8530.06,-3257.5 8071.06,-3257.5 8071.06,-3189.5 8530.06,-3189.5 8530.06,-3257.5"/>
<text text-anchor="middle" x="8300.56" y="-3242.3" font-family="Times,serif" font-size="14.00">MLP&#45;TP (Layer 11)</text>
<text text-anchor="middle" x="8300.56" y="-3227.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="8300.56" y="-3212.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="8300.56" y="-3197.3" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_11_norm2&#45;&gt;layer_11_mlp -->
<g id="edge120" class="edge">
<title>layer_11_norm2&#45;&gt;layer_11_mlp</title>
<path fill="none" stroke="black" d="M8268.15,-3293.38C8272.13,-3284.92 8276.46,-3275.71 8280.63,-3266.85"/>
<polygon fill="black" stroke="black" points="8283.8,-3268.34 8284.89,-3257.8 8277.47,-3265.36 8283.8,-3268.34"/>
</g>
<!-- layer_11_mlp_reduce -->
<g id="node99" class="node">
<title>layer_11_mlp_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="8300.56" cy="-3105.42" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="8300.56" y="-3124.22" font-family="Times,serif" font-size="14.00">All&#45;Reduce MLP</text>
<text text-anchor="middle" x="8300.56" y="-3109.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="8300.56" y="-3094.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="8300.56" y="-3079.22" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_11_mlp&#45;&gt;layer_11_mlp_reduce -->
<g id="edge121" class="edge">
<title>layer_11_mlp&#45;&gt;layer_11_mlp_reduce</title>
<path fill="none" stroke="black" d="M8300.56,-3189.23C8300.56,-3181.24 8300.56,-3172.47 8300.56,-3163.73"/>
<polygon fill="black" stroke="black" points="8304.06,-3163.53 8300.56,-3153.53 8297.06,-3163.53 8304.06,-3163.53"/>
</g>
<!-- layer_12_norm -->
<g id="node101" class="node">
<title>layer_12_norm</title>
<polygon fill="lightblue" stroke="black" points="9102.06,-3139.42 8643.06,-3139.42 8643.06,-3071.42 9102.06,-3071.42 9102.06,-3139.42"/>
<text text-anchor="middle" x="8872.56" y="-3124.22" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 12)</text>
<text text-anchor="middle" x="8872.56" y="-3109.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="8872.56" y="-3094.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="8872.56" y="-3079.22" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_11_mlp&#45;&gt;layer_12_norm -->
<g id="edge124" class="edge">
<title>layer_11_mlp&#45;&gt;layer_12_norm</title>
<path fill="none" stroke="black" d="M8463.33,-3189.47C8537.13,-3174.49 8624.46,-3156.77 8699.46,-3141.55"/>
<polygon fill="black" stroke="black" points="8700.38,-3144.93 8709.49,-3139.51 8698.99,-3138.07 8700.38,-3144.93"/>
</g>
<!-- layer_11_mlp_reduce&#45;&gt;layer_11_residual2 -->
<g id="edge123" class="edge">
<title>layer_11_mlp_reduce&#45;&gt;layer_11_residual2</title>
<path fill="none" stroke="black" d="M8177.52,-3060.84C8137.35,-3046.62 8093.2,-3030.99 8054.66,-3017.34"/>
<polygon fill="black" stroke="black" points="8055.58,-3013.95 8044.98,-3013.91 8053.24,-3020.55 8055.58,-3013.95"/>
</g>
<!-- layer_12_attn -->
<g id="node102" class="node">
<title>layer_12_attn</title>
<polygon fill="lightblue" stroke="black" points="8841.56,-3021.33 8391.56,-3021.33 8391.56,-2938.33 8841.56,-2938.33 8841.56,-3021.33"/>
<text text-anchor="middle" x="8616.56" y="-3006.13" font-family="Times,serif" font-size="14.00">MHA&#45;TP (Layer 12)</text>
<text text-anchor="middle" x="8616.56" y="-2991.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="8616.56" y="-2976.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="8616.56" y="-2961.13" font-family="Times,serif" font-size="14.00">Per GPU: 4 heads, head_dim=128</text>
<text text-anchor="middle" x="8616.56" y="-2946.13" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_12_norm&#45;&gt;layer_12_attn -->
<g id="edge125" class="edge">
<title>layer_12_norm&#45;&gt;layer_12_attn</title>
<path fill="none" stroke="black" d="M8803.96,-3071.3C8775.11,-3057.37 8741.09,-3040.95 8710.01,-3025.94"/>
<polygon fill="black" stroke="black" points="8711.43,-3022.74 8700.9,-3021.55 8708.39,-3029.05 8711.43,-3022.74"/>
</g>
<!-- layer_12_residual1 -->
<g id="node104" class="node">
<title>layer_12_residual1</title>
<polygon fill="lightblue" stroke="black" points="9163.06,-2770.17 8324.06,-2770.17 8324.06,-2702.17 9163.06,-2702.17 9163.06,-2770.17"/>
<text text-anchor="middle" x="8743.56" y="-2754.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8743.56" y="-2739.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="8743.56" y="-2724.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="8743.56" y="-2709.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_12_norm&#45;&gt;layer_12_residual1 -->
<g id="edge127" class="edge">
<title>layer_12_norm&#45;&gt;layer_12_residual1</title>
<path fill="none" stroke="black" d="M8888.34,-3071.19C8913.72,-3012.45 8955.55,-2888.65 8901.56,-2806.17 8893.64,-2794.06 8883.07,-2784.06 8871.14,-2775.81"/>
<polygon fill="black" stroke="black" points="8872.99,-2772.84 8862.69,-2770.38 8869.21,-2778.73 8872.99,-2772.84"/>
</g>
<!-- layer_12_attn_reduce -->
<g id="node103" class="node">
<title>layer_12_attn_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="8567.56" cy="-2854.25" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="8567.56" y="-2873.05" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="8567.56" y="-2858.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="8567.56" y="-2843.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="8567.56" y="-2828.05" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_12_attn&#45;&gt;layer_12_attn_reduce -->
<g id="edge126" class="edge">
<title>layer_12_attn&#45;&gt;layer_12_attn_reduce</title>
<path fill="none" stroke="black" d="M8600.38,-2938.02C8597.07,-2929.66 8593.52,-2920.71 8590.03,-2911.91"/>
<polygon fill="black" stroke="black" points="8593.21,-2910.45 8586.27,-2902.44 8586.71,-2913.03 8593.21,-2910.45"/>
</g>
<!-- layer_12_attn_reduce&#45;&gt;layer_12_residual1 -->
<g id="edge128" class="edge">
<title>layer_12_attn_reduce&#45;&gt;layer_12_residual1</title>
<path fill="none" stroke="black" d="M8637.37,-2807.2C8653.02,-2796.88 8669.47,-2786.04 8684.62,-2776.04"/>
<polygon fill="black" stroke="black" points="8686.95,-2778.7 8693.37,-2770.27 8683.1,-2772.85 8686.95,-2778.7"/>
</g>
<!-- layer_12_norm2 -->
<g id="node105" class="node">
<title>layer_12_norm2</title>
<polygon fill="lightblue" stroke="black" points="9149.06,-2666.17 8690.06,-2666.17 8690.06,-2598.17 9149.06,-2598.17 9149.06,-2666.17"/>
<text text-anchor="middle" x="8919.56" y="-2650.97" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 12)</text>
<text text-anchor="middle" x="8919.56" y="-2635.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="8919.56" y="-2620.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="8919.56" y="-2605.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_12_residual1&#45;&gt;layer_12_norm2 -->
<g id="edge129" class="edge">
<title>layer_12_residual1&#45;&gt;layer_12_norm2</title>
<path fill="none" stroke="black" d="M8800.7,-2702.05C8817.54,-2692.29 8836.11,-2681.53 8853.46,-2671.48"/>
<polygon fill="black" stroke="black" points="8855.51,-2674.33 8862.41,-2666.29 8852,-2668.28 8855.51,-2674.33"/>
</g>
<!-- layer_12_residual2 -->
<g id="node108" class="node">
<title>layer_12_residual2</title>
<polygon fill="lightblue" stroke="black" points="9038.06,-2318.5 8199.06,-2318.5 8199.06,-2250.5 9038.06,-2250.5 9038.06,-2318.5"/>
<text text-anchor="middle" x="8618.56" y="-2303.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8618.56" y="-2288.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="8618.56" y="-2273.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="8618.56" y="-2258.3" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_12_residual1&#45;&gt;layer_12_residual2 -->
<g id="edge132" class="edge">
<title>layer_12_residual1&#45;&gt;layer_12_residual2</title>
<path fill="none" stroke="black" d="M8707.6,-2701.98C8697.9,-2691.37 8688.25,-2679.03 8681.56,-2666.17 8623.69,-2554.85 8616.78,-2402.66 8617.23,-2328.99"/>
<polygon fill="black" stroke="black" points="8620.74,-2328.74 8617.35,-2318.7 8613.74,-2328.66 8620.74,-2328.74"/>
</g>
<!-- layer_12_mlp -->
<g id="node106" class="node">
<title>layer_12_mlp</title>
<polygon fill="lightblue" stroke="black" points="9197.06,-2562.17 8738.06,-2562.17 8738.06,-2494.17 9197.06,-2494.17 9197.06,-2562.17"/>
<text text-anchor="middle" x="8967.56" y="-2546.97" font-family="Times,serif" font-size="14.00">MLP&#45;TP (Layer 12)</text>
<text text-anchor="middle" x="8967.56" y="-2531.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="8967.56" y="-2516.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="8967.56" y="-2501.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_12_norm2&#45;&gt;layer_12_mlp -->
<g id="edge130" class="edge">
<title>layer_12_norm2&#45;&gt;layer_12_mlp</title>
<path fill="none" stroke="black" d="M8935.15,-2598.05C8939.13,-2589.59 8943.46,-2580.37 8947.63,-2571.52"/>
<polygon fill="black" stroke="black" points="8950.8,-2573 8951.89,-2562.47 8944.47,-2570.02 8950.8,-2573"/>
</g>
<!-- layer_12_mlp_reduce -->
<g id="node107" class="node">
<title>layer_12_mlp_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="8967.56" cy="-2410.08" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="8967.56" y="-2428.88" font-family="Times,serif" font-size="14.00">All&#45;Reduce MLP</text>
<text text-anchor="middle" x="8967.56" y="-2413.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="8967.56" y="-2398.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="8967.56" y="-2383.88" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_12_mlp&#45;&gt;layer_12_mlp_reduce -->
<g id="edge131" class="edge">
<title>layer_12_mlp&#45;&gt;layer_12_mlp_reduce</title>
<path fill="none" stroke="black" d="M8967.56,-2493.9C8967.56,-2485.91 8967.56,-2477.14 8967.56,-2468.4"/>
<polygon fill="black" stroke="black" points="8971.06,-2468.19 8967.56,-2458.19 8964.06,-2468.19 8971.06,-2468.19"/>
</g>
<!-- layer_13_norm -->
<g id="node109" class="node">
<title>layer_13_norm</title>
<polygon fill="lightblue" stroke="black" points="9769.06,-2444.08 9310.06,-2444.08 9310.06,-2376.08 9769.06,-2376.08 9769.06,-2444.08"/>
<text text-anchor="middle" x="9539.56" y="-2428.88" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 13)</text>
<text text-anchor="middle" x="9539.56" y="-2413.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="9539.56" y="-2398.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="9539.56" y="-2383.88" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_12_mlp&#45;&gt;layer_13_norm -->
<g id="edge134" class="edge">
<title>layer_12_mlp&#45;&gt;layer_13_norm</title>
<path fill="none" stroke="black" d="M9130.33,-2494.13C9204.13,-2479.16 9291.46,-2461.43 9366.46,-2446.21"/>
<polygon fill="black" stroke="black" points="9367.38,-2449.6 9376.49,-2444.18 9365.99,-2442.74 9367.38,-2449.6"/>
</g>
<!-- layer_12_mlp_reduce&#45;&gt;layer_12_residual2 -->
<g id="edge133" class="edge">
<title>layer_12_mlp_reduce&#45;&gt;layer_12_residual2</title>
<path fill="none" stroke="black" d="M8844.52,-2365.51C8804.35,-2351.29 8760.2,-2335.65 8721.66,-2322.01"/>
<polygon fill="black" stroke="black" points="8722.58,-2318.62 8711.98,-2318.58 8720.24,-2325.22 8722.58,-2318.62"/>
</g>
<!-- layer_13_attn -->
<g id="node110" class="node">
<title>layer_13_attn</title>
<polygon fill="lightblue" stroke="black" points="9508.56,-2326 9058.56,-2326 9058.56,-2243 9508.56,-2243 9508.56,-2326"/>
<text text-anchor="middle" x="9283.56" y="-2310.8" font-family="Times,serif" font-size="14.00">MHA&#45;TP (Layer 13)</text>
<text text-anchor="middle" x="9283.56" y="-2295.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="9283.56" y="-2280.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="9283.56" y="-2265.8" font-family="Times,serif" font-size="14.00">Per GPU: 4 heads, head_dim=128</text>
<text text-anchor="middle" x="9283.56" y="-2250.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_13_norm&#45;&gt;layer_13_attn -->
<g id="edge135" class="edge">
<title>layer_13_norm&#45;&gt;layer_13_attn</title>
<path fill="none" stroke="black" d="M9470.96,-2375.96C9442.11,-2362.04 9408.09,-2345.62 9377.01,-2330.61"/>
<polygon fill="black" stroke="black" points="9378.43,-2327.41 9367.9,-2326.21 9375.39,-2333.71 9378.43,-2327.41"/>
</g>
<!-- layer_13_residual1 -->
<g id="node112" class="node">
<title>layer_13_residual1</title>
<polygon fill="lightblue" stroke="black" points="9830.06,-2074.83 8991.06,-2074.83 8991.06,-2006.83 9830.06,-2006.83 9830.06,-2074.83"/>
<text text-anchor="middle" x="9410.56" y="-2059.63" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9410.56" y="-2044.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="9410.56" y="-2029.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="9410.56" y="-2014.63" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_13_norm&#45;&gt;layer_13_residual1 -->
<g id="edge137" class="edge">
<title>layer_13_norm&#45;&gt;layer_13_residual1</title>
<path fill="none" stroke="black" d="M9555.34,-2375.86C9580.72,-2317.11 9622.55,-2193.32 9568.56,-2110.83 9560.64,-2098.72 9550.07,-2088.73 9538.14,-2080.48"/>
<polygon fill="black" stroke="black" points="9539.99,-2077.51 9529.69,-2075.04 9536.21,-2083.39 9539.99,-2077.51"/>
</g>
<!-- layer_13_attn_reduce -->
<g id="node111" class="node">
<title>layer_13_attn_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="9234.56" cy="-2158.92" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="9234.56" y="-2177.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="9234.56" y="-2162.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="9234.56" y="-2147.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="9234.56" y="-2132.72" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_13_attn&#45;&gt;layer_13_attn_reduce -->
<g id="edge136" class="edge">
<title>layer_13_attn&#45;&gt;layer_13_attn_reduce</title>
<path fill="none" stroke="black" d="M9267.38,-2242.69C9264.07,-2234.33 9260.52,-2225.38 9257.03,-2216.57"/>
<polygon fill="black" stroke="black" points="9260.21,-2215.11 9253.27,-2207.11 9253.71,-2217.69 9260.21,-2215.11"/>
</g>
<!-- layer_13_attn_reduce&#45;&gt;layer_13_residual1 -->
<g id="edge138" class="edge">
<title>layer_13_attn_reduce&#45;&gt;layer_13_residual1</title>
<path fill="none" stroke="black" d="M9304.37,-2111.87C9320.02,-2101.55 9336.47,-2090.7 9351.62,-2080.71"/>
<polygon fill="black" stroke="black" points="9353.95,-2083.36 9360.37,-2074.94 9350.1,-2077.52 9353.95,-2083.36"/>
</g>
<!-- layer_13_norm2 -->
<g id="node113" class="node">
<title>layer_13_norm2</title>
<polygon fill="lightblue" stroke="black" points="9816.06,-1970.83 9357.06,-1970.83 9357.06,-1902.83 9816.06,-1902.83 9816.06,-1970.83"/>
<text text-anchor="middle" x="9586.56" y="-1955.63" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 13)</text>
<text text-anchor="middle" x="9586.56" y="-1940.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="9586.56" y="-1925.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="9586.56" y="-1910.63" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_13_residual1&#45;&gt;layer_13_norm2 -->
<g id="edge139" class="edge">
<title>layer_13_residual1&#45;&gt;layer_13_norm2</title>
<path fill="none" stroke="black" d="M9467.7,-2006.72C9484.54,-1996.96 9503.11,-1986.2 9520.46,-1976.14"/>
<polygon fill="black" stroke="black" points="9522.51,-1979 9529.41,-1970.96 9519,-1972.94 9522.51,-1979"/>
</g>
<!-- layer_13_residual2 -->
<g id="node116" class="node">
<title>layer_13_residual2</title>
<polygon fill="lightblue" stroke="black" points="9831.06,-1623.17 8992.06,-1623.17 8992.06,-1555.17 9831.06,-1555.17 9831.06,-1623.17"/>
<text text-anchor="middle" x="9411.56" y="-1607.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9411.56" y="-1592.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="9411.56" y="-1577.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="9411.56" y="-1562.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_13_residual1&#45;&gt;layer_13_residual2 -->
<g id="edge142" class="edge">
<title>layer_13_residual1&#45;&gt;layer_13_residual2</title>
<path fill="none" stroke="black" d="M9374.6,-2006.64C9364.9,-1996.04 9355.25,-1983.69 9348.56,-1970.83 9285.44,-1849.4 9236.92,-1787.83 9300.56,-1666.67 9308.27,-1652 9320.2,-1639.59 9333.44,-1629.31"/>
<polygon fill="black" stroke="black" points="9335.81,-1631.92 9341.82,-1623.19 9331.68,-1626.26 9335.81,-1631.92"/>
</g>
<!-- layer_13_mlp -->
<g id="node114" class="node">
<title>layer_13_mlp</title>
<polygon fill="lightblue" stroke="black" points="9864.06,-1866.83 9405.06,-1866.83 9405.06,-1798.83 9864.06,-1798.83 9864.06,-1866.83"/>
<text text-anchor="middle" x="9634.56" y="-1851.63" font-family="Times,serif" font-size="14.00">MLP&#45;TP (Layer 13)</text>
<text text-anchor="middle" x="9634.56" y="-1836.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="9634.56" y="-1821.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="9634.56" y="-1806.63" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_13_norm2&#45;&gt;layer_13_mlp -->
<g id="edge140" class="edge">
<title>layer_13_norm2&#45;&gt;layer_13_mlp</title>
<path fill="none" stroke="black" d="M9602.15,-1902.72C9606.13,-1894.25 9610.46,-1885.04 9614.63,-1876.18"/>
<polygon fill="black" stroke="black" points="9617.8,-1877.67 9618.89,-1867.13 9611.47,-1874.69 9617.8,-1877.67"/>
</g>
<!-- layer_13_mlp_reduce -->
<g id="node115" class="node">
<title>layer_13_mlp_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="9634.56" cy="-1714.75" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="9634.56" y="-1733.55" font-family="Times,serif" font-size="14.00">All&#45;Reduce MLP</text>
<text text-anchor="middle" x="9634.56" y="-1718.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="9634.56" y="-1703.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="9634.56" y="-1688.55" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_13_mlp&#45;&gt;layer_13_mlp_reduce -->
<g id="edge141" class="edge">
<title>layer_13_mlp&#45;&gt;layer_13_mlp_reduce</title>
<path fill="none" stroke="black" d="M9634.56,-1798.57C9634.56,-1790.57 9634.56,-1781.81 9634.56,-1773.07"/>
<polygon fill="black" stroke="black" points="9638.06,-1772.86 9634.56,-1762.86 9631.06,-1772.86 9638.06,-1772.86"/>
</g>
<!-- layer_14_norm -->
<g id="node117" class="node">
<title>layer_14_norm</title>
<polygon fill="lightblue" stroke="black" points="10436.06,-1748.75 9977.06,-1748.75 9977.06,-1680.75 10436.06,-1680.75 10436.06,-1748.75"/>
<text text-anchor="middle" x="10206.56" y="-1733.55" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 14)</text>
<text text-anchor="middle" x="10206.56" y="-1718.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10206.56" y="-1703.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10206.56" y="-1688.55" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_13_mlp&#45;&gt;layer_14_norm -->
<g id="edge144" class="edge">
<title>layer_13_mlp&#45;&gt;layer_14_norm</title>
<path fill="none" stroke="black" d="M9797.33,-1798.8C9871.13,-1783.82 9958.46,-1766.1 10033.46,-1750.88"/>
<polygon fill="black" stroke="black" points="10034.38,-1754.26 10043.49,-1748.84 10032.99,-1747.4 10034.38,-1754.26"/>
</g>
<!-- layer_13_mlp_reduce&#45;&gt;layer_13_residual2 -->
<g id="edge143" class="edge">
<title>layer_13_mlp_reduce&#45;&gt;layer_13_residual2</title>
<path fill="none" stroke="black" d="M9552.16,-1668.08C9528.5,-1654.97 9502.96,-1640.82 9480.23,-1628.22"/>
<polygon fill="black" stroke="black" points="9481.77,-1625.08 9471.33,-1623.29 9478.38,-1631.2 9481.77,-1625.08"/>
</g>
<!-- layer_14_attn -->
<g id="node118" class="node">
<title>layer_14_attn</title>
<polygon fill="lightblue" stroke="black" points="10303.56,-1630.67 9853.56,-1630.67 9853.56,-1547.67 10303.56,-1547.67 10303.56,-1630.67"/>
<text text-anchor="middle" x="10078.56" y="-1615.47" font-family="Times,serif" font-size="14.00">MHA&#45;TP (Layer 14)</text>
<text text-anchor="middle" x="10078.56" y="-1600.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="10078.56" y="-1585.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="10078.56" y="-1570.47" font-family="Times,serif" font-size="14.00">Per GPU: 4 heads, head_dim=128</text>
<text text-anchor="middle" x="10078.56" y="-1555.47" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_14_norm&#45;&gt;layer_14_attn -->
<g id="edge145" class="edge">
<title>layer_14_norm&#45;&gt;layer_14_attn</title>
<path fill="none" stroke="black" d="M10172.26,-1680.63C10158.77,-1667.6 10143.01,-1652.39 10128.31,-1638.19"/>
<polygon fill="black" stroke="black" points="10130.36,-1635.31 10120.73,-1630.88 10125.49,-1640.34 10130.36,-1635.31"/>
</g>
<!-- layer_14_residual1 -->
<g id="node120" class="node">
<title>layer_14_residual1</title>
<polygon fill="lightblue" stroke="black" points="10576.06,-1379.5 9737.06,-1379.5 9737.06,-1311.5 10576.06,-1311.5 10576.06,-1379.5"/>
<text text-anchor="middle" x="10156.56" y="-1364.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10156.56" y="-1349.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10156.56" y="-1334.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10156.56" y="-1319.3" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_14_norm&#45;&gt;layer_14_residual1 -->
<g id="edge147" class="edge">
<title>layer_14_norm&#45;&gt;layer_14_residual1</title>
<path fill="none" stroke="black" d="M10267.03,-1680.71C10284.98,-1667.65 10302.52,-1650.87 10312.56,-1630.67 10355.14,-1545.03 10366.93,-1495.52 10314.56,-1415.5 10306.64,-1403.39 10296.07,-1393.4 10284.14,-1385.15"/>
<polygon fill="black" stroke="black" points="10285.99,-1382.17 10275.69,-1379.71 10282.21,-1388.06 10285.99,-1382.17"/>
</g>
<!-- layer_14_attn_reduce -->
<g id="node119" class="node">
<title>layer_14_attn_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="9980.56" cy="-1463.58" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="9980.56" y="-1482.38" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="9980.56" y="-1467.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="9980.56" y="-1452.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="9980.56" y="-1437.38" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_14_attn&#45;&gt;layer_14_attn_reduce -->
<g id="edge146" class="edge">
<title>layer_14_attn&#45;&gt;layer_14_attn_reduce</title>
<path fill="none" stroke="black" d="M10046.2,-1547.36C10039.22,-1538.55 10031.72,-1529.09 10024.38,-1519.84"/>
<polygon fill="black" stroke="black" points="10026.94,-1517.43 10017.98,-1511.77 10021.46,-1521.78 10026.94,-1517.43"/>
</g>
<!-- layer_14_attn_reduce&#45;&gt;layer_14_residual1 -->
<g id="edge148" class="edge">
<title>layer_14_attn_reduce&#45;&gt;layer_14_residual1</title>
<path fill="none" stroke="black" d="M10050.37,-1416.54C10066.02,-1406.22 10082.47,-1395.37 10097.62,-1385.38"/>
<polygon fill="black" stroke="black" points="10099.95,-1388.03 10106.37,-1379.6 10096.1,-1382.19 10099.95,-1388.03"/>
</g>
<!-- layer_14_norm2 -->
<g id="node121" class="node">
<title>layer_14_norm2</title>
<polygon fill="lightblue" stroke="black" points="10562.06,-1275.5 10103.06,-1275.5 10103.06,-1207.5 10562.06,-1207.5 10562.06,-1275.5"/>
<text text-anchor="middle" x="10332.56" y="-1260.3" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 14)</text>
<text text-anchor="middle" x="10332.56" y="-1245.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10332.56" y="-1230.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10332.56" y="-1215.3" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_14_residual1&#45;&gt;layer_14_norm2 -->
<g id="edge149" class="edge">
<title>layer_14_residual1&#45;&gt;layer_14_norm2</title>
<path fill="none" stroke="black" d="M10213.7,-1311.38C10230.54,-1301.62 10249.11,-1290.87 10266.46,-1280.81"/>
<polygon fill="black" stroke="black" points="10268.51,-1283.67 10275.41,-1275.62 10265,-1277.61 10268.51,-1283.67"/>
</g>
<!-- layer_14_residual2 -->
<g id="node124" class="node">
<title>layer_14_residual2</title>
<polygon fill="lightblue" stroke="black" points="10577.06,-927.83 9738.06,-927.83 9738.06,-859.83 10577.06,-859.83 10577.06,-927.83"/>
<text text-anchor="middle" x="10157.56" y="-912.63" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10157.56" y="-897.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10157.56" y="-882.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10157.56" y="-867.63" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_14_residual1&#45;&gt;layer_14_residual2 -->
<g id="edge152" class="edge">
<title>layer_14_residual1&#45;&gt;layer_14_residual2</title>
<path fill="none" stroke="black" d="M10120.6,-1311.31C10110.9,-1300.71 10101.25,-1288.36 10094.56,-1275.5 10031.44,-1154.07 9982.92,-1092.49 10046.56,-971.33 10054.27,-956.66 10066.2,-944.26 10079.44,-933.98"/>
<polygon fill="black" stroke="black" points="10081.81,-936.58 10087.82,-927.86 10077.68,-930.93 10081.81,-936.58"/>
</g>
<!-- layer_14_mlp -->
<g id="node122" class="node">
<title>layer_14_mlp</title>
<polygon fill="lightblue" stroke="black" points="10610.06,-1171.5 10151.06,-1171.5 10151.06,-1103.5 10610.06,-1103.5 10610.06,-1171.5"/>
<text text-anchor="middle" x="10380.56" y="-1156.3" font-family="Times,serif" font-size="14.00">MLP&#45;TP (Layer 14)</text>
<text text-anchor="middle" x="10380.56" y="-1141.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="10380.56" y="-1126.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="10380.56" y="-1111.3" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_14_norm2&#45;&gt;layer_14_mlp -->
<g id="edge150" class="edge">
<title>layer_14_norm2&#45;&gt;layer_14_mlp</title>
<path fill="none" stroke="black" d="M10348.15,-1207.38C10352.13,-1198.92 10356.46,-1189.71 10360.63,-1180.85"/>
<polygon fill="black" stroke="black" points="10363.8,-1182.34 10364.89,-1171.8 10357.47,-1179.36 10363.8,-1182.34"/>
</g>
<!-- layer_14_mlp_reduce -->
<g id="node123" class="node">
<title>layer_14_mlp_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="10380.56" cy="-1019.42" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="10380.56" y="-1038.22" font-family="Times,serif" font-size="14.00">All&#45;Reduce MLP</text>
<text text-anchor="middle" x="10380.56" y="-1023.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="10380.56" y="-1008.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10380.56" y="-993.22" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_14_mlp&#45;&gt;layer_14_mlp_reduce -->
<g id="edge151" class="edge">
<title>layer_14_mlp&#45;&gt;layer_14_mlp_reduce</title>
<path fill="none" stroke="black" d="M10380.56,-1103.23C10380.56,-1095.24 10380.56,-1086.48 10380.56,-1077.73"/>
<polygon fill="black" stroke="black" points="10384.06,-1077.53 10380.56,-1067.53 10377.06,-1077.53 10384.06,-1077.53"/>
</g>
<!-- layer_15_norm -->
<g id="node125" class="node">
<title>layer_15_norm</title>
<polygon fill="lightblue" stroke="black" points="11182.06,-1053.42 10723.06,-1053.42 10723.06,-985.42 11182.06,-985.42 11182.06,-1053.42"/>
<text text-anchor="middle" x="10952.56" y="-1038.22" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 15)</text>
<text text-anchor="middle" x="10952.56" y="-1023.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10952.56" y="-1008.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10952.56" y="-993.22" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_14_mlp&#45;&gt;layer_15_norm -->
<g id="edge154" class="edge">
<title>layer_14_mlp&#45;&gt;layer_15_norm</title>
<path fill="none" stroke="black" d="M10543.33,-1103.47C10617.13,-1088.49 10704.46,-1070.77 10779.46,-1055.55"/>
<polygon fill="black" stroke="black" points="10780.38,-1058.93 10789.49,-1053.51 10778.99,-1052.07 10780.38,-1058.93"/>
</g>
<!-- layer_14_mlp_reduce&#45;&gt;layer_14_residual2 -->
<g id="edge153" class="edge">
<title>layer_14_mlp_reduce&#45;&gt;layer_14_residual2</title>
<path fill="none" stroke="black" d="M10298.16,-972.75C10274.5,-959.64 10248.96,-945.49 10226.23,-932.89"/>
<polygon fill="black" stroke="black" points="10227.77,-929.74 10217.33,-927.96 10224.38,-935.86 10227.77,-929.74"/>
</g>
<!-- layer_15_attn -->
<g id="node126" class="node">
<title>layer_15_attn</title>
<polygon fill="lightblue" stroke="black" points="11049.56,-935.33 10599.56,-935.33 10599.56,-852.33 11049.56,-852.33 11049.56,-935.33"/>
<text text-anchor="middle" x="10824.56" y="-920.13" font-family="Times,serif" font-size="14.00">MHA&#45;TP (Layer 15)</text>
<text text-anchor="middle" x="10824.56" y="-905.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="10824.56" y="-890.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="10824.56" y="-875.13" font-family="Times,serif" font-size="14.00">Per GPU: 4 heads, head_dim=128</text>
<text text-anchor="middle" x="10824.56" y="-860.13" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_15_norm&#45;&gt;layer_15_attn -->
<g id="edge155" class="edge">
<title>layer_15_norm&#45;&gt;layer_15_attn</title>
<path fill="none" stroke="black" d="M10918.26,-985.3C10904.77,-972.27 10889.01,-957.05 10874.31,-942.86"/>
<polygon fill="black" stroke="black" points="10876.36,-939.98 10866.73,-935.55 10871.49,-945.01 10876.36,-939.98"/>
</g>
<!-- layer_15_residual1 -->
<g id="node128" class="node">
<title>layer_15_residual1</title>
<polygon fill="lightblue" stroke="black" points="11322.06,-684.17 10483.06,-684.17 10483.06,-616.17 11322.06,-616.17 11322.06,-684.17"/>
<text text-anchor="middle" x="10902.56" y="-668.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10902.56" y="-653.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10902.56" y="-638.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10902.56" y="-623.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_15_norm&#45;&gt;layer_15_residual1 -->
<g id="edge157" class="edge">
<title>layer_15_norm&#45;&gt;layer_15_residual1</title>
<path fill="none" stroke="black" d="M11013.03,-985.38C11030.98,-972.31 11048.52,-955.54 11058.56,-935.33 11101.14,-849.7 11112.93,-800.19 11060.56,-720.17 11052.64,-708.06 11042.07,-698.06 11030.14,-689.81"/>
<polygon fill="black" stroke="black" points="11031.99,-686.84 11021.69,-684.38 11028.21,-692.73 11031.99,-686.84"/>
</g>
<!-- layer_15_attn_reduce -->
<g id="node127" class="node">
<title>layer_15_attn_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="10726.56" cy="-768.25" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="10726.56" y="-787.05" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="10726.56" y="-772.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=512]</text>
<text text-anchor="middle" x="10726.56" y="-757.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10726.56" y="-742.05" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_15_attn&#45;&gt;layer_15_attn_reduce -->
<g id="edge156" class="edge">
<title>layer_15_attn&#45;&gt;layer_15_attn_reduce</title>
<path fill="none" stroke="black" d="M10792.2,-852.02C10785.22,-843.22 10777.72,-833.76 10770.38,-824.5"/>
<polygon fill="black" stroke="black" points="10772.94,-822.1 10763.98,-816.44 10767.46,-826.45 10772.94,-822.1"/>
</g>
<!-- layer_15_attn_reduce&#45;&gt;layer_15_residual1 -->
<g id="edge158" class="edge">
<title>layer_15_attn_reduce&#45;&gt;layer_15_residual1</title>
<path fill="none" stroke="black" d="M10796.37,-721.2C10812.02,-710.89 10828.47,-700.04 10843.62,-690.04"/>
<polygon fill="black" stroke="black" points="10845.95,-692.7 10852.37,-684.27 10842.1,-686.85 10845.95,-692.7"/>
</g>
<!-- layer_15_norm2 -->
<g id="node129" class="node">
<title>layer_15_norm2</title>
<polygon fill="lightblue" stroke="black" points="11003.06,-580.17 10544.06,-580.17 10544.06,-512.17 11003.06,-512.17 11003.06,-580.17"/>
<text text-anchor="middle" x="10773.56" y="-564.97" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 15)</text>
<text text-anchor="middle" x="10773.56" y="-549.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10773.56" y="-534.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10773.56" y="-519.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_15_residual1&#45;&gt;layer_15_norm2 -->
<g id="edge159" class="edge">
<title>layer_15_residual1&#45;&gt;layer_15_norm2</title>
<path fill="none" stroke="black" d="M10860.68,-616.05C10848.85,-606.7 10835.86,-596.43 10823.6,-586.73"/>
<polygon fill="black" stroke="black" points="10825.69,-583.92 10815.68,-580.47 10821.35,-589.41 10825.69,-583.92"/>
</g>
<!-- layer_15_residual2 -->
<g id="node132" class="node">
<title>layer_15_residual2</title>
<polygon fill="lightblue" stroke="black" points="11297.06,-240 10458.06,-240 10458.06,-172 11297.06,-172 11297.06,-240"/>
<text text-anchor="middle" x="10877.56" y="-224.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10877.56" y="-209.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096], [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10877.56" y="-194.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10877.56" y="-179.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (all)</text>
</g>
<!-- layer_15_residual1&#45;&gt;layer_15_residual2 -->
<g id="edge162" class="edge">
<title>layer_15_residual1&#45;&gt;layer_15_residual2</title>
<path fill="none" stroke="black" d="M10976.01,-616.13C10990.24,-606.5 11003.52,-594.58 11012.56,-580.17 11084.62,-465.33 11109.8,-389.44 11035.56,-276 11027.64,-263.89 11017.07,-253.9 11005.14,-245.65"/>
<polygon fill="black" stroke="black" points="11006.99,-242.67 10996.69,-240.21 11003.21,-248.56 11006.99,-242.67"/>
</g>
<!-- layer_15_mlp -->
<g id="node130" class="node">
<title>layer_15_mlp</title>
<polygon fill="lightblue" stroke="black" points="10979.06,-476.17 10520.06,-476.17 10520.06,-408.17 10979.06,-408.17 10979.06,-476.17"/>
<text text-anchor="middle" x="10749.56" y="-460.97" font-family="Times,serif" font-size="14.00">MLP&#45;TP (Layer 15)</text>
<text text-anchor="middle" x="10749.56" y="-445.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="10749.56" y="-430.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="10749.56" y="-415.97" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_15_norm2&#45;&gt;layer_15_mlp -->
<g id="edge160" class="edge">
<title>layer_15_norm2&#45;&gt;layer_15_mlp</title>
<path fill="none" stroke="black" d="M10765.77,-512.05C10763.84,-503.86 10761.75,-494.96 10759.72,-486.36"/>
<polygon fill="black" stroke="black" points="10763.09,-485.4 10757.4,-476.47 10756.28,-487 10763.09,-485.4"/>
</g>
<!-- layer_15_mlp_reduce -->
<g id="node131" class="node">
<title>layer_15_mlp_reduce</title>
<ellipse fill="lightyellow" stroke="black" cx="10701.56" cy="-324.08" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="10701.56" y="-342.88" font-family="Times,serif" font-size="14.00">All&#45;Reduce MLP</text>
<text text-anchor="middle" x="10701.56" y="-327.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=2048]</text>
<text text-anchor="middle" x="10701.56" y="-312.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10701.56" y="-297.88" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15 (TP)</text>
</g>
<!-- layer_15_mlp&#45;&gt;layer_15_mlp_reduce -->
<g id="edge161" class="edge">
<title>layer_15_mlp&#45;&gt;layer_15_mlp_reduce</title>
<path fill="none" stroke="black" d="M10735.81,-407.9C10732.39,-399.65 10728.64,-390.57 10724.91,-381.54"/>
<polygon fill="black" stroke="black" points="10728.1,-380.1 10721.04,-372.19 10721.63,-382.77 10728.1,-380.1"/>
</g>
<!-- layer_15_mlp_reduce&#45;&gt;layer_15_residual2 -->
<g id="edge163" class="edge">
<title>layer_15_mlp_reduce&#45;&gt;layer_15_residual2</title>
<path fill="none" stroke="black" d="M10771.37,-277.04C10787.02,-266.72 10803.47,-255.87 10818.62,-245.88"/>
<polygon fill="black" stroke="black" points="10820.95,-248.53 10827.37,-240.1 10817.1,-242.69 10820.95,-248.53"/>
</g>
<!-- output -->
<g id="node133" class="node">
<title>output</title>
<polygon fill="lightgreen" stroke="black" points="11353.3,-136 10596.51,-136 10401.82,0 11158.62,0 11353.3,-136"/>
<text text-anchor="middle" x="10877.56" y="-86.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="10877.56" y="-71.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10877.56" y="-56.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10877.56" y="-41.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer_15_residual2&#45;&gt;output -->
<g id="edge164" class="edge">
<title>layer_15_residual2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M10877.56,-171.73C10877.56,-163.9 10877.56,-155.24 10877.56,-146.35"/>
<polygon fill="black" stroke="black" points="10881.06,-146.26 10877.56,-136.26 10874.06,-146.26 10881.06,-146.26"/>
</g>
</g>
</svg>
