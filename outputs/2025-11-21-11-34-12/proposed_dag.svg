<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proposed_transformer_dag Pages: 1 -->
<svg width="2160pt" height="348pt"
 viewBox="0.00 0.00 2160.00 348.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.08 0.08) rotate(0) translate(4 4460.67)">
<title>proposed_transformer_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-4460.67 27691.48,-4460.67 27691.48,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgreen" stroke="black" points="11859.24,-4456.67 11102.44,-4456.67 10907.76,-4320.67 11664.56,-4320.67 11859.24,-4456.67"/>
<text text-anchor="middle" x="11383.5" y="-4407.47" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="11383.5" y="-4392.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="11383.5" y="-4377.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="11383.5" y="-4362.47" font-family="Times,serif" font-size="14.00">GPU: Host</text>
</g>
<!-- input_broadcast -->
<g id="node2" class="node">
<title>input_broadcast</title>
<ellipse fill="lightyellow" stroke="black" cx="11383.5" cy="-4236.58" rx="324.62" ry="48.17"/>
<text text-anchor="middle" x="11383.5" y="-4255.38" font-family="Times,serif" font-size="14.00">Input Broadcast</text>
<text text-anchor="middle" x="11383.5" y="-4240.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="11383.5" y="-4225.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="11383.5" y="-4210.38" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15 (all)</text>
</g>
<!-- input&#45;&gt;input_broadcast -->
<g id="edge1" class="edge">
<title>input&#45;&gt;input_broadcast</title>
<path fill="none" stroke="black" d="M11383.5,-4320.53C11383.5,-4311.98 11383.5,-4303.3 11383.5,-4294.93"/>
<polygon fill="black" stroke="black" points="11387,-4294.9 11383.5,-4284.9 11380,-4294.9 11387,-4294.9"/>
</g>
<!-- layer_0_norm1 -->
<g id="node3" class="node">
<title>layer_0_norm1</title>
<polygon fill="lightblue" stroke="black" points="11613,-4152.5 11154,-4152.5 11154,-4084.5 11613,-4084.5 11613,-4152.5"/>
<text text-anchor="middle" x="11383.5" y="-4137.3" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 0)</text>
<text text-anchor="middle" x="11383.5" y="-4122.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="11383.5" y="-4107.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="11383.5" y="-4092.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15 (all)</text>
</g>
<!-- input_broadcast&#45;&gt;layer_0_norm1 -->
<g id="edge2" class="edge">
<title>input_broadcast&#45;&gt;layer_0_norm1</title>
<path fill="none" stroke="black" d="M11383.5,-4188.37C11383.5,-4179.98 11383.5,-4171.28 11383.5,-4163.01"/>
<polygon fill="black" stroke="black" points="11387,-4162.8 11383.5,-4152.8 11380,-4162.8 11387,-4162.8"/>
</g>
<!-- layer_0_q_proj_0_0 -->
<g id="node4" class="node">
<title>layer_0_q_proj_0_0</title>
<polygon fill="lightblue" stroke="black" points="447,-4048.5 0,-4048.5 0,-3980.5 447,-3980.5 447,-4048.5"/>
<text text-anchor="middle" x="223.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Query Projection</text>
<text text-anchor="middle" x="223.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="223.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="223.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_q_proj_0_0 -->
<g id="edge3" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_q_proj_0_0</title>
<path fill="none" stroke="black" d="M11153.94,-4116.93C9637.76,-4113.03 1104.83,-4089.4 457.48,-4048.48"/>
<polygon fill="black" stroke="black" points="457.49,-4044.97 447.27,-4047.78 457.01,-4051.95 457.49,-4044.97"/>
</g>
<!-- layer_0_k_proj_0_0 -->
<g id="node5" class="node">
<title>layer_0_k_proj_0_0</title>
<polygon fill="lightblue" stroke="black" points="912,-4048.5 465,-4048.5 465,-3980.5 912,-3980.5 912,-4048.5"/>
<text text-anchor="middle" x="688.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Key Projection</text>
<text text-anchor="middle" x="688.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="688.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="688.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_k_proj_0_0 -->
<g id="edge4" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_k_proj_0_0</title>
<path fill="none" stroke="black" d="M11153.93,-4116.86C9676.11,-4112.63 1544.67,-4087.68 922.49,-4048.47"/>
<polygon fill="black" stroke="black" points="922.49,-4044.97 912.27,-4047.78 922.01,-4051.95 922.49,-4044.97"/>
</g>
<!-- layer_0_v_proj_0_0 -->
<g id="node6" class="node">
<title>layer_0_v_proj_0_0</title>
<polygon fill="lightblue" stroke="black" points="1377,-4048.5 930,-4048.5 930,-3980.5 1377,-3980.5 1377,-4048.5"/>
<text text-anchor="middle" x="1153.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Value Projection</text>
<text text-anchor="middle" x="1153.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1153.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="1153.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_v_proj_0_0 -->
<g id="edge5" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_v_proj_0_0</title>
<path fill="none" stroke="black" d="M11153.86,-4117.76C9757.93,-4119.1 2436.75,-4122.54 1387.48,-4048.51"/>
<polygon fill="black" stroke="black" points="1387.5,-4045.01 1377.27,-4047.78 1387,-4051.99 1387.5,-4045.01"/>
</g>
<!-- layer_0_q_proj_0_1 -->
<g id="node12" class="node">
<title>layer_0_q_proj_0_1</title>
<polygon fill="lightblue" stroke="black" points="1842,-4048.5 1395,-4048.5 1395,-3980.5 1842,-3980.5 1842,-4048.5"/>
<text text-anchor="middle" x="1618.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Query Projection</text>
<text text-anchor="middle" x="1618.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="1618.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="1618.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_q_proj_0_1 -->
<g id="edge13" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_q_proj_0_1</title>
<path fill="none" stroke="black" d="M11153.88,-4117.68C9796.87,-4118.47 2851.85,-4119.09 1852.35,-4048.5"/>
<polygon fill="black" stroke="black" points="1852.5,-4045.01 1842.27,-4047.78 1852,-4051.99 1852.5,-4045.01"/>
</g>
<!-- layer_0_k_proj_0_1 -->
<g id="node13" class="node">
<title>layer_0_k_proj_0_1</title>
<polygon fill="lightblue" stroke="black" points="2307,-4048.5 1860,-4048.5 1860,-3980.5 2307,-3980.5 2307,-4048.5"/>
<text text-anchor="middle" x="2083.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Key Projection</text>
<text text-anchor="middle" x="2083.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2083.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="2083.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_k_proj_0_1 -->
<g id="edge14" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_k_proj_0_1</title>
<path fill="none" stroke="black" d="M11153.91,-4117.58C9836.94,-4117.82 3268.44,-4115.64 2317.53,-4048.52"/>
<polygon fill="black" stroke="black" points="2317.5,-4045.01 2307.27,-4047.77 2316.99,-4051.99 2317.5,-4045.01"/>
</g>
<!-- layer_0_v_proj_0_1 -->
<g id="node14" class="node">
<title>layer_0_v_proj_0_1</title>
<polygon fill="lightblue" stroke="black" points="2772,-4048.5 2325,-4048.5 2325,-3980.5 2772,-3980.5 2772,-4048.5"/>
<text text-anchor="middle" x="2548.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Value Projection</text>
<text text-anchor="middle" x="2548.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="2548.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="2548.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_v_proj_0_1 -->
<g id="edge15" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_v_proj_0_1</title>
<path fill="none" stroke="black" d="M11153.79,-4117.48C9877.4,-4117.13 3683.19,-4112.2 2782.31,-4048.5"/>
<polygon fill="black" stroke="black" points="2782.5,-4045.01 2772.27,-4047.77 2781.99,-4051.99 2782.5,-4045.01"/>
</g>
<!-- layer_0_q_proj_0_2 -->
<g id="node20" class="node">
<title>layer_0_q_proj_0_2</title>
<polygon fill="lightblue" stroke="black" points="3237,-4048.5 2790,-4048.5 2790,-3980.5 3237,-3980.5 3237,-4048.5"/>
<text text-anchor="middle" x="3013.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Query Projection</text>
<text text-anchor="middle" x="3013.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3013.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="3013.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_q_proj_0_2 -->
<g id="edge23" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_q_proj_0_2</title>
<path fill="none" stroke="black" d="M11153.92,-4117.37C9919.91,-4116.41 4099.31,-4108.76 3247.37,-4048.5"/>
<polygon fill="black" stroke="black" points="3247.5,-4045.01 3237.27,-4047.77 3246.99,-4051.99 3247.5,-4045.01"/>
</g>
<!-- layer_0_k_proj_0_2 -->
<g id="node21" class="node">
<title>layer_0_k_proj_0_2</title>
<polygon fill="lightblue" stroke="black" points="3702,-4048.5 3255,-4048.5 3255,-3980.5 3702,-3980.5 3702,-4048.5"/>
<text text-anchor="middle" x="3478.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Key Projection</text>
<text text-anchor="middle" x="3478.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3478.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="3478.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_k_proj_0_2 -->
<g id="edge24" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_k_proj_0_2</title>
<path fill="none" stroke="black" d="M11153.94,-4117.24C9963.24,-4115.65 4515.13,-4105.34 3712.35,-4048.5"/>
<polygon fill="black" stroke="black" points="3712.5,-4045 3702.27,-4047.77 3711.99,-4051.99 3712.5,-4045"/>
</g>
<!-- layer_0_v_proj_0_2 -->
<g id="node22" class="node">
<title>layer_0_v_proj_0_2</title>
<polygon fill="lightblue" stroke="black" points="4167,-4048.5 3720,-4048.5 3720,-3980.5 4167,-3980.5 4167,-4048.5"/>
<text text-anchor="middle" x="3943.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Value Projection</text>
<text text-anchor="middle" x="3943.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="3943.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="3943.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_v_proj_0_2 -->
<g id="edge25" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_v_proj_0_2</title>
<path fill="none" stroke="black" d="M11153.78,-4117.09C10007.37,-4114.84 4930.64,-4101.91 4177.26,-4048.5"/>
<polygon fill="black" stroke="black" points="4177.5,-4045 4167.27,-4047.77 4176.99,-4051.99 4177.5,-4045"/>
</g>
<!-- layer_0_q_proj_0_3 -->
<g id="node28" class="node">
<title>layer_0_q_proj_0_3</title>
<polygon fill="lightblue" stroke="black" points="4632,-4048.5 4185,-4048.5 4185,-3980.5 4632,-3980.5 4632,-4048.5"/>
<text text-anchor="middle" x="4408.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Query Projection</text>
<text text-anchor="middle" x="4408.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4408.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="4408.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_q_proj_0_3 -->
<g id="edge33" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_q_proj_0_3</title>
<path fill="none" stroke="black" d="M11153.69,-4116.93C10053.27,-4113.97 5347.07,-4098.5 4642.36,-4048.5"/>
<polygon fill="black" stroke="black" points="4642.5,-4045 4632.27,-4047.76 4641.99,-4051.98 4642.5,-4045"/>
</g>
<!-- layer_0_k_proj_0_3 -->
<g id="node29" class="node">
<title>layer_0_k_proj_0_3</title>
<polygon fill="lightblue" stroke="black" points="5097,-4048.5 4650,-4048.5 4650,-3980.5 5097,-3980.5 5097,-4048.5"/>
<text text-anchor="middle" x="4873.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Key Projection</text>
<text text-anchor="middle" x="4873.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4873.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="4873.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_k_proj_0_3 -->
<g id="edge34" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_k_proj_0_3</title>
<path fill="none" stroke="black" d="M11153.91,-4116.74C10101.75,-4113.04 5764.2,-4095.1 5107.59,-4048.52"/>
<polygon fill="black" stroke="black" points="5107.5,-4045 5097.27,-4047.76 5106.99,-4051.98 5107.5,-4045"/>
</g>
<!-- layer_0_v_proj_0_3 -->
<g id="node30" class="node">
<title>layer_0_v_proj_0_3</title>
<polygon fill="lightblue" stroke="black" points="5562,-4048.5 5115,-4048.5 5115,-3980.5 5562,-3980.5 5562,-4048.5"/>
<text text-anchor="middle" x="5338.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Value Projection</text>
<text text-anchor="middle" x="5338.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5338.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="5338.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_v_proj_0_3 -->
<g id="edge35" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_v_proj_0_3</title>
<path fill="none" stroke="black" d="M11153.87,-4116.53C10151.25,-4112.03 6180.68,-4091.72 5572.67,-4048.52"/>
<polygon fill="black" stroke="black" points="5572.51,-4045 5562.28,-4047.76 5571.99,-4051.98 5572.51,-4045"/>
</g>
<!-- layer_0_q_proj_1_0 -->
<g id="node36" class="node">
<title>layer_0_q_proj_1_0</title>
<polygon fill="lightblue" stroke="black" points="6027,-4048.5 5580,-4048.5 5580,-3980.5 6027,-3980.5 6027,-4048.5"/>
<text text-anchor="middle" x="5803.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Query Projection</text>
<text text-anchor="middle" x="5803.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5803.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="5803.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_q_proj_1_0 -->
<g id="edge43" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_q_proj_1_0</title>
<path fill="none" stroke="black" d="M11153.6,-4116.27C10202.11,-4110.94 6596.55,-4088.33 6037.61,-4048.52"/>
<polygon fill="black" stroke="black" points="6037.51,-4045 6027.28,-4047.75 6036.99,-4051.98 6037.51,-4045"/>
</g>
<!-- layer_0_k_proj_1_0 -->
<g id="node37" class="node">
<title>layer_0_k_proj_1_0</title>
<polygon fill="lightblue" stroke="black" points="6492,-4048.5 6045,-4048.5 6045,-3980.5 6492,-3980.5 6492,-4048.5"/>
<text text-anchor="middle" x="6268.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Key Projection</text>
<text text-anchor="middle" x="6268.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6268.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="6268.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_k_proj_1_0 -->
<g id="edge44" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_k_proj_1_0</title>
<path fill="none" stroke="black" d="M11153.62,-4115.96C10255.98,-4109.73 7011.94,-4084.96 6502.41,-4048.5"/>
<polygon fill="black" stroke="black" points="6502.51,-4045 6492.28,-4047.75 6501.99,-4051.98 6502.51,-4045"/>
</g>
<!-- layer_0_v_proj_1_0 -->
<g id="node38" class="node">
<title>layer_0_v_proj_1_0</title>
<polygon fill="lightblue" stroke="black" points="6957,-4048.5 6510,-4048.5 6510,-3980.5 6957,-3980.5 6957,-4048.5"/>
<text text-anchor="middle" x="6733.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Value Projection</text>
<text text-anchor="middle" x="6733.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6733.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="6733.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_v_proj_1_0 -->
<g id="edge45" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_v_proj_1_0</title>
<path fill="none" stroke="black" d="M11153.83,-4117.71C10371.49,-4117.83 7812.87,-4113.2 6967.45,-4048.53"/>
<polygon fill="black" stroke="black" points="6967.52,-4045.02 6957.28,-4047.74 6966.98,-4052 6967.52,-4045.02"/>
</g>
<!-- layer_0_q_proj_1_1 -->
<g id="node44" class="node">
<title>layer_0_q_proj_1_1</title>
<polygon fill="lightblue" stroke="black" points="7422,-4048.5 6975,-4048.5 6975,-3980.5 7422,-3980.5 7422,-4048.5"/>
<text text-anchor="middle" x="7198.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Query Projection</text>
<text text-anchor="middle" x="7198.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7198.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="7198.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_q_proj_1_1 -->
<g id="edge53" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_q_proj_1_1</title>
<path fill="none" stroke="black" d="M11153.92,-4117.21C10427.32,-4115.72 8182.36,-4106.47 7432.39,-4048.52"/>
<polygon fill="black" stroke="black" points="7432.52,-4045.02 7422.28,-4047.73 7431.97,-4052 7432.52,-4045.02"/>
</g>
<!-- layer_0_k_proj_1_1 -->
<g id="node45" class="node">
<title>layer_0_k_proj_1_1</title>
<polygon fill="lightblue" stroke="black" points="7887,-4048.5 7440,-4048.5 7440,-3980.5 7887,-3980.5 7887,-4048.5"/>
<text text-anchor="middle" x="7663.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Key Projection</text>
<text text-anchor="middle" x="7663.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7663.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="7663.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_k_proj_1_1 -->
<g id="edge54" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_k_proj_1_1</title>
<path fill="none" stroke="black" d="M11153.89,-4116.58C10486.27,-4113.35 8552.18,-4099.76 7897.3,-4048.52"/>
<polygon fill="black" stroke="black" points="7897.52,-4045.02 7887.28,-4047.72 7896.97,-4052 7897.52,-4045.02"/>
</g>
<!-- layer_0_v_proj_1_1 -->
<g id="node46" class="node">
<title>layer_0_v_proj_1_1</title>
<polygon fill="lightblue" stroke="black" points="8352,-4048.5 7905,-4048.5 7905,-3980.5 8352,-3980.5 8352,-4048.5"/>
<text text-anchor="middle" x="8128.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Value Projection</text>
<text text-anchor="middle" x="8128.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="8128.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="8128.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_v_proj_1_1 -->
<g id="edge55" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_v_proj_1_1</title>
<path fill="none" stroke="black" d="M11153.79,-4115.76C10549.29,-4110.64 8923.02,-4093.09 8362.48,-4048.53"/>
<polygon fill="black" stroke="black" points="8362.53,-4045.02 8352.28,-4047.71 8361.96,-4052 8362.53,-4045.02"/>
</g>
<!-- layer_0_q_proj_1_2 -->
<g id="node52" class="node">
<title>layer_0_q_proj_1_2</title>
<polygon fill="lightblue" stroke="black" points="8817,-4048.5 8370,-4048.5 8370,-3980.5 8817,-3980.5 8817,-4048.5"/>
<text text-anchor="middle" x="8593.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Query Projection</text>
<text text-anchor="middle" x="8593.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="8593.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="8593.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_q_proj_1_2 -->
<g id="edge63" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_q_proj_1_2</title>
<path fill="none" stroke="black" d="M11153.86,-4114.65C10617.66,-4107.46 9294.13,-4086.46 8827.47,-4048.53"/>
<polygon fill="black" stroke="black" points="8827.53,-4045.03 8817.28,-4047.69 8826.96,-4052 8827.53,-4045.03"/>
</g>
<!-- layer_0_k_proj_1_2 -->
<g id="node53" class="node">
<title>layer_0_k_proj_1_2</title>
<polygon fill="lightblue" stroke="black" points="9282,-4048.5 8835,-4048.5 8835,-3980.5 9282,-3980.5 9282,-4048.5"/>
<text text-anchor="middle" x="9058.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Key Projection</text>
<text text-anchor="middle" x="9058.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="9058.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="9058.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_k_proj_1_2 -->
<g id="edge64" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_k_proj_1_2</title>
<path fill="none" stroke="black" d="M11153.94,-4118C10770.28,-4117.04 9974.49,-4107.37 9292.32,-4048.53"/>
<polygon fill="black" stroke="black" points="9292.55,-4045.04 9282.28,-4047.67 9291.94,-4052.02 9292.55,-4045.04"/>
</g>
<!-- layer_0_v_proj_1_2 -->
<g id="node54" class="node">
<title>layer_0_v_proj_1_2</title>
<polygon fill="lightblue" stroke="black" points="9747,-4048.5 9300,-4048.5 9300,-3980.5 9747,-3980.5 9747,-4048.5"/>
<text text-anchor="middle" x="9523.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Value Projection</text>
<text text-anchor="middle" x="9523.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="9523.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="9523.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_v_proj_1_2 -->
<g id="edge65" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_v_proj_1_2</title>
<path fill="none" stroke="black" d="M11154,-4114.87C10840.59,-4109.66 10261.11,-4094.32 9757.31,-4048.54"/>
<polygon fill="black" stroke="black" points="9757.56,-4045.05 9747.29,-4047.62 9756.93,-4052.02 9757.56,-4045.05"/>
</g>
<!-- layer_0_q_proj_1_3 -->
<g id="node60" class="node">
<title>layer_0_q_proj_1_3</title>
<polygon fill="lightblue" stroke="black" points="10212,-4048.5 9765,-4048.5 9765,-3980.5 10212,-3980.5 10212,-4048.5"/>
<text text-anchor="middle" x="9988.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Query Projection</text>
<text text-anchor="middle" x="9988.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="9988.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="9988.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_q_proj_1_3 -->
<g id="edge73" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_q_proj_1_3</title>
<path fill="none" stroke="black" d="M11153.76,-4109.38C10921.45,-4099.88 10551.91,-4081.27 10222.52,-4048.57"/>
<polygon fill="black" stroke="black" points="10222.59,-4045.06 10212.29,-4047.55 10221.9,-4052.03 10222.59,-4045.06"/>
</g>
<!-- layer_0_k_proj_1_3 -->
<g id="node61" class="node">
<title>layer_0_k_proj_1_3</title>
<polygon fill="lightblue" stroke="black" points="10677,-4048.5 10230,-4048.5 10230,-3980.5 10677,-3980.5 10677,-4048.5"/>
<text text-anchor="middle" x="10453.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Key Projection</text>
<text text-anchor="middle" x="10453.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10453.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="10453.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_k_proj_1_3 -->
<g id="edge74" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_k_proj_1_3</title>
<path fill="none" stroke="black" d="M11153.68,-4097.2C11020.46,-4084.83 10849.27,-4067.92 10687.17,-4048.56"/>
<polygon fill="black" stroke="black" points="10687.35,-4045.06 10677,-4047.34 10686.52,-4052.01 10687.35,-4045.06"/>
</g>
<!-- layer_0_v_proj_1_3 -->
<g id="node62" class="node">
<title>layer_0_v_proj_1_3</title>
<polygon fill="lightblue" stroke="black" points="11142,-4048.5 10695,-4048.5 10695,-3980.5 11142,-3980.5 11142,-4048.5"/>
<text text-anchor="middle" x="10918.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Value Projection</text>
<text text-anchor="middle" x="10918.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="10918.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="10918.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_v_proj_1_3 -->
<g id="edge75" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_v_proj_1_3</title>
<path fill="none" stroke="black" d="M11232.85,-4084.45C11183.73,-4073.68 11129.03,-4061.68 11079.21,-4050.75"/>
<polygon fill="black" stroke="black" points="11079.83,-4047.3 11069.31,-4048.58 11078.33,-4054.14 11079.83,-4047.3"/>
</g>
<!-- layer_0_q_proj_2_0 -->
<g id="node68" class="node">
<title>layer_0_q_proj_2_0</title>
<polygon fill="lightblue" stroke="black" points="11607,-4048.5 11160,-4048.5 11160,-3980.5 11607,-3980.5 11607,-4048.5"/>
<text text-anchor="middle" x="11383.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Query Projection</text>
<text text-anchor="middle" x="11383.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="11383.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="11383.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_q_proj_2_0 -->
<g id="edge83" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_q_proj_2_0</title>
<path fill="none" stroke="black" d="M11383.5,-4084.38C11383.5,-4076.28 11383.5,-4067.48 11383.5,-4058.97"/>
<polygon fill="black" stroke="black" points="11387,-4058.8 11383.5,-4048.8 11380,-4058.8 11387,-4058.8"/>
</g>
<!-- layer_0_k_proj_2_0 -->
<g id="node69" class="node">
<title>layer_0_k_proj_2_0</title>
<polygon fill="lightblue" stroke="black" points="12072,-4048.5 11625,-4048.5 11625,-3980.5 12072,-3980.5 12072,-4048.5"/>
<text text-anchor="middle" x="11848.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Key Projection</text>
<text text-anchor="middle" x="11848.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="11848.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="11848.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_k_proj_2_0 -->
<g id="edge84" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_k_proj_2_0</title>
<path fill="none" stroke="black" d="M11534.15,-4084.45C11583.27,-4073.68 11637.97,-4061.68 11687.79,-4050.75"/>
<polygon fill="black" stroke="black" points="11688.67,-4054.14 11697.69,-4048.58 11687.17,-4047.3 11688.67,-4054.14"/>
</g>
<!-- layer_0_v_proj_2_0 -->
<g id="node70" class="node">
<title>layer_0_v_proj_2_0</title>
<polygon fill="lightblue" stroke="black" points="12537,-4048.5 12090,-4048.5 12090,-3980.5 12537,-3980.5 12537,-4048.5"/>
<text text-anchor="middle" x="12313.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Value Projection</text>
<text text-anchor="middle" x="12313.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="12313.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="12313.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_v_proj_2_0 -->
<g id="edge85" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_v_proj_2_0</title>
<path fill="none" stroke="black" d="M11613.26,-4097.28C11746.73,-4084.92 11918.34,-4068 12079.61,-4048.71"/>
<polygon fill="black" stroke="black" points="12080.22,-4052.17 12089.73,-4047.5 12079.38,-4045.21 12080.22,-4052.17"/>
</g>
<!-- layer_0_q_proj_2_1 -->
<g id="node76" class="node">
<title>layer_0_q_proj_2_1</title>
<polygon fill="lightblue" stroke="black" points="13002,-4048.5 12555,-4048.5 12555,-3980.5 13002,-3980.5 13002,-4048.5"/>
<text text-anchor="middle" x="12778.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Query Projection</text>
<text text-anchor="middle" x="12778.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="12778.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="12778.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_q_proj_2_1 -->
<g id="edge93" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_q_proj_2_1</title>
<path fill="none" stroke="black" d="M11613.16,-4109.44C11845.67,-4099.98 12215.69,-4081.4 12544.54,-4048.67"/>
<polygon fill="black" stroke="black" points="12545.14,-4052.13 12554.75,-4047.65 12544.45,-4045.16 12545.14,-4052.13"/>
</g>
<!-- layer_0_k_proj_2_1 -->
<g id="node77" class="node">
<title>layer_0_k_proj_2_1</title>
<polygon fill="lightblue" stroke="black" points="13467,-4048.5 13020,-4048.5 13020,-3980.5 13467,-3980.5 13467,-4048.5"/>
<text text-anchor="middle" x="13243.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Key Projection</text>
<text text-anchor="middle" x="13243.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="13243.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="13243.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_k_proj_2_1 -->
<g id="edge94" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_k_proj_2_1</title>
<path fill="none" stroke="black" d="M11613.15,-4114.92C11926.75,-4109.77 12506.59,-4094.49 13009.75,-4048.63"/>
<polygon fill="black" stroke="black" points="13010.11,-4052.11 13019.75,-4047.72 13009.47,-4045.14 13010.11,-4052.11"/>
</g>
<!-- layer_0_v_proj_2_1 -->
<g id="node78" class="node">
<title>layer_0_v_proj_2_1</title>
<polygon fill="lightblue" stroke="black" points="13932,-4048.5 13485,-4048.5 13485,-3980.5 13932,-3980.5 13932,-4048.5"/>
<text text-anchor="middle" x="13708.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Value Projection</text>
<text text-anchor="middle" x="13708.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="13708.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="13708.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_v_proj_2_1 -->
<g id="edge95" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_v_proj_2_1</title>
<path fill="none" stroke="black" d="M11613.17,-4118.05C11997.02,-4117.16 12793.2,-4107.59 13474.73,-4048.62"/>
<polygon fill="black" stroke="black" points="13475.1,-4052.11 13484.76,-4047.75 13474.49,-4045.13 13475.1,-4052.11"/>
</g>
<!-- layer_0_q_proj_2_2 -->
<g id="node84" class="node">
<title>layer_0_q_proj_2_2</title>
<polygon fill="lightblue" stroke="black" points="14397,-4048.5 13950,-4048.5 13950,-3980.5 14397,-3980.5 14397,-4048.5"/>
<text text-anchor="middle" x="14173.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Query Projection</text>
<text text-anchor="middle" x="14173.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="14173.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="14173.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_q_proj_2_2 -->
<g id="edge103" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_q_proj_2_2</title>
<path fill="none" stroke="black" d="M11613.24,-4114.67C12149.64,-4107.52 13473.7,-4086.61 13939.59,-4048.62"/>
<polygon fill="black" stroke="black" points="13940.08,-4052.09 13949.76,-4047.78 13939.5,-4045.11 13940.08,-4052.09"/>
</g>
<!-- layer_0_k_proj_2_2 -->
<g id="node85" class="node">
<title>layer_0_k_proj_2_2</title>
<polygon fill="lightblue" stroke="black" points="14862,-4048.5 14415,-4048.5 14415,-3980.5 14862,-3980.5 14862,-4048.5"/>
<text text-anchor="middle" x="14638.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Key Projection</text>
<text text-anchor="middle" x="14638.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="14638.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="14638.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_k_proj_2_2 -->
<g id="edge104" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_k_proj_2_2</title>
<path fill="none" stroke="black" d="M11613.01,-4115.79C12217.49,-4110.71 13844.72,-4093.27 14404.57,-4048.62"/>
<polygon fill="black" stroke="black" points="14405.07,-4052.09 14414.76,-4047.79 14404.51,-4045.11 14405.07,-4052.09"/>
</g>
<!-- layer_0_v_proj_2_2 -->
<g id="node86" class="node">
<title>layer_0_v_proj_2_2</title>
<polygon fill="lightblue" stroke="black" points="15327,-4048.5 14880,-4048.5 14880,-3980.5 15327,-3980.5 15327,-4048.5"/>
<text text-anchor="middle" x="15103.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Value Projection</text>
<text text-anchor="middle" x="15103.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="15103.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="15103.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_v_proj_2_2 -->
<g id="edge105" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_v_proj_2_2</title>
<path fill="none" stroke="black" d="M11613.17,-4116.6C12280.99,-4113.42 14215.65,-4099.96 14869.75,-4048.6"/>
<polygon fill="black" stroke="black" points="14870.07,-4052.09 14879.76,-4047.8 14869.51,-4045.11 14870.07,-4052.09"/>
</g>
<!-- layer_0_q_proj_2_3 -->
<g id="node92" class="node">
<title>layer_0_q_proj_2_3</title>
<polygon fill="lightblue" stroke="black" points="15792,-4048.5 15345,-4048.5 15345,-3980.5 15792,-3980.5 15792,-4048.5"/>
<text text-anchor="middle" x="15568.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Query Projection</text>
<text text-anchor="middle" x="15568.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="15568.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="15568.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_q_proj_2_3 -->
<g id="edge113" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_q_proj_2_3</title>
<path fill="none" stroke="black" d="M11613.14,-4117.23C12339.93,-4115.79 14585.46,-4106.7 15334.66,-4048.61"/>
<polygon fill="black" stroke="black" points="15335.07,-4052.09 15344.76,-4047.81 15334.52,-4045.11 15335.07,-4052.09"/>
</g>
<!-- layer_0_k_proj_2_3 -->
<g id="node93" class="node">
<title>layer_0_k_proj_2_3</title>
<polygon fill="lightblue" stroke="black" points="16257,-4048.5 15810,-4048.5 15810,-3980.5 16257,-3980.5 16257,-4048.5"/>
<text text-anchor="middle" x="16033.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Key Projection</text>
<text text-anchor="middle" x="16033.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="16033.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="16033.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_k_proj_2_3 -->
<g id="edge114" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_k_proj_2_3</title>
<path fill="none" stroke="black" d="M11613.23,-4117.73C12395.74,-4117.91 14954.96,-4113.46 15799.6,-4048.61"/>
<polygon fill="black" stroke="black" points="15800.06,-4052.08 15809.76,-4047.82 15799.52,-4045.11 15800.06,-4052.08"/>
</g>
<!-- layer_0_v_proj_2_3 -->
<g id="node94" class="node">
<title>layer_0_v_proj_2_3</title>
<polygon fill="lightblue" stroke="black" points="16722,-4048.5 16275,-4048.5 16275,-3980.5 16722,-3980.5 16722,-4048.5"/>
<text text-anchor="middle" x="16498.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Value Projection</text>
<text text-anchor="middle" x="16498.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="16498.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="16498.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_v_proj_2_3 -->
<g id="edge115" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_v_proj_2_3</title>
<path fill="none" stroke="black" d="M11613.04,-4115.97C12510.33,-4109.78 15755.89,-4085.11 16264.65,-4048.58"/>
<polygon fill="black" stroke="black" points="16265.05,-4052.06 16274.76,-4047.83 16264.53,-4045.08 16265.05,-4052.06"/>
</g>
<!-- layer_0_q_proj_3_0 -->
<g id="node100" class="node">
<title>layer_0_q_proj_3_0</title>
<polygon fill="lightblue" stroke="black" points="17187,-4048.5 16740,-4048.5 16740,-3980.5 17187,-3980.5 17187,-4048.5"/>
<text text-anchor="middle" x="16963.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Query Projection</text>
<text text-anchor="middle" x="16963.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="16963.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="16963.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_q_proj_3_0 -->
<g id="edge123" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_q_proj_3_0</title>
<path fill="none" stroke="black" d="M11613.04,-4116.28C12564.09,-4110.98 16171.27,-4088.5 16729.44,-4048.6"/>
<polygon fill="black" stroke="black" points="16730.05,-4052.06 16739.76,-4047.83 16729.53,-4045.08 16730.05,-4052.06"/>
</g>
<!-- layer_0_k_proj_3_0 -->
<g id="node101" class="node">
<title>layer_0_k_proj_3_0</title>
<polygon fill="lightblue" stroke="black" points="17652,-4048.5 17205,-4048.5 17205,-3980.5 17652,-3980.5 17652,-4048.5"/>
<text text-anchor="middle" x="17428.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Key Projection</text>
<text text-anchor="middle" x="17428.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="17428.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="17428.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_k_proj_3_0 -->
<g id="edge124" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_k_proj_3_0</title>
<path fill="none" stroke="black" d="M11613.17,-4116.53C12615.97,-4112.08 16587.23,-4091.89 17194.38,-4048.6"/>
<polygon fill="black" stroke="black" points="17195.05,-4052.06 17204.76,-4047.83 17194.53,-4045.08 17195.05,-4052.06"/>
</g>
<!-- layer_0_v_proj_3_0 -->
<g id="node102" class="node">
<title>layer_0_v_proj_3_0</title>
<polygon fill="lightblue" stroke="black" points="18117,-4048.5 17670,-4048.5 17670,-3980.5 18117,-3980.5 18117,-4048.5"/>
<text text-anchor="middle" x="17893.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Value Projection</text>
<text text-anchor="middle" x="17893.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="17893.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="17893.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_v_proj_3_0 -->
<g id="edge125" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_v_proj_3_0</title>
<path fill="none" stroke="black" d="M11613.13,-4116.75C12665.46,-4113.09 17003.71,-4095.29 17659.46,-4048.6"/>
<polygon fill="black" stroke="black" points="17660.05,-4052.06 17669.76,-4047.84 17659.53,-4045.08 17660.05,-4052.06"/>
</g>
<!-- layer_0_q_proj_3_1 -->
<g id="node108" class="node">
<title>layer_0_q_proj_3_1</title>
<polygon fill="lightblue" stroke="black" points="18582,-4048.5 18135,-4048.5 18135,-3980.5 18582,-3980.5 18582,-4048.5"/>
<text text-anchor="middle" x="18358.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Query Projection</text>
<text text-anchor="middle" x="18358.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="18358.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="18358.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_q_proj_3_1 -->
<g id="edge133" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_q_proj_3_1</title>
<path fill="none" stroke="black" d="M11613.34,-4116.94C12713.93,-4114.02 17420.84,-4098.7 18124.69,-4048.58"/>
<polygon fill="black" stroke="black" points="18125.05,-4052.06 18134.76,-4047.84 18124.53,-4045.08 18125.05,-4052.06"/>
</g>
<!-- layer_0_k_proj_3_1 -->
<g id="node109" class="node">
<title>layer_0_k_proj_3_1</title>
<polygon fill="lightblue" stroke="black" points="19047,-4048.5 18600,-4048.5 18600,-3980.5 19047,-3980.5 19047,-4048.5"/>
<text text-anchor="middle" x="18823.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Key Projection</text>
<text text-anchor="middle" x="18823.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="18823.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="18823.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_k_proj_3_1 -->
<g id="edge134" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_k_proj_3_1</title>
<path fill="none" stroke="black" d="M11613.25,-4117.1C12759.83,-4114.88 17837.27,-4102.13 18589.79,-4048.57"/>
<polygon fill="black" stroke="black" points="18590.05,-4052.07 18599.76,-4047.84 18589.53,-4045.08 18590.05,-4052.07"/>
</g>
<!-- layer_0_v_proj_3_1 -->
<g id="node110" class="node">
<title>layer_0_v_proj_3_1</title>
<polygon fill="lightblue" stroke="black" points="19512,-4048.5 19065,-4048.5 19065,-3980.5 19512,-3980.5 19512,-4048.5"/>
<text text-anchor="middle" x="19288.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Value Projection</text>
<text text-anchor="middle" x="19288.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="19288.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="19288.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_v_proj_3_1 -->
<g id="edge135" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_v_proj_3_1</title>
<path fill="none" stroke="black" d="M11613.09,-4117.25C12803.95,-4115.7 18252.78,-4105.57 19054.7,-4048.58"/>
<polygon fill="black" stroke="black" points="19055.04,-4052.07 19064.76,-4047.85 19054.53,-4045.08 19055.04,-4052.07"/>
</g>
<!-- layer_0_q_proj_3_2 -->
<g id="node116" class="node">
<title>layer_0_q_proj_3_2</title>
<polygon fill="lightblue" stroke="black" points="19977,-4048.5 19530,-4048.5 19530,-3980.5 19977,-3980.5 19977,-4048.5"/>
<text text-anchor="middle" x="19753.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Query Projection</text>
<text text-anchor="middle" x="19753.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="19753.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="19753.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_q_proj_3_2 -->
<g id="edge143" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_q_proj_3_2</title>
<path fill="none" stroke="black" d="M11613.11,-4117.38C12847.27,-4116.47 18668.6,-4109.01 19519.68,-4048.58"/>
<polygon fill="black" stroke="black" points="19520.04,-4052.07 19529.76,-4047.85 19519.53,-4045.08 19520.04,-4052.07"/>
</g>
<!-- layer_0_k_proj_3_2 -->
<g id="node117" class="node">
<title>layer_0_k_proj_3_2</title>
<polygon fill="lightblue" stroke="black" points="20442,-4048.5 19995,-4048.5 19995,-3980.5 20442,-3980.5 20442,-4048.5"/>
<text text-anchor="middle" x="20218.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Key Projection</text>
<text text-anchor="middle" x="20218.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="20218.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="20218.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_k_proj_3_2 -->
<g id="edge144" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_k_proj_3_2</title>
<path fill="none" stroke="black" d="M11613.24,-4117.49C12889.78,-4117.19 19084.73,-4112.46 19984.74,-4048.58"/>
<polygon fill="black" stroke="black" points="19985.04,-4052.07 19994.76,-4047.85 19984.54,-4045.09 19985.04,-4052.07"/>
</g>
<!-- layer_0_v_proj_3_2 -->
<g id="node118" class="node">
<title>layer_0_v_proj_3_2</title>
<polygon fill="lightblue" stroke="black" points="20907,-4048.5 20460,-4048.5 20460,-3980.5 20907,-3980.5 20907,-4048.5"/>
<text text-anchor="middle" x="20683.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Value Projection</text>
<text text-anchor="middle" x="20683.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="20683.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="20683.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_v_proj_3_2 -->
<g id="edge145" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_v_proj_3_2</title>
<path fill="none" stroke="black" d="M11613.12,-4117.59C12930.23,-4117.88 19499.47,-4115.92 20449.52,-4048.6"/>
<polygon fill="black" stroke="black" points="20450.04,-4052.07 20459.76,-4047.85 20449.54,-4045.09 20450.04,-4052.07"/>
</g>
<!-- layer_0_q_proj_3_3 -->
<g id="node124" class="node">
<title>layer_0_q_proj_3_3</title>
<polygon fill="lightblue" stroke="black" points="21372,-4048.5 20925,-4048.5 20925,-3980.5 21372,-3980.5 21372,-4048.5"/>
<text text-anchor="middle" x="21148.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Query Projection</text>
<text text-anchor="middle" x="21148.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="21148.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="21148.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_q_proj_3_3 -->
<g id="edge153" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_q_proj_3_3</title>
<path fill="none" stroke="black" d="M11613.15,-4117.68C12970.3,-4118.53 19916.07,-4119.38 20914.7,-4048.58"/>
<polygon fill="black" stroke="black" points="20915.04,-4052.07 20924.76,-4047.85 20914.54,-4045.09 20915.04,-4052.07"/>
</g>
<!-- layer_0_k_proj_3_3 -->
<g id="node125" class="node">
<title>layer_0_k_proj_3_3</title>
<polygon fill="lightblue" stroke="black" points="21837,-4048.5 21390,-4048.5 21390,-3980.5 21837,-3980.5 21837,-4048.5"/>
<text text-anchor="middle" x="21613.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Key Projection</text>
<text text-anchor="middle" x="21613.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="21613.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="21613.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_k_proj_3_3 -->
<g id="edge154" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_k_proj_3_3</title>
<path fill="none" stroke="black" d="M11613.16,-4117.77C13009.23,-4119.15 20331.17,-4122.85 21379.57,-4048.59"/>
<polygon fill="black" stroke="black" points="21380.04,-4052.07 21389.76,-4047.85 21379.54,-4045.09 21380.04,-4052.07"/>
</g>
<!-- layer_0_v_proj_3_3 -->
<g id="node126" class="node">
<title>layer_0_v_proj_3_3</title>
<polygon fill="lightblue" stroke="black" points="22302,-4048.5 21855,-4048.5 21855,-3980.5 22302,-3980.5 22302,-4048.5"/>
<text text-anchor="middle" x="22078.5" y="-4033.3" font-family="Times,serif" font-size="14.00">Value Projection</text>
<text text-anchor="middle" x="22078.5" y="-4018.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="22078.5" y="-4003.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8×32=256]</text>
<text text-anchor="middle" x="22078.5" y="-3988.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_v_proj_3_3 -->
<g id="edge155" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_v_proj_3_3</title>
<path fill="none" stroke="black" d="M11613.09,-4116.86C13091.05,-4112.66 21223.28,-4087.84 21844.56,-4048.55"/>
<polygon fill="black" stroke="black" points="21845.03,-4052.03 21854.76,-4047.85 21844.55,-4045.04 21845.03,-4052.03"/>
</g>
<!-- layer_0_residual1 -->
<g id="node154" class="node">
<title>layer_0_residual1</title>
<polygon fill="lightblue" stroke="black" points="18847,-3354.08 18198,-3354.08 18198,-3286.08 18847,-3286.08 18847,-3354.08"/>
<text text-anchor="middle" x="18522.5" y="-3338.88" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="18522.5" y="-3323.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 4096], [batch_size=128, seq_len=10000, 4096]</text>
<text text-anchor="middle" x="18522.5" y="-3308.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="18522.5" y="-3293.88" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15 (all)</text>
</g>
<!-- layer_0_norm1&#45;&gt;layer_0_residual1 -->
<g id="edge184" class="edge">
<title>layer_0_norm1&#45;&gt;layer_0_residual1</title>
<path fill="none" stroke="black" d="M11613.1,-4117.07C13181.78,-4113.99 22259.36,-4094.2 22311.5,-4048.5 22357.73,-4007.98 22330.5,-3972.97 22330.5,-3911.5 22330.5,-3911.5 22330.5,-3911.5 22330.5,-3583.42 22330.5,-3410.1 19786.78,-3344.85 18857.35,-3326.8"/>
<polygon fill="black" stroke="black" points="18857.23,-3323.29 18847.17,-3326.6 18857.1,-3330.29 18857.23,-3323.29"/>
</g>
<!-- layer_0_q_reshape_0_0 -->
<g id="node7" class="node">
<title>layer_0_q_reshape_0_0</title>
<polygon fill="lightblue" stroke="black" points="426.5,-3944.5 62.5,-3944.5 62.5,-3876.5 426.5,-3876.5 426.5,-3944.5"/>
<text text-anchor="middle" x="244.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Query</text>
<text text-anchor="middle" x="244.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="244.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="244.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_q_proj_0_0&#45;&gt;layer_0_q_reshape_0_0 -->
<g id="edge6" class="edge">
<title>layer_0_q_proj_0_0&#45;&gt;layer_0_q_reshape_0_0</title>
<path fill="none" stroke="black" d="M230.32,-3980.38C232.01,-3972.19 233.84,-3963.29 235.61,-3954.69"/>
<polygon fill="black" stroke="black" points="239.06,-3955.3 237.64,-3944.8 232.2,-3953.89 239.06,-3955.3"/>
</g>
<!-- layer_0_k_reshape_0_0 -->
<g id="node8" class="node">
<title>layer_0_k_reshape_0_0</title>
<polygon fill="lightblue" stroke="black" points="891.5,-3944.5 527.5,-3944.5 527.5,-3876.5 891.5,-3876.5 891.5,-3944.5"/>
<text text-anchor="middle" x="709.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Key</text>
<text text-anchor="middle" x="709.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="709.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="709.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_k_proj_0_0&#45;&gt;layer_0_k_reshape_0_0 -->
<g id="edge7" class="edge">
<title>layer_0_k_proj_0_0&#45;&gt;layer_0_k_reshape_0_0</title>
<path fill="none" stroke="black" d="M695.32,-3980.38C697.01,-3972.19 698.84,-3963.29 700.61,-3954.69"/>
<polygon fill="black" stroke="black" points="704.06,-3955.3 702.64,-3944.8 697.2,-3953.89 704.06,-3955.3"/>
</g>
<!-- layer_0_v_reshape_0_0 -->
<g id="node9" class="node">
<title>layer_0_v_reshape_0_0</title>
<polygon fill="lightblue" stroke="black" points="1314.5,-3944.5 950.5,-3944.5 950.5,-3876.5 1314.5,-3876.5 1314.5,-3944.5"/>
<text text-anchor="middle" x="1132.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Value</text>
<text text-anchor="middle" x="1132.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="1132.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="1132.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_v_proj_0_0&#45;&gt;layer_0_v_reshape_0_0 -->
<g id="edge8" class="edge">
<title>layer_0_v_proj_0_0&#45;&gt;layer_0_v_reshape_0_0</title>
<path fill="none" stroke="black" d="M1146.68,-3980.38C1144.99,-3972.19 1143.16,-3963.29 1141.39,-3954.69"/>
<polygon fill="black" stroke="black" points="1144.8,-3953.89 1139.36,-3944.8 1137.94,-3955.3 1144.8,-3953.89"/>
</g>
<!-- layer_0_attn_0_0 -->
<g id="node10" class="node">
<title>layer_0_attn_0_0</title>
<polygon fill="lightblue" stroke="black" points="1162.5,-3840.5 680.5,-3840.5 680.5,-3772.5 1162.5,-3772.5 1162.5,-3840.5"/>
<text text-anchor="middle" x="921.5" y="-3825.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="921.5" y="-3810.3" font-family="Times,serif" font-size="14.00">Input: Q[128,10000,8,32], K[128,10000,8,32], V[128,10000,8,32]</text>
<text text-anchor="middle" x="921.5" y="-3795.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="921.5" y="-3780.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_q_reshape_0_0&#45;&gt;layer_0_attn_0_0 -->
<g id="edge9" class="edge">
<title>layer_0_q_reshape_0_0&#45;&gt;layer_0_attn_0_0</title>
<path fill="none" stroke="black" d="M426.81,-3882.03C508.55,-3869.72 605.85,-3855.06 692.44,-3842.01"/>
<polygon fill="black" stroke="black" points="693.04,-3845.46 702.4,-3840.51 691.99,-3838.54 693.04,-3845.46"/>
</g>
<!-- layer_0_k_reshape_0_0&#45;&gt;layer_0_attn_0_0 -->
<g id="edge10" class="edge">
<title>layer_0_k_reshape_0_0&#45;&gt;layer_0_attn_0_0</title>
<path fill="none" stroke="black" d="M778.33,-3876.38C799.17,-3866.36 822.21,-3855.27 843.6,-3844.98"/>
<polygon fill="black" stroke="black" points="845.16,-3848.11 852.65,-3840.62 842.12,-3841.81 845.16,-3848.11"/>
</g>
<!-- layer_0_v_reshape_0_0&#45;&gt;layer_0_attn_0_0 -->
<g id="edge11" class="edge">
<title>layer_0_v_reshape_0_0&#45;&gt;layer_0_attn_0_0</title>
<path fill="none" stroke="black" d="M1063.99,-3876.38C1043.25,-3866.36 1020.32,-3855.27 999.04,-3844.98"/>
<polygon fill="black" stroke="black" points="1000.55,-3841.83 990.02,-3840.62 997.5,-3848.13 1000.55,-3841.83"/>
</g>
<!-- layer_0_attn_reshape_0_0 -->
<g id="node11" class="node">
<title>layer_0_attn_reshape_0_0</title>
<polygon fill="lightblue" stroke="black" points="2353,-3736.5 1998,-3736.5 1998,-3668.5 2353,-3668.5 2353,-3736.5"/>
<text text-anchor="middle" x="2175.5" y="-3721.3" font-family="Times,serif" font-size="14.00">Reshape Attention Output</text>
<text text-anchor="middle" x="2175.5" y="-3706.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="2175.5" y="-3691.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="2175.5" y="-3676.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_attn_0_0&#45;&gt;layer_0_attn_reshape_0_0 -->
<g id="edge12" class="edge">
<title>layer_0_attn_0_0&#45;&gt;layer_0_attn_reshape_0_0</title>
<path fill="none" stroke="black" d="M1162.54,-3785.89C1403.22,-3766.32 1768.09,-3736.64 1987.95,-3718.75"/>
<polygon fill="black" stroke="black" points="1988.3,-3722.24 1997.98,-3717.94 1987.73,-3715.26 1988.3,-3722.24"/>
</g>
<!-- layer_0_concat_intra_0 -->
<g id="node132" class="node">
<title>layer_0_concat_intra_0</title>
<ellipse fill="lightyellow" stroke="black" cx="3478.5" cy="-3584.42" rx="257.27" ry="48.17"/>
<text text-anchor="middle" x="3478.5" y="-3603.22" font-family="Times,serif" font-size="14.00">Intra&#45;Group Concatenation</text>
<text text-anchor="middle" x="3478.5" y="-3588.22" font-family="Times,serif" font-size="14.00">Input: 4×[batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="3478.5" y="-3573.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 1024]</text>
<text text-anchor="middle" x="3478.5" y="-3558.22" font-family="Times,serif" font-size="14.00">GPU: [0, 1, 2, 3]</text>
</g>
<!-- layer_0_attn_reshape_0_0&#45;&gt;layer_0_concat_intra_0 -->
<g id="edge163" class="edge">
<title>layer_0_attn_reshape_0_0&#45;&gt;layer_0_concat_intra_0</title>
<path fill="none" stroke="black" d="M2353.26,-3685.66C2582.46,-3665.24 2981.92,-3629.66 3238.06,-3606.84"/>
<polygon fill="black" stroke="black" points="3238.6,-3610.3 3248.25,-3605.93 3237.98,-3603.33 3238.6,-3610.3"/>
</g>
<!-- layer_0_q_reshape_0_1 -->
<g id="node15" class="node">
<title>layer_0_q_reshape_0_1</title>
<polygon fill="lightblue" stroke="black" points="1841.5,-3944.5 1477.5,-3944.5 1477.5,-3876.5 1841.5,-3876.5 1841.5,-3944.5"/>
<text text-anchor="middle" x="1659.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Query</text>
<text text-anchor="middle" x="1659.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="1659.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="1659.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_0_q_proj_0_1&#45;&gt;layer_0_q_reshape_0_1 -->
<g id="edge16" class="edge">
<title>layer_0_q_proj_0_1&#45;&gt;layer_0_q_reshape_0_1</title>
<path fill="none" stroke="black" d="M1631.81,-3980.38C1635.18,-3972.01 1638.84,-3962.9 1642.36,-3954.13"/>
<polygon fill="black" stroke="black" points="1645.63,-3955.38 1646.11,-3944.8 1639.14,-3952.77 1645.63,-3955.38"/>
</g>
<!-- layer_0_k_reshape_0_1 -->
<g id="node16" class="node">
<title>layer_0_k_reshape_0_1</title>
<polygon fill="lightblue" stroke="black" points="2286.5,-3944.5 1922.5,-3944.5 1922.5,-3876.5 2286.5,-3876.5 2286.5,-3944.5"/>
<text text-anchor="middle" x="2104.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Key</text>
<text text-anchor="middle" x="2104.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="2104.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="2104.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_0_k_proj_0_1&#45;&gt;layer_0_k_reshape_0_1 -->
<g id="edge17" class="edge">
<title>layer_0_k_proj_0_1&#45;&gt;layer_0_k_reshape_0_1</title>
<path fill="none" stroke="black" d="M2090.32,-3980.38C2092.01,-3972.19 2093.84,-3963.29 2095.61,-3954.69"/>
<polygon fill="black" stroke="black" points="2099.06,-3955.3 2097.64,-3944.8 2092.2,-3953.89 2099.06,-3955.3"/>
</g>
<!-- layer_0_v_reshape_0_1 -->
<g id="node17" class="node">
<title>layer_0_v_reshape_0_1</title>
<polygon fill="lightblue" stroke="black" points="2709.5,-3944.5 2345.5,-3944.5 2345.5,-3876.5 2709.5,-3876.5 2709.5,-3944.5"/>
<text text-anchor="middle" x="2527.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Value</text>
<text text-anchor="middle" x="2527.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="2527.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="2527.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_0_v_proj_0_1&#45;&gt;layer_0_v_reshape_0_1 -->
<g id="edge18" class="edge">
<title>layer_0_v_proj_0_1&#45;&gt;layer_0_v_reshape_0_1</title>
<path fill="none" stroke="black" d="M2541.68,-3980.38C2539.99,-3972.19 2538.16,-3963.29 2536.39,-3954.69"/>
<polygon fill="black" stroke="black" points="2539.8,-3953.89 2534.36,-3944.8 2532.94,-3955.3 2539.8,-3953.89"/>
</g>
<!-- layer_0_attn_0_1 -->
<g id="node18" class="node">
<title>layer_0_attn_0_1</title>
<polygon fill="lightblue" stroke="black" points="2556.5,-3840.5 2074.5,-3840.5 2074.5,-3772.5 2556.5,-3772.5 2556.5,-3840.5"/>
<text text-anchor="middle" x="2315.5" y="-3825.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2315.5" y="-3810.3" font-family="Times,serif" font-size="14.00">Input: Q[128,10000,8,32], K[128,10000,8,32], V[128,10000,8,32]</text>
<text text-anchor="middle" x="2315.5" y="-3795.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="2315.5" y="-3780.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_0_q_reshape_0_1&#45;&gt;layer_0_attn_0_1 -->
<g id="edge19" class="edge">
<title>layer_0_q_reshape_0_1&#45;&gt;layer_0_attn_0_1</title>
<path fill="none" stroke="black" d="M1841.8,-3881.15C1919.67,-3869.05 2011.3,-3854.8 2093.12,-3842.08"/>
<polygon fill="black" stroke="black" points="2093.7,-3845.53 2103.05,-3840.53 2092.63,-3838.61 2093.7,-3845.53"/>
</g>
<!-- layer_0_k_reshape_0_1&#45;&gt;layer_0_attn_0_1 -->
<g id="edge20" class="edge">
<title>layer_0_k_reshape_0_1&#45;&gt;layer_0_attn_0_1</title>
<path fill="none" stroke="black" d="M2173.01,-3876.38C2193.75,-3866.36 2216.68,-3855.27 2237.96,-3844.98"/>
<polygon fill="black" stroke="black" points="2239.5,-3848.13 2246.98,-3840.62 2236.45,-3841.83 2239.5,-3848.13"/>
</g>
<!-- layer_0_v_reshape_0_1&#45;&gt;layer_0_attn_0_1 -->
<g id="edge21" class="edge">
<title>layer_0_v_reshape_0_1&#45;&gt;layer_0_attn_0_1</title>
<path fill="none" stroke="black" d="M2458.67,-3876.38C2437.83,-3866.36 2414.79,-3855.27 2393.4,-3844.98"/>
<polygon fill="black" stroke="black" points="2394.88,-3841.81 2384.35,-3840.62 2391.84,-3848.11 2394.88,-3841.81"/>
</g>
<!-- layer_0_attn_reshape_0_1 -->
<g id="node19" class="node">
<title>layer_0_attn_reshape_0_1</title>
<polygon fill="lightblue" stroke="black" points="3004,-3736.5 2649,-3736.5 2649,-3668.5 3004,-3668.5 3004,-3736.5"/>
<text text-anchor="middle" x="2826.5" y="-3721.3" font-family="Times,serif" font-size="14.00">Reshape Attention Output</text>
<text text-anchor="middle" x="2826.5" y="-3706.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="2826.5" y="-3691.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="2826.5" y="-3676.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_0_attn_0_1&#45;&gt;layer_0_attn_reshape_0_1 -->
<g id="edge22" class="edge">
<title>layer_0_attn_0_1&#45;&gt;layer_0_attn_reshape_0_1</title>
<path fill="none" stroke="black" d="M2481.05,-3772.45C2535.37,-3761.61 2595.89,-3749.53 2650.92,-3738.55"/>
<polygon fill="black" stroke="black" points="2651.65,-3741.97 2660.77,-3736.58 2650.28,-3735.11 2651.65,-3741.97"/>
</g>
<!-- layer_0_attn_reshape_0_1&#45;&gt;layer_0_concat_intra_0 -->
<g id="edge164" class="edge">
<title>layer_0_attn_reshape_0_1&#45;&gt;layer_0_concat_intra_0</title>
<path fill="none" stroke="black" d="M3004.23,-3669.86C3091.09,-3654.39 3195.8,-3635.75 3284.71,-3619.92"/>
<polygon fill="black" stroke="black" points="3285.41,-3623.35 3294.64,-3618.15 3284.18,-3616.46 3285.41,-3623.35"/>
</g>
<!-- layer_0_q_reshape_0_2 -->
<g id="node23" class="node">
<title>layer_0_q_reshape_0_2</title>
<polygon fill="lightblue" stroke="black" points="3237.5,-3944.5 2873.5,-3944.5 2873.5,-3876.5 3237.5,-3876.5 3237.5,-3944.5"/>
<text text-anchor="middle" x="3055.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Query</text>
<text text-anchor="middle" x="3055.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="3055.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="3055.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_0_q_proj_0_2&#45;&gt;layer_0_q_reshape_0_2 -->
<g id="edge26" class="edge">
<title>layer_0_q_proj_0_2&#45;&gt;layer_0_q_reshape_0_2</title>
<path fill="none" stroke="black" d="M3027.14,-3980.38C3030.58,-3972.01 3034.33,-3962.9 3037.95,-3954.13"/>
<polygon fill="black" stroke="black" points="3041.22,-3955.38 3041.79,-3944.8 3034.74,-3952.71 3041.22,-3955.38"/>
</g>
<!-- layer_0_k_reshape_0_2 -->
<g id="node24" class="node">
<title>layer_0_k_reshape_0_2</title>
<polygon fill="lightblue" stroke="black" points="3660.5,-3944.5 3296.5,-3944.5 3296.5,-3876.5 3660.5,-3876.5 3660.5,-3944.5"/>
<text text-anchor="middle" x="3478.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Key</text>
<text text-anchor="middle" x="3478.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="3478.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="3478.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_0_k_proj_0_2&#45;&gt;layer_0_k_reshape_0_2 -->
<g id="edge27" class="edge">
<title>layer_0_k_proj_0_2&#45;&gt;layer_0_k_reshape_0_2</title>
<path fill="none" stroke="black" d="M3478.5,-3980.38C3478.5,-3972.28 3478.5,-3963.48 3478.5,-3954.97"/>
<polygon fill="black" stroke="black" points="3482,-3954.8 3478.5,-3944.8 3475,-3954.8 3482,-3954.8"/>
</g>
<!-- layer_0_v_reshape_0_2 -->
<g id="node25" class="node">
<title>layer_0_v_reshape_0_2</title>
<polygon fill="lightblue" stroke="black" points="4084.5,-3944.5 3720.5,-3944.5 3720.5,-3876.5 4084.5,-3876.5 4084.5,-3944.5"/>
<text text-anchor="middle" x="3902.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Value</text>
<text text-anchor="middle" x="3902.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="3902.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="3902.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_0_v_proj_0_2&#45;&gt;layer_0_v_reshape_0_2 -->
<g id="edge28" class="edge">
<title>layer_0_v_proj_0_2&#45;&gt;layer_0_v_reshape_0_2</title>
<path fill="none" stroke="black" d="M3930.19,-3980.38C3926.82,-3972.01 3923.16,-3962.9 3919.64,-3954.13"/>
<polygon fill="black" stroke="black" points="3922.86,-3952.77 3915.89,-3944.8 3916.37,-3955.38 3922.86,-3952.77"/>
</g>
<!-- layer_0_attn_0_2 -->
<g id="node26" class="node">
<title>layer_0_attn_0_2</title>
<polygon fill="lightblue" stroke="black" points="3719.5,-3840.5 3237.5,-3840.5 3237.5,-3772.5 3719.5,-3772.5 3719.5,-3840.5"/>
<text text-anchor="middle" x="3478.5" y="-3825.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3478.5" y="-3810.3" font-family="Times,serif" font-size="14.00">Input: Q[128,10000,8,32], K[128,10000,8,32], V[128,10000,8,32]</text>
<text text-anchor="middle" x="3478.5" y="-3795.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="3478.5" y="-3780.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_0_q_reshape_0_2&#45;&gt;layer_0_attn_0_2 -->
<g id="edge29" class="edge">
<title>layer_0_q_reshape_0_2&#45;&gt;layer_0_attn_0_2</title>
<path fill="none" stroke="black" d="M3192.54,-3876.45C3236.94,-3865.75 3286.36,-3853.83 3331.46,-3842.96"/>
<polygon fill="black" stroke="black" points="3332.41,-3846.33 3341.31,-3840.58 3330.77,-3839.52 3332.41,-3846.33"/>
</g>
<!-- layer_0_k_reshape_0_2&#45;&gt;layer_0_attn_0_2 -->
<g id="edge30" class="edge">
<title>layer_0_k_reshape_0_2&#45;&gt;layer_0_attn_0_2</title>
<path fill="none" stroke="black" d="M3478.5,-3876.38C3478.5,-3868.28 3478.5,-3859.48 3478.5,-3850.97"/>
<polygon fill="black" stroke="black" points="3482,-3850.8 3478.5,-3840.8 3475,-3850.8 3482,-3850.8"/>
</g>
<!-- layer_0_v_reshape_0_2&#45;&gt;layer_0_attn_0_2 -->
<g id="edge31" class="edge">
<title>layer_0_v_reshape_0_2&#45;&gt;layer_0_attn_0_2</title>
<path fill="none" stroke="black" d="M3765.13,-3876.45C3720.63,-3865.75 3671.09,-3853.83 3625.89,-3842.96"/>
<polygon fill="black" stroke="black" points="3626.55,-3839.52 3616.01,-3840.58 3624.92,-3846.32 3626.55,-3839.52"/>
</g>
<!-- layer_0_attn_reshape_0_2 -->
<g id="node27" class="node">
<title>layer_0_attn_reshape_0_2</title>
<polygon fill="lightblue" stroke="black" points="3656,-3736.5 3301,-3736.5 3301,-3668.5 3656,-3668.5 3656,-3736.5"/>
<text text-anchor="middle" x="3478.5" y="-3721.3" font-family="Times,serif" font-size="14.00">Reshape Attention Output</text>
<text text-anchor="middle" x="3478.5" y="-3706.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="3478.5" y="-3691.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="3478.5" y="-3676.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_0_attn_0_2&#45;&gt;layer_0_attn_reshape_0_2 -->
<g id="edge32" class="edge">
<title>layer_0_attn_0_2&#45;&gt;layer_0_attn_reshape_0_2</title>
<path fill="none" stroke="black" d="M3478.5,-3772.38C3478.5,-3764.28 3478.5,-3755.48 3478.5,-3746.97"/>
<polygon fill="black" stroke="black" points="3482,-3746.8 3478.5,-3736.8 3475,-3746.8 3482,-3746.8"/>
</g>
<!-- layer_0_attn_reshape_0_2&#45;&gt;layer_0_concat_intra_0 -->
<g id="edge165" class="edge">
<title>layer_0_attn_reshape_0_2&#45;&gt;layer_0_concat_intra_0</title>
<path fill="none" stroke="black" d="M3478.5,-3668.23C3478.5,-3660.24 3478.5,-3651.48 3478.5,-3642.73"/>
<polygon fill="black" stroke="black" points="3482,-3642.53 3478.5,-3632.53 3475,-3642.53 3482,-3642.53"/>
</g>
<!-- layer_0_q_reshape_0_3 -->
<g id="node31" class="node">
<title>layer_0_q_reshape_0_3</title>
<polygon fill="lightblue" stroke="black" points="4611.5,-3944.5 4247.5,-3944.5 4247.5,-3876.5 4611.5,-3876.5 4611.5,-3944.5"/>
<text text-anchor="middle" x="4429.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Query</text>
<text text-anchor="middle" x="4429.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="4429.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="4429.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_0_q_proj_0_3&#45;&gt;layer_0_q_reshape_0_3 -->
<g id="edge36" class="edge">
<title>layer_0_q_proj_0_3&#45;&gt;layer_0_q_reshape_0_3</title>
<path fill="none" stroke="black" d="M4415.32,-3980.38C4417.01,-3972.19 4418.84,-3963.29 4420.61,-3954.69"/>
<polygon fill="black" stroke="black" points="4424.06,-3955.3 4422.64,-3944.8 4417.2,-3953.89 4424.06,-3955.3"/>
</g>
<!-- layer_0_k_reshape_0_3 -->
<g id="node32" class="node">
<title>layer_0_k_reshape_0_3</title>
<polygon fill="lightblue" stroke="black" points="5014.5,-3944.5 4650.5,-3944.5 4650.5,-3876.5 5014.5,-3876.5 5014.5,-3944.5"/>
<text text-anchor="middle" x="4832.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Key</text>
<text text-anchor="middle" x="4832.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="4832.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="4832.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_0_k_proj_0_3&#45;&gt;layer_0_k_reshape_0_3 -->
<g id="edge37" class="edge">
<title>layer_0_k_proj_0_3&#45;&gt;layer_0_k_reshape_0_3</title>
<path fill="none" stroke="black" d="M4860.19,-3980.38C4856.82,-3972.01 4853.16,-3962.9 4849.64,-3954.13"/>
<polygon fill="black" stroke="black" points="4852.86,-3952.77 4845.89,-3944.8 4846.37,-3955.38 4852.86,-3952.77"/>
</g>
<!-- layer_0_v_reshape_0_3 -->
<g id="node33" class="node">
<title>layer_0_v_reshape_0_3</title>
<polygon fill="lightblue" stroke="black" points="5458.5,-3944.5 5094.5,-3944.5 5094.5,-3876.5 5458.5,-3876.5 5458.5,-3944.5"/>
<text text-anchor="middle" x="5276.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Value</text>
<text text-anchor="middle" x="5276.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="5276.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="5276.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_0_v_proj_0_3&#45;&gt;layer_0_v_reshape_0_3 -->
<g id="edge38" class="edge">
<title>layer_0_v_proj_0_3&#45;&gt;layer_0_v_reshape_0_3</title>
<path fill="none" stroke="black" d="M5318.37,-3980.38C5313.17,-3971.83 5307.51,-3962.51 5302.07,-3953.57"/>
<polygon fill="black" stroke="black" points="5304.93,-3951.53 5296.74,-3944.8 5298.94,-3955.16 5304.93,-3951.53"/>
</g>
<!-- layer_0_attn_0_3 -->
<g id="node34" class="node">
<title>layer_0_attn_0_3</title>
<polygon fill="lightblue" stroke="black" points="4882.5,-3840.5 4400.5,-3840.5 4400.5,-3772.5 4882.5,-3772.5 4882.5,-3840.5"/>
<text text-anchor="middle" x="4641.5" y="-3825.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4641.5" y="-3810.3" font-family="Times,serif" font-size="14.00">Input: Q[128,10000,8,32], K[128,10000,8,32], V[128,10000,8,32]</text>
<text text-anchor="middle" x="4641.5" y="-3795.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="4641.5" y="-3780.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_0_q_reshape_0_3&#45;&gt;layer_0_attn_0_3 -->
<g id="edge39" class="edge">
<title>layer_0_q_reshape_0_3&#45;&gt;layer_0_attn_0_3</title>
<path fill="none" stroke="black" d="M4498.33,-3876.38C4519.17,-3866.36 4542.21,-3855.27 4563.6,-3844.98"/>
<polygon fill="black" stroke="black" points="4565.16,-3848.11 4572.65,-3840.62 4562.12,-3841.81 4565.16,-3848.11"/>
</g>
<!-- layer_0_k_reshape_0_3&#45;&gt;layer_0_attn_0_3 -->
<g id="edge40" class="edge">
<title>layer_0_k_reshape_0_3&#45;&gt;layer_0_attn_0_3</title>
<path fill="none" stroke="black" d="M4770.49,-3876.38C4751.96,-3866.49 4731.51,-3855.57 4712.46,-3845.4"/>
<polygon fill="black" stroke="black" points="4714,-3842.25 4703.53,-3840.62 4710.7,-3848.42 4714,-3842.25"/>
</g>
<!-- layer_0_v_reshape_0_3&#45;&gt;layer_0_attn_0_3 -->
<g id="edge41" class="edge">
<title>layer_0_v_reshape_0_3&#45;&gt;layer_0_attn_0_3</title>
<path fill="none" stroke="black" d="M5094.11,-3880.2C5020.2,-3868.33 4934.28,-3854.53 4857.29,-3842.16"/>
<polygon fill="black" stroke="black" points="4857.4,-3838.64 4846.98,-3840.51 4856.29,-3845.55 4857.4,-3838.64"/>
</g>
<!-- layer_0_attn_reshape_0_3 -->
<g id="node35" class="node">
<title>layer_0_attn_reshape_0_3</title>
<polygon fill="lightblue" stroke="black" points="4307,-3736.5 3952,-3736.5 3952,-3668.5 4307,-3668.5 4307,-3736.5"/>
<text text-anchor="middle" x="4129.5" y="-3721.3" font-family="Times,serif" font-size="14.00">Reshape Attention Output</text>
<text text-anchor="middle" x="4129.5" y="-3706.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="4129.5" y="-3691.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="4129.5" y="-3676.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_0_attn_0_3&#45;&gt;layer_0_attn_reshape_0_3 -->
<g id="edge42" class="edge">
<title>layer_0_attn_0_3&#45;&gt;layer_0_attn_reshape_0_3</title>
<path fill="none" stroke="black" d="M4475.62,-3772.45C4421.2,-3761.61 4360.56,-3749.53 4305.42,-3738.55"/>
<polygon fill="black" stroke="black" points="4306.04,-3735.1 4295.55,-3736.58 4304.68,-3741.97 4306.04,-3735.1"/>
</g>
<!-- layer_0_attn_reshape_0_3&#45;&gt;layer_0_concat_intra_0 -->
<g id="edge166" class="edge">
<title>layer_0_attn_reshape_0_3&#45;&gt;layer_0_concat_intra_0</title>
<path fill="none" stroke="black" d="M3951.61,-3669.78C3864.98,-3654.33 3760.65,-3635.73 3672.03,-3619.93"/>
<polygon fill="black" stroke="black" points="3672.59,-3616.47 3662.13,-3618.16 3671.36,-3623.36 3672.59,-3616.47"/>
</g>
<!-- layer_0_q_reshape_1_0 -->
<g id="node39" class="node">
<title>layer_0_q_reshape_1_0</title>
<polygon fill="lightblue" stroke="black" points="6026.5,-3944.5 5662.5,-3944.5 5662.5,-3876.5 6026.5,-3876.5 6026.5,-3944.5"/>
<text text-anchor="middle" x="5844.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Query</text>
<text text-anchor="middle" x="5844.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="5844.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="5844.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_0_q_proj_1_0&#45;&gt;layer_0_q_reshape_1_0 -->
<g id="edge46" class="edge">
<title>layer_0_q_proj_1_0&#45;&gt;layer_0_q_reshape_1_0</title>
<path fill="none" stroke="black" d="M5816.81,-3980.38C5820.18,-3972.01 5823.84,-3962.9 5827.36,-3954.13"/>
<polygon fill="black" stroke="black" points="5830.63,-3955.38 5831.11,-3944.8 5824.14,-3952.77 5830.63,-3955.38"/>
</g>
<!-- layer_0_k_reshape_1_0 -->
<g id="node40" class="node">
<title>layer_0_k_reshape_1_0</title>
<polygon fill="lightblue" stroke="black" points="6471.5,-3944.5 6107.5,-3944.5 6107.5,-3876.5 6471.5,-3876.5 6471.5,-3944.5"/>
<text text-anchor="middle" x="6289.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Key</text>
<text text-anchor="middle" x="6289.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="6289.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="6289.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_0_k_proj_1_0&#45;&gt;layer_0_k_reshape_1_0 -->
<g id="edge47" class="edge">
<title>layer_0_k_proj_1_0&#45;&gt;layer_0_k_reshape_1_0</title>
<path fill="none" stroke="black" d="M6275.32,-3980.38C6277.01,-3972.19 6278.84,-3963.29 6280.61,-3954.69"/>
<polygon fill="black" stroke="black" points="6284.06,-3955.3 6282.64,-3944.8 6277.2,-3953.89 6284.06,-3955.3"/>
</g>
<!-- layer_0_v_reshape_1_0 -->
<g id="node41" class="node">
<title>layer_0_v_reshape_1_0</title>
<polygon fill="lightblue" stroke="black" points="6894.5,-3944.5 6530.5,-3944.5 6530.5,-3876.5 6894.5,-3876.5 6894.5,-3944.5"/>
<text text-anchor="middle" x="6712.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Value</text>
<text text-anchor="middle" x="6712.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="6712.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="6712.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_0_v_proj_1_0&#45;&gt;layer_0_v_reshape_1_0 -->
<g id="edge48" class="edge">
<title>layer_0_v_proj_1_0&#45;&gt;layer_0_v_reshape_1_0</title>
<path fill="none" stroke="black" d="M6726.68,-3980.38C6724.99,-3972.19 6723.16,-3963.29 6721.39,-3954.69"/>
<polygon fill="black" stroke="black" points="6724.8,-3953.89 6719.36,-3944.8 6717.94,-3955.3 6724.8,-3953.89"/>
</g>
<!-- layer_0_attn_1_0 -->
<g id="node42" class="node">
<title>layer_0_attn_1_0</title>
<polygon fill="lightblue" stroke="black" points="6742.5,-3840.5 6260.5,-3840.5 6260.5,-3772.5 6742.5,-3772.5 6742.5,-3840.5"/>
<text text-anchor="middle" x="6501.5" y="-3825.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6501.5" y="-3810.3" font-family="Times,serif" font-size="14.00">Input: Q[128,10000,8,32], K[128,10000,8,32], V[128,10000,8,32]</text>
<text text-anchor="middle" x="6501.5" y="-3795.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="6501.5" y="-3780.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_0_q_reshape_1_0&#45;&gt;layer_0_attn_1_0 -->
<g id="edge49" class="edge">
<title>layer_0_q_reshape_1_0&#45;&gt;layer_0_attn_1_0</title>
<path fill="none" stroke="black" d="M6026.64,-3881.22C6104.73,-3869.1 6196.7,-3854.82 6278.79,-3842.08"/>
<polygon fill="black" stroke="black" points="6279.41,-3845.52 6288.75,-3840.53 6278.34,-3838.6 6279.41,-3845.52"/>
</g>
<!-- layer_0_k_reshape_1_0&#45;&gt;layer_0_attn_1_0 -->
<g id="edge50" class="edge">
<title>layer_0_k_reshape_1_0&#45;&gt;layer_0_attn_1_0</title>
<path fill="none" stroke="black" d="M6358.33,-3876.38C6379.17,-3866.36 6402.21,-3855.27 6423.6,-3844.98"/>
<polygon fill="black" stroke="black" points="6425.16,-3848.11 6432.65,-3840.62 6422.12,-3841.81 6425.16,-3848.11"/>
</g>
<!-- layer_0_v_reshape_1_0&#45;&gt;layer_0_attn_1_0 -->
<g id="edge51" class="edge">
<title>layer_0_v_reshape_1_0&#45;&gt;layer_0_attn_1_0</title>
<path fill="none" stroke="black" d="M6643.99,-3876.38C6623.25,-3866.36 6600.32,-3855.27 6579.04,-3844.98"/>
<polygon fill="black" stroke="black" points="6580.55,-3841.83 6570.02,-3840.62 6577.5,-3848.13 6580.55,-3841.83"/>
</g>
<!-- layer_0_attn_reshape_1_0 -->
<g id="node43" class="node">
<title>layer_0_attn_reshape_1_0</title>
<polygon fill="lightblue" stroke="black" points="6978,-3736.5 6623,-3736.5 6623,-3668.5 6978,-3668.5 6978,-3736.5"/>
<text text-anchor="middle" x="6800.5" y="-3721.3" font-family="Times,serif" font-size="14.00">Reshape Attention Output</text>
<text text-anchor="middle" x="6800.5" y="-3706.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="6800.5" y="-3691.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="6800.5" y="-3676.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_0_attn_1_0&#45;&gt;layer_0_attn_reshape_1_0 -->
<g id="edge52" class="edge">
<title>layer_0_attn_1_0&#45;&gt;layer_0_attn_reshape_1_0</title>
<path fill="none" stroke="black" d="M6598.58,-3772.38C6629.1,-3761.97 6662.96,-3750.42 6694.09,-3739.8"/>
<polygon fill="black" stroke="black" points="6695.32,-3743.08 6703.65,-3736.54 6693.06,-3736.45 6695.32,-3743.08"/>
</g>
<!-- layer_0_concat_intra_1 -->
<g id="node133" class="node">
<title>layer_0_concat_intra_1</title>
<ellipse fill="lightyellow" stroke="black" cx="9058.5" cy="-3584.42" rx="257.27" ry="48.17"/>
<text text-anchor="middle" x="9058.5" y="-3603.22" font-family="Times,serif" font-size="14.00">Intra&#45;Group Concatenation</text>
<text text-anchor="middle" x="9058.5" y="-3588.22" font-family="Times,serif" font-size="14.00">Input: 4×[batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="9058.5" y="-3573.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 1024]</text>
<text text-anchor="middle" x="9058.5" y="-3558.22" font-family="Times,serif" font-size="14.00">GPU: [4, 5, 6, 7]</text>
</g>
<!-- layer_0_attn_reshape_1_0&#45;&gt;layer_0_concat_intra_1 -->
<g id="edge167" class="edge">
<title>layer_0_attn_reshape_1_0&#45;&gt;layer_0_concat_intra_1</title>
<path fill="none" stroke="black" d="M6978.15,-3692.37C7375.69,-3671.93 8338.32,-3622.44 8801.33,-3598.64"/>
<polygon fill="black" stroke="black" points="8801.69,-3602.12 8811.5,-3598.11 8801.33,-3595.13 8801.69,-3602.12"/>
</g>
<!-- layer_0_q_reshape_1_1 -->
<g id="node47" class="node">
<title>layer_0_q_reshape_1_1</title>
<polygon fill="lightblue" stroke="black" points="7421.5,-3944.5 7057.5,-3944.5 7057.5,-3876.5 7421.5,-3876.5 7421.5,-3944.5"/>
<text text-anchor="middle" x="7239.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Query</text>
<text text-anchor="middle" x="7239.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="7239.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="7239.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_0_q_proj_1_1&#45;&gt;layer_0_q_reshape_1_1 -->
<g id="edge56" class="edge">
<title>layer_0_q_proj_1_1&#45;&gt;layer_0_q_reshape_1_1</title>
<path fill="none" stroke="black" d="M7211.81,-3980.38C7215.18,-3972.01 7218.84,-3962.9 7222.36,-3954.13"/>
<polygon fill="black" stroke="black" points="7225.63,-3955.38 7226.11,-3944.8 7219.14,-3952.77 7225.63,-3955.38"/>
</g>
<!-- layer_0_k_reshape_1_1 -->
<g id="node48" class="node">
<title>layer_0_k_reshape_1_1</title>
<polygon fill="lightblue" stroke="black" points="7866.5,-3944.5 7502.5,-3944.5 7502.5,-3876.5 7866.5,-3876.5 7866.5,-3944.5"/>
<text text-anchor="middle" x="7684.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Key</text>
<text text-anchor="middle" x="7684.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="7684.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="7684.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_0_k_proj_1_1&#45;&gt;layer_0_k_reshape_1_1 -->
<g id="edge57" class="edge">
<title>layer_0_k_proj_1_1&#45;&gt;layer_0_k_reshape_1_1</title>
<path fill="none" stroke="black" d="M7670.32,-3980.38C7672.01,-3972.19 7673.84,-3963.29 7675.61,-3954.69"/>
<polygon fill="black" stroke="black" points="7679.06,-3955.3 7677.64,-3944.8 7672.2,-3953.89 7679.06,-3955.3"/>
</g>
<!-- layer_0_v_reshape_1_1 -->
<g id="node49" class="node">
<title>layer_0_v_reshape_1_1</title>
<polygon fill="lightblue" stroke="black" points="8269.5,-3944.5 7905.5,-3944.5 7905.5,-3876.5 8269.5,-3876.5 8269.5,-3944.5"/>
<text text-anchor="middle" x="8087.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Value</text>
<text text-anchor="middle" x="8087.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="8087.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="8087.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_0_v_proj_1_1&#45;&gt;layer_0_v_reshape_1_1 -->
<g id="edge58" class="edge">
<title>layer_0_v_proj_1_1&#45;&gt;layer_0_v_reshape_1_1</title>
<path fill="none" stroke="black" d="M8115.19,-3980.38C8111.82,-3972.01 8108.16,-3962.9 8104.64,-3954.13"/>
<polygon fill="black" stroke="black" points="8107.86,-3952.77 8100.89,-3944.8 8101.37,-3955.38 8107.86,-3952.77"/>
</g>
<!-- layer_0_attn_1_1 -->
<g id="node50" class="node">
<title>layer_0_attn_1_1</title>
<polygon fill="lightblue" stroke="black" points="8137.5,-3840.5 7655.5,-3840.5 7655.5,-3772.5 8137.5,-3772.5 8137.5,-3840.5"/>
<text text-anchor="middle" x="7896.5" y="-3825.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7896.5" y="-3810.3" font-family="Times,serif" font-size="14.00">Input: Q[128,10000,8,32], K[128,10000,8,32], V[128,10000,8,32]</text>
<text text-anchor="middle" x="7896.5" y="-3795.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="7896.5" y="-3780.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_0_q_reshape_1_1&#45;&gt;layer_0_attn_1_1 -->
<g id="edge59" class="edge">
<title>layer_0_q_reshape_1_1&#45;&gt;layer_0_attn_1_1</title>
<path fill="none" stroke="black" d="M7421.64,-3881.22C7499.73,-3869.1 7591.7,-3854.82 7673.79,-3842.08"/>
<polygon fill="black" stroke="black" points="7674.41,-3845.52 7683.75,-3840.53 7673.34,-3838.6 7674.41,-3845.52"/>
</g>
<!-- layer_0_k_reshape_1_1&#45;&gt;layer_0_attn_1_1 -->
<g id="edge60" class="edge">
<title>layer_0_k_reshape_1_1&#45;&gt;layer_0_attn_1_1</title>
<path fill="none" stroke="black" d="M7753.33,-3876.38C7774.17,-3866.36 7797.21,-3855.27 7818.6,-3844.98"/>
<polygon fill="black" stroke="black" points="7820.16,-3848.11 7827.65,-3840.62 7817.12,-3841.81 7820.16,-3848.11"/>
</g>
<!-- layer_0_v_reshape_1_1&#45;&gt;layer_0_attn_1_1 -->
<g id="edge61" class="edge">
<title>layer_0_v_reshape_1_1&#45;&gt;layer_0_attn_1_1</title>
<path fill="none" stroke="black" d="M8025.49,-3876.38C8006.96,-3866.49 7986.51,-3855.57 7967.46,-3845.4"/>
<polygon fill="black" stroke="black" points="7969,-3842.25 7958.53,-3840.62 7965.7,-3848.42 7969,-3842.25"/>
</g>
<!-- layer_0_attn_reshape_1_1 -->
<g id="node51" class="node">
<title>layer_0_attn_reshape_1_1</title>
<polygon fill="lightblue" stroke="black" points="8585,-3736.5 8230,-3736.5 8230,-3668.5 8585,-3668.5 8585,-3736.5"/>
<text text-anchor="middle" x="8407.5" y="-3721.3" font-family="Times,serif" font-size="14.00">Reshape Attention Output</text>
<text text-anchor="middle" x="8407.5" y="-3706.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="8407.5" y="-3691.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="8407.5" y="-3676.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_0_attn_1_1&#45;&gt;layer_0_attn_reshape_1_1 -->
<g id="edge62" class="edge">
<title>layer_0_attn_1_1&#45;&gt;layer_0_attn_reshape_1_1</title>
<path fill="none" stroke="black" d="M8062.05,-3772.45C8116.37,-3761.61 8176.89,-3749.53 8231.92,-3738.55"/>
<polygon fill="black" stroke="black" points="8232.65,-3741.97 8241.77,-3736.58 8231.28,-3735.11 8232.65,-3741.97"/>
</g>
<!-- layer_0_attn_reshape_1_1&#45;&gt;layer_0_concat_intra_1 -->
<g id="edge168" class="edge">
<title>layer_0_attn_reshape_1_1&#45;&gt;layer_0_concat_intra_1</title>
<path fill="none" stroke="black" d="M8585.39,-3669.78C8672.02,-3654.33 8776.35,-3635.73 8864.97,-3619.93"/>
<polygon fill="black" stroke="black" points="8865.64,-3623.36 8874.87,-3618.16 8864.41,-3616.47 8865.64,-3623.36"/>
</g>
<!-- layer_0_q_reshape_1_2 -->
<g id="node55" class="node">
<title>layer_0_q_reshape_1_2</title>
<polygon fill="lightblue" stroke="black" points="8816.5,-3944.5 8452.5,-3944.5 8452.5,-3876.5 8816.5,-3876.5 8816.5,-3944.5"/>
<text text-anchor="middle" x="8634.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Query</text>
<text text-anchor="middle" x="8634.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="8634.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="8634.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_0_q_proj_1_2&#45;&gt;layer_0_q_reshape_1_2 -->
<g id="edge66" class="edge">
<title>layer_0_q_proj_1_2&#45;&gt;layer_0_q_reshape_1_2</title>
<path fill="none" stroke="black" d="M8606.81,-3980.38C8610.18,-3972.01 8613.84,-3962.9 8617.36,-3954.13"/>
<polygon fill="black" stroke="black" points="8620.63,-3955.38 8621.11,-3944.8 8614.14,-3952.77 8620.63,-3955.38"/>
</g>
<!-- layer_0_k_reshape_1_2 -->
<g id="node56" class="node">
<title>layer_0_k_reshape_1_2</title>
<polygon fill="lightblue" stroke="black" points="9240.5,-3944.5 8876.5,-3944.5 8876.5,-3876.5 9240.5,-3876.5 9240.5,-3944.5"/>
<text text-anchor="middle" x="9058.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Key</text>
<text text-anchor="middle" x="9058.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="9058.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="9058.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_0_k_proj_1_2&#45;&gt;layer_0_k_reshape_1_2 -->
<g id="edge67" class="edge">
<title>layer_0_k_proj_1_2&#45;&gt;layer_0_k_reshape_1_2</title>
<path fill="none" stroke="black" d="M9058.5,-3980.38C9058.5,-3972.28 9058.5,-3963.48 9058.5,-3954.97"/>
<polygon fill="black" stroke="black" points="9062,-3954.8 9058.5,-3944.8 9055,-3954.8 9062,-3954.8"/>
</g>
<!-- layer_0_v_reshape_1_2 -->
<g id="node57" class="node">
<title>layer_0_v_reshape_1_2</title>
<polygon fill="lightblue" stroke="black" points="9664.5,-3944.5 9300.5,-3944.5 9300.5,-3876.5 9664.5,-3876.5 9664.5,-3944.5"/>
<text text-anchor="middle" x="9482.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Value</text>
<text text-anchor="middle" x="9482.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="9482.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="9482.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_0_v_proj_1_2&#45;&gt;layer_0_v_reshape_1_2 -->
<g id="edge68" class="edge">
<title>layer_0_v_proj_1_2&#45;&gt;layer_0_v_reshape_1_2</title>
<path fill="none" stroke="black" d="M9510.19,-3980.38C9506.82,-3972.01 9503.16,-3962.9 9499.64,-3954.13"/>
<polygon fill="black" stroke="black" points="9502.86,-3952.77 9495.89,-3944.8 9496.37,-3955.38 9502.86,-3952.77"/>
</g>
<!-- layer_0_attn_1_2 -->
<g id="node58" class="node">
<title>layer_0_attn_1_2</title>
<polygon fill="lightblue" stroke="black" points="9299.5,-3840.5 8817.5,-3840.5 8817.5,-3772.5 9299.5,-3772.5 9299.5,-3840.5"/>
<text text-anchor="middle" x="9058.5" y="-3825.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9058.5" y="-3810.3" font-family="Times,serif" font-size="14.00">Input: Q[128,10000,8,32], K[128,10000,8,32], V[128,10000,8,32]</text>
<text text-anchor="middle" x="9058.5" y="-3795.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="9058.5" y="-3780.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_0_q_reshape_1_2&#45;&gt;layer_0_attn_1_2 -->
<g id="edge69" class="edge">
<title>layer_0_q_reshape_1_2&#45;&gt;layer_0_attn_1_2</title>
<path fill="none" stroke="black" d="M8771.87,-3876.45C8816.37,-3865.75 8865.91,-3853.83 8911.11,-3842.96"/>
<polygon fill="black" stroke="black" points="8912.08,-3846.32 8920.99,-3840.58 8910.45,-3839.52 8912.08,-3846.32"/>
</g>
<!-- layer_0_k_reshape_1_2&#45;&gt;layer_0_attn_1_2 -->
<g id="edge70" class="edge">
<title>layer_0_k_reshape_1_2&#45;&gt;layer_0_attn_1_2</title>
<path fill="none" stroke="black" d="M9058.5,-3876.38C9058.5,-3868.28 9058.5,-3859.48 9058.5,-3850.97"/>
<polygon fill="black" stroke="black" points="9062,-3850.8 9058.5,-3840.8 9055,-3850.8 9062,-3850.8"/>
</g>
<!-- layer_0_v_reshape_1_2&#45;&gt;layer_0_attn_1_2 -->
<g id="edge71" class="edge">
<title>layer_0_v_reshape_1_2&#45;&gt;layer_0_attn_1_2</title>
<path fill="none" stroke="black" d="M9345.13,-3876.45C9300.63,-3865.75 9251.09,-3853.83 9205.89,-3842.96"/>
<polygon fill="black" stroke="black" points="9206.55,-3839.52 9196.01,-3840.58 9204.92,-3846.32 9206.55,-3839.52"/>
</g>
<!-- layer_0_attn_reshape_1_2 -->
<g id="node59" class="node">
<title>layer_0_attn_reshape_1_2</title>
<polygon fill="lightblue" stroke="black" points="9236,-3736.5 8881,-3736.5 8881,-3668.5 9236,-3668.5 9236,-3736.5"/>
<text text-anchor="middle" x="9058.5" y="-3721.3" font-family="Times,serif" font-size="14.00">Reshape Attention Output</text>
<text text-anchor="middle" x="9058.5" y="-3706.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="9058.5" y="-3691.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="9058.5" y="-3676.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_0_attn_1_2&#45;&gt;layer_0_attn_reshape_1_2 -->
<g id="edge72" class="edge">
<title>layer_0_attn_1_2&#45;&gt;layer_0_attn_reshape_1_2</title>
<path fill="none" stroke="black" d="M9058.5,-3772.38C9058.5,-3764.28 9058.5,-3755.48 9058.5,-3746.97"/>
<polygon fill="black" stroke="black" points="9062,-3746.8 9058.5,-3736.8 9055,-3746.8 9062,-3746.8"/>
</g>
<!-- layer_0_attn_reshape_1_2&#45;&gt;layer_0_concat_intra_1 -->
<g id="edge169" class="edge">
<title>layer_0_attn_reshape_1_2&#45;&gt;layer_0_concat_intra_1</title>
<path fill="none" stroke="black" d="M9058.5,-3668.23C9058.5,-3660.24 9058.5,-3651.48 9058.5,-3642.73"/>
<polygon fill="black" stroke="black" points="9062,-3642.53 9058.5,-3632.53 9055,-3642.53 9062,-3642.53"/>
</g>
<!-- layer_0_q_reshape_1_3 -->
<g id="node63" class="node">
<title>layer_0_q_reshape_1_3</title>
<polygon fill="lightblue" stroke="black" points="10191.5,-3944.5 9827.5,-3944.5 9827.5,-3876.5 10191.5,-3876.5 10191.5,-3944.5"/>
<text text-anchor="middle" x="10009.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Query</text>
<text text-anchor="middle" x="10009.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="10009.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="10009.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_0_q_proj_1_3&#45;&gt;layer_0_q_reshape_1_3 -->
<g id="edge76" class="edge">
<title>layer_0_q_proj_1_3&#45;&gt;layer_0_q_reshape_1_3</title>
<path fill="none" stroke="black" d="M9995.32,-3980.38C9997.01,-3972.19 9998.84,-3963.29 10000.61,-3954.69"/>
<polygon fill="black" stroke="black" points="10004.06,-3955.3 10002.64,-3944.8 9997.2,-3953.89 10004.06,-3955.3"/>
</g>
<!-- layer_0_k_reshape_1_3 -->
<g id="node64" class="node">
<title>layer_0_k_reshape_1_3</title>
<polygon fill="lightblue" stroke="black" points="10594.5,-3944.5 10230.5,-3944.5 10230.5,-3876.5 10594.5,-3876.5 10594.5,-3944.5"/>
<text text-anchor="middle" x="10412.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Key</text>
<text text-anchor="middle" x="10412.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="10412.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="10412.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_0_k_proj_1_3&#45;&gt;layer_0_k_reshape_1_3 -->
<g id="edge77" class="edge">
<title>layer_0_k_proj_1_3&#45;&gt;layer_0_k_reshape_1_3</title>
<path fill="none" stroke="black" d="M10440.19,-3980.38C10436.82,-3972.01 10433.16,-3962.9 10429.64,-3954.13"/>
<polygon fill="black" stroke="black" points="10432.86,-3952.77 10425.89,-3944.8 10426.37,-3955.38 10432.86,-3952.77"/>
</g>
<!-- layer_0_v_reshape_1_3 -->
<g id="node65" class="node">
<title>layer_0_v_reshape_1_3</title>
<polygon fill="lightblue" stroke="black" points="11038.5,-3944.5 10674.5,-3944.5 10674.5,-3876.5 11038.5,-3876.5 11038.5,-3944.5"/>
<text text-anchor="middle" x="10856.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Value</text>
<text text-anchor="middle" x="10856.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="10856.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="10856.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_0_v_proj_1_3&#45;&gt;layer_0_v_reshape_1_3 -->
<g id="edge78" class="edge">
<title>layer_0_v_proj_1_3&#45;&gt;layer_0_v_reshape_1_3</title>
<path fill="none" stroke="black" d="M10898.37,-3980.38C10893.17,-3971.83 10887.51,-3962.51 10882.07,-3953.57"/>
<polygon fill="black" stroke="black" points="10884.93,-3951.53 10876.74,-3944.8 10878.94,-3955.16 10884.93,-3951.53"/>
</g>
<!-- layer_0_attn_1_3 -->
<g id="node66" class="node">
<title>layer_0_attn_1_3</title>
<polygon fill="lightblue" stroke="black" points="10462.5,-3840.5 9980.5,-3840.5 9980.5,-3772.5 10462.5,-3772.5 10462.5,-3840.5"/>
<text text-anchor="middle" x="10221.5" y="-3825.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="10221.5" y="-3810.3" font-family="Times,serif" font-size="14.00">Input: Q[128,10000,8,32], K[128,10000,8,32], V[128,10000,8,32]</text>
<text text-anchor="middle" x="10221.5" y="-3795.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="10221.5" y="-3780.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_0_q_reshape_1_3&#45;&gt;layer_0_attn_1_3 -->
<g id="edge79" class="edge">
<title>layer_0_q_reshape_1_3&#45;&gt;layer_0_attn_1_3</title>
<path fill="none" stroke="black" d="M10078.33,-3876.38C10099.17,-3866.36 10122.21,-3855.27 10143.6,-3844.98"/>
<polygon fill="black" stroke="black" points="10145.16,-3848.11 10152.65,-3840.62 10142.12,-3841.81 10145.16,-3848.11"/>
</g>
<!-- layer_0_k_reshape_1_3&#45;&gt;layer_0_attn_1_3 -->
<g id="edge80" class="edge">
<title>layer_0_k_reshape_1_3&#45;&gt;layer_0_attn_1_3</title>
<path fill="none" stroke="black" d="M10350.49,-3876.38C10331.96,-3866.49 10311.51,-3855.57 10292.46,-3845.4"/>
<polygon fill="black" stroke="black" points="10294,-3842.25 10283.53,-3840.62 10290.7,-3848.42 10294,-3842.25"/>
</g>
<!-- layer_0_v_reshape_1_3&#45;&gt;layer_0_attn_1_3 -->
<g id="edge81" class="edge">
<title>layer_0_v_reshape_1_3&#45;&gt;layer_0_attn_1_3</title>
<path fill="none" stroke="black" d="M10674.11,-3880.2C10600.2,-3868.33 10514.28,-3854.53 10437.29,-3842.16"/>
<polygon fill="black" stroke="black" points="10437.4,-3838.64 10426.98,-3840.51 10436.29,-3845.55 10437.4,-3838.64"/>
</g>
<!-- layer_0_attn_reshape_1_3 -->
<g id="node67" class="node">
<title>layer_0_attn_reshape_1_3</title>
<polygon fill="lightblue" stroke="black" points="10121,-3736.5 9766,-3736.5 9766,-3668.5 10121,-3668.5 10121,-3736.5"/>
<text text-anchor="middle" x="9943.5" y="-3721.3" font-family="Times,serif" font-size="14.00">Reshape Attention Output</text>
<text text-anchor="middle" x="9943.5" y="-3706.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="9943.5" y="-3691.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="9943.5" y="-3676.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_0_attn_1_3&#45;&gt;layer_0_attn_reshape_1_3 -->
<g id="edge82" class="edge">
<title>layer_0_attn_1_3&#45;&gt;layer_0_attn_reshape_1_3</title>
<path fill="none" stroke="black" d="M10131.24,-3772.38C10103.18,-3762.09 10072.09,-3750.68 10043.41,-3740.16"/>
<polygon fill="black" stroke="black" points="10044.37,-3736.78 10033.78,-3736.62 10041.96,-3743.35 10044.37,-3736.78"/>
</g>
<!-- layer_0_attn_reshape_1_3&#45;&gt;layer_0_concat_intra_1 -->
<g id="edge170" class="edge">
<title>layer_0_attn_reshape_1_3&#45;&gt;layer_0_concat_intra_1</title>
<path fill="none" stroke="black" d="M9765.74,-3678.18C9624.89,-3659.71 9427.45,-3633.81 9276.97,-3614.07"/>
<polygon fill="black" stroke="black" points="9277.04,-3610.55 9266.67,-3612.72 9276.13,-3617.49 9277.04,-3610.55"/>
</g>
<!-- layer_0_q_reshape_2_0 -->
<g id="node71" class="node">
<title>layer_0_q_reshape_2_0</title>
<polygon fill="lightblue" stroke="black" points="11606.5,-3944.5 11242.5,-3944.5 11242.5,-3876.5 11606.5,-3876.5 11606.5,-3944.5"/>
<text text-anchor="middle" x="11424.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Query</text>
<text text-anchor="middle" x="11424.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="11424.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="11424.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_0_q_proj_2_0&#45;&gt;layer_0_q_reshape_2_0 -->
<g id="edge86" class="edge">
<title>layer_0_q_proj_2_0&#45;&gt;layer_0_q_reshape_2_0</title>
<path fill="none" stroke="black" d="M11396.81,-3980.38C11400.18,-3972.01 11403.84,-3962.9 11407.36,-3954.13"/>
<polygon fill="black" stroke="black" points="11410.63,-3955.38 11411.11,-3944.8 11404.14,-3952.77 11410.63,-3955.38"/>
</g>
<!-- layer_0_k_reshape_2_0 -->
<g id="node72" class="node">
<title>layer_0_k_reshape_2_0</title>
<polygon fill="lightblue" stroke="black" points="12051.5,-3944.5 11687.5,-3944.5 11687.5,-3876.5 12051.5,-3876.5 12051.5,-3944.5"/>
<text text-anchor="middle" x="11869.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Key</text>
<text text-anchor="middle" x="11869.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="11869.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="11869.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_0_k_proj_2_0&#45;&gt;layer_0_k_reshape_2_0 -->
<g id="edge87" class="edge">
<title>layer_0_k_proj_2_0&#45;&gt;layer_0_k_reshape_2_0</title>
<path fill="none" stroke="black" d="M11855.32,-3980.38C11857.01,-3972.19 11858.84,-3963.29 11860.61,-3954.69"/>
<polygon fill="black" stroke="black" points="11864.06,-3955.3 11862.64,-3944.8 11857.2,-3953.89 11864.06,-3955.3"/>
</g>
<!-- layer_0_v_reshape_2_0 -->
<g id="node73" class="node">
<title>layer_0_v_reshape_2_0</title>
<polygon fill="lightblue" stroke="black" points="12454.5,-3944.5 12090.5,-3944.5 12090.5,-3876.5 12454.5,-3876.5 12454.5,-3944.5"/>
<text text-anchor="middle" x="12272.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Value</text>
<text text-anchor="middle" x="12272.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="12272.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="12272.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_0_v_proj_2_0&#45;&gt;layer_0_v_reshape_2_0 -->
<g id="edge88" class="edge">
<title>layer_0_v_proj_2_0&#45;&gt;layer_0_v_reshape_2_0</title>
<path fill="none" stroke="black" d="M12300.19,-3980.38C12296.82,-3972.01 12293.16,-3962.9 12289.64,-3954.13"/>
<polygon fill="black" stroke="black" points="12292.86,-3952.77 12285.89,-3944.8 12286.37,-3955.38 12292.86,-3952.77"/>
</g>
<!-- layer_0_attn_2_0 -->
<g id="node74" class="node">
<title>layer_0_attn_2_0</title>
<polygon fill="lightblue" stroke="black" points="12322.5,-3840.5 11840.5,-3840.5 11840.5,-3772.5 12322.5,-3772.5 12322.5,-3840.5"/>
<text text-anchor="middle" x="12081.5" y="-3825.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="12081.5" y="-3810.3" font-family="Times,serif" font-size="14.00">Input: Q[128,10000,8,32], K[128,10000,8,32], V[128,10000,8,32]</text>
<text text-anchor="middle" x="12081.5" y="-3795.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="12081.5" y="-3780.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_0_q_reshape_2_0&#45;&gt;layer_0_attn_2_0 -->
<g id="edge89" class="edge">
<title>layer_0_q_reshape_2_0&#45;&gt;layer_0_attn_2_0</title>
<path fill="none" stroke="black" d="M11606.64,-3881.22C11684.73,-3869.1 11776.7,-3854.82 11858.79,-3842.08"/>
<polygon fill="black" stroke="black" points="11859.41,-3845.52 11868.75,-3840.53 11858.34,-3838.6 11859.41,-3845.52"/>
</g>
<!-- layer_0_k_reshape_2_0&#45;&gt;layer_0_attn_2_0 -->
<g id="edge90" class="edge">
<title>layer_0_k_reshape_2_0&#45;&gt;layer_0_attn_2_0</title>
<path fill="none" stroke="black" d="M11938.33,-3876.38C11959.17,-3866.36 11982.21,-3855.27 12003.6,-3844.98"/>
<polygon fill="black" stroke="black" points="12005.16,-3848.11 12012.65,-3840.62 12002.12,-3841.81 12005.16,-3848.11"/>
</g>
<!-- layer_0_v_reshape_2_0&#45;&gt;layer_0_attn_2_0 -->
<g id="edge91" class="edge">
<title>layer_0_v_reshape_2_0&#45;&gt;layer_0_attn_2_0</title>
<path fill="none" stroke="black" d="M12210.49,-3876.38C12191.96,-3866.49 12171.51,-3855.57 12152.46,-3845.4"/>
<polygon fill="black" stroke="black" points="12154,-3842.25 12143.53,-3840.62 12150.7,-3848.42 12154,-3842.25"/>
</g>
<!-- layer_0_attn_reshape_2_0 -->
<g id="node75" class="node">
<title>layer_0_attn_reshape_2_0</title>
<polygon fill="lightblue" stroke="black" points="12770,-3736.5 12415,-3736.5 12415,-3668.5 12770,-3668.5 12770,-3736.5"/>
<text text-anchor="middle" x="12592.5" y="-3721.3" font-family="Times,serif" font-size="14.00">Reshape Attention Output</text>
<text text-anchor="middle" x="12592.5" y="-3706.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="12592.5" y="-3691.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="12592.5" y="-3676.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_0_attn_2_0&#45;&gt;layer_0_attn_reshape_2_0 -->
<g id="edge92" class="edge">
<title>layer_0_attn_2_0&#45;&gt;layer_0_attn_reshape_2_0</title>
<path fill="none" stroke="black" d="M12247.05,-3772.45C12301.37,-3761.61 12361.89,-3749.53 12416.92,-3738.55"/>
<polygon fill="black" stroke="black" points="12417.65,-3741.97 12426.77,-3736.58 12416.28,-3735.11 12417.65,-3741.97"/>
</g>
<!-- layer_0_concat_intra_2 -->
<g id="node134" class="node">
<title>layer_0_concat_intra_2</title>
<ellipse fill="lightyellow" stroke="black" cx="13632.5" cy="-3584.42" rx="257.27" ry="48.17"/>
<text text-anchor="middle" x="13632.5" y="-3603.22" font-family="Times,serif" font-size="14.00">Intra&#45;Group Concatenation</text>
<text text-anchor="middle" x="13632.5" y="-3588.22" font-family="Times,serif" font-size="14.00">Input: 4×[batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="13632.5" y="-3573.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 1024]</text>
<text text-anchor="middle" x="13632.5" y="-3558.22" font-family="Times,serif" font-size="14.00">GPU: [8, 9, 10, 11]</text>
</g>
<!-- layer_0_attn_reshape_2_0&#45;&gt;layer_0_concat_intra_2 -->
<g id="edge171" class="edge">
<title>layer_0_attn_reshape_2_0&#45;&gt;layer_0_concat_intra_2</title>
<path fill="none" stroke="black" d="M12770.1,-3681.68C12944.93,-3662.16 13212.72,-3632.27 13403.48,-3610.98"/>
<polygon fill="black" stroke="black" points="13404.09,-3614.43 13413.64,-3609.85 13403.31,-3607.48 13404.09,-3614.43"/>
</g>
<!-- layer_0_q_reshape_2_1 -->
<g id="node79" class="node">
<title>layer_0_q_reshape_2_1</title>
<polygon fill="lightblue" stroke="black" points="13001.5,-3944.5 12637.5,-3944.5 12637.5,-3876.5 13001.5,-3876.5 13001.5,-3944.5"/>
<text text-anchor="middle" x="12819.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Query</text>
<text text-anchor="middle" x="12819.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="12819.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="12819.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_0_q_proj_2_1&#45;&gt;layer_0_q_reshape_2_1 -->
<g id="edge96" class="edge">
<title>layer_0_q_proj_2_1&#45;&gt;layer_0_q_reshape_2_1</title>
<path fill="none" stroke="black" d="M12791.81,-3980.38C12795.18,-3972.01 12798.84,-3962.9 12802.36,-3954.13"/>
<polygon fill="black" stroke="black" points="12805.63,-3955.38 12806.11,-3944.8 12799.14,-3952.77 12805.63,-3955.38"/>
</g>
<!-- layer_0_k_reshape_2_1 -->
<g id="node80" class="node">
<title>layer_0_k_reshape_2_1</title>
<polygon fill="lightblue" stroke="black" points="13446.5,-3944.5 13082.5,-3944.5 13082.5,-3876.5 13446.5,-3876.5 13446.5,-3944.5"/>
<text text-anchor="middle" x="13264.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Key</text>
<text text-anchor="middle" x="13264.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="13264.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="13264.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_0_k_proj_2_1&#45;&gt;layer_0_k_reshape_2_1 -->
<g id="edge97" class="edge">
<title>layer_0_k_proj_2_1&#45;&gt;layer_0_k_reshape_2_1</title>
<path fill="none" stroke="black" d="M13250.32,-3980.38C13252.01,-3972.19 13253.84,-3963.29 13255.61,-3954.69"/>
<polygon fill="black" stroke="black" points="13259.06,-3955.3 13257.64,-3944.8 13252.2,-3953.89 13259.06,-3955.3"/>
</g>
<!-- layer_0_v_reshape_2_1 -->
<g id="node81" class="node">
<title>layer_0_v_reshape_2_1</title>
<polygon fill="lightblue" stroke="black" points="13849.5,-3944.5 13485.5,-3944.5 13485.5,-3876.5 13849.5,-3876.5 13849.5,-3944.5"/>
<text text-anchor="middle" x="13667.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Value</text>
<text text-anchor="middle" x="13667.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="13667.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="13667.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_0_v_proj_2_1&#45;&gt;layer_0_v_reshape_2_1 -->
<g id="edge98" class="edge">
<title>layer_0_v_proj_2_1&#45;&gt;layer_0_v_reshape_2_1</title>
<path fill="none" stroke="black" d="M13695.19,-3980.38C13691.82,-3972.01 13688.16,-3962.9 13684.64,-3954.13"/>
<polygon fill="black" stroke="black" points="13687.86,-3952.77 13680.89,-3944.8 13681.37,-3955.38 13687.86,-3952.77"/>
</g>
<!-- layer_0_attn_2_1 -->
<g id="node82" class="node">
<title>layer_0_attn_2_1</title>
<polygon fill="lightblue" stroke="black" points="13613.5,-3840.5 13131.5,-3840.5 13131.5,-3772.5 13613.5,-3772.5 13613.5,-3840.5"/>
<text text-anchor="middle" x="13372.5" y="-3825.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="13372.5" y="-3810.3" font-family="Times,serif" font-size="14.00">Input: Q[128,10000,8,32], K[128,10000,8,32], V[128,10000,8,32]</text>
<text text-anchor="middle" x="13372.5" y="-3795.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="13372.5" y="-3780.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_0_q_reshape_2_1&#45;&gt;layer_0_attn_2_1 -->
<g id="edge99" class="edge">
<title>layer_0_q_reshape_2_1&#45;&gt;layer_0_attn_2_1</title>
<path fill="none" stroke="black" d="M12998.66,-3876.45C13057.68,-3865.57 13123.48,-3853.43 13183.23,-3842.41"/>
<polygon fill="black" stroke="black" points="13183.95,-3845.84 13193.15,-3840.58 13182.68,-3838.95 13183.95,-3845.84"/>
</g>
<!-- layer_0_k_reshape_2_1&#45;&gt;layer_0_attn_2_1 -->
<g id="edge100" class="edge">
<title>layer_0_k_reshape_2_1&#45;&gt;layer_0_attn_2_1</title>
<path fill="none" stroke="black" d="M13299.56,-3876.38C13309.18,-3867.3 13319.72,-3857.35 13329.72,-3847.9"/>
<polygon fill="black" stroke="black" points="13332.37,-3850.21 13337.24,-3840.8 13327.57,-3845.12 13332.37,-3850.21"/>
</g>
<!-- layer_0_v_reshape_2_1&#45;&gt;layer_0_attn_2_1 -->
<g id="edge101" class="edge">
<title>layer_0_v_reshape_2_1&#45;&gt;layer_0_attn_2_1</title>
<path fill="none" stroke="black" d="M13571.72,-3876.38C13541.74,-3866.02 13508.49,-3854.52 13477.89,-3843.94"/>
<polygon fill="black" stroke="black" points="13478.64,-3840.5 13468.05,-3840.54 13476.36,-3847.11 13478.64,-3840.5"/>
</g>
<!-- layer_0_attn_reshape_2_1 -->
<g id="node83" class="node">
<title>layer_0_attn_reshape_2_1</title>
<polygon fill="lightblue" stroke="black" points="13766,-3736.5 13411,-3736.5 13411,-3668.5 13766,-3668.5 13766,-3736.5"/>
<text text-anchor="middle" x="13588.5" y="-3721.3" font-family="Times,serif" font-size="14.00">Reshape Attention Output</text>
<text text-anchor="middle" x="13588.5" y="-3706.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="13588.5" y="-3691.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="13588.5" y="-3676.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_0_attn_2_1&#45;&gt;layer_0_attn_reshape_2_1 -->
<g id="edge102" class="edge">
<title>layer_0_attn_2_1&#45;&gt;layer_0_attn_reshape_2_1</title>
<path fill="none" stroke="black" d="M13442.63,-3772.38C13463.86,-3762.36 13487.33,-3751.27 13509.13,-3740.98"/>
<polygon fill="black" stroke="black" points="13510.81,-3744.06 13518.35,-3736.62 13507.82,-3737.73 13510.81,-3744.06"/>
</g>
<!-- layer_0_attn_reshape_2_1&#45;&gt;layer_0_concat_intra_2 -->
<g id="edge172" class="edge">
<title>layer_0_attn_reshape_2_1&#45;&gt;layer_0_concat_intra_2</title>
<path fill="none" stroke="black" d="M13601.11,-3668.23C13604.24,-3659.98 13607.68,-3650.9 13611.1,-3641.88"/>
<polygon fill="black" stroke="black" points="13614.37,-3643.12 13614.64,-3632.53 13607.83,-3640.64 13614.37,-3643.12"/>
</g>
<!-- layer_0_q_reshape_2_2 -->
<g id="node87" class="node">
<title>layer_0_q_reshape_2_2</title>
<polygon fill="lightblue" stroke="black" points="14376.5,-3944.5 14012.5,-3944.5 14012.5,-3876.5 14376.5,-3876.5 14376.5,-3944.5"/>
<text text-anchor="middle" x="14194.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Query</text>
<text text-anchor="middle" x="14194.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="14194.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="14194.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_0_q_proj_2_2&#45;&gt;layer_0_q_reshape_2_2 -->
<g id="edge106" class="edge">
<title>layer_0_q_proj_2_2&#45;&gt;layer_0_q_reshape_2_2</title>
<path fill="none" stroke="black" d="M14180.32,-3980.38C14182.01,-3972.19 14183.84,-3963.29 14185.61,-3954.69"/>
<polygon fill="black" stroke="black" points="14189.06,-3955.3 14187.64,-3944.8 14182.2,-3953.89 14189.06,-3955.3"/>
</g>
<!-- layer_0_k_reshape_2_2 -->
<g id="node88" class="node">
<title>layer_0_k_reshape_2_2</title>
<polygon fill="lightblue" stroke="black" points="14779.5,-3944.5 14415.5,-3944.5 14415.5,-3876.5 14779.5,-3876.5 14779.5,-3944.5"/>
<text text-anchor="middle" x="14597.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Key</text>
<text text-anchor="middle" x="14597.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="14597.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="14597.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_0_k_proj_2_2&#45;&gt;layer_0_k_reshape_2_2 -->
<g id="edge107" class="edge">
<title>layer_0_k_proj_2_2&#45;&gt;layer_0_k_reshape_2_2</title>
<path fill="none" stroke="black" d="M14625.19,-3980.38C14621.82,-3972.01 14618.16,-3962.9 14614.64,-3954.13"/>
<polygon fill="black" stroke="black" points="14617.86,-3952.77 14610.89,-3944.8 14611.37,-3955.38 14617.86,-3952.77"/>
</g>
<!-- layer_0_v_reshape_2_2 -->
<g id="node89" class="node">
<title>layer_0_v_reshape_2_2</title>
<polygon fill="lightblue" stroke="black" points="15223.5,-3944.5 14859.5,-3944.5 14859.5,-3876.5 15223.5,-3876.5 15223.5,-3944.5"/>
<text text-anchor="middle" x="15041.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Value</text>
<text text-anchor="middle" x="15041.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="15041.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="15041.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_0_v_proj_2_2&#45;&gt;layer_0_v_reshape_2_2 -->
<g id="edge108" class="edge">
<title>layer_0_v_proj_2_2&#45;&gt;layer_0_v_reshape_2_2</title>
<path fill="none" stroke="black" d="M15083.37,-3980.38C15078.17,-3971.83 15072.51,-3962.51 15067.07,-3953.57"/>
<polygon fill="black" stroke="black" points="15069.93,-3951.53 15061.74,-3944.8 15063.94,-3955.16 15069.93,-3951.53"/>
</g>
<!-- layer_0_attn_2_2 -->
<g id="node90" class="node">
<title>layer_0_attn_2_2</title>
<polygon fill="lightblue" stroke="black" points="14795.5,-3840.5 14313.5,-3840.5 14313.5,-3772.5 14795.5,-3772.5 14795.5,-3840.5"/>
<text text-anchor="middle" x="14554.5" y="-3825.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="14554.5" y="-3810.3" font-family="Times,serif" font-size="14.00">Input: Q[128,10000,8,32], K[128,10000,8,32], V[128,10000,8,32]</text>
<text text-anchor="middle" x="14554.5" y="-3795.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="14554.5" y="-3780.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_0_q_reshape_2_2&#45;&gt;layer_0_attn_2_2 -->
<g id="edge109" class="edge">
<title>layer_0_q_reshape_2_2&#45;&gt;layer_0_attn_2_2</title>
<path fill="none" stroke="black" d="M14311.38,-3876.38C14348.6,-3865.84 14389.95,-3854.12 14427.83,-3843.39"/>
<polygon fill="black" stroke="black" points="14429.23,-3846.63 14437.9,-3840.54 14427.32,-3839.9 14429.23,-3846.63"/>
</g>
<!-- layer_0_k_reshape_2_2&#45;&gt;layer_0_attn_2_2 -->
<g id="edge110" class="edge">
<title>layer_0_k_reshape_2_2&#45;&gt;layer_0_attn_2_2</title>
<path fill="none" stroke="black" d="M14583.54,-3876.38C14580.01,-3868.01 14576.17,-3858.9 14572.47,-3850.13"/>
<polygon fill="black" stroke="black" points="14575.65,-3848.65 14568.54,-3840.8 14569.2,-3851.37 14575.65,-3848.65"/>
</g>
<!-- layer_0_v_reshape_2_2&#45;&gt;layer_0_attn_2_2 -->
<g id="edge111" class="edge">
<title>layer_0_v_reshape_2_2&#45;&gt;layer_0_attn_2_2</title>
<path fill="none" stroke="black" d="M14883.72,-3876.45C14832.17,-3865.66 14774.75,-3853.63 14722.48,-3842.68"/>
<polygon fill="black" stroke="black" points="14722.95,-3839.2 14712.44,-3840.58 14721.51,-3846.06 14722.95,-3839.2"/>
</g>
<!-- layer_0_attn_reshape_2_2 -->
<g id="node91" class="node">
<title>layer_0_attn_reshape_2_2</title>
<polygon fill="lightblue" stroke="black" points="14242,-3736.5 13887,-3736.5 13887,-3668.5 14242,-3668.5 14242,-3736.5"/>
<text text-anchor="middle" x="14064.5" y="-3721.3" font-family="Times,serif" font-size="14.00">Reshape Attention Output</text>
<text text-anchor="middle" x="14064.5" y="-3706.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="14064.5" y="-3691.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="14064.5" y="-3676.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_0_attn_2_2&#45;&gt;layer_0_attn_reshape_2_2 -->
<g id="edge112" class="edge">
<title>layer_0_attn_2_2&#45;&gt;layer_0_attn_reshape_2_2</title>
<path fill="none" stroke="black" d="M14395.75,-3772.45C14343.89,-3761.66 14286.11,-3749.63 14233.52,-3738.68"/>
<polygon fill="black" stroke="black" points="14233.92,-3735.19 14223.42,-3736.58 14232.49,-3742.04 14233.92,-3735.19"/>
</g>
<!-- layer_0_attn_reshape_2_2&#45;&gt;layer_0_concat_intra_2 -->
<g id="edge173" class="edge">
<title>layer_0_attn_reshape_2_2&#45;&gt;layer_0_concat_intra_2</title>
<path fill="none" stroke="black" d="M13941.57,-3668.47C13893.42,-3655.53 13837.64,-3640.54 13786.83,-3626.89"/>
<polygon fill="black" stroke="black" points="13787.63,-3623.48 13777.07,-3624.26 13785.82,-3630.24 13787.63,-3623.48"/>
</g>
<!-- layer_0_q_reshape_2_3 -->
<g id="node95" class="node">
<title>layer_0_q_reshape_2_3</title>
<polygon fill="lightblue" stroke="black" points="15771.5,-3944.5 15407.5,-3944.5 15407.5,-3876.5 15771.5,-3876.5 15771.5,-3944.5"/>
<text text-anchor="middle" x="15589.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Query</text>
<text text-anchor="middle" x="15589.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="15589.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="15589.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_0_q_proj_2_3&#45;&gt;layer_0_q_reshape_2_3 -->
<g id="edge116" class="edge">
<title>layer_0_q_proj_2_3&#45;&gt;layer_0_q_reshape_2_3</title>
<path fill="none" stroke="black" d="M15575.32,-3980.38C15577.01,-3972.19 15578.84,-3963.29 15580.61,-3954.69"/>
<polygon fill="black" stroke="black" points="15584.06,-3955.3 15582.64,-3944.8 15577.2,-3953.89 15584.06,-3955.3"/>
</g>
<!-- layer_0_k_reshape_2_3 -->
<g id="node96" class="node">
<title>layer_0_k_reshape_2_3</title>
<polygon fill="lightblue" stroke="black" points="16194.5,-3944.5 15830.5,-3944.5 15830.5,-3876.5 16194.5,-3876.5 16194.5,-3944.5"/>
<text text-anchor="middle" x="16012.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Key</text>
<text text-anchor="middle" x="16012.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="16012.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="16012.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_0_k_proj_2_3&#45;&gt;layer_0_k_reshape_2_3 -->
<g id="edge117" class="edge">
<title>layer_0_k_proj_2_3&#45;&gt;layer_0_k_reshape_2_3</title>
<path fill="none" stroke="black" d="M16026.68,-3980.38C16024.99,-3972.19 16023.16,-3963.29 16021.39,-3954.69"/>
<polygon fill="black" stroke="black" points="16024.8,-3953.89 16019.36,-3944.8 16017.94,-3955.3 16024.8,-3953.89"/>
</g>
<!-- layer_0_v_reshape_2_3 -->
<g id="node97" class="node">
<title>layer_0_v_reshape_2_3</title>
<polygon fill="lightblue" stroke="black" points="16618.5,-3944.5 16254.5,-3944.5 16254.5,-3876.5 16618.5,-3876.5 16618.5,-3944.5"/>
<text text-anchor="middle" x="16436.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Value</text>
<text text-anchor="middle" x="16436.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="16436.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="16436.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_0_v_proj_2_3&#45;&gt;layer_0_v_reshape_2_3 -->
<g id="edge118" class="edge">
<title>layer_0_v_proj_2_3&#45;&gt;layer_0_v_reshape_2_3</title>
<path fill="none" stroke="black" d="M16478.37,-3980.38C16473.17,-3971.83 16467.51,-3962.51 16462.07,-3953.57"/>
<polygon fill="black" stroke="black" points="16464.93,-3951.53 16456.74,-3944.8 16458.94,-3955.16 16464.93,-3951.53"/>
</g>
<!-- layer_0_attn_2_3 -->
<g id="node98" class="node">
<title>layer_0_attn_2_3</title>
<polygon fill="lightblue" stroke="black" points="16041.5,-3840.5 15559.5,-3840.5 15559.5,-3772.5 16041.5,-3772.5 16041.5,-3840.5"/>
<text text-anchor="middle" x="15800.5" y="-3825.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="15800.5" y="-3810.3" font-family="Times,serif" font-size="14.00">Input: Q[128,10000,8,32], K[128,10000,8,32], V[128,10000,8,32]</text>
<text text-anchor="middle" x="15800.5" y="-3795.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="15800.5" y="-3780.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_0_q_reshape_2_3&#45;&gt;layer_0_attn_2_3 -->
<g id="edge119" class="edge">
<title>layer_0_q_reshape_2_3&#45;&gt;layer_0_attn_2_3</title>
<path fill="none" stroke="black" d="M15658.01,-3876.38C15678.75,-3866.36 15701.68,-3855.27 15722.96,-3844.98"/>
<polygon fill="black" stroke="black" points="15724.5,-3848.13 15731.98,-3840.62 15721.45,-3841.83 15724.5,-3848.13"/>
</g>
<!-- layer_0_k_reshape_2_3&#45;&gt;layer_0_attn_2_3 -->
<g id="edge120" class="edge">
<title>layer_0_k_reshape_2_3&#45;&gt;layer_0_attn_2_3</title>
<path fill="none" stroke="black" d="M15943.67,-3876.38C15922.83,-3866.36 15899.79,-3855.27 15878.4,-3844.98"/>
<polygon fill="black" stroke="black" points="15879.88,-3841.81 15869.35,-3840.62 15876.84,-3848.11 15879.88,-3841.81"/>
</g>
<!-- layer_0_v_reshape_2_3&#45;&gt;layer_0_attn_2_3 -->
<g id="edge121" class="edge">
<title>layer_0_v_reshape_2_3&#45;&gt;layer_0_attn_2_3</title>
<path fill="none" stroke="black" d="M16254.25,-3880.27C16179.97,-3868.36 16093.54,-3854.5 16016.15,-3842.09"/>
<polygon fill="black" stroke="black" points="16016.7,-3838.63 16006.27,-3840.5 16015.59,-3845.54 16016.7,-3838.63"/>
</g>
<!-- layer_0_attn_reshape_2_3 -->
<g id="node99" class="node">
<title>layer_0_attn_reshape_2_3</title>
<polygon fill="lightblue" stroke="black" points="15159,-3736.5 14804,-3736.5 14804,-3668.5 15159,-3668.5 15159,-3736.5"/>
<text text-anchor="middle" x="14981.5" y="-3721.3" font-family="Times,serif" font-size="14.00">Reshape Attention Output</text>
<text text-anchor="middle" x="14981.5" y="-3706.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="14981.5" y="-3691.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="14981.5" y="-3676.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_0_attn_2_3&#45;&gt;layer_0_attn_reshape_2_3 -->
<g id="edge122" class="edge">
<title>layer_0_attn_2_3&#45;&gt;layer_0_attn_reshape_2_3</title>
<path fill="none" stroke="black" d="M15559.48,-3775.48C15434.88,-3759.96 15285.07,-3741.31 15169.19,-3726.88"/>
<polygon fill="black" stroke="black" points="15169.5,-3723.39 15159.15,-3725.62 15168.64,-3730.33 15169.5,-3723.39"/>
</g>
<!-- layer_0_attn_reshape_2_3&#45;&gt;layer_0_concat_intra_2 -->
<g id="edge174" class="edge">
<title>layer_0_attn_reshape_2_3&#45;&gt;layer_0_concat_intra_2</title>
<path fill="none" stroke="black" d="M14803.75,-3686.2C14565.53,-3665.7 14141.8,-3629.24 13874.59,-3606.25"/>
<polygon fill="black" stroke="black" points="13874.63,-3602.74 13864.36,-3605.37 13874.03,-3609.71 13874.63,-3602.74"/>
</g>
<!-- layer_0_q_reshape_3_0 -->
<g id="node103" class="node">
<title>layer_0_q_reshape_3_0</title>
<polygon fill="lightblue" stroke="black" points="17208.5,-3944.5 16844.5,-3944.5 16844.5,-3876.5 17208.5,-3876.5 17208.5,-3944.5"/>
<text text-anchor="middle" x="17026.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Query</text>
<text text-anchor="middle" x="17026.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="17026.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="17026.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_0_q_proj_3_0&#45;&gt;layer_0_q_reshape_3_0 -->
<g id="edge126" class="edge">
<title>layer_0_q_proj_3_0&#45;&gt;layer_0_q_reshape_3_0</title>
<path fill="none" stroke="black" d="M16983.95,-3980.38C16989.24,-3971.83 16994.99,-3962.51 17000.51,-3953.57"/>
<polygon fill="black" stroke="black" points="17003.66,-3955.15 17005.93,-3944.8 16997.7,-3951.47 17003.66,-3955.15"/>
</g>
<!-- layer_0_k_reshape_3_0 -->
<g id="node104" class="node">
<title>layer_0_k_reshape_3_0</title>
<polygon fill="lightblue" stroke="black" points="17631.5,-3944.5 17267.5,-3944.5 17267.5,-3876.5 17631.5,-3876.5 17631.5,-3944.5"/>
<text text-anchor="middle" x="17449.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Key</text>
<text text-anchor="middle" x="17449.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="17449.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="17449.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_0_k_proj_3_0&#45;&gt;layer_0_k_reshape_3_0 -->
<g id="edge127" class="edge">
<title>layer_0_k_proj_3_0&#45;&gt;layer_0_k_reshape_3_0</title>
<path fill="none" stroke="black" d="M17435.32,-3980.38C17437.01,-3972.19 17438.84,-3963.29 17440.61,-3954.69"/>
<polygon fill="black" stroke="black" points="17444.06,-3955.3 17442.64,-3944.8 17437.2,-3953.89 17444.06,-3955.3"/>
</g>
<!-- layer_0_v_reshape_3_0 -->
<g id="node105" class="node">
<title>layer_0_v_reshape_3_0</title>
<polygon fill="lightblue" stroke="black" points="18034.5,-3944.5 17670.5,-3944.5 17670.5,-3876.5 18034.5,-3876.5 18034.5,-3944.5"/>
<text text-anchor="middle" x="17852.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Value</text>
<text text-anchor="middle" x="17852.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="17852.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="17852.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_0_v_proj_3_0&#45;&gt;layer_0_v_reshape_3_0 -->
<g id="edge128" class="edge">
<title>layer_0_v_proj_3_0&#45;&gt;layer_0_v_reshape_3_0</title>
<path fill="none" stroke="black" d="M17880.19,-3980.38C17876.82,-3972.01 17873.16,-3962.9 17869.64,-3954.13"/>
<polygon fill="black" stroke="black" points="17872.86,-3952.77 17865.89,-3944.8 17866.37,-3955.38 17872.86,-3952.77"/>
</g>
<!-- layer_0_attn_3_0 -->
<g id="node106" class="node">
<title>layer_0_attn_3_0</title>
<polygon fill="lightblue" stroke="black" points="17902.5,-3840.5 17420.5,-3840.5 17420.5,-3772.5 17902.5,-3772.5 17902.5,-3840.5"/>
<text text-anchor="middle" x="17661.5" y="-3825.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="17661.5" y="-3810.3" font-family="Times,serif" font-size="14.00">Input: Q[128,10000,8,32], K[128,10000,8,32], V[128,10000,8,32]</text>
<text text-anchor="middle" x="17661.5" y="-3795.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="17661.5" y="-3780.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_0_q_reshape_3_0&#45;&gt;layer_0_attn_3_0 -->
<g id="edge129" class="edge">
<title>layer_0_q_reshape_3_0&#45;&gt;layer_0_attn_3_0</title>
<path fill="none" stroke="black" d="M17208.89,-3880.2C17282.8,-3868.33 17368.72,-3854.53 17445.71,-3842.16"/>
<polygon fill="black" stroke="black" points="17446.71,-3845.55 17456.02,-3840.51 17445.6,-3838.64 17446.71,-3845.55"/>
</g>
<!-- layer_0_k_reshape_3_0&#45;&gt;layer_0_attn_3_0 -->
<g id="edge130" class="edge">
<title>layer_0_k_reshape_3_0&#45;&gt;layer_0_attn_3_0</title>
<path fill="none" stroke="black" d="M17518.33,-3876.38C17539.17,-3866.36 17562.21,-3855.27 17583.6,-3844.98"/>
<polygon fill="black" stroke="black" points="17585.16,-3848.11 17592.65,-3840.62 17582.12,-3841.81 17585.16,-3848.11"/>
</g>
<!-- layer_0_v_reshape_3_0&#45;&gt;layer_0_attn_3_0 -->
<g id="edge131" class="edge">
<title>layer_0_v_reshape_3_0&#45;&gt;layer_0_attn_3_0</title>
<path fill="none" stroke="black" d="M17790.49,-3876.38C17771.96,-3866.49 17751.51,-3855.57 17732.46,-3845.4"/>
<polygon fill="black" stroke="black" points="17734,-3842.25 17723.53,-3840.62 17730.7,-3848.42 17734,-3842.25"/>
</g>
<!-- layer_0_attn_reshape_3_0 -->
<g id="node107" class="node">
<title>layer_0_attn_reshape_3_0</title>
<polygon fill="lightblue" stroke="black" points="18117,-3736.5 17762,-3736.5 17762,-3668.5 18117,-3668.5 18117,-3736.5"/>
<text text-anchor="middle" x="17939.5" y="-3721.3" font-family="Times,serif" font-size="14.00">Reshape Attention Output</text>
<text text-anchor="middle" x="17939.5" y="-3706.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="17939.5" y="-3691.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="17939.5" y="-3676.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_0_attn_3_0&#45;&gt;layer_0_attn_reshape_3_0 -->
<g id="edge132" class="edge">
<title>layer_0_attn_3_0&#45;&gt;layer_0_attn_reshape_3_0</title>
<path fill="none" stroke="black" d="M17751.76,-3772.38C17779.82,-3762.09 17810.91,-3750.68 17839.59,-3740.16"/>
<polygon fill="black" stroke="black" points="17841.04,-3743.35 17849.22,-3736.62 17838.63,-3736.78 17841.04,-3743.35"/>
</g>
<!-- layer_0_concat_intra_3 -->
<g id="node135" class="node">
<title>layer_0_concat_intra_3</title>
<ellipse fill="lightyellow" stroke="black" cx="18823.5" cy="-3584.42" rx="257.27" ry="48.17"/>
<text text-anchor="middle" x="18823.5" y="-3603.22" font-family="Times,serif" font-size="14.00">Intra&#45;Group Concatenation</text>
<text text-anchor="middle" x="18823.5" y="-3588.22" font-family="Times,serif" font-size="14.00">Input: 4×[batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="18823.5" y="-3573.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 1024]</text>
<text text-anchor="middle" x="18823.5" y="-3558.22" font-family="Times,serif" font-size="14.00">GPU: [12, 13, 14, 15]</text>
</g>
<!-- layer_0_attn_reshape_3_0&#45;&gt;layer_0_concat_intra_3 -->
<g id="edge175" class="edge">
<title>layer_0_attn_reshape_3_0&#45;&gt;layer_0_concat_intra_3</title>
<path fill="none" stroke="black" d="M18117.06,-3678.18C18257.63,-3659.72 18454.62,-3633.86 18604.88,-3614.12"/>
<polygon fill="black" stroke="black" points="18605.71,-3617.55 18615.16,-3612.77 18604.79,-3610.61 18605.71,-3617.55"/>
</g>
<!-- layer_0_q_reshape_3_1 -->
<g id="node111" class="node">
<title>layer_0_q_reshape_3_1</title>
<polygon fill="lightblue" stroke="black" points="18582.5,-3944.5 18218.5,-3944.5 18218.5,-3876.5 18582.5,-3876.5 18582.5,-3944.5"/>
<text text-anchor="middle" x="18400.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Query</text>
<text text-anchor="middle" x="18400.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="18400.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="18400.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_0_q_proj_3_1&#45;&gt;layer_0_q_reshape_3_1 -->
<g id="edge136" class="edge">
<title>layer_0_q_proj_3_1&#45;&gt;layer_0_q_reshape_3_1</title>
<path fill="none" stroke="black" d="M18372.14,-3980.38C18375.58,-3972.01 18379.33,-3962.9 18382.95,-3954.13"/>
<polygon fill="black" stroke="black" points="18386.22,-3955.38 18386.79,-3944.8 18379.74,-3952.71 18386.22,-3955.38"/>
</g>
<!-- layer_0_k_reshape_3_1 -->
<g id="node112" class="node">
<title>layer_0_k_reshape_3_1</title>
<polygon fill="lightblue" stroke="black" points="19005.5,-3944.5 18641.5,-3944.5 18641.5,-3876.5 19005.5,-3876.5 19005.5,-3944.5"/>
<text text-anchor="middle" x="18823.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Key</text>
<text text-anchor="middle" x="18823.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="18823.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="18823.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_0_k_proj_3_1&#45;&gt;layer_0_k_reshape_3_1 -->
<g id="edge137" class="edge">
<title>layer_0_k_proj_3_1&#45;&gt;layer_0_k_reshape_3_1</title>
<path fill="none" stroke="black" d="M18823.5,-3980.38C18823.5,-3972.28 18823.5,-3963.48 18823.5,-3954.97"/>
<polygon fill="black" stroke="black" points="18827,-3954.8 18823.5,-3944.8 18820,-3954.8 18827,-3954.8"/>
</g>
<!-- layer_0_v_reshape_3_1 -->
<g id="node113" class="node">
<title>layer_0_v_reshape_3_1</title>
<polygon fill="lightblue" stroke="black" points="19429.5,-3944.5 19065.5,-3944.5 19065.5,-3876.5 19429.5,-3876.5 19429.5,-3944.5"/>
<text text-anchor="middle" x="19247.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Value</text>
<text text-anchor="middle" x="19247.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="19247.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="19247.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_0_v_proj_3_1&#45;&gt;layer_0_v_reshape_3_1 -->
<g id="edge138" class="edge">
<title>layer_0_v_proj_3_1&#45;&gt;layer_0_v_reshape_3_1</title>
<path fill="none" stroke="black" d="M19275.19,-3980.38C19271.82,-3972.01 19268.16,-3962.9 19264.64,-3954.13"/>
<polygon fill="black" stroke="black" points="19267.86,-3952.77 19260.89,-3944.8 19261.37,-3955.38 19267.86,-3952.77"/>
</g>
<!-- layer_0_attn_3_1 -->
<g id="node114" class="node">
<title>layer_0_attn_3_1</title>
<polygon fill="lightblue" stroke="black" points="19064.5,-3840.5 18582.5,-3840.5 18582.5,-3772.5 19064.5,-3772.5 19064.5,-3840.5"/>
<text text-anchor="middle" x="18823.5" y="-3825.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="18823.5" y="-3810.3" font-family="Times,serif" font-size="14.00">Input: Q[128,10000,8,32], K[128,10000,8,32], V[128,10000,8,32]</text>
<text text-anchor="middle" x="18823.5" y="-3795.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="18823.5" y="-3780.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_0_q_reshape_3_1&#45;&gt;layer_0_attn_3_1 -->
<g id="edge139" class="edge">
<title>layer_0_q_reshape_3_1&#45;&gt;layer_0_attn_3_1</title>
<path fill="none" stroke="black" d="M18537.54,-3876.45C18581.94,-3865.75 18631.36,-3853.83 18676.46,-3842.96"/>
<polygon fill="black" stroke="black" points="18677.41,-3846.33 18686.31,-3840.58 18675.77,-3839.52 18677.41,-3846.33"/>
</g>
<!-- layer_0_k_reshape_3_1&#45;&gt;layer_0_attn_3_1 -->
<g id="edge140" class="edge">
<title>layer_0_k_reshape_3_1&#45;&gt;layer_0_attn_3_1</title>
<path fill="none" stroke="black" d="M18823.5,-3876.38C18823.5,-3868.28 18823.5,-3859.48 18823.5,-3850.97"/>
<polygon fill="black" stroke="black" points="18827,-3850.8 18823.5,-3840.8 18820,-3850.8 18827,-3850.8"/>
</g>
<!-- layer_0_v_reshape_3_1&#45;&gt;layer_0_attn_3_1 -->
<g id="edge141" class="edge">
<title>layer_0_v_reshape_3_1&#45;&gt;layer_0_attn_3_1</title>
<path fill="none" stroke="black" d="M19110.13,-3876.45C19065.63,-3865.75 19016.09,-3853.83 18970.89,-3842.96"/>
<polygon fill="black" stroke="black" points="18971.55,-3839.52 18961.01,-3840.58 18969.92,-3846.32 18971.55,-3839.52"/>
</g>
<!-- layer_0_attn_reshape_3_1 -->
<g id="node115" class="node">
<title>layer_0_attn_reshape_3_1</title>
<polygon fill="lightblue" stroke="black" points="19001,-3736.5 18646,-3736.5 18646,-3668.5 19001,-3668.5 19001,-3736.5"/>
<text text-anchor="middle" x="18823.5" y="-3721.3" font-family="Times,serif" font-size="14.00">Reshape Attention Output</text>
<text text-anchor="middle" x="18823.5" y="-3706.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="18823.5" y="-3691.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="18823.5" y="-3676.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_0_attn_3_1&#45;&gt;layer_0_attn_reshape_3_1 -->
<g id="edge142" class="edge">
<title>layer_0_attn_3_1&#45;&gt;layer_0_attn_reshape_3_1</title>
<path fill="none" stroke="black" d="M18823.5,-3772.38C18823.5,-3764.28 18823.5,-3755.48 18823.5,-3746.97"/>
<polygon fill="black" stroke="black" points="18827,-3746.8 18823.5,-3736.8 18820,-3746.8 18827,-3746.8"/>
</g>
<!-- layer_0_attn_reshape_3_1&#45;&gt;layer_0_concat_intra_3 -->
<g id="edge176" class="edge">
<title>layer_0_attn_reshape_3_1&#45;&gt;layer_0_concat_intra_3</title>
<path fill="none" stroke="black" d="M18823.5,-3668.23C18823.5,-3660.24 18823.5,-3651.48 18823.5,-3642.73"/>
<polygon fill="black" stroke="black" points="18827,-3642.53 18823.5,-3632.53 18820,-3642.53 18827,-3642.53"/>
</g>
<!-- layer_0_q_reshape_3_2 -->
<g id="node119" class="node">
<title>layer_0_q_reshape_3_2</title>
<polygon fill="lightblue" stroke="black" points="19956.5,-3944.5 19592.5,-3944.5 19592.5,-3876.5 19956.5,-3876.5 19956.5,-3944.5"/>
<text text-anchor="middle" x="19774.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Query</text>
<text text-anchor="middle" x="19774.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="19774.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="19774.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_0_q_proj_3_2&#45;&gt;layer_0_q_reshape_3_2 -->
<g id="edge146" class="edge">
<title>layer_0_q_proj_3_2&#45;&gt;layer_0_q_reshape_3_2</title>
<path fill="none" stroke="black" d="M19760.32,-3980.38C19762.01,-3972.19 19763.84,-3963.29 19765.61,-3954.69"/>
<polygon fill="black" stroke="black" points="19769.06,-3955.3 19767.64,-3944.8 19762.2,-3953.89 19769.06,-3955.3"/>
</g>
<!-- layer_0_k_reshape_3_2 -->
<g id="node120" class="node">
<title>layer_0_k_reshape_3_2</title>
<polygon fill="lightblue" stroke="black" points="20379.5,-3944.5 20015.5,-3944.5 20015.5,-3876.5 20379.5,-3876.5 20379.5,-3944.5"/>
<text text-anchor="middle" x="20197.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Key</text>
<text text-anchor="middle" x="20197.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="20197.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="20197.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_0_k_proj_3_2&#45;&gt;layer_0_k_reshape_3_2 -->
<g id="edge147" class="edge">
<title>layer_0_k_proj_3_2&#45;&gt;layer_0_k_reshape_3_2</title>
<path fill="none" stroke="black" d="M20211.68,-3980.38C20209.99,-3972.19 20208.16,-3963.29 20206.39,-3954.69"/>
<polygon fill="black" stroke="black" points="20209.8,-3953.89 20204.36,-3944.8 20202.94,-3955.3 20209.8,-3953.89"/>
</g>
<!-- layer_0_v_reshape_3_2 -->
<g id="node121" class="node">
<title>layer_0_v_reshape_3_2</title>
<polygon fill="lightblue" stroke="black" points="20802.5,-3944.5 20438.5,-3944.5 20438.5,-3876.5 20802.5,-3876.5 20802.5,-3944.5"/>
<text text-anchor="middle" x="20620.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Value</text>
<text text-anchor="middle" x="20620.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="20620.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="20620.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_0_v_proj_3_2&#45;&gt;layer_0_v_reshape_3_2 -->
<g id="edge148" class="edge">
<title>layer_0_v_proj_3_2&#45;&gt;layer_0_v_reshape_3_2</title>
<path fill="none" stroke="black" d="M20663.05,-3980.38C20657.76,-3971.83 20652.01,-3962.51 20646.49,-3953.57"/>
<polygon fill="black" stroke="black" points="20649.3,-3951.47 20641.07,-3944.8 20643.34,-3955.15 20649.3,-3951.47"/>
</g>
<!-- layer_0_attn_3_2 -->
<g id="node122" class="node">
<title>layer_0_attn_3_2</title>
<polygon fill="lightblue" stroke="black" points="20227.5,-3840.5 19745.5,-3840.5 19745.5,-3772.5 20227.5,-3772.5 20227.5,-3840.5"/>
<text text-anchor="middle" x="19986.5" y="-3825.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="19986.5" y="-3810.3" font-family="Times,serif" font-size="14.00">Input: Q[128,10000,8,32], K[128,10000,8,32], V[128,10000,8,32]</text>
<text text-anchor="middle" x="19986.5" y="-3795.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="19986.5" y="-3780.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_0_q_reshape_3_2&#45;&gt;layer_0_attn_3_2 -->
<g id="edge149" class="edge">
<title>layer_0_q_reshape_3_2&#45;&gt;layer_0_attn_3_2</title>
<path fill="none" stroke="black" d="M19843.33,-3876.38C19864.17,-3866.36 19887.21,-3855.27 19908.6,-3844.98"/>
<polygon fill="black" stroke="black" points="19910.16,-3848.11 19917.65,-3840.62 19907.12,-3841.81 19910.16,-3848.11"/>
</g>
<!-- layer_0_k_reshape_3_2&#45;&gt;layer_0_attn_3_2 -->
<g id="edge150" class="edge">
<title>layer_0_k_reshape_3_2&#45;&gt;layer_0_attn_3_2</title>
<path fill="none" stroke="black" d="M20128.99,-3876.38C20108.25,-3866.36 20085.32,-3855.27 20064.04,-3844.98"/>
<polygon fill="black" stroke="black" points="20065.55,-3841.83 20055.02,-3840.62 20062.5,-3848.13 20065.55,-3841.83"/>
</g>
<!-- layer_0_v_reshape_3_2&#45;&gt;layer_0_attn_3_2 -->
<g id="edge151" class="edge">
<title>layer_0_v_reshape_3_2&#45;&gt;layer_0_attn_3_2</title>
<path fill="none" stroke="black" d="M20438.4,-3880.2C20364.6,-3868.33 20278.82,-3854.53 20201.95,-3842.16"/>
<polygon fill="black" stroke="black" points="20202.08,-3838.64 20191.65,-3840.51 20200.97,-3845.55 20202.08,-3838.64"/>
</g>
<!-- layer_0_attn_reshape_3_2 -->
<g id="node123" class="node">
<title>layer_0_attn_reshape_3_2</title>
<polygon fill="lightblue" stroke="black" points="19653,-3736.5 19298,-3736.5 19298,-3668.5 19653,-3668.5 19653,-3736.5"/>
<text text-anchor="middle" x="19475.5" y="-3721.3" font-family="Times,serif" font-size="14.00">Reshape Attention Output</text>
<text text-anchor="middle" x="19475.5" y="-3706.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="19475.5" y="-3691.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="19475.5" y="-3676.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_0_attn_3_2&#45;&gt;layer_0_attn_reshape_3_2 -->
<g id="edge152" class="edge">
<title>layer_0_attn_3_2&#45;&gt;layer_0_attn_reshape_3_2</title>
<path fill="none" stroke="black" d="M19820.95,-3772.45C19766.63,-3761.61 19706.11,-3749.53 19651.08,-3738.55"/>
<polygon fill="black" stroke="black" points="19651.72,-3735.11 19641.23,-3736.58 19650.35,-3741.97 19651.72,-3735.11"/>
</g>
<!-- layer_0_attn_reshape_3_2&#45;&gt;layer_0_concat_intra_3 -->
<g id="edge177" class="edge">
<title>layer_0_attn_reshape_3_2&#45;&gt;layer_0_concat_intra_3</title>
<path fill="none" stroke="black" d="M19297.77,-3669.86C19210.91,-3654.39 19106.2,-3635.75 19017.29,-3619.92"/>
<polygon fill="black" stroke="black" points="19017.82,-3616.46 19007.36,-3618.15 19016.59,-3623.35 19017.82,-3616.46"/>
</g>
<!-- layer_0_q_reshape_3_3 -->
<g id="node127" class="node">
<title>layer_0_q_reshape_3_3</title>
<polygon fill="lightblue" stroke="black" points="21351.5,-3944.5 20987.5,-3944.5 20987.5,-3876.5 21351.5,-3876.5 21351.5,-3944.5"/>
<text text-anchor="middle" x="21169.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Query</text>
<text text-anchor="middle" x="21169.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="21169.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="21169.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_0_q_proj_3_3&#45;&gt;layer_0_q_reshape_3_3 -->
<g id="edge156" class="edge">
<title>layer_0_q_proj_3_3&#45;&gt;layer_0_q_reshape_3_3</title>
<path fill="none" stroke="black" d="M21155.32,-3980.38C21157.01,-3972.19 21158.84,-3963.29 21160.61,-3954.69"/>
<polygon fill="black" stroke="black" points="21164.06,-3955.3 21162.64,-3944.8 21157.2,-3953.89 21164.06,-3955.3"/>
</g>
<!-- layer_0_k_reshape_3_3 -->
<g id="node128" class="node">
<title>layer_0_k_reshape_3_3</title>
<polygon fill="lightblue" stroke="black" points="21754.5,-3944.5 21390.5,-3944.5 21390.5,-3876.5 21754.5,-3876.5 21754.5,-3944.5"/>
<text text-anchor="middle" x="21572.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Key</text>
<text text-anchor="middle" x="21572.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="21572.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="21572.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_0_k_proj_3_3&#45;&gt;layer_0_k_reshape_3_3 -->
<g id="edge157" class="edge">
<title>layer_0_k_proj_3_3&#45;&gt;layer_0_k_reshape_3_3</title>
<path fill="none" stroke="black" d="M21600.19,-3980.38C21596.82,-3972.01 21593.16,-3962.9 21589.64,-3954.13"/>
<polygon fill="black" stroke="black" points="21592.86,-3952.77 21585.89,-3944.8 21586.37,-3955.38 21592.86,-3952.77"/>
</g>
<!-- layer_0_v_reshape_3_3 -->
<g id="node129" class="node">
<title>layer_0_v_reshape_3_3</title>
<polygon fill="lightblue" stroke="black" points="22198.5,-3944.5 21834.5,-3944.5 21834.5,-3876.5 22198.5,-3876.5 22198.5,-3944.5"/>
<text text-anchor="middle" x="22016.5" y="-3929.3" font-family="Times,serif" font-size="14.00">Reshape Value</text>
<text text-anchor="middle" x="22016.5" y="-3914.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="22016.5" y="-3899.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="22016.5" y="-3884.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_0_v_proj_3_3&#45;&gt;layer_0_v_reshape_3_3 -->
<g id="edge158" class="edge">
<title>layer_0_v_proj_3_3&#45;&gt;layer_0_v_reshape_3_3</title>
<path fill="none" stroke="black" d="M22058.37,-3980.38C22053.17,-3971.83 22047.51,-3962.51 22042.07,-3953.57"/>
<polygon fill="black" stroke="black" points="22044.93,-3951.53 22036.74,-3944.8 22038.94,-3955.16 22044.93,-3951.53"/>
</g>
<!-- layer_0_attn_3_3 -->
<g id="node130" class="node">
<title>layer_0_attn_3_3</title>
<polygon fill="lightblue" stroke="black" points="21622.5,-3840.5 21140.5,-3840.5 21140.5,-3772.5 21622.5,-3772.5 21622.5,-3840.5"/>
<text text-anchor="middle" x="21381.5" y="-3825.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="21381.5" y="-3810.3" font-family="Times,serif" font-size="14.00">Input: Q[128,10000,8,32], K[128,10000,8,32], V[128,10000,8,32]</text>
<text text-anchor="middle" x="21381.5" y="-3795.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="21381.5" y="-3780.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_0_q_reshape_3_3&#45;&gt;layer_0_attn_3_3 -->
<g id="edge159" class="edge">
<title>layer_0_q_reshape_3_3&#45;&gt;layer_0_attn_3_3</title>
<path fill="none" stroke="black" d="M21238.33,-3876.38C21259.17,-3866.36 21282.21,-3855.27 21303.6,-3844.98"/>
<polygon fill="black" stroke="black" points="21305.16,-3848.11 21312.65,-3840.62 21302.12,-3841.81 21305.16,-3848.11"/>
</g>
<!-- layer_0_k_reshape_3_3&#45;&gt;layer_0_attn_3_3 -->
<g id="edge160" class="edge">
<title>layer_0_k_reshape_3_3&#45;&gt;layer_0_attn_3_3</title>
<path fill="none" stroke="black" d="M21510.49,-3876.38C21491.96,-3866.49 21471.51,-3855.57 21452.46,-3845.4"/>
<polygon fill="black" stroke="black" points="21454,-3842.25 21443.53,-3840.62 21450.7,-3848.42 21454,-3842.25"/>
</g>
<!-- layer_0_v_reshape_3_3&#45;&gt;layer_0_attn_3_3 -->
<g id="edge161" class="edge">
<title>layer_0_v_reshape_3_3&#45;&gt;layer_0_attn_3_3</title>
<path fill="none" stroke="black" d="M21834.11,-3880.2C21760.2,-3868.33 21674.28,-3854.53 21597.29,-3842.16"/>
<polygon fill="black" stroke="black" points="21597.4,-3838.64 21586.98,-3840.51 21596.29,-3845.55 21597.4,-3838.64"/>
</g>
<!-- layer_0_attn_reshape_3_3 -->
<g id="node131" class="node">
<title>layer_0_attn_reshape_3_3</title>
<polygon fill="lightblue" stroke="black" points="21025,-3736.5 20670,-3736.5 20670,-3668.5 21025,-3668.5 21025,-3736.5"/>
<text text-anchor="middle" x="20847.5" y="-3721.3" font-family="Times,serif" font-size="14.00">Reshape Attention Output</text>
<text text-anchor="middle" x="20847.5" y="-3706.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 8, 32]</text>
<text text-anchor="middle" x="20847.5" y="-3691.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="20847.5" y="-3676.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_0_attn_3_3&#45;&gt;layer_0_attn_reshape_3_3 -->
<g id="edge162" class="edge">
<title>layer_0_attn_3_3&#45;&gt;layer_0_attn_reshape_3_3</title>
<path fill="none" stroke="black" d="M21208.49,-3772.45C21151.62,-3761.59 21088.22,-3749.48 21030.62,-3738.48"/>
<polygon fill="black" stroke="black" points="21031.17,-3735.02 21020.69,-3736.58 21029.85,-3741.89 21031.17,-3735.02"/>
</g>
<!-- layer_0_attn_reshape_3_3&#45;&gt;layer_0_concat_intra_3 -->
<g id="edge178" class="edge">
<title>layer_0_attn_reshape_3_3&#45;&gt;layer_0_concat_intra_3</title>
<path fill="none" stroke="black" d="M20669.66,-3691.3C20309.88,-3670.67 19494.6,-3623.91 19078.37,-3600.03"/>
<polygon fill="black" stroke="black" points="19078.49,-3596.54 19068.3,-3599.46 19078.09,-3603.52 19078.49,-3596.54"/>
</g>
<!-- layer_0_concat_inter -->
<g id="node136" class="node">
<title>layer_0_concat_inter</title>
<ellipse fill="lightyellow" stroke="black" cx="13632.5" cy="-3452.25" rx="263.5" ry="48.17"/>
<text text-anchor="middle" x="13632.5" y="-3471.05" font-family="Times,serif" font-size="14.00">Inter&#45;Group Concatenation</text>
<text text-anchor="middle" x="13632.5" y="-3456.05" font-family="Times,serif" font-size="14.00">Input: 4×[batch_size=128, seq_len=10000, 1024]</text>
<text text-anchor="middle" x="13632.5" y="-3441.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 4096]</text>
<text text-anchor="middle" x="13632.5" y="-3426.05" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15 (hierarchical)</text>
</g>
<!-- layer_0_concat_intra_0&#45;&gt;layer_0_concat_inter -->
<g id="edge179" class="edge">
<title>layer_0_concat_intra_0&#45;&gt;layer_0_concat_inter</title>
<path fill="none" stroke="black" d="M3734.9,-3580.13C5141.63,-3562.1 11911.65,-3475.31 13359.59,-3456.75"/>
<polygon fill="black" stroke="black" points="13359.65,-3460.25 13369.6,-3456.62 13359.56,-3453.25 13359.65,-3460.25"/>
</g>
<!-- layer_0_concat_intra_1&#45;&gt;layer_0_concat_inter -->
<g id="edge180" class="edge">
<title>layer_0_concat_intra_1&#45;&gt;layer_0_concat_inter</title>
<path fill="none" stroke="black" d="M9312.16,-3576.2C10107.1,-3553.58 12545.38,-3484.19 13362.45,-3460.93"/>
<polygon fill="black" stroke="black" points="13362.68,-3464.43 13372.58,-3460.65 13362.48,-3457.43 13362.68,-3464.43"/>
</g>
<!-- layer_0_concat_intra_2&#45;&gt;layer_0_concat_inter -->
<g id="edge181" class="edge">
<title>layer_0_concat_intra_2&#45;&gt;layer_0_concat_inter</title>
<path fill="none" stroke="black" d="M13632.5,-3536.05C13632.5,-3527.79 13632.5,-3519.1 13632.5,-3510.6"/>
<polygon fill="black" stroke="black" points="13636,-3510.36 13632.5,-3500.36 13629,-3510.36 13636,-3510.36"/>
</g>
<!-- layer_0_concat_intra_3&#45;&gt;layer_0_concat_inter -->
<g id="edge182" class="edge">
<title>layer_0_concat_intra_3&#45;&gt;layer_0_concat_inter</title>
<path fill="none" stroke="black" d="M18568.73,-3577.03C17691.98,-3555.04 14803.91,-3482.62 13903.23,-3460.04"/>
<polygon fill="black" stroke="black" points="13903.13,-3456.54 13893.05,-3459.78 13902.96,-3463.53 13903.13,-3456.54"/>
</g>
<!-- layer_0_final_concat -->
<g id="node153" class="node">
<title>layer_0_final_concat</title>
<ellipse fill="lightyellow" stroke="black" cx="13632.5" cy="-3320.08" rx="263.5" ry="48.17"/>
<text text-anchor="middle" x="13632.5" y="-3338.88" font-family="Times,serif" font-size="14.00">Final Attention Concatenation</text>
<text text-anchor="middle" x="13632.5" y="-3323.88" font-family="Times,serif" font-size="14.00">Input: 16×[batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="13632.5" y="-3308.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 4096]</text>
<text text-anchor="middle" x="13632.5" y="-3293.88" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15 (all)</text>
</g>
<!-- layer_0_concat_inter&#45;&gt;layer_0_final_concat -->
<g id="edge183" class="edge">
<title>layer_0_concat_inter&#45;&gt;layer_0_final_concat</title>
<path fill="none" stroke="black" d="M13632.5,-3403.89C13632.5,-3395.62 13632.5,-3386.94 13632.5,-3378.43"/>
<polygon fill="black" stroke="black" points="13636,-3378.19 13632.5,-3368.19 13629,-3378.19 13636,-3378.19"/>
</g>
<!-- layer_0_concat_inter&#45;&gt;layer_0_residual1 -->
<g id="edge185" class="edge">
<title>layer_0_concat_inter&#45;&gt;layer_0_residual1</title>
<path fill="none" stroke="black" d="M13892.82,-3444.32C14716.84,-3422.39 17267.83,-3354.48 18187.58,-3330"/>
<polygon fill="black" stroke="black" points="18187.75,-3333.5 18197.66,-3329.73 18187.57,-3326.5 18187.75,-3333.5"/>
</g>
<!-- layer_0_out_proj_0_0 -->
<g id="node137" class="node">
<title>layer_0_out_proj_0_0</title>
<polygon fill="lightblue" stroke="black" points="12241.5,-4422.67 11877.5,-4422.67 11877.5,-4354.67 12241.5,-4354.67 12241.5,-4422.67"/>
<text text-anchor="middle" x="12059.5" y="-4407.47" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12059.5" y="-4392.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="12059.5" y="-4377.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 4096]</text>
<text text-anchor="middle" x="12059.5" y="-4362.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_out_proj_0_1 -->
<g id="node138" class="node">
<title>layer_0_out_proj_0_1</title>
<polygon fill="lightblue" stroke="black" points="12623.5,-4422.67 12259.5,-4422.67 12259.5,-4354.67 12623.5,-4354.67 12623.5,-4422.67"/>
<text text-anchor="middle" x="12441.5" y="-4407.47" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12441.5" y="-4392.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="12441.5" y="-4377.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 4096]</text>
<text text-anchor="middle" x="12441.5" y="-4362.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_0_out_proj_0_2 -->
<g id="node139" class="node">
<title>layer_0_out_proj_0_2</title>
<polygon fill="lightblue" stroke="black" points="13005.5,-4422.67 12641.5,-4422.67 12641.5,-4354.67 13005.5,-4354.67 13005.5,-4422.67"/>
<text text-anchor="middle" x="12823.5" y="-4407.47" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12823.5" y="-4392.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="12823.5" y="-4377.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 4096]</text>
<text text-anchor="middle" x="12823.5" y="-4362.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_0_out_proj_0_3 -->
<g id="node140" class="node">
<title>layer_0_out_proj_0_3</title>
<polygon fill="lightblue" stroke="black" points="13387.5,-4422.67 13023.5,-4422.67 13023.5,-4354.67 13387.5,-4354.67 13387.5,-4422.67"/>
<text text-anchor="middle" x="13205.5" y="-4407.47" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13205.5" y="-4392.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="13205.5" y="-4377.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 4096]</text>
<text text-anchor="middle" x="13205.5" y="-4362.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_0_out_proj_1_0 -->
<g id="node141" class="node">
<title>layer_0_out_proj_1_0</title>
<polygon fill="lightblue" stroke="black" points="13769.5,-4422.67 13405.5,-4422.67 13405.5,-4354.67 13769.5,-4354.67 13769.5,-4422.67"/>
<text text-anchor="middle" x="13587.5" y="-4407.47" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13587.5" y="-4392.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="13587.5" y="-4377.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 4096]</text>
<text text-anchor="middle" x="13587.5" y="-4362.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_0_out_proj_1_1 -->
<g id="node142" class="node">
<title>layer_0_out_proj_1_1</title>
<polygon fill="lightblue" stroke="black" points="14151.5,-4422.67 13787.5,-4422.67 13787.5,-4354.67 14151.5,-4354.67 14151.5,-4422.67"/>
<text text-anchor="middle" x="13969.5" y="-4407.47" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13969.5" y="-4392.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="13969.5" y="-4377.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 4096]</text>
<text text-anchor="middle" x="13969.5" y="-4362.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_0_out_proj_1_2 -->
<g id="node143" class="node">
<title>layer_0_out_proj_1_2</title>
<polygon fill="lightblue" stroke="black" points="14533.5,-4422.67 14169.5,-4422.67 14169.5,-4354.67 14533.5,-4354.67 14533.5,-4422.67"/>
<text text-anchor="middle" x="14351.5" y="-4407.47" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14351.5" y="-4392.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="14351.5" y="-4377.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 4096]</text>
<text text-anchor="middle" x="14351.5" y="-4362.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_0_out_proj_1_3 -->
<g id="node144" class="node">
<title>layer_0_out_proj_1_3</title>
<polygon fill="lightblue" stroke="black" points="14915.5,-4422.67 14551.5,-4422.67 14551.5,-4354.67 14915.5,-4354.67 14915.5,-4422.67"/>
<text text-anchor="middle" x="14733.5" y="-4407.47" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14733.5" y="-4392.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="14733.5" y="-4377.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 4096]</text>
<text text-anchor="middle" x="14733.5" y="-4362.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_0_out_proj_2_0 -->
<g id="node145" class="node">
<title>layer_0_out_proj_2_0</title>
<polygon fill="lightblue" stroke="black" points="15297.5,-4422.67 14933.5,-4422.67 14933.5,-4354.67 15297.5,-4354.67 15297.5,-4422.67"/>
<text text-anchor="middle" x="15115.5" y="-4407.47" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15115.5" y="-4392.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="15115.5" y="-4377.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 4096]</text>
<text text-anchor="middle" x="15115.5" y="-4362.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_0_out_proj_2_1 -->
<g id="node146" class="node">
<title>layer_0_out_proj_2_1</title>
<polygon fill="lightblue" stroke="black" points="15679.5,-4422.67 15315.5,-4422.67 15315.5,-4354.67 15679.5,-4354.67 15679.5,-4422.67"/>
<text text-anchor="middle" x="15497.5" y="-4407.47" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15497.5" y="-4392.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="15497.5" y="-4377.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 4096]</text>
<text text-anchor="middle" x="15497.5" y="-4362.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_0_out_proj_2_2 -->
<g id="node147" class="node">
<title>layer_0_out_proj_2_2</title>
<polygon fill="lightblue" stroke="black" points="16061.5,-4422.67 15697.5,-4422.67 15697.5,-4354.67 16061.5,-4354.67 16061.5,-4422.67"/>
<text text-anchor="middle" x="15879.5" y="-4407.47" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15879.5" y="-4392.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="15879.5" y="-4377.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 4096]</text>
<text text-anchor="middle" x="15879.5" y="-4362.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_0_out_proj_2_3 -->
<g id="node148" class="node">
<title>layer_0_out_proj_2_3</title>
<polygon fill="lightblue" stroke="black" points="16443.5,-4422.67 16079.5,-4422.67 16079.5,-4354.67 16443.5,-4354.67 16443.5,-4422.67"/>
<text text-anchor="middle" x="16261.5" y="-4407.47" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16261.5" y="-4392.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="16261.5" y="-4377.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 4096]</text>
<text text-anchor="middle" x="16261.5" y="-4362.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_0_out_proj_3_0 -->
<g id="node149" class="node">
<title>layer_0_out_proj_3_0</title>
<polygon fill="lightblue" stroke="black" points="16825.5,-4422.67 16461.5,-4422.67 16461.5,-4354.67 16825.5,-4354.67 16825.5,-4422.67"/>
<text text-anchor="middle" x="16643.5" y="-4407.47" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16643.5" y="-4392.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="16643.5" y="-4377.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 4096]</text>
<text text-anchor="middle" x="16643.5" y="-4362.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_0_out_proj_3_1 -->
<g id="node150" class="node">
<title>layer_0_out_proj_3_1</title>
<polygon fill="lightblue" stroke="black" points="17207.5,-4422.67 16843.5,-4422.67 16843.5,-4354.67 17207.5,-4354.67 17207.5,-4422.67"/>
<text text-anchor="middle" x="17025.5" y="-4407.47" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17025.5" y="-4392.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="17025.5" y="-4377.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 4096]</text>
<text text-anchor="middle" x="17025.5" y="-4362.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_0_out_proj_3_2 -->
<g id="node151" class="node">
<title>layer_0_out_proj_3_2</title>
<polygon fill="lightblue" stroke="black" points="17589.5,-4422.67 17225.5,-4422.67 17225.5,-4354.67 17589.5,-4354.67 17589.5,-4422.67"/>
<text text-anchor="middle" x="17407.5" y="-4407.47" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17407.5" y="-4392.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="17407.5" y="-4377.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 4096]</text>
<text text-anchor="middle" x="17407.5" y="-4362.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_0_out_proj_3_3 -->
<g id="node152" class="node">
<title>layer_0_out_proj_3_3</title>
<polygon fill="lightblue" stroke="black" points="17971.5,-4422.67 17607.5,-4422.67 17607.5,-4354.67 17971.5,-4354.67 17971.5,-4422.67"/>
<text text-anchor="middle" x="17789.5" y="-4407.47" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17789.5" y="-4392.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 256]</text>
<text text-anchor="middle" x="17789.5" y="-4377.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 4096]</text>
<text text-anchor="middle" x="17789.5" y="-4362.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_0_norm2 -->
<g id="node155" class="node">
<title>layer_0_norm2</title>
<polygon fill="lightblue" stroke="black" points="18623,-3236 18164,-3236 18164,-3168 18623,-3168 18623,-3236"/>
<text text-anchor="middle" x="18393.5" y="-3220.8" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="18393.5" y="-3205.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="18393.5" y="-3190.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="18393.5" y="-3175.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15 (all)</text>
</g>
<!-- layer_0_residual1&#45;&gt;layer_0_norm2 -->
<g id="edge186" class="edge">
<title>layer_0_residual1&#45;&gt;layer_0_norm2</title>
<path fill="none" stroke="black" d="M18485.53,-3285.82C18470.69,-3272.46 18453.45,-3256.95 18437.93,-3242.98"/>
<polygon fill="black" stroke="black" points="18440.25,-3240.36 18430.47,-3236.27 18435.56,-3245.56 18440.25,-3240.36"/>
</g>
<!-- layer_0_final_residual -->
<g id="node160" class="node">
<title>layer_0_final_residual</title>
<polygon fill="lightblue" stroke="black" points="18743,-2820 18094,-2820 18094,-2752 18743,-2752 18743,-2820"/>
<text text-anchor="middle" x="18418.5" y="-2804.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="18418.5" y="-2789.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 4096], [batch_size=128, seq_len=10000, 4096]</text>
<text text-anchor="middle" x="18418.5" y="-2774.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="18418.5" y="-2759.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15 (all)</text>
</g>
<!-- layer_0_residual1&#45;&gt;layer_0_final_residual -->
<g id="edge191" class="edge">
<title>layer_0_residual1&#45;&gt;layer_0_final_residual</title>
<path fill="none" stroke="black" d="M18583.49,-3285.91C18602.11,-3272.8 18620.75,-3256.02 18632.5,-3236 18663.62,-3182.99 18651.5,-3160.47 18651.5,-3099 18651.5,-3099 18651.5,-3099 18651.5,-2993 18651.5,-2914.1 18575.58,-2858.15 18510.42,-2824.67"/>
<polygon fill="black" stroke="black" points="18511.81,-2821.45 18501.3,-2820.09 18508.67,-2827.7 18511.81,-2821.45"/>
</g>
<!-- layer_0_mlp_gate -->
<g id="node156" class="node">
<title>layer_0_mlp_gate</title>
<polygon fill="lightblue" stroke="black" points="18158,-3132 17711,-3132 17711,-3064 18158,-3064 18158,-3132"/>
<text text-anchor="middle" x="17934.5" y="-3116.8" font-family="Times,serif" font-size="14.00">MLP Gate</text>
<text text-anchor="middle" x="17934.5" y="-3101.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="17934.5" y="-3086.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 16384]</text>
<text text-anchor="middle" x="17934.5" y="-3071.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15 (distributed)</text>
</g>
<!-- layer_0_norm2&#45;&gt;layer_0_mlp_gate -->
<g id="edge187" class="edge">
<title>layer_0_norm2&#45;&gt;layer_0_mlp_gate</title>
<path fill="none" stroke="black" d="M18244.79,-3167.95C18196.31,-3157.18 18142.31,-3145.18 18093.13,-3134.25"/>
<polygon fill="black" stroke="black" points="18093.88,-3130.83 18083.36,-3132.08 18092.37,-3137.67 18093.88,-3130.83"/>
</g>
<!-- layer_0_mlp_up -->
<g id="node157" class="node">
<title>layer_0_mlp_up</title>
<polygon fill="lightblue" stroke="black" points="18623,-3132 18176,-3132 18176,-3064 18623,-3064 18623,-3132"/>
<text text-anchor="middle" x="18399.5" y="-3116.8" font-family="Times,serif" font-size="14.00">MLP Up</text>
<text text-anchor="middle" x="18399.5" y="-3101.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="18399.5" y="-3086.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 16384]</text>
<text text-anchor="middle" x="18399.5" y="-3071.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15 (distributed)</text>
</g>
<!-- layer_0_norm2&#45;&gt;layer_0_mlp_up -->
<g id="edge188" class="edge">
<title>layer_0_norm2&#45;&gt;layer_0_mlp_up</title>
<path fill="none" stroke="black" d="M18395.45,-3167.88C18395.92,-3159.78 18396.44,-3150.98 18396.94,-3142.47"/>
<polygon fill="black" stroke="black" points="18400.45,-3142.49 18397.54,-3132.3 18393.46,-3142.08 18400.45,-3142.49"/>
</g>
<!-- layer_0_mlp_act -->
<g id="node158" class="node">
<title>layer_0_mlp_act</title>
<polygon fill="lightblue" stroke="black" points="18372,-3028 17999,-3028 17999,-2960 18372,-2960 18372,-3028"/>
<text text-anchor="middle" x="18185.5" y="-3012.8" font-family="Times,serif" font-size="14.00">MLP Activation</text>
<text text-anchor="middle" x="18185.5" y="-2997.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 16384]</text>
<text text-anchor="middle" x="18185.5" y="-2982.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 16384]</text>
<text text-anchor="middle" x="18185.5" y="-2967.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15 (all)</text>
</g>
<!-- layer_0_mlp_gate&#45;&gt;layer_0_mlp_act -->
<g id="edge189" class="edge">
<title>layer_0_mlp_gate&#45;&gt;layer_0_mlp_act</title>
<path fill="none" stroke="black" d="M18015.99,-3063.88C18041.11,-3053.68 18068.92,-3042.38 18094.62,-3031.93"/>
<polygon fill="black" stroke="black" points="18096.04,-3035.13 18103.99,-3028.12 18093.41,-3028.65 18096.04,-3035.13"/>
</g>
<!-- layer_0_mlp_down -->
<g id="node159" class="node">
<title>layer_0_mlp_down</title>
<polygon fill="lightblue" stroke="black" points="18495.5,-2924 18131.5,-2924 18131.5,-2856 18495.5,-2856 18495.5,-2924"/>
<text text-anchor="middle" x="18313.5" y="-2908.8" font-family="Times,serif" font-size="14.00">MLP Down</text>
<text text-anchor="middle" x="18313.5" y="-2893.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, 16384]</text>
<text text-anchor="middle" x="18313.5" y="-2878.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, 4096]</text>
<text text-anchor="middle" x="18313.5" y="-2863.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15 (distributed)</text>
</g>
<!-- layer_0_mlp_act&#45;&gt;layer_0_mlp_down -->
<g id="edge190" class="edge">
<title>layer_0_mlp_act&#45;&gt;layer_0_mlp_down</title>
<path fill="none" stroke="black" d="M18227.06,-2959.88C18238.79,-2950.53 18251.68,-2940.26 18263.85,-2930.57"/>
<polygon fill="black" stroke="black" points="18266.07,-2933.27 18271.71,-2924.3 18261.71,-2927.79 18266.07,-2933.27"/>
</g>
<!-- layer_0_mlp_down&#45;&gt;layer_0_final_residual -->
<g id="edge192" class="edge">
<title>layer_0_mlp_down&#45;&gt;layer_0_final_residual</title>
<path fill="none" stroke="black" d="M18347.59,-2855.88C18356.94,-2846.8 18367.19,-2836.85 18376.91,-2827.4"/>
<polygon fill="black" stroke="black" points="18379.49,-2829.78 18384.22,-2820.3 18374.61,-2824.76 18379.49,-2829.78"/>
</g>
<!-- layer_1_... -->
<g id="node161" class="node">
<title>layer_1_...</title>
<polygon fill="lightgreen" stroke="black" points="18447.46,-2701 17909.84,-2701 17771.54,-2595 18309.16,-2595 18447.46,-2701"/>
<text text-anchor="middle" x="18109.5" y="-2659.3" font-family="Times,serif" font-size="14.00">Layer 1 (Same as Layer 0)</text>
<text text-anchor="middle" x="18109.5" y="-2644.3" font-family="Times,serif" font-size="14.00">16 partitions, 4 head groups × 4 dim slices</text>
<text text-anchor="middle" x="18109.5" y="-2629.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_0_final_residual&#45;&gt;layer_1_... -->
<g id="edge193" class="edge">
<title>layer_0_final_residual&#45;&gt;layer_1_...</title>
<path fill="none" stroke="black" d="M18343.31,-2751.9C18311.49,-2737.9 18273.52,-2721.19 18237.53,-2705.35"/>
<polygon fill="black" stroke="black" points="18238.5,-2701.95 18227.93,-2701.13 18235.68,-2708.36 18238.5,-2701.95"/>
</g>
<!-- layer_1_ellipsis -->
<g id="node176" class="node">
<title>layer_1_ellipsis</title>
<polygon fill="lightgreen" stroke="black" points="18991.67,-2716 18573.03,-2716 18465.33,-2580 18883.97,-2580 18991.67,-2716"/>
<text text-anchor="middle" x="18728.5" y="-2666.8" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="18728.5" y="-2651.8" font-family="Times,serif" font-size="14.00">(Same partitioning as Layer 0)</text>
<text text-anchor="middle" x="18728.5" y="-2636.8" font-family="Times,serif" font-size="14.00">16 partitions, hierarchical concat</text>
<text text-anchor="middle" x="18728.5" y="-2621.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_0_final_residual&#45;&gt;layer_1_ellipsis -->
<g id="edge194" class="edge">
<title>layer_0_final_residual&#45;&gt;layer_1_ellipsis</title>
<path fill="none" stroke="black" d="M18493.94,-2751.9C18516.05,-2742.21 18541.11,-2731.21 18566.44,-2720.1"/>
<polygon fill="black" stroke="black" points="18568.02,-2723.23 18575.77,-2716 18565.21,-2716.82 18568.02,-2723.23"/>
</g>
<!-- layer_2_... -->
<g id="node162" class="node">
<title>layer_2_...</title>
<polygon fill="lightgreen" stroke="black" points="18665.46,-4441.67 18127.84,-4441.67 17989.54,-4335.67 18527.16,-4335.67 18665.46,-4441.67"/>
<text text-anchor="middle" x="18327.5" y="-4399.97" font-family="Times,serif" font-size="14.00">Layer 2 (Same as Layer 0)</text>
<text text-anchor="middle" x="18327.5" y="-4384.97" font-family="Times,serif" font-size="14.00">16 partitions, 4 head groups × 4 dim slices</text>
<text text-anchor="middle" x="18327.5" y="-4369.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_3_... -->
<g id="node163" class="node">
<title>layer_3_...</title>
<polygon fill="lightgreen" stroke="black" points="19359.46,-4441.67 18821.84,-4441.67 18683.54,-4335.67 19221.16,-4335.67 19359.46,-4441.67"/>
<text text-anchor="middle" x="19021.5" y="-4399.97" font-family="Times,serif" font-size="14.00">Layer 3 (Same as Layer 0)</text>
<text text-anchor="middle" x="19021.5" y="-4384.97" font-family="Times,serif" font-size="14.00">16 partitions, 4 head groups × 4 dim slices</text>
<text text-anchor="middle" x="19021.5" y="-4369.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_4_... -->
<g id="node164" class="node">
<title>layer_4_...</title>
<polygon fill="lightgreen" stroke="black" points="20053.46,-4441.67 19515.84,-4441.67 19377.54,-4335.67 19915.16,-4335.67 20053.46,-4441.67"/>
<text text-anchor="middle" x="19715.5" y="-4399.97" font-family="Times,serif" font-size="14.00">Layer 4 (Same as Layer 0)</text>
<text text-anchor="middle" x="19715.5" y="-4384.97" font-family="Times,serif" font-size="14.00">16 partitions, 4 head groups × 4 dim slices</text>
<text text-anchor="middle" x="19715.5" y="-4369.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_5_... -->
<g id="node165" class="node">
<title>layer_5_...</title>
<polygon fill="lightgreen" stroke="black" points="20747.46,-4441.67 20209.84,-4441.67 20071.54,-4335.67 20609.16,-4335.67 20747.46,-4441.67"/>
<text text-anchor="middle" x="20409.5" y="-4399.97" font-family="Times,serif" font-size="14.00">Layer 5 (Same as Layer 0)</text>
<text text-anchor="middle" x="20409.5" y="-4384.97" font-family="Times,serif" font-size="14.00">16 partitions, 4 head groups × 4 dim slices</text>
<text text-anchor="middle" x="20409.5" y="-4369.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_6_... -->
<g id="node166" class="node">
<title>layer_6_...</title>
<polygon fill="lightgreen" stroke="black" points="21441.46,-4441.67 20903.84,-4441.67 20765.54,-4335.67 21303.16,-4335.67 21441.46,-4441.67"/>
<text text-anchor="middle" x="21103.5" y="-4399.97" font-family="Times,serif" font-size="14.00">Layer 6 (Same as Layer 0)</text>
<text text-anchor="middle" x="21103.5" y="-4384.97" font-family="Times,serif" font-size="14.00">16 partitions, 4 head groups × 4 dim slices</text>
<text text-anchor="middle" x="21103.5" y="-4369.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_7_... -->
<g id="node167" class="node">
<title>layer_7_...</title>
<polygon fill="lightgreen" stroke="black" points="22135.46,-4441.67 21597.84,-4441.67 21459.54,-4335.67 21997.16,-4335.67 22135.46,-4441.67"/>
<text text-anchor="middle" x="21797.5" y="-4399.97" font-family="Times,serif" font-size="14.00">Layer 7 (Same as Layer 0)</text>
<text text-anchor="middle" x="21797.5" y="-4384.97" font-family="Times,serif" font-size="14.00">16 partitions, 4 head groups × 4 dim slices</text>
<text text-anchor="middle" x="21797.5" y="-4369.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_8_... -->
<g id="node168" class="node">
<title>layer_8_...</title>
<polygon fill="lightgreen" stroke="black" points="22829.46,-4441.67 22291.84,-4441.67 22153.54,-4335.67 22691.16,-4335.67 22829.46,-4441.67"/>
<text text-anchor="middle" x="22491.5" y="-4399.97" font-family="Times,serif" font-size="14.00">Layer 8 (Same as Layer 0)</text>
<text text-anchor="middle" x="22491.5" y="-4384.97" font-family="Times,serif" font-size="14.00">16 partitions, 4 head groups × 4 dim slices</text>
<text text-anchor="middle" x="22491.5" y="-4369.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_9_... -->
<g id="node169" class="node">
<title>layer_9_...</title>
<polygon fill="lightgreen" stroke="black" points="23523.46,-4441.67 22985.84,-4441.67 22847.54,-4335.67 23385.16,-4335.67 23523.46,-4441.67"/>
<text text-anchor="middle" x="23185.5" y="-4399.97" font-family="Times,serif" font-size="14.00">Layer 9 (Same as Layer 0)</text>
<text text-anchor="middle" x="23185.5" y="-4384.97" font-family="Times,serif" font-size="14.00">16 partitions, 4 head groups × 4 dim slices</text>
<text text-anchor="middle" x="23185.5" y="-4369.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_10_... -->
<g id="node170" class="node">
<title>layer_10_...</title>
<polygon fill="lightgreen" stroke="black" points="24217.46,-4441.67 23679.84,-4441.67 23541.54,-4335.67 24079.16,-4335.67 24217.46,-4441.67"/>
<text text-anchor="middle" x="23879.5" y="-4399.97" font-family="Times,serif" font-size="14.00">Layer 10 (Same as Layer 0)</text>
<text text-anchor="middle" x="23879.5" y="-4384.97" font-family="Times,serif" font-size="14.00">16 partitions, 4 head groups × 4 dim slices</text>
<text text-anchor="middle" x="23879.5" y="-4369.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_11_... -->
<g id="node171" class="node">
<title>layer_11_...</title>
<polygon fill="lightgreen" stroke="black" points="24911.46,-4441.67 24373.84,-4441.67 24235.54,-4335.67 24773.16,-4335.67 24911.46,-4441.67"/>
<text text-anchor="middle" x="24573.5" y="-4399.97" font-family="Times,serif" font-size="14.00">Layer 11 (Same as Layer 0)</text>
<text text-anchor="middle" x="24573.5" y="-4384.97" font-family="Times,serif" font-size="14.00">16 partitions, 4 head groups × 4 dim slices</text>
<text text-anchor="middle" x="24573.5" y="-4369.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_12_... -->
<g id="node172" class="node">
<title>layer_12_...</title>
<polygon fill="lightgreen" stroke="black" points="25605.46,-4441.67 25067.84,-4441.67 24929.54,-4335.67 25467.16,-4335.67 25605.46,-4441.67"/>
<text text-anchor="middle" x="25267.5" y="-4399.97" font-family="Times,serif" font-size="14.00">Layer 12 (Same as Layer 0)</text>
<text text-anchor="middle" x="25267.5" y="-4384.97" font-family="Times,serif" font-size="14.00">16 partitions, 4 head groups × 4 dim slices</text>
<text text-anchor="middle" x="25267.5" y="-4369.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_13_... -->
<g id="node173" class="node">
<title>layer_13_...</title>
<polygon fill="lightgreen" stroke="black" points="26299.46,-4441.67 25761.84,-4441.67 25623.54,-4335.67 26161.16,-4335.67 26299.46,-4441.67"/>
<text text-anchor="middle" x="25961.5" y="-4399.97" font-family="Times,serif" font-size="14.00">Layer 13 (Same as Layer 0)</text>
<text text-anchor="middle" x="25961.5" y="-4384.97" font-family="Times,serif" font-size="14.00">16 partitions, 4 head groups × 4 dim slices</text>
<text text-anchor="middle" x="25961.5" y="-4369.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_14_... -->
<g id="node174" class="node">
<title>layer_14_...</title>
<polygon fill="lightgreen" stroke="black" points="26993.46,-4441.67 26455.84,-4441.67 26317.54,-4335.67 26855.16,-4335.67 26993.46,-4441.67"/>
<text text-anchor="middle" x="26655.5" y="-4399.97" font-family="Times,serif" font-size="14.00">Layer 14 (Same as Layer 0)</text>
<text text-anchor="middle" x="26655.5" y="-4384.97" font-family="Times,serif" font-size="14.00">16 partitions, 4 head groups × 4 dim slices</text>
<text text-anchor="middle" x="26655.5" y="-4369.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_15_... -->
<g id="node175" class="node">
<title>layer_15_...</title>
<polygon fill="lightgreen" stroke="black" points="27687.46,-4441.67 27149.84,-4441.67 27011.54,-4335.67 27549.16,-4335.67 27687.46,-4441.67"/>
<text text-anchor="middle" x="27349.5" y="-4399.97" font-family="Times,serif" font-size="14.00">Layer 15 (Same as Layer 0)</text>
<text text-anchor="middle" x="27349.5" y="-4384.97" font-family="Times,serif" font-size="14.00">16 partitions, 4 head groups × 4 dim slices</text>
<text text-anchor="middle" x="27349.5" y="-4369.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_2_ellipsis -->
<g id="node177" class="node">
<title>layer_2_ellipsis</title>
<polygon fill="lightgreen" stroke="black" points="18991.67,-2544 18573.03,-2544 18465.33,-2408 18883.97,-2408 18991.67,-2544"/>
<text text-anchor="middle" x="18728.5" y="-2494.8" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="18728.5" y="-2479.8" font-family="Times,serif" font-size="14.00">(Same partitioning as Layer 0)</text>
<text text-anchor="middle" x="18728.5" y="-2464.8" font-family="Times,serif" font-size="14.00">16 partitions, hierarchical concat</text>
<text text-anchor="middle" x="18728.5" y="-2449.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_1_ellipsis&#45;&gt;layer_2_ellipsis -->
<g id="edge195" class="edge">
<title>layer_1_ellipsis&#45;&gt;layer_2_ellipsis</title>
<path fill="none" stroke="black" d="M18728.5,-2579.81C18728.5,-2571.5 18728.5,-2562.95 18728.5,-2554.49"/>
<polygon fill="black" stroke="black" points="18732,-2554.26 18728.5,-2544.26 18725,-2554.26 18732,-2554.26"/>
</g>
<!-- layer_3_ellipsis -->
<g id="node178" class="node">
<title>layer_3_ellipsis</title>
<polygon fill="lightgreen" stroke="black" points="18991.67,-2372 18573.03,-2372 18465.33,-2236 18883.97,-2236 18991.67,-2372"/>
<text text-anchor="middle" x="18728.5" y="-2322.8" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="18728.5" y="-2307.8" font-family="Times,serif" font-size="14.00">(Same partitioning as Layer 0)</text>
<text text-anchor="middle" x="18728.5" y="-2292.8" font-family="Times,serif" font-size="14.00">16 partitions, hierarchical concat</text>
<text text-anchor="middle" x="18728.5" y="-2277.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_2_ellipsis&#45;&gt;layer_3_ellipsis -->
<g id="edge196" class="edge">
<title>layer_2_ellipsis&#45;&gt;layer_3_ellipsis</title>
<path fill="none" stroke="black" d="M18728.5,-2407.81C18728.5,-2399.5 18728.5,-2390.95 18728.5,-2382.49"/>
<polygon fill="black" stroke="black" points="18732,-2382.26 18728.5,-2372.26 18725,-2382.26 18732,-2382.26"/>
</g>
<!-- layer_4_ellipsis -->
<g id="node179" class="node">
<title>layer_4_ellipsis</title>
<polygon fill="lightgreen" stroke="black" points="18991.67,-2200 18573.03,-2200 18465.33,-2064 18883.97,-2064 18991.67,-2200"/>
<text text-anchor="middle" x="18728.5" y="-2150.8" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="18728.5" y="-2135.8" font-family="Times,serif" font-size="14.00">(Same partitioning as Layer 0)</text>
<text text-anchor="middle" x="18728.5" y="-2120.8" font-family="Times,serif" font-size="14.00">16 partitions, hierarchical concat</text>
<text text-anchor="middle" x="18728.5" y="-2105.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_3_ellipsis&#45;&gt;layer_4_ellipsis -->
<g id="edge197" class="edge">
<title>layer_3_ellipsis&#45;&gt;layer_4_ellipsis</title>
<path fill="none" stroke="black" d="M18728.5,-2235.81C18728.5,-2227.5 18728.5,-2218.95 18728.5,-2210.49"/>
<polygon fill="black" stroke="black" points="18732,-2210.26 18728.5,-2200.26 18725,-2210.26 18732,-2210.26"/>
</g>
<!-- layer_5_ellipsis -->
<g id="node180" class="node">
<title>layer_5_ellipsis</title>
<polygon fill="lightgreen" stroke="black" points="18991.67,-2028 18573.03,-2028 18465.33,-1892 18883.97,-1892 18991.67,-2028"/>
<text text-anchor="middle" x="18728.5" y="-1978.8" font-family="Times,serif" font-size="14.00">Layer 5</text>
<text text-anchor="middle" x="18728.5" y="-1963.8" font-family="Times,serif" font-size="14.00">(Same partitioning as Layer 0)</text>
<text text-anchor="middle" x="18728.5" y="-1948.8" font-family="Times,serif" font-size="14.00">16 partitions, hierarchical concat</text>
<text text-anchor="middle" x="18728.5" y="-1933.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_4_ellipsis&#45;&gt;layer_5_ellipsis -->
<g id="edge198" class="edge">
<title>layer_4_ellipsis&#45;&gt;layer_5_ellipsis</title>
<path fill="none" stroke="black" d="M18728.5,-2063.81C18728.5,-2055.5 18728.5,-2046.95 18728.5,-2038.49"/>
<polygon fill="black" stroke="black" points="18732,-2038.26 18728.5,-2028.26 18725,-2038.26 18732,-2038.26"/>
</g>
<!-- layer_6_ellipsis -->
<g id="node181" class="node">
<title>layer_6_ellipsis</title>
<polygon fill="lightgreen" stroke="black" points="18991.67,-1856 18573.03,-1856 18465.33,-1720 18883.97,-1720 18991.67,-1856"/>
<text text-anchor="middle" x="18728.5" y="-1806.8" font-family="Times,serif" font-size="14.00">Layer 6</text>
<text text-anchor="middle" x="18728.5" y="-1791.8" font-family="Times,serif" font-size="14.00">(Same partitioning as Layer 0)</text>
<text text-anchor="middle" x="18728.5" y="-1776.8" font-family="Times,serif" font-size="14.00">16 partitions, hierarchical concat</text>
<text text-anchor="middle" x="18728.5" y="-1761.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_5_ellipsis&#45;&gt;layer_6_ellipsis -->
<g id="edge199" class="edge">
<title>layer_5_ellipsis&#45;&gt;layer_6_ellipsis</title>
<path fill="none" stroke="black" d="M18728.5,-1891.81C18728.5,-1883.5 18728.5,-1874.95 18728.5,-1866.49"/>
<polygon fill="black" stroke="black" points="18732,-1866.26 18728.5,-1856.26 18725,-1866.26 18732,-1866.26"/>
</g>
<!-- layer_7_ellipsis -->
<g id="node182" class="node">
<title>layer_7_ellipsis</title>
<polygon fill="lightgreen" stroke="black" points="18991.67,-1684 18573.03,-1684 18465.33,-1548 18883.97,-1548 18991.67,-1684"/>
<text text-anchor="middle" x="18728.5" y="-1634.8" font-family="Times,serif" font-size="14.00">Layer 7</text>
<text text-anchor="middle" x="18728.5" y="-1619.8" font-family="Times,serif" font-size="14.00">(Same partitioning as Layer 0)</text>
<text text-anchor="middle" x="18728.5" y="-1604.8" font-family="Times,serif" font-size="14.00">16 partitions, hierarchical concat</text>
<text text-anchor="middle" x="18728.5" y="-1589.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_6_ellipsis&#45;&gt;layer_7_ellipsis -->
<g id="edge200" class="edge">
<title>layer_6_ellipsis&#45;&gt;layer_7_ellipsis</title>
<path fill="none" stroke="black" d="M18728.5,-1719.81C18728.5,-1711.5 18728.5,-1702.95 18728.5,-1694.49"/>
<polygon fill="black" stroke="black" points="18732,-1694.26 18728.5,-1684.26 18725,-1694.26 18732,-1694.26"/>
</g>
<!-- layer_8_ellipsis -->
<g id="node183" class="node">
<title>layer_8_ellipsis</title>
<polygon fill="lightgreen" stroke="black" points="18991.67,-1512 18573.03,-1512 18465.33,-1376 18883.97,-1376 18991.67,-1512"/>
<text text-anchor="middle" x="18728.5" y="-1462.8" font-family="Times,serif" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="18728.5" y="-1447.8" font-family="Times,serif" font-size="14.00">(Same partitioning as Layer 0)</text>
<text text-anchor="middle" x="18728.5" y="-1432.8" font-family="Times,serif" font-size="14.00">16 partitions, hierarchical concat</text>
<text text-anchor="middle" x="18728.5" y="-1417.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_7_ellipsis&#45;&gt;layer_8_ellipsis -->
<g id="edge201" class="edge">
<title>layer_7_ellipsis&#45;&gt;layer_8_ellipsis</title>
<path fill="none" stroke="black" d="M18728.5,-1547.81C18728.5,-1539.5 18728.5,-1530.95 18728.5,-1522.49"/>
<polygon fill="black" stroke="black" points="18732,-1522.26 18728.5,-1512.26 18725,-1522.26 18732,-1522.26"/>
</g>
<!-- layer_9_ellipsis -->
<g id="node184" class="node">
<title>layer_9_ellipsis</title>
<polygon fill="lightgreen" stroke="black" points="18991.67,-1340 18573.03,-1340 18465.33,-1204 18883.97,-1204 18991.67,-1340"/>
<text text-anchor="middle" x="18728.5" y="-1290.8" font-family="Times,serif" font-size="14.00">Layer 9</text>
<text text-anchor="middle" x="18728.5" y="-1275.8" font-family="Times,serif" font-size="14.00">(Same partitioning as Layer 0)</text>
<text text-anchor="middle" x="18728.5" y="-1260.8" font-family="Times,serif" font-size="14.00">16 partitions, hierarchical concat</text>
<text text-anchor="middle" x="18728.5" y="-1245.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_8_ellipsis&#45;&gt;layer_9_ellipsis -->
<g id="edge202" class="edge">
<title>layer_8_ellipsis&#45;&gt;layer_9_ellipsis</title>
<path fill="none" stroke="black" d="M18728.5,-1375.81C18728.5,-1367.5 18728.5,-1358.95 18728.5,-1350.49"/>
<polygon fill="black" stroke="black" points="18732,-1350.26 18728.5,-1340.26 18725,-1350.26 18732,-1350.26"/>
</g>
<!-- layer_10_ellipsis -->
<g id="node185" class="node">
<title>layer_10_ellipsis</title>
<polygon fill="lightgreen" stroke="black" points="18991.67,-1168 18573.03,-1168 18465.33,-1032 18883.97,-1032 18991.67,-1168"/>
<text text-anchor="middle" x="18728.5" y="-1118.8" font-family="Times,serif" font-size="14.00">Layer 10</text>
<text text-anchor="middle" x="18728.5" y="-1103.8" font-family="Times,serif" font-size="14.00">(Same partitioning as Layer 0)</text>
<text text-anchor="middle" x="18728.5" y="-1088.8" font-family="Times,serif" font-size="14.00">16 partitions, hierarchical concat</text>
<text text-anchor="middle" x="18728.5" y="-1073.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_9_ellipsis&#45;&gt;layer_10_ellipsis -->
<g id="edge203" class="edge">
<title>layer_9_ellipsis&#45;&gt;layer_10_ellipsis</title>
<path fill="none" stroke="black" d="M18728.5,-1203.81C18728.5,-1195.5 18728.5,-1186.95 18728.5,-1178.49"/>
<polygon fill="black" stroke="black" points="18732,-1178.26 18728.5,-1168.26 18725,-1178.26 18732,-1178.26"/>
</g>
<!-- layer_11_ellipsis -->
<g id="node186" class="node">
<title>layer_11_ellipsis</title>
<polygon fill="lightgreen" stroke="black" points="18991.67,-996 18573.03,-996 18465.33,-860 18883.97,-860 18991.67,-996"/>
<text text-anchor="middle" x="18728.5" y="-946.8" font-family="Times,serif" font-size="14.00">Layer 11</text>
<text text-anchor="middle" x="18728.5" y="-931.8" font-family="Times,serif" font-size="14.00">(Same partitioning as Layer 0)</text>
<text text-anchor="middle" x="18728.5" y="-916.8" font-family="Times,serif" font-size="14.00">16 partitions, hierarchical concat</text>
<text text-anchor="middle" x="18728.5" y="-901.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_10_ellipsis&#45;&gt;layer_11_ellipsis -->
<g id="edge204" class="edge">
<title>layer_10_ellipsis&#45;&gt;layer_11_ellipsis</title>
<path fill="none" stroke="black" d="M18728.5,-1031.81C18728.5,-1023.5 18728.5,-1014.95 18728.5,-1006.49"/>
<polygon fill="black" stroke="black" points="18732,-1006.26 18728.5,-996.26 18725,-1006.26 18732,-1006.26"/>
</g>
<!-- layer_12_ellipsis -->
<g id="node187" class="node">
<title>layer_12_ellipsis</title>
<polygon fill="lightgreen" stroke="black" points="18991.67,-824 18573.03,-824 18465.33,-688 18883.97,-688 18991.67,-824"/>
<text text-anchor="middle" x="18728.5" y="-774.8" font-family="Times,serif" font-size="14.00">Layer 12</text>
<text text-anchor="middle" x="18728.5" y="-759.8" font-family="Times,serif" font-size="14.00">(Same partitioning as Layer 0)</text>
<text text-anchor="middle" x="18728.5" y="-744.8" font-family="Times,serif" font-size="14.00">16 partitions, hierarchical concat</text>
<text text-anchor="middle" x="18728.5" y="-729.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_11_ellipsis&#45;&gt;layer_12_ellipsis -->
<g id="edge205" class="edge">
<title>layer_11_ellipsis&#45;&gt;layer_12_ellipsis</title>
<path fill="none" stroke="black" d="M18728.5,-859.81C18728.5,-851.5 18728.5,-842.95 18728.5,-834.49"/>
<polygon fill="black" stroke="black" points="18732,-834.26 18728.5,-824.26 18725,-834.26 18732,-834.26"/>
</g>
<!-- layer_13_ellipsis -->
<g id="node188" class="node">
<title>layer_13_ellipsis</title>
<polygon fill="lightgreen" stroke="black" points="18991.67,-652 18573.03,-652 18465.33,-516 18883.97,-516 18991.67,-652"/>
<text text-anchor="middle" x="18728.5" y="-602.8" font-family="Times,serif" font-size="14.00">Layer 13</text>
<text text-anchor="middle" x="18728.5" y="-587.8" font-family="Times,serif" font-size="14.00">(Same partitioning as Layer 0)</text>
<text text-anchor="middle" x="18728.5" y="-572.8" font-family="Times,serif" font-size="14.00">16 partitions, hierarchical concat</text>
<text text-anchor="middle" x="18728.5" y="-557.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_12_ellipsis&#45;&gt;layer_13_ellipsis -->
<g id="edge206" class="edge">
<title>layer_12_ellipsis&#45;&gt;layer_13_ellipsis</title>
<path fill="none" stroke="black" d="M18728.5,-687.81C18728.5,-679.5 18728.5,-670.95 18728.5,-662.49"/>
<polygon fill="black" stroke="black" points="18732,-662.26 18728.5,-652.26 18725,-662.26 18732,-662.26"/>
</g>
<!-- layer_14_ellipsis -->
<g id="node189" class="node">
<title>layer_14_ellipsis</title>
<polygon fill="lightgreen" stroke="black" points="18991.67,-480 18573.03,-480 18465.33,-344 18883.97,-344 18991.67,-480"/>
<text text-anchor="middle" x="18728.5" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 14</text>
<text text-anchor="middle" x="18728.5" y="-415.8" font-family="Times,serif" font-size="14.00">(Same partitioning as Layer 0)</text>
<text text-anchor="middle" x="18728.5" y="-400.8" font-family="Times,serif" font-size="14.00">16 partitions, hierarchical concat</text>
<text text-anchor="middle" x="18728.5" y="-385.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_13_ellipsis&#45;&gt;layer_14_ellipsis -->
<g id="edge207" class="edge">
<title>layer_13_ellipsis&#45;&gt;layer_14_ellipsis</title>
<path fill="none" stroke="black" d="M18728.5,-515.81C18728.5,-507.5 18728.5,-498.95 18728.5,-490.49"/>
<polygon fill="black" stroke="black" points="18732,-490.26 18728.5,-480.26 18725,-490.26 18732,-490.26"/>
</g>
<!-- layer_15_ellipsis -->
<g id="node190" class="node">
<title>layer_15_ellipsis</title>
<polygon fill="lightgreen" stroke="black" points="18991.67,-308 18573.03,-308 18465.33,-172 18883.97,-172 18991.67,-308"/>
<text text-anchor="middle" x="18728.5" y="-258.8" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="18728.5" y="-243.8" font-family="Times,serif" font-size="14.00">(Same partitioning as Layer 0)</text>
<text text-anchor="middle" x="18728.5" y="-228.8" font-family="Times,serif" font-size="14.00">16 partitions, hierarchical concat</text>
<text text-anchor="middle" x="18728.5" y="-213.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_14_ellipsis&#45;&gt;layer_15_ellipsis -->
<g id="edge208" class="edge">
<title>layer_14_ellipsis&#45;&gt;layer_15_ellipsis</title>
<path fill="none" stroke="black" d="M18728.5,-343.81C18728.5,-335.5 18728.5,-326.95 18728.5,-318.49"/>
<polygon fill="black" stroke="black" points="18732,-318.26 18728.5,-308.26 18725,-318.26 18732,-318.26"/>
</g>
<!-- final_output -->
<g id="node191" class="node">
<title>final_output</title>
<polygon fill="lightgreen" stroke="black" points="19204.24,-136 18447.44,-136 18252.76,0 19009.56,0 19204.24,-136"/>
<text text-anchor="middle" x="18728.5" y="-86.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="18728.5" y="-71.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="18728.5" y="-56.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="18728.5" y="-41.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- layer_15_ellipsis&#45;&gt;final_output -->
<g id="edge209" class="edge">
<title>layer_15_ellipsis&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M18728.5,-171.81C18728.5,-163.5 18728.5,-154.95 18728.5,-146.49"/>
<polygon fill="black" stroke="black" points="18732,-146.26 18728.5,-136.26 18725,-146.26 18732,-146.26"/>
</g>
</g>
</svg>
