<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="39763pt" height="1083pt"
 viewBox="0.00 0.00 39763.01 1082.97" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1078.97)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1078.97 39759.01,-1078.97 39759.01,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="455.01" cy="-1011.97" rx="101.23" ry="28.98"/>
<text text-anchor="middle" x="455.01" y="-1020.47" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="455.01" y="-1009.47" font-family="Arial" font-size="10.00">Batch: [128, 1024, 1024]</text>
<text text-anchor="middle" x="455.01" y="-998.47" font-family="Arial" font-size="10.00">Seq_len=1024, Hidden=1024</text>
</g>
<!-- dp_split -->
<g id="node2" class="node">
<title>dp_split</title>
<polygon fill="lightyellow" stroke="black" points="561,-912.97 392.38,-912.97 349.01,-852.97 517.63,-852.97 561,-912.97"/>
<text text-anchor="middle" x="455.01" y="-885.97" font-family="Arial" font-size="10.00">DP Split</text>
<text text-anchor="middle" x="455.01" y="-874.97" font-family="Arial" font-size="10.00">2&#45;way Data Parallel</text>
</g>
<!-- input&#45;&gt;dp_split -->
<g id="edge1" class="edge">
<title>input&#45;&gt;dp_split</title>
<path fill="none" stroke="black" d="M455.01,-982.69C455.01,-982.69 455.01,-923.02 455.01,-923.02"/>
<polygon fill="black" stroke="black" points="458.51,-923.02 455.01,-913.02 451.51,-923.02 458.51,-923.02"/>
</g>
<!-- attn_qkv_s0_l0_gpu0 -->
<g id="node3" class="node">
<title>attn_qkv_s0_l0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="442.51,-816.97 331.51,-816.97 331.51,-753.97 442.51,-753.97 442.51,-816.97"/>
<text text-anchor="middle" x="387.01" y="-804.97" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="387.01" y="-793.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="387.01" y="-782.97" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="387.01" y="-771.97" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="387.01" y="-760.97" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- dp_split&#45;&gt;attn_qkv_s0_l0_gpu0 -->
<g id="edge2" class="edge">
<title>dp_split&#45;&gt;attn_qkv_s0_l0_gpu0</title>
<path fill="none" stroke="black" d="M395.88,-852.92C395.88,-852.92 395.88,-827.27 395.88,-827.27"/>
<polygon fill="black" stroke="black" points="399.38,-827.27 395.88,-817.27 392.38,-827.27 399.38,-827.27"/>
</g>
<!-- attn_qkv_s0_l0_gpu1 -->
<g id="node7" class="node">
<title>attn_qkv_s0_l0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="575.51,-816.97 464.51,-816.97 464.51,-753.97 575.51,-753.97 575.51,-816.97"/>
<text text-anchor="middle" x="520.01" y="-804.97" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="520.01" y="-793.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="520.01" y="-782.97" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="520.01" y="-771.97" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="520.01" y="-760.97" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- dp_split&#45;&gt;attn_qkv_s0_l0_gpu1 -->
<g id="edge3" class="edge">
<title>dp_split&#45;&gt;attn_qkv_s0_l0_gpu1</title>
<path fill="none" stroke="black" d="M512.63,-852.92C512.63,-852.92 512.63,-827.27 512.63,-827.27"/>
<polygon fill="black" stroke="black" points="516.13,-827.27 512.63,-817.27 509.13,-827.27 516.13,-827.27"/>
</g>
<!-- attn_score_s0_l0_gpu0 -->
<g id="node4" class="node">
<title>attn_score_s0_l0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="442.51,-717.97 317.51,-717.97 317.51,-665.97 442.51,-665.97 442.51,-717.97"/>
<text text-anchor="middle" x="380.01" y="-705.97" font-family="Arial" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="380.01" y="-694.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="380.01" y="-683.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,64]</text>
<text text-anchor="middle" x="380.01" y="-672.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_qkv_s0_l0_gpu0&#45;&gt;attn_score_s0_l0_gpu0 -->
<g id="edge4" class="edge">
<title>attn_qkv_s0_l0_gpu0&#45;&gt;attn_score_s0_l0_gpu0</title>
<path fill="none" stroke="black" d="M387.01,-753.81C387.01,-753.81 387.01,-727.99 387.01,-727.99"/>
<polygon fill="black" stroke="black" points="390.51,-727.99 387.01,-717.99 383.51,-727.99 390.51,-727.99"/>
</g>
<!-- attn_softmax_s0_l0_gpu0 -->
<g id="node5" class="node">
<title>attn_softmax_s0_l0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="442.51,-629.97 317.51,-629.97 317.51,-577.97 442.51,-577.97 442.51,-629.97"/>
<text text-anchor="middle" x="380.01" y="-617.97" font-family="Arial" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="380.01" y="-606.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="380.01" y="-595.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,1024]</text>
<text text-anchor="middle" x="380.01" y="-584.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_score_s0_l0_gpu0&#45;&gt;attn_softmax_s0_l0_gpu0 -->
<g id="edge5" class="edge">
<title>attn_score_s0_l0_gpu0&#45;&gt;attn_softmax_s0_l0_gpu0</title>
<path fill="none" stroke="black" d="M380.01,-665.56C380.01,-665.56 380.01,-640.05 380.01,-640.05"/>
<polygon fill="black" stroke="black" points="383.51,-640.05 380.01,-630.05 376.51,-640.05 383.51,-640.05"/>
</g>
<!-- attn_out_s0_l0_gpu0 -->
<g id="node6" class="node">
<title>attn_out_s0_l0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="442.01,-541.97 326.01,-541.97 326.01,-489.97 442.01,-489.97 442.01,-541.97"/>
<text text-anchor="middle" x="384.01" y="-529.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="384.01" y="-518.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="384.01" y="-507.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="384.01" y="-496.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_softmax_s0_l0_gpu0&#45;&gt;attn_out_s0_l0_gpu0 -->
<g id="edge6" class="edge">
<title>attn_softmax_s0_l0_gpu0&#45;&gt;attn_out_s0_l0_gpu0</title>
<path fill="none" stroke="black" d="M384.01,-577.56C384.01,-577.56 384.01,-552.05 384.01,-552.05"/>
<polygon fill="black" stroke="black" points="387.51,-552.05 384.01,-542.05 380.51,-552.05 387.51,-552.05"/>
</g>
<!-- attn_allreduce_s0_l0 -->
<g id="node11" class="node">
<title>attn_allreduce_s0_l0</title>
<ellipse fill="lightcoral" stroke="black" cx="451.01" cy="-424.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="451.01" y="-433.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="451.01" y="-422.47" font-family="Arial" font-size="10.00">TP Group 0,1</text>
<text text-anchor="middle" x="451.01" y="-411.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- attn_out_s0_l0_gpu0&#45;&gt;attn_allreduce_s0_l0 -->
<g id="edge10" class="edge">
<title>attn_out_s0_l0_gpu0&#45;&gt;attn_allreduce_s0_l0</title>
<path fill="none" stroke="black" d="M417.87,-489.65C417.87,-489.65 417.87,-458.75 417.87,-458.75"/>
<polygon fill="black" stroke="black" points="421.37,-458.75 417.87,-448.75 414.37,-458.75 421.37,-458.75"/>
</g>
<!-- attn_score_s0_l0_gpu1 -->
<g id="node8" class="node">
<title>attn_score_s0_l0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="585.51,-717.97 460.51,-717.97 460.51,-665.97 585.51,-665.97 585.51,-717.97"/>
<text text-anchor="middle" x="523.01" y="-705.97" font-family="Arial" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="523.01" y="-694.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="523.01" y="-683.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,64]</text>
<text text-anchor="middle" x="523.01" y="-672.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_qkv_s0_l0_gpu1&#45;&gt;attn_score_s0_l0_gpu1 -->
<g id="edge7" class="edge">
<title>attn_qkv_s0_l0_gpu1&#45;&gt;attn_score_s0_l0_gpu1</title>
<path fill="none" stroke="black" d="M520.01,-753.81C520.01,-753.81 520.01,-727.99 520.01,-727.99"/>
<polygon fill="black" stroke="black" points="523.51,-727.99 520.01,-717.99 516.51,-727.99 523.51,-727.99"/>
</g>
<!-- attn_softmax_s0_l0_gpu1 -->
<g id="node9" class="node">
<title>attn_softmax_s0_l0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="585.51,-629.97 460.51,-629.97 460.51,-577.97 585.51,-577.97 585.51,-629.97"/>
<text text-anchor="middle" x="523.01" y="-617.97" font-family="Arial" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="523.01" y="-606.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="523.01" y="-595.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,1024]</text>
<text text-anchor="middle" x="523.01" y="-584.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_score_s0_l0_gpu1&#45;&gt;attn_softmax_s0_l0_gpu1 -->
<g id="edge8" class="edge">
<title>attn_score_s0_l0_gpu1&#45;&gt;attn_softmax_s0_l0_gpu1</title>
<path fill="none" stroke="black" d="M523.01,-665.56C523.01,-665.56 523.01,-640.05 523.01,-640.05"/>
<polygon fill="black" stroke="black" points="526.51,-640.05 523.01,-630.05 519.51,-640.05 526.51,-640.05"/>
</g>
<!-- attn_out_s0_l0_gpu1 -->
<g id="node10" class="node">
<title>attn_out_s0_l0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="578.01,-541.97 462.01,-541.97 462.01,-489.97 578.01,-489.97 578.01,-541.97"/>
<text text-anchor="middle" x="520.01" y="-529.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="520.01" y="-518.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="520.01" y="-507.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="520.01" y="-496.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_softmax_s0_l0_gpu1&#45;&gt;attn_out_s0_l0_gpu1 -->
<g id="edge9" class="edge">
<title>attn_softmax_s0_l0_gpu1&#45;&gt;attn_out_s0_l0_gpu1</title>
<path fill="none" stroke="black" d="M520.01,-577.56C520.01,-577.56 520.01,-552.05 520.01,-552.05"/>
<polygon fill="black" stroke="black" points="523.51,-552.05 520.01,-542.05 516.51,-552.05 523.51,-552.05"/>
</g>
<!-- attn_out_s0_l0_gpu1&#45;&gt;attn_allreduce_s0_l0 -->
<g id="edge11" class="edge">
<title>attn_out_s0_l0_gpu1&#45;&gt;attn_allreduce_s0_l0</title>
<path fill="none" stroke="black" d="M485.14,-489.65C485.14,-489.65 485.14,-458.44 485.14,-458.44"/>
<polygon fill="black" stroke="black" points="488.64,-458.44 485.14,-448.44 481.64,-458.44 488.64,-458.44"/>
</g>
<!-- gate_s0_l0_gpu0 -->
<g id="node12" class="node">
<title>gate_s0_l0_gpu0</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="226.02,-359.98 46.24,-359.98 -0.01,-233.98 179.77,-233.98 226.02,-359.98"/>
<text text-anchor="middle" x="113.01" y="-316.48" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="113.01" y="-305.48" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="113.01" y="-294.48" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="113.01" y="-283.48" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="113.01" y="-272.48" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- attn_allreduce_s0_l0&#45;&gt;gate_s0_l0_gpu0 -->
<g id="edge12" class="edge">
<title>attn_allreduce_s0_l0&#45;&gt;gate_s0_l0_gpu0</title>
<path fill="none" stroke="black" d="M393.67,-424C297.24,-424 113.01,-424 113.01,-424 113.01,-424 113.01,-370.12 113.01,-370.12"/>
<polygon fill="black" stroke="black" points="116.51,-370.12 113.01,-360.12 109.51,-370.12 116.51,-370.12"/>
</g>
<!-- gate_s0_l0_gpu1 -->
<g id="node13" class="node">
<title>gate_s0_l0_gpu1</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="470.02,-359.98 290.24,-359.98 243.99,-233.98 423.77,-233.98 470.02,-359.98"/>
<text text-anchor="middle" x="357.01" y="-316.48" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="357.01" y="-305.48" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="357.01" y="-294.48" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="357.01" y="-283.48" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="357.01" y="-272.48" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- attn_allreduce_s0_l0&#45;&gt;gate_s0_l0_gpu1 -->
<g id="edge13" class="edge">
<title>attn_allreduce_s0_l0&#45;&gt;gate_s0_l0_gpu1</title>
<path fill="none" stroke="black" d="M431.87,-397.52C431.87,-397.52 431.87,-370.16 431.87,-370.16"/>
<polygon fill="black" stroke="black" points="435.37,-370.16 431.87,-360.16 428.37,-370.16 435.37,-370.16"/>
</g>
<!-- expert_s0_l0_gpu0 -->
<g id="node14" class="node">
<title>expert_s0_l0_gpu0</title>
<polygon fill="lightblue" stroke="black" points="604.01,-328.48 488.01,-328.48 488.01,-265.48 604.01,-265.48 604.01,-328.48"/>
<text text-anchor="middle" x="546.01" y="-316.48" font-family="Arial" font-size="10.00">MoE Experts 0&#45;15</text>
<text text-anchor="middle" x="546.01" y="-305.48" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="546.01" y="-294.48" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="546.01" y="-283.48" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="546.01" y="-272.48" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- attn_allreduce_s0_l0&#45;&gt;expert_s0_l0_gpu0 -->
<g id="edge14" class="edge">
<title>attn_allreduce_s0_l0&#45;&gt;expert_s0_l0_gpu0</title>
<path fill="none" stroke="black" d="M498.14,-408.5C498.14,-408.5 498.14,-338.6 498.14,-338.6"/>
<polygon fill="black" stroke="black" points="501.64,-338.6 498.14,-328.6 494.64,-338.6 501.64,-338.6"/>
</g>
<!-- expert_s0_l0_gpu1 -->
<g id="node15" class="node">
<title>expert_s0_l0_gpu1</title>
<polygon fill="lightblue" stroke="black" points="738.01,-328.48 622.01,-328.48 622.01,-265.48 738.01,-265.48 738.01,-328.48"/>
<text text-anchor="middle" x="680.01" y="-316.48" font-family="Arial" font-size="10.00">MoE Experts 16&#45;31</text>
<text text-anchor="middle" x="680.01" y="-305.48" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="680.01" y="-294.48" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="680.01" y="-283.48" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="680.01" y="-272.48" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- attn_allreduce_s0_l0&#45;&gt;expert_s0_l0_gpu1 -->
<g id="edge15" class="edge">
<title>attn_allreduce_s0_l0&#45;&gt;expert_s0_l0_gpu1</title>
<path fill="none" stroke="black" d="M508.29,-424C568.25,-424 653.76,-424 653.76,-424 653.76,-424 653.76,-338.71 653.76,-338.71"/>
<polygon fill="black" stroke="black" points="657.26,-338.71 653.76,-328.71 650.26,-338.71 657.26,-338.71"/>
</g>
<!-- all2all_s0_l0_gpu01 -->
<g id="node16" class="node">
<title>all2all_s0_l0_gpu01</title>
<ellipse fill="lightcoral" stroke="black" cx="451.01" cy="-168.99" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="451.01" y="-177.49" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="451.01" y="-166.49" font-family="Arial" font-size="10.00">EP GPUs 0,1</text>
<text text-anchor="middle" x="451.01" y="-155.49" font-family="Arial" font-size="10.00">Token routing</text>
</g>
<!-- gate_s0_l0_gpu0&#45;&gt;all2all_s0_l0_gpu01 -->
<g id="edge16" class="edge">
<title>gate_s0_l0_gpu0&#45;&gt;all2all_s0_l0_gpu01</title>
<path fill="none" stroke="black" d="M213.88,-296.89C213.88,-292.98 213.88,-168 213.88,-168 213.88,-168 386.31,-168 386.31,-168"/>
<polygon fill="black" stroke="black" points="386.31,-171.5 396.31,-168 386.31,-164.5 386.31,-171.5"/>
</g>
<!-- gate_s0_l0_gpu1&#45;&gt;all2all_s0_l0_gpu01 -->
<g id="edge17" class="edge">
<title>gate_s0_l0_gpu1&#45;&gt;all2all_s0_l0_gpu01</title>
<path fill="none" stroke="black" d="M433.29,-259.62C433.29,-259.62 433.29,-206.43 433.29,-206.43"/>
<polygon fill="black" stroke="black" points="436.79,-206.43 433.29,-196.43 429.79,-206.43 436.79,-206.43"/>
</g>
<!-- expert_s0_l0_gpu0&#45;&gt;all2all_s0_l0_gpu01 -->
<g id="edge18" class="edge">
<title>expert_s0_l0_gpu0&#45;&gt;all2all_s0_l0_gpu01</title>
<path fill="none" stroke="black" d="M496.73,-265.34C496.73,-265.34 496.73,-194.73 496.73,-194.73"/>
<polygon fill="black" stroke="black" points="500.23,-194.73 496.73,-184.73 493.23,-194.73 500.23,-194.73"/>
</g>
<!-- expert_s0_l0_gpu1&#45;&gt;all2all_s0_l0_gpu01 -->
<g id="edge19" class="edge">
<title>expert_s0_l0_gpu1&#45;&gt;all2all_s0_l0_gpu01</title>
<path fill="none" stroke="black" d="M661.64,-265.43C661.64,-227.24 661.64,-168 661.64,-168 661.64,-168 515.52,-168 515.52,-168"/>
<polygon fill="black" stroke="black" points="515.52,-164.5 505.52,-168 515.52,-171.5 515.52,-164.5"/>
</g>
<!-- moe_agg_s0_l0_gpu0 -->
<g id="node17" class="node">
<title>moe_agg_s0_l0_gpu0</title>
<polygon fill="orange" stroke="black" points="442.03,-104 251.1,-104 201.98,0 392.92,0 442.03,-104"/>
<text text-anchor="middle" x="322.01" y="-66" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="322.01" y="-55" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="322.01" y="-44" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="322.01" y="-33" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- all2all_s0_l0_gpu01&#45;&gt;moe_agg_s0_l0_gpu0 -->
<g id="edge20" class="edge">
<title>all2all_s0_l0_gpu01&#45;&gt;moe_agg_s0_l0_gpu0</title>
<path fill="none" stroke="black" d="M419.41,-145.32C419.41,-145.32 419.41,-114.15 419.41,-114.15"/>
<polygon fill="black" stroke="black" points="422.91,-114.15 419.41,-104.15 415.91,-114.15 422.91,-114.15"/>
</g>
<!-- moe_agg_s0_l0_gpu1 -->
<g id="node18" class="node">
<title>moe_agg_s0_l0_gpu1</title>
<polygon fill="orange" stroke="black" points="701.03,-104 510.1,-104 460.98,0 651.92,0 701.03,-104"/>
<text text-anchor="middle" x="581.01" y="-66" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="581.01" y="-55" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="581.01" y="-44" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="581.01" y="-33" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- all2all_s0_l0_gpu01&#45;&gt;moe_agg_s0_l0_gpu1 -->
<g id="edge21" class="edge">
<title>all2all_s0_l0_gpu01&#45;&gt;moe_agg_s0_l0_gpu1</title>
<path fill="none" stroke="black" d="M483.1,-145.32C483.1,-145.32 483.1,-62.04 483.1,-62.04"/>
<polygon fill="black" stroke="black" points="486.6,-62.04 483.1,-52.04 479.6,-62.04 486.6,-62.04"/>
</g>
<!-- attn_qkv_s0_l1_gpu0 -->
<g id="node19" class="node">
<title>attn_qkv_s0_l1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="685.51,-1043.47 574.51,-1043.47 574.51,-980.47 685.51,-980.47 685.51,-1043.47"/>
<text text-anchor="middle" x="630.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="630.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="630.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="630.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="630.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_score_s0_l1_gpu0 -->
<g id="node20" class="node">
<title>attn_score_s0_l1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="828.51,-1037.97 703.51,-1037.97 703.51,-985.97 828.51,-985.97 828.51,-1037.97"/>
<text text-anchor="middle" x="766.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="766.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="766.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,64]</text>
<text text-anchor="middle" x="766.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_softmax_s0_l1_gpu0 -->
<g id="node21" class="node">
<title>attn_softmax_s0_l1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="971.51,-1037.97 846.51,-1037.97 846.51,-985.97 971.51,-985.97 971.51,-1037.97"/>
<text text-anchor="middle" x="909.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="909.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="909.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,1024]</text>
<text text-anchor="middle" x="909.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_out_s0_l1_gpu0 -->
<g id="node22" class="node">
<title>attn_out_s0_l1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1106.01,-1037.97 990.01,-1037.97 990.01,-985.97 1106.01,-985.97 1106.01,-1037.97"/>
<text text-anchor="middle" x="1048.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="1048.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="1048.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="1048.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s0_l1_gpu1 -->
<g id="node23" class="node">
<title>attn_qkv_s0_l1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1235.51,-1043.47 1124.51,-1043.47 1124.51,-980.47 1235.51,-980.47 1235.51,-1043.47"/>
<text text-anchor="middle" x="1180.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="1180.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="1180.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="1180.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="1180.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_score_s0_l1_gpu1 -->
<g id="node24" class="node">
<title>attn_score_s0_l1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1378.51,-1037.97 1253.51,-1037.97 1253.51,-985.97 1378.51,-985.97 1378.51,-1037.97"/>
<text text-anchor="middle" x="1316.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="1316.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="1316.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,64]</text>
<text text-anchor="middle" x="1316.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_softmax_s0_l1_gpu1 -->
<g id="node25" class="node">
<title>attn_softmax_s0_l1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1521.51,-1037.97 1396.51,-1037.97 1396.51,-985.97 1521.51,-985.97 1521.51,-1037.97"/>
<text text-anchor="middle" x="1459.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="1459.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="1459.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,1024]</text>
<text text-anchor="middle" x="1459.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_out_s0_l1_gpu1 -->
<g id="node26" class="node">
<title>attn_out_s0_l1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1656.01,-1037.97 1540.01,-1037.97 1540.01,-985.97 1656.01,-985.97 1656.01,-1037.97"/>
<text text-anchor="middle" x="1598.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="1598.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="1598.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="1598.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s0_l1 -->
<g id="node27" class="node">
<title>attn_allreduce_s0_l1</title>
<ellipse fill="lightcoral" stroke="black" cx="1731.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="1731.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1731.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 0,1</text>
<text text-anchor="middle" x="1731.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s0_l1_gpu0 -->
<g id="node28" class="node">
<title>gate_s0_l1_gpu0</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="2032.02,-1074.97 1852.24,-1074.97 1805.99,-948.97 1985.77,-948.97 2032.02,-1074.97"/>
<text text-anchor="middle" x="1919.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="1919.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="1919.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="1919.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="1919.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- gate_s0_l1_gpu1 -->
<g id="node29" class="node">
<title>gate_s0_l1_gpu1</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="2276.02,-1074.97 2096.24,-1074.97 2049.99,-948.97 2229.77,-948.97 2276.02,-1074.97"/>
<text text-anchor="middle" x="2163.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="2163.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="2163.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="2163.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="2163.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s0_l1_gpu0 -->
<g id="node30" class="node">
<title>expert_s0_l1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2410.01,-1043.47 2294.01,-1043.47 2294.01,-980.47 2410.01,-980.47 2410.01,-1043.47"/>
<text text-anchor="middle" x="2352.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 0&#45;15</text>
<text text-anchor="middle" x="2352.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="2352.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="2352.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="2352.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- expert_s0_l1_gpu1 -->
<g id="node31" class="node">
<title>expert_s0_l1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2544.01,-1043.47 2428.01,-1043.47 2428.01,-980.47 2544.01,-980.47 2544.01,-1043.47"/>
<text text-anchor="middle" x="2486.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 16&#45;31</text>
<text text-anchor="middle" x="2486.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="2486.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="2486.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="2486.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- all2all_s0_l1_gpu01 -->
<g id="node32" class="node">
<title>all2all_s0_l1_gpu01</title>
<ellipse fill="lightcoral" stroke="black" cx="2616.01" cy="-1011.97" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="2616.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="2616.01" y="-1009.47" font-family="Arial" font-size="10.00">EP GPUs 0,1</text>
<text text-anchor="middle" x="2616.01" y="-998.47" font-family="Arial" font-size="10.00">Token routing</text>
</g>
<!-- moe_agg_s0_l1_gpu0 -->
<g id="node33" class="node">
<title>moe_agg_s0_l1_gpu0</title>
<polygon fill="orange" stroke="black" points="2929.03,-1063.97 2738.1,-1063.97 2688.98,-959.97 2879.92,-959.97 2929.03,-1063.97"/>
<text text-anchor="middle" x="2809.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="2809.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="2809.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="2809.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- moe_agg_s0_l1_gpu1 -->
<g id="node34" class="node">
<title>moe_agg_s0_l1_gpu1</title>
<polygon fill="orange" stroke="black" points="3188.03,-1063.97 2997.1,-1063.97 2947.98,-959.97 3138.92,-959.97 3188.03,-1063.97"/>
<text text-anchor="middle" x="3068.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="3068.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="3068.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="3068.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s0_l2_gpu0 -->
<g id="node35" class="node">
<title>attn_qkv_s0_l2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3317.51,-1043.47 3206.51,-1043.47 3206.51,-980.47 3317.51,-980.47 3317.51,-1043.47"/>
<text text-anchor="middle" x="3262.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="3262.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="3262.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="3262.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="3262.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_score_s0_l2_gpu0 -->
<g id="node36" class="node">
<title>attn_score_s0_l2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3460.51,-1037.97 3335.51,-1037.97 3335.51,-985.97 3460.51,-985.97 3460.51,-1037.97"/>
<text text-anchor="middle" x="3398.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="3398.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="3398.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,64]</text>
<text text-anchor="middle" x="3398.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_softmax_s0_l2_gpu0 -->
<g id="node37" class="node">
<title>attn_softmax_s0_l2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3603.51,-1037.97 3478.51,-1037.97 3478.51,-985.97 3603.51,-985.97 3603.51,-1037.97"/>
<text text-anchor="middle" x="3541.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="3541.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="3541.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,1024]</text>
<text text-anchor="middle" x="3541.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_out_s0_l2_gpu0 -->
<g id="node38" class="node">
<title>attn_out_s0_l2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3738.01,-1037.97 3622.01,-1037.97 3622.01,-985.97 3738.01,-985.97 3738.01,-1037.97"/>
<text text-anchor="middle" x="3680.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="3680.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="3680.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="3680.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s0_l2_gpu1 -->
<g id="node39" class="node">
<title>attn_qkv_s0_l2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3867.51,-1043.47 3756.51,-1043.47 3756.51,-980.47 3867.51,-980.47 3867.51,-1043.47"/>
<text text-anchor="middle" x="3812.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="3812.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="3812.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="3812.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="3812.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_score_s0_l2_gpu1 -->
<g id="node40" class="node">
<title>attn_score_s0_l2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="4010.51,-1037.97 3885.51,-1037.97 3885.51,-985.97 4010.51,-985.97 4010.51,-1037.97"/>
<text text-anchor="middle" x="3948.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="3948.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="3948.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,64]</text>
<text text-anchor="middle" x="3948.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_softmax_s0_l2_gpu1 -->
<g id="node41" class="node">
<title>attn_softmax_s0_l2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="4153.51,-1037.97 4028.51,-1037.97 4028.51,-985.97 4153.51,-985.97 4153.51,-1037.97"/>
<text text-anchor="middle" x="4091.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="4091.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="4091.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,1024]</text>
<text text-anchor="middle" x="4091.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_out_s0_l2_gpu1 -->
<g id="node42" class="node">
<title>attn_out_s0_l2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="4288.01,-1037.97 4172.01,-1037.97 4172.01,-985.97 4288.01,-985.97 4288.01,-1037.97"/>
<text text-anchor="middle" x="4230.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="4230.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="4230.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="4230.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s0_l2 -->
<g id="node43" class="node">
<title>attn_allreduce_s0_l2</title>
<ellipse fill="lightcoral" stroke="black" cx="4363.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="4363.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="4363.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 0,1</text>
<text text-anchor="middle" x="4363.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s0_l2_gpu0 -->
<g id="node44" class="node">
<title>gate_s0_l2_gpu0</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="4664.02,-1074.97 4484.24,-1074.97 4437.99,-948.97 4617.77,-948.97 4664.02,-1074.97"/>
<text text-anchor="middle" x="4551.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="4551.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="4551.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="4551.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="4551.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- gate_s0_l2_gpu1 -->
<g id="node45" class="node">
<title>gate_s0_l2_gpu1</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="4908.02,-1074.97 4728.24,-1074.97 4681.99,-948.97 4861.77,-948.97 4908.02,-1074.97"/>
<text text-anchor="middle" x="4795.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="4795.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="4795.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="4795.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="4795.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s0_l2_gpu0 -->
<g id="node46" class="node">
<title>expert_s0_l2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="5042.01,-1043.47 4926.01,-1043.47 4926.01,-980.47 5042.01,-980.47 5042.01,-1043.47"/>
<text text-anchor="middle" x="4984.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 0&#45;15</text>
<text text-anchor="middle" x="4984.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="4984.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="4984.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="4984.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- expert_s0_l2_gpu1 -->
<g id="node47" class="node">
<title>expert_s0_l2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="5176.01,-1043.47 5060.01,-1043.47 5060.01,-980.47 5176.01,-980.47 5176.01,-1043.47"/>
<text text-anchor="middle" x="5118.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 16&#45;31</text>
<text text-anchor="middle" x="5118.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="5118.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="5118.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="5118.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- all2all_s0_l2_gpu01 -->
<g id="node48" class="node">
<title>all2all_s0_l2_gpu01</title>
<ellipse fill="lightcoral" stroke="black" cx="5248.01" cy="-1011.97" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="5248.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="5248.01" y="-1009.47" font-family="Arial" font-size="10.00">EP GPUs 0,1</text>
<text text-anchor="middle" x="5248.01" y="-998.47" font-family="Arial" font-size="10.00">Token routing</text>
</g>
<!-- moe_agg_s0_l2_gpu0 -->
<g id="node49" class="node">
<title>moe_agg_s0_l2_gpu0</title>
<polygon fill="orange" stroke="black" points="5561.03,-1063.97 5370.1,-1063.97 5320.98,-959.97 5511.92,-959.97 5561.03,-1063.97"/>
<text text-anchor="middle" x="5441.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="5441.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="5441.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="5441.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- moe_agg_s0_l2_gpu1 -->
<g id="node50" class="node">
<title>moe_agg_s0_l2_gpu1</title>
<polygon fill="orange" stroke="black" points="5820.03,-1063.97 5629.1,-1063.97 5579.98,-959.97 5770.92,-959.97 5820.03,-1063.97"/>
<text text-anchor="middle" x="5700.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="5700.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="5700.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="5700.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s0_l3_gpu0 -->
<g id="node51" class="node">
<title>attn_qkv_s0_l3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="5949.51,-1043.47 5838.51,-1043.47 5838.51,-980.47 5949.51,-980.47 5949.51,-1043.47"/>
<text text-anchor="middle" x="5894.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="5894.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="5894.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="5894.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="5894.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_score_s0_l3_gpu0 -->
<g id="node52" class="node">
<title>attn_score_s0_l3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="6092.51,-1037.97 5967.51,-1037.97 5967.51,-985.97 6092.51,-985.97 6092.51,-1037.97"/>
<text text-anchor="middle" x="6030.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="6030.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="6030.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,64]</text>
<text text-anchor="middle" x="6030.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_softmax_s0_l3_gpu0 -->
<g id="node53" class="node">
<title>attn_softmax_s0_l3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="6235.51,-1037.97 6110.51,-1037.97 6110.51,-985.97 6235.51,-985.97 6235.51,-1037.97"/>
<text text-anchor="middle" x="6173.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="6173.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="6173.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,1024]</text>
<text text-anchor="middle" x="6173.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_out_s0_l3_gpu0 -->
<g id="node54" class="node">
<title>attn_out_s0_l3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="6370.01,-1037.97 6254.01,-1037.97 6254.01,-985.97 6370.01,-985.97 6370.01,-1037.97"/>
<text text-anchor="middle" x="6312.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="6312.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="6312.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="6312.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s0_l3_gpu1 -->
<g id="node55" class="node">
<title>attn_qkv_s0_l3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="6499.51,-1043.47 6388.51,-1043.47 6388.51,-980.47 6499.51,-980.47 6499.51,-1043.47"/>
<text text-anchor="middle" x="6444.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="6444.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="6444.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="6444.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="6444.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_score_s0_l3_gpu1 -->
<g id="node56" class="node">
<title>attn_score_s0_l3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="6642.51,-1037.97 6517.51,-1037.97 6517.51,-985.97 6642.51,-985.97 6642.51,-1037.97"/>
<text text-anchor="middle" x="6580.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="6580.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="6580.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,64]</text>
<text text-anchor="middle" x="6580.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_softmax_s0_l3_gpu1 -->
<g id="node57" class="node">
<title>attn_softmax_s0_l3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="6785.51,-1037.97 6660.51,-1037.97 6660.51,-985.97 6785.51,-985.97 6785.51,-1037.97"/>
<text text-anchor="middle" x="6723.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="6723.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="6723.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,1024]</text>
<text text-anchor="middle" x="6723.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_out_s0_l3_gpu1 -->
<g id="node58" class="node">
<title>attn_out_s0_l3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="6920.01,-1037.97 6804.01,-1037.97 6804.01,-985.97 6920.01,-985.97 6920.01,-1037.97"/>
<text text-anchor="middle" x="6862.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="6862.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="6862.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="6862.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s0_l3 -->
<g id="node59" class="node">
<title>attn_allreduce_s0_l3</title>
<ellipse fill="lightcoral" stroke="black" cx="6995.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="6995.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="6995.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 0,1</text>
<text text-anchor="middle" x="6995.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s0_l3_gpu0 -->
<g id="node60" class="node">
<title>gate_s0_l3_gpu0</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="7296.02,-1074.97 7116.24,-1074.97 7069.99,-948.97 7249.77,-948.97 7296.02,-1074.97"/>
<text text-anchor="middle" x="7183.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="7183.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="7183.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="7183.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="7183.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- gate_s0_l3_gpu1 -->
<g id="node61" class="node">
<title>gate_s0_l3_gpu1</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="7540.02,-1074.97 7360.24,-1074.97 7313.99,-948.97 7493.77,-948.97 7540.02,-1074.97"/>
<text text-anchor="middle" x="7427.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="7427.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="7427.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="7427.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="7427.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s0_l3_gpu0 -->
<g id="node62" class="node">
<title>expert_s0_l3_gpu0</title>
<polygon fill="lightblue" stroke="black" points="7674.01,-1043.47 7558.01,-1043.47 7558.01,-980.47 7674.01,-980.47 7674.01,-1043.47"/>
<text text-anchor="middle" x="7616.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 0&#45;15</text>
<text text-anchor="middle" x="7616.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="7616.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="7616.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="7616.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- expert_s0_l3_gpu1 -->
<g id="node63" class="node">
<title>expert_s0_l3_gpu1</title>
<polygon fill="lightblue" stroke="black" points="7808.01,-1043.47 7692.01,-1043.47 7692.01,-980.47 7808.01,-980.47 7808.01,-1043.47"/>
<text text-anchor="middle" x="7750.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 16&#45;31</text>
<text text-anchor="middle" x="7750.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="7750.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="7750.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="7750.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- all2all_s0_l3_gpu01 -->
<g id="node64" class="node">
<title>all2all_s0_l3_gpu01</title>
<ellipse fill="lightcoral" stroke="black" cx="7880.01" cy="-1011.97" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="7880.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="7880.01" y="-1009.47" font-family="Arial" font-size="10.00">EP GPUs 0,1</text>
<text text-anchor="middle" x="7880.01" y="-998.47" font-family="Arial" font-size="10.00">Token routing</text>
</g>
<!-- moe_agg_s0_l3_gpu0 -->
<g id="node65" class="node">
<title>moe_agg_s0_l3_gpu0</title>
<polygon fill="orange" stroke="black" points="8193.03,-1063.97 8002.1,-1063.97 7952.98,-959.97 8143.92,-959.97 8193.03,-1063.97"/>
<text text-anchor="middle" x="8073.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="8073.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="8073.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="8073.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- moe_agg_s0_l3_gpu1 -->
<g id="node66" class="node">
<title>moe_agg_s0_l3_gpu1</title>
<polygon fill="orange" stroke="black" points="8452.03,-1063.97 8261.1,-1063.97 8211.98,-959.97 8402.92,-959.97 8452.03,-1063.97"/>
<text text-anchor="middle" x="8332.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="8332.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="8332.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="8332.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s0_l4_gpu0 -->
<g id="node67" class="node">
<title>attn_qkv_s0_l4_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="8581.51,-1043.47 8470.51,-1043.47 8470.51,-980.47 8581.51,-980.47 8581.51,-1043.47"/>
<text text-anchor="middle" x="8526.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="8526.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="8526.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="8526.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="8526.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_score_s0_l4_gpu0 -->
<g id="node68" class="node">
<title>attn_score_s0_l4_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="8724.51,-1037.97 8599.51,-1037.97 8599.51,-985.97 8724.51,-985.97 8724.51,-1037.97"/>
<text text-anchor="middle" x="8662.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="8662.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="8662.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,64]</text>
<text text-anchor="middle" x="8662.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_softmax_s0_l4_gpu0 -->
<g id="node69" class="node">
<title>attn_softmax_s0_l4_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="8867.51,-1037.97 8742.51,-1037.97 8742.51,-985.97 8867.51,-985.97 8867.51,-1037.97"/>
<text text-anchor="middle" x="8805.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="8805.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="8805.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,1024]</text>
<text text-anchor="middle" x="8805.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_out_s0_l4_gpu0 -->
<g id="node70" class="node">
<title>attn_out_s0_l4_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="9002.01,-1037.97 8886.01,-1037.97 8886.01,-985.97 9002.01,-985.97 9002.01,-1037.97"/>
<text text-anchor="middle" x="8944.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="8944.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="8944.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="8944.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s0_l4_gpu1 -->
<g id="node71" class="node">
<title>attn_qkv_s0_l4_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="9131.51,-1043.47 9020.51,-1043.47 9020.51,-980.47 9131.51,-980.47 9131.51,-1043.47"/>
<text text-anchor="middle" x="9076.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="9076.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="9076.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="9076.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="9076.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_score_s0_l4_gpu1 -->
<g id="node72" class="node">
<title>attn_score_s0_l4_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="9274.51,-1037.97 9149.51,-1037.97 9149.51,-985.97 9274.51,-985.97 9274.51,-1037.97"/>
<text text-anchor="middle" x="9212.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="9212.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="9212.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,64]</text>
<text text-anchor="middle" x="9212.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_softmax_s0_l4_gpu1 -->
<g id="node73" class="node">
<title>attn_softmax_s0_l4_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="9417.51,-1037.97 9292.51,-1037.97 9292.51,-985.97 9417.51,-985.97 9417.51,-1037.97"/>
<text text-anchor="middle" x="9355.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="9355.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="9355.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,1024]</text>
<text text-anchor="middle" x="9355.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_out_s0_l4_gpu1 -->
<g id="node74" class="node">
<title>attn_out_s0_l4_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="9552.01,-1037.97 9436.01,-1037.97 9436.01,-985.97 9552.01,-985.97 9552.01,-1037.97"/>
<text text-anchor="middle" x="9494.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="9494.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="9494.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="9494.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s0_l4 -->
<g id="node75" class="node">
<title>attn_allreduce_s0_l4</title>
<ellipse fill="lightcoral" stroke="black" cx="9627.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="9627.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="9627.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 0,1</text>
<text text-anchor="middle" x="9627.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s0_l4_gpu0 -->
<g id="node76" class="node">
<title>gate_s0_l4_gpu0</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="9928.02,-1074.97 9748.24,-1074.97 9701.99,-948.97 9881.77,-948.97 9928.02,-1074.97"/>
<text text-anchor="middle" x="9815.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="9815.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="9815.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="9815.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="9815.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- gate_s0_l4_gpu1 -->
<g id="node77" class="node">
<title>gate_s0_l4_gpu1</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="10172.02,-1074.97 9992.24,-1074.97 9945.99,-948.97 10125.77,-948.97 10172.02,-1074.97"/>
<text text-anchor="middle" x="10059.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="10059.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="10059.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="10059.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="10059.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s0_l4_gpu0 -->
<g id="node78" class="node">
<title>expert_s0_l4_gpu0</title>
<polygon fill="lightblue" stroke="black" points="10306.01,-1043.47 10190.01,-1043.47 10190.01,-980.47 10306.01,-980.47 10306.01,-1043.47"/>
<text text-anchor="middle" x="10248.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 0&#45;15</text>
<text text-anchor="middle" x="10248.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="10248.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="10248.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="10248.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- expert_s0_l4_gpu1 -->
<g id="node79" class="node">
<title>expert_s0_l4_gpu1</title>
<polygon fill="lightblue" stroke="black" points="10440.01,-1043.47 10324.01,-1043.47 10324.01,-980.47 10440.01,-980.47 10440.01,-1043.47"/>
<text text-anchor="middle" x="10382.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 16&#45;31</text>
<text text-anchor="middle" x="10382.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="10382.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="10382.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="10382.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- all2all_s0_l4_gpu01 -->
<g id="node80" class="node">
<title>all2all_s0_l4_gpu01</title>
<ellipse fill="lightcoral" stroke="black" cx="10512.01" cy="-1011.97" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="10512.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="10512.01" y="-1009.47" font-family="Arial" font-size="10.00">EP GPUs 0,1</text>
<text text-anchor="middle" x="10512.01" y="-998.47" font-family="Arial" font-size="10.00">Token routing</text>
</g>
<!-- moe_agg_s0_l4_gpu0 -->
<g id="node81" class="node">
<title>moe_agg_s0_l4_gpu0</title>
<polygon fill="orange" stroke="black" points="10825.03,-1063.97 10634.1,-1063.97 10584.98,-959.97 10775.92,-959.97 10825.03,-1063.97"/>
<text text-anchor="middle" x="10705.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="10705.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="10705.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="10705.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- moe_agg_s0_l4_gpu1 -->
<g id="node82" class="node">
<title>moe_agg_s0_l4_gpu1</title>
<polygon fill="orange" stroke="black" points="11084.03,-1063.97 10893.1,-1063.97 10843.98,-959.97 11034.92,-959.97 11084.03,-1063.97"/>
<text text-anchor="middle" x="10964.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="10964.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="10964.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="10964.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s0_l5_gpu0 -->
<g id="node83" class="node">
<title>attn_qkv_s0_l5_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="11213.51,-1043.47 11102.51,-1043.47 11102.51,-980.47 11213.51,-980.47 11213.51,-1043.47"/>
<text text-anchor="middle" x="11158.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="11158.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="11158.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="11158.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="11158.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_score_s0_l5_gpu0 -->
<g id="node84" class="node">
<title>attn_score_s0_l5_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="11356.51,-1037.97 11231.51,-1037.97 11231.51,-985.97 11356.51,-985.97 11356.51,-1037.97"/>
<text text-anchor="middle" x="11294.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="11294.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="11294.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,64]</text>
<text text-anchor="middle" x="11294.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_softmax_s0_l5_gpu0 -->
<g id="node85" class="node">
<title>attn_softmax_s0_l5_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="11499.51,-1037.97 11374.51,-1037.97 11374.51,-985.97 11499.51,-985.97 11499.51,-1037.97"/>
<text text-anchor="middle" x="11437.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="11437.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="11437.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,1024]</text>
<text text-anchor="middle" x="11437.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_out_s0_l5_gpu0 -->
<g id="node86" class="node">
<title>attn_out_s0_l5_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="11634.01,-1037.97 11518.01,-1037.97 11518.01,-985.97 11634.01,-985.97 11634.01,-1037.97"/>
<text text-anchor="middle" x="11576.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="11576.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="11576.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="11576.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s0_l5_gpu1 -->
<g id="node87" class="node">
<title>attn_qkv_s0_l5_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11763.51,-1043.47 11652.51,-1043.47 11652.51,-980.47 11763.51,-980.47 11763.51,-1043.47"/>
<text text-anchor="middle" x="11708.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="11708.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="11708.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="11708.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="11708.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_score_s0_l5_gpu1 -->
<g id="node88" class="node">
<title>attn_score_s0_l5_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11906.51,-1037.97 11781.51,-1037.97 11781.51,-985.97 11906.51,-985.97 11906.51,-1037.97"/>
<text text-anchor="middle" x="11844.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="11844.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="11844.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,64]</text>
<text text-anchor="middle" x="11844.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_softmax_s0_l5_gpu1 -->
<g id="node89" class="node">
<title>attn_softmax_s0_l5_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="12049.51,-1037.97 11924.51,-1037.97 11924.51,-985.97 12049.51,-985.97 12049.51,-1037.97"/>
<text text-anchor="middle" x="11987.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="11987.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="11987.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,1024]</text>
<text text-anchor="middle" x="11987.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_out_s0_l5_gpu1 -->
<g id="node90" class="node">
<title>attn_out_s0_l5_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="12184.01,-1037.97 12068.01,-1037.97 12068.01,-985.97 12184.01,-985.97 12184.01,-1037.97"/>
<text text-anchor="middle" x="12126.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="12126.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="12126.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="12126.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s0_l5 -->
<g id="node91" class="node">
<title>attn_allreduce_s0_l5</title>
<ellipse fill="lightcoral" stroke="black" cx="12259.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="12259.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="12259.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 0,1</text>
<text text-anchor="middle" x="12259.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s0_l5_gpu0 -->
<g id="node92" class="node">
<title>gate_s0_l5_gpu0</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="12560.02,-1074.97 12380.24,-1074.97 12333.99,-948.97 12513.77,-948.97 12560.02,-1074.97"/>
<text text-anchor="middle" x="12447.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="12447.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="12447.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="12447.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="12447.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- gate_s0_l5_gpu1 -->
<g id="node93" class="node">
<title>gate_s0_l5_gpu1</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="12804.02,-1074.97 12624.24,-1074.97 12577.99,-948.97 12757.77,-948.97 12804.02,-1074.97"/>
<text text-anchor="middle" x="12691.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="12691.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="12691.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="12691.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="12691.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s0_l5_gpu0 -->
<g id="node94" class="node">
<title>expert_s0_l5_gpu0</title>
<polygon fill="lightblue" stroke="black" points="12938.01,-1043.47 12822.01,-1043.47 12822.01,-980.47 12938.01,-980.47 12938.01,-1043.47"/>
<text text-anchor="middle" x="12880.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 0&#45;15</text>
<text text-anchor="middle" x="12880.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="12880.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="12880.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="12880.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- expert_s0_l5_gpu1 -->
<g id="node95" class="node">
<title>expert_s0_l5_gpu1</title>
<polygon fill="lightblue" stroke="black" points="13072.01,-1043.47 12956.01,-1043.47 12956.01,-980.47 13072.01,-980.47 13072.01,-1043.47"/>
<text text-anchor="middle" x="13014.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 16&#45;31</text>
<text text-anchor="middle" x="13014.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="13014.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="13014.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="13014.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- all2all_s0_l5_gpu01 -->
<g id="node96" class="node">
<title>all2all_s0_l5_gpu01</title>
<ellipse fill="lightcoral" stroke="black" cx="13144.01" cy="-1011.97" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="13144.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="13144.01" y="-1009.47" font-family="Arial" font-size="10.00">EP GPUs 0,1</text>
<text text-anchor="middle" x="13144.01" y="-998.47" font-family="Arial" font-size="10.00">Token routing</text>
</g>
<!-- moe_agg_s0_l5_gpu0 -->
<g id="node97" class="node">
<title>moe_agg_s0_l5_gpu0</title>
<polygon fill="orange" stroke="black" points="13457.03,-1063.97 13266.1,-1063.97 13216.98,-959.97 13407.92,-959.97 13457.03,-1063.97"/>
<text text-anchor="middle" x="13337.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="13337.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="13337.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="13337.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- moe_agg_s0_l5_gpu1 -->
<g id="node98" class="node">
<title>moe_agg_s0_l5_gpu1</title>
<polygon fill="orange" stroke="black" points="13716.03,-1063.97 13525.1,-1063.97 13475.98,-959.97 13666.92,-959.97 13716.03,-1063.97"/>
<text text-anchor="middle" x="13596.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="13596.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="13596.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="13596.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s0_l6_gpu0 -->
<g id="node99" class="node">
<title>attn_qkv_s0_l6_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="13845.51,-1043.47 13734.51,-1043.47 13734.51,-980.47 13845.51,-980.47 13845.51,-1043.47"/>
<text text-anchor="middle" x="13790.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="13790.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="13790.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="13790.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="13790.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_score_s0_l6_gpu0 -->
<g id="node100" class="node">
<title>attn_score_s0_l6_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="13988.51,-1037.97 13863.51,-1037.97 13863.51,-985.97 13988.51,-985.97 13988.51,-1037.97"/>
<text text-anchor="middle" x="13926.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="13926.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="13926.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,64]</text>
<text text-anchor="middle" x="13926.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_softmax_s0_l6_gpu0 -->
<g id="node101" class="node">
<title>attn_softmax_s0_l6_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="14131.51,-1037.97 14006.51,-1037.97 14006.51,-985.97 14131.51,-985.97 14131.51,-1037.97"/>
<text text-anchor="middle" x="14069.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="14069.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="14069.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,1024]</text>
<text text-anchor="middle" x="14069.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_out_s0_l6_gpu0 -->
<g id="node102" class="node">
<title>attn_out_s0_l6_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="14266.01,-1037.97 14150.01,-1037.97 14150.01,-985.97 14266.01,-985.97 14266.01,-1037.97"/>
<text text-anchor="middle" x="14208.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="14208.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="14208.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="14208.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s0_l6_gpu1 -->
<g id="node103" class="node">
<title>attn_qkv_s0_l6_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="14395.51,-1043.47 14284.51,-1043.47 14284.51,-980.47 14395.51,-980.47 14395.51,-1043.47"/>
<text text-anchor="middle" x="14340.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="14340.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="14340.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="14340.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="14340.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_score_s0_l6_gpu1 -->
<g id="node104" class="node">
<title>attn_score_s0_l6_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="14538.51,-1037.97 14413.51,-1037.97 14413.51,-985.97 14538.51,-985.97 14538.51,-1037.97"/>
<text text-anchor="middle" x="14476.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="14476.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="14476.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,64]</text>
<text text-anchor="middle" x="14476.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_softmax_s0_l6_gpu1 -->
<g id="node105" class="node">
<title>attn_softmax_s0_l6_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="14681.51,-1037.97 14556.51,-1037.97 14556.51,-985.97 14681.51,-985.97 14681.51,-1037.97"/>
<text text-anchor="middle" x="14619.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="14619.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="14619.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,1024]</text>
<text text-anchor="middle" x="14619.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_out_s0_l6_gpu1 -->
<g id="node106" class="node">
<title>attn_out_s0_l6_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="14816.01,-1037.97 14700.01,-1037.97 14700.01,-985.97 14816.01,-985.97 14816.01,-1037.97"/>
<text text-anchor="middle" x="14758.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="14758.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="14758.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="14758.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s0_l6 -->
<g id="node107" class="node">
<title>attn_allreduce_s0_l6</title>
<ellipse fill="lightcoral" stroke="black" cx="14891.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="14891.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="14891.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 0,1</text>
<text text-anchor="middle" x="14891.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s0_l6_gpu0 -->
<g id="node108" class="node">
<title>gate_s0_l6_gpu0</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="15192.02,-1074.97 15012.24,-1074.97 14965.99,-948.97 15145.77,-948.97 15192.02,-1074.97"/>
<text text-anchor="middle" x="15079.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="15079.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="15079.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="15079.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="15079.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- gate_s0_l6_gpu1 -->
<g id="node109" class="node">
<title>gate_s0_l6_gpu1</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="15436.02,-1074.97 15256.24,-1074.97 15209.99,-948.97 15389.77,-948.97 15436.02,-1074.97"/>
<text text-anchor="middle" x="15323.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="15323.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="15323.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="15323.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="15323.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s0_l6_gpu0 -->
<g id="node110" class="node">
<title>expert_s0_l6_gpu0</title>
<polygon fill="lightblue" stroke="black" points="15570.01,-1043.47 15454.01,-1043.47 15454.01,-980.47 15570.01,-980.47 15570.01,-1043.47"/>
<text text-anchor="middle" x="15512.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 0&#45;15</text>
<text text-anchor="middle" x="15512.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="15512.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="15512.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="15512.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- expert_s0_l6_gpu1 -->
<g id="node111" class="node">
<title>expert_s0_l6_gpu1</title>
<polygon fill="lightblue" stroke="black" points="15704.01,-1043.47 15588.01,-1043.47 15588.01,-980.47 15704.01,-980.47 15704.01,-1043.47"/>
<text text-anchor="middle" x="15646.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 16&#45;31</text>
<text text-anchor="middle" x="15646.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="15646.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="15646.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="15646.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- all2all_s0_l6_gpu01 -->
<g id="node112" class="node">
<title>all2all_s0_l6_gpu01</title>
<ellipse fill="lightcoral" stroke="black" cx="15776.01" cy="-1011.97" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="15776.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="15776.01" y="-1009.47" font-family="Arial" font-size="10.00">EP GPUs 0,1</text>
<text text-anchor="middle" x="15776.01" y="-998.47" font-family="Arial" font-size="10.00">Token routing</text>
</g>
<!-- moe_agg_s0_l6_gpu0 -->
<g id="node113" class="node">
<title>moe_agg_s0_l6_gpu0</title>
<polygon fill="orange" stroke="black" points="16089.03,-1063.97 15898.1,-1063.97 15848.98,-959.97 16039.92,-959.97 16089.03,-1063.97"/>
<text text-anchor="middle" x="15969.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="15969.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="15969.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="15969.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- moe_agg_s0_l6_gpu1 -->
<g id="node114" class="node">
<title>moe_agg_s0_l6_gpu1</title>
<polygon fill="orange" stroke="black" points="16348.03,-1063.97 16157.1,-1063.97 16107.98,-959.97 16298.92,-959.97 16348.03,-1063.97"/>
<text text-anchor="middle" x="16228.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="16228.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="16228.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="16228.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s0_l7_gpu0 -->
<g id="node115" class="node">
<title>attn_qkv_s0_l7_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="16477.51,-1043.47 16366.51,-1043.47 16366.51,-980.47 16477.51,-980.47 16477.51,-1043.47"/>
<text text-anchor="middle" x="16422.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="16422.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="16422.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="16422.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="16422.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_score_s0_l7_gpu0 -->
<g id="node116" class="node">
<title>attn_score_s0_l7_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="16620.51,-1037.97 16495.51,-1037.97 16495.51,-985.97 16620.51,-985.97 16620.51,-1037.97"/>
<text text-anchor="middle" x="16558.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="16558.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="16558.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,64]</text>
<text text-anchor="middle" x="16558.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_softmax_s0_l7_gpu0 -->
<g id="node117" class="node">
<title>attn_softmax_s0_l7_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="16763.51,-1037.97 16638.51,-1037.97 16638.51,-985.97 16763.51,-985.97 16763.51,-1037.97"/>
<text text-anchor="middle" x="16701.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="16701.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="16701.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,1024]</text>
<text text-anchor="middle" x="16701.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_out_s0_l7_gpu0 -->
<g id="node118" class="node">
<title>attn_out_s0_l7_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="16898.01,-1037.97 16782.01,-1037.97 16782.01,-985.97 16898.01,-985.97 16898.01,-1037.97"/>
<text text-anchor="middle" x="16840.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="16840.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="16840.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="16840.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s0_l7_gpu1 -->
<g id="node119" class="node">
<title>attn_qkv_s0_l7_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="17027.51,-1043.47 16916.51,-1043.47 16916.51,-980.47 17027.51,-980.47 17027.51,-1043.47"/>
<text text-anchor="middle" x="16972.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="16972.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="16972.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="16972.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="16972.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_score_s0_l7_gpu1 -->
<g id="node120" class="node">
<title>attn_score_s0_l7_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="17170.51,-1037.97 17045.51,-1037.97 17045.51,-985.97 17170.51,-985.97 17170.51,-1037.97"/>
<text text-anchor="middle" x="17108.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Score</text>
<text text-anchor="middle" x="17108.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="17108.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,64]</text>
<text text-anchor="middle" x="17108.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_softmax_s0_l7_gpu1 -->
<g id="node121" class="node">
<title>attn_softmax_s0_l7_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="17313.51,-1037.97 17188.51,-1037.97 17188.51,-985.97 17313.51,-985.97 17313.51,-1037.97"/>
<text text-anchor="middle" x="17251.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Softmax</text>
<text text-anchor="middle" x="17251.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="17251.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,8,1024,1024]</text>
<text text-anchor="middle" x="17251.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,8,1024,1024]</text>
</g>
<!-- attn_out_s0_l7_gpu1 -->
<g id="node122" class="node">
<title>attn_out_s0_l7_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="17448.01,-1037.97 17332.01,-1037.97 17332.01,-985.97 17448.01,-985.97 17448.01,-1037.97"/>
<text text-anchor="middle" x="17390.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="17390.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="17390.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="17390.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s0_l7 -->
<g id="node123" class="node">
<title>attn_allreduce_s0_l7</title>
<ellipse fill="lightcoral" stroke="black" cx="17523.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="17523.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="17523.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 0,1</text>
<text text-anchor="middle" x="17523.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s0_l7_gpu0 -->
<g id="node124" class="node">
<title>gate_s0_l7_gpu0</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="17824.02,-1074.97 17644.24,-1074.97 17597.99,-948.97 17777.77,-948.97 17824.02,-1074.97"/>
<text text-anchor="middle" x="17711.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="17711.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="17711.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="17711.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="17711.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- gate_s0_l7_gpu1 -->
<g id="node125" class="node">
<title>gate_s0_l7_gpu1</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="18068.02,-1074.97 17888.24,-1074.97 17841.99,-948.97 18021.77,-948.97 18068.02,-1074.97"/>
<text text-anchor="middle" x="17955.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="17955.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="17955.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="17955.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="17955.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s0_l7_gpu0 -->
<g id="node126" class="node">
<title>expert_s0_l7_gpu0</title>
<polygon fill="lightblue" stroke="black" points="18202.01,-1043.47 18086.01,-1043.47 18086.01,-980.47 18202.01,-980.47 18202.01,-1043.47"/>
<text text-anchor="middle" x="18144.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 0&#45;15</text>
<text text-anchor="middle" x="18144.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="18144.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="18144.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="18144.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- expert_s0_l7_gpu1 -->
<g id="node127" class="node">
<title>expert_s0_l7_gpu1</title>
<polygon fill="lightblue" stroke="black" points="18336.01,-1043.47 18220.01,-1043.47 18220.01,-980.47 18336.01,-980.47 18336.01,-1043.47"/>
<text text-anchor="middle" x="18278.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 16&#45;31</text>
<text text-anchor="middle" x="18278.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="18278.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="18278.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="18278.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- all2all_s0_l7_gpu01 -->
<g id="node128" class="node">
<title>all2all_s0_l7_gpu01</title>
<ellipse fill="lightcoral" stroke="black" cx="18408.01" cy="-1011.97" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="18408.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="18408.01" y="-1009.47" font-family="Arial" font-size="10.00">EP GPUs 0,1</text>
<text text-anchor="middle" x="18408.01" y="-998.47" font-family="Arial" font-size="10.00">Token routing</text>
</g>
<!-- moe_agg_s0_l7_gpu0 -->
<g id="node129" class="node">
<title>moe_agg_s0_l7_gpu0</title>
<polygon fill="orange" stroke="black" points="18721.03,-1063.97 18530.1,-1063.97 18480.98,-959.97 18671.92,-959.97 18721.03,-1063.97"/>
<text text-anchor="middle" x="18601.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="18601.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;0</text>
<text text-anchor="middle" x="18601.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="18601.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- pipe_comm_s0_s1 -->
<g id="node259" class="node">
<title>pipe_comm_s0_s1</title>
<ellipse fill="lightcoral" stroke="black" cx="18730.01" cy="-882.97" rx="73.58" ry="28.98"/>
<text text-anchor="middle" x="18730.01" y="-891.47" font-family="Arial" font-size="10.00">Pipeline Comm</text>
<text text-anchor="middle" x="18730.01" y="-880.47" font-family="Arial" font-size="10.00">Stage0Stage1</text>
<text text-anchor="middle" x="18730.01" y="-869.47" font-family="Arial" font-size="10.00">Micro&#45;batch transfer</text>
</g>
<!-- moe_agg_s0_l7_gpu0&#45;&gt;pipe_comm_s0_s1 -->
<g id="edge22" class="edge">
<title>moe_agg_s0_l7_gpu0&#45;&gt;pipe_comm_s0_s1</title>
<path fill="none" stroke="black" d="M18688.87,-995.63C18688.87,-995.63 18688.87,-917.07 18688.87,-917.07"/>
<polygon fill="black" stroke="black" points="18692.37,-917.07 18688.87,-907.07 18685.37,-917.07 18692.37,-917.07"/>
</g>
<!-- moe_agg_s0_l7_gpu1 -->
<g id="node130" class="node">
<title>moe_agg_s0_l7_gpu1</title>
<polygon fill="orange" stroke="black" points="18980.03,-1063.97 18789.1,-1063.97 18739.98,-959.97 18930.92,-959.97 18980.03,-1063.97"/>
<text text-anchor="middle" x="18860.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="18860.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;1</text>
<text text-anchor="middle" x="18860.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="18860.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- moe_agg_s0_l7_gpu1&#45;&gt;pipe_comm_s0_s1 -->
<g id="edge23" class="edge">
<title>moe_agg_s0_l7_gpu1&#45;&gt;pipe_comm_s0_s1</title>
<path fill="none" stroke="black" d="M18771.64,-959.87C18771.64,-959.87 18771.64,-916.96 18771.64,-916.96"/>
<polygon fill="black" stroke="black" points="18775.14,-916.96 18771.64,-906.96 18768.14,-916.96 18775.14,-916.96"/>
</g>
<!-- attn_qkv_s1_l0_gpu2 -->
<g id="node131" class="node">
<title>attn_qkv_s1_l0_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="18720.51,-816.97 18609.51,-816.97 18609.51,-753.97 18720.51,-753.97 18720.51,-816.97"/>
<text text-anchor="middle" x="18665.01" y="-804.97" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="18665.01" y="-793.97" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="18665.01" y="-782.97" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="18665.01" y="-771.97" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="18665.01" y="-760.97" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l0_gpu2 -->
<g id="node132" class="node">
<title>attn_out_s1_l0_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="19114.01,-1037.97 18998.01,-1037.97 18998.01,-985.97 19114.01,-985.97 19114.01,-1037.97"/>
<text text-anchor="middle" x="19056.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="19056.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="19056.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="19056.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l0_gpu3 -->
<g id="node133" class="node">
<title>attn_qkv_s1_l0_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="18849.51,-816.97 18738.51,-816.97 18738.51,-753.97 18849.51,-753.97 18849.51,-816.97"/>
<text text-anchor="middle" x="18794.01" y="-804.97" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="18794.01" y="-793.97" font-family="Arial" font-size="10.00">GPU&#45;3</text>
<text text-anchor="middle" x="18794.01" y="-782.97" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="18794.01" y="-771.97" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="18794.01" y="-760.97" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l0_gpu3 -->
<g id="node134" class="node">
<title>attn_out_s1_l0_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="19248.01,-1037.97 19132.01,-1037.97 19132.01,-985.97 19248.01,-985.97 19248.01,-1037.97"/>
<text text-anchor="middle" x="19190.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="19190.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;3</text>
<text text-anchor="middle" x="19190.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="19190.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s1_l0 -->
<g id="node135" class="node">
<title>attn_allreduce_s1_l0</title>
<ellipse fill="lightcoral" stroke="black" cx="19323.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="19323.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="19323.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 2,3</text>
<text text-anchor="middle" x="19323.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s1_l0_gpu2 -->
<g id="node136" class="node">
<title>gate_s1_l0_gpu2</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="19624.02,-1074.97 19444.24,-1074.97 19397.99,-948.97 19577.77,-948.97 19624.02,-1074.97"/>
<text text-anchor="middle" x="19511.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="19511.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="19511.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="19511.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="19511.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s1_l0_gpu2 -->
<g id="node137" class="node">
<title>expert_s1_l0_gpu2</title>
<polygon fill="lightblue" stroke="black" points="19758.01,-1043.47 19642.01,-1043.47 19642.01,-980.47 19758.01,-980.47 19758.01,-1043.47"/>
<text text-anchor="middle" x="19700.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 0&#45;15</text>
<text text-anchor="middle" x="19700.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="19700.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="19700.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="19700.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- moe_agg_s1_l0_gpu2 -->
<g id="node138" class="node">
<title>moe_agg_s1_l0_gpu2</title>
<polygon fill="orange" stroke="black" points="20016.03,-1063.97 19825.1,-1063.97 19775.98,-959.97 19966.92,-959.97 20016.03,-1063.97"/>
<text text-anchor="middle" x="19896.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="19896.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="19896.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="19896.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l0_gpu6 -->
<g id="node139" class="node">
<title>attn_qkv_s1_l0_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="20145.51,-1043.47 20034.51,-1043.47 20034.51,-980.47 20145.51,-980.47 20145.51,-1043.47"/>
<text text-anchor="middle" x="20090.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="20090.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="20090.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="20090.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="20090.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l0_gpu6 -->
<g id="node140" class="node">
<title>attn_out_s1_l0_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="20280.01,-1037.97 20164.01,-1037.97 20164.01,-985.97 20280.01,-985.97 20280.01,-1037.97"/>
<text text-anchor="middle" x="20222.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="20222.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="20222.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="20222.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l0_gpu7 -->
<g id="node141" class="node">
<title>attn_qkv_s1_l0_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="20409.51,-1043.47 20298.51,-1043.47 20298.51,-980.47 20409.51,-980.47 20409.51,-1043.47"/>
<text text-anchor="middle" x="20354.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="20354.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;7</text>
<text text-anchor="middle" x="20354.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="20354.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="20354.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l0_gpu7 -->
<g id="node142" class="node">
<title>attn_out_s1_l0_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="20544.01,-1037.97 20428.01,-1037.97 20428.01,-985.97 20544.01,-985.97 20544.01,-1037.97"/>
<text text-anchor="middle" x="20486.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="20486.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;7</text>
<text text-anchor="middle" x="20486.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="20486.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s1_l0_dp1 -->
<g id="node143" class="node">
<title>attn_allreduce_s1_l0_dp1</title>
<ellipse fill="lightcoral" stroke="black" cx="20619.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="20619.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="20619.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 6,7</text>
<text text-anchor="middle" x="20619.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s1_l0_gpu6 -->
<g id="node144" class="node">
<title>gate_s1_l0_gpu6</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="20920.02,-1074.97 20740.24,-1074.97 20693.99,-948.97 20873.77,-948.97 20920.02,-1074.97"/>
<text text-anchor="middle" x="20807.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="20807.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="20807.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="20807.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="20807.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s1_l0_gpu6 -->
<g id="node145" class="node">
<title>expert_s1_l0_gpu6</title>
<polygon fill="lightblue" stroke="black" points="21054.01,-1043.47 20938.01,-1043.47 20938.01,-980.47 21054.01,-980.47 21054.01,-1043.47"/>
<text text-anchor="middle" x="20996.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 32&#45;47</text>
<text text-anchor="middle" x="20996.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="20996.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="20996.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="20996.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- moe_agg_s1_l0_gpu6 -->
<g id="node146" class="node">
<title>moe_agg_s1_l0_gpu6</title>
<polygon fill="orange" stroke="black" points="21312.03,-1063.97 21121.1,-1063.97 21071.98,-959.97 21262.92,-959.97 21312.03,-1063.97"/>
<text text-anchor="middle" x="21192.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="21192.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="21192.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="21192.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l1_gpu2 -->
<g id="node147" class="node">
<title>attn_qkv_s1_l1_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="21441.51,-1043.47 21330.51,-1043.47 21330.51,-980.47 21441.51,-980.47 21441.51,-1043.47"/>
<text text-anchor="middle" x="21386.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="21386.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="21386.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="21386.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="21386.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l1_gpu2 -->
<g id="node148" class="node">
<title>attn_out_s1_l1_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="21576.01,-1037.97 21460.01,-1037.97 21460.01,-985.97 21576.01,-985.97 21576.01,-1037.97"/>
<text text-anchor="middle" x="21518.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="21518.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="21518.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="21518.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l1_gpu3 -->
<g id="node149" class="node">
<title>attn_qkv_s1_l1_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="21705.51,-1043.47 21594.51,-1043.47 21594.51,-980.47 21705.51,-980.47 21705.51,-1043.47"/>
<text text-anchor="middle" x="21650.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="21650.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;3</text>
<text text-anchor="middle" x="21650.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="21650.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="21650.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l1_gpu3 -->
<g id="node150" class="node">
<title>attn_out_s1_l1_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="21840.01,-1037.97 21724.01,-1037.97 21724.01,-985.97 21840.01,-985.97 21840.01,-1037.97"/>
<text text-anchor="middle" x="21782.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="21782.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;3</text>
<text text-anchor="middle" x="21782.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="21782.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s1_l1 -->
<g id="node151" class="node">
<title>attn_allreduce_s1_l1</title>
<ellipse fill="lightcoral" stroke="black" cx="21915.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="21915.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="21915.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 2,3</text>
<text text-anchor="middle" x="21915.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s1_l1_gpu2 -->
<g id="node152" class="node">
<title>gate_s1_l1_gpu2</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="22216.02,-1074.97 22036.24,-1074.97 21989.99,-948.97 22169.77,-948.97 22216.02,-1074.97"/>
<text text-anchor="middle" x="22103.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="22103.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="22103.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="22103.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="22103.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s1_l1_gpu2 -->
<g id="node153" class="node">
<title>expert_s1_l1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="22350.01,-1043.47 22234.01,-1043.47 22234.01,-980.47 22350.01,-980.47 22350.01,-1043.47"/>
<text text-anchor="middle" x="22292.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 0&#45;15</text>
<text text-anchor="middle" x="22292.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="22292.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="22292.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="22292.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- moe_agg_s1_l1_gpu2 -->
<g id="node154" class="node">
<title>moe_agg_s1_l1_gpu2</title>
<polygon fill="orange" stroke="black" points="22608.03,-1063.97 22417.1,-1063.97 22367.98,-959.97 22558.92,-959.97 22608.03,-1063.97"/>
<text text-anchor="middle" x="22488.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="22488.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="22488.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="22488.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l1_gpu6 -->
<g id="node155" class="node">
<title>attn_qkv_s1_l1_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="22737.51,-1043.47 22626.51,-1043.47 22626.51,-980.47 22737.51,-980.47 22737.51,-1043.47"/>
<text text-anchor="middle" x="22682.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="22682.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="22682.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="22682.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="22682.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l1_gpu6 -->
<g id="node156" class="node">
<title>attn_out_s1_l1_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="22872.01,-1037.97 22756.01,-1037.97 22756.01,-985.97 22872.01,-985.97 22872.01,-1037.97"/>
<text text-anchor="middle" x="22814.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="22814.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="22814.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="22814.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l1_gpu7 -->
<g id="node157" class="node">
<title>attn_qkv_s1_l1_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="23001.51,-1043.47 22890.51,-1043.47 22890.51,-980.47 23001.51,-980.47 23001.51,-1043.47"/>
<text text-anchor="middle" x="22946.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="22946.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;7</text>
<text text-anchor="middle" x="22946.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="22946.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="22946.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l1_gpu7 -->
<g id="node158" class="node">
<title>attn_out_s1_l1_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="23136.01,-1037.97 23020.01,-1037.97 23020.01,-985.97 23136.01,-985.97 23136.01,-1037.97"/>
<text text-anchor="middle" x="23078.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="23078.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;7</text>
<text text-anchor="middle" x="23078.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="23078.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s1_l1_dp1 -->
<g id="node159" class="node">
<title>attn_allreduce_s1_l1_dp1</title>
<ellipse fill="lightcoral" stroke="black" cx="23211.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="23211.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="23211.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 6,7</text>
<text text-anchor="middle" x="23211.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s1_l1_gpu6 -->
<g id="node160" class="node">
<title>gate_s1_l1_gpu6</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="23512.02,-1074.97 23332.24,-1074.97 23285.99,-948.97 23465.77,-948.97 23512.02,-1074.97"/>
<text text-anchor="middle" x="23399.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="23399.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="23399.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="23399.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="23399.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s1_l1_gpu6 -->
<g id="node161" class="node">
<title>expert_s1_l1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="23646.01,-1043.47 23530.01,-1043.47 23530.01,-980.47 23646.01,-980.47 23646.01,-1043.47"/>
<text text-anchor="middle" x="23588.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 32&#45;47</text>
<text text-anchor="middle" x="23588.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="23588.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="23588.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="23588.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- moe_agg_s1_l1_gpu6 -->
<g id="node162" class="node">
<title>moe_agg_s1_l1_gpu6</title>
<polygon fill="orange" stroke="black" points="23904.03,-1063.97 23713.1,-1063.97 23663.98,-959.97 23854.92,-959.97 23904.03,-1063.97"/>
<text text-anchor="middle" x="23784.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="23784.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="23784.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="23784.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l2_gpu2 -->
<g id="node163" class="node">
<title>attn_qkv_s1_l2_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="24033.51,-1043.47 23922.51,-1043.47 23922.51,-980.47 24033.51,-980.47 24033.51,-1043.47"/>
<text text-anchor="middle" x="23978.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="23978.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="23978.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="23978.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="23978.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l2_gpu2 -->
<g id="node164" class="node">
<title>attn_out_s1_l2_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="24168.01,-1037.97 24052.01,-1037.97 24052.01,-985.97 24168.01,-985.97 24168.01,-1037.97"/>
<text text-anchor="middle" x="24110.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="24110.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="24110.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="24110.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l2_gpu3 -->
<g id="node165" class="node">
<title>attn_qkv_s1_l2_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="24297.51,-1043.47 24186.51,-1043.47 24186.51,-980.47 24297.51,-980.47 24297.51,-1043.47"/>
<text text-anchor="middle" x="24242.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="24242.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;3</text>
<text text-anchor="middle" x="24242.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="24242.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="24242.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l2_gpu3 -->
<g id="node166" class="node">
<title>attn_out_s1_l2_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="24432.01,-1037.97 24316.01,-1037.97 24316.01,-985.97 24432.01,-985.97 24432.01,-1037.97"/>
<text text-anchor="middle" x="24374.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="24374.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;3</text>
<text text-anchor="middle" x="24374.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="24374.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s1_l2 -->
<g id="node167" class="node">
<title>attn_allreduce_s1_l2</title>
<ellipse fill="lightcoral" stroke="black" cx="24507.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="24507.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="24507.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 2,3</text>
<text text-anchor="middle" x="24507.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s1_l2_gpu2 -->
<g id="node168" class="node">
<title>gate_s1_l2_gpu2</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="24808.02,-1074.97 24628.24,-1074.97 24581.99,-948.97 24761.77,-948.97 24808.02,-1074.97"/>
<text text-anchor="middle" x="24695.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="24695.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="24695.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="24695.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="24695.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s1_l2_gpu2 -->
<g id="node169" class="node">
<title>expert_s1_l2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="24942.01,-1043.47 24826.01,-1043.47 24826.01,-980.47 24942.01,-980.47 24942.01,-1043.47"/>
<text text-anchor="middle" x="24884.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 0&#45;15</text>
<text text-anchor="middle" x="24884.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="24884.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="24884.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="24884.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- moe_agg_s1_l2_gpu2 -->
<g id="node170" class="node">
<title>moe_agg_s1_l2_gpu2</title>
<polygon fill="orange" stroke="black" points="25200.03,-1063.97 25009.1,-1063.97 24959.98,-959.97 25150.92,-959.97 25200.03,-1063.97"/>
<text text-anchor="middle" x="25080.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="25080.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="25080.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="25080.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l2_gpu6 -->
<g id="node171" class="node">
<title>attn_qkv_s1_l2_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="25329.51,-1043.47 25218.51,-1043.47 25218.51,-980.47 25329.51,-980.47 25329.51,-1043.47"/>
<text text-anchor="middle" x="25274.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="25274.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="25274.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="25274.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="25274.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l2_gpu6 -->
<g id="node172" class="node">
<title>attn_out_s1_l2_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="25464.01,-1037.97 25348.01,-1037.97 25348.01,-985.97 25464.01,-985.97 25464.01,-1037.97"/>
<text text-anchor="middle" x="25406.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="25406.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="25406.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="25406.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l2_gpu7 -->
<g id="node173" class="node">
<title>attn_qkv_s1_l2_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="25593.51,-1043.47 25482.51,-1043.47 25482.51,-980.47 25593.51,-980.47 25593.51,-1043.47"/>
<text text-anchor="middle" x="25538.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="25538.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;7</text>
<text text-anchor="middle" x="25538.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="25538.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="25538.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l2_gpu7 -->
<g id="node174" class="node">
<title>attn_out_s1_l2_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="25728.01,-1037.97 25612.01,-1037.97 25612.01,-985.97 25728.01,-985.97 25728.01,-1037.97"/>
<text text-anchor="middle" x="25670.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="25670.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;7</text>
<text text-anchor="middle" x="25670.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="25670.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s1_l2_dp1 -->
<g id="node175" class="node">
<title>attn_allreduce_s1_l2_dp1</title>
<ellipse fill="lightcoral" stroke="black" cx="25803.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="25803.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="25803.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 6,7</text>
<text text-anchor="middle" x="25803.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s1_l2_gpu6 -->
<g id="node176" class="node">
<title>gate_s1_l2_gpu6</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="26104.02,-1074.97 25924.24,-1074.97 25877.99,-948.97 26057.77,-948.97 26104.02,-1074.97"/>
<text text-anchor="middle" x="25991.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="25991.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="25991.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="25991.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="25991.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s1_l2_gpu6 -->
<g id="node177" class="node">
<title>expert_s1_l2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="26238.01,-1043.47 26122.01,-1043.47 26122.01,-980.47 26238.01,-980.47 26238.01,-1043.47"/>
<text text-anchor="middle" x="26180.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 32&#45;47</text>
<text text-anchor="middle" x="26180.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="26180.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="26180.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="26180.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- moe_agg_s1_l2_gpu6 -->
<g id="node178" class="node">
<title>moe_agg_s1_l2_gpu6</title>
<polygon fill="orange" stroke="black" points="26496.03,-1063.97 26305.1,-1063.97 26255.98,-959.97 26446.92,-959.97 26496.03,-1063.97"/>
<text text-anchor="middle" x="26376.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="26376.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="26376.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="26376.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l3_gpu2 -->
<g id="node179" class="node">
<title>attn_qkv_s1_l3_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="26625.51,-1043.47 26514.51,-1043.47 26514.51,-980.47 26625.51,-980.47 26625.51,-1043.47"/>
<text text-anchor="middle" x="26570.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="26570.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="26570.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="26570.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="26570.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l3_gpu2 -->
<g id="node180" class="node">
<title>attn_out_s1_l3_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="26760.01,-1037.97 26644.01,-1037.97 26644.01,-985.97 26760.01,-985.97 26760.01,-1037.97"/>
<text text-anchor="middle" x="26702.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="26702.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="26702.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="26702.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l3_gpu3 -->
<g id="node181" class="node">
<title>attn_qkv_s1_l3_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="26889.51,-1043.47 26778.51,-1043.47 26778.51,-980.47 26889.51,-980.47 26889.51,-1043.47"/>
<text text-anchor="middle" x="26834.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="26834.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;3</text>
<text text-anchor="middle" x="26834.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="26834.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="26834.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l3_gpu3 -->
<g id="node182" class="node">
<title>attn_out_s1_l3_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="27024.01,-1037.97 26908.01,-1037.97 26908.01,-985.97 27024.01,-985.97 27024.01,-1037.97"/>
<text text-anchor="middle" x="26966.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="26966.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;3</text>
<text text-anchor="middle" x="26966.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="26966.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s1_l3 -->
<g id="node183" class="node">
<title>attn_allreduce_s1_l3</title>
<ellipse fill="lightcoral" stroke="black" cx="27099.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="27099.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="27099.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 2,3</text>
<text text-anchor="middle" x="27099.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s1_l3_gpu2 -->
<g id="node184" class="node">
<title>gate_s1_l3_gpu2</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="27400.02,-1074.97 27220.24,-1074.97 27173.99,-948.97 27353.77,-948.97 27400.02,-1074.97"/>
<text text-anchor="middle" x="27287.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="27287.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="27287.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="27287.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="27287.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s1_l3_gpu2 -->
<g id="node185" class="node">
<title>expert_s1_l3_gpu2</title>
<polygon fill="lightblue" stroke="black" points="27534.01,-1043.47 27418.01,-1043.47 27418.01,-980.47 27534.01,-980.47 27534.01,-1043.47"/>
<text text-anchor="middle" x="27476.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 0&#45;15</text>
<text text-anchor="middle" x="27476.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="27476.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="27476.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="27476.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- moe_agg_s1_l3_gpu2 -->
<g id="node186" class="node">
<title>moe_agg_s1_l3_gpu2</title>
<polygon fill="orange" stroke="black" points="27792.03,-1063.97 27601.1,-1063.97 27551.98,-959.97 27742.92,-959.97 27792.03,-1063.97"/>
<text text-anchor="middle" x="27672.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="27672.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="27672.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="27672.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l3_gpu6 -->
<g id="node187" class="node">
<title>attn_qkv_s1_l3_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="27921.51,-1043.47 27810.51,-1043.47 27810.51,-980.47 27921.51,-980.47 27921.51,-1043.47"/>
<text text-anchor="middle" x="27866.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="27866.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="27866.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="27866.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="27866.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l3_gpu6 -->
<g id="node188" class="node">
<title>attn_out_s1_l3_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="28056.01,-1037.97 27940.01,-1037.97 27940.01,-985.97 28056.01,-985.97 28056.01,-1037.97"/>
<text text-anchor="middle" x="27998.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="27998.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="27998.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="27998.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l3_gpu7 -->
<g id="node189" class="node">
<title>attn_qkv_s1_l3_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="28185.51,-1043.47 28074.51,-1043.47 28074.51,-980.47 28185.51,-980.47 28185.51,-1043.47"/>
<text text-anchor="middle" x="28130.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="28130.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;7</text>
<text text-anchor="middle" x="28130.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="28130.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="28130.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l3_gpu7 -->
<g id="node190" class="node">
<title>attn_out_s1_l3_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="28320.01,-1037.97 28204.01,-1037.97 28204.01,-985.97 28320.01,-985.97 28320.01,-1037.97"/>
<text text-anchor="middle" x="28262.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="28262.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;7</text>
<text text-anchor="middle" x="28262.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="28262.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s1_l3_dp1 -->
<g id="node191" class="node">
<title>attn_allreduce_s1_l3_dp1</title>
<ellipse fill="lightcoral" stroke="black" cx="28395.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="28395.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="28395.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 6,7</text>
<text text-anchor="middle" x="28395.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s1_l3_gpu6 -->
<g id="node192" class="node">
<title>gate_s1_l3_gpu6</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="28696.02,-1074.97 28516.24,-1074.97 28469.99,-948.97 28649.77,-948.97 28696.02,-1074.97"/>
<text text-anchor="middle" x="28583.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="28583.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="28583.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="28583.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="28583.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s1_l3_gpu6 -->
<g id="node193" class="node">
<title>expert_s1_l3_gpu6</title>
<polygon fill="lightblue" stroke="black" points="28830.01,-1043.47 28714.01,-1043.47 28714.01,-980.47 28830.01,-980.47 28830.01,-1043.47"/>
<text text-anchor="middle" x="28772.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 32&#45;47</text>
<text text-anchor="middle" x="28772.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="28772.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="28772.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="28772.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- moe_agg_s1_l3_gpu6 -->
<g id="node194" class="node">
<title>moe_agg_s1_l3_gpu6</title>
<polygon fill="orange" stroke="black" points="29088.03,-1063.97 28897.1,-1063.97 28847.98,-959.97 29038.92,-959.97 29088.03,-1063.97"/>
<text text-anchor="middle" x="28968.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="28968.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="28968.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="28968.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l4_gpu2 -->
<g id="node195" class="node">
<title>attn_qkv_s1_l4_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="29217.51,-1043.47 29106.51,-1043.47 29106.51,-980.47 29217.51,-980.47 29217.51,-1043.47"/>
<text text-anchor="middle" x="29162.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="29162.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="29162.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="29162.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="29162.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l4_gpu2 -->
<g id="node196" class="node">
<title>attn_out_s1_l4_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="29352.01,-1037.97 29236.01,-1037.97 29236.01,-985.97 29352.01,-985.97 29352.01,-1037.97"/>
<text text-anchor="middle" x="29294.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="29294.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="29294.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="29294.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l4_gpu3 -->
<g id="node197" class="node">
<title>attn_qkv_s1_l4_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="29481.51,-1043.47 29370.51,-1043.47 29370.51,-980.47 29481.51,-980.47 29481.51,-1043.47"/>
<text text-anchor="middle" x="29426.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="29426.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;3</text>
<text text-anchor="middle" x="29426.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="29426.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="29426.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l4_gpu3 -->
<g id="node198" class="node">
<title>attn_out_s1_l4_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="29616.01,-1037.97 29500.01,-1037.97 29500.01,-985.97 29616.01,-985.97 29616.01,-1037.97"/>
<text text-anchor="middle" x="29558.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="29558.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;3</text>
<text text-anchor="middle" x="29558.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="29558.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s1_l4 -->
<g id="node199" class="node">
<title>attn_allreduce_s1_l4</title>
<ellipse fill="lightcoral" stroke="black" cx="29691.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="29691.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="29691.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 2,3</text>
<text text-anchor="middle" x="29691.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s1_l4_gpu2 -->
<g id="node200" class="node">
<title>gate_s1_l4_gpu2</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="29992.02,-1074.97 29812.24,-1074.97 29765.99,-948.97 29945.77,-948.97 29992.02,-1074.97"/>
<text text-anchor="middle" x="29879.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="29879.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="29879.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="29879.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="29879.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s1_l4_gpu2 -->
<g id="node201" class="node">
<title>expert_s1_l4_gpu2</title>
<polygon fill="lightblue" stroke="black" points="30126.01,-1043.47 30010.01,-1043.47 30010.01,-980.47 30126.01,-980.47 30126.01,-1043.47"/>
<text text-anchor="middle" x="30068.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 0&#45;15</text>
<text text-anchor="middle" x="30068.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="30068.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="30068.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="30068.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- moe_agg_s1_l4_gpu2 -->
<g id="node202" class="node">
<title>moe_agg_s1_l4_gpu2</title>
<polygon fill="orange" stroke="black" points="30384.03,-1063.97 30193.1,-1063.97 30143.98,-959.97 30334.92,-959.97 30384.03,-1063.97"/>
<text text-anchor="middle" x="30264.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="30264.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="30264.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="30264.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l4_gpu6 -->
<g id="node203" class="node">
<title>attn_qkv_s1_l4_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="30513.51,-1043.47 30402.51,-1043.47 30402.51,-980.47 30513.51,-980.47 30513.51,-1043.47"/>
<text text-anchor="middle" x="30458.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="30458.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="30458.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="30458.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="30458.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l4_gpu6 -->
<g id="node204" class="node">
<title>attn_out_s1_l4_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="30648.01,-1037.97 30532.01,-1037.97 30532.01,-985.97 30648.01,-985.97 30648.01,-1037.97"/>
<text text-anchor="middle" x="30590.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="30590.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="30590.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="30590.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l4_gpu7 -->
<g id="node205" class="node">
<title>attn_qkv_s1_l4_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="30777.51,-1043.47 30666.51,-1043.47 30666.51,-980.47 30777.51,-980.47 30777.51,-1043.47"/>
<text text-anchor="middle" x="30722.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="30722.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;7</text>
<text text-anchor="middle" x="30722.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="30722.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="30722.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l4_gpu7 -->
<g id="node206" class="node">
<title>attn_out_s1_l4_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="30912.01,-1037.97 30796.01,-1037.97 30796.01,-985.97 30912.01,-985.97 30912.01,-1037.97"/>
<text text-anchor="middle" x="30854.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="30854.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;7</text>
<text text-anchor="middle" x="30854.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="30854.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s1_l4_dp1 -->
<g id="node207" class="node">
<title>attn_allreduce_s1_l4_dp1</title>
<ellipse fill="lightcoral" stroke="black" cx="30987.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="30987.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="30987.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 6,7</text>
<text text-anchor="middle" x="30987.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s1_l4_gpu6 -->
<g id="node208" class="node">
<title>gate_s1_l4_gpu6</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="31288.02,-1074.97 31108.24,-1074.97 31061.99,-948.97 31241.77,-948.97 31288.02,-1074.97"/>
<text text-anchor="middle" x="31175.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="31175.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="31175.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="31175.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="31175.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s1_l4_gpu6 -->
<g id="node209" class="node">
<title>expert_s1_l4_gpu6</title>
<polygon fill="lightblue" stroke="black" points="31422.01,-1043.47 31306.01,-1043.47 31306.01,-980.47 31422.01,-980.47 31422.01,-1043.47"/>
<text text-anchor="middle" x="31364.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 32&#45;47</text>
<text text-anchor="middle" x="31364.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="31364.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="31364.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="31364.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- moe_agg_s1_l4_gpu6 -->
<g id="node210" class="node">
<title>moe_agg_s1_l4_gpu6</title>
<polygon fill="orange" stroke="black" points="31680.03,-1063.97 31489.1,-1063.97 31439.98,-959.97 31630.92,-959.97 31680.03,-1063.97"/>
<text text-anchor="middle" x="31560.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="31560.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="31560.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="31560.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l5_gpu2 -->
<g id="node211" class="node">
<title>attn_qkv_s1_l5_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="31809.51,-1043.47 31698.51,-1043.47 31698.51,-980.47 31809.51,-980.47 31809.51,-1043.47"/>
<text text-anchor="middle" x="31754.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="31754.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="31754.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="31754.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="31754.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l5_gpu2 -->
<g id="node212" class="node">
<title>attn_out_s1_l5_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="31944.01,-1037.97 31828.01,-1037.97 31828.01,-985.97 31944.01,-985.97 31944.01,-1037.97"/>
<text text-anchor="middle" x="31886.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="31886.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="31886.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="31886.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l5_gpu3 -->
<g id="node213" class="node">
<title>attn_qkv_s1_l5_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="32073.51,-1043.47 31962.51,-1043.47 31962.51,-980.47 32073.51,-980.47 32073.51,-1043.47"/>
<text text-anchor="middle" x="32018.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="32018.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;3</text>
<text text-anchor="middle" x="32018.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="32018.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="32018.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l5_gpu3 -->
<g id="node214" class="node">
<title>attn_out_s1_l5_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="32208.01,-1037.97 32092.01,-1037.97 32092.01,-985.97 32208.01,-985.97 32208.01,-1037.97"/>
<text text-anchor="middle" x="32150.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="32150.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;3</text>
<text text-anchor="middle" x="32150.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="32150.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s1_l5 -->
<g id="node215" class="node">
<title>attn_allreduce_s1_l5</title>
<ellipse fill="lightcoral" stroke="black" cx="32283.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="32283.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="32283.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 2,3</text>
<text text-anchor="middle" x="32283.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s1_l5_gpu2 -->
<g id="node216" class="node">
<title>gate_s1_l5_gpu2</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="32584.02,-1074.97 32404.24,-1074.97 32357.99,-948.97 32537.77,-948.97 32584.02,-1074.97"/>
<text text-anchor="middle" x="32471.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="32471.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="32471.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="32471.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="32471.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s1_l5_gpu2 -->
<g id="node217" class="node">
<title>expert_s1_l5_gpu2</title>
<polygon fill="lightblue" stroke="black" points="32718.01,-1043.47 32602.01,-1043.47 32602.01,-980.47 32718.01,-980.47 32718.01,-1043.47"/>
<text text-anchor="middle" x="32660.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 0&#45;15</text>
<text text-anchor="middle" x="32660.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="32660.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="32660.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="32660.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- moe_agg_s1_l5_gpu2 -->
<g id="node218" class="node">
<title>moe_agg_s1_l5_gpu2</title>
<polygon fill="orange" stroke="black" points="32976.03,-1063.97 32785.1,-1063.97 32735.98,-959.97 32926.92,-959.97 32976.03,-1063.97"/>
<text text-anchor="middle" x="32856.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="32856.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="32856.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="32856.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l5_gpu6 -->
<g id="node219" class="node">
<title>attn_qkv_s1_l5_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="33105.51,-1043.47 32994.51,-1043.47 32994.51,-980.47 33105.51,-980.47 33105.51,-1043.47"/>
<text text-anchor="middle" x="33050.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="33050.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="33050.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="33050.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="33050.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l5_gpu6 -->
<g id="node220" class="node">
<title>attn_out_s1_l5_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="33240.01,-1037.97 33124.01,-1037.97 33124.01,-985.97 33240.01,-985.97 33240.01,-1037.97"/>
<text text-anchor="middle" x="33182.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="33182.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="33182.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="33182.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l5_gpu7 -->
<g id="node221" class="node">
<title>attn_qkv_s1_l5_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="33369.51,-1043.47 33258.51,-1043.47 33258.51,-980.47 33369.51,-980.47 33369.51,-1043.47"/>
<text text-anchor="middle" x="33314.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="33314.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;7</text>
<text text-anchor="middle" x="33314.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="33314.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="33314.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l5_gpu7 -->
<g id="node222" class="node">
<title>attn_out_s1_l5_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="33504.01,-1037.97 33388.01,-1037.97 33388.01,-985.97 33504.01,-985.97 33504.01,-1037.97"/>
<text text-anchor="middle" x="33446.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="33446.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;7</text>
<text text-anchor="middle" x="33446.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="33446.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s1_l5_dp1 -->
<g id="node223" class="node">
<title>attn_allreduce_s1_l5_dp1</title>
<ellipse fill="lightcoral" stroke="black" cx="33579.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="33579.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="33579.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 6,7</text>
<text text-anchor="middle" x="33579.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s1_l5_gpu6 -->
<g id="node224" class="node">
<title>gate_s1_l5_gpu6</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="33880.02,-1074.97 33700.24,-1074.97 33653.99,-948.97 33833.77,-948.97 33880.02,-1074.97"/>
<text text-anchor="middle" x="33767.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="33767.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="33767.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="33767.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="33767.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s1_l5_gpu6 -->
<g id="node225" class="node">
<title>expert_s1_l5_gpu6</title>
<polygon fill="lightblue" stroke="black" points="34014.01,-1043.47 33898.01,-1043.47 33898.01,-980.47 34014.01,-980.47 34014.01,-1043.47"/>
<text text-anchor="middle" x="33956.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 32&#45;47</text>
<text text-anchor="middle" x="33956.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="33956.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="33956.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="33956.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- moe_agg_s1_l5_gpu6 -->
<g id="node226" class="node">
<title>moe_agg_s1_l5_gpu6</title>
<polygon fill="orange" stroke="black" points="34272.03,-1063.97 34081.1,-1063.97 34031.98,-959.97 34222.92,-959.97 34272.03,-1063.97"/>
<text text-anchor="middle" x="34152.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="34152.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="34152.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="34152.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l6_gpu2 -->
<g id="node227" class="node">
<title>attn_qkv_s1_l6_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="34401.51,-1043.47 34290.51,-1043.47 34290.51,-980.47 34401.51,-980.47 34401.51,-1043.47"/>
<text text-anchor="middle" x="34346.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="34346.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="34346.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="34346.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="34346.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l6_gpu2 -->
<g id="node228" class="node">
<title>attn_out_s1_l6_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="34536.01,-1037.97 34420.01,-1037.97 34420.01,-985.97 34536.01,-985.97 34536.01,-1037.97"/>
<text text-anchor="middle" x="34478.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="34478.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="34478.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="34478.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l6_gpu3 -->
<g id="node229" class="node">
<title>attn_qkv_s1_l6_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="34665.51,-1043.47 34554.51,-1043.47 34554.51,-980.47 34665.51,-980.47 34665.51,-1043.47"/>
<text text-anchor="middle" x="34610.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="34610.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;3</text>
<text text-anchor="middle" x="34610.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="34610.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="34610.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l6_gpu3 -->
<g id="node230" class="node">
<title>attn_out_s1_l6_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="34800.01,-1037.97 34684.01,-1037.97 34684.01,-985.97 34800.01,-985.97 34800.01,-1037.97"/>
<text text-anchor="middle" x="34742.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="34742.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;3</text>
<text text-anchor="middle" x="34742.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="34742.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s1_l6 -->
<g id="node231" class="node">
<title>attn_allreduce_s1_l6</title>
<ellipse fill="lightcoral" stroke="black" cx="34875.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="34875.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="34875.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 2,3</text>
<text text-anchor="middle" x="34875.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s1_l6_gpu2 -->
<g id="node232" class="node">
<title>gate_s1_l6_gpu2</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="35176.02,-1074.97 34996.24,-1074.97 34949.99,-948.97 35129.77,-948.97 35176.02,-1074.97"/>
<text text-anchor="middle" x="35063.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="35063.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="35063.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="35063.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="35063.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s1_l6_gpu2 -->
<g id="node233" class="node">
<title>expert_s1_l6_gpu2</title>
<polygon fill="lightblue" stroke="black" points="35310.01,-1043.47 35194.01,-1043.47 35194.01,-980.47 35310.01,-980.47 35310.01,-1043.47"/>
<text text-anchor="middle" x="35252.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 0&#45;15</text>
<text text-anchor="middle" x="35252.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="35252.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="35252.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="35252.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- moe_agg_s1_l6_gpu2 -->
<g id="node234" class="node">
<title>moe_agg_s1_l6_gpu2</title>
<polygon fill="orange" stroke="black" points="35568.03,-1063.97 35377.1,-1063.97 35327.98,-959.97 35518.92,-959.97 35568.03,-1063.97"/>
<text text-anchor="middle" x="35448.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="35448.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="35448.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="35448.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l6_gpu6 -->
<g id="node235" class="node">
<title>attn_qkv_s1_l6_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="35697.51,-1043.47 35586.51,-1043.47 35586.51,-980.47 35697.51,-980.47 35697.51,-1043.47"/>
<text text-anchor="middle" x="35642.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="35642.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="35642.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="35642.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="35642.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l6_gpu6 -->
<g id="node236" class="node">
<title>attn_out_s1_l6_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="35832.01,-1037.97 35716.01,-1037.97 35716.01,-985.97 35832.01,-985.97 35832.01,-1037.97"/>
<text text-anchor="middle" x="35774.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="35774.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="35774.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="35774.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l6_gpu7 -->
<g id="node237" class="node">
<title>attn_qkv_s1_l6_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="35961.51,-1043.47 35850.51,-1043.47 35850.51,-980.47 35961.51,-980.47 35961.51,-1043.47"/>
<text text-anchor="middle" x="35906.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="35906.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;7</text>
<text text-anchor="middle" x="35906.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="35906.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="35906.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l6_gpu7 -->
<g id="node238" class="node">
<title>attn_out_s1_l6_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="36096.01,-1037.97 35980.01,-1037.97 35980.01,-985.97 36096.01,-985.97 36096.01,-1037.97"/>
<text text-anchor="middle" x="36038.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="36038.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;7</text>
<text text-anchor="middle" x="36038.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="36038.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s1_l6_dp1 -->
<g id="node239" class="node">
<title>attn_allreduce_s1_l6_dp1</title>
<ellipse fill="lightcoral" stroke="black" cx="36171.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="36171.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="36171.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 6,7</text>
<text text-anchor="middle" x="36171.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s1_l6_gpu6 -->
<g id="node240" class="node">
<title>gate_s1_l6_gpu6</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="36472.02,-1074.97 36292.24,-1074.97 36245.99,-948.97 36425.77,-948.97 36472.02,-1074.97"/>
<text text-anchor="middle" x="36359.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="36359.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="36359.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="36359.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="36359.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s1_l6_gpu6 -->
<g id="node241" class="node">
<title>expert_s1_l6_gpu6</title>
<polygon fill="lightblue" stroke="black" points="36606.01,-1043.47 36490.01,-1043.47 36490.01,-980.47 36606.01,-980.47 36606.01,-1043.47"/>
<text text-anchor="middle" x="36548.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 32&#45;47</text>
<text text-anchor="middle" x="36548.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="36548.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="36548.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="36548.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- moe_agg_s1_l6_gpu6 -->
<g id="node242" class="node">
<title>moe_agg_s1_l6_gpu6</title>
<polygon fill="orange" stroke="black" points="36864.03,-1063.97 36673.1,-1063.97 36623.98,-959.97 36814.92,-959.97 36864.03,-1063.97"/>
<text text-anchor="middle" x="36744.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="36744.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="36744.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="36744.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l7_gpu2 -->
<g id="node243" class="node">
<title>attn_qkv_s1_l7_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="36993.51,-1043.47 36882.51,-1043.47 36882.51,-980.47 36993.51,-980.47 36993.51,-1043.47"/>
<text text-anchor="middle" x="36938.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="36938.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="36938.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="36938.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="36938.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l7_gpu2 -->
<g id="node244" class="node">
<title>attn_out_s1_l7_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="37128.01,-1037.97 37012.01,-1037.97 37012.01,-985.97 37128.01,-985.97 37128.01,-1037.97"/>
<text text-anchor="middle" x="37070.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="37070.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="37070.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="37070.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l7_gpu3 -->
<g id="node245" class="node">
<title>attn_qkv_s1_l7_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="37257.51,-1043.47 37146.51,-1043.47 37146.51,-980.47 37257.51,-980.47 37257.51,-1043.47"/>
<text text-anchor="middle" x="37202.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="37202.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;3</text>
<text text-anchor="middle" x="37202.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="37202.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="37202.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l7_gpu3 -->
<g id="node246" class="node">
<title>attn_out_s1_l7_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="37392.01,-1037.97 37276.01,-1037.97 37276.01,-985.97 37392.01,-985.97 37392.01,-1037.97"/>
<text text-anchor="middle" x="37334.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="37334.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;3</text>
<text text-anchor="middle" x="37334.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="37334.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s1_l7 -->
<g id="node247" class="node">
<title>attn_allreduce_s1_l7</title>
<ellipse fill="lightcoral" stroke="black" cx="37467.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="37467.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="37467.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 2,3</text>
<text text-anchor="middle" x="37467.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s1_l7_gpu2 -->
<g id="node248" class="node">
<title>gate_s1_l7_gpu2</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="37768.02,-1074.97 37588.24,-1074.97 37541.99,-948.97 37721.77,-948.97 37768.02,-1074.97"/>
<text text-anchor="middle" x="37655.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="37655.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="37655.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="37655.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="37655.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s1_l7_gpu2 -->
<g id="node249" class="node">
<title>expert_s1_l7_gpu2</title>
<polygon fill="lightblue" stroke="black" points="37902.01,-1043.47 37786.01,-1043.47 37786.01,-980.47 37902.01,-980.47 37902.01,-1043.47"/>
<text text-anchor="middle" x="37844.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 0&#45;15</text>
<text text-anchor="middle" x="37844.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="37844.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="37844.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="37844.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- moe_agg_s1_l7_gpu2 -->
<g id="node250" class="node">
<title>moe_agg_s1_l7_gpu2</title>
<polygon fill="orange" stroke="black" points="38160.03,-1063.97 37969.1,-1063.97 37919.98,-959.97 38110.92,-959.97 38160.03,-1063.97"/>
<text text-anchor="middle" x="38040.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="38040.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;2</text>
<text text-anchor="middle" x="38040.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="38040.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- dp_reduce -->
<g id="node260" class="node">
<title>dp_reduce</title>
<ellipse fill="lightcoral" stroke="black" cx="38401.01" cy="-882.97" rx="77.56" ry="28.98"/>
<text text-anchor="middle" x="38401.01" y="-891.47" font-family="Arial" font-size="10.00">Data Parallel Reduce</text>
<text text-anchor="middle" x="38401.01" y="-880.47" font-family="Arial" font-size="10.00">2&#45;way DP</text>
<text text-anchor="middle" x="38401.01" y="-869.47" font-family="Arial" font-size="10.00">Gradient sync</text>
</g>
<!-- moe_agg_s1_l7_gpu2&#45;&gt;dp_reduce -->
<g id="edge26" class="edge">
<title>moe_agg_s1_l7_gpu2&#45;&gt;dp_reduce</title>
<path fill="none" stroke="black" d="M38040.01,-959.85C38040.01,-923.7 38040.01,-882 38040.01,-882 38040.01,-882 38313.12,-882 38313.12,-882"/>
<polygon fill="black" stroke="black" points="38313.12,-885.5 38323.12,-882 38313.12,-878.5 38313.12,-885.5"/>
</g>
<!-- attn_qkv_s1_l7_gpu6 -->
<g id="node251" class="node">
<title>attn_qkv_s1_l7_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="38846.51,-1043.47 38735.51,-1043.47 38735.51,-980.47 38846.51,-980.47 38846.51,-1043.47"/>
<text text-anchor="middle" x="38791.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="38791.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="38791.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="38791.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="38791.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l7_gpu6 -->
<g id="node252" class="node">
<title>attn_out_s1_l7_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="38981.01,-1037.97 38865.01,-1037.97 38865.01,-985.97 38981.01,-985.97 38981.01,-1037.97"/>
<text text-anchor="middle" x="38923.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="38923.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="38923.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="38923.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_qkv_s1_l7_gpu7 -->
<g id="node253" class="node">
<title>attn_qkv_s1_l7_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="39110.51,-1043.47 38999.51,-1043.47 38999.51,-980.47 39110.51,-980.47 39110.51,-1043.47"/>
<text text-anchor="middle" x="39055.01" y="-1031.47" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="39055.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;7</text>
<text text-anchor="middle" x="39055.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="39055.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,512]</text>
<text text-anchor="middle" x="39055.01" y="-987.47" font-family="Arial" font-size="10.00">8 heads, 64d each</text>
</g>
<!-- attn_out_s1_l7_gpu7 -->
<g id="node254" class="node">
<title>attn_out_s1_l7_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="39245.01,-1037.97 39129.01,-1037.97 39129.01,-985.97 39245.01,-985.97 39245.01,-1037.97"/>
<text text-anchor="middle" x="39187.01" y="-1025.97" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="39187.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;7</text>
<text text-anchor="middle" x="39187.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,512]</text>
<text text-anchor="middle" x="39187.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- attn_allreduce_s1_l7_dp1 -->
<g id="node255" class="node">
<title>attn_allreduce_s1_l7_dp1</title>
<ellipse fill="lightcoral" stroke="black" cx="39320.01" cy="-1011.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="39320.01" y="-1020.47" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="39320.01" y="-1009.47" font-family="Arial" font-size="10.00">TP Group 6,7</text>
<text text-anchor="middle" x="39320.01" y="-998.47" font-family="Arial" font-size="10.00">[64,1024,1024]</text>
</g>
<!-- gate_s1_l7_gpu6 -->
<g id="node256" class="node">
<title>gate_s1_l7_gpu6</title>
<polygon fill="orange" stroke="black" stroke-dasharray="5,2" points="39621.02,-1074.97 39441.24,-1074.97 39394.99,-948.97 39574.77,-948.97 39621.02,-1074.97"/>
<text text-anchor="middle" x="39508.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="39508.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="39508.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="39508.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,4]</text>
<text text-anchor="middle" x="39508.01" y="-987.47" font-family="Arial" font-size="10.00">Top&#45;1 routing</text>
</g>
<!-- expert_s1_l7_gpu6 -->
<g id="node257" class="node">
<title>expert_s1_l7_gpu6</title>
<polygon fill="lightblue" stroke="black" points="39755.01,-1043.47 39639.01,-1043.47 39639.01,-980.47 39755.01,-980.47 39755.01,-1043.47"/>
<text text-anchor="middle" x="39697.01" y="-1031.47" font-family="Arial" font-size="10.00">MoE Experts 32&#45;47</text>
<text text-anchor="middle" x="39697.01" y="-1020.47" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="39697.01" y="-1009.47" font-family="Arial" font-size="10.00">Input: [64,1024,1024]</text>
<text text-anchor="middle" x="39697.01" y="-998.47" font-family="Arial" font-size="10.00">Output: [64,1024,2048]</text>
<text text-anchor="middle" x="39697.01" y="-987.47" font-family="Arial" font-size="10.00">16 experts</text>
</g>
<!-- moe_agg_s1_l7_gpu6 -->
<g id="node258" class="node">
<title>moe_agg_s1_l7_gpu6</title>
<polygon fill="orange" stroke="black" points="38419.03,-1063.97 38228.1,-1063.97 38178.98,-959.97 38369.92,-959.97 38419.03,-1063.97"/>
<text text-anchor="middle" x="38299.01" y="-1025.97" font-family="Arial" font-size="10.00">MoE Aggregate</text>
<text text-anchor="middle" x="38299.01" y="-1014.97" font-family="Arial" font-size="10.00">GPU&#45;6</text>
<text text-anchor="middle" x="38299.01" y="-1003.97" font-family="Arial" font-size="10.00">Input: [64,1024,2048]</text>
<text text-anchor="middle" x="38299.01" y="-992.97" font-family="Arial" font-size="10.00">Output: [64,1024,1024]</text>
</g>
<!-- moe_agg_s1_l7_gpu6&#45;&gt;dp_reduce -->
<g id="edge28" class="edge">
<title>moe_agg_s1_l7_gpu6&#45;&gt;dp_reduce</title>
<path fill="none" stroke="black" d="M38371.25,-962.46C38371.25,-962.46 38371.25,-919.79 38371.25,-919.79"/>
<polygon fill="black" stroke="black" points="38374.75,-919.79 38371.25,-909.79 38367.75,-919.79 38374.75,-919.79"/>
</g>
<!-- pipe_comm_s0_s1&#45;&gt;attn_qkv_s1_l0_gpu2 -->
<g id="edge24" class="edge">
<title>pipe_comm_s0_s1&#45;&gt;attn_qkv_s1_l0_gpu2</title>
<path fill="none" stroke="black" d="M18688.49,-858.86C18688.49,-858.86 18688.49,-827.02 18688.49,-827.02"/>
<polygon fill="black" stroke="black" points="18691.99,-827.02 18688.49,-817.02 18684.99,-827.02 18691.99,-827.02"/>
</g>
<!-- pipe_comm_s0_s1&#45;&gt;attn_qkv_s1_l0_gpu3 -->
<g id="edge25" class="edge">
<title>pipe_comm_s0_s1&#45;&gt;attn_qkv_s1_l0_gpu3</title>
<path fill="none" stroke="black" d="M18771.03,-858.86C18771.03,-858.86 18771.03,-827.02 18771.03,-827.02"/>
<polygon fill="black" stroke="black" points="18774.53,-827.02 18771.03,-817.02 18767.53,-827.02 18774.53,-827.02"/>
</g>
<!-- output -->
<g id="node261" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="38401.01" cy="-785.47" rx="101.23" ry="28.98"/>
<text text-anchor="middle" x="38401.01" y="-793.97" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="38401.01" y="-782.97" font-family="Arial" font-size="10.00">Batch: [128, 1024, 1024]</text>
<text text-anchor="middle" x="38401.01" y="-771.97" font-family="Arial" font-size="10.00">Seq_len=1024, Hidden=1024</text>
</g>
<!-- dp_reduce&#45;&gt;output -->
<g id="edge30" class="edge">
<title>dp_reduce&#45;&gt;output</title>
<path fill="none" stroke="black" d="M38401.01,-853.71C38401.01,-853.71 38401.01,-824.7 38401.01,-824.7"/>
<polygon fill="black" stroke="black" points="38404.51,-824.7 38401.01,-814.7 38397.51,-824.7 38404.51,-824.7"/>
</g>
<!-- moe_agg_s1_l7_gpu3 -->
<g id="node262" class="node">
<title>moe_agg_s1_l7_gpu3</title>
<ellipse fill="none" stroke="black" cx="38503.01" cy="-1011.97" rx="65.18" ry="18"/>
<text text-anchor="middle" x="38503.01" y="-1009.47" font-family="Arial" font-size="10.00">moe_agg_s1_l7_gpu3</text>
</g>
<!-- moe_agg_s1_l7_gpu3&#45;&gt;dp_reduce -->
<g id="edge27" class="edge">
<title>moe_agg_s1_l7_gpu3&#45;&gt;dp_reduce</title>
<path fill="none" stroke="black" d="M38458.23,-998.65C38458.23,-998.65 38458.23,-912.7 38458.23,-912.7"/>
<polygon fill="black" stroke="black" points="38461.73,-912.7 38458.23,-902.7 38454.73,-912.7 38461.73,-912.7"/>
</g>
<!-- moe_agg_s1_l7_gpu7 -->
<g id="node263" class="node">
<title>moe_agg_s1_l7_gpu7</title>
<ellipse fill="none" stroke="black" cx="38652.01" cy="-1011.97" rx="65.18" ry="18"/>
<text text-anchor="middle" x="38652.01" y="-1009.47" font-family="Arial" font-size="10.00">moe_agg_s1_l7_gpu7</text>
</g>
<!-- moe_agg_s1_l7_gpu7&#45;&gt;dp_reduce -->
<g id="edge29" class="edge">
<title>moe_agg_s1_l7_gpu7&#45;&gt;dp_reduce</title>
<path fill="none" stroke="black" d="M38652.01,-993.89C38652.01,-958.18 38652.01,-882 38652.01,-882 38652.01,-882 38489.05,-882 38489.05,-882"/>
<polygon fill="black" stroke="black" points="38489.05,-878.5 38479.05,-882 38489.05,-885.5 38489.05,-878.5"/>
</g>
</g>
</svg>
