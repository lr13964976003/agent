<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="130pt" height="1080pt"
 viewBox="0.00 0.00 130.16 1080.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.06 0.06) rotate(0) translate(4 19478.28)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-19478.28 2344.05,-19478.28 2344.05,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_legend</title>
<polygon fill="none" stroke="gray" stroke-dasharray="5,2" points="8,-19341.28 8,-19416.28 922,-19416.28 922,-19341.28 8,-19341.28"/>
<text text-anchor="middle" x="465" y="-19401.08" font-family="Arial" font-size="14.00">Legend</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage0</title>
<path fill="none" stroke="black" d="M942,-9784.62C942,-9784.62 2218,-9784.62 2218,-9784.62 2224,-9784.62 2230,-9790.62 2230,-9796.62 2230,-9796.62 2230,-19454.28 2230,-19454.28 2230,-19460.28 2224,-19466.28 2218,-19466.28 2218,-19466.28 942,-19466.28 942,-19466.28 936,-19466.28 930,-19460.28 930,-19454.28 930,-19454.28 930,-9796.62 930,-9796.62 930,-9790.62 936,-9784.62 942,-9784.62"/>
<text text-anchor="middle" x="1580" y="-19451.08" font-family="Arial" font-size="14.00">Pipeline Stage 0 (Devices 0&#45;7)</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_stage1</title>
<path fill="none" stroke="black" d="M836,-164C836,-164 2112,-164 2112,-164 2118,-164 2124,-170 2124,-176 2124,-176 2124,-9661.66 2124,-9661.66 2124,-9667.66 2118,-9673.66 2112,-9673.66 2112,-9673.66 836,-9673.66 836,-9673.66 830,-9673.66 824,-9667.66 824,-9661.66 824,-9661.66 824,-176 824,-176 824,-170 830,-164 836,-164"/>
<text text-anchor="middle" x="1474" y="-9658.46" font-family="Arial" font-size="14.00">Pipeline Stage 1 (Devices 8&#45;15)</text>
</g>
<!-- legend_compute -->
<g id="node1" class="node">
<title>legend_compute</title>
<polygon fill="lightblue" stroke="lightblue" points="913.5,-19385.28 804.5,-19385.28 804.5,-19349.28 913.5,-19349.28 913.5,-19385.28"/>
<text text-anchor="middle" x="859" y="-19363.58" font-family="Times,serif" font-size="14.00">Computation</text>
</g>
<!-- legend_comm -->
<g id="node2" class="node">
<title>legend_comm</title>
<ellipse fill="lightgreen" stroke="lightgreen" cx="703" cy="-19367.28" rx="83.39" ry="18"/>
<text text-anchor="middle" x="703" y="-19363.58" font-family="Times,serif" font-size="14.00">Communication</text>
</g>
<!-- legend_route -->
<g id="node3" class="node">
<title>legend_route</title>
<polygon fill="lightyellow" stroke="lightyellow" points="602.47,-19385.28 351.97,-19385.28 287.53,-19349.28 538.03,-19349.28 602.47,-19385.28"/>
<text text-anchor="middle" x="445" y="-19363.58" font-family="Times,serif" font-size="14.00">Routing/Aggregation</text>
</g>
<!-- legend_gather -->
<g id="node4" class="node">
<title>legend_gather</title>
<ellipse fill="orange" stroke="orange" cx="212" cy="-19367.28" rx="57.69" ry="18"/>
<text text-anchor="middle" x="212" y="-19363.58" font-family="Times,serif" font-size="14.00">All&#45;Gather</text>
</g>
<!-- legend_reduce -->
<g id="node5" class="node">
<title>legend_reduce</title>
<ellipse fill="red" stroke="red" cx="76" cy="-19367.28" rx="59.59" ry="18"/>
<text text-anchor="middle" x="76" y="-19363.58" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- input -->
<g id="node6" class="node">
<title>input</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2076.73,-19435.28 1499.71,-19435.28 1351.27,-19299.28 1928.29,-19299.28 2076.73,-19435.28"/>
<text text-anchor="middle" x="1714" y="-19386.08" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="1714" y="-19371.08" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1714" y="-19356.08" font-family="Times,serif" font-size="14.00">Device: All GPUs</text>
<text text-anchor="middle" x="1714" y="-19341.08" font-family="Times,serif" font-size="14.00">Layer: Embedding</text>
</g>
<!-- mha_q_0 -->
<g id="node7" class="node">
<title>mha_q_0</title>
<polygon fill="lightblue" stroke="lightblue" points="1347.5,-19263.28 938.5,-19263.28 938.5,-19195.28 1347.5,-19195.28 1347.5,-19263.28"/>
<text text-anchor="middle" x="1143" y="-19248.08" font-family="Times,serif" font-size="14.00">Layer0_MHA_Q</text>
<text text-anchor="middle" x="1143" y="-19233.08" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1143" y="-19218.08" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1143" y="-19203.08" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- input&#45;&gt;mha_q_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;mha_q_0</title>
<path fill="none" stroke="black" d="M1432.68,-19299.28C1383.87,-19287.65 1334.9,-19275.99 1291.47,-19265.65"/>
<polygon fill="black" stroke="black" points="1292.26,-19262.23 1281.72,-19263.32 1290.63,-19269.04 1292.26,-19262.23"/>
</g>
<!-- mha_k_0 -->
<g id="node8" class="node">
<title>mha_k_0</title>
<polygon fill="lightblue" stroke="lightblue" points="1774.5,-19263.28 1365.5,-19263.28 1365.5,-19195.28 1774.5,-19195.28 1774.5,-19263.28"/>
<text text-anchor="middle" x="1570" y="-19248.08" font-family="Times,serif" font-size="14.00">Layer0_MHA_K</text>
<text text-anchor="middle" x="1570" y="-19233.08" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1570" y="-19218.08" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1570" y="-19203.08" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- input&#45;&gt;mha_k_0 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;mha_k_0</title>
<path fill="none" stroke="black" d="M1642.84,-19299.08C1632.44,-19289.26 1622.02,-19279.41 1612.44,-19270.37"/>
<polygon fill="black" stroke="black" points="1614.63,-19267.62 1604.96,-19263.3 1609.83,-19272.71 1614.63,-19267.62"/>
</g>
<!-- mha_v_0 -->
<g id="node9" class="node">
<title>mha_v_0</title>
<polygon fill="lightblue" stroke="lightblue" points="2201.5,-19263.28 1792.5,-19263.28 1792.5,-19195.28 2201.5,-19195.28 2201.5,-19263.28"/>
<text text-anchor="middle" x="1997" y="-19248.08" font-family="Times,serif" font-size="14.00">Layer0_MHA_V</text>
<text text-anchor="middle" x="1997" y="-19233.08" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1997" y="-19218.08" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1997" y="-19203.08" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- input&#45;&gt;mha_v_0 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;mha_v_0</title>
<path fill="none" stroke="black" d="M1853.43,-19299.28C1875.93,-19288.46 1898.51,-19277.62 1918.87,-19267.83"/>
<polygon fill="black" stroke="black" points="1920.57,-19270.9 1928.07,-19263.41 1917.54,-19264.59 1920.57,-19270.9"/>
</g>
<!-- attn_residual_0 -->
<g id="node13" class="node">
<title>attn_residual_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2222.11,-18819.12 1625.39,-18819.12 1471.89,-18653.12 2068.61,-18653.12 2222.11,-18819.12"/>
<text text-anchor="middle" x="1847" y="-18762.42" font-family="Times,serif" font-size="14.00">Layer0_Attn_Residual</text>
<text text-anchor="middle" x="1847" y="-18747.42" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-18732.42" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-18717.42" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-18702.42" font-family="Times,serif" font-size="14.00">Device: 0&#45;7</text>
</g>
<!-- input&#45;&gt;attn_residual_0 -->
<g id="edge10" class="edge">
<title>input&#45;&gt;attn_residual_0</title>
<path fill="none" stroke="black" d="M1973.91,-19341.03C2076.61,-19325.4 2178.04,-19300.89 2211,-19263.28 2251.24,-19217.37 2221,-19187.33 2221,-19126.28 2221,-19126.28 2221,-19126.28 2221,-19020.28 2221,-18932.84 2155.22,-18868.94 2078.83,-18824.21"/>
<polygon fill="black" stroke="black" points="2080.37,-18821.06 2069.96,-18819.13 2076.89,-18827.14 2080.37,-18821.06"/>
</g>
<!-- attn_score_0 -->
<g id="node10" class="node">
<title>attn_score_0</title>
<polygon fill="lightblue" stroke="lightblue" points="1784,-19159.28 1356,-19159.28 1356,-19091.28 1784,-19091.28 1784,-19159.28"/>
<text text-anchor="middle" x="1570" y="-19144.08" font-family="Times,serif" font-size="14.00">Layer0_Attn_Score</text>
<text text-anchor="middle" x="1570" y="-19129.08" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1570" y="-19114.08" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1570" y="-19099.08" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- mha_q_0&#45;&gt;attn_score_0 -->
<g id="edge4" class="edge">
<title>mha_q_0&#45;&gt;attn_score_0</title>
<path fill="none" stroke="black" d="M1281.34,-19195.24C1326.16,-19184.53 1376.05,-19172.61 1421.57,-19161.74"/>
<polygon fill="black" stroke="black" points="1422.6,-19165.09 1431.51,-19159.36 1420.98,-19158.28 1422.6,-19165.09"/>
</g>
<!-- mha_k_0&#45;&gt;attn_score_0 -->
<g id="edge5" class="edge">
<title>mha_k_0&#45;&gt;attn_score_0</title>
<path fill="none" stroke="black" d="M1570,-19195.17C1570,-19187.06 1570,-19178.26 1570,-19169.75"/>
<polygon fill="black" stroke="black" points="1573.5,-19169.58 1570,-19159.58 1566.5,-19169.58 1573.5,-19169.58"/>
</g>
<!-- attn_out_0 -->
<g id="node11" class="node">
<title>attn_out_0</title>
<polygon fill="lightblue" stroke="lightblue" points="2045.5,-19055.28 1648.5,-19055.28 1648.5,-18987.28 2045.5,-18987.28 2045.5,-19055.28"/>
<text text-anchor="middle" x="1847" y="-19040.08" font-family="Times,serif" font-size="14.00">Layer0_Attn_Out</text>
<text text-anchor="middle" x="1847" y="-19025.08" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1847" y="-19010.08" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-18995.08" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_score_0&#45;&gt;attn_out_0 -->
<g id="edge7" class="edge">
<title>attn_score_0&#45;&gt;attn_out_0</title>
<path fill="none" stroke="black" d="M1659.93,-19091.17C1687.89,-19080.87 1718.88,-19069.46 1747.45,-19058.94"/>
<polygon fill="black" stroke="black" points="1748.87,-19062.15 1757.04,-19055.41 1746.45,-19055.58 1748.87,-19062.15"/>
</g>
<!-- attn_allreduce_0 -->
<g id="node12" class="node">
<title>attn_allreduce_0</title>
<ellipse fill="red" stroke="red" cx="1847" cy="-18903.2" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1847" y="-18922" font-family="Times,serif" font-size="14.00">Layer0_Attn_AllReduce</text>
<text text-anchor="middle" x="1847" y="-18907" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-18892" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-18877" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (All&#45;Reduce)</text>
</g>
<!-- attn_out_0&#45;&gt;attn_allreduce_0 -->
<g id="edge8" class="edge">
<title>attn_out_0&#45;&gt;attn_allreduce_0</title>
<path fill="none" stroke="black" d="M1847,-18987.02C1847,-18979.02 1847,-18970.26 1847,-18961.51"/>
<polygon fill="black" stroke="black" points="1850.5,-18961.31 1847,-18951.31 1843.5,-18961.31 1850.5,-18961.31"/>
</g>
<!-- attn_allreduce_0&#45;&gt;attn_residual_0 -->
<g id="edge9" class="edge">
<title>attn_allreduce_0&#45;&gt;attn_residual_0</title>
<path fill="none" stroke="black" d="M1847,-18854.89C1847,-18846.88 1847,-18838.32 1847,-18829.62"/>
<polygon fill="black" stroke="black" points="1850.5,-18829.35 1847,-18819.35 1843.5,-18829.35 1850.5,-18829.35"/>
</g>
<!-- ffn_up_0 -->
<g id="node14" class="node">
<title>ffn_up_0</title>
<polygon fill="lightblue" stroke="lightblue" points="1654,-18617.12 1304,-18617.12 1304,-18549.12 1654,-18549.12 1654,-18617.12"/>
<text text-anchor="middle" x="1479" y="-18601.92" font-family="Times,serif" font-size="14.00">Layer0_FFN_Up</text>
<text text-anchor="middle" x="1479" y="-18586.92" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1479" y="-18571.92" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1479" y="-18556.92" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_residual_0&#45;&gt;ffn_up_0 -->
<g id="edge11" class="edge">
<title>attn_residual_0&#45;&gt;ffn_up_0</title>
<path fill="none" stroke="black" d="M1647.12,-18653.1C1619.85,-18641.91 1593.05,-18630.91 1569.14,-18621.1"/>
<polygon fill="black" stroke="black" points="1570.36,-18617.82 1559.78,-18617.26 1567.7,-18624.3 1570.36,-18617.82"/>
</g>
<!-- ffn_gate_0 -->
<g id="node15" class="node">
<title>ffn_gate_0</title>
<polygon fill="lightblue" stroke="lightblue" points="2022,-18617.12 1672,-18617.12 1672,-18549.12 2022,-18549.12 2022,-18617.12"/>
<text text-anchor="middle" x="1847" y="-18601.92" font-family="Times,serif" font-size="14.00">Layer0_FFN_Gate</text>
<text text-anchor="middle" x="1847" y="-18586.92" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-18571.92" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1847" y="-18556.92" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_residual_0&#45;&gt;ffn_gate_0 -->
<g id="edge12" class="edge">
<title>attn_residual_0&#45;&gt;ffn_gate_0</title>
<path fill="none" stroke="black" d="M1847,-18652.99C1847,-18644.23 1847,-18635.6 1847,-18627.56"/>
<polygon fill="black" stroke="black" points="1850.5,-18627.38 1847,-18617.38 1843.5,-18627.38 1850.5,-18627.38"/>
</g>
<!-- ffn_residual_0 -->
<g id="node18" class="node">
<title>ffn_residual_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2181.11,-18276.95 1584.39,-18276.95 1430.89,-18110.95 2027.61,-18110.95 2181.11,-18276.95"/>
<text text-anchor="middle" x="1806" y="-18220.25" font-family="Times,serif" font-size="14.00">Layer0_FFN_Residual</text>
<text text-anchor="middle" x="1806" y="-18205.25" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-18190.25" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-18175.25" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-18160.25" font-family="Times,serif" font-size="14.00">Device: 0&#45;7</text>
</g>
<!-- attn_residual_0&#45;&gt;ffn_residual_0 -->
<g id="edge17" class="edge">
<title>attn_residual_0&#45;&gt;ffn_residual_0</title>
<path fill="none" stroke="black" d="M2003.78,-18652.9C2014.46,-18642.17 2023.81,-18630.27 2031,-18617.12 2095.84,-18498.5 2100.95,-18428.63 2031,-18312.95 2024.67,-18302.48 2017.07,-18292.9 2008.55,-18284.13"/>
<polygon fill="black" stroke="black" points="2010.79,-18281.42 2001.19,-18276.95 2005.91,-18286.44 2010.79,-18281.42"/>
</g>
<!-- ffn_down_0 -->
<g id="node16" class="node">
<title>ffn_down_0</title>
<polygon fill="lightblue" stroke="lightblue" points="1947,-18513.12 1585,-18513.12 1585,-18445.12 1947,-18445.12 1947,-18513.12"/>
<text text-anchor="middle" x="1766" y="-18497.92" font-family="Times,serif" font-size="14.00">Layer0_FFN_Down</text>
<text text-anchor="middle" x="1766" y="-18482.92" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1766" y="-18467.92" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-18452.92" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_up_0&#45;&gt;ffn_down_0 -->
<g id="edge13" class="edge">
<title>ffn_up_0&#45;&gt;ffn_down_0</title>
<path fill="none" stroke="black" d="M1572.18,-18549C1601.28,-18538.66 1633.53,-18527.19 1663.25,-18516.63"/>
<polygon fill="black" stroke="black" points="1664.55,-18519.89 1672.8,-18513.24 1662.2,-18513.29 1664.55,-18519.89"/>
</g>
<!-- ffn_gate_0&#45;&gt;ffn_down_0 -->
<g id="edge14" class="edge">
<title>ffn_gate_0&#45;&gt;ffn_down_0</title>
<path fill="none" stroke="black" d="M1820.7,-18549C1813.7,-18540.18 1806.05,-18530.55 1798.75,-18521.35"/>
<polygon fill="black" stroke="black" points="1801.4,-18519.07 1792.44,-18513.41 1795.92,-18523.42 1801.4,-18519.07"/>
</g>
<!-- ffn_allreduce_0 -->
<g id="node17" class="node">
<title>ffn_allreduce_0</title>
<ellipse fill="red" stroke="red" cx="1766" cy="-18361.03" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1766" y="-18379.83" font-family="Times,serif" font-size="14.00">Layer0_FFN_AllReduce</text>
<text text-anchor="middle" x="1766" y="-18364.83" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-18349.83" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-18334.83" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (All&#45;Reduce)</text>
</g>
<!-- ffn_down_0&#45;&gt;ffn_allreduce_0 -->
<g id="edge15" class="edge">
<title>ffn_down_0&#45;&gt;ffn_allreduce_0</title>
<path fill="none" stroke="black" d="M1766,-18444.85C1766,-18436.86 1766,-18428.09 1766,-18419.35"/>
<polygon fill="black" stroke="black" points="1769.5,-18419.14 1766,-18409.14 1762.5,-18419.14 1769.5,-18419.14"/>
</g>
<!-- ffn_allreduce_0&#45;&gt;ffn_residual_0 -->
<g id="edge16" class="edge">
<title>ffn_allreduce_0&#45;&gt;ffn_residual_0</title>
<path fill="none" stroke="black" d="M1777.46,-18312.73C1779.42,-18304.63 1781.52,-18295.97 1783.66,-18287.16"/>
<polygon fill="black" stroke="black" points="1787.12,-18287.72 1786.07,-18277.18 1780.32,-18286.08 1787.12,-18287.72"/>
</g>
<!-- mha_q_1 -->
<g id="node19" class="node">
<title>mha_q_1</title>
<polygon fill="lightblue" stroke="lightblue" points="1347.5,-18074.95 938.5,-18074.95 938.5,-18006.95 1347.5,-18006.95 1347.5,-18074.95"/>
<text text-anchor="middle" x="1143" y="-18059.75" font-family="Times,serif" font-size="14.00">Layer1_MHA_Q</text>
<text text-anchor="middle" x="1143" y="-18044.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1143" y="-18029.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1143" y="-18014.75" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_residual_0&#45;&gt;mha_q_1 -->
<g id="edge18" class="edge">
<title>ffn_residual_0&#45;&gt;mha_q_1</title>
<path fill="none" stroke="black" d="M1445.88,-18110.93C1393.9,-18099.09 1342.86,-18087.47 1297.94,-18077.24"/>
<polygon fill="black" stroke="black" points="1298.68,-18073.81 1288.15,-18075.01 1297.12,-18080.64 1298.68,-18073.81"/>
</g>
<!-- mha_k_1 -->
<g id="node20" class="node">
<title>mha_k_1</title>
<polygon fill="lightblue" stroke="lightblue" points="1774.5,-18074.95 1365.5,-18074.95 1365.5,-18006.95 1774.5,-18006.95 1774.5,-18074.95"/>
<text text-anchor="middle" x="1570" y="-18059.75" font-family="Times,serif" font-size="14.00">Layer1_MHA_K</text>
<text text-anchor="middle" x="1570" y="-18044.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1570" y="-18029.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1570" y="-18014.75" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_residual_0&#45;&gt;mha_k_1 -->
<g id="edge19" class="edge">
<title>ffn_residual_0&#45;&gt;mha_k_1</title>
<path fill="none" stroke="black" d="M1677.64,-18110.82C1661.1,-18100.24 1644.84,-18089.83 1630.16,-18080.44"/>
<polygon fill="black" stroke="black" points="1632.02,-18077.48 1621.71,-18075.03 1628.25,-18083.37 1632.02,-18077.48"/>
</g>
<!-- mha_v_1 -->
<g id="node21" class="node">
<title>mha_v_1</title>
<polygon fill="lightblue" stroke="lightblue" points="2201.5,-18074.95 1792.5,-18074.95 1792.5,-18006.95 2201.5,-18006.95 2201.5,-18074.95"/>
<text text-anchor="middle" x="1997" y="-18059.75" font-family="Times,serif" font-size="14.00">Layer1_MHA_V</text>
<text text-anchor="middle" x="1997" y="-18044.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1997" y="-18029.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1997" y="-18014.75" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_residual_0&#45;&gt;mha_v_1 -->
<g id="edge20" class="edge">
<title>ffn_residual_0&#45;&gt;mha_v_1</title>
<path fill="none" stroke="black" d="M1909.88,-18110.82C1922.7,-18100.69 1935.31,-18090.72 1946.79,-18081.65"/>
<polygon fill="black" stroke="black" points="1949.25,-18084.16 1954.93,-18075.21 1944.91,-18078.67 1949.25,-18084.16"/>
</g>
<!-- attn_residual_1 -->
<g id="node25" class="node">
<title>attn_residual_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2222.11,-17630.78 1625.39,-17630.78 1471.89,-17464.78 2068.61,-17464.78 2222.11,-17630.78"/>
<text text-anchor="middle" x="1847" y="-17574.08" font-family="Times,serif" font-size="14.00">Layer1_Attn_Residual</text>
<text text-anchor="middle" x="1847" y="-17559.08" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-17544.08" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-17529.08" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-17514.08" font-family="Times,serif" font-size="14.00">Device: 0&#45;7</text>
</g>
<!-- ffn_residual_0&#45;&gt;attn_residual_1 -->
<g id="edge27" class="edge">
<title>ffn_residual_0&#45;&gt;attn_residual_1</title>
<path fill="none" stroke="black" d="M2058.31,-18143.95C2127.23,-18125.4 2189.04,-18102.1 2211,-18074.95 2249.39,-18027.48 2221,-17999 2221,-17937.95 2221,-17937.95 2221,-17937.95 2221,-17831.95 2221,-17744.51 2155.22,-17680.61 2078.83,-17635.88"/>
<polygon fill="black" stroke="black" points="2080.37,-17632.73 2069.96,-17630.79 2076.89,-17638.8 2080.37,-17632.73"/>
</g>
<!-- attn_score_1 -->
<g id="node22" class="node">
<title>attn_score_1</title>
<polygon fill="lightblue" stroke="lightblue" points="1784,-17970.95 1356,-17970.95 1356,-17902.95 1784,-17902.95 1784,-17970.95"/>
<text text-anchor="middle" x="1570" y="-17955.75" font-family="Times,serif" font-size="14.00">Layer1_Attn_Score</text>
<text text-anchor="middle" x="1570" y="-17940.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1570" y="-17925.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1570" y="-17910.75" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- mha_q_1&#45;&gt;attn_score_1 -->
<g id="edge21" class="edge">
<title>mha_q_1&#45;&gt;attn_score_1</title>
<path fill="none" stroke="black" d="M1281.34,-18006.9C1326.16,-17996.2 1376.05,-17984.28 1421.57,-17973.41"/>
<polygon fill="black" stroke="black" points="1422.6,-17976.76 1431.51,-17971.03 1420.98,-17969.95 1422.6,-17976.76"/>
</g>
<!-- mha_k_1&#45;&gt;attn_score_1 -->
<g id="edge22" class="edge">
<title>mha_k_1&#45;&gt;attn_score_1</title>
<path fill="none" stroke="black" d="M1570,-18006.83C1570,-17998.73 1570,-17989.93 1570,-17981.42"/>
<polygon fill="black" stroke="black" points="1573.5,-17981.25 1570,-17971.25 1566.5,-17981.25 1573.5,-17981.25"/>
</g>
<!-- attn_out_1 -->
<g id="node23" class="node">
<title>attn_out_1</title>
<polygon fill="lightblue" stroke="lightblue" points="2045.5,-17866.95 1648.5,-17866.95 1648.5,-17798.95 2045.5,-17798.95 2045.5,-17866.95"/>
<text text-anchor="middle" x="1847" y="-17851.75" font-family="Times,serif" font-size="14.00">Layer1_Attn_Out</text>
<text text-anchor="middle" x="1847" y="-17836.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1847" y="-17821.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-17806.75" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_score_1&#45;&gt;attn_out_1 -->
<g id="edge24" class="edge">
<title>attn_score_1&#45;&gt;attn_out_1</title>
<path fill="none" stroke="black" d="M1659.93,-17902.83C1687.89,-17892.54 1718.88,-17881.13 1747.45,-17870.61"/>
<polygon fill="black" stroke="black" points="1748.87,-17873.81 1757.04,-17867.07 1746.45,-17867.24 1748.87,-17873.81"/>
</g>
<!-- attn_allreduce_1 -->
<g id="node24" class="node">
<title>attn_allreduce_1</title>
<ellipse fill="red" stroke="red" cx="1847" cy="-17714.87" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1847" y="-17733.67" font-family="Times,serif" font-size="14.00">Layer1_Attn_AllReduce</text>
<text text-anchor="middle" x="1847" y="-17718.67" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-17703.67" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-17688.67" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (All&#45;Reduce)</text>
</g>
<!-- attn_out_1&#45;&gt;attn_allreduce_1 -->
<g id="edge25" class="edge">
<title>attn_out_1&#45;&gt;attn_allreduce_1</title>
<path fill="none" stroke="black" d="M1847,-17798.68C1847,-17790.69 1847,-17781.93 1847,-17773.18"/>
<polygon fill="black" stroke="black" points="1850.5,-17772.98 1847,-17762.98 1843.5,-17772.98 1850.5,-17772.98"/>
</g>
<!-- attn_allreduce_1&#45;&gt;attn_residual_1 -->
<g id="edge26" class="edge">
<title>attn_allreduce_1&#45;&gt;attn_residual_1</title>
<path fill="none" stroke="black" d="M1847,-17666.56C1847,-17658.55 1847,-17649.99 1847,-17641.28"/>
<polygon fill="black" stroke="black" points="1850.5,-17641.02 1847,-17631.02 1843.5,-17641.02 1850.5,-17641.02"/>
</g>
<!-- ffn_up_1 -->
<g id="node26" class="node">
<title>ffn_up_1</title>
<polygon fill="lightblue" stroke="lightblue" points="1654,-17428.78 1304,-17428.78 1304,-17360.78 1654,-17360.78 1654,-17428.78"/>
<text text-anchor="middle" x="1479" y="-17413.58" font-family="Times,serif" font-size="14.00">Layer1_FFN_Up</text>
<text text-anchor="middle" x="1479" y="-17398.58" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1479" y="-17383.58" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1479" y="-17368.58" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_residual_1&#45;&gt;ffn_up_1 -->
<g id="edge28" class="edge">
<title>attn_residual_1&#45;&gt;ffn_up_1</title>
<path fill="none" stroke="black" d="M1647.12,-17464.76C1619.85,-17453.58 1593.05,-17442.58 1569.14,-17432.77"/>
<polygon fill="black" stroke="black" points="1570.36,-17429.49 1559.78,-17428.93 1567.7,-17435.96 1570.36,-17429.49"/>
</g>
<!-- ffn_gate_1 -->
<g id="node27" class="node">
<title>ffn_gate_1</title>
<polygon fill="lightblue" stroke="lightblue" points="2022,-17428.78 1672,-17428.78 1672,-17360.78 2022,-17360.78 2022,-17428.78"/>
<text text-anchor="middle" x="1847" y="-17413.58" font-family="Times,serif" font-size="14.00">Layer1_FFN_Gate</text>
<text text-anchor="middle" x="1847" y="-17398.58" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-17383.58" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1847" y="-17368.58" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_residual_1&#45;&gt;ffn_gate_1 -->
<g id="edge29" class="edge">
<title>attn_residual_1&#45;&gt;ffn_gate_1</title>
<path fill="none" stroke="black" d="M1847,-17464.65C1847,-17455.9 1847,-17447.27 1847,-17439.23"/>
<polygon fill="black" stroke="black" points="1850.5,-17439.04 1847,-17429.04 1843.5,-17439.04 1850.5,-17439.04"/>
</g>
<!-- ffn_residual_1 -->
<g id="node30" class="node">
<title>ffn_residual_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2181.11,-17088.62 1584.39,-17088.62 1430.89,-16922.62 2027.61,-16922.62 2181.11,-17088.62"/>
<text text-anchor="middle" x="1806" y="-17031.92" font-family="Times,serif" font-size="14.00">Layer1_FFN_Residual</text>
<text text-anchor="middle" x="1806" y="-17016.92" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-17001.92" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-16986.92" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-16971.92" font-family="Times,serif" font-size="14.00">Device: 0&#45;7</text>
</g>
<!-- attn_residual_1&#45;&gt;ffn_residual_1 -->
<g id="edge34" class="edge">
<title>attn_residual_1&#45;&gt;ffn_residual_1</title>
<path fill="none" stroke="black" d="M2003.78,-17464.56C2014.46,-17453.84 2023.81,-17441.94 2031,-17428.78 2095.84,-17310.16 2100.95,-17240.29 2031,-17124.62 2024.67,-17114.15 2017.07,-17104.56 2008.55,-17095.79"/>
<polygon fill="black" stroke="black" points="2010.79,-17093.09 2001.19,-17088.62 2005.91,-17098.1 2010.79,-17093.09"/>
</g>
<!-- ffn_down_1 -->
<g id="node28" class="node">
<title>ffn_down_1</title>
<polygon fill="lightblue" stroke="lightblue" points="1947,-17324.78 1585,-17324.78 1585,-17256.78 1947,-17256.78 1947,-17324.78"/>
<text text-anchor="middle" x="1766" y="-17309.58" font-family="Times,serif" font-size="14.00">Layer1_FFN_Down</text>
<text text-anchor="middle" x="1766" y="-17294.58" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1766" y="-17279.58" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-17264.58" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_up_1&#45;&gt;ffn_down_1 -->
<g id="edge30" class="edge">
<title>ffn_up_1&#45;&gt;ffn_down_1</title>
<path fill="none" stroke="black" d="M1572.18,-17360.67C1601.28,-17350.33 1633.53,-17338.86 1663.25,-17328.3"/>
<polygon fill="black" stroke="black" points="1664.55,-17331.55 1672.8,-17324.91 1662.2,-17324.96 1664.55,-17331.55"/>
</g>
<!-- ffn_gate_1&#45;&gt;ffn_down_1 -->
<g id="edge31" class="edge">
<title>ffn_gate_1&#45;&gt;ffn_down_1</title>
<path fill="none" stroke="black" d="M1820.7,-17360.67C1813.7,-17351.85 1806.05,-17342.21 1798.75,-17333.02"/>
<polygon fill="black" stroke="black" points="1801.4,-17330.74 1792.44,-17325.08 1795.92,-17335.09 1801.4,-17330.74"/>
</g>
<!-- ffn_allreduce_1 -->
<g id="node29" class="node">
<title>ffn_allreduce_1</title>
<ellipse fill="red" stroke="red" cx="1766" cy="-17172.7" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1766" y="-17191.5" font-family="Times,serif" font-size="14.00">Layer1_FFN_AllReduce</text>
<text text-anchor="middle" x="1766" y="-17176.5" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-17161.5" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-17146.5" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (All&#45;Reduce)</text>
</g>
<!-- ffn_down_1&#45;&gt;ffn_allreduce_1 -->
<g id="edge32" class="edge">
<title>ffn_down_1&#45;&gt;ffn_allreduce_1</title>
<path fill="none" stroke="black" d="M1766,-17256.52C1766,-17248.52 1766,-17239.76 1766,-17231.02"/>
<polygon fill="black" stroke="black" points="1769.5,-17230.81 1766,-17220.81 1762.5,-17230.81 1769.5,-17230.81"/>
</g>
<!-- ffn_allreduce_1&#45;&gt;ffn_residual_1 -->
<g id="edge33" class="edge">
<title>ffn_allreduce_1&#45;&gt;ffn_residual_1</title>
<path fill="none" stroke="black" d="M1777.46,-17124.39C1779.42,-17116.29 1781.52,-17107.64 1783.66,-17098.83"/>
<polygon fill="black" stroke="black" points="1787.12,-17099.39 1786.07,-17088.85 1780.32,-17097.74 1787.12,-17099.39"/>
</g>
<!-- mha_q_2 -->
<g id="node31" class="node">
<title>mha_q_2</title>
<polygon fill="lightblue" stroke="lightblue" points="1347.5,-16886.62 938.5,-16886.62 938.5,-16818.62 1347.5,-16818.62 1347.5,-16886.62"/>
<text text-anchor="middle" x="1143" y="-16871.42" font-family="Times,serif" font-size="14.00">Layer2_MHA_Q</text>
<text text-anchor="middle" x="1143" y="-16856.42" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1143" y="-16841.42" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1143" y="-16826.42" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_residual_1&#45;&gt;mha_q_2 -->
<g id="edge35" class="edge">
<title>ffn_residual_1&#45;&gt;mha_q_2</title>
<path fill="none" stroke="black" d="M1445.88,-16922.6C1393.9,-16910.76 1342.86,-16899.14 1297.94,-16888.9"/>
<polygon fill="black" stroke="black" points="1298.68,-16885.48 1288.15,-16886.67 1297.12,-16892.31 1298.68,-16885.48"/>
</g>
<!-- mha_k_2 -->
<g id="node32" class="node">
<title>mha_k_2</title>
<polygon fill="lightblue" stroke="lightblue" points="1774.5,-16886.62 1365.5,-16886.62 1365.5,-16818.62 1774.5,-16818.62 1774.5,-16886.62"/>
<text text-anchor="middle" x="1570" y="-16871.42" font-family="Times,serif" font-size="14.00">Layer2_MHA_K</text>
<text text-anchor="middle" x="1570" y="-16856.42" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1570" y="-16841.42" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1570" y="-16826.42" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_residual_1&#45;&gt;mha_k_2 -->
<g id="edge36" class="edge">
<title>ffn_residual_1&#45;&gt;mha_k_2</title>
<path fill="none" stroke="black" d="M1677.64,-16922.49C1661.1,-16911.91 1644.84,-16901.5 1630.16,-16892.11"/>
<polygon fill="black" stroke="black" points="1632.02,-16889.14 1621.71,-16886.7 1628.25,-16895.04 1632.02,-16889.14"/>
</g>
<!-- mha_v_2 -->
<g id="node33" class="node">
<title>mha_v_2</title>
<polygon fill="lightblue" stroke="lightblue" points="2201.5,-16886.62 1792.5,-16886.62 1792.5,-16818.62 2201.5,-16818.62 2201.5,-16886.62"/>
<text text-anchor="middle" x="1997" y="-16871.42" font-family="Times,serif" font-size="14.00">Layer2_MHA_V</text>
<text text-anchor="middle" x="1997" y="-16856.42" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1997" y="-16841.42" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1997" y="-16826.42" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_residual_1&#45;&gt;mha_v_2 -->
<g id="edge37" class="edge">
<title>ffn_residual_1&#45;&gt;mha_v_2</title>
<path fill="none" stroke="black" d="M1909.88,-16922.49C1922.7,-16912.36 1935.31,-16902.39 1946.79,-16893.31"/>
<polygon fill="black" stroke="black" points="1949.25,-16895.83 1954.93,-16886.88 1944.91,-16890.33 1949.25,-16895.83"/>
</g>
<!-- attn_residual_2 -->
<g id="node37" class="node">
<title>attn_residual_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2222.11,-16442.45 1625.39,-16442.45 1471.89,-16276.45 2068.61,-16276.45 2222.11,-16442.45"/>
<text text-anchor="middle" x="1847" y="-16385.75" font-family="Times,serif" font-size="14.00">Layer2_Attn_Residual</text>
<text text-anchor="middle" x="1847" y="-16370.75" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-16355.75" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-16340.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-16325.75" font-family="Times,serif" font-size="14.00">Device: 0&#45;7</text>
</g>
<!-- ffn_residual_1&#45;&gt;attn_residual_2 -->
<g id="edge44" class="edge">
<title>ffn_residual_1&#45;&gt;attn_residual_2</title>
<path fill="none" stroke="black" d="M2058.31,-16955.62C2127.23,-16937.07 2189.04,-16913.77 2211,-16886.62 2249.39,-16839.15 2221,-16810.67 2221,-16749.62 2221,-16749.62 2221,-16749.62 2221,-16643.62 2221,-16556.18 2155.22,-16492.28 2078.83,-16447.55"/>
<polygon fill="black" stroke="black" points="2080.37,-16444.4 2069.96,-16442.46 2076.89,-16450.47 2080.37,-16444.4"/>
</g>
<!-- attn_score_2 -->
<g id="node34" class="node">
<title>attn_score_2</title>
<polygon fill="lightblue" stroke="lightblue" points="1784,-16782.62 1356,-16782.62 1356,-16714.62 1784,-16714.62 1784,-16782.62"/>
<text text-anchor="middle" x="1570" y="-16767.42" font-family="Times,serif" font-size="14.00">Layer2_Attn_Score</text>
<text text-anchor="middle" x="1570" y="-16752.42" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1570" y="-16737.42" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1570" y="-16722.42" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- mha_q_2&#45;&gt;attn_score_2 -->
<g id="edge38" class="edge">
<title>mha_q_2&#45;&gt;attn_score_2</title>
<path fill="none" stroke="black" d="M1281.34,-16818.57C1326.16,-16807.86 1376.05,-16795.95 1421.57,-16785.07"/>
<polygon fill="black" stroke="black" points="1422.6,-16788.42 1431.51,-16782.7 1420.98,-16781.62 1422.6,-16788.42"/>
</g>
<!-- mha_k_2&#45;&gt;attn_score_2 -->
<g id="edge39" class="edge">
<title>mha_k_2&#45;&gt;attn_score_2</title>
<path fill="none" stroke="black" d="M1570,-16818.5C1570,-16810.39 1570,-16801.6 1570,-16793.09"/>
<polygon fill="black" stroke="black" points="1573.5,-16792.92 1570,-16782.92 1566.5,-16792.92 1573.5,-16792.92"/>
</g>
<!-- attn_out_2 -->
<g id="node35" class="node">
<title>attn_out_2</title>
<polygon fill="lightblue" stroke="lightblue" points="2045.5,-16678.62 1648.5,-16678.62 1648.5,-16610.62 2045.5,-16610.62 2045.5,-16678.62"/>
<text text-anchor="middle" x="1847" y="-16663.42" font-family="Times,serif" font-size="14.00">Layer2_Attn_Out</text>
<text text-anchor="middle" x="1847" y="-16648.42" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1847" y="-16633.42" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-16618.42" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_score_2&#45;&gt;attn_out_2 -->
<g id="edge41" class="edge">
<title>attn_score_2&#45;&gt;attn_out_2</title>
<path fill="none" stroke="black" d="M1659.93,-16714.5C1687.89,-16704.2 1718.88,-16692.79 1747.45,-16682.27"/>
<polygon fill="black" stroke="black" points="1748.87,-16685.48 1757.04,-16678.74 1746.45,-16678.91 1748.87,-16685.48"/>
</g>
<!-- attn_allreduce_2 -->
<g id="node36" class="node">
<title>attn_allreduce_2</title>
<ellipse fill="red" stroke="red" cx="1847" cy="-16526.53" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1847" y="-16545.33" font-family="Times,serif" font-size="14.00">Layer2_Attn_AllReduce</text>
<text text-anchor="middle" x="1847" y="-16530.33" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-16515.33" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-16500.33" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (All&#45;Reduce)</text>
</g>
<!-- attn_out_2&#45;&gt;attn_allreduce_2 -->
<g id="edge42" class="edge">
<title>attn_out_2&#45;&gt;attn_allreduce_2</title>
<path fill="none" stroke="black" d="M1847,-16610.35C1847,-16602.36 1847,-16593.59 1847,-16584.85"/>
<polygon fill="black" stroke="black" points="1850.5,-16584.64 1847,-16574.64 1843.5,-16584.64 1850.5,-16584.64"/>
</g>
<!-- attn_allreduce_2&#45;&gt;attn_residual_2 -->
<g id="edge43" class="edge">
<title>attn_allreduce_2&#45;&gt;attn_residual_2</title>
<path fill="none" stroke="black" d="M1847,-16478.23C1847,-16470.21 1847,-16461.66 1847,-16452.95"/>
<polygon fill="black" stroke="black" points="1850.5,-16452.68 1847,-16442.68 1843.5,-16452.68 1850.5,-16452.68"/>
</g>
<!-- ffn_up_2 -->
<g id="node38" class="node">
<title>ffn_up_2</title>
<polygon fill="lightblue" stroke="lightblue" points="1654,-16240.45 1304,-16240.45 1304,-16172.45 1654,-16172.45 1654,-16240.45"/>
<text text-anchor="middle" x="1479" y="-16225.25" font-family="Times,serif" font-size="14.00">Layer2_FFN_Up</text>
<text text-anchor="middle" x="1479" y="-16210.25" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1479" y="-16195.25" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1479" y="-16180.25" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_residual_2&#45;&gt;ffn_up_2 -->
<g id="edge45" class="edge">
<title>attn_residual_2&#45;&gt;ffn_up_2</title>
<path fill="none" stroke="black" d="M1647.12,-16276.43C1619.85,-16265.24 1593.05,-16254.25 1569.14,-16244.44"/>
<polygon fill="black" stroke="black" points="1570.36,-16241.15 1559.78,-16240.6 1567.7,-16247.63 1570.36,-16241.15"/>
</g>
<!-- ffn_gate_2 -->
<g id="node39" class="node">
<title>ffn_gate_2</title>
<polygon fill="lightblue" stroke="lightblue" points="2022,-16240.45 1672,-16240.45 1672,-16172.45 2022,-16172.45 2022,-16240.45"/>
<text text-anchor="middle" x="1847" y="-16225.25" font-family="Times,serif" font-size="14.00">Layer2_FFN_Gate</text>
<text text-anchor="middle" x="1847" y="-16210.25" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-16195.25" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1847" y="-16180.25" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_residual_2&#45;&gt;ffn_gate_2 -->
<g id="edge46" class="edge">
<title>attn_residual_2&#45;&gt;ffn_gate_2</title>
<path fill="none" stroke="black" d="M1847,-16276.32C1847,-16267.57 1847,-16258.93 1847,-16250.9"/>
<polygon fill="black" stroke="black" points="1850.5,-16250.71 1847,-16240.71 1843.5,-16250.71 1850.5,-16250.71"/>
</g>
<!-- ffn_residual_2 -->
<g id="node42" class="node">
<title>ffn_residual_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2181.11,-15900.28 1584.39,-15900.28 1430.89,-15734.28 2027.61,-15734.28 2181.11,-15900.28"/>
<text text-anchor="middle" x="1806" y="-15843.58" font-family="Times,serif" font-size="14.00">Layer2_FFN_Residual</text>
<text text-anchor="middle" x="1806" y="-15828.58" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-15813.58" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-15798.58" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-15783.58" font-family="Times,serif" font-size="14.00">Device: 0&#45;7</text>
</g>
<!-- attn_residual_2&#45;&gt;ffn_residual_2 -->
<g id="edge51" class="edge">
<title>attn_residual_2&#45;&gt;ffn_residual_2</title>
<path fill="none" stroke="black" d="M2003.78,-16276.23C2014.46,-16265.51 2023.81,-16253.6 2031,-16240.45 2095.84,-16121.83 2100.95,-16051.96 2031,-15936.28 2024.67,-15925.81 2017.07,-15916.23 2008.55,-15907.46"/>
<polygon fill="black" stroke="black" points="2010.79,-15904.76 2001.19,-15900.28 2005.91,-15909.77 2010.79,-15904.76"/>
</g>
<!-- ffn_down_2 -->
<g id="node40" class="node">
<title>ffn_down_2</title>
<polygon fill="lightblue" stroke="lightblue" points="1947,-16136.45 1585,-16136.45 1585,-16068.45 1947,-16068.45 1947,-16136.45"/>
<text text-anchor="middle" x="1766" y="-16121.25" font-family="Times,serif" font-size="14.00">Layer2_FFN_Down</text>
<text text-anchor="middle" x="1766" y="-16106.25" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1766" y="-16091.25" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-16076.25" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_up_2&#45;&gt;ffn_down_2 -->
<g id="edge47" class="edge">
<title>ffn_up_2&#45;&gt;ffn_down_2</title>
<path fill="none" stroke="black" d="M1572.18,-16172.33C1601.28,-16161.99 1633.53,-16150.53 1663.25,-16139.97"/>
<polygon fill="black" stroke="black" points="1664.55,-16143.22 1672.8,-16136.57 1662.2,-16136.63 1664.55,-16143.22"/>
</g>
<!-- ffn_gate_2&#45;&gt;ffn_down_2 -->
<g id="edge48" class="edge">
<title>ffn_gate_2&#45;&gt;ffn_down_2</title>
<path fill="none" stroke="black" d="M1820.7,-16172.33C1813.7,-16163.51 1806.05,-16153.88 1798.75,-16144.68"/>
<polygon fill="black" stroke="black" points="1801.4,-16142.4 1792.44,-16136.75 1795.92,-16146.76 1801.4,-16142.4"/>
</g>
<!-- ffn_allreduce_2 -->
<g id="node41" class="node">
<title>ffn_allreduce_2</title>
<ellipse fill="red" stroke="red" cx="1766" cy="-15984.37" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1766" y="-16003.17" font-family="Times,serif" font-size="14.00">Layer2_FFN_AllReduce</text>
<text text-anchor="middle" x="1766" y="-15988.17" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-15973.17" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-15958.17" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (All&#45;Reduce)</text>
</g>
<!-- ffn_down_2&#45;&gt;ffn_allreduce_2 -->
<g id="edge49" class="edge">
<title>ffn_down_2&#45;&gt;ffn_allreduce_2</title>
<path fill="none" stroke="black" d="M1766,-16068.18C1766,-16060.19 1766,-16051.43 1766,-16042.68"/>
<polygon fill="black" stroke="black" points="1769.5,-16042.48 1766,-16032.48 1762.5,-16042.48 1769.5,-16042.48"/>
</g>
<!-- ffn_allreduce_2&#45;&gt;ffn_residual_2 -->
<g id="edge50" class="edge">
<title>ffn_allreduce_2&#45;&gt;ffn_residual_2</title>
<path fill="none" stroke="black" d="M1777.46,-15936.06C1779.42,-15927.96 1781.52,-15919.3 1783.66,-15910.5"/>
<polygon fill="black" stroke="black" points="1787.12,-15911.06 1786.07,-15900.52 1780.32,-15909.41 1787.12,-15911.06"/>
</g>
<!-- mha_q_3 -->
<g id="node43" class="node">
<title>mha_q_3</title>
<polygon fill="lightblue" stroke="lightblue" points="1347.5,-15698.28 938.5,-15698.28 938.5,-15630.28 1347.5,-15630.28 1347.5,-15698.28"/>
<text text-anchor="middle" x="1143" y="-15683.08" font-family="Times,serif" font-size="14.00">Layer3_MHA_Q</text>
<text text-anchor="middle" x="1143" y="-15668.08" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1143" y="-15653.08" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1143" y="-15638.08" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_residual_2&#45;&gt;mha_q_3 -->
<g id="edge52" class="edge">
<title>ffn_residual_2&#45;&gt;mha_q_3</title>
<path fill="none" stroke="black" d="M1445.88,-15734.26C1393.9,-15722.43 1342.86,-15710.8 1297.94,-15700.57"/>
<polygon fill="black" stroke="black" points="1298.68,-15697.15 1288.15,-15698.34 1297.12,-15703.97 1298.68,-15697.15"/>
</g>
<!-- mha_k_3 -->
<g id="node44" class="node">
<title>mha_k_3</title>
<polygon fill="lightblue" stroke="lightblue" points="1774.5,-15698.28 1365.5,-15698.28 1365.5,-15630.28 1774.5,-15630.28 1774.5,-15698.28"/>
<text text-anchor="middle" x="1570" y="-15683.08" font-family="Times,serif" font-size="14.00">Layer3_MHA_K</text>
<text text-anchor="middle" x="1570" y="-15668.08" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1570" y="-15653.08" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1570" y="-15638.08" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_residual_2&#45;&gt;mha_k_3 -->
<g id="edge53" class="edge">
<title>ffn_residual_2&#45;&gt;mha_k_3</title>
<path fill="none" stroke="black" d="M1677.64,-15734.15C1661.1,-15723.57 1644.84,-15713.17 1630.16,-15703.77"/>
<polygon fill="black" stroke="black" points="1632.02,-15700.81 1621.71,-15698.37 1628.25,-15706.71 1632.02,-15700.81"/>
</g>
<!-- mha_v_3 -->
<g id="node45" class="node">
<title>mha_v_3</title>
<polygon fill="lightblue" stroke="lightblue" points="2201.5,-15698.28 1792.5,-15698.28 1792.5,-15630.28 2201.5,-15630.28 2201.5,-15698.28"/>
<text text-anchor="middle" x="1997" y="-15683.08" font-family="Times,serif" font-size="14.00">Layer3_MHA_V</text>
<text text-anchor="middle" x="1997" y="-15668.08" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1997" y="-15653.08" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1997" y="-15638.08" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_residual_2&#45;&gt;mha_v_3 -->
<g id="edge54" class="edge">
<title>ffn_residual_2&#45;&gt;mha_v_3</title>
<path fill="none" stroke="black" d="M1909.88,-15734.15C1922.7,-15724.02 1935.31,-15714.05 1946.79,-15704.98"/>
<polygon fill="black" stroke="black" points="1949.25,-15707.49 1954.93,-15698.54 1944.91,-15702 1949.25,-15707.49"/>
</g>
<!-- attn_residual_3 -->
<g id="node49" class="node">
<title>attn_residual_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2222.11,-15254.12 1625.39,-15254.12 1471.89,-15088.12 2068.61,-15088.12 2222.11,-15254.12"/>
<text text-anchor="middle" x="1847" y="-15197.42" font-family="Times,serif" font-size="14.00">Layer3_Attn_Residual</text>
<text text-anchor="middle" x="1847" y="-15182.42" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-15167.42" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-15152.42" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-15137.42" font-family="Times,serif" font-size="14.00">Device: 0&#45;7</text>
</g>
<!-- ffn_residual_2&#45;&gt;attn_residual_3 -->
<g id="edge61" class="edge">
<title>ffn_residual_2&#45;&gt;attn_residual_3</title>
<path fill="none" stroke="black" d="M2058.31,-15767.29C2127.23,-15748.74 2189.04,-15725.44 2211,-15698.28 2249.39,-15650.81 2221,-15622.33 2221,-15561.28 2221,-15561.28 2221,-15561.28 2221,-15455.28 2221,-15367.85 2155.22,-15303.94 2078.83,-15259.21"/>
<polygon fill="black" stroke="black" points="2080.37,-15256.06 2069.96,-15254.13 2076.89,-15262.14 2080.37,-15256.06"/>
</g>
<!-- attn_score_3 -->
<g id="node46" class="node">
<title>attn_score_3</title>
<polygon fill="lightblue" stroke="lightblue" points="1784,-15594.28 1356,-15594.28 1356,-15526.28 1784,-15526.28 1784,-15594.28"/>
<text text-anchor="middle" x="1570" y="-15579.08" font-family="Times,serif" font-size="14.00">Layer3_Attn_Score</text>
<text text-anchor="middle" x="1570" y="-15564.08" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1570" y="-15549.08" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1570" y="-15534.08" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- mha_q_3&#45;&gt;attn_score_3 -->
<g id="edge55" class="edge">
<title>mha_q_3&#45;&gt;attn_score_3</title>
<path fill="none" stroke="black" d="M1281.34,-15630.24C1326.16,-15619.53 1376.05,-15607.61 1421.57,-15596.74"/>
<polygon fill="black" stroke="black" points="1422.6,-15600.09 1431.51,-15594.36 1420.98,-15593.28 1422.6,-15600.09"/>
</g>
<!-- mha_k_3&#45;&gt;attn_score_3 -->
<g id="edge56" class="edge">
<title>mha_k_3&#45;&gt;attn_score_3</title>
<path fill="none" stroke="black" d="M1570,-15630.17C1570,-15622.06 1570,-15613.26 1570,-15604.76"/>
<polygon fill="black" stroke="black" points="1573.5,-15604.58 1570,-15594.58 1566.5,-15604.58 1573.5,-15604.58"/>
</g>
<!-- attn_out_3 -->
<g id="node47" class="node">
<title>attn_out_3</title>
<polygon fill="lightblue" stroke="lightblue" points="2045.5,-15490.28 1648.5,-15490.28 1648.5,-15422.28 2045.5,-15422.28 2045.5,-15490.28"/>
<text text-anchor="middle" x="1847" y="-15475.08" font-family="Times,serif" font-size="14.00">Layer3_Attn_Out</text>
<text text-anchor="middle" x="1847" y="-15460.08" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1847" y="-15445.08" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-15430.08" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_score_3&#45;&gt;attn_out_3 -->
<g id="edge58" class="edge">
<title>attn_score_3&#45;&gt;attn_out_3</title>
<path fill="none" stroke="black" d="M1659.93,-15526.17C1687.89,-15515.87 1718.88,-15504.46 1747.45,-15493.94"/>
<polygon fill="black" stroke="black" points="1748.87,-15497.15 1757.04,-15490.41 1746.45,-15490.58 1748.87,-15497.15"/>
</g>
<!-- attn_allreduce_3 -->
<g id="node48" class="node">
<title>attn_allreduce_3</title>
<ellipse fill="red" stroke="red" cx="1847" cy="-15338.2" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1847" y="-15357" font-family="Times,serif" font-size="14.00">Layer3_Attn_AllReduce</text>
<text text-anchor="middle" x="1847" y="-15342" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-15327" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-15312" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (All&#45;Reduce)</text>
</g>
<!-- attn_out_3&#45;&gt;attn_allreduce_3 -->
<g id="edge59" class="edge">
<title>attn_out_3&#45;&gt;attn_allreduce_3</title>
<path fill="none" stroke="black" d="M1847,-15422.02C1847,-15414.02 1847,-15405.26 1847,-15396.52"/>
<polygon fill="black" stroke="black" points="1850.5,-15396.31 1847,-15386.31 1843.5,-15396.31 1850.5,-15396.31"/>
</g>
<!-- attn_allreduce_3&#45;&gt;attn_residual_3 -->
<g id="edge60" class="edge">
<title>attn_allreduce_3&#45;&gt;attn_residual_3</title>
<path fill="none" stroke="black" d="M1847,-15289.89C1847,-15281.88 1847,-15273.32 1847,-15264.62"/>
<polygon fill="black" stroke="black" points="1850.5,-15264.35 1847,-15254.35 1843.5,-15264.35 1850.5,-15264.35"/>
</g>
<!-- ffn_up_3 -->
<g id="node50" class="node">
<title>ffn_up_3</title>
<polygon fill="lightblue" stroke="lightblue" points="1654,-15052.12 1304,-15052.12 1304,-14984.12 1654,-14984.12 1654,-15052.12"/>
<text text-anchor="middle" x="1479" y="-15036.92" font-family="Times,serif" font-size="14.00">Layer3_FFN_Up</text>
<text text-anchor="middle" x="1479" y="-15021.92" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1479" y="-15006.92" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1479" y="-14991.92" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_residual_3&#45;&gt;ffn_up_3 -->
<g id="edge62" class="edge">
<title>attn_residual_3&#45;&gt;ffn_up_3</title>
<path fill="none" stroke="black" d="M1647.12,-15088.1C1619.85,-15076.91 1593.05,-15065.91 1569.14,-15056.1"/>
<polygon fill="black" stroke="black" points="1570.36,-15052.82 1559.78,-15052.26 1567.7,-15059.3 1570.36,-15052.82"/>
</g>
<!-- ffn_gate_3 -->
<g id="node51" class="node">
<title>ffn_gate_3</title>
<polygon fill="lightblue" stroke="lightblue" points="2022,-15052.12 1672,-15052.12 1672,-14984.12 2022,-14984.12 2022,-15052.12"/>
<text text-anchor="middle" x="1847" y="-15036.92" font-family="Times,serif" font-size="14.00">Layer3_FFN_Gate</text>
<text text-anchor="middle" x="1847" y="-15021.92" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-15006.92" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1847" y="-14991.92" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_residual_3&#45;&gt;ffn_gate_3 -->
<g id="edge63" class="edge">
<title>attn_residual_3&#45;&gt;ffn_gate_3</title>
<path fill="none" stroke="black" d="M1847,-15087.99C1847,-15079.23 1847,-15070.6 1847,-15062.56"/>
<polygon fill="black" stroke="black" points="1850.5,-15062.38 1847,-15052.38 1843.5,-15062.38 1850.5,-15062.38"/>
</g>
<!-- ffn_residual_3 -->
<g id="node54" class="node">
<title>ffn_residual_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2181.11,-14711.95 1584.39,-14711.95 1430.89,-14545.95 2027.61,-14545.95 2181.11,-14711.95"/>
<text text-anchor="middle" x="1806" y="-14655.25" font-family="Times,serif" font-size="14.00">Layer3_FFN_Residual</text>
<text text-anchor="middle" x="1806" y="-14640.25" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-14625.25" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-14610.25" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-14595.25" font-family="Times,serif" font-size="14.00">Device: 0&#45;7</text>
</g>
<!-- attn_residual_3&#45;&gt;ffn_residual_3 -->
<g id="edge68" class="edge">
<title>attn_residual_3&#45;&gt;ffn_residual_3</title>
<path fill="none" stroke="black" d="M2003.78,-15087.9C2014.46,-15077.17 2023.81,-15065.27 2031,-15052.12 2095.84,-14933.5 2100.95,-14863.63 2031,-14747.95 2024.67,-14737.48 2017.07,-14727.9 2008.55,-14719.13"/>
<polygon fill="black" stroke="black" points="2010.79,-14716.42 2001.19,-14711.95 2005.91,-14721.44 2010.79,-14716.42"/>
</g>
<!-- ffn_down_3 -->
<g id="node52" class="node">
<title>ffn_down_3</title>
<polygon fill="lightblue" stroke="lightblue" points="1947,-14948.12 1585,-14948.12 1585,-14880.12 1947,-14880.12 1947,-14948.12"/>
<text text-anchor="middle" x="1766" y="-14932.92" font-family="Times,serif" font-size="14.00">Layer3_FFN_Down</text>
<text text-anchor="middle" x="1766" y="-14917.92" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1766" y="-14902.92" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-14887.92" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_up_3&#45;&gt;ffn_down_3 -->
<g id="edge64" class="edge">
<title>ffn_up_3&#45;&gt;ffn_down_3</title>
<path fill="none" stroke="black" d="M1572.18,-14984C1601.28,-14973.66 1633.53,-14962.2 1663.25,-14951.64"/>
<polygon fill="black" stroke="black" points="1664.55,-14954.89 1672.8,-14948.24 1662.2,-14948.29 1664.55,-14954.89"/>
</g>
<!-- ffn_gate_3&#45;&gt;ffn_down_3 -->
<g id="edge65" class="edge">
<title>ffn_gate_3&#45;&gt;ffn_down_3</title>
<path fill="none" stroke="black" d="M1820.7,-14984C1813.7,-14975.18 1806.05,-14965.55 1798.75,-14956.35"/>
<polygon fill="black" stroke="black" points="1801.4,-14954.07 1792.44,-14948.42 1795.92,-14958.42 1801.4,-14954.07"/>
</g>
<!-- ffn_allreduce_3 -->
<g id="node53" class="node">
<title>ffn_allreduce_3</title>
<ellipse fill="red" stroke="red" cx="1766" cy="-14796.03" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1766" y="-14814.83" font-family="Times,serif" font-size="14.00">Layer3_FFN_AllReduce</text>
<text text-anchor="middle" x="1766" y="-14799.83" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-14784.83" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-14769.83" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (All&#45;Reduce)</text>
</g>
<!-- ffn_down_3&#45;&gt;ffn_allreduce_3 -->
<g id="edge66" class="edge">
<title>ffn_down_3&#45;&gt;ffn_allreduce_3</title>
<path fill="none" stroke="black" d="M1766,-14879.85C1766,-14871.86 1766,-14863.09 1766,-14854.35"/>
<polygon fill="black" stroke="black" points="1769.5,-14854.14 1766,-14844.14 1762.5,-14854.14 1769.5,-14854.14"/>
</g>
<!-- ffn_allreduce_3&#45;&gt;ffn_residual_3 -->
<g id="edge67" class="edge">
<title>ffn_allreduce_3&#45;&gt;ffn_residual_3</title>
<path fill="none" stroke="black" d="M1777.46,-14747.73C1779.42,-14739.63 1781.52,-14730.97 1783.66,-14722.17"/>
<polygon fill="black" stroke="black" points="1787.12,-14722.73 1786.07,-14712.18 1780.32,-14721.08 1787.12,-14722.73"/>
</g>
<!-- mha_q_4 -->
<g id="node55" class="node">
<title>mha_q_4</title>
<polygon fill="lightblue" stroke="lightblue" points="1347.5,-14509.95 938.5,-14509.95 938.5,-14441.95 1347.5,-14441.95 1347.5,-14509.95"/>
<text text-anchor="middle" x="1143" y="-14494.75" font-family="Times,serif" font-size="14.00">Layer4_MHA_Q</text>
<text text-anchor="middle" x="1143" y="-14479.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1143" y="-14464.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1143" y="-14449.75" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_residual_3&#45;&gt;mha_q_4 -->
<g id="edge69" class="edge">
<title>ffn_residual_3&#45;&gt;mha_q_4</title>
<path fill="none" stroke="black" d="M1445.88,-14545.93C1393.9,-14534.09 1342.86,-14522.47 1297.94,-14512.24"/>
<polygon fill="black" stroke="black" points="1298.68,-14508.82 1288.15,-14510.01 1297.12,-14515.64 1298.68,-14508.82"/>
</g>
<!-- mha_k_4 -->
<g id="node56" class="node">
<title>mha_k_4</title>
<polygon fill="lightblue" stroke="lightblue" points="1774.5,-14509.95 1365.5,-14509.95 1365.5,-14441.95 1774.5,-14441.95 1774.5,-14509.95"/>
<text text-anchor="middle" x="1570" y="-14494.75" font-family="Times,serif" font-size="14.00">Layer4_MHA_K</text>
<text text-anchor="middle" x="1570" y="-14479.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1570" y="-14464.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1570" y="-14449.75" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_residual_3&#45;&gt;mha_k_4 -->
<g id="edge70" class="edge">
<title>ffn_residual_3&#45;&gt;mha_k_4</title>
<path fill="none" stroke="black" d="M1677.64,-14545.82C1661.1,-14535.24 1644.84,-14524.83 1630.16,-14515.44"/>
<polygon fill="black" stroke="black" points="1632.02,-14512.48 1621.71,-14510.04 1628.25,-14518.37 1632.02,-14512.48"/>
</g>
<!-- mha_v_4 -->
<g id="node57" class="node">
<title>mha_v_4</title>
<polygon fill="lightblue" stroke="lightblue" points="2201.5,-14509.95 1792.5,-14509.95 1792.5,-14441.95 2201.5,-14441.95 2201.5,-14509.95"/>
<text text-anchor="middle" x="1997" y="-14494.75" font-family="Times,serif" font-size="14.00">Layer4_MHA_V</text>
<text text-anchor="middle" x="1997" y="-14479.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1997" y="-14464.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1997" y="-14449.75" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_residual_3&#45;&gt;mha_v_4 -->
<g id="edge71" class="edge">
<title>ffn_residual_3&#45;&gt;mha_v_4</title>
<path fill="none" stroke="black" d="M1909.88,-14545.82C1922.7,-14535.69 1935.31,-14525.72 1946.79,-14516.65"/>
<polygon fill="black" stroke="black" points="1949.25,-14519.16 1954.93,-14510.21 1944.91,-14513.67 1949.25,-14519.16"/>
</g>
<!-- attn_residual_4 -->
<g id="node61" class="node">
<title>attn_residual_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2222.11,-14065.78 1625.39,-14065.78 1471.89,-13899.78 2068.61,-13899.78 2222.11,-14065.78"/>
<text text-anchor="middle" x="1847" y="-14009.08" font-family="Times,serif" font-size="14.00">Layer4_Attn_Residual</text>
<text text-anchor="middle" x="1847" y="-13994.08" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-13979.08" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-13964.08" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-13949.08" font-family="Times,serif" font-size="14.00">Device: 0&#45;7</text>
</g>
<!-- ffn_residual_3&#45;&gt;attn_residual_4 -->
<g id="edge78" class="edge">
<title>ffn_residual_3&#45;&gt;attn_residual_4</title>
<path fill="none" stroke="black" d="M2058.31,-14578.95C2127.23,-14560.4 2189.04,-14537.1 2211,-14509.95 2249.39,-14462.48 2221,-14434 2221,-14372.95 2221,-14372.95 2221,-14372.95 2221,-14266.95 2221,-14179.51 2155.22,-14115.61 2078.83,-14070.88"/>
<polygon fill="black" stroke="black" points="2080.37,-14067.73 2069.96,-14065.8 2076.89,-14073.8 2080.37,-14067.73"/>
</g>
<!-- attn_score_4 -->
<g id="node58" class="node">
<title>attn_score_4</title>
<polygon fill="lightblue" stroke="lightblue" points="1784,-14405.95 1356,-14405.95 1356,-14337.95 1784,-14337.95 1784,-14405.95"/>
<text text-anchor="middle" x="1570" y="-14390.75" font-family="Times,serif" font-size="14.00">Layer4_Attn_Score</text>
<text text-anchor="middle" x="1570" y="-14375.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1570" y="-14360.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1570" y="-14345.75" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- mha_q_4&#45;&gt;attn_score_4 -->
<g id="edge72" class="edge">
<title>mha_q_4&#45;&gt;attn_score_4</title>
<path fill="none" stroke="black" d="M1281.34,-14441.9C1326.16,-14431.2 1376.05,-14419.28 1421.57,-14408.41"/>
<polygon fill="black" stroke="black" points="1422.6,-14411.76 1431.51,-14406.03 1420.98,-14404.95 1422.6,-14411.76"/>
</g>
<!-- mha_k_4&#45;&gt;attn_score_4 -->
<g id="edge73" class="edge">
<title>mha_k_4&#45;&gt;attn_score_4</title>
<path fill="none" stroke="black" d="M1570,-14441.83C1570,-14433.73 1570,-14424.93 1570,-14416.42"/>
<polygon fill="black" stroke="black" points="1573.5,-14416.25 1570,-14406.25 1566.5,-14416.25 1573.5,-14416.25"/>
</g>
<!-- attn_out_4 -->
<g id="node59" class="node">
<title>attn_out_4</title>
<polygon fill="lightblue" stroke="lightblue" points="2045.5,-14301.95 1648.5,-14301.95 1648.5,-14233.95 2045.5,-14233.95 2045.5,-14301.95"/>
<text text-anchor="middle" x="1847" y="-14286.75" font-family="Times,serif" font-size="14.00">Layer4_Attn_Out</text>
<text text-anchor="middle" x="1847" y="-14271.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1847" y="-14256.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-14241.75" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_score_4&#45;&gt;attn_out_4 -->
<g id="edge75" class="edge">
<title>attn_score_4&#45;&gt;attn_out_4</title>
<path fill="none" stroke="black" d="M1659.93,-14337.83C1687.89,-14327.54 1718.88,-14316.13 1747.45,-14305.61"/>
<polygon fill="black" stroke="black" points="1748.87,-14308.81 1757.04,-14302.07 1746.45,-14302.25 1748.87,-14308.81"/>
</g>
<!-- attn_allreduce_4 -->
<g id="node60" class="node">
<title>attn_allreduce_4</title>
<ellipse fill="red" stroke="red" cx="1847" cy="-14149.87" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1847" y="-14168.67" font-family="Times,serif" font-size="14.00">Layer4_Attn_AllReduce</text>
<text text-anchor="middle" x="1847" y="-14153.67" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-14138.67" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-14123.67" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (All&#45;Reduce)</text>
</g>
<!-- attn_out_4&#45;&gt;attn_allreduce_4 -->
<g id="edge76" class="edge">
<title>attn_out_4&#45;&gt;attn_allreduce_4</title>
<path fill="none" stroke="black" d="M1847,-14233.69C1847,-14225.69 1847,-14216.93 1847,-14208.18"/>
<polygon fill="black" stroke="black" points="1850.5,-14207.98 1847,-14197.98 1843.5,-14207.98 1850.5,-14207.98"/>
</g>
<!-- attn_allreduce_4&#45;&gt;attn_residual_4 -->
<g id="edge77" class="edge">
<title>attn_allreduce_4&#45;&gt;attn_residual_4</title>
<path fill="none" stroke="black" d="M1847,-14101.56C1847,-14093.55 1847,-14084.99 1847,-14076.28"/>
<polygon fill="black" stroke="black" points="1850.5,-14076.02 1847,-14066.02 1843.5,-14076.02 1850.5,-14076.02"/>
</g>
<!-- ffn_up_4 -->
<g id="node62" class="node">
<title>ffn_up_4</title>
<polygon fill="lightblue" stroke="lightblue" points="1654,-13863.78 1304,-13863.78 1304,-13795.78 1654,-13795.78 1654,-13863.78"/>
<text text-anchor="middle" x="1479" y="-13848.58" font-family="Times,serif" font-size="14.00">Layer4_FFN_Up</text>
<text text-anchor="middle" x="1479" y="-13833.58" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1479" y="-13818.58" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1479" y="-13803.58" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_residual_4&#45;&gt;ffn_up_4 -->
<g id="edge79" class="edge">
<title>attn_residual_4&#45;&gt;ffn_up_4</title>
<path fill="none" stroke="black" d="M1647.12,-13899.77C1619.85,-13888.58 1593.05,-13877.58 1569.14,-13867.77"/>
<polygon fill="black" stroke="black" points="1570.36,-13864.49 1559.78,-13863.93 1567.7,-13870.96 1570.36,-13864.49"/>
</g>
<!-- ffn_gate_4 -->
<g id="node63" class="node">
<title>ffn_gate_4</title>
<polygon fill="lightblue" stroke="lightblue" points="2022,-13863.78 1672,-13863.78 1672,-13795.78 2022,-13795.78 2022,-13863.78"/>
<text text-anchor="middle" x="1847" y="-13848.58" font-family="Times,serif" font-size="14.00">Layer4_FFN_Gate</text>
<text text-anchor="middle" x="1847" y="-13833.58" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-13818.58" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1847" y="-13803.58" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_residual_4&#45;&gt;ffn_gate_4 -->
<g id="edge80" class="edge">
<title>attn_residual_4&#45;&gt;ffn_gate_4</title>
<path fill="none" stroke="black" d="M1847,-13899.66C1847,-13890.9 1847,-13882.27 1847,-13874.23"/>
<polygon fill="black" stroke="black" points="1850.5,-13874.04 1847,-13864.05 1843.5,-13874.05 1850.5,-13874.04"/>
</g>
<!-- ffn_residual_4 -->
<g id="node66" class="node">
<title>ffn_residual_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2181.11,-13523.62 1584.39,-13523.62 1430.89,-13357.62 2027.61,-13357.62 2181.11,-13523.62"/>
<text text-anchor="middle" x="1806" y="-13466.92" font-family="Times,serif" font-size="14.00">Layer4_FFN_Residual</text>
<text text-anchor="middle" x="1806" y="-13451.92" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-13436.92" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-13421.92" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-13406.92" font-family="Times,serif" font-size="14.00">Device: 0&#45;7</text>
</g>
<!-- attn_residual_4&#45;&gt;ffn_residual_4 -->
<g id="edge85" class="edge">
<title>attn_residual_4&#45;&gt;ffn_residual_4</title>
<path fill="none" stroke="black" d="M2003.78,-13899.57C2014.46,-13888.84 2023.81,-13876.94 2031,-13863.78 2095.84,-13745.17 2100.95,-13675.29 2031,-13559.62 2024.67,-13549.15 2017.07,-13539.56 2008.55,-13530.79"/>
<polygon fill="black" stroke="black" points="2010.79,-13528.09 2001.19,-13523.62 2005.91,-13533.1 2010.79,-13528.09"/>
</g>
<!-- ffn_down_4 -->
<g id="node64" class="node">
<title>ffn_down_4</title>
<polygon fill="lightblue" stroke="lightblue" points="1947,-13759.78 1585,-13759.78 1585,-13691.78 1947,-13691.78 1947,-13759.78"/>
<text text-anchor="middle" x="1766" y="-13744.58" font-family="Times,serif" font-size="14.00">Layer4_FFN_Down</text>
<text text-anchor="middle" x="1766" y="-13729.58" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1766" y="-13714.58" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-13699.58" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_up_4&#45;&gt;ffn_down_4 -->
<g id="edge81" class="edge">
<title>ffn_up_4&#45;&gt;ffn_down_4</title>
<path fill="none" stroke="black" d="M1572.18,-13795.67C1601.28,-13785.33 1633.53,-13773.86 1663.25,-13763.3"/>
<polygon fill="black" stroke="black" points="1664.55,-13766.55 1672.8,-13759.91 1662.2,-13759.96 1664.55,-13766.55"/>
</g>
<!-- ffn_gate_4&#45;&gt;ffn_down_4 -->
<g id="edge82" class="edge">
<title>ffn_gate_4&#45;&gt;ffn_down_4</title>
<path fill="none" stroke="black" d="M1820.7,-13795.67C1813.7,-13786.85 1806.05,-13777.21 1798.75,-13768.02"/>
<polygon fill="black" stroke="black" points="1801.4,-13765.74 1792.44,-13760.08 1795.92,-13770.09 1801.4,-13765.74"/>
</g>
<!-- ffn_allreduce_4 -->
<g id="node65" class="node">
<title>ffn_allreduce_4</title>
<ellipse fill="red" stroke="red" cx="1766" cy="-13607.7" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1766" y="-13626.5" font-family="Times,serif" font-size="14.00">Layer4_FFN_AllReduce</text>
<text text-anchor="middle" x="1766" y="-13611.5" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-13596.5" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-13581.5" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (All&#45;Reduce)</text>
</g>
<!-- ffn_down_4&#45;&gt;ffn_allreduce_4 -->
<g id="edge83" class="edge">
<title>ffn_down_4&#45;&gt;ffn_allreduce_4</title>
<path fill="none" stroke="black" d="M1766,-13691.52C1766,-13683.52 1766,-13674.76 1766,-13666.02"/>
<polygon fill="black" stroke="black" points="1769.5,-13665.81 1766,-13655.81 1762.5,-13665.81 1769.5,-13665.81"/>
</g>
<!-- ffn_allreduce_4&#45;&gt;ffn_residual_4 -->
<g id="edge84" class="edge">
<title>ffn_allreduce_4&#45;&gt;ffn_residual_4</title>
<path fill="none" stroke="black" d="M1777.46,-13559.39C1779.42,-13551.29 1781.52,-13542.64 1783.66,-13533.83"/>
<polygon fill="black" stroke="black" points="1787.12,-13534.39 1786.07,-13523.85 1780.32,-13532.74 1787.12,-13534.39"/>
</g>
<!-- mha_q_5 -->
<g id="node67" class="node">
<title>mha_q_5</title>
<polygon fill="lightblue" stroke="lightblue" points="1347.5,-13321.62 938.5,-13321.62 938.5,-13253.62 1347.5,-13253.62 1347.5,-13321.62"/>
<text text-anchor="middle" x="1143" y="-13306.42" font-family="Times,serif" font-size="14.00">Layer5_MHA_Q</text>
<text text-anchor="middle" x="1143" y="-13291.42" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1143" y="-13276.42" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1143" y="-13261.42" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_residual_4&#45;&gt;mha_q_5 -->
<g id="edge86" class="edge">
<title>ffn_residual_4&#45;&gt;mha_q_5</title>
<path fill="none" stroke="black" d="M1445.88,-13357.6C1393.9,-13345.76 1342.86,-13334.14 1297.94,-13323.9"/>
<polygon fill="black" stroke="black" points="1298.68,-13320.48 1288.15,-13321.67 1297.12,-13327.31 1298.68,-13320.48"/>
</g>
<!-- mha_k_5 -->
<g id="node68" class="node">
<title>mha_k_5</title>
<polygon fill="lightblue" stroke="lightblue" points="1774.5,-13321.62 1365.5,-13321.62 1365.5,-13253.62 1774.5,-13253.62 1774.5,-13321.62"/>
<text text-anchor="middle" x="1570" y="-13306.42" font-family="Times,serif" font-size="14.00">Layer5_MHA_K</text>
<text text-anchor="middle" x="1570" y="-13291.42" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1570" y="-13276.42" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1570" y="-13261.42" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_residual_4&#45;&gt;mha_k_5 -->
<g id="edge87" class="edge">
<title>ffn_residual_4&#45;&gt;mha_k_5</title>
<path fill="none" stroke="black" d="M1677.64,-13357.49C1661.1,-13346.91 1644.84,-13336.5 1630.16,-13327.11"/>
<polygon fill="black" stroke="black" points="1632.02,-13324.14 1621.71,-13321.7 1628.25,-13330.04 1632.02,-13324.14"/>
</g>
<!-- mha_v_5 -->
<g id="node69" class="node">
<title>mha_v_5</title>
<polygon fill="lightblue" stroke="lightblue" points="2201.5,-13321.62 1792.5,-13321.62 1792.5,-13253.62 2201.5,-13253.62 2201.5,-13321.62"/>
<text text-anchor="middle" x="1997" y="-13306.42" font-family="Times,serif" font-size="14.00">Layer5_MHA_V</text>
<text text-anchor="middle" x="1997" y="-13291.42" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1997" y="-13276.42" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1997" y="-13261.42" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_residual_4&#45;&gt;mha_v_5 -->
<g id="edge88" class="edge">
<title>ffn_residual_4&#45;&gt;mha_v_5</title>
<path fill="none" stroke="black" d="M1909.88,-13357.49C1922.7,-13347.36 1935.31,-13337.39 1946.79,-13328.32"/>
<polygon fill="black" stroke="black" points="1949.25,-13330.83 1954.93,-13321.88 1944.91,-13325.33 1949.25,-13330.83"/>
</g>
<!-- attn_residual_5 -->
<g id="node73" class="node">
<title>attn_residual_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2222.11,-12877.45 1625.39,-12877.45 1471.89,-12711.45 2068.61,-12711.45 2222.11,-12877.45"/>
<text text-anchor="middle" x="1847" y="-12820.75" font-family="Times,serif" font-size="14.00">Layer5_Attn_Residual</text>
<text text-anchor="middle" x="1847" y="-12805.75" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-12790.75" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-12775.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-12760.75" font-family="Times,serif" font-size="14.00">Device: 0&#45;7</text>
</g>
<!-- ffn_residual_4&#45;&gt;attn_residual_5 -->
<g id="edge95" class="edge">
<title>ffn_residual_4&#45;&gt;attn_residual_5</title>
<path fill="none" stroke="black" d="M2058.31,-13390.62C2127.23,-13372.07 2189.04,-13348.77 2211,-13321.62 2249.39,-13274.15 2221,-13245.67 2221,-13184.62 2221,-13184.62 2221,-13184.62 2221,-13078.62 2221,-12991.18 2155.22,-12927.28 2078.83,-12882.55"/>
<polygon fill="black" stroke="black" points="2080.37,-12879.4 2069.96,-12877.46 2076.89,-12885.47 2080.37,-12879.4"/>
</g>
<!-- attn_score_5 -->
<g id="node70" class="node">
<title>attn_score_5</title>
<polygon fill="lightblue" stroke="lightblue" points="1784,-13217.62 1356,-13217.62 1356,-13149.62 1784,-13149.62 1784,-13217.62"/>
<text text-anchor="middle" x="1570" y="-13202.42" font-family="Times,serif" font-size="14.00">Layer5_Attn_Score</text>
<text text-anchor="middle" x="1570" y="-13187.42" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1570" y="-13172.42" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1570" y="-13157.42" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- mha_q_5&#45;&gt;attn_score_5 -->
<g id="edge89" class="edge">
<title>mha_q_5&#45;&gt;attn_score_5</title>
<path fill="none" stroke="black" d="M1281.34,-13253.57C1326.16,-13242.86 1376.05,-13230.95 1421.57,-13220.07"/>
<polygon fill="black" stroke="black" points="1422.6,-13223.43 1431.51,-13217.7 1420.98,-13216.62 1422.6,-13223.43"/>
</g>
<!-- mha_k_5&#45;&gt;attn_score_5 -->
<g id="edge90" class="edge">
<title>mha_k_5&#45;&gt;attn_score_5</title>
<path fill="none" stroke="black" d="M1570,-13253.5C1570,-13245.39 1570,-13236.6 1570,-13228.09"/>
<polygon fill="black" stroke="black" points="1573.5,-13227.92 1570,-13217.92 1566.5,-13227.92 1573.5,-13227.92"/>
</g>
<!-- attn_out_5 -->
<g id="node71" class="node">
<title>attn_out_5</title>
<polygon fill="lightblue" stroke="lightblue" points="2045.5,-13113.62 1648.5,-13113.62 1648.5,-13045.62 2045.5,-13045.62 2045.5,-13113.62"/>
<text text-anchor="middle" x="1847" y="-13098.42" font-family="Times,serif" font-size="14.00">Layer5_Attn_Out</text>
<text text-anchor="middle" x="1847" y="-13083.42" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1847" y="-13068.42" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-13053.42" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_score_5&#45;&gt;attn_out_5 -->
<g id="edge92" class="edge">
<title>attn_score_5&#45;&gt;attn_out_5</title>
<path fill="none" stroke="black" d="M1659.93,-13149.5C1687.89,-13139.2 1718.88,-13127.8 1747.45,-13117.27"/>
<polygon fill="black" stroke="black" points="1748.87,-13120.48 1757.04,-13113.74 1746.45,-13113.91 1748.87,-13120.48"/>
</g>
<!-- attn_allreduce_5 -->
<g id="node72" class="node">
<title>attn_allreduce_5</title>
<ellipse fill="red" stroke="red" cx="1847" cy="-12961.53" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1847" y="-12980.33" font-family="Times,serif" font-size="14.00">Layer5_Attn_AllReduce</text>
<text text-anchor="middle" x="1847" y="-12965.33" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-12950.33" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-12935.33" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (All&#45;Reduce)</text>
</g>
<!-- attn_out_5&#45;&gt;attn_allreduce_5 -->
<g id="edge93" class="edge">
<title>attn_out_5&#45;&gt;attn_allreduce_5</title>
<path fill="none" stroke="black" d="M1847,-13045.35C1847,-13037.36 1847,-13028.59 1847,-13019.85"/>
<polygon fill="black" stroke="black" points="1850.5,-13019.64 1847,-13009.64 1843.5,-13019.64 1850.5,-13019.64"/>
</g>
<!-- attn_allreduce_5&#45;&gt;attn_residual_5 -->
<g id="edge94" class="edge">
<title>attn_allreduce_5&#45;&gt;attn_residual_5</title>
<path fill="none" stroke="black" d="M1847,-12913.23C1847,-12905.22 1847,-12896.66 1847,-12887.95"/>
<polygon fill="black" stroke="black" points="1850.5,-12887.68 1847,-12877.68 1843.5,-12887.68 1850.5,-12887.68"/>
</g>
<!-- ffn_up_5 -->
<g id="node74" class="node">
<title>ffn_up_5</title>
<polygon fill="lightblue" stroke="lightblue" points="1654,-12675.45 1304,-12675.45 1304,-12607.45 1654,-12607.45 1654,-12675.45"/>
<text text-anchor="middle" x="1479" y="-12660.25" font-family="Times,serif" font-size="14.00">Layer5_FFN_Up</text>
<text text-anchor="middle" x="1479" y="-12645.25" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1479" y="-12630.25" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1479" y="-12615.25" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_residual_5&#45;&gt;ffn_up_5 -->
<g id="edge96" class="edge">
<title>attn_residual_5&#45;&gt;ffn_up_5</title>
<path fill="none" stroke="black" d="M1647.12,-12711.43C1619.85,-12700.24 1593.05,-12689.25 1569.14,-12679.44"/>
<polygon fill="black" stroke="black" points="1570.36,-12676.15 1559.78,-12675.6 1567.7,-12682.63 1570.36,-12676.15"/>
</g>
<!-- ffn_gate_5 -->
<g id="node75" class="node">
<title>ffn_gate_5</title>
<polygon fill="lightblue" stroke="lightblue" points="2022,-12675.45 1672,-12675.45 1672,-12607.45 2022,-12607.45 2022,-12675.45"/>
<text text-anchor="middle" x="1847" y="-12660.25" font-family="Times,serif" font-size="14.00">Layer5_FFN_Gate</text>
<text text-anchor="middle" x="1847" y="-12645.25" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-12630.25" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1847" y="-12615.25" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_residual_5&#45;&gt;ffn_gate_5 -->
<g id="edge97" class="edge">
<title>attn_residual_5&#45;&gt;ffn_gate_5</title>
<path fill="none" stroke="black" d="M1847,-12711.32C1847,-12702.57 1847,-12693.93 1847,-12685.9"/>
<polygon fill="black" stroke="black" points="1850.5,-12685.71 1847,-12675.71 1843.5,-12685.71 1850.5,-12685.71"/>
</g>
<!-- ffn_residual_5 -->
<g id="node78" class="node">
<title>ffn_residual_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2181.11,-12335.28 1584.39,-12335.28 1430.89,-12169.28 2027.61,-12169.28 2181.11,-12335.28"/>
<text text-anchor="middle" x="1806" y="-12278.58" font-family="Times,serif" font-size="14.00">Layer5_FFN_Residual</text>
<text text-anchor="middle" x="1806" y="-12263.58" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-12248.58" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-12233.58" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-12218.58" font-family="Times,serif" font-size="14.00">Device: 0&#45;7</text>
</g>
<!-- attn_residual_5&#45;&gt;ffn_residual_5 -->
<g id="edge102" class="edge">
<title>attn_residual_5&#45;&gt;ffn_residual_5</title>
<path fill="none" stroke="black" d="M2003.78,-12711.23C2014.46,-12700.51 2023.81,-12688.6 2031,-12675.45 2095.84,-12556.83 2100.95,-12486.96 2031,-12371.28 2024.67,-12360.82 2017.07,-12351.23 2008.55,-12342.46"/>
<polygon fill="black" stroke="black" points="2010.79,-12339.76 2001.19,-12335.28 2005.91,-12344.77 2010.79,-12339.76"/>
</g>
<!-- ffn_down_5 -->
<g id="node76" class="node">
<title>ffn_down_5</title>
<polygon fill="lightblue" stroke="lightblue" points="1947,-12571.45 1585,-12571.45 1585,-12503.45 1947,-12503.45 1947,-12571.45"/>
<text text-anchor="middle" x="1766" y="-12556.25" font-family="Times,serif" font-size="14.00">Layer5_FFN_Down</text>
<text text-anchor="middle" x="1766" y="-12541.25" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1766" y="-12526.25" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-12511.25" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_up_5&#45;&gt;ffn_down_5 -->
<g id="edge98" class="edge">
<title>ffn_up_5&#45;&gt;ffn_down_5</title>
<path fill="none" stroke="black" d="M1572.18,-12607.33C1601.28,-12596.99 1633.53,-12585.53 1663.25,-12574.97"/>
<polygon fill="black" stroke="black" points="1664.55,-12578.22 1672.8,-12571.58 1662.2,-12571.63 1664.55,-12578.22"/>
</g>
<!-- ffn_gate_5&#45;&gt;ffn_down_5 -->
<g id="edge99" class="edge">
<title>ffn_gate_5&#45;&gt;ffn_down_5</title>
<path fill="none" stroke="black" d="M1820.7,-12607.33C1813.7,-12598.52 1806.05,-12588.88 1798.75,-12579.69"/>
<polygon fill="black" stroke="black" points="1801.4,-12577.4 1792.44,-12571.75 1795.92,-12581.76 1801.4,-12577.4"/>
</g>
<!-- ffn_allreduce_5 -->
<g id="node77" class="node">
<title>ffn_allreduce_5</title>
<ellipse fill="red" stroke="red" cx="1766" cy="-12419.37" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1766" y="-12438.17" font-family="Times,serif" font-size="14.00">Layer5_FFN_AllReduce</text>
<text text-anchor="middle" x="1766" y="-12423.17" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-12408.17" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-12393.17" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (All&#45;Reduce)</text>
</g>
<!-- ffn_down_5&#45;&gt;ffn_allreduce_5 -->
<g id="edge100" class="edge">
<title>ffn_down_5&#45;&gt;ffn_allreduce_5</title>
<path fill="none" stroke="black" d="M1766,-12503.19C1766,-12495.19 1766,-12486.43 1766,-12477.68"/>
<polygon fill="black" stroke="black" points="1769.5,-12477.48 1766,-12467.48 1762.5,-12477.48 1769.5,-12477.48"/>
</g>
<!-- ffn_allreduce_5&#45;&gt;ffn_residual_5 -->
<g id="edge101" class="edge">
<title>ffn_allreduce_5&#45;&gt;ffn_residual_5</title>
<path fill="none" stroke="black" d="M1777.46,-12371.06C1779.42,-12362.96 1781.52,-12354.31 1783.66,-12345.5"/>
<polygon fill="black" stroke="black" points="1787.12,-12346.06 1786.07,-12335.52 1780.32,-12344.41 1787.12,-12346.06"/>
</g>
<!-- mha_q_6 -->
<g id="node79" class="node">
<title>mha_q_6</title>
<polygon fill="lightblue" stroke="lightblue" points="1347.5,-12133.28 938.5,-12133.28 938.5,-12065.28 1347.5,-12065.28 1347.5,-12133.28"/>
<text text-anchor="middle" x="1143" y="-12118.08" font-family="Times,serif" font-size="14.00">Layer6_MHA_Q</text>
<text text-anchor="middle" x="1143" y="-12103.08" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1143" y="-12088.08" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1143" y="-12073.08" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_residual_5&#45;&gt;mha_q_6 -->
<g id="edge103" class="edge">
<title>ffn_residual_5&#45;&gt;mha_q_6</title>
<path fill="none" stroke="black" d="M1445.88,-12169.27C1393.9,-12157.43 1342.86,-12145.8 1297.94,-12135.57"/>
<polygon fill="black" stroke="black" points="1298.68,-12132.15 1288.15,-12133.34 1297.12,-12138.97 1298.68,-12132.15"/>
</g>
<!-- mha_k_6 -->
<g id="node80" class="node">
<title>mha_k_6</title>
<polygon fill="lightblue" stroke="lightblue" points="1774.5,-12133.28 1365.5,-12133.28 1365.5,-12065.28 1774.5,-12065.28 1774.5,-12133.28"/>
<text text-anchor="middle" x="1570" y="-12118.08" font-family="Times,serif" font-size="14.00">Layer6_MHA_K</text>
<text text-anchor="middle" x="1570" y="-12103.08" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1570" y="-12088.08" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1570" y="-12073.08" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_residual_5&#45;&gt;mha_k_6 -->
<g id="edge104" class="edge">
<title>ffn_residual_5&#45;&gt;mha_k_6</title>
<path fill="none" stroke="black" d="M1677.64,-12169.16C1661.1,-12158.57 1644.84,-12148.17 1630.16,-12138.78"/>
<polygon fill="black" stroke="black" points="1632.02,-12135.81 1621.71,-12133.37 1628.25,-12141.71 1632.02,-12135.81"/>
</g>
<!-- mha_v_6 -->
<g id="node81" class="node">
<title>mha_v_6</title>
<polygon fill="lightblue" stroke="lightblue" points="2201.5,-12133.28 1792.5,-12133.28 1792.5,-12065.28 2201.5,-12065.28 2201.5,-12133.28"/>
<text text-anchor="middle" x="1997" y="-12118.08" font-family="Times,serif" font-size="14.00">Layer6_MHA_V</text>
<text text-anchor="middle" x="1997" y="-12103.08" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1997" y="-12088.08" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1997" y="-12073.08" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_residual_5&#45;&gt;mha_v_6 -->
<g id="edge105" class="edge">
<title>ffn_residual_5&#45;&gt;mha_v_6</title>
<path fill="none" stroke="black" d="M1909.88,-12169.16C1922.7,-12159.03 1935.31,-12149.06 1946.79,-12139.98"/>
<polygon fill="black" stroke="black" points="1949.25,-12142.49 1954.93,-12133.55 1944.91,-12137 1949.25,-12142.49"/>
</g>
<!-- attn_residual_6 -->
<g id="node85" class="node">
<title>attn_residual_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2222.11,-11689.12 1625.39,-11689.12 1471.89,-11523.12 2068.61,-11523.12 2222.11,-11689.12"/>
<text text-anchor="middle" x="1847" y="-11632.42" font-family="Times,serif" font-size="14.00">Layer6_Attn_Residual</text>
<text text-anchor="middle" x="1847" y="-11617.42" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-11602.42" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-11587.42" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-11572.42" font-family="Times,serif" font-size="14.00">Device: 0&#45;7</text>
</g>
<!-- ffn_residual_5&#45;&gt;attn_residual_6 -->
<g id="edge112" class="edge">
<title>ffn_residual_5&#45;&gt;attn_residual_6</title>
<path fill="none" stroke="black" d="M2058.31,-12202.29C2127.23,-12183.74 2189.04,-12160.44 2211,-12133.28 2249.39,-12085.82 2221,-12057.33 2221,-11996.28 2221,-11996.28 2221,-11996.28 2221,-11890.28 2221,-11802.85 2155.22,-11738.94 2078.83,-11694.22"/>
<polygon fill="black" stroke="black" points="2080.37,-11691.06 2069.96,-11689.13 2076.89,-11697.14 2080.37,-11691.06"/>
</g>
<!-- attn_score_6 -->
<g id="node82" class="node">
<title>attn_score_6</title>
<polygon fill="lightblue" stroke="lightblue" points="1784,-12029.28 1356,-12029.28 1356,-11961.28 1784,-11961.28 1784,-12029.28"/>
<text text-anchor="middle" x="1570" y="-12014.08" font-family="Times,serif" font-size="14.00">Layer6_Attn_Score</text>
<text text-anchor="middle" x="1570" y="-11999.08" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1570" y="-11984.08" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1570" y="-11969.08" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- mha_q_6&#45;&gt;attn_score_6 -->
<g id="edge106" class="edge">
<title>mha_q_6&#45;&gt;attn_score_6</title>
<path fill="none" stroke="black" d="M1281.34,-12065.24C1326.16,-12054.53 1376.05,-12042.61 1421.57,-12031.74"/>
<polygon fill="black" stroke="black" points="1422.6,-12035.09 1431.51,-12029.36 1420.98,-12028.28 1422.6,-12035.09"/>
</g>
<!-- mha_k_6&#45;&gt;attn_score_6 -->
<g id="edge107" class="edge">
<title>mha_k_6&#45;&gt;attn_score_6</title>
<path fill="none" stroke="black" d="M1570,-12065.17C1570,-12057.06 1570,-12048.27 1570,-12039.76"/>
<polygon fill="black" stroke="black" points="1573.5,-12039.58 1570,-12029.58 1566.5,-12039.58 1573.5,-12039.58"/>
</g>
<!-- attn_out_6 -->
<g id="node83" class="node">
<title>attn_out_6</title>
<polygon fill="lightblue" stroke="lightblue" points="2045.5,-11925.28 1648.5,-11925.28 1648.5,-11857.28 2045.5,-11857.28 2045.5,-11925.28"/>
<text text-anchor="middle" x="1847" y="-11910.08" font-family="Times,serif" font-size="14.00">Layer6_Attn_Out</text>
<text text-anchor="middle" x="1847" y="-11895.08" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1847" y="-11880.08" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-11865.08" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_score_6&#45;&gt;attn_out_6 -->
<g id="edge109" class="edge">
<title>attn_score_6&#45;&gt;attn_out_6</title>
<path fill="none" stroke="black" d="M1659.93,-11961.17C1687.89,-11950.87 1718.88,-11939.46 1747.45,-11928.94"/>
<polygon fill="black" stroke="black" points="1748.87,-11932.15 1757.04,-11925.41 1746.45,-11925.58 1748.87,-11932.15"/>
</g>
<!-- attn_allreduce_6 -->
<g id="node84" class="node">
<title>attn_allreduce_6</title>
<ellipse fill="red" stroke="red" cx="1847" cy="-11773.2" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1847" y="-11792" font-family="Times,serif" font-size="14.00">Layer6_Attn_AllReduce</text>
<text text-anchor="middle" x="1847" y="-11777" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-11762" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-11747" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (All&#45;Reduce)</text>
</g>
<!-- attn_out_6&#45;&gt;attn_allreduce_6 -->
<g id="edge110" class="edge">
<title>attn_out_6&#45;&gt;attn_allreduce_6</title>
<path fill="none" stroke="black" d="M1847,-11857.02C1847,-11849.03 1847,-11840.26 1847,-11831.52"/>
<polygon fill="black" stroke="black" points="1850.5,-11831.31 1847,-11821.31 1843.5,-11831.31 1850.5,-11831.31"/>
</g>
<!-- attn_allreduce_6&#45;&gt;attn_residual_6 -->
<g id="edge111" class="edge">
<title>attn_allreduce_6&#45;&gt;attn_residual_6</title>
<path fill="none" stroke="black" d="M1847,-11724.89C1847,-11716.88 1847,-11708.32 1847,-11699.62"/>
<polygon fill="black" stroke="black" points="1850.5,-11699.35 1847,-11689.35 1843.5,-11699.35 1850.5,-11699.35"/>
</g>
<!-- ffn_up_6 -->
<g id="node86" class="node">
<title>ffn_up_6</title>
<polygon fill="lightblue" stroke="lightblue" points="1654,-11487.12 1304,-11487.12 1304,-11419.12 1654,-11419.12 1654,-11487.12"/>
<text text-anchor="middle" x="1479" y="-11471.92" font-family="Times,serif" font-size="14.00">Layer6_FFN_Up</text>
<text text-anchor="middle" x="1479" y="-11456.92" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1479" y="-11441.92" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1479" y="-11426.92" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_residual_6&#45;&gt;ffn_up_6 -->
<g id="edge113" class="edge">
<title>attn_residual_6&#45;&gt;ffn_up_6</title>
<path fill="none" stroke="black" d="M1647.12,-11523.1C1619.85,-11511.91 1593.05,-11500.92 1569.14,-11491.11"/>
<polygon fill="black" stroke="black" points="1570.36,-11487.82 1559.78,-11487.26 1567.7,-11494.3 1570.36,-11487.82"/>
</g>
<!-- ffn_gate_6 -->
<g id="node87" class="node">
<title>ffn_gate_6</title>
<polygon fill="lightblue" stroke="lightblue" points="2022,-11487.12 1672,-11487.12 1672,-11419.12 2022,-11419.12 2022,-11487.12"/>
<text text-anchor="middle" x="1847" y="-11471.92" font-family="Times,serif" font-size="14.00">Layer6_FFN_Gate</text>
<text text-anchor="middle" x="1847" y="-11456.92" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-11441.92" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1847" y="-11426.92" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_residual_6&#45;&gt;ffn_gate_6 -->
<g id="edge114" class="edge">
<title>attn_residual_6&#45;&gt;ffn_gate_6</title>
<path fill="none" stroke="black" d="M1847,-11522.99C1847,-11514.24 1847,-11505.6 1847,-11497.56"/>
<polygon fill="black" stroke="black" points="1850.5,-11497.38 1847,-11487.38 1843.5,-11497.38 1850.5,-11497.38"/>
</g>
<!-- ffn_residual_6 -->
<g id="node90" class="node">
<title>ffn_residual_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2181.11,-11146.95 1584.39,-11146.95 1430.89,-10980.95 2027.61,-10980.95 2181.11,-11146.95"/>
<text text-anchor="middle" x="1806" y="-11090.25" font-family="Times,serif" font-size="14.00">Layer6_FFN_Residual</text>
<text text-anchor="middle" x="1806" y="-11075.25" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-11060.25" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-11045.25" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-11030.25" font-family="Times,serif" font-size="14.00">Device: 0&#45;7</text>
</g>
<!-- attn_residual_6&#45;&gt;ffn_residual_6 -->
<g id="edge119" class="edge">
<title>attn_residual_6&#45;&gt;ffn_residual_6</title>
<path fill="none" stroke="black" d="M2003.78,-11522.9C2014.46,-11512.17 2023.81,-11500.27 2031,-11487.12 2095.84,-11368.5 2100.95,-11298.63 2031,-11182.95 2024.67,-11172.48 2017.07,-11162.9 2008.55,-11154.13"/>
<polygon fill="black" stroke="black" points="2010.79,-11151.42 2001.19,-11146.95 2005.91,-11156.44 2010.79,-11151.42"/>
</g>
<!-- ffn_down_6 -->
<g id="node88" class="node">
<title>ffn_down_6</title>
<polygon fill="lightblue" stroke="lightblue" points="1947,-11383.12 1585,-11383.12 1585,-11315.12 1947,-11315.12 1947,-11383.12"/>
<text text-anchor="middle" x="1766" y="-11367.92" font-family="Times,serif" font-size="14.00">Layer6_FFN_Down</text>
<text text-anchor="middle" x="1766" y="-11352.92" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1766" y="-11337.92" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-11322.92" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_up_6&#45;&gt;ffn_down_6 -->
<g id="edge115" class="edge">
<title>ffn_up_6&#45;&gt;ffn_down_6</title>
<path fill="none" stroke="black" d="M1572.18,-11419C1601.28,-11408.66 1633.53,-11397.2 1663.25,-11386.64"/>
<polygon fill="black" stroke="black" points="1664.55,-11389.89 1672.8,-11383.24 1662.2,-11383.29 1664.55,-11389.89"/>
</g>
<!-- ffn_gate_6&#45;&gt;ffn_down_6 -->
<g id="edge116" class="edge">
<title>ffn_gate_6&#45;&gt;ffn_down_6</title>
<path fill="none" stroke="black" d="M1820.7,-11419C1813.7,-11410.18 1806.05,-11400.55 1798.75,-11391.35"/>
<polygon fill="black" stroke="black" points="1801.4,-11389.07 1792.44,-11383.42 1795.92,-11393.42 1801.4,-11389.07"/>
</g>
<!-- ffn_allreduce_6 -->
<g id="node89" class="node">
<title>ffn_allreduce_6</title>
<ellipse fill="red" stroke="red" cx="1766" cy="-11231.03" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1766" y="-11249.83" font-family="Times,serif" font-size="14.00">Layer6_FFN_AllReduce</text>
<text text-anchor="middle" x="1766" y="-11234.83" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-11219.83" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-11204.83" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (All&#45;Reduce)</text>
</g>
<!-- ffn_down_6&#45;&gt;ffn_allreduce_6 -->
<g id="edge117" class="edge">
<title>ffn_down_6&#45;&gt;ffn_allreduce_6</title>
<path fill="none" stroke="black" d="M1766,-11314.85C1766,-11306.86 1766,-11298.09 1766,-11289.35"/>
<polygon fill="black" stroke="black" points="1769.5,-11289.14 1766,-11279.14 1762.5,-11289.14 1769.5,-11289.14"/>
</g>
<!-- ffn_allreduce_6&#45;&gt;ffn_residual_6 -->
<g id="edge118" class="edge">
<title>ffn_allreduce_6&#45;&gt;ffn_residual_6</title>
<path fill="none" stroke="black" d="M1777.46,-11182.73C1779.42,-11174.63 1781.52,-11165.97 1783.66,-11157.17"/>
<polygon fill="black" stroke="black" points="1787.12,-11157.73 1786.07,-11147.18 1780.32,-11156.08 1787.12,-11157.73"/>
</g>
<!-- mha_q_7 -->
<g id="node91" class="node">
<title>mha_q_7</title>
<polygon fill="lightblue" stroke="lightblue" points="1347.5,-10944.95 938.5,-10944.95 938.5,-10876.95 1347.5,-10876.95 1347.5,-10944.95"/>
<text text-anchor="middle" x="1143" y="-10929.75" font-family="Times,serif" font-size="14.00">Layer7_MHA_Q</text>
<text text-anchor="middle" x="1143" y="-10914.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1143" y="-10899.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1143" y="-10884.75" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_residual_6&#45;&gt;mha_q_7 -->
<g id="edge120" class="edge">
<title>ffn_residual_6&#45;&gt;mha_q_7</title>
<path fill="none" stroke="black" d="M1445.88,-10980.93C1393.9,-10969.09 1342.86,-10957.47 1297.94,-10947.24"/>
<polygon fill="black" stroke="black" points="1298.68,-10943.82 1288.15,-10945.01 1297.12,-10950.64 1298.68,-10943.82"/>
</g>
<!-- mha_k_7 -->
<g id="node92" class="node">
<title>mha_k_7</title>
<polygon fill="lightblue" stroke="lightblue" points="1774.5,-10944.95 1365.5,-10944.95 1365.5,-10876.95 1774.5,-10876.95 1774.5,-10944.95"/>
<text text-anchor="middle" x="1570" y="-10929.75" font-family="Times,serif" font-size="14.00">Layer7_MHA_K</text>
<text text-anchor="middle" x="1570" y="-10914.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1570" y="-10899.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1570" y="-10884.75" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_residual_6&#45;&gt;mha_k_7 -->
<g id="edge121" class="edge">
<title>ffn_residual_6&#45;&gt;mha_k_7</title>
<path fill="none" stroke="black" d="M1677.64,-10980.82C1661.1,-10970.24 1644.84,-10959.83 1630.16,-10950.44"/>
<polygon fill="black" stroke="black" points="1632.02,-10947.48 1621.71,-10945.04 1628.25,-10953.37 1632.02,-10947.48"/>
</g>
<!-- mha_v_7 -->
<g id="node93" class="node">
<title>mha_v_7</title>
<polygon fill="lightblue" stroke="lightblue" points="2201.5,-10944.95 1792.5,-10944.95 1792.5,-10876.95 2201.5,-10876.95 2201.5,-10944.95"/>
<text text-anchor="middle" x="1997" y="-10929.75" font-family="Times,serif" font-size="14.00">Layer7_MHA_V</text>
<text text-anchor="middle" x="1997" y="-10914.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1997" y="-10899.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1997" y="-10884.75" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_residual_6&#45;&gt;mha_v_7 -->
<g id="edge122" class="edge">
<title>ffn_residual_6&#45;&gt;mha_v_7</title>
<path fill="none" stroke="black" d="M1909.88,-10980.82C1922.7,-10970.69 1935.31,-10960.72 1946.79,-10951.65"/>
<polygon fill="black" stroke="black" points="1949.25,-10954.16 1954.93,-10945.21 1944.91,-10948.67 1949.25,-10954.16"/>
</g>
<!-- attn_residual_7 -->
<g id="node97" class="node">
<title>attn_residual_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2222.11,-10500.78 1625.39,-10500.78 1471.89,-10334.78 2068.61,-10334.78 2222.11,-10500.78"/>
<text text-anchor="middle" x="1847" y="-10444.08" font-family="Times,serif" font-size="14.00">Layer7_Attn_Residual</text>
<text text-anchor="middle" x="1847" y="-10429.08" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-10414.08" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-10399.08" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-10384.08" font-family="Times,serif" font-size="14.00">Device: 0&#45;7</text>
</g>
<!-- ffn_residual_6&#45;&gt;attn_residual_7 -->
<g id="edge129" class="edge">
<title>ffn_residual_6&#45;&gt;attn_residual_7</title>
<path fill="none" stroke="black" d="M2058.31,-11013.95C2127.23,-10995.41 2189.04,-10972.11 2211,-10944.95 2249.39,-10897.48 2221,-10869 2221,-10807.95 2221,-10807.95 2221,-10807.95 2221,-10701.95 2221,-10614.51 2155.22,-10550.61 2078.83,-10505.88"/>
<polygon fill="black" stroke="black" points="2080.37,-10502.73 2069.96,-10500.8 2076.89,-10508.81 2080.37,-10502.73"/>
</g>
<!-- attn_score_7 -->
<g id="node94" class="node">
<title>attn_score_7</title>
<polygon fill="lightblue" stroke="lightblue" points="1784,-10840.95 1356,-10840.95 1356,-10772.95 1784,-10772.95 1784,-10840.95"/>
<text text-anchor="middle" x="1570" y="-10825.75" font-family="Times,serif" font-size="14.00">Layer7_Attn_Score</text>
<text text-anchor="middle" x="1570" y="-10810.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1570" y="-10795.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1570" y="-10780.75" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- mha_q_7&#45;&gt;attn_score_7 -->
<g id="edge123" class="edge">
<title>mha_q_7&#45;&gt;attn_score_7</title>
<path fill="none" stroke="black" d="M1281.34,-10876.9C1326.16,-10866.2 1376.05,-10854.28 1421.57,-10843.41"/>
<polygon fill="black" stroke="black" points="1422.6,-10846.76 1431.51,-10841.03 1420.98,-10839.95 1422.6,-10846.76"/>
</g>
<!-- mha_k_7&#45;&gt;attn_score_7 -->
<g id="edge124" class="edge">
<title>mha_k_7&#45;&gt;attn_score_7</title>
<path fill="none" stroke="black" d="M1570,-10876.83C1570,-10868.73 1570,-10859.93 1570,-10851.42"/>
<polygon fill="black" stroke="black" points="1573.5,-10851.25 1570,-10841.25 1566.5,-10851.25 1573.5,-10851.25"/>
</g>
<!-- attn_out_7 -->
<g id="node95" class="node">
<title>attn_out_7</title>
<polygon fill="lightblue" stroke="lightblue" points="2045.5,-10736.95 1648.5,-10736.95 1648.5,-10668.95 2045.5,-10668.95 2045.5,-10736.95"/>
<text text-anchor="middle" x="1847" y="-10721.75" font-family="Times,serif" font-size="14.00">Layer7_Attn_Out</text>
<text text-anchor="middle" x="1847" y="-10706.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1847" y="-10691.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-10676.75" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_score_7&#45;&gt;attn_out_7 -->
<g id="edge126" class="edge">
<title>attn_score_7&#45;&gt;attn_out_7</title>
<path fill="none" stroke="black" d="M1659.93,-10772.83C1687.89,-10762.54 1718.88,-10751.13 1747.45,-10740.61"/>
<polygon fill="black" stroke="black" points="1748.87,-10743.82 1757.04,-10737.08 1746.45,-10737.25 1748.87,-10743.82"/>
</g>
<!-- attn_allreduce_7 -->
<g id="node96" class="node">
<title>attn_allreduce_7</title>
<ellipse fill="red" stroke="red" cx="1847" cy="-10584.87" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1847" y="-10603.67" font-family="Times,serif" font-size="14.00">Layer7_Attn_AllReduce</text>
<text text-anchor="middle" x="1847" y="-10588.67" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-10573.67" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-10558.67" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (All&#45;Reduce)</text>
</g>
<!-- attn_out_7&#45;&gt;attn_allreduce_7 -->
<g id="edge127" class="edge">
<title>attn_out_7&#45;&gt;attn_allreduce_7</title>
<path fill="none" stroke="black" d="M1847,-10668.69C1847,-10660.69 1847,-10651.93 1847,-10643.18"/>
<polygon fill="black" stroke="black" points="1850.5,-10642.98 1847,-10632.98 1843.5,-10642.98 1850.5,-10642.98"/>
</g>
<!-- attn_allreduce_7&#45;&gt;attn_residual_7 -->
<g id="edge128" class="edge">
<title>attn_allreduce_7&#45;&gt;attn_residual_7</title>
<path fill="none" stroke="black" d="M1847,-10536.56C1847,-10528.55 1847,-10519.99 1847,-10511.28"/>
<polygon fill="black" stroke="black" points="1850.5,-10511.02 1847,-10501.02 1843.5,-10511.02 1850.5,-10511.02"/>
</g>
<!-- ffn_up_7 -->
<g id="node98" class="node">
<title>ffn_up_7</title>
<polygon fill="lightblue" stroke="lightblue" points="1654,-10298.78 1304,-10298.78 1304,-10230.78 1654,-10230.78 1654,-10298.78"/>
<text text-anchor="middle" x="1479" y="-10283.58" font-family="Times,serif" font-size="14.00">Layer7_FFN_Up</text>
<text text-anchor="middle" x="1479" y="-10268.58" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1479" y="-10253.58" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1479" y="-10238.58" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_residual_7&#45;&gt;ffn_up_7 -->
<g id="edge130" class="edge">
<title>attn_residual_7&#45;&gt;ffn_up_7</title>
<path fill="none" stroke="black" d="M1647.12,-10334.77C1619.85,-10323.58 1593.05,-10312.58 1569.14,-10302.77"/>
<polygon fill="black" stroke="black" points="1570.36,-10299.49 1559.78,-10298.93 1567.7,-10305.96 1570.36,-10299.49"/>
</g>
<!-- ffn_gate_7 -->
<g id="node99" class="node">
<title>ffn_gate_7</title>
<polygon fill="lightblue" stroke="lightblue" points="2022,-10298.78 1672,-10298.78 1672,-10230.78 2022,-10230.78 2022,-10298.78"/>
<text text-anchor="middle" x="1847" y="-10283.58" font-family="Times,serif" font-size="14.00">Layer7_FFN_Gate</text>
<text text-anchor="middle" x="1847" y="-10268.58" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1847" y="-10253.58" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1847" y="-10238.58" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- attn_residual_7&#45;&gt;ffn_gate_7 -->
<g id="edge131" class="edge">
<title>attn_residual_7&#45;&gt;ffn_gate_7</title>
<path fill="none" stroke="black" d="M1847,-10334.66C1847,-10325.9 1847,-10317.27 1847,-10309.23"/>
<polygon fill="black" stroke="black" points="1850.5,-10309.05 1847,-10299.05 1843.5,-10309.05 1850.5,-10309.05"/>
</g>
<!-- ffn_residual_7 -->
<g id="node102" class="node">
<title>ffn_residual_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2181.11,-9958.62 1584.39,-9958.62 1430.89,-9792.62 2027.61,-9792.62 2181.11,-9958.62"/>
<text text-anchor="middle" x="1806" y="-9901.92" font-family="Times,serif" font-size="14.00">Layer7_FFN_Residual</text>
<text text-anchor="middle" x="1806" y="-9886.92" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-9871.92" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-9856.92" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-9841.92" font-family="Times,serif" font-size="14.00">Device: 0&#45;7</text>
</g>
<!-- attn_residual_7&#45;&gt;ffn_residual_7 -->
<g id="edge136" class="edge">
<title>attn_residual_7&#45;&gt;ffn_residual_7</title>
<path fill="none" stroke="black" d="M2003.78,-10334.57C2014.46,-10323.84 2023.81,-10311.94 2031,-10298.78 2095.84,-10180.17 2100.95,-10110.3 2031,-9994.62 2024.67,-9984.15 2017.07,-9974.56 2008.55,-9965.79"/>
<polygon fill="black" stroke="black" points="2010.79,-9963.09 2001.19,-9958.62 2005.91,-9968.1 2010.79,-9963.09"/>
</g>
<!-- ffn_down_7 -->
<g id="node100" class="node">
<title>ffn_down_7</title>
<polygon fill="lightblue" stroke="lightblue" points="1947,-10194.78 1585,-10194.78 1585,-10126.78 1947,-10126.78 1947,-10194.78"/>
<text text-anchor="middle" x="1766" y="-10179.58" font-family="Times,serif" font-size="14.00">Layer7_FFN_Down</text>
<text text-anchor="middle" x="1766" y="-10164.58" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1766" y="-10149.58" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-10134.58" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (TP)</text>
</g>
<!-- ffn_up_7&#45;&gt;ffn_down_7 -->
<g id="edge132" class="edge">
<title>ffn_up_7&#45;&gt;ffn_down_7</title>
<path fill="none" stroke="black" d="M1572.18,-10230.67C1601.28,-10220.33 1633.53,-10208.86 1663.25,-10198.3"/>
<polygon fill="black" stroke="black" points="1664.55,-10201.56 1672.8,-10194.91 1662.2,-10194.96 1664.55,-10201.56"/>
</g>
<!-- ffn_gate_7&#45;&gt;ffn_down_7 -->
<g id="edge133" class="edge">
<title>ffn_gate_7&#45;&gt;ffn_down_7</title>
<path fill="none" stroke="black" d="M1820.7,-10230.67C1813.7,-10221.85 1806.05,-10212.21 1798.75,-10203.02"/>
<polygon fill="black" stroke="black" points="1801.4,-10200.74 1792.44,-10195.08 1795.92,-10205.09 1801.4,-10200.74"/>
</g>
<!-- ffn_allreduce_7 -->
<g id="node101" class="node">
<title>ffn_allreduce_7</title>
<ellipse fill="red" stroke="red" cx="1766" cy="-10042.7" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1766" y="-10061.5" font-family="Times,serif" font-size="14.00">Layer7_FFN_AllReduce</text>
<text text-anchor="middle" x="1766" y="-10046.5" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-10031.5" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1766" y="-10016.5" font-family="Times,serif" font-size="14.00">Device: 0&#45;7 (All&#45;Reduce)</text>
</g>
<!-- ffn_down_7&#45;&gt;ffn_allreduce_7 -->
<g id="edge134" class="edge">
<title>ffn_down_7&#45;&gt;ffn_allreduce_7</title>
<path fill="none" stroke="black" d="M1766,-10126.52C1766,-10118.53 1766,-10109.76 1766,-10101.02"/>
<polygon fill="black" stroke="black" points="1769.5,-10100.81 1766,-10090.81 1762.5,-10100.81 1769.5,-10100.81"/>
</g>
<!-- ffn_allreduce_7&#45;&gt;ffn_residual_7 -->
<g id="edge135" class="edge">
<title>ffn_allreduce_7&#45;&gt;ffn_residual_7</title>
<path fill="none" stroke="black" d="M1777.46,-9994.39C1779.42,-9986.3 1781.52,-9977.64 1783.66,-9968.83"/>
<polygon fill="black" stroke="black" points="1787.12,-9969.39 1786.07,-9958.85 1780.32,-9967.74 1787.12,-9969.39"/>
</g>
<!-- pipeline_comm_0 -->
<g id="node199" class="node">
<title>pipeline_comm_0</title>
<ellipse fill="lightgreen" stroke="lightgreen" cx="1806" cy="-9719.14" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="1806" y="-9730.44" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="1806" y="-9715.44" font-family="Times,serif" font-size="14.00">Transfer: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1806" y="-9700.44" font-family="Times,serif" font-size="14.00">Devices: 0&#45;7  8&#45;15</text>
</g>
<!-- ffn_residual_7&#45;&gt;pipeline_comm_0 -->
<g id="edge137" class="edge">
<title>ffn_residual_7&#45;&gt;pipeline_comm_0</title>
<path fill="none" stroke="black" d="M1806,-9792.4C1806,-9783.59 1806,-9774.86 1806,-9766.68"/>
<polygon fill="black" stroke="black" points="1809.5,-9766.65 1806,-9756.65 1802.5,-9766.65 1809.5,-9766.65"/>
</g>
<!-- mha_q_8 -->
<g id="node103" class="node">
<title>mha_q_8</title>
<polygon fill="lightblue" stroke="lightblue" points="1261.5,-9642.66 852.5,-9642.66 852.5,-9574.66 1261.5,-9574.66 1261.5,-9642.66"/>
<text text-anchor="middle" x="1057" y="-9627.46" font-family="Times,serif" font-size="14.00">Layer8_MHA_Q</text>
<text text-anchor="middle" x="1057" y="-9612.46" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1057" y="-9597.46" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1057" y="-9582.46" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_score_8 -->
<g id="node106" class="node">
<title>attn_score_8</title>
<polygon fill="lightblue" stroke="lightblue" points="2035,-9538.66 1607,-9538.66 1607,-9470.66 2035,-9470.66 2035,-9538.66"/>
<text text-anchor="middle" x="1821" y="-9523.46" font-family="Times,serif" font-size="14.00">Layer8_Attn_Score</text>
<text text-anchor="middle" x="1821" y="-9508.46" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1821" y="-9493.46" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1821" y="-9478.46" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- mha_q_8&#45;&gt;attn_score_8 -->
<g id="edge141" class="edge">
<title>mha_q_8&#45;&gt;attn_score_8</title>
<path fill="none" stroke="black" d="M1261.72,-9575.97C1264.83,-9575.53 1267.93,-9575.09 1271,-9574.66 1378,-9559.71 1496.93,-9544.6 1596.75,-9532.35"/>
<polygon fill="black" stroke="black" points="1597.46,-9535.78 1606.96,-9531.09 1596.61,-9528.84 1597.46,-9535.78"/>
</g>
<!-- mha_k_8 -->
<g id="node104" class="node">
<title>mha_k_8</title>
<polygon fill="lightblue" stroke="lightblue" points="2115.5,-9642.66 1706.5,-9642.66 1706.5,-9574.66 2115.5,-9574.66 2115.5,-9642.66"/>
<text text-anchor="middle" x="1911" y="-9627.46" font-family="Times,serif" font-size="14.00">Layer8_MHA_K</text>
<text text-anchor="middle" x="1911" y="-9612.46" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1911" y="-9597.46" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1911" y="-9582.46" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- mha_k_8&#45;&gt;attn_score_8 -->
<g id="edge142" class="edge">
<title>mha_k_8&#45;&gt;attn_score_8</title>
<path fill="none" stroke="black" d="M1881.78,-9574.55C1873.92,-9565.64 1865.33,-9555.9 1857.14,-9546.62"/>
<polygon fill="black" stroke="black" points="1859.62,-9544.15 1850.38,-9538.96 1854.37,-9548.78 1859.62,-9544.15"/>
</g>
<!-- mha_v_8 -->
<g id="node105" class="node">
<title>mha_v_8</title>
<polygon fill="lightblue" stroke="lightblue" points="1688.5,-9642.66 1279.5,-9642.66 1279.5,-9574.66 1688.5,-9574.66 1688.5,-9642.66"/>
<text text-anchor="middle" x="1484" y="-9627.46" font-family="Times,serif" font-size="14.00">Layer8_MHA_V</text>
<text text-anchor="middle" x="1484" y="-9612.46" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1484" y="-9597.46" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1484" y="-9582.46" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_out_8 -->
<g id="node107" class="node">
<title>attn_out_8</title>
<polygon fill="lightblue" stroke="lightblue" points="2019.5,-9434.66 1622.5,-9434.66 1622.5,-9366.66 2019.5,-9366.66 2019.5,-9434.66"/>
<text text-anchor="middle" x="1821" y="-9419.46" font-family="Times,serif" font-size="14.00">Layer8_Attn_Out</text>
<text text-anchor="middle" x="1821" y="-9404.46" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1821" y="-9389.46" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1821" y="-9374.46" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_score_8&#45;&gt;attn_out_8 -->
<g id="edge144" class="edge">
<title>attn_score_8&#45;&gt;attn_out_8</title>
<path fill="none" stroke="black" d="M1821,-9470.55C1821,-9462.44 1821,-9453.65 1821,-9445.14"/>
<polygon fill="black" stroke="black" points="1824.5,-9444.96 1821,-9434.96 1817.5,-9444.96 1824.5,-9444.96"/>
</g>
<!-- attn_allreduce_8 -->
<g id="node108" class="node">
<title>attn_allreduce_8</title>
<ellipse fill="red" stroke="red" cx="1801" cy="-9282.58" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1801" y="-9301.38" font-family="Times,serif" font-size="14.00">Layer8_Attn_AllReduce</text>
<text text-anchor="middle" x="1801" y="-9286.38" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1801" y="-9271.38" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1801" y="-9256.38" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (All&#45;Reduce)</text>
</g>
<!-- attn_out_8&#45;&gt;attn_allreduce_8 -->
<g id="edge145" class="edge">
<title>attn_out_8&#45;&gt;attn_allreduce_8</title>
<path fill="none" stroke="black" d="M1815.27,-9366.4C1813.88,-9358.32 1812.35,-9349.45 1810.83,-9340.61"/>
<polygon fill="black" stroke="black" points="1814.26,-9339.95 1809.12,-9330.69 1807.37,-9341.14 1814.26,-9339.95"/>
</g>
<!-- attn_residual_8 -->
<g id="node109" class="node">
<title>attn_residual_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2116.11,-9198.5 1519.39,-9198.5 1365.89,-9032.5 1962.61,-9032.5 2116.11,-9198.5"/>
<text text-anchor="middle" x="1741" y="-9141.8" font-family="Times,serif" font-size="14.00">Layer8_Attn_Residual</text>
<text text-anchor="middle" x="1741" y="-9126.8" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-9111.8" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-9096.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-9081.8" font-family="Times,serif" font-size="14.00">Device: 8&#45;15</text>
</g>
<!-- attn_allreduce_8&#45;&gt;attn_residual_8 -->
<g id="edge146" class="edge">
<title>attn_allreduce_8&#45;&gt;attn_residual_8</title>
<path fill="none" stroke="black" d="M1783.81,-9234.27C1780.8,-9226 1777.58,-9217.15 1774.31,-9208.15"/>
<polygon fill="black" stroke="black" points="1777.59,-9206.93 1770.89,-9198.73 1771.01,-9209.32 1777.59,-9206.93"/>
</g>
<!-- ffn_up_8 -->
<g id="node110" class="node">
<title>ffn_up_8</title>
<polygon fill="lightblue" stroke="lightblue" points="1548,-8996.5 1198,-8996.5 1198,-8928.5 1548,-8928.5 1548,-8996.5"/>
<text text-anchor="middle" x="1373" y="-8981.3" font-family="Times,serif" font-size="14.00">Layer8_FFN_Up</text>
<text text-anchor="middle" x="1373" y="-8966.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1373" y="-8951.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1373" y="-8936.3" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_residual_8&#45;&gt;ffn_up_8 -->
<g id="edge148" class="edge">
<title>attn_residual_8&#45;&gt;ffn_up_8</title>
<path fill="none" stroke="black" d="M1541.12,-9032.48C1513.85,-9021.29 1487.05,-9010.3 1463.14,-9000.49"/>
<polygon fill="black" stroke="black" points="1464.36,-8997.2 1453.78,-8996.64 1461.7,-9003.68 1464.36,-8997.2"/>
</g>
<!-- ffn_gate_8 -->
<g id="node111" class="node">
<title>ffn_gate_8</title>
<polygon fill="lightblue" stroke="lightblue" points="1916,-8996.5 1566,-8996.5 1566,-8928.5 1916,-8928.5 1916,-8996.5"/>
<text text-anchor="middle" x="1741" y="-8981.3" font-family="Times,serif" font-size="14.00">Layer8_FFN_Gate</text>
<text text-anchor="middle" x="1741" y="-8966.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-8951.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1741" y="-8936.3" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_residual_8&#45;&gt;ffn_gate_8 -->
<g id="edge149" class="edge">
<title>attn_residual_8&#45;&gt;ffn_gate_8</title>
<path fill="none" stroke="black" d="M1741,-9032.37C1741,-9023.62 1741,-9014.98 1741,-9006.94"/>
<polygon fill="black" stroke="black" points="1744.5,-9006.76 1741,-8996.76 1737.5,-9006.76 1744.5,-9006.76"/>
</g>
<!-- ffn_residual_8 -->
<g id="node114" class="node">
<title>ffn_residual_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2075.11,-8656.33 1478.39,-8656.33 1324.89,-8490.33 1921.61,-8490.33 2075.11,-8656.33"/>
<text text-anchor="middle" x="1700" y="-8599.63" font-family="Times,serif" font-size="14.00">Layer8_FFN_Residual</text>
<text text-anchor="middle" x="1700" y="-8584.63" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-8569.63" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-8554.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-8539.63" font-family="Times,serif" font-size="14.00">Device: 8&#45;15</text>
</g>
<!-- attn_residual_8&#45;&gt;ffn_residual_8 -->
<g id="edge154" class="edge">
<title>attn_residual_8&#45;&gt;ffn_residual_8</title>
<path fill="none" stroke="black" d="M1897.78,-9032.28C1908.46,-9021.55 1917.81,-9009.65 1925,-8996.5 1989.84,-8877.88 1994.95,-8808.01 1925,-8692.33 1918.67,-8681.86 1911.07,-8672.28 1902.55,-8663.51"/>
<polygon fill="black" stroke="black" points="1904.79,-8660.8 1895.19,-8656.33 1899.91,-8665.82 1904.79,-8660.8"/>
</g>
<!-- ffn_down_8 -->
<g id="node112" class="node">
<title>ffn_down_8</title>
<polygon fill="lightblue" stroke="lightblue" points="1841,-8892.5 1479,-8892.5 1479,-8824.5 1841,-8824.5 1841,-8892.5"/>
<text text-anchor="middle" x="1660" y="-8877.3" font-family="Times,serif" font-size="14.00">Layer8_FFN_Down</text>
<text text-anchor="middle" x="1660" y="-8862.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1660" y="-8847.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-8832.3" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_up_8&#45;&gt;ffn_down_8 -->
<g id="edge150" class="edge">
<title>ffn_up_8&#45;&gt;ffn_down_8</title>
<path fill="none" stroke="black" d="M1466.18,-8928.38C1495.28,-8918.04 1527.53,-8906.58 1557.25,-8896.02"/>
<polygon fill="black" stroke="black" points="1558.55,-8899.27 1566.8,-8892.62 1556.2,-8892.67 1558.55,-8899.27"/>
</g>
<!-- ffn_gate_8&#45;&gt;ffn_down_8 -->
<g id="edge151" class="edge">
<title>ffn_gate_8&#45;&gt;ffn_down_8</title>
<path fill="none" stroke="black" d="M1714.7,-8928.38C1707.7,-8919.56 1700.05,-8909.93 1692.75,-8900.73"/>
<polygon fill="black" stroke="black" points="1695.4,-8898.45 1686.44,-8892.8 1689.92,-8902.8 1695.4,-8898.45"/>
</g>
<!-- ffn_allreduce_8 -->
<g id="node113" class="node">
<title>ffn_allreduce_8</title>
<ellipse fill="red" stroke="red" cx="1660" cy="-8740.41" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1660" y="-8759.21" font-family="Times,serif" font-size="14.00">Layer8_FFN_AllReduce</text>
<text text-anchor="middle" x="1660" y="-8744.21" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-8729.21" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-8714.21" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (All&#45;Reduce)</text>
</g>
<!-- ffn_down_8&#45;&gt;ffn_allreduce_8 -->
<g id="edge152" class="edge">
<title>ffn_down_8&#45;&gt;ffn_allreduce_8</title>
<path fill="none" stroke="black" d="M1660,-8824.23C1660,-8816.24 1660,-8807.47 1660,-8798.73"/>
<polygon fill="black" stroke="black" points="1663.5,-8798.52 1660,-8788.52 1656.5,-8798.52 1663.5,-8798.52"/>
</g>
<!-- ffn_allreduce_8&#45;&gt;ffn_residual_8 -->
<g id="edge153" class="edge">
<title>ffn_allreduce_8&#45;&gt;ffn_residual_8</title>
<path fill="none" stroke="black" d="M1671.46,-8692.11C1673.42,-8684.01 1675.52,-8675.35 1677.66,-8666.55"/>
<polygon fill="black" stroke="black" points="1681.12,-8667.11 1680.07,-8656.56 1674.32,-8665.46 1681.12,-8667.11"/>
</g>
<!-- mha_q_9 -->
<g id="node115" class="node">
<title>mha_q_9</title>
<polygon fill="lightblue" stroke="lightblue" points="1241.5,-8454.33 832.5,-8454.33 832.5,-8386.33 1241.5,-8386.33 1241.5,-8454.33"/>
<text text-anchor="middle" x="1037" y="-8439.13" font-family="Times,serif" font-size="14.00">Layer9_MHA_Q</text>
<text text-anchor="middle" x="1037" y="-8424.13" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1037" y="-8409.13" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1037" y="-8394.13" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_residual_8&#45;&gt;mha_q_9 -->
<g id="edge155" class="edge">
<title>ffn_residual_8&#45;&gt;mha_q_9</title>
<path fill="none" stroke="black" d="M1339.88,-8490.31C1287.9,-8478.47 1236.86,-8466.85 1191.94,-8456.62"/>
<polygon fill="black" stroke="black" points="1192.68,-8453.2 1182.15,-8454.39 1191.12,-8460.02 1192.68,-8453.2"/>
</g>
<!-- mha_k_9 -->
<g id="node116" class="node">
<title>mha_k_9</title>
<polygon fill="lightblue" stroke="lightblue" points="1668.5,-8454.33 1259.5,-8454.33 1259.5,-8386.33 1668.5,-8386.33 1668.5,-8454.33"/>
<text text-anchor="middle" x="1464" y="-8439.13" font-family="Times,serif" font-size="14.00">Layer9_MHA_K</text>
<text text-anchor="middle" x="1464" y="-8424.13" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1464" y="-8409.13" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1464" y="-8394.13" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_residual_8&#45;&gt;mha_k_9 -->
<g id="edge156" class="edge">
<title>ffn_residual_8&#45;&gt;mha_k_9</title>
<path fill="none" stroke="black" d="M1571.64,-8490.2C1555.1,-8479.62 1538.84,-8469.21 1524.16,-8459.82"/>
<polygon fill="black" stroke="black" points="1526.02,-8456.86 1515.71,-8454.42 1522.25,-8462.75 1526.02,-8456.86"/>
</g>
<!-- mha_v_9 -->
<g id="node117" class="node">
<title>mha_v_9</title>
<polygon fill="lightblue" stroke="lightblue" points="2095.5,-8454.33 1686.5,-8454.33 1686.5,-8386.33 2095.5,-8386.33 2095.5,-8454.33"/>
<text text-anchor="middle" x="1891" y="-8439.13" font-family="Times,serif" font-size="14.00">Layer9_MHA_V</text>
<text text-anchor="middle" x="1891" y="-8424.13" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1891" y="-8409.13" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1891" y="-8394.13" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_residual_8&#45;&gt;mha_v_9 -->
<g id="edge157" class="edge">
<title>ffn_residual_8&#45;&gt;mha_v_9</title>
<path fill="none" stroke="black" d="M1803.88,-8490.2C1816.7,-8480.07 1829.31,-8470.1 1840.79,-8461.03"/>
<polygon fill="black" stroke="black" points="1843.25,-8463.54 1848.93,-8454.59 1838.91,-8458.05 1843.25,-8463.54"/>
</g>
<!-- attn_residual_9 -->
<g id="node121" class="node">
<title>attn_residual_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2116.11,-8010.16 1519.39,-8010.16 1365.89,-7844.16 1962.61,-7844.16 2116.11,-8010.16"/>
<text text-anchor="middle" x="1741" y="-7953.46" font-family="Times,serif" font-size="14.00">Layer9_Attn_Residual</text>
<text text-anchor="middle" x="1741" y="-7938.46" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-7923.46" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-7908.46" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-7893.46" font-family="Times,serif" font-size="14.00">Device: 8&#45;15</text>
</g>
<!-- ffn_residual_8&#45;&gt;attn_residual_9 -->
<g id="edge164" class="edge">
<title>ffn_residual_8&#45;&gt;attn_residual_9</title>
<path fill="none" stroke="black" d="M1952.31,-8523.33C2021.23,-8504.79 2083.04,-8481.49 2105,-8454.33 2143.39,-8406.86 2115,-8378.38 2115,-8317.33 2115,-8317.33 2115,-8317.33 2115,-8211.33 2115,-8123.89 2049.22,-8059.99 1972.83,-8015.26"/>
<polygon fill="black" stroke="black" points="1974.37,-8012.11 1963.96,-8010.18 1970.89,-8018.19 1974.37,-8012.11"/>
</g>
<!-- attn_score_9 -->
<g id="node118" class="node">
<title>attn_score_9</title>
<polygon fill="lightblue" stroke="lightblue" points="1678,-8350.33 1250,-8350.33 1250,-8282.33 1678,-8282.33 1678,-8350.33"/>
<text text-anchor="middle" x="1464" y="-8335.13" font-family="Times,serif" font-size="14.00">Layer9_Attn_Score</text>
<text text-anchor="middle" x="1464" y="-8320.13" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1464" y="-8305.13" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1464" y="-8290.13" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- mha_q_9&#45;&gt;attn_score_9 -->
<g id="edge158" class="edge">
<title>mha_q_9&#45;&gt;attn_score_9</title>
<path fill="none" stroke="black" d="M1175.34,-8386.29C1220.16,-8375.58 1270.05,-8363.66 1315.57,-8352.79"/>
<polygon fill="black" stroke="black" points="1316.6,-8356.14 1325.51,-8350.41 1314.98,-8349.33 1316.6,-8356.14"/>
</g>
<!-- mha_k_9&#45;&gt;attn_score_9 -->
<g id="edge159" class="edge">
<title>mha_k_9&#45;&gt;attn_score_9</title>
<path fill="none" stroke="black" d="M1464,-8386.21C1464,-8378.11 1464,-8369.31 1464,-8360.8"/>
<polygon fill="black" stroke="black" points="1467.5,-8360.63 1464,-8350.63 1460.5,-8360.63 1467.5,-8360.63"/>
</g>
<!-- attn_out_9 -->
<g id="node119" class="node">
<title>attn_out_9</title>
<polygon fill="lightblue" stroke="lightblue" points="1939.5,-8246.33 1542.5,-8246.33 1542.5,-8178.33 1939.5,-8178.33 1939.5,-8246.33"/>
<text text-anchor="middle" x="1741" y="-8231.13" font-family="Times,serif" font-size="14.00">Layer9_Attn_Out</text>
<text text-anchor="middle" x="1741" y="-8216.13" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1741" y="-8201.13" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-8186.13" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_score_9&#45;&gt;attn_out_9 -->
<g id="edge161" class="edge">
<title>attn_score_9&#45;&gt;attn_out_9</title>
<path fill="none" stroke="black" d="M1553.93,-8282.21C1581.89,-8271.92 1612.88,-8260.51 1641.45,-8249.99"/>
<polygon fill="black" stroke="black" points="1642.87,-8253.2 1651.04,-8246.46 1640.45,-8246.63 1642.87,-8253.2"/>
</g>
<!-- attn_allreduce_9 -->
<g id="node120" class="node">
<title>attn_allreduce_9</title>
<ellipse fill="red" stroke="red" cx="1741" cy="-8094.25" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1741" y="-8113.05" font-family="Times,serif" font-size="14.00">Layer9_Attn_AllReduce</text>
<text text-anchor="middle" x="1741" y="-8098.05" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-8083.05" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-8068.05" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (All&#45;Reduce)</text>
</g>
<!-- attn_out_9&#45;&gt;attn_allreduce_9 -->
<g id="edge162" class="edge">
<title>attn_out_9&#45;&gt;attn_allreduce_9</title>
<path fill="none" stroke="black" d="M1741,-8178.07C1741,-8170.07 1741,-8161.31 1741,-8152.56"/>
<polygon fill="black" stroke="black" points="1744.5,-8152.36 1741,-8142.36 1737.5,-8152.36 1744.5,-8152.36"/>
</g>
<!-- attn_allreduce_9&#45;&gt;attn_residual_9 -->
<g id="edge163" class="edge">
<title>attn_allreduce_9&#45;&gt;attn_residual_9</title>
<path fill="none" stroke="black" d="M1741,-8045.94C1741,-8037.93 1741,-8029.37 1741,-8020.66"/>
<polygon fill="black" stroke="black" points="1744.5,-8020.4 1741,-8010.4 1737.5,-8020.4 1744.5,-8020.4"/>
</g>
<!-- ffn_up_9 -->
<g id="node122" class="node">
<title>ffn_up_9</title>
<polygon fill="lightblue" stroke="lightblue" points="1548,-7808.16 1198,-7808.16 1198,-7740.16 1548,-7740.16 1548,-7808.16"/>
<text text-anchor="middle" x="1373" y="-7792.96" font-family="Times,serif" font-size="14.00">Layer9_FFN_Up</text>
<text text-anchor="middle" x="1373" y="-7777.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1373" y="-7762.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1373" y="-7747.96" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_residual_9&#45;&gt;ffn_up_9 -->
<g id="edge165" class="edge">
<title>attn_residual_9&#45;&gt;ffn_up_9</title>
<path fill="none" stroke="black" d="M1541.12,-7844.15C1513.85,-7832.96 1487.05,-7821.96 1463.14,-7812.15"/>
<polygon fill="black" stroke="black" points="1464.36,-7808.87 1453.78,-7808.31 1461.7,-7815.34 1464.36,-7808.87"/>
</g>
<!-- ffn_gate_9 -->
<g id="node123" class="node">
<title>ffn_gate_9</title>
<polygon fill="lightblue" stroke="lightblue" points="1916,-7808.16 1566,-7808.16 1566,-7740.16 1916,-7740.16 1916,-7808.16"/>
<text text-anchor="middle" x="1741" y="-7792.96" font-family="Times,serif" font-size="14.00">Layer9_FFN_Gate</text>
<text text-anchor="middle" x="1741" y="-7777.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-7762.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1741" y="-7747.96" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_residual_9&#45;&gt;ffn_gate_9 -->
<g id="edge166" class="edge">
<title>attn_residual_9&#45;&gt;ffn_gate_9</title>
<path fill="none" stroke="black" d="M1741,-7844.04C1741,-7835.28 1741,-7826.65 1741,-7818.61"/>
<polygon fill="black" stroke="black" points="1744.5,-7818.43 1741,-7808.43 1737.5,-7818.43 1744.5,-7818.43"/>
</g>
<!-- ffn_residual_9 -->
<g id="node126" class="node">
<title>ffn_residual_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2075.11,-7468 1478.39,-7468 1324.89,-7302 1921.61,-7302 2075.11,-7468"/>
<text text-anchor="middle" x="1700" y="-7411.3" font-family="Times,serif" font-size="14.00">Layer9_FFN_Residual</text>
<text text-anchor="middle" x="1700" y="-7396.3" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-7381.3" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-7366.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-7351.3" font-family="Times,serif" font-size="14.00">Device: 8&#45;15</text>
</g>
<!-- attn_residual_9&#45;&gt;ffn_residual_9 -->
<g id="edge171" class="edge">
<title>attn_residual_9&#45;&gt;ffn_residual_9</title>
<path fill="none" stroke="black" d="M1897.78,-7843.95C1908.46,-7833.22 1917.81,-7821.32 1925,-7808.16 1989.84,-7689.55 1994.95,-7619.68 1925,-7504 1918.67,-7493.53 1911.07,-7483.95 1902.55,-7475.18"/>
<polygon fill="black" stroke="black" points="1904.79,-7472.47 1895.19,-7468 1899.91,-7477.48 1904.79,-7472.47"/>
</g>
<!-- ffn_down_9 -->
<g id="node124" class="node">
<title>ffn_down_9</title>
<polygon fill="lightblue" stroke="lightblue" points="1841,-7704.16 1479,-7704.16 1479,-7636.16 1841,-7636.16 1841,-7704.16"/>
<text text-anchor="middle" x="1660" y="-7688.96" font-family="Times,serif" font-size="14.00">Layer9_FFN_Down</text>
<text text-anchor="middle" x="1660" y="-7673.96" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1660" y="-7658.96" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-7643.96" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_up_9&#45;&gt;ffn_down_9 -->
<g id="edge167" class="edge">
<title>ffn_up_9&#45;&gt;ffn_down_9</title>
<path fill="none" stroke="black" d="M1466.18,-7740.05C1495.28,-7729.71 1527.53,-7718.24 1557.25,-7707.68"/>
<polygon fill="black" stroke="black" points="1558.55,-7710.94 1566.8,-7704.29 1556.2,-7704.34 1558.55,-7710.94"/>
</g>
<!-- ffn_gate_9&#45;&gt;ffn_down_9 -->
<g id="edge168" class="edge">
<title>ffn_gate_9&#45;&gt;ffn_down_9</title>
<path fill="none" stroke="black" d="M1714.7,-7740.05C1707.7,-7731.23 1700.05,-7721.59 1692.75,-7712.4"/>
<polygon fill="black" stroke="black" points="1695.4,-7710.12 1686.44,-7704.46 1689.92,-7714.47 1695.4,-7710.12"/>
</g>
<!-- ffn_allreduce_9 -->
<g id="node125" class="node">
<title>ffn_allreduce_9</title>
<ellipse fill="red" stroke="red" cx="1660" cy="-7552.08" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1660" y="-7570.88" font-family="Times,serif" font-size="14.00">Layer9_FFN_AllReduce</text>
<text text-anchor="middle" x="1660" y="-7555.88" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-7540.88" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-7525.88" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (All&#45;Reduce)</text>
</g>
<!-- ffn_down_9&#45;&gt;ffn_allreduce_9 -->
<g id="edge169" class="edge">
<title>ffn_down_9&#45;&gt;ffn_allreduce_9</title>
<path fill="none" stroke="black" d="M1660,-7635.9C1660,-7627.91 1660,-7619.14 1660,-7610.4"/>
<polygon fill="black" stroke="black" points="1663.5,-7610.19 1660,-7600.19 1656.5,-7610.19 1663.5,-7610.19"/>
</g>
<!-- ffn_allreduce_9&#45;&gt;ffn_residual_9 -->
<g id="edge170" class="edge">
<title>ffn_allreduce_9&#45;&gt;ffn_residual_9</title>
<path fill="none" stroke="black" d="M1671.46,-7503.78C1673.42,-7495.68 1675.52,-7487.02 1677.66,-7478.21"/>
<polygon fill="black" stroke="black" points="1681.12,-7478.77 1680.07,-7468.23 1674.32,-7477.13 1681.12,-7478.77"/>
</g>
<!-- mha_q_10 -->
<g id="node127" class="node">
<title>mha_q_10</title>
<polygon fill="lightblue" stroke="lightblue" points="1241.5,-7266 832.5,-7266 832.5,-7198 1241.5,-7198 1241.5,-7266"/>
<text text-anchor="middle" x="1037" y="-7250.8" font-family="Times,serif" font-size="14.00">Layer10_MHA_Q</text>
<text text-anchor="middle" x="1037" y="-7235.8" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1037" y="-7220.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1037" y="-7205.8" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_residual_9&#45;&gt;mha_q_10 -->
<g id="edge172" class="edge">
<title>ffn_residual_9&#45;&gt;mha_q_10</title>
<path fill="none" stroke="black" d="M1339.88,-7301.98C1287.9,-7290.14 1236.86,-7278.52 1191.94,-7268.29"/>
<polygon fill="black" stroke="black" points="1192.68,-7264.86 1182.15,-7266.06 1191.12,-7271.69 1192.68,-7264.86"/>
</g>
<!-- mha_k_10 -->
<g id="node128" class="node">
<title>mha_k_10</title>
<polygon fill="lightblue" stroke="lightblue" points="1668.5,-7266 1259.5,-7266 1259.5,-7198 1668.5,-7198 1668.5,-7266"/>
<text text-anchor="middle" x="1464" y="-7250.8" font-family="Times,serif" font-size="14.00">Layer10_MHA_K</text>
<text text-anchor="middle" x="1464" y="-7235.8" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1464" y="-7220.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1464" y="-7205.8" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_residual_9&#45;&gt;mha_k_10 -->
<g id="edge173" class="edge">
<title>ffn_residual_9&#45;&gt;mha_k_10</title>
<path fill="none" stroke="black" d="M1571.64,-7301.87C1555.1,-7291.29 1538.84,-7280.88 1524.16,-7271.49"/>
<polygon fill="black" stroke="black" points="1526.02,-7268.53 1515.71,-7266.08 1522.25,-7274.42 1526.02,-7268.53"/>
</g>
<!-- mha_v_10 -->
<g id="node129" class="node">
<title>mha_v_10</title>
<polygon fill="lightblue" stroke="lightblue" points="2095.5,-7266 1686.5,-7266 1686.5,-7198 2095.5,-7198 2095.5,-7266"/>
<text text-anchor="middle" x="1891" y="-7250.8" font-family="Times,serif" font-size="14.00">Layer10_MHA_V</text>
<text text-anchor="middle" x="1891" y="-7235.8" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1891" y="-7220.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1891" y="-7205.8" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_residual_9&#45;&gt;mha_v_10 -->
<g id="edge174" class="edge">
<title>ffn_residual_9&#45;&gt;mha_v_10</title>
<path fill="none" stroke="black" d="M1803.88,-7301.87C1816.7,-7291.74 1829.31,-7281.77 1840.79,-7272.7"/>
<polygon fill="black" stroke="black" points="1843.25,-7275.21 1848.93,-7266.26 1838.91,-7269.72 1843.25,-7275.21"/>
</g>
<!-- attn_residual_10 -->
<g id="node133" class="node">
<title>attn_residual_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2116.11,-6821.83 1519.39,-6821.83 1365.89,-6655.83 1962.61,-6655.83 2116.11,-6821.83"/>
<text text-anchor="middle" x="1741" y="-6765.13" font-family="Times,serif" font-size="14.00">Layer10_Attn_Residual</text>
<text text-anchor="middle" x="1741" y="-6750.13" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-6735.13" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-6720.13" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-6705.13" font-family="Times,serif" font-size="14.00">Device: 8&#45;15</text>
</g>
<!-- ffn_residual_9&#45;&gt;attn_residual_10 -->
<g id="edge181" class="edge">
<title>ffn_residual_9&#45;&gt;attn_residual_10</title>
<path fill="none" stroke="black" d="M1952.31,-7335C2021.23,-7316.45 2083.04,-7293.15 2105,-7266 2143.39,-7218.53 2115,-7190.05 2115,-7129 2115,-7129 2115,-7129 2115,-7023 2115,-6935.56 2049.22,-6871.66 1972.83,-6826.93"/>
<polygon fill="black" stroke="black" points="1974.37,-6823.78 1963.96,-6821.84 1970.89,-6829.85 1974.37,-6823.78"/>
</g>
<!-- attn_score_10 -->
<g id="node130" class="node">
<title>attn_score_10</title>
<polygon fill="lightblue" stroke="lightblue" points="1678,-7162 1250,-7162 1250,-7094 1678,-7094 1678,-7162"/>
<text text-anchor="middle" x="1464" y="-7146.8" font-family="Times,serif" font-size="14.00">Layer10_Attn_Score</text>
<text text-anchor="middle" x="1464" y="-7131.8" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1464" y="-7116.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1464" y="-7101.8" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- mha_q_10&#45;&gt;attn_score_10 -->
<g id="edge175" class="edge">
<title>mha_q_10&#45;&gt;attn_score_10</title>
<path fill="none" stroke="black" d="M1175.34,-7197.95C1220.16,-7187.25 1270.05,-7175.33 1315.57,-7164.45"/>
<polygon fill="black" stroke="black" points="1316.6,-7167.81 1325.51,-7162.08 1314.98,-7161 1316.6,-7167.81"/>
</g>
<!-- mha_k_10&#45;&gt;attn_score_10 -->
<g id="edge176" class="edge">
<title>mha_k_10&#45;&gt;attn_score_10</title>
<path fill="none" stroke="black" d="M1464,-7197.88C1464,-7189.78 1464,-7180.98 1464,-7172.47"/>
<polygon fill="black" stroke="black" points="1467.5,-7172.3 1464,-7162.3 1460.5,-7172.3 1467.5,-7172.3"/>
</g>
<!-- attn_out_10 -->
<g id="node131" class="node">
<title>attn_out_10</title>
<polygon fill="lightblue" stroke="lightblue" points="1939.5,-7058 1542.5,-7058 1542.5,-6990 1939.5,-6990 1939.5,-7058"/>
<text text-anchor="middle" x="1741" y="-7042.8" font-family="Times,serif" font-size="14.00">Layer10_Attn_Out</text>
<text text-anchor="middle" x="1741" y="-7027.8" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1741" y="-7012.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-6997.8" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_score_10&#45;&gt;attn_out_10 -->
<g id="edge178" class="edge">
<title>attn_score_10&#45;&gt;attn_out_10</title>
<path fill="none" stroke="black" d="M1553.93,-7093.88C1581.89,-7083.59 1612.88,-7072.18 1641.45,-7061.65"/>
<polygon fill="black" stroke="black" points="1642.87,-7064.86 1651.04,-7058.12 1640.45,-7058.29 1642.87,-7064.86"/>
</g>
<!-- attn_allreduce_10 -->
<g id="node132" class="node">
<title>attn_allreduce_10</title>
<ellipse fill="red" stroke="red" cx="1741" cy="-6905.92" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1741" y="-6924.72" font-family="Times,serif" font-size="14.00">Layer10_Attn_AllReduce</text>
<text text-anchor="middle" x="1741" y="-6909.72" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-6894.72" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-6879.72" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (All&#45;Reduce)</text>
</g>
<!-- attn_out_10&#45;&gt;attn_allreduce_10 -->
<g id="edge179" class="edge">
<title>attn_out_10&#45;&gt;attn_allreduce_10</title>
<path fill="none" stroke="black" d="M1741,-6989.73C1741,-6981.74 1741,-6972.97 1741,-6964.23"/>
<polygon fill="black" stroke="black" points="1744.5,-6964.02 1741,-6954.02 1737.5,-6964.02 1744.5,-6964.02"/>
</g>
<!-- attn_allreduce_10&#45;&gt;attn_residual_10 -->
<g id="edge180" class="edge">
<title>attn_allreduce_10&#45;&gt;attn_residual_10</title>
<path fill="none" stroke="black" d="M1741,-6857.61C1741,-6849.6 1741,-6841.04 1741,-6832.33"/>
<polygon fill="black" stroke="black" points="1744.5,-6832.06 1741,-6822.06 1737.5,-6832.06 1744.5,-6832.06"/>
</g>
<!-- ffn_up_10 -->
<g id="node134" class="node">
<title>ffn_up_10</title>
<polygon fill="lightblue" stroke="lightblue" points="1548,-6619.83 1198,-6619.83 1198,-6551.83 1548,-6551.83 1548,-6619.83"/>
<text text-anchor="middle" x="1373" y="-6604.63" font-family="Times,serif" font-size="14.00">Layer10_FFN_Up</text>
<text text-anchor="middle" x="1373" y="-6589.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1373" y="-6574.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1373" y="-6559.63" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_residual_10&#45;&gt;ffn_up_10 -->
<g id="edge182" class="edge">
<title>attn_residual_10&#45;&gt;ffn_up_10</title>
<path fill="none" stroke="black" d="M1541.12,-6655.81C1513.85,-6644.63 1487.05,-6633.63 1463.14,-6623.82"/>
<polygon fill="black" stroke="black" points="1464.36,-6620.54 1453.78,-6619.98 1461.7,-6627.01 1464.36,-6620.54"/>
</g>
<!-- ffn_gate_10 -->
<g id="node135" class="node">
<title>ffn_gate_10</title>
<polygon fill="lightblue" stroke="lightblue" points="1916,-6619.83 1566,-6619.83 1566,-6551.83 1916,-6551.83 1916,-6619.83"/>
<text text-anchor="middle" x="1741" y="-6604.63" font-family="Times,serif" font-size="14.00">Layer10_FFN_Gate</text>
<text text-anchor="middle" x="1741" y="-6589.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-6574.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1741" y="-6559.63" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_residual_10&#45;&gt;ffn_gate_10 -->
<g id="edge183" class="edge">
<title>attn_residual_10&#45;&gt;ffn_gate_10</title>
<path fill="none" stroke="black" d="M1741,-6655.7C1741,-6646.95 1741,-6638.32 1741,-6630.28"/>
<polygon fill="black" stroke="black" points="1744.5,-6630.09 1741,-6620.09 1737.5,-6630.09 1744.5,-6630.09"/>
</g>
<!-- ffn_residual_10 -->
<g id="node138" class="node">
<title>ffn_residual_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2075.11,-6279.67 1478.39,-6279.67 1324.89,-6113.67 1921.61,-6113.67 2075.11,-6279.67"/>
<text text-anchor="middle" x="1700" y="-6222.97" font-family="Times,serif" font-size="14.00">Layer10_FFN_Residual</text>
<text text-anchor="middle" x="1700" y="-6207.97" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-6192.97" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-6177.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-6162.97" font-family="Times,serif" font-size="14.00">Device: 8&#45;15</text>
</g>
<!-- attn_residual_10&#45;&gt;ffn_residual_10 -->
<g id="edge188" class="edge">
<title>attn_residual_10&#45;&gt;ffn_residual_10</title>
<path fill="none" stroke="black" d="M1897.78,-6655.61C1908.46,-6644.89 1917.81,-6632.98 1925,-6619.83 1989.84,-6501.21 1994.95,-6431.34 1925,-6315.67 1918.67,-6305.2 1911.07,-6295.61 1902.55,-6286.84"/>
<polygon fill="black" stroke="black" points="1904.79,-6284.14 1895.19,-6279.67 1899.91,-6289.15 1904.79,-6284.14"/>
</g>
<!-- ffn_down_10 -->
<g id="node136" class="node">
<title>ffn_down_10</title>
<polygon fill="lightblue" stroke="lightblue" points="1841,-6515.83 1479,-6515.83 1479,-6447.83 1841,-6447.83 1841,-6515.83"/>
<text text-anchor="middle" x="1660" y="-6500.63" font-family="Times,serif" font-size="14.00">Layer10_FFN_Down</text>
<text text-anchor="middle" x="1660" y="-6485.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1660" y="-6470.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-6455.63" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_up_10&#45;&gt;ffn_down_10 -->
<g id="edge184" class="edge">
<title>ffn_up_10&#45;&gt;ffn_down_10</title>
<path fill="none" stroke="black" d="M1466.18,-6551.72C1495.28,-6541.37 1527.53,-6529.91 1557.25,-6519.35"/>
<polygon fill="black" stroke="black" points="1558.55,-6522.6 1566.8,-6515.96 1556.2,-6516.01 1558.55,-6522.6"/>
</g>
<!-- ffn_gate_10&#45;&gt;ffn_down_10 -->
<g id="edge185" class="edge">
<title>ffn_gate_10&#45;&gt;ffn_down_10</title>
<path fill="none" stroke="black" d="M1714.7,-6551.72C1707.7,-6542.9 1700.05,-6533.26 1692.75,-6524.07"/>
<polygon fill="black" stroke="black" points="1695.4,-6521.79 1686.44,-6516.13 1689.92,-6526.14 1695.4,-6521.79"/>
</g>
<!-- ffn_allreduce_10 -->
<g id="node137" class="node">
<title>ffn_allreduce_10</title>
<ellipse fill="red" stroke="red" cx="1660" cy="-6363.75" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1660" y="-6382.55" font-family="Times,serif" font-size="14.00">Layer10_FFN_AllReduce</text>
<text text-anchor="middle" x="1660" y="-6367.55" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-6352.55" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-6337.55" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (All&#45;Reduce)</text>
</g>
<!-- ffn_down_10&#45;&gt;ffn_allreduce_10 -->
<g id="edge186" class="edge">
<title>ffn_down_10&#45;&gt;ffn_allreduce_10</title>
<path fill="none" stroke="black" d="M1660,-6447.57C1660,-6439.57 1660,-6430.81 1660,-6422.06"/>
<polygon fill="black" stroke="black" points="1663.5,-6421.86 1660,-6411.86 1656.5,-6421.86 1663.5,-6421.86"/>
</g>
<!-- ffn_allreduce_10&#45;&gt;ffn_residual_10 -->
<g id="edge187" class="edge">
<title>ffn_allreduce_10&#45;&gt;ffn_residual_10</title>
<path fill="none" stroke="black" d="M1671.46,-6315.44C1673.42,-6307.34 1675.52,-6298.69 1677.66,-6289.88"/>
<polygon fill="black" stroke="black" points="1681.12,-6290.44 1680.07,-6279.9 1674.32,-6288.79 1681.12,-6290.44"/>
</g>
<!-- mha_q_11 -->
<g id="node139" class="node">
<title>mha_q_11</title>
<polygon fill="lightblue" stroke="lightblue" points="1241.5,-6077.67 832.5,-6077.67 832.5,-6009.67 1241.5,-6009.67 1241.5,-6077.67"/>
<text text-anchor="middle" x="1037" y="-6062.47" font-family="Times,serif" font-size="14.00">Layer11_MHA_Q</text>
<text text-anchor="middle" x="1037" y="-6047.47" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1037" y="-6032.47" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1037" y="-6017.47" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_residual_10&#45;&gt;mha_q_11 -->
<g id="edge189" class="edge">
<title>ffn_residual_10&#45;&gt;mha_q_11</title>
<path fill="none" stroke="black" d="M1339.88,-6113.65C1287.9,-6101.81 1236.86,-6090.18 1191.94,-6079.95"/>
<polygon fill="black" stroke="black" points="1192.68,-6076.53 1182.15,-6077.72 1191.12,-6083.36 1192.68,-6076.53"/>
</g>
<!-- mha_k_11 -->
<g id="node140" class="node">
<title>mha_k_11</title>
<polygon fill="lightblue" stroke="lightblue" points="1668.5,-6077.67 1259.5,-6077.67 1259.5,-6009.67 1668.5,-6009.67 1668.5,-6077.67"/>
<text text-anchor="middle" x="1464" y="-6062.47" font-family="Times,serif" font-size="14.00">Layer11_MHA_K</text>
<text text-anchor="middle" x="1464" y="-6047.47" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1464" y="-6032.47" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1464" y="-6017.47" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_residual_10&#45;&gt;mha_k_11 -->
<g id="edge190" class="edge">
<title>ffn_residual_10&#45;&gt;mha_k_11</title>
<path fill="none" stroke="black" d="M1571.64,-6113.54C1555.1,-6102.96 1538.84,-6092.55 1524.16,-6083.16"/>
<polygon fill="black" stroke="black" points="1526.02,-6080.19 1515.71,-6077.75 1522.25,-6086.09 1526.02,-6080.19"/>
</g>
<!-- mha_v_11 -->
<g id="node141" class="node">
<title>mha_v_11</title>
<polygon fill="lightblue" stroke="lightblue" points="2095.5,-6077.67 1686.5,-6077.67 1686.5,-6009.67 2095.5,-6009.67 2095.5,-6077.67"/>
<text text-anchor="middle" x="1891" y="-6062.47" font-family="Times,serif" font-size="14.00">Layer11_MHA_V</text>
<text text-anchor="middle" x="1891" y="-6047.47" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1891" y="-6032.47" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1891" y="-6017.47" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_residual_10&#45;&gt;mha_v_11 -->
<g id="edge191" class="edge">
<title>ffn_residual_10&#45;&gt;mha_v_11</title>
<path fill="none" stroke="black" d="M1803.88,-6113.54C1816.7,-6103.41 1829.31,-6093.44 1840.79,-6084.36"/>
<polygon fill="black" stroke="black" points="1843.25,-6086.87 1848.93,-6077.93 1838.91,-6081.38 1843.25,-6086.87"/>
</g>
<!-- attn_residual_11 -->
<g id="node145" class="node">
<title>attn_residual_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2116.11,-5633.5 1519.39,-5633.5 1365.89,-5467.5 1962.61,-5467.5 2116.11,-5633.5"/>
<text text-anchor="middle" x="1741" y="-5576.8" font-family="Times,serif" font-size="14.00">Layer11_Attn_Residual</text>
<text text-anchor="middle" x="1741" y="-5561.8" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-5546.8" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-5531.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-5516.8" font-family="Times,serif" font-size="14.00">Device: 8&#45;15</text>
</g>
<!-- ffn_residual_10&#45;&gt;attn_residual_11 -->
<g id="edge198" class="edge">
<title>ffn_residual_10&#45;&gt;attn_residual_11</title>
<path fill="none" stroke="black" d="M1952.31,-6146.67C2021.23,-6128.12 2083.04,-6104.82 2105,-6077.67 2143.39,-6030.2 2115,-6001.72 2115,-5940.67 2115,-5940.67 2115,-5940.67 2115,-5834.67 2115,-5747.23 2049.22,-5683.33 1972.83,-5638.6"/>
<polygon fill="black" stroke="black" points="1974.37,-5635.45 1963.96,-5633.51 1970.89,-5641.52 1974.37,-5635.45"/>
</g>
<!-- attn_score_11 -->
<g id="node142" class="node">
<title>attn_score_11</title>
<polygon fill="lightblue" stroke="lightblue" points="1678,-5973.67 1250,-5973.67 1250,-5905.67 1678,-5905.67 1678,-5973.67"/>
<text text-anchor="middle" x="1464" y="-5958.47" font-family="Times,serif" font-size="14.00">Layer11_Attn_Score</text>
<text text-anchor="middle" x="1464" y="-5943.47" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1464" y="-5928.47" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1464" y="-5913.47" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- mha_q_11&#45;&gt;attn_score_11 -->
<g id="edge192" class="edge">
<title>mha_q_11&#45;&gt;attn_score_11</title>
<path fill="none" stroke="black" d="M1175.34,-6009.62C1220.16,-5998.91 1270.05,-5987 1315.57,-5976.12"/>
<polygon fill="black" stroke="black" points="1316.6,-5979.47 1325.51,-5973.75 1314.98,-5972.67 1316.6,-5979.47"/>
</g>
<!-- mha_k_11&#45;&gt;attn_score_11 -->
<g id="edge193" class="edge">
<title>mha_k_11&#45;&gt;attn_score_11</title>
<path fill="none" stroke="black" d="M1464,-6009.55C1464,-6001.44 1464,-5992.65 1464,-5984.14"/>
<polygon fill="black" stroke="black" points="1467.5,-5983.96 1464,-5973.96 1460.5,-5983.96 1467.5,-5983.96"/>
</g>
<!-- attn_out_11 -->
<g id="node143" class="node">
<title>attn_out_11</title>
<polygon fill="lightblue" stroke="lightblue" points="1939.5,-5869.67 1542.5,-5869.67 1542.5,-5801.67 1939.5,-5801.67 1939.5,-5869.67"/>
<text text-anchor="middle" x="1741" y="-5854.47" font-family="Times,serif" font-size="14.00">Layer11_Attn_Out</text>
<text text-anchor="middle" x="1741" y="-5839.47" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1741" y="-5824.47" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-5809.47" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_score_11&#45;&gt;attn_out_11 -->
<g id="edge195" class="edge">
<title>attn_score_11&#45;&gt;attn_out_11</title>
<path fill="none" stroke="black" d="M1553.93,-5905.55C1581.89,-5895.25 1612.88,-5883.84 1641.45,-5873.32"/>
<polygon fill="black" stroke="black" points="1642.87,-5876.53 1651.04,-5869.79 1640.45,-5869.96 1642.87,-5876.53"/>
</g>
<!-- attn_allreduce_11 -->
<g id="node144" class="node">
<title>attn_allreduce_11</title>
<ellipse fill="red" stroke="red" cx="1741" cy="-5717.58" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1741" y="-5736.38" font-family="Times,serif" font-size="14.00">Layer11_Attn_AllReduce</text>
<text text-anchor="middle" x="1741" y="-5721.38" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-5706.38" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-5691.38" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (All&#45;Reduce)</text>
</g>
<!-- attn_out_11&#45;&gt;attn_allreduce_11 -->
<g id="edge196" class="edge">
<title>attn_out_11&#45;&gt;attn_allreduce_11</title>
<path fill="none" stroke="black" d="M1741,-5801.4C1741,-5793.41 1741,-5784.64 1741,-5775.9"/>
<polygon fill="black" stroke="black" points="1744.5,-5775.69 1741,-5765.69 1737.5,-5775.69 1744.5,-5775.69"/>
</g>
<!-- attn_allreduce_11&#45;&gt;attn_residual_11 -->
<g id="edge197" class="edge">
<title>attn_allreduce_11&#45;&gt;attn_residual_11</title>
<path fill="none" stroke="black" d="M1741,-5669.28C1741,-5661.26 1741,-5652.71 1741,-5644"/>
<polygon fill="black" stroke="black" points="1744.5,-5643.73 1741,-5633.73 1737.5,-5643.73 1744.5,-5643.73"/>
</g>
<!-- ffn_up_11 -->
<g id="node146" class="node">
<title>ffn_up_11</title>
<polygon fill="lightblue" stroke="lightblue" points="1548,-5431.5 1198,-5431.5 1198,-5363.5 1548,-5363.5 1548,-5431.5"/>
<text text-anchor="middle" x="1373" y="-5416.3" font-family="Times,serif" font-size="14.00">Layer11_FFN_Up</text>
<text text-anchor="middle" x="1373" y="-5401.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1373" y="-5386.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1373" y="-5371.3" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_residual_11&#45;&gt;ffn_up_11 -->
<g id="edge199" class="edge">
<title>attn_residual_11&#45;&gt;ffn_up_11</title>
<path fill="none" stroke="black" d="M1541.12,-5467.48C1513.85,-5456.29 1487.05,-5445.3 1463.14,-5435.49"/>
<polygon fill="black" stroke="black" points="1464.36,-5432.2 1453.78,-5431.64 1461.7,-5438.68 1464.36,-5432.2"/>
</g>
<!-- ffn_gate_11 -->
<g id="node147" class="node">
<title>ffn_gate_11</title>
<polygon fill="lightblue" stroke="lightblue" points="1916,-5431.5 1566,-5431.5 1566,-5363.5 1916,-5363.5 1916,-5431.5"/>
<text text-anchor="middle" x="1741" y="-5416.3" font-family="Times,serif" font-size="14.00">Layer11_FFN_Gate</text>
<text text-anchor="middle" x="1741" y="-5401.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-5386.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1741" y="-5371.3" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_residual_11&#45;&gt;ffn_gate_11 -->
<g id="edge200" class="edge">
<title>attn_residual_11&#45;&gt;ffn_gate_11</title>
<path fill="none" stroke="black" d="M1741,-5467.37C1741,-5458.62 1741,-5449.98 1741,-5441.94"/>
<polygon fill="black" stroke="black" points="1744.5,-5441.76 1741,-5431.76 1737.5,-5441.76 1744.5,-5441.76"/>
</g>
<!-- ffn_residual_11 -->
<g id="node150" class="node">
<title>ffn_residual_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2075.11,-5091.33 1478.39,-5091.33 1324.89,-4925.33 1921.61,-4925.33 2075.11,-5091.33"/>
<text text-anchor="middle" x="1700" y="-5034.63" font-family="Times,serif" font-size="14.00">Layer11_FFN_Residual</text>
<text text-anchor="middle" x="1700" y="-5019.63" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-5004.63" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-4989.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-4974.63" font-family="Times,serif" font-size="14.00">Device: 8&#45;15</text>
</g>
<!-- attn_residual_11&#45;&gt;ffn_residual_11 -->
<g id="edge205" class="edge">
<title>attn_residual_11&#45;&gt;ffn_residual_11</title>
<path fill="none" stroke="black" d="M1897.78,-5467.28C1908.46,-5456.55 1917.81,-5444.65 1925,-5431.5 1989.84,-5312.88 1994.95,-5243.01 1925,-5127.33 1918.67,-5116.86 1911.07,-5107.28 1902.55,-5098.51"/>
<polygon fill="black" stroke="black" points="1904.79,-5095.8 1895.19,-5091.33 1899.91,-5100.82 1904.79,-5095.8"/>
</g>
<!-- ffn_down_11 -->
<g id="node148" class="node">
<title>ffn_down_11</title>
<polygon fill="lightblue" stroke="lightblue" points="1841,-5327.5 1479,-5327.5 1479,-5259.5 1841,-5259.5 1841,-5327.5"/>
<text text-anchor="middle" x="1660" y="-5312.3" font-family="Times,serif" font-size="14.00">Layer11_FFN_Down</text>
<text text-anchor="middle" x="1660" y="-5297.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1660" y="-5282.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-5267.3" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_up_11&#45;&gt;ffn_down_11 -->
<g id="edge201" class="edge">
<title>ffn_up_11&#45;&gt;ffn_down_11</title>
<path fill="none" stroke="black" d="M1466.18,-5363.38C1495.28,-5353.04 1527.53,-5341.58 1557.25,-5331.02"/>
<polygon fill="black" stroke="black" points="1558.55,-5334.27 1566.8,-5327.62 1556.2,-5327.67 1558.55,-5334.27"/>
</g>
<!-- ffn_gate_11&#45;&gt;ffn_down_11 -->
<g id="edge202" class="edge">
<title>ffn_gate_11&#45;&gt;ffn_down_11</title>
<path fill="none" stroke="black" d="M1714.7,-5363.38C1707.7,-5354.56 1700.05,-5344.93 1692.75,-5335.73"/>
<polygon fill="black" stroke="black" points="1695.4,-5333.45 1686.44,-5327.8 1689.92,-5337.81 1695.4,-5333.45"/>
</g>
<!-- ffn_allreduce_11 -->
<g id="node149" class="node">
<title>ffn_allreduce_11</title>
<ellipse fill="red" stroke="red" cx="1660" cy="-5175.42" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1660" y="-5194.22" font-family="Times,serif" font-size="14.00">Layer11_FFN_AllReduce</text>
<text text-anchor="middle" x="1660" y="-5179.22" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-5164.22" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-5149.22" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (All&#45;Reduce)</text>
</g>
<!-- ffn_down_11&#45;&gt;ffn_allreduce_11 -->
<g id="edge203" class="edge">
<title>ffn_down_11&#45;&gt;ffn_allreduce_11</title>
<path fill="none" stroke="black" d="M1660,-5259.23C1660,-5251.24 1660,-5242.47 1660,-5233.73"/>
<polygon fill="black" stroke="black" points="1663.5,-5233.53 1660,-5223.53 1656.5,-5233.53 1663.5,-5233.53"/>
</g>
<!-- ffn_allreduce_11&#45;&gt;ffn_residual_11 -->
<g id="edge204" class="edge">
<title>ffn_allreduce_11&#45;&gt;ffn_residual_11</title>
<path fill="none" stroke="black" d="M1671.46,-5127.11C1673.42,-5119.01 1675.52,-5110.35 1677.66,-5101.55"/>
<polygon fill="black" stroke="black" points="1681.12,-5102.11 1680.07,-5091.56 1674.32,-5100.46 1681.12,-5102.11"/>
</g>
<!-- mha_q_12 -->
<g id="node151" class="node">
<title>mha_q_12</title>
<polygon fill="lightblue" stroke="lightblue" points="1241.5,-4889.33 832.5,-4889.33 832.5,-4821.33 1241.5,-4821.33 1241.5,-4889.33"/>
<text text-anchor="middle" x="1037" y="-4874.13" font-family="Times,serif" font-size="14.00">Layer12_MHA_Q</text>
<text text-anchor="middle" x="1037" y="-4859.13" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1037" y="-4844.13" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1037" y="-4829.13" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_residual_11&#45;&gt;mha_q_12 -->
<g id="edge206" class="edge">
<title>ffn_residual_11&#45;&gt;mha_q_12</title>
<path fill="none" stroke="black" d="M1339.88,-4925.31C1287.9,-4913.48 1236.86,-4901.85 1191.94,-4891.62"/>
<polygon fill="black" stroke="black" points="1192.68,-4888.2 1182.15,-4889.39 1191.12,-4895.02 1192.68,-4888.2"/>
</g>
<!-- mha_k_12 -->
<g id="node152" class="node">
<title>mha_k_12</title>
<polygon fill="lightblue" stroke="lightblue" points="1668.5,-4889.33 1259.5,-4889.33 1259.5,-4821.33 1668.5,-4821.33 1668.5,-4889.33"/>
<text text-anchor="middle" x="1464" y="-4874.13" font-family="Times,serif" font-size="14.00">Layer12_MHA_K</text>
<text text-anchor="middle" x="1464" y="-4859.13" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1464" y="-4844.13" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1464" y="-4829.13" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_residual_11&#45;&gt;mha_k_12 -->
<g id="edge207" class="edge">
<title>ffn_residual_11&#45;&gt;mha_k_12</title>
<path fill="none" stroke="black" d="M1571.64,-4925.2C1555.1,-4914.62 1538.84,-4904.22 1524.16,-4894.82"/>
<polygon fill="black" stroke="black" points="1526.02,-4891.86 1515.71,-4889.42 1522.25,-4897.76 1526.02,-4891.86"/>
</g>
<!-- mha_v_12 -->
<g id="node153" class="node">
<title>mha_v_12</title>
<polygon fill="lightblue" stroke="lightblue" points="2095.5,-4889.33 1686.5,-4889.33 1686.5,-4821.33 2095.5,-4821.33 2095.5,-4889.33"/>
<text text-anchor="middle" x="1891" y="-4874.13" font-family="Times,serif" font-size="14.00">Layer12_MHA_V</text>
<text text-anchor="middle" x="1891" y="-4859.13" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1891" y="-4844.13" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1891" y="-4829.13" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_residual_11&#45;&gt;mha_v_12 -->
<g id="edge208" class="edge">
<title>ffn_residual_11&#45;&gt;mha_v_12</title>
<path fill="none" stroke="black" d="M1803.88,-4925.2C1816.7,-4915.07 1829.31,-4905.1 1840.79,-4896.03"/>
<polygon fill="black" stroke="black" points="1843.25,-4898.54 1848.93,-4889.59 1838.91,-4893.05 1843.25,-4898.54"/>
</g>
<!-- attn_residual_12 -->
<g id="node157" class="node">
<title>attn_residual_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2116.11,-4445.17 1519.39,-4445.17 1365.89,-4279.17 1962.61,-4279.17 2116.11,-4445.17"/>
<text text-anchor="middle" x="1741" y="-4388.47" font-family="Times,serif" font-size="14.00">Layer12_Attn_Residual</text>
<text text-anchor="middle" x="1741" y="-4373.47" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-4358.47" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-4343.47" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-4328.47" font-family="Times,serif" font-size="14.00">Device: 8&#45;15</text>
</g>
<!-- ffn_residual_11&#45;&gt;attn_residual_12 -->
<g id="edge215" class="edge">
<title>ffn_residual_11&#45;&gt;attn_residual_12</title>
<path fill="none" stroke="black" d="M1952.31,-4958.33C2021.23,-4939.79 2083.04,-4916.49 2105,-4889.33 2143.39,-4841.86 2115,-4813.38 2115,-4752.33 2115,-4752.33 2115,-4752.33 2115,-4646.33 2115,-4558.89 2049.22,-4494.99 1972.83,-4450.26"/>
<polygon fill="black" stroke="black" points="1974.37,-4447.11 1963.96,-4445.18 1970.89,-4453.19 1974.37,-4447.11"/>
</g>
<!-- attn_score_12 -->
<g id="node154" class="node">
<title>attn_score_12</title>
<polygon fill="lightblue" stroke="lightblue" points="1678,-4785.33 1250,-4785.33 1250,-4717.33 1678,-4717.33 1678,-4785.33"/>
<text text-anchor="middle" x="1464" y="-4770.13" font-family="Times,serif" font-size="14.00">Layer12_Attn_Score</text>
<text text-anchor="middle" x="1464" y="-4755.13" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1464" y="-4740.13" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1464" y="-4725.13" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- mha_q_12&#45;&gt;attn_score_12 -->
<g id="edge209" class="edge">
<title>mha_q_12&#45;&gt;attn_score_12</title>
<path fill="none" stroke="black" d="M1175.34,-4821.29C1220.16,-4810.58 1270.05,-4798.66 1315.57,-4787.79"/>
<polygon fill="black" stroke="black" points="1316.6,-4791.14 1325.51,-4785.41 1314.98,-4784.33 1316.6,-4791.14"/>
</g>
<!-- mha_k_12&#45;&gt;attn_score_12 -->
<g id="edge210" class="edge">
<title>mha_k_12&#45;&gt;attn_score_12</title>
<path fill="none" stroke="black" d="M1464,-4821.22C1464,-4813.11 1464,-4804.31 1464,-4795.8"/>
<polygon fill="black" stroke="black" points="1467.5,-4795.63 1464,-4785.63 1460.5,-4795.63 1467.5,-4795.63"/>
</g>
<!-- attn_out_12 -->
<g id="node155" class="node">
<title>attn_out_12</title>
<polygon fill="lightblue" stroke="lightblue" points="1939.5,-4681.33 1542.5,-4681.33 1542.5,-4613.33 1939.5,-4613.33 1939.5,-4681.33"/>
<text text-anchor="middle" x="1741" y="-4666.13" font-family="Times,serif" font-size="14.00">Layer12_Attn_Out</text>
<text text-anchor="middle" x="1741" y="-4651.13" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1741" y="-4636.13" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-4621.13" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_score_12&#45;&gt;attn_out_12 -->
<g id="edge212" class="edge">
<title>attn_score_12&#45;&gt;attn_out_12</title>
<path fill="none" stroke="black" d="M1553.93,-4717.22C1581.89,-4706.92 1612.88,-4695.51 1641.45,-4684.99"/>
<polygon fill="black" stroke="black" points="1642.87,-4688.2 1651.04,-4681.46 1640.45,-4681.63 1642.87,-4688.2"/>
</g>
<!-- attn_allreduce_12 -->
<g id="node156" class="node">
<title>attn_allreduce_12</title>
<ellipse fill="red" stroke="red" cx="1741" cy="-4529.25" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1741" y="-4548.05" font-family="Times,serif" font-size="14.00">Layer12_Attn_AllReduce</text>
<text text-anchor="middle" x="1741" y="-4533.05" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-4518.05" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-4503.05" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (All&#45;Reduce)</text>
</g>
<!-- attn_out_12&#45;&gt;attn_allreduce_12 -->
<g id="edge213" class="edge">
<title>attn_out_12&#45;&gt;attn_allreduce_12</title>
<path fill="none" stroke="black" d="M1741,-4613.07C1741,-4605.07 1741,-4596.31 1741,-4587.56"/>
<polygon fill="black" stroke="black" points="1744.5,-4587.36 1741,-4577.36 1737.5,-4587.36 1744.5,-4587.36"/>
</g>
<!-- attn_allreduce_12&#45;&gt;attn_residual_12 -->
<g id="edge214" class="edge">
<title>attn_allreduce_12&#45;&gt;attn_residual_12</title>
<path fill="none" stroke="black" d="M1741,-4480.94C1741,-4472.93 1741,-4464.37 1741,-4455.67"/>
<polygon fill="black" stroke="black" points="1744.5,-4455.4 1741,-4445.4 1737.5,-4455.4 1744.5,-4455.4"/>
</g>
<!-- ffn_up_12 -->
<g id="node158" class="node">
<title>ffn_up_12</title>
<polygon fill="lightblue" stroke="lightblue" points="1548,-4243.17 1198,-4243.17 1198,-4175.17 1548,-4175.17 1548,-4243.17"/>
<text text-anchor="middle" x="1373" y="-4227.97" font-family="Times,serif" font-size="14.00">Layer12_FFN_Up</text>
<text text-anchor="middle" x="1373" y="-4212.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1373" y="-4197.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1373" y="-4182.97" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_residual_12&#45;&gt;ffn_up_12 -->
<g id="edge216" class="edge">
<title>attn_residual_12&#45;&gt;ffn_up_12</title>
<path fill="none" stroke="black" d="M1541.12,-4279.15C1513.85,-4267.96 1487.05,-4256.96 1463.14,-4247.15"/>
<polygon fill="black" stroke="black" points="1464.36,-4243.87 1453.78,-4243.31 1461.7,-4250.35 1464.36,-4243.87"/>
</g>
<!-- ffn_gate_12 -->
<g id="node159" class="node">
<title>ffn_gate_12</title>
<polygon fill="lightblue" stroke="lightblue" points="1916,-4243.17 1566,-4243.17 1566,-4175.17 1916,-4175.17 1916,-4243.17"/>
<text text-anchor="middle" x="1741" y="-4227.97" font-family="Times,serif" font-size="14.00">Layer12_FFN_Gate</text>
<text text-anchor="middle" x="1741" y="-4212.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-4197.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1741" y="-4182.97" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_residual_12&#45;&gt;ffn_gate_12 -->
<g id="edge217" class="edge">
<title>attn_residual_12&#45;&gt;ffn_gate_12</title>
<path fill="none" stroke="black" d="M1741,-4279.04C1741,-4270.28 1741,-4261.65 1741,-4253.61"/>
<polygon fill="black" stroke="black" points="1744.5,-4253.43 1741,-4243.43 1737.5,-4253.43 1744.5,-4253.43"/>
</g>
<!-- ffn_residual_12 -->
<g id="node162" class="node">
<title>ffn_residual_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2075.11,-3903 1478.39,-3903 1324.89,-3737 1921.61,-3737 2075.11,-3903"/>
<text text-anchor="middle" x="1700" y="-3846.3" font-family="Times,serif" font-size="14.00">Layer12_FFN_Residual</text>
<text text-anchor="middle" x="1700" y="-3831.3" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-3816.3" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-3801.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-3786.3" font-family="Times,serif" font-size="14.00">Device: 8&#45;15</text>
</g>
<!-- attn_residual_12&#45;&gt;ffn_residual_12 -->
<g id="edge222" class="edge">
<title>attn_residual_12&#45;&gt;ffn_residual_12</title>
<path fill="none" stroke="black" d="M1897.78,-4278.95C1908.46,-4268.22 1917.81,-4256.32 1925,-4243.17 1989.84,-4124.55 1994.95,-4054.68 1925,-3939 1918.67,-3928.53 1911.07,-3918.95 1902.55,-3910.18"/>
<polygon fill="black" stroke="black" points="1904.79,-3907.47 1895.19,-3903 1899.91,-3912.49 1904.79,-3907.47"/>
</g>
<!-- ffn_down_12 -->
<g id="node160" class="node">
<title>ffn_down_12</title>
<polygon fill="lightblue" stroke="lightblue" points="1841,-4139.17 1479,-4139.17 1479,-4071.17 1841,-4071.17 1841,-4139.17"/>
<text text-anchor="middle" x="1660" y="-4123.97" font-family="Times,serif" font-size="14.00">Layer12_FFN_Down</text>
<text text-anchor="middle" x="1660" y="-4108.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1660" y="-4093.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-4078.97" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_up_12&#45;&gt;ffn_down_12 -->
<g id="edge218" class="edge">
<title>ffn_up_12&#45;&gt;ffn_down_12</title>
<path fill="none" stroke="black" d="M1466.18,-4175.05C1495.28,-4164.71 1527.53,-4153.25 1557.25,-4142.68"/>
<polygon fill="black" stroke="black" points="1558.55,-4145.94 1566.8,-4139.29 1556.2,-4139.34 1558.55,-4145.94"/>
</g>
<!-- ffn_gate_12&#45;&gt;ffn_down_12 -->
<g id="edge219" class="edge">
<title>ffn_gate_12&#45;&gt;ffn_down_12</title>
<path fill="none" stroke="black" d="M1714.7,-4175.05C1707.7,-4166.23 1700.05,-4156.6 1692.75,-4147.4"/>
<polygon fill="black" stroke="black" points="1695.4,-4145.12 1686.44,-4139.47 1689.92,-4149.47 1695.4,-4145.12"/>
</g>
<!-- ffn_allreduce_12 -->
<g id="node161" class="node">
<title>ffn_allreduce_12</title>
<ellipse fill="red" stroke="red" cx="1660" cy="-3987.08" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1660" y="-4005.88" font-family="Times,serif" font-size="14.00">Layer12_FFN_AllReduce</text>
<text text-anchor="middle" x="1660" y="-3990.88" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-3975.88" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-3960.88" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (All&#45;Reduce)</text>
</g>
<!-- ffn_down_12&#45;&gt;ffn_allreduce_12 -->
<g id="edge220" class="edge">
<title>ffn_down_12&#45;&gt;ffn_allreduce_12</title>
<path fill="none" stroke="black" d="M1660,-4070.9C1660,-4062.91 1660,-4054.14 1660,-4045.4"/>
<polygon fill="black" stroke="black" points="1663.5,-4045.19 1660,-4035.19 1656.5,-4045.19 1663.5,-4045.19"/>
</g>
<!-- ffn_allreduce_12&#45;&gt;ffn_residual_12 -->
<g id="edge221" class="edge">
<title>ffn_allreduce_12&#45;&gt;ffn_residual_12</title>
<path fill="none" stroke="black" d="M1671.46,-3938.78C1673.42,-3930.68 1675.52,-3922.02 1677.66,-3913.21"/>
<polygon fill="black" stroke="black" points="1681.12,-3913.77 1680.07,-3903.23 1674.32,-3912.13 1681.12,-3913.77"/>
</g>
<!-- mha_q_13 -->
<g id="node163" class="node">
<title>mha_q_13</title>
<polygon fill="lightblue" stroke="lightblue" points="1241.5,-3701 832.5,-3701 832.5,-3633 1241.5,-3633 1241.5,-3701"/>
<text text-anchor="middle" x="1037" y="-3685.8" font-family="Times,serif" font-size="14.00">Layer13_MHA_Q</text>
<text text-anchor="middle" x="1037" y="-3670.8" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1037" y="-3655.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1037" y="-3640.8" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_residual_12&#45;&gt;mha_q_13 -->
<g id="edge223" class="edge">
<title>ffn_residual_12&#45;&gt;mha_q_13</title>
<path fill="none" stroke="black" d="M1339.88,-3736.98C1287.9,-3725.14 1236.86,-3713.52 1191.94,-3703.29"/>
<polygon fill="black" stroke="black" points="1192.68,-3699.87 1182.15,-3701.06 1191.12,-3706.69 1192.68,-3699.87"/>
</g>
<!-- mha_k_13 -->
<g id="node164" class="node">
<title>mha_k_13</title>
<polygon fill="lightblue" stroke="lightblue" points="1668.5,-3701 1259.5,-3701 1259.5,-3633 1668.5,-3633 1668.5,-3701"/>
<text text-anchor="middle" x="1464" y="-3685.8" font-family="Times,serif" font-size="14.00">Layer13_MHA_K</text>
<text text-anchor="middle" x="1464" y="-3670.8" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1464" y="-3655.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1464" y="-3640.8" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_residual_12&#45;&gt;mha_k_13 -->
<g id="edge224" class="edge">
<title>ffn_residual_12&#45;&gt;mha_k_13</title>
<path fill="none" stroke="black" d="M1571.64,-3736.87C1555.1,-3726.29 1538.84,-3715.88 1524.16,-3706.49"/>
<polygon fill="black" stroke="black" points="1526.02,-3703.53 1515.71,-3701.08 1522.25,-3709.42 1526.02,-3703.53"/>
</g>
<!-- mha_v_13 -->
<g id="node165" class="node">
<title>mha_v_13</title>
<polygon fill="lightblue" stroke="lightblue" points="2095.5,-3701 1686.5,-3701 1686.5,-3633 2095.5,-3633 2095.5,-3701"/>
<text text-anchor="middle" x="1891" y="-3685.8" font-family="Times,serif" font-size="14.00">Layer13_MHA_V</text>
<text text-anchor="middle" x="1891" y="-3670.8" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1891" y="-3655.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1891" y="-3640.8" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_residual_12&#45;&gt;mha_v_13 -->
<g id="edge225" class="edge">
<title>ffn_residual_12&#45;&gt;mha_v_13</title>
<path fill="none" stroke="black" d="M1803.88,-3736.87C1816.7,-3726.74 1829.31,-3716.77 1840.79,-3707.7"/>
<polygon fill="black" stroke="black" points="1843.25,-3710.21 1848.93,-3701.26 1838.91,-3704.72 1843.25,-3710.21"/>
</g>
<!-- attn_residual_13 -->
<g id="node169" class="node">
<title>attn_residual_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2116.11,-3256.83 1519.39,-3256.83 1365.89,-3090.83 1962.61,-3090.83 2116.11,-3256.83"/>
<text text-anchor="middle" x="1741" y="-3200.13" font-family="Times,serif" font-size="14.00">Layer13_Attn_Residual</text>
<text text-anchor="middle" x="1741" y="-3185.13" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-3170.13" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-3155.13" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-3140.13" font-family="Times,serif" font-size="14.00">Device: 8&#45;15</text>
</g>
<!-- ffn_residual_12&#45;&gt;attn_residual_13 -->
<g id="edge232" class="edge">
<title>ffn_residual_12&#45;&gt;attn_residual_13</title>
<path fill="none" stroke="black" d="M1952.31,-3770C2021.23,-3751.45 2083.04,-3728.15 2105,-3701 2143.39,-3653.53 2115,-3625.05 2115,-3564 2115,-3564 2115,-3564 2115,-3458 2115,-3370.56 2049.22,-3306.66 1972.83,-3261.93"/>
<polygon fill="black" stroke="black" points="1974.37,-3258.78 1963.96,-3256.84 1970.89,-3264.85 1974.37,-3258.78"/>
</g>
<!-- attn_score_13 -->
<g id="node166" class="node">
<title>attn_score_13</title>
<polygon fill="lightblue" stroke="lightblue" points="1678,-3597 1250,-3597 1250,-3529 1678,-3529 1678,-3597"/>
<text text-anchor="middle" x="1464" y="-3581.8" font-family="Times,serif" font-size="14.00">Layer13_Attn_Score</text>
<text text-anchor="middle" x="1464" y="-3566.8" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1464" y="-3551.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1464" y="-3536.8" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- mha_q_13&#45;&gt;attn_score_13 -->
<g id="edge226" class="edge">
<title>mha_q_13&#45;&gt;attn_score_13</title>
<path fill="none" stroke="black" d="M1175.34,-3632.95C1220.16,-3622.25 1270.05,-3610.33 1315.57,-3599.46"/>
<polygon fill="black" stroke="black" points="1316.6,-3602.81 1325.51,-3597.08 1314.98,-3596 1316.6,-3602.81"/>
</g>
<!-- mha_k_13&#45;&gt;attn_score_13 -->
<g id="edge227" class="edge">
<title>mha_k_13&#45;&gt;attn_score_13</title>
<path fill="none" stroke="black" d="M1464,-3632.88C1464,-3624.78 1464,-3615.98 1464,-3607.47"/>
<polygon fill="black" stroke="black" points="1467.5,-3607.3 1464,-3597.3 1460.5,-3607.3 1467.5,-3607.3"/>
</g>
<!-- attn_out_13 -->
<g id="node167" class="node">
<title>attn_out_13</title>
<polygon fill="lightblue" stroke="lightblue" points="1939.5,-3493 1542.5,-3493 1542.5,-3425 1939.5,-3425 1939.5,-3493"/>
<text text-anchor="middle" x="1741" y="-3477.8" font-family="Times,serif" font-size="14.00">Layer13_Attn_Out</text>
<text text-anchor="middle" x="1741" y="-3462.8" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1741" y="-3447.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-3432.8" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_score_13&#45;&gt;attn_out_13 -->
<g id="edge229" class="edge">
<title>attn_score_13&#45;&gt;attn_out_13</title>
<path fill="none" stroke="black" d="M1553.93,-3528.88C1581.89,-3518.59 1612.88,-3507.18 1641.45,-3496.66"/>
<polygon fill="black" stroke="black" points="1642.87,-3499.86 1651.04,-3493.12 1640.45,-3493.3 1642.87,-3499.86"/>
</g>
<!-- attn_allreduce_13 -->
<g id="node168" class="node">
<title>attn_allreduce_13</title>
<ellipse fill="red" stroke="red" cx="1741" cy="-3340.92" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1741" y="-3359.72" font-family="Times,serif" font-size="14.00">Layer13_Attn_AllReduce</text>
<text text-anchor="middle" x="1741" y="-3344.72" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-3329.72" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-3314.72" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (All&#45;Reduce)</text>
</g>
<!-- attn_out_13&#45;&gt;attn_allreduce_13 -->
<g id="edge230" class="edge">
<title>attn_out_13&#45;&gt;attn_allreduce_13</title>
<path fill="none" stroke="black" d="M1741,-3424.73C1741,-3416.74 1741,-3407.98 1741,-3399.23"/>
<polygon fill="black" stroke="black" points="1744.5,-3399.03 1741,-3389.03 1737.5,-3399.03 1744.5,-3399.03"/>
</g>
<!-- attn_allreduce_13&#45;&gt;attn_residual_13 -->
<g id="edge231" class="edge">
<title>attn_allreduce_13&#45;&gt;attn_residual_13</title>
<path fill="none" stroke="black" d="M1741,-3292.61C1741,-3284.6 1741,-3276.04 1741,-3267.33"/>
<polygon fill="black" stroke="black" points="1744.5,-3267.07 1741,-3257.07 1737.5,-3267.07 1744.5,-3267.07"/>
</g>
<!-- ffn_up_13 -->
<g id="node170" class="node">
<title>ffn_up_13</title>
<polygon fill="lightblue" stroke="lightblue" points="1548,-3054.83 1198,-3054.83 1198,-2986.83 1548,-2986.83 1548,-3054.83"/>
<text text-anchor="middle" x="1373" y="-3039.63" font-family="Times,serif" font-size="14.00">Layer13_FFN_Up</text>
<text text-anchor="middle" x="1373" y="-3024.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1373" y="-3009.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1373" y="-2994.63" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_residual_13&#45;&gt;ffn_up_13 -->
<g id="edge233" class="edge">
<title>attn_residual_13&#45;&gt;ffn_up_13</title>
<path fill="none" stroke="black" d="M1541.12,-3090.81C1513.85,-3079.63 1487.05,-3068.63 1463.14,-3058.82"/>
<polygon fill="black" stroke="black" points="1464.36,-3055.54 1453.78,-3054.98 1461.7,-3062.01 1464.36,-3055.54"/>
</g>
<!-- ffn_gate_13 -->
<g id="node171" class="node">
<title>ffn_gate_13</title>
<polygon fill="lightblue" stroke="lightblue" points="1916,-3054.83 1566,-3054.83 1566,-2986.83 1916,-2986.83 1916,-3054.83"/>
<text text-anchor="middle" x="1741" y="-3039.63" font-family="Times,serif" font-size="14.00">Layer13_FFN_Gate</text>
<text text-anchor="middle" x="1741" y="-3024.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-3009.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1741" y="-2994.63" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_residual_13&#45;&gt;ffn_gate_13 -->
<g id="edge234" class="edge">
<title>attn_residual_13&#45;&gt;ffn_gate_13</title>
<path fill="none" stroke="black" d="M1741,-3090.7C1741,-3081.95 1741,-3073.32 1741,-3065.28"/>
<polygon fill="black" stroke="black" points="1744.5,-3065.09 1741,-3055.09 1737.5,-3065.09 1744.5,-3065.09"/>
</g>
<!-- ffn_residual_13 -->
<g id="node174" class="node">
<title>ffn_residual_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2075.11,-2714.67 1478.39,-2714.67 1324.89,-2548.67 1921.61,-2548.67 2075.11,-2714.67"/>
<text text-anchor="middle" x="1700" y="-2657.97" font-family="Times,serif" font-size="14.00">Layer13_FFN_Residual</text>
<text text-anchor="middle" x="1700" y="-2642.97" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-2627.97" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-2612.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-2597.97" font-family="Times,serif" font-size="14.00">Device: 8&#45;15</text>
</g>
<!-- attn_residual_13&#45;&gt;ffn_residual_13 -->
<g id="edge239" class="edge">
<title>attn_residual_13&#45;&gt;ffn_residual_13</title>
<path fill="none" stroke="black" d="M1897.78,-3090.61C1908.46,-3079.89 1917.81,-3067.99 1925,-3054.83 1989.84,-2936.21 1994.95,-2866.34 1925,-2750.67 1918.67,-2740.2 1911.07,-2730.61 1902.55,-2721.84"/>
<polygon fill="black" stroke="black" points="1904.79,-2719.14 1895.19,-2714.67 1899.91,-2724.15 1904.79,-2719.14"/>
</g>
<!-- ffn_down_13 -->
<g id="node172" class="node">
<title>ffn_down_13</title>
<polygon fill="lightblue" stroke="lightblue" points="1841,-2950.83 1479,-2950.83 1479,-2882.83 1841,-2882.83 1841,-2950.83"/>
<text text-anchor="middle" x="1660" y="-2935.63" font-family="Times,serif" font-size="14.00">Layer13_FFN_Down</text>
<text text-anchor="middle" x="1660" y="-2920.63" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1660" y="-2905.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-2890.63" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_up_13&#45;&gt;ffn_down_13 -->
<g id="edge235" class="edge">
<title>ffn_up_13&#45;&gt;ffn_down_13</title>
<path fill="none" stroke="black" d="M1466.18,-2986.72C1495.28,-2976.38 1527.53,-2964.91 1557.25,-2954.35"/>
<polygon fill="black" stroke="black" points="1558.55,-2957.6 1566.8,-2950.96 1556.2,-2951.01 1558.55,-2957.6"/>
</g>
<!-- ffn_gate_13&#45;&gt;ffn_down_13 -->
<g id="edge236" class="edge">
<title>ffn_gate_13&#45;&gt;ffn_down_13</title>
<path fill="none" stroke="black" d="M1714.7,-2986.72C1707.7,-2977.9 1700.05,-2968.26 1692.75,-2959.07"/>
<polygon fill="black" stroke="black" points="1695.4,-2956.79 1686.44,-2951.13 1689.92,-2961.14 1695.4,-2956.79"/>
</g>
<!-- ffn_allreduce_13 -->
<g id="node173" class="node">
<title>ffn_allreduce_13</title>
<ellipse fill="red" stroke="red" cx="1660" cy="-2798.75" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1660" y="-2817.55" font-family="Times,serif" font-size="14.00">Layer13_FFN_AllReduce</text>
<text text-anchor="middle" x="1660" y="-2802.55" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-2787.55" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-2772.55" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (All&#45;Reduce)</text>
</g>
<!-- ffn_down_13&#45;&gt;ffn_allreduce_13 -->
<g id="edge237" class="edge">
<title>ffn_down_13&#45;&gt;ffn_allreduce_13</title>
<path fill="none" stroke="black" d="M1660,-2882.57C1660,-2874.57 1660,-2865.81 1660,-2857.07"/>
<polygon fill="black" stroke="black" points="1663.5,-2856.86 1660,-2846.86 1656.5,-2856.86 1663.5,-2856.86"/>
</g>
<!-- ffn_allreduce_13&#45;&gt;ffn_residual_13 -->
<g id="edge238" class="edge">
<title>ffn_allreduce_13&#45;&gt;ffn_residual_13</title>
<path fill="none" stroke="black" d="M1671.46,-2750.44C1673.42,-2742.34 1675.52,-2733.69 1677.66,-2724.88"/>
<polygon fill="black" stroke="black" points="1681.12,-2725.44 1680.07,-2714.9 1674.32,-2723.79 1681.12,-2725.44"/>
</g>
<!-- mha_q_14 -->
<g id="node175" class="node">
<title>mha_q_14</title>
<polygon fill="lightblue" stroke="lightblue" points="1241.5,-2512.67 832.5,-2512.67 832.5,-2444.67 1241.5,-2444.67 1241.5,-2512.67"/>
<text text-anchor="middle" x="1037" y="-2497.47" font-family="Times,serif" font-size="14.00">Layer14_MHA_Q</text>
<text text-anchor="middle" x="1037" y="-2482.47" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1037" y="-2467.47" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1037" y="-2452.47" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_residual_13&#45;&gt;mha_q_14 -->
<g id="edge240" class="edge">
<title>ffn_residual_13&#45;&gt;mha_q_14</title>
<path fill="none" stroke="black" d="M1339.88,-2548.65C1287.9,-2536.81 1236.86,-2525.19 1191.94,-2514.95"/>
<polygon fill="black" stroke="black" points="1192.68,-2511.53 1182.15,-2512.72 1191.12,-2518.36 1192.68,-2511.53"/>
</g>
<!-- mha_k_14 -->
<g id="node176" class="node">
<title>mha_k_14</title>
<polygon fill="lightblue" stroke="lightblue" points="1668.5,-2512.67 1259.5,-2512.67 1259.5,-2444.67 1668.5,-2444.67 1668.5,-2512.67"/>
<text text-anchor="middle" x="1464" y="-2497.47" font-family="Times,serif" font-size="14.00">Layer14_MHA_K</text>
<text text-anchor="middle" x="1464" y="-2482.47" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1464" y="-2467.47" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1464" y="-2452.47" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_residual_13&#45;&gt;mha_k_14 -->
<g id="edge241" class="edge">
<title>ffn_residual_13&#45;&gt;mha_k_14</title>
<path fill="none" stroke="black" d="M1571.64,-2548.54C1555.1,-2537.96 1538.84,-2527.55 1524.16,-2518.16"/>
<polygon fill="black" stroke="black" points="1526.02,-2515.19 1515.71,-2512.75 1522.25,-2521.09 1526.02,-2515.19"/>
</g>
<!-- mha_v_14 -->
<g id="node177" class="node">
<title>mha_v_14</title>
<polygon fill="lightblue" stroke="lightblue" points="2095.5,-2512.67 1686.5,-2512.67 1686.5,-2444.67 2095.5,-2444.67 2095.5,-2512.67"/>
<text text-anchor="middle" x="1891" y="-2497.47" font-family="Times,serif" font-size="14.00">Layer14_MHA_V</text>
<text text-anchor="middle" x="1891" y="-2482.47" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1891" y="-2467.47" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1891" y="-2452.47" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_residual_13&#45;&gt;mha_v_14 -->
<g id="edge242" class="edge">
<title>ffn_residual_13&#45;&gt;mha_v_14</title>
<path fill="none" stroke="black" d="M1803.88,-2548.54C1816.7,-2538.41 1829.31,-2528.44 1840.79,-2519.36"/>
<polygon fill="black" stroke="black" points="1843.25,-2521.88 1848.93,-2512.93 1838.91,-2516.38 1843.25,-2521.88"/>
</g>
<!-- attn_residual_14 -->
<g id="node181" class="node">
<title>attn_residual_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2116.11,-2068.5 1519.39,-2068.5 1365.89,-1902.5 1962.61,-1902.5 2116.11,-2068.5"/>
<text text-anchor="middle" x="1741" y="-2011.8" font-family="Times,serif" font-size="14.00">Layer14_Attn_Residual</text>
<text text-anchor="middle" x="1741" y="-1996.8" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-1981.8" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-1966.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-1951.8" font-family="Times,serif" font-size="14.00">Device: 8&#45;15</text>
</g>
<!-- ffn_residual_13&#45;&gt;attn_residual_14 -->
<g id="edge249" class="edge">
<title>ffn_residual_13&#45;&gt;attn_residual_14</title>
<path fill="none" stroke="black" d="M1952.31,-2581.67C2021.23,-2563.12 2083.04,-2539.82 2105,-2512.67 2143.39,-2465.2 2115,-2436.72 2115,-2375.67 2115,-2375.67 2115,-2375.67 2115,-2269.67 2115,-2182.23 2049.22,-2118.33 1972.83,-2073.6"/>
<polygon fill="black" stroke="black" points="1974.37,-2070.45 1963.96,-2068.51 1970.89,-2076.52 1974.37,-2070.45"/>
</g>
<!-- attn_score_14 -->
<g id="node178" class="node">
<title>attn_score_14</title>
<polygon fill="lightblue" stroke="lightblue" points="1678,-2408.67 1250,-2408.67 1250,-2340.67 1678,-2340.67 1678,-2408.67"/>
<text text-anchor="middle" x="1464" y="-2393.47" font-family="Times,serif" font-size="14.00">Layer14_Attn_Score</text>
<text text-anchor="middle" x="1464" y="-2378.47" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1464" y="-2363.47" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1464" y="-2348.47" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- mha_q_14&#45;&gt;attn_score_14 -->
<g id="edge243" class="edge">
<title>mha_q_14&#45;&gt;attn_score_14</title>
<path fill="none" stroke="black" d="M1175.34,-2444.62C1220.16,-2433.91 1270.05,-2422 1315.57,-2411.12"/>
<polygon fill="black" stroke="black" points="1316.6,-2414.47 1325.51,-2408.75 1314.98,-2407.67 1316.6,-2414.47"/>
</g>
<!-- mha_k_14&#45;&gt;attn_score_14 -->
<g id="edge244" class="edge">
<title>mha_k_14&#45;&gt;attn_score_14</title>
<path fill="none" stroke="black" d="M1464,-2444.55C1464,-2436.44 1464,-2427.65 1464,-2419.14"/>
<polygon fill="black" stroke="black" points="1467.5,-2418.97 1464,-2408.97 1460.5,-2418.97 1467.5,-2418.97"/>
</g>
<!-- attn_out_14 -->
<g id="node179" class="node">
<title>attn_out_14</title>
<polygon fill="lightblue" stroke="lightblue" points="1939.5,-2304.67 1542.5,-2304.67 1542.5,-2236.67 1939.5,-2236.67 1939.5,-2304.67"/>
<text text-anchor="middle" x="1741" y="-2289.47" font-family="Times,serif" font-size="14.00">Layer14_Attn_Out</text>
<text text-anchor="middle" x="1741" y="-2274.47" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1741" y="-2259.47" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-2244.47" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_score_14&#45;&gt;attn_out_14 -->
<g id="edge246" class="edge">
<title>attn_score_14&#45;&gt;attn_out_14</title>
<path fill="none" stroke="black" d="M1553.93,-2340.55C1581.89,-2330.25 1612.88,-2318.84 1641.45,-2308.32"/>
<polygon fill="black" stroke="black" points="1642.87,-2311.53 1651.04,-2304.79 1640.45,-2304.96 1642.87,-2311.53"/>
</g>
<!-- attn_allreduce_14 -->
<g id="node180" class="node">
<title>attn_allreduce_14</title>
<ellipse fill="red" stroke="red" cx="1741" cy="-2152.58" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1741" y="-2171.38" font-family="Times,serif" font-size="14.00">Layer14_Attn_AllReduce</text>
<text text-anchor="middle" x="1741" y="-2156.38" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-2141.38" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-2126.38" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (All&#45;Reduce)</text>
</g>
<!-- attn_out_14&#45;&gt;attn_allreduce_14 -->
<g id="edge247" class="edge">
<title>attn_out_14&#45;&gt;attn_allreduce_14</title>
<path fill="none" stroke="black" d="M1741,-2236.4C1741,-2228.41 1741,-2219.64 1741,-2210.9"/>
<polygon fill="black" stroke="black" points="1744.5,-2210.69 1741,-2200.69 1737.5,-2210.69 1744.5,-2210.69"/>
</g>
<!-- attn_allreduce_14&#45;&gt;attn_residual_14 -->
<g id="edge248" class="edge">
<title>attn_allreduce_14&#45;&gt;attn_residual_14</title>
<path fill="none" stroke="black" d="M1741,-2104.28C1741,-2096.26 1741,-2087.71 1741,-2079"/>
<polygon fill="black" stroke="black" points="1744.5,-2078.73 1741,-2068.73 1737.5,-2078.73 1744.5,-2078.73"/>
</g>
<!-- ffn_up_14 -->
<g id="node182" class="node">
<title>ffn_up_14</title>
<polygon fill="lightblue" stroke="lightblue" points="1548,-1866.5 1198,-1866.5 1198,-1798.5 1548,-1798.5 1548,-1866.5"/>
<text text-anchor="middle" x="1373" y="-1851.3" font-family="Times,serif" font-size="14.00">Layer14_FFN_Up</text>
<text text-anchor="middle" x="1373" y="-1836.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1373" y="-1821.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1373" y="-1806.3" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_residual_14&#45;&gt;ffn_up_14 -->
<g id="edge250" class="edge">
<title>attn_residual_14&#45;&gt;ffn_up_14</title>
<path fill="none" stroke="black" d="M1541.12,-1902.48C1513.85,-1891.29 1487.05,-1880.3 1463.14,-1870.49"/>
<polygon fill="black" stroke="black" points="1464.36,-1867.2 1453.78,-1866.65 1461.7,-1873.68 1464.36,-1867.2"/>
</g>
<!-- ffn_gate_14 -->
<g id="node183" class="node">
<title>ffn_gate_14</title>
<polygon fill="lightblue" stroke="lightblue" points="1916,-1866.5 1566,-1866.5 1566,-1798.5 1916,-1798.5 1916,-1866.5"/>
<text text-anchor="middle" x="1741" y="-1851.3" font-family="Times,serif" font-size="14.00">Layer14_FFN_Gate</text>
<text text-anchor="middle" x="1741" y="-1836.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-1821.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1741" y="-1806.3" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_residual_14&#45;&gt;ffn_gate_14 -->
<g id="edge251" class="edge">
<title>attn_residual_14&#45;&gt;ffn_gate_14</title>
<path fill="none" stroke="black" d="M1741,-1902.37C1741,-1893.62 1741,-1884.98 1741,-1876.95"/>
<polygon fill="black" stroke="black" points="1744.5,-1876.76 1741,-1866.76 1737.5,-1876.76 1744.5,-1876.76"/>
</g>
<!-- ffn_residual_14 -->
<g id="node186" class="node">
<title>ffn_residual_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2075.11,-1526.33 1478.39,-1526.33 1324.89,-1360.33 1921.61,-1360.33 2075.11,-1526.33"/>
<text text-anchor="middle" x="1700" y="-1469.63" font-family="Times,serif" font-size="14.00">Layer14_FFN_Residual</text>
<text text-anchor="middle" x="1700" y="-1454.63" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-1439.63" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-1424.63" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-1409.63" font-family="Times,serif" font-size="14.00">Device: 8&#45;15</text>
</g>
<!-- attn_residual_14&#45;&gt;ffn_residual_14 -->
<g id="edge256" class="edge">
<title>attn_residual_14&#45;&gt;ffn_residual_14</title>
<path fill="none" stroke="black" d="M1897.78,-1902.28C1908.46,-1891.56 1917.81,-1879.65 1925,-1866.5 1989.84,-1747.88 1994.95,-1678.01 1925,-1562.33 1918.67,-1551.87 1911.07,-1542.28 1902.55,-1533.51"/>
<polygon fill="black" stroke="black" points="1904.79,-1530.81 1895.19,-1526.33 1899.91,-1535.82 1904.79,-1530.81"/>
</g>
<!-- ffn_down_14 -->
<g id="node184" class="node">
<title>ffn_down_14</title>
<polygon fill="lightblue" stroke="lightblue" points="1841,-1762.5 1479,-1762.5 1479,-1694.5 1841,-1694.5 1841,-1762.5"/>
<text text-anchor="middle" x="1660" y="-1747.3" font-family="Times,serif" font-size="14.00">Layer14_FFN_Down</text>
<text text-anchor="middle" x="1660" y="-1732.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1660" y="-1717.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-1702.3" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_up_14&#45;&gt;ffn_down_14 -->
<g id="edge252" class="edge">
<title>ffn_up_14&#45;&gt;ffn_down_14</title>
<path fill="none" stroke="black" d="M1466.18,-1798.38C1495.28,-1788.04 1527.53,-1776.58 1557.25,-1766.02"/>
<polygon fill="black" stroke="black" points="1558.55,-1769.27 1566.8,-1762.62 1556.2,-1762.68 1558.55,-1769.27"/>
</g>
<!-- ffn_gate_14&#45;&gt;ffn_down_14 -->
<g id="edge253" class="edge">
<title>ffn_gate_14&#45;&gt;ffn_down_14</title>
<path fill="none" stroke="black" d="M1714.7,-1798.38C1707.7,-1789.56 1700.05,-1779.93 1692.75,-1770.73"/>
<polygon fill="black" stroke="black" points="1695.4,-1768.45 1686.44,-1762.8 1689.92,-1772.81 1695.4,-1768.45"/>
</g>
<!-- ffn_allreduce_14 -->
<g id="node185" class="node">
<title>ffn_allreduce_14</title>
<ellipse fill="red" stroke="red" cx="1660" cy="-1610.42" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1660" y="-1629.22" font-family="Times,serif" font-size="14.00">Layer14_FFN_AllReduce</text>
<text text-anchor="middle" x="1660" y="-1614.22" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-1599.22" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-1584.22" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (All&#45;Reduce)</text>
</g>
<!-- ffn_down_14&#45;&gt;ffn_allreduce_14 -->
<g id="edge254" class="edge">
<title>ffn_down_14&#45;&gt;ffn_allreduce_14</title>
<path fill="none" stroke="black" d="M1660,-1694.23C1660,-1686.24 1660,-1677.48 1660,-1668.73"/>
<polygon fill="black" stroke="black" points="1663.5,-1668.53 1660,-1658.53 1656.5,-1668.53 1663.5,-1668.53"/>
</g>
<!-- ffn_allreduce_14&#45;&gt;ffn_residual_14 -->
<g id="edge255" class="edge">
<title>ffn_allreduce_14&#45;&gt;ffn_residual_14</title>
<path fill="none" stroke="black" d="M1671.46,-1562.11C1673.42,-1554.01 1675.52,-1545.35 1677.66,-1536.55"/>
<polygon fill="black" stroke="black" points="1681.12,-1537.11 1680.07,-1526.57 1674.32,-1535.46 1681.12,-1537.11"/>
</g>
<!-- mha_q_15 -->
<g id="node187" class="node">
<title>mha_q_15</title>
<polygon fill="lightblue" stroke="lightblue" points="1241.5,-1324.33 832.5,-1324.33 832.5,-1256.33 1241.5,-1256.33 1241.5,-1324.33"/>
<text text-anchor="middle" x="1037" y="-1309.13" font-family="Times,serif" font-size="14.00">Layer15_MHA_Q</text>
<text text-anchor="middle" x="1037" y="-1294.13" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1037" y="-1279.13" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1037" y="-1264.13" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_residual_14&#45;&gt;mha_q_15 -->
<g id="edge257" class="edge">
<title>ffn_residual_14&#45;&gt;mha_q_15</title>
<path fill="none" stroke="black" d="M1339.88,-1360.32C1287.9,-1348.48 1236.86,-1336.85 1191.94,-1326.62"/>
<polygon fill="black" stroke="black" points="1192.68,-1323.2 1182.15,-1324.39 1191.12,-1330.02 1192.68,-1323.2"/>
</g>
<!-- mha_k_15 -->
<g id="node188" class="node">
<title>mha_k_15</title>
<polygon fill="lightblue" stroke="lightblue" points="1668.5,-1324.33 1259.5,-1324.33 1259.5,-1256.33 1668.5,-1256.33 1668.5,-1324.33"/>
<text text-anchor="middle" x="1464" y="-1309.13" font-family="Times,serif" font-size="14.00">Layer15_MHA_K</text>
<text text-anchor="middle" x="1464" y="-1294.13" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1464" y="-1279.13" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1464" y="-1264.13" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_residual_14&#45;&gt;mha_k_15 -->
<g id="edge258" class="edge">
<title>ffn_residual_14&#45;&gt;mha_k_15</title>
<path fill="none" stroke="black" d="M1571.64,-1360.2C1555.1,-1349.62 1538.84,-1339.22 1524.16,-1329.82"/>
<polygon fill="black" stroke="black" points="1526.02,-1326.86 1515.71,-1324.42 1522.25,-1332.76 1526.02,-1326.86"/>
</g>
<!-- mha_v_15 -->
<g id="node189" class="node">
<title>mha_v_15</title>
<polygon fill="lightblue" stroke="lightblue" points="2095.5,-1324.33 1686.5,-1324.33 1686.5,-1256.33 2095.5,-1256.33 2095.5,-1324.33"/>
<text text-anchor="middle" x="1891" y="-1309.13" font-family="Times,serif" font-size="14.00">Layer15_MHA_V</text>
<text text-anchor="middle" x="1891" y="-1294.13" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1891" y="-1279.13" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1891" y="-1264.13" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_residual_14&#45;&gt;mha_v_15 -->
<g id="edge259" class="edge">
<title>ffn_residual_14&#45;&gt;mha_v_15</title>
<path fill="none" stroke="black" d="M1803.88,-1360.2C1816.7,-1350.07 1829.31,-1340.1 1840.79,-1331.03"/>
<polygon fill="black" stroke="black" points="1843.25,-1333.54 1848.93,-1324.59 1838.91,-1328.05 1843.25,-1333.54"/>
</g>
<!-- attn_residual_15 -->
<g id="node193" class="node">
<title>attn_residual_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2116.11,-880.17 1519.39,-880.17 1365.89,-714.17 1962.61,-714.17 2116.11,-880.17"/>
<text text-anchor="middle" x="1741" y="-823.47" font-family="Times,serif" font-size="14.00">Layer15_Attn_Residual</text>
<text text-anchor="middle" x="1741" y="-808.47" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-793.47" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-778.47" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-763.47" font-family="Times,serif" font-size="14.00">Device: 8&#45;15</text>
</g>
<!-- ffn_residual_14&#45;&gt;attn_residual_15 -->
<g id="edge266" class="edge">
<title>ffn_residual_14&#45;&gt;attn_residual_15</title>
<path fill="none" stroke="black" d="M1952.31,-1393.34C2021.23,-1374.79 2083.04,-1351.49 2105,-1324.33 2143.39,-1276.86 2115,-1248.38 2115,-1187.33 2115,-1187.33 2115,-1187.33 2115,-1081.33 2115,-993.9 2049.22,-929.99 1972.83,-885.26"/>
<polygon fill="black" stroke="black" points="1974.37,-882.11 1963.96,-880.18 1970.89,-888.19 1974.37,-882.11"/>
</g>
<!-- attn_score_15 -->
<g id="node190" class="node">
<title>attn_score_15</title>
<polygon fill="lightblue" stroke="lightblue" points="1678,-1220.33 1250,-1220.33 1250,-1152.33 1678,-1152.33 1678,-1220.33"/>
<text text-anchor="middle" x="1464" y="-1205.13" font-family="Times,serif" font-size="14.00">Layer15_Attn_Score</text>
<text text-anchor="middle" x="1464" y="-1190.13" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1464" y="-1175.13" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1464" y="-1160.13" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- mha_q_15&#45;&gt;attn_score_15 -->
<g id="edge260" class="edge">
<title>mha_q_15&#45;&gt;attn_score_15</title>
<path fill="none" stroke="black" d="M1175.34,-1256.29C1220.16,-1245.58 1270.05,-1233.66 1315.57,-1222.79"/>
<polygon fill="black" stroke="black" points="1316.6,-1226.14 1325.51,-1220.41 1314.98,-1219.33 1316.6,-1226.14"/>
</g>
<!-- mha_k_15&#45;&gt;attn_score_15 -->
<g id="edge261" class="edge">
<title>mha_k_15&#45;&gt;attn_score_15</title>
<path fill="none" stroke="black" d="M1464,-1256.22C1464,-1248.11 1464,-1239.32 1464,-1230.81"/>
<polygon fill="black" stroke="black" points="1467.5,-1230.63 1464,-1220.63 1460.5,-1230.63 1467.5,-1230.63"/>
</g>
<!-- attn_out_15 -->
<g id="node191" class="node">
<title>attn_out_15</title>
<polygon fill="lightblue" stroke="lightblue" points="1939.5,-1116.33 1542.5,-1116.33 1542.5,-1048.33 1939.5,-1048.33 1939.5,-1116.33"/>
<text text-anchor="middle" x="1741" y="-1101.13" font-family="Times,serif" font-size="14.00">Layer15_Attn_Out</text>
<text text-anchor="middle" x="1741" y="-1086.13" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1741" y="-1071.13" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-1056.13" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_score_15&#45;&gt;attn_out_15 -->
<g id="edge263" class="edge">
<title>attn_score_15&#45;&gt;attn_out_15</title>
<path fill="none" stroke="black" d="M1553.93,-1152.22C1581.89,-1141.92 1612.88,-1130.51 1641.45,-1119.99"/>
<polygon fill="black" stroke="black" points="1642.87,-1123.2 1651.04,-1116.46 1640.45,-1116.63 1642.87,-1123.2"/>
</g>
<!-- attn_allreduce_15 -->
<g id="node192" class="node">
<title>attn_allreduce_15</title>
<ellipse fill="red" stroke="red" cx="1741" cy="-964.25" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1741" y="-983.05" font-family="Times,serif" font-size="14.00">Layer15_Attn_AllReduce</text>
<text text-anchor="middle" x="1741" y="-968.05" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-953.05" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-938.05" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (All&#45;Reduce)</text>
</g>
<!-- attn_out_15&#45;&gt;attn_allreduce_15 -->
<g id="edge264" class="edge">
<title>attn_out_15&#45;&gt;attn_allreduce_15</title>
<path fill="none" stroke="black" d="M1741,-1048.07C1741,-1040.07 1741,-1031.31 1741,-1022.57"/>
<polygon fill="black" stroke="black" points="1744.5,-1022.36 1741,-1012.36 1737.5,-1022.36 1744.5,-1022.36"/>
</g>
<!-- attn_allreduce_15&#45;&gt;attn_residual_15 -->
<g id="edge265" class="edge">
<title>attn_allreduce_15&#45;&gt;attn_residual_15</title>
<path fill="none" stroke="black" d="M1741,-915.94C1741,-907.93 1741,-899.37 1741,-890.67"/>
<polygon fill="black" stroke="black" points="1744.5,-890.4 1741,-880.4 1737.5,-890.4 1744.5,-890.4"/>
</g>
<!-- ffn_up_15 -->
<g id="node194" class="node">
<title>ffn_up_15</title>
<polygon fill="lightblue" stroke="lightblue" points="1548,-678.17 1198,-678.17 1198,-610.17 1548,-610.17 1548,-678.17"/>
<text text-anchor="middle" x="1373" y="-662.97" font-family="Times,serif" font-size="14.00">Layer15_FFN_Up</text>
<text text-anchor="middle" x="1373" y="-647.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1373" y="-632.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1373" y="-617.97" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_residual_15&#45;&gt;ffn_up_15 -->
<g id="edge267" class="edge">
<title>attn_residual_15&#45;&gt;ffn_up_15</title>
<path fill="none" stroke="black" d="M1541.12,-714.15C1513.85,-702.96 1487.05,-691.97 1463.14,-682.15"/>
<polygon fill="black" stroke="black" points="1464.36,-678.87 1453.78,-678.31 1461.7,-685.35 1464.36,-678.87"/>
</g>
<!-- ffn_gate_15 -->
<g id="node195" class="node">
<title>ffn_gate_15</title>
<polygon fill="lightblue" stroke="lightblue" points="1916,-678.17 1566,-678.17 1566,-610.17 1916,-610.17 1916,-678.17"/>
<text text-anchor="middle" x="1741" y="-662.97" font-family="Times,serif" font-size="14.00">Layer15_FFN_Gate</text>
<text text-anchor="middle" x="1741" y="-647.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1741" y="-632.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1741" y="-617.97" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- attn_residual_15&#45;&gt;ffn_gate_15 -->
<g id="edge268" class="edge">
<title>attn_residual_15&#45;&gt;ffn_gate_15</title>
<path fill="none" stroke="black" d="M1741,-714.04C1741,-705.28 1741,-696.65 1741,-688.61"/>
<polygon fill="black" stroke="black" points="1744.5,-688.43 1741,-678.43 1737.5,-688.43 1744.5,-688.43"/>
</g>
<!-- ffn_residual_15 -->
<g id="node198" class="node">
<title>ffn_residual_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2075.11,-338 1478.39,-338 1324.89,-172 1921.61,-172 2075.11,-338"/>
<text text-anchor="middle" x="1700" y="-281.3" font-family="Times,serif" font-size="14.00">Layer15_FFN_Residual</text>
<text text-anchor="middle" x="1700" y="-266.3" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-251.3" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-236.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-221.3" font-family="Times,serif" font-size="14.00">Device: 8&#45;15</text>
</g>
<!-- attn_residual_15&#45;&gt;ffn_residual_15 -->
<g id="edge273" class="edge">
<title>attn_residual_15&#45;&gt;ffn_residual_15</title>
<path fill="none" stroke="black" d="M1897.78,-713.95C1908.46,-703.22 1917.81,-691.32 1925,-678.17 1989.84,-559.55 1994.95,-489.68 1925,-374 1918.67,-363.53 1911.07,-353.95 1902.55,-345.18"/>
<polygon fill="black" stroke="black" points="1904.79,-342.47 1895.19,-338 1899.91,-347.49 1904.79,-342.47"/>
</g>
<!-- ffn_down_15 -->
<g id="node196" class="node">
<title>ffn_down_15</title>
<polygon fill="lightblue" stroke="lightblue" points="1841,-574.17 1479,-574.17 1479,-506.17 1841,-506.17 1841,-574.17"/>
<text text-anchor="middle" x="1660" y="-558.97" font-family="Times,serif" font-size="14.00">Layer15_FFN_Down</text>
<text text-anchor="middle" x="1660" y="-543.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1660" y="-528.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-513.97" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_up_15&#45;&gt;ffn_down_15 -->
<g id="edge269" class="edge">
<title>ffn_up_15&#45;&gt;ffn_down_15</title>
<path fill="none" stroke="black" d="M1466.18,-610.05C1495.28,-599.71 1527.53,-588.25 1557.25,-577.69"/>
<polygon fill="black" stroke="black" points="1558.55,-580.94 1566.8,-574.29 1556.2,-574.34 1558.55,-580.94"/>
</g>
<!-- ffn_gate_15&#45;&gt;ffn_down_15 -->
<g id="edge270" class="edge">
<title>ffn_gate_15&#45;&gt;ffn_down_15</title>
<path fill="none" stroke="black" d="M1714.7,-610.05C1707.7,-601.23 1700.05,-591.6 1692.75,-582.4"/>
<polygon fill="black" stroke="black" points="1695.4,-580.12 1686.44,-574.47 1689.92,-584.47 1695.4,-580.12"/>
</g>
<!-- ffn_allreduce_15 -->
<g id="node197" class="node">
<title>ffn_allreduce_15</title>
<ellipse fill="red" stroke="red" cx="1660" cy="-422.08" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="1660" y="-440.88" font-family="Times,serif" font-size="14.00">Layer15_FFN_AllReduce</text>
<text text-anchor="middle" x="1660" y="-425.88" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-410.88" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1660" y="-395.88" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (All&#45;Reduce)</text>
</g>
<!-- ffn_down_15&#45;&gt;ffn_allreduce_15 -->
<g id="edge271" class="edge">
<title>ffn_down_15&#45;&gt;ffn_allreduce_15</title>
<path fill="none" stroke="black" d="M1660,-505.9C1660,-497.91 1660,-489.14 1660,-480.4"/>
<polygon fill="black" stroke="black" points="1663.5,-480.19 1660,-470.19 1656.5,-480.19 1663.5,-480.19"/>
</g>
<!-- ffn_allreduce_15&#45;&gt;ffn_residual_15 -->
<g id="edge272" class="edge">
<title>ffn_allreduce_15&#45;&gt;ffn_residual_15</title>
<path fill="none" stroke="black" d="M1671.46,-373.78C1673.42,-365.68 1675.52,-357.02 1677.66,-348.22"/>
<polygon fill="black" stroke="black" points="1681.12,-348.78 1680.07,-338.23 1674.32,-347.13 1681.12,-348.78"/>
</g>
<!-- output -->
<g id="node200" class="node">
<title>output</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2062.73,-136 1485.71,-136 1337.27,0 1914.29,0 2062.73,-136"/>
<text text-anchor="middle" x="1700" y="-86.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1700" y="-71.8" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1700" y="-56.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, vocab_size]</text>
<text text-anchor="middle" x="1700" y="-41.8" font-family="Times,serif" font-size="14.00">Device: 8&#45;15 (TP)</text>
</g>
<!-- ffn_residual_15&#45;&gt;output -->
<g id="edge274" class="edge">
<title>ffn_residual_15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1700,-171.78C1700,-163.34 1700,-154.79 1700,-146.4"/>
<polygon fill="black" stroke="black" points="1703.5,-146.28 1700,-136.28 1696.5,-146.28 1703.5,-146.28"/>
</g>
<!-- pipeline_comm_0&#45;&gt;mha_q_8 -->
<g id="edge138" class="edge">
<title>pipeline_comm_0&#45;&gt;mha_q_8</title>
<path fill="none" stroke="black" d="M1554.49,-9708.03C1464.5,-9701.57 1362.7,-9690.99 1271,-9673.66 1234.86,-9666.84 1196.13,-9656.28 1161.69,-9645.7"/>
<polygon fill="black" stroke="black" points="1162.68,-9642.35 1152.09,-9642.72 1160.61,-9649.03 1162.68,-9642.35"/>
</g>
<!-- pipeline_comm_0&#45;&gt;mha_k_8 -->
<g id="edge139" class="edge">
<title>pipeline_comm_0&#45;&gt;mha_k_8</title>
<path fill="none" stroke="black" d="M1841.26,-9681.72C1851.04,-9671.61 1861.71,-9660.58 1871.71,-9650.26"/>
<polygon fill="black" stroke="black" points="1874.4,-9652.51 1878.84,-9642.89 1869.37,-9647.64 1874.4,-9652.51"/>
</g>
<!-- pipeline_comm_0&#45;&gt;mha_v_8 -->
<g id="edge140" class="edge">
<title>pipeline_comm_0&#45;&gt;mha_v_8</title>
<path fill="none" stroke="black" d="M1705.88,-9684.41C1669.7,-9672.22 1628.71,-9658.41 1591.89,-9646.01"/>
<polygon fill="black" stroke="black" points="1592.72,-9642.6 1582.12,-9642.72 1590.48,-9649.23 1592.72,-9642.6"/>
</g>
<!-- pipeline_comm_0&#45;&gt;attn_residual_8 -->
<g id="edge147" class="edge">
<title>pipeline_comm_0&#45;&gt;attn_residual_8</title>
<path fill="none" stroke="black" d="M2026.44,-9698.69C2068.77,-9692.33 2105.86,-9684.11 2125,-9673.66 2209.07,-9627.76 2260,-9601.45 2260,-9505.66 2260,-9505.66 2260,-9505.66 2260,-9399.66 2260,-9307.56 2196.24,-9245.24 2113.41,-9203.13"/>
<polygon fill="black" stroke="black" points="2114.8,-9199.91 2104.28,-9198.61 2111.69,-9206.18 2114.8,-9199.91"/>
</g>
<!-- attn_v_0 -->
<g id="node201" class="node">
<title>attn_v_0</title>
<ellipse fill="none" stroke="black" cx="2290" cy="-19125.28" rx="50.09" ry="18"/>
<text text-anchor="middle" x="2290" y="-19121.58" font-family="Times,serif" font-size="14.00">attn_v_0</text>
</g>
<!-- attn_v_0&#45;&gt;attn_out_0 -->
<g id="edge6" class="edge">
<title>attn_v_0&#45;&gt;attn_out_0</title>
<path fill="none" stroke="black" d="M2268.3,-19109.04C2258.27,-19102.66 2245.96,-19095.71 2234,-19091.28 2177.88,-19070.51 2114.81,-19055.88 2056.13,-19045.61"/>
<polygon fill="black" stroke="black" points="2056.44,-19042.11 2045.99,-19043.87 2055.25,-19049.01 2056.44,-19042.11"/>
</g>
<!-- attn_v_1 -->
<g id="node202" class="node">
<title>attn_v_1</title>
<ellipse fill="none" stroke="black" cx="2290" cy="-17936.95" rx="50.09" ry="18"/>
<text text-anchor="middle" x="2290" y="-17933.25" font-family="Times,serif" font-size="14.00">attn_v_1</text>
</g>
<!-- attn_v_1&#45;&gt;attn_out_1 -->
<g id="edge23" class="edge">
<title>attn_v_1&#45;&gt;attn_out_1</title>
<path fill="none" stroke="black" d="M2268.3,-17920.71C2258.27,-17914.32 2245.96,-17907.38 2234,-17902.95 2177.88,-17882.18 2114.81,-17867.54 2056.13,-17857.28"/>
<polygon fill="black" stroke="black" points="2056.44,-17853.78 2045.99,-17855.54 2055.25,-17860.68 2056.44,-17853.78"/>
</g>
<!-- attn_v_2 -->
<g id="node203" class="node">
<title>attn_v_2</title>
<ellipse fill="none" stroke="black" cx="2290" cy="-16748.62" rx="50.09" ry="18"/>
<text text-anchor="middle" x="2290" y="-16744.92" font-family="Times,serif" font-size="14.00">attn_v_2</text>
</g>
<!-- attn_v_2&#45;&gt;attn_out_2 -->
<g id="edge40" class="edge">
<title>attn_v_2&#45;&gt;attn_out_2</title>
<path fill="none" stroke="black" d="M2268.3,-16732.37C2258.27,-16725.99 2245.96,-16719.04 2234,-16714.62 2177.88,-16693.85 2114.81,-16679.21 2056.13,-16668.94"/>
<polygon fill="black" stroke="black" points="2056.44,-16665.44 2045.99,-16667.2 2055.25,-16672.34 2056.44,-16665.44"/>
</g>
<!-- attn_v_3 -->
<g id="node204" class="node">
<title>attn_v_3</title>
<ellipse fill="none" stroke="black" cx="2290" cy="-15560.28" rx="50.09" ry="18"/>
<text text-anchor="middle" x="2290" y="-15556.58" font-family="Times,serif" font-size="14.00">attn_v_3</text>
</g>
<!-- attn_v_3&#45;&gt;attn_out_3 -->
<g id="edge57" class="edge">
<title>attn_v_3&#45;&gt;attn_out_3</title>
<path fill="none" stroke="black" d="M2268.3,-15544.04C2258.27,-15537.66 2245.96,-15530.71 2234,-15526.28 2177.88,-15505.51 2114.81,-15490.88 2056.13,-15480.61"/>
<polygon fill="black" stroke="black" points="2056.44,-15477.11 2045.99,-15478.87 2055.25,-15484.01 2056.44,-15477.11"/>
</g>
<!-- attn_v_4 -->
<g id="node205" class="node">
<title>attn_v_4</title>
<ellipse fill="none" stroke="black" cx="2290" cy="-14371.95" rx="50.09" ry="18"/>
<text text-anchor="middle" x="2290" y="-14368.25" font-family="Times,serif" font-size="14.00">attn_v_4</text>
</g>
<!-- attn_v_4&#45;&gt;attn_out_4 -->
<g id="edge74" class="edge">
<title>attn_v_4&#45;&gt;attn_out_4</title>
<path fill="none" stroke="black" d="M2268.3,-14355.71C2258.27,-14349.32 2245.96,-14342.38 2234,-14337.95 2177.88,-14317.18 2114.81,-14302.54 2056.13,-14292.28"/>
<polygon fill="black" stroke="black" points="2056.44,-14288.78 2045.99,-14290.54 2055.25,-14295.68 2056.44,-14288.78"/>
</g>
<!-- attn_v_5 -->
<g id="node206" class="node">
<title>attn_v_5</title>
<ellipse fill="none" stroke="black" cx="2290" cy="-13183.62" rx="50.09" ry="18"/>
<text text-anchor="middle" x="2290" y="-13179.92" font-family="Times,serif" font-size="14.00">attn_v_5</text>
</g>
<!-- attn_v_5&#45;&gt;attn_out_5 -->
<g id="edge91" class="edge">
<title>attn_v_5&#45;&gt;attn_out_5</title>
<path fill="none" stroke="black" d="M2268.3,-13167.37C2258.27,-13160.99 2245.96,-13154.04 2234,-13149.62 2177.88,-13128.85 2114.81,-13114.21 2056.13,-13103.94"/>
<polygon fill="black" stroke="black" points="2056.44,-13100.44 2045.99,-13102.2 2055.25,-13107.34 2056.44,-13100.44"/>
</g>
<!-- attn_v_6 -->
<g id="node207" class="node">
<title>attn_v_6</title>
<ellipse fill="none" stroke="black" cx="2290" cy="-11995.28" rx="50.09" ry="18"/>
<text text-anchor="middle" x="2290" y="-11991.58" font-family="Times,serif" font-size="14.00">attn_v_6</text>
</g>
<!-- attn_v_6&#45;&gt;attn_out_6 -->
<g id="edge108" class="edge">
<title>attn_v_6&#45;&gt;attn_out_6</title>
<path fill="none" stroke="black" d="M2268.3,-11979.04C2258.27,-11972.66 2245.96,-11965.71 2234,-11961.28 2177.88,-11940.51 2114.81,-11925.88 2056.13,-11915.61"/>
<polygon fill="black" stroke="black" points="2056.44,-11912.11 2045.99,-11913.87 2055.25,-11919.01 2056.44,-11912.11"/>
</g>
<!-- attn_v_7 -->
<g id="node208" class="node">
<title>attn_v_7</title>
<ellipse fill="none" stroke="black" cx="2290" cy="-10806.95" rx="50.09" ry="18"/>
<text text-anchor="middle" x="2290" y="-10803.25" font-family="Times,serif" font-size="14.00">attn_v_7</text>
</g>
<!-- attn_v_7&#45;&gt;attn_out_7 -->
<g id="edge125" class="edge">
<title>attn_v_7&#45;&gt;attn_out_7</title>
<path fill="none" stroke="black" d="M2268.3,-10790.71C2258.27,-10784.33 2245.96,-10777.38 2234,-10772.95 2177.88,-10752.18 2114.81,-10737.54 2056.13,-10727.28"/>
<polygon fill="black" stroke="black" points="2056.44,-10723.78 2045.99,-10725.54 2055.25,-10730.68 2056.44,-10723.78"/>
</g>
<!-- attn_v_8 -->
<g id="node209" class="node">
<title>attn_v_8</title>
<ellipse fill="none" stroke="black" cx="2182" cy="-9504.66" rx="50.09" ry="18"/>
<text text-anchor="middle" x="2182" y="-9500.96" font-family="Times,serif" font-size="14.00">attn_v_8</text>
</g>
<!-- attn_v_8&#45;&gt;attn_out_8 -->
<g id="edge143" class="edge">
<title>attn_v_8&#45;&gt;attn_out_8</title>
<path fill="none" stroke="black" d="M2160.53,-9488.3C2150.96,-9482.05 2139.3,-9475.24 2128,-9470.66 2094.91,-9457.26 2058.7,-9446.21 2023.13,-9437.17"/>
<polygon fill="black" stroke="black" points="2023.67,-9433.7 2013.12,-9434.68 2021.98,-9440.49 2023.67,-9433.7"/>
</g>
<!-- attn_v_9 -->
<g id="node210" class="node">
<title>attn_v_9</title>
<ellipse fill="none" stroke="black" cx="2184" cy="-8316.33" rx="50.09" ry="18"/>
<text text-anchor="middle" x="2184" y="-8312.63" font-family="Times,serif" font-size="14.00">attn_v_9</text>
</g>
<!-- attn_v_9&#45;&gt;attn_out_9 -->
<g id="edge160" class="edge">
<title>attn_v_9&#45;&gt;attn_out_9</title>
<path fill="none" stroke="black" d="M2162.3,-8300.09C2152.27,-8293.71 2139.96,-8286.76 2128,-8282.33 2071.88,-8261.56 2008.81,-8246.93 1950.13,-8236.66"/>
<polygon fill="black" stroke="black" points="1950.44,-8233.16 1939.99,-8234.92 1949.25,-8240.06 1950.44,-8233.16"/>
</g>
<!-- attn_v_10 -->
<g id="node211" class="node">
<title>attn_v_10</title>
<ellipse fill="none" stroke="black" cx="2190" cy="-7128" rx="55.79" ry="18"/>
<text text-anchor="middle" x="2190" y="-7124.3" font-family="Times,serif" font-size="14.00">attn_v_10</text>
</g>
<!-- attn_v_10&#45;&gt;attn_out_10 -->
<g id="edge177" class="edge">
<title>attn_v_10&#45;&gt;attn_out_10</title>
<path fill="none" stroke="black" d="M2165.47,-7111.66C2154.39,-7105.33 2140.91,-7098.46 2128,-7094 2071.6,-7074.5 2008.58,-7060.28 1950.04,-7049.99"/>
<polygon fill="black" stroke="black" points="1950.37,-7046.5 1939.92,-7048.25 1949.18,-7053.4 1950.37,-7046.5"/>
</g>
<!-- attn_v_11 -->
<g id="node212" class="node">
<title>attn_v_11</title>
<ellipse fill="none" stroke="black" cx="2190" cy="-5939.67" rx="55.79" ry="18"/>
<text text-anchor="middle" x="2190" y="-5935.97" font-family="Times,serif" font-size="14.00">attn_v_11</text>
</g>
<!-- attn_v_11&#45;&gt;attn_out_11 -->
<g id="edge194" class="edge">
<title>attn_v_11&#45;&gt;attn_out_11</title>
<path fill="none" stroke="black" d="M2165.47,-5923.32C2154.39,-5917 2140.91,-5910.13 2128,-5905.67 2071.6,-5886.17 2008.58,-5871.94 1950.04,-5861.66"/>
<polygon fill="black" stroke="black" points="1950.37,-5858.17 1939.92,-5859.91 1949.18,-5865.06 1950.37,-5858.17"/>
</g>
<!-- attn_v_12 -->
<g id="node213" class="node">
<title>attn_v_12</title>
<ellipse fill="none" stroke="black" cx="2190" cy="-4751.33" rx="55.79" ry="18"/>
<text text-anchor="middle" x="2190" y="-4747.63" font-family="Times,serif" font-size="14.00">attn_v_12</text>
</g>
<!-- attn_v_12&#45;&gt;attn_out_12 -->
<g id="edge211" class="edge">
<title>attn_v_12&#45;&gt;attn_out_12</title>
<path fill="none" stroke="black" d="M2165.47,-4734.99C2154.39,-4728.67 2140.91,-4721.79 2128,-4717.33 2071.6,-4697.84 2008.58,-4683.61 1950.04,-4673.33"/>
<polygon fill="black" stroke="black" points="1950.37,-4669.83 1939.92,-4671.58 1949.18,-4676.73 1950.37,-4669.83"/>
</g>
<!-- attn_v_13 -->
<g id="node214" class="node">
<title>attn_v_13</title>
<ellipse fill="none" stroke="black" cx="2190" cy="-3563" rx="55.79" ry="18"/>
<text text-anchor="middle" x="2190" y="-3559.3" font-family="Times,serif" font-size="14.00">attn_v_13</text>
</g>
<!-- attn_v_13&#45;&gt;attn_out_13 -->
<g id="edge228" class="edge">
<title>attn_v_13&#45;&gt;attn_out_13</title>
<path fill="none" stroke="black" d="M2165.47,-3546.66C2154.39,-3540.33 2140.91,-3533.46 2128,-3529 2071.6,-3509.5 2008.58,-3495.28 1950.04,-3484.99"/>
<polygon fill="black" stroke="black" points="1950.37,-3481.5 1939.92,-3483.25 1949.18,-3488.4 1950.37,-3481.5"/>
</g>
<!-- attn_v_14 -->
<g id="node215" class="node">
<title>attn_v_14</title>
<ellipse fill="none" stroke="black" cx="2190" cy="-2374.67" rx="55.79" ry="18"/>
<text text-anchor="middle" x="2190" y="-2370.97" font-family="Times,serif" font-size="14.00">attn_v_14</text>
</g>
<!-- attn_v_14&#45;&gt;attn_out_14 -->
<g id="edge245" class="edge">
<title>attn_v_14&#45;&gt;attn_out_14</title>
<path fill="none" stroke="black" d="M2165.47,-2358.32C2154.39,-2352 2140.91,-2345.13 2128,-2340.67 2071.6,-2321.17 2008.58,-2306.94 1950.04,-2296.66"/>
<polygon fill="black" stroke="black" points="1950.37,-2293.17 1939.92,-2294.91 1949.18,-2300.06 1950.37,-2293.17"/>
</g>
<!-- attn_v_15 -->
<g id="node216" class="node">
<title>attn_v_15</title>
<ellipse fill="none" stroke="black" cx="2190" cy="-1186.33" rx="55.79" ry="18"/>
<text text-anchor="middle" x="2190" y="-1182.63" font-family="Times,serif" font-size="14.00">attn_v_15</text>
</g>
<!-- attn_v_15&#45;&gt;attn_out_15 -->
<g id="edge262" class="edge">
<title>attn_v_15&#45;&gt;attn_out_15</title>
<path fill="none" stroke="black" d="M2165.47,-1169.99C2154.39,-1163.67 2140.91,-1156.79 2128,-1152.33 2071.6,-1132.84 2008.58,-1118.61 1950.04,-1108.33"/>
<polygon fill="black" stroke="black" points="1950.37,-1104.83 1939.92,-1106.58 1949.18,-1111.73 1950.37,-1104.83"/>
</g>
</g>
</svg>
