<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="332pt" height="1440pt"
 viewBox="0.00 0.00 332.14 1440.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.06 0.06) rotate(0) translate(4 22280.3)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-22280.3 5135.86,-22280.3 5135.86,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_legend</title>
<polygon fill="none" stroke="gray" stroke-dasharray="5,2" points="2681,-22182.3 2681,-22257.3 3581,-22257.3 3581,-22182.3 2681,-22182.3"/>
<text text-anchor="middle" x="3131" y="-22242.1" font-family="Arial" font-size="14.00">Legend</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_gpu0</title>
<path fill="none" stroke="#000000" d="M4025,-20863.3C4025,-20863.3 4873,-20863.3 4873,-20863.3 4879,-20863.3 4885,-20869.3 4885,-20875.3 4885,-20875.3 4885,-22120.3 4885,-22120.3 4885,-22126.3 4879,-22132.3 4873,-22132.3 4873,-22132.3 4025,-22132.3 4025,-22132.3 4019,-22132.3 4013,-22126.3 4013,-22120.3 4013,-22120.3 4013,-20875.3 4013,-20875.3 4013,-20869.3 4019,-20863.3 4025,-20863.3"/>
<text text-anchor="middle" x="4449" y="-22117.1" font-family="Arial" font-size="14.00">GPU&#45;0 (Layer 0)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_gpu1</title>
<path fill="none" stroke="#000000" d="M3758,-19483.35C3758,-19483.35 4606,-19483.35 4606,-19483.35 4612,-19483.35 4618,-19489.35 4618,-19495.35 4618,-19495.35 4618,-20740.35 4618,-20740.35 4618,-20746.35 4612,-20752.35 4606,-20752.35 4606,-20752.35 3758,-20752.35 3758,-20752.35 3752,-20752.35 3746,-20746.35 3746,-20740.35 3746,-20740.35 3746,-19495.35 3746,-19495.35 3746,-19489.35 3752,-19483.35 3758,-19483.35"/>
<text text-anchor="middle" x="4182" y="-20737.15" font-family="Arial" font-size="14.00">GPU&#45;1 (Layer 1)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_gpu2</title>
<path fill="none" stroke="#000000" d="M3491,-18103.39C3491,-18103.39 4339,-18103.39 4339,-18103.39 4345,-18103.39 4351,-18109.39 4351,-18115.39 4351,-18115.39 4351,-19360.39 4351,-19360.39 4351,-19366.39 4345,-19372.39 4339,-19372.39 4339,-19372.39 3491,-19372.39 3491,-19372.39 3485,-19372.39 3479,-19366.39 3479,-19360.39 3479,-19360.39 3479,-18115.39 3479,-18115.39 3479,-18109.39 3485,-18103.39 3491,-18103.39"/>
<text text-anchor="middle" x="3915" y="-19357.19" font-family="Arial" font-size="14.00">GPU&#45;2 (Layer 2)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_gpu3</title>
<path fill="none" stroke="#000000" d="M3224,-16723.44C3224,-16723.44 4072,-16723.44 4072,-16723.44 4078,-16723.44 4084,-16729.44 4084,-16735.44 4084,-16735.44 4084,-17980.44 4084,-17980.44 4084,-17986.44 4078,-17992.44 4072,-17992.44 4072,-17992.44 3224,-17992.44 3224,-17992.44 3218,-17992.44 3212,-17986.44 3212,-17980.44 3212,-17980.44 3212,-16735.44 3212,-16735.44 3212,-16729.44 3218,-16723.44 3224,-16723.44"/>
<text text-anchor="middle" x="3648" y="-17977.24" font-family="Arial" font-size="14.00">GPU&#45;3 (Layer 3)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_gpu4</title>
<path fill="none" stroke="#000000" d="M2957,-15343.49C2957,-15343.49 3805,-15343.49 3805,-15343.49 3811,-15343.49 3817,-15349.49 3817,-15355.49 3817,-15355.49 3817,-16600.49 3817,-16600.49 3817,-16606.49 3811,-16612.49 3805,-16612.49 3805,-16612.49 2957,-16612.49 2957,-16612.49 2951,-16612.49 2945,-16606.49 2945,-16600.49 2945,-16600.49 2945,-15355.49 2945,-15355.49 2945,-15349.49 2951,-15343.49 2957,-15343.49"/>
<text text-anchor="middle" x="3381" y="-16597.29" font-family="Arial" font-size="14.00">GPU&#45;4 (Layer 4)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_gpu5</title>
<path fill="none" stroke="#000000" d="M2690,-13963.53C2690,-13963.53 3538,-13963.53 3538,-13963.53 3544,-13963.53 3550,-13969.53 3550,-13975.53 3550,-13975.53 3550,-15220.53 3550,-15220.53 3550,-15226.53 3544,-15232.53 3538,-15232.53 3538,-15232.53 2690,-15232.53 2690,-15232.53 2684,-15232.53 2678,-15226.53 2678,-15220.53 2678,-15220.53 2678,-13975.53 2678,-13975.53 2678,-13969.53 2684,-13963.53 2690,-13963.53"/>
<text text-anchor="middle" x="3114" y="-15217.33" font-family="Arial" font-size="14.00">GPU&#45;5 (Layer 5)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_gpu6</title>
<path fill="none" stroke="#000000" d="M2423,-12583.58C2423,-12583.58 3271,-12583.58 3271,-12583.58 3277,-12583.58 3283,-12589.58 3283,-12595.58 3283,-12595.58 3283,-13840.58 3283,-13840.58 3283,-13846.58 3277,-13852.58 3271,-13852.58 3271,-13852.58 2423,-13852.58 2423,-13852.58 2417,-13852.58 2411,-13846.58 2411,-13840.58 2411,-13840.58 2411,-12595.58 2411,-12595.58 2411,-12589.58 2417,-12583.58 2423,-12583.58"/>
<text text-anchor="middle" x="2847" y="-13837.38" font-family="Arial" font-size="14.00">GPU&#45;6 (Layer 6)</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_gpu7</title>
<path fill="none" stroke="#000000" d="M2156,-11203.63C2156,-11203.63 3004,-11203.63 3004,-11203.63 3010,-11203.63 3016,-11209.63 3016,-11215.63 3016,-11215.63 3016,-12460.63 3016,-12460.63 3016,-12466.63 3010,-12472.63 3004,-12472.63 3004,-12472.63 2156,-12472.63 2156,-12472.63 2150,-12472.63 2144,-12466.63 2144,-12460.63 2144,-12460.63 2144,-11215.63 2144,-11215.63 2144,-11209.63 2150,-11203.63 2156,-11203.63"/>
<text text-anchor="middle" x="2580" y="-12457.43" font-family="Arial" font-size="14.00">GPU&#45;7 (Layer 7)</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_gpu8</title>
<path fill="none" stroke="#000000" d="M1889,-9823.67C1889,-9823.67 2737,-9823.67 2737,-9823.67 2743,-9823.67 2749,-9829.67 2749,-9835.67 2749,-9835.67 2749,-11080.67 2749,-11080.67 2749,-11086.67 2743,-11092.67 2737,-11092.67 2737,-11092.67 1889,-11092.67 1889,-11092.67 1883,-11092.67 1877,-11086.67 1877,-11080.67 1877,-11080.67 1877,-9835.67 1877,-9835.67 1877,-9829.67 1883,-9823.67 1889,-9823.67"/>
<text text-anchor="middle" x="2313" y="-11077.47" font-family="Arial" font-size="14.00">GPU&#45;8 (Layer 8)</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_gpu9</title>
<path fill="none" stroke="#000000" d="M1622,-8443.72C1622,-8443.72 2470,-8443.72 2470,-8443.72 2476,-8443.72 2482,-8449.72 2482,-8455.72 2482,-8455.72 2482,-9700.72 2482,-9700.72 2482,-9706.72 2476,-9712.72 2470,-9712.72 2470,-9712.72 1622,-9712.72 1622,-9712.72 1616,-9712.72 1610,-9706.72 1610,-9700.72 1610,-9700.72 1610,-8455.72 1610,-8455.72 1610,-8449.72 1616,-8443.72 1622,-8443.72"/>
<text text-anchor="middle" x="2046" y="-9697.52" font-family="Arial" font-size="14.00">GPU&#45;9 (Layer 9)</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_gpu10</title>
<path fill="none" stroke="#000000" d="M1355,-7063.77C1355,-7063.77 2203,-7063.77 2203,-7063.77 2209,-7063.77 2215,-7069.77 2215,-7075.77 2215,-7075.77 2215,-8320.77 2215,-8320.77 2215,-8326.77 2209,-8332.77 2203,-8332.77 2203,-8332.77 1355,-8332.77 1355,-8332.77 1349,-8332.77 1343,-8326.77 1343,-8320.77 1343,-8320.77 1343,-7075.77 1343,-7075.77 1343,-7069.77 1349,-7063.77 1355,-7063.77"/>
<text text-anchor="middle" x="1779" y="-8317.57" font-family="Arial" font-size="14.00">GPU&#45;10 (Layer 10)</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_gpu11</title>
<path fill="none" stroke="#000000" d="M1088,-5683.81C1088,-5683.81 1936,-5683.81 1936,-5683.81 1942,-5683.81 1948,-5689.81 1948,-5695.81 1948,-5695.81 1948,-6940.81 1948,-6940.81 1948,-6946.81 1942,-6952.81 1936,-6952.81 1936,-6952.81 1088,-6952.81 1088,-6952.81 1082,-6952.81 1076,-6946.81 1076,-6940.81 1076,-6940.81 1076,-5695.81 1076,-5695.81 1076,-5689.81 1082,-5683.81 1088,-5683.81"/>
<text text-anchor="middle" x="1512" y="-6937.61" font-family="Arial" font-size="14.00">GPU&#45;11 (Layer 11)</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_gpu12</title>
<path fill="none" stroke="#000000" d="M821,-4303.86C821,-4303.86 1669,-4303.86 1669,-4303.86 1675,-4303.86 1681,-4309.86 1681,-4315.86 1681,-4315.86 1681,-5560.86 1681,-5560.86 1681,-5566.86 1675,-5572.86 1669,-5572.86 1669,-5572.86 821,-5572.86 821,-5572.86 815,-5572.86 809,-5566.86 809,-5560.86 809,-5560.86 809,-4315.86 809,-4315.86 809,-4309.86 815,-4303.86 821,-4303.86"/>
<text text-anchor="middle" x="1245" y="-5557.66" font-family="Arial" font-size="14.00">GPU&#45;12 (Layer 12)</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_gpu13</title>
<path fill="none" stroke="#000000" d="M554,-2923.91C554,-2923.91 1402,-2923.91 1402,-2923.91 1408,-2923.91 1414,-2929.91 1414,-2935.91 1414,-2935.91 1414,-4180.91 1414,-4180.91 1414,-4186.91 1408,-4192.91 1402,-4192.91 1402,-4192.91 554,-4192.91 554,-4192.91 548,-4192.91 542,-4186.91 542,-4180.91 542,-4180.91 542,-2935.91 542,-2935.91 542,-2929.91 548,-2923.91 554,-2923.91"/>
<text text-anchor="middle" x="978" y="-4177.71" font-family="Arial" font-size="14.00">GPU&#45;13 (Layer 13)</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_gpu14</title>
<path fill="none" stroke="#000000" d="M287,-1543.95C287,-1543.95 1135,-1543.95 1135,-1543.95 1141,-1543.95 1147,-1549.95 1147,-1555.95 1147,-1555.95 1147,-2800.95 1147,-2800.95 1147,-2806.95 1141,-2812.95 1135,-2812.95 1135,-2812.95 287,-2812.95 287,-2812.95 281,-2812.95 275,-2806.95 275,-2800.95 275,-2800.95 275,-1555.95 275,-1555.95 275,-1549.95 281,-1543.95 287,-1543.95"/>
<text text-anchor="middle" x="711" y="-2797.75" font-family="Arial" font-size="14.00">GPU&#45;14 (Layer 14)</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_gpu15</title>
<path fill="none" stroke="#000000" d="M20,-164C20,-164 868,-164 868,-164 874,-164 880,-170 880,-176 880,-176 880,-1421 880,-1421 880,-1427 874,-1433 868,-1433 868,-1433 20,-1433 20,-1433 14,-1433 8,-1427 8,-1421 8,-1421 8,-176 8,-176 8,-170 14,-164 20,-164"/>
<text text-anchor="middle" x="444" y="-1417.8" font-family="Arial" font-size="14.00">GPU&#45;15 (Layer 15)</text>
</g>
<!-- legend_compute -->
<g id="node1" class="node">
<title>legend_compute</title>
<polygon fill="lightblue" stroke="lightblue" points="3572.5,-22226.3 3463.5,-22226.3 3463.5,-22190.3 3572.5,-22190.3 3572.5,-22226.3"/>
<text text-anchor="middle" x="3518" y="-22204.6" font-family="Times,serif" font-size="14.00">Computation</text>
</g>
<!-- legend_comm -->
<g id="node2" class="node">
<title>legend_comm</title>
<ellipse fill="lightgreen" stroke="lightgreen" cx="3362" cy="-22208.3" rx="83.39" ry="18"/>
<text text-anchor="middle" x="3362" y="-22204.6" font-family="Times,serif" font-size="14.00">Communication</text>
</g>
<!-- legend_route -->
<g id="node3" class="node">
<title>legend_route</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3261.47,-22226.3 3010.97,-22226.3 2946.53,-22190.3 3197.03,-22190.3 3261.47,-22226.3"/>
<text text-anchor="middle" x="3104" y="-22204.6" font-family="Times,serif" font-size="14.00">Routing/Aggregation</text>
</g>
<!-- legend_split -->
<g id="node4" class="node">
<title>legend_split</title>
<polygon fill="orange" stroke="orange" points="2928.79,-22226.3 2852.76,-22226.3 2833.21,-22190.3 2909.24,-22190.3 2928.79,-22226.3"/>
<text text-anchor="middle" x="2881" y="-22204.6" font-family="Times,serif" font-size="14.00">Split</text>
</g>
<!-- legend_gather -->
<g id="node5" class="node">
<title>legend_gather</title>
<polygon fill="purple" stroke="purple" points="2814.79,-22226.3 2714.91,-22226.3 2689.21,-22190.3 2789.09,-22190.3 2814.79,-22226.3"/>
<text text-anchor="middle" x="2752" y="-22204.6" font-family="Times,serif" font-size="14.00">Gather</text>
</g>
<!-- input -->
<g id="node6" class="node">
<title>input</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5131.73,-22276.3 4554.71,-22276.3 4406.27,-22140.3 4983.29,-22140.3 5131.73,-22276.3"/>
<text text-anchor="middle" x="4769" y="-22227.1" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="4769" y="-22212.1" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4769" y="-22197.1" font-family="Times,serif" font-size="14.00">Device: GPU&#45;0</text>
<text text-anchor="middle" x="4769" y="-22182.1" font-family="Times,serif" font-size="14.00">Layer: Embedding+Pre&#45;process</text>
</g>
<!-- mha_q_0 -->
<g id="node7" class="node">
<title>mha_q_0</title>
<polygon fill="lightblue" stroke="lightblue" points="4857.5,-22101.3 4448.5,-22101.3 4448.5,-22033.3 4857.5,-22033.3 4857.5,-22101.3"/>
<text text-anchor="middle" x="4653" y="-22086.1" font-family="Times,serif" font-size="14.00">GPU0_Layer0_MHA_Q</text>
<text text-anchor="middle" x="4653" y="-22071.1" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4653" y="-22056.1" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4653" y="-22041.1" font-family="Times,serif" font-size="14.00">Device: GPU&#45;0</text>
</g>
<!-- input&#45;&gt;mha_q_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;mha_q_0</title>
<path fill="none" stroke="black" d="M4713.04,-22140.24C4704.26,-22129.72 4695.41,-22119.12 4687.32,-22109.42"/>
<polygon fill="black" stroke="black" points="4689.8,-22106.93 4680.7,-22101.5 4684.42,-22111.42 4689.8,-22106.93"/>
</g>
<!-- mha_k_0 -->
<g id="node8" class="node">
<title>mha_k_0</title>
<polygon fill="lightblue" stroke="lightblue" points="4430.5,-22101.3 4021.5,-22101.3 4021.5,-22033.3 4430.5,-22033.3 4430.5,-22101.3"/>
<text text-anchor="middle" x="4226" y="-22086.1" font-family="Times,serif" font-size="14.00">GPU0_Layer0_MHA_K</text>
<text text-anchor="middle" x="4226" y="-22071.1" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4226" y="-22056.1" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4226" y="-22041.1" font-family="Times,serif" font-size="14.00">Device: GPU&#45;0</text>
</g>
<!-- input&#45;&gt;mha_k_0 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;mha_k_0</title>
<path fill="none" stroke="black" d="M4469.74,-22140.24C4459.36,-22137.61 4449.08,-22134.96 4439,-22132.3 4406.85,-22123.83 4372.24,-22113.82 4340.45,-22104.26"/>
<polygon fill="black" stroke="black" points="4341.27,-22100.85 4330.68,-22101.31 4339.25,-22107.55 4341.27,-22100.85"/>
</g>
<!-- mha_v_0 -->
<g id="node9" class="node">
<title>mha_v_0</title>
<polygon fill="lightblue" stroke="lightblue" points="4876.5,-21989.8 4467.5,-21989.8 4467.5,-21921.8 4876.5,-21921.8 4876.5,-21989.8"/>
<text text-anchor="middle" x="4672" y="-21974.6" font-family="Times,serif" font-size="14.00">GPU0_Layer0_MHA_V</text>
<text text-anchor="middle" x="4672" y="-21959.6" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4672" y="-21944.6" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4672" y="-21929.6" font-family="Times,serif" font-size="14.00">Device: GPU&#45;0</text>
</g>
<!-- input&#45;&gt;mha_v_0 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;mha_v_0</title>
<path fill="none" stroke="black" d="M4862.59,-22140.16C4864.2,-22137.61 4865.67,-22134.99 4867,-22132.3 4886.49,-22092.85 4891.79,-22069.65 4867,-22033.3 4856.18,-22017.44 4841.53,-22004.86 4825.09,-21994.9"/>
<polygon fill="black" stroke="black" points="4826.77,-21991.82 4816.34,-21989.92 4823.3,-21997.91 4826.77,-21991.82"/>
</g>
<!-- attn_residual_0 -->
<g id="node12" class="node">
<title>attn_residual_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4877.11,-21759.3 4280.39,-21759.3 4126.89,-21593.3 4723.61,-21593.3 4877.11,-21759.3"/>
<text text-anchor="middle" x="4502" y="-21702.6" font-family="Times,serif" font-size="14.00">GPU0_Layer0_Attn_Residual</text>
<text text-anchor="middle" x="4502" y="-21687.6" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4502" y="-21672.6" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4502" y="-21657.6" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4502" y="-21642.6" font-family="Times,serif" font-size="14.00">Device: GPU&#45;0</text>
</g>
<!-- input&#45;&gt;attn_residual_0 -->
<g id="edge9" class="edge">
<title>input&#45;&gt;attn_residual_0</title>
<path fill="none" stroke="black" d="M4884.13,-22140.11C4885.88,-22137.59 4887.51,-22134.99 4889,-22132.3 4895.59,-22120.41 4888.81,-21919.69 4886,-21914.3 4852.19,-21849.55 4792.07,-21800.53 4729.29,-21764.36"/>
<polygon fill="black" stroke="black" points="4730.84,-21761.22 4720.41,-21759.35 4727.4,-21767.32 4730.84,-21761.22"/>
</g>
<!-- attn_score_0 -->
<g id="node10" class="node">
<title>attn_score_0</title>
<polygon fill="lightblue" stroke="lightblue" points="4449,-21997.3 4021,-21997.3 4021,-21914.3 4449,-21914.3 4449,-21997.3"/>
<text text-anchor="middle" x="4235" y="-21982.1" font-family="Times,serif" font-size="14.00">GPU0_Layer0_Attn_Score</text>
<text text-anchor="middle" x="4235" y="-21967.1" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4235" y="-21952.1" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4235" y="-21937.1" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="4235" y="-21922.1" font-family="Times,serif" font-size="14.00">Device: GPU&#45;0</text>
</g>
<!-- mha_q_0&#45;&gt;attn_score_0 -->
<g id="edge4" class="edge">
<title>mha_q_0&#45;&gt;attn_score_0</title>
<path fill="none" stroke="black" d="M4527.02,-22033.3C4486.99,-22022.81 4442.11,-22011.05 4399.76,-21999.96"/>
<polygon fill="black" stroke="black" points="4400.48,-21996.53 4389.92,-21997.38 4398.7,-22003.3 4400.48,-21996.53"/>
</g>
<!-- mha_k_0&#45;&gt;attn_score_0 -->
<g id="edge5" class="edge">
<title>mha_k_0&#45;&gt;attn_score_0</title>
<path fill="none" stroke="black" d="M4228.72,-22033.15C4229.39,-22025.1 4230.11,-22016.3 4230.82,-22007.64"/>
<polygon fill="black" stroke="black" points="4234.32,-22007.83 4231.65,-21997.58 4227.34,-22007.26 4234.32,-22007.83"/>
</g>
<!-- attn_out_0 -->
<g id="node11" class="node">
<title>attn_out_0</title>
<polygon fill="lightblue" stroke="lightblue" points="4714.5,-21878.3 4289.5,-21878.3 4289.5,-21795.3 4714.5,-21795.3 4714.5,-21878.3"/>
<text text-anchor="middle" x="4502" y="-21863.1" font-family="Times,serif" font-size="14.00">GPU0_Layer0_Attn_Out</text>
<text text-anchor="middle" x="4502" y="-21848.1" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="4502" y="-21833.1" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4502" y="-21818.1" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4502" y="-21803.1" font-family="Times,serif" font-size="14.00">Device: GPU&#45;0</text>
</g>
<!-- mha_v_0&#45;&gt;attn_out_0 -->
<g id="edge7" class="edge">
<title>mha_v_0&#45;&gt;attn_out_0</title>
<path fill="none" stroke="black" d="M4623.74,-21921.59C4606.8,-21909.93 4587.45,-21896.61 4569.24,-21884.07"/>
<polygon fill="black" stroke="black" points="4571.18,-21881.17 4560.96,-21878.38 4567.22,-21886.93 4571.18,-21881.17"/>
</g>
<!-- attn_score_0&#45;&gt;attn_out_0 -->
<g id="edge6" class="edge">
<title>attn_score_0&#45;&gt;attn_out_0</title>
<path fill="none" stroke="black" d="M4327.63,-21914.21C4351.04,-21903.95 4376.29,-21892.88 4400.12,-21882.44"/>
<polygon fill="black" stroke="black" points="4401.77,-21885.54 4409.53,-21878.32 4398.97,-21879.13 4401.77,-21885.54"/>
</g>
<!-- attn_out_0&#45;&gt;attn_residual_0 -->
<g id="edge8" class="edge">
<title>attn_out_0&#45;&gt;attn_residual_0</title>
<path fill="none" stroke="black" d="M4502,-21794.98C4502,-21787.05 4502,-21778.44 4502,-21769.61"/>
<polygon fill="black" stroke="black" points="4505.5,-21769.57 4502,-21759.57 4498.5,-21769.57 4505.5,-21769.57"/>
</g>
<!-- layernorm1_0 -->
<g id="node13" class="node">
<title>layernorm1_0</title>
<polygon fill="lightblue" stroke="lightblue" points="4714,-21557.3 4352,-21557.3 4352,-21489.3 4714,-21489.3 4714,-21557.3"/>
<text text-anchor="middle" x="4533" y="-21542.1" font-family="Times,serif" font-size="14.00">GPU0_Layer0_LayerNorm1</text>
<text text-anchor="middle" x="4533" y="-21527.1" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4533" y="-21512.1" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4533" y="-21497.1" font-family="Times,serif" font-size="14.00">Device: GPU&#45;0</text>
</g>
<!-- attn_residual_0&#45;&gt;layernorm1_0 -->
<g id="edge10" class="edge">
<title>attn_residual_0&#45;&gt;layernorm1_0</title>
<path fill="none" stroke="black" d="M4518.86,-21593.17C4520.68,-21584.32 4522.47,-21575.59 4524.14,-21567.48"/>
<polygon fill="black" stroke="black" points="4527.59,-21568.06 4526.17,-21557.56 4520.73,-21566.65 4527.59,-21568.06"/>
</g>
<!-- ffn_up_0 -->
<g id="node14" class="node">
<title>ffn_up_0</title>
<polygon fill="lightblue" stroke="lightblue" points="4371,-21453.3 4021,-21453.3 4021,-21385.3 4371,-21385.3 4371,-21453.3"/>
<text text-anchor="middle" x="4196" y="-21438.1" font-family="Times,serif" font-size="14.00">GPU0_Layer0_FFN_Up</text>
<text text-anchor="middle" x="4196" y="-21423.1" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4196" y="-21408.1" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="4196" y="-21393.1" font-family="Times,serif" font-size="14.00">Device: GPU&#45;0</text>
</g>
<!-- layernorm1_0&#45;&gt;ffn_up_0 -->
<g id="edge11" class="edge">
<title>layernorm1_0&#45;&gt;ffn_up_0</title>
<path fill="none" stroke="black" d="M4423.59,-21489.18C4388.89,-21478.68 4350.37,-21467.02 4315.03,-21456.33"/>
<polygon fill="black" stroke="black" points="4315.74,-21452.88 4305.15,-21453.34 4313.71,-21459.58 4315.74,-21452.88"/>
</g>
<!-- ffn_gate_0 -->
<g id="node15" class="node">
<title>ffn_gate_0</title>
<polygon fill="lightblue" stroke="lightblue" points="4739,-21453.3 4389,-21453.3 4389,-21385.3 4739,-21385.3 4739,-21453.3"/>
<text text-anchor="middle" x="4564" y="-21438.1" font-family="Times,serif" font-size="14.00">GPU0_Layer0_FFN_Gate</text>
<text text-anchor="middle" x="4564" y="-21423.1" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4564" y="-21408.1" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="4564" y="-21393.1" font-family="Times,serif" font-size="14.00">Device: GPU&#45;0</text>
</g>
<!-- layernorm1_0&#45;&gt;ffn_gate_0 -->
<g id="edge12" class="edge">
<title>layernorm1_0&#45;&gt;ffn_gate_0</title>
<path fill="none" stroke="black" d="M4543.06,-21489.18C4545.58,-21480.9 4548.32,-21471.89 4550.96,-21463.21"/>
<polygon fill="black" stroke="black" points="4554.32,-21464.18 4553.88,-21453.6 4547.62,-21462.15 4554.32,-21464.18"/>
</g>
<!-- ffn_residual_0 -->
<g id="node18" class="node">
<title>ffn_residual_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4877.11,-21141.3 4280.39,-21141.3 4126.89,-20975.3 4723.61,-20975.3 4877.11,-21141.3"/>
<text text-anchor="middle" x="4502" y="-21084.6" font-family="Times,serif" font-size="14.00">GPU0_Layer0_FFN_Residual</text>
<text text-anchor="middle" x="4502" y="-21069.6" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4502" y="-21054.6" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4502" y="-21039.6" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4502" y="-21024.6" font-family="Times,serif" font-size="14.00">Device: GPU&#45;0</text>
</g>
<!-- layernorm1_0&#45;&gt;ffn_residual_0 -->
<g id="edge17" class="edge">
<title>layernorm1_0&#45;&gt;ffn_residual_0</title>
<path fill="none" stroke="black" d="M4707.21,-21489.19C4723.03,-21479.93 4737.14,-21468.19 4748,-21453.3 4765.81,-21428.88 4751.96,-21415.26 4748,-21385.3 4735.45,-21290.39 4749.1,-21254.15 4692,-21177.3 4684.25,-21166.87 4675.28,-21157.15 4665.54,-21148.13"/>
<polygon fill="black" stroke="black" points="4667.74,-21145.41 4657.95,-21141.37 4663.09,-21150.63 4667.74,-21145.41"/>
</g>
<!-- ffn_act_0 -->
<g id="node16" class="node">
<title>ffn_act_0</title>
<polygon fill="lightblue" stroke="lightblue" points="4672.5,-21349.3 4331.5,-21349.3 4331.5,-21281.3 4672.5,-21281.3 4672.5,-21349.3"/>
<text text-anchor="middle" x="4502" y="-21334.1" font-family="Times,serif" font-size="14.00">GPU0_Layer0_FFN_Act</text>
<text text-anchor="middle" x="4502" y="-21319.1" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="4502" y="-21304.1" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="4502" y="-21289.1" font-family="Times,serif" font-size="14.00">Device: GPU&#45;0</text>
</g>
<!-- ffn_up_0&#45;&gt;ffn_act_0 -->
<g id="edge13" class="edge">
<title>ffn_up_0&#45;&gt;ffn_act_0</title>
<path fill="none" stroke="black" d="M4295.35,-21385.18C4326.58,-21374.77 4361.23,-21363.22 4393.1,-21352.6"/>
<polygon fill="black" stroke="black" points="4394.51,-21355.82 4402.89,-21349.34 4392.29,-21349.18 4394.51,-21355.82"/>
</g>
<!-- ffn_gate_0&#45;&gt;ffn_act_0 -->
<g id="edge14" class="edge">
<title>ffn_gate_0&#45;&gt;ffn_act_0</title>
<path fill="none" stroke="black" d="M4543.87,-21385.18C4538.67,-21376.63 4533.01,-21367.31 4527.57,-21358.37"/>
<polygon fill="black" stroke="black" points="4530.43,-21356.33 4522.24,-21349.6 4524.44,-21359.96 4530.43,-21356.33"/>
</g>
<!-- ffn_down_0 -->
<g id="node17" class="node">
<title>ffn_down_0</title>
<polygon fill="lightblue" stroke="lightblue" points="4683,-21245.3 4321,-21245.3 4321,-21177.3 4683,-21177.3 4683,-21245.3"/>
<text text-anchor="middle" x="4502" y="-21230.1" font-family="Times,serif" font-size="14.00">GPU0_Layer0_FFN_Down</text>
<text text-anchor="middle" x="4502" y="-21215.1" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="4502" y="-21200.1" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4502" y="-21185.1" font-family="Times,serif" font-size="14.00">Device: GPU&#45;0</text>
</g>
<!-- ffn_act_0&#45;&gt;ffn_down_0 -->
<g id="edge15" class="edge">
<title>ffn_act_0&#45;&gt;ffn_down_0</title>
<path fill="none" stroke="black" d="M4502,-21281.18C4502,-21273.08 4502,-21264.28 4502,-21255.77"/>
<polygon fill="black" stroke="black" points="4505.5,-21255.6 4502,-21245.6 4498.5,-21255.6 4505.5,-21255.6"/>
</g>
<!-- ffn_down_0&#45;&gt;ffn_residual_0 -->
<g id="edge16" class="edge">
<title>ffn_down_0&#45;&gt;ffn_residual_0</title>
<path fill="none" stroke="black" d="M4502,-21177.16C4502,-21169.4 4502,-21160.76 4502,-21151.78"/>
<polygon fill="black" stroke="black" points="4505.5,-21151.53 4502,-21141.53 4498.5,-21151.53 4505.5,-21151.53"/>
</g>
<!-- layernorm2_0 -->
<g id="node19" class="node">
<title>layernorm2_0</title>
<polygon fill="lightblue" stroke="lightblue" points="4683,-20939.3 4321,-20939.3 4321,-20871.3 4683,-20871.3 4683,-20939.3"/>
<text text-anchor="middle" x="4502" y="-20924.1" font-family="Times,serif" font-size="14.00">GPU0_Layer0_LayerNorm2</text>
<text text-anchor="middle" x="4502" y="-20909.1" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4502" y="-20894.1" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4502" y="-20879.1" font-family="Times,serif" font-size="14.00">Device: GPU&#45;0</text>
</g>
<!-- ffn_residual_0&#45;&gt;layernorm2_0 -->
<g id="edge18" class="edge">
<title>ffn_residual_0&#45;&gt;layernorm2_0</title>
<path fill="none" stroke="black" d="M4502,-20975.17C4502,-20966.42 4502,-20957.78 4502,-20949.75"/>
<polygon fill="black" stroke="black" points="4505.5,-20949.56 4502,-20939.56 4498.5,-20949.56 4505.5,-20949.56"/>
</g>
<!-- comm_0 -->
<g id="node215" class="node">
<title>comm_0</title>
<ellipse fill="lightgreen" stroke="lightgreen" cx="4502" cy="-20797.82" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="4502" y="-20809.12" font-family="Times,serif" font-size="14.00">GPU0_to_GPU1</text>
<text text-anchor="middle" x="4502" y="-20794.12" font-family="Times,serif" font-size="14.00">Transfer: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4502" y="-20779.12" font-family="Times,serif" font-size="14.00">Bandwidth: NVLink 900GB/s</text>
</g>
<!-- layernorm2_0&#45;&gt;comm_0 -->
<g id="edge19" class="edge">
<title>layernorm2_0&#45;&gt;comm_0</title>
<path fill="none" stroke="black" d="M4502,-20871.22C4502,-20863.05 4502,-20854.16 4502,-20845.48"/>
<polygon fill="black" stroke="black" points="4505.5,-20845.46 4502,-20835.46 4498.5,-20845.46 4505.5,-20845.46"/>
</g>
<!-- mha_q_1 -->
<g id="node20" class="node">
<title>mha_q_1</title>
<polygon fill="lightblue" stroke="lightblue" points="4590.5,-20721.35 4181.5,-20721.35 4181.5,-20653.35 4590.5,-20653.35 4590.5,-20721.35"/>
<text text-anchor="middle" x="4386" y="-20706.15" font-family="Times,serif" font-size="14.00">GPU1_Layer1_MHA_Q</text>
<text text-anchor="middle" x="4386" y="-20691.15" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4386" y="-20676.15" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4386" y="-20661.15" font-family="Times,serif" font-size="14.00">Device: GPU&#45;1</text>
</g>
<!-- attn_score_1 -->
<g id="node23" class="node">
<title>attn_score_1</title>
<polygon fill="lightblue" stroke="lightblue" points="4182,-20617.35 3754,-20617.35 3754,-20534.35 4182,-20534.35 4182,-20617.35"/>
<text text-anchor="middle" x="3968" y="-20602.15" font-family="Times,serif" font-size="14.00">GPU1_Layer1_Attn_Score</text>
<text text-anchor="middle" x="3968" y="-20587.15" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3968" y="-20572.15" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3968" y="-20557.15" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="3968" y="-20542.15" font-family="Times,serif" font-size="14.00">Device: GPU&#45;1</text>
</g>
<!-- mha_q_1&#45;&gt;attn_score_1 -->
<g id="edge23" class="edge">
<title>mha_q_1&#45;&gt;attn_score_1</title>
<path fill="none" stroke="black" d="M4260.02,-20653.34C4219.99,-20642.86 4175.11,-20631.1 4132.76,-20620.01"/>
<polygon fill="black" stroke="black" points="4133.48,-20616.58 4122.92,-20617.43 4131.7,-20623.35 4133.48,-20616.58"/>
</g>
<!-- mha_k_1 -->
<g id="node21" class="node">
<title>mha_k_1</title>
<polygon fill="lightblue" stroke="lightblue" points="4163.5,-20721.35 3754.5,-20721.35 3754.5,-20653.35 4163.5,-20653.35 4163.5,-20721.35"/>
<text text-anchor="middle" x="3959" y="-20706.15" font-family="Times,serif" font-size="14.00">GPU1_Layer1_MHA_K</text>
<text text-anchor="middle" x="3959" y="-20691.15" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3959" y="-20676.15" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3959" y="-20661.15" font-family="Times,serif" font-size="14.00">Device: GPU&#45;1</text>
</g>
<!-- mha_k_1&#45;&gt;attn_score_1 -->
<g id="edge24" class="edge">
<title>mha_k_1&#45;&gt;attn_score_1</title>
<path fill="none" stroke="black" d="M3961.72,-20653.2C3962.39,-20645.14 3963.11,-20636.35 3963.82,-20627.68"/>
<polygon fill="black" stroke="black" points="3967.32,-20627.88 3964.65,-20617.62 3960.34,-20627.3 3967.32,-20627.88"/>
</g>
<!-- mha_v_1 -->
<g id="node22" class="node">
<title>mha_v_1</title>
<polygon fill="lightblue" stroke="lightblue" points="4609.5,-20609.85 4200.5,-20609.85 4200.5,-20541.85 4609.5,-20541.85 4609.5,-20609.85"/>
<text text-anchor="middle" x="4405" y="-20594.65" font-family="Times,serif" font-size="14.00">GPU1_Layer1_MHA_V</text>
<text text-anchor="middle" x="4405" y="-20579.65" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4405" y="-20564.65" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4405" y="-20549.65" font-family="Times,serif" font-size="14.00">Device: GPU&#45;1</text>
</g>
<!-- attn_out_1 -->
<g id="node24" class="node">
<title>attn_out_1</title>
<polygon fill="lightblue" stroke="lightblue" points="4447.5,-20498.35 4022.5,-20498.35 4022.5,-20415.35 4447.5,-20415.35 4447.5,-20498.35"/>
<text text-anchor="middle" x="4235" y="-20483.15" font-family="Times,serif" font-size="14.00">GPU1_Layer1_Attn_Out</text>
<text text-anchor="middle" x="4235" y="-20468.15" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="4235" y="-20453.15" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4235" y="-20438.15" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4235" y="-20423.15" font-family="Times,serif" font-size="14.00">Device: GPU&#45;1</text>
</g>
<!-- mha_v_1&#45;&gt;attn_out_1 -->
<g id="edge26" class="edge">
<title>mha_v_1&#45;&gt;attn_out_1</title>
<path fill="none" stroke="black" d="M4356.74,-20541.63C4339.8,-20529.97 4320.45,-20516.66 4302.24,-20504.12"/>
<polygon fill="black" stroke="black" points="4304.18,-20501.21 4293.96,-20498.43 4300.22,-20506.98 4304.18,-20501.21"/>
</g>
<!-- attn_score_1&#45;&gt;attn_out_1 -->
<g id="edge25" class="edge">
<title>attn_score_1&#45;&gt;attn_out_1</title>
<path fill="none" stroke="black" d="M4060.63,-20534.25C4084.04,-20524 4109.29,-20512.93 4133.12,-20502.49"/>
<polygon fill="black" stroke="black" points="4134.77,-20505.59 4142.53,-20498.37 4131.97,-20499.18 4134.77,-20505.59"/>
</g>
<!-- attn_residual_1 -->
<g id="node25" class="node">
<title>attn_residual_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4610.11,-20379.35 4013.39,-20379.35 3859.89,-20213.35 4456.61,-20213.35 4610.11,-20379.35"/>
<text text-anchor="middle" x="4235" y="-20322.65" font-family="Times,serif" font-size="14.00">GPU1_Layer1_Attn_Residual</text>
<text text-anchor="middle" x="4235" y="-20307.65" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4235" y="-20292.65" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4235" y="-20277.65" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4235" y="-20262.65" font-family="Times,serif" font-size="14.00">Device: GPU&#45;1</text>
</g>
<!-- attn_out_1&#45;&gt;attn_residual_1 -->
<g id="edge27" class="edge">
<title>attn_out_1&#45;&gt;attn_residual_1</title>
<path fill="none" stroke="black" d="M4235,-20415.03C4235,-20407.1 4235,-20398.49 4235,-20389.66"/>
<polygon fill="black" stroke="black" points="4238.5,-20389.62 4235,-20379.62 4231.5,-20389.62 4238.5,-20389.62"/>
</g>
<!-- layernorm1_1 -->
<g id="node26" class="node">
<title>layernorm1_1</title>
<polygon fill="lightblue" stroke="lightblue" points="4447,-20177.35 4085,-20177.35 4085,-20109.35 4447,-20109.35 4447,-20177.35"/>
<text text-anchor="middle" x="4266" y="-20162.15" font-family="Times,serif" font-size="14.00">GPU1_Layer1_LayerNorm1</text>
<text text-anchor="middle" x="4266" y="-20147.15" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4266" y="-20132.15" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4266" y="-20117.15" font-family="Times,serif" font-size="14.00">Device: GPU&#45;1</text>
</g>
<!-- attn_residual_1&#45;&gt;layernorm1_1 -->
<g id="edge29" class="edge">
<title>attn_residual_1&#45;&gt;layernorm1_1</title>
<path fill="none" stroke="black" d="M4251.86,-20213.22C4253.68,-20204.37 4255.47,-20195.64 4257.14,-20187.52"/>
<polygon fill="black" stroke="black" points="4260.59,-20188.11 4259.17,-20177.61 4253.73,-20186.7 4260.59,-20188.11"/>
</g>
<!-- ffn_up_1 -->
<g id="node27" class="node">
<title>ffn_up_1</title>
<polygon fill="lightblue" stroke="lightblue" points="4104,-20073.35 3754,-20073.35 3754,-20005.35 4104,-20005.35 4104,-20073.35"/>
<text text-anchor="middle" x="3929" y="-20058.15" font-family="Times,serif" font-size="14.00">GPU1_Layer1_FFN_Up</text>
<text text-anchor="middle" x="3929" y="-20043.15" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3929" y="-20028.15" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="3929" y="-20013.15" font-family="Times,serif" font-size="14.00">Device: GPU&#45;1</text>
</g>
<!-- layernorm1_1&#45;&gt;ffn_up_1 -->
<g id="edge30" class="edge">
<title>layernorm1_1&#45;&gt;ffn_up_1</title>
<path fill="none" stroke="black" d="M4156.59,-20109.23C4121.89,-20098.73 4083.37,-20087.07 4048.03,-20076.37"/>
<polygon fill="black" stroke="black" points="4048.74,-20072.93 4038.15,-20073.38 4046.71,-20079.63 4048.74,-20072.93"/>
</g>
<!-- ffn_gate_1 -->
<g id="node28" class="node">
<title>ffn_gate_1</title>
<polygon fill="lightblue" stroke="lightblue" points="4472,-20073.35 4122,-20073.35 4122,-20005.35 4472,-20005.35 4472,-20073.35"/>
<text text-anchor="middle" x="4297" y="-20058.15" font-family="Times,serif" font-size="14.00">GPU1_Layer1_FFN_Gate</text>
<text text-anchor="middle" x="4297" y="-20043.15" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4297" y="-20028.15" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="4297" y="-20013.15" font-family="Times,serif" font-size="14.00">Device: GPU&#45;1</text>
</g>
<!-- layernorm1_1&#45;&gt;ffn_gate_1 -->
<g id="edge31" class="edge">
<title>layernorm1_1&#45;&gt;ffn_gate_1</title>
<path fill="none" stroke="black" d="M4276.06,-20109.23C4278.58,-20100.95 4281.32,-20091.94 4283.96,-20083.26"/>
<polygon fill="black" stroke="black" points="4287.32,-20084.23 4286.88,-20073.65 4280.62,-20082.2 4287.32,-20084.23"/>
</g>
<!-- ffn_residual_1 -->
<g id="node31" class="node">
<title>ffn_residual_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4610.11,-19761.35 4013.39,-19761.35 3859.89,-19595.35 4456.61,-19595.35 4610.11,-19761.35"/>
<text text-anchor="middle" x="4235" y="-19704.65" font-family="Times,serif" font-size="14.00">GPU1_Layer1_FFN_Residual</text>
<text text-anchor="middle" x="4235" y="-19689.65" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4235" y="-19674.65" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4235" y="-19659.65" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4235" y="-19644.65" font-family="Times,serif" font-size="14.00">Device: GPU&#45;1</text>
</g>
<!-- layernorm1_1&#45;&gt;ffn_residual_1 -->
<g id="edge36" class="edge">
<title>layernorm1_1&#45;&gt;ffn_residual_1</title>
<path fill="none" stroke="black" d="M4440.21,-20109.24C4456.03,-20099.98 4470.14,-20088.23 4481,-20073.35 4498.81,-20048.93 4484.96,-20035.31 4481,-20005.35 4468.45,-19910.44 4482.1,-19874.19 4425,-19797.35 4417.25,-19786.91 4408.28,-19777.19 4398.54,-19768.18"/>
<polygon fill="black" stroke="black" points="4400.74,-19765.45 4390.95,-19761.42 4396.09,-19770.68 4400.74,-19765.45"/>
</g>
<!-- ffn_act_1 -->
<g id="node29" class="node">
<title>ffn_act_1</title>
<polygon fill="lightblue" stroke="lightblue" points="4405.5,-19969.35 4064.5,-19969.35 4064.5,-19901.35 4405.5,-19901.35 4405.5,-19969.35"/>
<text text-anchor="middle" x="4235" y="-19954.15" font-family="Times,serif" font-size="14.00">GPU1_Layer1_FFN_Act</text>
<text text-anchor="middle" x="4235" y="-19939.15" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="4235" y="-19924.15" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="4235" y="-19909.15" font-family="Times,serif" font-size="14.00">Device: GPU&#45;1</text>
</g>
<!-- ffn_up_1&#45;&gt;ffn_act_1 -->
<g id="edge32" class="edge">
<title>ffn_up_1&#45;&gt;ffn_act_1</title>
<path fill="none" stroke="black" d="M4028.35,-20005.23C4059.58,-19994.82 4094.23,-19983.27 4126.1,-19972.65"/>
<polygon fill="black" stroke="black" points="4127.51,-19975.87 4135.89,-19969.38 4125.29,-19969.23 4127.51,-19975.87"/>
</g>
<!-- ffn_gate_1&#45;&gt;ffn_act_1 -->
<g id="edge33" class="edge">
<title>ffn_gate_1&#45;&gt;ffn_act_1</title>
<path fill="none" stroke="black" d="M4276.87,-20005.23C4271.67,-19996.68 4266.01,-19987.36 4260.57,-19978.42"/>
<polygon fill="black" stroke="black" points="4263.43,-19976.37 4255.24,-19969.65 4257.44,-19980.01 4263.43,-19976.37"/>
</g>
<!-- ffn_down_1 -->
<g id="node30" class="node">
<title>ffn_down_1</title>
<polygon fill="lightblue" stroke="lightblue" points="4416,-19865.35 4054,-19865.35 4054,-19797.35 4416,-19797.35 4416,-19865.35"/>
<text text-anchor="middle" x="4235" y="-19850.15" font-family="Times,serif" font-size="14.00">GPU1_Layer1_FFN_Down</text>
<text text-anchor="middle" x="4235" y="-19835.15" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="4235" y="-19820.15" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4235" y="-19805.15" font-family="Times,serif" font-size="14.00">Device: GPU&#45;1</text>
</g>
<!-- ffn_act_1&#45;&gt;ffn_down_1 -->
<g id="edge34" class="edge">
<title>ffn_act_1&#45;&gt;ffn_down_1</title>
<path fill="none" stroke="black" d="M4235,-19901.23C4235,-19893.12 4235,-19884.33 4235,-19875.82"/>
<polygon fill="black" stroke="black" points="4238.5,-19875.65 4235,-19865.65 4231.5,-19875.65 4238.5,-19875.65"/>
</g>
<!-- ffn_down_1&#45;&gt;ffn_residual_1 -->
<g id="edge35" class="edge">
<title>ffn_down_1&#45;&gt;ffn_residual_1</title>
<path fill="none" stroke="black" d="M4235,-19797.21C4235,-19789.45 4235,-19780.81 4235,-19771.83"/>
<polygon fill="black" stroke="black" points="4238.5,-19771.58 4235,-19761.58 4231.5,-19771.58 4238.5,-19771.58"/>
</g>
<!-- layernorm2_1 -->
<g id="node32" class="node">
<title>layernorm2_1</title>
<polygon fill="lightblue" stroke="lightblue" points="4416,-19559.35 4054,-19559.35 4054,-19491.35 4416,-19491.35 4416,-19559.35"/>
<text text-anchor="middle" x="4235" y="-19544.15" font-family="Times,serif" font-size="14.00">GPU1_Layer1_LayerNorm2</text>
<text text-anchor="middle" x="4235" y="-19529.15" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4235" y="-19514.15" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4235" y="-19499.15" font-family="Times,serif" font-size="14.00">Device: GPU&#45;1</text>
</g>
<!-- ffn_residual_1&#45;&gt;layernorm2_1 -->
<g id="edge37" class="edge">
<title>ffn_residual_1&#45;&gt;layernorm2_1</title>
<path fill="none" stroke="black" d="M4235,-19595.22C4235,-19586.46 4235,-19577.83 4235,-19569.79"/>
<polygon fill="black" stroke="black" points="4238.5,-19569.61 4235,-19559.61 4231.5,-19569.61 4238.5,-19569.61"/>
</g>
<!-- comm_1 -->
<g id="node216" class="node">
<title>comm_1</title>
<ellipse fill="lightgreen" stroke="lightgreen" cx="4235" cy="-19417.87" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="4235" y="-19429.17" font-family="Times,serif" font-size="14.00">GPU1_to_GPU2</text>
<text text-anchor="middle" x="4235" y="-19414.17" font-family="Times,serif" font-size="14.00">Transfer: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4235" y="-19399.17" font-family="Times,serif" font-size="14.00">Bandwidth: NVLink 900GB/s</text>
</g>
<!-- layernorm2_1&#45;&gt;comm_1 -->
<g id="edge38" class="edge">
<title>layernorm2_1&#45;&gt;comm_1</title>
<path fill="none" stroke="black" d="M4235,-19491.26C4235,-19483.1 4235,-19474.2 4235,-19465.53"/>
<polygon fill="black" stroke="black" points="4238.5,-19465.5 4235,-19455.5 4231.5,-19465.5 4238.5,-19465.5"/>
</g>
<!-- mha_q_2 -->
<g id="node33" class="node">
<title>mha_q_2</title>
<polygon fill="lightblue" stroke="lightblue" points="4323.5,-19341.39 3914.5,-19341.39 3914.5,-19273.39 4323.5,-19273.39 4323.5,-19341.39"/>
<text text-anchor="middle" x="4119" y="-19326.19" font-family="Times,serif" font-size="14.00">GPU2_Layer2_MHA_Q</text>
<text text-anchor="middle" x="4119" y="-19311.19" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4119" y="-19296.19" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4119" y="-19281.19" font-family="Times,serif" font-size="14.00">Device: GPU&#45;2</text>
</g>
<!-- attn_score_2 -->
<g id="node36" class="node">
<title>attn_score_2</title>
<polygon fill="lightblue" stroke="lightblue" points="3915,-19237.39 3487,-19237.39 3487,-19154.39 3915,-19154.39 3915,-19237.39"/>
<text text-anchor="middle" x="3701" y="-19222.19" font-family="Times,serif" font-size="14.00">GPU2_Layer2_Attn_Score</text>
<text text-anchor="middle" x="3701" y="-19207.19" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3701" y="-19192.19" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3701" y="-19177.19" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="3701" y="-19162.19" font-family="Times,serif" font-size="14.00">Device: GPU&#45;2</text>
</g>
<!-- mha_q_2&#45;&gt;attn_score_2 -->
<g id="edge42" class="edge">
<title>mha_q_2&#45;&gt;attn_score_2</title>
<path fill="none" stroke="black" d="M3993.02,-19273.39C3952.99,-19262.9 3908.11,-19251.15 3865.76,-19240.05"/>
<polygon fill="black" stroke="black" points="3866.48,-19236.62 3855.92,-19237.48 3864.7,-19243.4 3866.48,-19236.62"/>
</g>
<!-- mha_k_2 -->
<g id="node34" class="node">
<title>mha_k_2</title>
<polygon fill="lightblue" stroke="lightblue" points="3896.5,-19341.39 3487.5,-19341.39 3487.5,-19273.39 3896.5,-19273.39 3896.5,-19341.39"/>
<text text-anchor="middle" x="3692" y="-19326.19" font-family="Times,serif" font-size="14.00">GPU2_Layer2_MHA_K</text>
<text text-anchor="middle" x="3692" y="-19311.19" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3692" y="-19296.19" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3692" y="-19281.19" font-family="Times,serif" font-size="14.00">Device: GPU&#45;2</text>
</g>
<!-- mha_k_2&#45;&gt;attn_score_2 -->
<g id="edge43" class="edge">
<title>mha_k_2&#45;&gt;attn_score_2</title>
<path fill="none" stroke="black" d="M3694.72,-19273.24C3695.39,-19265.19 3696.11,-19256.39 3696.82,-19247.73"/>
<polygon fill="black" stroke="black" points="3700.32,-19247.92 3697.65,-19237.67 3693.34,-19247.35 3700.32,-19247.92"/>
</g>
<!-- mha_v_2 -->
<g id="node35" class="node">
<title>mha_v_2</title>
<polygon fill="lightblue" stroke="lightblue" points="4342.5,-19229.89 3933.5,-19229.89 3933.5,-19161.89 4342.5,-19161.89 4342.5,-19229.89"/>
<text text-anchor="middle" x="4138" y="-19214.69" font-family="Times,serif" font-size="14.00">GPU2_Layer2_MHA_V</text>
<text text-anchor="middle" x="4138" y="-19199.69" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4138" y="-19184.69" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4138" y="-19169.69" font-family="Times,serif" font-size="14.00">Device: GPU&#45;2</text>
</g>
<!-- attn_out_2 -->
<g id="node37" class="node">
<title>attn_out_2</title>
<polygon fill="lightblue" stroke="lightblue" points="4180.5,-19118.39 3755.5,-19118.39 3755.5,-19035.39 4180.5,-19035.39 4180.5,-19118.39"/>
<text text-anchor="middle" x="3968" y="-19103.19" font-family="Times,serif" font-size="14.00">GPU2_Layer2_Attn_Out</text>
<text text-anchor="middle" x="3968" y="-19088.19" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="3968" y="-19073.19" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3968" y="-19058.19" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3968" y="-19043.19" font-family="Times,serif" font-size="14.00">Device: GPU&#45;2</text>
</g>
<!-- mha_v_2&#45;&gt;attn_out_2 -->
<g id="edge45" class="edge">
<title>mha_v_2&#45;&gt;attn_out_2</title>
<path fill="none" stroke="black" d="M4089.74,-19161.68C4072.8,-19150.02 4053.45,-19136.7 4035.24,-19124.17"/>
<polygon fill="black" stroke="black" points="4037.18,-19121.26 4026.96,-19118.47 4033.22,-19127.03 4037.18,-19121.26"/>
</g>
<!-- attn_score_2&#45;&gt;attn_out_2 -->
<g id="edge44" class="edge">
<title>attn_score_2&#45;&gt;attn_out_2</title>
<path fill="none" stroke="black" d="M3793.63,-19154.3C3817.04,-19144.05 3842.29,-19132.98 3866.12,-19122.54"/>
<polygon fill="black" stroke="black" points="3867.77,-19125.63 3875.53,-19118.41 3864.97,-19119.22 3867.77,-19125.63"/>
</g>
<!-- attn_residual_2 -->
<g id="node38" class="node">
<title>attn_residual_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4343.11,-18999.39 3746.39,-18999.39 3592.89,-18833.39 4189.61,-18833.39 4343.11,-18999.39"/>
<text text-anchor="middle" x="3968" y="-18942.69" font-family="Times,serif" font-size="14.00">GPU2_Layer2_Attn_Residual</text>
<text text-anchor="middle" x="3968" y="-18927.69" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3968" y="-18912.69" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3968" y="-18897.69" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3968" y="-18882.69" font-family="Times,serif" font-size="14.00">Device: GPU&#45;2</text>
</g>
<!-- attn_out_2&#45;&gt;attn_residual_2 -->
<g id="edge46" class="edge">
<title>attn_out_2&#45;&gt;attn_residual_2</title>
<path fill="none" stroke="black" d="M3968,-19035.08C3968,-19027.14 3968,-19018.54 3968,-19009.71"/>
<polygon fill="black" stroke="black" points="3971.5,-19009.67 3968,-18999.67 3964.5,-19009.67 3971.5,-19009.67"/>
</g>
<!-- layernorm1_2 -->
<g id="node39" class="node">
<title>layernorm1_2</title>
<polygon fill="lightblue" stroke="lightblue" points="4180,-18797.39 3818,-18797.39 3818,-18729.39 4180,-18729.39 4180,-18797.39"/>
<text text-anchor="middle" x="3999" y="-18782.19" font-family="Times,serif" font-size="14.00">GPU2_Layer2_LayerNorm1</text>
<text text-anchor="middle" x="3999" y="-18767.19" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3999" y="-18752.19" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3999" y="-18737.19" font-family="Times,serif" font-size="14.00">Device: GPU&#45;2</text>
</g>
<!-- attn_residual_2&#45;&gt;layernorm1_2 -->
<g id="edge48" class="edge">
<title>attn_residual_2&#45;&gt;layernorm1_2</title>
<path fill="none" stroke="black" d="M3984.86,-18833.26C3986.68,-18824.41 3988.47,-18815.68 3990.14,-18807.57"/>
<polygon fill="black" stroke="black" points="3993.59,-18808.15 3992.17,-18797.65 3986.73,-18806.75 3993.59,-18808.15"/>
</g>
<!-- ffn_up_2 -->
<g id="node40" class="node">
<title>ffn_up_2</title>
<polygon fill="lightblue" stroke="lightblue" points="3837,-18693.39 3487,-18693.39 3487,-18625.39 3837,-18625.39 3837,-18693.39"/>
<text text-anchor="middle" x="3662" y="-18678.19" font-family="Times,serif" font-size="14.00">GPU2_Layer2_FFN_Up</text>
<text text-anchor="middle" x="3662" y="-18663.19" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3662" y="-18648.19" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="3662" y="-18633.19" font-family="Times,serif" font-size="14.00">Device: GPU&#45;2</text>
</g>
<!-- layernorm1_2&#45;&gt;ffn_up_2 -->
<g id="edge49" class="edge">
<title>layernorm1_2&#45;&gt;ffn_up_2</title>
<path fill="none" stroke="black" d="M3889.59,-18729.28C3854.89,-18718.78 3816.37,-18707.12 3781.03,-18696.42"/>
<polygon fill="black" stroke="black" points="3781.74,-18692.98 3771.15,-18693.43 3779.71,-18699.68 3781.74,-18692.98"/>
</g>
<!-- ffn_gate_2 -->
<g id="node41" class="node">
<title>ffn_gate_2</title>
<polygon fill="lightblue" stroke="lightblue" points="4205,-18693.39 3855,-18693.39 3855,-18625.39 4205,-18625.39 4205,-18693.39"/>
<text text-anchor="middle" x="4030" y="-18678.19" font-family="Times,serif" font-size="14.00">GPU2_Layer2_FFN_Gate</text>
<text text-anchor="middle" x="4030" y="-18663.19" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="4030" y="-18648.19" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="4030" y="-18633.19" font-family="Times,serif" font-size="14.00">Device: GPU&#45;2</text>
</g>
<!-- layernorm1_2&#45;&gt;ffn_gate_2 -->
<g id="edge50" class="edge">
<title>layernorm1_2&#45;&gt;ffn_gate_2</title>
<path fill="none" stroke="black" d="M4009.06,-18729.28C4011.58,-18720.99 4014.32,-18711.99 4016.96,-18703.3"/>
<polygon fill="black" stroke="black" points="4020.32,-18704.28 4019.88,-18693.69 4013.62,-18702.24 4020.32,-18704.28"/>
</g>
<!-- ffn_residual_2 -->
<g id="node44" class="node">
<title>ffn_residual_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4343.11,-18381.39 3746.39,-18381.39 3592.89,-18215.39 4189.61,-18215.39 4343.11,-18381.39"/>
<text text-anchor="middle" x="3968" y="-18324.69" font-family="Times,serif" font-size="14.00">GPU2_Layer2_FFN_Residual</text>
<text text-anchor="middle" x="3968" y="-18309.69" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3968" y="-18294.69" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3968" y="-18279.69" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3968" y="-18264.69" font-family="Times,serif" font-size="14.00">Device: GPU&#45;2</text>
</g>
<!-- layernorm1_2&#45;&gt;ffn_residual_2 -->
<g id="edge55" class="edge">
<title>layernorm1_2&#45;&gt;ffn_residual_2</title>
<path fill="none" stroke="black" d="M4173.21,-18729.28C4189.03,-18720.03 4203.14,-18708.28 4214,-18693.39 4231.81,-18668.97 4217.96,-18655.35 4214,-18625.39 4201.45,-18530.48 4215.1,-18494.24 4158,-18417.39 4150.25,-18406.96 4141.28,-18397.24 4131.54,-18388.22"/>
<polygon fill="black" stroke="black" points="4133.74,-18385.5 4123.95,-18381.46 4129.09,-18390.73 4133.74,-18385.5"/>
</g>
<!-- ffn_act_2 -->
<g id="node42" class="node">
<title>ffn_act_2</title>
<polygon fill="lightblue" stroke="lightblue" points="4138.5,-18589.39 3797.5,-18589.39 3797.5,-18521.39 4138.5,-18521.39 4138.5,-18589.39"/>
<text text-anchor="middle" x="3968" y="-18574.19" font-family="Times,serif" font-size="14.00">GPU2_Layer2_FFN_Act</text>
<text text-anchor="middle" x="3968" y="-18559.19" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="3968" y="-18544.19" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="3968" y="-18529.19" font-family="Times,serif" font-size="14.00">Device: GPU&#45;2</text>
</g>
<!-- ffn_up_2&#45;&gt;ffn_act_2 -->
<g id="edge51" class="edge">
<title>ffn_up_2&#45;&gt;ffn_act_2</title>
<path fill="none" stroke="black" d="M3761.35,-18625.28C3792.58,-18614.87 3827.23,-18603.31 3859.1,-18592.69"/>
<polygon fill="black" stroke="black" points="3860.51,-18595.91 3868.89,-18589.43 3858.29,-18589.27 3860.51,-18595.91"/>
</g>
<!-- ffn_gate_2&#45;&gt;ffn_act_2 -->
<g id="edge52" class="edge">
<title>ffn_gate_2&#45;&gt;ffn_act_2</title>
<path fill="none" stroke="black" d="M4009.87,-18625.28C4004.67,-18616.73 3999.01,-18607.41 3993.57,-18598.47"/>
<polygon fill="black" stroke="black" points="3996.43,-18596.42 3988.24,-18589.69 3990.44,-18600.06 3996.43,-18596.42"/>
</g>
<!-- ffn_down_2 -->
<g id="node43" class="node">
<title>ffn_down_2</title>
<polygon fill="lightblue" stroke="lightblue" points="4149,-18485.39 3787,-18485.39 3787,-18417.39 4149,-18417.39 4149,-18485.39"/>
<text text-anchor="middle" x="3968" y="-18470.19" font-family="Times,serif" font-size="14.00">GPU2_Layer2_FFN_Down</text>
<text text-anchor="middle" x="3968" y="-18455.19" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="3968" y="-18440.19" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3968" y="-18425.19" font-family="Times,serif" font-size="14.00">Device: GPU&#45;2</text>
</g>
<!-- ffn_act_2&#45;&gt;ffn_down_2 -->
<g id="edge53" class="edge">
<title>ffn_act_2&#45;&gt;ffn_down_2</title>
<path fill="none" stroke="black" d="M3968,-18521.28C3968,-18513.17 3968,-18504.38 3968,-18495.87"/>
<polygon fill="black" stroke="black" points="3971.5,-18495.69 3968,-18485.69 3964.5,-18495.69 3971.5,-18495.69"/>
</g>
<!-- ffn_down_2&#45;&gt;ffn_residual_2 -->
<g id="edge54" class="edge">
<title>ffn_down_2&#45;&gt;ffn_residual_2</title>
<path fill="none" stroke="black" d="M3968,-18417.26C3968,-18409.5 3968,-18400.86 3968,-18391.88"/>
<polygon fill="black" stroke="black" points="3971.5,-18391.63 3968,-18381.63 3964.5,-18391.63 3971.5,-18391.63"/>
</g>
<!-- layernorm2_2 -->
<g id="node45" class="node">
<title>layernorm2_2</title>
<polygon fill="lightblue" stroke="lightblue" points="4149,-18179.39 3787,-18179.39 3787,-18111.39 4149,-18111.39 4149,-18179.39"/>
<text text-anchor="middle" x="3968" y="-18164.19" font-family="Times,serif" font-size="14.00">GPU2_Layer2_LayerNorm2</text>
<text text-anchor="middle" x="3968" y="-18149.19" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3968" y="-18134.19" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3968" y="-18119.19" font-family="Times,serif" font-size="14.00">Device: GPU&#45;2</text>
</g>
<!-- ffn_residual_2&#45;&gt;layernorm2_2 -->
<g id="edge56" class="edge">
<title>ffn_residual_2&#45;&gt;layernorm2_2</title>
<path fill="none" stroke="black" d="M3968,-18215.26C3968,-18206.51 3968,-18197.88 3968,-18189.84"/>
<polygon fill="black" stroke="black" points="3971.5,-18189.65 3968,-18179.65 3964.5,-18189.65 3971.5,-18189.65"/>
</g>
<!-- comm_2 -->
<g id="node217" class="node">
<title>comm_2</title>
<ellipse fill="lightgreen" stroke="lightgreen" cx="3968" cy="-18037.92" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="3968" y="-18049.22" font-family="Times,serif" font-size="14.00">GPU2_to_GPU3</text>
<text text-anchor="middle" x="3968" y="-18034.22" font-family="Times,serif" font-size="14.00">Transfer: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3968" y="-18019.22" font-family="Times,serif" font-size="14.00">Bandwidth: NVLink 900GB/s</text>
</g>
<!-- layernorm2_2&#45;&gt;comm_2 -->
<g id="edge57" class="edge">
<title>layernorm2_2&#45;&gt;comm_2</title>
<path fill="none" stroke="black" d="M3968,-18111.31C3968,-18103.15 3968,-18094.25 3968,-18085.57"/>
<polygon fill="black" stroke="black" points="3971.5,-18085.55 3968,-18075.55 3964.5,-18085.55 3971.5,-18085.55"/>
</g>
<!-- mha_q_3 -->
<g id="node46" class="node">
<title>mha_q_3</title>
<polygon fill="lightblue" stroke="lightblue" points="4056.5,-17961.44 3647.5,-17961.44 3647.5,-17893.44 4056.5,-17893.44 4056.5,-17961.44"/>
<text text-anchor="middle" x="3852" y="-17946.24" font-family="Times,serif" font-size="14.00">GPU3_Layer3_MHA_Q</text>
<text text-anchor="middle" x="3852" y="-17931.24" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3852" y="-17916.24" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3852" y="-17901.24" font-family="Times,serif" font-size="14.00">Device: GPU&#45;3</text>
</g>
<!-- attn_score_3 -->
<g id="node49" class="node">
<title>attn_score_3</title>
<polygon fill="lightblue" stroke="lightblue" points="3648,-17857.44 3220,-17857.44 3220,-17774.44 3648,-17774.44 3648,-17857.44"/>
<text text-anchor="middle" x="3434" y="-17842.24" font-family="Times,serif" font-size="14.00">GPU3_Layer3_Attn_Score</text>
<text text-anchor="middle" x="3434" y="-17827.24" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3434" y="-17812.24" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3434" y="-17797.24" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="3434" y="-17782.24" font-family="Times,serif" font-size="14.00">Device: GPU&#45;3</text>
</g>
<!-- mha_q_3&#45;&gt;attn_score_3 -->
<g id="edge61" class="edge">
<title>mha_q_3&#45;&gt;attn_score_3</title>
<path fill="none" stroke="black" d="M3726.02,-17893.44C3685.99,-17882.95 3641.11,-17871.19 3598.76,-17860.1"/>
<polygon fill="black" stroke="black" points="3599.48,-17856.67 3588.92,-17857.52 3597.7,-17863.44 3599.48,-17856.67"/>
</g>
<!-- mha_k_3 -->
<g id="node47" class="node">
<title>mha_k_3</title>
<polygon fill="lightblue" stroke="lightblue" points="3629.5,-17961.44 3220.5,-17961.44 3220.5,-17893.44 3629.5,-17893.44 3629.5,-17961.44"/>
<text text-anchor="middle" x="3425" y="-17946.24" font-family="Times,serif" font-size="14.00">GPU3_Layer3_MHA_K</text>
<text text-anchor="middle" x="3425" y="-17931.24" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3425" y="-17916.24" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3425" y="-17901.24" font-family="Times,serif" font-size="14.00">Device: GPU&#45;3</text>
</g>
<!-- mha_k_3&#45;&gt;attn_score_3 -->
<g id="edge62" class="edge">
<title>mha_k_3&#45;&gt;attn_score_3</title>
<path fill="none" stroke="black" d="M3427.72,-17893.29C3428.39,-17885.24 3429.11,-17876.44 3429.82,-17867.78"/>
<polygon fill="black" stroke="black" points="3433.32,-17867.97 3430.65,-17857.72 3426.34,-17867.4 3433.32,-17867.97"/>
</g>
<!-- mha_v_3 -->
<g id="node48" class="node">
<title>mha_v_3</title>
<polygon fill="lightblue" stroke="lightblue" points="4075.5,-17849.94 3666.5,-17849.94 3666.5,-17781.94 4075.5,-17781.94 4075.5,-17849.94"/>
<text text-anchor="middle" x="3871" y="-17834.74" font-family="Times,serif" font-size="14.00">GPU3_Layer3_MHA_V</text>
<text text-anchor="middle" x="3871" y="-17819.74" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3871" y="-17804.74" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3871" y="-17789.74" font-family="Times,serif" font-size="14.00">Device: GPU&#45;3</text>
</g>
<!-- attn_out_3 -->
<g id="node50" class="node">
<title>attn_out_3</title>
<polygon fill="lightblue" stroke="lightblue" points="3913.5,-17738.44 3488.5,-17738.44 3488.5,-17655.44 3913.5,-17655.44 3913.5,-17738.44"/>
<text text-anchor="middle" x="3701" y="-17723.24" font-family="Times,serif" font-size="14.00">GPU3_Layer3_Attn_Out</text>
<text text-anchor="middle" x="3701" y="-17708.24" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="3701" y="-17693.24" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3701" y="-17678.24" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3701" y="-17663.24" font-family="Times,serif" font-size="14.00">Device: GPU&#45;3</text>
</g>
<!-- mha_v_3&#45;&gt;attn_out_3 -->
<g id="edge64" class="edge">
<title>mha_v_3&#45;&gt;attn_out_3</title>
<path fill="none" stroke="black" d="M3822.74,-17781.73C3805.8,-17770.07 3786.45,-17756.75 3768.24,-17744.21"/>
<polygon fill="black" stroke="black" points="3770.18,-17741.31 3759.96,-17738.52 3766.22,-17747.07 3770.18,-17741.31"/>
</g>
<!-- attn_score_3&#45;&gt;attn_out_3 -->
<g id="edge63" class="edge">
<title>attn_score_3&#45;&gt;attn_out_3</title>
<path fill="none" stroke="black" d="M3526.63,-17774.35C3550.04,-17764.09 3575.29,-17753.03 3599.12,-17742.58"/>
<polygon fill="black" stroke="black" points="3600.77,-17745.68 3608.53,-17738.46 3597.97,-17739.27 3600.77,-17745.68"/>
</g>
<!-- attn_residual_3 -->
<g id="node51" class="node">
<title>attn_residual_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4076.11,-17619.44 3479.39,-17619.44 3325.89,-17453.44 3922.61,-17453.44 4076.11,-17619.44"/>
<text text-anchor="middle" x="3701" y="-17562.74" font-family="Times,serif" font-size="14.00">GPU3_Layer3_Attn_Residual</text>
<text text-anchor="middle" x="3701" y="-17547.74" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3701" y="-17532.74" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3701" y="-17517.74" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3701" y="-17502.74" font-family="Times,serif" font-size="14.00">Device: GPU&#45;3</text>
</g>
<!-- attn_out_3&#45;&gt;attn_residual_3 -->
<g id="edge65" class="edge">
<title>attn_out_3&#45;&gt;attn_residual_3</title>
<path fill="none" stroke="black" d="M3701,-17655.12C3701,-17647.19 3701,-17638.58 3701,-17629.75"/>
<polygon fill="black" stroke="black" points="3704.5,-17629.71 3701,-17619.71 3697.5,-17629.71 3704.5,-17629.71"/>
</g>
<!-- layernorm1_3 -->
<g id="node52" class="node">
<title>layernorm1_3</title>
<polygon fill="lightblue" stroke="lightblue" points="3913,-17417.44 3551,-17417.44 3551,-17349.44 3913,-17349.44 3913,-17417.44"/>
<text text-anchor="middle" x="3732" y="-17402.24" font-family="Times,serif" font-size="14.00">GPU3_Layer3_LayerNorm1</text>
<text text-anchor="middle" x="3732" y="-17387.24" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3732" y="-17372.24" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3732" y="-17357.24" font-family="Times,serif" font-size="14.00">Device: GPU&#45;3</text>
</g>
<!-- attn_residual_3&#45;&gt;layernorm1_3 -->
<g id="edge67" class="edge">
<title>attn_residual_3&#45;&gt;layernorm1_3</title>
<path fill="none" stroke="black" d="M3717.86,-17453.31C3719.68,-17444.46 3721.47,-17435.73 3723.14,-17427.62"/>
<polygon fill="black" stroke="black" points="3726.59,-17428.2 3725.17,-17417.7 3719.73,-17426.79 3726.59,-17428.2"/>
</g>
<!-- ffn_up_3 -->
<g id="node53" class="node">
<title>ffn_up_3</title>
<polygon fill="lightblue" stroke="lightblue" points="3570,-17313.44 3220,-17313.44 3220,-17245.44 3570,-17245.44 3570,-17313.44"/>
<text text-anchor="middle" x="3395" y="-17298.24" font-family="Times,serif" font-size="14.00">GPU3_Layer3_FFN_Up</text>
<text text-anchor="middle" x="3395" y="-17283.24" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3395" y="-17268.24" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="3395" y="-17253.24" font-family="Times,serif" font-size="14.00">Device: GPU&#45;3</text>
</g>
<!-- layernorm1_3&#45;&gt;ffn_up_3 -->
<g id="edge68" class="edge">
<title>layernorm1_3&#45;&gt;ffn_up_3</title>
<path fill="none" stroke="black" d="M3622.59,-17349.32C3587.89,-17338.82 3549.37,-17327.16 3514.03,-17316.47"/>
<polygon fill="black" stroke="black" points="3514.74,-17313.02 3504.15,-17313.48 3512.71,-17319.72 3514.74,-17313.02"/>
</g>
<!-- ffn_gate_3 -->
<g id="node54" class="node">
<title>ffn_gate_3</title>
<polygon fill="lightblue" stroke="lightblue" points="3938,-17313.44 3588,-17313.44 3588,-17245.44 3938,-17245.44 3938,-17313.44"/>
<text text-anchor="middle" x="3763" y="-17298.24" font-family="Times,serif" font-size="14.00">GPU3_Layer3_FFN_Gate</text>
<text text-anchor="middle" x="3763" y="-17283.24" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3763" y="-17268.24" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="3763" y="-17253.24" font-family="Times,serif" font-size="14.00">Device: GPU&#45;3</text>
</g>
<!-- layernorm1_3&#45;&gt;ffn_gate_3 -->
<g id="edge69" class="edge">
<title>layernorm1_3&#45;&gt;ffn_gate_3</title>
<path fill="none" stroke="black" d="M3742.06,-17349.32C3744.58,-17341.04 3747.32,-17332.03 3749.96,-17323.35"/>
<polygon fill="black" stroke="black" points="3753.32,-17324.32 3752.88,-17313.74 3746.62,-17322.29 3753.32,-17324.32"/>
</g>
<!-- ffn_residual_3 -->
<g id="node57" class="node">
<title>ffn_residual_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4076.11,-17001.44 3479.39,-17001.44 3325.89,-16835.44 3922.61,-16835.44 4076.11,-17001.44"/>
<text text-anchor="middle" x="3701" y="-16944.74" font-family="Times,serif" font-size="14.00">GPU3_Layer3_FFN_Residual</text>
<text text-anchor="middle" x="3701" y="-16929.74" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3701" y="-16914.74" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3701" y="-16899.74" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3701" y="-16884.74" font-family="Times,serif" font-size="14.00">Device: GPU&#45;3</text>
</g>
<!-- layernorm1_3&#45;&gt;ffn_residual_3 -->
<g id="edge74" class="edge">
<title>layernorm1_3&#45;&gt;ffn_residual_3</title>
<path fill="none" stroke="black" d="M3906.21,-17349.33C3922.03,-17340.07 3936.14,-17328.33 3947,-17313.44 3964.81,-17289.02 3950.96,-17275.4 3947,-17245.44 3934.45,-17150.53 3948.1,-17114.29 3891,-17037.44 3883.25,-17027.01 3874.28,-17017.29 3864.54,-17008.27"/>
<polygon fill="black" stroke="black" points="3866.74,-17005.55 3856.95,-17001.51 3862.09,-17010.77 3866.74,-17005.55"/>
</g>
<!-- ffn_act_3 -->
<g id="node55" class="node">
<title>ffn_act_3</title>
<polygon fill="lightblue" stroke="lightblue" points="3871.5,-17209.44 3530.5,-17209.44 3530.5,-17141.44 3871.5,-17141.44 3871.5,-17209.44"/>
<text text-anchor="middle" x="3701" y="-17194.24" font-family="Times,serif" font-size="14.00">GPU3_Layer3_FFN_Act</text>
<text text-anchor="middle" x="3701" y="-17179.24" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="3701" y="-17164.24" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="3701" y="-17149.24" font-family="Times,serif" font-size="14.00">Device: GPU&#45;3</text>
</g>
<!-- ffn_up_3&#45;&gt;ffn_act_3 -->
<g id="edge70" class="edge">
<title>ffn_up_3&#45;&gt;ffn_act_3</title>
<path fill="none" stroke="black" d="M3494.35,-17245.32C3525.58,-17234.91 3560.23,-17223.36 3592.1,-17212.74"/>
<polygon fill="black" stroke="black" points="3593.51,-17215.96 3601.89,-17209.48 3591.29,-17209.32 3593.51,-17215.96"/>
</g>
<!-- ffn_gate_3&#45;&gt;ffn_act_3 -->
<g id="edge71" class="edge">
<title>ffn_gate_3&#45;&gt;ffn_act_3</title>
<path fill="none" stroke="black" d="M3742.87,-17245.32C3737.67,-17236.77 3732.01,-17227.45 3726.57,-17218.51"/>
<polygon fill="black" stroke="black" points="3729.43,-17216.47 3721.24,-17209.74 3723.44,-17220.1 3729.43,-17216.47"/>
</g>
<!-- ffn_down_3 -->
<g id="node56" class="node">
<title>ffn_down_3</title>
<polygon fill="lightblue" stroke="lightblue" points="3882,-17105.44 3520,-17105.44 3520,-17037.44 3882,-17037.44 3882,-17105.44"/>
<text text-anchor="middle" x="3701" y="-17090.24" font-family="Times,serif" font-size="14.00">GPU3_Layer3_FFN_Down</text>
<text text-anchor="middle" x="3701" y="-17075.24" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="3701" y="-17060.24" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3701" y="-17045.24" font-family="Times,serif" font-size="14.00">Device: GPU&#45;3</text>
</g>
<!-- ffn_act_3&#45;&gt;ffn_down_3 -->
<g id="edge72" class="edge">
<title>ffn_act_3&#45;&gt;ffn_down_3</title>
<path fill="none" stroke="black" d="M3701,-17141.32C3701,-17133.22 3701,-17124.42 3701,-17115.91"/>
<polygon fill="black" stroke="black" points="3704.5,-17115.74 3701,-17105.74 3697.5,-17115.74 3704.5,-17115.74"/>
</g>
<!-- ffn_down_3&#45;&gt;ffn_residual_3 -->
<g id="edge73" class="edge">
<title>ffn_down_3&#45;&gt;ffn_residual_3</title>
<path fill="none" stroke="black" d="M3701,-17037.3C3701,-17029.54 3701,-17020.9 3701,-17011.92"/>
<polygon fill="black" stroke="black" points="3704.5,-17011.67 3701,-17001.67 3697.5,-17011.67 3704.5,-17011.67"/>
</g>
<!-- layernorm2_3 -->
<g id="node58" class="node">
<title>layernorm2_3</title>
<polygon fill="lightblue" stroke="lightblue" points="3882,-16799.44 3520,-16799.44 3520,-16731.44 3882,-16731.44 3882,-16799.44"/>
<text text-anchor="middle" x="3701" y="-16784.24" font-family="Times,serif" font-size="14.00">GPU3_Layer3_LayerNorm2</text>
<text text-anchor="middle" x="3701" y="-16769.24" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3701" y="-16754.24" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3701" y="-16739.24" font-family="Times,serif" font-size="14.00">Device: GPU&#45;3</text>
</g>
<!-- ffn_residual_3&#45;&gt;layernorm2_3 -->
<g id="edge75" class="edge">
<title>ffn_residual_3&#45;&gt;layernorm2_3</title>
<path fill="none" stroke="black" d="M3701,-16835.31C3701,-16826.56 3701,-16817.92 3701,-16809.89"/>
<polygon fill="black" stroke="black" points="3704.5,-16809.7 3701,-16799.7 3697.5,-16809.7 3704.5,-16809.7"/>
</g>
<!-- comm_3 -->
<g id="node218" class="node">
<title>comm_3</title>
<ellipse fill="lightgreen" stroke="lightgreen" cx="3701" cy="-16657.96" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="3701" y="-16669.26" font-family="Times,serif" font-size="14.00">GPU3_to_GPU4</text>
<text text-anchor="middle" x="3701" y="-16654.26" font-family="Times,serif" font-size="14.00">Transfer: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3701" y="-16639.26" font-family="Times,serif" font-size="14.00">Bandwidth: NVLink 900GB/s</text>
</g>
<!-- layernorm2_3&#45;&gt;comm_3 -->
<g id="edge76" class="edge">
<title>layernorm2_3&#45;&gt;comm_3</title>
<path fill="none" stroke="black" d="M3701,-16731.36C3701,-16723.19 3701,-16714.3 3701,-16705.62"/>
<polygon fill="black" stroke="black" points="3704.5,-16705.6 3701,-16695.6 3697.5,-16705.6 3704.5,-16705.6"/>
</g>
<!-- mha_q_4 -->
<g id="node59" class="node">
<title>mha_q_4</title>
<polygon fill="lightblue" stroke="lightblue" points="3789.5,-16581.49 3380.5,-16581.49 3380.5,-16513.49 3789.5,-16513.49 3789.5,-16581.49"/>
<text text-anchor="middle" x="3585" y="-16566.29" font-family="Times,serif" font-size="14.00">GPU4_Layer4_MHA_Q</text>
<text text-anchor="middle" x="3585" y="-16551.29" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3585" y="-16536.29" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3585" y="-16521.29" font-family="Times,serif" font-size="14.00">Device: GPU&#45;4</text>
</g>
<!-- attn_score_4 -->
<g id="node62" class="node">
<title>attn_score_4</title>
<polygon fill="lightblue" stroke="lightblue" points="3381,-16477.49 2953,-16477.49 2953,-16394.49 3381,-16394.49 3381,-16477.49"/>
<text text-anchor="middle" x="3167" y="-16462.29" font-family="Times,serif" font-size="14.00">GPU4_Layer4_Attn_Score</text>
<text text-anchor="middle" x="3167" y="-16447.29" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3167" y="-16432.29" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3167" y="-16417.29" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="3167" y="-16402.29" font-family="Times,serif" font-size="14.00">Device: GPU&#45;4</text>
</g>
<!-- mha_q_4&#45;&gt;attn_score_4 -->
<g id="edge80" class="edge">
<title>mha_q_4&#45;&gt;attn_score_4</title>
<path fill="none" stroke="black" d="M3459.02,-16513.48C3418.99,-16503 3374.11,-16491.24 3331.76,-16480.15"/>
<polygon fill="black" stroke="black" points="3332.48,-16476.72 3321.92,-16477.57 3330.7,-16483.49 3332.48,-16476.72"/>
</g>
<!-- mha_k_4 -->
<g id="node60" class="node">
<title>mha_k_4</title>
<polygon fill="lightblue" stroke="lightblue" points="3362.5,-16581.49 2953.5,-16581.49 2953.5,-16513.49 3362.5,-16513.49 3362.5,-16581.49"/>
<text text-anchor="middle" x="3158" y="-16566.29" font-family="Times,serif" font-size="14.00">GPU4_Layer4_MHA_K</text>
<text text-anchor="middle" x="3158" y="-16551.29" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3158" y="-16536.29" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3158" y="-16521.29" font-family="Times,serif" font-size="14.00">Device: GPU&#45;4</text>
</g>
<!-- mha_k_4&#45;&gt;attn_score_4 -->
<g id="edge81" class="edge">
<title>mha_k_4&#45;&gt;attn_score_4</title>
<path fill="none" stroke="black" d="M3160.72,-16513.34C3161.39,-16505.28 3162.11,-16496.49 3162.82,-16487.82"/>
<polygon fill="black" stroke="black" points="3166.32,-16488.02 3163.65,-16477.76 3159.34,-16487.44 3166.32,-16488.02"/>
</g>
<!-- mha_v_4 -->
<g id="node61" class="node">
<title>mha_v_4</title>
<polygon fill="lightblue" stroke="lightblue" points="3808.5,-16469.99 3399.5,-16469.99 3399.5,-16401.99 3808.5,-16401.99 3808.5,-16469.99"/>
<text text-anchor="middle" x="3604" y="-16454.79" font-family="Times,serif" font-size="14.00">GPU4_Layer4_MHA_V</text>
<text text-anchor="middle" x="3604" y="-16439.79" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3604" y="-16424.79" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3604" y="-16409.79" font-family="Times,serif" font-size="14.00">Device: GPU&#45;4</text>
</g>
<!-- attn_out_4 -->
<g id="node63" class="node">
<title>attn_out_4</title>
<polygon fill="lightblue" stroke="lightblue" points="3646.5,-16358.49 3221.5,-16358.49 3221.5,-16275.49 3646.5,-16275.49 3646.5,-16358.49"/>
<text text-anchor="middle" x="3434" y="-16343.29" font-family="Times,serif" font-size="14.00">GPU4_Layer4_Attn_Out</text>
<text text-anchor="middle" x="3434" y="-16328.29" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="3434" y="-16313.29" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3434" y="-16298.29" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3434" y="-16283.29" font-family="Times,serif" font-size="14.00">Device: GPU&#45;4</text>
</g>
<!-- mha_v_4&#45;&gt;attn_out_4 -->
<g id="edge83" class="edge">
<title>mha_v_4&#45;&gt;attn_out_4</title>
<path fill="none" stroke="black" d="M3555.74,-16401.77C3538.8,-16390.11 3519.45,-16376.8 3501.24,-16364.26"/>
<polygon fill="black" stroke="black" points="3503.18,-16361.35 3492.96,-16358.57 3499.22,-16367.12 3503.18,-16361.35"/>
</g>
<!-- attn_score_4&#45;&gt;attn_out_4 -->
<g id="edge82" class="edge">
<title>attn_score_4&#45;&gt;attn_out_4</title>
<path fill="none" stroke="black" d="M3259.63,-16394.39C3283.04,-16384.14 3308.29,-16373.07 3332.12,-16362.63"/>
<polygon fill="black" stroke="black" points="3333.77,-16365.73 3341.53,-16358.51 3330.97,-16359.32 3333.77,-16365.73"/>
</g>
<!-- attn_residual_4 -->
<g id="node64" class="node">
<title>attn_residual_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3809.11,-16239.49 3212.39,-16239.49 3058.89,-16073.49 3655.61,-16073.49 3809.11,-16239.49"/>
<text text-anchor="middle" x="3434" y="-16182.79" font-family="Times,serif" font-size="14.00">GPU4_Layer4_Attn_Residual</text>
<text text-anchor="middle" x="3434" y="-16167.79" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3434" y="-16152.79" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3434" y="-16137.79" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3434" y="-16122.79" font-family="Times,serif" font-size="14.00">Device: GPU&#45;4</text>
</g>
<!-- attn_out_4&#45;&gt;attn_residual_4 -->
<g id="edge84" class="edge">
<title>attn_out_4&#45;&gt;attn_residual_4</title>
<path fill="none" stroke="black" d="M3434,-16275.17C3434,-16267.24 3434,-16258.63 3434,-16249.8"/>
<polygon fill="black" stroke="black" points="3437.5,-16249.76 3434,-16239.76 3430.5,-16249.76 3437.5,-16249.76"/>
</g>
<!-- layernorm1_4 -->
<g id="node65" class="node">
<title>layernorm1_4</title>
<polygon fill="lightblue" stroke="lightblue" points="3646,-16037.49 3284,-16037.49 3284,-15969.49 3646,-15969.49 3646,-16037.49"/>
<text text-anchor="middle" x="3465" y="-16022.29" font-family="Times,serif" font-size="14.00">GPU4_Layer4_LayerNorm1</text>
<text text-anchor="middle" x="3465" y="-16007.29" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3465" y="-15992.29" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3465" y="-15977.29" font-family="Times,serif" font-size="14.00">Device: GPU&#45;4</text>
</g>
<!-- attn_residual_4&#45;&gt;layernorm1_4 -->
<g id="edge86" class="edge">
<title>attn_residual_4&#45;&gt;layernorm1_4</title>
<path fill="none" stroke="black" d="M3450.86,-16073.36C3452.68,-16064.51 3454.47,-16055.78 3456.14,-16047.66"/>
<polygon fill="black" stroke="black" points="3459.59,-16048.25 3458.17,-16037.75 3452.73,-16046.84 3459.59,-16048.25"/>
</g>
<!-- ffn_up_4 -->
<g id="node66" class="node">
<title>ffn_up_4</title>
<polygon fill="lightblue" stroke="lightblue" points="3303,-15933.49 2953,-15933.49 2953,-15865.49 3303,-15865.49 3303,-15933.49"/>
<text text-anchor="middle" x="3128" y="-15918.29" font-family="Times,serif" font-size="14.00">GPU4_Layer4_FFN_Up</text>
<text text-anchor="middle" x="3128" y="-15903.29" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3128" y="-15888.29" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="3128" y="-15873.29" font-family="Times,serif" font-size="14.00">Device: GPU&#45;4</text>
</g>
<!-- layernorm1_4&#45;&gt;ffn_up_4 -->
<g id="edge87" class="edge">
<title>layernorm1_4&#45;&gt;ffn_up_4</title>
<path fill="none" stroke="black" d="M3355.59,-15969.37C3320.89,-15958.87 3282.37,-15947.21 3247.03,-15936.51"/>
<polygon fill="black" stroke="black" points="3247.74,-15933.07 3237.15,-15933.52 3245.71,-15939.77 3247.74,-15933.07"/>
</g>
<!-- ffn_gate_4 -->
<g id="node67" class="node">
<title>ffn_gate_4</title>
<polygon fill="lightblue" stroke="lightblue" points="3671,-15933.49 3321,-15933.49 3321,-15865.49 3671,-15865.49 3671,-15933.49"/>
<text text-anchor="middle" x="3496" y="-15918.29" font-family="Times,serif" font-size="14.00">GPU4_Layer4_FFN_Gate</text>
<text text-anchor="middle" x="3496" y="-15903.29" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3496" y="-15888.29" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="3496" y="-15873.29" font-family="Times,serif" font-size="14.00">Device: GPU&#45;4</text>
</g>
<!-- layernorm1_4&#45;&gt;ffn_gate_4 -->
<g id="edge88" class="edge">
<title>layernorm1_4&#45;&gt;ffn_gate_4</title>
<path fill="none" stroke="black" d="M3475.06,-15969.37C3477.58,-15961.09 3480.32,-15952.08 3482.96,-15943.4"/>
<polygon fill="black" stroke="black" points="3486.32,-15944.37 3485.88,-15933.79 3479.62,-15942.34 3486.32,-15944.37"/>
</g>
<!-- ffn_residual_4 -->
<g id="node70" class="node">
<title>ffn_residual_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3809.11,-15621.49 3212.39,-15621.49 3058.89,-15455.49 3655.61,-15455.49 3809.11,-15621.49"/>
<text text-anchor="middle" x="3434" y="-15564.79" font-family="Times,serif" font-size="14.00">GPU4_Layer4_FFN_Residual</text>
<text text-anchor="middle" x="3434" y="-15549.79" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3434" y="-15534.79" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3434" y="-15519.79" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3434" y="-15504.79" font-family="Times,serif" font-size="14.00">Device: GPU&#45;4</text>
</g>
<!-- layernorm1_4&#45;&gt;ffn_residual_4 -->
<g id="edge93" class="edge">
<title>layernorm1_4&#45;&gt;ffn_residual_4</title>
<path fill="none" stroke="black" d="M3639.21,-15969.38C3655.03,-15960.12 3669.14,-15948.37 3680,-15933.49 3697.81,-15909.07 3683.96,-15895.45 3680,-15865.49 3667.45,-15770.58 3681.1,-15734.33 3624,-15657.49 3616.25,-15647.05 3607.28,-15637.33 3597.54,-15628.32"/>
<polygon fill="black" stroke="black" points="3599.74,-15625.59 3589.95,-15621.56 3595.09,-15630.82 3599.74,-15625.59"/>
</g>
<!-- ffn_act_4 -->
<g id="node68" class="node">
<title>ffn_act_4</title>
<polygon fill="lightblue" stroke="lightblue" points="3604.5,-15829.49 3263.5,-15829.49 3263.5,-15761.49 3604.5,-15761.49 3604.5,-15829.49"/>
<text text-anchor="middle" x="3434" y="-15814.29" font-family="Times,serif" font-size="14.00">GPU4_Layer4_FFN_Act</text>
<text text-anchor="middle" x="3434" y="-15799.29" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="3434" y="-15784.29" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="3434" y="-15769.29" font-family="Times,serif" font-size="14.00">Device: GPU&#45;4</text>
</g>
<!-- ffn_up_4&#45;&gt;ffn_act_4 -->
<g id="edge89" class="edge">
<title>ffn_up_4&#45;&gt;ffn_act_4</title>
<path fill="none" stroke="black" d="M3227.35,-15865.37C3258.58,-15854.96 3293.23,-15843.41 3325.1,-15832.79"/>
<polygon fill="black" stroke="black" points="3326.51,-15836.01 3334.89,-15829.52 3324.29,-15829.37 3326.51,-15836.01"/>
</g>
<!-- ffn_gate_4&#45;&gt;ffn_act_4 -->
<g id="edge90" class="edge">
<title>ffn_gate_4&#45;&gt;ffn_act_4</title>
<path fill="none" stroke="black" d="M3475.87,-15865.37C3470.67,-15856.82 3465.01,-15847.5 3459.57,-15838.56"/>
<polygon fill="black" stroke="black" points="3462.43,-15836.51 3454.24,-15829.79 3456.44,-15840.15 3462.43,-15836.51"/>
</g>
<!-- ffn_down_4 -->
<g id="node69" class="node">
<title>ffn_down_4</title>
<polygon fill="lightblue" stroke="lightblue" points="3615,-15725.49 3253,-15725.49 3253,-15657.49 3615,-15657.49 3615,-15725.49"/>
<text text-anchor="middle" x="3434" y="-15710.29" font-family="Times,serif" font-size="14.00">GPU4_Layer4_FFN_Down</text>
<text text-anchor="middle" x="3434" y="-15695.29" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="3434" y="-15680.29" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3434" y="-15665.29" font-family="Times,serif" font-size="14.00">Device: GPU&#45;4</text>
</g>
<!-- ffn_act_4&#45;&gt;ffn_down_4 -->
<g id="edge91" class="edge">
<title>ffn_act_4&#45;&gt;ffn_down_4</title>
<path fill="none" stroke="black" d="M3434,-15761.37C3434,-15753.26 3434,-15744.47 3434,-15735.96"/>
<polygon fill="black" stroke="black" points="3437.5,-15735.79 3434,-15725.79 3430.5,-15735.79 3437.5,-15735.79"/>
</g>
<!-- ffn_down_4&#45;&gt;ffn_residual_4 -->
<g id="edge92" class="edge">
<title>ffn_down_4&#45;&gt;ffn_residual_4</title>
<path fill="none" stroke="black" d="M3434,-15657.35C3434,-15649.59 3434,-15640.95 3434,-15631.97"/>
<polygon fill="black" stroke="black" points="3437.5,-15631.72 3434,-15621.72 3430.5,-15631.72 3437.5,-15631.72"/>
</g>
<!-- layernorm2_4 -->
<g id="node71" class="node">
<title>layernorm2_4</title>
<polygon fill="lightblue" stroke="lightblue" points="3615,-15419.49 3253,-15419.49 3253,-15351.49 3615,-15351.49 3615,-15419.49"/>
<text text-anchor="middle" x="3434" y="-15404.29" font-family="Times,serif" font-size="14.00">GPU4_Layer4_LayerNorm2</text>
<text text-anchor="middle" x="3434" y="-15389.29" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3434" y="-15374.29" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3434" y="-15359.29" font-family="Times,serif" font-size="14.00">Device: GPU&#45;4</text>
</g>
<!-- ffn_residual_4&#45;&gt;layernorm2_4 -->
<g id="edge94" class="edge">
<title>ffn_residual_4&#45;&gt;layernorm2_4</title>
<path fill="none" stroke="black" d="M3434,-15455.36C3434,-15446.6 3434,-15437.97 3434,-15429.93"/>
<polygon fill="black" stroke="black" points="3437.5,-15429.75 3434,-15419.75 3430.5,-15429.75 3437.5,-15429.75"/>
</g>
<!-- comm_4 -->
<g id="node219" class="node">
<title>comm_4</title>
<ellipse fill="lightgreen" stroke="lightgreen" cx="3434" cy="-15278.01" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="3434" y="-15289.31" font-family="Times,serif" font-size="14.00">GPU4_to_GPU5</text>
<text text-anchor="middle" x="3434" y="-15274.31" font-family="Times,serif" font-size="14.00">Transfer: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3434" y="-15259.31" font-family="Times,serif" font-size="14.00">Bandwidth: NVLink 900GB/s</text>
</g>
<!-- layernorm2_4&#45;&gt;comm_4 -->
<g id="edge95" class="edge">
<title>layernorm2_4&#45;&gt;comm_4</title>
<path fill="none" stroke="black" d="M3434,-15351.4C3434,-15343.24 3434,-15334.34 3434,-15325.67"/>
<polygon fill="black" stroke="black" points="3437.5,-15325.64 3434,-15315.64 3430.5,-15325.64 3437.5,-15325.64"/>
</g>
<!-- mha_q_5 -->
<g id="node72" class="node">
<title>mha_q_5</title>
<polygon fill="lightblue" stroke="lightblue" points="3522.5,-15201.53 3113.5,-15201.53 3113.5,-15133.53 3522.5,-15133.53 3522.5,-15201.53"/>
<text text-anchor="middle" x="3318" y="-15186.33" font-family="Times,serif" font-size="14.00">GPU5_Layer5_MHA_Q</text>
<text text-anchor="middle" x="3318" y="-15171.33" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3318" y="-15156.33" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3318" y="-15141.33" font-family="Times,serif" font-size="14.00">Device: GPU&#45;5</text>
</g>
<!-- attn_score_5 -->
<g id="node75" class="node">
<title>attn_score_5</title>
<polygon fill="lightblue" stroke="lightblue" points="3114,-15097.53 2686,-15097.53 2686,-15014.53 3114,-15014.53 3114,-15097.53"/>
<text text-anchor="middle" x="2900" y="-15082.33" font-family="Times,serif" font-size="14.00">GPU5_Layer5_Attn_Score</text>
<text text-anchor="middle" x="2900" y="-15067.33" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2900" y="-15052.33" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2900" y="-15037.33" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="2900" y="-15022.33" font-family="Times,serif" font-size="14.00">Device: GPU&#45;5</text>
</g>
<!-- mha_q_5&#45;&gt;attn_score_5 -->
<g id="edge99" class="edge">
<title>mha_q_5&#45;&gt;attn_score_5</title>
<path fill="none" stroke="black" d="M3192.02,-15133.53C3151.99,-15123.04 3107.11,-15111.29 3064.76,-15100.19"/>
<polygon fill="black" stroke="black" points="3065.48,-15096.76 3054.92,-15097.62 3063.7,-15103.54 3065.48,-15096.76"/>
</g>
<!-- mha_k_5 -->
<g id="node73" class="node">
<title>mha_k_5</title>
<polygon fill="lightblue" stroke="lightblue" points="3095.5,-15201.53 2686.5,-15201.53 2686.5,-15133.53 3095.5,-15133.53 3095.5,-15201.53"/>
<text text-anchor="middle" x="2891" y="-15186.33" font-family="Times,serif" font-size="14.00">GPU5_Layer5_MHA_K</text>
<text text-anchor="middle" x="2891" y="-15171.33" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2891" y="-15156.33" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2891" y="-15141.33" font-family="Times,serif" font-size="14.00">Device: GPU&#45;5</text>
</g>
<!-- mha_k_5&#45;&gt;attn_score_5 -->
<g id="edge100" class="edge">
<title>mha_k_5&#45;&gt;attn_score_5</title>
<path fill="none" stroke="black" d="M2893.72,-15133.38C2894.39,-15125.33 2895.11,-15116.53 2895.82,-15107.87"/>
<polygon fill="black" stroke="black" points="2899.32,-15108.06 2896.65,-15097.81 2892.34,-15107.49 2899.32,-15108.06"/>
</g>
<!-- mha_v_5 -->
<g id="node74" class="node">
<title>mha_v_5</title>
<polygon fill="lightblue" stroke="lightblue" points="3541.5,-15090.03 3132.5,-15090.03 3132.5,-15022.03 3541.5,-15022.03 3541.5,-15090.03"/>
<text text-anchor="middle" x="3337" y="-15074.83" font-family="Times,serif" font-size="14.00">GPU5_Layer5_MHA_V</text>
<text text-anchor="middle" x="3337" y="-15059.83" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3337" y="-15044.83" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3337" y="-15029.83" font-family="Times,serif" font-size="14.00">Device: GPU&#45;5</text>
</g>
<!-- attn_out_5 -->
<g id="node76" class="node">
<title>attn_out_5</title>
<polygon fill="lightblue" stroke="lightblue" points="3379.5,-14978.53 2954.5,-14978.53 2954.5,-14895.53 3379.5,-14895.53 3379.5,-14978.53"/>
<text text-anchor="middle" x="3167" y="-14963.33" font-family="Times,serif" font-size="14.00">GPU5_Layer5_Attn_Out</text>
<text text-anchor="middle" x="3167" y="-14948.33" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="3167" y="-14933.33" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3167" y="-14918.33" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3167" y="-14903.33" font-family="Times,serif" font-size="14.00">Device: GPU&#45;5</text>
</g>
<!-- mha_v_5&#45;&gt;attn_out_5 -->
<g id="edge102" class="edge">
<title>mha_v_5&#45;&gt;attn_out_5</title>
<path fill="none" stroke="black" d="M3288.74,-15021.82C3271.8,-15010.16 3252.45,-14996.84 3234.24,-14984.31"/>
<polygon fill="black" stroke="black" points="3236.18,-14981.4 3225.96,-14978.61 3232.22,-14987.17 3236.18,-14981.4"/>
</g>
<!-- attn_score_5&#45;&gt;attn_out_5 -->
<g id="edge101" class="edge">
<title>attn_score_5&#45;&gt;attn_out_5</title>
<path fill="none" stroke="black" d="M2992.63,-15014.44C3016.04,-15004.19 3041.29,-14993.12 3065.12,-14982.68"/>
<polygon fill="black" stroke="black" points="3066.77,-14985.77 3074.53,-14978.55 3063.97,-14979.36 3066.77,-14985.77"/>
</g>
<!-- attn_residual_5 -->
<g id="node77" class="node">
<title>attn_residual_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3542.11,-14859.53 2945.39,-14859.53 2791.89,-14693.53 3388.61,-14693.53 3542.11,-14859.53"/>
<text text-anchor="middle" x="3167" y="-14802.83" font-family="Times,serif" font-size="14.00">GPU5_Layer5_Attn_Residual</text>
<text text-anchor="middle" x="3167" y="-14787.83" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3167" y="-14772.83" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3167" y="-14757.83" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3167" y="-14742.83" font-family="Times,serif" font-size="14.00">Device: GPU&#45;5</text>
</g>
<!-- attn_out_5&#45;&gt;attn_residual_5 -->
<g id="edge103" class="edge">
<title>attn_out_5&#45;&gt;attn_residual_5</title>
<path fill="none" stroke="black" d="M3167,-14895.22C3167,-14887.29 3167,-14878.68 3167,-14869.85"/>
<polygon fill="black" stroke="black" points="3170.5,-14869.81 3167,-14859.81 3163.5,-14869.81 3170.5,-14869.81"/>
</g>
<!-- layernorm1_5 -->
<g id="node78" class="node">
<title>layernorm1_5</title>
<polygon fill="lightblue" stroke="lightblue" points="3379,-14657.53 3017,-14657.53 3017,-14589.53 3379,-14589.53 3379,-14657.53"/>
<text text-anchor="middle" x="3198" y="-14642.33" font-family="Times,serif" font-size="14.00">GPU5_Layer5_LayerNorm1</text>
<text text-anchor="middle" x="3198" y="-14627.33" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3198" y="-14612.33" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3198" y="-14597.33" font-family="Times,serif" font-size="14.00">Device: GPU&#45;5</text>
</g>
<!-- attn_residual_5&#45;&gt;layernorm1_5 -->
<g id="edge105" class="edge">
<title>attn_residual_5&#45;&gt;layernorm1_5</title>
<path fill="none" stroke="black" d="M3183.86,-14693.41C3185.68,-14684.55 3187.47,-14675.82 3189.14,-14667.71"/>
<polygon fill="black" stroke="black" points="3192.59,-14668.29 3191.17,-14657.79 3185.73,-14666.89 3192.59,-14668.29"/>
</g>
<!-- ffn_up_5 -->
<g id="node79" class="node">
<title>ffn_up_5</title>
<polygon fill="lightblue" stroke="lightblue" points="3036,-14553.53 2686,-14553.53 2686,-14485.53 3036,-14485.53 3036,-14553.53"/>
<text text-anchor="middle" x="2861" y="-14538.33" font-family="Times,serif" font-size="14.00">GPU5_Layer5_FFN_Up</text>
<text text-anchor="middle" x="2861" y="-14523.33" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2861" y="-14508.33" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="2861" y="-14493.33" font-family="Times,serif" font-size="14.00">Device: GPU&#45;5</text>
</g>
<!-- layernorm1_5&#45;&gt;ffn_up_5 -->
<g id="edge106" class="edge">
<title>layernorm1_5&#45;&gt;ffn_up_5</title>
<path fill="none" stroke="black" d="M3088.59,-14589.42C3053.89,-14578.92 3015.37,-14567.26 2980.03,-14556.56"/>
<polygon fill="black" stroke="black" points="2980.74,-14553.12 2970.15,-14553.57 2978.71,-14559.82 2980.74,-14553.12"/>
</g>
<!-- ffn_gate_5 -->
<g id="node80" class="node">
<title>ffn_gate_5</title>
<polygon fill="lightblue" stroke="lightblue" points="3404,-14553.53 3054,-14553.53 3054,-14485.53 3404,-14485.53 3404,-14553.53"/>
<text text-anchor="middle" x="3229" y="-14538.33" font-family="Times,serif" font-size="14.00">GPU5_Layer5_FFN_Gate</text>
<text text-anchor="middle" x="3229" y="-14523.33" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3229" y="-14508.33" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="3229" y="-14493.33" font-family="Times,serif" font-size="14.00">Device: GPU&#45;5</text>
</g>
<!-- layernorm1_5&#45;&gt;ffn_gate_5 -->
<g id="edge107" class="edge">
<title>layernorm1_5&#45;&gt;ffn_gate_5</title>
<path fill="none" stroke="black" d="M3208.06,-14589.42C3210.58,-14581.13 3213.32,-14572.13 3215.96,-14563.44"/>
<polygon fill="black" stroke="black" points="3219.32,-14564.42 3218.88,-14553.83 3212.62,-14562.38 3219.32,-14564.42"/>
</g>
<!-- ffn_residual_5 -->
<g id="node83" class="node">
<title>ffn_residual_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3542.11,-14241.53 2945.39,-14241.53 2791.89,-14075.53 3388.61,-14075.53 3542.11,-14241.53"/>
<text text-anchor="middle" x="3167" y="-14184.83" font-family="Times,serif" font-size="14.00">GPU5_Layer5_FFN_Residual</text>
<text text-anchor="middle" x="3167" y="-14169.83" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3167" y="-14154.83" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3167" y="-14139.83" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3167" y="-14124.83" font-family="Times,serif" font-size="14.00">Device: GPU&#45;5</text>
</g>
<!-- layernorm1_5&#45;&gt;ffn_residual_5 -->
<g id="edge112" class="edge">
<title>layernorm1_5&#45;&gt;ffn_residual_5</title>
<path fill="none" stroke="black" d="M3372.21,-14589.42C3388.03,-14580.17 3402.14,-14568.42 3413,-14553.53 3430.81,-14529.12 3416.96,-14515.49 3413,-14485.53 3400.45,-14390.62 3414.1,-14354.38 3357,-14277.53 3349.25,-14267.1 3340.28,-14257.38 3330.54,-14248.36"/>
<polygon fill="black" stroke="black" points="3332.74,-14245.64 3322.95,-14241.6 3328.09,-14250.87 3332.74,-14245.64"/>
</g>
<!-- ffn_act_5 -->
<g id="node81" class="node">
<title>ffn_act_5</title>
<polygon fill="lightblue" stroke="lightblue" points="3337.5,-14449.53 2996.5,-14449.53 2996.5,-14381.53 3337.5,-14381.53 3337.5,-14449.53"/>
<text text-anchor="middle" x="3167" y="-14434.33" font-family="Times,serif" font-size="14.00">GPU5_Layer5_FFN_Act</text>
<text text-anchor="middle" x="3167" y="-14419.33" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="3167" y="-14404.33" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="3167" y="-14389.33" font-family="Times,serif" font-size="14.00">Device: GPU&#45;5</text>
</g>
<!-- ffn_up_5&#45;&gt;ffn_act_5 -->
<g id="edge108" class="edge">
<title>ffn_up_5&#45;&gt;ffn_act_5</title>
<path fill="none" stroke="black" d="M2960.35,-14485.42C2991.58,-14475.01 3026.23,-14463.45 3058.1,-14452.83"/>
<polygon fill="black" stroke="black" points="3059.51,-14456.05 3067.89,-14449.57 3057.29,-14449.41 3059.51,-14456.05"/>
</g>
<!-- ffn_gate_5&#45;&gt;ffn_act_5 -->
<g id="edge109" class="edge">
<title>ffn_gate_5&#45;&gt;ffn_act_5</title>
<path fill="none" stroke="black" d="M3208.87,-14485.42C3203.67,-14476.87 3198.01,-14467.55 3192.57,-14458.61"/>
<polygon fill="black" stroke="black" points="3195.43,-14456.56 3187.24,-14449.83 3189.44,-14460.2 3195.43,-14456.56"/>
</g>
<!-- ffn_down_5 -->
<g id="node82" class="node">
<title>ffn_down_5</title>
<polygon fill="lightblue" stroke="lightblue" points="3348,-14345.53 2986,-14345.53 2986,-14277.53 3348,-14277.53 3348,-14345.53"/>
<text text-anchor="middle" x="3167" y="-14330.33" font-family="Times,serif" font-size="14.00">GPU5_Layer5_FFN_Down</text>
<text text-anchor="middle" x="3167" y="-14315.33" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="3167" y="-14300.33" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3167" y="-14285.33" font-family="Times,serif" font-size="14.00">Device: GPU&#45;5</text>
</g>
<!-- ffn_act_5&#45;&gt;ffn_down_5 -->
<g id="edge110" class="edge">
<title>ffn_act_5&#45;&gt;ffn_down_5</title>
<path fill="none" stroke="black" d="M3167,-14381.42C3167,-14373.31 3167,-14364.52 3167,-14356.01"/>
<polygon fill="black" stroke="black" points="3170.5,-14355.83 3167,-14345.83 3163.5,-14355.83 3170.5,-14355.83"/>
</g>
<!-- ffn_down_5&#45;&gt;ffn_residual_5 -->
<g id="edge111" class="edge">
<title>ffn_down_5&#45;&gt;ffn_residual_5</title>
<path fill="none" stroke="black" d="M3167,-14277.4C3167,-14269.64 3167,-14261 3167,-14252.02"/>
<polygon fill="black" stroke="black" points="3170.5,-14251.77 3167,-14241.77 3163.5,-14251.77 3170.5,-14251.77"/>
</g>
<!-- layernorm2_5 -->
<g id="node84" class="node">
<title>layernorm2_5</title>
<polygon fill="lightblue" stroke="lightblue" points="3348,-14039.53 2986,-14039.53 2986,-13971.53 3348,-13971.53 3348,-14039.53"/>
<text text-anchor="middle" x="3167" y="-14024.33" font-family="Times,serif" font-size="14.00">GPU5_Layer5_LayerNorm2</text>
<text text-anchor="middle" x="3167" y="-14009.33" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3167" y="-13994.33" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3167" y="-13979.33" font-family="Times,serif" font-size="14.00">Device: GPU&#45;5</text>
</g>
<!-- ffn_residual_5&#45;&gt;layernorm2_5 -->
<g id="edge113" class="edge">
<title>ffn_residual_5&#45;&gt;layernorm2_5</title>
<path fill="none" stroke="black" d="M3167,-14075.41C3167,-14066.65 3167,-14058.02 3167,-14049.98"/>
<polygon fill="black" stroke="black" points="3170.5,-14049.79 3167,-14039.79 3163.5,-14049.79 3170.5,-14049.79"/>
</g>
<!-- comm_5 -->
<g id="node220" class="node">
<title>comm_5</title>
<ellipse fill="lightgreen" stroke="lightgreen" cx="3167" cy="-13898.06" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="3167" y="-13909.36" font-family="Times,serif" font-size="14.00">GPU5_to_GPU6</text>
<text text-anchor="middle" x="3167" y="-13894.36" font-family="Times,serif" font-size="14.00">Transfer: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3167" y="-13879.36" font-family="Times,serif" font-size="14.00">Bandwidth: NVLink 900GB/s</text>
</g>
<!-- layernorm2_5&#45;&gt;comm_5 -->
<g id="edge114" class="edge">
<title>layernorm2_5&#45;&gt;comm_5</title>
<path fill="none" stroke="black" d="M3167,-13971.45C3167,-13963.29 3167,-13954.39 3167,-13945.71"/>
<polygon fill="black" stroke="black" points="3170.5,-13945.69 3167,-13935.69 3163.5,-13945.69 3170.5,-13945.69"/>
</g>
<!-- mha_q_6 -->
<g id="node85" class="node">
<title>mha_q_6</title>
<polygon fill="lightblue" stroke="lightblue" points="3255.5,-13821.58 2846.5,-13821.58 2846.5,-13753.58 3255.5,-13753.58 3255.5,-13821.58"/>
<text text-anchor="middle" x="3051" y="-13806.38" font-family="Times,serif" font-size="14.00">GPU6_Layer6_MHA_Q</text>
<text text-anchor="middle" x="3051" y="-13791.38" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3051" y="-13776.38" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3051" y="-13761.38" font-family="Times,serif" font-size="14.00">Device: GPU&#45;6</text>
</g>
<!-- attn_score_6 -->
<g id="node88" class="node">
<title>attn_score_6</title>
<polygon fill="lightblue" stroke="lightblue" points="2847,-13717.58 2419,-13717.58 2419,-13634.58 2847,-13634.58 2847,-13717.58"/>
<text text-anchor="middle" x="2633" y="-13702.38" font-family="Times,serif" font-size="14.00">GPU6_Layer6_Attn_Score</text>
<text text-anchor="middle" x="2633" y="-13687.38" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2633" y="-13672.38" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2633" y="-13657.38" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="2633" y="-13642.38" font-family="Times,serif" font-size="14.00">Device: GPU&#45;6</text>
</g>
<!-- mha_q_6&#45;&gt;attn_score_6 -->
<g id="edge118" class="edge">
<title>mha_q_6&#45;&gt;attn_score_6</title>
<path fill="none" stroke="black" d="M2925.02,-13753.58C2884.99,-13743.09 2840.11,-13731.33 2797.76,-13720.24"/>
<polygon fill="black" stroke="black" points="2798.48,-13716.81 2787.92,-13717.66 2796.7,-13723.58 2798.48,-13716.81"/>
</g>
<!-- mha_k_6 -->
<g id="node86" class="node">
<title>mha_k_6</title>
<polygon fill="lightblue" stroke="lightblue" points="2828.5,-13821.58 2419.5,-13821.58 2419.5,-13753.58 2828.5,-13753.58 2828.5,-13821.58"/>
<text text-anchor="middle" x="2624" y="-13806.38" font-family="Times,serif" font-size="14.00">GPU6_Layer6_MHA_K</text>
<text text-anchor="middle" x="2624" y="-13791.38" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2624" y="-13776.38" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2624" y="-13761.38" font-family="Times,serif" font-size="14.00">Device: GPU&#45;6</text>
</g>
<!-- mha_k_6&#45;&gt;attn_score_6 -->
<g id="edge119" class="edge">
<title>mha_k_6&#45;&gt;attn_score_6</title>
<path fill="none" stroke="black" d="M2626.72,-13753.43C2627.39,-13745.38 2628.11,-13736.58 2628.82,-13727.92"/>
<polygon fill="black" stroke="black" points="2632.32,-13728.11 2629.65,-13717.86 2625.34,-13727.54 2632.32,-13728.11"/>
</g>
<!-- mha_v_6 -->
<g id="node87" class="node">
<title>mha_v_6</title>
<polygon fill="lightblue" stroke="lightblue" points="3274.5,-13710.08 2865.5,-13710.08 2865.5,-13642.08 3274.5,-13642.08 3274.5,-13710.08"/>
<text text-anchor="middle" x="3070" y="-13694.88" font-family="Times,serif" font-size="14.00">GPU6_Layer6_MHA_V</text>
<text text-anchor="middle" x="3070" y="-13679.88" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="3070" y="-13664.88" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3070" y="-13649.88" font-family="Times,serif" font-size="14.00">Device: GPU&#45;6</text>
</g>
<!-- attn_out_6 -->
<g id="node89" class="node">
<title>attn_out_6</title>
<polygon fill="lightblue" stroke="lightblue" points="3112.5,-13598.58 2687.5,-13598.58 2687.5,-13515.58 3112.5,-13515.58 3112.5,-13598.58"/>
<text text-anchor="middle" x="2900" y="-13583.38" font-family="Times,serif" font-size="14.00">GPU6_Layer6_Attn_Out</text>
<text text-anchor="middle" x="2900" y="-13568.38" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="2900" y="-13553.38" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2900" y="-13538.38" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2900" y="-13523.38" font-family="Times,serif" font-size="14.00">Device: GPU&#45;6</text>
</g>
<!-- mha_v_6&#45;&gt;attn_out_6 -->
<g id="edge121" class="edge">
<title>mha_v_6&#45;&gt;attn_out_6</title>
<path fill="none" stroke="black" d="M3021.74,-13641.87C3004.8,-13630.21 2985.45,-13616.89 2967.24,-13604.35"/>
<polygon fill="black" stroke="black" points="2969.18,-13601.45 2958.96,-13598.66 2965.22,-13607.21 2969.18,-13601.45"/>
</g>
<!-- attn_score_6&#45;&gt;attn_out_6 -->
<g id="edge120" class="edge">
<title>attn_score_6&#45;&gt;attn_out_6</title>
<path fill="none" stroke="black" d="M2725.63,-13634.49C2749.04,-13624.23 2774.29,-13613.17 2798.12,-13602.72"/>
<polygon fill="black" stroke="black" points="2799.77,-13605.82 2807.53,-13598.6 2796.97,-13599.41 2799.77,-13605.82"/>
</g>
<!-- attn_residual_6 -->
<g id="node90" class="node">
<title>attn_residual_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3275.11,-13479.58 2678.39,-13479.58 2524.89,-13313.58 3121.61,-13313.58 3275.11,-13479.58"/>
<text text-anchor="middle" x="2900" y="-13422.88" font-family="Times,serif" font-size="14.00">GPU6_Layer6_Attn_Residual</text>
<text text-anchor="middle" x="2900" y="-13407.88" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2900" y="-13392.88" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2900" y="-13377.88" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2900" y="-13362.88" font-family="Times,serif" font-size="14.00">Device: GPU&#45;6</text>
</g>
<!-- attn_out_6&#45;&gt;attn_residual_6 -->
<g id="edge122" class="edge">
<title>attn_out_6&#45;&gt;attn_residual_6</title>
<path fill="none" stroke="black" d="M2900,-13515.26C2900,-13507.33 2900,-13498.72 2900,-13489.89"/>
<polygon fill="black" stroke="black" points="2903.5,-13489.85 2900,-13479.85 2896.5,-13489.85 2903.5,-13489.85"/>
</g>
<!-- layernorm1_6 -->
<g id="node91" class="node">
<title>layernorm1_6</title>
<polygon fill="lightblue" stroke="lightblue" points="3112,-13277.58 2750,-13277.58 2750,-13209.58 3112,-13209.58 3112,-13277.58"/>
<text text-anchor="middle" x="2931" y="-13262.38" font-family="Times,serif" font-size="14.00">GPU6_Layer6_LayerNorm1</text>
<text text-anchor="middle" x="2931" y="-13247.38" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2931" y="-13232.38" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2931" y="-13217.38" font-family="Times,serif" font-size="14.00">Device: GPU&#45;6</text>
</g>
<!-- attn_residual_6&#45;&gt;layernorm1_6 -->
<g id="edge124" class="edge">
<title>attn_residual_6&#45;&gt;layernorm1_6</title>
<path fill="none" stroke="black" d="M2916.86,-13313.45C2918.68,-13304.6 2920.47,-13295.87 2922.14,-13287.76"/>
<polygon fill="black" stroke="black" points="2925.59,-13288.34 2924.17,-13277.84 2918.73,-13286.93 2925.59,-13288.34"/>
</g>
<!-- ffn_up_6 -->
<g id="node92" class="node">
<title>ffn_up_6</title>
<polygon fill="lightblue" stroke="lightblue" points="2769,-13173.58 2419,-13173.58 2419,-13105.58 2769,-13105.58 2769,-13173.58"/>
<text text-anchor="middle" x="2594" y="-13158.38" font-family="Times,serif" font-size="14.00">GPU6_Layer6_FFN_Up</text>
<text text-anchor="middle" x="2594" y="-13143.38" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2594" y="-13128.38" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="2594" y="-13113.38" font-family="Times,serif" font-size="14.00">Device: GPU&#45;6</text>
</g>
<!-- layernorm1_6&#45;&gt;ffn_up_6 -->
<g id="edge125" class="edge">
<title>layernorm1_6&#45;&gt;ffn_up_6</title>
<path fill="none" stroke="black" d="M2821.59,-13209.46C2786.89,-13198.96 2748.37,-13187.3 2713.03,-13176.61"/>
<polygon fill="black" stroke="black" points="2713.74,-13173.16 2703.15,-13173.62 2711.71,-13179.86 2713.74,-13173.16"/>
</g>
<!-- ffn_gate_6 -->
<g id="node93" class="node">
<title>ffn_gate_6</title>
<polygon fill="lightblue" stroke="lightblue" points="3137,-13173.58 2787,-13173.58 2787,-13105.58 3137,-13105.58 3137,-13173.58"/>
<text text-anchor="middle" x="2962" y="-13158.38" font-family="Times,serif" font-size="14.00">GPU6_Layer6_FFN_Gate</text>
<text text-anchor="middle" x="2962" y="-13143.38" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2962" y="-13128.38" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="2962" y="-13113.38" font-family="Times,serif" font-size="14.00">Device: GPU&#45;6</text>
</g>
<!-- layernorm1_6&#45;&gt;ffn_gate_6 -->
<g id="edge126" class="edge">
<title>layernorm1_6&#45;&gt;ffn_gate_6</title>
<path fill="none" stroke="black" d="M2941.06,-13209.46C2943.58,-13201.18 2946.32,-13192.17 2948.96,-13183.49"/>
<polygon fill="black" stroke="black" points="2952.32,-13184.46 2951.88,-13173.88 2945.62,-13182.43 2952.32,-13184.46"/>
</g>
<!-- ffn_residual_6 -->
<g id="node96" class="node">
<title>ffn_residual_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3275.11,-12861.58 2678.39,-12861.58 2524.89,-12695.58 3121.61,-12695.58 3275.11,-12861.58"/>
<text text-anchor="middle" x="2900" y="-12804.88" font-family="Times,serif" font-size="14.00">GPU6_Layer6_FFN_Residual</text>
<text text-anchor="middle" x="2900" y="-12789.88" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2900" y="-12774.88" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2900" y="-12759.88" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2900" y="-12744.88" font-family="Times,serif" font-size="14.00">Device: GPU&#45;6</text>
</g>
<!-- layernorm1_6&#45;&gt;ffn_residual_6 -->
<g id="edge131" class="edge">
<title>layernorm1_6&#45;&gt;ffn_residual_6</title>
<path fill="none" stroke="black" d="M3105.21,-13209.47C3121.03,-13200.21 3135.14,-13188.47 3146,-13173.58 3163.81,-13149.16 3149.96,-13135.54 3146,-13105.58 3133.45,-13010.67 3147.1,-12974.43 3090,-12897.58 3082.25,-12887.15 3073.28,-12877.43 3063.54,-12868.41"/>
<polygon fill="black" stroke="black" points="3065.74,-12865.69 3055.95,-12861.65 3061.09,-12870.91 3065.74,-12865.69"/>
</g>
<!-- ffn_act_6 -->
<g id="node94" class="node">
<title>ffn_act_6</title>
<polygon fill="lightblue" stroke="lightblue" points="3070.5,-13069.58 2729.5,-13069.58 2729.5,-13001.58 3070.5,-13001.58 3070.5,-13069.58"/>
<text text-anchor="middle" x="2900" y="-13054.38" font-family="Times,serif" font-size="14.00">GPU6_Layer6_FFN_Act</text>
<text text-anchor="middle" x="2900" y="-13039.38" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="2900" y="-13024.38" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="2900" y="-13009.38" font-family="Times,serif" font-size="14.00">Device: GPU&#45;6</text>
</g>
<!-- ffn_up_6&#45;&gt;ffn_act_6 -->
<g id="edge127" class="edge">
<title>ffn_up_6&#45;&gt;ffn_act_6</title>
<path fill="none" stroke="black" d="M2693.35,-13105.46C2724.58,-13095.05 2759.23,-13083.5 2791.1,-13072.88"/>
<polygon fill="black" stroke="black" points="2792.51,-13076.1 2800.89,-13069.62 2790.29,-13069.46 2792.51,-13076.1"/>
</g>
<!-- ffn_gate_6&#45;&gt;ffn_act_6 -->
<g id="edge128" class="edge">
<title>ffn_gate_6&#45;&gt;ffn_act_6</title>
<path fill="none" stroke="black" d="M2941.87,-13105.46C2936.67,-13096.91 2931.01,-13087.59 2925.57,-13078.65"/>
<polygon fill="black" stroke="black" points="2928.43,-13076.61 2920.24,-13069.88 2922.44,-13080.24 2928.43,-13076.61"/>
</g>
<!-- ffn_down_6 -->
<g id="node95" class="node">
<title>ffn_down_6</title>
<polygon fill="lightblue" stroke="lightblue" points="3081,-12965.58 2719,-12965.58 2719,-12897.58 3081,-12897.58 3081,-12965.58"/>
<text text-anchor="middle" x="2900" y="-12950.38" font-family="Times,serif" font-size="14.00">GPU6_Layer6_FFN_Down</text>
<text text-anchor="middle" x="2900" y="-12935.38" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="2900" y="-12920.38" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2900" y="-12905.38" font-family="Times,serif" font-size="14.00">Device: GPU&#45;6</text>
</g>
<!-- ffn_act_6&#45;&gt;ffn_down_6 -->
<g id="edge129" class="edge">
<title>ffn_act_6&#45;&gt;ffn_down_6</title>
<path fill="none" stroke="black" d="M2900,-13001.46C2900,-12993.36 2900,-12984.56 2900,-12976.05"/>
<polygon fill="black" stroke="black" points="2903.5,-12975.88 2900,-12965.88 2896.5,-12975.88 2903.5,-12975.88"/>
</g>
<!-- ffn_down_6&#45;&gt;ffn_residual_6 -->
<g id="edge130" class="edge">
<title>ffn_down_6&#45;&gt;ffn_residual_6</title>
<path fill="none" stroke="black" d="M2900,-12897.44C2900,-12889.68 2900,-12881.04 2900,-12872.06"/>
<polygon fill="black" stroke="black" points="2903.5,-12871.81 2900,-12861.81 2896.5,-12871.81 2903.5,-12871.81"/>
</g>
<!-- layernorm2_6 -->
<g id="node97" class="node">
<title>layernorm2_6</title>
<polygon fill="lightblue" stroke="lightblue" points="3081,-12659.58 2719,-12659.58 2719,-12591.58 3081,-12591.58 3081,-12659.58"/>
<text text-anchor="middle" x="2900" y="-12644.38" font-family="Times,serif" font-size="14.00">GPU6_Layer6_LayerNorm2</text>
<text text-anchor="middle" x="2900" y="-12629.38" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2900" y="-12614.38" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2900" y="-12599.38" font-family="Times,serif" font-size="14.00">Device: GPU&#45;6</text>
</g>
<!-- ffn_residual_6&#45;&gt;layernorm2_6 -->
<g id="edge132" class="edge">
<title>ffn_residual_6&#45;&gt;layernorm2_6</title>
<path fill="none" stroke="black" d="M2900,-12695.45C2900,-12686.7 2900,-12678.06 2900,-12670.03"/>
<polygon fill="black" stroke="black" points="2903.5,-12669.84 2900,-12659.84 2896.5,-12669.84 2903.5,-12669.84"/>
</g>
<!-- comm_6 -->
<g id="node221" class="node">
<title>comm_6</title>
<ellipse fill="lightgreen" stroke="lightgreen" cx="2900" cy="-12518.1" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="2900" y="-12529.4" font-family="Times,serif" font-size="14.00">GPU6_to_GPU7</text>
<text text-anchor="middle" x="2900" y="-12514.4" font-family="Times,serif" font-size="14.00">Transfer: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2900" y="-12499.4" font-family="Times,serif" font-size="14.00">Bandwidth: NVLink 900GB/s</text>
</g>
<!-- layernorm2_6&#45;&gt;comm_6 -->
<g id="edge133" class="edge">
<title>layernorm2_6&#45;&gt;comm_6</title>
<path fill="none" stroke="black" d="M2900,-12591.5C2900,-12583.33 2900,-12574.44 2900,-12565.76"/>
<polygon fill="black" stroke="black" points="2903.5,-12565.74 2900,-12555.74 2896.5,-12565.74 2903.5,-12565.74"/>
</g>
<!-- mha_q_7 -->
<g id="node98" class="node">
<title>mha_q_7</title>
<polygon fill="lightblue" stroke="lightblue" points="2988.5,-12441.63 2579.5,-12441.63 2579.5,-12373.63 2988.5,-12373.63 2988.5,-12441.63"/>
<text text-anchor="middle" x="2784" y="-12426.43" font-family="Times,serif" font-size="14.00">GPU7_Layer7_MHA_Q</text>
<text text-anchor="middle" x="2784" y="-12411.43" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2784" y="-12396.43" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2784" y="-12381.43" font-family="Times,serif" font-size="14.00">Device: GPU&#45;7</text>
</g>
<!-- attn_score_7 -->
<g id="node101" class="node">
<title>attn_score_7</title>
<polygon fill="lightblue" stroke="lightblue" points="2580,-12337.63 2152,-12337.63 2152,-12254.63 2580,-12254.63 2580,-12337.63"/>
<text text-anchor="middle" x="2366" y="-12322.43" font-family="Times,serif" font-size="14.00">GPU7_Layer7_Attn_Score</text>
<text text-anchor="middle" x="2366" y="-12307.43" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2366" y="-12292.43" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2366" y="-12277.43" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="2366" y="-12262.43" font-family="Times,serif" font-size="14.00">Device: GPU&#45;7</text>
</g>
<!-- mha_q_7&#45;&gt;attn_score_7 -->
<g id="edge137" class="edge">
<title>mha_q_7&#45;&gt;attn_score_7</title>
<path fill="none" stroke="black" d="M2658.02,-12373.62C2617.99,-12363.14 2573.11,-12351.38 2530.76,-12340.29"/>
<polygon fill="black" stroke="black" points="2531.48,-12336.86 2520.92,-12337.71 2529.7,-12343.63 2531.48,-12336.86"/>
</g>
<!-- mha_k_7 -->
<g id="node99" class="node">
<title>mha_k_7</title>
<polygon fill="lightblue" stroke="lightblue" points="2561.5,-12441.63 2152.5,-12441.63 2152.5,-12373.63 2561.5,-12373.63 2561.5,-12441.63"/>
<text text-anchor="middle" x="2357" y="-12426.43" font-family="Times,serif" font-size="14.00">GPU7_Layer7_MHA_K</text>
<text text-anchor="middle" x="2357" y="-12411.43" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2357" y="-12396.43" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2357" y="-12381.43" font-family="Times,serif" font-size="14.00">Device: GPU&#45;7</text>
</g>
<!-- mha_k_7&#45;&gt;attn_score_7 -->
<g id="edge138" class="edge">
<title>mha_k_7&#45;&gt;attn_score_7</title>
<path fill="none" stroke="black" d="M2359.72,-12373.48C2360.39,-12365.42 2361.11,-12356.63 2361.82,-12347.96"/>
<polygon fill="black" stroke="black" points="2365.32,-12348.16 2362.65,-12337.9 2358.34,-12347.58 2365.32,-12348.16"/>
</g>
<!-- mha_v_7 -->
<g id="node100" class="node">
<title>mha_v_7</title>
<polygon fill="lightblue" stroke="lightblue" points="3007.5,-12330.13 2598.5,-12330.13 2598.5,-12262.13 3007.5,-12262.13 3007.5,-12330.13"/>
<text text-anchor="middle" x="2803" y="-12314.93" font-family="Times,serif" font-size="14.00">GPU7_Layer7_MHA_V</text>
<text text-anchor="middle" x="2803" y="-12299.93" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2803" y="-12284.93" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2803" y="-12269.93" font-family="Times,serif" font-size="14.00">Device: GPU&#45;7</text>
</g>
<!-- attn_out_7 -->
<g id="node102" class="node">
<title>attn_out_7</title>
<polygon fill="lightblue" stroke="lightblue" points="2845.5,-12218.63 2420.5,-12218.63 2420.5,-12135.63 2845.5,-12135.63 2845.5,-12218.63"/>
<text text-anchor="middle" x="2633" y="-12203.43" font-family="Times,serif" font-size="14.00">GPU7_Layer7_Attn_Out</text>
<text text-anchor="middle" x="2633" y="-12188.43" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="2633" y="-12173.43" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2633" y="-12158.43" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2633" y="-12143.43" font-family="Times,serif" font-size="14.00">Device: GPU&#45;7</text>
</g>
<!-- mha_v_7&#45;&gt;attn_out_7 -->
<g id="edge140" class="edge">
<title>mha_v_7&#45;&gt;attn_out_7</title>
<path fill="none" stroke="black" d="M2754.74,-12261.91C2737.8,-12250.25 2718.45,-12236.94 2700.24,-12224.4"/>
<polygon fill="black" stroke="black" points="2702.18,-12221.49 2691.96,-12218.71 2698.22,-12227.26 2702.18,-12221.49"/>
</g>
<!-- attn_score_7&#45;&gt;attn_out_7 -->
<g id="edge139" class="edge">
<title>attn_score_7&#45;&gt;attn_out_7</title>
<path fill="none" stroke="black" d="M2458.63,-12254.53C2482.04,-12244.28 2507.29,-12233.21 2531.12,-12222.77"/>
<polygon fill="black" stroke="black" points="2532.77,-12225.87 2540.53,-12218.65 2529.97,-12219.46 2532.77,-12225.87"/>
</g>
<!-- attn_residual_7 -->
<g id="node103" class="node">
<title>attn_residual_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3008.11,-12099.63 2411.39,-12099.63 2257.89,-11933.63 2854.61,-11933.63 3008.11,-12099.63"/>
<text text-anchor="middle" x="2633" y="-12042.93" font-family="Times,serif" font-size="14.00">GPU7_Layer7_Attn_Residual</text>
<text text-anchor="middle" x="2633" y="-12027.93" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2633" y="-12012.93" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2633" y="-11997.93" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2633" y="-11982.93" font-family="Times,serif" font-size="14.00">Device: GPU&#45;7</text>
</g>
<!-- attn_out_7&#45;&gt;attn_residual_7 -->
<g id="edge141" class="edge">
<title>attn_out_7&#45;&gt;attn_residual_7</title>
<path fill="none" stroke="black" d="M2633,-12135.31C2633,-12127.38 2633,-12118.77 2633,-12109.94"/>
<polygon fill="black" stroke="black" points="2636.5,-12109.9 2633,-12099.9 2629.5,-12109.9 2636.5,-12109.9"/>
</g>
<!-- layernorm1_7 -->
<g id="node104" class="node">
<title>layernorm1_7</title>
<polygon fill="lightblue" stroke="lightblue" points="2845,-11897.63 2483,-11897.63 2483,-11829.63 2845,-11829.63 2845,-11897.63"/>
<text text-anchor="middle" x="2664" y="-11882.43" font-family="Times,serif" font-size="14.00">GPU7_Layer7_LayerNorm1</text>
<text text-anchor="middle" x="2664" y="-11867.43" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2664" y="-11852.43" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2664" y="-11837.43" font-family="Times,serif" font-size="14.00">Device: GPU&#45;7</text>
</g>
<!-- attn_residual_7&#45;&gt;layernorm1_7 -->
<g id="edge143" class="edge">
<title>attn_residual_7&#45;&gt;layernorm1_7</title>
<path fill="none" stroke="black" d="M2649.86,-11933.5C2651.68,-11924.65 2653.47,-11915.92 2655.14,-11907.8"/>
<polygon fill="black" stroke="black" points="2658.59,-11908.39 2657.17,-11897.89 2651.73,-11906.98 2658.59,-11908.39"/>
</g>
<!-- ffn_up_7 -->
<g id="node105" class="node">
<title>ffn_up_7</title>
<polygon fill="lightblue" stroke="lightblue" points="2502,-11793.63 2152,-11793.63 2152,-11725.63 2502,-11725.63 2502,-11793.63"/>
<text text-anchor="middle" x="2327" y="-11778.43" font-family="Times,serif" font-size="14.00">GPU7_Layer7_FFN_Up</text>
<text text-anchor="middle" x="2327" y="-11763.43" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2327" y="-11748.43" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="2327" y="-11733.43" font-family="Times,serif" font-size="14.00">Device: GPU&#45;7</text>
</g>
<!-- layernorm1_7&#45;&gt;ffn_up_7 -->
<g id="edge144" class="edge">
<title>layernorm1_7&#45;&gt;ffn_up_7</title>
<path fill="none" stroke="black" d="M2554.59,-11829.51C2519.89,-11819.01 2481.37,-11807.35 2446.03,-11796.65"/>
<polygon fill="black" stroke="black" points="2446.74,-11793.21 2436.15,-11793.66 2444.71,-11799.91 2446.74,-11793.21"/>
</g>
<!-- ffn_gate_7 -->
<g id="node106" class="node">
<title>ffn_gate_7</title>
<polygon fill="lightblue" stroke="lightblue" points="2870,-11793.63 2520,-11793.63 2520,-11725.63 2870,-11725.63 2870,-11793.63"/>
<text text-anchor="middle" x="2695" y="-11778.43" font-family="Times,serif" font-size="14.00">GPU7_Layer7_FFN_Gate</text>
<text text-anchor="middle" x="2695" y="-11763.43" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2695" y="-11748.43" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="2695" y="-11733.43" font-family="Times,serif" font-size="14.00">Device: GPU&#45;7</text>
</g>
<!-- layernorm1_7&#45;&gt;ffn_gate_7 -->
<g id="edge145" class="edge">
<title>layernorm1_7&#45;&gt;ffn_gate_7</title>
<path fill="none" stroke="black" d="M2674.06,-11829.51C2676.58,-11821.23 2679.32,-11812.22 2681.96,-11803.54"/>
<polygon fill="black" stroke="black" points="2685.32,-11804.51 2684.88,-11793.93 2678.62,-11802.48 2685.32,-11804.51"/>
</g>
<!-- ffn_residual_7 -->
<g id="node109" class="node">
<title>ffn_residual_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3008.11,-11481.63 2411.39,-11481.63 2257.89,-11315.63 2854.61,-11315.63 3008.11,-11481.63"/>
<text text-anchor="middle" x="2633" y="-11424.93" font-family="Times,serif" font-size="14.00">GPU7_Layer7_FFN_Residual</text>
<text text-anchor="middle" x="2633" y="-11409.93" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2633" y="-11394.93" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2633" y="-11379.93" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2633" y="-11364.93" font-family="Times,serif" font-size="14.00">Device: GPU&#45;7</text>
</g>
<!-- layernorm1_7&#45;&gt;ffn_residual_7 -->
<g id="edge150" class="edge">
<title>layernorm1_7&#45;&gt;ffn_residual_7</title>
<path fill="none" stroke="black" d="M2838.21,-11829.52C2854.03,-11820.26 2868.14,-11808.51 2879,-11793.63 2896.81,-11769.21 2882.96,-11755.59 2879,-11725.63 2866.45,-11630.72 2880.1,-11594.47 2823,-11517.63 2815.25,-11507.19 2806.28,-11497.47 2796.54,-11488.46"/>
<polygon fill="black" stroke="black" points="2798.74,-11485.73 2788.95,-11481.7 2794.09,-11490.96 2798.74,-11485.73"/>
</g>
<!-- ffn_act_7 -->
<g id="node107" class="node">
<title>ffn_act_7</title>
<polygon fill="lightblue" stroke="lightblue" points="2803.5,-11689.63 2462.5,-11689.63 2462.5,-11621.63 2803.5,-11621.63 2803.5,-11689.63"/>
<text text-anchor="middle" x="2633" y="-11674.43" font-family="Times,serif" font-size="14.00">GPU7_Layer7_FFN_Act</text>
<text text-anchor="middle" x="2633" y="-11659.43" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="2633" y="-11644.43" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="2633" y="-11629.43" font-family="Times,serif" font-size="14.00">Device: GPU&#45;7</text>
</g>
<!-- ffn_up_7&#45;&gt;ffn_act_7 -->
<g id="edge146" class="edge">
<title>ffn_up_7&#45;&gt;ffn_act_7</title>
<path fill="none" stroke="black" d="M2426.35,-11725.51C2457.58,-11715.1 2492.23,-11703.55 2524.1,-11692.93"/>
<polygon fill="black" stroke="black" points="2525.51,-11696.15 2533.89,-11689.66 2523.29,-11689.51 2525.51,-11696.15"/>
</g>
<!-- ffn_gate_7&#45;&gt;ffn_act_7 -->
<g id="edge147" class="edge">
<title>ffn_gate_7&#45;&gt;ffn_act_7</title>
<path fill="none" stroke="black" d="M2674.87,-11725.51C2669.67,-11716.96 2664.01,-11707.64 2658.57,-11698.7"/>
<polygon fill="black" stroke="black" points="2661.43,-11696.65 2653.24,-11689.93 2655.44,-11700.29 2661.43,-11696.65"/>
</g>
<!-- ffn_down_7 -->
<g id="node108" class="node">
<title>ffn_down_7</title>
<polygon fill="lightblue" stroke="lightblue" points="2814,-11585.63 2452,-11585.63 2452,-11517.63 2814,-11517.63 2814,-11585.63"/>
<text text-anchor="middle" x="2633" y="-11570.43" font-family="Times,serif" font-size="14.00">GPU7_Layer7_FFN_Down</text>
<text text-anchor="middle" x="2633" y="-11555.43" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="2633" y="-11540.43" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2633" y="-11525.43" font-family="Times,serif" font-size="14.00">Device: GPU&#45;7</text>
</g>
<!-- ffn_act_7&#45;&gt;ffn_down_7 -->
<g id="edge148" class="edge">
<title>ffn_act_7&#45;&gt;ffn_down_7</title>
<path fill="none" stroke="black" d="M2633,-11621.51C2633,-11613.4 2633,-11604.61 2633,-11596.1"/>
<polygon fill="black" stroke="black" points="2636.5,-11595.93 2633,-11585.93 2629.5,-11595.93 2636.5,-11595.93"/>
</g>
<!-- ffn_down_7&#45;&gt;ffn_residual_7 -->
<g id="edge149" class="edge">
<title>ffn_down_7&#45;&gt;ffn_residual_7</title>
<path fill="none" stroke="black" d="M2633,-11517.49C2633,-11509.73 2633,-11501.09 2633,-11492.11"/>
<polygon fill="black" stroke="black" points="2636.5,-11491.86 2633,-11481.86 2629.5,-11491.86 2636.5,-11491.86"/>
</g>
<!-- layernorm2_7 -->
<g id="node110" class="node">
<title>layernorm2_7</title>
<polygon fill="lightblue" stroke="lightblue" points="2814,-11279.63 2452,-11279.63 2452,-11211.63 2814,-11211.63 2814,-11279.63"/>
<text text-anchor="middle" x="2633" y="-11264.43" font-family="Times,serif" font-size="14.00">GPU7_Layer7_LayerNorm2</text>
<text text-anchor="middle" x="2633" y="-11249.43" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2633" y="-11234.43" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2633" y="-11219.43" font-family="Times,serif" font-size="14.00">Device: GPU&#45;7</text>
</g>
<!-- ffn_residual_7&#45;&gt;layernorm2_7 -->
<g id="edge151" class="edge">
<title>ffn_residual_7&#45;&gt;layernorm2_7</title>
<path fill="none" stroke="black" d="M2633,-11315.5C2633,-11306.74 2633,-11298.11 2633,-11290.07"/>
<polygon fill="black" stroke="black" points="2636.5,-11289.89 2633,-11279.89 2629.5,-11289.89 2636.5,-11289.89"/>
</g>
<!-- comm_7 -->
<g id="node222" class="node">
<title>comm_7</title>
<ellipse fill="lightgreen" stroke="lightgreen" cx="2633" cy="-11138.15" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="2633" y="-11149.45" font-family="Times,serif" font-size="14.00">GPU7_to_GPU8</text>
<text text-anchor="middle" x="2633" y="-11134.45" font-family="Times,serif" font-size="14.00">Transfer: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2633" y="-11119.45" font-family="Times,serif" font-size="14.00">Bandwidth: NVLink 900GB/s</text>
</g>
<!-- layernorm2_7&#45;&gt;comm_7 -->
<g id="edge152" class="edge">
<title>layernorm2_7&#45;&gt;comm_7</title>
<path fill="none" stroke="black" d="M2633,-11211.54C2633,-11203.38 2633,-11194.48 2633,-11185.81"/>
<polygon fill="black" stroke="black" points="2636.5,-11185.78 2633,-11175.78 2629.5,-11185.78 2636.5,-11185.78"/>
</g>
<!-- mha_q_8 -->
<g id="node111" class="node">
<title>mha_q_8</title>
<polygon fill="lightblue" stroke="lightblue" points="2721.5,-11061.67 2312.5,-11061.67 2312.5,-10993.67 2721.5,-10993.67 2721.5,-11061.67"/>
<text text-anchor="middle" x="2517" y="-11046.47" font-family="Times,serif" font-size="14.00">GPU8_Layer8_MHA_Q</text>
<text text-anchor="middle" x="2517" y="-11031.47" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2517" y="-11016.47" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2517" y="-11001.47" font-family="Times,serif" font-size="14.00">Device: GPU&#45;8</text>
</g>
<!-- attn_score_8 -->
<g id="node114" class="node">
<title>attn_score_8</title>
<polygon fill="lightblue" stroke="lightblue" points="2313,-10957.67 1885,-10957.67 1885,-10874.67 2313,-10874.67 2313,-10957.67"/>
<text text-anchor="middle" x="2099" y="-10942.47" font-family="Times,serif" font-size="14.00">GPU8_Layer8_Attn_Score</text>
<text text-anchor="middle" x="2099" y="-10927.47" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2099" y="-10912.47" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2099" y="-10897.47" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="2099" y="-10882.47" font-family="Times,serif" font-size="14.00">Device: GPU&#45;8</text>
</g>
<!-- mha_q_8&#45;&gt;attn_score_8 -->
<g id="edge156" class="edge">
<title>mha_q_8&#45;&gt;attn_score_8</title>
<path fill="none" stroke="black" d="M2391.02,-10993.67C2350.99,-10983.18 2306.11,-10971.43 2263.76,-10960.33"/>
<polygon fill="black" stroke="black" points="2264.48,-10956.9 2253.92,-10957.76 2262.7,-10963.68 2264.48,-10956.9"/>
</g>
<!-- mha_k_8 -->
<g id="node112" class="node">
<title>mha_k_8</title>
<polygon fill="lightblue" stroke="lightblue" points="2294.5,-11061.67 1885.5,-11061.67 1885.5,-10993.67 2294.5,-10993.67 2294.5,-11061.67"/>
<text text-anchor="middle" x="2090" y="-11046.47" font-family="Times,serif" font-size="14.00">GPU8_Layer8_MHA_K</text>
<text text-anchor="middle" x="2090" y="-11031.47" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2090" y="-11016.47" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2090" y="-11001.47" font-family="Times,serif" font-size="14.00">Device: GPU&#45;8</text>
</g>
<!-- mha_k_8&#45;&gt;attn_score_8 -->
<g id="edge157" class="edge">
<title>mha_k_8&#45;&gt;attn_score_8</title>
<path fill="none" stroke="black" d="M2092.72,-10993.52C2093.39,-10985.47 2094.11,-10976.67 2094.82,-10968.01"/>
<polygon fill="black" stroke="black" points="2098.32,-10968.2 2095.65,-10957.95 2091.34,-10967.63 2098.32,-10968.2"/>
</g>
<!-- mha_v_8 -->
<g id="node113" class="node">
<title>mha_v_8</title>
<polygon fill="lightblue" stroke="lightblue" points="2740.5,-10950.17 2331.5,-10950.17 2331.5,-10882.17 2740.5,-10882.17 2740.5,-10950.17"/>
<text text-anchor="middle" x="2536" y="-10934.97" font-family="Times,serif" font-size="14.00">GPU8_Layer8_MHA_V</text>
<text text-anchor="middle" x="2536" y="-10919.97" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2536" y="-10904.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2536" y="-10889.97" font-family="Times,serif" font-size="14.00">Device: GPU&#45;8</text>
</g>
<!-- attn_out_8 -->
<g id="node115" class="node">
<title>attn_out_8</title>
<polygon fill="lightblue" stroke="lightblue" points="2578.5,-10838.67 2153.5,-10838.67 2153.5,-10755.67 2578.5,-10755.67 2578.5,-10838.67"/>
<text text-anchor="middle" x="2366" y="-10823.47" font-family="Times,serif" font-size="14.00">GPU8_Layer8_Attn_Out</text>
<text text-anchor="middle" x="2366" y="-10808.47" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="2366" y="-10793.47" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2366" y="-10778.47" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2366" y="-10763.47" font-family="Times,serif" font-size="14.00">Device: GPU&#45;8</text>
</g>
<!-- mha_v_8&#45;&gt;attn_out_8 -->
<g id="edge159" class="edge">
<title>mha_v_8&#45;&gt;attn_out_8</title>
<path fill="none" stroke="black" d="M2487.74,-10881.96C2470.8,-10870.3 2451.45,-10856.98 2433.24,-10844.45"/>
<polygon fill="black" stroke="black" points="2435.18,-10841.54 2424.96,-10838.75 2431.22,-10847.31 2435.18,-10841.54"/>
</g>
<!-- attn_score_8&#45;&gt;attn_out_8 -->
<g id="edge158" class="edge">
<title>attn_score_8&#45;&gt;attn_out_8</title>
<path fill="none" stroke="black" d="M2191.63,-10874.58C2215.04,-10864.33 2240.29,-10853.26 2264.12,-10842.82"/>
<polygon fill="black" stroke="black" points="2265.77,-10845.91 2273.53,-10838.69 2262.97,-10839.5 2265.77,-10845.91"/>
</g>
<!-- attn_residual_8 -->
<g id="node116" class="node">
<title>attn_residual_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2741.11,-10719.67 2144.39,-10719.67 1990.89,-10553.67 2587.61,-10553.67 2741.11,-10719.67"/>
<text text-anchor="middle" x="2366" y="-10662.97" font-family="Times,serif" font-size="14.00">GPU8_Layer8_Attn_Residual</text>
<text text-anchor="middle" x="2366" y="-10647.97" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2366" y="-10632.97" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2366" y="-10617.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2366" y="-10602.97" font-family="Times,serif" font-size="14.00">Device: GPU&#45;8</text>
</g>
<!-- attn_out_8&#45;&gt;attn_residual_8 -->
<g id="edge160" class="edge">
<title>attn_out_8&#45;&gt;attn_residual_8</title>
<path fill="none" stroke="black" d="M2366,-10755.36C2366,-10747.43 2366,-10738.82 2366,-10729.99"/>
<polygon fill="black" stroke="black" points="2369.5,-10729.95 2366,-10719.95 2362.5,-10729.95 2369.5,-10729.95"/>
</g>
<!-- layernorm1_8 -->
<g id="node117" class="node">
<title>layernorm1_8</title>
<polygon fill="lightblue" stroke="lightblue" points="2578,-10517.67 2216,-10517.67 2216,-10449.67 2578,-10449.67 2578,-10517.67"/>
<text text-anchor="middle" x="2397" y="-10502.47" font-family="Times,serif" font-size="14.00">GPU8_Layer8_LayerNorm1</text>
<text text-anchor="middle" x="2397" y="-10487.47" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2397" y="-10472.47" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2397" y="-10457.47" font-family="Times,serif" font-size="14.00">Device: GPU&#45;8</text>
</g>
<!-- attn_residual_8&#45;&gt;layernorm1_8 -->
<g id="edge162" class="edge">
<title>attn_residual_8&#45;&gt;layernorm1_8</title>
<path fill="none" stroke="black" d="M2382.86,-10553.55C2384.68,-10544.69 2386.47,-10535.96 2388.14,-10527.85"/>
<polygon fill="black" stroke="black" points="2391.59,-10528.43 2390.17,-10517.93 2384.73,-10527.03 2391.59,-10528.43"/>
</g>
<!-- ffn_up_8 -->
<g id="node118" class="node">
<title>ffn_up_8</title>
<polygon fill="lightblue" stroke="lightblue" points="2235,-10413.67 1885,-10413.67 1885,-10345.67 2235,-10345.67 2235,-10413.67"/>
<text text-anchor="middle" x="2060" y="-10398.47" font-family="Times,serif" font-size="14.00">GPU8_Layer8_FFN_Up</text>
<text text-anchor="middle" x="2060" y="-10383.47" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2060" y="-10368.47" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="2060" y="-10353.47" font-family="Times,serif" font-size="14.00">Device: GPU&#45;8</text>
</g>
<!-- layernorm1_8&#45;&gt;ffn_up_8 -->
<g id="edge163" class="edge">
<title>layernorm1_8&#45;&gt;ffn_up_8</title>
<path fill="none" stroke="black" d="M2287.59,-10449.56C2252.89,-10439.06 2214.37,-10427.4 2179.03,-10416.7"/>
<polygon fill="black" stroke="black" points="2179.74,-10413.26 2169.15,-10413.71 2177.71,-10419.96 2179.74,-10413.26"/>
</g>
<!-- ffn_gate_8 -->
<g id="node119" class="node">
<title>ffn_gate_8</title>
<polygon fill="lightblue" stroke="lightblue" points="2603,-10413.67 2253,-10413.67 2253,-10345.67 2603,-10345.67 2603,-10413.67"/>
<text text-anchor="middle" x="2428" y="-10398.47" font-family="Times,serif" font-size="14.00">GPU8_Layer8_FFN_Gate</text>
<text text-anchor="middle" x="2428" y="-10383.47" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2428" y="-10368.47" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="2428" y="-10353.47" font-family="Times,serif" font-size="14.00">Device: GPU&#45;8</text>
</g>
<!-- layernorm1_8&#45;&gt;ffn_gate_8 -->
<g id="edge164" class="edge">
<title>layernorm1_8&#45;&gt;ffn_gate_8</title>
<path fill="none" stroke="black" d="M2407.06,-10449.56C2409.58,-10441.27 2412.32,-10432.27 2414.96,-10423.58"/>
<polygon fill="black" stroke="black" points="2418.32,-10424.56 2417.88,-10413.97 2411.62,-10422.52 2418.32,-10424.56"/>
</g>
<!-- ffn_residual_8 -->
<g id="node122" class="node">
<title>ffn_residual_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2741.11,-10101.67 2144.39,-10101.67 1990.89,-9935.67 2587.61,-9935.67 2741.11,-10101.67"/>
<text text-anchor="middle" x="2366" y="-10044.97" font-family="Times,serif" font-size="14.00">GPU8_Layer8_FFN_Residual</text>
<text text-anchor="middle" x="2366" y="-10029.97" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2366" y="-10014.97" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2366" y="-9999.97" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2366" y="-9984.97" font-family="Times,serif" font-size="14.00">Device: GPU&#45;8</text>
</g>
<!-- layernorm1_8&#45;&gt;ffn_residual_8 -->
<g id="edge169" class="edge">
<title>layernorm1_8&#45;&gt;ffn_residual_8</title>
<path fill="none" stroke="black" d="M2571.21,-10449.56C2587.03,-10440.31 2601.14,-10428.56 2612,-10413.67 2629.81,-10389.26 2615.96,-10375.63 2612,-10345.67 2599.45,-10250.76 2613.1,-10214.52 2556,-10137.67 2548.25,-10127.24 2539.28,-10117.52 2529.54,-10108.5"/>
<polygon fill="black" stroke="black" points="2531.74,-10105.78 2521.95,-10101.74 2527.09,-10111.01 2531.74,-10105.78"/>
</g>
<!-- ffn_act_8 -->
<g id="node120" class="node">
<title>ffn_act_8</title>
<polygon fill="lightblue" stroke="lightblue" points="2536.5,-10309.67 2195.5,-10309.67 2195.5,-10241.67 2536.5,-10241.67 2536.5,-10309.67"/>
<text text-anchor="middle" x="2366" y="-10294.47" font-family="Times,serif" font-size="14.00">GPU8_Layer8_FFN_Act</text>
<text text-anchor="middle" x="2366" y="-10279.47" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="2366" y="-10264.47" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="2366" y="-10249.47" font-family="Times,serif" font-size="14.00">Device: GPU&#45;8</text>
</g>
<!-- ffn_up_8&#45;&gt;ffn_act_8 -->
<g id="edge165" class="edge">
<title>ffn_up_8&#45;&gt;ffn_act_8</title>
<path fill="none" stroke="black" d="M2159.35,-10345.56C2190.58,-10335.15 2225.23,-10323.59 2257.1,-10312.97"/>
<polygon fill="black" stroke="black" points="2258.51,-10316.19 2266.89,-10309.71 2256.29,-10309.55 2258.51,-10316.19"/>
</g>
<!-- ffn_gate_8&#45;&gt;ffn_act_8 -->
<g id="edge166" class="edge">
<title>ffn_gate_8&#45;&gt;ffn_act_8</title>
<path fill="none" stroke="black" d="M2407.87,-10345.56C2402.67,-10337.01 2397.01,-10327.69 2391.57,-10318.75"/>
<polygon fill="black" stroke="black" points="2394.43,-10316.7 2386.24,-10309.97 2388.44,-10320.34 2394.43,-10316.7"/>
</g>
<!-- ffn_down_8 -->
<g id="node121" class="node">
<title>ffn_down_8</title>
<polygon fill="lightblue" stroke="lightblue" points="2547,-10205.67 2185,-10205.67 2185,-10137.67 2547,-10137.67 2547,-10205.67"/>
<text text-anchor="middle" x="2366" y="-10190.47" font-family="Times,serif" font-size="14.00">GPU8_Layer8_FFN_Down</text>
<text text-anchor="middle" x="2366" y="-10175.47" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="2366" y="-10160.47" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2366" y="-10145.47" font-family="Times,serif" font-size="14.00">Device: GPU&#45;8</text>
</g>
<!-- ffn_act_8&#45;&gt;ffn_down_8 -->
<g id="edge167" class="edge">
<title>ffn_act_8&#45;&gt;ffn_down_8</title>
<path fill="none" stroke="black" d="M2366,-10241.56C2366,-10233.45 2366,-10224.66 2366,-10216.15"/>
<polygon fill="black" stroke="black" points="2369.5,-10215.97 2366,-10205.97 2362.5,-10215.97 2369.5,-10215.97"/>
</g>
<!-- ffn_down_8&#45;&gt;ffn_residual_8 -->
<g id="edge168" class="edge">
<title>ffn_down_8&#45;&gt;ffn_residual_8</title>
<path fill="none" stroke="black" d="M2366,-10137.54C2366,-10129.78 2366,-10121.14 2366,-10112.16"/>
<polygon fill="black" stroke="black" points="2369.5,-10111.91 2366,-10101.91 2362.5,-10111.91 2369.5,-10111.91"/>
</g>
<!-- layernorm2_8 -->
<g id="node123" class="node">
<title>layernorm2_8</title>
<polygon fill="lightblue" stroke="lightblue" points="2547,-9899.67 2185,-9899.67 2185,-9831.67 2547,-9831.67 2547,-9899.67"/>
<text text-anchor="middle" x="2366" y="-9884.47" font-family="Times,serif" font-size="14.00">GPU8_Layer8_LayerNorm2</text>
<text text-anchor="middle" x="2366" y="-9869.47" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2366" y="-9854.47" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2366" y="-9839.47" font-family="Times,serif" font-size="14.00">Device: GPU&#45;8</text>
</g>
<!-- ffn_residual_8&#45;&gt;layernorm2_8 -->
<g id="edge170" class="edge">
<title>ffn_residual_8&#45;&gt;layernorm2_8</title>
<path fill="none" stroke="black" d="M2366,-9935.55C2366,-9926.79 2366,-9918.16 2366,-9910.12"/>
<polygon fill="black" stroke="black" points="2369.5,-9909.93 2366,-9899.93 2362.5,-9909.93 2369.5,-9909.93"/>
</g>
<!-- comm_8 -->
<g id="node223" class="node">
<title>comm_8</title>
<ellipse fill="lightgreen" stroke="lightgreen" cx="2366" cy="-9758.2" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="2366" y="-9769.5" font-family="Times,serif" font-size="14.00">GPU8_to_GPU9</text>
<text text-anchor="middle" x="2366" y="-9754.5" font-family="Times,serif" font-size="14.00">Transfer: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2366" y="-9739.5" font-family="Times,serif" font-size="14.00">Bandwidth: NVLink 900GB/s</text>
</g>
<!-- layernorm2_8&#45;&gt;comm_8 -->
<g id="edge171" class="edge">
<title>layernorm2_8&#45;&gt;comm_8</title>
<path fill="none" stroke="black" d="M2366,-9831.59C2366,-9823.43 2366,-9814.53 2366,-9805.85"/>
<polygon fill="black" stroke="black" points="2369.5,-9805.83 2366,-9795.83 2362.5,-9805.83 2369.5,-9805.83"/>
</g>
<!-- mha_q_9 -->
<g id="node124" class="node">
<title>mha_q_9</title>
<polygon fill="lightblue" stroke="lightblue" points="2454.5,-9681.72 2045.5,-9681.72 2045.5,-9613.72 2454.5,-9613.72 2454.5,-9681.72"/>
<text text-anchor="middle" x="2250" y="-9666.52" font-family="Times,serif" font-size="14.00">GPU9_Layer9_MHA_Q</text>
<text text-anchor="middle" x="2250" y="-9651.52" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2250" y="-9636.52" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2250" y="-9621.52" font-family="Times,serif" font-size="14.00">Device: GPU&#45;9</text>
</g>
<!-- attn_score_9 -->
<g id="node127" class="node">
<title>attn_score_9</title>
<polygon fill="lightblue" stroke="lightblue" points="2046,-9577.72 1618,-9577.72 1618,-9494.72 2046,-9494.72 2046,-9577.72"/>
<text text-anchor="middle" x="1832" y="-9562.52" font-family="Times,serif" font-size="14.00">GPU9_Layer9_Attn_Score</text>
<text text-anchor="middle" x="1832" y="-9547.52" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1832" y="-9532.52" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1832" y="-9517.52" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1832" y="-9502.52" font-family="Times,serif" font-size="14.00">Device: GPU&#45;9</text>
</g>
<!-- mha_q_9&#45;&gt;attn_score_9 -->
<g id="edge175" class="edge">
<title>mha_q_9&#45;&gt;attn_score_9</title>
<path fill="none" stroke="black" d="M2124.02,-9613.72C2083.99,-9603.23 2039.11,-9591.47 1996.76,-9580.38"/>
<polygon fill="black" stroke="black" points="1997.48,-9576.95 1986.92,-9577.8 1995.7,-9583.72 1997.48,-9576.95"/>
</g>
<!-- mha_k_9 -->
<g id="node125" class="node">
<title>mha_k_9</title>
<polygon fill="lightblue" stroke="lightblue" points="2027.5,-9681.72 1618.5,-9681.72 1618.5,-9613.72 2027.5,-9613.72 2027.5,-9681.72"/>
<text text-anchor="middle" x="1823" y="-9666.52" font-family="Times,serif" font-size="14.00">GPU9_Layer9_MHA_K</text>
<text text-anchor="middle" x="1823" y="-9651.52" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1823" y="-9636.52" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1823" y="-9621.52" font-family="Times,serif" font-size="14.00">Device: GPU&#45;9</text>
</g>
<!-- mha_k_9&#45;&gt;attn_score_9 -->
<g id="edge176" class="edge">
<title>mha_k_9&#45;&gt;attn_score_9</title>
<path fill="none" stroke="black" d="M1825.72,-9613.57C1826.39,-9605.52 1827.11,-9596.72 1827.82,-9588.06"/>
<polygon fill="black" stroke="black" points="1831.32,-9588.25 1828.65,-9578 1824.34,-9587.68 1831.32,-9588.25"/>
</g>
<!-- mha_v_9 -->
<g id="node126" class="node">
<title>mha_v_9</title>
<polygon fill="lightblue" stroke="lightblue" points="2473.5,-9570.22 2064.5,-9570.22 2064.5,-9502.22 2473.5,-9502.22 2473.5,-9570.22"/>
<text text-anchor="middle" x="2269" y="-9555.02" font-family="Times,serif" font-size="14.00">GPU9_Layer9_MHA_V</text>
<text text-anchor="middle" x="2269" y="-9540.02" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2269" y="-9525.02" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2269" y="-9510.02" font-family="Times,serif" font-size="14.00">Device: GPU&#45;9</text>
</g>
<!-- attn_out_9 -->
<g id="node128" class="node">
<title>attn_out_9</title>
<polygon fill="lightblue" stroke="lightblue" points="2311.5,-9458.72 1886.5,-9458.72 1886.5,-9375.72 2311.5,-9375.72 2311.5,-9458.72"/>
<text text-anchor="middle" x="2099" y="-9443.52" font-family="Times,serif" font-size="14.00">GPU9_Layer9_Attn_Out</text>
<text text-anchor="middle" x="2099" y="-9428.52" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="2099" y="-9413.52" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2099" y="-9398.52" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2099" y="-9383.52" font-family="Times,serif" font-size="14.00">Device: GPU&#45;9</text>
</g>
<!-- mha_v_9&#45;&gt;attn_out_9 -->
<g id="edge178" class="edge">
<title>mha_v_9&#45;&gt;attn_out_9</title>
<path fill="none" stroke="black" d="M2220.74,-9502.01C2203.8,-9490.35 2184.45,-9477.03 2166.24,-9464.49"/>
<polygon fill="black" stroke="black" points="2168.18,-9461.59 2157.96,-9458.8 2164.22,-9467.35 2168.18,-9461.59"/>
</g>
<!-- attn_score_9&#45;&gt;attn_out_9 -->
<g id="edge177" class="edge">
<title>attn_score_9&#45;&gt;attn_out_9</title>
<path fill="none" stroke="black" d="M1924.63,-9494.63C1948.04,-9484.37 1973.29,-9473.31 1997.12,-9462.86"/>
<polygon fill="black" stroke="black" points="1998.77,-9465.96 2006.53,-9458.74 1995.97,-9459.55 1998.77,-9465.96"/>
</g>
<!-- attn_residual_9 -->
<g id="node129" class="node">
<title>attn_residual_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2474.11,-9339.72 1877.39,-9339.72 1723.89,-9173.72 2320.61,-9173.72 2474.11,-9339.72"/>
<text text-anchor="middle" x="2099" y="-9283.02" font-family="Times,serif" font-size="14.00">GPU9_Layer9_Attn_Residual</text>
<text text-anchor="middle" x="2099" y="-9268.02" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2099" y="-9253.02" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2099" y="-9238.02" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2099" y="-9223.02" font-family="Times,serif" font-size="14.00">Device: GPU&#45;9</text>
</g>
<!-- attn_out_9&#45;&gt;attn_residual_9 -->
<g id="edge179" class="edge">
<title>attn_out_9&#45;&gt;attn_residual_9</title>
<path fill="none" stroke="black" d="M2099,-9375.4C2099,-9367.47 2099,-9358.86 2099,-9350.03"/>
<polygon fill="black" stroke="black" points="2102.5,-9349.99 2099,-9339.99 2095.5,-9349.99 2102.5,-9349.99"/>
</g>
<!-- layernorm1_9 -->
<g id="node130" class="node">
<title>layernorm1_9</title>
<polygon fill="lightblue" stroke="lightblue" points="2311,-9137.72 1949,-9137.72 1949,-9069.72 2311,-9069.72 2311,-9137.72"/>
<text text-anchor="middle" x="2130" y="-9122.52" font-family="Times,serif" font-size="14.00">GPU9_Layer9_LayerNorm1</text>
<text text-anchor="middle" x="2130" y="-9107.52" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2130" y="-9092.52" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2130" y="-9077.52" font-family="Times,serif" font-size="14.00">Device: GPU&#45;9</text>
</g>
<!-- attn_residual_9&#45;&gt;layernorm1_9 -->
<g id="edge181" class="edge">
<title>attn_residual_9&#45;&gt;layernorm1_9</title>
<path fill="none" stroke="black" d="M2115.86,-9173.59C2117.68,-9164.74 2119.47,-9156.01 2121.14,-9147.9"/>
<polygon fill="black" stroke="black" points="2124.59,-9148.48 2123.17,-9137.98 2117.73,-9147.07 2124.59,-9148.48"/>
</g>
<!-- ffn_up_9 -->
<g id="node131" class="node">
<title>ffn_up_9</title>
<polygon fill="lightblue" stroke="lightblue" points="1968,-9033.72 1618,-9033.72 1618,-8965.72 1968,-8965.72 1968,-9033.72"/>
<text text-anchor="middle" x="1793" y="-9018.52" font-family="Times,serif" font-size="14.00">GPU9_Layer9_FFN_Up</text>
<text text-anchor="middle" x="1793" y="-9003.52" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1793" y="-8988.52" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1793" y="-8973.52" font-family="Times,serif" font-size="14.00">Device: GPU&#45;9</text>
</g>
<!-- layernorm1_9&#45;&gt;ffn_up_9 -->
<g id="edge182" class="edge">
<title>layernorm1_9&#45;&gt;ffn_up_9</title>
<path fill="none" stroke="black" d="M2020.59,-9069.6C1985.89,-9059.1 1947.37,-9047.44 1912.03,-9036.75"/>
<polygon fill="black" stroke="black" points="1912.74,-9033.3 1902.15,-9033.76 1910.71,-9040 1912.74,-9033.3"/>
</g>
<!-- ffn_gate_9 -->
<g id="node132" class="node">
<title>ffn_gate_9</title>
<polygon fill="lightblue" stroke="lightblue" points="2336,-9033.72 1986,-9033.72 1986,-8965.72 2336,-8965.72 2336,-9033.72"/>
<text text-anchor="middle" x="2161" y="-9018.52" font-family="Times,serif" font-size="14.00">GPU9_Layer9_FFN_Gate</text>
<text text-anchor="middle" x="2161" y="-9003.52" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2161" y="-8988.52" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="2161" y="-8973.52" font-family="Times,serif" font-size="14.00">Device: GPU&#45;9</text>
</g>
<!-- layernorm1_9&#45;&gt;ffn_gate_9 -->
<g id="edge183" class="edge">
<title>layernorm1_9&#45;&gt;ffn_gate_9</title>
<path fill="none" stroke="black" d="M2140.06,-9069.6C2142.58,-9061.32 2145.32,-9052.31 2147.96,-9043.63"/>
<polygon fill="black" stroke="black" points="2151.32,-9044.6 2150.88,-9034.02 2144.62,-9042.57 2151.32,-9044.6"/>
</g>
<!-- ffn_residual_9 -->
<g id="node135" class="node">
<title>ffn_residual_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2474.11,-8721.72 1877.39,-8721.72 1723.89,-8555.72 2320.61,-8555.72 2474.11,-8721.72"/>
<text text-anchor="middle" x="2099" y="-8665.02" font-family="Times,serif" font-size="14.00">GPU9_Layer9_FFN_Residual</text>
<text text-anchor="middle" x="2099" y="-8650.02" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2099" y="-8635.02" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2099" y="-8620.02" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2099" y="-8605.02" font-family="Times,serif" font-size="14.00">Device: GPU&#45;9</text>
</g>
<!-- layernorm1_9&#45;&gt;ffn_residual_9 -->
<g id="edge188" class="edge">
<title>layernorm1_9&#45;&gt;ffn_residual_9</title>
<path fill="none" stroke="black" d="M2304.21,-9069.61C2320.03,-9060.35 2334.14,-9048.61 2345,-9033.72 2362.81,-9009.3 2348.96,-8995.68 2345,-8965.72 2332.45,-8870.81 2346.1,-8834.57 2289,-8757.72 2281.25,-8747.29 2272.28,-8737.57 2262.54,-8728.55"/>
<polygon fill="black" stroke="black" points="2264.74,-8725.83 2254.95,-8721.79 2260.09,-8731.05 2264.74,-8725.83"/>
</g>
<!-- ffn_act_9 -->
<g id="node133" class="node">
<title>ffn_act_9</title>
<polygon fill="lightblue" stroke="lightblue" points="2269.5,-8929.72 1928.5,-8929.72 1928.5,-8861.72 2269.5,-8861.72 2269.5,-8929.72"/>
<text text-anchor="middle" x="2099" y="-8914.52" font-family="Times,serif" font-size="14.00">GPU9_Layer9_FFN_Act</text>
<text text-anchor="middle" x="2099" y="-8899.52" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="2099" y="-8884.52" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="2099" y="-8869.52" font-family="Times,serif" font-size="14.00">Device: GPU&#45;9</text>
</g>
<!-- ffn_up_9&#45;&gt;ffn_act_9 -->
<g id="edge184" class="edge">
<title>ffn_up_9&#45;&gt;ffn_act_9</title>
<path fill="none" stroke="black" d="M1892.35,-8965.6C1923.58,-8955.19 1958.23,-8943.64 1990.1,-8933.02"/>
<polygon fill="black" stroke="black" points="1991.51,-8936.24 1999.89,-8929.76 1989.29,-8929.6 1991.51,-8936.24"/>
</g>
<!-- ffn_gate_9&#45;&gt;ffn_act_9 -->
<g id="edge185" class="edge">
<title>ffn_gate_9&#45;&gt;ffn_act_9</title>
<path fill="none" stroke="black" d="M2140.87,-8965.6C2135.67,-8957.05 2130.01,-8947.73 2124.57,-8938.79"/>
<polygon fill="black" stroke="black" points="2127.43,-8936.75 2119.24,-8930.02 2121.44,-8940.38 2127.43,-8936.75"/>
</g>
<!-- ffn_down_9 -->
<g id="node134" class="node">
<title>ffn_down_9</title>
<polygon fill="lightblue" stroke="lightblue" points="2280,-8825.72 1918,-8825.72 1918,-8757.72 2280,-8757.72 2280,-8825.72"/>
<text text-anchor="middle" x="2099" y="-8810.52" font-family="Times,serif" font-size="14.00">GPU9_Layer9_FFN_Down</text>
<text text-anchor="middle" x="2099" y="-8795.52" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="2099" y="-8780.52" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2099" y="-8765.52" font-family="Times,serif" font-size="14.00">Device: GPU&#45;9</text>
</g>
<!-- ffn_act_9&#45;&gt;ffn_down_9 -->
<g id="edge186" class="edge">
<title>ffn_act_9&#45;&gt;ffn_down_9</title>
<path fill="none" stroke="black" d="M2099,-8861.6C2099,-8853.5 2099,-8844.7 2099,-8836.19"/>
<polygon fill="black" stroke="black" points="2102.5,-8836.02 2099,-8826.02 2095.5,-8836.02 2102.5,-8836.02"/>
</g>
<!-- ffn_down_9&#45;&gt;ffn_residual_9 -->
<g id="edge187" class="edge">
<title>ffn_down_9&#45;&gt;ffn_residual_9</title>
<path fill="none" stroke="black" d="M2099,-8757.58C2099,-8749.82 2099,-8741.18 2099,-8732.2"/>
<polygon fill="black" stroke="black" points="2102.5,-8731.95 2099,-8721.95 2095.5,-8731.95 2102.5,-8731.95"/>
</g>
<!-- layernorm2_9 -->
<g id="node136" class="node">
<title>layernorm2_9</title>
<polygon fill="lightblue" stroke="lightblue" points="2280,-8519.72 1918,-8519.72 1918,-8451.72 2280,-8451.72 2280,-8519.72"/>
<text text-anchor="middle" x="2099" y="-8504.52" font-family="Times,serif" font-size="14.00">GPU9_Layer9_LayerNorm2</text>
<text text-anchor="middle" x="2099" y="-8489.52" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2099" y="-8474.52" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2099" y="-8459.52" font-family="Times,serif" font-size="14.00">Device: GPU&#45;9</text>
</g>
<!-- ffn_residual_9&#45;&gt;layernorm2_9 -->
<g id="edge189" class="edge">
<title>ffn_residual_9&#45;&gt;layernorm2_9</title>
<path fill="none" stroke="black" d="M2099,-8555.59C2099,-8546.84 2099,-8538.2 2099,-8530.17"/>
<polygon fill="black" stroke="black" points="2102.5,-8529.98 2099,-8519.98 2095.5,-8529.98 2102.5,-8529.98"/>
</g>
<!-- comm_9 -->
<g id="node224" class="node">
<title>comm_9</title>
<ellipse fill="lightgreen" stroke="lightgreen" cx="2099" cy="-8378.24" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="2099" y="-8389.54" font-family="Times,serif" font-size="14.00">GPU9_to_GPU10</text>
<text text-anchor="middle" x="2099" y="-8374.54" font-family="Times,serif" font-size="14.00">Transfer: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2099" y="-8359.54" font-family="Times,serif" font-size="14.00">Bandwidth: NVLink 900GB/s</text>
</g>
<!-- layernorm2_9&#45;&gt;comm_9 -->
<g id="edge190" class="edge">
<title>layernorm2_9&#45;&gt;comm_9</title>
<path fill="none" stroke="black" d="M2099,-8451.64C2099,-8443.47 2099,-8434.58 2099,-8425.9"/>
<polygon fill="black" stroke="black" points="2102.5,-8425.88 2099,-8415.88 2095.5,-8425.88 2102.5,-8425.88"/>
</g>
<!-- mha_q_10 -->
<g id="node137" class="node">
<title>mha_q_10</title>
<polygon fill="lightblue" stroke="lightblue" points="2187.5,-8301.77 1778.5,-8301.77 1778.5,-8233.77 2187.5,-8233.77 2187.5,-8301.77"/>
<text text-anchor="middle" x="1983" y="-8286.57" font-family="Times,serif" font-size="14.00">GPU10_Layer10_MHA_Q</text>
<text text-anchor="middle" x="1983" y="-8271.57" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1983" y="-8256.57" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1983" y="-8241.57" font-family="Times,serif" font-size="14.00">Device: GPU&#45;10</text>
</g>
<!-- attn_score_10 -->
<g id="node140" class="node">
<title>attn_score_10</title>
<polygon fill="lightblue" stroke="lightblue" points="1779,-8197.77 1351,-8197.77 1351,-8114.77 1779,-8114.77 1779,-8197.77"/>
<text text-anchor="middle" x="1565" y="-8182.57" font-family="Times,serif" font-size="14.00">GPU10_Layer10_Attn_Score</text>
<text text-anchor="middle" x="1565" y="-8167.57" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1565" y="-8152.57" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1565" y="-8137.57" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1565" y="-8122.57" font-family="Times,serif" font-size="14.00">Device: GPU&#45;10</text>
</g>
<!-- mha_q_10&#45;&gt;attn_score_10 -->
<g id="edge194" class="edge">
<title>mha_q_10&#45;&gt;attn_score_10</title>
<path fill="none" stroke="black" d="M1857.02,-8233.76C1816.99,-8223.28 1772.11,-8211.52 1729.76,-8200.43"/>
<polygon fill="black" stroke="black" points="1730.48,-8197 1719.92,-8197.85 1728.7,-8203.77 1730.48,-8197"/>
</g>
<!-- mha_k_10 -->
<g id="node138" class="node">
<title>mha_k_10</title>
<polygon fill="lightblue" stroke="lightblue" points="1760.5,-8301.77 1351.5,-8301.77 1351.5,-8233.77 1760.5,-8233.77 1760.5,-8301.77"/>
<text text-anchor="middle" x="1556" y="-8286.57" font-family="Times,serif" font-size="14.00">GPU10_Layer10_MHA_K</text>
<text text-anchor="middle" x="1556" y="-8271.57" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1556" y="-8256.57" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1556" y="-8241.57" font-family="Times,serif" font-size="14.00">Device: GPU&#45;10</text>
</g>
<!-- mha_k_10&#45;&gt;attn_score_10 -->
<g id="edge195" class="edge">
<title>mha_k_10&#45;&gt;attn_score_10</title>
<path fill="none" stroke="black" d="M1558.72,-8233.62C1559.39,-8225.56 1560.11,-8216.77 1560.82,-8208.1"/>
<polygon fill="black" stroke="black" points="1564.32,-8208.3 1561.65,-8198.04 1557.34,-8207.72 1564.32,-8208.3"/>
</g>
<!-- mha_v_10 -->
<g id="node139" class="node">
<title>mha_v_10</title>
<polygon fill="lightblue" stroke="lightblue" points="2206.5,-8190.27 1797.5,-8190.27 1797.5,-8122.27 2206.5,-8122.27 2206.5,-8190.27"/>
<text text-anchor="middle" x="2002" y="-8175.07" font-family="Times,serif" font-size="14.00">GPU10_Layer10_MHA_V</text>
<text text-anchor="middle" x="2002" y="-8160.07" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="2002" y="-8145.07" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2002" y="-8130.07" font-family="Times,serif" font-size="14.00">Device: GPU&#45;10</text>
</g>
<!-- attn_out_10 -->
<g id="node141" class="node">
<title>attn_out_10</title>
<polygon fill="lightblue" stroke="lightblue" points="2044.5,-8078.77 1619.5,-8078.77 1619.5,-7995.77 2044.5,-7995.77 2044.5,-8078.77"/>
<text text-anchor="middle" x="1832" y="-8063.57" font-family="Times,serif" font-size="14.00">GPU10_Layer10_Attn_Out</text>
<text text-anchor="middle" x="1832" y="-8048.57" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1832" y="-8033.57" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1832" y="-8018.57" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1832" y="-8003.57" font-family="Times,serif" font-size="14.00">Device: GPU&#45;10</text>
</g>
<!-- mha_v_10&#45;&gt;attn_out_10 -->
<g id="edge197" class="edge">
<title>mha_v_10&#45;&gt;attn_out_10</title>
<path fill="none" stroke="black" d="M1953.74,-8122.05C1936.8,-8110.39 1917.45,-8097.08 1899.24,-8084.54"/>
<polygon fill="black" stroke="black" points="1901.18,-8081.63 1890.96,-8078.85 1897.22,-8087.4 1901.18,-8081.63"/>
</g>
<!-- attn_score_10&#45;&gt;attn_out_10 -->
<g id="edge196" class="edge">
<title>attn_score_10&#45;&gt;attn_out_10</title>
<path fill="none" stroke="black" d="M1657.63,-8114.67C1681.04,-8104.42 1706.29,-8093.35 1730.12,-8082.91"/>
<polygon fill="black" stroke="black" points="1731.77,-8086.01 1739.53,-8078.79 1728.97,-8079.6 1731.77,-8086.01"/>
</g>
<!-- attn_residual_10 -->
<g id="node142" class="node">
<title>attn_residual_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2207.11,-7959.77 1610.39,-7959.77 1456.89,-7793.77 2053.61,-7793.77 2207.11,-7959.77"/>
<text text-anchor="middle" x="1832" y="-7903.07" font-family="Times,serif" font-size="14.00">GPU10_Layer10_Attn_Residual</text>
<text text-anchor="middle" x="1832" y="-7888.07" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1832" y="-7873.07" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1832" y="-7858.07" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1832" y="-7843.07" font-family="Times,serif" font-size="14.00">Device: GPU&#45;10</text>
</g>
<!-- attn_out_10&#45;&gt;attn_residual_10 -->
<g id="edge198" class="edge">
<title>attn_out_10&#45;&gt;attn_residual_10</title>
<path fill="none" stroke="black" d="M1832,-7995.45C1832,-7987.52 1832,-7978.91 1832,-7970.08"/>
<polygon fill="black" stroke="black" points="1835.5,-7970.04 1832,-7960.04 1828.5,-7970.04 1835.5,-7970.04"/>
</g>
<!-- layernorm1_10 -->
<g id="node143" class="node">
<title>layernorm1_10</title>
<polygon fill="lightblue" stroke="lightblue" points="2044,-7757.77 1682,-7757.77 1682,-7689.77 2044,-7689.77 2044,-7757.77"/>
<text text-anchor="middle" x="1863" y="-7742.57" font-family="Times,serif" font-size="14.00">GPU10_Layer10_LayerNorm1</text>
<text text-anchor="middle" x="1863" y="-7727.57" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1863" y="-7712.57" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1863" y="-7697.57" font-family="Times,serif" font-size="14.00">Device: GPU&#45;10</text>
</g>
<!-- attn_residual_10&#45;&gt;layernorm1_10 -->
<g id="edge200" class="edge">
<title>attn_residual_10&#45;&gt;layernorm1_10</title>
<path fill="none" stroke="black" d="M1848.86,-7793.64C1850.68,-7784.79 1852.47,-7776.06 1854.14,-7767.94"/>
<polygon fill="black" stroke="black" points="1857.59,-7768.53 1856.17,-7758.03 1850.73,-7767.12 1857.59,-7768.53"/>
</g>
<!-- ffn_up_10 -->
<g id="node144" class="node">
<title>ffn_up_10</title>
<polygon fill="lightblue" stroke="lightblue" points="1701,-7653.77 1351,-7653.77 1351,-7585.77 1701,-7585.77 1701,-7653.77"/>
<text text-anchor="middle" x="1526" y="-7638.57" font-family="Times,serif" font-size="14.00">GPU10_Layer10_FFN_Up</text>
<text text-anchor="middle" x="1526" y="-7623.57" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1526" y="-7608.57" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1526" y="-7593.57" font-family="Times,serif" font-size="14.00">Device: GPU&#45;10</text>
</g>
<!-- layernorm1_10&#45;&gt;ffn_up_10 -->
<g id="edge201" class="edge">
<title>layernorm1_10&#45;&gt;ffn_up_10</title>
<path fill="none" stroke="black" d="M1753.59,-7689.65C1718.89,-7679.15 1680.37,-7667.49 1645.03,-7656.79"/>
<polygon fill="black" stroke="black" points="1645.74,-7653.35 1635.15,-7653.8 1643.71,-7660.05 1645.74,-7653.35"/>
</g>
<!-- ffn_gate_10 -->
<g id="node145" class="node">
<title>ffn_gate_10</title>
<polygon fill="lightblue" stroke="lightblue" points="2069,-7653.77 1719,-7653.77 1719,-7585.77 2069,-7585.77 2069,-7653.77"/>
<text text-anchor="middle" x="1894" y="-7638.57" font-family="Times,serif" font-size="14.00">GPU10_Layer10_FFN_Gate</text>
<text text-anchor="middle" x="1894" y="-7623.57" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1894" y="-7608.57" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1894" y="-7593.57" font-family="Times,serif" font-size="14.00">Device: GPU&#45;10</text>
</g>
<!-- layernorm1_10&#45;&gt;ffn_gate_10 -->
<g id="edge202" class="edge">
<title>layernorm1_10&#45;&gt;ffn_gate_10</title>
<path fill="none" stroke="black" d="M1873.06,-7689.65C1875.58,-7681.37 1878.32,-7672.36 1880.96,-7663.68"/>
<polygon fill="black" stroke="black" points="1884.32,-7664.65 1883.88,-7654.07 1877.62,-7662.62 1884.32,-7664.65"/>
</g>
<!-- ffn_residual_10 -->
<g id="node148" class="node">
<title>ffn_residual_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2207.11,-7341.77 1610.39,-7341.77 1456.89,-7175.77 2053.61,-7175.77 2207.11,-7341.77"/>
<text text-anchor="middle" x="1832" y="-7285.07" font-family="Times,serif" font-size="14.00">GPU10_Layer10_FFN_Residual</text>
<text text-anchor="middle" x="1832" y="-7270.07" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1832" y="-7255.07" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1832" y="-7240.07" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1832" y="-7225.07" font-family="Times,serif" font-size="14.00">Device: GPU&#45;10</text>
</g>
<!-- layernorm1_10&#45;&gt;ffn_residual_10 -->
<g id="edge207" class="edge">
<title>layernorm1_10&#45;&gt;ffn_residual_10</title>
<path fill="none" stroke="black" d="M2037.21,-7689.66C2053.03,-7680.4 2067.14,-7668.65 2078,-7653.77 2095.81,-7629.35 2081.96,-7615.73 2078,-7585.77 2065.45,-7490.86 2079.1,-7454.61 2022,-7377.77 2014.25,-7367.34 2005.28,-7357.61 1995.54,-7348.6"/>
<polygon fill="black" stroke="black" points="1997.74,-7345.87 1987.95,-7341.84 1993.09,-7351.1 1997.74,-7345.87"/>
</g>
<!-- ffn_act_10 -->
<g id="node146" class="node">
<title>ffn_act_10</title>
<polygon fill="lightblue" stroke="lightblue" points="2002.5,-7549.77 1661.5,-7549.77 1661.5,-7481.77 2002.5,-7481.77 2002.5,-7549.77"/>
<text text-anchor="middle" x="1832" y="-7534.57" font-family="Times,serif" font-size="14.00">GPU10_Layer10_FFN_Act</text>
<text text-anchor="middle" x="1832" y="-7519.57" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1832" y="-7504.57" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1832" y="-7489.57" font-family="Times,serif" font-size="14.00">Device: GPU&#45;10</text>
</g>
<!-- ffn_up_10&#45;&gt;ffn_act_10 -->
<g id="edge203" class="edge">
<title>ffn_up_10&#45;&gt;ffn_act_10</title>
<path fill="none" stroke="black" d="M1625.35,-7585.65C1656.58,-7575.24 1691.23,-7563.69 1723.1,-7553.07"/>
<polygon fill="black" stroke="black" points="1724.51,-7556.29 1732.89,-7549.8 1722.29,-7549.65 1724.51,-7556.29"/>
</g>
<!-- ffn_gate_10&#45;&gt;ffn_act_10 -->
<g id="edge204" class="edge">
<title>ffn_gate_10&#45;&gt;ffn_act_10</title>
<path fill="none" stroke="black" d="M1873.87,-7585.65C1868.67,-7577.1 1863.01,-7567.78 1857.57,-7558.84"/>
<polygon fill="black" stroke="black" points="1860.43,-7556.79 1852.24,-7550.07 1854.44,-7560.43 1860.43,-7556.79"/>
</g>
<!-- ffn_down_10 -->
<g id="node147" class="node">
<title>ffn_down_10</title>
<polygon fill="lightblue" stroke="lightblue" points="2013,-7445.77 1651,-7445.77 1651,-7377.77 2013,-7377.77 2013,-7445.77"/>
<text text-anchor="middle" x="1832" y="-7430.57" font-family="Times,serif" font-size="14.00">GPU10_Layer10_FFN_Down</text>
<text text-anchor="middle" x="1832" y="-7415.57" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1832" y="-7400.57" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1832" y="-7385.57" font-family="Times,serif" font-size="14.00">Device: GPU&#45;10</text>
</g>
<!-- ffn_act_10&#45;&gt;ffn_down_10 -->
<g id="edge205" class="edge">
<title>ffn_act_10&#45;&gt;ffn_down_10</title>
<path fill="none" stroke="black" d="M1832,-7481.65C1832,-7473.54 1832,-7464.75 1832,-7456.24"/>
<polygon fill="black" stroke="black" points="1835.5,-7456.07 1832,-7446.07 1828.5,-7456.07 1835.5,-7456.07"/>
</g>
<!-- ffn_down_10&#45;&gt;ffn_residual_10 -->
<g id="edge206" class="edge">
<title>ffn_down_10&#45;&gt;ffn_residual_10</title>
<path fill="none" stroke="black" d="M1832,-7377.63C1832,-7369.87 1832,-7361.23 1832,-7352.25"/>
<polygon fill="black" stroke="black" points="1835.5,-7352 1832,-7342 1828.5,-7352 1835.5,-7352"/>
</g>
<!-- layernorm2_10 -->
<g id="node149" class="node">
<title>layernorm2_10</title>
<polygon fill="lightblue" stroke="lightblue" points="2013,-7139.77 1651,-7139.77 1651,-7071.77 2013,-7071.77 2013,-7139.77"/>
<text text-anchor="middle" x="1832" y="-7124.57" font-family="Times,serif" font-size="14.00">GPU10_Layer10_LayerNorm2</text>
<text text-anchor="middle" x="1832" y="-7109.57" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1832" y="-7094.57" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1832" y="-7079.57" font-family="Times,serif" font-size="14.00">Device: GPU&#45;10</text>
</g>
<!-- ffn_residual_10&#45;&gt;layernorm2_10 -->
<g id="edge208" class="edge">
<title>ffn_residual_10&#45;&gt;layernorm2_10</title>
<path fill="none" stroke="black" d="M1832,-7175.64C1832,-7166.88 1832,-7158.25 1832,-7150.21"/>
<polygon fill="black" stroke="black" points="1835.5,-7150.03 1832,-7140.03 1828.5,-7150.03 1835.5,-7150.03"/>
</g>
<!-- comm_10 -->
<g id="node225" class="node">
<title>comm_10</title>
<ellipse fill="lightgreen" stroke="lightgreen" cx="1832" cy="-6998.29" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="1832" y="-7009.59" font-family="Times,serif" font-size="14.00">GPU10_to_GPU11</text>
<text text-anchor="middle" x="1832" y="-6994.59" font-family="Times,serif" font-size="14.00">Transfer: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1832" y="-6979.59" font-family="Times,serif" font-size="14.00">Bandwidth: NVLink 900GB/s</text>
</g>
<!-- layernorm2_10&#45;&gt;comm_10 -->
<g id="edge209" class="edge">
<title>layernorm2_10&#45;&gt;comm_10</title>
<path fill="none" stroke="black" d="M1832,-7071.68C1832,-7063.52 1832,-7054.62 1832,-7045.95"/>
<polygon fill="black" stroke="black" points="1835.5,-7045.92 1832,-7035.92 1828.5,-7045.92 1835.5,-7045.92"/>
</g>
<!-- mha_q_11 -->
<g id="node150" class="node">
<title>mha_q_11</title>
<polygon fill="lightblue" stroke="lightblue" points="1920.5,-6921.81 1511.5,-6921.81 1511.5,-6853.81 1920.5,-6853.81 1920.5,-6921.81"/>
<text text-anchor="middle" x="1716" y="-6906.61" font-family="Times,serif" font-size="14.00">GPU11_Layer11_MHA_Q</text>
<text text-anchor="middle" x="1716" y="-6891.61" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1716" y="-6876.61" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1716" y="-6861.61" font-family="Times,serif" font-size="14.00">Device: GPU&#45;11</text>
</g>
<!-- attn_score_11 -->
<g id="node153" class="node">
<title>attn_score_11</title>
<polygon fill="lightblue" stroke="lightblue" points="1512,-6817.81 1084,-6817.81 1084,-6734.81 1512,-6734.81 1512,-6817.81"/>
<text text-anchor="middle" x="1298" y="-6802.61" font-family="Times,serif" font-size="14.00">GPU11_Layer11_Attn_Score</text>
<text text-anchor="middle" x="1298" y="-6787.61" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1298" y="-6772.61" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1298" y="-6757.61" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1298" y="-6742.61" font-family="Times,serif" font-size="14.00">Device: GPU&#45;11</text>
</g>
<!-- mha_q_11&#45;&gt;attn_score_11 -->
<g id="edge213" class="edge">
<title>mha_q_11&#45;&gt;attn_score_11</title>
<path fill="none" stroke="black" d="M1590.02,-6853.81C1549.99,-6843.32 1505.11,-6831.57 1462.76,-6820.47"/>
<polygon fill="black" stroke="black" points="1463.48,-6817.04 1452.92,-6817.9 1461.7,-6823.82 1463.48,-6817.04"/>
</g>
<!-- mha_k_11 -->
<g id="node151" class="node">
<title>mha_k_11</title>
<polygon fill="lightblue" stroke="lightblue" points="1493.5,-6921.81 1084.5,-6921.81 1084.5,-6853.81 1493.5,-6853.81 1493.5,-6921.81"/>
<text text-anchor="middle" x="1289" y="-6906.61" font-family="Times,serif" font-size="14.00">GPU11_Layer11_MHA_K</text>
<text text-anchor="middle" x="1289" y="-6891.61" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1289" y="-6876.61" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1289" y="-6861.61" font-family="Times,serif" font-size="14.00">Device: GPU&#45;11</text>
</g>
<!-- mha_k_11&#45;&gt;attn_score_11 -->
<g id="edge214" class="edge">
<title>mha_k_11&#45;&gt;attn_score_11</title>
<path fill="none" stroke="black" d="M1291.72,-6853.66C1292.39,-6845.61 1293.11,-6836.81 1293.82,-6828.15"/>
<polygon fill="black" stroke="black" points="1297.32,-6828.34 1294.65,-6818.09 1290.34,-6827.77 1297.32,-6828.34"/>
</g>
<!-- mha_v_11 -->
<g id="node152" class="node">
<title>mha_v_11</title>
<polygon fill="lightblue" stroke="lightblue" points="1939.5,-6810.31 1530.5,-6810.31 1530.5,-6742.31 1939.5,-6742.31 1939.5,-6810.31"/>
<text text-anchor="middle" x="1735" y="-6795.11" font-family="Times,serif" font-size="14.00">GPU11_Layer11_MHA_V</text>
<text text-anchor="middle" x="1735" y="-6780.11" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1735" y="-6765.11" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1735" y="-6750.11" font-family="Times,serif" font-size="14.00">Device: GPU&#45;11</text>
</g>
<!-- attn_out_11 -->
<g id="node154" class="node">
<title>attn_out_11</title>
<polygon fill="lightblue" stroke="lightblue" points="1777.5,-6698.81 1352.5,-6698.81 1352.5,-6615.81 1777.5,-6615.81 1777.5,-6698.81"/>
<text text-anchor="middle" x="1565" y="-6683.61" font-family="Times,serif" font-size="14.00">GPU11_Layer11_Attn_Out</text>
<text text-anchor="middle" x="1565" y="-6668.61" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1565" y="-6653.61" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1565" y="-6638.61" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1565" y="-6623.61" font-family="Times,serif" font-size="14.00">Device: GPU&#45;11</text>
</g>
<!-- mha_v_11&#45;&gt;attn_out_11 -->
<g id="edge216" class="edge">
<title>mha_v_11&#45;&gt;attn_out_11</title>
<path fill="none" stroke="black" d="M1686.74,-6742.1C1669.8,-6730.44 1650.45,-6717.12 1632.24,-6704.59"/>
<polygon fill="black" stroke="black" points="1634.18,-6701.68 1623.96,-6698.89 1630.22,-6707.45 1634.18,-6701.68"/>
</g>
<!-- attn_score_11&#45;&gt;attn_out_11 -->
<g id="edge215" class="edge">
<title>attn_score_11&#45;&gt;attn_out_11</title>
<path fill="none" stroke="black" d="M1390.63,-6734.72C1414.04,-6724.47 1439.29,-6713.4 1463.12,-6702.96"/>
<polygon fill="black" stroke="black" points="1464.77,-6706.05 1472.53,-6698.83 1461.97,-6699.64 1464.77,-6706.05"/>
</g>
<!-- attn_residual_11 -->
<g id="node155" class="node">
<title>attn_residual_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1940.11,-6579.81 1343.39,-6579.81 1189.89,-6413.81 1786.61,-6413.81 1940.11,-6579.81"/>
<text text-anchor="middle" x="1565" y="-6523.11" font-family="Times,serif" font-size="14.00">GPU11_Layer11_Attn_Residual</text>
<text text-anchor="middle" x="1565" y="-6508.11" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1565" y="-6493.11" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1565" y="-6478.11" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1565" y="-6463.11" font-family="Times,serif" font-size="14.00">Device: GPU&#45;11</text>
</g>
<!-- attn_out_11&#45;&gt;attn_residual_11 -->
<g id="edge217" class="edge">
<title>attn_out_11&#45;&gt;attn_residual_11</title>
<path fill="none" stroke="black" d="M1565,-6615.5C1565,-6607.57 1565,-6598.96 1565,-6590.13"/>
<polygon fill="black" stroke="black" points="1568.5,-6590.09 1565,-6580.09 1561.5,-6590.09 1568.5,-6590.09"/>
</g>
<!-- layernorm1_11 -->
<g id="node156" class="node">
<title>layernorm1_11</title>
<polygon fill="lightblue" stroke="lightblue" points="1777,-6377.81 1415,-6377.81 1415,-6309.81 1777,-6309.81 1777,-6377.81"/>
<text text-anchor="middle" x="1596" y="-6362.61" font-family="Times,serif" font-size="14.00">GPU11_Layer11_LayerNorm1</text>
<text text-anchor="middle" x="1596" y="-6347.61" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1596" y="-6332.61" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1596" y="-6317.61" font-family="Times,serif" font-size="14.00">Device: GPU&#45;11</text>
</g>
<!-- attn_residual_11&#45;&gt;layernorm1_11 -->
<g id="edge219" class="edge">
<title>attn_residual_11&#45;&gt;layernorm1_11</title>
<path fill="none" stroke="black" d="M1581.86,-6413.69C1583.68,-6404.83 1585.47,-6396.1 1587.14,-6387.99"/>
<polygon fill="black" stroke="black" points="1590.59,-6388.57 1589.17,-6378.07 1583.73,-6387.17 1590.59,-6388.57"/>
</g>
<!-- ffn_up_11 -->
<g id="node157" class="node">
<title>ffn_up_11</title>
<polygon fill="lightblue" stroke="lightblue" points="1434,-6273.81 1084,-6273.81 1084,-6205.81 1434,-6205.81 1434,-6273.81"/>
<text text-anchor="middle" x="1259" y="-6258.61" font-family="Times,serif" font-size="14.00">GPU11_Layer11_FFN_Up</text>
<text text-anchor="middle" x="1259" y="-6243.61" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1259" y="-6228.61" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1259" y="-6213.61" font-family="Times,serif" font-size="14.00">Device: GPU&#45;11</text>
</g>
<!-- layernorm1_11&#45;&gt;ffn_up_11 -->
<g id="edge220" class="edge">
<title>layernorm1_11&#45;&gt;ffn_up_11</title>
<path fill="none" stroke="black" d="M1486.59,-6309.7C1451.89,-6299.2 1413.37,-6287.54 1378.03,-6276.84"/>
<polygon fill="black" stroke="black" points="1378.74,-6273.4 1368.15,-6273.85 1376.71,-6280.1 1378.74,-6273.4"/>
</g>
<!-- ffn_gate_11 -->
<g id="node158" class="node">
<title>ffn_gate_11</title>
<polygon fill="lightblue" stroke="lightblue" points="1802,-6273.81 1452,-6273.81 1452,-6205.81 1802,-6205.81 1802,-6273.81"/>
<text text-anchor="middle" x="1627" y="-6258.61" font-family="Times,serif" font-size="14.00">GPU11_Layer11_FFN_Gate</text>
<text text-anchor="middle" x="1627" y="-6243.61" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1627" y="-6228.61" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1627" y="-6213.61" font-family="Times,serif" font-size="14.00">Device: GPU&#45;11</text>
</g>
<!-- layernorm1_11&#45;&gt;ffn_gate_11 -->
<g id="edge221" class="edge">
<title>layernorm1_11&#45;&gt;ffn_gate_11</title>
<path fill="none" stroke="black" d="M1606.06,-6309.7C1608.58,-6301.41 1611.32,-6292.41 1613.96,-6283.72"/>
<polygon fill="black" stroke="black" points="1617.32,-6284.7 1616.88,-6274.11 1610.62,-6282.66 1617.32,-6284.7"/>
</g>
<!-- ffn_residual_11 -->
<g id="node161" class="node">
<title>ffn_residual_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1940.11,-5961.81 1343.39,-5961.81 1189.89,-5795.81 1786.61,-5795.81 1940.11,-5961.81"/>
<text text-anchor="middle" x="1565" y="-5905.11" font-family="Times,serif" font-size="14.00">GPU11_Layer11_FFN_Residual</text>
<text text-anchor="middle" x="1565" y="-5890.11" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1565" y="-5875.11" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1565" y="-5860.11" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1565" y="-5845.11" font-family="Times,serif" font-size="14.00">Device: GPU&#45;11</text>
</g>
<!-- layernorm1_11&#45;&gt;ffn_residual_11 -->
<g id="edge226" class="edge">
<title>layernorm1_11&#45;&gt;ffn_residual_11</title>
<path fill="none" stroke="black" d="M1770.21,-6309.7C1786.03,-6300.45 1800.14,-6288.7 1811,-6273.81 1828.81,-6249.4 1814.96,-6235.77 1811,-6205.81 1798.45,-6110.9 1812.1,-6074.66 1755,-5997.81 1747.25,-5987.38 1738.28,-5977.66 1728.54,-5968.64"/>
<polygon fill="black" stroke="black" points="1730.74,-5965.92 1720.95,-5961.88 1726.09,-5971.15 1730.74,-5965.92"/>
</g>
<!-- ffn_act_11 -->
<g id="node159" class="node">
<title>ffn_act_11</title>
<polygon fill="lightblue" stroke="lightblue" points="1735.5,-6169.81 1394.5,-6169.81 1394.5,-6101.81 1735.5,-6101.81 1735.5,-6169.81"/>
<text text-anchor="middle" x="1565" y="-6154.61" font-family="Times,serif" font-size="14.00">GPU11_Layer11_FFN_Act</text>
<text text-anchor="middle" x="1565" y="-6139.61" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1565" y="-6124.61" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1565" y="-6109.61" font-family="Times,serif" font-size="14.00">Device: GPU&#45;11</text>
</g>
<!-- ffn_up_11&#45;&gt;ffn_act_11 -->
<g id="edge222" class="edge">
<title>ffn_up_11&#45;&gt;ffn_act_11</title>
<path fill="none" stroke="black" d="M1358.35,-6205.7C1389.58,-6195.29 1424.23,-6183.73 1456.1,-6173.11"/>
<polygon fill="black" stroke="black" points="1457.51,-6176.33 1465.89,-6169.85 1455.29,-6169.69 1457.51,-6176.33"/>
</g>
<!-- ffn_gate_11&#45;&gt;ffn_act_11 -->
<g id="edge223" class="edge">
<title>ffn_gate_11&#45;&gt;ffn_act_11</title>
<path fill="none" stroke="black" d="M1606.87,-6205.7C1601.67,-6197.15 1596.01,-6187.83 1590.57,-6178.89"/>
<polygon fill="black" stroke="black" points="1593.43,-6176.84 1585.24,-6170.11 1587.44,-6180.48 1593.43,-6176.84"/>
</g>
<!-- ffn_down_11 -->
<g id="node160" class="node">
<title>ffn_down_11</title>
<polygon fill="lightblue" stroke="lightblue" points="1746,-6065.81 1384,-6065.81 1384,-5997.81 1746,-5997.81 1746,-6065.81"/>
<text text-anchor="middle" x="1565" y="-6050.61" font-family="Times,serif" font-size="14.00">GPU11_Layer11_FFN_Down</text>
<text text-anchor="middle" x="1565" y="-6035.61" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1565" y="-6020.61" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1565" y="-6005.61" font-family="Times,serif" font-size="14.00">Device: GPU&#45;11</text>
</g>
<!-- ffn_act_11&#45;&gt;ffn_down_11 -->
<g id="edge224" class="edge">
<title>ffn_act_11&#45;&gt;ffn_down_11</title>
<path fill="none" stroke="black" d="M1565,-6101.7C1565,-6093.59 1565,-6084.8 1565,-6076.29"/>
<polygon fill="black" stroke="black" points="1568.5,-6076.11 1565,-6066.11 1561.5,-6076.11 1568.5,-6076.11"/>
</g>
<!-- ffn_down_11&#45;&gt;ffn_residual_11 -->
<g id="edge225" class="edge">
<title>ffn_down_11&#45;&gt;ffn_residual_11</title>
<path fill="none" stroke="black" d="M1565,-5997.68C1565,-5989.92 1565,-5981.28 1565,-5972.3"/>
<polygon fill="black" stroke="black" points="1568.5,-5972.05 1565,-5962.05 1561.5,-5972.05 1568.5,-5972.05"/>
</g>
<!-- layernorm2_11 -->
<g id="node162" class="node">
<title>layernorm2_11</title>
<polygon fill="lightblue" stroke="lightblue" points="1746,-5759.81 1384,-5759.81 1384,-5691.81 1746,-5691.81 1746,-5759.81"/>
<text text-anchor="middle" x="1565" y="-5744.61" font-family="Times,serif" font-size="14.00">GPU11_Layer11_LayerNorm2</text>
<text text-anchor="middle" x="1565" y="-5729.61" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1565" y="-5714.61" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1565" y="-5699.61" font-family="Times,serif" font-size="14.00">Device: GPU&#45;11</text>
</g>
<!-- ffn_residual_11&#45;&gt;layernorm2_11 -->
<g id="edge227" class="edge">
<title>ffn_residual_11&#45;&gt;layernorm2_11</title>
<path fill="none" stroke="black" d="M1565,-5795.69C1565,-5786.93 1565,-5778.3 1565,-5770.26"/>
<polygon fill="black" stroke="black" points="1568.5,-5770.07 1565,-5760.07 1561.5,-5770.07 1568.5,-5770.07"/>
</g>
<!-- comm_11 -->
<g id="node226" class="node">
<title>comm_11</title>
<ellipse fill="lightgreen" stroke="lightgreen" cx="1565" cy="-5618.34" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="1565" y="-5629.64" font-family="Times,serif" font-size="14.00">GPU11_to_GPU12</text>
<text text-anchor="middle" x="1565" y="-5614.64" font-family="Times,serif" font-size="14.00">Transfer: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1565" y="-5599.64" font-family="Times,serif" font-size="14.00">Bandwidth: NVLink 900GB/s</text>
</g>
<!-- layernorm2_11&#45;&gt;comm_11 -->
<g id="edge228" class="edge">
<title>layernorm2_11&#45;&gt;comm_11</title>
<path fill="none" stroke="black" d="M1565,-5691.73C1565,-5683.57 1565,-5674.67 1565,-5665.99"/>
<polygon fill="black" stroke="black" points="1568.5,-5665.97 1565,-5655.97 1561.5,-5665.97 1568.5,-5665.97"/>
</g>
<!-- mha_q_12 -->
<g id="node163" class="node">
<title>mha_q_12</title>
<polygon fill="lightblue" stroke="lightblue" points="1653.5,-5541.86 1244.5,-5541.86 1244.5,-5473.86 1653.5,-5473.86 1653.5,-5541.86"/>
<text text-anchor="middle" x="1449" y="-5526.66" font-family="Times,serif" font-size="14.00">GPU12_Layer12_MHA_Q</text>
<text text-anchor="middle" x="1449" y="-5511.66" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1449" y="-5496.66" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1449" y="-5481.66" font-family="Times,serif" font-size="14.00">Device: GPU&#45;12</text>
</g>
<!-- attn_score_12 -->
<g id="node166" class="node">
<title>attn_score_12</title>
<polygon fill="lightblue" stroke="lightblue" points="1245,-5437.86 817,-5437.86 817,-5354.86 1245,-5354.86 1245,-5437.86"/>
<text text-anchor="middle" x="1031" y="-5422.66" font-family="Times,serif" font-size="14.00">GPU12_Layer12_Attn_Score</text>
<text text-anchor="middle" x="1031" y="-5407.66" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1031" y="-5392.66" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1031" y="-5377.66" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1031" y="-5362.66" font-family="Times,serif" font-size="14.00">Device: GPU&#45;12</text>
</g>
<!-- mha_q_12&#45;&gt;attn_score_12 -->
<g id="edge232" class="edge">
<title>mha_q_12&#45;&gt;attn_score_12</title>
<path fill="none" stroke="black" d="M1323.02,-5473.86C1282.99,-5463.37 1238.11,-5451.61 1195.76,-5440.52"/>
<polygon fill="black" stroke="black" points="1196.48,-5437.09 1185.92,-5437.94 1194.7,-5443.86 1196.48,-5437.09"/>
</g>
<!-- mha_k_12 -->
<g id="node164" class="node">
<title>mha_k_12</title>
<polygon fill="lightblue" stroke="lightblue" points="1226.5,-5541.86 817.5,-5541.86 817.5,-5473.86 1226.5,-5473.86 1226.5,-5541.86"/>
<text text-anchor="middle" x="1022" y="-5526.66" font-family="Times,serif" font-size="14.00">GPU12_Layer12_MHA_K</text>
<text text-anchor="middle" x="1022" y="-5511.66" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1022" y="-5496.66" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1022" y="-5481.66" font-family="Times,serif" font-size="14.00">Device: GPU&#45;12</text>
</g>
<!-- mha_k_12&#45;&gt;attn_score_12 -->
<g id="edge233" class="edge">
<title>mha_k_12&#45;&gt;attn_score_12</title>
<path fill="none" stroke="black" d="M1024.72,-5473.71C1025.39,-5465.66 1026.11,-5456.86 1026.82,-5448.2"/>
<polygon fill="black" stroke="black" points="1030.32,-5448.39 1027.65,-5438.14 1023.34,-5447.82 1030.32,-5448.39"/>
</g>
<!-- mha_v_12 -->
<g id="node165" class="node">
<title>mha_v_12</title>
<polygon fill="lightblue" stroke="lightblue" points="1672.5,-5430.36 1263.5,-5430.36 1263.5,-5362.36 1672.5,-5362.36 1672.5,-5430.36"/>
<text text-anchor="middle" x="1468" y="-5415.16" font-family="Times,serif" font-size="14.00">GPU12_Layer12_MHA_V</text>
<text text-anchor="middle" x="1468" y="-5400.16" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1468" y="-5385.16" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1468" y="-5370.16" font-family="Times,serif" font-size="14.00">Device: GPU&#45;12</text>
</g>
<!-- attn_out_12 -->
<g id="node167" class="node">
<title>attn_out_12</title>
<polygon fill="lightblue" stroke="lightblue" points="1510.5,-5318.86 1085.5,-5318.86 1085.5,-5235.86 1510.5,-5235.86 1510.5,-5318.86"/>
<text text-anchor="middle" x="1298" y="-5303.66" font-family="Times,serif" font-size="14.00">GPU12_Layer12_Attn_Out</text>
<text text-anchor="middle" x="1298" y="-5288.66" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1298" y="-5273.66" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1298" y="-5258.66" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1298" y="-5243.66" font-family="Times,serif" font-size="14.00">Device: GPU&#45;12</text>
</g>
<!-- mha_v_12&#45;&gt;attn_out_12 -->
<g id="edge235" class="edge">
<title>mha_v_12&#45;&gt;attn_out_12</title>
<path fill="none" stroke="black" d="M1419.74,-5362.15C1402.8,-5350.49 1383.45,-5337.17 1365.24,-5324.63"/>
<polygon fill="black" stroke="black" points="1367.18,-5321.73 1356.96,-5318.94 1363.22,-5327.49 1367.18,-5321.73"/>
</g>
<!-- attn_score_12&#45;&gt;attn_out_12 -->
<g id="edge234" class="edge">
<title>attn_score_12&#45;&gt;attn_out_12</title>
<path fill="none" stroke="black" d="M1123.63,-5354.77C1147.04,-5344.51 1172.29,-5333.45 1196.12,-5323"/>
<polygon fill="black" stroke="black" points="1197.77,-5326.1 1205.53,-5318.88 1194.97,-5319.69 1197.77,-5326.1"/>
</g>
<!-- attn_residual_12 -->
<g id="node168" class="node">
<title>attn_residual_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1673.11,-5199.86 1076.39,-5199.86 922.89,-5033.86 1519.61,-5033.86 1673.11,-5199.86"/>
<text text-anchor="middle" x="1298" y="-5143.16" font-family="Times,serif" font-size="14.00">GPU12_Layer12_Attn_Residual</text>
<text text-anchor="middle" x="1298" y="-5128.16" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1298" y="-5113.16" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1298" y="-5098.16" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1298" y="-5083.16" font-family="Times,serif" font-size="14.00">Device: GPU&#45;12</text>
</g>
<!-- attn_out_12&#45;&gt;attn_residual_12 -->
<g id="edge236" class="edge">
<title>attn_out_12&#45;&gt;attn_residual_12</title>
<path fill="none" stroke="black" d="M1298,-5235.54C1298,-5227.61 1298,-5219 1298,-5210.17"/>
<polygon fill="black" stroke="black" points="1301.5,-5210.13 1298,-5200.13 1294.5,-5210.13 1301.5,-5210.13"/>
</g>
<!-- layernorm1_12 -->
<g id="node169" class="node">
<title>layernorm1_12</title>
<polygon fill="lightblue" stroke="lightblue" points="1510,-4997.86 1148,-4997.86 1148,-4929.86 1510,-4929.86 1510,-4997.86"/>
<text text-anchor="middle" x="1329" y="-4982.66" font-family="Times,serif" font-size="14.00">GPU12_Layer12_LayerNorm1</text>
<text text-anchor="middle" x="1329" y="-4967.66" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1329" y="-4952.66" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1329" y="-4937.66" font-family="Times,serif" font-size="14.00">Device: GPU&#45;12</text>
</g>
<!-- attn_residual_12&#45;&gt;layernorm1_12 -->
<g id="edge238" class="edge">
<title>attn_residual_12&#45;&gt;layernorm1_12</title>
<path fill="none" stroke="black" d="M1314.86,-5033.73C1316.68,-5024.88 1318.47,-5016.15 1320.14,-5008.04"/>
<polygon fill="black" stroke="black" points="1323.59,-5008.62 1322.17,-4998.12 1316.73,-5007.21 1323.59,-5008.62"/>
</g>
<!-- ffn_up_12 -->
<g id="node170" class="node">
<title>ffn_up_12</title>
<polygon fill="lightblue" stroke="lightblue" points="1167,-4893.86 817,-4893.86 817,-4825.86 1167,-4825.86 1167,-4893.86"/>
<text text-anchor="middle" x="992" y="-4878.66" font-family="Times,serif" font-size="14.00">GPU12_Layer12_FFN_Up</text>
<text text-anchor="middle" x="992" y="-4863.66" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="992" y="-4848.66" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="992" y="-4833.66" font-family="Times,serif" font-size="14.00">Device: GPU&#45;12</text>
</g>
<!-- layernorm1_12&#45;&gt;ffn_up_12 -->
<g id="edge239" class="edge">
<title>layernorm1_12&#45;&gt;ffn_up_12</title>
<path fill="none" stroke="black" d="M1219.59,-4929.74C1184.89,-4919.24 1146.37,-4907.58 1111.03,-4896.89"/>
<polygon fill="black" stroke="black" points="1111.74,-4893.44 1101.15,-4893.9 1109.71,-4900.14 1111.74,-4893.44"/>
</g>
<!-- ffn_gate_12 -->
<g id="node171" class="node">
<title>ffn_gate_12</title>
<polygon fill="lightblue" stroke="lightblue" points="1535,-4893.86 1185,-4893.86 1185,-4825.86 1535,-4825.86 1535,-4893.86"/>
<text text-anchor="middle" x="1360" y="-4878.66" font-family="Times,serif" font-size="14.00">GPU12_Layer12_FFN_Gate</text>
<text text-anchor="middle" x="1360" y="-4863.66" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1360" y="-4848.66" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1360" y="-4833.66" font-family="Times,serif" font-size="14.00">Device: GPU&#45;12</text>
</g>
<!-- layernorm1_12&#45;&gt;ffn_gate_12 -->
<g id="edge240" class="edge">
<title>layernorm1_12&#45;&gt;ffn_gate_12</title>
<path fill="none" stroke="black" d="M1339.06,-4929.74C1341.58,-4921.46 1344.32,-4912.46 1346.96,-4903.77"/>
<polygon fill="black" stroke="black" points="1350.32,-4904.74 1349.88,-4894.16 1343.62,-4902.71 1350.32,-4904.74"/>
</g>
<!-- ffn_residual_12 -->
<g id="node174" class="node">
<title>ffn_residual_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1673.11,-4581.86 1076.39,-4581.86 922.89,-4415.86 1519.61,-4415.86 1673.11,-4581.86"/>
<text text-anchor="middle" x="1298" y="-4525.16" font-family="Times,serif" font-size="14.00">GPU12_Layer12_FFN_Residual</text>
<text text-anchor="middle" x="1298" y="-4510.16" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1298" y="-4495.16" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1298" y="-4480.16" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1298" y="-4465.16" font-family="Times,serif" font-size="14.00">Device: GPU&#45;12</text>
</g>
<!-- layernorm1_12&#45;&gt;ffn_residual_12 -->
<g id="edge245" class="edge">
<title>layernorm1_12&#45;&gt;ffn_residual_12</title>
<path fill="none" stroke="black" d="M1503.21,-4929.75C1519.03,-4920.49 1533.14,-4908.75 1544,-4893.86 1561.81,-4869.44 1547.96,-4855.82 1544,-4825.86 1531.45,-4730.95 1545.1,-4694.71 1488,-4617.86 1480.25,-4607.43 1471.28,-4597.71 1461.54,-4588.69"/>
<polygon fill="black" stroke="black" points="1463.74,-4585.97 1453.95,-4581.93 1459.09,-4591.19 1463.74,-4585.97"/>
</g>
<!-- ffn_act_12 -->
<g id="node172" class="node">
<title>ffn_act_12</title>
<polygon fill="lightblue" stroke="lightblue" points="1468.5,-4789.86 1127.5,-4789.86 1127.5,-4721.86 1468.5,-4721.86 1468.5,-4789.86"/>
<text text-anchor="middle" x="1298" y="-4774.66" font-family="Times,serif" font-size="14.00">GPU12_Layer12_FFN_Act</text>
<text text-anchor="middle" x="1298" y="-4759.66" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1298" y="-4744.66" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1298" y="-4729.66" font-family="Times,serif" font-size="14.00">Device: GPU&#45;12</text>
</g>
<!-- ffn_up_12&#45;&gt;ffn_act_12 -->
<g id="edge241" class="edge">
<title>ffn_up_12&#45;&gt;ffn_act_12</title>
<path fill="none" stroke="black" d="M1091.35,-4825.74C1122.58,-4815.33 1157.23,-4803.78 1189.1,-4793.16"/>
<polygon fill="black" stroke="black" points="1190.51,-4796.38 1198.89,-4789.9 1188.29,-4789.74 1190.51,-4796.38"/>
</g>
<!-- ffn_gate_12&#45;&gt;ffn_act_12 -->
<g id="edge242" class="edge">
<title>ffn_gate_12&#45;&gt;ffn_act_12</title>
<path fill="none" stroke="black" d="M1339.87,-4825.74C1334.67,-4817.19 1329.01,-4807.87 1323.57,-4798.93"/>
<polygon fill="black" stroke="black" points="1326.43,-4796.89 1318.24,-4790.16 1320.44,-4800.52 1326.43,-4796.89"/>
</g>
<!-- ffn_down_12 -->
<g id="node173" class="node">
<title>ffn_down_12</title>
<polygon fill="lightblue" stroke="lightblue" points="1479,-4685.86 1117,-4685.86 1117,-4617.86 1479,-4617.86 1479,-4685.86"/>
<text text-anchor="middle" x="1298" y="-4670.66" font-family="Times,serif" font-size="14.00">GPU12_Layer12_FFN_Down</text>
<text text-anchor="middle" x="1298" y="-4655.66" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1298" y="-4640.66" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1298" y="-4625.66" font-family="Times,serif" font-size="14.00">Device: GPU&#45;12</text>
</g>
<!-- ffn_act_12&#45;&gt;ffn_down_12 -->
<g id="edge243" class="edge">
<title>ffn_act_12&#45;&gt;ffn_down_12</title>
<path fill="none" stroke="black" d="M1298,-4721.74C1298,-4713.64 1298,-4704.84 1298,-4696.33"/>
<polygon fill="black" stroke="black" points="1301.5,-4696.16 1298,-4686.16 1294.5,-4696.16 1301.5,-4696.16"/>
</g>
<!-- ffn_down_12&#45;&gt;ffn_residual_12 -->
<g id="edge244" class="edge">
<title>ffn_down_12&#45;&gt;ffn_residual_12</title>
<path fill="none" stroke="black" d="M1298,-4617.72C1298,-4609.96 1298,-4601.32 1298,-4592.34"/>
<polygon fill="black" stroke="black" points="1301.5,-4592.09 1298,-4582.09 1294.5,-4592.09 1301.5,-4592.09"/>
</g>
<!-- layernorm2_12 -->
<g id="node175" class="node">
<title>layernorm2_12</title>
<polygon fill="lightblue" stroke="lightblue" points="1479,-4379.86 1117,-4379.86 1117,-4311.86 1479,-4311.86 1479,-4379.86"/>
<text text-anchor="middle" x="1298" y="-4364.66" font-family="Times,serif" font-size="14.00">GPU12_Layer12_LayerNorm2</text>
<text text-anchor="middle" x="1298" y="-4349.66" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1298" y="-4334.66" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1298" y="-4319.66" font-family="Times,serif" font-size="14.00">Device: GPU&#45;12</text>
</g>
<!-- ffn_residual_12&#45;&gt;layernorm2_12 -->
<g id="edge246" class="edge">
<title>ffn_residual_12&#45;&gt;layernorm2_12</title>
<path fill="none" stroke="black" d="M1298,-4415.73C1298,-4406.98 1298,-4398.34 1298,-4390.31"/>
<polygon fill="black" stroke="black" points="1301.5,-4390.12 1298,-4380.12 1294.5,-4390.12 1301.5,-4390.12"/>
</g>
<!-- comm_12 -->
<g id="node227" class="node">
<title>comm_12</title>
<ellipse fill="lightgreen" stroke="lightgreen" cx="1298" cy="-4238.38" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="1298" y="-4249.68" font-family="Times,serif" font-size="14.00">GPU12_to_GPU13</text>
<text text-anchor="middle" x="1298" y="-4234.68" font-family="Times,serif" font-size="14.00">Transfer: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1298" y="-4219.68" font-family="Times,serif" font-size="14.00">Bandwidth: NVLink 900GB/s</text>
</g>
<!-- layernorm2_12&#45;&gt;comm_12 -->
<g id="edge247" class="edge">
<title>layernorm2_12&#45;&gt;comm_12</title>
<path fill="none" stroke="black" d="M1298,-4311.78C1298,-4303.61 1298,-4294.72 1298,-4286.04"/>
<polygon fill="black" stroke="black" points="1301.5,-4286.02 1298,-4276.02 1294.5,-4286.02 1301.5,-4286.02"/>
</g>
<!-- mha_q_13 -->
<g id="node176" class="node">
<title>mha_q_13</title>
<polygon fill="lightblue" stroke="lightblue" points="1386.5,-4161.91 977.5,-4161.91 977.5,-4093.91 1386.5,-4093.91 1386.5,-4161.91"/>
<text text-anchor="middle" x="1182" y="-4146.71" font-family="Times,serif" font-size="14.00">GPU13_Layer13_MHA_Q</text>
<text text-anchor="middle" x="1182" y="-4131.71" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1182" y="-4116.71" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1182" y="-4101.71" font-family="Times,serif" font-size="14.00">Device: GPU&#45;13</text>
</g>
<!-- attn_score_13 -->
<g id="node179" class="node">
<title>attn_score_13</title>
<polygon fill="lightblue" stroke="lightblue" points="978,-4057.91 550,-4057.91 550,-3974.91 978,-3974.91 978,-4057.91"/>
<text text-anchor="middle" x="764" y="-4042.71" font-family="Times,serif" font-size="14.00">GPU13_Layer13_Attn_Score</text>
<text text-anchor="middle" x="764" y="-4027.71" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="764" y="-4012.71" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="764" y="-3997.71" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="764" y="-3982.71" font-family="Times,serif" font-size="14.00">Device: GPU&#45;13</text>
</g>
<!-- mha_q_13&#45;&gt;attn_score_13 -->
<g id="edge251" class="edge">
<title>mha_q_13&#45;&gt;attn_score_13</title>
<path fill="none" stroke="black" d="M1056.02,-4093.9C1015.99,-4083.42 971.11,-4071.66 928.76,-4060.57"/>
<polygon fill="black" stroke="black" points="929.48,-4057.14 918.92,-4057.99 927.7,-4063.91 929.48,-4057.14"/>
</g>
<!-- mha_k_13 -->
<g id="node177" class="node">
<title>mha_k_13</title>
<polygon fill="lightblue" stroke="lightblue" points="959.5,-4161.91 550.5,-4161.91 550.5,-4093.91 959.5,-4093.91 959.5,-4161.91"/>
<text text-anchor="middle" x="755" y="-4146.71" font-family="Times,serif" font-size="14.00">GPU13_Layer13_MHA_K</text>
<text text-anchor="middle" x="755" y="-4131.71" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="755" y="-4116.71" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="755" y="-4101.71" font-family="Times,serif" font-size="14.00">Device: GPU&#45;13</text>
</g>
<!-- mha_k_13&#45;&gt;attn_score_13 -->
<g id="edge252" class="edge">
<title>mha_k_13&#45;&gt;attn_score_13</title>
<path fill="none" stroke="black" d="M757.72,-4093.76C758.39,-4085.7 759.11,-4076.91 759.82,-4068.24"/>
<polygon fill="black" stroke="black" points="763.32,-4068.44 760.65,-4058.18 756.34,-4067.86 763.32,-4068.44"/>
</g>
<!-- mha_v_13 -->
<g id="node178" class="node">
<title>mha_v_13</title>
<polygon fill="lightblue" stroke="lightblue" points="1405.5,-4050.41 996.5,-4050.41 996.5,-3982.41 1405.5,-3982.41 1405.5,-4050.41"/>
<text text-anchor="middle" x="1201" y="-4035.21" font-family="Times,serif" font-size="14.00">GPU13_Layer13_MHA_V</text>
<text text-anchor="middle" x="1201" y="-4020.21" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1201" y="-4005.21" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1201" y="-3990.21" font-family="Times,serif" font-size="14.00">Device: GPU&#45;13</text>
</g>
<!-- attn_out_13 -->
<g id="node180" class="node">
<title>attn_out_13</title>
<polygon fill="lightblue" stroke="lightblue" points="1243.5,-3938.91 818.5,-3938.91 818.5,-3855.91 1243.5,-3855.91 1243.5,-3938.91"/>
<text text-anchor="middle" x="1031" y="-3923.71" font-family="Times,serif" font-size="14.00">GPU13_Layer13_Attn_Out</text>
<text text-anchor="middle" x="1031" y="-3908.71" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="1031" y="-3893.71" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1031" y="-3878.71" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1031" y="-3863.71" font-family="Times,serif" font-size="14.00">Device: GPU&#45;13</text>
</g>
<!-- mha_v_13&#45;&gt;attn_out_13 -->
<g id="edge254" class="edge">
<title>mha_v_13&#45;&gt;attn_out_13</title>
<path fill="none" stroke="black" d="M1152.74,-3982.19C1135.8,-3970.53 1116.45,-3957.22 1098.24,-3944.68"/>
<polygon fill="black" stroke="black" points="1100.18,-3941.77 1089.96,-3938.99 1096.22,-3947.54 1100.18,-3941.77"/>
</g>
<!-- attn_score_13&#45;&gt;attn_out_13 -->
<g id="edge253" class="edge">
<title>attn_score_13&#45;&gt;attn_out_13</title>
<path fill="none" stroke="black" d="M856.63,-3974.81C880.04,-3964.56 905.29,-3953.49 929.12,-3943.05"/>
<polygon fill="black" stroke="black" points="930.77,-3946.15 938.53,-3938.93 927.97,-3939.74 930.77,-3946.15"/>
</g>
<!-- attn_residual_13 -->
<g id="node181" class="node">
<title>attn_residual_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1406.11,-3819.91 809.39,-3819.91 655.89,-3653.91 1252.61,-3653.91 1406.11,-3819.91"/>
<text text-anchor="middle" x="1031" y="-3763.21" font-family="Times,serif" font-size="14.00">GPU13_Layer13_Attn_Residual</text>
<text text-anchor="middle" x="1031" y="-3748.21" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1031" y="-3733.21" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1031" y="-3718.21" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1031" y="-3703.21" font-family="Times,serif" font-size="14.00">Device: GPU&#45;13</text>
</g>
<!-- attn_out_13&#45;&gt;attn_residual_13 -->
<g id="edge255" class="edge">
<title>attn_out_13&#45;&gt;attn_residual_13</title>
<path fill="none" stroke="black" d="M1031,-3855.59C1031,-3847.66 1031,-3839.05 1031,-3830.22"/>
<polygon fill="black" stroke="black" points="1034.5,-3830.18 1031,-3820.18 1027.5,-3830.18 1034.5,-3830.18"/>
</g>
<!-- layernorm1_13 -->
<g id="node182" class="node">
<title>layernorm1_13</title>
<polygon fill="lightblue" stroke="lightblue" points="1243,-3617.91 881,-3617.91 881,-3549.91 1243,-3549.91 1243,-3617.91"/>
<text text-anchor="middle" x="1062" y="-3602.71" font-family="Times,serif" font-size="14.00">GPU13_Layer13_LayerNorm1</text>
<text text-anchor="middle" x="1062" y="-3587.71" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1062" y="-3572.71" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1062" y="-3557.71" font-family="Times,serif" font-size="14.00">Device: GPU&#45;13</text>
</g>
<!-- attn_residual_13&#45;&gt;layernorm1_13 -->
<g id="edge257" class="edge">
<title>attn_residual_13&#45;&gt;layernorm1_13</title>
<path fill="none" stroke="black" d="M1047.86,-3653.78C1049.68,-3644.93 1051.47,-3636.2 1053.14,-3628.08"/>
<polygon fill="black" stroke="black" points="1056.59,-3628.67 1055.17,-3618.17 1049.73,-3627.26 1056.59,-3628.67"/>
</g>
<!-- ffn_up_13 -->
<g id="node183" class="node">
<title>ffn_up_13</title>
<polygon fill="lightblue" stroke="lightblue" points="900,-3513.91 550,-3513.91 550,-3445.91 900,-3445.91 900,-3513.91"/>
<text text-anchor="middle" x="725" y="-3498.71" font-family="Times,serif" font-size="14.00">GPU13_Layer13_FFN_Up</text>
<text text-anchor="middle" x="725" y="-3483.71" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="725" y="-3468.71" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="725" y="-3453.71" font-family="Times,serif" font-size="14.00">Device: GPU&#45;13</text>
</g>
<!-- layernorm1_13&#45;&gt;ffn_up_13 -->
<g id="edge258" class="edge">
<title>layernorm1_13&#45;&gt;ffn_up_13</title>
<path fill="none" stroke="black" d="M952.59,-3549.79C917.89,-3539.29 879.37,-3527.63 844.03,-3516.93"/>
<polygon fill="black" stroke="black" points="844.74,-3513.49 834.15,-3513.94 842.71,-3520.19 844.74,-3513.49"/>
</g>
<!-- ffn_gate_13 -->
<g id="node184" class="node">
<title>ffn_gate_13</title>
<polygon fill="lightblue" stroke="lightblue" points="1268,-3513.91 918,-3513.91 918,-3445.91 1268,-3445.91 1268,-3513.91"/>
<text text-anchor="middle" x="1093" y="-3498.71" font-family="Times,serif" font-size="14.00">GPU13_Layer13_FFN_Gate</text>
<text text-anchor="middle" x="1093" y="-3483.71" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1093" y="-3468.71" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1093" y="-3453.71" font-family="Times,serif" font-size="14.00">Device: GPU&#45;13</text>
</g>
<!-- layernorm1_13&#45;&gt;ffn_gate_13 -->
<g id="edge259" class="edge">
<title>layernorm1_13&#45;&gt;ffn_gate_13</title>
<path fill="none" stroke="black" d="M1072.06,-3549.79C1074.58,-3541.51 1077.32,-3532.5 1079.96,-3523.82"/>
<polygon fill="black" stroke="black" points="1083.32,-3524.79 1082.88,-3514.21 1076.62,-3522.76 1083.32,-3524.79"/>
</g>
<!-- ffn_residual_13 -->
<g id="node187" class="node">
<title>ffn_residual_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1406.11,-3201.91 809.39,-3201.91 655.89,-3035.91 1252.61,-3035.91 1406.11,-3201.91"/>
<text text-anchor="middle" x="1031" y="-3145.21" font-family="Times,serif" font-size="14.00">GPU13_Layer13_FFN_Residual</text>
<text text-anchor="middle" x="1031" y="-3130.21" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1031" y="-3115.21" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1031" y="-3100.21" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1031" y="-3085.21" font-family="Times,serif" font-size="14.00">Device: GPU&#45;13</text>
</g>
<!-- layernorm1_13&#45;&gt;ffn_residual_13 -->
<g id="edge264" class="edge">
<title>layernorm1_13&#45;&gt;ffn_residual_13</title>
<path fill="none" stroke="black" d="M1236.21,-3549.8C1252.03,-3540.54 1266.14,-3528.79 1277,-3513.91 1294.81,-3489.49 1280.96,-3475.87 1277,-3445.91 1264.45,-3351 1278.1,-3314.75 1221,-3237.91 1213.25,-3227.48 1204.28,-3217.75 1194.54,-3208.74"/>
<polygon fill="black" stroke="black" points="1196.74,-3206.01 1186.95,-3201.98 1192.09,-3211.24 1196.74,-3206.01"/>
</g>
<!-- ffn_act_13 -->
<g id="node185" class="node">
<title>ffn_act_13</title>
<polygon fill="lightblue" stroke="lightblue" points="1201.5,-3409.91 860.5,-3409.91 860.5,-3341.91 1201.5,-3341.91 1201.5,-3409.91"/>
<text text-anchor="middle" x="1031" y="-3394.71" font-family="Times,serif" font-size="14.00">GPU13_Layer13_FFN_Act</text>
<text text-anchor="middle" x="1031" y="-3379.71" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1031" y="-3364.71" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1031" y="-3349.71" font-family="Times,serif" font-size="14.00">Device: GPU&#45;13</text>
</g>
<!-- ffn_up_13&#45;&gt;ffn_act_13 -->
<g id="edge260" class="edge">
<title>ffn_up_13&#45;&gt;ffn_act_13</title>
<path fill="none" stroke="black" d="M824.35,-3445.79C855.58,-3435.38 890.23,-3423.83 922.1,-3413.21"/>
<polygon fill="black" stroke="black" points="923.51,-3416.43 931.89,-3409.94 921.29,-3409.79 923.51,-3416.43"/>
</g>
<!-- ffn_gate_13&#45;&gt;ffn_act_13 -->
<g id="edge261" class="edge">
<title>ffn_gate_13&#45;&gt;ffn_act_13</title>
<path fill="none" stroke="black" d="M1072.87,-3445.79C1067.67,-3437.24 1062.01,-3427.92 1056.57,-3418.98"/>
<polygon fill="black" stroke="black" points="1059.43,-3416.93 1051.24,-3410.21 1053.44,-3420.57 1059.43,-3416.93"/>
</g>
<!-- ffn_down_13 -->
<g id="node186" class="node">
<title>ffn_down_13</title>
<polygon fill="lightblue" stroke="lightblue" points="1212,-3305.91 850,-3305.91 850,-3237.91 1212,-3237.91 1212,-3305.91"/>
<text text-anchor="middle" x="1031" y="-3290.71" font-family="Times,serif" font-size="14.00">GPU13_Layer13_FFN_Down</text>
<text text-anchor="middle" x="1031" y="-3275.71" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="1031" y="-3260.71" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1031" y="-3245.71" font-family="Times,serif" font-size="14.00">Device: GPU&#45;13</text>
</g>
<!-- ffn_act_13&#45;&gt;ffn_down_13 -->
<g id="edge262" class="edge">
<title>ffn_act_13&#45;&gt;ffn_down_13</title>
<path fill="none" stroke="black" d="M1031,-3341.79C1031,-3333.68 1031,-3324.89 1031,-3316.38"/>
<polygon fill="black" stroke="black" points="1034.5,-3316.21 1031,-3306.21 1027.5,-3316.21 1034.5,-3316.21"/>
</g>
<!-- ffn_down_13&#45;&gt;ffn_residual_13 -->
<g id="edge263" class="edge">
<title>ffn_down_13&#45;&gt;ffn_residual_13</title>
<path fill="none" stroke="black" d="M1031,-3237.77C1031,-3230.01 1031,-3221.37 1031,-3212.39"/>
<polygon fill="black" stroke="black" points="1034.5,-3212.14 1031,-3202.14 1027.5,-3212.14 1034.5,-3212.14"/>
</g>
<!-- layernorm2_13 -->
<g id="node188" class="node">
<title>layernorm2_13</title>
<polygon fill="lightblue" stroke="lightblue" points="1212,-2999.91 850,-2999.91 850,-2931.91 1212,-2931.91 1212,-2999.91"/>
<text text-anchor="middle" x="1031" y="-2984.71" font-family="Times,serif" font-size="14.00">GPU13_Layer13_LayerNorm2</text>
<text text-anchor="middle" x="1031" y="-2969.71" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1031" y="-2954.71" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1031" y="-2939.71" font-family="Times,serif" font-size="14.00">Device: GPU&#45;13</text>
</g>
<!-- ffn_residual_13&#45;&gt;layernorm2_13 -->
<g id="edge265" class="edge">
<title>ffn_residual_13&#45;&gt;layernorm2_13</title>
<path fill="none" stroke="black" d="M1031,-3035.78C1031,-3027.02 1031,-3018.39 1031,-3010.35"/>
<polygon fill="black" stroke="black" points="1034.5,-3010.17 1031,-3000.17 1027.5,-3010.17 1034.5,-3010.17"/>
</g>
<!-- comm_13 -->
<g id="node228" class="node">
<title>comm_13</title>
<ellipse fill="lightgreen" stroke="lightgreen" cx="1031" cy="-2858.43" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="1031" y="-2869.73" font-family="Times,serif" font-size="14.00">GPU13_to_GPU14</text>
<text text-anchor="middle" x="1031" y="-2854.73" font-family="Times,serif" font-size="14.00">Transfer: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="1031" y="-2839.73" font-family="Times,serif" font-size="14.00">Bandwidth: NVLink 900GB/s</text>
</g>
<!-- layernorm2_13&#45;&gt;comm_13 -->
<g id="edge266" class="edge">
<title>layernorm2_13&#45;&gt;comm_13</title>
<path fill="none" stroke="black" d="M1031,-2931.82C1031,-2923.66 1031,-2914.76 1031,-2906.09"/>
<polygon fill="black" stroke="black" points="1034.5,-2906.06 1031,-2896.06 1027.5,-2906.06 1034.5,-2906.06"/>
</g>
<!-- mha_q_14 -->
<g id="node189" class="node">
<title>mha_q_14</title>
<polygon fill="lightblue" stroke="lightblue" points="1119.5,-2781.95 710.5,-2781.95 710.5,-2713.95 1119.5,-2713.95 1119.5,-2781.95"/>
<text text-anchor="middle" x="915" y="-2766.75" font-family="Times,serif" font-size="14.00">GPU14_Layer14_MHA_Q</text>
<text text-anchor="middle" x="915" y="-2751.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="915" y="-2736.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="915" y="-2721.75" font-family="Times,serif" font-size="14.00">Device: GPU&#45;14</text>
</g>
<!-- attn_score_14 -->
<g id="node192" class="node">
<title>attn_score_14</title>
<polygon fill="lightblue" stroke="lightblue" points="711,-2677.95 283,-2677.95 283,-2594.95 711,-2594.95 711,-2677.95"/>
<text text-anchor="middle" x="497" y="-2662.75" font-family="Times,serif" font-size="14.00">GPU14_Layer14_Attn_Score</text>
<text text-anchor="middle" x="497" y="-2647.75" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="497" y="-2632.75" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="497" y="-2617.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="497" y="-2602.75" font-family="Times,serif" font-size="14.00">Device: GPU&#45;14</text>
</g>
<!-- mha_q_14&#45;&gt;attn_score_14 -->
<g id="edge270" class="edge">
<title>mha_q_14&#45;&gt;attn_score_14</title>
<path fill="none" stroke="black" d="M789.02,-2713.95C748.99,-2703.46 704.11,-2691.71 661.76,-2680.61"/>
<polygon fill="black" stroke="black" points="662.48,-2677.18 651.92,-2678.04 660.7,-2683.96 662.48,-2677.18"/>
</g>
<!-- mha_k_14 -->
<g id="node190" class="node">
<title>mha_k_14</title>
<polygon fill="lightblue" stroke="lightblue" points="692.5,-2781.95 283.5,-2781.95 283.5,-2713.95 692.5,-2713.95 692.5,-2781.95"/>
<text text-anchor="middle" x="488" y="-2766.75" font-family="Times,serif" font-size="14.00">GPU14_Layer14_MHA_K</text>
<text text-anchor="middle" x="488" y="-2751.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="488" y="-2736.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="488" y="-2721.75" font-family="Times,serif" font-size="14.00">Device: GPU&#45;14</text>
</g>
<!-- mha_k_14&#45;&gt;attn_score_14 -->
<g id="edge271" class="edge">
<title>mha_k_14&#45;&gt;attn_score_14</title>
<path fill="none" stroke="black" d="M490.72,-2713.8C491.39,-2705.75 492.11,-2696.95 492.82,-2688.29"/>
<polygon fill="black" stroke="black" points="496.32,-2688.48 493.65,-2678.23 489.34,-2687.91 496.32,-2688.48"/>
</g>
<!-- mha_v_14 -->
<g id="node191" class="node">
<title>mha_v_14</title>
<polygon fill="lightblue" stroke="lightblue" points="1138.5,-2670.45 729.5,-2670.45 729.5,-2602.45 1138.5,-2602.45 1138.5,-2670.45"/>
<text text-anchor="middle" x="934" y="-2655.25" font-family="Times,serif" font-size="14.00">GPU14_Layer14_MHA_V</text>
<text text-anchor="middle" x="934" y="-2640.25" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="934" y="-2625.25" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="934" y="-2610.25" font-family="Times,serif" font-size="14.00">Device: GPU&#45;14</text>
</g>
<!-- attn_out_14 -->
<g id="node193" class="node">
<title>attn_out_14</title>
<polygon fill="lightblue" stroke="lightblue" points="976.5,-2558.95 551.5,-2558.95 551.5,-2475.95 976.5,-2475.95 976.5,-2558.95"/>
<text text-anchor="middle" x="764" y="-2543.75" font-family="Times,serif" font-size="14.00">GPU14_Layer14_Attn_Out</text>
<text text-anchor="middle" x="764" y="-2528.75" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="764" y="-2513.75" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="764" y="-2498.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="764" y="-2483.75" font-family="Times,serif" font-size="14.00">Device: GPU&#45;14</text>
</g>
<!-- mha_v_14&#45;&gt;attn_out_14 -->
<g id="edge273" class="edge">
<title>mha_v_14&#45;&gt;attn_out_14</title>
<path fill="none" stroke="black" d="M885.74,-2602.24C868.8,-2590.58 849.45,-2577.26 831.24,-2564.73"/>
<polygon fill="black" stroke="black" points="833.18,-2561.82 822.96,-2559.03 829.22,-2567.59 833.18,-2561.82"/>
</g>
<!-- attn_score_14&#45;&gt;attn_out_14 -->
<g id="edge272" class="edge">
<title>attn_score_14&#45;&gt;attn_out_14</title>
<path fill="none" stroke="black" d="M589.63,-2594.86C613.04,-2584.61 638.29,-2573.54 662.12,-2563.1"/>
<polygon fill="black" stroke="black" points="663.77,-2566.19 671.53,-2558.97 660.97,-2559.78 663.77,-2566.19"/>
</g>
<!-- attn_residual_14 -->
<g id="node194" class="node">
<title>attn_residual_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1139.11,-2439.95 542.39,-2439.95 388.89,-2273.95 985.61,-2273.95 1139.11,-2439.95"/>
<text text-anchor="middle" x="764" y="-2383.25" font-family="Times,serif" font-size="14.00">GPU14_Layer14_Attn_Residual</text>
<text text-anchor="middle" x="764" y="-2368.25" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="764" y="-2353.25" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="764" y="-2338.25" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="764" y="-2323.25" font-family="Times,serif" font-size="14.00">Device: GPU&#45;14</text>
</g>
<!-- attn_out_14&#45;&gt;attn_residual_14 -->
<g id="edge274" class="edge">
<title>attn_out_14&#45;&gt;attn_residual_14</title>
<path fill="none" stroke="black" d="M764,-2475.64C764,-2467.71 764,-2459.1 764,-2450.27"/>
<polygon fill="black" stroke="black" points="767.5,-2450.23 764,-2440.23 760.5,-2450.23 767.5,-2450.23"/>
</g>
<!-- layernorm1_14 -->
<g id="node195" class="node">
<title>layernorm1_14</title>
<polygon fill="lightblue" stroke="lightblue" points="976,-2237.95 614,-2237.95 614,-2169.95 976,-2169.95 976,-2237.95"/>
<text text-anchor="middle" x="795" y="-2222.75" font-family="Times,serif" font-size="14.00">GPU14_Layer14_LayerNorm1</text>
<text text-anchor="middle" x="795" y="-2207.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="795" y="-2192.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="795" y="-2177.75" font-family="Times,serif" font-size="14.00">Device: GPU&#45;14</text>
</g>
<!-- attn_residual_14&#45;&gt;layernorm1_14 -->
<g id="edge276" class="edge">
<title>attn_residual_14&#45;&gt;layernorm1_14</title>
<path fill="none" stroke="black" d="M780.86,-2273.83C782.68,-2264.97 784.47,-2256.24 786.14,-2248.13"/>
<polygon fill="black" stroke="black" points="789.59,-2248.71 788.17,-2238.22 782.73,-2247.31 789.59,-2248.71"/>
</g>
<!-- ffn_up_14 -->
<g id="node196" class="node">
<title>ffn_up_14</title>
<polygon fill="lightblue" stroke="lightblue" points="633,-2133.95 283,-2133.95 283,-2065.95 633,-2065.95 633,-2133.95"/>
<text text-anchor="middle" x="458" y="-2118.75" font-family="Times,serif" font-size="14.00">GPU14_Layer14_FFN_Up</text>
<text text-anchor="middle" x="458" y="-2103.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="458" y="-2088.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="458" y="-2073.75" font-family="Times,serif" font-size="14.00">Device: GPU&#45;14</text>
</g>
<!-- layernorm1_14&#45;&gt;ffn_up_14 -->
<g id="edge277" class="edge">
<title>layernorm1_14&#45;&gt;ffn_up_14</title>
<path fill="none" stroke="black" d="M685.59,-2169.84C650.89,-2159.34 612.37,-2147.68 577.03,-2136.98"/>
<polygon fill="black" stroke="black" points="577.74,-2133.54 567.15,-2133.99 575.71,-2140.24 577.74,-2133.54"/>
</g>
<!-- ffn_gate_14 -->
<g id="node197" class="node">
<title>ffn_gate_14</title>
<polygon fill="lightblue" stroke="lightblue" points="1001,-2133.95 651,-2133.95 651,-2065.95 1001,-2065.95 1001,-2133.95"/>
<text text-anchor="middle" x="826" y="-2118.75" font-family="Times,serif" font-size="14.00">GPU14_Layer14_FFN_Gate</text>
<text text-anchor="middle" x="826" y="-2103.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="826" y="-2088.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="826" y="-2073.75" font-family="Times,serif" font-size="14.00">Device: GPU&#45;14</text>
</g>
<!-- layernorm1_14&#45;&gt;ffn_gate_14 -->
<g id="edge278" class="edge">
<title>layernorm1_14&#45;&gt;ffn_gate_14</title>
<path fill="none" stroke="black" d="M805.06,-2169.84C807.58,-2161.55 810.32,-2152.55 812.96,-2143.86"/>
<polygon fill="black" stroke="black" points="816.32,-2144.84 815.88,-2134.25 809.62,-2142.8 816.32,-2144.84"/>
</g>
<!-- ffn_residual_14 -->
<g id="node200" class="node">
<title>ffn_residual_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1139.11,-1821.95 542.39,-1821.95 388.89,-1655.95 985.61,-1655.95 1139.11,-1821.95"/>
<text text-anchor="middle" x="764" y="-1765.25" font-family="Times,serif" font-size="14.00">GPU14_Layer14_FFN_Residual</text>
<text text-anchor="middle" x="764" y="-1750.25" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="764" y="-1735.25" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="764" y="-1720.25" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="764" y="-1705.25" font-family="Times,serif" font-size="14.00">Device: GPU&#45;14</text>
</g>
<!-- layernorm1_14&#45;&gt;ffn_residual_14 -->
<g id="edge283" class="edge">
<title>layernorm1_14&#45;&gt;ffn_residual_14</title>
<path fill="none" stroke="black" d="M969.21,-2169.84C985.03,-2160.59 999.14,-2148.84 1010,-2133.95 1027.81,-2109.54 1013.96,-2095.91 1010,-2065.95 997.45,-1971.04 1011.1,-1934.8 954,-1857.95 946.25,-1847.52 937.28,-1837.8 927.54,-1828.78"/>
<polygon fill="black" stroke="black" points="929.74,-1826.06 919.95,-1822.02 925.09,-1831.29 929.74,-1826.06"/>
</g>
<!-- ffn_act_14 -->
<g id="node198" class="node">
<title>ffn_act_14</title>
<polygon fill="lightblue" stroke="lightblue" points="934.5,-2029.95 593.5,-2029.95 593.5,-1961.95 934.5,-1961.95 934.5,-2029.95"/>
<text text-anchor="middle" x="764" y="-2014.75" font-family="Times,serif" font-size="14.00">GPU14_Layer14_FFN_Act</text>
<text text-anchor="middle" x="764" y="-1999.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="764" y="-1984.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="764" y="-1969.75" font-family="Times,serif" font-size="14.00">Device: GPU&#45;14</text>
</g>
<!-- ffn_up_14&#45;&gt;ffn_act_14 -->
<g id="edge279" class="edge">
<title>ffn_up_14&#45;&gt;ffn_act_14</title>
<path fill="none" stroke="black" d="M557.35,-2065.84C588.58,-2055.43 623.23,-2043.88 655.1,-2033.25"/>
<polygon fill="black" stroke="black" points="656.51,-2036.47 664.89,-2029.99 654.29,-2029.83 656.51,-2036.47"/>
</g>
<!-- ffn_gate_14&#45;&gt;ffn_act_14 -->
<g id="edge280" class="edge">
<title>ffn_gate_14&#45;&gt;ffn_act_14</title>
<path fill="none" stroke="black" d="M805.87,-2065.84C800.67,-2057.29 795.01,-2047.97 789.57,-2039.03"/>
<polygon fill="black" stroke="black" points="792.43,-2036.98 784.24,-2030.25 786.44,-2040.62 792.43,-2036.98"/>
</g>
<!-- ffn_down_14 -->
<g id="node199" class="node">
<title>ffn_down_14</title>
<polygon fill="lightblue" stroke="lightblue" points="945,-1925.95 583,-1925.95 583,-1857.95 945,-1857.95 945,-1925.95"/>
<text text-anchor="middle" x="764" y="-1910.75" font-family="Times,serif" font-size="14.00">GPU14_Layer14_FFN_Down</text>
<text text-anchor="middle" x="764" y="-1895.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="764" y="-1880.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="764" y="-1865.75" font-family="Times,serif" font-size="14.00">Device: GPU&#45;14</text>
</g>
<!-- ffn_act_14&#45;&gt;ffn_down_14 -->
<g id="edge281" class="edge">
<title>ffn_act_14&#45;&gt;ffn_down_14</title>
<path fill="none" stroke="black" d="M764,-1961.84C764,-1953.73 764,-1944.94 764,-1936.43"/>
<polygon fill="black" stroke="black" points="767.5,-1936.25 764,-1926.25 760.5,-1936.25 767.5,-1936.25"/>
</g>
<!-- ffn_down_14&#45;&gt;ffn_residual_14 -->
<g id="edge282" class="edge">
<title>ffn_down_14&#45;&gt;ffn_residual_14</title>
<path fill="none" stroke="black" d="M764,-1857.82C764,-1850.06 764,-1841.42 764,-1832.44"/>
<polygon fill="black" stroke="black" points="767.5,-1832.19 764,-1822.19 760.5,-1832.19 767.5,-1832.19"/>
</g>
<!-- layernorm2_14 -->
<g id="node201" class="node">
<title>layernorm2_14</title>
<polygon fill="lightblue" stroke="lightblue" points="945,-1619.95 583,-1619.95 583,-1551.95 945,-1551.95 945,-1619.95"/>
<text text-anchor="middle" x="764" y="-1604.75" font-family="Times,serif" font-size="14.00">GPU14_Layer14_LayerNorm2</text>
<text text-anchor="middle" x="764" y="-1589.75" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="764" y="-1574.75" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="764" y="-1559.75" font-family="Times,serif" font-size="14.00">Device: GPU&#45;14</text>
</g>
<!-- ffn_residual_14&#45;&gt;layernorm2_14 -->
<g id="edge284" class="edge">
<title>ffn_residual_14&#45;&gt;layernorm2_14</title>
<path fill="none" stroke="black" d="M764,-1655.83C764,-1647.07 764,-1638.44 764,-1630.4"/>
<polygon fill="black" stroke="black" points="767.5,-1630.21 764,-1620.22 760.5,-1630.22 767.5,-1630.21"/>
</g>
<!-- comm_14 -->
<g id="node229" class="node">
<title>comm_14</title>
<ellipse fill="lightgreen" stroke="lightgreen" cx="764" cy="-1478.48" rx="263.09" ry="37.45"/>
<text text-anchor="middle" x="764" y="-1489.78" font-family="Times,serif" font-size="14.00">GPU14_to_GPU15</text>
<text text-anchor="middle" x="764" y="-1474.78" font-family="Times,serif" font-size="14.00">Transfer: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="764" y="-1459.78" font-family="Times,serif" font-size="14.00">Bandwidth: NVLink 900GB/s</text>
</g>
<!-- layernorm2_14&#45;&gt;comm_14 -->
<g id="edge285" class="edge">
<title>layernorm2_14&#45;&gt;comm_14</title>
<path fill="none" stroke="black" d="M764,-1551.87C764,-1543.71 764,-1534.81 764,-1526.13"/>
<polygon fill="black" stroke="black" points="767.5,-1526.11 764,-1516.11 760.5,-1526.11 767.5,-1526.11"/>
</g>
<!-- mha_q_15 -->
<g id="node202" class="node">
<title>mha_q_15</title>
<polygon fill="lightblue" stroke="lightblue" points="852.5,-1402 443.5,-1402 443.5,-1334 852.5,-1334 852.5,-1402"/>
<text text-anchor="middle" x="648" y="-1386.8" font-family="Times,serif" font-size="14.00">GPU15_Layer15_MHA_Q</text>
<text text-anchor="middle" x="648" y="-1371.8" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="648" y="-1356.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="648" y="-1341.8" font-family="Times,serif" font-size="14.00">Device: GPU&#45;15</text>
</g>
<!-- attn_score_15 -->
<g id="node205" class="node">
<title>attn_score_15</title>
<polygon fill="lightblue" stroke="lightblue" points="444,-1298 16,-1298 16,-1215 444,-1215 444,-1298"/>
<text text-anchor="middle" x="230" y="-1282.8" font-family="Times,serif" font-size="14.00">GPU15_Layer15_Attn_Score</text>
<text text-anchor="middle" x="230" y="-1267.8" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="230" y="-1252.8" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="230" y="-1237.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="230" y="-1222.8" font-family="Times,serif" font-size="14.00">Device: GPU&#45;15</text>
</g>
<!-- mha_q_15&#45;&gt;attn_score_15 -->
<g id="edge289" class="edge">
<title>mha_q_15&#45;&gt;attn_score_15</title>
<path fill="none" stroke="black" d="M522.02,-1334C481.99,-1323.51 437.11,-1311.75 394.76,-1300.66"/>
<polygon fill="black" stroke="black" points="395.48,-1297.23 384.92,-1298.08 393.7,-1304 395.48,-1297.23"/>
</g>
<!-- mha_k_15 -->
<g id="node203" class="node">
<title>mha_k_15</title>
<polygon fill="lightblue" stroke="lightblue" points="425.5,-1402 16.5,-1402 16.5,-1334 425.5,-1334 425.5,-1402"/>
<text text-anchor="middle" x="221" y="-1386.8" font-family="Times,serif" font-size="14.00">GPU15_Layer15_MHA_K</text>
<text text-anchor="middle" x="221" y="-1371.8" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="221" y="-1356.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="221" y="-1341.8" font-family="Times,serif" font-size="14.00">Device: GPU&#45;15</text>
</g>
<!-- mha_k_15&#45;&gt;attn_score_15 -->
<g id="edge290" class="edge">
<title>mha_k_15&#45;&gt;attn_score_15</title>
<path fill="none" stroke="black" d="M223.72,-1333.85C224.39,-1325.8 225.11,-1317 225.82,-1308.34"/>
<polygon fill="black" stroke="black" points="229.32,-1308.53 226.65,-1298.28 222.34,-1307.96 229.32,-1308.53"/>
</g>
<!-- mha_v_15 -->
<g id="node204" class="node">
<title>mha_v_15</title>
<polygon fill="lightblue" stroke="lightblue" points="871.5,-1290.5 462.5,-1290.5 462.5,-1222.5 871.5,-1222.5 871.5,-1290.5"/>
<text text-anchor="middle" x="667" y="-1275.3" font-family="Times,serif" font-size="14.00">GPU15_Layer15_MHA_V</text>
<text text-anchor="middle" x="667" y="-1260.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="667" y="-1245.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="667" y="-1230.3" font-family="Times,serif" font-size="14.00">Device: GPU&#45;15</text>
</g>
<!-- attn_out_15 -->
<g id="node206" class="node">
<title>attn_out_15</title>
<polygon fill="lightblue" stroke="lightblue" points="709.5,-1179 284.5,-1179 284.5,-1096 709.5,-1096 709.5,-1179"/>
<text text-anchor="middle" x="497" y="-1163.8" font-family="Times,serif" font-size="14.00">GPU15_Layer15_Attn_Out</text>
<text text-anchor="middle" x="497" y="-1148.8" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, heads=32, seq=10000]</text>
<text text-anchor="middle" x="497" y="-1133.8" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="497" y="-1118.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="497" y="-1103.8" font-family="Times,serif" font-size="14.00">Device: GPU&#45;15</text>
</g>
<!-- mha_v_15&#45;&gt;attn_out_15 -->
<g id="edge292" class="edge">
<title>mha_v_15&#45;&gt;attn_out_15</title>
<path fill="none" stroke="black" d="M618.74,-1222.29C601.8,-1210.63 582.45,-1197.31 564.24,-1184.77"/>
<polygon fill="black" stroke="black" points="566.18,-1181.87 555.96,-1179.08 562.22,-1187.63 566.18,-1181.87"/>
</g>
<!-- attn_score_15&#45;&gt;attn_out_15 -->
<g id="edge291" class="edge">
<title>attn_score_15&#45;&gt;attn_out_15</title>
<path fill="none" stroke="black" d="M322.63,-1214.91C346.04,-1204.65 371.29,-1193.59 395.12,-1183.14"/>
<polygon fill="black" stroke="black" points="396.77,-1186.24 404.53,-1179.02 393.97,-1179.83 396.77,-1186.24"/>
</g>
<!-- attn_residual_15 -->
<g id="node207" class="node">
<title>attn_residual_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="872.11,-1060 275.39,-1060 121.89,-894 718.61,-894 872.11,-1060"/>
<text text-anchor="middle" x="497" y="-1003.3" font-family="Times,serif" font-size="14.00">GPU15_Layer15_Attn_Residual</text>
<text text-anchor="middle" x="497" y="-988.3" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="497" y="-973.3" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="497" y="-958.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="497" y="-943.3" font-family="Times,serif" font-size="14.00">Device: GPU&#45;15</text>
</g>
<!-- attn_out_15&#45;&gt;attn_residual_15 -->
<g id="edge293" class="edge">
<title>attn_out_15&#45;&gt;attn_residual_15</title>
<path fill="none" stroke="black" d="M497,-1095.68C497,-1087.75 497,-1079.14 497,-1070.31"/>
<polygon fill="black" stroke="black" points="500.5,-1070.27 497,-1060.27 493.5,-1070.27 500.5,-1070.27"/>
</g>
<!-- layernorm1_15 -->
<g id="node208" class="node">
<title>layernorm1_15</title>
<polygon fill="lightblue" stroke="lightblue" points="709,-858 347,-858 347,-790 709,-790 709,-858"/>
<text text-anchor="middle" x="528" y="-842.8" font-family="Times,serif" font-size="14.00">GPU15_Layer15_LayerNorm1</text>
<text text-anchor="middle" x="528" y="-827.8" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="528" y="-812.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="528" y="-797.8" font-family="Times,serif" font-size="14.00">Device: GPU&#45;15</text>
</g>
<!-- attn_residual_15&#45;&gt;layernorm1_15 -->
<g id="edge295" class="edge">
<title>attn_residual_15&#45;&gt;layernorm1_15</title>
<path fill="none" stroke="black" d="M513.86,-893.87C515.68,-885.02 517.47,-876.29 519.14,-868.18"/>
<polygon fill="black" stroke="black" points="522.59,-868.76 521.17,-858.26 515.73,-867.35 522.59,-868.76"/>
</g>
<!-- ffn_up_15 -->
<g id="node209" class="node">
<title>ffn_up_15</title>
<polygon fill="lightblue" stroke="lightblue" points="366,-754 16,-754 16,-686 366,-686 366,-754"/>
<text text-anchor="middle" x="191" y="-738.8" font-family="Times,serif" font-size="14.00">GPU15_Layer15_FFN_Up</text>
<text text-anchor="middle" x="191" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="191" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="191" y="-693.8" font-family="Times,serif" font-size="14.00">Device: GPU&#45;15</text>
</g>
<!-- layernorm1_15&#45;&gt;ffn_up_15 -->
<g id="edge296" class="edge">
<title>layernorm1_15&#45;&gt;ffn_up_15</title>
<path fill="none" stroke="black" d="M418.59,-789.88C383.89,-779.38 345.37,-767.72 310.03,-757.03"/>
<polygon fill="black" stroke="black" points="310.74,-753.58 300.15,-754.04 308.71,-760.28 310.74,-753.58"/>
</g>
<!-- ffn_gate_15 -->
<g id="node210" class="node">
<title>ffn_gate_15</title>
<polygon fill="lightblue" stroke="lightblue" points="734,-754 384,-754 384,-686 734,-686 734,-754"/>
<text text-anchor="middle" x="559" y="-738.8" font-family="Times,serif" font-size="14.00">GPU15_Layer15_FFN_Gate</text>
<text text-anchor="middle" x="559" y="-723.8" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="559" y="-708.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="559" y="-693.8" font-family="Times,serif" font-size="14.00">Device: GPU&#45;15</text>
</g>
<!-- layernorm1_15&#45;&gt;ffn_gate_15 -->
<g id="edge297" class="edge">
<title>layernorm1_15&#45;&gt;ffn_gate_15</title>
<path fill="none" stroke="black" d="M538.06,-789.88C540.58,-781.6 543.32,-772.6 545.96,-763.91"/>
<polygon fill="black" stroke="black" points="549.32,-764.89 548.88,-754.3 542.62,-762.85 549.32,-764.89"/>
</g>
<!-- ffn_residual_15 -->
<g id="node213" class="node">
<title>ffn_residual_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="872.11,-442 275.39,-442 121.89,-276 718.61,-276 872.11,-442"/>
<text text-anchor="middle" x="497" y="-385.3" font-family="Times,serif" font-size="14.00">GPU15_Layer15_FFN_Residual</text>
<text text-anchor="middle" x="497" y="-370.3" font-family="Times,serif" font-size="14.00">Input1: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="497" y="-355.3" font-family="Times,serif" font-size="14.00">Input2: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="497" y="-340.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="497" y="-325.3" font-family="Times,serif" font-size="14.00">Device: GPU&#45;15</text>
</g>
<!-- layernorm1_15&#45;&gt;ffn_residual_15 -->
<g id="edge302" class="edge">
<title>layernorm1_15&#45;&gt;ffn_residual_15</title>
<path fill="none" stroke="black" d="M702.21,-789.89C718.03,-780.63 732.14,-768.89 743,-754 760.81,-729.58 746.96,-715.96 743,-686 730.45,-591.09 744.1,-554.85 687,-478 679.25,-467.57 670.28,-457.85 660.54,-448.83"/>
<polygon fill="black" stroke="black" points="662.74,-446.11 652.95,-442.07 658.09,-451.33 662.74,-446.11"/>
</g>
<!-- ffn_act_15 -->
<g id="node211" class="node">
<title>ffn_act_15</title>
<polygon fill="lightblue" stroke="lightblue" points="667.5,-650 326.5,-650 326.5,-582 667.5,-582 667.5,-650"/>
<text text-anchor="middle" x="497" y="-634.8" font-family="Times,serif" font-size="14.00">GPU15_Layer15_FFN_Act</text>
<text text-anchor="middle" x="497" y="-619.8" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="497" y="-604.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="497" y="-589.8" font-family="Times,serif" font-size="14.00">Device: GPU&#45;15</text>
</g>
<!-- ffn_up_15&#45;&gt;ffn_act_15 -->
<g id="edge298" class="edge">
<title>ffn_up_15&#45;&gt;ffn_act_15</title>
<path fill="none" stroke="black" d="M290.35,-685.88C321.58,-675.47 356.23,-663.92 388.1,-653.3"/>
<polygon fill="black" stroke="black" points="389.51,-656.52 397.89,-650.04 387.29,-649.88 389.51,-656.52"/>
</g>
<!-- ffn_gate_15&#45;&gt;ffn_act_15 -->
<g id="edge299" class="edge">
<title>ffn_gate_15&#45;&gt;ffn_act_15</title>
<path fill="none" stroke="black" d="M538.87,-685.88C533.67,-677.33 528.01,-668.01 522.57,-659.07"/>
<polygon fill="black" stroke="black" points="525.43,-657.03 517.24,-650.3 519.44,-660.66 525.43,-657.03"/>
</g>
<!-- ffn_down_15 -->
<g id="node212" class="node">
<title>ffn_down_15</title>
<polygon fill="lightblue" stroke="lightblue" points="678,-546 316,-546 316,-478 678,-478 678,-546"/>
<text text-anchor="middle" x="497" y="-530.8" font-family="Times,serif" font-size="14.00">GPU15_Layer15_FFN_Down</text>
<text text-anchor="middle" x="497" y="-515.8" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, ffn=16384]</text>
<text text-anchor="middle" x="497" y="-500.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="497" y="-485.8" font-family="Times,serif" font-size="14.00">Device: GPU&#45;15</text>
</g>
<!-- ffn_act_15&#45;&gt;ffn_down_15 -->
<g id="edge300" class="edge">
<title>ffn_act_15&#45;&gt;ffn_down_15</title>
<path fill="none" stroke="black" d="M497,-581.88C497,-573.78 497,-564.98 497,-556.47"/>
<polygon fill="black" stroke="black" points="500.5,-556.3 497,-546.3 493.5,-556.3 500.5,-556.3"/>
</g>
<!-- ffn_down_15&#45;&gt;ffn_residual_15 -->
<g id="edge301" class="edge">
<title>ffn_down_15&#45;&gt;ffn_residual_15</title>
<path fill="none" stroke="black" d="M497,-477.86C497,-470.1 497,-461.46 497,-452.48"/>
<polygon fill="black" stroke="black" points="500.5,-452.23 497,-442.23 493.5,-452.23 500.5,-452.23"/>
</g>
<!-- layernorm2_15 -->
<g id="node214" class="node">
<title>layernorm2_15</title>
<polygon fill="lightblue" stroke="lightblue" points="678,-240 316,-240 316,-172 678,-172 678,-240"/>
<text text-anchor="middle" x="497" y="-224.8" font-family="Times,serif" font-size="14.00">GPU15_Layer15_LayerNorm2</text>
<text text-anchor="middle" x="497" y="-209.8" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="497" y="-194.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="497" y="-179.8" font-family="Times,serif" font-size="14.00">Device: GPU&#45;15</text>
</g>
<!-- ffn_residual_15&#45;&gt;layernorm2_15 -->
<g id="edge303" class="edge">
<title>ffn_residual_15&#45;&gt;layernorm2_15</title>
<path fill="none" stroke="black" d="M497,-275.87C497,-267.12 497,-258.48 497,-250.45"/>
<polygon fill="black" stroke="black" points="500.5,-250.26 497,-240.26 493.5,-250.26 500.5,-250.26"/>
</g>
<!-- output -->
<g id="node230" class="node">
<title>output</title>
<polygon fill="purple" stroke="purple" points="918.92,-136 247.74,-136 75.08,0 746.26,0 918.92,-136"/>
<text text-anchor="middle" x="497" y="-86.8" font-family="Times,serif" font-size="14.00">Final Output Projection</text>
<text text-anchor="middle" x="497" y="-71.8" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="497" y="-56.8" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=10000, vocab_size=128256]</text>
<text text-anchor="middle" x="497" y="-41.8" font-family="Times,serif" font-size="14.00">Device: GPU&#45;15</text>
</g>
<!-- layernorm2_15&#45;&gt;output -->
<g id="edge304" class="edge">
<title>layernorm2_15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M497,-171.73C497,-163.9 497,-155.24 497,-146.35"/>
<polygon fill="black" stroke="black" points="500.5,-146.26 497,-136.26 493.5,-146.26 500.5,-146.26"/>
</g>
<!-- comm_0&#45;&gt;mha_q_1 -->
<g id="edge20" class="edge">
<title>comm_0&#45;&gt;mha_q_1</title>
<path fill="none" stroke="black" d="M4463.37,-20760.7C4452.24,-20750.29 4440.02,-20738.87 4428.66,-20728.24"/>
<polygon fill="black" stroke="black" points="4431.02,-20725.66 4421.33,-20721.38 4426.24,-20730.77 4431.02,-20725.66"/>
</g>
<!-- comm_0&#45;&gt;mha_k_1 -->
<g id="edge21" class="edge">
<title>comm_0&#45;&gt;mha_k_1</title>
<path fill="none" stroke="black" d="M4296.92,-20774.3C4255.37,-20768.3 4212.12,-20761.02 4172,-20752.35 4137.48,-20744.88 4100.43,-20734.58 4067.08,-20724.42"/>
<polygon fill="black" stroke="black" points="4067.9,-20721.02 4057.31,-20721.42 4065.84,-20727.71 4067.9,-20721.02"/>
</g>
<!-- comm_0&#45;&gt;mha_v_1 -->
<g id="edge22" class="edge">
<title>comm_0&#45;&gt;mha_v_1</title>
<path fill="none" stroke="black" d="M4591.07,-20762.27C4594.03,-20759.23 4596.7,-20755.93 4599,-20752.35 4622.76,-20715.31 4623.76,-20689.72 4599,-20653.35 4588.24,-20637.54 4573.67,-20625.01 4557.32,-20615.06"/>
<polygon fill="black" stroke="black" points="4559.04,-20612.01 4548.62,-20610.09 4555.56,-20618.09 4559.04,-20612.01"/>
</g>
<!-- comm_0&#45;&gt;attn_residual_1 -->
<g id="edge28" class="edge">
<title>comm_0&#45;&gt;attn_residual_1</title>
<path fill="none" stroke="black" d="M4613.41,-20763.4C4616.96,-20760.06 4620.18,-20756.38 4623,-20752.35 4632,-20739.45 4620.32,-20538.69 4618,-20534.35 4583.58,-20469.76 4523.13,-20420.72 4460.29,-20384.49"/>
<polygon fill="black" stroke="black" points="4461.83,-20381.34 4451.41,-20379.46 4458.39,-20387.43 4461.83,-20381.34"/>
</g>
<!-- comm_1&#45;&gt;mha_q_2 -->
<g id="edge39" class="edge">
<title>comm_1&#45;&gt;mha_q_2</title>
<path fill="none" stroke="black" d="M4196.37,-19380.75C4185.24,-19370.33 4173.02,-19358.91 4161.66,-19348.28"/>
<polygon fill="black" stroke="black" points="4164.02,-19345.7 4154.33,-19341.43 4159.24,-19350.82 4164.02,-19345.7"/>
</g>
<!-- comm_1&#45;&gt;mha_k_2 -->
<g id="edge40" class="edge">
<title>comm_1&#45;&gt;mha_k_2</title>
<path fill="none" stroke="black" d="M4029.92,-19394.35C3988.37,-19388.35 3945.12,-19381.07 3905,-19372.39 3870.48,-19364.93 3833.43,-19354.63 3800.08,-19344.47"/>
<polygon fill="black" stroke="black" points="3800.9,-19341.06 3790.31,-19341.47 3798.84,-19347.75 3800.9,-19341.06"/>
</g>
<!-- comm_1&#45;&gt;mha_v_2 -->
<g id="edge41" class="edge">
<title>comm_1&#45;&gt;mha_v_2</title>
<path fill="none" stroke="black" d="M4324.07,-19382.32C4327.03,-19379.28 4329.7,-19375.98 4332,-19372.39 4355.76,-19335.36 4356.76,-19309.77 4332,-19273.39 4321.24,-19257.59 4306.67,-19245.05 4290.32,-19235.1"/>
<polygon fill="black" stroke="black" points="4292.04,-19232.05 4281.62,-19230.14 4288.56,-19238.13 4292.04,-19232.05"/>
</g>
<!-- comm_1&#45;&gt;attn_residual_2 -->
<g id="edge47" class="edge">
<title>comm_1&#45;&gt;attn_residual_2</title>
<path fill="none" stroke="black" d="M4346.41,-19383.44C4349.96,-19380.1 4353.18,-19376.43 4356,-19372.39 4365,-19359.49 4353.32,-19158.74 4351,-19154.39 4316.58,-19089.8 4256.13,-19040.76 4193.29,-19004.54"/>
<polygon fill="black" stroke="black" points="4194.83,-19001.39 4184.41,-18999.51 4191.39,-19007.48 4194.83,-19001.39"/>
</g>
<!-- comm_2&#45;&gt;mha_q_3 -->
<g id="edge58" class="edge">
<title>comm_2&#45;&gt;mha_q_3</title>
<path fill="none" stroke="black" d="M3929.37,-18000.8C3918.24,-17990.38 3906.02,-17978.96 3894.66,-17968.33"/>
<polygon fill="black" stroke="black" points="3897.02,-17965.75 3887.33,-17961.48 3892.24,-17970.86 3897.02,-17965.75"/>
</g>
<!-- comm_2&#45;&gt;mha_k_3 -->
<g id="edge59" class="edge">
<title>comm_2&#45;&gt;mha_k_3</title>
<path fill="none" stroke="black" d="M3762.92,-18014.39C3721.37,-18008.4 3678.12,-18001.11 3638,-17992.44 3603.48,-17984.98 3566.43,-17974.68 3533.08,-17964.52"/>
<polygon fill="black" stroke="black" points="3533.9,-17961.11 3523.31,-17961.52 3531.84,-17967.8 3533.9,-17961.11"/>
</g>
<!-- comm_2&#45;&gt;mha_v_3 -->
<g id="edge60" class="edge">
<title>comm_2&#45;&gt;mha_v_3</title>
<path fill="none" stroke="black" d="M4057.07,-18002.36C4060.03,-17999.33 4062.7,-17996.03 4065,-17992.44 4088.76,-17955.41 4089.76,-17929.81 4065,-17893.44 4054.24,-17877.64 4039.67,-17865.1 4023.32,-17855.15"/>
<polygon fill="black" stroke="black" points="4025.04,-17852.1 4014.62,-17850.18 4021.56,-17858.18 4025.04,-17852.1"/>
</g>
<!-- comm_2&#45;&gt;attn_residual_3 -->
<g id="edge66" class="edge">
<title>comm_2&#45;&gt;attn_residual_3</title>
<path fill="none" stroke="black" d="M4079.41,-18003.49C4082.96,-18000.15 4086.18,-17996.48 4089,-17992.44 4098,-17979.54 4086.32,-17778.79 4084,-17774.44 4049.58,-17709.85 3989.13,-17660.81 3926.29,-17624.58"/>
<polygon fill="black" stroke="black" points="3927.83,-17621.44 3917.41,-17619.56 3924.39,-17627.53 3927.83,-17621.44"/>
</g>
<!-- comm_3&#45;&gt;mha_q_4 -->
<g id="edge77" class="edge">
<title>comm_3&#45;&gt;mha_q_4</title>
<path fill="none" stroke="black" d="M3662.37,-16620.84C3651.24,-16610.43 3639.02,-16599.01 3627.66,-16588.38"/>
<polygon fill="black" stroke="black" points="3630.02,-16585.8 3620.33,-16581.52 3625.24,-16590.91 3630.02,-16585.8"/>
</g>
<!-- comm_3&#45;&gt;mha_k_4 -->
<g id="edge78" class="edge">
<title>comm_3&#45;&gt;mha_k_4</title>
<path fill="none" stroke="black" d="M3495.92,-16634.44C3454.37,-16628.44 3411.12,-16621.16 3371,-16612.49 3336.48,-16605.02 3299.43,-16594.72 3266.08,-16584.56"/>
<polygon fill="black" stroke="black" points="3266.9,-16581.16 3256.31,-16581.56 3264.84,-16587.85 3266.9,-16581.16"/>
</g>
<!-- comm_3&#45;&gt;mha_v_4 -->
<g id="edge79" class="edge">
<title>comm_3&#45;&gt;mha_v_4</title>
<path fill="none" stroke="black" d="M3790.07,-16622.41C3793.03,-16619.37 3795.7,-16616.07 3798,-16612.49 3821.76,-16575.45 3822.76,-16549.86 3798,-16513.49 3787.24,-16497.68 3772.67,-16485.15 3756.32,-16475.2"/>
<polygon fill="black" stroke="black" points="3758.04,-16472.15 3747.62,-16470.23 3754.56,-16478.23 3758.04,-16472.15"/>
</g>
<!-- comm_3&#45;&gt;attn_residual_4 -->
<g id="edge85" class="edge">
<title>comm_3&#45;&gt;attn_residual_4</title>
<path fill="none" stroke="black" d="M3812.41,-16623.54C3815.96,-16620.2 3819.18,-16616.52 3822,-16612.49 3831,-16599.59 3819.32,-16398.83 3817,-16394.49 3782.58,-16329.9 3722.13,-16280.86 3659.29,-16244.63"/>
<polygon fill="black" stroke="black" points="3660.83,-16241.48 3650.41,-16239.6 3657.39,-16247.57 3660.83,-16241.48"/>
</g>
<!-- comm_4&#45;&gt;mha_q_5 -->
<g id="edge96" class="edge">
<title>comm_4&#45;&gt;mha_q_5</title>
<path fill="none" stroke="black" d="M3395.37,-15240.89C3384.24,-15230.47 3372.02,-15219.05 3360.66,-15208.42"/>
<polygon fill="black" stroke="black" points="3363.02,-15205.84 3353.33,-15201.57 3358.24,-15210.96 3363.02,-15205.84"/>
</g>
<!-- comm_4&#45;&gt;mha_k_5 -->
<g id="edge97" class="edge">
<title>comm_4&#45;&gt;mha_k_5</title>
<path fill="none" stroke="black" d="M3228.92,-15254.49C3187.37,-15248.49 3144.12,-15241.21 3104,-15232.53 3069.48,-15225.07 3032.43,-15214.77 2999.08,-15204.61"/>
<polygon fill="black" stroke="black" points="2999.9,-15201.2 2989.31,-15201.61 2997.84,-15207.89 2999.9,-15201.2"/>
</g>
<!-- comm_4&#45;&gt;mha_v_5 -->
<g id="edge98" class="edge">
<title>comm_4&#45;&gt;mha_v_5</title>
<path fill="none" stroke="black" d="M3523.07,-15242.46C3526.03,-15239.42 3528.7,-15236.12 3531,-15232.53 3554.76,-15195.5 3555.76,-15169.91 3531,-15133.53 3520.24,-15117.73 3505.67,-15105.19 3489.32,-15095.24"/>
<polygon fill="black" stroke="black" points="3491.04,-15092.19 3480.62,-15090.28 3487.56,-15098.27 3491.04,-15092.19"/>
</g>
<!-- comm_4&#45;&gt;attn_residual_5 -->
<g id="edge104" class="edge">
<title>comm_4&#45;&gt;attn_residual_5</title>
<path fill="none" stroke="black" d="M3545.41,-15243.58C3548.96,-15240.24 3552.18,-15236.57 3555,-15232.53 3564,-15219.63 3552.32,-15018.88 3550,-15014.53 3515.58,-14949.94 3455.13,-14900.9 3392.29,-14864.68"/>
<polygon fill="black" stroke="black" points="3393.83,-14861.53 3383.41,-14859.65 3390.39,-14867.62 3393.83,-14861.53"/>
</g>
<!-- comm_5&#45;&gt;mha_q_6 -->
<g id="edge115" class="edge">
<title>comm_5&#45;&gt;mha_q_6</title>
<path fill="none" stroke="black" d="M3128.37,-13860.94C3117.24,-13850.52 3105.02,-13839.1 3093.66,-13828.47"/>
<polygon fill="black" stroke="black" points="3096.02,-13825.89 3086.33,-13821.62 3091.24,-13831 3096.02,-13825.89"/>
</g>
<!-- comm_5&#45;&gt;mha_k_6 -->
<g id="edge116" class="edge">
<title>comm_5&#45;&gt;mha_k_6</title>
<path fill="none" stroke="black" d="M2961.92,-13874.53C2920.37,-13868.54 2877.12,-13861.25 2837,-13852.58 2802.48,-13845.12 2765.43,-13834.82 2732.08,-13824.66"/>
<polygon fill="black" stroke="black" points="2732.9,-13821.25 2722.31,-13821.66 2730.84,-13827.94 2732.9,-13821.25"/>
</g>
<!-- comm_5&#45;&gt;mha_v_6 -->
<g id="edge117" class="edge">
<title>comm_5&#45;&gt;mha_v_6</title>
<path fill="none" stroke="black" d="M3256.07,-13862.51C3259.03,-13859.47 3261.7,-13856.17 3264,-13852.58 3287.76,-13815.55 3288.76,-13789.95 3264,-13753.58 3253.24,-13737.78 3238.67,-13725.24 3222.32,-13715.29"/>
<polygon fill="black" stroke="black" points="3224.04,-13712.24 3213.62,-13710.32 3220.56,-13718.32 3224.04,-13712.24"/>
</g>
<!-- comm_5&#45;&gt;attn_residual_6 -->
<g id="edge123" class="edge">
<title>comm_5&#45;&gt;attn_residual_6</title>
<path fill="none" stroke="black" d="M3278.41,-13863.63C3281.96,-13860.29 3285.18,-13856.62 3288,-13852.58 3297,-13839.68 3285.32,-13638.93 3283,-13634.58 3248.58,-13569.99 3188.13,-13520.95 3125.29,-13484.72"/>
<polygon fill="black" stroke="black" points="3126.83,-13481.58 3116.41,-13479.7 3123.39,-13487.67 3126.83,-13481.58"/>
</g>
<!-- comm_6&#45;&gt;mha_q_7 -->
<g id="edge134" class="edge">
<title>comm_6&#45;&gt;mha_q_7</title>
<path fill="none" stroke="black" d="M2861.37,-12480.98C2850.24,-12470.57 2838.02,-12459.15 2826.66,-12448.52"/>
<polygon fill="black" stroke="black" points="2829.02,-12445.94 2819.33,-12441.66 2824.24,-12451.05 2829.02,-12445.94"/>
</g>
<!-- comm_6&#45;&gt;mha_k_7 -->
<g id="edge135" class="edge">
<title>comm_6&#45;&gt;mha_k_7</title>
<path fill="none" stroke="black" d="M2694.92,-12494.58C2653.37,-12488.58 2610.12,-12481.3 2570,-12472.63 2535.48,-12465.16 2498.43,-12454.86 2465.08,-12444.7"/>
<polygon fill="black" stroke="black" points="2465.9,-12441.3 2455.31,-12441.7 2463.84,-12447.99 2465.9,-12441.3"/>
</g>
<!-- comm_6&#45;&gt;mha_v_7 -->
<g id="edge136" class="edge">
<title>comm_6&#45;&gt;mha_v_7</title>
<path fill="none" stroke="black" d="M2989.07,-12482.55C2992.03,-12479.51 2994.7,-12476.21 2997,-12472.63 3020.76,-12435.59 3021.76,-12410 2997,-12373.63 2986.24,-12357.82 2971.67,-12345.29 2955.32,-12335.34"/>
<polygon fill="black" stroke="black" points="2957.04,-12332.29 2946.62,-12330.37 2953.56,-12338.37 2957.04,-12332.29"/>
</g>
<!-- comm_6&#45;&gt;attn_residual_7 -->
<g id="edge142" class="edge">
<title>comm_6&#45;&gt;attn_residual_7</title>
<path fill="none" stroke="black" d="M3011.41,-12483.68C3014.96,-12480.34 3018.18,-12476.66 3021,-12472.63 3030,-12459.73 3018.32,-12258.97 3016,-12254.63 2981.58,-12190.04 2921.13,-12141 2858.29,-12104.77"/>
<polygon fill="black" stroke="black" points="2859.83,-12101.62 2849.41,-12099.74 2856.39,-12107.71 2859.83,-12101.62"/>
</g>
<!-- comm_7&#45;&gt;mha_q_8 -->
<g id="edge153" class="edge">
<title>comm_7&#45;&gt;mha_q_8</title>
<path fill="none" stroke="black" d="M2594.37,-11101.03C2583.24,-11090.61 2571.02,-11079.19 2559.66,-11068.56"/>
<polygon fill="black" stroke="black" points="2562.02,-11065.98 2552.33,-11061.71 2557.24,-11071.1 2562.02,-11065.98"/>
</g>
<!-- comm_7&#45;&gt;mha_k_8 -->
<g id="edge154" class="edge">
<title>comm_7&#45;&gt;mha_k_8</title>
<path fill="none" stroke="black" d="M2427.92,-11114.63C2386.37,-11108.63 2343.12,-11101.35 2303,-11092.67 2268.48,-11085.21 2231.43,-11074.91 2198.08,-11064.75"/>
<polygon fill="black" stroke="black" points="2198.9,-11061.34 2188.31,-11061.75 2196.84,-11068.03 2198.9,-11061.34"/>
</g>
<!-- comm_7&#45;&gt;mha_v_8 -->
<g id="edge155" class="edge">
<title>comm_7&#45;&gt;mha_v_8</title>
<path fill="none" stroke="black" d="M2722.07,-11102.6C2725.03,-11099.56 2727.7,-11096.26 2730,-11092.67 2753.76,-11055.64 2754.76,-11030.05 2730,-10993.67 2719.24,-10977.87 2704.67,-10965.33 2688.32,-10955.39"/>
<polygon fill="black" stroke="black" points="2690.04,-10952.33 2679.62,-10950.42 2686.56,-10958.41 2690.04,-10952.33"/>
</g>
<!-- comm_7&#45;&gt;attn_residual_8 -->
<g id="edge161" class="edge">
<title>comm_7&#45;&gt;attn_residual_8</title>
<path fill="none" stroke="black" d="M2744.41,-11103.72C2747.96,-11100.38 2751.18,-11096.71 2754,-11092.67 2763,-11079.77 2751.32,-10879.02 2749,-10874.67 2714.58,-10810.08 2654.13,-10761.04 2591.29,-10724.82"/>
<polygon fill="black" stroke="black" points="2592.83,-10721.67 2582.41,-10719.79 2589.39,-10727.76 2592.83,-10721.67"/>
</g>
<!-- comm_8&#45;&gt;mha_q_9 -->
<g id="edge172" class="edge">
<title>comm_8&#45;&gt;mha_q_9</title>
<path fill="none" stroke="black" d="M2327.37,-9721.08C2316.24,-9710.66 2304.02,-9699.24 2292.66,-9688.61"/>
<polygon fill="black" stroke="black" points="2295.02,-9686.03 2285.33,-9681.76 2290.24,-9691.14 2295.02,-9686.03"/>
</g>
<!-- comm_8&#45;&gt;mha_k_9 -->
<g id="edge173" class="edge">
<title>comm_8&#45;&gt;mha_k_9</title>
<path fill="none" stroke="black" d="M2160.92,-9734.67C2119.37,-9728.68 2076.12,-9721.39 2036,-9712.72 2001.48,-9705.26 1964.43,-9694.96 1931.08,-9684.8"/>
<polygon fill="black" stroke="black" points="1931.9,-9681.39 1921.31,-9681.8 1929.84,-9688.08 1931.9,-9681.39"/>
</g>
<!-- comm_8&#45;&gt;mha_v_9 -->
<g id="edge174" class="edge">
<title>comm_8&#45;&gt;mha_v_9</title>
<path fill="none" stroke="black" d="M2455.07,-9722.65C2458.03,-9719.61 2460.7,-9716.31 2463,-9712.72 2486.76,-9675.69 2487.76,-9650.09 2463,-9613.72 2452.24,-9597.92 2437.67,-9585.38 2421.32,-9575.43"/>
<polygon fill="black" stroke="black" points="2423.04,-9572.38 2412.62,-9570.46 2419.56,-9578.46 2423.04,-9572.38"/>
</g>
<!-- comm_8&#45;&gt;attn_residual_9 -->
<g id="edge180" class="edge">
<title>comm_8&#45;&gt;attn_residual_9</title>
<path fill="none" stroke="black" d="M2477.41,-9723.77C2480.96,-9720.43 2484.18,-9716.76 2487,-9712.72 2496,-9699.82 2484.32,-9499.07 2482,-9494.72 2447.58,-9430.13 2387.13,-9381.09 2324.29,-9344.86"/>
<polygon fill="black" stroke="black" points="2325.83,-9341.72 2315.41,-9339.84 2322.39,-9347.81 2325.83,-9341.72"/>
</g>
<!-- comm_9&#45;&gt;mha_q_10 -->
<g id="edge191" class="edge">
<title>comm_9&#45;&gt;mha_q_10</title>
<path fill="none" stroke="black" d="M2060.37,-8341.12C2049.24,-8330.71 2037.02,-8319.29 2025.66,-8308.66"/>
<polygon fill="black" stroke="black" points="2028.02,-8306.08 2018.33,-8301.8 2023.24,-8311.19 2028.02,-8306.08"/>
</g>
<!-- comm_9&#45;&gt;mha_k_10 -->
<g id="edge192" class="edge">
<title>comm_9&#45;&gt;mha_k_10</title>
<path fill="none" stroke="black" d="M1893.92,-8354.72C1852.37,-8348.72 1809.12,-8341.44 1769,-8332.77 1734.48,-8325.3 1697.43,-8315 1664.08,-8304.84"/>
<polygon fill="black" stroke="black" points="1664.9,-8301.44 1654.31,-8301.84 1662.84,-8308.13 1664.9,-8301.44"/>
</g>
<!-- comm_9&#45;&gt;mha_v_10 -->
<g id="edge193" class="edge">
<title>comm_9&#45;&gt;mha_v_10</title>
<path fill="none" stroke="black" d="M2188.07,-8342.69C2191.03,-8339.65 2193.7,-8336.35 2196,-8332.77 2219.76,-8295.73 2220.76,-8270.14 2196,-8233.77 2185.24,-8217.96 2170.67,-8205.43 2154.32,-8195.48"/>
<polygon fill="black" stroke="black" points="2156.04,-8192.43 2145.62,-8190.51 2152.56,-8198.51 2156.04,-8192.43"/>
</g>
<!-- comm_9&#45;&gt;attn_residual_10 -->
<g id="edge199" class="edge">
<title>comm_9&#45;&gt;attn_residual_10</title>
<path fill="none" stroke="black" d="M2210.41,-8343.82C2213.96,-8340.48 2217.18,-8336.8 2220,-8332.77 2229,-8319.87 2217.32,-8119.11 2215,-8114.77 2180.58,-8050.18 2120.13,-8001.14 2057.29,-7964.91"/>
<polygon fill="black" stroke="black" points="2058.83,-7961.76 2048.41,-7959.88 2055.39,-7967.85 2058.83,-7961.76"/>
</g>
<!-- comm_10&#45;&gt;mha_q_11 -->
<g id="edge210" class="edge">
<title>comm_10&#45;&gt;mha_q_11</title>
<path fill="none" stroke="black" d="M1793.37,-6961.17C1782.24,-6950.75 1770.02,-6939.33 1758.66,-6928.7"/>
<polygon fill="black" stroke="black" points="1761.02,-6926.12 1751.33,-6921.85 1756.24,-6931.24 1761.02,-6926.12"/>
</g>
<!-- comm_10&#45;&gt;mha_k_11 -->
<g id="edge211" class="edge">
<title>comm_10&#45;&gt;mha_k_11</title>
<path fill="none" stroke="black" d="M1626.92,-6974.77C1585.37,-6968.77 1542.12,-6961.49 1502,-6952.81 1467.48,-6945.35 1430.43,-6935.05 1397.08,-6924.89"/>
<polygon fill="black" stroke="black" points="1397.9,-6921.48 1387.31,-6921.89 1395.84,-6928.17 1397.9,-6921.48"/>
</g>
<!-- comm_10&#45;&gt;mha_v_11 -->
<g id="edge212" class="edge">
<title>comm_10&#45;&gt;mha_v_11</title>
<path fill="none" stroke="black" d="M1921.07,-6962.74C1924.03,-6959.7 1926.7,-6956.4 1929,-6952.81 1952.76,-6915.78 1953.76,-6890.19 1929,-6853.81 1918.24,-6838.01 1903.67,-6825.47 1887.32,-6815.53"/>
<polygon fill="black" stroke="black" points="1889.04,-6812.47 1878.62,-6810.56 1885.56,-6818.55 1889.04,-6812.47"/>
</g>
<!-- comm_10&#45;&gt;attn_residual_11 -->
<g id="edge218" class="edge">
<title>comm_10&#45;&gt;attn_residual_11</title>
<path fill="none" stroke="black" d="M1943.41,-6963.86C1946.96,-6960.52 1950.18,-6956.85 1953,-6952.81 1962,-6939.91 1950.32,-6739.16 1948,-6734.81 1913.58,-6670.22 1853.13,-6621.18 1790.29,-6584.96"/>
<polygon fill="black" stroke="black" points="1791.83,-6581.81 1781.41,-6579.93 1788.39,-6587.9 1791.83,-6581.81"/>
</g>
<!-- comm_11&#45;&gt;mha_q_12 -->
<g id="edge229" class="edge">
<title>comm_11&#45;&gt;mha_q_12</title>
<path fill="none" stroke="black" d="M1526.37,-5581.22C1515.24,-5570.8 1503.02,-5559.38 1491.66,-5548.75"/>
<polygon fill="black" stroke="black" points="1494.02,-5546.17 1484.33,-5541.9 1489.24,-5551.28 1494.02,-5546.17"/>
</g>
<!-- comm_11&#45;&gt;mha_k_12 -->
<g id="edge230" class="edge">
<title>comm_11&#45;&gt;mha_k_12</title>
<path fill="none" stroke="black" d="M1359.92,-5594.81C1318.37,-5588.82 1275.12,-5581.53 1235,-5572.86 1200.48,-5565.4 1163.43,-5555.1 1130.08,-5544.94"/>
<polygon fill="black" stroke="black" points="1130.9,-5541.53 1120.31,-5541.94 1128.84,-5548.22 1130.9,-5541.53"/>
</g>
<!-- comm_11&#45;&gt;mha_v_12 -->
<g id="edge231" class="edge">
<title>comm_11&#45;&gt;mha_v_12</title>
<path fill="none" stroke="black" d="M1654.07,-5582.79C1657.03,-5579.75 1659.7,-5576.45 1662,-5572.86 1685.76,-5535.83 1686.76,-5510.23 1662,-5473.86 1651.24,-5458.06 1636.67,-5445.52 1620.32,-5435.57"/>
<polygon fill="black" stroke="black" points="1622.04,-5432.52 1611.62,-5430.6 1618.56,-5438.6 1622.04,-5432.52"/>
</g>
<!-- comm_11&#45;&gt;attn_residual_12 -->
<g id="edge237" class="edge">
<title>comm_11&#45;&gt;attn_residual_12</title>
<path fill="none" stroke="black" d="M1676.41,-5583.91C1679.96,-5580.57 1683.18,-5576.9 1686,-5572.86 1695,-5559.96 1683.32,-5359.21 1681,-5354.86 1646.58,-5290.27 1586.13,-5241.23 1523.29,-5205"/>
<polygon fill="black" stroke="black" points="1524.83,-5201.86 1514.41,-5199.98 1521.39,-5207.95 1524.83,-5201.86"/>
</g>
<!-- comm_12&#45;&gt;mha_q_13 -->
<g id="edge248" class="edge">
<title>comm_12&#45;&gt;mha_q_13</title>
<path fill="none" stroke="black" d="M1259.37,-4201.26C1248.24,-4190.85 1236.02,-4179.43 1224.66,-4168.8"/>
<polygon fill="black" stroke="black" points="1227.02,-4166.22 1217.33,-4161.94 1222.24,-4171.33 1227.02,-4166.22"/>
</g>
<!-- comm_12&#45;&gt;mha_k_13 -->
<g id="edge249" class="edge">
<title>comm_12&#45;&gt;mha_k_13</title>
<path fill="none" stroke="black" d="M1092.92,-4214.86C1051.37,-4208.86 1008.12,-4201.58 968,-4192.91 933.48,-4185.44 896.43,-4175.14 863.08,-4164.98"/>
<polygon fill="black" stroke="black" points="863.9,-4161.58 853.31,-4161.98 861.84,-4168.27 863.9,-4161.58"/>
</g>
<!-- comm_12&#45;&gt;mha_v_13 -->
<g id="edge250" class="edge">
<title>comm_12&#45;&gt;mha_v_13</title>
<path fill="none" stroke="black" d="M1387.07,-4202.83C1390.03,-4199.79 1392.7,-4196.49 1395,-4192.91 1418.76,-4155.87 1419.76,-4130.28 1395,-4093.91 1384.24,-4078.1 1369.67,-4065.57 1353.32,-4055.62"/>
<polygon fill="black" stroke="black" points="1355.04,-4052.57 1344.62,-4050.65 1351.56,-4058.65 1355.04,-4052.57"/>
</g>
<!-- comm_12&#45;&gt;attn_residual_13 -->
<g id="edge256" class="edge">
<title>comm_12&#45;&gt;attn_residual_13</title>
<path fill="none" stroke="black" d="M1409.41,-4203.96C1412.96,-4200.62 1416.18,-4196.94 1419,-4192.91 1428,-4180.01 1416.32,-3979.25 1414,-3974.91 1379.58,-3910.32 1319.13,-3861.28 1256.29,-3825.05"/>
<polygon fill="black" stroke="black" points="1257.83,-3821.9 1247.41,-3820.02 1254.39,-3827.99 1257.83,-3821.9"/>
</g>
<!-- comm_13&#45;&gt;mha_q_14 -->
<g id="edge267" class="edge">
<title>comm_13&#45;&gt;mha_q_14</title>
<path fill="none" stroke="black" d="M992.37,-2821.31C981.24,-2810.89 969.02,-2799.47 957.66,-2788.84"/>
<polygon fill="black" stroke="black" points="960.02,-2786.26 950.33,-2781.99 955.24,-2791.38 960.02,-2786.26"/>
</g>
<!-- comm_13&#45;&gt;mha_k_14 -->
<g id="edge268" class="edge">
<title>comm_13&#45;&gt;mha_k_14</title>
<path fill="none" stroke="black" d="M825.92,-2834.91C784.37,-2828.91 741.12,-2821.63 701,-2812.95 666.48,-2805.49 629.43,-2795.19 596.08,-2785.03"/>
<polygon fill="black" stroke="black" points="596.9,-2781.62 586.31,-2782.03 594.84,-2788.31 596.9,-2781.62"/>
</g>
<!-- comm_13&#45;&gt;mha_v_14 -->
<g id="edge269" class="edge">
<title>comm_13&#45;&gt;mha_v_14</title>
<path fill="none" stroke="black" d="M1120.07,-2822.88C1123.03,-2819.84 1125.7,-2816.54 1128,-2812.95 1151.76,-2775.92 1152.76,-2750.33 1128,-2713.95 1117.24,-2698.15 1102.67,-2685.61 1086.32,-2675.67"/>
<polygon fill="black" stroke="black" points="1088.04,-2672.61 1077.62,-2670.7 1084.56,-2678.69 1088.04,-2672.61"/>
</g>
<!-- comm_13&#45;&gt;attn_residual_14 -->
<g id="edge275" class="edge">
<title>comm_13&#45;&gt;attn_residual_14</title>
<path fill="none" stroke="black" d="M1142.41,-2824C1145.96,-2820.66 1149.18,-2816.99 1152,-2812.95 1161,-2800.05 1149.32,-2599.3 1147,-2594.95 1112.58,-2530.36 1052.13,-2481.32 989.29,-2445.1"/>
<polygon fill="black" stroke="black" points="990.83,-2441.95 980.41,-2440.07 987.39,-2448.04 990.83,-2441.95"/>
</g>
<!-- comm_14&#45;&gt;mha_q_15 -->
<g id="edge286" class="edge">
<title>comm_14&#45;&gt;mha_q_15</title>
<path fill="none" stroke="black" d="M725.37,-1441.36C714.24,-1430.94 702.02,-1419.52 690.66,-1408.89"/>
<polygon fill="black" stroke="black" points="693.02,-1406.31 683.33,-1402.04 688.24,-1411.42 693.02,-1406.31"/>
</g>
<!-- comm_14&#45;&gt;mha_k_15 -->
<g id="edge287" class="edge">
<title>comm_14&#45;&gt;mha_k_15</title>
<path fill="none" stroke="black" d="M558.92,-1454.95C517.37,-1448.96 474.12,-1441.67 434,-1433 399.48,-1425.54 362.43,-1415.24 329.08,-1405.08"/>
<polygon fill="black" stroke="black" points="329.9,-1401.67 319.31,-1402.08 327.84,-1408.36 329.9,-1401.67"/>
</g>
<!-- comm_14&#45;&gt;mha_v_15 -->
<g id="edge288" class="edge">
<title>comm_14&#45;&gt;mha_v_15</title>
<path fill="none" stroke="black" d="M853.07,-1442.93C856.03,-1439.89 858.7,-1436.59 861,-1433 884.76,-1395.97 885.76,-1370.37 861,-1334 850.24,-1318.2 835.67,-1305.66 819.32,-1295.71"/>
<polygon fill="black" stroke="black" points="821.04,-1292.66 810.62,-1290.74 817.56,-1298.74 821.04,-1292.66"/>
</g>
<!-- comm_14&#45;&gt;attn_residual_15 -->
<g id="edge294" class="edge">
<title>comm_14&#45;&gt;attn_residual_15</title>
<path fill="none" stroke="black" d="M875.41,-1444.05C878.96,-1440.71 882.18,-1437.04 885,-1433 894,-1420.1 882.32,-1219.35 880,-1215 845.58,-1150.41 785.13,-1101.37 722.29,-1065.14"/>
<polygon fill="black" stroke="black" points="723.83,-1062 713.41,-1060.12 720.39,-1068.09 723.83,-1062"/>
</g>
</g>
</svg>
