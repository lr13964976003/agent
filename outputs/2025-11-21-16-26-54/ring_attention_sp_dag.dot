// Dense Transformer - Ring Attention + Sequence Parallel (SP=16)
digraph {
	concentrate=true rankdir=TB size="25,25"
	subgraph cluster_device_0 {
		color=color0 fillcolor=lightcolor0 label="Device 0
Sequence: [0, 6249]
Local tokens: 6250" style=rounded
		input_split_0 [label="Sequence Split
Input: [batch=128, seq=100000, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 0" fillcolor=lightyellow shape=parallelogram style=filled]
		embed_0 [label="Embedding
Input: [batch=128, seq=6250]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 0" fillcolor=lightgreen shape=rectangle style=filled]
		ln0_pre_0 [label="LayerNorm L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 0" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_0_0 [label="Q Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 0" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_0_0 [label="K Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 0" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_0_0 [label="V Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 0" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_0_0 [label="Ring Attention L0
Local Q: [batch=128, seq=6250, heads=32, d_k=128]
Ring K,V: [batch=128, seq=100000, heads=32, d_k=128]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 0
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_0_0_0 [label="Send K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_0_0 [label="Recv K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_0_1 [label="Send K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_0_1 [label="Recv K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_0_2 [label="Send K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_0_2 [label="Recv K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_0_3 [label="Send K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_0_3 [label="Recv K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_0_4 [label="Send K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_0_4 [label="Recv K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_0_5 [label="Send K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_0_5 [label="Recv K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_0_6 [label="Send K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_0_6 [label="Recv K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_0_7 [label="Send K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_0_7 [label="Recv K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_0_8 [label="Send K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_0_8 [label="Recv K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_0_9 [label="Send K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_0_9 [label="Recv K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_0_10 [label="Send K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_0_10 [label="Recv K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_0_11 [label="Send K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_0_11 [label="Recv K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_0_12 [label="Send K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_0_12 [label="Recv K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_0_13 [label="Send K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_0_13 [label="Recv K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_0_14 [label="Send K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_0_14 [label="Recv K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_0_15 [label="Send K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_0_15 [label="Recv K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_0_0 [label="O Projection L0
Input: [batch=128, seq=6250, heads=32, d_k=128]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 0" fillcolor=lightblue shape=rectangle style=filled]
		add_0_0 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 0" fillcolor=lightgray shape=rectangle style=filled]
		mlp0_gate_0 [label="MLP Gate L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 0" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_up_0 [label="MLP Up L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 0" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_down_0 [label="MLP Down L0
Input: [batch=128, seq=6250, mlp_hidden=32768]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 0" fillcolor=lightpink shape=rectangle style=filled]
		add_1_0 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 0" fillcolor=lightgray shape=rectangle style=filled]
		ln1_pre_0 [label="LayerNorm L1
GPU: 0" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_1_0 [label="Q Proj L1
GPU: 0" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_1_0 [label="K Proj L1
GPU: 0" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_1_0 [label="V Proj L1
GPU: 0" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_1_0 [label="Ring Attention L1
GPU: 0
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_1_0_0 [label="Send K,V L1
Stage 0
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_0_0 [label="Recv K,V L1
Stage 0
From: 0
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_0_1 [label="Send K,V L1
Stage 1
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_0_1 [label="Recv K,V L1
Stage 1
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_0_2 [label="Send K,V L1
Stage 2
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_0_2 [label="Recv K,V L1
Stage 2
From: 14
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_0_3 [label="Send K,V L1
Stage 3
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_0_3 [label="Recv K,V L1
Stage 3
From: 13
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_0_4 [label="Send K,V L1
Stage 4
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_0_4 [label="Recv K,V L1
Stage 4
From: 12
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_0_5 [label="Send K,V L1
Stage 5
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_0_5 [label="Recv K,V L1
Stage 5
From: 11
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_0_6 [label="Send K,V L1
Stage 6
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_0_6 [label="Recv K,V L1
Stage 6
From: 10
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_0_7 [label="Send K,V L1
Stage 7
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_0_7 [label="Recv K,V L1
Stage 7
From: 9
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_0_8 [label="Send K,V L1
Stage 8
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_0_8 [label="Recv K,V L1
Stage 8
From: 8
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_0_9 [label="Send K,V L1
Stage 9
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_0_9 [label="Recv K,V L1
Stage 9
From: 7
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_0_10 [label="Send K,V L1
Stage 10
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_0_10 [label="Recv K,V L1
Stage 10
From: 6
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_0_11 [label="Send K,V L1
Stage 11
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_0_11 [label="Recv K,V L1
Stage 11
From: 5
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_0_12 [label="Send K,V L1
Stage 12
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_0_12 [label="Recv K,V L1
Stage 12
From: 4
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_0_13 [label="Send K,V L1
Stage 13
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_0_13 [label="Recv K,V L1
Stage 13
From: 3
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_0_14 [label="Send K,V L1
Stage 14
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_0_14 [label="Recv K,V L1
Stage 14
From: 2
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_0_15 [label="Send K,V L1
Stage 15
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_0_15 [label="Recv K,V L1
Stage 15
From: 1
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_1_0 [label="O Proj L1
GPU: 0" fillcolor=lightblue shape=rectangle style=filled]
		add_2_0 [label="Residual Add L1
GPU: 0" fillcolor=lightgray shape=rectangle style=filled]
		mlp1_gate_0 [label="MLP Gate L1
GPU: 0" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_up_0 [label="MLP Up L1
GPU: 0" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_down_0 [label="MLP Down L1
GPU: 0" fillcolor=lightpink shape=rectangle style=filled]
		add_3_0 [label="Residual Add L1
GPU: 0" fillcolor=lightgray shape=rectangle style=filled]
		ln2_pre_0 [label="LayerNorm L2
GPU: 0" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_2_0 [label="Ring Attention L2
GPU: 0
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_2_0 [label="O Proj L2
GPU: 0" fillcolor=lightblue shape=rectangle style=filled]
		add_4_0 [label="Residual Add L2
GPU: 0" fillcolor=lightgray shape=rectangle style=filled]
		mlp2_down_0 [label="MLP Down L2
GPU: 0" fillcolor=lightpink shape=rectangle style=filled]
		add_5_0 [label="Residual Add L2
GPU: 0" fillcolor=lightgray shape=rectangle style=filled]
		ln3_pre_0 [label="LayerNorm L3
GPU: 0" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_3_0 [label="Ring Attention L3
GPU: 0
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_3_0 [label="O Proj L3
GPU: 0" fillcolor=lightblue shape=rectangle style=filled]
		add_6_0 [label="Residual Add L3
GPU: 0" fillcolor=lightgray shape=rectangle style=filled]
		mlp3_down_0 [label="MLP Down L3
GPU: 0" fillcolor=lightpink shape=rectangle style=filled]
		add_7_0 [label="Residual Add L3
GPU: 0" fillcolor=lightgray shape=rectangle style=filled]
		output_gather_0 [label="Gather Output
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=100000, d_model=4096]
GPU: 0→All" fillcolor=lightsteelblue shape=parallelogram style=filled]
	}
	subgraph cluster_device_1 {
		color=color1 fillcolor=lightcolor1 label="Device 1
Sequence: [6250, 12499]
Local tokens: 6250" style=rounded
		input_split_1 [label="Sequence Split
Input: [batch=128, seq=100000, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 1" fillcolor=lightyellow shape=parallelogram style=filled]
		embed_1 [label="Embedding
Input: [batch=128, seq=6250]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 1" fillcolor=lightgreen shape=rectangle style=filled]
		ln0_pre_1 [label="LayerNorm L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 1" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_0_1 [label="Q Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 1" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_0_1 [label="K Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 1" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_0_1 [label="V Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 1" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_0_1 [label="Ring Attention L0
Local Q: [batch=128, seq=6250, heads=32, d_k=128]
Ring K,V: [batch=128, seq=100000, heads=32, d_k=128]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 1
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_0_1_0 [label="Send K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_1_0 [label="Recv K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_1_1 [label="Send K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_1_1 [label="Recv K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_1_2 [label="Send K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_1_2 [label="Recv K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_1_3 [label="Send K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_1_3 [label="Recv K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_1_4 [label="Send K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_1_4 [label="Recv K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_1_5 [label="Send K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_1_5 [label="Recv K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_1_6 [label="Send K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_1_6 [label="Recv K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_1_7 [label="Send K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_1_7 [label="Recv K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_1_8 [label="Send K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_1_8 [label="Recv K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_1_9 [label="Send K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_1_9 [label="Recv K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_1_10 [label="Send K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_1_10 [label="Recv K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_1_11 [label="Send K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_1_11 [label="Recv K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_1_12 [label="Send K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_1_12 [label="Recv K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_1_13 [label="Send K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_1_13 [label="Recv K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_1_14 [label="Send K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_1_14 [label="Recv K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_1_15 [label="Send K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_1_15 [label="Recv K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_0_1 [label="O Projection L0
Input: [batch=128, seq=6250, heads=32, d_k=128]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 1" fillcolor=lightblue shape=rectangle style=filled]
		add_0_1 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 1" fillcolor=lightgray shape=rectangle style=filled]
		mlp0_gate_1 [label="MLP Gate L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 1" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_up_1 [label="MLP Up L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 1" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_down_1 [label="MLP Down L0
Input: [batch=128, seq=6250, mlp_hidden=32768]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 1" fillcolor=lightpink shape=rectangle style=filled]
		add_1_1 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 1" fillcolor=lightgray shape=rectangle style=filled]
		ln1_pre_1 [label="LayerNorm L1
GPU: 1" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_1_1 [label="Q Proj L1
GPU: 1" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_1_1 [label="K Proj L1
GPU: 1" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_1_1 [label="V Proj L1
GPU: 1" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_1_1 [label="Ring Attention L1
GPU: 1
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_1_1_0 [label="Send K,V L1
Stage 0
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_1_0 [label="Recv K,V L1
Stage 0
From: 1
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_1_1 [label="Send K,V L1
Stage 1
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_1_1 [label="Recv K,V L1
Stage 1
From: 0
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_1_2 [label="Send K,V L1
Stage 2
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_1_2 [label="Recv K,V L1
Stage 2
From: 15
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_1_3 [label="Send K,V L1
Stage 3
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_1_3 [label="Recv K,V L1
Stage 3
From: 14
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_1_4 [label="Send K,V L1
Stage 4
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_1_4 [label="Recv K,V L1
Stage 4
From: 13
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_1_5 [label="Send K,V L1
Stage 5
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_1_5 [label="Recv K,V L1
Stage 5
From: 12
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_1_6 [label="Send K,V L1
Stage 6
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_1_6 [label="Recv K,V L1
Stage 6
From: 11
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_1_7 [label="Send K,V L1
Stage 7
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_1_7 [label="Recv K,V L1
Stage 7
From: 10
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_1_8 [label="Send K,V L1
Stage 8
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_1_8 [label="Recv K,V L1
Stage 8
From: 9
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_1_9 [label="Send K,V L1
Stage 9
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_1_9 [label="Recv K,V L1
Stage 9
From: 8
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_1_10 [label="Send K,V L1
Stage 10
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_1_10 [label="Recv K,V L1
Stage 10
From: 7
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_1_11 [label="Send K,V L1
Stage 11
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_1_11 [label="Recv K,V L1
Stage 11
From: 6
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_1_12 [label="Send K,V L1
Stage 12
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_1_12 [label="Recv K,V L1
Stage 12
From: 5
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_1_13 [label="Send K,V L1
Stage 13
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_1_13 [label="Recv K,V L1
Stage 13
From: 4
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_1_14 [label="Send K,V L1
Stage 14
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_1_14 [label="Recv K,V L1
Stage 14
From: 3
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_1_15 [label="Send K,V L1
Stage 15
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_1_15 [label="Recv K,V L1
Stage 15
From: 2
To: 1" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_1_1 [label="O Proj L1
GPU: 1" fillcolor=lightblue shape=rectangle style=filled]
		add_2_1 [label="Residual Add L1
GPU: 1" fillcolor=lightgray shape=rectangle style=filled]
		mlp1_gate_1 [label="MLP Gate L1
GPU: 1" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_up_1 [label="MLP Up L1
GPU: 1" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_down_1 [label="MLP Down L1
GPU: 1" fillcolor=lightpink shape=rectangle style=filled]
		add_3_1 [label="Residual Add L1
GPU: 1" fillcolor=lightgray shape=rectangle style=filled]
		ln2_pre_1 [label="LayerNorm L2
GPU: 1" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_2_1 [label="Ring Attention L2
GPU: 1
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_2_1 [label="O Proj L2
GPU: 1" fillcolor=lightblue shape=rectangle style=filled]
		add_4_1 [label="Residual Add L2
GPU: 1" fillcolor=lightgray shape=rectangle style=filled]
		mlp2_down_1 [label="MLP Down L2
GPU: 1" fillcolor=lightpink shape=rectangle style=filled]
		add_5_1 [label="Residual Add L2
GPU: 1" fillcolor=lightgray shape=rectangle style=filled]
		ln3_pre_1 [label="LayerNorm L3
GPU: 1" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_3_1 [label="Ring Attention L3
GPU: 1
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_3_1 [label="O Proj L3
GPU: 1" fillcolor=lightblue shape=rectangle style=filled]
		add_6_1 [label="Residual Add L3
GPU: 1" fillcolor=lightgray shape=rectangle style=filled]
		mlp3_down_1 [label="MLP Down L3
GPU: 1" fillcolor=lightpink shape=rectangle style=filled]
		add_7_1 [label="Residual Add L3
GPU: 1" fillcolor=lightgray shape=rectangle style=filled]
		output_gather_1 [label="Gather Output
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=100000, d_model=4096]
GPU: 1→All" fillcolor=lightsteelblue shape=parallelogram style=filled]
	}
	subgraph cluster_device_2 {
		color=color2 fillcolor=lightcolor2 label="Device 2
Sequence: [12500, 18749]
Local tokens: 6250" style=rounded
		input_split_2 [label="Sequence Split
Input: [batch=128, seq=100000, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 2" fillcolor=lightyellow shape=parallelogram style=filled]
		embed_2 [label="Embedding
Input: [batch=128, seq=6250]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 2" fillcolor=lightgreen shape=rectangle style=filled]
		ln0_pre_2 [label="LayerNorm L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 2" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_0_2 [label="Q Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 2" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_0_2 [label="K Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 2" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_0_2 [label="V Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 2" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_0_2 [label="Ring Attention L0
Local Q: [batch=128, seq=6250, heads=32, d_k=128]
Ring K,V: [batch=128, seq=100000, heads=32, d_k=128]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 2
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_0_2_0 [label="Send K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_2_0 [label="Recv K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_2_1 [label="Send K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_2_1 [label="Recv K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_2_2 [label="Send K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_2_2 [label="Recv K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_2_3 [label="Send K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_2_3 [label="Recv K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_2_4 [label="Send K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_2_4 [label="Recv K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_2_5 [label="Send K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_2_5 [label="Recv K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_2_6 [label="Send K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_2_6 [label="Recv K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_2_7 [label="Send K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_2_7 [label="Recv K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_2_8 [label="Send K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_2_8 [label="Recv K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_2_9 [label="Send K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_2_9 [label="Recv K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_2_10 [label="Send K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_2_10 [label="Recv K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_2_11 [label="Send K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_2_11 [label="Recv K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_2_12 [label="Send K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_2_12 [label="Recv K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_2_13 [label="Send K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_2_13 [label="Recv K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_2_14 [label="Send K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_2_14 [label="Recv K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_2_15 [label="Send K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_2_15 [label="Recv K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_0_2 [label="O Projection L0
Input: [batch=128, seq=6250, heads=32, d_k=128]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 2" fillcolor=lightblue shape=rectangle style=filled]
		add_0_2 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 2" fillcolor=lightgray shape=rectangle style=filled]
		mlp0_gate_2 [label="MLP Gate L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 2" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_up_2 [label="MLP Up L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 2" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_down_2 [label="MLP Down L0
Input: [batch=128, seq=6250, mlp_hidden=32768]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 2" fillcolor=lightpink shape=rectangle style=filled]
		add_1_2 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 2" fillcolor=lightgray shape=rectangle style=filled]
		ln1_pre_2 [label="LayerNorm L1
GPU: 2" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_1_2 [label="Q Proj L1
GPU: 2" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_1_2 [label="K Proj L1
GPU: 2" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_1_2 [label="V Proj L1
GPU: 2" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_1_2 [label="Ring Attention L1
GPU: 2
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_1_2_0 [label="Send K,V L1
Stage 0
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_2_0 [label="Recv K,V L1
Stage 0
From: 2
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_2_1 [label="Send K,V L1
Stage 1
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_2_1 [label="Recv K,V L1
Stage 1
From: 1
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_2_2 [label="Send K,V L1
Stage 2
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_2_2 [label="Recv K,V L1
Stage 2
From: 0
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_2_3 [label="Send K,V L1
Stage 3
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_2_3 [label="Recv K,V L1
Stage 3
From: 15
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_2_4 [label="Send K,V L1
Stage 4
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_2_4 [label="Recv K,V L1
Stage 4
From: 14
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_2_5 [label="Send K,V L1
Stage 5
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_2_5 [label="Recv K,V L1
Stage 5
From: 13
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_2_6 [label="Send K,V L1
Stage 6
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_2_6 [label="Recv K,V L1
Stage 6
From: 12
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_2_7 [label="Send K,V L1
Stage 7
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_2_7 [label="Recv K,V L1
Stage 7
From: 11
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_2_8 [label="Send K,V L1
Stage 8
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_2_8 [label="Recv K,V L1
Stage 8
From: 10
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_2_9 [label="Send K,V L1
Stage 9
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_2_9 [label="Recv K,V L1
Stage 9
From: 9
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_2_10 [label="Send K,V L1
Stage 10
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_2_10 [label="Recv K,V L1
Stage 10
From: 8
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_2_11 [label="Send K,V L1
Stage 11
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_2_11 [label="Recv K,V L1
Stage 11
From: 7
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_2_12 [label="Send K,V L1
Stage 12
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_2_12 [label="Recv K,V L1
Stage 12
From: 6
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_2_13 [label="Send K,V L1
Stage 13
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_2_13 [label="Recv K,V L1
Stage 13
From: 5
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_2_14 [label="Send K,V L1
Stage 14
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_2_14 [label="Recv K,V L1
Stage 14
From: 4
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_2_15 [label="Send K,V L1
Stage 15
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_2_15 [label="Recv K,V L1
Stage 15
From: 3
To: 2" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_1_2 [label="O Proj L1
GPU: 2" fillcolor=lightblue shape=rectangle style=filled]
		add_2_2 [label="Residual Add L1
GPU: 2" fillcolor=lightgray shape=rectangle style=filled]
		mlp1_gate_2 [label="MLP Gate L1
GPU: 2" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_up_2 [label="MLP Up L1
GPU: 2" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_down_2 [label="MLP Down L1
GPU: 2" fillcolor=lightpink shape=rectangle style=filled]
		add_3_2 [label="Residual Add L1
GPU: 2" fillcolor=lightgray shape=rectangle style=filled]
		ln2_pre_2 [label="LayerNorm L2
GPU: 2" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_2_2 [label="Ring Attention L2
GPU: 2
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_2_2 [label="O Proj L2
GPU: 2" fillcolor=lightblue shape=rectangle style=filled]
		add_4_2 [label="Residual Add L2
GPU: 2" fillcolor=lightgray shape=rectangle style=filled]
		mlp2_down_2 [label="MLP Down L2
GPU: 2" fillcolor=lightpink shape=rectangle style=filled]
		add_5_2 [label="Residual Add L2
GPU: 2" fillcolor=lightgray shape=rectangle style=filled]
		ln3_pre_2 [label="LayerNorm L3
GPU: 2" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_3_2 [label="Ring Attention L3
GPU: 2
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_3_2 [label="O Proj L3
GPU: 2" fillcolor=lightblue shape=rectangle style=filled]
		add_6_2 [label="Residual Add L3
GPU: 2" fillcolor=lightgray shape=rectangle style=filled]
		mlp3_down_2 [label="MLP Down L3
GPU: 2" fillcolor=lightpink shape=rectangle style=filled]
		add_7_2 [label="Residual Add L3
GPU: 2" fillcolor=lightgray shape=rectangle style=filled]
		output_gather_2 [label="Gather Output
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=100000, d_model=4096]
GPU: 2→All" fillcolor=lightsteelblue shape=parallelogram style=filled]
	}
	subgraph cluster_device_3 {
		color=color3 fillcolor=lightcolor3 label="Device 3
Sequence: [18750, 24999]
Local tokens: 6250" style=rounded
		input_split_3 [label="Sequence Split
Input: [batch=128, seq=100000, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 3" fillcolor=lightyellow shape=parallelogram style=filled]
		embed_3 [label="Embedding
Input: [batch=128, seq=6250]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 3" fillcolor=lightgreen shape=rectangle style=filled]
		ln0_pre_3 [label="LayerNorm L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 3" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_0_3 [label="Q Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 3" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_0_3 [label="K Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 3" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_0_3 [label="V Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 3" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_0_3 [label="Ring Attention L0
Local Q: [batch=128, seq=6250, heads=32, d_k=128]
Ring K,V: [batch=128, seq=100000, heads=32, d_k=128]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 3
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_0_3_0 [label="Send K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_3_0 [label="Recv K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_3_1 [label="Send K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_3_1 [label="Recv K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_3_2 [label="Send K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_3_2 [label="Recv K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_3_3 [label="Send K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_3_3 [label="Recv K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_3_4 [label="Send K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_3_4 [label="Recv K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_3_5 [label="Send K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_3_5 [label="Recv K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_3_6 [label="Send K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_3_6 [label="Recv K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_3_7 [label="Send K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_3_7 [label="Recv K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_3_8 [label="Send K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_3_8 [label="Recv K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_3_9 [label="Send K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_3_9 [label="Recv K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_3_10 [label="Send K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_3_10 [label="Recv K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_3_11 [label="Send K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_3_11 [label="Recv K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_3_12 [label="Send K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_3_12 [label="Recv K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_3_13 [label="Send K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_3_13 [label="Recv K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_3_14 [label="Send K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_3_14 [label="Recv K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_3_15 [label="Send K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_3_15 [label="Recv K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_0_3 [label="O Projection L0
Input: [batch=128, seq=6250, heads=32, d_k=128]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 3" fillcolor=lightblue shape=rectangle style=filled]
		add_0_3 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 3" fillcolor=lightgray shape=rectangle style=filled]
		mlp0_gate_3 [label="MLP Gate L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 3" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_up_3 [label="MLP Up L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 3" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_down_3 [label="MLP Down L0
Input: [batch=128, seq=6250, mlp_hidden=32768]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 3" fillcolor=lightpink shape=rectangle style=filled]
		add_1_3 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 3" fillcolor=lightgray shape=rectangle style=filled]
		ln1_pre_3 [label="LayerNorm L1
GPU: 3" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_1_3 [label="Q Proj L1
GPU: 3" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_1_3 [label="K Proj L1
GPU: 3" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_1_3 [label="V Proj L1
GPU: 3" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_1_3 [label="Ring Attention L1
GPU: 3
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_1_3_0 [label="Send K,V L1
Stage 0
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_3_0 [label="Recv K,V L1
Stage 0
From: 3
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_3_1 [label="Send K,V L1
Stage 1
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_3_1 [label="Recv K,V L1
Stage 1
From: 2
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_3_2 [label="Send K,V L1
Stage 2
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_3_2 [label="Recv K,V L1
Stage 2
From: 1
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_3_3 [label="Send K,V L1
Stage 3
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_3_3 [label="Recv K,V L1
Stage 3
From: 0
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_3_4 [label="Send K,V L1
Stage 4
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_3_4 [label="Recv K,V L1
Stage 4
From: 15
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_3_5 [label="Send K,V L1
Stage 5
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_3_5 [label="Recv K,V L1
Stage 5
From: 14
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_3_6 [label="Send K,V L1
Stage 6
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_3_6 [label="Recv K,V L1
Stage 6
From: 13
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_3_7 [label="Send K,V L1
Stage 7
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_3_7 [label="Recv K,V L1
Stage 7
From: 12
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_3_8 [label="Send K,V L1
Stage 8
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_3_8 [label="Recv K,V L1
Stage 8
From: 11
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_3_9 [label="Send K,V L1
Stage 9
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_3_9 [label="Recv K,V L1
Stage 9
From: 10
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_3_10 [label="Send K,V L1
Stage 10
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_3_10 [label="Recv K,V L1
Stage 10
From: 9
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_3_11 [label="Send K,V L1
Stage 11
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_3_11 [label="Recv K,V L1
Stage 11
From: 8
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_3_12 [label="Send K,V L1
Stage 12
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_3_12 [label="Recv K,V L1
Stage 12
From: 7
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_3_13 [label="Send K,V L1
Stage 13
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_3_13 [label="Recv K,V L1
Stage 13
From: 6
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_3_14 [label="Send K,V L1
Stage 14
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_3_14 [label="Recv K,V L1
Stage 14
From: 5
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_3_15 [label="Send K,V L1
Stage 15
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_3_15 [label="Recv K,V L1
Stage 15
From: 4
To: 3" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_1_3 [label="O Proj L1
GPU: 3" fillcolor=lightblue shape=rectangle style=filled]
		add_2_3 [label="Residual Add L1
GPU: 3" fillcolor=lightgray shape=rectangle style=filled]
		mlp1_gate_3 [label="MLP Gate L1
GPU: 3" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_up_3 [label="MLP Up L1
GPU: 3" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_down_3 [label="MLP Down L1
GPU: 3" fillcolor=lightpink shape=rectangle style=filled]
		add_3_3 [label="Residual Add L1
GPU: 3" fillcolor=lightgray shape=rectangle style=filled]
		ln2_pre_3 [label="LayerNorm L2
GPU: 3" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_2_3 [label="Ring Attention L2
GPU: 3
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_2_3 [label="O Proj L2
GPU: 3" fillcolor=lightblue shape=rectangle style=filled]
		add_4_3 [label="Residual Add L2
GPU: 3" fillcolor=lightgray shape=rectangle style=filled]
		mlp2_down_3 [label="MLP Down L2
GPU: 3" fillcolor=lightpink shape=rectangle style=filled]
		add_5_3 [label="Residual Add L2
GPU: 3" fillcolor=lightgray shape=rectangle style=filled]
		ln3_pre_3 [label="LayerNorm L3
GPU: 3" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_3_3 [label="Ring Attention L3
GPU: 3
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_3_3 [label="O Proj L3
GPU: 3" fillcolor=lightblue shape=rectangle style=filled]
		add_6_3 [label="Residual Add L3
GPU: 3" fillcolor=lightgray shape=rectangle style=filled]
		mlp3_down_3 [label="MLP Down L3
GPU: 3" fillcolor=lightpink shape=rectangle style=filled]
		add_7_3 [label="Residual Add L3
GPU: 3" fillcolor=lightgray shape=rectangle style=filled]
		output_gather_3 [label="Gather Output
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=100000, d_model=4096]
GPU: 3→All" fillcolor=lightsteelblue shape=parallelogram style=filled]
	}
	subgraph cluster_device_4 {
		color=color4 fillcolor=lightcolor4 label="Device 4
Sequence: [25000, 31249]
Local tokens: 6250" style=rounded
		input_split_4 [label="Sequence Split
Input: [batch=128, seq=100000, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 4" fillcolor=lightyellow shape=parallelogram style=filled]
		embed_4 [label="Embedding
Input: [batch=128, seq=6250]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 4" fillcolor=lightgreen shape=rectangle style=filled]
		ln0_pre_4 [label="LayerNorm L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 4" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_0_4 [label="Q Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 4" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_0_4 [label="K Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 4" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_0_4 [label="V Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 4" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_0_4 [label="Ring Attention L0
Local Q: [batch=128, seq=6250, heads=32, d_k=128]
Ring K,V: [batch=128, seq=100000, heads=32, d_k=128]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 4
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_0_4_0 [label="Send K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_4_0 [label="Recv K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_4_1 [label="Send K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_4_1 [label="Recv K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_4_2 [label="Send K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_4_2 [label="Recv K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_4_3 [label="Send K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_4_3 [label="Recv K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_4_4 [label="Send K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_4_4 [label="Recv K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_4_5 [label="Send K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_4_5 [label="Recv K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_4_6 [label="Send K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_4_6 [label="Recv K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_4_7 [label="Send K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_4_7 [label="Recv K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_4_8 [label="Send K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_4_8 [label="Recv K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_4_9 [label="Send K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_4_9 [label="Recv K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_4_10 [label="Send K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_4_10 [label="Recv K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_4_11 [label="Send K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_4_11 [label="Recv K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_4_12 [label="Send K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_4_12 [label="Recv K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_4_13 [label="Send K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_4_13 [label="Recv K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_4_14 [label="Send K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_4_14 [label="Recv K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_4_15 [label="Send K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_4_15 [label="Recv K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_0_4 [label="O Projection L0
Input: [batch=128, seq=6250, heads=32, d_k=128]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 4" fillcolor=lightblue shape=rectangle style=filled]
		add_0_4 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 4" fillcolor=lightgray shape=rectangle style=filled]
		mlp0_gate_4 [label="MLP Gate L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 4" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_up_4 [label="MLP Up L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 4" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_down_4 [label="MLP Down L0
Input: [batch=128, seq=6250, mlp_hidden=32768]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 4" fillcolor=lightpink shape=rectangle style=filled]
		add_1_4 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 4" fillcolor=lightgray shape=rectangle style=filled]
		ln1_pre_4 [label="LayerNorm L1
GPU: 4" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_1_4 [label="Q Proj L1
GPU: 4" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_1_4 [label="K Proj L1
GPU: 4" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_1_4 [label="V Proj L1
GPU: 4" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_1_4 [label="Ring Attention L1
GPU: 4
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_1_4_0 [label="Send K,V L1
Stage 0
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_4_0 [label="Recv K,V L1
Stage 0
From: 4
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_4_1 [label="Send K,V L1
Stage 1
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_4_1 [label="Recv K,V L1
Stage 1
From: 3
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_4_2 [label="Send K,V L1
Stage 2
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_4_2 [label="Recv K,V L1
Stage 2
From: 2
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_4_3 [label="Send K,V L1
Stage 3
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_4_3 [label="Recv K,V L1
Stage 3
From: 1
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_4_4 [label="Send K,V L1
Stage 4
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_4_4 [label="Recv K,V L1
Stage 4
From: 0
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_4_5 [label="Send K,V L1
Stage 5
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_4_5 [label="Recv K,V L1
Stage 5
From: 15
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_4_6 [label="Send K,V L1
Stage 6
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_4_6 [label="Recv K,V L1
Stage 6
From: 14
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_4_7 [label="Send K,V L1
Stage 7
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_4_7 [label="Recv K,V L1
Stage 7
From: 13
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_4_8 [label="Send K,V L1
Stage 8
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_4_8 [label="Recv K,V L1
Stage 8
From: 12
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_4_9 [label="Send K,V L1
Stage 9
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_4_9 [label="Recv K,V L1
Stage 9
From: 11
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_4_10 [label="Send K,V L1
Stage 10
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_4_10 [label="Recv K,V L1
Stage 10
From: 10
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_4_11 [label="Send K,V L1
Stage 11
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_4_11 [label="Recv K,V L1
Stage 11
From: 9
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_4_12 [label="Send K,V L1
Stage 12
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_4_12 [label="Recv K,V L1
Stage 12
From: 8
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_4_13 [label="Send K,V L1
Stage 13
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_4_13 [label="Recv K,V L1
Stage 13
From: 7
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_4_14 [label="Send K,V L1
Stage 14
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_4_14 [label="Recv K,V L1
Stage 14
From: 6
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_4_15 [label="Send K,V L1
Stage 15
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_4_15 [label="Recv K,V L1
Stage 15
From: 5
To: 4" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_1_4 [label="O Proj L1
GPU: 4" fillcolor=lightblue shape=rectangle style=filled]
		add_2_4 [label="Residual Add L1
GPU: 4" fillcolor=lightgray shape=rectangle style=filled]
		mlp1_gate_4 [label="MLP Gate L1
GPU: 4" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_up_4 [label="MLP Up L1
GPU: 4" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_down_4 [label="MLP Down L1
GPU: 4" fillcolor=lightpink shape=rectangle style=filled]
		add_3_4 [label="Residual Add L1
GPU: 4" fillcolor=lightgray shape=rectangle style=filled]
		ln2_pre_4 [label="LayerNorm L2
GPU: 4" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_2_4 [label="Ring Attention L2
GPU: 4
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_2_4 [label="O Proj L2
GPU: 4" fillcolor=lightblue shape=rectangle style=filled]
		add_4_4 [label="Residual Add L2
GPU: 4" fillcolor=lightgray shape=rectangle style=filled]
		mlp2_down_4 [label="MLP Down L2
GPU: 4" fillcolor=lightpink shape=rectangle style=filled]
		add_5_4 [label="Residual Add L2
GPU: 4" fillcolor=lightgray shape=rectangle style=filled]
		ln3_pre_4 [label="LayerNorm L3
GPU: 4" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_3_4 [label="Ring Attention L3
GPU: 4
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_3_4 [label="O Proj L3
GPU: 4" fillcolor=lightblue shape=rectangle style=filled]
		add_6_4 [label="Residual Add L3
GPU: 4" fillcolor=lightgray shape=rectangle style=filled]
		mlp3_down_4 [label="MLP Down L3
GPU: 4" fillcolor=lightpink shape=rectangle style=filled]
		add_7_4 [label="Residual Add L3
GPU: 4" fillcolor=lightgray shape=rectangle style=filled]
		output_gather_4 [label="Gather Output
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=100000, d_model=4096]
GPU: 4→All" fillcolor=lightsteelblue shape=parallelogram style=filled]
	}
	subgraph cluster_device_5 {
		color=color5 fillcolor=lightcolor5 label="Device 5
Sequence: [31250, 37499]
Local tokens: 6250" style=rounded
		input_split_5 [label="Sequence Split
Input: [batch=128, seq=100000, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 5" fillcolor=lightyellow shape=parallelogram style=filled]
		embed_5 [label="Embedding
Input: [batch=128, seq=6250]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 5" fillcolor=lightgreen shape=rectangle style=filled]
		ln0_pre_5 [label="LayerNorm L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 5" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_0_5 [label="Q Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 5" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_0_5 [label="K Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 5" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_0_5 [label="V Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 5" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_0_5 [label="Ring Attention L0
Local Q: [batch=128, seq=6250, heads=32, d_k=128]
Ring K,V: [batch=128, seq=100000, heads=32, d_k=128]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 5
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_0_5_0 [label="Send K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_5_0 [label="Recv K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_5_1 [label="Send K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_5_1 [label="Recv K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_5_2 [label="Send K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_5_2 [label="Recv K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_5_3 [label="Send K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_5_3 [label="Recv K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_5_4 [label="Send K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_5_4 [label="Recv K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_5_5 [label="Send K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_5_5 [label="Recv K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_5_6 [label="Send K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_5_6 [label="Recv K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_5_7 [label="Send K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_5_7 [label="Recv K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_5_8 [label="Send K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_5_8 [label="Recv K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_5_9 [label="Send K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_5_9 [label="Recv K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_5_10 [label="Send K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_5_10 [label="Recv K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_5_11 [label="Send K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_5_11 [label="Recv K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_5_12 [label="Send K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_5_12 [label="Recv K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_5_13 [label="Send K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_5_13 [label="Recv K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_5_14 [label="Send K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_5_14 [label="Recv K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_5_15 [label="Send K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_5_15 [label="Recv K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_0_5 [label="O Projection L0
Input: [batch=128, seq=6250, heads=32, d_k=128]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 5" fillcolor=lightblue shape=rectangle style=filled]
		add_0_5 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 5" fillcolor=lightgray shape=rectangle style=filled]
		mlp0_gate_5 [label="MLP Gate L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 5" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_up_5 [label="MLP Up L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 5" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_down_5 [label="MLP Down L0
Input: [batch=128, seq=6250, mlp_hidden=32768]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 5" fillcolor=lightpink shape=rectangle style=filled]
		add_1_5 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 5" fillcolor=lightgray shape=rectangle style=filled]
		ln1_pre_5 [label="LayerNorm L1
GPU: 5" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_1_5 [label="Q Proj L1
GPU: 5" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_1_5 [label="K Proj L1
GPU: 5" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_1_5 [label="V Proj L1
GPU: 5" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_1_5 [label="Ring Attention L1
GPU: 5
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_1_5_0 [label="Send K,V L1
Stage 0
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_5_0 [label="Recv K,V L1
Stage 0
From: 5
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_5_1 [label="Send K,V L1
Stage 1
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_5_1 [label="Recv K,V L1
Stage 1
From: 4
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_5_2 [label="Send K,V L1
Stage 2
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_5_2 [label="Recv K,V L1
Stage 2
From: 3
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_5_3 [label="Send K,V L1
Stage 3
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_5_3 [label="Recv K,V L1
Stage 3
From: 2
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_5_4 [label="Send K,V L1
Stage 4
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_5_4 [label="Recv K,V L1
Stage 4
From: 1
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_5_5 [label="Send K,V L1
Stage 5
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_5_5 [label="Recv K,V L1
Stage 5
From: 0
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_5_6 [label="Send K,V L1
Stage 6
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_5_6 [label="Recv K,V L1
Stage 6
From: 15
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_5_7 [label="Send K,V L1
Stage 7
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_5_7 [label="Recv K,V L1
Stage 7
From: 14
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_5_8 [label="Send K,V L1
Stage 8
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_5_8 [label="Recv K,V L1
Stage 8
From: 13
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_5_9 [label="Send K,V L1
Stage 9
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_5_9 [label="Recv K,V L1
Stage 9
From: 12
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_5_10 [label="Send K,V L1
Stage 10
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_5_10 [label="Recv K,V L1
Stage 10
From: 11
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_5_11 [label="Send K,V L1
Stage 11
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_5_11 [label="Recv K,V L1
Stage 11
From: 10
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_5_12 [label="Send K,V L1
Stage 12
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_5_12 [label="Recv K,V L1
Stage 12
From: 9
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_5_13 [label="Send K,V L1
Stage 13
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_5_13 [label="Recv K,V L1
Stage 13
From: 8
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_5_14 [label="Send K,V L1
Stage 14
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_5_14 [label="Recv K,V L1
Stage 14
From: 7
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_5_15 [label="Send K,V L1
Stage 15
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_5_15 [label="Recv K,V L1
Stage 15
From: 6
To: 5" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_1_5 [label="O Proj L1
GPU: 5" fillcolor=lightblue shape=rectangle style=filled]
		add_2_5 [label="Residual Add L1
GPU: 5" fillcolor=lightgray shape=rectangle style=filled]
		mlp1_gate_5 [label="MLP Gate L1
GPU: 5" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_up_5 [label="MLP Up L1
GPU: 5" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_down_5 [label="MLP Down L1
GPU: 5" fillcolor=lightpink shape=rectangle style=filled]
		add_3_5 [label="Residual Add L1
GPU: 5" fillcolor=lightgray shape=rectangle style=filled]
		ln2_pre_5 [label="LayerNorm L2
GPU: 5" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_2_5 [label="Ring Attention L2
GPU: 5
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_2_5 [label="O Proj L2
GPU: 5" fillcolor=lightblue shape=rectangle style=filled]
		add_4_5 [label="Residual Add L2
GPU: 5" fillcolor=lightgray shape=rectangle style=filled]
		mlp2_down_5 [label="MLP Down L2
GPU: 5" fillcolor=lightpink shape=rectangle style=filled]
		add_5_5 [label="Residual Add L2
GPU: 5" fillcolor=lightgray shape=rectangle style=filled]
		ln3_pre_5 [label="LayerNorm L3
GPU: 5" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_3_5 [label="Ring Attention L3
GPU: 5
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_3_5 [label="O Proj L3
GPU: 5" fillcolor=lightblue shape=rectangle style=filled]
		add_6_5 [label="Residual Add L3
GPU: 5" fillcolor=lightgray shape=rectangle style=filled]
		mlp3_down_5 [label="MLP Down L3
GPU: 5" fillcolor=lightpink shape=rectangle style=filled]
		add_7_5 [label="Residual Add L3
GPU: 5" fillcolor=lightgray shape=rectangle style=filled]
		output_gather_5 [label="Gather Output
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=100000, d_model=4096]
GPU: 5→All" fillcolor=lightsteelblue shape=parallelogram style=filled]
	}
	subgraph cluster_device_6 {
		color=color6 fillcolor=lightcolor6 label="Device 6
Sequence: [37500, 43749]
Local tokens: 6250" style=rounded
		input_split_6 [label="Sequence Split
Input: [batch=128, seq=100000, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 6" fillcolor=lightyellow shape=parallelogram style=filled]
		embed_6 [label="Embedding
Input: [batch=128, seq=6250]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 6" fillcolor=lightgreen shape=rectangle style=filled]
		ln0_pre_6 [label="LayerNorm L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 6" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_0_6 [label="Q Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 6" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_0_6 [label="K Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 6" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_0_6 [label="V Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 6" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_0_6 [label="Ring Attention L0
Local Q: [batch=128, seq=6250, heads=32, d_k=128]
Ring K,V: [batch=128, seq=100000, heads=32, d_k=128]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 6
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_0_6_0 [label="Send K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_6_0 [label="Recv K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_6_1 [label="Send K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_6_1 [label="Recv K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_6_2 [label="Send K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_6_2 [label="Recv K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_6_3 [label="Send K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_6_3 [label="Recv K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_6_4 [label="Send K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_6_4 [label="Recv K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_6_5 [label="Send K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_6_5 [label="Recv K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_6_6 [label="Send K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_6_6 [label="Recv K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_6_7 [label="Send K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_6_7 [label="Recv K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_6_8 [label="Send K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_6_8 [label="Recv K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_6_9 [label="Send K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_6_9 [label="Recv K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_6_10 [label="Send K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_6_10 [label="Recv K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_6_11 [label="Send K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_6_11 [label="Recv K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_6_12 [label="Send K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_6_12 [label="Recv K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_6_13 [label="Send K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_6_13 [label="Recv K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_6_14 [label="Send K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_6_14 [label="Recv K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_6_15 [label="Send K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_6_15 [label="Recv K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_0_6 [label="O Projection L0
Input: [batch=128, seq=6250, heads=32, d_k=128]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 6" fillcolor=lightblue shape=rectangle style=filled]
		add_0_6 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 6" fillcolor=lightgray shape=rectangle style=filled]
		mlp0_gate_6 [label="MLP Gate L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 6" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_up_6 [label="MLP Up L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 6" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_down_6 [label="MLP Down L0
Input: [batch=128, seq=6250, mlp_hidden=32768]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 6" fillcolor=lightpink shape=rectangle style=filled]
		add_1_6 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 6" fillcolor=lightgray shape=rectangle style=filled]
		ln1_pre_6 [label="LayerNorm L1
GPU: 6" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_1_6 [label="Q Proj L1
GPU: 6" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_1_6 [label="K Proj L1
GPU: 6" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_1_6 [label="V Proj L1
GPU: 6" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_1_6 [label="Ring Attention L1
GPU: 6
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_1_6_0 [label="Send K,V L1
Stage 0
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_6_0 [label="Recv K,V L1
Stage 0
From: 6
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_6_1 [label="Send K,V L1
Stage 1
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_6_1 [label="Recv K,V L1
Stage 1
From: 5
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_6_2 [label="Send K,V L1
Stage 2
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_6_2 [label="Recv K,V L1
Stage 2
From: 4
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_6_3 [label="Send K,V L1
Stage 3
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_6_3 [label="Recv K,V L1
Stage 3
From: 3
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_6_4 [label="Send K,V L1
Stage 4
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_6_4 [label="Recv K,V L1
Stage 4
From: 2
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_6_5 [label="Send K,V L1
Stage 5
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_6_5 [label="Recv K,V L1
Stage 5
From: 1
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_6_6 [label="Send K,V L1
Stage 6
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_6_6 [label="Recv K,V L1
Stage 6
From: 0
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_6_7 [label="Send K,V L1
Stage 7
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_6_7 [label="Recv K,V L1
Stage 7
From: 15
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_6_8 [label="Send K,V L1
Stage 8
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_6_8 [label="Recv K,V L1
Stage 8
From: 14
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_6_9 [label="Send K,V L1
Stage 9
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_6_9 [label="Recv K,V L1
Stage 9
From: 13
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_6_10 [label="Send K,V L1
Stage 10
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_6_10 [label="Recv K,V L1
Stage 10
From: 12
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_6_11 [label="Send K,V L1
Stage 11
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_6_11 [label="Recv K,V L1
Stage 11
From: 11
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_6_12 [label="Send K,V L1
Stage 12
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_6_12 [label="Recv K,V L1
Stage 12
From: 10
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_6_13 [label="Send K,V L1
Stage 13
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_6_13 [label="Recv K,V L1
Stage 13
From: 9
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_6_14 [label="Send K,V L1
Stage 14
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_6_14 [label="Recv K,V L1
Stage 14
From: 8
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_6_15 [label="Send K,V L1
Stage 15
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_6_15 [label="Recv K,V L1
Stage 15
From: 7
To: 6" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_1_6 [label="O Proj L1
GPU: 6" fillcolor=lightblue shape=rectangle style=filled]
		add_2_6 [label="Residual Add L1
GPU: 6" fillcolor=lightgray shape=rectangle style=filled]
		mlp1_gate_6 [label="MLP Gate L1
GPU: 6" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_up_6 [label="MLP Up L1
GPU: 6" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_down_6 [label="MLP Down L1
GPU: 6" fillcolor=lightpink shape=rectangle style=filled]
		add_3_6 [label="Residual Add L1
GPU: 6" fillcolor=lightgray shape=rectangle style=filled]
		ln2_pre_6 [label="LayerNorm L2
GPU: 6" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_2_6 [label="Ring Attention L2
GPU: 6
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_2_6 [label="O Proj L2
GPU: 6" fillcolor=lightblue shape=rectangle style=filled]
		add_4_6 [label="Residual Add L2
GPU: 6" fillcolor=lightgray shape=rectangle style=filled]
		mlp2_down_6 [label="MLP Down L2
GPU: 6" fillcolor=lightpink shape=rectangle style=filled]
		add_5_6 [label="Residual Add L2
GPU: 6" fillcolor=lightgray shape=rectangle style=filled]
		ln3_pre_6 [label="LayerNorm L3
GPU: 6" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_3_6 [label="Ring Attention L3
GPU: 6
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_3_6 [label="O Proj L3
GPU: 6" fillcolor=lightblue shape=rectangle style=filled]
		add_6_6 [label="Residual Add L3
GPU: 6" fillcolor=lightgray shape=rectangle style=filled]
		mlp3_down_6 [label="MLP Down L3
GPU: 6" fillcolor=lightpink shape=rectangle style=filled]
		add_7_6 [label="Residual Add L3
GPU: 6" fillcolor=lightgray shape=rectangle style=filled]
		output_gather_6 [label="Gather Output
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=100000, d_model=4096]
GPU: 6→All" fillcolor=lightsteelblue shape=parallelogram style=filled]
	}
	subgraph cluster_device_7 {
		color=color7 fillcolor=lightcolor7 label="Device 7
Sequence: [43750, 49999]
Local tokens: 6250" style=rounded
		input_split_7 [label="Sequence Split
Input: [batch=128, seq=100000, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 7" fillcolor=lightyellow shape=parallelogram style=filled]
		embed_7 [label="Embedding
Input: [batch=128, seq=6250]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 7" fillcolor=lightgreen shape=rectangle style=filled]
		ln0_pre_7 [label="LayerNorm L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 7" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_0_7 [label="Q Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 7" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_0_7 [label="K Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 7" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_0_7 [label="V Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 7" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_0_7 [label="Ring Attention L0
Local Q: [batch=128, seq=6250, heads=32, d_k=128]
Ring K,V: [batch=128, seq=100000, heads=32, d_k=128]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 7
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_0_7_0 [label="Send K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_7_0 [label="Recv K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_7_1 [label="Send K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_7_1 [label="Recv K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_7_2 [label="Send K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_7_2 [label="Recv K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_7_3 [label="Send K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_7_3 [label="Recv K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_7_4 [label="Send K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_7_4 [label="Recv K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_7_5 [label="Send K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_7_5 [label="Recv K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_7_6 [label="Send K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_7_6 [label="Recv K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_7_7 [label="Send K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_7_7 [label="Recv K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_7_8 [label="Send K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_7_8 [label="Recv K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_7_9 [label="Send K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_7_9 [label="Recv K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_7_10 [label="Send K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_7_10 [label="Recv K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_7_11 [label="Send K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_7_11 [label="Recv K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_7_12 [label="Send K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_7_12 [label="Recv K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_7_13 [label="Send K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_7_13 [label="Recv K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_7_14 [label="Send K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_7_14 [label="Recv K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_7_15 [label="Send K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_7_15 [label="Recv K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_0_7 [label="O Projection L0
Input: [batch=128, seq=6250, heads=32, d_k=128]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 7" fillcolor=lightblue shape=rectangle style=filled]
		add_0_7 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 7" fillcolor=lightgray shape=rectangle style=filled]
		mlp0_gate_7 [label="MLP Gate L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 7" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_up_7 [label="MLP Up L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 7" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_down_7 [label="MLP Down L0
Input: [batch=128, seq=6250, mlp_hidden=32768]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 7" fillcolor=lightpink shape=rectangle style=filled]
		add_1_7 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 7" fillcolor=lightgray shape=rectangle style=filled]
		ln1_pre_7 [label="LayerNorm L1
GPU: 7" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_1_7 [label="Q Proj L1
GPU: 7" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_1_7 [label="K Proj L1
GPU: 7" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_1_7 [label="V Proj L1
GPU: 7" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_1_7 [label="Ring Attention L1
GPU: 7
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_1_7_0 [label="Send K,V L1
Stage 0
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_7_0 [label="Recv K,V L1
Stage 0
From: 7
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_7_1 [label="Send K,V L1
Stage 1
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_7_1 [label="Recv K,V L1
Stage 1
From: 6
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_7_2 [label="Send K,V L1
Stage 2
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_7_2 [label="Recv K,V L1
Stage 2
From: 5
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_7_3 [label="Send K,V L1
Stage 3
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_7_3 [label="Recv K,V L1
Stage 3
From: 4
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_7_4 [label="Send K,V L1
Stage 4
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_7_4 [label="Recv K,V L1
Stage 4
From: 3
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_7_5 [label="Send K,V L1
Stage 5
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_7_5 [label="Recv K,V L1
Stage 5
From: 2
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_7_6 [label="Send K,V L1
Stage 6
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_7_6 [label="Recv K,V L1
Stage 6
From: 1
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_7_7 [label="Send K,V L1
Stage 7
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_7_7 [label="Recv K,V L1
Stage 7
From: 0
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_7_8 [label="Send K,V L1
Stage 8
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_7_8 [label="Recv K,V L1
Stage 8
From: 15
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_7_9 [label="Send K,V L1
Stage 9
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_7_9 [label="Recv K,V L1
Stage 9
From: 14
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_7_10 [label="Send K,V L1
Stage 10
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_7_10 [label="Recv K,V L1
Stage 10
From: 13
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_7_11 [label="Send K,V L1
Stage 11
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_7_11 [label="Recv K,V L1
Stage 11
From: 12
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_7_12 [label="Send K,V L1
Stage 12
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_7_12 [label="Recv K,V L1
Stage 12
From: 11
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_7_13 [label="Send K,V L1
Stage 13
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_7_13 [label="Recv K,V L1
Stage 13
From: 10
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_7_14 [label="Send K,V L1
Stage 14
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_7_14 [label="Recv K,V L1
Stage 14
From: 9
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_7_15 [label="Send K,V L1
Stage 15
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_7_15 [label="Recv K,V L1
Stage 15
From: 8
To: 7" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_1_7 [label="O Proj L1
GPU: 7" fillcolor=lightblue shape=rectangle style=filled]
		add_2_7 [label="Residual Add L1
GPU: 7" fillcolor=lightgray shape=rectangle style=filled]
		mlp1_gate_7 [label="MLP Gate L1
GPU: 7" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_up_7 [label="MLP Up L1
GPU: 7" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_down_7 [label="MLP Down L1
GPU: 7" fillcolor=lightpink shape=rectangle style=filled]
		add_3_7 [label="Residual Add L1
GPU: 7" fillcolor=lightgray shape=rectangle style=filled]
		ln2_pre_7 [label="LayerNorm L2
GPU: 7" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_2_7 [label="Ring Attention L2
GPU: 7
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_2_7 [label="O Proj L2
GPU: 7" fillcolor=lightblue shape=rectangle style=filled]
		add_4_7 [label="Residual Add L2
GPU: 7" fillcolor=lightgray shape=rectangle style=filled]
		mlp2_down_7 [label="MLP Down L2
GPU: 7" fillcolor=lightpink shape=rectangle style=filled]
		add_5_7 [label="Residual Add L2
GPU: 7" fillcolor=lightgray shape=rectangle style=filled]
		ln3_pre_7 [label="LayerNorm L3
GPU: 7" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_3_7 [label="Ring Attention L3
GPU: 7
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_3_7 [label="O Proj L3
GPU: 7" fillcolor=lightblue shape=rectangle style=filled]
		add_6_7 [label="Residual Add L3
GPU: 7" fillcolor=lightgray shape=rectangle style=filled]
		mlp3_down_7 [label="MLP Down L3
GPU: 7" fillcolor=lightpink shape=rectangle style=filled]
		add_7_7 [label="Residual Add L3
GPU: 7" fillcolor=lightgray shape=rectangle style=filled]
		output_gather_7 [label="Gather Output
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=100000, d_model=4096]
GPU: 7→All" fillcolor=lightsteelblue shape=parallelogram style=filled]
	}
	subgraph cluster_device_8 {
		color=color0 fillcolor=lightcolor0 label="Device 8
Sequence: [50000, 56249]
Local tokens: 6250" style=rounded
		input_split_8 [label="Sequence Split
Input: [batch=128, seq=100000, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 8" fillcolor=lightyellow shape=parallelogram style=filled]
		embed_8 [label="Embedding
Input: [batch=128, seq=6250]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 8" fillcolor=lightgreen shape=rectangle style=filled]
		ln0_pre_8 [label="LayerNorm L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 8" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_0_8 [label="Q Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 8" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_0_8 [label="K Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 8" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_0_8 [label="V Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 8" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_0_8 [label="Ring Attention L0
Local Q: [batch=128, seq=6250, heads=32, d_k=128]
Ring K,V: [batch=128, seq=100000, heads=32, d_k=128]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 8
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_0_8_0 [label="Send K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_8_0 [label="Recv K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_8_1 [label="Send K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_8_1 [label="Recv K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_8_2 [label="Send K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_8_2 [label="Recv K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_8_3 [label="Send K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_8_3 [label="Recv K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_8_4 [label="Send K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_8_4 [label="Recv K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_8_5 [label="Send K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_8_5 [label="Recv K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_8_6 [label="Send K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_8_6 [label="Recv K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_8_7 [label="Send K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_8_7 [label="Recv K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_8_8 [label="Send K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_8_8 [label="Recv K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_8_9 [label="Send K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_8_9 [label="Recv K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_8_10 [label="Send K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_8_10 [label="Recv K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_8_11 [label="Send K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_8_11 [label="Recv K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_8_12 [label="Send K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_8_12 [label="Recv K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_8_13 [label="Send K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_8_13 [label="Recv K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_8_14 [label="Send K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_8_14 [label="Recv K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_8_15 [label="Send K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_8_15 [label="Recv K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_0_8 [label="O Projection L0
Input: [batch=128, seq=6250, heads=32, d_k=128]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 8" fillcolor=lightblue shape=rectangle style=filled]
		add_0_8 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 8" fillcolor=lightgray shape=rectangle style=filled]
		mlp0_gate_8 [label="MLP Gate L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 8" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_up_8 [label="MLP Up L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 8" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_down_8 [label="MLP Down L0
Input: [batch=128, seq=6250, mlp_hidden=32768]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 8" fillcolor=lightpink shape=rectangle style=filled]
		add_1_8 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 8" fillcolor=lightgray shape=rectangle style=filled]
		ln1_pre_8 [label="LayerNorm L1
GPU: 8" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_1_8 [label="Q Proj L1
GPU: 8" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_1_8 [label="K Proj L1
GPU: 8" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_1_8 [label="V Proj L1
GPU: 8" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_1_8 [label="Ring Attention L1
GPU: 8
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_1_8_0 [label="Send K,V L1
Stage 0
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_8_0 [label="Recv K,V L1
Stage 0
From: 8
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_8_1 [label="Send K,V L1
Stage 1
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_8_1 [label="Recv K,V L1
Stage 1
From: 7
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_8_2 [label="Send K,V L1
Stage 2
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_8_2 [label="Recv K,V L1
Stage 2
From: 6
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_8_3 [label="Send K,V L1
Stage 3
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_8_3 [label="Recv K,V L1
Stage 3
From: 5
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_8_4 [label="Send K,V L1
Stage 4
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_8_4 [label="Recv K,V L1
Stage 4
From: 4
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_8_5 [label="Send K,V L1
Stage 5
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_8_5 [label="Recv K,V L1
Stage 5
From: 3
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_8_6 [label="Send K,V L1
Stage 6
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_8_6 [label="Recv K,V L1
Stage 6
From: 2
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_8_7 [label="Send K,V L1
Stage 7
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_8_7 [label="Recv K,V L1
Stage 7
From: 1
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_8_8 [label="Send K,V L1
Stage 8
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_8_8 [label="Recv K,V L1
Stage 8
From: 0
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_8_9 [label="Send K,V L1
Stage 9
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_8_9 [label="Recv K,V L1
Stage 9
From: 15
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_8_10 [label="Send K,V L1
Stage 10
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_8_10 [label="Recv K,V L1
Stage 10
From: 14
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_8_11 [label="Send K,V L1
Stage 11
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_8_11 [label="Recv K,V L1
Stage 11
From: 13
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_8_12 [label="Send K,V L1
Stage 12
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_8_12 [label="Recv K,V L1
Stage 12
From: 12
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_8_13 [label="Send K,V L1
Stage 13
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_8_13 [label="Recv K,V L1
Stage 13
From: 11
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_8_14 [label="Send K,V L1
Stage 14
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_8_14 [label="Recv K,V L1
Stage 14
From: 10
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_8_15 [label="Send K,V L1
Stage 15
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_8_15 [label="Recv K,V L1
Stage 15
From: 9
To: 8" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_1_8 [label="O Proj L1
GPU: 8" fillcolor=lightblue shape=rectangle style=filled]
		add_2_8 [label="Residual Add L1
GPU: 8" fillcolor=lightgray shape=rectangle style=filled]
		mlp1_gate_8 [label="MLP Gate L1
GPU: 8" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_up_8 [label="MLP Up L1
GPU: 8" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_down_8 [label="MLP Down L1
GPU: 8" fillcolor=lightpink shape=rectangle style=filled]
		add_3_8 [label="Residual Add L1
GPU: 8" fillcolor=lightgray shape=rectangle style=filled]
		ln2_pre_8 [label="LayerNorm L2
GPU: 8" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_2_8 [label="Ring Attention L2
GPU: 8
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_2_8 [label="O Proj L2
GPU: 8" fillcolor=lightblue shape=rectangle style=filled]
		add_4_8 [label="Residual Add L2
GPU: 8" fillcolor=lightgray shape=rectangle style=filled]
		mlp2_down_8 [label="MLP Down L2
GPU: 8" fillcolor=lightpink shape=rectangle style=filled]
		add_5_8 [label="Residual Add L2
GPU: 8" fillcolor=lightgray shape=rectangle style=filled]
		ln3_pre_8 [label="LayerNorm L3
GPU: 8" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_3_8 [label="Ring Attention L3
GPU: 8
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_3_8 [label="O Proj L3
GPU: 8" fillcolor=lightblue shape=rectangle style=filled]
		add_6_8 [label="Residual Add L3
GPU: 8" fillcolor=lightgray shape=rectangle style=filled]
		mlp3_down_8 [label="MLP Down L3
GPU: 8" fillcolor=lightpink shape=rectangle style=filled]
		add_7_8 [label="Residual Add L3
GPU: 8" fillcolor=lightgray shape=rectangle style=filled]
		output_gather_8 [label="Gather Output
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=100000, d_model=4096]
GPU: 8→All" fillcolor=lightsteelblue shape=parallelogram style=filled]
	}
	subgraph cluster_device_9 {
		color=color1 fillcolor=lightcolor1 label="Device 9
Sequence: [56250, 62499]
Local tokens: 6250" style=rounded
		input_split_9 [label="Sequence Split
Input: [batch=128, seq=100000, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 9" fillcolor=lightyellow shape=parallelogram style=filled]
		embed_9 [label="Embedding
Input: [batch=128, seq=6250]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 9" fillcolor=lightgreen shape=rectangle style=filled]
		ln0_pre_9 [label="LayerNorm L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 9" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_0_9 [label="Q Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 9" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_0_9 [label="K Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 9" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_0_9 [label="V Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 9" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_0_9 [label="Ring Attention L0
Local Q: [batch=128, seq=6250, heads=32, d_k=128]
Ring K,V: [batch=128, seq=100000, heads=32, d_k=128]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 9
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_0_9_0 [label="Send K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_9_0 [label="Recv K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_9_1 [label="Send K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_9_1 [label="Recv K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_9_2 [label="Send K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_9_2 [label="Recv K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_9_3 [label="Send K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_9_3 [label="Recv K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_9_4 [label="Send K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_9_4 [label="Recv K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_9_5 [label="Send K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_9_5 [label="Recv K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_9_6 [label="Send K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_9_6 [label="Recv K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_9_7 [label="Send K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_9_7 [label="Recv K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_9_8 [label="Send K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_9_8 [label="Recv K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_9_9 [label="Send K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_9_9 [label="Recv K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_9_10 [label="Send K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_9_10 [label="Recv K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_9_11 [label="Send K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_9_11 [label="Recv K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_9_12 [label="Send K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_9_12 [label="Recv K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_9_13 [label="Send K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_9_13 [label="Recv K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_9_14 [label="Send K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_9_14 [label="Recv K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_9_15 [label="Send K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_9_15 [label="Recv K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_0_9 [label="O Projection L0
Input: [batch=128, seq=6250, heads=32, d_k=128]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 9" fillcolor=lightblue shape=rectangle style=filled]
		add_0_9 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 9" fillcolor=lightgray shape=rectangle style=filled]
		mlp0_gate_9 [label="MLP Gate L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 9" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_up_9 [label="MLP Up L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 9" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_down_9 [label="MLP Down L0
Input: [batch=128, seq=6250, mlp_hidden=32768]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 9" fillcolor=lightpink shape=rectangle style=filled]
		add_1_9 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 9" fillcolor=lightgray shape=rectangle style=filled]
		ln1_pre_9 [label="LayerNorm L1
GPU: 9" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_1_9 [label="Q Proj L1
GPU: 9" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_1_9 [label="K Proj L1
GPU: 9" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_1_9 [label="V Proj L1
GPU: 9" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_1_9 [label="Ring Attention L1
GPU: 9
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_1_9_0 [label="Send K,V L1
Stage 0
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_9_0 [label="Recv K,V L1
Stage 0
From: 9
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_9_1 [label="Send K,V L1
Stage 1
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_9_1 [label="Recv K,V L1
Stage 1
From: 8
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_9_2 [label="Send K,V L1
Stage 2
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_9_2 [label="Recv K,V L1
Stage 2
From: 7
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_9_3 [label="Send K,V L1
Stage 3
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_9_3 [label="Recv K,V L1
Stage 3
From: 6
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_9_4 [label="Send K,V L1
Stage 4
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_9_4 [label="Recv K,V L1
Stage 4
From: 5
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_9_5 [label="Send K,V L1
Stage 5
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_9_5 [label="Recv K,V L1
Stage 5
From: 4
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_9_6 [label="Send K,V L1
Stage 6
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_9_6 [label="Recv K,V L1
Stage 6
From: 3
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_9_7 [label="Send K,V L1
Stage 7
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_9_7 [label="Recv K,V L1
Stage 7
From: 2
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_9_8 [label="Send K,V L1
Stage 8
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_9_8 [label="Recv K,V L1
Stage 8
From: 1
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_9_9 [label="Send K,V L1
Stage 9
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_9_9 [label="Recv K,V L1
Stage 9
From: 0
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_9_10 [label="Send K,V L1
Stage 10
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_9_10 [label="Recv K,V L1
Stage 10
From: 15
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_9_11 [label="Send K,V L1
Stage 11
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_9_11 [label="Recv K,V L1
Stage 11
From: 14
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_9_12 [label="Send K,V L1
Stage 12
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_9_12 [label="Recv K,V L1
Stage 12
From: 13
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_9_13 [label="Send K,V L1
Stage 13
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_9_13 [label="Recv K,V L1
Stage 13
From: 12
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_9_14 [label="Send K,V L1
Stage 14
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_9_14 [label="Recv K,V L1
Stage 14
From: 11
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_9_15 [label="Send K,V L1
Stage 15
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_9_15 [label="Recv K,V L1
Stage 15
From: 10
To: 9" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_1_9 [label="O Proj L1
GPU: 9" fillcolor=lightblue shape=rectangle style=filled]
		add_2_9 [label="Residual Add L1
GPU: 9" fillcolor=lightgray shape=rectangle style=filled]
		mlp1_gate_9 [label="MLP Gate L1
GPU: 9" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_up_9 [label="MLP Up L1
GPU: 9" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_down_9 [label="MLP Down L1
GPU: 9" fillcolor=lightpink shape=rectangle style=filled]
		add_3_9 [label="Residual Add L1
GPU: 9" fillcolor=lightgray shape=rectangle style=filled]
		ln2_pre_9 [label="LayerNorm L2
GPU: 9" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_2_9 [label="Ring Attention L2
GPU: 9
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_2_9 [label="O Proj L2
GPU: 9" fillcolor=lightblue shape=rectangle style=filled]
		add_4_9 [label="Residual Add L2
GPU: 9" fillcolor=lightgray shape=rectangle style=filled]
		mlp2_down_9 [label="MLP Down L2
GPU: 9" fillcolor=lightpink shape=rectangle style=filled]
		add_5_9 [label="Residual Add L2
GPU: 9" fillcolor=lightgray shape=rectangle style=filled]
		ln3_pre_9 [label="LayerNorm L3
GPU: 9" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_3_9 [label="Ring Attention L3
GPU: 9
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_3_9 [label="O Proj L3
GPU: 9" fillcolor=lightblue shape=rectangle style=filled]
		add_6_9 [label="Residual Add L3
GPU: 9" fillcolor=lightgray shape=rectangle style=filled]
		mlp3_down_9 [label="MLP Down L3
GPU: 9" fillcolor=lightpink shape=rectangle style=filled]
		add_7_9 [label="Residual Add L3
GPU: 9" fillcolor=lightgray shape=rectangle style=filled]
		output_gather_9 [label="Gather Output
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=100000, d_model=4096]
GPU: 9→All" fillcolor=lightsteelblue shape=parallelogram style=filled]
	}
	subgraph cluster_device_10 {
		color=color2 fillcolor=lightcolor2 label="Device 10
Sequence: [62500, 68749]
Local tokens: 6250" style=rounded
		input_split_10 [label="Sequence Split
Input: [batch=128, seq=100000, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 10" fillcolor=lightyellow shape=parallelogram style=filled]
		embed_10 [label="Embedding
Input: [batch=128, seq=6250]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 10" fillcolor=lightgreen shape=rectangle style=filled]
		ln0_pre_10 [label="LayerNorm L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 10" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_0_10 [label="Q Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 10" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_0_10 [label="K Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 10" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_0_10 [label="V Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 10" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_0_10 [label="Ring Attention L0
Local Q: [batch=128, seq=6250, heads=32, d_k=128]
Ring K,V: [batch=128, seq=100000, heads=32, d_k=128]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 10
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_0_10_0 [label="Send K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_10_0 [label="Recv K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_10_1 [label="Send K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_10_1 [label="Recv K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_10_2 [label="Send K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_10_2 [label="Recv K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_10_3 [label="Send K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_10_3 [label="Recv K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_10_4 [label="Send K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_10_4 [label="Recv K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_10_5 [label="Send K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_10_5 [label="Recv K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_10_6 [label="Send K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_10_6 [label="Recv K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_10_7 [label="Send K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_10_7 [label="Recv K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_10_8 [label="Send K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_10_8 [label="Recv K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_10_9 [label="Send K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_10_9 [label="Recv K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_10_10 [label="Send K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_10_10 [label="Recv K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_10_11 [label="Send K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_10_11 [label="Recv K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_10_12 [label="Send K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_10_12 [label="Recv K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_10_13 [label="Send K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_10_13 [label="Recv K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_10_14 [label="Send K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_10_14 [label="Recv K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_10_15 [label="Send K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_10_15 [label="Recv K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_0_10 [label="O Projection L0
Input: [batch=128, seq=6250, heads=32, d_k=128]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 10" fillcolor=lightblue shape=rectangle style=filled]
		add_0_10 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 10" fillcolor=lightgray shape=rectangle style=filled]
		mlp0_gate_10 [label="MLP Gate L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 10" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_up_10 [label="MLP Up L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 10" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_down_10 [label="MLP Down L0
Input: [batch=128, seq=6250, mlp_hidden=32768]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 10" fillcolor=lightpink shape=rectangle style=filled]
		add_1_10 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 10" fillcolor=lightgray shape=rectangle style=filled]
		ln1_pre_10 [label="LayerNorm L1
GPU: 10" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_1_10 [label="Q Proj L1
GPU: 10" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_1_10 [label="K Proj L1
GPU: 10" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_1_10 [label="V Proj L1
GPU: 10" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_1_10 [label="Ring Attention L1
GPU: 10
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_1_10_0 [label="Send K,V L1
Stage 0
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_10_0 [label="Recv K,V L1
Stage 0
From: 10
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_10_1 [label="Send K,V L1
Stage 1
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_10_1 [label="Recv K,V L1
Stage 1
From: 9
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_10_2 [label="Send K,V L1
Stage 2
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_10_2 [label="Recv K,V L1
Stage 2
From: 8
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_10_3 [label="Send K,V L1
Stage 3
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_10_3 [label="Recv K,V L1
Stage 3
From: 7
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_10_4 [label="Send K,V L1
Stage 4
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_10_4 [label="Recv K,V L1
Stage 4
From: 6
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_10_5 [label="Send K,V L1
Stage 5
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_10_5 [label="Recv K,V L1
Stage 5
From: 5
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_10_6 [label="Send K,V L1
Stage 6
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_10_6 [label="Recv K,V L1
Stage 6
From: 4
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_10_7 [label="Send K,V L1
Stage 7
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_10_7 [label="Recv K,V L1
Stage 7
From: 3
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_10_8 [label="Send K,V L1
Stage 8
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_10_8 [label="Recv K,V L1
Stage 8
From: 2
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_10_9 [label="Send K,V L1
Stage 9
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_10_9 [label="Recv K,V L1
Stage 9
From: 1
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_10_10 [label="Send K,V L1
Stage 10
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_10_10 [label="Recv K,V L1
Stage 10
From: 0
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_10_11 [label="Send K,V L1
Stage 11
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_10_11 [label="Recv K,V L1
Stage 11
From: 15
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_10_12 [label="Send K,V L1
Stage 12
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_10_12 [label="Recv K,V L1
Stage 12
From: 14
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_10_13 [label="Send K,V L1
Stage 13
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_10_13 [label="Recv K,V L1
Stage 13
From: 13
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_10_14 [label="Send K,V L1
Stage 14
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_10_14 [label="Recv K,V L1
Stage 14
From: 12
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_10_15 [label="Send K,V L1
Stage 15
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_10_15 [label="Recv K,V L1
Stage 15
From: 11
To: 10" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_1_10 [label="O Proj L1
GPU: 10" fillcolor=lightblue shape=rectangle style=filled]
		add_2_10 [label="Residual Add L1
GPU: 10" fillcolor=lightgray shape=rectangle style=filled]
		mlp1_gate_10 [label="MLP Gate L1
GPU: 10" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_up_10 [label="MLP Up L1
GPU: 10" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_down_10 [label="MLP Down L1
GPU: 10" fillcolor=lightpink shape=rectangle style=filled]
		add_3_10 [label="Residual Add L1
GPU: 10" fillcolor=lightgray shape=rectangle style=filled]
		ln2_pre_10 [label="LayerNorm L2
GPU: 10" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_2_10 [label="Ring Attention L2
GPU: 10
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_2_10 [label="O Proj L2
GPU: 10" fillcolor=lightblue shape=rectangle style=filled]
		add_4_10 [label="Residual Add L2
GPU: 10" fillcolor=lightgray shape=rectangle style=filled]
		mlp2_down_10 [label="MLP Down L2
GPU: 10" fillcolor=lightpink shape=rectangle style=filled]
		add_5_10 [label="Residual Add L2
GPU: 10" fillcolor=lightgray shape=rectangle style=filled]
		ln3_pre_10 [label="LayerNorm L3
GPU: 10" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_3_10 [label="Ring Attention L3
GPU: 10
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_3_10 [label="O Proj L3
GPU: 10" fillcolor=lightblue shape=rectangle style=filled]
		add_6_10 [label="Residual Add L3
GPU: 10" fillcolor=lightgray shape=rectangle style=filled]
		mlp3_down_10 [label="MLP Down L3
GPU: 10" fillcolor=lightpink shape=rectangle style=filled]
		add_7_10 [label="Residual Add L3
GPU: 10" fillcolor=lightgray shape=rectangle style=filled]
		output_gather_10 [label="Gather Output
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=100000, d_model=4096]
GPU: 10→All" fillcolor=lightsteelblue shape=parallelogram style=filled]
	}
	subgraph cluster_device_11 {
		color=color3 fillcolor=lightcolor3 label="Device 11
Sequence: [68750, 74999]
Local tokens: 6250" style=rounded
		input_split_11 [label="Sequence Split
Input: [batch=128, seq=100000, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 11" fillcolor=lightyellow shape=parallelogram style=filled]
		embed_11 [label="Embedding
Input: [batch=128, seq=6250]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 11" fillcolor=lightgreen shape=rectangle style=filled]
		ln0_pre_11 [label="LayerNorm L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 11" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_0_11 [label="Q Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 11" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_0_11 [label="K Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 11" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_0_11 [label="V Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 11" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_0_11 [label="Ring Attention L0
Local Q: [batch=128, seq=6250, heads=32, d_k=128]
Ring K,V: [batch=128, seq=100000, heads=32, d_k=128]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 11
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_0_11_0 [label="Send K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_11_0 [label="Recv K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_11_1 [label="Send K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_11_1 [label="Recv K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_11_2 [label="Send K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_11_2 [label="Recv K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_11_3 [label="Send K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_11_3 [label="Recv K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_11_4 [label="Send K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_11_4 [label="Recv K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_11_5 [label="Send K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_11_5 [label="Recv K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_11_6 [label="Send K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_11_6 [label="Recv K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_11_7 [label="Send K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_11_7 [label="Recv K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_11_8 [label="Send K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_11_8 [label="Recv K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_11_9 [label="Send K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_11_9 [label="Recv K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_11_10 [label="Send K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_11_10 [label="Recv K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_11_11 [label="Send K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_11_11 [label="Recv K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_11_12 [label="Send K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_11_12 [label="Recv K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_11_13 [label="Send K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_11_13 [label="Recv K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_11_14 [label="Send K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_11_14 [label="Recv K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_11_15 [label="Send K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_11_15 [label="Recv K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_0_11 [label="O Projection L0
Input: [batch=128, seq=6250, heads=32, d_k=128]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 11" fillcolor=lightblue shape=rectangle style=filled]
		add_0_11 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 11" fillcolor=lightgray shape=rectangle style=filled]
		mlp0_gate_11 [label="MLP Gate L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 11" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_up_11 [label="MLP Up L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 11" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_down_11 [label="MLP Down L0
Input: [batch=128, seq=6250, mlp_hidden=32768]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 11" fillcolor=lightpink shape=rectangle style=filled]
		add_1_11 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 11" fillcolor=lightgray shape=rectangle style=filled]
		ln1_pre_11 [label="LayerNorm L1
GPU: 11" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_1_11 [label="Q Proj L1
GPU: 11" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_1_11 [label="K Proj L1
GPU: 11" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_1_11 [label="V Proj L1
GPU: 11" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_1_11 [label="Ring Attention L1
GPU: 11
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_1_11_0 [label="Send K,V L1
Stage 0
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_11_0 [label="Recv K,V L1
Stage 0
From: 11
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_11_1 [label="Send K,V L1
Stage 1
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_11_1 [label="Recv K,V L1
Stage 1
From: 10
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_11_2 [label="Send K,V L1
Stage 2
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_11_2 [label="Recv K,V L1
Stage 2
From: 9
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_11_3 [label="Send K,V L1
Stage 3
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_11_3 [label="Recv K,V L1
Stage 3
From: 8
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_11_4 [label="Send K,V L1
Stage 4
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_11_4 [label="Recv K,V L1
Stage 4
From: 7
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_11_5 [label="Send K,V L1
Stage 5
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_11_5 [label="Recv K,V L1
Stage 5
From: 6
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_11_6 [label="Send K,V L1
Stage 6
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_11_6 [label="Recv K,V L1
Stage 6
From: 5
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_11_7 [label="Send K,V L1
Stage 7
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_11_7 [label="Recv K,V L1
Stage 7
From: 4
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_11_8 [label="Send K,V L1
Stage 8
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_11_8 [label="Recv K,V L1
Stage 8
From: 3
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_11_9 [label="Send K,V L1
Stage 9
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_11_9 [label="Recv K,V L1
Stage 9
From: 2
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_11_10 [label="Send K,V L1
Stage 10
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_11_10 [label="Recv K,V L1
Stage 10
From: 1
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_11_11 [label="Send K,V L1
Stage 11
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_11_11 [label="Recv K,V L1
Stage 11
From: 0
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_11_12 [label="Send K,V L1
Stage 12
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_11_12 [label="Recv K,V L1
Stage 12
From: 15
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_11_13 [label="Send K,V L1
Stage 13
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_11_13 [label="Recv K,V L1
Stage 13
From: 14
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_11_14 [label="Send K,V L1
Stage 14
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_11_14 [label="Recv K,V L1
Stage 14
From: 13
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_11_15 [label="Send K,V L1
Stage 15
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_11_15 [label="Recv K,V L1
Stage 15
From: 12
To: 11" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_1_11 [label="O Proj L1
GPU: 11" fillcolor=lightblue shape=rectangle style=filled]
		add_2_11 [label="Residual Add L1
GPU: 11" fillcolor=lightgray shape=rectangle style=filled]
		mlp1_gate_11 [label="MLP Gate L1
GPU: 11" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_up_11 [label="MLP Up L1
GPU: 11" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_down_11 [label="MLP Down L1
GPU: 11" fillcolor=lightpink shape=rectangle style=filled]
		add_3_11 [label="Residual Add L1
GPU: 11" fillcolor=lightgray shape=rectangle style=filled]
		ln2_pre_11 [label="LayerNorm L2
GPU: 11" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_2_11 [label="Ring Attention L2
GPU: 11
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_2_11 [label="O Proj L2
GPU: 11" fillcolor=lightblue shape=rectangle style=filled]
		add_4_11 [label="Residual Add L2
GPU: 11" fillcolor=lightgray shape=rectangle style=filled]
		mlp2_down_11 [label="MLP Down L2
GPU: 11" fillcolor=lightpink shape=rectangle style=filled]
		add_5_11 [label="Residual Add L2
GPU: 11" fillcolor=lightgray shape=rectangle style=filled]
		ln3_pre_11 [label="LayerNorm L3
GPU: 11" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_3_11 [label="Ring Attention L3
GPU: 11
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_3_11 [label="O Proj L3
GPU: 11" fillcolor=lightblue shape=rectangle style=filled]
		add_6_11 [label="Residual Add L3
GPU: 11" fillcolor=lightgray shape=rectangle style=filled]
		mlp3_down_11 [label="MLP Down L3
GPU: 11" fillcolor=lightpink shape=rectangle style=filled]
		add_7_11 [label="Residual Add L3
GPU: 11" fillcolor=lightgray shape=rectangle style=filled]
		output_gather_11 [label="Gather Output
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=100000, d_model=4096]
GPU: 11→All" fillcolor=lightsteelblue shape=parallelogram style=filled]
	}
	subgraph cluster_device_12 {
		color=color4 fillcolor=lightcolor4 label="Device 12
Sequence: [75000, 81249]
Local tokens: 6250" style=rounded
		input_split_12 [label="Sequence Split
Input: [batch=128, seq=100000, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 12" fillcolor=lightyellow shape=parallelogram style=filled]
		embed_12 [label="Embedding
Input: [batch=128, seq=6250]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 12" fillcolor=lightgreen shape=rectangle style=filled]
		ln0_pre_12 [label="LayerNorm L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 12" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_0_12 [label="Q Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 12" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_0_12 [label="K Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 12" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_0_12 [label="V Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 12" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_0_12 [label="Ring Attention L0
Local Q: [batch=128, seq=6250, heads=32, d_k=128]
Ring K,V: [batch=128, seq=100000, heads=32, d_k=128]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 12
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_0_12_0 [label="Send K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_12_0 [label="Recv K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_12_1 [label="Send K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_12_1 [label="Recv K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_12_2 [label="Send K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_12_2 [label="Recv K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_12_3 [label="Send K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_12_3 [label="Recv K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_12_4 [label="Send K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_12_4 [label="Recv K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_12_5 [label="Send K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_12_5 [label="Recv K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_12_6 [label="Send K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_12_6 [label="Recv K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_12_7 [label="Send K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_12_7 [label="Recv K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_12_8 [label="Send K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_12_8 [label="Recv K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_12_9 [label="Send K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_12_9 [label="Recv K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_12_10 [label="Send K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_12_10 [label="Recv K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_12_11 [label="Send K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_12_11 [label="Recv K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_12_12 [label="Send K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_12_12 [label="Recv K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_12_13 [label="Send K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_12_13 [label="Recv K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_12_14 [label="Send K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_12_14 [label="Recv K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_12_15 [label="Send K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_12_15 [label="Recv K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_0_12 [label="O Projection L0
Input: [batch=128, seq=6250, heads=32, d_k=128]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 12" fillcolor=lightblue shape=rectangle style=filled]
		add_0_12 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 12" fillcolor=lightgray shape=rectangle style=filled]
		mlp0_gate_12 [label="MLP Gate L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 12" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_up_12 [label="MLP Up L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 12" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_down_12 [label="MLP Down L0
Input: [batch=128, seq=6250, mlp_hidden=32768]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 12" fillcolor=lightpink shape=rectangle style=filled]
		add_1_12 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 12" fillcolor=lightgray shape=rectangle style=filled]
		ln1_pre_12 [label="LayerNorm L1
GPU: 12" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_1_12 [label="Q Proj L1
GPU: 12" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_1_12 [label="K Proj L1
GPU: 12" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_1_12 [label="V Proj L1
GPU: 12" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_1_12 [label="Ring Attention L1
GPU: 12
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_1_12_0 [label="Send K,V L1
Stage 0
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_12_0 [label="Recv K,V L1
Stage 0
From: 12
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_12_1 [label="Send K,V L1
Stage 1
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_12_1 [label="Recv K,V L1
Stage 1
From: 11
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_12_2 [label="Send K,V L1
Stage 2
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_12_2 [label="Recv K,V L1
Stage 2
From: 10
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_12_3 [label="Send K,V L1
Stage 3
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_12_3 [label="Recv K,V L1
Stage 3
From: 9
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_12_4 [label="Send K,V L1
Stage 4
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_12_4 [label="Recv K,V L1
Stage 4
From: 8
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_12_5 [label="Send K,V L1
Stage 5
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_12_5 [label="Recv K,V L1
Stage 5
From: 7
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_12_6 [label="Send K,V L1
Stage 6
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_12_6 [label="Recv K,V L1
Stage 6
From: 6
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_12_7 [label="Send K,V L1
Stage 7
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_12_7 [label="Recv K,V L1
Stage 7
From: 5
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_12_8 [label="Send K,V L1
Stage 8
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_12_8 [label="Recv K,V L1
Stage 8
From: 4
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_12_9 [label="Send K,V L1
Stage 9
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_12_9 [label="Recv K,V L1
Stage 9
From: 3
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_12_10 [label="Send K,V L1
Stage 10
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_12_10 [label="Recv K,V L1
Stage 10
From: 2
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_12_11 [label="Send K,V L1
Stage 11
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_12_11 [label="Recv K,V L1
Stage 11
From: 1
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_12_12 [label="Send K,V L1
Stage 12
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_12_12 [label="Recv K,V L1
Stage 12
From: 0
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_12_13 [label="Send K,V L1
Stage 13
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_12_13 [label="Recv K,V L1
Stage 13
From: 15
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_12_14 [label="Send K,V L1
Stage 14
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_12_14 [label="Recv K,V L1
Stage 14
From: 14
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_12_15 [label="Send K,V L1
Stage 15
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_12_15 [label="Recv K,V L1
Stage 15
From: 13
To: 12" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_1_12 [label="O Proj L1
GPU: 12" fillcolor=lightblue shape=rectangle style=filled]
		add_2_12 [label="Residual Add L1
GPU: 12" fillcolor=lightgray shape=rectangle style=filled]
		mlp1_gate_12 [label="MLP Gate L1
GPU: 12" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_up_12 [label="MLP Up L1
GPU: 12" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_down_12 [label="MLP Down L1
GPU: 12" fillcolor=lightpink shape=rectangle style=filled]
		add_3_12 [label="Residual Add L1
GPU: 12" fillcolor=lightgray shape=rectangle style=filled]
		ln2_pre_12 [label="LayerNorm L2
GPU: 12" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_2_12 [label="Ring Attention L2
GPU: 12
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_2_12 [label="O Proj L2
GPU: 12" fillcolor=lightblue shape=rectangle style=filled]
		add_4_12 [label="Residual Add L2
GPU: 12" fillcolor=lightgray shape=rectangle style=filled]
		mlp2_down_12 [label="MLP Down L2
GPU: 12" fillcolor=lightpink shape=rectangle style=filled]
		add_5_12 [label="Residual Add L2
GPU: 12" fillcolor=lightgray shape=rectangle style=filled]
		ln3_pre_12 [label="LayerNorm L3
GPU: 12" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_3_12 [label="Ring Attention L3
GPU: 12
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_3_12 [label="O Proj L3
GPU: 12" fillcolor=lightblue shape=rectangle style=filled]
		add_6_12 [label="Residual Add L3
GPU: 12" fillcolor=lightgray shape=rectangle style=filled]
		mlp3_down_12 [label="MLP Down L3
GPU: 12" fillcolor=lightpink shape=rectangle style=filled]
		add_7_12 [label="Residual Add L3
GPU: 12" fillcolor=lightgray shape=rectangle style=filled]
		output_gather_12 [label="Gather Output
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=100000, d_model=4096]
GPU: 12→All" fillcolor=lightsteelblue shape=parallelogram style=filled]
	}
	subgraph cluster_device_13 {
		color=color5 fillcolor=lightcolor5 label="Device 13
Sequence: [81250, 87499]
Local tokens: 6250" style=rounded
		input_split_13 [label="Sequence Split
Input: [batch=128, seq=100000, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 13" fillcolor=lightyellow shape=parallelogram style=filled]
		embed_13 [label="Embedding
Input: [batch=128, seq=6250]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 13" fillcolor=lightgreen shape=rectangle style=filled]
		ln0_pre_13 [label="LayerNorm L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 13" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_0_13 [label="Q Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 13" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_0_13 [label="K Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 13" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_0_13 [label="V Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 13" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_0_13 [label="Ring Attention L0
Local Q: [batch=128, seq=6250, heads=32, d_k=128]
Ring K,V: [batch=128, seq=100000, heads=32, d_k=128]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 13
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_0_13_0 [label="Send K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_13_0 [label="Recv K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_13_1 [label="Send K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_13_1 [label="Recv K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_13_2 [label="Send K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_13_2 [label="Recv K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_13_3 [label="Send K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_13_3 [label="Recv K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_13_4 [label="Send K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_13_4 [label="Recv K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_13_5 [label="Send K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_13_5 [label="Recv K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_13_6 [label="Send K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_13_6 [label="Recv K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_13_7 [label="Send K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_13_7 [label="Recv K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_13_8 [label="Send K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_13_8 [label="Recv K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_13_9 [label="Send K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_13_9 [label="Recv K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_13_10 [label="Send K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_13_10 [label="Recv K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_13_11 [label="Send K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_13_11 [label="Recv K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_13_12 [label="Send K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_13_12 [label="Recv K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_13_13 [label="Send K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_13_13 [label="Recv K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_13_14 [label="Send K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_13_14 [label="Recv K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_13_15 [label="Send K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_13_15 [label="Recv K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_0_13 [label="O Projection L0
Input: [batch=128, seq=6250, heads=32, d_k=128]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 13" fillcolor=lightblue shape=rectangle style=filled]
		add_0_13 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 13" fillcolor=lightgray shape=rectangle style=filled]
		mlp0_gate_13 [label="MLP Gate L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 13" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_up_13 [label="MLP Up L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 13" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_down_13 [label="MLP Down L0
Input: [batch=128, seq=6250, mlp_hidden=32768]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 13" fillcolor=lightpink shape=rectangle style=filled]
		add_1_13 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 13" fillcolor=lightgray shape=rectangle style=filled]
		ln1_pre_13 [label="LayerNorm L1
GPU: 13" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_1_13 [label="Q Proj L1
GPU: 13" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_1_13 [label="K Proj L1
GPU: 13" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_1_13 [label="V Proj L1
GPU: 13" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_1_13 [label="Ring Attention L1
GPU: 13
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_1_13_0 [label="Send K,V L1
Stage 0
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_13_0 [label="Recv K,V L1
Stage 0
From: 13
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_13_1 [label="Send K,V L1
Stage 1
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_13_1 [label="Recv K,V L1
Stage 1
From: 12
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_13_2 [label="Send K,V L1
Stage 2
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_13_2 [label="Recv K,V L1
Stage 2
From: 11
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_13_3 [label="Send K,V L1
Stage 3
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_13_3 [label="Recv K,V L1
Stage 3
From: 10
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_13_4 [label="Send K,V L1
Stage 4
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_13_4 [label="Recv K,V L1
Stage 4
From: 9
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_13_5 [label="Send K,V L1
Stage 5
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_13_5 [label="Recv K,V L1
Stage 5
From: 8
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_13_6 [label="Send K,V L1
Stage 6
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_13_6 [label="Recv K,V L1
Stage 6
From: 7
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_13_7 [label="Send K,V L1
Stage 7
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_13_7 [label="Recv K,V L1
Stage 7
From: 6
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_13_8 [label="Send K,V L1
Stage 8
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_13_8 [label="Recv K,V L1
Stage 8
From: 5
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_13_9 [label="Send K,V L1
Stage 9
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_13_9 [label="Recv K,V L1
Stage 9
From: 4
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_13_10 [label="Send K,V L1
Stage 10
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_13_10 [label="Recv K,V L1
Stage 10
From: 3
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_13_11 [label="Send K,V L1
Stage 11
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_13_11 [label="Recv K,V L1
Stage 11
From: 2
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_13_12 [label="Send K,V L1
Stage 12
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_13_12 [label="Recv K,V L1
Stage 12
From: 1
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_13_13 [label="Send K,V L1
Stage 13
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_13_13 [label="Recv K,V L1
Stage 13
From: 0
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_13_14 [label="Send K,V L1
Stage 14
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_13_14 [label="Recv K,V L1
Stage 14
From: 15
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_13_15 [label="Send K,V L1
Stage 15
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_13_15 [label="Recv K,V L1
Stage 15
From: 14
To: 13" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_1_13 [label="O Proj L1
GPU: 13" fillcolor=lightblue shape=rectangle style=filled]
		add_2_13 [label="Residual Add L1
GPU: 13" fillcolor=lightgray shape=rectangle style=filled]
		mlp1_gate_13 [label="MLP Gate L1
GPU: 13" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_up_13 [label="MLP Up L1
GPU: 13" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_down_13 [label="MLP Down L1
GPU: 13" fillcolor=lightpink shape=rectangle style=filled]
		add_3_13 [label="Residual Add L1
GPU: 13" fillcolor=lightgray shape=rectangle style=filled]
		ln2_pre_13 [label="LayerNorm L2
GPU: 13" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_2_13 [label="Ring Attention L2
GPU: 13
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_2_13 [label="O Proj L2
GPU: 13" fillcolor=lightblue shape=rectangle style=filled]
		add_4_13 [label="Residual Add L2
GPU: 13" fillcolor=lightgray shape=rectangle style=filled]
		mlp2_down_13 [label="MLP Down L2
GPU: 13" fillcolor=lightpink shape=rectangle style=filled]
		add_5_13 [label="Residual Add L2
GPU: 13" fillcolor=lightgray shape=rectangle style=filled]
		ln3_pre_13 [label="LayerNorm L3
GPU: 13" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_3_13 [label="Ring Attention L3
GPU: 13
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_3_13 [label="O Proj L3
GPU: 13" fillcolor=lightblue shape=rectangle style=filled]
		add_6_13 [label="Residual Add L3
GPU: 13" fillcolor=lightgray shape=rectangle style=filled]
		mlp3_down_13 [label="MLP Down L3
GPU: 13" fillcolor=lightpink shape=rectangle style=filled]
		add_7_13 [label="Residual Add L3
GPU: 13" fillcolor=lightgray shape=rectangle style=filled]
		output_gather_13 [label="Gather Output
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=100000, d_model=4096]
GPU: 13→All" fillcolor=lightsteelblue shape=parallelogram style=filled]
	}
	subgraph cluster_device_14 {
		color=color6 fillcolor=lightcolor6 label="Device 14
Sequence: [87500, 93749]
Local tokens: 6250" style=rounded
		input_split_14 [label="Sequence Split
Input: [batch=128, seq=100000, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 14" fillcolor=lightyellow shape=parallelogram style=filled]
		embed_14 [label="Embedding
Input: [batch=128, seq=6250]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 14" fillcolor=lightgreen shape=rectangle style=filled]
		ln0_pre_14 [label="LayerNorm L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 14" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_0_14 [label="Q Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 14" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_0_14 [label="K Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 14" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_0_14 [label="V Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 14" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_0_14 [label="Ring Attention L0
Local Q: [batch=128, seq=6250, heads=32, d_k=128]
Ring K,V: [batch=128, seq=100000, heads=32, d_k=128]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 14
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_0_14_0 [label="Send K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_14_0 [label="Recv K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_14_1 [label="Send K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_14_1 [label="Recv K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_14_2 [label="Send K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_14_2 [label="Recv K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_14_3 [label="Send K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_14_3 [label="Recv K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_14_4 [label="Send K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_14_4 [label="Recv K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_14_5 [label="Send K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_14_5 [label="Recv K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_14_6 [label="Send K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_14_6 [label="Recv K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_14_7 [label="Send K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_14_7 [label="Recv K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_14_8 [label="Send K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_14_8 [label="Recv K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_14_9 [label="Send K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_14_9 [label="Recv K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_14_10 [label="Send K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_14_10 [label="Recv K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_14_11 [label="Send K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_14_11 [label="Recv K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_14_12 [label="Send K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_14_12 [label="Recv K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_14_13 [label="Send K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_14_13 [label="Recv K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_14_14 [label="Send K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_14_14 [label="Recv K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_14_15 [label="Send K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_14_15 [label="Recv K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_0_14 [label="O Projection L0
Input: [batch=128, seq=6250, heads=32, d_k=128]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 14" fillcolor=lightblue shape=rectangle style=filled]
		add_0_14 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 14" fillcolor=lightgray shape=rectangle style=filled]
		mlp0_gate_14 [label="MLP Gate L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 14" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_up_14 [label="MLP Up L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 14" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_down_14 [label="MLP Down L0
Input: [batch=128, seq=6250, mlp_hidden=32768]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 14" fillcolor=lightpink shape=rectangle style=filled]
		add_1_14 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 14" fillcolor=lightgray shape=rectangle style=filled]
		ln1_pre_14 [label="LayerNorm L1
GPU: 14" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_1_14 [label="Q Proj L1
GPU: 14" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_1_14 [label="K Proj L1
GPU: 14" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_1_14 [label="V Proj L1
GPU: 14" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_1_14 [label="Ring Attention L1
GPU: 14
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_1_14_0 [label="Send K,V L1
Stage 0
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_14_0 [label="Recv K,V L1
Stage 0
From: 14
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_14_1 [label="Send K,V L1
Stage 1
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_14_1 [label="Recv K,V L1
Stage 1
From: 13
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_14_2 [label="Send K,V L1
Stage 2
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_14_2 [label="Recv K,V L1
Stage 2
From: 12
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_14_3 [label="Send K,V L1
Stage 3
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_14_3 [label="Recv K,V L1
Stage 3
From: 11
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_14_4 [label="Send K,V L1
Stage 4
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_14_4 [label="Recv K,V L1
Stage 4
From: 10
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_14_5 [label="Send K,V L1
Stage 5
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_14_5 [label="Recv K,V L1
Stage 5
From: 9
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_14_6 [label="Send K,V L1
Stage 6
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_14_6 [label="Recv K,V L1
Stage 6
From: 8
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_14_7 [label="Send K,V L1
Stage 7
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_14_7 [label="Recv K,V L1
Stage 7
From: 7
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_14_8 [label="Send K,V L1
Stage 8
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_14_8 [label="Recv K,V L1
Stage 8
From: 6
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_14_9 [label="Send K,V L1
Stage 9
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_14_9 [label="Recv K,V L1
Stage 9
From: 5
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_14_10 [label="Send K,V L1
Stage 10
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_14_10 [label="Recv K,V L1
Stage 10
From: 4
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_14_11 [label="Send K,V L1
Stage 11
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_14_11 [label="Recv K,V L1
Stage 11
From: 3
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_14_12 [label="Send K,V L1
Stage 12
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_14_12 [label="Recv K,V L1
Stage 12
From: 2
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_14_13 [label="Send K,V L1
Stage 13
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_14_13 [label="Recv K,V L1
Stage 13
From: 1
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_14_14 [label="Send K,V L1
Stage 14
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_14_14 [label="Recv K,V L1
Stage 14
From: 0
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_14_15 [label="Send K,V L1
Stage 15
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_14_15 [label="Recv K,V L1
Stage 15
From: 15
To: 14" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_1_14 [label="O Proj L1
GPU: 14" fillcolor=lightblue shape=rectangle style=filled]
		add_2_14 [label="Residual Add L1
GPU: 14" fillcolor=lightgray shape=rectangle style=filled]
		mlp1_gate_14 [label="MLP Gate L1
GPU: 14" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_up_14 [label="MLP Up L1
GPU: 14" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_down_14 [label="MLP Down L1
GPU: 14" fillcolor=lightpink shape=rectangle style=filled]
		add_3_14 [label="Residual Add L1
GPU: 14" fillcolor=lightgray shape=rectangle style=filled]
		ln2_pre_14 [label="LayerNorm L2
GPU: 14" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_2_14 [label="Ring Attention L2
GPU: 14
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_2_14 [label="O Proj L2
GPU: 14" fillcolor=lightblue shape=rectangle style=filled]
		add_4_14 [label="Residual Add L2
GPU: 14" fillcolor=lightgray shape=rectangle style=filled]
		mlp2_down_14 [label="MLP Down L2
GPU: 14" fillcolor=lightpink shape=rectangle style=filled]
		add_5_14 [label="Residual Add L2
GPU: 14" fillcolor=lightgray shape=rectangle style=filled]
		ln3_pre_14 [label="LayerNorm L3
GPU: 14" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_3_14 [label="Ring Attention L3
GPU: 14
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_3_14 [label="O Proj L3
GPU: 14" fillcolor=lightblue shape=rectangle style=filled]
		add_6_14 [label="Residual Add L3
GPU: 14" fillcolor=lightgray shape=rectangle style=filled]
		mlp3_down_14 [label="MLP Down L3
GPU: 14" fillcolor=lightpink shape=rectangle style=filled]
		add_7_14 [label="Residual Add L3
GPU: 14" fillcolor=lightgray shape=rectangle style=filled]
		output_gather_14 [label="Gather Output
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=100000, d_model=4096]
GPU: 14→All" fillcolor=lightsteelblue shape=parallelogram style=filled]
	}
	subgraph cluster_device_15 {
		color=color7 fillcolor=lightcolor7 label="Device 15
Sequence: [93750, 99999]
Local tokens: 6250" style=rounded
		input_split_15 [label="Sequence Split
Input: [batch=128, seq=100000, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 15" fillcolor=lightyellow shape=parallelogram style=filled]
		embed_15 [label="Embedding
Input: [batch=128, seq=6250]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 15" fillcolor=lightgreen shape=rectangle style=filled]
		ln0_pre_15 [label="LayerNorm L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 15" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_0_15 [label="Q Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 15" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_0_15 [label="K Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 15" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_0_15 [label="V Projection L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 15" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_0_15 [label="Ring Attention L0
Local Q: [batch=128, seq=6250, heads=32, d_k=128]
Ring K,V: [batch=128, seq=100000, heads=32, d_k=128]
Output: [batch=128, seq=6250, heads=32, d_k=128]
GPU: 15
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_0_15_0 [label="Send K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_15_0 [label="Recv K,V
Stage 0
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_15_1 [label="Send K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_15_1 [label="Recv K,V
Stage 1
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_15_2 [label="Send K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_15_2 [label="Recv K,V
Stage 2
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 13
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_15_3 [label="Send K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_15_3 [label="Recv K,V
Stage 3
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 12
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_15_4 [label="Send K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_15_4 [label="Recv K,V
Stage 4
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 11
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_15_5 [label="Send K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_15_5 [label="Recv K,V
Stage 5
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 10
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_15_6 [label="Send K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_15_6 [label="Recv K,V
Stage 6
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 9
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_15_7 [label="Send K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_15_7 [label="Recv K,V
Stage 7
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 8
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_15_8 [label="Send K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_15_8 [label="Recv K,V
Stage 8
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 7
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_15_9 [label="Send K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_15_9 [label="Recv K,V
Stage 9
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 6
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_15_10 [label="Send K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_15_10 [label="Recv K,V
Stage 10
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 5
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_15_11 [label="Send K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_15_11 [label="Recv K,V
Stage 11
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 4
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_15_12 [label="Send K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_15_12 [label="Recv K,V
Stage 12
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 3
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_15_13 [label="Send K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_15_13 [label="Recv K,V
Stage 13
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 2
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_15_14 [label="Send K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_15_14 [label="Recv K,V
Stage 14
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 1
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_0_15_15 [label="Send K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_0_15_15 [label="Recv K,V
Stage 15
Data: [batch=128, seq=6250, heads=32, d_k=128]
From: 0
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_0_15 [label="O Projection L0
Input: [batch=128, seq=6250, heads=32, d_k=128]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 15" fillcolor=lightblue shape=rectangle style=filled]
		add_0_15 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 15" fillcolor=lightgray shape=rectangle style=filled]
		mlp0_gate_15 [label="MLP Gate L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 15" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_up_15 [label="MLP Up L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, mlp_hidden=32768]
GPU: 15" fillcolor=lightpink shape=rectangle style=filled]
		mlp0_down_15 [label="MLP Down L0
Input: [batch=128, seq=6250, mlp_hidden=32768]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 15" fillcolor=lightpink shape=rectangle style=filled]
		add_1_15 [label="Residual Add L0
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=6250, d_model=4096]
GPU: 15" fillcolor=lightgray shape=rectangle style=filled]
		ln1_pre_15 [label="LayerNorm L1
GPU: 15" fillcolor=lightcoral shape=rectangle style=filled]
		q_proj_1_15 [label="Q Proj L1
GPU: 15" fillcolor=lightblue shape=rectangle style=filled]
		k_proj_1_15 [label="K Proj L1
GPU: 15" fillcolor=lightblue shape=rectangle style=filled]
		v_proj_1_15 [label="V Proj L1
GPU: 15" fillcolor=lightblue shape=rectangle style=filled]
		ring_attention_1_15 [label="Ring Attention L1
GPU: 15
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		kv_send_1_15_0 [label="Send K,V L1
Stage 0
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_15_0 [label="Recv K,V L1
Stage 0
From: 15
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_15_1 [label="Send K,V L1
Stage 1
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_15_1 [label="Recv K,V L1
Stage 1
From: 14
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_15_2 [label="Send K,V L1
Stage 2
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_15_2 [label="Recv K,V L1
Stage 2
From: 13
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_15_3 [label="Send K,V L1
Stage 3
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_15_3 [label="Recv K,V L1
Stage 3
From: 12
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_15_4 [label="Send K,V L1
Stage 4
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_15_4 [label="Recv K,V L1
Stage 4
From: 11
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_15_5 [label="Send K,V L1
Stage 5
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_15_5 [label="Recv K,V L1
Stage 5
From: 10
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_15_6 [label="Send K,V L1
Stage 6
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_15_6 [label="Recv K,V L1
Stage 6
From: 9
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_15_7 [label="Send K,V L1
Stage 7
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_15_7 [label="Recv K,V L1
Stage 7
From: 8
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_15_8 [label="Send K,V L1
Stage 8
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_15_8 [label="Recv K,V L1
Stage 8
From: 7
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_15_9 [label="Send K,V L1
Stage 9
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_15_9 [label="Recv K,V L1
Stage 9
From: 6
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_15_10 [label="Send K,V L1
Stage 10
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_15_10 [label="Recv K,V L1
Stage 10
From: 5
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_15_11 [label="Send K,V L1
Stage 11
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_15_11 [label="Recv K,V L1
Stage 11
From: 4
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_15_12 [label="Send K,V L1
Stage 12
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_15_12 [label="Recv K,V L1
Stage 12
From: 3
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_15_13 [label="Send K,V L1
Stage 13
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_15_13 [label="Recv K,V L1
Stage 13
From: 2
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_15_14 [label="Send K,V L1
Stage 14
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_15_14 [label="Recv K,V L1
Stage 14
From: 1
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_send_1_15_15 [label="Send K,V L1
Stage 15
From: 15
To: 0" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		kv_recv_1_15_15 [label="Recv K,V L1
Stage 15
From: 0
To: 15" fillcolor=lightsteelblue shape=ellipse style="filled,dashed"]
		o_proj_1_15 [label="O Proj L1
GPU: 15" fillcolor=lightblue shape=rectangle style=filled]
		add_2_15 [label="Residual Add L1
GPU: 15" fillcolor=lightgray shape=rectangle style=filled]
		mlp1_gate_15 [label="MLP Gate L1
GPU: 15" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_up_15 [label="MLP Up L1
GPU: 15" fillcolor=lightpink shape=rectangle style=filled]
		mlp1_down_15 [label="MLP Down L1
GPU: 15" fillcolor=lightpink shape=rectangle style=filled]
		add_3_15 [label="Residual Add L1
GPU: 15" fillcolor=lightgray shape=rectangle style=filled]
		ln2_pre_15 [label="LayerNorm L2
GPU: 15" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_2_15 [label="Ring Attention L2
GPU: 15
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_2_15 [label="O Proj L2
GPU: 15" fillcolor=lightblue shape=rectangle style=filled]
		add_4_15 [label="Residual Add L2
GPU: 15" fillcolor=lightgray shape=rectangle style=filled]
		mlp2_down_15 [label="MLP Down L2
GPU: 15" fillcolor=lightpink shape=rectangle style=filled]
		add_5_15 [label="Residual Add L2
GPU: 15" fillcolor=lightgray shape=rectangle style=filled]
		ln3_pre_15 [label="LayerNorm L3
GPU: 15" fillcolor=lightcoral shape=rectangle style=filled]
		ring_attention_3_15 [label="Ring Attention L3
GPU: 15
Stages: 16" fillcolor=gold peripheries=2 shape=doubleoctagon style=filled]
		o_proj_3_15 [label="O Proj L3
GPU: 15" fillcolor=lightblue shape=rectangle style=filled]
		add_6_15 [label="Residual Add L3
GPU: 15" fillcolor=lightgray shape=rectangle style=filled]
		mlp3_down_15 [label="MLP Down L3
GPU: 15" fillcolor=lightpink shape=rectangle style=filled]
		add_7_15 [label="Residual Add L3
GPU: 15" fillcolor=lightgray shape=rectangle style=filled]
		output_gather_15 [label="Gather Output
Input: [batch=128, seq=6250, d_model=4096]
Output: [batch=128, seq=100000, d_model=4096]
GPU: 15→All" fillcolor=lightsteelblue shape=parallelogram style=filled]
	}
	global_input [label="Global Input
[batch=128, seq=100000, d_model=4096]
GPU: Host" fillcolor=lightyellow shape=ellipse style=filled]
	global_output [label="Global Output
[batch=128, seq=100000, d_model=4096]
GPU: Host" fillcolor=lightyellow shape=ellipse style=filled]
	global_input -> input_split_0
	input_split_0 -> embed_0
	embed_0 -> ln0_pre_0
	ln0_pre_0 -> q_proj_0_0
	ln0_pre_0 -> k_proj_0_0
	ln0_pre_0 -> v_proj_0_0
	q_proj_0_0 -> ring_attention_0_0
	k_proj_0_0 -> ring_attention_0_0
	v_proj_0_0 -> ring_attention_0_0
	k_proj_0_0 -> kv_recv_0_0_0 [style=dashed]
	v_proj_0_0 -> kv_recv_0_0_0 [style=dashed]
	kv_recv_0_0_0 -> ring_attention_0_0
	k_proj_0_0 -> kv_send_0_0_0
	v_proj_0_0 -> kv_send_0_0_0
	kv_send_0_0_0 -> kv_recv_0_1_0 [style=dashed]
	k_proj_0_15 -> kv_recv_0_0_1 [style=dashed]
	v_proj_0_15 -> kv_recv_0_0_1 [style=dashed]
	kv_recv_0_0_1 -> ring_attention_0_0
	k_proj_0_0 -> kv_send_0_0_1
	v_proj_0_0 -> kv_send_0_0_1
	kv_send_0_0_1 -> kv_recv_0_1_1 [style=dashed]
	k_proj_0_14 -> kv_recv_0_0_2 [style=dashed]
	v_proj_0_14 -> kv_recv_0_0_2 [style=dashed]
	kv_recv_0_0_2 -> ring_attention_0_0
	k_proj_0_0 -> kv_send_0_0_2
	v_proj_0_0 -> kv_send_0_0_2
	kv_send_0_0_2 -> kv_recv_0_1_2 [style=dashed]
	k_proj_0_13 -> kv_recv_0_0_3 [style=dashed]
	v_proj_0_13 -> kv_recv_0_0_3 [style=dashed]
	kv_recv_0_0_3 -> ring_attention_0_0
	k_proj_0_0 -> kv_send_0_0_3
	v_proj_0_0 -> kv_send_0_0_3
	kv_send_0_0_3 -> kv_recv_0_1_3 [style=dashed]
	k_proj_0_12 -> kv_recv_0_0_4 [style=dashed]
	v_proj_0_12 -> kv_recv_0_0_4 [style=dashed]
	kv_recv_0_0_4 -> ring_attention_0_0
	k_proj_0_0 -> kv_send_0_0_4
	v_proj_0_0 -> kv_send_0_0_4
	kv_send_0_0_4 -> kv_recv_0_1_4 [style=dashed]
	k_proj_0_11 -> kv_recv_0_0_5 [style=dashed]
	v_proj_0_11 -> kv_recv_0_0_5 [style=dashed]
	kv_recv_0_0_5 -> ring_attention_0_0
	k_proj_0_0 -> kv_send_0_0_5
	v_proj_0_0 -> kv_send_0_0_5
	kv_send_0_0_5 -> kv_recv_0_1_5 [style=dashed]
	k_proj_0_10 -> kv_recv_0_0_6 [style=dashed]
	v_proj_0_10 -> kv_recv_0_0_6 [style=dashed]
	kv_recv_0_0_6 -> ring_attention_0_0
	k_proj_0_0 -> kv_send_0_0_6
	v_proj_0_0 -> kv_send_0_0_6
	kv_send_0_0_6 -> kv_recv_0_1_6 [style=dashed]
	k_proj_0_9 -> kv_recv_0_0_7 [style=dashed]
	v_proj_0_9 -> kv_recv_0_0_7 [style=dashed]
	kv_recv_0_0_7 -> ring_attention_0_0
	k_proj_0_0 -> kv_send_0_0_7
	v_proj_0_0 -> kv_send_0_0_7
	kv_send_0_0_7 -> kv_recv_0_1_7 [style=dashed]
	k_proj_0_8 -> kv_recv_0_0_8 [style=dashed]
	v_proj_0_8 -> kv_recv_0_0_8 [style=dashed]
	kv_recv_0_0_8 -> ring_attention_0_0
	k_proj_0_0 -> kv_send_0_0_8
	v_proj_0_0 -> kv_send_0_0_8
	kv_send_0_0_8 -> kv_recv_0_1_8 [style=dashed]
	k_proj_0_7 -> kv_recv_0_0_9 [style=dashed]
	v_proj_0_7 -> kv_recv_0_0_9 [style=dashed]
	kv_recv_0_0_9 -> ring_attention_0_0
	k_proj_0_0 -> kv_send_0_0_9
	v_proj_0_0 -> kv_send_0_0_9
	kv_send_0_0_9 -> kv_recv_0_1_9 [style=dashed]
	k_proj_0_6 -> kv_recv_0_0_10 [style=dashed]
	v_proj_0_6 -> kv_recv_0_0_10 [style=dashed]
	kv_recv_0_0_10 -> ring_attention_0_0
	k_proj_0_0 -> kv_send_0_0_10
	v_proj_0_0 -> kv_send_0_0_10
	kv_send_0_0_10 -> kv_recv_0_1_10 [style=dashed]
	k_proj_0_5 -> kv_recv_0_0_11 [style=dashed]
	v_proj_0_5 -> kv_recv_0_0_11 [style=dashed]
	kv_recv_0_0_11 -> ring_attention_0_0
	k_proj_0_0 -> kv_send_0_0_11
	v_proj_0_0 -> kv_send_0_0_11
	kv_send_0_0_11 -> kv_recv_0_1_11 [style=dashed]
	k_proj_0_4 -> kv_recv_0_0_12 [style=dashed]
	v_proj_0_4 -> kv_recv_0_0_12 [style=dashed]
	kv_recv_0_0_12 -> ring_attention_0_0
	k_proj_0_0 -> kv_send_0_0_12
	v_proj_0_0 -> kv_send_0_0_12
	kv_send_0_0_12 -> kv_recv_0_1_12 [style=dashed]
	k_proj_0_3 -> kv_recv_0_0_13 [style=dashed]
	v_proj_0_3 -> kv_recv_0_0_13 [style=dashed]
	kv_recv_0_0_13 -> ring_attention_0_0
	k_proj_0_0 -> kv_send_0_0_13
	v_proj_0_0 -> kv_send_0_0_13
	kv_send_0_0_13 -> kv_recv_0_1_13 [style=dashed]
	k_proj_0_2 -> kv_recv_0_0_14 [style=dashed]
	v_proj_0_2 -> kv_recv_0_0_14 [style=dashed]
	kv_recv_0_0_14 -> ring_attention_0_0
	k_proj_0_0 -> kv_send_0_0_14
	v_proj_0_0 -> kv_send_0_0_14
	kv_send_0_0_14 -> kv_recv_0_1_14 [style=dashed]
	k_proj_0_1 -> kv_recv_0_0_15 [style=dashed]
	v_proj_0_1 -> kv_recv_0_0_15 [style=dashed]
	kv_recv_0_0_15 -> ring_attention_0_0
	k_proj_0_0 -> kv_send_0_0_15
	v_proj_0_0 -> kv_send_0_0_15
	kv_send_0_0_15 -> kv_recv_0_1_15 [style=dashed]
	ring_attention_0_0 -> o_proj_0_0
	o_proj_0_0 -> add_0_0
	embed_0 -> add_0_0
	add_0_0 -> mlp0_gate_0
	add_0_0 -> mlp0_up_0
	mlp0_gate_0 -> mlp0_down_0
	mlp0_up_0 -> mlp0_down_0
	mlp0_down_0 -> add_1_0
	add_0_0 -> add_1_0
	add_1_0 -> ln1_pre_0
	ln1_pre_0 -> q_proj_1_0
	ln1_pre_0 -> k_proj_1_0
	ln1_pre_0 -> v_proj_1_0
	q_proj_1_0 -> ring_attention_1_0
	k_proj_1_0 -> ring_attention_1_0
	v_proj_1_0 -> ring_attention_1_0
	k_proj_1_0 -> kv_recv_1_0_0 [style=dashed]
	v_proj_1_0 -> kv_recv_1_0_0 [style=dashed]
	kv_recv_1_0_0 -> ring_attention_1_0
	k_proj_1_0 -> kv_send_1_0_0
	v_proj_1_0 -> kv_send_1_0_0
	kv_send_1_0_0 -> kv_recv_1_1_0 [style=dashed]
	k_proj_1_15 -> kv_recv_1_0_1 [style=dashed]
	v_proj_1_15 -> kv_recv_1_0_1 [style=dashed]
	kv_recv_1_0_1 -> ring_attention_1_0
	k_proj_1_0 -> kv_send_1_0_1
	v_proj_1_0 -> kv_send_1_0_1
	kv_send_1_0_1 -> kv_recv_1_1_1 [style=dashed]
	k_proj_1_14 -> kv_recv_1_0_2 [style=dashed]
	v_proj_1_14 -> kv_recv_1_0_2 [style=dashed]
	kv_recv_1_0_2 -> ring_attention_1_0
	k_proj_1_0 -> kv_send_1_0_2
	v_proj_1_0 -> kv_send_1_0_2
	kv_send_1_0_2 -> kv_recv_1_1_2 [style=dashed]
	k_proj_1_13 -> kv_recv_1_0_3 [style=dashed]
	v_proj_1_13 -> kv_recv_1_0_3 [style=dashed]
	kv_recv_1_0_3 -> ring_attention_1_0
	k_proj_1_0 -> kv_send_1_0_3
	v_proj_1_0 -> kv_send_1_0_3
	kv_send_1_0_3 -> kv_recv_1_1_3 [style=dashed]
	k_proj_1_12 -> kv_recv_1_0_4 [style=dashed]
	v_proj_1_12 -> kv_recv_1_0_4 [style=dashed]
	kv_recv_1_0_4 -> ring_attention_1_0
	k_proj_1_0 -> kv_send_1_0_4
	v_proj_1_0 -> kv_send_1_0_4
	kv_send_1_0_4 -> kv_recv_1_1_4 [style=dashed]
	k_proj_1_11 -> kv_recv_1_0_5 [style=dashed]
	v_proj_1_11 -> kv_recv_1_0_5 [style=dashed]
	kv_recv_1_0_5 -> ring_attention_1_0
	k_proj_1_0 -> kv_send_1_0_5
	v_proj_1_0 -> kv_send_1_0_5
	kv_send_1_0_5 -> kv_recv_1_1_5 [style=dashed]
	k_proj_1_10 -> kv_recv_1_0_6 [style=dashed]
	v_proj_1_10 -> kv_recv_1_0_6 [style=dashed]
	kv_recv_1_0_6 -> ring_attention_1_0
	k_proj_1_0 -> kv_send_1_0_6
	v_proj_1_0 -> kv_send_1_0_6
	kv_send_1_0_6 -> kv_recv_1_1_6 [style=dashed]
	k_proj_1_9 -> kv_recv_1_0_7 [style=dashed]
	v_proj_1_9 -> kv_recv_1_0_7 [style=dashed]
	kv_recv_1_0_7 -> ring_attention_1_0
	k_proj_1_0 -> kv_send_1_0_7
	v_proj_1_0 -> kv_send_1_0_7
	kv_send_1_0_7 -> kv_recv_1_1_7 [style=dashed]
	k_proj_1_8 -> kv_recv_1_0_8 [style=dashed]
	v_proj_1_8 -> kv_recv_1_0_8 [style=dashed]
	kv_recv_1_0_8 -> ring_attention_1_0
	k_proj_1_0 -> kv_send_1_0_8
	v_proj_1_0 -> kv_send_1_0_8
	kv_send_1_0_8 -> kv_recv_1_1_8 [style=dashed]
	k_proj_1_7 -> kv_recv_1_0_9 [style=dashed]
	v_proj_1_7 -> kv_recv_1_0_9 [style=dashed]
	kv_recv_1_0_9 -> ring_attention_1_0
	k_proj_1_0 -> kv_send_1_0_9
	v_proj_1_0 -> kv_send_1_0_9
	kv_send_1_0_9 -> kv_recv_1_1_9 [style=dashed]
	k_proj_1_6 -> kv_recv_1_0_10 [style=dashed]
	v_proj_1_6 -> kv_recv_1_0_10 [style=dashed]
	kv_recv_1_0_10 -> ring_attention_1_0
	k_proj_1_0 -> kv_send_1_0_10
	v_proj_1_0 -> kv_send_1_0_10
	kv_send_1_0_10 -> kv_recv_1_1_10 [style=dashed]
	k_proj_1_5 -> kv_recv_1_0_11 [style=dashed]
	v_proj_1_5 -> kv_recv_1_0_11 [style=dashed]
	kv_recv_1_0_11 -> ring_attention_1_0
	k_proj_1_0 -> kv_send_1_0_11
	v_proj_1_0 -> kv_send_1_0_11
	kv_send_1_0_11 -> kv_recv_1_1_11 [style=dashed]
	k_proj_1_4 -> kv_recv_1_0_12 [style=dashed]
	v_proj_1_4 -> kv_recv_1_0_12 [style=dashed]
	kv_recv_1_0_12 -> ring_attention_1_0
	k_proj_1_0 -> kv_send_1_0_12
	v_proj_1_0 -> kv_send_1_0_12
	kv_send_1_0_12 -> kv_recv_1_1_12 [style=dashed]
	k_proj_1_3 -> kv_recv_1_0_13 [style=dashed]
	v_proj_1_3 -> kv_recv_1_0_13 [style=dashed]
	kv_recv_1_0_13 -> ring_attention_1_0
	k_proj_1_0 -> kv_send_1_0_13
	v_proj_1_0 -> kv_send_1_0_13
	kv_send_1_0_13 -> kv_recv_1_1_13 [style=dashed]
	k_proj_1_2 -> kv_recv_1_0_14 [style=dashed]
	v_proj_1_2 -> kv_recv_1_0_14 [style=dashed]
	kv_recv_1_0_14 -> ring_attention_1_0
	k_proj_1_0 -> kv_send_1_0_14
	v_proj_1_0 -> kv_send_1_0_14
	kv_send_1_0_14 -> kv_recv_1_1_14 [style=dashed]
	k_proj_1_1 -> kv_recv_1_0_15 [style=dashed]
	v_proj_1_1 -> kv_recv_1_0_15 [style=dashed]
	kv_recv_1_0_15 -> ring_attention_1_0
	k_proj_1_0 -> kv_send_1_0_15
	v_proj_1_0 -> kv_send_1_0_15
	kv_send_1_0_15 -> kv_recv_1_1_15 [style=dashed]
	ring_attention_1_0 -> o_proj_1_0
	o_proj_1_0 -> add_2_0
	add_1_0 -> add_2_0
	add_2_0 -> mlp1_gate_0
	add_2_0 -> mlp1_up_0
	mlp1_gate_0 -> mlp1_down_0
	mlp1_up_0 -> mlp1_down_0
	mlp1_down_0 -> add_3_0
	add_2_0 -> add_3_0
	add_3_0 -> ln2_pre_0
	ln2_pre_0 -> ring_attention_2_0
	ring_attention_2_0 -> o_proj_2_0
	o_proj_2_0 -> add_4_0
	add_3_0 -> add_4_0
	add_4_0 -> mlp2_down_0
	mlp2_down_0 -> add_5_0
	add_4_0 -> add_5_0
	add_5_0 -> ln3_pre_0
	ln3_pre_0 -> ring_attention_3_0
	ring_attention_3_0 -> o_proj_3_0
	o_proj_3_0 -> add_6_0
	add_5_0 -> add_6_0
	add_6_0 -> mlp3_down_0
	mlp3_down_0 -> add_7_0
	add_6_0 -> add_7_0
	add_7_0 -> output_gather_0
	output_gather_0 -> global_output
	output_gather_1 -> global_output
	output_gather_2 -> global_output
	output_gather_3 -> global_output
	output_gather_4 -> global_output
	output_gather_5 -> global_output
	output_gather_6 -> global_output
	output_gather_7 -> global_output
	output_gather_8 -> global_output
	output_gather_9 -> global_output
	output_gather_10 -> global_output
	output_gather_11 -> global_output
	output_gather_12 -> global_output
	output_gather_13 -> global_output
	output_gather_14 -> global_output
	output_gather_15 -> global_output
	global_input -> input_split_1
	input_split_1 -> embed_1
	embed_1 -> ln0_pre_1
	ln0_pre_1 -> q_proj_0_1
	ln0_pre_1 -> k_proj_0_1
	ln0_pre_1 -> v_proj_0_1
	q_proj_0_1 -> ring_attention_0_1
	k_proj_0_1 -> ring_attention_0_1
	v_proj_0_1 -> ring_attention_0_1
	k_proj_0_1 -> kv_recv_0_1_0 [style=dashed]
	v_proj_0_1 -> kv_recv_0_1_0 [style=dashed]
	kv_recv_0_1_0 -> ring_attention_0_1
	k_proj_0_1 -> kv_send_0_1_0
	v_proj_0_1 -> kv_send_0_1_0
	kv_send_0_1_0 -> kv_recv_0_2_0 [style=dashed]
	k_proj_0_0 -> kv_recv_0_1_1 [style=dashed]
	v_proj_0_0 -> kv_recv_0_1_1 [style=dashed]
	kv_recv_0_1_1 -> ring_attention_0_1
	k_proj_0_1 -> kv_send_0_1_1
	v_proj_0_1 -> kv_send_0_1_1
	kv_send_0_1_1 -> kv_recv_0_2_1 [style=dashed]
	k_proj_0_15 -> kv_recv_0_1_2 [style=dashed]
	v_proj_0_15 -> kv_recv_0_1_2 [style=dashed]
	kv_recv_0_1_2 -> ring_attention_0_1
	k_proj_0_1 -> kv_send_0_1_2
	v_proj_0_1 -> kv_send_0_1_2
	kv_send_0_1_2 -> kv_recv_0_2_2 [style=dashed]
	k_proj_0_14 -> kv_recv_0_1_3 [style=dashed]
	v_proj_0_14 -> kv_recv_0_1_3 [style=dashed]
	kv_recv_0_1_3 -> ring_attention_0_1
	k_proj_0_1 -> kv_send_0_1_3
	v_proj_0_1 -> kv_send_0_1_3
	kv_send_0_1_3 -> kv_recv_0_2_3 [style=dashed]
	k_proj_0_13 -> kv_recv_0_1_4 [style=dashed]
	v_proj_0_13 -> kv_recv_0_1_4 [style=dashed]
	kv_recv_0_1_4 -> ring_attention_0_1
	k_proj_0_1 -> kv_send_0_1_4
	v_proj_0_1 -> kv_send_0_1_4
	kv_send_0_1_4 -> kv_recv_0_2_4 [style=dashed]
	k_proj_0_12 -> kv_recv_0_1_5 [style=dashed]
	v_proj_0_12 -> kv_recv_0_1_5 [style=dashed]
	kv_recv_0_1_5 -> ring_attention_0_1
	k_proj_0_1 -> kv_send_0_1_5
	v_proj_0_1 -> kv_send_0_1_5
	kv_send_0_1_5 -> kv_recv_0_2_5 [style=dashed]
	k_proj_0_11 -> kv_recv_0_1_6 [style=dashed]
	v_proj_0_11 -> kv_recv_0_1_6 [style=dashed]
	kv_recv_0_1_6 -> ring_attention_0_1
	k_proj_0_1 -> kv_send_0_1_6
	v_proj_0_1 -> kv_send_0_1_6
	kv_send_0_1_6 -> kv_recv_0_2_6 [style=dashed]
	k_proj_0_10 -> kv_recv_0_1_7 [style=dashed]
	v_proj_0_10 -> kv_recv_0_1_7 [style=dashed]
	kv_recv_0_1_7 -> ring_attention_0_1
	k_proj_0_1 -> kv_send_0_1_7
	v_proj_0_1 -> kv_send_0_1_7
	kv_send_0_1_7 -> kv_recv_0_2_7 [style=dashed]
	k_proj_0_9 -> kv_recv_0_1_8 [style=dashed]
	v_proj_0_9 -> kv_recv_0_1_8 [style=dashed]
	kv_recv_0_1_8 -> ring_attention_0_1
	k_proj_0_1 -> kv_send_0_1_8
	v_proj_0_1 -> kv_send_0_1_8
	kv_send_0_1_8 -> kv_recv_0_2_8 [style=dashed]
	k_proj_0_8 -> kv_recv_0_1_9 [style=dashed]
	v_proj_0_8 -> kv_recv_0_1_9 [style=dashed]
	kv_recv_0_1_9 -> ring_attention_0_1
	k_proj_0_1 -> kv_send_0_1_9
	v_proj_0_1 -> kv_send_0_1_9
	kv_send_0_1_9 -> kv_recv_0_2_9 [style=dashed]
	k_proj_0_7 -> kv_recv_0_1_10 [style=dashed]
	v_proj_0_7 -> kv_recv_0_1_10 [style=dashed]
	kv_recv_0_1_10 -> ring_attention_0_1
	k_proj_0_1 -> kv_send_0_1_10
	v_proj_0_1 -> kv_send_0_1_10
	kv_send_0_1_10 -> kv_recv_0_2_10 [style=dashed]
	k_proj_0_6 -> kv_recv_0_1_11 [style=dashed]
	v_proj_0_6 -> kv_recv_0_1_11 [style=dashed]
	kv_recv_0_1_11 -> ring_attention_0_1
	k_proj_0_1 -> kv_send_0_1_11
	v_proj_0_1 -> kv_send_0_1_11
	kv_send_0_1_11 -> kv_recv_0_2_11 [style=dashed]
	k_proj_0_5 -> kv_recv_0_1_12 [style=dashed]
	v_proj_0_5 -> kv_recv_0_1_12 [style=dashed]
	kv_recv_0_1_12 -> ring_attention_0_1
	k_proj_0_1 -> kv_send_0_1_12
	v_proj_0_1 -> kv_send_0_1_12
	kv_send_0_1_12 -> kv_recv_0_2_12 [style=dashed]
	k_proj_0_4 -> kv_recv_0_1_13 [style=dashed]
	v_proj_0_4 -> kv_recv_0_1_13 [style=dashed]
	kv_recv_0_1_13 -> ring_attention_0_1
	k_proj_0_1 -> kv_send_0_1_13
	v_proj_0_1 -> kv_send_0_1_13
	kv_send_0_1_13 -> kv_recv_0_2_13 [style=dashed]
	k_proj_0_3 -> kv_recv_0_1_14 [style=dashed]
	v_proj_0_3 -> kv_recv_0_1_14 [style=dashed]
	kv_recv_0_1_14 -> ring_attention_0_1
	k_proj_0_1 -> kv_send_0_1_14
	v_proj_0_1 -> kv_send_0_1_14
	kv_send_0_1_14 -> kv_recv_0_2_14 [style=dashed]
	k_proj_0_2 -> kv_recv_0_1_15 [style=dashed]
	v_proj_0_2 -> kv_recv_0_1_15 [style=dashed]
	kv_recv_0_1_15 -> ring_attention_0_1
	k_proj_0_1 -> kv_send_0_1_15
	v_proj_0_1 -> kv_send_0_1_15
	kv_send_0_1_15 -> kv_recv_0_2_15 [style=dashed]
	ring_attention_0_1 -> o_proj_0_1
	o_proj_0_1 -> add_0_1
	embed_1 -> add_0_1
	add_0_1 -> mlp0_gate_1
	add_0_1 -> mlp0_up_1
	mlp0_gate_1 -> mlp0_down_1
	mlp0_up_1 -> mlp0_down_1
	mlp0_down_1 -> add_1_1
	add_0_1 -> add_1_1
	add_1_1 -> ln1_pre_1
	ln1_pre_1 -> q_proj_1_1
	ln1_pre_1 -> k_proj_1_1
	ln1_pre_1 -> v_proj_1_1
	q_proj_1_1 -> ring_attention_1_1
	k_proj_1_1 -> ring_attention_1_1
	v_proj_1_1 -> ring_attention_1_1
	k_proj_1_1 -> kv_recv_1_1_0 [style=dashed]
	v_proj_1_1 -> kv_recv_1_1_0 [style=dashed]
	kv_recv_1_1_0 -> ring_attention_1_1
	k_proj_1_1 -> kv_send_1_1_0
	v_proj_1_1 -> kv_send_1_1_0
	kv_send_1_1_0 -> kv_recv_1_2_0 [style=dashed]
	k_proj_1_0 -> kv_recv_1_1_1 [style=dashed]
	v_proj_1_0 -> kv_recv_1_1_1 [style=dashed]
	kv_recv_1_1_1 -> ring_attention_1_1
	k_proj_1_1 -> kv_send_1_1_1
	v_proj_1_1 -> kv_send_1_1_1
	kv_send_1_1_1 -> kv_recv_1_2_1 [style=dashed]
	k_proj_1_15 -> kv_recv_1_1_2 [style=dashed]
	v_proj_1_15 -> kv_recv_1_1_2 [style=dashed]
	kv_recv_1_1_2 -> ring_attention_1_1
	k_proj_1_1 -> kv_send_1_1_2
	v_proj_1_1 -> kv_send_1_1_2
	kv_send_1_1_2 -> kv_recv_1_2_2 [style=dashed]
	k_proj_1_14 -> kv_recv_1_1_3 [style=dashed]
	v_proj_1_14 -> kv_recv_1_1_3 [style=dashed]
	kv_recv_1_1_3 -> ring_attention_1_1
	k_proj_1_1 -> kv_send_1_1_3
	v_proj_1_1 -> kv_send_1_1_3
	kv_send_1_1_3 -> kv_recv_1_2_3 [style=dashed]
	k_proj_1_13 -> kv_recv_1_1_4 [style=dashed]
	v_proj_1_13 -> kv_recv_1_1_4 [style=dashed]
	kv_recv_1_1_4 -> ring_attention_1_1
	k_proj_1_1 -> kv_send_1_1_4
	v_proj_1_1 -> kv_send_1_1_4
	kv_send_1_1_4 -> kv_recv_1_2_4 [style=dashed]
	k_proj_1_12 -> kv_recv_1_1_5 [style=dashed]
	v_proj_1_12 -> kv_recv_1_1_5 [style=dashed]
	kv_recv_1_1_5 -> ring_attention_1_1
	k_proj_1_1 -> kv_send_1_1_5
	v_proj_1_1 -> kv_send_1_1_5
	kv_send_1_1_5 -> kv_recv_1_2_5 [style=dashed]
	k_proj_1_11 -> kv_recv_1_1_6 [style=dashed]
	v_proj_1_11 -> kv_recv_1_1_6 [style=dashed]
	kv_recv_1_1_6 -> ring_attention_1_1
	k_proj_1_1 -> kv_send_1_1_6
	v_proj_1_1 -> kv_send_1_1_6
	kv_send_1_1_6 -> kv_recv_1_2_6 [style=dashed]
	k_proj_1_10 -> kv_recv_1_1_7 [style=dashed]
	v_proj_1_10 -> kv_recv_1_1_7 [style=dashed]
	kv_recv_1_1_7 -> ring_attention_1_1
	k_proj_1_1 -> kv_send_1_1_7
	v_proj_1_1 -> kv_send_1_1_7
	kv_send_1_1_7 -> kv_recv_1_2_7 [style=dashed]
	k_proj_1_9 -> kv_recv_1_1_8 [style=dashed]
	v_proj_1_9 -> kv_recv_1_1_8 [style=dashed]
	kv_recv_1_1_8 -> ring_attention_1_1
	k_proj_1_1 -> kv_send_1_1_8
	v_proj_1_1 -> kv_send_1_1_8
	kv_send_1_1_8 -> kv_recv_1_2_8 [style=dashed]
	k_proj_1_8 -> kv_recv_1_1_9 [style=dashed]
	v_proj_1_8 -> kv_recv_1_1_9 [style=dashed]
	kv_recv_1_1_9 -> ring_attention_1_1
	k_proj_1_1 -> kv_send_1_1_9
	v_proj_1_1 -> kv_send_1_1_9
	kv_send_1_1_9 -> kv_recv_1_2_9 [style=dashed]
	k_proj_1_7 -> kv_recv_1_1_10 [style=dashed]
	v_proj_1_7 -> kv_recv_1_1_10 [style=dashed]
	kv_recv_1_1_10 -> ring_attention_1_1
	k_proj_1_1 -> kv_send_1_1_10
	v_proj_1_1 -> kv_send_1_1_10
	kv_send_1_1_10 -> kv_recv_1_2_10 [style=dashed]
	k_proj_1_6 -> kv_recv_1_1_11 [style=dashed]
	v_proj_1_6 -> kv_recv_1_1_11 [style=dashed]
	kv_recv_1_1_11 -> ring_attention_1_1
	k_proj_1_1 -> kv_send_1_1_11
	v_proj_1_1 -> kv_send_1_1_11
	kv_send_1_1_11 -> kv_recv_1_2_11 [style=dashed]
	k_proj_1_5 -> kv_recv_1_1_12 [style=dashed]
	v_proj_1_5 -> kv_recv_1_1_12 [style=dashed]
	kv_recv_1_1_12 -> ring_attention_1_1
	k_proj_1_1 -> kv_send_1_1_12
	v_proj_1_1 -> kv_send_1_1_12
	kv_send_1_1_12 -> kv_recv_1_2_12 [style=dashed]
	k_proj_1_4 -> kv_recv_1_1_13 [style=dashed]
	v_proj_1_4 -> kv_recv_1_1_13 [style=dashed]
	kv_recv_1_1_13 -> ring_attention_1_1
	k_proj_1_1 -> kv_send_1_1_13
	v_proj_1_1 -> kv_send_1_1_13
	kv_send_1_1_13 -> kv_recv_1_2_13 [style=dashed]
	k_proj_1_3 -> kv_recv_1_1_14 [style=dashed]
	v_proj_1_3 -> kv_recv_1_1_14 [style=dashed]
	kv_recv_1_1_14 -> ring_attention_1_1
	k_proj_1_1 -> kv_send_1_1_14
	v_proj_1_1 -> kv_send_1_1_14
	kv_send_1_1_14 -> kv_recv_1_2_14 [style=dashed]
	k_proj_1_2 -> kv_recv_1_1_15 [style=dashed]
	v_proj_1_2 -> kv_recv_1_1_15 [style=dashed]
	kv_recv_1_1_15 -> ring_attention_1_1
	k_proj_1_1 -> kv_send_1_1_15
	v_proj_1_1 -> kv_send_1_1_15
	kv_send_1_1_15 -> kv_recv_1_2_15 [style=dashed]
	ring_attention_1_1 -> o_proj_1_1
	o_proj_1_1 -> add_2_1
	add_1_1 -> add_2_1
	add_2_1 -> mlp1_gate_1
	add_2_1 -> mlp1_up_1
	mlp1_gate_1 -> mlp1_down_1
	mlp1_up_1 -> mlp1_down_1
	mlp1_down_1 -> add_3_1
	add_2_1 -> add_3_1
	add_3_1 -> ln2_pre_1
	ln2_pre_1 -> ring_attention_2_1
	ring_attention_2_1 -> o_proj_2_1
	o_proj_2_1 -> add_4_1
	add_3_1 -> add_4_1
	add_4_1 -> mlp2_down_1
	mlp2_down_1 -> add_5_1
	add_4_1 -> add_5_1
	add_5_1 -> ln3_pre_1
	ln3_pre_1 -> ring_attention_3_1
	ring_attention_3_1 -> o_proj_3_1
	o_proj_3_1 -> add_6_1
	add_5_1 -> add_6_1
	add_6_1 -> mlp3_down_1
	mlp3_down_1 -> add_7_1
	add_6_1 -> add_7_1
	add_7_1 -> output_gather_1
	output_gather_0 -> global_output
	output_gather_1 -> global_output
	output_gather_2 -> global_output
	output_gather_3 -> global_output
	output_gather_4 -> global_output
	output_gather_5 -> global_output
	output_gather_6 -> global_output
	output_gather_7 -> global_output
	output_gather_8 -> global_output
	output_gather_9 -> global_output
	output_gather_10 -> global_output
	output_gather_11 -> global_output
	output_gather_12 -> global_output
	output_gather_13 -> global_output
	output_gather_14 -> global_output
	output_gather_15 -> global_output
	global_input -> input_split_2
	input_split_2 -> embed_2
	embed_2 -> ln0_pre_2
	ln0_pre_2 -> q_proj_0_2
	ln0_pre_2 -> k_proj_0_2
	ln0_pre_2 -> v_proj_0_2
	q_proj_0_2 -> ring_attention_0_2
	k_proj_0_2 -> ring_attention_0_2
	v_proj_0_2 -> ring_attention_0_2
	k_proj_0_2 -> kv_recv_0_2_0 [style=dashed]
	v_proj_0_2 -> kv_recv_0_2_0 [style=dashed]
	kv_recv_0_2_0 -> ring_attention_0_2
	k_proj_0_2 -> kv_send_0_2_0
	v_proj_0_2 -> kv_send_0_2_0
	kv_send_0_2_0 -> kv_recv_0_3_0 [style=dashed]
	k_proj_0_1 -> kv_recv_0_2_1 [style=dashed]
	v_proj_0_1 -> kv_recv_0_2_1 [style=dashed]
	kv_recv_0_2_1 -> ring_attention_0_2
	k_proj_0_2 -> kv_send_0_2_1
	v_proj_0_2 -> kv_send_0_2_1
	kv_send_0_2_1 -> kv_recv_0_3_1 [style=dashed]
	k_proj_0_0 -> kv_recv_0_2_2 [style=dashed]
	v_proj_0_0 -> kv_recv_0_2_2 [style=dashed]
	kv_recv_0_2_2 -> ring_attention_0_2
	k_proj_0_2 -> kv_send_0_2_2
	v_proj_0_2 -> kv_send_0_2_2
	kv_send_0_2_2 -> kv_recv_0_3_2 [style=dashed]
	k_proj_0_15 -> kv_recv_0_2_3 [style=dashed]
	v_proj_0_15 -> kv_recv_0_2_3 [style=dashed]
	kv_recv_0_2_3 -> ring_attention_0_2
	k_proj_0_2 -> kv_send_0_2_3
	v_proj_0_2 -> kv_send_0_2_3
	kv_send_0_2_3 -> kv_recv_0_3_3 [style=dashed]
	k_proj_0_14 -> kv_recv_0_2_4 [style=dashed]
	v_proj_0_14 -> kv_recv_0_2_4 [style=dashed]
	kv_recv_0_2_4 -> ring_attention_0_2
	k_proj_0_2 -> kv_send_0_2_4
	v_proj_0_2 -> kv_send_0_2_4
	kv_send_0_2_4 -> kv_recv_0_3_4 [style=dashed]
	k_proj_0_13 -> kv_recv_0_2_5 [style=dashed]
	v_proj_0_13 -> kv_recv_0_2_5 [style=dashed]
	kv_recv_0_2_5 -> ring_attention_0_2
	k_proj_0_2 -> kv_send_0_2_5
	v_proj_0_2 -> kv_send_0_2_5
	kv_send_0_2_5 -> kv_recv_0_3_5 [style=dashed]
	k_proj_0_12 -> kv_recv_0_2_6 [style=dashed]
	v_proj_0_12 -> kv_recv_0_2_6 [style=dashed]
	kv_recv_0_2_6 -> ring_attention_0_2
	k_proj_0_2 -> kv_send_0_2_6
	v_proj_0_2 -> kv_send_0_2_6
	kv_send_0_2_6 -> kv_recv_0_3_6 [style=dashed]
	k_proj_0_11 -> kv_recv_0_2_7 [style=dashed]
	v_proj_0_11 -> kv_recv_0_2_7 [style=dashed]
	kv_recv_0_2_7 -> ring_attention_0_2
	k_proj_0_2 -> kv_send_0_2_7
	v_proj_0_2 -> kv_send_0_2_7
	kv_send_0_2_7 -> kv_recv_0_3_7 [style=dashed]
	k_proj_0_10 -> kv_recv_0_2_8 [style=dashed]
	v_proj_0_10 -> kv_recv_0_2_8 [style=dashed]
	kv_recv_0_2_8 -> ring_attention_0_2
	k_proj_0_2 -> kv_send_0_2_8
	v_proj_0_2 -> kv_send_0_2_8
	kv_send_0_2_8 -> kv_recv_0_3_8 [style=dashed]
	k_proj_0_9 -> kv_recv_0_2_9 [style=dashed]
	v_proj_0_9 -> kv_recv_0_2_9 [style=dashed]
	kv_recv_0_2_9 -> ring_attention_0_2
	k_proj_0_2 -> kv_send_0_2_9
	v_proj_0_2 -> kv_send_0_2_9
	kv_send_0_2_9 -> kv_recv_0_3_9 [style=dashed]
	k_proj_0_8 -> kv_recv_0_2_10 [style=dashed]
	v_proj_0_8 -> kv_recv_0_2_10 [style=dashed]
	kv_recv_0_2_10 -> ring_attention_0_2
	k_proj_0_2 -> kv_send_0_2_10
	v_proj_0_2 -> kv_send_0_2_10
	kv_send_0_2_10 -> kv_recv_0_3_10 [style=dashed]
	k_proj_0_7 -> kv_recv_0_2_11 [style=dashed]
	v_proj_0_7 -> kv_recv_0_2_11 [style=dashed]
	kv_recv_0_2_11 -> ring_attention_0_2
	k_proj_0_2 -> kv_send_0_2_11
	v_proj_0_2 -> kv_send_0_2_11
	kv_send_0_2_11 -> kv_recv_0_3_11 [style=dashed]
	k_proj_0_6 -> kv_recv_0_2_12 [style=dashed]
	v_proj_0_6 -> kv_recv_0_2_12 [style=dashed]
	kv_recv_0_2_12 -> ring_attention_0_2
	k_proj_0_2 -> kv_send_0_2_12
	v_proj_0_2 -> kv_send_0_2_12
	kv_send_0_2_12 -> kv_recv_0_3_12 [style=dashed]
	k_proj_0_5 -> kv_recv_0_2_13 [style=dashed]
	v_proj_0_5 -> kv_recv_0_2_13 [style=dashed]
	kv_recv_0_2_13 -> ring_attention_0_2
	k_proj_0_2 -> kv_send_0_2_13
	v_proj_0_2 -> kv_send_0_2_13
	kv_send_0_2_13 -> kv_recv_0_3_13 [style=dashed]
	k_proj_0_4 -> kv_recv_0_2_14 [style=dashed]
	v_proj_0_4 -> kv_recv_0_2_14 [style=dashed]
	kv_recv_0_2_14 -> ring_attention_0_2
	k_proj_0_2 -> kv_send_0_2_14
	v_proj_0_2 -> kv_send_0_2_14
	kv_send_0_2_14 -> kv_recv_0_3_14 [style=dashed]
	k_proj_0_3 -> kv_recv_0_2_15 [style=dashed]
	v_proj_0_3 -> kv_recv_0_2_15 [style=dashed]
	kv_recv_0_2_15 -> ring_attention_0_2
	k_proj_0_2 -> kv_send_0_2_15
	v_proj_0_2 -> kv_send_0_2_15
	kv_send_0_2_15 -> kv_recv_0_3_15 [style=dashed]
	ring_attention_0_2 -> o_proj_0_2
	o_proj_0_2 -> add_0_2
	embed_2 -> add_0_2
	add_0_2 -> mlp0_gate_2
	add_0_2 -> mlp0_up_2
	mlp0_gate_2 -> mlp0_down_2
	mlp0_up_2 -> mlp0_down_2
	mlp0_down_2 -> add_1_2
	add_0_2 -> add_1_2
	add_1_2 -> ln1_pre_2
	ln1_pre_2 -> q_proj_1_2
	ln1_pre_2 -> k_proj_1_2
	ln1_pre_2 -> v_proj_1_2
	q_proj_1_2 -> ring_attention_1_2
	k_proj_1_2 -> ring_attention_1_2
	v_proj_1_2 -> ring_attention_1_2
	k_proj_1_2 -> kv_recv_1_2_0 [style=dashed]
	v_proj_1_2 -> kv_recv_1_2_0 [style=dashed]
	kv_recv_1_2_0 -> ring_attention_1_2
	k_proj_1_2 -> kv_send_1_2_0
	v_proj_1_2 -> kv_send_1_2_0
	kv_send_1_2_0 -> kv_recv_1_3_0 [style=dashed]
	k_proj_1_1 -> kv_recv_1_2_1 [style=dashed]
	v_proj_1_1 -> kv_recv_1_2_1 [style=dashed]
	kv_recv_1_2_1 -> ring_attention_1_2
	k_proj_1_2 -> kv_send_1_2_1
	v_proj_1_2 -> kv_send_1_2_1
	kv_send_1_2_1 -> kv_recv_1_3_1 [style=dashed]
	k_proj_1_0 -> kv_recv_1_2_2 [style=dashed]
	v_proj_1_0 -> kv_recv_1_2_2 [style=dashed]
	kv_recv_1_2_2 -> ring_attention_1_2
	k_proj_1_2 -> kv_send_1_2_2
	v_proj_1_2 -> kv_send_1_2_2
	kv_send_1_2_2 -> kv_recv_1_3_2 [style=dashed]
	k_proj_1_15 -> kv_recv_1_2_3 [style=dashed]
	v_proj_1_15 -> kv_recv_1_2_3 [style=dashed]
	kv_recv_1_2_3 -> ring_attention_1_2
	k_proj_1_2 -> kv_send_1_2_3
	v_proj_1_2 -> kv_send_1_2_3
	kv_send_1_2_3 -> kv_recv_1_3_3 [style=dashed]
	k_proj_1_14 -> kv_recv_1_2_4 [style=dashed]
	v_proj_1_14 -> kv_recv_1_2_4 [style=dashed]
	kv_recv_1_2_4 -> ring_attention_1_2
	k_proj_1_2 -> kv_send_1_2_4
	v_proj_1_2 -> kv_send_1_2_4
	kv_send_1_2_4 -> kv_recv_1_3_4 [style=dashed]
	k_proj_1_13 -> kv_recv_1_2_5 [style=dashed]
	v_proj_1_13 -> kv_recv_1_2_5 [style=dashed]
	kv_recv_1_2_5 -> ring_attention_1_2
	k_proj_1_2 -> kv_send_1_2_5
	v_proj_1_2 -> kv_send_1_2_5
	kv_send_1_2_5 -> kv_recv_1_3_5 [style=dashed]
	k_proj_1_12 -> kv_recv_1_2_6 [style=dashed]
	v_proj_1_12 -> kv_recv_1_2_6 [style=dashed]
	kv_recv_1_2_6 -> ring_attention_1_2
	k_proj_1_2 -> kv_send_1_2_6
	v_proj_1_2 -> kv_send_1_2_6
	kv_send_1_2_6 -> kv_recv_1_3_6 [style=dashed]
	k_proj_1_11 -> kv_recv_1_2_7 [style=dashed]
	v_proj_1_11 -> kv_recv_1_2_7 [style=dashed]
	kv_recv_1_2_7 -> ring_attention_1_2
	k_proj_1_2 -> kv_send_1_2_7
	v_proj_1_2 -> kv_send_1_2_7
	kv_send_1_2_7 -> kv_recv_1_3_7 [style=dashed]
	k_proj_1_10 -> kv_recv_1_2_8 [style=dashed]
	v_proj_1_10 -> kv_recv_1_2_8 [style=dashed]
	kv_recv_1_2_8 -> ring_attention_1_2
	k_proj_1_2 -> kv_send_1_2_8
	v_proj_1_2 -> kv_send_1_2_8
	kv_send_1_2_8 -> kv_recv_1_3_8 [style=dashed]
	k_proj_1_9 -> kv_recv_1_2_9 [style=dashed]
	v_proj_1_9 -> kv_recv_1_2_9 [style=dashed]
	kv_recv_1_2_9 -> ring_attention_1_2
	k_proj_1_2 -> kv_send_1_2_9
	v_proj_1_2 -> kv_send_1_2_9
	kv_send_1_2_9 -> kv_recv_1_3_9 [style=dashed]
	k_proj_1_8 -> kv_recv_1_2_10 [style=dashed]
	v_proj_1_8 -> kv_recv_1_2_10 [style=dashed]
	kv_recv_1_2_10 -> ring_attention_1_2
	k_proj_1_2 -> kv_send_1_2_10
	v_proj_1_2 -> kv_send_1_2_10
	kv_send_1_2_10 -> kv_recv_1_3_10 [style=dashed]
	k_proj_1_7 -> kv_recv_1_2_11 [style=dashed]
	v_proj_1_7 -> kv_recv_1_2_11 [style=dashed]
	kv_recv_1_2_11 -> ring_attention_1_2
	k_proj_1_2 -> kv_send_1_2_11
	v_proj_1_2 -> kv_send_1_2_11
	kv_send_1_2_11 -> kv_recv_1_3_11 [style=dashed]
	k_proj_1_6 -> kv_recv_1_2_12 [style=dashed]
	v_proj_1_6 -> kv_recv_1_2_12 [style=dashed]
	kv_recv_1_2_12 -> ring_attention_1_2
	k_proj_1_2 -> kv_send_1_2_12
	v_proj_1_2 -> kv_send_1_2_12
	kv_send_1_2_12 -> kv_recv_1_3_12 [style=dashed]
	k_proj_1_5 -> kv_recv_1_2_13 [style=dashed]
	v_proj_1_5 -> kv_recv_1_2_13 [style=dashed]
	kv_recv_1_2_13 -> ring_attention_1_2
	k_proj_1_2 -> kv_send_1_2_13
	v_proj_1_2 -> kv_send_1_2_13
	kv_send_1_2_13 -> kv_recv_1_3_13 [style=dashed]
	k_proj_1_4 -> kv_recv_1_2_14 [style=dashed]
	v_proj_1_4 -> kv_recv_1_2_14 [style=dashed]
	kv_recv_1_2_14 -> ring_attention_1_2
	k_proj_1_2 -> kv_send_1_2_14
	v_proj_1_2 -> kv_send_1_2_14
	kv_send_1_2_14 -> kv_recv_1_3_14 [style=dashed]
	k_proj_1_3 -> kv_recv_1_2_15 [style=dashed]
	v_proj_1_3 -> kv_recv_1_2_15 [style=dashed]
	kv_recv_1_2_15 -> ring_attention_1_2
	k_proj_1_2 -> kv_send_1_2_15
	v_proj_1_2 -> kv_send_1_2_15
	kv_send_1_2_15 -> kv_recv_1_3_15 [style=dashed]
	ring_attention_1_2 -> o_proj_1_2
	o_proj_1_2 -> add_2_2
	add_1_2 -> add_2_2
	add_2_2 -> mlp1_gate_2
	add_2_2 -> mlp1_up_2
	mlp1_gate_2 -> mlp1_down_2
	mlp1_up_2 -> mlp1_down_2
	mlp1_down_2 -> add_3_2
	add_2_2 -> add_3_2
	add_3_2 -> ln2_pre_2
	ln2_pre_2 -> ring_attention_2_2
	ring_attention_2_2 -> o_proj_2_2
	o_proj_2_2 -> add_4_2
	add_3_2 -> add_4_2
	add_4_2 -> mlp2_down_2
	mlp2_down_2 -> add_5_2
	add_4_2 -> add_5_2
	add_5_2 -> ln3_pre_2
	ln3_pre_2 -> ring_attention_3_2
	ring_attention_3_2 -> o_proj_3_2
	o_proj_3_2 -> add_6_2
	add_5_2 -> add_6_2
	add_6_2 -> mlp3_down_2
	mlp3_down_2 -> add_7_2
	add_6_2 -> add_7_2
	add_7_2 -> output_gather_2
	output_gather_0 -> global_output
	output_gather_1 -> global_output
	output_gather_2 -> global_output
	output_gather_3 -> global_output
	output_gather_4 -> global_output
	output_gather_5 -> global_output
	output_gather_6 -> global_output
	output_gather_7 -> global_output
	output_gather_8 -> global_output
	output_gather_9 -> global_output
	output_gather_10 -> global_output
	output_gather_11 -> global_output
	output_gather_12 -> global_output
	output_gather_13 -> global_output
	output_gather_14 -> global_output
	output_gather_15 -> global_output
	global_input -> input_split_3
	input_split_3 -> embed_3
	embed_3 -> ln0_pre_3
	ln0_pre_3 -> q_proj_0_3
	ln0_pre_3 -> k_proj_0_3
	ln0_pre_3 -> v_proj_0_3
	q_proj_0_3 -> ring_attention_0_3
	k_proj_0_3 -> ring_attention_0_3
	v_proj_0_3 -> ring_attention_0_3
	k_proj_0_3 -> kv_recv_0_3_0 [style=dashed]
	v_proj_0_3 -> kv_recv_0_3_0 [style=dashed]
	kv_recv_0_3_0 -> ring_attention_0_3
	k_proj_0_3 -> kv_send_0_3_0
	v_proj_0_3 -> kv_send_0_3_0
	kv_send_0_3_0 -> kv_recv_0_4_0 [style=dashed]
	k_proj_0_2 -> kv_recv_0_3_1 [style=dashed]
	v_proj_0_2 -> kv_recv_0_3_1 [style=dashed]
	kv_recv_0_3_1 -> ring_attention_0_3
	k_proj_0_3 -> kv_send_0_3_1
	v_proj_0_3 -> kv_send_0_3_1
	kv_send_0_3_1 -> kv_recv_0_4_1 [style=dashed]
	k_proj_0_1 -> kv_recv_0_3_2 [style=dashed]
	v_proj_0_1 -> kv_recv_0_3_2 [style=dashed]
	kv_recv_0_3_2 -> ring_attention_0_3
	k_proj_0_3 -> kv_send_0_3_2
	v_proj_0_3 -> kv_send_0_3_2
	kv_send_0_3_2 -> kv_recv_0_4_2 [style=dashed]
	k_proj_0_0 -> kv_recv_0_3_3 [style=dashed]
	v_proj_0_0 -> kv_recv_0_3_3 [style=dashed]
	kv_recv_0_3_3 -> ring_attention_0_3
	k_proj_0_3 -> kv_send_0_3_3
	v_proj_0_3 -> kv_send_0_3_3
	kv_send_0_3_3 -> kv_recv_0_4_3 [style=dashed]
	k_proj_0_15 -> kv_recv_0_3_4 [style=dashed]
	v_proj_0_15 -> kv_recv_0_3_4 [style=dashed]
	kv_recv_0_3_4 -> ring_attention_0_3
	k_proj_0_3 -> kv_send_0_3_4
	v_proj_0_3 -> kv_send_0_3_4
	kv_send_0_3_4 -> kv_recv_0_4_4 [style=dashed]
	k_proj_0_14 -> kv_recv_0_3_5 [style=dashed]
	v_proj_0_14 -> kv_recv_0_3_5 [style=dashed]
	kv_recv_0_3_5 -> ring_attention_0_3
	k_proj_0_3 -> kv_send_0_3_5
	v_proj_0_3 -> kv_send_0_3_5
	kv_send_0_3_5 -> kv_recv_0_4_5 [style=dashed]
	k_proj_0_13 -> kv_recv_0_3_6 [style=dashed]
	v_proj_0_13 -> kv_recv_0_3_6 [style=dashed]
	kv_recv_0_3_6 -> ring_attention_0_3
	k_proj_0_3 -> kv_send_0_3_6
	v_proj_0_3 -> kv_send_0_3_6
	kv_send_0_3_6 -> kv_recv_0_4_6 [style=dashed]
	k_proj_0_12 -> kv_recv_0_3_7 [style=dashed]
	v_proj_0_12 -> kv_recv_0_3_7 [style=dashed]
	kv_recv_0_3_7 -> ring_attention_0_3
	k_proj_0_3 -> kv_send_0_3_7
	v_proj_0_3 -> kv_send_0_3_7
	kv_send_0_3_7 -> kv_recv_0_4_7 [style=dashed]
	k_proj_0_11 -> kv_recv_0_3_8 [style=dashed]
	v_proj_0_11 -> kv_recv_0_3_8 [style=dashed]
	kv_recv_0_3_8 -> ring_attention_0_3
	k_proj_0_3 -> kv_send_0_3_8
	v_proj_0_3 -> kv_send_0_3_8
	kv_send_0_3_8 -> kv_recv_0_4_8 [style=dashed]
	k_proj_0_10 -> kv_recv_0_3_9 [style=dashed]
	v_proj_0_10 -> kv_recv_0_3_9 [style=dashed]
	kv_recv_0_3_9 -> ring_attention_0_3
	k_proj_0_3 -> kv_send_0_3_9
	v_proj_0_3 -> kv_send_0_3_9
	kv_send_0_3_9 -> kv_recv_0_4_9 [style=dashed]
	k_proj_0_9 -> kv_recv_0_3_10 [style=dashed]
	v_proj_0_9 -> kv_recv_0_3_10 [style=dashed]
	kv_recv_0_3_10 -> ring_attention_0_3
	k_proj_0_3 -> kv_send_0_3_10
	v_proj_0_3 -> kv_send_0_3_10
	kv_send_0_3_10 -> kv_recv_0_4_10 [style=dashed]
	k_proj_0_8 -> kv_recv_0_3_11 [style=dashed]
	v_proj_0_8 -> kv_recv_0_3_11 [style=dashed]
	kv_recv_0_3_11 -> ring_attention_0_3
	k_proj_0_3 -> kv_send_0_3_11
	v_proj_0_3 -> kv_send_0_3_11
	kv_send_0_3_11 -> kv_recv_0_4_11 [style=dashed]
	k_proj_0_7 -> kv_recv_0_3_12 [style=dashed]
	v_proj_0_7 -> kv_recv_0_3_12 [style=dashed]
	kv_recv_0_3_12 -> ring_attention_0_3
	k_proj_0_3 -> kv_send_0_3_12
	v_proj_0_3 -> kv_send_0_3_12
	kv_send_0_3_12 -> kv_recv_0_4_12 [style=dashed]
	k_proj_0_6 -> kv_recv_0_3_13 [style=dashed]
	v_proj_0_6 -> kv_recv_0_3_13 [style=dashed]
	kv_recv_0_3_13 -> ring_attention_0_3
	k_proj_0_3 -> kv_send_0_3_13
	v_proj_0_3 -> kv_send_0_3_13
	kv_send_0_3_13 -> kv_recv_0_4_13 [style=dashed]
	k_proj_0_5 -> kv_recv_0_3_14 [style=dashed]
	v_proj_0_5 -> kv_recv_0_3_14 [style=dashed]
	kv_recv_0_3_14 -> ring_attention_0_3
	k_proj_0_3 -> kv_send_0_3_14
	v_proj_0_3 -> kv_send_0_3_14
	kv_send_0_3_14 -> kv_recv_0_4_14 [style=dashed]
	k_proj_0_4 -> kv_recv_0_3_15 [style=dashed]
	v_proj_0_4 -> kv_recv_0_3_15 [style=dashed]
	kv_recv_0_3_15 -> ring_attention_0_3
	k_proj_0_3 -> kv_send_0_3_15
	v_proj_0_3 -> kv_send_0_3_15
	kv_send_0_3_15 -> kv_recv_0_4_15 [style=dashed]
	ring_attention_0_3 -> o_proj_0_3
	o_proj_0_3 -> add_0_3
	embed_3 -> add_0_3
	add_0_3 -> mlp0_gate_3
	add_0_3 -> mlp0_up_3
	mlp0_gate_3 -> mlp0_down_3
	mlp0_up_3 -> mlp0_down_3
	mlp0_down_3 -> add_1_3
	add_0_3 -> add_1_3
	add_1_3 -> ln1_pre_3
	ln1_pre_3 -> q_proj_1_3
	ln1_pre_3 -> k_proj_1_3
	ln1_pre_3 -> v_proj_1_3
	q_proj_1_3 -> ring_attention_1_3
	k_proj_1_3 -> ring_attention_1_3
	v_proj_1_3 -> ring_attention_1_3
	k_proj_1_3 -> kv_recv_1_3_0 [style=dashed]
	v_proj_1_3 -> kv_recv_1_3_0 [style=dashed]
	kv_recv_1_3_0 -> ring_attention_1_3
	k_proj_1_3 -> kv_send_1_3_0
	v_proj_1_3 -> kv_send_1_3_0
	kv_send_1_3_0 -> kv_recv_1_4_0 [style=dashed]
	k_proj_1_2 -> kv_recv_1_3_1 [style=dashed]
	v_proj_1_2 -> kv_recv_1_3_1 [style=dashed]
	kv_recv_1_3_1 -> ring_attention_1_3
	k_proj_1_3 -> kv_send_1_3_1
	v_proj_1_3 -> kv_send_1_3_1
	kv_send_1_3_1 -> kv_recv_1_4_1 [style=dashed]
	k_proj_1_1 -> kv_recv_1_3_2 [style=dashed]
	v_proj_1_1 -> kv_recv_1_3_2 [style=dashed]
	kv_recv_1_3_2 -> ring_attention_1_3
	k_proj_1_3 -> kv_send_1_3_2
	v_proj_1_3 -> kv_send_1_3_2
	kv_send_1_3_2 -> kv_recv_1_4_2 [style=dashed]
	k_proj_1_0 -> kv_recv_1_3_3 [style=dashed]
	v_proj_1_0 -> kv_recv_1_3_3 [style=dashed]
	kv_recv_1_3_3 -> ring_attention_1_3
	k_proj_1_3 -> kv_send_1_3_3
	v_proj_1_3 -> kv_send_1_3_3
	kv_send_1_3_3 -> kv_recv_1_4_3 [style=dashed]
	k_proj_1_15 -> kv_recv_1_3_4 [style=dashed]
	v_proj_1_15 -> kv_recv_1_3_4 [style=dashed]
	kv_recv_1_3_4 -> ring_attention_1_3
	k_proj_1_3 -> kv_send_1_3_4
	v_proj_1_3 -> kv_send_1_3_4
	kv_send_1_3_4 -> kv_recv_1_4_4 [style=dashed]
	k_proj_1_14 -> kv_recv_1_3_5 [style=dashed]
	v_proj_1_14 -> kv_recv_1_3_5 [style=dashed]
	kv_recv_1_3_5 -> ring_attention_1_3
	k_proj_1_3 -> kv_send_1_3_5
	v_proj_1_3 -> kv_send_1_3_5
	kv_send_1_3_5 -> kv_recv_1_4_5 [style=dashed]
	k_proj_1_13 -> kv_recv_1_3_6 [style=dashed]
	v_proj_1_13 -> kv_recv_1_3_6 [style=dashed]
	kv_recv_1_3_6 -> ring_attention_1_3
	k_proj_1_3 -> kv_send_1_3_6
	v_proj_1_3 -> kv_send_1_3_6
	kv_send_1_3_6 -> kv_recv_1_4_6 [style=dashed]
	k_proj_1_12 -> kv_recv_1_3_7 [style=dashed]
	v_proj_1_12 -> kv_recv_1_3_7 [style=dashed]
	kv_recv_1_3_7 -> ring_attention_1_3
	k_proj_1_3 -> kv_send_1_3_7
	v_proj_1_3 -> kv_send_1_3_7
	kv_send_1_3_7 -> kv_recv_1_4_7 [style=dashed]
	k_proj_1_11 -> kv_recv_1_3_8 [style=dashed]
	v_proj_1_11 -> kv_recv_1_3_8 [style=dashed]
	kv_recv_1_3_8 -> ring_attention_1_3
	k_proj_1_3 -> kv_send_1_3_8
	v_proj_1_3 -> kv_send_1_3_8
	kv_send_1_3_8 -> kv_recv_1_4_8 [style=dashed]
	k_proj_1_10 -> kv_recv_1_3_9 [style=dashed]
	v_proj_1_10 -> kv_recv_1_3_9 [style=dashed]
	kv_recv_1_3_9 -> ring_attention_1_3
	k_proj_1_3 -> kv_send_1_3_9
	v_proj_1_3 -> kv_send_1_3_9
	kv_send_1_3_9 -> kv_recv_1_4_9 [style=dashed]
	k_proj_1_9 -> kv_recv_1_3_10 [style=dashed]
	v_proj_1_9 -> kv_recv_1_3_10 [style=dashed]
	kv_recv_1_3_10 -> ring_attention_1_3
	k_proj_1_3 -> kv_send_1_3_10
	v_proj_1_3 -> kv_send_1_3_10
	kv_send_1_3_10 -> kv_recv_1_4_10 [style=dashed]
	k_proj_1_8 -> kv_recv_1_3_11 [style=dashed]
	v_proj_1_8 -> kv_recv_1_3_11 [style=dashed]
	kv_recv_1_3_11 -> ring_attention_1_3
	k_proj_1_3 -> kv_send_1_3_11
	v_proj_1_3 -> kv_send_1_3_11
	kv_send_1_3_11 -> kv_recv_1_4_11 [style=dashed]
	k_proj_1_7 -> kv_recv_1_3_12 [style=dashed]
	v_proj_1_7 -> kv_recv_1_3_12 [style=dashed]
	kv_recv_1_3_12 -> ring_attention_1_3
	k_proj_1_3 -> kv_send_1_3_12
	v_proj_1_3 -> kv_send_1_3_12
	kv_send_1_3_12 -> kv_recv_1_4_12 [style=dashed]
	k_proj_1_6 -> kv_recv_1_3_13 [style=dashed]
	v_proj_1_6 -> kv_recv_1_3_13 [style=dashed]
	kv_recv_1_3_13 -> ring_attention_1_3
	k_proj_1_3 -> kv_send_1_3_13
	v_proj_1_3 -> kv_send_1_3_13
	kv_send_1_3_13 -> kv_recv_1_4_13 [style=dashed]
	k_proj_1_5 -> kv_recv_1_3_14 [style=dashed]
	v_proj_1_5 -> kv_recv_1_3_14 [style=dashed]
	kv_recv_1_3_14 -> ring_attention_1_3
	k_proj_1_3 -> kv_send_1_3_14
	v_proj_1_3 -> kv_send_1_3_14
	kv_send_1_3_14 -> kv_recv_1_4_14 [style=dashed]
	k_proj_1_4 -> kv_recv_1_3_15 [style=dashed]
	v_proj_1_4 -> kv_recv_1_3_15 [style=dashed]
	kv_recv_1_3_15 -> ring_attention_1_3
	k_proj_1_3 -> kv_send_1_3_15
	v_proj_1_3 -> kv_send_1_3_15
	kv_send_1_3_15 -> kv_recv_1_4_15 [style=dashed]
	ring_attention_1_3 -> o_proj_1_3
	o_proj_1_3 -> add_2_3
	add_1_3 -> add_2_3
	add_2_3 -> mlp1_gate_3
	add_2_3 -> mlp1_up_3
	mlp1_gate_3 -> mlp1_down_3
	mlp1_up_3 -> mlp1_down_3
	mlp1_down_3 -> add_3_3
	add_2_3 -> add_3_3
	add_3_3 -> ln2_pre_3
	ln2_pre_3 -> ring_attention_2_3
	ring_attention_2_3 -> o_proj_2_3
	o_proj_2_3 -> add_4_3
	add_3_3 -> add_4_3
	add_4_3 -> mlp2_down_3
	mlp2_down_3 -> add_5_3
	add_4_3 -> add_5_3
	add_5_3 -> ln3_pre_3
	ln3_pre_3 -> ring_attention_3_3
	ring_attention_3_3 -> o_proj_3_3
	o_proj_3_3 -> add_6_3
	add_5_3 -> add_6_3
	add_6_3 -> mlp3_down_3
	mlp3_down_3 -> add_7_3
	add_6_3 -> add_7_3
	add_7_3 -> output_gather_3
	output_gather_0 -> global_output
	output_gather_1 -> global_output
	output_gather_2 -> global_output
	output_gather_3 -> global_output
	output_gather_4 -> global_output
	output_gather_5 -> global_output
	output_gather_6 -> global_output
	output_gather_7 -> global_output
	output_gather_8 -> global_output
	output_gather_9 -> global_output
	output_gather_10 -> global_output
	output_gather_11 -> global_output
	output_gather_12 -> global_output
	output_gather_13 -> global_output
	output_gather_14 -> global_output
	output_gather_15 -> global_output
	global_input -> input_split_4
	input_split_4 -> embed_4
	embed_4 -> ln0_pre_4
	ln0_pre_4 -> q_proj_0_4
	ln0_pre_4 -> k_proj_0_4
	ln0_pre_4 -> v_proj_0_4
	q_proj_0_4 -> ring_attention_0_4
	k_proj_0_4 -> ring_attention_0_4
	v_proj_0_4 -> ring_attention_0_4
	k_proj_0_4 -> kv_recv_0_4_0 [style=dashed]
	v_proj_0_4 -> kv_recv_0_4_0 [style=dashed]
	kv_recv_0_4_0 -> ring_attention_0_4
	k_proj_0_4 -> kv_send_0_4_0
	v_proj_0_4 -> kv_send_0_4_0
	kv_send_0_4_0 -> kv_recv_0_5_0 [style=dashed]
	k_proj_0_3 -> kv_recv_0_4_1 [style=dashed]
	v_proj_0_3 -> kv_recv_0_4_1 [style=dashed]
	kv_recv_0_4_1 -> ring_attention_0_4
	k_proj_0_4 -> kv_send_0_4_1
	v_proj_0_4 -> kv_send_0_4_1
	kv_send_0_4_1 -> kv_recv_0_5_1 [style=dashed]
	k_proj_0_2 -> kv_recv_0_4_2 [style=dashed]
	v_proj_0_2 -> kv_recv_0_4_2 [style=dashed]
	kv_recv_0_4_2 -> ring_attention_0_4
	k_proj_0_4 -> kv_send_0_4_2
	v_proj_0_4 -> kv_send_0_4_2
	kv_send_0_4_2 -> kv_recv_0_5_2 [style=dashed]
	k_proj_0_1 -> kv_recv_0_4_3 [style=dashed]
	v_proj_0_1 -> kv_recv_0_4_3 [style=dashed]
	kv_recv_0_4_3 -> ring_attention_0_4
	k_proj_0_4 -> kv_send_0_4_3
	v_proj_0_4 -> kv_send_0_4_3
	kv_send_0_4_3 -> kv_recv_0_5_3 [style=dashed]
	k_proj_0_0 -> kv_recv_0_4_4 [style=dashed]
	v_proj_0_0 -> kv_recv_0_4_4 [style=dashed]
	kv_recv_0_4_4 -> ring_attention_0_4
	k_proj_0_4 -> kv_send_0_4_4
	v_proj_0_4 -> kv_send_0_4_4
	kv_send_0_4_4 -> kv_recv_0_5_4 [style=dashed]
	k_proj_0_15 -> kv_recv_0_4_5 [style=dashed]
	v_proj_0_15 -> kv_recv_0_4_5 [style=dashed]
	kv_recv_0_4_5 -> ring_attention_0_4
	k_proj_0_4 -> kv_send_0_4_5
	v_proj_0_4 -> kv_send_0_4_5
	kv_send_0_4_5 -> kv_recv_0_5_5 [style=dashed]
	k_proj_0_14 -> kv_recv_0_4_6 [style=dashed]
	v_proj_0_14 -> kv_recv_0_4_6 [style=dashed]
	kv_recv_0_4_6 -> ring_attention_0_4
	k_proj_0_4 -> kv_send_0_4_6
	v_proj_0_4 -> kv_send_0_4_6
	kv_send_0_4_6 -> kv_recv_0_5_6 [style=dashed]
	k_proj_0_13 -> kv_recv_0_4_7 [style=dashed]
	v_proj_0_13 -> kv_recv_0_4_7 [style=dashed]
	kv_recv_0_4_7 -> ring_attention_0_4
	k_proj_0_4 -> kv_send_0_4_7
	v_proj_0_4 -> kv_send_0_4_7
	kv_send_0_4_7 -> kv_recv_0_5_7 [style=dashed]
	k_proj_0_12 -> kv_recv_0_4_8 [style=dashed]
	v_proj_0_12 -> kv_recv_0_4_8 [style=dashed]
	kv_recv_0_4_8 -> ring_attention_0_4
	k_proj_0_4 -> kv_send_0_4_8
	v_proj_0_4 -> kv_send_0_4_8
	kv_send_0_4_8 -> kv_recv_0_5_8 [style=dashed]
	k_proj_0_11 -> kv_recv_0_4_9 [style=dashed]
	v_proj_0_11 -> kv_recv_0_4_9 [style=dashed]
	kv_recv_0_4_9 -> ring_attention_0_4
	k_proj_0_4 -> kv_send_0_4_9
	v_proj_0_4 -> kv_send_0_4_9
	kv_send_0_4_9 -> kv_recv_0_5_9 [style=dashed]
	k_proj_0_10 -> kv_recv_0_4_10 [style=dashed]
	v_proj_0_10 -> kv_recv_0_4_10 [style=dashed]
	kv_recv_0_4_10 -> ring_attention_0_4
	k_proj_0_4 -> kv_send_0_4_10
	v_proj_0_4 -> kv_send_0_4_10
	kv_send_0_4_10 -> kv_recv_0_5_10 [style=dashed]
	k_proj_0_9 -> kv_recv_0_4_11 [style=dashed]
	v_proj_0_9 -> kv_recv_0_4_11 [style=dashed]
	kv_recv_0_4_11 -> ring_attention_0_4
	k_proj_0_4 -> kv_send_0_4_11
	v_proj_0_4 -> kv_send_0_4_11
	kv_send_0_4_11 -> kv_recv_0_5_11 [style=dashed]
	k_proj_0_8 -> kv_recv_0_4_12 [style=dashed]
	v_proj_0_8 -> kv_recv_0_4_12 [style=dashed]
	kv_recv_0_4_12 -> ring_attention_0_4
	k_proj_0_4 -> kv_send_0_4_12
	v_proj_0_4 -> kv_send_0_4_12
	kv_send_0_4_12 -> kv_recv_0_5_12 [style=dashed]
	k_proj_0_7 -> kv_recv_0_4_13 [style=dashed]
	v_proj_0_7 -> kv_recv_0_4_13 [style=dashed]
	kv_recv_0_4_13 -> ring_attention_0_4
	k_proj_0_4 -> kv_send_0_4_13
	v_proj_0_4 -> kv_send_0_4_13
	kv_send_0_4_13 -> kv_recv_0_5_13 [style=dashed]
	k_proj_0_6 -> kv_recv_0_4_14 [style=dashed]
	v_proj_0_6 -> kv_recv_0_4_14 [style=dashed]
	kv_recv_0_4_14 -> ring_attention_0_4
	k_proj_0_4 -> kv_send_0_4_14
	v_proj_0_4 -> kv_send_0_4_14
	kv_send_0_4_14 -> kv_recv_0_5_14 [style=dashed]
	k_proj_0_5 -> kv_recv_0_4_15 [style=dashed]
	v_proj_0_5 -> kv_recv_0_4_15 [style=dashed]
	kv_recv_0_4_15 -> ring_attention_0_4
	k_proj_0_4 -> kv_send_0_4_15
	v_proj_0_4 -> kv_send_0_4_15
	kv_send_0_4_15 -> kv_recv_0_5_15 [style=dashed]
	ring_attention_0_4 -> o_proj_0_4
	o_proj_0_4 -> add_0_4
	embed_4 -> add_0_4
	add_0_4 -> mlp0_gate_4
	add_0_4 -> mlp0_up_4
	mlp0_gate_4 -> mlp0_down_4
	mlp0_up_4 -> mlp0_down_4
	mlp0_down_4 -> add_1_4
	add_0_4 -> add_1_4
	add_1_4 -> ln1_pre_4
	ln1_pre_4 -> q_proj_1_4
	ln1_pre_4 -> k_proj_1_4
	ln1_pre_4 -> v_proj_1_4
	q_proj_1_4 -> ring_attention_1_4
	k_proj_1_4 -> ring_attention_1_4
	v_proj_1_4 -> ring_attention_1_4
	k_proj_1_4 -> kv_recv_1_4_0 [style=dashed]
	v_proj_1_4 -> kv_recv_1_4_0 [style=dashed]
	kv_recv_1_4_0 -> ring_attention_1_4
	k_proj_1_4 -> kv_send_1_4_0
	v_proj_1_4 -> kv_send_1_4_0
	kv_send_1_4_0 -> kv_recv_1_5_0 [style=dashed]
	k_proj_1_3 -> kv_recv_1_4_1 [style=dashed]
	v_proj_1_3 -> kv_recv_1_4_1 [style=dashed]
	kv_recv_1_4_1 -> ring_attention_1_4
	k_proj_1_4 -> kv_send_1_4_1
	v_proj_1_4 -> kv_send_1_4_1
	kv_send_1_4_1 -> kv_recv_1_5_1 [style=dashed]
	k_proj_1_2 -> kv_recv_1_4_2 [style=dashed]
	v_proj_1_2 -> kv_recv_1_4_2 [style=dashed]
	kv_recv_1_4_2 -> ring_attention_1_4
	k_proj_1_4 -> kv_send_1_4_2
	v_proj_1_4 -> kv_send_1_4_2
	kv_send_1_4_2 -> kv_recv_1_5_2 [style=dashed]
	k_proj_1_1 -> kv_recv_1_4_3 [style=dashed]
	v_proj_1_1 -> kv_recv_1_4_3 [style=dashed]
	kv_recv_1_4_3 -> ring_attention_1_4
	k_proj_1_4 -> kv_send_1_4_3
	v_proj_1_4 -> kv_send_1_4_3
	kv_send_1_4_3 -> kv_recv_1_5_3 [style=dashed]
	k_proj_1_0 -> kv_recv_1_4_4 [style=dashed]
	v_proj_1_0 -> kv_recv_1_4_4 [style=dashed]
	kv_recv_1_4_4 -> ring_attention_1_4
	k_proj_1_4 -> kv_send_1_4_4
	v_proj_1_4 -> kv_send_1_4_4
	kv_send_1_4_4 -> kv_recv_1_5_4 [style=dashed]
	k_proj_1_15 -> kv_recv_1_4_5 [style=dashed]
	v_proj_1_15 -> kv_recv_1_4_5 [style=dashed]
	kv_recv_1_4_5 -> ring_attention_1_4
	k_proj_1_4 -> kv_send_1_4_5
	v_proj_1_4 -> kv_send_1_4_5
	kv_send_1_4_5 -> kv_recv_1_5_5 [style=dashed]
	k_proj_1_14 -> kv_recv_1_4_6 [style=dashed]
	v_proj_1_14 -> kv_recv_1_4_6 [style=dashed]
	kv_recv_1_4_6 -> ring_attention_1_4
	k_proj_1_4 -> kv_send_1_4_6
	v_proj_1_4 -> kv_send_1_4_6
	kv_send_1_4_6 -> kv_recv_1_5_6 [style=dashed]
	k_proj_1_13 -> kv_recv_1_4_7 [style=dashed]
	v_proj_1_13 -> kv_recv_1_4_7 [style=dashed]
	kv_recv_1_4_7 -> ring_attention_1_4
	k_proj_1_4 -> kv_send_1_4_7
	v_proj_1_4 -> kv_send_1_4_7
	kv_send_1_4_7 -> kv_recv_1_5_7 [style=dashed]
	k_proj_1_12 -> kv_recv_1_4_8 [style=dashed]
	v_proj_1_12 -> kv_recv_1_4_8 [style=dashed]
	kv_recv_1_4_8 -> ring_attention_1_4
	k_proj_1_4 -> kv_send_1_4_8
	v_proj_1_4 -> kv_send_1_4_8
	kv_send_1_4_8 -> kv_recv_1_5_8 [style=dashed]
	k_proj_1_11 -> kv_recv_1_4_9 [style=dashed]
	v_proj_1_11 -> kv_recv_1_4_9 [style=dashed]
	kv_recv_1_4_9 -> ring_attention_1_4
	k_proj_1_4 -> kv_send_1_4_9
	v_proj_1_4 -> kv_send_1_4_9
	kv_send_1_4_9 -> kv_recv_1_5_9 [style=dashed]
	k_proj_1_10 -> kv_recv_1_4_10 [style=dashed]
	v_proj_1_10 -> kv_recv_1_4_10 [style=dashed]
	kv_recv_1_4_10 -> ring_attention_1_4
	k_proj_1_4 -> kv_send_1_4_10
	v_proj_1_4 -> kv_send_1_4_10
	kv_send_1_4_10 -> kv_recv_1_5_10 [style=dashed]
	k_proj_1_9 -> kv_recv_1_4_11 [style=dashed]
	v_proj_1_9 -> kv_recv_1_4_11 [style=dashed]
	kv_recv_1_4_11 -> ring_attention_1_4
	k_proj_1_4 -> kv_send_1_4_11
	v_proj_1_4 -> kv_send_1_4_11
	kv_send_1_4_11 -> kv_recv_1_5_11 [style=dashed]
	k_proj_1_8 -> kv_recv_1_4_12 [style=dashed]
	v_proj_1_8 -> kv_recv_1_4_12 [style=dashed]
	kv_recv_1_4_12 -> ring_attention_1_4
	k_proj_1_4 -> kv_send_1_4_12
	v_proj_1_4 -> kv_send_1_4_12
	kv_send_1_4_12 -> kv_recv_1_5_12 [style=dashed]
	k_proj_1_7 -> kv_recv_1_4_13 [style=dashed]
	v_proj_1_7 -> kv_recv_1_4_13 [style=dashed]
	kv_recv_1_4_13 -> ring_attention_1_4
	k_proj_1_4 -> kv_send_1_4_13
	v_proj_1_4 -> kv_send_1_4_13
	kv_send_1_4_13 -> kv_recv_1_5_13 [style=dashed]
	k_proj_1_6 -> kv_recv_1_4_14 [style=dashed]
	v_proj_1_6 -> kv_recv_1_4_14 [style=dashed]
	kv_recv_1_4_14 -> ring_attention_1_4
	k_proj_1_4 -> kv_send_1_4_14
	v_proj_1_4 -> kv_send_1_4_14
	kv_send_1_4_14 -> kv_recv_1_5_14 [style=dashed]
	k_proj_1_5 -> kv_recv_1_4_15 [style=dashed]
	v_proj_1_5 -> kv_recv_1_4_15 [style=dashed]
	kv_recv_1_4_15 -> ring_attention_1_4
	k_proj_1_4 -> kv_send_1_4_15
	v_proj_1_4 -> kv_send_1_4_15
	kv_send_1_4_15 -> kv_recv_1_5_15 [style=dashed]
	ring_attention_1_4 -> o_proj_1_4
	o_proj_1_4 -> add_2_4
	add_1_4 -> add_2_4
	add_2_4 -> mlp1_gate_4
	add_2_4 -> mlp1_up_4
	mlp1_gate_4 -> mlp1_down_4
	mlp1_up_4 -> mlp1_down_4
	mlp1_down_4 -> add_3_4
	add_2_4 -> add_3_4
	add_3_4 -> ln2_pre_4
	ln2_pre_4 -> ring_attention_2_4
	ring_attention_2_4 -> o_proj_2_4
	o_proj_2_4 -> add_4_4
	add_3_4 -> add_4_4
	add_4_4 -> mlp2_down_4
	mlp2_down_4 -> add_5_4
	add_4_4 -> add_5_4
	add_5_4 -> ln3_pre_4
	ln3_pre_4 -> ring_attention_3_4
	ring_attention_3_4 -> o_proj_3_4
	o_proj_3_4 -> add_6_4
	add_5_4 -> add_6_4
	add_6_4 -> mlp3_down_4
	mlp3_down_4 -> add_7_4
	add_6_4 -> add_7_4
	add_7_4 -> output_gather_4
	output_gather_0 -> global_output
	output_gather_1 -> global_output
	output_gather_2 -> global_output
	output_gather_3 -> global_output
	output_gather_4 -> global_output
	output_gather_5 -> global_output
	output_gather_6 -> global_output
	output_gather_7 -> global_output
	output_gather_8 -> global_output
	output_gather_9 -> global_output
	output_gather_10 -> global_output
	output_gather_11 -> global_output
	output_gather_12 -> global_output
	output_gather_13 -> global_output
	output_gather_14 -> global_output
	output_gather_15 -> global_output
	global_input -> input_split_5
	input_split_5 -> embed_5
	embed_5 -> ln0_pre_5
	ln0_pre_5 -> q_proj_0_5
	ln0_pre_5 -> k_proj_0_5
	ln0_pre_5 -> v_proj_0_5
	q_proj_0_5 -> ring_attention_0_5
	k_proj_0_5 -> ring_attention_0_5
	v_proj_0_5 -> ring_attention_0_5
	k_proj_0_5 -> kv_recv_0_5_0 [style=dashed]
	v_proj_0_5 -> kv_recv_0_5_0 [style=dashed]
	kv_recv_0_5_0 -> ring_attention_0_5
	k_proj_0_5 -> kv_send_0_5_0
	v_proj_0_5 -> kv_send_0_5_0
	kv_send_0_5_0 -> kv_recv_0_6_0 [style=dashed]
	k_proj_0_4 -> kv_recv_0_5_1 [style=dashed]
	v_proj_0_4 -> kv_recv_0_5_1 [style=dashed]
	kv_recv_0_5_1 -> ring_attention_0_5
	k_proj_0_5 -> kv_send_0_5_1
	v_proj_0_5 -> kv_send_0_5_1
	kv_send_0_5_1 -> kv_recv_0_6_1 [style=dashed]
	k_proj_0_3 -> kv_recv_0_5_2 [style=dashed]
	v_proj_0_3 -> kv_recv_0_5_2 [style=dashed]
	kv_recv_0_5_2 -> ring_attention_0_5
	k_proj_0_5 -> kv_send_0_5_2
	v_proj_0_5 -> kv_send_0_5_2
	kv_send_0_5_2 -> kv_recv_0_6_2 [style=dashed]
	k_proj_0_2 -> kv_recv_0_5_3 [style=dashed]
	v_proj_0_2 -> kv_recv_0_5_3 [style=dashed]
	kv_recv_0_5_3 -> ring_attention_0_5
	k_proj_0_5 -> kv_send_0_5_3
	v_proj_0_5 -> kv_send_0_5_3
	kv_send_0_5_3 -> kv_recv_0_6_3 [style=dashed]
	k_proj_0_1 -> kv_recv_0_5_4 [style=dashed]
	v_proj_0_1 -> kv_recv_0_5_4 [style=dashed]
	kv_recv_0_5_4 -> ring_attention_0_5
	k_proj_0_5 -> kv_send_0_5_4
	v_proj_0_5 -> kv_send_0_5_4
	kv_send_0_5_4 -> kv_recv_0_6_4 [style=dashed]
	k_proj_0_0 -> kv_recv_0_5_5 [style=dashed]
	v_proj_0_0 -> kv_recv_0_5_5 [style=dashed]
	kv_recv_0_5_5 -> ring_attention_0_5
	k_proj_0_5 -> kv_send_0_5_5
	v_proj_0_5 -> kv_send_0_5_5
	kv_send_0_5_5 -> kv_recv_0_6_5 [style=dashed]
	k_proj_0_15 -> kv_recv_0_5_6 [style=dashed]
	v_proj_0_15 -> kv_recv_0_5_6 [style=dashed]
	kv_recv_0_5_6 -> ring_attention_0_5
	k_proj_0_5 -> kv_send_0_5_6
	v_proj_0_5 -> kv_send_0_5_6
	kv_send_0_5_6 -> kv_recv_0_6_6 [style=dashed]
	k_proj_0_14 -> kv_recv_0_5_7 [style=dashed]
	v_proj_0_14 -> kv_recv_0_5_7 [style=dashed]
	kv_recv_0_5_7 -> ring_attention_0_5
	k_proj_0_5 -> kv_send_0_5_7
	v_proj_0_5 -> kv_send_0_5_7
	kv_send_0_5_7 -> kv_recv_0_6_7 [style=dashed]
	k_proj_0_13 -> kv_recv_0_5_8 [style=dashed]
	v_proj_0_13 -> kv_recv_0_5_8 [style=dashed]
	kv_recv_0_5_8 -> ring_attention_0_5
	k_proj_0_5 -> kv_send_0_5_8
	v_proj_0_5 -> kv_send_0_5_8
	kv_send_0_5_8 -> kv_recv_0_6_8 [style=dashed]
	k_proj_0_12 -> kv_recv_0_5_9 [style=dashed]
	v_proj_0_12 -> kv_recv_0_5_9 [style=dashed]
	kv_recv_0_5_9 -> ring_attention_0_5
	k_proj_0_5 -> kv_send_0_5_9
	v_proj_0_5 -> kv_send_0_5_9
	kv_send_0_5_9 -> kv_recv_0_6_9 [style=dashed]
	k_proj_0_11 -> kv_recv_0_5_10 [style=dashed]
	v_proj_0_11 -> kv_recv_0_5_10 [style=dashed]
	kv_recv_0_5_10 -> ring_attention_0_5
	k_proj_0_5 -> kv_send_0_5_10
	v_proj_0_5 -> kv_send_0_5_10
	kv_send_0_5_10 -> kv_recv_0_6_10 [style=dashed]
	k_proj_0_10 -> kv_recv_0_5_11 [style=dashed]
	v_proj_0_10 -> kv_recv_0_5_11 [style=dashed]
	kv_recv_0_5_11 -> ring_attention_0_5
	k_proj_0_5 -> kv_send_0_5_11
	v_proj_0_5 -> kv_send_0_5_11
	kv_send_0_5_11 -> kv_recv_0_6_11 [style=dashed]
	k_proj_0_9 -> kv_recv_0_5_12 [style=dashed]
	v_proj_0_9 -> kv_recv_0_5_12 [style=dashed]
	kv_recv_0_5_12 -> ring_attention_0_5
	k_proj_0_5 -> kv_send_0_5_12
	v_proj_0_5 -> kv_send_0_5_12
	kv_send_0_5_12 -> kv_recv_0_6_12 [style=dashed]
	k_proj_0_8 -> kv_recv_0_5_13 [style=dashed]
	v_proj_0_8 -> kv_recv_0_5_13 [style=dashed]
	kv_recv_0_5_13 -> ring_attention_0_5
	k_proj_0_5 -> kv_send_0_5_13
	v_proj_0_5 -> kv_send_0_5_13
	kv_send_0_5_13 -> kv_recv_0_6_13 [style=dashed]
	k_proj_0_7 -> kv_recv_0_5_14 [style=dashed]
	v_proj_0_7 -> kv_recv_0_5_14 [style=dashed]
	kv_recv_0_5_14 -> ring_attention_0_5
	k_proj_0_5 -> kv_send_0_5_14
	v_proj_0_5 -> kv_send_0_5_14
	kv_send_0_5_14 -> kv_recv_0_6_14 [style=dashed]
	k_proj_0_6 -> kv_recv_0_5_15 [style=dashed]
	v_proj_0_6 -> kv_recv_0_5_15 [style=dashed]
	kv_recv_0_5_15 -> ring_attention_0_5
	k_proj_0_5 -> kv_send_0_5_15
	v_proj_0_5 -> kv_send_0_5_15
	kv_send_0_5_15 -> kv_recv_0_6_15 [style=dashed]
	ring_attention_0_5 -> o_proj_0_5
	o_proj_0_5 -> add_0_5
	embed_5 -> add_0_5
	add_0_5 -> mlp0_gate_5
	add_0_5 -> mlp0_up_5
	mlp0_gate_5 -> mlp0_down_5
	mlp0_up_5 -> mlp0_down_5
	mlp0_down_5 -> add_1_5
	add_0_5 -> add_1_5
	add_1_5 -> ln1_pre_5
	ln1_pre_5 -> q_proj_1_5
	ln1_pre_5 -> k_proj_1_5
	ln1_pre_5 -> v_proj_1_5
	q_proj_1_5 -> ring_attention_1_5
	k_proj_1_5 -> ring_attention_1_5
	v_proj_1_5 -> ring_attention_1_5
	k_proj_1_5 -> kv_recv_1_5_0 [style=dashed]
	v_proj_1_5 -> kv_recv_1_5_0 [style=dashed]
	kv_recv_1_5_0 -> ring_attention_1_5
	k_proj_1_5 -> kv_send_1_5_0
	v_proj_1_5 -> kv_send_1_5_0
	kv_send_1_5_0 -> kv_recv_1_6_0 [style=dashed]
	k_proj_1_4 -> kv_recv_1_5_1 [style=dashed]
	v_proj_1_4 -> kv_recv_1_5_1 [style=dashed]
	kv_recv_1_5_1 -> ring_attention_1_5
	k_proj_1_5 -> kv_send_1_5_1
	v_proj_1_5 -> kv_send_1_5_1
	kv_send_1_5_1 -> kv_recv_1_6_1 [style=dashed]
	k_proj_1_3 -> kv_recv_1_5_2 [style=dashed]
	v_proj_1_3 -> kv_recv_1_5_2 [style=dashed]
	kv_recv_1_5_2 -> ring_attention_1_5
	k_proj_1_5 -> kv_send_1_5_2
	v_proj_1_5 -> kv_send_1_5_2
	kv_send_1_5_2 -> kv_recv_1_6_2 [style=dashed]
	k_proj_1_2 -> kv_recv_1_5_3 [style=dashed]
	v_proj_1_2 -> kv_recv_1_5_3 [style=dashed]
	kv_recv_1_5_3 -> ring_attention_1_5
	k_proj_1_5 -> kv_send_1_5_3
	v_proj_1_5 -> kv_send_1_5_3
	kv_send_1_5_3 -> kv_recv_1_6_3 [style=dashed]
	k_proj_1_1 -> kv_recv_1_5_4 [style=dashed]
	v_proj_1_1 -> kv_recv_1_5_4 [style=dashed]
	kv_recv_1_5_4 -> ring_attention_1_5
	k_proj_1_5 -> kv_send_1_5_4
	v_proj_1_5 -> kv_send_1_5_4
	kv_send_1_5_4 -> kv_recv_1_6_4 [style=dashed]
	k_proj_1_0 -> kv_recv_1_5_5 [style=dashed]
	v_proj_1_0 -> kv_recv_1_5_5 [style=dashed]
	kv_recv_1_5_5 -> ring_attention_1_5
	k_proj_1_5 -> kv_send_1_5_5
	v_proj_1_5 -> kv_send_1_5_5
	kv_send_1_5_5 -> kv_recv_1_6_5 [style=dashed]
	k_proj_1_15 -> kv_recv_1_5_6 [style=dashed]
	v_proj_1_15 -> kv_recv_1_5_6 [style=dashed]
	kv_recv_1_5_6 -> ring_attention_1_5
	k_proj_1_5 -> kv_send_1_5_6
	v_proj_1_5 -> kv_send_1_5_6
	kv_send_1_5_6 -> kv_recv_1_6_6 [style=dashed]
	k_proj_1_14 -> kv_recv_1_5_7 [style=dashed]
	v_proj_1_14 -> kv_recv_1_5_7 [style=dashed]
	kv_recv_1_5_7 -> ring_attention_1_5
	k_proj_1_5 -> kv_send_1_5_7
	v_proj_1_5 -> kv_send_1_5_7
	kv_send_1_5_7 -> kv_recv_1_6_7 [style=dashed]
	k_proj_1_13 -> kv_recv_1_5_8 [style=dashed]
	v_proj_1_13 -> kv_recv_1_5_8 [style=dashed]
	kv_recv_1_5_8 -> ring_attention_1_5
	k_proj_1_5 -> kv_send_1_5_8
	v_proj_1_5 -> kv_send_1_5_8
	kv_send_1_5_8 -> kv_recv_1_6_8 [style=dashed]
	k_proj_1_12 -> kv_recv_1_5_9 [style=dashed]
	v_proj_1_12 -> kv_recv_1_5_9 [style=dashed]
	kv_recv_1_5_9 -> ring_attention_1_5
	k_proj_1_5 -> kv_send_1_5_9
	v_proj_1_5 -> kv_send_1_5_9
	kv_send_1_5_9 -> kv_recv_1_6_9 [style=dashed]
	k_proj_1_11 -> kv_recv_1_5_10 [style=dashed]
	v_proj_1_11 -> kv_recv_1_5_10 [style=dashed]
	kv_recv_1_5_10 -> ring_attention_1_5
	k_proj_1_5 -> kv_send_1_5_10
	v_proj_1_5 -> kv_send_1_5_10
	kv_send_1_5_10 -> kv_recv_1_6_10 [style=dashed]
	k_proj_1_10 -> kv_recv_1_5_11 [style=dashed]
	v_proj_1_10 -> kv_recv_1_5_11 [style=dashed]
	kv_recv_1_5_11 -> ring_attention_1_5
	k_proj_1_5 -> kv_send_1_5_11
	v_proj_1_5 -> kv_send_1_5_11
	kv_send_1_5_11 -> kv_recv_1_6_11 [style=dashed]
	k_proj_1_9 -> kv_recv_1_5_12 [style=dashed]
	v_proj_1_9 -> kv_recv_1_5_12 [style=dashed]
	kv_recv_1_5_12 -> ring_attention_1_5
	k_proj_1_5 -> kv_send_1_5_12
	v_proj_1_5 -> kv_send_1_5_12
	kv_send_1_5_12 -> kv_recv_1_6_12 [style=dashed]
	k_proj_1_8 -> kv_recv_1_5_13 [style=dashed]
	v_proj_1_8 -> kv_recv_1_5_13 [style=dashed]
	kv_recv_1_5_13 -> ring_attention_1_5
	k_proj_1_5 -> kv_send_1_5_13
	v_proj_1_5 -> kv_send_1_5_13
	kv_send_1_5_13 -> kv_recv_1_6_13 [style=dashed]
	k_proj_1_7 -> kv_recv_1_5_14 [style=dashed]
	v_proj_1_7 -> kv_recv_1_5_14 [style=dashed]
	kv_recv_1_5_14 -> ring_attention_1_5
	k_proj_1_5 -> kv_send_1_5_14
	v_proj_1_5 -> kv_send_1_5_14
	kv_send_1_5_14 -> kv_recv_1_6_14 [style=dashed]
	k_proj_1_6 -> kv_recv_1_5_15 [style=dashed]
	v_proj_1_6 -> kv_recv_1_5_15 [style=dashed]
	kv_recv_1_5_15 -> ring_attention_1_5
	k_proj_1_5 -> kv_send_1_5_15
	v_proj_1_5 -> kv_send_1_5_15
	kv_send_1_5_15 -> kv_recv_1_6_15 [style=dashed]
	ring_attention_1_5 -> o_proj_1_5
	o_proj_1_5 -> add_2_5
	add_1_5 -> add_2_5
	add_2_5 -> mlp1_gate_5
	add_2_5 -> mlp1_up_5
	mlp1_gate_5 -> mlp1_down_5
	mlp1_up_5 -> mlp1_down_5
	mlp1_down_5 -> add_3_5
	add_2_5 -> add_3_5
	add_3_5 -> ln2_pre_5
	ln2_pre_5 -> ring_attention_2_5
	ring_attention_2_5 -> o_proj_2_5
	o_proj_2_5 -> add_4_5
	add_3_5 -> add_4_5
	add_4_5 -> mlp2_down_5
	mlp2_down_5 -> add_5_5
	add_4_5 -> add_5_5
	add_5_5 -> ln3_pre_5
	ln3_pre_5 -> ring_attention_3_5
	ring_attention_3_5 -> o_proj_3_5
	o_proj_3_5 -> add_6_5
	add_5_5 -> add_6_5
	add_6_5 -> mlp3_down_5
	mlp3_down_5 -> add_7_5
	add_6_5 -> add_7_5
	add_7_5 -> output_gather_5
	output_gather_0 -> global_output
	output_gather_1 -> global_output
	output_gather_2 -> global_output
	output_gather_3 -> global_output
	output_gather_4 -> global_output
	output_gather_5 -> global_output
	output_gather_6 -> global_output
	output_gather_7 -> global_output
	output_gather_8 -> global_output
	output_gather_9 -> global_output
	output_gather_10 -> global_output
	output_gather_11 -> global_output
	output_gather_12 -> global_output
	output_gather_13 -> global_output
	output_gather_14 -> global_output
	output_gather_15 -> global_output
	global_input -> input_split_6
	input_split_6 -> embed_6
	embed_6 -> ln0_pre_6
	ln0_pre_6 -> q_proj_0_6
	ln0_pre_6 -> k_proj_0_6
	ln0_pre_6 -> v_proj_0_6
	q_proj_0_6 -> ring_attention_0_6
	k_proj_0_6 -> ring_attention_0_6
	v_proj_0_6 -> ring_attention_0_6
	k_proj_0_6 -> kv_recv_0_6_0 [style=dashed]
	v_proj_0_6 -> kv_recv_0_6_0 [style=dashed]
	kv_recv_0_6_0 -> ring_attention_0_6
	k_proj_0_6 -> kv_send_0_6_0
	v_proj_0_6 -> kv_send_0_6_0
	kv_send_0_6_0 -> kv_recv_0_7_0 [style=dashed]
	k_proj_0_5 -> kv_recv_0_6_1 [style=dashed]
	v_proj_0_5 -> kv_recv_0_6_1 [style=dashed]
	kv_recv_0_6_1 -> ring_attention_0_6
	k_proj_0_6 -> kv_send_0_6_1
	v_proj_0_6 -> kv_send_0_6_1
	kv_send_0_6_1 -> kv_recv_0_7_1 [style=dashed]
	k_proj_0_4 -> kv_recv_0_6_2 [style=dashed]
	v_proj_0_4 -> kv_recv_0_6_2 [style=dashed]
	kv_recv_0_6_2 -> ring_attention_0_6
	k_proj_0_6 -> kv_send_0_6_2
	v_proj_0_6 -> kv_send_0_6_2
	kv_send_0_6_2 -> kv_recv_0_7_2 [style=dashed]
	k_proj_0_3 -> kv_recv_0_6_3 [style=dashed]
	v_proj_0_3 -> kv_recv_0_6_3 [style=dashed]
	kv_recv_0_6_3 -> ring_attention_0_6
	k_proj_0_6 -> kv_send_0_6_3
	v_proj_0_6 -> kv_send_0_6_3
	kv_send_0_6_3 -> kv_recv_0_7_3 [style=dashed]
	k_proj_0_2 -> kv_recv_0_6_4 [style=dashed]
	v_proj_0_2 -> kv_recv_0_6_4 [style=dashed]
	kv_recv_0_6_4 -> ring_attention_0_6
	k_proj_0_6 -> kv_send_0_6_4
	v_proj_0_6 -> kv_send_0_6_4
	kv_send_0_6_4 -> kv_recv_0_7_4 [style=dashed]
	k_proj_0_1 -> kv_recv_0_6_5 [style=dashed]
	v_proj_0_1 -> kv_recv_0_6_5 [style=dashed]
	kv_recv_0_6_5 -> ring_attention_0_6
	k_proj_0_6 -> kv_send_0_6_5
	v_proj_0_6 -> kv_send_0_6_5
	kv_send_0_6_5 -> kv_recv_0_7_5 [style=dashed]
	k_proj_0_0 -> kv_recv_0_6_6 [style=dashed]
	v_proj_0_0 -> kv_recv_0_6_6 [style=dashed]
	kv_recv_0_6_6 -> ring_attention_0_6
	k_proj_0_6 -> kv_send_0_6_6
	v_proj_0_6 -> kv_send_0_6_6
	kv_send_0_6_6 -> kv_recv_0_7_6 [style=dashed]
	k_proj_0_15 -> kv_recv_0_6_7 [style=dashed]
	v_proj_0_15 -> kv_recv_0_6_7 [style=dashed]
	kv_recv_0_6_7 -> ring_attention_0_6
	k_proj_0_6 -> kv_send_0_6_7
	v_proj_0_6 -> kv_send_0_6_7
	kv_send_0_6_7 -> kv_recv_0_7_7 [style=dashed]
	k_proj_0_14 -> kv_recv_0_6_8 [style=dashed]
	v_proj_0_14 -> kv_recv_0_6_8 [style=dashed]
	kv_recv_0_6_8 -> ring_attention_0_6
	k_proj_0_6 -> kv_send_0_6_8
	v_proj_0_6 -> kv_send_0_6_8
	kv_send_0_6_8 -> kv_recv_0_7_8 [style=dashed]
	k_proj_0_13 -> kv_recv_0_6_9 [style=dashed]
	v_proj_0_13 -> kv_recv_0_6_9 [style=dashed]
	kv_recv_0_6_9 -> ring_attention_0_6
	k_proj_0_6 -> kv_send_0_6_9
	v_proj_0_6 -> kv_send_0_6_9
	kv_send_0_6_9 -> kv_recv_0_7_9 [style=dashed]
	k_proj_0_12 -> kv_recv_0_6_10 [style=dashed]
	v_proj_0_12 -> kv_recv_0_6_10 [style=dashed]
	kv_recv_0_6_10 -> ring_attention_0_6
	k_proj_0_6 -> kv_send_0_6_10
	v_proj_0_6 -> kv_send_0_6_10
	kv_send_0_6_10 -> kv_recv_0_7_10 [style=dashed]
	k_proj_0_11 -> kv_recv_0_6_11 [style=dashed]
	v_proj_0_11 -> kv_recv_0_6_11 [style=dashed]
	kv_recv_0_6_11 -> ring_attention_0_6
	k_proj_0_6 -> kv_send_0_6_11
	v_proj_0_6 -> kv_send_0_6_11
	kv_send_0_6_11 -> kv_recv_0_7_11 [style=dashed]
	k_proj_0_10 -> kv_recv_0_6_12 [style=dashed]
	v_proj_0_10 -> kv_recv_0_6_12 [style=dashed]
	kv_recv_0_6_12 -> ring_attention_0_6
	k_proj_0_6 -> kv_send_0_6_12
	v_proj_0_6 -> kv_send_0_6_12
	kv_send_0_6_12 -> kv_recv_0_7_12 [style=dashed]
	k_proj_0_9 -> kv_recv_0_6_13 [style=dashed]
	v_proj_0_9 -> kv_recv_0_6_13 [style=dashed]
	kv_recv_0_6_13 -> ring_attention_0_6
	k_proj_0_6 -> kv_send_0_6_13
	v_proj_0_6 -> kv_send_0_6_13
	kv_send_0_6_13 -> kv_recv_0_7_13 [style=dashed]
	k_proj_0_8 -> kv_recv_0_6_14 [style=dashed]
	v_proj_0_8 -> kv_recv_0_6_14 [style=dashed]
	kv_recv_0_6_14 -> ring_attention_0_6
	k_proj_0_6 -> kv_send_0_6_14
	v_proj_0_6 -> kv_send_0_6_14
	kv_send_0_6_14 -> kv_recv_0_7_14 [style=dashed]
	k_proj_0_7 -> kv_recv_0_6_15 [style=dashed]
	v_proj_0_7 -> kv_recv_0_6_15 [style=dashed]
	kv_recv_0_6_15 -> ring_attention_0_6
	k_proj_0_6 -> kv_send_0_6_15
	v_proj_0_6 -> kv_send_0_6_15
	kv_send_0_6_15 -> kv_recv_0_7_15 [style=dashed]
	ring_attention_0_6 -> o_proj_0_6
	o_proj_0_6 -> add_0_6
	embed_6 -> add_0_6
	add_0_6 -> mlp0_gate_6
	add_0_6 -> mlp0_up_6
	mlp0_gate_6 -> mlp0_down_6
	mlp0_up_6 -> mlp0_down_6
	mlp0_down_6 -> add_1_6
	add_0_6 -> add_1_6
	add_1_6 -> ln1_pre_6
	ln1_pre_6 -> q_proj_1_6
	ln1_pre_6 -> k_proj_1_6
	ln1_pre_6 -> v_proj_1_6
	q_proj_1_6 -> ring_attention_1_6
	k_proj_1_6 -> ring_attention_1_6
	v_proj_1_6 -> ring_attention_1_6
	k_proj_1_6 -> kv_recv_1_6_0 [style=dashed]
	v_proj_1_6 -> kv_recv_1_6_0 [style=dashed]
	kv_recv_1_6_0 -> ring_attention_1_6
	k_proj_1_6 -> kv_send_1_6_0
	v_proj_1_6 -> kv_send_1_6_0
	kv_send_1_6_0 -> kv_recv_1_7_0 [style=dashed]
	k_proj_1_5 -> kv_recv_1_6_1 [style=dashed]
	v_proj_1_5 -> kv_recv_1_6_1 [style=dashed]
	kv_recv_1_6_1 -> ring_attention_1_6
	k_proj_1_6 -> kv_send_1_6_1
	v_proj_1_6 -> kv_send_1_6_1
	kv_send_1_6_1 -> kv_recv_1_7_1 [style=dashed]
	k_proj_1_4 -> kv_recv_1_6_2 [style=dashed]
	v_proj_1_4 -> kv_recv_1_6_2 [style=dashed]
	kv_recv_1_6_2 -> ring_attention_1_6
	k_proj_1_6 -> kv_send_1_6_2
	v_proj_1_6 -> kv_send_1_6_2
	kv_send_1_6_2 -> kv_recv_1_7_2 [style=dashed]
	k_proj_1_3 -> kv_recv_1_6_3 [style=dashed]
	v_proj_1_3 -> kv_recv_1_6_3 [style=dashed]
	kv_recv_1_6_3 -> ring_attention_1_6
	k_proj_1_6 -> kv_send_1_6_3
	v_proj_1_6 -> kv_send_1_6_3
	kv_send_1_6_3 -> kv_recv_1_7_3 [style=dashed]
	k_proj_1_2 -> kv_recv_1_6_4 [style=dashed]
	v_proj_1_2 -> kv_recv_1_6_4 [style=dashed]
	kv_recv_1_6_4 -> ring_attention_1_6
	k_proj_1_6 -> kv_send_1_6_4
	v_proj_1_6 -> kv_send_1_6_4
	kv_send_1_6_4 -> kv_recv_1_7_4 [style=dashed]
	k_proj_1_1 -> kv_recv_1_6_5 [style=dashed]
	v_proj_1_1 -> kv_recv_1_6_5 [style=dashed]
	kv_recv_1_6_5 -> ring_attention_1_6
	k_proj_1_6 -> kv_send_1_6_5
	v_proj_1_6 -> kv_send_1_6_5
	kv_send_1_6_5 -> kv_recv_1_7_5 [style=dashed]
	k_proj_1_0 -> kv_recv_1_6_6 [style=dashed]
	v_proj_1_0 -> kv_recv_1_6_6 [style=dashed]
	kv_recv_1_6_6 -> ring_attention_1_6
	k_proj_1_6 -> kv_send_1_6_6
	v_proj_1_6 -> kv_send_1_6_6
	kv_send_1_6_6 -> kv_recv_1_7_6 [style=dashed]
	k_proj_1_15 -> kv_recv_1_6_7 [style=dashed]
	v_proj_1_15 -> kv_recv_1_6_7 [style=dashed]
	kv_recv_1_6_7 -> ring_attention_1_6
	k_proj_1_6 -> kv_send_1_6_7
	v_proj_1_6 -> kv_send_1_6_7
	kv_send_1_6_7 -> kv_recv_1_7_7 [style=dashed]
	k_proj_1_14 -> kv_recv_1_6_8 [style=dashed]
	v_proj_1_14 -> kv_recv_1_6_8 [style=dashed]
	kv_recv_1_6_8 -> ring_attention_1_6
	k_proj_1_6 -> kv_send_1_6_8
	v_proj_1_6 -> kv_send_1_6_8
	kv_send_1_6_8 -> kv_recv_1_7_8 [style=dashed]
	k_proj_1_13 -> kv_recv_1_6_9 [style=dashed]
	v_proj_1_13 -> kv_recv_1_6_9 [style=dashed]
	kv_recv_1_6_9 -> ring_attention_1_6
	k_proj_1_6 -> kv_send_1_6_9
	v_proj_1_6 -> kv_send_1_6_9
	kv_send_1_6_9 -> kv_recv_1_7_9 [style=dashed]
	k_proj_1_12 -> kv_recv_1_6_10 [style=dashed]
	v_proj_1_12 -> kv_recv_1_6_10 [style=dashed]
	kv_recv_1_6_10 -> ring_attention_1_6
	k_proj_1_6 -> kv_send_1_6_10
	v_proj_1_6 -> kv_send_1_6_10
	kv_send_1_6_10 -> kv_recv_1_7_10 [style=dashed]
	k_proj_1_11 -> kv_recv_1_6_11 [style=dashed]
	v_proj_1_11 -> kv_recv_1_6_11 [style=dashed]
	kv_recv_1_6_11 -> ring_attention_1_6
	k_proj_1_6 -> kv_send_1_6_11
	v_proj_1_6 -> kv_send_1_6_11
	kv_send_1_6_11 -> kv_recv_1_7_11 [style=dashed]
	k_proj_1_10 -> kv_recv_1_6_12 [style=dashed]
	v_proj_1_10 -> kv_recv_1_6_12 [style=dashed]
	kv_recv_1_6_12 -> ring_attention_1_6
	k_proj_1_6 -> kv_send_1_6_12
	v_proj_1_6 -> kv_send_1_6_12
	kv_send_1_6_12 -> kv_recv_1_7_12 [style=dashed]
	k_proj_1_9 -> kv_recv_1_6_13 [style=dashed]
	v_proj_1_9 -> kv_recv_1_6_13 [style=dashed]
	kv_recv_1_6_13 -> ring_attention_1_6
	k_proj_1_6 -> kv_send_1_6_13
	v_proj_1_6 -> kv_send_1_6_13
	kv_send_1_6_13 -> kv_recv_1_7_13 [style=dashed]
	k_proj_1_8 -> kv_recv_1_6_14 [style=dashed]
	v_proj_1_8 -> kv_recv_1_6_14 [style=dashed]
	kv_recv_1_6_14 -> ring_attention_1_6
	k_proj_1_6 -> kv_send_1_6_14
	v_proj_1_6 -> kv_send_1_6_14
	kv_send_1_6_14 -> kv_recv_1_7_14 [style=dashed]
	k_proj_1_7 -> kv_recv_1_6_15 [style=dashed]
	v_proj_1_7 -> kv_recv_1_6_15 [style=dashed]
	kv_recv_1_6_15 -> ring_attention_1_6
	k_proj_1_6 -> kv_send_1_6_15
	v_proj_1_6 -> kv_send_1_6_15
	kv_send_1_6_15 -> kv_recv_1_7_15 [style=dashed]
	ring_attention_1_6 -> o_proj_1_6
	o_proj_1_6 -> add_2_6
	add_1_6 -> add_2_6
	add_2_6 -> mlp1_gate_6
	add_2_6 -> mlp1_up_6
	mlp1_gate_6 -> mlp1_down_6
	mlp1_up_6 -> mlp1_down_6
	mlp1_down_6 -> add_3_6
	add_2_6 -> add_3_6
	add_3_6 -> ln2_pre_6
	ln2_pre_6 -> ring_attention_2_6
	ring_attention_2_6 -> o_proj_2_6
	o_proj_2_6 -> add_4_6
	add_3_6 -> add_4_6
	add_4_6 -> mlp2_down_6
	mlp2_down_6 -> add_5_6
	add_4_6 -> add_5_6
	add_5_6 -> ln3_pre_6
	ln3_pre_6 -> ring_attention_3_6
	ring_attention_3_6 -> o_proj_3_6
	o_proj_3_6 -> add_6_6
	add_5_6 -> add_6_6
	add_6_6 -> mlp3_down_6
	mlp3_down_6 -> add_7_6
	add_6_6 -> add_7_6
	add_7_6 -> output_gather_6
	output_gather_0 -> global_output
	output_gather_1 -> global_output
	output_gather_2 -> global_output
	output_gather_3 -> global_output
	output_gather_4 -> global_output
	output_gather_5 -> global_output
	output_gather_6 -> global_output
	output_gather_7 -> global_output
	output_gather_8 -> global_output
	output_gather_9 -> global_output
	output_gather_10 -> global_output
	output_gather_11 -> global_output
	output_gather_12 -> global_output
	output_gather_13 -> global_output
	output_gather_14 -> global_output
	output_gather_15 -> global_output
	global_input -> input_split_7
	input_split_7 -> embed_7
	embed_7 -> ln0_pre_7
	ln0_pre_7 -> q_proj_0_7
	ln0_pre_7 -> k_proj_0_7
	ln0_pre_7 -> v_proj_0_7
	q_proj_0_7 -> ring_attention_0_7
	k_proj_0_7 -> ring_attention_0_7
	v_proj_0_7 -> ring_attention_0_7
	k_proj_0_7 -> kv_recv_0_7_0 [style=dashed]
	v_proj_0_7 -> kv_recv_0_7_0 [style=dashed]
	kv_recv_0_7_0 -> ring_attention_0_7
	k_proj_0_7 -> kv_send_0_7_0
	v_proj_0_7 -> kv_send_0_7_0
	kv_send_0_7_0 -> kv_recv_0_8_0 [style=dashed]
	k_proj_0_6 -> kv_recv_0_7_1 [style=dashed]
	v_proj_0_6 -> kv_recv_0_7_1 [style=dashed]
	kv_recv_0_7_1 -> ring_attention_0_7
	k_proj_0_7 -> kv_send_0_7_1
	v_proj_0_7 -> kv_send_0_7_1
	kv_send_0_7_1 -> kv_recv_0_8_1 [style=dashed]
	k_proj_0_5 -> kv_recv_0_7_2 [style=dashed]
	v_proj_0_5 -> kv_recv_0_7_2 [style=dashed]
	kv_recv_0_7_2 -> ring_attention_0_7
	k_proj_0_7 -> kv_send_0_7_2
	v_proj_0_7 -> kv_send_0_7_2
	kv_send_0_7_2 -> kv_recv_0_8_2 [style=dashed]
	k_proj_0_4 -> kv_recv_0_7_3 [style=dashed]
	v_proj_0_4 -> kv_recv_0_7_3 [style=dashed]
	kv_recv_0_7_3 -> ring_attention_0_7
	k_proj_0_7 -> kv_send_0_7_3
	v_proj_0_7 -> kv_send_0_7_3
	kv_send_0_7_3 -> kv_recv_0_8_3 [style=dashed]
	k_proj_0_3 -> kv_recv_0_7_4 [style=dashed]
	v_proj_0_3 -> kv_recv_0_7_4 [style=dashed]
	kv_recv_0_7_4 -> ring_attention_0_7
	k_proj_0_7 -> kv_send_0_7_4
	v_proj_0_7 -> kv_send_0_7_4
	kv_send_0_7_4 -> kv_recv_0_8_4 [style=dashed]
	k_proj_0_2 -> kv_recv_0_7_5 [style=dashed]
	v_proj_0_2 -> kv_recv_0_7_5 [style=dashed]
	kv_recv_0_7_5 -> ring_attention_0_7
	k_proj_0_7 -> kv_send_0_7_5
	v_proj_0_7 -> kv_send_0_7_5
	kv_send_0_7_5 -> kv_recv_0_8_5 [style=dashed]
	k_proj_0_1 -> kv_recv_0_7_6 [style=dashed]
	v_proj_0_1 -> kv_recv_0_7_6 [style=dashed]
	kv_recv_0_7_6 -> ring_attention_0_7
	k_proj_0_7 -> kv_send_0_7_6
	v_proj_0_7 -> kv_send_0_7_6
	kv_send_0_7_6 -> kv_recv_0_8_6 [style=dashed]
	k_proj_0_0 -> kv_recv_0_7_7 [style=dashed]
	v_proj_0_0 -> kv_recv_0_7_7 [style=dashed]
	kv_recv_0_7_7 -> ring_attention_0_7
	k_proj_0_7 -> kv_send_0_7_7
	v_proj_0_7 -> kv_send_0_7_7
	kv_send_0_7_7 -> kv_recv_0_8_7 [style=dashed]
	k_proj_0_15 -> kv_recv_0_7_8 [style=dashed]
	v_proj_0_15 -> kv_recv_0_7_8 [style=dashed]
	kv_recv_0_7_8 -> ring_attention_0_7
	k_proj_0_7 -> kv_send_0_7_8
	v_proj_0_7 -> kv_send_0_7_8
	kv_send_0_7_8 -> kv_recv_0_8_8 [style=dashed]
	k_proj_0_14 -> kv_recv_0_7_9 [style=dashed]
	v_proj_0_14 -> kv_recv_0_7_9 [style=dashed]
	kv_recv_0_7_9 -> ring_attention_0_7
	k_proj_0_7 -> kv_send_0_7_9
	v_proj_0_7 -> kv_send_0_7_9
	kv_send_0_7_9 -> kv_recv_0_8_9 [style=dashed]
	k_proj_0_13 -> kv_recv_0_7_10 [style=dashed]
	v_proj_0_13 -> kv_recv_0_7_10 [style=dashed]
	kv_recv_0_7_10 -> ring_attention_0_7
	k_proj_0_7 -> kv_send_0_7_10
	v_proj_0_7 -> kv_send_0_7_10
	kv_send_0_7_10 -> kv_recv_0_8_10 [style=dashed]
	k_proj_0_12 -> kv_recv_0_7_11 [style=dashed]
	v_proj_0_12 -> kv_recv_0_7_11 [style=dashed]
	kv_recv_0_7_11 -> ring_attention_0_7
	k_proj_0_7 -> kv_send_0_7_11
	v_proj_0_7 -> kv_send_0_7_11
	kv_send_0_7_11 -> kv_recv_0_8_11 [style=dashed]
	k_proj_0_11 -> kv_recv_0_7_12 [style=dashed]
	v_proj_0_11 -> kv_recv_0_7_12 [style=dashed]
	kv_recv_0_7_12 -> ring_attention_0_7
	k_proj_0_7 -> kv_send_0_7_12
	v_proj_0_7 -> kv_send_0_7_12
	kv_send_0_7_12 -> kv_recv_0_8_12 [style=dashed]
	k_proj_0_10 -> kv_recv_0_7_13 [style=dashed]
	v_proj_0_10 -> kv_recv_0_7_13 [style=dashed]
	kv_recv_0_7_13 -> ring_attention_0_7
	k_proj_0_7 -> kv_send_0_7_13
	v_proj_0_7 -> kv_send_0_7_13
	kv_send_0_7_13 -> kv_recv_0_8_13 [style=dashed]
	k_proj_0_9 -> kv_recv_0_7_14 [style=dashed]
	v_proj_0_9 -> kv_recv_0_7_14 [style=dashed]
	kv_recv_0_7_14 -> ring_attention_0_7
	k_proj_0_7 -> kv_send_0_7_14
	v_proj_0_7 -> kv_send_0_7_14
	kv_send_0_7_14 -> kv_recv_0_8_14 [style=dashed]
	k_proj_0_8 -> kv_recv_0_7_15 [style=dashed]
	v_proj_0_8 -> kv_recv_0_7_15 [style=dashed]
	kv_recv_0_7_15 -> ring_attention_0_7
	k_proj_0_7 -> kv_send_0_7_15
	v_proj_0_7 -> kv_send_0_7_15
	kv_send_0_7_15 -> kv_recv_0_8_15 [style=dashed]
	ring_attention_0_7 -> o_proj_0_7
	o_proj_0_7 -> add_0_7
	embed_7 -> add_0_7
	add_0_7 -> mlp0_gate_7
	add_0_7 -> mlp0_up_7
	mlp0_gate_7 -> mlp0_down_7
	mlp0_up_7 -> mlp0_down_7
	mlp0_down_7 -> add_1_7
	add_0_7 -> add_1_7
	add_1_7 -> ln1_pre_7
	ln1_pre_7 -> q_proj_1_7
	ln1_pre_7 -> k_proj_1_7
	ln1_pre_7 -> v_proj_1_7
	q_proj_1_7 -> ring_attention_1_7
	k_proj_1_7 -> ring_attention_1_7
	v_proj_1_7 -> ring_attention_1_7
	k_proj_1_7 -> kv_recv_1_7_0 [style=dashed]
	v_proj_1_7 -> kv_recv_1_7_0 [style=dashed]
	kv_recv_1_7_0 -> ring_attention_1_7
	k_proj_1_7 -> kv_send_1_7_0
	v_proj_1_7 -> kv_send_1_7_0
	kv_send_1_7_0 -> kv_recv_1_8_0 [style=dashed]
	k_proj_1_6 -> kv_recv_1_7_1 [style=dashed]
	v_proj_1_6 -> kv_recv_1_7_1 [style=dashed]
	kv_recv_1_7_1 -> ring_attention_1_7
	k_proj_1_7 -> kv_send_1_7_1
	v_proj_1_7 -> kv_send_1_7_1
	kv_send_1_7_1 -> kv_recv_1_8_1 [style=dashed]
	k_proj_1_5 -> kv_recv_1_7_2 [style=dashed]
	v_proj_1_5 -> kv_recv_1_7_2 [style=dashed]
	kv_recv_1_7_2 -> ring_attention_1_7
	k_proj_1_7 -> kv_send_1_7_2
	v_proj_1_7 -> kv_send_1_7_2
	kv_send_1_7_2 -> kv_recv_1_8_2 [style=dashed]
	k_proj_1_4 -> kv_recv_1_7_3 [style=dashed]
	v_proj_1_4 -> kv_recv_1_7_3 [style=dashed]
	kv_recv_1_7_3 -> ring_attention_1_7
	k_proj_1_7 -> kv_send_1_7_3
	v_proj_1_7 -> kv_send_1_7_3
	kv_send_1_7_3 -> kv_recv_1_8_3 [style=dashed]
	k_proj_1_3 -> kv_recv_1_7_4 [style=dashed]
	v_proj_1_3 -> kv_recv_1_7_4 [style=dashed]
	kv_recv_1_7_4 -> ring_attention_1_7
	k_proj_1_7 -> kv_send_1_7_4
	v_proj_1_7 -> kv_send_1_7_4
	kv_send_1_7_4 -> kv_recv_1_8_4 [style=dashed]
	k_proj_1_2 -> kv_recv_1_7_5 [style=dashed]
	v_proj_1_2 -> kv_recv_1_7_5 [style=dashed]
	kv_recv_1_7_5 -> ring_attention_1_7
	k_proj_1_7 -> kv_send_1_7_5
	v_proj_1_7 -> kv_send_1_7_5
	kv_send_1_7_5 -> kv_recv_1_8_5 [style=dashed]
	k_proj_1_1 -> kv_recv_1_7_6 [style=dashed]
	v_proj_1_1 -> kv_recv_1_7_6 [style=dashed]
	kv_recv_1_7_6 -> ring_attention_1_7
	k_proj_1_7 -> kv_send_1_7_6
	v_proj_1_7 -> kv_send_1_7_6
	kv_send_1_7_6 -> kv_recv_1_8_6 [style=dashed]
	k_proj_1_0 -> kv_recv_1_7_7 [style=dashed]
	v_proj_1_0 -> kv_recv_1_7_7 [style=dashed]
	kv_recv_1_7_7 -> ring_attention_1_7
	k_proj_1_7 -> kv_send_1_7_7
	v_proj_1_7 -> kv_send_1_7_7
	kv_send_1_7_7 -> kv_recv_1_8_7 [style=dashed]
	k_proj_1_15 -> kv_recv_1_7_8 [style=dashed]
	v_proj_1_15 -> kv_recv_1_7_8 [style=dashed]
	kv_recv_1_7_8 -> ring_attention_1_7
	k_proj_1_7 -> kv_send_1_7_8
	v_proj_1_7 -> kv_send_1_7_8
	kv_send_1_7_8 -> kv_recv_1_8_8 [style=dashed]
	k_proj_1_14 -> kv_recv_1_7_9 [style=dashed]
	v_proj_1_14 -> kv_recv_1_7_9 [style=dashed]
	kv_recv_1_7_9 -> ring_attention_1_7
	k_proj_1_7 -> kv_send_1_7_9
	v_proj_1_7 -> kv_send_1_7_9
	kv_send_1_7_9 -> kv_recv_1_8_9 [style=dashed]
	k_proj_1_13 -> kv_recv_1_7_10 [style=dashed]
	v_proj_1_13 -> kv_recv_1_7_10 [style=dashed]
	kv_recv_1_7_10 -> ring_attention_1_7
	k_proj_1_7 -> kv_send_1_7_10
	v_proj_1_7 -> kv_send_1_7_10
	kv_send_1_7_10 -> kv_recv_1_8_10 [style=dashed]
	k_proj_1_12 -> kv_recv_1_7_11 [style=dashed]
	v_proj_1_12 -> kv_recv_1_7_11 [style=dashed]
	kv_recv_1_7_11 -> ring_attention_1_7
	k_proj_1_7 -> kv_send_1_7_11
	v_proj_1_7 -> kv_send_1_7_11
	kv_send_1_7_11 -> kv_recv_1_8_11 [style=dashed]
	k_proj_1_11 -> kv_recv_1_7_12 [style=dashed]
	v_proj_1_11 -> kv_recv_1_7_12 [style=dashed]
	kv_recv_1_7_12 -> ring_attention_1_7
	k_proj_1_7 -> kv_send_1_7_12
	v_proj_1_7 -> kv_send_1_7_12
	kv_send_1_7_12 -> kv_recv_1_8_12 [style=dashed]
	k_proj_1_10 -> kv_recv_1_7_13 [style=dashed]
	v_proj_1_10 -> kv_recv_1_7_13 [style=dashed]
	kv_recv_1_7_13 -> ring_attention_1_7
	k_proj_1_7 -> kv_send_1_7_13
	v_proj_1_7 -> kv_send_1_7_13
	kv_send_1_7_13 -> kv_recv_1_8_13 [style=dashed]
	k_proj_1_9 -> kv_recv_1_7_14 [style=dashed]
	v_proj_1_9 -> kv_recv_1_7_14 [style=dashed]
	kv_recv_1_7_14 -> ring_attention_1_7
	k_proj_1_7 -> kv_send_1_7_14
	v_proj_1_7 -> kv_send_1_7_14
	kv_send_1_7_14 -> kv_recv_1_8_14 [style=dashed]
	k_proj_1_8 -> kv_recv_1_7_15 [style=dashed]
	v_proj_1_8 -> kv_recv_1_7_15 [style=dashed]
	kv_recv_1_7_15 -> ring_attention_1_7
	k_proj_1_7 -> kv_send_1_7_15
	v_proj_1_7 -> kv_send_1_7_15
	kv_send_1_7_15 -> kv_recv_1_8_15 [style=dashed]
	ring_attention_1_7 -> o_proj_1_7
	o_proj_1_7 -> add_2_7
	add_1_7 -> add_2_7
	add_2_7 -> mlp1_gate_7
	add_2_7 -> mlp1_up_7
	mlp1_gate_7 -> mlp1_down_7
	mlp1_up_7 -> mlp1_down_7
	mlp1_down_7 -> add_3_7
	add_2_7 -> add_3_7
	add_3_7 -> ln2_pre_7
	ln2_pre_7 -> ring_attention_2_7
	ring_attention_2_7 -> o_proj_2_7
	o_proj_2_7 -> add_4_7
	add_3_7 -> add_4_7
	add_4_7 -> mlp2_down_7
	mlp2_down_7 -> add_5_7
	add_4_7 -> add_5_7
	add_5_7 -> ln3_pre_7
	ln3_pre_7 -> ring_attention_3_7
	ring_attention_3_7 -> o_proj_3_7
	o_proj_3_7 -> add_6_7
	add_5_7 -> add_6_7
	add_6_7 -> mlp3_down_7
	mlp3_down_7 -> add_7_7
	add_6_7 -> add_7_7
	add_7_7 -> output_gather_7
	output_gather_0 -> global_output
	output_gather_1 -> global_output
	output_gather_2 -> global_output
	output_gather_3 -> global_output
	output_gather_4 -> global_output
	output_gather_5 -> global_output
	output_gather_6 -> global_output
	output_gather_7 -> global_output
	output_gather_8 -> global_output
	output_gather_9 -> global_output
	output_gather_10 -> global_output
	output_gather_11 -> global_output
	output_gather_12 -> global_output
	output_gather_13 -> global_output
	output_gather_14 -> global_output
	output_gather_15 -> global_output
	global_input -> input_split_8
	input_split_8 -> embed_8
	embed_8 -> ln0_pre_8
	ln0_pre_8 -> q_proj_0_8
	ln0_pre_8 -> k_proj_0_8
	ln0_pre_8 -> v_proj_0_8
	q_proj_0_8 -> ring_attention_0_8
	k_proj_0_8 -> ring_attention_0_8
	v_proj_0_8 -> ring_attention_0_8
	k_proj_0_8 -> kv_recv_0_8_0 [style=dashed]
	v_proj_0_8 -> kv_recv_0_8_0 [style=dashed]
	kv_recv_0_8_0 -> ring_attention_0_8
	k_proj_0_8 -> kv_send_0_8_0
	v_proj_0_8 -> kv_send_0_8_0
	kv_send_0_8_0 -> kv_recv_0_9_0 [style=dashed]
	k_proj_0_7 -> kv_recv_0_8_1 [style=dashed]
	v_proj_0_7 -> kv_recv_0_8_1 [style=dashed]
	kv_recv_0_8_1 -> ring_attention_0_8
	k_proj_0_8 -> kv_send_0_8_1
	v_proj_0_8 -> kv_send_0_8_1
	kv_send_0_8_1 -> kv_recv_0_9_1 [style=dashed]
	k_proj_0_6 -> kv_recv_0_8_2 [style=dashed]
	v_proj_0_6 -> kv_recv_0_8_2 [style=dashed]
	kv_recv_0_8_2 -> ring_attention_0_8
	k_proj_0_8 -> kv_send_0_8_2
	v_proj_0_8 -> kv_send_0_8_2
	kv_send_0_8_2 -> kv_recv_0_9_2 [style=dashed]
	k_proj_0_5 -> kv_recv_0_8_3 [style=dashed]
	v_proj_0_5 -> kv_recv_0_8_3 [style=dashed]
	kv_recv_0_8_3 -> ring_attention_0_8
	k_proj_0_8 -> kv_send_0_8_3
	v_proj_0_8 -> kv_send_0_8_3
	kv_send_0_8_3 -> kv_recv_0_9_3 [style=dashed]
	k_proj_0_4 -> kv_recv_0_8_4 [style=dashed]
	v_proj_0_4 -> kv_recv_0_8_4 [style=dashed]
	kv_recv_0_8_4 -> ring_attention_0_8
	k_proj_0_8 -> kv_send_0_8_4
	v_proj_0_8 -> kv_send_0_8_4
	kv_send_0_8_4 -> kv_recv_0_9_4 [style=dashed]
	k_proj_0_3 -> kv_recv_0_8_5 [style=dashed]
	v_proj_0_3 -> kv_recv_0_8_5 [style=dashed]
	kv_recv_0_8_5 -> ring_attention_0_8
	k_proj_0_8 -> kv_send_0_8_5
	v_proj_0_8 -> kv_send_0_8_5
	kv_send_0_8_5 -> kv_recv_0_9_5 [style=dashed]
	k_proj_0_2 -> kv_recv_0_8_6 [style=dashed]
	v_proj_0_2 -> kv_recv_0_8_6 [style=dashed]
	kv_recv_0_8_6 -> ring_attention_0_8
	k_proj_0_8 -> kv_send_0_8_6
	v_proj_0_8 -> kv_send_0_8_6
	kv_send_0_8_6 -> kv_recv_0_9_6 [style=dashed]
	k_proj_0_1 -> kv_recv_0_8_7 [style=dashed]
	v_proj_0_1 -> kv_recv_0_8_7 [style=dashed]
	kv_recv_0_8_7 -> ring_attention_0_8
	k_proj_0_8 -> kv_send_0_8_7
	v_proj_0_8 -> kv_send_0_8_7
	kv_send_0_8_7 -> kv_recv_0_9_7 [style=dashed]
	k_proj_0_0 -> kv_recv_0_8_8 [style=dashed]
	v_proj_0_0 -> kv_recv_0_8_8 [style=dashed]
	kv_recv_0_8_8 -> ring_attention_0_8
	k_proj_0_8 -> kv_send_0_8_8
	v_proj_0_8 -> kv_send_0_8_8
	kv_send_0_8_8 -> kv_recv_0_9_8 [style=dashed]
	k_proj_0_15 -> kv_recv_0_8_9 [style=dashed]
	v_proj_0_15 -> kv_recv_0_8_9 [style=dashed]
	kv_recv_0_8_9 -> ring_attention_0_8
	k_proj_0_8 -> kv_send_0_8_9
	v_proj_0_8 -> kv_send_0_8_9
	kv_send_0_8_9 -> kv_recv_0_9_9 [style=dashed]
	k_proj_0_14 -> kv_recv_0_8_10 [style=dashed]
	v_proj_0_14 -> kv_recv_0_8_10 [style=dashed]
	kv_recv_0_8_10 -> ring_attention_0_8
	k_proj_0_8 -> kv_send_0_8_10
	v_proj_0_8 -> kv_send_0_8_10
	kv_send_0_8_10 -> kv_recv_0_9_10 [style=dashed]
	k_proj_0_13 -> kv_recv_0_8_11 [style=dashed]
	v_proj_0_13 -> kv_recv_0_8_11 [style=dashed]
	kv_recv_0_8_11 -> ring_attention_0_8
	k_proj_0_8 -> kv_send_0_8_11
	v_proj_0_8 -> kv_send_0_8_11
	kv_send_0_8_11 -> kv_recv_0_9_11 [style=dashed]
	k_proj_0_12 -> kv_recv_0_8_12 [style=dashed]
	v_proj_0_12 -> kv_recv_0_8_12 [style=dashed]
	kv_recv_0_8_12 -> ring_attention_0_8
	k_proj_0_8 -> kv_send_0_8_12
	v_proj_0_8 -> kv_send_0_8_12
	kv_send_0_8_12 -> kv_recv_0_9_12 [style=dashed]
	k_proj_0_11 -> kv_recv_0_8_13 [style=dashed]
	v_proj_0_11 -> kv_recv_0_8_13 [style=dashed]
	kv_recv_0_8_13 -> ring_attention_0_8
	k_proj_0_8 -> kv_send_0_8_13
	v_proj_0_8 -> kv_send_0_8_13
	kv_send_0_8_13 -> kv_recv_0_9_13 [style=dashed]
	k_proj_0_10 -> kv_recv_0_8_14 [style=dashed]
	v_proj_0_10 -> kv_recv_0_8_14 [style=dashed]
	kv_recv_0_8_14 -> ring_attention_0_8
	k_proj_0_8 -> kv_send_0_8_14
	v_proj_0_8 -> kv_send_0_8_14
	kv_send_0_8_14 -> kv_recv_0_9_14 [style=dashed]
	k_proj_0_9 -> kv_recv_0_8_15 [style=dashed]
	v_proj_0_9 -> kv_recv_0_8_15 [style=dashed]
	kv_recv_0_8_15 -> ring_attention_0_8
	k_proj_0_8 -> kv_send_0_8_15
	v_proj_0_8 -> kv_send_0_8_15
	kv_send_0_8_15 -> kv_recv_0_9_15 [style=dashed]
	ring_attention_0_8 -> o_proj_0_8
	o_proj_0_8 -> add_0_8
	embed_8 -> add_0_8
	add_0_8 -> mlp0_gate_8
	add_0_8 -> mlp0_up_8
	mlp0_gate_8 -> mlp0_down_8
	mlp0_up_8 -> mlp0_down_8
	mlp0_down_8 -> add_1_8
	add_0_8 -> add_1_8
	add_1_8 -> ln1_pre_8
	ln1_pre_8 -> q_proj_1_8
	ln1_pre_8 -> k_proj_1_8
	ln1_pre_8 -> v_proj_1_8
	q_proj_1_8 -> ring_attention_1_8
	k_proj_1_8 -> ring_attention_1_8
	v_proj_1_8 -> ring_attention_1_8
	k_proj_1_8 -> kv_recv_1_8_0 [style=dashed]
	v_proj_1_8 -> kv_recv_1_8_0 [style=dashed]
	kv_recv_1_8_0 -> ring_attention_1_8
	k_proj_1_8 -> kv_send_1_8_0
	v_proj_1_8 -> kv_send_1_8_0
	kv_send_1_8_0 -> kv_recv_1_9_0 [style=dashed]
	k_proj_1_7 -> kv_recv_1_8_1 [style=dashed]
	v_proj_1_7 -> kv_recv_1_8_1 [style=dashed]
	kv_recv_1_8_1 -> ring_attention_1_8
	k_proj_1_8 -> kv_send_1_8_1
	v_proj_1_8 -> kv_send_1_8_1
	kv_send_1_8_1 -> kv_recv_1_9_1 [style=dashed]
	k_proj_1_6 -> kv_recv_1_8_2 [style=dashed]
	v_proj_1_6 -> kv_recv_1_8_2 [style=dashed]
	kv_recv_1_8_2 -> ring_attention_1_8
	k_proj_1_8 -> kv_send_1_8_2
	v_proj_1_8 -> kv_send_1_8_2
	kv_send_1_8_2 -> kv_recv_1_9_2 [style=dashed]
	k_proj_1_5 -> kv_recv_1_8_3 [style=dashed]
	v_proj_1_5 -> kv_recv_1_8_3 [style=dashed]
	kv_recv_1_8_3 -> ring_attention_1_8
	k_proj_1_8 -> kv_send_1_8_3
	v_proj_1_8 -> kv_send_1_8_3
	kv_send_1_8_3 -> kv_recv_1_9_3 [style=dashed]
	k_proj_1_4 -> kv_recv_1_8_4 [style=dashed]
	v_proj_1_4 -> kv_recv_1_8_4 [style=dashed]
	kv_recv_1_8_4 -> ring_attention_1_8
	k_proj_1_8 -> kv_send_1_8_4
	v_proj_1_8 -> kv_send_1_8_4
	kv_send_1_8_4 -> kv_recv_1_9_4 [style=dashed]
	k_proj_1_3 -> kv_recv_1_8_5 [style=dashed]
	v_proj_1_3 -> kv_recv_1_8_5 [style=dashed]
	kv_recv_1_8_5 -> ring_attention_1_8
	k_proj_1_8 -> kv_send_1_8_5
	v_proj_1_8 -> kv_send_1_8_5
	kv_send_1_8_5 -> kv_recv_1_9_5 [style=dashed]
	k_proj_1_2 -> kv_recv_1_8_6 [style=dashed]
	v_proj_1_2 -> kv_recv_1_8_6 [style=dashed]
	kv_recv_1_8_6 -> ring_attention_1_8
	k_proj_1_8 -> kv_send_1_8_6
	v_proj_1_8 -> kv_send_1_8_6
	kv_send_1_8_6 -> kv_recv_1_9_6 [style=dashed]
	k_proj_1_1 -> kv_recv_1_8_7 [style=dashed]
	v_proj_1_1 -> kv_recv_1_8_7 [style=dashed]
	kv_recv_1_8_7 -> ring_attention_1_8
	k_proj_1_8 -> kv_send_1_8_7
	v_proj_1_8 -> kv_send_1_8_7
	kv_send_1_8_7 -> kv_recv_1_9_7 [style=dashed]
	k_proj_1_0 -> kv_recv_1_8_8 [style=dashed]
	v_proj_1_0 -> kv_recv_1_8_8 [style=dashed]
	kv_recv_1_8_8 -> ring_attention_1_8
	k_proj_1_8 -> kv_send_1_8_8
	v_proj_1_8 -> kv_send_1_8_8
	kv_send_1_8_8 -> kv_recv_1_9_8 [style=dashed]
	k_proj_1_15 -> kv_recv_1_8_9 [style=dashed]
	v_proj_1_15 -> kv_recv_1_8_9 [style=dashed]
	kv_recv_1_8_9 -> ring_attention_1_8
	k_proj_1_8 -> kv_send_1_8_9
	v_proj_1_8 -> kv_send_1_8_9
	kv_send_1_8_9 -> kv_recv_1_9_9 [style=dashed]
	k_proj_1_14 -> kv_recv_1_8_10 [style=dashed]
	v_proj_1_14 -> kv_recv_1_8_10 [style=dashed]
	kv_recv_1_8_10 -> ring_attention_1_8
	k_proj_1_8 -> kv_send_1_8_10
	v_proj_1_8 -> kv_send_1_8_10
	kv_send_1_8_10 -> kv_recv_1_9_10 [style=dashed]
	k_proj_1_13 -> kv_recv_1_8_11 [style=dashed]
	v_proj_1_13 -> kv_recv_1_8_11 [style=dashed]
	kv_recv_1_8_11 -> ring_attention_1_8
	k_proj_1_8 -> kv_send_1_8_11
	v_proj_1_8 -> kv_send_1_8_11
	kv_send_1_8_11 -> kv_recv_1_9_11 [style=dashed]
	k_proj_1_12 -> kv_recv_1_8_12 [style=dashed]
	v_proj_1_12 -> kv_recv_1_8_12 [style=dashed]
	kv_recv_1_8_12 -> ring_attention_1_8
	k_proj_1_8 -> kv_send_1_8_12
	v_proj_1_8 -> kv_send_1_8_12
	kv_send_1_8_12 -> kv_recv_1_9_12 [style=dashed]
	k_proj_1_11 -> kv_recv_1_8_13 [style=dashed]
	v_proj_1_11 -> kv_recv_1_8_13 [style=dashed]
	kv_recv_1_8_13 -> ring_attention_1_8
	k_proj_1_8 -> kv_send_1_8_13
	v_proj_1_8 -> kv_send_1_8_13
	kv_send_1_8_13 -> kv_recv_1_9_13 [style=dashed]
	k_proj_1_10 -> kv_recv_1_8_14 [style=dashed]
	v_proj_1_10 -> kv_recv_1_8_14 [style=dashed]
	kv_recv_1_8_14 -> ring_attention_1_8
	k_proj_1_8 -> kv_send_1_8_14
	v_proj_1_8 -> kv_send_1_8_14
	kv_send_1_8_14 -> kv_recv_1_9_14 [style=dashed]
	k_proj_1_9 -> kv_recv_1_8_15 [style=dashed]
	v_proj_1_9 -> kv_recv_1_8_15 [style=dashed]
	kv_recv_1_8_15 -> ring_attention_1_8
	k_proj_1_8 -> kv_send_1_8_15
	v_proj_1_8 -> kv_send_1_8_15
	kv_send_1_8_15 -> kv_recv_1_9_15 [style=dashed]
	ring_attention_1_8 -> o_proj_1_8
	o_proj_1_8 -> add_2_8
	add_1_8 -> add_2_8
	add_2_8 -> mlp1_gate_8
	add_2_8 -> mlp1_up_8
	mlp1_gate_8 -> mlp1_down_8
	mlp1_up_8 -> mlp1_down_8
	mlp1_down_8 -> add_3_8
	add_2_8 -> add_3_8
	add_3_8 -> ln2_pre_8
	ln2_pre_8 -> ring_attention_2_8
	ring_attention_2_8 -> o_proj_2_8
	o_proj_2_8 -> add_4_8
	add_3_8 -> add_4_8
	add_4_8 -> mlp2_down_8
	mlp2_down_8 -> add_5_8
	add_4_8 -> add_5_8
	add_5_8 -> ln3_pre_8
	ln3_pre_8 -> ring_attention_3_8
	ring_attention_3_8 -> o_proj_3_8
	o_proj_3_8 -> add_6_8
	add_5_8 -> add_6_8
	add_6_8 -> mlp3_down_8
	mlp3_down_8 -> add_7_8
	add_6_8 -> add_7_8
	add_7_8 -> output_gather_8
	output_gather_0 -> global_output
	output_gather_1 -> global_output
	output_gather_2 -> global_output
	output_gather_3 -> global_output
	output_gather_4 -> global_output
	output_gather_5 -> global_output
	output_gather_6 -> global_output
	output_gather_7 -> global_output
	output_gather_8 -> global_output
	output_gather_9 -> global_output
	output_gather_10 -> global_output
	output_gather_11 -> global_output
	output_gather_12 -> global_output
	output_gather_13 -> global_output
	output_gather_14 -> global_output
	output_gather_15 -> global_output
	global_input -> input_split_9
	input_split_9 -> embed_9
	embed_9 -> ln0_pre_9
	ln0_pre_9 -> q_proj_0_9
	ln0_pre_9 -> k_proj_0_9
	ln0_pre_9 -> v_proj_0_9
	q_proj_0_9 -> ring_attention_0_9
	k_proj_0_9 -> ring_attention_0_9
	v_proj_0_9 -> ring_attention_0_9
	k_proj_0_9 -> kv_recv_0_9_0 [style=dashed]
	v_proj_0_9 -> kv_recv_0_9_0 [style=dashed]
	kv_recv_0_9_0 -> ring_attention_0_9
	k_proj_0_9 -> kv_send_0_9_0
	v_proj_0_9 -> kv_send_0_9_0
	kv_send_0_9_0 -> kv_recv_0_10_0 [style=dashed]
	k_proj_0_8 -> kv_recv_0_9_1 [style=dashed]
	v_proj_0_8 -> kv_recv_0_9_1 [style=dashed]
	kv_recv_0_9_1 -> ring_attention_0_9
	k_proj_0_9 -> kv_send_0_9_1
	v_proj_0_9 -> kv_send_0_9_1
	kv_send_0_9_1 -> kv_recv_0_10_1 [style=dashed]
	k_proj_0_7 -> kv_recv_0_9_2 [style=dashed]
	v_proj_0_7 -> kv_recv_0_9_2 [style=dashed]
	kv_recv_0_9_2 -> ring_attention_0_9
	k_proj_0_9 -> kv_send_0_9_2
	v_proj_0_9 -> kv_send_0_9_2
	kv_send_0_9_2 -> kv_recv_0_10_2 [style=dashed]
	k_proj_0_6 -> kv_recv_0_9_3 [style=dashed]
	v_proj_0_6 -> kv_recv_0_9_3 [style=dashed]
	kv_recv_0_9_3 -> ring_attention_0_9
	k_proj_0_9 -> kv_send_0_9_3
	v_proj_0_9 -> kv_send_0_9_3
	kv_send_0_9_3 -> kv_recv_0_10_3 [style=dashed]
	k_proj_0_5 -> kv_recv_0_9_4 [style=dashed]
	v_proj_0_5 -> kv_recv_0_9_4 [style=dashed]
	kv_recv_0_9_4 -> ring_attention_0_9
	k_proj_0_9 -> kv_send_0_9_4
	v_proj_0_9 -> kv_send_0_9_4
	kv_send_0_9_4 -> kv_recv_0_10_4 [style=dashed]
	k_proj_0_4 -> kv_recv_0_9_5 [style=dashed]
	v_proj_0_4 -> kv_recv_0_9_5 [style=dashed]
	kv_recv_0_9_5 -> ring_attention_0_9
	k_proj_0_9 -> kv_send_0_9_5
	v_proj_0_9 -> kv_send_0_9_5
	kv_send_0_9_5 -> kv_recv_0_10_5 [style=dashed]
	k_proj_0_3 -> kv_recv_0_9_6 [style=dashed]
	v_proj_0_3 -> kv_recv_0_9_6 [style=dashed]
	kv_recv_0_9_6 -> ring_attention_0_9
	k_proj_0_9 -> kv_send_0_9_6
	v_proj_0_9 -> kv_send_0_9_6
	kv_send_0_9_6 -> kv_recv_0_10_6 [style=dashed]
	k_proj_0_2 -> kv_recv_0_9_7 [style=dashed]
	v_proj_0_2 -> kv_recv_0_9_7 [style=dashed]
	kv_recv_0_9_7 -> ring_attention_0_9
	k_proj_0_9 -> kv_send_0_9_7
	v_proj_0_9 -> kv_send_0_9_7
	kv_send_0_9_7 -> kv_recv_0_10_7 [style=dashed]
	k_proj_0_1 -> kv_recv_0_9_8 [style=dashed]
	v_proj_0_1 -> kv_recv_0_9_8 [style=dashed]
	kv_recv_0_9_8 -> ring_attention_0_9
	k_proj_0_9 -> kv_send_0_9_8
	v_proj_0_9 -> kv_send_0_9_8
	kv_send_0_9_8 -> kv_recv_0_10_8 [style=dashed]
	k_proj_0_0 -> kv_recv_0_9_9 [style=dashed]
	v_proj_0_0 -> kv_recv_0_9_9 [style=dashed]
	kv_recv_0_9_9 -> ring_attention_0_9
	k_proj_0_9 -> kv_send_0_9_9
	v_proj_0_9 -> kv_send_0_9_9
	kv_send_0_9_9 -> kv_recv_0_10_9 [style=dashed]
	k_proj_0_15 -> kv_recv_0_9_10 [style=dashed]
	v_proj_0_15 -> kv_recv_0_9_10 [style=dashed]
	kv_recv_0_9_10 -> ring_attention_0_9
	k_proj_0_9 -> kv_send_0_9_10
	v_proj_0_9 -> kv_send_0_9_10
	kv_send_0_9_10 -> kv_recv_0_10_10 [style=dashed]
	k_proj_0_14 -> kv_recv_0_9_11 [style=dashed]
	v_proj_0_14 -> kv_recv_0_9_11 [style=dashed]
	kv_recv_0_9_11 -> ring_attention_0_9
	k_proj_0_9 -> kv_send_0_9_11
	v_proj_0_9 -> kv_send_0_9_11
	kv_send_0_9_11 -> kv_recv_0_10_11 [style=dashed]
	k_proj_0_13 -> kv_recv_0_9_12 [style=dashed]
	v_proj_0_13 -> kv_recv_0_9_12 [style=dashed]
	kv_recv_0_9_12 -> ring_attention_0_9
	k_proj_0_9 -> kv_send_0_9_12
	v_proj_0_9 -> kv_send_0_9_12
	kv_send_0_9_12 -> kv_recv_0_10_12 [style=dashed]
	k_proj_0_12 -> kv_recv_0_9_13 [style=dashed]
	v_proj_0_12 -> kv_recv_0_9_13 [style=dashed]
	kv_recv_0_9_13 -> ring_attention_0_9
	k_proj_0_9 -> kv_send_0_9_13
	v_proj_0_9 -> kv_send_0_9_13
	kv_send_0_9_13 -> kv_recv_0_10_13 [style=dashed]
	k_proj_0_11 -> kv_recv_0_9_14 [style=dashed]
	v_proj_0_11 -> kv_recv_0_9_14 [style=dashed]
	kv_recv_0_9_14 -> ring_attention_0_9
	k_proj_0_9 -> kv_send_0_9_14
	v_proj_0_9 -> kv_send_0_9_14
	kv_send_0_9_14 -> kv_recv_0_10_14 [style=dashed]
	k_proj_0_10 -> kv_recv_0_9_15 [style=dashed]
	v_proj_0_10 -> kv_recv_0_9_15 [style=dashed]
	kv_recv_0_9_15 -> ring_attention_0_9
	k_proj_0_9 -> kv_send_0_9_15
	v_proj_0_9 -> kv_send_0_9_15
	kv_send_0_9_15 -> kv_recv_0_10_15 [style=dashed]
	ring_attention_0_9 -> o_proj_0_9
	o_proj_0_9 -> add_0_9
	embed_9 -> add_0_9
	add_0_9 -> mlp0_gate_9
	add_0_9 -> mlp0_up_9
	mlp0_gate_9 -> mlp0_down_9
	mlp0_up_9 -> mlp0_down_9
	mlp0_down_9 -> add_1_9
	add_0_9 -> add_1_9
	add_1_9 -> ln1_pre_9
	ln1_pre_9 -> q_proj_1_9
	ln1_pre_9 -> k_proj_1_9
	ln1_pre_9 -> v_proj_1_9
	q_proj_1_9 -> ring_attention_1_9
	k_proj_1_9 -> ring_attention_1_9
	v_proj_1_9 -> ring_attention_1_9
	k_proj_1_9 -> kv_recv_1_9_0 [style=dashed]
	v_proj_1_9 -> kv_recv_1_9_0 [style=dashed]
	kv_recv_1_9_0 -> ring_attention_1_9
	k_proj_1_9 -> kv_send_1_9_0
	v_proj_1_9 -> kv_send_1_9_0
	kv_send_1_9_0 -> kv_recv_1_10_0 [style=dashed]
	k_proj_1_8 -> kv_recv_1_9_1 [style=dashed]
	v_proj_1_8 -> kv_recv_1_9_1 [style=dashed]
	kv_recv_1_9_1 -> ring_attention_1_9
	k_proj_1_9 -> kv_send_1_9_1
	v_proj_1_9 -> kv_send_1_9_1
	kv_send_1_9_1 -> kv_recv_1_10_1 [style=dashed]
	k_proj_1_7 -> kv_recv_1_9_2 [style=dashed]
	v_proj_1_7 -> kv_recv_1_9_2 [style=dashed]
	kv_recv_1_9_2 -> ring_attention_1_9
	k_proj_1_9 -> kv_send_1_9_2
	v_proj_1_9 -> kv_send_1_9_2
	kv_send_1_9_2 -> kv_recv_1_10_2 [style=dashed]
	k_proj_1_6 -> kv_recv_1_9_3 [style=dashed]
	v_proj_1_6 -> kv_recv_1_9_3 [style=dashed]
	kv_recv_1_9_3 -> ring_attention_1_9
	k_proj_1_9 -> kv_send_1_9_3
	v_proj_1_9 -> kv_send_1_9_3
	kv_send_1_9_3 -> kv_recv_1_10_3 [style=dashed]
	k_proj_1_5 -> kv_recv_1_9_4 [style=dashed]
	v_proj_1_5 -> kv_recv_1_9_4 [style=dashed]
	kv_recv_1_9_4 -> ring_attention_1_9
	k_proj_1_9 -> kv_send_1_9_4
	v_proj_1_9 -> kv_send_1_9_4
	kv_send_1_9_4 -> kv_recv_1_10_4 [style=dashed]
	k_proj_1_4 -> kv_recv_1_9_5 [style=dashed]
	v_proj_1_4 -> kv_recv_1_9_5 [style=dashed]
	kv_recv_1_9_5 -> ring_attention_1_9
	k_proj_1_9 -> kv_send_1_9_5
	v_proj_1_9 -> kv_send_1_9_5
	kv_send_1_9_5 -> kv_recv_1_10_5 [style=dashed]
	k_proj_1_3 -> kv_recv_1_9_6 [style=dashed]
	v_proj_1_3 -> kv_recv_1_9_6 [style=dashed]
	kv_recv_1_9_6 -> ring_attention_1_9
	k_proj_1_9 -> kv_send_1_9_6
	v_proj_1_9 -> kv_send_1_9_6
	kv_send_1_9_6 -> kv_recv_1_10_6 [style=dashed]
	k_proj_1_2 -> kv_recv_1_9_7 [style=dashed]
	v_proj_1_2 -> kv_recv_1_9_7 [style=dashed]
	kv_recv_1_9_7 -> ring_attention_1_9
	k_proj_1_9 -> kv_send_1_9_7
	v_proj_1_9 -> kv_send_1_9_7
	kv_send_1_9_7 -> kv_recv_1_10_7 [style=dashed]
	k_proj_1_1 -> kv_recv_1_9_8 [style=dashed]
	v_proj_1_1 -> kv_recv_1_9_8 [style=dashed]
	kv_recv_1_9_8 -> ring_attention_1_9
	k_proj_1_9 -> kv_send_1_9_8
	v_proj_1_9 -> kv_send_1_9_8
	kv_send_1_9_8 -> kv_recv_1_10_8 [style=dashed]
	k_proj_1_0 -> kv_recv_1_9_9 [style=dashed]
	v_proj_1_0 -> kv_recv_1_9_9 [style=dashed]
	kv_recv_1_9_9 -> ring_attention_1_9
	k_proj_1_9 -> kv_send_1_9_9
	v_proj_1_9 -> kv_send_1_9_9
	kv_send_1_9_9 -> kv_recv_1_10_9 [style=dashed]
	k_proj_1_15 -> kv_recv_1_9_10 [style=dashed]
	v_proj_1_15 -> kv_recv_1_9_10 [style=dashed]
	kv_recv_1_9_10 -> ring_attention_1_9
	k_proj_1_9 -> kv_send_1_9_10
	v_proj_1_9 -> kv_send_1_9_10
	kv_send_1_9_10 -> kv_recv_1_10_10 [style=dashed]
	k_proj_1_14 -> kv_recv_1_9_11 [style=dashed]
	v_proj_1_14 -> kv_recv_1_9_11 [style=dashed]
	kv_recv_1_9_11 -> ring_attention_1_9
	k_proj_1_9 -> kv_send_1_9_11
	v_proj_1_9 -> kv_send_1_9_11
	kv_send_1_9_11 -> kv_recv_1_10_11 [style=dashed]
	k_proj_1_13 -> kv_recv_1_9_12 [style=dashed]
	v_proj_1_13 -> kv_recv_1_9_12 [style=dashed]
	kv_recv_1_9_12 -> ring_attention_1_9
	k_proj_1_9 -> kv_send_1_9_12
	v_proj_1_9 -> kv_send_1_9_12
	kv_send_1_9_12 -> kv_recv_1_10_12 [style=dashed]
	k_proj_1_12 -> kv_recv_1_9_13 [style=dashed]
	v_proj_1_12 -> kv_recv_1_9_13 [style=dashed]
	kv_recv_1_9_13 -> ring_attention_1_9
	k_proj_1_9 -> kv_send_1_9_13
	v_proj_1_9 -> kv_send_1_9_13
	kv_send_1_9_13 -> kv_recv_1_10_13 [style=dashed]
	k_proj_1_11 -> kv_recv_1_9_14 [style=dashed]
	v_proj_1_11 -> kv_recv_1_9_14 [style=dashed]
	kv_recv_1_9_14 -> ring_attention_1_9
	k_proj_1_9 -> kv_send_1_9_14
	v_proj_1_9 -> kv_send_1_9_14
	kv_send_1_9_14 -> kv_recv_1_10_14 [style=dashed]
	k_proj_1_10 -> kv_recv_1_9_15 [style=dashed]
	v_proj_1_10 -> kv_recv_1_9_15 [style=dashed]
	kv_recv_1_9_15 -> ring_attention_1_9
	k_proj_1_9 -> kv_send_1_9_15
	v_proj_1_9 -> kv_send_1_9_15
	kv_send_1_9_15 -> kv_recv_1_10_15 [style=dashed]
	ring_attention_1_9 -> o_proj_1_9
	o_proj_1_9 -> add_2_9
	add_1_9 -> add_2_9
	add_2_9 -> mlp1_gate_9
	add_2_9 -> mlp1_up_9
	mlp1_gate_9 -> mlp1_down_9
	mlp1_up_9 -> mlp1_down_9
	mlp1_down_9 -> add_3_9
	add_2_9 -> add_3_9
	add_3_9 -> ln2_pre_9
	ln2_pre_9 -> ring_attention_2_9
	ring_attention_2_9 -> o_proj_2_9
	o_proj_2_9 -> add_4_9
	add_3_9 -> add_4_9
	add_4_9 -> mlp2_down_9
	mlp2_down_9 -> add_5_9
	add_4_9 -> add_5_9
	add_5_9 -> ln3_pre_9
	ln3_pre_9 -> ring_attention_3_9
	ring_attention_3_9 -> o_proj_3_9
	o_proj_3_9 -> add_6_9
	add_5_9 -> add_6_9
	add_6_9 -> mlp3_down_9
	mlp3_down_9 -> add_7_9
	add_6_9 -> add_7_9
	add_7_9 -> output_gather_9
	output_gather_0 -> global_output
	output_gather_1 -> global_output
	output_gather_2 -> global_output
	output_gather_3 -> global_output
	output_gather_4 -> global_output
	output_gather_5 -> global_output
	output_gather_6 -> global_output
	output_gather_7 -> global_output
	output_gather_8 -> global_output
	output_gather_9 -> global_output
	output_gather_10 -> global_output
	output_gather_11 -> global_output
	output_gather_12 -> global_output
	output_gather_13 -> global_output
	output_gather_14 -> global_output
	output_gather_15 -> global_output
	global_input -> input_split_10
	input_split_10 -> embed_10
	embed_10 -> ln0_pre_10
	ln0_pre_10 -> q_proj_0_10
	ln0_pre_10 -> k_proj_0_10
	ln0_pre_10 -> v_proj_0_10
	q_proj_0_10 -> ring_attention_0_10
	k_proj_0_10 -> ring_attention_0_10
	v_proj_0_10 -> ring_attention_0_10
	k_proj_0_10 -> kv_recv_0_10_0 [style=dashed]
	v_proj_0_10 -> kv_recv_0_10_0 [style=dashed]
	kv_recv_0_10_0 -> ring_attention_0_10
	k_proj_0_10 -> kv_send_0_10_0
	v_proj_0_10 -> kv_send_0_10_0
	kv_send_0_10_0 -> kv_recv_0_11_0 [style=dashed]
	k_proj_0_9 -> kv_recv_0_10_1 [style=dashed]
	v_proj_0_9 -> kv_recv_0_10_1 [style=dashed]
	kv_recv_0_10_1 -> ring_attention_0_10
	k_proj_0_10 -> kv_send_0_10_1
	v_proj_0_10 -> kv_send_0_10_1
	kv_send_0_10_1 -> kv_recv_0_11_1 [style=dashed]
	k_proj_0_8 -> kv_recv_0_10_2 [style=dashed]
	v_proj_0_8 -> kv_recv_0_10_2 [style=dashed]
	kv_recv_0_10_2 -> ring_attention_0_10
	k_proj_0_10 -> kv_send_0_10_2
	v_proj_0_10 -> kv_send_0_10_2
	kv_send_0_10_2 -> kv_recv_0_11_2 [style=dashed]
	k_proj_0_7 -> kv_recv_0_10_3 [style=dashed]
	v_proj_0_7 -> kv_recv_0_10_3 [style=dashed]
	kv_recv_0_10_3 -> ring_attention_0_10
	k_proj_0_10 -> kv_send_0_10_3
	v_proj_0_10 -> kv_send_0_10_3
	kv_send_0_10_3 -> kv_recv_0_11_3 [style=dashed]
	k_proj_0_6 -> kv_recv_0_10_4 [style=dashed]
	v_proj_0_6 -> kv_recv_0_10_4 [style=dashed]
	kv_recv_0_10_4 -> ring_attention_0_10
	k_proj_0_10 -> kv_send_0_10_4
	v_proj_0_10 -> kv_send_0_10_4
	kv_send_0_10_4 -> kv_recv_0_11_4 [style=dashed]
	k_proj_0_5 -> kv_recv_0_10_5 [style=dashed]
	v_proj_0_5 -> kv_recv_0_10_5 [style=dashed]
	kv_recv_0_10_5 -> ring_attention_0_10
	k_proj_0_10 -> kv_send_0_10_5
	v_proj_0_10 -> kv_send_0_10_5
	kv_send_0_10_5 -> kv_recv_0_11_5 [style=dashed]
	k_proj_0_4 -> kv_recv_0_10_6 [style=dashed]
	v_proj_0_4 -> kv_recv_0_10_6 [style=dashed]
	kv_recv_0_10_6 -> ring_attention_0_10
	k_proj_0_10 -> kv_send_0_10_6
	v_proj_0_10 -> kv_send_0_10_6
	kv_send_0_10_6 -> kv_recv_0_11_6 [style=dashed]
	k_proj_0_3 -> kv_recv_0_10_7 [style=dashed]
	v_proj_0_3 -> kv_recv_0_10_7 [style=dashed]
	kv_recv_0_10_7 -> ring_attention_0_10
	k_proj_0_10 -> kv_send_0_10_7
	v_proj_0_10 -> kv_send_0_10_7
	kv_send_0_10_7 -> kv_recv_0_11_7 [style=dashed]
	k_proj_0_2 -> kv_recv_0_10_8 [style=dashed]
	v_proj_0_2 -> kv_recv_0_10_8 [style=dashed]
	kv_recv_0_10_8 -> ring_attention_0_10
	k_proj_0_10 -> kv_send_0_10_8
	v_proj_0_10 -> kv_send_0_10_8
	kv_send_0_10_8 -> kv_recv_0_11_8 [style=dashed]
	k_proj_0_1 -> kv_recv_0_10_9 [style=dashed]
	v_proj_0_1 -> kv_recv_0_10_9 [style=dashed]
	kv_recv_0_10_9 -> ring_attention_0_10
	k_proj_0_10 -> kv_send_0_10_9
	v_proj_0_10 -> kv_send_0_10_9
	kv_send_0_10_9 -> kv_recv_0_11_9 [style=dashed]
	k_proj_0_0 -> kv_recv_0_10_10 [style=dashed]
	v_proj_0_0 -> kv_recv_0_10_10 [style=dashed]
	kv_recv_0_10_10 -> ring_attention_0_10
	k_proj_0_10 -> kv_send_0_10_10
	v_proj_0_10 -> kv_send_0_10_10
	kv_send_0_10_10 -> kv_recv_0_11_10 [style=dashed]
	k_proj_0_15 -> kv_recv_0_10_11 [style=dashed]
	v_proj_0_15 -> kv_recv_0_10_11 [style=dashed]
	kv_recv_0_10_11 -> ring_attention_0_10
	k_proj_0_10 -> kv_send_0_10_11
	v_proj_0_10 -> kv_send_0_10_11
	kv_send_0_10_11 -> kv_recv_0_11_11 [style=dashed]
	k_proj_0_14 -> kv_recv_0_10_12 [style=dashed]
	v_proj_0_14 -> kv_recv_0_10_12 [style=dashed]
	kv_recv_0_10_12 -> ring_attention_0_10
	k_proj_0_10 -> kv_send_0_10_12
	v_proj_0_10 -> kv_send_0_10_12
	kv_send_0_10_12 -> kv_recv_0_11_12 [style=dashed]
	k_proj_0_13 -> kv_recv_0_10_13 [style=dashed]
	v_proj_0_13 -> kv_recv_0_10_13 [style=dashed]
	kv_recv_0_10_13 -> ring_attention_0_10
	k_proj_0_10 -> kv_send_0_10_13
	v_proj_0_10 -> kv_send_0_10_13
	kv_send_0_10_13 -> kv_recv_0_11_13 [style=dashed]
	k_proj_0_12 -> kv_recv_0_10_14 [style=dashed]
	v_proj_0_12 -> kv_recv_0_10_14 [style=dashed]
	kv_recv_0_10_14 -> ring_attention_0_10
	k_proj_0_10 -> kv_send_0_10_14
	v_proj_0_10 -> kv_send_0_10_14
	kv_send_0_10_14 -> kv_recv_0_11_14 [style=dashed]
	k_proj_0_11 -> kv_recv_0_10_15 [style=dashed]
	v_proj_0_11 -> kv_recv_0_10_15 [style=dashed]
	kv_recv_0_10_15 -> ring_attention_0_10
	k_proj_0_10 -> kv_send_0_10_15
	v_proj_0_10 -> kv_send_0_10_15
	kv_send_0_10_15 -> kv_recv_0_11_15 [style=dashed]
	ring_attention_0_10 -> o_proj_0_10
	o_proj_0_10 -> add_0_10
	embed_10 -> add_0_10
	add_0_10 -> mlp0_gate_10
	add_0_10 -> mlp0_up_10
	mlp0_gate_10 -> mlp0_down_10
	mlp0_up_10 -> mlp0_down_10
	mlp0_down_10 -> add_1_10
	add_0_10 -> add_1_10
	add_1_10 -> ln1_pre_10
	ln1_pre_10 -> q_proj_1_10
	ln1_pre_10 -> k_proj_1_10
	ln1_pre_10 -> v_proj_1_10
	q_proj_1_10 -> ring_attention_1_10
	k_proj_1_10 -> ring_attention_1_10
	v_proj_1_10 -> ring_attention_1_10
	k_proj_1_10 -> kv_recv_1_10_0 [style=dashed]
	v_proj_1_10 -> kv_recv_1_10_0 [style=dashed]
	kv_recv_1_10_0 -> ring_attention_1_10
	k_proj_1_10 -> kv_send_1_10_0
	v_proj_1_10 -> kv_send_1_10_0
	kv_send_1_10_0 -> kv_recv_1_11_0 [style=dashed]
	k_proj_1_9 -> kv_recv_1_10_1 [style=dashed]
	v_proj_1_9 -> kv_recv_1_10_1 [style=dashed]
	kv_recv_1_10_1 -> ring_attention_1_10
	k_proj_1_10 -> kv_send_1_10_1
	v_proj_1_10 -> kv_send_1_10_1
	kv_send_1_10_1 -> kv_recv_1_11_1 [style=dashed]
	k_proj_1_8 -> kv_recv_1_10_2 [style=dashed]
	v_proj_1_8 -> kv_recv_1_10_2 [style=dashed]
	kv_recv_1_10_2 -> ring_attention_1_10
	k_proj_1_10 -> kv_send_1_10_2
	v_proj_1_10 -> kv_send_1_10_2
	kv_send_1_10_2 -> kv_recv_1_11_2 [style=dashed]
	k_proj_1_7 -> kv_recv_1_10_3 [style=dashed]
	v_proj_1_7 -> kv_recv_1_10_3 [style=dashed]
	kv_recv_1_10_3 -> ring_attention_1_10
	k_proj_1_10 -> kv_send_1_10_3
	v_proj_1_10 -> kv_send_1_10_3
	kv_send_1_10_3 -> kv_recv_1_11_3 [style=dashed]
	k_proj_1_6 -> kv_recv_1_10_4 [style=dashed]
	v_proj_1_6 -> kv_recv_1_10_4 [style=dashed]
	kv_recv_1_10_4 -> ring_attention_1_10
	k_proj_1_10 -> kv_send_1_10_4
	v_proj_1_10 -> kv_send_1_10_4
	kv_send_1_10_4 -> kv_recv_1_11_4 [style=dashed]
	k_proj_1_5 -> kv_recv_1_10_5 [style=dashed]
	v_proj_1_5 -> kv_recv_1_10_5 [style=dashed]
	kv_recv_1_10_5 -> ring_attention_1_10
	k_proj_1_10 -> kv_send_1_10_5
	v_proj_1_10 -> kv_send_1_10_5
	kv_send_1_10_5 -> kv_recv_1_11_5 [style=dashed]
	k_proj_1_4 -> kv_recv_1_10_6 [style=dashed]
	v_proj_1_4 -> kv_recv_1_10_6 [style=dashed]
	kv_recv_1_10_6 -> ring_attention_1_10
	k_proj_1_10 -> kv_send_1_10_6
	v_proj_1_10 -> kv_send_1_10_6
	kv_send_1_10_6 -> kv_recv_1_11_6 [style=dashed]
	k_proj_1_3 -> kv_recv_1_10_7 [style=dashed]
	v_proj_1_3 -> kv_recv_1_10_7 [style=dashed]
	kv_recv_1_10_7 -> ring_attention_1_10
	k_proj_1_10 -> kv_send_1_10_7
	v_proj_1_10 -> kv_send_1_10_7
	kv_send_1_10_7 -> kv_recv_1_11_7 [style=dashed]
	k_proj_1_2 -> kv_recv_1_10_8 [style=dashed]
	v_proj_1_2 -> kv_recv_1_10_8 [style=dashed]
	kv_recv_1_10_8 -> ring_attention_1_10
	k_proj_1_10 -> kv_send_1_10_8
	v_proj_1_10 -> kv_send_1_10_8
	kv_send_1_10_8 -> kv_recv_1_11_8 [style=dashed]
	k_proj_1_1 -> kv_recv_1_10_9 [style=dashed]
	v_proj_1_1 -> kv_recv_1_10_9 [style=dashed]
	kv_recv_1_10_9 -> ring_attention_1_10
	k_proj_1_10 -> kv_send_1_10_9
	v_proj_1_10 -> kv_send_1_10_9
	kv_send_1_10_9 -> kv_recv_1_11_9 [style=dashed]
	k_proj_1_0 -> kv_recv_1_10_10 [style=dashed]
	v_proj_1_0 -> kv_recv_1_10_10 [style=dashed]
	kv_recv_1_10_10 -> ring_attention_1_10
	k_proj_1_10 -> kv_send_1_10_10
	v_proj_1_10 -> kv_send_1_10_10
	kv_send_1_10_10 -> kv_recv_1_11_10 [style=dashed]
	k_proj_1_15 -> kv_recv_1_10_11 [style=dashed]
	v_proj_1_15 -> kv_recv_1_10_11 [style=dashed]
	kv_recv_1_10_11 -> ring_attention_1_10
	k_proj_1_10 -> kv_send_1_10_11
	v_proj_1_10 -> kv_send_1_10_11
	kv_send_1_10_11 -> kv_recv_1_11_11 [style=dashed]
	k_proj_1_14 -> kv_recv_1_10_12 [style=dashed]
	v_proj_1_14 -> kv_recv_1_10_12 [style=dashed]
	kv_recv_1_10_12 -> ring_attention_1_10
	k_proj_1_10 -> kv_send_1_10_12
	v_proj_1_10 -> kv_send_1_10_12
	kv_send_1_10_12 -> kv_recv_1_11_12 [style=dashed]
	k_proj_1_13 -> kv_recv_1_10_13 [style=dashed]
	v_proj_1_13 -> kv_recv_1_10_13 [style=dashed]
	kv_recv_1_10_13 -> ring_attention_1_10
	k_proj_1_10 -> kv_send_1_10_13
	v_proj_1_10 -> kv_send_1_10_13
	kv_send_1_10_13 -> kv_recv_1_11_13 [style=dashed]
	k_proj_1_12 -> kv_recv_1_10_14 [style=dashed]
	v_proj_1_12 -> kv_recv_1_10_14 [style=dashed]
	kv_recv_1_10_14 -> ring_attention_1_10
	k_proj_1_10 -> kv_send_1_10_14
	v_proj_1_10 -> kv_send_1_10_14
	kv_send_1_10_14 -> kv_recv_1_11_14 [style=dashed]
	k_proj_1_11 -> kv_recv_1_10_15 [style=dashed]
	v_proj_1_11 -> kv_recv_1_10_15 [style=dashed]
	kv_recv_1_10_15 -> ring_attention_1_10
	k_proj_1_10 -> kv_send_1_10_15
	v_proj_1_10 -> kv_send_1_10_15
	kv_send_1_10_15 -> kv_recv_1_11_15 [style=dashed]
	ring_attention_1_10 -> o_proj_1_10
	o_proj_1_10 -> add_2_10
	add_1_10 -> add_2_10
	add_2_10 -> mlp1_gate_10
	add_2_10 -> mlp1_up_10
	mlp1_gate_10 -> mlp1_down_10
	mlp1_up_10 -> mlp1_down_10
	mlp1_down_10 -> add_3_10
	add_2_10 -> add_3_10
	add_3_10 -> ln2_pre_10
	ln2_pre_10 -> ring_attention_2_10
	ring_attention_2_10 -> o_proj_2_10
	o_proj_2_10 -> add_4_10
	add_3_10 -> add_4_10
	add_4_10 -> mlp2_down_10
	mlp2_down_10 -> add_5_10
	add_4_10 -> add_5_10
	add_5_10 -> ln3_pre_10
	ln3_pre_10 -> ring_attention_3_10
	ring_attention_3_10 -> o_proj_3_10
	o_proj_3_10 -> add_6_10
	add_5_10 -> add_6_10
	add_6_10 -> mlp3_down_10
	mlp3_down_10 -> add_7_10
	add_6_10 -> add_7_10
	add_7_10 -> output_gather_10
	output_gather_0 -> global_output
	output_gather_1 -> global_output
	output_gather_2 -> global_output
	output_gather_3 -> global_output
	output_gather_4 -> global_output
	output_gather_5 -> global_output
	output_gather_6 -> global_output
	output_gather_7 -> global_output
	output_gather_8 -> global_output
	output_gather_9 -> global_output
	output_gather_10 -> global_output
	output_gather_11 -> global_output
	output_gather_12 -> global_output
	output_gather_13 -> global_output
	output_gather_14 -> global_output
	output_gather_15 -> global_output
	global_input -> input_split_11
	input_split_11 -> embed_11
	embed_11 -> ln0_pre_11
	ln0_pre_11 -> q_proj_0_11
	ln0_pre_11 -> k_proj_0_11
	ln0_pre_11 -> v_proj_0_11
	q_proj_0_11 -> ring_attention_0_11
	k_proj_0_11 -> ring_attention_0_11
	v_proj_0_11 -> ring_attention_0_11
	k_proj_0_11 -> kv_recv_0_11_0 [style=dashed]
	v_proj_0_11 -> kv_recv_0_11_0 [style=dashed]
	kv_recv_0_11_0 -> ring_attention_0_11
	k_proj_0_11 -> kv_send_0_11_0
	v_proj_0_11 -> kv_send_0_11_0
	kv_send_0_11_0 -> kv_recv_0_12_0 [style=dashed]
	k_proj_0_10 -> kv_recv_0_11_1 [style=dashed]
	v_proj_0_10 -> kv_recv_0_11_1 [style=dashed]
	kv_recv_0_11_1 -> ring_attention_0_11
	k_proj_0_11 -> kv_send_0_11_1
	v_proj_0_11 -> kv_send_0_11_1
	kv_send_0_11_1 -> kv_recv_0_12_1 [style=dashed]
	k_proj_0_9 -> kv_recv_0_11_2 [style=dashed]
	v_proj_0_9 -> kv_recv_0_11_2 [style=dashed]
	kv_recv_0_11_2 -> ring_attention_0_11
	k_proj_0_11 -> kv_send_0_11_2
	v_proj_0_11 -> kv_send_0_11_2
	kv_send_0_11_2 -> kv_recv_0_12_2 [style=dashed]
	k_proj_0_8 -> kv_recv_0_11_3 [style=dashed]
	v_proj_0_8 -> kv_recv_0_11_3 [style=dashed]
	kv_recv_0_11_3 -> ring_attention_0_11
	k_proj_0_11 -> kv_send_0_11_3
	v_proj_0_11 -> kv_send_0_11_3
	kv_send_0_11_3 -> kv_recv_0_12_3 [style=dashed]
	k_proj_0_7 -> kv_recv_0_11_4 [style=dashed]
	v_proj_0_7 -> kv_recv_0_11_4 [style=dashed]
	kv_recv_0_11_4 -> ring_attention_0_11
	k_proj_0_11 -> kv_send_0_11_4
	v_proj_0_11 -> kv_send_0_11_4
	kv_send_0_11_4 -> kv_recv_0_12_4 [style=dashed]
	k_proj_0_6 -> kv_recv_0_11_5 [style=dashed]
	v_proj_0_6 -> kv_recv_0_11_5 [style=dashed]
	kv_recv_0_11_5 -> ring_attention_0_11
	k_proj_0_11 -> kv_send_0_11_5
	v_proj_0_11 -> kv_send_0_11_5
	kv_send_0_11_5 -> kv_recv_0_12_5 [style=dashed]
	k_proj_0_5 -> kv_recv_0_11_6 [style=dashed]
	v_proj_0_5 -> kv_recv_0_11_6 [style=dashed]
	kv_recv_0_11_6 -> ring_attention_0_11
	k_proj_0_11 -> kv_send_0_11_6
	v_proj_0_11 -> kv_send_0_11_6
	kv_send_0_11_6 -> kv_recv_0_12_6 [style=dashed]
	k_proj_0_4 -> kv_recv_0_11_7 [style=dashed]
	v_proj_0_4 -> kv_recv_0_11_7 [style=dashed]
	kv_recv_0_11_7 -> ring_attention_0_11
	k_proj_0_11 -> kv_send_0_11_7
	v_proj_0_11 -> kv_send_0_11_7
	kv_send_0_11_7 -> kv_recv_0_12_7 [style=dashed]
	k_proj_0_3 -> kv_recv_0_11_8 [style=dashed]
	v_proj_0_3 -> kv_recv_0_11_8 [style=dashed]
	kv_recv_0_11_8 -> ring_attention_0_11
	k_proj_0_11 -> kv_send_0_11_8
	v_proj_0_11 -> kv_send_0_11_8
	kv_send_0_11_8 -> kv_recv_0_12_8 [style=dashed]
	k_proj_0_2 -> kv_recv_0_11_9 [style=dashed]
	v_proj_0_2 -> kv_recv_0_11_9 [style=dashed]
	kv_recv_0_11_9 -> ring_attention_0_11
	k_proj_0_11 -> kv_send_0_11_9
	v_proj_0_11 -> kv_send_0_11_9
	kv_send_0_11_9 -> kv_recv_0_12_9 [style=dashed]
	k_proj_0_1 -> kv_recv_0_11_10 [style=dashed]
	v_proj_0_1 -> kv_recv_0_11_10 [style=dashed]
	kv_recv_0_11_10 -> ring_attention_0_11
	k_proj_0_11 -> kv_send_0_11_10
	v_proj_0_11 -> kv_send_0_11_10
	kv_send_0_11_10 -> kv_recv_0_12_10 [style=dashed]
	k_proj_0_0 -> kv_recv_0_11_11 [style=dashed]
	v_proj_0_0 -> kv_recv_0_11_11 [style=dashed]
	kv_recv_0_11_11 -> ring_attention_0_11
	k_proj_0_11 -> kv_send_0_11_11
	v_proj_0_11 -> kv_send_0_11_11
	kv_send_0_11_11 -> kv_recv_0_12_11 [style=dashed]
	k_proj_0_15 -> kv_recv_0_11_12 [style=dashed]
	v_proj_0_15 -> kv_recv_0_11_12 [style=dashed]
	kv_recv_0_11_12 -> ring_attention_0_11
	k_proj_0_11 -> kv_send_0_11_12
	v_proj_0_11 -> kv_send_0_11_12
	kv_send_0_11_12 -> kv_recv_0_12_12 [style=dashed]
	k_proj_0_14 -> kv_recv_0_11_13 [style=dashed]
	v_proj_0_14 -> kv_recv_0_11_13 [style=dashed]
	kv_recv_0_11_13 -> ring_attention_0_11
	k_proj_0_11 -> kv_send_0_11_13
	v_proj_0_11 -> kv_send_0_11_13
	kv_send_0_11_13 -> kv_recv_0_12_13 [style=dashed]
	k_proj_0_13 -> kv_recv_0_11_14 [style=dashed]
	v_proj_0_13 -> kv_recv_0_11_14 [style=dashed]
	kv_recv_0_11_14 -> ring_attention_0_11
	k_proj_0_11 -> kv_send_0_11_14
	v_proj_0_11 -> kv_send_0_11_14
	kv_send_0_11_14 -> kv_recv_0_12_14 [style=dashed]
	k_proj_0_12 -> kv_recv_0_11_15 [style=dashed]
	v_proj_0_12 -> kv_recv_0_11_15 [style=dashed]
	kv_recv_0_11_15 -> ring_attention_0_11
	k_proj_0_11 -> kv_send_0_11_15
	v_proj_0_11 -> kv_send_0_11_15
	kv_send_0_11_15 -> kv_recv_0_12_15 [style=dashed]
	ring_attention_0_11 -> o_proj_0_11
	o_proj_0_11 -> add_0_11
	embed_11 -> add_0_11
	add_0_11 -> mlp0_gate_11
	add_0_11 -> mlp0_up_11
	mlp0_gate_11 -> mlp0_down_11
	mlp0_up_11 -> mlp0_down_11
	mlp0_down_11 -> add_1_11
	add_0_11 -> add_1_11
	add_1_11 -> ln1_pre_11
	ln1_pre_11 -> q_proj_1_11
	ln1_pre_11 -> k_proj_1_11
	ln1_pre_11 -> v_proj_1_11
	q_proj_1_11 -> ring_attention_1_11
	k_proj_1_11 -> ring_attention_1_11
	v_proj_1_11 -> ring_attention_1_11
	k_proj_1_11 -> kv_recv_1_11_0 [style=dashed]
	v_proj_1_11 -> kv_recv_1_11_0 [style=dashed]
	kv_recv_1_11_0 -> ring_attention_1_11
	k_proj_1_11 -> kv_send_1_11_0
	v_proj_1_11 -> kv_send_1_11_0
	kv_send_1_11_0 -> kv_recv_1_12_0 [style=dashed]
	k_proj_1_10 -> kv_recv_1_11_1 [style=dashed]
	v_proj_1_10 -> kv_recv_1_11_1 [style=dashed]
	kv_recv_1_11_1 -> ring_attention_1_11
	k_proj_1_11 -> kv_send_1_11_1
	v_proj_1_11 -> kv_send_1_11_1
	kv_send_1_11_1 -> kv_recv_1_12_1 [style=dashed]
	k_proj_1_9 -> kv_recv_1_11_2 [style=dashed]
	v_proj_1_9 -> kv_recv_1_11_2 [style=dashed]
	kv_recv_1_11_2 -> ring_attention_1_11
	k_proj_1_11 -> kv_send_1_11_2
	v_proj_1_11 -> kv_send_1_11_2
	kv_send_1_11_2 -> kv_recv_1_12_2 [style=dashed]
	k_proj_1_8 -> kv_recv_1_11_3 [style=dashed]
	v_proj_1_8 -> kv_recv_1_11_3 [style=dashed]
	kv_recv_1_11_3 -> ring_attention_1_11
	k_proj_1_11 -> kv_send_1_11_3
	v_proj_1_11 -> kv_send_1_11_3
	kv_send_1_11_3 -> kv_recv_1_12_3 [style=dashed]
	k_proj_1_7 -> kv_recv_1_11_4 [style=dashed]
	v_proj_1_7 -> kv_recv_1_11_4 [style=dashed]
	kv_recv_1_11_4 -> ring_attention_1_11
	k_proj_1_11 -> kv_send_1_11_4
	v_proj_1_11 -> kv_send_1_11_4
	kv_send_1_11_4 -> kv_recv_1_12_4 [style=dashed]
	k_proj_1_6 -> kv_recv_1_11_5 [style=dashed]
	v_proj_1_6 -> kv_recv_1_11_5 [style=dashed]
	kv_recv_1_11_5 -> ring_attention_1_11
	k_proj_1_11 -> kv_send_1_11_5
	v_proj_1_11 -> kv_send_1_11_5
	kv_send_1_11_5 -> kv_recv_1_12_5 [style=dashed]
	k_proj_1_5 -> kv_recv_1_11_6 [style=dashed]
	v_proj_1_5 -> kv_recv_1_11_6 [style=dashed]
	kv_recv_1_11_6 -> ring_attention_1_11
	k_proj_1_11 -> kv_send_1_11_6
	v_proj_1_11 -> kv_send_1_11_6
	kv_send_1_11_6 -> kv_recv_1_12_6 [style=dashed]
	k_proj_1_4 -> kv_recv_1_11_7 [style=dashed]
	v_proj_1_4 -> kv_recv_1_11_7 [style=dashed]
	kv_recv_1_11_7 -> ring_attention_1_11
	k_proj_1_11 -> kv_send_1_11_7
	v_proj_1_11 -> kv_send_1_11_7
	kv_send_1_11_7 -> kv_recv_1_12_7 [style=dashed]
	k_proj_1_3 -> kv_recv_1_11_8 [style=dashed]
	v_proj_1_3 -> kv_recv_1_11_8 [style=dashed]
	kv_recv_1_11_8 -> ring_attention_1_11
	k_proj_1_11 -> kv_send_1_11_8
	v_proj_1_11 -> kv_send_1_11_8
	kv_send_1_11_8 -> kv_recv_1_12_8 [style=dashed]
	k_proj_1_2 -> kv_recv_1_11_9 [style=dashed]
	v_proj_1_2 -> kv_recv_1_11_9 [style=dashed]
	kv_recv_1_11_9 -> ring_attention_1_11
	k_proj_1_11 -> kv_send_1_11_9
	v_proj_1_11 -> kv_send_1_11_9
	kv_send_1_11_9 -> kv_recv_1_12_9 [style=dashed]
	k_proj_1_1 -> kv_recv_1_11_10 [style=dashed]
	v_proj_1_1 -> kv_recv_1_11_10 [style=dashed]
	kv_recv_1_11_10 -> ring_attention_1_11
	k_proj_1_11 -> kv_send_1_11_10
	v_proj_1_11 -> kv_send_1_11_10
	kv_send_1_11_10 -> kv_recv_1_12_10 [style=dashed]
	k_proj_1_0 -> kv_recv_1_11_11 [style=dashed]
	v_proj_1_0 -> kv_recv_1_11_11 [style=dashed]
	kv_recv_1_11_11 -> ring_attention_1_11
	k_proj_1_11 -> kv_send_1_11_11
	v_proj_1_11 -> kv_send_1_11_11
	kv_send_1_11_11 -> kv_recv_1_12_11 [style=dashed]
	k_proj_1_15 -> kv_recv_1_11_12 [style=dashed]
	v_proj_1_15 -> kv_recv_1_11_12 [style=dashed]
	kv_recv_1_11_12 -> ring_attention_1_11
	k_proj_1_11 -> kv_send_1_11_12
	v_proj_1_11 -> kv_send_1_11_12
	kv_send_1_11_12 -> kv_recv_1_12_12 [style=dashed]
	k_proj_1_14 -> kv_recv_1_11_13 [style=dashed]
	v_proj_1_14 -> kv_recv_1_11_13 [style=dashed]
	kv_recv_1_11_13 -> ring_attention_1_11
	k_proj_1_11 -> kv_send_1_11_13
	v_proj_1_11 -> kv_send_1_11_13
	kv_send_1_11_13 -> kv_recv_1_12_13 [style=dashed]
	k_proj_1_13 -> kv_recv_1_11_14 [style=dashed]
	v_proj_1_13 -> kv_recv_1_11_14 [style=dashed]
	kv_recv_1_11_14 -> ring_attention_1_11
	k_proj_1_11 -> kv_send_1_11_14
	v_proj_1_11 -> kv_send_1_11_14
	kv_send_1_11_14 -> kv_recv_1_12_14 [style=dashed]
	k_proj_1_12 -> kv_recv_1_11_15 [style=dashed]
	v_proj_1_12 -> kv_recv_1_11_15 [style=dashed]
	kv_recv_1_11_15 -> ring_attention_1_11
	k_proj_1_11 -> kv_send_1_11_15
	v_proj_1_11 -> kv_send_1_11_15
	kv_send_1_11_15 -> kv_recv_1_12_15 [style=dashed]
	ring_attention_1_11 -> o_proj_1_11
	o_proj_1_11 -> add_2_11
	add_1_11 -> add_2_11
	add_2_11 -> mlp1_gate_11
	add_2_11 -> mlp1_up_11
	mlp1_gate_11 -> mlp1_down_11
	mlp1_up_11 -> mlp1_down_11
	mlp1_down_11 -> add_3_11
	add_2_11 -> add_3_11
	add_3_11 -> ln2_pre_11
	ln2_pre_11 -> ring_attention_2_11
	ring_attention_2_11 -> o_proj_2_11
	o_proj_2_11 -> add_4_11
	add_3_11 -> add_4_11
	add_4_11 -> mlp2_down_11
	mlp2_down_11 -> add_5_11
	add_4_11 -> add_5_11
	add_5_11 -> ln3_pre_11
	ln3_pre_11 -> ring_attention_3_11
	ring_attention_3_11 -> o_proj_3_11
	o_proj_3_11 -> add_6_11
	add_5_11 -> add_6_11
	add_6_11 -> mlp3_down_11
	mlp3_down_11 -> add_7_11
	add_6_11 -> add_7_11
	add_7_11 -> output_gather_11
	output_gather_0 -> global_output
	output_gather_1 -> global_output
	output_gather_2 -> global_output
	output_gather_3 -> global_output
	output_gather_4 -> global_output
	output_gather_5 -> global_output
	output_gather_6 -> global_output
	output_gather_7 -> global_output
	output_gather_8 -> global_output
	output_gather_9 -> global_output
	output_gather_10 -> global_output
	output_gather_11 -> global_output
	output_gather_12 -> global_output
	output_gather_13 -> global_output
	output_gather_14 -> global_output
	output_gather_15 -> global_output
	global_input -> input_split_12
	input_split_12 -> embed_12
	embed_12 -> ln0_pre_12
	ln0_pre_12 -> q_proj_0_12
	ln0_pre_12 -> k_proj_0_12
	ln0_pre_12 -> v_proj_0_12
	q_proj_0_12 -> ring_attention_0_12
	k_proj_0_12 -> ring_attention_0_12
	v_proj_0_12 -> ring_attention_0_12
	k_proj_0_12 -> kv_recv_0_12_0 [style=dashed]
	v_proj_0_12 -> kv_recv_0_12_0 [style=dashed]
	kv_recv_0_12_0 -> ring_attention_0_12
	k_proj_0_12 -> kv_send_0_12_0
	v_proj_0_12 -> kv_send_0_12_0
	kv_send_0_12_0 -> kv_recv_0_13_0 [style=dashed]
	k_proj_0_11 -> kv_recv_0_12_1 [style=dashed]
	v_proj_0_11 -> kv_recv_0_12_1 [style=dashed]
	kv_recv_0_12_1 -> ring_attention_0_12
	k_proj_0_12 -> kv_send_0_12_1
	v_proj_0_12 -> kv_send_0_12_1
	kv_send_0_12_1 -> kv_recv_0_13_1 [style=dashed]
	k_proj_0_10 -> kv_recv_0_12_2 [style=dashed]
	v_proj_0_10 -> kv_recv_0_12_2 [style=dashed]
	kv_recv_0_12_2 -> ring_attention_0_12
	k_proj_0_12 -> kv_send_0_12_2
	v_proj_0_12 -> kv_send_0_12_2
	kv_send_0_12_2 -> kv_recv_0_13_2 [style=dashed]
	k_proj_0_9 -> kv_recv_0_12_3 [style=dashed]
	v_proj_0_9 -> kv_recv_0_12_3 [style=dashed]
	kv_recv_0_12_3 -> ring_attention_0_12
	k_proj_0_12 -> kv_send_0_12_3
	v_proj_0_12 -> kv_send_0_12_3
	kv_send_0_12_3 -> kv_recv_0_13_3 [style=dashed]
	k_proj_0_8 -> kv_recv_0_12_4 [style=dashed]
	v_proj_0_8 -> kv_recv_0_12_4 [style=dashed]
	kv_recv_0_12_4 -> ring_attention_0_12
	k_proj_0_12 -> kv_send_0_12_4
	v_proj_0_12 -> kv_send_0_12_4
	kv_send_0_12_4 -> kv_recv_0_13_4 [style=dashed]
	k_proj_0_7 -> kv_recv_0_12_5 [style=dashed]
	v_proj_0_7 -> kv_recv_0_12_5 [style=dashed]
	kv_recv_0_12_5 -> ring_attention_0_12
	k_proj_0_12 -> kv_send_0_12_5
	v_proj_0_12 -> kv_send_0_12_5
	kv_send_0_12_5 -> kv_recv_0_13_5 [style=dashed]
	k_proj_0_6 -> kv_recv_0_12_6 [style=dashed]
	v_proj_0_6 -> kv_recv_0_12_6 [style=dashed]
	kv_recv_0_12_6 -> ring_attention_0_12
	k_proj_0_12 -> kv_send_0_12_6
	v_proj_0_12 -> kv_send_0_12_6
	kv_send_0_12_6 -> kv_recv_0_13_6 [style=dashed]
	k_proj_0_5 -> kv_recv_0_12_7 [style=dashed]
	v_proj_0_5 -> kv_recv_0_12_7 [style=dashed]
	kv_recv_0_12_7 -> ring_attention_0_12
	k_proj_0_12 -> kv_send_0_12_7
	v_proj_0_12 -> kv_send_0_12_7
	kv_send_0_12_7 -> kv_recv_0_13_7 [style=dashed]
	k_proj_0_4 -> kv_recv_0_12_8 [style=dashed]
	v_proj_0_4 -> kv_recv_0_12_8 [style=dashed]
	kv_recv_0_12_8 -> ring_attention_0_12
	k_proj_0_12 -> kv_send_0_12_8
	v_proj_0_12 -> kv_send_0_12_8
	kv_send_0_12_8 -> kv_recv_0_13_8 [style=dashed]
	k_proj_0_3 -> kv_recv_0_12_9 [style=dashed]
	v_proj_0_3 -> kv_recv_0_12_9 [style=dashed]
	kv_recv_0_12_9 -> ring_attention_0_12
	k_proj_0_12 -> kv_send_0_12_9
	v_proj_0_12 -> kv_send_0_12_9
	kv_send_0_12_9 -> kv_recv_0_13_9 [style=dashed]
	k_proj_0_2 -> kv_recv_0_12_10 [style=dashed]
	v_proj_0_2 -> kv_recv_0_12_10 [style=dashed]
	kv_recv_0_12_10 -> ring_attention_0_12
	k_proj_0_12 -> kv_send_0_12_10
	v_proj_0_12 -> kv_send_0_12_10
	kv_send_0_12_10 -> kv_recv_0_13_10 [style=dashed]
	k_proj_0_1 -> kv_recv_0_12_11 [style=dashed]
	v_proj_0_1 -> kv_recv_0_12_11 [style=dashed]
	kv_recv_0_12_11 -> ring_attention_0_12
	k_proj_0_12 -> kv_send_0_12_11
	v_proj_0_12 -> kv_send_0_12_11
	kv_send_0_12_11 -> kv_recv_0_13_11 [style=dashed]
	k_proj_0_0 -> kv_recv_0_12_12 [style=dashed]
	v_proj_0_0 -> kv_recv_0_12_12 [style=dashed]
	kv_recv_0_12_12 -> ring_attention_0_12
	k_proj_0_12 -> kv_send_0_12_12
	v_proj_0_12 -> kv_send_0_12_12
	kv_send_0_12_12 -> kv_recv_0_13_12 [style=dashed]
	k_proj_0_15 -> kv_recv_0_12_13 [style=dashed]
	v_proj_0_15 -> kv_recv_0_12_13 [style=dashed]
	kv_recv_0_12_13 -> ring_attention_0_12
	k_proj_0_12 -> kv_send_0_12_13
	v_proj_0_12 -> kv_send_0_12_13
	kv_send_0_12_13 -> kv_recv_0_13_13 [style=dashed]
	k_proj_0_14 -> kv_recv_0_12_14 [style=dashed]
	v_proj_0_14 -> kv_recv_0_12_14 [style=dashed]
	kv_recv_0_12_14 -> ring_attention_0_12
	k_proj_0_12 -> kv_send_0_12_14
	v_proj_0_12 -> kv_send_0_12_14
	kv_send_0_12_14 -> kv_recv_0_13_14 [style=dashed]
	k_proj_0_13 -> kv_recv_0_12_15 [style=dashed]
	v_proj_0_13 -> kv_recv_0_12_15 [style=dashed]
	kv_recv_0_12_15 -> ring_attention_0_12
	k_proj_0_12 -> kv_send_0_12_15
	v_proj_0_12 -> kv_send_0_12_15
	kv_send_0_12_15 -> kv_recv_0_13_15 [style=dashed]
	ring_attention_0_12 -> o_proj_0_12
	o_proj_0_12 -> add_0_12
	embed_12 -> add_0_12
	add_0_12 -> mlp0_gate_12
	add_0_12 -> mlp0_up_12
	mlp0_gate_12 -> mlp0_down_12
	mlp0_up_12 -> mlp0_down_12
	mlp0_down_12 -> add_1_12
	add_0_12 -> add_1_12
	add_1_12 -> ln1_pre_12
	ln1_pre_12 -> q_proj_1_12
	ln1_pre_12 -> k_proj_1_12
	ln1_pre_12 -> v_proj_1_12
	q_proj_1_12 -> ring_attention_1_12
	k_proj_1_12 -> ring_attention_1_12
	v_proj_1_12 -> ring_attention_1_12
	k_proj_1_12 -> kv_recv_1_12_0 [style=dashed]
	v_proj_1_12 -> kv_recv_1_12_0 [style=dashed]
	kv_recv_1_12_0 -> ring_attention_1_12
	k_proj_1_12 -> kv_send_1_12_0
	v_proj_1_12 -> kv_send_1_12_0
	kv_send_1_12_0 -> kv_recv_1_13_0 [style=dashed]
	k_proj_1_11 -> kv_recv_1_12_1 [style=dashed]
	v_proj_1_11 -> kv_recv_1_12_1 [style=dashed]
	kv_recv_1_12_1 -> ring_attention_1_12
	k_proj_1_12 -> kv_send_1_12_1
	v_proj_1_12 -> kv_send_1_12_1
	kv_send_1_12_1 -> kv_recv_1_13_1 [style=dashed]
	k_proj_1_10 -> kv_recv_1_12_2 [style=dashed]
	v_proj_1_10 -> kv_recv_1_12_2 [style=dashed]
	kv_recv_1_12_2 -> ring_attention_1_12
	k_proj_1_12 -> kv_send_1_12_2
	v_proj_1_12 -> kv_send_1_12_2
	kv_send_1_12_2 -> kv_recv_1_13_2 [style=dashed]
	k_proj_1_9 -> kv_recv_1_12_3 [style=dashed]
	v_proj_1_9 -> kv_recv_1_12_3 [style=dashed]
	kv_recv_1_12_3 -> ring_attention_1_12
	k_proj_1_12 -> kv_send_1_12_3
	v_proj_1_12 -> kv_send_1_12_3
	kv_send_1_12_3 -> kv_recv_1_13_3 [style=dashed]
	k_proj_1_8 -> kv_recv_1_12_4 [style=dashed]
	v_proj_1_8 -> kv_recv_1_12_4 [style=dashed]
	kv_recv_1_12_4 -> ring_attention_1_12
	k_proj_1_12 -> kv_send_1_12_4
	v_proj_1_12 -> kv_send_1_12_4
	kv_send_1_12_4 -> kv_recv_1_13_4 [style=dashed]
	k_proj_1_7 -> kv_recv_1_12_5 [style=dashed]
	v_proj_1_7 -> kv_recv_1_12_5 [style=dashed]
	kv_recv_1_12_5 -> ring_attention_1_12
	k_proj_1_12 -> kv_send_1_12_5
	v_proj_1_12 -> kv_send_1_12_5
	kv_send_1_12_5 -> kv_recv_1_13_5 [style=dashed]
	k_proj_1_6 -> kv_recv_1_12_6 [style=dashed]
	v_proj_1_6 -> kv_recv_1_12_6 [style=dashed]
	kv_recv_1_12_6 -> ring_attention_1_12
	k_proj_1_12 -> kv_send_1_12_6
	v_proj_1_12 -> kv_send_1_12_6
	kv_send_1_12_6 -> kv_recv_1_13_6 [style=dashed]
	k_proj_1_5 -> kv_recv_1_12_7 [style=dashed]
	v_proj_1_5 -> kv_recv_1_12_7 [style=dashed]
	kv_recv_1_12_7 -> ring_attention_1_12
	k_proj_1_12 -> kv_send_1_12_7
	v_proj_1_12 -> kv_send_1_12_7
	kv_send_1_12_7 -> kv_recv_1_13_7 [style=dashed]
	k_proj_1_4 -> kv_recv_1_12_8 [style=dashed]
	v_proj_1_4 -> kv_recv_1_12_8 [style=dashed]
	kv_recv_1_12_8 -> ring_attention_1_12
	k_proj_1_12 -> kv_send_1_12_8
	v_proj_1_12 -> kv_send_1_12_8
	kv_send_1_12_8 -> kv_recv_1_13_8 [style=dashed]
	k_proj_1_3 -> kv_recv_1_12_9 [style=dashed]
	v_proj_1_3 -> kv_recv_1_12_9 [style=dashed]
	kv_recv_1_12_9 -> ring_attention_1_12
	k_proj_1_12 -> kv_send_1_12_9
	v_proj_1_12 -> kv_send_1_12_9
	kv_send_1_12_9 -> kv_recv_1_13_9 [style=dashed]
	k_proj_1_2 -> kv_recv_1_12_10 [style=dashed]
	v_proj_1_2 -> kv_recv_1_12_10 [style=dashed]
	kv_recv_1_12_10 -> ring_attention_1_12
	k_proj_1_12 -> kv_send_1_12_10
	v_proj_1_12 -> kv_send_1_12_10
	kv_send_1_12_10 -> kv_recv_1_13_10 [style=dashed]
	k_proj_1_1 -> kv_recv_1_12_11 [style=dashed]
	v_proj_1_1 -> kv_recv_1_12_11 [style=dashed]
	kv_recv_1_12_11 -> ring_attention_1_12
	k_proj_1_12 -> kv_send_1_12_11
	v_proj_1_12 -> kv_send_1_12_11
	kv_send_1_12_11 -> kv_recv_1_13_11 [style=dashed]
	k_proj_1_0 -> kv_recv_1_12_12 [style=dashed]
	v_proj_1_0 -> kv_recv_1_12_12 [style=dashed]
	kv_recv_1_12_12 -> ring_attention_1_12
	k_proj_1_12 -> kv_send_1_12_12
	v_proj_1_12 -> kv_send_1_12_12
	kv_send_1_12_12 -> kv_recv_1_13_12 [style=dashed]
	k_proj_1_15 -> kv_recv_1_12_13 [style=dashed]
	v_proj_1_15 -> kv_recv_1_12_13 [style=dashed]
	kv_recv_1_12_13 -> ring_attention_1_12
	k_proj_1_12 -> kv_send_1_12_13
	v_proj_1_12 -> kv_send_1_12_13
	kv_send_1_12_13 -> kv_recv_1_13_13 [style=dashed]
	k_proj_1_14 -> kv_recv_1_12_14 [style=dashed]
	v_proj_1_14 -> kv_recv_1_12_14 [style=dashed]
	kv_recv_1_12_14 -> ring_attention_1_12
	k_proj_1_12 -> kv_send_1_12_14
	v_proj_1_12 -> kv_send_1_12_14
	kv_send_1_12_14 -> kv_recv_1_13_14 [style=dashed]
	k_proj_1_13 -> kv_recv_1_12_15 [style=dashed]
	v_proj_1_13 -> kv_recv_1_12_15 [style=dashed]
	kv_recv_1_12_15 -> ring_attention_1_12
	k_proj_1_12 -> kv_send_1_12_15
	v_proj_1_12 -> kv_send_1_12_15
	kv_send_1_12_15 -> kv_recv_1_13_15 [style=dashed]
	ring_attention_1_12 -> o_proj_1_12
	o_proj_1_12 -> add_2_12
	add_1_12 -> add_2_12
	add_2_12 -> mlp1_gate_12
	add_2_12 -> mlp1_up_12
	mlp1_gate_12 -> mlp1_down_12
	mlp1_up_12 -> mlp1_down_12
	mlp1_down_12 -> add_3_12
	add_2_12 -> add_3_12
	add_3_12 -> ln2_pre_12
	ln2_pre_12 -> ring_attention_2_12
	ring_attention_2_12 -> o_proj_2_12
	o_proj_2_12 -> add_4_12
	add_3_12 -> add_4_12
	add_4_12 -> mlp2_down_12
	mlp2_down_12 -> add_5_12
	add_4_12 -> add_5_12
	add_5_12 -> ln3_pre_12
	ln3_pre_12 -> ring_attention_3_12
	ring_attention_3_12 -> o_proj_3_12
	o_proj_3_12 -> add_6_12
	add_5_12 -> add_6_12
	add_6_12 -> mlp3_down_12
	mlp3_down_12 -> add_7_12
	add_6_12 -> add_7_12
	add_7_12 -> output_gather_12
	output_gather_0 -> global_output
	output_gather_1 -> global_output
	output_gather_2 -> global_output
	output_gather_3 -> global_output
	output_gather_4 -> global_output
	output_gather_5 -> global_output
	output_gather_6 -> global_output
	output_gather_7 -> global_output
	output_gather_8 -> global_output
	output_gather_9 -> global_output
	output_gather_10 -> global_output
	output_gather_11 -> global_output
	output_gather_12 -> global_output
	output_gather_13 -> global_output
	output_gather_14 -> global_output
	output_gather_15 -> global_output
	global_input -> input_split_13
	input_split_13 -> embed_13
	embed_13 -> ln0_pre_13
	ln0_pre_13 -> q_proj_0_13
	ln0_pre_13 -> k_proj_0_13
	ln0_pre_13 -> v_proj_0_13
	q_proj_0_13 -> ring_attention_0_13
	k_proj_0_13 -> ring_attention_0_13
	v_proj_0_13 -> ring_attention_0_13
	k_proj_0_13 -> kv_recv_0_13_0 [style=dashed]
	v_proj_0_13 -> kv_recv_0_13_0 [style=dashed]
	kv_recv_0_13_0 -> ring_attention_0_13
	k_proj_0_13 -> kv_send_0_13_0
	v_proj_0_13 -> kv_send_0_13_0
	kv_send_0_13_0 -> kv_recv_0_14_0 [style=dashed]
	k_proj_0_12 -> kv_recv_0_13_1 [style=dashed]
	v_proj_0_12 -> kv_recv_0_13_1 [style=dashed]
	kv_recv_0_13_1 -> ring_attention_0_13
	k_proj_0_13 -> kv_send_0_13_1
	v_proj_0_13 -> kv_send_0_13_1
	kv_send_0_13_1 -> kv_recv_0_14_1 [style=dashed]
	k_proj_0_11 -> kv_recv_0_13_2 [style=dashed]
	v_proj_0_11 -> kv_recv_0_13_2 [style=dashed]
	kv_recv_0_13_2 -> ring_attention_0_13
	k_proj_0_13 -> kv_send_0_13_2
	v_proj_0_13 -> kv_send_0_13_2
	kv_send_0_13_2 -> kv_recv_0_14_2 [style=dashed]
	k_proj_0_10 -> kv_recv_0_13_3 [style=dashed]
	v_proj_0_10 -> kv_recv_0_13_3 [style=dashed]
	kv_recv_0_13_3 -> ring_attention_0_13
	k_proj_0_13 -> kv_send_0_13_3
	v_proj_0_13 -> kv_send_0_13_3
	kv_send_0_13_3 -> kv_recv_0_14_3 [style=dashed]
	k_proj_0_9 -> kv_recv_0_13_4 [style=dashed]
	v_proj_0_9 -> kv_recv_0_13_4 [style=dashed]
	kv_recv_0_13_4 -> ring_attention_0_13
	k_proj_0_13 -> kv_send_0_13_4
	v_proj_0_13 -> kv_send_0_13_4
	kv_send_0_13_4 -> kv_recv_0_14_4 [style=dashed]
	k_proj_0_8 -> kv_recv_0_13_5 [style=dashed]
	v_proj_0_8 -> kv_recv_0_13_5 [style=dashed]
	kv_recv_0_13_5 -> ring_attention_0_13
	k_proj_0_13 -> kv_send_0_13_5
	v_proj_0_13 -> kv_send_0_13_5
	kv_send_0_13_5 -> kv_recv_0_14_5 [style=dashed]
	k_proj_0_7 -> kv_recv_0_13_6 [style=dashed]
	v_proj_0_7 -> kv_recv_0_13_6 [style=dashed]
	kv_recv_0_13_6 -> ring_attention_0_13
	k_proj_0_13 -> kv_send_0_13_6
	v_proj_0_13 -> kv_send_0_13_6
	kv_send_0_13_6 -> kv_recv_0_14_6 [style=dashed]
	k_proj_0_6 -> kv_recv_0_13_7 [style=dashed]
	v_proj_0_6 -> kv_recv_0_13_7 [style=dashed]
	kv_recv_0_13_7 -> ring_attention_0_13
	k_proj_0_13 -> kv_send_0_13_7
	v_proj_0_13 -> kv_send_0_13_7
	kv_send_0_13_7 -> kv_recv_0_14_7 [style=dashed]
	k_proj_0_5 -> kv_recv_0_13_8 [style=dashed]
	v_proj_0_5 -> kv_recv_0_13_8 [style=dashed]
	kv_recv_0_13_8 -> ring_attention_0_13
	k_proj_0_13 -> kv_send_0_13_8
	v_proj_0_13 -> kv_send_0_13_8
	kv_send_0_13_8 -> kv_recv_0_14_8 [style=dashed]
	k_proj_0_4 -> kv_recv_0_13_9 [style=dashed]
	v_proj_0_4 -> kv_recv_0_13_9 [style=dashed]
	kv_recv_0_13_9 -> ring_attention_0_13
	k_proj_0_13 -> kv_send_0_13_9
	v_proj_0_13 -> kv_send_0_13_9
	kv_send_0_13_9 -> kv_recv_0_14_9 [style=dashed]
	k_proj_0_3 -> kv_recv_0_13_10 [style=dashed]
	v_proj_0_3 -> kv_recv_0_13_10 [style=dashed]
	kv_recv_0_13_10 -> ring_attention_0_13
	k_proj_0_13 -> kv_send_0_13_10
	v_proj_0_13 -> kv_send_0_13_10
	kv_send_0_13_10 -> kv_recv_0_14_10 [style=dashed]
	k_proj_0_2 -> kv_recv_0_13_11 [style=dashed]
	v_proj_0_2 -> kv_recv_0_13_11 [style=dashed]
	kv_recv_0_13_11 -> ring_attention_0_13
	k_proj_0_13 -> kv_send_0_13_11
	v_proj_0_13 -> kv_send_0_13_11
	kv_send_0_13_11 -> kv_recv_0_14_11 [style=dashed]
	k_proj_0_1 -> kv_recv_0_13_12 [style=dashed]
	v_proj_0_1 -> kv_recv_0_13_12 [style=dashed]
	kv_recv_0_13_12 -> ring_attention_0_13
	k_proj_0_13 -> kv_send_0_13_12
	v_proj_0_13 -> kv_send_0_13_12
	kv_send_0_13_12 -> kv_recv_0_14_12 [style=dashed]
	k_proj_0_0 -> kv_recv_0_13_13 [style=dashed]
	v_proj_0_0 -> kv_recv_0_13_13 [style=dashed]
	kv_recv_0_13_13 -> ring_attention_0_13
	k_proj_0_13 -> kv_send_0_13_13
	v_proj_0_13 -> kv_send_0_13_13
	kv_send_0_13_13 -> kv_recv_0_14_13 [style=dashed]
	k_proj_0_15 -> kv_recv_0_13_14 [style=dashed]
	v_proj_0_15 -> kv_recv_0_13_14 [style=dashed]
	kv_recv_0_13_14 -> ring_attention_0_13
	k_proj_0_13 -> kv_send_0_13_14
	v_proj_0_13 -> kv_send_0_13_14
	kv_send_0_13_14 -> kv_recv_0_14_14 [style=dashed]
	k_proj_0_14 -> kv_recv_0_13_15 [style=dashed]
	v_proj_0_14 -> kv_recv_0_13_15 [style=dashed]
	kv_recv_0_13_15 -> ring_attention_0_13
	k_proj_0_13 -> kv_send_0_13_15
	v_proj_0_13 -> kv_send_0_13_15
	kv_send_0_13_15 -> kv_recv_0_14_15 [style=dashed]
	ring_attention_0_13 -> o_proj_0_13
	o_proj_0_13 -> add_0_13
	embed_13 -> add_0_13
	add_0_13 -> mlp0_gate_13
	add_0_13 -> mlp0_up_13
	mlp0_gate_13 -> mlp0_down_13
	mlp0_up_13 -> mlp0_down_13
	mlp0_down_13 -> add_1_13
	add_0_13 -> add_1_13
	add_1_13 -> ln1_pre_13
	ln1_pre_13 -> q_proj_1_13
	ln1_pre_13 -> k_proj_1_13
	ln1_pre_13 -> v_proj_1_13
	q_proj_1_13 -> ring_attention_1_13
	k_proj_1_13 -> ring_attention_1_13
	v_proj_1_13 -> ring_attention_1_13
	k_proj_1_13 -> kv_recv_1_13_0 [style=dashed]
	v_proj_1_13 -> kv_recv_1_13_0 [style=dashed]
	kv_recv_1_13_0 -> ring_attention_1_13
	k_proj_1_13 -> kv_send_1_13_0
	v_proj_1_13 -> kv_send_1_13_0
	kv_send_1_13_0 -> kv_recv_1_14_0 [style=dashed]
	k_proj_1_12 -> kv_recv_1_13_1 [style=dashed]
	v_proj_1_12 -> kv_recv_1_13_1 [style=dashed]
	kv_recv_1_13_1 -> ring_attention_1_13
	k_proj_1_13 -> kv_send_1_13_1
	v_proj_1_13 -> kv_send_1_13_1
	kv_send_1_13_1 -> kv_recv_1_14_1 [style=dashed]
	k_proj_1_11 -> kv_recv_1_13_2 [style=dashed]
	v_proj_1_11 -> kv_recv_1_13_2 [style=dashed]
	kv_recv_1_13_2 -> ring_attention_1_13
	k_proj_1_13 -> kv_send_1_13_2
	v_proj_1_13 -> kv_send_1_13_2
	kv_send_1_13_2 -> kv_recv_1_14_2 [style=dashed]
	k_proj_1_10 -> kv_recv_1_13_3 [style=dashed]
	v_proj_1_10 -> kv_recv_1_13_3 [style=dashed]
	kv_recv_1_13_3 -> ring_attention_1_13
	k_proj_1_13 -> kv_send_1_13_3
	v_proj_1_13 -> kv_send_1_13_3
	kv_send_1_13_3 -> kv_recv_1_14_3 [style=dashed]
	k_proj_1_9 -> kv_recv_1_13_4 [style=dashed]
	v_proj_1_9 -> kv_recv_1_13_4 [style=dashed]
	kv_recv_1_13_4 -> ring_attention_1_13
	k_proj_1_13 -> kv_send_1_13_4
	v_proj_1_13 -> kv_send_1_13_4
	kv_send_1_13_4 -> kv_recv_1_14_4 [style=dashed]
	k_proj_1_8 -> kv_recv_1_13_5 [style=dashed]
	v_proj_1_8 -> kv_recv_1_13_5 [style=dashed]
	kv_recv_1_13_5 -> ring_attention_1_13
	k_proj_1_13 -> kv_send_1_13_5
	v_proj_1_13 -> kv_send_1_13_5
	kv_send_1_13_5 -> kv_recv_1_14_5 [style=dashed]
	k_proj_1_7 -> kv_recv_1_13_6 [style=dashed]
	v_proj_1_7 -> kv_recv_1_13_6 [style=dashed]
	kv_recv_1_13_6 -> ring_attention_1_13
	k_proj_1_13 -> kv_send_1_13_6
	v_proj_1_13 -> kv_send_1_13_6
	kv_send_1_13_6 -> kv_recv_1_14_6 [style=dashed]
	k_proj_1_6 -> kv_recv_1_13_7 [style=dashed]
	v_proj_1_6 -> kv_recv_1_13_7 [style=dashed]
	kv_recv_1_13_7 -> ring_attention_1_13
	k_proj_1_13 -> kv_send_1_13_7
	v_proj_1_13 -> kv_send_1_13_7
	kv_send_1_13_7 -> kv_recv_1_14_7 [style=dashed]
	k_proj_1_5 -> kv_recv_1_13_8 [style=dashed]
	v_proj_1_5 -> kv_recv_1_13_8 [style=dashed]
	kv_recv_1_13_8 -> ring_attention_1_13
	k_proj_1_13 -> kv_send_1_13_8
	v_proj_1_13 -> kv_send_1_13_8
	kv_send_1_13_8 -> kv_recv_1_14_8 [style=dashed]
	k_proj_1_4 -> kv_recv_1_13_9 [style=dashed]
	v_proj_1_4 -> kv_recv_1_13_9 [style=dashed]
	kv_recv_1_13_9 -> ring_attention_1_13
	k_proj_1_13 -> kv_send_1_13_9
	v_proj_1_13 -> kv_send_1_13_9
	kv_send_1_13_9 -> kv_recv_1_14_9 [style=dashed]
	k_proj_1_3 -> kv_recv_1_13_10 [style=dashed]
	v_proj_1_3 -> kv_recv_1_13_10 [style=dashed]
	kv_recv_1_13_10 -> ring_attention_1_13
	k_proj_1_13 -> kv_send_1_13_10
	v_proj_1_13 -> kv_send_1_13_10
	kv_send_1_13_10 -> kv_recv_1_14_10 [style=dashed]
	k_proj_1_2 -> kv_recv_1_13_11 [style=dashed]
	v_proj_1_2 -> kv_recv_1_13_11 [style=dashed]
	kv_recv_1_13_11 -> ring_attention_1_13
	k_proj_1_13 -> kv_send_1_13_11
	v_proj_1_13 -> kv_send_1_13_11
	kv_send_1_13_11 -> kv_recv_1_14_11 [style=dashed]
	k_proj_1_1 -> kv_recv_1_13_12 [style=dashed]
	v_proj_1_1 -> kv_recv_1_13_12 [style=dashed]
	kv_recv_1_13_12 -> ring_attention_1_13
	k_proj_1_13 -> kv_send_1_13_12
	v_proj_1_13 -> kv_send_1_13_12
	kv_send_1_13_12 -> kv_recv_1_14_12 [style=dashed]
	k_proj_1_0 -> kv_recv_1_13_13 [style=dashed]
	v_proj_1_0 -> kv_recv_1_13_13 [style=dashed]
	kv_recv_1_13_13 -> ring_attention_1_13
	k_proj_1_13 -> kv_send_1_13_13
	v_proj_1_13 -> kv_send_1_13_13
	kv_send_1_13_13 -> kv_recv_1_14_13 [style=dashed]
	k_proj_1_15 -> kv_recv_1_13_14 [style=dashed]
	v_proj_1_15 -> kv_recv_1_13_14 [style=dashed]
	kv_recv_1_13_14 -> ring_attention_1_13
	k_proj_1_13 -> kv_send_1_13_14
	v_proj_1_13 -> kv_send_1_13_14
	kv_send_1_13_14 -> kv_recv_1_14_14 [style=dashed]
	k_proj_1_14 -> kv_recv_1_13_15 [style=dashed]
	v_proj_1_14 -> kv_recv_1_13_15 [style=dashed]
	kv_recv_1_13_15 -> ring_attention_1_13
	k_proj_1_13 -> kv_send_1_13_15
	v_proj_1_13 -> kv_send_1_13_15
	kv_send_1_13_15 -> kv_recv_1_14_15 [style=dashed]
	ring_attention_1_13 -> o_proj_1_13
	o_proj_1_13 -> add_2_13
	add_1_13 -> add_2_13
	add_2_13 -> mlp1_gate_13
	add_2_13 -> mlp1_up_13
	mlp1_gate_13 -> mlp1_down_13
	mlp1_up_13 -> mlp1_down_13
	mlp1_down_13 -> add_3_13
	add_2_13 -> add_3_13
	add_3_13 -> ln2_pre_13
	ln2_pre_13 -> ring_attention_2_13
	ring_attention_2_13 -> o_proj_2_13
	o_proj_2_13 -> add_4_13
	add_3_13 -> add_4_13
	add_4_13 -> mlp2_down_13
	mlp2_down_13 -> add_5_13
	add_4_13 -> add_5_13
	add_5_13 -> ln3_pre_13
	ln3_pre_13 -> ring_attention_3_13
	ring_attention_3_13 -> o_proj_3_13
	o_proj_3_13 -> add_6_13
	add_5_13 -> add_6_13
	add_6_13 -> mlp3_down_13
	mlp3_down_13 -> add_7_13
	add_6_13 -> add_7_13
	add_7_13 -> output_gather_13
	output_gather_0 -> global_output
	output_gather_1 -> global_output
	output_gather_2 -> global_output
	output_gather_3 -> global_output
	output_gather_4 -> global_output
	output_gather_5 -> global_output
	output_gather_6 -> global_output
	output_gather_7 -> global_output
	output_gather_8 -> global_output
	output_gather_9 -> global_output
	output_gather_10 -> global_output
	output_gather_11 -> global_output
	output_gather_12 -> global_output
	output_gather_13 -> global_output
	output_gather_14 -> global_output
	output_gather_15 -> global_output
	global_input -> input_split_14
	input_split_14 -> embed_14
	embed_14 -> ln0_pre_14
	ln0_pre_14 -> q_proj_0_14
	ln0_pre_14 -> k_proj_0_14
	ln0_pre_14 -> v_proj_0_14
	q_proj_0_14 -> ring_attention_0_14
	k_proj_0_14 -> ring_attention_0_14
	v_proj_0_14 -> ring_attention_0_14
	k_proj_0_14 -> kv_recv_0_14_0 [style=dashed]
	v_proj_0_14 -> kv_recv_0_14_0 [style=dashed]
	kv_recv_0_14_0 -> ring_attention_0_14
	k_proj_0_14 -> kv_send_0_14_0
	v_proj_0_14 -> kv_send_0_14_0
	kv_send_0_14_0 -> kv_recv_0_15_0 [style=dashed]
	k_proj_0_13 -> kv_recv_0_14_1 [style=dashed]
	v_proj_0_13 -> kv_recv_0_14_1 [style=dashed]
	kv_recv_0_14_1 -> ring_attention_0_14
	k_proj_0_14 -> kv_send_0_14_1
	v_proj_0_14 -> kv_send_0_14_1
	kv_send_0_14_1 -> kv_recv_0_15_1 [style=dashed]
	k_proj_0_12 -> kv_recv_0_14_2 [style=dashed]
	v_proj_0_12 -> kv_recv_0_14_2 [style=dashed]
	kv_recv_0_14_2 -> ring_attention_0_14
	k_proj_0_14 -> kv_send_0_14_2
	v_proj_0_14 -> kv_send_0_14_2
	kv_send_0_14_2 -> kv_recv_0_15_2 [style=dashed]
	k_proj_0_11 -> kv_recv_0_14_3 [style=dashed]
	v_proj_0_11 -> kv_recv_0_14_3 [style=dashed]
	kv_recv_0_14_3 -> ring_attention_0_14
	k_proj_0_14 -> kv_send_0_14_3
	v_proj_0_14 -> kv_send_0_14_3
	kv_send_0_14_3 -> kv_recv_0_15_3 [style=dashed]
	k_proj_0_10 -> kv_recv_0_14_4 [style=dashed]
	v_proj_0_10 -> kv_recv_0_14_4 [style=dashed]
	kv_recv_0_14_4 -> ring_attention_0_14
	k_proj_0_14 -> kv_send_0_14_4
	v_proj_0_14 -> kv_send_0_14_4
	kv_send_0_14_4 -> kv_recv_0_15_4 [style=dashed]
	k_proj_0_9 -> kv_recv_0_14_5 [style=dashed]
	v_proj_0_9 -> kv_recv_0_14_5 [style=dashed]
	kv_recv_0_14_5 -> ring_attention_0_14
	k_proj_0_14 -> kv_send_0_14_5
	v_proj_0_14 -> kv_send_0_14_5
	kv_send_0_14_5 -> kv_recv_0_15_5 [style=dashed]
	k_proj_0_8 -> kv_recv_0_14_6 [style=dashed]
	v_proj_0_8 -> kv_recv_0_14_6 [style=dashed]
	kv_recv_0_14_6 -> ring_attention_0_14
	k_proj_0_14 -> kv_send_0_14_6
	v_proj_0_14 -> kv_send_0_14_6
	kv_send_0_14_6 -> kv_recv_0_15_6 [style=dashed]
	k_proj_0_7 -> kv_recv_0_14_7 [style=dashed]
	v_proj_0_7 -> kv_recv_0_14_7 [style=dashed]
	kv_recv_0_14_7 -> ring_attention_0_14
	k_proj_0_14 -> kv_send_0_14_7
	v_proj_0_14 -> kv_send_0_14_7
	kv_send_0_14_7 -> kv_recv_0_15_7 [style=dashed]
	k_proj_0_6 -> kv_recv_0_14_8 [style=dashed]
	v_proj_0_6 -> kv_recv_0_14_8 [style=dashed]
	kv_recv_0_14_8 -> ring_attention_0_14
	k_proj_0_14 -> kv_send_0_14_8
	v_proj_0_14 -> kv_send_0_14_8
	kv_send_0_14_8 -> kv_recv_0_15_8 [style=dashed]
	k_proj_0_5 -> kv_recv_0_14_9 [style=dashed]
	v_proj_0_5 -> kv_recv_0_14_9 [style=dashed]
	kv_recv_0_14_9 -> ring_attention_0_14
	k_proj_0_14 -> kv_send_0_14_9
	v_proj_0_14 -> kv_send_0_14_9
	kv_send_0_14_9 -> kv_recv_0_15_9 [style=dashed]
	k_proj_0_4 -> kv_recv_0_14_10 [style=dashed]
	v_proj_0_4 -> kv_recv_0_14_10 [style=dashed]
	kv_recv_0_14_10 -> ring_attention_0_14
	k_proj_0_14 -> kv_send_0_14_10
	v_proj_0_14 -> kv_send_0_14_10
	kv_send_0_14_10 -> kv_recv_0_15_10 [style=dashed]
	k_proj_0_3 -> kv_recv_0_14_11 [style=dashed]
	v_proj_0_3 -> kv_recv_0_14_11 [style=dashed]
	kv_recv_0_14_11 -> ring_attention_0_14
	k_proj_0_14 -> kv_send_0_14_11
	v_proj_0_14 -> kv_send_0_14_11
	kv_send_0_14_11 -> kv_recv_0_15_11 [style=dashed]
	k_proj_0_2 -> kv_recv_0_14_12 [style=dashed]
	v_proj_0_2 -> kv_recv_0_14_12 [style=dashed]
	kv_recv_0_14_12 -> ring_attention_0_14
	k_proj_0_14 -> kv_send_0_14_12
	v_proj_0_14 -> kv_send_0_14_12
	kv_send_0_14_12 -> kv_recv_0_15_12 [style=dashed]
	k_proj_0_1 -> kv_recv_0_14_13 [style=dashed]
	v_proj_0_1 -> kv_recv_0_14_13 [style=dashed]
	kv_recv_0_14_13 -> ring_attention_0_14
	k_proj_0_14 -> kv_send_0_14_13
	v_proj_0_14 -> kv_send_0_14_13
	kv_send_0_14_13 -> kv_recv_0_15_13 [style=dashed]
	k_proj_0_0 -> kv_recv_0_14_14 [style=dashed]
	v_proj_0_0 -> kv_recv_0_14_14 [style=dashed]
	kv_recv_0_14_14 -> ring_attention_0_14
	k_proj_0_14 -> kv_send_0_14_14
	v_proj_0_14 -> kv_send_0_14_14
	kv_send_0_14_14 -> kv_recv_0_15_14 [style=dashed]
	k_proj_0_15 -> kv_recv_0_14_15 [style=dashed]
	v_proj_0_15 -> kv_recv_0_14_15 [style=dashed]
	kv_recv_0_14_15 -> ring_attention_0_14
	k_proj_0_14 -> kv_send_0_14_15
	v_proj_0_14 -> kv_send_0_14_15
	kv_send_0_14_15 -> kv_recv_0_15_15 [style=dashed]
	ring_attention_0_14 -> o_proj_0_14
	o_proj_0_14 -> add_0_14
	embed_14 -> add_0_14
	add_0_14 -> mlp0_gate_14
	add_0_14 -> mlp0_up_14
	mlp0_gate_14 -> mlp0_down_14
	mlp0_up_14 -> mlp0_down_14
	mlp0_down_14 -> add_1_14
	add_0_14 -> add_1_14
	add_1_14 -> ln1_pre_14
	ln1_pre_14 -> q_proj_1_14
	ln1_pre_14 -> k_proj_1_14
	ln1_pre_14 -> v_proj_1_14
	q_proj_1_14 -> ring_attention_1_14
	k_proj_1_14 -> ring_attention_1_14
	v_proj_1_14 -> ring_attention_1_14
	k_proj_1_14 -> kv_recv_1_14_0 [style=dashed]
	v_proj_1_14 -> kv_recv_1_14_0 [style=dashed]
	kv_recv_1_14_0 -> ring_attention_1_14
	k_proj_1_14 -> kv_send_1_14_0
	v_proj_1_14 -> kv_send_1_14_0
	kv_send_1_14_0 -> kv_recv_1_15_0 [style=dashed]
	k_proj_1_13 -> kv_recv_1_14_1 [style=dashed]
	v_proj_1_13 -> kv_recv_1_14_1 [style=dashed]
	kv_recv_1_14_1 -> ring_attention_1_14
	k_proj_1_14 -> kv_send_1_14_1
	v_proj_1_14 -> kv_send_1_14_1
	kv_send_1_14_1 -> kv_recv_1_15_1 [style=dashed]
	k_proj_1_12 -> kv_recv_1_14_2 [style=dashed]
	v_proj_1_12 -> kv_recv_1_14_2 [style=dashed]
	kv_recv_1_14_2 -> ring_attention_1_14
	k_proj_1_14 -> kv_send_1_14_2
	v_proj_1_14 -> kv_send_1_14_2
	kv_send_1_14_2 -> kv_recv_1_15_2 [style=dashed]
	k_proj_1_11 -> kv_recv_1_14_3 [style=dashed]
	v_proj_1_11 -> kv_recv_1_14_3 [style=dashed]
	kv_recv_1_14_3 -> ring_attention_1_14
	k_proj_1_14 -> kv_send_1_14_3
	v_proj_1_14 -> kv_send_1_14_3
	kv_send_1_14_3 -> kv_recv_1_15_3 [style=dashed]
	k_proj_1_10 -> kv_recv_1_14_4 [style=dashed]
	v_proj_1_10 -> kv_recv_1_14_4 [style=dashed]
	kv_recv_1_14_4 -> ring_attention_1_14
	k_proj_1_14 -> kv_send_1_14_4
	v_proj_1_14 -> kv_send_1_14_4
	kv_send_1_14_4 -> kv_recv_1_15_4 [style=dashed]
	k_proj_1_9 -> kv_recv_1_14_5 [style=dashed]
	v_proj_1_9 -> kv_recv_1_14_5 [style=dashed]
	kv_recv_1_14_5 -> ring_attention_1_14
	k_proj_1_14 -> kv_send_1_14_5
	v_proj_1_14 -> kv_send_1_14_5
	kv_send_1_14_5 -> kv_recv_1_15_5 [style=dashed]
	k_proj_1_8 -> kv_recv_1_14_6 [style=dashed]
	v_proj_1_8 -> kv_recv_1_14_6 [style=dashed]
	kv_recv_1_14_6 -> ring_attention_1_14
	k_proj_1_14 -> kv_send_1_14_6
	v_proj_1_14 -> kv_send_1_14_6
	kv_send_1_14_6 -> kv_recv_1_15_6 [style=dashed]
	k_proj_1_7 -> kv_recv_1_14_7 [style=dashed]
	v_proj_1_7 -> kv_recv_1_14_7 [style=dashed]
	kv_recv_1_14_7 -> ring_attention_1_14
	k_proj_1_14 -> kv_send_1_14_7
	v_proj_1_14 -> kv_send_1_14_7
	kv_send_1_14_7 -> kv_recv_1_15_7 [style=dashed]
	k_proj_1_6 -> kv_recv_1_14_8 [style=dashed]
	v_proj_1_6 -> kv_recv_1_14_8 [style=dashed]
	kv_recv_1_14_8 -> ring_attention_1_14
	k_proj_1_14 -> kv_send_1_14_8
	v_proj_1_14 -> kv_send_1_14_8
	kv_send_1_14_8 -> kv_recv_1_15_8 [style=dashed]
	k_proj_1_5 -> kv_recv_1_14_9 [style=dashed]
	v_proj_1_5 -> kv_recv_1_14_9 [style=dashed]
	kv_recv_1_14_9 -> ring_attention_1_14
	k_proj_1_14 -> kv_send_1_14_9
	v_proj_1_14 -> kv_send_1_14_9
	kv_send_1_14_9 -> kv_recv_1_15_9 [style=dashed]
	k_proj_1_4 -> kv_recv_1_14_10 [style=dashed]
	v_proj_1_4 -> kv_recv_1_14_10 [style=dashed]
	kv_recv_1_14_10 -> ring_attention_1_14
	k_proj_1_14 -> kv_send_1_14_10
	v_proj_1_14 -> kv_send_1_14_10
	kv_send_1_14_10 -> kv_recv_1_15_10 [style=dashed]
	k_proj_1_3 -> kv_recv_1_14_11 [style=dashed]
	v_proj_1_3 -> kv_recv_1_14_11 [style=dashed]
	kv_recv_1_14_11 -> ring_attention_1_14
	k_proj_1_14 -> kv_send_1_14_11
	v_proj_1_14 -> kv_send_1_14_11
	kv_send_1_14_11 -> kv_recv_1_15_11 [style=dashed]
	k_proj_1_2 -> kv_recv_1_14_12 [style=dashed]
	v_proj_1_2 -> kv_recv_1_14_12 [style=dashed]
	kv_recv_1_14_12 -> ring_attention_1_14
	k_proj_1_14 -> kv_send_1_14_12
	v_proj_1_14 -> kv_send_1_14_12
	kv_send_1_14_12 -> kv_recv_1_15_12 [style=dashed]
	k_proj_1_1 -> kv_recv_1_14_13 [style=dashed]
	v_proj_1_1 -> kv_recv_1_14_13 [style=dashed]
	kv_recv_1_14_13 -> ring_attention_1_14
	k_proj_1_14 -> kv_send_1_14_13
	v_proj_1_14 -> kv_send_1_14_13
	kv_send_1_14_13 -> kv_recv_1_15_13 [style=dashed]
	k_proj_1_0 -> kv_recv_1_14_14 [style=dashed]
	v_proj_1_0 -> kv_recv_1_14_14 [style=dashed]
	kv_recv_1_14_14 -> ring_attention_1_14
	k_proj_1_14 -> kv_send_1_14_14
	v_proj_1_14 -> kv_send_1_14_14
	kv_send_1_14_14 -> kv_recv_1_15_14 [style=dashed]
	k_proj_1_15 -> kv_recv_1_14_15 [style=dashed]
	v_proj_1_15 -> kv_recv_1_14_15 [style=dashed]
	kv_recv_1_14_15 -> ring_attention_1_14
	k_proj_1_14 -> kv_send_1_14_15
	v_proj_1_14 -> kv_send_1_14_15
	kv_send_1_14_15 -> kv_recv_1_15_15 [style=dashed]
	ring_attention_1_14 -> o_proj_1_14
	o_proj_1_14 -> add_2_14
	add_1_14 -> add_2_14
	add_2_14 -> mlp1_gate_14
	add_2_14 -> mlp1_up_14
	mlp1_gate_14 -> mlp1_down_14
	mlp1_up_14 -> mlp1_down_14
	mlp1_down_14 -> add_3_14
	add_2_14 -> add_3_14
	add_3_14 -> ln2_pre_14
	ln2_pre_14 -> ring_attention_2_14
	ring_attention_2_14 -> o_proj_2_14
	o_proj_2_14 -> add_4_14
	add_3_14 -> add_4_14
	add_4_14 -> mlp2_down_14
	mlp2_down_14 -> add_5_14
	add_4_14 -> add_5_14
	add_5_14 -> ln3_pre_14
	ln3_pre_14 -> ring_attention_3_14
	ring_attention_3_14 -> o_proj_3_14
	o_proj_3_14 -> add_6_14
	add_5_14 -> add_6_14
	add_6_14 -> mlp3_down_14
	mlp3_down_14 -> add_7_14
	add_6_14 -> add_7_14
	add_7_14 -> output_gather_14
	output_gather_0 -> global_output
	output_gather_1 -> global_output
	output_gather_2 -> global_output
	output_gather_3 -> global_output
	output_gather_4 -> global_output
	output_gather_5 -> global_output
	output_gather_6 -> global_output
	output_gather_7 -> global_output
	output_gather_8 -> global_output
	output_gather_9 -> global_output
	output_gather_10 -> global_output
	output_gather_11 -> global_output
	output_gather_12 -> global_output
	output_gather_13 -> global_output
	output_gather_14 -> global_output
	output_gather_15 -> global_output
	global_input -> input_split_15
	input_split_15 -> embed_15
	embed_15 -> ln0_pre_15
	ln0_pre_15 -> q_proj_0_15
	ln0_pre_15 -> k_proj_0_15
	ln0_pre_15 -> v_proj_0_15
	q_proj_0_15 -> ring_attention_0_15
	k_proj_0_15 -> ring_attention_0_15
	v_proj_0_15 -> ring_attention_0_15
	k_proj_0_15 -> kv_recv_0_15_0 [style=dashed]
	v_proj_0_15 -> kv_recv_0_15_0 [style=dashed]
	kv_recv_0_15_0 -> ring_attention_0_15
	k_proj_0_15 -> kv_send_0_15_0
	v_proj_0_15 -> kv_send_0_15_0
	kv_send_0_15_0 -> kv_recv_0_0_0 [style=dashed]
	k_proj_0_14 -> kv_recv_0_15_1 [style=dashed]
	v_proj_0_14 -> kv_recv_0_15_1 [style=dashed]
	kv_recv_0_15_1 -> ring_attention_0_15
	k_proj_0_15 -> kv_send_0_15_1
	v_proj_0_15 -> kv_send_0_15_1
	kv_send_0_15_1 -> kv_recv_0_0_1 [style=dashed]
	k_proj_0_13 -> kv_recv_0_15_2 [style=dashed]
	v_proj_0_13 -> kv_recv_0_15_2 [style=dashed]
	kv_recv_0_15_2 -> ring_attention_0_15
	k_proj_0_15 -> kv_send_0_15_2
	v_proj_0_15 -> kv_send_0_15_2
	kv_send_0_15_2 -> kv_recv_0_0_2 [style=dashed]
	k_proj_0_12 -> kv_recv_0_15_3 [style=dashed]
	v_proj_0_12 -> kv_recv_0_15_3 [style=dashed]
	kv_recv_0_15_3 -> ring_attention_0_15
	k_proj_0_15 -> kv_send_0_15_3
	v_proj_0_15 -> kv_send_0_15_3
	kv_send_0_15_3 -> kv_recv_0_0_3 [style=dashed]
	k_proj_0_11 -> kv_recv_0_15_4 [style=dashed]
	v_proj_0_11 -> kv_recv_0_15_4 [style=dashed]
	kv_recv_0_15_4 -> ring_attention_0_15
	k_proj_0_15 -> kv_send_0_15_4
	v_proj_0_15 -> kv_send_0_15_4
	kv_send_0_15_4 -> kv_recv_0_0_4 [style=dashed]
	k_proj_0_10 -> kv_recv_0_15_5 [style=dashed]
	v_proj_0_10 -> kv_recv_0_15_5 [style=dashed]
	kv_recv_0_15_5 -> ring_attention_0_15
	k_proj_0_15 -> kv_send_0_15_5
	v_proj_0_15 -> kv_send_0_15_5
	kv_send_0_15_5 -> kv_recv_0_0_5 [style=dashed]
	k_proj_0_9 -> kv_recv_0_15_6 [style=dashed]
	v_proj_0_9 -> kv_recv_0_15_6 [style=dashed]
	kv_recv_0_15_6 -> ring_attention_0_15
	k_proj_0_15 -> kv_send_0_15_6
	v_proj_0_15 -> kv_send_0_15_6
	kv_send_0_15_6 -> kv_recv_0_0_6 [style=dashed]
	k_proj_0_8 -> kv_recv_0_15_7 [style=dashed]
	v_proj_0_8 -> kv_recv_0_15_7 [style=dashed]
	kv_recv_0_15_7 -> ring_attention_0_15
	k_proj_0_15 -> kv_send_0_15_7
	v_proj_0_15 -> kv_send_0_15_7
	kv_send_0_15_7 -> kv_recv_0_0_7 [style=dashed]
	k_proj_0_7 -> kv_recv_0_15_8 [style=dashed]
	v_proj_0_7 -> kv_recv_0_15_8 [style=dashed]
	kv_recv_0_15_8 -> ring_attention_0_15
	k_proj_0_15 -> kv_send_0_15_8
	v_proj_0_15 -> kv_send_0_15_8
	kv_send_0_15_8 -> kv_recv_0_0_8 [style=dashed]
	k_proj_0_6 -> kv_recv_0_15_9 [style=dashed]
	v_proj_0_6 -> kv_recv_0_15_9 [style=dashed]
	kv_recv_0_15_9 -> ring_attention_0_15
	k_proj_0_15 -> kv_send_0_15_9
	v_proj_0_15 -> kv_send_0_15_9
	kv_send_0_15_9 -> kv_recv_0_0_9 [style=dashed]
	k_proj_0_5 -> kv_recv_0_15_10 [style=dashed]
	v_proj_0_5 -> kv_recv_0_15_10 [style=dashed]
	kv_recv_0_15_10 -> ring_attention_0_15
	k_proj_0_15 -> kv_send_0_15_10
	v_proj_0_15 -> kv_send_0_15_10
	kv_send_0_15_10 -> kv_recv_0_0_10 [style=dashed]
	k_proj_0_4 -> kv_recv_0_15_11 [style=dashed]
	v_proj_0_4 -> kv_recv_0_15_11 [style=dashed]
	kv_recv_0_15_11 -> ring_attention_0_15
	k_proj_0_15 -> kv_send_0_15_11
	v_proj_0_15 -> kv_send_0_15_11
	kv_send_0_15_11 -> kv_recv_0_0_11 [style=dashed]
	k_proj_0_3 -> kv_recv_0_15_12 [style=dashed]
	v_proj_0_3 -> kv_recv_0_15_12 [style=dashed]
	kv_recv_0_15_12 -> ring_attention_0_15
	k_proj_0_15 -> kv_send_0_15_12
	v_proj_0_15 -> kv_send_0_15_12
	kv_send_0_15_12 -> kv_recv_0_0_12 [style=dashed]
	k_proj_0_2 -> kv_recv_0_15_13 [style=dashed]
	v_proj_0_2 -> kv_recv_0_15_13 [style=dashed]
	kv_recv_0_15_13 -> ring_attention_0_15
	k_proj_0_15 -> kv_send_0_15_13
	v_proj_0_15 -> kv_send_0_15_13
	kv_send_0_15_13 -> kv_recv_0_0_13 [style=dashed]
	k_proj_0_1 -> kv_recv_0_15_14 [style=dashed]
	v_proj_0_1 -> kv_recv_0_15_14 [style=dashed]
	kv_recv_0_15_14 -> ring_attention_0_15
	k_proj_0_15 -> kv_send_0_15_14
	v_proj_0_15 -> kv_send_0_15_14
	kv_send_0_15_14 -> kv_recv_0_0_14 [style=dashed]
	k_proj_0_0 -> kv_recv_0_15_15 [style=dashed]
	v_proj_0_0 -> kv_recv_0_15_15 [style=dashed]
	kv_recv_0_15_15 -> ring_attention_0_15
	k_proj_0_15 -> kv_send_0_15_15
	v_proj_0_15 -> kv_send_0_15_15
	kv_send_0_15_15 -> kv_recv_0_0_15 [style=dashed]
	ring_attention_0_15 -> o_proj_0_15
	o_proj_0_15 -> add_0_15
	embed_15 -> add_0_15
	add_0_15 -> mlp0_gate_15
	add_0_15 -> mlp0_up_15
	mlp0_gate_15 -> mlp0_down_15
	mlp0_up_15 -> mlp0_down_15
	mlp0_down_15 -> add_1_15
	add_0_15 -> add_1_15
	add_1_15 -> ln1_pre_15
	ln1_pre_15 -> q_proj_1_15
	ln1_pre_15 -> k_proj_1_15
	ln1_pre_15 -> v_proj_1_15
	q_proj_1_15 -> ring_attention_1_15
	k_proj_1_15 -> ring_attention_1_15
	v_proj_1_15 -> ring_attention_1_15
	k_proj_1_15 -> kv_recv_1_15_0 [style=dashed]
	v_proj_1_15 -> kv_recv_1_15_0 [style=dashed]
	kv_recv_1_15_0 -> ring_attention_1_15
	k_proj_1_15 -> kv_send_1_15_0
	v_proj_1_15 -> kv_send_1_15_0
	kv_send_1_15_0 -> kv_recv_1_0_0 [style=dashed]
	k_proj_1_14 -> kv_recv_1_15_1 [style=dashed]
	v_proj_1_14 -> kv_recv_1_15_1 [style=dashed]
	kv_recv_1_15_1 -> ring_attention_1_15
	k_proj_1_15 -> kv_send_1_15_1
	v_proj_1_15 -> kv_send_1_15_1
	kv_send_1_15_1 -> kv_recv_1_0_1 [style=dashed]
	k_proj_1_13 -> kv_recv_1_15_2 [style=dashed]
	v_proj_1_13 -> kv_recv_1_15_2 [style=dashed]
	kv_recv_1_15_2 -> ring_attention_1_15
	k_proj_1_15 -> kv_send_1_15_2
	v_proj_1_15 -> kv_send_1_15_2
	kv_send_1_15_2 -> kv_recv_1_0_2 [style=dashed]
	k_proj_1_12 -> kv_recv_1_15_3 [style=dashed]
	v_proj_1_12 -> kv_recv_1_15_3 [style=dashed]
	kv_recv_1_15_3 -> ring_attention_1_15
	k_proj_1_15 -> kv_send_1_15_3
	v_proj_1_15 -> kv_send_1_15_3
	kv_send_1_15_3 -> kv_recv_1_0_3 [style=dashed]
	k_proj_1_11 -> kv_recv_1_15_4 [style=dashed]
	v_proj_1_11 -> kv_recv_1_15_4 [style=dashed]
	kv_recv_1_15_4 -> ring_attention_1_15
	k_proj_1_15 -> kv_send_1_15_4
	v_proj_1_15 -> kv_send_1_15_4
	kv_send_1_15_4 -> kv_recv_1_0_4 [style=dashed]
	k_proj_1_10 -> kv_recv_1_15_5 [style=dashed]
	v_proj_1_10 -> kv_recv_1_15_5 [style=dashed]
	kv_recv_1_15_5 -> ring_attention_1_15
	k_proj_1_15 -> kv_send_1_15_5
	v_proj_1_15 -> kv_send_1_15_5
	kv_send_1_15_5 -> kv_recv_1_0_5 [style=dashed]
	k_proj_1_9 -> kv_recv_1_15_6 [style=dashed]
	v_proj_1_9 -> kv_recv_1_15_6 [style=dashed]
	kv_recv_1_15_6 -> ring_attention_1_15
	k_proj_1_15 -> kv_send_1_15_6
	v_proj_1_15 -> kv_send_1_15_6
	kv_send_1_15_6 -> kv_recv_1_0_6 [style=dashed]
	k_proj_1_8 -> kv_recv_1_15_7 [style=dashed]
	v_proj_1_8 -> kv_recv_1_15_7 [style=dashed]
	kv_recv_1_15_7 -> ring_attention_1_15
	k_proj_1_15 -> kv_send_1_15_7
	v_proj_1_15 -> kv_send_1_15_7
	kv_send_1_15_7 -> kv_recv_1_0_7 [style=dashed]
	k_proj_1_7 -> kv_recv_1_15_8 [style=dashed]
	v_proj_1_7 -> kv_recv_1_15_8 [style=dashed]
	kv_recv_1_15_8 -> ring_attention_1_15
	k_proj_1_15 -> kv_send_1_15_8
	v_proj_1_15 -> kv_send_1_15_8
	kv_send_1_15_8 -> kv_recv_1_0_8 [style=dashed]
	k_proj_1_6 -> kv_recv_1_15_9 [style=dashed]
	v_proj_1_6 -> kv_recv_1_15_9 [style=dashed]
	kv_recv_1_15_9 -> ring_attention_1_15
	k_proj_1_15 -> kv_send_1_15_9
	v_proj_1_15 -> kv_send_1_15_9
	kv_send_1_15_9 -> kv_recv_1_0_9 [style=dashed]
	k_proj_1_5 -> kv_recv_1_15_10 [style=dashed]
	v_proj_1_5 -> kv_recv_1_15_10 [style=dashed]
	kv_recv_1_15_10 -> ring_attention_1_15
	k_proj_1_15 -> kv_send_1_15_10
	v_proj_1_15 -> kv_send_1_15_10
	kv_send_1_15_10 -> kv_recv_1_0_10 [style=dashed]
	k_proj_1_4 -> kv_recv_1_15_11 [style=dashed]
	v_proj_1_4 -> kv_recv_1_15_11 [style=dashed]
	kv_recv_1_15_11 -> ring_attention_1_15
	k_proj_1_15 -> kv_send_1_15_11
	v_proj_1_15 -> kv_send_1_15_11
	kv_send_1_15_11 -> kv_recv_1_0_11 [style=dashed]
	k_proj_1_3 -> kv_recv_1_15_12 [style=dashed]
	v_proj_1_3 -> kv_recv_1_15_12 [style=dashed]
	kv_recv_1_15_12 -> ring_attention_1_15
	k_proj_1_15 -> kv_send_1_15_12
	v_proj_1_15 -> kv_send_1_15_12
	kv_send_1_15_12 -> kv_recv_1_0_12 [style=dashed]
	k_proj_1_2 -> kv_recv_1_15_13 [style=dashed]
	v_proj_1_2 -> kv_recv_1_15_13 [style=dashed]
	kv_recv_1_15_13 -> ring_attention_1_15
	k_proj_1_15 -> kv_send_1_15_13
	v_proj_1_15 -> kv_send_1_15_13
	kv_send_1_15_13 -> kv_recv_1_0_13 [style=dashed]
	k_proj_1_1 -> kv_recv_1_15_14 [style=dashed]
	v_proj_1_1 -> kv_recv_1_15_14 [style=dashed]
	kv_recv_1_15_14 -> ring_attention_1_15
	k_proj_1_15 -> kv_send_1_15_14
	v_proj_1_15 -> kv_send_1_15_14
	kv_send_1_15_14 -> kv_recv_1_0_14 [style=dashed]
	k_proj_1_0 -> kv_recv_1_15_15 [style=dashed]
	v_proj_1_0 -> kv_recv_1_15_15 [style=dashed]
	kv_recv_1_15_15 -> ring_attention_1_15
	k_proj_1_15 -> kv_send_1_15_15
	v_proj_1_15 -> kv_send_1_15_15
	kv_send_1_15_15 -> kv_recv_1_0_15 [style=dashed]
	ring_attention_1_15 -> o_proj_1_15
	o_proj_1_15 -> add_2_15
	add_1_15 -> add_2_15
	add_2_15 -> mlp1_gate_15
	add_2_15 -> mlp1_up_15
	mlp1_gate_15 -> mlp1_down_15
	mlp1_up_15 -> mlp1_down_15
	mlp1_down_15 -> add_3_15
	add_2_15 -> add_3_15
	add_3_15 -> ln2_pre_15
	ln2_pre_15 -> ring_attention_2_15
	ring_attention_2_15 -> o_proj_2_15
	o_proj_2_15 -> add_4_15
	add_3_15 -> add_4_15
	add_4_15 -> mlp2_down_15
	mlp2_down_15 -> add_5_15
	add_4_15 -> add_5_15
	add_5_15 -> ln3_pre_15
	ln3_pre_15 -> ring_attention_3_15
	ring_attention_3_15 -> o_proj_3_15
	o_proj_3_15 -> add_6_15
	add_5_15 -> add_6_15
	add_6_15 -> mlp3_down_15
	mlp3_down_15 -> add_7_15
	add_6_15 -> add_7_15
	add_7_15 -> output_gather_15
	output_gather_0 -> global_output
	output_gather_1 -> global_output
	output_gather_2 -> global_output
	output_gather_3 -> global_output
	output_gather_4 -> global_output
	output_gather_5 -> global_output
	output_gather_6 -> global_output
	output_gather_7 -> global_output
	output_gather_8 -> global_output
	output_gather_9 -> global_output
	output_gather_10 -> global_output
	output_gather_11 -> global_output
	output_gather_12 -> global_output
	output_gather_13 -> global_output
	output_gather_14 -> global_output
	output_gather_15 -> global_output
}
