<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1440pt" height="531pt"
 viewBox="0.00 0.00 1440.00 530.95" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.14 0.14) rotate(0) translate(4 3790.45)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3790.45 10287,-3790.45 10287,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_pipeline_stage0</title>
<path fill="lightblue" stroke="blue" d="M20,-1675.33C20,-1675.33 10263,-1675.33 10263,-1675.33 10269,-1675.33 10275,-1681.33 10275,-1687.33 10275,-1687.33 10275,-3766.45 10275,-3766.45 10275,-3772.45 10269,-3778.45 10263,-3778.45 10263,-3778.45 20,-3778.45 20,-3778.45 14,-3778.45 8,-3772.45 8,-3766.45 8,-3766.45 8,-1687.33 8,-1687.33 8,-1681.33 14,-1675.33 20,-1675.33"/>
<text text-anchor="middle" x="5141.5" y="-3763.25" font-family="Times,serif" font-size="14.00">Pipeline Stage 0 (Devices 0&#45;7)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_pipeline_stage1</title>
<path fill="lightcoral" stroke="red" d="M6054,-124.17C6054,-124.17 8488,-124.17 8488,-124.17 8494,-124.17 8500,-130.17 8500,-136.17 8500,-136.17 8500,-1655.33 8500,-1655.33 8500,-1661.33 8494,-1667.33 8488,-1667.33 8488,-1667.33 6054,-1667.33 6054,-1667.33 6048,-1667.33 6042,-1661.33 6042,-1655.33 6042,-1655.33 6042,-136.17 6042,-136.17 6042,-130.17 6048,-124.17 6054,-124.17"/>
<text text-anchor="middle" x="7271" y="-1652.13" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (Devices 8&#45;15)</text>
</g>
<!-- input0 -->
<g id="node1" class="node">
<title>input0</title>
<ellipse fill="lightyellow" stroke="black" cx="7675" cy="-3709.98" rx="260.84" ry="37.45"/>
<text text-anchor="middle" x="7675" y="-3721.28" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="7675" y="-3706.28" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="7675" y="-3691.28" font-family="Times,serif" font-size="14.00">GPU: &#45;</text>
</g>
<!-- embed0 -->
<g id="node2" class="node">
<title>embed0</title>
<polygon fill="lightgreen" stroke="black" points="7865.5,-3636.5 7484.5,-3636.5 7484.5,-3568.5 7865.5,-3568.5 7865.5,-3636.5"/>
<text text-anchor="middle" x="7675" y="-3621.3" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="7675" y="-3606.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000]</text>
<text text-anchor="middle" x="7675" y="-3591.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="7675" y="-3576.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- input0&#45;&gt;embed0 -->
<g id="edge1" class="edge">
<title>input0&#45;&gt;embed0</title>
<path fill="none" stroke="black" d="M7675,-3672.38C7675,-3664.09 7675,-3655.21 7675,-3646.68"/>
<polygon fill="black" stroke="black" points="7678.5,-3646.5 7675,-3636.5 7671.5,-3646.5 7678.5,-3646.5"/>
</g>
<!-- ln0_pre -->
<g id="node3" class="node">
<title>ln0_pre</title>
<polygon fill="lightcoral" stroke="black" points="5535.5,-3532.5 5154.5,-3532.5 5154.5,-3464.5 5535.5,-3464.5 5535.5,-3532.5"/>
<text text-anchor="middle" x="5345" y="-3517.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5345" y="-3502.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="5345" y="-3487.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="5345" y="-3472.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- embed0&#45;&gt;ln0_pre -->
<g id="edge2" class="edge">
<title>embed0&#45;&gt;ln0_pre</title>
<path fill="none" stroke="black" d="M7484.33,-3593.15C7049.91,-3574.13 5989.97,-3527.73 5545.91,-3508.29"/>
<polygon fill="black" stroke="black" points="5546,-3504.8 5535.86,-3507.85 5545.69,-3511.79 5546,-3504.8"/>
</g>
<!-- add_0 -->
<g id="node45" class="node">
<title>add_0</title>
<polygon fill="lightgray" stroke="black" points="7737.5,-2929.5 7356.5,-2929.5 7356.5,-2861.5 7737.5,-2861.5 7737.5,-2929.5"/>
<text text-anchor="middle" x="7547" y="-2914.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7547" y="-2899.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="7547" y="-2884.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="7547" y="-2869.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- embed0&#45;&gt;add_0 -->
<g id="edge68" class="edge">
<title>embed0&#45;&gt;add_0</title>
<path fill="none" stroke="black" d="M7865.5,-3601.03C8430.66,-3597.95 10070.19,-3576.24 10256,-3428.5 10268,-3418.96 10266,-3410.82 10266,-3395.5 10266,-3395.5 10266,-3395.5 10266,-3170.5 10266,-2917.37 8376.45,-2895.86 7747.73,-2895.71"/>
<polygon fill="black" stroke="black" points="7747.65,-2892.21 7737.65,-2895.71 7747.65,-2899.21 7747.65,-2892.21"/>
</g>
<!-- q_proj_0_0 -->
<g id="node4" class="node">
<title>q_proj_0_0</title>
<polygon fill="lightblue" stroke="black" points="425.5,-3428.5 16.5,-3428.5 16.5,-3360.5 425.5,-3360.5 425.5,-3428.5"/>
<text text-anchor="middle" x="221" y="-3413.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="221" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="221" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="221" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ln0_pre&#45;&gt;q_proj_0_0 -->
<g id="edge3" class="edge">
<title>ln0_pre&#45;&gt;q_proj_0_0</title>
<path fill="none" stroke="black" d="M5154.2,-3496.39C4313.25,-3491.28 956.67,-3468.61 436.01,-3428.5"/>
<polygon fill="black" stroke="black" points="435.91,-3424.98 425.66,-3427.67 435.35,-3431.96 435.91,-3424.98"/>
</g>
<!-- k_proj_0_0 -->
<g id="node5" class="node">
<title>k_proj_0_0</title>
<polygon fill="lightblue" stroke="black" points="852.5,-3428.5 443.5,-3428.5 443.5,-3360.5 852.5,-3360.5 852.5,-3428.5"/>
<text text-anchor="middle" x="648" y="-3413.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="648" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="648" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="648" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ln0_pre&#45;&gt;k_proj_0_0 -->
<g id="edge4" class="edge">
<title>ln0_pre&#45;&gt;k_proj_0_0</title>
<path fill="none" stroke="black" d="M5154.26,-3496.11C4360.37,-3490.14 1337.69,-3465.24 862.76,-3428.48"/>
<polygon fill="black" stroke="black" points="862.91,-3424.98 852.66,-3427.67 862.35,-3431.96 862.91,-3424.98"/>
</g>
<!-- v_proj_0_0 -->
<g id="node6" class="node">
<title>v_proj_0_0</title>
<polygon fill="lightblue" stroke="black" points="1279.5,-3428.5 870.5,-3428.5 870.5,-3360.5 1279.5,-3360.5 1279.5,-3428.5"/>
<text text-anchor="middle" x="1075" y="-3413.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1075" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="1075" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1075" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ln0_pre&#45;&gt;v_proj_0_0 -->
<g id="edge5" class="edge">
<title>ln0_pre&#45;&gt;v_proj_0_0</title>
<path fill="none" stroke="black" d="M5154.28,-3497.7C4460.98,-3497.89 2074.5,-3493.72 1289.68,-3428.5"/>
<polygon fill="black" stroke="black" points="1289.92,-3425.01 1279.67,-3427.66 1289.34,-3431.99 1289.92,-3425.01"/>
</g>
<!-- q_proj_0_1 -->
<g id="node9" class="node">
<title>q_proj_0_1</title>
<polygon fill="lightblue" stroke="black" points="1706.5,-3428.5 1297.5,-3428.5 1297.5,-3360.5 1706.5,-3360.5 1706.5,-3428.5"/>
<text text-anchor="middle" x="1502" y="-3413.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="1502" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="1502" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1502" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ln0_pre&#45;&gt;q_proj_0_1 -->
<g id="edge10" class="edge">
<title>ln0_pre&#45;&gt;q_proj_0_1</title>
<path fill="none" stroke="black" d="M5154.31,-3497.25C4509.69,-3495.88 2413.86,-3486.98 1716.83,-3428.51"/>
<polygon fill="black" stroke="black" points="1716.93,-3425.01 1706.67,-3427.65 1716.33,-3431.99 1716.93,-3425.01"/>
</g>
<!-- k_proj_0_1 -->
<g id="node10" class="node">
<title>k_proj_0_1</title>
<polygon fill="lightblue" stroke="black" points="2133.5,-3428.5 1724.5,-3428.5 1724.5,-3360.5 2133.5,-3360.5 2133.5,-3428.5"/>
<text text-anchor="middle" x="1929" y="-3413.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="1929" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="1929" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1929" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ln0_pre&#45;&gt;k_proj_0_1 -->
<g id="edge11" class="edge">
<title>ln0_pre&#45;&gt;k_proj_0_1</title>
<path fill="none" stroke="black" d="M5154.26,-3496.68C4561.19,-3493.62 2753.38,-3480.27 2143.88,-3428.52"/>
<polygon fill="black" stroke="black" points="2143.93,-3425.01 2133.67,-3427.64 2143.33,-3431.99 2143.93,-3425.01"/>
</g>
<!-- v_proj_0_1 -->
<g id="node11" class="node">
<title>v_proj_0_1</title>
<polygon fill="lightblue" stroke="black" points="2560.5,-3428.5 2151.5,-3428.5 2151.5,-3360.5 2560.5,-3360.5 2560.5,-3428.5"/>
<text text-anchor="middle" x="2356" y="-3413.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="2356" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="2356" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2356" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ln0_pre&#45;&gt;v_proj_0_1 -->
<g id="edge12" class="edge">
<title>ln0_pre&#45;&gt;v_proj_0_1</title>
<path fill="none" stroke="black" d="M5154.33,-3495.94C4616.52,-3491.05 3093.37,-3473.59 2570.94,-3428.53"/>
<polygon fill="black" stroke="black" points="2570.94,-3425.01 2560.67,-3427.63 2570.32,-3431.99 2570.94,-3425.01"/>
</g>
<!-- q_proj_0_2 -->
<g id="node14" class="node">
<title>q_proj_0_2</title>
<polygon fill="lightblue" stroke="black" points="2987.5,-3428.5 2578.5,-3428.5 2578.5,-3360.5 2987.5,-3360.5 2987.5,-3428.5"/>
<text text-anchor="middle" x="2783" y="-3413.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="2783" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="2783" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2783" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ln0_pre&#45;&gt;q_proj_0_2 -->
<g id="edge17" class="edge">
<title>ln0_pre&#45;&gt;q_proj_0_2</title>
<path fill="none" stroke="black" d="M5154.34,-3494.94C4676.11,-3488.03 3433.52,-3466.96 2997.81,-3428.52"/>
<polygon fill="black" stroke="black" points="2997.94,-3425.01 2987.67,-3427.61 2997.32,-3431.99 2997.94,-3425.01"/>
</g>
<!-- k_proj_0_2 -->
<g id="node15" class="node">
<title>k_proj_0_2</title>
<polygon fill="lightblue" stroke="black" points="3414.5,-3428.5 3005.5,-3428.5 3005.5,-3360.5 3414.5,-3360.5 3414.5,-3428.5"/>
<text text-anchor="middle" x="3210" y="-3413.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="3210" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="3210" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3210" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ln0_pre&#45;&gt;k_proj_0_2 -->
<g id="edge18" class="edge">
<title>ln0_pre&#45;&gt;k_proj_0_2</title>
<path fill="none" stroke="black" d="M5154.34,-3498.03C4810.5,-3497.36 4063.74,-3488.44 3425.01,-3428.55"/>
<polygon fill="black" stroke="black" points="3424.96,-3425.03 3414.67,-3427.58 3424.3,-3432 3424.96,-3425.03"/>
</g>
<!-- v_proj_0_2 -->
<g id="node16" class="node">
<title>v_proj_0_2</title>
<polygon fill="lightblue" stroke="black" points="3841.5,-3428.5 3432.5,-3428.5 3432.5,-3360.5 3841.5,-3360.5 3841.5,-3428.5"/>
<text text-anchor="middle" x="3637" y="-3413.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="3637" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="3637" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3637" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ln0_pre&#45;&gt;v_proj_0_2 -->
<g id="edge19" class="edge">
<title>ln0_pre&#45;&gt;v_proj_0_2</title>
<path fill="none" stroke="black" d="M5154.38,-3495.21C4871.95,-3490.35 4325.64,-3475.35 3851.8,-3428.54"/>
<polygon fill="black" stroke="black" points="3851.97,-3425.04 3841.68,-3427.53 3851.28,-3432 3851.97,-3425.04"/>
</g>
<!-- q_proj_0_3 -->
<g id="node19" class="node">
<title>q_proj_0_3</title>
<polygon fill="lightblue" stroke="black" points="4268.5,-3428.5 3859.5,-3428.5 3859.5,-3360.5 4268.5,-3360.5 4268.5,-3428.5"/>
<text text-anchor="middle" x="4064" y="-3413.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="4064" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="4064" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4064" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ln0_pre&#45;&gt;q_proj_0_3 -->
<g id="edge24" class="edge">
<title>ln0_pre&#45;&gt;q_proj_0_3</title>
<path fill="none" stroke="black" d="M5154.23,-3490.25C4942.71,-3481.05 4591.28,-3462.29 4278.85,-3428.56"/>
<polygon fill="black" stroke="black" points="4279,-3425.05 4268.69,-3427.45 4278.25,-3432.01 4279,-3425.05"/>
</g>
<!-- k_proj_0_3 -->
<g id="node20" class="node">
<title>k_proj_0_3</title>
<polygon fill="lightblue" stroke="black" points="4695.5,-3428.5 4286.5,-3428.5 4286.5,-3360.5 4695.5,-3360.5 4695.5,-3428.5"/>
<text text-anchor="middle" x="4491" y="-3413.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="4491" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="4491" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4491" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ln0_pre&#45;&gt;k_proj_0_3 -->
<g id="edge25" class="edge">
<title>ln0_pre&#45;&gt;k_proj_0_3</title>
<path fill="none" stroke="black" d="M5154.3,-3479.24C5029.64,-3466.75 4863.04,-3449.01 4706.03,-3428.62"/>
<polygon fill="black" stroke="black" points="4706.08,-3425.09 4695.71,-3427.27 4705.17,-3432.03 4706.08,-3425.09"/>
</g>
<!-- v_proj_0_3 -->
<g id="node21" class="node">
<title>v_proj_0_3</title>
<polygon fill="lightblue" stroke="black" points="5122.5,-3428.5 4713.5,-3428.5 4713.5,-3360.5 5122.5,-3360.5 5122.5,-3428.5"/>
<text text-anchor="middle" x="4918" y="-3413.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="4918" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="4918" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4918" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ln0_pre&#45;&gt;v_proj_0_3 -->
<g id="edge26" class="edge">
<title>ln0_pre&#45;&gt;v_proj_0_3</title>
<path fill="none" stroke="black" d="M5206.66,-3464.45C5161.84,-3453.75 5111.95,-3441.83 5066.43,-3430.96"/>
<polygon fill="black" stroke="black" points="5067.02,-3427.5 5056.49,-3428.58 5065.4,-3434.31 5067.02,-3427.5"/>
</g>
<!-- q_proj_0_4 -->
<g id="node24" class="node">
<title>q_proj_0_4</title>
<polygon fill="lightblue" stroke="black" points="5549.5,-3428.5 5140.5,-3428.5 5140.5,-3360.5 5549.5,-3360.5 5549.5,-3428.5"/>
<text text-anchor="middle" x="5345" y="-3413.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5345" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="5345" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5345" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ln0_pre&#45;&gt;q_proj_0_4 -->
<g id="edge31" class="edge">
<title>ln0_pre&#45;&gt;q_proj_0_4</title>
<path fill="none" stroke="black" d="M5345,-3464.38C5345,-3456.28 5345,-3447.48 5345,-3438.97"/>
<polygon fill="black" stroke="black" points="5348.5,-3438.8 5345,-3428.8 5341.5,-3438.8 5348.5,-3438.8"/>
</g>
<!-- k_proj_0_4 -->
<g id="node25" class="node">
<title>k_proj_0_4</title>
<polygon fill="lightblue" stroke="black" points="5976.5,-3428.5 5567.5,-3428.5 5567.5,-3360.5 5976.5,-3360.5 5976.5,-3428.5"/>
<text text-anchor="middle" x="5772" y="-3413.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5772" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="5772" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5772" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ln0_pre&#45;&gt;k_proj_0_4 -->
<g id="edge32" class="edge">
<title>ln0_pre&#45;&gt;k_proj_0_4</title>
<path fill="none" stroke="black" d="M5483.34,-3464.45C5528.16,-3453.75 5578.05,-3441.83 5623.57,-3430.96"/>
<polygon fill="black" stroke="black" points="5624.6,-3434.31 5633.51,-3428.58 5622.98,-3427.5 5624.6,-3434.31"/>
</g>
<!-- v_proj_0_4 -->
<g id="node26" class="node">
<title>v_proj_0_4</title>
<polygon fill="lightblue" stroke="black" points="6403.5,-3428.5 5994.5,-3428.5 5994.5,-3360.5 6403.5,-3360.5 6403.5,-3428.5"/>
<text text-anchor="middle" x="6199" y="-3413.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6199" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="6199" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6199" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ln0_pre&#45;&gt;v_proj_0_4 -->
<g id="edge33" class="edge">
<title>ln0_pre&#45;&gt;v_proj_0_4</title>
<path fill="none" stroke="black" d="M5535.65,-3479.32C5660.54,-3466.85 5827.58,-3449.1 5984.11,-3428.73"/>
<polygon fill="black" stroke="black" points="5984.94,-3432.15 5994.4,-3427.38 5984.03,-3425.21 5984.94,-3432.15"/>
</g>
<!-- q_proj_0_5 -->
<g id="node29" class="node">
<title>q_proj_0_5</title>
<polygon fill="lightblue" stroke="black" points="6830.5,-3428.5 6421.5,-3428.5 6421.5,-3360.5 6830.5,-3360.5 6830.5,-3428.5"/>
<text text-anchor="middle" x="6626" y="-3413.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6626" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="6626" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6626" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ln0_pre&#45;&gt;q_proj_0_5 -->
<g id="edge38" class="edge">
<title>ln0_pre&#45;&gt;q_proj_0_5</title>
<path fill="none" stroke="black" d="M5535.96,-3490.3C5747.68,-3481.14 6099.44,-3462.42 6411.28,-3428.66"/>
<polygon fill="black" stroke="black" points="6411.86,-3432.11 6421.42,-3427.55 6411.1,-3425.16 6411.86,-3432.11"/>
</g>
<!-- k_proj_0_5 -->
<g id="node30" class="node">
<title>k_proj_0_5</title>
<polygon fill="lightblue" stroke="black" points="7257.5,-3428.5 6848.5,-3428.5 6848.5,-3360.5 7257.5,-3360.5 7257.5,-3428.5"/>
<text text-anchor="middle" x="7053" y="-3413.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="7053" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="7053" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7053" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ln0_pre&#45;&gt;k_proj_0_5 -->
<g id="edge39" class="edge">
<title>ln0_pre&#45;&gt;k_proj_0_5</title>
<path fill="none" stroke="black" d="M5535.75,-3495.26C5818.37,-3490.46 6365.06,-3475.54 6838.32,-3428.63"/>
<polygon fill="black" stroke="black" points="6838.83,-3432.1 6848.43,-3427.62 6838.13,-3425.13 6838.83,-3432.1"/>
</g>
<!-- v_proj_0_5 -->
<g id="node31" class="node">
<title>v_proj_0_5</title>
<polygon fill="lightblue" stroke="black" points="7684.5,-3428.5 7275.5,-3428.5 7275.5,-3360.5 7684.5,-3360.5 7684.5,-3428.5"/>
<text text-anchor="middle" x="7480" y="-3413.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7480" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="7480" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7480" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ln0_pre&#45;&gt;v_proj_0_5 -->
<g id="edge40" class="edge">
<title>ln0_pre&#45;&gt;v_proj_0_5</title>
<path fill="none" stroke="black" d="M5535.76,-3498.08C5879.79,-3497.49 6626.95,-3488.68 7265.11,-3428.64"/>
<polygon fill="black" stroke="black" points="7265.81,-3432.09 7275.44,-3427.67 7265.15,-3425.12 7265.81,-3432.09"/>
</g>
<!-- q_proj_0_6 -->
<g id="node34" class="node">
<title>q_proj_0_6</title>
<polygon fill="lightblue" stroke="black" points="8111.5,-3428.5 7702.5,-3428.5 7702.5,-3360.5 8111.5,-3360.5 8111.5,-3428.5"/>
<text text-anchor="middle" x="7907" y="-3413.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7907" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="7907" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7907" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ln0_pre&#45;&gt;q_proj_0_6 -->
<g id="edge45" class="edge">
<title>ln0_pre&#45;&gt;q_proj_0_6</title>
<path fill="none" stroke="black" d="M5535.75,-3494.96C6014.18,-3488.1 7257.3,-3467.12 7692.31,-3428.6"/>
<polygon fill="black" stroke="black" points="7692.79,-3432.08 7702.44,-3427.69 7692.16,-3425.1 7692.79,-3432.08"/>
</g>
<!-- k_proj_0_6 -->
<g id="node35" class="node">
<title>k_proj_0_6</title>
<polygon fill="lightblue" stroke="black" points="8538.5,-3428.5 8129.5,-3428.5 8129.5,-3360.5 8538.5,-3360.5 8538.5,-3428.5"/>
<text text-anchor="middle" x="8334" y="-3413.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="8334" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="8334" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8334" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ln0_pre&#45;&gt;k_proj_0_6 -->
<g id="edge46" class="edge">
<title>ln0_pre&#45;&gt;k_proj_0_6</title>
<path fill="none" stroke="black" d="M5535.74,-3495.96C6073.75,-3491.12 7597.45,-3473.78 8119.19,-3428.61"/>
<polygon fill="black" stroke="black" points="8119.79,-3432.07 8129.44,-3427.71 8119.17,-3425.1 8119.79,-3432.07"/>
</g>
<!-- v_proj_0_6 -->
<g id="node36" class="node">
<title>v_proj_0_6</title>
<polygon fill="lightblue" stroke="black" points="8965.5,-3428.5 8556.5,-3428.5 8556.5,-3360.5 8965.5,-3360.5 8965.5,-3428.5"/>
<text text-anchor="middle" x="8761" y="-3413.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="8761" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="8761" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8761" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ln0_pre&#45;&gt;v_proj_0_6 -->
<g id="edge47" class="edge">
<title>ln0_pre&#45;&gt;v_proj_0_6</title>
<path fill="none" stroke="black" d="M5535.54,-3496.7C6128.52,-3493.7 7937.36,-3480.49 8546.24,-3428.6"/>
<polygon fill="black" stroke="black" points="8546.78,-3432.07 8556.44,-3427.72 8546.18,-3425.1 8546.78,-3432.07"/>
</g>
<!-- q_proj_0_7 -->
<g id="node39" class="node">
<title>q_proj_0_7</title>
<polygon fill="lightblue" stroke="black" points="9392.5,-3428.5 8983.5,-3428.5 8983.5,-3360.5 9392.5,-3360.5 9392.5,-3428.5"/>
<text text-anchor="middle" x="9188" y="-3413.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="9188" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="9188" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9188" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ln0_pre&#45;&gt;q_proj_0_7 -->
<g id="edge52" class="edge">
<title>ln0_pre&#45;&gt;q_proj_0_7</title>
<path fill="none" stroke="black" d="M5535.75,-3497.27C6180.55,-3495.96 8276.97,-3487.23 8973.29,-3428.6"/>
<polygon fill="black" stroke="black" points="8973.78,-3432.07 8983.44,-3427.73 8973.18,-3425.1 8973.78,-3432.07"/>
</g>
<!-- k_proj_0_7 -->
<g id="node40" class="node">
<title>k_proj_0_7</title>
<polygon fill="lightblue" stroke="black" points="9819.5,-3428.5 9410.5,-3428.5 9410.5,-3360.5 9819.5,-3360.5 9819.5,-3428.5"/>
<text text-anchor="middle" x="9615" y="-3413.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="9615" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="9615" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9615" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ln0_pre&#45;&gt;k_proj_0_7 -->
<g id="edge53" class="edge">
<title>ln0_pre&#45;&gt;k_proj_0_7</title>
<path fill="none" stroke="black" d="M5535.76,-3497.72C6229.24,-3497.97 8616.33,-3494 9400.44,-3428.59"/>
<polygon fill="black" stroke="black" points="9400.77,-3432.07 9410.44,-3427.74 9400.18,-3425.09 9400.77,-3432.07"/>
</g>
<!-- v_proj_0_7 -->
<g id="node41" class="node">
<title>v_proj_0_7</title>
<polygon fill="lightblue" stroke="black" points="10246.5,-3428.5 9837.5,-3428.5 9837.5,-3360.5 10246.5,-3360.5 10246.5,-3428.5"/>
<text text-anchor="middle" x="10042" y="-3413.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="10042" y="-3398.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="10042" y="-3383.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10042" y="-3368.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ln0_pre&#45;&gt;v_proj_0_7 -->
<g id="edge54" class="edge">
<title>ln0_pre&#45;&gt;v_proj_0_7</title>
<path fill="none" stroke="black" d="M5535.78,-3496.12C6329.86,-3490.18 9353.22,-3465.4 9827.37,-3428.56"/>
<polygon fill="black" stroke="black" points="9827.76,-3432.04 9837.44,-3427.75 9827.19,-3425.07 9827.76,-3432.04"/>
</g>
<!-- attention_0_0 -->
<g id="node7" class="node">
<title>attention_0_0</title>
<path fill="gold" stroke="black" d="M1053.5,-3324.5C1053.5,-3324.5 668.5,-3324.5 668.5,-3324.5 662.5,-3324.5 656.5,-3318.5 656.5,-3312.5 656.5,-3312.5 656.5,-3253.5 656.5,-3253.5 656.5,-3247.5 662.5,-3241.5 668.5,-3241.5 668.5,-3241.5 1053.5,-3241.5 1053.5,-3241.5 1059.5,-3241.5 1065.5,-3247.5 1065.5,-3253.5 1065.5,-3253.5 1065.5,-3312.5 1065.5,-3312.5 1065.5,-3318.5 1059.5,-3324.5 1053.5,-3324.5"/>
<text text-anchor="middle" x="861" y="-3309.3" font-family="Times,serif" font-size="14.00">MHA (4 heads)</text>
<text text-anchor="middle" x="861" y="-3294.3" font-family="Times,serif" font-size="14.00">Input: Q[batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="861" y="-3279.3" font-family="Times,serif" font-size="14.00">K,V[batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="861" y="-3264.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="861" y="-3249.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- q_proj_0_0&#45;&gt;attention_0_0 -->
<g id="edge6" class="edge">
<title>q_proj_0_0&#45;&gt;attention_0_0</title>
<path fill="none" stroke="black" d="M413.89,-3360.5C487.15,-3347.96 571.04,-3333.61 646.2,-3320.75"/>
<polygon fill="black" stroke="black" points="647.01,-3324.16 656.27,-3319.03 645.83,-3317.26 647.01,-3324.16"/>
</g>
<!-- k_proj_0_0&#45;&gt;attention_0_0 -->
<g id="edge7" class="edge">
<title>k_proj_0_0&#45;&gt;attention_0_0</title>
<path fill="none" stroke="black" d="M712.2,-3360.5C731.3,-3350.68 752.56,-3339.75 772.91,-3329.29"/>
<polygon fill="black" stroke="black" points="774.57,-3332.37 781.87,-3324.68 771.37,-3326.14 774.57,-3332.37"/>
</g>
<!-- v_proj_0_0&#45;&gt;attention_0_0 -->
<g id="edge8" class="edge">
<title>v_proj_0_0&#45;&gt;attention_0_0</title>
<path fill="none" stroke="black" d="M1010.5,-3360.5C991.31,-3350.68 969.95,-3339.75 949.51,-3329.29"/>
<polygon fill="black" stroke="black" points="951,-3326.12 940.5,-3324.68 947.81,-3332.35 951,-3326.12"/>
</g>
<!-- o_proj_0_0 -->
<g id="node8" class="node">
<title>o_proj_0_0</title>
<polygon fill="lightblue" stroke="black" points="1924.5,-3205.5 1527.5,-3205.5 1527.5,-3137.5 1924.5,-3137.5 1924.5,-3205.5"/>
<text text-anchor="middle" x="1726" y="-3190.3" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="1726" y="-3175.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1726" y="-3160.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, d_model=512]</text>
<text text-anchor="middle" x="1726" y="-3145.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- attention_0_0&#45;&gt;o_proj_0_0 -->
<g id="edge9" class="edge">
<title>attention_0_0&#45;&gt;o_proj_0_0</title>
<path fill="none" stroke="black" d="M1065.72,-3256.08C1201.82,-3238.86 1380.02,-3216.3 1516.99,-3198.96"/>
<polygon fill="black" stroke="black" points="1517.72,-3202.39 1527.2,-3197.67 1516.84,-3195.45 1517.72,-3202.39"/>
</g>
<!-- all_reduce_0 -->
<g id="node44" class="node">
<title>all_reduce_0</title>
<polygon fill="orange" stroke="black" points="6167.01,-3101.5 5538.64,-3101.5 5376.99,-2965.5 6005.36,-2965.5 6167.01,-3101.5"/>
<text text-anchor="middle" x="5772" y="-3052.3" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="5772" y="-3037.3" font-family="Times,serif" font-size="14.00">Input: 8Ã—[batch=128, seq=100000, d_model=512]</text>
<text text-anchor="middle" x="5772" y="-3022.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="5772" y="-3007.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- o_proj_0_0&#45;&gt;all_reduce_0 -->
<g id="edge59" class="edge">
<title>o_proj_0_0&#45;&gt;all_reduce_0</title>
<path fill="none" stroke="black" d="M1924.57,-3163.82C2578.14,-3141.86 4665.66,-3071.69 5460.59,-3044.97"/>
<polygon fill="black" stroke="black" points="5460.87,-3048.46 5470.75,-3044.63 5460.64,-3041.46 5460.87,-3048.46"/>
</g>
<!-- attention_0_1 -->
<g id="node12" class="node">
<title>attention_0_1</title>
<path fill="gold" stroke="black" d="M2334.5,-3324.5C2334.5,-3324.5 1949.5,-3324.5 1949.5,-3324.5 1943.5,-3324.5 1937.5,-3318.5 1937.5,-3312.5 1937.5,-3312.5 1937.5,-3253.5 1937.5,-3253.5 1937.5,-3247.5 1943.5,-3241.5 1949.5,-3241.5 1949.5,-3241.5 2334.5,-3241.5 2334.5,-3241.5 2340.5,-3241.5 2346.5,-3247.5 2346.5,-3253.5 2346.5,-3253.5 2346.5,-3312.5 2346.5,-3312.5 2346.5,-3318.5 2340.5,-3324.5 2334.5,-3324.5"/>
<text text-anchor="middle" x="2142" y="-3309.3" font-family="Times,serif" font-size="14.00">MHA (4 heads)</text>
<text text-anchor="middle" x="2142" y="-3294.3" font-family="Times,serif" font-size="14.00">Input: Q[batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2142" y="-3279.3" font-family="Times,serif" font-size="14.00">K,V[batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2142" y="-3264.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2142" y="-3249.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- q_proj_0_1&#45;&gt;attention_0_1 -->
<g id="edge13" class="edge">
<title>q_proj_0_1&#45;&gt;attention_0_1</title>
<path fill="none" stroke="black" d="M1694.89,-3360.5C1768.15,-3347.96 1852.04,-3333.61 1927.2,-3320.75"/>
<polygon fill="black" stroke="black" points="1928.01,-3324.16 1937.27,-3319.03 1926.83,-3317.26 1928.01,-3324.16"/>
</g>
<!-- k_proj_0_1&#45;&gt;attention_0_1 -->
<g id="edge14" class="edge">
<title>k_proj_0_1&#45;&gt;attention_0_1</title>
<path fill="none" stroke="black" d="M1993.2,-3360.5C2012.3,-3350.68 2033.56,-3339.75 2053.91,-3329.29"/>
<polygon fill="black" stroke="black" points="2055.57,-3332.37 2062.87,-3324.68 2052.37,-3326.14 2055.57,-3332.37"/>
</g>
<!-- v_proj_0_1&#45;&gt;attention_0_1 -->
<g id="edge15" class="edge">
<title>v_proj_0_1&#45;&gt;attention_0_1</title>
<path fill="none" stroke="black" d="M2291.5,-3360.5C2272.31,-3350.68 2250.95,-3339.75 2230.51,-3329.29"/>
<polygon fill="black" stroke="black" points="2232,-3326.12 2221.5,-3324.68 2228.81,-3332.35 2232,-3326.12"/>
</g>
<!-- o_proj_0_1 -->
<g id="node13" class="node">
<title>o_proj_0_1</title>
<polygon fill="lightblue" stroke="black" points="3204.5,-3205.5 2807.5,-3205.5 2807.5,-3137.5 3204.5,-3137.5 3204.5,-3205.5"/>
<text text-anchor="middle" x="3006" y="-3190.3" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="3006" y="-3175.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3006" y="-3160.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, d_model=512]</text>
<text text-anchor="middle" x="3006" y="-3145.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- attention_0_1&#45;&gt;o_proj_0_1 -->
<g id="edge16" class="edge">
<title>attention_0_1&#45;&gt;o_proj_0_1</title>
<path fill="none" stroke="black" d="M2346.76,-3256.05C2482.58,-3238.84 2660.31,-3216.31 2797,-3198.99"/>
<polygon fill="black" stroke="black" points="2797.7,-3202.43 2807.18,-3197.7 2796.82,-3195.48 2797.7,-3202.43"/>
</g>
<!-- o_proj_0_1&#45;&gt;all_reduce_0 -->
<g id="edge60" class="edge">
<title>o_proj_0_1&#45;&gt;all_reduce_0</title>
<path fill="none" stroke="black" d="M3204.57,-3160.25C3332.58,-3153.67 3502.61,-3144.99 3653,-3137.5 4297.8,-3105.38 5053.02,-3068.96 5465.17,-3049.18"/>
<polygon fill="black" stroke="black" points="5465.63,-3052.67 5475.45,-3048.69 5465.29,-3045.67 5465.63,-3052.67"/>
</g>
<!-- attention_0_2 -->
<g id="node17" class="node">
<title>attention_0_2</title>
<path fill="gold" stroke="black" d="M3616.5,-3324.5C3616.5,-3324.5 3231.5,-3324.5 3231.5,-3324.5 3225.5,-3324.5 3219.5,-3318.5 3219.5,-3312.5 3219.5,-3312.5 3219.5,-3253.5 3219.5,-3253.5 3219.5,-3247.5 3225.5,-3241.5 3231.5,-3241.5 3231.5,-3241.5 3616.5,-3241.5 3616.5,-3241.5 3622.5,-3241.5 3628.5,-3247.5 3628.5,-3253.5 3628.5,-3253.5 3628.5,-3312.5 3628.5,-3312.5 3628.5,-3318.5 3622.5,-3324.5 3616.5,-3324.5"/>
<text text-anchor="middle" x="3424" y="-3309.3" font-family="Times,serif" font-size="14.00">MHA (4 heads)</text>
<text text-anchor="middle" x="3424" y="-3294.3" font-family="Times,serif" font-size="14.00">Input: Q[batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3424" y="-3279.3" font-family="Times,serif" font-size="14.00">K,V[batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3424" y="-3264.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3424" y="-3249.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- q_proj_0_2&#45;&gt;attention_0_2 -->
<g id="edge20" class="edge">
<title>q_proj_0_2&#45;&gt;attention_0_2</title>
<path fill="none" stroke="black" d="M2976.19,-3360.5C3049.66,-3347.95 3133.78,-3333.58 3209.14,-3320.7"/>
<polygon fill="black" stroke="black" points="3209.97,-3324.11 3219.23,-3318.98 3208.79,-3317.21 3209.97,-3324.11"/>
</g>
<!-- k_proj_0_2&#45;&gt;attention_0_2 -->
<g id="edge21" class="edge">
<title>k_proj_0_2&#45;&gt;attention_0_2</title>
<path fill="none" stroke="black" d="M3274.5,-3360.5C3293.69,-3350.68 3315.05,-3339.75 3335.49,-3329.29"/>
<polygon fill="black" stroke="black" points="3337.19,-3332.35 3344.5,-3324.68 3334,-3326.12 3337.19,-3332.35"/>
</g>
<!-- v_proj_0_2&#45;&gt;attention_0_2 -->
<g id="edge22" class="edge">
<title>v_proj_0_2&#45;&gt;attention_0_2</title>
<path fill="none" stroke="black" d="M3572.8,-3360.5C3553.7,-3350.68 3532.44,-3339.75 3512.09,-3329.29"/>
<polygon fill="black" stroke="black" points="3513.63,-3326.14 3503.13,-3324.68 3510.43,-3332.37 3513.63,-3326.14"/>
</g>
<!-- o_proj_0_2 -->
<g id="node18" class="node">
<title>o_proj_0_2</title>
<polygon fill="lightblue" stroke="black" points="4058.5,-3205.5 3661.5,-3205.5 3661.5,-3137.5 4058.5,-3137.5 4058.5,-3205.5"/>
<text text-anchor="middle" x="3860" y="-3190.3" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="3860" y="-3175.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3860" y="-3160.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, d_model=512]</text>
<text text-anchor="middle" x="3860" y="-3145.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- attention_0_2&#45;&gt;o_proj_0_2 -->
<g id="edge23" class="edge">
<title>attention_0_2&#45;&gt;o_proj_0_2</title>
<path fill="none" stroke="black" d="M3585.42,-3241.46C3629.17,-3230.47 3676.19,-3218.66 3718.74,-3207.98"/>
<polygon fill="black" stroke="black" points="3719.75,-3211.33 3728.59,-3205.5 3718.04,-3204.54 3719.75,-3211.33"/>
</g>
<!-- o_proj_0_2&#45;&gt;all_reduce_0 -->
<g id="edge61" class="edge">
<title>o_proj_0_2&#45;&gt;all_reduce_0</title>
<path fill="none" stroke="black" d="M4058.76,-3156.36C4395.2,-3132.43 5078.7,-3083.81 5473.1,-3055.76"/>
<polygon fill="black" stroke="black" points="5473.51,-3059.24 5483.24,-3055.04 5473.01,-3052.26 5473.51,-3059.24"/>
</g>
<!-- attention_0_3 -->
<g id="node22" class="node">
<title>attention_0_3</title>
<path fill="gold" stroke="black" d="M4896.5,-3324.5C4896.5,-3324.5 4511.5,-3324.5 4511.5,-3324.5 4505.5,-3324.5 4499.5,-3318.5 4499.5,-3312.5 4499.5,-3312.5 4499.5,-3253.5 4499.5,-3253.5 4499.5,-3247.5 4505.5,-3241.5 4511.5,-3241.5 4511.5,-3241.5 4896.5,-3241.5 4896.5,-3241.5 4902.5,-3241.5 4908.5,-3247.5 4908.5,-3253.5 4908.5,-3253.5 4908.5,-3312.5 4908.5,-3312.5 4908.5,-3318.5 4902.5,-3324.5 4896.5,-3324.5"/>
<text text-anchor="middle" x="4704" y="-3309.3" font-family="Times,serif" font-size="14.00">MHA (4 heads)</text>
<text text-anchor="middle" x="4704" y="-3294.3" font-family="Times,serif" font-size="14.00">Input: Q[batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4704" y="-3279.3" font-family="Times,serif" font-size="14.00">K,V[batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4704" y="-3264.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4704" y="-3249.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- q_proj_0_3&#45;&gt;attention_0_3 -->
<g id="edge27" class="edge">
<title>q_proj_0_3&#45;&gt;attention_0_3</title>
<path fill="none" stroke="black" d="M4256.89,-3360.5C4330.15,-3347.96 4414.04,-3333.61 4489.2,-3320.75"/>
<polygon fill="black" stroke="black" points="4490.01,-3324.16 4499.27,-3319.03 4488.83,-3317.26 4490.01,-3324.16"/>
</g>
<!-- k_proj_0_3&#45;&gt;attention_0_3 -->
<g id="edge28" class="edge">
<title>k_proj_0_3&#45;&gt;attention_0_3</title>
<path fill="none" stroke="black" d="M4555.2,-3360.5C4574.3,-3350.68 4595.56,-3339.75 4615.91,-3329.29"/>
<polygon fill="black" stroke="black" points="4617.57,-3332.37 4624.87,-3324.68 4614.37,-3326.14 4617.57,-3332.37"/>
</g>
<!-- v_proj_0_3&#45;&gt;attention_0_3 -->
<g id="edge29" class="edge">
<title>v_proj_0_3&#45;&gt;attention_0_3</title>
<path fill="none" stroke="black" d="M4853.5,-3360.5C4834.31,-3350.68 4812.95,-3339.75 4792.51,-3329.29"/>
<polygon fill="black" stroke="black" points="4794,-3326.12 4783.5,-3324.68 4790.81,-3332.35 4794,-3326.12"/>
</g>
<!-- o_proj_0_3 -->
<g id="node23" class="node">
<title>o_proj_0_3</title>
<polygon fill="lightblue" stroke="black" points="5335.5,-3205.5 4938.5,-3205.5 4938.5,-3137.5 5335.5,-3137.5 5335.5,-3205.5"/>
<text text-anchor="middle" x="5137" y="-3190.3" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="5137" y="-3175.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5137" y="-3160.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, d_model=512]</text>
<text text-anchor="middle" x="5137" y="-3145.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- attention_0_3&#45;&gt;o_proj_0_3 -->
<g id="edge30" class="edge">
<title>attention_0_3&#45;&gt;o_proj_0_3</title>
<path fill="none" stroke="black" d="M4864.31,-3241.46C4907.76,-3230.47 4954.45,-3218.66 4996.71,-3207.98"/>
<polygon fill="black" stroke="black" points="4997.66,-3211.35 5006.5,-3205.5 4995.95,-3204.56 4997.66,-3211.35"/>
</g>
<!-- o_proj_0_3&#45;&gt;all_reduce_0 -->
<g id="edge62" class="edge">
<title>o_proj_0_3&#45;&gt;all_reduce_0</title>
<path fill="none" stroke="black" d="M5291.12,-3137.49C5357.61,-3123.25 5437.23,-3106.2 5512.38,-3090.1"/>
<polygon fill="black" stroke="black" points="5513.42,-3093.46 5522.47,-3087.94 5511.96,-3086.61 5513.42,-3093.46"/>
</g>
<!-- attention_0_4 -->
<g id="node27" class="node">
<title>attention_0_4</title>
<path fill="gold" stroke="black" d="M5964.5,-3324.5C5964.5,-3324.5 5579.5,-3324.5 5579.5,-3324.5 5573.5,-3324.5 5567.5,-3318.5 5567.5,-3312.5 5567.5,-3312.5 5567.5,-3253.5 5567.5,-3253.5 5567.5,-3247.5 5573.5,-3241.5 5579.5,-3241.5 5579.5,-3241.5 5964.5,-3241.5 5964.5,-3241.5 5970.5,-3241.5 5976.5,-3247.5 5976.5,-3253.5 5976.5,-3253.5 5976.5,-3312.5 5976.5,-3312.5 5976.5,-3318.5 5970.5,-3324.5 5964.5,-3324.5"/>
<text text-anchor="middle" x="5772" y="-3309.3" font-family="Times,serif" font-size="14.00">MHA (4 heads)</text>
<text text-anchor="middle" x="5772" y="-3294.3" font-family="Times,serif" font-size="14.00">Input: Q[batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5772" y="-3279.3" font-family="Times,serif" font-size="14.00">K,V[batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5772" y="-3264.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5772" y="-3249.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- q_proj_0_4&#45;&gt;attention_0_4 -->
<g id="edge34" class="edge">
<title>q_proj_0_4&#45;&gt;attention_0_4</title>
<path fill="none" stroke="black" d="M5473.69,-3360.5C5514.67,-3349.99 5560.63,-3338.2 5603.96,-3327.09"/>
<polygon fill="black" stroke="black" points="5604.93,-3330.46 5613.75,-3324.58 5603.19,-3323.68 5604.93,-3330.46"/>
</g>
<!-- k_proj_0_4&#45;&gt;attention_0_4 -->
<g id="edge35" class="edge">
<title>k_proj_0_4&#45;&gt;attention_0_4</title>
<path fill="none" stroke="black" d="M5772,-3360.35C5772,-3352.3 5772,-3343.5 5772,-3334.84"/>
<polygon fill="black" stroke="black" points="5775.5,-3334.78 5772,-3324.78 5768.5,-3334.78 5775.5,-3334.78"/>
</g>
<!-- v_proj_0_4&#45;&gt;attention_0_4 -->
<g id="edge36" class="edge">
<title>v_proj_0_4&#45;&gt;attention_0_4</title>
<path fill="none" stroke="black" d="M6070.31,-3360.5C6029.33,-3349.99 5983.37,-3338.2 5940.04,-3327.09"/>
<polygon fill="black" stroke="black" points="5940.81,-3323.68 5930.25,-3324.58 5939.07,-3330.46 5940.81,-3323.68"/>
</g>
<!-- o_proj_0_4 -->
<g id="node28" class="node">
<title>o_proj_0_4</title>
<polygon fill="lightblue" stroke="black" points="5970.5,-3205.5 5573.5,-3205.5 5573.5,-3137.5 5970.5,-3137.5 5970.5,-3205.5"/>
<text text-anchor="middle" x="5772" y="-3190.3" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="5772" y="-3175.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5772" y="-3160.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, d_model=512]</text>
<text text-anchor="middle" x="5772" y="-3145.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- attention_0_4&#45;&gt;o_proj_0_4 -->
<g id="edge37" class="edge">
<title>attention_0_4&#45;&gt;o_proj_0_4</title>
<path fill="none" stroke="black" d="M5772,-3241.23C5772,-3233.02 5772,-3224.36 5772,-3216.06"/>
<polygon fill="black" stroke="black" points="5775.5,-3215.8 5772,-3205.8 5768.5,-3215.8 5775.5,-3215.8"/>
</g>
<!-- o_proj_0_4&#45;&gt;all_reduce_0 -->
<g id="edge63" class="edge">
<title>o_proj_0_4&#45;&gt;all_reduce_0</title>
<path fill="none" stroke="black" d="M5772,-3137.23C5772,-3129.4 5772,-3120.74 5772,-3111.85"/>
<polygon fill="black" stroke="black" points="5775.5,-3111.76 5772,-3101.76 5768.5,-3111.76 5775.5,-3111.76"/>
</g>
<!-- attention_0_5 -->
<g id="node32" class="node">
<title>attention_0_5</title>
<path fill="gold" stroke="black" d="M7031.5,-3324.5C7031.5,-3324.5 6646.5,-3324.5 6646.5,-3324.5 6640.5,-3324.5 6634.5,-3318.5 6634.5,-3312.5 6634.5,-3312.5 6634.5,-3253.5 6634.5,-3253.5 6634.5,-3247.5 6640.5,-3241.5 6646.5,-3241.5 6646.5,-3241.5 7031.5,-3241.5 7031.5,-3241.5 7037.5,-3241.5 7043.5,-3247.5 7043.5,-3253.5 7043.5,-3253.5 7043.5,-3312.5 7043.5,-3312.5 7043.5,-3318.5 7037.5,-3324.5 7031.5,-3324.5"/>
<text text-anchor="middle" x="6839" y="-3309.3" font-family="Times,serif" font-size="14.00">MHA (4 heads)</text>
<text text-anchor="middle" x="6839" y="-3294.3" font-family="Times,serif" font-size="14.00">Input: Q[batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6839" y="-3279.3" font-family="Times,serif" font-size="14.00">K,V[batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6839" y="-3264.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6839" y="-3249.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- q_proj_0_5&#45;&gt;attention_0_5 -->
<g id="edge41" class="edge">
<title>q_proj_0_5&#45;&gt;attention_0_5</title>
<path fill="none" stroke="black" d="M6690.2,-3360.5C6709.3,-3350.68 6730.56,-3339.75 6750.91,-3329.29"/>
<polygon fill="black" stroke="black" points="6752.57,-3332.37 6759.87,-3324.68 6749.37,-3326.14 6752.57,-3332.37"/>
</g>
<!-- k_proj_0_5&#45;&gt;attention_0_5 -->
<g id="edge42" class="edge">
<title>k_proj_0_5&#45;&gt;attention_0_5</title>
<path fill="none" stroke="black" d="M6988.5,-3360.5C6969.31,-3350.68 6947.95,-3339.75 6927.51,-3329.29"/>
<polygon fill="black" stroke="black" points="6929,-3326.12 6918.5,-3324.68 6925.81,-3332.35 6929,-3326.12"/>
</g>
<!-- v_proj_0_5&#45;&gt;attention_0_5 -->
<g id="edge43" class="edge">
<title>v_proj_0_5&#45;&gt;attention_0_5</title>
<path fill="none" stroke="black" d="M7286.81,-3360.5C7213.34,-3347.95 7129.22,-3333.58 7053.86,-3320.7"/>
<polygon fill="black" stroke="black" points="7054.21,-3317.21 7043.77,-3318.98 7053.03,-3324.11 7054.21,-3317.21"/>
</g>
<!-- o_proj_0_5 -->
<g id="node33" class="node">
<title>o_proj_0_5</title>
<polygon fill="lightblue" stroke="black" points="6818.5,-3205.5 6421.5,-3205.5 6421.5,-3137.5 6818.5,-3137.5 6818.5,-3205.5"/>
<text text-anchor="middle" x="6620" y="-3190.3" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="6620" y="-3175.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6620" y="-3160.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, d_model=512]</text>
<text text-anchor="middle" x="6620" y="-3145.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- attention_0_5&#45;&gt;o_proj_0_5 -->
<g id="edge44" class="edge">
<title>attention_0_5&#45;&gt;o_proj_0_5</title>
<path fill="none" stroke="black" d="M6757.76,-3241.38C6737.28,-3231.14 6715.39,-3220.19 6695.22,-3210.11"/>
<polygon fill="black" stroke="black" points="6696.6,-3206.88 6686.09,-3205.54 6693.47,-3213.15 6696.6,-3206.88"/>
</g>
<!-- o_proj_0_5&#45;&gt;all_reduce_0 -->
<g id="edge64" class="edge">
<title>o_proj_0_5&#45;&gt;all_reduce_0</title>
<path fill="none" stroke="black" d="M6421.45,-3138.66C6346.62,-3126.66 6258.59,-3112.54 6171.9,-3098.63"/>
<polygon fill="black" stroke="black" points="6172.31,-3095.16 6161.89,-3097.03 6171.21,-3102.07 6172.31,-3095.16"/>
</g>
<!-- attention_0_6 -->
<g id="node37" class="node">
<title>attention_0_6</title>
<path fill="gold" stroke="black" d="M8313.5,-3324.5C8313.5,-3324.5 7928.5,-3324.5 7928.5,-3324.5 7922.5,-3324.5 7916.5,-3318.5 7916.5,-3312.5 7916.5,-3312.5 7916.5,-3253.5 7916.5,-3253.5 7916.5,-3247.5 7922.5,-3241.5 7928.5,-3241.5 7928.5,-3241.5 8313.5,-3241.5 8313.5,-3241.5 8319.5,-3241.5 8325.5,-3247.5 8325.5,-3253.5 8325.5,-3253.5 8325.5,-3312.5 8325.5,-3312.5 8325.5,-3318.5 8319.5,-3324.5 8313.5,-3324.5"/>
<text text-anchor="middle" x="8121" y="-3309.3" font-family="Times,serif" font-size="14.00">MHA (4 heads)</text>
<text text-anchor="middle" x="8121" y="-3294.3" font-family="Times,serif" font-size="14.00">Input: Q[batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8121" y="-3279.3" font-family="Times,serif" font-size="14.00">K,V[batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8121" y="-3264.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8121" y="-3249.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- q_proj_0_6&#45;&gt;attention_0_6 -->
<g id="edge48" class="edge">
<title>q_proj_0_6&#45;&gt;attention_0_6</title>
<path fill="none" stroke="black" d="M7971.5,-3360.5C7990.69,-3350.68 8012.05,-3339.75 8032.49,-3329.29"/>
<polygon fill="black" stroke="black" points="8034.19,-3332.35 8041.5,-3324.68 8031,-3326.12 8034.19,-3332.35"/>
</g>
<!-- k_proj_0_6&#45;&gt;attention_0_6 -->
<g id="edge49" class="edge">
<title>k_proj_0_6&#45;&gt;attention_0_6</title>
<path fill="none" stroke="black" d="M8269.8,-3360.5C8250.7,-3350.68 8229.44,-3339.75 8209.09,-3329.29"/>
<polygon fill="black" stroke="black" points="8210.63,-3326.14 8200.13,-3324.68 8207.43,-3332.37 8210.63,-3326.14"/>
</g>
<!-- v_proj_0_6&#45;&gt;attention_0_6 -->
<g id="edge50" class="edge">
<title>v_proj_0_6&#45;&gt;attention_0_6</title>
<path fill="none" stroke="black" d="M8568.11,-3360.5C8494.85,-3347.96 8410.96,-3333.61 8335.8,-3320.75"/>
<polygon fill="black" stroke="black" points="8336.17,-3317.26 8325.73,-3319.03 8334.99,-3324.16 8336.17,-3317.26"/>
</g>
<!-- o_proj_0_6 -->
<g id="node38" class="node">
<title>o_proj_0_6</title>
<polygon fill="lightblue" stroke="black" points="7563.5,-3205.5 7166.5,-3205.5 7166.5,-3137.5 7563.5,-3137.5 7563.5,-3205.5"/>
<text text-anchor="middle" x="7365" y="-3190.3" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="7365" y="-3175.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7365" y="-3160.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, d_model=512]</text>
<text text-anchor="middle" x="7365" y="-3145.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- attention_0_6&#45;&gt;o_proj_0_6 -->
<g id="edge51" class="edge">
<title>attention_0_6&#45;&gt;o_proj_0_6</title>
<path fill="none" stroke="black" d="M7916.42,-3252.37C7810.08,-3236.97 7680.38,-3218.18 7573.49,-3202.7"/>
<polygon fill="black" stroke="black" points="7573.94,-3199.23 7563.54,-3201.26 7572.94,-3206.15 7573.94,-3199.23"/>
</g>
<!-- o_proj_0_6&#45;&gt;all_reduce_0 -->
<g id="edge65" class="edge">
<title>o_proj_0_6&#45;&gt;all_reduce_0</title>
<path fill="none" stroke="black" d="M7166.47,-3153.55C6908.52,-3131.53 6453.41,-3092.67 6133.43,-3065.36"/>
<polygon fill="black" stroke="black" points="6133.32,-3061.83 6123.06,-3064.47 6132.72,-3068.81 6133.32,-3061.83"/>
</g>
<!-- attention_0_7 -->
<g id="node42" class="node">
<title>attention_0_7</title>
<path fill="gold" stroke="black" d="M9593.5,-3324.5C9593.5,-3324.5 9208.5,-3324.5 9208.5,-3324.5 9202.5,-3324.5 9196.5,-3318.5 9196.5,-3312.5 9196.5,-3312.5 9196.5,-3253.5 9196.5,-3253.5 9196.5,-3247.5 9202.5,-3241.5 9208.5,-3241.5 9208.5,-3241.5 9593.5,-3241.5 9593.5,-3241.5 9599.5,-3241.5 9605.5,-3247.5 9605.5,-3253.5 9605.5,-3253.5 9605.5,-3312.5 9605.5,-3312.5 9605.5,-3318.5 9599.5,-3324.5 9593.5,-3324.5"/>
<text text-anchor="middle" x="9401" y="-3309.3" font-family="Times,serif" font-size="14.00">MHA (4 heads)</text>
<text text-anchor="middle" x="9401" y="-3294.3" font-family="Times,serif" font-size="14.00">Input: Q[batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9401" y="-3279.3" font-family="Times,serif" font-size="14.00">K,V[batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9401" y="-3264.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9401" y="-3249.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- q_proj_0_7&#45;&gt;attention_0_7 -->
<g id="edge55" class="edge">
<title>q_proj_0_7&#45;&gt;attention_0_7</title>
<path fill="none" stroke="black" d="M9252.2,-3360.5C9271.3,-3350.68 9292.56,-3339.75 9312.91,-3329.29"/>
<polygon fill="black" stroke="black" points="9314.57,-3332.37 9321.87,-3324.68 9311.37,-3326.14 9314.57,-3332.37"/>
</g>
<!-- k_proj_0_7&#45;&gt;attention_0_7 -->
<g id="edge56" class="edge">
<title>k_proj_0_7&#45;&gt;attention_0_7</title>
<path fill="none" stroke="black" d="M9550.5,-3360.5C9531.31,-3350.68 9509.95,-3339.75 9489.51,-3329.29"/>
<polygon fill="black" stroke="black" points="9491,-3326.12 9480.5,-3324.68 9487.81,-3332.35 9491,-3326.12"/>
</g>
<!-- v_proj_0_7&#45;&gt;attention_0_7 -->
<g id="edge57" class="edge">
<title>v_proj_0_7&#45;&gt;attention_0_7</title>
<path fill="none" stroke="black" d="M9848.81,-3360.5C9775.34,-3347.95 9691.22,-3333.58 9615.86,-3320.7"/>
<polygon fill="black" stroke="black" points="9616.21,-3317.21 9605.77,-3318.98 9615.03,-3324.11 9616.21,-3317.21"/>
</g>
<!-- o_proj_0_7 -->
<g id="node43" class="node">
<title>o_proj_0_7</title>
<polygon fill="lightblue" stroke="black" points="9002.5,-3205.5 8605.5,-3205.5 8605.5,-3137.5 9002.5,-3137.5 9002.5,-3205.5"/>
<text text-anchor="middle" x="8804" y="-3190.3" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="8804" y="-3175.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8804" y="-3160.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, d_model=512]</text>
<text text-anchor="middle" x="8804" y="-3145.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- attention_0_7&#45;&gt;o_proj_0_7 -->
<g id="edge58" class="edge">
<title>attention_0_7&#45;&gt;o_proj_0_7</title>
<path fill="none" stroke="black" d="M9196.38,-3244.47C9130.89,-3232.46 9058.68,-3219.21 8994.25,-3207.39"/>
<polygon fill="black" stroke="black" points="8994.86,-3203.95 8984.39,-3205.59 8993.6,-3210.83 8994.86,-3203.95"/>
</g>
<!-- o_proj_0_7&#45;&gt;all_reduce_0 -->
<g id="edge66" class="edge">
<title>o_proj_0_7&#45;&gt;all_reduce_0</title>
<path fill="none" stroke="black" d="M8605.35,-3161.59C8098.57,-3138.86 6752.76,-3078.49 6115.62,-3049.91"/>
<polygon fill="black" stroke="black" points="6115.51,-3046.4 6105.36,-3049.45 6115.2,-3053.4 6115.51,-3046.4"/>
</g>
<!-- all_reduce_0&#45;&gt;add_0 -->
<g id="edge67" class="edge">
<title>all_reduce_0&#45;&gt;add_0</title>
<path fill="none" stroke="black" d="M6059.16,-3010.5C6420.36,-2982.82 7031.31,-2936.01 7346.14,-2911.89"/>
<polygon fill="black" stroke="black" points="7346.59,-2915.37 7356.29,-2911.11 7346.05,-2908.39 7346.59,-2915.37"/>
</g>
<!-- mlp0_gate -->
<g id="node46" class="node">
<title>mlp0_gate</title>
<polygon fill="lightpink" stroke="black" points="7322.5,-2825.5 6909.5,-2825.5 6909.5,-2757.5 7322.5,-2757.5 7322.5,-2825.5"/>
<text text-anchor="middle" x="7116" y="-2810.3" font-family="Times,serif" font-size="14.00">MLP Gate</text>
<text text-anchor="middle" x="7116" y="-2795.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="7116" y="-2780.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="7116" y="-2765.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- add_0&#45;&gt;mlp0_gate -->
<g id="edge69" class="edge">
<title>add_0&#45;&gt;mlp0_gate</title>
<path fill="none" stroke="black" d="M7407.36,-2861.45C7362.03,-2850.72 7311.56,-2838.78 7265.53,-2827.89"/>
<polygon fill="black" stroke="black" points="7266.32,-2824.48 7255.78,-2825.58 7264.71,-2831.29 7266.32,-2824.48"/>
</g>
<!-- mlp0_up -->
<g id="node47" class="node">
<title>mlp0_up</title>
<polygon fill="lightpink" stroke="black" points="7753.5,-2825.5 7340.5,-2825.5 7340.5,-2757.5 7753.5,-2757.5 7753.5,-2825.5"/>
<text text-anchor="middle" x="7547" y="-2810.3" font-family="Times,serif" font-size="14.00">MLP Up</text>
<text text-anchor="middle" x="7547" y="-2795.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="7547" y="-2780.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="7547" y="-2765.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- add_0&#45;&gt;mlp0_up -->
<g id="edge70" class="edge">
<title>add_0&#45;&gt;mlp0_up</title>
<path fill="none" stroke="black" d="M7547,-2861.38C7547,-2853.28 7547,-2844.48 7547,-2835.97"/>
<polygon fill="black" stroke="black" points="7550.5,-2835.8 7547,-2825.8 7543.5,-2835.8 7550.5,-2835.8"/>
</g>
<!-- add_1 -->
<g id="node49" class="node">
<title>add_1</title>
<polygon fill="lightgray" stroke="black" points="7850.5,-2617.5 7469.5,-2617.5 7469.5,-2549.5 7850.5,-2549.5 7850.5,-2617.5"/>
<text text-anchor="middle" x="7660" y="-2602.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7660" y="-2587.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="7660" y="-2572.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="7660" y="-2557.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- add_0&#45;&gt;add_1 -->
<g id="edge74" class="edge">
<title>add_0&#45;&gt;add_1</title>
<path fill="none" stroke="black" d="M7722.26,-2861.35C7738.05,-2852.1 7752.15,-2840.36 7763,-2825.5 7775.04,-2809.02 7765.7,-2669.24 7757,-2653.5 7750.74,-2642.19 7741.75,-2632.28 7731.74,-2623.77"/>
<polygon fill="black" stroke="black" points="7733.91,-2621.03 7723.91,-2617.54 7729.55,-2626.51 7733.91,-2621.03"/>
</g>
<!-- mlp0_down -->
<g id="node48" class="node">
<title>mlp0_down</title>
<polygon fill="lightpink" stroke="black" points="7747.5,-2721.5 7346.5,-2721.5 7346.5,-2653.5 7747.5,-2653.5 7747.5,-2721.5"/>
<text text-anchor="middle" x="7547" y="-2706.3" font-family="Times,serif" font-size="14.00">MLP Down</text>
<text text-anchor="middle" x="7547" y="-2691.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, mlp_hidden=32768]</text>
<text text-anchor="middle" x="7547" y="-2676.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="7547" y="-2661.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- mlp0_gate&#45;&gt;mlp0_down -->
<g id="edge71" class="edge">
<title>mlp0_gate&#45;&gt;mlp0_down</title>
<path fill="none" stroke="black" d="M7255.64,-2757.45C7300.97,-2746.72 7351.44,-2734.78 7397.47,-2723.89"/>
<polygon fill="black" stroke="black" points="7398.29,-2727.29 7407.22,-2721.58 7396.68,-2720.48 7398.29,-2727.29"/>
</g>
<!-- mlp0_up&#45;&gt;mlp0_down -->
<g id="edge72" class="edge">
<title>mlp0_up&#45;&gt;mlp0_down</title>
<path fill="none" stroke="black" d="M7547,-2757.38C7547,-2749.28 7547,-2740.48 7547,-2731.97"/>
<polygon fill="black" stroke="black" points="7550.5,-2731.8 7547,-2721.8 7543.5,-2731.8 7550.5,-2731.8"/>
</g>
<!-- mlp0_down&#45;&gt;add_1 -->
<g id="edge73" class="edge">
<title>mlp0_down&#45;&gt;add_1</title>
<path fill="none" stroke="black" d="M7583.69,-2653.38C7593.85,-2644.21 7605,-2634.15 7615.55,-2624.62"/>
<polygon fill="black" stroke="black" points="7618.03,-2627.1 7623.11,-2617.8 7613.34,-2621.9 7618.03,-2627.1"/>
</g>
<!-- ln1_pre -->
<g id="node50" class="node">
<title>ln1_pre</title>
<polygon fill="lightcoral" stroke="black" points="7140.5,-2513.5 6759.5,-2513.5 6759.5,-2445.5 7140.5,-2445.5 7140.5,-2513.5"/>
<text text-anchor="middle" x="6950" y="-2498.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="6950" y="-2483.3" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="6950" y="-2468.3" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="6950" y="-2453.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- add_1&#45;&gt;ln1_pre -->
<g id="edge75" class="edge">
<title>add_1&#45;&gt;ln1_pre</title>
<path fill="none" stroke="black" d="M7469.27,-2555.1C7370.68,-2540.94 7250.42,-2523.66 7150.47,-2509.3"/>
<polygon fill="black" stroke="black" points="7150.95,-2505.83 7140.55,-2507.87 7149.95,-2512.76 7150.95,-2505.83"/>
</g>
<!-- add_2 -->
<g id="node92" class="node">
<title>add_2</title>
<polygon fill="lightgray" stroke="black" points="7794,-2075.5 7648,-2075.5 7648,-2037.5 7794,-2037.5 7794,-2075.5"/>
<text text-anchor="middle" x="7721" y="-2060.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7721" y="-2045.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- add_1&#45;&gt;add_2 -->
<g id="edge141" class="edge">
<title>add_1&#45;&gt;add_2</title>
<path fill="none" stroke="black" d="M7850.73,-2568.64C8061.04,-2547.98 8370,-2499.28 8370,-2391.5 8370,-2391.5 8370,-2391.5 8370,-2241.5 8370,-2125.24 7979.62,-2078.64 7804.4,-2063.58"/>
<polygon fill="black" stroke="black" points="7804.45,-2060.07 7794.19,-2062.71 7803.86,-2067.04 7804.45,-2060.07"/>
</g>
<!-- q_proj_1_0 -->
<g id="node51" class="node">
<title>q_proj_1_0</title>
<polygon fill="lightblue" stroke="black" points="5530.5,-2409.5 5425.5,-2409.5 5425.5,-2371.5 5530.5,-2371.5 5530.5,-2409.5"/>
<text text-anchor="middle" x="5478" y="-2394.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5478" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ln1_pre&#45;&gt;q_proj_1_0 -->
<g id="edge76" class="edge">
<title>ln1_pre&#45;&gt;q_proj_1_0</title>
<path fill="none" stroke="black" d="M6759.39,-2474.68C6434.79,-2467.27 5786.83,-2448.3 5540.58,-2409.3"/>
<polygon fill="black" stroke="black" points="5541,-2405.83 5530.57,-2407.67 5539.88,-2412.73 5541,-2405.83"/>
</g>
<!-- k_proj_1_0 -->
<g id="node52" class="node">
<title>k_proj_1_0</title>
<polygon fill="lightblue" stroke="black" points="5653,-2409.5 5549,-2409.5 5549,-2371.5 5653,-2371.5 5653,-2409.5"/>
<text text-anchor="middle" x="5601" y="-2394.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5601" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ln1_pre&#45;&gt;k_proj_1_0 -->
<g id="edge77" class="edge">
<title>ln1_pre&#45;&gt;k_proj_1_0</title>
<path fill="none" stroke="black" d="M6759.49,-2473.75C6458.4,-2465.33 5884.87,-2445.38 5663.03,-2409.4"/>
<polygon fill="black" stroke="black" points="5663.49,-2405.93 5653.05,-2407.73 5662.34,-2412.83 5663.49,-2405.93"/>
</g>
<!-- v_proj_1_0 -->
<g id="node53" class="node">
<title>v_proj_1_0</title>
<polygon fill="lightblue" stroke="black" points="5775,-2409.5 5671,-2409.5 5671,-2371.5 5775,-2371.5 5775,-2409.5"/>
<text text-anchor="middle" x="5723" y="-2394.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="5723" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ln1_pre&#45;&gt;v_proj_1_0 -->
<g id="edge78" class="edge">
<title>ln1_pre&#45;&gt;v_proj_1_0</title>
<path fill="none" stroke="black" d="M6759.21,-2472.37C6482.97,-2462.64 5983.99,-2441.56 5785.33,-2409.25"/>
<polygon fill="black" stroke="black" points="5785.68,-2405.76 5775.24,-2407.56 5784.52,-2412.66 5785.68,-2405.76"/>
</g>
<!-- q_proj_1_1 -->
<g id="node56" class="node">
<title>q_proj_1_1</title>
<polygon fill="lightblue" stroke="black" points="5898.5,-2409.5 5793.5,-2409.5 5793.5,-2371.5 5898.5,-2371.5 5898.5,-2409.5"/>
<text text-anchor="middle" x="5846" y="-2394.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5846" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ln1_pre&#45;&gt;q_proj_1_1 -->
<g id="edge83" class="edge">
<title>ln1_pre&#45;&gt;q_proj_1_1</title>
<path fill="none" stroke="black" d="M6759.33,-2478.2C6551.62,-2475.05 6209.94,-2461.62 5908.83,-2409.4"/>
<polygon fill="black" stroke="black" points="5909.04,-2405.88 5898.58,-2407.61 5907.83,-2412.78 5909.04,-2405.88"/>
</g>
<!-- k_proj_1_1 -->
<g id="node57" class="node">
<title>k_proj_1_1</title>
<polygon fill="lightblue" stroke="black" points="6021,-2409.5 5917,-2409.5 5917,-2371.5 6021,-2371.5 6021,-2409.5"/>
<text text-anchor="middle" x="5969" y="-2394.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5969" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ln1_pre&#45;&gt;k_proj_1_1 -->
<g id="edge84" class="edge">
<title>ln1_pre&#45;&gt;k_proj_1_1</title>
<path fill="none" stroke="black" d="M6759.09,-2475.95C6574.34,-2470.76 6286.75,-2455.5 6030.92,-2409.45"/>
<polygon fill="black" stroke="black" points="6031.53,-2406 6021.07,-2407.65 6030.28,-2412.89 6031.53,-2406"/>
</g>
<!-- v_proj_1_1 -->
<g id="node58" class="node">
<title>v_proj_1_1</title>
<polygon fill="lightblue" stroke="black" points="6143,-2409.5 6039,-2409.5 6039,-2371.5 6143,-2371.5 6143,-2409.5"/>
<text text-anchor="middle" x="6091" y="-2394.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6091" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ln1_pre&#45;&gt;v_proj_1_1 -->
<g id="edge85" class="edge">
<title>ln1_pre&#45;&gt;v_proj_1_1</title>
<path fill="none" stroke="black" d="M6759.37,-2472.5C6599.56,-2465.01 6365.58,-2448.31 6153.35,-2409.33"/>
<polygon fill="black" stroke="black" points="6153.73,-2405.84 6143.26,-2407.45 6152.45,-2412.72 6153.73,-2405.84"/>
</g>
<!-- q_proj_1_2 -->
<g id="node61" class="node">
<title>q_proj_1_2</title>
<polygon fill="lightblue" stroke="black" points="6266.5,-2409.5 6161.5,-2409.5 6161.5,-2371.5 6266.5,-2371.5 6266.5,-2409.5"/>
<text text-anchor="middle" x="6214" y="-2394.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6214" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ln1_pre&#45;&gt;q_proj_1_2 -->
<g id="edge90" class="edge">
<title>ln1_pre&#45;&gt;q_proj_1_2</title>
<path fill="none" stroke="black" d="M6759.45,-2468.2C6626.38,-2458.81 6444.75,-2441.63 6276.64,-2409.42"/>
<polygon fill="black" stroke="black" points="6277.09,-2405.94 6266.61,-2407.47 6275.76,-2412.81 6277.09,-2405.94"/>
</g>
<!-- k_proj_1_2 -->
<g id="node62" class="node">
<title>k_proj_1_2</title>
<polygon fill="lightblue" stroke="black" points="6389,-2409.5 6285,-2409.5 6285,-2371.5 6389,-2371.5 6389,-2409.5"/>
<text text-anchor="middle" x="6337" y="-2394.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6337" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ln1_pre&#45;&gt;k_proj_1_2 -->
<g id="edge91" class="edge">
<title>ln1_pre&#45;&gt;k_proj_1_2</title>
<path fill="none" stroke="black" d="M6759.37,-2462.38C6655.26,-2451.71 6524.13,-2435.22 6399.23,-2409.58"/>
<polygon fill="black" stroke="black" points="6399.6,-2406.09 6389.1,-2407.48 6398.18,-2412.94 6399.6,-2406.09"/>
</g>
<!-- v_proj_1_2 -->
<g id="node63" class="node">
<title>v_proj_1_2</title>
<polygon fill="lightblue" stroke="black" points="6511,-2409.5 6407,-2409.5 6407,-2371.5 6511,-2371.5 6511,-2409.5"/>
<text text-anchor="middle" x="6459" y="-2394.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6459" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ln1_pre&#45;&gt;v_proj_1_2 -->
<g id="edge92" class="edge">
<title>ln1_pre&#45;&gt;v_proj_1_2</title>
<path fill="none" stroke="black" d="M6759.24,-2452.96C6687.39,-2442.06 6604.92,-2428 6521.26,-2409.41"/>
<polygon fill="black" stroke="black" points="6521.84,-2405.95 6511.31,-2407.18 6520.3,-2412.78 6521.84,-2405.95"/>
</g>
<!-- q_proj_1_3 -->
<g id="node66" class="node">
<title>q_proj_1_3</title>
<polygon fill="lightblue" stroke="black" points="6634.5,-2409.5 6529.5,-2409.5 6529.5,-2371.5 6634.5,-2371.5 6634.5,-2409.5"/>
<text text-anchor="middle" x="6582" y="-2394.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6582" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ln1_pre&#45;&gt;q_proj_1_3 -->
<g id="edge97" class="edge">
<title>ln1_pre&#45;&gt;q_proj_1_3</title>
<path fill="none" stroke="black" d="M6795.07,-2445.48C6749.3,-2435.24 6698.97,-2423.52 6644.55,-2409.57"/>
<polygon fill="black" stroke="black" points="6645.26,-2406.14 6634.71,-2407.04 6643.52,-2412.92 6645.26,-2406.14"/>
</g>
<!-- k_proj_1_3 -->
<g id="node67" class="node">
<title>k_proj_1_3</title>
<polygon fill="lightblue" stroke="black" points="6757,-2409.5 6653,-2409.5 6653,-2371.5 6757,-2371.5 6757,-2409.5"/>
<text text-anchor="middle" x="6705" y="-2394.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6705" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ln1_pre&#45;&gt;k_proj_1_3 -->
<g id="edge98" class="edge">
<title>ln1_pre&#45;&gt;k_proj_1_3</title>
<path fill="none" stroke="black" d="M6857.03,-2445.48C6826.27,-2434.56 6792.87,-2422.7 6765.23,-2412.89"/>
<polygon fill="black" stroke="black" points="6766.31,-2409.56 6755.71,-2409.51 6763.96,-2416.15 6766.31,-2409.56"/>
</g>
<!-- v_proj_1_3 -->
<g id="node68" class="node">
<title>v_proj_1_3</title>
<polygon fill="lightblue" stroke="black" points="6879,-2409.5 6775,-2409.5 6775,-2371.5 6879,-2371.5 6879,-2409.5"/>
<text text-anchor="middle" x="6827" y="-2394.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6827" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ln1_pre&#45;&gt;v_proj_1_3 -->
<g id="edge99" class="edge">
<title>ln1_pre&#45;&gt;v_proj_1_3</title>
<path fill="none" stroke="black" d="M6903.15,-2445.36C6889.11,-2435.43 6874,-2424.74 6860.96,-2415.52"/>
<polygon fill="black" stroke="black" points="6862.92,-2412.62 6852.73,-2409.7 6858.87,-2418.33 6862.92,-2412.62"/>
</g>
<!-- q_proj_1_4 -->
<g id="node71" class="node">
<title>q_proj_1_4</title>
<polygon fill="lightblue" stroke="black" points="7002.5,-2409.5 6897.5,-2409.5 6897.5,-2371.5 7002.5,-2371.5 7002.5,-2409.5"/>
<text text-anchor="middle" x="6950" y="-2394.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6950" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ln1_pre&#45;&gt;q_proj_1_4 -->
<g id="edge104" class="edge">
<title>ln1_pre&#45;&gt;q_proj_1_4</title>
<path fill="none" stroke="black" d="M6950,-2445.11C6950,-2436.72 6950,-2427.79 6950,-2419.67"/>
<polygon fill="black" stroke="black" points="6953.5,-2419.59 6950,-2409.59 6946.5,-2419.59 6953.5,-2419.59"/>
</g>
<!-- k_proj_1_4 -->
<g id="node72" class="node">
<title>k_proj_1_4</title>
<polygon fill="lightblue" stroke="black" points="7125,-2409.5 7021,-2409.5 7021,-2371.5 7125,-2371.5 7125,-2409.5"/>
<text text-anchor="middle" x="7073" y="-2394.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="7073" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ln1_pre&#45;&gt;k_proj_1_4 -->
<g id="edge105" class="edge">
<title>ln1_pre&#45;&gt;k_proj_1_4</title>
<path fill="none" stroke="black" d="M6996.85,-2445.36C7010.89,-2435.43 7026,-2424.74 7039.04,-2415.52"/>
<polygon fill="black" stroke="black" points="7041.13,-2418.33 7047.27,-2409.7 7037.08,-2412.62 7041.13,-2418.33"/>
</g>
<!-- v_proj_1_4 -->
<g id="node73" class="node">
<title>v_proj_1_4</title>
<polygon fill="lightblue" stroke="black" points="7247,-2409.5 7143,-2409.5 7143,-2371.5 7247,-2371.5 7247,-2409.5"/>
<text text-anchor="middle" x="7195" y="-2394.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7195" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ln1_pre&#45;&gt;v_proj_1_4 -->
<g id="edge106" class="edge">
<title>ln1_pre&#45;&gt;v_proj_1_4</title>
<path fill="none" stroke="black" d="M7042.97,-2445.48C7073.73,-2434.56 7107.13,-2422.7 7134.77,-2412.89"/>
<polygon fill="black" stroke="black" points="7136.04,-2416.15 7144.29,-2409.51 7133.69,-2409.56 7136.04,-2416.15"/>
</g>
<!-- q_proj_1_5 -->
<g id="node76" class="node">
<title>q_proj_1_5</title>
<polygon fill="lightblue" stroke="black" points="7370.5,-2409.5 7265.5,-2409.5 7265.5,-2371.5 7370.5,-2371.5 7370.5,-2409.5"/>
<text text-anchor="middle" x="7318" y="-2394.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7318" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ln1_pre&#45;&gt;q_proj_1_5 -->
<g id="edge111" class="edge">
<title>ln1_pre&#45;&gt;q_proj_1_5</title>
<path fill="none" stroke="black" d="M7104.93,-2445.48C7150.7,-2435.24 7201.03,-2423.52 7255.45,-2409.57"/>
<polygon fill="black" stroke="black" points="7256.48,-2412.92 7265.29,-2407.04 7254.74,-2406.14 7256.48,-2412.92"/>
</g>
<!-- k_proj_1_5 -->
<g id="node77" class="node">
<title>k_proj_1_5</title>
<polygon fill="lightblue" stroke="black" points="7493,-2409.5 7389,-2409.5 7389,-2371.5 7493,-2371.5 7493,-2409.5"/>
<text text-anchor="middle" x="7441" y="-2394.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="7441" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ln1_pre&#45;&gt;k_proj_1_5 -->
<g id="edge112" class="edge">
<title>ln1_pre&#45;&gt;k_proj_1_5</title>
<path fill="none" stroke="black" d="M7140.72,-2453.25C7212.86,-2442.36 7295.72,-2428.24 7378.98,-2409.59"/>
<polygon fill="black" stroke="black" points="7379.89,-2412.98 7388.87,-2407.36 7378.35,-2406.15 7379.89,-2412.98"/>
</g>
<!-- v_proj_1_5 -->
<g id="node78" class="node">
<title>v_proj_1_5</title>
<polygon fill="lightblue" stroke="black" points="7615,-2409.5 7511,-2409.5 7511,-2371.5 7615,-2371.5 7615,-2409.5"/>
<text text-anchor="middle" x="7563" y="-2394.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7563" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ln1_pre&#45;&gt;v_proj_1_5 -->
<g id="edge113" class="edge">
<title>ln1_pre&#45;&gt;v_proj_1_5</title>
<path fill="none" stroke="black" d="M7140.63,-2462.38C7244.74,-2451.71 7375.87,-2435.22 7500.77,-2409.58"/>
<polygon fill="black" stroke="black" points="7501.82,-2412.94 7510.9,-2407.48 7500.4,-2406.09 7501.82,-2412.94"/>
</g>
<!-- q_proj_1_6 -->
<g id="node81" class="node">
<title>q_proj_1_6</title>
<polygon fill="lightblue" stroke="black" points="7738.5,-2409.5 7633.5,-2409.5 7633.5,-2371.5 7738.5,-2371.5 7738.5,-2409.5"/>
<text text-anchor="middle" x="7686" y="-2394.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7686" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ln1_pre&#45;&gt;q_proj_1_6 -->
<g id="edge118" class="edge">
<title>ln1_pre&#45;&gt;q_proj_1_6</title>
<path fill="none" stroke="black" d="M7140.55,-2468.2C7273.62,-2458.81 7455.25,-2441.63 7623.36,-2409.42"/>
<polygon fill="black" stroke="black" points="7624.24,-2412.81 7633.39,-2407.47 7622.91,-2405.94 7624.24,-2412.81"/>
</g>
<!-- k_proj_1_6 -->
<g id="node82" class="node">
<title>k_proj_1_6</title>
<polygon fill="lightblue" stroke="black" points="7861,-2409.5 7757,-2409.5 7757,-2371.5 7861,-2371.5 7861,-2409.5"/>
<text text-anchor="middle" x="7809" y="-2394.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="7809" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ln1_pre&#45;&gt;k_proj_1_6 -->
<g id="edge119" class="edge">
<title>ln1_pre&#45;&gt;k_proj_1_6</title>
<path fill="none" stroke="black" d="M7140.5,-2472.77C7300.56,-2465.44 7535.06,-2448.82 7746.86,-2409.5"/>
<polygon fill="black" stroke="black" points="7747.74,-2412.9 7756.92,-2407.61 7746.45,-2406.02 7747.74,-2412.9"/>
</g>
<!-- v_proj_1_6 -->
<g id="node83" class="node">
<title>v_proj_1_6</title>
<polygon fill="lightblue" stroke="black" points="7983,-2409.5 7879,-2409.5 7879,-2371.5 7983,-2371.5 7983,-2409.5"/>
<text text-anchor="middle" x="7931" y="-2394.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7931" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ln1_pre&#45;&gt;v_proj_1_6 -->
<g id="edge120" class="edge">
<title>ln1_pre&#45;&gt;v_proj_1_6</title>
<path fill="none" stroke="black" d="M7140.91,-2475.95C7325.66,-2470.76 7613.25,-2455.5 7869.08,-2409.45"/>
<polygon fill="black" stroke="black" points="7869.72,-2412.89 7878.93,-2407.65 7868.47,-2406 7869.72,-2412.89"/>
</g>
<!-- q_proj_1_7 -->
<g id="node86" class="node">
<title>q_proj_1_7</title>
<polygon fill="lightblue" stroke="black" points="8106.5,-2409.5 8001.5,-2409.5 8001.5,-2371.5 8106.5,-2371.5 8106.5,-2409.5"/>
<text text-anchor="middle" x="8054" y="-2394.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="8054" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ln1_pre&#45;&gt;q_proj_1_7 -->
<g id="edge125" class="edge">
<title>ln1_pre&#45;&gt;q_proj_1_7</title>
<path fill="none" stroke="black" d="M7140.67,-2478.2C7348.38,-2475.05 7690.06,-2461.62 7991.17,-2409.4"/>
<polygon fill="black" stroke="black" points="7992.17,-2412.78 8001.42,-2407.61 7990.96,-2405.88 7992.17,-2412.78"/>
</g>
<!-- k_proj_1_7 -->
<g id="node87" class="node">
<title>k_proj_1_7</title>
<polygon fill="lightblue" stroke="black" points="8229,-2409.5 8125,-2409.5 8125,-2371.5 8229,-2371.5 8229,-2409.5"/>
<text text-anchor="middle" x="8177" y="-2394.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="8177" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ln1_pre&#45;&gt;k_proj_1_7 -->
<g id="edge126" class="edge">
<title>ln1_pre&#45;&gt;k_proj_1_7</title>
<path fill="none" stroke="black" d="M7140.68,-2472.49C7417.12,-2462.89 7916.84,-2441.99 8114.89,-2409.42"/>
<polygon fill="black" stroke="black" points="8115.67,-2412.84 8124.94,-2407.71 8114.5,-2405.93 8115.67,-2412.84"/>
</g>
<!-- v_proj_1_7 -->
<g id="node88" class="node">
<title>v_proj_1_7</title>
<polygon fill="lightblue" stroke="black" points="8351,-2409.5 8247,-2409.5 8247,-2371.5 8351,-2371.5 8351,-2409.5"/>
<text text-anchor="middle" x="8299" y="-2394.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="8299" y="-2379.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ln1_pre&#45;&gt;v_proj_1_7 -->
<g id="edge127" class="edge">
<title>ln1_pre&#45;&gt;v_proj_1_7</title>
<path fill="none" stroke="black" d="M7140.51,-2473.75C7441.6,-2465.33 8015.13,-2445.38 8236.97,-2409.4"/>
<polygon fill="black" stroke="black" points="8237.66,-2412.83 8246.95,-2407.73 8236.51,-2405.93 8237.66,-2412.83"/>
</g>
<!-- attention_1_0 -->
<g id="node54" class="node">
<title>attention_1_0</title>
<path fill="gold" stroke="black" d="M5653,-2335.5C5653,-2335.5 5611,-2335.5 5611,-2335.5 5605,-2335.5 5599,-2329.5 5599,-2323.5 5599,-2323.5 5599,-2309.5 5599,-2309.5 5599,-2303.5 5605,-2297.5 5611,-2297.5 5611,-2297.5 5653,-2297.5 5653,-2297.5 5659,-2297.5 5665,-2303.5 5665,-2309.5 5665,-2309.5 5665,-2323.5 5665,-2323.5 5665,-2329.5 5659,-2335.5 5653,-2335.5"/>
<text text-anchor="middle" x="5632" y="-2320.3" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="5632" y="-2305.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- q_proj_1_0&#45;&gt;attention_1_0 -->
<g id="edge79" class="edge">
<title>q_proj_1_0&#45;&gt;attention_1_0</title>
<path fill="none" stroke="black" d="M5516.86,-2371.33C5539.1,-2360.93 5567.02,-2347.88 5589.8,-2337.23"/>
<polygon fill="black" stroke="black" points="5591.32,-2340.38 5598.89,-2332.98 5588.35,-2334.04 5591.32,-2340.38"/>
</g>
<!-- k_proj_1_0&#45;&gt;attention_1_0 -->
<g id="edge80" class="edge">
<title>k_proj_1_0&#45;&gt;attention_1_0</title>
<path fill="none" stroke="black" d="M5608.82,-2371.33C5612.21,-2363.46 5616.25,-2354.07 5620.01,-2345.35"/>
<polygon fill="black" stroke="black" points="5623.33,-2346.48 5624.07,-2335.91 5616.9,-2343.71 5623.33,-2346.48"/>
</g>
<!-- v_proj_1_0&#45;&gt;attention_1_0 -->
<g id="edge81" class="edge">
<title>v_proj_1_0&#45;&gt;attention_1_0</title>
<path fill="none" stroke="black" d="M5700.04,-2371.33C5688.83,-2362.46 5675.18,-2351.66 5663.06,-2342.07"/>
<polygon fill="black" stroke="black" points="5664.97,-2339.12 5654.96,-2335.66 5660.63,-2344.61 5664.97,-2339.12"/>
</g>
<!-- o_proj_1_0 -->
<g id="node55" class="node">
<title>o_proj_1_0</title>
<polygon fill="lightblue" stroke="black" points="5715.5,-2261.5 5610.5,-2261.5 5610.5,-2223.5 5715.5,-2223.5 5715.5,-2261.5"/>
<text text-anchor="middle" x="5663" y="-2246.3" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="5663" y="-2231.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- attention_1_0&#45;&gt;o_proj_1_0 -->
<g id="edge82" class="edge">
<title>attention_1_0&#45;&gt;o_proj_1_0</title>
<path fill="none" stroke="black" d="M5639.82,-2297.33C5643.21,-2289.46 5647.25,-2280.07 5651.01,-2271.35"/>
<polygon fill="black" stroke="black" points="5654.33,-2272.48 5655.07,-2261.91 5647.9,-2269.71 5654.33,-2272.48"/>
</g>
<!-- all_reduce_1 -->
<g id="node91" class="node">
<title>all_reduce_1</title>
<polygon fill="orange" stroke="black" points="7224.23,-2187.5 6983.66,-2187.5 6921.77,-2111.5 7162.34,-2111.5 7224.23,-2187.5"/>
<text text-anchor="middle" x="7073" y="-2153.3" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="7073" y="-2138.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- o_proj_1_0&#45;&gt;all_reduce_1 -->
<g id="edge132" class="edge">
<title>o_proj_1_0&#45;&gt;all_reduce_1</title>
<path fill="none" stroke="black" d="M5715.7,-2238.1C5918.77,-2224.99 6653.88,-2177.55 6949.06,-2158.5"/>
<polygon fill="black" stroke="black" points="6949.62,-2161.97 6959.37,-2157.83 6949.17,-2154.98 6949.62,-2161.97"/>
</g>
<!-- attention_1_1 -->
<g id="node59" class="node">
<title>attention_1_1</title>
<path fill="gold" stroke="black" d="M6051,-2335.5C6051,-2335.5 6009,-2335.5 6009,-2335.5 6003,-2335.5 5997,-2329.5 5997,-2323.5 5997,-2323.5 5997,-2309.5 5997,-2309.5 5997,-2303.5 6003,-2297.5 6009,-2297.5 6009,-2297.5 6051,-2297.5 6051,-2297.5 6057,-2297.5 6063,-2303.5 6063,-2309.5 6063,-2309.5 6063,-2323.5 6063,-2323.5 6063,-2329.5 6057,-2335.5 6051,-2335.5"/>
<text text-anchor="middle" x="6030" y="-2320.3" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="6030" y="-2305.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- q_proj_1_1&#45;&gt;attention_1_1 -->
<g id="edge86" class="edge">
<title>q_proj_1_1&#45;&gt;attention_1_1</title>
<path fill="none" stroke="black" d="M5892.43,-2371.33C5921.57,-2359.93 5958.87,-2345.33 5987.28,-2334.22"/>
<polygon fill="black" stroke="black" points="5988.89,-2337.34 5996.93,-2330.44 5986.34,-2330.82 5988.89,-2337.34"/>
</g>
<!-- k_proj_1_1&#45;&gt;attention_1_1 -->
<g id="edge87" class="edge">
<title>k_proj_1_1&#45;&gt;attention_1_1</title>
<path fill="none" stroke="black" d="M5984.39,-2371.33C5991.49,-2362.95 6000.05,-2352.85 6007.82,-2343.67"/>
<polygon fill="black" stroke="black" points="6010.61,-2345.81 6014.4,-2335.91 6005.27,-2341.28 6010.61,-2345.81"/>
</g>
<!-- v_proj_1_1&#45;&gt;attention_1_1 -->
<g id="edge88" class="edge">
<title>v_proj_1_1&#45;&gt;attention_1_1</title>
<path fill="none" stroke="black" d="M6075.61,-2371.33C6068.51,-2362.95 6059.95,-2352.85 6052.18,-2343.67"/>
<polygon fill="black" stroke="black" points="6054.73,-2341.28 6045.6,-2335.91 6049.39,-2345.81 6054.73,-2341.28"/>
</g>
<!-- o_proj_1_1 -->
<g id="node60" class="node">
<title>o_proj_1_1</title>
<polygon fill="lightblue" stroke="black" points="6328.5,-2261.5 6223.5,-2261.5 6223.5,-2223.5 6328.5,-2223.5 6328.5,-2261.5"/>
<text text-anchor="middle" x="6276" y="-2246.3" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="6276" y="-2231.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- attention_1_1&#45;&gt;o_proj_1_1 -->
<g id="edge89" class="edge">
<title>attention_1_1&#45;&gt;o_proj_1_1</title>
<path fill="none" stroke="black" d="M6063.18,-2305.79C6101.58,-2294.55 6165.67,-2275.79 6213.5,-2261.79"/>
<polygon fill="black" stroke="black" points="6214.53,-2265.14 6223.14,-2258.97 6212.56,-2258.42 6214.53,-2265.14"/>
</g>
<!-- o_proj_1_1&#45;&gt;all_reduce_1 -->
<g id="edge133" class="edge">
<title>o_proj_1_1&#45;&gt;all_reduce_1</title>
<path fill="none" stroke="black" d="M6328.6,-2235.49C6454.8,-2221.08 6777.31,-2184.26 6953.57,-2164.14"/>
<polygon fill="black" stroke="black" points="6954.13,-2167.59 6963.67,-2162.98 6953.33,-2160.64 6954.13,-2167.59"/>
</g>
<!-- attention_1_2 -->
<g id="node64" class="node">
<title>attention_1_2</title>
<path fill="gold" stroke="black" d="M6419,-2335.5C6419,-2335.5 6377,-2335.5 6377,-2335.5 6371,-2335.5 6365,-2329.5 6365,-2323.5 6365,-2323.5 6365,-2309.5 6365,-2309.5 6365,-2303.5 6371,-2297.5 6377,-2297.5 6377,-2297.5 6419,-2297.5 6419,-2297.5 6425,-2297.5 6431,-2303.5 6431,-2309.5 6431,-2309.5 6431,-2323.5 6431,-2323.5 6431,-2329.5 6425,-2335.5 6419,-2335.5"/>
<text text-anchor="middle" x="6398" y="-2320.3" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="6398" y="-2305.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- q_proj_1_2&#45;&gt;attention_1_2 -->
<g id="edge93" class="edge">
<title>q_proj_1_2&#45;&gt;attention_1_2</title>
<path fill="none" stroke="black" d="M6260.43,-2371.33C6289.57,-2359.93 6326.87,-2345.33 6355.28,-2334.22"/>
<polygon fill="black" stroke="black" points="6356.89,-2337.34 6364.93,-2330.44 6354.34,-2330.82 6356.89,-2337.34"/>
</g>
<!-- k_proj_1_2&#45;&gt;attention_1_2 -->
<g id="edge94" class="edge">
<title>k_proj_1_2&#45;&gt;attention_1_2</title>
<path fill="none" stroke="black" d="M6352.39,-2371.33C6359.49,-2362.95 6368.05,-2352.85 6375.82,-2343.67"/>
<polygon fill="black" stroke="black" points="6378.61,-2345.81 6382.4,-2335.91 6373.27,-2341.28 6378.61,-2345.81"/>
</g>
<!-- v_proj_1_2&#45;&gt;attention_1_2 -->
<g id="edge95" class="edge">
<title>v_proj_1_2&#45;&gt;attention_1_2</title>
<path fill="none" stroke="black" d="M6443.61,-2371.33C6436.51,-2362.95 6427.95,-2352.85 6420.18,-2343.67"/>
<polygon fill="black" stroke="black" points="6422.73,-2341.28 6413.6,-2335.91 6417.39,-2345.81 6422.73,-2341.28"/>
</g>
<!-- o_proj_1_2 -->
<g id="node65" class="node">
<title>o_proj_1_2</title>
<polygon fill="lightblue" stroke="black" points="6696.5,-2261.5 6591.5,-2261.5 6591.5,-2223.5 6696.5,-2223.5 6696.5,-2261.5"/>
<text text-anchor="middle" x="6644" y="-2246.3" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="6644" y="-2231.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- attention_1_2&#45;&gt;o_proj_1_2 -->
<g id="edge96" class="edge">
<title>attention_1_2&#45;&gt;o_proj_1_2</title>
<path fill="none" stroke="black" d="M6431.18,-2305.79C6469.58,-2294.55 6533.67,-2275.79 6581.5,-2261.79"/>
<polygon fill="black" stroke="black" points="6582.53,-2265.14 6591.14,-2258.97 6580.56,-2258.42 6582.53,-2265.14"/>
</g>
<!-- o_proj_1_2&#45;&gt;all_reduce_1 -->
<g id="edge134" class="edge">
<title>o_proj_1_2&#45;&gt;all_reduce_1</title>
<path fill="none" stroke="black" d="M6696.6,-2230.34C6762.03,-2216.46 6875.5,-2192.39 6960.79,-2174.3"/>
<polygon fill="black" stroke="black" points="6961.73,-2177.68 6970.79,-2172.18 6960.28,-2170.83 6961.73,-2177.68"/>
</g>
<!-- attention_1_3 -->
<g id="node69" class="node">
<title>attention_1_3</title>
<path fill="gold" stroke="black" d="M6787,-2335.5C6787,-2335.5 6745,-2335.5 6745,-2335.5 6739,-2335.5 6733,-2329.5 6733,-2323.5 6733,-2323.5 6733,-2309.5 6733,-2309.5 6733,-2303.5 6739,-2297.5 6745,-2297.5 6745,-2297.5 6787,-2297.5 6787,-2297.5 6793,-2297.5 6799,-2303.5 6799,-2309.5 6799,-2309.5 6799,-2323.5 6799,-2323.5 6799,-2329.5 6793,-2335.5 6787,-2335.5"/>
<text text-anchor="middle" x="6766" y="-2320.3" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="6766" y="-2305.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- q_proj_1_3&#45;&gt;attention_1_3 -->
<g id="edge100" class="edge">
<title>q_proj_1_3&#45;&gt;attention_1_3</title>
<path fill="none" stroke="black" d="M6628.43,-2371.33C6657.57,-2359.93 6694.87,-2345.33 6723.28,-2334.22"/>
<polygon fill="black" stroke="black" points="6724.89,-2337.34 6732.93,-2330.44 6722.34,-2330.82 6724.89,-2337.34"/>
</g>
<!-- k_proj_1_3&#45;&gt;attention_1_3 -->
<g id="edge101" class="edge">
<title>k_proj_1_3&#45;&gt;attention_1_3</title>
<path fill="none" stroke="black" d="M6720.39,-2371.33C6727.49,-2362.95 6736.05,-2352.85 6743.82,-2343.67"/>
<polygon fill="black" stroke="black" points="6746.61,-2345.81 6750.4,-2335.91 6741.27,-2341.28 6746.61,-2345.81"/>
</g>
<!-- v_proj_1_3&#45;&gt;attention_1_3 -->
<g id="edge102" class="edge">
<title>v_proj_1_3&#45;&gt;attention_1_3</title>
<path fill="none" stroke="black" d="M6811.61,-2371.33C6804.51,-2362.95 6795.95,-2352.85 6788.18,-2343.67"/>
<polygon fill="black" stroke="black" points="6790.73,-2341.28 6781.6,-2335.91 6785.39,-2345.81 6790.73,-2341.28"/>
</g>
<!-- o_proj_1_3 -->
<g id="node70" class="node">
<title>o_proj_1_3</title>
<polygon fill="lightblue" stroke="black" points="6941.5,-2261.5 6836.5,-2261.5 6836.5,-2223.5 6941.5,-2223.5 6941.5,-2261.5"/>
<text text-anchor="middle" x="6889" y="-2246.3" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="6889" y="-2231.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- attention_1_3&#45;&gt;o_proj_1_3 -->
<g id="edge103" class="edge">
<title>attention_1_3&#45;&gt;o_proj_1_3</title>
<path fill="none" stroke="black" d="M6797.04,-2297.33C6812.77,-2288.12 6832.06,-2276.83 6848.9,-2266.97"/>
<polygon fill="black" stroke="black" points="6851.11,-2269.73 6857.97,-2261.66 6847.57,-2263.69 6851.11,-2269.73"/>
</g>
<!-- o_proj_1_3&#45;&gt;all_reduce_1 -->
<g id="edge135" class="edge">
<title>o_proj_1_3&#45;&gt;all_reduce_1</title>
<path fill="none" stroke="black" d="M6925.79,-2223.3C6943.95,-2214.32 6966.66,-2203.09 6988.77,-2192.16"/>
<polygon fill="black" stroke="black" points="6990.45,-2195.23 6997.86,-2187.66 6987.35,-2188.96 6990.45,-2195.23"/>
</g>
<!-- attention_1_4 -->
<g id="node74" class="node">
<title>attention_1_4</title>
<path fill="gold" stroke="black" d="M7094,-2335.5C7094,-2335.5 7052,-2335.5 7052,-2335.5 7046,-2335.5 7040,-2329.5 7040,-2323.5 7040,-2323.5 7040,-2309.5 7040,-2309.5 7040,-2303.5 7046,-2297.5 7052,-2297.5 7052,-2297.5 7094,-2297.5 7094,-2297.5 7100,-2297.5 7106,-2303.5 7106,-2309.5 7106,-2309.5 7106,-2323.5 7106,-2323.5 7106,-2329.5 7100,-2335.5 7094,-2335.5"/>
<text text-anchor="middle" x="7073" y="-2320.3" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="7073" y="-2305.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- q_proj_1_4&#45;&gt;attention_1_4 -->
<g id="edge107" class="edge">
<title>q_proj_1_4&#45;&gt;attention_1_4</title>
<path fill="none" stroke="black" d="M6981.04,-2371.33C6996.77,-2362.12 7016.06,-2350.83 7032.9,-2340.97"/>
<polygon fill="black" stroke="black" points="7035.11,-2343.73 7041.97,-2335.66 7031.57,-2337.69 7035.11,-2343.73"/>
</g>
<!-- k_proj_1_4&#45;&gt;attention_1_4 -->
<g id="edge108" class="edge">
<title>k_proj_1_4&#45;&gt;attention_1_4</title>
<path fill="none" stroke="black" d="M7073,-2371.33C7073,-2363.63 7073,-2354.47 7073,-2345.92"/>
<polygon fill="black" stroke="black" points="7076.5,-2345.91 7073,-2335.91 7069.5,-2345.91 7076.5,-2345.91"/>
</g>
<!-- v_proj_1_4&#45;&gt;attention_1_4 -->
<g id="edge109" class="edge">
<title>v_proj_1_4&#45;&gt;attention_1_4</title>
<path fill="none" stroke="black" d="M7164.21,-2371.33C7148.61,-2362.12 7129.48,-2350.83 7112.77,-2340.97"/>
<polygon fill="black" stroke="black" points="7114.17,-2337.73 7103.78,-2335.66 7110.61,-2343.76 7114.17,-2337.73"/>
</g>
<!-- o_proj_1_4 -->
<g id="node75" class="node">
<title>o_proj_1_4</title>
<polygon fill="lightblue" stroke="black" points="7125.5,-2261.5 7020.5,-2261.5 7020.5,-2223.5 7125.5,-2223.5 7125.5,-2261.5"/>
<text text-anchor="middle" x="7073" y="-2246.3" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="7073" y="-2231.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- attention_1_4&#45;&gt;o_proj_1_4 -->
<g id="edge110" class="edge">
<title>attention_1_4&#45;&gt;o_proj_1_4</title>
<path fill="none" stroke="black" d="M7073,-2297.33C7073,-2289.63 7073,-2280.47 7073,-2271.92"/>
<polygon fill="black" stroke="black" points="7076.5,-2271.91 7073,-2261.91 7069.5,-2271.91 7076.5,-2271.91"/>
</g>
<!-- o_proj_1_4&#45;&gt;all_reduce_1 -->
<g id="edge136" class="edge">
<title>o_proj_1_4&#45;&gt;all_reduce_1</title>
<path fill="none" stroke="black" d="M7073,-2223.08C7073,-2215.69 7073,-2206.79 7073,-2197.8"/>
<polygon fill="black" stroke="black" points="7076.5,-2197.68 7073,-2187.69 7069.5,-2197.69 7076.5,-2197.68"/>
</g>
<!-- attention_1_5 -->
<g id="node79" class="node">
<title>attention_1_5</title>
<path fill="gold" stroke="black" d="M7401,-2335.5C7401,-2335.5 7359,-2335.5 7359,-2335.5 7353,-2335.5 7347,-2329.5 7347,-2323.5 7347,-2323.5 7347,-2309.5 7347,-2309.5 7347,-2303.5 7353,-2297.5 7359,-2297.5 7359,-2297.5 7401,-2297.5 7401,-2297.5 7407,-2297.5 7413,-2303.5 7413,-2309.5 7413,-2309.5 7413,-2323.5 7413,-2323.5 7413,-2329.5 7407,-2335.5 7401,-2335.5"/>
<text text-anchor="middle" x="7380" y="-2320.3" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="7380" y="-2305.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- q_proj_1_5&#45;&gt;attention_1_5 -->
<g id="edge114" class="edge">
<title>q_proj_1_5&#45;&gt;attention_1_5</title>
<path fill="none" stroke="black" d="M7333.65,-2371.33C7340.86,-2362.95 7349.56,-2352.85 7357.46,-2343.67"/>
<polygon fill="black" stroke="black" points="7360.27,-2345.77 7364.14,-2335.91 7354.97,-2341.21 7360.27,-2345.77"/>
</g>
<!-- k_proj_1_5&#45;&gt;attention_1_5 -->
<g id="edge115" class="edge">
<title>k_proj_1_5&#45;&gt;attention_1_5</title>
<path fill="none" stroke="black" d="M7425.61,-2371.33C7418.51,-2362.95 7409.95,-2352.85 7402.18,-2343.67"/>
<polygon fill="black" stroke="black" points="7404.73,-2341.28 7395.6,-2335.91 7399.39,-2345.81 7404.73,-2341.28"/>
</g>
<!-- v_proj_1_5&#45;&gt;attention_1_5 -->
<g id="edge116" class="edge">
<title>v_proj_1_5&#45;&gt;attention_1_5</title>
<path fill="none" stroke="black" d="M7516.82,-2371.33C7487.93,-2359.97 7450.98,-2345.43 7422.76,-2334.32"/>
<polygon fill="black" stroke="black" points="7423.76,-2330.96 7413.17,-2330.55 7421.2,-2337.47 7423.76,-2330.96"/>
</g>
<!-- o_proj_1_5 -->
<g id="node80" class="node">
<title>o_proj_1_5</title>
<polygon fill="lightblue" stroke="black" points="7370.5,-2261.5 7265.5,-2261.5 7265.5,-2223.5 7370.5,-2223.5 7370.5,-2261.5"/>
<text text-anchor="middle" x="7318" y="-2246.3" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="7318" y="-2231.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- attention_1_5&#45;&gt;o_proj_1_5 -->
<g id="edge117" class="edge">
<title>attention_1_5&#45;&gt;o_proj_1_5</title>
<path fill="none" stroke="black" d="M7364.35,-2297.33C7357.14,-2288.95 7348.44,-2278.85 7340.54,-2269.67"/>
<polygon fill="black" stroke="black" points="7343.03,-2267.21 7333.86,-2261.91 7337.73,-2271.77 7343.03,-2267.21"/>
</g>
<!-- o_proj_1_5&#45;&gt;all_reduce_1 -->
<g id="edge137" class="edge">
<title>o_proj_1_5&#45;&gt;all_reduce_1</title>
<path fill="none" stroke="black" d="M7269.3,-2223.41C7244.26,-2214.11 7212.66,-2202.37 7182.18,-2191.05"/>
<polygon fill="black" stroke="black" points="7183.35,-2187.75 7172.76,-2187.55 7180.92,-2194.32 7183.35,-2187.75"/>
</g>
<!-- attention_1_6 -->
<g id="node84" class="node">
<title>attention_1_6</title>
<path fill="gold" stroke="black" d="M7768,-2335.5C7768,-2335.5 7726,-2335.5 7726,-2335.5 7720,-2335.5 7714,-2329.5 7714,-2323.5 7714,-2323.5 7714,-2309.5 7714,-2309.5 7714,-2303.5 7720,-2297.5 7726,-2297.5 7726,-2297.5 7768,-2297.5 7768,-2297.5 7774,-2297.5 7780,-2303.5 7780,-2309.5 7780,-2309.5 7780,-2323.5 7780,-2323.5 7780,-2329.5 7774,-2335.5 7768,-2335.5"/>
<text text-anchor="middle" x="7747" y="-2320.3" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="7747" y="-2305.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- q_proj_1_6&#45;&gt;attention_1_6 -->
<g id="edge121" class="edge">
<title>q_proj_1_6&#45;&gt;attention_1_6</title>
<path fill="none" stroke="black" d="M7701.39,-2371.33C7708.49,-2362.95 7717.05,-2352.85 7724.82,-2343.67"/>
<polygon fill="black" stroke="black" points="7727.61,-2345.81 7731.4,-2335.91 7722.27,-2341.28 7727.61,-2345.81"/>
</g>
<!-- k_proj_1_6&#45;&gt;attention_1_6 -->
<g id="edge122" class="edge">
<title>k_proj_1_6&#45;&gt;attention_1_6</title>
<path fill="none" stroke="black" d="M7793.35,-2371.33C7786.14,-2362.95 7777.44,-2352.85 7769.54,-2343.67"/>
<polygon fill="black" stroke="black" points="7772.03,-2341.21 7762.86,-2335.91 7766.73,-2345.77 7772.03,-2341.21"/>
</g>
<!-- v_proj_1_6&#45;&gt;attention_1_6 -->
<g id="edge123" class="edge">
<title>v_proj_1_6&#45;&gt;attention_1_6</title>
<path fill="none" stroke="black" d="M7884.57,-2371.33C7855.43,-2359.93 7818.13,-2345.33 7789.72,-2334.22"/>
<polygon fill="black" stroke="black" points="7790.66,-2330.82 7780.07,-2330.44 7788.11,-2337.34 7790.66,-2330.82"/>
</g>
<!-- o_proj_1_6 -->
<g id="node85" class="node">
<title>o_proj_1_6</title>
<polygon fill="lightblue" stroke="black" points="7677.5,-2261.5 7572.5,-2261.5 7572.5,-2223.5 7677.5,-2223.5 7677.5,-2261.5"/>
<text text-anchor="middle" x="7625" y="-2246.3" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="7625" y="-2231.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- attention_1_6&#45;&gt;o_proj_1_6 -->
<g id="edge124" class="edge">
<title>attention_1_6&#45;&gt;o_proj_1_6</title>
<path fill="none" stroke="black" d="M7716.21,-2297.33C7700.61,-2288.12 7681.48,-2276.83 7664.77,-2266.97"/>
<polygon fill="black" stroke="black" points="7666.17,-2263.73 7655.78,-2261.66 7662.61,-2269.76 7666.17,-2263.73"/>
</g>
<!-- o_proj_1_6&#45;&gt;all_reduce_1 -->
<g id="edge138" class="edge">
<title>o_proj_1_6&#45;&gt;all_reduce_1</title>
<path fill="none" stroke="black" d="M7572.07,-2232.77C7492.49,-2219.66 7339.01,-2194.35 7223.17,-2175.26"/>
<polygon fill="black" stroke="black" points="7223.57,-2171.78 7213.14,-2173.6 7222.44,-2178.68 7223.57,-2171.78"/>
</g>
<!-- attention_1_7 -->
<g id="node89" class="node">
<title>attention_1_7</title>
<path fill="gold" stroke="black" d="M8137,-2335.5C8137,-2335.5 8095,-2335.5 8095,-2335.5 8089,-2335.5 8083,-2329.5 8083,-2323.5 8083,-2323.5 8083,-2309.5 8083,-2309.5 8083,-2303.5 8089,-2297.5 8095,-2297.5 8095,-2297.5 8137,-2297.5 8137,-2297.5 8143,-2297.5 8149,-2303.5 8149,-2309.5 8149,-2309.5 8149,-2323.5 8149,-2323.5 8149,-2329.5 8143,-2335.5 8137,-2335.5"/>
<text text-anchor="middle" x="8116" y="-2320.3" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="8116" y="-2305.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- q_proj_1_7&#45;&gt;attention_1_7 -->
<g id="edge128" class="edge">
<title>q_proj_1_7&#45;&gt;attention_1_7</title>
<path fill="none" stroke="black" d="M8069.65,-2371.33C8076.86,-2362.95 8085.56,-2352.85 8093.46,-2343.67"/>
<polygon fill="black" stroke="black" points="8096.27,-2345.77 8100.14,-2335.91 8090.97,-2341.21 8096.27,-2345.77"/>
</g>
<!-- k_proj_1_7&#45;&gt;attention_1_7 -->
<g id="edge129" class="edge">
<title>k_proj_1_7&#45;&gt;attention_1_7</title>
<path fill="none" stroke="black" d="M8161.61,-2371.33C8154.51,-2362.95 8145.95,-2352.85 8138.18,-2343.67"/>
<polygon fill="black" stroke="black" points="8140.73,-2341.28 8131.6,-2335.91 8135.39,-2345.81 8140.73,-2341.28"/>
</g>
<!-- v_proj_1_7&#45;&gt;attention_1_7 -->
<g id="edge130" class="edge">
<title>v_proj_1_7&#45;&gt;attention_1_7</title>
<path fill="none" stroke="black" d="M8252.82,-2371.33C8223.93,-2359.97 8186.98,-2345.43 8158.76,-2334.32"/>
<polygon fill="black" stroke="black" points="8159.76,-2330.96 8149.17,-2330.55 8157.2,-2337.47 8159.76,-2330.96"/>
</g>
<!-- o_proj_1_7 -->
<g id="node90" class="node">
<title>o_proj_1_7</title>
<polygon fill="lightblue" stroke="black" points="7984.5,-2261.5 7879.5,-2261.5 7879.5,-2223.5 7984.5,-2223.5 7984.5,-2261.5"/>
<text text-anchor="middle" x="7932" y="-2246.3" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="7932" y="-2231.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- attention_1_7&#45;&gt;o_proj_1_7 -->
<g id="edge131" class="edge">
<title>attention_1_7&#45;&gt;o_proj_1_7</title>
<path fill="none" stroke="black" d="M8082.68,-2302.46C8056.21,-2292.1 8018.63,-2277.4 7987.61,-2265.26"/>
<polygon fill="black" stroke="black" points="7988.81,-2261.97 7978.22,-2261.59 7986.26,-2268.49 7988.81,-2261.97"/>
</g>
<!-- o_proj_1_7&#45;&gt;all_reduce_1 -->
<g id="edge139" class="edge">
<title>o_proj_1_7&#45;&gt;all_reduce_1</title>
<path fill="none" stroke="black" d="M7879.24,-2235.91C7749.27,-2222.14 7410.15,-2186.22 7215.64,-2165.61"/>
<polygon fill="black" stroke="black" points="7215.94,-2162.12 7205.63,-2164.55 7215.2,-2169.08 7215.94,-2162.12"/>
</g>
<!-- all_reduce_1&#45;&gt;add_2 -->
<g id="edge140" class="edge">
<title>all_reduce_1&#45;&gt;add_2</title>
<path fill="none" stroke="black" d="M7180.37,-2133.42C7308.81,-2115.38 7521.07,-2085.58 7637.75,-2069.19"/>
<polygon fill="black" stroke="black" points="7638.29,-2072.65 7647.71,-2067.79 7637.32,-2065.72 7638.29,-2072.65"/>
</g>
<!-- mlp1_gate -->
<g id="node93" class="node">
<title>mlp1_gate</title>
<polygon fill="lightpink" stroke="black" points="7630,-2001.5 7484,-2001.5 7484,-1963.5 7630,-1963.5 7630,-2001.5"/>
<text text-anchor="middle" x="7557" y="-1986.3" font-family="Times,serif" font-size="14.00">MLP Gate</text>
<text text-anchor="middle" x="7557" y="-1971.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- add_2&#45;&gt;mlp1_gate -->
<g id="edge142" class="edge">
<title>add_2&#45;&gt;mlp1_gate</title>
<path fill="none" stroke="black" d="M7679.62,-2037.33C7657.68,-2027.7 7630.56,-2015.79 7607.41,-2005.63"/>
<polygon fill="black" stroke="black" points="7608.65,-2002.35 7598.09,-2001.54 7605.84,-2008.76 7608.65,-2002.35"/>
</g>
<!-- mlp1_up -->
<g id="node94" class="node">
<title>mlp1_up</title>
<polygon fill="lightpink" stroke="black" points="7794,-2001.5 7648,-2001.5 7648,-1963.5 7794,-1963.5 7794,-2001.5"/>
<text text-anchor="middle" x="7721" y="-1986.3" font-family="Times,serif" font-size="14.00">MLP Up</text>
<text text-anchor="middle" x="7721" y="-1971.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- add_2&#45;&gt;mlp1_up -->
<g id="edge143" class="edge">
<title>add_2&#45;&gt;mlp1_up</title>
<path fill="none" stroke="black" d="M7721,-2037.33C7721,-2029.63 7721,-2020.47 7721,-2011.92"/>
<polygon fill="black" stroke="black" points="7724.5,-2011.91 7721,-2001.91 7717.5,-2011.91 7724.5,-2011.91"/>
</g>
<!-- add_3 -->
<g id="node96" class="node">
<title>add_3</title>
<polygon fill="lightgray" stroke="black" points="7840,-1853.5 7694,-1853.5 7694,-1815.5 7840,-1815.5 7840,-1853.5"/>
<text text-anchor="middle" x="7767" y="-1838.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7767" y="-1823.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- add_2&#45;&gt;add_3 -->
<g id="edge147" class="edge">
<title>add_2&#45;&gt;add_3</title>
<path fill="none" stroke="black" d="M7764.93,-2037.25C7779.77,-2028.72 7794.67,-2016.96 7803,-2001.5 7826.61,-1957.68 7817.42,-1937.14 7803,-1889.5 7800.04,-1879.74 7794.67,-1870.12 7788.97,-1861.78"/>
<polygon fill="black" stroke="black" points="7791.71,-1859.6 7782.99,-1853.58 7786.06,-1863.72 7791.71,-1859.6"/>
</g>
<!-- mlp1_down -->
<g id="node95" class="node">
<title>mlp1_down</title>
<polygon fill="lightpink" stroke="black" points="7794,-1927.5 7648,-1927.5 7648,-1889.5 7794,-1889.5 7794,-1927.5"/>
<text text-anchor="middle" x="7721" y="-1912.3" font-family="Times,serif" font-size="14.00">MLP Down</text>
<text text-anchor="middle" x="7721" y="-1897.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs 0&#45;7</text>
</g>
<!-- mlp1_gate&#45;&gt;mlp1_down -->
<g id="edge144" class="edge">
<title>mlp1_gate&#45;&gt;mlp1_down</title>
<path fill="none" stroke="black" d="M7598.38,-1963.33C7620.32,-1953.7 7647.44,-1941.79 7670.59,-1931.63"/>
<polygon fill="black" stroke="black" points="7672.16,-1934.76 7679.91,-1927.54 7669.35,-1928.35 7672.16,-1934.76"/>
</g>
<!-- mlp1_up&#45;&gt;mlp1_down -->
<g id="edge145" class="edge">
<title>mlp1_up&#45;&gt;mlp1_down</title>
<path fill="none" stroke="black" d="M7721,-1963.33C7721,-1955.63 7721,-1946.47 7721,-1937.92"/>
<polygon fill="black" stroke="black" points="7724.5,-1937.91 7721,-1927.91 7717.5,-1937.91 7724.5,-1937.91"/>
</g>
<!-- mlp1_down&#45;&gt;add_3 -->
<g id="edge146" class="edge">
<title>mlp1_down&#45;&gt;add_3</title>
<path fill="none" stroke="black" d="M7732.61,-1889.33C7737.8,-1881.21 7744.02,-1871.46 7749.74,-1862.51"/>
<polygon fill="black" stroke="black" points="7752.8,-1864.22 7755.24,-1853.91 7746.9,-1860.46 7752.8,-1864.22"/>
</g>
<!-- send_stage0 -->
<g id="node97" class="node">
<title>send_stage0</title>
<ellipse fill="lightsteelblue" stroke="black" cx="7767" cy="-1731.42" rx="269.32" ry="48.17"/>
<text text-anchor="middle" x="7767" y="-1750.22" font-family="Times,serif" font-size="14.00">Send to Stage 1</text>
<text text-anchor="middle" x="7767" y="-1735.22" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="7767" y="-1720.22" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="7767" y="-1705.22" font-family="Times,serif" font-size="14.00">GPU: 7â†’8</text>
</g>
<!-- add_3&#45;&gt;send_stage0 -->
<g id="edge148" class="edge">
<title>add_3&#45;&gt;send_stage0</title>
<path fill="none" stroke="black" d="M7767,-1815.43C7767,-1808.09 7767,-1799.16 7767,-1789.92"/>
<polygon fill="black" stroke="black" points="7770.5,-1789.83 7767,-1779.83 7763.5,-1789.83 7770.5,-1789.83"/>
</g>
<!-- recv_stage1 -->
<g id="node98" class="node">
<title>recv_stage1</title>
<ellipse fill="lightsteelblue" stroke="black" cx="7767" cy="-1588.25" rx="269.32" ry="48.17"/>
<text text-anchor="middle" x="7767" y="-1607.05" font-family="Times,serif" font-size="14.00">Receive from Stage 0</text>
<text text-anchor="middle" x="7767" y="-1592.05" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="7767" y="-1577.05" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="7767" y="-1562.05" font-family="Times,serif" font-size="14.00">GPU: 7â†’8</text>
</g>
<!-- send_stage0&#45;&gt;recv_stage1 -->
<g id="edge149" class="edge">
<title>send_stage0&#45;&gt;recv_stage1</title>
<path fill="none" stroke="black" d="M7767,-1683.02C7767,-1671.49 7767,-1659.04 7767,-1647.1"/>
<polygon fill="black" stroke="black" points="7770.5,-1646.76 7767,-1636.76 7763.5,-1646.76 7770.5,-1646.76"/>
</g>
<!-- ln2_pre -->
<g id="node99" class="node">
<title>ln2_pre</title>
<polygon fill="lightcoral" stroke="black" points="7395.5,-1504.17 7228.5,-1504.17 7228.5,-1466.17 7395.5,-1466.17 7395.5,-1504.17"/>
<text text-anchor="middle" x="7312" y="-1488.97" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 2)</text>
<text text-anchor="middle" x="7312" y="-1473.97" font-family="Times,serif" font-size="14.00">GPU: all GPUs 8&#45;15</text>
</g>
<!-- recv_stage1&#45;&gt;ln2_pre -->
<g id="edge150" class="edge">
<title>recv_stage1&#45;&gt;ln2_pre</title>
<path fill="none" stroke="black" d="M7600.8,-1550.33C7534.11,-1535.51 7459.82,-1519.01 7403.28,-1506.45"/>
<polygon fill="black" stroke="black" points="7403.82,-1502.98 7393.3,-1504.23 7402.3,-1509.81 7403.82,-1502.98"/>
</g>
<!-- add_4 -->
<g id="node141" class="node">
<title>add_4</title>
<polygon fill="lightgray" stroke="black" points="7480.5,-1096.17 7325.5,-1096.17 7325.5,-1058.17 7480.5,-1058.17 7480.5,-1096.17"/>
<text text-anchor="middle" x="7403" y="-1080.97" font-family="Times,serif" font-size="14.00">Residual Add L2</text>
<text text-anchor="middle" x="7403" y="-1065.97" font-family="Times,serif" font-size="14.00">GPU: all GPUs 8&#45;15</text>
</g>
<!-- recv_stage1&#45;&gt;add_4 -->
<g id="edge216" class="edge">
<title>recv_stage1&#45;&gt;add_4</title>
<path fill="none" stroke="black" d="M8023.02,-1573.19C8231.33,-1554.49 8491,-1511.3 8491,-1412.17 8491,-1412.17 8491,-1412.17 8491,-1262.17 8491,-1160.97 7749.76,-1101.47 7490.92,-1083.78"/>
<polygon fill="black" stroke="black" points="7491.02,-1080.28 7480.81,-1083.09 7490.55,-1087.26 7491.02,-1080.28"/>
</g>
<!-- q_proj_2_0 -->
<g id="node100" class="node">
<title>q_proj_2_0</title>
<polygon fill="lightblue" stroke="black" points="6134,-1430.17 6050,-1430.17 6050,-1392.17 6134,-1392.17 6134,-1430.17"/>
<text text-anchor="middle" x="6092" y="-1414.97" font-family="Times,serif" font-size="14.00">Q Proj L2</text>
<text text-anchor="middle" x="6092" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ln2_pre&#45;&gt;q_proj_2_0 -->
<g id="edge151" class="edge">
<title>ln2_pre&#45;&gt;q_proj_2_0</title>
<path fill="none" stroke="black" d="M7228.17,-1483.41C6996.67,-1480.81 6351.95,-1470.1 6144,-1430.17 6143.9,-1430.15 6143.79,-1430.13 6143.69,-1430.11"/>
<polygon fill="black" stroke="black" points="6144.54,-1426.71 6134.01,-1427.84 6142.95,-1433.53 6144.54,-1426.71"/>
</g>
<!-- k_proj_2_0 -->
<g id="node101" class="node">
<title>k_proj_2_0</title>
<polygon fill="lightblue" stroke="black" points="6235.5,-1430.17 6152.5,-1430.17 6152.5,-1392.17 6235.5,-1392.17 6235.5,-1430.17"/>
<text text-anchor="middle" x="6194" y="-1414.97" font-family="Times,serif" font-size="14.00">K Proj L2</text>
<text text-anchor="middle" x="6194" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ln2_pre&#45;&gt;k_proj_2_0 -->
<g id="edge152" class="edge">
<title>ln2_pre&#45;&gt;k_proj_2_0</title>
<path fill="none" stroke="black" d="M7228.43,-1483.04C7014.83,-1479.69 6451.87,-1467.65 6245.88,-1429.91"/>
<polygon fill="black" stroke="black" points="6246.24,-1426.42 6235.76,-1427.98 6244.92,-1433.29 6246.24,-1426.42"/>
</g>
<!-- v_proj_2_0 -->
<g id="node102" class="node">
<title>v_proj_2_0</title>
<polygon fill="lightblue" stroke="black" points="6336.5,-1430.17 6253.5,-1430.17 6253.5,-1392.17 6336.5,-1392.17 6336.5,-1430.17"/>
<text text-anchor="middle" x="6295" y="-1414.97" font-family="Times,serif" font-size="14.00">V Proj L2</text>
<text text-anchor="middle" x="6295" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ln2_pre&#45;&gt;v_proj_2_0 -->
<g id="edge153" class="edge">
<title>ln2_pre&#45;&gt;v_proj_2_0</title>
<path fill="none" stroke="black" d="M7228.3,-1482.53C7029.44,-1478.15 6532.09,-1464.25 6346.67,-1429.88"/>
<polygon fill="black" stroke="black" points="6347.24,-1426.42 6336.76,-1427.96 6345.91,-1433.3 6347.24,-1426.42"/>
</g>
<!-- q_proj_2_1 -->
<g id="node105" class="node">
<title>q_proj_2_1</title>
<polygon fill="lightblue" stroke="black" points="6439,-1430.17 6355,-1430.17 6355,-1392.17 6439,-1392.17 6439,-1430.17"/>
<text text-anchor="middle" x="6397" y="-1414.97" font-family="Times,serif" font-size="14.00">Q Proj L2</text>
<text text-anchor="middle" x="6397" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ln2_pre&#45;&gt;q_proj_2_1 -->
<g id="edge159" class="edge">
<title>ln2_pre&#45;&gt;q_proj_2_1</title>
<path fill="none" stroke="black" d="M7228.36,-1481.81C7041.79,-1476.1 6596.47,-1459.73 6449,-1430.17 6448.9,-1430.15 6448.8,-1430.13 6448.69,-1430.1"/>
<polygon fill="black" stroke="black" points="6449.56,-1426.71 6439.02,-1427.78 6447.93,-1433.52 6449.56,-1426.71"/>
</g>
<!-- k_proj_2_1 -->
<g id="node106" class="node">
<title>k_proj_2_1</title>
<polygon fill="lightblue" stroke="black" points="6540.5,-1430.17 6457.5,-1430.17 6457.5,-1392.17 6540.5,-1392.17 6540.5,-1430.17"/>
<text text-anchor="middle" x="6499" y="-1414.97" font-family="Times,serif" font-size="14.00">K Proj L2</text>
<text text-anchor="middle" x="6499" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ln2_pre&#45;&gt;k_proj_2_1 -->
<g id="edge160" class="edge">
<title>ln2_pre&#45;&gt;k_proj_2_1</title>
<path fill="none" stroke="black" d="M7228.32,-1481.07C7062.24,-1474.47 6695.3,-1457.51 6550.79,-1429.92"/>
<polygon fill="black" stroke="black" points="6551.26,-1426.44 6540.77,-1427.91 6549.89,-1433.31 6551.26,-1426.44"/>
</g>
<!-- v_proj_2_1 -->
<g id="node107" class="node">
<title>v_proj_2_1</title>
<polygon fill="lightblue" stroke="black" points="6641.5,-1430.17 6558.5,-1430.17 6558.5,-1392.17 6641.5,-1392.17 6641.5,-1430.17"/>
<text text-anchor="middle" x="6600" y="-1414.97" font-family="Times,serif" font-size="14.00">V Proj L2</text>
<text text-anchor="middle" x="6600" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ln2_pre&#45;&gt;v_proj_2_1 -->
<g id="edge161" class="edge">
<title>ln2_pre&#45;&gt;v_proj_2_1</title>
<path fill="none" stroke="black" d="M7228.3,-1484.19C7103.84,-1482.72 6862.91,-1474.06 6651.81,-1430"/>
<polygon fill="black" stroke="black" points="6652.29,-1426.52 6641.78,-1427.87 6650.84,-1433.37 6652.29,-1426.52"/>
</g>
<!-- q_proj_2_2 -->
<g id="node110" class="node">
<title>q_proj_2_2</title>
<polygon fill="lightblue" stroke="black" points="6744,-1430.17 6660,-1430.17 6660,-1392.17 6744,-1392.17 6744,-1430.17"/>
<text text-anchor="middle" x="6702" y="-1414.97" font-family="Times,serif" font-size="14.00">Q Proj L2</text>
<text text-anchor="middle" x="6702" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ln2_pre&#45;&gt;q_proj_2_2 -->
<g id="edge167" class="edge">
<title>ln2_pre&#45;&gt;q_proj_2_2</title>
<path fill="none" stroke="black" d="M7228.33,-1482.23C7118.35,-1478.28 6919.69,-1466.33 6754,-1430.17 6753.9,-1430.14 6753.8,-1430.12 6753.69,-1430.1"/>
<polygon fill="black" stroke="black" points="6754.6,-1426.72 6744.05,-1427.66 6752.88,-1433.5 6754.6,-1426.72"/>
</g>
<!-- k_proj_2_2 -->
<g id="node111" class="node">
<title>k_proj_2_2</title>
<polygon fill="lightblue" stroke="black" points="6845.5,-1430.17 6762.5,-1430.17 6762.5,-1392.17 6845.5,-1392.17 6845.5,-1430.17"/>
<text text-anchor="middle" x="6804" y="-1414.97" font-family="Times,serif" font-size="14.00">K Proj L2</text>
<text text-anchor="middle" x="6804" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ln2_pre&#45;&gt;k_proj_2_2 -->
<g id="edge168" class="edge">
<title>ln2_pre&#45;&gt;k_proj_2_2</title>
<path fill="none" stroke="black" d="M7228.49,-1479.86C7138.38,-1473.97 6990.82,-1460.69 6855.65,-1430"/>
<polygon fill="black" stroke="black" points="6856.06,-1426.51 6845.53,-1427.67 6854.48,-1433.33 6856.06,-1426.51"/>
</g>
<!-- v_proj_2_2 -->
<g id="node112" class="node">
<title>v_proj_2_2</title>
<polygon fill="lightblue" stroke="black" points="6946.5,-1430.17 6863.5,-1430.17 6863.5,-1392.17 6946.5,-1392.17 6946.5,-1430.17"/>
<text text-anchor="middle" x="6905" y="-1414.97" font-family="Times,serif" font-size="14.00">V Proj L2</text>
<text text-anchor="middle" x="6905" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ln2_pre&#45;&gt;v_proj_2_2 -->
<g id="edge169" class="edge">
<title>ln2_pre&#45;&gt;v_proj_2_2</title>
<path fill="none" stroke="black" d="M7228.4,-1476C7158.03,-1468.09 7054.79,-1454.07 6956.37,-1429.99"/>
<polygon fill="black" stroke="black" points="6957.1,-1426.57 6946.55,-1427.55 6955.41,-1433.36 6957.1,-1426.57"/>
</g>
<!-- q_proj_2_3 -->
<g id="node115" class="node">
<title>q_proj_2_3</title>
<polygon fill="lightblue" stroke="black" points="7049,-1430.17 6965,-1430.17 6965,-1392.17 7049,-1392.17 7049,-1430.17"/>
<text text-anchor="middle" x="7007" y="-1414.97" font-family="Times,serif" font-size="14.00">Q Proj L2</text>
<text text-anchor="middle" x="7007" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ln2_pre&#45;&gt;q_proj_2_3 -->
<g id="edge175" class="edge">
<title>ln2_pre&#45;&gt;q_proj_2_3</title>
<path fill="none" stroke="black" d="M7228.48,-1469.02C7178.86,-1459.36 7114.92,-1445.75 7059,-1430.17 7058.9,-1430.14 7058.8,-1430.11 7058.7,-1430.08"/>
<polygon fill="black" stroke="black" points="7059.73,-1426.74 7049.15,-1427.24 7057.74,-1433.45 7059.73,-1426.74"/>
</g>
<!-- k_proj_2_3 -->
<g id="node116" class="node">
<title>k_proj_2_3</title>
<polygon fill="lightblue" stroke="black" points="7150.5,-1430.17 7067.5,-1430.17 7067.5,-1392.17 7150.5,-1392.17 7150.5,-1430.17"/>
<text text-anchor="middle" x="7109" y="-1414.97" font-family="Times,serif" font-size="14.00">K Proj L2</text>
<text text-anchor="middle" x="7109" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ln2_pre&#45;&gt;k_proj_2_3 -->
<g id="edge176" class="edge">
<title>ln2_pre&#45;&gt;k_proj_2_3</title>
<path fill="none" stroke="black" d="M7261.04,-1466.09C7230.3,-1455.19 7191.27,-1441.35 7160.45,-1430.41"/>
<polygon fill="black" stroke="black" points="7161.35,-1427.02 7150.75,-1426.98 7159.01,-1433.62 7161.35,-1427.02"/>
</g>
<!-- v_proj_2_3 -->
<g id="node117" class="node">
<title>v_proj_2_3</title>
<polygon fill="lightblue" stroke="black" points="7251.5,-1430.17 7168.5,-1430.17 7168.5,-1392.17 7251.5,-1392.17 7251.5,-1430.17"/>
<text text-anchor="middle" x="7210" y="-1414.97" font-family="Times,serif" font-size="14.00">V Proj L2</text>
<text text-anchor="middle" x="7210" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ln2_pre&#45;&gt;v_proj_2_3 -->
<g id="edge177" class="edge">
<title>ln2_pre&#45;&gt;v_proj_2_3</title>
<path fill="none" stroke="black" d="M7286.26,-1466C7273.46,-1456.96 7257.81,-1445.91 7244.03,-1436.19"/>
<polygon fill="black" stroke="black" points="7245.92,-1433.24 7235.73,-1430.33 7241.88,-1438.96 7245.92,-1433.24"/>
</g>
<!-- q_proj_2_4 -->
<g id="node120" class="node">
<title>q_proj_2_4</title>
<polygon fill="lightblue" stroke="black" points="7354,-1430.17 7270,-1430.17 7270,-1392.17 7354,-1392.17 7354,-1430.17"/>
<text text-anchor="middle" x="7312" y="-1414.97" font-family="Times,serif" font-size="14.00">Q Proj L2</text>
<text text-anchor="middle" x="7312" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ln2_pre&#45;&gt;q_proj_2_4 -->
<g id="edge183" class="edge">
<title>ln2_pre&#45;&gt;q_proj_2_4</title>
<path fill="none" stroke="black" d="M7312,-1466C7312,-1458.3 7312,-1449.14 7312,-1440.58"/>
<polygon fill="black" stroke="black" points="7315.5,-1440.58 7312,-1430.58 7308.5,-1440.58 7315.5,-1440.58"/>
</g>
<!-- k_proj_2_4 -->
<g id="node121" class="node">
<title>k_proj_2_4</title>
<polygon fill="lightblue" stroke="black" points="7455.5,-1430.17 7372.5,-1430.17 7372.5,-1392.17 7455.5,-1392.17 7455.5,-1430.17"/>
<text text-anchor="middle" x="7414" y="-1414.97" font-family="Times,serif" font-size="14.00">K Proj L2</text>
<text text-anchor="middle" x="7414" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ln2_pre&#45;&gt;k_proj_2_4 -->
<g id="edge184" class="edge">
<title>ln2_pre&#45;&gt;k_proj_2_4</title>
<path fill="none" stroke="black" d="M7337.74,-1466C7350.54,-1456.96 7366.19,-1445.91 7379.97,-1436.19"/>
<polygon fill="black" stroke="black" points="7382.12,-1438.96 7388.27,-1430.33 7378.08,-1433.24 7382.12,-1438.96"/>
</g>
<!-- v_proj_2_4 -->
<g id="node122" class="node">
<title>v_proj_2_4</title>
<polygon fill="lightblue" stroke="black" points="7556.5,-1430.17 7473.5,-1430.17 7473.5,-1392.17 7556.5,-1392.17 7556.5,-1430.17"/>
<text text-anchor="middle" x="7515" y="-1414.97" font-family="Times,serif" font-size="14.00">V Proj L2</text>
<text text-anchor="middle" x="7515" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ln2_pre&#45;&gt;v_proj_2_4 -->
<g id="edge185" class="edge">
<title>ln2_pre&#45;&gt;v_proj_2_4</title>
<path fill="none" stroke="black" d="M7363.38,-1466.12C7390.77,-1456.48 7425.27,-1444.31 7463.47,-1430.7"/>
<polygon fill="black" stroke="black" points="7465.02,-1433.87 7473.27,-1427.21 7462.67,-1427.27 7465.02,-1433.87"/>
</g>
<!-- q_proj_2_5 -->
<g id="node125" class="node">
<title>q_proj_2_5</title>
<polygon fill="lightblue" stroke="black" points="7659,-1430.17 7575,-1430.17 7575,-1392.17 7659,-1392.17 7659,-1430.17"/>
<text text-anchor="middle" x="7617" y="-1414.97" font-family="Times,serif" font-size="14.00">Q Proj L2</text>
<text text-anchor="middle" x="7617" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ln2_pre&#45;&gt;q_proj_2_5 -->
<g id="edge191" class="edge">
<title>ln2_pre&#45;&gt;q_proj_2_5</title>
<path fill="none" stroke="black" d="M7395.6,-1469.23C7442.93,-1460.11 7503.3,-1447.36 7564.93,-1430.3"/>
<polygon fill="black" stroke="black" points="7566.15,-1433.59 7574.83,-1427.52 7564.26,-1426.85 7566.15,-1433.59"/>
</g>
<!-- k_proj_2_5 -->
<g id="node126" class="node">
<title>k_proj_2_5</title>
<polygon fill="lightblue" stroke="black" points="7760.5,-1430.17 7677.5,-1430.17 7677.5,-1392.17 7760.5,-1392.17 7760.5,-1430.17"/>
<text text-anchor="middle" x="7719" y="-1414.97" font-family="Times,serif" font-size="14.00">K Proj L2</text>
<text text-anchor="middle" x="7719" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ln2_pre&#45;&gt;k_proj_2_5 -->
<g id="edge192" class="edge">
<title>ln2_pre&#45;&gt;k_proj_2_5</title>
<path fill="none" stroke="black" d="M7395.6,-1476C7465.97,-1468.09 7569.21,-1454.07 7667.63,-1429.99"/>
<polygon fill="black" stroke="black" points="7668.59,-1433.36 7677.45,-1427.55 7666.9,-1426.57 7668.59,-1433.36"/>
</g>
<!-- v_proj_2_5 -->
<g id="node127" class="node">
<title>v_proj_2_5</title>
<polygon fill="lightblue" stroke="black" points="7861.5,-1430.17 7778.5,-1430.17 7778.5,-1392.17 7861.5,-1392.17 7861.5,-1430.17"/>
<text text-anchor="middle" x="7820" y="-1414.97" font-family="Times,serif" font-size="14.00">V Proj L2</text>
<text text-anchor="middle" x="7820" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ln2_pre&#45;&gt;v_proj_2_5 -->
<g id="edge193" class="edge">
<title>ln2_pre&#45;&gt;v_proj_2_5</title>
<path fill="none" stroke="black" d="M7395.73,-1480.04C7486.06,-1474.29 7633.98,-1461.13 7768.41,-1430.27"/>
<polygon fill="black" stroke="black" points="7769.53,-1433.6 7778.47,-1427.92 7767.94,-1426.78 7769.53,-1433.6"/>
</g>
<!-- q_proj_2_6 -->
<g id="node130" class="node">
<title>q_proj_2_6</title>
<polygon fill="lightblue" stroke="black" points="7964,-1430.17 7880,-1430.17 7880,-1392.17 7964,-1392.17 7964,-1430.17"/>
<text text-anchor="middle" x="7922" y="-1414.97" font-family="Times,serif" font-size="14.00">Q Proj L2</text>
<text text-anchor="middle" x="7922" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ln2_pre&#45;&gt;q_proj_2_6 -->
<g id="edge199" class="edge">
<title>ln2_pre&#45;&gt;q_proj_2_6</title>
<path fill="none" stroke="black" d="M7395.86,-1482.39C7503.97,-1478.7 7697.57,-1467.32 7869.92,-1430.1"/>
<polygon fill="black" stroke="black" points="7870.91,-1433.46 7879.93,-1427.9 7869.41,-1426.63 7870.91,-1433.46"/>
</g>
<!-- k_proj_2_6 -->
<g id="node131" class="node">
<title>k_proj_2_6</title>
<polygon fill="lightblue" stroke="black" points="8065.5,-1430.17 7982.5,-1430.17 7982.5,-1392.17 8065.5,-1392.17 8065.5,-1430.17"/>
<text text-anchor="middle" x="8024" y="-1414.97" font-family="Times,serif" font-size="14.00">K Proj L2</text>
<text text-anchor="middle" x="8024" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ln2_pre&#45;&gt;k_proj_2_6 -->
<g id="edge200" class="edge">
<title>ln2_pre&#45;&gt;k_proj_2_6</title>
<path fill="none" stroke="black" d="M7395.7,-1484.19C7520.16,-1482.72 7761.09,-1474.06 7972.19,-1430"/>
<polygon fill="black" stroke="black" points="7973.16,-1433.37 7982.22,-1427.87 7971.71,-1426.52 7973.16,-1433.37"/>
</g>
<!-- v_proj_2_6 -->
<g id="node132" class="node">
<title>v_proj_2_6</title>
<polygon fill="lightblue" stroke="black" points="8166.5,-1430.17 8083.5,-1430.17 8083.5,-1392.17 8166.5,-1392.17 8166.5,-1430.17"/>
<text text-anchor="middle" x="8125" y="-1414.97" font-family="Times,serif" font-size="14.00">V Proj L2</text>
<text text-anchor="middle" x="8125" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ln2_pre&#45;&gt;v_proj_2_6 -->
<g id="edge201" class="edge">
<title>ln2_pre&#45;&gt;v_proj_2_6</title>
<path fill="none" stroke="black" d="M7395.8,-1481.14C7562.13,-1474.67 7929.59,-1457.93 8073.28,-1430.16"/>
<polygon fill="black" stroke="black" points="8074.13,-1433.56 8083.23,-1428.15 8072.73,-1426.7 8074.13,-1433.56"/>
</g>
<!-- q_proj_2_7 -->
<g id="node135" class="node">
<title>q_proj_2_7</title>
<polygon fill="lightblue" stroke="black" points="8269,-1430.17 8185,-1430.17 8185,-1392.17 8269,-1392.17 8269,-1430.17"/>
<text text-anchor="middle" x="8227" y="-1414.97" font-family="Times,serif" font-size="14.00">Q Proj L2</text>
<text text-anchor="middle" x="8227" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ln2_pre&#45;&gt;q_proj_2_7 -->
<g id="edge207" class="edge">
<title>ln2_pre&#45;&gt;q_proj_2_7</title>
<path fill="none" stroke="black" d="M7395.75,-1481.88C7578.73,-1476.42 8010.27,-1460.86 8174.97,-1429.98"/>
<polygon fill="black" stroke="black" points="8175.82,-1433.38 8184.95,-1428.02 8174.47,-1426.51 8175.82,-1433.38"/>
</g>
<!-- k_proj_2_7 -->
<g id="node136" class="node">
<title>k_proj_2_7</title>
<polygon fill="lightblue" stroke="black" points="8370.5,-1430.17 8287.5,-1430.17 8287.5,-1392.17 8370.5,-1392.17 8370.5,-1430.17"/>
<text text-anchor="middle" x="8329" y="-1414.97" font-family="Times,serif" font-size="14.00">K Proj L2</text>
<text text-anchor="middle" x="8329" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ln2_pre&#45;&gt;k_proj_2_7 -->
<g id="edge208" class="edge">
<title>ln2_pre&#45;&gt;k_proj_2_7</title>
<path fill="none" stroke="black" d="M7395.7,-1482.53C7594.56,-1478.15 8091.91,-1464.25 8277.33,-1429.88"/>
<polygon fill="black" stroke="black" points="8278.09,-1433.3 8287.24,-1427.96 8276.76,-1426.42 8278.09,-1433.3"/>
</g>
<!-- v_proj_2_7 -->
<g id="node137" class="node">
<title>v_proj_2_7</title>
<polygon fill="lightblue" stroke="black" points="8471.5,-1430.17 8388.5,-1430.17 8388.5,-1392.17 8471.5,-1392.17 8471.5,-1430.17"/>
<text text-anchor="middle" x="8430" y="-1414.97" font-family="Times,serif" font-size="14.00">V Proj L2</text>
<text text-anchor="middle" x="8430" y="-1399.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ln2_pre&#45;&gt;v_proj_2_7 -->
<g id="edge209" class="edge">
<title>ln2_pre&#45;&gt;v_proj_2_7</title>
<path fill="none" stroke="black" d="M7395.66,-1483.11C7609.5,-1479.93 8173.05,-1468.25 8378.17,-1430.16"/>
<polygon fill="black" stroke="black" points="8379.09,-1433.55 8388.24,-1428.21 8377.76,-1426.67 8379.09,-1433.55"/>
</g>
<!-- attention_2_0 -->
<g id="node103" class="node">
<title>attention_2_0</title>
<path fill="gold" stroke="black" d="M6270.5,-1356.17C6270.5,-1356.17 6219.5,-1356.17 6219.5,-1356.17 6213.5,-1356.17 6207.5,-1350.17 6207.5,-1344.17 6207.5,-1344.17 6207.5,-1330.17 6207.5,-1330.17 6207.5,-1324.17 6213.5,-1318.17 6219.5,-1318.17 6219.5,-1318.17 6270.5,-1318.17 6270.5,-1318.17 6276.5,-1318.17 6282.5,-1324.17 6282.5,-1330.17 6282.5,-1330.17 6282.5,-1344.17 6282.5,-1344.17 6282.5,-1350.17 6276.5,-1356.17 6270.5,-1356.17"/>
<text text-anchor="middle" x="6245" y="-1340.97" font-family="Times,serif" font-size="14.00">MHA L2</text>
<text text-anchor="middle" x="6245" y="-1325.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- q_proj_2_0&#45;&gt;attention_2_0 -->
<g id="edge154" class="edge">
<title>q_proj_2_0&#45;&gt;attention_2_0</title>
<path fill="none" stroke="black" d="M6130.61,-1392C6151.12,-1382.35 6176.5,-1370.4 6198.13,-1360.22"/>
<polygon fill="black" stroke="black" points="6199.9,-1363.26 6207.46,-1355.83 6196.92,-1356.92 6199.9,-1363.26"/>
</g>
<!-- k_proj_2_0&#45;&gt;attention_2_0 -->
<g id="edge155" class="edge">
<title>k_proj_2_0&#45;&gt;attention_2_0</title>
<path fill="none" stroke="black" d="M6206.87,-1392C6212.68,-1383.79 6219.67,-1373.93 6226.06,-1364.9"/>
<polygon fill="black" stroke="black" points="6229.03,-1366.76 6231.96,-1356.58 6223.32,-1362.72 6229.03,-1366.76"/>
</g>
<!-- v_proj_2_0&#45;&gt;attention_2_0 -->
<g id="edge156" class="edge">
<title>v_proj_2_0&#45;&gt;attention_2_0</title>
<path fill="none" stroke="black" d="M6282.38,-1392C6276.68,-1383.79 6269.83,-1373.93 6263.56,-1364.9"/>
<polygon fill="black" stroke="black" points="6266.37,-1362.8 6257.79,-1356.58 6260.62,-1366.79 6266.37,-1362.8"/>
</g>
<!-- o_proj_2_0 -->
<g id="node104" class="node">
<title>o_proj_2_0</title>
<polygon fill="lightblue" stroke="black" points="6581,-1282.17 6497,-1282.17 6497,-1244.17 6581,-1244.17 6581,-1282.17"/>
<text text-anchor="middle" x="6539" y="-1266.97" font-family="Times,serif" font-size="14.00">O Proj L2</text>
<text text-anchor="middle" x="6539" y="-1251.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- attention_2_0&#45;&gt;o_proj_2_0 -->
<g id="edge157" class="edge">
<title>attention_2_0&#45;&gt;o_proj_2_0</title>
<path fill="none" stroke="black" d="M6282.53,-1326.97C6334.48,-1314.25 6428.51,-1291.22 6487.14,-1276.87"/>
<polygon fill="black" stroke="black" points="6488.07,-1280.24 6496.95,-1274.47 6486.4,-1273.44 6488.07,-1280.24"/>
</g>
<!-- all_reduce_2 -->
<g id="node140" class="node">
<title>all_reduce_2</title>
<polygon fill="orange" stroke="black" points="7563.89,-1208.17 7307.95,-1208.17 7242.11,-1132.17 7498.05,-1132.17 7563.89,-1208.17"/>
<text text-anchor="middle" x="7403" y="-1173.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce L2</text>
<text text-anchor="middle" x="7403" y="-1158.97" font-family="Times,serif" font-size="14.00">GPU: all GPUs 8&#45;15</text>
</g>
<!-- o_proj_2_0&#45;&gt;all_reduce_2 -->
<g id="edge158" class="edge">
<title>o_proj_2_0&#45;&gt;all_reduce_2</title>
<path fill="none" stroke="black" d="M6581.24,-1256.98C6611.73,-1253.29 6653.89,-1248.27 6691,-1244.17 6895.44,-1221.58 7133.17,-1197.68 7275.68,-1183.61"/>
<polygon fill="black" stroke="black" points="7276.16,-1187.08 7285.77,-1182.62 7275.47,-1180.12 7276.16,-1187.08"/>
</g>
<!-- attention_2_1 -->
<g id="node108" class="node">
<title>attention_2_1</title>
<path fill="gold" stroke="black" d="M6575.5,-1356.17C6575.5,-1356.17 6524.5,-1356.17 6524.5,-1356.17 6518.5,-1356.17 6512.5,-1350.17 6512.5,-1344.17 6512.5,-1344.17 6512.5,-1330.17 6512.5,-1330.17 6512.5,-1324.17 6518.5,-1318.17 6524.5,-1318.17 6524.5,-1318.17 6575.5,-1318.17 6575.5,-1318.17 6581.5,-1318.17 6587.5,-1324.17 6587.5,-1330.17 6587.5,-1330.17 6587.5,-1344.17 6587.5,-1344.17 6587.5,-1350.17 6581.5,-1356.17 6575.5,-1356.17"/>
<text text-anchor="middle" x="6550" y="-1340.97" font-family="Times,serif" font-size="14.00">MHA L2</text>
<text text-anchor="middle" x="6550" y="-1325.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- q_proj_2_1&#45;&gt;attention_2_1 -->
<g id="edge162" class="edge">
<title>q_proj_2_1&#45;&gt;attention_2_1</title>
<path fill="none" stroke="black" d="M6435.61,-1392C6456.12,-1382.35 6481.5,-1370.4 6503.13,-1360.22"/>
<polygon fill="black" stroke="black" points="6504.9,-1363.26 6512.46,-1355.83 6501.92,-1356.92 6504.9,-1363.26"/>
</g>
<!-- k_proj_2_1&#45;&gt;attention_2_1 -->
<g id="edge163" class="edge">
<title>k_proj_2_1&#45;&gt;attention_2_1</title>
<path fill="none" stroke="black" d="M6511.87,-1392C6517.68,-1383.79 6524.67,-1373.93 6531.06,-1364.9"/>
<polygon fill="black" stroke="black" points="6534.03,-1366.76 6536.96,-1356.58 6528.32,-1362.72 6534.03,-1366.76"/>
</g>
<!-- v_proj_2_1&#45;&gt;attention_2_1 -->
<g id="edge164" class="edge">
<title>v_proj_2_1&#45;&gt;attention_2_1</title>
<path fill="none" stroke="black" d="M6587.38,-1392C6581.68,-1383.79 6574.83,-1373.93 6568.56,-1364.9"/>
<polygon fill="black" stroke="black" points="6571.37,-1362.8 6562.79,-1356.58 6565.62,-1366.79 6571.37,-1362.8"/>
</g>
<!-- o_proj_2_1 -->
<g id="node109" class="node">
<title>o_proj_2_1</title>
<polygon fill="lightblue" stroke="black" points="6784,-1282.17 6700,-1282.17 6700,-1244.17 6784,-1244.17 6784,-1282.17"/>
<text text-anchor="middle" x="6742" y="-1266.97" font-family="Times,serif" font-size="14.00">O Proj L2</text>
<text text-anchor="middle" x="6742" y="-1251.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- attention_2_1&#45;&gt;o_proj_2_1 -->
<g id="edge165" class="edge">
<title>attention_2_1&#45;&gt;o_proj_2_1</title>
<path fill="none" stroke="black" d="M6587.93,-1321.94C6617.15,-1310.99 6657.86,-1295.72 6690.1,-1283.63"/>
<polygon fill="black" stroke="black" points="6691.67,-1286.78 6699.81,-1279.99 6689.22,-1280.22 6691.67,-1286.78"/>
</g>
<!-- o_proj_2_1&#45;&gt;all_reduce_2 -->
<g id="edge166" class="edge">
<title>o_proj_2_1&#45;&gt;all_reduce_2</title>
<path fill="none" stroke="black" d="M6784.1,-1256.37C6882.09,-1242.88 7128.51,-1208.96 7279.19,-1188.21"/>
<polygon fill="black" stroke="black" points="7279.99,-1191.63 7289.42,-1186.8 7279.03,-1184.7 7279.99,-1191.63"/>
</g>
<!-- attention_2_2 -->
<g id="node113" class="node">
<title>attention_2_2</title>
<path fill="gold" stroke="black" d="M6880.5,-1356.17C6880.5,-1356.17 6829.5,-1356.17 6829.5,-1356.17 6823.5,-1356.17 6817.5,-1350.17 6817.5,-1344.17 6817.5,-1344.17 6817.5,-1330.17 6817.5,-1330.17 6817.5,-1324.17 6823.5,-1318.17 6829.5,-1318.17 6829.5,-1318.17 6880.5,-1318.17 6880.5,-1318.17 6886.5,-1318.17 6892.5,-1324.17 6892.5,-1330.17 6892.5,-1330.17 6892.5,-1344.17 6892.5,-1344.17 6892.5,-1350.17 6886.5,-1356.17 6880.5,-1356.17"/>
<text text-anchor="middle" x="6855" y="-1340.97" font-family="Times,serif" font-size="14.00">MHA L2</text>
<text text-anchor="middle" x="6855" y="-1325.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- q_proj_2_2&#45;&gt;attention_2_2 -->
<g id="edge170" class="edge">
<title>q_proj_2_2&#45;&gt;attention_2_2</title>
<path fill="none" stroke="black" d="M6740.61,-1392C6761.12,-1382.35 6786.5,-1370.4 6808.13,-1360.22"/>
<polygon fill="black" stroke="black" points="6809.9,-1363.26 6817.46,-1355.83 6806.92,-1356.92 6809.9,-1363.26"/>
</g>
<!-- k_proj_2_2&#45;&gt;attention_2_2 -->
<g id="edge171" class="edge">
<title>k_proj_2_2&#45;&gt;attention_2_2</title>
<path fill="none" stroke="black" d="M6816.87,-1392C6822.68,-1383.79 6829.67,-1373.93 6836.06,-1364.9"/>
<polygon fill="black" stroke="black" points="6839.03,-1366.76 6841.96,-1356.58 6833.32,-1362.72 6839.03,-1366.76"/>
</g>
<!-- v_proj_2_2&#45;&gt;attention_2_2 -->
<g id="edge172" class="edge">
<title>v_proj_2_2&#45;&gt;attention_2_2</title>
<path fill="none" stroke="black" d="M6892.38,-1392C6886.68,-1383.79 6879.83,-1373.93 6873.56,-1364.9"/>
<polygon fill="black" stroke="black" points="6876.37,-1362.8 6867.79,-1356.58 6870.62,-1366.79 6876.37,-1362.8"/>
</g>
<!-- o_proj_2_2 -->
<g id="node114" class="node">
<title>o_proj_2_2</title>
<polygon fill="lightblue" stroke="black" points="7079,-1282.17 6995,-1282.17 6995,-1244.17 7079,-1244.17 7079,-1282.17"/>
<text text-anchor="middle" x="7037" y="-1266.97" font-family="Times,serif" font-size="14.00">O Proj L2</text>
<text text-anchor="middle" x="7037" y="-1251.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- attention_2_2&#45;&gt;o_proj_2_2 -->
<g id="edge173" class="edge">
<title>attention_2_2&#45;&gt;o_proj_2_2</title>
<path fill="none" stroke="black" d="M6892.71,-1321.25C6919.58,-1310.62 6956.02,-1296.2 6985.56,-1284.52"/>
<polygon fill="black" stroke="black" points="6986.87,-1287.76 6994.88,-1280.83 6984.3,-1281.25 6986.87,-1287.76"/>
</g>
<!-- o_proj_2_2&#45;&gt;all_reduce_2 -->
<g id="edge174" class="edge">
<title>o_proj_2_2&#45;&gt;all_reduce_2</title>
<path fill="none" stroke="black" d="M7079.34,-1251.64C7130.11,-1239.02 7217.25,-1217.35 7288.33,-1199.68"/>
<polygon fill="black" stroke="black" points="7289.39,-1203.02 7298.25,-1197.21 7287.7,-1196.23 7289.39,-1203.02"/>
</g>
<!-- attention_2_3 -->
<g id="node118" class="node">
<title>attention_2_3</title>
<path fill="gold" stroke="black" d="M7184.5,-1356.17C7184.5,-1356.17 7133.5,-1356.17 7133.5,-1356.17 7127.5,-1356.17 7121.5,-1350.17 7121.5,-1344.17 7121.5,-1344.17 7121.5,-1330.17 7121.5,-1330.17 7121.5,-1324.17 7127.5,-1318.17 7133.5,-1318.17 7133.5,-1318.17 7184.5,-1318.17 7184.5,-1318.17 7190.5,-1318.17 7196.5,-1324.17 7196.5,-1330.17 7196.5,-1330.17 7196.5,-1344.17 7196.5,-1344.17 7196.5,-1350.17 7190.5,-1356.17 7184.5,-1356.17"/>
<text text-anchor="middle" x="7159" y="-1340.97" font-family="Times,serif" font-size="14.00">MHA L2</text>
<text text-anchor="middle" x="7159" y="-1325.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- q_proj_2_3&#45;&gt;attention_2_3 -->
<g id="edge178" class="edge">
<title>q_proj_2_3&#45;&gt;attention_2_3</title>
<path fill="none" stroke="black" d="M7045.36,-1392C7065.66,-1382.38 7090.75,-1370.49 7112.19,-1360.34"/>
<polygon fill="black" stroke="black" points="7113.91,-1363.4 7121.45,-1355.96 7110.91,-1357.07 7113.91,-1363.4"/>
</g>
<!-- k_proj_2_3&#45;&gt;attention_2_3 -->
<g id="edge179" class="edge">
<title>k_proj_2_3&#45;&gt;attention_2_3</title>
<path fill="none" stroke="black" d="M7121.62,-1392C7127.32,-1383.79 7134.17,-1373.93 7140.44,-1364.9"/>
<polygon fill="black" stroke="black" points="7143.38,-1366.79 7146.21,-1356.58 7137.63,-1362.8 7143.38,-1366.79"/>
</g>
<!-- v_proj_2_3&#45;&gt;attention_2_3 -->
<g id="edge180" class="edge">
<title>v_proj_2_3&#45;&gt;attention_2_3</title>
<path fill="none" stroke="black" d="M7197.13,-1392C7191.32,-1383.79 7184.33,-1373.93 7177.94,-1364.9"/>
<polygon fill="black" stroke="black" points="7180.68,-1362.72 7172.04,-1356.58 7174.97,-1366.76 7180.68,-1362.72"/>
</g>
<!-- o_proj_2_3 -->
<g id="node119" class="node">
<title>o_proj_2_3</title>
<polygon fill="lightblue" stroke="black" points="7292,-1282.17 7208,-1282.17 7208,-1244.17 7292,-1244.17 7292,-1282.17"/>
<text text-anchor="middle" x="7250" y="-1266.97" font-family="Times,serif" font-size="14.00">O Proj L2</text>
<text text-anchor="middle" x="7250" y="-1251.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- attention_2_3&#45;&gt;o_proj_2_3 -->
<g id="edge181" class="edge">
<title>attention_2_3&#45;&gt;o_proj_2_3</title>
<path fill="none" stroke="black" d="M7181.96,-1318C7193.17,-1309.13 7206.82,-1298.33 7218.94,-1288.74"/>
<polygon fill="black" stroke="black" points="7221.37,-1291.28 7227.04,-1282.33 7217.03,-1285.79 7221.37,-1291.28"/>
</g>
<!-- o_proj_2_3&#45;&gt;all_reduce_2 -->
<g id="edge182" class="edge">
<title>o_proj_2_3&#45;&gt;all_reduce_2</title>
<path fill="none" stroke="black" d="M7280.59,-1243.97C7295.36,-1235.19 7313.74,-1224.26 7331.74,-1213.55"/>
<polygon fill="black" stroke="black" points="7333.72,-1216.45 7340.52,-1208.33 7330.14,-1210.43 7333.72,-1216.45"/>
</g>
<!-- attention_2_4 -->
<g id="node123" class="node">
<title>attention_2_4</title>
<path fill="gold" stroke="black" d="M7436.5,-1356.17C7436.5,-1356.17 7385.5,-1356.17 7385.5,-1356.17 7379.5,-1356.17 7373.5,-1350.17 7373.5,-1344.17 7373.5,-1344.17 7373.5,-1330.17 7373.5,-1330.17 7373.5,-1324.17 7379.5,-1318.17 7385.5,-1318.17 7385.5,-1318.17 7436.5,-1318.17 7436.5,-1318.17 7442.5,-1318.17 7448.5,-1324.17 7448.5,-1330.17 7448.5,-1330.17 7448.5,-1344.17 7448.5,-1344.17 7448.5,-1350.17 7442.5,-1356.17 7436.5,-1356.17"/>
<text text-anchor="middle" x="7411" y="-1340.97" font-family="Times,serif" font-size="14.00">MHA L2</text>
<text text-anchor="middle" x="7411" y="-1325.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- q_proj_2_4&#45;&gt;attention_2_4 -->
<g id="edge186" class="edge">
<title>q_proj_2_4&#45;&gt;attention_2_4</title>
<path fill="none" stroke="black" d="M7336.98,-1392C7349.29,-1383.04 7364.31,-1372.12 7377.59,-1362.46"/>
<polygon fill="black" stroke="black" points="7380,-1365.04 7386.03,-1356.33 7375.88,-1359.38 7380,-1365.04"/>
</g>
<!-- k_proj_2_4&#45;&gt;attention_2_4 -->
<g id="edge187" class="edge">
<title>k_proj_2_4&#45;&gt;attention_2_4</title>
<path fill="none" stroke="black" d="M7413.24,-1392C7412.92,-1384.3 7412.54,-1375.14 7412.18,-1366.58"/>
<polygon fill="black" stroke="black" points="7415.68,-1366.43 7411.77,-1356.58 7408.69,-1366.72 7415.68,-1366.43"/>
</g>
<!-- v_proj_2_4&#45;&gt;attention_2_4 -->
<g id="edge188" class="edge">
<title>v_proj_2_4&#45;&gt;attention_2_4</title>
<path fill="none" stroke="black" d="M7488.76,-1392C7475.7,-1382.96 7459.75,-1371.91 7445.7,-1362.19"/>
<polygon fill="black" stroke="black" points="7447.45,-1359.14 7437.24,-1356.33 7443.46,-1364.9 7447.45,-1359.14"/>
</g>
<!-- o_proj_2_4 -->
<g id="node124" class="node">
<title>o_proj_2_4</title>
<polygon fill="lightblue" stroke="black" points="7450,-1282.17 7366,-1282.17 7366,-1244.17 7450,-1244.17 7450,-1282.17"/>
<text text-anchor="middle" x="7408" y="-1266.97" font-family="Times,serif" font-size="14.00">O Proj L2</text>
<text text-anchor="middle" x="7408" y="-1251.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- attention_2_4&#45;&gt;o_proj_2_4 -->
<g id="edge189" class="edge">
<title>attention_2_4&#45;&gt;o_proj_2_4</title>
<path fill="none" stroke="black" d="M7410.24,-1318C7409.92,-1310.3 7409.54,-1301.14 7409.18,-1292.58"/>
<polygon fill="black" stroke="black" points="7412.68,-1292.43 7408.77,-1282.58 7405.69,-1292.72 7412.68,-1292.43"/>
</g>
<!-- o_proj_2_4&#45;&gt;all_reduce_2 -->
<g id="edge190" class="edge">
<title>o_proj_2_4&#45;&gt;all_reduce_2</title>
<path fill="none" stroke="black" d="M7406.99,-1243.75C7406.58,-1236.36 7406.09,-1227.46 7405.6,-1218.47"/>
<polygon fill="black" stroke="black" points="7409.09,-1218.14 7405.04,-1208.35 7402.1,-1218.53 7409.09,-1218.14"/>
</g>
<!-- attention_2_5 -->
<g id="node128" class="node">
<title>attention_2_5</title>
<path fill="gold" stroke="black" d="M7711.5,-1356.17C7711.5,-1356.17 7660.5,-1356.17 7660.5,-1356.17 7654.5,-1356.17 7648.5,-1350.17 7648.5,-1344.17 7648.5,-1344.17 7648.5,-1330.17 7648.5,-1330.17 7648.5,-1324.17 7654.5,-1318.17 7660.5,-1318.17 7660.5,-1318.17 7711.5,-1318.17 7711.5,-1318.17 7717.5,-1318.17 7723.5,-1324.17 7723.5,-1330.17 7723.5,-1330.17 7723.5,-1344.17 7723.5,-1344.17 7723.5,-1350.17 7717.5,-1356.17 7711.5,-1356.17"/>
<text text-anchor="middle" x="7686" y="-1340.97" font-family="Times,serif" font-size="14.00">MHA L2</text>
<text text-anchor="middle" x="7686" y="-1325.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- q_proj_2_5&#45;&gt;attention_2_5 -->
<g id="edge194" class="edge">
<title>q_proj_2_5&#45;&gt;attention_2_5</title>
<path fill="none" stroke="black" d="M7634.41,-1392C7642.52,-1383.54 7652.32,-1373.32 7661.18,-1364.06"/>
<polygon fill="black" stroke="black" points="7663.96,-1366.22 7668.35,-1356.58 7658.91,-1361.38 7663.96,-1366.22"/>
</g>
<!-- k_proj_2_5&#45;&gt;attention_2_5 -->
<g id="edge195" class="edge">
<title>k_proj_2_5&#45;&gt;attention_2_5</title>
<path fill="none" stroke="black" d="M7710.67,-1392C7707.03,-1384.04 7702.67,-1374.54 7698.64,-1365.74"/>
<polygon fill="black" stroke="black" points="7701.79,-1364.21 7694.44,-1356.58 7695.42,-1367.13 7701.79,-1364.21"/>
</g>
<!-- v_proj_2_5&#45;&gt;attention_2_5 -->
<g id="edge196" class="edge">
<title>v_proj_2_5&#45;&gt;attention_2_5</title>
<path fill="none" stroke="black" d="M7786.19,-1392C7768.73,-1382.62 7747.25,-1371.08 7728.66,-1361.09"/>
<polygon fill="black" stroke="black" points="7730.27,-1357.98 7719.8,-1356.33 7726.96,-1364.15 7730.27,-1357.98"/>
</g>
<!-- o_proj_2_5 -->
<g id="node129" class="node">
<title>o_proj_2_5</title>
<polygon fill="lightblue" stroke="black" points="7586,-1282.17 7502,-1282.17 7502,-1244.17 7586,-1244.17 7586,-1282.17"/>
<text text-anchor="middle" x="7544" y="-1266.97" font-family="Times,serif" font-size="14.00">O Proj L2</text>
<text text-anchor="middle" x="7544" y="-1251.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- attention_2_5&#45;&gt;o_proj_2_5 -->
<g id="edge197" class="edge">
<title>attention_2_5&#45;&gt;o_proj_2_5</title>
<path fill="none" stroke="black" d="M7650.17,-1318C7631.58,-1308.58 7608.7,-1296.97 7588.94,-1286.95"/>
<polygon fill="black" stroke="black" points="7590.32,-1283.73 7579.82,-1282.33 7587.16,-1289.97 7590.32,-1283.73"/>
</g>
<!-- o_proj_2_5&#45;&gt;all_reduce_2 -->
<g id="edge198" class="edge">
<title>o_proj_2_5&#45;&gt;all_reduce_2</title>
<path fill="none" stroke="black" d="M7515.81,-1243.97C7502.32,-1235.27 7485.57,-1224.45 7469.13,-1213.84"/>
<polygon fill="black" stroke="black" points="7470.88,-1210.81 7460.58,-1208.33 7467.08,-1216.69 7470.88,-1210.81"/>
</g>
<!-- attention_2_6 -->
<g id="node133" class="node">
<title>attention_2_6</title>
<path fill="gold" stroke="black" d="M7998.5,-1356.17C7998.5,-1356.17 7947.5,-1356.17 7947.5,-1356.17 7941.5,-1356.17 7935.5,-1350.17 7935.5,-1344.17 7935.5,-1344.17 7935.5,-1330.17 7935.5,-1330.17 7935.5,-1324.17 7941.5,-1318.17 7947.5,-1318.17 7947.5,-1318.17 7998.5,-1318.17 7998.5,-1318.17 8004.5,-1318.17 8010.5,-1324.17 8010.5,-1330.17 8010.5,-1330.17 8010.5,-1344.17 8010.5,-1344.17 8010.5,-1350.17 8004.5,-1356.17 7998.5,-1356.17"/>
<text text-anchor="middle" x="7973" y="-1340.97" font-family="Times,serif" font-size="14.00">MHA L2</text>
<text text-anchor="middle" x="7973" y="-1325.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- q_proj_2_6&#45;&gt;attention_2_6 -->
<g id="edge202" class="edge">
<title>q_proj_2_6&#45;&gt;attention_2_6</title>
<path fill="none" stroke="black" d="M7934.87,-1392C7940.68,-1383.79 7947.67,-1373.93 7954.06,-1364.9"/>
<polygon fill="black" stroke="black" points="7957.03,-1366.76 7959.96,-1356.58 7951.32,-1362.72 7957.03,-1366.76"/>
</g>
<!-- k_proj_2_6&#45;&gt;attention_2_6 -->
<g id="edge203" class="edge">
<title>k_proj_2_6&#45;&gt;attention_2_6</title>
<path fill="none" stroke="black" d="M8011.13,-1392C8005.32,-1383.79 7998.33,-1373.93 7991.94,-1364.9"/>
<polygon fill="black" stroke="black" points="7994.68,-1362.72 7986.04,-1356.58 7988.97,-1366.76 7994.68,-1362.72"/>
</g>
<!-- v_proj_2_6&#45;&gt;attention_2_6 -->
<g id="edge204" class="edge">
<title>v_proj_2_6&#45;&gt;attention_2_6</title>
<path fill="none" stroke="black" d="M8086.64,-1392C8066.34,-1382.38 8041.25,-1370.49 8019.81,-1360.34"/>
<polygon fill="black" stroke="black" points="8021.09,-1357.07 8010.55,-1355.96 8018.09,-1363.4 8021.09,-1357.07"/>
</g>
<!-- o_proj_2_6 -->
<g id="node134" class="node">
<title>o_proj_2_6</title>
<polygon fill="lightblue" stroke="black" points="7914,-1282.17 7830,-1282.17 7830,-1244.17 7914,-1244.17 7914,-1282.17"/>
<text text-anchor="middle" x="7872" y="-1266.97" font-family="Times,serif" font-size="14.00">O Proj L2</text>
<text text-anchor="middle" x="7872" y="-1251.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- attention_2_6&#45;&gt;o_proj_2_6 -->
<g id="edge205" class="edge">
<title>attention_2_6&#45;&gt;o_proj_2_6</title>
<path fill="none" stroke="black" d="M7947.51,-1318C7934.83,-1308.96 7919.34,-1297.91 7905.69,-1288.19"/>
<polygon fill="black" stroke="black" points="7907.65,-1285.28 7897.48,-1282.33 7903.59,-1290.98 7907.65,-1285.28"/>
</g>
<!-- o_proj_2_6&#45;&gt;all_reduce_2 -->
<g id="edge206" class="edge">
<title>o_proj_2_6&#45;&gt;all_reduce_2</title>
<path fill="none" stroke="black" d="M7829.97,-1254.01C7771.28,-1242.62 7661.47,-1221.32 7567.91,-1203.16"/>
<polygon fill="black" stroke="black" points="7568.52,-1199.72 7558.04,-1201.25 7567.19,-1206.59 7568.52,-1199.72"/>
</g>
<!-- attention_2_7 -->
<g id="node138" class="node">
<title>attention_2_7</title>
<path fill="gold" stroke="black" d="M8303.5,-1356.17C8303.5,-1356.17 8252.5,-1356.17 8252.5,-1356.17 8246.5,-1356.17 8240.5,-1350.17 8240.5,-1344.17 8240.5,-1344.17 8240.5,-1330.17 8240.5,-1330.17 8240.5,-1324.17 8246.5,-1318.17 8252.5,-1318.17 8252.5,-1318.17 8303.5,-1318.17 8303.5,-1318.17 8309.5,-1318.17 8315.5,-1324.17 8315.5,-1330.17 8315.5,-1330.17 8315.5,-1344.17 8315.5,-1344.17 8315.5,-1350.17 8309.5,-1356.17 8303.5,-1356.17"/>
<text text-anchor="middle" x="8278" y="-1340.97" font-family="Times,serif" font-size="14.00">MHA L2</text>
<text text-anchor="middle" x="8278" y="-1325.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- q_proj_2_7&#45;&gt;attention_2_7 -->
<g id="edge210" class="edge">
<title>q_proj_2_7&#45;&gt;attention_2_7</title>
<path fill="none" stroke="black" d="M8239.87,-1392C8245.68,-1383.79 8252.67,-1373.93 8259.06,-1364.9"/>
<polygon fill="black" stroke="black" points="8262.03,-1366.76 8264.96,-1356.58 8256.32,-1362.72 8262.03,-1366.76"/>
</g>
<!-- k_proj_2_7&#45;&gt;attention_2_7 -->
<g id="edge211" class="edge">
<title>k_proj_2_7&#45;&gt;attention_2_7</title>
<path fill="none" stroke="black" d="M8316.13,-1392C8310.32,-1383.79 8303.33,-1373.93 8296.94,-1364.9"/>
<polygon fill="black" stroke="black" points="8299.68,-1362.72 8291.04,-1356.58 8293.97,-1366.76 8299.68,-1362.72"/>
</g>
<!-- v_proj_2_7&#45;&gt;attention_2_7 -->
<g id="edge212" class="edge">
<title>v_proj_2_7&#45;&gt;attention_2_7</title>
<path fill="none" stroke="black" d="M8391.64,-1392C8371.34,-1382.38 8346.25,-1370.49 8324.81,-1360.34"/>
<polygon fill="black" stroke="black" points="8326.09,-1357.07 8315.55,-1355.96 8323.09,-1363.4 8326.09,-1357.07"/>
</g>
<!-- o_proj_2_7 -->
<g id="node139" class="node">
<title>o_proj_2_7</title>
<polygon fill="lightblue" stroke="black" points="8168,-1282.17 8084,-1282.17 8084,-1244.17 8168,-1244.17 8168,-1282.17"/>
<text text-anchor="middle" x="8126" y="-1266.97" font-family="Times,serif" font-size="14.00">O Proj L2</text>
<text text-anchor="middle" x="8126" y="-1251.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- attention_2_7&#45;&gt;o_proj_2_7 -->
<g id="edge213" class="edge">
<title>attention_2_7&#45;&gt;o_proj_2_7</title>
<path fill="none" stroke="black" d="M8240.43,-1318.37C8220.21,-1308.79 8195.07,-1296.88 8173.51,-1286.67"/>
<polygon fill="black" stroke="black" points="8174.73,-1283.38 8164.2,-1282.26 8171.74,-1289.7 8174.73,-1283.38"/>
</g>
<!-- o_proj_2_7&#45;&gt;all_reduce_2 -->
<g id="edge214" class="edge">
<title>o_proj_2_7&#45;&gt;all_reduce_2</title>
<path fill="none" stroke="black" d="M8083.74,-1256.85C7983.2,-1244.19 7725.66,-1211.78 7557.75,-1190.64"/>
<polygon fill="black" stroke="black" points="7558.19,-1187.17 7547.83,-1189.4 7557.31,-1194.12 7558.19,-1187.17"/>
</g>
<!-- all_reduce_2&#45;&gt;add_4 -->
<g id="edge215" class="edge">
<title>all_reduce_2&#45;&gt;add_4</title>
<path fill="none" stroke="black" d="M7403,-1132.15C7403,-1123.53 7403,-1114.49 7403,-1106.32"/>
<polygon fill="black" stroke="black" points="7406.5,-1106.2 7403,-1096.2 7399.5,-1106.2 7406.5,-1106.2"/>
</g>
<!-- mlp2_gate -->
<g id="node142" class="node">
<title>mlp2_gate</title>
<polygon fill="lightpink" stroke="black" points="7297.5,-1022.17 7142.5,-1022.17 7142.5,-984.17 7297.5,-984.17 7297.5,-1022.17"/>
<text text-anchor="middle" x="7220" y="-1006.97" font-family="Times,serif" font-size="14.00">MLP Gate L2</text>
<text text-anchor="middle" x="7220" y="-991.97" font-family="Times,serif" font-size="14.00">GPU: all GPUs 8&#45;15</text>
</g>
<!-- add_4&#45;&gt;mlp2_gate -->
<g id="edge217" class="edge">
<title>add_4&#45;&gt;mlp2_gate</title>
<path fill="none" stroke="black" d="M7356.82,-1058C7332.02,-1048.24 7301.28,-1036.14 7275.22,-1025.89"/>
<polygon fill="black" stroke="black" points="7276.43,-1022.61 7265.85,-1022.2 7273.87,-1029.12 7276.43,-1022.61"/>
</g>
<!-- mlp2_up -->
<g id="node143" class="node">
<title>mlp2_up</title>
<polygon fill="lightpink" stroke="black" points="7470.5,-1022.17 7315.5,-1022.17 7315.5,-984.17 7470.5,-984.17 7470.5,-1022.17"/>
<text text-anchor="middle" x="7393" y="-1006.97" font-family="Times,serif" font-size="14.00">MLP Up L2</text>
<text text-anchor="middle" x="7393" y="-991.97" font-family="Times,serif" font-size="14.00">GPU: all GPUs 8&#45;15</text>
</g>
<!-- add_4&#45;&gt;mlp2_up -->
<g id="edge218" class="edge">
<title>add_4&#45;&gt;mlp2_up</title>
<path fill="none" stroke="black" d="M7400.48,-1058C7399.41,-1050.3 7398.14,-1041.14 7396.95,-1032.58"/>
<polygon fill="black" stroke="black" points="7400.4,-1032 7395.56,-1022.58 7393.47,-1032.97 7400.4,-1032"/>
</g>
<!-- add_5 -->
<g id="node145" class="node">
<title>add_5</title>
<polygon fill="lightgray" stroke="black" points="7429.5,-874.17 7274.5,-874.17 7274.5,-836.17 7429.5,-836.17 7429.5,-874.17"/>
<text text-anchor="middle" x="7352" y="-858.97" font-family="Times,serif" font-size="14.00">Residual Add L2</text>
<text text-anchor="middle" x="7352" y="-843.97" font-family="Times,serif" font-size="14.00">GPU: all GPUs 8&#45;15</text>
</g>
<!-- add_4&#45;&gt;add_5 -->
<g id="edge222" class="edge">
<title>add_4&#45;&gt;add_5</title>
<path fill="none" stroke="black" d="M7443.1,-1058.09C7457.44,-1049.42 7472.01,-1037.52 7480,-1022.17 7487.79,-1007.18 7484.23,-1000.52 7480,-984.17 7470.59,-947.76 7464.92,-937.4 7439,-910.17 7427.64,-898.23 7413.1,-887.86 7399.17,-879.48"/>
<polygon fill="black" stroke="black" points="7400.56,-876.24 7390.15,-874.27 7397.06,-882.3 7400.56,-876.24"/>
</g>
<!-- mlp2_down -->
<g id="node144" class="node">
<title>mlp2_down</title>
<polygon fill="lightpink" stroke="black" points="7429.5,-948.17 7274.5,-948.17 7274.5,-910.17 7429.5,-910.17 7429.5,-948.17"/>
<text text-anchor="middle" x="7352" y="-932.97" font-family="Times,serif" font-size="14.00">MLP Down L2</text>
<text text-anchor="middle" x="7352" y="-917.97" font-family="Times,serif" font-size="14.00">GPU: all GPUs 8&#45;15</text>
</g>
<!-- mlp2_gate&#45;&gt;mlp2_down -->
<g id="edge219" class="edge">
<title>mlp2_gate&#45;&gt;mlp2_down</title>
<path fill="none" stroke="black" d="M7253.31,-984C7270.43,-974.66 7291.47,-963.18 7309.72,-953.23"/>
<polygon fill="black" stroke="black" points="7311.6,-956.19 7318.7,-948.33 7308.25,-950.05 7311.6,-956.19"/>
</g>
<!-- mlp2_up&#45;&gt;mlp2_down -->
<g id="edge220" class="edge">
<title>mlp2_up&#45;&gt;mlp2_down</title>
<path fill="none" stroke="black" d="M7382.65,-984C7378.08,-975.96 7372.59,-966.33 7367.54,-957.46"/>
<polygon fill="black" stroke="black" points="7370.48,-955.54 7362.49,-948.58 7364.39,-959 7370.48,-955.54"/>
</g>
<!-- mlp2_down&#45;&gt;add_5 -->
<g id="edge221" class="edge">
<title>mlp2_down&#45;&gt;add_5</title>
<path fill="none" stroke="black" d="M7352,-910C7352,-902.3 7352,-893.14 7352,-884.58"/>
<polygon fill="black" stroke="black" points="7355.5,-884.58 7352,-874.58 7348.5,-884.58 7355.5,-884.58"/>
</g>
<!-- ln3_pre -->
<g id="node146" class="node">
<title>ln3_pre</title>
<polygon fill="lightcoral" stroke="black" points="7415.5,-800.17 7248.5,-800.17 7248.5,-762.17 7415.5,-762.17 7415.5,-800.17"/>
<text text-anchor="middle" x="7332" y="-784.97" font-family="Times,serif" font-size="14.00">LayerNorm (Layer 3)</text>
<text text-anchor="middle" x="7332" y="-769.97" font-family="Times,serif" font-size="14.00">GPU: all GPUs 8&#45;15</text>
</g>
<!-- add_5&#45;&gt;ln3_pre -->
<g id="edge223" class="edge">
<title>add_5&#45;&gt;ln3_pre</title>
<path fill="none" stroke="black" d="M7346.95,-836C7344.79,-828.21 7342.21,-818.94 7339.82,-810.3"/>
<polygon fill="black" stroke="black" points="7343.16,-809.28 7337.11,-800.58 7336.42,-811.15 7343.16,-809.28"/>
</g>
<!-- q_proj_3_0 -->
<g id="node147" class="node">
<title>q_proj_3_0</title>
<polygon fill="lightblue" stroke="black" points="6154,-726.17 6070,-726.17 6070,-688.17 6154,-688.17 6154,-726.17"/>
<text text-anchor="middle" x="6112" y="-710.97" font-family="Times,serif" font-size="14.00">Q Proj L3</text>
<text text-anchor="middle" x="6112" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ln3_pre&#45;&gt;q_proj_3_0 -->
<g id="edge224" class="edge">
<title>ln3_pre&#45;&gt;q_proj_3_0</title>
<path fill="none" stroke="black" d="M7248.17,-779.41C7016.67,-776.81 6371.95,-766.1 6164,-726.17 6163.9,-726.15 6163.79,-726.13 6163.69,-726.11"/>
<polygon fill="black" stroke="black" points="6164.54,-722.71 6154.01,-723.84 6162.95,-729.53 6164.54,-722.71"/>
</g>
<!-- k_proj_3_0 -->
<g id="node148" class="node">
<title>k_proj_3_0</title>
<polygon fill="lightblue" stroke="black" points="6255.5,-726.17 6172.5,-726.17 6172.5,-688.17 6255.5,-688.17 6255.5,-726.17"/>
<text text-anchor="middle" x="6214" y="-710.97" font-family="Times,serif" font-size="14.00">K Proj L3</text>
<text text-anchor="middle" x="6214" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ln3_pre&#45;&gt;k_proj_3_0 -->
<g id="edge225" class="edge">
<title>ln3_pre&#45;&gt;k_proj_3_0</title>
<path fill="none" stroke="black" d="M7248.43,-779.04C7034.83,-775.69 6471.87,-763.65 6265.88,-725.91"/>
<polygon fill="black" stroke="black" points="6266.24,-722.42 6255.76,-723.98 6264.92,-729.29 6266.24,-722.42"/>
</g>
<!-- v_proj_3_0 -->
<g id="node149" class="node">
<title>v_proj_3_0</title>
<polygon fill="lightblue" stroke="black" points="6356.5,-726.17 6273.5,-726.17 6273.5,-688.17 6356.5,-688.17 6356.5,-726.17"/>
<text text-anchor="middle" x="6315" y="-710.97" font-family="Times,serif" font-size="14.00">V Proj L3</text>
<text text-anchor="middle" x="6315" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ln3_pre&#45;&gt;v_proj_3_0 -->
<g id="edge226" class="edge">
<title>ln3_pre&#45;&gt;v_proj_3_0</title>
<path fill="none" stroke="black" d="M7248.3,-778.53C7049.44,-774.15 6552.09,-760.25 6366.67,-725.88"/>
<polygon fill="black" stroke="black" points="6367.24,-722.42 6356.76,-723.96 6365.91,-729.3 6367.24,-722.42"/>
</g>
<!-- q_proj_3_1 -->
<g id="node152" class="node">
<title>q_proj_3_1</title>
<polygon fill="lightblue" stroke="black" points="6459,-726.17 6375,-726.17 6375,-688.17 6459,-688.17 6459,-726.17"/>
<text text-anchor="middle" x="6417" y="-710.97" font-family="Times,serif" font-size="14.00">Q Proj L3</text>
<text text-anchor="middle" x="6417" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ln3_pre&#45;&gt;q_proj_3_1 -->
<g id="edge232" class="edge">
<title>ln3_pre&#45;&gt;q_proj_3_1</title>
<path fill="none" stroke="black" d="M7248.36,-777.81C7061.79,-772.1 6616.47,-755.73 6469,-726.17 6468.9,-726.15 6468.8,-726.13 6468.69,-726.1"/>
<polygon fill="black" stroke="black" points="6469.56,-722.71 6459.02,-723.78 6467.93,-729.52 6469.56,-722.71"/>
</g>
<!-- k_proj_3_1 -->
<g id="node153" class="node">
<title>k_proj_3_1</title>
<polygon fill="lightblue" stroke="black" points="6560.5,-726.17 6477.5,-726.17 6477.5,-688.17 6560.5,-688.17 6560.5,-726.17"/>
<text text-anchor="middle" x="6519" y="-710.97" font-family="Times,serif" font-size="14.00">K Proj L3</text>
<text text-anchor="middle" x="6519" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ln3_pre&#45;&gt;k_proj_3_1 -->
<g id="edge233" class="edge">
<title>ln3_pre&#45;&gt;k_proj_3_1</title>
<path fill="none" stroke="black" d="M7248.32,-777.07C7082.24,-770.47 6715.3,-753.51 6570.79,-725.92"/>
<polygon fill="black" stroke="black" points="6571.26,-722.44 6560.77,-723.91 6569.89,-729.31 6571.26,-722.44"/>
</g>
<!-- v_proj_3_1 -->
<g id="node154" class="node">
<title>v_proj_3_1</title>
<polygon fill="lightblue" stroke="black" points="6661.5,-726.17 6578.5,-726.17 6578.5,-688.17 6661.5,-688.17 6661.5,-726.17"/>
<text text-anchor="middle" x="6620" y="-710.97" font-family="Times,serif" font-size="14.00">V Proj L3</text>
<text text-anchor="middle" x="6620" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ln3_pre&#45;&gt;v_proj_3_1 -->
<g id="edge234" class="edge">
<title>ln3_pre&#45;&gt;v_proj_3_1</title>
<path fill="none" stroke="black" d="M7248.3,-780.19C7123.84,-778.72 6882.91,-770.06 6671.81,-726"/>
<polygon fill="black" stroke="black" points="6672.29,-722.52 6661.78,-723.87 6670.84,-729.37 6672.29,-722.52"/>
</g>
<!-- q_proj_3_2 -->
<g id="node157" class="node">
<title>q_proj_3_2</title>
<polygon fill="lightblue" stroke="black" points="6764,-726.17 6680,-726.17 6680,-688.17 6764,-688.17 6764,-726.17"/>
<text text-anchor="middle" x="6722" y="-710.97" font-family="Times,serif" font-size="14.00">Q Proj L3</text>
<text text-anchor="middle" x="6722" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ln3_pre&#45;&gt;q_proj_3_2 -->
<g id="edge240" class="edge">
<title>ln3_pre&#45;&gt;q_proj_3_2</title>
<path fill="none" stroke="black" d="M7248.33,-778.23C7138.35,-774.28 6939.69,-762.33 6774,-726.17 6773.9,-726.14 6773.8,-726.12 6773.69,-726.1"/>
<polygon fill="black" stroke="black" points="6774.6,-722.72 6764.05,-723.66 6772.88,-729.5 6774.6,-722.72"/>
</g>
<!-- k_proj_3_2 -->
<g id="node158" class="node">
<title>k_proj_3_2</title>
<polygon fill="lightblue" stroke="black" points="6865.5,-726.17 6782.5,-726.17 6782.5,-688.17 6865.5,-688.17 6865.5,-726.17"/>
<text text-anchor="middle" x="6824" y="-710.97" font-family="Times,serif" font-size="14.00">K Proj L3</text>
<text text-anchor="middle" x="6824" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ln3_pre&#45;&gt;k_proj_3_2 -->
<g id="edge241" class="edge">
<title>ln3_pre&#45;&gt;k_proj_3_2</title>
<path fill="none" stroke="black" d="M7248.49,-775.86C7158.38,-769.97 7010.82,-756.69 6875.65,-726"/>
<polygon fill="black" stroke="black" points="6876.06,-722.51 6865.53,-723.67 6874.48,-729.33 6876.06,-722.51"/>
</g>
<!-- v_proj_3_2 -->
<g id="node159" class="node">
<title>v_proj_3_2</title>
<polygon fill="lightblue" stroke="black" points="6966.5,-726.17 6883.5,-726.17 6883.5,-688.17 6966.5,-688.17 6966.5,-726.17"/>
<text text-anchor="middle" x="6925" y="-710.97" font-family="Times,serif" font-size="14.00">V Proj L3</text>
<text text-anchor="middle" x="6925" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ln3_pre&#45;&gt;v_proj_3_2 -->
<g id="edge242" class="edge">
<title>ln3_pre&#45;&gt;v_proj_3_2</title>
<path fill="none" stroke="black" d="M7248.4,-772C7178.03,-764.09 7074.79,-750.07 6976.37,-725.99"/>
<polygon fill="black" stroke="black" points="6977.1,-722.57 6966.55,-723.55 6975.41,-729.36 6977.1,-722.57"/>
</g>
<!-- q_proj_3_3 -->
<g id="node162" class="node">
<title>q_proj_3_3</title>
<polygon fill="lightblue" stroke="black" points="7069,-726.17 6985,-726.17 6985,-688.17 7069,-688.17 7069,-726.17"/>
<text text-anchor="middle" x="7027" y="-710.97" font-family="Times,serif" font-size="14.00">Q Proj L3</text>
<text text-anchor="middle" x="7027" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ln3_pre&#45;&gt;q_proj_3_3 -->
<g id="edge248" class="edge">
<title>ln3_pre&#45;&gt;q_proj_3_3</title>
<path fill="none" stroke="black" d="M7248.48,-765.02C7198.86,-755.36 7134.92,-741.75 7079,-726.17 7078.9,-726.14 7078.8,-726.11 7078.7,-726.08"/>
<polygon fill="black" stroke="black" points="7079.73,-722.74 7069.15,-723.24 7077.74,-729.45 7079.73,-722.74"/>
</g>
<!-- k_proj_3_3 -->
<g id="node163" class="node">
<title>k_proj_3_3</title>
<polygon fill="lightblue" stroke="black" points="7170.5,-726.17 7087.5,-726.17 7087.5,-688.17 7170.5,-688.17 7170.5,-726.17"/>
<text text-anchor="middle" x="7129" y="-710.97" font-family="Times,serif" font-size="14.00">K Proj L3</text>
<text text-anchor="middle" x="7129" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ln3_pre&#45;&gt;k_proj_3_3 -->
<g id="edge249" class="edge">
<title>ln3_pre&#45;&gt;k_proj_3_3</title>
<path fill="none" stroke="black" d="M7281.04,-762.09C7250.3,-751.19 7211.27,-737.35 7180.45,-726.41"/>
<polygon fill="black" stroke="black" points="7181.35,-723.02 7170.75,-722.98 7179.01,-729.62 7181.35,-723.02"/>
</g>
<!-- v_proj_3_3 -->
<g id="node164" class="node">
<title>v_proj_3_3</title>
<polygon fill="lightblue" stroke="black" points="7271.5,-726.17 7188.5,-726.17 7188.5,-688.17 7271.5,-688.17 7271.5,-726.17"/>
<text text-anchor="middle" x="7230" y="-710.97" font-family="Times,serif" font-size="14.00">V Proj L3</text>
<text text-anchor="middle" x="7230" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ln3_pre&#45;&gt;v_proj_3_3 -->
<g id="edge250" class="edge">
<title>ln3_pre&#45;&gt;v_proj_3_3</title>
<path fill="none" stroke="black" d="M7306.26,-762C7293.46,-752.96 7277.81,-741.91 7264.03,-732.19"/>
<polygon fill="black" stroke="black" points="7265.92,-729.24 7255.73,-726.33 7261.88,-734.96 7265.92,-729.24"/>
</g>
<!-- q_proj_3_4 -->
<g id="node167" class="node">
<title>q_proj_3_4</title>
<polygon fill="lightblue" stroke="black" points="7374,-726.17 7290,-726.17 7290,-688.17 7374,-688.17 7374,-726.17"/>
<text text-anchor="middle" x="7332" y="-710.97" font-family="Times,serif" font-size="14.00">Q Proj L3</text>
<text text-anchor="middle" x="7332" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ln3_pre&#45;&gt;q_proj_3_4 -->
<g id="edge256" class="edge">
<title>ln3_pre&#45;&gt;q_proj_3_4</title>
<path fill="none" stroke="black" d="M7332,-762C7332,-754.3 7332,-745.14 7332,-736.58"/>
<polygon fill="black" stroke="black" points="7335.5,-736.58 7332,-726.58 7328.5,-736.58 7335.5,-736.58"/>
</g>
<!-- k_proj_3_4 -->
<g id="node168" class="node">
<title>k_proj_3_4</title>
<polygon fill="lightblue" stroke="black" points="7475.5,-726.17 7392.5,-726.17 7392.5,-688.17 7475.5,-688.17 7475.5,-726.17"/>
<text text-anchor="middle" x="7434" y="-710.97" font-family="Times,serif" font-size="14.00">K Proj L3</text>
<text text-anchor="middle" x="7434" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ln3_pre&#45;&gt;k_proj_3_4 -->
<g id="edge257" class="edge">
<title>ln3_pre&#45;&gt;k_proj_3_4</title>
<path fill="none" stroke="black" d="M7357.74,-762C7370.54,-752.96 7386.19,-741.91 7399.97,-732.19"/>
<polygon fill="black" stroke="black" points="7402.12,-734.96 7408.27,-726.33 7398.08,-729.24 7402.12,-734.96"/>
</g>
<!-- v_proj_3_4 -->
<g id="node169" class="node">
<title>v_proj_3_4</title>
<polygon fill="lightblue" stroke="black" points="7576.5,-726.17 7493.5,-726.17 7493.5,-688.17 7576.5,-688.17 7576.5,-726.17"/>
<text text-anchor="middle" x="7535" y="-710.97" font-family="Times,serif" font-size="14.00">V Proj L3</text>
<text text-anchor="middle" x="7535" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ln3_pre&#45;&gt;v_proj_3_4 -->
<g id="edge258" class="edge">
<title>ln3_pre&#45;&gt;v_proj_3_4</title>
<path fill="none" stroke="black" d="M7383.38,-762.12C7410.77,-752.48 7445.27,-740.31 7483.47,-726.7"/>
<polygon fill="black" stroke="black" points="7485.02,-729.87 7493.27,-723.21 7482.67,-723.27 7485.02,-729.87"/>
</g>
<!-- q_proj_3_5 -->
<g id="node172" class="node">
<title>q_proj_3_5</title>
<polygon fill="lightblue" stroke="black" points="7679,-726.17 7595,-726.17 7595,-688.17 7679,-688.17 7679,-726.17"/>
<text text-anchor="middle" x="7637" y="-710.97" font-family="Times,serif" font-size="14.00">Q Proj L3</text>
<text text-anchor="middle" x="7637" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ln3_pre&#45;&gt;q_proj_3_5 -->
<g id="edge264" class="edge">
<title>ln3_pre&#45;&gt;q_proj_3_5</title>
<path fill="none" stroke="black" d="M7415.6,-765.23C7462.93,-756.11 7523.3,-743.36 7584.93,-726.3"/>
<polygon fill="black" stroke="black" points="7586.15,-729.59 7594.83,-723.52 7584.26,-722.85 7586.15,-729.59"/>
</g>
<!-- k_proj_3_5 -->
<g id="node173" class="node">
<title>k_proj_3_5</title>
<polygon fill="lightblue" stroke="black" points="7780.5,-726.17 7697.5,-726.17 7697.5,-688.17 7780.5,-688.17 7780.5,-726.17"/>
<text text-anchor="middle" x="7739" y="-710.97" font-family="Times,serif" font-size="14.00">K Proj L3</text>
<text text-anchor="middle" x="7739" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ln3_pre&#45;&gt;k_proj_3_5 -->
<g id="edge265" class="edge">
<title>ln3_pre&#45;&gt;k_proj_3_5</title>
<path fill="none" stroke="black" d="M7415.6,-772C7485.97,-764.09 7589.21,-750.07 7687.63,-725.99"/>
<polygon fill="black" stroke="black" points="7688.59,-729.36 7697.45,-723.55 7686.9,-722.57 7688.59,-729.36"/>
</g>
<!-- v_proj_3_5 -->
<g id="node174" class="node">
<title>v_proj_3_5</title>
<polygon fill="lightblue" stroke="black" points="7881.5,-726.17 7798.5,-726.17 7798.5,-688.17 7881.5,-688.17 7881.5,-726.17"/>
<text text-anchor="middle" x="7840" y="-710.97" font-family="Times,serif" font-size="14.00">V Proj L3</text>
<text text-anchor="middle" x="7840" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ln3_pre&#45;&gt;v_proj_3_5 -->
<g id="edge266" class="edge">
<title>ln3_pre&#45;&gt;v_proj_3_5</title>
<path fill="none" stroke="black" d="M7415.73,-776.04C7506.06,-770.29 7653.98,-757.13 7788.41,-726.27"/>
<polygon fill="black" stroke="black" points="7789.53,-729.6 7798.47,-723.92 7787.94,-722.78 7789.53,-729.6"/>
</g>
<!-- q_proj_3_6 -->
<g id="node177" class="node">
<title>q_proj_3_6</title>
<polygon fill="lightblue" stroke="black" points="7984,-726.17 7900,-726.17 7900,-688.17 7984,-688.17 7984,-726.17"/>
<text text-anchor="middle" x="7942" y="-710.97" font-family="Times,serif" font-size="14.00">Q Proj L3</text>
<text text-anchor="middle" x="7942" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ln3_pre&#45;&gt;q_proj_3_6 -->
<g id="edge272" class="edge">
<title>ln3_pre&#45;&gt;q_proj_3_6</title>
<path fill="none" stroke="black" d="M7415.86,-778.39C7523.97,-774.7 7717.57,-763.32 7889.92,-726.1"/>
<polygon fill="black" stroke="black" points="7890.91,-729.46 7899.93,-723.9 7889.41,-722.63 7890.91,-729.46"/>
</g>
<!-- k_proj_3_6 -->
<g id="node178" class="node">
<title>k_proj_3_6</title>
<polygon fill="lightblue" stroke="black" points="8085.5,-726.17 8002.5,-726.17 8002.5,-688.17 8085.5,-688.17 8085.5,-726.17"/>
<text text-anchor="middle" x="8044" y="-710.97" font-family="Times,serif" font-size="14.00">K Proj L3</text>
<text text-anchor="middle" x="8044" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ln3_pre&#45;&gt;k_proj_3_6 -->
<g id="edge273" class="edge">
<title>ln3_pre&#45;&gt;k_proj_3_6</title>
<path fill="none" stroke="black" d="M7415.7,-780.19C7540.16,-778.72 7781.09,-770.06 7992.19,-726"/>
<polygon fill="black" stroke="black" points="7993.16,-729.37 8002.22,-723.87 7991.71,-722.52 7993.16,-729.37"/>
</g>
<!-- v_proj_3_6 -->
<g id="node179" class="node">
<title>v_proj_3_6</title>
<polygon fill="lightblue" stroke="black" points="8186.5,-726.17 8103.5,-726.17 8103.5,-688.17 8186.5,-688.17 8186.5,-726.17"/>
<text text-anchor="middle" x="8145" y="-710.97" font-family="Times,serif" font-size="14.00">V Proj L3</text>
<text text-anchor="middle" x="8145" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ln3_pre&#45;&gt;v_proj_3_6 -->
<g id="edge274" class="edge">
<title>ln3_pre&#45;&gt;v_proj_3_6</title>
<path fill="none" stroke="black" d="M7415.8,-777.14C7582.13,-770.67 7949.59,-753.93 8093.28,-726.16"/>
<polygon fill="black" stroke="black" points="8094.13,-729.56 8103.23,-724.15 8092.73,-722.7 8094.13,-729.56"/>
</g>
<!-- q_proj_3_7 -->
<g id="node182" class="node">
<title>q_proj_3_7</title>
<polygon fill="lightblue" stroke="black" points="8289,-726.17 8205,-726.17 8205,-688.17 8289,-688.17 8289,-726.17"/>
<text text-anchor="middle" x="8247" y="-710.97" font-family="Times,serif" font-size="14.00">Q Proj L3</text>
<text text-anchor="middle" x="8247" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ln3_pre&#45;&gt;q_proj_3_7 -->
<g id="edge280" class="edge">
<title>ln3_pre&#45;&gt;q_proj_3_7</title>
<path fill="none" stroke="black" d="M7415.75,-777.88C7598.73,-772.42 8030.27,-756.86 8194.97,-725.98"/>
<polygon fill="black" stroke="black" points="8195.82,-729.38 8204.95,-724.02 8194.47,-722.51 8195.82,-729.38"/>
</g>
<!-- k_proj_3_7 -->
<g id="node183" class="node">
<title>k_proj_3_7</title>
<polygon fill="lightblue" stroke="black" points="8390.5,-726.17 8307.5,-726.17 8307.5,-688.17 8390.5,-688.17 8390.5,-726.17"/>
<text text-anchor="middle" x="8349" y="-710.97" font-family="Times,serif" font-size="14.00">K Proj L3</text>
<text text-anchor="middle" x="8349" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ln3_pre&#45;&gt;k_proj_3_7 -->
<g id="edge281" class="edge">
<title>ln3_pre&#45;&gt;k_proj_3_7</title>
<path fill="none" stroke="black" d="M7415.7,-778.53C7614.56,-774.15 8111.91,-760.25 8297.33,-725.88"/>
<polygon fill="black" stroke="black" points="8298.09,-729.3 8307.24,-723.96 8296.76,-722.42 8298.09,-729.3"/>
</g>
<!-- v_proj_3_7 -->
<g id="node184" class="node">
<title>v_proj_3_7</title>
<polygon fill="lightblue" stroke="black" points="8491.5,-726.17 8408.5,-726.17 8408.5,-688.17 8491.5,-688.17 8491.5,-726.17"/>
<text text-anchor="middle" x="8450" y="-710.97" font-family="Times,serif" font-size="14.00">V Proj L3</text>
<text text-anchor="middle" x="8450" y="-695.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ln3_pre&#45;&gt;v_proj_3_7 -->
<g id="edge282" class="edge">
<title>ln3_pre&#45;&gt;v_proj_3_7</title>
<path fill="none" stroke="black" d="M7415.66,-779.11C7629.5,-775.93 8193.05,-764.25 8398.17,-726.16"/>
<polygon fill="black" stroke="black" points="8399.09,-729.55 8408.24,-724.21 8397.76,-722.67 8399.09,-729.55"/>
</g>
<!-- attention_3_0 -->
<g id="node150" class="node">
<title>attention_3_0</title>
<path fill="gold" stroke="black" d="M6289.5,-652.17C6289.5,-652.17 6238.5,-652.17 6238.5,-652.17 6232.5,-652.17 6226.5,-646.17 6226.5,-640.17 6226.5,-640.17 6226.5,-626.17 6226.5,-626.17 6226.5,-620.17 6232.5,-614.17 6238.5,-614.17 6238.5,-614.17 6289.5,-614.17 6289.5,-614.17 6295.5,-614.17 6301.5,-620.17 6301.5,-626.17 6301.5,-626.17 6301.5,-640.17 6301.5,-640.17 6301.5,-646.17 6295.5,-652.17 6289.5,-652.17"/>
<text text-anchor="middle" x="6264" y="-636.97" font-family="Times,serif" font-size="14.00">MHA L3</text>
<text text-anchor="middle" x="6264" y="-621.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- q_proj_3_0&#45;&gt;attention_3_0 -->
<g id="edge227" class="edge">
<title>q_proj_3_0&#45;&gt;attention_3_0</title>
<path fill="none" stroke="black" d="M6150.36,-688C6170.66,-678.38 6195.75,-666.49 6217.19,-656.34"/>
<polygon fill="black" stroke="black" points="6218.91,-659.4 6226.45,-651.96 6215.91,-653.07 6218.91,-659.4"/>
</g>
<!-- k_proj_3_0&#45;&gt;attention_3_0 -->
<g id="edge228" class="edge">
<title>k_proj_3_0&#45;&gt;attention_3_0</title>
<path fill="none" stroke="black" d="M6226.62,-688C6232.32,-679.79 6239.17,-669.93 6245.44,-660.9"/>
<polygon fill="black" stroke="black" points="6248.38,-662.79 6251.21,-652.58 6242.63,-658.8 6248.38,-662.79"/>
</g>
<!-- v_proj_3_0&#45;&gt;attention_3_0 -->
<g id="edge229" class="edge">
<title>v_proj_3_0&#45;&gt;attention_3_0</title>
<path fill="none" stroke="black" d="M6302.13,-688C6296.32,-679.79 6289.33,-669.93 6282.94,-660.9"/>
<polygon fill="black" stroke="black" points="6285.68,-658.72 6277.04,-652.58 6279.97,-662.76 6285.68,-658.72"/>
</g>
<!-- o_proj_3_0 -->
<g id="node151" class="node">
<title>o_proj_3_0</title>
<polygon fill="lightblue" stroke="black" points="6377,-578.17 6293,-578.17 6293,-540.17 6377,-540.17 6377,-578.17"/>
<text text-anchor="middle" x="6335" y="-562.97" font-family="Times,serif" font-size="14.00">O Proj L3</text>
<text text-anchor="middle" x="6335" y="-547.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- attention_3_0&#45;&gt;o_proj_3_0 -->
<g id="edge230" class="edge">
<title>attention_3_0&#45;&gt;o_proj_3_0</title>
<path fill="none" stroke="black" d="M6281.92,-614C6290.34,-605.45 6300.54,-595.11 6309.74,-585.79"/>
<polygon fill="black" stroke="black" points="6312.31,-588.16 6316.84,-578.58 6307.33,-583.24 6312.31,-588.16"/>
</g>
<!-- all_reduce_3 -->
<g id="node187" class="node">
<title>all_reduce_3</title>
<polygon fill="orange" stroke="black" points="7453.89,-504.17 7197.95,-504.17 7132.11,-428.17 7388.05,-428.17 7453.89,-504.17"/>
<text text-anchor="middle" x="7293" y="-469.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce L3</text>
<text text-anchor="middle" x="7293" y="-454.97" font-family="Times,serif" font-size="14.00">GPU: all GPUs 8&#45;15</text>
</g>
<!-- o_proj_3_0&#45;&gt;all_reduce_3 -->
<g id="edge231" class="edge">
<title>o_proj_3_0&#45;&gt;all_reduce_3</title>
<path fill="none" stroke="black" d="M6377.09,-554.17C6513.51,-541.21 6947.2,-500.01 7165.25,-479.3"/>
<polygon fill="black" stroke="black" points="7165.85,-482.76 7175.47,-478.33 7165.18,-475.79 7165.85,-482.76"/>
</g>
<!-- attention_3_1 -->
<g id="node155" class="node">
<title>attention_3_1</title>
<path fill="gold" stroke="black" d="M6594.5,-652.17C6594.5,-652.17 6543.5,-652.17 6543.5,-652.17 6537.5,-652.17 6531.5,-646.17 6531.5,-640.17 6531.5,-640.17 6531.5,-626.17 6531.5,-626.17 6531.5,-620.17 6537.5,-614.17 6543.5,-614.17 6543.5,-614.17 6594.5,-614.17 6594.5,-614.17 6600.5,-614.17 6606.5,-620.17 6606.5,-626.17 6606.5,-626.17 6606.5,-640.17 6606.5,-640.17 6606.5,-646.17 6600.5,-652.17 6594.5,-652.17"/>
<text text-anchor="middle" x="6569" y="-636.97" font-family="Times,serif" font-size="14.00">MHA L3</text>
<text text-anchor="middle" x="6569" y="-621.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- q_proj_3_1&#45;&gt;attention_3_1 -->
<g id="edge235" class="edge">
<title>q_proj_3_1&#45;&gt;attention_3_1</title>
<path fill="none" stroke="black" d="M6455.36,-688C6475.66,-678.38 6500.75,-666.49 6522.19,-656.34"/>
<polygon fill="black" stroke="black" points="6523.91,-659.4 6531.45,-651.96 6520.91,-653.07 6523.91,-659.4"/>
</g>
<!-- k_proj_3_1&#45;&gt;attention_3_1 -->
<g id="edge236" class="edge">
<title>k_proj_3_1&#45;&gt;attention_3_1</title>
<path fill="none" stroke="black" d="M6531.62,-688C6537.32,-679.79 6544.17,-669.93 6550.44,-660.9"/>
<polygon fill="black" stroke="black" points="6553.38,-662.79 6556.21,-652.58 6547.63,-658.8 6553.38,-662.79"/>
</g>
<!-- v_proj_3_1&#45;&gt;attention_3_1 -->
<g id="edge237" class="edge">
<title>v_proj_3_1&#45;&gt;attention_3_1</title>
<path fill="none" stroke="black" d="M6607.13,-688C6601.32,-679.79 6594.33,-669.93 6587.94,-660.9"/>
<polygon fill="black" stroke="black" points="6590.68,-658.72 6582.04,-652.58 6584.97,-662.76 6590.68,-658.72"/>
</g>
<!-- o_proj_3_1 -->
<g id="node156" class="node">
<title>o_proj_3_1</title>
<polygon fill="lightblue" stroke="black" points="6808,-578.17 6724,-578.17 6724,-540.17 6808,-540.17 6808,-578.17"/>
<text text-anchor="middle" x="6766" y="-562.97" font-family="Times,serif" font-size="14.00">O Proj L3</text>
<text text-anchor="middle" x="6766" y="-547.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- attention_3_1&#45;&gt;o_proj_3_1 -->
<g id="edge238" class="edge">
<title>attention_3_1&#45;&gt;o_proj_3_1</title>
<path fill="none" stroke="black" d="M6606.52,-618.45C6637,-607.31 6680.33,-591.48 6714.13,-579.12"/>
<polygon fill="black" stroke="black" points="6715.65,-582.3 6723.84,-575.58 6713.25,-575.72 6715.65,-582.3"/>
</g>
<!-- o_proj_3_1&#45;&gt;all_reduce_3 -->
<g id="edge239" class="edge">
<title>o_proj_3_1&#45;&gt;all_reduce_3</title>
<path fill="none" stroke="black" d="M6808.24,-550.87C6886.32,-537.39 7055.88,-508.11 7172.24,-488.02"/>
<polygon fill="black" stroke="black" points="7173.02,-491.44 7182.28,-486.29 7171.83,-484.54 7173.02,-491.44"/>
</g>
<!-- attention_3_2 -->
<g id="node160" class="node">
<title>attention_3_2</title>
<path fill="gold" stroke="black" d="M6899.5,-652.17C6899.5,-652.17 6848.5,-652.17 6848.5,-652.17 6842.5,-652.17 6836.5,-646.17 6836.5,-640.17 6836.5,-640.17 6836.5,-626.17 6836.5,-626.17 6836.5,-620.17 6842.5,-614.17 6848.5,-614.17 6848.5,-614.17 6899.5,-614.17 6899.5,-614.17 6905.5,-614.17 6911.5,-620.17 6911.5,-626.17 6911.5,-626.17 6911.5,-640.17 6911.5,-640.17 6911.5,-646.17 6905.5,-652.17 6899.5,-652.17"/>
<text text-anchor="middle" x="6874" y="-636.97" font-family="Times,serif" font-size="14.00">MHA L3</text>
<text text-anchor="middle" x="6874" y="-621.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- q_proj_3_2&#45;&gt;attention_3_2 -->
<g id="edge243" class="edge">
<title>q_proj_3_2&#45;&gt;attention_3_2</title>
<path fill="none" stroke="black" d="M6760.36,-688C6780.66,-678.38 6805.75,-666.49 6827.19,-656.34"/>
<polygon fill="black" stroke="black" points="6828.91,-659.4 6836.45,-651.96 6825.91,-653.07 6828.91,-659.4"/>
</g>
<!-- k_proj_3_2&#45;&gt;attention_3_2 -->
<g id="edge244" class="edge">
<title>k_proj_3_2&#45;&gt;attention_3_2</title>
<path fill="none" stroke="black" d="M6836.62,-688C6842.32,-679.79 6849.17,-669.93 6855.44,-660.9"/>
<polygon fill="black" stroke="black" points="6858.38,-662.79 6861.21,-652.58 6852.63,-658.8 6858.38,-662.79"/>
</g>
<!-- v_proj_3_2&#45;&gt;attention_3_2 -->
<g id="edge245" class="edge">
<title>v_proj_3_2&#45;&gt;attention_3_2</title>
<path fill="none" stroke="black" d="M6912.13,-688C6906.32,-679.79 6899.33,-669.93 6892.94,-660.9"/>
<polygon fill="black" stroke="black" points="6895.68,-658.72 6887.04,-652.58 6889.97,-662.76 6895.68,-658.72"/>
</g>
<!-- o_proj_3_2 -->
<g id="node161" class="node">
<title>o_proj_3_2</title>
<polygon fill="lightblue" stroke="black" points="7075,-578.17 6991,-578.17 6991,-540.17 7075,-540.17 7075,-578.17"/>
<text text-anchor="middle" x="7033" y="-562.97" font-family="Times,serif" font-size="14.00">O Proj L3</text>
<text text-anchor="middle" x="7033" y="-547.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- attention_3_2&#45;&gt;o_proj_3_2 -->
<g id="edge246" class="edge">
<title>attention_3_2&#45;&gt;o_proj_3_2</title>
<path fill="none" stroke="black" d="M6911.68,-615.1C6933.23,-605.34 6960.51,-592.99 6983.74,-582.47"/>
<polygon fill="black" stroke="black" points="6985.43,-585.55 6993.09,-578.24 6982.54,-579.18 6985.43,-585.55"/>
</g>
<!-- o_proj_3_2&#45;&gt;all_reduce_3 -->
<g id="edge247" class="edge">
<title>o_proj_3_2&#45;&gt;all_reduce_3</title>
<path fill="none" stroke="black" d="M7075.06,-543.44C7105.01,-532.96 7146.67,-518.38 7185.55,-504.77"/>
<polygon fill="black" stroke="black" points="7187.09,-507.94 7195.37,-501.34 7184.77,-501.34 7187.09,-507.94"/>
</g>
<!-- attention_3_3 -->
<g id="node165" class="node">
<title>attention_3_3</title>
<path fill="gold" stroke="black" d="M7192.5,-652.17C7192.5,-652.17 7141.5,-652.17 7141.5,-652.17 7135.5,-652.17 7129.5,-646.17 7129.5,-640.17 7129.5,-640.17 7129.5,-626.17 7129.5,-626.17 7129.5,-620.17 7135.5,-614.17 7141.5,-614.17 7141.5,-614.17 7192.5,-614.17 7192.5,-614.17 7198.5,-614.17 7204.5,-620.17 7204.5,-626.17 7204.5,-626.17 7204.5,-640.17 7204.5,-640.17 7204.5,-646.17 7198.5,-652.17 7192.5,-652.17"/>
<text text-anchor="middle" x="7167" y="-636.97" font-family="Times,serif" font-size="14.00">MHA L3</text>
<text text-anchor="middle" x="7167" y="-621.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- q_proj_3_3&#45;&gt;attention_3_3 -->
<g id="edge251" class="edge">
<title>q_proj_3_3&#45;&gt;attention_3_3</title>
<path fill="none" stroke="black" d="M7062.33,-688C7080.65,-678.58 7103.21,-666.97 7122.69,-656.95"/>
<polygon fill="black" stroke="black" points="7124.39,-660.02 7131.68,-652.33 7121.19,-653.79 7124.39,-660.02"/>
</g>
<!-- k_proj_3_3&#45;&gt;attention_3_3 -->
<g id="edge252" class="edge">
<title>k_proj_3_3&#45;&gt;attention_3_3</title>
<path fill="none" stroke="black" d="M7138.59,-688C7142.83,-679.96 7147.91,-670.33 7152.6,-661.46"/>
<polygon fill="black" stroke="black" points="7155.71,-663.06 7157.28,-652.58 7149.52,-659.79 7155.71,-663.06"/>
</g>
<!-- v_proj_3_3&#45;&gt;attention_3_3 -->
<g id="edge253" class="edge">
<title>v_proj_3_3&#45;&gt;attention_3_3</title>
<path fill="none" stroke="black" d="M7214.1,-688C7206.77,-679.62 7197.93,-669.52 7189.9,-660.34"/>
<polygon fill="black" stroke="black" points="7192.33,-657.8 7183.11,-652.58 7187.06,-662.41 7192.33,-657.8"/>
</g>
<!-- o_proj_3_3 -->
<g id="node166" class="node">
<title>o_proj_3_3</title>
<polygon fill="lightblue" stroke="black" points="7259,-578.17 7175,-578.17 7175,-540.17 7259,-540.17 7259,-578.17"/>
<text text-anchor="middle" x="7217" y="-562.97" font-family="Times,serif" font-size="14.00">O Proj L3</text>
<text text-anchor="middle" x="7217" y="-547.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- attention_3_3&#45;&gt;o_proj_3_3 -->
<g id="edge254" class="edge">
<title>attention_3_3&#45;&gt;o_proj_3_3</title>
<path fill="none" stroke="black" d="M7179.62,-614C7185.32,-605.79 7192.17,-595.93 7198.44,-586.9"/>
<polygon fill="black" stroke="black" points="7201.38,-588.79 7204.21,-578.58 7195.63,-584.8 7201.38,-588.79"/>
</g>
<!-- o_proj_3_3&#45;&gt;all_reduce_3 -->
<g id="edge255" class="edge">
<title>o_proj_3_3&#45;&gt;all_reduce_3</title>
<path fill="none" stroke="black" d="M7232.38,-539.75C7239.09,-531.72 7247.27,-521.92 7255.43,-512.15"/>
<polygon fill="black" stroke="black" points="7258.22,-514.27 7261.94,-504.35 7252.85,-509.78 7258.22,-514.27"/>
</g>
<!-- attention_3_4 -->
<g id="node170" class="node">
<title>attention_3_4</title>
<path fill="gold" stroke="black" d="M7407.5,-652.17C7407.5,-652.17 7356.5,-652.17 7356.5,-652.17 7350.5,-652.17 7344.5,-646.17 7344.5,-640.17 7344.5,-640.17 7344.5,-626.17 7344.5,-626.17 7344.5,-620.17 7350.5,-614.17 7356.5,-614.17 7356.5,-614.17 7407.5,-614.17 7407.5,-614.17 7413.5,-614.17 7419.5,-620.17 7419.5,-626.17 7419.5,-626.17 7419.5,-640.17 7419.5,-640.17 7419.5,-646.17 7413.5,-652.17 7407.5,-652.17"/>
<text text-anchor="middle" x="7382" y="-636.97" font-family="Times,serif" font-size="14.00">MHA L3</text>
<text text-anchor="middle" x="7382" y="-621.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- q_proj_3_4&#45;&gt;attention_3_4 -->
<g id="edge259" class="edge">
<title>q_proj_3_4&#45;&gt;attention_3_4</title>
<path fill="none" stroke="black" d="M7344.62,-688C7350.32,-679.79 7357.17,-669.93 7363.44,-660.9"/>
<polygon fill="black" stroke="black" points="7366.38,-662.79 7369.21,-652.58 7360.63,-658.8 7366.38,-662.79"/>
</g>
<!-- k_proj_3_4&#45;&gt;attention_3_4 -->
<g id="edge260" class="edge">
<title>k_proj_3_4&#45;&gt;attention_3_4</title>
<path fill="none" stroke="black" d="M7420.88,-688C7414.95,-679.79 7407.83,-669.93 7401.31,-660.9"/>
<polygon fill="black" stroke="black" points="7403.99,-658.64 7395.3,-652.58 7398.32,-662.74 7403.99,-658.64"/>
</g>
<!-- v_proj_3_4&#45;&gt;attention_3_4 -->
<g id="edge261" class="edge">
<title>v_proj_3_4&#45;&gt;attention_3_4</title>
<path fill="none" stroke="black" d="M7496.39,-688C7475.88,-678.35 7450.5,-666.4 7428.87,-656.22"/>
<polygon fill="black" stroke="black" points="7430.08,-652.92 7419.54,-651.83 7427.1,-659.26 7430.08,-652.92"/>
</g>
<!-- o_proj_3_4 -->
<g id="node171" class="node">
<title>o_proj_3_4</title>
<polygon fill="lightblue" stroke="black" points="7399,-578.17 7315,-578.17 7315,-540.17 7399,-540.17 7399,-578.17"/>
<text text-anchor="middle" x="7357" y="-562.97" font-family="Times,serif" font-size="14.00">O Proj L3</text>
<text text-anchor="middle" x="7357" y="-547.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- attention_3_4&#45;&gt;o_proj_3_4 -->
<g id="edge262" class="edge">
<title>attention_3_4&#45;&gt;o_proj_3_4</title>
<path fill="none" stroke="black" d="M7375.69,-614C7372.99,-606.21 7369.77,-596.94 7366.77,-588.3"/>
<polygon fill="black" stroke="black" points="7369.98,-586.88 7363.39,-578.58 7363.37,-589.17 7369.98,-586.88"/>
</g>
<!-- o_proj_3_4&#45;&gt;all_reduce_3 -->
<g id="edge263" class="edge">
<title>o_proj_3_4&#45;&gt;all_reduce_3</title>
<path fill="none" stroke="black" d="M7344.05,-539.75C7338.51,-531.88 7331.78,-522.3 7325.04,-512.73"/>
<polygon fill="black" stroke="black" points="7327.77,-510.52 7319.15,-504.35 7322.04,-514.55 7327.77,-510.52"/>
</g>
<!-- attention_3_5 -->
<g id="node175" class="node">
<title>attention_3_5</title>
<path fill="gold" stroke="black" d="M7713.5,-652.17C7713.5,-652.17 7662.5,-652.17 7662.5,-652.17 7656.5,-652.17 7650.5,-646.17 7650.5,-640.17 7650.5,-640.17 7650.5,-626.17 7650.5,-626.17 7650.5,-620.17 7656.5,-614.17 7662.5,-614.17 7662.5,-614.17 7713.5,-614.17 7713.5,-614.17 7719.5,-614.17 7725.5,-620.17 7725.5,-626.17 7725.5,-626.17 7725.5,-640.17 7725.5,-640.17 7725.5,-646.17 7719.5,-652.17 7713.5,-652.17"/>
<text text-anchor="middle" x="7688" y="-636.97" font-family="Times,serif" font-size="14.00">MHA L3</text>
<text text-anchor="middle" x="7688" y="-621.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- q_proj_3_5&#45;&gt;attention_3_5 -->
<g id="edge267" class="edge">
<title>q_proj_3_5&#45;&gt;attention_3_5</title>
<path fill="none" stroke="black" d="M7649.87,-688C7655.68,-679.79 7662.67,-669.93 7669.06,-660.9"/>
<polygon fill="black" stroke="black" points="7672.03,-662.76 7674.96,-652.58 7666.32,-658.72 7672.03,-662.76"/>
</g>
<!-- k_proj_3_5&#45;&gt;attention_3_5 -->
<g id="edge268" class="edge">
<title>k_proj_3_5&#45;&gt;attention_3_5</title>
<path fill="none" stroke="black" d="M7726.13,-688C7720.32,-679.79 7713.33,-669.93 7706.94,-660.9"/>
<polygon fill="black" stroke="black" points="7709.68,-658.72 7701.04,-652.58 7703.97,-662.76 7709.68,-658.72"/>
</g>
<!-- v_proj_3_5&#45;&gt;attention_3_5 -->
<g id="edge269" class="edge">
<title>v_proj_3_5&#45;&gt;attention_3_5</title>
<path fill="none" stroke="black" d="M7801.64,-688C7781.34,-678.38 7756.25,-666.49 7734.81,-656.34"/>
<polygon fill="black" stroke="black" points="7736.09,-653.07 7725.55,-651.96 7733.09,-659.4 7736.09,-653.07"/>
</g>
<!-- o_proj_3_5 -->
<g id="node176" class="node">
<title>o_proj_3_5</title>
<polygon fill="lightblue" stroke="black" points="7628,-578.17 7544,-578.17 7544,-540.17 7628,-540.17 7628,-578.17"/>
<text text-anchor="middle" x="7586" y="-562.97" font-family="Times,serif" font-size="14.00">O Proj L3</text>
<text text-anchor="middle" x="7586" y="-547.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- attention_3_5&#45;&gt;o_proj_3_5 -->
<g id="edge270" class="edge">
<title>attention_3_5&#45;&gt;o_proj_3_5</title>
<path fill="none" stroke="black" d="M7662.26,-614C7649.46,-604.96 7633.81,-593.91 7620.03,-584.19"/>
<polygon fill="black" stroke="black" points="7621.92,-581.24 7611.73,-578.33 7617.88,-586.96 7621.92,-581.24"/>
</g>
<!-- o_proj_3_5&#45;&gt;all_reduce_3 -->
<g id="edge271" class="edge">
<title>o_proj_3_5&#45;&gt;all_reduce_3</title>
<path fill="none" stroke="black" d="M7543.71,-545.03C7511.6,-535.06 7465.63,-520.78 7421.81,-507.17"/>
<polygon fill="black" stroke="black" points="7422.8,-503.81 7412.21,-504.19 7420.72,-510.5 7422.8,-503.81"/>
</g>
<!-- attention_3_6 -->
<g id="node180" class="node">
<title>attention_3_6</title>
<path fill="gold" stroke="black" d="M8018.5,-652.17C8018.5,-652.17 7967.5,-652.17 7967.5,-652.17 7961.5,-652.17 7955.5,-646.17 7955.5,-640.17 7955.5,-640.17 7955.5,-626.17 7955.5,-626.17 7955.5,-620.17 7961.5,-614.17 7967.5,-614.17 7967.5,-614.17 8018.5,-614.17 8018.5,-614.17 8024.5,-614.17 8030.5,-620.17 8030.5,-626.17 8030.5,-626.17 8030.5,-640.17 8030.5,-640.17 8030.5,-646.17 8024.5,-652.17 8018.5,-652.17"/>
<text text-anchor="middle" x="7993" y="-636.97" font-family="Times,serif" font-size="14.00">MHA L3</text>
<text text-anchor="middle" x="7993" y="-621.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- q_proj_3_6&#45;&gt;attention_3_6 -->
<g id="edge275" class="edge">
<title>q_proj_3_6&#45;&gt;attention_3_6</title>
<path fill="none" stroke="black" d="M7954.87,-688C7960.68,-679.79 7967.67,-669.93 7974.06,-660.9"/>
<polygon fill="black" stroke="black" points="7977.03,-662.76 7979.96,-652.58 7971.32,-658.72 7977.03,-662.76"/>
</g>
<!-- k_proj_3_6&#45;&gt;attention_3_6 -->
<g id="edge276" class="edge">
<title>k_proj_3_6&#45;&gt;attention_3_6</title>
<path fill="none" stroke="black" d="M8031.13,-688C8025.32,-679.79 8018.33,-669.93 8011.94,-660.9"/>
<polygon fill="black" stroke="black" points="8014.68,-658.72 8006.04,-652.58 8008.97,-662.76 8014.68,-658.72"/>
</g>
<!-- v_proj_3_6&#45;&gt;attention_3_6 -->
<g id="edge277" class="edge">
<title>v_proj_3_6&#45;&gt;attention_3_6</title>
<path fill="none" stroke="black" d="M8106.64,-688C8086.34,-678.38 8061.25,-666.49 8039.81,-656.34"/>
<polygon fill="black" stroke="black" points="8041.09,-653.07 8030.55,-651.96 8038.09,-659.4 8041.09,-653.07"/>
</g>
<!-- o_proj_3_6 -->
<g id="node181" class="node">
<title>o_proj_3_6</title>
<polygon fill="lightblue" stroke="black" points="7781,-578.17 7697,-578.17 7697,-540.17 7781,-540.17 7781,-578.17"/>
<text text-anchor="middle" x="7739" y="-562.97" font-family="Times,serif" font-size="14.00">O Proj L3</text>
<text text-anchor="middle" x="7739" y="-547.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- attention_3_6&#45;&gt;o_proj_3_6 -->
<g id="edge278" class="edge">
<title>attention_3_6&#45;&gt;o_proj_3_6</title>
<path fill="none" stroke="black" d="M7955.25,-621.47C7911.68,-609.11 7839.77,-588.73 7790.94,-574.89"/>
<polygon fill="black" stroke="black" points="7791.77,-571.49 7781.2,-572.13 7789.86,-578.22 7791.77,-571.49"/>
</g>
<!-- o_proj_3_6&#45;&gt;all_reduce_3 -->
<g id="edge279" class="edge">
<title>o_proj_3_6&#45;&gt;all_reduce_3</title>
<path fill="none" stroke="black" d="M7696.64,-549.52C7642.31,-538.44 7544.87,-518.56 7459.34,-501.11"/>
<polygon fill="black" stroke="black" points="7460.01,-497.67 7449.51,-499.1 7458.61,-504.53 7460.01,-497.67"/>
</g>
<!-- attention_3_7 -->
<g id="node185" class="node">
<title>attention_3_7</title>
<path fill="gold" stroke="black" d="M8323.5,-652.17C8323.5,-652.17 8272.5,-652.17 8272.5,-652.17 8266.5,-652.17 8260.5,-646.17 8260.5,-640.17 8260.5,-640.17 8260.5,-626.17 8260.5,-626.17 8260.5,-620.17 8266.5,-614.17 8272.5,-614.17 8272.5,-614.17 8323.5,-614.17 8323.5,-614.17 8329.5,-614.17 8335.5,-620.17 8335.5,-626.17 8335.5,-626.17 8335.5,-640.17 8335.5,-640.17 8335.5,-646.17 8329.5,-652.17 8323.5,-652.17"/>
<text text-anchor="middle" x="8298" y="-636.97" font-family="Times,serif" font-size="14.00">MHA L3</text>
<text text-anchor="middle" x="8298" y="-621.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- q_proj_3_7&#45;&gt;attention_3_7 -->
<g id="edge283" class="edge">
<title>q_proj_3_7&#45;&gt;attention_3_7</title>
<path fill="none" stroke="black" d="M8259.87,-688C8265.68,-679.79 8272.67,-669.93 8279.06,-660.9"/>
<polygon fill="black" stroke="black" points="8282.03,-662.76 8284.96,-652.58 8276.32,-658.72 8282.03,-662.76"/>
</g>
<!-- k_proj_3_7&#45;&gt;attention_3_7 -->
<g id="edge284" class="edge">
<title>k_proj_3_7&#45;&gt;attention_3_7</title>
<path fill="none" stroke="black" d="M8336.13,-688C8330.32,-679.79 8323.33,-669.93 8316.94,-660.9"/>
<polygon fill="black" stroke="black" points="8319.68,-658.72 8311.04,-652.58 8313.97,-662.76 8319.68,-658.72"/>
</g>
<!-- v_proj_3_7&#45;&gt;attention_3_7 -->
<g id="edge285" class="edge">
<title>v_proj_3_7&#45;&gt;attention_3_7</title>
<path fill="none" stroke="black" d="M8411.64,-688C8391.34,-678.38 8366.25,-666.49 8344.81,-656.34"/>
<polygon fill="black" stroke="black" points="8346.09,-653.07 8335.55,-651.96 8343.09,-659.4 8346.09,-653.07"/>
</g>
<!-- o_proj_3_7 -->
<g id="node186" class="node">
<title>o_proj_3_7</title>
<polygon fill="lightblue" stroke="black" points="8163,-578.17 8079,-578.17 8079,-540.17 8163,-540.17 8163,-578.17"/>
<text text-anchor="middle" x="8121" y="-562.97" font-family="Times,serif" font-size="14.00">O Proj L3</text>
<text text-anchor="middle" x="8121" y="-547.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- attention_3_7&#45;&gt;o_proj_3_7 -->
<g id="edge286" class="edge">
<title>attention_3_7&#45;&gt;o_proj_3_7</title>
<path fill="none" stroke="black" d="M8260.46,-616.9C8234.84,-606.48 8200.58,-592.54 8172.43,-581.09"/>
<polygon fill="black" stroke="black" points="8173.72,-577.83 8163.14,-577.31 8171.08,-584.32 8173.72,-577.83"/>
</g>
<!-- o_proj_3_7&#45;&gt;all_reduce_3 -->
<g id="edge287" class="edge">
<title>o_proj_3_7&#45;&gt;all_reduce_3</title>
<path fill="none" stroke="black" d="M8078.8,-553.53C7963.65,-540.87 7639.67,-505.27 7445.54,-483.93"/>
<polygon fill="black" stroke="black" points="7445.86,-480.44 7435.53,-482.83 7445.09,-487.4 7445.86,-480.44"/>
</g>
<!-- add_6 -->
<g id="node188" class="node">
<title>add_6</title>
<polygon fill="lightgray" stroke="black" points="7370.5,-392.17 7215.5,-392.17 7215.5,-354.17 7370.5,-354.17 7370.5,-392.17"/>
<text text-anchor="middle" x="7293" y="-376.97" font-family="Times,serif" font-size="14.00">Residual Add L3</text>
<text text-anchor="middle" x="7293" y="-361.97" font-family="Times,serif" font-size="14.00">GPU: all GPUs 8&#45;15</text>
</g>
<!-- all_reduce_3&#45;&gt;add_6 -->
<g id="edge288" class="edge">
<title>all_reduce_3&#45;&gt;add_6</title>
<path fill="none" stroke="black" d="M7293,-428.15C7293,-419.53 7293,-410.49 7293,-402.32"/>
<polygon fill="black" stroke="black" points="7296.5,-402.2 7293,-392.2 7289.5,-402.2 7296.5,-402.2"/>
</g>
<!-- mlp3_gate -->
<g id="node189" class="node">
<title>mlp3_gate</title>
<polygon fill="lightpink" stroke="black" points="7149.5,-318.17 6994.5,-318.17 6994.5,-280.17 7149.5,-280.17 7149.5,-318.17"/>
<text text-anchor="middle" x="7072" y="-302.97" font-family="Times,serif" font-size="14.00">MLP Gate L3</text>
<text text-anchor="middle" x="7072" y="-287.97" font-family="Times,serif" font-size="14.00">GPU: all GPUs 8&#45;15</text>
</g>
<!-- add_6&#45;&gt;mlp3_gate -->
<g id="edge290" class="edge">
<title>add_6&#45;&gt;mlp3_gate</title>
<path fill="none" stroke="black" d="M7237.52,-354.09C7207.04,-344.16 7169.07,-331.79 7137.19,-321.4"/>
<polygon fill="black" stroke="black" points="7138.1,-318.02 7127.51,-318.25 7135.93,-324.68 7138.1,-318.02"/>
</g>
<!-- mlp3_up -->
<g id="node190" class="node">
<title>mlp3_up</title>
<polygon fill="lightpink" stroke="black" points="7322.5,-318.17 7167.5,-318.17 7167.5,-280.17 7322.5,-280.17 7322.5,-318.17"/>
<text text-anchor="middle" x="7245" y="-302.97" font-family="Times,serif" font-size="14.00">MLP Up L3</text>
<text text-anchor="middle" x="7245" y="-287.97" font-family="Times,serif" font-size="14.00">GPU: all GPUs 8&#45;15</text>
</g>
<!-- add_6&#45;&gt;mlp3_up -->
<g id="edge291" class="edge">
<title>add_6&#45;&gt;mlp3_up</title>
<path fill="none" stroke="black" d="M7280.89,-354C7275.47,-345.87 7268.98,-336.13 7263.01,-327.18"/>
<polygon fill="black" stroke="black" points="7265.73,-324.96 7257.28,-318.58 7259.91,-328.84 7265.73,-324.96"/>
</g>
<!-- add_7 -->
<g id="node192" class="node">
<title>add_7</title>
<polygon fill="lightgray" stroke="black" points="7419.5,-170.17 7264.5,-170.17 7264.5,-132.17 7419.5,-132.17 7419.5,-170.17"/>
<text text-anchor="middle" x="7342" y="-154.97" font-family="Times,serif" font-size="14.00">Residual Add L3</text>
<text text-anchor="middle" x="7342" y="-139.97" font-family="Times,serif" font-size="14.00">GPU: all GPUs 8&#45;15</text>
</g>
<!-- add_6&#45;&gt;add_7 -->
<g id="edge295" class="edge">
<title>add_6&#45;&gt;add_7</title>
<path fill="none" stroke="black" d="M7302.3,-353.7C7309.47,-343.92 7318.34,-331.24 7323,-318.17 7339.46,-272.04 7338.5,-214.15 7338.59,-180.35"/>
<polygon fill="black" stroke="black" points="7342.09,-180.29 7338.68,-170.26 7335.09,-180.23 7342.09,-180.29"/>
</g>
<!-- mlp3_down -->
<g id="node191" class="node">
<title>mlp3_down</title>
<polygon fill="lightpink" stroke="black" points="7322.5,-244.17 7167.5,-244.17 7167.5,-206.17 7322.5,-206.17 7322.5,-244.17"/>
<text text-anchor="middle" x="7245" y="-228.97" font-family="Times,serif" font-size="14.00">MLP Down L3</text>
<text text-anchor="middle" x="7245" y="-213.97" font-family="Times,serif" font-size="14.00">GPU: all GPUs 8&#45;15</text>
</g>
<!-- mlp3_gate&#45;&gt;mlp3_down -->
<g id="edge292" class="edge">
<title>mlp3_gate&#45;&gt;mlp3_down</title>
<path fill="none" stroke="black" d="M7115.66,-280C7138.9,-270.33 7167.66,-258.36 7192.15,-248.16"/>
<polygon fill="black" stroke="black" points="7193.77,-251.28 7201.66,-244.2 7191.08,-244.82 7193.77,-251.28"/>
</g>
<!-- mlp3_up&#45;&gt;mlp3_down -->
<g id="edge293" class="edge">
<title>mlp3_up&#45;&gt;mlp3_down</title>
<path fill="none" stroke="black" d="M7245,-280C7245,-272.3 7245,-263.14 7245,-254.58"/>
<polygon fill="black" stroke="black" points="7248.5,-254.58 7245,-244.58 7241.5,-254.58 7248.5,-254.58"/>
</g>
<!-- mlp3_down&#45;&gt;add_7 -->
<g id="edge294" class="edge">
<title>mlp3_down&#45;&gt;add_7</title>
<path fill="none" stroke="black" d="M7269.48,-206C7281.54,-197.04 7296.25,-186.12 7309.27,-176.46"/>
<polygon fill="black" stroke="black" points="7311.59,-179.1 7317.53,-170.33 7307.41,-173.48 7311.59,-179.1"/>
</g>
<!-- add_7&#45;&gt;add_6 -->
<g id="edge289" class="edge">
<title>add_7&#45;&gt;add_6</title>
<path fill="none" stroke="black" d="M7349.56,-170.26C7356.09,-201.48 7359.25,-267.05 7341,-318.17 7337.5,-327.97 7331.64,-337.55 7325.12,-345.86"/>
<polygon fill="black" stroke="black" points="7322.26,-343.82 7318.45,-353.7 7327.6,-348.36 7322.26,-343.82"/>
</g>
<!-- output -->
<g id="node193" class="node">
<title>output</title>
<ellipse fill="lightyellow" stroke="black" cx="7342" cy="-48.08" rx="269.32" ry="48.17"/>
<text text-anchor="middle" x="7342" y="-66.88" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="7342" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="7342" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch=128, seq=100000, d_model=4096]</text>
<text text-anchor="middle" x="7342" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: all GPUs 8&#45;15</text>
</g>
<!-- add_7&#45;&gt;output -->
<g id="edge296" class="edge">
<title>add_7&#45;&gt;output</title>
<path fill="none" stroke="black" d="M7342,-132.09C7342,-124.76 7342,-115.83 7342,-106.59"/>
<polygon fill="black" stroke="black" points="7345.5,-106.5 7342,-96.5 7338.5,-106.5 7345.5,-106.5"/>
</g>
</g>
</svg>
