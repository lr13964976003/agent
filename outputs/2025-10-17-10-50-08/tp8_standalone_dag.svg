<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: TP8_Standalone Pages: 1 -->
<svg width="1800pt" height="381pt"
 viewBox="0.00 0.00 1800.00 381.42" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.07 0.07) rotate(0) translate(4 5207.91)">
<title>TP8_Standalone</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-5207.91 24592,-5207.91 24592,4 -4,4"/>
<text text-anchor="middle" x="12294" y="-54" font-family="Times,serif" font-size="20.00">Standalone Tensor Parallelism 8</text>
<text text-anchor="middle" x="12294" y="-32" font-family="Times,serif" font-size="20.00">8 GPUs total</text>
<text text-anchor="middle" x="12294" y="-10" font-family="Times,serif" font-size="20.00">Model Parallel across all layers</text>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="12298" cy="-5166.43" rx="292.07" ry="37.45"/>
<text text-anchor="middle" x="12298" y="-5177.73" font-family="Times,serif" font-size="14.00">INPUT</text>
<text text-anchor="middle" x="12298" y="-5162.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="12298" y="-5147.73" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer0_qkv_gpu0 -->
<g id="node2" class="node">
<title>layer0_qkv_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="11523,-5092.95 11323,-5092.95 11323,-4994.95 11523,-4994.95 11523,-5092.95"/>
<text text-anchor="middle" x="11423" y="-5077.75" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU0</text>
<text text-anchor="middle" x="11423" y="-5062.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11423" y="-5047.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11423" y="-5032.75" font-family="Times,serif" font-size="14.00">Heads: 0&#45;3</text>
<text text-anchor="middle" x="11423" y="-5017.75" font-family="Times,serif" font-size="14.00">TP Slice: 0</text>
<text text-anchor="middle" x="11423" y="-5002.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu0</title>
<path fill="none" stroke="black" d="M12038.94,-5149.12C11905.79,-5138.1 11741.37,-5120.42 11596,-5092.95 11575.51,-5089.08 11553.91,-5083.95 11533.19,-5078.49"/>
<polygon fill="black" stroke="black" points="11533.98,-5075.08 11523.41,-5075.88 11532.17,-5081.84 11533.98,-5075.08"/>
</g>
<!-- layer0_qkv_gpu1 -->
<g id="node5" class="node">
<title>layer0_qkv_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11805,-5092.95 11605,-5092.95 11605,-4994.95 11805,-4994.95 11805,-5092.95"/>
<text text-anchor="middle" x="11705" y="-5077.75" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU1</text>
<text text-anchor="middle" x="11705" y="-5062.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11705" y="-5047.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11705" y="-5032.75" font-family="Times,serif" font-size="14.00">Heads: 4&#45;7</text>
<text text-anchor="middle" x="11705" y="-5017.75" font-family="Times,serif" font-size="14.00">TP Slice: 1</text>
<text text-anchor="middle" x="11705" y="-5002.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu1 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu1</title>
<path fill="none" stroke="black" d="M12091.76,-5139.86C12014.13,-5128.28 11925.44,-5112.69 11846,-5092.95 11835.82,-5090.42 11825.32,-5087.49 11814.86,-5084.34"/>
<polygon fill="black" stroke="black" points="11815.87,-5080.99 11805.28,-5081.4 11813.81,-5087.68 11815.87,-5080.99"/>
</g>
<!-- layer0_qkv_gpu2 -->
<g id="node8" class="node">
<title>layer0_qkv_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="12055,-5092.95 11855,-5092.95 11855,-4994.95 12055,-4994.95 12055,-5092.95"/>
<text text-anchor="middle" x="11955" y="-5077.75" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU2</text>
<text text-anchor="middle" x="11955" y="-5062.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11955" y="-5047.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11955" y="-5032.75" font-family="Times,serif" font-size="14.00">Heads: 8&#45;11</text>
<text text-anchor="middle" x="11955" y="-5017.75" font-family="Times,serif" font-size="14.00">TP Slice: 2</text>
<text text-anchor="middle" x="11955" y="-5002.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu2 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu2</title>
<path fill="none" stroke="black" d="M12192.61,-5131.47C12156.75,-5119.63 12116.52,-5106.03 12080,-5092.95 12074.94,-5091.14 12069.77,-5089.27 12064.56,-5087.35"/>
<polygon fill="black" stroke="black" points="12065.74,-5084.05 12055.14,-5083.87 12063.31,-5090.62 12065.74,-5084.05"/>
</g>
<!-- layer0_qkv_gpu3 -->
<g id="node11" class="node">
<title>layer0_qkv_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="12289,-5092.95 12089,-5092.95 12089,-4994.95 12289,-4994.95 12289,-5092.95"/>
<text text-anchor="middle" x="12189" y="-5077.75" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU3</text>
<text text-anchor="middle" x="12189" y="-5062.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12189" y="-5047.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12189" y="-5032.75" font-family="Times,serif" font-size="14.00">Heads: 12&#45;15</text>
<text text-anchor="middle" x="12189" y="-5017.75" font-family="Times,serif" font-size="14.00">TP Slice: 3</text>
<text text-anchor="middle" x="12189" y="-5002.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu3 -->
<g id="edge4" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu3</title>
<path fill="none" stroke="black" d="M12265,-5128.96C12256.99,-5120.1 12248.24,-5110.43 12239.63,-5100.91"/>
<polygon fill="black" stroke="black" points="12242.06,-5098.39 12232.76,-5093.32 12236.87,-5103.08 12242.06,-5098.39"/>
</g>
<!-- layer0_qkv_gpu4 -->
<g id="node14" class="node">
<title>layer0_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="12528,-5092.95 12328,-5092.95 12328,-4994.95 12528,-4994.95 12528,-5092.95"/>
<text text-anchor="middle" x="12428" y="-5077.75" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU4</text>
<text text-anchor="middle" x="12428" y="-5062.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12428" y="-5047.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12428" y="-5032.75" font-family="Times,serif" font-size="14.00">Heads: 16&#45;19</text>
<text text-anchor="middle" x="12428" y="-5017.75" font-family="Times,serif" font-size="14.00">TP Slice: 4</text>
<text text-anchor="middle" x="12428" y="-5002.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu4 -->
<g id="edge5" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu4</title>
<path fill="none" stroke="black" d="M12337,-5129.28C12346.97,-5120.05 12357.91,-5109.91 12368.65,-5099.96"/>
<polygon fill="black" stroke="black" points="12371.08,-5102.48 12376.03,-5093.12 12366.32,-5097.35 12371.08,-5102.48"/>
</g>
<!-- layer0_qkv_gpu5 -->
<g id="node17" class="node">
<title>layer0_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12778,-5092.95 12578,-5092.95 12578,-4994.95 12778,-4994.95 12778,-5092.95"/>
<text text-anchor="middle" x="12678" y="-5077.75" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU5</text>
<text text-anchor="middle" x="12678" y="-5062.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12678" y="-5047.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12678" y="-5032.75" font-family="Times,serif" font-size="14.00">Heads: 20&#45;23</text>
<text text-anchor="middle" x="12678" y="-5017.75" font-family="Times,serif" font-size="14.00">TP Slice: 5</text>
<text text-anchor="middle" x="12678" y="-5002.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu5 -->
<g id="edge6" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu5</title>
<path fill="none" stroke="black" d="M12411.61,-5131.83C12451.36,-5119.85 12496.24,-5106.07 12537,-5092.95 12547.08,-5089.71 12557.55,-5086.27 12568.02,-5082.79"/>
<polygon fill="black" stroke="black" points="12569.24,-5086.07 12577.62,-5079.59 12567.03,-5079.43 12569.24,-5086.07"/>
</g>
<!-- layer0_qkv_gpu6 -->
<g id="node20" class="node">
<title>layer0_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="13034,-5092.95 12834,-5092.95 12834,-4994.95 13034,-4994.95 13034,-5092.95"/>
<text text-anchor="middle" x="12934" y="-5077.75" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU6</text>
<text text-anchor="middle" x="12934" y="-5062.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12934" y="-5047.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12934" y="-5032.75" font-family="Times,serif" font-size="14.00">Heads: 24&#45;27</text>
<text text-anchor="middle" x="12934" y="-5017.75" font-family="Times,serif" font-size="14.00">TP Slice: 6</text>
<text text-anchor="middle" x="12934" y="-5002.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu6 -->
<g id="edge7" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu6</title>
<path fill="none" stroke="black" d="M12514.93,-5141.26C12600.33,-5129.68 12698.87,-5113.72 12787,-5092.95 12799.06,-5090.11 12811.55,-5086.73 12823.93,-5083.11"/>
<polygon fill="black" stroke="black" points="12825.24,-5086.37 12833.82,-5080.15 12823.23,-5079.66 12825.24,-5086.37"/>
</g>
<!-- layer0_qkv_gpu7 -->
<g id="node23" class="node">
<title>layer0_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="13292,-5092.95 13092,-5092.95 13092,-4994.95 13292,-4994.95 13292,-5092.95"/>
<text text-anchor="middle" x="13192" y="-5077.75" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU7</text>
<text text-anchor="middle" x="13192" y="-5062.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="13192" y="-5047.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="13192" y="-5032.75" font-family="Times,serif" font-size="14.00">Heads: 28&#45;31</text>
<text text-anchor="middle" x="13192" y="-5017.75" font-family="Times,serif" font-size="14.00">TP Slice: 7</text>
<text text-anchor="middle" x="13192" y="-5002.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu7 -->
<g id="edge8" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu7</title>
<path fill="none" stroke="black" d="M12570.82,-5152.96C12712.73,-5142.94 12888.39,-5124.99 13043,-5092.95 13055.72,-5090.32 13068.89,-5086.99 13081.9,-5083.32"/>
<polygon fill="black" stroke="black" points="13083.16,-5086.6 13091.8,-5080.46 13081.22,-5079.88 13083.16,-5086.6"/>
</g>
<!-- layer0_attn_gpu0 -->
<g id="node3" class="node">
<title>layer0_attn_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="11516.5,-4958.95 11273.5,-4958.95 11273.5,-4890.95 11516.5,-4890.95 11516.5,-4958.95"/>
<text text-anchor="middle" x="11395" y="-4943.75" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU0</text>
<text text-anchor="middle" x="11395" y="-4928.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11395" y="-4913.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11395" y="-4898.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_qkv_gpu0&#45;&gt;layer0_attn_gpu0 -->
<g id="edge9" class="edge">
<title>layer0_qkv_gpu0&#45;&gt;layer0_attn_gpu0</title>
<path fill="none" stroke="black" d="M11411.45,-4994.69C11409.41,-4986.19 11407.31,-4977.39 11405.31,-4969.04"/>
<polygon fill="black" stroke="black" points="11408.67,-4968.04 11402.94,-4959.13 11401.86,-4969.67 11408.67,-4968.04"/>
</g>
<!-- layer0_attn_proj_gpu0 -->
<g id="node4" class="node">
<title>layer0_attn_proj_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="11523,-4854.95 11323,-4854.95 11323,-4786.95 11523,-4786.95 11523,-4854.95"/>
<text text-anchor="middle" x="11423" y="-4839.75" font-family="Times,serif" font-size="14.00">L0_Attn_Projection_GPU0</text>
<text text-anchor="middle" x="11423" y="-4824.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11423" y="-4809.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11423" y="-4794.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_attn_gpu0&#45;&gt;layer0_attn_proj_gpu0 -->
<g id="edge10" class="edge">
<title>layer0_attn_gpu0&#45;&gt;layer0_attn_proj_gpu0</title>
<path fill="none" stroke="black" d="M11404.09,-4890.84C11406.34,-4882.64 11408.78,-4873.74 11411.14,-4865.15"/>
<polygon fill="black" stroke="black" points="11414.59,-4865.82 11413.86,-4855.25 11407.84,-4863.97 11414.59,-4865.82"/>
</g>
<!-- layer0_attn_allreduce -->
<g id="node26" class="node">
<title>layer0_attn_allreduce</title>
<polygon fill="lightcoral" stroke="black" points="12308,-4750.95 12071,-4682.95 12308,-4614.95 12545,-4682.95 12308,-4750.95"/>
<text text-anchor="middle" x="12308" y="-4701.75" font-family="Times,serif" font-size="14.00">L0_Attention_All&#45;Reduce</text>
<text text-anchor="middle" x="12308" y="-4686.75" font-family="Times,serif" font-size="14.00">Input: 8×[1024,2048,512]</text>
<text text-anchor="middle" x="12308" y="-4671.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12308" y="-4656.75" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce across GPUs 0&#45;7</text>
</g>
<!-- layer0_attn_proj_gpu0&#45;&gt;layer0_attn_allreduce -->
<g id="edge11" class="edge">
<title>layer0_attn_proj_gpu0&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M11523.03,-4800.08C11546.91,-4795.56 11572.33,-4790.92 11596,-4786.95 11780.65,-4756 11993.18,-4725.98 12137.63,-4706.42"/>
<polygon fill="black" stroke="black" points="12138.47,-4709.83 12147.91,-4705.02 12137.53,-4702.9 12138.47,-4709.83"/>
</g>
<!-- layer0_attn_gpu1 -->
<g id="node6" class="node">
<title>layer0_attn_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11777.5,-4958.95 11534.5,-4958.95 11534.5,-4890.95 11777.5,-4890.95 11777.5,-4958.95"/>
<text text-anchor="middle" x="11656" y="-4943.75" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU1</text>
<text text-anchor="middle" x="11656" y="-4928.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11656" y="-4913.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11656" y="-4898.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_qkv_gpu1&#45;&gt;layer0_attn_gpu1 -->
<g id="edge48" class="edge">
<title>layer0_qkv_gpu1&#45;&gt;layer0_attn_gpu1</title>
<path fill="none" stroke="black" d="M11684.79,-4994.69C11681.15,-4986 11677.38,-4977 11673.81,-4968.49"/>
<polygon fill="black" stroke="black" points="11676.98,-4967 11669.89,-4959.13 11670.53,-4969.7 11676.98,-4967"/>
</g>
<!-- layer0_attn_proj_gpu1 -->
<g id="node7" class="node">
<title>layer0_attn_proj_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11805,-4854.95 11605,-4854.95 11605,-4786.95 11805,-4786.95 11805,-4854.95"/>
<text text-anchor="middle" x="11705" y="-4839.75" font-family="Times,serif" font-size="14.00">L0_Attn_Projection_GPU1</text>
<text text-anchor="middle" x="11705" y="-4824.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11705" y="-4809.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11705" y="-4794.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_attn_gpu1&#45;&gt;layer0_attn_proj_gpu1 -->
<g id="edge49" class="edge">
<title>layer0_attn_gpu1&#45;&gt;layer0_attn_proj_gpu1</title>
<path fill="none" stroke="black" d="M11671.91,-4890.84C11675.97,-4882.37 11680.4,-4873.16 11684.65,-4864.31"/>
<polygon fill="black" stroke="black" points="11687.83,-4865.78 11689,-4855.25 11681.52,-4862.75 11687.83,-4865.78"/>
</g>
<!-- layer0_attn_proj_gpu1&#45;&gt;layer0_attn_allreduce -->
<g id="edge50" class="edge">
<title>layer0_attn_proj_gpu1&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M11805.1,-4796.39C11818.84,-4793.19 11832.77,-4789.98 11846,-4786.95 11953.15,-4762.47 12074.45,-4735.45 12165.86,-4715.24"/>
<polygon fill="black" stroke="black" points="12166.73,-4718.63 12175.73,-4713.05 12165.21,-4711.79 12166.73,-4718.63"/>
</g>
<!-- layer0_attn_gpu2 -->
<g id="node9" class="node">
<title>layer0_attn_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="12038.5,-4958.95 11795.5,-4958.95 11795.5,-4890.95 12038.5,-4890.95 12038.5,-4958.95"/>
<text text-anchor="middle" x="11917" y="-4943.75" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU2</text>
<text text-anchor="middle" x="11917" y="-4928.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11917" y="-4913.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11917" y="-4898.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_qkv_gpu2&#45;&gt;layer0_attn_gpu2 -->
<g id="edge87" class="edge">
<title>layer0_qkv_gpu2&#45;&gt;layer0_attn_gpu2</title>
<path fill="none" stroke="black" d="M11939.32,-4994.69C11936.53,-4986.09 11933.64,-4977.19 11930.9,-4968.76"/>
<polygon fill="black" stroke="black" points="11934.19,-4967.56 11927.77,-4959.13 11927.53,-4969.72 11934.19,-4967.56"/>
</g>
<!-- layer0_attn_proj_gpu2 -->
<g id="node10" class="node">
<title>layer0_attn_proj_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="12055,-4854.95 11855,-4854.95 11855,-4786.95 12055,-4786.95 12055,-4854.95"/>
<text text-anchor="middle" x="11955" y="-4839.75" font-family="Times,serif" font-size="14.00">L0_Attn_Projection_GPU2</text>
<text text-anchor="middle" x="11955" y="-4824.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11955" y="-4809.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11955" y="-4794.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_attn_gpu2&#45;&gt;layer0_attn_proj_gpu2 -->
<g id="edge88" class="edge">
<title>layer0_attn_gpu2&#45;&gt;layer0_attn_proj_gpu2</title>
<path fill="none" stroke="black" d="M11929.34,-4890.84C11932.42,-4882.55 11935.78,-4873.55 11939.01,-4864.86"/>
<polygon fill="black" stroke="black" points="11942.38,-4865.85 11942.59,-4855.25 11935.82,-4863.4 11942.38,-4865.85"/>
</g>
<!-- layer0_attn_proj_gpu2&#45;&gt;layer0_attn_allreduce -->
<g id="edge89" class="edge">
<title>layer0_attn_proj_gpu2&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M12040.9,-4786.86C12088.45,-4768.54 12148.04,-4745.58 12198.86,-4726"/>
<polygon fill="black" stroke="black" points="12200.17,-4729.25 12208.24,-4722.39 12197.65,-4722.72 12200.17,-4729.25"/>
</g>
<!-- layer0_attn_gpu3 -->
<g id="node12" class="node">
<title>layer0_attn_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="12299.5,-4958.95 12056.5,-4958.95 12056.5,-4890.95 12299.5,-4890.95 12299.5,-4958.95"/>
<text text-anchor="middle" x="12178" y="-4943.75" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU3</text>
<text text-anchor="middle" x="12178" y="-4928.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12178" y="-4913.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12178" y="-4898.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_qkv_gpu3&#45;&gt;layer0_attn_gpu3 -->
<g id="edge126" class="edge">
<title>layer0_qkv_gpu3&#45;&gt;layer0_attn_gpu3</title>
<path fill="none" stroke="black" d="M12184.46,-4994.69C12183.67,-4986.28 12182.85,-4977.58 12182.08,-4969.31"/>
<polygon fill="black" stroke="black" points="12185.54,-4968.75 12181.12,-4959.13 12178.57,-4969.41 12185.54,-4968.75"/>
</g>
<!-- layer0_attn_proj_gpu3 -->
<g id="node13" class="node">
<title>layer0_attn_proj_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="12289,-4854.95 12089,-4854.95 12089,-4786.95 12289,-4786.95 12289,-4854.95"/>
<text text-anchor="middle" x="12189" y="-4839.75" font-family="Times,serif" font-size="14.00">L0_Attn_Projection_GPU3</text>
<text text-anchor="middle" x="12189" y="-4824.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12189" y="-4809.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12189" y="-4794.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_attn_gpu3&#45;&gt;layer0_attn_proj_gpu3 -->
<g id="edge127" class="edge">
<title>layer0_attn_gpu3&#45;&gt;layer0_attn_proj_gpu3</title>
<path fill="none" stroke="black" d="M12181.57,-4890.84C12182.45,-4882.73 12183.39,-4873.94 12184.31,-4865.43"/>
<polygon fill="black" stroke="black" points="12187.82,-4865.57 12185.41,-4855.25 12180.86,-4864.82 12187.82,-4865.57"/>
</g>
<!-- layer0_attn_proj_gpu3&#45;&gt;layer0_attn_allreduce -->
<g id="edge128" class="edge">
<title>layer0_attn_proj_gpu3&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M12218.11,-4786.68C12229.03,-4774.21 12241.81,-4759.6 12254.25,-4745.39"/>
<polygon fill="black" stroke="black" points="12257.16,-4747.37 12261.11,-4737.54 12251.89,-4742.76 12257.16,-4747.37"/>
</g>
<!-- layer0_attn_gpu4 -->
<g id="node15" class="node">
<title>layer0_attn_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="12560.5,-4958.95 12317.5,-4958.95 12317.5,-4890.95 12560.5,-4890.95 12560.5,-4958.95"/>
<text text-anchor="middle" x="12439" y="-4943.75" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU4</text>
<text text-anchor="middle" x="12439" y="-4928.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12439" y="-4913.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12439" y="-4898.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_qkv_gpu4&#45;&gt;layer0_attn_gpu4 -->
<g id="edge165" class="edge">
<title>layer0_qkv_gpu4&#45;&gt;layer0_attn_gpu4</title>
<path fill="none" stroke="black" d="M12432.54,-4994.69C12433.33,-4986.28 12434.15,-4977.58 12434.92,-4969.31"/>
<polygon fill="black" stroke="black" points="12438.43,-4969.41 12435.88,-4959.13 12431.46,-4968.75 12438.43,-4969.41"/>
</g>
<!-- layer0_attn_proj_gpu4 -->
<g id="node16" class="node">
<title>layer0_attn_proj_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="12528,-4854.95 12328,-4854.95 12328,-4786.95 12528,-4786.95 12528,-4854.95"/>
<text text-anchor="middle" x="12428" y="-4839.75" font-family="Times,serif" font-size="14.00">L0_Attn_Projection_GPU4</text>
<text text-anchor="middle" x="12428" y="-4824.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12428" y="-4809.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12428" y="-4794.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_attn_gpu4&#45;&gt;layer0_attn_proj_gpu4 -->
<g id="edge166" class="edge">
<title>layer0_attn_gpu4&#45;&gt;layer0_attn_proj_gpu4</title>
<path fill="none" stroke="black" d="M12435.43,-4890.84C12434.55,-4882.73 12433.61,-4873.94 12432.69,-4865.43"/>
<polygon fill="black" stroke="black" points="12436.14,-4864.82 12431.59,-4855.25 12429.18,-4865.57 12436.14,-4864.82"/>
</g>
<!-- layer0_attn_proj_gpu4&#45;&gt;layer0_attn_allreduce -->
<g id="edge167" class="edge">
<title>layer0_attn_proj_gpu4&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M12398.64,-4786.68C12387.64,-4774.21 12374.75,-4759.6 12362.21,-4745.39"/>
<polygon fill="black" stroke="black" points="12364.53,-4742.73 12355.28,-4737.54 12359.28,-4747.36 12364.53,-4742.73"/>
</g>
<!-- layer0_attn_gpu5 -->
<g id="node18" class="node">
<title>layer0_attn_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12821.5,-4958.95 12578.5,-4958.95 12578.5,-4890.95 12821.5,-4890.95 12821.5,-4958.95"/>
<text text-anchor="middle" x="12700" y="-4943.75" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU5</text>
<text text-anchor="middle" x="12700" y="-4928.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12700" y="-4913.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12700" y="-4898.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_qkv_gpu5&#45;&gt;layer0_attn_gpu5 -->
<g id="edge204" class="edge">
<title>layer0_qkv_gpu5&#45;&gt;layer0_attn_gpu5</title>
<path fill="none" stroke="black" d="M12687.08,-4994.69C12688.67,-4986.19 12690.33,-4977.39 12691.9,-4969.04"/>
<polygon fill="black" stroke="black" points="12695.35,-4969.6 12693.76,-4959.13 12688.47,-4968.31 12695.35,-4969.6"/>
</g>
<!-- layer0_attn_proj_gpu5 -->
<g id="node19" class="node">
<title>layer0_attn_proj_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12778,-4854.95 12578,-4854.95 12578,-4786.95 12778,-4786.95 12778,-4854.95"/>
<text text-anchor="middle" x="12678" y="-4839.75" font-family="Times,serif" font-size="14.00">L0_Attn_Projection_GPU5</text>
<text text-anchor="middle" x="12678" y="-4824.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12678" y="-4809.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12678" y="-4794.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_attn_gpu5&#45;&gt;layer0_attn_proj_gpu5 -->
<g id="edge205" class="edge">
<title>layer0_attn_gpu5&#45;&gt;layer0_attn_proj_gpu5</title>
<path fill="none" stroke="black" d="M12692.86,-4890.84C12691.09,-4882.64 12689.17,-4873.74 12687.32,-4865.15"/>
<polygon fill="black" stroke="black" points="12690.71,-4864.29 12685.18,-4855.25 12683.87,-4865.77 12690.71,-4864.29"/>
</g>
<!-- layer0_attn_proj_gpu5&#45;&gt;layer0_attn_allreduce -->
<g id="edge206" class="edge">
<title>layer0_attn_proj_gpu5&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M12587.96,-4786.86C12537.41,-4768.28 12473.89,-4744.93 12420.13,-4725.17"/>
<polygon fill="black" stroke="black" points="12421.15,-4721.82 12410.56,-4721.65 12418.74,-4728.39 12421.15,-4721.82"/>
</g>
<!-- layer0_attn_gpu6 -->
<g id="node21" class="node">
<title>layer0_attn_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="13082.5,-4958.95 12839.5,-4958.95 12839.5,-4890.95 13082.5,-4890.95 13082.5,-4958.95"/>
<text text-anchor="middle" x="12961" y="-4943.75" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU6</text>
<text text-anchor="middle" x="12961" y="-4928.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12961" y="-4913.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12961" y="-4898.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_qkv_gpu6&#45;&gt;layer0_attn_gpu6 -->
<g id="edge243" class="edge">
<title>layer0_qkv_gpu6&#45;&gt;layer0_attn_gpu6</title>
<path fill="none" stroke="black" d="M12945.14,-4994.69C12947.1,-4986.19 12949.13,-4977.39 12951.06,-4969.04"/>
<polygon fill="black" stroke="black" points="12954.51,-4969.66 12953.34,-4959.13 12947.69,-4968.08 12954.51,-4969.66"/>
</g>
<!-- layer0_attn_proj_gpu6 -->
<g id="node22" class="node">
<title>layer0_attn_proj_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="13034,-4854.95 12834,-4854.95 12834,-4786.95 13034,-4786.95 13034,-4854.95"/>
<text text-anchor="middle" x="12934" y="-4839.75" font-family="Times,serif" font-size="14.00">L0_Attn_Projection_GPU6</text>
<text text-anchor="middle" x="12934" y="-4824.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12934" y="-4809.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12934" y="-4794.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_attn_gpu6&#45;&gt;layer0_attn_proj_gpu6 -->
<g id="edge244" class="edge">
<title>layer0_attn_gpu6&#45;&gt;layer0_attn_proj_gpu6</title>
<path fill="none" stroke="black" d="M12952.23,-4890.84C12950.06,-4882.64 12947.71,-4873.74 12945.43,-4865.15"/>
<polygon fill="black" stroke="black" points="12948.76,-4864.02 12942.81,-4855.25 12941.99,-4865.82 12948.76,-4864.02"/>
</g>
<!-- layer0_attn_proj_gpu6&#45;&gt;layer0_attn_allreduce -->
<g id="edge245" class="edge">
<title>layer0_attn_proj_gpu6&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M12834,-4797.38C12818.28,-4793.86 12802.2,-4790.29 12787,-4786.95 12674.67,-4762.27 12547.37,-4734.92 12452.25,-4714.62"/>
<polygon fill="black" stroke="black" points="12452.79,-4711.15 12442.28,-4712.49 12451.33,-4718 12452.79,-4711.15"/>
</g>
<!-- layer0_attn_gpu7 -->
<g id="node24" class="node">
<title>layer0_attn_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="13343.5,-4958.95 13100.5,-4958.95 13100.5,-4890.95 13343.5,-4890.95 13343.5,-4958.95"/>
<text text-anchor="middle" x="13222" y="-4943.75" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU7</text>
<text text-anchor="middle" x="13222" y="-4928.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="13222" y="-4913.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="13222" y="-4898.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_qkv_gpu7&#45;&gt;layer0_attn_gpu7 -->
<g id="edge282" class="edge">
<title>layer0_qkv_gpu7&#45;&gt;layer0_attn_gpu7</title>
<path fill="none" stroke="black" d="M13204.38,-4994.69C13206.56,-4986.19 13208.81,-4977.39 13210.95,-4969.04"/>
<polygon fill="black" stroke="black" points="13214.4,-4969.68 13213.49,-4959.13 13207.62,-4967.94 13214.4,-4969.68"/>
</g>
<!-- layer0_attn_proj_gpu7 -->
<g id="node25" class="node">
<title>layer0_attn_proj_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="13292,-4854.95 13092,-4854.95 13092,-4786.95 13292,-4786.95 13292,-4854.95"/>
<text text-anchor="middle" x="13192" y="-4839.75" font-family="Times,serif" font-size="14.00">L0_Attn_Projection_GPU7</text>
<text text-anchor="middle" x="13192" y="-4824.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="13192" y="-4809.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="13192" y="-4794.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_attn_gpu7&#45;&gt;layer0_attn_proj_gpu7 -->
<g id="edge283" class="edge">
<title>layer0_attn_gpu7&#45;&gt;layer0_attn_proj_gpu7</title>
<path fill="none" stroke="black" d="M13212.26,-4890.84C13209.82,-4882.55 13207.18,-4873.55 13204.62,-4864.86"/>
<polygon fill="black" stroke="black" points="13207.97,-4863.86 13201.79,-4855.25 13201.26,-4865.83 13207.97,-4863.86"/>
</g>
<!-- layer0_attn_proj_gpu7&#45;&gt;layer0_attn_allreduce -->
<g id="edge284" class="edge">
<title>layer0_attn_proj_gpu7&#45;&gt;layer0_attn_allreduce</title>
<path fill="none" stroke="black" d="M13091.63,-4796.59C13075.41,-4793.15 13058.77,-4789.8 13043,-4786.95 12852.89,-4752.63 12633.35,-4723.19 12484.07,-4704.67"/>
<polygon fill="black" stroke="black" points="12484.24,-4701.17 12473.89,-4703.41 12483.38,-4708.12 12484.24,-4701.17"/>
</g>
<!-- layer0_attn_norm_gpu0 -->
<g id="node27" class="node">
<title>layer0_attn_norm_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3483,-4578.95 3239,-4578.95 3239,-4510.95 3483,-4510.95 3483,-4578.95"/>
<text text-anchor="middle" x="3361" y="-4563.75" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU0</text>
<text text-anchor="middle" x="3361" y="-4548.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="3361" y="-4533.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="3361" y="-4518.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer0_attn_allreduce&#45;&gt;layer0_attn_norm_gpu0 -->
<g id="edge12" class="edge">
<title>layer0_attn_allreduce&#45;&gt;layer0_attn_norm_gpu0</title>
<path fill="none" stroke="black" d="M12086,-4678.58C10815.74,-4659.27 4490.5,-4563.12 3493.42,-4547.97"/>
<polygon fill="black" stroke="black" points="3493.4,-4544.47 3483.35,-4547.81 3493.3,-4551.46 3493.4,-4544.47"/>
</g>
<!-- layer0_attn_norm_gpu1 -->
<g id="node28" class="node">
<title>layer0_attn_norm_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="7960,-4578.95 7716,-4578.95 7716,-4510.95 7960,-4510.95 7960,-4578.95"/>
<text text-anchor="middle" x="7838" y="-4563.75" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU1</text>
<text text-anchor="middle" x="7838" y="-4548.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="7838" y="-4533.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="7838" y="-4518.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer0_attn_allreduce&#45;&gt;layer0_attn_norm_gpu1 -->
<g id="edge51" class="edge">
<title>layer0_attn_allreduce&#45;&gt;layer0_attn_norm_gpu1</title>
<path fill="none" stroke="black" d="M12096.53,-4675.52C11314.9,-4651.74 8601.68,-4569.19 7970.1,-4549.97"/>
<polygon fill="black" stroke="black" points="7970.16,-4546.47 7960.06,-4549.67 7969.94,-4553.47 7970.16,-4546.47"/>
</g>
<!-- layer0_attn_norm_gpu2 -->
<g id="node29" class="node">
<title>layer0_attn_norm_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="10329,-4578.95 10085,-4578.95 10085,-4510.95 10329,-4510.95 10329,-4578.95"/>
<text text-anchor="middle" x="10207" y="-4563.75" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU2</text>
<text text-anchor="middle" x="10207" y="-4548.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="10207" y="-4533.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="10207" y="-4518.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer0_attn_allreduce&#45;&gt;layer0_attn_norm_gpu2 -->
<g id="edge90" class="edge">
<title>layer0_attn_allreduce&#45;&gt;layer0_attn_norm_gpu2</title>
<path fill="none" stroke="black" d="M12117.38,-4669.61C11696.99,-4642.4 10699.13,-4577.81 10339.27,-4554.52"/>
<polygon fill="black" stroke="black" points="10339.27,-4551.01 10329.07,-4553.85 10338.82,-4557.99 10339.27,-4551.01"/>
</g>
<!-- layer0_attn_norm_gpu3 -->
<g id="node30" class="node">
<title>layer0_attn_norm_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="11645,-4578.95 11401,-4578.95 11401,-4510.95 11645,-4510.95 11645,-4578.95"/>
<text text-anchor="middle" x="11523" y="-4563.75" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU3</text>
<text text-anchor="middle" x="11523" y="-4548.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11523" y="-4533.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11523" y="-4518.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer0_attn_allreduce&#45;&gt;layer0_attn_norm_gpu3 -->
<g id="edge129" class="edge">
<title>layer0_attn_allreduce&#45;&gt;layer0_attn_norm_gpu3</title>
<path fill="none" stroke="black" d="M12162.19,-4656.69C12016.81,-4631.5 11795.5,-4593.16 11655.13,-4568.84"/>
<polygon fill="black" stroke="black" points="11655.61,-4565.38 11645.16,-4567.12 11654.42,-4572.27 11655.61,-4565.38"/>
</g>
<!-- layer0_attn_norm_gpu4 -->
<g id="node31" class="node">
<title>layer0_attn_norm_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13216,-4578.95 12972,-4578.95 12972,-4510.95 13216,-4510.95 13216,-4578.95"/>
<text text-anchor="middle" x="13094" y="-4563.75" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU4</text>
<text text-anchor="middle" x="13094" y="-4548.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="13094" y="-4533.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="13094" y="-4518.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer0_attn_allreduce&#45;&gt;layer0_attn_norm_gpu4 -->
<g id="edge168" class="edge">
<title>layer0_attn_allreduce&#45;&gt;layer0_attn_norm_gpu4</title>
<path fill="none" stroke="black" d="M12454,-4656.69C12599.67,-4631.49 12821.49,-4593.11 12962.02,-4568.79"/>
<polygon fill="black" stroke="black" points="12962.74,-4572.22 12972,-4567.06 12961.55,-4565.32 12962.74,-4572.22"/>
</g>
<!-- layer0_attn_norm_gpu5 -->
<g id="node32" class="node">
<title>layer0_attn_norm_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="15537,-4578.95 15293,-4578.95 15293,-4510.95 15537,-4510.95 15537,-4578.95"/>
<text text-anchor="middle" x="15415" y="-4563.75" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU5</text>
<text text-anchor="middle" x="15415" y="-4548.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="15415" y="-4533.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="15415" y="-4518.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer0_attn_allreduce&#45;&gt;layer0_attn_norm_gpu5 -->
<g id="edge207" class="edge">
<title>layer0_attn_allreduce&#45;&gt;layer0_attn_norm_gpu5</title>
<path fill="none" stroke="black" d="M12510.66,-4673.08C13098.81,-4647.34 14795.15,-4573.09 15282.57,-4551.75"/>
<polygon fill="black" stroke="black" points="15282.98,-4555.24 15292.81,-4551.3 15282.67,-4548.24 15282.98,-4555.24"/>
</g>
<!-- layer0_attn_norm_gpu6 -->
<g id="node33" class="node">
<title>layer0_attn_norm_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="18234,-4578.95 17990,-4578.95 17990,-4510.95 18234,-4510.95 18234,-4578.95"/>
<text text-anchor="middle" x="18112" y="-4563.75" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU6</text>
<text text-anchor="middle" x="18112" y="-4548.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="18112" y="-4533.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="18112" y="-4518.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer0_attn_allreduce&#45;&gt;layer0_attn_norm_gpu6 -->
<g id="edge246" class="edge">
<title>layer0_attn_allreduce&#45;&gt;layer0_attn_norm_gpu6</title>
<path fill="none" stroke="black" d="M12524.06,-4676.89C13469.19,-4654.74 17226.18,-4566.71 17979.92,-4549.05"/>
<polygon fill="black" stroke="black" points="17980.08,-4552.55 17989.99,-4548.81 17979.91,-4545.55 17980.08,-4552.55"/>
</g>
<!-- layer0_attn_norm_gpu7 -->
<g id="node34" class="node">
<title>layer0_attn_norm_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="21118,-4578.95 20874,-4578.95 20874,-4510.95 21118,-4510.95 21118,-4578.95"/>
<text text-anchor="middle" x="20996" y="-4563.75" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU7</text>
<text text-anchor="middle" x="20996" y="-4548.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="20996" y="-4533.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="20996" y="-4518.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer0_attn_allreduce&#45;&gt;layer0_attn_norm_gpu7 -->
<g id="edge285" class="edge">
<title>layer0_attn_allreduce&#45;&gt;layer0_attn_norm_gpu7</title>
<path fill="none" stroke="black" d="M12529.57,-4678.48C13775.18,-4658.99 19884.65,-4563.35 20863.57,-4548.03"/>
<polygon fill="black" stroke="black" points="20863.86,-4551.52 20873.81,-4547.87 20863.75,-4544.52 20863.86,-4551.52"/>
</g>
<!-- layer0_gate_gpu0 -->
<g id="node35" class="node">
<title>layer0_gate_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1775,-4474.95 1531,-4474.95 1531,-4391.95 1775,-4391.95 1775,-4474.95"/>
<text text-anchor="middle" x="1653" y="-4459.75" font-family="Times,serif" font-size="14.00">L0_Gate_GPU0</text>
<text text-anchor="middle" x="1653" y="-4444.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1653" y="-4429.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="1653" y="-4414.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="1653" y="-4399.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_attn_norm_gpu0&#45;&gt;layer0_gate_gpu0 -->
<g id="edge13" class="edge">
<title>layer0_attn_norm_gpu0&#45;&gt;layer0_gate_gpu0</title>
<path fill="none" stroke="black" d="M3238.85,-4536.12C2927.76,-4516.18 2107.48,-4463.59 1785.45,-4442.95"/>
<polygon fill="black" stroke="black" points="1785.35,-4439.43 1775.14,-4442.28 1784.9,-4446.42 1785.35,-4439.43"/>
</g>
<!-- layer0_gate_gpu1 -->
<g id="node54" class="node">
<title>layer0_gate_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="4847,-4474.95 4603,-4474.95 4603,-4391.95 4847,-4391.95 4847,-4474.95"/>
<text text-anchor="middle" x="4725" y="-4459.75" font-family="Times,serif" font-size="14.00">L0_Gate_GPU1</text>
<text text-anchor="middle" x="4725" y="-4444.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="4725" y="-4429.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="4725" y="-4414.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="4725" y="-4399.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_attn_norm_gpu1&#45;&gt;layer0_gate_gpu1 -->
<g id="edge52" class="edge">
<title>layer0_attn_norm_gpu1&#45;&gt;layer0_gate_gpu1</title>
<path fill="none" stroke="black" d="M7715.97,-4539.66C7221.54,-4522.27 5369.37,-4457.12 4857.05,-4439.1"/>
<polygon fill="black" stroke="black" points="4857.15,-4435.6 4847.03,-4438.75 4856.9,-4442.6 4857.15,-4435.6"/>
</g>
<!-- layer0_gate_gpu2 -->
<g id="node73" class="node">
<title>layer0_gate_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="7919,-4474.95 7675,-4474.95 7675,-4391.95 7919,-4391.95 7919,-4474.95"/>
<text text-anchor="middle" x="7797" y="-4459.75" font-family="Times,serif" font-size="14.00">L0_Gate_GPU2</text>
<text text-anchor="middle" x="7797" y="-4444.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="7797" y="-4429.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="7797" y="-4414.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="7797" y="-4399.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_attn_norm_gpu2&#45;&gt;layer0_gate_gpu2 -->
<g id="edge91" class="edge">
<title>layer0_attn_norm_gpu2&#45;&gt;layer0_gate_gpu2</title>
<path fill="none" stroke="black" d="M10084.59,-4538.39C9674.89,-4519.78 8353.65,-4459.75 7929.44,-4440.47"/>
<polygon fill="black" stroke="black" points="7929.43,-4436.97 7919.28,-4440.01 7929.12,-4443.96 7929.43,-4436.97"/>
</g>
<!-- layer0_gate_gpu3 -->
<g id="node92" class="node">
<title>layer0_gate_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="10991,-4474.95 10747,-4474.95 10747,-4391.95 10991,-4391.95 10991,-4474.95"/>
<text text-anchor="middle" x="10869" y="-4459.75" font-family="Times,serif" font-size="14.00">L0_Gate_GPU3</text>
<text text-anchor="middle" x="10869" y="-4444.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="10869" y="-4429.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="10869" y="-4414.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="10869" y="-4399.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_attn_norm_gpu3&#45;&gt;layer0_gate_gpu3 -->
<g id="edge130" class="edge">
<title>layer0_attn_norm_gpu3&#45;&gt;layer0_gate_gpu3</title>
<path fill="none" stroke="black" d="M11400.75,-4523.49C11287.06,-4504.45 11118.09,-4476.16 11001.28,-4456.6"/>
<polygon fill="black" stroke="black" points="11001.64,-4453.11 10991.2,-4454.91 11000.48,-4460.02 11001.64,-4453.11"/>
</g>
<!-- layer0_gate_gpu4 -->
<g id="node111" class="node">
<title>layer0_gate_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13871,-4474.95 13627,-4474.95 13627,-4391.95 13871,-4391.95 13871,-4474.95"/>
<text text-anchor="middle" x="13749" y="-4459.75" font-family="Times,serif" font-size="14.00">L0_Gate_GPU4</text>
<text text-anchor="middle" x="13749" y="-4444.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="13749" y="-4429.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="13749" y="-4414.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="13749" y="-4399.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_attn_norm_gpu4&#45;&gt;layer0_gate_gpu4 -->
<g id="edge169" class="edge">
<title>layer0_attn_norm_gpu4&#45;&gt;layer0_gate_gpu4</title>
<path fill="none" stroke="black" d="M13216.05,-4523.55C13329.96,-4504.51 13499.51,-4476.16 13616.64,-4456.58"/>
<polygon fill="black" stroke="black" points="13617.46,-4459.99 13626.74,-4454.89 13616.3,-4453.09 13617.46,-4459.99"/>
</g>
<!-- layer0_gate_gpu5 -->
<g id="node130" class="node">
<title>layer0_gate_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="16943,-4474.95 16699,-4474.95 16699,-4391.95 16943,-4391.95 16943,-4474.95"/>
<text text-anchor="middle" x="16821" y="-4459.75" font-family="Times,serif" font-size="14.00">L0_Gate_GPU5</text>
<text text-anchor="middle" x="16821" y="-4444.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="16821" y="-4429.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="16821" y="-4414.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="16821" y="-4399.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_attn_norm_gpu5&#45;&gt;layer0_gate_gpu5 -->
<g id="edge208" class="edge">
<title>layer0_attn_norm_gpu5&#45;&gt;layer0_gate_gpu5</title>
<path fill="none" stroke="black" d="M15537.01,-4534.45C15799.67,-4513.99 16416.85,-4465.93 16688.59,-4444.77"/>
<polygon fill="black" stroke="black" points="16689.2,-4448.23 16698.9,-4443.96 16688.66,-4441.25 16689.2,-4448.23"/>
</g>
<!-- layer0_gate_gpu6 -->
<g id="node149" class="node">
<title>layer0_gate_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="20015,-4474.95 19771,-4474.95 19771,-4391.95 20015,-4391.95 20015,-4474.95"/>
<text text-anchor="middle" x="19893" y="-4459.75" font-family="Times,serif" font-size="14.00">L0_Gate_GPU6</text>
<text text-anchor="middle" x="19893" y="-4444.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="19893" y="-4429.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="19893" y="-4414.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="19893" y="-4399.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_attn_norm_gpu6&#45;&gt;layer0_gate_gpu6 -->
<g id="edge247" class="edge">
<title>layer0_attn_norm_gpu6&#45;&gt;layer0_gate_gpu6</title>
<path fill="none" stroke="black" d="M18234.06,-4536.45C18556.17,-4516.64 19427.18,-4463.09 19760.65,-4442.59"/>
<polygon fill="black" stroke="black" points="19761.07,-4446.07 19770.84,-4441.96 19760.65,-4439.08 19761.07,-4446.07"/>
</g>
<!-- layer0_gate_gpu7 -->
<g id="node168" class="node">
<title>layer0_gate_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="23087,-4474.95 22843,-4474.95 22843,-4391.95 23087,-4391.95 23087,-4474.95"/>
<text text-anchor="middle" x="22965" y="-4459.75" font-family="Times,serif" font-size="14.00">L0_Gate_GPU7</text>
<text text-anchor="middle" x="22965" y="-4444.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="22965" y="-4429.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="22965" y="-4414.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="22965" y="-4399.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_attn_norm_gpu7&#45;&gt;layer0_gate_gpu7 -->
<g id="edge286" class="edge">
<title>layer0_attn_norm_gpu7&#45;&gt;layer0_gate_gpu7</title>
<path fill="none" stroke="black" d="M21118.05,-4537.17C21467.71,-4517.72 22471.14,-4461.92 22832.94,-4441.8"/>
<polygon fill="black" stroke="black" points="22833.15,-4445.29 22842.94,-4441.24 22832.76,-4438.3 22833.15,-4445.29"/>
</g>
<!-- layer0_expert0_0 -->
<g id="node36" class="node">
<title>layer0_expert0_0</title>
<polygon fill="lightgreen" stroke="black" points="204,-4355.95 30,-4355.95 30,-4272.95 204,-4272.95 204,-4355.95"/>
<text text-anchor="middle" x="117" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU0</text>
<text text-anchor="middle" x="117" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="117" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="117" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="117" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_0 -->
<g id="edge14" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1530.8,-4431.37C1234.21,-4427.87 481.59,-4413.65 214.29,-4355.96"/>
<polygon fill="black" stroke="black" points="214.74,-4352.48 204.22,-4353.71 213.22,-4359.31 214.74,-4352.48"/>
</g>
<!-- layer0_expert0_1 -->
<g id="node37" class="node">
<title>layer0_expert0_1</title>
<polygon fill="lightgreen" stroke="black" points="396,-4355.95 222,-4355.95 222,-4272.95 396,-4272.95 396,-4355.95"/>
<text text-anchor="middle" x="309" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU0</text>
<text text-anchor="middle" x="309" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="309" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="309" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="309" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_1 -->
<g id="edge15" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1530.82,-4430.19C1263.95,-4424.43 635.25,-4406.07 406.17,-4355.94"/>
<polygon fill="black" stroke="black" points="406.75,-4352.48 396.22,-4353.68 405.2,-4359.31 406.75,-4352.48"/>
</g>
<!-- layer0_expert0_2 -->
<g id="node38" class="node">
<title>layer0_expert0_2</title>
<polygon fill="lightgreen" stroke="black" points="588,-4355.95 414,-4355.95 414,-4272.95 588,-4272.95 588,-4355.95"/>
<text text-anchor="middle" x="501" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU0</text>
<text text-anchor="middle" x="501" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="501" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="501" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="501" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_2 -->
<g id="edge16" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1530.92,-4428.61C1296.28,-4420.41 789.38,-4398.58 598.19,-4355.95"/>
<polygon fill="black" stroke="black" points="598.77,-4352.49 588.23,-4353.64 597.19,-4359.31 598.77,-4352.49"/>
</g>
<!-- layer0_expert0_3 -->
<g id="node39" class="node">
<title>layer0_expert0_3</title>
<polygon fill="lightgreen" stroke="black" points="780,-4355.95 606,-4355.95 606,-4272.95 780,-4272.95 780,-4355.95"/>
<text text-anchor="middle" x="693" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU0</text>
<text text-anchor="middle" x="693" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="693" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="693" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="693" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_3 -->
<g id="edge17" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1530.77,-4426.32C1331.25,-4415.53 943.31,-4391.15 790,-4355.92"/>
<polygon fill="black" stroke="black" points="790.79,-4352.5 780.25,-4353.58 789.16,-4359.31 790.79,-4352.5"/>
</g>
<!-- layer0_expert0_4 -->
<g id="node40" class="node">
<title>layer0_expert0_4</title>
<polygon fill="lightgreen" stroke="black" points="972,-4355.95 798,-4355.95 798,-4272.95 972,-4272.95 972,-4355.95"/>
<text text-anchor="middle" x="885" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU0</text>
<text text-anchor="middle" x="885" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="885" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="885" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="885" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_4 -->
<g id="edge18" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1530.91,-4429C1397.03,-4422.86 1176.46,-4405.79 981.84,-4355.96"/>
<polygon fill="black" stroke="black" points="982.57,-4352.53 972.01,-4353.4 980.81,-4359.3 982.57,-4352.53"/>
</g>
<!-- layer0_expert0_5 -->
<g id="node41" class="node">
<title>layer0_expert0_5</title>
<polygon fill="lightgreen" stroke="black" points="1164,-4355.95 990,-4355.95 990,-4272.95 1164,-4272.95 1164,-4355.95"/>
<text text-anchor="middle" x="1077" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU0</text>
<text text-anchor="middle" x="1077" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1077" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1077" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1077" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_5 -->
<g id="edge19" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1530.91,-4421.21C1435.32,-4410.51 1299.37,-4391.09 1173.84,-4356"/>
<polygon fill="black" stroke="black" points="1174.63,-4352.59 1164.06,-4353.23 1172.72,-4359.32 1174.63,-4352.59"/>
</g>
<!-- layer0_expert0_6 -->
<g id="node42" class="node">
<title>layer0_expert0_6</title>
<polygon fill="lightgreen" stroke="black" points="1356,-4355.95 1182,-4355.95 1182,-4272.95 1356,-4272.95 1356,-4355.95"/>
<text text-anchor="middle" x="1269" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU0</text>
<text text-anchor="middle" x="1269" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1269" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1269" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1269" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_6 -->
<g id="edge20" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1530.66,-4403.97C1481.66,-4391.59 1424.72,-4375.96 1365.67,-4356.07"/>
<polygon fill="black" stroke="black" points="1366.77,-4352.75 1356.18,-4352.84 1364.52,-4359.37 1366.77,-4352.75"/>
</g>
<!-- layer0_expert0_7 -->
<g id="node43" class="node">
<title>layer0_expert0_7</title>
<polygon fill="lightgreen" stroke="black" points="1548,-4355.95 1374,-4355.95 1374,-4272.95 1548,-4272.95 1548,-4355.95"/>
<text text-anchor="middle" x="1461" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU0</text>
<text text-anchor="middle" x="1461" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1461" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1461" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1461" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_7 -->
<g id="edge21" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1586.39,-4391.86C1570.15,-4381.97 1552.68,-4371.32 1536.08,-4361.21"/>
<polygon fill="black" stroke="black" points="1537.86,-4358.19 1527.5,-4355.97 1534.21,-4364.17 1537.86,-4358.19"/>
</g>
<!-- layer0_expert0_8 -->
<g id="node44" class="node">
<title>layer0_expert0_8</title>
<polygon fill="lightgreen" stroke="black" points="1740,-4355.95 1566,-4355.95 1566,-4272.95 1740,-4272.95 1740,-4355.95"/>
<text text-anchor="middle" x="1653" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU0</text>
<text text-anchor="middle" x="1653" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1653" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1653" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1653" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_8 -->
<g id="edge22" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1653,-4391.86C1653,-4383.6 1653,-4374.82 1653,-4366.26"/>
<polygon fill="black" stroke="black" points="1656.5,-4365.97 1653,-4355.97 1649.5,-4365.97 1656.5,-4365.97"/>
</g>
<!-- layer0_expert0_9 -->
<g id="node45" class="node">
<title>layer0_expert0_9</title>
<polygon fill="lightgreen" stroke="black" points="1932,-4355.95 1758,-4355.95 1758,-4272.95 1932,-4272.95 1932,-4355.95"/>
<text text-anchor="middle" x="1845" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU0</text>
<text text-anchor="middle" x="1845" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1845" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1845" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1845" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_9 -->
<g id="edge23" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1719.61,-4391.86C1735.85,-4381.97 1753.32,-4371.32 1769.92,-4361.21"/>
<polygon fill="black" stroke="black" points="1771.79,-4364.17 1778.5,-4355.97 1768.14,-4358.19 1771.79,-4364.17"/>
</g>
<!-- layer0_expert0_10 -->
<g id="node46" class="node">
<title>layer0_expert0_10</title>
<polygon fill="lightgreen" stroke="black" points="2124,-4355.95 1950,-4355.95 1950,-4272.95 2124,-4272.95 2124,-4355.95"/>
<text text-anchor="middle" x="2037" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU0</text>
<text text-anchor="middle" x="2037" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2037" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2037" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2037" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_10 -->
<g id="edge24" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1775.34,-4403.97C1824.34,-4391.59 1881.28,-4375.96 1940.33,-4356.07"/>
<polygon fill="black" stroke="black" points="1941.48,-4359.37 1949.82,-4352.84 1939.23,-4352.75 1941.48,-4359.37"/>
</g>
<!-- layer0_expert0_11 -->
<g id="node47" class="node">
<title>layer0_expert0_11</title>
<polygon fill="lightgreen" stroke="black" points="2316,-4355.95 2142,-4355.95 2142,-4272.95 2316,-4272.95 2316,-4355.95"/>
<text text-anchor="middle" x="2229" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU0</text>
<text text-anchor="middle" x="2229" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2229" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2229" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2229" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_11 -->
<g id="edge25" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1775.09,-4421.21C1870.68,-4410.51 2006.63,-4391.09 2132.16,-4356"/>
<polygon fill="black" stroke="black" points="2133.28,-4359.32 2141.94,-4353.23 2131.37,-4352.59 2133.28,-4359.32"/>
</g>
<!-- layer0_expert0_12 -->
<g id="node48" class="node">
<title>layer0_expert0_12</title>
<polygon fill="lightgreen" stroke="black" points="2508,-4355.95 2334,-4355.95 2334,-4272.95 2508,-4272.95 2508,-4355.95"/>
<text text-anchor="middle" x="2421" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU0</text>
<text text-anchor="middle" x="2421" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2421" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2421" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2421" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_12 -->
<g id="edge26" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1775.09,-4429C1908.97,-4422.86 2129.54,-4405.79 2324.16,-4355.96"/>
<polygon fill="black" stroke="black" points="2325.19,-4359.3 2333.99,-4353.4 2323.43,-4352.53 2325.19,-4359.3"/>
</g>
<!-- layer0_expert0_13 -->
<g id="node49" class="node">
<title>layer0_expert0_13</title>
<polygon fill="lightgreen" stroke="black" points="2700,-4355.95 2526,-4355.95 2526,-4272.95 2700,-4272.95 2700,-4355.95"/>
<text text-anchor="middle" x="2613" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU0</text>
<text text-anchor="middle" x="2613" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2613" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2613" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2613" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_13 -->
<g id="edge27" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1775.23,-4426.32C1974.75,-4415.53 2362.69,-4391.15 2516,-4355.92"/>
<polygon fill="black" stroke="black" points="2516.84,-4359.31 2525.75,-4353.58 2515.21,-4352.5 2516.84,-4359.31"/>
</g>
<!-- layer0_expert0_14 -->
<g id="node50" class="node">
<title>layer0_expert0_14</title>
<polygon fill="lightgreen" stroke="black" points="2892,-4355.95 2718,-4355.95 2718,-4272.95 2892,-4272.95 2892,-4355.95"/>
<text text-anchor="middle" x="2805" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU0</text>
<text text-anchor="middle" x="2805" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2805" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2805" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2805" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_14 -->
<g id="edge28" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1775.08,-4428.61C2009.72,-4420.41 2516.62,-4398.58 2707.81,-4355.95"/>
<polygon fill="black" stroke="black" points="2708.81,-4359.31 2717.77,-4353.64 2707.23,-4352.49 2708.81,-4359.31"/>
</g>
<!-- layer0_expert0_15 -->
<g id="node51" class="node">
<title>layer0_expert0_15</title>
<polygon fill="lightgreen" stroke="black" points="3084,-4355.95 2910,-4355.95 2910,-4272.95 3084,-4272.95 3084,-4355.95"/>
<text text-anchor="middle" x="2997" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU0</text>
<text text-anchor="middle" x="2997" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2997" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2997" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2997" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_15 -->
<g id="edge29" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1775.18,-4430.19C2042.05,-4424.43 2670.75,-4406.07 2899.83,-4355.94"/>
<polygon fill="black" stroke="black" points="2900.8,-4359.31 2909.78,-4353.68 2899.25,-4352.48 2900.8,-4359.31"/>
</g>
<!-- layer0_moe_agg_gpu0 -->
<g id="node52" class="node">
<title>layer0_moe_agg_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1754.5,-4236.95 1551.5,-4236.95 1551.5,-4168.95 1754.5,-4168.95 1754.5,-4236.95"/>
<text text-anchor="middle" x="1653" y="-4221.75" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU0</text>
<text text-anchor="middle" x="1653" y="-4206.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="1653" y="-4191.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1653" y="-4176.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_expert0_0&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge30" class="edge">
<title>layer0_expert0_0&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M204.21,-4275.17C207.16,-4274.36 210.09,-4273.62 213,-4272.95 465.13,-4215.63 1248.27,-4205.89 1541.05,-4204.27"/>
<polygon fill="black" stroke="black" points="1541.27,-4207.77 1551.25,-4204.21 1541.24,-4200.77 1541.27,-4207.77"/>
</g>
<!-- layer0_expert0_1&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge31" class="edge">
<title>layer0_expert0_1&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M396.22,-4275.2C399.16,-4274.38 402.09,-4273.63 405,-4272.95 619.24,-4223.42 1276.44,-4209.07 1540.97,-4205.24"/>
<polygon fill="black" stroke="black" points="1541.41,-4208.73 1551.36,-4205.09 1541.31,-4201.73 1541.41,-4208.73"/>
</g>
<!-- layer0_expert0_2&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge32" class="edge">
<title>layer0_expert0_2&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M588.23,-4275.24C591.17,-4274.41 594.1,-4273.64 597,-4272.95 773.72,-4231.16 1307.22,-4212.77 1541.09,-4206.56"/>
<polygon fill="black" stroke="black" points="1541.42,-4210.05 1551.32,-4206.29 1541.23,-4203.05 1541.42,-4210.05"/>
</g>
<!-- layer0_expert0_3&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge33" class="edge">
<title>layer0_expert0_3&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M780.24,-4275.3C783.18,-4274.45 786.1,-4273.66 789,-4272.95 928.55,-4238.88 1340.54,-4217.25 1540.96,-4208.46"/>
<polygon fill="black" stroke="black" points="1541.39,-4211.94 1551.22,-4208.01 1541.08,-4204.95 1541.39,-4211.94"/>
</g>
<!-- layer0_expert0_4&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge34" class="edge">
<title>layer0_expert0_4&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M972.26,-4275.38C975.19,-4274.51 978.11,-4273.69 981,-4272.95 1173.8,-4223.56 1406.29,-4209.33 1541.12,-4205.35"/>
<polygon fill="black" stroke="black" points="1541.56,-4208.84 1551.46,-4205.06 1541.37,-4201.84 1541.56,-4208.84"/>
</g>
<!-- layer0_expert0_5&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge35" class="edge">
<title>layer0_expert0_5&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1164.04,-4275.62C1167.04,-4274.67 1170.04,-4273.78 1173,-4272.95 1296.52,-4238.64 1442.92,-4220.73 1541.28,-4211.86"/>
<polygon fill="black" stroke="black" points="1541.59,-4215.34 1551.24,-4210.97 1540.97,-4208.37 1541.59,-4215.34"/>
</g>
<!-- layer0_expert0_6&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge36" class="edge">
<title>layer0_expert0_6&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1356.15,-4275.97C1359.12,-4274.92 1362.08,-4273.91 1365,-4272.95 1422.25,-4254.16 1487.45,-4238.11 1541.32,-4226.23"/>
<polygon fill="black" stroke="black" points="1542.22,-4229.62 1551.24,-4224.06 1540.72,-4222.78 1542.22,-4229.62"/>
</g>
<!-- layer0_expert0_7&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge37" class="edge">
<title>layer0_expert0_7&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1532.22,-4272.84C1549.85,-4262.78 1568.68,-4252.04 1586.1,-4242.11"/>
<polygon fill="black" stroke="black" points="1588.11,-4244.99 1595.06,-4237 1584.64,-4238.91 1588.11,-4244.99"/>
</g>
<!-- layer0_expert0_8&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge38" class="edge">
<title>layer0_expert0_8&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1653,-4272.68C1653,-4264.47 1653,-4255.81 1653,-4247.51"/>
<polygon fill="black" stroke="black" points="1656.5,-4247.25 1653,-4237.25 1649.5,-4247.25 1656.5,-4247.25"/>
</g>
<!-- layer0_expert0_9&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge39" class="edge">
<title>layer0_expert0_9&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1773.78,-4272.84C1756.15,-4262.78 1737.32,-4252.04 1719.9,-4242.11"/>
<polygon fill="black" stroke="black" points="1721.36,-4238.91 1710.94,-4237 1717.89,-4244.99 1721.36,-4238.91"/>
</g>
<!-- layer0_expert0_10&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge40" class="edge">
<title>layer0_expert0_10&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1949.85,-4275.97C1946.88,-4274.92 1943.92,-4273.91 1941,-4272.95 1883.75,-4254.16 1818.55,-4238.11 1764.68,-4226.23"/>
<polygon fill="black" stroke="black" points="1765.28,-4222.78 1754.76,-4224.06 1763.78,-4229.62 1765.28,-4222.78"/>
</g>
<!-- layer0_expert0_11&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge41" class="edge">
<title>layer0_expert0_11&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2141.96,-4275.62C2138.96,-4274.67 2135.96,-4273.78 2133,-4272.95 2009.48,-4238.64 1863.08,-4220.73 1764.72,-4211.86"/>
<polygon fill="black" stroke="black" points="1765.03,-4208.37 1754.76,-4210.97 1764.41,-4215.34 1765.03,-4208.37"/>
</g>
<!-- layer0_expert0_12&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge42" class="edge">
<title>layer0_expert0_12&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2333.74,-4275.38C2330.81,-4274.51 2327.89,-4273.69 2325,-4272.95 2132.2,-4223.56 1899.71,-4209.33 1764.88,-4205.35"/>
<polygon fill="black" stroke="black" points="1764.63,-4201.84 1754.54,-4205.06 1764.44,-4208.84 1764.63,-4201.84"/>
</g>
<!-- layer0_expert0_13&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge43" class="edge">
<title>layer0_expert0_13&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2525.76,-4275.3C2522.82,-4274.45 2519.9,-4273.66 2517,-4272.95 2377.45,-4238.88 1965.46,-4217.25 1765.04,-4208.46"/>
<polygon fill="black" stroke="black" points="1764.92,-4204.95 1754.78,-4208.01 1764.61,-4211.94 1764.92,-4204.95"/>
</g>
<!-- layer0_expert0_14&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge44" class="edge">
<title>layer0_expert0_14&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2717.77,-4275.24C2714.83,-4274.41 2711.9,-4273.64 2709,-4272.95 2532.28,-4231.16 1998.78,-4212.77 1764.91,-4206.56"/>
<polygon fill="black" stroke="black" points="1764.77,-4203.05 1754.68,-4206.29 1764.58,-4210.05 1764.77,-4203.05"/>
</g>
<!-- layer0_expert0_15&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge45" class="edge">
<title>layer0_expert0_15&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2909.78,-4275.2C2906.84,-4274.38 2903.91,-4273.63 2901,-4272.95 2686.76,-4223.42 2029.56,-4209.07 1765.03,-4205.24"/>
<polygon fill="black" stroke="black" points="1764.69,-4201.73 1754.64,-4205.09 1764.59,-4208.73 1764.69,-4201.73"/>
</g>
<!-- layer0_moe_allreduce -->
<g id="node187" class="node">
<title>layer0_moe_allreduce</title>
<polygon fill="lightcoral" stroke="black" points="12309,-4132.95 12072,-4064.95 12309,-3996.95 12546,-4064.95 12309,-4132.95"/>
<text text-anchor="middle" x="12309" y="-4083.75" font-family="Times,serif" font-size="14.00">L0_MoE_All&#45;Reduce</text>
<text text-anchor="middle" x="12309" y="-4068.75" font-family="Times,serif" font-size="14.00">Input: 8×[1024,2048,4096]</text>
<text text-anchor="middle" x="12309" y="-4053.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12309" y="-4038.75" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce across GPUs 0&#45;7</text>
</g>
<!-- layer0_moe_agg_gpu0&#45;&gt;layer0_moe_allreduce -->
<g id="edge46" class="edge">
<title>layer0_moe_agg_gpu0&#45;&gt;layer0_moe_allreduce</title>
<path fill="none" stroke="black" d="M1754.63,-4200.66C2741.3,-4188.06 10611.46,-4087.62 12075.14,-4068.94"/>
<polygon fill="black" stroke="black" points="12075.29,-4072.44 12085.25,-4068.81 12075.2,-4065.44 12075.29,-4072.44"/>
</g>
<!-- layer0_output_gpu0 -->
<g id="node53" class="node">
<title>layer0_output_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="11514,-3960.95 11270,-3960.95 11270,-3892.95 11514,-3892.95 11514,-3960.95"/>
<text text-anchor="middle" x="11392" y="-3945.75" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU0</text>
<text text-anchor="middle" x="11392" y="-3930.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="11392" y="-3915.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11392" y="-3900.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_qkv_gpu0 -->
<g id="node188" class="node">
<title>layer1_qkv_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="11494,-3856.95 11294,-3856.95 11294,-3758.95 11494,-3758.95 11494,-3856.95"/>
<text text-anchor="middle" x="11394" y="-3841.75" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU0</text>
<text text-anchor="middle" x="11394" y="-3826.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11394" y="-3811.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11394" y="-3796.75" font-family="Times,serif" font-size="14.00">Heads: 0&#45;3</text>
<text text-anchor="middle" x="11394" y="-3781.75" font-family="Times,serif" font-size="14.00">TP Slice: 0</text>
<text text-anchor="middle" x="11394" y="-3766.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_output_gpu0&#45;&gt;layer1_qkv_gpu0 -->
<g id="edge321" class="edge">
<title>layer0_output_gpu0&#45;&gt;layer1_qkv_gpu0</title>
<path fill="none" stroke="black" d="M11392.57,-3892.74C11392.7,-3884.78 11392.85,-3876.04 11393,-3867.3"/>
<polygon fill="black" stroke="black" points="11396.51,-3867.16 11393.18,-3857.1 11389.51,-3867.04 11396.51,-3867.16"/>
</g>
<!-- layer0_expert1_0 -->
<g id="node55" class="node">
<title>layer0_expert1_0</title>
<polygon fill="lightgreen" stroke="black" points="3276,-4355.95 3102,-4355.95 3102,-4272.95 3276,-4272.95 3276,-4355.95"/>
<text text-anchor="middle" x="3189" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU1</text>
<text text-anchor="middle" x="3189" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3189" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3189" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3189" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_0 -->
<g id="edge53" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4602.8,-4431.37C4306.21,-4427.87 3553.59,-4413.65 3286.29,-4355.96"/>
<polygon fill="black" stroke="black" points="3286.74,-4352.48 3276.22,-4353.71 3285.22,-4359.31 3286.74,-4352.48"/>
</g>
<!-- layer0_expert1_1 -->
<g id="node56" class="node">
<title>layer0_expert1_1</title>
<polygon fill="lightgreen" stroke="black" points="3468,-4355.95 3294,-4355.95 3294,-4272.95 3468,-4272.95 3468,-4355.95"/>
<text text-anchor="middle" x="3381" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU1</text>
<text text-anchor="middle" x="3381" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3381" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3381" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3381" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_1 -->
<g id="edge54" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4602.82,-4430.19C4335.95,-4424.43 3707.25,-4406.07 3478.17,-4355.94"/>
<polygon fill="black" stroke="black" points="3478.75,-4352.48 3468.22,-4353.68 3477.2,-4359.31 3478.75,-4352.48"/>
</g>
<!-- layer0_expert1_2 -->
<g id="node57" class="node">
<title>layer0_expert1_2</title>
<polygon fill="lightgreen" stroke="black" points="3660,-4355.95 3486,-4355.95 3486,-4272.95 3660,-4272.95 3660,-4355.95"/>
<text text-anchor="middle" x="3573" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU1</text>
<text text-anchor="middle" x="3573" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3573" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3573" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3573" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_2 -->
<g id="edge55" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4602.92,-4428.61C4368.28,-4420.41 3861.38,-4398.58 3670.19,-4355.95"/>
<polygon fill="black" stroke="black" points="3670.77,-4352.49 3660.23,-4353.64 3669.19,-4359.31 3670.77,-4352.49"/>
</g>
<!-- layer0_expert1_3 -->
<g id="node58" class="node">
<title>layer0_expert1_3</title>
<polygon fill="lightgreen" stroke="black" points="3852,-4355.95 3678,-4355.95 3678,-4272.95 3852,-4272.95 3852,-4355.95"/>
<text text-anchor="middle" x="3765" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU1</text>
<text text-anchor="middle" x="3765" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3765" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3765" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3765" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_3 -->
<g id="edge56" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4602.77,-4426.32C4403.25,-4415.53 4015.31,-4391.15 3862,-4355.92"/>
<polygon fill="black" stroke="black" points="3862.79,-4352.5 3852.25,-4353.58 3861.16,-4359.31 3862.79,-4352.5"/>
</g>
<!-- layer0_expert1_4 -->
<g id="node59" class="node">
<title>layer0_expert1_4</title>
<polygon fill="lightgreen" stroke="black" points="4044,-4355.95 3870,-4355.95 3870,-4272.95 4044,-4272.95 4044,-4355.95"/>
<text text-anchor="middle" x="3957" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU1</text>
<text text-anchor="middle" x="3957" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3957" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3957" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3957" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_4 -->
<g id="edge57" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4602.91,-4429C4469.03,-4422.86 4248.46,-4405.79 4053.84,-4355.96"/>
<polygon fill="black" stroke="black" points="4054.57,-4352.53 4044.01,-4353.4 4052.81,-4359.3 4054.57,-4352.53"/>
</g>
<!-- layer0_expert1_5 -->
<g id="node60" class="node">
<title>layer0_expert1_5</title>
<polygon fill="lightgreen" stroke="black" points="4236,-4355.95 4062,-4355.95 4062,-4272.95 4236,-4272.95 4236,-4355.95"/>
<text text-anchor="middle" x="4149" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU1</text>
<text text-anchor="middle" x="4149" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4149" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4149" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4149" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_5 -->
<g id="edge58" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4602.91,-4421.21C4507.32,-4410.51 4371.37,-4391.09 4245.84,-4356"/>
<polygon fill="black" stroke="black" points="4246.63,-4352.59 4236.06,-4353.23 4244.72,-4359.32 4246.63,-4352.59"/>
</g>
<!-- layer0_expert1_6 -->
<g id="node61" class="node">
<title>layer0_expert1_6</title>
<polygon fill="lightgreen" stroke="black" points="4428,-4355.95 4254,-4355.95 4254,-4272.95 4428,-4272.95 4428,-4355.95"/>
<text text-anchor="middle" x="4341" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU1</text>
<text text-anchor="middle" x="4341" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4341" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4341" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4341" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_6 -->
<g id="edge59" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4602.66,-4403.97C4553.66,-4391.59 4496.72,-4375.96 4437.67,-4356.07"/>
<polygon fill="black" stroke="black" points="4438.77,-4352.75 4428.18,-4352.84 4436.52,-4359.37 4438.77,-4352.75"/>
</g>
<!-- layer0_expert1_7 -->
<g id="node62" class="node">
<title>layer0_expert1_7</title>
<polygon fill="lightgreen" stroke="black" points="4620,-4355.95 4446,-4355.95 4446,-4272.95 4620,-4272.95 4620,-4355.95"/>
<text text-anchor="middle" x="4533" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU1</text>
<text text-anchor="middle" x="4533" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4533" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4533" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4533" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_7 -->
<g id="edge60" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4658.39,-4391.86C4642.15,-4381.97 4624.68,-4371.32 4608.08,-4361.21"/>
<polygon fill="black" stroke="black" points="4609.86,-4358.19 4599.5,-4355.97 4606.21,-4364.17 4609.86,-4358.19"/>
</g>
<!-- layer0_expert1_8 -->
<g id="node63" class="node">
<title>layer0_expert1_8</title>
<polygon fill="lightgreen" stroke="black" points="4812,-4355.95 4638,-4355.95 4638,-4272.95 4812,-4272.95 4812,-4355.95"/>
<text text-anchor="middle" x="4725" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU1</text>
<text text-anchor="middle" x="4725" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4725" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4725" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4725" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_8 -->
<g id="edge61" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4725,-4391.86C4725,-4383.6 4725,-4374.82 4725,-4366.26"/>
<polygon fill="black" stroke="black" points="4728.5,-4365.97 4725,-4355.97 4721.5,-4365.97 4728.5,-4365.97"/>
</g>
<!-- layer0_expert1_9 -->
<g id="node64" class="node">
<title>layer0_expert1_9</title>
<polygon fill="lightgreen" stroke="black" points="5004,-4355.95 4830,-4355.95 4830,-4272.95 5004,-4272.95 5004,-4355.95"/>
<text text-anchor="middle" x="4917" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU1</text>
<text text-anchor="middle" x="4917" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4917" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4917" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4917" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_9 -->
<g id="edge62" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4791.61,-4391.86C4807.85,-4381.97 4825.32,-4371.32 4841.92,-4361.21"/>
<polygon fill="black" stroke="black" points="4843.79,-4364.17 4850.5,-4355.97 4840.14,-4358.19 4843.79,-4364.17"/>
</g>
<!-- layer0_expert1_10 -->
<g id="node65" class="node">
<title>layer0_expert1_10</title>
<polygon fill="lightgreen" stroke="black" points="5196,-4355.95 5022,-4355.95 5022,-4272.95 5196,-4272.95 5196,-4355.95"/>
<text text-anchor="middle" x="5109" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU1</text>
<text text-anchor="middle" x="5109" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5109" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5109" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5109" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_10 -->
<g id="edge63" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4847.34,-4403.97C4896.34,-4391.59 4953.28,-4375.96 5012.33,-4356.07"/>
<polygon fill="black" stroke="black" points="5013.48,-4359.37 5021.82,-4352.84 5011.23,-4352.75 5013.48,-4359.37"/>
</g>
<!-- layer0_expert1_11 -->
<g id="node66" class="node">
<title>layer0_expert1_11</title>
<polygon fill="lightgreen" stroke="black" points="5388,-4355.95 5214,-4355.95 5214,-4272.95 5388,-4272.95 5388,-4355.95"/>
<text text-anchor="middle" x="5301" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU1</text>
<text text-anchor="middle" x="5301" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5301" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5301" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5301" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_11 -->
<g id="edge64" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4847.09,-4421.21C4942.68,-4410.51 5078.63,-4391.09 5204.16,-4356"/>
<polygon fill="black" stroke="black" points="5205.28,-4359.32 5213.94,-4353.23 5203.37,-4352.59 5205.28,-4359.32"/>
</g>
<!-- layer0_expert1_12 -->
<g id="node67" class="node">
<title>layer0_expert1_12</title>
<polygon fill="lightgreen" stroke="black" points="5580,-4355.95 5406,-4355.95 5406,-4272.95 5580,-4272.95 5580,-4355.95"/>
<text text-anchor="middle" x="5493" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU1</text>
<text text-anchor="middle" x="5493" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5493" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5493" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5493" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_12 -->
<g id="edge65" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4847.09,-4429C4980.97,-4422.86 5201.54,-4405.79 5396.16,-4355.96"/>
<polygon fill="black" stroke="black" points="5397.19,-4359.3 5405.99,-4353.4 5395.43,-4352.53 5397.19,-4359.3"/>
</g>
<!-- layer0_expert1_13 -->
<g id="node68" class="node">
<title>layer0_expert1_13</title>
<polygon fill="lightgreen" stroke="black" points="5772,-4355.95 5598,-4355.95 5598,-4272.95 5772,-4272.95 5772,-4355.95"/>
<text text-anchor="middle" x="5685" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU1</text>
<text text-anchor="middle" x="5685" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5685" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5685" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5685" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_13 -->
<g id="edge66" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4847.23,-4426.32C5046.75,-4415.53 5434.69,-4391.15 5588,-4355.92"/>
<polygon fill="black" stroke="black" points="5588.84,-4359.31 5597.75,-4353.58 5587.21,-4352.5 5588.84,-4359.31"/>
</g>
<!-- layer0_expert1_14 -->
<g id="node69" class="node">
<title>layer0_expert1_14</title>
<polygon fill="lightgreen" stroke="black" points="5964,-4355.95 5790,-4355.95 5790,-4272.95 5964,-4272.95 5964,-4355.95"/>
<text text-anchor="middle" x="5877" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU1</text>
<text text-anchor="middle" x="5877" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5877" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5877" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5877" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_14 -->
<g id="edge67" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4847.08,-4428.61C5081.72,-4420.41 5588.62,-4398.58 5779.81,-4355.95"/>
<polygon fill="black" stroke="black" points="5780.81,-4359.31 5789.77,-4353.64 5779.23,-4352.49 5780.81,-4359.31"/>
</g>
<!-- layer0_expert1_15 -->
<g id="node70" class="node">
<title>layer0_expert1_15</title>
<polygon fill="lightgreen" stroke="black" points="6156,-4355.95 5982,-4355.95 5982,-4272.95 6156,-4272.95 6156,-4355.95"/>
<text text-anchor="middle" x="6069" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU1</text>
<text text-anchor="middle" x="6069" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6069" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6069" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6069" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_15 -->
<g id="edge68" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4847.18,-4430.19C5114.05,-4424.43 5742.75,-4406.07 5971.83,-4355.94"/>
<polygon fill="black" stroke="black" points="5972.8,-4359.31 5981.78,-4353.68 5971.25,-4352.48 5972.8,-4359.31"/>
</g>
<!-- layer0_moe_agg_gpu1 -->
<g id="node71" class="node">
<title>layer0_moe_agg_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="4826.5,-4236.95 4623.5,-4236.95 4623.5,-4168.95 4826.5,-4168.95 4826.5,-4236.95"/>
<text text-anchor="middle" x="4725" y="-4221.75" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU1</text>
<text text-anchor="middle" x="4725" y="-4206.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="4725" y="-4191.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="4725" y="-4176.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_expert1_0&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge69" class="edge">
<title>layer0_expert1_0&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3276.21,-4275.17C3279.16,-4274.36 3282.09,-4273.62 3285,-4272.95 3537.13,-4215.63 4320.27,-4205.89 4613.05,-4204.27"/>
<polygon fill="black" stroke="black" points="4613.27,-4207.77 4623.25,-4204.21 4613.24,-4200.77 4613.27,-4207.77"/>
</g>
<!-- layer0_expert1_1&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge70" class="edge">
<title>layer0_expert1_1&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3468.22,-4275.2C3471.16,-4274.38 3474.09,-4273.63 3477,-4272.95 3691.24,-4223.42 4348.44,-4209.07 4612.97,-4205.24"/>
<polygon fill="black" stroke="black" points="4613.41,-4208.73 4623.36,-4205.09 4613.31,-4201.73 4613.41,-4208.73"/>
</g>
<!-- layer0_expert1_2&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge71" class="edge">
<title>layer0_expert1_2&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3660.23,-4275.24C3663.17,-4274.41 3666.1,-4273.64 3669,-4272.95 3845.72,-4231.16 4379.22,-4212.77 4613.09,-4206.56"/>
<polygon fill="black" stroke="black" points="4613.42,-4210.05 4623.32,-4206.29 4613.23,-4203.05 4613.42,-4210.05"/>
</g>
<!-- layer0_expert1_3&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge72" class="edge">
<title>layer0_expert1_3&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3852.24,-4275.3C3855.18,-4274.45 3858.1,-4273.66 3861,-4272.95 4000.55,-4238.88 4412.54,-4217.25 4612.96,-4208.46"/>
<polygon fill="black" stroke="black" points="4613.39,-4211.94 4623.22,-4208.01 4613.08,-4204.95 4613.39,-4211.94"/>
</g>
<!-- layer0_expert1_4&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge73" class="edge">
<title>layer0_expert1_4&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4044.26,-4275.38C4047.19,-4274.51 4050.11,-4273.69 4053,-4272.95 4245.8,-4223.56 4478.29,-4209.33 4613.12,-4205.35"/>
<polygon fill="black" stroke="black" points="4613.56,-4208.84 4623.46,-4205.06 4613.37,-4201.84 4613.56,-4208.84"/>
</g>
<!-- layer0_expert1_5&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge74" class="edge">
<title>layer0_expert1_5&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4236.04,-4275.62C4239.04,-4274.67 4242.04,-4273.78 4245,-4272.95 4368.52,-4238.64 4514.92,-4220.73 4613.28,-4211.86"/>
<polygon fill="black" stroke="black" points="4613.59,-4215.34 4623.24,-4210.97 4612.97,-4208.37 4613.59,-4215.34"/>
</g>
<!-- layer0_expert1_6&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge75" class="edge">
<title>layer0_expert1_6&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4428.15,-4275.97C4431.12,-4274.92 4434.08,-4273.91 4437,-4272.95 4494.25,-4254.16 4559.45,-4238.11 4613.32,-4226.23"/>
<polygon fill="black" stroke="black" points="4614.22,-4229.62 4623.24,-4224.06 4612.72,-4222.78 4614.22,-4229.62"/>
</g>
<!-- layer0_expert1_7&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge76" class="edge">
<title>layer0_expert1_7&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4604.22,-4272.84C4621.85,-4262.78 4640.68,-4252.04 4658.1,-4242.11"/>
<polygon fill="black" stroke="black" points="4660.11,-4244.99 4667.06,-4237 4656.64,-4238.91 4660.11,-4244.99"/>
</g>
<!-- layer0_expert1_8&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge77" class="edge">
<title>layer0_expert1_8&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4725,-4272.68C4725,-4264.47 4725,-4255.81 4725,-4247.51"/>
<polygon fill="black" stroke="black" points="4728.5,-4247.25 4725,-4237.25 4721.5,-4247.25 4728.5,-4247.25"/>
</g>
<!-- layer0_expert1_9&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge78" class="edge">
<title>layer0_expert1_9&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4845.78,-4272.84C4828.15,-4262.78 4809.32,-4252.04 4791.9,-4242.11"/>
<polygon fill="black" stroke="black" points="4793.36,-4238.91 4782.94,-4237 4789.89,-4244.99 4793.36,-4238.91"/>
</g>
<!-- layer0_expert1_10&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge79" class="edge">
<title>layer0_expert1_10&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5021.85,-4275.97C5018.88,-4274.92 5015.92,-4273.91 5013,-4272.95 4955.75,-4254.16 4890.55,-4238.11 4836.68,-4226.23"/>
<polygon fill="black" stroke="black" points="4837.28,-4222.78 4826.76,-4224.06 4835.78,-4229.62 4837.28,-4222.78"/>
</g>
<!-- layer0_expert1_11&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge80" class="edge">
<title>layer0_expert1_11&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5213.96,-4275.62C5210.96,-4274.67 5207.96,-4273.78 5205,-4272.95 5081.48,-4238.64 4935.08,-4220.73 4836.72,-4211.86"/>
<polygon fill="black" stroke="black" points="4837.03,-4208.37 4826.76,-4210.97 4836.41,-4215.34 4837.03,-4208.37"/>
</g>
<!-- layer0_expert1_12&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge81" class="edge">
<title>layer0_expert1_12&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5405.74,-4275.38C5402.81,-4274.51 5399.89,-4273.69 5397,-4272.95 5204.2,-4223.56 4971.71,-4209.33 4836.88,-4205.35"/>
<polygon fill="black" stroke="black" points="4836.63,-4201.84 4826.54,-4205.06 4836.44,-4208.84 4836.63,-4201.84"/>
</g>
<!-- layer0_expert1_13&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge82" class="edge">
<title>layer0_expert1_13&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5597.76,-4275.3C5594.82,-4274.45 5591.9,-4273.66 5589,-4272.95 5449.45,-4238.88 5037.46,-4217.25 4837.04,-4208.46"/>
<polygon fill="black" stroke="black" points="4836.92,-4204.95 4826.78,-4208.01 4836.61,-4211.94 4836.92,-4204.95"/>
</g>
<!-- layer0_expert1_14&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge83" class="edge">
<title>layer0_expert1_14&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5789.77,-4275.24C5786.83,-4274.41 5783.9,-4273.64 5781,-4272.95 5604.28,-4231.16 5070.78,-4212.77 4836.91,-4206.56"/>
<polygon fill="black" stroke="black" points="4836.77,-4203.05 4826.68,-4206.29 4836.58,-4210.05 4836.77,-4203.05"/>
</g>
<!-- layer0_expert1_15&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge84" class="edge">
<title>layer0_expert1_15&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5981.78,-4275.2C5978.84,-4274.38 5975.91,-4273.63 5973,-4272.95 5758.76,-4223.42 5101.56,-4209.07 4837.03,-4205.24"/>
<polygon fill="black" stroke="black" points="4836.69,-4201.73 4826.64,-4205.09 4836.59,-4208.73 4836.69,-4201.73"/>
</g>
<!-- layer0_moe_agg_gpu1&#45;&gt;layer0_moe_allreduce -->
<g id="edge85" class="edge">
<title>layer0_moe_agg_gpu1&#45;&gt;layer0_moe_allreduce</title>
<path fill="none" stroke="black" d="M4826.83,-4200.13C5627.22,-4185.77 10906.32,-4091.11 12078.64,-4070.08"/>
<polygon fill="black" stroke="black" points="12078.93,-4073.58 12088.86,-4069.9 12078.8,-4066.58 12078.93,-4073.58"/>
</g>
<!-- layer0_output_gpu1 -->
<g id="node72" class="node">
<title>layer0_output_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11776,-3960.95 11532,-3960.95 11532,-3892.95 11776,-3892.95 11776,-3960.95"/>
<text text-anchor="middle" x="11654" y="-3945.75" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU1</text>
<text text-anchor="middle" x="11654" y="-3930.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="11654" y="-3915.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11654" y="-3900.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_qkv_gpu1 -->
<g id="node191" class="node">
<title>layer1_qkv_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11754,-3856.95 11554,-3856.95 11554,-3758.95 11754,-3758.95 11754,-3856.95"/>
<text text-anchor="middle" x="11654" y="-3841.75" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU1</text>
<text text-anchor="middle" x="11654" y="-3826.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11654" y="-3811.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11654" y="-3796.75" font-family="Times,serif" font-size="14.00">Heads: 4&#45;7</text>
<text text-anchor="middle" x="11654" y="-3781.75" font-family="Times,serif" font-size="14.00">TP Slice: 1</text>
<text text-anchor="middle" x="11654" y="-3766.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_output_gpu1&#45;&gt;layer1_qkv_gpu1 -->
<g id="edge322" class="edge">
<title>layer0_output_gpu1&#45;&gt;layer1_qkv_gpu1</title>
<path fill="none" stroke="black" d="M11654,-3892.74C11654,-3884.78 11654,-3876.04 11654,-3867.3"/>
<polygon fill="black" stroke="black" points="11657.5,-3867.1 11654,-3857.1 11650.5,-3867.1 11657.5,-3867.1"/>
</g>
<!-- layer0_expert2_0 -->
<g id="node74" class="node">
<title>layer0_expert2_0</title>
<polygon fill="lightgreen" stroke="black" points="6348,-4355.95 6174,-4355.95 6174,-4272.95 6348,-4272.95 6348,-4355.95"/>
<text text-anchor="middle" x="6261" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU2</text>
<text text-anchor="middle" x="6261" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6261" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6261" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6261" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_0 -->
<g id="edge92" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7674.8,-4431.37C7378.21,-4427.87 6625.59,-4413.65 6358.29,-4355.96"/>
<polygon fill="black" stroke="black" points="6358.74,-4352.48 6348.22,-4353.71 6357.22,-4359.31 6358.74,-4352.48"/>
</g>
<!-- layer0_expert2_1 -->
<g id="node75" class="node">
<title>layer0_expert2_1</title>
<polygon fill="lightgreen" stroke="black" points="6540,-4355.95 6366,-4355.95 6366,-4272.95 6540,-4272.95 6540,-4355.95"/>
<text text-anchor="middle" x="6453" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU2</text>
<text text-anchor="middle" x="6453" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6453" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6453" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6453" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_1 -->
<g id="edge93" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7674.82,-4430.19C7407.95,-4424.43 6779.25,-4406.07 6550.17,-4355.94"/>
<polygon fill="black" stroke="black" points="6550.75,-4352.48 6540.22,-4353.68 6549.2,-4359.31 6550.75,-4352.48"/>
</g>
<!-- layer0_expert2_2 -->
<g id="node76" class="node">
<title>layer0_expert2_2</title>
<polygon fill="lightgreen" stroke="black" points="6732,-4355.95 6558,-4355.95 6558,-4272.95 6732,-4272.95 6732,-4355.95"/>
<text text-anchor="middle" x="6645" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU2</text>
<text text-anchor="middle" x="6645" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6645" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6645" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6645" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_2 -->
<g id="edge94" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7674.92,-4428.61C7440.28,-4420.41 6933.38,-4398.58 6742.19,-4355.95"/>
<polygon fill="black" stroke="black" points="6742.77,-4352.49 6732.23,-4353.64 6741.19,-4359.31 6742.77,-4352.49"/>
</g>
<!-- layer0_expert2_3 -->
<g id="node77" class="node">
<title>layer0_expert2_3</title>
<polygon fill="lightgreen" stroke="black" points="6924,-4355.95 6750,-4355.95 6750,-4272.95 6924,-4272.95 6924,-4355.95"/>
<text text-anchor="middle" x="6837" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU2</text>
<text text-anchor="middle" x="6837" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6837" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6837" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6837" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_3 -->
<g id="edge95" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7674.77,-4426.32C7475.25,-4415.53 7087.31,-4391.15 6934,-4355.92"/>
<polygon fill="black" stroke="black" points="6934.79,-4352.5 6924.25,-4353.58 6933.16,-4359.31 6934.79,-4352.5"/>
</g>
<!-- layer0_expert2_4 -->
<g id="node78" class="node">
<title>layer0_expert2_4</title>
<polygon fill="lightgreen" stroke="black" points="7116,-4355.95 6942,-4355.95 6942,-4272.95 7116,-4272.95 7116,-4355.95"/>
<text text-anchor="middle" x="7029" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU2</text>
<text text-anchor="middle" x="7029" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7029" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7029" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7029" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_4 -->
<g id="edge96" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7674.91,-4429C7541.03,-4422.86 7320.46,-4405.79 7125.84,-4355.96"/>
<polygon fill="black" stroke="black" points="7126.57,-4352.53 7116.01,-4353.4 7124.81,-4359.3 7126.57,-4352.53"/>
</g>
<!-- layer0_expert2_5 -->
<g id="node79" class="node">
<title>layer0_expert2_5</title>
<polygon fill="lightgreen" stroke="black" points="7308,-4355.95 7134,-4355.95 7134,-4272.95 7308,-4272.95 7308,-4355.95"/>
<text text-anchor="middle" x="7221" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU2</text>
<text text-anchor="middle" x="7221" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7221" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7221" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7221" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_5 -->
<g id="edge97" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7674.91,-4421.21C7579.32,-4410.51 7443.37,-4391.09 7317.84,-4356"/>
<polygon fill="black" stroke="black" points="7318.63,-4352.59 7308.06,-4353.23 7316.72,-4359.32 7318.63,-4352.59"/>
</g>
<!-- layer0_expert2_6 -->
<g id="node80" class="node">
<title>layer0_expert2_6</title>
<polygon fill="lightgreen" stroke="black" points="7500,-4355.95 7326,-4355.95 7326,-4272.95 7500,-4272.95 7500,-4355.95"/>
<text text-anchor="middle" x="7413" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU2</text>
<text text-anchor="middle" x="7413" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7413" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7413" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7413" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_6 -->
<g id="edge98" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7674.66,-4403.97C7625.66,-4391.59 7568.72,-4375.96 7509.67,-4356.07"/>
<polygon fill="black" stroke="black" points="7510.77,-4352.75 7500.18,-4352.84 7508.52,-4359.37 7510.77,-4352.75"/>
</g>
<!-- layer0_expert2_7 -->
<g id="node81" class="node">
<title>layer0_expert2_7</title>
<polygon fill="lightgreen" stroke="black" points="7692,-4355.95 7518,-4355.95 7518,-4272.95 7692,-4272.95 7692,-4355.95"/>
<text text-anchor="middle" x="7605" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU2</text>
<text text-anchor="middle" x="7605" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7605" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7605" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7605" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_7 -->
<g id="edge99" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7730.39,-4391.86C7714.15,-4381.97 7696.68,-4371.32 7680.08,-4361.21"/>
<polygon fill="black" stroke="black" points="7681.86,-4358.19 7671.5,-4355.97 7678.21,-4364.17 7681.86,-4358.19"/>
</g>
<!-- layer0_expert2_8 -->
<g id="node82" class="node">
<title>layer0_expert2_8</title>
<polygon fill="lightgreen" stroke="black" points="7884,-4355.95 7710,-4355.95 7710,-4272.95 7884,-4272.95 7884,-4355.95"/>
<text text-anchor="middle" x="7797" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU2</text>
<text text-anchor="middle" x="7797" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7797" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7797" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7797" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_8 -->
<g id="edge100" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7797,-4391.86C7797,-4383.6 7797,-4374.82 7797,-4366.26"/>
<polygon fill="black" stroke="black" points="7800.5,-4365.97 7797,-4355.97 7793.5,-4365.97 7800.5,-4365.97"/>
</g>
<!-- layer0_expert2_9 -->
<g id="node83" class="node">
<title>layer0_expert2_9</title>
<polygon fill="lightgreen" stroke="black" points="8076,-4355.95 7902,-4355.95 7902,-4272.95 8076,-4272.95 8076,-4355.95"/>
<text text-anchor="middle" x="7989" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU2</text>
<text text-anchor="middle" x="7989" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7989" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7989" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7989" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_9 -->
<g id="edge101" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7863.61,-4391.86C7879.85,-4381.97 7897.32,-4371.32 7913.92,-4361.21"/>
<polygon fill="black" stroke="black" points="7915.79,-4364.17 7922.5,-4355.97 7912.14,-4358.19 7915.79,-4364.17"/>
</g>
<!-- layer0_expert2_10 -->
<g id="node84" class="node">
<title>layer0_expert2_10</title>
<polygon fill="lightgreen" stroke="black" points="8268,-4355.95 8094,-4355.95 8094,-4272.95 8268,-4272.95 8268,-4355.95"/>
<text text-anchor="middle" x="8181" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU2</text>
<text text-anchor="middle" x="8181" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8181" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8181" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8181" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_10 -->
<g id="edge102" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7919.34,-4403.97C7968.34,-4391.59 8025.28,-4375.96 8084.33,-4356.07"/>
<polygon fill="black" stroke="black" points="8085.48,-4359.37 8093.82,-4352.84 8083.23,-4352.75 8085.48,-4359.37"/>
</g>
<!-- layer0_expert2_11 -->
<g id="node85" class="node">
<title>layer0_expert2_11</title>
<polygon fill="lightgreen" stroke="black" points="8460,-4355.95 8286,-4355.95 8286,-4272.95 8460,-4272.95 8460,-4355.95"/>
<text text-anchor="middle" x="8373" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU2</text>
<text text-anchor="middle" x="8373" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8373" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8373" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8373" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_11 -->
<g id="edge103" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7919.09,-4421.21C8014.68,-4410.51 8150.63,-4391.09 8276.16,-4356"/>
<polygon fill="black" stroke="black" points="8277.28,-4359.32 8285.94,-4353.23 8275.37,-4352.59 8277.28,-4359.32"/>
</g>
<!-- layer0_expert2_12 -->
<g id="node86" class="node">
<title>layer0_expert2_12</title>
<polygon fill="lightgreen" stroke="black" points="8652,-4355.95 8478,-4355.95 8478,-4272.95 8652,-4272.95 8652,-4355.95"/>
<text text-anchor="middle" x="8565" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU2</text>
<text text-anchor="middle" x="8565" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8565" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8565" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8565" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_12 -->
<g id="edge104" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7919.09,-4429C8052.97,-4422.86 8273.54,-4405.79 8468.16,-4355.96"/>
<polygon fill="black" stroke="black" points="8469.19,-4359.3 8477.99,-4353.4 8467.43,-4352.53 8469.19,-4359.3"/>
</g>
<!-- layer0_expert2_13 -->
<g id="node87" class="node">
<title>layer0_expert2_13</title>
<polygon fill="lightgreen" stroke="black" points="8844,-4355.95 8670,-4355.95 8670,-4272.95 8844,-4272.95 8844,-4355.95"/>
<text text-anchor="middle" x="8757" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU2</text>
<text text-anchor="middle" x="8757" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8757" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8757" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8757" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_13 -->
<g id="edge105" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7919.23,-4426.32C8118.75,-4415.53 8506.69,-4391.15 8660,-4355.92"/>
<polygon fill="black" stroke="black" points="8660.84,-4359.31 8669.75,-4353.58 8659.21,-4352.5 8660.84,-4359.31"/>
</g>
<!-- layer0_expert2_14 -->
<g id="node88" class="node">
<title>layer0_expert2_14</title>
<polygon fill="lightgreen" stroke="black" points="9036,-4355.95 8862,-4355.95 8862,-4272.95 9036,-4272.95 9036,-4355.95"/>
<text text-anchor="middle" x="8949" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU2</text>
<text text-anchor="middle" x="8949" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8949" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8949" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8949" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_14 -->
<g id="edge106" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7919.08,-4428.61C8153.72,-4420.41 8660.62,-4398.58 8851.81,-4355.95"/>
<polygon fill="black" stroke="black" points="8852.81,-4359.31 8861.77,-4353.64 8851.23,-4352.49 8852.81,-4359.31"/>
</g>
<!-- layer0_expert2_15 -->
<g id="node89" class="node">
<title>layer0_expert2_15</title>
<polygon fill="lightgreen" stroke="black" points="9228,-4355.95 9054,-4355.95 9054,-4272.95 9228,-4272.95 9228,-4355.95"/>
<text text-anchor="middle" x="9141" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU2</text>
<text text-anchor="middle" x="9141" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9141" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9141" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9141" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_15 -->
<g id="edge107" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7919.18,-4430.19C8186.05,-4424.43 8814.75,-4406.07 9043.83,-4355.94"/>
<polygon fill="black" stroke="black" points="9044.8,-4359.31 9053.78,-4353.68 9043.25,-4352.48 9044.8,-4359.31"/>
</g>
<!-- layer0_moe_agg_gpu2 -->
<g id="node90" class="node">
<title>layer0_moe_agg_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="7898.5,-4236.95 7695.5,-4236.95 7695.5,-4168.95 7898.5,-4168.95 7898.5,-4236.95"/>
<text text-anchor="middle" x="7797" y="-4221.75" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU2</text>
<text text-anchor="middle" x="7797" y="-4206.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="7797" y="-4191.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="7797" y="-4176.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_expert2_0&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge108" class="edge">
<title>layer0_expert2_0&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6348.21,-4275.17C6351.16,-4274.36 6354.09,-4273.62 6357,-4272.95 6609.13,-4215.63 7392.27,-4205.89 7685.05,-4204.27"/>
<polygon fill="black" stroke="black" points="7685.27,-4207.77 7695.25,-4204.21 7685.24,-4200.77 7685.27,-4207.77"/>
</g>
<!-- layer0_expert2_1&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge109" class="edge">
<title>layer0_expert2_1&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6540.22,-4275.2C6543.16,-4274.38 6546.09,-4273.63 6549,-4272.95 6763.24,-4223.42 7420.44,-4209.07 7684.97,-4205.24"/>
<polygon fill="black" stroke="black" points="7685.41,-4208.73 7695.36,-4205.09 7685.31,-4201.73 7685.41,-4208.73"/>
</g>
<!-- layer0_expert2_2&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge110" class="edge">
<title>layer0_expert2_2&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6732.23,-4275.24C6735.17,-4274.41 6738.1,-4273.64 6741,-4272.95 6917.72,-4231.16 7451.22,-4212.77 7685.09,-4206.56"/>
<polygon fill="black" stroke="black" points="7685.42,-4210.05 7695.32,-4206.29 7685.23,-4203.05 7685.42,-4210.05"/>
</g>
<!-- layer0_expert2_3&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge111" class="edge">
<title>layer0_expert2_3&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6924.24,-4275.3C6927.18,-4274.45 6930.1,-4273.66 6933,-4272.95 7072.55,-4238.88 7484.54,-4217.25 7684.96,-4208.46"/>
<polygon fill="black" stroke="black" points="7685.39,-4211.94 7695.22,-4208.01 7685.08,-4204.95 7685.39,-4211.94"/>
</g>
<!-- layer0_expert2_4&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge112" class="edge">
<title>layer0_expert2_4&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7116.26,-4275.38C7119.19,-4274.51 7122.11,-4273.69 7125,-4272.95 7317.8,-4223.56 7550.29,-4209.33 7685.12,-4205.35"/>
<polygon fill="black" stroke="black" points="7685.56,-4208.84 7695.46,-4205.06 7685.37,-4201.84 7685.56,-4208.84"/>
</g>
<!-- layer0_expert2_5&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge113" class="edge">
<title>layer0_expert2_5&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7308.04,-4275.62C7311.04,-4274.67 7314.04,-4273.78 7317,-4272.95 7440.52,-4238.64 7586.92,-4220.73 7685.28,-4211.86"/>
<polygon fill="black" stroke="black" points="7685.59,-4215.34 7695.24,-4210.97 7684.97,-4208.37 7685.59,-4215.34"/>
</g>
<!-- layer0_expert2_6&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge114" class="edge">
<title>layer0_expert2_6&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7500.15,-4275.97C7503.12,-4274.92 7506.08,-4273.91 7509,-4272.95 7566.25,-4254.16 7631.45,-4238.11 7685.32,-4226.23"/>
<polygon fill="black" stroke="black" points="7686.22,-4229.62 7695.24,-4224.06 7684.72,-4222.78 7686.22,-4229.62"/>
</g>
<!-- layer0_expert2_7&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge115" class="edge">
<title>layer0_expert2_7&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7676.22,-4272.84C7693.85,-4262.78 7712.68,-4252.04 7730.1,-4242.11"/>
<polygon fill="black" stroke="black" points="7732.11,-4244.99 7739.06,-4237 7728.64,-4238.91 7732.11,-4244.99"/>
</g>
<!-- layer0_expert2_8&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge116" class="edge">
<title>layer0_expert2_8&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7797,-4272.68C7797,-4264.47 7797,-4255.81 7797,-4247.51"/>
<polygon fill="black" stroke="black" points="7800.5,-4247.25 7797,-4237.25 7793.5,-4247.25 7800.5,-4247.25"/>
</g>
<!-- layer0_expert2_9&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge117" class="edge">
<title>layer0_expert2_9&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7917.78,-4272.84C7900.15,-4262.78 7881.32,-4252.04 7863.9,-4242.11"/>
<polygon fill="black" stroke="black" points="7865.36,-4238.91 7854.94,-4237 7861.89,-4244.99 7865.36,-4238.91"/>
</g>
<!-- layer0_expert2_10&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge118" class="edge">
<title>layer0_expert2_10&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8093.85,-4275.97C8090.88,-4274.92 8087.92,-4273.91 8085,-4272.95 8027.75,-4254.16 7962.55,-4238.11 7908.68,-4226.23"/>
<polygon fill="black" stroke="black" points="7909.28,-4222.78 7898.76,-4224.06 7907.78,-4229.62 7909.28,-4222.78"/>
</g>
<!-- layer0_expert2_11&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge119" class="edge">
<title>layer0_expert2_11&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8285.96,-4275.62C8282.96,-4274.67 8279.96,-4273.78 8277,-4272.95 8153.48,-4238.64 8007.08,-4220.73 7908.72,-4211.86"/>
<polygon fill="black" stroke="black" points="7909.03,-4208.37 7898.76,-4210.97 7908.41,-4215.34 7909.03,-4208.37"/>
</g>
<!-- layer0_expert2_12&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge120" class="edge">
<title>layer0_expert2_12&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8477.74,-4275.38C8474.81,-4274.51 8471.89,-4273.69 8469,-4272.95 8276.2,-4223.56 8043.71,-4209.33 7908.88,-4205.35"/>
<polygon fill="black" stroke="black" points="7908.63,-4201.84 7898.54,-4205.06 7908.44,-4208.84 7908.63,-4201.84"/>
</g>
<!-- layer0_expert2_13&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge121" class="edge">
<title>layer0_expert2_13&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8669.76,-4275.3C8666.82,-4274.45 8663.9,-4273.66 8661,-4272.95 8521.45,-4238.88 8109.46,-4217.25 7909.04,-4208.46"/>
<polygon fill="black" stroke="black" points="7908.92,-4204.95 7898.78,-4208.01 7908.61,-4211.94 7908.92,-4204.95"/>
</g>
<!-- layer0_expert2_14&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge122" class="edge">
<title>layer0_expert2_14&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8861.77,-4275.24C8858.83,-4274.41 8855.9,-4273.64 8853,-4272.95 8676.28,-4231.16 8142.78,-4212.77 7908.91,-4206.56"/>
<polygon fill="black" stroke="black" points="7908.77,-4203.05 7898.68,-4206.29 7908.58,-4210.05 7908.77,-4203.05"/>
</g>
<!-- layer0_expert2_15&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge123" class="edge">
<title>layer0_expert2_15&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M9053.78,-4275.2C9050.84,-4274.38 9047.91,-4273.63 9045,-4272.95 8830.76,-4223.42 8173.56,-4209.07 7909.03,-4205.24"/>
<polygon fill="black" stroke="black" points="7908.69,-4201.73 7898.64,-4205.09 7908.59,-4208.73 7908.69,-4201.73"/>
</g>
<!-- layer0_moe_agg_gpu2&#45;&gt;layer0_moe_allreduce -->
<g id="edge124" class="edge">
<title>layer0_moe_agg_gpu2&#45;&gt;layer0_moe_allreduce</title>
<path fill="none" stroke="black" d="M7898.64,-4198.89C8468.87,-4181.7 11273.83,-4097.16 12087.42,-4072.63"/>
<polygon fill="black" stroke="black" points="12087.6,-4076.13 12097.49,-4072.33 12087.39,-4069.13 12087.6,-4076.13"/>
</g>
<!-- layer0_output_gpu2 -->
<g id="node91" class="node">
<title>layer0_output_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="12038,-3960.95 11794,-3960.95 11794,-3892.95 12038,-3892.95 12038,-3960.95"/>
<text text-anchor="middle" x="11916" y="-3945.75" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU2</text>
<text text-anchor="middle" x="11916" y="-3930.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="11916" y="-3915.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11916" y="-3900.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_qkv_gpu2 -->
<g id="node194" class="node">
<title>layer1_qkv_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="12017,-3856.95 11817,-3856.95 11817,-3758.95 12017,-3758.95 12017,-3856.95"/>
<text text-anchor="middle" x="11917" y="-3841.75" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU2</text>
<text text-anchor="middle" x="11917" y="-3826.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11917" y="-3811.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11917" y="-3796.75" font-family="Times,serif" font-size="14.00">Heads: 8&#45;11</text>
<text text-anchor="middle" x="11917" y="-3781.75" font-family="Times,serif" font-size="14.00">TP Slice: 2</text>
<text text-anchor="middle" x="11917" y="-3766.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_output_gpu2&#45;&gt;layer1_qkv_gpu2 -->
<g id="edge323" class="edge">
<title>layer0_output_gpu2&#45;&gt;layer1_qkv_gpu2</title>
<path fill="none" stroke="black" d="M11916.28,-3892.74C11916.35,-3884.78 11916.43,-3876.04 11916.5,-3867.3"/>
<polygon fill="black" stroke="black" points="11920,-3867.13 11916.59,-3857.1 11913,-3867.07 11920,-3867.13"/>
</g>
<!-- layer0_expert3_0 -->
<g id="node93" class="node">
<title>layer0_expert3_0</title>
<polygon fill="lightgreen" stroke="black" points="9420,-4355.95 9246,-4355.95 9246,-4272.95 9420,-4272.95 9420,-4355.95"/>
<text text-anchor="middle" x="9333" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU3</text>
<text text-anchor="middle" x="9333" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9333" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9333" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9333" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_0 -->
<g id="edge131" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10746.8,-4431.37C10450.21,-4427.87 9697.59,-4413.65 9430.29,-4355.96"/>
<polygon fill="black" stroke="black" points="9430.74,-4352.48 9420.22,-4353.71 9429.22,-4359.31 9430.74,-4352.48"/>
</g>
<!-- layer0_expert3_1 -->
<g id="node94" class="node">
<title>layer0_expert3_1</title>
<polygon fill="lightgreen" stroke="black" points="9612,-4355.95 9438,-4355.95 9438,-4272.95 9612,-4272.95 9612,-4355.95"/>
<text text-anchor="middle" x="9525" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU3</text>
<text text-anchor="middle" x="9525" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9525" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9525" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9525" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_1 -->
<g id="edge132" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10746.82,-4430.19C10479.95,-4424.43 9851.25,-4406.07 9622.17,-4355.94"/>
<polygon fill="black" stroke="black" points="9622.75,-4352.48 9612.22,-4353.68 9621.2,-4359.31 9622.75,-4352.48"/>
</g>
<!-- layer0_expert3_2 -->
<g id="node95" class="node">
<title>layer0_expert3_2</title>
<polygon fill="lightgreen" stroke="black" points="9804,-4355.95 9630,-4355.95 9630,-4272.95 9804,-4272.95 9804,-4355.95"/>
<text text-anchor="middle" x="9717" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU3</text>
<text text-anchor="middle" x="9717" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9717" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9717" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9717" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_2 -->
<g id="edge133" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10746.92,-4428.61C10512.28,-4420.41 10005.38,-4398.58 9814.19,-4355.95"/>
<polygon fill="black" stroke="black" points="9814.77,-4352.49 9804.23,-4353.64 9813.19,-4359.31 9814.77,-4352.49"/>
</g>
<!-- layer0_expert3_3 -->
<g id="node96" class="node">
<title>layer0_expert3_3</title>
<polygon fill="lightgreen" stroke="black" points="9996,-4355.95 9822,-4355.95 9822,-4272.95 9996,-4272.95 9996,-4355.95"/>
<text text-anchor="middle" x="9909" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU3</text>
<text text-anchor="middle" x="9909" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9909" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9909" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9909" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_3 -->
<g id="edge134" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10746.77,-4426.32C10547.25,-4415.53 10159.31,-4391.15 10006,-4355.92"/>
<polygon fill="black" stroke="black" points="10006.79,-4352.5 9996.25,-4353.58 10005.16,-4359.31 10006.79,-4352.5"/>
</g>
<!-- layer0_expert3_4 -->
<g id="node97" class="node">
<title>layer0_expert3_4</title>
<polygon fill="lightgreen" stroke="black" points="10188,-4355.95 10014,-4355.95 10014,-4272.95 10188,-4272.95 10188,-4355.95"/>
<text text-anchor="middle" x="10101" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU3</text>
<text text-anchor="middle" x="10101" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10101" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10101" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10101" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_4 -->
<g id="edge135" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10746.91,-4429C10613.03,-4422.86 10392.46,-4405.79 10197.84,-4355.96"/>
<polygon fill="black" stroke="black" points="10198.57,-4352.53 10188.01,-4353.4 10196.81,-4359.3 10198.57,-4352.53"/>
</g>
<!-- layer0_expert3_5 -->
<g id="node98" class="node">
<title>layer0_expert3_5</title>
<polygon fill="lightgreen" stroke="black" points="10380,-4355.95 10206,-4355.95 10206,-4272.95 10380,-4272.95 10380,-4355.95"/>
<text text-anchor="middle" x="10293" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU3</text>
<text text-anchor="middle" x="10293" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10293" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10293" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10293" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_5 -->
<g id="edge136" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10746.91,-4421.21C10651.32,-4410.51 10515.37,-4391.09 10389.84,-4356"/>
<polygon fill="black" stroke="black" points="10390.63,-4352.59 10380.06,-4353.23 10388.72,-4359.32 10390.63,-4352.59"/>
</g>
<!-- layer0_expert3_6 -->
<g id="node99" class="node">
<title>layer0_expert3_6</title>
<polygon fill="lightgreen" stroke="black" points="10572,-4355.95 10398,-4355.95 10398,-4272.95 10572,-4272.95 10572,-4355.95"/>
<text text-anchor="middle" x="10485" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU3</text>
<text text-anchor="middle" x="10485" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10485" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10485" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10485" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_6 -->
<g id="edge137" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10746.66,-4403.97C10697.66,-4391.59 10640.72,-4375.96 10581.67,-4356.07"/>
<polygon fill="black" stroke="black" points="10582.77,-4352.75 10572.18,-4352.84 10580.52,-4359.37 10582.77,-4352.75"/>
</g>
<!-- layer0_expert3_7 -->
<g id="node100" class="node">
<title>layer0_expert3_7</title>
<polygon fill="lightgreen" stroke="black" points="10764,-4355.95 10590,-4355.95 10590,-4272.95 10764,-4272.95 10764,-4355.95"/>
<text text-anchor="middle" x="10677" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU3</text>
<text text-anchor="middle" x="10677" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10677" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10677" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10677" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_7 -->
<g id="edge138" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10802.39,-4391.86C10786.15,-4381.97 10768.68,-4371.32 10752.08,-4361.21"/>
<polygon fill="black" stroke="black" points="10753.86,-4358.19 10743.5,-4355.97 10750.21,-4364.17 10753.86,-4358.19"/>
</g>
<!-- layer0_expert3_8 -->
<g id="node101" class="node">
<title>layer0_expert3_8</title>
<polygon fill="lightgreen" stroke="black" points="10956,-4355.95 10782,-4355.95 10782,-4272.95 10956,-4272.95 10956,-4355.95"/>
<text text-anchor="middle" x="10869" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU3</text>
<text text-anchor="middle" x="10869" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10869" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10869" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10869" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_8 -->
<g id="edge139" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10869,-4391.86C10869,-4383.6 10869,-4374.82 10869,-4366.26"/>
<polygon fill="black" stroke="black" points="10872.5,-4365.97 10869,-4355.97 10865.5,-4365.97 10872.5,-4365.97"/>
</g>
<!-- layer0_expert3_9 -->
<g id="node102" class="node">
<title>layer0_expert3_9</title>
<polygon fill="lightgreen" stroke="black" points="11148,-4355.95 10974,-4355.95 10974,-4272.95 11148,-4272.95 11148,-4355.95"/>
<text text-anchor="middle" x="11061" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU3</text>
<text text-anchor="middle" x="11061" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11061" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11061" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11061" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_9 -->
<g id="edge140" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10935.61,-4391.86C10951.85,-4381.97 10969.32,-4371.32 10985.92,-4361.21"/>
<polygon fill="black" stroke="black" points="10987.79,-4364.17 10994.5,-4355.97 10984.14,-4358.19 10987.79,-4364.17"/>
</g>
<!-- layer0_expert3_10 -->
<g id="node103" class="node">
<title>layer0_expert3_10</title>
<polygon fill="lightgreen" stroke="black" points="11340,-4355.95 11166,-4355.95 11166,-4272.95 11340,-4272.95 11340,-4355.95"/>
<text text-anchor="middle" x="11253" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU3</text>
<text text-anchor="middle" x="11253" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11253" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11253" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11253" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_10 -->
<g id="edge141" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10991.34,-4403.97C11040.34,-4391.59 11097.28,-4375.96 11156.33,-4356.07"/>
<polygon fill="black" stroke="black" points="11157.48,-4359.37 11165.82,-4352.84 11155.23,-4352.75 11157.48,-4359.37"/>
</g>
<!-- layer0_expert3_11 -->
<g id="node104" class="node">
<title>layer0_expert3_11</title>
<polygon fill="lightgreen" stroke="black" points="11532,-4355.95 11358,-4355.95 11358,-4272.95 11532,-4272.95 11532,-4355.95"/>
<text text-anchor="middle" x="11445" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU3</text>
<text text-anchor="middle" x="11445" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11445" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11445" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11445" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_11 -->
<g id="edge142" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10991.09,-4421.21C11086.68,-4410.51 11222.63,-4391.09 11348.16,-4356"/>
<polygon fill="black" stroke="black" points="11349.28,-4359.32 11357.94,-4353.23 11347.37,-4352.59 11349.28,-4359.32"/>
</g>
<!-- layer0_expert3_12 -->
<g id="node105" class="node">
<title>layer0_expert3_12</title>
<polygon fill="lightgreen" stroke="black" points="11724,-4355.95 11550,-4355.95 11550,-4272.95 11724,-4272.95 11724,-4355.95"/>
<text text-anchor="middle" x="11637" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU3</text>
<text text-anchor="middle" x="11637" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11637" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11637" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11637" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_12 -->
<g id="edge143" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10991.09,-4429C11124.97,-4422.86 11345.54,-4405.79 11540.16,-4355.96"/>
<polygon fill="black" stroke="black" points="11541.19,-4359.3 11549.99,-4353.4 11539.43,-4352.53 11541.19,-4359.3"/>
</g>
<!-- layer0_expert3_13 -->
<g id="node106" class="node">
<title>layer0_expert3_13</title>
<polygon fill="lightgreen" stroke="black" points="11916,-4355.95 11742,-4355.95 11742,-4272.95 11916,-4272.95 11916,-4355.95"/>
<text text-anchor="middle" x="11829" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU3</text>
<text text-anchor="middle" x="11829" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11829" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11829" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11829" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_13 -->
<g id="edge144" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10991.23,-4426.32C11190.75,-4415.53 11578.69,-4391.15 11732,-4355.92"/>
<polygon fill="black" stroke="black" points="11732.84,-4359.31 11741.75,-4353.58 11731.21,-4352.5 11732.84,-4359.31"/>
</g>
<!-- layer0_expert3_14 -->
<g id="node107" class="node">
<title>layer0_expert3_14</title>
<polygon fill="lightgreen" stroke="black" points="12108,-4355.95 11934,-4355.95 11934,-4272.95 12108,-4272.95 12108,-4355.95"/>
<text text-anchor="middle" x="12021" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU3</text>
<text text-anchor="middle" x="12021" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12021" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12021" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12021" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_14 -->
<g id="edge145" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10991.08,-4428.61C11225.72,-4420.41 11732.62,-4398.58 11923.81,-4355.95"/>
<polygon fill="black" stroke="black" points="11924.81,-4359.31 11933.77,-4353.64 11923.23,-4352.49 11924.81,-4359.31"/>
</g>
<!-- layer0_expert3_15 -->
<g id="node108" class="node">
<title>layer0_expert3_15</title>
<polygon fill="lightgreen" stroke="black" points="12300,-4355.95 12126,-4355.95 12126,-4272.95 12300,-4272.95 12300,-4355.95"/>
<text text-anchor="middle" x="12213" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU3</text>
<text text-anchor="middle" x="12213" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12213" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12213" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12213" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_15 -->
<g id="edge146" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10991.18,-4430.19C11258.05,-4424.43 11886.75,-4406.07 12115.83,-4355.94"/>
<polygon fill="black" stroke="black" points="12116.8,-4359.31 12125.78,-4353.68 12115.25,-4352.48 12116.8,-4359.31"/>
</g>
<!-- layer0_moe_agg_gpu3 -->
<g id="node109" class="node">
<title>layer0_moe_agg_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="10970.5,-4236.95 10767.5,-4236.95 10767.5,-4168.95 10970.5,-4168.95 10970.5,-4236.95"/>
<text text-anchor="middle" x="10869" y="-4221.75" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU3</text>
<text text-anchor="middle" x="10869" y="-4206.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="10869" y="-4191.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="10869" y="-4176.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_expert3_0&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge147" class="edge">
<title>layer0_expert3_0&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9420.21,-4275.17C9423.16,-4274.36 9426.09,-4273.62 9429,-4272.95 9681.13,-4215.63 10464.27,-4205.89 10757.05,-4204.27"/>
<polygon fill="black" stroke="black" points="10757.27,-4207.77 10767.25,-4204.21 10757.24,-4200.77 10757.27,-4207.77"/>
</g>
<!-- layer0_expert3_1&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge148" class="edge">
<title>layer0_expert3_1&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9612.22,-4275.2C9615.16,-4274.38 9618.09,-4273.63 9621,-4272.95 9835.24,-4223.42 10492.44,-4209.07 10756.97,-4205.24"/>
<polygon fill="black" stroke="black" points="10757.41,-4208.73 10767.36,-4205.09 10757.31,-4201.73 10757.41,-4208.73"/>
</g>
<!-- layer0_expert3_2&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge149" class="edge">
<title>layer0_expert3_2&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9804.23,-4275.24C9807.17,-4274.41 9810.1,-4273.64 9813,-4272.95 9989.72,-4231.16 10523.22,-4212.77 10757.09,-4206.56"/>
<polygon fill="black" stroke="black" points="10757.42,-4210.05 10767.32,-4206.29 10757.23,-4203.05 10757.42,-4210.05"/>
</g>
<!-- layer0_expert3_3&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge150" class="edge">
<title>layer0_expert3_3&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9996.24,-4275.3C9999.18,-4274.45 10002.1,-4273.66 10005,-4272.95 10144.55,-4238.88 10556.54,-4217.25 10756.96,-4208.46"/>
<polygon fill="black" stroke="black" points="10757.39,-4211.94 10767.22,-4208.01 10757.08,-4204.95 10757.39,-4211.94"/>
</g>
<!-- layer0_expert3_4&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge151" class="edge">
<title>layer0_expert3_4&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10188.26,-4275.38C10191.19,-4274.51 10194.11,-4273.69 10197,-4272.95 10389.8,-4223.56 10622.29,-4209.33 10757.12,-4205.35"/>
<polygon fill="black" stroke="black" points="10757.56,-4208.84 10767.46,-4205.06 10757.37,-4201.84 10757.56,-4208.84"/>
</g>
<!-- layer0_expert3_5&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge152" class="edge">
<title>layer0_expert3_5&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10380.04,-4275.62C10383.04,-4274.67 10386.04,-4273.78 10389,-4272.95 10512.52,-4238.64 10658.92,-4220.73 10757.28,-4211.86"/>
<polygon fill="black" stroke="black" points="10757.59,-4215.34 10767.24,-4210.97 10756.97,-4208.37 10757.59,-4215.34"/>
</g>
<!-- layer0_expert3_6&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge153" class="edge">
<title>layer0_expert3_6&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10572.15,-4275.97C10575.12,-4274.92 10578.08,-4273.91 10581,-4272.95 10638.25,-4254.16 10703.45,-4238.11 10757.32,-4226.23"/>
<polygon fill="black" stroke="black" points="10758.22,-4229.62 10767.24,-4224.06 10756.72,-4222.78 10758.22,-4229.62"/>
</g>
<!-- layer0_expert3_7&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge154" class="edge">
<title>layer0_expert3_7&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10748.22,-4272.84C10765.85,-4262.78 10784.68,-4252.04 10802.1,-4242.11"/>
<polygon fill="black" stroke="black" points="10804.11,-4244.99 10811.06,-4237 10800.64,-4238.91 10804.11,-4244.99"/>
</g>
<!-- layer0_expert3_8&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge155" class="edge">
<title>layer0_expert3_8&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10869,-4272.68C10869,-4264.47 10869,-4255.81 10869,-4247.51"/>
<polygon fill="black" stroke="black" points="10872.5,-4247.25 10869,-4237.25 10865.5,-4247.25 10872.5,-4247.25"/>
</g>
<!-- layer0_expert3_9&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge156" class="edge">
<title>layer0_expert3_9&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10989.78,-4272.84C10972.15,-4262.78 10953.32,-4252.04 10935.9,-4242.11"/>
<polygon fill="black" stroke="black" points="10937.36,-4238.91 10926.94,-4237 10933.89,-4244.99 10937.36,-4238.91"/>
</g>
<!-- layer0_expert3_10&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge157" class="edge">
<title>layer0_expert3_10&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11165.85,-4275.97C11162.88,-4274.92 11159.92,-4273.91 11157,-4272.95 11099.75,-4254.16 11034.55,-4238.11 10980.68,-4226.23"/>
<polygon fill="black" stroke="black" points="10981.28,-4222.78 10970.76,-4224.06 10979.78,-4229.62 10981.28,-4222.78"/>
</g>
<!-- layer0_expert3_11&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge158" class="edge">
<title>layer0_expert3_11&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11357.96,-4275.62C11354.96,-4274.67 11351.96,-4273.78 11349,-4272.95 11225.48,-4238.64 11079.08,-4220.73 10980.72,-4211.86"/>
<polygon fill="black" stroke="black" points="10981.03,-4208.37 10970.76,-4210.97 10980.41,-4215.34 10981.03,-4208.37"/>
</g>
<!-- layer0_expert3_12&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge159" class="edge">
<title>layer0_expert3_12&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11549.74,-4275.38C11546.81,-4274.51 11543.89,-4273.69 11541,-4272.95 11348.2,-4223.56 11115.71,-4209.33 10980.88,-4205.35"/>
<polygon fill="black" stroke="black" points="10980.63,-4201.84 10970.54,-4205.06 10980.44,-4208.84 10980.63,-4201.84"/>
</g>
<!-- layer0_expert3_13&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge160" class="edge">
<title>layer0_expert3_13&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11741.76,-4275.3C11738.82,-4274.45 11735.9,-4273.66 11733,-4272.95 11593.45,-4238.88 11181.46,-4217.25 10981.04,-4208.46"/>
<polygon fill="black" stroke="black" points="10980.92,-4204.95 10970.78,-4208.01 10980.61,-4211.94 10980.92,-4204.95"/>
</g>
<!-- layer0_expert3_14&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge161" class="edge">
<title>layer0_expert3_14&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11933.77,-4275.24C11930.83,-4274.41 11927.9,-4273.64 11925,-4272.95 11748.28,-4231.16 11214.78,-4212.77 10980.91,-4206.56"/>
<polygon fill="black" stroke="black" points="10980.77,-4203.05 10970.68,-4206.29 10980.58,-4210.05 10980.77,-4203.05"/>
</g>
<!-- layer0_expert3_15&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge162" class="edge">
<title>layer0_expert3_15&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M12125.78,-4275.2C12122.84,-4274.38 12119.91,-4273.63 12117,-4272.95 11902.76,-4223.42 11245.56,-4209.07 10981.03,-4205.24"/>
<polygon fill="black" stroke="black" points="10980.69,-4201.73 10970.64,-4205.09 10980.59,-4208.73 10980.69,-4201.73"/>
</g>
<!-- layer0_moe_agg_gpu3&#45;&gt;layer0_moe_allreduce -->
<g id="edge163" class="edge">
<title>layer0_moe_agg_gpu3&#45;&gt;layer0_moe_allreduce</title>
<path fill="none" stroke="black" d="M10970.54,-4192.36C11210.43,-4169.71 11815.11,-4112.6 12122.86,-4083.53"/>
<polygon fill="black" stroke="black" points="12123.6,-4086.98 12133.23,-4082.55 12122.95,-4080.01 12123.6,-4086.98"/>
</g>
<!-- layer0_output_gpu3 -->
<g id="node110" class="node">
<title>layer0_output_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="12300,-3960.95 12056,-3960.95 12056,-3892.95 12300,-3892.95 12300,-3960.95"/>
<text text-anchor="middle" x="12178" y="-3945.75" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU3</text>
<text text-anchor="middle" x="12178" y="-3930.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="12178" y="-3915.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12178" y="-3900.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_qkv_gpu3 -->
<g id="node197" class="node">
<title>layer1_qkv_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="12278,-3856.95 12078,-3856.95 12078,-3758.95 12278,-3758.95 12278,-3856.95"/>
<text text-anchor="middle" x="12178" y="-3841.75" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU3</text>
<text text-anchor="middle" x="12178" y="-3826.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12178" y="-3811.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12178" y="-3796.75" font-family="Times,serif" font-size="14.00">Heads: 12&#45;15</text>
<text text-anchor="middle" x="12178" y="-3781.75" font-family="Times,serif" font-size="14.00">TP Slice: 3</text>
<text text-anchor="middle" x="12178" y="-3766.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_output_gpu3&#45;&gt;layer1_qkv_gpu3 -->
<g id="edge324" class="edge">
<title>layer0_output_gpu3&#45;&gt;layer1_qkv_gpu3</title>
<path fill="none" stroke="black" d="M12178,-3892.74C12178,-3884.78 12178,-3876.04 12178,-3867.3"/>
<polygon fill="black" stroke="black" points="12181.5,-3867.1 12178,-3857.1 12174.5,-3867.1 12181.5,-3867.1"/>
</g>
<!-- layer0_expert4_0 -->
<g id="node112" class="node">
<title>layer0_expert4_0</title>
<polygon fill="lightgreen" stroke="black" points="12492,-4355.95 12318,-4355.95 12318,-4272.95 12492,-4272.95 12492,-4355.95"/>
<text text-anchor="middle" x="12405" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU4</text>
<text text-anchor="middle" x="12405" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12405" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12405" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12405" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_0 -->
<g id="edge170" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13626.82,-4430.19C13359.95,-4424.43 12731.25,-4406.07 12502.17,-4355.94"/>
<polygon fill="black" stroke="black" points="12502.75,-4352.48 12492.22,-4353.68 12501.2,-4359.31 12502.75,-4352.48"/>
</g>
<!-- layer0_expert4_1 -->
<g id="node113" class="node">
<title>layer0_expert4_1</title>
<polygon fill="lightgreen" stroke="black" points="12684,-4355.95 12510,-4355.95 12510,-4272.95 12684,-4272.95 12684,-4355.95"/>
<text text-anchor="middle" x="12597" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU4</text>
<text text-anchor="middle" x="12597" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12597" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12597" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12597" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_1 -->
<g id="edge171" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13626.92,-4428.61C13392.28,-4420.41 12885.38,-4398.58 12694.19,-4355.95"/>
<polygon fill="black" stroke="black" points="12694.77,-4352.49 12684.23,-4353.64 12693.19,-4359.31 12694.77,-4352.49"/>
</g>
<!-- layer0_expert4_2 -->
<g id="node114" class="node">
<title>layer0_expert4_2</title>
<polygon fill="lightgreen" stroke="black" points="12876,-4355.95 12702,-4355.95 12702,-4272.95 12876,-4272.95 12876,-4355.95"/>
<text text-anchor="middle" x="12789" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU4</text>
<text text-anchor="middle" x="12789" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12789" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12789" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12789" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_2 -->
<g id="edge172" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13626.77,-4426.32C13427.25,-4415.53 13039.31,-4391.15 12886,-4355.92"/>
<polygon fill="black" stroke="black" points="12886.79,-4352.5 12876.25,-4353.58 12885.16,-4359.31 12886.79,-4352.5"/>
</g>
<!-- layer0_expert4_3 -->
<g id="node115" class="node">
<title>layer0_expert4_3</title>
<polygon fill="lightgreen" stroke="black" points="13068,-4355.95 12894,-4355.95 12894,-4272.95 13068,-4272.95 13068,-4355.95"/>
<text text-anchor="middle" x="12981" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU4</text>
<text text-anchor="middle" x="12981" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12981" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12981" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12981" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_3 -->
<g id="edge173" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13626.91,-4429C13493.03,-4422.86 13272.46,-4405.79 13077.84,-4355.96"/>
<polygon fill="black" stroke="black" points="13078.57,-4352.53 13068.01,-4353.4 13076.81,-4359.3 13078.57,-4352.53"/>
</g>
<!-- layer0_expert4_4 -->
<g id="node116" class="node">
<title>layer0_expert4_4</title>
<polygon fill="lightgreen" stroke="black" points="13260,-4355.95 13086,-4355.95 13086,-4272.95 13260,-4272.95 13260,-4355.95"/>
<text text-anchor="middle" x="13173" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU4</text>
<text text-anchor="middle" x="13173" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13173" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13173" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13173" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_4 -->
<g id="edge174" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13626.91,-4421.21C13531.32,-4410.51 13395.37,-4391.09 13269.84,-4356"/>
<polygon fill="black" stroke="black" points="13270.63,-4352.59 13260.06,-4353.23 13268.72,-4359.32 13270.63,-4352.59"/>
</g>
<!-- layer0_expert4_5 -->
<g id="node117" class="node">
<title>layer0_expert4_5</title>
<polygon fill="lightgreen" stroke="black" points="13452,-4355.95 13278,-4355.95 13278,-4272.95 13452,-4272.95 13452,-4355.95"/>
<text text-anchor="middle" x="13365" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU4</text>
<text text-anchor="middle" x="13365" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13365" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13365" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13365" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_5 -->
<g id="edge175" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13626.66,-4403.97C13577.66,-4391.59 13520.72,-4375.96 13461.67,-4356.07"/>
<polygon fill="black" stroke="black" points="13462.77,-4352.75 13452.18,-4352.84 13460.52,-4359.37 13462.77,-4352.75"/>
</g>
<!-- layer0_expert4_6 -->
<g id="node118" class="node">
<title>layer0_expert4_6</title>
<polygon fill="lightgreen" stroke="black" points="13644,-4355.95 13470,-4355.95 13470,-4272.95 13644,-4272.95 13644,-4355.95"/>
<text text-anchor="middle" x="13557" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU4</text>
<text text-anchor="middle" x="13557" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13557" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13557" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13557" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_6 -->
<g id="edge176" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13682.39,-4391.86C13666.15,-4381.97 13648.68,-4371.32 13632.08,-4361.21"/>
<polygon fill="black" stroke="black" points="13633.86,-4358.19 13623.5,-4355.97 13630.21,-4364.17 13633.86,-4358.19"/>
</g>
<!-- layer0_expert4_7 -->
<g id="node119" class="node">
<title>layer0_expert4_7</title>
<polygon fill="lightgreen" stroke="black" points="13836,-4355.95 13662,-4355.95 13662,-4272.95 13836,-4272.95 13836,-4355.95"/>
<text text-anchor="middle" x="13749" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU4</text>
<text text-anchor="middle" x="13749" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13749" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13749" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13749" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_7 -->
<g id="edge177" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13749,-4391.86C13749,-4383.6 13749,-4374.82 13749,-4366.26"/>
<polygon fill="black" stroke="black" points="13752.5,-4365.97 13749,-4355.97 13745.5,-4365.97 13752.5,-4365.97"/>
</g>
<!-- layer0_expert4_8 -->
<g id="node120" class="node">
<title>layer0_expert4_8</title>
<polygon fill="lightgreen" stroke="black" points="14028,-4355.95 13854,-4355.95 13854,-4272.95 14028,-4272.95 14028,-4355.95"/>
<text text-anchor="middle" x="13941" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU4</text>
<text text-anchor="middle" x="13941" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13941" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13941" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13941" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_8 -->
<g id="edge178" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13815.61,-4391.86C13831.85,-4381.97 13849.32,-4371.32 13865.92,-4361.21"/>
<polygon fill="black" stroke="black" points="13867.79,-4364.17 13874.5,-4355.97 13864.14,-4358.19 13867.79,-4364.17"/>
</g>
<!-- layer0_expert4_9 -->
<g id="node121" class="node">
<title>layer0_expert4_9</title>
<polygon fill="lightgreen" stroke="black" points="14220,-4355.95 14046,-4355.95 14046,-4272.95 14220,-4272.95 14220,-4355.95"/>
<text text-anchor="middle" x="14133" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU4</text>
<text text-anchor="middle" x="14133" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14133" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14133" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14133" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_9 -->
<g id="edge179" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13871.34,-4403.97C13920.34,-4391.59 13977.28,-4375.96 14036.33,-4356.07"/>
<polygon fill="black" stroke="black" points="14037.48,-4359.37 14045.82,-4352.84 14035.23,-4352.75 14037.48,-4359.37"/>
</g>
<!-- layer0_expert4_10 -->
<g id="node122" class="node">
<title>layer0_expert4_10</title>
<polygon fill="lightgreen" stroke="black" points="14412,-4355.95 14238,-4355.95 14238,-4272.95 14412,-4272.95 14412,-4355.95"/>
<text text-anchor="middle" x="14325" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU4</text>
<text text-anchor="middle" x="14325" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14325" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14325" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14325" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_10 -->
<g id="edge180" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13871.09,-4421.21C13966.68,-4410.51 14102.63,-4391.09 14228.16,-4356"/>
<polygon fill="black" stroke="black" points="14229.28,-4359.32 14237.94,-4353.23 14227.37,-4352.59 14229.28,-4359.32"/>
</g>
<!-- layer0_expert4_11 -->
<g id="node123" class="node">
<title>layer0_expert4_11</title>
<polygon fill="lightgreen" stroke="black" points="14604,-4355.95 14430,-4355.95 14430,-4272.95 14604,-4272.95 14604,-4355.95"/>
<text text-anchor="middle" x="14517" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU4</text>
<text text-anchor="middle" x="14517" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14517" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14517" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14517" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_11 -->
<g id="edge181" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13871.09,-4429C14004.97,-4422.86 14225.54,-4405.79 14420.16,-4355.96"/>
<polygon fill="black" stroke="black" points="14421.19,-4359.3 14429.99,-4353.4 14419.43,-4352.53 14421.19,-4359.3"/>
</g>
<!-- layer0_expert4_12 -->
<g id="node124" class="node">
<title>layer0_expert4_12</title>
<polygon fill="lightgreen" stroke="black" points="14796,-4355.95 14622,-4355.95 14622,-4272.95 14796,-4272.95 14796,-4355.95"/>
<text text-anchor="middle" x="14709" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU4</text>
<text text-anchor="middle" x="14709" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14709" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14709" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14709" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_12 -->
<g id="edge182" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13871.23,-4426.32C14070.75,-4415.53 14458.69,-4391.15 14612,-4355.92"/>
<polygon fill="black" stroke="black" points="14612.84,-4359.31 14621.75,-4353.58 14611.21,-4352.5 14612.84,-4359.31"/>
</g>
<!-- layer0_expert4_13 -->
<g id="node125" class="node">
<title>layer0_expert4_13</title>
<polygon fill="lightgreen" stroke="black" points="14988,-4355.95 14814,-4355.95 14814,-4272.95 14988,-4272.95 14988,-4355.95"/>
<text text-anchor="middle" x="14901" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU4</text>
<text text-anchor="middle" x="14901" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14901" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14901" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14901" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_13 -->
<g id="edge183" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13871.08,-4428.61C14105.72,-4420.41 14612.62,-4398.58 14803.81,-4355.95"/>
<polygon fill="black" stroke="black" points="14804.81,-4359.31 14813.77,-4353.64 14803.23,-4352.49 14804.81,-4359.31"/>
</g>
<!-- layer0_expert4_14 -->
<g id="node126" class="node">
<title>layer0_expert4_14</title>
<polygon fill="lightgreen" stroke="black" points="15180,-4355.95 15006,-4355.95 15006,-4272.95 15180,-4272.95 15180,-4355.95"/>
<text text-anchor="middle" x="15093" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU4</text>
<text text-anchor="middle" x="15093" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15093" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15093" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15093" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_14 -->
<g id="edge184" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13871.18,-4430.19C14138.05,-4424.43 14766.75,-4406.07 14995.83,-4355.94"/>
<polygon fill="black" stroke="black" points="14996.8,-4359.31 15005.78,-4353.68 14995.25,-4352.48 14996.8,-4359.31"/>
</g>
<!-- layer0_expert4_15 -->
<g id="node127" class="node">
<title>layer0_expert4_15</title>
<polygon fill="lightgreen" stroke="black" points="15372,-4355.95 15198,-4355.95 15198,-4272.95 15372,-4272.95 15372,-4355.95"/>
<text text-anchor="middle" x="15285" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU4</text>
<text text-anchor="middle" x="15285" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15285" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15285" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15285" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_15 -->
<g id="edge185" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13871.2,-4431.37C14167.79,-4427.87 14920.41,-4413.65 15187.71,-4355.96"/>
<polygon fill="black" stroke="black" points="15188.78,-4359.31 15197.78,-4353.71 15187.26,-4352.48 15188.78,-4359.31"/>
</g>
<!-- layer0_moe_agg_gpu4 -->
<g id="node128" class="node">
<title>layer0_moe_agg_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13850.5,-4236.95 13647.5,-4236.95 13647.5,-4168.95 13850.5,-4168.95 13850.5,-4236.95"/>
<text text-anchor="middle" x="13749" y="-4221.75" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU4</text>
<text text-anchor="middle" x="13749" y="-4206.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="13749" y="-4191.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="13749" y="-4176.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_expert4_0&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge186" class="edge">
<title>layer0_expert4_0&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M12492.22,-4275.2C12495.16,-4274.38 12498.09,-4273.63 12501,-4272.95 12715.24,-4223.42 13372.44,-4209.07 13636.97,-4205.24"/>
<polygon fill="black" stroke="black" points="13637.41,-4208.73 13647.36,-4205.09 13637.31,-4201.73 13637.41,-4208.73"/>
</g>
<!-- layer0_expert4_1&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge187" class="edge">
<title>layer0_expert4_1&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M12684.23,-4275.24C12687.17,-4274.41 12690.1,-4273.64 12693,-4272.95 12869.72,-4231.16 13403.22,-4212.77 13637.09,-4206.56"/>
<polygon fill="black" stroke="black" points="13637.42,-4210.05 13647.32,-4206.29 13637.23,-4203.05 13637.42,-4210.05"/>
</g>
<!-- layer0_expert4_2&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge188" class="edge">
<title>layer0_expert4_2&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M12876.24,-4275.3C12879.18,-4274.45 12882.1,-4273.66 12885,-4272.95 13024.55,-4238.88 13436.54,-4217.25 13636.96,-4208.46"/>
<polygon fill="black" stroke="black" points="13637.39,-4211.94 13647.22,-4208.01 13637.08,-4204.95 13637.39,-4211.94"/>
</g>
<!-- layer0_expert4_3&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge189" class="edge">
<title>layer0_expert4_3&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13068.26,-4275.38C13071.19,-4274.51 13074.11,-4273.69 13077,-4272.95 13269.8,-4223.56 13502.29,-4209.33 13637.12,-4205.35"/>
<polygon fill="black" stroke="black" points="13637.56,-4208.84 13647.46,-4205.06 13637.37,-4201.84 13637.56,-4208.84"/>
</g>
<!-- layer0_expert4_4&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge190" class="edge">
<title>layer0_expert4_4&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13260.04,-4275.62C13263.04,-4274.67 13266.04,-4273.78 13269,-4272.95 13392.52,-4238.64 13538.92,-4220.73 13637.28,-4211.86"/>
<polygon fill="black" stroke="black" points="13637.59,-4215.34 13647.24,-4210.97 13636.97,-4208.37 13637.59,-4215.34"/>
</g>
<!-- layer0_expert4_5&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge191" class="edge">
<title>layer0_expert4_5&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13452.15,-4275.97C13455.12,-4274.92 13458.08,-4273.91 13461,-4272.95 13518.25,-4254.16 13583.45,-4238.11 13637.32,-4226.23"/>
<polygon fill="black" stroke="black" points="13638.22,-4229.62 13647.24,-4224.06 13636.72,-4222.78 13638.22,-4229.62"/>
</g>
<!-- layer0_expert4_6&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge192" class="edge">
<title>layer0_expert4_6&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13628.22,-4272.84C13645.85,-4262.78 13664.68,-4252.04 13682.1,-4242.11"/>
<polygon fill="black" stroke="black" points="13684.11,-4244.99 13691.06,-4237 13680.64,-4238.91 13684.11,-4244.99"/>
</g>
<!-- layer0_expert4_7&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge193" class="edge">
<title>layer0_expert4_7&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13749,-4272.68C13749,-4264.47 13749,-4255.81 13749,-4247.51"/>
<polygon fill="black" stroke="black" points="13752.5,-4247.25 13749,-4237.25 13745.5,-4247.25 13752.5,-4247.25"/>
</g>
<!-- layer0_expert4_8&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge194" class="edge">
<title>layer0_expert4_8&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13869.78,-4272.84C13852.15,-4262.78 13833.32,-4252.04 13815.9,-4242.11"/>
<polygon fill="black" stroke="black" points="13817.36,-4238.91 13806.94,-4237 13813.89,-4244.99 13817.36,-4238.91"/>
</g>
<!-- layer0_expert4_9&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge195" class="edge">
<title>layer0_expert4_9&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14045.85,-4275.97C14042.88,-4274.92 14039.92,-4273.91 14037,-4272.95 13979.75,-4254.16 13914.55,-4238.11 13860.68,-4226.23"/>
<polygon fill="black" stroke="black" points="13861.28,-4222.78 13850.76,-4224.06 13859.78,-4229.62 13861.28,-4222.78"/>
</g>
<!-- layer0_expert4_10&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge196" class="edge">
<title>layer0_expert4_10&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14237.96,-4275.62C14234.96,-4274.67 14231.96,-4273.78 14229,-4272.95 14105.48,-4238.64 13959.08,-4220.73 13860.72,-4211.86"/>
<polygon fill="black" stroke="black" points="13861.03,-4208.37 13850.76,-4210.97 13860.41,-4215.34 13861.03,-4208.37"/>
</g>
<!-- layer0_expert4_11&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge197" class="edge">
<title>layer0_expert4_11&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14429.74,-4275.38C14426.81,-4274.51 14423.89,-4273.69 14421,-4272.95 14228.2,-4223.56 13995.71,-4209.33 13860.88,-4205.35"/>
<polygon fill="black" stroke="black" points="13860.63,-4201.84 13850.54,-4205.06 13860.44,-4208.84 13860.63,-4201.84"/>
</g>
<!-- layer0_expert4_12&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge198" class="edge">
<title>layer0_expert4_12&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14621.76,-4275.3C14618.82,-4274.45 14615.9,-4273.66 14613,-4272.95 14473.45,-4238.88 14061.46,-4217.25 13861.04,-4208.46"/>
<polygon fill="black" stroke="black" points="13860.92,-4204.95 13850.78,-4208.01 13860.61,-4211.94 13860.92,-4204.95"/>
</g>
<!-- layer0_expert4_13&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge199" class="edge">
<title>layer0_expert4_13&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14813.77,-4275.24C14810.83,-4274.41 14807.9,-4273.64 14805,-4272.95 14628.28,-4231.16 14094.78,-4212.77 13860.91,-4206.56"/>
<polygon fill="black" stroke="black" points="13860.77,-4203.05 13850.68,-4206.29 13860.58,-4210.05 13860.77,-4203.05"/>
</g>
<!-- layer0_expert4_14&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge200" class="edge">
<title>layer0_expert4_14&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M15005.78,-4275.2C15002.84,-4274.38 14999.91,-4273.63 14997,-4272.95 14782.76,-4223.42 14125.56,-4209.07 13861.03,-4205.24"/>
<polygon fill="black" stroke="black" points="13860.69,-4201.73 13850.64,-4205.09 13860.59,-4208.73 13860.69,-4201.73"/>
</g>
<!-- layer0_expert4_15&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge201" class="edge">
<title>layer0_expert4_15&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M15197.79,-4275.17C15194.84,-4274.36 15191.91,-4273.62 15189,-4272.95 14936.87,-4215.63 14153.73,-4205.89 13860.95,-4204.27"/>
<polygon fill="black" stroke="black" points="13860.76,-4200.77 13850.75,-4204.21 13860.73,-4207.77 13860.76,-4200.77"/>
</g>
<!-- layer0_moe_agg_gpu4&#45;&gt;layer0_moe_allreduce -->
<g id="edge202" class="edge">
<title>layer0_moe_agg_gpu4&#45;&gt;layer0_moe_allreduce</title>
<path fill="none" stroke="black" d="M13647.46,-4192.36C13407.57,-4169.71 12802.89,-4112.6 12495.14,-4083.53"/>
<polygon fill="black" stroke="black" points="12495.05,-4080.01 12484.77,-4082.55 12494.4,-4086.98 12495.05,-4080.01"/>
</g>
<!-- layer0_output_gpu4 -->
<g id="node129" class="node">
<title>layer0_output_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="12562,-3960.95 12318,-3960.95 12318,-3892.95 12562,-3892.95 12562,-3960.95"/>
<text text-anchor="middle" x="12440" y="-3945.75" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU4</text>
<text text-anchor="middle" x="12440" y="-3930.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="12440" y="-3915.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12440" y="-3900.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_qkv_gpu4 -->
<g id="node200" class="node">
<title>layer1_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="12539,-3856.95 12339,-3856.95 12339,-3758.95 12539,-3758.95 12539,-3856.95"/>
<text text-anchor="middle" x="12439" y="-3841.75" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU4</text>
<text text-anchor="middle" x="12439" y="-3826.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12439" y="-3811.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12439" y="-3796.75" font-family="Times,serif" font-size="14.00">Heads: 16&#45;19</text>
<text text-anchor="middle" x="12439" y="-3781.75" font-family="Times,serif" font-size="14.00">TP Slice: 4</text>
<text text-anchor="middle" x="12439" y="-3766.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_output_gpu4&#45;&gt;layer1_qkv_gpu4 -->
<g id="edge325" class="edge">
<title>layer0_output_gpu4&#45;&gt;layer1_qkv_gpu4</title>
<path fill="none" stroke="black" d="M12439.72,-3892.74C12439.65,-3884.78 12439.57,-3876.04 12439.5,-3867.3"/>
<polygon fill="black" stroke="black" points="12443,-3867.07 12439.41,-3857.1 12436,-3867.13 12443,-3867.07"/>
</g>
<!-- layer0_expert5_0 -->
<g id="node131" class="node">
<title>layer0_expert5_0</title>
<polygon fill="lightgreen" stroke="black" points="15564,-4355.95 15390,-4355.95 15390,-4272.95 15564,-4272.95 15564,-4355.95"/>
<text text-anchor="middle" x="15477" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU5</text>
<text text-anchor="middle" x="15477" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15477" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15477" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15477" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_0 -->
<g id="edge209" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16698.82,-4430.19C16431.95,-4424.43 15803.25,-4406.07 15574.17,-4355.94"/>
<polygon fill="black" stroke="black" points="15574.75,-4352.48 15564.22,-4353.68 15573.2,-4359.31 15574.75,-4352.48"/>
</g>
<!-- layer0_expert5_1 -->
<g id="node132" class="node">
<title>layer0_expert5_1</title>
<polygon fill="lightgreen" stroke="black" points="15756,-4355.95 15582,-4355.95 15582,-4272.95 15756,-4272.95 15756,-4355.95"/>
<text text-anchor="middle" x="15669" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU5</text>
<text text-anchor="middle" x="15669" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15669" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15669" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15669" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_1 -->
<g id="edge210" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16698.92,-4428.61C16464.28,-4420.41 15957.38,-4398.58 15766.19,-4355.95"/>
<polygon fill="black" stroke="black" points="15766.77,-4352.49 15756.23,-4353.64 15765.19,-4359.31 15766.77,-4352.49"/>
</g>
<!-- layer0_expert5_2 -->
<g id="node133" class="node">
<title>layer0_expert5_2</title>
<polygon fill="lightgreen" stroke="black" points="15948,-4355.95 15774,-4355.95 15774,-4272.95 15948,-4272.95 15948,-4355.95"/>
<text text-anchor="middle" x="15861" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU5</text>
<text text-anchor="middle" x="15861" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15861" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15861" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15861" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_2 -->
<g id="edge211" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16698.77,-4426.32C16499.25,-4415.53 16111.31,-4391.15 15958,-4355.92"/>
<polygon fill="black" stroke="black" points="15958.79,-4352.5 15948.25,-4353.58 15957.16,-4359.31 15958.79,-4352.5"/>
</g>
<!-- layer0_expert5_3 -->
<g id="node134" class="node">
<title>layer0_expert5_3</title>
<polygon fill="lightgreen" stroke="black" points="16140,-4355.95 15966,-4355.95 15966,-4272.95 16140,-4272.95 16140,-4355.95"/>
<text text-anchor="middle" x="16053" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU5</text>
<text text-anchor="middle" x="16053" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16053" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16053" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16053" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_3 -->
<g id="edge212" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16698.91,-4429C16565.03,-4422.86 16344.46,-4405.79 16149.84,-4355.96"/>
<polygon fill="black" stroke="black" points="16150.57,-4352.53 16140.01,-4353.4 16148.81,-4359.3 16150.57,-4352.53"/>
</g>
<!-- layer0_expert5_4 -->
<g id="node135" class="node">
<title>layer0_expert5_4</title>
<polygon fill="lightgreen" stroke="black" points="16332,-4355.95 16158,-4355.95 16158,-4272.95 16332,-4272.95 16332,-4355.95"/>
<text text-anchor="middle" x="16245" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU5</text>
<text text-anchor="middle" x="16245" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16245" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16245" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16245" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_4 -->
<g id="edge213" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16698.91,-4421.21C16603.32,-4410.51 16467.37,-4391.09 16341.84,-4356"/>
<polygon fill="black" stroke="black" points="16342.63,-4352.59 16332.06,-4353.23 16340.72,-4359.32 16342.63,-4352.59"/>
</g>
<!-- layer0_expert5_5 -->
<g id="node136" class="node">
<title>layer0_expert5_5</title>
<polygon fill="lightgreen" stroke="black" points="16524,-4355.95 16350,-4355.95 16350,-4272.95 16524,-4272.95 16524,-4355.95"/>
<text text-anchor="middle" x="16437" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU5</text>
<text text-anchor="middle" x="16437" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16437" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16437" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16437" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_5 -->
<g id="edge214" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16698.66,-4403.97C16649.66,-4391.59 16592.72,-4375.96 16533.67,-4356.07"/>
<polygon fill="black" stroke="black" points="16534.77,-4352.75 16524.18,-4352.84 16532.52,-4359.37 16534.77,-4352.75"/>
</g>
<!-- layer0_expert5_6 -->
<g id="node137" class="node">
<title>layer0_expert5_6</title>
<polygon fill="lightgreen" stroke="black" points="16716,-4355.95 16542,-4355.95 16542,-4272.95 16716,-4272.95 16716,-4355.95"/>
<text text-anchor="middle" x="16629" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU5</text>
<text text-anchor="middle" x="16629" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16629" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16629" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16629" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_6 -->
<g id="edge215" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16754.39,-4391.86C16738.15,-4381.97 16720.68,-4371.32 16704.08,-4361.21"/>
<polygon fill="black" stroke="black" points="16705.86,-4358.19 16695.5,-4355.97 16702.21,-4364.17 16705.86,-4358.19"/>
</g>
<!-- layer0_expert5_7 -->
<g id="node138" class="node">
<title>layer0_expert5_7</title>
<polygon fill="lightgreen" stroke="black" points="16908,-4355.95 16734,-4355.95 16734,-4272.95 16908,-4272.95 16908,-4355.95"/>
<text text-anchor="middle" x="16821" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU5</text>
<text text-anchor="middle" x="16821" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16821" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16821" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16821" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_7 -->
<g id="edge216" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16821,-4391.86C16821,-4383.6 16821,-4374.82 16821,-4366.26"/>
<polygon fill="black" stroke="black" points="16824.5,-4365.97 16821,-4355.97 16817.5,-4365.97 16824.5,-4365.97"/>
</g>
<!-- layer0_expert5_8 -->
<g id="node139" class="node">
<title>layer0_expert5_8</title>
<polygon fill="lightgreen" stroke="black" points="17100,-4355.95 16926,-4355.95 16926,-4272.95 17100,-4272.95 17100,-4355.95"/>
<text text-anchor="middle" x="17013" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU5</text>
<text text-anchor="middle" x="17013" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17013" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17013" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17013" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_8 -->
<g id="edge217" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16887.61,-4391.86C16903.85,-4381.97 16921.32,-4371.32 16937.92,-4361.21"/>
<polygon fill="black" stroke="black" points="16939.79,-4364.17 16946.5,-4355.97 16936.14,-4358.19 16939.79,-4364.17"/>
</g>
<!-- layer0_expert5_9 -->
<g id="node140" class="node">
<title>layer0_expert5_9</title>
<polygon fill="lightgreen" stroke="black" points="17292,-4355.95 17118,-4355.95 17118,-4272.95 17292,-4272.95 17292,-4355.95"/>
<text text-anchor="middle" x="17205" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU5</text>
<text text-anchor="middle" x="17205" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17205" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17205" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17205" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_9 -->
<g id="edge218" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16943.34,-4403.97C16992.34,-4391.59 17049.28,-4375.96 17108.33,-4356.07"/>
<polygon fill="black" stroke="black" points="17109.48,-4359.37 17117.82,-4352.84 17107.23,-4352.75 17109.48,-4359.37"/>
</g>
<!-- layer0_expert5_10 -->
<g id="node141" class="node">
<title>layer0_expert5_10</title>
<polygon fill="lightgreen" stroke="black" points="17484,-4355.95 17310,-4355.95 17310,-4272.95 17484,-4272.95 17484,-4355.95"/>
<text text-anchor="middle" x="17397" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU5</text>
<text text-anchor="middle" x="17397" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17397" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17397" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17397" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_10 -->
<g id="edge219" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16943.09,-4421.21C17038.68,-4410.51 17174.63,-4391.09 17300.16,-4356"/>
<polygon fill="black" stroke="black" points="17301.28,-4359.32 17309.94,-4353.23 17299.37,-4352.59 17301.28,-4359.32"/>
</g>
<!-- layer0_expert5_11 -->
<g id="node142" class="node">
<title>layer0_expert5_11</title>
<polygon fill="lightgreen" stroke="black" points="17676,-4355.95 17502,-4355.95 17502,-4272.95 17676,-4272.95 17676,-4355.95"/>
<text text-anchor="middle" x="17589" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU5</text>
<text text-anchor="middle" x="17589" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17589" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17589" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17589" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_11 -->
<g id="edge220" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16943.09,-4429C17076.97,-4422.86 17297.54,-4405.79 17492.16,-4355.96"/>
<polygon fill="black" stroke="black" points="17493.19,-4359.3 17501.99,-4353.4 17491.43,-4352.53 17493.19,-4359.3"/>
</g>
<!-- layer0_expert5_12 -->
<g id="node143" class="node">
<title>layer0_expert5_12</title>
<polygon fill="lightgreen" stroke="black" points="17868,-4355.95 17694,-4355.95 17694,-4272.95 17868,-4272.95 17868,-4355.95"/>
<text text-anchor="middle" x="17781" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU5</text>
<text text-anchor="middle" x="17781" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17781" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17781" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17781" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_12 -->
<g id="edge221" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16943.23,-4426.32C17142.75,-4415.53 17530.69,-4391.15 17684,-4355.92"/>
<polygon fill="black" stroke="black" points="17684.84,-4359.31 17693.75,-4353.58 17683.21,-4352.5 17684.84,-4359.31"/>
</g>
<!-- layer0_expert5_13 -->
<g id="node144" class="node">
<title>layer0_expert5_13</title>
<polygon fill="lightgreen" stroke="black" points="18060,-4355.95 17886,-4355.95 17886,-4272.95 18060,-4272.95 18060,-4355.95"/>
<text text-anchor="middle" x="17973" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU5</text>
<text text-anchor="middle" x="17973" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17973" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17973" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17973" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_13 -->
<g id="edge222" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16943.08,-4428.61C17177.72,-4420.41 17684.62,-4398.58 17875.81,-4355.95"/>
<polygon fill="black" stroke="black" points="17876.81,-4359.31 17885.77,-4353.64 17875.23,-4352.49 17876.81,-4359.31"/>
</g>
<!-- layer0_expert5_14 -->
<g id="node145" class="node">
<title>layer0_expert5_14</title>
<polygon fill="lightgreen" stroke="black" points="18252,-4355.95 18078,-4355.95 18078,-4272.95 18252,-4272.95 18252,-4355.95"/>
<text text-anchor="middle" x="18165" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU5</text>
<text text-anchor="middle" x="18165" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18165" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18165" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18165" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_14 -->
<g id="edge223" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16943.18,-4430.19C17210.05,-4424.43 17838.75,-4406.07 18067.83,-4355.94"/>
<polygon fill="black" stroke="black" points="18068.8,-4359.31 18077.78,-4353.68 18067.25,-4352.48 18068.8,-4359.31"/>
</g>
<!-- layer0_expert5_15 -->
<g id="node146" class="node">
<title>layer0_expert5_15</title>
<polygon fill="lightgreen" stroke="black" points="18444,-4355.95 18270,-4355.95 18270,-4272.95 18444,-4272.95 18444,-4355.95"/>
<text text-anchor="middle" x="18357" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU5</text>
<text text-anchor="middle" x="18357" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18357" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18357" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18357" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_15 -->
<g id="edge224" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16943.2,-4431.37C17239.79,-4427.87 17992.41,-4413.65 18259.71,-4355.96"/>
<polygon fill="black" stroke="black" points="18260.78,-4359.31 18269.78,-4353.71 18259.26,-4352.48 18260.78,-4359.31"/>
</g>
<!-- layer0_moe_agg_gpu5 -->
<g id="node147" class="node">
<title>layer0_moe_agg_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="16922.5,-4236.95 16719.5,-4236.95 16719.5,-4168.95 16922.5,-4168.95 16922.5,-4236.95"/>
<text text-anchor="middle" x="16821" y="-4221.75" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU5</text>
<text text-anchor="middle" x="16821" y="-4206.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="16821" y="-4191.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="16821" y="-4176.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_expert5_0&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge225" class="edge">
<title>layer0_expert5_0&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M15564.22,-4275.2C15567.16,-4274.38 15570.09,-4273.63 15573,-4272.95 15787.24,-4223.42 16444.44,-4209.07 16708.97,-4205.24"/>
<polygon fill="black" stroke="black" points="16709.41,-4208.73 16719.36,-4205.09 16709.31,-4201.73 16709.41,-4208.73"/>
</g>
<!-- layer0_expert5_1&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge226" class="edge">
<title>layer0_expert5_1&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M15756.23,-4275.24C15759.17,-4274.41 15762.1,-4273.64 15765,-4272.95 15941.72,-4231.16 16475.22,-4212.77 16709.09,-4206.56"/>
<polygon fill="black" stroke="black" points="16709.42,-4210.05 16719.32,-4206.29 16709.23,-4203.05 16709.42,-4210.05"/>
</g>
<!-- layer0_expert5_2&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge227" class="edge">
<title>layer0_expert5_2&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M15948.24,-4275.3C15951.18,-4274.45 15954.1,-4273.66 15957,-4272.95 16096.55,-4238.88 16508.54,-4217.25 16708.96,-4208.46"/>
<polygon fill="black" stroke="black" points="16709.39,-4211.94 16719.22,-4208.01 16709.08,-4204.95 16709.39,-4211.94"/>
</g>
<!-- layer0_expert5_3&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge228" class="edge">
<title>layer0_expert5_3&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16140.26,-4275.38C16143.19,-4274.51 16146.11,-4273.69 16149,-4272.95 16341.8,-4223.56 16574.29,-4209.33 16709.12,-4205.35"/>
<polygon fill="black" stroke="black" points="16709.56,-4208.84 16719.46,-4205.06 16709.37,-4201.84 16709.56,-4208.84"/>
</g>
<!-- layer0_expert5_4&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge229" class="edge">
<title>layer0_expert5_4&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16332.04,-4275.62C16335.04,-4274.67 16338.04,-4273.78 16341,-4272.95 16464.52,-4238.64 16610.92,-4220.73 16709.28,-4211.86"/>
<polygon fill="black" stroke="black" points="16709.59,-4215.34 16719.24,-4210.97 16708.97,-4208.37 16709.59,-4215.34"/>
</g>
<!-- layer0_expert5_5&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge230" class="edge">
<title>layer0_expert5_5&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16524.15,-4275.97C16527.12,-4274.92 16530.08,-4273.91 16533,-4272.95 16590.25,-4254.16 16655.45,-4238.11 16709.32,-4226.23"/>
<polygon fill="black" stroke="black" points="16710.22,-4229.62 16719.24,-4224.06 16708.72,-4222.78 16710.22,-4229.62"/>
</g>
<!-- layer0_expert5_6&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge231" class="edge">
<title>layer0_expert5_6&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16700.22,-4272.84C16717.85,-4262.78 16736.68,-4252.04 16754.1,-4242.11"/>
<polygon fill="black" stroke="black" points="16756.11,-4244.99 16763.06,-4237 16752.64,-4238.91 16756.11,-4244.99"/>
</g>
<!-- layer0_expert5_7&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge232" class="edge">
<title>layer0_expert5_7&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16821,-4272.68C16821,-4264.47 16821,-4255.81 16821,-4247.51"/>
<polygon fill="black" stroke="black" points="16824.5,-4247.25 16821,-4237.25 16817.5,-4247.25 16824.5,-4247.25"/>
</g>
<!-- layer0_expert5_8&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge233" class="edge">
<title>layer0_expert5_8&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16941.78,-4272.84C16924.15,-4262.78 16905.32,-4252.04 16887.9,-4242.11"/>
<polygon fill="black" stroke="black" points="16889.36,-4238.91 16878.94,-4237 16885.89,-4244.99 16889.36,-4238.91"/>
</g>
<!-- layer0_expert5_9&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge234" class="edge">
<title>layer0_expert5_9&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17117.85,-4275.97C17114.88,-4274.92 17111.92,-4273.91 17109,-4272.95 17051.75,-4254.16 16986.55,-4238.11 16932.68,-4226.23"/>
<polygon fill="black" stroke="black" points="16933.28,-4222.78 16922.76,-4224.06 16931.78,-4229.62 16933.28,-4222.78"/>
</g>
<!-- layer0_expert5_10&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge235" class="edge">
<title>layer0_expert5_10&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17309.96,-4275.62C17306.96,-4274.67 17303.96,-4273.78 17301,-4272.95 17177.48,-4238.64 17031.08,-4220.73 16932.72,-4211.86"/>
<polygon fill="black" stroke="black" points="16933.03,-4208.37 16922.76,-4210.97 16932.41,-4215.34 16933.03,-4208.37"/>
</g>
<!-- layer0_expert5_11&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge236" class="edge">
<title>layer0_expert5_11&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17501.74,-4275.38C17498.81,-4274.51 17495.89,-4273.69 17493,-4272.95 17300.2,-4223.56 17067.71,-4209.33 16932.88,-4205.35"/>
<polygon fill="black" stroke="black" points="16932.63,-4201.84 16922.54,-4205.06 16932.44,-4208.84 16932.63,-4201.84"/>
</g>
<!-- layer0_expert5_12&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge237" class="edge">
<title>layer0_expert5_12&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17693.76,-4275.3C17690.82,-4274.45 17687.9,-4273.66 17685,-4272.95 17545.45,-4238.88 17133.46,-4217.25 16933.04,-4208.46"/>
<polygon fill="black" stroke="black" points="16932.92,-4204.95 16922.78,-4208.01 16932.61,-4211.94 16932.92,-4204.95"/>
</g>
<!-- layer0_expert5_13&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge238" class="edge">
<title>layer0_expert5_13&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17885.77,-4275.24C17882.83,-4274.41 17879.9,-4273.64 17877,-4272.95 17700.28,-4231.16 17166.78,-4212.77 16932.91,-4206.56"/>
<polygon fill="black" stroke="black" points="16932.77,-4203.05 16922.68,-4206.29 16932.58,-4210.05 16932.77,-4203.05"/>
</g>
<!-- layer0_expert5_14&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge239" class="edge">
<title>layer0_expert5_14&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M18077.78,-4275.2C18074.84,-4274.38 18071.91,-4273.63 18069,-4272.95 17854.76,-4223.42 17197.56,-4209.07 16933.03,-4205.24"/>
<polygon fill="black" stroke="black" points="16932.69,-4201.73 16922.64,-4205.09 16932.59,-4208.73 16932.69,-4201.73"/>
</g>
<!-- layer0_expert5_15&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge240" class="edge">
<title>layer0_expert5_15&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M18269.79,-4275.17C18266.84,-4274.36 18263.91,-4273.62 18261,-4272.95 18008.87,-4215.63 17225.73,-4205.89 16932.95,-4204.27"/>
<polygon fill="black" stroke="black" points="16932.76,-4200.77 16922.75,-4204.21 16932.73,-4207.77 16932.76,-4200.77"/>
</g>
<!-- layer0_moe_agg_gpu5&#45;&gt;layer0_moe_allreduce -->
<g id="edge241" class="edge">
<title>layer0_moe_agg_gpu5&#45;&gt;layer0_moe_allreduce</title>
<path fill="none" stroke="black" d="M16719.36,-4198.89C16149.13,-4181.7 13344.17,-4097.16 12530.58,-4072.63"/>
<polygon fill="black" stroke="black" points="12530.61,-4069.13 12520.51,-4072.33 12530.4,-4076.13 12530.61,-4069.13"/>
</g>
<!-- layer0_output_gpu5 -->
<g id="node148" class="node">
<title>layer0_output_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12824,-3960.95 12580,-3960.95 12580,-3892.95 12824,-3892.95 12824,-3960.95"/>
<text text-anchor="middle" x="12702" y="-3945.75" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU5</text>
<text text-anchor="middle" x="12702" y="-3930.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="12702" y="-3915.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12702" y="-3900.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_qkv_gpu5 -->
<g id="node203" class="node">
<title>layer1_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12802,-3856.95 12602,-3856.95 12602,-3758.95 12802,-3758.95 12802,-3856.95"/>
<text text-anchor="middle" x="12702" y="-3841.75" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU5</text>
<text text-anchor="middle" x="12702" y="-3826.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12702" y="-3811.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12702" y="-3796.75" font-family="Times,serif" font-size="14.00">Heads: 20&#45;23</text>
<text text-anchor="middle" x="12702" y="-3781.75" font-family="Times,serif" font-size="14.00">TP Slice: 5</text>
<text text-anchor="middle" x="12702" y="-3766.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_output_gpu5&#45;&gt;layer1_qkv_gpu5 -->
<g id="edge326" class="edge">
<title>layer0_output_gpu5&#45;&gt;layer1_qkv_gpu5</title>
<path fill="none" stroke="black" d="M12702,-3892.74C12702,-3884.78 12702,-3876.04 12702,-3867.3"/>
<polygon fill="black" stroke="black" points="12705.5,-3867.1 12702,-3857.1 12698.5,-3867.1 12705.5,-3867.1"/>
</g>
<!-- layer0_expert6_0 -->
<g id="node150" class="node">
<title>layer0_expert6_0</title>
<polygon fill="lightgreen" stroke="black" points="18636,-4355.95 18462,-4355.95 18462,-4272.95 18636,-4272.95 18636,-4355.95"/>
<text text-anchor="middle" x="18549" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU6</text>
<text text-anchor="middle" x="18549" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18549" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18549" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18549" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_0 -->
<g id="edge248" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19770.82,-4430.19C19503.95,-4424.43 18875.25,-4406.07 18646.17,-4355.94"/>
<polygon fill="black" stroke="black" points="18646.75,-4352.48 18636.22,-4353.68 18645.2,-4359.31 18646.75,-4352.48"/>
</g>
<!-- layer0_expert6_1 -->
<g id="node151" class="node">
<title>layer0_expert6_1</title>
<polygon fill="lightgreen" stroke="black" points="18828,-4355.95 18654,-4355.95 18654,-4272.95 18828,-4272.95 18828,-4355.95"/>
<text text-anchor="middle" x="18741" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU6</text>
<text text-anchor="middle" x="18741" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18741" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18741" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18741" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_1 -->
<g id="edge249" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19770.92,-4428.61C19536.28,-4420.41 19029.38,-4398.58 18838.19,-4355.95"/>
<polygon fill="black" stroke="black" points="18838.77,-4352.49 18828.23,-4353.64 18837.19,-4359.31 18838.77,-4352.49"/>
</g>
<!-- layer0_expert6_2 -->
<g id="node152" class="node">
<title>layer0_expert6_2</title>
<polygon fill="lightgreen" stroke="black" points="19020,-4355.95 18846,-4355.95 18846,-4272.95 19020,-4272.95 19020,-4355.95"/>
<text text-anchor="middle" x="18933" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU6</text>
<text text-anchor="middle" x="18933" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18933" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18933" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18933" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_2 -->
<g id="edge250" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19770.77,-4426.32C19571.25,-4415.53 19183.31,-4391.15 19030,-4355.92"/>
<polygon fill="black" stroke="black" points="19030.79,-4352.5 19020.25,-4353.58 19029.16,-4359.31 19030.79,-4352.5"/>
</g>
<!-- layer0_expert6_3 -->
<g id="node153" class="node">
<title>layer0_expert6_3</title>
<polygon fill="lightgreen" stroke="black" points="19212,-4355.95 19038,-4355.95 19038,-4272.95 19212,-4272.95 19212,-4355.95"/>
<text text-anchor="middle" x="19125" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU6</text>
<text text-anchor="middle" x="19125" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19125" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19125" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19125" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_3 -->
<g id="edge251" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19770.91,-4429C19637.03,-4422.86 19416.46,-4405.79 19221.84,-4355.96"/>
<polygon fill="black" stroke="black" points="19222.57,-4352.53 19212.01,-4353.4 19220.81,-4359.3 19222.57,-4352.53"/>
</g>
<!-- layer0_expert6_4 -->
<g id="node154" class="node">
<title>layer0_expert6_4</title>
<polygon fill="lightgreen" stroke="black" points="19404,-4355.95 19230,-4355.95 19230,-4272.95 19404,-4272.95 19404,-4355.95"/>
<text text-anchor="middle" x="19317" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU6</text>
<text text-anchor="middle" x="19317" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19317" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19317" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19317" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_4 -->
<g id="edge252" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19770.91,-4421.21C19675.32,-4410.51 19539.37,-4391.09 19413.84,-4356"/>
<polygon fill="black" stroke="black" points="19414.63,-4352.59 19404.06,-4353.23 19412.72,-4359.32 19414.63,-4352.59"/>
</g>
<!-- layer0_expert6_5 -->
<g id="node155" class="node">
<title>layer0_expert6_5</title>
<polygon fill="lightgreen" stroke="black" points="19596,-4355.95 19422,-4355.95 19422,-4272.95 19596,-4272.95 19596,-4355.95"/>
<text text-anchor="middle" x="19509" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU6</text>
<text text-anchor="middle" x="19509" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19509" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19509" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19509" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_5 -->
<g id="edge253" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19770.66,-4403.97C19721.66,-4391.59 19664.72,-4375.96 19605.67,-4356.07"/>
<polygon fill="black" stroke="black" points="19606.77,-4352.75 19596.18,-4352.84 19604.52,-4359.37 19606.77,-4352.75"/>
</g>
<!-- layer0_expert6_6 -->
<g id="node156" class="node">
<title>layer0_expert6_6</title>
<polygon fill="lightgreen" stroke="black" points="19788,-4355.95 19614,-4355.95 19614,-4272.95 19788,-4272.95 19788,-4355.95"/>
<text text-anchor="middle" x="19701" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU6</text>
<text text-anchor="middle" x="19701" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19701" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19701" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19701" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_6 -->
<g id="edge254" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19826.39,-4391.86C19810.15,-4381.97 19792.68,-4371.32 19776.08,-4361.21"/>
<polygon fill="black" stroke="black" points="19777.86,-4358.19 19767.5,-4355.97 19774.21,-4364.17 19777.86,-4358.19"/>
</g>
<!-- layer0_expert6_7 -->
<g id="node157" class="node">
<title>layer0_expert6_7</title>
<polygon fill="lightgreen" stroke="black" points="19980,-4355.95 19806,-4355.95 19806,-4272.95 19980,-4272.95 19980,-4355.95"/>
<text text-anchor="middle" x="19893" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU6</text>
<text text-anchor="middle" x="19893" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19893" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19893" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19893" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_7 -->
<g id="edge255" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19893,-4391.86C19893,-4383.6 19893,-4374.82 19893,-4366.26"/>
<polygon fill="black" stroke="black" points="19896.5,-4365.97 19893,-4355.97 19889.5,-4365.97 19896.5,-4365.97"/>
</g>
<!-- layer0_expert6_8 -->
<g id="node158" class="node">
<title>layer0_expert6_8</title>
<polygon fill="lightgreen" stroke="black" points="20172,-4355.95 19998,-4355.95 19998,-4272.95 20172,-4272.95 20172,-4355.95"/>
<text text-anchor="middle" x="20085" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU6</text>
<text text-anchor="middle" x="20085" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20085" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20085" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20085" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_8 -->
<g id="edge256" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19959.61,-4391.86C19975.85,-4381.97 19993.32,-4371.32 20009.92,-4361.21"/>
<polygon fill="black" stroke="black" points="20011.79,-4364.17 20018.5,-4355.97 20008.14,-4358.19 20011.79,-4364.17"/>
</g>
<!-- layer0_expert6_9 -->
<g id="node159" class="node">
<title>layer0_expert6_9</title>
<polygon fill="lightgreen" stroke="black" points="20364,-4355.95 20190,-4355.95 20190,-4272.95 20364,-4272.95 20364,-4355.95"/>
<text text-anchor="middle" x="20277" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU6</text>
<text text-anchor="middle" x="20277" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20277" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20277" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20277" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_9 -->
<g id="edge257" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20015.34,-4403.97C20064.34,-4391.59 20121.28,-4375.96 20180.33,-4356.07"/>
<polygon fill="black" stroke="black" points="20181.48,-4359.37 20189.82,-4352.84 20179.23,-4352.75 20181.48,-4359.37"/>
</g>
<!-- layer0_expert6_10 -->
<g id="node160" class="node">
<title>layer0_expert6_10</title>
<polygon fill="lightgreen" stroke="black" points="20556,-4355.95 20382,-4355.95 20382,-4272.95 20556,-4272.95 20556,-4355.95"/>
<text text-anchor="middle" x="20469" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU6</text>
<text text-anchor="middle" x="20469" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20469" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20469" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20469" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_10 -->
<g id="edge258" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20015.09,-4421.21C20110.68,-4410.51 20246.63,-4391.09 20372.16,-4356"/>
<polygon fill="black" stroke="black" points="20373.28,-4359.32 20381.94,-4353.23 20371.37,-4352.59 20373.28,-4359.32"/>
</g>
<!-- layer0_expert6_11 -->
<g id="node161" class="node">
<title>layer0_expert6_11</title>
<polygon fill="lightgreen" stroke="black" points="20748,-4355.95 20574,-4355.95 20574,-4272.95 20748,-4272.95 20748,-4355.95"/>
<text text-anchor="middle" x="20661" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU6</text>
<text text-anchor="middle" x="20661" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20661" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20661" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20661" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_11 -->
<g id="edge259" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20015.09,-4429C20148.97,-4422.86 20369.54,-4405.79 20564.16,-4355.96"/>
<polygon fill="black" stroke="black" points="20565.19,-4359.3 20573.99,-4353.4 20563.43,-4352.53 20565.19,-4359.3"/>
</g>
<!-- layer0_expert6_12 -->
<g id="node162" class="node">
<title>layer0_expert6_12</title>
<polygon fill="lightgreen" stroke="black" points="20940,-4355.95 20766,-4355.95 20766,-4272.95 20940,-4272.95 20940,-4355.95"/>
<text text-anchor="middle" x="20853" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU6</text>
<text text-anchor="middle" x="20853" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20853" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20853" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20853" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_12 -->
<g id="edge260" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20015.23,-4426.32C20214.75,-4415.53 20602.69,-4391.15 20756,-4355.92"/>
<polygon fill="black" stroke="black" points="20756.84,-4359.31 20765.75,-4353.58 20755.21,-4352.5 20756.84,-4359.31"/>
</g>
<!-- layer0_expert6_13 -->
<g id="node163" class="node">
<title>layer0_expert6_13</title>
<polygon fill="lightgreen" stroke="black" points="21132,-4355.95 20958,-4355.95 20958,-4272.95 21132,-4272.95 21132,-4355.95"/>
<text text-anchor="middle" x="21045" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU6</text>
<text text-anchor="middle" x="21045" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21045" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21045" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21045" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_13 -->
<g id="edge261" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20015.08,-4428.61C20249.72,-4420.41 20756.62,-4398.58 20947.81,-4355.95"/>
<polygon fill="black" stroke="black" points="20948.81,-4359.31 20957.77,-4353.64 20947.23,-4352.49 20948.81,-4359.31"/>
</g>
<!-- layer0_expert6_14 -->
<g id="node164" class="node">
<title>layer0_expert6_14</title>
<polygon fill="lightgreen" stroke="black" points="21324,-4355.95 21150,-4355.95 21150,-4272.95 21324,-4272.95 21324,-4355.95"/>
<text text-anchor="middle" x="21237" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU6</text>
<text text-anchor="middle" x="21237" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21237" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21237" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21237" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_14 -->
<g id="edge262" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20015.18,-4430.19C20282.05,-4424.43 20910.75,-4406.07 21139.83,-4355.94"/>
<polygon fill="black" stroke="black" points="21140.8,-4359.31 21149.78,-4353.68 21139.25,-4352.48 21140.8,-4359.31"/>
</g>
<!-- layer0_expert6_15 -->
<g id="node165" class="node">
<title>layer0_expert6_15</title>
<polygon fill="lightgreen" stroke="black" points="21516,-4355.95 21342,-4355.95 21342,-4272.95 21516,-4272.95 21516,-4355.95"/>
<text text-anchor="middle" x="21429" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU6</text>
<text text-anchor="middle" x="21429" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21429" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21429" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21429" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_15 -->
<g id="edge263" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20015.2,-4431.37C20311.79,-4427.87 21064.41,-4413.65 21331.71,-4355.96"/>
<polygon fill="black" stroke="black" points="21332.78,-4359.31 21341.78,-4353.71 21331.26,-4352.48 21332.78,-4359.31"/>
</g>
<!-- layer0_moe_agg_gpu6 -->
<g id="node166" class="node">
<title>layer0_moe_agg_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="19994.5,-4236.95 19791.5,-4236.95 19791.5,-4168.95 19994.5,-4168.95 19994.5,-4236.95"/>
<text text-anchor="middle" x="19893" y="-4221.75" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU6</text>
<text text-anchor="middle" x="19893" y="-4206.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="19893" y="-4191.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="19893" y="-4176.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_expert6_0&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge264" class="edge">
<title>layer0_expert6_0&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M18636.22,-4275.2C18639.16,-4274.38 18642.09,-4273.63 18645,-4272.95 18859.24,-4223.42 19516.44,-4209.07 19780.97,-4205.24"/>
<polygon fill="black" stroke="black" points="19781.41,-4208.73 19791.36,-4205.09 19781.31,-4201.73 19781.41,-4208.73"/>
</g>
<!-- layer0_expert6_1&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge265" class="edge">
<title>layer0_expert6_1&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M18828.23,-4275.24C18831.17,-4274.41 18834.1,-4273.64 18837,-4272.95 19013.72,-4231.16 19547.22,-4212.77 19781.09,-4206.56"/>
<polygon fill="black" stroke="black" points="19781.42,-4210.05 19791.32,-4206.29 19781.23,-4203.05 19781.42,-4210.05"/>
</g>
<!-- layer0_expert6_2&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge266" class="edge">
<title>layer0_expert6_2&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19020.24,-4275.3C19023.18,-4274.45 19026.1,-4273.66 19029,-4272.95 19168.55,-4238.88 19580.54,-4217.25 19780.96,-4208.46"/>
<polygon fill="black" stroke="black" points="19781.39,-4211.94 19791.22,-4208.01 19781.08,-4204.95 19781.39,-4211.94"/>
</g>
<!-- layer0_expert6_3&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge267" class="edge">
<title>layer0_expert6_3&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19212.26,-4275.38C19215.19,-4274.51 19218.11,-4273.69 19221,-4272.95 19413.8,-4223.56 19646.29,-4209.33 19781.12,-4205.35"/>
<polygon fill="black" stroke="black" points="19781.56,-4208.84 19791.46,-4205.06 19781.37,-4201.84 19781.56,-4208.84"/>
</g>
<!-- layer0_expert6_4&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge268" class="edge">
<title>layer0_expert6_4&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19404.04,-4275.62C19407.04,-4274.67 19410.04,-4273.78 19413,-4272.95 19536.52,-4238.64 19682.92,-4220.73 19781.28,-4211.86"/>
<polygon fill="black" stroke="black" points="19781.59,-4215.34 19791.24,-4210.97 19780.97,-4208.37 19781.59,-4215.34"/>
</g>
<!-- layer0_expert6_5&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge269" class="edge">
<title>layer0_expert6_5&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19596.15,-4275.97C19599.12,-4274.92 19602.08,-4273.91 19605,-4272.95 19662.25,-4254.16 19727.45,-4238.11 19781.32,-4226.23"/>
<polygon fill="black" stroke="black" points="19782.22,-4229.62 19791.24,-4224.06 19780.72,-4222.78 19782.22,-4229.62"/>
</g>
<!-- layer0_expert6_6&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge270" class="edge">
<title>layer0_expert6_6&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19772.22,-4272.84C19789.85,-4262.78 19808.68,-4252.04 19826.1,-4242.11"/>
<polygon fill="black" stroke="black" points="19828.11,-4244.99 19835.06,-4237 19824.64,-4238.91 19828.11,-4244.99"/>
</g>
<!-- layer0_expert6_7&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge271" class="edge">
<title>layer0_expert6_7&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19893,-4272.68C19893,-4264.47 19893,-4255.81 19893,-4247.51"/>
<polygon fill="black" stroke="black" points="19896.5,-4247.25 19893,-4237.25 19889.5,-4247.25 19896.5,-4247.25"/>
</g>
<!-- layer0_expert6_8&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge272" class="edge">
<title>layer0_expert6_8&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20013.78,-4272.84C19996.15,-4262.78 19977.32,-4252.04 19959.9,-4242.11"/>
<polygon fill="black" stroke="black" points="19961.36,-4238.91 19950.94,-4237 19957.89,-4244.99 19961.36,-4238.91"/>
</g>
<!-- layer0_expert6_9&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge273" class="edge">
<title>layer0_expert6_9&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20189.85,-4275.97C20186.88,-4274.92 20183.92,-4273.91 20181,-4272.95 20123.75,-4254.16 20058.55,-4238.11 20004.68,-4226.23"/>
<polygon fill="black" stroke="black" points="20005.28,-4222.78 19994.76,-4224.06 20003.78,-4229.62 20005.28,-4222.78"/>
</g>
<!-- layer0_expert6_10&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge274" class="edge">
<title>layer0_expert6_10&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20381.96,-4275.62C20378.96,-4274.67 20375.96,-4273.78 20373,-4272.95 20249.48,-4238.64 20103.08,-4220.73 20004.72,-4211.86"/>
<polygon fill="black" stroke="black" points="20005.03,-4208.37 19994.76,-4210.97 20004.41,-4215.34 20005.03,-4208.37"/>
</g>
<!-- layer0_expert6_11&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge275" class="edge">
<title>layer0_expert6_11&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20573.74,-4275.38C20570.81,-4274.51 20567.89,-4273.69 20565,-4272.95 20372.2,-4223.56 20139.71,-4209.33 20004.88,-4205.35"/>
<polygon fill="black" stroke="black" points="20004.63,-4201.84 19994.54,-4205.06 20004.44,-4208.84 20004.63,-4201.84"/>
</g>
<!-- layer0_expert6_12&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge276" class="edge">
<title>layer0_expert6_12&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20765.76,-4275.3C20762.82,-4274.45 20759.9,-4273.66 20757,-4272.95 20617.45,-4238.88 20205.46,-4217.25 20005.04,-4208.46"/>
<polygon fill="black" stroke="black" points="20004.92,-4204.95 19994.78,-4208.01 20004.61,-4211.94 20004.92,-4204.95"/>
</g>
<!-- layer0_expert6_13&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge277" class="edge">
<title>layer0_expert6_13&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20957.77,-4275.24C20954.83,-4274.41 20951.9,-4273.64 20949,-4272.95 20772.28,-4231.16 20238.78,-4212.77 20004.91,-4206.56"/>
<polygon fill="black" stroke="black" points="20004.77,-4203.05 19994.68,-4206.29 20004.58,-4210.05 20004.77,-4203.05"/>
</g>
<!-- layer0_expert6_14&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge278" class="edge">
<title>layer0_expert6_14&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M21149.78,-4275.2C21146.84,-4274.38 21143.91,-4273.63 21141,-4272.95 20926.76,-4223.42 20269.56,-4209.07 20005.03,-4205.24"/>
<polygon fill="black" stroke="black" points="20004.69,-4201.73 19994.64,-4205.09 20004.59,-4208.73 20004.69,-4201.73"/>
</g>
<!-- layer0_expert6_15&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge279" class="edge">
<title>layer0_expert6_15&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M21341.79,-4275.17C21338.84,-4274.36 21335.91,-4273.62 21333,-4272.95 21080.87,-4215.63 20297.73,-4205.89 20004.95,-4204.27"/>
<polygon fill="black" stroke="black" points="20004.76,-4200.77 19994.75,-4204.21 20004.73,-4207.77 20004.76,-4200.77"/>
</g>
<!-- layer0_moe_agg_gpu6&#45;&gt;layer0_moe_allreduce -->
<g id="edge280" class="edge">
<title>layer0_moe_agg_gpu6&#45;&gt;layer0_moe_allreduce</title>
<path fill="none" stroke="black" d="M19791.17,-4200.13C18990.78,-4185.77 13711.68,-4091.11 12539.36,-4070.08"/>
<polygon fill="black" stroke="black" points="12539.2,-4066.58 12529.14,-4069.9 12539.07,-4073.58 12539.2,-4066.58"/>
</g>
<!-- layer0_output_gpu6 -->
<g id="node167" class="node">
<title>layer0_output_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="13086,-3960.95 12842,-3960.95 12842,-3892.95 13086,-3892.95 13086,-3960.95"/>
<text text-anchor="middle" x="12964" y="-3945.75" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU6</text>
<text text-anchor="middle" x="12964" y="-3930.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="12964" y="-3915.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12964" y="-3900.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_qkv_gpu6 -->
<g id="node206" class="node">
<title>layer1_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="13063,-3856.95 12863,-3856.95 12863,-3758.95 13063,-3758.95 13063,-3856.95"/>
<text text-anchor="middle" x="12963" y="-3841.75" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU6</text>
<text text-anchor="middle" x="12963" y="-3826.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12963" y="-3811.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12963" y="-3796.75" font-family="Times,serif" font-size="14.00">Heads: 24&#45;27</text>
<text text-anchor="middle" x="12963" y="-3781.75" font-family="Times,serif" font-size="14.00">TP Slice: 6</text>
<text text-anchor="middle" x="12963" y="-3766.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_output_gpu6&#45;&gt;layer1_qkv_gpu6 -->
<g id="edge327" class="edge">
<title>layer0_output_gpu6&#45;&gt;layer1_qkv_gpu6</title>
<path fill="none" stroke="black" d="M12963.72,-3892.74C12963.65,-3884.78 12963.57,-3876.04 12963.5,-3867.3"/>
<polygon fill="black" stroke="black" points="12967,-3867.07 12963.41,-3857.1 12960,-3867.13 12967,-3867.07"/>
</g>
<!-- layer0_expert7_0 -->
<g id="node169" class="node">
<title>layer0_expert7_0</title>
<polygon fill="lightgreen" stroke="black" points="21708,-4355.95 21534,-4355.95 21534,-4272.95 21708,-4272.95 21708,-4355.95"/>
<text text-anchor="middle" x="21621" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU7</text>
<text text-anchor="middle" x="21621" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21621" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21621" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21621" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_0 -->
<g id="edge287" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22842.82,-4430.19C22575.95,-4424.43 21947.25,-4406.07 21718.17,-4355.94"/>
<polygon fill="black" stroke="black" points="21718.75,-4352.48 21708.22,-4353.68 21717.2,-4359.31 21718.75,-4352.48"/>
</g>
<!-- layer0_expert7_1 -->
<g id="node170" class="node">
<title>layer0_expert7_1</title>
<polygon fill="lightgreen" stroke="black" points="21900,-4355.95 21726,-4355.95 21726,-4272.95 21900,-4272.95 21900,-4355.95"/>
<text text-anchor="middle" x="21813" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU7</text>
<text text-anchor="middle" x="21813" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21813" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21813" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21813" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_1 -->
<g id="edge288" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22842.92,-4428.61C22608.28,-4420.41 22101.38,-4398.58 21910.19,-4355.95"/>
<polygon fill="black" stroke="black" points="21910.77,-4352.49 21900.23,-4353.64 21909.19,-4359.31 21910.77,-4352.49"/>
</g>
<!-- layer0_expert7_2 -->
<g id="node171" class="node">
<title>layer0_expert7_2</title>
<polygon fill="lightgreen" stroke="black" points="22092,-4355.95 21918,-4355.95 21918,-4272.95 22092,-4272.95 22092,-4355.95"/>
<text text-anchor="middle" x="22005" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU7</text>
<text text-anchor="middle" x="22005" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22005" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22005" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22005" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_2 -->
<g id="edge289" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22842.77,-4426.32C22643.25,-4415.53 22255.31,-4391.15 22102,-4355.92"/>
<polygon fill="black" stroke="black" points="22102.79,-4352.5 22092.25,-4353.58 22101.16,-4359.31 22102.79,-4352.5"/>
</g>
<!-- layer0_expert7_3 -->
<g id="node172" class="node">
<title>layer0_expert7_3</title>
<polygon fill="lightgreen" stroke="black" points="22284,-4355.95 22110,-4355.95 22110,-4272.95 22284,-4272.95 22284,-4355.95"/>
<text text-anchor="middle" x="22197" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU7</text>
<text text-anchor="middle" x="22197" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22197" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22197" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22197" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_3 -->
<g id="edge290" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22842.91,-4429C22709.03,-4422.86 22488.46,-4405.79 22293.84,-4355.96"/>
<polygon fill="black" stroke="black" points="22294.57,-4352.53 22284.01,-4353.4 22292.81,-4359.3 22294.57,-4352.53"/>
</g>
<!-- layer0_expert7_4 -->
<g id="node173" class="node">
<title>layer0_expert7_4</title>
<polygon fill="lightgreen" stroke="black" points="22476,-4355.95 22302,-4355.95 22302,-4272.95 22476,-4272.95 22476,-4355.95"/>
<text text-anchor="middle" x="22389" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU7</text>
<text text-anchor="middle" x="22389" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22389" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22389" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22389" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_4 -->
<g id="edge291" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22842.91,-4421.21C22747.32,-4410.51 22611.37,-4391.09 22485.84,-4356"/>
<polygon fill="black" stroke="black" points="22486.63,-4352.59 22476.06,-4353.23 22484.72,-4359.32 22486.63,-4352.59"/>
</g>
<!-- layer0_expert7_5 -->
<g id="node174" class="node">
<title>layer0_expert7_5</title>
<polygon fill="lightgreen" stroke="black" points="22668,-4355.95 22494,-4355.95 22494,-4272.95 22668,-4272.95 22668,-4355.95"/>
<text text-anchor="middle" x="22581" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU7</text>
<text text-anchor="middle" x="22581" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22581" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22581" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22581" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_5 -->
<g id="edge292" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22842.66,-4403.97C22793.66,-4391.59 22736.72,-4375.96 22677.67,-4356.07"/>
<polygon fill="black" stroke="black" points="22678.77,-4352.75 22668.18,-4352.84 22676.52,-4359.37 22678.77,-4352.75"/>
</g>
<!-- layer0_expert7_6 -->
<g id="node175" class="node">
<title>layer0_expert7_6</title>
<polygon fill="lightgreen" stroke="black" points="22860,-4355.95 22686,-4355.95 22686,-4272.95 22860,-4272.95 22860,-4355.95"/>
<text text-anchor="middle" x="22773" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU7</text>
<text text-anchor="middle" x="22773" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22773" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22773" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22773" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_6 -->
<g id="edge293" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22898.39,-4391.86C22882.15,-4381.97 22864.68,-4371.32 22848.08,-4361.21"/>
<polygon fill="black" stroke="black" points="22849.86,-4358.19 22839.5,-4355.97 22846.21,-4364.17 22849.86,-4358.19"/>
</g>
<!-- layer0_expert7_7 -->
<g id="node176" class="node">
<title>layer0_expert7_7</title>
<polygon fill="lightgreen" stroke="black" points="23052,-4355.95 22878,-4355.95 22878,-4272.95 23052,-4272.95 23052,-4355.95"/>
<text text-anchor="middle" x="22965" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU7</text>
<text text-anchor="middle" x="22965" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22965" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22965" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22965" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_7 -->
<g id="edge294" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22965,-4391.86C22965,-4383.6 22965,-4374.82 22965,-4366.26"/>
<polygon fill="black" stroke="black" points="22968.5,-4365.97 22965,-4355.97 22961.5,-4365.97 22968.5,-4365.97"/>
</g>
<!-- layer0_expert7_8 -->
<g id="node177" class="node">
<title>layer0_expert7_8</title>
<polygon fill="lightgreen" stroke="black" points="23244,-4355.95 23070,-4355.95 23070,-4272.95 23244,-4272.95 23244,-4355.95"/>
<text text-anchor="middle" x="23157" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU7</text>
<text text-anchor="middle" x="23157" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23157" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23157" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23157" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_8 -->
<g id="edge295" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23031.61,-4391.86C23047.85,-4381.97 23065.32,-4371.32 23081.92,-4361.21"/>
<polygon fill="black" stroke="black" points="23083.79,-4364.17 23090.5,-4355.97 23080.14,-4358.19 23083.79,-4364.17"/>
</g>
<!-- layer0_expert7_9 -->
<g id="node178" class="node">
<title>layer0_expert7_9</title>
<polygon fill="lightgreen" stroke="black" points="23436,-4355.95 23262,-4355.95 23262,-4272.95 23436,-4272.95 23436,-4355.95"/>
<text text-anchor="middle" x="23349" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU7</text>
<text text-anchor="middle" x="23349" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23349" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23349" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23349" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_9 -->
<g id="edge296" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23087.34,-4403.97C23136.34,-4391.59 23193.28,-4375.96 23252.33,-4356.07"/>
<polygon fill="black" stroke="black" points="23253.48,-4359.37 23261.82,-4352.84 23251.23,-4352.75 23253.48,-4359.37"/>
</g>
<!-- layer0_expert7_10 -->
<g id="node179" class="node">
<title>layer0_expert7_10</title>
<polygon fill="lightgreen" stroke="black" points="23628,-4355.95 23454,-4355.95 23454,-4272.95 23628,-4272.95 23628,-4355.95"/>
<text text-anchor="middle" x="23541" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU7</text>
<text text-anchor="middle" x="23541" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23541" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23541" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23541" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_10 -->
<g id="edge297" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23087.09,-4421.21C23182.68,-4410.51 23318.63,-4391.09 23444.16,-4356"/>
<polygon fill="black" stroke="black" points="23445.28,-4359.32 23453.94,-4353.23 23443.37,-4352.59 23445.28,-4359.32"/>
</g>
<!-- layer0_expert7_11 -->
<g id="node180" class="node">
<title>layer0_expert7_11</title>
<polygon fill="lightgreen" stroke="black" points="23820,-4355.95 23646,-4355.95 23646,-4272.95 23820,-4272.95 23820,-4355.95"/>
<text text-anchor="middle" x="23733" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU7</text>
<text text-anchor="middle" x="23733" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23733" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23733" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23733" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_11 -->
<g id="edge298" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23087.09,-4429C23220.97,-4422.86 23441.54,-4405.79 23636.16,-4355.96"/>
<polygon fill="black" stroke="black" points="23637.19,-4359.3 23645.99,-4353.4 23635.43,-4352.53 23637.19,-4359.3"/>
</g>
<!-- layer0_expert7_12 -->
<g id="node181" class="node">
<title>layer0_expert7_12</title>
<polygon fill="lightgreen" stroke="black" points="24012,-4355.95 23838,-4355.95 23838,-4272.95 24012,-4272.95 24012,-4355.95"/>
<text text-anchor="middle" x="23925" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU7</text>
<text text-anchor="middle" x="23925" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23925" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23925" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23925" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_12 -->
<g id="edge299" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23087.23,-4426.32C23286.75,-4415.53 23674.69,-4391.15 23828,-4355.92"/>
<polygon fill="black" stroke="black" points="23828.84,-4359.31 23837.75,-4353.58 23827.21,-4352.5 23828.84,-4359.31"/>
</g>
<!-- layer0_expert7_13 -->
<g id="node182" class="node">
<title>layer0_expert7_13</title>
<polygon fill="lightgreen" stroke="black" points="24204,-4355.95 24030,-4355.95 24030,-4272.95 24204,-4272.95 24204,-4355.95"/>
<text text-anchor="middle" x="24117" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU7</text>
<text text-anchor="middle" x="24117" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24117" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24117" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24117" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_13 -->
<g id="edge300" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23087.08,-4428.61C23321.72,-4420.41 23828.62,-4398.58 24019.81,-4355.95"/>
<polygon fill="black" stroke="black" points="24020.81,-4359.31 24029.77,-4353.64 24019.23,-4352.49 24020.81,-4359.31"/>
</g>
<!-- layer0_expert7_14 -->
<g id="node183" class="node">
<title>layer0_expert7_14</title>
<polygon fill="lightgreen" stroke="black" points="24396,-4355.95 24222,-4355.95 24222,-4272.95 24396,-4272.95 24396,-4355.95"/>
<text text-anchor="middle" x="24309" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU7</text>
<text text-anchor="middle" x="24309" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24309" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24309" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24309" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_14 -->
<g id="edge301" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23087.18,-4430.19C23354.05,-4424.43 23982.75,-4406.07 24211.83,-4355.94"/>
<polygon fill="black" stroke="black" points="24212.8,-4359.31 24221.78,-4353.68 24211.25,-4352.48 24212.8,-4359.31"/>
</g>
<!-- layer0_expert7_15 -->
<g id="node184" class="node">
<title>layer0_expert7_15</title>
<polygon fill="lightgreen" stroke="black" points="24588,-4355.95 24414,-4355.95 24414,-4272.95 24588,-4272.95 24588,-4355.95"/>
<text text-anchor="middle" x="24501" y="-4340.75" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU7</text>
<text text-anchor="middle" x="24501" y="-4325.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24501" y="-4310.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24501" y="-4295.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24501" y="-4280.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_15 -->
<g id="edge302" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23087.2,-4431.37C23383.79,-4427.87 24136.41,-4413.65 24403.71,-4355.96"/>
<polygon fill="black" stroke="black" points="24404.78,-4359.31 24413.78,-4353.71 24403.26,-4352.48 24404.78,-4359.31"/>
</g>
<!-- layer0_moe_agg_gpu7 -->
<g id="node185" class="node">
<title>layer0_moe_agg_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="23066.5,-4236.95 22863.5,-4236.95 22863.5,-4168.95 23066.5,-4168.95 23066.5,-4236.95"/>
<text text-anchor="middle" x="22965" y="-4221.75" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU7</text>
<text text-anchor="middle" x="22965" y="-4206.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="22965" y="-4191.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="22965" y="-4176.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_expert7_0&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge303" class="edge">
<title>layer0_expert7_0&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M21708.22,-4275.2C21711.16,-4274.38 21714.09,-4273.63 21717,-4272.95 21931.24,-4223.42 22588.44,-4209.07 22852.97,-4205.24"/>
<polygon fill="black" stroke="black" points="22853.41,-4208.73 22863.36,-4205.09 22853.31,-4201.73 22853.41,-4208.73"/>
</g>
<!-- layer0_expert7_1&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge304" class="edge">
<title>layer0_expert7_1&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M21900.23,-4275.24C21903.17,-4274.41 21906.1,-4273.64 21909,-4272.95 22085.72,-4231.16 22619.22,-4212.77 22853.09,-4206.56"/>
<polygon fill="black" stroke="black" points="22853.42,-4210.05 22863.32,-4206.29 22853.23,-4203.05 22853.42,-4210.05"/>
</g>
<!-- layer0_expert7_2&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge305" class="edge">
<title>layer0_expert7_2&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22092.24,-4275.3C22095.18,-4274.45 22098.1,-4273.66 22101,-4272.95 22240.55,-4238.88 22652.54,-4217.25 22852.96,-4208.46"/>
<polygon fill="black" stroke="black" points="22853.39,-4211.94 22863.22,-4208.01 22853.08,-4204.95 22853.39,-4211.94"/>
</g>
<!-- layer0_expert7_3&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge306" class="edge">
<title>layer0_expert7_3&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22284.26,-4275.38C22287.19,-4274.51 22290.11,-4273.69 22293,-4272.95 22485.8,-4223.56 22718.29,-4209.33 22853.12,-4205.35"/>
<polygon fill="black" stroke="black" points="22853.56,-4208.84 22863.46,-4205.06 22853.37,-4201.84 22853.56,-4208.84"/>
</g>
<!-- layer0_expert7_4&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge307" class="edge">
<title>layer0_expert7_4&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22476.04,-4275.62C22479.04,-4274.67 22482.04,-4273.78 22485,-4272.95 22608.52,-4238.64 22754.92,-4220.73 22853.28,-4211.86"/>
<polygon fill="black" stroke="black" points="22853.59,-4215.34 22863.24,-4210.97 22852.97,-4208.37 22853.59,-4215.34"/>
</g>
<!-- layer0_expert7_5&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge308" class="edge">
<title>layer0_expert7_5&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22668.15,-4275.97C22671.12,-4274.92 22674.08,-4273.91 22677,-4272.95 22734.25,-4254.16 22799.45,-4238.11 22853.32,-4226.23"/>
<polygon fill="black" stroke="black" points="22854.22,-4229.62 22863.24,-4224.06 22852.72,-4222.78 22854.22,-4229.62"/>
</g>
<!-- layer0_expert7_6&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge309" class="edge">
<title>layer0_expert7_6&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22844.22,-4272.84C22861.85,-4262.78 22880.68,-4252.04 22898.1,-4242.11"/>
<polygon fill="black" stroke="black" points="22900.11,-4244.99 22907.06,-4237 22896.64,-4238.91 22900.11,-4244.99"/>
</g>
<!-- layer0_expert7_7&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge310" class="edge">
<title>layer0_expert7_7&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22965,-4272.68C22965,-4264.47 22965,-4255.81 22965,-4247.51"/>
<polygon fill="black" stroke="black" points="22968.5,-4247.25 22965,-4237.25 22961.5,-4247.25 22968.5,-4247.25"/>
</g>
<!-- layer0_expert7_8&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge311" class="edge">
<title>layer0_expert7_8&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23085.78,-4272.84C23068.15,-4262.78 23049.32,-4252.04 23031.9,-4242.11"/>
<polygon fill="black" stroke="black" points="23033.36,-4238.91 23022.94,-4237 23029.89,-4244.99 23033.36,-4238.91"/>
</g>
<!-- layer0_expert7_9&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge312" class="edge">
<title>layer0_expert7_9&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23261.85,-4275.97C23258.88,-4274.92 23255.92,-4273.91 23253,-4272.95 23195.75,-4254.16 23130.55,-4238.11 23076.68,-4226.23"/>
<polygon fill="black" stroke="black" points="23077.28,-4222.78 23066.76,-4224.06 23075.78,-4229.62 23077.28,-4222.78"/>
</g>
<!-- layer0_expert7_10&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge313" class="edge">
<title>layer0_expert7_10&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23453.96,-4275.62C23450.96,-4274.67 23447.96,-4273.78 23445,-4272.95 23321.48,-4238.64 23175.08,-4220.73 23076.72,-4211.86"/>
<polygon fill="black" stroke="black" points="23077.03,-4208.37 23066.76,-4210.97 23076.41,-4215.34 23077.03,-4208.37"/>
</g>
<!-- layer0_expert7_11&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge314" class="edge">
<title>layer0_expert7_11&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23645.74,-4275.38C23642.81,-4274.51 23639.89,-4273.69 23637,-4272.95 23444.2,-4223.56 23211.71,-4209.33 23076.88,-4205.35"/>
<polygon fill="black" stroke="black" points="23076.63,-4201.84 23066.54,-4205.06 23076.44,-4208.84 23076.63,-4201.84"/>
</g>
<!-- layer0_expert7_12&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge315" class="edge">
<title>layer0_expert7_12&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23837.76,-4275.3C23834.82,-4274.45 23831.9,-4273.66 23829,-4272.95 23689.45,-4238.88 23277.46,-4217.25 23077.04,-4208.46"/>
<polygon fill="black" stroke="black" points="23076.92,-4204.95 23066.78,-4208.01 23076.61,-4211.94 23076.92,-4204.95"/>
</g>
<!-- layer0_expert7_13&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge316" class="edge">
<title>layer0_expert7_13&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M24029.77,-4275.24C24026.83,-4274.41 24023.9,-4273.64 24021,-4272.95 23844.28,-4231.16 23310.78,-4212.77 23076.91,-4206.56"/>
<polygon fill="black" stroke="black" points="23076.77,-4203.05 23066.68,-4206.29 23076.58,-4210.05 23076.77,-4203.05"/>
</g>
<!-- layer0_expert7_14&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge317" class="edge">
<title>layer0_expert7_14&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M24221.78,-4275.2C24218.84,-4274.38 24215.91,-4273.63 24213,-4272.95 23998.76,-4223.42 23341.56,-4209.07 23077.03,-4205.24"/>
<polygon fill="black" stroke="black" points="23076.69,-4201.73 23066.64,-4205.09 23076.59,-4208.73 23076.69,-4201.73"/>
</g>
<!-- layer0_expert7_15&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge318" class="edge">
<title>layer0_expert7_15&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M24413.79,-4275.17C24410.84,-4274.36 24407.91,-4273.62 24405,-4272.95 24152.87,-4215.63 23369.73,-4205.89 23076.95,-4204.27"/>
<polygon fill="black" stroke="black" points="23076.76,-4200.77 23066.75,-4204.21 23076.73,-4207.77 23076.76,-4200.77"/>
</g>
<!-- layer0_moe_agg_gpu7&#45;&gt;layer0_moe_allreduce -->
<g id="edge319" class="edge">
<title>layer0_moe_agg_gpu7&#45;&gt;layer0_moe_allreduce</title>
<path fill="none" stroke="black" d="M22863.37,-4200.66C21876.7,-4188.06 14006.54,-4087.62 12542.86,-4068.94"/>
<polygon fill="black" stroke="black" points="12542.8,-4065.44 12532.75,-4068.81 12542.71,-4072.44 12542.8,-4065.44"/>
</g>
<!-- layer0_output_gpu7 -->
<g id="node186" class="node">
<title>layer0_output_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="13348,-3960.95 13104,-3960.95 13104,-3892.95 13348,-3892.95 13348,-3960.95"/>
<text text-anchor="middle" x="13226" y="-3945.75" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU7</text>
<text text-anchor="middle" x="13226" y="-3930.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="13226" y="-3915.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="13226" y="-3900.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_qkv_gpu7 -->
<g id="node209" class="node">
<title>layer1_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="13325,-3856.95 13125,-3856.95 13125,-3758.95 13325,-3758.95 13325,-3856.95"/>
<text text-anchor="middle" x="13225" y="-3841.75" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU7</text>
<text text-anchor="middle" x="13225" y="-3826.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="13225" y="-3811.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="13225" y="-3796.75" font-family="Times,serif" font-size="14.00">Heads: 28&#45;31</text>
<text text-anchor="middle" x="13225" y="-3781.75" font-family="Times,serif" font-size="14.00">TP Slice: 7</text>
<text text-anchor="middle" x="13225" y="-3766.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_output_gpu7&#45;&gt;layer1_qkv_gpu7 -->
<g id="edge328" class="edge">
<title>layer0_output_gpu7&#45;&gt;layer1_qkv_gpu7</title>
<path fill="none" stroke="black" d="M13225.72,-3892.74C13225.65,-3884.78 13225.57,-3876.04 13225.5,-3867.3"/>
<polygon fill="black" stroke="black" points="13229,-3867.07 13225.41,-3857.1 13222,-3867.13 13229,-3867.07"/>
</g>
<!-- layer0_moe_allreduce&#45;&gt;layer0_output_gpu0 -->
<g id="edge47" class="edge">
<title>layer0_moe_allreduce&#45;&gt;layer0_output_gpu0</title>
<path fill="none" stroke="black" d="M12134.41,-4046.97C11976.93,-4030.28 11739.03,-4001.66 11524.17,-3961.11"/>
<polygon fill="black" stroke="black" points="11524.75,-3957.66 11514.28,-3959.23 11523.45,-3964.54 11524.75,-3957.66"/>
</g>
<!-- layer0_moe_allreduce&#45;&gt;layer0_output_gpu1 -->
<g id="edge86" class="edge">
<title>layer0_moe_allreduce&#45;&gt;layer0_output_gpu1</title>
<path fill="none" stroke="black" d="M12165.96,-4037.94C12062.96,-4018.71 11920.51,-3991.1 11786.38,-3961.23"/>
<polygon fill="black" stroke="black" points="11786.85,-3957.75 11776.33,-3958.99 11785.32,-3964.58 11786.85,-3957.75"/>
</g>
<!-- layer0_moe_allreduce&#45;&gt;layer0_output_gpu2 -->
<g id="edge125" class="edge">
<title>layer0_moe_allreduce&#45;&gt;layer0_output_gpu2</title>
<path fill="none" stroke="black" d="M12202.91,-4027.24C12146.5,-4007.72 12077.37,-3983.8 12021.11,-3964.33"/>
<polygon fill="black" stroke="black" points="12022.07,-3960.96 12011.48,-3960.99 12019.78,-3967.57 12022.07,-3960.96"/>
</g>
<!-- layer0_moe_allreduce&#45;&gt;layer0_output_gpu3 -->
<g id="edge164" class="edge">
<title>layer0_moe_allreduce&#45;&gt;layer0_output_gpu3</title>
<path fill="none" stroke="black" d="M12258.35,-4011.37C12244.62,-3997.12 12229.97,-3981.91 12217,-3968.44"/>
<polygon fill="black" stroke="black" points="12219.43,-3965.92 12209.97,-3961.15 12214.39,-3970.78 12219.43,-3965.92"/>
</g>
<!-- layer0_moe_allreduce&#45;&gt;layer0_output_gpu4 -->
<g id="edge203" class="edge">
<title>layer0_moe_allreduce&#45;&gt;layer0_output_gpu4</title>
<path fill="none" stroke="black" d="M12359.65,-4011.37C12373.38,-3997.12 12388.03,-3981.91 12401,-3968.44"/>
<polygon fill="black" stroke="black" points="12403.61,-3970.78 12408.03,-3961.15 12398.57,-3965.92 12403.61,-3970.78"/>
</g>
<!-- layer0_moe_allreduce&#45;&gt;layer0_output_gpu5 -->
<g id="edge242" class="edge">
<title>layer0_moe_allreduce&#45;&gt;layer0_output_gpu5</title>
<path fill="none" stroke="black" d="M12415.09,-4027.24C12471.5,-4007.72 12540.63,-3983.8 12596.89,-3964.33"/>
<polygon fill="black" stroke="black" points="12598.22,-3967.57 12606.52,-3960.99 12595.93,-3960.96 12598.22,-3967.57"/>
</g>
<!-- layer0_moe_allreduce&#45;&gt;layer0_output_gpu6 -->
<g id="edge281" class="edge">
<title>layer0_moe_allreduce&#45;&gt;layer0_output_gpu6</title>
<path fill="none" stroke="black" d="M12452.04,-4037.94C12555.04,-4018.71 12697.49,-3991.1 12831.62,-3961.23"/>
<polygon fill="black" stroke="black" points="12832.68,-3964.58 12841.67,-3958.99 12831.15,-3957.75 12832.68,-3964.58"/>
</g>
<!-- layer0_moe_allreduce&#45;&gt;layer0_output_gpu7 -->
<g id="edge320" class="edge">
<title>layer0_moe_allreduce&#45;&gt;layer0_output_gpu7</title>
<path fill="none" stroke="black" d="M12483.59,-4046.97C12641.07,-4030.28 12878.97,-4001.66 13093.83,-3961.11"/>
<polygon fill="black" stroke="black" points="13094.55,-3964.54 13103.72,-3959.23 13093.25,-3957.66 13094.55,-3964.54"/>
</g>
<!-- layer1_attn_gpu0 -->
<g id="node189" class="node">
<title>layer1_attn_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="11515.5,-3722.95 11272.5,-3722.95 11272.5,-3654.95 11515.5,-3654.95 11515.5,-3722.95"/>
<text text-anchor="middle" x="11394" y="-3707.75" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU0</text>
<text text-anchor="middle" x="11394" y="-3692.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11394" y="-3677.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11394" y="-3662.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_qkv_gpu0&#45;&gt;layer1_attn_gpu0 -->
<g id="edge329" class="edge">
<title>layer1_qkv_gpu0&#45;&gt;layer1_attn_gpu0</title>
<path fill="none" stroke="black" d="M11394,-3758.69C11394,-3750.28 11394,-3741.58 11394,-3733.31"/>
<polygon fill="black" stroke="black" points="11397.5,-3733.13 11394,-3723.13 11390.5,-3733.13 11397.5,-3733.13"/>
</g>
<!-- layer1_attn_proj_gpu0 -->
<g id="node190" class="node">
<title>layer1_attn_proj_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="11549,-3618.95 11349,-3618.95 11349,-3550.95 11549,-3550.95 11549,-3618.95"/>
<text text-anchor="middle" x="11449" y="-3603.75" font-family="Times,serif" font-size="14.00">L1_Attn_Projection_GPU0</text>
<text text-anchor="middle" x="11449" y="-3588.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11449" y="-3573.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11449" y="-3558.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_attn_gpu0&#45;&gt;layer1_attn_proj_gpu0 -->
<g id="edge330" class="edge">
<title>layer1_attn_gpu0&#45;&gt;layer1_attn_proj_gpu0</title>
<path fill="none" stroke="black" d="M11411.86,-3654.84C11416.42,-3646.37 11421.39,-3637.16 11426.16,-3628.31"/>
<polygon fill="black" stroke="black" points="11429.38,-3629.72 11431.04,-3619.25 11423.22,-3626.39 11429.38,-3629.72"/>
</g>
<!-- layer1_attn_allreduce -->
<g id="node212" class="node">
<title>layer1_attn_allreduce</title>
<polygon fill="lightcoral" stroke="black" points="12298,-3514.95 12061,-3446.95 12298,-3378.95 12535,-3446.95 12298,-3514.95"/>
<text text-anchor="middle" x="12298" y="-3465.75" font-family="Times,serif" font-size="14.00">L1_Attention_All&#45;Reduce</text>
<text text-anchor="middle" x="12298" y="-3450.75" font-family="Times,serif" font-size="14.00">Input: 8×[1024,2048,512]</text>
<text text-anchor="middle" x="12298" y="-3435.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12298" y="-3420.75" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce across GPUs 0&#45;7</text>
</g>
<!-- layer1_attn_proj_gpu0&#45;&gt;layer1_attn_allreduce -->
<g id="edge331" class="edge">
<title>layer1_attn_proj_gpu0&#45;&gt;layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M11549.18,-3557.39C11559.22,-3555.07 11569.29,-3552.88 11579,-3550.95 11762.2,-3514.69 11974.06,-3485.91 12120.11,-3468.09"/>
<polygon fill="black" stroke="black" points="12120.57,-3471.56 12130.07,-3466.88 12119.72,-3464.62 12120.57,-3471.56"/>
</g>
<!-- layer1_attn_gpu1 -->
<g id="node192" class="node">
<title>layer1_attn_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11776.5,-3722.95 11533.5,-3722.95 11533.5,-3654.95 11776.5,-3654.95 11776.5,-3722.95"/>
<text text-anchor="middle" x="11655" y="-3707.75" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU1</text>
<text text-anchor="middle" x="11655" y="-3692.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11655" y="-3677.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11655" y="-3662.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_qkv_gpu1&#45;&gt;layer1_attn_gpu1 -->
<g id="edge368" class="edge">
<title>layer1_qkv_gpu1&#45;&gt;layer1_attn_gpu1</title>
<path fill="none" stroke="black" d="M11654.41,-3758.69C11654.48,-3750.28 11654.56,-3741.58 11654.63,-3733.31"/>
<polygon fill="black" stroke="black" points="11658.13,-3733.16 11654.72,-3723.13 11651.13,-3733.1 11658.13,-3733.16"/>
</g>
<!-- layer1_attn_proj_gpu1 -->
<g id="node193" class="node">
<title>layer1_attn_proj_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11788,-3618.95 11588,-3618.95 11588,-3550.95 11788,-3550.95 11788,-3618.95"/>
<text text-anchor="middle" x="11688" y="-3603.75" font-family="Times,serif" font-size="14.00">L1_Attn_Projection_GPU1</text>
<text text-anchor="middle" x="11688" y="-3588.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11688" y="-3573.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11688" y="-3558.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_attn_gpu1&#45;&gt;layer1_attn_proj_gpu1 -->
<g id="edge369" class="edge">
<title>layer1_attn_gpu1&#45;&gt;layer1_attn_proj_gpu1</title>
<path fill="none" stroke="black" d="M11665.71,-3654.84C11668.39,-3646.55 11671.31,-3637.55 11674.12,-3628.86"/>
<polygon fill="black" stroke="black" points="11677.48,-3629.84 11677.23,-3619.25 11670.82,-3627.69 11677.48,-3629.84"/>
</g>
<!-- layer1_attn_proj_gpu1&#45;&gt;layer1_attn_allreduce -->
<g id="edge370" class="edge">
<title>layer1_attn_proj_gpu1&#45;&gt;layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M11788.05,-3561.65C11888.38,-3539.28 12043.79,-3504.63 12156.68,-3479.46"/>
<polygon fill="black" stroke="black" points="12157.45,-3482.88 12166.45,-3477.28 12155.92,-3476.04 12157.45,-3482.88"/>
</g>
<!-- layer1_attn_gpu2 -->
<g id="node195" class="node">
<title>layer1_attn_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="12038.5,-3722.95 11795.5,-3722.95 11795.5,-3654.95 12038.5,-3654.95 12038.5,-3722.95"/>
<text text-anchor="middle" x="11917" y="-3707.75" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU2</text>
<text text-anchor="middle" x="11917" y="-3692.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11917" y="-3677.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11917" y="-3662.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_qkv_gpu2&#45;&gt;layer1_attn_gpu2 -->
<g id="edge407" class="edge">
<title>layer1_qkv_gpu2&#45;&gt;layer1_attn_gpu2</title>
<path fill="none" stroke="black" d="M11917,-3758.69C11917,-3750.28 11917,-3741.58 11917,-3733.31"/>
<polygon fill="black" stroke="black" points="11920.5,-3733.13 11917,-3723.13 11913.5,-3733.13 11920.5,-3733.13"/>
</g>
<!-- layer1_attn_proj_gpu2 -->
<g id="node196" class="node">
<title>layer1_attn_proj_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="12050,-3618.95 11850,-3618.95 11850,-3550.95 12050,-3550.95 12050,-3618.95"/>
<text text-anchor="middle" x="11950" y="-3603.75" font-family="Times,serif" font-size="14.00">L1_Attn_Projection_GPU2</text>
<text text-anchor="middle" x="11950" y="-3588.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11950" y="-3573.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11950" y="-3558.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_attn_gpu2&#45;&gt;layer1_attn_proj_gpu2 -->
<g id="edge408" class="edge">
<title>layer1_attn_gpu2&#45;&gt;layer1_attn_proj_gpu2</title>
<path fill="none" stroke="black" d="M11927.71,-3654.84C11930.39,-3646.55 11933.31,-3637.55 11936.12,-3628.86"/>
<polygon fill="black" stroke="black" points="11939.48,-3629.84 11939.23,-3619.25 11932.82,-3627.69 11939.48,-3629.84"/>
</g>
<!-- layer1_attn_proj_gpu2&#45;&gt;layer1_attn_allreduce -->
<g id="edge409" class="edge">
<title>layer1_attn_proj_gpu2&#45;&gt;layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M12034.69,-3550.86C12081.28,-3532.65 12139.59,-3509.86 12189.49,-3490.36"/>
<polygon fill="black" stroke="black" points="12190.98,-3493.53 12199.02,-3486.63 12188.44,-3487.01 12190.98,-3493.53"/>
</g>
<!-- layer1_attn_gpu3 -->
<g id="node198" class="node">
<title>layer1_attn_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="12299.5,-3722.95 12056.5,-3722.95 12056.5,-3654.95 12299.5,-3654.95 12299.5,-3722.95"/>
<text text-anchor="middle" x="12178" y="-3707.75" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU3</text>
<text text-anchor="middle" x="12178" y="-3692.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12178" y="-3677.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12178" y="-3662.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_qkv_gpu3&#45;&gt;layer1_attn_gpu3 -->
<g id="edge446" class="edge">
<title>layer1_qkv_gpu3&#45;&gt;layer1_attn_gpu3</title>
<path fill="none" stroke="black" d="M12178,-3758.69C12178,-3750.28 12178,-3741.58 12178,-3733.31"/>
<polygon fill="black" stroke="black" points="12181.5,-3733.13 12178,-3723.13 12174.5,-3733.13 12181.5,-3733.13"/>
</g>
<!-- layer1_attn_proj_gpu3 -->
<g id="node199" class="node">
<title>layer1_attn_proj_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="12289,-3618.95 12089,-3618.95 12089,-3550.95 12289,-3550.95 12289,-3618.95"/>
<text text-anchor="middle" x="12189" y="-3603.75" font-family="Times,serif" font-size="14.00">L1_Attn_Projection_GPU3</text>
<text text-anchor="middle" x="12189" y="-3588.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12189" y="-3573.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12189" y="-3558.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_attn_gpu3&#45;&gt;layer1_attn_proj_gpu3 -->
<g id="edge447" class="edge">
<title>layer1_attn_gpu3&#45;&gt;layer1_attn_proj_gpu3</title>
<path fill="none" stroke="black" d="M12181.57,-3654.84C12182.45,-3646.73 12183.39,-3637.94 12184.31,-3629.43"/>
<polygon fill="black" stroke="black" points="12187.82,-3629.57 12185.41,-3619.25 12180.86,-3628.82 12187.82,-3629.57"/>
</g>
<!-- layer1_attn_proj_gpu3&#45;&gt;layer1_attn_allreduce -->
<g id="edge448" class="edge">
<title>layer1_attn_proj_gpu3&#45;&gt;layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M12215.66,-3550.68C12225.36,-3538.59 12236.66,-3524.49 12247.73,-3510.68"/>
<polygon fill="black" stroke="black" points="12250.68,-3512.59 12254.2,-3502.6 12245.22,-3508.22 12250.68,-3512.59"/>
</g>
<!-- layer1_attn_gpu4 -->
<g id="node201" class="node">
<title>layer1_attn_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="12560.5,-3722.95 12317.5,-3722.95 12317.5,-3654.95 12560.5,-3654.95 12560.5,-3722.95"/>
<text text-anchor="middle" x="12439" y="-3707.75" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU4</text>
<text text-anchor="middle" x="12439" y="-3692.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12439" y="-3677.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12439" y="-3662.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_qkv_gpu4&#45;&gt;layer1_attn_gpu4 -->
<g id="edge485" class="edge">
<title>layer1_qkv_gpu4&#45;&gt;layer1_attn_gpu4</title>
<path fill="none" stroke="black" d="M12439,-3758.69C12439,-3750.28 12439,-3741.58 12439,-3733.31"/>
<polygon fill="black" stroke="black" points="12442.5,-3733.13 12439,-3723.13 12435.5,-3733.13 12442.5,-3733.13"/>
</g>
<!-- layer1_attn_proj_gpu4 -->
<g id="node202" class="node">
<title>layer1_attn_proj_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="12528,-3618.95 12328,-3618.95 12328,-3550.95 12528,-3550.95 12528,-3618.95"/>
<text text-anchor="middle" x="12428" y="-3603.75" font-family="Times,serif" font-size="14.00">L1_Attn_Projection_GPU4</text>
<text text-anchor="middle" x="12428" y="-3588.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12428" y="-3573.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12428" y="-3558.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_attn_gpu4&#45;&gt;layer1_attn_proj_gpu4 -->
<g id="edge486" class="edge">
<title>layer1_attn_gpu4&#45;&gt;layer1_attn_proj_gpu4</title>
<path fill="none" stroke="black" d="M12435.43,-3654.84C12434.55,-3646.73 12433.61,-3637.94 12432.69,-3629.43"/>
<polygon fill="black" stroke="black" points="12436.14,-3628.82 12431.59,-3619.25 12429.18,-3629.57 12436.14,-3628.82"/>
</g>
<!-- layer1_attn_proj_gpu4&#45;&gt;layer1_attn_allreduce -->
<g id="edge487" class="edge">
<title>layer1_attn_proj_gpu4&#45;&gt;layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M12396.2,-3550.68C12383.97,-3537.89 12369.6,-3522.86 12355.69,-3508.3"/>
<polygon fill="black" stroke="black" points="12357.91,-3505.56 12348.47,-3500.75 12352.85,-3510.4 12357.91,-3505.56"/>
</g>
<!-- layer1_attn_gpu5 -->
<g id="node204" class="node">
<title>layer1_attn_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12822.5,-3722.95 12579.5,-3722.95 12579.5,-3654.95 12822.5,-3654.95 12822.5,-3722.95"/>
<text text-anchor="middle" x="12701" y="-3707.75" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU5</text>
<text text-anchor="middle" x="12701" y="-3692.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12701" y="-3677.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12701" y="-3662.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_qkv_gpu5&#45;&gt;layer1_attn_gpu5 -->
<g id="edge524" class="edge">
<title>layer1_qkv_gpu5&#45;&gt;layer1_attn_gpu5</title>
<path fill="none" stroke="black" d="M12701.59,-3758.69C12701.52,-3750.28 12701.44,-3741.58 12701.37,-3733.31"/>
<polygon fill="black" stroke="black" points="12704.87,-3733.1 12701.28,-3723.13 12697.87,-3733.16 12704.87,-3733.1"/>
</g>
<!-- layer1_attn_proj_gpu5 -->
<g id="node205" class="node">
<title>layer1_attn_proj_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12778,-3618.95 12578,-3618.95 12578,-3550.95 12778,-3550.95 12778,-3618.95"/>
<text text-anchor="middle" x="12678" y="-3603.75" font-family="Times,serif" font-size="14.00">L1_Attn_Projection_GPU5</text>
<text text-anchor="middle" x="12678" y="-3588.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12678" y="-3573.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12678" y="-3558.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_attn_gpu5&#45;&gt;layer1_attn_proj_gpu5 -->
<g id="edge525" class="edge">
<title>layer1_attn_gpu5&#45;&gt;layer1_attn_proj_gpu5</title>
<path fill="none" stroke="black" d="M12693.53,-3654.84C12691.68,-3646.64 12689.68,-3637.74 12687.74,-3629.15"/>
<polygon fill="black" stroke="black" points="12691.12,-3628.24 12685.51,-3619.25 12684.29,-3629.78 12691.12,-3628.24"/>
</g>
<!-- layer1_attn_proj_gpu5&#45;&gt;layer1_attn_allreduce -->
<g id="edge526" class="edge">
<title>layer1_attn_proj_gpu5&#45;&gt;layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M12585.53,-3550.86C12533.09,-3532.09 12467.05,-3508.46 12411.5,-3488.57"/>
<polygon fill="black" stroke="black" points="12412.56,-3485.24 12401.96,-3485.16 12410.2,-3491.83 12412.56,-3485.24"/>
</g>
<!-- layer1_attn_gpu6 -->
<g id="node207" class="node">
<title>layer1_attn_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="13084.5,-3722.95 12841.5,-3722.95 12841.5,-3654.95 13084.5,-3654.95 13084.5,-3722.95"/>
<text text-anchor="middle" x="12963" y="-3707.75" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU6</text>
<text text-anchor="middle" x="12963" y="-3692.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12963" y="-3677.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12963" y="-3662.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_qkv_gpu6&#45;&gt;layer1_attn_gpu6 -->
<g id="edge563" class="edge">
<title>layer1_qkv_gpu6&#45;&gt;layer1_attn_gpu6</title>
<path fill="none" stroke="black" d="M12963,-3758.69C12963,-3750.28 12963,-3741.58 12963,-3733.31"/>
<polygon fill="black" stroke="black" points="12966.5,-3733.13 12963,-3723.13 12959.5,-3733.13 12966.5,-3733.13"/>
</g>
<!-- layer1_attn_proj_gpu6 -->
<g id="node208" class="node">
<title>layer1_attn_proj_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="13034,-3618.95 12834,-3618.95 12834,-3550.95 13034,-3550.95 13034,-3618.95"/>
<text text-anchor="middle" x="12934" y="-3603.75" font-family="Times,serif" font-size="14.00">L1_Attn_Projection_GPU6</text>
<text text-anchor="middle" x="12934" y="-3588.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12934" y="-3573.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12934" y="-3558.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_attn_gpu6&#45;&gt;layer1_attn_proj_gpu6 -->
<g id="edge564" class="edge">
<title>layer1_attn_gpu6&#45;&gt;layer1_attn_proj_gpu6</title>
<path fill="none" stroke="black" d="M12953.58,-3654.84C12951.25,-3646.64 12948.72,-3637.74 12946.28,-3629.15"/>
<polygon fill="black" stroke="black" points="12949.57,-3627.91 12943.47,-3619.25 12942.84,-3629.83 12949.57,-3627.91"/>
</g>
<!-- layer1_attn_proj_gpu6&#45;&gt;layer1_attn_allreduce -->
<g id="edge565" class="edge">
<title>layer1_attn_proj_gpu6&#45;&gt;layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M12833.61,-3561.23C12818.02,-3557.76 12802.08,-3554.23 12787,-3550.95 12671.74,-3525.88 12540.99,-3498.39 12443.7,-3478.12"/>
<polygon fill="black" stroke="black" points="12444.3,-3474.67 12433.8,-3476.05 12442.88,-3481.52 12444.3,-3474.67"/>
</g>
<!-- layer1_attn_gpu7 -->
<g id="node210" class="node">
<title>layer1_attn_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="13346.5,-3722.95 13103.5,-3722.95 13103.5,-3654.95 13346.5,-3654.95 13346.5,-3722.95"/>
<text text-anchor="middle" x="13225" y="-3707.75" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU7</text>
<text text-anchor="middle" x="13225" y="-3692.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="13225" y="-3677.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="13225" y="-3662.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_qkv_gpu7&#45;&gt;layer1_attn_gpu7 -->
<g id="edge602" class="edge">
<title>layer1_qkv_gpu7&#45;&gt;layer1_attn_gpu7</title>
<path fill="none" stroke="black" d="M13225,-3758.69C13225,-3750.28 13225,-3741.58 13225,-3733.31"/>
<polygon fill="black" stroke="black" points="13228.5,-3733.13 13225,-3723.13 13221.5,-3733.13 13228.5,-3733.13"/>
</g>
<!-- layer1_attn_proj_gpu7 -->
<g id="node211" class="node">
<title>layer1_attn_proj_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="13292,-3618.95 13092,-3618.95 13092,-3550.95 13292,-3550.95 13292,-3618.95"/>
<text text-anchor="middle" x="13192" y="-3603.75" font-family="Times,serif" font-size="14.00">L1_Attn_Projection_GPU7</text>
<text text-anchor="middle" x="13192" y="-3588.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="13192" y="-3573.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="13192" y="-3558.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_attn_gpu7&#45;&gt;layer1_attn_proj_gpu7 -->
<g id="edge603" class="edge">
<title>layer1_attn_gpu7&#45;&gt;layer1_attn_proj_gpu7</title>
<path fill="none" stroke="black" d="M13214.29,-3654.84C13211.61,-3646.55 13208.69,-3637.55 13205.88,-3628.86"/>
<polygon fill="black" stroke="black" points="13209.18,-3627.69 13202.77,-3619.25 13202.52,-3629.84 13209.18,-3627.69"/>
</g>
<!-- layer1_attn_proj_gpu7&#45;&gt;layer1_attn_allreduce -->
<g id="edge604" class="edge">
<title>layer1_attn_proj_gpu7&#45;&gt;layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M13091.64,-3560.57C13075.42,-3557.12 13058.78,-3553.79 13043,-3550.95 12849.85,-3516.27 12626.7,-3486.81 12475.36,-3468.39"/>
<polygon fill="black" stroke="black" points="12475.39,-3464.87 12465.05,-3467.14 12474.55,-3471.82 12475.39,-3464.87"/>
</g>
<!-- layer1_attn_norm_gpu0 -->
<g id="node213" class="node">
<title>layer1_attn_norm_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="5277,-3342.95 5033,-3342.95 5033,-3274.95 5277,-3274.95 5277,-3342.95"/>
<text text-anchor="middle" x="5155" y="-3327.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU0</text>
<text text-anchor="middle" x="5155" y="-3312.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="5155" y="-3297.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="5155" y="-3282.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer1_attn_allreduce&#45;&gt;layer1_attn_norm_gpu0 -->
<g id="edge332" class="edge">
<title>layer1_attn_allreduce&#45;&gt;layer1_attn_norm_gpu0</title>
<path fill="none" stroke="black" d="M12077.6,-3442.15C11325.02,-3429.12 8787.48,-3384.73 6691,-3342.95 6171.66,-3332.6 5553.58,-3318.9 5287.53,-3312.94"/>
<polygon fill="black" stroke="black" points="5287.52,-3309.44 5277.45,-3312.71 5287.37,-3316.44 5287.52,-3309.44"/>
</g>
<!-- layer1_attn_norm_gpu1 -->
<g id="node214" class="node">
<title>layer1_attn_norm_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="6944,-3342.95 6700,-3342.95 6700,-3274.95 6944,-3274.95 6944,-3342.95"/>
<text text-anchor="middle" x="6822" y="-3327.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU1</text>
<text text-anchor="middle" x="6822" y="-3312.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="6822" y="-3297.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="6822" y="-3282.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer1_attn_allreduce&#45;&gt;layer1_attn_norm_gpu1 -->
<g id="edge371" class="edge">
<title>layer1_attn_allreduce&#45;&gt;layer1_attn_norm_gpu1</title>
<path fill="none" stroke="black" d="M12082.91,-3440.61C11176.34,-3418.1 7680.18,-3331.27 6954.4,-3313.24"/>
<polygon fill="black" stroke="black" points="6954.26,-3309.74 6944.17,-3312.99 6954.08,-3316.73 6954.26,-3309.74"/>
</g>
<!-- layer1_attn_norm_gpu2 -->
<g id="node215" class="node">
<title>layer1_attn_norm_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="9968,-3342.95 9724,-3342.95 9724,-3274.95 9968,-3274.95 9968,-3342.95"/>
<text text-anchor="middle" x="9846" y="-3327.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU2</text>
<text text-anchor="middle" x="9846" y="-3312.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="9846" y="-3297.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="9846" y="-3282.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer1_attn_allreduce&#45;&gt;layer1_attn_norm_gpu2 -->
<g id="edge410" class="edge">
<title>layer1_attn_allreduce&#45;&gt;layer1_attn_norm_gpu2</title>
<path fill="none" stroke="black" d="M12102.26,-3435.1C11620.22,-3408.36 10385.47,-3339.87 9978.39,-3317.3"/>
<polygon fill="black" stroke="black" points="9978.52,-3313.8 9968.34,-3316.74 9978.13,-3320.79 9978.52,-3313.8"/>
</g>
<!-- layer1_attn_norm_gpu3 -->
<g id="node216" class="node">
<title>layer1_attn_norm_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="11635,-3342.95 11391,-3342.95 11391,-3274.95 11635,-3274.95 11635,-3342.95"/>
<text text-anchor="middle" x="11513" y="-3327.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU3</text>
<text text-anchor="middle" x="11513" y="-3312.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11513" y="-3297.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11513" y="-3282.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer1_attn_allreduce&#45;&gt;layer1_attn_norm_gpu3 -->
<g id="edge449" class="edge">
<title>layer1_attn_allreduce&#45;&gt;layer1_attn_norm_gpu3</title>
<path fill="none" stroke="black" d="M12152.19,-3420.69C12006.81,-3395.5 11785.5,-3357.16 11645.13,-3332.84"/>
<polygon fill="black" stroke="black" points="11645.61,-3329.38 11635.16,-3331.12 11644.42,-3336.27 11645.61,-3329.38"/>
</g>
<!-- layer1_attn_norm_gpu4 -->
<g id="node217" class="node">
<title>layer1_attn_norm_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13206,-3342.95 12962,-3342.95 12962,-3274.95 13206,-3274.95 13206,-3342.95"/>
<text text-anchor="middle" x="13084" y="-3327.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU4</text>
<text text-anchor="middle" x="13084" y="-3312.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="13084" y="-3297.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="13084" y="-3282.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer1_attn_allreduce&#45;&gt;layer1_attn_norm_gpu4 -->
<g id="edge488" class="edge">
<title>layer1_attn_allreduce&#45;&gt;layer1_attn_norm_gpu4</title>
<path fill="none" stroke="black" d="M12444,-3420.69C12589.67,-3395.49 12811.49,-3357.11 12952.02,-3332.79"/>
<polygon fill="black" stroke="black" points="12952.74,-3336.22 12962,-3331.06 12951.55,-3329.32 12952.74,-3336.22"/>
</g>
<!-- layer1_attn_norm_gpu5 -->
<g id="node218" class="node">
<title>layer1_attn_norm_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="15527,-3342.95 15283,-3342.95 15283,-3274.95 15527,-3274.95 15527,-3342.95"/>
<text text-anchor="middle" x="15405" y="-3327.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU5</text>
<text text-anchor="middle" x="15405" y="-3312.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="15405" y="-3297.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="15405" y="-3282.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer1_attn_allreduce&#45;&gt;layer1_attn_norm_gpu5 -->
<g id="edge527" class="edge">
<title>layer1_attn_allreduce&#45;&gt;layer1_attn_norm_gpu5</title>
<path fill="none" stroke="black" d="M12500.66,-3437.08C13088.81,-3411.34 14785.15,-3337.09 15272.57,-3315.75"/>
<polygon fill="black" stroke="black" points="15272.98,-3319.24 15282.81,-3315.3 15272.67,-3312.24 15272.98,-3319.24"/>
</g>
<!-- layer1_attn_norm_gpu6 -->
<g id="node219" class="node">
<title>layer1_attn_norm_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="18224,-3342.95 17980,-3342.95 17980,-3274.95 18224,-3274.95 18224,-3342.95"/>
<text text-anchor="middle" x="18102" y="-3327.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU6</text>
<text text-anchor="middle" x="18102" y="-3312.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="18102" y="-3297.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="18102" y="-3282.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer1_attn_allreduce&#45;&gt;layer1_attn_norm_gpu6 -->
<g id="edge566" class="edge">
<title>layer1_attn_allreduce&#45;&gt;layer1_attn_norm_gpu6</title>
<path fill="none" stroke="black" d="M12514.06,-3440.89C13459.19,-3418.74 17216.18,-3330.71 17969.92,-3313.05"/>
<polygon fill="black" stroke="black" points="17970.08,-3316.55 17979.99,-3312.81 17969.91,-3309.55 17970.08,-3316.55"/>
</g>
<!-- layer1_attn_norm_gpu7 -->
<g id="node220" class="node">
<title>layer1_attn_norm_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="21108,-3342.95 20864,-3342.95 20864,-3274.95 21108,-3274.95 21108,-3342.95"/>
<text text-anchor="middle" x="20986" y="-3327.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU7</text>
<text text-anchor="middle" x="20986" y="-3312.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="20986" y="-3297.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="20986" y="-3282.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer1_attn_allreduce&#45;&gt;layer1_attn_norm_gpu7 -->
<g id="edge605" class="edge">
<title>layer1_attn_allreduce&#45;&gt;layer1_attn_norm_gpu7</title>
<path fill="none" stroke="black" d="M12519.57,-3442.48C13765.18,-3422.99 19874.65,-3327.35 20853.57,-3312.03"/>
<polygon fill="black" stroke="black" points="20853.86,-3315.52 20863.81,-3311.87 20853.75,-3308.52 20853.86,-3315.52"/>
</g>
<!-- layer1_gate_gpu0 -->
<g id="node221" class="node">
<title>layer1_gate_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1765,-3238.95 1521,-3238.95 1521,-3155.95 1765,-3155.95 1765,-3238.95"/>
<text text-anchor="middle" x="1643" y="-3223.75" font-family="Times,serif" font-size="14.00">L1_Gate_GPU0</text>
<text text-anchor="middle" x="1643" y="-3208.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1643" y="-3193.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="1643" y="-3178.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="1643" y="-3163.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_attn_norm_gpu0&#45;&gt;layer1_gate_gpu0 -->
<g id="edge333" class="edge">
<title>layer1_attn_norm_gpu0&#45;&gt;layer1_gate_gpu0</title>
<path fill="none" stroke="black" d="M5032.83,-3304.14C4494.17,-3287.35 2333.33,-3219.98 1775.14,-3202.57"/>
<polygon fill="black" stroke="black" points="1775.14,-3199.07 1765.03,-3202.26 1774.92,-3206.07 1775.14,-3199.07"/>
</g>
<!-- layer1_gate_gpu1 -->
<g id="node240" class="node">
<title>layer1_gate_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="4837,-3238.95 4593,-3238.95 4593,-3155.95 4837,-3155.95 4837,-3238.95"/>
<text text-anchor="middle" x="4715" y="-3223.75" font-family="Times,serif" font-size="14.00">L1_Gate_GPU1</text>
<text text-anchor="middle" x="4715" y="-3208.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="4715" y="-3193.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="4715" y="-3178.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="4715" y="-3163.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_attn_norm_gpu1&#45;&gt;layer1_gate_gpu1 -->
<g id="edge372" class="edge">
<title>layer1_attn_norm_gpu1&#45;&gt;layer1_gate_gpu1</title>
<path fill="none" stroke="black" d="M6700,-3301.61C6331.06,-3282.44 5229.12,-3225.17 4847.12,-3205.32"/>
<polygon fill="black" stroke="black" points="4847.3,-3201.82 4837.13,-3204.8 4846.94,-3208.81 4847.3,-3201.82"/>
</g>
<!-- layer1_gate_gpu2 -->
<g id="node259" class="node">
<title>layer1_gate_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="7909,-3238.95 7665,-3238.95 7665,-3155.95 7909,-3155.95 7909,-3238.95"/>
<text text-anchor="middle" x="7787" y="-3223.75" font-family="Times,serif" font-size="14.00">L1_Gate_GPU2</text>
<text text-anchor="middle" x="7787" y="-3208.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="7787" y="-3193.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="7787" y="-3178.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="7787" y="-3163.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_attn_norm_gpu2&#45;&gt;layer1_gate_gpu2 -->
<g id="edge411" class="edge">
<title>layer1_attn_norm_gpu2&#45;&gt;layer1_gate_gpu2</title>
<path fill="none" stroke="black" d="M9723.75,-3301.45C9361.23,-3282.17 8294.13,-3225.42 7919.14,-3205.48"/>
<polygon fill="black" stroke="black" points="7919.23,-3201.98 7909.06,-3204.94 7918.86,-3208.97 7919.23,-3201.98"/>
</g>
<!-- layer1_gate_gpu3 -->
<g id="node278" class="node">
<title>layer1_gate_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="10981,-3238.95 10737,-3238.95 10737,-3155.95 10981,-3155.95 10981,-3238.95"/>
<text text-anchor="middle" x="10859" y="-3223.75" font-family="Times,serif" font-size="14.00">L1_Gate_GPU3</text>
<text text-anchor="middle" x="10859" y="-3208.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="10859" y="-3193.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="10859" y="-3178.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="10859" y="-3163.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_attn_norm_gpu3&#45;&gt;layer1_gate_gpu3 -->
<g id="edge450" class="edge">
<title>layer1_attn_norm_gpu3&#45;&gt;layer1_gate_gpu3</title>
<path fill="none" stroke="black" d="M11390.75,-3287.49C11277.06,-3268.45 11108.09,-3240.16 10991.28,-3220.6"/>
<polygon fill="black" stroke="black" points="10991.64,-3217.11 10981.2,-3218.91 10990.48,-3224.02 10991.64,-3217.11"/>
</g>
<!-- layer1_gate_gpu4 -->
<g id="node297" class="node">
<title>layer1_gate_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13861,-3238.95 13617,-3238.95 13617,-3155.95 13861,-3155.95 13861,-3238.95"/>
<text text-anchor="middle" x="13739" y="-3223.75" font-family="Times,serif" font-size="14.00">L1_Gate_GPU4</text>
<text text-anchor="middle" x="13739" y="-3208.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="13739" y="-3193.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="13739" y="-3178.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="13739" y="-3163.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_attn_norm_gpu4&#45;&gt;layer1_gate_gpu4 -->
<g id="edge489" class="edge">
<title>layer1_attn_norm_gpu4&#45;&gt;layer1_gate_gpu4</title>
<path fill="none" stroke="black" d="M13206.05,-3287.55C13319.96,-3268.51 13489.51,-3240.16 13606.64,-3220.58"/>
<polygon fill="black" stroke="black" points="13607.46,-3223.99 13616.74,-3218.89 13606.3,-3217.09 13607.46,-3223.99"/>
</g>
<!-- layer1_gate_gpu5 -->
<g id="node316" class="node">
<title>layer1_gate_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="16933,-3238.95 16689,-3238.95 16689,-3155.95 16933,-3155.95 16933,-3238.95"/>
<text text-anchor="middle" x="16811" y="-3223.75" font-family="Times,serif" font-size="14.00">L1_Gate_GPU5</text>
<text text-anchor="middle" x="16811" y="-3208.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="16811" y="-3193.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="16811" y="-3178.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="16811" y="-3163.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_attn_norm_gpu5&#45;&gt;layer1_gate_gpu5 -->
<g id="edge528" class="edge">
<title>layer1_attn_norm_gpu5&#45;&gt;layer1_gate_gpu5</title>
<path fill="none" stroke="black" d="M15527.01,-3298.45C15789.67,-3277.99 16406.85,-3229.93 16678.59,-3208.77"/>
<polygon fill="black" stroke="black" points="16679.2,-3212.23 16688.9,-3207.96 16678.66,-3205.25 16679.2,-3212.23"/>
</g>
<!-- layer1_gate_gpu6 -->
<g id="node335" class="node">
<title>layer1_gate_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="20005,-3238.95 19761,-3238.95 19761,-3155.95 20005,-3155.95 20005,-3238.95"/>
<text text-anchor="middle" x="19883" y="-3223.75" font-family="Times,serif" font-size="14.00">L1_Gate_GPU6</text>
<text text-anchor="middle" x="19883" y="-3208.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="19883" y="-3193.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="19883" y="-3178.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="19883" y="-3163.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_attn_norm_gpu6&#45;&gt;layer1_gate_gpu6 -->
<g id="edge567" class="edge">
<title>layer1_attn_norm_gpu6&#45;&gt;layer1_gate_gpu6</title>
<path fill="none" stroke="black" d="M18224.06,-3300.45C18546.17,-3280.64 19417.18,-3227.09 19750.65,-3206.59"/>
<polygon fill="black" stroke="black" points="19751.07,-3210.07 19760.84,-3205.96 19750.65,-3203.08 19751.07,-3210.07"/>
</g>
<!-- layer1_gate_gpu7 -->
<g id="node354" class="node">
<title>layer1_gate_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="23077,-3238.95 22833,-3238.95 22833,-3155.95 23077,-3155.95 23077,-3238.95"/>
<text text-anchor="middle" x="22955" y="-3223.75" font-family="Times,serif" font-size="14.00">L1_Gate_GPU7</text>
<text text-anchor="middle" x="22955" y="-3208.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="22955" y="-3193.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="22955" y="-3178.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="22955" y="-3163.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_attn_norm_gpu7&#45;&gt;layer1_gate_gpu7 -->
<g id="edge606" class="edge">
<title>layer1_attn_norm_gpu7&#45;&gt;layer1_gate_gpu7</title>
<path fill="none" stroke="black" d="M21108.05,-3301.17C21457.71,-3281.72 22461.14,-3225.92 22822.94,-3205.8"/>
<polygon fill="black" stroke="black" points="22823.15,-3209.29 22832.94,-3205.24 22822.76,-3202.3 22823.15,-3209.29"/>
</g>
<!-- layer1_expert0_0 -->
<g id="node222" class="node">
<title>layer1_expert0_0</title>
<polygon fill="lightgreen" stroke="black" points="194,-3119.95 20,-3119.95 20,-3036.95 194,-3036.95 194,-3119.95"/>
<text text-anchor="middle" x="107" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU0</text>
<text text-anchor="middle" x="107" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="107" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="107" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="107" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_0 -->
<g id="edge334" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1520.8,-3195.37C1224.21,-3191.87 471.59,-3177.65 204.29,-3119.96"/>
<polygon fill="black" stroke="black" points="204.74,-3116.48 194.22,-3117.71 203.22,-3123.31 204.74,-3116.48"/>
</g>
<!-- layer1_expert0_1 -->
<g id="node223" class="node">
<title>layer1_expert0_1</title>
<polygon fill="lightgreen" stroke="black" points="386,-3119.95 212,-3119.95 212,-3036.95 386,-3036.95 386,-3119.95"/>
<text text-anchor="middle" x="299" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU0</text>
<text text-anchor="middle" x="299" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="299" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="299" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="299" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_1 -->
<g id="edge335" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1520.82,-3194.19C1253.95,-3188.43 625.25,-3170.07 396.17,-3119.94"/>
<polygon fill="black" stroke="black" points="396.75,-3116.48 386.22,-3117.68 395.2,-3123.31 396.75,-3116.48"/>
</g>
<!-- layer1_expert0_2 -->
<g id="node224" class="node">
<title>layer1_expert0_2</title>
<polygon fill="lightgreen" stroke="black" points="578,-3119.95 404,-3119.95 404,-3036.95 578,-3036.95 578,-3119.95"/>
<text text-anchor="middle" x="491" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU0</text>
<text text-anchor="middle" x="491" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="491" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="491" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="491" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_2 -->
<g id="edge336" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1520.92,-3192.61C1286.28,-3184.41 779.38,-3162.58 588.19,-3119.95"/>
<polygon fill="black" stroke="black" points="588.77,-3116.49 578.23,-3117.64 587.19,-3123.31 588.77,-3116.49"/>
</g>
<!-- layer1_expert0_3 -->
<g id="node225" class="node">
<title>layer1_expert0_3</title>
<polygon fill="lightgreen" stroke="black" points="770,-3119.95 596,-3119.95 596,-3036.95 770,-3036.95 770,-3119.95"/>
<text text-anchor="middle" x="683" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU0</text>
<text text-anchor="middle" x="683" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="683" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="683" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="683" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_3 -->
<g id="edge337" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1520.77,-3190.32C1321.25,-3179.53 933.31,-3155.15 780,-3119.92"/>
<polygon fill="black" stroke="black" points="780.79,-3116.5 770.25,-3117.58 779.16,-3123.31 780.79,-3116.5"/>
</g>
<!-- layer1_expert0_4 -->
<g id="node226" class="node">
<title>layer1_expert0_4</title>
<polygon fill="lightgreen" stroke="black" points="962,-3119.95 788,-3119.95 788,-3036.95 962,-3036.95 962,-3119.95"/>
<text text-anchor="middle" x="875" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU0</text>
<text text-anchor="middle" x="875" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="875" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="875" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="875" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_4 -->
<g id="edge338" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1520.91,-3193C1387.03,-3186.86 1166.46,-3169.79 971.84,-3119.96"/>
<polygon fill="black" stroke="black" points="972.57,-3116.53 962.01,-3117.4 970.81,-3123.3 972.57,-3116.53"/>
</g>
<!-- layer1_expert0_5 -->
<g id="node227" class="node">
<title>layer1_expert0_5</title>
<polygon fill="lightgreen" stroke="black" points="1154,-3119.95 980,-3119.95 980,-3036.95 1154,-3036.95 1154,-3119.95"/>
<text text-anchor="middle" x="1067" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU0</text>
<text text-anchor="middle" x="1067" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1067" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1067" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1067" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_5 -->
<g id="edge339" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1520.91,-3185.21C1425.32,-3174.51 1289.37,-3155.09 1163.84,-3120"/>
<polygon fill="black" stroke="black" points="1164.63,-3116.59 1154.06,-3117.23 1162.72,-3123.32 1164.63,-3116.59"/>
</g>
<!-- layer1_expert0_6 -->
<g id="node228" class="node">
<title>layer1_expert0_6</title>
<polygon fill="lightgreen" stroke="black" points="1346,-3119.95 1172,-3119.95 1172,-3036.95 1346,-3036.95 1346,-3119.95"/>
<text text-anchor="middle" x="1259" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU0</text>
<text text-anchor="middle" x="1259" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1259" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1259" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1259" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_6 -->
<g id="edge340" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1520.66,-3167.97C1471.66,-3155.59 1414.72,-3139.96 1355.67,-3120.07"/>
<polygon fill="black" stroke="black" points="1356.77,-3116.75 1346.18,-3116.84 1354.52,-3123.37 1356.77,-3116.75"/>
</g>
<!-- layer1_expert0_7 -->
<g id="node229" class="node">
<title>layer1_expert0_7</title>
<polygon fill="lightgreen" stroke="black" points="1538,-3119.95 1364,-3119.95 1364,-3036.95 1538,-3036.95 1538,-3119.95"/>
<text text-anchor="middle" x="1451" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU0</text>
<text text-anchor="middle" x="1451" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1451" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1451" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1451" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_7 -->
<g id="edge341" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1576.39,-3155.86C1560.15,-3145.97 1542.68,-3135.32 1526.08,-3125.21"/>
<polygon fill="black" stroke="black" points="1527.86,-3122.19 1517.5,-3119.97 1524.21,-3128.17 1527.86,-3122.19"/>
</g>
<!-- layer1_expert0_8 -->
<g id="node230" class="node">
<title>layer1_expert0_8</title>
<polygon fill="lightgreen" stroke="black" points="1730,-3119.95 1556,-3119.95 1556,-3036.95 1730,-3036.95 1730,-3119.95"/>
<text text-anchor="middle" x="1643" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU0</text>
<text text-anchor="middle" x="1643" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1643" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1643" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1643" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_8 -->
<g id="edge342" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1643,-3155.86C1643,-3147.6 1643,-3138.82 1643,-3130.26"/>
<polygon fill="black" stroke="black" points="1646.5,-3129.97 1643,-3119.97 1639.5,-3129.97 1646.5,-3129.97"/>
</g>
<!-- layer1_expert0_9 -->
<g id="node231" class="node">
<title>layer1_expert0_9</title>
<polygon fill="lightgreen" stroke="black" points="1922,-3119.95 1748,-3119.95 1748,-3036.95 1922,-3036.95 1922,-3119.95"/>
<text text-anchor="middle" x="1835" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU0</text>
<text text-anchor="middle" x="1835" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1835" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1835" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1835" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_9 -->
<g id="edge343" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1709.61,-3155.86C1725.85,-3145.97 1743.32,-3135.32 1759.92,-3125.21"/>
<polygon fill="black" stroke="black" points="1761.79,-3128.17 1768.5,-3119.97 1758.14,-3122.19 1761.79,-3128.17"/>
</g>
<!-- layer1_expert0_10 -->
<g id="node232" class="node">
<title>layer1_expert0_10</title>
<polygon fill="lightgreen" stroke="black" points="2114,-3119.95 1940,-3119.95 1940,-3036.95 2114,-3036.95 2114,-3119.95"/>
<text text-anchor="middle" x="2027" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU0</text>
<text text-anchor="middle" x="2027" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2027" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2027" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2027" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_10 -->
<g id="edge344" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1765.34,-3167.97C1814.34,-3155.59 1871.28,-3139.96 1930.33,-3120.07"/>
<polygon fill="black" stroke="black" points="1931.48,-3123.37 1939.82,-3116.84 1929.23,-3116.75 1931.48,-3123.37"/>
</g>
<!-- layer1_expert0_11 -->
<g id="node233" class="node">
<title>layer1_expert0_11</title>
<polygon fill="lightgreen" stroke="black" points="2306,-3119.95 2132,-3119.95 2132,-3036.95 2306,-3036.95 2306,-3119.95"/>
<text text-anchor="middle" x="2219" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU0</text>
<text text-anchor="middle" x="2219" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2219" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2219" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2219" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_11 -->
<g id="edge345" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1765.09,-3185.21C1860.68,-3174.51 1996.63,-3155.09 2122.16,-3120"/>
<polygon fill="black" stroke="black" points="2123.28,-3123.32 2131.94,-3117.23 2121.37,-3116.59 2123.28,-3123.32"/>
</g>
<!-- layer1_expert0_12 -->
<g id="node234" class="node">
<title>layer1_expert0_12</title>
<polygon fill="lightgreen" stroke="black" points="2498,-3119.95 2324,-3119.95 2324,-3036.95 2498,-3036.95 2498,-3119.95"/>
<text text-anchor="middle" x="2411" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU0</text>
<text text-anchor="middle" x="2411" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2411" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2411" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2411" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_12 -->
<g id="edge346" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1765.09,-3193C1898.97,-3186.86 2119.54,-3169.79 2314.16,-3119.96"/>
<polygon fill="black" stroke="black" points="2315.19,-3123.3 2323.99,-3117.4 2313.43,-3116.53 2315.19,-3123.3"/>
</g>
<!-- layer1_expert0_13 -->
<g id="node235" class="node">
<title>layer1_expert0_13</title>
<polygon fill="lightgreen" stroke="black" points="2690,-3119.95 2516,-3119.95 2516,-3036.95 2690,-3036.95 2690,-3119.95"/>
<text text-anchor="middle" x="2603" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU0</text>
<text text-anchor="middle" x="2603" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2603" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2603" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2603" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_13 -->
<g id="edge347" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1765.23,-3190.32C1964.75,-3179.53 2352.69,-3155.15 2506,-3119.92"/>
<polygon fill="black" stroke="black" points="2506.84,-3123.31 2515.75,-3117.58 2505.21,-3116.5 2506.84,-3123.31"/>
</g>
<!-- layer1_expert0_14 -->
<g id="node236" class="node">
<title>layer1_expert0_14</title>
<polygon fill="lightgreen" stroke="black" points="2882,-3119.95 2708,-3119.95 2708,-3036.95 2882,-3036.95 2882,-3119.95"/>
<text text-anchor="middle" x="2795" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU0</text>
<text text-anchor="middle" x="2795" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2795" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2795" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2795" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_14 -->
<g id="edge348" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1765.08,-3192.61C1999.72,-3184.41 2506.62,-3162.58 2697.81,-3119.95"/>
<polygon fill="black" stroke="black" points="2698.81,-3123.31 2707.77,-3117.64 2697.23,-3116.49 2698.81,-3123.31"/>
</g>
<!-- layer1_expert0_15 -->
<g id="node237" class="node">
<title>layer1_expert0_15</title>
<polygon fill="lightgreen" stroke="black" points="3074,-3119.95 2900,-3119.95 2900,-3036.95 3074,-3036.95 3074,-3119.95"/>
<text text-anchor="middle" x="2987" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU0</text>
<text text-anchor="middle" x="2987" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2987" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2987" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2987" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_15 -->
<g id="edge349" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1765.18,-3194.19C2032.05,-3188.43 2660.75,-3170.07 2889.83,-3119.94"/>
<polygon fill="black" stroke="black" points="2890.8,-3123.31 2899.78,-3117.68 2889.25,-3116.48 2890.8,-3123.31"/>
</g>
<!-- layer1_moe_agg_gpu0 -->
<g id="node238" class="node">
<title>layer1_moe_agg_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1744.5,-3000.95 1541.5,-3000.95 1541.5,-2932.95 1744.5,-2932.95 1744.5,-3000.95"/>
<text text-anchor="middle" x="1643" y="-2985.75" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU0</text>
<text text-anchor="middle" x="1643" y="-2970.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="1643" y="-2955.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1643" y="-2940.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_expert0_0&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge350" class="edge">
<title>layer1_expert0_0&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M194.21,-3039.17C197.16,-3038.36 200.09,-3037.62 203,-3036.95 455.13,-2979.63 1238.27,-2969.89 1531.05,-2968.27"/>
<polygon fill="black" stroke="black" points="1531.27,-2971.77 1541.25,-2968.21 1531.24,-2964.77 1531.27,-2971.77"/>
</g>
<!-- layer1_expert0_1&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge351" class="edge">
<title>layer1_expert0_1&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M386.22,-3039.2C389.16,-3038.38 392.09,-3037.63 395,-3036.95 609.24,-2987.42 1266.44,-2973.07 1530.97,-2969.24"/>
<polygon fill="black" stroke="black" points="1531.41,-2972.73 1541.36,-2969.09 1531.31,-2965.73 1531.41,-2972.73"/>
</g>
<!-- layer1_expert0_2&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge352" class="edge">
<title>layer1_expert0_2&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M578.23,-3039.24C581.17,-3038.41 584.1,-3037.64 587,-3036.95 763.72,-2995.16 1297.22,-2976.77 1531.09,-2970.56"/>
<polygon fill="black" stroke="black" points="1531.42,-2974.05 1541.32,-2970.29 1531.23,-2967.05 1531.42,-2974.05"/>
</g>
<!-- layer1_expert0_3&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge353" class="edge">
<title>layer1_expert0_3&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M770.24,-3039.3C773.18,-3038.45 776.1,-3037.66 779,-3036.95 918.55,-3002.88 1330.54,-2981.25 1530.96,-2972.46"/>
<polygon fill="black" stroke="black" points="1531.39,-2975.94 1541.22,-2972.01 1531.08,-2968.95 1531.39,-2975.94"/>
</g>
<!-- layer1_expert0_4&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge354" class="edge">
<title>layer1_expert0_4&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M962.26,-3039.38C965.19,-3038.51 968.11,-3037.69 971,-3036.95 1163.8,-2987.56 1396.29,-2973.33 1531.12,-2969.35"/>
<polygon fill="black" stroke="black" points="1531.56,-2972.84 1541.46,-2969.06 1531.37,-2965.84 1531.56,-2972.84"/>
</g>
<!-- layer1_expert0_5&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge355" class="edge">
<title>layer1_expert0_5&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1154.04,-3039.62C1157.04,-3038.67 1160.04,-3037.78 1163,-3036.95 1286.52,-3002.64 1432.92,-2984.73 1531.28,-2975.86"/>
<polygon fill="black" stroke="black" points="1531.59,-2979.34 1541.24,-2974.97 1530.97,-2972.37 1531.59,-2979.34"/>
</g>
<!-- layer1_expert0_6&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge356" class="edge">
<title>layer1_expert0_6&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1346.15,-3039.97C1349.12,-3038.92 1352.08,-3037.91 1355,-3036.95 1412.25,-3018.16 1477.45,-3002.11 1531.32,-2990.23"/>
<polygon fill="black" stroke="black" points="1532.22,-2993.62 1541.24,-2988.06 1530.72,-2986.78 1532.22,-2993.62"/>
</g>
<!-- layer1_expert0_7&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge357" class="edge">
<title>layer1_expert0_7&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1522.22,-3036.84C1539.85,-3026.78 1558.68,-3016.04 1576.1,-3006.11"/>
<polygon fill="black" stroke="black" points="1578.11,-3008.99 1585.06,-3001 1574.64,-3002.91 1578.11,-3008.99"/>
</g>
<!-- layer1_expert0_8&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge358" class="edge">
<title>layer1_expert0_8&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1643,-3036.68C1643,-3028.47 1643,-3019.81 1643,-3011.51"/>
<polygon fill="black" stroke="black" points="1646.5,-3011.25 1643,-3001.25 1639.5,-3011.25 1646.5,-3011.25"/>
</g>
<!-- layer1_expert0_9&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge359" class="edge">
<title>layer1_expert0_9&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1763.78,-3036.84C1746.15,-3026.78 1727.32,-3016.04 1709.9,-3006.11"/>
<polygon fill="black" stroke="black" points="1711.36,-3002.91 1700.94,-3001 1707.89,-3008.99 1711.36,-3002.91"/>
</g>
<!-- layer1_expert0_10&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge360" class="edge">
<title>layer1_expert0_10&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1939.85,-3039.97C1936.88,-3038.92 1933.92,-3037.91 1931,-3036.95 1873.75,-3018.16 1808.55,-3002.11 1754.68,-2990.23"/>
<polygon fill="black" stroke="black" points="1755.28,-2986.78 1744.76,-2988.06 1753.78,-2993.62 1755.28,-2986.78"/>
</g>
<!-- layer1_expert0_11&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge361" class="edge">
<title>layer1_expert0_11&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2131.96,-3039.62C2128.96,-3038.67 2125.96,-3037.78 2123,-3036.95 1999.48,-3002.64 1853.08,-2984.73 1754.72,-2975.86"/>
<polygon fill="black" stroke="black" points="1755.03,-2972.37 1744.76,-2974.97 1754.41,-2979.34 1755.03,-2972.37"/>
</g>
<!-- layer1_expert0_12&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge362" class="edge">
<title>layer1_expert0_12&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2323.74,-3039.38C2320.81,-3038.51 2317.89,-3037.69 2315,-3036.95 2122.2,-2987.56 1889.71,-2973.33 1754.88,-2969.35"/>
<polygon fill="black" stroke="black" points="1754.63,-2965.84 1744.54,-2969.06 1754.44,-2972.84 1754.63,-2965.84"/>
</g>
<!-- layer1_expert0_13&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge363" class="edge">
<title>layer1_expert0_13&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2515.76,-3039.3C2512.82,-3038.45 2509.9,-3037.66 2507,-3036.95 2367.45,-3002.88 1955.46,-2981.25 1755.04,-2972.46"/>
<polygon fill="black" stroke="black" points="1754.92,-2968.95 1744.78,-2972.01 1754.61,-2975.94 1754.92,-2968.95"/>
</g>
<!-- layer1_expert0_14&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge364" class="edge">
<title>layer1_expert0_14&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2707.77,-3039.24C2704.83,-3038.41 2701.9,-3037.64 2699,-3036.95 2522.28,-2995.16 1988.78,-2976.77 1754.91,-2970.56"/>
<polygon fill="black" stroke="black" points="1754.77,-2967.05 1744.68,-2970.29 1754.58,-2974.05 1754.77,-2967.05"/>
</g>
<!-- layer1_expert0_15&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge365" class="edge">
<title>layer1_expert0_15&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2899.78,-3039.2C2896.84,-3038.38 2893.91,-3037.63 2891,-3036.95 2676.76,-2987.42 2019.56,-2973.07 1755.03,-2969.24"/>
<polygon fill="black" stroke="black" points="1754.69,-2965.73 1744.64,-2969.09 1754.59,-2972.73 1754.69,-2965.73"/>
</g>
<!-- layer1_moe_allreduce -->
<g id="node373" class="node">
<title>layer1_moe_allreduce</title>
<polygon fill="lightcoral" stroke="black" points="12299,-2896.95 12062,-2828.95 12299,-2760.95 12536,-2828.95 12299,-2896.95"/>
<text text-anchor="middle" x="12299" y="-2847.75" font-family="Times,serif" font-size="14.00">L1_MoE_All&#45;Reduce</text>
<text text-anchor="middle" x="12299" y="-2832.75" font-family="Times,serif" font-size="14.00">Input: 8×[1024,2048,4096]</text>
<text text-anchor="middle" x="12299" y="-2817.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12299" y="-2802.75" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce across GPUs 0&#45;7</text>
</g>
<!-- layer1_moe_agg_gpu0&#45;&gt;layer1_moe_allreduce -->
<g id="edge366" class="edge">
<title>layer1_moe_agg_gpu0&#45;&gt;layer1_moe_allreduce</title>
<path fill="none" stroke="black" d="M1744.63,-2964.66C2731.3,-2952.06 10601.46,-2851.62 12065.14,-2832.94"/>
<polygon fill="black" stroke="black" points="12065.29,-2836.44 12075.25,-2832.81 12065.2,-2829.44 12065.29,-2836.44"/>
</g>
<!-- layer1_output_gpu0 -->
<g id="node239" class="node">
<title>layer1_output_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="11504,-2724.95 11260,-2724.95 11260,-2656.95 11504,-2656.95 11504,-2724.95"/>
<text text-anchor="middle" x="11382" y="-2709.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU0</text>
<text text-anchor="middle" x="11382" y="-2694.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="11382" y="-2679.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11382" y="-2664.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_qkv_gpu0 -->
<g id="node374" class="node">
<title>layer2_qkv_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="11483,-2620.95 11283,-2620.95 11283,-2522.95 11483,-2522.95 11483,-2620.95"/>
<text text-anchor="middle" x="11383" y="-2605.75" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU0</text>
<text text-anchor="middle" x="11383" y="-2590.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11383" y="-2575.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11383" y="-2560.75" font-family="Times,serif" font-size="14.00">Heads: 0&#45;3</text>
<text text-anchor="middle" x="11383" y="-2545.75" font-family="Times,serif" font-size="14.00">TP Slice: 0</text>
<text text-anchor="middle" x="11383" y="-2530.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_output_gpu0&#45;&gt;layer2_qkv_gpu0 -->
<g id="edge641" class="edge">
<title>layer1_output_gpu0&#45;&gt;layer2_qkv_gpu0</title>
<path fill="none" stroke="black" d="M11382.28,-2656.74C11382.35,-2648.78 11382.43,-2640.04 11382.5,-2631.3"/>
<polygon fill="black" stroke="black" points="11386,-2631.13 11382.59,-2621.1 11379,-2631.07 11386,-2631.13"/>
</g>
<!-- layer1_expert1_0 -->
<g id="node241" class="node">
<title>layer1_expert1_0</title>
<polygon fill="lightgreen" stroke="black" points="3266,-3119.95 3092,-3119.95 3092,-3036.95 3266,-3036.95 3266,-3119.95"/>
<text text-anchor="middle" x="3179" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU1</text>
<text text-anchor="middle" x="3179" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3179" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3179" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3179" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_0 -->
<g id="edge373" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.8,-3195.37C4296.21,-3191.87 3543.59,-3177.65 3276.29,-3119.96"/>
<polygon fill="black" stroke="black" points="3276.74,-3116.48 3266.22,-3117.71 3275.22,-3123.31 3276.74,-3116.48"/>
</g>
<!-- layer1_expert1_1 -->
<g id="node242" class="node">
<title>layer1_expert1_1</title>
<polygon fill="lightgreen" stroke="black" points="3458,-3119.95 3284,-3119.95 3284,-3036.95 3458,-3036.95 3458,-3119.95"/>
<text text-anchor="middle" x="3371" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU1</text>
<text text-anchor="middle" x="3371" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3371" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3371" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3371" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_1 -->
<g id="edge374" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.82,-3194.19C4325.95,-3188.43 3697.25,-3170.07 3468.17,-3119.94"/>
<polygon fill="black" stroke="black" points="3468.75,-3116.48 3458.22,-3117.68 3467.2,-3123.31 3468.75,-3116.48"/>
</g>
<!-- layer1_expert1_2 -->
<g id="node243" class="node">
<title>layer1_expert1_2</title>
<polygon fill="lightgreen" stroke="black" points="3650,-3119.95 3476,-3119.95 3476,-3036.95 3650,-3036.95 3650,-3119.95"/>
<text text-anchor="middle" x="3563" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU1</text>
<text text-anchor="middle" x="3563" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3563" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3563" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3563" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_2 -->
<g id="edge375" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.92,-3192.61C4358.28,-3184.41 3851.38,-3162.58 3660.19,-3119.95"/>
<polygon fill="black" stroke="black" points="3660.77,-3116.49 3650.23,-3117.64 3659.19,-3123.31 3660.77,-3116.49"/>
</g>
<!-- layer1_expert1_3 -->
<g id="node244" class="node">
<title>layer1_expert1_3</title>
<polygon fill="lightgreen" stroke="black" points="3842,-3119.95 3668,-3119.95 3668,-3036.95 3842,-3036.95 3842,-3119.95"/>
<text text-anchor="middle" x="3755" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU1</text>
<text text-anchor="middle" x="3755" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3755" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3755" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3755" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_3 -->
<g id="edge376" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.77,-3190.32C4393.25,-3179.53 4005.31,-3155.15 3852,-3119.92"/>
<polygon fill="black" stroke="black" points="3852.79,-3116.5 3842.25,-3117.58 3851.16,-3123.31 3852.79,-3116.5"/>
</g>
<!-- layer1_expert1_4 -->
<g id="node245" class="node">
<title>layer1_expert1_4</title>
<polygon fill="lightgreen" stroke="black" points="4034,-3119.95 3860,-3119.95 3860,-3036.95 4034,-3036.95 4034,-3119.95"/>
<text text-anchor="middle" x="3947" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU1</text>
<text text-anchor="middle" x="3947" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3947" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3947" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3947" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_4 -->
<g id="edge377" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.91,-3193C4459.03,-3186.86 4238.46,-3169.79 4043.84,-3119.96"/>
<polygon fill="black" stroke="black" points="4044.57,-3116.53 4034.01,-3117.4 4042.81,-3123.3 4044.57,-3116.53"/>
</g>
<!-- layer1_expert1_5 -->
<g id="node246" class="node">
<title>layer1_expert1_5</title>
<polygon fill="lightgreen" stroke="black" points="4226,-3119.95 4052,-3119.95 4052,-3036.95 4226,-3036.95 4226,-3119.95"/>
<text text-anchor="middle" x="4139" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU1</text>
<text text-anchor="middle" x="4139" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4139" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4139" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4139" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_5 -->
<g id="edge378" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.91,-3185.21C4497.32,-3174.51 4361.37,-3155.09 4235.84,-3120"/>
<polygon fill="black" stroke="black" points="4236.63,-3116.59 4226.06,-3117.23 4234.72,-3123.32 4236.63,-3116.59"/>
</g>
<!-- layer1_expert1_6 -->
<g id="node247" class="node">
<title>layer1_expert1_6</title>
<polygon fill="lightgreen" stroke="black" points="4418,-3119.95 4244,-3119.95 4244,-3036.95 4418,-3036.95 4418,-3119.95"/>
<text text-anchor="middle" x="4331" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU1</text>
<text text-anchor="middle" x="4331" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4331" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4331" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4331" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_6 -->
<g id="edge379" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.66,-3167.97C4543.66,-3155.59 4486.72,-3139.96 4427.67,-3120.07"/>
<polygon fill="black" stroke="black" points="4428.77,-3116.75 4418.18,-3116.84 4426.52,-3123.37 4428.77,-3116.75"/>
</g>
<!-- layer1_expert1_7 -->
<g id="node248" class="node">
<title>layer1_expert1_7</title>
<polygon fill="lightgreen" stroke="black" points="4610,-3119.95 4436,-3119.95 4436,-3036.95 4610,-3036.95 4610,-3119.95"/>
<text text-anchor="middle" x="4523" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU1</text>
<text text-anchor="middle" x="4523" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4523" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4523" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4523" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_7 -->
<g id="edge380" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4648.39,-3155.86C4632.15,-3145.97 4614.68,-3135.32 4598.08,-3125.21"/>
<polygon fill="black" stroke="black" points="4599.86,-3122.19 4589.5,-3119.97 4596.21,-3128.17 4599.86,-3122.19"/>
</g>
<!-- layer1_expert1_8 -->
<g id="node249" class="node">
<title>layer1_expert1_8</title>
<polygon fill="lightgreen" stroke="black" points="4802,-3119.95 4628,-3119.95 4628,-3036.95 4802,-3036.95 4802,-3119.95"/>
<text text-anchor="middle" x="4715" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU1</text>
<text text-anchor="middle" x="4715" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4715" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4715" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4715" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_8 -->
<g id="edge381" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4715,-3155.86C4715,-3147.6 4715,-3138.82 4715,-3130.26"/>
<polygon fill="black" stroke="black" points="4718.5,-3129.97 4715,-3119.97 4711.5,-3129.97 4718.5,-3129.97"/>
</g>
<!-- layer1_expert1_9 -->
<g id="node250" class="node">
<title>layer1_expert1_9</title>
<polygon fill="lightgreen" stroke="black" points="4994,-3119.95 4820,-3119.95 4820,-3036.95 4994,-3036.95 4994,-3119.95"/>
<text text-anchor="middle" x="4907" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU1</text>
<text text-anchor="middle" x="4907" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4907" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4907" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4907" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_9 -->
<g id="edge382" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4781.61,-3155.86C4797.85,-3145.97 4815.32,-3135.32 4831.92,-3125.21"/>
<polygon fill="black" stroke="black" points="4833.79,-3128.17 4840.5,-3119.97 4830.14,-3122.19 4833.79,-3128.17"/>
</g>
<!-- layer1_expert1_10 -->
<g id="node251" class="node">
<title>layer1_expert1_10</title>
<polygon fill="lightgreen" stroke="black" points="5186,-3119.95 5012,-3119.95 5012,-3036.95 5186,-3036.95 5186,-3119.95"/>
<text text-anchor="middle" x="5099" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU1</text>
<text text-anchor="middle" x="5099" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5099" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5099" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5099" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_10 -->
<g id="edge383" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4837.34,-3167.97C4886.34,-3155.59 4943.28,-3139.96 5002.33,-3120.07"/>
<polygon fill="black" stroke="black" points="5003.48,-3123.37 5011.82,-3116.84 5001.23,-3116.75 5003.48,-3123.37"/>
</g>
<!-- layer1_expert1_11 -->
<g id="node252" class="node">
<title>layer1_expert1_11</title>
<polygon fill="lightgreen" stroke="black" points="5378,-3119.95 5204,-3119.95 5204,-3036.95 5378,-3036.95 5378,-3119.95"/>
<text text-anchor="middle" x="5291" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU1</text>
<text text-anchor="middle" x="5291" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5291" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5291" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5291" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_11 -->
<g id="edge384" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4837.09,-3185.21C4932.68,-3174.51 5068.63,-3155.09 5194.16,-3120"/>
<polygon fill="black" stroke="black" points="5195.28,-3123.32 5203.94,-3117.23 5193.37,-3116.59 5195.28,-3123.32"/>
</g>
<!-- layer1_expert1_12 -->
<g id="node253" class="node">
<title>layer1_expert1_12</title>
<polygon fill="lightgreen" stroke="black" points="5570,-3119.95 5396,-3119.95 5396,-3036.95 5570,-3036.95 5570,-3119.95"/>
<text text-anchor="middle" x="5483" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU1</text>
<text text-anchor="middle" x="5483" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5483" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5483" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5483" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_12 -->
<g id="edge385" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4837.09,-3193C4970.97,-3186.86 5191.54,-3169.79 5386.16,-3119.96"/>
<polygon fill="black" stroke="black" points="5387.19,-3123.3 5395.99,-3117.4 5385.43,-3116.53 5387.19,-3123.3"/>
</g>
<!-- layer1_expert1_13 -->
<g id="node254" class="node">
<title>layer1_expert1_13</title>
<polygon fill="lightgreen" stroke="black" points="5762,-3119.95 5588,-3119.95 5588,-3036.95 5762,-3036.95 5762,-3119.95"/>
<text text-anchor="middle" x="5675" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU1</text>
<text text-anchor="middle" x="5675" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5675" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5675" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5675" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_13 -->
<g id="edge386" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4837.23,-3190.32C5036.75,-3179.53 5424.69,-3155.15 5578,-3119.92"/>
<polygon fill="black" stroke="black" points="5578.84,-3123.31 5587.75,-3117.58 5577.21,-3116.5 5578.84,-3123.31"/>
</g>
<!-- layer1_expert1_14 -->
<g id="node255" class="node">
<title>layer1_expert1_14</title>
<polygon fill="lightgreen" stroke="black" points="5954,-3119.95 5780,-3119.95 5780,-3036.95 5954,-3036.95 5954,-3119.95"/>
<text text-anchor="middle" x="5867" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU1</text>
<text text-anchor="middle" x="5867" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5867" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5867" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5867" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_14 -->
<g id="edge387" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4837.08,-3192.61C5071.72,-3184.41 5578.62,-3162.58 5769.81,-3119.95"/>
<polygon fill="black" stroke="black" points="5770.81,-3123.31 5779.77,-3117.64 5769.23,-3116.49 5770.81,-3123.31"/>
</g>
<!-- layer1_expert1_15 -->
<g id="node256" class="node">
<title>layer1_expert1_15</title>
<polygon fill="lightgreen" stroke="black" points="6146,-3119.95 5972,-3119.95 5972,-3036.95 6146,-3036.95 6146,-3119.95"/>
<text text-anchor="middle" x="6059" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU1</text>
<text text-anchor="middle" x="6059" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6059" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6059" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6059" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_15 -->
<g id="edge388" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4837.18,-3194.19C5104.05,-3188.43 5732.75,-3170.07 5961.83,-3119.94"/>
<polygon fill="black" stroke="black" points="5962.8,-3123.31 5971.78,-3117.68 5961.25,-3116.48 5962.8,-3123.31"/>
</g>
<!-- layer1_moe_agg_gpu1 -->
<g id="node257" class="node">
<title>layer1_moe_agg_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="4816.5,-3000.95 4613.5,-3000.95 4613.5,-2932.95 4816.5,-2932.95 4816.5,-3000.95"/>
<text text-anchor="middle" x="4715" y="-2985.75" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU1</text>
<text text-anchor="middle" x="4715" y="-2970.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="4715" y="-2955.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="4715" y="-2940.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_expert1_0&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge389" class="edge">
<title>layer1_expert1_0&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3266.21,-3039.17C3269.16,-3038.36 3272.09,-3037.62 3275,-3036.95 3527.13,-2979.63 4310.27,-2969.89 4603.05,-2968.27"/>
<polygon fill="black" stroke="black" points="4603.27,-2971.77 4613.25,-2968.21 4603.24,-2964.77 4603.27,-2971.77"/>
</g>
<!-- layer1_expert1_1&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge390" class="edge">
<title>layer1_expert1_1&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3458.22,-3039.2C3461.16,-3038.38 3464.09,-3037.63 3467,-3036.95 3681.24,-2987.42 4338.44,-2973.07 4602.97,-2969.24"/>
<polygon fill="black" stroke="black" points="4603.41,-2972.73 4613.36,-2969.09 4603.31,-2965.73 4603.41,-2972.73"/>
</g>
<!-- layer1_expert1_2&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge391" class="edge">
<title>layer1_expert1_2&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3650.23,-3039.24C3653.17,-3038.41 3656.1,-3037.64 3659,-3036.95 3835.72,-2995.16 4369.22,-2976.77 4603.09,-2970.56"/>
<polygon fill="black" stroke="black" points="4603.42,-2974.05 4613.32,-2970.29 4603.23,-2967.05 4603.42,-2974.05"/>
</g>
<!-- layer1_expert1_3&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge392" class="edge">
<title>layer1_expert1_3&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3842.24,-3039.3C3845.18,-3038.45 3848.1,-3037.66 3851,-3036.95 3990.55,-3002.88 4402.54,-2981.25 4602.96,-2972.46"/>
<polygon fill="black" stroke="black" points="4603.39,-2975.94 4613.22,-2972.01 4603.08,-2968.95 4603.39,-2975.94"/>
</g>
<!-- layer1_expert1_4&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge393" class="edge">
<title>layer1_expert1_4&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4034.26,-3039.38C4037.19,-3038.51 4040.11,-3037.69 4043,-3036.95 4235.8,-2987.56 4468.29,-2973.33 4603.12,-2969.35"/>
<polygon fill="black" stroke="black" points="4603.56,-2972.84 4613.46,-2969.06 4603.37,-2965.84 4603.56,-2972.84"/>
</g>
<!-- layer1_expert1_5&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge394" class="edge">
<title>layer1_expert1_5&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4226.04,-3039.62C4229.04,-3038.67 4232.04,-3037.78 4235,-3036.95 4358.52,-3002.64 4504.92,-2984.73 4603.28,-2975.86"/>
<polygon fill="black" stroke="black" points="4603.59,-2979.34 4613.24,-2974.97 4602.97,-2972.37 4603.59,-2979.34"/>
</g>
<!-- layer1_expert1_6&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge395" class="edge">
<title>layer1_expert1_6&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4418.15,-3039.97C4421.12,-3038.92 4424.08,-3037.91 4427,-3036.95 4484.25,-3018.16 4549.45,-3002.11 4603.32,-2990.23"/>
<polygon fill="black" stroke="black" points="4604.22,-2993.62 4613.24,-2988.06 4602.72,-2986.78 4604.22,-2993.62"/>
</g>
<!-- layer1_expert1_7&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge396" class="edge">
<title>layer1_expert1_7&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4594.22,-3036.84C4611.85,-3026.78 4630.68,-3016.04 4648.1,-3006.11"/>
<polygon fill="black" stroke="black" points="4650.11,-3008.99 4657.06,-3001 4646.64,-3002.91 4650.11,-3008.99"/>
</g>
<!-- layer1_expert1_8&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge397" class="edge">
<title>layer1_expert1_8&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4715,-3036.68C4715,-3028.47 4715,-3019.81 4715,-3011.51"/>
<polygon fill="black" stroke="black" points="4718.5,-3011.25 4715,-3001.25 4711.5,-3011.25 4718.5,-3011.25"/>
</g>
<!-- layer1_expert1_9&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge398" class="edge">
<title>layer1_expert1_9&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4835.78,-3036.84C4818.15,-3026.78 4799.32,-3016.04 4781.9,-3006.11"/>
<polygon fill="black" stroke="black" points="4783.36,-3002.91 4772.94,-3001 4779.89,-3008.99 4783.36,-3002.91"/>
</g>
<!-- layer1_expert1_10&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge399" class="edge">
<title>layer1_expert1_10&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5011.85,-3039.97C5008.88,-3038.92 5005.92,-3037.91 5003,-3036.95 4945.75,-3018.16 4880.55,-3002.11 4826.68,-2990.23"/>
<polygon fill="black" stroke="black" points="4827.28,-2986.78 4816.76,-2988.06 4825.78,-2993.62 4827.28,-2986.78"/>
</g>
<!-- layer1_expert1_11&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge400" class="edge">
<title>layer1_expert1_11&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5203.96,-3039.62C5200.96,-3038.67 5197.96,-3037.78 5195,-3036.95 5071.48,-3002.64 4925.08,-2984.73 4826.72,-2975.86"/>
<polygon fill="black" stroke="black" points="4827.03,-2972.37 4816.76,-2974.97 4826.41,-2979.34 4827.03,-2972.37"/>
</g>
<!-- layer1_expert1_12&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge401" class="edge">
<title>layer1_expert1_12&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5395.74,-3039.38C5392.81,-3038.51 5389.89,-3037.69 5387,-3036.95 5194.2,-2987.56 4961.71,-2973.33 4826.88,-2969.35"/>
<polygon fill="black" stroke="black" points="4826.63,-2965.84 4816.54,-2969.06 4826.44,-2972.84 4826.63,-2965.84"/>
</g>
<!-- layer1_expert1_13&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge402" class="edge">
<title>layer1_expert1_13&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5587.76,-3039.3C5584.82,-3038.45 5581.9,-3037.66 5579,-3036.95 5439.45,-3002.88 5027.46,-2981.25 4827.04,-2972.46"/>
<polygon fill="black" stroke="black" points="4826.92,-2968.95 4816.78,-2972.01 4826.61,-2975.94 4826.92,-2968.95"/>
</g>
<!-- layer1_expert1_14&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge403" class="edge">
<title>layer1_expert1_14&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5779.77,-3039.24C5776.83,-3038.41 5773.9,-3037.64 5771,-3036.95 5594.28,-2995.16 5060.78,-2976.77 4826.91,-2970.56"/>
<polygon fill="black" stroke="black" points="4826.77,-2967.05 4816.68,-2970.29 4826.58,-2974.05 4826.77,-2967.05"/>
</g>
<!-- layer1_expert1_15&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge404" class="edge">
<title>layer1_expert1_15&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5971.78,-3039.2C5968.84,-3038.38 5965.91,-3037.63 5963,-3036.95 5748.76,-2987.42 5091.56,-2973.07 4827.03,-2969.24"/>
<polygon fill="black" stroke="black" points="4826.69,-2965.73 4816.64,-2969.09 4826.59,-2972.73 4826.69,-2965.73"/>
</g>
<!-- layer1_moe_agg_gpu1&#45;&gt;layer1_moe_allreduce -->
<g id="edge405" class="edge">
<title>layer1_moe_agg_gpu1&#45;&gt;layer1_moe_allreduce</title>
<path fill="none" stroke="black" d="M4816.83,-2964.13C5617.22,-2949.77 10896.32,-2855.11 12068.64,-2834.08"/>
<polygon fill="black" stroke="black" points="12068.93,-2837.58 12078.86,-2833.9 12068.8,-2830.58 12068.93,-2837.58"/>
</g>
<!-- layer1_output_gpu1 -->
<g id="node258" class="node">
<title>layer1_output_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11766,-2724.95 11522,-2724.95 11522,-2656.95 11766,-2656.95 11766,-2724.95"/>
<text text-anchor="middle" x="11644" y="-2709.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU1</text>
<text text-anchor="middle" x="11644" y="-2694.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="11644" y="-2679.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11644" y="-2664.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_qkv_gpu1 -->
<g id="node377" class="node">
<title>layer2_qkv_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11745,-2620.95 11545,-2620.95 11545,-2522.95 11745,-2522.95 11745,-2620.95"/>
<text text-anchor="middle" x="11645" y="-2605.75" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU1</text>
<text text-anchor="middle" x="11645" y="-2590.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11645" y="-2575.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11645" y="-2560.75" font-family="Times,serif" font-size="14.00">Heads: 4&#45;7</text>
<text text-anchor="middle" x="11645" y="-2545.75" font-family="Times,serif" font-size="14.00">TP Slice: 1</text>
<text text-anchor="middle" x="11645" y="-2530.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_output_gpu1&#45;&gt;layer2_qkv_gpu1 -->
<g id="edge642" class="edge">
<title>layer1_output_gpu1&#45;&gt;layer2_qkv_gpu1</title>
<path fill="none" stroke="black" d="M11644.28,-2656.74C11644.35,-2648.78 11644.43,-2640.04 11644.5,-2631.3"/>
<polygon fill="black" stroke="black" points="11648,-2631.13 11644.59,-2621.1 11641,-2631.07 11648,-2631.13"/>
</g>
<!-- layer1_expert2_0 -->
<g id="node260" class="node">
<title>layer1_expert2_0</title>
<polygon fill="lightgreen" stroke="black" points="6338,-3119.95 6164,-3119.95 6164,-3036.95 6338,-3036.95 6338,-3119.95"/>
<text text-anchor="middle" x="6251" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU2</text>
<text text-anchor="middle" x="6251" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6251" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6251" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6251" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_0 -->
<g id="edge412" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7664.8,-3195.37C7368.21,-3191.87 6615.59,-3177.65 6348.29,-3119.96"/>
<polygon fill="black" stroke="black" points="6348.74,-3116.48 6338.22,-3117.71 6347.22,-3123.31 6348.74,-3116.48"/>
</g>
<!-- layer1_expert2_1 -->
<g id="node261" class="node">
<title>layer1_expert2_1</title>
<polygon fill="lightgreen" stroke="black" points="6530,-3119.95 6356,-3119.95 6356,-3036.95 6530,-3036.95 6530,-3119.95"/>
<text text-anchor="middle" x="6443" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU2</text>
<text text-anchor="middle" x="6443" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6443" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6443" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6443" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_1 -->
<g id="edge413" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7664.82,-3194.19C7397.95,-3188.43 6769.25,-3170.07 6540.17,-3119.94"/>
<polygon fill="black" stroke="black" points="6540.75,-3116.48 6530.22,-3117.68 6539.2,-3123.31 6540.75,-3116.48"/>
</g>
<!-- layer1_expert2_2 -->
<g id="node262" class="node">
<title>layer1_expert2_2</title>
<polygon fill="lightgreen" stroke="black" points="6722,-3119.95 6548,-3119.95 6548,-3036.95 6722,-3036.95 6722,-3119.95"/>
<text text-anchor="middle" x="6635" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU2</text>
<text text-anchor="middle" x="6635" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6635" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6635" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6635" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_2 -->
<g id="edge414" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7664.92,-3192.61C7430.28,-3184.41 6923.38,-3162.58 6732.19,-3119.95"/>
<polygon fill="black" stroke="black" points="6732.77,-3116.49 6722.23,-3117.64 6731.19,-3123.31 6732.77,-3116.49"/>
</g>
<!-- layer1_expert2_3 -->
<g id="node263" class="node">
<title>layer1_expert2_3</title>
<polygon fill="lightgreen" stroke="black" points="6914,-3119.95 6740,-3119.95 6740,-3036.95 6914,-3036.95 6914,-3119.95"/>
<text text-anchor="middle" x="6827" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU2</text>
<text text-anchor="middle" x="6827" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6827" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6827" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6827" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_3 -->
<g id="edge415" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7664.77,-3190.32C7465.25,-3179.53 7077.31,-3155.15 6924,-3119.92"/>
<polygon fill="black" stroke="black" points="6924.79,-3116.5 6914.25,-3117.58 6923.16,-3123.31 6924.79,-3116.5"/>
</g>
<!-- layer1_expert2_4 -->
<g id="node264" class="node">
<title>layer1_expert2_4</title>
<polygon fill="lightgreen" stroke="black" points="7106,-3119.95 6932,-3119.95 6932,-3036.95 7106,-3036.95 7106,-3119.95"/>
<text text-anchor="middle" x="7019" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU2</text>
<text text-anchor="middle" x="7019" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7019" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7019" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7019" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_4 -->
<g id="edge416" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7664.91,-3193C7531.03,-3186.86 7310.46,-3169.79 7115.84,-3119.96"/>
<polygon fill="black" stroke="black" points="7116.57,-3116.53 7106.01,-3117.4 7114.81,-3123.3 7116.57,-3116.53"/>
</g>
<!-- layer1_expert2_5 -->
<g id="node265" class="node">
<title>layer1_expert2_5</title>
<polygon fill="lightgreen" stroke="black" points="7298,-3119.95 7124,-3119.95 7124,-3036.95 7298,-3036.95 7298,-3119.95"/>
<text text-anchor="middle" x="7211" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU2</text>
<text text-anchor="middle" x="7211" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7211" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7211" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7211" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_5 -->
<g id="edge417" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7664.91,-3185.21C7569.32,-3174.51 7433.37,-3155.09 7307.84,-3120"/>
<polygon fill="black" stroke="black" points="7308.63,-3116.59 7298.06,-3117.23 7306.72,-3123.32 7308.63,-3116.59"/>
</g>
<!-- layer1_expert2_6 -->
<g id="node266" class="node">
<title>layer1_expert2_6</title>
<polygon fill="lightgreen" stroke="black" points="7490,-3119.95 7316,-3119.95 7316,-3036.95 7490,-3036.95 7490,-3119.95"/>
<text text-anchor="middle" x="7403" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU2</text>
<text text-anchor="middle" x="7403" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7403" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7403" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7403" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_6 -->
<g id="edge418" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7664.66,-3167.97C7615.66,-3155.59 7558.72,-3139.96 7499.67,-3120.07"/>
<polygon fill="black" stroke="black" points="7500.77,-3116.75 7490.18,-3116.84 7498.52,-3123.37 7500.77,-3116.75"/>
</g>
<!-- layer1_expert2_7 -->
<g id="node267" class="node">
<title>layer1_expert2_7</title>
<polygon fill="lightgreen" stroke="black" points="7682,-3119.95 7508,-3119.95 7508,-3036.95 7682,-3036.95 7682,-3119.95"/>
<text text-anchor="middle" x="7595" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU2</text>
<text text-anchor="middle" x="7595" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7595" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7595" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7595" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_7 -->
<g id="edge419" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7720.39,-3155.86C7704.15,-3145.97 7686.68,-3135.32 7670.08,-3125.21"/>
<polygon fill="black" stroke="black" points="7671.86,-3122.19 7661.5,-3119.97 7668.21,-3128.17 7671.86,-3122.19"/>
</g>
<!-- layer1_expert2_8 -->
<g id="node268" class="node">
<title>layer1_expert2_8</title>
<polygon fill="lightgreen" stroke="black" points="7874,-3119.95 7700,-3119.95 7700,-3036.95 7874,-3036.95 7874,-3119.95"/>
<text text-anchor="middle" x="7787" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU2</text>
<text text-anchor="middle" x="7787" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7787" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7787" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7787" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_8 -->
<g id="edge420" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7787,-3155.86C7787,-3147.6 7787,-3138.82 7787,-3130.26"/>
<polygon fill="black" stroke="black" points="7790.5,-3129.97 7787,-3119.97 7783.5,-3129.97 7790.5,-3129.97"/>
</g>
<!-- layer1_expert2_9 -->
<g id="node269" class="node">
<title>layer1_expert2_9</title>
<polygon fill="lightgreen" stroke="black" points="8066,-3119.95 7892,-3119.95 7892,-3036.95 8066,-3036.95 8066,-3119.95"/>
<text text-anchor="middle" x="7979" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU2</text>
<text text-anchor="middle" x="7979" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7979" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7979" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7979" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_9 -->
<g id="edge421" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7853.61,-3155.86C7869.85,-3145.97 7887.32,-3135.32 7903.92,-3125.21"/>
<polygon fill="black" stroke="black" points="7905.79,-3128.17 7912.5,-3119.97 7902.14,-3122.19 7905.79,-3128.17"/>
</g>
<!-- layer1_expert2_10 -->
<g id="node270" class="node">
<title>layer1_expert2_10</title>
<polygon fill="lightgreen" stroke="black" points="8258,-3119.95 8084,-3119.95 8084,-3036.95 8258,-3036.95 8258,-3119.95"/>
<text text-anchor="middle" x="8171" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU2</text>
<text text-anchor="middle" x="8171" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8171" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8171" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8171" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_10 -->
<g id="edge422" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7909.34,-3167.97C7958.34,-3155.59 8015.28,-3139.96 8074.33,-3120.07"/>
<polygon fill="black" stroke="black" points="8075.48,-3123.37 8083.82,-3116.84 8073.23,-3116.75 8075.48,-3123.37"/>
</g>
<!-- layer1_expert2_11 -->
<g id="node271" class="node">
<title>layer1_expert2_11</title>
<polygon fill="lightgreen" stroke="black" points="8450,-3119.95 8276,-3119.95 8276,-3036.95 8450,-3036.95 8450,-3119.95"/>
<text text-anchor="middle" x="8363" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU2</text>
<text text-anchor="middle" x="8363" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8363" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8363" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8363" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_11 -->
<g id="edge423" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7909.09,-3185.21C8004.68,-3174.51 8140.63,-3155.09 8266.16,-3120"/>
<polygon fill="black" stroke="black" points="8267.28,-3123.32 8275.94,-3117.23 8265.37,-3116.59 8267.28,-3123.32"/>
</g>
<!-- layer1_expert2_12 -->
<g id="node272" class="node">
<title>layer1_expert2_12</title>
<polygon fill="lightgreen" stroke="black" points="8642,-3119.95 8468,-3119.95 8468,-3036.95 8642,-3036.95 8642,-3119.95"/>
<text text-anchor="middle" x="8555" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU2</text>
<text text-anchor="middle" x="8555" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8555" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8555" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8555" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_12 -->
<g id="edge424" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7909.09,-3193C8042.97,-3186.86 8263.54,-3169.79 8458.16,-3119.96"/>
<polygon fill="black" stroke="black" points="8459.19,-3123.3 8467.99,-3117.4 8457.43,-3116.53 8459.19,-3123.3"/>
</g>
<!-- layer1_expert2_13 -->
<g id="node273" class="node">
<title>layer1_expert2_13</title>
<polygon fill="lightgreen" stroke="black" points="8834,-3119.95 8660,-3119.95 8660,-3036.95 8834,-3036.95 8834,-3119.95"/>
<text text-anchor="middle" x="8747" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU2</text>
<text text-anchor="middle" x="8747" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8747" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8747" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8747" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_13 -->
<g id="edge425" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7909.23,-3190.32C8108.75,-3179.53 8496.69,-3155.15 8650,-3119.92"/>
<polygon fill="black" stroke="black" points="8650.84,-3123.31 8659.75,-3117.58 8649.21,-3116.5 8650.84,-3123.31"/>
</g>
<!-- layer1_expert2_14 -->
<g id="node274" class="node">
<title>layer1_expert2_14</title>
<polygon fill="lightgreen" stroke="black" points="9026,-3119.95 8852,-3119.95 8852,-3036.95 9026,-3036.95 9026,-3119.95"/>
<text text-anchor="middle" x="8939" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU2</text>
<text text-anchor="middle" x="8939" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8939" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8939" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8939" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_14 -->
<g id="edge426" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7909.08,-3192.61C8143.72,-3184.41 8650.62,-3162.58 8841.81,-3119.95"/>
<polygon fill="black" stroke="black" points="8842.81,-3123.31 8851.77,-3117.64 8841.23,-3116.49 8842.81,-3123.31"/>
</g>
<!-- layer1_expert2_15 -->
<g id="node275" class="node">
<title>layer1_expert2_15</title>
<polygon fill="lightgreen" stroke="black" points="9218,-3119.95 9044,-3119.95 9044,-3036.95 9218,-3036.95 9218,-3119.95"/>
<text text-anchor="middle" x="9131" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU2</text>
<text text-anchor="middle" x="9131" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9131" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9131" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9131" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_15 -->
<g id="edge427" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7909.18,-3194.19C8176.05,-3188.43 8804.75,-3170.07 9033.83,-3119.94"/>
<polygon fill="black" stroke="black" points="9034.8,-3123.31 9043.78,-3117.68 9033.25,-3116.48 9034.8,-3123.31"/>
</g>
<!-- layer1_moe_agg_gpu2 -->
<g id="node276" class="node">
<title>layer1_moe_agg_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="7888.5,-3000.95 7685.5,-3000.95 7685.5,-2932.95 7888.5,-2932.95 7888.5,-3000.95"/>
<text text-anchor="middle" x="7787" y="-2985.75" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU2</text>
<text text-anchor="middle" x="7787" y="-2970.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="7787" y="-2955.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="7787" y="-2940.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_expert2_0&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge428" class="edge">
<title>layer1_expert2_0&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6338.21,-3039.17C6341.16,-3038.36 6344.09,-3037.62 6347,-3036.95 6599.13,-2979.63 7382.27,-2969.89 7675.05,-2968.27"/>
<polygon fill="black" stroke="black" points="7675.27,-2971.77 7685.25,-2968.21 7675.24,-2964.77 7675.27,-2971.77"/>
</g>
<!-- layer1_expert2_1&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge429" class="edge">
<title>layer1_expert2_1&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6530.22,-3039.2C6533.16,-3038.38 6536.09,-3037.63 6539,-3036.95 6753.24,-2987.42 7410.44,-2973.07 7674.97,-2969.24"/>
<polygon fill="black" stroke="black" points="7675.41,-2972.73 7685.36,-2969.09 7675.31,-2965.73 7675.41,-2972.73"/>
</g>
<!-- layer1_expert2_2&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge430" class="edge">
<title>layer1_expert2_2&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6722.23,-3039.24C6725.17,-3038.41 6728.1,-3037.64 6731,-3036.95 6907.72,-2995.16 7441.22,-2976.77 7675.09,-2970.56"/>
<polygon fill="black" stroke="black" points="7675.42,-2974.05 7685.32,-2970.29 7675.23,-2967.05 7675.42,-2974.05"/>
</g>
<!-- layer1_expert2_3&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge431" class="edge">
<title>layer1_expert2_3&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6914.24,-3039.3C6917.18,-3038.45 6920.1,-3037.66 6923,-3036.95 7062.55,-3002.88 7474.54,-2981.25 7674.96,-2972.46"/>
<polygon fill="black" stroke="black" points="7675.39,-2975.94 7685.22,-2972.01 7675.08,-2968.95 7675.39,-2975.94"/>
</g>
<!-- layer1_expert2_4&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge432" class="edge">
<title>layer1_expert2_4&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7106.26,-3039.38C7109.19,-3038.51 7112.11,-3037.69 7115,-3036.95 7307.8,-2987.56 7540.29,-2973.33 7675.12,-2969.35"/>
<polygon fill="black" stroke="black" points="7675.56,-2972.84 7685.46,-2969.06 7675.37,-2965.84 7675.56,-2972.84"/>
</g>
<!-- layer1_expert2_5&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge433" class="edge">
<title>layer1_expert2_5&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7298.04,-3039.62C7301.04,-3038.67 7304.04,-3037.78 7307,-3036.95 7430.52,-3002.64 7576.92,-2984.73 7675.28,-2975.86"/>
<polygon fill="black" stroke="black" points="7675.59,-2979.34 7685.24,-2974.97 7674.97,-2972.37 7675.59,-2979.34"/>
</g>
<!-- layer1_expert2_6&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge434" class="edge">
<title>layer1_expert2_6&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7490.15,-3039.97C7493.12,-3038.92 7496.08,-3037.91 7499,-3036.95 7556.25,-3018.16 7621.45,-3002.11 7675.32,-2990.23"/>
<polygon fill="black" stroke="black" points="7676.22,-2993.62 7685.24,-2988.06 7674.72,-2986.78 7676.22,-2993.62"/>
</g>
<!-- layer1_expert2_7&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge435" class="edge">
<title>layer1_expert2_7&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7666.22,-3036.84C7683.85,-3026.78 7702.68,-3016.04 7720.1,-3006.11"/>
<polygon fill="black" stroke="black" points="7722.11,-3008.99 7729.06,-3001 7718.64,-3002.91 7722.11,-3008.99"/>
</g>
<!-- layer1_expert2_8&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge436" class="edge">
<title>layer1_expert2_8&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7787,-3036.68C7787,-3028.47 7787,-3019.81 7787,-3011.51"/>
<polygon fill="black" stroke="black" points="7790.5,-3011.25 7787,-3001.25 7783.5,-3011.25 7790.5,-3011.25"/>
</g>
<!-- layer1_expert2_9&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge437" class="edge">
<title>layer1_expert2_9&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7907.78,-3036.84C7890.15,-3026.78 7871.32,-3016.04 7853.9,-3006.11"/>
<polygon fill="black" stroke="black" points="7855.36,-3002.91 7844.94,-3001 7851.89,-3008.99 7855.36,-3002.91"/>
</g>
<!-- layer1_expert2_10&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge438" class="edge">
<title>layer1_expert2_10&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8083.85,-3039.97C8080.88,-3038.92 8077.92,-3037.91 8075,-3036.95 8017.75,-3018.16 7952.55,-3002.11 7898.68,-2990.23"/>
<polygon fill="black" stroke="black" points="7899.28,-2986.78 7888.76,-2988.06 7897.78,-2993.62 7899.28,-2986.78"/>
</g>
<!-- layer1_expert2_11&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge439" class="edge">
<title>layer1_expert2_11&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8275.96,-3039.62C8272.96,-3038.67 8269.96,-3037.78 8267,-3036.95 8143.48,-3002.64 7997.08,-2984.73 7898.72,-2975.86"/>
<polygon fill="black" stroke="black" points="7899.03,-2972.37 7888.76,-2974.97 7898.41,-2979.34 7899.03,-2972.37"/>
</g>
<!-- layer1_expert2_12&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge440" class="edge">
<title>layer1_expert2_12&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8467.74,-3039.38C8464.81,-3038.51 8461.89,-3037.69 8459,-3036.95 8266.2,-2987.56 8033.71,-2973.33 7898.88,-2969.35"/>
<polygon fill="black" stroke="black" points="7898.63,-2965.84 7888.54,-2969.06 7898.44,-2972.84 7898.63,-2965.84"/>
</g>
<!-- layer1_expert2_13&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge441" class="edge">
<title>layer1_expert2_13&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8659.76,-3039.3C8656.82,-3038.45 8653.9,-3037.66 8651,-3036.95 8511.45,-3002.88 8099.46,-2981.25 7899.04,-2972.46"/>
<polygon fill="black" stroke="black" points="7898.92,-2968.95 7888.78,-2972.01 7898.61,-2975.94 7898.92,-2968.95"/>
</g>
<!-- layer1_expert2_14&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge442" class="edge">
<title>layer1_expert2_14&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8851.77,-3039.24C8848.83,-3038.41 8845.9,-3037.64 8843,-3036.95 8666.28,-2995.16 8132.78,-2976.77 7898.91,-2970.56"/>
<polygon fill="black" stroke="black" points="7898.77,-2967.05 7888.68,-2970.29 7898.58,-2974.05 7898.77,-2967.05"/>
</g>
<!-- layer1_expert2_15&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge443" class="edge">
<title>layer1_expert2_15&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M9043.78,-3039.2C9040.84,-3038.38 9037.91,-3037.63 9035,-3036.95 8820.76,-2987.42 8163.56,-2973.07 7899.03,-2969.24"/>
<polygon fill="black" stroke="black" points="7898.69,-2965.73 7888.64,-2969.09 7898.59,-2972.73 7898.69,-2965.73"/>
</g>
<!-- layer1_moe_agg_gpu2&#45;&gt;layer1_moe_allreduce -->
<g id="edge444" class="edge">
<title>layer1_moe_agg_gpu2&#45;&gt;layer1_moe_allreduce</title>
<path fill="none" stroke="black" d="M7888.64,-2962.89C8458.87,-2945.7 11263.83,-2861.16 12077.42,-2836.63"/>
<polygon fill="black" stroke="black" points="12077.6,-2840.13 12087.49,-2836.33 12077.39,-2833.13 12077.6,-2840.13"/>
</g>
<!-- layer1_output_gpu2 -->
<g id="node277" class="node">
<title>layer1_output_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="12028,-2724.95 11784,-2724.95 11784,-2656.95 12028,-2656.95 12028,-2724.95"/>
<text text-anchor="middle" x="11906" y="-2709.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU2</text>
<text text-anchor="middle" x="11906" y="-2694.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="11906" y="-2679.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11906" y="-2664.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_qkv_gpu2 -->
<g id="node380" class="node">
<title>layer2_qkv_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="12007,-2620.95 11807,-2620.95 11807,-2522.95 12007,-2522.95 12007,-2620.95"/>
<text text-anchor="middle" x="11907" y="-2605.75" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU2</text>
<text text-anchor="middle" x="11907" y="-2590.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11907" y="-2575.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11907" y="-2560.75" font-family="Times,serif" font-size="14.00">Heads: 8&#45;11</text>
<text text-anchor="middle" x="11907" y="-2545.75" font-family="Times,serif" font-size="14.00">TP Slice: 2</text>
<text text-anchor="middle" x="11907" y="-2530.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_output_gpu2&#45;&gt;layer2_qkv_gpu2 -->
<g id="edge643" class="edge">
<title>layer1_output_gpu2&#45;&gt;layer2_qkv_gpu2</title>
<path fill="none" stroke="black" d="M11906.28,-2656.74C11906.35,-2648.78 11906.43,-2640.04 11906.5,-2631.3"/>
<polygon fill="black" stroke="black" points="11910,-2631.13 11906.59,-2621.1 11903,-2631.07 11910,-2631.13"/>
</g>
<!-- layer1_expert3_0 -->
<g id="node279" class="node">
<title>layer1_expert3_0</title>
<polygon fill="lightgreen" stroke="black" points="9410,-3119.95 9236,-3119.95 9236,-3036.95 9410,-3036.95 9410,-3119.95"/>
<text text-anchor="middle" x="9323" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU3</text>
<text text-anchor="middle" x="9323" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9323" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9323" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9323" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_0 -->
<g id="edge451" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10736.8,-3195.37C10440.21,-3191.87 9687.59,-3177.65 9420.29,-3119.96"/>
<polygon fill="black" stroke="black" points="9420.74,-3116.48 9410.22,-3117.71 9419.22,-3123.31 9420.74,-3116.48"/>
</g>
<!-- layer1_expert3_1 -->
<g id="node280" class="node">
<title>layer1_expert3_1</title>
<polygon fill="lightgreen" stroke="black" points="9602,-3119.95 9428,-3119.95 9428,-3036.95 9602,-3036.95 9602,-3119.95"/>
<text text-anchor="middle" x="9515" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU3</text>
<text text-anchor="middle" x="9515" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9515" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9515" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9515" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_1 -->
<g id="edge452" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10736.82,-3194.19C10469.95,-3188.43 9841.25,-3170.07 9612.17,-3119.94"/>
<polygon fill="black" stroke="black" points="9612.75,-3116.48 9602.22,-3117.68 9611.2,-3123.31 9612.75,-3116.48"/>
</g>
<!-- layer1_expert3_2 -->
<g id="node281" class="node">
<title>layer1_expert3_2</title>
<polygon fill="lightgreen" stroke="black" points="9794,-3119.95 9620,-3119.95 9620,-3036.95 9794,-3036.95 9794,-3119.95"/>
<text text-anchor="middle" x="9707" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU3</text>
<text text-anchor="middle" x="9707" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9707" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9707" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9707" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_2 -->
<g id="edge453" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10736.92,-3192.61C10502.28,-3184.41 9995.38,-3162.58 9804.19,-3119.95"/>
<polygon fill="black" stroke="black" points="9804.77,-3116.49 9794.23,-3117.64 9803.19,-3123.31 9804.77,-3116.49"/>
</g>
<!-- layer1_expert3_3 -->
<g id="node282" class="node">
<title>layer1_expert3_3</title>
<polygon fill="lightgreen" stroke="black" points="9986,-3119.95 9812,-3119.95 9812,-3036.95 9986,-3036.95 9986,-3119.95"/>
<text text-anchor="middle" x="9899" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU3</text>
<text text-anchor="middle" x="9899" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9899" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9899" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9899" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_3 -->
<g id="edge454" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10736.77,-3190.32C10537.25,-3179.53 10149.31,-3155.15 9996,-3119.92"/>
<polygon fill="black" stroke="black" points="9996.79,-3116.5 9986.25,-3117.58 9995.16,-3123.31 9996.79,-3116.5"/>
</g>
<!-- layer1_expert3_4 -->
<g id="node283" class="node">
<title>layer1_expert3_4</title>
<polygon fill="lightgreen" stroke="black" points="10178,-3119.95 10004,-3119.95 10004,-3036.95 10178,-3036.95 10178,-3119.95"/>
<text text-anchor="middle" x="10091" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU3</text>
<text text-anchor="middle" x="10091" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10091" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10091" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10091" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_4 -->
<g id="edge455" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10736.91,-3193C10603.03,-3186.86 10382.46,-3169.79 10187.84,-3119.96"/>
<polygon fill="black" stroke="black" points="10188.57,-3116.53 10178.01,-3117.4 10186.81,-3123.3 10188.57,-3116.53"/>
</g>
<!-- layer1_expert3_5 -->
<g id="node284" class="node">
<title>layer1_expert3_5</title>
<polygon fill="lightgreen" stroke="black" points="10370,-3119.95 10196,-3119.95 10196,-3036.95 10370,-3036.95 10370,-3119.95"/>
<text text-anchor="middle" x="10283" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU3</text>
<text text-anchor="middle" x="10283" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10283" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10283" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10283" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_5 -->
<g id="edge456" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10736.91,-3185.21C10641.32,-3174.51 10505.37,-3155.09 10379.84,-3120"/>
<polygon fill="black" stroke="black" points="10380.63,-3116.59 10370.06,-3117.23 10378.72,-3123.32 10380.63,-3116.59"/>
</g>
<!-- layer1_expert3_6 -->
<g id="node285" class="node">
<title>layer1_expert3_6</title>
<polygon fill="lightgreen" stroke="black" points="10562,-3119.95 10388,-3119.95 10388,-3036.95 10562,-3036.95 10562,-3119.95"/>
<text text-anchor="middle" x="10475" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU3</text>
<text text-anchor="middle" x="10475" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10475" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10475" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10475" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_6 -->
<g id="edge457" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10736.66,-3167.97C10687.66,-3155.59 10630.72,-3139.96 10571.67,-3120.07"/>
<polygon fill="black" stroke="black" points="10572.77,-3116.75 10562.18,-3116.84 10570.52,-3123.37 10572.77,-3116.75"/>
</g>
<!-- layer1_expert3_7 -->
<g id="node286" class="node">
<title>layer1_expert3_7</title>
<polygon fill="lightgreen" stroke="black" points="10754,-3119.95 10580,-3119.95 10580,-3036.95 10754,-3036.95 10754,-3119.95"/>
<text text-anchor="middle" x="10667" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU3</text>
<text text-anchor="middle" x="10667" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10667" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10667" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10667" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_7 -->
<g id="edge458" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10792.39,-3155.86C10776.15,-3145.97 10758.68,-3135.32 10742.08,-3125.21"/>
<polygon fill="black" stroke="black" points="10743.86,-3122.19 10733.5,-3119.97 10740.21,-3128.17 10743.86,-3122.19"/>
</g>
<!-- layer1_expert3_8 -->
<g id="node287" class="node">
<title>layer1_expert3_8</title>
<polygon fill="lightgreen" stroke="black" points="10946,-3119.95 10772,-3119.95 10772,-3036.95 10946,-3036.95 10946,-3119.95"/>
<text text-anchor="middle" x="10859" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU3</text>
<text text-anchor="middle" x="10859" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10859" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10859" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10859" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_8 -->
<g id="edge459" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10859,-3155.86C10859,-3147.6 10859,-3138.82 10859,-3130.26"/>
<polygon fill="black" stroke="black" points="10862.5,-3129.97 10859,-3119.97 10855.5,-3129.97 10862.5,-3129.97"/>
</g>
<!-- layer1_expert3_9 -->
<g id="node288" class="node">
<title>layer1_expert3_9</title>
<polygon fill="lightgreen" stroke="black" points="11138,-3119.95 10964,-3119.95 10964,-3036.95 11138,-3036.95 11138,-3119.95"/>
<text text-anchor="middle" x="11051" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU3</text>
<text text-anchor="middle" x="11051" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11051" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11051" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11051" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_9 -->
<g id="edge460" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10925.61,-3155.86C10941.85,-3145.97 10959.32,-3135.32 10975.92,-3125.21"/>
<polygon fill="black" stroke="black" points="10977.79,-3128.17 10984.5,-3119.97 10974.14,-3122.19 10977.79,-3128.17"/>
</g>
<!-- layer1_expert3_10 -->
<g id="node289" class="node">
<title>layer1_expert3_10</title>
<polygon fill="lightgreen" stroke="black" points="11330,-3119.95 11156,-3119.95 11156,-3036.95 11330,-3036.95 11330,-3119.95"/>
<text text-anchor="middle" x="11243" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU3</text>
<text text-anchor="middle" x="11243" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11243" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11243" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11243" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_10 -->
<g id="edge461" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10981.34,-3167.97C11030.34,-3155.59 11087.28,-3139.96 11146.33,-3120.07"/>
<polygon fill="black" stroke="black" points="11147.48,-3123.37 11155.82,-3116.84 11145.23,-3116.75 11147.48,-3123.37"/>
</g>
<!-- layer1_expert3_11 -->
<g id="node290" class="node">
<title>layer1_expert3_11</title>
<polygon fill="lightgreen" stroke="black" points="11522,-3119.95 11348,-3119.95 11348,-3036.95 11522,-3036.95 11522,-3119.95"/>
<text text-anchor="middle" x="11435" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU3</text>
<text text-anchor="middle" x="11435" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11435" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11435" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11435" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_11 -->
<g id="edge462" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10981.09,-3185.21C11076.68,-3174.51 11212.63,-3155.09 11338.16,-3120"/>
<polygon fill="black" stroke="black" points="11339.28,-3123.32 11347.94,-3117.23 11337.37,-3116.59 11339.28,-3123.32"/>
</g>
<!-- layer1_expert3_12 -->
<g id="node291" class="node">
<title>layer1_expert3_12</title>
<polygon fill="lightgreen" stroke="black" points="11714,-3119.95 11540,-3119.95 11540,-3036.95 11714,-3036.95 11714,-3119.95"/>
<text text-anchor="middle" x="11627" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU3</text>
<text text-anchor="middle" x="11627" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11627" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11627" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11627" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_12 -->
<g id="edge463" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10981.09,-3193C11114.97,-3186.86 11335.54,-3169.79 11530.16,-3119.96"/>
<polygon fill="black" stroke="black" points="11531.19,-3123.3 11539.99,-3117.4 11529.43,-3116.53 11531.19,-3123.3"/>
</g>
<!-- layer1_expert3_13 -->
<g id="node292" class="node">
<title>layer1_expert3_13</title>
<polygon fill="lightgreen" stroke="black" points="11906,-3119.95 11732,-3119.95 11732,-3036.95 11906,-3036.95 11906,-3119.95"/>
<text text-anchor="middle" x="11819" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU3</text>
<text text-anchor="middle" x="11819" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11819" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11819" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11819" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_13 -->
<g id="edge464" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10981.23,-3190.32C11180.75,-3179.53 11568.69,-3155.15 11722,-3119.92"/>
<polygon fill="black" stroke="black" points="11722.84,-3123.31 11731.75,-3117.58 11721.21,-3116.5 11722.84,-3123.31"/>
</g>
<!-- layer1_expert3_14 -->
<g id="node293" class="node">
<title>layer1_expert3_14</title>
<polygon fill="lightgreen" stroke="black" points="12098,-3119.95 11924,-3119.95 11924,-3036.95 12098,-3036.95 12098,-3119.95"/>
<text text-anchor="middle" x="12011" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU3</text>
<text text-anchor="middle" x="12011" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12011" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12011" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12011" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_14 -->
<g id="edge465" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10981.08,-3192.61C11215.72,-3184.41 11722.62,-3162.58 11913.81,-3119.95"/>
<polygon fill="black" stroke="black" points="11914.81,-3123.31 11923.77,-3117.64 11913.23,-3116.49 11914.81,-3123.31"/>
</g>
<!-- layer1_expert3_15 -->
<g id="node294" class="node">
<title>layer1_expert3_15</title>
<polygon fill="lightgreen" stroke="black" points="12290,-3119.95 12116,-3119.95 12116,-3036.95 12290,-3036.95 12290,-3119.95"/>
<text text-anchor="middle" x="12203" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU3</text>
<text text-anchor="middle" x="12203" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12203" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12203" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12203" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_15 -->
<g id="edge466" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10981.18,-3194.19C11248.05,-3188.43 11876.75,-3170.07 12105.83,-3119.94"/>
<polygon fill="black" stroke="black" points="12106.8,-3123.31 12115.78,-3117.68 12105.25,-3116.48 12106.8,-3123.31"/>
</g>
<!-- layer1_moe_agg_gpu3 -->
<g id="node295" class="node">
<title>layer1_moe_agg_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="10960.5,-3000.95 10757.5,-3000.95 10757.5,-2932.95 10960.5,-2932.95 10960.5,-3000.95"/>
<text text-anchor="middle" x="10859" y="-2985.75" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU3</text>
<text text-anchor="middle" x="10859" y="-2970.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="10859" y="-2955.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="10859" y="-2940.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_expert3_0&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge467" class="edge">
<title>layer1_expert3_0&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9410.21,-3039.17C9413.16,-3038.36 9416.09,-3037.62 9419,-3036.95 9671.13,-2979.63 10454.27,-2969.89 10747.05,-2968.27"/>
<polygon fill="black" stroke="black" points="10747.27,-2971.77 10757.25,-2968.21 10747.24,-2964.77 10747.27,-2971.77"/>
</g>
<!-- layer1_expert3_1&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge468" class="edge">
<title>layer1_expert3_1&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9602.22,-3039.2C9605.16,-3038.38 9608.09,-3037.63 9611,-3036.95 9825.24,-2987.42 10482.44,-2973.07 10746.97,-2969.24"/>
<polygon fill="black" stroke="black" points="10747.41,-2972.73 10757.36,-2969.09 10747.31,-2965.73 10747.41,-2972.73"/>
</g>
<!-- layer1_expert3_2&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge469" class="edge">
<title>layer1_expert3_2&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9794.23,-3039.24C9797.17,-3038.41 9800.1,-3037.64 9803,-3036.95 9979.72,-2995.16 10513.22,-2976.77 10747.09,-2970.56"/>
<polygon fill="black" stroke="black" points="10747.42,-2974.05 10757.32,-2970.29 10747.23,-2967.05 10747.42,-2974.05"/>
</g>
<!-- layer1_expert3_3&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge470" class="edge">
<title>layer1_expert3_3&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9986.24,-3039.3C9989.18,-3038.45 9992.1,-3037.66 9995,-3036.95 10134.55,-3002.88 10546.54,-2981.25 10746.96,-2972.46"/>
<polygon fill="black" stroke="black" points="10747.39,-2975.94 10757.22,-2972.01 10747.08,-2968.95 10747.39,-2975.94"/>
</g>
<!-- layer1_expert3_4&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge471" class="edge">
<title>layer1_expert3_4&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10178.26,-3039.38C10181.19,-3038.51 10184.11,-3037.69 10187,-3036.95 10379.8,-2987.56 10612.29,-2973.33 10747.12,-2969.35"/>
<polygon fill="black" stroke="black" points="10747.56,-2972.84 10757.46,-2969.06 10747.37,-2965.84 10747.56,-2972.84"/>
</g>
<!-- layer1_expert3_5&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge472" class="edge">
<title>layer1_expert3_5&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10370.04,-3039.62C10373.04,-3038.67 10376.04,-3037.78 10379,-3036.95 10502.52,-3002.64 10648.92,-2984.73 10747.28,-2975.86"/>
<polygon fill="black" stroke="black" points="10747.59,-2979.34 10757.24,-2974.97 10746.97,-2972.37 10747.59,-2979.34"/>
</g>
<!-- layer1_expert3_6&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge473" class="edge">
<title>layer1_expert3_6&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10562.15,-3039.97C10565.12,-3038.92 10568.08,-3037.91 10571,-3036.95 10628.25,-3018.16 10693.45,-3002.11 10747.32,-2990.23"/>
<polygon fill="black" stroke="black" points="10748.22,-2993.62 10757.24,-2988.06 10746.72,-2986.78 10748.22,-2993.62"/>
</g>
<!-- layer1_expert3_7&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge474" class="edge">
<title>layer1_expert3_7&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10738.22,-3036.84C10755.85,-3026.78 10774.68,-3016.04 10792.1,-3006.11"/>
<polygon fill="black" stroke="black" points="10794.11,-3008.99 10801.06,-3001 10790.64,-3002.91 10794.11,-3008.99"/>
</g>
<!-- layer1_expert3_8&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge475" class="edge">
<title>layer1_expert3_8&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10859,-3036.68C10859,-3028.47 10859,-3019.81 10859,-3011.51"/>
<polygon fill="black" stroke="black" points="10862.5,-3011.25 10859,-3001.25 10855.5,-3011.25 10862.5,-3011.25"/>
</g>
<!-- layer1_expert3_9&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge476" class="edge">
<title>layer1_expert3_9&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10979.78,-3036.84C10962.15,-3026.78 10943.32,-3016.04 10925.9,-3006.11"/>
<polygon fill="black" stroke="black" points="10927.36,-3002.91 10916.94,-3001 10923.89,-3008.99 10927.36,-3002.91"/>
</g>
<!-- layer1_expert3_10&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge477" class="edge">
<title>layer1_expert3_10&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11155.85,-3039.97C11152.88,-3038.92 11149.92,-3037.91 11147,-3036.95 11089.75,-3018.16 11024.55,-3002.11 10970.68,-2990.23"/>
<polygon fill="black" stroke="black" points="10971.28,-2986.78 10960.76,-2988.06 10969.78,-2993.62 10971.28,-2986.78"/>
</g>
<!-- layer1_expert3_11&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge478" class="edge">
<title>layer1_expert3_11&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11347.96,-3039.62C11344.96,-3038.67 11341.96,-3037.78 11339,-3036.95 11215.48,-3002.64 11069.08,-2984.73 10970.72,-2975.86"/>
<polygon fill="black" stroke="black" points="10971.03,-2972.37 10960.76,-2974.97 10970.41,-2979.34 10971.03,-2972.37"/>
</g>
<!-- layer1_expert3_12&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge479" class="edge">
<title>layer1_expert3_12&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11539.74,-3039.38C11536.81,-3038.51 11533.89,-3037.69 11531,-3036.95 11338.2,-2987.56 11105.71,-2973.33 10970.88,-2969.35"/>
<polygon fill="black" stroke="black" points="10970.63,-2965.84 10960.54,-2969.06 10970.44,-2972.84 10970.63,-2965.84"/>
</g>
<!-- layer1_expert3_13&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge480" class="edge">
<title>layer1_expert3_13&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11731.76,-3039.3C11728.82,-3038.45 11725.9,-3037.66 11723,-3036.95 11583.45,-3002.88 11171.46,-2981.25 10971.04,-2972.46"/>
<polygon fill="black" stroke="black" points="10970.92,-2968.95 10960.78,-2972.01 10970.61,-2975.94 10970.92,-2968.95"/>
</g>
<!-- layer1_expert3_14&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge481" class="edge">
<title>layer1_expert3_14&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11923.77,-3039.24C11920.83,-3038.41 11917.9,-3037.64 11915,-3036.95 11738.28,-2995.16 11204.78,-2976.77 10970.91,-2970.56"/>
<polygon fill="black" stroke="black" points="10970.77,-2967.05 10960.68,-2970.29 10970.58,-2974.05 10970.77,-2967.05"/>
</g>
<!-- layer1_expert3_15&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge482" class="edge">
<title>layer1_expert3_15&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M12115.78,-3039.2C12112.84,-3038.38 12109.91,-3037.63 12107,-3036.95 11892.76,-2987.42 11235.56,-2973.07 10971.03,-2969.24"/>
<polygon fill="black" stroke="black" points="10970.69,-2965.73 10960.64,-2969.09 10970.59,-2972.73 10970.69,-2965.73"/>
</g>
<!-- layer1_moe_agg_gpu3&#45;&gt;layer1_moe_allreduce -->
<g id="edge483" class="edge">
<title>layer1_moe_agg_gpu3&#45;&gt;layer1_moe_allreduce</title>
<path fill="none" stroke="black" d="M10960.54,-2956.36C11200.43,-2933.71 11805.11,-2876.6 12112.86,-2847.53"/>
<polygon fill="black" stroke="black" points="12113.6,-2850.98 12123.23,-2846.55 12112.95,-2844.01 12113.6,-2850.98"/>
</g>
<!-- layer1_output_gpu3 -->
<g id="node296" class="node">
<title>layer1_output_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="12290,-2724.95 12046,-2724.95 12046,-2656.95 12290,-2656.95 12290,-2724.95"/>
<text text-anchor="middle" x="12168" y="-2709.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU3</text>
<text text-anchor="middle" x="12168" y="-2694.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="12168" y="-2679.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12168" y="-2664.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_qkv_gpu3 -->
<g id="node383" class="node">
<title>layer2_qkv_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="12268,-2620.95 12068,-2620.95 12068,-2522.95 12268,-2522.95 12268,-2620.95"/>
<text text-anchor="middle" x="12168" y="-2605.75" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU3</text>
<text text-anchor="middle" x="12168" y="-2590.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12168" y="-2575.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12168" y="-2560.75" font-family="Times,serif" font-size="14.00">Heads: 12&#45;15</text>
<text text-anchor="middle" x="12168" y="-2545.75" font-family="Times,serif" font-size="14.00">TP Slice: 3</text>
<text text-anchor="middle" x="12168" y="-2530.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_output_gpu3&#45;&gt;layer2_qkv_gpu3 -->
<g id="edge644" class="edge">
<title>layer1_output_gpu3&#45;&gt;layer2_qkv_gpu3</title>
<path fill="none" stroke="black" d="M12168,-2656.74C12168,-2648.78 12168,-2640.04 12168,-2631.3"/>
<polygon fill="black" stroke="black" points="12171.5,-2631.1 12168,-2621.1 12164.5,-2631.1 12171.5,-2631.1"/>
</g>
<!-- layer1_expert4_0 -->
<g id="node298" class="node">
<title>layer1_expert4_0</title>
<polygon fill="lightgreen" stroke="black" points="12482,-3119.95 12308,-3119.95 12308,-3036.95 12482,-3036.95 12482,-3119.95"/>
<text text-anchor="middle" x="12395" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU4</text>
<text text-anchor="middle" x="12395" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12395" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12395" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12395" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_0 -->
<g id="edge490" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13616.82,-3194.19C13349.95,-3188.43 12721.25,-3170.07 12492.17,-3119.94"/>
<polygon fill="black" stroke="black" points="12492.75,-3116.48 12482.22,-3117.68 12491.2,-3123.31 12492.75,-3116.48"/>
</g>
<!-- layer1_expert4_1 -->
<g id="node299" class="node">
<title>layer1_expert4_1</title>
<polygon fill="lightgreen" stroke="black" points="12674,-3119.95 12500,-3119.95 12500,-3036.95 12674,-3036.95 12674,-3119.95"/>
<text text-anchor="middle" x="12587" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU4</text>
<text text-anchor="middle" x="12587" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12587" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12587" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12587" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_1 -->
<g id="edge491" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13616.92,-3192.61C13382.28,-3184.41 12875.38,-3162.58 12684.19,-3119.95"/>
<polygon fill="black" stroke="black" points="12684.77,-3116.49 12674.23,-3117.64 12683.19,-3123.31 12684.77,-3116.49"/>
</g>
<!-- layer1_expert4_2 -->
<g id="node300" class="node">
<title>layer1_expert4_2</title>
<polygon fill="lightgreen" stroke="black" points="12866,-3119.95 12692,-3119.95 12692,-3036.95 12866,-3036.95 12866,-3119.95"/>
<text text-anchor="middle" x="12779" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU4</text>
<text text-anchor="middle" x="12779" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12779" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12779" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12779" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_2 -->
<g id="edge492" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13616.77,-3190.32C13417.25,-3179.53 13029.31,-3155.15 12876,-3119.92"/>
<polygon fill="black" stroke="black" points="12876.79,-3116.5 12866.25,-3117.58 12875.16,-3123.31 12876.79,-3116.5"/>
</g>
<!-- layer1_expert4_3 -->
<g id="node301" class="node">
<title>layer1_expert4_3</title>
<polygon fill="lightgreen" stroke="black" points="13058,-3119.95 12884,-3119.95 12884,-3036.95 13058,-3036.95 13058,-3119.95"/>
<text text-anchor="middle" x="12971" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU4</text>
<text text-anchor="middle" x="12971" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12971" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12971" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12971" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_3 -->
<g id="edge493" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13616.91,-3193C13483.03,-3186.86 13262.46,-3169.79 13067.84,-3119.96"/>
<polygon fill="black" stroke="black" points="13068.57,-3116.53 13058.01,-3117.4 13066.81,-3123.3 13068.57,-3116.53"/>
</g>
<!-- layer1_expert4_4 -->
<g id="node302" class="node">
<title>layer1_expert4_4</title>
<polygon fill="lightgreen" stroke="black" points="13250,-3119.95 13076,-3119.95 13076,-3036.95 13250,-3036.95 13250,-3119.95"/>
<text text-anchor="middle" x="13163" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU4</text>
<text text-anchor="middle" x="13163" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13163" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13163" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13163" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_4 -->
<g id="edge494" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13616.91,-3185.21C13521.32,-3174.51 13385.37,-3155.09 13259.84,-3120"/>
<polygon fill="black" stroke="black" points="13260.63,-3116.59 13250.06,-3117.23 13258.72,-3123.32 13260.63,-3116.59"/>
</g>
<!-- layer1_expert4_5 -->
<g id="node303" class="node">
<title>layer1_expert4_5</title>
<polygon fill="lightgreen" stroke="black" points="13442,-3119.95 13268,-3119.95 13268,-3036.95 13442,-3036.95 13442,-3119.95"/>
<text text-anchor="middle" x="13355" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU4</text>
<text text-anchor="middle" x="13355" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13355" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13355" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13355" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_5 -->
<g id="edge495" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13616.66,-3167.97C13567.66,-3155.59 13510.72,-3139.96 13451.67,-3120.07"/>
<polygon fill="black" stroke="black" points="13452.77,-3116.75 13442.18,-3116.84 13450.52,-3123.37 13452.77,-3116.75"/>
</g>
<!-- layer1_expert4_6 -->
<g id="node304" class="node">
<title>layer1_expert4_6</title>
<polygon fill="lightgreen" stroke="black" points="13634,-3119.95 13460,-3119.95 13460,-3036.95 13634,-3036.95 13634,-3119.95"/>
<text text-anchor="middle" x="13547" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU4</text>
<text text-anchor="middle" x="13547" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13547" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13547" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13547" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_6 -->
<g id="edge496" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13672.39,-3155.86C13656.15,-3145.97 13638.68,-3135.32 13622.08,-3125.21"/>
<polygon fill="black" stroke="black" points="13623.86,-3122.19 13613.5,-3119.97 13620.21,-3128.17 13623.86,-3122.19"/>
</g>
<!-- layer1_expert4_7 -->
<g id="node305" class="node">
<title>layer1_expert4_7</title>
<polygon fill="lightgreen" stroke="black" points="13826,-3119.95 13652,-3119.95 13652,-3036.95 13826,-3036.95 13826,-3119.95"/>
<text text-anchor="middle" x="13739" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU4</text>
<text text-anchor="middle" x="13739" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13739" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13739" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13739" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_7 -->
<g id="edge497" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13739,-3155.86C13739,-3147.6 13739,-3138.82 13739,-3130.26"/>
<polygon fill="black" stroke="black" points="13742.5,-3129.97 13739,-3119.97 13735.5,-3129.97 13742.5,-3129.97"/>
</g>
<!-- layer1_expert4_8 -->
<g id="node306" class="node">
<title>layer1_expert4_8</title>
<polygon fill="lightgreen" stroke="black" points="14018,-3119.95 13844,-3119.95 13844,-3036.95 14018,-3036.95 14018,-3119.95"/>
<text text-anchor="middle" x="13931" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU4</text>
<text text-anchor="middle" x="13931" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13931" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13931" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13931" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_8 -->
<g id="edge498" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13805.61,-3155.86C13821.85,-3145.97 13839.32,-3135.32 13855.92,-3125.21"/>
<polygon fill="black" stroke="black" points="13857.79,-3128.17 13864.5,-3119.97 13854.14,-3122.19 13857.79,-3128.17"/>
</g>
<!-- layer1_expert4_9 -->
<g id="node307" class="node">
<title>layer1_expert4_9</title>
<polygon fill="lightgreen" stroke="black" points="14210,-3119.95 14036,-3119.95 14036,-3036.95 14210,-3036.95 14210,-3119.95"/>
<text text-anchor="middle" x="14123" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU4</text>
<text text-anchor="middle" x="14123" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14123" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14123" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14123" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_9 -->
<g id="edge499" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13861.34,-3167.97C13910.34,-3155.59 13967.28,-3139.96 14026.33,-3120.07"/>
<polygon fill="black" stroke="black" points="14027.48,-3123.37 14035.82,-3116.84 14025.23,-3116.75 14027.48,-3123.37"/>
</g>
<!-- layer1_expert4_10 -->
<g id="node308" class="node">
<title>layer1_expert4_10</title>
<polygon fill="lightgreen" stroke="black" points="14402,-3119.95 14228,-3119.95 14228,-3036.95 14402,-3036.95 14402,-3119.95"/>
<text text-anchor="middle" x="14315" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU4</text>
<text text-anchor="middle" x="14315" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14315" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14315" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14315" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_10 -->
<g id="edge500" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13861.09,-3185.21C13956.68,-3174.51 14092.63,-3155.09 14218.16,-3120"/>
<polygon fill="black" stroke="black" points="14219.28,-3123.32 14227.94,-3117.23 14217.37,-3116.59 14219.28,-3123.32"/>
</g>
<!-- layer1_expert4_11 -->
<g id="node309" class="node">
<title>layer1_expert4_11</title>
<polygon fill="lightgreen" stroke="black" points="14594,-3119.95 14420,-3119.95 14420,-3036.95 14594,-3036.95 14594,-3119.95"/>
<text text-anchor="middle" x="14507" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU4</text>
<text text-anchor="middle" x="14507" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14507" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14507" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14507" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_11 -->
<g id="edge501" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13861.09,-3193C13994.97,-3186.86 14215.54,-3169.79 14410.16,-3119.96"/>
<polygon fill="black" stroke="black" points="14411.19,-3123.3 14419.99,-3117.4 14409.43,-3116.53 14411.19,-3123.3"/>
</g>
<!-- layer1_expert4_12 -->
<g id="node310" class="node">
<title>layer1_expert4_12</title>
<polygon fill="lightgreen" stroke="black" points="14786,-3119.95 14612,-3119.95 14612,-3036.95 14786,-3036.95 14786,-3119.95"/>
<text text-anchor="middle" x="14699" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU4</text>
<text text-anchor="middle" x="14699" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14699" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14699" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14699" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_12 -->
<g id="edge502" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13861.23,-3190.32C14060.75,-3179.53 14448.69,-3155.15 14602,-3119.92"/>
<polygon fill="black" stroke="black" points="14602.84,-3123.31 14611.75,-3117.58 14601.21,-3116.5 14602.84,-3123.31"/>
</g>
<!-- layer1_expert4_13 -->
<g id="node311" class="node">
<title>layer1_expert4_13</title>
<polygon fill="lightgreen" stroke="black" points="14978,-3119.95 14804,-3119.95 14804,-3036.95 14978,-3036.95 14978,-3119.95"/>
<text text-anchor="middle" x="14891" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU4</text>
<text text-anchor="middle" x="14891" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14891" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14891" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14891" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_13 -->
<g id="edge503" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13861.08,-3192.61C14095.72,-3184.41 14602.62,-3162.58 14793.81,-3119.95"/>
<polygon fill="black" stroke="black" points="14794.81,-3123.31 14803.77,-3117.64 14793.23,-3116.49 14794.81,-3123.31"/>
</g>
<!-- layer1_expert4_14 -->
<g id="node312" class="node">
<title>layer1_expert4_14</title>
<polygon fill="lightgreen" stroke="black" points="15170,-3119.95 14996,-3119.95 14996,-3036.95 15170,-3036.95 15170,-3119.95"/>
<text text-anchor="middle" x="15083" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU4</text>
<text text-anchor="middle" x="15083" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15083" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15083" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15083" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_14 -->
<g id="edge504" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13861.18,-3194.19C14128.05,-3188.43 14756.75,-3170.07 14985.83,-3119.94"/>
<polygon fill="black" stroke="black" points="14986.8,-3123.31 14995.78,-3117.68 14985.25,-3116.48 14986.8,-3123.31"/>
</g>
<!-- layer1_expert4_15 -->
<g id="node313" class="node">
<title>layer1_expert4_15</title>
<polygon fill="lightgreen" stroke="black" points="15362,-3119.95 15188,-3119.95 15188,-3036.95 15362,-3036.95 15362,-3119.95"/>
<text text-anchor="middle" x="15275" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU4</text>
<text text-anchor="middle" x="15275" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15275" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15275" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15275" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_15 -->
<g id="edge505" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13861.2,-3195.37C14157.79,-3191.87 14910.41,-3177.65 15177.71,-3119.96"/>
<polygon fill="black" stroke="black" points="15178.78,-3123.31 15187.78,-3117.71 15177.26,-3116.48 15178.78,-3123.31"/>
</g>
<!-- layer1_moe_agg_gpu4 -->
<g id="node314" class="node">
<title>layer1_moe_agg_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13840.5,-3000.95 13637.5,-3000.95 13637.5,-2932.95 13840.5,-2932.95 13840.5,-3000.95"/>
<text text-anchor="middle" x="13739" y="-2985.75" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU4</text>
<text text-anchor="middle" x="13739" y="-2970.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="13739" y="-2955.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="13739" y="-2940.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_expert4_0&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge506" class="edge">
<title>layer1_expert4_0&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M12482.22,-3039.2C12485.16,-3038.38 12488.09,-3037.63 12491,-3036.95 12705.24,-2987.42 13362.44,-2973.07 13626.97,-2969.24"/>
<polygon fill="black" stroke="black" points="13627.41,-2972.73 13637.36,-2969.09 13627.31,-2965.73 13627.41,-2972.73"/>
</g>
<!-- layer1_expert4_1&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge507" class="edge">
<title>layer1_expert4_1&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M12674.23,-3039.24C12677.17,-3038.41 12680.1,-3037.64 12683,-3036.95 12859.72,-2995.16 13393.22,-2976.77 13627.09,-2970.56"/>
<polygon fill="black" stroke="black" points="13627.42,-2974.05 13637.32,-2970.29 13627.23,-2967.05 13627.42,-2974.05"/>
</g>
<!-- layer1_expert4_2&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge508" class="edge">
<title>layer1_expert4_2&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M12866.24,-3039.3C12869.18,-3038.45 12872.1,-3037.66 12875,-3036.95 13014.55,-3002.88 13426.54,-2981.25 13626.96,-2972.46"/>
<polygon fill="black" stroke="black" points="13627.39,-2975.94 13637.22,-2972.01 13627.08,-2968.95 13627.39,-2975.94"/>
</g>
<!-- layer1_expert4_3&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge509" class="edge">
<title>layer1_expert4_3&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13058.26,-3039.38C13061.19,-3038.51 13064.11,-3037.69 13067,-3036.95 13259.8,-2987.56 13492.29,-2973.33 13627.12,-2969.35"/>
<polygon fill="black" stroke="black" points="13627.56,-2972.84 13637.46,-2969.06 13627.37,-2965.84 13627.56,-2972.84"/>
</g>
<!-- layer1_expert4_4&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge510" class="edge">
<title>layer1_expert4_4&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13250.04,-3039.62C13253.04,-3038.67 13256.04,-3037.78 13259,-3036.95 13382.52,-3002.64 13528.92,-2984.73 13627.28,-2975.86"/>
<polygon fill="black" stroke="black" points="13627.59,-2979.34 13637.24,-2974.97 13626.97,-2972.37 13627.59,-2979.34"/>
</g>
<!-- layer1_expert4_5&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge511" class="edge">
<title>layer1_expert4_5&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13442.15,-3039.97C13445.12,-3038.92 13448.08,-3037.91 13451,-3036.95 13508.25,-3018.16 13573.45,-3002.11 13627.32,-2990.23"/>
<polygon fill="black" stroke="black" points="13628.22,-2993.62 13637.24,-2988.06 13626.72,-2986.78 13628.22,-2993.62"/>
</g>
<!-- layer1_expert4_6&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge512" class="edge">
<title>layer1_expert4_6&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13618.22,-3036.84C13635.85,-3026.78 13654.68,-3016.04 13672.1,-3006.11"/>
<polygon fill="black" stroke="black" points="13674.11,-3008.99 13681.06,-3001 13670.64,-3002.91 13674.11,-3008.99"/>
</g>
<!-- layer1_expert4_7&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge513" class="edge">
<title>layer1_expert4_7&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13739,-3036.68C13739,-3028.47 13739,-3019.81 13739,-3011.51"/>
<polygon fill="black" stroke="black" points="13742.5,-3011.25 13739,-3001.25 13735.5,-3011.25 13742.5,-3011.25"/>
</g>
<!-- layer1_expert4_8&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge514" class="edge">
<title>layer1_expert4_8&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13859.78,-3036.84C13842.15,-3026.78 13823.32,-3016.04 13805.9,-3006.11"/>
<polygon fill="black" stroke="black" points="13807.36,-3002.91 13796.94,-3001 13803.89,-3008.99 13807.36,-3002.91"/>
</g>
<!-- layer1_expert4_9&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge515" class="edge">
<title>layer1_expert4_9&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14035.85,-3039.97C14032.88,-3038.92 14029.92,-3037.91 14027,-3036.95 13969.75,-3018.16 13904.55,-3002.11 13850.68,-2990.23"/>
<polygon fill="black" stroke="black" points="13851.28,-2986.78 13840.76,-2988.06 13849.78,-2993.62 13851.28,-2986.78"/>
</g>
<!-- layer1_expert4_10&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge516" class="edge">
<title>layer1_expert4_10&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14227.96,-3039.62C14224.96,-3038.67 14221.96,-3037.78 14219,-3036.95 14095.48,-3002.64 13949.08,-2984.73 13850.72,-2975.86"/>
<polygon fill="black" stroke="black" points="13851.03,-2972.37 13840.76,-2974.97 13850.41,-2979.34 13851.03,-2972.37"/>
</g>
<!-- layer1_expert4_11&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge517" class="edge">
<title>layer1_expert4_11&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14419.74,-3039.38C14416.81,-3038.51 14413.89,-3037.69 14411,-3036.95 14218.2,-2987.56 13985.71,-2973.33 13850.88,-2969.35"/>
<polygon fill="black" stroke="black" points="13850.63,-2965.84 13840.54,-2969.06 13850.44,-2972.84 13850.63,-2965.84"/>
</g>
<!-- layer1_expert4_12&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge518" class="edge">
<title>layer1_expert4_12&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14611.76,-3039.3C14608.82,-3038.45 14605.9,-3037.66 14603,-3036.95 14463.45,-3002.88 14051.46,-2981.25 13851.04,-2972.46"/>
<polygon fill="black" stroke="black" points="13850.92,-2968.95 13840.78,-2972.01 13850.61,-2975.94 13850.92,-2968.95"/>
</g>
<!-- layer1_expert4_13&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge519" class="edge">
<title>layer1_expert4_13&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14803.77,-3039.24C14800.83,-3038.41 14797.9,-3037.64 14795,-3036.95 14618.28,-2995.16 14084.78,-2976.77 13850.91,-2970.56"/>
<polygon fill="black" stroke="black" points="13850.77,-2967.05 13840.68,-2970.29 13850.58,-2974.05 13850.77,-2967.05"/>
</g>
<!-- layer1_expert4_14&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge520" class="edge">
<title>layer1_expert4_14&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14995.78,-3039.2C14992.84,-3038.38 14989.91,-3037.63 14987,-3036.95 14772.76,-2987.42 14115.56,-2973.07 13851.03,-2969.24"/>
<polygon fill="black" stroke="black" points="13850.69,-2965.73 13840.64,-2969.09 13850.59,-2972.73 13850.69,-2965.73"/>
</g>
<!-- layer1_expert4_15&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge521" class="edge">
<title>layer1_expert4_15&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M15187.79,-3039.17C15184.84,-3038.36 15181.91,-3037.62 15179,-3036.95 14926.87,-2979.63 14143.73,-2969.89 13850.95,-2968.27"/>
<polygon fill="black" stroke="black" points="13850.76,-2964.77 13840.75,-2968.21 13850.73,-2971.77 13850.76,-2964.77"/>
</g>
<!-- layer1_moe_agg_gpu4&#45;&gt;layer1_moe_allreduce -->
<g id="edge522" class="edge">
<title>layer1_moe_agg_gpu4&#45;&gt;layer1_moe_allreduce</title>
<path fill="none" stroke="black" d="M13637.46,-2956.36C13397.57,-2933.71 12792.89,-2876.6 12485.14,-2847.53"/>
<polygon fill="black" stroke="black" points="12485.05,-2844.01 12474.77,-2846.55 12484.4,-2850.98 12485.05,-2844.01"/>
</g>
<!-- layer1_output_gpu4 -->
<g id="node315" class="node">
<title>layer1_output_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="12552,-2724.95 12308,-2724.95 12308,-2656.95 12552,-2656.95 12552,-2724.95"/>
<text text-anchor="middle" x="12430" y="-2709.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU4</text>
<text text-anchor="middle" x="12430" y="-2694.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="12430" y="-2679.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12430" y="-2664.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_qkv_gpu4 -->
<g id="node386" class="node">
<title>layer2_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="12529,-2620.95 12329,-2620.95 12329,-2522.95 12529,-2522.95 12529,-2620.95"/>
<text text-anchor="middle" x="12429" y="-2605.75" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU4</text>
<text text-anchor="middle" x="12429" y="-2590.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12429" y="-2575.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12429" y="-2560.75" font-family="Times,serif" font-size="14.00">Heads: 16&#45;19</text>
<text text-anchor="middle" x="12429" y="-2545.75" font-family="Times,serif" font-size="14.00">TP Slice: 4</text>
<text text-anchor="middle" x="12429" y="-2530.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_output_gpu4&#45;&gt;layer2_qkv_gpu4 -->
<g id="edge645" class="edge">
<title>layer1_output_gpu4&#45;&gt;layer2_qkv_gpu4</title>
<path fill="none" stroke="black" d="M12429.72,-2656.74C12429.65,-2648.78 12429.57,-2640.04 12429.5,-2631.3"/>
<polygon fill="black" stroke="black" points="12433,-2631.07 12429.41,-2621.1 12426,-2631.13 12433,-2631.07"/>
</g>
<!-- layer1_expert5_0 -->
<g id="node317" class="node">
<title>layer1_expert5_0</title>
<polygon fill="lightgreen" stroke="black" points="15554,-3119.95 15380,-3119.95 15380,-3036.95 15554,-3036.95 15554,-3119.95"/>
<text text-anchor="middle" x="15467" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU5</text>
<text text-anchor="middle" x="15467" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15467" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15467" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15467" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_0 -->
<g id="edge529" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16688.82,-3194.19C16421.95,-3188.43 15793.25,-3170.07 15564.17,-3119.94"/>
<polygon fill="black" stroke="black" points="15564.75,-3116.48 15554.22,-3117.68 15563.2,-3123.31 15564.75,-3116.48"/>
</g>
<!-- layer1_expert5_1 -->
<g id="node318" class="node">
<title>layer1_expert5_1</title>
<polygon fill="lightgreen" stroke="black" points="15746,-3119.95 15572,-3119.95 15572,-3036.95 15746,-3036.95 15746,-3119.95"/>
<text text-anchor="middle" x="15659" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU5</text>
<text text-anchor="middle" x="15659" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15659" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15659" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15659" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_1 -->
<g id="edge530" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16688.92,-3192.61C16454.28,-3184.41 15947.38,-3162.58 15756.19,-3119.95"/>
<polygon fill="black" stroke="black" points="15756.77,-3116.49 15746.23,-3117.64 15755.19,-3123.31 15756.77,-3116.49"/>
</g>
<!-- layer1_expert5_2 -->
<g id="node319" class="node">
<title>layer1_expert5_2</title>
<polygon fill="lightgreen" stroke="black" points="15938,-3119.95 15764,-3119.95 15764,-3036.95 15938,-3036.95 15938,-3119.95"/>
<text text-anchor="middle" x="15851" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU5</text>
<text text-anchor="middle" x="15851" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15851" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15851" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15851" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_2 -->
<g id="edge531" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16688.77,-3190.32C16489.25,-3179.53 16101.31,-3155.15 15948,-3119.92"/>
<polygon fill="black" stroke="black" points="15948.79,-3116.5 15938.25,-3117.58 15947.16,-3123.31 15948.79,-3116.5"/>
</g>
<!-- layer1_expert5_3 -->
<g id="node320" class="node">
<title>layer1_expert5_3</title>
<polygon fill="lightgreen" stroke="black" points="16130,-3119.95 15956,-3119.95 15956,-3036.95 16130,-3036.95 16130,-3119.95"/>
<text text-anchor="middle" x="16043" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU5</text>
<text text-anchor="middle" x="16043" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16043" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16043" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16043" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_3 -->
<g id="edge532" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16688.91,-3193C16555.03,-3186.86 16334.46,-3169.79 16139.84,-3119.96"/>
<polygon fill="black" stroke="black" points="16140.57,-3116.53 16130.01,-3117.4 16138.81,-3123.3 16140.57,-3116.53"/>
</g>
<!-- layer1_expert5_4 -->
<g id="node321" class="node">
<title>layer1_expert5_4</title>
<polygon fill="lightgreen" stroke="black" points="16322,-3119.95 16148,-3119.95 16148,-3036.95 16322,-3036.95 16322,-3119.95"/>
<text text-anchor="middle" x="16235" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU5</text>
<text text-anchor="middle" x="16235" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16235" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16235" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16235" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_4 -->
<g id="edge533" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16688.91,-3185.21C16593.32,-3174.51 16457.37,-3155.09 16331.84,-3120"/>
<polygon fill="black" stroke="black" points="16332.63,-3116.59 16322.06,-3117.23 16330.72,-3123.32 16332.63,-3116.59"/>
</g>
<!-- layer1_expert5_5 -->
<g id="node322" class="node">
<title>layer1_expert5_5</title>
<polygon fill="lightgreen" stroke="black" points="16514,-3119.95 16340,-3119.95 16340,-3036.95 16514,-3036.95 16514,-3119.95"/>
<text text-anchor="middle" x="16427" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU5</text>
<text text-anchor="middle" x="16427" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16427" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16427" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16427" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_5 -->
<g id="edge534" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16688.66,-3167.97C16639.66,-3155.59 16582.72,-3139.96 16523.67,-3120.07"/>
<polygon fill="black" stroke="black" points="16524.77,-3116.75 16514.18,-3116.84 16522.52,-3123.37 16524.77,-3116.75"/>
</g>
<!-- layer1_expert5_6 -->
<g id="node323" class="node">
<title>layer1_expert5_6</title>
<polygon fill="lightgreen" stroke="black" points="16706,-3119.95 16532,-3119.95 16532,-3036.95 16706,-3036.95 16706,-3119.95"/>
<text text-anchor="middle" x="16619" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU5</text>
<text text-anchor="middle" x="16619" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16619" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16619" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16619" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_6 -->
<g id="edge535" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16744.39,-3155.86C16728.15,-3145.97 16710.68,-3135.32 16694.08,-3125.21"/>
<polygon fill="black" stroke="black" points="16695.86,-3122.19 16685.5,-3119.97 16692.21,-3128.17 16695.86,-3122.19"/>
</g>
<!-- layer1_expert5_7 -->
<g id="node324" class="node">
<title>layer1_expert5_7</title>
<polygon fill="lightgreen" stroke="black" points="16898,-3119.95 16724,-3119.95 16724,-3036.95 16898,-3036.95 16898,-3119.95"/>
<text text-anchor="middle" x="16811" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU5</text>
<text text-anchor="middle" x="16811" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16811" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16811" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16811" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_7 -->
<g id="edge536" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16811,-3155.86C16811,-3147.6 16811,-3138.82 16811,-3130.26"/>
<polygon fill="black" stroke="black" points="16814.5,-3129.97 16811,-3119.97 16807.5,-3129.97 16814.5,-3129.97"/>
</g>
<!-- layer1_expert5_8 -->
<g id="node325" class="node">
<title>layer1_expert5_8</title>
<polygon fill="lightgreen" stroke="black" points="17090,-3119.95 16916,-3119.95 16916,-3036.95 17090,-3036.95 17090,-3119.95"/>
<text text-anchor="middle" x="17003" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU5</text>
<text text-anchor="middle" x="17003" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17003" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17003" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17003" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_8 -->
<g id="edge537" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16877.61,-3155.86C16893.85,-3145.97 16911.32,-3135.32 16927.92,-3125.21"/>
<polygon fill="black" stroke="black" points="16929.79,-3128.17 16936.5,-3119.97 16926.14,-3122.19 16929.79,-3128.17"/>
</g>
<!-- layer1_expert5_9 -->
<g id="node326" class="node">
<title>layer1_expert5_9</title>
<polygon fill="lightgreen" stroke="black" points="17282,-3119.95 17108,-3119.95 17108,-3036.95 17282,-3036.95 17282,-3119.95"/>
<text text-anchor="middle" x="17195" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU5</text>
<text text-anchor="middle" x="17195" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17195" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17195" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17195" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_9 -->
<g id="edge538" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16933.34,-3167.97C16982.34,-3155.59 17039.28,-3139.96 17098.33,-3120.07"/>
<polygon fill="black" stroke="black" points="17099.48,-3123.37 17107.82,-3116.84 17097.23,-3116.75 17099.48,-3123.37"/>
</g>
<!-- layer1_expert5_10 -->
<g id="node327" class="node">
<title>layer1_expert5_10</title>
<polygon fill="lightgreen" stroke="black" points="17474,-3119.95 17300,-3119.95 17300,-3036.95 17474,-3036.95 17474,-3119.95"/>
<text text-anchor="middle" x="17387" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU5</text>
<text text-anchor="middle" x="17387" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17387" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17387" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17387" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_10 -->
<g id="edge539" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16933.09,-3185.21C17028.68,-3174.51 17164.63,-3155.09 17290.16,-3120"/>
<polygon fill="black" stroke="black" points="17291.28,-3123.32 17299.94,-3117.23 17289.37,-3116.59 17291.28,-3123.32"/>
</g>
<!-- layer1_expert5_11 -->
<g id="node328" class="node">
<title>layer1_expert5_11</title>
<polygon fill="lightgreen" stroke="black" points="17666,-3119.95 17492,-3119.95 17492,-3036.95 17666,-3036.95 17666,-3119.95"/>
<text text-anchor="middle" x="17579" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU5</text>
<text text-anchor="middle" x="17579" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17579" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17579" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17579" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_11 -->
<g id="edge540" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16933.09,-3193C17066.97,-3186.86 17287.54,-3169.79 17482.16,-3119.96"/>
<polygon fill="black" stroke="black" points="17483.19,-3123.3 17491.99,-3117.4 17481.43,-3116.53 17483.19,-3123.3"/>
</g>
<!-- layer1_expert5_12 -->
<g id="node329" class="node">
<title>layer1_expert5_12</title>
<polygon fill="lightgreen" stroke="black" points="17858,-3119.95 17684,-3119.95 17684,-3036.95 17858,-3036.95 17858,-3119.95"/>
<text text-anchor="middle" x="17771" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU5</text>
<text text-anchor="middle" x="17771" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17771" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17771" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17771" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_12 -->
<g id="edge541" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16933.23,-3190.32C17132.75,-3179.53 17520.69,-3155.15 17674,-3119.92"/>
<polygon fill="black" stroke="black" points="17674.84,-3123.31 17683.75,-3117.58 17673.21,-3116.5 17674.84,-3123.31"/>
</g>
<!-- layer1_expert5_13 -->
<g id="node330" class="node">
<title>layer1_expert5_13</title>
<polygon fill="lightgreen" stroke="black" points="18050,-3119.95 17876,-3119.95 17876,-3036.95 18050,-3036.95 18050,-3119.95"/>
<text text-anchor="middle" x="17963" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU5</text>
<text text-anchor="middle" x="17963" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17963" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17963" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17963" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_13 -->
<g id="edge542" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16933.08,-3192.61C17167.72,-3184.41 17674.62,-3162.58 17865.81,-3119.95"/>
<polygon fill="black" stroke="black" points="17866.81,-3123.31 17875.77,-3117.64 17865.23,-3116.49 17866.81,-3123.31"/>
</g>
<!-- layer1_expert5_14 -->
<g id="node331" class="node">
<title>layer1_expert5_14</title>
<polygon fill="lightgreen" stroke="black" points="18242,-3119.95 18068,-3119.95 18068,-3036.95 18242,-3036.95 18242,-3119.95"/>
<text text-anchor="middle" x="18155" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU5</text>
<text text-anchor="middle" x="18155" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18155" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18155" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18155" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_14 -->
<g id="edge543" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16933.18,-3194.19C17200.05,-3188.43 17828.75,-3170.07 18057.83,-3119.94"/>
<polygon fill="black" stroke="black" points="18058.8,-3123.31 18067.78,-3117.68 18057.25,-3116.48 18058.8,-3123.31"/>
</g>
<!-- layer1_expert5_15 -->
<g id="node332" class="node">
<title>layer1_expert5_15</title>
<polygon fill="lightgreen" stroke="black" points="18434,-3119.95 18260,-3119.95 18260,-3036.95 18434,-3036.95 18434,-3119.95"/>
<text text-anchor="middle" x="18347" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU5</text>
<text text-anchor="middle" x="18347" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18347" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18347" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18347" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_15 -->
<g id="edge544" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16933.2,-3195.37C17229.79,-3191.87 17982.41,-3177.65 18249.71,-3119.96"/>
<polygon fill="black" stroke="black" points="18250.78,-3123.31 18259.78,-3117.71 18249.26,-3116.48 18250.78,-3123.31"/>
</g>
<!-- layer1_moe_agg_gpu5 -->
<g id="node333" class="node">
<title>layer1_moe_agg_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="16912.5,-3000.95 16709.5,-3000.95 16709.5,-2932.95 16912.5,-2932.95 16912.5,-3000.95"/>
<text text-anchor="middle" x="16811" y="-2985.75" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU5</text>
<text text-anchor="middle" x="16811" y="-2970.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="16811" y="-2955.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="16811" y="-2940.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_expert5_0&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge545" class="edge">
<title>layer1_expert5_0&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M15554.22,-3039.2C15557.16,-3038.38 15560.09,-3037.63 15563,-3036.95 15777.24,-2987.42 16434.44,-2973.07 16698.97,-2969.24"/>
<polygon fill="black" stroke="black" points="16699.41,-2972.73 16709.36,-2969.09 16699.31,-2965.73 16699.41,-2972.73"/>
</g>
<!-- layer1_expert5_1&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge546" class="edge">
<title>layer1_expert5_1&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M15746.23,-3039.24C15749.17,-3038.41 15752.1,-3037.64 15755,-3036.95 15931.72,-2995.16 16465.22,-2976.77 16699.09,-2970.56"/>
<polygon fill="black" stroke="black" points="16699.42,-2974.05 16709.32,-2970.29 16699.23,-2967.05 16699.42,-2974.05"/>
</g>
<!-- layer1_expert5_2&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge547" class="edge">
<title>layer1_expert5_2&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M15938.24,-3039.3C15941.18,-3038.45 15944.1,-3037.66 15947,-3036.95 16086.55,-3002.88 16498.54,-2981.25 16698.96,-2972.46"/>
<polygon fill="black" stroke="black" points="16699.39,-2975.94 16709.22,-2972.01 16699.08,-2968.95 16699.39,-2975.94"/>
</g>
<!-- layer1_expert5_3&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge548" class="edge">
<title>layer1_expert5_3&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16130.26,-3039.38C16133.19,-3038.51 16136.11,-3037.69 16139,-3036.95 16331.8,-2987.56 16564.29,-2973.33 16699.12,-2969.35"/>
<polygon fill="black" stroke="black" points="16699.56,-2972.84 16709.46,-2969.06 16699.37,-2965.84 16699.56,-2972.84"/>
</g>
<!-- layer1_expert5_4&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge549" class="edge">
<title>layer1_expert5_4&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16322.04,-3039.62C16325.04,-3038.67 16328.04,-3037.78 16331,-3036.95 16454.52,-3002.64 16600.92,-2984.73 16699.28,-2975.86"/>
<polygon fill="black" stroke="black" points="16699.59,-2979.34 16709.24,-2974.97 16698.97,-2972.37 16699.59,-2979.34"/>
</g>
<!-- layer1_expert5_5&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge550" class="edge">
<title>layer1_expert5_5&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16514.15,-3039.97C16517.12,-3038.92 16520.08,-3037.91 16523,-3036.95 16580.25,-3018.16 16645.45,-3002.11 16699.32,-2990.23"/>
<polygon fill="black" stroke="black" points="16700.22,-2993.62 16709.24,-2988.06 16698.72,-2986.78 16700.22,-2993.62"/>
</g>
<!-- layer1_expert5_6&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge551" class="edge">
<title>layer1_expert5_6&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16690.22,-3036.84C16707.85,-3026.78 16726.68,-3016.04 16744.1,-3006.11"/>
<polygon fill="black" stroke="black" points="16746.11,-3008.99 16753.06,-3001 16742.64,-3002.91 16746.11,-3008.99"/>
</g>
<!-- layer1_expert5_7&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge552" class="edge">
<title>layer1_expert5_7&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16811,-3036.68C16811,-3028.47 16811,-3019.81 16811,-3011.51"/>
<polygon fill="black" stroke="black" points="16814.5,-3011.25 16811,-3001.25 16807.5,-3011.25 16814.5,-3011.25"/>
</g>
<!-- layer1_expert5_8&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge553" class="edge">
<title>layer1_expert5_8&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16931.78,-3036.84C16914.15,-3026.78 16895.32,-3016.04 16877.9,-3006.11"/>
<polygon fill="black" stroke="black" points="16879.36,-3002.91 16868.94,-3001 16875.89,-3008.99 16879.36,-3002.91"/>
</g>
<!-- layer1_expert5_9&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge554" class="edge">
<title>layer1_expert5_9&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17107.85,-3039.97C17104.88,-3038.92 17101.92,-3037.91 17099,-3036.95 17041.75,-3018.16 16976.55,-3002.11 16922.68,-2990.23"/>
<polygon fill="black" stroke="black" points="16923.28,-2986.78 16912.76,-2988.06 16921.78,-2993.62 16923.28,-2986.78"/>
</g>
<!-- layer1_expert5_10&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge555" class="edge">
<title>layer1_expert5_10&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17299.96,-3039.62C17296.96,-3038.67 17293.96,-3037.78 17291,-3036.95 17167.48,-3002.64 17021.08,-2984.73 16922.72,-2975.86"/>
<polygon fill="black" stroke="black" points="16923.03,-2972.37 16912.76,-2974.97 16922.41,-2979.34 16923.03,-2972.37"/>
</g>
<!-- layer1_expert5_11&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge556" class="edge">
<title>layer1_expert5_11&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17491.74,-3039.38C17488.81,-3038.51 17485.89,-3037.69 17483,-3036.95 17290.2,-2987.56 17057.71,-2973.33 16922.88,-2969.35"/>
<polygon fill="black" stroke="black" points="16922.63,-2965.84 16912.54,-2969.06 16922.44,-2972.84 16922.63,-2965.84"/>
</g>
<!-- layer1_expert5_12&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge557" class="edge">
<title>layer1_expert5_12&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17683.76,-3039.3C17680.82,-3038.45 17677.9,-3037.66 17675,-3036.95 17535.45,-3002.88 17123.46,-2981.25 16923.04,-2972.46"/>
<polygon fill="black" stroke="black" points="16922.92,-2968.95 16912.78,-2972.01 16922.61,-2975.94 16922.92,-2968.95"/>
</g>
<!-- layer1_expert5_13&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge558" class="edge">
<title>layer1_expert5_13&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17875.77,-3039.24C17872.83,-3038.41 17869.9,-3037.64 17867,-3036.95 17690.28,-2995.16 17156.78,-2976.77 16922.91,-2970.56"/>
<polygon fill="black" stroke="black" points="16922.77,-2967.05 16912.68,-2970.29 16922.58,-2974.05 16922.77,-2967.05"/>
</g>
<!-- layer1_expert5_14&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge559" class="edge">
<title>layer1_expert5_14&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M18067.78,-3039.2C18064.84,-3038.38 18061.91,-3037.63 18059,-3036.95 17844.76,-2987.42 17187.56,-2973.07 16923.03,-2969.24"/>
<polygon fill="black" stroke="black" points="16922.69,-2965.73 16912.64,-2969.09 16922.59,-2972.73 16922.69,-2965.73"/>
</g>
<!-- layer1_expert5_15&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge560" class="edge">
<title>layer1_expert5_15&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M18259.79,-3039.17C18256.84,-3038.36 18253.91,-3037.62 18251,-3036.95 17998.87,-2979.63 17215.73,-2969.89 16922.95,-2968.27"/>
<polygon fill="black" stroke="black" points="16922.76,-2964.77 16912.75,-2968.21 16922.73,-2971.77 16922.76,-2964.77"/>
</g>
<!-- layer1_moe_agg_gpu5&#45;&gt;layer1_moe_allreduce -->
<g id="edge561" class="edge">
<title>layer1_moe_agg_gpu5&#45;&gt;layer1_moe_allreduce</title>
<path fill="none" stroke="black" d="M16709.36,-2962.89C16139.13,-2945.7 13334.17,-2861.16 12520.58,-2836.63"/>
<polygon fill="black" stroke="black" points="12520.61,-2833.13 12510.51,-2836.33 12520.4,-2840.13 12520.61,-2833.13"/>
</g>
<!-- layer1_output_gpu5 -->
<g id="node334" class="node">
<title>layer1_output_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12814,-2724.95 12570,-2724.95 12570,-2656.95 12814,-2656.95 12814,-2724.95"/>
<text text-anchor="middle" x="12692" y="-2709.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU5</text>
<text text-anchor="middle" x="12692" y="-2694.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="12692" y="-2679.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12692" y="-2664.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_qkv_gpu5 -->
<g id="node389" class="node">
<title>layer2_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12791,-2620.95 12591,-2620.95 12591,-2522.95 12791,-2522.95 12791,-2620.95"/>
<text text-anchor="middle" x="12691" y="-2605.75" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU5</text>
<text text-anchor="middle" x="12691" y="-2590.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12691" y="-2575.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12691" y="-2560.75" font-family="Times,serif" font-size="14.00">Heads: 20&#45;23</text>
<text text-anchor="middle" x="12691" y="-2545.75" font-family="Times,serif" font-size="14.00">TP Slice: 5</text>
<text text-anchor="middle" x="12691" y="-2530.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_output_gpu5&#45;&gt;layer2_qkv_gpu5 -->
<g id="edge646" class="edge">
<title>layer1_output_gpu5&#45;&gt;layer2_qkv_gpu5</title>
<path fill="none" stroke="black" d="M12691.72,-2656.74C12691.65,-2648.78 12691.57,-2640.04 12691.5,-2631.3"/>
<polygon fill="black" stroke="black" points="12695,-2631.07 12691.41,-2621.1 12688,-2631.13 12695,-2631.07"/>
</g>
<!-- layer1_expert6_0 -->
<g id="node336" class="node">
<title>layer1_expert6_0</title>
<polygon fill="lightgreen" stroke="black" points="18626,-3119.95 18452,-3119.95 18452,-3036.95 18626,-3036.95 18626,-3119.95"/>
<text text-anchor="middle" x="18539" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU6</text>
<text text-anchor="middle" x="18539" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18539" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18539" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18539" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_0 -->
<g id="edge568" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19760.82,-3194.19C19493.95,-3188.43 18865.25,-3170.07 18636.17,-3119.94"/>
<polygon fill="black" stroke="black" points="18636.75,-3116.48 18626.22,-3117.68 18635.2,-3123.31 18636.75,-3116.48"/>
</g>
<!-- layer1_expert6_1 -->
<g id="node337" class="node">
<title>layer1_expert6_1</title>
<polygon fill="lightgreen" stroke="black" points="18818,-3119.95 18644,-3119.95 18644,-3036.95 18818,-3036.95 18818,-3119.95"/>
<text text-anchor="middle" x="18731" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU6</text>
<text text-anchor="middle" x="18731" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18731" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18731" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18731" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_1 -->
<g id="edge569" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19760.92,-3192.61C19526.28,-3184.41 19019.38,-3162.58 18828.19,-3119.95"/>
<polygon fill="black" stroke="black" points="18828.77,-3116.49 18818.23,-3117.64 18827.19,-3123.31 18828.77,-3116.49"/>
</g>
<!-- layer1_expert6_2 -->
<g id="node338" class="node">
<title>layer1_expert6_2</title>
<polygon fill="lightgreen" stroke="black" points="19010,-3119.95 18836,-3119.95 18836,-3036.95 19010,-3036.95 19010,-3119.95"/>
<text text-anchor="middle" x="18923" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU6</text>
<text text-anchor="middle" x="18923" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18923" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18923" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18923" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_2 -->
<g id="edge570" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19760.77,-3190.32C19561.25,-3179.53 19173.31,-3155.15 19020,-3119.92"/>
<polygon fill="black" stroke="black" points="19020.79,-3116.5 19010.25,-3117.58 19019.16,-3123.31 19020.79,-3116.5"/>
</g>
<!-- layer1_expert6_3 -->
<g id="node339" class="node">
<title>layer1_expert6_3</title>
<polygon fill="lightgreen" stroke="black" points="19202,-3119.95 19028,-3119.95 19028,-3036.95 19202,-3036.95 19202,-3119.95"/>
<text text-anchor="middle" x="19115" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU6</text>
<text text-anchor="middle" x="19115" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19115" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19115" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19115" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_3 -->
<g id="edge571" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19760.91,-3193C19627.03,-3186.86 19406.46,-3169.79 19211.84,-3119.96"/>
<polygon fill="black" stroke="black" points="19212.57,-3116.53 19202.01,-3117.4 19210.81,-3123.3 19212.57,-3116.53"/>
</g>
<!-- layer1_expert6_4 -->
<g id="node340" class="node">
<title>layer1_expert6_4</title>
<polygon fill="lightgreen" stroke="black" points="19394,-3119.95 19220,-3119.95 19220,-3036.95 19394,-3036.95 19394,-3119.95"/>
<text text-anchor="middle" x="19307" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU6</text>
<text text-anchor="middle" x="19307" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19307" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19307" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19307" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_4 -->
<g id="edge572" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19760.91,-3185.21C19665.32,-3174.51 19529.37,-3155.09 19403.84,-3120"/>
<polygon fill="black" stroke="black" points="19404.63,-3116.59 19394.06,-3117.23 19402.72,-3123.32 19404.63,-3116.59"/>
</g>
<!-- layer1_expert6_5 -->
<g id="node341" class="node">
<title>layer1_expert6_5</title>
<polygon fill="lightgreen" stroke="black" points="19586,-3119.95 19412,-3119.95 19412,-3036.95 19586,-3036.95 19586,-3119.95"/>
<text text-anchor="middle" x="19499" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU6</text>
<text text-anchor="middle" x="19499" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19499" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19499" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19499" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_5 -->
<g id="edge573" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19760.66,-3167.97C19711.66,-3155.59 19654.72,-3139.96 19595.67,-3120.07"/>
<polygon fill="black" stroke="black" points="19596.77,-3116.75 19586.18,-3116.84 19594.52,-3123.37 19596.77,-3116.75"/>
</g>
<!-- layer1_expert6_6 -->
<g id="node342" class="node">
<title>layer1_expert6_6</title>
<polygon fill="lightgreen" stroke="black" points="19778,-3119.95 19604,-3119.95 19604,-3036.95 19778,-3036.95 19778,-3119.95"/>
<text text-anchor="middle" x="19691" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU6</text>
<text text-anchor="middle" x="19691" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19691" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19691" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19691" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_6 -->
<g id="edge574" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19816.39,-3155.86C19800.15,-3145.97 19782.68,-3135.32 19766.08,-3125.21"/>
<polygon fill="black" stroke="black" points="19767.86,-3122.19 19757.5,-3119.97 19764.21,-3128.17 19767.86,-3122.19"/>
</g>
<!-- layer1_expert6_7 -->
<g id="node343" class="node">
<title>layer1_expert6_7</title>
<polygon fill="lightgreen" stroke="black" points="19970,-3119.95 19796,-3119.95 19796,-3036.95 19970,-3036.95 19970,-3119.95"/>
<text text-anchor="middle" x="19883" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU6</text>
<text text-anchor="middle" x="19883" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19883" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19883" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19883" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_7 -->
<g id="edge575" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19883,-3155.86C19883,-3147.6 19883,-3138.82 19883,-3130.26"/>
<polygon fill="black" stroke="black" points="19886.5,-3129.97 19883,-3119.97 19879.5,-3129.97 19886.5,-3129.97"/>
</g>
<!-- layer1_expert6_8 -->
<g id="node344" class="node">
<title>layer1_expert6_8</title>
<polygon fill="lightgreen" stroke="black" points="20162,-3119.95 19988,-3119.95 19988,-3036.95 20162,-3036.95 20162,-3119.95"/>
<text text-anchor="middle" x="20075" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU6</text>
<text text-anchor="middle" x="20075" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20075" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20075" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20075" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_8 -->
<g id="edge576" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19949.61,-3155.86C19965.85,-3145.97 19983.32,-3135.32 19999.92,-3125.21"/>
<polygon fill="black" stroke="black" points="20001.79,-3128.17 20008.5,-3119.97 19998.14,-3122.19 20001.79,-3128.17"/>
</g>
<!-- layer1_expert6_9 -->
<g id="node345" class="node">
<title>layer1_expert6_9</title>
<polygon fill="lightgreen" stroke="black" points="20354,-3119.95 20180,-3119.95 20180,-3036.95 20354,-3036.95 20354,-3119.95"/>
<text text-anchor="middle" x="20267" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU6</text>
<text text-anchor="middle" x="20267" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20267" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20267" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20267" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_9 -->
<g id="edge577" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20005.34,-3167.97C20054.34,-3155.59 20111.28,-3139.96 20170.33,-3120.07"/>
<polygon fill="black" stroke="black" points="20171.48,-3123.37 20179.82,-3116.84 20169.23,-3116.75 20171.48,-3123.37"/>
</g>
<!-- layer1_expert6_10 -->
<g id="node346" class="node">
<title>layer1_expert6_10</title>
<polygon fill="lightgreen" stroke="black" points="20546,-3119.95 20372,-3119.95 20372,-3036.95 20546,-3036.95 20546,-3119.95"/>
<text text-anchor="middle" x="20459" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU6</text>
<text text-anchor="middle" x="20459" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20459" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20459" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20459" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_10 -->
<g id="edge578" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20005.09,-3185.21C20100.68,-3174.51 20236.63,-3155.09 20362.16,-3120"/>
<polygon fill="black" stroke="black" points="20363.28,-3123.32 20371.94,-3117.23 20361.37,-3116.59 20363.28,-3123.32"/>
</g>
<!-- layer1_expert6_11 -->
<g id="node347" class="node">
<title>layer1_expert6_11</title>
<polygon fill="lightgreen" stroke="black" points="20738,-3119.95 20564,-3119.95 20564,-3036.95 20738,-3036.95 20738,-3119.95"/>
<text text-anchor="middle" x="20651" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU6</text>
<text text-anchor="middle" x="20651" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20651" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20651" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20651" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_11 -->
<g id="edge579" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20005.09,-3193C20138.97,-3186.86 20359.54,-3169.79 20554.16,-3119.96"/>
<polygon fill="black" stroke="black" points="20555.19,-3123.3 20563.99,-3117.4 20553.43,-3116.53 20555.19,-3123.3"/>
</g>
<!-- layer1_expert6_12 -->
<g id="node348" class="node">
<title>layer1_expert6_12</title>
<polygon fill="lightgreen" stroke="black" points="20930,-3119.95 20756,-3119.95 20756,-3036.95 20930,-3036.95 20930,-3119.95"/>
<text text-anchor="middle" x="20843" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU6</text>
<text text-anchor="middle" x="20843" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20843" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20843" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20843" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_12 -->
<g id="edge580" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20005.23,-3190.32C20204.75,-3179.53 20592.69,-3155.15 20746,-3119.92"/>
<polygon fill="black" stroke="black" points="20746.84,-3123.31 20755.75,-3117.58 20745.21,-3116.5 20746.84,-3123.31"/>
</g>
<!-- layer1_expert6_13 -->
<g id="node349" class="node">
<title>layer1_expert6_13</title>
<polygon fill="lightgreen" stroke="black" points="21122,-3119.95 20948,-3119.95 20948,-3036.95 21122,-3036.95 21122,-3119.95"/>
<text text-anchor="middle" x="21035" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU6</text>
<text text-anchor="middle" x="21035" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21035" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21035" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21035" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_13 -->
<g id="edge581" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20005.08,-3192.61C20239.72,-3184.41 20746.62,-3162.58 20937.81,-3119.95"/>
<polygon fill="black" stroke="black" points="20938.81,-3123.31 20947.77,-3117.64 20937.23,-3116.49 20938.81,-3123.31"/>
</g>
<!-- layer1_expert6_14 -->
<g id="node350" class="node">
<title>layer1_expert6_14</title>
<polygon fill="lightgreen" stroke="black" points="21314,-3119.95 21140,-3119.95 21140,-3036.95 21314,-3036.95 21314,-3119.95"/>
<text text-anchor="middle" x="21227" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU6</text>
<text text-anchor="middle" x="21227" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21227" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21227" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21227" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_14 -->
<g id="edge582" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20005.18,-3194.19C20272.05,-3188.43 20900.75,-3170.07 21129.83,-3119.94"/>
<polygon fill="black" stroke="black" points="21130.8,-3123.31 21139.78,-3117.68 21129.25,-3116.48 21130.8,-3123.31"/>
</g>
<!-- layer1_expert6_15 -->
<g id="node351" class="node">
<title>layer1_expert6_15</title>
<polygon fill="lightgreen" stroke="black" points="21506,-3119.95 21332,-3119.95 21332,-3036.95 21506,-3036.95 21506,-3119.95"/>
<text text-anchor="middle" x="21419" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU6</text>
<text text-anchor="middle" x="21419" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21419" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21419" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21419" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_15 -->
<g id="edge583" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20005.2,-3195.37C20301.79,-3191.87 21054.41,-3177.65 21321.71,-3119.96"/>
<polygon fill="black" stroke="black" points="21322.78,-3123.31 21331.78,-3117.71 21321.26,-3116.48 21322.78,-3123.31"/>
</g>
<!-- layer1_moe_agg_gpu6 -->
<g id="node352" class="node">
<title>layer1_moe_agg_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="19984.5,-3000.95 19781.5,-3000.95 19781.5,-2932.95 19984.5,-2932.95 19984.5,-3000.95"/>
<text text-anchor="middle" x="19883" y="-2985.75" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU6</text>
<text text-anchor="middle" x="19883" y="-2970.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="19883" y="-2955.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="19883" y="-2940.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_expert6_0&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge584" class="edge">
<title>layer1_expert6_0&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M18626.22,-3039.2C18629.16,-3038.38 18632.09,-3037.63 18635,-3036.95 18849.24,-2987.42 19506.44,-2973.07 19770.97,-2969.24"/>
<polygon fill="black" stroke="black" points="19771.41,-2972.73 19781.36,-2969.09 19771.31,-2965.73 19771.41,-2972.73"/>
</g>
<!-- layer1_expert6_1&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge585" class="edge">
<title>layer1_expert6_1&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M18818.23,-3039.24C18821.17,-3038.41 18824.1,-3037.64 18827,-3036.95 19003.72,-2995.16 19537.22,-2976.77 19771.09,-2970.56"/>
<polygon fill="black" stroke="black" points="19771.42,-2974.05 19781.32,-2970.29 19771.23,-2967.05 19771.42,-2974.05"/>
</g>
<!-- layer1_expert6_2&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge586" class="edge">
<title>layer1_expert6_2&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19010.24,-3039.3C19013.18,-3038.45 19016.1,-3037.66 19019,-3036.95 19158.55,-3002.88 19570.54,-2981.25 19770.96,-2972.46"/>
<polygon fill="black" stroke="black" points="19771.39,-2975.94 19781.22,-2972.01 19771.08,-2968.95 19771.39,-2975.94"/>
</g>
<!-- layer1_expert6_3&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge587" class="edge">
<title>layer1_expert6_3&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19202.26,-3039.38C19205.19,-3038.51 19208.11,-3037.69 19211,-3036.95 19403.8,-2987.56 19636.29,-2973.33 19771.12,-2969.35"/>
<polygon fill="black" stroke="black" points="19771.56,-2972.84 19781.46,-2969.06 19771.37,-2965.84 19771.56,-2972.84"/>
</g>
<!-- layer1_expert6_4&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge588" class="edge">
<title>layer1_expert6_4&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19394.04,-3039.62C19397.04,-3038.67 19400.04,-3037.78 19403,-3036.95 19526.52,-3002.64 19672.92,-2984.73 19771.28,-2975.86"/>
<polygon fill="black" stroke="black" points="19771.59,-2979.34 19781.24,-2974.97 19770.97,-2972.37 19771.59,-2979.34"/>
</g>
<!-- layer1_expert6_5&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge589" class="edge">
<title>layer1_expert6_5&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19586.15,-3039.97C19589.12,-3038.92 19592.08,-3037.91 19595,-3036.95 19652.25,-3018.16 19717.45,-3002.11 19771.32,-2990.23"/>
<polygon fill="black" stroke="black" points="19772.22,-2993.62 19781.24,-2988.06 19770.72,-2986.78 19772.22,-2993.62"/>
</g>
<!-- layer1_expert6_6&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge590" class="edge">
<title>layer1_expert6_6&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19762.22,-3036.84C19779.85,-3026.78 19798.68,-3016.04 19816.1,-3006.11"/>
<polygon fill="black" stroke="black" points="19818.11,-3008.99 19825.06,-3001 19814.64,-3002.91 19818.11,-3008.99"/>
</g>
<!-- layer1_expert6_7&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge591" class="edge">
<title>layer1_expert6_7&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19883,-3036.68C19883,-3028.47 19883,-3019.81 19883,-3011.51"/>
<polygon fill="black" stroke="black" points="19886.5,-3011.25 19883,-3001.25 19879.5,-3011.25 19886.5,-3011.25"/>
</g>
<!-- layer1_expert6_8&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge592" class="edge">
<title>layer1_expert6_8&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20003.78,-3036.84C19986.15,-3026.78 19967.32,-3016.04 19949.9,-3006.11"/>
<polygon fill="black" stroke="black" points="19951.36,-3002.91 19940.94,-3001 19947.89,-3008.99 19951.36,-3002.91"/>
</g>
<!-- layer1_expert6_9&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge593" class="edge">
<title>layer1_expert6_9&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20179.85,-3039.97C20176.88,-3038.92 20173.92,-3037.91 20171,-3036.95 20113.75,-3018.16 20048.55,-3002.11 19994.68,-2990.23"/>
<polygon fill="black" stroke="black" points="19995.28,-2986.78 19984.76,-2988.06 19993.78,-2993.62 19995.28,-2986.78"/>
</g>
<!-- layer1_expert6_10&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge594" class="edge">
<title>layer1_expert6_10&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20371.96,-3039.62C20368.96,-3038.67 20365.96,-3037.78 20363,-3036.95 20239.48,-3002.64 20093.08,-2984.73 19994.72,-2975.86"/>
<polygon fill="black" stroke="black" points="19995.03,-2972.37 19984.76,-2974.97 19994.41,-2979.34 19995.03,-2972.37"/>
</g>
<!-- layer1_expert6_11&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge595" class="edge">
<title>layer1_expert6_11&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20563.74,-3039.38C20560.81,-3038.51 20557.89,-3037.69 20555,-3036.95 20362.2,-2987.56 20129.71,-2973.33 19994.88,-2969.35"/>
<polygon fill="black" stroke="black" points="19994.63,-2965.84 19984.54,-2969.06 19994.44,-2972.84 19994.63,-2965.84"/>
</g>
<!-- layer1_expert6_12&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge596" class="edge">
<title>layer1_expert6_12&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20755.76,-3039.3C20752.82,-3038.45 20749.9,-3037.66 20747,-3036.95 20607.45,-3002.88 20195.46,-2981.25 19995.04,-2972.46"/>
<polygon fill="black" stroke="black" points="19994.92,-2968.95 19984.78,-2972.01 19994.61,-2975.94 19994.92,-2968.95"/>
</g>
<!-- layer1_expert6_13&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge597" class="edge">
<title>layer1_expert6_13&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20947.77,-3039.24C20944.83,-3038.41 20941.9,-3037.64 20939,-3036.95 20762.28,-2995.16 20228.78,-2976.77 19994.91,-2970.56"/>
<polygon fill="black" stroke="black" points="19994.77,-2967.05 19984.68,-2970.29 19994.58,-2974.05 19994.77,-2967.05"/>
</g>
<!-- layer1_expert6_14&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge598" class="edge">
<title>layer1_expert6_14&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M21139.78,-3039.2C21136.84,-3038.38 21133.91,-3037.63 21131,-3036.95 20916.76,-2987.42 20259.56,-2973.07 19995.03,-2969.24"/>
<polygon fill="black" stroke="black" points="19994.69,-2965.73 19984.64,-2969.09 19994.59,-2972.73 19994.69,-2965.73"/>
</g>
<!-- layer1_expert6_15&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge599" class="edge">
<title>layer1_expert6_15&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M21331.79,-3039.17C21328.84,-3038.36 21325.91,-3037.62 21323,-3036.95 21070.87,-2979.63 20287.73,-2969.89 19994.95,-2968.27"/>
<polygon fill="black" stroke="black" points="19994.76,-2964.77 19984.75,-2968.21 19994.73,-2971.77 19994.76,-2964.77"/>
</g>
<!-- layer1_moe_agg_gpu6&#45;&gt;layer1_moe_allreduce -->
<g id="edge600" class="edge">
<title>layer1_moe_agg_gpu6&#45;&gt;layer1_moe_allreduce</title>
<path fill="none" stroke="black" d="M19781.17,-2964.13C18980.78,-2949.77 13701.68,-2855.11 12529.36,-2834.08"/>
<polygon fill="black" stroke="black" points="12529.2,-2830.58 12519.14,-2833.9 12529.07,-2837.58 12529.2,-2830.58"/>
</g>
<!-- layer1_output_gpu6 -->
<g id="node353" class="node">
<title>layer1_output_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="13076,-2724.95 12832,-2724.95 12832,-2656.95 13076,-2656.95 13076,-2724.95"/>
<text text-anchor="middle" x="12954" y="-2709.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU6</text>
<text text-anchor="middle" x="12954" y="-2694.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="12954" y="-2679.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12954" y="-2664.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_qkv_gpu6 -->
<g id="node392" class="node">
<title>layer2_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="13054,-2620.95 12854,-2620.95 12854,-2522.95 13054,-2522.95 13054,-2620.95"/>
<text text-anchor="middle" x="12954" y="-2605.75" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU6</text>
<text text-anchor="middle" x="12954" y="-2590.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12954" y="-2575.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12954" y="-2560.75" font-family="Times,serif" font-size="14.00">Heads: 24&#45;27</text>
<text text-anchor="middle" x="12954" y="-2545.75" font-family="Times,serif" font-size="14.00">TP Slice: 6</text>
<text text-anchor="middle" x="12954" y="-2530.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_output_gpu6&#45;&gt;layer2_qkv_gpu6 -->
<g id="edge647" class="edge">
<title>layer1_output_gpu6&#45;&gt;layer2_qkv_gpu6</title>
<path fill="none" stroke="black" d="M12954,-2656.74C12954,-2648.78 12954,-2640.04 12954,-2631.3"/>
<polygon fill="black" stroke="black" points="12957.5,-2631.1 12954,-2621.1 12950.5,-2631.1 12957.5,-2631.1"/>
</g>
<!-- layer1_expert7_0 -->
<g id="node355" class="node">
<title>layer1_expert7_0</title>
<polygon fill="lightgreen" stroke="black" points="21698,-3119.95 21524,-3119.95 21524,-3036.95 21698,-3036.95 21698,-3119.95"/>
<text text-anchor="middle" x="21611" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU7</text>
<text text-anchor="middle" x="21611" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21611" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21611" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21611" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_0 -->
<g id="edge607" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22832.82,-3194.19C22565.95,-3188.43 21937.25,-3170.07 21708.17,-3119.94"/>
<polygon fill="black" stroke="black" points="21708.75,-3116.48 21698.22,-3117.68 21707.2,-3123.31 21708.75,-3116.48"/>
</g>
<!-- layer1_expert7_1 -->
<g id="node356" class="node">
<title>layer1_expert7_1</title>
<polygon fill="lightgreen" stroke="black" points="21890,-3119.95 21716,-3119.95 21716,-3036.95 21890,-3036.95 21890,-3119.95"/>
<text text-anchor="middle" x="21803" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU7</text>
<text text-anchor="middle" x="21803" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21803" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21803" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21803" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_1 -->
<g id="edge608" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22832.92,-3192.61C22598.28,-3184.41 22091.38,-3162.58 21900.19,-3119.95"/>
<polygon fill="black" stroke="black" points="21900.77,-3116.49 21890.23,-3117.64 21899.19,-3123.31 21900.77,-3116.49"/>
</g>
<!-- layer1_expert7_2 -->
<g id="node357" class="node">
<title>layer1_expert7_2</title>
<polygon fill="lightgreen" stroke="black" points="22082,-3119.95 21908,-3119.95 21908,-3036.95 22082,-3036.95 22082,-3119.95"/>
<text text-anchor="middle" x="21995" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU7</text>
<text text-anchor="middle" x="21995" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21995" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21995" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21995" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_2 -->
<g id="edge609" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22832.77,-3190.32C22633.25,-3179.53 22245.31,-3155.15 22092,-3119.92"/>
<polygon fill="black" stroke="black" points="22092.79,-3116.5 22082.25,-3117.58 22091.16,-3123.31 22092.79,-3116.5"/>
</g>
<!-- layer1_expert7_3 -->
<g id="node358" class="node">
<title>layer1_expert7_3</title>
<polygon fill="lightgreen" stroke="black" points="22274,-3119.95 22100,-3119.95 22100,-3036.95 22274,-3036.95 22274,-3119.95"/>
<text text-anchor="middle" x="22187" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU7</text>
<text text-anchor="middle" x="22187" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22187" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22187" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22187" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_3 -->
<g id="edge610" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22832.91,-3193C22699.03,-3186.86 22478.46,-3169.79 22283.84,-3119.96"/>
<polygon fill="black" stroke="black" points="22284.57,-3116.53 22274.01,-3117.4 22282.81,-3123.3 22284.57,-3116.53"/>
</g>
<!-- layer1_expert7_4 -->
<g id="node359" class="node">
<title>layer1_expert7_4</title>
<polygon fill="lightgreen" stroke="black" points="22466,-3119.95 22292,-3119.95 22292,-3036.95 22466,-3036.95 22466,-3119.95"/>
<text text-anchor="middle" x="22379" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU7</text>
<text text-anchor="middle" x="22379" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22379" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22379" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22379" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_4 -->
<g id="edge611" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22832.91,-3185.21C22737.32,-3174.51 22601.37,-3155.09 22475.84,-3120"/>
<polygon fill="black" stroke="black" points="22476.63,-3116.59 22466.06,-3117.23 22474.72,-3123.32 22476.63,-3116.59"/>
</g>
<!-- layer1_expert7_5 -->
<g id="node360" class="node">
<title>layer1_expert7_5</title>
<polygon fill="lightgreen" stroke="black" points="22658,-3119.95 22484,-3119.95 22484,-3036.95 22658,-3036.95 22658,-3119.95"/>
<text text-anchor="middle" x="22571" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU7</text>
<text text-anchor="middle" x="22571" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22571" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22571" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22571" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_5 -->
<g id="edge612" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22832.66,-3167.97C22783.66,-3155.59 22726.72,-3139.96 22667.67,-3120.07"/>
<polygon fill="black" stroke="black" points="22668.77,-3116.75 22658.18,-3116.84 22666.52,-3123.37 22668.77,-3116.75"/>
</g>
<!-- layer1_expert7_6 -->
<g id="node361" class="node">
<title>layer1_expert7_6</title>
<polygon fill="lightgreen" stroke="black" points="22850,-3119.95 22676,-3119.95 22676,-3036.95 22850,-3036.95 22850,-3119.95"/>
<text text-anchor="middle" x="22763" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU7</text>
<text text-anchor="middle" x="22763" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22763" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22763" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22763" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_6 -->
<g id="edge613" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22888.39,-3155.86C22872.15,-3145.97 22854.68,-3135.32 22838.08,-3125.21"/>
<polygon fill="black" stroke="black" points="22839.86,-3122.19 22829.5,-3119.97 22836.21,-3128.17 22839.86,-3122.19"/>
</g>
<!-- layer1_expert7_7 -->
<g id="node362" class="node">
<title>layer1_expert7_7</title>
<polygon fill="lightgreen" stroke="black" points="23042,-3119.95 22868,-3119.95 22868,-3036.95 23042,-3036.95 23042,-3119.95"/>
<text text-anchor="middle" x="22955" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU7</text>
<text text-anchor="middle" x="22955" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22955" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22955" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22955" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_7 -->
<g id="edge614" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22955,-3155.86C22955,-3147.6 22955,-3138.82 22955,-3130.26"/>
<polygon fill="black" stroke="black" points="22958.5,-3129.97 22955,-3119.97 22951.5,-3129.97 22958.5,-3129.97"/>
</g>
<!-- layer1_expert7_8 -->
<g id="node363" class="node">
<title>layer1_expert7_8</title>
<polygon fill="lightgreen" stroke="black" points="23234,-3119.95 23060,-3119.95 23060,-3036.95 23234,-3036.95 23234,-3119.95"/>
<text text-anchor="middle" x="23147" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU7</text>
<text text-anchor="middle" x="23147" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23147" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23147" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23147" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_8 -->
<g id="edge615" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23021.61,-3155.86C23037.85,-3145.97 23055.32,-3135.32 23071.92,-3125.21"/>
<polygon fill="black" stroke="black" points="23073.79,-3128.17 23080.5,-3119.97 23070.14,-3122.19 23073.79,-3128.17"/>
</g>
<!-- layer1_expert7_9 -->
<g id="node364" class="node">
<title>layer1_expert7_9</title>
<polygon fill="lightgreen" stroke="black" points="23426,-3119.95 23252,-3119.95 23252,-3036.95 23426,-3036.95 23426,-3119.95"/>
<text text-anchor="middle" x="23339" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU7</text>
<text text-anchor="middle" x="23339" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23339" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23339" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23339" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_9 -->
<g id="edge616" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23077.34,-3167.97C23126.34,-3155.59 23183.28,-3139.96 23242.33,-3120.07"/>
<polygon fill="black" stroke="black" points="23243.48,-3123.37 23251.82,-3116.84 23241.23,-3116.75 23243.48,-3123.37"/>
</g>
<!-- layer1_expert7_10 -->
<g id="node365" class="node">
<title>layer1_expert7_10</title>
<polygon fill="lightgreen" stroke="black" points="23618,-3119.95 23444,-3119.95 23444,-3036.95 23618,-3036.95 23618,-3119.95"/>
<text text-anchor="middle" x="23531" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU7</text>
<text text-anchor="middle" x="23531" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23531" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23531" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23531" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_10 -->
<g id="edge617" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23077.09,-3185.21C23172.68,-3174.51 23308.63,-3155.09 23434.16,-3120"/>
<polygon fill="black" stroke="black" points="23435.28,-3123.32 23443.94,-3117.23 23433.37,-3116.59 23435.28,-3123.32"/>
</g>
<!-- layer1_expert7_11 -->
<g id="node366" class="node">
<title>layer1_expert7_11</title>
<polygon fill="lightgreen" stroke="black" points="23810,-3119.95 23636,-3119.95 23636,-3036.95 23810,-3036.95 23810,-3119.95"/>
<text text-anchor="middle" x="23723" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU7</text>
<text text-anchor="middle" x="23723" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23723" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23723" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23723" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_11 -->
<g id="edge618" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23077.09,-3193C23210.97,-3186.86 23431.54,-3169.79 23626.16,-3119.96"/>
<polygon fill="black" stroke="black" points="23627.19,-3123.3 23635.99,-3117.4 23625.43,-3116.53 23627.19,-3123.3"/>
</g>
<!-- layer1_expert7_12 -->
<g id="node367" class="node">
<title>layer1_expert7_12</title>
<polygon fill="lightgreen" stroke="black" points="24002,-3119.95 23828,-3119.95 23828,-3036.95 24002,-3036.95 24002,-3119.95"/>
<text text-anchor="middle" x="23915" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU7</text>
<text text-anchor="middle" x="23915" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23915" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23915" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23915" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_12 -->
<g id="edge619" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23077.23,-3190.32C23276.75,-3179.53 23664.69,-3155.15 23818,-3119.92"/>
<polygon fill="black" stroke="black" points="23818.84,-3123.31 23827.75,-3117.58 23817.21,-3116.5 23818.84,-3123.31"/>
</g>
<!-- layer1_expert7_13 -->
<g id="node368" class="node">
<title>layer1_expert7_13</title>
<polygon fill="lightgreen" stroke="black" points="24194,-3119.95 24020,-3119.95 24020,-3036.95 24194,-3036.95 24194,-3119.95"/>
<text text-anchor="middle" x="24107" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU7</text>
<text text-anchor="middle" x="24107" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24107" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24107" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24107" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_13 -->
<g id="edge620" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23077.08,-3192.61C23311.72,-3184.41 23818.62,-3162.58 24009.81,-3119.95"/>
<polygon fill="black" stroke="black" points="24010.81,-3123.31 24019.77,-3117.64 24009.23,-3116.49 24010.81,-3123.31"/>
</g>
<!-- layer1_expert7_14 -->
<g id="node369" class="node">
<title>layer1_expert7_14</title>
<polygon fill="lightgreen" stroke="black" points="24386,-3119.95 24212,-3119.95 24212,-3036.95 24386,-3036.95 24386,-3119.95"/>
<text text-anchor="middle" x="24299" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU7</text>
<text text-anchor="middle" x="24299" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24299" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24299" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24299" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_14 -->
<g id="edge621" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23077.18,-3194.19C23344.05,-3188.43 23972.75,-3170.07 24201.83,-3119.94"/>
<polygon fill="black" stroke="black" points="24202.8,-3123.31 24211.78,-3117.68 24201.25,-3116.48 24202.8,-3123.31"/>
</g>
<!-- layer1_expert7_15 -->
<g id="node370" class="node">
<title>layer1_expert7_15</title>
<polygon fill="lightgreen" stroke="black" points="24578,-3119.95 24404,-3119.95 24404,-3036.95 24578,-3036.95 24578,-3119.95"/>
<text text-anchor="middle" x="24491" y="-3104.75" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU7</text>
<text text-anchor="middle" x="24491" y="-3089.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24491" y="-3074.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24491" y="-3059.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24491" y="-3044.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_15 -->
<g id="edge622" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23077.2,-3195.37C23373.79,-3191.87 24126.41,-3177.65 24393.71,-3119.96"/>
<polygon fill="black" stroke="black" points="24394.78,-3123.31 24403.78,-3117.71 24393.26,-3116.48 24394.78,-3123.31"/>
</g>
<!-- layer1_moe_agg_gpu7 -->
<g id="node371" class="node">
<title>layer1_moe_agg_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="23056.5,-3000.95 22853.5,-3000.95 22853.5,-2932.95 23056.5,-2932.95 23056.5,-3000.95"/>
<text text-anchor="middle" x="22955" y="-2985.75" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU7</text>
<text text-anchor="middle" x="22955" y="-2970.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="22955" y="-2955.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="22955" y="-2940.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_expert7_0&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge623" class="edge">
<title>layer1_expert7_0&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M21698.22,-3039.2C21701.16,-3038.38 21704.09,-3037.63 21707,-3036.95 21921.24,-2987.42 22578.44,-2973.07 22842.97,-2969.24"/>
<polygon fill="black" stroke="black" points="22843.41,-2972.73 22853.36,-2969.09 22843.31,-2965.73 22843.41,-2972.73"/>
</g>
<!-- layer1_expert7_1&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge624" class="edge">
<title>layer1_expert7_1&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M21890.23,-3039.24C21893.17,-3038.41 21896.1,-3037.64 21899,-3036.95 22075.72,-2995.16 22609.22,-2976.77 22843.09,-2970.56"/>
<polygon fill="black" stroke="black" points="22843.42,-2974.05 22853.32,-2970.29 22843.23,-2967.05 22843.42,-2974.05"/>
</g>
<!-- layer1_expert7_2&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge625" class="edge">
<title>layer1_expert7_2&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22082.24,-3039.3C22085.18,-3038.45 22088.1,-3037.66 22091,-3036.95 22230.55,-3002.88 22642.54,-2981.25 22842.96,-2972.46"/>
<polygon fill="black" stroke="black" points="22843.39,-2975.94 22853.22,-2972.01 22843.08,-2968.95 22843.39,-2975.94"/>
</g>
<!-- layer1_expert7_3&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge626" class="edge">
<title>layer1_expert7_3&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22274.26,-3039.38C22277.19,-3038.51 22280.11,-3037.69 22283,-3036.95 22475.8,-2987.56 22708.29,-2973.33 22843.12,-2969.35"/>
<polygon fill="black" stroke="black" points="22843.56,-2972.84 22853.46,-2969.06 22843.37,-2965.84 22843.56,-2972.84"/>
</g>
<!-- layer1_expert7_4&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge627" class="edge">
<title>layer1_expert7_4&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22466.04,-3039.62C22469.04,-3038.67 22472.04,-3037.78 22475,-3036.95 22598.52,-3002.64 22744.92,-2984.73 22843.28,-2975.86"/>
<polygon fill="black" stroke="black" points="22843.59,-2979.34 22853.24,-2974.97 22842.97,-2972.37 22843.59,-2979.34"/>
</g>
<!-- layer1_expert7_5&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge628" class="edge">
<title>layer1_expert7_5&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22658.15,-3039.97C22661.12,-3038.92 22664.08,-3037.91 22667,-3036.95 22724.25,-3018.16 22789.45,-3002.11 22843.32,-2990.23"/>
<polygon fill="black" stroke="black" points="22844.22,-2993.62 22853.24,-2988.06 22842.72,-2986.78 22844.22,-2993.62"/>
</g>
<!-- layer1_expert7_6&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge629" class="edge">
<title>layer1_expert7_6&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22834.22,-3036.84C22851.85,-3026.78 22870.68,-3016.04 22888.1,-3006.11"/>
<polygon fill="black" stroke="black" points="22890.11,-3008.99 22897.06,-3001 22886.64,-3002.91 22890.11,-3008.99"/>
</g>
<!-- layer1_expert7_7&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge630" class="edge">
<title>layer1_expert7_7&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22955,-3036.68C22955,-3028.47 22955,-3019.81 22955,-3011.51"/>
<polygon fill="black" stroke="black" points="22958.5,-3011.25 22955,-3001.25 22951.5,-3011.25 22958.5,-3011.25"/>
</g>
<!-- layer1_expert7_8&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge631" class="edge">
<title>layer1_expert7_8&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23075.78,-3036.84C23058.15,-3026.78 23039.32,-3016.04 23021.9,-3006.11"/>
<polygon fill="black" stroke="black" points="23023.36,-3002.91 23012.94,-3001 23019.89,-3008.99 23023.36,-3002.91"/>
</g>
<!-- layer1_expert7_9&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge632" class="edge">
<title>layer1_expert7_9&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23251.85,-3039.97C23248.88,-3038.92 23245.92,-3037.91 23243,-3036.95 23185.75,-3018.16 23120.55,-3002.11 23066.68,-2990.23"/>
<polygon fill="black" stroke="black" points="23067.28,-2986.78 23056.76,-2988.06 23065.78,-2993.62 23067.28,-2986.78"/>
</g>
<!-- layer1_expert7_10&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge633" class="edge">
<title>layer1_expert7_10&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23443.96,-3039.62C23440.96,-3038.67 23437.96,-3037.78 23435,-3036.95 23311.48,-3002.64 23165.08,-2984.73 23066.72,-2975.86"/>
<polygon fill="black" stroke="black" points="23067.03,-2972.37 23056.76,-2974.97 23066.41,-2979.34 23067.03,-2972.37"/>
</g>
<!-- layer1_expert7_11&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge634" class="edge">
<title>layer1_expert7_11&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23635.74,-3039.38C23632.81,-3038.51 23629.89,-3037.69 23627,-3036.95 23434.2,-2987.56 23201.71,-2973.33 23066.88,-2969.35"/>
<polygon fill="black" stroke="black" points="23066.63,-2965.84 23056.54,-2969.06 23066.44,-2972.84 23066.63,-2965.84"/>
</g>
<!-- layer1_expert7_12&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge635" class="edge">
<title>layer1_expert7_12&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23827.76,-3039.3C23824.82,-3038.45 23821.9,-3037.66 23819,-3036.95 23679.45,-3002.88 23267.46,-2981.25 23067.04,-2972.46"/>
<polygon fill="black" stroke="black" points="23066.92,-2968.95 23056.78,-2972.01 23066.61,-2975.94 23066.92,-2968.95"/>
</g>
<!-- layer1_expert7_13&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge636" class="edge">
<title>layer1_expert7_13&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M24019.77,-3039.24C24016.83,-3038.41 24013.9,-3037.64 24011,-3036.95 23834.28,-2995.16 23300.78,-2976.77 23066.91,-2970.56"/>
<polygon fill="black" stroke="black" points="23066.77,-2967.05 23056.68,-2970.29 23066.58,-2974.05 23066.77,-2967.05"/>
</g>
<!-- layer1_expert7_14&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge637" class="edge">
<title>layer1_expert7_14&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M24211.78,-3039.2C24208.84,-3038.38 24205.91,-3037.63 24203,-3036.95 23988.76,-2987.42 23331.56,-2973.07 23067.03,-2969.24"/>
<polygon fill="black" stroke="black" points="23066.69,-2965.73 23056.64,-2969.09 23066.59,-2972.73 23066.69,-2965.73"/>
</g>
<!-- layer1_expert7_15&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge638" class="edge">
<title>layer1_expert7_15&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M24403.79,-3039.17C24400.84,-3038.36 24397.91,-3037.62 24395,-3036.95 24142.87,-2979.63 23359.73,-2969.89 23066.95,-2968.27"/>
<polygon fill="black" stroke="black" points="23066.76,-2964.77 23056.75,-2968.21 23066.73,-2971.77 23066.76,-2964.77"/>
</g>
<!-- layer1_moe_agg_gpu7&#45;&gt;layer1_moe_allreduce -->
<g id="edge639" class="edge">
<title>layer1_moe_agg_gpu7&#45;&gt;layer1_moe_allreduce</title>
<path fill="none" stroke="black" d="M22853.37,-2964.66C21866.7,-2952.06 13996.54,-2851.62 12532.86,-2832.94"/>
<polygon fill="black" stroke="black" points="12532.8,-2829.44 12522.75,-2832.81 12532.71,-2836.44 12532.8,-2829.44"/>
</g>
<!-- layer1_output_gpu7 -->
<g id="node372" class="node">
<title>layer1_output_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="13338,-2724.95 13094,-2724.95 13094,-2656.95 13338,-2656.95 13338,-2724.95"/>
<text text-anchor="middle" x="13216" y="-2709.75" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU7</text>
<text text-anchor="middle" x="13216" y="-2694.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="13216" y="-2679.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="13216" y="-2664.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_qkv_gpu7 -->
<g id="node395" class="node">
<title>layer2_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="13315,-2620.95 13115,-2620.95 13115,-2522.95 13315,-2522.95 13315,-2620.95"/>
<text text-anchor="middle" x="13215" y="-2605.75" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU7</text>
<text text-anchor="middle" x="13215" y="-2590.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="13215" y="-2575.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="13215" y="-2560.75" font-family="Times,serif" font-size="14.00">Heads: 28&#45;31</text>
<text text-anchor="middle" x="13215" y="-2545.75" font-family="Times,serif" font-size="14.00">TP Slice: 7</text>
<text text-anchor="middle" x="13215" y="-2530.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_output_gpu7&#45;&gt;layer2_qkv_gpu7 -->
<g id="edge648" class="edge">
<title>layer1_output_gpu7&#45;&gt;layer2_qkv_gpu7</title>
<path fill="none" stroke="black" d="M13215.72,-2656.74C13215.65,-2648.78 13215.57,-2640.04 13215.5,-2631.3"/>
<polygon fill="black" stroke="black" points="13219,-2631.07 13215.41,-2621.1 13212,-2631.13 13219,-2631.07"/>
</g>
<!-- layer1_moe_allreduce&#45;&gt;layer1_output_gpu0 -->
<g id="edge367" class="edge">
<title>layer1_moe_allreduce&#45;&gt;layer1_output_gpu0</title>
<path fill="none" stroke="black" d="M12124.41,-2810.97C11966.93,-2794.28 11729.03,-2765.66 11514.17,-2725.11"/>
<polygon fill="black" stroke="black" points="11514.75,-2721.66 11504.28,-2723.23 11513.45,-2728.54 11514.75,-2721.66"/>
</g>
<!-- layer1_moe_allreduce&#45;&gt;layer1_output_gpu1 -->
<g id="edge406" class="edge">
<title>layer1_moe_allreduce&#45;&gt;layer1_output_gpu1</title>
<path fill="none" stroke="black" d="M12155.96,-2801.94C12052.96,-2782.71 11910.51,-2755.1 11776.38,-2725.23"/>
<polygon fill="black" stroke="black" points="11776.85,-2721.75 11766.33,-2722.99 11775.32,-2728.58 11776.85,-2721.75"/>
</g>
<!-- layer1_moe_allreduce&#45;&gt;layer1_output_gpu2 -->
<g id="edge445" class="edge">
<title>layer1_moe_allreduce&#45;&gt;layer1_output_gpu2</title>
<path fill="none" stroke="black" d="M12192.91,-2791.24C12136.5,-2771.72 12067.37,-2747.8 12011.11,-2728.33"/>
<polygon fill="black" stroke="black" points="12012.07,-2724.96 12001.48,-2724.99 12009.78,-2731.57 12012.07,-2724.96"/>
</g>
<!-- layer1_moe_allreduce&#45;&gt;layer1_output_gpu3 -->
<g id="edge484" class="edge">
<title>layer1_moe_allreduce&#45;&gt;layer1_output_gpu3</title>
<path fill="none" stroke="black" d="M12248.35,-2775.37C12234.62,-2761.12 12219.97,-2745.91 12207,-2732.44"/>
<polygon fill="black" stroke="black" points="12209.43,-2729.92 12199.97,-2725.15 12204.39,-2734.78 12209.43,-2729.92"/>
</g>
<!-- layer1_moe_allreduce&#45;&gt;layer1_output_gpu4 -->
<g id="edge523" class="edge">
<title>layer1_moe_allreduce&#45;&gt;layer1_output_gpu4</title>
<path fill="none" stroke="black" d="M12349.65,-2775.37C12363.38,-2761.12 12378.03,-2745.91 12391,-2732.44"/>
<polygon fill="black" stroke="black" points="12393.61,-2734.78 12398.03,-2725.15 12388.57,-2729.92 12393.61,-2734.78"/>
</g>
<!-- layer1_moe_allreduce&#45;&gt;layer1_output_gpu5 -->
<g id="edge562" class="edge">
<title>layer1_moe_allreduce&#45;&gt;layer1_output_gpu5</title>
<path fill="none" stroke="black" d="M12405.09,-2791.24C12461.5,-2771.72 12530.63,-2747.8 12586.89,-2728.33"/>
<polygon fill="black" stroke="black" points="12588.22,-2731.57 12596.52,-2724.99 12585.93,-2724.96 12588.22,-2731.57"/>
</g>
<!-- layer1_moe_allreduce&#45;&gt;layer1_output_gpu6 -->
<g id="edge601" class="edge">
<title>layer1_moe_allreduce&#45;&gt;layer1_output_gpu6</title>
<path fill="none" stroke="black" d="M12442.04,-2801.94C12545.04,-2782.71 12687.49,-2755.1 12821.62,-2725.23"/>
<polygon fill="black" stroke="black" points="12822.68,-2728.58 12831.67,-2722.99 12821.15,-2721.75 12822.68,-2728.58"/>
</g>
<!-- layer1_moe_allreduce&#45;&gt;layer1_output_gpu7 -->
<g id="edge640" class="edge">
<title>layer1_moe_allreduce&#45;&gt;layer1_output_gpu7</title>
<path fill="none" stroke="black" d="M12473.59,-2810.97C12631.07,-2794.28 12868.97,-2765.66 13083.83,-2725.11"/>
<polygon fill="black" stroke="black" points="13084.55,-2728.54 13093.72,-2723.23 13083.25,-2721.66 13084.55,-2728.54"/>
</g>
<!-- layer2_attn_gpu0 -->
<g id="node375" class="node">
<title>layer2_attn_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="11505.5,-2486.95 11262.5,-2486.95 11262.5,-2418.95 11505.5,-2418.95 11505.5,-2486.95"/>
<text text-anchor="middle" x="11384" y="-2471.75" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU0</text>
<text text-anchor="middle" x="11384" y="-2456.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11384" y="-2441.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11384" y="-2426.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_qkv_gpu0&#45;&gt;layer2_attn_gpu0 -->
<g id="edge649" class="edge">
<title>layer2_qkv_gpu0&#45;&gt;layer2_attn_gpu0</title>
<path fill="none" stroke="black" d="M11383.41,-2522.69C11383.48,-2514.28 11383.56,-2505.58 11383.63,-2497.31"/>
<polygon fill="black" stroke="black" points="11387.13,-2497.16 11383.72,-2487.13 11380.13,-2497.1 11387.13,-2497.16"/>
</g>
<!-- layer2_attn_proj_gpu0 -->
<g id="node376" class="node">
<title>layer2_attn_proj_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="11539,-2382.95 11339,-2382.95 11339,-2314.95 11539,-2314.95 11539,-2382.95"/>
<text text-anchor="middle" x="11439" y="-2367.75" font-family="Times,serif" font-size="14.00">L2_Attn_Projection_GPU0</text>
<text text-anchor="middle" x="11439" y="-2352.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11439" y="-2337.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11439" y="-2322.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_attn_gpu0&#45;&gt;layer2_attn_proj_gpu0 -->
<g id="edge650" class="edge">
<title>layer2_attn_gpu0&#45;&gt;layer2_attn_proj_gpu0</title>
<path fill="none" stroke="black" d="M11401.86,-2418.84C11406.42,-2410.37 11411.39,-2401.16 11416.16,-2392.31"/>
<polygon fill="black" stroke="black" points="11419.38,-2393.72 11421.04,-2383.25 11413.22,-2390.39 11419.38,-2393.72"/>
</g>
<!-- layer2_attn_allreduce -->
<g id="node398" class="node">
<title>layer2_attn_allreduce</title>
<polygon fill="lightcoral" stroke="black" points="12288,-2278.95 12051,-2210.95 12288,-2142.95 12525,-2210.95 12288,-2278.95"/>
<text text-anchor="middle" x="12288" y="-2229.75" font-family="Times,serif" font-size="14.00">L2_Attention_All&#45;Reduce</text>
<text text-anchor="middle" x="12288" y="-2214.75" font-family="Times,serif" font-size="14.00">Input: 8×[1024,2048,512]</text>
<text text-anchor="middle" x="12288" y="-2199.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12288" y="-2184.75" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce across GPUs 0&#45;7</text>
</g>
<!-- layer2_attn_proj_gpu0&#45;&gt;layer2_attn_allreduce -->
<g id="edge651" class="edge">
<title>layer2_attn_proj_gpu0&#45;&gt;layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M11539.18,-2321.39C11549.22,-2319.07 11559.29,-2316.88 11569,-2314.95 11752.2,-2278.69 11964.06,-2249.91 12110.11,-2232.09"/>
<polygon fill="black" stroke="black" points="12110.57,-2235.56 12120.07,-2230.88 12109.72,-2228.62 12110.57,-2235.56"/>
</g>
<!-- layer2_attn_gpu1 -->
<g id="node378" class="node">
<title>layer2_attn_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11767.5,-2486.95 11524.5,-2486.95 11524.5,-2418.95 11767.5,-2418.95 11767.5,-2486.95"/>
<text text-anchor="middle" x="11646" y="-2471.75" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU1</text>
<text text-anchor="middle" x="11646" y="-2456.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11646" y="-2441.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11646" y="-2426.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_qkv_gpu1&#45;&gt;layer2_attn_gpu1 -->
<g id="edge688" class="edge">
<title>layer2_qkv_gpu1&#45;&gt;layer2_attn_gpu1</title>
<path fill="none" stroke="black" d="M11645.41,-2522.69C11645.48,-2514.28 11645.56,-2505.58 11645.63,-2497.31"/>
<polygon fill="black" stroke="black" points="11649.13,-2497.16 11645.72,-2487.13 11642.13,-2497.1 11649.13,-2497.16"/>
</g>
<!-- layer2_attn_proj_gpu1 -->
<g id="node379" class="node">
<title>layer2_attn_proj_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11778,-2382.95 11578,-2382.95 11578,-2314.95 11778,-2314.95 11778,-2382.95"/>
<text text-anchor="middle" x="11678" y="-2367.75" font-family="Times,serif" font-size="14.00">L2_Attn_Projection_GPU1</text>
<text text-anchor="middle" x="11678" y="-2352.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11678" y="-2337.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11678" y="-2322.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_attn_gpu1&#45;&gt;layer2_attn_proj_gpu1 -->
<g id="edge689" class="edge">
<title>layer2_attn_gpu1&#45;&gt;layer2_attn_proj_gpu1</title>
<path fill="none" stroke="black" d="M11656.39,-2418.84C11658.99,-2410.55 11661.81,-2401.55 11664.54,-2392.86"/>
<polygon fill="black" stroke="black" points="11667.9,-2393.84 11667.55,-2383.25 11661.22,-2391.75 11667.9,-2393.84"/>
</g>
<!-- layer2_attn_proj_gpu1&#45;&gt;layer2_attn_allreduce -->
<g id="edge690" class="edge">
<title>layer2_attn_proj_gpu1&#45;&gt;layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M11778.05,-2325.65C11878.38,-2303.28 12033.79,-2268.63 12146.68,-2243.46"/>
<polygon fill="black" stroke="black" points="12147.45,-2246.88 12156.45,-2241.28 12145.92,-2240.04 12147.45,-2246.88"/>
</g>
<!-- layer2_attn_gpu2 -->
<g id="node381" class="node">
<title>layer2_attn_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="12028.5,-2486.95 11785.5,-2486.95 11785.5,-2418.95 12028.5,-2418.95 12028.5,-2486.95"/>
<text text-anchor="middle" x="11907" y="-2471.75" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU2</text>
<text text-anchor="middle" x="11907" y="-2456.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11907" y="-2441.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11907" y="-2426.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_qkv_gpu2&#45;&gt;layer2_attn_gpu2 -->
<g id="edge727" class="edge">
<title>layer2_qkv_gpu2&#45;&gt;layer2_attn_gpu2</title>
<path fill="none" stroke="black" d="M11907,-2522.69C11907,-2514.28 11907,-2505.58 11907,-2497.31"/>
<polygon fill="black" stroke="black" points="11910.5,-2497.13 11907,-2487.13 11903.5,-2497.13 11910.5,-2497.13"/>
</g>
<!-- layer2_attn_proj_gpu2 -->
<g id="node382" class="node">
<title>layer2_attn_proj_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="12040,-2382.95 11840,-2382.95 11840,-2314.95 12040,-2314.95 12040,-2382.95"/>
<text text-anchor="middle" x="11940" y="-2367.75" font-family="Times,serif" font-size="14.00">L2_Attn_Projection_GPU2</text>
<text text-anchor="middle" x="11940" y="-2352.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11940" y="-2337.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11940" y="-2322.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_attn_gpu2&#45;&gt;layer2_attn_proj_gpu2 -->
<g id="edge728" class="edge">
<title>layer2_attn_gpu2&#45;&gt;layer2_attn_proj_gpu2</title>
<path fill="none" stroke="black" d="M11917.71,-2418.84C11920.39,-2410.55 11923.31,-2401.55 11926.12,-2392.86"/>
<polygon fill="black" stroke="black" points="11929.48,-2393.84 11929.23,-2383.25 11922.82,-2391.69 11929.48,-2393.84"/>
</g>
<!-- layer2_attn_proj_gpu2&#45;&gt;layer2_attn_allreduce -->
<g id="edge729" class="edge">
<title>layer2_attn_proj_gpu2&#45;&gt;layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M12024.69,-2314.86C12071.28,-2296.65 12129.59,-2273.86 12179.49,-2254.36"/>
<polygon fill="black" stroke="black" points="12180.98,-2257.53 12189.02,-2250.63 12178.44,-2251.01 12180.98,-2257.53"/>
</g>
<!-- layer2_attn_gpu3 -->
<g id="node384" class="node">
<title>layer2_attn_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="12289.5,-2486.95 12046.5,-2486.95 12046.5,-2418.95 12289.5,-2418.95 12289.5,-2486.95"/>
<text text-anchor="middle" x="12168" y="-2471.75" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU3</text>
<text text-anchor="middle" x="12168" y="-2456.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12168" y="-2441.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12168" y="-2426.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_qkv_gpu3&#45;&gt;layer2_attn_gpu3 -->
<g id="edge766" class="edge">
<title>layer2_qkv_gpu3&#45;&gt;layer2_attn_gpu3</title>
<path fill="none" stroke="black" d="M12168,-2522.69C12168,-2514.28 12168,-2505.58 12168,-2497.31"/>
<polygon fill="black" stroke="black" points="12171.5,-2497.13 12168,-2487.13 12164.5,-2497.13 12171.5,-2497.13"/>
</g>
<!-- layer2_attn_proj_gpu3 -->
<g id="node385" class="node">
<title>layer2_attn_proj_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="12279,-2382.95 12079,-2382.95 12079,-2314.95 12279,-2314.95 12279,-2382.95"/>
<text text-anchor="middle" x="12179" y="-2367.75" font-family="Times,serif" font-size="14.00">L2_Attn_Projection_GPU3</text>
<text text-anchor="middle" x="12179" y="-2352.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12179" y="-2337.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12179" y="-2322.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_attn_gpu3&#45;&gt;layer2_attn_proj_gpu3 -->
<g id="edge767" class="edge">
<title>layer2_attn_gpu3&#45;&gt;layer2_attn_proj_gpu3</title>
<path fill="none" stroke="black" d="M12171.57,-2418.84C12172.45,-2410.73 12173.39,-2401.94 12174.31,-2393.43"/>
<polygon fill="black" stroke="black" points="12177.82,-2393.57 12175.41,-2383.25 12170.86,-2392.82 12177.82,-2393.57"/>
</g>
<!-- layer2_attn_proj_gpu3&#45;&gt;layer2_attn_allreduce -->
<g id="edge768" class="edge">
<title>layer2_attn_proj_gpu3&#45;&gt;layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M12205.66,-2314.68C12215.36,-2302.59 12226.66,-2288.49 12237.73,-2274.68"/>
<polygon fill="black" stroke="black" points="12240.68,-2276.59 12244.2,-2266.6 12235.22,-2272.22 12240.68,-2276.59"/>
</g>
<!-- layer2_attn_gpu4 -->
<g id="node387" class="node">
<title>layer2_attn_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="12550.5,-2486.95 12307.5,-2486.95 12307.5,-2418.95 12550.5,-2418.95 12550.5,-2486.95"/>
<text text-anchor="middle" x="12429" y="-2471.75" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU4</text>
<text text-anchor="middle" x="12429" y="-2456.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12429" y="-2441.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12429" y="-2426.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_qkv_gpu4&#45;&gt;layer2_attn_gpu4 -->
<g id="edge805" class="edge">
<title>layer2_qkv_gpu4&#45;&gt;layer2_attn_gpu4</title>
<path fill="none" stroke="black" d="M12429,-2522.69C12429,-2514.28 12429,-2505.58 12429,-2497.31"/>
<polygon fill="black" stroke="black" points="12432.5,-2497.13 12429,-2487.13 12425.5,-2497.13 12432.5,-2497.13"/>
</g>
<!-- layer2_attn_proj_gpu4 -->
<g id="node388" class="node">
<title>layer2_attn_proj_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="12518,-2382.95 12318,-2382.95 12318,-2314.95 12518,-2314.95 12518,-2382.95"/>
<text text-anchor="middle" x="12418" y="-2367.75" font-family="Times,serif" font-size="14.00">L2_Attn_Projection_GPU4</text>
<text text-anchor="middle" x="12418" y="-2352.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12418" y="-2337.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12418" y="-2322.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_attn_gpu4&#45;&gt;layer2_attn_proj_gpu4 -->
<g id="edge806" class="edge">
<title>layer2_attn_gpu4&#45;&gt;layer2_attn_proj_gpu4</title>
<path fill="none" stroke="black" d="M12425.43,-2418.84C12424.55,-2410.73 12423.61,-2401.94 12422.69,-2393.43"/>
<polygon fill="black" stroke="black" points="12426.14,-2392.82 12421.59,-2383.25 12419.18,-2393.57 12426.14,-2392.82"/>
</g>
<!-- layer2_attn_proj_gpu4&#45;&gt;layer2_attn_allreduce -->
<g id="edge807" class="edge">
<title>layer2_attn_proj_gpu4&#45;&gt;layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M12386.2,-2314.68C12373.97,-2301.89 12359.6,-2286.86 12345.69,-2272.3"/>
<polygon fill="black" stroke="black" points="12347.91,-2269.56 12338.47,-2264.75 12342.85,-2274.4 12347.91,-2269.56"/>
</g>
<!-- layer2_attn_gpu5 -->
<g id="node390" class="node">
<title>layer2_attn_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12812.5,-2486.95 12569.5,-2486.95 12569.5,-2418.95 12812.5,-2418.95 12812.5,-2486.95"/>
<text text-anchor="middle" x="12691" y="-2471.75" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU5</text>
<text text-anchor="middle" x="12691" y="-2456.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12691" y="-2441.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12691" y="-2426.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_qkv_gpu5&#45;&gt;layer2_attn_gpu5 -->
<g id="edge844" class="edge">
<title>layer2_qkv_gpu5&#45;&gt;layer2_attn_gpu5</title>
<path fill="none" stroke="black" d="M12691,-2522.69C12691,-2514.28 12691,-2505.58 12691,-2497.31"/>
<polygon fill="black" stroke="black" points="12694.5,-2497.13 12691,-2487.13 12687.5,-2497.13 12694.5,-2497.13"/>
</g>
<!-- layer2_attn_proj_gpu5 -->
<g id="node391" class="node">
<title>layer2_attn_proj_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12768,-2382.95 12568,-2382.95 12568,-2314.95 12768,-2314.95 12768,-2382.95"/>
<text text-anchor="middle" x="12668" y="-2367.75" font-family="Times,serif" font-size="14.00">L2_Attn_Projection_GPU5</text>
<text text-anchor="middle" x="12668" y="-2352.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12668" y="-2337.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12668" y="-2322.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_attn_gpu5&#45;&gt;layer2_attn_proj_gpu5 -->
<g id="edge845" class="edge">
<title>layer2_attn_gpu5&#45;&gt;layer2_attn_proj_gpu5</title>
<path fill="none" stroke="black" d="M12683.53,-2418.84C12681.68,-2410.64 12679.68,-2401.74 12677.74,-2393.15"/>
<polygon fill="black" stroke="black" points="12681.12,-2392.24 12675.51,-2383.25 12674.29,-2393.78 12681.12,-2392.24"/>
</g>
<!-- layer2_attn_proj_gpu5&#45;&gt;layer2_attn_allreduce -->
<g id="edge846" class="edge">
<title>layer2_attn_proj_gpu5&#45;&gt;layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M12575.53,-2314.86C12523.09,-2296.09 12457.05,-2272.46 12401.5,-2252.57"/>
<polygon fill="black" stroke="black" points="12402.56,-2249.24 12391.96,-2249.16 12400.2,-2255.83 12402.56,-2249.24"/>
</g>
<!-- layer2_attn_gpu6 -->
<g id="node393" class="node">
<title>layer2_attn_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="13074.5,-2486.95 12831.5,-2486.95 12831.5,-2418.95 13074.5,-2418.95 13074.5,-2486.95"/>
<text text-anchor="middle" x="12953" y="-2471.75" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU6</text>
<text text-anchor="middle" x="12953" y="-2456.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12953" y="-2441.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12953" y="-2426.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_qkv_gpu6&#45;&gt;layer2_attn_gpu6 -->
<g id="edge883" class="edge">
<title>layer2_qkv_gpu6&#45;&gt;layer2_attn_gpu6</title>
<path fill="none" stroke="black" d="M12953.59,-2522.69C12953.52,-2514.28 12953.44,-2505.58 12953.37,-2497.31"/>
<polygon fill="black" stroke="black" points="12956.87,-2497.1 12953.28,-2487.13 12949.87,-2497.16 12956.87,-2497.1"/>
</g>
<!-- layer2_attn_proj_gpu6 -->
<g id="node394" class="node">
<title>layer2_attn_proj_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="13024,-2382.95 12824,-2382.95 12824,-2314.95 13024,-2314.95 13024,-2382.95"/>
<text text-anchor="middle" x="12924" y="-2367.75" font-family="Times,serif" font-size="14.00">L2_Attn_Projection_GPU6</text>
<text text-anchor="middle" x="12924" y="-2352.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12924" y="-2337.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12924" y="-2322.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_attn_gpu6&#45;&gt;layer2_attn_proj_gpu6 -->
<g id="edge884" class="edge">
<title>layer2_attn_gpu6&#45;&gt;layer2_attn_proj_gpu6</title>
<path fill="none" stroke="black" d="M12943.58,-2418.84C12941.25,-2410.64 12938.72,-2401.74 12936.28,-2393.15"/>
<polygon fill="black" stroke="black" points="12939.57,-2391.91 12933.47,-2383.25 12932.84,-2393.83 12939.57,-2391.91"/>
</g>
<!-- layer2_attn_proj_gpu6&#45;&gt;layer2_attn_allreduce -->
<g id="edge885" class="edge">
<title>layer2_attn_proj_gpu6&#45;&gt;layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M12823.61,-2325.23C12808.02,-2321.76 12792.08,-2318.23 12777,-2314.95 12661.74,-2289.88 12530.99,-2262.39 12433.7,-2242.12"/>
<polygon fill="black" stroke="black" points="12434.3,-2238.67 12423.8,-2240.05 12432.88,-2245.52 12434.3,-2238.67"/>
</g>
<!-- layer2_attn_gpu7 -->
<g id="node396" class="node">
<title>layer2_attn_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="13336.5,-2486.95 13093.5,-2486.95 13093.5,-2418.95 13336.5,-2418.95 13336.5,-2486.95"/>
<text text-anchor="middle" x="13215" y="-2471.75" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU7</text>
<text text-anchor="middle" x="13215" y="-2456.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="13215" y="-2441.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="13215" y="-2426.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_qkv_gpu7&#45;&gt;layer2_attn_gpu7 -->
<g id="edge922" class="edge">
<title>layer2_qkv_gpu7&#45;&gt;layer2_attn_gpu7</title>
<path fill="none" stroke="black" d="M13215,-2522.69C13215,-2514.28 13215,-2505.58 13215,-2497.31"/>
<polygon fill="black" stroke="black" points="13218.5,-2497.13 13215,-2487.13 13211.5,-2497.13 13218.5,-2497.13"/>
</g>
<!-- layer2_attn_proj_gpu7 -->
<g id="node397" class="node">
<title>layer2_attn_proj_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="13282,-2382.95 13082,-2382.95 13082,-2314.95 13282,-2314.95 13282,-2382.95"/>
<text text-anchor="middle" x="13182" y="-2367.75" font-family="Times,serif" font-size="14.00">L2_Attn_Projection_GPU7</text>
<text text-anchor="middle" x="13182" y="-2352.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="13182" y="-2337.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="13182" y="-2322.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_attn_gpu7&#45;&gt;layer2_attn_proj_gpu7 -->
<g id="edge923" class="edge">
<title>layer2_attn_gpu7&#45;&gt;layer2_attn_proj_gpu7</title>
<path fill="none" stroke="black" d="M13204.29,-2418.84C13201.61,-2410.55 13198.69,-2401.55 13195.88,-2392.86"/>
<polygon fill="black" stroke="black" points="13199.18,-2391.69 13192.77,-2383.25 13192.52,-2393.84 13199.18,-2391.69"/>
</g>
<!-- layer2_attn_proj_gpu7&#45;&gt;layer2_attn_allreduce -->
<g id="edge924" class="edge">
<title>layer2_attn_proj_gpu7&#45;&gt;layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M13081.64,-2324.57C13065.42,-2321.12 13048.78,-2317.79 13033,-2314.95 12839.85,-2280.27 12616.7,-2250.81 12465.36,-2232.39"/>
<polygon fill="black" stroke="black" points="12465.39,-2228.87 12455.05,-2231.14 12464.55,-2235.82 12465.39,-2228.87"/>
</g>
<!-- layer2_attn_norm_gpu0 -->
<g id="node399" class="node">
<title>layer2_attn_norm_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="5970,-2106.95 5726,-2106.95 5726,-2038.95 5970,-2038.95 5970,-2106.95"/>
<text text-anchor="middle" x="5848" y="-2091.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU0</text>
<text text-anchor="middle" x="5848" y="-2076.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="5848" y="-2061.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="5848" y="-2046.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer2_attn_allreduce&#45;&gt;layer2_attn_norm_gpu0 -->
<g id="edge652" class="edge">
<title>layer2_attn_allreduce&#45;&gt;layer2_attn_norm_gpu0</title>
<path fill="none" stroke="black" d="M12070.04,-2205.35C11052.86,-2183.87 6788.14,-2093.81 5980.36,-2076.75"/>
<polygon fill="black" stroke="black" points="5980.23,-2073.24 5970.15,-2076.53 5980.08,-2080.24 5980.23,-2073.24"/>
</g>
<!-- layer2_attn_norm_gpu1 -->
<g id="node400" class="node">
<title>layer2_attn_norm_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="7940,-2106.95 7696,-2106.95 7696,-2038.95 7940,-2038.95 7940,-2106.95"/>
<text text-anchor="middle" x="7818" y="-2091.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU1</text>
<text text-anchor="middle" x="7818" y="-2076.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="7818" y="-2061.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="7818" y="-2046.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer2_attn_allreduce&#45;&gt;layer2_attn_norm_gpu1 -->
<g id="edge691" class="edge">
<title>layer2_attn_allreduce&#45;&gt;layer2_attn_norm_gpu1</title>
<path fill="none" stroke="black" d="M12076.53,-2203.52C11294.9,-2179.74 8581.68,-2097.19 7950.1,-2077.97"/>
<polygon fill="black" stroke="black" points="7950.16,-2074.47 7940.06,-2077.67 7949.94,-2081.47 7950.16,-2074.47"/>
</g>
<!-- layer2_attn_norm_gpu2 -->
<g id="node401" class="node">
<title>layer2_attn_norm_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="10309,-2106.95 10065,-2106.95 10065,-2038.95 10309,-2038.95 10309,-2106.95"/>
<text text-anchor="middle" x="10187" y="-2091.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU2</text>
<text text-anchor="middle" x="10187" y="-2076.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="10187" y="-2061.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="10187" y="-2046.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer2_attn_allreduce&#45;&gt;layer2_attn_norm_gpu2 -->
<g id="edge730" class="edge">
<title>layer2_attn_allreduce&#45;&gt;layer2_attn_norm_gpu2</title>
<path fill="none" stroke="black" d="M12097.38,-2197.61C11676.99,-2170.4 10679.13,-2105.81 10319.27,-2082.52"/>
<polygon fill="black" stroke="black" points="10319.27,-2079.01 10309.07,-2081.85 10318.82,-2085.99 10319.27,-2079.01"/>
</g>
<!-- layer2_attn_norm_gpu3 -->
<g id="node402" class="node">
<title>layer2_attn_norm_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="11625,-2106.95 11381,-2106.95 11381,-2038.95 11625,-2038.95 11625,-2106.95"/>
<text text-anchor="middle" x="11503" y="-2091.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU3</text>
<text text-anchor="middle" x="11503" y="-2076.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11503" y="-2061.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11503" y="-2046.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer2_attn_allreduce&#45;&gt;layer2_attn_norm_gpu3 -->
<g id="edge769" class="edge">
<title>layer2_attn_allreduce&#45;&gt;layer2_attn_norm_gpu3</title>
<path fill="none" stroke="black" d="M12142.19,-2184.69C11996.81,-2159.5 11775.5,-2121.16 11635.13,-2096.84"/>
<polygon fill="black" stroke="black" points="11635.61,-2093.38 11625.16,-2095.12 11634.42,-2100.27 11635.61,-2093.38"/>
</g>
<!-- layer2_attn_norm_gpu4 -->
<g id="node403" class="node">
<title>layer2_attn_norm_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13196,-2106.95 12952,-2106.95 12952,-2038.95 13196,-2038.95 13196,-2106.95"/>
<text text-anchor="middle" x="13074" y="-2091.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU4</text>
<text text-anchor="middle" x="13074" y="-2076.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="13074" y="-2061.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="13074" y="-2046.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer2_attn_allreduce&#45;&gt;layer2_attn_norm_gpu4 -->
<g id="edge808" class="edge">
<title>layer2_attn_allreduce&#45;&gt;layer2_attn_norm_gpu4</title>
<path fill="none" stroke="black" d="M12434,-2184.69C12579.67,-2159.49 12801.49,-2121.11 12942.02,-2096.79"/>
<polygon fill="black" stroke="black" points="12942.74,-2100.22 12952,-2095.06 12941.55,-2093.32 12942.74,-2100.22"/>
</g>
<!-- layer2_attn_norm_gpu5 -->
<g id="node404" class="node">
<title>layer2_attn_norm_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="15517,-2106.95 15273,-2106.95 15273,-2038.95 15517,-2038.95 15517,-2106.95"/>
<text text-anchor="middle" x="15395" y="-2091.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU5</text>
<text text-anchor="middle" x="15395" y="-2076.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="15395" y="-2061.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="15395" y="-2046.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer2_attn_allreduce&#45;&gt;layer2_attn_norm_gpu5 -->
<g id="edge847" class="edge">
<title>layer2_attn_allreduce&#45;&gt;layer2_attn_norm_gpu5</title>
<path fill="none" stroke="black" d="M12490.66,-2201.08C13078.81,-2175.34 14775.15,-2101.09 15262.57,-2079.75"/>
<polygon fill="black" stroke="black" points="15262.98,-2083.24 15272.81,-2079.3 15262.67,-2076.24 15262.98,-2083.24"/>
</g>
<!-- layer2_attn_norm_gpu6 -->
<g id="node405" class="node">
<title>layer2_attn_norm_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="18214,-2106.95 17970,-2106.95 17970,-2038.95 18214,-2038.95 18214,-2106.95"/>
<text text-anchor="middle" x="18092" y="-2091.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU6</text>
<text text-anchor="middle" x="18092" y="-2076.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="18092" y="-2061.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="18092" y="-2046.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer2_attn_allreduce&#45;&gt;layer2_attn_norm_gpu6 -->
<g id="edge886" class="edge">
<title>layer2_attn_allreduce&#45;&gt;layer2_attn_norm_gpu6</title>
<path fill="none" stroke="black" d="M12504.06,-2204.89C13449.19,-2182.74 17206.18,-2094.71 17959.92,-2077.05"/>
<polygon fill="black" stroke="black" points="17960.08,-2080.55 17969.99,-2076.81 17959.91,-2073.55 17960.08,-2080.55"/>
</g>
<!-- layer2_attn_norm_gpu7 -->
<g id="node406" class="node">
<title>layer2_attn_norm_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="21098,-2106.95 20854,-2106.95 20854,-2038.95 21098,-2038.95 21098,-2106.95"/>
<text text-anchor="middle" x="20976" y="-2091.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU7</text>
<text text-anchor="middle" x="20976" y="-2076.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="20976" y="-2061.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="20976" y="-2046.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer2_attn_allreduce&#45;&gt;layer2_attn_norm_gpu7 -->
<g id="edge925" class="edge">
<title>layer2_attn_allreduce&#45;&gt;layer2_attn_norm_gpu7</title>
<path fill="none" stroke="black" d="M12509.57,-2206.48C13755.18,-2186.99 19864.65,-2091.35 20843.57,-2076.03"/>
<polygon fill="black" stroke="black" points="20843.86,-2079.52 20853.81,-2075.87 20843.75,-2072.52 20843.86,-2079.52"/>
</g>
<!-- layer2_gate_gpu0 -->
<g id="node407" class="node">
<title>layer2_gate_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1755,-2002.95 1511,-2002.95 1511,-1919.95 1755,-1919.95 1755,-2002.95"/>
<text text-anchor="middle" x="1633" y="-1987.75" font-family="Times,serif" font-size="14.00">L2_Gate_GPU0</text>
<text text-anchor="middle" x="1633" y="-1972.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1633" y="-1957.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="1633" y="-1942.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="1633" y="-1927.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_attn_norm_gpu0&#45;&gt;layer2_gate_gpu0 -->
<g id="edge653" class="edge">
<title>layer2_attn_norm_gpu0&#45;&gt;layer2_gate_gpu0</title>
<path fill="none" stroke="black" d="M5725.83,-2068.78C5115.19,-2052.92 2398.07,-1982.33 1765.1,-1965.89"/>
<polygon fill="black" stroke="black" points="1765.12,-1962.38 1755.03,-1965.62 1764.94,-1969.38 1765.12,-1962.38"/>
</g>
<!-- layer2_gate_gpu1 -->
<g id="node426" class="node">
<title>layer2_gate_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="4827,-2002.95 4583,-2002.95 4583,-1919.95 4827,-1919.95 4827,-2002.95"/>
<text text-anchor="middle" x="4705" y="-1987.75" font-family="Times,serif" font-size="14.00">L2_Gate_GPU1</text>
<text text-anchor="middle" x="4705" y="-1972.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="4705" y="-1957.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="4705" y="-1942.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="4705" y="-1927.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_attn_norm_gpu1&#45;&gt;layer2_gate_gpu1 -->
<g id="edge692" class="edge">
<title>layer2_attn_norm_gpu1&#45;&gt;layer2_gate_gpu1</title>
<path fill="none" stroke="black" d="M7695.97,-2067.66C7201.54,-2050.27 5349.37,-1985.12 4837.05,-1967.1"/>
<polygon fill="black" stroke="black" points="4837.15,-1963.6 4827.03,-1966.75 4836.9,-1970.6 4837.15,-1963.6"/>
</g>
<!-- layer2_gate_gpu2 -->
<g id="node445" class="node">
<title>layer2_gate_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="7899,-2002.95 7655,-2002.95 7655,-1919.95 7899,-1919.95 7899,-2002.95"/>
<text text-anchor="middle" x="7777" y="-1987.75" font-family="Times,serif" font-size="14.00">L2_Gate_GPU2</text>
<text text-anchor="middle" x="7777" y="-1972.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="7777" y="-1957.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="7777" y="-1942.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="7777" y="-1927.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_attn_norm_gpu2&#45;&gt;layer2_gate_gpu2 -->
<g id="edge731" class="edge">
<title>layer2_attn_norm_gpu2&#45;&gt;layer2_gate_gpu2</title>
<path fill="none" stroke="black" d="M10064.59,-2066.39C9654.89,-2047.78 8333.65,-1987.75 7909.44,-1968.47"/>
<polygon fill="black" stroke="black" points="7909.43,-1964.97 7899.28,-1968.01 7909.12,-1971.96 7909.43,-1964.97"/>
</g>
<!-- layer2_gate_gpu3 -->
<g id="node464" class="node">
<title>layer2_gate_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="10971,-2002.95 10727,-2002.95 10727,-1919.95 10971,-1919.95 10971,-2002.95"/>
<text text-anchor="middle" x="10849" y="-1987.75" font-family="Times,serif" font-size="14.00">L2_Gate_GPU3</text>
<text text-anchor="middle" x="10849" y="-1972.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="10849" y="-1957.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="10849" y="-1942.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="10849" y="-1927.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_attn_norm_gpu3&#45;&gt;layer2_gate_gpu3 -->
<g id="edge770" class="edge">
<title>layer2_attn_norm_gpu3&#45;&gt;layer2_gate_gpu3</title>
<path fill="none" stroke="black" d="M11380.75,-2051.49C11267.06,-2032.45 11098.09,-2004.16 10981.28,-1984.6"/>
<polygon fill="black" stroke="black" points="10981.64,-1981.11 10971.2,-1982.91 10980.48,-1988.02 10981.64,-1981.11"/>
</g>
<!-- layer2_gate_gpu4 -->
<g id="node483" class="node">
<title>layer2_gate_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13851,-2002.95 13607,-2002.95 13607,-1919.95 13851,-1919.95 13851,-2002.95"/>
<text text-anchor="middle" x="13729" y="-1987.75" font-family="Times,serif" font-size="14.00">L2_Gate_GPU4</text>
<text text-anchor="middle" x="13729" y="-1972.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="13729" y="-1957.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="13729" y="-1942.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="13729" y="-1927.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_attn_norm_gpu4&#45;&gt;layer2_gate_gpu4 -->
<g id="edge809" class="edge">
<title>layer2_attn_norm_gpu4&#45;&gt;layer2_gate_gpu4</title>
<path fill="none" stroke="black" d="M13196.05,-2051.55C13309.96,-2032.51 13479.51,-2004.16 13596.64,-1984.58"/>
<polygon fill="black" stroke="black" points="13597.46,-1987.99 13606.74,-1982.89 13596.3,-1981.09 13597.46,-1987.99"/>
</g>
<!-- layer2_gate_gpu5 -->
<g id="node502" class="node">
<title>layer2_gate_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="16923,-2002.95 16679,-2002.95 16679,-1919.95 16923,-1919.95 16923,-2002.95"/>
<text text-anchor="middle" x="16801" y="-1987.75" font-family="Times,serif" font-size="14.00">L2_Gate_GPU5</text>
<text text-anchor="middle" x="16801" y="-1972.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="16801" y="-1957.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="16801" y="-1942.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="16801" y="-1927.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_attn_norm_gpu5&#45;&gt;layer2_gate_gpu5 -->
<g id="edge848" class="edge">
<title>layer2_attn_norm_gpu5&#45;&gt;layer2_gate_gpu5</title>
<path fill="none" stroke="black" d="M15517.01,-2062.45C15779.67,-2041.99 16396.85,-1993.93 16668.59,-1972.77"/>
<polygon fill="black" stroke="black" points="16669.2,-1976.23 16678.9,-1971.96 16668.66,-1969.25 16669.2,-1976.23"/>
</g>
<!-- layer2_gate_gpu6 -->
<g id="node521" class="node">
<title>layer2_gate_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="19995,-2002.95 19751,-2002.95 19751,-1919.95 19995,-1919.95 19995,-2002.95"/>
<text text-anchor="middle" x="19873" y="-1987.75" font-family="Times,serif" font-size="14.00">L2_Gate_GPU6</text>
<text text-anchor="middle" x="19873" y="-1972.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="19873" y="-1957.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="19873" y="-1942.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="19873" y="-1927.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_attn_norm_gpu6&#45;&gt;layer2_gate_gpu6 -->
<g id="edge887" class="edge">
<title>layer2_attn_norm_gpu6&#45;&gt;layer2_gate_gpu6</title>
<path fill="none" stroke="black" d="M18214.06,-2064.45C18536.17,-2044.64 19407.18,-1991.09 19740.65,-1970.59"/>
<polygon fill="black" stroke="black" points="19741.07,-1974.07 19750.84,-1969.96 19740.65,-1967.08 19741.07,-1974.07"/>
</g>
<!-- layer2_gate_gpu7 -->
<g id="node540" class="node">
<title>layer2_gate_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="23067,-2002.95 22823,-2002.95 22823,-1919.95 23067,-1919.95 23067,-2002.95"/>
<text text-anchor="middle" x="22945" y="-1987.75" font-family="Times,serif" font-size="14.00">L2_Gate_GPU7</text>
<text text-anchor="middle" x="22945" y="-1972.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="22945" y="-1957.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="22945" y="-1942.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="22945" y="-1927.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_attn_norm_gpu7&#45;&gt;layer2_gate_gpu7 -->
<g id="edge926" class="edge">
<title>layer2_attn_norm_gpu7&#45;&gt;layer2_gate_gpu7</title>
<path fill="none" stroke="black" d="M21098.05,-2065.17C21447.71,-2045.72 22451.14,-1989.92 22812.94,-1969.8"/>
<polygon fill="black" stroke="black" points="22813.15,-1973.29 22822.94,-1969.24 22812.76,-1966.3 22813.15,-1973.29"/>
</g>
<!-- layer2_expert0_0 -->
<g id="node408" class="node">
<title>layer2_expert0_0</title>
<polygon fill="lightgreen" stroke="black" points="184,-1883.95 10,-1883.95 10,-1800.95 184,-1800.95 184,-1883.95"/>
<text text-anchor="middle" x="97" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU0</text>
<text text-anchor="middle" x="97" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="97" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="97" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="97" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_gate_gpu0&#45;&gt;layer2_expert0_0 -->
<g id="edge654" class="edge">
<title>layer2_gate_gpu0&#45;&gt;layer2_expert0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1510.8,-1959.37C1214.21,-1955.87 461.59,-1941.65 194.29,-1883.96"/>
<polygon fill="black" stroke="black" points="194.74,-1880.48 184.22,-1881.71 193.22,-1887.31 194.74,-1880.48"/>
</g>
<!-- layer2_expert0_1 -->
<g id="node409" class="node">
<title>layer2_expert0_1</title>
<polygon fill="lightgreen" stroke="black" points="376,-1883.95 202,-1883.95 202,-1800.95 376,-1800.95 376,-1883.95"/>
<text text-anchor="middle" x="289" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU0</text>
<text text-anchor="middle" x="289" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="289" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="289" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="289" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_gate_gpu0&#45;&gt;layer2_expert0_1 -->
<g id="edge655" class="edge">
<title>layer2_gate_gpu0&#45;&gt;layer2_expert0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1510.82,-1958.19C1243.95,-1952.43 615.25,-1934.07 386.17,-1883.94"/>
<polygon fill="black" stroke="black" points="386.75,-1880.48 376.22,-1881.68 385.2,-1887.31 386.75,-1880.48"/>
</g>
<!-- layer2_expert0_2 -->
<g id="node410" class="node">
<title>layer2_expert0_2</title>
<polygon fill="lightgreen" stroke="black" points="568,-1883.95 394,-1883.95 394,-1800.95 568,-1800.95 568,-1883.95"/>
<text text-anchor="middle" x="481" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU0</text>
<text text-anchor="middle" x="481" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="481" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="481" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="481" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_gate_gpu0&#45;&gt;layer2_expert0_2 -->
<g id="edge656" class="edge">
<title>layer2_gate_gpu0&#45;&gt;layer2_expert0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1510.92,-1956.61C1276.28,-1948.41 769.38,-1926.58 578.19,-1883.95"/>
<polygon fill="black" stroke="black" points="578.77,-1880.49 568.23,-1881.64 577.19,-1887.31 578.77,-1880.49"/>
</g>
<!-- layer2_expert0_3 -->
<g id="node411" class="node">
<title>layer2_expert0_3</title>
<polygon fill="lightgreen" stroke="black" points="760,-1883.95 586,-1883.95 586,-1800.95 760,-1800.95 760,-1883.95"/>
<text text-anchor="middle" x="673" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU0</text>
<text text-anchor="middle" x="673" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="673" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="673" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="673" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_gate_gpu0&#45;&gt;layer2_expert0_3 -->
<g id="edge657" class="edge">
<title>layer2_gate_gpu0&#45;&gt;layer2_expert0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1510.77,-1954.32C1311.25,-1943.53 923.31,-1919.15 770,-1883.92"/>
<polygon fill="black" stroke="black" points="770.79,-1880.5 760.25,-1881.58 769.16,-1887.31 770.79,-1880.5"/>
</g>
<!-- layer2_expert0_4 -->
<g id="node412" class="node">
<title>layer2_expert0_4</title>
<polygon fill="lightgreen" stroke="black" points="952,-1883.95 778,-1883.95 778,-1800.95 952,-1800.95 952,-1883.95"/>
<text text-anchor="middle" x="865" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU0</text>
<text text-anchor="middle" x="865" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="865" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="865" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="865" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_gate_gpu0&#45;&gt;layer2_expert0_4 -->
<g id="edge658" class="edge">
<title>layer2_gate_gpu0&#45;&gt;layer2_expert0_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1510.91,-1957C1377.03,-1950.86 1156.46,-1933.79 961.84,-1883.96"/>
<polygon fill="black" stroke="black" points="962.57,-1880.53 952.01,-1881.4 960.81,-1887.3 962.57,-1880.53"/>
</g>
<!-- layer2_expert0_5 -->
<g id="node413" class="node">
<title>layer2_expert0_5</title>
<polygon fill="lightgreen" stroke="black" points="1144,-1883.95 970,-1883.95 970,-1800.95 1144,-1800.95 1144,-1883.95"/>
<text text-anchor="middle" x="1057" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU0</text>
<text text-anchor="middle" x="1057" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1057" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1057" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1057" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_gate_gpu0&#45;&gt;layer2_expert0_5 -->
<g id="edge659" class="edge">
<title>layer2_gate_gpu0&#45;&gt;layer2_expert0_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1510.91,-1949.21C1415.32,-1938.51 1279.37,-1919.09 1153.84,-1884"/>
<polygon fill="black" stroke="black" points="1154.63,-1880.59 1144.06,-1881.23 1152.72,-1887.32 1154.63,-1880.59"/>
</g>
<!-- layer2_expert0_6 -->
<g id="node414" class="node">
<title>layer2_expert0_6</title>
<polygon fill="lightgreen" stroke="black" points="1336,-1883.95 1162,-1883.95 1162,-1800.95 1336,-1800.95 1336,-1883.95"/>
<text text-anchor="middle" x="1249" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU0</text>
<text text-anchor="middle" x="1249" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1249" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1249" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1249" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_gate_gpu0&#45;&gt;layer2_expert0_6 -->
<g id="edge660" class="edge">
<title>layer2_gate_gpu0&#45;&gt;layer2_expert0_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1510.66,-1931.97C1461.66,-1919.59 1404.72,-1903.96 1345.67,-1884.07"/>
<polygon fill="black" stroke="black" points="1346.77,-1880.75 1336.18,-1880.84 1344.52,-1887.37 1346.77,-1880.75"/>
</g>
<!-- layer2_expert0_7 -->
<g id="node415" class="node">
<title>layer2_expert0_7</title>
<polygon fill="lightgreen" stroke="black" points="1528,-1883.95 1354,-1883.95 1354,-1800.95 1528,-1800.95 1528,-1883.95"/>
<text text-anchor="middle" x="1441" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU0</text>
<text text-anchor="middle" x="1441" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1441" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1441" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1441" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_gate_gpu0&#45;&gt;layer2_expert0_7 -->
<g id="edge661" class="edge">
<title>layer2_gate_gpu0&#45;&gt;layer2_expert0_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1566.39,-1919.86C1550.15,-1909.97 1532.68,-1899.32 1516.08,-1889.21"/>
<polygon fill="black" stroke="black" points="1517.86,-1886.19 1507.5,-1883.97 1514.21,-1892.17 1517.86,-1886.19"/>
</g>
<!-- layer2_expert0_8 -->
<g id="node416" class="node">
<title>layer2_expert0_8</title>
<polygon fill="lightgreen" stroke="black" points="1720,-1883.95 1546,-1883.95 1546,-1800.95 1720,-1800.95 1720,-1883.95"/>
<text text-anchor="middle" x="1633" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU0</text>
<text text-anchor="middle" x="1633" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1633" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1633" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1633" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_gate_gpu0&#45;&gt;layer2_expert0_8 -->
<g id="edge662" class="edge">
<title>layer2_gate_gpu0&#45;&gt;layer2_expert0_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1633,-1919.86C1633,-1911.6 1633,-1902.82 1633,-1894.26"/>
<polygon fill="black" stroke="black" points="1636.5,-1893.97 1633,-1883.97 1629.5,-1893.97 1636.5,-1893.97"/>
</g>
<!-- layer2_expert0_9 -->
<g id="node417" class="node">
<title>layer2_expert0_9</title>
<polygon fill="lightgreen" stroke="black" points="1912,-1883.95 1738,-1883.95 1738,-1800.95 1912,-1800.95 1912,-1883.95"/>
<text text-anchor="middle" x="1825" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU0</text>
<text text-anchor="middle" x="1825" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1825" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1825" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1825" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_gate_gpu0&#45;&gt;layer2_expert0_9 -->
<g id="edge663" class="edge">
<title>layer2_gate_gpu0&#45;&gt;layer2_expert0_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1699.61,-1919.86C1715.85,-1909.97 1733.32,-1899.32 1749.92,-1889.21"/>
<polygon fill="black" stroke="black" points="1751.79,-1892.17 1758.5,-1883.97 1748.14,-1886.19 1751.79,-1892.17"/>
</g>
<!-- layer2_expert0_10 -->
<g id="node418" class="node">
<title>layer2_expert0_10</title>
<polygon fill="lightgreen" stroke="black" points="2104,-1883.95 1930,-1883.95 1930,-1800.95 2104,-1800.95 2104,-1883.95"/>
<text text-anchor="middle" x="2017" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU0</text>
<text text-anchor="middle" x="2017" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2017" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2017" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2017" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_gate_gpu0&#45;&gt;layer2_expert0_10 -->
<g id="edge664" class="edge">
<title>layer2_gate_gpu0&#45;&gt;layer2_expert0_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1755.34,-1931.97C1804.34,-1919.59 1861.28,-1903.96 1920.33,-1884.07"/>
<polygon fill="black" stroke="black" points="1921.48,-1887.37 1929.82,-1880.84 1919.23,-1880.75 1921.48,-1887.37"/>
</g>
<!-- layer2_expert0_11 -->
<g id="node419" class="node">
<title>layer2_expert0_11</title>
<polygon fill="lightgreen" stroke="black" points="2296,-1883.95 2122,-1883.95 2122,-1800.95 2296,-1800.95 2296,-1883.95"/>
<text text-anchor="middle" x="2209" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU0</text>
<text text-anchor="middle" x="2209" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2209" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2209" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2209" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_gate_gpu0&#45;&gt;layer2_expert0_11 -->
<g id="edge665" class="edge">
<title>layer2_gate_gpu0&#45;&gt;layer2_expert0_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1755.09,-1949.21C1850.68,-1938.51 1986.63,-1919.09 2112.16,-1884"/>
<polygon fill="black" stroke="black" points="2113.28,-1887.32 2121.94,-1881.23 2111.37,-1880.59 2113.28,-1887.32"/>
</g>
<!-- layer2_expert0_12 -->
<g id="node420" class="node">
<title>layer2_expert0_12</title>
<polygon fill="lightgreen" stroke="black" points="2488,-1883.95 2314,-1883.95 2314,-1800.95 2488,-1800.95 2488,-1883.95"/>
<text text-anchor="middle" x="2401" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU0</text>
<text text-anchor="middle" x="2401" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2401" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2401" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2401" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_gate_gpu0&#45;&gt;layer2_expert0_12 -->
<g id="edge666" class="edge">
<title>layer2_gate_gpu0&#45;&gt;layer2_expert0_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1755.09,-1957C1888.97,-1950.86 2109.54,-1933.79 2304.16,-1883.96"/>
<polygon fill="black" stroke="black" points="2305.19,-1887.3 2313.99,-1881.4 2303.43,-1880.53 2305.19,-1887.3"/>
</g>
<!-- layer2_expert0_13 -->
<g id="node421" class="node">
<title>layer2_expert0_13</title>
<polygon fill="lightgreen" stroke="black" points="2680,-1883.95 2506,-1883.95 2506,-1800.95 2680,-1800.95 2680,-1883.95"/>
<text text-anchor="middle" x="2593" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU0</text>
<text text-anchor="middle" x="2593" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2593" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2593" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2593" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_gate_gpu0&#45;&gt;layer2_expert0_13 -->
<g id="edge667" class="edge">
<title>layer2_gate_gpu0&#45;&gt;layer2_expert0_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1755.23,-1954.32C1954.75,-1943.53 2342.69,-1919.15 2496,-1883.92"/>
<polygon fill="black" stroke="black" points="2496.84,-1887.31 2505.75,-1881.58 2495.21,-1880.5 2496.84,-1887.31"/>
</g>
<!-- layer2_expert0_14 -->
<g id="node422" class="node">
<title>layer2_expert0_14</title>
<polygon fill="lightgreen" stroke="black" points="2872,-1883.95 2698,-1883.95 2698,-1800.95 2872,-1800.95 2872,-1883.95"/>
<text text-anchor="middle" x="2785" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU0</text>
<text text-anchor="middle" x="2785" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2785" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2785" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2785" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_gate_gpu0&#45;&gt;layer2_expert0_14 -->
<g id="edge668" class="edge">
<title>layer2_gate_gpu0&#45;&gt;layer2_expert0_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1755.08,-1956.61C1989.72,-1948.41 2496.62,-1926.58 2687.81,-1883.95"/>
<polygon fill="black" stroke="black" points="2688.81,-1887.31 2697.77,-1881.64 2687.23,-1880.49 2688.81,-1887.31"/>
</g>
<!-- layer2_expert0_15 -->
<g id="node423" class="node">
<title>layer2_expert0_15</title>
<polygon fill="lightgreen" stroke="black" points="3064,-1883.95 2890,-1883.95 2890,-1800.95 3064,-1800.95 3064,-1883.95"/>
<text text-anchor="middle" x="2977" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU0</text>
<text text-anchor="middle" x="2977" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2977" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2977" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2977" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_gate_gpu0&#45;&gt;layer2_expert0_15 -->
<g id="edge669" class="edge">
<title>layer2_gate_gpu0&#45;&gt;layer2_expert0_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1755.18,-1958.19C2022.05,-1952.43 2650.75,-1934.07 2879.83,-1883.94"/>
<polygon fill="black" stroke="black" points="2880.8,-1887.31 2889.78,-1881.68 2879.25,-1880.48 2880.8,-1887.31"/>
</g>
<!-- layer2_moe_agg_gpu0 -->
<g id="node424" class="node">
<title>layer2_moe_agg_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1734.5,-1764.95 1531.5,-1764.95 1531.5,-1696.95 1734.5,-1696.95 1734.5,-1764.95"/>
<text text-anchor="middle" x="1633" y="-1749.75" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU0</text>
<text text-anchor="middle" x="1633" y="-1734.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="1633" y="-1719.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1633" y="-1704.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_expert0_0&#45;&gt;layer2_moe_agg_gpu0 -->
<g id="edge670" class="edge">
<title>layer2_expert0_0&#45;&gt;layer2_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M184.21,-1803.17C187.16,-1802.36 190.09,-1801.62 193,-1800.95 445.13,-1743.63 1228.27,-1733.89 1521.05,-1732.27"/>
<polygon fill="black" stroke="black" points="1521.27,-1735.77 1531.25,-1732.21 1521.24,-1728.77 1521.27,-1735.77"/>
</g>
<!-- layer2_expert0_1&#45;&gt;layer2_moe_agg_gpu0 -->
<g id="edge671" class="edge">
<title>layer2_expert0_1&#45;&gt;layer2_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M376.22,-1803.2C379.16,-1802.38 382.09,-1801.63 385,-1800.95 599.24,-1751.42 1256.44,-1737.07 1520.97,-1733.24"/>
<polygon fill="black" stroke="black" points="1521.41,-1736.73 1531.36,-1733.09 1521.31,-1729.73 1521.41,-1736.73"/>
</g>
<!-- layer2_expert0_2&#45;&gt;layer2_moe_agg_gpu0 -->
<g id="edge672" class="edge">
<title>layer2_expert0_2&#45;&gt;layer2_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M568.23,-1803.24C571.17,-1802.41 574.1,-1801.64 577,-1800.95 753.72,-1759.16 1287.22,-1740.77 1521.09,-1734.56"/>
<polygon fill="black" stroke="black" points="1521.42,-1738.05 1531.32,-1734.29 1521.23,-1731.05 1521.42,-1738.05"/>
</g>
<!-- layer2_expert0_3&#45;&gt;layer2_moe_agg_gpu0 -->
<g id="edge673" class="edge">
<title>layer2_expert0_3&#45;&gt;layer2_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M760.24,-1803.3C763.18,-1802.45 766.1,-1801.66 769,-1800.95 908.55,-1766.88 1320.54,-1745.25 1520.96,-1736.46"/>
<polygon fill="black" stroke="black" points="1521.39,-1739.94 1531.22,-1736.01 1521.08,-1732.95 1521.39,-1739.94"/>
</g>
<!-- layer2_expert0_4&#45;&gt;layer2_moe_agg_gpu0 -->
<g id="edge674" class="edge">
<title>layer2_expert0_4&#45;&gt;layer2_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M952.26,-1803.38C955.19,-1802.51 958.11,-1801.69 961,-1800.95 1153.8,-1751.56 1386.29,-1737.33 1521.12,-1733.35"/>
<polygon fill="black" stroke="black" points="1521.56,-1736.84 1531.46,-1733.06 1521.37,-1729.84 1521.56,-1736.84"/>
</g>
<!-- layer2_expert0_5&#45;&gt;layer2_moe_agg_gpu0 -->
<g id="edge675" class="edge">
<title>layer2_expert0_5&#45;&gt;layer2_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1144.04,-1803.62C1147.04,-1802.67 1150.04,-1801.78 1153,-1800.95 1276.52,-1766.64 1422.92,-1748.73 1521.28,-1739.86"/>
<polygon fill="black" stroke="black" points="1521.59,-1743.34 1531.24,-1738.97 1520.97,-1736.37 1521.59,-1743.34"/>
</g>
<!-- layer2_expert0_6&#45;&gt;layer2_moe_agg_gpu0 -->
<g id="edge676" class="edge">
<title>layer2_expert0_6&#45;&gt;layer2_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1336.15,-1803.97C1339.12,-1802.92 1342.08,-1801.91 1345,-1800.95 1402.25,-1782.16 1467.45,-1766.11 1521.32,-1754.23"/>
<polygon fill="black" stroke="black" points="1522.22,-1757.62 1531.24,-1752.06 1520.72,-1750.78 1522.22,-1757.62"/>
</g>
<!-- layer2_expert0_7&#45;&gt;layer2_moe_agg_gpu0 -->
<g id="edge677" class="edge">
<title>layer2_expert0_7&#45;&gt;layer2_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1512.22,-1800.84C1529.85,-1790.78 1548.68,-1780.04 1566.1,-1770.11"/>
<polygon fill="black" stroke="black" points="1568.11,-1772.99 1575.06,-1765 1564.64,-1766.91 1568.11,-1772.99"/>
</g>
<!-- layer2_expert0_8&#45;&gt;layer2_moe_agg_gpu0 -->
<g id="edge678" class="edge">
<title>layer2_expert0_8&#45;&gt;layer2_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1633,-1800.68C1633,-1792.47 1633,-1783.81 1633,-1775.51"/>
<polygon fill="black" stroke="black" points="1636.5,-1775.25 1633,-1765.25 1629.5,-1775.25 1636.5,-1775.25"/>
</g>
<!-- layer2_expert0_9&#45;&gt;layer2_moe_agg_gpu0 -->
<g id="edge679" class="edge">
<title>layer2_expert0_9&#45;&gt;layer2_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1753.78,-1800.84C1736.15,-1790.78 1717.32,-1780.04 1699.9,-1770.11"/>
<polygon fill="black" stroke="black" points="1701.36,-1766.91 1690.94,-1765 1697.89,-1772.99 1701.36,-1766.91"/>
</g>
<!-- layer2_expert0_10&#45;&gt;layer2_moe_agg_gpu0 -->
<g id="edge680" class="edge">
<title>layer2_expert0_10&#45;&gt;layer2_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1929.85,-1803.97C1926.88,-1802.92 1923.92,-1801.91 1921,-1800.95 1863.75,-1782.16 1798.55,-1766.11 1744.68,-1754.23"/>
<polygon fill="black" stroke="black" points="1745.28,-1750.78 1734.76,-1752.06 1743.78,-1757.62 1745.28,-1750.78"/>
</g>
<!-- layer2_expert0_11&#45;&gt;layer2_moe_agg_gpu0 -->
<g id="edge681" class="edge">
<title>layer2_expert0_11&#45;&gt;layer2_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2121.96,-1803.62C2118.96,-1802.67 2115.96,-1801.78 2113,-1800.95 1989.48,-1766.64 1843.08,-1748.73 1744.72,-1739.86"/>
<polygon fill="black" stroke="black" points="1745.03,-1736.37 1734.76,-1738.97 1744.41,-1743.34 1745.03,-1736.37"/>
</g>
<!-- layer2_expert0_12&#45;&gt;layer2_moe_agg_gpu0 -->
<g id="edge682" class="edge">
<title>layer2_expert0_12&#45;&gt;layer2_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2313.74,-1803.38C2310.81,-1802.51 2307.89,-1801.69 2305,-1800.95 2112.2,-1751.56 1879.71,-1737.33 1744.88,-1733.35"/>
<polygon fill="black" stroke="black" points="1744.63,-1729.84 1734.54,-1733.06 1744.44,-1736.84 1744.63,-1729.84"/>
</g>
<!-- layer2_expert0_13&#45;&gt;layer2_moe_agg_gpu0 -->
<g id="edge683" class="edge">
<title>layer2_expert0_13&#45;&gt;layer2_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2505.76,-1803.3C2502.82,-1802.45 2499.9,-1801.66 2497,-1800.95 2357.45,-1766.88 1945.46,-1745.25 1745.04,-1736.46"/>
<polygon fill="black" stroke="black" points="1744.92,-1732.95 1734.78,-1736.01 1744.61,-1739.94 1744.92,-1732.95"/>
</g>
<!-- layer2_expert0_14&#45;&gt;layer2_moe_agg_gpu0 -->
<g id="edge684" class="edge">
<title>layer2_expert0_14&#45;&gt;layer2_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2697.77,-1803.24C2694.83,-1802.41 2691.9,-1801.64 2689,-1800.95 2512.28,-1759.16 1978.78,-1740.77 1744.91,-1734.56"/>
<polygon fill="black" stroke="black" points="1744.77,-1731.05 1734.68,-1734.29 1744.58,-1738.05 1744.77,-1731.05"/>
</g>
<!-- layer2_expert0_15&#45;&gt;layer2_moe_agg_gpu0 -->
<g id="edge685" class="edge">
<title>layer2_expert0_15&#45;&gt;layer2_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2889.78,-1803.2C2886.84,-1802.38 2883.91,-1801.63 2881,-1800.95 2666.76,-1751.42 2009.56,-1737.07 1745.03,-1733.24"/>
<polygon fill="black" stroke="black" points="1744.69,-1729.73 1734.64,-1733.09 1744.59,-1736.73 1744.69,-1729.73"/>
</g>
<!-- layer2_moe_allreduce -->
<g id="node559" class="node">
<title>layer2_moe_allreduce</title>
<polygon fill="lightcoral" stroke="black" points="12289,-1660.95 12052,-1592.95 12289,-1524.95 12526,-1592.95 12289,-1660.95"/>
<text text-anchor="middle" x="12289" y="-1611.75" font-family="Times,serif" font-size="14.00">L2_MoE_All&#45;Reduce</text>
<text text-anchor="middle" x="12289" y="-1596.75" font-family="Times,serif" font-size="14.00">Input: 8×[1024,2048,4096]</text>
<text text-anchor="middle" x="12289" y="-1581.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12289" y="-1566.75" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce across GPUs 0&#45;7</text>
</g>
<!-- layer2_moe_agg_gpu0&#45;&gt;layer2_moe_allreduce -->
<g id="edge686" class="edge">
<title>layer2_moe_agg_gpu0&#45;&gt;layer2_moe_allreduce</title>
<path fill="none" stroke="black" d="M1734.63,-1728.66C2721.3,-1716.06 10591.46,-1615.62 12055.14,-1596.94"/>
<polygon fill="black" stroke="black" points="12055.29,-1600.44 12065.25,-1596.81 12055.2,-1593.44 12055.29,-1600.44"/>
</g>
<!-- layer2_output_gpu0 -->
<g id="node425" class="node">
<title>layer2_output_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="11494,-1488.95 11250,-1488.95 11250,-1420.95 11494,-1420.95 11494,-1488.95"/>
<text text-anchor="middle" x="11372" y="-1473.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU0</text>
<text text-anchor="middle" x="11372" y="-1458.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="11372" y="-1443.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11372" y="-1428.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_qkv_gpu0 -->
<g id="node560" class="node">
<title>layer3_qkv_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="11473,-1384.95 11273,-1384.95 11273,-1286.95 11473,-1286.95 11473,-1384.95"/>
<text text-anchor="middle" x="11373" y="-1369.75" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU0</text>
<text text-anchor="middle" x="11373" y="-1354.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11373" y="-1339.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11373" y="-1324.75" font-family="Times,serif" font-size="14.00">Heads: 0&#45;3</text>
<text text-anchor="middle" x="11373" y="-1309.75" font-family="Times,serif" font-size="14.00">TP Slice: 0</text>
<text text-anchor="middle" x="11373" y="-1294.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_output_gpu0&#45;&gt;layer3_qkv_gpu0 -->
<g id="edge961" class="edge">
<title>layer2_output_gpu0&#45;&gt;layer3_qkv_gpu0</title>
<path fill="none" stroke="black" d="M11372.28,-1420.74C11372.35,-1412.78 11372.43,-1404.04 11372.5,-1395.3"/>
<polygon fill="black" stroke="black" points="11376,-1395.13 11372.59,-1385.1 11369,-1395.07 11376,-1395.13"/>
</g>
<!-- layer2_expert1_0 -->
<g id="node427" class="node">
<title>layer2_expert1_0</title>
<polygon fill="lightgreen" stroke="black" points="3256,-1883.95 3082,-1883.95 3082,-1800.95 3256,-1800.95 3256,-1883.95"/>
<text text-anchor="middle" x="3169" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU1</text>
<text text-anchor="middle" x="3169" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3169" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3169" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3169" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_gate_gpu1&#45;&gt;layer2_expert1_0 -->
<g id="edge693" class="edge">
<title>layer2_gate_gpu1&#45;&gt;layer2_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4582.8,-1959.37C4286.21,-1955.87 3533.59,-1941.65 3266.29,-1883.96"/>
<polygon fill="black" stroke="black" points="3266.74,-1880.48 3256.22,-1881.71 3265.22,-1887.31 3266.74,-1880.48"/>
</g>
<!-- layer2_expert1_1 -->
<g id="node428" class="node">
<title>layer2_expert1_1</title>
<polygon fill="lightgreen" stroke="black" points="3448,-1883.95 3274,-1883.95 3274,-1800.95 3448,-1800.95 3448,-1883.95"/>
<text text-anchor="middle" x="3361" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU1</text>
<text text-anchor="middle" x="3361" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3361" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3361" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3361" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_gate_gpu1&#45;&gt;layer2_expert1_1 -->
<g id="edge694" class="edge">
<title>layer2_gate_gpu1&#45;&gt;layer2_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4582.82,-1958.19C4315.95,-1952.43 3687.25,-1934.07 3458.17,-1883.94"/>
<polygon fill="black" stroke="black" points="3458.75,-1880.48 3448.22,-1881.68 3457.2,-1887.31 3458.75,-1880.48"/>
</g>
<!-- layer2_expert1_2 -->
<g id="node429" class="node">
<title>layer2_expert1_2</title>
<polygon fill="lightgreen" stroke="black" points="3640,-1883.95 3466,-1883.95 3466,-1800.95 3640,-1800.95 3640,-1883.95"/>
<text text-anchor="middle" x="3553" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU1</text>
<text text-anchor="middle" x="3553" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3553" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3553" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3553" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_gate_gpu1&#45;&gt;layer2_expert1_2 -->
<g id="edge695" class="edge">
<title>layer2_gate_gpu1&#45;&gt;layer2_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4582.92,-1956.61C4348.28,-1948.41 3841.38,-1926.58 3650.19,-1883.95"/>
<polygon fill="black" stroke="black" points="3650.77,-1880.49 3640.23,-1881.64 3649.19,-1887.31 3650.77,-1880.49"/>
</g>
<!-- layer2_expert1_3 -->
<g id="node430" class="node">
<title>layer2_expert1_3</title>
<polygon fill="lightgreen" stroke="black" points="3832,-1883.95 3658,-1883.95 3658,-1800.95 3832,-1800.95 3832,-1883.95"/>
<text text-anchor="middle" x="3745" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU1</text>
<text text-anchor="middle" x="3745" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3745" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3745" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3745" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_gate_gpu1&#45;&gt;layer2_expert1_3 -->
<g id="edge696" class="edge">
<title>layer2_gate_gpu1&#45;&gt;layer2_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4582.77,-1954.32C4383.25,-1943.53 3995.31,-1919.15 3842,-1883.92"/>
<polygon fill="black" stroke="black" points="3842.79,-1880.5 3832.25,-1881.58 3841.16,-1887.31 3842.79,-1880.5"/>
</g>
<!-- layer2_expert1_4 -->
<g id="node431" class="node">
<title>layer2_expert1_4</title>
<polygon fill="lightgreen" stroke="black" points="4024,-1883.95 3850,-1883.95 3850,-1800.95 4024,-1800.95 4024,-1883.95"/>
<text text-anchor="middle" x="3937" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU1</text>
<text text-anchor="middle" x="3937" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3937" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3937" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3937" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_gate_gpu1&#45;&gt;layer2_expert1_4 -->
<g id="edge697" class="edge">
<title>layer2_gate_gpu1&#45;&gt;layer2_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4582.91,-1957C4449.03,-1950.86 4228.46,-1933.79 4033.84,-1883.96"/>
<polygon fill="black" stroke="black" points="4034.57,-1880.53 4024.01,-1881.4 4032.81,-1887.3 4034.57,-1880.53"/>
</g>
<!-- layer2_expert1_5 -->
<g id="node432" class="node">
<title>layer2_expert1_5</title>
<polygon fill="lightgreen" stroke="black" points="4216,-1883.95 4042,-1883.95 4042,-1800.95 4216,-1800.95 4216,-1883.95"/>
<text text-anchor="middle" x="4129" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU1</text>
<text text-anchor="middle" x="4129" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4129" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4129" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4129" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_gate_gpu1&#45;&gt;layer2_expert1_5 -->
<g id="edge698" class="edge">
<title>layer2_gate_gpu1&#45;&gt;layer2_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4582.91,-1949.21C4487.32,-1938.51 4351.37,-1919.09 4225.84,-1884"/>
<polygon fill="black" stroke="black" points="4226.63,-1880.59 4216.06,-1881.23 4224.72,-1887.32 4226.63,-1880.59"/>
</g>
<!-- layer2_expert1_6 -->
<g id="node433" class="node">
<title>layer2_expert1_6</title>
<polygon fill="lightgreen" stroke="black" points="4408,-1883.95 4234,-1883.95 4234,-1800.95 4408,-1800.95 4408,-1883.95"/>
<text text-anchor="middle" x="4321" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU1</text>
<text text-anchor="middle" x="4321" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4321" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4321" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4321" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_gate_gpu1&#45;&gt;layer2_expert1_6 -->
<g id="edge699" class="edge">
<title>layer2_gate_gpu1&#45;&gt;layer2_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4582.66,-1931.97C4533.66,-1919.59 4476.72,-1903.96 4417.67,-1884.07"/>
<polygon fill="black" stroke="black" points="4418.77,-1880.75 4408.18,-1880.84 4416.52,-1887.37 4418.77,-1880.75"/>
</g>
<!-- layer2_expert1_7 -->
<g id="node434" class="node">
<title>layer2_expert1_7</title>
<polygon fill="lightgreen" stroke="black" points="4600,-1883.95 4426,-1883.95 4426,-1800.95 4600,-1800.95 4600,-1883.95"/>
<text text-anchor="middle" x="4513" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU1</text>
<text text-anchor="middle" x="4513" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4513" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4513" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4513" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_gate_gpu1&#45;&gt;layer2_expert1_7 -->
<g id="edge700" class="edge">
<title>layer2_gate_gpu1&#45;&gt;layer2_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4638.39,-1919.86C4622.15,-1909.97 4604.68,-1899.32 4588.08,-1889.21"/>
<polygon fill="black" stroke="black" points="4589.86,-1886.19 4579.5,-1883.97 4586.21,-1892.17 4589.86,-1886.19"/>
</g>
<!-- layer2_expert1_8 -->
<g id="node435" class="node">
<title>layer2_expert1_8</title>
<polygon fill="lightgreen" stroke="black" points="4792,-1883.95 4618,-1883.95 4618,-1800.95 4792,-1800.95 4792,-1883.95"/>
<text text-anchor="middle" x="4705" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU1</text>
<text text-anchor="middle" x="4705" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4705" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4705" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4705" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_gate_gpu1&#45;&gt;layer2_expert1_8 -->
<g id="edge701" class="edge">
<title>layer2_gate_gpu1&#45;&gt;layer2_expert1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4705,-1919.86C4705,-1911.6 4705,-1902.82 4705,-1894.26"/>
<polygon fill="black" stroke="black" points="4708.5,-1893.97 4705,-1883.97 4701.5,-1893.97 4708.5,-1893.97"/>
</g>
<!-- layer2_expert1_9 -->
<g id="node436" class="node">
<title>layer2_expert1_9</title>
<polygon fill="lightgreen" stroke="black" points="4984,-1883.95 4810,-1883.95 4810,-1800.95 4984,-1800.95 4984,-1883.95"/>
<text text-anchor="middle" x="4897" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU1</text>
<text text-anchor="middle" x="4897" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4897" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4897" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4897" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_gate_gpu1&#45;&gt;layer2_expert1_9 -->
<g id="edge702" class="edge">
<title>layer2_gate_gpu1&#45;&gt;layer2_expert1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4771.61,-1919.86C4787.85,-1909.97 4805.32,-1899.32 4821.92,-1889.21"/>
<polygon fill="black" stroke="black" points="4823.79,-1892.17 4830.5,-1883.97 4820.14,-1886.19 4823.79,-1892.17"/>
</g>
<!-- layer2_expert1_10 -->
<g id="node437" class="node">
<title>layer2_expert1_10</title>
<polygon fill="lightgreen" stroke="black" points="5176,-1883.95 5002,-1883.95 5002,-1800.95 5176,-1800.95 5176,-1883.95"/>
<text text-anchor="middle" x="5089" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU1</text>
<text text-anchor="middle" x="5089" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5089" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5089" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5089" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_gate_gpu1&#45;&gt;layer2_expert1_10 -->
<g id="edge703" class="edge">
<title>layer2_gate_gpu1&#45;&gt;layer2_expert1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4827.34,-1931.97C4876.34,-1919.59 4933.28,-1903.96 4992.33,-1884.07"/>
<polygon fill="black" stroke="black" points="4993.48,-1887.37 5001.82,-1880.84 4991.23,-1880.75 4993.48,-1887.37"/>
</g>
<!-- layer2_expert1_11 -->
<g id="node438" class="node">
<title>layer2_expert1_11</title>
<polygon fill="lightgreen" stroke="black" points="5368,-1883.95 5194,-1883.95 5194,-1800.95 5368,-1800.95 5368,-1883.95"/>
<text text-anchor="middle" x="5281" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU1</text>
<text text-anchor="middle" x="5281" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5281" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5281" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5281" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_gate_gpu1&#45;&gt;layer2_expert1_11 -->
<g id="edge704" class="edge">
<title>layer2_gate_gpu1&#45;&gt;layer2_expert1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4827.09,-1949.21C4922.68,-1938.51 5058.63,-1919.09 5184.16,-1884"/>
<polygon fill="black" stroke="black" points="5185.28,-1887.32 5193.94,-1881.23 5183.37,-1880.59 5185.28,-1887.32"/>
</g>
<!-- layer2_expert1_12 -->
<g id="node439" class="node">
<title>layer2_expert1_12</title>
<polygon fill="lightgreen" stroke="black" points="5560,-1883.95 5386,-1883.95 5386,-1800.95 5560,-1800.95 5560,-1883.95"/>
<text text-anchor="middle" x="5473" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU1</text>
<text text-anchor="middle" x="5473" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5473" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5473" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5473" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_gate_gpu1&#45;&gt;layer2_expert1_12 -->
<g id="edge705" class="edge">
<title>layer2_gate_gpu1&#45;&gt;layer2_expert1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4827.09,-1957C4960.97,-1950.86 5181.54,-1933.79 5376.16,-1883.96"/>
<polygon fill="black" stroke="black" points="5377.19,-1887.3 5385.99,-1881.4 5375.43,-1880.53 5377.19,-1887.3"/>
</g>
<!-- layer2_expert1_13 -->
<g id="node440" class="node">
<title>layer2_expert1_13</title>
<polygon fill="lightgreen" stroke="black" points="5752,-1883.95 5578,-1883.95 5578,-1800.95 5752,-1800.95 5752,-1883.95"/>
<text text-anchor="middle" x="5665" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU1</text>
<text text-anchor="middle" x="5665" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5665" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5665" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5665" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_gate_gpu1&#45;&gt;layer2_expert1_13 -->
<g id="edge706" class="edge">
<title>layer2_gate_gpu1&#45;&gt;layer2_expert1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4827.23,-1954.32C5026.75,-1943.53 5414.69,-1919.15 5568,-1883.92"/>
<polygon fill="black" stroke="black" points="5568.84,-1887.31 5577.75,-1881.58 5567.21,-1880.5 5568.84,-1887.31"/>
</g>
<!-- layer2_expert1_14 -->
<g id="node441" class="node">
<title>layer2_expert1_14</title>
<polygon fill="lightgreen" stroke="black" points="5944,-1883.95 5770,-1883.95 5770,-1800.95 5944,-1800.95 5944,-1883.95"/>
<text text-anchor="middle" x="5857" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU1</text>
<text text-anchor="middle" x="5857" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5857" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5857" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5857" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_gate_gpu1&#45;&gt;layer2_expert1_14 -->
<g id="edge707" class="edge">
<title>layer2_gate_gpu1&#45;&gt;layer2_expert1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4827.08,-1956.61C5061.72,-1948.41 5568.62,-1926.58 5759.81,-1883.95"/>
<polygon fill="black" stroke="black" points="5760.81,-1887.31 5769.77,-1881.64 5759.23,-1880.49 5760.81,-1887.31"/>
</g>
<!-- layer2_expert1_15 -->
<g id="node442" class="node">
<title>layer2_expert1_15</title>
<polygon fill="lightgreen" stroke="black" points="6136,-1883.95 5962,-1883.95 5962,-1800.95 6136,-1800.95 6136,-1883.95"/>
<text text-anchor="middle" x="6049" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU1</text>
<text text-anchor="middle" x="6049" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6049" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6049" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6049" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_gate_gpu1&#45;&gt;layer2_expert1_15 -->
<g id="edge708" class="edge">
<title>layer2_gate_gpu1&#45;&gt;layer2_expert1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4827.18,-1958.19C5094.05,-1952.43 5722.75,-1934.07 5951.83,-1883.94"/>
<polygon fill="black" stroke="black" points="5952.8,-1887.31 5961.78,-1881.68 5951.25,-1880.48 5952.8,-1887.31"/>
</g>
<!-- layer2_moe_agg_gpu1 -->
<g id="node443" class="node">
<title>layer2_moe_agg_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="4806.5,-1764.95 4603.5,-1764.95 4603.5,-1696.95 4806.5,-1696.95 4806.5,-1764.95"/>
<text text-anchor="middle" x="4705" y="-1749.75" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU1</text>
<text text-anchor="middle" x="4705" y="-1734.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="4705" y="-1719.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="4705" y="-1704.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_expert1_0&#45;&gt;layer2_moe_agg_gpu1 -->
<g id="edge709" class="edge">
<title>layer2_expert1_0&#45;&gt;layer2_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3256.21,-1803.17C3259.16,-1802.36 3262.09,-1801.62 3265,-1800.95 3517.13,-1743.63 4300.27,-1733.89 4593.05,-1732.27"/>
<polygon fill="black" stroke="black" points="4593.27,-1735.77 4603.25,-1732.21 4593.24,-1728.77 4593.27,-1735.77"/>
</g>
<!-- layer2_expert1_1&#45;&gt;layer2_moe_agg_gpu1 -->
<g id="edge710" class="edge">
<title>layer2_expert1_1&#45;&gt;layer2_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3448.22,-1803.2C3451.16,-1802.38 3454.09,-1801.63 3457,-1800.95 3671.24,-1751.42 4328.44,-1737.07 4592.97,-1733.24"/>
<polygon fill="black" stroke="black" points="4593.41,-1736.73 4603.36,-1733.09 4593.31,-1729.73 4593.41,-1736.73"/>
</g>
<!-- layer2_expert1_2&#45;&gt;layer2_moe_agg_gpu1 -->
<g id="edge711" class="edge">
<title>layer2_expert1_2&#45;&gt;layer2_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3640.23,-1803.24C3643.17,-1802.41 3646.1,-1801.64 3649,-1800.95 3825.72,-1759.16 4359.22,-1740.77 4593.09,-1734.56"/>
<polygon fill="black" stroke="black" points="4593.42,-1738.05 4603.32,-1734.29 4593.23,-1731.05 4593.42,-1738.05"/>
</g>
<!-- layer2_expert1_3&#45;&gt;layer2_moe_agg_gpu1 -->
<g id="edge712" class="edge">
<title>layer2_expert1_3&#45;&gt;layer2_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3832.24,-1803.3C3835.18,-1802.45 3838.1,-1801.66 3841,-1800.95 3980.55,-1766.88 4392.54,-1745.25 4592.96,-1736.46"/>
<polygon fill="black" stroke="black" points="4593.39,-1739.94 4603.22,-1736.01 4593.08,-1732.95 4593.39,-1739.94"/>
</g>
<!-- layer2_expert1_4&#45;&gt;layer2_moe_agg_gpu1 -->
<g id="edge713" class="edge">
<title>layer2_expert1_4&#45;&gt;layer2_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4024.26,-1803.38C4027.19,-1802.51 4030.11,-1801.69 4033,-1800.95 4225.8,-1751.56 4458.29,-1737.33 4593.12,-1733.35"/>
<polygon fill="black" stroke="black" points="4593.56,-1736.84 4603.46,-1733.06 4593.37,-1729.84 4593.56,-1736.84"/>
</g>
<!-- layer2_expert1_5&#45;&gt;layer2_moe_agg_gpu1 -->
<g id="edge714" class="edge">
<title>layer2_expert1_5&#45;&gt;layer2_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4216.04,-1803.62C4219.04,-1802.67 4222.04,-1801.78 4225,-1800.95 4348.52,-1766.64 4494.92,-1748.73 4593.28,-1739.86"/>
<polygon fill="black" stroke="black" points="4593.59,-1743.34 4603.24,-1738.97 4592.97,-1736.37 4593.59,-1743.34"/>
</g>
<!-- layer2_expert1_6&#45;&gt;layer2_moe_agg_gpu1 -->
<g id="edge715" class="edge">
<title>layer2_expert1_6&#45;&gt;layer2_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4408.15,-1803.97C4411.12,-1802.92 4414.08,-1801.91 4417,-1800.95 4474.25,-1782.16 4539.45,-1766.11 4593.32,-1754.23"/>
<polygon fill="black" stroke="black" points="4594.22,-1757.62 4603.24,-1752.06 4592.72,-1750.78 4594.22,-1757.62"/>
</g>
<!-- layer2_expert1_7&#45;&gt;layer2_moe_agg_gpu1 -->
<g id="edge716" class="edge">
<title>layer2_expert1_7&#45;&gt;layer2_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4584.22,-1800.84C4601.85,-1790.78 4620.68,-1780.04 4638.1,-1770.11"/>
<polygon fill="black" stroke="black" points="4640.11,-1772.99 4647.06,-1765 4636.64,-1766.91 4640.11,-1772.99"/>
</g>
<!-- layer2_expert1_8&#45;&gt;layer2_moe_agg_gpu1 -->
<g id="edge717" class="edge">
<title>layer2_expert1_8&#45;&gt;layer2_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4705,-1800.68C4705,-1792.47 4705,-1783.81 4705,-1775.51"/>
<polygon fill="black" stroke="black" points="4708.5,-1775.25 4705,-1765.25 4701.5,-1775.25 4708.5,-1775.25"/>
</g>
<!-- layer2_expert1_9&#45;&gt;layer2_moe_agg_gpu1 -->
<g id="edge718" class="edge">
<title>layer2_expert1_9&#45;&gt;layer2_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4825.78,-1800.84C4808.15,-1790.78 4789.32,-1780.04 4771.9,-1770.11"/>
<polygon fill="black" stroke="black" points="4773.36,-1766.91 4762.94,-1765 4769.89,-1772.99 4773.36,-1766.91"/>
</g>
<!-- layer2_expert1_10&#45;&gt;layer2_moe_agg_gpu1 -->
<g id="edge719" class="edge">
<title>layer2_expert1_10&#45;&gt;layer2_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5001.85,-1803.97C4998.88,-1802.92 4995.92,-1801.91 4993,-1800.95 4935.75,-1782.16 4870.55,-1766.11 4816.68,-1754.23"/>
<polygon fill="black" stroke="black" points="4817.28,-1750.78 4806.76,-1752.06 4815.78,-1757.62 4817.28,-1750.78"/>
</g>
<!-- layer2_expert1_11&#45;&gt;layer2_moe_agg_gpu1 -->
<g id="edge720" class="edge">
<title>layer2_expert1_11&#45;&gt;layer2_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5193.96,-1803.62C5190.96,-1802.67 5187.96,-1801.78 5185,-1800.95 5061.48,-1766.64 4915.08,-1748.73 4816.72,-1739.86"/>
<polygon fill="black" stroke="black" points="4817.03,-1736.37 4806.76,-1738.97 4816.41,-1743.34 4817.03,-1736.37"/>
</g>
<!-- layer2_expert1_12&#45;&gt;layer2_moe_agg_gpu1 -->
<g id="edge721" class="edge">
<title>layer2_expert1_12&#45;&gt;layer2_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5385.74,-1803.38C5382.81,-1802.51 5379.89,-1801.69 5377,-1800.95 5184.2,-1751.56 4951.71,-1737.33 4816.88,-1733.35"/>
<polygon fill="black" stroke="black" points="4816.63,-1729.84 4806.54,-1733.06 4816.44,-1736.84 4816.63,-1729.84"/>
</g>
<!-- layer2_expert1_13&#45;&gt;layer2_moe_agg_gpu1 -->
<g id="edge722" class="edge">
<title>layer2_expert1_13&#45;&gt;layer2_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5577.76,-1803.3C5574.82,-1802.45 5571.9,-1801.66 5569,-1800.95 5429.45,-1766.88 5017.46,-1745.25 4817.04,-1736.46"/>
<polygon fill="black" stroke="black" points="4816.92,-1732.95 4806.78,-1736.01 4816.61,-1739.94 4816.92,-1732.95"/>
</g>
<!-- layer2_expert1_14&#45;&gt;layer2_moe_agg_gpu1 -->
<g id="edge723" class="edge">
<title>layer2_expert1_14&#45;&gt;layer2_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5769.77,-1803.24C5766.83,-1802.41 5763.9,-1801.64 5761,-1800.95 5584.28,-1759.16 5050.78,-1740.77 4816.91,-1734.56"/>
<polygon fill="black" stroke="black" points="4816.77,-1731.05 4806.68,-1734.29 4816.58,-1738.05 4816.77,-1731.05"/>
</g>
<!-- layer2_expert1_15&#45;&gt;layer2_moe_agg_gpu1 -->
<g id="edge724" class="edge">
<title>layer2_expert1_15&#45;&gt;layer2_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5961.78,-1803.2C5958.84,-1802.38 5955.91,-1801.63 5953,-1800.95 5738.76,-1751.42 5081.56,-1737.07 4817.03,-1733.24"/>
<polygon fill="black" stroke="black" points="4816.69,-1729.73 4806.64,-1733.09 4816.59,-1736.73 4816.69,-1729.73"/>
</g>
<!-- layer2_moe_agg_gpu1&#45;&gt;layer2_moe_allreduce -->
<g id="edge725" class="edge">
<title>layer2_moe_agg_gpu1&#45;&gt;layer2_moe_allreduce</title>
<path fill="none" stroke="black" d="M4806.83,-1728.13C5607.22,-1713.77 10886.32,-1619.11 12058.64,-1598.08"/>
<polygon fill="black" stroke="black" points="12058.93,-1601.58 12068.86,-1597.9 12058.8,-1594.58 12058.93,-1601.58"/>
</g>
<!-- layer2_output_gpu1 -->
<g id="node444" class="node">
<title>layer2_output_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11756,-1488.95 11512,-1488.95 11512,-1420.95 11756,-1420.95 11756,-1488.95"/>
<text text-anchor="middle" x="11634" y="-1473.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU1</text>
<text text-anchor="middle" x="11634" y="-1458.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="11634" y="-1443.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11634" y="-1428.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_qkv_gpu1 -->
<g id="node563" class="node">
<title>layer3_qkv_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11735,-1384.95 11535,-1384.95 11535,-1286.95 11735,-1286.95 11735,-1384.95"/>
<text text-anchor="middle" x="11635" y="-1369.75" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU1</text>
<text text-anchor="middle" x="11635" y="-1354.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11635" y="-1339.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11635" y="-1324.75" font-family="Times,serif" font-size="14.00">Heads: 4&#45;7</text>
<text text-anchor="middle" x="11635" y="-1309.75" font-family="Times,serif" font-size="14.00">TP Slice: 1</text>
<text text-anchor="middle" x="11635" y="-1294.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_output_gpu1&#45;&gt;layer3_qkv_gpu1 -->
<g id="edge962" class="edge">
<title>layer2_output_gpu1&#45;&gt;layer3_qkv_gpu1</title>
<path fill="none" stroke="black" d="M11634.28,-1420.74C11634.35,-1412.78 11634.43,-1404.04 11634.5,-1395.3"/>
<polygon fill="black" stroke="black" points="11638,-1395.13 11634.59,-1385.1 11631,-1395.07 11638,-1395.13"/>
</g>
<!-- layer2_expert2_0 -->
<g id="node446" class="node">
<title>layer2_expert2_0</title>
<polygon fill="lightgreen" stroke="black" points="6328,-1883.95 6154,-1883.95 6154,-1800.95 6328,-1800.95 6328,-1883.95"/>
<text text-anchor="middle" x="6241" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU2</text>
<text text-anchor="middle" x="6241" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6241" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6241" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6241" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gate_gpu2&#45;&gt;layer2_expert2_0 -->
<g id="edge732" class="edge">
<title>layer2_gate_gpu2&#45;&gt;layer2_expert2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7654.8,-1959.37C7358.21,-1955.87 6605.59,-1941.65 6338.29,-1883.96"/>
<polygon fill="black" stroke="black" points="6338.74,-1880.48 6328.22,-1881.71 6337.22,-1887.31 6338.74,-1880.48"/>
</g>
<!-- layer2_expert2_1 -->
<g id="node447" class="node">
<title>layer2_expert2_1</title>
<polygon fill="lightgreen" stroke="black" points="6520,-1883.95 6346,-1883.95 6346,-1800.95 6520,-1800.95 6520,-1883.95"/>
<text text-anchor="middle" x="6433" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU2</text>
<text text-anchor="middle" x="6433" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6433" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6433" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6433" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gate_gpu2&#45;&gt;layer2_expert2_1 -->
<g id="edge733" class="edge">
<title>layer2_gate_gpu2&#45;&gt;layer2_expert2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7654.82,-1958.19C7387.95,-1952.43 6759.25,-1934.07 6530.17,-1883.94"/>
<polygon fill="black" stroke="black" points="6530.75,-1880.48 6520.22,-1881.68 6529.2,-1887.31 6530.75,-1880.48"/>
</g>
<!-- layer2_expert2_2 -->
<g id="node448" class="node">
<title>layer2_expert2_2</title>
<polygon fill="lightgreen" stroke="black" points="6712,-1883.95 6538,-1883.95 6538,-1800.95 6712,-1800.95 6712,-1883.95"/>
<text text-anchor="middle" x="6625" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU2</text>
<text text-anchor="middle" x="6625" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6625" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6625" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6625" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gate_gpu2&#45;&gt;layer2_expert2_2 -->
<g id="edge734" class="edge">
<title>layer2_gate_gpu2&#45;&gt;layer2_expert2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7654.92,-1956.61C7420.28,-1948.41 6913.38,-1926.58 6722.19,-1883.95"/>
<polygon fill="black" stroke="black" points="6722.77,-1880.49 6712.23,-1881.64 6721.19,-1887.31 6722.77,-1880.49"/>
</g>
<!-- layer2_expert2_3 -->
<g id="node449" class="node">
<title>layer2_expert2_3</title>
<polygon fill="lightgreen" stroke="black" points="6904,-1883.95 6730,-1883.95 6730,-1800.95 6904,-1800.95 6904,-1883.95"/>
<text text-anchor="middle" x="6817" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU2</text>
<text text-anchor="middle" x="6817" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6817" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6817" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6817" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gate_gpu2&#45;&gt;layer2_expert2_3 -->
<g id="edge735" class="edge">
<title>layer2_gate_gpu2&#45;&gt;layer2_expert2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7654.77,-1954.32C7455.25,-1943.53 7067.31,-1919.15 6914,-1883.92"/>
<polygon fill="black" stroke="black" points="6914.79,-1880.5 6904.25,-1881.58 6913.16,-1887.31 6914.79,-1880.5"/>
</g>
<!-- layer2_expert2_4 -->
<g id="node450" class="node">
<title>layer2_expert2_4</title>
<polygon fill="lightgreen" stroke="black" points="7096,-1883.95 6922,-1883.95 6922,-1800.95 7096,-1800.95 7096,-1883.95"/>
<text text-anchor="middle" x="7009" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU2</text>
<text text-anchor="middle" x="7009" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7009" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7009" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7009" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gate_gpu2&#45;&gt;layer2_expert2_4 -->
<g id="edge736" class="edge">
<title>layer2_gate_gpu2&#45;&gt;layer2_expert2_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7654.91,-1957C7521.03,-1950.86 7300.46,-1933.79 7105.84,-1883.96"/>
<polygon fill="black" stroke="black" points="7106.57,-1880.53 7096.01,-1881.4 7104.81,-1887.3 7106.57,-1880.53"/>
</g>
<!-- layer2_expert2_5 -->
<g id="node451" class="node">
<title>layer2_expert2_5</title>
<polygon fill="lightgreen" stroke="black" points="7288,-1883.95 7114,-1883.95 7114,-1800.95 7288,-1800.95 7288,-1883.95"/>
<text text-anchor="middle" x="7201" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU2</text>
<text text-anchor="middle" x="7201" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7201" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7201" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7201" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gate_gpu2&#45;&gt;layer2_expert2_5 -->
<g id="edge737" class="edge">
<title>layer2_gate_gpu2&#45;&gt;layer2_expert2_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7654.91,-1949.21C7559.32,-1938.51 7423.37,-1919.09 7297.84,-1884"/>
<polygon fill="black" stroke="black" points="7298.63,-1880.59 7288.06,-1881.23 7296.72,-1887.32 7298.63,-1880.59"/>
</g>
<!-- layer2_expert2_6 -->
<g id="node452" class="node">
<title>layer2_expert2_6</title>
<polygon fill="lightgreen" stroke="black" points="7480,-1883.95 7306,-1883.95 7306,-1800.95 7480,-1800.95 7480,-1883.95"/>
<text text-anchor="middle" x="7393" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU2</text>
<text text-anchor="middle" x="7393" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7393" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7393" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7393" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gate_gpu2&#45;&gt;layer2_expert2_6 -->
<g id="edge738" class="edge">
<title>layer2_gate_gpu2&#45;&gt;layer2_expert2_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7654.66,-1931.97C7605.66,-1919.59 7548.72,-1903.96 7489.67,-1884.07"/>
<polygon fill="black" stroke="black" points="7490.77,-1880.75 7480.18,-1880.84 7488.52,-1887.37 7490.77,-1880.75"/>
</g>
<!-- layer2_expert2_7 -->
<g id="node453" class="node">
<title>layer2_expert2_7</title>
<polygon fill="lightgreen" stroke="black" points="7672,-1883.95 7498,-1883.95 7498,-1800.95 7672,-1800.95 7672,-1883.95"/>
<text text-anchor="middle" x="7585" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU2</text>
<text text-anchor="middle" x="7585" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7585" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7585" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7585" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gate_gpu2&#45;&gt;layer2_expert2_7 -->
<g id="edge739" class="edge">
<title>layer2_gate_gpu2&#45;&gt;layer2_expert2_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7710.39,-1919.86C7694.15,-1909.97 7676.68,-1899.32 7660.08,-1889.21"/>
<polygon fill="black" stroke="black" points="7661.86,-1886.19 7651.5,-1883.97 7658.21,-1892.17 7661.86,-1886.19"/>
</g>
<!-- layer2_expert2_8 -->
<g id="node454" class="node">
<title>layer2_expert2_8</title>
<polygon fill="lightgreen" stroke="black" points="7864,-1883.95 7690,-1883.95 7690,-1800.95 7864,-1800.95 7864,-1883.95"/>
<text text-anchor="middle" x="7777" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU2</text>
<text text-anchor="middle" x="7777" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7777" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7777" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7777" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gate_gpu2&#45;&gt;layer2_expert2_8 -->
<g id="edge740" class="edge">
<title>layer2_gate_gpu2&#45;&gt;layer2_expert2_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7777,-1919.86C7777,-1911.6 7777,-1902.82 7777,-1894.26"/>
<polygon fill="black" stroke="black" points="7780.5,-1893.97 7777,-1883.97 7773.5,-1893.97 7780.5,-1893.97"/>
</g>
<!-- layer2_expert2_9 -->
<g id="node455" class="node">
<title>layer2_expert2_9</title>
<polygon fill="lightgreen" stroke="black" points="8056,-1883.95 7882,-1883.95 7882,-1800.95 8056,-1800.95 8056,-1883.95"/>
<text text-anchor="middle" x="7969" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU2</text>
<text text-anchor="middle" x="7969" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7969" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7969" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7969" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gate_gpu2&#45;&gt;layer2_expert2_9 -->
<g id="edge741" class="edge">
<title>layer2_gate_gpu2&#45;&gt;layer2_expert2_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7843.61,-1919.86C7859.85,-1909.97 7877.32,-1899.32 7893.92,-1889.21"/>
<polygon fill="black" stroke="black" points="7895.79,-1892.17 7902.5,-1883.97 7892.14,-1886.19 7895.79,-1892.17"/>
</g>
<!-- layer2_expert2_10 -->
<g id="node456" class="node">
<title>layer2_expert2_10</title>
<polygon fill="lightgreen" stroke="black" points="8248,-1883.95 8074,-1883.95 8074,-1800.95 8248,-1800.95 8248,-1883.95"/>
<text text-anchor="middle" x="8161" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU2</text>
<text text-anchor="middle" x="8161" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8161" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8161" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8161" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gate_gpu2&#45;&gt;layer2_expert2_10 -->
<g id="edge742" class="edge">
<title>layer2_gate_gpu2&#45;&gt;layer2_expert2_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7899.34,-1931.97C7948.34,-1919.59 8005.28,-1903.96 8064.33,-1884.07"/>
<polygon fill="black" stroke="black" points="8065.48,-1887.37 8073.82,-1880.84 8063.23,-1880.75 8065.48,-1887.37"/>
</g>
<!-- layer2_expert2_11 -->
<g id="node457" class="node">
<title>layer2_expert2_11</title>
<polygon fill="lightgreen" stroke="black" points="8440,-1883.95 8266,-1883.95 8266,-1800.95 8440,-1800.95 8440,-1883.95"/>
<text text-anchor="middle" x="8353" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU2</text>
<text text-anchor="middle" x="8353" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8353" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8353" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8353" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gate_gpu2&#45;&gt;layer2_expert2_11 -->
<g id="edge743" class="edge">
<title>layer2_gate_gpu2&#45;&gt;layer2_expert2_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7899.09,-1949.21C7994.68,-1938.51 8130.63,-1919.09 8256.16,-1884"/>
<polygon fill="black" stroke="black" points="8257.28,-1887.32 8265.94,-1881.23 8255.37,-1880.59 8257.28,-1887.32"/>
</g>
<!-- layer2_expert2_12 -->
<g id="node458" class="node">
<title>layer2_expert2_12</title>
<polygon fill="lightgreen" stroke="black" points="8632,-1883.95 8458,-1883.95 8458,-1800.95 8632,-1800.95 8632,-1883.95"/>
<text text-anchor="middle" x="8545" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU2</text>
<text text-anchor="middle" x="8545" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8545" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8545" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8545" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gate_gpu2&#45;&gt;layer2_expert2_12 -->
<g id="edge744" class="edge">
<title>layer2_gate_gpu2&#45;&gt;layer2_expert2_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7899.09,-1957C8032.97,-1950.86 8253.54,-1933.79 8448.16,-1883.96"/>
<polygon fill="black" stroke="black" points="8449.19,-1887.3 8457.99,-1881.4 8447.43,-1880.53 8449.19,-1887.3"/>
</g>
<!-- layer2_expert2_13 -->
<g id="node459" class="node">
<title>layer2_expert2_13</title>
<polygon fill="lightgreen" stroke="black" points="8824,-1883.95 8650,-1883.95 8650,-1800.95 8824,-1800.95 8824,-1883.95"/>
<text text-anchor="middle" x="8737" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU2</text>
<text text-anchor="middle" x="8737" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8737" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8737" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8737" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gate_gpu2&#45;&gt;layer2_expert2_13 -->
<g id="edge745" class="edge">
<title>layer2_gate_gpu2&#45;&gt;layer2_expert2_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7899.23,-1954.32C8098.75,-1943.53 8486.69,-1919.15 8640,-1883.92"/>
<polygon fill="black" stroke="black" points="8640.84,-1887.31 8649.75,-1881.58 8639.21,-1880.5 8640.84,-1887.31"/>
</g>
<!-- layer2_expert2_14 -->
<g id="node460" class="node">
<title>layer2_expert2_14</title>
<polygon fill="lightgreen" stroke="black" points="9016,-1883.95 8842,-1883.95 8842,-1800.95 9016,-1800.95 9016,-1883.95"/>
<text text-anchor="middle" x="8929" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU2</text>
<text text-anchor="middle" x="8929" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8929" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8929" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8929" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gate_gpu2&#45;&gt;layer2_expert2_14 -->
<g id="edge746" class="edge">
<title>layer2_gate_gpu2&#45;&gt;layer2_expert2_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7899.08,-1956.61C8133.72,-1948.41 8640.62,-1926.58 8831.81,-1883.95"/>
<polygon fill="black" stroke="black" points="8832.81,-1887.31 8841.77,-1881.64 8831.23,-1880.49 8832.81,-1887.31"/>
</g>
<!-- layer2_expert2_15 -->
<g id="node461" class="node">
<title>layer2_expert2_15</title>
<polygon fill="lightgreen" stroke="black" points="9208,-1883.95 9034,-1883.95 9034,-1800.95 9208,-1800.95 9208,-1883.95"/>
<text text-anchor="middle" x="9121" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU2</text>
<text text-anchor="middle" x="9121" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9121" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9121" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9121" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gate_gpu2&#45;&gt;layer2_expert2_15 -->
<g id="edge747" class="edge">
<title>layer2_gate_gpu2&#45;&gt;layer2_expert2_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7899.18,-1958.19C8166.05,-1952.43 8794.75,-1934.07 9023.83,-1883.94"/>
<polygon fill="black" stroke="black" points="9024.8,-1887.31 9033.78,-1881.68 9023.25,-1880.48 9024.8,-1887.31"/>
</g>
<!-- layer2_moe_agg_gpu2 -->
<g id="node462" class="node">
<title>layer2_moe_agg_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="7878.5,-1764.95 7675.5,-1764.95 7675.5,-1696.95 7878.5,-1696.95 7878.5,-1764.95"/>
<text text-anchor="middle" x="7777" y="-1749.75" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU2</text>
<text text-anchor="middle" x="7777" y="-1734.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="7777" y="-1719.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="7777" y="-1704.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_expert2_0&#45;&gt;layer2_moe_agg_gpu2 -->
<g id="edge748" class="edge">
<title>layer2_expert2_0&#45;&gt;layer2_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6328.21,-1803.17C6331.16,-1802.36 6334.09,-1801.62 6337,-1800.95 6589.13,-1743.63 7372.27,-1733.89 7665.05,-1732.27"/>
<polygon fill="black" stroke="black" points="7665.27,-1735.77 7675.25,-1732.21 7665.24,-1728.77 7665.27,-1735.77"/>
</g>
<!-- layer2_expert2_1&#45;&gt;layer2_moe_agg_gpu2 -->
<g id="edge749" class="edge">
<title>layer2_expert2_1&#45;&gt;layer2_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6520.22,-1803.2C6523.16,-1802.38 6526.09,-1801.63 6529,-1800.95 6743.24,-1751.42 7400.44,-1737.07 7664.97,-1733.24"/>
<polygon fill="black" stroke="black" points="7665.41,-1736.73 7675.36,-1733.09 7665.31,-1729.73 7665.41,-1736.73"/>
</g>
<!-- layer2_expert2_2&#45;&gt;layer2_moe_agg_gpu2 -->
<g id="edge750" class="edge">
<title>layer2_expert2_2&#45;&gt;layer2_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6712.23,-1803.24C6715.17,-1802.41 6718.1,-1801.64 6721,-1800.95 6897.72,-1759.16 7431.22,-1740.77 7665.09,-1734.56"/>
<polygon fill="black" stroke="black" points="7665.42,-1738.05 7675.32,-1734.29 7665.23,-1731.05 7665.42,-1738.05"/>
</g>
<!-- layer2_expert2_3&#45;&gt;layer2_moe_agg_gpu2 -->
<g id="edge751" class="edge">
<title>layer2_expert2_3&#45;&gt;layer2_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6904.24,-1803.3C6907.18,-1802.45 6910.1,-1801.66 6913,-1800.95 7052.55,-1766.88 7464.54,-1745.25 7664.96,-1736.46"/>
<polygon fill="black" stroke="black" points="7665.39,-1739.94 7675.22,-1736.01 7665.08,-1732.95 7665.39,-1739.94"/>
</g>
<!-- layer2_expert2_4&#45;&gt;layer2_moe_agg_gpu2 -->
<g id="edge752" class="edge">
<title>layer2_expert2_4&#45;&gt;layer2_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7096.26,-1803.38C7099.19,-1802.51 7102.11,-1801.69 7105,-1800.95 7297.8,-1751.56 7530.29,-1737.33 7665.12,-1733.35"/>
<polygon fill="black" stroke="black" points="7665.56,-1736.84 7675.46,-1733.06 7665.37,-1729.84 7665.56,-1736.84"/>
</g>
<!-- layer2_expert2_5&#45;&gt;layer2_moe_agg_gpu2 -->
<g id="edge753" class="edge">
<title>layer2_expert2_5&#45;&gt;layer2_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7288.04,-1803.62C7291.04,-1802.67 7294.04,-1801.78 7297,-1800.95 7420.52,-1766.64 7566.92,-1748.73 7665.28,-1739.86"/>
<polygon fill="black" stroke="black" points="7665.59,-1743.34 7675.24,-1738.97 7664.97,-1736.37 7665.59,-1743.34"/>
</g>
<!-- layer2_expert2_6&#45;&gt;layer2_moe_agg_gpu2 -->
<g id="edge754" class="edge">
<title>layer2_expert2_6&#45;&gt;layer2_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7480.15,-1803.97C7483.12,-1802.92 7486.08,-1801.91 7489,-1800.95 7546.25,-1782.16 7611.45,-1766.11 7665.32,-1754.23"/>
<polygon fill="black" stroke="black" points="7666.22,-1757.62 7675.24,-1752.06 7664.72,-1750.78 7666.22,-1757.62"/>
</g>
<!-- layer2_expert2_7&#45;&gt;layer2_moe_agg_gpu2 -->
<g id="edge755" class="edge">
<title>layer2_expert2_7&#45;&gt;layer2_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7656.22,-1800.84C7673.85,-1790.78 7692.68,-1780.04 7710.1,-1770.11"/>
<polygon fill="black" stroke="black" points="7712.11,-1772.99 7719.06,-1765 7708.64,-1766.91 7712.11,-1772.99"/>
</g>
<!-- layer2_expert2_8&#45;&gt;layer2_moe_agg_gpu2 -->
<g id="edge756" class="edge">
<title>layer2_expert2_8&#45;&gt;layer2_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7777,-1800.68C7777,-1792.47 7777,-1783.81 7777,-1775.51"/>
<polygon fill="black" stroke="black" points="7780.5,-1775.25 7777,-1765.25 7773.5,-1775.25 7780.5,-1775.25"/>
</g>
<!-- layer2_expert2_9&#45;&gt;layer2_moe_agg_gpu2 -->
<g id="edge757" class="edge">
<title>layer2_expert2_9&#45;&gt;layer2_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7897.78,-1800.84C7880.15,-1790.78 7861.32,-1780.04 7843.9,-1770.11"/>
<polygon fill="black" stroke="black" points="7845.36,-1766.91 7834.94,-1765 7841.89,-1772.99 7845.36,-1766.91"/>
</g>
<!-- layer2_expert2_10&#45;&gt;layer2_moe_agg_gpu2 -->
<g id="edge758" class="edge">
<title>layer2_expert2_10&#45;&gt;layer2_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8073.85,-1803.97C8070.88,-1802.92 8067.92,-1801.91 8065,-1800.95 8007.75,-1782.16 7942.55,-1766.11 7888.68,-1754.23"/>
<polygon fill="black" stroke="black" points="7889.28,-1750.78 7878.76,-1752.06 7887.78,-1757.62 7889.28,-1750.78"/>
</g>
<!-- layer2_expert2_11&#45;&gt;layer2_moe_agg_gpu2 -->
<g id="edge759" class="edge">
<title>layer2_expert2_11&#45;&gt;layer2_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8265.96,-1803.62C8262.96,-1802.67 8259.96,-1801.78 8257,-1800.95 8133.48,-1766.64 7987.08,-1748.73 7888.72,-1739.86"/>
<polygon fill="black" stroke="black" points="7889.03,-1736.37 7878.76,-1738.97 7888.41,-1743.34 7889.03,-1736.37"/>
</g>
<!-- layer2_expert2_12&#45;&gt;layer2_moe_agg_gpu2 -->
<g id="edge760" class="edge">
<title>layer2_expert2_12&#45;&gt;layer2_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8457.74,-1803.38C8454.81,-1802.51 8451.89,-1801.69 8449,-1800.95 8256.2,-1751.56 8023.71,-1737.33 7888.88,-1733.35"/>
<polygon fill="black" stroke="black" points="7888.63,-1729.84 7878.54,-1733.06 7888.44,-1736.84 7888.63,-1729.84"/>
</g>
<!-- layer2_expert2_13&#45;&gt;layer2_moe_agg_gpu2 -->
<g id="edge761" class="edge">
<title>layer2_expert2_13&#45;&gt;layer2_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8649.76,-1803.3C8646.82,-1802.45 8643.9,-1801.66 8641,-1800.95 8501.45,-1766.88 8089.46,-1745.25 7889.04,-1736.46"/>
<polygon fill="black" stroke="black" points="7888.92,-1732.95 7878.78,-1736.01 7888.61,-1739.94 7888.92,-1732.95"/>
</g>
<!-- layer2_expert2_14&#45;&gt;layer2_moe_agg_gpu2 -->
<g id="edge762" class="edge">
<title>layer2_expert2_14&#45;&gt;layer2_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8841.77,-1803.24C8838.83,-1802.41 8835.9,-1801.64 8833,-1800.95 8656.28,-1759.16 8122.78,-1740.77 7888.91,-1734.56"/>
<polygon fill="black" stroke="black" points="7888.77,-1731.05 7878.68,-1734.29 7888.58,-1738.05 7888.77,-1731.05"/>
</g>
<!-- layer2_expert2_15&#45;&gt;layer2_moe_agg_gpu2 -->
<g id="edge763" class="edge">
<title>layer2_expert2_15&#45;&gt;layer2_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M9033.78,-1803.2C9030.84,-1802.38 9027.91,-1801.63 9025,-1800.95 8810.76,-1751.42 8153.56,-1737.07 7889.03,-1733.24"/>
<polygon fill="black" stroke="black" points="7888.69,-1729.73 7878.64,-1733.09 7888.59,-1736.73 7888.69,-1729.73"/>
</g>
<!-- layer2_moe_agg_gpu2&#45;&gt;layer2_moe_allreduce -->
<g id="edge764" class="edge">
<title>layer2_moe_agg_gpu2&#45;&gt;layer2_moe_allreduce</title>
<path fill="none" stroke="black" d="M7878.64,-1726.89C8448.87,-1709.7 11253.83,-1625.16 12067.42,-1600.63"/>
<polygon fill="black" stroke="black" points="12067.6,-1604.13 12077.49,-1600.33 12067.39,-1597.13 12067.6,-1604.13"/>
</g>
<!-- layer2_output_gpu2 -->
<g id="node463" class="node">
<title>layer2_output_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="12018,-1488.95 11774,-1488.95 11774,-1420.95 12018,-1420.95 12018,-1488.95"/>
<text text-anchor="middle" x="11896" y="-1473.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU2</text>
<text text-anchor="middle" x="11896" y="-1458.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="11896" y="-1443.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11896" y="-1428.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_qkv_gpu2 -->
<g id="node566" class="node">
<title>layer3_qkv_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="11997,-1384.95 11797,-1384.95 11797,-1286.95 11997,-1286.95 11997,-1384.95"/>
<text text-anchor="middle" x="11897" y="-1369.75" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU2</text>
<text text-anchor="middle" x="11897" y="-1354.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11897" y="-1339.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11897" y="-1324.75" font-family="Times,serif" font-size="14.00">Heads: 8&#45;11</text>
<text text-anchor="middle" x="11897" y="-1309.75" font-family="Times,serif" font-size="14.00">TP Slice: 2</text>
<text text-anchor="middle" x="11897" y="-1294.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_output_gpu2&#45;&gt;layer3_qkv_gpu2 -->
<g id="edge963" class="edge">
<title>layer2_output_gpu2&#45;&gt;layer3_qkv_gpu2</title>
<path fill="none" stroke="black" d="M11896.28,-1420.74C11896.35,-1412.78 11896.43,-1404.04 11896.5,-1395.3"/>
<polygon fill="black" stroke="black" points="11900,-1395.13 11896.59,-1385.1 11893,-1395.07 11900,-1395.13"/>
</g>
<!-- layer2_expert3_0 -->
<g id="node465" class="node">
<title>layer2_expert3_0</title>
<polygon fill="lightgreen" stroke="black" points="9400,-1883.95 9226,-1883.95 9226,-1800.95 9400,-1800.95 9400,-1883.95"/>
<text text-anchor="middle" x="9313" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU3</text>
<text text-anchor="middle" x="9313" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9313" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9313" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9313" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gate_gpu3&#45;&gt;layer2_expert3_0 -->
<g id="edge771" class="edge">
<title>layer2_gate_gpu3&#45;&gt;layer2_expert3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10726.8,-1959.37C10430.21,-1955.87 9677.59,-1941.65 9410.29,-1883.96"/>
<polygon fill="black" stroke="black" points="9410.74,-1880.48 9400.22,-1881.71 9409.22,-1887.31 9410.74,-1880.48"/>
</g>
<!-- layer2_expert3_1 -->
<g id="node466" class="node">
<title>layer2_expert3_1</title>
<polygon fill="lightgreen" stroke="black" points="9592,-1883.95 9418,-1883.95 9418,-1800.95 9592,-1800.95 9592,-1883.95"/>
<text text-anchor="middle" x="9505" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU3</text>
<text text-anchor="middle" x="9505" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9505" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9505" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9505" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gate_gpu3&#45;&gt;layer2_expert3_1 -->
<g id="edge772" class="edge">
<title>layer2_gate_gpu3&#45;&gt;layer2_expert3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10726.82,-1958.19C10459.95,-1952.43 9831.25,-1934.07 9602.17,-1883.94"/>
<polygon fill="black" stroke="black" points="9602.75,-1880.48 9592.22,-1881.68 9601.2,-1887.31 9602.75,-1880.48"/>
</g>
<!-- layer2_expert3_2 -->
<g id="node467" class="node">
<title>layer2_expert3_2</title>
<polygon fill="lightgreen" stroke="black" points="9784,-1883.95 9610,-1883.95 9610,-1800.95 9784,-1800.95 9784,-1883.95"/>
<text text-anchor="middle" x="9697" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU3</text>
<text text-anchor="middle" x="9697" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9697" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9697" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9697" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gate_gpu3&#45;&gt;layer2_expert3_2 -->
<g id="edge773" class="edge">
<title>layer2_gate_gpu3&#45;&gt;layer2_expert3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10726.92,-1956.61C10492.28,-1948.41 9985.38,-1926.58 9794.19,-1883.95"/>
<polygon fill="black" stroke="black" points="9794.77,-1880.49 9784.23,-1881.64 9793.19,-1887.31 9794.77,-1880.49"/>
</g>
<!-- layer2_expert3_3 -->
<g id="node468" class="node">
<title>layer2_expert3_3</title>
<polygon fill="lightgreen" stroke="black" points="9976,-1883.95 9802,-1883.95 9802,-1800.95 9976,-1800.95 9976,-1883.95"/>
<text text-anchor="middle" x="9889" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU3</text>
<text text-anchor="middle" x="9889" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9889" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9889" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9889" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gate_gpu3&#45;&gt;layer2_expert3_3 -->
<g id="edge774" class="edge">
<title>layer2_gate_gpu3&#45;&gt;layer2_expert3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10726.77,-1954.32C10527.25,-1943.53 10139.31,-1919.15 9986,-1883.92"/>
<polygon fill="black" stroke="black" points="9986.79,-1880.5 9976.25,-1881.58 9985.16,-1887.31 9986.79,-1880.5"/>
</g>
<!-- layer2_expert3_4 -->
<g id="node469" class="node">
<title>layer2_expert3_4</title>
<polygon fill="lightgreen" stroke="black" points="10168,-1883.95 9994,-1883.95 9994,-1800.95 10168,-1800.95 10168,-1883.95"/>
<text text-anchor="middle" x="10081" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU3</text>
<text text-anchor="middle" x="10081" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10081" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10081" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10081" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gate_gpu3&#45;&gt;layer2_expert3_4 -->
<g id="edge775" class="edge">
<title>layer2_gate_gpu3&#45;&gt;layer2_expert3_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10726.91,-1957C10593.03,-1950.86 10372.46,-1933.79 10177.84,-1883.96"/>
<polygon fill="black" stroke="black" points="10178.57,-1880.53 10168.01,-1881.4 10176.81,-1887.3 10178.57,-1880.53"/>
</g>
<!-- layer2_expert3_5 -->
<g id="node470" class="node">
<title>layer2_expert3_5</title>
<polygon fill="lightgreen" stroke="black" points="10360,-1883.95 10186,-1883.95 10186,-1800.95 10360,-1800.95 10360,-1883.95"/>
<text text-anchor="middle" x="10273" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU3</text>
<text text-anchor="middle" x="10273" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10273" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10273" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10273" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gate_gpu3&#45;&gt;layer2_expert3_5 -->
<g id="edge776" class="edge">
<title>layer2_gate_gpu3&#45;&gt;layer2_expert3_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10726.91,-1949.21C10631.32,-1938.51 10495.37,-1919.09 10369.84,-1884"/>
<polygon fill="black" stroke="black" points="10370.63,-1880.59 10360.06,-1881.23 10368.72,-1887.32 10370.63,-1880.59"/>
</g>
<!-- layer2_expert3_6 -->
<g id="node471" class="node">
<title>layer2_expert3_6</title>
<polygon fill="lightgreen" stroke="black" points="10552,-1883.95 10378,-1883.95 10378,-1800.95 10552,-1800.95 10552,-1883.95"/>
<text text-anchor="middle" x="10465" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU3</text>
<text text-anchor="middle" x="10465" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10465" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10465" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10465" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gate_gpu3&#45;&gt;layer2_expert3_6 -->
<g id="edge777" class="edge">
<title>layer2_gate_gpu3&#45;&gt;layer2_expert3_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10726.66,-1931.97C10677.66,-1919.59 10620.72,-1903.96 10561.67,-1884.07"/>
<polygon fill="black" stroke="black" points="10562.77,-1880.75 10552.18,-1880.84 10560.52,-1887.37 10562.77,-1880.75"/>
</g>
<!-- layer2_expert3_7 -->
<g id="node472" class="node">
<title>layer2_expert3_7</title>
<polygon fill="lightgreen" stroke="black" points="10744,-1883.95 10570,-1883.95 10570,-1800.95 10744,-1800.95 10744,-1883.95"/>
<text text-anchor="middle" x="10657" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU3</text>
<text text-anchor="middle" x="10657" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10657" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10657" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10657" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gate_gpu3&#45;&gt;layer2_expert3_7 -->
<g id="edge778" class="edge">
<title>layer2_gate_gpu3&#45;&gt;layer2_expert3_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10782.39,-1919.86C10766.15,-1909.97 10748.68,-1899.32 10732.08,-1889.21"/>
<polygon fill="black" stroke="black" points="10733.86,-1886.19 10723.5,-1883.97 10730.21,-1892.17 10733.86,-1886.19"/>
</g>
<!-- layer2_expert3_8 -->
<g id="node473" class="node">
<title>layer2_expert3_8</title>
<polygon fill="lightgreen" stroke="black" points="10936,-1883.95 10762,-1883.95 10762,-1800.95 10936,-1800.95 10936,-1883.95"/>
<text text-anchor="middle" x="10849" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU3</text>
<text text-anchor="middle" x="10849" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10849" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10849" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10849" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gate_gpu3&#45;&gt;layer2_expert3_8 -->
<g id="edge779" class="edge">
<title>layer2_gate_gpu3&#45;&gt;layer2_expert3_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10849,-1919.86C10849,-1911.6 10849,-1902.82 10849,-1894.26"/>
<polygon fill="black" stroke="black" points="10852.5,-1893.97 10849,-1883.97 10845.5,-1893.97 10852.5,-1893.97"/>
</g>
<!-- layer2_expert3_9 -->
<g id="node474" class="node">
<title>layer2_expert3_9</title>
<polygon fill="lightgreen" stroke="black" points="11128,-1883.95 10954,-1883.95 10954,-1800.95 11128,-1800.95 11128,-1883.95"/>
<text text-anchor="middle" x="11041" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU3</text>
<text text-anchor="middle" x="11041" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11041" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11041" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11041" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gate_gpu3&#45;&gt;layer2_expert3_9 -->
<g id="edge780" class="edge">
<title>layer2_gate_gpu3&#45;&gt;layer2_expert3_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10915.61,-1919.86C10931.85,-1909.97 10949.32,-1899.32 10965.92,-1889.21"/>
<polygon fill="black" stroke="black" points="10967.79,-1892.17 10974.5,-1883.97 10964.14,-1886.19 10967.79,-1892.17"/>
</g>
<!-- layer2_expert3_10 -->
<g id="node475" class="node">
<title>layer2_expert3_10</title>
<polygon fill="lightgreen" stroke="black" points="11320,-1883.95 11146,-1883.95 11146,-1800.95 11320,-1800.95 11320,-1883.95"/>
<text text-anchor="middle" x="11233" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU3</text>
<text text-anchor="middle" x="11233" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11233" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11233" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11233" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gate_gpu3&#45;&gt;layer2_expert3_10 -->
<g id="edge781" class="edge">
<title>layer2_gate_gpu3&#45;&gt;layer2_expert3_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10971.34,-1931.97C11020.34,-1919.59 11077.28,-1903.96 11136.33,-1884.07"/>
<polygon fill="black" stroke="black" points="11137.48,-1887.37 11145.82,-1880.84 11135.23,-1880.75 11137.48,-1887.37"/>
</g>
<!-- layer2_expert3_11 -->
<g id="node476" class="node">
<title>layer2_expert3_11</title>
<polygon fill="lightgreen" stroke="black" points="11512,-1883.95 11338,-1883.95 11338,-1800.95 11512,-1800.95 11512,-1883.95"/>
<text text-anchor="middle" x="11425" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU3</text>
<text text-anchor="middle" x="11425" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11425" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11425" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11425" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gate_gpu3&#45;&gt;layer2_expert3_11 -->
<g id="edge782" class="edge">
<title>layer2_gate_gpu3&#45;&gt;layer2_expert3_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10971.09,-1949.21C11066.68,-1938.51 11202.63,-1919.09 11328.16,-1884"/>
<polygon fill="black" stroke="black" points="11329.28,-1887.32 11337.94,-1881.23 11327.37,-1880.59 11329.28,-1887.32"/>
</g>
<!-- layer2_expert3_12 -->
<g id="node477" class="node">
<title>layer2_expert3_12</title>
<polygon fill="lightgreen" stroke="black" points="11704,-1883.95 11530,-1883.95 11530,-1800.95 11704,-1800.95 11704,-1883.95"/>
<text text-anchor="middle" x="11617" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU3</text>
<text text-anchor="middle" x="11617" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11617" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11617" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11617" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gate_gpu3&#45;&gt;layer2_expert3_12 -->
<g id="edge783" class="edge">
<title>layer2_gate_gpu3&#45;&gt;layer2_expert3_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10971.09,-1957C11104.97,-1950.86 11325.54,-1933.79 11520.16,-1883.96"/>
<polygon fill="black" stroke="black" points="11521.19,-1887.3 11529.99,-1881.4 11519.43,-1880.53 11521.19,-1887.3"/>
</g>
<!-- layer2_expert3_13 -->
<g id="node478" class="node">
<title>layer2_expert3_13</title>
<polygon fill="lightgreen" stroke="black" points="11896,-1883.95 11722,-1883.95 11722,-1800.95 11896,-1800.95 11896,-1883.95"/>
<text text-anchor="middle" x="11809" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU3</text>
<text text-anchor="middle" x="11809" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11809" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11809" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11809" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gate_gpu3&#45;&gt;layer2_expert3_13 -->
<g id="edge784" class="edge">
<title>layer2_gate_gpu3&#45;&gt;layer2_expert3_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10971.23,-1954.32C11170.75,-1943.53 11558.69,-1919.15 11712,-1883.92"/>
<polygon fill="black" stroke="black" points="11712.84,-1887.31 11721.75,-1881.58 11711.21,-1880.5 11712.84,-1887.31"/>
</g>
<!-- layer2_expert3_14 -->
<g id="node479" class="node">
<title>layer2_expert3_14</title>
<polygon fill="lightgreen" stroke="black" points="12088,-1883.95 11914,-1883.95 11914,-1800.95 12088,-1800.95 12088,-1883.95"/>
<text text-anchor="middle" x="12001" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU3</text>
<text text-anchor="middle" x="12001" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12001" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12001" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12001" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gate_gpu3&#45;&gt;layer2_expert3_14 -->
<g id="edge785" class="edge">
<title>layer2_gate_gpu3&#45;&gt;layer2_expert3_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10971.08,-1956.61C11205.72,-1948.41 11712.62,-1926.58 11903.81,-1883.95"/>
<polygon fill="black" stroke="black" points="11904.81,-1887.31 11913.77,-1881.64 11903.23,-1880.49 11904.81,-1887.31"/>
</g>
<!-- layer2_expert3_15 -->
<g id="node480" class="node">
<title>layer2_expert3_15</title>
<polygon fill="lightgreen" stroke="black" points="12280,-1883.95 12106,-1883.95 12106,-1800.95 12280,-1800.95 12280,-1883.95"/>
<text text-anchor="middle" x="12193" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU3</text>
<text text-anchor="middle" x="12193" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12193" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12193" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12193" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gate_gpu3&#45;&gt;layer2_expert3_15 -->
<g id="edge786" class="edge">
<title>layer2_gate_gpu3&#45;&gt;layer2_expert3_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10971.18,-1958.19C11238.05,-1952.43 11866.75,-1934.07 12095.83,-1883.94"/>
<polygon fill="black" stroke="black" points="12096.8,-1887.31 12105.78,-1881.68 12095.25,-1880.48 12096.8,-1887.31"/>
</g>
<!-- layer2_moe_agg_gpu3 -->
<g id="node481" class="node">
<title>layer2_moe_agg_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="10950.5,-1764.95 10747.5,-1764.95 10747.5,-1696.95 10950.5,-1696.95 10950.5,-1764.95"/>
<text text-anchor="middle" x="10849" y="-1749.75" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU3</text>
<text text-anchor="middle" x="10849" y="-1734.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="10849" y="-1719.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="10849" y="-1704.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_expert3_0&#45;&gt;layer2_moe_agg_gpu3 -->
<g id="edge787" class="edge">
<title>layer2_expert3_0&#45;&gt;layer2_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9400.21,-1803.17C9403.16,-1802.36 9406.09,-1801.62 9409,-1800.95 9661.13,-1743.63 10444.27,-1733.89 10737.05,-1732.27"/>
<polygon fill="black" stroke="black" points="10737.27,-1735.77 10747.25,-1732.21 10737.24,-1728.77 10737.27,-1735.77"/>
</g>
<!-- layer2_expert3_1&#45;&gt;layer2_moe_agg_gpu3 -->
<g id="edge788" class="edge">
<title>layer2_expert3_1&#45;&gt;layer2_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9592.22,-1803.2C9595.16,-1802.38 9598.09,-1801.63 9601,-1800.95 9815.24,-1751.42 10472.44,-1737.07 10736.97,-1733.24"/>
<polygon fill="black" stroke="black" points="10737.41,-1736.73 10747.36,-1733.09 10737.31,-1729.73 10737.41,-1736.73"/>
</g>
<!-- layer2_expert3_2&#45;&gt;layer2_moe_agg_gpu3 -->
<g id="edge789" class="edge">
<title>layer2_expert3_2&#45;&gt;layer2_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9784.23,-1803.24C9787.17,-1802.41 9790.1,-1801.64 9793,-1800.95 9969.72,-1759.16 10503.22,-1740.77 10737.09,-1734.56"/>
<polygon fill="black" stroke="black" points="10737.42,-1738.05 10747.32,-1734.29 10737.23,-1731.05 10737.42,-1738.05"/>
</g>
<!-- layer2_expert3_3&#45;&gt;layer2_moe_agg_gpu3 -->
<g id="edge790" class="edge">
<title>layer2_expert3_3&#45;&gt;layer2_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9976.24,-1803.3C9979.18,-1802.45 9982.1,-1801.66 9985,-1800.95 10124.55,-1766.88 10536.54,-1745.25 10736.96,-1736.46"/>
<polygon fill="black" stroke="black" points="10737.39,-1739.94 10747.22,-1736.01 10737.08,-1732.95 10737.39,-1739.94"/>
</g>
<!-- layer2_expert3_4&#45;&gt;layer2_moe_agg_gpu3 -->
<g id="edge791" class="edge">
<title>layer2_expert3_4&#45;&gt;layer2_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10168.26,-1803.38C10171.19,-1802.51 10174.11,-1801.69 10177,-1800.95 10369.8,-1751.56 10602.29,-1737.33 10737.12,-1733.35"/>
<polygon fill="black" stroke="black" points="10737.56,-1736.84 10747.46,-1733.06 10737.37,-1729.84 10737.56,-1736.84"/>
</g>
<!-- layer2_expert3_5&#45;&gt;layer2_moe_agg_gpu3 -->
<g id="edge792" class="edge">
<title>layer2_expert3_5&#45;&gt;layer2_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10360.04,-1803.62C10363.04,-1802.67 10366.04,-1801.78 10369,-1800.95 10492.52,-1766.64 10638.92,-1748.73 10737.28,-1739.86"/>
<polygon fill="black" stroke="black" points="10737.59,-1743.34 10747.24,-1738.97 10736.97,-1736.37 10737.59,-1743.34"/>
</g>
<!-- layer2_expert3_6&#45;&gt;layer2_moe_agg_gpu3 -->
<g id="edge793" class="edge">
<title>layer2_expert3_6&#45;&gt;layer2_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10552.15,-1803.97C10555.12,-1802.92 10558.08,-1801.91 10561,-1800.95 10618.25,-1782.16 10683.45,-1766.11 10737.32,-1754.23"/>
<polygon fill="black" stroke="black" points="10738.22,-1757.62 10747.24,-1752.06 10736.72,-1750.78 10738.22,-1757.62"/>
</g>
<!-- layer2_expert3_7&#45;&gt;layer2_moe_agg_gpu3 -->
<g id="edge794" class="edge">
<title>layer2_expert3_7&#45;&gt;layer2_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10728.22,-1800.84C10745.85,-1790.78 10764.68,-1780.04 10782.1,-1770.11"/>
<polygon fill="black" stroke="black" points="10784.11,-1772.99 10791.06,-1765 10780.64,-1766.91 10784.11,-1772.99"/>
</g>
<!-- layer2_expert3_8&#45;&gt;layer2_moe_agg_gpu3 -->
<g id="edge795" class="edge">
<title>layer2_expert3_8&#45;&gt;layer2_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10849,-1800.68C10849,-1792.47 10849,-1783.81 10849,-1775.51"/>
<polygon fill="black" stroke="black" points="10852.5,-1775.25 10849,-1765.25 10845.5,-1775.25 10852.5,-1775.25"/>
</g>
<!-- layer2_expert3_9&#45;&gt;layer2_moe_agg_gpu3 -->
<g id="edge796" class="edge">
<title>layer2_expert3_9&#45;&gt;layer2_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10969.78,-1800.84C10952.15,-1790.78 10933.32,-1780.04 10915.9,-1770.11"/>
<polygon fill="black" stroke="black" points="10917.36,-1766.91 10906.94,-1765 10913.89,-1772.99 10917.36,-1766.91"/>
</g>
<!-- layer2_expert3_10&#45;&gt;layer2_moe_agg_gpu3 -->
<g id="edge797" class="edge">
<title>layer2_expert3_10&#45;&gt;layer2_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11145.85,-1803.97C11142.88,-1802.92 11139.92,-1801.91 11137,-1800.95 11079.75,-1782.16 11014.55,-1766.11 10960.68,-1754.23"/>
<polygon fill="black" stroke="black" points="10961.28,-1750.78 10950.76,-1752.06 10959.78,-1757.62 10961.28,-1750.78"/>
</g>
<!-- layer2_expert3_11&#45;&gt;layer2_moe_agg_gpu3 -->
<g id="edge798" class="edge">
<title>layer2_expert3_11&#45;&gt;layer2_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11337.96,-1803.62C11334.96,-1802.67 11331.96,-1801.78 11329,-1800.95 11205.48,-1766.64 11059.08,-1748.73 10960.72,-1739.86"/>
<polygon fill="black" stroke="black" points="10961.03,-1736.37 10950.76,-1738.97 10960.41,-1743.34 10961.03,-1736.37"/>
</g>
<!-- layer2_expert3_12&#45;&gt;layer2_moe_agg_gpu3 -->
<g id="edge799" class="edge">
<title>layer2_expert3_12&#45;&gt;layer2_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11529.74,-1803.38C11526.81,-1802.51 11523.89,-1801.69 11521,-1800.95 11328.2,-1751.56 11095.71,-1737.33 10960.88,-1733.35"/>
<polygon fill="black" stroke="black" points="10960.63,-1729.84 10950.54,-1733.06 10960.44,-1736.84 10960.63,-1729.84"/>
</g>
<!-- layer2_expert3_13&#45;&gt;layer2_moe_agg_gpu3 -->
<g id="edge800" class="edge">
<title>layer2_expert3_13&#45;&gt;layer2_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11721.76,-1803.3C11718.82,-1802.45 11715.9,-1801.66 11713,-1800.95 11573.45,-1766.88 11161.46,-1745.25 10961.04,-1736.46"/>
<polygon fill="black" stroke="black" points="10960.92,-1732.95 10950.78,-1736.01 10960.61,-1739.94 10960.92,-1732.95"/>
</g>
<!-- layer2_expert3_14&#45;&gt;layer2_moe_agg_gpu3 -->
<g id="edge801" class="edge">
<title>layer2_expert3_14&#45;&gt;layer2_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11913.77,-1803.24C11910.83,-1802.41 11907.9,-1801.64 11905,-1800.95 11728.28,-1759.16 11194.78,-1740.77 10960.91,-1734.56"/>
<polygon fill="black" stroke="black" points="10960.77,-1731.05 10950.68,-1734.29 10960.58,-1738.05 10960.77,-1731.05"/>
</g>
<!-- layer2_expert3_15&#45;&gt;layer2_moe_agg_gpu3 -->
<g id="edge802" class="edge">
<title>layer2_expert3_15&#45;&gt;layer2_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M12105.78,-1803.2C12102.84,-1802.38 12099.91,-1801.63 12097,-1800.95 11882.76,-1751.42 11225.56,-1737.07 10961.03,-1733.24"/>
<polygon fill="black" stroke="black" points="10960.69,-1729.73 10950.64,-1733.09 10960.59,-1736.73 10960.69,-1729.73"/>
</g>
<!-- layer2_moe_agg_gpu3&#45;&gt;layer2_moe_allreduce -->
<g id="edge803" class="edge">
<title>layer2_moe_agg_gpu3&#45;&gt;layer2_moe_allreduce</title>
<path fill="none" stroke="black" d="M10950.54,-1720.36C11190.43,-1697.71 11795.11,-1640.6 12102.86,-1611.53"/>
<polygon fill="black" stroke="black" points="12103.6,-1614.98 12113.23,-1610.55 12102.95,-1608.01 12103.6,-1614.98"/>
</g>
<!-- layer2_output_gpu3 -->
<g id="node482" class="node">
<title>layer2_output_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="12280,-1488.95 12036,-1488.95 12036,-1420.95 12280,-1420.95 12280,-1488.95"/>
<text text-anchor="middle" x="12158" y="-1473.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU3</text>
<text text-anchor="middle" x="12158" y="-1458.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="12158" y="-1443.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12158" y="-1428.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_qkv_gpu3 -->
<g id="node569" class="node">
<title>layer3_qkv_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="12258,-1384.95 12058,-1384.95 12058,-1286.95 12258,-1286.95 12258,-1384.95"/>
<text text-anchor="middle" x="12158" y="-1369.75" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU3</text>
<text text-anchor="middle" x="12158" y="-1354.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12158" y="-1339.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12158" y="-1324.75" font-family="Times,serif" font-size="14.00">Heads: 12&#45;15</text>
<text text-anchor="middle" x="12158" y="-1309.75" font-family="Times,serif" font-size="14.00">TP Slice: 3</text>
<text text-anchor="middle" x="12158" y="-1294.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_output_gpu3&#45;&gt;layer3_qkv_gpu3 -->
<g id="edge964" class="edge">
<title>layer2_output_gpu3&#45;&gt;layer3_qkv_gpu3</title>
<path fill="none" stroke="black" d="M12158,-1420.74C12158,-1412.78 12158,-1404.04 12158,-1395.3"/>
<polygon fill="black" stroke="black" points="12161.5,-1395.1 12158,-1385.1 12154.5,-1395.1 12161.5,-1395.1"/>
</g>
<!-- layer2_expert4_0 -->
<g id="node484" class="node">
<title>layer2_expert4_0</title>
<polygon fill="lightgreen" stroke="black" points="12472,-1883.95 12298,-1883.95 12298,-1800.95 12472,-1800.95 12472,-1883.95"/>
<text text-anchor="middle" x="12385" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU4</text>
<text text-anchor="middle" x="12385" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12385" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12385" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12385" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_gate_gpu4&#45;&gt;layer2_expert4_0 -->
<g id="edge810" class="edge">
<title>layer2_gate_gpu4&#45;&gt;layer2_expert4_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13606.82,-1958.19C13339.95,-1952.43 12711.25,-1934.07 12482.17,-1883.94"/>
<polygon fill="black" stroke="black" points="12482.75,-1880.48 12472.22,-1881.68 12481.2,-1887.31 12482.75,-1880.48"/>
</g>
<!-- layer2_expert4_1 -->
<g id="node485" class="node">
<title>layer2_expert4_1</title>
<polygon fill="lightgreen" stroke="black" points="12664,-1883.95 12490,-1883.95 12490,-1800.95 12664,-1800.95 12664,-1883.95"/>
<text text-anchor="middle" x="12577" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU4</text>
<text text-anchor="middle" x="12577" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12577" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12577" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12577" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_gate_gpu4&#45;&gt;layer2_expert4_1 -->
<g id="edge811" class="edge">
<title>layer2_gate_gpu4&#45;&gt;layer2_expert4_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13606.92,-1956.61C13372.28,-1948.41 12865.38,-1926.58 12674.19,-1883.95"/>
<polygon fill="black" stroke="black" points="12674.77,-1880.49 12664.23,-1881.64 12673.19,-1887.31 12674.77,-1880.49"/>
</g>
<!-- layer2_expert4_2 -->
<g id="node486" class="node">
<title>layer2_expert4_2</title>
<polygon fill="lightgreen" stroke="black" points="12856,-1883.95 12682,-1883.95 12682,-1800.95 12856,-1800.95 12856,-1883.95"/>
<text text-anchor="middle" x="12769" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU4</text>
<text text-anchor="middle" x="12769" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12769" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12769" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12769" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_gate_gpu4&#45;&gt;layer2_expert4_2 -->
<g id="edge812" class="edge">
<title>layer2_gate_gpu4&#45;&gt;layer2_expert4_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13606.77,-1954.32C13407.25,-1943.53 13019.31,-1919.15 12866,-1883.92"/>
<polygon fill="black" stroke="black" points="12866.79,-1880.5 12856.25,-1881.58 12865.16,-1887.31 12866.79,-1880.5"/>
</g>
<!-- layer2_expert4_3 -->
<g id="node487" class="node">
<title>layer2_expert4_3</title>
<polygon fill="lightgreen" stroke="black" points="13048,-1883.95 12874,-1883.95 12874,-1800.95 13048,-1800.95 13048,-1883.95"/>
<text text-anchor="middle" x="12961" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU4</text>
<text text-anchor="middle" x="12961" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12961" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12961" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12961" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_gate_gpu4&#45;&gt;layer2_expert4_3 -->
<g id="edge813" class="edge">
<title>layer2_gate_gpu4&#45;&gt;layer2_expert4_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13606.91,-1957C13473.03,-1950.86 13252.46,-1933.79 13057.84,-1883.96"/>
<polygon fill="black" stroke="black" points="13058.57,-1880.53 13048.01,-1881.4 13056.81,-1887.3 13058.57,-1880.53"/>
</g>
<!-- layer2_expert4_4 -->
<g id="node488" class="node">
<title>layer2_expert4_4</title>
<polygon fill="lightgreen" stroke="black" points="13240,-1883.95 13066,-1883.95 13066,-1800.95 13240,-1800.95 13240,-1883.95"/>
<text text-anchor="middle" x="13153" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU4</text>
<text text-anchor="middle" x="13153" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13153" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13153" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13153" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_gate_gpu4&#45;&gt;layer2_expert4_4 -->
<g id="edge814" class="edge">
<title>layer2_gate_gpu4&#45;&gt;layer2_expert4_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13606.91,-1949.21C13511.32,-1938.51 13375.37,-1919.09 13249.84,-1884"/>
<polygon fill="black" stroke="black" points="13250.63,-1880.59 13240.06,-1881.23 13248.72,-1887.32 13250.63,-1880.59"/>
</g>
<!-- layer2_expert4_5 -->
<g id="node489" class="node">
<title>layer2_expert4_5</title>
<polygon fill="lightgreen" stroke="black" points="13432,-1883.95 13258,-1883.95 13258,-1800.95 13432,-1800.95 13432,-1883.95"/>
<text text-anchor="middle" x="13345" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU4</text>
<text text-anchor="middle" x="13345" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13345" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13345" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13345" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_gate_gpu4&#45;&gt;layer2_expert4_5 -->
<g id="edge815" class="edge">
<title>layer2_gate_gpu4&#45;&gt;layer2_expert4_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13606.66,-1931.97C13557.66,-1919.59 13500.72,-1903.96 13441.67,-1884.07"/>
<polygon fill="black" stroke="black" points="13442.77,-1880.75 13432.18,-1880.84 13440.52,-1887.37 13442.77,-1880.75"/>
</g>
<!-- layer2_expert4_6 -->
<g id="node490" class="node">
<title>layer2_expert4_6</title>
<polygon fill="lightgreen" stroke="black" points="13624,-1883.95 13450,-1883.95 13450,-1800.95 13624,-1800.95 13624,-1883.95"/>
<text text-anchor="middle" x="13537" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU4</text>
<text text-anchor="middle" x="13537" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13537" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13537" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13537" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_gate_gpu4&#45;&gt;layer2_expert4_6 -->
<g id="edge816" class="edge">
<title>layer2_gate_gpu4&#45;&gt;layer2_expert4_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13662.39,-1919.86C13646.15,-1909.97 13628.68,-1899.32 13612.08,-1889.21"/>
<polygon fill="black" stroke="black" points="13613.86,-1886.19 13603.5,-1883.97 13610.21,-1892.17 13613.86,-1886.19"/>
</g>
<!-- layer2_expert4_7 -->
<g id="node491" class="node">
<title>layer2_expert4_7</title>
<polygon fill="lightgreen" stroke="black" points="13816,-1883.95 13642,-1883.95 13642,-1800.95 13816,-1800.95 13816,-1883.95"/>
<text text-anchor="middle" x="13729" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU4</text>
<text text-anchor="middle" x="13729" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13729" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13729" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13729" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_gate_gpu4&#45;&gt;layer2_expert4_7 -->
<g id="edge817" class="edge">
<title>layer2_gate_gpu4&#45;&gt;layer2_expert4_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13729,-1919.86C13729,-1911.6 13729,-1902.82 13729,-1894.26"/>
<polygon fill="black" stroke="black" points="13732.5,-1893.97 13729,-1883.97 13725.5,-1893.97 13732.5,-1893.97"/>
</g>
<!-- layer2_expert4_8 -->
<g id="node492" class="node">
<title>layer2_expert4_8</title>
<polygon fill="lightgreen" stroke="black" points="14008,-1883.95 13834,-1883.95 13834,-1800.95 14008,-1800.95 14008,-1883.95"/>
<text text-anchor="middle" x="13921" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU4</text>
<text text-anchor="middle" x="13921" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13921" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13921" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13921" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_gate_gpu4&#45;&gt;layer2_expert4_8 -->
<g id="edge818" class="edge">
<title>layer2_gate_gpu4&#45;&gt;layer2_expert4_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13795.61,-1919.86C13811.85,-1909.97 13829.32,-1899.32 13845.92,-1889.21"/>
<polygon fill="black" stroke="black" points="13847.79,-1892.17 13854.5,-1883.97 13844.14,-1886.19 13847.79,-1892.17"/>
</g>
<!-- layer2_expert4_9 -->
<g id="node493" class="node">
<title>layer2_expert4_9</title>
<polygon fill="lightgreen" stroke="black" points="14200,-1883.95 14026,-1883.95 14026,-1800.95 14200,-1800.95 14200,-1883.95"/>
<text text-anchor="middle" x="14113" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU4</text>
<text text-anchor="middle" x="14113" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14113" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14113" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14113" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_gate_gpu4&#45;&gt;layer2_expert4_9 -->
<g id="edge819" class="edge">
<title>layer2_gate_gpu4&#45;&gt;layer2_expert4_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13851.34,-1931.97C13900.34,-1919.59 13957.28,-1903.96 14016.33,-1884.07"/>
<polygon fill="black" stroke="black" points="14017.48,-1887.37 14025.82,-1880.84 14015.23,-1880.75 14017.48,-1887.37"/>
</g>
<!-- layer2_expert4_10 -->
<g id="node494" class="node">
<title>layer2_expert4_10</title>
<polygon fill="lightgreen" stroke="black" points="14392,-1883.95 14218,-1883.95 14218,-1800.95 14392,-1800.95 14392,-1883.95"/>
<text text-anchor="middle" x="14305" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU4</text>
<text text-anchor="middle" x="14305" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14305" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14305" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14305" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_gate_gpu4&#45;&gt;layer2_expert4_10 -->
<g id="edge820" class="edge">
<title>layer2_gate_gpu4&#45;&gt;layer2_expert4_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13851.09,-1949.21C13946.68,-1938.51 14082.63,-1919.09 14208.16,-1884"/>
<polygon fill="black" stroke="black" points="14209.28,-1887.32 14217.94,-1881.23 14207.37,-1880.59 14209.28,-1887.32"/>
</g>
<!-- layer2_expert4_11 -->
<g id="node495" class="node">
<title>layer2_expert4_11</title>
<polygon fill="lightgreen" stroke="black" points="14584,-1883.95 14410,-1883.95 14410,-1800.95 14584,-1800.95 14584,-1883.95"/>
<text text-anchor="middle" x="14497" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU4</text>
<text text-anchor="middle" x="14497" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14497" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14497" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14497" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_gate_gpu4&#45;&gt;layer2_expert4_11 -->
<g id="edge821" class="edge">
<title>layer2_gate_gpu4&#45;&gt;layer2_expert4_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13851.09,-1957C13984.97,-1950.86 14205.54,-1933.79 14400.16,-1883.96"/>
<polygon fill="black" stroke="black" points="14401.19,-1887.3 14409.99,-1881.4 14399.43,-1880.53 14401.19,-1887.3"/>
</g>
<!-- layer2_expert4_12 -->
<g id="node496" class="node">
<title>layer2_expert4_12</title>
<polygon fill="lightgreen" stroke="black" points="14776,-1883.95 14602,-1883.95 14602,-1800.95 14776,-1800.95 14776,-1883.95"/>
<text text-anchor="middle" x="14689" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU4</text>
<text text-anchor="middle" x="14689" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14689" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14689" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14689" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_gate_gpu4&#45;&gt;layer2_expert4_12 -->
<g id="edge822" class="edge">
<title>layer2_gate_gpu4&#45;&gt;layer2_expert4_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13851.23,-1954.32C14050.75,-1943.53 14438.69,-1919.15 14592,-1883.92"/>
<polygon fill="black" stroke="black" points="14592.84,-1887.31 14601.75,-1881.58 14591.21,-1880.5 14592.84,-1887.31"/>
</g>
<!-- layer2_expert4_13 -->
<g id="node497" class="node">
<title>layer2_expert4_13</title>
<polygon fill="lightgreen" stroke="black" points="14968,-1883.95 14794,-1883.95 14794,-1800.95 14968,-1800.95 14968,-1883.95"/>
<text text-anchor="middle" x="14881" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU4</text>
<text text-anchor="middle" x="14881" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14881" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14881" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14881" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_gate_gpu4&#45;&gt;layer2_expert4_13 -->
<g id="edge823" class="edge">
<title>layer2_gate_gpu4&#45;&gt;layer2_expert4_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13851.08,-1956.61C14085.72,-1948.41 14592.62,-1926.58 14783.81,-1883.95"/>
<polygon fill="black" stroke="black" points="14784.81,-1887.31 14793.77,-1881.64 14783.23,-1880.49 14784.81,-1887.31"/>
</g>
<!-- layer2_expert4_14 -->
<g id="node498" class="node">
<title>layer2_expert4_14</title>
<polygon fill="lightgreen" stroke="black" points="15160,-1883.95 14986,-1883.95 14986,-1800.95 15160,-1800.95 15160,-1883.95"/>
<text text-anchor="middle" x="15073" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU4</text>
<text text-anchor="middle" x="15073" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15073" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15073" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15073" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_gate_gpu4&#45;&gt;layer2_expert4_14 -->
<g id="edge824" class="edge">
<title>layer2_gate_gpu4&#45;&gt;layer2_expert4_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13851.18,-1958.19C14118.05,-1952.43 14746.75,-1934.07 14975.83,-1883.94"/>
<polygon fill="black" stroke="black" points="14976.8,-1887.31 14985.78,-1881.68 14975.25,-1880.48 14976.8,-1887.31"/>
</g>
<!-- layer2_expert4_15 -->
<g id="node499" class="node">
<title>layer2_expert4_15</title>
<polygon fill="lightgreen" stroke="black" points="15352,-1883.95 15178,-1883.95 15178,-1800.95 15352,-1800.95 15352,-1883.95"/>
<text text-anchor="middle" x="15265" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU4</text>
<text text-anchor="middle" x="15265" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15265" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15265" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15265" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_gate_gpu4&#45;&gt;layer2_expert4_15 -->
<g id="edge825" class="edge">
<title>layer2_gate_gpu4&#45;&gt;layer2_expert4_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13851.2,-1959.37C14147.79,-1955.87 14900.41,-1941.65 15167.71,-1883.96"/>
<polygon fill="black" stroke="black" points="15168.78,-1887.31 15177.78,-1881.71 15167.26,-1880.48 15168.78,-1887.31"/>
</g>
<!-- layer2_moe_agg_gpu4 -->
<g id="node500" class="node">
<title>layer2_moe_agg_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13830.5,-1764.95 13627.5,-1764.95 13627.5,-1696.95 13830.5,-1696.95 13830.5,-1764.95"/>
<text text-anchor="middle" x="13729" y="-1749.75" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU4</text>
<text text-anchor="middle" x="13729" y="-1734.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="13729" y="-1719.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="13729" y="-1704.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_expert4_0&#45;&gt;layer2_moe_agg_gpu4 -->
<g id="edge826" class="edge">
<title>layer2_expert4_0&#45;&gt;layer2_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M12472.22,-1803.2C12475.16,-1802.38 12478.09,-1801.63 12481,-1800.95 12695.24,-1751.42 13352.44,-1737.07 13616.97,-1733.24"/>
<polygon fill="black" stroke="black" points="13617.41,-1736.73 13627.36,-1733.09 13617.31,-1729.73 13617.41,-1736.73"/>
</g>
<!-- layer2_expert4_1&#45;&gt;layer2_moe_agg_gpu4 -->
<g id="edge827" class="edge">
<title>layer2_expert4_1&#45;&gt;layer2_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M12664.23,-1803.24C12667.17,-1802.41 12670.1,-1801.64 12673,-1800.95 12849.72,-1759.16 13383.22,-1740.77 13617.09,-1734.56"/>
<polygon fill="black" stroke="black" points="13617.42,-1738.05 13627.32,-1734.29 13617.23,-1731.05 13617.42,-1738.05"/>
</g>
<!-- layer2_expert4_2&#45;&gt;layer2_moe_agg_gpu4 -->
<g id="edge828" class="edge">
<title>layer2_expert4_2&#45;&gt;layer2_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M12856.24,-1803.3C12859.18,-1802.45 12862.1,-1801.66 12865,-1800.95 13004.55,-1766.88 13416.54,-1745.25 13616.96,-1736.46"/>
<polygon fill="black" stroke="black" points="13617.39,-1739.94 13627.22,-1736.01 13617.08,-1732.95 13617.39,-1739.94"/>
</g>
<!-- layer2_expert4_3&#45;&gt;layer2_moe_agg_gpu4 -->
<g id="edge829" class="edge">
<title>layer2_expert4_3&#45;&gt;layer2_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13048.26,-1803.38C13051.19,-1802.51 13054.11,-1801.69 13057,-1800.95 13249.8,-1751.56 13482.29,-1737.33 13617.12,-1733.35"/>
<polygon fill="black" stroke="black" points="13617.56,-1736.84 13627.46,-1733.06 13617.37,-1729.84 13617.56,-1736.84"/>
</g>
<!-- layer2_expert4_4&#45;&gt;layer2_moe_agg_gpu4 -->
<g id="edge830" class="edge">
<title>layer2_expert4_4&#45;&gt;layer2_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13240.04,-1803.62C13243.04,-1802.67 13246.04,-1801.78 13249,-1800.95 13372.52,-1766.64 13518.92,-1748.73 13617.28,-1739.86"/>
<polygon fill="black" stroke="black" points="13617.59,-1743.34 13627.24,-1738.97 13616.97,-1736.37 13617.59,-1743.34"/>
</g>
<!-- layer2_expert4_5&#45;&gt;layer2_moe_agg_gpu4 -->
<g id="edge831" class="edge">
<title>layer2_expert4_5&#45;&gt;layer2_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13432.15,-1803.97C13435.12,-1802.92 13438.08,-1801.91 13441,-1800.95 13498.25,-1782.16 13563.45,-1766.11 13617.32,-1754.23"/>
<polygon fill="black" stroke="black" points="13618.22,-1757.62 13627.24,-1752.06 13616.72,-1750.78 13618.22,-1757.62"/>
</g>
<!-- layer2_expert4_6&#45;&gt;layer2_moe_agg_gpu4 -->
<g id="edge832" class="edge">
<title>layer2_expert4_6&#45;&gt;layer2_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13608.22,-1800.84C13625.85,-1790.78 13644.68,-1780.04 13662.1,-1770.11"/>
<polygon fill="black" stroke="black" points="13664.11,-1772.99 13671.06,-1765 13660.64,-1766.91 13664.11,-1772.99"/>
</g>
<!-- layer2_expert4_7&#45;&gt;layer2_moe_agg_gpu4 -->
<g id="edge833" class="edge">
<title>layer2_expert4_7&#45;&gt;layer2_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13729,-1800.68C13729,-1792.47 13729,-1783.81 13729,-1775.51"/>
<polygon fill="black" stroke="black" points="13732.5,-1775.25 13729,-1765.25 13725.5,-1775.25 13732.5,-1775.25"/>
</g>
<!-- layer2_expert4_8&#45;&gt;layer2_moe_agg_gpu4 -->
<g id="edge834" class="edge">
<title>layer2_expert4_8&#45;&gt;layer2_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13849.78,-1800.84C13832.15,-1790.78 13813.32,-1780.04 13795.9,-1770.11"/>
<polygon fill="black" stroke="black" points="13797.36,-1766.91 13786.94,-1765 13793.89,-1772.99 13797.36,-1766.91"/>
</g>
<!-- layer2_expert4_9&#45;&gt;layer2_moe_agg_gpu4 -->
<g id="edge835" class="edge">
<title>layer2_expert4_9&#45;&gt;layer2_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14025.85,-1803.97C14022.88,-1802.92 14019.92,-1801.91 14017,-1800.95 13959.75,-1782.16 13894.55,-1766.11 13840.68,-1754.23"/>
<polygon fill="black" stroke="black" points="13841.28,-1750.78 13830.76,-1752.06 13839.78,-1757.62 13841.28,-1750.78"/>
</g>
<!-- layer2_expert4_10&#45;&gt;layer2_moe_agg_gpu4 -->
<g id="edge836" class="edge">
<title>layer2_expert4_10&#45;&gt;layer2_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14217.96,-1803.62C14214.96,-1802.67 14211.96,-1801.78 14209,-1800.95 14085.48,-1766.64 13939.08,-1748.73 13840.72,-1739.86"/>
<polygon fill="black" stroke="black" points="13841.03,-1736.37 13830.76,-1738.97 13840.41,-1743.34 13841.03,-1736.37"/>
</g>
<!-- layer2_expert4_11&#45;&gt;layer2_moe_agg_gpu4 -->
<g id="edge837" class="edge">
<title>layer2_expert4_11&#45;&gt;layer2_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14409.74,-1803.38C14406.81,-1802.51 14403.89,-1801.69 14401,-1800.95 14208.2,-1751.56 13975.71,-1737.33 13840.88,-1733.35"/>
<polygon fill="black" stroke="black" points="13840.63,-1729.84 13830.54,-1733.06 13840.44,-1736.84 13840.63,-1729.84"/>
</g>
<!-- layer2_expert4_12&#45;&gt;layer2_moe_agg_gpu4 -->
<g id="edge838" class="edge">
<title>layer2_expert4_12&#45;&gt;layer2_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14601.76,-1803.3C14598.82,-1802.45 14595.9,-1801.66 14593,-1800.95 14453.45,-1766.88 14041.46,-1745.25 13841.04,-1736.46"/>
<polygon fill="black" stroke="black" points="13840.92,-1732.95 13830.78,-1736.01 13840.61,-1739.94 13840.92,-1732.95"/>
</g>
<!-- layer2_expert4_13&#45;&gt;layer2_moe_agg_gpu4 -->
<g id="edge839" class="edge">
<title>layer2_expert4_13&#45;&gt;layer2_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14793.77,-1803.24C14790.83,-1802.41 14787.9,-1801.64 14785,-1800.95 14608.28,-1759.16 14074.78,-1740.77 13840.91,-1734.56"/>
<polygon fill="black" stroke="black" points="13840.77,-1731.05 13830.68,-1734.29 13840.58,-1738.05 13840.77,-1731.05"/>
</g>
<!-- layer2_expert4_14&#45;&gt;layer2_moe_agg_gpu4 -->
<g id="edge840" class="edge">
<title>layer2_expert4_14&#45;&gt;layer2_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14985.78,-1803.2C14982.84,-1802.38 14979.91,-1801.63 14977,-1800.95 14762.76,-1751.42 14105.56,-1737.07 13841.03,-1733.24"/>
<polygon fill="black" stroke="black" points="13840.69,-1729.73 13830.64,-1733.09 13840.59,-1736.73 13840.69,-1729.73"/>
</g>
<!-- layer2_expert4_15&#45;&gt;layer2_moe_agg_gpu4 -->
<g id="edge841" class="edge">
<title>layer2_expert4_15&#45;&gt;layer2_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M15177.79,-1803.17C15174.84,-1802.36 15171.91,-1801.62 15169,-1800.95 14916.87,-1743.63 14133.73,-1733.89 13840.95,-1732.27"/>
<polygon fill="black" stroke="black" points="13840.76,-1728.77 13830.75,-1732.21 13840.73,-1735.77 13840.76,-1728.77"/>
</g>
<!-- layer2_moe_agg_gpu4&#45;&gt;layer2_moe_allreduce -->
<g id="edge842" class="edge">
<title>layer2_moe_agg_gpu4&#45;&gt;layer2_moe_allreduce</title>
<path fill="none" stroke="black" d="M13627.46,-1720.36C13387.57,-1697.71 12782.89,-1640.6 12475.14,-1611.53"/>
<polygon fill="black" stroke="black" points="12475.05,-1608.01 12464.77,-1610.55 12474.4,-1614.98 12475.05,-1608.01"/>
</g>
<!-- layer2_output_gpu4 -->
<g id="node501" class="node">
<title>layer2_output_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="12542,-1488.95 12298,-1488.95 12298,-1420.95 12542,-1420.95 12542,-1488.95"/>
<text text-anchor="middle" x="12420" y="-1473.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU4</text>
<text text-anchor="middle" x="12420" y="-1458.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="12420" y="-1443.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12420" y="-1428.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_qkv_gpu4 -->
<g id="node572" class="node">
<title>layer3_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="12519,-1384.95 12319,-1384.95 12319,-1286.95 12519,-1286.95 12519,-1384.95"/>
<text text-anchor="middle" x="12419" y="-1369.75" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU4</text>
<text text-anchor="middle" x="12419" y="-1354.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12419" y="-1339.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12419" y="-1324.75" font-family="Times,serif" font-size="14.00">Heads: 16&#45;19</text>
<text text-anchor="middle" x="12419" y="-1309.75" font-family="Times,serif" font-size="14.00">TP Slice: 4</text>
<text text-anchor="middle" x="12419" y="-1294.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_output_gpu4&#45;&gt;layer3_qkv_gpu4 -->
<g id="edge965" class="edge">
<title>layer2_output_gpu4&#45;&gt;layer3_qkv_gpu4</title>
<path fill="none" stroke="black" d="M12419.72,-1420.74C12419.65,-1412.78 12419.57,-1404.04 12419.5,-1395.3"/>
<polygon fill="black" stroke="black" points="12423,-1395.07 12419.41,-1385.1 12416,-1395.13 12423,-1395.07"/>
</g>
<!-- layer2_expert5_0 -->
<g id="node503" class="node">
<title>layer2_expert5_0</title>
<polygon fill="lightgreen" stroke="black" points="15544,-1883.95 15370,-1883.95 15370,-1800.95 15544,-1800.95 15544,-1883.95"/>
<text text-anchor="middle" x="15457" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU5</text>
<text text-anchor="middle" x="15457" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15457" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15457" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15457" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_gate_gpu5&#45;&gt;layer2_expert5_0 -->
<g id="edge849" class="edge">
<title>layer2_gate_gpu5&#45;&gt;layer2_expert5_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16678.82,-1958.19C16411.95,-1952.43 15783.25,-1934.07 15554.17,-1883.94"/>
<polygon fill="black" stroke="black" points="15554.75,-1880.48 15544.22,-1881.68 15553.2,-1887.31 15554.75,-1880.48"/>
</g>
<!-- layer2_expert5_1 -->
<g id="node504" class="node">
<title>layer2_expert5_1</title>
<polygon fill="lightgreen" stroke="black" points="15736,-1883.95 15562,-1883.95 15562,-1800.95 15736,-1800.95 15736,-1883.95"/>
<text text-anchor="middle" x="15649" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU5</text>
<text text-anchor="middle" x="15649" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15649" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15649" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15649" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_gate_gpu5&#45;&gt;layer2_expert5_1 -->
<g id="edge850" class="edge">
<title>layer2_gate_gpu5&#45;&gt;layer2_expert5_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16678.92,-1956.61C16444.28,-1948.41 15937.38,-1926.58 15746.19,-1883.95"/>
<polygon fill="black" stroke="black" points="15746.77,-1880.49 15736.23,-1881.64 15745.19,-1887.31 15746.77,-1880.49"/>
</g>
<!-- layer2_expert5_2 -->
<g id="node505" class="node">
<title>layer2_expert5_2</title>
<polygon fill="lightgreen" stroke="black" points="15928,-1883.95 15754,-1883.95 15754,-1800.95 15928,-1800.95 15928,-1883.95"/>
<text text-anchor="middle" x="15841" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU5</text>
<text text-anchor="middle" x="15841" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15841" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15841" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15841" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_gate_gpu5&#45;&gt;layer2_expert5_2 -->
<g id="edge851" class="edge">
<title>layer2_gate_gpu5&#45;&gt;layer2_expert5_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16678.77,-1954.32C16479.25,-1943.53 16091.31,-1919.15 15938,-1883.92"/>
<polygon fill="black" stroke="black" points="15938.79,-1880.5 15928.25,-1881.58 15937.16,-1887.31 15938.79,-1880.5"/>
</g>
<!-- layer2_expert5_3 -->
<g id="node506" class="node">
<title>layer2_expert5_3</title>
<polygon fill="lightgreen" stroke="black" points="16120,-1883.95 15946,-1883.95 15946,-1800.95 16120,-1800.95 16120,-1883.95"/>
<text text-anchor="middle" x="16033" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU5</text>
<text text-anchor="middle" x="16033" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16033" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16033" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16033" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_gate_gpu5&#45;&gt;layer2_expert5_3 -->
<g id="edge852" class="edge">
<title>layer2_gate_gpu5&#45;&gt;layer2_expert5_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16678.91,-1957C16545.03,-1950.86 16324.46,-1933.79 16129.84,-1883.96"/>
<polygon fill="black" stroke="black" points="16130.57,-1880.53 16120.01,-1881.4 16128.81,-1887.3 16130.57,-1880.53"/>
</g>
<!-- layer2_expert5_4 -->
<g id="node507" class="node">
<title>layer2_expert5_4</title>
<polygon fill="lightgreen" stroke="black" points="16312,-1883.95 16138,-1883.95 16138,-1800.95 16312,-1800.95 16312,-1883.95"/>
<text text-anchor="middle" x="16225" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU5</text>
<text text-anchor="middle" x="16225" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16225" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16225" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16225" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_gate_gpu5&#45;&gt;layer2_expert5_4 -->
<g id="edge853" class="edge">
<title>layer2_gate_gpu5&#45;&gt;layer2_expert5_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16678.91,-1949.21C16583.32,-1938.51 16447.37,-1919.09 16321.84,-1884"/>
<polygon fill="black" stroke="black" points="16322.63,-1880.59 16312.06,-1881.23 16320.72,-1887.32 16322.63,-1880.59"/>
</g>
<!-- layer2_expert5_5 -->
<g id="node508" class="node">
<title>layer2_expert5_5</title>
<polygon fill="lightgreen" stroke="black" points="16504,-1883.95 16330,-1883.95 16330,-1800.95 16504,-1800.95 16504,-1883.95"/>
<text text-anchor="middle" x="16417" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU5</text>
<text text-anchor="middle" x="16417" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16417" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16417" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16417" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_gate_gpu5&#45;&gt;layer2_expert5_5 -->
<g id="edge854" class="edge">
<title>layer2_gate_gpu5&#45;&gt;layer2_expert5_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16678.66,-1931.97C16629.66,-1919.59 16572.72,-1903.96 16513.67,-1884.07"/>
<polygon fill="black" stroke="black" points="16514.77,-1880.75 16504.18,-1880.84 16512.52,-1887.37 16514.77,-1880.75"/>
</g>
<!-- layer2_expert5_6 -->
<g id="node509" class="node">
<title>layer2_expert5_6</title>
<polygon fill="lightgreen" stroke="black" points="16696,-1883.95 16522,-1883.95 16522,-1800.95 16696,-1800.95 16696,-1883.95"/>
<text text-anchor="middle" x="16609" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU5</text>
<text text-anchor="middle" x="16609" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16609" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16609" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16609" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_gate_gpu5&#45;&gt;layer2_expert5_6 -->
<g id="edge855" class="edge">
<title>layer2_gate_gpu5&#45;&gt;layer2_expert5_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16734.39,-1919.86C16718.15,-1909.97 16700.68,-1899.32 16684.08,-1889.21"/>
<polygon fill="black" stroke="black" points="16685.86,-1886.19 16675.5,-1883.97 16682.21,-1892.17 16685.86,-1886.19"/>
</g>
<!-- layer2_expert5_7 -->
<g id="node510" class="node">
<title>layer2_expert5_7</title>
<polygon fill="lightgreen" stroke="black" points="16888,-1883.95 16714,-1883.95 16714,-1800.95 16888,-1800.95 16888,-1883.95"/>
<text text-anchor="middle" x="16801" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU5</text>
<text text-anchor="middle" x="16801" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16801" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16801" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16801" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_gate_gpu5&#45;&gt;layer2_expert5_7 -->
<g id="edge856" class="edge">
<title>layer2_gate_gpu5&#45;&gt;layer2_expert5_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16801,-1919.86C16801,-1911.6 16801,-1902.82 16801,-1894.26"/>
<polygon fill="black" stroke="black" points="16804.5,-1893.97 16801,-1883.97 16797.5,-1893.97 16804.5,-1893.97"/>
</g>
<!-- layer2_expert5_8 -->
<g id="node511" class="node">
<title>layer2_expert5_8</title>
<polygon fill="lightgreen" stroke="black" points="17080,-1883.95 16906,-1883.95 16906,-1800.95 17080,-1800.95 17080,-1883.95"/>
<text text-anchor="middle" x="16993" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU5</text>
<text text-anchor="middle" x="16993" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16993" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16993" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16993" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_gate_gpu5&#45;&gt;layer2_expert5_8 -->
<g id="edge857" class="edge">
<title>layer2_gate_gpu5&#45;&gt;layer2_expert5_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16867.61,-1919.86C16883.85,-1909.97 16901.32,-1899.32 16917.92,-1889.21"/>
<polygon fill="black" stroke="black" points="16919.79,-1892.17 16926.5,-1883.97 16916.14,-1886.19 16919.79,-1892.17"/>
</g>
<!-- layer2_expert5_9 -->
<g id="node512" class="node">
<title>layer2_expert5_9</title>
<polygon fill="lightgreen" stroke="black" points="17272,-1883.95 17098,-1883.95 17098,-1800.95 17272,-1800.95 17272,-1883.95"/>
<text text-anchor="middle" x="17185" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU5</text>
<text text-anchor="middle" x="17185" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17185" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17185" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17185" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_gate_gpu5&#45;&gt;layer2_expert5_9 -->
<g id="edge858" class="edge">
<title>layer2_gate_gpu5&#45;&gt;layer2_expert5_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16923.34,-1931.97C16972.34,-1919.59 17029.28,-1903.96 17088.33,-1884.07"/>
<polygon fill="black" stroke="black" points="17089.48,-1887.37 17097.82,-1880.84 17087.23,-1880.75 17089.48,-1887.37"/>
</g>
<!-- layer2_expert5_10 -->
<g id="node513" class="node">
<title>layer2_expert5_10</title>
<polygon fill="lightgreen" stroke="black" points="17464,-1883.95 17290,-1883.95 17290,-1800.95 17464,-1800.95 17464,-1883.95"/>
<text text-anchor="middle" x="17377" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU5</text>
<text text-anchor="middle" x="17377" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17377" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17377" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17377" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_gate_gpu5&#45;&gt;layer2_expert5_10 -->
<g id="edge859" class="edge">
<title>layer2_gate_gpu5&#45;&gt;layer2_expert5_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16923.09,-1949.21C17018.68,-1938.51 17154.63,-1919.09 17280.16,-1884"/>
<polygon fill="black" stroke="black" points="17281.28,-1887.32 17289.94,-1881.23 17279.37,-1880.59 17281.28,-1887.32"/>
</g>
<!-- layer2_expert5_11 -->
<g id="node514" class="node">
<title>layer2_expert5_11</title>
<polygon fill="lightgreen" stroke="black" points="17656,-1883.95 17482,-1883.95 17482,-1800.95 17656,-1800.95 17656,-1883.95"/>
<text text-anchor="middle" x="17569" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU5</text>
<text text-anchor="middle" x="17569" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17569" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17569" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17569" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_gate_gpu5&#45;&gt;layer2_expert5_11 -->
<g id="edge860" class="edge">
<title>layer2_gate_gpu5&#45;&gt;layer2_expert5_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16923.09,-1957C17056.97,-1950.86 17277.54,-1933.79 17472.16,-1883.96"/>
<polygon fill="black" stroke="black" points="17473.19,-1887.3 17481.99,-1881.4 17471.43,-1880.53 17473.19,-1887.3"/>
</g>
<!-- layer2_expert5_12 -->
<g id="node515" class="node">
<title>layer2_expert5_12</title>
<polygon fill="lightgreen" stroke="black" points="17848,-1883.95 17674,-1883.95 17674,-1800.95 17848,-1800.95 17848,-1883.95"/>
<text text-anchor="middle" x="17761" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU5</text>
<text text-anchor="middle" x="17761" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17761" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17761" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17761" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_gate_gpu5&#45;&gt;layer2_expert5_12 -->
<g id="edge861" class="edge">
<title>layer2_gate_gpu5&#45;&gt;layer2_expert5_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16923.23,-1954.32C17122.75,-1943.53 17510.69,-1919.15 17664,-1883.92"/>
<polygon fill="black" stroke="black" points="17664.84,-1887.31 17673.75,-1881.58 17663.21,-1880.5 17664.84,-1887.31"/>
</g>
<!-- layer2_expert5_13 -->
<g id="node516" class="node">
<title>layer2_expert5_13</title>
<polygon fill="lightgreen" stroke="black" points="18040,-1883.95 17866,-1883.95 17866,-1800.95 18040,-1800.95 18040,-1883.95"/>
<text text-anchor="middle" x="17953" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU5</text>
<text text-anchor="middle" x="17953" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17953" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17953" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17953" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_gate_gpu5&#45;&gt;layer2_expert5_13 -->
<g id="edge862" class="edge">
<title>layer2_gate_gpu5&#45;&gt;layer2_expert5_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16923.08,-1956.61C17157.72,-1948.41 17664.62,-1926.58 17855.81,-1883.95"/>
<polygon fill="black" stroke="black" points="17856.81,-1887.31 17865.77,-1881.64 17855.23,-1880.49 17856.81,-1887.31"/>
</g>
<!-- layer2_expert5_14 -->
<g id="node517" class="node">
<title>layer2_expert5_14</title>
<polygon fill="lightgreen" stroke="black" points="18232,-1883.95 18058,-1883.95 18058,-1800.95 18232,-1800.95 18232,-1883.95"/>
<text text-anchor="middle" x="18145" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU5</text>
<text text-anchor="middle" x="18145" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18145" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18145" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18145" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_gate_gpu5&#45;&gt;layer2_expert5_14 -->
<g id="edge863" class="edge">
<title>layer2_gate_gpu5&#45;&gt;layer2_expert5_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16923.18,-1958.19C17190.05,-1952.43 17818.75,-1934.07 18047.83,-1883.94"/>
<polygon fill="black" stroke="black" points="18048.8,-1887.31 18057.78,-1881.68 18047.25,-1880.48 18048.8,-1887.31"/>
</g>
<!-- layer2_expert5_15 -->
<g id="node518" class="node">
<title>layer2_expert5_15</title>
<polygon fill="lightgreen" stroke="black" points="18424,-1883.95 18250,-1883.95 18250,-1800.95 18424,-1800.95 18424,-1883.95"/>
<text text-anchor="middle" x="18337" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU5</text>
<text text-anchor="middle" x="18337" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18337" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18337" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18337" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_gate_gpu5&#45;&gt;layer2_expert5_15 -->
<g id="edge864" class="edge">
<title>layer2_gate_gpu5&#45;&gt;layer2_expert5_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16923.2,-1959.37C17219.79,-1955.87 17972.41,-1941.65 18239.71,-1883.96"/>
<polygon fill="black" stroke="black" points="18240.78,-1887.31 18249.78,-1881.71 18239.26,-1880.48 18240.78,-1887.31"/>
</g>
<!-- layer2_moe_agg_gpu5 -->
<g id="node519" class="node">
<title>layer2_moe_agg_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="16902.5,-1764.95 16699.5,-1764.95 16699.5,-1696.95 16902.5,-1696.95 16902.5,-1764.95"/>
<text text-anchor="middle" x="16801" y="-1749.75" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU5</text>
<text text-anchor="middle" x="16801" y="-1734.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="16801" y="-1719.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="16801" y="-1704.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_expert5_0&#45;&gt;layer2_moe_agg_gpu5 -->
<g id="edge865" class="edge">
<title>layer2_expert5_0&#45;&gt;layer2_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M15544.22,-1803.2C15547.16,-1802.38 15550.09,-1801.63 15553,-1800.95 15767.24,-1751.42 16424.44,-1737.07 16688.97,-1733.24"/>
<polygon fill="black" stroke="black" points="16689.41,-1736.73 16699.36,-1733.09 16689.31,-1729.73 16689.41,-1736.73"/>
</g>
<!-- layer2_expert5_1&#45;&gt;layer2_moe_agg_gpu5 -->
<g id="edge866" class="edge">
<title>layer2_expert5_1&#45;&gt;layer2_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M15736.23,-1803.24C15739.17,-1802.41 15742.1,-1801.64 15745,-1800.95 15921.72,-1759.16 16455.22,-1740.77 16689.09,-1734.56"/>
<polygon fill="black" stroke="black" points="16689.42,-1738.05 16699.32,-1734.29 16689.23,-1731.05 16689.42,-1738.05"/>
</g>
<!-- layer2_expert5_2&#45;&gt;layer2_moe_agg_gpu5 -->
<g id="edge867" class="edge">
<title>layer2_expert5_2&#45;&gt;layer2_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M15928.24,-1803.3C15931.18,-1802.45 15934.1,-1801.66 15937,-1800.95 16076.55,-1766.88 16488.54,-1745.25 16688.96,-1736.46"/>
<polygon fill="black" stroke="black" points="16689.39,-1739.94 16699.22,-1736.01 16689.08,-1732.95 16689.39,-1739.94"/>
</g>
<!-- layer2_expert5_3&#45;&gt;layer2_moe_agg_gpu5 -->
<g id="edge868" class="edge">
<title>layer2_expert5_3&#45;&gt;layer2_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16120.26,-1803.38C16123.19,-1802.51 16126.11,-1801.69 16129,-1800.95 16321.8,-1751.56 16554.29,-1737.33 16689.12,-1733.35"/>
<polygon fill="black" stroke="black" points="16689.56,-1736.84 16699.46,-1733.06 16689.37,-1729.84 16689.56,-1736.84"/>
</g>
<!-- layer2_expert5_4&#45;&gt;layer2_moe_agg_gpu5 -->
<g id="edge869" class="edge">
<title>layer2_expert5_4&#45;&gt;layer2_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16312.04,-1803.62C16315.04,-1802.67 16318.04,-1801.78 16321,-1800.95 16444.52,-1766.64 16590.92,-1748.73 16689.28,-1739.86"/>
<polygon fill="black" stroke="black" points="16689.59,-1743.34 16699.24,-1738.97 16688.97,-1736.37 16689.59,-1743.34"/>
</g>
<!-- layer2_expert5_5&#45;&gt;layer2_moe_agg_gpu5 -->
<g id="edge870" class="edge">
<title>layer2_expert5_5&#45;&gt;layer2_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16504.15,-1803.97C16507.12,-1802.92 16510.08,-1801.91 16513,-1800.95 16570.25,-1782.16 16635.45,-1766.11 16689.32,-1754.23"/>
<polygon fill="black" stroke="black" points="16690.22,-1757.62 16699.24,-1752.06 16688.72,-1750.78 16690.22,-1757.62"/>
</g>
<!-- layer2_expert5_6&#45;&gt;layer2_moe_agg_gpu5 -->
<g id="edge871" class="edge">
<title>layer2_expert5_6&#45;&gt;layer2_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16680.22,-1800.84C16697.85,-1790.78 16716.68,-1780.04 16734.1,-1770.11"/>
<polygon fill="black" stroke="black" points="16736.11,-1772.99 16743.06,-1765 16732.64,-1766.91 16736.11,-1772.99"/>
</g>
<!-- layer2_expert5_7&#45;&gt;layer2_moe_agg_gpu5 -->
<g id="edge872" class="edge">
<title>layer2_expert5_7&#45;&gt;layer2_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16801,-1800.68C16801,-1792.47 16801,-1783.81 16801,-1775.51"/>
<polygon fill="black" stroke="black" points="16804.5,-1775.25 16801,-1765.25 16797.5,-1775.25 16804.5,-1775.25"/>
</g>
<!-- layer2_expert5_8&#45;&gt;layer2_moe_agg_gpu5 -->
<g id="edge873" class="edge">
<title>layer2_expert5_8&#45;&gt;layer2_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16921.78,-1800.84C16904.15,-1790.78 16885.32,-1780.04 16867.9,-1770.11"/>
<polygon fill="black" stroke="black" points="16869.36,-1766.91 16858.94,-1765 16865.89,-1772.99 16869.36,-1766.91"/>
</g>
<!-- layer2_expert5_9&#45;&gt;layer2_moe_agg_gpu5 -->
<g id="edge874" class="edge">
<title>layer2_expert5_9&#45;&gt;layer2_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17097.85,-1803.97C17094.88,-1802.92 17091.92,-1801.91 17089,-1800.95 17031.75,-1782.16 16966.55,-1766.11 16912.68,-1754.23"/>
<polygon fill="black" stroke="black" points="16913.28,-1750.78 16902.76,-1752.06 16911.78,-1757.62 16913.28,-1750.78"/>
</g>
<!-- layer2_expert5_10&#45;&gt;layer2_moe_agg_gpu5 -->
<g id="edge875" class="edge">
<title>layer2_expert5_10&#45;&gt;layer2_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17289.96,-1803.62C17286.96,-1802.67 17283.96,-1801.78 17281,-1800.95 17157.48,-1766.64 17011.08,-1748.73 16912.72,-1739.86"/>
<polygon fill="black" stroke="black" points="16913.03,-1736.37 16902.76,-1738.97 16912.41,-1743.34 16913.03,-1736.37"/>
</g>
<!-- layer2_expert5_11&#45;&gt;layer2_moe_agg_gpu5 -->
<g id="edge876" class="edge">
<title>layer2_expert5_11&#45;&gt;layer2_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17481.74,-1803.38C17478.81,-1802.51 17475.89,-1801.69 17473,-1800.95 17280.2,-1751.56 17047.71,-1737.33 16912.88,-1733.35"/>
<polygon fill="black" stroke="black" points="16912.63,-1729.84 16902.54,-1733.06 16912.44,-1736.84 16912.63,-1729.84"/>
</g>
<!-- layer2_expert5_12&#45;&gt;layer2_moe_agg_gpu5 -->
<g id="edge877" class="edge">
<title>layer2_expert5_12&#45;&gt;layer2_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17673.76,-1803.3C17670.82,-1802.45 17667.9,-1801.66 17665,-1800.95 17525.45,-1766.88 17113.46,-1745.25 16913.04,-1736.46"/>
<polygon fill="black" stroke="black" points="16912.92,-1732.95 16902.78,-1736.01 16912.61,-1739.94 16912.92,-1732.95"/>
</g>
<!-- layer2_expert5_13&#45;&gt;layer2_moe_agg_gpu5 -->
<g id="edge878" class="edge">
<title>layer2_expert5_13&#45;&gt;layer2_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17865.77,-1803.24C17862.83,-1802.41 17859.9,-1801.64 17857,-1800.95 17680.28,-1759.16 17146.78,-1740.77 16912.91,-1734.56"/>
<polygon fill="black" stroke="black" points="16912.77,-1731.05 16902.68,-1734.29 16912.58,-1738.05 16912.77,-1731.05"/>
</g>
<!-- layer2_expert5_14&#45;&gt;layer2_moe_agg_gpu5 -->
<g id="edge879" class="edge">
<title>layer2_expert5_14&#45;&gt;layer2_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M18057.78,-1803.2C18054.84,-1802.38 18051.91,-1801.63 18049,-1800.95 17834.76,-1751.42 17177.56,-1737.07 16913.03,-1733.24"/>
<polygon fill="black" stroke="black" points="16912.69,-1729.73 16902.64,-1733.09 16912.59,-1736.73 16912.69,-1729.73"/>
</g>
<!-- layer2_expert5_15&#45;&gt;layer2_moe_agg_gpu5 -->
<g id="edge880" class="edge">
<title>layer2_expert5_15&#45;&gt;layer2_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M18249.79,-1803.17C18246.84,-1802.36 18243.91,-1801.62 18241,-1800.95 17988.87,-1743.63 17205.73,-1733.89 16912.95,-1732.27"/>
<polygon fill="black" stroke="black" points="16912.76,-1728.77 16902.75,-1732.21 16912.73,-1735.77 16912.76,-1728.77"/>
</g>
<!-- layer2_moe_agg_gpu5&#45;&gt;layer2_moe_allreduce -->
<g id="edge881" class="edge">
<title>layer2_moe_agg_gpu5&#45;&gt;layer2_moe_allreduce</title>
<path fill="none" stroke="black" d="M16699.36,-1726.89C16129.13,-1709.7 13324.17,-1625.16 12510.58,-1600.63"/>
<polygon fill="black" stroke="black" points="12510.61,-1597.13 12500.51,-1600.33 12510.4,-1604.13 12510.61,-1597.13"/>
</g>
<!-- layer2_output_gpu5 -->
<g id="node520" class="node">
<title>layer2_output_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12804,-1488.95 12560,-1488.95 12560,-1420.95 12804,-1420.95 12804,-1488.95"/>
<text text-anchor="middle" x="12682" y="-1473.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU5</text>
<text text-anchor="middle" x="12682" y="-1458.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="12682" y="-1443.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12682" y="-1428.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_qkv_gpu5 -->
<g id="node575" class="node">
<title>layer3_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12781,-1384.95 12581,-1384.95 12581,-1286.95 12781,-1286.95 12781,-1384.95"/>
<text text-anchor="middle" x="12681" y="-1369.75" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU5</text>
<text text-anchor="middle" x="12681" y="-1354.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12681" y="-1339.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12681" y="-1324.75" font-family="Times,serif" font-size="14.00">Heads: 20&#45;23</text>
<text text-anchor="middle" x="12681" y="-1309.75" font-family="Times,serif" font-size="14.00">TP Slice: 5</text>
<text text-anchor="middle" x="12681" y="-1294.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_output_gpu5&#45;&gt;layer3_qkv_gpu5 -->
<g id="edge966" class="edge">
<title>layer2_output_gpu5&#45;&gt;layer3_qkv_gpu5</title>
<path fill="none" stroke="black" d="M12681.72,-1420.74C12681.65,-1412.78 12681.57,-1404.04 12681.5,-1395.3"/>
<polygon fill="black" stroke="black" points="12685,-1395.07 12681.41,-1385.1 12678,-1395.13 12685,-1395.07"/>
</g>
<!-- layer2_expert6_0 -->
<g id="node522" class="node">
<title>layer2_expert6_0</title>
<polygon fill="lightgreen" stroke="black" points="18616,-1883.95 18442,-1883.95 18442,-1800.95 18616,-1800.95 18616,-1883.95"/>
<text text-anchor="middle" x="18529" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU6</text>
<text text-anchor="middle" x="18529" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18529" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18529" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18529" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_gate_gpu6&#45;&gt;layer2_expert6_0 -->
<g id="edge888" class="edge">
<title>layer2_gate_gpu6&#45;&gt;layer2_expert6_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19750.82,-1958.19C19483.95,-1952.43 18855.25,-1934.07 18626.17,-1883.94"/>
<polygon fill="black" stroke="black" points="18626.75,-1880.48 18616.22,-1881.68 18625.2,-1887.31 18626.75,-1880.48"/>
</g>
<!-- layer2_expert6_1 -->
<g id="node523" class="node">
<title>layer2_expert6_1</title>
<polygon fill="lightgreen" stroke="black" points="18808,-1883.95 18634,-1883.95 18634,-1800.95 18808,-1800.95 18808,-1883.95"/>
<text text-anchor="middle" x="18721" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU6</text>
<text text-anchor="middle" x="18721" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18721" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18721" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18721" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_gate_gpu6&#45;&gt;layer2_expert6_1 -->
<g id="edge889" class="edge">
<title>layer2_gate_gpu6&#45;&gt;layer2_expert6_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19750.92,-1956.61C19516.28,-1948.41 19009.38,-1926.58 18818.19,-1883.95"/>
<polygon fill="black" stroke="black" points="18818.77,-1880.49 18808.23,-1881.64 18817.19,-1887.31 18818.77,-1880.49"/>
</g>
<!-- layer2_expert6_2 -->
<g id="node524" class="node">
<title>layer2_expert6_2</title>
<polygon fill="lightgreen" stroke="black" points="19000,-1883.95 18826,-1883.95 18826,-1800.95 19000,-1800.95 19000,-1883.95"/>
<text text-anchor="middle" x="18913" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU6</text>
<text text-anchor="middle" x="18913" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18913" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18913" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18913" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_gate_gpu6&#45;&gt;layer2_expert6_2 -->
<g id="edge890" class="edge">
<title>layer2_gate_gpu6&#45;&gt;layer2_expert6_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19750.77,-1954.32C19551.25,-1943.53 19163.31,-1919.15 19010,-1883.92"/>
<polygon fill="black" stroke="black" points="19010.79,-1880.5 19000.25,-1881.58 19009.16,-1887.31 19010.79,-1880.5"/>
</g>
<!-- layer2_expert6_3 -->
<g id="node525" class="node">
<title>layer2_expert6_3</title>
<polygon fill="lightgreen" stroke="black" points="19192,-1883.95 19018,-1883.95 19018,-1800.95 19192,-1800.95 19192,-1883.95"/>
<text text-anchor="middle" x="19105" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU6</text>
<text text-anchor="middle" x="19105" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19105" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19105" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19105" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_gate_gpu6&#45;&gt;layer2_expert6_3 -->
<g id="edge891" class="edge">
<title>layer2_gate_gpu6&#45;&gt;layer2_expert6_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19750.91,-1957C19617.03,-1950.86 19396.46,-1933.79 19201.84,-1883.96"/>
<polygon fill="black" stroke="black" points="19202.57,-1880.53 19192.01,-1881.4 19200.81,-1887.3 19202.57,-1880.53"/>
</g>
<!-- layer2_expert6_4 -->
<g id="node526" class="node">
<title>layer2_expert6_4</title>
<polygon fill="lightgreen" stroke="black" points="19384,-1883.95 19210,-1883.95 19210,-1800.95 19384,-1800.95 19384,-1883.95"/>
<text text-anchor="middle" x="19297" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU6</text>
<text text-anchor="middle" x="19297" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19297" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19297" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19297" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_gate_gpu6&#45;&gt;layer2_expert6_4 -->
<g id="edge892" class="edge">
<title>layer2_gate_gpu6&#45;&gt;layer2_expert6_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19750.91,-1949.21C19655.32,-1938.51 19519.37,-1919.09 19393.84,-1884"/>
<polygon fill="black" stroke="black" points="19394.63,-1880.59 19384.06,-1881.23 19392.72,-1887.32 19394.63,-1880.59"/>
</g>
<!-- layer2_expert6_5 -->
<g id="node527" class="node">
<title>layer2_expert6_5</title>
<polygon fill="lightgreen" stroke="black" points="19576,-1883.95 19402,-1883.95 19402,-1800.95 19576,-1800.95 19576,-1883.95"/>
<text text-anchor="middle" x="19489" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU6</text>
<text text-anchor="middle" x="19489" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19489" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19489" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19489" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_gate_gpu6&#45;&gt;layer2_expert6_5 -->
<g id="edge893" class="edge">
<title>layer2_gate_gpu6&#45;&gt;layer2_expert6_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19750.66,-1931.97C19701.66,-1919.59 19644.72,-1903.96 19585.67,-1884.07"/>
<polygon fill="black" stroke="black" points="19586.77,-1880.75 19576.18,-1880.84 19584.52,-1887.37 19586.77,-1880.75"/>
</g>
<!-- layer2_expert6_6 -->
<g id="node528" class="node">
<title>layer2_expert6_6</title>
<polygon fill="lightgreen" stroke="black" points="19768,-1883.95 19594,-1883.95 19594,-1800.95 19768,-1800.95 19768,-1883.95"/>
<text text-anchor="middle" x="19681" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU6</text>
<text text-anchor="middle" x="19681" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19681" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19681" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19681" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_gate_gpu6&#45;&gt;layer2_expert6_6 -->
<g id="edge894" class="edge">
<title>layer2_gate_gpu6&#45;&gt;layer2_expert6_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19806.39,-1919.86C19790.15,-1909.97 19772.68,-1899.32 19756.08,-1889.21"/>
<polygon fill="black" stroke="black" points="19757.86,-1886.19 19747.5,-1883.97 19754.21,-1892.17 19757.86,-1886.19"/>
</g>
<!-- layer2_expert6_7 -->
<g id="node529" class="node">
<title>layer2_expert6_7</title>
<polygon fill="lightgreen" stroke="black" points="19960,-1883.95 19786,-1883.95 19786,-1800.95 19960,-1800.95 19960,-1883.95"/>
<text text-anchor="middle" x="19873" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU6</text>
<text text-anchor="middle" x="19873" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19873" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19873" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19873" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_gate_gpu6&#45;&gt;layer2_expert6_7 -->
<g id="edge895" class="edge">
<title>layer2_gate_gpu6&#45;&gt;layer2_expert6_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19873,-1919.86C19873,-1911.6 19873,-1902.82 19873,-1894.26"/>
<polygon fill="black" stroke="black" points="19876.5,-1893.97 19873,-1883.97 19869.5,-1893.97 19876.5,-1893.97"/>
</g>
<!-- layer2_expert6_8 -->
<g id="node530" class="node">
<title>layer2_expert6_8</title>
<polygon fill="lightgreen" stroke="black" points="20152,-1883.95 19978,-1883.95 19978,-1800.95 20152,-1800.95 20152,-1883.95"/>
<text text-anchor="middle" x="20065" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU6</text>
<text text-anchor="middle" x="20065" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20065" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20065" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20065" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_gate_gpu6&#45;&gt;layer2_expert6_8 -->
<g id="edge896" class="edge">
<title>layer2_gate_gpu6&#45;&gt;layer2_expert6_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19939.61,-1919.86C19955.85,-1909.97 19973.32,-1899.32 19989.92,-1889.21"/>
<polygon fill="black" stroke="black" points="19991.79,-1892.17 19998.5,-1883.97 19988.14,-1886.19 19991.79,-1892.17"/>
</g>
<!-- layer2_expert6_9 -->
<g id="node531" class="node">
<title>layer2_expert6_9</title>
<polygon fill="lightgreen" stroke="black" points="20344,-1883.95 20170,-1883.95 20170,-1800.95 20344,-1800.95 20344,-1883.95"/>
<text text-anchor="middle" x="20257" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU6</text>
<text text-anchor="middle" x="20257" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20257" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20257" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20257" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_gate_gpu6&#45;&gt;layer2_expert6_9 -->
<g id="edge897" class="edge">
<title>layer2_gate_gpu6&#45;&gt;layer2_expert6_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19995.34,-1931.97C20044.34,-1919.59 20101.28,-1903.96 20160.33,-1884.07"/>
<polygon fill="black" stroke="black" points="20161.48,-1887.37 20169.82,-1880.84 20159.23,-1880.75 20161.48,-1887.37"/>
</g>
<!-- layer2_expert6_10 -->
<g id="node532" class="node">
<title>layer2_expert6_10</title>
<polygon fill="lightgreen" stroke="black" points="20536,-1883.95 20362,-1883.95 20362,-1800.95 20536,-1800.95 20536,-1883.95"/>
<text text-anchor="middle" x="20449" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU6</text>
<text text-anchor="middle" x="20449" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20449" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20449" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20449" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_gate_gpu6&#45;&gt;layer2_expert6_10 -->
<g id="edge898" class="edge">
<title>layer2_gate_gpu6&#45;&gt;layer2_expert6_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19995.09,-1949.21C20090.68,-1938.51 20226.63,-1919.09 20352.16,-1884"/>
<polygon fill="black" stroke="black" points="20353.28,-1887.32 20361.94,-1881.23 20351.37,-1880.59 20353.28,-1887.32"/>
</g>
<!-- layer2_expert6_11 -->
<g id="node533" class="node">
<title>layer2_expert6_11</title>
<polygon fill="lightgreen" stroke="black" points="20728,-1883.95 20554,-1883.95 20554,-1800.95 20728,-1800.95 20728,-1883.95"/>
<text text-anchor="middle" x="20641" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU6</text>
<text text-anchor="middle" x="20641" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20641" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20641" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20641" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_gate_gpu6&#45;&gt;layer2_expert6_11 -->
<g id="edge899" class="edge">
<title>layer2_gate_gpu6&#45;&gt;layer2_expert6_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19995.09,-1957C20128.97,-1950.86 20349.54,-1933.79 20544.16,-1883.96"/>
<polygon fill="black" stroke="black" points="20545.19,-1887.3 20553.99,-1881.4 20543.43,-1880.53 20545.19,-1887.3"/>
</g>
<!-- layer2_expert6_12 -->
<g id="node534" class="node">
<title>layer2_expert6_12</title>
<polygon fill="lightgreen" stroke="black" points="20920,-1883.95 20746,-1883.95 20746,-1800.95 20920,-1800.95 20920,-1883.95"/>
<text text-anchor="middle" x="20833" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU6</text>
<text text-anchor="middle" x="20833" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20833" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20833" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20833" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_gate_gpu6&#45;&gt;layer2_expert6_12 -->
<g id="edge900" class="edge">
<title>layer2_gate_gpu6&#45;&gt;layer2_expert6_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19995.23,-1954.32C20194.75,-1943.53 20582.69,-1919.15 20736,-1883.92"/>
<polygon fill="black" stroke="black" points="20736.84,-1887.31 20745.75,-1881.58 20735.21,-1880.5 20736.84,-1887.31"/>
</g>
<!-- layer2_expert6_13 -->
<g id="node535" class="node">
<title>layer2_expert6_13</title>
<polygon fill="lightgreen" stroke="black" points="21112,-1883.95 20938,-1883.95 20938,-1800.95 21112,-1800.95 21112,-1883.95"/>
<text text-anchor="middle" x="21025" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU6</text>
<text text-anchor="middle" x="21025" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21025" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21025" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21025" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_gate_gpu6&#45;&gt;layer2_expert6_13 -->
<g id="edge901" class="edge">
<title>layer2_gate_gpu6&#45;&gt;layer2_expert6_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19995.08,-1956.61C20229.72,-1948.41 20736.62,-1926.58 20927.81,-1883.95"/>
<polygon fill="black" stroke="black" points="20928.81,-1887.31 20937.77,-1881.64 20927.23,-1880.49 20928.81,-1887.31"/>
</g>
<!-- layer2_expert6_14 -->
<g id="node536" class="node">
<title>layer2_expert6_14</title>
<polygon fill="lightgreen" stroke="black" points="21304,-1883.95 21130,-1883.95 21130,-1800.95 21304,-1800.95 21304,-1883.95"/>
<text text-anchor="middle" x="21217" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU6</text>
<text text-anchor="middle" x="21217" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21217" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21217" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21217" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_gate_gpu6&#45;&gt;layer2_expert6_14 -->
<g id="edge902" class="edge">
<title>layer2_gate_gpu6&#45;&gt;layer2_expert6_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19995.18,-1958.19C20262.05,-1952.43 20890.75,-1934.07 21119.83,-1883.94"/>
<polygon fill="black" stroke="black" points="21120.8,-1887.31 21129.78,-1881.68 21119.25,-1880.48 21120.8,-1887.31"/>
</g>
<!-- layer2_expert6_15 -->
<g id="node537" class="node">
<title>layer2_expert6_15</title>
<polygon fill="lightgreen" stroke="black" points="21496,-1883.95 21322,-1883.95 21322,-1800.95 21496,-1800.95 21496,-1883.95"/>
<text text-anchor="middle" x="21409" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU6</text>
<text text-anchor="middle" x="21409" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21409" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21409" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21409" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_gate_gpu6&#45;&gt;layer2_expert6_15 -->
<g id="edge903" class="edge">
<title>layer2_gate_gpu6&#45;&gt;layer2_expert6_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19995.2,-1959.37C20291.79,-1955.87 21044.41,-1941.65 21311.71,-1883.96"/>
<polygon fill="black" stroke="black" points="21312.78,-1887.31 21321.78,-1881.71 21311.26,-1880.48 21312.78,-1887.31"/>
</g>
<!-- layer2_moe_agg_gpu6 -->
<g id="node538" class="node">
<title>layer2_moe_agg_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="19974.5,-1764.95 19771.5,-1764.95 19771.5,-1696.95 19974.5,-1696.95 19974.5,-1764.95"/>
<text text-anchor="middle" x="19873" y="-1749.75" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU6</text>
<text text-anchor="middle" x="19873" y="-1734.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="19873" y="-1719.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="19873" y="-1704.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_expert6_0&#45;&gt;layer2_moe_agg_gpu6 -->
<g id="edge904" class="edge">
<title>layer2_expert6_0&#45;&gt;layer2_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M18616.22,-1803.2C18619.16,-1802.38 18622.09,-1801.63 18625,-1800.95 18839.24,-1751.42 19496.44,-1737.07 19760.97,-1733.24"/>
<polygon fill="black" stroke="black" points="19761.41,-1736.73 19771.36,-1733.09 19761.31,-1729.73 19761.41,-1736.73"/>
</g>
<!-- layer2_expert6_1&#45;&gt;layer2_moe_agg_gpu6 -->
<g id="edge905" class="edge">
<title>layer2_expert6_1&#45;&gt;layer2_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M18808.23,-1803.24C18811.17,-1802.41 18814.1,-1801.64 18817,-1800.95 18993.72,-1759.16 19527.22,-1740.77 19761.09,-1734.56"/>
<polygon fill="black" stroke="black" points="19761.42,-1738.05 19771.32,-1734.29 19761.23,-1731.05 19761.42,-1738.05"/>
</g>
<!-- layer2_expert6_2&#45;&gt;layer2_moe_agg_gpu6 -->
<g id="edge906" class="edge">
<title>layer2_expert6_2&#45;&gt;layer2_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19000.24,-1803.3C19003.18,-1802.45 19006.1,-1801.66 19009,-1800.95 19148.55,-1766.88 19560.54,-1745.25 19760.96,-1736.46"/>
<polygon fill="black" stroke="black" points="19761.39,-1739.94 19771.22,-1736.01 19761.08,-1732.95 19761.39,-1739.94"/>
</g>
<!-- layer2_expert6_3&#45;&gt;layer2_moe_agg_gpu6 -->
<g id="edge907" class="edge">
<title>layer2_expert6_3&#45;&gt;layer2_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19192.26,-1803.38C19195.19,-1802.51 19198.11,-1801.69 19201,-1800.95 19393.8,-1751.56 19626.29,-1737.33 19761.12,-1733.35"/>
<polygon fill="black" stroke="black" points="19761.56,-1736.84 19771.46,-1733.06 19761.37,-1729.84 19761.56,-1736.84"/>
</g>
<!-- layer2_expert6_4&#45;&gt;layer2_moe_agg_gpu6 -->
<g id="edge908" class="edge">
<title>layer2_expert6_4&#45;&gt;layer2_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19384.04,-1803.62C19387.04,-1802.67 19390.04,-1801.78 19393,-1800.95 19516.52,-1766.64 19662.92,-1748.73 19761.28,-1739.86"/>
<polygon fill="black" stroke="black" points="19761.59,-1743.34 19771.24,-1738.97 19760.97,-1736.37 19761.59,-1743.34"/>
</g>
<!-- layer2_expert6_5&#45;&gt;layer2_moe_agg_gpu6 -->
<g id="edge909" class="edge">
<title>layer2_expert6_5&#45;&gt;layer2_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19576.15,-1803.97C19579.12,-1802.92 19582.08,-1801.91 19585,-1800.95 19642.25,-1782.16 19707.45,-1766.11 19761.32,-1754.23"/>
<polygon fill="black" stroke="black" points="19762.22,-1757.62 19771.24,-1752.06 19760.72,-1750.78 19762.22,-1757.62"/>
</g>
<!-- layer2_expert6_6&#45;&gt;layer2_moe_agg_gpu6 -->
<g id="edge910" class="edge">
<title>layer2_expert6_6&#45;&gt;layer2_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19752.22,-1800.84C19769.85,-1790.78 19788.68,-1780.04 19806.1,-1770.11"/>
<polygon fill="black" stroke="black" points="19808.11,-1772.99 19815.06,-1765 19804.64,-1766.91 19808.11,-1772.99"/>
</g>
<!-- layer2_expert6_7&#45;&gt;layer2_moe_agg_gpu6 -->
<g id="edge911" class="edge">
<title>layer2_expert6_7&#45;&gt;layer2_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19873,-1800.68C19873,-1792.47 19873,-1783.81 19873,-1775.51"/>
<polygon fill="black" stroke="black" points="19876.5,-1775.25 19873,-1765.25 19869.5,-1775.25 19876.5,-1775.25"/>
</g>
<!-- layer2_expert6_8&#45;&gt;layer2_moe_agg_gpu6 -->
<g id="edge912" class="edge">
<title>layer2_expert6_8&#45;&gt;layer2_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19993.78,-1800.84C19976.15,-1790.78 19957.32,-1780.04 19939.9,-1770.11"/>
<polygon fill="black" stroke="black" points="19941.36,-1766.91 19930.94,-1765 19937.89,-1772.99 19941.36,-1766.91"/>
</g>
<!-- layer2_expert6_9&#45;&gt;layer2_moe_agg_gpu6 -->
<g id="edge913" class="edge">
<title>layer2_expert6_9&#45;&gt;layer2_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20169.85,-1803.97C20166.88,-1802.92 20163.92,-1801.91 20161,-1800.95 20103.75,-1782.16 20038.55,-1766.11 19984.68,-1754.23"/>
<polygon fill="black" stroke="black" points="19985.28,-1750.78 19974.76,-1752.06 19983.78,-1757.62 19985.28,-1750.78"/>
</g>
<!-- layer2_expert6_10&#45;&gt;layer2_moe_agg_gpu6 -->
<g id="edge914" class="edge">
<title>layer2_expert6_10&#45;&gt;layer2_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20361.96,-1803.62C20358.96,-1802.67 20355.96,-1801.78 20353,-1800.95 20229.48,-1766.64 20083.08,-1748.73 19984.72,-1739.86"/>
<polygon fill="black" stroke="black" points="19985.03,-1736.37 19974.76,-1738.97 19984.41,-1743.34 19985.03,-1736.37"/>
</g>
<!-- layer2_expert6_11&#45;&gt;layer2_moe_agg_gpu6 -->
<g id="edge915" class="edge">
<title>layer2_expert6_11&#45;&gt;layer2_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20553.74,-1803.38C20550.81,-1802.51 20547.89,-1801.69 20545,-1800.95 20352.2,-1751.56 20119.71,-1737.33 19984.88,-1733.35"/>
<polygon fill="black" stroke="black" points="19984.63,-1729.84 19974.54,-1733.06 19984.44,-1736.84 19984.63,-1729.84"/>
</g>
<!-- layer2_expert6_12&#45;&gt;layer2_moe_agg_gpu6 -->
<g id="edge916" class="edge">
<title>layer2_expert6_12&#45;&gt;layer2_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20745.76,-1803.3C20742.82,-1802.45 20739.9,-1801.66 20737,-1800.95 20597.45,-1766.88 20185.46,-1745.25 19985.04,-1736.46"/>
<polygon fill="black" stroke="black" points="19984.92,-1732.95 19974.78,-1736.01 19984.61,-1739.94 19984.92,-1732.95"/>
</g>
<!-- layer2_expert6_13&#45;&gt;layer2_moe_agg_gpu6 -->
<g id="edge917" class="edge">
<title>layer2_expert6_13&#45;&gt;layer2_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20937.77,-1803.24C20934.83,-1802.41 20931.9,-1801.64 20929,-1800.95 20752.28,-1759.16 20218.78,-1740.77 19984.91,-1734.56"/>
<polygon fill="black" stroke="black" points="19984.77,-1731.05 19974.68,-1734.29 19984.58,-1738.05 19984.77,-1731.05"/>
</g>
<!-- layer2_expert6_14&#45;&gt;layer2_moe_agg_gpu6 -->
<g id="edge918" class="edge">
<title>layer2_expert6_14&#45;&gt;layer2_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M21129.78,-1803.2C21126.84,-1802.38 21123.91,-1801.63 21121,-1800.95 20906.76,-1751.42 20249.56,-1737.07 19985.03,-1733.24"/>
<polygon fill="black" stroke="black" points="19984.69,-1729.73 19974.64,-1733.09 19984.59,-1736.73 19984.69,-1729.73"/>
</g>
<!-- layer2_expert6_15&#45;&gt;layer2_moe_agg_gpu6 -->
<g id="edge919" class="edge">
<title>layer2_expert6_15&#45;&gt;layer2_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M21321.79,-1803.17C21318.84,-1802.36 21315.91,-1801.62 21313,-1800.95 21060.87,-1743.63 20277.73,-1733.89 19984.95,-1732.27"/>
<polygon fill="black" stroke="black" points="19984.76,-1728.77 19974.75,-1732.21 19984.73,-1735.77 19984.76,-1728.77"/>
</g>
<!-- layer2_moe_agg_gpu6&#45;&gt;layer2_moe_allreduce -->
<g id="edge920" class="edge">
<title>layer2_moe_agg_gpu6&#45;&gt;layer2_moe_allreduce</title>
<path fill="none" stroke="black" d="M19771.17,-1728.13C18970.78,-1713.77 13691.68,-1619.11 12519.36,-1598.08"/>
<polygon fill="black" stroke="black" points="12519.2,-1594.58 12509.14,-1597.9 12519.07,-1601.58 12519.2,-1594.58"/>
</g>
<!-- layer2_output_gpu6 -->
<g id="node539" class="node">
<title>layer2_output_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="13066,-1488.95 12822,-1488.95 12822,-1420.95 13066,-1420.95 13066,-1488.95"/>
<text text-anchor="middle" x="12944" y="-1473.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU6</text>
<text text-anchor="middle" x="12944" y="-1458.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="12944" y="-1443.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12944" y="-1428.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_qkv_gpu6 -->
<g id="node578" class="node">
<title>layer3_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="13043,-1384.95 12843,-1384.95 12843,-1286.95 13043,-1286.95 13043,-1384.95"/>
<text text-anchor="middle" x="12943" y="-1369.75" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU6</text>
<text text-anchor="middle" x="12943" y="-1354.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12943" y="-1339.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12943" y="-1324.75" font-family="Times,serif" font-size="14.00">Heads: 24&#45;27</text>
<text text-anchor="middle" x="12943" y="-1309.75" font-family="Times,serif" font-size="14.00">TP Slice: 6</text>
<text text-anchor="middle" x="12943" y="-1294.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_output_gpu6&#45;&gt;layer3_qkv_gpu6 -->
<g id="edge967" class="edge">
<title>layer2_output_gpu6&#45;&gt;layer3_qkv_gpu6</title>
<path fill="none" stroke="black" d="M12943.72,-1420.74C12943.65,-1412.78 12943.57,-1404.04 12943.5,-1395.3"/>
<polygon fill="black" stroke="black" points="12947,-1395.07 12943.41,-1385.1 12940,-1395.13 12947,-1395.07"/>
</g>
<!-- layer2_expert7_0 -->
<g id="node541" class="node">
<title>layer2_expert7_0</title>
<polygon fill="lightgreen" stroke="black" points="21688,-1883.95 21514,-1883.95 21514,-1800.95 21688,-1800.95 21688,-1883.95"/>
<text text-anchor="middle" x="21601" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU7</text>
<text text-anchor="middle" x="21601" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21601" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21601" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21601" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gate_gpu7&#45;&gt;layer2_expert7_0 -->
<g id="edge927" class="edge">
<title>layer2_gate_gpu7&#45;&gt;layer2_expert7_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22822.82,-1958.19C22555.95,-1952.43 21927.25,-1934.07 21698.17,-1883.94"/>
<polygon fill="black" stroke="black" points="21698.75,-1880.48 21688.22,-1881.68 21697.2,-1887.31 21698.75,-1880.48"/>
</g>
<!-- layer2_expert7_1 -->
<g id="node542" class="node">
<title>layer2_expert7_1</title>
<polygon fill="lightgreen" stroke="black" points="21880,-1883.95 21706,-1883.95 21706,-1800.95 21880,-1800.95 21880,-1883.95"/>
<text text-anchor="middle" x="21793" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU7</text>
<text text-anchor="middle" x="21793" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21793" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21793" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21793" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gate_gpu7&#45;&gt;layer2_expert7_1 -->
<g id="edge928" class="edge">
<title>layer2_gate_gpu7&#45;&gt;layer2_expert7_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22822.92,-1956.61C22588.28,-1948.41 22081.38,-1926.58 21890.19,-1883.95"/>
<polygon fill="black" stroke="black" points="21890.77,-1880.49 21880.23,-1881.64 21889.19,-1887.31 21890.77,-1880.49"/>
</g>
<!-- layer2_expert7_2 -->
<g id="node543" class="node">
<title>layer2_expert7_2</title>
<polygon fill="lightgreen" stroke="black" points="22072,-1883.95 21898,-1883.95 21898,-1800.95 22072,-1800.95 22072,-1883.95"/>
<text text-anchor="middle" x="21985" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU7</text>
<text text-anchor="middle" x="21985" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21985" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21985" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21985" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gate_gpu7&#45;&gt;layer2_expert7_2 -->
<g id="edge929" class="edge">
<title>layer2_gate_gpu7&#45;&gt;layer2_expert7_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22822.77,-1954.32C22623.25,-1943.53 22235.31,-1919.15 22082,-1883.92"/>
<polygon fill="black" stroke="black" points="22082.79,-1880.5 22072.25,-1881.58 22081.16,-1887.31 22082.79,-1880.5"/>
</g>
<!-- layer2_expert7_3 -->
<g id="node544" class="node">
<title>layer2_expert7_3</title>
<polygon fill="lightgreen" stroke="black" points="22264,-1883.95 22090,-1883.95 22090,-1800.95 22264,-1800.95 22264,-1883.95"/>
<text text-anchor="middle" x="22177" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU7</text>
<text text-anchor="middle" x="22177" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22177" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22177" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22177" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gate_gpu7&#45;&gt;layer2_expert7_3 -->
<g id="edge930" class="edge">
<title>layer2_gate_gpu7&#45;&gt;layer2_expert7_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22822.91,-1957C22689.03,-1950.86 22468.46,-1933.79 22273.84,-1883.96"/>
<polygon fill="black" stroke="black" points="22274.57,-1880.53 22264.01,-1881.4 22272.81,-1887.3 22274.57,-1880.53"/>
</g>
<!-- layer2_expert7_4 -->
<g id="node545" class="node">
<title>layer2_expert7_4</title>
<polygon fill="lightgreen" stroke="black" points="22456,-1883.95 22282,-1883.95 22282,-1800.95 22456,-1800.95 22456,-1883.95"/>
<text text-anchor="middle" x="22369" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU7</text>
<text text-anchor="middle" x="22369" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22369" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22369" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22369" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gate_gpu7&#45;&gt;layer2_expert7_4 -->
<g id="edge931" class="edge">
<title>layer2_gate_gpu7&#45;&gt;layer2_expert7_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22822.91,-1949.21C22727.32,-1938.51 22591.37,-1919.09 22465.84,-1884"/>
<polygon fill="black" stroke="black" points="22466.63,-1880.59 22456.06,-1881.23 22464.72,-1887.32 22466.63,-1880.59"/>
</g>
<!-- layer2_expert7_5 -->
<g id="node546" class="node">
<title>layer2_expert7_5</title>
<polygon fill="lightgreen" stroke="black" points="22648,-1883.95 22474,-1883.95 22474,-1800.95 22648,-1800.95 22648,-1883.95"/>
<text text-anchor="middle" x="22561" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU7</text>
<text text-anchor="middle" x="22561" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22561" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22561" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22561" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gate_gpu7&#45;&gt;layer2_expert7_5 -->
<g id="edge932" class="edge">
<title>layer2_gate_gpu7&#45;&gt;layer2_expert7_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22822.66,-1931.97C22773.66,-1919.59 22716.72,-1903.96 22657.67,-1884.07"/>
<polygon fill="black" stroke="black" points="22658.77,-1880.75 22648.18,-1880.84 22656.52,-1887.37 22658.77,-1880.75"/>
</g>
<!-- layer2_expert7_6 -->
<g id="node547" class="node">
<title>layer2_expert7_6</title>
<polygon fill="lightgreen" stroke="black" points="22840,-1883.95 22666,-1883.95 22666,-1800.95 22840,-1800.95 22840,-1883.95"/>
<text text-anchor="middle" x="22753" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU7</text>
<text text-anchor="middle" x="22753" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22753" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22753" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22753" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gate_gpu7&#45;&gt;layer2_expert7_6 -->
<g id="edge933" class="edge">
<title>layer2_gate_gpu7&#45;&gt;layer2_expert7_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22878.39,-1919.86C22862.15,-1909.97 22844.68,-1899.32 22828.08,-1889.21"/>
<polygon fill="black" stroke="black" points="22829.86,-1886.19 22819.5,-1883.97 22826.21,-1892.17 22829.86,-1886.19"/>
</g>
<!-- layer2_expert7_7 -->
<g id="node548" class="node">
<title>layer2_expert7_7</title>
<polygon fill="lightgreen" stroke="black" points="23032,-1883.95 22858,-1883.95 22858,-1800.95 23032,-1800.95 23032,-1883.95"/>
<text text-anchor="middle" x="22945" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU7</text>
<text text-anchor="middle" x="22945" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22945" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22945" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22945" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gate_gpu7&#45;&gt;layer2_expert7_7 -->
<g id="edge934" class="edge">
<title>layer2_gate_gpu7&#45;&gt;layer2_expert7_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22945,-1919.86C22945,-1911.6 22945,-1902.82 22945,-1894.26"/>
<polygon fill="black" stroke="black" points="22948.5,-1893.97 22945,-1883.97 22941.5,-1893.97 22948.5,-1893.97"/>
</g>
<!-- layer2_expert7_8 -->
<g id="node549" class="node">
<title>layer2_expert7_8</title>
<polygon fill="lightgreen" stroke="black" points="23224,-1883.95 23050,-1883.95 23050,-1800.95 23224,-1800.95 23224,-1883.95"/>
<text text-anchor="middle" x="23137" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU7</text>
<text text-anchor="middle" x="23137" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23137" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23137" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23137" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gate_gpu7&#45;&gt;layer2_expert7_8 -->
<g id="edge935" class="edge">
<title>layer2_gate_gpu7&#45;&gt;layer2_expert7_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23011.61,-1919.86C23027.85,-1909.97 23045.32,-1899.32 23061.92,-1889.21"/>
<polygon fill="black" stroke="black" points="23063.79,-1892.17 23070.5,-1883.97 23060.14,-1886.19 23063.79,-1892.17"/>
</g>
<!-- layer2_expert7_9 -->
<g id="node550" class="node">
<title>layer2_expert7_9</title>
<polygon fill="lightgreen" stroke="black" points="23416,-1883.95 23242,-1883.95 23242,-1800.95 23416,-1800.95 23416,-1883.95"/>
<text text-anchor="middle" x="23329" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU7</text>
<text text-anchor="middle" x="23329" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23329" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23329" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23329" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gate_gpu7&#45;&gt;layer2_expert7_9 -->
<g id="edge936" class="edge">
<title>layer2_gate_gpu7&#45;&gt;layer2_expert7_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23067.34,-1931.97C23116.34,-1919.59 23173.28,-1903.96 23232.33,-1884.07"/>
<polygon fill="black" stroke="black" points="23233.48,-1887.37 23241.82,-1880.84 23231.23,-1880.75 23233.48,-1887.37"/>
</g>
<!-- layer2_expert7_10 -->
<g id="node551" class="node">
<title>layer2_expert7_10</title>
<polygon fill="lightgreen" stroke="black" points="23608,-1883.95 23434,-1883.95 23434,-1800.95 23608,-1800.95 23608,-1883.95"/>
<text text-anchor="middle" x="23521" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU7</text>
<text text-anchor="middle" x="23521" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23521" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23521" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23521" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gate_gpu7&#45;&gt;layer2_expert7_10 -->
<g id="edge937" class="edge">
<title>layer2_gate_gpu7&#45;&gt;layer2_expert7_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23067.09,-1949.21C23162.68,-1938.51 23298.63,-1919.09 23424.16,-1884"/>
<polygon fill="black" stroke="black" points="23425.28,-1887.32 23433.94,-1881.23 23423.37,-1880.59 23425.28,-1887.32"/>
</g>
<!-- layer2_expert7_11 -->
<g id="node552" class="node">
<title>layer2_expert7_11</title>
<polygon fill="lightgreen" stroke="black" points="23800,-1883.95 23626,-1883.95 23626,-1800.95 23800,-1800.95 23800,-1883.95"/>
<text text-anchor="middle" x="23713" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU7</text>
<text text-anchor="middle" x="23713" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23713" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23713" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23713" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gate_gpu7&#45;&gt;layer2_expert7_11 -->
<g id="edge938" class="edge">
<title>layer2_gate_gpu7&#45;&gt;layer2_expert7_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23067.09,-1957C23200.97,-1950.86 23421.54,-1933.79 23616.16,-1883.96"/>
<polygon fill="black" stroke="black" points="23617.19,-1887.3 23625.99,-1881.4 23615.43,-1880.53 23617.19,-1887.3"/>
</g>
<!-- layer2_expert7_12 -->
<g id="node553" class="node">
<title>layer2_expert7_12</title>
<polygon fill="lightgreen" stroke="black" points="23992,-1883.95 23818,-1883.95 23818,-1800.95 23992,-1800.95 23992,-1883.95"/>
<text text-anchor="middle" x="23905" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU7</text>
<text text-anchor="middle" x="23905" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23905" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23905" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23905" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gate_gpu7&#45;&gt;layer2_expert7_12 -->
<g id="edge939" class="edge">
<title>layer2_gate_gpu7&#45;&gt;layer2_expert7_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23067.23,-1954.32C23266.75,-1943.53 23654.69,-1919.15 23808,-1883.92"/>
<polygon fill="black" stroke="black" points="23808.84,-1887.31 23817.75,-1881.58 23807.21,-1880.5 23808.84,-1887.31"/>
</g>
<!-- layer2_expert7_13 -->
<g id="node554" class="node">
<title>layer2_expert7_13</title>
<polygon fill="lightgreen" stroke="black" points="24184,-1883.95 24010,-1883.95 24010,-1800.95 24184,-1800.95 24184,-1883.95"/>
<text text-anchor="middle" x="24097" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU7</text>
<text text-anchor="middle" x="24097" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24097" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24097" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24097" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gate_gpu7&#45;&gt;layer2_expert7_13 -->
<g id="edge940" class="edge">
<title>layer2_gate_gpu7&#45;&gt;layer2_expert7_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23067.08,-1956.61C23301.72,-1948.41 23808.62,-1926.58 23999.81,-1883.95"/>
<polygon fill="black" stroke="black" points="24000.81,-1887.31 24009.77,-1881.64 23999.23,-1880.49 24000.81,-1887.31"/>
</g>
<!-- layer2_expert7_14 -->
<g id="node555" class="node">
<title>layer2_expert7_14</title>
<polygon fill="lightgreen" stroke="black" points="24376,-1883.95 24202,-1883.95 24202,-1800.95 24376,-1800.95 24376,-1883.95"/>
<text text-anchor="middle" x="24289" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU7</text>
<text text-anchor="middle" x="24289" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24289" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24289" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24289" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gate_gpu7&#45;&gt;layer2_expert7_14 -->
<g id="edge941" class="edge">
<title>layer2_gate_gpu7&#45;&gt;layer2_expert7_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23067.18,-1958.19C23334.05,-1952.43 23962.75,-1934.07 24191.83,-1883.94"/>
<polygon fill="black" stroke="black" points="24192.8,-1887.31 24201.78,-1881.68 24191.25,-1880.48 24192.8,-1887.31"/>
</g>
<!-- layer2_expert7_15 -->
<g id="node556" class="node">
<title>layer2_expert7_15</title>
<polygon fill="lightgreen" stroke="black" points="24568,-1883.95 24394,-1883.95 24394,-1800.95 24568,-1800.95 24568,-1883.95"/>
<text text-anchor="middle" x="24481" y="-1868.75" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU7</text>
<text text-anchor="middle" x="24481" y="-1853.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24481" y="-1838.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24481" y="-1823.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24481" y="-1808.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gate_gpu7&#45;&gt;layer2_expert7_15 -->
<g id="edge942" class="edge">
<title>layer2_gate_gpu7&#45;&gt;layer2_expert7_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23067.2,-1959.37C23363.79,-1955.87 24116.41,-1941.65 24383.71,-1883.96"/>
<polygon fill="black" stroke="black" points="24384.78,-1887.31 24393.78,-1881.71 24383.26,-1880.48 24384.78,-1887.31"/>
</g>
<!-- layer2_moe_agg_gpu7 -->
<g id="node557" class="node">
<title>layer2_moe_agg_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="23046.5,-1764.95 22843.5,-1764.95 22843.5,-1696.95 23046.5,-1696.95 23046.5,-1764.95"/>
<text text-anchor="middle" x="22945" y="-1749.75" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU7</text>
<text text-anchor="middle" x="22945" y="-1734.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="22945" y="-1719.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="22945" y="-1704.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_expert7_0&#45;&gt;layer2_moe_agg_gpu7 -->
<g id="edge943" class="edge">
<title>layer2_expert7_0&#45;&gt;layer2_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M21688.22,-1803.2C21691.16,-1802.38 21694.09,-1801.63 21697,-1800.95 21911.24,-1751.42 22568.44,-1737.07 22832.97,-1733.24"/>
<polygon fill="black" stroke="black" points="22833.41,-1736.73 22843.36,-1733.09 22833.31,-1729.73 22833.41,-1736.73"/>
</g>
<!-- layer2_expert7_1&#45;&gt;layer2_moe_agg_gpu7 -->
<g id="edge944" class="edge">
<title>layer2_expert7_1&#45;&gt;layer2_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M21880.23,-1803.24C21883.17,-1802.41 21886.1,-1801.64 21889,-1800.95 22065.72,-1759.16 22599.22,-1740.77 22833.09,-1734.56"/>
<polygon fill="black" stroke="black" points="22833.42,-1738.05 22843.32,-1734.29 22833.23,-1731.05 22833.42,-1738.05"/>
</g>
<!-- layer2_expert7_2&#45;&gt;layer2_moe_agg_gpu7 -->
<g id="edge945" class="edge">
<title>layer2_expert7_2&#45;&gt;layer2_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22072.24,-1803.3C22075.18,-1802.45 22078.1,-1801.66 22081,-1800.95 22220.55,-1766.88 22632.54,-1745.25 22832.96,-1736.46"/>
<polygon fill="black" stroke="black" points="22833.39,-1739.94 22843.22,-1736.01 22833.08,-1732.95 22833.39,-1739.94"/>
</g>
<!-- layer2_expert7_3&#45;&gt;layer2_moe_agg_gpu7 -->
<g id="edge946" class="edge">
<title>layer2_expert7_3&#45;&gt;layer2_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22264.26,-1803.38C22267.19,-1802.51 22270.11,-1801.69 22273,-1800.95 22465.8,-1751.56 22698.29,-1737.33 22833.12,-1733.35"/>
<polygon fill="black" stroke="black" points="22833.56,-1736.84 22843.46,-1733.06 22833.37,-1729.84 22833.56,-1736.84"/>
</g>
<!-- layer2_expert7_4&#45;&gt;layer2_moe_agg_gpu7 -->
<g id="edge947" class="edge">
<title>layer2_expert7_4&#45;&gt;layer2_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22456.04,-1803.62C22459.04,-1802.67 22462.04,-1801.78 22465,-1800.95 22588.52,-1766.64 22734.92,-1748.73 22833.28,-1739.86"/>
<polygon fill="black" stroke="black" points="22833.59,-1743.34 22843.24,-1738.97 22832.97,-1736.37 22833.59,-1743.34"/>
</g>
<!-- layer2_expert7_5&#45;&gt;layer2_moe_agg_gpu7 -->
<g id="edge948" class="edge">
<title>layer2_expert7_5&#45;&gt;layer2_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22648.15,-1803.97C22651.12,-1802.92 22654.08,-1801.91 22657,-1800.95 22714.25,-1782.16 22779.45,-1766.11 22833.32,-1754.23"/>
<polygon fill="black" stroke="black" points="22834.22,-1757.62 22843.24,-1752.06 22832.72,-1750.78 22834.22,-1757.62"/>
</g>
<!-- layer2_expert7_6&#45;&gt;layer2_moe_agg_gpu7 -->
<g id="edge949" class="edge">
<title>layer2_expert7_6&#45;&gt;layer2_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22824.22,-1800.84C22841.85,-1790.78 22860.68,-1780.04 22878.1,-1770.11"/>
<polygon fill="black" stroke="black" points="22880.11,-1772.99 22887.06,-1765 22876.64,-1766.91 22880.11,-1772.99"/>
</g>
<!-- layer2_expert7_7&#45;&gt;layer2_moe_agg_gpu7 -->
<g id="edge950" class="edge">
<title>layer2_expert7_7&#45;&gt;layer2_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22945,-1800.68C22945,-1792.47 22945,-1783.81 22945,-1775.51"/>
<polygon fill="black" stroke="black" points="22948.5,-1775.25 22945,-1765.25 22941.5,-1775.25 22948.5,-1775.25"/>
</g>
<!-- layer2_expert7_8&#45;&gt;layer2_moe_agg_gpu7 -->
<g id="edge951" class="edge">
<title>layer2_expert7_8&#45;&gt;layer2_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23065.78,-1800.84C23048.15,-1790.78 23029.32,-1780.04 23011.9,-1770.11"/>
<polygon fill="black" stroke="black" points="23013.36,-1766.91 23002.94,-1765 23009.89,-1772.99 23013.36,-1766.91"/>
</g>
<!-- layer2_expert7_9&#45;&gt;layer2_moe_agg_gpu7 -->
<g id="edge952" class="edge">
<title>layer2_expert7_9&#45;&gt;layer2_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23241.85,-1803.97C23238.88,-1802.92 23235.92,-1801.91 23233,-1800.95 23175.75,-1782.16 23110.55,-1766.11 23056.68,-1754.23"/>
<polygon fill="black" stroke="black" points="23057.28,-1750.78 23046.76,-1752.06 23055.78,-1757.62 23057.28,-1750.78"/>
</g>
<!-- layer2_expert7_10&#45;&gt;layer2_moe_agg_gpu7 -->
<g id="edge953" class="edge">
<title>layer2_expert7_10&#45;&gt;layer2_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23433.96,-1803.62C23430.96,-1802.67 23427.96,-1801.78 23425,-1800.95 23301.48,-1766.64 23155.08,-1748.73 23056.72,-1739.86"/>
<polygon fill="black" stroke="black" points="23057.03,-1736.37 23046.76,-1738.97 23056.41,-1743.34 23057.03,-1736.37"/>
</g>
<!-- layer2_expert7_11&#45;&gt;layer2_moe_agg_gpu7 -->
<g id="edge954" class="edge">
<title>layer2_expert7_11&#45;&gt;layer2_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23625.74,-1803.38C23622.81,-1802.51 23619.89,-1801.69 23617,-1800.95 23424.2,-1751.56 23191.71,-1737.33 23056.88,-1733.35"/>
<polygon fill="black" stroke="black" points="23056.63,-1729.84 23046.54,-1733.06 23056.44,-1736.84 23056.63,-1729.84"/>
</g>
<!-- layer2_expert7_12&#45;&gt;layer2_moe_agg_gpu7 -->
<g id="edge955" class="edge">
<title>layer2_expert7_12&#45;&gt;layer2_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23817.76,-1803.3C23814.82,-1802.45 23811.9,-1801.66 23809,-1800.95 23669.45,-1766.88 23257.46,-1745.25 23057.04,-1736.46"/>
<polygon fill="black" stroke="black" points="23056.92,-1732.95 23046.78,-1736.01 23056.61,-1739.94 23056.92,-1732.95"/>
</g>
<!-- layer2_expert7_13&#45;&gt;layer2_moe_agg_gpu7 -->
<g id="edge956" class="edge">
<title>layer2_expert7_13&#45;&gt;layer2_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M24009.77,-1803.24C24006.83,-1802.41 24003.9,-1801.64 24001,-1800.95 23824.28,-1759.16 23290.78,-1740.77 23056.91,-1734.56"/>
<polygon fill="black" stroke="black" points="23056.77,-1731.05 23046.68,-1734.29 23056.58,-1738.05 23056.77,-1731.05"/>
</g>
<!-- layer2_expert7_14&#45;&gt;layer2_moe_agg_gpu7 -->
<g id="edge957" class="edge">
<title>layer2_expert7_14&#45;&gt;layer2_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M24201.78,-1803.2C24198.84,-1802.38 24195.91,-1801.63 24193,-1800.95 23978.76,-1751.42 23321.56,-1737.07 23057.03,-1733.24"/>
<polygon fill="black" stroke="black" points="23056.69,-1729.73 23046.64,-1733.09 23056.59,-1736.73 23056.69,-1729.73"/>
</g>
<!-- layer2_expert7_15&#45;&gt;layer2_moe_agg_gpu7 -->
<g id="edge958" class="edge">
<title>layer2_expert7_15&#45;&gt;layer2_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M24393.79,-1803.17C24390.84,-1802.36 24387.91,-1801.62 24385,-1800.95 24132.87,-1743.63 23349.73,-1733.89 23056.95,-1732.27"/>
<polygon fill="black" stroke="black" points="23056.76,-1728.77 23046.75,-1732.21 23056.73,-1735.77 23056.76,-1728.77"/>
</g>
<!-- layer2_moe_agg_gpu7&#45;&gt;layer2_moe_allreduce -->
<g id="edge959" class="edge">
<title>layer2_moe_agg_gpu7&#45;&gt;layer2_moe_allreduce</title>
<path fill="none" stroke="black" d="M22843.37,-1728.66C21856.7,-1716.06 13986.54,-1615.62 12522.86,-1596.94"/>
<polygon fill="black" stroke="black" points="12522.8,-1593.44 12512.75,-1596.81 12522.71,-1600.44 12522.8,-1593.44"/>
</g>
<!-- layer2_output_gpu7 -->
<g id="node558" class="node">
<title>layer2_output_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="13328,-1488.95 13084,-1488.95 13084,-1420.95 13328,-1420.95 13328,-1488.95"/>
<text text-anchor="middle" x="13206" y="-1473.75" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU7</text>
<text text-anchor="middle" x="13206" y="-1458.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="13206" y="-1443.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="13206" y="-1428.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_qkv_gpu7 -->
<g id="node581" class="node">
<title>layer3_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="13305,-1384.95 13105,-1384.95 13105,-1286.95 13305,-1286.95 13305,-1384.95"/>
<text text-anchor="middle" x="13205" y="-1369.75" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU7</text>
<text text-anchor="middle" x="13205" y="-1354.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="13205" y="-1339.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="13205" y="-1324.75" font-family="Times,serif" font-size="14.00">Heads: 28&#45;31</text>
<text text-anchor="middle" x="13205" y="-1309.75" font-family="Times,serif" font-size="14.00">TP Slice: 7</text>
<text text-anchor="middle" x="13205" y="-1294.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_output_gpu7&#45;&gt;layer3_qkv_gpu7 -->
<g id="edge968" class="edge">
<title>layer2_output_gpu7&#45;&gt;layer3_qkv_gpu7</title>
<path fill="none" stroke="black" d="M13205.72,-1420.74C13205.65,-1412.78 13205.57,-1404.04 13205.5,-1395.3"/>
<polygon fill="black" stroke="black" points="13209,-1395.07 13205.41,-1385.1 13202,-1395.13 13209,-1395.07"/>
</g>
<!-- layer2_moe_allreduce&#45;&gt;layer2_output_gpu0 -->
<g id="edge687" class="edge">
<title>layer2_moe_allreduce&#45;&gt;layer2_output_gpu0</title>
<path fill="none" stroke="black" d="M12114.41,-1574.97C11956.93,-1558.28 11719.03,-1529.66 11504.17,-1489.11"/>
<polygon fill="black" stroke="black" points="11504.75,-1485.66 11494.28,-1487.23 11503.45,-1492.54 11504.75,-1485.66"/>
</g>
<!-- layer2_moe_allreduce&#45;&gt;layer2_output_gpu1 -->
<g id="edge726" class="edge">
<title>layer2_moe_allreduce&#45;&gt;layer2_output_gpu1</title>
<path fill="none" stroke="black" d="M12145.96,-1565.94C12042.96,-1546.71 11900.51,-1519.1 11766.38,-1489.23"/>
<polygon fill="black" stroke="black" points="11766.85,-1485.75 11756.33,-1486.99 11765.32,-1492.58 11766.85,-1485.75"/>
</g>
<!-- layer2_moe_allreduce&#45;&gt;layer2_output_gpu2 -->
<g id="edge765" class="edge">
<title>layer2_moe_allreduce&#45;&gt;layer2_output_gpu2</title>
<path fill="none" stroke="black" d="M12182.91,-1555.24C12126.5,-1535.72 12057.37,-1511.8 12001.11,-1492.33"/>
<polygon fill="black" stroke="black" points="12002.07,-1488.96 11991.48,-1488.99 11999.78,-1495.57 12002.07,-1488.96"/>
</g>
<!-- layer2_moe_allreduce&#45;&gt;layer2_output_gpu3 -->
<g id="edge804" class="edge">
<title>layer2_moe_allreduce&#45;&gt;layer2_output_gpu3</title>
<path fill="none" stroke="black" d="M12238.35,-1539.37C12224.62,-1525.12 12209.97,-1509.91 12197,-1496.44"/>
<polygon fill="black" stroke="black" points="12199.43,-1493.92 12189.97,-1489.15 12194.39,-1498.78 12199.43,-1493.92"/>
</g>
<!-- layer2_moe_allreduce&#45;&gt;layer2_output_gpu4 -->
<g id="edge843" class="edge">
<title>layer2_moe_allreduce&#45;&gt;layer2_output_gpu4</title>
<path fill="none" stroke="black" d="M12339.65,-1539.37C12353.38,-1525.12 12368.03,-1509.91 12381,-1496.44"/>
<polygon fill="black" stroke="black" points="12383.61,-1498.78 12388.03,-1489.15 12378.57,-1493.92 12383.61,-1498.78"/>
</g>
<!-- layer2_moe_allreduce&#45;&gt;layer2_output_gpu5 -->
<g id="edge882" class="edge">
<title>layer2_moe_allreduce&#45;&gt;layer2_output_gpu5</title>
<path fill="none" stroke="black" d="M12395.09,-1555.24C12451.5,-1535.72 12520.63,-1511.8 12576.89,-1492.33"/>
<polygon fill="black" stroke="black" points="12578.22,-1495.57 12586.52,-1488.99 12575.93,-1488.96 12578.22,-1495.57"/>
</g>
<!-- layer2_moe_allreduce&#45;&gt;layer2_output_gpu6 -->
<g id="edge921" class="edge">
<title>layer2_moe_allreduce&#45;&gt;layer2_output_gpu6</title>
<path fill="none" stroke="black" d="M12432.04,-1565.94C12535.04,-1546.71 12677.49,-1519.1 12811.62,-1489.23"/>
<polygon fill="black" stroke="black" points="12812.68,-1492.58 12821.67,-1486.99 12811.15,-1485.75 12812.68,-1492.58"/>
</g>
<!-- layer2_moe_allreduce&#45;&gt;layer2_output_gpu7 -->
<g id="edge960" class="edge">
<title>layer2_moe_allreduce&#45;&gt;layer2_output_gpu7</title>
<path fill="none" stroke="black" d="M12463.59,-1574.97C12621.07,-1558.28 12858.97,-1529.66 13073.83,-1489.11"/>
<polygon fill="black" stroke="black" points="13074.55,-1492.54 13083.72,-1487.23 13073.25,-1485.66 13074.55,-1492.54"/>
</g>
<!-- layer3_attn_gpu0 -->
<g id="node561" class="node">
<title>layer3_attn_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="11495.5,-1250.95 11252.5,-1250.95 11252.5,-1182.95 11495.5,-1182.95 11495.5,-1250.95"/>
<text text-anchor="middle" x="11374" y="-1235.75" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU0</text>
<text text-anchor="middle" x="11374" y="-1220.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11374" y="-1205.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11374" y="-1190.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_qkv_gpu0&#45;&gt;layer3_attn_gpu0 -->
<g id="edge969" class="edge">
<title>layer3_qkv_gpu0&#45;&gt;layer3_attn_gpu0</title>
<path fill="none" stroke="black" d="M11373.41,-1286.69C11373.48,-1278.28 11373.56,-1269.58 11373.63,-1261.31"/>
<polygon fill="black" stroke="black" points="11377.13,-1261.16 11373.72,-1251.13 11370.13,-1261.1 11377.13,-1261.16"/>
</g>
<!-- layer3_attn_proj_gpu0 -->
<g id="node562" class="node">
<title>layer3_attn_proj_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="11503,-1146.95 11303,-1146.95 11303,-1078.95 11503,-1078.95 11503,-1146.95"/>
<text text-anchor="middle" x="11403" y="-1131.75" font-family="Times,serif" font-size="14.00">L3_Attn_Projection_GPU0</text>
<text text-anchor="middle" x="11403" y="-1116.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11403" y="-1101.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11403" y="-1086.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_attn_gpu0&#45;&gt;layer3_attn_proj_gpu0 -->
<g id="edge970" class="edge">
<title>layer3_attn_gpu0&#45;&gt;layer3_attn_proj_gpu0</title>
<path fill="none" stroke="black" d="M11383.42,-1182.84C11385.75,-1174.64 11388.28,-1165.74 11390.72,-1157.15"/>
<polygon fill="black" stroke="black" points="11394.16,-1157.83 11393.53,-1147.25 11387.43,-1155.91 11394.16,-1157.83"/>
</g>
<!-- layer3_attn_allreduce -->
<g id="node584" class="node">
<title>layer3_attn_allreduce</title>
<polygon fill="lightcoral" stroke="black" points="12278,-1042.95 12041,-974.95 12278,-906.95 12515,-974.95 12278,-1042.95"/>
<text text-anchor="middle" x="12278" y="-993.75" font-family="Times,serif" font-size="14.00">L3_Attention_All&#45;Reduce</text>
<text text-anchor="middle" x="12278" y="-978.75" font-family="Times,serif" font-size="14.00">Input: 8×[1024,2048,512]</text>
<text text-anchor="middle" x="12278" y="-963.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12278" y="-948.75" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce across GPUs 0&#45;7</text>
</g>
<!-- layer3_attn_proj_gpu0&#45;&gt;layer3_attn_allreduce -->
<g id="edge971" class="edge">
<title>layer3_attn_proj_gpu0&#45;&gt;layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M11503.04,-1092.12C11526.91,-1087.59 11552.33,-1082.95 11576,-1078.95 11757.48,-1048.34 11966.26,-1018.38 12108.64,-998.73"/>
<polygon fill="black" stroke="black" points="12109.35,-1002.17 12118.78,-997.34 12108.39,-995.23 12109.35,-1002.17"/>
</g>
<!-- layer3_attn_gpu1 -->
<g id="node564" class="node">
<title>layer3_attn_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11757.5,-1250.95 11514.5,-1250.95 11514.5,-1182.95 11757.5,-1182.95 11757.5,-1250.95"/>
<text text-anchor="middle" x="11636" y="-1235.75" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU1</text>
<text text-anchor="middle" x="11636" y="-1220.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11636" y="-1205.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11636" y="-1190.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_qkv_gpu1&#45;&gt;layer3_attn_gpu1 -->
<g id="edge1008" class="edge">
<title>layer3_qkv_gpu1&#45;&gt;layer3_attn_gpu1</title>
<path fill="none" stroke="black" d="M11635.41,-1286.69C11635.48,-1278.28 11635.56,-1269.58 11635.63,-1261.31"/>
<polygon fill="black" stroke="black" points="11639.13,-1261.16 11635.72,-1251.13 11632.13,-1261.1 11639.13,-1261.16"/>
</g>
<!-- layer3_attn_proj_gpu1 -->
<g id="node565" class="node">
<title>layer3_attn_proj_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11785,-1146.95 11585,-1146.95 11585,-1078.95 11785,-1078.95 11785,-1146.95"/>
<text text-anchor="middle" x="11685" y="-1131.75" font-family="Times,serif" font-size="14.00">L3_Attn_Projection_GPU1</text>
<text text-anchor="middle" x="11685" y="-1116.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11685" y="-1101.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11685" y="-1086.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_attn_gpu1&#45;&gt;layer3_attn_proj_gpu1 -->
<g id="edge1009" class="edge">
<title>layer3_attn_gpu1&#45;&gt;layer3_attn_proj_gpu1</title>
<path fill="none" stroke="black" d="M11651.91,-1182.84C11655.97,-1174.37 11660.4,-1165.16 11664.65,-1156.31"/>
<polygon fill="black" stroke="black" points="11667.83,-1157.78 11669,-1147.25 11661.52,-1154.75 11667.83,-1157.78"/>
</g>
<!-- layer3_attn_proj_gpu1&#45;&gt;layer3_attn_allreduce -->
<g id="edge1010" class="edge">
<title>layer3_attn_proj_gpu1&#45;&gt;layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M11785.12,-1088.45C11798.85,-1085.24 11812.77,-1082.01 11826,-1078.95 11930.31,-1054.86 12048.25,-1028 12137.49,-1007.75"/>
<polygon fill="black" stroke="black" points="12138.43,-1011.13 12147.41,-1005.5 12136.88,-1004.3 12138.43,-1011.13"/>
</g>
<!-- layer3_attn_gpu2 -->
<g id="node567" class="node">
<title>layer3_attn_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="12018.5,-1250.95 11775.5,-1250.95 11775.5,-1182.95 12018.5,-1182.95 12018.5,-1250.95"/>
<text text-anchor="middle" x="11897" y="-1235.75" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU2</text>
<text text-anchor="middle" x="11897" y="-1220.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11897" y="-1205.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11897" y="-1190.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_qkv_gpu2&#45;&gt;layer3_attn_gpu2 -->
<g id="edge1047" class="edge">
<title>layer3_qkv_gpu2&#45;&gt;layer3_attn_gpu2</title>
<path fill="none" stroke="black" d="M11897,-1286.69C11897,-1278.28 11897,-1269.58 11897,-1261.31"/>
<polygon fill="black" stroke="black" points="11900.5,-1261.13 11897,-1251.13 11893.5,-1261.13 11900.5,-1261.13"/>
</g>
<!-- layer3_attn_proj_gpu2 -->
<g id="node568" class="node">
<title>layer3_attn_proj_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="12035,-1146.95 11835,-1146.95 11835,-1078.95 12035,-1078.95 12035,-1146.95"/>
<text text-anchor="middle" x="11935" y="-1131.75" font-family="Times,serif" font-size="14.00">L3_Attn_Projection_GPU2</text>
<text text-anchor="middle" x="11935" y="-1116.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11935" y="-1101.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11935" y="-1086.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_attn_gpu2&#45;&gt;layer3_attn_proj_gpu2 -->
<g id="edge1048" class="edge">
<title>layer3_attn_gpu2&#45;&gt;layer3_attn_proj_gpu2</title>
<path fill="none" stroke="black" d="M11909.34,-1182.84C11912.42,-1174.55 11915.78,-1165.55 11919.01,-1156.86"/>
<polygon fill="black" stroke="black" points="11922.38,-1157.85 11922.59,-1147.25 11915.82,-1155.4 11922.38,-1157.85"/>
</g>
<!-- layer3_attn_proj_gpu2&#45;&gt;layer3_attn_allreduce -->
<g id="edge1049" class="edge">
<title>layer3_attn_proj_gpu2&#45;&gt;layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M12018.47,-1078.86C12064.2,-1060.72 12121.4,-1038.05 12170.45,-1018.6"/>
<polygon fill="black" stroke="black" points="12171.82,-1021.82 12179.82,-1014.88 12169.24,-1015.31 12171.82,-1021.82"/>
</g>
<!-- layer3_attn_gpu3 -->
<g id="node570" class="node">
<title>layer3_attn_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="12279.5,-1250.95 12036.5,-1250.95 12036.5,-1182.95 12279.5,-1182.95 12279.5,-1250.95"/>
<text text-anchor="middle" x="12158" y="-1235.75" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU3</text>
<text text-anchor="middle" x="12158" y="-1220.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12158" y="-1205.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12158" y="-1190.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_qkv_gpu3&#45;&gt;layer3_attn_gpu3 -->
<g id="edge1086" class="edge">
<title>layer3_qkv_gpu3&#45;&gt;layer3_attn_gpu3</title>
<path fill="none" stroke="black" d="M12158,-1286.69C12158,-1278.28 12158,-1269.58 12158,-1261.31"/>
<polygon fill="black" stroke="black" points="12161.5,-1261.13 12158,-1251.13 12154.5,-1261.13 12161.5,-1261.13"/>
</g>
<!-- layer3_attn_proj_gpu3 -->
<g id="node571" class="node">
<title>layer3_attn_proj_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="12269,-1146.95 12069,-1146.95 12069,-1078.95 12269,-1078.95 12269,-1146.95"/>
<text text-anchor="middle" x="12169" y="-1131.75" font-family="Times,serif" font-size="14.00">L3_Attn_Projection_GPU3</text>
<text text-anchor="middle" x="12169" y="-1116.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12169" y="-1101.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12169" y="-1086.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_attn_gpu3&#45;&gt;layer3_attn_proj_gpu3 -->
<g id="edge1087" class="edge">
<title>layer3_attn_gpu3&#45;&gt;layer3_attn_proj_gpu3</title>
<path fill="none" stroke="black" d="M12161.57,-1182.84C12162.45,-1174.73 12163.39,-1165.94 12164.31,-1157.43"/>
<polygon fill="black" stroke="black" points="12167.82,-1157.57 12165.41,-1147.25 12160.86,-1156.82 12167.82,-1157.57"/>
</g>
<!-- layer3_attn_proj_gpu3&#45;&gt;layer3_attn_allreduce -->
<g id="edge1088" class="edge">
<title>layer3_attn_proj_gpu3&#45;&gt;layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M12195.66,-1078.68C12205.36,-1066.59 12216.66,-1052.49 12227.73,-1038.68"/>
<polygon fill="black" stroke="black" points="12230.68,-1040.59 12234.2,-1030.6 12225.22,-1036.22 12230.68,-1040.59"/>
</g>
<!-- layer3_attn_gpu4 -->
<g id="node573" class="node">
<title>layer3_attn_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="12540.5,-1250.95 12297.5,-1250.95 12297.5,-1182.95 12540.5,-1182.95 12540.5,-1250.95"/>
<text text-anchor="middle" x="12419" y="-1235.75" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU4</text>
<text text-anchor="middle" x="12419" y="-1220.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12419" y="-1205.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12419" y="-1190.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_qkv_gpu4&#45;&gt;layer3_attn_gpu4 -->
<g id="edge1125" class="edge">
<title>layer3_qkv_gpu4&#45;&gt;layer3_attn_gpu4</title>
<path fill="none" stroke="black" d="M12419,-1286.69C12419,-1278.28 12419,-1269.58 12419,-1261.31"/>
<polygon fill="black" stroke="black" points="12422.5,-1261.13 12419,-1251.13 12415.5,-1261.13 12422.5,-1261.13"/>
</g>
<!-- layer3_attn_proj_gpu4 -->
<g id="node574" class="node">
<title>layer3_attn_proj_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="12508,-1146.95 12308,-1146.95 12308,-1078.95 12508,-1078.95 12508,-1146.95"/>
<text text-anchor="middle" x="12408" y="-1131.75" font-family="Times,serif" font-size="14.00">L3_Attn_Projection_GPU4</text>
<text text-anchor="middle" x="12408" y="-1116.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12408" y="-1101.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12408" y="-1086.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_attn_gpu4&#45;&gt;layer3_attn_proj_gpu4 -->
<g id="edge1126" class="edge">
<title>layer3_attn_gpu4&#45;&gt;layer3_attn_proj_gpu4</title>
<path fill="none" stroke="black" d="M12415.43,-1182.84C12414.55,-1174.73 12413.61,-1165.94 12412.69,-1157.43"/>
<polygon fill="black" stroke="black" points="12416.14,-1156.82 12411.59,-1147.25 12409.18,-1157.57 12416.14,-1156.82"/>
</g>
<!-- layer3_attn_proj_gpu4&#45;&gt;layer3_attn_allreduce -->
<g id="edge1127" class="edge">
<title>layer3_attn_proj_gpu4&#45;&gt;layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M12376.2,-1078.68C12363.97,-1065.89 12349.6,-1050.86 12335.69,-1036.3"/>
<polygon fill="black" stroke="black" points="12337.91,-1033.56 12328.47,-1028.75 12332.85,-1038.4 12337.91,-1033.56"/>
</g>
<!-- layer3_attn_gpu5 -->
<g id="node576" class="node">
<title>layer3_attn_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12802.5,-1250.95 12559.5,-1250.95 12559.5,-1182.95 12802.5,-1182.95 12802.5,-1250.95"/>
<text text-anchor="middle" x="12681" y="-1235.75" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU5</text>
<text text-anchor="middle" x="12681" y="-1220.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12681" y="-1205.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12681" y="-1190.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_qkv_gpu5&#45;&gt;layer3_attn_gpu5 -->
<g id="edge1164" class="edge">
<title>layer3_qkv_gpu5&#45;&gt;layer3_attn_gpu5</title>
<path fill="none" stroke="black" d="M12681,-1286.69C12681,-1278.28 12681,-1269.58 12681,-1261.31"/>
<polygon fill="black" stroke="black" points="12684.5,-1261.13 12681,-1251.13 12677.5,-1261.13 12684.5,-1261.13"/>
</g>
<!-- layer3_attn_proj_gpu5 -->
<g id="node577" class="node">
<title>layer3_attn_proj_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12758,-1146.95 12558,-1146.95 12558,-1078.95 12758,-1078.95 12758,-1146.95"/>
<text text-anchor="middle" x="12658" y="-1131.75" font-family="Times,serif" font-size="14.00">L3_Attn_Projection_GPU5</text>
<text text-anchor="middle" x="12658" y="-1116.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12658" y="-1101.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12658" y="-1086.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_attn_gpu5&#45;&gt;layer3_attn_proj_gpu5 -->
<g id="edge1165" class="edge">
<title>layer3_attn_gpu5&#45;&gt;layer3_attn_proj_gpu5</title>
<path fill="none" stroke="black" d="M12673.53,-1182.84C12671.68,-1174.64 12669.68,-1165.74 12667.74,-1157.15"/>
<polygon fill="black" stroke="black" points="12671.12,-1156.24 12665.51,-1147.25 12664.29,-1157.78 12671.12,-1156.24"/>
</g>
<!-- layer3_attn_proj_gpu5&#45;&gt;layer3_attn_allreduce -->
<g id="edge1166" class="edge">
<title>layer3_attn_proj_gpu5&#45;&gt;layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M12565.53,-1078.86C12513.09,-1060.09 12447.05,-1036.46 12391.5,-1016.57"/>
<polygon fill="black" stroke="black" points="12392.56,-1013.24 12381.96,-1013.16 12390.2,-1019.83 12392.56,-1013.24"/>
</g>
<!-- layer3_attn_gpu6 -->
<g id="node579" class="node">
<title>layer3_attn_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="13064.5,-1250.95 12821.5,-1250.95 12821.5,-1182.95 13064.5,-1182.95 13064.5,-1250.95"/>
<text text-anchor="middle" x="12943" y="-1235.75" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU6</text>
<text text-anchor="middle" x="12943" y="-1220.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12943" y="-1205.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12943" y="-1190.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_qkv_gpu6&#45;&gt;layer3_attn_gpu6 -->
<g id="edge1203" class="edge">
<title>layer3_qkv_gpu6&#45;&gt;layer3_attn_gpu6</title>
<path fill="none" stroke="black" d="M12943,-1286.69C12943,-1278.28 12943,-1269.58 12943,-1261.31"/>
<polygon fill="black" stroke="black" points="12946.5,-1261.13 12943,-1251.13 12939.5,-1261.13 12946.5,-1261.13"/>
</g>
<!-- layer3_attn_proj_gpu6 -->
<g id="node580" class="node">
<title>layer3_attn_proj_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="13014,-1146.95 12814,-1146.95 12814,-1078.95 13014,-1078.95 13014,-1146.95"/>
<text text-anchor="middle" x="12914" y="-1131.75" font-family="Times,serif" font-size="14.00">L3_Attn_Projection_GPU6</text>
<text text-anchor="middle" x="12914" y="-1116.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12914" y="-1101.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12914" y="-1086.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_attn_gpu6&#45;&gt;layer3_attn_proj_gpu6 -->
<g id="edge1204" class="edge">
<title>layer3_attn_gpu6&#45;&gt;layer3_attn_proj_gpu6</title>
<path fill="none" stroke="black" d="M12933.58,-1182.84C12931.25,-1174.64 12928.72,-1165.74 12926.28,-1157.15"/>
<polygon fill="black" stroke="black" points="12929.57,-1155.91 12923.47,-1147.25 12922.84,-1157.83 12929.57,-1155.91"/>
</g>
<!-- layer3_attn_proj_gpu6&#45;&gt;layer3_attn_allreduce -->
<g id="edge1205" class="edge">
<title>layer3_attn_proj_gpu6&#45;&gt;layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M12813.61,-1089.23C12798.02,-1085.76 12782.08,-1082.23 12767,-1078.95 12651.74,-1053.88 12520.99,-1026.39 12423.7,-1006.12"/>
<polygon fill="black" stroke="black" points="12424.3,-1002.67 12413.8,-1004.05 12422.88,-1009.52 12424.3,-1002.67"/>
</g>
<!-- layer3_attn_gpu7 -->
<g id="node582" class="node">
<title>layer3_attn_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="13326.5,-1250.95 13083.5,-1250.95 13083.5,-1182.95 13326.5,-1182.95 13326.5,-1250.95"/>
<text text-anchor="middle" x="13205" y="-1235.75" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU7</text>
<text text-anchor="middle" x="13205" y="-1220.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="13205" y="-1205.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="13205" y="-1190.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_qkv_gpu7&#45;&gt;layer3_attn_gpu7 -->
<g id="edge1242" class="edge">
<title>layer3_qkv_gpu7&#45;&gt;layer3_attn_gpu7</title>
<path fill="none" stroke="black" d="M13205,-1286.69C13205,-1278.28 13205,-1269.58 13205,-1261.31"/>
<polygon fill="black" stroke="black" points="13208.5,-1261.13 13205,-1251.13 13201.5,-1261.13 13208.5,-1261.13"/>
</g>
<!-- layer3_attn_proj_gpu7 -->
<g id="node583" class="node">
<title>layer3_attn_proj_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="13272,-1146.95 13072,-1146.95 13072,-1078.95 13272,-1078.95 13272,-1146.95"/>
<text text-anchor="middle" x="13172" y="-1131.75" font-family="Times,serif" font-size="14.00">L3_Attn_Projection_GPU7</text>
<text text-anchor="middle" x="13172" y="-1116.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="13172" y="-1101.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="13172" y="-1086.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_attn_gpu7&#45;&gt;layer3_attn_proj_gpu7 -->
<g id="edge1243" class="edge">
<title>layer3_attn_gpu7&#45;&gt;layer3_attn_proj_gpu7</title>
<path fill="none" stroke="black" d="M13194.29,-1182.84C13191.61,-1174.55 13188.69,-1165.55 13185.88,-1156.86"/>
<polygon fill="black" stroke="black" points="13189.18,-1155.69 13182.77,-1147.25 13182.52,-1157.84 13189.18,-1155.69"/>
</g>
<!-- layer3_attn_proj_gpu7&#45;&gt;layer3_attn_allreduce -->
<g id="edge1244" class="edge">
<title>layer3_attn_proj_gpu7&#45;&gt;layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M13071.64,-1088.57C13055.42,-1085.12 13038.78,-1081.79 13023,-1078.95 12829.85,-1044.27 12606.7,-1014.81 12455.36,-996.39"/>
<polygon fill="black" stroke="black" points="12455.39,-992.87 12445.05,-995.14 12454.55,-999.82 12455.39,-992.87"/>
</g>
<!-- layer3_attn_norm_gpu0 -->
<g id="node585" class="node">
<title>layer3_attn_norm_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="4555,-870.95 4311,-870.95 4311,-802.95 4555,-802.95 4555,-870.95"/>
<text text-anchor="middle" x="4433" y="-855.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU0</text>
<text text-anchor="middle" x="4433" y="-840.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="4433" y="-825.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="4433" y="-810.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer3_attn_allreduce&#45;&gt;layer3_attn_norm_gpu0 -->
<g id="edge972" class="edge">
<title>layer3_attn_allreduce&#45;&gt;layer3_attn_norm_gpu0</title>
<path fill="none" stroke="black" d="M12055.53,-970.74C11242.07,-958.89 8352.22,-916.01 5969,-870.95 5449.65,-861.14 4831.58,-847.16 4565.53,-841.03"/>
<polygon fill="black" stroke="black" points="4565.52,-837.53 4555.45,-840.8 4565.36,-844.53 4565.52,-837.53"/>
</g>
<!-- layer3_attn_norm_gpu1 -->
<g id="node586" class="node">
<title>layer3_attn_norm_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="6222,-870.95 5978,-870.95 5978,-802.95 6222,-802.95 6222,-870.95"/>
<text text-anchor="middle" x="6100" y="-855.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU1</text>
<text text-anchor="middle" x="6100" y="-840.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="6100" y="-825.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="6100" y="-810.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer3_attn_allreduce&#45;&gt;layer3_attn_norm_gpu1 -->
<g id="edge1011" class="edge">
<title>layer3_attn_allreduce&#45;&gt;layer3_attn_norm_gpu1</title>
<path fill="none" stroke="black" d="M12060.84,-969.17C11073.04,-947.43 7018.32,-858.17 6232.31,-840.87"/>
<polygon fill="black" stroke="black" points="6232.17,-837.36 6222.1,-840.64 6232.02,-844.36 6232.17,-837.36"/>
</g>
<!-- layer3_attn_norm_gpu2 -->
<g id="node587" class="node">
<title>layer3_attn_norm_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="9294,-870.95 9050,-870.95 9050,-802.95 9294,-802.95 9294,-870.95"/>
<text text-anchor="middle" x="9172" y="-855.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU2</text>
<text text-anchor="middle" x="9172" y="-840.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="9172" y="-825.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="9172" y="-810.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer3_attn_allreduce&#45;&gt;layer3_attn_norm_gpu2 -->
<g id="edge1050" class="edge">
<title>layer3_attn_allreduce&#45;&gt;layer3_attn_norm_gpu2</title>
<path fill="none" stroke="black" d="M12075.11,-965.07C11486.85,-939.31 9791.48,-865.08 9304.35,-843.75"/>
<polygon fill="black" stroke="black" points="9304.26,-840.24 9294.11,-843.3 9303.95,-847.23 9304.26,-840.24"/>
</g>
<!-- layer3_attn_norm_gpu3 -->
<g id="node588" class="node">
<title>layer3_attn_norm_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="11615,-870.95 11371,-870.95 11371,-802.95 11615,-802.95 11615,-870.95"/>
<text text-anchor="middle" x="11493" y="-855.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU3</text>
<text text-anchor="middle" x="11493" y="-840.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11493" y="-825.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11493" y="-810.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer3_attn_allreduce&#45;&gt;layer3_attn_norm_gpu3 -->
<g id="edge1089" class="edge">
<title>layer3_attn_allreduce&#45;&gt;layer3_attn_norm_gpu3</title>
<path fill="none" stroke="black" d="M12132.19,-948.69C11986.81,-923.5 11765.5,-885.16 11625.13,-860.84"/>
<polygon fill="black" stroke="black" points="11625.61,-857.38 11615.16,-859.12 11624.42,-864.27 11625.61,-857.38"/>
</g>
<!-- layer3_attn_norm_gpu4 -->
<g id="node589" class="node">
<title>layer3_attn_norm_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13186,-870.95 12942,-870.95 12942,-802.95 13186,-802.95 13186,-870.95"/>
<text text-anchor="middle" x="13064" y="-855.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU4</text>
<text text-anchor="middle" x="13064" y="-840.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="13064" y="-825.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="13064" y="-810.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer3_attn_allreduce&#45;&gt;layer3_attn_norm_gpu4 -->
<g id="edge1128" class="edge">
<title>layer3_attn_allreduce&#45;&gt;layer3_attn_norm_gpu4</title>
<path fill="none" stroke="black" d="M12424,-948.69C12569.67,-923.49 12791.49,-885.11 12932.02,-860.79"/>
<polygon fill="black" stroke="black" points="12932.74,-864.22 12942,-859.06 12931.55,-857.32 12932.74,-864.22"/>
</g>
<!-- layer3_attn_norm_gpu5 -->
<g id="node590" class="node">
<title>layer3_attn_norm_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="15507,-870.95 15263,-870.95 15263,-802.95 15507,-802.95 15507,-870.95"/>
<text text-anchor="middle" x="15385" y="-855.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU5</text>
<text text-anchor="middle" x="15385" y="-840.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="15385" y="-825.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="15385" y="-810.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer3_attn_allreduce&#45;&gt;layer3_attn_norm_gpu5 -->
<g id="edge1167" class="edge">
<title>layer3_attn_allreduce&#45;&gt;layer3_attn_norm_gpu5</title>
<path fill="none" stroke="black" d="M12480.66,-965.08C13068.81,-939.34 14765.15,-865.09 15252.57,-843.75"/>
<polygon fill="black" stroke="black" points="15252.98,-847.24 15262.81,-843.3 15252.67,-840.24 15252.98,-847.24"/>
</g>
<!-- layer3_attn_norm_gpu6 -->
<g id="node591" class="node">
<title>layer3_attn_norm_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="18204,-870.95 17960,-870.95 17960,-802.95 18204,-802.95 18204,-870.95"/>
<text text-anchor="middle" x="18082" y="-855.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU6</text>
<text text-anchor="middle" x="18082" y="-840.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="18082" y="-825.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="18082" y="-810.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer3_attn_allreduce&#45;&gt;layer3_attn_norm_gpu6 -->
<g id="edge1206" class="edge">
<title>layer3_attn_allreduce&#45;&gt;layer3_attn_norm_gpu6</title>
<path fill="none" stroke="black" d="M12494.06,-968.89C13439.19,-946.74 17196.18,-858.71 17949.92,-841.05"/>
<polygon fill="black" stroke="black" points="17950.08,-844.55 17959.99,-840.81 17949.91,-837.55 17950.08,-844.55"/>
</g>
<!-- layer3_attn_norm_gpu7 -->
<g id="node592" class="node">
<title>layer3_attn_norm_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="21088,-870.95 20844,-870.95 20844,-802.95 21088,-802.95 21088,-870.95"/>
<text text-anchor="middle" x="20966" y="-855.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU7</text>
<text text-anchor="middle" x="20966" y="-840.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="20966" y="-825.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="20966" y="-810.75" font-family="Times,serif" font-size="14.00">Replicated across GPUs 0&#45;7</text>
</g>
<!-- layer3_attn_allreduce&#45;&gt;layer3_attn_norm_gpu7 -->
<g id="edge1245" class="edge">
<title>layer3_attn_allreduce&#45;&gt;layer3_attn_norm_gpu7</title>
<path fill="none" stroke="black" d="M12499.57,-970.48C13745.18,-950.99 19854.65,-855.35 20833.57,-840.03"/>
<polygon fill="black" stroke="black" points="20833.86,-843.52 20843.81,-839.87 20833.75,-836.52 20833.86,-843.52"/>
</g>
<!-- layer3_gate_gpu0 -->
<g id="node593" class="node">
<title>layer3_gate_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1745,-766.95 1501,-766.95 1501,-683.95 1745,-683.95 1745,-766.95"/>
<text text-anchor="middle" x="1623" y="-751.75" font-family="Times,serif" font-size="14.00">L3_Gate_GPU0</text>
<text text-anchor="middle" x="1623" y="-736.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="1623" y="-721.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="1623" y="-706.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="1623" y="-691.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_attn_norm_gpu0&#45;&gt;layer3_gate_gpu0 -->
<g id="edge973" class="edge">
<title>layer3_attn_norm_gpu0&#45;&gt;layer3_gate_gpu0</title>
<path fill="none" stroke="black" d="M4310.9,-831.2C3851.75,-813.3 2230.64,-750.13 1755.07,-731.6"/>
<polygon fill="black" stroke="black" points="1755.2,-728.1 1745.07,-731.21 1754.93,-735.1 1755.2,-728.1"/>
</g>
<!-- layer3_gate_gpu1 -->
<g id="node612" class="node">
<title>layer3_gate_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="4817,-766.95 4573,-766.95 4573,-683.95 4817,-683.95 4817,-766.95"/>
<text text-anchor="middle" x="4695" y="-751.75" font-family="Times,serif" font-size="14.00">L3_Gate_GPU1</text>
<text text-anchor="middle" x="4695" y="-736.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="4695" y="-721.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="4695" y="-706.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="4695" y="-691.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_attn_norm_gpu1&#45;&gt;layer3_gate_gpu1 -->
<g id="edge1012" class="edge">
<title>layer3_attn_norm_gpu1&#45;&gt;layer3_gate_gpu1</title>
<path fill="none" stroke="black" d="M5977.77,-826.43C5715.18,-805.96 5099.03,-757.94 4827.5,-736.78"/>
<polygon fill="black" stroke="black" points="4827.43,-733.26 4817.19,-735.98 4826.89,-740.24 4827.43,-733.26"/>
</g>
<!-- layer3_gate_gpu2 -->
<g id="node631" class="node">
<title>layer3_gate_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="7889,-766.95 7645,-766.95 7645,-683.95 7889,-683.95 7889,-766.95"/>
<text text-anchor="middle" x="7767" y="-751.75" font-family="Times,serif" font-size="14.00">L3_Gate_GPU2</text>
<text text-anchor="middle" x="7767" y="-736.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="7767" y="-721.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="7767" y="-706.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="7767" y="-691.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_attn_norm_gpu2&#45;&gt;layer3_gate_gpu2 -->
<g id="edge1051" class="edge">
<title>layer3_attn_norm_gpu2&#45;&gt;layer3_gate_gpu2</title>
<path fill="none" stroke="black" d="M9049.77,-826.43C8787.18,-805.96 8171.03,-757.94 7899.5,-736.78"/>
<polygon fill="black" stroke="black" points="7899.43,-733.26 7889.19,-735.98 7898.89,-740.24 7899.43,-733.26"/>
</g>
<!-- layer3_gate_gpu3 -->
<g id="node650" class="node">
<title>layer3_gate_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="10961,-766.95 10717,-766.95 10717,-683.95 10961,-683.95 10961,-766.95"/>
<text text-anchor="middle" x="10839" y="-751.75" font-family="Times,serif" font-size="14.00">L3_Gate_GPU3</text>
<text text-anchor="middle" x="10839" y="-736.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="10839" y="-721.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="10839" y="-706.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="10839" y="-691.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_attn_norm_gpu3&#45;&gt;layer3_gate_gpu3 -->
<g id="edge1090" class="edge">
<title>layer3_attn_norm_gpu3&#45;&gt;layer3_gate_gpu3</title>
<path fill="none" stroke="black" d="M11370.75,-815.49C11257.06,-796.45 11088.09,-768.16 10971.28,-748.6"/>
<polygon fill="black" stroke="black" points="10971.64,-745.11 10961.2,-746.91 10970.48,-752.02 10971.64,-745.11"/>
</g>
<!-- layer3_gate_gpu4 -->
<g id="node669" class="node">
<title>layer3_gate_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13841,-766.95 13597,-766.95 13597,-683.95 13841,-683.95 13841,-766.95"/>
<text text-anchor="middle" x="13719" y="-751.75" font-family="Times,serif" font-size="14.00">L3_Gate_GPU4</text>
<text text-anchor="middle" x="13719" y="-736.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="13719" y="-721.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="13719" y="-706.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="13719" y="-691.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_attn_norm_gpu4&#45;&gt;layer3_gate_gpu4 -->
<g id="edge1129" class="edge">
<title>layer3_attn_norm_gpu4&#45;&gt;layer3_gate_gpu4</title>
<path fill="none" stroke="black" d="M13186.05,-815.55C13299.96,-796.51 13469.51,-768.16 13586.64,-748.58"/>
<polygon fill="black" stroke="black" points="13587.46,-751.99 13596.74,-746.89 13586.3,-745.09 13587.46,-751.99"/>
</g>
<!-- layer3_gate_gpu5 -->
<g id="node688" class="node">
<title>layer3_gate_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="16913,-766.95 16669,-766.95 16669,-683.95 16913,-683.95 16913,-766.95"/>
<text text-anchor="middle" x="16791" y="-751.75" font-family="Times,serif" font-size="14.00">L3_Gate_GPU5</text>
<text text-anchor="middle" x="16791" y="-736.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="16791" y="-721.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="16791" y="-706.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="16791" y="-691.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_attn_norm_gpu5&#45;&gt;layer3_gate_gpu5 -->
<g id="edge1168" class="edge">
<title>layer3_attn_norm_gpu5&#45;&gt;layer3_gate_gpu5</title>
<path fill="none" stroke="black" d="M15507.01,-826.45C15769.67,-805.99 16386.85,-757.93 16658.59,-736.77"/>
<polygon fill="black" stroke="black" points="16659.2,-740.23 16668.9,-735.96 16658.66,-733.25 16659.2,-740.23"/>
</g>
<!-- layer3_gate_gpu6 -->
<g id="node707" class="node">
<title>layer3_gate_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="19985,-766.95 19741,-766.95 19741,-683.95 19985,-683.95 19985,-766.95"/>
<text text-anchor="middle" x="19863" y="-751.75" font-family="Times,serif" font-size="14.00">L3_Gate_GPU6</text>
<text text-anchor="middle" x="19863" y="-736.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="19863" y="-721.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="19863" y="-706.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="19863" y="-691.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_attn_norm_gpu6&#45;&gt;layer3_gate_gpu6 -->
<g id="edge1207" class="edge">
<title>layer3_attn_norm_gpu6&#45;&gt;layer3_gate_gpu6</title>
<path fill="none" stroke="black" d="M18204.06,-828.45C18526.17,-808.64 19397.18,-755.09 19730.65,-734.59"/>
<polygon fill="black" stroke="black" points="19731.07,-738.07 19740.84,-733.96 19730.65,-731.08 19731.07,-738.07"/>
</g>
<!-- layer3_gate_gpu7 -->
<g id="node726" class="node">
<title>layer3_gate_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="23057,-766.95 22813,-766.95 22813,-683.95 23057,-683.95 23057,-766.95"/>
<text text-anchor="middle" x="22935" y="-751.75" font-family="Times,serif" font-size="14.00">L3_Gate_GPU7</text>
<text text-anchor="middle" x="22935" y="-736.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="22935" y="-721.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="22935" y="-706.75" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="22935" y="-691.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_attn_norm_gpu7&#45;&gt;layer3_gate_gpu7 -->
<g id="edge1246" class="edge">
<title>layer3_attn_norm_gpu7&#45;&gt;layer3_gate_gpu7</title>
<path fill="none" stroke="black" d="M21088.05,-829.17C21437.71,-809.72 22441.14,-753.92 22802.94,-733.8"/>
<polygon fill="black" stroke="black" points="22803.15,-737.29 22812.94,-733.24 22802.76,-730.3 22803.15,-737.29"/>
</g>
<!-- layer3_expert0_0 -->
<g id="node594" class="node">
<title>layer3_expert0_0</title>
<polygon fill="lightgreen" stroke="black" points="174,-647.95 0,-647.95 0,-564.95 174,-564.95 174,-647.95"/>
<text text-anchor="middle" x="87" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU0</text>
<text text-anchor="middle" x="87" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="87" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="87" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="87" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_gate_gpu0&#45;&gt;layer3_expert0_0 -->
<g id="edge974" class="edge">
<title>layer3_gate_gpu0&#45;&gt;layer3_expert0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1500.8,-723.37C1204.21,-719.87 451.59,-705.65 184.29,-647.96"/>
<polygon fill="black" stroke="black" points="184.74,-644.48 174.22,-645.71 183.22,-651.31 184.74,-644.48"/>
</g>
<!-- layer3_expert0_1 -->
<g id="node595" class="node">
<title>layer3_expert0_1</title>
<polygon fill="lightgreen" stroke="black" points="366,-647.95 192,-647.95 192,-564.95 366,-564.95 366,-647.95"/>
<text text-anchor="middle" x="279" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU0</text>
<text text-anchor="middle" x="279" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="279" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="279" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="279" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_gate_gpu0&#45;&gt;layer3_expert0_1 -->
<g id="edge975" class="edge">
<title>layer3_gate_gpu0&#45;&gt;layer3_expert0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1500.82,-722.19C1233.95,-716.43 605.25,-698.07 376.17,-647.94"/>
<polygon fill="black" stroke="black" points="376.75,-644.48 366.22,-645.68 375.2,-651.31 376.75,-644.48"/>
</g>
<!-- layer3_expert0_2 -->
<g id="node596" class="node">
<title>layer3_expert0_2</title>
<polygon fill="lightgreen" stroke="black" points="558,-647.95 384,-647.95 384,-564.95 558,-564.95 558,-647.95"/>
<text text-anchor="middle" x="471" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU0</text>
<text text-anchor="middle" x="471" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="471" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="471" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="471" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_gate_gpu0&#45;&gt;layer3_expert0_2 -->
<g id="edge976" class="edge">
<title>layer3_gate_gpu0&#45;&gt;layer3_expert0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1500.92,-720.61C1266.28,-712.41 759.38,-690.58 568.19,-647.95"/>
<polygon fill="black" stroke="black" points="568.77,-644.49 558.23,-645.64 567.19,-651.31 568.77,-644.49"/>
</g>
<!-- layer3_expert0_3 -->
<g id="node597" class="node">
<title>layer3_expert0_3</title>
<polygon fill="lightgreen" stroke="black" points="750,-647.95 576,-647.95 576,-564.95 750,-564.95 750,-647.95"/>
<text text-anchor="middle" x="663" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU0</text>
<text text-anchor="middle" x="663" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="663" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="663" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="663" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_gate_gpu0&#45;&gt;layer3_expert0_3 -->
<g id="edge977" class="edge">
<title>layer3_gate_gpu0&#45;&gt;layer3_expert0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1500.77,-718.32C1301.25,-707.53 913.31,-683.15 760,-647.92"/>
<polygon fill="black" stroke="black" points="760.79,-644.5 750.25,-645.58 759.16,-651.31 760.79,-644.5"/>
</g>
<!-- layer3_expert0_4 -->
<g id="node598" class="node">
<title>layer3_expert0_4</title>
<polygon fill="lightgreen" stroke="black" points="942,-647.95 768,-647.95 768,-564.95 942,-564.95 942,-647.95"/>
<text text-anchor="middle" x="855" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU0</text>
<text text-anchor="middle" x="855" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="855" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="855" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="855" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_gate_gpu0&#45;&gt;layer3_expert0_4 -->
<g id="edge978" class="edge">
<title>layer3_gate_gpu0&#45;&gt;layer3_expert0_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1500.91,-721C1367.03,-714.86 1146.46,-697.79 951.84,-647.96"/>
<polygon fill="black" stroke="black" points="952.57,-644.53 942.01,-645.4 950.81,-651.3 952.57,-644.53"/>
</g>
<!-- layer3_expert0_5 -->
<g id="node599" class="node">
<title>layer3_expert0_5</title>
<polygon fill="lightgreen" stroke="black" points="1134,-647.95 960,-647.95 960,-564.95 1134,-564.95 1134,-647.95"/>
<text text-anchor="middle" x="1047" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU0</text>
<text text-anchor="middle" x="1047" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1047" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1047" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1047" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_gate_gpu0&#45;&gt;layer3_expert0_5 -->
<g id="edge979" class="edge">
<title>layer3_gate_gpu0&#45;&gt;layer3_expert0_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1500.91,-713.21C1405.32,-702.51 1269.37,-683.09 1143.84,-648"/>
<polygon fill="black" stroke="black" points="1144.63,-644.59 1134.06,-645.23 1142.72,-651.32 1144.63,-644.59"/>
</g>
<!-- layer3_expert0_6 -->
<g id="node600" class="node">
<title>layer3_expert0_6</title>
<polygon fill="lightgreen" stroke="black" points="1326,-647.95 1152,-647.95 1152,-564.95 1326,-564.95 1326,-647.95"/>
<text text-anchor="middle" x="1239" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU0</text>
<text text-anchor="middle" x="1239" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1239" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1239" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1239" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_gate_gpu0&#45;&gt;layer3_expert0_6 -->
<g id="edge980" class="edge">
<title>layer3_gate_gpu0&#45;&gt;layer3_expert0_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1500.66,-695.97C1451.66,-683.59 1394.72,-667.96 1335.67,-648.07"/>
<polygon fill="black" stroke="black" points="1336.77,-644.75 1326.18,-644.84 1334.52,-651.37 1336.77,-644.75"/>
</g>
<!-- layer3_expert0_7 -->
<g id="node601" class="node">
<title>layer3_expert0_7</title>
<polygon fill="lightgreen" stroke="black" points="1518,-647.95 1344,-647.95 1344,-564.95 1518,-564.95 1518,-647.95"/>
<text text-anchor="middle" x="1431" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU0</text>
<text text-anchor="middle" x="1431" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1431" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1431" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1431" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_gate_gpu0&#45;&gt;layer3_expert0_7 -->
<g id="edge981" class="edge">
<title>layer3_gate_gpu0&#45;&gt;layer3_expert0_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1556.39,-683.86C1540.15,-673.97 1522.68,-663.32 1506.08,-653.21"/>
<polygon fill="black" stroke="black" points="1507.86,-650.19 1497.5,-647.97 1504.21,-656.17 1507.86,-650.19"/>
</g>
<!-- layer3_expert0_8 -->
<g id="node602" class="node">
<title>layer3_expert0_8</title>
<polygon fill="lightgreen" stroke="black" points="1710,-647.95 1536,-647.95 1536,-564.95 1710,-564.95 1710,-647.95"/>
<text text-anchor="middle" x="1623" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU0</text>
<text text-anchor="middle" x="1623" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1623" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1623" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1623" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_gate_gpu0&#45;&gt;layer3_expert0_8 -->
<g id="edge982" class="edge">
<title>layer3_gate_gpu0&#45;&gt;layer3_expert0_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1623,-683.86C1623,-675.6 1623,-666.82 1623,-658.26"/>
<polygon fill="black" stroke="black" points="1626.5,-657.97 1623,-647.97 1619.5,-657.97 1626.5,-657.97"/>
</g>
<!-- layer3_expert0_9 -->
<g id="node603" class="node">
<title>layer3_expert0_9</title>
<polygon fill="lightgreen" stroke="black" points="1902,-647.95 1728,-647.95 1728,-564.95 1902,-564.95 1902,-647.95"/>
<text text-anchor="middle" x="1815" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU0</text>
<text text-anchor="middle" x="1815" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="1815" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="1815" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="1815" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_gate_gpu0&#45;&gt;layer3_expert0_9 -->
<g id="edge983" class="edge">
<title>layer3_gate_gpu0&#45;&gt;layer3_expert0_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1689.61,-683.86C1705.85,-673.97 1723.32,-663.32 1739.92,-653.21"/>
<polygon fill="black" stroke="black" points="1741.79,-656.17 1748.5,-647.97 1738.14,-650.19 1741.79,-656.17"/>
</g>
<!-- layer3_expert0_10 -->
<g id="node604" class="node">
<title>layer3_expert0_10</title>
<polygon fill="lightgreen" stroke="black" points="2094,-647.95 1920,-647.95 1920,-564.95 2094,-564.95 2094,-647.95"/>
<text text-anchor="middle" x="2007" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU0</text>
<text text-anchor="middle" x="2007" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2007" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2007" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2007" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_gate_gpu0&#45;&gt;layer3_expert0_10 -->
<g id="edge984" class="edge">
<title>layer3_gate_gpu0&#45;&gt;layer3_expert0_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1745.34,-695.97C1794.34,-683.59 1851.28,-667.96 1910.33,-648.07"/>
<polygon fill="black" stroke="black" points="1911.48,-651.37 1919.82,-644.84 1909.23,-644.75 1911.48,-651.37"/>
</g>
<!-- layer3_expert0_11 -->
<g id="node605" class="node">
<title>layer3_expert0_11</title>
<polygon fill="lightgreen" stroke="black" points="2286,-647.95 2112,-647.95 2112,-564.95 2286,-564.95 2286,-647.95"/>
<text text-anchor="middle" x="2199" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU0</text>
<text text-anchor="middle" x="2199" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2199" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2199" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2199" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_gate_gpu0&#45;&gt;layer3_expert0_11 -->
<g id="edge985" class="edge">
<title>layer3_gate_gpu0&#45;&gt;layer3_expert0_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1745.09,-713.21C1840.68,-702.51 1976.63,-683.09 2102.16,-648"/>
<polygon fill="black" stroke="black" points="2103.28,-651.32 2111.94,-645.23 2101.37,-644.59 2103.28,-651.32"/>
</g>
<!-- layer3_expert0_12 -->
<g id="node606" class="node">
<title>layer3_expert0_12</title>
<polygon fill="lightgreen" stroke="black" points="2478,-647.95 2304,-647.95 2304,-564.95 2478,-564.95 2478,-647.95"/>
<text text-anchor="middle" x="2391" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU0</text>
<text text-anchor="middle" x="2391" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2391" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2391" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2391" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_gate_gpu0&#45;&gt;layer3_expert0_12 -->
<g id="edge986" class="edge">
<title>layer3_gate_gpu0&#45;&gt;layer3_expert0_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1745.09,-721C1878.97,-714.86 2099.54,-697.79 2294.16,-647.96"/>
<polygon fill="black" stroke="black" points="2295.19,-651.3 2303.99,-645.4 2293.43,-644.53 2295.19,-651.3"/>
</g>
<!-- layer3_expert0_13 -->
<g id="node607" class="node">
<title>layer3_expert0_13</title>
<polygon fill="lightgreen" stroke="black" points="2670,-647.95 2496,-647.95 2496,-564.95 2670,-564.95 2670,-647.95"/>
<text text-anchor="middle" x="2583" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU0</text>
<text text-anchor="middle" x="2583" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2583" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2583" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2583" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_gate_gpu0&#45;&gt;layer3_expert0_13 -->
<g id="edge987" class="edge">
<title>layer3_gate_gpu0&#45;&gt;layer3_expert0_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1745.23,-718.32C1944.75,-707.53 2332.69,-683.15 2486,-647.92"/>
<polygon fill="black" stroke="black" points="2486.84,-651.31 2495.75,-645.58 2485.21,-644.5 2486.84,-651.31"/>
</g>
<!-- layer3_expert0_14 -->
<g id="node608" class="node">
<title>layer3_expert0_14</title>
<polygon fill="lightgreen" stroke="black" points="2862,-647.95 2688,-647.95 2688,-564.95 2862,-564.95 2862,-647.95"/>
<text text-anchor="middle" x="2775" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU0</text>
<text text-anchor="middle" x="2775" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2775" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2775" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2775" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_gate_gpu0&#45;&gt;layer3_expert0_14 -->
<g id="edge988" class="edge">
<title>layer3_gate_gpu0&#45;&gt;layer3_expert0_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1745.08,-720.61C1979.72,-712.41 2486.62,-690.58 2677.81,-647.95"/>
<polygon fill="black" stroke="black" points="2678.81,-651.31 2687.77,-645.64 2677.23,-644.49 2678.81,-651.31"/>
</g>
<!-- layer3_expert0_15 -->
<g id="node609" class="node">
<title>layer3_expert0_15</title>
<polygon fill="lightgreen" stroke="black" points="3054,-647.95 2880,-647.95 2880,-564.95 3054,-564.95 3054,-647.95"/>
<text text-anchor="middle" x="2967" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU0</text>
<text text-anchor="middle" x="2967" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="2967" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="2967" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="2967" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_gate_gpu0&#45;&gt;layer3_expert0_15 -->
<g id="edge989" class="edge">
<title>layer3_gate_gpu0&#45;&gt;layer3_expert0_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1745.18,-722.19C2012.05,-716.43 2640.75,-698.07 2869.83,-647.94"/>
<polygon fill="black" stroke="black" points="2870.8,-651.31 2879.78,-645.68 2869.25,-644.48 2870.8,-651.31"/>
</g>
<!-- layer3_moe_agg_gpu0 -->
<g id="node610" class="node">
<title>layer3_moe_agg_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1724.5,-528.95 1521.5,-528.95 1521.5,-460.95 1724.5,-460.95 1724.5,-528.95"/>
<text text-anchor="middle" x="1623" y="-513.75" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU0</text>
<text text-anchor="middle" x="1623" y="-498.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="1623" y="-483.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="1623" y="-468.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_expert0_0&#45;&gt;layer3_moe_agg_gpu0 -->
<g id="edge990" class="edge">
<title>layer3_expert0_0&#45;&gt;layer3_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M174.21,-567.17C177.16,-566.36 180.09,-565.62 183,-564.95 435.13,-507.63 1218.27,-497.89 1511.05,-496.27"/>
<polygon fill="black" stroke="black" points="1511.27,-499.77 1521.25,-496.21 1511.24,-492.77 1511.27,-499.77"/>
</g>
<!-- layer3_expert0_1&#45;&gt;layer3_moe_agg_gpu0 -->
<g id="edge991" class="edge">
<title>layer3_expert0_1&#45;&gt;layer3_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M366.22,-567.2C369.16,-566.38 372.09,-565.63 375,-564.95 589.24,-515.42 1246.44,-501.07 1510.97,-497.24"/>
<polygon fill="black" stroke="black" points="1511.41,-500.73 1521.36,-497.09 1511.31,-493.73 1511.41,-500.73"/>
</g>
<!-- layer3_expert0_2&#45;&gt;layer3_moe_agg_gpu0 -->
<g id="edge992" class="edge">
<title>layer3_expert0_2&#45;&gt;layer3_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M558.23,-567.24C561.17,-566.41 564.1,-565.64 567,-564.95 743.72,-523.16 1277.22,-504.77 1511.09,-498.56"/>
<polygon fill="black" stroke="black" points="1511.42,-502.05 1521.32,-498.29 1511.23,-495.05 1511.42,-502.05"/>
</g>
<!-- layer3_expert0_3&#45;&gt;layer3_moe_agg_gpu0 -->
<g id="edge993" class="edge">
<title>layer3_expert0_3&#45;&gt;layer3_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M750.24,-567.3C753.18,-566.45 756.1,-565.66 759,-564.95 898.55,-530.88 1310.54,-509.25 1510.96,-500.46"/>
<polygon fill="black" stroke="black" points="1511.39,-503.94 1521.22,-500.01 1511.08,-496.95 1511.39,-503.94"/>
</g>
<!-- layer3_expert0_4&#45;&gt;layer3_moe_agg_gpu0 -->
<g id="edge994" class="edge">
<title>layer3_expert0_4&#45;&gt;layer3_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M942.26,-567.38C945.19,-566.51 948.11,-565.69 951,-564.95 1143.8,-515.56 1376.29,-501.33 1511.12,-497.35"/>
<polygon fill="black" stroke="black" points="1511.56,-500.84 1521.46,-497.06 1511.37,-493.84 1511.56,-500.84"/>
</g>
<!-- layer3_expert0_5&#45;&gt;layer3_moe_agg_gpu0 -->
<g id="edge995" class="edge">
<title>layer3_expert0_5&#45;&gt;layer3_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1134.04,-567.62C1137.04,-566.67 1140.04,-565.78 1143,-564.95 1266.52,-530.64 1412.92,-512.73 1511.28,-503.86"/>
<polygon fill="black" stroke="black" points="1511.59,-507.34 1521.24,-502.97 1510.97,-500.37 1511.59,-507.34"/>
</g>
<!-- layer3_expert0_6&#45;&gt;layer3_moe_agg_gpu0 -->
<g id="edge996" class="edge">
<title>layer3_expert0_6&#45;&gt;layer3_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1326.15,-567.97C1329.12,-566.92 1332.08,-565.91 1335,-564.95 1392.25,-546.16 1457.45,-530.11 1511.32,-518.23"/>
<polygon fill="black" stroke="black" points="1512.22,-521.62 1521.24,-516.06 1510.72,-514.78 1512.22,-521.62"/>
</g>
<!-- layer3_expert0_7&#45;&gt;layer3_moe_agg_gpu0 -->
<g id="edge997" class="edge">
<title>layer3_expert0_7&#45;&gt;layer3_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1502.22,-564.84C1519.85,-554.78 1538.68,-544.04 1556.1,-534.11"/>
<polygon fill="black" stroke="black" points="1558.11,-536.99 1565.06,-529 1554.64,-530.91 1558.11,-536.99"/>
</g>
<!-- layer3_expert0_8&#45;&gt;layer3_moe_agg_gpu0 -->
<g id="edge998" class="edge">
<title>layer3_expert0_8&#45;&gt;layer3_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1623,-564.68C1623,-556.47 1623,-547.81 1623,-539.51"/>
<polygon fill="black" stroke="black" points="1626.5,-539.25 1623,-529.25 1619.5,-539.25 1626.5,-539.25"/>
</g>
<!-- layer3_expert0_9&#45;&gt;layer3_moe_agg_gpu0 -->
<g id="edge999" class="edge">
<title>layer3_expert0_9&#45;&gt;layer3_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1743.78,-564.84C1726.15,-554.78 1707.32,-544.04 1689.9,-534.11"/>
<polygon fill="black" stroke="black" points="1691.36,-530.91 1680.94,-529 1687.89,-536.99 1691.36,-530.91"/>
</g>
<!-- layer3_expert0_10&#45;&gt;layer3_moe_agg_gpu0 -->
<g id="edge1000" class="edge">
<title>layer3_expert0_10&#45;&gt;layer3_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1919.85,-567.97C1916.88,-566.92 1913.92,-565.91 1911,-564.95 1853.75,-546.16 1788.55,-530.11 1734.68,-518.23"/>
<polygon fill="black" stroke="black" points="1735.28,-514.78 1724.76,-516.06 1733.78,-521.62 1735.28,-514.78"/>
</g>
<!-- layer3_expert0_11&#45;&gt;layer3_moe_agg_gpu0 -->
<g id="edge1001" class="edge">
<title>layer3_expert0_11&#45;&gt;layer3_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2111.96,-567.62C2108.96,-566.67 2105.96,-565.78 2103,-564.95 1979.48,-530.64 1833.08,-512.73 1734.72,-503.86"/>
<polygon fill="black" stroke="black" points="1735.03,-500.37 1724.76,-502.97 1734.41,-507.34 1735.03,-500.37"/>
</g>
<!-- layer3_expert0_12&#45;&gt;layer3_moe_agg_gpu0 -->
<g id="edge1002" class="edge">
<title>layer3_expert0_12&#45;&gt;layer3_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2303.74,-567.38C2300.81,-566.51 2297.89,-565.69 2295,-564.95 2102.2,-515.56 1869.71,-501.33 1734.88,-497.35"/>
<polygon fill="black" stroke="black" points="1734.63,-493.84 1724.54,-497.06 1734.44,-500.84 1734.63,-493.84"/>
</g>
<!-- layer3_expert0_13&#45;&gt;layer3_moe_agg_gpu0 -->
<g id="edge1003" class="edge">
<title>layer3_expert0_13&#45;&gt;layer3_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2495.76,-567.3C2492.82,-566.45 2489.9,-565.66 2487,-564.95 2347.45,-530.88 1935.46,-509.25 1735.04,-500.46"/>
<polygon fill="black" stroke="black" points="1734.92,-496.95 1724.78,-500.01 1734.61,-503.94 1734.92,-496.95"/>
</g>
<!-- layer3_expert0_14&#45;&gt;layer3_moe_agg_gpu0 -->
<g id="edge1004" class="edge">
<title>layer3_expert0_14&#45;&gt;layer3_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2687.77,-567.24C2684.83,-566.41 2681.9,-565.64 2679,-564.95 2502.28,-523.16 1968.78,-504.77 1734.91,-498.56"/>
<polygon fill="black" stroke="black" points="1734.77,-495.05 1724.68,-498.29 1734.58,-502.05 1734.77,-495.05"/>
</g>
<!-- layer3_expert0_15&#45;&gt;layer3_moe_agg_gpu0 -->
<g id="edge1005" class="edge">
<title>layer3_expert0_15&#45;&gt;layer3_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2879.78,-567.2C2876.84,-566.38 2873.91,-565.63 2871,-564.95 2656.76,-515.42 1999.56,-501.07 1735.03,-497.24"/>
<polygon fill="black" stroke="black" points="1734.69,-493.73 1724.64,-497.09 1734.59,-500.73 1734.69,-493.73"/>
</g>
<!-- layer3_moe_allreduce -->
<g id="node745" class="node">
<title>layer3_moe_allreduce</title>
<polygon fill="lightcoral" stroke="black" points="12279,-424.95 12042,-356.95 12279,-288.95 12516,-356.95 12279,-424.95"/>
<text text-anchor="middle" x="12279" y="-375.75" font-family="Times,serif" font-size="14.00">L3_MoE_All&#45;Reduce</text>
<text text-anchor="middle" x="12279" y="-360.75" font-family="Times,serif" font-size="14.00">Input: 8×[1024,2048,4096]</text>
<text text-anchor="middle" x="12279" y="-345.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12279" y="-330.75" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce across GPUs 0&#45;7</text>
</g>
<!-- layer3_moe_agg_gpu0&#45;&gt;layer3_moe_allreduce -->
<g id="edge1006" class="edge">
<title>layer3_moe_agg_gpu0&#45;&gt;layer3_moe_allreduce</title>
<path fill="none" stroke="black" d="M1724.63,-492.66C2711.3,-480.06 10581.46,-379.62 12045.14,-360.94"/>
<polygon fill="black" stroke="black" points="12045.29,-364.44 12055.25,-360.81 12045.2,-357.44 12045.29,-364.44"/>
</g>
<!-- layer3_output_gpu0 -->
<g id="node611" class="node">
<title>layer3_output_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="11484,-252.95 11240,-252.95 11240,-184.95 11484,-184.95 11484,-252.95"/>
<text text-anchor="middle" x="11362" y="-237.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU0</text>
<text text-anchor="middle" x="11362" y="-222.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="11362" y="-207.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11362" y="-192.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- output -->
<g id="node746" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="12279" cy="-111.48" rx="292.07" ry="37.45"/>
<text text-anchor="middle" x="12279" y="-122.78" font-family="Times,serif" font-size="14.00">OUTPUT</text>
<text text-anchor="middle" x="12279" y="-107.78" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="12279" y="-92.78" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer3_output_gpu0&#45;&gt;output -->
<g id="edge1281" class="edge">
<title>layer3_output_gpu0&#45;&gt;output</title>
<path fill="none" stroke="black" d="M11484.25,-186.52C11487.19,-185.97 11490.11,-185.45 11493,-184.95 11660.69,-156.28 11850.59,-138.37 12001.72,-127.53"/>
<polygon fill="black" stroke="black" points="12002.35,-130.99 12012.07,-126.79 12001.85,-124.01 12002.35,-130.99"/>
</g>
<!-- layer3_expert1_0 -->
<g id="node613" class="node">
<title>layer3_expert1_0</title>
<polygon fill="lightgreen" stroke="black" points="3246,-647.95 3072,-647.95 3072,-564.95 3246,-564.95 3246,-647.95"/>
<text text-anchor="middle" x="3159" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU1</text>
<text text-anchor="middle" x="3159" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3159" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3159" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3159" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_gate_gpu1&#45;&gt;layer3_expert1_0 -->
<g id="edge1013" class="edge">
<title>layer3_gate_gpu1&#45;&gt;layer3_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4572.8,-723.37C4276.21,-719.87 3523.59,-705.65 3256.29,-647.96"/>
<polygon fill="black" stroke="black" points="3256.74,-644.48 3246.22,-645.71 3255.22,-651.31 3256.74,-644.48"/>
</g>
<!-- layer3_expert1_1 -->
<g id="node614" class="node">
<title>layer3_expert1_1</title>
<polygon fill="lightgreen" stroke="black" points="3438,-647.95 3264,-647.95 3264,-564.95 3438,-564.95 3438,-647.95"/>
<text text-anchor="middle" x="3351" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU1</text>
<text text-anchor="middle" x="3351" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3351" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3351" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3351" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_gate_gpu1&#45;&gt;layer3_expert1_1 -->
<g id="edge1014" class="edge">
<title>layer3_gate_gpu1&#45;&gt;layer3_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4572.82,-722.19C4305.95,-716.43 3677.25,-698.07 3448.17,-647.94"/>
<polygon fill="black" stroke="black" points="3448.75,-644.48 3438.22,-645.68 3447.2,-651.31 3448.75,-644.48"/>
</g>
<!-- layer3_expert1_2 -->
<g id="node615" class="node">
<title>layer3_expert1_2</title>
<polygon fill="lightgreen" stroke="black" points="3630,-647.95 3456,-647.95 3456,-564.95 3630,-564.95 3630,-647.95"/>
<text text-anchor="middle" x="3543" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU1</text>
<text text-anchor="middle" x="3543" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3543" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3543" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3543" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_gate_gpu1&#45;&gt;layer3_expert1_2 -->
<g id="edge1015" class="edge">
<title>layer3_gate_gpu1&#45;&gt;layer3_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4572.92,-720.61C4338.28,-712.41 3831.38,-690.58 3640.19,-647.95"/>
<polygon fill="black" stroke="black" points="3640.77,-644.49 3630.23,-645.64 3639.19,-651.31 3640.77,-644.49"/>
</g>
<!-- layer3_expert1_3 -->
<g id="node616" class="node">
<title>layer3_expert1_3</title>
<polygon fill="lightgreen" stroke="black" points="3822,-647.95 3648,-647.95 3648,-564.95 3822,-564.95 3822,-647.95"/>
<text text-anchor="middle" x="3735" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU1</text>
<text text-anchor="middle" x="3735" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3735" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3735" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3735" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_gate_gpu1&#45;&gt;layer3_expert1_3 -->
<g id="edge1016" class="edge">
<title>layer3_gate_gpu1&#45;&gt;layer3_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4572.77,-718.32C4373.25,-707.53 3985.31,-683.15 3832,-647.92"/>
<polygon fill="black" stroke="black" points="3832.79,-644.5 3822.25,-645.58 3831.16,-651.31 3832.79,-644.5"/>
</g>
<!-- layer3_expert1_4 -->
<g id="node617" class="node">
<title>layer3_expert1_4</title>
<polygon fill="lightgreen" stroke="black" points="4014,-647.95 3840,-647.95 3840,-564.95 4014,-564.95 4014,-647.95"/>
<text text-anchor="middle" x="3927" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU1</text>
<text text-anchor="middle" x="3927" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="3927" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="3927" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="3927" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_gate_gpu1&#45;&gt;layer3_expert1_4 -->
<g id="edge1017" class="edge">
<title>layer3_gate_gpu1&#45;&gt;layer3_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4572.91,-721C4439.03,-714.86 4218.46,-697.79 4023.84,-647.96"/>
<polygon fill="black" stroke="black" points="4024.57,-644.53 4014.01,-645.4 4022.81,-651.3 4024.57,-644.53"/>
</g>
<!-- layer3_expert1_5 -->
<g id="node618" class="node">
<title>layer3_expert1_5</title>
<polygon fill="lightgreen" stroke="black" points="4206,-647.95 4032,-647.95 4032,-564.95 4206,-564.95 4206,-647.95"/>
<text text-anchor="middle" x="4119" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU1</text>
<text text-anchor="middle" x="4119" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4119" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4119" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4119" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_gate_gpu1&#45;&gt;layer3_expert1_5 -->
<g id="edge1018" class="edge">
<title>layer3_gate_gpu1&#45;&gt;layer3_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4572.91,-713.21C4477.32,-702.51 4341.37,-683.09 4215.84,-648"/>
<polygon fill="black" stroke="black" points="4216.63,-644.59 4206.06,-645.23 4214.72,-651.32 4216.63,-644.59"/>
</g>
<!-- layer3_expert1_6 -->
<g id="node619" class="node">
<title>layer3_expert1_6</title>
<polygon fill="lightgreen" stroke="black" points="4398,-647.95 4224,-647.95 4224,-564.95 4398,-564.95 4398,-647.95"/>
<text text-anchor="middle" x="4311" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU1</text>
<text text-anchor="middle" x="4311" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4311" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4311" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4311" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_gate_gpu1&#45;&gt;layer3_expert1_6 -->
<g id="edge1019" class="edge">
<title>layer3_gate_gpu1&#45;&gt;layer3_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4572.66,-695.97C4523.66,-683.59 4466.72,-667.96 4407.67,-648.07"/>
<polygon fill="black" stroke="black" points="4408.77,-644.75 4398.18,-644.84 4406.52,-651.37 4408.77,-644.75"/>
</g>
<!-- layer3_expert1_7 -->
<g id="node620" class="node">
<title>layer3_expert1_7</title>
<polygon fill="lightgreen" stroke="black" points="4590,-647.95 4416,-647.95 4416,-564.95 4590,-564.95 4590,-647.95"/>
<text text-anchor="middle" x="4503" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU1</text>
<text text-anchor="middle" x="4503" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4503" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4503" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4503" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_gate_gpu1&#45;&gt;layer3_expert1_7 -->
<g id="edge1020" class="edge">
<title>layer3_gate_gpu1&#45;&gt;layer3_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4628.39,-683.86C4612.15,-673.97 4594.68,-663.32 4578.08,-653.21"/>
<polygon fill="black" stroke="black" points="4579.86,-650.19 4569.5,-647.97 4576.21,-656.17 4579.86,-650.19"/>
</g>
<!-- layer3_expert1_8 -->
<g id="node621" class="node">
<title>layer3_expert1_8</title>
<polygon fill="lightgreen" stroke="black" points="4782,-647.95 4608,-647.95 4608,-564.95 4782,-564.95 4782,-647.95"/>
<text text-anchor="middle" x="4695" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU1</text>
<text text-anchor="middle" x="4695" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4695" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4695" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4695" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_gate_gpu1&#45;&gt;layer3_expert1_8 -->
<g id="edge1021" class="edge">
<title>layer3_gate_gpu1&#45;&gt;layer3_expert1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4695,-683.86C4695,-675.6 4695,-666.82 4695,-658.26"/>
<polygon fill="black" stroke="black" points="4698.5,-657.97 4695,-647.97 4691.5,-657.97 4698.5,-657.97"/>
</g>
<!-- layer3_expert1_9 -->
<g id="node622" class="node">
<title>layer3_expert1_9</title>
<polygon fill="lightgreen" stroke="black" points="4974,-647.95 4800,-647.95 4800,-564.95 4974,-564.95 4974,-647.95"/>
<text text-anchor="middle" x="4887" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU1</text>
<text text-anchor="middle" x="4887" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="4887" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="4887" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="4887" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_gate_gpu1&#45;&gt;layer3_expert1_9 -->
<g id="edge1022" class="edge">
<title>layer3_gate_gpu1&#45;&gt;layer3_expert1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4761.61,-683.86C4777.85,-673.97 4795.32,-663.32 4811.92,-653.21"/>
<polygon fill="black" stroke="black" points="4813.79,-656.17 4820.5,-647.97 4810.14,-650.19 4813.79,-656.17"/>
</g>
<!-- layer3_expert1_10 -->
<g id="node623" class="node">
<title>layer3_expert1_10</title>
<polygon fill="lightgreen" stroke="black" points="5166,-647.95 4992,-647.95 4992,-564.95 5166,-564.95 5166,-647.95"/>
<text text-anchor="middle" x="5079" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU1</text>
<text text-anchor="middle" x="5079" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5079" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5079" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5079" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_gate_gpu1&#45;&gt;layer3_expert1_10 -->
<g id="edge1023" class="edge">
<title>layer3_gate_gpu1&#45;&gt;layer3_expert1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4817.34,-695.97C4866.34,-683.59 4923.28,-667.96 4982.33,-648.07"/>
<polygon fill="black" stroke="black" points="4983.48,-651.37 4991.82,-644.84 4981.23,-644.75 4983.48,-651.37"/>
</g>
<!-- layer3_expert1_11 -->
<g id="node624" class="node">
<title>layer3_expert1_11</title>
<polygon fill="lightgreen" stroke="black" points="5358,-647.95 5184,-647.95 5184,-564.95 5358,-564.95 5358,-647.95"/>
<text text-anchor="middle" x="5271" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU1</text>
<text text-anchor="middle" x="5271" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5271" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5271" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5271" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_gate_gpu1&#45;&gt;layer3_expert1_11 -->
<g id="edge1024" class="edge">
<title>layer3_gate_gpu1&#45;&gt;layer3_expert1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4817.09,-713.21C4912.68,-702.51 5048.63,-683.09 5174.16,-648"/>
<polygon fill="black" stroke="black" points="5175.28,-651.32 5183.94,-645.23 5173.37,-644.59 5175.28,-651.32"/>
</g>
<!-- layer3_expert1_12 -->
<g id="node625" class="node">
<title>layer3_expert1_12</title>
<polygon fill="lightgreen" stroke="black" points="5550,-647.95 5376,-647.95 5376,-564.95 5550,-564.95 5550,-647.95"/>
<text text-anchor="middle" x="5463" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU1</text>
<text text-anchor="middle" x="5463" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5463" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5463" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5463" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_gate_gpu1&#45;&gt;layer3_expert1_12 -->
<g id="edge1025" class="edge">
<title>layer3_gate_gpu1&#45;&gt;layer3_expert1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4817.09,-721C4950.97,-714.86 5171.54,-697.79 5366.16,-647.96"/>
<polygon fill="black" stroke="black" points="5367.19,-651.3 5375.99,-645.4 5365.43,-644.53 5367.19,-651.3"/>
</g>
<!-- layer3_expert1_13 -->
<g id="node626" class="node">
<title>layer3_expert1_13</title>
<polygon fill="lightgreen" stroke="black" points="5742,-647.95 5568,-647.95 5568,-564.95 5742,-564.95 5742,-647.95"/>
<text text-anchor="middle" x="5655" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU1</text>
<text text-anchor="middle" x="5655" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5655" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5655" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5655" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_gate_gpu1&#45;&gt;layer3_expert1_13 -->
<g id="edge1026" class="edge">
<title>layer3_gate_gpu1&#45;&gt;layer3_expert1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4817.23,-718.32C5016.75,-707.53 5404.69,-683.15 5558,-647.92"/>
<polygon fill="black" stroke="black" points="5558.84,-651.31 5567.75,-645.58 5557.21,-644.5 5558.84,-651.31"/>
</g>
<!-- layer3_expert1_14 -->
<g id="node627" class="node">
<title>layer3_expert1_14</title>
<polygon fill="lightgreen" stroke="black" points="5934,-647.95 5760,-647.95 5760,-564.95 5934,-564.95 5934,-647.95"/>
<text text-anchor="middle" x="5847" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU1</text>
<text text-anchor="middle" x="5847" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="5847" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="5847" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="5847" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_gate_gpu1&#45;&gt;layer3_expert1_14 -->
<g id="edge1027" class="edge">
<title>layer3_gate_gpu1&#45;&gt;layer3_expert1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4817.08,-720.61C5051.72,-712.41 5558.62,-690.58 5749.81,-647.95"/>
<polygon fill="black" stroke="black" points="5750.81,-651.31 5759.77,-645.64 5749.23,-644.49 5750.81,-651.31"/>
</g>
<!-- layer3_expert1_15 -->
<g id="node628" class="node">
<title>layer3_expert1_15</title>
<polygon fill="lightgreen" stroke="black" points="6126,-647.95 5952,-647.95 5952,-564.95 6126,-564.95 6126,-647.95"/>
<text text-anchor="middle" x="6039" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU1</text>
<text text-anchor="middle" x="6039" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6039" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6039" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6039" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_gate_gpu1&#45;&gt;layer3_expert1_15 -->
<g id="edge1028" class="edge">
<title>layer3_gate_gpu1&#45;&gt;layer3_expert1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4817.18,-722.19C5084.05,-716.43 5712.75,-698.07 5941.83,-647.94"/>
<polygon fill="black" stroke="black" points="5942.8,-651.31 5951.78,-645.68 5941.25,-644.48 5942.8,-651.31"/>
</g>
<!-- layer3_moe_agg_gpu1 -->
<g id="node629" class="node">
<title>layer3_moe_agg_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="4796.5,-528.95 4593.5,-528.95 4593.5,-460.95 4796.5,-460.95 4796.5,-528.95"/>
<text text-anchor="middle" x="4695" y="-513.75" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU1</text>
<text text-anchor="middle" x="4695" y="-498.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="4695" y="-483.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="4695" y="-468.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_expert1_0&#45;&gt;layer3_moe_agg_gpu1 -->
<g id="edge1029" class="edge">
<title>layer3_expert1_0&#45;&gt;layer3_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3246.21,-567.17C3249.16,-566.36 3252.09,-565.62 3255,-564.95 3507.13,-507.63 4290.27,-497.89 4583.05,-496.27"/>
<polygon fill="black" stroke="black" points="4583.27,-499.77 4593.25,-496.21 4583.24,-492.77 4583.27,-499.77"/>
</g>
<!-- layer3_expert1_1&#45;&gt;layer3_moe_agg_gpu1 -->
<g id="edge1030" class="edge">
<title>layer3_expert1_1&#45;&gt;layer3_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3438.22,-567.2C3441.16,-566.38 3444.09,-565.63 3447,-564.95 3661.24,-515.42 4318.44,-501.07 4582.97,-497.24"/>
<polygon fill="black" stroke="black" points="4583.41,-500.73 4593.36,-497.09 4583.31,-493.73 4583.41,-500.73"/>
</g>
<!-- layer3_expert1_2&#45;&gt;layer3_moe_agg_gpu1 -->
<g id="edge1031" class="edge">
<title>layer3_expert1_2&#45;&gt;layer3_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3630.23,-567.24C3633.17,-566.41 3636.1,-565.64 3639,-564.95 3815.72,-523.16 4349.22,-504.77 4583.09,-498.56"/>
<polygon fill="black" stroke="black" points="4583.42,-502.05 4593.32,-498.29 4583.23,-495.05 4583.42,-502.05"/>
</g>
<!-- layer3_expert1_3&#45;&gt;layer3_moe_agg_gpu1 -->
<g id="edge1032" class="edge">
<title>layer3_expert1_3&#45;&gt;layer3_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3822.24,-567.3C3825.18,-566.45 3828.1,-565.66 3831,-564.95 3970.55,-530.88 4382.54,-509.25 4582.96,-500.46"/>
<polygon fill="black" stroke="black" points="4583.39,-503.94 4593.22,-500.01 4583.08,-496.95 4583.39,-503.94"/>
</g>
<!-- layer3_expert1_4&#45;&gt;layer3_moe_agg_gpu1 -->
<g id="edge1033" class="edge">
<title>layer3_expert1_4&#45;&gt;layer3_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4014.26,-567.38C4017.19,-566.51 4020.11,-565.69 4023,-564.95 4215.8,-515.56 4448.29,-501.33 4583.12,-497.35"/>
<polygon fill="black" stroke="black" points="4583.56,-500.84 4593.46,-497.06 4583.37,-493.84 4583.56,-500.84"/>
</g>
<!-- layer3_expert1_5&#45;&gt;layer3_moe_agg_gpu1 -->
<g id="edge1034" class="edge">
<title>layer3_expert1_5&#45;&gt;layer3_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4206.04,-567.62C4209.04,-566.67 4212.04,-565.78 4215,-564.95 4338.52,-530.64 4484.92,-512.73 4583.28,-503.86"/>
<polygon fill="black" stroke="black" points="4583.59,-507.34 4593.24,-502.97 4582.97,-500.37 4583.59,-507.34"/>
</g>
<!-- layer3_expert1_6&#45;&gt;layer3_moe_agg_gpu1 -->
<g id="edge1035" class="edge">
<title>layer3_expert1_6&#45;&gt;layer3_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4398.15,-567.97C4401.12,-566.92 4404.08,-565.91 4407,-564.95 4464.25,-546.16 4529.45,-530.11 4583.32,-518.23"/>
<polygon fill="black" stroke="black" points="4584.22,-521.62 4593.24,-516.06 4582.72,-514.78 4584.22,-521.62"/>
</g>
<!-- layer3_expert1_7&#45;&gt;layer3_moe_agg_gpu1 -->
<g id="edge1036" class="edge">
<title>layer3_expert1_7&#45;&gt;layer3_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4574.22,-564.84C4591.85,-554.78 4610.68,-544.04 4628.1,-534.11"/>
<polygon fill="black" stroke="black" points="4630.11,-536.99 4637.06,-529 4626.64,-530.91 4630.11,-536.99"/>
</g>
<!-- layer3_expert1_8&#45;&gt;layer3_moe_agg_gpu1 -->
<g id="edge1037" class="edge">
<title>layer3_expert1_8&#45;&gt;layer3_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4695,-564.68C4695,-556.47 4695,-547.81 4695,-539.51"/>
<polygon fill="black" stroke="black" points="4698.5,-539.25 4695,-529.25 4691.5,-539.25 4698.5,-539.25"/>
</g>
<!-- layer3_expert1_9&#45;&gt;layer3_moe_agg_gpu1 -->
<g id="edge1038" class="edge">
<title>layer3_expert1_9&#45;&gt;layer3_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4815.78,-564.84C4798.15,-554.78 4779.32,-544.04 4761.9,-534.11"/>
<polygon fill="black" stroke="black" points="4763.36,-530.91 4752.94,-529 4759.89,-536.99 4763.36,-530.91"/>
</g>
<!-- layer3_expert1_10&#45;&gt;layer3_moe_agg_gpu1 -->
<g id="edge1039" class="edge">
<title>layer3_expert1_10&#45;&gt;layer3_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4991.85,-567.97C4988.88,-566.92 4985.92,-565.91 4983,-564.95 4925.75,-546.16 4860.55,-530.11 4806.68,-518.23"/>
<polygon fill="black" stroke="black" points="4807.28,-514.78 4796.76,-516.06 4805.78,-521.62 4807.28,-514.78"/>
</g>
<!-- layer3_expert1_11&#45;&gt;layer3_moe_agg_gpu1 -->
<g id="edge1040" class="edge">
<title>layer3_expert1_11&#45;&gt;layer3_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5183.96,-567.62C5180.96,-566.67 5177.96,-565.78 5175,-564.95 5051.48,-530.64 4905.08,-512.73 4806.72,-503.86"/>
<polygon fill="black" stroke="black" points="4807.03,-500.37 4796.76,-502.97 4806.41,-507.34 4807.03,-500.37"/>
</g>
<!-- layer3_expert1_12&#45;&gt;layer3_moe_agg_gpu1 -->
<g id="edge1041" class="edge">
<title>layer3_expert1_12&#45;&gt;layer3_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5375.74,-567.38C5372.81,-566.51 5369.89,-565.69 5367,-564.95 5174.2,-515.56 4941.71,-501.33 4806.88,-497.35"/>
<polygon fill="black" stroke="black" points="4806.63,-493.84 4796.54,-497.06 4806.44,-500.84 4806.63,-493.84"/>
</g>
<!-- layer3_expert1_13&#45;&gt;layer3_moe_agg_gpu1 -->
<g id="edge1042" class="edge">
<title>layer3_expert1_13&#45;&gt;layer3_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5567.76,-567.3C5564.82,-566.45 5561.9,-565.66 5559,-564.95 5419.45,-530.88 5007.46,-509.25 4807.04,-500.46"/>
<polygon fill="black" stroke="black" points="4806.92,-496.95 4796.78,-500.01 4806.61,-503.94 4806.92,-496.95"/>
</g>
<!-- layer3_expert1_14&#45;&gt;layer3_moe_agg_gpu1 -->
<g id="edge1043" class="edge">
<title>layer3_expert1_14&#45;&gt;layer3_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5759.77,-567.24C5756.83,-566.41 5753.9,-565.64 5751,-564.95 5574.28,-523.16 5040.78,-504.77 4806.91,-498.56"/>
<polygon fill="black" stroke="black" points="4806.77,-495.05 4796.68,-498.29 4806.58,-502.05 4806.77,-495.05"/>
</g>
<!-- layer3_expert1_15&#45;&gt;layer3_moe_agg_gpu1 -->
<g id="edge1044" class="edge">
<title>layer3_expert1_15&#45;&gt;layer3_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5951.78,-567.2C5948.84,-566.38 5945.91,-565.63 5943,-564.95 5728.76,-515.42 5071.56,-501.07 4807.03,-497.24"/>
<polygon fill="black" stroke="black" points="4806.69,-493.73 4796.64,-497.09 4806.59,-500.73 4806.69,-493.73"/>
</g>
<!-- layer3_moe_agg_gpu1&#45;&gt;layer3_moe_allreduce -->
<g id="edge1045" class="edge">
<title>layer3_moe_agg_gpu1&#45;&gt;layer3_moe_allreduce</title>
<path fill="none" stroke="black" d="M4796.83,-492.13C5597.22,-477.77 10876.32,-383.11 12048.64,-362.08"/>
<polygon fill="black" stroke="black" points="12048.93,-365.58 12058.86,-361.9 12048.8,-358.58 12048.93,-365.58"/>
</g>
<!-- layer3_output_gpu1 -->
<g id="node630" class="node">
<title>layer3_output_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11746,-252.95 11502,-252.95 11502,-184.95 11746,-184.95 11746,-252.95"/>
<text text-anchor="middle" x="11624" y="-237.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU1</text>
<text text-anchor="middle" x="11624" y="-222.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="11624" y="-207.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11624" y="-192.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_output_gpu1&#45;&gt;output -->
<g id="edge1282" class="edge">
<title>layer3_output_gpu1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M11746.28,-186.7C11749.21,-186.1 11752.12,-185.51 11755,-184.95 11852.31,-166.03 11960.72,-150.17 12053.57,-138.17"/>
<polygon fill="black" stroke="black" points="12054.18,-141.62 12063.65,-136.87 12053.29,-134.68 12054.18,-141.62"/>
</g>
<!-- layer3_expert2_0 -->
<g id="node632" class="node">
<title>layer3_expert2_0</title>
<polygon fill="lightgreen" stroke="black" points="6318,-647.95 6144,-647.95 6144,-564.95 6318,-564.95 6318,-647.95"/>
<text text-anchor="middle" x="6231" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU2</text>
<text text-anchor="middle" x="6231" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6231" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6231" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6231" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_gate_gpu2&#45;&gt;layer3_expert2_0 -->
<g id="edge1052" class="edge">
<title>layer3_gate_gpu2&#45;&gt;layer3_expert2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7644.8,-723.37C7348.21,-719.87 6595.59,-705.65 6328.29,-647.96"/>
<polygon fill="black" stroke="black" points="6328.74,-644.48 6318.22,-645.71 6327.22,-651.31 6328.74,-644.48"/>
</g>
<!-- layer3_expert2_1 -->
<g id="node633" class="node">
<title>layer3_expert2_1</title>
<polygon fill="lightgreen" stroke="black" points="6510,-647.95 6336,-647.95 6336,-564.95 6510,-564.95 6510,-647.95"/>
<text text-anchor="middle" x="6423" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU2</text>
<text text-anchor="middle" x="6423" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6423" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6423" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6423" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_gate_gpu2&#45;&gt;layer3_expert2_1 -->
<g id="edge1053" class="edge">
<title>layer3_gate_gpu2&#45;&gt;layer3_expert2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7644.82,-722.19C7377.95,-716.43 6749.25,-698.07 6520.17,-647.94"/>
<polygon fill="black" stroke="black" points="6520.75,-644.48 6510.22,-645.68 6519.2,-651.31 6520.75,-644.48"/>
</g>
<!-- layer3_expert2_2 -->
<g id="node634" class="node">
<title>layer3_expert2_2</title>
<polygon fill="lightgreen" stroke="black" points="6702,-647.95 6528,-647.95 6528,-564.95 6702,-564.95 6702,-647.95"/>
<text text-anchor="middle" x="6615" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU2</text>
<text text-anchor="middle" x="6615" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6615" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6615" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6615" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_gate_gpu2&#45;&gt;layer3_expert2_2 -->
<g id="edge1054" class="edge">
<title>layer3_gate_gpu2&#45;&gt;layer3_expert2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7644.92,-720.61C7410.28,-712.41 6903.38,-690.58 6712.19,-647.95"/>
<polygon fill="black" stroke="black" points="6712.77,-644.49 6702.23,-645.64 6711.19,-651.31 6712.77,-644.49"/>
</g>
<!-- layer3_expert2_3 -->
<g id="node635" class="node">
<title>layer3_expert2_3</title>
<polygon fill="lightgreen" stroke="black" points="6894,-647.95 6720,-647.95 6720,-564.95 6894,-564.95 6894,-647.95"/>
<text text-anchor="middle" x="6807" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU2</text>
<text text-anchor="middle" x="6807" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6807" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6807" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6807" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_gate_gpu2&#45;&gt;layer3_expert2_3 -->
<g id="edge1055" class="edge">
<title>layer3_gate_gpu2&#45;&gt;layer3_expert2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7644.77,-718.32C7445.25,-707.53 7057.31,-683.15 6904,-647.92"/>
<polygon fill="black" stroke="black" points="6904.79,-644.5 6894.25,-645.58 6903.16,-651.31 6904.79,-644.5"/>
</g>
<!-- layer3_expert2_4 -->
<g id="node636" class="node">
<title>layer3_expert2_4</title>
<polygon fill="lightgreen" stroke="black" points="7086,-647.95 6912,-647.95 6912,-564.95 7086,-564.95 7086,-647.95"/>
<text text-anchor="middle" x="6999" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU2</text>
<text text-anchor="middle" x="6999" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="6999" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="6999" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="6999" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_gate_gpu2&#45;&gt;layer3_expert2_4 -->
<g id="edge1056" class="edge">
<title>layer3_gate_gpu2&#45;&gt;layer3_expert2_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7644.91,-721C7511.03,-714.86 7290.46,-697.79 7095.84,-647.96"/>
<polygon fill="black" stroke="black" points="7096.57,-644.53 7086.01,-645.4 7094.81,-651.3 7096.57,-644.53"/>
</g>
<!-- layer3_expert2_5 -->
<g id="node637" class="node">
<title>layer3_expert2_5</title>
<polygon fill="lightgreen" stroke="black" points="7278,-647.95 7104,-647.95 7104,-564.95 7278,-564.95 7278,-647.95"/>
<text text-anchor="middle" x="7191" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU2</text>
<text text-anchor="middle" x="7191" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7191" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7191" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7191" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_gate_gpu2&#45;&gt;layer3_expert2_5 -->
<g id="edge1057" class="edge">
<title>layer3_gate_gpu2&#45;&gt;layer3_expert2_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7644.91,-713.21C7549.32,-702.51 7413.37,-683.09 7287.84,-648"/>
<polygon fill="black" stroke="black" points="7288.63,-644.59 7278.06,-645.23 7286.72,-651.32 7288.63,-644.59"/>
</g>
<!-- layer3_expert2_6 -->
<g id="node638" class="node">
<title>layer3_expert2_6</title>
<polygon fill="lightgreen" stroke="black" points="7470,-647.95 7296,-647.95 7296,-564.95 7470,-564.95 7470,-647.95"/>
<text text-anchor="middle" x="7383" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU2</text>
<text text-anchor="middle" x="7383" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7383" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7383" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7383" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_gate_gpu2&#45;&gt;layer3_expert2_6 -->
<g id="edge1058" class="edge">
<title>layer3_gate_gpu2&#45;&gt;layer3_expert2_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7644.66,-695.97C7595.66,-683.59 7538.72,-667.96 7479.67,-648.07"/>
<polygon fill="black" stroke="black" points="7480.77,-644.75 7470.18,-644.84 7478.52,-651.37 7480.77,-644.75"/>
</g>
<!-- layer3_expert2_7 -->
<g id="node639" class="node">
<title>layer3_expert2_7</title>
<polygon fill="lightgreen" stroke="black" points="7662,-647.95 7488,-647.95 7488,-564.95 7662,-564.95 7662,-647.95"/>
<text text-anchor="middle" x="7575" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU2</text>
<text text-anchor="middle" x="7575" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7575" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7575" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7575" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_gate_gpu2&#45;&gt;layer3_expert2_7 -->
<g id="edge1059" class="edge">
<title>layer3_gate_gpu2&#45;&gt;layer3_expert2_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7700.39,-683.86C7684.15,-673.97 7666.68,-663.32 7650.08,-653.21"/>
<polygon fill="black" stroke="black" points="7651.86,-650.19 7641.5,-647.97 7648.21,-656.17 7651.86,-650.19"/>
</g>
<!-- layer3_expert2_8 -->
<g id="node640" class="node">
<title>layer3_expert2_8</title>
<polygon fill="lightgreen" stroke="black" points="7854,-647.95 7680,-647.95 7680,-564.95 7854,-564.95 7854,-647.95"/>
<text text-anchor="middle" x="7767" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU2</text>
<text text-anchor="middle" x="7767" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7767" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7767" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7767" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_gate_gpu2&#45;&gt;layer3_expert2_8 -->
<g id="edge1060" class="edge">
<title>layer3_gate_gpu2&#45;&gt;layer3_expert2_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7767,-683.86C7767,-675.6 7767,-666.82 7767,-658.26"/>
<polygon fill="black" stroke="black" points="7770.5,-657.97 7767,-647.97 7763.5,-657.97 7770.5,-657.97"/>
</g>
<!-- layer3_expert2_9 -->
<g id="node641" class="node">
<title>layer3_expert2_9</title>
<polygon fill="lightgreen" stroke="black" points="8046,-647.95 7872,-647.95 7872,-564.95 8046,-564.95 8046,-647.95"/>
<text text-anchor="middle" x="7959" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU2</text>
<text text-anchor="middle" x="7959" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="7959" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="7959" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="7959" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_gate_gpu2&#45;&gt;layer3_expert2_9 -->
<g id="edge1061" class="edge">
<title>layer3_gate_gpu2&#45;&gt;layer3_expert2_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7833.61,-683.86C7849.85,-673.97 7867.32,-663.32 7883.92,-653.21"/>
<polygon fill="black" stroke="black" points="7885.79,-656.17 7892.5,-647.97 7882.14,-650.19 7885.79,-656.17"/>
</g>
<!-- layer3_expert2_10 -->
<g id="node642" class="node">
<title>layer3_expert2_10</title>
<polygon fill="lightgreen" stroke="black" points="8238,-647.95 8064,-647.95 8064,-564.95 8238,-564.95 8238,-647.95"/>
<text text-anchor="middle" x="8151" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU2</text>
<text text-anchor="middle" x="8151" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8151" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8151" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8151" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_gate_gpu2&#45;&gt;layer3_expert2_10 -->
<g id="edge1062" class="edge">
<title>layer3_gate_gpu2&#45;&gt;layer3_expert2_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7889.34,-695.97C7938.34,-683.59 7995.28,-667.96 8054.33,-648.07"/>
<polygon fill="black" stroke="black" points="8055.48,-651.37 8063.82,-644.84 8053.23,-644.75 8055.48,-651.37"/>
</g>
<!-- layer3_expert2_11 -->
<g id="node643" class="node">
<title>layer3_expert2_11</title>
<polygon fill="lightgreen" stroke="black" points="8430,-647.95 8256,-647.95 8256,-564.95 8430,-564.95 8430,-647.95"/>
<text text-anchor="middle" x="8343" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU2</text>
<text text-anchor="middle" x="8343" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8343" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8343" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8343" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_gate_gpu2&#45;&gt;layer3_expert2_11 -->
<g id="edge1063" class="edge">
<title>layer3_gate_gpu2&#45;&gt;layer3_expert2_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7889.09,-713.21C7984.68,-702.51 8120.63,-683.09 8246.16,-648"/>
<polygon fill="black" stroke="black" points="8247.28,-651.32 8255.94,-645.23 8245.37,-644.59 8247.28,-651.32"/>
</g>
<!-- layer3_expert2_12 -->
<g id="node644" class="node">
<title>layer3_expert2_12</title>
<polygon fill="lightgreen" stroke="black" points="8622,-647.95 8448,-647.95 8448,-564.95 8622,-564.95 8622,-647.95"/>
<text text-anchor="middle" x="8535" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU2</text>
<text text-anchor="middle" x="8535" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8535" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8535" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8535" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_gate_gpu2&#45;&gt;layer3_expert2_12 -->
<g id="edge1064" class="edge">
<title>layer3_gate_gpu2&#45;&gt;layer3_expert2_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7889.09,-721C8022.97,-714.86 8243.54,-697.79 8438.16,-647.96"/>
<polygon fill="black" stroke="black" points="8439.19,-651.3 8447.99,-645.4 8437.43,-644.53 8439.19,-651.3"/>
</g>
<!-- layer3_expert2_13 -->
<g id="node645" class="node">
<title>layer3_expert2_13</title>
<polygon fill="lightgreen" stroke="black" points="8814,-647.95 8640,-647.95 8640,-564.95 8814,-564.95 8814,-647.95"/>
<text text-anchor="middle" x="8727" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU2</text>
<text text-anchor="middle" x="8727" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8727" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8727" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8727" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_gate_gpu2&#45;&gt;layer3_expert2_13 -->
<g id="edge1065" class="edge">
<title>layer3_gate_gpu2&#45;&gt;layer3_expert2_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7889.23,-718.32C8088.75,-707.53 8476.69,-683.15 8630,-647.92"/>
<polygon fill="black" stroke="black" points="8630.84,-651.31 8639.75,-645.58 8629.21,-644.5 8630.84,-651.31"/>
</g>
<!-- layer3_expert2_14 -->
<g id="node646" class="node">
<title>layer3_expert2_14</title>
<polygon fill="lightgreen" stroke="black" points="9006,-647.95 8832,-647.95 8832,-564.95 9006,-564.95 9006,-647.95"/>
<text text-anchor="middle" x="8919" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU2</text>
<text text-anchor="middle" x="8919" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="8919" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="8919" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="8919" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_gate_gpu2&#45;&gt;layer3_expert2_14 -->
<g id="edge1066" class="edge">
<title>layer3_gate_gpu2&#45;&gt;layer3_expert2_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7889.08,-720.61C8123.72,-712.41 8630.62,-690.58 8821.81,-647.95"/>
<polygon fill="black" stroke="black" points="8822.81,-651.31 8831.77,-645.64 8821.23,-644.49 8822.81,-651.31"/>
</g>
<!-- layer3_expert2_15 -->
<g id="node647" class="node">
<title>layer3_expert2_15</title>
<polygon fill="lightgreen" stroke="black" points="9198,-647.95 9024,-647.95 9024,-564.95 9198,-564.95 9198,-647.95"/>
<text text-anchor="middle" x="9111" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU2</text>
<text text-anchor="middle" x="9111" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9111" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9111" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9111" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_gate_gpu2&#45;&gt;layer3_expert2_15 -->
<g id="edge1067" class="edge">
<title>layer3_gate_gpu2&#45;&gt;layer3_expert2_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7889.18,-722.19C8156.05,-716.43 8784.75,-698.07 9013.83,-647.94"/>
<polygon fill="black" stroke="black" points="9014.8,-651.31 9023.78,-645.68 9013.25,-644.48 9014.8,-651.31"/>
</g>
<!-- layer3_moe_agg_gpu2 -->
<g id="node648" class="node">
<title>layer3_moe_agg_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="7868.5,-528.95 7665.5,-528.95 7665.5,-460.95 7868.5,-460.95 7868.5,-528.95"/>
<text text-anchor="middle" x="7767" y="-513.75" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU2</text>
<text text-anchor="middle" x="7767" y="-498.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="7767" y="-483.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="7767" y="-468.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_expert2_0&#45;&gt;layer3_moe_agg_gpu2 -->
<g id="edge1068" class="edge">
<title>layer3_expert2_0&#45;&gt;layer3_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6318.21,-567.17C6321.16,-566.36 6324.09,-565.62 6327,-564.95 6579.13,-507.63 7362.27,-497.89 7655.05,-496.27"/>
<polygon fill="black" stroke="black" points="7655.27,-499.77 7665.25,-496.21 7655.24,-492.77 7655.27,-499.77"/>
</g>
<!-- layer3_expert2_1&#45;&gt;layer3_moe_agg_gpu2 -->
<g id="edge1069" class="edge">
<title>layer3_expert2_1&#45;&gt;layer3_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6510.22,-567.2C6513.16,-566.38 6516.09,-565.63 6519,-564.95 6733.24,-515.42 7390.44,-501.07 7654.97,-497.24"/>
<polygon fill="black" stroke="black" points="7655.41,-500.73 7665.36,-497.09 7655.31,-493.73 7655.41,-500.73"/>
</g>
<!-- layer3_expert2_2&#45;&gt;layer3_moe_agg_gpu2 -->
<g id="edge1070" class="edge">
<title>layer3_expert2_2&#45;&gt;layer3_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6702.23,-567.24C6705.17,-566.41 6708.1,-565.64 6711,-564.95 6887.72,-523.16 7421.22,-504.77 7655.09,-498.56"/>
<polygon fill="black" stroke="black" points="7655.42,-502.05 7665.32,-498.29 7655.23,-495.05 7655.42,-502.05"/>
</g>
<!-- layer3_expert2_3&#45;&gt;layer3_moe_agg_gpu2 -->
<g id="edge1071" class="edge">
<title>layer3_expert2_3&#45;&gt;layer3_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6894.24,-567.3C6897.18,-566.45 6900.1,-565.66 6903,-564.95 7042.55,-530.88 7454.54,-509.25 7654.96,-500.46"/>
<polygon fill="black" stroke="black" points="7655.39,-503.94 7665.22,-500.01 7655.08,-496.95 7655.39,-503.94"/>
</g>
<!-- layer3_expert2_4&#45;&gt;layer3_moe_agg_gpu2 -->
<g id="edge1072" class="edge">
<title>layer3_expert2_4&#45;&gt;layer3_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7086.26,-567.38C7089.19,-566.51 7092.11,-565.69 7095,-564.95 7287.8,-515.56 7520.29,-501.33 7655.12,-497.35"/>
<polygon fill="black" stroke="black" points="7655.56,-500.84 7665.46,-497.06 7655.37,-493.84 7655.56,-500.84"/>
</g>
<!-- layer3_expert2_5&#45;&gt;layer3_moe_agg_gpu2 -->
<g id="edge1073" class="edge">
<title>layer3_expert2_5&#45;&gt;layer3_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7278.04,-567.62C7281.04,-566.67 7284.04,-565.78 7287,-564.95 7410.52,-530.64 7556.92,-512.73 7655.28,-503.86"/>
<polygon fill="black" stroke="black" points="7655.59,-507.34 7665.24,-502.97 7654.97,-500.37 7655.59,-507.34"/>
</g>
<!-- layer3_expert2_6&#45;&gt;layer3_moe_agg_gpu2 -->
<g id="edge1074" class="edge">
<title>layer3_expert2_6&#45;&gt;layer3_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7470.15,-567.97C7473.12,-566.92 7476.08,-565.91 7479,-564.95 7536.25,-546.16 7601.45,-530.11 7655.32,-518.23"/>
<polygon fill="black" stroke="black" points="7656.22,-521.62 7665.24,-516.06 7654.72,-514.78 7656.22,-521.62"/>
</g>
<!-- layer3_expert2_7&#45;&gt;layer3_moe_agg_gpu2 -->
<g id="edge1075" class="edge">
<title>layer3_expert2_7&#45;&gt;layer3_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7646.22,-564.84C7663.85,-554.78 7682.68,-544.04 7700.1,-534.11"/>
<polygon fill="black" stroke="black" points="7702.11,-536.99 7709.06,-529 7698.64,-530.91 7702.11,-536.99"/>
</g>
<!-- layer3_expert2_8&#45;&gt;layer3_moe_agg_gpu2 -->
<g id="edge1076" class="edge">
<title>layer3_expert2_8&#45;&gt;layer3_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7767,-564.68C7767,-556.47 7767,-547.81 7767,-539.51"/>
<polygon fill="black" stroke="black" points="7770.5,-539.25 7767,-529.25 7763.5,-539.25 7770.5,-539.25"/>
</g>
<!-- layer3_expert2_9&#45;&gt;layer3_moe_agg_gpu2 -->
<g id="edge1077" class="edge">
<title>layer3_expert2_9&#45;&gt;layer3_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7887.78,-564.84C7870.15,-554.78 7851.32,-544.04 7833.9,-534.11"/>
<polygon fill="black" stroke="black" points="7835.36,-530.91 7824.94,-529 7831.89,-536.99 7835.36,-530.91"/>
</g>
<!-- layer3_expert2_10&#45;&gt;layer3_moe_agg_gpu2 -->
<g id="edge1078" class="edge">
<title>layer3_expert2_10&#45;&gt;layer3_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8063.85,-567.97C8060.88,-566.92 8057.92,-565.91 8055,-564.95 7997.75,-546.16 7932.55,-530.11 7878.68,-518.23"/>
<polygon fill="black" stroke="black" points="7879.28,-514.78 7868.76,-516.06 7877.78,-521.62 7879.28,-514.78"/>
</g>
<!-- layer3_expert2_11&#45;&gt;layer3_moe_agg_gpu2 -->
<g id="edge1079" class="edge">
<title>layer3_expert2_11&#45;&gt;layer3_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8255.96,-567.62C8252.96,-566.67 8249.96,-565.78 8247,-564.95 8123.48,-530.64 7977.08,-512.73 7878.72,-503.86"/>
<polygon fill="black" stroke="black" points="7879.03,-500.37 7868.76,-502.97 7878.41,-507.34 7879.03,-500.37"/>
</g>
<!-- layer3_expert2_12&#45;&gt;layer3_moe_agg_gpu2 -->
<g id="edge1080" class="edge">
<title>layer3_expert2_12&#45;&gt;layer3_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8447.74,-567.38C8444.81,-566.51 8441.89,-565.69 8439,-564.95 8246.2,-515.56 8013.71,-501.33 7878.88,-497.35"/>
<polygon fill="black" stroke="black" points="7878.63,-493.84 7868.54,-497.06 7878.44,-500.84 7878.63,-493.84"/>
</g>
<!-- layer3_expert2_13&#45;&gt;layer3_moe_agg_gpu2 -->
<g id="edge1081" class="edge">
<title>layer3_expert2_13&#45;&gt;layer3_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8639.76,-567.3C8636.82,-566.45 8633.9,-565.66 8631,-564.95 8491.45,-530.88 8079.46,-509.25 7879.04,-500.46"/>
<polygon fill="black" stroke="black" points="7878.92,-496.95 7868.78,-500.01 7878.61,-503.94 7878.92,-496.95"/>
</g>
<!-- layer3_expert2_14&#45;&gt;layer3_moe_agg_gpu2 -->
<g id="edge1082" class="edge">
<title>layer3_expert2_14&#45;&gt;layer3_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8831.77,-567.24C8828.83,-566.41 8825.9,-565.64 8823,-564.95 8646.28,-523.16 8112.78,-504.77 7878.91,-498.56"/>
<polygon fill="black" stroke="black" points="7878.77,-495.05 7868.68,-498.29 7878.58,-502.05 7878.77,-495.05"/>
</g>
<!-- layer3_expert2_15&#45;&gt;layer3_moe_agg_gpu2 -->
<g id="edge1083" class="edge">
<title>layer3_expert2_15&#45;&gt;layer3_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M9023.78,-567.2C9020.84,-566.38 9017.91,-565.63 9015,-564.95 8800.76,-515.42 8143.56,-501.07 7879.03,-497.24"/>
<polygon fill="black" stroke="black" points="7878.69,-493.73 7868.64,-497.09 7878.59,-500.73 7878.69,-493.73"/>
</g>
<!-- layer3_moe_agg_gpu2&#45;&gt;layer3_moe_allreduce -->
<g id="edge1084" class="edge">
<title>layer3_moe_agg_gpu2&#45;&gt;layer3_moe_allreduce</title>
<path fill="none" stroke="black" d="M7868.64,-490.89C8438.87,-473.7 11243.83,-389.16 12057.42,-364.63"/>
<polygon fill="black" stroke="black" points="12057.6,-368.13 12067.49,-364.33 12057.39,-361.13 12057.6,-368.13"/>
</g>
<!-- layer3_output_gpu2 -->
<g id="node649" class="node">
<title>layer3_output_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="12008,-252.95 11764,-252.95 11764,-184.95 12008,-184.95 12008,-252.95"/>
<text text-anchor="middle" x="11886" y="-237.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU2</text>
<text text-anchor="middle" x="11886" y="-222.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="11886" y="-207.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11886" y="-192.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_output_gpu2&#45;&gt;output -->
<g id="edge1283" class="edge">
<title>layer3_output_gpu2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M12008.19,-185.16C12051.96,-173.41 12101.5,-160.12 12146.13,-148.14"/>
<polygon fill="black" stroke="black" points="12147.12,-151.5 12155.87,-145.52 12145.3,-144.74 12147.12,-151.5"/>
</g>
<!-- layer3_expert3_0 -->
<g id="node651" class="node">
<title>layer3_expert3_0</title>
<polygon fill="lightgreen" stroke="black" points="9390,-647.95 9216,-647.95 9216,-564.95 9390,-564.95 9390,-647.95"/>
<text text-anchor="middle" x="9303" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU3</text>
<text text-anchor="middle" x="9303" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9303" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9303" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9303" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gate_gpu3&#45;&gt;layer3_expert3_0 -->
<g id="edge1091" class="edge">
<title>layer3_gate_gpu3&#45;&gt;layer3_expert3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10716.8,-723.37C10420.21,-719.87 9667.59,-705.65 9400.29,-647.96"/>
<polygon fill="black" stroke="black" points="9400.74,-644.48 9390.22,-645.71 9399.22,-651.31 9400.74,-644.48"/>
</g>
<!-- layer3_expert3_1 -->
<g id="node652" class="node">
<title>layer3_expert3_1</title>
<polygon fill="lightgreen" stroke="black" points="9582,-647.95 9408,-647.95 9408,-564.95 9582,-564.95 9582,-647.95"/>
<text text-anchor="middle" x="9495" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU3</text>
<text text-anchor="middle" x="9495" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9495" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9495" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9495" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gate_gpu3&#45;&gt;layer3_expert3_1 -->
<g id="edge1092" class="edge">
<title>layer3_gate_gpu3&#45;&gt;layer3_expert3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10716.82,-722.19C10449.95,-716.43 9821.25,-698.07 9592.17,-647.94"/>
<polygon fill="black" stroke="black" points="9592.75,-644.48 9582.22,-645.68 9591.2,-651.31 9592.75,-644.48"/>
</g>
<!-- layer3_expert3_2 -->
<g id="node653" class="node">
<title>layer3_expert3_2</title>
<polygon fill="lightgreen" stroke="black" points="9774,-647.95 9600,-647.95 9600,-564.95 9774,-564.95 9774,-647.95"/>
<text text-anchor="middle" x="9687" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU3</text>
<text text-anchor="middle" x="9687" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9687" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9687" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9687" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gate_gpu3&#45;&gt;layer3_expert3_2 -->
<g id="edge1093" class="edge">
<title>layer3_gate_gpu3&#45;&gt;layer3_expert3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10716.92,-720.61C10482.28,-712.41 9975.38,-690.58 9784.19,-647.95"/>
<polygon fill="black" stroke="black" points="9784.77,-644.49 9774.23,-645.64 9783.19,-651.31 9784.77,-644.49"/>
</g>
<!-- layer3_expert3_3 -->
<g id="node654" class="node">
<title>layer3_expert3_3</title>
<polygon fill="lightgreen" stroke="black" points="9966,-647.95 9792,-647.95 9792,-564.95 9966,-564.95 9966,-647.95"/>
<text text-anchor="middle" x="9879" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU3</text>
<text text-anchor="middle" x="9879" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="9879" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="9879" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="9879" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gate_gpu3&#45;&gt;layer3_expert3_3 -->
<g id="edge1094" class="edge">
<title>layer3_gate_gpu3&#45;&gt;layer3_expert3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10716.77,-718.32C10517.25,-707.53 10129.31,-683.15 9976,-647.92"/>
<polygon fill="black" stroke="black" points="9976.79,-644.5 9966.25,-645.58 9975.16,-651.31 9976.79,-644.5"/>
</g>
<!-- layer3_expert3_4 -->
<g id="node655" class="node">
<title>layer3_expert3_4</title>
<polygon fill="lightgreen" stroke="black" points="10158,-647.95 9984,-647.95 9984,-564.95 10158,-564.95 10158,-647.95"/>
<text text-anchor="middle" x="10071" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU3</text>
<text text-anchor="middle" x="10071" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10071" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10071" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10071" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gate_gpu3&#45;&gt;layer3_expert3_4 -->
<g id="edge1095" class="edge">
<title>layer3_gate_gpu3&#45;&gt;layer3_expert3_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10716.91,-721C10583.03,-714.86 10362.46,-697.79 10167.84,-647.96"/>
<polygon fill="black" stroke="black" points="10168.57,-644.53 10158.01,-645.4 10166.81,-651.3 10168.57,-644.53"/>
</g>
<!-- layer3_expert3_5 -->
<g id="node656" class="node">
<title>layer3_expert3_5</title>
<polygon fill="lightgreen" stroke="black" points="10350,-647.95 10176,-647.95 10176,-564.95 10350,-564.95 10350,-647.95"/>
<text text-anchor="middle" x="10263" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU3</text>
<text text-anchor="middle" x="10263" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10263" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10263" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10263" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gate_gpu3&#45;&gt;layer3_expert3_5 -->
<g id="edge1096" class="edge">
<title>layer3_gate_gpu3&#45;&gt;layer3_expert3_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10716.91,-713.21C10621.32,-702.51 10485.37,-683.09 10359.84,-648"/>
<polygon fill="black" stroke="black" points="10360.63,-644.59 10350.06,-645.23 10358.72,-651.32 10360.63,-644.59"/>
</g>
<!-- layer3_expert3_6 -->
<g id="node657" class="node">
<title>layer3_expert3_6</title>
<polygon fill="lightgreen" stroke="black" points="10542,-647.95 10368,-647.95 10368,-564.95 10542,-564.95 10542,-647.95"/>
<text text-anchor="middle" x="10455" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU3</text>
<text text-anchor="middle" x="10455" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10455" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10455" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10455" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gate_gpu3&#45;&gt;layer3_expert3_6 -->
<g id="edge1097" class="edge">
<title>layer3_gate_gpu3&#45;&gt;layer3_expert3_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10716.66,-695.97C10667.66,-683.59 10610.72,-667.96 10551.67,-648.07"/>
<polygon fill="black" stroke="black" points="10552.77,-644.75 10542.18,-644.84 10550.52,-651.37 10552.77,-644.75"/>
</g>
<!-- layer3_expert3_7 -->
<g id="node658" class="node">
<title>layer3_expert3_7</title>
<polygon fill="lightgreen" stroke="black" points="10734,-647.95 10560,-647.95 10560,-564.95 10734,-564.95 10734,-647.95"/>
<text text-anchor="middle" x="10647" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU3</text>
<text text-anchor="middle" x="10647" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10647" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10647" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10647" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gate_gpu3&#45;&gt;layer3_expert3_7 -->
<g id="edge1098" class="edge">
<title>layer3_gate_gpu3&#45;&gt;layer3_expert3_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10772.39,-683.86C10756.15,-673.97 10738.68,-663.32 10722.08,-653.21"/>
<polygon fill="black" stroke="black" points="10723.86,-650.19 10713.5,-647.97 10720.21,-656.17 10723.86,-650.19"/>
</g>
<!-- layer3_expert3_8 -->
<g id="node659" class="node">
<title>layer3_expert3_8</title>
<polygon fill="lightgreen" stroke="black" points="10926,-647.95 10752,-647.95 10752,-564.95 10926,-564.95 10926,-647.95"/>
<text text-anchor="middle" x="10839" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU3</text>
<text text-anchor="middle" x="10839" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="10839" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="10839" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="10839" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gate_gpu3&#45;&gt;layer3_expert3_8 -->
<g id="edge1099" class="edge">
<title>layer3_gate_gpu3&#45;&gt;layer3_expert3_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10839,-683.86C10839,-675.6 10839,-666.82 10839,-658.26"/>
<polygon fill="black" stroke="black" points="10842.5,-657.97 10839,-647.97 10835.5,-657.97 10842.5,-657.97"/>
</g>
<!-- layer3_expert3_9 -->
<g id="node660" class="node">
<title>layer3_expert3_9</title>
<polygon fill="lightgreen" stroke="black" points="11118,-647.95 10944,-647.95 10944,-564.95 11118,-564.95 11118,-647.95"/>
<text text-anchor="middle" x="11031" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU3</text>
<text text-anchor="middle" x="11031" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11031" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11031" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11031" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gate_gpu3&#45;&gt;layer3_expert3_9 -->
<g id="edge1100" class="edge">
<title>layer3_gate_gpu3&#45;&gt;layer3_expert3_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10905.61,-683.86C10921.85,-673.97 10939.32,-663.32 10955.92,-653.21"/>
<polygon fill="black" stroke="black" points="10957.79,-656.17 10964.5,-647.97 10954.14,-650.19 10957.79,-656.17"/>
</g>
<!-- layer3_expert3_10 -->
<g id="node661" class="node">
<title>layer3_expert3_10</title>
<polygon fill="lightgreen" stroke="black" points="11310,-647.95 11136,-647.95 11136,-564.95 11310,-564.95 11310,-647.95"/>
<text text-anchor="middle" x="11223" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU3</text>
<text text-anchor="middle" x="11223" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11223" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11223" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11223" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gate_gpu3&#45;&gt;layer3_expert3_10 -->
<g id="edge1101" class="edge">
<title>layer3_gate_gpu3&#45;&gt;layer3_expert3_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10961.34,-695.97C11010.34,-683.59 11067.28,-667.96 11126.33,-648.07"/>
<polygon fill="black" stroke="black" points="11127.48,-651.37 11135.82,-644.84 11125.23,-644.75 11127.48,-651.37"/>
</g>
<!-- layer3_expert3_11 -->
<g id="node662" class="node">
<title>layer3_expert3_11</title>
<polygon fill="lightgreen" stroke="black" points="11502,-647.95 11328,-647.95 11328,-564.95 11502,-564.95 11502,-647.95"/>
<text text-anchor="middle" x="11415" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU3</text>
<text text-anchor="middle" x="11415" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11415" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11415" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11415" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gate_gpu3&#45;&gt;layer3_expert3_11 -->
<g id="edge1102" class="edge">
<title>layer3_gate_gpu3&#45;&gt;layer3_expert3_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10961.09,-713.21C11056.68,-702.51 11192.63,-683.09 11318.16,-648"/>
<polygon fill="black" stroke="black" points="11319.28,-651.32 11327.94,-645.23 11317.37,-644.59 11319.28,-651.32"/>
</g>
<!-- layer3_expert3_12 -->
<g id="node663" class="node">
<title>layer3_expert3_12</title>
<polygon fill="lightgreen" stroke="black" points="11694,-647.95 11520,-647.95 11520,-564.95 11694,-564.95 11694,-647.95"/>
<text text-anchor="middle" x="11607" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU3</text>
<text text-anchor="middle" x="11607" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11607" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11607" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11607" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gate_gpu3&#45;&gt;layer3_expert3_12 -->
<g id="edge1103" class="edge">
<title>layer3_gate_gpu3&#45;&gt;layer3_expert3_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10961.09,-721C11094.97,-714.86 11315.54,-697.79 11510.16,-647.96"/>
<polygon fill="black" stroke="black" points="11511.19,-651.3 11519.99,-645.4 11509.43,-644.53 11511.19,-651.3"/>
</g>
<!-- layer3_expert3_13 -->
<g id="node664" class="node">
<title>layer3_expert3_13</title>
<polygon fill="lightgreen" stroke="black" points="11886,-647.95 11712,-647.95 11712,-564.95 11886,-564.95 11886,-647.95"/>
<text text-anchor="middle" x="11799" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU3</text>
<text text-anchor="middle" x="11799" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11799" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11799" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11799" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gate_gpu3&#45;&gt;layer3_expert3_13 -->
<g id="edge1104" class="edge">
<title>layer3_gate_gpu3&#45;&gt;layer3_expert3_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10961.23,-718.32C11160.75,-707.53 11548.69,-683.15 11702,-647.92"/>
<polygon fill="black" stroke="black" points="11702.84,-651.31 11711.75,-645.58 11701.21,-644.5 11702.84,-651.31"/>
</g>
<!-- layer3_expert3_14 -->
<g id="node665" class="node">
<title>layer3_expert3_14</title>
<polygon fill="lightgreen" stroke="black" points="12078,-647.95 11904,-647.95 11904,-564.95 12078,-564.95 12078,-647.95"/>
<text text-anchor="middle" x="11991" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU3</text>
<text text-anchor="middle" x="11991" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="11991" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="11991" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="11991" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gate_gpu3&#45;&gt;layer3_expert3_14 -->
<g id="edge1105" class="edge">
<title>layer3_gate_gpu3&#45;&gt;layer3_expert3_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10961.08,-720.61C11195.72,-712.41 11702.62,-690.58 11893.81,-647.95"/>
<polygon fill="black" stroke="black" points="11894.81,-651.31 11903.77,-645.64 11893.23,-644.49 11894.81,-651.31"/>
</g>
<!-- layer3_expert3_15 -->
<g id="node666" class="node">
<title>layer3_expert3_15</title>
<polygon fill="lightgreen" stroke="black" points="12270,-647.95 12096,-647.95 12096,-564.95 12270,-564.95 12270,-647.95"/>
<text text-anchor="middle" x="12183" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU3</text>
<text text-anchor="middle" x="12183" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12183" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12183" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12183" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gate_gpu3&#45;&gt;layer3_expert3_15 -->
<g id="edge1106" class="edge">
<title>layer3_gate_gpu3&#45;&gt;layer3_expert3_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10961.18,-722.19C11228.05,-716.43 11856.75,-698.07 12085.83,-647.94"/>
<polygon fill="black" stroke="black" points="12086.8,-651.31 12095.78,-645.68 12085.25,-644.48 12086.8,-651.31"/>
</g>
<!-- layer3_moe_agg_gpu3 -->
<g id="node667" class="node">
<title>layer3_moe_agg_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="10940.5,-528.95 10737.5,-528.95 10737.5,-460.95 10940.5,-460.95 10940.5,-528.95"/>
<text text-anchor="middle" x="10839" y="-513.75" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU3</text>
<text text-anchor="middle" x="10839" y="-498.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="10839" y="-483.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="10839" y="-468.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_expert3_0&#45;&gt;layer3_moe_agg_gpu3 -->
<g id="edge1107" class="edge">
<title>layer3_expert3_0&#45;&gt;layer3_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9390.21,-567.17C9393.16,-566.36 9396.09,-565.62 9399,-564.95 9651.13,-507.63 10434.27,-497.89 10727.05,-496.27"/>
<polygon fill="black" stroke="black" points="10727.27,-499.77 10737.25,-496.21 10727.24,-492.77 10727.27,-499.77"/>
</g>
<!-- layer3_expert3_1&#45;&gt;layer3_moe_agg_gpu3 -->
<g id="edge1108" class="edge">
<title>layer3_expert3_1&#45;&gt;layer3_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9582.22,-567.2C9585.16,-566.38 9588.09,-565.63 9591,-564.95 9805.24,-515.42 10462.44,-501.07 10726.97,-497.24"/>
<polygon fill="black" stroke="black" points="10727.41,-500.73 10737.36,-497.09 10727.31,-493.73 10727.41,-500.73"/>
</g>
<!-- layer3_expert3_2&#45;&gt;layer3_moe_agg_gpu3 -->
<g id="edge1109" class="edge">
<title>layer3_expert3_2&#45;&gt;layer3_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9774.23,-567.24C9777.17,-566.41 9780.1,-565.64 9783,-564.95 9959.72,-523.16 10493.22,-504.77 10727.09,-498.56"/>
<polygon fill="black" stroke="black" points="10727.42,-502.05 10737.32,-498.29 10727.23,-495.05 10727.42,-502.05"/>
</g>
<!-- layer3_expert3_3&#45;&gt;layer3_moe_agg_gpu3 -->
<g id="edge1110" class="edge">
<title>layer3_expert3_3&#45;&gt;layer3_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9966.24,-567.3C9969.18,-566.45 9972.1,-565.66 9975,-564.95 10114.55,-530.88 10526.54,-509.25 10726.96,-500.46"/>
<polygon fill="black" stroke="black" points="10727.39,-503.94 10737.22,-500.01 10727.08,-496.95 10727.39,-503.94"/>
</g>
<!-- layer3_expert3_4&#45;&gt;layer3_moe_agg_gpu3 -->
<g id="edge1111" class="edge">
<title>layer3_expert3_4&#45;&gt;layer3_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10158.26,-567.38C10161.19,-566.51 10164.11,-565.69 10167,-564.95 10359.8,-515.56 10592.29,-501.33 10727.12,-497.35"/>
<polygon fill="black" stroke="black" points="10727.56,-500.84 10737.46,-497.06 10727.37,-493.84 10727.56,-500.84"/>
</g>
<!-- layer3_expert3_5&#45;&gt;layer3_moe_agg_gpu3 -->
<g id="edge1112" class="edge">
<title>layer3_expert3_5&#45;&gt;layer3_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10350.04,-567.62C10353.04,-566.67 10356.04,-565.78 10359,-564.95 10482.52,-530.64 10628.92,-512.73 10727.28,-503.86"/>
<polygon fill="black" stroke="black" points="10727.59,-507.34 10737.24,-502.97 10726.97,-500.37 10727.59,-507.34"/>
</g>
<!-- layer3_expert3_6&#45;&gt;layer3_moe_agg_gpu3 -->
<g id="edge1113" class="edge">
<title>layer3_expert3_6&#45;&gt;layer3_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10542.15,-567.97C10545.12,-566.92 10548.08,-565.91 10551,-564.95 10608.25,-546.16 10673.45,-530.11 10727.32,-518.23"/>
<polygon fill="black" stroke="black" points="10728.22,-521.62 10737.24,-516.06 10726.72,-514.78 10728.22,-521.62"/>
</g>
<!-- layer3_expert3_7&#45;&gt;layer3_moe_agg_gpu3 -->
<g id="edge1114" class="edge">
<title>layer3_expert3_7&#45;&gt;layer3_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10718.22,-564.84C10735.85,-554.78 10754.68,-544.04 10772.1,-534.11"/>
<polygon fill="black" stroke="black" points="10774.11,-536.99 10781.06,-529 10770.64,-530.91 10774.11,-536.99"/>
</g>
<!-- layer3_expert3_8&#45;&gt;layer3_moe_agg_gpu3 -->
<g id="edge1115" class="edge">
<title>layer3_expert3_8&#45;&gt;layer3_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10839,-564.68C10839,-556.47 10839,-547.81 10839,-539.51"/>
<polygon fill="black" stroke="black" points="10842.5,-539.25 10839,-529.25 10835.5,-539.25 10842.5,-539.25"/>
</g>
<!-- layer3_expert3_9&#45;&gt;layer3_moe_agg_gpu3 -->
<g id="edge1116" class="edge">
<title>layer3_expert3_9&#45;&gt;layer3_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10959.78,-564.84C10942.15,-554.78 10923.32,-544.04 10905.9,-534.11"/>
<polygon fill="black" stroke="black" points="10907.36,-530.91 10896.94,-529 10903.89,-536.99 10907.36,-530.91"/>
</g>
<!-- layer3_expert3_10&#45;&gt;layer3_moe_agg_gpu3 -->
<g id="edge1117" class="edge">
<title>layer3_expert3_10&#45;&gt;layer3_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11135.85,-567.97C11132.88,-566.92 11129.92,-565.91 11127,-564.95 11069.75,-546.16 11004.55,-530.11 10950.68,-518.23"/>
<polygon fill="black" stroke="black" points="10951.28,-514.78 10940.76,-516.06 10949.78,-521.62 10951.28,-514.78"/>
</g>
<!-- layer3_expert3_11&#45;&gt;layer3_moe_agg_gpu3 -->
<g id="edge1118" class="edge">
<title>layer3_expert3_11&#45;&gt;layer3_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11327.96,-567.62C11324.96,-566.67 11321.96,-565.78 11319,-564.95 11195.48,-530.64 11049.08,-512.73 10950.72,-503.86"/>
<polygon fill="black" stroke="black" points="10951.03,-500.37 10940.76,-502.97 10950.41,-507.34 10951.03,-500.37"/>
</g>
<!-- layer3_expert3_12&#45;&gt;layer3_moe_agg_gpu3 -->
<g id="edge1119" class="edge">
<title>layer3_expert3_12&#45;&gt;layer3_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11519.74,-567.38C11516.81,-566.51 11513.89,-565.69 11511,-564.95 11318.2,-515.56 11085.71,-501.33 10950.88,-497.35"/>
<polygon fill="black" stroke="black" points="10950.63,-493.84 10940.54,-497.06 10950.44,-500.84 10950.63,-493.84"/>
</g>
<!-- layer3_expert3_13&#45;&gt;layer3_moe_agg_gpu3 -->
<g id="edge1120" class="edge">
<title>layer3_expert3_13&#45;&gt;layer3_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11711.76,-567.3C11708.82,-566.45 11705.9,-565.66 11703,-564.95 11563.45,-530.88 11151.46,-509.25 10951.04,-500.46"/>
<polygon fill="black" stroke="black" points="10950.92,-496.95 10940.78,-500.01 10950.61,-503.94 10950.92,-496.95"/>
</g>
<!-- layer3_expert3_14&#45;&gt;layer3_moe_agg_gpu3 -->
<g id="edge1121" class="edge">
<title>layer3_expert3_14&#45;&gt;layer3_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11903.77,-567.24C11900.83,-566.41 11897.9,-565.64 11895,-564.95 11718.28,-523.16 11184.78,-504.77 10950.91,-498.56"/>
<polygon fill="black" stroke="black" points="10950.77,-495.05 10940.68,-498.29 10950.58,-502.05 10950.77,-495.05"/>
</g>
<!-- layer3_expert3_15&#45;&gt;layer3_moe_agg_gpu3 -->
<g id="edge1122" class="edge">
<title>layer3_expert3_15&#45;&gt;layer3_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M12095.78,-567.2C12092.84,-566.38 12089.91,-565.63 12087,-564.95 11872.76,-515.42 11215.56,-501.07 10951.03,-497.24"/>
<polygon fill="black" stroke="black" points="10950.69,-493.73 10940.64,-497.09 10950.59,-500.73 10950.69,-493.73"/>
</g>
<!-- layer3_moe_agg_gpu3&#45;&gt;layer3_moe_allreduce -->
<g id="edge1123" class="edge">
<title>layer3_moe_agg_gpu3&#45;&gt;layer3_moe_allreduce</title>
<path fill="none" stroke="black" d="M10940.54,-484.36C11180.43,-461.71 11785.11,-404.6 12092.86,-375.53"/>
<polygon fill="black" stroke="black" points="12093.6,-378.98 12103.23,-374.55 12092.95,-372.01 12093.6,-378.98"/>
</g>
<!-- layer3_output_gpu3 -->
<g id="node668" class="node">
<title>layer3_output_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="12270,-252.95 12026,-252.95 12026,-184.95 12270,-184.95 12270,-252.95"/>
<text text-anchor="middle" x="12148" y="-237.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU3</text>
<text text-anchor="middle" x="12148" y="-222.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="12148" y="-207.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12148" y="-192.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_output_gpu3&#45;&gt;output -->
<g id="edge1284" class="edge">
<title>layer3_output_gpu3&#45;&gt;output</title>
<path fill="none" stroke="black" d="M12189.09,-184.87C12200.78,-175.45 12213.69,-165.06 12225.99,-155.16"/>
<polygon fill="black" stroke="black" points="12228.37,-157.74 12233.96,-148.74 12223.98,-152.29 12228.37,-157.74"/>
</g>
<!-- layer3_expert4_0 -->
<g id="node670" class="node">
<title>layer3_expert4_0</title>
<polygon fill="lightgreen" stroke="black" points="12462,-647.95 12288,-647.95 12288,-564.95 12462,-564.95 12462,-647.95"/>
<text text-anchor="middle" x="12375" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU4</text>
<text text-anchor="middle" x="12375" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12375" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12375" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12375" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_gate_gpu4&#45;&gt;layer3_expert4_0 -->
<g id="edge1130" class="edge">
<title>layer3_gate_gpu4&#45;&gt;layer3_expert4_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13596.82,-722.19C13329.95,-716.43 12701.25,-698.07 12472.17,-647.94"/>
<polygon fill="black" stroke="black" points="12472.75,-644.48 12462.22,-645.68 12471.2,-651.31 12472.75,-644.48"/>
</g>
<!-- layer3_expert4_1 -->
<g id="node671" class="node">
<title>layer3_expert4_1</title>
<polygon fill="lightgreen" stroke="black" points="12654,-647.95 12480,-647.95 12480,-564.95 12654,-564.95 12654,-647.95"/>
<text text-anchor="middle" x="12567" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU4</text>
<text text-anchor="middle" x="12567" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12567" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12567" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12567" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_gate_gpu4&#45;&gt;layer3_expert4_1 -->
<g id="edge1131" class="edge">
<title>layer3_gate_gpu4&#45;&gt;layer3_expert4_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13596.92,-720.61C13362.28,-712.41 12855.38,-690.58 12664.19,-647.95"/>
<polygon fill="black" stroke="black" points="12664.77,-644.49 12654.23,-645.64 12663.19,-651.31 12664.77,-644.49"/>
</g>
<!-- layer3_expert4_2 -->
<g id="node672" class="node">
<title>layer3_expert4_2</title>
<polygon fill="lightgreen" stroke="black" points="12846,-647.95 12672,-647.95 12672,-564.95 12846,-564.95 12846,-647.95"/>
<text text-anchor="middle" x="12759" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU4</text>
<text text-anchor="middle" x="12759" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12759" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12759" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12759" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_gate_gpu4&#45;&gt;layer3_expert4_2 -->
<g id="edge1132" class="edge">
<title>layer3_gate_gpu4&#45;&gt;layer3_expert4_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13596.77,-718.32C13397.25,-707.53 13009.31,-683.15 12856,-647.92"/>
<polygon fill="black" stroke="black" points="12856.79,-644.5 12846.25,-645.58 12855.16,-651.31 12856.79,-644.5"/>
</g>
<!-- layer3_expert4_3 -->
<g id="node673" class="node">
<title>layer3_expert4_3</title>
<polygon fill="lightgreen" stroke="black" points="13038,-647.95 12864,-647.95 12864,-564.95 13038,-564.95 13038,-647.95"/>
<text text-anchor="middle" x="12951" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU4</text>
<text text-anchor="middle" x="12951" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="12951" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="12951" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="12951" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_gate_gpu4&#45;&gt;layer3_expert4_3 -->
<g id="edge1133" class="edge">
<title>layer3_gate_gpu4&#45;&gt;layer3_expert4_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13596.91,-721C13463.03,-714.86 13242.46,-697.79 13047.84,-647.96"/>
<polygon fill="black" stroke="black" points="13048.57,-644.53 13038.01,-645.4 13046.81,-651.3 13048.57,-644.53"/>
</g>
<!-- layer3_expert4_4 -->
<g id="node674" class="node">
<title>layer3_expert4_4</title>
<polygon fill="lightgreen" stroke="black" points="13230,-647.95 13056,-647.95 13056,-564.95 13230,-564.95 13230,-647.95"/>
<text text-anchor="middle" x="13143" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU4</text>
<text text-anchor="middle" x="13143" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13143" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13143" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13143" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_gate_gpu4&#45;&gt;layer3_expert4_4 -->
<g id="edge1134" class="edge">
<title>layer3_gate_gpu4&#45;&gt;layer3_expert4_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13596.91,-713.21C13501.32,-702.51 13365.37,-683.09 13239.84,-648"/>
<polygon fill="black" stroke="black" points="13240.63,-644.59 13230.06,-645.23 13238.72,-651.32 13240.63,-644.59"/>
</g>
<!-- layer3_expert4_5 -->
<g id="node675" class="node">
<title>layer3_expert4_5</title>
<polygon fill="lightgreen" stroke="black" points="13422,-647.95 13248,-647.95 13248,-564.95 13422,-564.95 13422,-647.95"/>
<text text-anchor="middle" x="13335" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU4</text>
<text text-anchor="middle" x="13335" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13335" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13335" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13335" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_gate_gpu4&#45;&gt;layer3_expert4_5 -->
<g id="edge1135" class="edge">
<title>layer3_gate_gpu4&#45;&gt;layer3_expert4_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13596.66,-695.97C13547.66,-683.59 13490.72,-667.96 13431.67,-648.07"/>
<polygon fill="black" stroke="black" points="13432.77,-644.75 13422.18,-644.84 13430.52,-651.37 13432.77,-644.75"/>
</g>
<!-- layer3_expert4_6 -->
<g id="node676" class="node">
<title>layer3_expert4_6</title>
<polygon fill="lightgreen" stroke="black" points="13614,-647.95 13440,-647.95 13440,-564.95 13614,-564.95 13614,-647.95"/>
<text text-anchor="middle" x="13527" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU4</text>
<text text-anchor="middle" x="13527" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13527" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13527" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13527" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_gate_gpu4&#45;&gt;layer3_expert4_6 -->
<g id="edge1136" class="edge">
<title>layer3_gate_gpu4&#45;&gt;layer3_expert4_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13652.39,-683.86C13636.15,-673.97 13618.68,-663.32 13602.08,-653.21"/>
<polygon fill="black" stroke="black" points="13603.86,-650.19 13593.5,-647.97 13600.21,-656.17 13603.86,-650.19"/>
</g>
<!-- layer3_expert4_7 -->
<g id="node677" class="node">
<title>layer3_expert4_7</title>
<polygon fill="lightgreen" stroke="black" points="13806,-647.95 13632,-647.95 13632,-564.95 13806,-564.95 13806,-647.95"/>
<text text-anchor="middle" x="13719" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU4</text>
<text text-anchor="middle" x="13719" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13719" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13719" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13719" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_gate_gpu4&#45;&gt;layer3_expert4_7 -->
<g id="edge1137" class="edge">
<title>layer3_gate_gpu4&#45;&gt;layer3_expert4_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13719,-683.86C13719,-675.6 13719,-666.82 13719,-658.26"/>
<polygon fill="black" stroke="black" points="13722.5,-657.97 13719,-647.97 13715.5,-657.97 13722.5,-657.97"/>
</g>
<!-- layer3_expert4_8 -->
<g id="node678" class="node">
<title>layer3_expert4_8</title>
<polygon fill="lightgreen" stroke="black" points="13998,-647.95 13824,-647.95 13824,-564.95 13998,-564.95 13998,-647.95"/>
<text text-anchor="middle" x="13911" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU4</text>
<text text-anchor="middle" x="13911" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="13911" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="13911" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="13911" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_gate_gpu4&#45;&gt;layer3_expert4_8 -->
<g id="edge1138" class="edge">
<title>layer3_gate_gpu4&#45;&gt;layer3_expert4_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13785.61,-683.86C13801.85,-673.97 13819.32,-663.32 13835.92,-653.21"/>
<polygon fill="black" stroke="black" points="13837.79,-656.17 13844.5,-647.97 13834.14,-650.19 13837.79,-656.17"/>
</g>
<!-- layer3_expert4_9 -->
<g id="node679" class="node">
<title>layer3_expert4_9</title>
<polygon fill="lightgreen" stroke="black" points="14190,-647.95 14016,-647.95 14016,-564.95 14190,-564.95 14190,-647.95"/>
<text text-anchor="middle" x="14103" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU4</text>
<text text-anchor="middle" x="14103" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14103" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14103" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14103" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_gate_gpu4&#45;&gt;layer3_expert4_9 -->
<g id="edge1139" class="edge">
<title>layer3_gate_gpu4&#45;&gt;layer3_expert4_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13841.34,-695.97C13890.34,-683.59 13947.28,-667.96 14006.33,-648.07"/>
<polygon fill="black" stroke="black" points="14007.48,-651.37 14015.82,-644.84 14005.23,-644.75 14007.48,-651.37"/>
</g>
<!-- layer3_expert4_10 -->
<g id="node680" class="node">
<title>layer3_expert4_10</title>
<polygon fill="lightgreen" stroke="black" points="14382,-647.95 14208,-647.95 14208,-564.95 14382,-564.95 14382,-647.95"/>
<text text-anchor="middle" x="14295" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU4</text>
<text text-anchor="middle" x="14295" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14295" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14295" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14295" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_gate_gpu4&#45;&gt;layer3_expert4_10 -->
<g id="edge1140" class="edge">
<title>layer3_gate_gpu4&#45;&gt;layer3_expert4_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13841.09,-713.21C13936.68,-702.51 14072.63,-683.09 14198.16,-648"/>
<polygon fill="black" stroke="black" points="14199.28,-651.32 14207.94,-645.23 14197.37,-644.59 14199.28,-651.32"/>
</g>
<!-- layer3_expert4_11 -->
<g id="node681" class="node">
<title>layer3_expert4_11</title>
<polygon fill="lightgreen" stroke="black" points="14574,-647.95 14400,-647.95 14400,-564.95 14574,-564.95 14574,-647.95"/>
<text text-anchor="middle" x="14487" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU4</text>
<text text-anchor="middle" x="14487" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14487" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14487" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14487" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_gate_gpu4&#45;&gt;layer3_expert4_11 -->
<g id="edge1141" class="edge">
<title>layer3_gate_gpu4&#45;&gt;layer3_expert4_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13841.09,-721C13974.97,-714.86 14195.54,-697.79 14390.16,-647.96"/>
<polygon fill="black" stroke="black" points="14391.19,-651.3 14399.99,-645.4 14389.43,-644.53 14391.19,-651.3"/>
</g>
<!-- layer3_expert4_12 -->
<g id="node682" class="node">
<title>layer3_expert4_12</title>
<polygon fill="lightgreen" stroke="black" points="14766,-647.95 14592,-647.95 14592,-564.95 14766,-564.95 14766,-647.95"/>
<text text-anchor="middle" x="14679" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU4</text>
<text text-anchor="middle" x="14679" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14679" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14679" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14679" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_gate_gpu4&#45;&gt;layer3_expert4_12 -->
<g id="edge1142" class="edge">
<title>layer3_gate_gpu4&#45;&gt;layer3_expert4_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13841.23,-718.32C14040.75,-707.53 14428.69,-683.15 14582,-647.92"/>
<polygon fill="black" stroke="black" points="14582.84,-651.31 14591.75,-645.58 14581.21,-644.5 14582.84,-651.31"/>
</g>
<!-- layer3_expert4_13 -->
<g id="node683" class="node">
<title>layer3_expert4_13</title>
<polygon fill="lightgreen" stroke="black" points="14958,-647.95 14784,-647.95 14784,-564.95 14958,-564.95 14958,-647.95"/>
<text text-anchor="middle" x="14871" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU4</text>
<text text-anchor="middle" x="14871" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="14871" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="14871" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="14871" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_gate_gpu4&#45;&gt;layer3_expert4_13 -->
<g id="edge1143" class="edge">
<title>layer3_gate_gpu4&#45;&gt;layer3_expert4_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13841.08,-720.61C14075.72,-712.41 14582.62,-690.58 14773.81,-647.95"/>
<polygon fill="black" stroke="black" points="14774.81,-651.31 14783.77,-645.64 14773.23,-644.49 14774.81,-651.31"/>
</g>
<!-- layer3_expert4_14 -->
<g id="node684" class="node">
<title>layer3_expert4_14</title>
<polygon fill="lightgreen" stroke="black" points="15150,-647.95 14976,-647.95 14976,-564.95 15150,-564.95 15150,-647.95"/>
<text text-anchor="middle" x="15063" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU4</text>
<text text-anchor="middle" x="15063" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15063" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15063" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15063" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_gate_gpu4&#45;&gt;layer3_expert4_14 -->
<g id="edge1144" class="edge">
<title>layer3_gate_gpu4&#45;&gt;layer3_expert4_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13841.18,-722.19C14108.05,-716.43 14736.75,-698.07 14965.83,-647.94"/>
<polygon fill="black" stroke="black" points="14966.8,-651.31 14975.78,-645.68 14965.25,-644.48 14966.8,-651.31"/>
</g>
<!-- layer3_expert4_15 -->
<g id="node685" class="node">
<title>layer3_expert4_15</title>
<polygon fill="lightgreen" stroke="black" points="15342,-647.95 15168,-647.95 15168,-564.95 15342,-564.95 15342,-647.95"/>
<text text-anchor="middle" x="15255" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU4</text>
<text text-anchor="middle" x="15255" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15255" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15255" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15255" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_gate_gpu4&#45;&gt;layer3_expert4_15 -->
<g id="edge1145" class="edge">
<title>layer3_gate_gpu4&#45;&gt;layer3_expert4_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13841.2,-723.37C14137.79,-719.87 14890.41,-705.65 15157.71,-647.96"/>
<polygon fill="black" stroke="black" points="15158.78,-651.31 15167.78,-645.71 15157.26,-644.48 15158.78,-651.31"/>
</g>
<!-- layer3_moe_agg_gpu4 -->
<g id="node686" class="node">
<title>layer3_moe_agg_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13820.5,-528.95 13617.5,-528.95 13617.5,-460.95 13820.5,-460.95 13820.5,-528.95"/>
<text text-anchor="middle" x="13719" y="-513.75" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU4</text>
<text text-anchor="middle" x="13719" y="-498.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="13719" y="-483.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="13719" y="-468.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_expert4_0&#45;&gt;layer3_moe_agg_gpu4 -->
<g id="edge1146" class="edge">
<title>layer3_expert4_0&#45;&gt;layer3_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M12462.22,-567.2C12465.16,-566.38 12468.09,-565.63 12471,-564.95 12685.24,-515.42 13342.44,-501.07 13606.97,-497.24"/>
<polygon fill="black" stroke="black" points="13607.41,-500.73 13617.36,-497.09 13607.31,-493.73 13607.41,-500.73"/>
</g>
<!-- layer3_expert4_1&#45;&gt;layer3_moe_agg_gpu4 -->
<g id="edge1147" class="edge">
<title>layer3_expert4_1&#45;&gt;layer3_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M12654.23,-567.24C12657.17,-566.41 12660.1,-565.64 12663,-564.95 12839.72,-523.16 13373.22,-504.77 13607.09,-498.56"/>
<polygon fill="black" stroke="black" points="13607.42,-502.05 13617.32,-498.29 13607.23,-495.05 13607.42,-502.05"/>
</g>
<!-- layer3_expert4_2&#45;&gt;layer3_moe_agg_gpu4 -->
<g id="edge1148" class="edge">
<title>layer3_expert4_2&#45;&gt;layer3_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M12846.24,-567.3C12849.18,-566.45 12852.1,-565.66 12855,-564.95 12994.55,-530.88 13406.54,-509.25 13606.96,-500.46"/>
<polygon fill="black" stroke="black" points="13607.39,-503.94 13617.22,-500.01 13607.08,-496.95 13607.39,-503.94"/>
</g>
<!-- layer3_expert4_3&#45;&gt;layer3_moe_agg_gpu4 -->
<g id="edge1149" class="edge">
<title>layer3_expert4_3&#45;&gt;layer3_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13038.26,-567.38C13041.19,-566.51 13044.11,-565.69 13047,-564.95 13239.8,-515.56 13472.29,-501.33 13607.12,-497.35"/>
<polygon fill="black" stroke="black" points="13607.56,-500.84 13617.46,-497.06 13607.37,-493.84 13607.56,-500.84"/>
</g>
<!-- layer3_expert4_4&#45;&gt;layer3_moe_agg_gpu4 -->
<g id="edge1150" class="edge">
<title>layer3_expert4_4&#45;&gt;layer3_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13230.04,-567.62C13233.04,-566.67 13236.04,-565.78 13239,-564.95 13362.52,-530.64 13508.92,-512.73 13607.28,-503.86"/>
<polygon fill="black" stroke="black" points="13607.59,-507.34 13617.24,-502.97 13606.97,-500.37 13607.59,-507.34"/>
</g>
<!-- layer3_expert4_5&#45;&gt;layer3_moe_agg_gpu4 -->
<g id="edge1151" class="edge">
<title>layer3_expert4_5&#45;&gt;layer3_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13422.15,-567.97C13425.12,-566.92 13428.08,-565.91 13431,-564.95 13488.25,-546.16 13553.45,-530.11 13607.32,-518.23"/>
<polygon fill="black" stroke="black" points="13608.22,-521.62 13617.24,-516.06 13606.72,-514.78 13608.22,-521.62"/>
</g>
<!-- layer3_expert4_6&#45;&gt;layer3_moe_agg_gpu4 -->
<g id="edge1152" class="edge">
<title>layer3_expert4_6&#45;&gt;layer3_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13598.22,-564.84C13615.85,-554.78 13634.68,-544.04 13652.1,-534.11"/>
<polygon fill="black" stroke="black" points="13654.11,-536.99 13661.06,-529 13650.64,-530.91 13654.11,-536.99"/>
</g>
<!-- layer3_expert4_7&#45;&gt;layer3_moe_agg_gpu4 -->
<g id="edge1153" class="edge">
<title>layer3_expert4_7&#45;&gt;layer3_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13719,-564.68C13719,-556.47 13719,-547.81 13719,-539.51"/>
<polygon fill="black" stroke="black" points="13722.5,-539.25 13719,-529.25 13715.5,-539.25 13722.5,-539.25"/>
</g>
<!-- layer3_expert4_8&#45;&gt;layer3_moe_agg_gpu4 -->
<g id="edge1154" class="edge">
<title>layer3_expert4_8&#45;&gt;layer3_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13839.78,-564.84C13822.15,-554.78 13803.32,-544.04 13785.9,-534.11"/>
<polygon fill="black" stroke="black" points="13787.36,-530.91 13776.94,-529 13783.89,-536.99 13787.36,-530.91"/>
</g>
<!-- layer3_expert4_9&#45;&gt;layer3_moe_agg_gpu4 -->
<g id="edge1155" class="edge">
<title>layer3_expert4_9&#45;&gt;layer3_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14015.85,-567.97C14012.88,-566.92 14009.92,-565.91 14007,-564.95 13949.75,-546.16 13884.55,-530.11 13830.68,-518.23"/>
<polygon fill="black" stroke="black" points="13831.28,-514.78 13820.76,-516.06 13829.78,-521.62 13831.28,-514.78"/>
</g>
<!-- layer3_expert4_10&#45;&gt;layer3_moe_agg_gpu4 -->
<g id="edge1156" class="edge">
<title>layer3_expert4_10&#45;&gt;layer3_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14207.96,-567.62C14204.96,-566.67 14201.96,-565.78 14199,-564.95 14075.48,-530.64 13929.08,-512.73 13830.72,-503.86"/>
<polygon fill="black" stroke="black" points="13831.03,-500.37 13820.76,-502.97 13830.41,-507.34 13831.03,-500.37"/>
</g>
<!-- layer3_expert4_11&#45;&gt;layer3_moe_agg_gpu4 -->
<g id="edge1157" class="edge">
<title>layer3_expert4_11&#45;&gt;layer3_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14399.74,-567.38C14396.81,-566.51 14393.89,-565.69 14391,-564.95 14198.2,-515.56 13965.71,-501.33 13830.88,-497.35"/>
<polygon fill="black" stroke="black" points="13830.63,-493.84 13820.54,-497.06 13830.44,-500.84 13830.63,-493.84"/>
</g>
<!-- layer3_expert4_12&#45;&gt;layer3_moe_agg_gpu4 -->
<g id="edge1158" class="edge">
<title>layer3_expert4_12&#45;&gt;layer3_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14591.76,-567.3C14588.82,-566.45 14585.9,-565.66 14583,-564.95 14443.45,-530.88 14031.46,-509.25 13831.04,-500.46"/>
<polygon fill="black" stroke="black" points="13830.92,-496.95 13820.78,-500.01 13830.61,-503.94 13830.92,-496.95"/>
</g>
<!-- layer3_expert4_13&#45;&gt;layer3_moe_agg_gpu4 -->
<g id="edge1159" class="edge">
<title>layer3_expert4_13&#45;&gt;layer3_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14783.77,-567.24C14780.83,-566.41 14777.9,-565.64 14775,-564.95 14598.28,-523.16 14064.78,-504.77 13830.91,-498.56"/>
<polygon fill="black" stroke="black" points="13830.77,-495.05 13820.68,-498.29 13830.58,-502.05 13830.77,-495.05"/>
</g>
<!-- layer3_expert4_14&#45;&gt;layer3_moe_agg_gpu4 -->
<g id="edge1160" class="edge">
<title>layer3_expert4_14&#45;&gt;layer3_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14975.78,-567.2C14972.84,-566.38 14969.91,-565.63 14967,-564.95 14752.76,-515.42 14095.56,-501.07 13831.03,-497.24"/>
<polygon fill="black" stroke="black" points="13830.69,-493.73 13820.64,-497.09 13830.59,-500.73 13830.69,-493.73"/>
</g>
<!-- layer3_expert4_15&#45;&gt;layer3_moe_agg_gpu4 -->
<g id="edge1161" class="edge">
<title>layer3_expert4_15&#45;&gt;layer3_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M15167.79,-567.17C15164.84,-566.36 15161.91,-565.62 15159,-564.95 14906.87,-507.63 14123.73,-497.89 13830.95,-496.27"/>
<polygon fill="black" stroke="black" points="13830.76,-492.77 13820.75,-496.21 13830.73,-499.77 13830.76,-492.77"/>
</g>
<!-- layer3_moe_agg_gpu4&#45;&gt;layer3_moe_allreduce -->
<g id="edge1162" class="edge">
<title>layer3_moe_agg_gpu4&#45;&gt;layer3_moe_allreduce</title>
<path fill="none" stroke="black" d="M13617.46,-484.36C13377.57,-461.71 12772.89,-404.6 12465.14,-375.53"/>
<polygon fill="black" stroke="black" points="12465.05,-372.01 12454.77,-374.55 12464.4,-378.98 12465.05,-372.01"/>
</g>
<!-- layer3_output_gpu4 -->
<g id="node687" class="node">
<title>layer3_output_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="12532,-252.95 12288,-252.95 12288,-184.95 12532,-184.95 12532,-252.95"/>
<text text-anchor="middle" x="12410" y="-237.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU4</text>
<text text-anchor="middle" x="12410" y="-222.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="12410" y="-207.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12410" y="-192.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_output_gpu4&#45;&gt;output -->
<g id="edge1285" class="edge">
<title>layer3_output_gpu4&#45;&gt;output</title>
<path fill="none" stroke="black" d="M12368.91,-184.87C12357.22,-175.45 12344.31,-165.06 12332.01,-155.16"/>
<polygon fill="black" stroke="black" points="12334.02,-152.29 12324.04,-148.74 12329.63,-157.74 12334.02,-152.29"/>
</g>
<!-- layer3_expert5_0 -->
<g id="node689" class="node">
<title>layer3_expert5_0</title>
<polygon fill="lightgreen" stroke="black" points="15534,-647.95 15360,-647.95 15360,-564.95 15534,-564.95 15534,-647.95"/>
<text text-anchor="middle" x="15447" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU5</text>
<text text-anchor="middle" x="15447" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15447" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15447" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15447" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_gate_gpu5&#45;&gt;layer3_expert5_0 -->
<g id="edge1169" class="edge">
<title>layer3_gate_gpu5&#45;&gt;layer3_expert5_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16668.82,-722.19C16401.95,-716.43 15773.25,-698.07 15544.17,-647.94"/>
<polygon fill="black" stroke="black" points="15544.75,-644.48 15534.22,-645.68 15543.2,-651.31 15544.75,-644.48"/>
</g>
<!-- layer3_expert5_1 -->
<g id="node690" class="node">
<title>layer3_expert5_1</title>
<polygon fill="lightgreen" stroke="black" points="15726,-647.95 15552,-647.95 15552,-564.95 15726,-564.95 15726,-647.95"/>
<text text-anchor="middle" x="15639" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU5</text>
<text text-anchor="middle" x="15639" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15639" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15639" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15639" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_gate_gpu5&#45;&gt;layer3_expert5_1 -->
<g id="edge1170" class="edge">
<title>layer3_gate_gpu5&#45;&gt;layer3_expert5_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16668.92,-720.61C16434.28,-712.41 15927.38,-690.58 15736.19,-647.95"/>
<polygon fill="black" stroke="black" points="15736.77,-644.49 15726.23,-645.64 15735.19,-651.31 15736.77,-644.49"/>
</g>
<!-- layer3_expert5_2 -->
<g id="node691" class="node">
<title>layer3_expert5_2</title>
<polygon fill="lightgreen" stroke="black" points="15918,-647.95 15744,-647.95 15744,-564.95 15918,-564.95 15918,-647.95"/>
<text text-anchor="middle" x="15831" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU5</text>
<text text-anchor="middle" x="15831" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="15831" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="15831" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="15831" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_gate_gpu5&#45;&gt;layer3_expert5_2 -->
<g id="edge1171" class="edge">
<title>layer3_gate_gpu5&#45;&gt;layer3_expert5_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16668.77,-718.32C16469.25,-707.53 16081.31,-683.15 15928,-647.92"/>
<polygon fill="black" stroke="black" points="15928.79,-644.5 15918.25,-645.58 15927.16,-651.31 15928.79,-644.5"/>
</g>
<!-- layer3_expert5_3 -->
<g id="node692" class="node">
<title>layer3_expert5_3</title>
<polygon fill="lightgreen" stroke="black" points="16110,-647.95 15936,-647.95 15936,-564.95 16110,-564.95 16110,-647.95"/>
<text text-anchor="middle" x="16023" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU5</text>
<text text-anchor="middle" x="16023" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16023" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16023" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16023" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_gate_gpu5&#45;&gt;layer3_expert5_3 -->
<g id="edge1172" class="edge">
<title>layer3_gate_gpu5&#45;&gt;layer3_expert5_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16668.91,-721C16535.03,-714.86 16314.46,-697.79 16119.84,-647.96"/>
<polygon fill="black" stroke="black" points="16120.57,-644.53 16110.01,-645.4 16118.81,-651.3 16120.57,-644.53"/>
</g>
<!-- layer3_expert5_4 -->
<g id="node693" class="node">
<title>layer3_expert5_4</title>
<polygon fill="lightgreen" stroke="black" points="16302,-647.95 16128,-647.95 16128,-564.95 16302,-564.95 16302,-647.95"/>
<text text-anchor="middle" x="16215" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU5</text>
<text text-anchor="middle" x="16215" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16215" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16215" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16215" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_gate_gpu5&#45;&gt;layer3_expert5_4 -->
<g id="edge1173" class="edge">
<title>layer3_gate_gpu5&#45;&gt;layer3_expert5_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16668.91,-713.21C16573.32,-702.51 16437.37,-683.09 16311.84,-648"/>
<polygon fill="black" stroke="black" points="16312.63,-644.59 16302.06,-645.23 16310.72,-651.32 16312.63,-644.59"/>
</g>
<!-- layer3_expert5_5 -->
<g id="node694" class="node">
<title>layer3_expert5_5</title>
<polygon fill="lightgreen" stroke="black" points="16494,-647.95 16320,-647.95 16320,-564.95 16494,-564.95 16494,-647.95"/>
<text text-anchor="middle" x="16407" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU5</text>
<text text-anchor="middle" x="16407" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16407" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16407" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16407" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_gate_gpu5&#45;&gt;layer3_expert5_5 -->
<g id="edge1174" class="edge">
<title>layer3_gate_gpu5&#45;&gt;layer3_expert5_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16668.66,-695.97C16619.66,-683.59 16562.72,-667.96 16503.67,-648.07"/>
<polygon fill="black" stroke="black" points="16504.77,-644.75 16494.18,-644.84 16502.52,-651.37 16504.77,-644.75"/>
</g>
<!-- layer3_expert5_6 -->
<g id="node695" class="node">
<title>layer3_expert5_6</title>
<polygon fill="lightgreen" stroke="black" points="16686,-647.95 16512,-647.95 16512,-564.95 16686,-564.95 16686,-647.95"/>
<text text-anchor="middle" x="16599" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU5</text>
<text text-anchor="middle" x="16599" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16599" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16599" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16599" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_gate_gpu5&#45;&gt;layer3_expert5_6 -->
<g id="edge1175" class="edge">
<title>layer3_gate_gpu5&#45;&gt;layer3_expert5_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16724.39,-683.86C16708.15,-673.97 16690.68,-663.32 16674.08,-653.21"/>
<polygon fill="black" stroke="black" points="16675.86,-650.19 16665.5,-647.97 16672.21,-656.17 16675.86,-650.19"/>
</g>
<!-- layer3_expert5_7 -->
<g id="node696" class="node">
<title>layer3_expert5_7</title>
<polygon fill="lightgreen" stroke="black" points="16878,-647.95 16704,-647.95 16704,-564.95 16878,-564.95 16878,-647.95"/>
<text text-anchor="middle" x="16791" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU5</text>
<text text-anchor="middle" x="16791" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16791" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16791" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16791" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_gate_gpu5&#45;&gt;layer3_expert5_7 -->
<g id="edge1176" class="edge">
<title>layer3_gate_gpu5&#45;&gt;layer3_expert5_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16791,-683.86C16791,-675.6 16791,-666.82 16791,-658.26"/>
<polygon fill="black" stroke="black" points="16794.5,-657.97 16791,-647.97 16787.5,-657.97 16794.5,-657.97"/>
</g>
<!-- layer3_expert5_8 -->
<g id="node697" class="node">
<title>layer3_expert5_8</title>
<polygon fill="lightgreen" stroke="black" points="17070,-647.95 16896,-647.95 16896,-564.95 17070,-564.95 17070,-647.95"/>
<text text-anchor="middle" x="16983" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU5</text>
<text text-anchor="middle" x="16983" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="16983" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="16983" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="16983" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_gate_gpu5&#45;&gt;layer3_expert5_8 -->
<g id="edge1177" class="edge">
<title>layer3_gate_gpu5&#45;&gt;layer3_expert5_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16857.61,-683.86C16873.85,-673.97 16891.32,-663.32 16907.92,-653.21"/>
<polygon fill="black" stroke="black" points="16909.79,-656.17 16916.5,-647.97 16906.14,-650.19 16909.79,-656.17"/>
</g>
<!-- layer3_expert5_9 -->
<g id="node698" class="node">
<title>layer3_expert5_9</title>
<polygon fill="lightgreen" stroke="black" points="17262,-647.95 17088,-647.95 17088,-564.95 17262,-564.95 17262,-647.95"/>
<text text-anchor="middle" x="17175" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU5</text>
<text text-anchor="middle" x="17175" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17175" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17175" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17175" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_gate_gpu5&#45;&gt;layer3_expert5_9 -->
<g id="edge1178" class="edge">
<title>layer3_gate_gpu5&#45;&gt;layer3_expert5_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16913.34,-695.97C16962.34,-683.59 17019.28,-667.96 17078.33,-648.07"/>
<polygon fill="black" stroke="black" points="17079.48,-651.37 17087.82,-644.84 17077.23,-644.75 17079.48,-651.37"/>
</g>
<!-- layer3_expert5_10 -->
<g id="node699" class="node">
<title>layer3_expert5_10</title>
<polygon fill="lightgreen" stroke="black" points="17454,-647.95 17280,-647.95 17280,-564.95 17454,-564.95 17454,-647.95"/>
<text text-anchor="middle" x="17367" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU5</text>
<text text-anchor="middle" x="17367" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17367" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17367" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17367" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_gate_gpu5&#45;&gt;layer3_expert5_10 -->
<g id="edge1179" class="edge">
<title>layer3_gate_gpu5&#45;&gt;layer3_expert5_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16913.09,-713.21C17008.68,-702.51 17144.63,-683.09 17270.16,-648"/>
<polygon fill="black" stroke="black" points="17271.28,-651.32 17279.94,-645.23 17269.37,-644.59 17271.28,-651.32"/>
</g>
<!-- layer3_expert5_11 -->
<g id="node700" class="node">
<title>layer3_expert5_11</title>
<polygon fill="lightgreen" stroke="black" points="17646,-647.95 17472,-647.95 17472,-564.95 17646,-564.95 17646,-647.95"/>
<text text-anchor="middle" x="17559" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU5</text>
<text text-anchor="middle" x="17559" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17559" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17559" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17559" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_gate_gpu5&#45;&gt;layer3_expert5_11 -->
<g id="edge1180" class="edge">
<title>layer3_gate_gpu5&#45;&gt;layer3_expert5_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16913.09,-721C17046.97,-714.86 17267.54,-697.79 17462.16,-647.96"/>
<polygon fill="black" stroke="black" points="17463.19,-651.3 17471.99,-645.4 17461.43,-644.53 17463.19,-651.3"/>
</g>
<!-- layer3_expert5_12 -->
<g id="node701" class="node">
<title>layer3_expert5_12</title>
<polygon fill="lightgreen" stroke="black" points="17838,-647.95 17664,-647.95 17664,-564.95 17838,-564.95 17838,-647.95"/>
<text text-anchor="middle" x="17751" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU5</text>
<text text-anchor="middle" x="17751" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17751" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17751" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17751" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_gate_gpu5&#45;&gt;layer3_expert5_12 -->
<g id="edge1181" class="edge">
<title>layer3_gate_gpu5&#45;&gt;layer3_expert5_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16913.23,-718.32C17112.75,-707.53 17500.69,-683.15 17654,-647.92"/>
<polygon fill="black" stroke="black" points="17654.84,-651.31 17663.75,-645.58 17653.21,-644.5 17654.84,-651.31"/>
</g>
<!-- layer3_expert5_13 -->
<g id="node702" class="node">
<title>layer3_expert5_13</title>
<polygon fill="lightgreen" stroke="black" points="18030,-647.95 17856,-647.95 17856,-564.95 18030,-564.95 18030,-647.95"/>
<text text-anchor="middle" x="17943" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU5</text>
<text text-anchor="middle" x="17943" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="17943" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="17943" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="17943" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_gate_gpu5&#45;&gt;layer3_expert5_13 -->
<g id="edge1182" class="edge">
<title>layer3_gate_gpu5&#45;&gt;layer3_expert5_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16913.08,-720.61C17147.72,-712.41 17654.62,-690.58 17845.81,-647.95"/>
<polygon fill="black" stroke="black" points="17846.81,-651.31 17855.77,-645.64 17845.23,-644.49 17846.81,-651.31"/>
</g>
<!-- layer3_expert5_14 -->
<g id="node703" class="node">
<title>layer3_expert5_14</title>
<polygon fill="lightgreen" stroke="black" points="18222,-647.95 18048,-647.95 18048,-564.95 18222,-564.95 18222,-647.95"/>
<text text-anchor="middle" x="18135" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU5</text>
<text text-anchor="middle" x="18135" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18135" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18135" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18135" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_gate_gpu5&#45;&gt;layer3_expert5_14 -->
<g id="edge1183" class="edge">
<title>layer3_gate_gpu5&#45;&gt;layer3_expert5_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16913.18,-722.19C17180.05,-716.43 17808.75,-698.07 18037.83,-647.94"/>
<polygon fill="black" stroke="black" points="18038.8,-651.31 18047.78,-645.68 18037.25,-644.48 18038.8,-651.31"/>
</g>
<!-- layer3_expert5_15 -->
<g id="node704" class="node">
<title>layer3_expert5_15</title>
<polygon fill="lightgreen" stroke="black" points="18414,-647.95 18240,-647.95 18240,-564.95 18414,-564.95 18414,-647.95"/>
<text text-anchor="middle" x="18327" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU5</text>
<text text-anchor="middle" x="18327" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18327" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18327" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18327" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_gate_gpu5&#45;&gt;layer3_expert5_15 -->
<g id="edge1184" class="edge">
<title>layer3_gate_gpu5&#45;&gt;layer3_expert5_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16913.2,-723.37C17209.79,-719.87 17962.41,-705.65 18229.71,-647.96"/>
<polygon fill="black" stroke="black" points="18230.78,-651.31 18239.78,-645.71 18229.26,-644.48 18230.78,-651.31"/>
</g>
<!-- layer3_moe_agg_gpu5 -->
<g id="node705" class="node">
<title>layer3_moe_agg_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="16892.5,-528.95 16689.5,-528.95 16689.5,-460.95 16892.5,-460.95 16892.5,-528.95"/>
<text text-anchor="middle" x="16791" y="-513.75" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU5</text>
<text text-anchor="middle" x="16791" y="-498.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="16791" y="-483.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="16791" y="-468.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_expert5_0&#45;&gt;layer3_moe_agg_gpu5 -->
<g id="edge1185" class="edge">
<title>layer3_expert5_0&#45;&gt;layer3_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M15534.22,-567.2C15537.16,-566.38 15540.09,-565.63 15543,-564.95 15757.24,-515.42 16414.44,-501.07 16678.97,-497.24"/>
<polygon fill="black" stroke="black" points="16679.41,-500.73 16689.36,-497.09 16679.31,-493.73 16679.41,-500.73"/>
</g>
<!-- layer3_expert5_1&#45;&gt;layer3_moe_agg_gpu5 -->
<g id="edge1186" class="edge">
<title>layer3_expert5_1&#45;&gt;layer3_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M15726.23,-567.24C15729.17,-566.41 15732.1,-565.64 15735,-564.95 15911.72,-523.16 16445.22,-504.77 16679.09,-498.56"/>
<polygon fill="black" stroke="black" points="16679.42,-502.05 16689.32,-498.29 16679.23,-495.05 16679.42,-502.05"/>
</g>
<!-- layer3_expert5_2&#45;&gt;layer3_moe_agg_gpu5 -->
<g id="edge1187" class="edge">
<title>layer3_expert5_2&#45;&gt;layer3_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M15918.24,-567.3C15921.18,-566.45 15924.1,-565.66 15927,-564.95 16066.55,-530.88 16478.54,-509.25 16678.96,-500.46"/>
<polygon fill="black" stroke="black" points="16679.39,-503.94 16689.22,-500.01 16679.08,-496.95 16679.39,-503.94"/>
</g>
<!-- layer3_expert5_3&#45;&gt;layer3_moe_agg_gpu5 -->
<g id="edge1188" class="edge">
<title>layer3_expert5_3&#45;&gt;layer3_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16110.26,-567.38C16113.19,-566.51 16116.11,-565.69 16119,-564.95 16311.8,-515.56 16544.29,-501.33 16679.12,-497.35"/>
<polygon fill="black" stroke="black" points="16679.56,-500.84 16689.46,-497.06 16679.37,-493.84 16679.56,-500.84"/>
</g>
<!-- layer3_expert5_4&#45;&gt;layer3_moe_agg_gpu5 -->
<g id="edge1189" class="edge">
<title>layer3_expert5_4&#45;&gt;layer3_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16302.04,-567.62C16305.04,-566.67 16308.04,-565.78 16311,-564.95 16434.52,-530.64 16580.92,-512.73 16679.28,-503.86"/>
<polygon fill="black" stroke="black" points="16679.59,-507.34 16689.24,-502.97 16678.97,-500.37 16679.59,-507.34"/>
</g>
<!-- layer3_expert5_5&#45;&gt;layer3_moe_agg_gpu5 -->
<g id="edge1190" class="edge">
<title>layer3_expert5_5&#45;&gt;layer3_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16494.15,-567.97C16497.12,-566.92 16500.08,-565.91 16503,-564.95 16560.25,-546.16 16625.45,-530.11 16679.32,-518.23"/>
<polygon fill="black" stroke="black" points="16680.22,-521.62 16689.24,-516.06 16678.72,-514.78 16680.22,-521.62"/>
</g>
<!-- layer3_expert5_6&#45;&gt;layer3_moe_agg_gpu5 -->
<g id="edge1191" class="edge">
<title>layer3_expert5_6&#45;&gt;layer3_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16670.22,-564.84C16687.85,-554.78 16706.68,-544.04 16724.1,-534.11"/>
<polygon fill="black" stroke="black" points="16726.11,-536.99 16733.06,-529 16722.64,-530.91 16726.11,-536.99"/>
</g>
<!-- layer3_expert5_7&#45;&gt;layer3_moe_agg_gpu5 -->
<g id="edge1192" class="edge">
<title>layer3_expert5_7&#45;&gt;layer3_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16791,-564.68C16791,-556.47 16791,-547.81 16791,-539.51"/>
<polygon fill="black" stroke="black" points="16794.5,-539.25 16791,-529.25 16787.5,-539.25 16794.5,-539.25"/>
</g>
<!-- layer3_expert5_8&#45;&gt;layer3_moe_agg_gpu5 -->
<g id="edge1193" class="edge">
<title>layer3_expert5_8&#45;&gt;layer3_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16911.78,-564.84C16894.15,-554.78 16875.32,-544.04 16857.9,-534.11"/>
<polygon fill="black" stroke="black" points="16859.36,-530.91 16848.94,-529 16855.89,-536.99 16859.36,-530.91"/>
</g>
<!-- layer3_expert5_9&#45;&gt;layer3_moe_agg_gpu5 -->
<g id="edge1194" class="edge">
<title>layer3_expert5_9&#45;&gt;layer3_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17087.85,-567.97C17084.88,-566.92 17081.92,-565.91 17079,-564.95 17021.75,-546.16 16956.55,-530.11 16902.68,-518.23"/>
<polygon fill="black" stroke="black" points="16903.28,-514.78 16892.76,-516.06 16901.78,-521.62 16903.28,-514.78"/>
</g>
<!-- layer3_expert5_10&#45;&gt;layer3_moe_agg_gpu5 -->
<g id="edge1195" class="edge">
<title>layer3_expert5_10&#45;&gt;layer3_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17279.96,-567.62C17276.96,-566.67 17273.96,-565.78 17271,-564.95 17147.48,-530.64 17001.08,-512.73 16902.72,-503.86"/>
<polygon fill="black" stroke="black" points="16903.03,-500.37 16892.76,-502.97 16902.41,-507.34 16903.03,-500.37"/>
</g>
<!-- layer3_expert5_11&#45;&gt;layer3_moe_agg_gpu5 -->
<g id="edge1196" class="edge">
<title>layer3_expert5_11&#45;&gt;layer3_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17471.74,-567.38C17468.81,-566.51 17465.89,-565.69 17463,-564.95 17270.2,-515.56 17037.71,-501.33 16902.88,-497.35"/>
<polygon fill="black" stroke="black" points="16902.63,-493.84 16892.54,-497.06 16902.44,-500.84 16902.63,-493.84"/>
</g>
<!-- layer3_expert5_12&#45;&gt;layer3_moe_agg_gpu5 -->
<g id="edge1197" class="edge">
<title>layer3_expert5_12&#45;&gt;layer3_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17663.76,-567.3C17660.82,-566.45 17657.9,-565.66 17655,-564.95 17515.45,-530.88 17103.46,-509.25 16903.04,-500.46"/>
<polygon fill="black" stroke="black" points="16902.92,-496.95 16892.78,-500.01 16902.61,-503.94 16902.92,-496.95"/>
</g>
<!-- layer3_expert5_13&#45;&gt;layer3_moe_agg_gpu5 -->
<g id="edge1198" class="edge">
<title>layer3_expert5_13&#45;&gt;layer3_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17855.77,-567.24C17852.83,-566.41 17849.9,-565.64 17847,-564.95 17670.28,-523.16 17136.78,-504.77 16902.91,-498.56"/>
<polygon fill="black" stroke="black" points="16902.77,-495.05 16892.68,-498.29 16902.58,-502.05 16902.77,-495.05"/>
</g>
<!-- layer3_expert5_14&#45;&gt;layer3_moe_agg_gpu5 -->
<g id="edge1199" class="edge">
<title>layer3_expert5_14&#45;&gt;layer3_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M18047.78,-567.2C18044.84,-566.38 18041.91,-565.63 18039,-564.95 17824.76,-515.42 17167.56,-501.07 16903.03,-497.24"/>
<polygon fill="black" stroke="black" points="16902.69,-493.73 16892.64,-497.09 16902.59,-500.73 16902.69,-493.73"/>
</g>
<!-- layer3_expert5_15&#45;&gt;layer3_moe_agg_gpu5 -->
<g id="edge1200" class="edge">
<title>layer3_expert5_15&#45;&gt;layer3_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M18239.79,-567.17C18236.84,-566.36 18233.91,-565.62 18231,-564.95 17978.87,-507.63 17195.73,-497.89 16902.95,-496.27"/>
<polygon fill="black" stroke="black" points="16902.76,-492.77 16892.75,-496.21 16902.73,-499.77 16902.76,-492.77"/>
</g>
<!-- layer3_moe_agg_gpu5&#45;&gt;layer3_moe_allreduce -->
<g id="edge1201" class="edge">
<title>layer3_moe_agg_gpu5&#45;&gt;layer3_moe_allreduce</title>
<path fill="none" stroke="black" d="M16689.36,-490.89C16119.13,-473.7 13314.17,-389.16 12500.58,-364.63"/>
<polygon fill="black" stroke="black" points="12500.61,-361.13 12490.51,-364.33 12500.4,-368.13 12500.61,-361.13"/>
</g>
<!-- layer3_output_gpu5 -->
<g id="node706" class="node">
<title>layer3_output_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12794,-252.95 12550,-252.95 12550,-184.95 12794,-184.95 12794,-252.95"/>
<text text-anchor="middle" x="12672" y="-237.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU5</text>
<text text-anchor="middle" x="12672" y="-222.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="12672" y="-207.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12672" y="-192.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_output_gpu5&#45;&gt;output -->
<g id="edge1286" class="edge">
<title>layer3_output_gpu5&#45;&gt;output</title>
<path fill="none" stroke="black" d="M12549.81,-185.16C12506.04,-173.41 12456.5,-160.12 12411.87,-148.14"/>
<polygon fill="black" stroke="black" points="12412.7,-144.74 12402.13,-145.52 12410.88,-151.5 12412.7,-144.74"/>
</g>
<!-- layer3_expert6_0 -->
<g id="node708" class="node">
<title>layer3_expert6_0</title>
<polygon fill="lightgreen" stroke="black" points="18606,-647.95 18432,-647.95 18432,-564.95 18606,-564.95 18606,-647.95"/>
<text text-anchor="middle" x="18519" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU6</text>
<text text-anchor="middle" x="18519" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18519" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18519" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18519" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_gate_gpu6&#45;&gt;layer3_expert6_0 -->
<g id="edge1208" class="edge">
<title>layer3_gate_gpu6&#45;&gt;layer3_expert6_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19740.82,-722.19C19473.95,-716.43 18845.25,-698.07 18616.17,-647.94"/>
<polygon fill="black" stroke="black" points="18616.75,-644.48 18606.22,-645.68 18615.2,-651.31 18616.75,-644.48"/>
</g>
<!-- layer3_expert6_1 -->
<g id="node709" class="node">
<title>layer3_expert6_1</title>
<polygon fill="lightgreen" stroke="black" points="18798,-647.95 18624,-647.95 18624,-564.95 18798,-564.95 18798,-647.95"/>
<text text-anchor="middle" x="18711" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU6</text>
<text text-anchor="middle" x="18711" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18711" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18711" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18711" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_gate_gpu6&#45;&gt;layer3_expert6_1 -->
<g id="edge1209" class="edge">
<title>layer3_gate_gpu6&#45;&gt;layer3_expert6_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19740.92,-720.61C19506.28,-712.41 18999.38,-690.58 18808.19,-647.95"/>
<polygon fill="black" stroke="black" points="18808.77,-644.49 18798.23,-645.64 18807.19,-651.31 18808.77,-644.49"/>
</g>
<!-- layer3_expert6_2 -->
<g id="node710" class="node">
<title>layer3_expert6_2</title>
<polygon fill="lightgreen" stroke="black" points="18990,-647.95 18816,-647.95 18816,-564.95 18990,-564.95 18990,-647.95"/>
<text text-anchor="middle" x="18903" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU6</text>
<text text-anchor="middle" x="18903" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="18903" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="18903" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="18903" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_gate_gpu6&#45;&gt;layer3_expert6_2 -->
<g id="edge1210" class="edge">
<title>layer3_gate_gpu6&#45;&gt;layer3_expert6_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19740.77,-718.32C19541.25,-707.53 19153.31,-683.15 19000,-647.92"/>
<polygon fill="black" stroke="black" points="19000.79,-644.5 18990.25,-645.58 18999.16,-651.31 19000.79,-644.5"/>
</g>
<!-- layer3_expert6_3 -->
<g id="node711" class="node">
<title>layer3_expert6_3</title>
<polygon fill="lightgreen" stroke="black" points="19182,-647.95 19008,-647.95 19008,-564.95 19182,-564.95 19182,-647.95"/>
<text text-anchor="middle" x="19095" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU6</text>
<text text-anchor="middle" x="19095" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19095" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19095" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19095" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_gate_gpu6&#45;&gt;layer3_expert6_3 -->
<g id="edge1211" class="edge">
<title>layer3_gate_gpu6&#45;&gt;layer3_expert6_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19740.91,-721C19607.03,-714.86 19386.46,-697.79 19191.84,-647.96"/>
<polygon fill="black" stroke="black" points="19192.57,-644.53 19182.01,-645.4 19190.81,-651.3 19192.57,-644.53"/>
</g>
<!-- layer3_expert6_4 -->
<g id="node712" class="node">
<title>layer3_expert6_4</title>
<polygon fill="lightgreen" stroke="black" points="19374,-647.95 19200,-647.95 19200,-564.95 19374,-564.95 19374,-647.95"/>
<text text-anchor="middle" x="19287" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU6</text>
<text text-anchor="middle" x="19287" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19287" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19287" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19287" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_gate_gpu6&#45;&gt;layer3_expert6_4 -->
<g id="edge1212" class="edge">
<title>layer3_gate_gpu6&#45;&gt;layer3_expert6_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19740.91,-713.21C19645.32,-702.51 19509.37,-683.09 19383.84,-648"/>
<polygon fill="black" stroke="black" points="19384.63,-644.59 19374.06,-645.23 19382.72,-651.32 19384.63,-644.59"/>
</g>
<!-- layer3_expert6_5 -->
<g id="node713" class="node">
<title>layer3_expert6_5</title>
<polygon fill="lightgreen" stroke="black" points="19566,-647.95 19392,-647.95 19392,-564.95 19566,-564.95 19566,-647.95"/>
<text text-anchor="middle" x="19479" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU6</text>
<text text-anchor="middle" x="19479" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19479" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19479" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19479" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_gate_gpu6&#45;&gt;layer3_expert6_5 -->
<g id="edge1213" class="edge">
<title>layer3_gate_gpu6&#45;&gt;layer3_expert6_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19740.66,-695.97C19691.66,-683.59 19634.72,-667.96 19575.67,-648.07"/>
<polygon fill="black" stroke="black" points="19576.77,-644.75 19566.18,-644.84 19574.52,-651.37 19576.77,-644.75"/>
</g>
<!-- layer3_expert6_6 -->
<g id="node714" class="node">
<title>layer3_expert6_6</title>
<polygon fill="lightgreen" stroke="black" points="19758,-647.95 19584,-647.95 19584,-564.95 19758,-564.95 19758,-647.95"/>
<text text-anchor="middle" x="19671" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU6</text>
<text text-anchor="middle" x="19671" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19671" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19671" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19671" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_gate_gpu6&#45;&gt;layer3_expert6_6 -->
<g id="edge1214" class="edge">
<title>layer3_gate_gpu6&#45;&gt;layer3_expert6_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19796.39,-683.86C19780.15,-673.97 19762.68,-663.32 19746.08,-653.21"/>
<polygon fill="black" stroke="black" points="19747.86,-650.19 19737.5,-647.97 19744.21,-656.17 19747.86,-650.19"/>
</g>
<!-- layer3_expert6_7 -->
<g id="node715" class="node">
<title>layer3_expert6_7</title>
<polygon fill="lightgreen" stroke="black" points="19950,-647.95 19776,-647.95 19776,-564.95 19950,-564.95 19950,-647.95"/>
<text text-anchor="middle" x="19863" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU6</text>
<text text-anchor="middle" x="19863" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="19863" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="19863" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="19863" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_gate_gpu6&#45;&gt;layer3_expert6_7 -->
<g id="edge1215" class="edge">
<title>layer3_gate_gpu6&#45;&gt;layer3_expert6_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19863,-683.86C19863,-675.6 19863,-666.82 19863,-658.26"/>
<polygon fill="black" stroke="black" points="19866.5,-657.97 19863,-647.97 19859.5,-657.97 19866.5,-657.97"/>
</g>
<!-- layer3_expert6_8 -->
<g id="node716" class="node">
<title>layer3_expert6_8</title>
<polygon fill="lightgreen" stroke="black" points="20142,-647.95 19968,-647.95 19968,-564.95 20142,-564.95 20142,-647.95"/>
<text text-anchor="middle" x="20055" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU6</text>
<text text-anchor="middle" x="20055" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20055" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20055" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20055" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_gate_gpu6&#45;&gt;layer3_expert6_8 -->
<g id="edge1216" class="edge">
<title>layer3_gate_gpu6&#45;&gt;layer3_expert6_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19929.61,-683.86C19945.85,-673.97 19963.32,-663.32 19979.92,-653.21"/>
<polygon fill="black" stroke="black" points="19981.79,-656.17 19988.5,-647.97 19978.14,-650.19 19981.79,-656.17"/>
</g>
<!-- layer3_expert6_9 -->
<g id="node717" class="node">
<title>layer3_expert6_9</title>
<polygon fill="lightgreen" stroke="black" points="20334,-647.95 20160,-647.95 20160,-564.95 20334,-564.95 20334,-647.95"/>
<text text-anchor="middle" x="20247" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU6</text>
<text text-anchor="middle" x="20247" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20247" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20247" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20247" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_gate_gpu6&#45;&gt;layer3_expert6_9 -->
<g id="edge1217" class="edge">
<title>layer3_gate_gpu6&#45;&gt;layer3_expert6_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19985.34,-695.97C20034.34,-683.59 20091.28,-667.96 20150.33,-648.07"/>
<polygon fill="black" stroke="black" points="20151.48,-651.37 20159.82,-644.84 20149.23,-644.75 20151.48,-651.37"/>
</g>
<!-- layer3_expert6_10 -->
<g id="node718" class="node">
<title>layer3_expert6_10</title>
<polygon fill="lightgreen" stroke="black" points="20526,-647.95 20352,-647.95 20352,-564.95 20526,-564.95 20526,-647.95"/>
<text text-anchor="middle" x="20439" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU6</text>
<text text-anchor="middle" x="20439" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20439" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20439" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20439" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_gate_gpu6&#45;&gt;layer3_expert6_10 -->
<g id="edge1218" class="edge">
<title>layer3_gate_gpu6&#45;&gt;layer3_expert6_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19985.09,-713.21C20080.68,-702.51 20216.63,-683.09 20342.16,-648"/>
<polygon fill="black" stroke="black" points="20343.28,-651.32 20351.94,-645.23 20341.37,-644.59 20343.28,-651.32"/>
</g>
<!-- layer3_expert6_11 -->
<g id="node719" class="node">
<title>layer3_expert6_11</title>
<polygon fill="lightgreen" stroke="black" points="20718,-647.95 20544,-647.95 20544,-564.95 20718,-564.95 20718,-647.95"/>
<text text-anchor="middle" x="20631" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU6</text>
<text text-anchor="middle" x="20631" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20631" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20631" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20631" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_gate_gpu6&#45;&gt;layer3_expert6_11 -->
<g id="edge1219" class="edge">
<title>layer3_gate_gpu6&#45;&gt;layer3_expert6_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19985.09,-721C20118.97,-714.86 20339.54,-697.79 20534.16,-647.96"/>
<polygon fill="black" stroke="black" points="20535.19,-651.3 20543.99,-645.4 20533.43,-644.53 20535.19,-651.3"/>
</g>
<!-- layer3_expert6_12 -->
<g id="node720" class="node">
<title>layer3_expert6_12</title>
<polygon fill="lightgreen" stroke="black" points="20910,-647.95 20736,-647.95 20736,-564.95 20910,-564.95 20910,-647.95"/>
<text text-anchor="middle" x="20823" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU6</text>
<text text-anchor="middle" x="20823" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="20823" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="20823" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="20823" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_gate_gpu6&#45;&gt;layer3_expert6_12 -->
<g id="edge1220" class="edge">
<title>layer3_gate_gpu6&#45;&gt;layer3_expert6_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19985.23,-718.32C20184.75,-707.53 20572.69,-683.15 20726,-647.92"/>
<polygon fill="black" stroke="black" points="20726.84,-651.31 20735.75,-645.58 20725.21,-644.5 20726.84,-651.31"/>
</g>
<!-- layer3_expert6_13 -->
<g id="node721" class="node">
<title>layer3_expert6_13</title>
<polygon fill="lightgreen" stroke="black" points="21102,-647.95 20928,-647.95 20928,-564.95 21102,-564.95 21102,-647.95"/>
<text text-anchor="middle" x="21015" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU6</text>
<text text-anchor="middle" x="21015" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21015" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21015" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21015" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_gate_gpu6&#45;&gt;layer3_expert6_13 -->
<g id="edge1221" class="edge">
<title>layer3_gate_gpu6&#45;&gt;layer3_expert6_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19985.08,-720.61C20219.72,-712.41 20726.62,-690.58 20917.81,-647.95"/>
<polygon fill="black" stroke="black" points="20918.81,-651.31 20927.77,-645.64 20917.23,-644.49 20918.81,-651.31"/>
</g>
<!-- layer3_expert6_14 -->
<g id="node722" class="node">
<title>layer3_expert6_14</title>
<polygon fill="lightgreen" stroke="black" points="21294,-647.95 21120,-647.95 21120,-564.95 21294,-564.95 21294,-647.95"/>
<text text-anchor="middle" x="21207" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU6</text>
<text text-anchor="middle" x="21207" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21207" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21207" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21207" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_gate_gpu6&#45;&gt;layer3_expert6_14 -->
<g id="edge1222" class="edge">
<title>layer3_gate_gpu6&#45;&gt;layer3_expert6_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19985.18,-722.19C20252.05,-716.43 20880.75,-698.07 21109.83,-647.94"/>
<polygon fill="black" stroke="black" points="21110.8,-651.31 21119.78,-645.68 21109.25,-644.48 21110.8,-651.31"/>
</g>
<!-- layer3_expert6_15 -->
<g id="node723" class="node">
<title>layer3_expert6_15</title>
<polygon fill="lightgreen" stroke="black" points="21486,-647.95 21312,-647.95 21312,-564.95 21486,-564.95 21486,-647.95"/>
<text text-anchor="middle" x="21399" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU6</text>
<text text-anchor="middle" x="21399" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21399" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21399" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21399" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_gate_gpu6&#45;&gt;layer3_expert6_15 -->
<g id="edge1223" class="edge">
<title>layer3_gate_gpu6&#45;&gt;layer3_expert6_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19985.2,-723.37C20281.79,-719.87 21034.41,-705.65 21301.71,-647.96"/>
<polygon fill="black" stroke="black" points="21302.78,-651.31 21311.78,-645.71 21301.26,-644.48 21302.78,-651.31"/>
</g>
<!-- layer3_moe_agg_gpu6 -->
<g id="node724" class="node">
<title>layer3_moe_agg_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="19964.5,-528.95 19761.5,-528.95 19761.5,-460.95 19964.5,-460.95 19964.5,-528.95"/>
<text text-anchor="middle" x="19863" y="-513.75" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU6</text>
<text text-anchor="middle" x="19863" y="-498.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="19863" y="-483.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="19863" y="-468.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_expert6_0&#45;&gt;layer3_moe_agg_gpu6 -->
<g id="edge1224" class="edge">
<title>layer3_expert6_0&#45;&gt;layer3_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M18606.22,-567.2C18609.16,-566.38 18612.09,-565.63 18615,-564.95 18829.24,-515.42 19486.44,-501.07 19750.97,-497.24"/>
<polygon fill="black" stroke="black" points="19751.41,-500.73 19761.36,-497.09 19751.31,-493.73 19751.41,-500.73"/>
</g>
<!-- layer3_expert6_1&#45;&gt;layer3_moe_agg_gpu6 -->
<g id="edge1225" class="edge">
<title>layer3_expert6_1&#45;&gt;layer3_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M18798.23,-567.24C18801.17,-566.41 18804.1,-565.64 18807,-564.95 18983.72,-523.16 19517.22,-504.77 19751.09,-498.56"/>
<polygon fill="black" stroke="black" points="19751.42,-502.05 19761.32,-498.29 19751.23,-495.05 19751.42,-502.05"/>
</g>
<!-- layer3_expert6_2&#45;&gt;layer3_moe_agg_gpu6 -->
<g id="edge1226" class="edge">
<title>layer3_expert6_2&#45;&gt;layer3_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M18990.24,-567.3C18993.18,-566.45 18996.1,-565.66 18999,-564.95 19138.55,-530.88 19550.54,-509.25 19750.96,-500.46"/>
<polygon fill="black" stroke="black" points="19751.39,-503.94 19761.22,-500.01 19751.08,-496.95 19751.39,-503.94"/>
</g>
<!-- layer3_expert6_3&#45;&gt;layer3_moe_agg_gpu6 -->
<g id="edge1227" class="edge">
<title>layer3_expert6_3&#45;&gt;layer3_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19182.26,-567.38C19185.19,-566.51 19188.11,-565.69 19191,-564.95 19383.8,-515.56 19616.29,-501.33 19751.12,-497.35"/>
<polygon fill="black" stroke="black" points="19751.56,-500.84 19761.46,-497.06 19751.37,-493.84 19751.56,-500.84"/>
</g>
<!-- layer3_expert6_4&#45;&gt;layer3_moe_agg_gpu6 -->
<g id="edge1228" class="edge">
<title>layer3_expert6_4&#45;&gt;layer3_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19374.04,-567.62C19377.04,-566.67 19380.04,-565.78 19383,-564.95 19506.52,-530.64 19652.92,-512.73 19751.28,-503.86"/>
<polygon fill="black" stroke="black" points="19751.59,-507.34 19761.24,-502.97 19750.97,-500.37 19751.59,-507.34"/>
</g>
<!-- layer3_expert6_5&#45;&gt;layer3_moe_agg_gpu6 -->
<g id="edge1229" class="edge">
<title>layer3_expert6_5&#45;&gt;layer3_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19566.15,-567.97C19569.12,-566.92 19572.08,-565.91 19575,-564.95 19632.25,-546.16 19697.45,-530.11 19751.32,-518.23"/>
<polygon fill="black" stroke="black" points="19752.22,-521.62 19761.24,-516.06 19750.72,-514.78 19752.22,-521.62"/>
</g>
<!-- layer3_expert6_6&#45;&gt;layer3_moe_agg_gpu6 -->
<g id="edge1230" class="edge">
<title>layer3_expert6_6&#45;&gt;layer3_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19742.22,-564.84C19759.85,-554.78 19778.68,-544.04 19796.1,-534.11"/>
<polygon fill="black" stroke="black" points="19798.11,-536.99 19805.06,-529 19794.64,-530.91 19798.11,-536.99"/>
</g>
<!-- layer3_expert6_7&#45;&gt;layer3_moe_agg_gpu6 -->
<g id="edge1231" class="edge">
<title>layer3_expert6_7&#45;&gt;layer3_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19863,-564.68C19863,-556.47 19863,-547.81 19863,-539.51"/>
<polygon fill="black" stroke="black" points="19866.5,-539.25 19863,-529.25 19859.5,-539.25 19866.5,-539.25"/>
</g>
<!-- layer3_expert6_8&#45;&gt;layer3_moe_agg_gpu6 -->
<g id="edge1232" class="edge">
<title>layer3_expert6_8&#45;&gt;layer3_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19983.78,-564.84C19966.15,-554.78 19947.32,-544.04 19929.9,-534.11"/>
<polygon fill="black" stroke="black" points="19931.36,-530.91 19920.94,-529 19927.89,-536.99 19931.36,-530.91"/>
</g>
<!-- layer3_expert6_9&#45;&gt;layer3_moe_agg_gpu6 -->
<g id="edge1233" class="edge">
<title>layer3_expert6_9&#45;&gt;layer3_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20159.85,-567.97C20156.88,-566.92 20153.92,-565.91 20151,-564.95 20093.75,-546.16 20028.55,-530.11 19974.68,-518.23"/>
<polygon fill="black" stroke="black" points="19975.28,-514.78 19964.76,-516.06 19973.78,-521.62 19975.28,-514.78"/>
</g>
<!-- layer3_expert6_10&#45;&gt;layer3_moe_agg_gpu6 -->
<g id="edge1234" class="edge">
<title>layer3_expert6_10&#45;&gt;layer3_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20351.96,-567.62C20348.96,-566.67 20345.96,-565.78 20343,-564.95 20219.48,-530.64 20073.08,-512.73 19974.72,-503.86"/>
<polygon fill="black" stroke="black" points="19975.03,-500.37 19964.76,-502.97 19974.41,-507.34 19975.03,-500.37"/>
</g>
<!-- layer3_expert6_11&#45;&gt;layer3_moe_agg_gpu6 -->
<g id="edge1235" class="edge">
<title>layer3_expert6_11&#45;&gt;layer3_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20543.74,-567.38C20540.81,-566.51 20537.89,-565.69 20535,-564.95 20342.2,-515.56 20109.71,-501.33 19974.88,-497.35"/>
<polygon fill="black" stroke="black" points="19974.63,-493.84 19964.54,-497.06 19974.44,-500.84 19974.63,-493.84"/>
</g>
<!-- layer3_expert6_12&#45;&gt;layer3_moe_agg_gpu6 -->
<g id="edge1236" class="edge">
<title>layer3_expert6_12&#45;&gt;layer3_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20735.76,-567.3C20732.82,-566.45 20729.9,-565.66 20727,-564.95 20587.45,-530.88 20175.46,-509.25 19975.04,-500.46"/>
<polygon fill="black" stroke="black" points="19974.92,-496.95 19964.78,-500.01 19974.61,-503.94 19974.92,-496.95"/>
</g>
<!-- layer3_expert6_13&#45;&gt;layer3_moe_agg_gpu6 -->
<g id="edge1237" class="edge">
<title>layer3_expert6_13&#45;&gt;layer3_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20927.77,-567.24C20924.83,-566.41 20921.9,-565.64 20919,-564.95 20742.28,-523.16 20208.78,-504.77 19974.91,-498.56"/>
<polygon fill="black" stroke="black" points="19974.77,-495.05 19964.68,-498.29 19974.58,-502.05 19974.77,-495.05"/>
</g>
<!-- layer3_expert6_14&#45;&gt;layer3_moe_agg_gpu6 -->
<g id="edge1238" class="edge">
<title>layer3_expert6_14&#45;&gt;layer3_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M21119.78,-567.2C21116.84,-566.38 21113.91,-565.63 21111,-564.95 20896.76,-515.42 20239.56,-501.07 19975.03,-497.24"/>
<polygon fill="black" stroke="black" points="19974.69,-493.73 19964.64,-497.09 19974.59,-500.73 19974.69,-493.73"/>
</g>
<!-- layer3_expert6_15&#45;&gt;layer3_moe_agg_gpu6 -->
<g id="edge1239" class="edge">
<title>layer3_expert6_15&#45;&gt;layer3_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M21311.79,-567.17C21308.84,-566.36 21305.91,-565.62 21303,-564.95 21050.87,-507.63 20267.73,-497.89 19974.95,-496.27"/>
<polygon fill="black" stroke="black" points="19974.76,-492.77 19964.75,-496.21 19974.73,-499.77 19974.76,-492.77"/>
</g>
<!-- layer3_moe_agg_gpu6&#45;&gt;layer3_moe_allreduce -->
<g id="edge1240" class="edge">
<title>layer3_moe_agg_gpu6&#45;&gt;layer3_moe_allreduce</title>
<path fill="none" stroke="black" d="M19761.17,-492.13C18960.78,-477.77 13681.68,-383.11 12509.36,-362.08"/>
<polygon fill="black" stroke="black" points="12509.2,-358.58 12499.14,-361.9 12509.07,-365.58 12509.2,-358.58"/>
</g>
<!-- layer3_output_gpu6 -->
<g id="node725" class="node">
<title>layer3_output_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="13056,-252.95 12812,-252.95 12812,-184.95 13056,-184.95 13056,-252.95"/>
<text text-anchor="middle" x="12934" y="-237.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU6</text>
<text text-anchor="middle" x="12934" y="-222.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="12934" y="-207.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="12934" y="-192.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_output_gpu6&#45;&gt;output -->
<g id="edge1287" class="edge">
<title>layer3_output_gpu6&#45;&gt;output</title>
<path fill="none" stroke="black" d="M12811.72,-186.7C12808.79,-186.1 12805.88,-185.51 12803,-184.95 12705.69,-166.03 12597.28,-150.17 12504.43,-138.17"/>
<polygon fill="black" stroke="black" points="12504.71,-134.68 12494.35,-136.87 12503.82,-141.62 12504.71,-134.68"/>
</g>
<!-- layer3_expert7_0 -->
<g id="node727" class="node">
<title>layer3_expert7_0</title>
<polygon fill="lightgreen" stroke="black" points="21678,-647.95 21504,-647.95 21504,-564.95 21678,-564.95 21678,-647.95"/>
<text text-anchor="middle" x="21591" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU7</text>
<text text-anchor="middle" x="21591" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21591" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21591" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21591" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gate_gpu7&#45;&gt;layer3_expert7_0 -->
<g id="edge1247" class="edge">
<title>layer3_gate_gpu7&#45;&gt;layer3_expert7_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22812.82,-722.19C22545.95,-716.43 21917.25,-698.07 21688.17,-647.94"/>
<polygon fill="black" stroke="black" points="21688.75,-644.48 21678.22,-645.68 21687.2,-651.31 21688.75,-644.48"/>
</g>
<!-- layer3_expert7_1 -->
<g id="node728" class="node">
<title>layer3_expert7_1</title>
<polygon fill="lightgreen" stroke="black" points="21870,-647.95 21696,-647.95 21696,-564.95 21870,-564.95 21870,-647.95"/>
<text text-anchor="middle" x="21783" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU7</text>
<text text-anchor="middle" x="21783" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21783" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21783" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21783" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gate_gpu7&#45;&gt;layer3_expert7_1 -->
<g id="edge1248" class="edge">
<title>layer3_gate_gpu7&#45;&gt;layer3_expert7_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22812.92,-720.61C22578.28,-712.41 22071.38,-690.58 21880.19,-647.95"/>
<polygon fill="black" stroke="black" points="21880.77,-644.49 21870.23,-645.64 21879.19,-651.31 21880.77,-644.49"/>
</g>
<!-- layer3_expert7_2 -->
<g id="node729" class="node">
<title>layer3_expert7_2</title>
<polygon fill="lightgreen" stroke="black" points="22062,-647.95 21888,-647.95 21888,-564.95 22062,-564.95 22062,-647.95"/>
<text text-anchor="middle" x="21975" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU7</text>
<text text-anchor="middle" x="21975" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="21975" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="21975" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="21975" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gate_gpu7&#45;&gt;layer3_expert7_2 -->
<g id="edge1249" class="edge">
<title>layer3_gate_gpu7&#45;&gt;layer3_expert7_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22812.77,-718.32C22613.25,-707.53 22225.31,-683.15 22072,-647.92"/>
<polygon fill="black" stroke="black" points="22072.79,-644.5 22062.25,-645.58 22071.16,-651.31 22072.79,-644.5"/>
</g>
<!-- layer3_expert7_3 -->
<g id="node730" class="node">
<title>layer3_expert7_3</title>
<polygon fill="lightgreen" stroke="black" points="22254,-647.95 22080,-647.95 22080,-564.95 22254,-564.95 22254,-647.95"/>
<text text-anchor="middle" x="22167" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU7</text>
<text text-anchor="middle" x="22167" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22167" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22167" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22167" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gate_gpu7&#45;&gt;layer3_expert7_3 -->
<g id="edge1250" class="edge">
<title>layer3_gate_gpu7&#45;&gt;layer3_expert7_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22812.91,-721C22679.03,-714.86 22458.46,-697.79 22263.84,-647.96"/>
<polygon fill="black" stroke="black" points="22264.57,-644.53 22254.01,-645.4 22262.81,-651.3 22264.57,-644.53"/>
</g>
<!-- layer3_expert7_4 -->
<g id="node731" class="node">
<title>layer3_expert7_4</title>
<polygon fill="lightgreen" stroke="black" points="22446,-647.95 22272,-647.95 22272,-564.95 22446,-564.95 22446,-647.95"/>
<text text-anchor="middle" x="22359" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU7</text>
<text text-anchor="middle" x="22359" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22359" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22359" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22359" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gate_gpu7&#45;&gt;layer3_expert7_4 -->
<g id="edge1251" class="edge">
<title>layer3_gate_gpu7&#45;&gt;layer3_expert7_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22812.91,-713.21C22717.32,-702.51 22581.37,-683.09 22455.84,-648"/>
<polygon fill="black" stroke="black" points="22456.63,-644.59 22446.06,-645.23 22454.72,-651.32 22456.63,-644.59"/>
</g>
<!-- layer3_expert7_5 -->
<g id="node732" class="node">
<title>layer3_expert7_5</title>
<polygon fill="lightgreen" stroke="black" points="22638,-647.95 22464,-647.95 22464,-564.95 22638,-564.95 22638,-647.95"/>
<text text-anchor="middle" x="22551" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU7</text>
<text text-anchor="middle" x="22551" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22551" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22551" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22551" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gate_gpu7&#45;&gt;layer3_expert7_5 -->
<g id="edge1252" class="edge">
<title>layer3_gate_gpu7&#45;&gt;layer3_expert7_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22812.66,-695.97C22763.66,-683.59 22706.72,-667.96 22647.67,-648.07"/>
<polygon fill="black" stroke="black" points="22648.77,-644.75 22638.18,-644.84 22646.52,-651.37 22648.77,-644.75"/>
</g>
<!-- layer3_expert7_6 -->
<g id="node733" class="node">
<title>layer3_expert7_6</title>
<polygon fill="lightgreen" stroke="black" points="22830,-647.95 22656,-647.95 22656,-564.95 22830,-564.95 22830,-647.95"/>
<text text-anchor="middle" x="22743" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU7</text>
<text text-anchor="middle" x="22743" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22743" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22743" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22743" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gate_gpu7&#45;&gt;layer3_expert7_6 -->
<g id="edge1253" class="edge">
<title>layer3_gate_gpu7&#45;&gt;layer3_expert7_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22868.39,-683.86C22852.15,-673.97 22834.68,-663.32 22818.08,-653.21"/>
<polygon fill="black" stroke="black" points="22819.86,-650.19 22809.5,-647.97 22816.21,-656.17 22819.86,-650.19"/>
</g>
<!-- layer3_expert7_7 -->
<g id="node734" class="node">
<title>layer3_expert7_7</title>
<polygon fill="lightgreen" stroke="black" points="23022,-647.95 22848,-647.95 22848,-564.95 23022,-564.95 23022,-647.95"/>
<text text-anchor="middle" x="22935" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU7</text>
<text text-anchor="middle" x="22935" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="22935" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="22935" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="22935" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gate_gpu7&#45;&gt;layer3_expert7_7 -->
<g id="edge1254" class="edge">
<title>layer3_gate_gpu7&#45;&gt;layer3_expert7_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22935,-683.86C22935,-675.6 22935,-666.82 22935,-658.26"/>
<polygon fill="black" stroke="black" points="22938.5,-657.97 22935,-647.97 22931.5,-657.97 22938.5,-657.97"/>
</g>
<!-- layer3_expert7_8 -->
<g id="node735" class="node">
<title>layer3_expert7_8</title>
<polygon fill="lightgreen" stroke="black" points="23214,-647.95 23040,-647.95 23040,-564.95 23214,-564.95 23214,-647.95"/>
<text text-anchor="middle" x="23127" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU7</text>
<text text-anchor="middle" x="23127" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23127" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23127" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23127" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gate_gpu7&#45;&gt;layer3_expert7_8 -->
<g id="edge1255" class="edge">
<title>layer3_gate_gpu7&#45;&gt;layer3_expert7_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23001.61,-683.86C23017.85,-673.97 23035.32,-663.32 23051.92,-653.21"/>
<polygon fill="black" stroke="black" points="23053.79,-656.17 23060.5,-647.97 23050.14,-650.19 23053.79,-656.17"/>
</g>
<!-- layer3_expert7_9 -->
<g id="node736" class="node">
<title>layer3_expert7_9</title>
<polygon fill="lightgreen" stroke="black" points="23406,-647.95 23232,-647.95 23232,-564.95 23406,-564.95 23406,-647.95"/>
<text text-anchor="middle" x="23319" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU7</text>
<text text-anchor="middle" x="23319" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23319" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23319" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23319" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gate_gpu7&#45;&gt;layer3_expert7_9 -->
<g id="edge1256" class="edge">
<title>layer3_gate_gpu7&#45;&gt;layer3_expert7_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23057.34,-695.97C23106.34,-683.59 23163.28,-667.96 23222.33,-648.07"/>
<polygon fill="black" stroke="black" points="23223.48,-651.37 23231.82,-644.84 23221.23,-644.75 23223.48,-651.37"/>
</g>
<!-- layer3_expert7_10 -->
<g id="node737" class="node">
<title>layer3_expert7_10</title>
<polygon fill="lightgreen" stroke="black" points="23598,-647.95 23424,-647.95 23424,-564.95 23598,-564.95 23598,-647.95"/>
<text text-anchor="middle" x="23511" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU7</text>
<text text-anchor="middle" x="23511" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23511" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23511" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23511" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gate_gpu7&#45;&gt;layer3_expert7_10 -->
<g id="edge1257" class="edge">
<title>layer3_gate_gpu7&#45;&gt;layer3_expert7_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23057.09,-713.21C23152.68,-702.51 23288.63,-683.09 23414.16,-648"/>
<polygon fill="black" stroke="black" points="23415.28,-651.32 23423.94,-645.23 23413.37,-644.59 23415.28,-651.32"/>
</g>
<!-- layer3_expert7_11 -->
<g id="node738" class="node">
<title>layer3_expert7_11</title>
<polygon fill="lightgreen" stroke="black" points="23790,-647.95 23616,-647.95 23616,-564.95 23790,-564.95 23790,-647.95"/>
<text text-anchor="middle" x="23703" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU7</text>
<text text-anchor="middle" x="23703" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23703" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23703" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23703" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gate_gpu7&#45;&gt;layer3_expert7_11 -->
<g id="edge1258" class="edge">
<title>layer3_gate_gpu7&#45;&gt;layer3_expert7_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23057.09,-721C23190.97,-714.86 23411.54,-697.79 23606.16,-647.96"/>
<polygon fill="black" stroke="black" points="23607.19,-651.3 23615.99,-645.4 23605.43,-644.53 23607.19,-651.3"/>
</g>
<!-- layer3_expert7_12 -->
<g id="node739" class="node">
<title>layer3_expert7_12</title>
<polygon fill="lightgreen" stroke="black" points="23982,-647.95 23808,-647.95 23808,-564.95 23982,-564.95 23982,-647.95"/>
<text text-anchor="middle" x="23895" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU7</text>
<text text-anchor="middle" x="23895" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="23895" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="23895" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="23895" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gate_gpu7&#45;&gt;layer3_expert7_12 -->
<g id="edge1259" class="edge">
<title>layer3_gate_gpu7&#45;&gt;layer3_expert7_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23057.23,-718.32C23256.75,-707.53 23644.69,-683.15 23798,-647.92"/>
<polygon fill="black" stroke="black" points="23798.84,-651.31 23807.75,-645.58 23797.21,-644.5 23798.84,-651.31"/>
</g>
<!-- layer3_expert7_13 -->
<g id="node740" class="node">
<title>layer3_expert7_13</title>
<polygon fill="lightgreen" stroke="black" points="24174,-647.95 24000,-647.95 24000,-564.95 24174,-564.95 24174,-647.95"/>
<text text-anchor="middle" x="24087" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU7</text>
<text text-anchor="middle" x="24087" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24087" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24087" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24087" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gate_gpu7&#45;&gt;layer3_expert7_13 -->
<g id="edge1260" class="edge">
<title>layer3_gate_gpu7&#45;&gt;layer3_expert7_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23057.08,-720.61C23291.72,-712.41 23798.62,-690.58 23989.81,-647.95"/>
<polygon fill="black" stroke="black" points="23990.81,-651.31 23999.77,-645.64 23989.23,-644.49 23990.81,-651.31"/>
</g>
<!-- layer3_expert7_14 -->
<g id="node741" class="node">
<title>layer3_expert7_14</title>
<polygon fill="lightgreen" stroke="black" points="24366,-647.95 24192,-647.95 24192,-564.95 24366,-564.95 24366,-647.95"/>
<text text-anchor="middle" x="24279" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU7</text>
<text text-anchor="middle" x="24279" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24279" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24279" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24279" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gate_gpu7&#45;&gt;layer3_expert7_14 -->
<g id="edge1261" class="edge">
<title>layer3_gate_gpu7&#45;&gt;layer3_expert7_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23057.18,-722.19C23324.05,-716.43 23952.75,-698.07 24181.83,-647.94"/>
<polygon fill="black" stroke="black" points="24182.8,-651.31 24191.78,-645.68 24181.25,-644.48 24182.8,-651.31"/>
</g>
<!-- layer3_expert7_15 -->
<g id="node742" class="node">
<title>layer3_expert7_15</title>
<polygon fill="lightgreen" stroke="black" points="24558,-647.95 24384,-647.95 24384,-564.95 24558,-564.95 24558,-647.95"/>
<text text-anchor="middle" x="24471" y="-632.75" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU7</text>
<text text-anchor="middle" x="24471" y="-617.75" font-family="Times,serif" font-size="14.00">Input: [tokens,4096]</text>
<text text-anchor="middle" x="24471" y="-602.75" font-family="Times,serif" font-size="14.00">Output: [tokens,4096]</text>
<text text-anchor="middle" x="24471" y="-587.75" font-family="Times,serif" font-size="14.00">Expert hidden: 16384</text>
<text text-anchor="middle" x="24471" y="-572.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gate_gpu7&#45;&gt;layer3_expert7_15 -->
<g id="edge1262" class="edge">
<title>layer3_gate_gpu7&#45;&gt;layer3_expert7_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23057.2,-723.37C23353.79,-719.87 24106.41,-705.65 24373.71,-647.96"/>
<polygon fill="black" stroke="black" points="24374.78,-651.31 24383.78,-645.71 24373.26,-644.48 24374.78,-651.31"/>
</g>
<!-- layer3_moe_agg_gpu7 -->
<g id="node743" class="node">
<title>layer3_moe_agg_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="23036.5,-528.95 22833.5,-528.95 22833.5,-460.95 23036.5,-460.95 23036.5,-528.95"/>
<text text-anchor="middle" x="22935" y="-513.75" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU7</text>
<text text-anchor="middle" x="22935" y="-498.75" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,4096]</text>
<text text-anchor="middle" x="22935" y="-483.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="22935" y="-468.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_expert7_0&#45;&gt;layer3_moe_agg_gpu7 -->
<g id="edge1263" class="edge">
<title>layer3_expert7_0&#45;&gt;layer3_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M21678.22,-567.2C21681.16,-566.38 21684.09,-565.63 21687,-564.95 21901.24,-515.42 22558.44,-501.07 22822.97,-497.24"/>
<polygon fill="black" stroke="black" points="22823.41,-500.73 22833.36,-497.09 22823.31,-493.73 22823.41,-500.73"/>
</g>
<!-- layer3_expert7_1&#45;&gt;layer3_moe_agg_gpu7 -->
<g id="edge1264" class="edge">
<title>layer3_expert7_1&#45;&gt;layer3_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M21870.23,-567.24C21873.17,-566.41 21876.1,-565.64 21879,-564.95 22055.72,-523.16 22589.22,-504.77 22823.09,-498.56"/>
<polygon fill="black" stroke="black" points="22823.42,-502.05 22833.32,-498.29 22823.23,-495.05 22823.42,-502.05"/>
</g>
<!-- layer3_expert7_2&#45;&gt;layer3_moe_agg_gpu7 -->
<g id="edge1265" class="edge">
<title>layer3_expert7_2&#45;&gt;layer3_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22062.24,-567.3C22065.18,-566.45 22068.1,-565.66 22071,-564.95 22210.55,-530.88 22622.54,-509.25 22822.96,-500.46"/>
<polygon fill="black" stroke="black" points="22823.39,-503.94 22833.22,-500.01 22823.08,-496.95 22823.39,-503.94"/>
</g>
<!-- layer3_expert7_3&#45;&gt;layer3_moe_agg_gpu7 -->
<g id="edge1266" class="edge">
<title>layer3_expert7_3&#45;&gt;layer3_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22254.26,-567.38C22257.19,-566.51 22260.11,-565.69 22263,-564.95 22455.8,-515.56 22688.29,-501.33 22823.12,-497.35"/>
<polygon fill="black" stroke="black" points="22823.56,-500.84 22833.46,-497.06 22823.37,-493.84 22823.56,-500.84"/>
</g>
<!-- layer3_expert7_4&#45;&gt;layer3_moe_agg_gpu7 -->
<g id="edge1267" class="edge">
<title>layer3_expert7_4&#45;&gt;layer3_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22446.04,-567.62C22449.04,-566.67 22452.04,-565.78 22455,-564.95 22578.52,-530.64 22724.92,-512.73 22823.28,-503.86"/>
<polygon fill="black" stroke="black" points="22823.59,-507.34 22833.24,-502.97 22822.97,-500.37 22823.59,-507.34"/>
</g>
<!-- layer3_expert7_5&#45;&gt;layer3_moe_agg_gpu7 -->
<g id="edge1268" class="edge">
<title>layer3_expert7_5&#45;&gt;layer3_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22638.15,-567.97C22641.12,-566.92 22644.08,-565.91 22647,-564.95 22704.25,-546.16 22769.45,-530.11 22823.32,-518.23"/>
<polygon fill="black" stroke="black" points="22824.22,-521.62 22833.24,-516.06 22822.72,-514.78 22824.22,-521.62"/>
</g>
<!-- layer3_expert7_6&#45;&gt;layer3_moe_agg_gpu7 -->
<g id="edge1269" class="edge">
<title>layer3_expert7_6&#45;&gt;layer3_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22814.22,-564.84C22831.85,-554.78 22850.68,-544.04 22868.1,-534.11"/>
<polygon fill="black" stroke="black" points="22870.11,-536.99 22877.06,-529 22866.64,-530.91 22870.11,-536.99"/>
</g>
<!-- layer3_expert7_7&#45;&gt;layer3_moe_agg_gpu7 -->
<g id="edge1270" class="edge">
<title>layer3_expert7_7&#45;&gt;layer3_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22935,-564.68C22935,-556.47 22935,-547.81 22935,-539.51"/>
<polygon fill="black" stroke="black" points="22938.5,-539.25 22935,-529.25 22931.5,-539.25 22938.5,-539.25"/>
</g>
<!-- layer3_expert7_8&#45;&gt;layer3_moe_agg_gpu7 -->
<g id="edge1271" class="edge">
<title>layer3_expert7_8&#45;&gt;layer3_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23055.78,-564.84C23038.15,-554.78 23019.32,-544.04 23001.9,-534.11"/>
<polygon fill="black" stroke="black" points="23003.36,-530.91 22992.94,-529 22999.89,-536.99 23003.36,-530.91"/>
</g>
<!-- layer3_expert7_9&#45;&gt;layer3_moe_agg_gpu7 -->
<g id="edge1272" class="edge">
<title>layer3_expert7_9&#45;&gt;layer3_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23231.85,-567.97C23228.88,-566.92 23225.92,-565.91 23223,-564.95 23165.75,-546.16 23100.55,-530.11 23046.68,-518.23"/>
<polygon fill="black" stroke="black" points="23047.28,-514.78 23036.76,-516.06 23045.78,-521.62 23047.28,-514.78"/>
</g>
<!-- layer3_expert7_10&#45;&gt;layer3_moe_agg_gpu7 -->
<g id="edge1273" class="edge">
<title>layer3_expert7_10&#45;&gt;layer3_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23423.96,-567.62C23420.96,-566.67 23417.96,-565.78 23415,-564.95 23291.48,-530.64 23145.08,-512.73 23046.72,-503.86"/>
<polygon fill="black" stroke="black" points="23047.03,-500.37 23036.76,-502.97 23046.41,-507.34 23047.03,-500.37"/>
</g>
<!-- layer3_expert7_11&#45;&gt;layer3_moe_agg_gpu7 -->
<g id="edge1274" class="edge">
<title>layer3_expert7_11&#45;&gt;layer3_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23615.74,-567.38C23612.81,-566.51 23609.89,-565.69 23607,-564.95 23414.2,-515.56 23181.71,-501.33 23046.88,-497.35"/>
<polygon fill="black" stroke="black" points="23046.63,-493.84 23036.54,-497.06 23046.44,-500.84 23046.63,-493.84"/>
</g>
<!-- layer3_expert7_12&#45;&gt;layer3_moe_agg_gpu7 -->
<g id="edge1275" class="edge">
<title>layer3_expert7_12&#45;&gt;layer3_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23807.76,-567.3C23804.82,-566.45 23801.9,-565.66 23799,-564.95 23659.45,-530.88 23247.46,-509.25 23047.04,-500.46"/>
<polygon fill="black" stroke="black" points="23046.92,-496.95 23036.78,-500.01 23046.61,-503.94 23046.92,-496.95"/>
</g>
<!-- layer3_expert7_13&#45;&gt;layer3_moe_agg_gpu7 -->
<g id="edge1276" class="edge">
<title>layer3_expert7_13&#45;&gt;layer3_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23999.77,-567.24C23996.83,-566.41 23993.9,-565.64 23991,-564.95 23814.28,-523.16 23280.78,-504.77 23046.91,-498.56"/>
<polygon fill="black" stroke="black" points="23046.77,-495.05 23036.68,-498.29 23046.58,-502.05 23046.77,-495.05"/>
</g>
<!-- layer3_expert7_14&#45;&gt;layer3_moe_agg_gpu7 -->
<g id="edge1277" class="edge">
<title>layer3_expert7_14&#45;&gt;layer3_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M24191.78,-567.2C24188.84,-566.38 24185.91,-565.63 24183,-564.95 23968.76,-515.42 23311.56,-501.07 23047.03,-497.24"/>
<polygon fill="black" stroke="black" points="23046.69,-493.73 23036.64,-497.09 23046.59,-500.73 23046.69,-493.73"/>
</g>
<!-- layer3_expert7_15&#45;&gt;layer3_moe_agg_gpu7 -->
<g id="edge1278" class="edge">
<title>layer3_expert7_15&#45;&gt;layer3_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M24383.79,-567.17C24380.84,-566.36 24377.91,-565.62 24375,-564.95 24122.87,-507.63 23339.73,-497.89 23046.95,-496.27"/>
<polygon fill="black" stroke="black" points="23046.76,-492.77 23036.75,-496.21 23046.73,-499.77 23046.76,-492.77"/>
</g>
<!-- layer3_moe_agg_gpu7&#45;&gt;layer3_moe_allreduce -->
<g id="edge1279" class="edge">
<title>layer3_moe_agg_gpu7&#45;&gt;layer3_moe_allreduce</title>
<path fill="none" stroke="black" d="M22833.37,-492.66C21846.7,-480.06 13976.54,-379.62 12512.86,-360.94"/>
<polygon fill="black" stroke="black" points="12512.8,-357.44 12502.75,-360.81 12512.71,-364.44 12512.8,-357.44"/>
</g>
<!-- layer3_output_gpu7 -->
<g id="node744" class="node">
<title>layer3_output_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="13318,-252.95 13074,-252.95 13074,-184.95 13318,-184.95 13318,-252.95"/>
<text text-anchor="middle" x="13196" y="-237.75" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU7</text>
<text text-anchor="middle" x="13196" y="-222.75" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]x2</text>
<text text-anchor="middle" x="13196" y="-207.75" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="13196" y="-192.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_output_gpu7&#45;&gt;output -->
<g id="edge1288" class="edge">
<title>layer3_output_gpu7&#45;&gt;output</title>
<path fill="none" stroke="black" d="M13073.75,-186.52C13070.81,-185.97 13067.89,-185.45 13065,-184.95 12897.31,-156.28 12707.41,-138.37 12556.28,-127.53"/>
<polygon fill="black" stroke="black" points="12556.15,-124.01 12545.93,-126.79 12555.65,-130.99 12556.15,-124.01"/>
</g>
<!-- layer3_moe_allreduce&#45;&gt;layer3_output_gpu0 -->
<g id="edge1007" class="edge">
<title>layer3_moe_allreduce&#45;&gt;layer3_output_gpu0</title>
<path fill="none" stroke="black" d="M12104.41,-338.97C11946.93,-322.28 11709.03,-293.66 11494.17,-253.11"/>
<polygon fill="black" stroke="black" points="11494.75,-249.66 11484.28,-251.23 11493.45,-256.54 11494.75,-249.66"/>
</g>
<!-- layer3_moe_allreduce&#45;&gt;layer3_output_gpu1 -->
<g id="edge1046" class="edge">
<title>layer3_moe_allreduce&#45;&gt;layer3_output_gpu1</title>
<path fill="none" stroke="black" d="M12135.96,-329.94C12032.96,-310.71 11890.51,-283.1 11756.38,-253.23"/>
<polygon fill="black" stroke="black" points="11756.85,-249.75 11746.33,-250.99 11755.32,-256.58 11756.85,-249.75"/>
</g>
<!-- layer3_moe_allreduce&#45;&gt;layer3_output_gpu2 -->
<g id="edge1085" class="edge">
<title>layer3_moe_allreduce&#45;&gt;layer3_output_gpu2</title>
<path fill="none" stroke="black" d="M12172.91,-319.24C12116.5,-299.72 12047.37,-275.8 11991.11,-256.33"/>
<polygon fill="black" stroke="black" points="11992.07,-252.96 11981.48,-252.99 11989.78,-259.57 11992.07,-252.96"/>
</g>
<!-- layer3_moe_allreduce&#45;&gt;layer3_output_gpu3 -->
<g id="edge1124" class="edge">
<title>layer3_moe_allreduce&#45;&gt;layer3_output_gpu3</title>
<path fill="none" stroke="black" d="M12228.35,-303.37C12214.62,-289.12 12199.97,-273.91 12187,-260.44"/>
<polygon fill="black" stroke="black" points="12189.43,-257.92 12179.97,-253.15 12184.39,-262.78 12189.43,-257.92"/>
</g>
<!-- layer3_moe_allreduce&#45;&gt;layer3_output_gpu4 -->
<g id="edge1163" class="edge">
<title>layer3_moe_allreduce&#45;&gt;layer3_output_gpu4</title>
<path fill="none" stroke="black" d="M12329.65,-303.37C12343.38,-289.12 12358.03,-273.91 12371,-260.44"/>
<polygon fill="black" stroke="black" points="12373.61,-262.78 12378.03,-253.15 12368.57,-257.92 12373.61,-262.78"/>
</g>
<!-- layer3_moe_allreduce&#45;&gt;layer3_output_gpu5 -->
<g id="edge1202" class="edge">
<title>layer3_moe_allreduce&#45;&gt;layer3_output_gpu5</title>
<path fill="none" stroke="black" d="M12385.09,-319.24C12441.5,-299.72 12510.63,-275.8 12566.89,-256.33"/>
<polygon fill="black" stroke="black" points="12568.22,-259.57 12576.52,-252.99 12565.93,-252.96 12568.22,-259.57"/>
</g>
<!-- layer3_moe_allreduce&#45;&gt;layer3_output_gpu6 -->
<g id="edge1241" class="edge">
<title>layer3_moe_allreduce&#45;&gt;layer3_output_gpu6</title>
<path fill="none" stroke="black" d="M12422.04,-329.94C12525.04,-310.71 12667.49,-283.1 12801.62,-253.23"/>
<polygon fill="black" stroke="black" points="12802.68,-256.58 12811.67,-250.99 12801.15,-249.75 12802.68,-256.58"/>
</g>
<!-- layer3_moe_allreduce&#45;&gt;layer3_output_gpu7 -->
<g id="edge1280" class="edge">
<title>layer3_moe_allreduce&#45;&gt;layer3_output_gpu7</title>
<path fill="none" stroke="black" d="M12453.59,-338.97C12611.07,-322.28 12848.97,-293.66 13063.83,-253.11"/>
<polygon fill="black" stroke="black" points="13064.55,-256.54 13073.72,-251.23 13063.25,-249.66 13064.55,-256.54"/>
</g>
</g>
</svg>
