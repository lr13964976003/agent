digraph PP2_Standalone {
	graph [bb="0,0,72209,1786",
		fontsize=20,
		label="Standalone Pipeline Parallelism 2
16 GPUs total
2 stages × 8 GPUs each",
		lheight=0.92,
		lp="36104,37",
		lwidth=4.78,
		rankdir=TB,
		size="30,20"
	];
	node [fillcolor=lightcoral,
		label="\N",
		shape=diamond,
		style=filled
	];
	input	[fillcolor=lightblue,
		height=1.041,
		label="INPUT
Input: [batch_size=1024, seq_len=2048, hidden=4096]
GPU: 0-7",
		pos="12592,1744.5",
		shape=ellipse,
		width=8.1121];
	layer0_qkv_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_QKV_Projection_GPU0
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 0",
		pos="7369,1633",
		shape=rectangle,
		width=2.9444];
	input -> layer0_qkv_gpu0	[pos="e,7475,1663.1 12300,1743.1 11289,1741.1 7973.5,1729.9 7499,1667 7494.5,1666.4 7489.9,1665.7 7485.2,1664.9"];
	layer0_qkv_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_QKV_Projection_GPU1
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 1",
		pos="7614,1633",
		shape=rectangle,
		width=2.9444];
	input -> layer0_qkv_gpu1	[pos="e,7720.4,1636.3 12305,1737.2 11359,1716.4 8360.7,1650.4 7730.8,1636.6"];
	layer0_qkv_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_QKV_Projection_GPU2
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 2",
		pos="10826,1633",
		shape=rectangle,
		width=2.9444];
	input -> layer0_qkv_gpu2	[pos="e,10932,1640.6 12332,1727.4 11942,1703.2 11223,1658.6 10942,1641.2"];
	layer0_qkv_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_QKV_Projection_GPU3
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 3",
		pos="11829,1633",
		shape=rectangle,
		width=2.9444];
	input -> layer0_qkv_gpu3	[pos="e,11935,1649.2 12401,1716.1 12258,1695.5 12066,1668 11945,1650.7"];
	layer0_qkv_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_QKV_Projection_GPU4
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 4",
		pos="12722,1633",
		shape=rectangle,
		width=2.9444];
	input -> layer0_qkv_gpu4	[pos="e,12683,1667.2 12635,1707.3 12648,1696.6 12662,1684.8 12675,1673.8"];
	layer0_qkv_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_QKV_Projection_GPU5
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 5",
		pos="13964,1633",
		shape=rectangle,
		width=2.9444];
	input -> layer0_qkv_gpu5	[pos="e,13858,1642.5 12836,1724 13134,1700.2 13625,1661 13848,1643.3"];
	layer0_qkv_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_QKV_Projection_GPU6
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 6",
		pos="15249,1633",
		shape=rectangle,
		width=2.9444];
	input -> layer0_qkv_gpu6	[pos="e,15143,1638.4 12868,1732.1 13441,1708.5 14738,1655.1 15133,1638.8"];
	layer0_qkv_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_QKV_Projection_GPU7
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 7",
		pos="18680,1633",
		shape=rectangle,
		width=2.9444];
	input -> layer0_qkv_gpu7	[pos="e,18574,1635.9 12880,1738.3 13974,1718.6 17842,1649.1 18564,1636.1"];
	stage0_boundary	[fillcolor=lightblue,
		height=1.1521,
		label="Stage 0 Boundary
GPUs 0-7
Layers 0-1",
		peripheries=2,
		pos="19237,1744.5",
		shape=ellipse,
		width=2.9592];
	layer0_attn_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Multi-Head_Attention_GPU0
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 0",
		pos="6635,1529",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu0 -> layer0_attn_gpu0	[pos="e,6756.7,1561.4 7262.8,1624.2 7143.9,1614.5 6945.3,1595.4 6766.5,1563.2"];
	layer0_attn_norm_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU0
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 0",
		pos="3465,1417.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_gpu0 -> layer0_attn_norm_gpu0	[pos="e,3587,1422.7 6513.2,1523.8 6012.6,1506.5 4116.5,1441 3597.2,1423.1"];
	layer0_gate_gpu0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU0
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 0",
		pos="1623,1298.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu0 -> layer0_gate_gpu0	[pos="e,1745.2,1307.3 3342.7,1408.7 3011.4,1387.7 2098.4,1329.7 1755.5,1307.9"];
	layer0_expert0_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="87,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_0	[pos="e,174.22,1218.8 1500.8,1296.4 1204.2,1292.9 451.59,1278.7 184.29,1221",
		style=dashed];
	layer0_expert0_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="279,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_1	[pos="e,366.22,1218.7 1500.8,1295.2 1234,1289.5 605.25,1271.1 376.17,1221",
		style=dashed];
	layer0_expert0_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="471,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_2	[pos="e,558.23,1218.7 1500.9,1293.7 1266.3,1285.5 759.38,1263.6 568.19,1221",
		style=dashed];
	layer0_expert0_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="663,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_3	[pos="e,750.25,1218.6 1500.8,1291.4 1301.3,1280.6 913.31,1256.2 760,1221",
		style=dashed];
	layer0_expert0_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="855,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_4	[pos="e,942.01,1218.4 1500.9,1294 1367,1287.9 1146.5,1270.8 951.84,1221",
		style=dashed];
	layer0_expert0_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1047,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_5	[pos="e,1134.1,1218.3 1500.9,1286.3 1405.3,1275.6 1269.4,1256.1 1143.8,1221.1",
		style=dashed];
	layer0_expert0_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1239,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_6	[pos="e,1326.2,1217.9 1500.7,1269 1451.7,1256.6 1394.7,1241 1335.7,1221.1",
		style=dashed];
	layer0_expert0_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1431,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_7	[pos="e,1497.5,1221 1556.4,1256.9 1540.2,1247 1522.7,1236.4 1506.1,1226.3",
		style=dashed];
	layer0_expert0_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1623,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_8	[pos="e,1623,1221 1623,1256.9 1623,1248.6 1623,1239.9 1623,1231.3",
		style=dashed];
	layer0_expert0_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1815,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_9	[pos="e,1748.5,1221 1689.6,1256.9 1705.8,1247 1723.3,1236.4 1739.9,1226.3",
		style=dashed];
	layer0_expert0_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2007,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_10	[pos="e,1919.8,1217.9 1745.3,1269 1794.3,1256.6 1851.3,1241 1910.3,1221.1",
		style=dashed];
	layer0_expert0_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2199,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_11	[pos="e,2111.9,1218.3 1745.1,1286.3 1840.7,1275.6 1976.6,1256.1 2102.2,1221.1",
		style=dashed];
	layer0_expert0_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2391,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_12	[pos="e,2304,1218.4 1745.1,1294 1879,1287.9 2099.5,1270.8 2294.2,1221",
		style=dashed];
	layer0_expert0_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2583,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_13	[pos="e,2495.8,1218.6 1745.2,1291.4 1944.7,1280.6 2332.7,1256.2 2486,1221",
		style=dashed];
	layer0_expert0_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2775,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_14	[pos="e,2687.8,1218.7 1745.1,1293.7 1979.7,1285.5 2486.6,1263.6 2677.8,1221",
		style=dashed];
	layer0_expert0_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2967,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_15	[pos="e,2879.8,1218.7 1745.2,1295.2 2012,1289.5 2640.7,1271.1 2869.8,1221",
		style=dashed];
	layer0_moe_agg_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_MoE_Aggregate_GPU0
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 0",
		pos="1527,1068",
		shape=rectangle,
		width=2.8194];
	layer0_expert0_0 -> layer0_moe_agg_gpu0	[pos="e,1425,1069.7 174.22,1140.2 177.16,1139.4 180.09,1138.7 183,1138 416.11,1084.6 1135.9,1072.5 1414.9,1069.8"];
	layer0_expert0_1 -> layer0_moe_agg_gpu0	[pos="e,1425.2,1070.7 366.22,1140.3 369.16,1139.4 372.09,1138.7 375,1138 570.44,1092.3 1165.5,1075.9 1415.1,1070.9"];
	layer0_expert0_2 -> layer0_moe_agg_gpu0	[pos="e,1425.5,1072.1 558.23,1140.3 561.17,1139.5 564.1,1138.7 567,1138 725.15,1100.1 1197.9,1079.9 1415.3,1072.5"];
	layer0_expert0_3 -> layer0_moe_agg_gpu0	[pos="e,1425.3,1068.2 750.25,1140.4 753.18,1139.5 756.1,1138.7 759,1138 987.24,1081.1 1264,1069.8 1415.1,1068.3"];
	layer0_expert0_4 -> layer0_moe_agg_gpu0	[pos="e,1425.2,1072.6 942.01,1140.6 945.03,1139.7 948.03,1138.8 951,1138 1108.9,1096.1 1297.8,1079.6 1415.2,1073.1"];
	layer0_expert0_5 -> layer0_moe_agg_gpu0	[pos="e,1425.3,1081 1134.1,1140.8 1137.1,1139.8 1140.1,1138.9 1143,1138 1232.8,1111.3 1337.6,1093.4 1415.1,1082.4"];
	layer0_expert0_6 -> layer0_moe_agg_gpu0	[pos="e,1431.9,1102 1326,1141.5 1329.1,1140.3 1332.1,1139.2 1335,1138 1363.2,1127 1393.9,1115.7 1422.3,1105.5"];
	layer0_expert0_7 -> layer0_moe_agg_gpu0	[pos="e,1497.8,1102.3 1466.7,1137.7 1474.7,1128.7 1483.1,1119.1 1491,1110.1"];
	layer0_expert0_8 -> layer0_moe_agg_gpu0	[pos="e,1556.2,1102.3 1587.3,1137.7 1579.3,1128.7 1570.9,1119.1 1563,1110.1"];
	layer0_expert0_9 -> layer0_moe_agg_gpu0	[pos="e,1622.1,1102 1728,1141.5 1724.9,1140.3 1721.9,1139.2 1719,1138 1690.8,1127 1660.1,1115.7 1631.7,1105.5"];
	layer0_expert0_10 -> layer0_moe_agg_gpu0	[pos="e,1628.7,1081 1919.9,1140.8 1916.9,1139.8 1913.9,1138.9 1911,1138 1821.2,1111.3 1716.4,1093.4 1638.9,1082.4"];
	layer0_expert0_11 -> layer0_moe_agg_gpu0	[pos="e,1628.8,1072.6 2112,1140.6 2109,1139.7 2106,1138.8 2103,1138 1945.1,1096.1 1756.2,1079.6 1638.8,1073.1"];
	layer0_expert0_12 -> layer0_moe_agg_gpu0	[pos="e,1628.7,1068.2 2303.7,1140.4 2300.8,1139.5 2297.9,1138.7 2295,1138 2066.8,1081.1 1790,1069.8 1638.9,1068.3"];
	layer0_expert0_13 -> layer0_moe_agg_gpu0	[pos="e,1628.5,1072.1 2495.8,1140.3 2492.8,1139.5 2489.9,1138.7 2487,1138 2328.9,1100.1 1856.1,1079.9 1638.7,1072.5"];
	layer0_expert0_14 -> layer0_moe_agg_gpu0	[pos="e,1628.8,1070.7 2687.8,1140.3 2684.8,1139.4 2681.9,1138.7 2679,1138 2483.6,1092.3 1888.5,1075.9 1638.9,1070.9"];
	layer0_expert0_15 -> layer0_moe_agg_gpu0	[pos="e,1629,1069.7 2879.8,1140.2 2876.8,1139.4 2873.9,1138.7 2871,1138 2637.9,1084.6 1918.1,1072.5 1639.1,1069.8"];
	layer0_output_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU0
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 0",
		pos="1527,915",
		shape=rectangle,
		width=3.3889];
	layer0_moe_agg_gpu0 -> layer0_output_gpu0	[pos="e,1527,949.06 1527,1033.9 1527,1011.9 1527,982.95 1527,959.21"];
	layer0_attn_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Multi-Head_Attention_GPU1
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 1",
		pos="6896,1529",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu1 -> layer0_attn_gpu1	[pos="e,7017.8,1539.6 7507.8,1603.8 7499.8,1602.1 7491.8,1600.4 7484,1599 7328.6,1570.3 7147.7,1551.2 7028.1,1540.5"];
	layer0_attn_norm_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU1
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 1",
		pos="6537,1417.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_gpu1 -> layer0_attn_norm_gpu1	[pos="e,6645.3,1451.5 6787.8,1495 6745.9,1482.2 6697.7,1467.5 6654.9,1454.5"];
	layer0_gate_gpu1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU1
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 1",
		pos="4695,1298.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu1 -> layer0_gate_gpu1	[pos="e,4817.2,1307.3 6414.7,1408.7 6083.4,1387.7 5170.4,1329.7 4827.5,1307.9"];
	layer0_expert1_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3159,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_0	[pos="e,3246.2,1218.8 4572.8,1296.4 4276.2,1292.9 3523.6,1278.7 3256.3,1221",
		style=dashed];
	layer0_expert1_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3351,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_1	[pos="e,3438.2,1218.7 4572.8,1295.2 4306,1289.5 3677.3,1271.1 3448.2,1221",
		style=dashed];
	layer0_expert1_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3543,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_2	[pos="e,3630.2,1218.7 4572.9,1293.7 4338.3,1285.5 3831.4,1263.6 3640.2,1221",
		style=dashed];
	layer0_expert1_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3735,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_3	[pos="e,3822.2,1218.6 4572.8,1291.4 4373.3,1280.6 3985.3,1256.2 3832,1221",
		style=dashed];
	layer0_expert1_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3927,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_4	[pos="e,4014,1218.4 4572.9,1294 4439,1287.9 4218.5,1270.8 4023.8,1221",
		style=dashed];
	layer0_expert1_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4119,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_5	[pos="e,4206.1,1218.3 4572.9,1286.3 4477.3,1275.6 4341.4,1256.1 4215.8,1221.1",
		style=dashed];
	layer0_expert1_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4311,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_6	[pos="e,4398.2,1217.9 4572.7,1269 4523.7,1256.6 4466.7,1241 4407.7,1221.1",
		style=dashed];
	layer0_expert1_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4503,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_7	[pos="e,4569.5,1221 4628.4,1256.9 4612.2,1247 4594.7,1236.4 4578.1,1226.3",
		style=dashed];
	layer0_expert1_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4695,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_8	[pos="e,4695,1221 4695,1256.9 4695,1248.6 4695,1239.9 4695,1231.3",
		style=dashed];
	layer0_expert1_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4887,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_9	[pos="e,4820.5,1221 4761.6,1256.9 4777.8,1247 4795.3,1236.4 4811.9,1226.3",
		style=dashed];
	layer0_expert1_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5079,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_10	[pos="e,4991.8,1217.9 4817.3,1269 4866.3,1256.6 4923.3,1241 4982.3,1221.1",
		style=dashed];
	layer0_expert1_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5271,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_11	[pos="e,5183.9,1218.3 4817.1,1286.3 4912.7,1275.6 5048.6,1256.1 5174.2,1221.1",
		style=dashed];
	layer0_expert1_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5463,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_12	[pos="e,5376,1218.4 4817.1,1294 4951,1287.9 5171.5,1270.8 5366.2,1221",
		style=dashed];
	layer0_expert1_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5655,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_13	[pos="e,5567.8,1218.6 4817.2,1291.4 5016.7,1280.6 5404.7,1256.2 5558,1221",
		style=dashed];
	layer0_expert1_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5847,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_14	[pos="e,5759.8,1218.7 4817.1,1293.7 5051.7,1285.5 5558.6,1263.6 5749.8,1221",
		style=dashed];
	layer0_expert1_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="6039,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_15	[pos="e,5951.8,1218.7 4817.2,1295.2 5084,1289.5 5712.7,1271.1 5941.8,1221",
		style=dashed];
	layer0_moe_agg_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_MoE_Aggregate_GPU1
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 1",
		pos="4599,1068",
		shape=rectangle,
		width=2.8194];
	layer0_expert1_0 -> layer0_moe_agg_gpu1	[pos="e,4497,1069.7 3246.2,1140.2 3249.2,1139.4 3252.1,1138.7 3255,1138 3488.1,1084.6 4207.9,1072.5 4486.9,1069.8"];
	layer0_expert1_1 -> layer0_moe_agg_gpu1	[pos="e,4497.2,1070.7 3438.2,1140.3 3441.2,1139.4 3444.1,1138.7 3447,1138 3642.4,1092.3 4237.5,1075.9 4487.1,1070.9"];
	layer0_expert1_2 -> layer0_moe_agg_gpu1	[pos="e,4497.5,1072.1 3630.2,1140.3 3633.2,1139.5 3636.1,1138.7 3639,1138 3797.1,1100.1 4269.9,1079.9 4487.3,1072.5"];
	layer0_expert1_3 -> layer0_moe_agg_gpu1	[pos="e,4497.3,1068.2 3822.3,1140.4 3825.2,1139.5 3828.1,1138.7 3831,1138 4059.2,1081.1 4336,1069.8 4487.1,1068.3"];
	layer0_expert1_4 -> layer0_moe_agg_gpu1	[pos="e,4497.2,1072.6 4014,1140.6 4017,1139.7 4020,1138.8 4023,1138 4180.9,1096.1 4369.8,1079.6 4487.2,1073.1"];
	layer0_expert1_5 -> layer0_moe_agg_gpu1	[pos="e,4497.3,1081 4206.1,1140.8 4209.1,1139.8 4212.1,1138.9 4215,1138 4304.8,1111.3 4409.6,1093.4 4487.1,1082.4"];
	layer0_expert1_6 -> layer0_moe_agg_gpu1	[pos="e,4503.9,1102 4398,1141.5 4401.1,1140.3 4404.1,1139.2 4407,1138 4435.2,1127 4465.9,1115.7 4494.3,1105.5"];
	layer0_expert1_7 -> layer0_moe_agg_gpu1	[pos="e,4569.8,1102.3 4538.7,1137.7 4546.7,1128.7 4555.1,1119.1 4563,1110.1"];
	layer0_expert1_8 -> layer0_moe_agg_gpu1	[pos="e,4628.2,1102.3 4659.3,1137.7 4651.3,1128.7 4642.9,1119.1 4635,1110.1"];
	layer0_expert1_9 -> layer0_moe_agg_gpu1	[pos="e,4694.1,1102 4800,1141.5 4796.9,1140.3 4793.9,1139.2 4791,1138 4762.8,1127 4732.1,1115.7 4703.7,1105.5"];
	layer0_expert1_10 -> layer0_moe_agg_gpu1	[pos="e,4700.7,1081 4991.9,1140.8 4988.9,1139.8 4985.9,1138.9 4983,1138 4893.2,1111.3 4788.4,1093.4 4710.9,1082.4"];
	layer0_expert1_11 -> layer0_moe_agg_gpu1	[pos="e,4700.8,1072.6 5184,1140.6 5181,1139.7 5178,1138.8 5175,1138 5017.1,1096.1 4828.2,1079.6 4710.8,1073.1"];
	layer0_expert1_12 -> layer0_moe_agg_gpu1	[pos="e,4700.7,1068.2 5375.7,1140.4 5372.8,1139.5 5369.9,1138.7 5367,1138 5138.8,1081.1 4862,1069.8 4710.9,1068.3"];
	layer0_expert1_13 -> layer0_moe_agg_gpu1	[pos="e,4700.5,1072.1 5567.8,1140.3 5564.8,1139.5 5561.9,1138.7 5559,1138 5400.9,1100.1 4928.1,1079.9 4710.7,1072.5"];
	layer0_expert1_14 -> layer0_moe_agg_gpu1	[pos="e,4700.8,1070.7 5759.8,1140.3 5756.8,1139.4 5753.9,1138.7 5751,1138 5555.6,1092.3 4960.5,1075.9 4710.9,1070.9"];
	layer0_expert1_15 -> layer0_moe_agg_gpu1	[pos="e,4701,1069.7 5951.8,1140.2 5948.8,1139.4 5945.9,1138.7 5943,1138 5709.9,1084.6 4990.1,1072.5 4711.1,1069.8"];
	layer0_output_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU1
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 1",
		pos="4599,915",
		shape=rectangle,
		width=3.3889];
	layer0_moe_agg_gpu1 -> layer0_output_gpu1	[pos="e,4599,949.06 4599,1033.9 4599,1011.9 4599,982.95 4599,959.21"];
	layer0_attn_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Multi-Head_Attention_GPU2
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 2",
		pos="9078,1529",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu2 -> layer0_attn_gpu2	[pos="e,9199.7,1537.1 10720,1625.8 10416,1608.1 9543.6,1557.2 9209.9,1537.7"];
	layer0_attn_norm_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU2
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 2",
		pos="8204,1417.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_gpu2 -> layer0_attn_norm_gpu2	[pos="e,8326.3,1433.8 8956.5,1512.8 8793.4,1492.3 8504.9,1456.2 8336.4,1435.1"];
	layer0_gate_gpu2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU2
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 2",
		pos="7767,1298.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu2 -> layer0_gate_gpu2	[pos="e,7889.1,1332.2 8082,1383.8 8025,1368.6 7957.2,1350.4 7899,1334.9"];
	layer0_expert2_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="6231,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_0	[pos="e,6318.2,1218.8 7644.8,1296.4 7348.2,1292.9 6595.6,1278.7 6328.3,1221",
		style=dashed];
	layer0_expert2_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="6423,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_1	[pos="e,6510.2,1218.7 7644.8,1295.2 7378,1289.5 6749.3,1271.1 6520.2,1221",
		style=dashed];
	layer0_expert2_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="6615,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_2	[pos="e,6702.2,1218.7 7644.9,1293.7 7410.3,1285.5 6903.4,1263.6 6712.2,1221",
		style=dashed];
	layer0_expert2_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="6807,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_3	[pos="e,6894.2,1218.6 7644.8,1291.4 7445.3,1280.6 7057.3,1256.2 6904,1221",
		style=dashed];
	layer0_expert2_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="6999,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_4	[pos="e,7086,1218.4 7644.9,1294 7511,1287.9 7290.5,1270.8 7095.8,1221",
		style=dashed];
	layer0_expert2_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7191,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_5	[pos="e,7278.1,1218.3 7644.9,1286.3 7549.3,1275.6 7413.4,1256.1 7287.8,1221.1",
		style=dashed];
	layer0_expert2_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7383,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_6	[pos="e,7470.2,1217.9 7644.7,1269 7595.7,1256.6 7538.7,1241 7479.7,1221.1",
		style=dashed];
	layer0_expert2_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7575,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_7	[pos="e,7641.5,1221 7700.4,1256.9 7684.2,1247 7666.7,1236.4 7650.1,1226.3",
		style=dashed];
	layer0_expert2_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7767,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_8	[pos="e,7767,1221 7767,1256.9 7767,1248.6 7767,1239.9 7767,1231.3",
		style=dashed];
	layer0_expert2_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7959,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_9	[pos="e,7892.5,1221 7833.6,1256.9 7849.8,1247 7867.3,1236.4 7883.9,1226.3",
		style=dashed];
	layer0_expert2_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8151,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_10	[pos="e,8063.8,1217.9 7889.3,1269 7938.3,1256.6 7995.3,1241 8054.3,1221.1",
		style=dashed];
	layer0_expert2_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8343,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_11	[pos="e,8255.9,1218.3 7889.1,1286.3 7984.7,1275.6 8120.6,1256.1 8246.2,1221.1",
		style=dashed];
	layer0_expert2_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8535,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_12	[pos="e,8448,1218.4 7889.1,1294 8023,1287.9 8243.5,1270.8 8438.2,1221",
		style=dashed];
	layer0_expert2_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8727,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_13	[pos="e,8639.8,1218.6 7889.2,1291.4 8088.7,1280.6 8476.7,1256.2 8630,1221",
		style=dashed];
	layer0_expert2_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8919,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_14	[pos="e,8831.8,1218.7 7889.1,1293.7 8123.7,1285.5 8630.6,1263.6 8821.8,1221",
		style=dashed];
	layer0_expert2_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="9111,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_15	[pos="e,9023.8,1218.7 7889.2,1295.2 8156,1289.5 8784.7,1271.1 9013.8,1221",
		style=dashed];
	layer0_moe_agg_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_MoE_Aggregate_GPU2
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 2",
		pos="7671,1068",
		shape=rectangle,
		width=2.8194];
	layer0_expert2_0 -> layer0_moe_agg_gpu2	[pos="e,7569,1069.7 6318.2,1140.2 6321.2,1139.4 6324.1,1138.7 6327,1138 6560.1,1084.6 7279.9,1072.5 7558.9,1069.8"];
	layer0_expert2_1 -> layer0_moe_agg_gpu2	[pos="e,7569.2,1070.7 6510.2,1140.3 6513.2,1139.4 6516.1,1138.7 6519,1138 6714.4,1092.3 7309.5,1075.9 7559.1,1070.9"];
	layer0_expert2_2 -> layer0_moe_agg_gpu2	[pos="e,7569.5,1072.1 6702.2,1140.3 6705.2,1139.5 6708.1,1138.7 6711,1138 6869.1,1100.1 7341.9,1079.9 7559.3,1072.5"];
	layer0_expert2_3 -> layer0_moe_agg_gpu2	[pos="e,7569.3,1068.2 6894.3,1140.4 6897.2,1139.5 6900.1,1138.7 6903,1138 7131.2,1081.1 7408,1069.8 7559.1,1068.3"];
	layer0_expert2_4 -> layer0_moe_agg_gpu2	[pos="e,7569.2,1072.6 7086,1140.6 7089,1139.7 7092,1138.8 7095,1138 7252.9,1096.1 7441.8,1079.6 7559.2,1073.1"];
	layer0_expert2_5 -> layer0_moe_agg_gpu2	[pos="e,7569.3,1081 7278.1,1140.8 7281.1,1139.8 7284.1,1138.9 7287,1138 7376.8,1111.3 7481.6,1093.4 7559.1,1082.4"];
	layer0_expert2_6 -> layer0_moe_agg_gpu2	[pos="e,7575.9,1102 7470,1141.5 7473.1,1140.3 7476.1,1139.2 7479,1138 7507.2,1127 7537.9,1115.7 7566.3,1105.5"];
	layer0_expert2_7 -> layer0_moe_agg_gpu2	[pos="e,7641.8,1102.3 7610.7,1137.7 7618.7,1128.7 7627.1,1119.1 7635,1110.1"];
	layer0_expert2_8 -> layer0_moe_agg_gpu2	[pos="e,7700.2,1102.3 7731.3,1137.7 7723.3,1128.7 7714.9,1119.1 7707,1110.1"];
	layer0_expert2_9 -> layer0_moe_agg_gpu2	[pos="e,7766.1,1102 7872,1141.5 7868.9,1140.3 7865.9,1139.2 7863,1138 7834.8,1127 7804.1,1115.7 7775.7,1105.5"];
	layer0_expert2_10 -> layer0_moe_agg_gpu2	[pos="e,7772.7,1081 8063.9,1140.8 8060.9,1139.8 8057.9,1138.9 8055,1138 7965.2,1111.3 7860.4,1093.4 7782.9,1082.4"];
	layer0_expert2_11 -> layer0_moe_agg_gpu2	[pos="e,7772.8,1072.6 8256,1140.6 8253,1139.7 8250,1138.8 8247,1138 8089.1,1096.1 7900.2,1079.6 7782.8,1073.1"];
	layer0_expert2_12 -> layer0_moe_agg_gpu2	[pos="e,7772.7,1068.2 8447.7,1140.4 8444.8,1139.5 8441.9,1138.7 8439,1138 8210.8,1081.1 7934,1069.8 7782.9,1068.3"];
	layer0_expert2_13 -> layer0_moe_agg_gpu2	[pos="e,7772.5,1072.1 8639.8,1140.3 8636.8,1139.5 8633.9,1138.7 8631,1138 8472.9,1100.1 8000.1,1079.9 7782.7,1072.5"];
	layer0_expert2_14 -> layer0_moe_agg_gpu2	[pos="e,7772.8,1070.7 8831.8,1140.3 8828.8,1139.4 8825.9,1138.7 8823,1138 8627.6,1092.3 8032.5,1075.9 7782.9,1070.9"];
	layer0_expert2_15 -> layer0_moe_agg_gpu2	[pos="e,7773,1069.7 9023.8,1140.2 9020.8,1139.4 9017.9,1138.7 9015,1138 8781.9,1084.6 8062.1,1072.5 7783.1,1069.8"];
	layer0_output_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU2
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 2",
		pos="7671,915",
		shape=rectangle,
		width=3.3889];
	layer0_moe_agg_gpu2 -> layer0_output_gpu2	[pos="e,7671,949.06 7671,1033.9 7671,1011.9 7671,982.95 7671,959.21"];
	layer0_attn_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Multi-Head_Attention_GPU3
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 3",
		pos="11167,1529",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu3 -> layer0_attn_gpu3	[pos="e,11289,1548.7 11723,1615.6 11607,1597.8 11423,1569.4 11299,1550.3"];
	layer0_attn_norm_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU3
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 3",
		pos="11003,1417.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_gpu3 -> layer0_attn_norm_gpu3	[pos="e,11052,1451.5 11117,1494.8 11100,1482.9 11079,1469.4 11061,1457.1"];
	layer0_gate_gpu3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU3
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 3",
		pos="10839,1298.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu3 -> layer0_gate_gpu3	[pos="e,10896,1340.1 10956,1383.3 10940,1371.7 10922,1358.5 10904,1346.1"];
	layer0_expert3_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="9303,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_0	[pos="e,9390.2,1218.8 10717,1296.4 10420,1292.9 9667.6,1278.7 9400.3,1221",
		style=dashed];
	layer0_expert3_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="9495,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_1	[pos="e,9582.2,1218.7 10717,1295.2 10450,1289.5 9821.3,1271.1 9592.2,1221",
		style=dashed];
	layer0_expert3_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="9687,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_2	[pos="e,9774.2,1218.7 10717,1293.7 10482,1285.5 9975.4,1263.6 9784.2,1221",
		style=dashed];
	layer0_expert3_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="9879,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_3	[pos="e,9966.2,1218.6 10717,1291.4 10517,1280.6 10129,1256.2 9976,1221",
		style=dashed];
	layer0_expert3_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10071,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_4	[pos="e,10158,1218.4 10717,1294 10583,1287.9 10362,1270.8 10168,1221",
		style=dashed];
	layer0_expert3_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10263,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_5	[pos="e,10350,1218.3 10717,1286.3 10621,1275.6 10485,1256.1 10360,1221.1",
		style=dashed];
	layer0_expert3_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10455,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_6	[pos="e,10542,1217.9 10717,1269 10668,1256.6 10611,1241 10552,1221.1",
		style=dashed];
	layer0_expert3_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10647,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_7	[pos="e,10713,1221 10772,1256.9 10756,1247 10739,1236.4 10722,1226.3",
		style=dashed];
	layer0_expert3_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10839,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_8	[pos="e,10839,1221 10839,1256.9 10839,1248.6 10839,1239.9 10839,1231.3",
		style=dashed];
	layer0_expert3_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11031,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_9	[pos="e,10965,1221 10906,1256.9 10922,1247 10939,1236.4 10956,1226.3",
		style=dashed];
	layer0_expert3_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11223,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_10	[pos="e,11136,1217.9 10961,1269 11010,1256.6 11067,1241 11126,1221.1",
		style=dashed];
	layer0_expert3_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11415,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_11	[pos="e,11328,1218.3 10961,1286.3 11057,1275.6 11193,1256.1 11318,1221.1",
		style=dashed];
	layer0_expert3_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11607,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_12	[pos="e,11520,1218.4 10961,1294 11095,1287.9 11316,1270.8 11510,1221",
		style=dashed];
	layer0_expert3_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11799,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_13	[pos="e,11712,1218.6 10961,1291.4 11161,1280.6 11549,1256.2 11702,1221",
		style=dashed];
	layer0_expert3_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11991,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_14	[pos="e,11904,1218.7 10961,1293.7 11196,1285.5 11703,1263.6 11894,1221",
		style=dashed];
	layer0_expert3_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="12183,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_15	[pos="e,12096,1218.7 10961,1295.2 11228,1289.5 11857,1271.1 12086,1221",
		style=dashed];
	layer0_moe_agg_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_MoE_Aggregate_GPU3
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 3",
		pos="10743,1068",
		shape=rectangle,
		width=2.8194];
	layer0_expert3_0 -> layer0_moe_agg_gpu3	[pos="e,10641,1069.7 9390.2,1140.2 9393.2,1139.4 9396.1,1138.7 9399,1138 9632.1,1084.6 10352,1072.5 10631,1069.8"];
	layer0_expert3_1 -> layer0_moe_agg_gpu3	[pos="e,10641,1070.7 9582.2,1140.3 9585.2,1139.4 9588.1,1138.7 9591,1138 9786.4,1092.3 10382,1075.9 10631,1070.9"];
	layer0_expert3_2 -> layer0_moe_agg_gpu3	[pos="e,10641,1072.1 9774.2,1140.3 9777.2,1139.5 9780.1,1138.7 9783,1138 9941.1,1100.1 10414,1079.9 10631,1072.5"];
	layer0_expert3_3 -> layer0_moe_agg_gpu3	[pos="e,10641,1068.2 9966.3,1140.4 9969.2,1139.5 9972.1,1138.7 9975,1138 10203,1081.1 10480,1069.8 10631,1068.3"];
	layer0_expert3_4 -> layer0_moe_agg_gpu3	[pos="e,10641,1072.6 10158,1140.6 10161,1139.7 10164,1138.8 10167,1138 10325,1096.1 10514,1079.6 10631,1073.1"];
	layer0_expert3_5 -> layer0_moe_agg_gpu3	[pos="e,10641,1081 10350,1140.8 10353,1139.8 10356,1138.9 10359,1138 10449,1111.3 10554,1093.4 10631,1082.4"];
	layer0_expert3_6 -> layer0_moe_agg_gpu3	[pos="e,10648,1102 10542,1141.5 10545,1140.3 10548,1139.2 10551,1138 10579,1127 10610,1115.7 10638,1105.5"];
	layer0_expert3_7 -> layer0_moe_agg_gpu3	[pos="e,10714,1102.3 10683,1137.7 10691,1128.7 10699,1119.1 10707,1110.1"];
	layer0_expert3_8 -> layer0_moe_agg_gpu3	[pos="e,10772,1102.3 10803,1137.7 10795,1128.7 10787,1119.1 10779,1110.1"];
	layer0_expert3_9 -> layer0_moe_agg_gpu3	[pos="e,10838,1102 10944,1141.5 10941,1140.3 10938,1139.2 10935,1138 10907,1127 10876,1115.7 10848,1105.5"];
	layer0_expert3_10 -> layer0_moe_agg_gpu3	[pos="e,10845,1081 11136,1140.8 11133,1139.8 11130,1138.9 11127,1138 11037,1111.3 10932,1093.4 10855,1082.4"];
	layer0_expert3_11 -> layer0_moe_agg_gpu3	[pos="e,10845,1072.6 11328,1140.6 11325,1139.7 11322,1138.8 11319,1138 11161,1096.1 10972,1079.6 10855,1073.1"];
	layer0_expert3_12 -> layer0_moe_agg_gpu3	[pos="e,10845,1068.2 11520,1140.4 11517,1139.5 11514,1138.7 11511,1138 11283,1081.1 11006,1069.8 10855,1068.3"];
	layer0_expert3_13 -> layer0_moe_agg_gpu3	[pos="e,10845,1072.1 11712,1140.3 11709,1139.5 11706,1138.7 11703,1138 11545,1100.1 11072,1079.9 10855,1072.5"];
	layer0_expert3_14 -> layer0_moe_agg_gpu3	[pos="e,10845,1070.7 11904,1140.3 11901,1139.4 11898,1138.7 11895,1138 11700,1092.3 11104,1075.9 10855,1070.9"];
	layer0_expert3_15 -> layer0_moe_agg_gpu3	[pos="e,10845,1069.7 12096,1140.2 12093,1139.4 12090,1138.7 12087,1138 11854,1084.6 11134,1072.5 10855,1069.8"];
	layer0_output_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU3
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 3",
		pos="10743,915",
		shape=rectangle,
		width=3.3889];
	layer0_moe_agg_gpu3 -> layer0_output_gpu3	[pos="e,10743,949.06 10743,1033.9 10743,1011.9 10743,982.95 10743,959.21"];
	layer0_attn_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Multi-Head_Attention_GPU4
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 4",
		pos="12737,1529",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu4 -> layer0_attn_gpu4	[pos="e,12732,1563.3 12727,1598.9 12728,1590.8 12729,1582 12731,1573.5"];
	layer0_attn_norm_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU4
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 4",
		pos="13064,1417.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_gpu4 -> layer0_attn_norm_gpu4	[pos="e,12965,1451.5 12836,1495 12873,1482.3 12917,1467.8 12956,1454.8"];
	layer0_gate_gpu4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU4
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 4",
		pos="13719,1298.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu4 -> layer0_gate_gpu4	[pos="e,13597,1321.3 13186,1394.7 13300,1374.4 13470,1344.1 13587,1323.1"];
	layer0_expert4_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="12375,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_0	[pos="e,12462,1218.7 13597,1295.2 13330,1289.5 12701,1271.1 12472,1221",
		style=dashed];
	layer0_expert4_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="12567,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_1	[pos="e,12654,1218.7 13597,1293.7 13362,1285.5 12855,1263.6 12664,1221",
		style=dashed];
	layer0_expert4_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="12759,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_2	[pos="e,12846,1218.6 13597,1291.4 13397,1280.6 13009,1256.2 12856,1221",
		style=dashed];
	layer0_expert4_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="12951,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_3	[pos="e,13038,1218.4 13597,1294 13463,1287.9 13242,1270.8 13048,1221",
		style=dashed];
	layer0_expert4_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13143,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_4	[pos="e,13230,1218.3 13597,1286.3 13501,1275.6 13365,1256.1 13240,1221.1",
		style=dashed];
	layer0_expert4_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13335,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_5	[pos="e,13422,1217.9 13597,1269 13548,1256.6 13491,1241 13432,1221.1",
		style=dashed];
	layer0_expert4_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13527,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_6	[pos="e,13593,1221 13652,1256.9 13636,1247 13619,1236.4 13602,1226.3",
		style=dashed];
	layer0_expert4_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13719,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_7	[pos="e,13719,1221 13719,1256.9 13719,1248.6 13719,1239.9 13719,1231.3",
		style=dashed];
	layer0_expert4_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13911,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_8	[pos="e,13845,1221 13786,1256.9 13802,1247 13819,1236.4 13836,1226.3",
		style=dashed];
	layer0_expert4_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14103,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_9	[pos="e,14016,1217.9 13841,1269 13890,1256.6 13947,1241 14006,1221.1",
		style=dashed];
	layer0_expert4_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14295,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_10	[pos="e,14208,1218.3 13841,1286.3 13937,1275.6 14073,1256.1 14198,1221.1",
		style=dashed];
	layer0_expert4_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14487,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_11	[pos="e,14400,1218.4 13841,1294 13975,1287.9 14196,1270.8 14390,1221",
		style=dashed];
	layer0_expert4_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14679,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_12	[pos="e,14592,1218.6 13841,1291.4 14041,1280.6 14429,1256.2 14582,1221",
		style=dashed];
	layer0_expert4_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14871,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_13	[pos="e,14784,1218.7 13841,1293.7 14076,1285.5 14583,1263.6 14774,1221",
		style=dashed];
	layer0_expert4_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="15063,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_14	[pos="e,14976,1218.7 13841,1295.2 14108,1289.5 14737,1271.1 14966,1221",
		style=dashed];
	layer0_expert4_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="15255,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_15	[pos="e,15168,1218.8 13841,1296.4 14138,1292.9 14890,1278.7 15158,1221",
		style=dashed];
	layer0_moe_agg_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_MoE_Aggregate_GPU4
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 4",
		pos="13815,1068",
		shape=rectangle,
		width=2.8194];
	layer0_expert4_0 -> layer0_moe_agg_gpu4	[pos="e,13713,1069.7 12462,1140.2 12465,1139.4 12468,1138.7 12471,1138 12704,1084.6 13424,1072.5 13703,1069.8"];
	layer0_expert4_1 -> layer0_moe_agg_gpu4	[pos="e,13713,1070.7 12654,1140.3 12657,1139.4 12660,1138.7 12663,1138 12858,1092.3 13454,1075.9 13703,1070.9"];
	layer0_expert4_2 -> layer0_moe_agg_gpu4	[pos="e,13713,1072.1 12846,1140.3 12849,1139.5 12852,1138.7 12855,1138 13013,1100.1 13486,1079.9 13703,1072.5"];
	layer0_expert4_3 -> layer0_moe_agg_gpu4	[pos="e,13713,1068.2 13038,1140.4 13041,1139.5 13044,1138.7 13047,1138 13275,1081.1 13552,1069.8 13703,1068.3"];
	layer0_expert4_4 -> layer0_moe_agg_gpu4	[pos="e,13713,1072.6 13230,1140.6 13233,1139.7 13236,1138.8 13239,1138 13397,1096.1 13586,1079.6 13703,1073.1"];
	layer0_expert4_5 -> layer0_moe_agg_gpu4	[pos="e,13713,1081 13422,1140.8 13425,1139.8 13428,1138.9 13431,1138 13521,1111.3 13626,1093.4 13703,1082.4"];
	layer0_expert4_6 -> layer0_moe_agg_gpu4	[pos="e,13720,1102 13614,1141.5 13617,1140.3 13620,1139.2 13623,1138 13651,1127 13682,1115.7 13710,1105.5"];
	layer0_expert4_7 -> layer0_moe_agg_gpu4	[pos="e,13786,1102.3 13755,1137.7 13763,1128.7 13771,1119.1 13779,1110.1"];
	layer0_expert4_8 -> layer0_moe_agg_gpu4	[pos="e,13844,1102.3 13875,1137.7 13867,1128.7 13859,1119.1 13851,1110.1"];
	layer0_expert4_9 -> layer0_moe_agg_gpu4	[pos="e,13910,1102 14016,1141.5 14013,1140.3 14010,1139.2 14007,1138 13979,1127 13948,1115.7 13920,1105.5"];
	layer0_expert4_10 -> layer0_moe_agg_gpu4	[pos="e,13917,1081 14208,1140.8 14205,1139.8 14202,1138.9 14199,1138 14109,1111.3 14004,1093.4 13927,1082.4"];
	layer0_expert4_11 -> layer0_moe_agg_gpu4	[pos="e,13917,1072.6 14400,1140.6 14397,1139.7 14394,1138.8 14391,1138 14233,1096.1 14044,1079.6 13927,1073.1"];
	layer0_expert4_12 -> layer0_moe_agg_gpu4	[pos="e,13917,1068.2 14592,1140.4 14589,1139.5 14586,1138.7 14583,1138 14355,1081.1 14078,1069.8 13927,1068.3"];
	layer0_expert4_13 -> layer0_moe_agg_gpu4	[pos="e,13917,1072.1 14784,1140.3 14781,1139.5 14778,1138.7 14775,1138 14617,1100.1 14144,1079.9 13927,1072.5"];
	layer0_expert4_14 -> layer0_moe_agg_gpu4	[pos="e,13917,1070.7 14976,1140.3 14973,1139.4 14970,1138.7 14967,1138 14772,1092.3 14176,1075.9 13927,1070.9"];
	layer0_expert4_15 -> layer0_moe_agg_gpu4	[pos="e,13917,1069.7 15168,1140.2 15165,1139.4 15162,1138.7 15159,1138 14926,1084.6 14206,1072.5 13927,1069.8"];
	layer0_output_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU4
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 4",
		pos="13815,915",
		shape=rectangle,
		width=3.3889];
	layer0_moe_agg_gpu4 -> layer0_output_gpu4	[pos="e,13815,949.06 13815,1033.9 13815,1011.9 13815,982.95 13815,959.21"];
	layer0_attn_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Multi-Head_Attention_GPU5
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 5",
		pos="15392,1529",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu5 -> layer0_attn_gpu5	[pos="e,15270,1538.7 14070,1624.4 14327,1606.1 14979,1559.5 15260,1539.4"];
	layer0_attn_norm_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU5
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 5",
		pos="16106,1417.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_gpu5 -> layer0_attn_norm_gpu5	[pos="e,15984,1437.2 15514,1509.4 15641,1489.8 15842,1459 15974,1438.8"];
	layer0_gate_gpu5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU5
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 5",
		pos="16791,1298.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu5 -> layer0_gate_gpu5	[pos="e,16669,1320.4 16228,1395.7 16349,1375 16534,1343.3 16659,1322.1"];
	layer0_expert5_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="15447,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_0	[pos="e,15534,1218.7 16669,1295.2 16402,1289.5 15773,1271.1 15544,1221",
		style=dashed];
	layer0_expert5_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="15639,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_1	[pos="e,15726,1218.7 16669,1293.7 16434,1285.5 15927,1263.6 15736,1221",
		style=dashed];
	layer0_expert5_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="15831,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_2	[pos="e,15918,1218.6 16669,1291.4 16469,1280.6 16081,1256.2 15928,1221",
		style=dashed];
	layer0_expert5_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16023,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_3	[pos="e,16110,1218.4 16669,1294 16535,1287.9 16314,1270.8 16120,1221",
		style=dashed];
	layer0_expert5_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16215,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_4	[pos="e,16302,1218.3 16669,1286.3 16573,1275.6 16437,1256.1 16312,1221.1",
		style=dashed];
	layer0_expert5_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16407,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_5	[pos="e,16494,1217.9 16669,1269 16620,1256.6 16563,1241 16504,1221.1",
		style=dashed];
	layer0_expert5_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16599,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_6	[pos="e,16665,1221 16724,1256.9 16708,1247 16691,1236.4 16674,1226.3",
		style=dashed];
	layer0_expert5_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16791,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_7	[pos="e,16791,1221 16791,1256.9 16791,1248.6 16791,1239.9 16791,1231.3",
		style=dashed];
	layer0_expert5_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16983,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_8	[pos="e,16917,1221 16858,1256.9 16874,1247 16891,1236.4 16908,1226.3",
		style=dashed];
	layer0_expert5_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17175,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_9	[pos="e,17088,1217.9 16913,1269 16962,1256.6 17019,1241 17078,1221.1",
		style=dashed];
	layer0_expert5_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17367,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_10	[pos="e,17280,1218.3 16913,1286.3 17009,1275.6 17145,1256.1 17270,1221.1",
		style=dashed];
	layer0_expert5_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17559,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_11	[pos="e,17472,1218.4 16913,1294 17047,1287.9 17268,1270.8 17462,1221",
		style=dashed];
	layer0_expert5_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17751,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_12	[pos="e,17664,1218.6 16913,1291.4 17113,1280.6 17501,1256.2 17654,1221",
		style=dashed];
	layer0_expert5_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17943,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_13	[pos="e,17856,1218.7 16913,1293.7 17148,1285.5 17655,1263.6 17846,1221",
		style=dashed];
	layer0_expert5_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="18135,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_14	[pos="e,18048,1218.7 16913,1295.2 17180,1289.5 17809,1271.1 18038,1221",
		style=dashed];
	layer0_expert5_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="18327,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_15	[pos="e,18240,1218.8 16913,1296.4 17210,1292.9 17962,1278.7 18230,1221",
		style=dashed];
	layer0_moe_agg_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_MoE_Aggregate_GPU5
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 5",
		pos="16887,1068",
		shape=rectangle,
		width=2.8194];
	layer0_expert5_0 -> layer0_moe_agg_gpu5	[pos="e,16785,1069.7 15534,1140.2 15537,1139.4 15540,1138.7 15543,1138 15776,1084.6 16496,1072.5 16775,1069.8"];
	layer0_expert5_1 -> layer0_moe_agg_gpu5	[pos="e,16785,1070.7 15726,1140.3 15729,1139.4 15732,1138.7 15735,1138 15930,1092.3 16526,1075.9 16775,1070.9"];
	layer0_expert5_2 -> layer0_moe_agg_gpu5	[pos="e,16785,1072.1 15918,1140.3 15921,1139.5 15924,1138.7 15927,1138 16085,1100.1 16558,1079.9 16775,1072.5"];
	layer0_expert5_3 -> layer0_moe_agg_gpu5	[pos="e,16785,1068.2 16110,1140.4 16113,1139.5 16116,1138.7 16119,1138 16347,1081.1 16624,1069.8 16775,1068.3"];
	layer0_expert5_4 -> layer0_moe_agg_gpu5	[pos="e,16785,1072.6 16302,1140.6 16305,1139.7 16308,1138.8 16311,1138 16469,1096.1 16658,1079.6 16775,1073.1"];
	layer0_expert5_5 -> layer0_moe_agg_gpu5	[pos="e,16785,1081 16494,1140.8 16497,1139.8 16500,1138.9 16503,1138 16593,1111.3 16698,1093.4 16775,1082.4"];
	layer0_expert5_6 -> layer0_moe_agg_gpu5	[pos="e,16792,1102 16686,1141.5 16689,1140.3 16692,1139.2 16695,1138 16723,1127 16754,1115.7 16782,1105.5"];
	layer0_expert5_7 -> layer0_moe_agg_gpu5	[pos="e,16858,1102.3 16827,1137.7 16835,1128.7 16843,1119.1 16851,1110.1"];
	layer0_expert5_8 -> layer0_moe_agg_gpu5	[pos="e,16916,1102.3 16947,1137.7 16939,1128.7 16931,1119.1 16923,1110.1"];
	layer0_expert5_9 -> layer0_moe_agg_gpu5	[pos="e,16982,1102 17088,1141.5 17085,1140.3 17082,1139.2 17079,1138 17051,1127 17020,1115.7 16992,1105.5"];
	layer0_expert5_10 -> layer0_moe_agg_gpu5	[pos="e,16989,1081 17280,1140.8 17277,1139.8 17274,1138.9 17271,1138 17181,1111.3 17076,1093.4 16999,1082.4"];
	layer0_expert5_11 -> layer0_moe_agg_gpu5	[pos="e,16989,1072.6 17472,1140.6 17469,1139.7 17466,1138.8 17463,1138 17305,1096.1 17116,1079.6 16999,1073.1"];
	layer0_expert5_12 -> layer0_moe_agg_gpu5	[pos="e,16989,1068.2 17664,1140.4 17661,1139.5 17658,1138.7 17655,1138 17427,1081.1 17150,1069.8 16999,1068.3"];
	layer0_expert5_13 -> layer0_moe_agg_gpu5	[pos="e,16989,1072.1 17856,1140.3 17853,1139.5 17850,1138.7 17847,1138 17689,1100.1 17216,1079.9 16999,1072.5"];
	layer0_expert5_14 -> layer0_moe_agg_gpu5	[pos="e,16989,1070.7 18048,1140.3 18045,1139.4 18042,1138.7 18039,1138 17844,1092.3 17248,1075.9 16999,1070.9"];
	layer0_expert5_15 -> layer0_moe_agg_gpu5	[pos="e,16989,1069.7 18240,1140.2 18237,1139.4 18234,1138.7 18231,1138 17998,1084.6 17278,1072.5 16999,1069.8"];
	layer0_output_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU5
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 5",
		pos="16887,915",
		shape=rectangle,
		width=3.3889];
	layer0_moe_agg_gpu5 -> layer0_output_gpu5	[pos="e,16887,949.06 16887,1033.9 16887,1011.9 16887,982.95 16887,959.21"];
	layer0_attn_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Multi-Head_Attention_GPU6
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 6",
		pos="17384,1529",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu6 -> layer0_attn_gpu6	[pos="e,17262,1535.8 15355,1626.9 15711,1609.9 16861,1555 17252,1536.3"];
	layer0_attn_norm_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU6
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 6",
		pos="18808,1417.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_gpu6 -> layer0_attn_norm_gpu6	[pos="e,18686,1427.9 17506,1518.6 17771,1498.2 18401,1449.8 18676,1428.7"];
	layer0_gate_gpu6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU6
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 6",
		pos="19863,1298.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu6 -> layer0_gate_gpu6	[pos="e,19741,1313 18930,1403 19130,1380.8 19525,1337 19731,1314.2"];
	layer0_expert6_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="18519,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_0	[pos="e,18606,1218.7 19741,1295.2 19474,1289.5 18845,1271.1 18616,1221",
		style=dashed];
	layer0_expert6_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="18711,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_1	[pos="e,18798,1218.7 19741,1293.7 19506,1285.5 18999,1263.6 18808,1221",
		style=dashed];
	layer0_expert6_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="18903,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_2	[pos="e,18990,1218.6 19741,1291.4 19541,1280.6 19153,1256.2 19000,1221",
		style=dashed];
	layer0_expert6_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19095,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_3	[pos="e,19182,1218.4 19741,1294 19607,1287.9 19386,1270.8 19192,1221",
		style=dashed];
	layer0_expert6_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19287,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_4	[pos="e,19374,1218.3 19741,1286.3 19645,1275.6 19509,1256.1 19384,1221.1",
		style=dashed];
	layer0_expert6_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19479,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_5	[pos="e,19566,1217.9 19741,1269 19692,1256.6 19635,1241 19576,1221.1",
		style=dashed];
	layer0_expert6_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19671,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_6	[pos="e,19737,1221 19796,1256.9 19780,1247 19763,1236.4 19746,1226.3",
		style=dashed];
	layer0_expert6_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19863,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_7	[pos="e,19863,1221 19863,1256.9 19863,1248.6 19863,1239.9 19863,1231.3",
		style=dashed];
	layer0_expert6_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20055,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_8	[pos="e,19989,1221 19930,1256.9 19946,1247 19963,1236.4 19980,1226.3",
		style=dashed];
	layer0_expert6_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20247,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_9	[pos="e,20160,1217.9 19985,1269 20034,1256.6 20091,1241 20150,1221.1",
		style=dashed];
	layer0_expert6_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20439,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_10	[pos="e,20352,1218.3 19985,1286.3 20081,1275.6 20217,1256.1 20342,1221.1",
		style=dashed];
	layer0_expert6_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20631,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_11	[pos="e,20544,1218.4 19985,1294 20119,1287.9 20340,1270.8 20534,1221",
		style=dashed];
	layer0_expert6_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20823,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_12	[pos="e,20736,1218.6 19985,1291.4 20185,1280.6 20573,1256.2 20726,1221",
		style=dashed];
	layer0_expert6_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="21015,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_13	[pos="e,20928,1218.7 19985,1293.7 20220,1285.5 20727,1263.6 20918,1221",
		style=dashed];
	layer0_expert6_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="21207,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_14	[pos="e,21120,1218.7 19985,1295.2 20252,1289.5 20881,1271.1 21110,1221",
		style=dashed];
	layer0_expert6_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="21399,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_15	[pos="e,21312,1218.8 19985,1296.4 20282,1292.9 21034,1278.7 21302,1221",
		style=dashed];
	layer0_moe_agg_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_MoE_Aggregate_GPU6
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 6",
		pos="19959,1068",
		shape=rectangle,
		width=2.8194];
	layer0_expert6_0 -> layer0_moe_agg_gpu6	[pos="e,19857,1069.7 18606,1140.2 18609,1139.4 18612,1138.7 18615,1138 18848,1084.6 19568,1072.5 19847,1069.8"];
	layer0_expert6_1 -> layer0_moe_agg_gpu6	[pos="e,19857,1070.7 18798,1140.3 18801,1139.4 18804,1138.7 18807,1138 19002,1092.3 19598,1075.9 19847,1070.9"];
	layer0_expert6_2 -> layer0_moe_agg_gpu6	[pos="e,19857,1072.1 18990,1140.3 18993,1139.5 18996,1138.7 18999,1138 19157,1100.1 19630,1079.9 19847,1072.5"];
	layer0_expert6_3 -> layer0_moe_agg_gpu6	[pos="e,19857,1068.2 19182,1140.4 19185,1139.5 19188,1138.7 19191,1138 19419,1081.1 19696,1069.8 19847,1068.3"];
	layer0_expert6_4 -> layer0_moe_agg_gpu6	[pos="e,19857,1072.6 19374,1140.6 19377,1139.7 19380,1138.8 19383,1138 19541,1096.1 19730,1079.6 19847,1073.1"];
	layer0_expert6_5 -> layer0_moe_agg_gpu6	[pos="e,19857,1081 19566,1140.8 19569,1139.8 19572,1138.9 19575,1138 19665,1111.3 19770,1093.4 19847,1082.4"];
	layer0_expert6_6 -> layer0_moe_agg_gpu6	[pos="e,19864,1102 19758,1141.5 19761,1140.3 19764,1139.2 19767,1138 19795,1127 19826,1115.7 19854,1105.5"];
	layer0_expert6_7 -> layer0_moe_agg_gpu6	[pos="e,19930,1102.3 19899,1137.7 19907,1128.7 19915,1119.1 19923,1110.1"];
	layer0_expert6_8 -> layer0_moe_agg_gpu6	[pos="e,19988,1102.3 20019,1137.7 20011,1128.7 20003,1119.1 19995,1110.1"];
	layer0_expert6_9 -> layer0_moe_agg_gpu6	[pos="e,20054,1102 20160,1141.5 20157,1140.3 20154,1139.2 20151,1138 20123,1127 20092,1115.7 20064,1105.5"];
	layer0_expert6_10 -> layer0_moe_agg_gpu6	[pos="e,20061,1081 20352,1140.8 20349,1139.8 20346,1138.9 20343,1138 20253,1111.3 20148,1093.4 20071,1082.4"];
	layer0_expert6_11 -> layer0_moe_agg_gpu6	[pos="e,20061,1072.6 20544,1140.6 20541,1139.7 20538,1138.8 20535,1138 20377,1096.1 20188,1079.6 20071,1073.1"];
	layer0_expert6_12 -> layer0_moe_agg_gpu6	[pos="e,20061,1068.2 20736,1140.4 20733,1139.5 20730,1138.7 20727,1138 20499,1081.1 20222,1069.8 20071,1068.3"];
	layer0_expert6_13 -> layer0_moe_agg_gpu6	[pos="e,20061,1072.1 20928,1140.3 20925,1139.5 20922,1138.7 20919,1138 20761,1100.1 20288,1079.9 20071,1072.5"];
	layer0_expert6_14 -> layer0_moe_agg_gpu6	[pos="e,20061,1070.7 21120,1140.3 21117,1139.4 21114,1138.7 21111,1138 20916,1092.3 20320,1075.9 20071,1070.9"];
	layer0_expert6_15 -> layer0_moe_agg_gpu6	[pos="e,20061,1069.7 21312,1140.2 21309,1139.4 21306,1138.7 21303,1138 21070,1084.6 20350,1072.5 20071,1069.8"];
	layer0_output_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU6
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 6",
		pos="19959,915",
		shape=rectangle,
		width=3.3889];
	layer0_moe_agg_gpu6 -> layer0_output_gpu6	[pos="e,19959,949.06 19959,1033.9 19959,1011.9 19959,982.95 19959,959.21"];
	layer0_attn_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Multi-Head_Attention_GPU7
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 7",
		pos="19763,1529",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu7 -> layer0_attn_gpu7	[pos="e,19641,1541.5 18786,1622 18985,1603.2 19414,1562.9 19631,1542.4"];
	layer0_attn_norm_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU7
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 7",
		pos="20475,1417.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_gpu7 -> layer0_attn_norm_gpu7	[pos="e,20353,1437.3 19885,1509.3 20012,1489.7 20211,1459 20343,1438.9"];
	layer0_gate_gpu7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU7
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 7",
		pos="22935,1298.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu7 -> layer0_gate_gpu7	[pos="e,22813,1305.3 20597,1410.7 21014,1390.9 22372,1326.3 22803,1305.8"];
	layer0_expert7_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="21591,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_0	[pos="e,21678,1218.7 22813,1295.2 22546,1289.5 21917,1271.1 21688,1221",
		style=dashed];
	layer0_expert7_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="21783,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_1	[pos="e,21870,1218.7 22813,1293.7 22578,1285.5 22071,1263.6 21880,1221",
		style=dashed];
	layer0_expert7_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="21975,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_2	[pos="e,22062,1218.6 22813,1291.4 22613,1280.6 22225,1256.2 22072,1221",
		style=dashed];
	layer0_expert7_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22167,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_3	[pos="e,22254,1218.4 22813,1294 22679,1287.9 22458,1270.8 22264,1221",
		style=dashed];
	layer0_expert7_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22359,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_4	[pos="e,22446,1218.3 22813,1286.3 22717,1275.6 22581,1256.1 22456,1221.1",
		style=dashed];
	layer0_expert7_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22551,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_5	[pos="e,22638,1217.9 22813,1269 22764,1256.6 22707,1241 22648,1221.1",
		style=dashed];
	layer0_expert7_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22743,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_6	[pos="e,22809,1221 22868,1256.9 22852,1247 22835,1236.4 22818,1226.3",
		style=dashed];
	layer0_expert7_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22935,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_7	[pos="e,22935,1221 22935,1256.9 22935,1248.6 22935,1239.9 22935,1231.3",
		style=dashed];
	layer0_expert7_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23127,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_8	[pos="e,23061,1221 23002,1256.9 23018,1247 23035,1236.4 23052,1226.3",
		style=dashed];
	layer0_expert7_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23319,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_9	[pos="e,23232,1218 23057,1259.4 23060,1258.6 23063,1257.8 23066,1257 23132,1239.2 23153,1242.6 23222,1221.1",
		style=dashed];
	layer0_expert7_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23511,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_10	[pos="e,23424,1218.6 23057,1258.9 23060,1258.2 23063,1257.6 23066,1257 23216,1226.5 23262,1258.3 23414,1221.1",
		style=dashed];
	layer0_expert7_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23703,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_11	[pos="e,23616,1218.7 23057,1258.8 23060,1258.1 23063,1257.5 23066,1257 23300,1213.7 23371,1274.9 23606,1221",
		style=dashed];
	layer0_expert7_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23895,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_12	[pos="e,23808,1218.8 23057,1258.7 23060,1258.1 23063,1257.5 23066,1257 23384,1201 23479,1291.6 23798,1221",
		style=dashed];
	layer0_expert7_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="24087,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_13	[pos="e,24000,1218.8 23057,1258.6 23060,1258.1 23063,1257.5 23066,1257 23468,1188.2 23587,1308.4 23990,1221",
		style=dashed];
	layer0_expert7_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="24279,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_14	[pos="e,24192,1218.8 23057,1258.6 23060,1258 23063,1257.5 23066,1257 23308,1216.5 23924,1272.6 24182,1221",
		style=dashed];
	layer0_expert7_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="24471,1179.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_15	[pos="e,24384,1218.9 23057,1258.6 23060,1258 23063,1257.5 23066,1257 23350,1210.1 24074,1281 24374,1221",
		style=dashed];
	layer0_moe_agg_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_MoE_Aggregate_GPU7
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 7",
		pos="23031,1068",
		shape=rectangle,
		width=2.8194];
	layer0_expert7_0 -> layer0_moe_agg_gpu7	[pos="e,22929,1069.7 21678,1140.2 21681,1139.4 21684,1138.7 21687,1138 21920,1084.6 22640,1072.5 22919,1069.8"];
	layer0_expert7_1 -> layer0_moe_agg_gpu7	[pos="e,22929,1070.7 21870,1140.3 21873,1139.4 21876,1138.7 21879,1138 22074,1092.3 22670,1075.9 22919,1070.9"];
	layer0_expert7_2 -> layer0_moe_agg_gpu7	[pos="e,22929,1072.1 22062,1140.3 22065,1139.5 22068,1138.7 22071,1138 22229,1100.1 22702,1079.9 22919,1072.5"];
	layer0_expert7_3 -> layer0_moe_agg_gpu7	[pos="e,22929,1068.2 22254,1140.4 22257,1139.5 22260,1138.7 22263,1138 22491,1081.1 22768,1069.8 22919,1068.3"];
	layer0_expert7_4 -> layer0_moe_agg_gpu7	[pos="e,22929,1072.6 22446,1140.6 22449,1139.7 22452,1138.8 22455,1138 22613,1096.1 22802,1079.6 22919,1073.1"];
	layer0_expert7_5 -> layer0_moe_agg_gpu7	[pos="e,22929,1081 22638,1140.8 22641,1139.8 22644,1138.9 22647,1138 22737,1111.3 22842,1093.4 22919,1082.4"];
	layer0_expert7_6 -> layer0_moe_agg_gpu7	[pos="e,22936,1102 22830,1141.5 22833,1140.3 22836,1139.2 22839,1138 22867,1127 22898,1115.7 22926,1105.5"];
	layer0_expert7_7 -> layer0_moe_agg_gpu7	[pos="e,23002,1102.3 22971,1137.7 22979,1128.7 22987,1119.1 22995,1110.1"];
	layer0_expert7_8 -> layer0_moe_agg_gpu7	[pos="e,23060,1102.3 23091,1137.7 23083,1128.7 23075,1119.1 23067,1110.1"];
	layer0_expert7_9 -> layer0_moe_agg_gpu7	[pos="e,23126,1102 23232,1141.5 23229,1140.3 23226,1139.2 23223,1138 23195,1127 23164,1115.7 23136,1105.5"];
	layer0_expert7_10 -> layer0_moe_agg_gpu7	[pos="e,23133,1081 23424,1140.8 23421,1139.8 23418,1138.9 23415,1138 23325,1111.3 23220,1093.4 23143,1082.4"];
	layer0_expert7_11 -> layer0_moe_agg_gpu7	[pos="e,23133,1072.6 23616,1140.6 23613,1139.7 23610,1138.8 23607,1138 23449,1096.1 23260,1079.6 23143,1073.1"];
	layer0_expert7_12 -> layer0_moe_agg_gpu7	[pos="e,23133,1068.2 23808,1140.4 23805,1139.5 23802,1138.7 23799,1138 23571,1081.1 23294,1069.8 23143,1068.3"];
	layer0_expert7_13 -> layer0_moe_agg_gpu7	[pos="e,23133,1072.1 24000,1140.3 23997,1139.5 23994,1138.7 23991,1138 23833,1100.1 23360,1079.9 23143,1072.5"];
	layer0_expert7_14 -> layer0_moe_agg_gpu7	[pos="e,23133,1070.7 24192,1140.3 24189,1139.4 24186,1138.7 24183,1138 23988,1092.3 23392,1075.9 23143,1070.9"];
	layer0_expert7_15 -> layer0_moe_agg_gpu7	[pos="e,23133,1069.7 24384,1140.2 24381,1139.4 24378,1138.7 24375,1138 24142,1084.6 23422,1072.5 23143,1069.8"];
	layer0_output_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU7
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 7",
		pos="23031,915",
		shape=rectangle,
		width=3.3889];
	layer0_moe_agg_gpu7 -> layer0_output_gpu7	[pos="e,23031,949.06 23031,1033.9 23031,1011.9 23031,982.95 23031,959.21"];
	layer1_qkv_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_QKV_Projection_GPU0
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 0",
		pos="24602,1744.5",
		shape=rectangle,
		width=2.9444];
	layer1_attn_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU0
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 0",
		pos="24602,1633",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu0 -> layer1_attn_gpu0	[pos="e,24602,1667 24602,1710.3 24602,1699.9 24602,1688.3 24602,1677.3"];
	layer1_attn_norm_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU0
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 0",
		pos="24602,1529",
		shape=rectangle,
		width=3.3889];
	layer1_attn_gpu0 -> layer1_attn_norm_gpu0	[pos="e,24602,1563.3 24602,1598.9 24602,1590.8 24602,1582 24602,1573.5"];
	layer1_gate_gpu0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU0
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 0",
		pos="24602,1417.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu0 -> layer1_gate_gpu0	[pos="e,24602,1459.3 24602,1494.8 24602,1486.8 24602,1478 24602,1469.3"];
	layer1_expert0_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="23162,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_0	[pos="e,23249,1337.7 24480,1414.9 24198,1410.3 23508,1393.9 23259,1340",
		style=dashed];
	layer1_expert0_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="23354,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_1	[pos="e,23441,1337.7 24480,1413.5 24229,1406.5 23661,1386.4 23451,1340",
		style=dashed];
	layer1_expert0_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="23546,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_2	[pos="e,23633,1337.7 24480,1411.6 24262,1402.2 23816,1378.9 23643,1340",
		style=dashed];
	layer1_expert0_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="23738,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_3	[pos="e,23825,1337.6 24480,1415.5 24329,1411.9 24065,1397.2 23835,1340.1",
		style=dashed];
	layer1_expert0_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="23930,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_4	[pos="e,24017,1337.4 24480,1409.8 24364,1401.2 24187,1382.5 24027,1340.1",
		style=dashed];
	layer1_expert0_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="24122,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_5	[pos="e,24209,1337.1 24480,1398.7 24406,1386.4 24311,1367.7 24219,1340.1",
		style=dashed];
	layer1_expert0_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="24314,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_6	[pos="e,24401,1336.3 24499,1376 24473,1365.5 24444,1354 24411,1340.3",
		style=dashed];
	layer1_expert0_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="24506,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_7	[pos="e,24539,1340 24569,1375.9 24561,1366.8 24553,1357.1 24546,1347.8",
		style=dashed];
	layer1_expert0_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="24698,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_8	[pos="e,24665,1340 24635,1375.9 24643,1366.8 24651,1357.1 24658,1347.8",
		style=dashed];
	layer1_expert0_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="24890,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_9	[pos="e,24803,1336.3 24705,1376 24731,1365.5 24760,1354 24793,1340.3",
		style=dashed];
	layer1_expert0_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="25082,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_10	[pos="e,24995,1337.1 24724,1398.7 24798,1386.4 24893,1367.7 24985,1340.1",
		style=dashed];
	layer1_expert0_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="25274,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_11	[pos="e,25187,1337.4 24724,1409.8 24840,1401.2 25017,1382.5 25177,1340.1",
		style=dashed];
	layer1_expert0_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="25466,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_12	[pos="e,25379,1337.6 24724,1415.5 24875,1411.9 25139,1397.2 25369,1340.1",
		style=dashed];
	layer1_expert0_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="25658,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_13	[pos="e,25571,1337.7 24724,1411.6 24942,1402.2 25388,1378.9 25561,1340",
		style=dashed];
	layer1_expert0_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="25850,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_14	[pos="e,25763,1337.7 24724,1413.5 24975,1406.5 25543,1386.4 25753,1340",
		style=dashed];
	layer1_expert0_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="26042,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_15	[pos="e,25955,1337.7 24724,1414.9 25006,1410.3 25696,1393.9 25945,1340",
		style=dashed];
	layer1_moe_agg_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_MoE_Aggregate_GPU0
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 0",
		pos="24698,1179.5",
		shape=rectangle,
		width=2.8194];
	layer1_expert0_0 -> layer1_moe_agg_gpu0	[pos="e,24601,1213.6 23249,1259.1 23252,1258.4 23255,1257.6 23258,1257 23542,1195.4 24280,1268.4 24567,1221 24575,1219.7 24583,1217.9 \
24592,1216"];
	layer1_expert0_1 -> layer1_moe_agg_gpu0	[pos="e,24601,1213.5 23441,1259.2 23444,1258.4 23447,1257.6 23450,1257 23693,1203.8 24322,1262 24567,1221 24575,1219.6 24583,1217.9 24592,\
1215.9"];
	layer1_expert0_2 -> layer1_moe_agg_gpu0	[pos="e,24601,1213.5 23633,1259.2 23636,1258.4 23639,1257.6 23642,1257 24044,1167.6 24161,1290.3 24567,1221 24575,1219.6 24583,1217.9 \
24591,1216"];
	layer1_expert0_3 -> layer1_moe_agg_gpu0	[pos="e,24601,1213.5 23825,1259.2 23828,1258.4 23831,1257.7 23834,1257 24152,1184.5 24246,1277.6 24567,1221 24575,1219.6 24583,1217.9 \
24591,1216"];
	layer1_expert0_4 -> layer1_moe_agg_gpu0	[pos="e,24600,1213.5 24017,1259.3 24020,1258.5 24023,1257.7 24026,1257 24260,1201.4 24330,1264.9 24567,1221 24575,1219.6 24582,1217.9 \
24590,1216"];
	layer1_expert0_5 -> layer1_moe_agg_gpu0	[pos="e,24598,1213.5 24209,1259.4 24212,1258.6 24215,1257.7 24218,1257 24369,1218.3 24414,1252.2 24567,1221 24574,1219.6 24581,1217.9 \
24589,1216.1"];
	layer1_expert0_6 -> layer1_moe_agg_gpu0	[pos="e,24596,1212.8 24401,1260 24404,1258.9 24407,1257.9 24410,1257 24478,1235 24498,1239.6 24567,1221 24573,1219.3 24580,1217.4 24587,\
1215.6"];
	layer1_expert0_7 -> layer1_moe_agg_gpu0	[pos="e,24644,1213.7 24573,1256.9 24593,1244.6 24615,1231.1 24635,1219"];
	layer1_expert0_8 -> layer1_moe_agg_gpu0	[pos="e,24698,1213.7 24698,1256.9 24698,1246.2 24698,1234.6 24698,1223.8"];
	layer1_expert0_9 -> layer1_moe_agg_gpu0	[pos="e,24752,1213.7 24823,1256.9 24803,1244.6 24781,1231.1 24761,1219"];
	layer1_expert0_10 -> layer1_moe_agg_gpu0	[pos="e,24800,1203.8 24995,1260.1 24992,1259 24989,1258 24986,1257 24929,1237.4 24863,1219.7 24810,1206.3"];
	layer1_expert0_11 -> layer1_moe_agg_gpu0	[pos="e,24800,1189.5 25187,1259.7 25184,1258.8 25181,1257.8 25178,1257 25054,1221.7 24908,1201.3 24810,1190.6"];
	layer1_expert0_12 -> layer1_moe_agg_gpu0	[pos="e,24800,1183.1 25379,1259.6 25376,1258.6 25373,1257.8 25370,1257 25177,1206.5 24945,1189.3 24810,1183.5"];
	layer1_expert0_13 -> layer1_moe_agg_gpu0	[pos="e,24800,1185.5 25571,1259.4 25568,1258.5 25565,1257.7 25562,1257 25422,1222.3 25010,1196.8 24810,1186.1"];
	layer1_expert0_14 -> layer1_moe_agg_gpu0	[pos="e,24800,1183.6 25763,1259.3 25760,1258.5 25757,1257.7 25754,1257 25577,1214.6 25044,1192 24810,1184"];
	layer1_expert0_15 -> layer1_moe_agg_gpu0	[pos="e,24800,1182.3 25955,1259.3 25952,1258.4 25949,1257.7 25946,1257 25732,1206.8 25074,1188.1 24810,1182.5"];
	layer1_output_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU0
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 0",
		pos="26103,1068",
		shape=rectangle,
		width=3.3889];
	layer1_moe_agg_gpu0 -> layer1_output_gpu0	[pos="e,25981,1078.5 24800,1170.6 25049,1151.1 25692,1101 25971,1079.3"];
	pipeline_stage0_1	[fillcolor=yellow,
		height=2.3056,
		label="Pipeline_Stage0_to_1
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Cross-stage communication
GPU: 7 -> 8",
		pos="35092,915",
		shape=parallelogram,
		width=6.1629];
	layer1_output_gpu0 -> pipeline_stage0_1	[pos="e,34918,918.93 26225,1064.9 27202,1048.5 33722,939.02 34907,919.1"];
	layer1_qkv_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_QKV_Projection_GPU1
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 1",
		pos="27674,1744.5",
		shape=rectangle,
		width=2.9444];
	layer1_attn_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU1
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 1",
		pos="27674,1633",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu1 -> layer1_attn_gpu1	[pos="e,27674,1667 27674,1710.3 27674,1699.9 27674,1688.3 27674,1677.3"];
	layer1_attn_norm_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU1
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 1",
		pos="27674,1529",
		shape=rectangle,
		width=3.3889];
	layer1_attn_gpu1 -> layer1_attn_norm_gpu1	[pos="e,27674,1563.3 27674,1598.9 27674,1590.8 27674,1582 27674,1573.5"];
	layer1_gate_gpu1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU1
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 1",
		pos="27674,1417.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu1 -> layer1_gate_gpu1	[pos="e,27674,1459.3 27674,1494.8 27674,1486.8 27674,1478 27674,1469.3"];
	layer1_expert1_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="26234,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_0	[pos="e,26321,1337.7 27552,1414.9 27270,1410.3 26580,1393.9 26331,1340",
		style=dashed];
	layer1_expert1_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="26426,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_1	[pos="e,26513,1337.7 27552,1413.5 27301,1406.5 26733,1386.4 26523,1340",
		style=dashed];
	layer1_expert1_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="26618,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_2	[pos="e,26705,1337.7 27552,1411.6 27334,1402.2 26888,1378.9 26715,1340",
		style=dashed];
	layer1_expert1_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="26810,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_3	[pos="e,26897,1337.6 27552,1415.5 27401,1411.9 27137,1397.2 26907,1340.1",
		style=dashed];
	layer1_expert1_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="27002,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_4	[pos="e,27089,1337.4 27552,1409.8 27436,1401.2 27259,1382.5 27099,1340.1",
		style=dashed];
	layer1_expert1_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="27194,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_5	[pos="e,27281,1337.1 27552,1398.7 27478,1386.4 27383,1367.7 27291,1340.1",
		style=dashed];
	layer1_expert1_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="27386,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_6	[pos="e,27473,1336.3 27571,1376 27545,1365.5 27516,1354 27483,1340.3",
		style=dashed];
	layer1_expert1_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="27578,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_7	[pos="e,27611,1340 27641,1375.9 27633,1366.8 27625,1357.1 27618,1347.8",
		style=dashed];
	layer1_expert1_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="27770,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_8	[pos="e,27737,1340 27707,1375.9 27715,1366.8 27723,1357.1 27730,1347.8",
		style=dashed];
	layer1_expert1_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="27962,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_9	[pos="e,27875,1336.3 27777,1376 27803,1365.5 27832,1354 27865,1340.3",
		style=dashed];
	layer1_expert1_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="28154,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_10	[pos="e,28067,1337.1 27796,1398.7 27870,1386.4 27965,1367.7 28057,1340.1",
		style=dashed];
	layer1_expert1_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="28346,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_11	[pos="e,28259,1337.4 27796,1409.8 27912,1401.2 28089,1382.5 28249,1340.1",
		style=dashed];
	layer1_expert1_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="28538,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_12	[pos="e,28451,1337.6 27796,1415.5 27947,1411.9 28211,1397.2 28441,1340.1",
		style=dashed];
	layer1_expert1_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="28730,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_13	[pos="e,28643,1337.7 27796,1411.6 28014,1402.2 28460,1378.9 28633,1340",
		style=dashed];
	layer1_expert1_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="28922,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_14	[pos="e,28835,1337.7 27796,1413.5 28047,1406.5 28615,1386.4 28825,1340",
		style=dashed];
	layer1_expert1_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="29114,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_15	[pos="e,29027,1337.7 27796,1414.9 28078,1410.3 28768,1393.9 29017,1340",
		style=dashed];
	layer1_moe_agg_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_MoE_Aggregate_GPU1
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 1",
		pos="27770,1179.5",
		shape=rectangle,
		width=2.8194];
	layer1_expert1_0 -> layer1_moe_agg_gpu1	[pos="e,27668,1181.4 26321,1259.2 26324,1258.4 26327,1257.7 26330,1257 26582,1199 27365,1184.8 27658,1181.5"];
	layer1_expert1_1 -> layer1_moe_agg_gpu1	[pos="e,27668,1182.3 26513,1259.3 26516,1258.4 26519,1257.7 26522,1257 26736,1206.8 27394,1188.1 27658,1182.5"];
	layer1_expert1_2 -> layer1_moe_agg_gpu1	[pos="e,27668,1183.6 26705,1259.3 26708,1258.5 26711,1257.7 26714,1257 26891,1214.6 27424,1192 27658,1184"];
	layer1_expert1_3 -> layer1_moe_agg_gpu1	[pos="e,27668,1185.5 26897,1259.4 26900,1258.5 26903,1257.7 26906,1257 27046,1222.3 27458,1196.8 27658,1186.1"];
	layer1_expert1_4 -> layer1_moe_agg_gpu1	[pos="e,27668,1183.1 27089,1259.6 27092,1258.6 27095,1257.8 27098,1257 27291,1206.5 27523,1189.3 27658,1183.5"];
	layer1_expert1_5 -> layer1_moe_agg_gpu1	[pos="e,27668,1189.5 27281,1259.7 27284,1258.8 27287,1257.8 27290,1257 27414,1221.7 27560,1201.3 27658,1190.6"];
	layer1_expert1_6 -> layer1_moe_agg_gpu1	[pos="e,27668,1203.8 27473,1260.1 27476,1259 27479,1258 27482,1257 27539,1237.4 27605,1219.7 27658,1206.3"];
	layer1_expert1_7 -> layer1_moe_agg_gpu1	[pos="e,27716,1213.7 27645,1256.9 27665,1244.6 27687,1231.1 27707,1219"];
	layer1_expert1_8 -> layer1_moe_agg_gpu1	[pos="e,27770,1213.7 27770,1256.9 27770,1246.2 27770,1234.6 27770,1223.8"];
	layer1_expert1_9 -> layer1_moe_agg_gpu1	[pos="e,27824,1213.7 27895,1256.9 27875,1244.6 27853,1231.1 27833,1219"];
	layer1_expert1_10 -> layer1_moe_agg_gpu1	[pos="e,27872,1203.8 28067,1260.1 28064,1259 28061,1258 28058,1257 28001,1237.4 27935,1219.7 27882,1206.3"];
	layer1_expert1_11 -> layer1_moe_agg_gpu1	[pos="e,27872,1189.5 28259,1259.7 28256,1258.8 28253,1257.8 28250,1257 28126,1221.7 27980,1201.3 27882,1190.6"];
	layer1_expert1_12 -> layer1_moe_agg_gpu1	[pos="e,27872,1183.1 28451,1259.6 28448,1258.6 28445,1257.8 28442,1257 28249,1206.5 28017,1189.3 27882,1183.5"];
	layer1_expert1_13 -> layer1_moe_agg_gpu1	[pos="e,27872,1185.5 28643,1259.4 28640,1258.5 28637,1257.7 28634,1257 28494,1222.3 28082,1196.8 27882,1186.1"];
	layer1_expert1_14 -> layer1_moe_agg_gpu1	[pos="e,27872,1183.6 28835,1259.3 28832,1258.5 28829,1257.7 28826,1257 28649,1214.6 28116,1192 27882,1184"];
	layer1_expert1_15 -> layer1_moe_agg_gpu1	[pos="e,27872,1182.3 29027,1259.3 29024,1258.4 29021,1257.7 29018,1257 28804,1206.8 28146,1188.1 27882,1182.5"];
	layer1_output_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU1
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 1",
		pos="29175,1068",
		shape=rectangle,
		width=3.3889];
	layer1_moe_agg_gpu1 -> layer1_output_gpu1	[pos="e,29053,1078.5 27872,1170.6 28121,1151.1 28764,1101 29043,1079.3"];
	layer1_output_gpu1 -> pipeline_stage0_1	[pos="e,34918,920.43 29297,1063.9 30045,1044.8 34004,943.76 34908,920.69"];
	layer1_qkv_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_QKV_Projection_GPU2
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 2",
		pos="30746,1744.5",
		shape=rectangle,
		width=2.9444];
	layer1_attn_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU2
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 2",
		pos="30746,1633",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu2 -> layer1_attn_gpu2	[pos="e,30746,1667 30746,1710.3 30746,1699.9 30746,1688.3 30746,1677.3"];
	layer1_attn_norm_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU2
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 2",
		pos="30746,1529",
		shape=rectangle,
		width=3.3889];
	layer1_attn_gpu2 -> layer1_attn_norm_gpu2	[pos="e,30746,1563.3 30746,1598.9 30746,1590.8 30746,1582 30746,1573.5"];
	layer1_gate_gpu2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU2
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 2",
		pos="30746,1417.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu2 -> layer1_gate_gpu2	[pos="e,30746,1459.3 30746,1494.8 30746,1486.8 30746,1478 30746,1469.3"];
	layer1_expert2_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="29306,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_0	[pos="e,29393,1337.7 30624,1414.9 30342,1410.3 29652,1393.9 29403,1340",
		style=dashed];
	layer1_expert2_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="29498,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_1	[pos="e,29585,1337.7 30624,1413.5 30373,1406.5 29805,1386.4 29595,1340",
		style=dashed];
	layer1_expert2_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="29690,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_2	[pos="e,29777,1337.7 30624,1411.6 30406,1402.2 29960,1378.9 29787,1340",
		style=dashed];
	layer1_expert2_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="29882,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_3	[pos="e,29969,1337.6 30624,1415.5 30473,1411.9 30209,1397.2 29979,1340.1",
		style=dashed];
	layer1_expert2_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="30074,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_4	[pos="e,30161,1337.4 30624,1409.8 30508,1401.2 30331,1382.5 30171,1340.1",
		style=dashed];
	layer1_expert2_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="30266,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_5	[pos="e,30353,1337.1 30624,1398.7 30550,1386.4 30455,1367.7 30363,1340.1",
		style=dashed];
	layer1_expert2_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="30458,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_6	[pos="e,30545,1336.3 30643,1376 30617,1365.5 30588,1354 30555,1340.3",
		style=dashed];
	layer1_expert2_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="30650,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_7	[pos="e,30683,1340 30713,1375.9 30705,1366.8 30697,1357.1 30690,1347.8",
		style=dashed];
	layer1_expert2_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="30842,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_8	[pos="e,30809,1340 30779,1375.9 30787,1366.8 30795,1357.1 30802,1347.8",
		style=dashed];
	layer1_expert2_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="31034,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_9	[pos="e,30947,1336.3 30849,1376 30875,1365.5 30904,1354 30937,1340.3",
		style=dashed];
	layer1_expert2_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="31226,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_10	[pos="e,31139,1337.1 30868,1398.7 30942,1386.4 31037,1367.7 31129,1340.1",
		style=dashed];
	layer1_expert2_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="31418,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_11	[pos="e,31331,1337.4 30868,1409.8 30984,1401.2 31161,1382.5 31321,1340.1",
		style=dashed];
	layer1_expert2_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="31610,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_12	[pos="e,31523,1337.6 30868,1415.5 31019,1411.9 31283,1397.2 31513,1340.1",
		style=dashed];
	layer1_expert2_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="31802,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_13	[pos="e,31715,1337.7 30868,1411.6 31086,1402.2 31532,1378.9 31705,1340",
		style=dashed];
	layer1_expert2_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="31994,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_14	[pos="e,31907,1337.7 30868,1413.5 31119,1406.5 31687,1386.4 31897,1340",
		style=dashed];
	layer1_expert2_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="32186,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_15	[pos="e,32099,1337.7 30868,1414.9 31150,1410.3 31840,1393.9 32089,1340",
		style=dashed];
	layer1_moe_agg_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_MoE_Aggregate_GPU2
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 2",
		pos="30842,1179.5",
		shape=rectangle,
		width=2.8194];
	layer1_expert2_0 -> layer1_moe_agg_gpu2	[pos="e,30740,1181.4 29393,1259.2 29396,1258.4 29399,1257.7 29402,1257 29654,1199 30437,1184.8 30730,1181.5"];
	layer1_expert2_1 -> layer1_moe_agg_gpu2	[pos="e,30740,1182.3 29585,1259.3 29588,1258.4 29591,1257.7 29594,1257 29808,1206.8 30466,1188.1 30730,1182.5"];
	layer1_expert2_2 -> layer1_moe_agg_gpu2	[pos="e,30740,1183.6 29777,1259.3 29780,1258.5 29783,1257.7 29786,1257 29963,1214.6 30496,1192 30730,1184"];
	layer1_expert2_3 -> layer1_moe_agg_gpu2	[pos="e,30740,1185.5 29969,1259.4 29972,1258.5 29975,1257.7 29978,1257 30118,1222.3 30530,1196.8 30730,1186.1"];
	layer1_expert2_4 -> layer1_moe_agg_gpu2	[pos="e,30740,1183.1 30161,1259.6 30164,1258.6 30167,1257.8 30170,1257 30363,1206.5 30595,1189.3 30730,1183.5"];
	layer1_expert2_5 -> layer1_moe_agg_gpu2	[pos="e,30740,1189.5 30353,1259.7 30356,1258.8 30359,1257.8 30362,1257 30486,1221.7 30632,1201.3 30730,1190.6"];
	layer1_expert2_6 -> layer1_moe_agg_gpu2	[pos="e,30740,1203.8 30545,1260.1 30548,1259 30551,1258 30554,1257 30611,1237.4 30677,1219.7 30730,1206.3"];
	layer1_expert2_7 -> layer1_moe_agg_gpu2	[pos="e,30788,1213.7 30717,1256.9 30737,1244.6 30759,1231.1 30779,1219"];
	layer1_expert2_8 -> layer1_moe_agg_gpu2	[pos="e,30842,1213.7 30842,1256.9 30842,1246.2 30842,1234.6 30842,1223.8"];
	layer1_expert2_9 -> layer1_moe_agg_gpu2	[pos="e,30896,1213.7 30967,1256.9 30947,1244.6 30925,1231.1 30905,1219"];
	layer1_expert2_10 -> layer1_moe_agg_gpu2	[pos="e,30944,1203.8 31139,1260.1 31136,1259 31133,1258 31130,1257 31073,1237.4 31007,1219.7 30954,1206.3"];
	layer1_expert2_11 -> layer1_moe_agg_gpu2	[pos="e,30944,1189.5 31331,1259.7 31328,1258.8 31325,1257.8 31322,1257 31198,1221.7 31052,1201.3 30954,1190.6"];
	layer1_expert2_12 -> layer1_moe_agg_gpu2	[pos="e,30944,1183.1 31523,1259.6 31520,1258.6 31517,1257.8 31514,1257 31321,1206.5 31089,1189.3 30954,1183.5"];
	layer1_expert2_13 -> layer1_moe_agg_gpu2	[pos="e,30944,1185.5 31715,1259.4 31712,1258.5 31709,1257.7 31706,1257 31566,1222.3 31154,1196.8 30954,1186.1"];
	layer1_expert2_14 -> layer1_moe_agg_gpu2	[pos="e,30944,1183.6 31907,1259.3 31904,1258.5 31901,1257.7 31898,1257 31721,1214.6 31188,1192 30954,1184"];
	layer1_expert2_15 -> layer1_moe_agg_gpu2	[pos="e,30944,1182.3 32099,1259.3 32096,1258.4 32093,1257.7 32090,1257 31876,1206.8 31218,1188.1 30954,1182.5"];
	layer1_output_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU2
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 2",
		pos="32247,1068",
		shape=rectangle,
		width=3.3889];
	layer1_moe_agg_gpu2 -> layer1_output_gpu2	[pos="e,32125,1078.5 30944,1170.6 31193,1151.1 31836,1101 32115,1079.3"];
	layer1_output_gpu2 -> pipeline_stage0_1	[pos="e,34921,925.07 32369,1060.5 32818,1036.7 34377,953.94 34911,925.61"];
	layer1_qkv_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_QKV_Projection_GPU3
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 3",
		pos="33818,1744.5",
		shape=rectangle,
		width=2.9444];
	layer1_attn_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU3
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 3",
		pos="33818,1633",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu3 -> layer1_attn_gpu3	[pos="e,33818,1667 33818,1710.3 33818,1699.9 33818,1688.3 33818,1677.3"];
	layer1_attn_norm_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU3
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 3",
		pos="33818,1529",
		shape=rectangle,
		width=3.3889];
	layer1_attn_gpu3 -> layer1_attn_norm_gpu3	[pos="e,33818,1563.3 33818,1598.9 33818,1590.8 33818,1582 33818,1573.5"];
	layer1_gate_gpu3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU3
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 3",
		pos="33818,1417.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu3 -> layer1_gate_gpu3	[pos="e,33818,1459.3 33818,1494.8 33818,1486.8 33818,1478 33818,1469.3"];
	layer1_expert3_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="32378,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_0	[pos="e,32465,1337.7 33696,1414.9 33414,1410.3 32724,1393.9 32475,1340",
		style=dashed];
	layer1_expert3_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="32570,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_1	[pos="e,32657,1337.7 33696,1413.5 33445,1406.5 32877,1386.4 32667,1340",
		style=dashed];
	layer1_expert3_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="32762,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_2	[pos="e,32849,1337.7 33696,1411.6 33478,1402.2 33032,1378.9 32859,1340",
		style=dashed];
	layer1_expert3_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="32954,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_3	[pos="e,33041,1337.6 33696,1415.5 33545,1411.9 33281,1397.2 33051,1340.1",
		style=dashed];
	layer1_expert3_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="33146,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_4	[pos="e,33233,1337.4 33696,1409.8 33580,1401.2 33403,1382.5 33243,1340.1",
		style=dashed];
	layer1_expert3_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="33338,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_5	[pos="e,33425,1337.1 33696,1398.7 33622,1386.4 33527,1367.7 33435,1340.1",
		style=dashed];
	layer1_expert3_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="33530,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_6	[pos="e,33617,1336.3 33715,1376 33689,1365.5 33660,1354 33627,1340.3",
		style=dashed];
	layer1_expert3_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="33722,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_7	[pos="e,33755,1340 33785,1375.9 33777,1366.8 33769,1357.1 33762,1347.8",
		style=dashed];
	layer1_expert3_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="33914,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_8	[pos="e,33881,1340 33851,1375.9 33859,1366.8 33867,1357.1 33874,1347.8",
		style=dashed];
	layer1_expert3_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="34106,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_9	[pos="e,34019,1336.3 33921,1376 33947,1365.5 33976,1354 34009,1340.3",
		style=dashed];
	layer1_expert3_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="34298,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_10	[pos="e,34211,1337.1 33940,1398.7 34014,1386.4 34109,1367.7 34201,1340.1",
		style=dashed];
	layer1_expert3_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="34490,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_11	[pos="e,34403,1337.4 33940,1409.8 34056,1401.2 34233,1382.5 34393,1340.1",
		style=dashed];
	layer1_expert3_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="34682,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_12	[pos="e,34595,1337.6 33940,1415.5 34091,1411.9 34355,1397.2 34585,1340.1",
		style=dashed];
	layer1_expert3_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="34874,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_13	[pos="e,34787,1337.7 33940,1411.6 34158,1402.2 34604,1378.9 34777,1340",
		style=dashed];
	layer1_expert3_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="35066,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_14	[pos="e,34979,1337.7 33940,1413.5 34191,1406.5 34759,1386.4 34969,1340",
		style=dashed];
	layer1_expert3_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="35258,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_15	[pos="e,35171,1337.7 33940,1414.9 34222,1410.3 34912,1393.9 35161,1340",
		style=dashed];
	layer1_moe_agg_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_MoE_Aggregate_GPU3
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 3",
		pos="33914,1179.5",
		shape=rectangle,
		width=2.8194];
	layer1_expert3_0 -> layer1_moe_agg_gpu3	[pos="e,33812,1181.4 32465,1259.2 32468,1258.4 32471,1257.7 32474,1257 32726,1199 33509,1184.8 33802,1181.5"];
	layer1_expert3_1 -> layer1_moe_agg_gpu3	[pos="e,33812,1182.3 32657,1259.3 32660,1258.4 32663,1257.7 32666,1257 32880,1206.8 33538,1188.1 33802,1182.5"];
	layer1_expert3_2 -> layer1_moe_agg_gpu3	[pos="e,33812,1183.6 32849,1259.3 32852,1258.5 32855,1257.7 32858,1257 33035,1214.6 33568,1192 33802,1184"];
	layer1_expert3_3 -> layer1_moe_agg_gpu3	[pos="e,33812,1185.5 33041,1259.4 33044,1258.5 33047,1257.7 33050,1257 33190,1222.3 33602,1196.8 33802,1186.1"];
	layer1_expert3_4 -> layer1_moe_agg_gpu3	[pos="e,33812,1183.1 33233,1259.6 33236,1258.6 33239,1257.8 33242,1257 33435,1206.5 33667,1189.3 33802,1183.5"];
	layer1_expert3_5 -> layer1_moe_agg_gpu3	[pos="e,33812,1189.5 33425,1259.7 33428,1258.8 33431,1257.8 33434,1257 33558,1221.7 33704,1201.3 33802,1190.6"];
	layer1_expert3_6 -> layer1_moe_agg_gpu3	[pos="e,33812,1203.8 33617,1260.1 33620,1259 33623,1258 33626,1257 33683,1237.4 33749,1219.7 33802,1206.3"];
	layer1_expert3_7 -> layer1_moe_agg_gpu3	[pos="e,33860,1213.7 33789,1256.9 33809,1244.6 33831,1231.1 33851,1219"];
	layer1_expert3_8 -> layer1_moe_agg_gpu3	[pos="e,33914,1213.7 33914,1256.9 33914,1246.2 33914,1234.6 33914,1223.8"];
	layer1_expert3_9 -> layer1_moe_agg_gpu3	[pos="e,33968,1213.7 34039,1256.9 34019,1244.6 33997,1231.1 33977,1219"];
	layer1_expert3_10 -> layer1_moe_agg_gpu3	[pos="e,34016,1203.8 34211,1260.1 34208,1259 34205,1258 34202,1257 34145,1237.4 34079,1219.7 34026,1206.3"];
	layer1_expert3_11 -> layer1_moe_agg_gpu3	[pos="e,34016,1189.5 34403,1259.7 34400,1258.8 34397,1257.8 34394,1257 34270,1221.7 34124,1201.3 34026,1190.6"];
	layer1_expert3_12 -> layer1_moe_agg_gpu3	[pos="e,34016,1183.1 34595,1259.6 34592,1258.6 34589,1257.8 34586,1257 34393,1206.5 34161,1189.3 34026,1183.5"];
	layer1_expert3_13 -> layer1_moe_agg_gpu3	[pos="e,34016,1185.5 34787,1259.4 34784,1258.5 34781,1257.7 34778,1257 34638,1222.3 34226,1196.8 34026,1186.1"];
	layer1_expert3_14 -> layer1_moe_agg_gpu3	[pos="e,34016,1183.6 34979,1259.3 34976,1258.5 34973,1257.7 34970,1257 34793,1214.6 34260,1192 34026,1184"];
	layer1_expert3_15 -> layer1_moe_agg_gpu3	[pos="e,34016,1182.3 35171,1259.3 35168,1258.4 35165,1257.7 35162,1257 34948,1206.8 34290,1188.1 34026,1182.5"];
	layer1_output_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU3
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 3",
		pos="34307,1068",
		shape=rectangle,
		width=3.3889];
	layer1_moe_agg_gpu3 -> layer1_output_gpu3	[pos="e,34188,1102.1 34016,1150.2 34065,1136.3 34126,1119.5 34179,1104.8"];
	layer1_output_gpu3 -> pipeline_stage0_1	[pos="e,34933,946.64 34429,1043.5 34562,1018 34774,977.16 34923,948.59"];
	layer1_qkv_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_QKV_Projection_GPU4
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 4",
		pos="36890,1744.5",
		shape=rectangle,
		width=2.9444];
	layer1_attn_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU4
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 4",
		pos="36890,1633",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu4 -> layer1_attn_gpu4	[pos="e,36890,1667 36890,1710.3 36890,1699.9 36890,1688.3 36890,1677.3"];
	layer1_attn_norm_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU4
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 4",
		pos="36890,1529",
		shape=rectangle,
		width=3.3889];
	layer1_attn_gpu4 -> layer1_attn_norm_gpu4	[pos="e,36890,1563.3 36890,1598.9 36890,1590.8 36890,1582 36890,1573.5"];
	layer1_gate_gpu4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU4
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 4",
		pos="36890,1417.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu4 -> layer1_gate_gpu4	[pos="e,36890,1459.3 36890,1494.8 36890,1486.8 36890,1478 36890,1469.3"];
	layer1_expert4_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="35450,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_0	[pos="e,35537,1337.7 36768,1414.9 36486,1410.3 35796,1393.9 35547,1340",
		style=dashed];
	layer1_expert4_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="35642,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_1	[pos="e,35729,1337.7 36768,1413.5 36517,1406.5 35949,1386.4 35739,1340",
		style=dashed];
	layer1_expert4_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="35834,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_2	[pos="e,35921,1337.7 36768,1411.6 36550,1402.2 36104,1378.9 35931,1340",
		style=dashed];
	layer1_expert4_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="36026,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_3	[pos="e,36113,1337.6 36768,1415.5 36617,1411.9 36353,1397.2 36123,1340.1",
		style=dashed];
	layer1_expert4_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="36218,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_4	[pos="e,36305,1337.4 36768,1409.8 36652,1401.2 36475,1382.5 36315,1340.1",
		style=dashed];
	layer1_expert4_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="36410,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_5	[pos="e,36497,1337.1 36768,1398.7 36694,1386.4 36599,1367.7 36507,1340.1",
		style=dashed];
	layer1_expert4_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="36602,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_6	[pos="e,36689,1336.3 36787,1376 36761,1365.5 36732,1354 36699,1340.3",
		style=dashed];
	layer1_expert4_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="36794,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_7	[pos="e,36827,1340 36857,1375.9 36849,1366.8 36841,1357.1 36834,1347.8",
		style=dashed];
	layer1_expert4_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="36986,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_8	[pos="e,36953,1340 36923,1375.9 36931,1366.8 36939,1357.1 36946,1347.8",
		style=dashed];
	layer1_expert4_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="37178,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_9	[pos="e,37091,1336.3 36993,1376 37019,1365.5 37048,1354 37081,1340.3",
		style=dashed];
	layer1_expert4_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="37370,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_10	[pos="e,37283,1337.1 37012,1398.7 37086,1386.4 37181,1367.7 37273,1340.1",
		style=dashed];
	layer1_expert4_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="37562,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_11	[pos="e,37475,1337.4 37012,1409.8 37128,1401.2 37305,1382.5 37465,1340.1",
		style=dashed];
	layer1_expert4_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="37754,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_12	[pos="e,37667,1337.6 37012,1415.5 37163,1411.9 37427,1397.2 37657,1340.1",
		style=dashed];
	layer1_expert4_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="37946,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_13	[pos="e,37859,1337.7 37012,1411.6 37230,1402.2 37676,1378.9 37849,1340",
		style=dashed];
	layer1_expert4_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="38138,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_14	[pos="e,38051,1337.7 37012,1413.5 37263,1406.5 37831,1386.4 38041,1340",
		style=dashed];
	layer1_expert4_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="38330,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_15	[pos="e,38243,1337.7 37012,1414.9 37294,1410.3 37984,1393.9 38233,1340",
		style=dashed];
	layer1_moe_agg_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_MoE_Aggregate_GPU4
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 4",
		pos="36794,1179.5",
		shape=rectangle,
		width=2.8194];
	layer1_expert4_0 -> layer1_moe_agg_gpu4	[pos="e,36692,1182.3 35537,1259.3 35540,1258.4 35543,1257.7 35546,1257 35760,1206.8 36418,1188.1 36682,1182.5"];
	layer1_expert4_1 -> layer1_moe_agg_gpu4	[pos="e,36692,1183.6 35729,1259.3 35732,1258.5 35735,1257.7 35738,1257 35915,1214.6 36448,1192 36682,1184"];
	layer1_expert4_2 -> layer1_moe_agg_gpu4	[pos="e,36692,1185.5 35921,1259.4 35924,1258.5 35927,1257.7 35930,1257 36070,1222.3 36482,1196.8 36682,1186.1"];
	layer1_expert4_3 -> layer1_moe_agg_gpu4	[pos="e,36692,1183.1 36113,1259.6 36116,1258.6 36119,1257.8 36122,1257 36315,1206.5 36547,1189.3 36682,1183.5"];
	layer1_expert4_4 -> layer1_moe_agg_gpu4	[pos="e,36692,1189.5 36305,1259.7 36308,1258.8 36311,1257.8 36314,1257 36438,1221.7 36584,1201.3 36682,1190.6"];
	layer1_expert4_5 -> layer1_moe_agg_gpu4	[pos="e,36692,1203.8 36497,1260.1 36500,1259 36503,1258 36506,1257 36563,1237.4 36629,1219.7 36682,1206.3"];
	layer1_expert4_6 -> layer1_moe_agg_gpu4	[pos="e,36740,1213.7 36669,1256.9 36689,1244.6 36711,1231.1 36731,1219"];
	layer1_expert4_7 -> layer1_moe_agg_gpu4	[pos="e,36794,1213.7 36794,1256.9 36794,1246.2 36794,1234.6 36794,1223.8"];
	layer1_expert4_8 -> layer1_moe_agg_gpu4	[pos="e,36848,1213.7 36919,1256.9 36899,1244.6 36877,1231.1 36857,1219"];
	layer1_expert4_9 -> layer1_moe_agg_gpu4	[pos="e,36896,1203.8 37091,1260.1 37088,1259 37085,1258 37082,1257 37025,1237.4 36959,1219.7 36906,1206.3"];
	layer1_expert4_10 -> layer1_moe_agg_gpu4	[pos="e,36896,1189.5 37283,1259.7 37280,1258.8 37277,1257.8 37274,1257 37150,1221.7 37004,1201.3 36906,1190.6"];
	layer1_expert4_11 -> layer1_moe_agg_gpu4	[pos="e,36896,1183.1 37475,1259.6 37472,1258.6 37469,1257.8 37466,1257 37273,1206.5 37041,1189.3 36906,1183.5"];
	layer1_expert4_12 -> layer1_moe_agg_gpu4	[pos="e,36896,1185.5 37667,1259.4 37664,1258.5 37661,1257.7 37658,1257 37518,1222.3 37106,1196.8 36906,1186.1"];
	layer1_expert4_13 -> layer1_moe_agg_gpu4	[pos="e,36896,1183.6 37859,1259.3 37856,1258.5 37853,1257.7 37850,1257 37673,1214.6 37140,1192 36906,1184"];
	layer1_expert4_14 -> layer1_moe_agg_gpu4	[pos="e,36896,1182.3 38051,1259.3 38048,1258.4 38045,1257.7 38042,1257 37828,1206.8 37170,1188.1 36906,1182.5"];
	layer1_expert4_15 -> layer1_moe_agg_gpu4	[pos="e,36896,1181.4 38243,1259.2 38240,1258.4 38237,1257.7 38234,1257 37982,1199 37199,1184.8 36906,1181.5"];
	layer1_output_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU4
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 4",
		pos="35485,1068",
		shape=rectangle,
		width=3.3889];
	layer1_moe_agg_gpu4 -> layer1_output_gpu4	[pos="e,35607,1079.2 36692,1170 36458,1150.4 35879,1102 35618,1080.1"];
	layer1_output_gpu4 -> pipeline_stage0_1	[pos="e,35306,998.08 35399,1033.9 35374,1024.2 35345,1013.1 35315,1001.8"];
	layer1_qkv_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_QKV_Projection_GPU5
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 5",
		pos="39962,1744.5",
		shape=rectangle,
		width=2.9444];
	layer1_attn_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU5
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 5",
		pos="39962,1633",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu5 -> layer1_attn_gpu5	[pos="e,39962,1667 39962,1710.3 39962,1699.9 39962,1688.3 39962,1677.3"];
	layer1_attn_norm_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU5
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 5",
		pos="39962,1529",
		shape=rectangle,
		width=3.3889];
	layer1_attn_gpu5 -> layer1_attn_norm_gpu5	[pos="e,39962,1563.3 39962,1598.9 39962,1590.8 39962,1582 39962,1573.5"];
	layer1_gate_gpu5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU5
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 5",
		pos="39962,1417.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu5 -> layer1_gate_gpu5	[pos="e,39962,1459.3 39962,1494.8 39962,1486.8 39962,1478 39962,1469.3"];
	layer1_expert5_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="38522,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_0	[pos="e,38609,1337.7 39840,1414.9 39558,1410.3 38868,1393.9 38619,1340",
		style=dashed];
	layer1_expert5_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="38714,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_1	[pos="e,38801,1337.7 39840,1413.5 39589,1406.5 39021,1386.4 38811,1340",
		style=dashed];
	layer1_expert5_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="38906,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_2	[pos="e,38993,1337.7 39840,1411.6 39622,1402.2 39176,1378.9 39003,1340",
		style=dashed];
	layer1_expert5_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="39098,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_3	[pos="e,39185,1337.6 39840,1415.5 39689,1411.9 39425,1397.2 39195,1340.1",
		style=dashed];
	layer1_expert5_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="39290,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_4	[pos="e,39377,1337.4 39840,1409.8 39724,1401.2 39547,1382.5 39387,1340.1",
		style=dashed];
	layer1_expert5_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="39482,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_5	[pos="e,39569,1337.1 39840,1398.7 39766,1386.4 39671,1367.7 39579,1340.1",
		style=dashed];
	layer1_expert5_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="39674,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_6	[pos="e,39761,1336.3 39859,1376 39833,1365.5 39804,1354 39771,1340.3",
		style=dashed];
	layer1_expert5_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="39866,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_7	[pos="e,39899,1340 39929,1375.9 39921,1366.8 39913,1357.1 39906,1347.8",
		style=dashed];
	layer1_expert5_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="40058,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_8	[pos="e,40025,1340 39995,1375.9 40003,1366.8 40011,1357.1 40018,1347.8",
		style=dashed];
	layer1_expert5_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="40250,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_9	[pos="e,40163,1336.3 40065,1376 40091,1365.5 40120,1354 40153,1340.3",
		style=dashed];
	layer1_expert5_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="40442,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_10	[pos="e,40355,1337.1 40084,1398.7 40158,1386.4 40253,1367.7 40345,1340.1",
		style=dashed];
	layer1_expert5_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="40634,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_11	[pos="e,40547,1337.4 40084,1409.8 40200,1401.2 40377,1382.5 40537,1340.1",
		style=dashed];
	layer1_expert5_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="40826,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_12	[pos="e,40739,1337.6 40084,1415.5 40235,1411.9 40499,1397.2 40729,1340.1",
		style=dashed];
	layer1_expert5_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="41018,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_13	[pos="e,40931,1337.7 40084,1411.6 40302,1402.2 40748,1378.9 40921,1340",
		style=dashed];
	layer1_expert5_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="41210,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_14	[pos="e,41123,1337.7 40084,1413.5 40335,1406.5 40903,1386.4 41113,1340",
		style=dashed];
	layer1_expert5_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="41402,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_15	[pos="e,41315,1337.7 40084,1414.9 40366,1410.3 41056,1393.9 41305,1340",
		style=dashed];
	layer1_moe_agg_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_MoE_Aggregate_GPU5
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 5",
		pos="39866,1179.5",
		shape=rectangle,
		width=2.8194];
	layer1_expert5_0 -> layer1_moe_agg_gpu5	[pos="e,39764,1182.3 38609,1259.3 38612,1258.4 38615,1257.7 38618,1257 38832,1206.8 39490,1188.1 39754,1182.5"];
	layer1_expert5_1 -> layer1_moe_agg_gpu5	[pos="e,39764,1183.6 38801,1259.3 38804,1258.5 38807,1257.7 38810,1257 38987,1214.6 39520,1192 39754,1184"];
	layer1_expert5_2 -> layer1_moe_agg_gpu5	[pos="e,39764,1185.5 38993,1259.4 38996,1258.5 38999,1257.7 39002,1257 39142,1222.3 39554,1196.8 39754,1186.1"];
	layer1_expert5_3 -> layer1_moe_agg_gpu5	[pos="e,39764,1183.1 39185,1259.6 39188,1258.6 39191,1257.8 39194,1257 39387,1206.5 39619,1189.3 39754,1183.5"];
	layer1_expert5_4 -> layer1_moe_agg_gpu5	[pos="e,39764,1189.5 39377,1259.7 39380,1258.8 39383,1257.8 39386,1257 39510,1221.7 39656,1201.3 39754,1190.6"];
	layer1_expert5_5 -> layer1_moe_agg_gpu5	[pos="e,39764,1203.8 39569,1260.1 39572,1259 39575,1258 39578,1257 39635,1237.4 39701,1219.7 39754,1206.3"];
	layer1_expert5_6 -> layer1_moe_agg_gpu5	[pos="e,39812,1213.7 39741,1256.9 39761,1244.6 39783,1231.1 39803,1219"];
	layer1_expert5_7 -> layer1_moe_agg_gpu5	[pos="e,39866,1213.7 39866,1256.9 39866,1246.2 39866,1234.6 39866,1223.8"];
	layer1_expert5_8 -> layer1_moe_agg_gpu5	[pos="e,39920,1213.7 39991,1256.9 39971,1244.6 39949,1231.1 39929,1219"];
	layer1_expert5_9 -> layer1_moe_agg_gpu5	[pos="e,39968,1203.8 40163,1260.1 40160,1259 40157,1258 40154,1257 40097,1237.4 40031,1219.7 39978,1206.3"];
	layer1_expert5_10 -> layer1_moe_agg_gpu5	[pos="e,39968,1189.5 40355,1259.7 40352,1258.8 40349,1257.8 40346,1257 40222,1221.7 40076,1201.3 39978,1190.6"];
	layer1_expert5_11 -> layer1_moe_agg_gpu5	[pos="e,39968,1183.1 40547,1259.6 40544,1258.6 40541,1257.8 40538,1257 40345,1206.5 40113,1189.3 39978,1183.5"];
	layer1_expert5_12 -> layer1_moe_agg_gpu5	[pos="e,39968,1185.5 40739,1259.4 40736,1258.5 40733,1257.7 40730,1257 40590,1222.3 40178,1196.8 39978,1186.1"];
	layer1_expert5_13 -> layer1_moe_agg_gpu5	[pos="e,39968,1183.6 40931,1259.3 40928,1258.5 40925,1257.7 40922,1257 40745,1214.6 40212,1192 39978,1184"];
	layer1_expert5_14 -> layer1_moe_agg_gpu5	[pos="e,39968,1182.3 41123,1259.3 41120,1258.4 41117,1257.7 41114,1257 40900,1206.8 40242,1188.1 39978,1182.5"];
	layer1_expert5_15 -> layer1_moe_agg_gpu5	[pos="e,39968,1181.4 41315,1259.2 41312,1258.4 41309,1257.7 41306,1257 41054,1199 40271,1184.8 39978,1181.5"];
	layer1_output_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU5
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 5",
		pos="37807,1068",
		shape=rectangle,
		width=3.3889];
	layer1_moe_agg_gpu5 -> layer1_output_gpu5	[pos="e,37929,1075.5 39764,1173.1 39423,1155 38321,1096.4 37939,1076"];
	layer1_output_gpu5 -> pipeline_stage0_1	[pos="e,35275,926.16 37685,1060.2 37255,1036.3 35810,955.95 35285,926.74"];
	layer1_qkv_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_QKV_Projection_GPU6
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 6",
		pos="43034,1744.5",
		shape=rectangle,
		width=2.9444];
	layer1_attn_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU6
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 6",
		pos="43034,1633",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu6 -> layer1_attn_gpu6	[pos="e,43034,1667 43034,1710.3 43034,1699.9 43034,1688.3 43034,1677.3"];
	layer1_attn_norm_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU6
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 6",
		pos="43034,1529",
		shape=rectangle,
		width=3.3889];
	layer1_attn_gpu6 -> layer1_attn_norm_gpu6	[pos="e,43034,1563.3 43034,1598.9 43034,1590.8 43034,1582 43034,1573.5"];
	layer1_gate_gpu6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU6
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 6",
		pos="43034,1417.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu6 -> layer1_gate_gpu6	[pos="e,43034,1459.3 43034,1494.8 43034,1486.8 43034,1478 43034,1469.3"];
	layer1_expert6_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="41594,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_0	[pos="e,41681,1337.7 42912,1414.9 42630,1410.3 41940,1393.9 41691,1340",
		style=dashed];
	layer1_expert6_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="41786,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_1	[pos="e,41873,1337.7 42912,1413.5 42661,1406.5 42093,1386.4 41883,1340",
		style=dashed];
	layer1_expert6_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="41978,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_2	[pos="e,42065,1337.7 42912,1411.6 42694,1402.2 42248,1378.9 42075,1340",
		style=dashed];
	layer1_expert6_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="42170,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_3	[pos="e,42257,1337.6 42912,1415.5 42761,1411.9 42497,1397.2 42267,1340.1",
		style=dashed];
	layer1_expert6_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="42362,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_4	[pos="e,42449,1337.4 42912,1409.8 42796,1401.2 42619,1382.5 42459,1340.1",
		style=dashed];
	layer1_expert6_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="42554,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_5	[pos="e,42641,1337.1 42912,1398.7 42838,1386.4 42743,1367.7 42651,1340.1",
		style=dashed];
	layer1_expert6_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="42746,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_6	[pos="e,42833,1336.3 42931,1376 42905,1365.5 42876,1354 42843,1340.3",
		style=dashed];
	layer1_expert6_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="42938,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_7	[pos="e,42971,1340 43001,1375.9 42993,1366.8 42985,1357.1 42978,1347.8",
		style=dashed];
	layer1_expert6_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="43130,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_8	[pos="e,43097,1340 43067,1375.9 43075,1366.8 43083,1357.1 43090,1347.8",
		style=dashed];
	layer1_expert6_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="43322,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_9	[pos="e,43235,1336.3 43137,1376 43163,1365.5 43192,1354 43225,1340.3",
		style=dashed];
	layer1_expert6_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="43514,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_10	[pos="e,43427,1337.1 43156,1398.7 43230,1386.4 43325,1367.7 43417,1340.1",
		style=dashed];
	layer1_expert6_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="43706,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_11	[pos="e,43619,1337.4 43156,1409.8 43272,1401.2 43449,1382.5 43609,1340.1",
		style=dashed];
	layer1_expert6_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="43898,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_12	[pos="e,43811,1337.6 43156,1415.5 43307,1411.9 43571,1397.2 43801,1340.1",
		style=dashed];
	layer1_expert6_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="44090,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_13	[pos="e,44003,1337.7 43156,1411.6 43374,1402.2 43820,1378.9 43993,1340",
		style=dashed];
	layer1_expert6_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="44282,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_14	[pos="e,44195,1337.7 43156,1413.5 43407,1406.5 43975,1386.4 44185,1340",
		style=dashed];
	layer1_expert6_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="44474,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_15	[pos="e,44387,1337.7 43156,1414.9 43438,1410.3 44128,1393.9 44377,1340",
		style=dashed];
	layer1_moe_agg_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_MoE_Aggregate_GPU6
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 6",
		pos="42938,1179.5",
		shape=rectangle,
		width=2.8194];
	layer1_expert6_0 -> layer1_moe_agg_gpu6	[pos="e,42836,1182.3 41681,1259.3 41684,1258.4 41687,1257.7 41690,1257 41904,1206.8 42562,1188.1 42826,1182.5"];
	layer1_expert6_1 -> layer1_moe_agg_gpu6	[pos="e,42836,1183.6 41873,1259.3 41876,1258.5 41879,1257.7 41882,1257 42059,1214.6 42592,1192 42826,1184"];
	layer1_expert6_2 -> layer1_moe_agg_gpu6	[pos="e,42836,1185.5 42065,1259.4 42068,1258.5 42071,1257.7 42074,1257 42214,1222.3 42626,1196.8 42826,1186.1"];
	layer1_expert6_3 -> layer1_moe_agg_gpu6	[pos="e,42836,1183.1 42257,1259.6 42260,1258.6 42263,1257.8 42266,1257 42459,1206.5 42691,1189.3 42826,1183.5"];
	layer1_expert6_4 -> layer1_moe_agg_gpu6	[pos="e,42836,1189.5 42449,1259.7 42452,1258.8 42455,1257.8 42458,1257 42582,1221.7 42728,1201.3 42826,1190.6"];
	layer1_expert6_5 -> layer1_moe_agg_gpu6	[pos="e,42836,1203.8 42641,1260.1 42644,1259 42647,1258 42650,1257 42707,1237.4 42773,1219.7 42826,1206.3"];
	layer1_expert6_6 -> layer1_moe_agg_gpu6	[pos="e,42884,1213.7 42813,1256.9 42833,1244.6 42855,1231.1 42875,1219"];
	layer1_expert6_7 -> layer1_moe_agg_gpu6	[pos="e,42938,1213.7 42938,1256.9 42938,1246.2 42938,1234.6 42938,1223.8"];
	layer1_expert6_8 -> layer1_moe_agg_gpu6	[pos="e,42992,1213.7 43063,1256.9 43043,1244.6 43021,1231.1 43001,1219"];
	layer1_expert6_9 -> layer1_moe_agg_gpu6	[pos="e,43040,1203.8 43235,1260.1 43232,1259 43229,1258 43226,1257 43169,1237.4 43103,1219.7 43050,1206.3"];
	layer1_expert6_10 -> layer1_moe_agg_gpu6	[pos="e,43040,1189.5 43427,1259.7 43424,1258.8 43421,1257.8 43418,1257 43294,1221.7 43148,1201.3 43050,1190.6"];
	layer1_expert6_11 -> layer1_moe_agg_gpu6	[pos="e,43040,1183.1 43619,1259.6 43616,1258.6 43613,1257.8 43610,1257 43417,1206.5 43185,1189.3 43050,1183.5"];
	layer1_expert6_12 -> layer1_moe_agg_gpu6	[pos="e,43040,1185.5 43811,1259.4 43808,1258.5 43805,1257.7 43802,1257 43662,1222.3 43250,1196.8 43050,1186.1"];
	layer1_expert6_13 -> layer1_moe_agg_gpu6	[pos="e,43040,1183.6 44003,1259.3 44000,1258.5 43997,1257.7 43994,1257 43817,1214.6 43284,1192 43050,1184"];
	layer1_expert6_14 -> layer1_moe_agg_gpu6	[pos="e,43040,1182.3 44195,1259.3 44192,1258.4 44189,1257.7 44186,1257 43972,1206.8 43314,1188.1 43050,1182.5"];
	layer1_expert6_15 -> layer1_moe_agg_gpu6	[pos="e,43040,1181.4 44387,1259.2 44384,1258.4 44381,1257.7 44378,1257 44126,1199 43343,1184.8 43050,1181.5"];
	layer1_output_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU6
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 6",
		pos="40504,1068",
		shape=rectangle,
		width=3.3889];
	layer1_moe_agg_gpu6 -> layer1_output_gpu6	[pos="e,40626,1074.5 42836,1173.9 42449,1156.5 41071,1094.5 40636,1075"];
	layer1_output_gpu6 -> pipeline_stage0_1	[pos="e,35272,921.01 40382,1063.6 39678,1044 36144,945.34 35282,921.29"];
	layer1_qkv_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_QKV_Projection_GPU7
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 7",
		pos="46106,1744.5",
		shape=rectangle,
		width=2.9444];
	layer1_attn_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU7
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 7",
		pos="46106,1633",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu7 -> layer1_attn_gpu7	[pos="e,46106,1667 46106,1710.3 46106,1699.9 46106,1688.3 46106,1677.3"];
	layer1_attn_norm_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU7
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 7",
		pos="46106,1529",
		shape=rectangle,
		width=3.3889];
	layer1_attn_gpu7 -> layer1_attn_norm_gpu7	[pos="e,46106,1563.3 46106,1598.9 46106,1590.8 46106,1582 46106,1573.5"];
	layer1_gate_gpu7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU7
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 7",
		pos="46106,1417.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu7 -> layer1_gate_gpu7	[pos="e,46106,1459.3 46106,1494.8 46106,1486.8 46106,1478 46106,1469.3"];
	layer1_expert7_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="44666,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_0	[pos="e,44753,1337.7 45984,1414.9 45702,1410.3 45012,1393.9 44763,1340",
		style=dashed];
	layer1_expert7_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="44858,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_1	[pos="e,44945,1337.7 45984,1413.5 45733,1406.5 45165,1386.4 44955,1340",
		style=dashed];
	layer1_expert7_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="45050,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_2	[pos="e,45137,1337.7 45984,1411.6 45766,1402.2 45320,1378.9 45147,1340",
		style=dashed];
	layer1_expert7_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="45242,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_3	[pos="e,45329,1337.6 45984,1415.5 45833,1411.9 45569,1397.2 45339,1340.1",
		style=dashed];
	layer1_expert7_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="45434,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_4	[pos="e,45521,1337.4 45984,1409.8 45868,1401.2 45691,1382.5 45531,1340.1",
		style=dashed];
	layer1_expert7_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="45626,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_5	[pos="e,45713,1337.1 45984,1398.7 45910,1386.4 45815,1367.7 45723,1340.1",
		style=dashed];
	layer1_expert7_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="45818,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_6	[pos="e,45905,1336.3 46003,1376 45977,1365.5 45948,1354 45915,1340.3",
		style=dashed];
	layer1_expert7_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="46010,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_7	[pos="e,46043,1340 46073,1375.9 46065,1366.8 46057,1357.1 46050,1347.8",
		style=dashed];
	layer1_expert7_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="46202,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_8	[pos="e,46169,1340 46139,1375.9 46147,1366.8 46155,1357.1 46162,1347.8",
		style=dashed];
	layer1_expert7_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="46394,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_9	[pos="e,46307,1336.3 46209,1376 46235,1365.5 46264,1354 46297,1340.3",
		style=dashed];
	layer1_expert7_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="46586,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_10	[pos="e,46499,1337.1 46228,1398.7 46302,1386.4 46397,1367.7 46489,1340.1",
		style=dashed];
	layer1_expert7_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="46778,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_11	[pos="e,46691,1337.4 46228,1409.8 46344,1401.2 46521,1382.5 46681,1340.1",
		style=dashed];
	layer1_expert7_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="46970,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_12	[pos="e,46883,1337.6 46228,1415.5 46379,1411.9 46643,1397.2 46873,1340.1",
		style=dashed];
	layer1_expert7_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="47162,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_13	[pos="e,47075,1337.7 46228,1411.6 46446,1402.2 46892,1378.9 47065,1340",
		style=dashed];
	layer1_expert7_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="47354,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_14	[pos="e,47267,1337.7 46228,1413.5 46479,1406.5 47047,1386.4 47257,1340",
		style=dashed];
	layer1_expert7_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="47546,1298.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_15	[pos="e,47459,1337.7 46228,1414.9 46510,1410.3 47200,1393.9 47449,1340",
		style=dashed];
	layer1_moe_agg_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_MoE_Aggregate_GPU7
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 7",
		pos="46010,1179.5",
		shape=rectangle,
		width=2.8194];
	layer1_expert7_0 -> layer1_moe_agg_gpu7	[pos="e,45908,1182.3 44753,1259.3 44756,1258.4 44759,1257.7 44762,1257 44976,1206.8 45634,1188.1 45898,1182.5"];
	layer1_expert7_1 -> layer1_moe_agg_gpu7	[pos="e,45908,1183.6 44945,1259.3 44948,1258.5 44951,1257.7 44954,1257 45131,1214.6 45664,1192 45898,1184"];
	layer1_expert7_2 -> layer1_moe_agg_gpu7	[pos="e,45908,1185.5 45137,1259.4 45140,1258.5 45143,1257.7 45146,1257 45286,1222.3 45698,1196.8 45898,1186.1"];
	layer1_expert7_3 -> layer1_moe_agg_gpu7	[pos="e,45908,1183.1 45329,1259.6 45332,1258.6 45335,1257.8 45338,1257 45531,1206.5 45763,1189.3 45898,1183.5"];
	layer1_expert7_4 -> layer1_moe_agg_gpu7	[pos="e,45908,1189.5 45521,1259.7 45524,1258.8 45527,1257.8 45530,1257 45654,1221.7 45800,1201.3 45898,1190.6"];
	layer1_expert7_5 -> layer1_moe_agg_gpu7	[pos="e,45908,1203.8 45713,1260.1 45716,1259 45719,1258 45722,1257 45779,1237.4 45845,1219.7 45898,1206.3"];
	layer1_expert7_6 -> layer1_moe_agg_gpu7	[pos="e,45956,1213.7 45885,1256.9 45905,1244.6 45927,1231.1 45947,1219"];
	layer1_expert7_7 -> layer1_moe_agg_gpu7	[pos="e,46010,1213.7 46010,1256.9 46010,1246.2 46010,1234.6 46010,1223.8"];
	layer1_expert7_8 -> layer1_moe_agg_gpu7	[pos="e,46064,1213.7 46135,1256.9 46115,1244.6 46093,1231.1 46073,1219"];
	layer1_expert7_9 -> layer1_moe_agg_gpu7	[pos="e,46112,1203.8 46307,1260.1 46304,1259 46301,1258 46298,1257 46241,1237.4 46175,1219.7 46122,1206.3"];
	layer1_expert7_10 -> layer1_moe_agg_gpu7	[pos="e,46112,1189.5 46499,1259.7 46496,1258.8 46493,1257.8 46490,1257 46366,1221.7 46220,1201.3 46122,1190.6"];
	layer1_expert7_11 -> layer1_moe_agg_gpu7	[pos="e,46112,1183.1 46691,1259.6 46688,1258.6 46685,1257.8 46682,1257 46489,1206.5 46257,1189.3 46122,1183.5"];
	layer1_expert7_12 -> layer1_moe_agg_gpu7	[pos="e,46112,1185.5 46883,1259.4 46880,1258.5 46877,1257.7 46874,1257 46734,1222.3 46322,1196.8 46122,1186.1"];
	layer1_expert7_13 -> layer1_moe_agg_gpu7	[pos="e,46112,1183.6 47075,1259.3 47072,1258.5 47069,1257.7 47066,1257 46889,1214.6 46356,1192 46122,1184"];
	layer1_expert7_14 -> layer1_moe_agg_gpu7	[pos="e,46112,1182.3 47267,1259.3 47264,1258.4 47261,1257.7 47258,1257 47044,1206.8 46386,1188.1 46122,1182.5"];
	layer1_expert7_15 -> layer1_moe_agg_gpu7	[pos="e,46112,1181.4 47459,1259.2 47456,1258.4 47453,1257.7 47450,1257 47198,1199 46415,1184.8 46122,1181.5"];
	layer1_output_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU7
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 7",
		pos="43388,1068",
		shape=rectangle,
		width=3.3889];
	layer1_moe_agg_gpu7 -> layer1_output_gpu7	[pos="e,43510,1074.1 45908,1174.3 45500,1157.2 43979,1093.7 43520,1074.5"];
	layer1_output_gpu7 -> pipeline_stage0_1	[pos="e,35271,919.26 43266,1064.8 42339,1047.9 36420,940.16 35281,919.44"];
	stage1_boundary	[fillcolor=lightblue,
		height=1.1521,
		label="Stage 1 Boundary
GPUs 8-15
Layers 2-3",
		peripheries=2,
		pos="47642,1744.5",
		shape=ellipse,
		width=2.9592];
	layer2_qkv_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_QKV_Projection_GPU8
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 8",
		pos="31221,762",
		shape=rectangle,
		width=2.9444];
	layer2_attn_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU8
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 8",
		pos="28758,658",
		shape=rectangle,
		width=3.375];
	layer2_qkv_gpu8 -> layer2_attn_gpu8	[pos="e,28880,690.73 31115,760.94 30721,760.26 29347,753.52 28890,692.1"];
	layer2_attn_norm_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU8
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 8",
		pos="26128,554",
		shape=rectangle,
		width=3.3889];
	layer2_attn_gpu8 -> layer2_attn_norm_gpu8	[pos="e,26250,559.74 28636,652.28 28200,635.36 26714,577.72 26260,560.13"];
	layer2_gate_gpu8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU8
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 8",
		pos="24111,442.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu8 -> layer2_gate_gpu8	[pos="e,24233,450.13 26006,546.38 25650,527.03 24612,470.71 24243,450.68"];
	layer2_expert8_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="22575,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu8 -> layer2_expert8_0	[pos="e,22662,362.76 23989,440.41 23692,436.92 22940,422.7 22672,365.01",
		style=dashed];
	layer2_expert8_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="22767,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu8 -> layer2_expert8_1	[pos="e,22854,362.73 23989,439.24 23722,433.47 23093,415.11 22864,364.99",
		style=dashed];
	layer2_expert8_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="22959,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu8 -> layer2_expert8_2	[pos="e,23046,362.69 23989,437.65 23754,429.46 23247,407.62 23056,364.99",
		style=dashed];
	layer2_expert8_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="23151,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu8 -> layer2_expert8_3	[pos="e,23238,362.63 23989,435.36 23789,424.58 23401,400.2 23248,364.96",
		style=dashed];
	layer2_expert8_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="23343,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu8 -> layer2_expert8_4	[pos="e,23430,362.45 23989,438.05 23855,431.91 23634,414.84 23440,365",
		style=dashed];
	layer2_expert8_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="23535,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu8 -> layer2_expert8_5	[pos="e,23622,362.28 23989,430.26 23893,419.56 23757,400.14 23632,365.05",
		style=dashed];
	layer2_expert8_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="23727,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu8 -> layer2_expert8_6	[pos="e,23814,361.89 23989,413.02 23940,400.63 23883,385.01 23824,365.12",
		style=dashed];
	layer2_expert8_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="23919,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu8 -> layer2_expert8_7	[pos="e,23985,365.02 24044,400.91 24028,391.02 24011,380.37 23994,370.25",
		style=dashed];
	layer2_expert8_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="24111,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu8 -> layer2_expert8_8	[pos="e,24111,365.02 24111,400.91 24111,392.65 24111,383.86 24111,375.3",
		style=dashed];
	layer2_expert8_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="24303,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu8 -> layer2_expert8_9	[pos="e,24237,365.02 24178,400.91 24194,391.02 24211,380.37 24228,370.25",
		style=dashed];
	layer2_expert8_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="24495,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu8 -> layer2_expert8_10	[pos="e,24408,361.89 24233,413.02 24282,400.63 24339,385.01 24398,365.12",
		style=dashed];
	layer2_expert8_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="24687,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu8 -> layer2_expert8_11	[pos="e,24600,362.28 24233,430.26 24329,419.56 24465,400.14 24590,365.05",
		style=dashed];
	layer2_expert8_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="24879,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu8 -> layer2_expert8_12	[pos="e,24792,362.45 24233,438.05 24367,431.91 24588,414.84 24782,365",
		style=dashed];
	layer2_expert8_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="25071,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu8 -> layer2_expert8_13	[pos="e,24984,362.63 24233,435.36 24433,424.58 24821,400.2 24974,364.96",
		style=dashed];
	layer2_expert8_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="25263,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu8 -> layer2_expert8_14	[pos="e,25176,362.69 24233,437.65 24468,429.46 24975,407.62 25166,364.99",
		style=dashed];
	layer2_expert8_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="25455,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu8 -> layer2_expert8_15	[pos="e,25368,362.73 24233,439.24 24500,433.47 25129,415.11 25358,364.99",
		style=dashed];
	layer2_moe_agg_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_MoE_Aggregate_GPU8
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 8",
		pos="24015,212",
		shape=rectangle,
		width=2.8194];
	layer2_expert8_0 -> layer2_moe_agg_gpu8	[pos="e,23913,213.67 22662,284.23 22665,283.42 22668,282.67 22671,282 22904,228.58 23624,216.47 23903,213.77"];
	layer2_expert8_1 -> layer2_moe_agg_gpu8	[pos="e,23913,214.69 22854,284.27 22857,283.44 22860,282.68 22863,282 23058,236.34 23654,219.89 23903,214.89"];
	layer2_expert8_2 -> layer2_moe_agg_gpu8	[pos="e,23913,216.1 23046,284.31 23049,283.47 23052,282.7 23055,282 23213,244.05 23686,223.92 23903,216.45"];
	layer2_expert8_3 -> layer2_moe_agg_gpu8	[pos="e,23913,212.22 23238,284.38 23241,283.52 23244,282.72 23247,282 23475,225.08 23752,213.79 23903,212.31"];
	layer2_expert8_4 -> layer2_moe_agg_gpu8	[pos="e,23913,216.6 23430,284.57 23433,283.65 23436,282.79 23439,282 23597,240.14 23786,223.63 23903,217.14"];
	layer2_expert8_5 -> layer2_moe_agg_gpu8	[pos="e,23913,225.02 23622,284.8 23625,283.81 23628,282.87 23631,282 23721,255.35 23826,237.36 23903,226.44"];
	layer2_expert8_6 -> layer2_moe_agg_gpu8	[pos="e,23920,246.03 23814,285.54 23817,284.33 23820,283.15 23823,282 23851,271.01 23882,259.68 23910,249.45"];
	layer2_expert8_7 -> layer2_moe_agg_gpu8	[pos="e,23986,246.3 23955,281.73 23963,272.7 23971,263.12 23979,254.08"];
	layer2_expert8_8 -> layer2_moe_agg_gpu8	[pos="e,24044,246.3 24075,281.73 24067,272.7 24059,263.12 24051,254.08"];
	layer2_expert8_9 -> layer2_moe_agg_gpu8	[pos="e,24110,246.03 24216,285.54 24213,284.33 24210,283.15 24207,282 24179,271.01 24148,259.68 24120,249.45"];
	layer2_expert8_10 -> layer2_moe_agg_gpu8	[pos="e,24117,225.02 24408,284.8 24405,283.81 24402,282.87 24399,282 24309,255.35 24204,237.36 24127,226.44"];
	layer2_expert8_11 -> layer2_moe_agg_gpu8	[pos="e,24117,216.6 24600,284.57 24597,283.65 24594,282.79 24591,282 24433,240.14 24244,223.63 24127,217.14"];
	layer2_expert8_12 -> layer2_moe_agg_gpu8	[pos="e,24117,212.22 24792,284.38 24789,283.52 24786,282.72 24783,282 24555,225.08 24278,213.79 24127,212.31"];
	layer2_expert8_13 -> layer2_moe_agg_gpu8	[pos="e,24117,216.1 24984,284.31 24981,283.47 24978,282.7 24975,282 24817,244.05 24344,223.92 24127,216.45"];
	layer2_expert8_14 -> layer2_moe_agg_gpu8	[pos="e,24117,214.69 25176,284.27 25173,283.44 25170,282.68 25167,282 24972,236.34 24376,219.89 24127,214.89"];
	layer2_expert8_15 -> layer2_moe_agg_gpu8	[pos="e,24117,213.67 25368,284.23 25365,283.42 25362,282.67 25359,282 25126,228.58 24406,216.47 24127,213.77"];
	layer2_output_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU8
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 8",
		pos="24015,108",
		shape=rectangle,
		width=3.3889];
	layer2_moe_agg_gpu8 -> layer2_output_gpu8	[pos="e,24015,142.3 24015,177.88 24015,169.78 24015,160.98 24015,152.47"];
	layer2_qkv_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_QKV_Projection_GPU9
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 9",
		pos="31466,762",
		shape=rectangle,
		width=2.9444];
	layer2_attn_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU9
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 9",
		pos="29019,658",
		shape=rectangle,
		width=3.375];
	layer2_qkv_gpu9 -> layer2_attn_gpu9	[pos="e,29141,659.11 31360,732.07 31352,730.49 31344,729.1 31336,728 30909,668.24 29576,660.18 29151,659.14"];
	layer2_attn_norm_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU9
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 9",
		pos="27795,554",
		shape=rectangle,
		width=3.3889];
	layer2_attn_gpu9 -> layer2_attn_norm_gpu9	[pos="e,27917,555.42 28897,625.58 28894,625.02 28891,624.49 28888,624 28544,570.34 28134,558.14 27927,555.54"];
	layer2_gate_gpu9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU9
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 9",
		pos="27183,442.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu9 -> layer2_gate_gpu9	[pos="e,27305,465.34 27673,531.17 27570,512.66 27421,486.16 27315,467.15"];
	layer2_expert9_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="25647,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu9 -> layer2_expert9_0	[pos="e,25734,362.76 27061,440.41 26764,436.92 26012,422.7 25744,365.01",
		style=dashed];
	layer2_expert9_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="25839,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu9 -> layer2_expert9_1	[pos="e,25926,362.73 27061,439.24 26794,433.47 26165,415.11 25936,364.99",
		style=dashed];
	layer2_expert9_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="26031,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu9 -> layer2_expert9_2	[pos="e,26118,362.69 27061,437.65 26826,429.46 26319,407.62 26128,364.99",
		style=dashed];
	layer2_expert9_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="26223,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu9 -> layer2_expert9_3	[pos="e,26310,362.63 27061,435.36 26861,424.58 26473,400.2 26320,364.96",
		style=dashed];
	layer2_expert9_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="26415,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu9 -> layer2_expert9_4	[pos="e,26502,362.45 27061,438.05 26927,431.91 26706,414.84 26512,365",
		style=dashed];
	layer2_expert9_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="26607,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu9 -> layer2_expert9_5	[pos="e,26694,362.28 27061,430.26 26965,419.56 26829,400.14 26704,365.05",
		style=dashed];
	layer2_expert9_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="26799,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu9 -> layer2_expert9_6	[pos="e,26886,361.89 27061,413.02 27012,400.63 26955,385.01 26896,365.12",
		style=dashed];
	layer2_expert9_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="26991,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu9 -> layer2_expert9_7	[pos="e,27057,365.02 27116,400.91 27100,391.02 27083,380.37 27066,370.25",
		style=dashed];
	layer2_expert9_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="27183,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu9 -> layer2_expert9_8	[pos="e,27183,365.02 27183,400.91 27183,392.65 27183,383.86 27183,375.3",
		style=dashed];
	layer2_expert9_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="27375,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu9 -> layer2_expert9_9	[pos="e,27309,365.02 27250,400.91 27266,391.02 27283,380.37 27300,370.25",
		style=dashed];
	layer2_expert9_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="27567,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu9 -> layer2_expert9_10	[pos="e,27480,361.89 27305,413.02 27354,400.63 27411,385.01 27470,365.12",
		style=dashed];
	layer2_expert9_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="27759,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu9 -> layer2_expert9_11	[pos="e,27672,362.28 27305,430.26 27401,419.56 27537,400.14 27662,365.05",
		style=dashed];
	layer2_expert9_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="27951,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu9 -> layer2_expert9_12	[pos="e,27864,362.45 27305,438.05 27439,431.91 27660,414.84 27854,365",
		style=dashed];
	layer2_expert9_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="28143,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu9 -> layer2_expert9_13	[pos="e,28056,362.63 27305,435.36 27505,424.58 27893,400.2 28046,364.96",
		style=dashed];
	layer2_expert9_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="28335,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu9 -> layer2_expert9_14	[pos="e,28248,362.69 27305,437.65 27540,429.46 28047,407.62 28238,364.99",
		style=dashed];
	layer2_expert9_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="28527,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu9 -> layer2_expert9_15	[pos="e,28440,362.73 27305,439.24 27572,433.47 28201,415.11 28430,364.99",
		style=dashed];
	layer2_moe_agg_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_MoE_Aggregate_GPU9
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 9",
		pos="27087,212",
		shape=rectangle,
		width=2.8194];
	layer2_expert9_0 -> layer2_moe_agg_gpu9	[pos="e,26985,213.67 25734,284.23 25737,283.42 25740,282.67 25743,282 25976,228.58 26696,216.47 26975,213.77"];
	layer2_expert9_1 -> layer2_moe_agg_gpu9	[pos="e,26985,214.69 25926,284.27 25929,283.44 25932,282.68 25935,282 26130,236.34 26726,219.89 26975,214.89"];
	layer2_expert9_2 -> layer2_moe_agg_gpu9	[pos="e,26985,216.1 26118,284.31 26121,283.47 26124,282.7 26127,282 26285,244.05 26758,223.92 26975,216.45"];
	layer2_expert9_3 -> layer2_moe_agg_gpu9	[pos="e,26985,212.22 26310,284.38 26313,283.52 26316,282.72 26319,282 26547,225.08 26824,213.79 26975,212.31"];
	layer2_expert9_4 -> layer2_moe_agg_gpu9	[pos="e,26985,216.6 26502,284.57 26505,283.65 26508,282.79 26511,282 26669,240.14 26858,223.63 26975,217.14"];
	layer2_expert9_5 -> layer2_moe_agg_gpu9	[pos="e,26985,225.02 26694,284.8 26697,283.81 26700,282.87 26703,282 26793,255.35 26898,237.36 26975,226.44"];
	layer2_expert9_6 -> layer2_moe_agg_gpu9	[pos="e,26992,246.03 26886,285.54 26889,284.33 26892,283.15 26895,282 26923,271.01 26954,259.68 26982,249.45"];
	layer2_expert9_7 -> layer2_moe_agg_gpu9	[pos="e,27058,246.3 27027,281.73 27035,272.7 27043,263.12 27051,254.08"];
	layer2_expert9_8 -> layer2_moe_agg_gpu9	[pos="e,27116,246.3 27147,281.73 27139,272.7 27131,263.12 27123,254.08"];
	layer2_expert9_9 -> layer2_moe_agg_gpu9	[pos="e,27182,246.03 27288,285.54 27285,284.33 27282,283.15 27279,282 27251,271.01 27220,259.68 27192,249.45"];
	layer2_expert9_10 -> layer2_moe_agg_gpu9	[pos="e,27189,225.02 27480,284.8 27477,283.81 27474,282.87 27471,282 27381,255.35 27276,237.36 27199,226.44"];
	layer2_expert9_11 -> layer2_moe_agg_gpu9	[pos="e,27189,216.6 27672,284.57 27669,283.65 27666,282.79 27663,282 27505,240.14 27316,223.63 27199,217.14"];
	layer2_expert9_12 -> layer2_moe_agg_gpu9	[pos="e,27189,212.22 27864,284.38 27861,283.52 27858,282.72 27855,282 27627,225.08 27350,213.79 27199,212.31"];
	layer2_expert9_13 -> layer2_moe_agg_gpu9	[pos="e,27189,216.1 28056,284.31 28053,283.47 28050,282.7 28047,282 27889,244.05 27416,223.92 27199,216.45"];
	layer2_expert9_14 -> layer2_moe_agg_gpu9	[pos="e,27189,214.69 28248,284.27 28245,283.44 28242,282.68 28239,282 28044,236.34 27448,219.89 27199,214.89"];
	layer2_expert9_15 -> layer2_moe_agg_gpu9	[pos="e,27189,213.67 28440,284.23 28437,283.42 28434,282.67 28431,282 28198,228.58 27478,216.47 27199,213.77"];
	layer2_output_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU9
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 9",
		pos="27087,108",
		shape=rectangle,
		width=3.3889];
	layer2_moe_agg_gpu9 -> layer2_output_gpu9	[pos="e,27087,142.3 27087,177.88 27087,169.78 27087,160.98 27087,152.47"];
	layer2_qkv_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_QKV_Projection_GPU10
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 10",
		pos="33388,762",
		shape=rectangle,
		width=2.9444];
	layer2_attn_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU10
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 10",
		pos="32668,658",
		shape=rectangle,
		width=3.5];
	layer2_qkv_gpu10 -> layer2_attn_gpu10	[pos="e,32794,676.86 33282,745.95 33155,728 32943,697.96 32804,678.32"];
	layer2_attn_norm_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU10
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 10",
		pos="32308,554",
		shape=rectangle,
		width=3.5139];
	layer2_attn_gpu10 -> layer2_attn_norm_gpu10	[pos="e,32425,588.04 32551,623.88 32514,613.34 32473,601.62 32435,590.89"];
	layer2_gate_gpu10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU10
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 10",
		pos="30255,442.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu10 -> layer2_gate_gpu10	[pos="e,30377,450.01 32181,546.23 31815,526.71 30760,470.42 30387,450.55"];
	layer2_expert10_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="28719,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu10 -> layer2_expert10_0	[pos="e,28806,362.76 30133,440.41 29836,436.92 29084,422.7 28816,365.01",
		style=dashed];
	layer2_expert10_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="28911,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu10 -> layer2_expert10_1	[pos="e,28998,362.73 30133,439.24 29866,433.47 29237,415.11 29008,364.99",
		style=dashed];
	layer2_expert10_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="29103,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu10 -> layer2_expert10_2	[pos="e,29190,362.69 30133,437.65 29898,429.46 29391,407.62 29200,364.99",
		style=dashed];
	layer2_expert10_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="29295,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu10 -> layer2_expert10_3	[pos="e,29382,362.63 30133,435.36 29933,424.58 29545,400.2 29392,364.96",
		style=dashed];
	layer2_expert10_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="29487,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu10 -> layer2_expert10_4	[pos="e,29574,362.45 30133,438.05 29999,431.91 29778,414.84 29584,365",
		style=dashed];
	layer2_expert10_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="29679,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu10 -> layer2_expert10_5	[pos="e,29766,362.28 30133,430.26 30037,419.56 29901,400.14 29776,365.05",
		style=dashed];
	layer2_expert10_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="29871,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu10 -> layer2_expert10_6	[pos="e,29958,361.89 30133,413.02 30084,400.63 30027,385.01 29968,365.12",
		style=dashed];
	layer2_expert10_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="30063,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu10 -> layer2_expert10_7	[pos="e,30129,365.02 30188,400.91 30172,391.02 30155,380.37 30138,370.25",
		style=dashed];
	layer2_expert10_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="30255,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu10 -> layer2_expert10_8	[pos="e,30255,365.02 30255,400.91 30255,392.65 30255,383.86 30255,375.3",
		style=dashed];
	layer2_expert10_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="30447,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu10 -> layer2_expert10_9	[pos="e,30381,365.02 30322,400.91 30338,391.02 30355,380.37 30372,370.25",
		style=dashed];
	layer2_expert10_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="30639,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu10 -> layer2_expert10_10	[pos="e,30552,361.89 30377,413.02 30426,400.63 30483,385.01 30542,365.12",
		style=dashed];
	layer2_expert10_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="30831,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu10 -> layer2_expert10_11	[pos="e,30744,362.28 30377,430.26 30473,419.56 30609,400.14 30734,365.05",
		style=dashed];
	layer2_expert10_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="31023,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu10 -> layer2_expert10_12	[pos="e,30936,362.45 30377,438.05 30511,431.91 30732,414.84 30926,365",
		style=dashed];
	layer2_expert10_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="31215,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu10 -> layer2_expert10_13	[pos="e,31128,362.63 30377,435.36 30577,424.58 30965,400.2 31118,364.96",
		style=dashed];
	layer2_expert10_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="31407,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu10 -> layer2_expert10_14	[pos="e,31320,362.69 30377,437.65 30612,429.46 31119,407.62 31310,364.99",
		style=dashed];
	layer2_expert10_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="31599,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu10 -> layer2_expert10_15	[pos="e,31512,362.73 30377,439.24 30644,433.47 31273,415.11 31502,364.99",
		style=dashed];
	layer2_moe_agg_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_MoE_Aggregate_GPU10
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 10",
		pos="30159,212",
		shape=rectangle,
		width=2.9444];
	layer2_expert10_0 -> layer2_moe_agg_gpu10	[pos="e,30053,213.71 28806,284.23 28809,283.42 28812,282.67 28815,282 29047,228.87 29760,216.61 30042,213.81"];
	layer2_expert10_1 -> layer2_moe_agg_gpu10	[pos="e,30053,214.78 28998,284.27 29001,283.44 29004,282.68 29007,282 29201,236.62 29790,220.09 30042,214.98"];
	layer2_expert10_2 -> layer2_moe_agg_gpu10	[pos="e,30053,216.26 29190,284.31 29193,283.47 29196,282.7 29199,282 29356,244.32 29823,224.2 30043,216.61"];
	layer2_expert10_3 -> layer2_moe_agg_gpu10	[pos="e,30053,212.25 29382,284.38 29385,283.52 29388,282.72 29391,282 29617,225.63 29891,214.01 30043,212.35"];
	layer2_expert10_4 -> layer2_moe_agg_gpu10	[pos="e,30053,216.84 29574,284.57 29577,283.65 29580,282.79 29583,282 29739,240.67 29925,224.05 30043,217.4"];
	layer2_expert10_5 -> layer2_moe_agg_gpu10	[pos="e,30053,225.64 29766,284.8 29769,283.81 29772,282.87 29775,282 29863,255.86 29966,238.04 30043,227.08"];
	layer2_expert10_6 -> layer2_moe_agg_gpu10	[pos="e,30064,246.03 29958,285.54 29961,284.33 29964,283.15 29967,282 29995,271.01 30026,259.68 30054,249.45"];
	layer2_expert10_7 -> layer2_moe_agg_gpu10	[pos="e,30130,246.3 30099,281.73 30107,272.7 30115,263.12 30123,254.08"];
	layer2_expert10_8 -> layer2_moe_agg_gpu10	[pos="e,30188,246.3 30219,281.73 30211,272.7 30203,263.12 30195,254.08"];
	layer2_expert10_9 -> layer2_moe_agg_gpu10	[pos="e,30254,246.03 30360,285.54 30357,284.33 30354,283.15 30351,282 30323,271.01 30292,259.68 30264,249.45"];
	layer2_expert10_10 -> layer2_moe_agg_gpu10	[pos="e,30265,225.64 30552,284.8 30549,283.81 30546,282.87 30543,282 30455,255.86 30352,238.04 30275,227.08"];
	layer2_expert10_11 -> layer2_moe_agg_gpu10	[pos="e,30265,216.84 30744,284.57 30741,283.65 30738,282.79 30735,282 30579,240.67 30393,224.05 30275,217.4"];
	layer2_expert10_12 -> layer2_moe_agg_gpu10	[pos="e,30265,212.25 30936,284.38 30933,283.52 30930,282.72 30927,282 30701,225.63 30427,214.01 30275,212.35"];
	layer2_expert10_13 -> layer2_moe_agg_gpu10	[pos="e,30265,216.26 31128,284.31 31125,283.47 31122,282.7 31119,282 30962,244.32 30495,224.2 30275,216.61"];
	layer2_expert10_14 -> layer2_moe_agg_gpu10	[pos="e,30265,214.78 31320,284.27 31317,283.44 31314,282.68 31311,282 31117,236.62 30528,220.09 30276,214.98"];
	layer2_expert10_15 -> layer2_moe_agg_gpu10	[pos="e,30265,213.71 31512,284.23 31509,283.42 31506,282.67 31503,282 31271,228.87 30558,216.61 30276,213.81"];
	layer2_output_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU10
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 10",
		pos="30159,108",
		shape=rectangle,
		width=3.5139];
	layer2_moe_agg_gpu10 -> layer2_output_gpu10	[pos="e,30159,142.3 30159,177.88 30159,169.78 30159,160.98 30159,152.47"];
	layer2_qkv_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_QKV_Projection_GPU11
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 11",
		pos="34967,762",
		shape=rectangle,
		width=2.9444];
	layer2_attn_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU11
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 11",
		pos="34305,658",
		shape=rectangle,
		width=3.5];
	layer2_qkv_gpu11 -> layer2_attn_gpu11	[pos="e,34431,678.44 34861,744.61 34747,727.05 34565,699.13 34441,679.98"];
	layer2_attn_norm_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU11
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 11",
		pos="33979,554",
		shape=rectangle,
		width=3.5139];
	layer2_attn_gpu11 -> layer2_attn_norm_gpu11	[pos="e,34085,588.04 34199,623.88 34166,613.38 34128,601.72 34094,591.03"];
	layer2_gate_gpu11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU11
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 11",
		pos="33327,442.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu11 -> layer2_gate_gpu11	[pos="e,33449,464.01 33852,531.69 33739,512.68 33574,484.94 33459,465.67"];
	layer2_expert11_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="31791,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu11 -> layer2_expert11_0	[pos="e,31878,362.76 33205,440.41 32908,436.92 32156,422.7 31888,365.01",
		style=dashed];
	layer2_expert11_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="31983,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu11 -> layer2_expert11_1	[pos="e,32070,362.73 33205,439.24 32938,433.47 32309,415.11 32080,364.99",
		style=dashed];
	layer2_expert11_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="32175,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu11 -> layer2_expert11_2	[pos="e,32262,362.69 33205,437.65 32970,429.46 32463,407.62 32272,364.99",
		style=dashed];
	layer2_expert11_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="32367,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu11 -> layer2_expert11_3	[pos="e,32454,362.63 33205,435.36 33005,424.58 32617,400.2 32464,364.96",
		style=dashed];
	layer2_expert11_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="32559,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu11 -> layer2_expert11_4	[pos="e,32646,362.45 33205,438.05 33071,431.91 32850,414.84 32656,365",
		style=dashed];
	layer2_expert11_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="32751,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu11 -> layer2_expert11_5	[pos="e,32838,362.28 33205,430.26 33109,419.56 32973,400.14 32848,365.05",
		style=dashed];
	layer2_expert11_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="32943,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu11 -> layer2_expert11_6	[pos="e,33030,361.89 33205,413.02 33156,400.63 33099,385.01 33040,365.12",
		style=dashed];
	layer2_expert11_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="33135,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu11 -> layer2_expert11_7	[pos="e,33201,365.02 33260,400.91 33244,391.02 33227,380.37 33210,370.25",
		style=dashed];
	layer2_expert11_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="33327,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu11 -> layer2_expert11_8	[pos="e,33327,365.02 33327,400.91 33327,392.65 33327,383.86 33327,375.3",
		style=dashed];
	layer2_expert11_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="33519,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu11 -> layer2_expert11_9	[pos="e,33453,365.02 33394,400.91 33410,391.02 33427,380.37 33444,370.25",
		style=dashed];
	layer2_expert11_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="33711,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu11 -> layer2_expert11_10	[pos="e,33624,361.89 33449,413.02 33498,400.63 33555,385.01 33614,365.12",
		style=dashed];
	layer2_expert11_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="33903,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu11 -> layer2_expert11_11	[pos="e,33816,362.28 33449,430.26 33545,419.56 33681,400.14 33806,365.05",
		style=dashed];
	layer2_expert11_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="34095,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu11 -> layer2_expert11_12	[pos="e,34008,362.45 33449,438.05 33583,431.91 33804,414.84 33998,365",
		style=dashed];
	layer2_expert11_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="34287,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu11 -> layer2_expert11_13	[pos="e,34200,362.63 33449,435.36 33649,424.58 34037,400.2 34190,364.96",
		style=dashed];
	layer2_expert11_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="34479,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu11 -> layer2_expert11_14	[pos="e,34392,362.69 33449,437.65 33684,429.46 34191,407.62 34382,364.99",
		style=dashed];
	layer2_expert11_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="34671,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu11 -> layer2_expert11_15	[pos="e,34584,362.73 33449,439.24 33716,433.47 34345,415.11 34574,364.99",
		style=dashed];
	layer2_moe_agg_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_MoE_Aggregate_GPU11
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 11",
		pos="33231,212",
		shape=rectangle,
		width=2.9444];
	layer2_expert11_0 -> layer2_moe_agg_gpu11	[pos="e,33125,213.71 31878,284.23 31881,283.42 31884,282.67 31887,282 32119,228.87 32832,216.61 33114,213.81"];
	layer2_expert11_1 -> layer2_moe_agg_gpu11	[pos="e,33125,214.78 32070,284.27 32073,283.44 32076,282.68 32079,282 32273,236.62 32862,220.09 33114,214.98"];
	layer2_expert11_2 -> layer2_moe_agg_gpu11	[pos="e,33125,216.26 32262,284.31 32265,283.47 32268,282.7 32271,282 32428,244.32 32895,224.2 33115,216.61"];
	layer2_expert11_3 -> layer2_moe_agg_gpu11	[pos="e,33125,212.25 32454,284.38 32457,283.52 32460,282.72 32463,282 32689,225.63 32963,214.01 33115,212.35"];
	layer2_expert11_4 -> layer2_moe_agg_gpu11	[pos="e,33125,216.84 32646,284.57 32649,283.65 32652,282.79 32655,282 32811,240.67 32997,224.05 33115,217.4"];
	layer2_expert11_5 -> layer2_moe_agg_gpu11	[pos="e,33125,225.64 32838,284.8 32841,283.81 32844,282.87 32847,282 32935,255.86 33038,238.04 33115,227.08"];
	layer2_expert11_6 -> layer2_moe_agg_gpu11	[pos="e,33136,246.03 33030,285.54 33033,284.33 33036,283.15 33039,282 33067,271.01 33098,259.68 33126,249.45"];
	layer2_expert11_7 -> layer2_moe_agg_gpu11	[pos="e,33202,246.3 33171,281.73 33179,272.7 33187,263.12 33195,254.08"];
	layer2_expert11_8 -> layer2_moe_agg_gpu11	[pos="e,33260,246.3 33291,281.73 33283,272.7 33275,263.12 33267,254.08"];
	layer2_expert11_9 -> layer2_moe_agg_gpu11	[pos="e,33326,246.03 33432,285.54 33429,284.33 33426,283.15 33423,282 33395,271.01 33364,259.68 33336,249.45"];
	layer2_expert11_10 -> layer2_moe_agg_gpu11	[pos="e,33337,225.64 33624,284.8 33621,283.81 33618,282.87 33615,282 33527,255.86 33424,238.04 33347,227.08"];
	layer2_expert11_11 -> layer2_moe_agg_gpu11	[pos="e,33337,216.84 33816,284.57 33813,283.65 33810,282.79 33807,282 33651,240.67 33465,224.05 33347,217.4"];
	layer2_expert11_12 -> layer2_moe_agg_gpu11	[pos="e,33337,212.25 34008,284.38 34005,283.52 34002,282.72 33999,282 33773,225.63 33499,214.01 33347,212.35"];
	layer2_expert11_13 -> layer2_moe_agg_gpu11	[pos="e,33337,216.26 34200,284.31 34197,283.47 34194,282.7 34191,282 34034,244.32 33567,224.2 33347,216.61"];
	layer2_expert11_14 -> layer2_moe_agg_gpu11	[pos="e,33337,214.78 34392,284.27 34389,283.44 34386,282.68 34383,282 34189,236.62 33600,220.09 33348,214.98"];
	layer2_expert11_15 -> layer2_moe_agg_gpu11	[pos="e,33337,213.71 34584,284.23 34581,283.42 34578,282.67 34575,282 34343,228.87 33630,216.61 33348,213.81"];
	layer2_output_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU11
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 11",
		pos="33231,108",
		shape=rectangle,
		width=3.5139];
	layer2_moe_agg_gpu11 -> layer2_output_gpu11	[pos="e,33231,142.3 33231,177.88 33231,169.78 33231,160.98 33231,152.47"];
	layer2_qkv_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_QKV_Projection_GPU12
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 12",
		pos="35217,762",
		shape=rectangle,
		width=2.9444];
	layer2_attn_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU12
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 12",
		pos="35880,658",
		shape=rectangle,
		width=3.5];
	layer2_qkv_gpu12 -> layer2_attn_gpu12	[pos="e,35754,672.53 35323,735.64 35336,732.89 35349,730.26 35362,728 35491,704.8 35639,685.83 35744,673.69"];
	layer2_attn_norm_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU12
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 12",
		pos="36044,554",
		shape=rectangle,
		width=3.5139];
	layer2_attn_gpu12 -> layer2_attn_norm_gpu12	[pos="e,35991,588.12 35933,623.88 35949,614.21 35966,603.56 35982,593.59"];
	layer2_gate_gpu12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU12
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 12",
		pos="36207,442.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu12 -> layer2_gate_gpu12	[pos="e,36147,484.08 36093,519.85 36107,510.34 36123,499.8 36138,489.66"];
	layer2_expert12_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="34863,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu12 -> layer2_expert12_0	[pos="e,34950,362.73 36085,439.24 35818,433.47 35189,415.11 34960,364.99",
		style=dashed];
	layer2_expert12_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="35055,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu12 -> layer2_expert12_1	[pos="e,35142,362.69 36085,437.65 35850,429.46 35343,407.62 35152,364.99",
		style=dashed];
	layer2_expert12_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="35247,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu12 -> layer2_expert12_2	[pos="e,35334,362.63 36085,435.36 35885,424.58 35497,400.2 35344,364.96",
		style=dashed];
	layer2_expert12_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="35439,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu12 -> layer2_expert12_3	[pos="e,35526,362.45 36085,438.05 35951,431.91 35730,414.84 35536,365",
		style=dashed];
	layer2_expert12_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="35631,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu12 -> layer2_expert12_4	[pos="e,35718,362.28 36085,430.26 35989,419.56 35853,400.14 35728,365.05",
		style=dashed];
	layer2_expert12_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="35823,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu12 -> layer2_expert12_5	[pos="e,35910,361.89 36085,413.02 36036,400.63 35979,385.01 35920,365.12",
		style=dashed];
	layer2_expert12_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="36015,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu12 -> layer2_expert12_6	[pos="e,36081,365.02 36140,400.91 36124,391.02 36107,380.37 36090,370.25",
		style=dashed];
	layer2_expert12_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="36207,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu12 -> layer2_expert12_7	[pos="e,36207,365.02 36207,400.91 36207,392.65 36207,383.86 36207,375.3",
		style=dashed];
	layer2_expert12_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="36399,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu12 -> layer2_expert12_8	[pos="e,36333,365.02 36274,400.91 36290,391.02 36307,380.37 36324,370.25",
		style=dashed];
	layer2_expert12_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="36591,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu12 -> layer2_expert12_9	[pos="e,36504,361.89 36329,413.02 36378,400.63 36435,385.01 36494,365.12",
		style=dashed];
	layer2_expert12_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="36783,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu12 -> layer2_expert12_10	[pos="e,36696,362.28 36329,430.26 36425,419.56 36561,400.14 36686,365.05",
		style=dashed];
	layer2_expert12_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="36975,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu12 -> layer2_expert12_11	[pos="e,36888,362.45 36329,438.05 36463,431.91 36684,414.84 36878,365",
		style=dashed];
	layer2_expert12_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="37167,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu12 -> layer2_expert12_12	[pos="e,37080,362.63 36329,435.36 36529,424.58 36917,400.2 37070,364.96",
		style=dashed];
	layer2_expert12_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="37359,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu12 -> layer2_expert12_13	[pos="e,37272,362.69 36329,437.65 36564,429.46 37071,407.62 37262,364.99",
		style=dashed];
	layer2_expert12_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="37551,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu12 -> layer2_expert12_14	[pos="e,37464,362.73 36329,439.24 36596,433.47 37225,415.11 37454,364.99",
		style=dashed];
	layer2_expert12_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="37743,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu12 -> layer2_expert12_15	[pos="e,37656,362.76 36329,440.41 36626,436.92 37378,422.7 37646,365.01",
		style=dashed];
	layer2_moe_agg_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_MoE_Aggregate_GPU12
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 12",
		pos="36303,212",
		shape=rectangle,
		width=2.9444];
	layer2_expert12_0 -> layer2_moe_agg_gpu12	[pos="e,36197,213.71 34950,284.23 34953,283.42 34956,282.67 34959,282 35191,228.87 35904,216.61 36186,213.81"];
	layer2_expert12_1 -> layer2_moe_agg_gpu12	[pos="e,36197,214.78 35142,284.27 35145,283.44 35148,282.68 35151,282 35345,236.62 35934,220.09 36186,214.98"];
	layer2_expert12_2 -> layer2_moe_agg_gpu12	[pos="e,36197,216.26 35334,284.31 35337,283.47 35340,282.7 35343,282 35500,244.32 35967,224.2 36187,216.61"];
	layer2_expert12_3 -> layer2_moe_agg_gpu12	[pos="e,36197,212.25 35526,284.38 35529,283.52 35532,282.72 35535,282 35761,225.63 36035,214.01 36187,212.35"];
	layer2_expert12_4 -> layer2_moe_agg_gpu12	[pos="e,36197,216.84 35718,284.57 35721,283.65 35724,282.79 35727,282 35883,240.67 36069,224.05 36187,217.4"];
	layer2_expert12_5 -> layer2_moe_agg_gpu12	[pos="e,36197,225.64 35910,284.8 35913,283.81 35916,282.87 35919,282 36007,255.86 36110,238.04 36187,227.08"];
	layer2_expert12_6 -> layer2_moe_agg_gpu12	[pos="e,36208,246.03 36102,285.54 36105,284.33 36108,283.15 36111,282 36139,271.01 36170,259.68 36198,249.45"];
	layer2_expert12_7 -> layer2_moe_agg_gpu12	[pos="e,36274,246.3 36243,281.73 36251,272.7 36259,263.12 36267,254.08"];
	layer2_expert12_8 -> layer2_moe_agg_gpu12	[pos="e,36332,246.3 36363,281.73 36355,272.7 36347,263.12 36339,254.08"];
	layer2_expert12_9 -> layer2_moe_agg_gpu12	[pos="e,36398,246.03 36504,285.54 36501,284.33 36498,283.15 36495,282 36467,271.01 36436,259.68 36408,249.45"];
	layer2_expert12_10 -> layer2_moe_agg_gpu12	[pos="e,36409,225.64 36696,284.8 36693,283.81 36690,282.87 36687,282 36599,255.86 36496,238.04 36419,227.08"];
	layer2_expert12_11 -> layer2_moe_agg_gpu12	[pos="e,36409,216.84 36888,284.57 36885,283.65 36882,282.79 36879,282 36723,240.67 36537,224.05 36419,217.4"];
	layer2_expert12_12 -> layer2_moe_agg_gpu12	[pos="e,36409,212.25 37080,284.38 37077,283.52 37074,282.72 37071,282 36845,225.63 36571,214.01 36419,212.35"];
	layer2_expert12_13 -> layer2_moe_agg_gpu12	[pos="e,36409,216.26 37272,284.31 37269,283.47 37266,282.7 37263,282 37106,244.32 36639,224.2 36419,216.61"];
	layer2_expert12_14 -> layer2_moe_agg_gpu12	[pos="e,36409,214.78 37464,284.27 37461,283.44 37458,282.68 37455,282 37261,236.62 36672,220.09 36420,214.98"];
	layer2_expert12_15 -> layer2_moe_agg_gpu12	[pos="e,36409,213.71 37656,284.23 37653,283.42 37650,282.67 37647,282 37415,228.87 36702,216.61 36420,213.81"];
	layer2_output_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU12
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 12",
		pos="36303,108",
		shape=rectangle,
		width=3.5139];
	layer2_moe_agg_gpu12 -> layer2_output_gpu12	[pos="e,36303,142.3 36303,177.88 36303,169.78 36303,160.98 36303,152.47"];
	layer2_qkv_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_QKV_Projection_GPU13
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 13",
		pos="35477,762",
		shape=rectangle,
		width=2.9444];
	layer2_attn_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU13
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 13",
		pos="38203,658",
		shape=rectangle,
		width=3.5];
	layer2_qkv_gpu13 -> layer2_attn_gpu13	[pos="e,38077,659.21 35583,735.05 35598,732.23 35613,729.75 35627,728 36106,669.45 37606,660.58 38067,659.24"];
	layer2_attn_norm_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU13
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 13",
		pos="38741,554",
		shape=rectangle,
		width=3.5139];
	layer2_attn_gpu13 -> layer2_attn_norm_gpu13	[pos="e,38614,579.03 38329,633.09 38412,617.42 38520,596.96 38604,580.91"];
	layer2_gate_gpu13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU13
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 13",
		pos="39279,442.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu13 -> layer2_gate_gpu13	[pos="e,39157,468.38 38868,527.19 38952,510.1 39062,487.73 39147,470.42"];
	layer2_expert13_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="37935,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu13 -> layer2_expert13_0	[pos="e,38022,362.73 39157,439.24 38890,433.47 38261,415.11 38032,364.99",
		style=dashed];
	layer2_expert13_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="38127,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu13 -> layer2_expert13_1	[pos="e,38214,362.69 39157,437.65 38922,429.46 38415,407.62 38224,364.99",
		style=dashed];
	layer2_expert13_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="38319,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu13 -> layer2_expert13_2	[pos="e,38406,362.63 39157,435.36 38957,424.58 38569,400.2 38416,364.96",
		style=dashed];
	layer2_expert13_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="38511,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu13 -> layer2_expert13_3	[pos="e,38598,362.45 39157,438.05 39023,431.91 38802,414.84 38608,365",
		style=dashed];
	layer2_expert13_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="38703,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu13 -> layer2_expert13_4	[pos="e,38790,362.28 39157,430.26 39061,419.56 38925,400.14 38800,365.05",
		style=dashed];
	layer2_expert13_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="38895,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu13 -> layer2_expert13_5	[pos="e,38982,361.89 39157,413.02 39108,400.63 39051,385.01 38992,365.12",
		style=dashed];
	layer2_expert13_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="39087,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu13 -> layer2_expert13_6	[pos="e,39153,365.02 39212,400.91 39196,391.02 39179,380.37 39162,370.25",
		style=dashed];
	layer2_expert13_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="39279,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu13 -> layer2_expert13_7	[pos="e,39279,365.02 39279,400.91 39279,392.65 39279,383.86 39279,375.3",
		style=dashed];
	layer2_expert13_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="39471,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu13 -> layer2_expert13_8	[pos="e,39405,365.02 39346,400.91 39362,391.02 39379,380.37 39396,370.25",
		style=dashed];
	layer2_expert13_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="39663,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu13 -> layer2_expert13_9	[pos="e,39576,361.89 39401,413.02 39450,400.63 39507,385.01 39566,365.12",
		style=dashed];
	layer2_expert13_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="39855,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu13 -> layer2_expert13_10	[pos="e,39768,362.28 39401,430.26 39497,419.56 39633,400.14 39758,365.05",
		style=dashed];
	layer2_expert13_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="40047,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu13 -> layer2_expert13_11	[pos="e,39960,362.45 39401,438.05 39535,431.91 39756,414.84 39950,365",
		style=dashed];
	layer2_expert13_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="40239,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu13 -> layer2_expert13_12	[pos="e,40152,362.63 39401,435.36 39601,424.58 39989,400.2 40142,364.96",
		style=dashed];
	layer2_expert13_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="40431,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu13 -> layer2_expert13_13	[pos="e,40344,362.69 39401,437.65 39636,429.46 40143,407.62 40334,364.99",
		style=dashed];
	layer2_expert13_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="40623,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu13 -> layer2_expert13_14	[pos="e,40536,362.73 39401,439.24 39668,433.47 40297,415.11 40526,364.99",
		style=dashed];
	layer2_expert13_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="40815,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu13 -> layer2_expert13_15	[pos="e,40728,362.76 39401,440.41 39698,436.92 40450,422.7 40718,365.01",
		style=dashed];
	layer2_moe_agg_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_MoE_Aggregate_GPU13
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 13",
		pos="39375,212",
		shape=rectangle,
		width=2.9444];
	layer2_expert13_0 -> layer2_moe_agg_gpu13	[pos="e,39269,213.71 38022,284.23 38025,283.42 38028,282.67 38031,282 38263,228.87 38976,216.61 39258,213.81"];
	layer2_expert13_1 -> layer2_moe_agg_gpu13	[pos="e,39269,214.78 38214,284.27 38217,283.44 38220,282.68 38223,282 38417,236.62 39006,220.09 39258,214.98"];
	layer2_expert13_2 -> layer2_moe_agg_gpu13	[pos="e,39269,216.26 38406,284.31 38409,283.47 38412,282.7 38415,282 38572,244.32 39039,224.2 39259,216.61"];
	layer2_expert13_3 -> layer2_moe_agg_gpu13	[pos="e,39269,212.25 38598,284.38 38601,283.52 38604,282.72 38607,282 38833,225.63 39107,214.01 39259,212.35"];
	layer2_expert13_4 -> layer2_moe_agg_gpu13	[pos="e,39269,216.84 38790,284.57 38793,283.65 38796,282.79 38799,282 38955,240.67 39141,224.05 39259,217.4"];
	layer2_expert13_5 -> layer2_moe_agg_gpu13	[pos="e,39269,225.64 38982,284.8 38985,283.81 38988,282.87 38991,282 39079,255.86 39182,238.04 39259,227.08"];
	layer2_expert13_6 -> layer2_moe_agg_gpu13	[pos="e,39280,246.03 39174,285.54 39177,284.33 39180,283.15 39183,282 39211,271.01 39242,259.68 39270,249.45"];
	layer2_expert13_7 -> layer2_moe_agg_gpu13	[pos="e,39346,246.3 39315,281.73 39323,272.7 39331,263.12 39339,254.08"];
	layer2_expert13_8 -> layer2_moe_agg_gpu13	[pos="e,39404,246.3 39435,281.73 39427,272.7 39419,263.12 39411,254.08"];
	layer2_expert13_9 -> layer2_moe_agg_gpu13	[pos="e,39470,246.03 39576,285.54 39573,284.33 39570,283.15 39567,282 39539,271.01 39508,259.68 39480,249.45"];
	layer2_expert13_10 -> layer2_moe_agg_gpu13	[pos="e,39481,225.64 39768,284.8 39765,283.81 39762,282.87 39759,282 39671,255.86 39568,238.04 39491,227.08"];
	layer2_expert13_11 -> layer2_moe_agg_gpu13	[pos="e,39481,216.84 39960,284.57 39957,283.65 39954,282.79 39951,282 39795,240.67 39609,224.05 39491,217.4"];
	layer2_expert13_12 -> layer2_moe_agg_gpu13	[pos="e,39481,212.25 40152,284.38 40149,283.52 40146,282.72 40143,282 39917,225.63 39643,214.01 39491,212.35"];
	layer2_expert13_13 -> layer2_moe_agg_gpu13	[pos="e,39481,216.26 40344,284.31 40341,283.47 40338,282.7 40335,282 40178,244.32 39711,224.2 39491,216.61"];
	layer2_expert13_14 -> layer2_moe_agg_gpu13	[pos="e,39481,214.78 40536,284.27 40533,283.44 40530,282.68 40527,282 40333,236.62 39744,220.09 39492,214.98"];
	layer2_expert13_15 -> layer2_moe_agg_gpu13	[pos="e,39481,213.71 40728,284.23 40725,283.42 40722,282.67 40719,282 40487,228.87 39774,216.61 39492,213.81"];
	layer2_output_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU13
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 13",
		pos="39375,108",
		shape=rectangle,
		width=3.5139];
	layer2_moe_agg_gpu13 -> layer2_output_gpu13	[pos="e,39375,142.3 39375,177.88 39375,169.78 39375,160.98 39375,152.47"];
	layer2_qkv_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_QKV_Projection_GPU14
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 14",
		pos="35742,762",
		shape=rectangle,
		width=2.9444];
	layer2_attn_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU14
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 14",
		pos="40901,658",
		shape=rectangle,
		width=3.5];
	layer2_qkv_gpu14 -> layer2_attn_gpu14	[pos="e,40775,660.65 35848,735.11 35864,732.22 35879,729.7 35894,728 35925,724.44 39966,671.26 40765,660.78"];
	layer2_attn_norm_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU14
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 14",
		pos="41626,554",
		shape=rectangle,
		width=3.5139];
	layer2_attn_gpu14 -> layer2_attn_norm_gpu14	[pos="e,41499,572.82 41027,639.23 41156,621.07 41356,592.95 41489,574.26"];
	layer2_gate_gpu14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU14
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 14",
		pos="42351,442.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu14 -> layer2_gate_gpu14	[pos="e,42229,461.97 41753,533.86 41883,514.15 42086,483.54 42219,463.51"];
	layer2_expert14_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="41007,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu14 -> layer2_expert14_0	[pos="e,41094,362.73 42229,439.24 41962,433.47 41333,415.11 41104,364.99",
		style=dashed];
	layer2_expert14_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="41199,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu14 -> layer2_expert14_1	[pos="e,41286,362.69 42229,437.65 41994,429.46 41487,407.62 41296,364.99",
		style=dashed];
	layer2_expert14_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="41391,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu14 -> layer2_expert14_2	[pos="e,41478,362.63 42229,435.36 42029,424.58 41641,400.2 41488,364.96",
		style=dashed];
	layer2_expert14_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="41583,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu14 -> layer2_expert14_3	[pos="e,41670,362.45 42229,438.05 42095,431.91 41874,414.84 41680,365",
		style=dashed];
	layer2_expert14_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="41775,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu14 -> layer2_expert14_4	[pos="e,41862,362.28 42229,430.26 42133,419.56 41997,400.14 41872,365.05",
		style=dashed];
	layer2_expert14_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="41967,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu14 -> layer2_expert14_5	[pos="e,42054,361.89 42229,413.02 42180,400.63 42123,385.01 42064,365.12",
		style=dashed];
	layer2_expert14_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="42159,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu14 -> layer2_expert14_6	[pos="e,42225,365.02 42284,400.91 42268,391.02 42251,380.37 42234,370.25",
		style=dashed];
	layer2_expert14_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="42351,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu14 -> layer2_expert14_7	[pos="e,42351,365.02 42351,400.91 42351,392.65 42351,383.86 42351,375.3",
		style=dashed];
	layer2_expert14_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="42543,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu14 -> layer2_expert14_8	[pos="e,42477,365.02 42418,400.91 42434,391.02 42451,380.37 42468,370.25",
		style=dashed];
	layer2_expert14_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="42735,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu14 -> layer2_expert14_9	[pos="e,42648,361.89 42473,413.02 42522,400.63 42579,385.01 42638,365.12",
		style=dashed];
	layer2_expert14_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="42927,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu14 -> layer2_expert14_10	[pos="e,42840,362.28 42473,430.26 42569,419.56 42705,400.14 42830,365.05",
		style=dashed];
	layer2_expert14_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="43119,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu14 -> layer2_expert14_11	[pos="e,43032,362.45 42473,438.05 42607,431.91 42828,414.84 43022,365",
		style=dashed];
	layer2_expert14_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="43311,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu14 -> layer2_expert14_12	[pos="e,43224,362.63 42473,435.36 42673,424.58 43061,400.2 43214,364.96",
		style=dashed];
	layer2_expert14_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="43503,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu14 -> layer2_expert14_13	[pos="e,43416,362.69 42473,437.65 42708,429.46 43215,407.62 43406,364.99",
		style=dashed];
	layer2_expert14_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="43695,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu14 -> layer2_expert14_14	[pos="e,43608,362.73 42473,439.24 42740,433.47 43369,415.11 43598,364.99",
		style=dashed];
	layer2_expert14_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="43887,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu14 -> layer2_expert14_15	[pos="e,43800,362.76 42473,440.41 42770,436.92 43522,422.7 43790,365.01",
		style=dashed];
	layer2_moe_agg_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_MoE_Aggregate_GPU14
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 14",
		pos="42447,212",
		shape=rectangle,
		width=2.9444];
	layer2_expert14_0 -> layer2_moe_agg_gpu14	[pos="e,42341,213.71 41094,284.23 41097,283.42 41100,282.67 41103,282 41335,228.87 42048,216.61 42330,213.81"];
	layer2_expert14_1 -> layer2_moe_agg_gpu14	[pos="e,42341,214.78 41286,284.27 41289,283.44 41292,282.68 41295,282 41489,236.62 42078,220.09 42330,214.98"];
	layer2_expert14_2 -> layer2_moe_agg_gpu14	[pos="e,42341,216.26 41478,284.31 41481,283.47 41484,282.7 41487,282 41644,244.32 42111,224.2 42331,216.61"];
	layer2_expert14_3 -> layer2_moe_agg_gpu14	[pos="e,42341,212.25 41670,284.38 41673,283.52 41676,282.72 41679,282 41905,225.63 42179,214.01 42331,212.35"];
	layer2_expert14_4 -> layer2_moe_agg_gpu14	[pos="e,42341,216.84 41862,284.57 41865,283.65 41868,282.79 41871,282 42027,240.67 42213,224.05 42331,217.4"];
	layer2_expert14_5 -> layer2_moe_agg_gpu14	[pos="e,42341,225.64 42054,284.8 42057,283.81 42060,282.87 42063,282 42151,255.86 42254,238.04 42331,227.08"];
	layer2_expert14_6 -> layer2_moe_agg_gpu14	[pos="e,42352,246.03 42246,285.54 42249,284.33 42252,283.15 42255,282 42283,271.01 42314,259.68 42342,249.45"];
	layer2_expert14_7 -> layer2_moe_agg_gpu14	[pos="e,42418,246.3 42387,281.73 42395,272.7 42403,263.12 42411,254.08"];
	layer2_expert14_8 -> layer2_moe_agg_gpu14	[pos="e,42476,246.3 42507,281.73 42499,272.7 42491,263.12 42483,254.08"];
	layer2_expert14_9 -> layer2_moe_agg_gpu14	[pos="e,42542,246.03 42648,285.54 42645,284.33 42642,283.15 42639,282 42611,271.01 42580,259.68 42552,249.45"];
	layer2_expert14_10 -> layer2_moe_agg_gpu14	[pos="e,42553,225.64 42840,284.8 42837,283.81 42834,282.87 42831,282 42743,255.86 42640,238.04 42563,227.08"];
	layer2_expert14_11 -> layer2_moe_agg_gpu14	[pos="e,42553,216.84 43032,284.57 43029,283.65 43026,282.79 43023,282 42867,240.67 42681,224.05 42563,217.4"];
	layer2_expert14_12 -> layer2_moe_agg_gpu14	[pos="e,42553,212.25 43224,284.38 43221,283.52 43218,282.72 43215,282 42989,225.63 42715,214.01 42563,212.35"];
	layer2_expert14_13 -> layer2_moe_agg_gpu14	[pos="e,42553,216.26 43416,284.31 43413,283.47 43410,282.7 43407,282 43250,244.32 42783,224.2 42563,216.61"];
	layer2_expert14_14 -> layer2_moe_agg_gpu14	[pos="e,42553,214.78 43608,284.27 43605,283.44 43602,282.68 43599,282 43405,236.62 42816,220.09 42564,214.98"];
	layer2_expert14_15 -> layer2_moe_agg_gpu14	[pos="e,42553,213.71 43800,284.23 43797,283.42 43794,282.67 43791,282 43559,228.87 42846,216.61 42564,213.81"];
	layer2_output_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU14
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 14",
		pos="42447,108",
		shape=rectangle,
		width=3.5139];
	layer2_moe_agg_gpu14 -> layer2_output_gpu14	[pos="e,42447,142.3 42447,177.88 42447,169.78 42447,160.98 42447,152.47"];
	layer2_qkv_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_QKV_Projection_GPU15
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 15",
		pos="36009,762",
		shape=rectangle,
		width=2.9444];
	layer2_attn_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU15
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 15",
		pos="42385,658",
		shape=rectangle,
		width=3.5];
	layer2_qkv_gpu15 -> layer2_attn_gpu15	[pos="e,42259,662.55 36115,759.97 36645,754.71 39059,729.74 41036,692 41479,683.53 42005,669.55 42248,662.83"];
	layer2_attn_norm_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU15
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 15",
		pos="43297,554",
		shape=rectangle,
		width=3.5139];
	layer2_attn_gpu15 -> layer2_attn_norm_gpu15	[pos="e,43170,569.16 42511,642.87 42682,623.8 42985,589.94 43160,570.29"];
	layer2_gate_gpu15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU15
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 15",
		pos="45423,442.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu15 -> layer2_gate_gpu15	[pos="e,45301,449.8 43424,546.48 43800,527.11 44907,470.06 45291,450.32"];
	layer2_expert15_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="44079,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu15 -> layer2_expert15_0	[pos="e,44166,362.73 45301,439.24 45034,433.47 44405,415.11 44176,364.99",
		style=dashed];
	layer2_expert15_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="44271,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu15 -> layer2_expert15_1	[pos="e,44358,362.69 45301,437.65 45066,429.46 44559,407.62 44368,364.99",
		style=dashed];
	layer2_expert15_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="44463,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu15 -> layer2_expert15_2	[pos="e,44550,362.63 45301,435.36 45101,424.58 44713,400.2 44560,364.96",
		style=dashed];
	layer2_expert15_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="44655,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu15 -> layer2_expert15_3	[pos="e,44742,362.45 45301,438.05 45167,431.91 44946,414.84 44752,365",
		style=dashed];
	layer2_expert15_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="44847,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu15 -> layer2_expert15_4	[pos="e,44934,362.28 45301,430.26 45205,419.56 45069,400.14 44944,365.05",
		style=dashed];
	layer2_expert15_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="45039,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu15 -> layer2_expert15_5	[pos="e,45126,361.89 45301,413.02 45252,400.63 45195,385.01 45136,365.12",
		style=dashed];
	layer2_expert15_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="45231,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu15 -> layer2_expert15_6	[pos="e,45297,365.02 45356,400.91 45340,391.02 45323,380.37 45306,370.25",
		style=dashed];
	layer2_expert15_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="45423,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu15 -> layer2_expert15_7	[pos="e,45423,365.02 45423,400.91 45423,392.65 45423,383.86 45423,375.3",
		style=dashed];
	layer2_expert15_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="45615,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu15 -> layer2_expert15_8	[pos="e,45549,365.02 45490,400.91 45506,391.02 45523,380.37 45540,370.25",
		style=dashed];
	layer2_expert15_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="45807,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu15 -> layer2_expert15_9	[pos="e,45720,361.89 45545,413.02 45594,400.63 45651,385.01 45710,365.12",
		style=dashed];
	layer2_expert15_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="45999,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu15 -> layer2_expert15_10	[pos="e,45912,362.28 45545,430.26 45641,419.56 45777,400.14 45902,365.05",
		style=dashed];
	layer2_expert15_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="46191,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu15 -> layer2_expert15_11	[pos="e,46104,362.45 45545,438.05 45679,431.91 45900,414.84 46094,365",
		style=dashed];
	layer2_expert15_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="46383,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu15 -> layer2_expert15_12	[pos="e,46296,362.63 45545,435.36 45745,424.58 46133,400.2 46286,364.96",
		style=dashed];
	layer2_expert15_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="46575,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu15 -> layer2_expert15_13	[pos="e,46488,362.69 45545,437.65 45780,429.46 46287,407.62 46478,364.99",
		style=dashed];
	layer2_expert15_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="46767,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu15 -> layer2_expert15_14	[pos="e,46680,362.73 45545,439.24 45812,433.47 46441,415.11 46670,364.99",
		style=dashed];
	layer2_expert15_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="46959,323.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu15 -> layer2_expert15_15	[pos="e,46872,362.76 45545,440.41 45842,436.92 46594,422.7 46862,365.01",
		style=dashed];
	layer2_moe_agg_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_MoE_Aggregate_GPU15
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 15",
		pos="45519,212",
		shape=rectangle,
		width=2.9444];
	layer2_expert15_0 -> layer2_moe_agg_gpu15	[pos="e,45413,213.71 44166,284.23 44169,283.42 44172,282.67 44175,282 44407,228.87 45120,216.61 45402,213.81"];
	layer2_expert15_1 -> layer2_moe_agg_gpu15	[pos="e,45413,214.78 44358,284.27 44361,283.44 44364,282.68 44367,282 44561,236.62 45150,220.09 45402,214.98"];
	layer2_expert15_2 -> layer2_moe_agg_gpu15	[pos="e,45413,216.26 44550,284.31 44553,283.47 44556,282.7 44559,282 44716,244.32 45183,224.2 45403,216.61"];
	layer2_expert15_3 -> layer2_moe_agg_gpu15	[pos="e,45413,212.25 44742,284.38 44745,283.52 44748,282.72 44751,282 44977,225.63 45251,214.01 45403,212.35"];
	layer2_expert15_4 -> layer2_moe_agg_gpu15	[pos="e,45413,216.84 44934,284.57 44937,283.65 44940,282.79 44943,282 45099,240.67 45285,224.05 45403,217.4"];
	layer2_expert15_5 -> layer2_moe_agg_gpu15	[pos="e,45413,225.64 45126,284.8 45129,283.81 45132,282.87 45135,282 45223,255.86 45326,238.04 45403,227.08"];
	layer2_expert15_6 -> layer2_moe_agg_gpu15	[pos="e,45424,246.03 45318,285.54 45321,284.33 45324,283.15 45327,282 45355,271.01 45386,259.68 45414,249.45"];
	layer2_expert15_7 -> layer2_moe_agg_gpu15	[pos="e,45490,246.3 45459,281.73 45467,272.7 45475,263.12 45483,254.08"];
	layer2_expert15_8 -> layer2_moe_agg_gpu15	[pos="e,45548,246.3 45579,281.73 45571,272.7 45563,263.12 45555,254.08"];
	layer2_expert15_9 -> layer2_moe_agg_gpu15	[pos="e,45614,246.03 45720,285.54 45717,284.33 45714,283.15 45711,282 45683,271.01 45652,259.68 45624,249.45"];
	layer2_expert15_10 -> layer2_moe_agg_gpu15	[pos="e,45625,225.64 45912,284.8 45909,283.81 45906,282.87 45903,282 45815,255.86 45712,238.04 45635,227.08"];
	layer2_expert15_11 -> layer2_moe_agg_gpu15	[pos="e,45625,216.84 46104,284.57 46101,283.65 46098,282.79 46095,282 45939,240.67 45753,224.05 45635,217.4"];
	layer2_expert15_12 -> layer2_moe_agg_gpu15	[pos="e,45625,212.25 46296,284.38 46293,283.52 46290,282.72 46287,282 46061,225.63 45787,214.01 45635,212.35"];
	layer2_expert15_13 -> layer2_moe_agg_gpu15	[pos="e,45625,216.26 46488,284.31 46485,283.47 46482,282.7 46479,282 46322,244.32 45855,224.2 45635,216.61"];
	layer2_expert15_14 -> layer2_moe_agg_gpu15	[pos="e,45625,214.78 46680,284.27 46677,283.44 46674,282.68 46671,282 46477,236.62 45888,220.09 45636,214.98"];
	layer2_expert15_15 -> layer2_moe_agg_gpu15	[pos="e,45625,213.71 46872,284.23 46869,283.42 46866,282.67 46863,282 46631,228.87 45918,216.61 45636,213.81"];
	layer2_output_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU15
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 15",
		pos="45519,108",
		shape=rectangle,
		width=3.5139];
	layer2_moe_agg_gpu15 -> layer2_output_gpu15	[pos="e,45519,142.3 45519,177.88 45519,169.78 45519,160.98 45519,152.47"];
	layer3_qkv_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_QKV_Projection_GPU8
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 8",
		pos="49178,1744.5",
		shape=rectangle,
		width=2.9444];
	layer3_attn_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU8
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 8",
		pos="49178,1633",
		shape=rectangle,
		width=3.375];
	layer3_qkv_gpu8 -> layer3_attn_gpu8	[pos="e,49178,1667 49178,1710.3 49178,1699.9 49178,1688.3 49178,1677.3"];
	layer3_attn_norm_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU8
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 8",
		pos="49178,1529",
		shape=rectangle,
		width=3.3889];
	layer3_attn_gpu8 -> layer3_attn_norm_gpu8	[pos="e,49178,1563.3 49178,1598.9 49178,1590.8 49178,1582 49178,1573.5"];
	layer3_gate_gpu8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU8
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 8",
		pos="49178,1417.5",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu8 -> layer3_gate_gpu8	[pos="e,49178,1459.3 49178,1494.8 49178,1486.8 49178,1478 49178,1469.3"];
	layer3_expert8_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="47738,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu8 -> layer3_expert8_0	[pos="e,47825,1337.7 49056,1414.9 48774,1410.3 48084,1393.9 47835,1340",
		style=dashed];
	layer3_expert8_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="47930,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu8 -> layer3_expert8_1	[pos="e,48017,1337.7 49056,1413.5 48805,1406.5 48237,1386.4 48027,1340",
		style=dashed];
	layer3_expert8_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="48122,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu8 -> layer3_expert8_2	[pos="e,48209,1337.7 49056,1411.6 48838,1402.2 48392,1378.9 48219,1340",
		style=dashed];
	layer3_expert8_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="48314,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu8 -> layer3_expert8_3	[pos="e,48401,1337.6 49056,1415.5 48905,1411.9 48641,1397.2 48411,1340.1",
		style=dashed];
	layer3_expert8_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="48506,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu8 -> layer3_expert8_4	[pos="e,48593,1337.4 49056,1409.8 48940,1401.2 48763,1382.5 48603,1340.1",
		style=dashed];
	layer3_expert8_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="48698,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu8 -> layer3_expert8_5	[pos="e,48785,1337.1 49056,1398.7 48982,1386.4 48887,1367.7 48795,1340.1",
		style=dashed];
	layer3_expert8_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="48890,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu8 -> layer3_expert8_6	[pos="e,48977,1336.3 49075,1376 49049,1365.5 49020,1354 48987,1340.3",
		style=dashed];
	layer3_expert8_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="49082,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu8 -> layer3_expert8_7	[pos="e,49115,1340 49145,1375.9 49137,1366.8 49129,1357.1 49122,1347.8",
		style=dashed];
	layer3_expert8_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="49274,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu8 -> layer3_expert8_8	[pos="e,49241,1340 49211,1375.9 49219,1366.8 49227,1357.1 49234,1347.8",
		style=dashed];
	layer3_expert8_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="49466,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu8 -> layer3_expert8_9	[pos="e,49379,1336.3 49281,1376 49307,1365.5 49336,1354 49369,1340.3",
		style=dashed];
	layer3_expert8_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="49658,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu8 -> layer3_expert8_10	[pos="e,49571,1337.1 49300,1398.7 49374,1386.4 49469,1367.7 49561,1340.1",
		style=dashed];
	layer3_expert8_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="49850,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu8 -> layer3_expert8_11	[pos="e,49763,1337.4 49300,1409.8 49416,1401.2 49593,1382.5 49753,1340.1",
		style=dashed];
	layer3_expert8_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="50042,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu8 -> layer3_expert8_12	[pos="e,49955,1337.6 49300,1415.5 49451,1411.9 49715,1397.2 49945,1340.1",
		style=dashed];
	layer3_expert8_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="50234,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu8 -> layer3_expert8_13	[pos="e,50147,1337.7 49300,1411.6 49518,1402.2 49964,1378.9 50137,1340",
		style=dashed];
	layer3_expert8_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="50426,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu8 -> layer3_expert8_14	[pos="e,50339,1337.7 49300,1413.5 49551,1406.5 50119,1386.4 50329,1340",
		style=dashed];
	layer3_expert8_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU8
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 8",
		pos="50618,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu8 -> layer3_expert8_15	[pos="e,50531,1337.7 49300,1414.9 49582,1410.3 50272,1393.9 50521,1340",
		style=dashed];
	layer3_moe_agg_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_MoE_Aggregate_GPU8
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 8",
		pos="49274,1179.5",
		shape=rectangle,
		width=2.8194];
	layer3_expert8_0 -> layer3_moe_agg_gpu8	[pos="e,49172,1181.4 47825,1259.2 47828,1258.4 47831,1257.7 47834,1257 48086,1199 48869,1184.8 49162,1181.5"];
	layer3_expert8_1 -> layer3_moe_agg_gpu8	[pos="e,49172,1182.3 48017,1259.3 48020,1258.4 48023,1257.7 48026,1257 48240,1206.8 48898,1188.1 49162,1182.5"];
	layer3_expert8_2 -> layer3_moe_agg_gpu8	[pos="e,49172,1183.6 48209,1259.3 48212,1258.5 48215,1257.7 48218,1257 48395,1214.6 48928,1192 49162,1184"];
	layer3_expert8_3 -> layer3_moe_agg_gpu8	[pos="e,49172,1185.5 48401,1259.4 48404,1258.5 48407,1257.7 48410,1257 48550,1222.3 48962,1196.8 49162,1186.1"];
	layer3_expert8_4 -> layer3_moe_agg_gpu8	[pos="e,49172,1183.1 48593,1259.6 48596,1258.6 48599,1257.8 48602,1257 48795,1206.5 49027,1189.3 49162,1183.5"];
	layer3_expert8_5 -> layer3_moe_agg_gpu8	[pos="e,49172,1189.5 48785,1259.7 48788,1258.8 48791,1257.8 48794,1257 48918,1221.7 49064,1201.3 49162,1190.6"];
	layer3_expert8_6 -> layer3_moe_agg_gpu8	[pos="e,49172,1203.8 48977,1260.1 48980,1259 48983,1258 48986,1257 49043,1237.4 49109,1219.7 49162,1206.3"];
	layer3_expert8_7 -> layer3_moe_agg_gpu8	[pos="e,49220,1213.7 49149,1256.9 49169,1244.6 49191,1231.1 49211,1219"];
	layer3_expert8_8 -> layer3_moe_agg_gpu8	[pos="e,49274,1213.7 49274,1256.9 49274,1246.2 49274,1234.6 49274,1223.8"];
	layer3_expert8_9 -> layer3_moe_agg_gpu8	[pos="e,49328,1213.7 49399,1256.9 49379,1244.6 49357,1231.1 49337,1219"];
	layer3_expert8_10 -> layer3_moe_agg_gpu8	[pos="e,49376,1203.8 49571,1260.1 49568,1259 49565,1258 49562,1257 49505,1237.4 49439,1219.7 49386,1206.3"];
	layer3_expert8_11 -> layer3_moe_agg_gpu8	[pos="e,49376,1189.5 49763,1259.7 49760,1258.8 49757,1257.8 49754,1257 49630,1221.7 49484,1201.3 49386,1190.6"];
	layer3_expert8_12 -> layer3_moe_agg_gpu8	[pos="e,49376,1183.1 49955,1259.6 49952,1258.6 49949,1257.8 49946,1257 49753,1206.5 49521,1189.3 49386,1183.5"];
	layer3_expert8_13 -> layer3_moe_agg_gpu8	[pos="e,49376,1185.5 50147,1259.4 50144,1258.5 50141,1257.7 50138,1257 49998,1222.3 49586,1196.8 49386,1186.1"];
	layer3_expert8_14 -> layer3_moe_agg_gpu8	[pos="e,49376,1183.6 50339,1259.3 50336,1258.5 50333,1257.7 50330,1257 50153,1214.6 49620,1192 49386,1184"];
	layer3_expert8_15 -> layer3_moe_agg_gpu8	[pos="e,49376,1182.3 50531,1259.3 50528,1258.4 50525,1257.7 50522,1257 50308,1206.8 49650,1188.1 49386,1182.5"];
	layer3_output_gpu8	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU8
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 8",
		pos="50679,1068",
		shape=rectangle,
		width=3.3889];
	layer3_moe_agg_gpu8 -> layer3_output_gpu8	[pos="e,50557,1078.5 49376,1170.6 49625,1151.1 50268,1101 50547,1079.3"];
	output	[fillcolor=lightblue,
		height=1.041,
		label="OUTPUT
Input: [batch_size=1024, seq_len=2048, hidden=4096]
GPU: 8-15",
		pos="59929,915",
		shape=ellipse,
		width=8.1121];
	layer3_output_gpu8 -> output	[pos="e,59640,920.71 50801,1065 51766,1049.3 58164,944.81 59630,920.88"];
	layer3_qkv_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_QKV_Projection_GPU9
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 9",
		pos="52250,1744.5",
		shape=rectangle,
		width=2.9444];
	layer3_attn_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU9
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 9",
		pos="52250,1633",
		shape=rectangle,
		width=3.375];
	layer3_qkv_gpu9 -> layer3_attn_gpu9	[pos="e,52250,1667 52250,1710.3 52250,1699.9 52250,1688.3 52250,1677.3"];
	layer3_attn_norm_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU9
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 9",
		pos="52250,1529",
		shape=rectangle,
		width=3.3889];
	layer3_attn_gpu9 -> layer3_attn_norm_gpu9	[pos="e,52250,1563.3 52250,1598.9 52250,1590.8 52250,1582 52250,1573.5"];
	layer3_gate_gpu9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU9
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 9",
		pos="52250,1417.5",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu9 -> layer3_gate_gpu9	[pos="e,52250,1459.3 52250,1494.8 52250,1486.8 52250,1478 52250,1469.3"];
	layer3_expert9_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="50810,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu9 -> layer3_expert9_0	[pos="e,50897,1337.7 52128,1414.9 51846,1410.3 51156,1393.9 50907,1340",
		style=dashed];
	layer3_expert9_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="51002,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu9 -> layer3_expert9_1	[pos="e,51089,1337.7 52128,1413.5 51877,1406.5 51309,1386.4 51099,1340",
		style=dashed];
	layer3_expert9_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="51194,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu9 -> layer3_expert9_2	[pos="e,51281,1337.7 52128,1411.6 51910,1402.2 51464,1378.9 51291,1340",
		style=dashed];
	layer3_expert9_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="51386,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu9 -> layer3_expert9_3	[pos="e,51473,1337.6 52128,1415.5 51977,1411.9 51713,1397.2 51483,1340.1",
		style=dashed];
	layer3_expert9_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="51578,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu9 -> layer3_expert9_4	[pos="e,51665,1337.4 52128,1409.8 52012,1401.2 51835,1382.5 51675,1340.1",
		style=dashed];
	layer3_expert9_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="51770,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu9 -> layer3_expert9_5	[pos="e,51857,1337.1 52128,1398.7 52054,1386.4 51959,1367.7 51867,1340.1",
		style=dashed];
	layer3_expert9_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="51962,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu9 -> layer3_expert9_6	[pos="e,52049,1336.3 52147,1376 52121,1365.5 52092,1354 52059,1340.3",
		style=dashed];
	layer3_expert9_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="52154,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu9 -> layer3_expert9_7	[pos="e,52187,1340 52217,1375.9 52209,1366.8 52201,1357.1 52194,1347.8",
		style=dashed];
	layer3_expert9_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="52346,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu9 -> layer3_expert9_8	[pos="e,52313,1340 52283,1375.9 52291,1366.8 52299,1357.1 52306,1347.8",
		style=dashed];
	layer3_expert9_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="52538,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu9 -> layer3_expert9_9	[pos="e,52451,1336.3 52353,1376 52379,1365.5 52408,1354 52441,1340.3",
		style=dashed];
	layer3_expert9_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="52730,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu9 -> layer3_expert9_10	[pos="e,52643,1337.1 52372,1398.7 52446,1386.4 52541,1367.7 52633,1340.1",
		style=dashed];
	layer3_expert9_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="52922,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu9 -> layer3_expert9_11	[pos="e,52835,1337.4 52372,1409.8 52488,1401.2 52665,1382.5 52825,1340.1",
		style=dashed];
	layer3_expert9_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="53114,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu9 -> layer3_expert9_12	[pos="e,53027,1337.6 52372,1415.5 52523,1411.9 52787,1397.2 53017,1340.1",
		style=dashed];
	layer3_expert9_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="53306,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu9 -> layer3_expert9_13	[pos="e,53219,1337.7 52372,1411.6 52590,1402.2 53036,1378.9 53209,1340",
		style=dashed];
	layer3_expert9_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="53498,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu9 -> layer3_expert9_14	[pos="e,53411,1337.7 52372,1413.5 52623,1406.5 53191,1386.4 53401,1340",
		style=dashed];
	layer3_expert9_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU9
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 9",
		pos="53690,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu9 -> layer3_expert9_15	[pos="e,53603,1337.7 52372,1414.9 52654,1410.3 53344,1393.9 53593,1340",
		style=dashed];
	layer3_moe_agg_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_MoE_Aggregate_GPU9
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 9",
		pos="52346,1179.5",
		shape=rectangle,
		width=2.8194];
	layer3_expert9_0 -> layer3_moe_agg_gpu9	[pos="e,52244,1181.4 50897,1259.2 50900,1258.4 50903,1257.7 50906,1257 51158,1199 51941,1184.8 52234,1181.5"];
	layer3_expert9_1 -> layer3_moe_agg_gpu9	[pos="e,52244,1182.3 51089,1259.3 51092,1258.4 51095,1257.7 51098,1257 51312,1206.8 51970,1188.1 52234,1182.5"];
	layer3_expert9_2 -> layer3_moe_agg_gpu9	[pos="e,52244,1183.6 51281,1259.3 51284,1258.5 51287,1257.7 51290,1257 51467,1214.6 52000,1192 52234,1184"];
	layer3_expert9_3 -> layer3_moe_agg_gpu9	[pos="e,52244,1185.5 51473,1259.4 51476,1258.5 51479,1257.7 51482,1257 51622,1222.3 52034,1196.8 52234,1186.1"];
	layer3_expert9_4 -> layer3_moe_agg_gpu9	[pos="e,52244,1183.1 51665,1259.6 51668,1258.6 51671,1257.8 51674,1257 51867,1206.5 52099,1189.3 52234,1183.5"];
	layer3_expert9_5 -> layer3_moe_agg_gpu9	[pos="e,52244,1189.5 51857,1259.7 51860,1258.8 51863,1257.8 51866,1257 51990,1221.7 52136,1201.3 52234,1190.6"];
	layer3_expert9_6 -> layer3_moe_agg_gpu9	[pos="e,52244,1203.8 52049,1260.1 52052,1259 52055,1258 52058,1257 52115,1237.4 52181,1219.7 52234,1206.3"];
	layer3_expert9_7 -> layer3_moe_agg_gpu9	[pos="e,52292,1213.7 52221,1256.9 52241,1244.6 52263,1231.1 52283,1219"];
	layer3_expert9_8 -> layer3_moe_agg_gpu9	[pos="e,52346,1213.7 52346,1256.9 52346,1246.2 52346,1234.6 52346,1223.8"];
	layer3_expert9_9 -> layer3_moe_agg_gpu9	[pos="e,52400,1213.7 52471,1256.9 52451,1244.6 52429,1231.1 52409,1219"];
	layer3_expert9_10 -> layer3_moe_agg_gpu9	[pos="e,52448,1203.8 52643,1260.1 52640,1259 52637,1258 52634,1257 52577,1237.4 52511,1219.7 52458,1206.3"];
	layer3_expert9_11 -> layer3_moe_agg_gpu9	[pos="e,52448,1189.5 52835,1259.7 52832,1258.8 52829,1257.8 52826,1257 52702,1221.7 52556,1201.3 52458,1190.6"];
	layer3_expert9_12 -> layer3_moe_agg_gpu9	[pos="e,52448,1183.1 53027,1259.6 53024,1258.6 53021,1257.8 53018,1257 52825,1206.5 52593,1189.3 52458,1183.5"];
	layer3_expert9_13 -> layer3_moe_agg_gpu9	[pos="e,52448,1185.5 53219,1259.4 53216,1258.5 53213,1257.7 53210,1257 53070,1222.3 52658,1196.8 52458,1186.1"];
	layer3_expert9_14 -> layer3_moe_agg_gpu9	[pos="e,52448,1183.6 53411,1259.3 53408,1258.5 53405,1257.7 53402,1257 53225,1214.6 52692,1192 52458,1184"];
	layer3_expert9_15 -> layer3_moe_agg_gpu9	[pos="e,52448,1182.3 53603,1259.3 53600,1258.4 53597,1257.7 53594,1257 53380,1206.8 52722,1188.1 52458,1182.5"];
	layer3_output_gpu9	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU9
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 9",
		pos="53748,1068",
		shape=rectangle,
		width=3.3889];
	layer3_moe_agg_gpu9 -> layer3_output_gpu9	[pos="e,53626,1078.5 52448,1170.6 52697,1151.1 53338,1101 53616,1079.3"];
	layer3_output_gpu9 -> output	[pos="e,59643,922.98 53870,1064 54612,1045.9 58520,950.41 59633,923.23"];
	layer3_qkv_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_QKV_Projection_GPU10
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 10",
		pos="55322,1744.5",
		shape=rectangle,
		width=2.9444];
	layer3_attn_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU10
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 10",
		pos="55322,1633",
		shape=rectangle,
		width=3.5];
	layer3_qkv_gpu10 -> layer3_attn_gpu10	[pos="e,55322,1667 55322,1710.3 55322,1699.9 55322,1688.3 55322,1677.3"];
	layer3_attn_norm_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU10
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 10",
		pos="55322,1529",
		shape=rectangle,
		width=3.5139];
	layer3_attn_gpu10 -> layer3_attn_norm_gpu10	[pos="e,55322,1563.3 55322,1598.9 55322,1590.8 55322,1582 55322,1573.5"];
	layer3_gate_gpu10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU10
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 10",
		pos="55322,1417.5",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu10 -> layer3_gate_gpu10	[pos="e,55322,1459.3 55322,1494.8 55322,1486.8 55322,1478 55322,1469.3"];
	layer3_expert10_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="53882,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu10 -> layer3_expert10_0	[pos="e,53969,1337.7 55200,1414.9 54918,1410.3 54228,1393.9 53979,1340",
		style=dashed];
	layer3_expert10_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="54074,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu10 -> layer3_expert10_1	[pos="e,54161,1337.7 55200,1413.5 54949,1406.5 54381,1386.4 54171,1340",
		style=dashed];
	layer3_expert10_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="54266,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu10 -> layer3_expert10_2	[pos="e,54353,1337.7 55200,1411.6 54982,1402.2 54536,1378.9 54363,1340",
		style=dashed];
	layer3_expert10_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="54458,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu10 -> layer3_expert10_3	[pos="e,54545,1337.6 55200,1415.5 55049,1411.9 54785,1397.2 54555,1340.1",
		style=dashed];
	layer3_expert10_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="54650,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu10 -> layer3_expert10_4	[pos="e,54737,1337.4 55200,1409.8 55084,1401.2 54907,1382.5 54747,1340.1",
		style=dashed];
	layer3_expert10_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="54842,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu10 -> layer3_expert10_5	[pos="e,54929,1337.1 55200,1398.7 55126,1386.4 55031,1367.7 54939,1340.1",
		style=dashed];
	layer3_expert10_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="55034,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu10 -> layer3_expert10_6	[pos="e,55121,1336.3 55219,1376 55193,1365.5 55164,1354 55131,1340.3",
		style=dashed];
	layer3_expert10_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="55226,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu10 -> layer3_expert10_7	[pos="e,55259,1340 55289,1375.9 55281,1366.8 55273,1357.1 55266,1347.8",
		style=dashed];
	layer3_expert10_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="55418,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu10 -> layer3_expert10_8	[pos="e,55385,1340 55355,1375.9 55363,1366.8 55371,1357.1 55378,1347.8",
		style=dashed];
	layer3_expert10_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="55610,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu10 -> layer3_expert10_9	[pos="e,55523,1336.3 55425,1376 55451,1365.5 55480,1354 55513,1340.3",
		style=dashed];
	layer3_expert10_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="55802,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu10 -> layer3_expert10_10	[pos="e,55715,1337.1 55444,1398.7 55518,1386.4 55613,1367.7 55705,1340.1",
		style=dashed];
	layer3_expert10_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="55994,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu10 -> layer3_expert10_11	[pos="e,55907,1337.4 55444,1409.8 55560,1401.2 55737,1382.5 55897,1340.1",
		style=dashed];
	layer3_expert10_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="56186,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu10 -> layer3_expert10_12	[pos="e,56099,1337.6 55444,1415.5 55595,1411.9 55859,1397.2 56089,1340.1",
		style=dashed];
	layer3_expert10_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="56378,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu10 -> layer3_expert10_13	[pos="e,56291,1337.7 55444,1411.6 55662,1402.2 56108,1378.9 56281,1340",
		style=dashed];
	layer3_expert10_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="56570,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu10 -> layer3_expert10_14	[pos="e,56483,1337.7 55444,1413.5 55695,1406.5 56263,1386.4 56473,1340",
		style=dashed];
	layer3_expert10_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU10
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 10",
		pos="56762,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu10 -> layer3_expert10_15	[pos="e,56675,1337.7 55444,1414.9 55726,1410.3 56416,1393.9 56665,1340",
		style=dashed];
	layer3_moe_agg_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_MoE_Aggregate_GPU10
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 10",
		pos="55418,1179.5",
		shape=rectangle,
		width=2.9444];
	layer3_expert10_0 -> layer3_moe_agg_gpu10	[pos="e,55312,1181.4 53969,1259.2 53972,1258.4 53975,1257.7 53978,1257 54229,1199.3 55005,1184.9 55302,1181.5"];
	layer3_expert10_1 -> layer3_moe_agg_gpu10	[pos="e,55312,1182.4 54161,1259.3 54164,1258.4 54167,1257.7 54170,1257 54383,1207.1 55034,1188.3 55301,1182.6"];
	layer3_expert10_2 -> layer3_moe_agg_gpu10	[pos="e,55312,1183.8 54353,1259.3 54356,1258.5 54359,1257.7 54362,1257 54538,1214.8 55065,1192.3 55302,1184.1"];
	layer3_expert10_3 -> layer3_moe_agg_gpu10	[pos="e,55312,1185.8 54545,1259.4 54548,1258.5 54551,1257.7 54554,1257 54692,1222.6 55100,1197.2 55302,1186.3"];
	layer3_expert10_4 -> layer3_moe_agg_gpu10	[pos="e,55312,1183.3 54737,1259.6 54740,1258.6 54743,1257.8 54746,1257 54937,1207.1 55166,1189.7 55301,1183.7"];
	layer3_expert10_5 -> layer3_moe_agg_gpu10	[pos="e,55312,1190 54929,1259.7 54932,1258.8 54935,1257.8 54938,1257 55060,1222.2 55203,1201.9 55302,1191.1"];
	layer3_expert10_6 -> layer3_moe_agg_gpu10	[pos="e,55312,1204.9 55121,1260.1 55124,1259 55127,1258 55130,1257 55186,1237.9 55249,1220.6 55302,1207.3"];
	layer3_expert10_7 -> layer3_moe_agg_gpu10	[pos="e,55364,1213.7 55293,1256.9 55313,1244.6 55335,1231.1 55355,1219"];
	layer3_expert10_8 -> layer3_moe_agg_gpu10	[pos="e,55418,1213.7 55418,1256.9 55418,1246.2 55418,1234.6 55418,1223.8"];
	layer3_expert10_9 -> layer3_moe_agg_gpu10	[pos="e,55472,1213.7 55543,1256.9 55523,1244.6 55501,1231.1 55481,1219"];
	layer3_expert10_10 -> layer3_moe_agg_gpu10	[pos="e,55524,1204.9 55715,1260.1 55712,1259 55709,1258 55706,1257 55650,1237.9 55587,1220.6 55534,1207.3"];
	layer3_expert10_11 -> layer3_moe_agg_gpu10	[pos="e,55524,1190 55907,1259.7 55904,1258.8 55901,1257.8 55898,1257 55776,1222.2 55633,1201.9 55534,1191.1"];
	layer3_expert10_12 -> layer3_moe_agg_gpu10	[pos="e,55524,1183.3 56099,1259.6 56096,1258.6 56093,1257.8 56090,1257 55899,1207.1 55670,1189.7 55535,1183.7"];
	layer3_expert10_13 -> layer3_moe_agg_gpu10	[pos="e,55524,1185.8 56291,1259.4 56288,1258.5 56285,1257.7 56282,1257 56144,1222.6 55736,1197.2 55534,1186.3"];
	layer3_expert10_14 -> layer3_moe_agg_gpu10	[pos="e,55524,1183.8 56483,1259.3 56480,1258.5 56477,1257.7 56474,1257 56298,1214.8 55771,1192.3 55534,1184.1"];
	layer3_expert10_15 -> layer3_moe_agg_gpu10	[pos="e,55524,1182.4 56675,1259.3 56672,1258.4 56669,1257.7 56666,1257 56453,1207.1 55802,1188.3 55535,1182.6"];
	layer3_output_gpu10	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU10
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 10",
		pos="56818,1068",
		shape=rectangle,
		width=3.5139];
	layer3_moe_agg_gpu10 -> layer3_output_gpu10	[pos="e,56691,1078.9 55524,1170.2 55775,1150.6 56403,1101.5 56681,1079.7"];
	layer3_output_gpu10 -> output	[pos="e,59658,929.14 56945,1060.8 57405,1038.5 58997,961.25 59648,929.64"];
	layer3_qkv_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_QKV_Projection_GPU11
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 11",
		pos="58394,1744.5",
		shape=rectangle,
		width=2.9444];
	layer3_attn_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU11
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 11",
		pos="58394,1633",
		shape=rectangle,
		width=3.5];
	layer3_qkv_gpu11 -> layer3_attn_gpu11	[pos="e,58394,1667 58394,1710.3 58394,1699.9 58394,1688.3 58394,1677.3"];
	layer3_attn_norm_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU11
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 11",
		pos="58394,1529",
		shape=rectangle,
		width=3.5139];
	layer3_attn_gpu11 -> layer3_attn_norm_gpu11	[pos="e,58394,1563.3 58394,1598.9 58394,1590.8 58394,1582 58394,1573.5"];
	layer3_gate_gpu11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU11
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 11",
		pos="58394,1417.5",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu11 -> layer3_gate_gpu11	[pos="e,58394,1459.3 58394,1494.8 58394,1486.8 58394,1478 58394,1469.3"];
	layer3_expert11_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="56954,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu11 -> layer3_expert11_0	[pos="e,57041,1337.7 58272,1414.9 57990,1410.3 57300,1393.9 57051,1340",
		style=dashed];
	layer3_expert11_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="57146,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu11 -> layer3_expert11_1	[pos="e,57233,1337.7 58272,1413.5 58021,1406.5 57453,1386.4 57243,1340",
		style=dashed];
	layer3_expert11_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="57338,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu11 -> layer3_expert11_2	[pos="e,57425,1337.7 58272,1411.6 58054,1402.2 57608,1378.9 57435,1340",
		style=dashed];
	layer3_expert11_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="57530,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu11 -> layer3_expert11_3	[pos="e,57617,1337.6 58272,1415.5 58121,1411.9 57857,1397.2 57627,1340.1",
		style=dashed];
	layer3_expert11_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="57722,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu11 -> layer3_expert11_4	[pos="e,57809,1337.4 58272,1409.8 58156,1401.2 57979,1382.5 57819,1340.1",
		style=dashed];
	layer3_expert11_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="57914,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu11 -> layer3_expert11_5	[pos="e,58001,1337.1 58272,1398.7 58198,1386.4 58103,1367.7 58011,1340.1",
		style=dashed];
	layer3_expert11_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="58106,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu11 -> layer3_expert11_6	[pos="e,58193,1336.3 58291,1376 58265,1365.5 58236,1354 58203,1340.3",
		style=dashed];
	layer3_expert11_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="58298,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu11 -> layer3_expert11_7	[pos="e,58331,1340 58361,1375.9 58353,1366.8 58345,1357.1 58338,1347.8",
		style=dashed];
	layer3_expert11_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="58490,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu11 -> layer3_expert11_8	[pos="e,58457,1340 58427,1375.9 58435,1366.8 58443,1357.1 58450,1347.8",
		style=dashed];
	layer3_expert11_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="58682,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu11 -> layer3_expert11_9	[pos="e,58595,1336.3 58497,1376 58523,1365.5 58552,1354 58585,1340.3",
		style=dashed];
	layer3_expert11_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="58874,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu11 -> layer3_expert11_10	[pos="e,58787,1337.1 58516,1398.7 58590,1386.4 58685,1367.7 58777,1340.1",
		style=dashed];
	layer3_expert11_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="59066,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu11 -> layer3_expert11_11	[pos="e,58979,1337.4 58516,1409.8 58632,1401.2 58809,1382.5 58969,1340.1",
		style=dashed];
	layer3_expert11_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="59258,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu11 -> layer3_expert11_12	[pos="e,59171,1337.6 58516,1415.5 58667,1411.9 58931,1397.2 59161,1340.1",
		style=dashed];
	layer3_expert11_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="59450,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu11 -> layer3_expert11_13	[pos="e,59363,1337.7 58516,1411.6 58734,1402.2 59180,1378.9 59353,1340",
		style=dashed];
	layer3_expert11_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="59642,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu11 -> layer3_expert11_14	[pos="e,59555,1337.7 58516,1413.5 58767,1406.5 59335,1386.4 59545,1340",
		style=dashed];
	layer3_expert11_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU11
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 11",
		pos="59834,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu11 -> layer3_expert11_15	[pos="e,59747,1337.7 58516,1414.9 58798,1410.3 59488,1393.9 59737,1340",
		style=dashed];
	layer3_moe_agg_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_MoE_Aggregate_GPU11
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 11",
		pos="58490,1179.5",
		shape=rectangle,
		width=2.9444];
	layer3_expert11_0 -> layer3_moe_agg_gpu11	[pos="e,58384,1181.4 57041,1259.2 57044,1258.4 57047,1257.7 57050,1257 57301,1199.3 58077,1184.9 58374,1181.5"];
	layer3_expert11_1 -> layer3_moe_agg_gpu11	[pos="e,58384,1182.4 57233,1259.3 57236,1258.4 57239,1257.7 57242,1257 57455,1207.1 58106,1188.3 58373,1182.6"];
	layer3_expert11_2 -> layer3_moe_agg_gpu11	[pos="e,58384,1183.8 57425,1259.3 57428,1258.5 57431,1257.7 57434,1257 57610,1214.8 58137,1192.3 58374,1184.1"];
	layer3_expert11_3 -> layer3_moe_agg_gpu11	[pos="e,58384,1185.8 57617,1259.4 57620,1258.5 57623,1257.7 57626,1257 57764,1222.6 58172,1197.2 58374,1186.3"];
	layer3_expert11_4 -> layer3_moe_agg_gpu11	[pos="e,58384,1183.3 57809,1259.6 57812,1258.6 57815,1257.8 57818,1257 58009,1207.1 58238,1189.7 58373,1183.7"];
	layer3_expert11_5 -> layer3_moe_agg_gpu11	[pos="e,58384,1190 58001,1259.7 58004,1258.8 58007,1257.8 58010,1257 58132,1222.2 58275,1201.9 58374,1191.1"];
	layer3_expert11_6 -> layer3_moe_agg_gpu11	[pos="e,58384,1204.9 58193,1260.1 58196,1259 58199,1258 58202,1257 58258,1237.9 58321,1220.6 58374,1207.3"];
	layer3_expert11_7 -> layer3_moe_agg_gpu11	[pos="e,58436,1213.7 58365,1256.9 58385,1244.6 58407,1231.1 58427,1219"];
	layer3_expert11_8 -> layer3_moe_agg_gpu11	[pos="e,58490,1213.7 58490,1256.9 58490,1246.2 58490,1234.6 58490,1223.8"];
	layer3_expert11_9 -> layer3_moe_agg_gpu11	[pos="e,58544,1213.7 58615,1256.9 58595,1244.6 58573,1231.1 58553,1219"];
	layer3_expert11_10 -> layer3_moe_agg_gpu11	[pos="e,58596,1204.9 58787,1260.1 58784,1259 58781,1258 58778,1257 58722,1237.9 58659,1220.6 58606,1207.3"];
	layer3_expert11_11 -> layer3_moe_agg_gpu11	[pos="e,58596,1190 58979,1259.7 58976,1258.8 58973,1257.8 58970,1257 58848,1222.2 58705,1201.9 58606,1191.1"];
	layer3_expert11_12 -> layer3_moe_agg_gpu11	[pos="e,58596,1183.3 59171,1259.6 59168,1258.6 59165,1257.8 59162,1257 58971,1207.1 58742,1189.7 58607,1183.7"];
	layer3_expert11_13 -> layer3_moe_agg_gpu11	[pos="e,58596,1185.8 59363,1259.4 59360,1258.5 59357,1257.7 59354,1257 59216,1222.6 58808,1197.2 58606,1186.3"];
	layer3_expert11_14 -> layer3_moe_agg_gpu11	[pos="e,58596,1183.8 59555,1259.3 59552,1258.5 59549,1257.7 59546,1257 59370,1214.8 58843,1192.3 58606,1184.1"];
	layer3_expert11_15 -> layer3_moe_agg_gpu11	[pos="e,58596,1182.4 59747,1259.3 59744,1258.4 59741,1257.7 59738,1257 59525,1207.1 58874,1188.3 58607,1182.6"];
	layer3_output_gpu11	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU11
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 11",
		pos="59142,1068",
		shape=rectangle,
		width=3.5139];
	layer3_moe_agg_gpu11 -> layer3_output_gpu11	[pos="e,59015,1090.3 58596,1160.7 58708,1141.9 58883,1112.4 59005,1092"];
	layer3_output_gpu11 -> output	[pos="e,59770,946.49 59269,1042.7 59402,1017.1 59613,976.69 59760,948.42"];
	layer3_qkv_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_QKV_Projection_GPU12
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 12",
		pos="61466,1744.5",
		shape=rectangle,
		width=2.9444];
	layer3_attn_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU12
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 12",
		pos="61466,1633",
		shape=rectangle,
		width=3.5];
	layer3_qkv_gpu12 -> layer3_attn_gpu12	[pos="e,61466,1667 61466,1710.3 61466,1699.9 61466,1688.3 61466,1677.3"];
	layer3_attn_norm_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU12
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 12",
		pos="61466,1529",
		shape=rectangle,
		width=3.5139];
	layer3_attn_gpu12 -> layer3_attn_norm_gpu12	[pos="e,61466,1563.3 61466,1598.9 61466,1590.8 61466,1582 61466,1573.5"];
	layer3_gate_gpu12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU12
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 12",
		pos="61466,1417.5",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu12 -> layer3_gate_gpu12	[pos="e,61466,1459.3 61466,1494.8 61466,1486.8 61466,1478 61466,1469.3"];
	layer3_expert12_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="60026,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu12 -> layer3_expert12_0	[pos="e,60113,1337.7 61344,1414.9 61062,1410.3 60372,1393.9 60123,1340",
		style=dashed];
	layer3_expert12_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="60218,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu12 -> layer3_expert12_1	[pos="e,60305,1337.7 61344,1413.5 61093,1406.5 60525,1386.4 60315,1340",
		style=dashed];
	layer3_expert12_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="60410,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu12 -> layer3_expert12_2	[pos="e,60497,1337.7 61344,1411.6 61126,1402.2 60680,1378.9 60507,1340",
		style=dashed];
	layer3_expert12_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="60602,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu12 -> layer3_expert12_3	[pos="e,60689,1337.6 61344,1415.5 61193,1411.9 60929,1397.2 60699,1340.1",
		style=dashed];
	layer3_expert12_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="60794,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu12 -> layer3_expert12_4	[pos="e,60881,1337.4 61344,1409.8 61228,1401.2 61051,1382.5 60891,1340.1",
		style=dashed];
	layer3_expert12_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="60986,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu12 -> layer3_expert12_5	[pos="e,61073,1337.1 61344,1398.7 61270,1386.4 61175,1367.7 61083,1340.1",
		style=dashed];
	layer3_expert12_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="61178,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu12 -> layer3_expert12_6	[pos="e,61265,1336.3 61363,1376 61337,1365.5 61308,1354 61275,1340.3",
		style=dashed];
	layer3_expert12_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="61370,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu12 -> layer3_expert12_7	[pos="e,61403,1340 61433,1375.9 61425,1366.8 61417,1357.1 61410,1347.8",
		style=dashed];
	layer3_expert12_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="61562,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu12 -> layer3_expert12_8	[pos="e,61529,1340 61499,1375.9 61507,1366.8 61515,1357.1 61522,1347.8",
		style=dashed];
	layer3_expert12_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="61754,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu12 -> layer3_expert12_9	[pos="e,61667,1336.3 61569,1376 61595,1365.5 61624,1354 61657,1340.3",
		style=dashed];
	layer3_expert12_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="61946,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu12 -> layer3_expert12_10	[pos="e,61859,1337.1 61588,1398.7 61662,1386.4 61757,1367.7 61849,1340.1",
		style=dashed];
	layer3_expert12_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="62138,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu12 -> layer3_expert12_11	[pos="e,62051,1337.4 61588,1409.8 61704,1401.2 61881,1382.5 62041,1340.1",
		style=dashed];
	layer3_expert12_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="62330,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu12 -> layer3_expert12_12	[pos="e,62243,1337.6 61588,1415.5 61739,1411.9 62003,1397.2 62233,1340.1",
		style=dashed];
	layer3_expert12_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="62522,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu12 -> layer3_expert12_13	[pos="e,62435,1337.7 61588,1411.6 61806,1402.2 62252,1378.9 62425,1340",
		style=dashed];
	layer3_expert12_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="62714,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu12 -> layer3_expert12_14	[pos="e,62627,1337.7 61588,1413.5 61839,1406.5 62407,1386.4 62617,1340",
		style=dashed];
	layer3_expert12_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU12
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 12",
		pos="62906,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu12 -> layer3_expert12_15	[pos="e,62819,1337.7 61588,1414.9 61870,1410.3 62560,1393.9 62809,1340",
		style=dashed];
	layer3_moe_agg_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_MoE_Aggregate_GPU12
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 12",
		pos="61370,1179.5",
		shape=rectangle,
		width=2.9444];
	layer3_expert12_0 -> layer3_moe_agg_gpu12	[pos="e,61264,1182.4 60113,1259.3 60116,1258.4 60119,1257.7 60122,1257 60335,1207.1 60986,1188.3 61253,1182.6"];
	layer3_expert12_1 -> layer3_moe_agg_gpu12	[pos="e,61264,1183.8 60305,1259.3 60308,1258.5 60311,1257.7 60314,1257 60490,1214.8 61017,1192.3 61254,1184.1"];
	layer3_expert12_2 -> layer3_moe_agg_gpu12	[pos="e,61264,1185.8 60497,1259.4 60500,1258.5 60503,1257.7 60506,1257 60644,1222.6 61052,1197.2 61254,1186.3"];
	layer3_expert12_3 -> layer3_moe_agg_gpu12	[pos="e,61264,1183.3 60689,1259.6 60692,1258.6 60695,1257.8 60698,1257 60889,1207.1 61118,1189.7 61253,1183.7"];
	layer3_expert12_4 -> layer3_moe_agg_gpu12	[pos="e,61264,1190 60881,1259.7 60884,1258.8 60887,1257.8 60890,1257 61012,1222.2 61155,1201.9 61254,1191.1"];
	layer3_expert12_5 -> layer3_moe_agg_gpu12	[pos="e,61264,1204.9 61073,1260.1 61076,1259 61079,1258 61082,1257 61138,1237.9 61201,1220.6 61254,1207.3"];
	layer3_expert12_6 -> layer3_moe_agg_gpu12	[pos="e,61316,1213.7 61245,1256.9 61265,1244.6 61287,1231.1 61307,1219"];
	layer3_expert12_7 -> layer3_moe_agg_gpu12	[pos="e,61370,1213.7 61370,1256.9 61370,1246.2 61370,1234.6 61370,1223.8"];
	layer3_expert12_8 -> layer3_moe_agg_gpu12	[pos="e,61424,1213.7 61495,1256.9 61475,1244.6 61453,1231.1 61433,1219"];
	layer3_expert12_9 -> layer3_moe_agg_gpu12	[pos="e,61476,1204.9 61667,1260.1 61664,1259 61661,1258 61658,1257 61602,1237.9 61539,1220.6 61486,1207.3"];
	layer3_expert12_10 -> layer3_moe_agg_gpu12	[pos="e,61476,1190 61859,1259.7 61856,1258.8 61853,1257.8 61850,1257 61728,1222.2 61585,1201.9 61486,1191.1"];
	layer3_expert12_11 -> layer3_moe_agg_gpu12	[pos="e,61476,1183.3 62051,1259.6 62048,1258.6 62045,1257.8 62042,1257 61851,1207.1 61622,1189.7 61487,1183.7"];
	layer3_expert12_12 -> layer3_moe_agg_gpu12	[pos="e,61476,1185.8 62243,1259.4 62240,1258.5 62237,1257.7 62234,1257 62096,1222.6 61688,1197.2 61486,1186.3"];
	layer3_expert12_13 -> layer3_moe_agg_gpu12	[pos="e,61476,1183.8 62435,1259.3 62432,1258.5 62429,1257.7 62426,1257 62250,1214.8 61723,1192.3 61486,1184.1"];
	layer3_expert12_14 -> layer3_moe_agg_gpu12	[pos="e,61476,1182.4 62627,1259.3 62624,1258.4 62621,1257.7 62618,1257 62405,1207.1 61754,1188.3 61487,1182.6"];
	layer3_expert12_15 -> layer3_moe_agg_gpu12	[pos="e,61476,1181.4 62819,1259.2 62816,1258.4 62813,1257.7 62810,1257 62559,1199.3 61783,1184.9 61486,1181.5"];
	layer3_output_gpu12	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU12
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 12",
		pos="60717,1068",
		shape=rectangle,
		width=3.5139];
	layer3_moe_agg_gpu12 -> layer3_output_gpu12	[pos="e,60844,1090.2 61264,1160.7 61152,1142 60976,1112.4 60854,1091.9"];
	layer3_output_gpu12 -> output	[pos="e,60088,946.46 60590,1042.7 60457,1017.1 60246,976.69 60098,948.39"];
	layer3_qkv_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_QKV_Projection_GPU13
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 13",
		pos="64538,1744.5",
		shape=rectangle,
		width=2.9444];
	layer3_attn_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU13
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 13",
		pos="64538,1633",
		shape=rectangle,
		width=3.5];
	layer3_qkv_gpu13 -> layer3_attn_gpu13	[pos="e,64538,1667 64538,1710.3 64538,1699.9 64538,1688.3 64538,1677.3"];
	layer3_attn_norm_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU13
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 13",
		pos="64538,1529",
		shape=rectangle,
		width=3.5139];
	layer3_attn_gpu13 -> layer3_attn_norm_gpu13	[pos="e,64538,1563.3 64538,1598.9 64538,1590.8 64538,1582 64538,1573.5"];
	layer3_gate_gpu13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU13
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 13",
		pos="64538,1417.5",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu13 -> layer3_gate_gpu13	[pos="e,64538,1459.3 64538,1494.8 64538,1486.8 64538,1478 64538,1469.3"];
	layer3_expert13_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="63098,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu13 -> layer3_expert13_0	[pos="e,63185,1337.7 64416,1414.9 64134,1410.3 63444,1393.9 63195,1340",
		style=dashed];
	layer3_expert13_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="63290,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu13 -> layer3_expert13_1	[pos="e,63377,1337.7 64416,1413.5 64165,1406.5 63597,1386.4 63387,1340",
		style=dashed];
	layer3_expert13_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="63482,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu13 -> layer3_expert13_2	[pos="e,63569,1337.7 64416,1411.6 64198,1402.2 63752,1378.9 63579,1340",
		style=dashed];
	layer3_expert13_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="63674,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu13 -> layer3_expert13_3	[pos="e,63761,1337.6 64416,1415.5 64265,1411.9 64001,1397.2 63771,1340.1",
		style=dashed];
	layer3_expert13_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="63866,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu13 -> layer3_expert13_4	[pos="e,63953,1337.4 64416,1409.8 64300,1401.2 64123,1382.5 63963,1340.1",
		style=dashed];
	layer3_expert13_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="64058,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu13 -> layer3_expert13_5	[pos="e,64145,1337.1 64416,1398.7 64342,1386.4 64247,1367.7 64155,1340.1",
		style=dashed];
	layer3_expert13_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="64250,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu13 -> layer3_expert13_6	[pos="e,64337,1336.3 64435,1376 64409,1365.5 64380,1354 64347,1340.3",
		style=dashed];
	layer3_expert13_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="64442,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu13 -> layer3_expert13_7	[pos="e,64475,1340 64505,1375.9 64497,1366.8 64489,1357.1 64482,1347.8",
		style=dashed];
	layer3_expert13_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="64634,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu13 -> layer3_expert13_8	[pos="e,64601,1340 64571,1375.9 64579,1366.8 64587,1357.1 64594,1347.8",
		style=dashed];
	layer3_expert13_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="64826,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu13 -> layer3_expert13_9	[pos="e,64739,1336.3 64641,1376 64667,1365.5 64696,1354 64729,1340.3",
		style=dashed];
	layer3_expert13_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="65018,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu13 -> layer3_expert13_10	[pos="e,64931,1337.1 64660,1398.7 64734,1386.4 64829,1367.7 64921,1340.1",
		style=dashed];
	layer3_expert13_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="65210,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu13 -> layer3_expert13_11	[pos="e,65123,1337.4 64660,1409.8 64776,1401.2 64953,1382.5 65113,1340.1",
		style=dashed];
	layer3_expert13_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="65402,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu13 -> layer3_expert13_12	[pos="e,65315,1337.6 64660,1415.5 64811,1411.9 65075,1397.2 65305,1340.1",
		style=dashed];
	layer3_expert13_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="65594,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu13 -> layer3_expert13_13	[pos="e,65507,1337.7 64660,1411.6 64878,1402.2 65324,1378.9 65497,1340",
		style=dashed];
	layer3_expert13_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="65786,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu13 -> layer3_expert13_14	[pos="e,65699,1337.7 64660,1413.5 64911,1406.5 65479,1386.4 65689,1340",
		style=dashed];
	layer3_expert13_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU13
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 13",
		pos="65978,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu13 -> layer3_expert13_15	[pos="e,65891,1337.7 64660,1414.9 64942,1410.3 65632,1393.9 65881,1340",
		style=dashed];
	layer3_moe_agg_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_MoE_Aggregate_GPU13
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 13",
		pos="64442,1179.5",
		shape=rectangle,
		width=2.9444];
	layer3_expert13_0 -> layer3_moe_agg_gpu13	[pos="e,64336,1182.4 63185,1259.3 63188,1258.4 63191,1257.7 63194,1257 63407,1207.1 64058,1188.3 64325,1182.6"];
	layer3_expert13_1 -> layer3_moe_agg_gpu13	[pos="e,64336,1183.8 63377,1259.3 63380,1258.5 63383,1257.7 63386,1257 63562,1214.8 64089,1192.3 64326,1184.1"];
	layer3_expert13_2 -> layer3_moe_agg_gpu13	[pos="e,64336,1185.8 63569,1259.4 63572,1258.5 63575,1257.7 63578,1257 63716,1222.6 64124,1197.2 64326,1186.3"];
	layer3_expert13_3 -> layer3_moe_agg_gpu13	[pos="e,64336,1183.3 63761,1259.6 63764,1258.6 63767,1257.8 63770,1257 63961,1207.1 64190,1189.7 64325,1183.7"];
	layer3_expert13_4 -> layer3_moe_agg_gpu13	[pos="e,64336,1190 63953,1259.7 63956,1258.8 63959,1257.8 63962,1257 64084,1222.2 64227,1201.9 64326,1191.1"];
	layer3_expert13_5 -> layer3_moe_agg_gpu13	[pos="e,64336,1204.9 64145,1260.1 64148,1259 64151,1258 64154,1257 64210,1237.9 64273,1220.6 64326,1207.3"];
	layer3_expert13_6 -> layer3_moe_agg_gpu13	[pos="e,64388,1213.7 64317,1256.9 64337,1244.6 64359,1231.1 64379,1219"];
	layer3_expert13_7 -> layer3_moe_agg_gpu13	[pos="e,64442,1213.7 64442,1256.9 64442,1246.2 64442,1234.6 64442,1223.8"];
	layer3_expert13_8 -> layer3_moe_agg_gpu13	[pos="e,64496,1213.7 64567,1256.9 64547,1244.6 64525,1231.1 64505,1219"];
	layer3_expert13_9 -> layer3_moe_agg_gpu13	[pos="e,64548,1204.9 64739,1260.1 64736,1259 64733,1258 64730,1257 64674,1237.9 64611,1220.6 64558,1207.3"];
	layer3_expert13_10 -> layer3_moe_agg_gpu13	[pos="e,64548,1190 64931,1259.7 64928,1258.8 64925,1257.8 64922,1257 64800,1222.2 64657,1201.9 64558,1191.1"];
	layer3_expert13_11 -> layer3_moe_agg_gpu13	[pos="e,64548,1183.3 65123,1259.6 65120,1258.6 65117,1257.8 65114,1257 64923,1207.1 64694,1189.7 64559,1183.7"];
	layer3_expert13_12 -> layer3_moe_agg_gpu13	[pos="e,64548,1185.8 65315,1259.4 65312,1258.5 65309,1257.7 65306,1257 65168,1222.6 64760,1197.2 64558,1186.3"];
	layer3_expert13_13 -> layer3_moe_agg_gpu13	[pos="e,64548,1183.8 65507,1259.3 65504,1258.5 65501,1257.7 65498,1257 65322,1214.8 64795,1192.3 64558,1184.1"];
	layer3_expert13_14 -> layer3_moe_agg_gpu13	[pos="e,64548,1182.4 65699,1259.3 65696,1258.4 65693,1257.7 65690,1257 65477,1207.1 64826,1188.3 64559,1182.6"];
	layer3_expert13_15 -> layer3_moe_agg_gpu13	[pos="e,64548,1181.4 65891,1259.2 65888,1258.4 65885,1257.7 65882,1257 65631,1199.3 64855,1184.9 64558,1181.5"];
	layer3_output_gpu13	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU13
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 13",
		pos="63041,1068",
		shape=rectangle,
		width=3.5139];
	layer3_moe_agg_gpu13 -> layer3_output_gpu13	[pos="e,63168,1078.9 64336,1170.2 64085,1150.6 63457,1101.5 63178,1079.7"];
	layer3_output_gpu13 -> output	[pos="e,60200,929.14 62914,1060.8 62453,1038.5 60861,961.21 60210,929.62"];
	layer3_qkv_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_QKV_Projection_GPU14
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 14",
		pos="67610,1744.5",
		shape=rectangle,
		width=2.9444];
	layer3_attn_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU14
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 14",
		pos="67610,1633",
		shape=rectangle,
		width=3.5];
	layer3_qkv_gpu14 -> layer3_attn_gpu14	[pos="e,67610,1667 67610,1710.3 67610,1699.9 67610,1688.3 67610,1677.3"];
	layer3_attn_norm_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU14
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 14",
		pos="67610,1529",
		shape=rectangle,
		width=3.5139];
	layer3_attn_gpu14 -> layer3_attn_norm_gpu14	[pos="e,67610,1563.3 67610,1598.9 67610,1590.8 67610,1582 67610,1573.5"];
	layer3_gate_gpu14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU14
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 14",
		pos="67610,1417.5",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu14 -> layer3_gate_gpu14	[pos="e,67610,1459.3 67610,1494.8 67610,1486.8 67610,1478 67610,1469.3"];
	layer3_expert14_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="66170,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu14 -> layer3_expert14_0	[pos="e,66257,1337.7 67488,1414.9 67206,1410.3 66516,1393.9 66267,1340",
		style=dashed];
	layer3_expert14_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="66362,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu14 -> layer3_expert14_1	[pos="e,66449,1337.7 67488,1413.5 67237,1406.5 66669,1386.4 66459,1340",
		style=dashed];
	layer3_expert14_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="66554,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu14 -> layer3_expert14_2	[pos="e,66641,1337.7 67488,1411.6 67270,1402.2 66824,1378.9 66651,1340",
		style=dashed];
	layer3_expert14_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="66746,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu14 -> layer3_expert14_3	[pos="e,66833,1337.6 67488,1415.5 67337,1411.9 67073,1397.2 66843,1340.1",
		style=dashed];
	layer3_expert14_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="66938,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu14 -> layer3_expert14_4	[pos="e,67025,1337.4 67488,1409.8 67372,1401.2 67195,1382.5 67035,1340.1",
		style=dashed];
	layer3_expert14_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="67130,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu14 -> layer3_expert14_5	[pos="e,67217,1337.1 67488,1398.7 67414,1386.4 67319,1367.7 67227,1340.1",
		style=dashed];
	layer3_expert14_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="67322,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu14 -> layer3_expert14_6	[pos="e,67409,1336.3 67507,1376 67481,1365.5 67452,1354 67419,1340.3",
		style=dashed];
	layer3_expert14_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="67514,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu14 -> layer3_expert14_7	[pos="e,67547,1340 67577,1375.9 67569,1366.8 67561,1357.1 67554,1347.8",
		style=dashed];
	layer3_expert14_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="67706,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu14 -> layer3_expert14_8	[pos="e,67673,1340 67643,1375.9 67651,1366.8 67659,1357.1 67666,1347.8",
		style=dashed];
	layer3_expert14_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="67898,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu14 -> layer3_expert14_9	[pos="e,67811,1336.3 67713,1376 67739,1365.5 67768,1354 67801,1340.3",
		style=dashed];
	layer3_expert14_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="68090,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu14 -> layer3_expert14_10	[pos="e,68003,1337.1 67732,1398.7 67806,1386.4 67901,1367.7 67993,1340.1",
		style=dashed];
	layer3_expert14_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="68282,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu14 -> layer3_expert14_11	[pos="e,68195,1337.4 67732,1409.8 67848,1401.2 68025,1382.5 68185,1340.1",
		style=dashed];
	layer3_expert14_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="68474,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu14 -> layer3_expert14_12	[pos="e,68387,1337.6 67732,1415.5 67883,1411.9 68147,1397.2 68377,1340.1",
		style=dashed];
	layer3_expert14_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="68666,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu14 -> layer3_expert14_13	[pos="e,68579,1337.7 67732,1411.6 67950,1402.2 68396,1378.9 68569,1340",
		style=dashed];
	layer3_expert14_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="68858,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu14 -> layer3_expert14_14	[pos="e,68771,1337.7 67732,1413.5 67983,1406.5 68551,1386.4 68761,1340",
		style=dashed];
	layer3_expert14_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU14
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 14",
		pos="69050,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu14 -> layer3_expert14_15	[pos="e,68963,1337.7 67732,1414.9 68014,1410.3 68704,1393.9 68953,1340",
		style=dashed];
	layer3_moe_agg_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_MoE_Aggregate_GPU14
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 14",
		pos="67514,1179.5",
		shape=rectangle,
		width=2.9444];
	layer3_expert14_0 -> layer3_moe_agg_gpu14	[pos="e,67408,1182.4 66257,1259.3 66260,1258.4 66263,1257.7 66266,1257 66479,1207.1 67130,1188.3 67397,1182.6"];
	layer3_expert14_1 -> layer3_moe_agg_gpu14	[pos="e,67408,1183.8 66449,1259.3 66452,1258.5 66455,1257.7 66458,1257 66634,1214.8 67161,1192.3 67398,1184.1"];
	layer3_expert14_2 -> layer3_moe_agg_gpu14	[pos="e,67408,1185.8 66641,1259.4 66644,1258.5 66647,1257.7 66650,1257 66788,1222.6 67196,1197.2 67398,1186.3"];
	layer3_expert14_3 -> layer3_moe_agg_gpu14	[pos="e,67408,1183.3 66833,1259.6 66836,1258.6 66839,1257.8 66842,1257 67033,1207.1 67262,1189.7 67397,1183.7"];
	layer3_expert14_4 -> layer3_moe_agg_gpu14	[pos="e,67408,1190 67025,1259.7 67028,1258.8 67031,1257.8 67034,1257 67156,1222.2 67299,1201.9 67398,1191.1"];
	layer3_expert14_5 -> layer3_moe_agg_gpu14	[pos="e,67408,1204.9 67217,1260.1 67220,1259 67223,1258 67226,1257 67282,1237.9 67345,1220.6 67398,1207.3"];
	layer3_expert14_6 -> layer3_moe_agg_gpu14	[pos="e,67460,1213.7 67389,1256.9 67409,1244.6 67431,1231.1 67451,1219"];
	layer3_expert14_7 -> layer3_moe_agg_gpu14	[pos="e,67514,1213.7 67514,1256.9 67514,1246.2 67514,1234.6 67514,1223.8"];
	layer3_expert14_8 -> layer3_moe_agg_gpu14	[pos="e,67568,1213.7 67639,1256.9 67619,1244.6 67597,1231.1 67577,1219"];
	layer3_expert14_9 -> layer3_moe_agg_gpu14	[pos="e,67620,1204.9 67811,1260.1 67808,1259 67805,1258 67802,1257 67746,1237.9 67683,1220.6 67630,1207.3"];
	layer3_expert14_10 -> layer3_moe_agg_gpu14	[pos="e,67620,1190 68003,1259.7 68000,1258.8 67997,1257.8 67994,1257 67872,1222.2 67729,1201.9 67630,1191.1"];
	layer3_expert14_11 -> layer3_moe_agg_gpu14	[pos="e,67620,1183.3 68195,1259.6 68192,1258.6 68189,1257.8 68186,1257 67995,1207.1 67766,1189.7 67631,1183.7"];
	layer3_expert14_12 -> layer3_moe_agg_gpu14	[pos="e,67620,1185.8 68387,1259.4 68384,1258.5 68381,1257.7 68378,1257 68240,1222.6 67832,1197.2 67630,1186.3"];
	layer3_expert14_13 -> layer3_moe_agg_gpu14	[pos="e,67620,1183.8 68579,1259.3 68576,1258.5 68573,1257.7 68570,1257 68394,1214.8 67867,1192.3 67630,1184.1"];
	layer3_expert14_14 -> layer3_moe_agg_gpu14	[pos="e,67620,1182.4 68771,1259.3 68768,1258.4 68765,1257.7 68762,1257 68549,1207.1 67898,1188.3 67631,1182.6"];
	layer3_expert14_15 -> layer3_moe_agg_gpu14	[pos="e,67620,1181.4 68963,1259.2 68960,1258.4 68957,1257.7 68954,1257 68703,1199.3 67927,1184.9 67630,1181.5"];
	layer3_output_gpu14	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU14
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 14",
		pos="65739,1068",
		shape=rectangle,
		width=3.5139];
	layer3_moe_agg_gpu14 -> layer3_output_gpu14	[pos="e,65866,1076.8 67408,1172 67102,1153.1 66217,1098.5 65876,1077.4"];
	layer3_output_gpu14 -> output	[pos="e,60214,923.4 65612,1063.7 64890,1044.9 61286,951.26 60224,923.66"];
	layer3_qkv_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_QKV_Projection_GPU15
Input: [1024,2048,4096]
Output: [1024,2048,12288]
GPU: 15",
		pos="70682,1744.5",
		shape=rectangle,
		width=2.9444];
	layer3_attn_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU15
Input: [1024,2048,12288]
Output: [1024,2048,4096]
GPU: 15",
		pos="70682,1633",
		shape=rectangle,
		width=3.5];
	layer3_qkv_gpu15 -> layer3_attn_gpu15	[pos="e,70682,1667 70682,1710.3 70682,1699.9 70682,1688.3 70682,1677.3"];
	layer3_attn_norm_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU15
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 15",
		pos="70682,1529",
		shape=rectangle,
		width=3.5139];
	layer3_attn_gpu15 -> layer3_attn_norm_gpu15	[pos="e,70682,1563.3 70682,1598.9 70682,1590.8 70682,1582 70682,1573.5"];
	layer3_gate_gpu15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU15
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
Top-2 routing
GPU: 15",
		pos="70682,1417.5",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu15 -> layer3_gate_gpu15	[pos="e,70682,1459.3 70682,1494.8 70682,1486.8 70682,1478 70682,1469.3"];
	layer3_expert15_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="69242,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu15 -> layer3_expert15_0	[pos="e,69329,1337.7 70560,1414.9 70278,1410.3 69588,1393.9 69339,1340",
		style=dashed];
	layer3_expert15_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="69434,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu15 -> layer3_expert15_1	[pos="e,69521,1337.7 70560,1413.5 70309,1406.5 69741,1386.4 69531,1340",
		style=dashed];
	layer3_expert15_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="69626,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu15 -> layer3_expert15_2	[pos="e,69713,1337.7 70560,1411.6 70342,1402.2 69896,1378.9 69723,1340",
		style=dashed];
	layer3_expert15_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="69818,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu15 -> layer3_expert15_3	[pos="e,69905,1337.6 70560,1415.5 70409,1411.9 70145,1397.2 69915,1340.1",
		style=dashed];
	layer3_expert15_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="70010,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu15 -> layer3_expert15_4	[pos="e,70097,1337.4 70560,1409.8 70444,1401.2 70267,1382.5 70107,1340.1",
		style=dashed];
	layer3_expert15_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="70202,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu15 -> layer3_expert15_5	[pos="e,70289,1337.1 70560,1398.7 70486,1386.4 70391,1367.7 70299,1340.1",
		style=dashed];
	layer3_expert15_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="70394,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu15 -> layer3_expert15_6	[pos="e,70481,1336.3 70579,1376 70553,1365.5 70524,1354 70491,1340.3",
		style=dashed];
	layer3_expert15_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="70586,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu15 -> layer3_expert15_7	[pos="e,70619,1340 70649,1375.9 70641,1366.8 70633,1357.1 70626,1347.8",
		style=dashed];
	layer3_expert15_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="70778,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu15 -> layer3_expert15_8	[pos="e,70745,1340 70715,1375.9 70723,1366.8 70731,1357.1 70738,1347.8",
		style=dashed];
	layer3_expert15_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="70970,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu15 -> layer3_expert15_9	[pos="e,70883,1336.3 70785,1376 70811,1365.5 70840,1354 70873,1340.3",
		style=dashed];
	layer3_expert15_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="71162,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu15 -> layer3_expert15_10	[pos="e,71075,1337.1 70804,1398.7 70878,1386.4 70973,1367.7 71065,1340.1",
		style=dashed];
	layer3_expert15_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="71354,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu15 -> layer3_expert15_11	[pos="e,71267,1337.4 70804,1409.8 70920,1401.2 71097,1382.5 71257,1340.1",
		style=dashed];
	layer3_expert15_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="71546,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu15 -> layer3_expert15_12	[pos="e,71459,1337.6 70804,1415.5 70955,1411.9 71219,1397.2 71449,1340.1",
		style=dashed];
	layer3_expert15_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="71738,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu15 -> layer3_expert15_13	[pos="e,71651,1337.7 70804,1411.6 71022,1402.2 71468,1378.9 71641,1340",
		style=dashed];
	layer3_expert15_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="71930,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu15 -> layer3_expert15_14	[pos="e,71843,1337.7 70804,1413.5 71055,1406.5 71623,1386.4 71833,1340",
		style=dashed];
	layer3_expert15_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU15
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 15",
		pos="72122,1298.5",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu15 -> layer3_expert15_15	[pos="e,72035,1337.7 70804,1414.9 71086,1410.3 71776,1393.9 72025,1340",
		style=dashed];
	layer3_moe_agg_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_MoE_Aggregate_GPU15
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 15",
		pos="70586,1179.5",
		shape=rectangle,
		width=2.9444];
	layer3_expert15_0 -> layer3_moe_agg_gpu15	[pos="e,70480,1182.4 69329,1259.3 69332,1258.4 69335,1257.7 69338,1257 69551,1207.1 70202,1188.3 70469,1182.6"];
	layer3_expert15_1 -> layer3_moe_agg_gpu15	[pos="e,70480,1183.8 69521,1259.3 69524,1258.5 69527,1257.7 69530,1257 69706,1214.8 70233,1192.3 70470,1184.1"];
	layer3_expert15_2 -> layer3_moe_agg_gpu15	[pos="e,70480,1185.8 69713,1259.4 69716,1258.5 69719,1257.7 69722,1257 69860,1222.6 70268,1197.2 70470,1186.3"];
	layer3_expert15_3 -> layer3_moe_agg_gpu15	[pos="e,70480,1183.3 69905,1259.6 69908,1258.6 69911,1257.8 69914,1257 70105,1207.1 70334,1189.7 70469,1183.7"];
	layer3_expert15_4 -> layer3_moe_agg_gpu15	[pos="e,70480,1190 70097,1259.7 70100,1258.8 70103,1257.8 70106,1257 70228,1222.2 70371,1201.9 70470,1191.1"];
	layer3_expert15_5 -> layer3_moe_agg_gpu15	[pos="e,70480,1204.9 70289,1260.1 70292,1259 70295,1258 70298,1257 70354,1237.9 70417,1220.6 70470,1207.3"];
	layer3_expert15_6 -> layer3_moe_agg_gpu15	[pos="e,70532,1213.7 70461,1256.9 70481,1244.6 70503,1231.1 70523,1219"];
	layer3_expert15_7 -> layer3_moe_agg_gpu15	[pos="e,70586,1213.7 70586,1256.9 70586,1246.2 70586,1234.6 70586,1223.8"];
	layer3_expert15_8 -> layer3_moe_agg_gpu15	[pos="e,70640,1213.7 70711,1256.9 70691,1244.6 70669,1231.1 70649,1219"];
	layer3_expert15_9 -> layer3_moe_agg_gpu15	[pos="e,70692,1204.9 70883,1260.1 70880,1259 70877,1258 70874,1257 70818,1237.9 70755,1220.6 70702,1207.3"];
	layer3_expert15_10 -> layer3_moe_agg_gpu15	[pos="e,70692,1190 71075,1259.7 71072,1258.8 71069,1257.8 71066,1257 70944,1222.2 70801,1201.9 70702,1191.1"];
	layer3_expert15_11 -> layer3_moe_agg_gpu15	[pos="e,70692,1183.3 71267,1259.6 71264,1258.6 71261,1257.8 71258,1257 71067,1207.1 70838,1189.7 70703,1183.7"];
	layer3_expert15_12 -> layer3_moe_agg_gpu15	[pos="e,70692,1185.8 71459,1259.4 71456,1258.5 71453,1257.7 71450,1257 71312,1222.6 70904,1197.2 70702,1186.3"];
	layer3_expert15_13 -> layer3_moe_agg_gpu15	[pos="e,70692,1183.8 71651,1259.3 71648,1258.5 71645,1257.7 71642,1257 71466,1214.8 70939,1192.3 70702,1184.1"];
	layer3_expert15_14 -> layer3_moe_agg_gpu15	[pos="e,70692,1182.4 71843,1259.3 71840,1258.4 71837,1257.7 71834,1257 71621,1207.1 70970,1188.3 70703,1182.6"];
	layer3_expert15_15 -> layer3_moe_agg_gpu15	[pos="e,70692,1181.4 72035,1259.2 72032,1258.4 72029,1257.7 72026,1257 71775,1199.3 70999,1184.9 70702,1181.5"];
	layer3_output_gpu15	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU15
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 15",
		pos="68624,1068",
		shape=rectangle,
		width=3.5139];
	layer3_moe_agg_gpu15 -> layer3_output_gpu15	[pos="e,68751,1076.1 70480,1172.6 70148,1154.1 69132,1097.3 68761,1076.6"];
	layer3_output_gpu15 -> output	[pos="e,60217,921.01 68497,1064.8 67555,1048.4 61633,945.59 60228,921.19"];
	pipeline_stage0_1 -> layer2_qkv_gpu8	[pos="e,31327,791.91 34915,913.5 34270,910.91 32052,894.84 31351,796 31346,795.36 31342,794.63 31337,793.81"];
	pipeline_stage0_1 -> layer2_qkv_gpu9	[pos="e,31572,767.43 34911,906.46 34269,879.71 32109,789.78 31583,767.85"];
	pipeline_stage0_1 -> layer2_qkv_gpu10	[pos="e,33494,772.4 34906,897.52 34553,866.22 33794,799 33504,773.29"];
	pipeline_stage0_1 -> layer2_qkv_gpu11	[pos="e,34995,796.26 35024,831.87 35016,822.23 35008,812.74 35001,804.03"];
	pipeline_stage0_1 -> layer2_qkv_gpu12	[pos="e,35189,796.26 35160,831.87 35168,822.23 35176,812.74 35183,804.03"];
	pipeline_stage0_1 -> layer2_qkv_gpu13	[pos="e,35393,796.06 35237,857.13 35286,837.93 35339,817.02 35383,799.79"];
	pipeline_stage0_1 -> layer2_qkv_gpu14	[pos="e,35636,787.64 35248,877.74 35364,850.73 35521,814.44 35626,789.97"];
	pipeline_stage0_1 -> layer2_qkv_gpu15	[pos="e,35903,786.9 35256,891.66 35411,869.8 35651,834.3 35857,796 35869,793.85 35881,791.46 35893,788.99"];
}
