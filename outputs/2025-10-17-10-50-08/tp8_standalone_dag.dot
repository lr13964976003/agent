digraph TP8_Standalone {
	graph [bb="0,0,24588,5203.9",
		fontsize=20,
		label="Standalone Tensor Parallelism 8
8 GPUs total
Model Parallel across all layers",
		lheight=0.92,
		lp="12294,37",
		lwidth=4.58,
		rankdir=TB,
		size="25,20"
	];
	node [fillcolor=lightcoral,
		label="\N",
		shape=diamond,
		style=filled
	];
	input	[fillcolor=lightblue,
		height=1.041,
		label="INPUT
Input: [batch_size=1024, seq_len=2048, hidden=4096]
GPU: 0-7",
		pos="12298,5166.4",
		shape=ellipse,
		width=8.1121];
	layer0_qkv_gpu0	[fillcolor=lightgreen,
		height=1.3611,
		label="L0_QKV_Projection_GPU0
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 0-3
TP Slice: 0
GPU: 0",
		pos="11423,5044",
		shape=rectangle,
		width=2.7778];
	input -> layer0_qkv_gpu0	[pos="e,11523,5075.9 12039,5149.1 11906,5138.1 11741,5120.4 11596,5093 11576,5089.1 11554,5084 11533,5078.5"];
	layer0_qkv_gpu1	[fillcolor=lightgreen,
		height=1.3611,
		label="L0_QKV_Projection_GPU1
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 4-7
TP Slice: 1
GPU: 1",
		pos="11705,5044",
		shape=rectangle,
		width=2.7778];
	input -> layer0_qkv_gpu1	[pos="e,11805,5081.4 12092,5139.9 12014,5128.3 11925,5112.7 11846,5093 11836,5090.4 11825,5087.5 11815,5084.3"];
	layer0_qkv_gpu2	[fillcolor=lightgreen,
		height=1.3611,
		label="L0_QKV_Projection_GPU2
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 8-11
TP Slice: 2
GPU: 2",
		pos="11955,5044",
		shape=rectangle,
		width=2.7778];
	input -> layer0_qkv_gpu2	[pos="e,12055,5083.9 12193,5131.5 12157,5119.6 12117,5106 12080,5093 12075,5091.1 12070,5089.3 12065,5087.4"];
	layer0_qkv_gpu3	[fillcolor=lightgreen,
		height=1.3611,
		label="L0_QKV_Projection_GPU3
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 12-15
TP Slice: 3
GPU: 3",
		pos="12189,5044",
		shape=rectangle,
		width=2.7778];
	input -> layer0_qkv_gpu3	[pos="e,12233,5093.3 12265,5129 12257,5120.1 12248,5110.4 12240,5100.9"];
	layer0_qkv_gpu4	[fillcolor=lightgreen,
		height=1.3611,
		label="L0_QKV_Projection_GPU4
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 16-19
TP Slice: 4
GPU: 4",
		pos="12428,5044",
		shape=rectangle,
		width=2.7778];
	input -> layer0_qkv_gpu4	[pos="e,12376,5093.1 12337,5129.3 12347,5120 12358,5109.9 12369,5100"];
	layer0_qkv_gpu5	[fillcolor=lightgreen,
		height=1.3611,
		label="L0_QKV_Projection_GPU5
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 20-23
TP Slice: 5
GPU: 5",
		pos="12678,5044",
		shape=rectangle,
		width=2.7778];
	input -> layer0_qkv_gpu5	[pos="e,12578,5079.6 12412,5131.8 12451,5119.8 12496,5106.1 12537,5093 12547,5089.7 12558,5086.3 12568,5082.8"];
	layer0_qkv_gpu6	[fillcolor=lightgreen,
		height=1.3611,
		label="L0_QKV_Projection_GPU6
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 24-27
TP Slice: 6
GPU: 6",
		pos="12934,5044",
		shape=rectangle,
		width=2.7778];
	input -> layer0_qkv_gpu6	[pos="e,12834,5080.1 12515,5141.3 12600,5129.7 12699,5113.7 12787,5093 12799,5090.1 12812,5086.7 12824,5083.1"];
	layer0_qkv_gpu7	[fillcolor=lightgreen,
		height=1.3611,
		label="L0_QKV_Projection_GPU7
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 28-31
TP Slice: 7
GPU: 7",
		pos="13192,5044",
		shape=rectangle,
		width=2.7778];
	input -> layer0_qkv_gpu7	[pos="e,13092,5080.5 12571,5153 12713,5142.9 12888,5125 13043,5093 13056,5090.3 13069,5087 13082,5083.3"];
	layer0_attn_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Multi-Head_Attention_GPU0
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 0",
		pos="11395,4925",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu0 -> layer0_attn_gpu0	[pos="e,11403,4959.1 11411,4994.7 11409,4986.2 11407,4977.4 11405,4969"];
	layer0_attn_proj_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Attn_Projection_GPU0
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 0",
		pos="11423,4821",
		shape=rectangle,
		width=2.7778];
	layer0_attn_gpu0 -> layer0_attn_proj_gpu0	[pos="e,11414,4855.3 11404,4890.8 11406,4882.6 11409,4873.7 11411,4865.1"];
	layer0_attn_allreduce	[height=1.8889,
		label="L0_Attention_All-Reduce
Input: 8×[1024,2048,512]
Output: [1024,2048,4096]
TP All-Reduce across GPUs 0-7",
		pos="12308,4683",
		width=6.5833];
	layer0_attn_proj_gpu0 -> layer0_attn_allreduce	[pos="e,12148,4705 11523,4800.1 11547,4795.6 11572,4790.9 11596,4787 11781,4756 11993,4726 12138,4706.4"];
	layer0_attn_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Multi-Head_Attention_GPU1
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 1",
		pos="11656,4925",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu1 -> layer0_attn_gpu1	[pos="e,11670,4959.1 11685,4994.7 11681,4986 11677,4977 11674,4968.5"];
	layer0_attn_proj_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Attn_Projection_GPU1
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 1",
		pos="11705,4821",
		shape=rectangle,
		width=2.7778];
	layer0_attn_gpu1 -> layer0_attn_proj_gpu1	[pos="e,11689,4855.3 11672,4890.8 11676,4882.4 11680,4873.2 11685,4864.3"];
	layer0_attn_proj_gpu1 -> layer0_attn_allreduce	[pos="e,12176,4713.1 11805,4796.4 11819,4793.2 11833,4790 11846,4787 11953,4762.5 12074,4735.5 12166,4715.2"];
	layer0_attn_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Multi-Head_Attention_GPU2
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 2",
		pos="11917,4925",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu2 -> layer0_attn_gpu2	[pos="e,11928,4959.1 11939,4994.7 11937,4986.1 11934,4977.2 11931,4968.8"];
	layer0_attn_proj_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Attn_Projection_GPU2
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 2",
		pos="11955,4821",
		shape=rectangle,
		width=2.7778];
	layer0_attn_gpu2 -> layer0_attn_proj_gpu2	[pos="e,11943,4855.3 11929,4890.8 11932,4882.6 11936,4873.5 11939,4864.9"];
	layer0_attn_proj_gpu2 -> layer0_attn_allreduce	[pos="e,12208,4722.4 12041,4786.9 12088,4768.5 12148,4745.6 12199,4726"];
	layer0_attn_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Multi-Head_Attention_GPU3
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 3",
		pos="12178,4925",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu3 -> layer0_attn_gpu3	[pos="e,12181,4959.1 12184,4994.7 12184,4986.3 12183,4977.6 12182,4969.3"];
	layer0_attn_proj_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Attn_Projection_GPU3
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 3",
		pos="12189,4821",
		shape=rectangle,
		width=2.7778];
	layer0_attn_gpu3 -> layer0_attn_proj_gpu3	[pos="e,12185,4855.3 12182,4890.8 12182,4882.7 12183,4873.9 12184,4865.4"];
	layer0_attn_proj_gpu3 -> layer0_attn_allreduce	[pos="e,12261,4737.5 12218,4786.7 12229,4774.2 12242,4759.6 12254,4745.4"];
	layer0_attn_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Multi-Head_Attention_GPU4
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 4",
		pos="12439,4925",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu4 -> layer0_attn_gpu4	[pos="e,12436,4959.1 12433,4994.7 12433,4986.3 12434,4977.6 12435,4969.3"];
	layer0_attn_proj_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Attn_Projection_GPU4
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 4",
		pos="12428,4821",
		shape=rectangle,
		width=2.7778];
	layer0_attn_gpu4 -> layer0_attn_proj_gpu4	[pos="e,12432,4855.3 12435,4890.8 12435,4882.7 12434,4873.9 12433,4865.4"];
	layer0_attn_proj_gpu4 -> layer0_attn_allreduce	[pos="e,12355,4737.5 12399,4786.7 12388,4774.2 12375,4759.6 12362,4745.4"];
	layer0_attn_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Multi-Head_Attention_GPU5
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 5",
		pos="12700,4925",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu5 -> layer0_attn_gpu5	[pos="e,12694,4959.1 12687,4994.7 12689,4986.2 12690,4977.4 12692,4969"];
	layer0_attn_proj_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Attn_Projection_GPU5
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 5",
		pos="12678,4821",
		shape=rectangle,
		width=2.7778];
	layer0_attn_gpu5 -> layer0_attn_proj_gpu5	[pos="e,12685,4855.3 12693,4890.8 12691,4882.6 12689,4873.7 12687,4865.1"];
	layer0_attn_proj_gpu5 -> layer0_attn_allreduce	[pos="e,12411,4721.7 12588,4786.9 12537,4768.3 12474,4744.9 12420,4725.2"];
	layer0_attn_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Multi-Head_Attention_GPU6
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 6",
		pos="12961,4925",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu6 -> layer0_attn_gpu6	[pos="e,12953,4959.1 12945,4994.7 12947,4986.2 12949,4977.4 12951,4969"];
	layer0_attn_proj_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Attn_Projection_GPU6
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 6",
		pos="12934,4821",
		shape=rectangle,
		width=2.7778];
	layer0_attn_gpu6 -> layer0_attn_proj_gpu6	[pos="e,12943,4855.3 12952,4890.8 12950,4882.6 12948,4873.7 12945,4865.1"];
	layer0_attn_proj_gpu6 -> layer0_attn_allreduce	[pos="e,12442,4712.5 12834,4797.4 12818,4793.9 12802,4790.3 12787,4787 12675,4762.3 12547,4734.9 12452,4714.6"];
	layer0_attn_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Multi-Head_Attention_GPU7
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 7",
		pos="13222,4925",
		shape=rectangle,
		width=3.375];
	layer0_qkv_gpu7 -> layer0_attn_gpu7	[pos="e,13213,4959.1 13204,4994.7 13207,4986.2 13209,4977.4 13211,4969"];
	layer0_attn_proj_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Attn_Projection_GPU7
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 7",
		pos="13192,4821",
		shape=rectangle,
		width=2.7778];
	layer0_attn_gpu7 -> layer0_attn_proj_gpu7	[pos="e,13202,4855.3 13212,4890.8 13210,4882.6 13207,4873.5 13205,4864.9"];
	layer0_attn_proj_gpu7 -> layer0_attn_allreduce	[pos="e,12474,4703.4 13092,4796.6 13075,4793.1 13059,4789.8 13043,4787 12853,4752.6 12633,4723.2 12484,4704.7"];
	layer0_attn_norm_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU0
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="3361,4545",
		shape=rectangle,
		width=3.3889];
	layer0_attn_allreduce -> layer0_attn_norm_gpu0	[pos="e,3483.4,4547.8 12086,4678.6 10816,4659.3 4490.5,4563.1 3493.4,4548"];
	layer0_attn_norm_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU1
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="7838,4545",
		shape=rectangle,
		width=3.3889];
	layer0_attn_allreduce -> layer0_attn_norm_gpu1	[pos="e,7960.1,4549.7 12097,4675.5 11315,4651.7 8601.7,4569.2 7970.1,4550"];
	layer0_attn_norm_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU2
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="10207,4545",
		shape=rectangle,
		width=3.3889];
	layer0_attn_allreduce -> layer0_attn_norm_gpu2	[pos="e,10329,4553.9 12117,4669.6 11697,4642.4 10699,4577.8 10339,4554.5"];
	layer0_attn_norm_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU3
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="11523,4545",
		shape=rectangle,
		width=3.3889];
	layer0_attn_allreduce -> layer0_attn_norm_gpu3	[pos="e,11645,4567.1 12162,4656.7 12017,4631.5 11795,4593.2 11655,4568.8"];
	layer0_attn_norm_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU4
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="13094,4545",
		shape=rectangle,
		width=3.3889];
	layer0_attn_allreduce -> layer0_attn_norm_gpu4	[pos="e,12972,4567.1 12454,4656.7 12600,4631.5 12821,4593.1 12962,4568.8"];
	layer0_attn_norm_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU5
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="15415,4545",
		shape=rectangle,
		width=3.3889];
	layer0_attn_allreduce -> layer0_attn_norm_gpu5	[pos="e,15293,4551.3 12511,4673.1 13099,4647.3 14795,4573.1 15283,4551.8"];
	layer0_attn_norm_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU6
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="18112,4545",
		shape=rectangle,
		width=3.3889];
	layer0_attn_allreduce -> layer0_attn_norm_gpu6	[pos="e,17990,4548.8 12524,4676.9 13469,4654.7 17226,4566.7 17980,4549"];
	layer0_attn_norm_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU7
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="20996,4545",
		shape=rectangle,
		width=3.3889];
	layer0_attn_allreduce -> layer0_attn_norm_gpu7	[pos="e,20874,4547.9 12530,4678.5 13775,4659 19885,4563.4 20864,4548"];
	layer0_gate_gpu0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU0
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 0",
		pos="1653,4433.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu0 -> layer0_gate_gpu0	[pos="e,1775.1,4442.3 3238.9,4536.1 2927.8,4516.2 2107.5,4463.6 1785.5,4442.9"];
	layer0_gate_gpu1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU1
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 1",
		pos="4725,4433.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu1 -> layer0_gate_gpu1	[pos="e,4847,4438.7 7716,4539.7 7221.5,4522.3 5369.4,4457.1 4857.1,4439.1"];
	layer0_gate_gpu2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU2
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 2",
		pos="7797,4433.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu2 -> layer0_gate_gpu2	[pos="e,7919.3,4440 10085,4538.4 9674.9,4519.8 8353.7,4459.7 7929.4,4440.5"];
	layer0_gate_gpu3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU3
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 3",
		pos="10869,4433.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu3 -> layer0_gate_gpu3	[pos="e,10991,4454.9 11401,4523.5 11287,4504.4 11118,4476.2 11001,4456.6"];
	layer0_gate_gpu4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU4
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 4",
		pos="13749,4433.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu4 -> layer0_gate_gpu4	[pos="e,13627,4454.9 13216,4523.5 13330,4504.5 13500,4476.2 13617,4456.6"];
	layer0_gate_gpu5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU5
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 5",
		pos="16821,4433.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu5 -> layer0_gate_gpu5	[pos="e,16699,4444 15537,4534.5 15800,4514 16417,4465.9 16689,4444.8"];
	layer0_gate_gpu6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU6
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 6",
		pos="19893,4433.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu6 -> layer0_gate_gpu6	[pos="e,19771,4442 18234,4536.4 18556,4516.6 19427,4463.1 19761,4442.6"];
	layer0_gate_gpu7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Gate_GPU7
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 7",
		pos="22965,4433.5",
		shape=rectangle,
		width=3.3889];
	layer0_attn_norm_gpu7 -> layer0_gate_gpu7	[pos="e,22843,4441.2 21118,4537.2 21468,4517.7 22471,4461.9 22833,4441.8"];
	layer0_expert0_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="117,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_0	[pos="e,204.22,4353.7 1530.8,4431.4 1234.2,4427.9 481.59,4413.6 214.29,4356",
		style=dashed];
	layer0_expert0_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="309,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_1	[pos="e,396.22,4353.7 1530.8,4430.2 1264,4424.4 635.25,4406.1 406.17,4355.9",
		style=dashed];
	layer0_expert0_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="501,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_2	[pos="e,588.23,4353.6 1530.9,4428.6 1296.3,4420.4 789.38,4398.6 598.19,4355.9",
		style=dashed];
	layer0_expert0_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="693,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_3	[pos="e,780.25,4353.6 1530.8,4426.3 1331.3,4415.5 943.31,4391.1 790,4355.9",
		style=dashed];
	layer0_expert0_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="885,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_4	[pos="e,972.01,4353.4 1530.9,4429 1397,4422.9 1176.5,4405.8 981.84,4356",
		style=dashed];
	layer0_expert0_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1077,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_5	[pos="e,1164.1,4353.2 1530.9,4421.2 1435.3,4410.5 1299.4,4391.1 1173.8,4356",
		style=dashed];
	layer0_expert0_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1269,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_6	[pos="e,1356.2,4352.8 1530.7,4404 1481.7,4391.6 1424.7,4376 1365.7,4356.1",
		style=dashed];
	layer0_expert0_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1461,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_7	[pos="e,1527.5,4356 1586.4,4391.9 1570.2,4382 1552.7,4371.3 1536.1,4361.2",
		style=dashed];
	layer0_expert0_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1653,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_8	[pos="e,1653,4356 1653,4391.9 1653,4383.6 1653,4374.8 1653,4366.3",
		style=dashed];
	layer0_expert0_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1845,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_9	[pos="e,1778.5,4356 1719.6,4391.9 1735.8,4382 1753.3,4371.3 1769.9,4361.2",
		style=dashed];
	layer0_expert0_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2037,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_10	[pos="e,1949.8,4352.8 1775.3,4404 1824.3,4391.6 1881.3,4376 1940.3,4356.1",
		style=dashed];
	layer0_expert0_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2229,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_11	[pos="e,2141.9,4353.2 1775.1,4421.2 1870.7,4410.5 2006.6,4391.1 2132.2,4356",
		style=dashed];
	layer0_expert0_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2421,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_12	[pos="e,2334,4353.4 1775.1,4429 1909,4422.9 2129.5,4405.8 2324.2,4356",
		style=dashed];
	layer0_expert0_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2613,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_13	[pos="e,2525.8,4353.6 1775.2,4426.3 1974.7,4415.5 2362.7,4391.1 2516,4355.9",
		style=dashed];
	layer0_expert0_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2805,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_14	[pos="e,2717.8,4353.6 1775.1,4428.6 2009.7,4420.4 2516.6,4398.6 2707.8,4355.9",
		style=dashed];
	layer0_expert0_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2997,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu0 -> layer0_expert0_15	[pos="e,2909.8,4353.7 1775.2,4430.2 2042,4424.4 2670.7,4406.1 2899.8,4355.9",
		style=dashed];
	layer0_moe_agg_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_MoE_Aggregate_GPU0
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 0",
		pos="1653,4203",
		shape=rectangle,
		width=2.8194];
	layer0_expert0_0 -> layer0_moe_agg_gpu0	[pos="e,1551.3,4204.2 204.21,4275.2 207.16,4274.4 210.09,4273.6 213,4273 465.13,4215.6 1248.3,4205.9 1541,4204.3"];
	layer0_expert0_1 -> layer0_moe_agg_gpu0	[pos="e,1551.4,4205.1 396.22,4275.2 399.16,4274.4 402.09,4273.6 405,4273 619.24,4223.4 1276.4,4209.1 1541,4205.2"];
	layer0_expert0_2 -> layer0_moe_agg_gpu0	[pos="e,1551.3,4206.3 588.23,4275.2 591.17,4274.4 594.1,4273.6 597,4273 773.72,4231.2 1307.2,4212.8 1541.1,4206.6"];
	layer0_expert0_3 -> layer0_moe_agg_gpu0	[pos="e,1551.2,4208 780.24,4275.3 783.18,4274.4 786.1,4273.7 789,4273 928.55,4238.9 1340.5,4217.3 1541,4208.5"];
	layer0_expert0_4 -> layer0_moe_agg_gpu0	[pos="e,1551.5,4205.1 972.26,4275.4 975.19,4274.5 978.11,4273.7 981,4273 1173.8,4223.6 1406.3,4209.3 1541.1,4205.4"];
	layer0_expert0_5 -> layer0_moe_agg_gpu0	[pos="e,1551.2,4211 1164,4275.6 1167,4274.7 1170,4273.8 1173,4273 1296.5,4238.6 1442.9,4220.7 1541.3,4211.9"];
	layer0_expert0_6 -> layer0_moe_agg_gpu0	[pos="e,1551.2,4224.1 1356.1,4276 1359.1,4274.9 1362.1,4273.9 1365,4273 1422.3,4254.2 1487.5,4238.1 1541.3,4226.2"];
	layer0_expert0_7 -> layer0_moe_agg_gpu0	[pos="e,1595.1,4237 1532.2,4272.8 1549.9,4262.8 1568.7,4252 1586.1,4242.1"];
	layer0_expert0_8 -> layer0_moe_agg_gpu0	[pos="e,1653,4237.3 1653,4272.7 1653,4264.5 1653,4255.8 1653,4247.5"];
	layer0_expert0_9 -> layer0_moe_agg_gpu0	[pos="e,1710.9,4237 1773.8,4272.8 1756.1,4262.8 1737.3,4252 1719.9,4242.1"];
	layer0_expert0_10 -> layer0_moe_agg_gpu0	[pos="e,1754.8,4224.1 1949.9,4276 1946.9,4274.9 1943.9,4273.9 1941,4273 1883.7,4254.2 1818.5,4238.1 1764.7,4226.2"];
	layer0_expert0_11 -> layer0_moe_agg_gpu0	[pos="e,1754.8,4211 2142,4275.6 2139,4274.7 2136,4273.8 2133,4273 2009.5,4238.6 1863.1,4220.7 1764.7,4211.9"];
	layer0_expert0_12 -> layer0_moe_agg_gpu0	[pos="e,1754.5,4205.1 2333.7,4275.4 2330.8,4274.5 2327.9,4273.7 2325,4273 2132.2,4223.6 1899.7,4209.3 1764.9,4205.4"];
	layer0_expert0_13 -> layer0_moe_agg_gpu0	[pos="e,1754.8,4208 2525.8,4275.3 2522.8,4274.4 2519.9,4273.7 2517,4273 2377.4,4238.9 1965.5,4217.3 1765,4208.5"];
	layer0_expert0_14 -> layer0_moe_agg_gpu0	[pos="e,1754.7,4206.3 2717.8,4275.2 2714.8,4274.4 2711.9,4273.6 2709,4273 2532.3,4231.2 1998.8,4212.8 1764.9,4206.6"];
	layer0_expert0_15 -> layer0_moe_agg_gpu0	[pos="e,1754.6,4205.1 2909.8,4275.2 2906.8,4274.4 2903.9,4273.6 2901,4273 2686.8,4223.4 2029.6,4209.1 1765,4205.2"];
	layer0_moe_allreduce	[height=1.8889,
		label="L0_MoE_All-Reduce
Input: 8×[1024,2048,4096]
Output: [1024,2048,4096]
TP All-Reduce across GPUs 0-7",
		pos="12309,4065",
		width=6.5833];
	layer0_moe_agg_gpu0 -> layer0_moe_allreduce	[pos="e,12085,4068.8 1754.6,4200.7 2741.3,4188.1 10611,4087.6 12075,4068.9"];
	layer0_output_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU0
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 0",
		pos="11392,3927",
		shape=rectangle,
		width=3.3889];
	layer1_qkv_gpu0	[fillcolor=lightgreen,
		height=1.3611,
		label="L1_QKV_Projection_GPU0
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 0-3
TP Slice: 0
GPU: 0",
		pos="11394,3808",
		shape=rectangle,
		width=2.7778];
	layer0_output_gpu0 -> layer1_qkv_gpu0	[pos="e,11393,3857.1 11393,3892.7 11393,3884.8 11393,3876 11393,3867.3"];
	layer0_expert1_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3189,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_0	[pos="e,3276.2,4353.7 4602.8,4431.4 4306.2,4427.9 3553.6,4413.6 3286.3,4356",
		style=dashed];
	layer0_expert1_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3381,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_1	[pos="e,3468.2,4353.7 4602.8,4430.2 4336,4424.4 3707.3,4406.1 3478.2,4355.9",
		style=dashed];
	layer0_expert1_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3573,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_2	[pos="e,3660.2,4353.6 4602.9,4428.6 4368.3,4420.4 3861.4,4398.6 3670.2,4355.9",
		style=dashed];
	layer0_expert1_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3765,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_3	[pos="e,3852.2,4353.6 4602.8,4426.3 4403.3,4415.5 4015.3,4391.1 3862,4355.9",
		style=dashed];
	layer0_expert1_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3957,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_4	[pos="e,4044,4353.4 4602.9,4429 4469,4422.9 4248.5,4405.8 4053.8,4356",
		style=dashed];
	layer0_expert1_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4149,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_5	[pos="e,4236.1,4353.2 4602.9,4421.2 4507.3,4410.5 4371.4,4391.1 4245.8,4356",
		style=dashed];
	layer0_expert1_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4341,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_6	[pos="e,4428.2,4352.8 4602.7,4404 4553.7,4391.6 4496.7,4376 4437.7,4356.1",
		style=dashed];
	layer0_expert1_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4533,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_7	[pos="e,4599.5,4356 4658.4,4391.9 4642.2,4382 4624.7,4371.3 4608.1,4361.2",
		style=dashed];
	layer0_expert1_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4725,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_8	[pos="e,4725,4356 4725,4391.9 4725,4383.6 4725,4374.8 4725,4366.3",
		style=dashed];
	layer0_expert1_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4917,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_9	[pos="e,4850.5,4356 4791.6,4391.9 4807.8,4382 4825.3,4371.3 4841.9,4361.2",
		style=dashed];
	layer0_expert1_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5109,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_10	[pos="e,5021.8,4352.8 4847.3,4404 4896.3,4391.6 4953.3,4376 5012.3,4356.1",
		style=dashed];
	layer0_expert1_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5301,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_11	[pos="e,5213.9,4353.2 4847.1,4421.2 4942.7,4410.5 5078.6,4391.1 5204.2,4356",
		style=dashed];
	layer0_expert1_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5493,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_12	[pos="e,5406,4353.4 4847.1,4429 4981,4422.9 5201.5,4405.8 5396.2,4356",
		style=dashed];
	layer0_expert1_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5685,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_13	[pos="e,5597.8,4353.6 4847.2,4426.3 5046.7,4415.5 5434.7,4391.1 5588,4355.9",
		style=dashed];
	layer0_expert1_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5877,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_14	[pos="e,5789.8,4353.6 4847.1,4428.6 5081.7,4420.4 5588.6,4398.6 5779.8,4355.9",
		style=dashed];
	layer0_expert1_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="6069,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu1 -> layer0_expert1_15	[pos="e,5981.8,4353.7 4847.2,4430.2 5114,4424.4 5742.7,4406.1 5971.8,4355.9",
		style=dashed];
	layer0_moe_agg_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_MoE_Aggregate_GPU1
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 1",
		pos="4725,4203",
		shape=rectangle,
		width=2.8194];
	layer0_expert1_0 -> layer0_moe_agg_gpu1	[pos="e,4623.3,4204.2 3276.2,4275.2 3279.2,4274.4 3282.1,4273.6 3285,4273 3537.1,4215.6 4320.3,4205.9 4613,4204.3"];
	layer0_expert1_1 -> layer0_moe_agg_gpu1	[pos="e,4623.4,4205.1 3468.2,4275.2 3471.2,4274.4 3474.1,4273.6 3477,4273 3691.2,4223.4 4348.4,4209.1 4613,4205.2"];
	layer0_expert1_2 -> layer0_moe_agg_gpu1	[pos="e,4623.3,4206.3 3660.2,4275.2 3663.2,4274.4 3666.1,4273.6 3669,4273 3845.7,4231.2 4379.2,4212.8 4613.1,4206.6"];
	layer0_expert1_3 -> layer0_moe_agg_gpu1	[pos="e,4623.2,4208 3852.2,4275.3 3855.2,4274.4 3858.1,4273.7 3861,4273 4000.6,4238.9 4412.5,4217.3 4613,4208.5"];
	layer0_expert1_4 -> layer0_moe_agg_gpu1	[pos="e,4623.5,4205.1 4044.3,4275.4 4047.2,4274.5 4050.1,4273.7 4053,4273 4245.8,4223.6 4478.3,4209.3 4613.1,4205.4"];
	layer0_expert1_5 -> layer0_moe_agg_gpu1	[pos="e,4623.2,4211 4236,4275.6 4239,4274.7 4242,4273.8 4245,4273 4368.5,4238.6 4514.9,4220.7 4613.3,4211.9"];
	layer0_expert1_6 -> layer0_moe_agg_gpu1	[pos="e,4623.2,4224.1 4428.1,4276 4431.1,4274.9 4434.1,4273.9 4437,4273 4494.3,4254.2 4559.5,4238.1 4613.3,4226.2"];
	layer0_expert1_7 -> layer0_moe_agg_gpu1	[pos="e,4667.1,4237 4604.2,4272.8 4621.9,4262.8 4640.7,4252 4658.1,4242.1"];
	layer0_expert1_8 -> layer0_moe_agg_gpu1	[pos="e,4725,4237.3 4725,4272.7 4725,4264.5 4725,4255.8 4725,4247.5"];
	layer0_expert1_9 -> layer0_moe_agg_gpu1	[pos="e,4782.9,4237 4845.8,4272.8 4828.1,4262.8 4809.3,4252 4791.9,4242.1"];
	layer0_expert1_10 -> layer0_moe_agg_gpu1	[pos="e,4826.8,4224.1 5021.9,4276 5018.9,4274.9 5015.9,4273.9 5013,4273 4955.7,4254.2 4890.5,4238.1 4836.7,4226.2"];
	layer0_expert1_11 -> layer0_moe_agg_gpu1	[pos="e,4826.8,4211 5214,4275.6 5211,4274.7 5208,4273.8 5205,4273 5081.5,4238.6 4935.1,4220.7 4836.7,4211.9"];
	layer0_expert1_12 -> layer0_moe_agg_gpu1	[pos="e,4826.5,4205.1 5405.7,4275.4 5402.8,4274.5 5399.9,4273.7 5397,4273 5204.2,4223.6 4971.7,4209.3 4836.9,4205.4"];
	layer0_expert1_13 -> layer0_moe_agg_gpu1	[pos="e,4826.8,4208 5597.8,4275.3 5594.8,4274.4 5591.9,4273.7 5589,4273 5449.4,4238.9 5037.5,4217.3 4837,4208.5"];
	layer0_expert1_14 -> layer0_moe_agg_gpu1	[pos="e,4826.7,4206.3 5789.8,4275.2 5786.8,4274.4 5783.9,4273.6 5781,4273 5604.3,4231.2 5070.8,4212.8 4836.9,4206.6"];
	layer0_expert1_15 -> layer0_moe_agg_gpu1	[pos="e,4826.6,4205.1 5981.8,4275.2 5978.8,4274.4 5975.9,4273.6 5973,4273 5758.8,4223.4 5101.6,4209.1 4837,4205.2"];
	layer0_moe_agg_gpu1 -> layer0_moe_allreduce	[pos="e,12089,4069.9 4826.8,4200.1 5627.2,4185.8 10906,4091.1 12079,4070.1"];
	layer0_output_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU1
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 1",
		pos="11654,3927",
		shape=rectangle,
		width=3.3889];
	layer1_qkv_gpu1	[fillcolor=lightgreen,
		height=1.3611,
		label="L1_QKV_Projection_GPU1
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 4-7
TP Slice: 1
GPU: 1",
		pos="11654,3808",
		shape=rectangle,
		width=2.7778];
	layer0_output_gpu1 -> layer1_qkv_gpu1	[pos="e,11654,3857.1 11654,3892.7 11654,3884.8 11654,3876 11654,3867.3"];
	layer0_expert2_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="6261,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_0	[pos="e,6348.2,4353.7 7674.8,4431.4 7378.2,4427.9 6625.6,4413.6 6358.3,4356",
		style=dashed];
	layer0_expert2_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="6453,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_1	[pos="e,6540.2,4353.7 7674.8,4430.2 7408,4424.4 6779.3,4406.1 6550.2,4355.9",
		style=dashed];
	layer0_expert2_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="6645,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_2	[pos="e,6732.2,4353.6 7674.9,4428.6 7440.3,4420.4 6933.4,4398.6 6742.2,4355.9",
		style=dashed];
	layer0_expert2_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="6837,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_3	[pos="e,6924.2,4353.6 7674.8,4426.3 7475.3,4415.5 7087.3,4391.1 6934,4355.9",
		style=dashed];
	layer0_expert2_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7029,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_4	[pos="e,7116,4353.4 7674.9,4429 7541,4422.9 7320.5,4405.8 7125.8,4356",
		style=dashed];
	layer0_expert2_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7221,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_5	[pos="e,7308.1,4353.2 7674.9,4421.2 7579.3,4410.5 7443.4,4391.1 7317.8,4356",
		style=dashed];
	layer0_expert2_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7413,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_6	[pos="e,7500.2,4352.8 7674.7,4404 7625.7,4391.6 7568.7,4376 7509.7,4356.1",
		style=dashed];
	layer0_expert2_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7605,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_7	[pos="e,7671.5,4356 7730.4,4391.9 7714.2,4382 7696.7,4371.3 7680.1,4361.2",
		style=dashed];
	layer0_expert2_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7797,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_8	[pos="e,7797,4356 7797,4391.9 7797,4383.6 7797,4374.8 7797,4366.3",
		style=dashed];
	layer0_expert2_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7989,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_9	[pos="e,7922.5,4356 7863.6,4391.9 7879.8,4382 7897.3,4371.3 7913.9,4361.2",
		style=dashed];
	layer0_expert2_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8181,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_10	[pos="e,8093.8,4352.8 7919.3,4404 7968.3,4391.6 8025.3,4376 8084.3,4356.1",
		style=dashed];
	layer0_expert2_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8373,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_11	[pos="e,8285.9,4353.2 7919.1,4421.2 8014.7,4410.5 8150.6,4391.1 8276.2,4356",
		style=dashed];
	layer0_expert2_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8565,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_12	[pos="e,8478,4353.4 7919.1,4429 8053,4422.9 8273.5,4405.8 8468.2,4356",
		style=dashed];
	layer0_expert2_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8757,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_13	[pos="e,8669.8,4353.6 7919.2,4426.3 8118.7,4415.5 8506.7,4391.1 8660,4355.9",
		style=dashed];
	layer0_expert2_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8949,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_14	[pos="e,8861.8,4353.6 7919.1,4428.6 8153.7,4420.4 8660.6,4398.6 8851.8,4355.9",
		style=dashed];
	layer0_expert2_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="9141,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu2 -> layer0_expert2_15	[pos="e,9053.8,4353.7 7919.2,4430.2 8186,4424.4 8814.7,4406.1 9043.8,4355.9",
		style=dashed];
	layer0_moe_agg_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_MoE_Aggregate_GPU2
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 2",
		pos="7797,4203",
		shape=rectangle,
		width=2.8194];
	layer0_expert2_0 -> layer0_moe_agg_gpu2	[pos="e,7695.3,4204.2 6348.2,4275.2 6351.2,4274.4 6354.1,4273.6 6357,4273 6609.1,4215.6 7392.3,4205.9 7685,4204.3"];
	layer0_expert2_1 -> layer0_moe_agg_gpu2	[pos="e,7695.4,4205.1 6540.2,4275.2 6543.2,4274.4 6546.1,4273.6 6549,4273 6763.2,4223.4 7420.4,4209.1 7685,4205.2"];
	layer0_expert2_2 -> layer0_moe_agg_gpu2	[pos="e,7695.3,4206.3 6732.2,4275.2 6735.2,4274.4 6738.1,4273.6 6741,4273 6917.7,4231.2 7451.2,4212.8 7685.1,4206.6"];
	layer0_expert2_3 -> layer0_moe_agg_gpu2	[pos="e,7695.2,4208 6924.2,4275.3 6927.2,4274.4 6930.1,4273.7 6933,4273 7072.6,4238.9 7484.5,4217.3 7685,4208.5"];
	layer0_expert2_4 -> layer0_moe_agg_gpu2	[pos="e,7695.5,4205.1 7116.3,4275.4 7119.2,4274.5 7122.1,4273.7 7125,4273 7317.8,4223.6 7550.3,4209.3 7685.1,4205.4"];
	layer0_expert2_5 -> layer0_moe_agg_gpu2	[pos="e,7695.2,4211 7308,4275.6 7311,4274.7 7314,4273.8 7317,4273 7440.5,4238.6 7586.9,4220.7 7685.3,4211.9"];
	layer0_expert2_6 -> layer0_moe_agg_gpu2	[pos="e,7695.2,4224.1 7500.1,4276 7503.1,4274.9 7506.1,4273.9 7509,4273 7566.3,4254.2 7631.5,4238.1 7685.3,4226.2"];
	layer0_expert2_7 -> layer0_moe_agg_gpu2	[pos="e,7739.1,4237 7676.2,4272.8 7693.9,4262.8 7712.7,4252 7730.1,4242.1"];
	layer0_expert2_8 -> layer0_moe_agg_gpu2	[pos="e,7797,4237.3 7797,4272.7 7797,4264.5 7797,4255.8 7797,4247.5"];
	layer0_expert2_9 -> layer0_moe_agg_gpu2	[pos="e,7854.9,4237 7917.8,4272.8 7900.1,4262.8 7881.3,4252 7863.9,4242.1"];
	layer0_expert2_10 -> layer0_moe_agg_gpu2	[pos="e,7898.8,4224.1 8093.9,4276 8090.9,4274.9 8087.9,4273.9 8085,4273 8027.7,4254.2 7962.5,4238.1 7908.7,4226.2"];
	layer0_expert2_11 -> layer0_moe_agg_gpu2	[pos="e,7898.8,4211 8286,4275.6 8283,4274.7 8280,4273.8 8277,4273 8153.5,4238.6 8007.1,4220.7 7908.7,4211.9"];
	layer0_expert2_12 -> layer0_moe_agg_gpu2	[pos="e,7898.5,4205.1 8477.7,4275.4 8474.8,4274.5 8471.9,4273.7 8469,4273 8276.2,4223.6 8043.7,4209.3 7908.9,4205.4"];
	layer0_expert2_13 -> layer0_moe_agg_gpu2	[pos="e,7898.8,4208 8669.8,4275.3 8666.8,4274.4 8663.9,4273.7 8661,4273 8521.4,4238.9 8109.5,4217.3 7909,4208.5"];
	layer0_expert2_14 -> layer0_moe_agg_gpu2	[pos="e,7898.7,4206.3 8861.8,4275.2 8858.8,4274.4 8855.9,4273.6 8853,4273 8676.3,4231.2 8142.8,4212.8 7908.9,4206.6"];
	layer0_expert2_15 -> layer0_moe_agg_gpu2	[pos="e,7898.6,4205.1 9053.8,4275.2 9050.8,4274.4 9047.9,4273.6 9045,4273 8830.8,4223.4 8173.6,4209.1 7909,4205.2"];
	layer0_moe_agg_gpu2 -> layer0_moe_allreduce	[pos="e,12097,4072.3 7898.6,4198.9 8468.9,4181.7 11274,4097.2 12087,4072.6"];
	layer0_output_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU2
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 2",
		pos="11916,3927",
		shape=rectangle,
		width=3.3889];
	layer1_qkv_gpu2	[fillcolor=lightgreen,
		height=1.3611,
		label="L1_QKV_Projection_GPU2
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 8-11
TP Slice: 2
GPU: 2",
		pos="11917,3808",
		shape=rectangle,
		width=2.7778];
	layer0_output_gpu2 -> layer1_qkv_gpu2	[pos="e,11917,3857.1 11916,3892.7 11916,3884.8 11916,3876 11917,3867.3"];
	layer0_expert3_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="9333,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_0	[pos="e,9420.2,4353.7 10747,4431.4 10450,4427.9 9697.6,4413.6 9430.3,4356",
		style=dashed];
	layer0_expert3_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="9525,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_1	[pos="e,9612.2,4353.7 10747,4430.2 10480,4424.4 9851.3,4406.1 9622.2,4355.9",
		style=dashed];
	layer0_expert3_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="9717,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_2	[pos="e,9804.2,4353.6 10747,4428.6 10512,4420.4 10005,4398.6 9814.2,4355.9",
		style=dashed];
	layer0_expert3_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="9909,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_3	[pos="e,9996.2,4353.6 10747,4426.3 10547,4415.5 10159,4391.1 10006,4355.9",
		style=dashed];
	layer0_expert3_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10101,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_4	[pos="e,10188,4353.4 10747,4429 10613,4422.9 10392,4405.8 10198,4356",
		style=dashed];
	layer0_expert3_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10293,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_5	[pos="e,10380,4353.2 10747,4421.2 10651,4410.5 10515,4391.1 10390,4356",
		style=dashed];
	layer0_expert3_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10485,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_6	[pos="e,10572,4352.8 10747,4404 10698,4391.6 10641,4376 10582,4356.1",
		style=dashed];
	layer0_expert3_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10677,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_7	[pos="e,10743,4356 10802,4391.9 10786,4382 10769,4371.3 10752,4361.2",
		style=dashed];
	layer0_expert3_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10869,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_8	[pos="e,10869,4356 10869,4391.9 10869,4383.6 10869,4374.8 10869,4366.3",
		style=dashed];
	layer0_expert3_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11061,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_9	[pos="e,10995,4356 10936,4391.9 10952,4382 10969,4371.3 10986,4361.2",
		style=dashed];
	layer0_expert3_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11253,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_10	[pos="e,11166,4352.8 10991,4404 11040,4391.6 11097,4376 11156,4356.1",
		style=dashed];
	layer0_expert3_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11445,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_11	[pos="e,11358,4353.2 10991,4421.2 11087,4410.5 11223,4391.1 11348,4356",
		style=dashed];
	layer0_expert3_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11637,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_12	[pos="e,11550,4353.4 10991,4429 11125,4422.9 11346,4405.8 11540,4356",
		style=dashed];
	layer0_expert3_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11829,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_13	[pos="e,11742,4353.6 10991,4426.3 11191,4415.5 11579,4391.1 11732,4355.9",
		style=dashed];
	layer0_expert3_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="12021,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_14	[pos="e,11934,4353.6 10991,4428.6 11226,4420.4 11733,4398.6 11924,4355.9",
		style=dashed];
	layer0_expert3_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="12213,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu3 -> layer0_expert3_15	[pos="e,12126,4353.7 10991,4430.2 11258,4424.4 11887,4406.1 12116,4355.9",
		style=dashed];
	layer0_moe_agg_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_MoE_Aggregate_GPU3
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 3",
		pos="10869,4203",
		shape=rectangle,
		width=2.8194];
	layer0_expert3_0 -> layer0_moe_agg_gpu3	[pos="e,10767,4204.2 9420.2,4275.2 9423.2,4274.4 9426.1,4273.6 9429,4273 9681.1,4215.6 10464,4205.9 10757,4204.3"];
	layer0_expert3_1 -> layer0_moe_agg_gpu3	[pos="e,10767,4205.1 9612.2,4275.2 9615.2,4274.4 9618.1,4273.6 9621,4273 9835.2,4223.4 10492,4209.1 10757,4205.2"];
	layer0_expert3_2 -> layer0_moe_agg_gpu3	[pos="e,10767,4206.3 9804.2,4275.2 9807.2,4274.4 9810.1,4273.6 9813,4273 9989.7,4231.2 10523,4212.8 10757,4206.6"];
	layer0_expert3_3 -> layer0_moe_agg_gpu3	[pos="e,10767,4208 9996.2,4275.3 9999.2,4274.4 10002,4273.7 10005,4273 10145,4238.9 10557,4217.3 10757,4208.5"];
	layer0_expert3_4 -> layer0_moe_agg_gpu3	[pos="e,10767,4205.1 10188,4275.4 10191,4274.5 10194,4273.7 10197,4273 10390,4223.6 10622,4209.3 10757,4205.4"];
	layer0_expert3_5 -> layer0_moe_agg_gpu3	[pos="e,10767,4211 10380,4275.6 10383,4274.7 10386,4273.8 10389,4273 10513,4238.6 10659,4220.7 10757,4211.9"];
	layer0_expert3_6 -> layer0_moe_agg_gpu3	[pos="e,10767,4224.1 10572,4276 10575,4274.9 10578,4273.9 10581,4273 10638,4254.2 10703,4238.1 10757,4226.2"];
	layer0_expert3_7 -> layer0_moe_agg_gpu3	[pos="e,10811,4237 10748,4272.8 10766,4262.8 10785,4252 10802,4242.1"];
	layer0_expert3_8 -> layer0_moe_agg_gpu3	[pos="e,10869,4237.3 10869,4272.7 10869,4264.5 10869,4255.8 10869,4247.5"];
	layer0_expert3_9 -> layer0_moe_agg_gpu3	[pos="e,10927,4237 10990,4272.8 10972,4262.8 10953,4252 10936,4242.1"];
	layer0_expert3_10 -> layer0_moe_agg_gpu3	[pos="e,10971,4224.1 11166,4276 11163,4274.9 11160,4273.9 11157,4273 11100,4254.2 11035,4238.1 10981,4226.2"];
	layer0_expert3_11 -> layer0_moe_agg_gpu3	[pos="e,10971,4211 11358,4275.6 11355,4274.7 11352,4273.8 11349,4273 11225,4238.6 11079,4220.7 10981,4211.9"];
	layer0_expert3_12 -> layer0_moe_agg_gpu3	[pos="e,10971,4205.1 11550,4275.4 11547,4274.5 11544,4273.7 11541,4273 11348,4223.6 11116,4209.3 10981,4205.4"];
	layer0_expert3_13 -> layer0_moe_agg_gpu3	[pos="e,10971,4208 11742,4275.3 11739,4274.4 11736,4273.7 11733,4273 11593,4238.9 11181,4217.3 10981,4208.5"];
	layer0_expert3_14 -> layer0_moe_agg_gpu3	[pos="e,10971,4206.3 11934,4275.2 11931,4274.4 11928,4273.6 11925,4273 11748,4231.2 11215,4212.8 10981,4206.6"];
	layer0_expert3_15 -> layer0_moe_agg_gpu3	[pos="e,10971,4205.1 12126,4275.2 12123,4274.4 12120,4273.6 12117,4273 11903,4223.4 11246,4209.1 10981,4205.2"];
	layer0_moe_agg_gpu3 -> layer0_moe_allreduce	[pos="e,12133,4082.6 10971,4192.4 11210,4169.7 11815,4112.6 12123,4083.5"];
	layer0_output_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU3
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 3",
		pos="12178,3927",
		shape=rectangle,
		width=3.3889];
	layer1_qkv_gpu3	[fillcolor=lightgreen,
		height=1.3611,
		label="L1_QKV_Projection_GPU3
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 12-15
TP Slice: 3
GPU: 3",
		pos="12178,3808",
		shape=rectangle,
		width=2.7778];
	layer0_output_gpu3 -> layer1_qkv_gpu3	[pos="e,12178,3857.1 12178,3892.7 12178,3884.8 12178,3876 12178,3867.3"];
	layer0_expert4_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="12405,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_0	[pos="e,12492,4353.7 13627,4430.2 13360,4424.4 12731,4406.1 12502,4355.9",
		style=dashed];
	layer0_expert4_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="12597,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_1	[pos="e,12684,4353.6 13627,4428.6 13392,4420.4 12885,4398.6 12694,4355.9",
		style=dashed];
	layer0_expert4_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="12789,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_2	[pos="e,12876,4353.6 13627,4426.3 13427,4415.5 13039,4391.1 12886,4355.9",
		style=dashed];
	layer0_expert4_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="12981,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_3	[pos="e,13068,4353.4 13627,4429 13493,4422.9 13272,4405.8 13078,4356",
		style=dashed];
	layer0_expert4_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13173,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_4	[pos="e,13260,4353.2 13627,4421.2 13531,4410.5 13395,4391.1 13270,4356",
		style=dashed];
	layer0_expert4_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13365,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_5	[pos="e,13452,4352.8 13627,4404 13578,4391.6 13521,4376 13462,4356.1",
		style=dashed];
	layer0_expert4_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13557,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_6	[pos="e,13623,4356 13682,4391.9 13666,4382 13649,4371.3 13632,4361.2",
		style=dashed];
	layer0_expert4_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13749,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_7	[pos="e,13749,4356 13749,4391.9 13749,4383.6 13749,4374.8 13749,4366.3",
		style=dashed];
	layer0_expert4_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13941,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_8	[pos="e,13875,4356 13816,4391.9 13832,4382 13849,4371.3 13866,4361.2",
		style=dashed];
	layer0_expert4_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14133,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_9	[pos="e,14046,4352.8 13871,4404 13920,4391.6 13977,4376 14036,4356.1",
		style=dashed];
	layer0_expert4_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14325,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_10	[pos="e,14238,4353.2 13871,4421.2 13967,4410.5 14103,4391.1 14228,4356",
		style=dashed];
	layer0_expert4_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14517,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_11	[pos="e,14430,4353.4 13871,4429 14005,4422.9 14226,4405.8 14420,4356",
		style=dashed];
	layer0_expert4_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14709,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_12	[pos="e,14622,4353.6 13871,4426.3 14071,4415.5 14459,4391.1 14612,4355.9",
		style=dashed];
	layer0_expert4_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14901,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_13	[pos="e,14814,4353.6 13871,4428.6 14106,4420.4 14613,4398.6 14804,4355.9",
		style=dashed];
	layer0_expert4_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="15093,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_14	[pos="e,15006,4353.7 13871,4430.2 14138,4424.4 14767,4406.1 14996,4355.9",
		style=dashed];
	layer0_expert4_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="15285,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu4 -> layer0_expert4_15	[pos="e,15198,4353.7 13871,4431.4 14168,4427.9 14920,4413.6 15188,4356",
		style=dashed];
	layer0_moe_agg_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_MoE_Aggregate_GPU4
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 4",
		pos="13749,4203",
		shape=rectangle,
		width=2.8194];
	layer0_expert4_0 -> layer0_moe_agg_gpu4	[pos="e,13647,4205.1 12492,4275.2 12495,4274.4 12498,4273.6 12501,4273 12715,4223.4 13372,4209.1 13637,4205.2"];
	layer0_expert4_1 -> layer0_moe_agg_gpu4	[pos="e,13647,4206.3 12684,4275.2 12687,4274.4 12690,4273.6 12693,4273 12870,4231.2 13403,4212.8 13637,4206.6"];
	layer0_expert4_2 -> layer0_moe_agg_gpu4	[pos="e,13647,4208 12876,4275.3 12879,4274.4 12882,4273.7 12885,4273 13025,4238.9 13437,4217.3 13637,4208.5"];
	layer0_expert4_3 -> layer0_moe_agg_gpu4	[pos="e,13647,4205.1 13068,4275.4 13071,4274.5 13074,4273.7 13077,4273 13270,4223.6 13502,4209.3 13637,4205.4"];
	layer0_expert4_4 -> layer0_moe_agg_gpu4	[pos="e,13647,4211 13260,4275.6 13263,4274.7 13266,4273.8 13269,4273 13393,4238.6 13539,4220.7 13637,4211.9"];
	layer0_expert4_5 -> layer0_moe_agg_gpu4	[pos="e,13647,4224.1 13452,4276 13455,4274.9 13458,4273.9 13461,4273 13518,4254.2 13583,4238.1 13637,4226.2"];
	layer0_expert4_6 -> layer0_moe_agg_gpu4	[pos="e,13691,4237 13628,4272.8 13646,4262.8 13665,4252 13682,4242.1"];
	layer0_expert4_7 -> layer0_moe_agg_gpu4	[pos="e,13749,4237.3 13749,4272.7 13749,4264.5 13749,4255.8 13749,4247.5"];
	layer0_expert4_8 -> layer0_moe_agg_gpu4	[pos="e,13807,4237 13870,4272.8 13852,4262.8 13833,4252 13816,4242.1"];
	layer0_expert4_9 -> layer0_moe_agg_gpu4	[pos="e,13851,4224.1 14046,4276 14043,4274.9 14040,4273.9 14037,4273 13980,4254.2 13915,4238.1 13861,4226.2"];
	layer0_expert4_10 -> layer0_moe_agg_gpu4	[pos="e,13851,4211 14238,4275.6 14235,4274.7 14232,4273.8 14229,4273 14105,4238.6 13959,4220.7 13861,4211.9"];
	layer0_expert4_11 -> layer0_moe_agg_gpu4	[pos="e,13851,4205.1 14430,4275.4 14427,4274.5 14424,4273.7 14421,4273 14228,4223.6 13996,4209.3 13861,4205.4"];
	layer0_expert4_12 -> layer0_moe_agg_gpu4	[pos="e,13851,4208 14622,4275.3 14619,4274.4 14616,4273.7 14613,4273 14473,4238.9 14061,4217.3 13861,4208.5"];
	layer0_expert4_13 -> layer0_moe_agg_gpu4	[pos="e,13851,4206.3 14814,4275.2 14811,4274.4 14808,4273.6 14805,4273 14628,4231.2 14095,4212.8 13861,4206.6"];
	layer0_expert4_14 -> layer0_moe_agg_gpu4	[pos="e,13851,4205.1 15006,4275.2 15003,4274.4 15000,4273.6 14997,4273 14783,4223.4 14126,4209.1 13861,4205.2"];
	layer0_expert4_15 -> layer0_moe_agg_gpu4	[pos="e,13851,4204.2 15198,4275.2 15195,4274.4 15192,4273.6 15189,4273 14937,4215.6 14154,4205.9 13861,4204.3"];
	layer0_moe_agg_gpu4 -> layer0_moe_allreduce	[pos="e,12485,4082.6 13647,4192.4 13408,4169.7 12803,4112.6 12495,4083.5"];
	layer0_output_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU4
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 4",
		pos="12440,3927",
		shape=rectangle,
		width=3.3889];
	layer1_qkv_gpu4	[fillcolor=lightgreen,
		height=1.3611,
		label="L1_QKV_Projection_GPU4
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 16-19
TP Slice: 4
GPU: 4",
		pos="12439,3808",
		shape=rectangle,
		width=2.7778];
	layer0_output_gpu4 -> layer1_qkv_gpu4	[pos="e,12439,3857.1 12440,3892.7 12440,3884.8 12440,3876 12439,3867.3"];
	layer0_expert5_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="15477,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_0	[pos="e,15564,4353.7 16699,4430.2 16432,4424.4 15803,4406.1 15574,4355.9",
		style=dashed];
	layer0_expert5_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="15669,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_1	[pos="e,15756,4353.6 16699,4428.6 16464,4420.4 15957,4398.6 15766,4355.9",
		style=dashed];
	layer0_expert5_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="15861,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_2	[pos="e,15948,4353.6 16699,4426.3 16499,4415.5 16111,4391.1 15958,4355.9",
		style=dashed];
	layer0_expert5_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16053,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_3	[pos="e,16140,4353.4 16699,4429 16565,4422.9 16344,4405.8 16150,4356",
		style=dashed];
	layer0_expert5_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16245,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_4	[pos="e,16332,4353.2 16699,4421.2 16603,4410.5 16467,4391.1 16342,4356",
		style=dashed];
	layer0_expert5_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16437,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_5	[pos="e,16524,4352.8 16699,4404 16650,4391.6 16593,4376 16534,4356.1",
		style=dashed];
	layer0_expert5_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16629,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_6	[pos="e,16695,4356 16754,4391.9 16738,4382 16721,4371.3 16704,4361.2",
		style=dashed];
	layer0_expert5_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16821,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_7	[pos="e,16821,4356 16821,4391.9 16821,4383.6 16821,4374.8 16821,4366.3",
		style=dashed];
	layer0_expert5_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17013,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_8	[pos="e,16947,4356 16888,4391.9 16904,4382 16921,4371.3 16938,4361.2",
		style=dashed];
	layer0_expert5_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17205,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_9	[pos="e,17118,4352.8 16943,4404 16992,4391.6 17049,4376 17108,4356.1",
		style=dashed];
	layer0_expert5_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17397,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_10	[pos="e,17310,4353.2 16943,4421.2 17039,4410.5 17175,4391.1 17300,4356",
		style=dashed];
	layer0_expert5_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17589,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_11	[pos="e,17502,4353.4 16943,4429 17077,4422.9 17298,4405.8 17492,4356",
		style=dashed];
	layer0_expert5_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17781,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_12	[pos="e,17694,4353.6 16943,4426.3 17143,4415.5 17531,4391.1 17684,4355.9",
		style=dashed];
	layer0_expert5_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17973,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_13	[pos="e,17886,4353.6 16943,4428.6 17178,4420.4 17685,4398.6 17876,4355.9",
		style=dashed];
	layer0_expert5_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="18165,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_14	[pos="e,18078,4353.7 16943,4430.2 17210,4424.4 17839,4406.1 18068,4355.9",
		style=dashed];
	layer0_expert5_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="18357,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu5 -> layer0_expert5_15	[pos="e,18270,4353.7 16943,4431.4 17240,4427.9 17992,4413.6 18260,4356",
		style=dashed];
	layer0_moe_agg_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_MoE_Aggregate_GPU5
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 5",
		pos="16821,4203",
		shape=rectangle,
		width=2.8194];
	layer0_expert5_0 -> layer0_moe_agg_gpu5	[pos="e,16719,4205.1 15564,4275.2 15567,4274.4 15570,4273.6 15573,4273 15787,4223.4 16444,4209.1 16709,4205.2"];
	layer0_expert5_1 -> layer0_moe_agg_gpu5	[pos="e,16719,4206.3 15756,4275.2 15759,4274.4 15762,4273.6 15765,4273 15942,4231.2 16475,4212.8 16709,4206.6"];
	layer0_expert5_2 -> layer0_moe_agg_gpu5	[pos="e,16719,4208 15948,4275.3 15951,4274.4 15954,4273.7 15957,4273 16097,4238.9 16509,4217.3 16709,4208.5"];
	layer0_expert5_3 -> layer0_moe_agg_gpu5	[pos="e,16719,4205.1 16140,4275.4 16143,4274.5 16146,4273.7 16149,4273 16342,4223.6 16574,4209.3 16709,4205.4"];
	layer0_expert5_4 -> layer0_moe_agg_gpu5	[pos="e,16719,4211 16332,4275.6 16335,4274.7 16338,4273.8 16341,4273 16465,4238.6 16611,4220.7 16709,4211.9"];
	layer0_expert5_5 -> layer0_moe_agg_gpu5	[pos="e,16719,4224.1 16524,4276 16527,4274.9 16530,4273.9 16533,4273 16590,4254.2 16655,4238.1 16709,4226.2"];
	layer0_expert5_6 -> layer0_moe_agg_gpu5	[pos="e,16763,4237 16700,4272.8 16718,4262.8 16737,4252 16754,4242.1"];
	layer0_expert5_7 -> layer0_moe_agg_gpu5	[pos="e,16821,4237.3 16821,4272.7 16821,4264.5 16821,4255.8 16821,4247.5"];
	layer0_expert5_8 -> layer0_moe_agg_gpu5	[pos="e,16879,4237 16942,4272.8 16924,4262.8 16905,4252 16888,4242.1"];
	layer0_expert5_9 -> layer0_moe_agg_gpu5	[pos="e,16923,4224.1 17118,4276 17115,4274.9 17112,4273.9 17109,4273 17052,4254.2 16987,4238.1 16933,4226.2"];
	layer0_expert5_10 -> layer0_moe_agg_gpu5	[pos="e,16923,4211 17310,4275.6 17307,4274.7 17304,4273.8 17301,4273 17177,4238.6 17031,4220.7 16933,4211.9"];
	layer0_expert5_11 -> layer0_moe_agg_gpu5	[pos="e,16923,4205.1 17502,4275.4 17499,4274.5 17496,4273.7 17493,4273 17300,4223.6 17068,4209.3 16933,4205.4"];
	layer0_expert5_12 -> layer0_moe_agg_gpu5	[pos="e,16923,4208 17694,4275.3 17691,4274.4 17688,4273.7 17685,4273 17545,4238.9 17133,4217.3 16933,4208.5"];
	layer0_expert5_13 -> layer0_moe_agg_gpu5	[pos="e,16923,4206.3 17886,4275.2 17883,4274.4 17880,4273.6 17877,4273 17700,4231.2 17167,4212.8 16933,4206.6"];
	layer0_expert5_14 -> layer0_moe_agg_gpu5	[pos="e,16923,4205.1 18078,4275.2 18075,4274.4 18072,4273.6 18069,4273 17855,4223.4 17198,4209.1 16933,4205.2"];
	layer0_expert5_15 -> layer0_moe_agg_gpu5	[pos="e,16923,4204.2 18270,4275.2 18267,4274.4 18264,4273.6 18261,4273 18009,4215.6 17226,4205.9 16933,4204.3"];
	layer0_moe_agg_gpu5 -> layer0_moe_allreduce	[pos="e,12521,4072.3 16719,4198.9 16149,4181.7 13344,4097.2 12531,4072.6"];
	layer0_output_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU5
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 5",
		pos="12702,3927",
		shape=rectangle,
		width=3.3889];
	layer1_qkv_gpu5	[fillcolor=lightgreen,
		height=1.3611,
		label="L1_QKV_Projection_GPU5
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 20-23
TP Slice: 5
GPU: 5",
		pos="12702,3808",
		shape=rectangle,
		width=2.7778];
	layer0_output_gpu5 -> layer1_qkv_gpu5	[pos="e,12702,3857.1 12702,3892.7 12702,3884.8 12702,3876 12702,3867.3"];
	layer0_expert6_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="18549,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_0	[pos="e,18636,4353.7 19771,4430.2 19504,4424.4 18875,4406.1 18646,4355.9",
		style=dashed];
	layer0_expert6_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="18741,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_1	[pos="e,18828,4353.6 19771,4428.6 19536,4420.4 19029,4398.6 18838,4355.9",
		style=dashed];
	layer0_expert6_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="18933,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_2	[pos="e,19020,4353.6 19771,4426.3 19571,4415.5 19183,4391.1 19030,4355.9",
		style=dashed];
	layer0_expert6_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19125,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_3	[pos="e,19212,4353.4 19771,4429 19637,4422.9 19416,4405.8 19222,4356",
		style=dashed];
	layer0_expert6_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19317,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_4	[pos="e,19404,4353.2 19771,4421.2 19675,4410.5 19539,4391.1 19414,4356",
		style=dashed];
	layer0_expert6_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19509,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_5	[pos="e,19596,4352.8 19771,4404 19722,4391.6 19665,4376 19606,4356.1",
		style=dashed];
	layer0_expert6_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19701,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_6	[pos="e,19767,4356 19826,4391.9 19810,4382 19793,4371.3 19776,4361.2",
		style=dashed];
	layer0_expert6_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19893,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_7	[pos="e,19893,4356 19893,4391.9 19893,4383.6 19893,4374.8 19893,4366.3",
		style=dashed];
	layer0_expert6_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20085,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_8	[pos="e,20019,4356 19960,4391.9 19976,4382 19993,4371.3 20010,4361.2",
		style=dashed];
	layer0_expert6_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20277,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_9	[pos="e,20190,4352.8 20015,4404 20064,4391.6 20121,4376 20180,4356.1",
		style=dashed];
	layer0_expert6_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20469,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_10	[pos="e,20382,4353.2 20015,4421.2 20111,4410.5 20247,4391.1 20372,4356",
		style=dashed];
	layer0_expert6_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20661,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_11	[pos="e,20574,4353.4 20015,4429 20149,4422.9 20370,4405.8 20564,4356",
		style=dashed];
	layer0_expert6_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20853,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_12	[pos="e,20766,4353.6 20015,4426.3 20215,4415.5 20603,4391.1 20756,4355.9",
		style=dashed];
	layer0_expert6_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="21045,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_13	[pos="e,20958,4353.6 20015,4428.6 20250,4420.4 20757,4398.6 20948,4355.9",
		style=dashed];
	layer0_expert6_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="21237,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_14	[pos="e,21150,4353.7 20015,4430.2 20282,4424.4 20911,4406.1 21140,4355.9",
		style=dashed];
	layer0_expert6_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="21429,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu6 -> layer0_expert6_15	[pos="e,21342,4353.7 20015,4431.4 20312,4427.9 21064,4413.6 21332,4356",
		style=dashed];
	layer0_moe_agg_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_MoE_Aggregate_GPU6
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 6",
		pos="19893,4203",
		shape=rectangle,
		width=2.8194];
	layer0_expert6_0 -> layer0_moe_agg_gpu6	[pos="e,19791,4205.1 18636,4275.2 18639,4274.4 18642,4273.6 18645,4273 18859,4223.4 19516,4209.1 19781,4205.2"];
	layer0_expert6_1 -> layer0_moe_agg_gpu6	[pos="e,19791,4206.3 18828,4275.2 18831,4274.4 18834,4273.6 18837,4273 19014,4231.2 19547,4212.8 19781,4206.6"];
	layer0_expert6_2 -> layer0_moe_agg_gpu6	[pos="e,19791,4208 19020,4275.3 19023,4274.4 19026,4273.7 19029,4273 19169,4238.9 19581,4217.3 19781,4208.5"];
	layer0_expert6_3 -> layer0_moe_agg_gpu6	[pos="e,19791,4205.1 19212,4275.4 19215,4274.5 19218,4273.7 19221,4273 19414,4223.6 19646,4209.3 19781,4205.4"];
	layer0_expert6_4 -> layer0_moe_agg_gpu6	[pos="e,19791,4211 19404,4275.6 19407,4274.7 19410,4273.8 19413,4273 19537,4238.6 19683,4220.7 19781,4211.9"];
	layer0_expert6_5 -> layer0_moe_agg_gpu6	[pos="e,19791,4224.1 19596,4276 19599,4274.9 19602,4273.9 19605,4273 19662,4254.2 19727,4238.1 19781,4226.2"];
	layer0_expert6_6 -> layer0_moe_agg_gpu6	[pos="e,19835,4237 19772,4272.8 19790,4262.8 19809,4252 19826,4242.1"];
	layer0_expert6_7 -> layer0_moe_agg_gpu6	[pos="e,19893,4237.3 19893,4272.7 19893,4264.5 19893,4255.8 19893,4247.5"];
	layer0_expert6_8 -> layer0_moe_agg_gpu6	[pos="e,19951,4237 20014,4272.8 19996,4262.8 19977,4252 19960,4242.1"];
	layer0_expert6_9 -> layer0_moe_agg_gpu6	[pos="e,19995,4224.1 20190,4276 20187,4274.9 20184,4273.9 20181,4273 20124,4254.2 20059,4238.1 20005,4226.2"];
	layer0_expert6_10 -> layer0_moe_agg_gpu6	[pos="e,19995,4211 20382,4275.6 20379,4274.7 20376,4273.8 20373,4273 20249,4238.6 20103,4220.7 20005,4211.9"];
	layer0_expert6_11 -> layer0_moe_agg_gpu6	[pos="e,19995,4205.1 20574,4275.4 20571,4274.5 20568,4273.7 20565,4273 20372,4223.6 20140,4209.3 20005,4205.4"];
	layer0_expert6_12 -> layer0_moe_agg_gpu6	[pos="e,19995,4208 20766,4275.3 20763,4274.4 20760,4273.7 20757,4273 20617,4238.9 20205,4217.3 20005,4208.5"];
	layer0_expert6_13 -> layer0_moe_agg_gpu6	[pos="e,19995,4206.3 20958,4275.2 20955,4274.4 20952,4273.6 20949,4273 20772,4231.2 20239,4212.8 20005,4206.6"];
	layer0_expert6_14 -> layer0_moe_agg_gpu6	[pos="e,19995,4205.1 21150,4275.2 21147,4274.4 21144,4273.6 21141,4273 20927,4223.4 20270,4209.1 20005,4205.2"];
	layer0_expert6_15 -> layer0_moe_agg_gpu6	[pos="e,19995,4204.2 21342,4275.2 21339,4274.4 21336,4273.6 21333,4273 21081,4215.6 20298,4205.9 20005,4204.3"];
	layer0_moe_agg_gpu6 -> layer0_moe_allreduce	[pos="e,12529,4069.9 19791,4200.1 18991,4185.8 13712,4091.1 12539,4070.1"];
	layer0_output_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU6
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 6",
		pos="12964,3927",
		shape=rectangle,
		width=3.3889];
	layer1_qkv_gpu6	[fillcolor=lightgreen,
		height=1.3611,
		label="L1_QKV_Projection_GPU6
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 24-27
TP Slice: 6
GPU: 6",
		pos="12963,3808",
		shape=rectangle,
		width=2.7778];
	layer0_output_gpu6 -> layer1_qkv_gpu6	[pos="e,12963,3857.1 12964,3892.7 12964,3884.8 12964,3876 12963,3867.3"];
	layer0_expert7_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert0_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="21621,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_0	[pos="e,21708,4353.7 22843,4430.2 22576,4424.4 21947,4406.1 21718,4355.9",
		style=dashed];
	layer0_expert7_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert1_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="21813,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_1	[pos="e,21900,4353.6 22843,4428.6 22608,4420.4 22101,4398.6 21910,4355.9",
		style=dashed];
	layer0_expert7_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert2_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22005,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_2	[pos="e,22092,4353.6 22843,4426.3 22643,4415.5 22255,4391.1 22102,4355.9",
		style=dashed];
	layer0_expert7_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert3_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22197,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_3	[pos="e,22284,4353.4 22843,4429 22709,4422.9 22488,4405.8 22294,4356",
		style=dashed];
	layer0_expert7_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert4_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22389,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_4	[pos="e,22476,4353.2 22843,4421.2 22747,4410.5 22611,4391.1 22486,4356",
		style=dashed];
	layer0_expert7_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert5_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22581,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_5	[pos="e,22668,4352.8 22843,4404 22794,4391.6 22737,4376 22678,4356.1",
		style=dashed];
	layer0_expert7_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert6_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22773,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_6	[pos="e,22839,4356 22898,4391.9 22882,4382 22865,4371.3 22848,4361.2",
		style=dashed];
	layer0_expert7_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert7_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22965,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_7	[pos="e,22965,4356 22965,4391.9 22965,4383.6 22965,4374.8 22965,4366.3",
		style=dashed];
	layer0_expert7_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert8_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23157,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_8	[pos="e,23091,4356 23032,4391.9 23048,4382 23065,4371.3 23082,4361.2",
		style=dashed];
	layer0_expert7_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert9_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23349,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_9	[pos="e,23262,4352.8 23087,4404 23136,4391.6 23193,4376 23252,4356.1",
		style=dashed];
	layer0_expert7_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert10_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23541,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_10	[pos="e,23454,4353.2 23087,4421.2 23183,4410.5 23319,4391.1 23444,4356",
		style=dashed];
	layer0_expert7_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert11_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23733,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_11	[pos="e,23646,4353.4 23087,4429 23221,4422.9 23442,4405.8 23636,4356",
		style=dashed];
	layer0_expert7_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert12_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23925,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_12	[pos="e,23838,4353.6 23087,4426.3 23287,4415.5 23675,4391.1 23828,4355.9",
		style=dashed];
	layer0_expert7_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert13_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="24117,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_13	[pos="e,24030,4353.6 23087,4428.6 23322,4420.4 23829,4398.6 24020,4355.9",
		style=dashed];
	layer0_expert7_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert14_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="24309,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_14	[pos="e,24222,4353.7 23087,4430.2 23354,4424.4 23983,4406.1 24212,4355.9",
		style=dashed];
	layer0_expert7_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L0_Expert15_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="24501,4314.5",
		shape=rectangle,
		width=2.4167];
	layer0_gate_gpu7 -> layer0_expert7_15	[pos="e,24414,4353.7 23087,4431.4 23384,4427.9 24136,4413.6 24404,4356",
		style=dashed];
	layer0_moe_agg_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_MoE_Aggregate_GPU7
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 7",
		pos="22965,4203",
		shape=rectangle,
		width=2.8194];
	layer0_expert7_0 -> layer0_moe_agg_gpu7	[pos="e,22863,4205.1 21708,4275.2 21711,4274.4 21714,4273.6 21717,4273 21931,4223.4 22588,4209.1 22853,4205.2"];
	layer0_expert7_1 -> layer0_moe_agg_gpu7	[pos="e,22863,4206.3 21900,4275.2 21903,4274.4 21906,4273.6 21909,4273 22086,4231.2 22619,4212.8 22853,4206.6"];
	layer0_expert7_2 -> layer0_moe_agg_gpu7	[pos="e,22863,4208 22092,4275.3 22095,4274.4 22098,4273.7 22101,4273 22241,4238.9 22653,4217.3 22853,4208.5"];
	layer0_expert7_3 -> layer0_moe_agg_gpu7	[pos="e,22863,4205.1 22284,4275.4 22287,4274.5 22290,4273.7 22293,4273 22486,4223.6 22718,4209.3 22853,4205.4"];
	layer0_expert7_4 -> layer0_moe_agg_gpu7	[pos="e,22863,4211 22476,4275.6 22479,4274.7 22482,4273.8 22485,4273 22609,4238.6 22755,4220.7 22853,4211.9"];
	layer0_expert7_5 -> layer0_moe_agg_gpu7	[pos="e,22863,4224.1 22668,4276 22671,4274.9 22674,4273.9 22677,4273 22734,4254.2 22799,4238.1 22853,4226.2"];
	layer0_expert7_6 -> layer0_moe_agg_gpu7	[pos="e,22907,4237 22844,4272.8 22862,4262.8 22881,4252 22898,4242.1"];
	layer0_expert7_7 -> layer0_moe_agg_gpu7	[pos="e,22965,4237.3 22965,4272.7 22965,4264.5 22965,4255.8 22965,4247.5"];
	layer0_expert7_8 -> layer0_moe_agg_gpu7	[pos="e,23023,4237 23086,4272.8 23068,4262.8 23049,4252 23032,4242.1"];
	layer0_expert7_9 -> layer0_moe_agg_gpu7	[pos="e,23067,4224.1 23262,4276 23259,4274.9 23256,4273.9 23253,4273 23196,4254.2 23131,4238.1 23077,4226.2"];
	layer0_expert7_10 -> layer0_moe_agg_gpu7	[pos="e,23067,4211 23454,4275.6 23451,4274.7 23448,4273.8 23445,4273 23321,4238.6 23175,4220.7 23077,4211.9"];
	layer0_expert7_11 -> layer0_moe_agg_gpu7	[pos="e,23067,4205.1 23646,4275.4 23643,4274.5 23640,4273.7 23637,4273 23444,4223.6 23212,4209.3 23077,4205.4"];
	layer0_expert7_12 -> layer0_moe_agg_gpu7	[pos="e,23067,4208 23838,4275.3 23835,4274.4 23832,4273.7 23829,4273 23689,4238.9 23277,4217.3 23077,4208.5"];
	layer0_expert7_13 -> layer0_moe_agg_gpu7	[pos="e,23067,4206.3 24030,4275.2 24027,4274.4 24024,4273.6 24021,4273 23844,4231.2 23311,4212.8 23077,4206.6"];
	layer0_expert7_14 -> layer0_moe_agg_gpu7	[pos="e,23067,4205.1 24222,4275.2 24219,4274.4 24216,4273.6 24213,4273 23999,4223.4 23342,4209.1 23077,4205.2"];
	layer0_expert7_15 -> layer0_moe_agg_gpu7	[pos="e,23067,4204.2 24414,4275.2 24411,4274.4 24408,4273.6 24405,4273 24153,4215.6 23370,4205.9 23077,4204.3"];
	layer0_moe_agg_gpu7 -> layer0_moe_allreduce	[pos="e,12533,4068.8 22863,4200.7 21877,4188.1 14007,4087.6 12543,4068.9"];
	layer0_output_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L0_Residual+LayerNorm_GPU7
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 7",
		pos="13226,3927",
		shape=rectangle,
		width=3.3889];
	layer1_qkv_gpu7	[fillcolor=lightgreen,
		height=1.3611,
		label="L1_QKV_Projection_GPU7
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 28-31
TP Slice: 7
GPU: 7",
		pos="13225,3808",
		shape=rectangle,
		width=2.7778];
	layer0_output_gpu7 -> layer1_qkv_gpu7	[pos="e,13225,3857.1 13226,3892.7 13226,3884.8 13226,3876 13225,3867.3"];
	layer0_moe_allreduce -> layer0_output_gpu0	[pos="e,11514,3959.2 12134,4047 11977,4030.3 11739,4001.7 11524,3961.1"];
	layer0_moe_allreduce -> layer0_output_gpu1	[pos="e,11776,3959 12166,4037.9 12063,4018.7 11921,3991.1 11786,3961.2"];
	layer0_moe_allreduce -> layer0_output_gpu2	[pos="e,12011,3961 12203,4027.2 12146,4007.7 12077,3983.8 12021,3964.3"];
	layer0_moe_allreduce -> layer0_output_gpu3	[pos="e,12210,3961.1 12258,4011.4 12245,3997.1 12230,3981.9 12217,3968.4"];
	layer0_moe_allreduce -> layer0_output_gpu4	[pos="e,12408,3961.1 12360,4011.4 12373,3997.1 12388,3981.9 12401,3968.4"];
	layer0_moe_allreduce -> layer0_output_gpu5	[pos="e,12607,3961 12415,4027.2 12472,4007.7 12541,3983.8 12597,3964.3"];
	layer0_moe_allreduce -> layer0_output_gpu6	[pos="e,12842,3959 12452,4037.9 12555,4018.7 12697,3991.1 12832,3961.2"];
	layer0_moe_allreduce -> layer0_output_gpu7	[pos="e,13104,3959.2 12484,4047 12641,4030.3 12879,4001.7 13094,3961.1"];
	layer1_attn_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU0
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 0",
		pos="11394,3689",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu0 -> layer1_attn_gpu0	[pos="e,11394,3723.1 11394,3758.7 11394,3750.3 11394,3741.6 11394,3733.3"];
	layer1_attn_proj_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Attn_Projection_GPU0
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 0",
		pos="11449,3585",
		shape=rectangle,
		width=2.7778];
	layer1_attn_gpu0 -> layer1_attn_proj_gpu0	[pos="e,11431,3619.3 11412,3654.8 11416,3646.4 11421,3637.2 11426,3628.3"];
	layer1_attn_allreduce	[height=1.8889,
		label="L1_Attention_All-Reduce
Input: 8×[1024,2048,512]
Output: [1024,2048,4096]
TP All-Reduce across GPUs 0-7",
		pos="12298,3447",
		width=6.5833];
	layer1_attn_proj_gpu0 -> layer1_attn_allreduce	[pos="e,12130,3466.9 11549,3557.4 11559,3555.1 11569,3552.9 11579,3551 11762,3514.7 11974,3485.9 12120,3468.1"];
	layer1_attn_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU1
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 1",
		pos="11655,3689",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu1 -> layer1_attn_gpu1	[pos="e,11655,3723.1 11654,3758.7 11654,3750.3 11655,3741.6 11655,3733.3"];
	layer1_attn_proj_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Attn_Projection_GPU1
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 1",
		pos="11688,3585",
		shape=rectangle,
		width=2.7778];
	layer1_attn_gpu1 -> layer1_attn_proj_gpu1	[pos="e,11677,3619.3 11666,3654.8 11668,3646.6 11671,3637.5 11674,3628.9"];
	layer1_attn_proj_gpu1 -> layer1_attn_allreduce	[pos="e,12166,3477.3 11788,3561.6 11888,3539.3 12044,3504.6 12157,3479.5"];
	layer1_attn_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU2
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 2",
		pos="11917,3689",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu2 -> layer1_attn_gpu2	[pos="e,11917,3723.1 11917,3758.7 11917,3750.3 11917,3741.6 11917,3733.3"];
	layer1_attn_proj_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Attn_Projection_GPU2
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 2",
		pos="11950,3585",
		shape=rectangle,
		width=2.7778];
	layer1_attn_gpu2 -> layer1_attn_proj_gpu2	[pos="e,11939,3619.3 11928,3654.8 11930,3646.6 11933,3637.5 11936,3628.9"];
	layer1_attn_proj_gpu2 -> layer1_attn_allreduce	[pos="e,12199,3486.6 12035,3550.9 12081,3532.7 12140,3509.9 12189,3490.4"];
	layer1_attn_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU3
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 3",
		pos="12178,3689",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu3 -> layer1_attn_gpu3	[pos="e,12178,3723.1 12178,3758.7 12178,3750.3 12178,3741.6 12178,3733.3"];
	layer1_attn_proj_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Attn_Projection_GPU3
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 3",
		pos="12189,3585",
		shape=rectangle,
		width=2.7778];
	layer1_attn_gpu3 -> layer1_attn_proj_gpu3	[pos="e,12185,3619.3 12182,3654.8 12182,3646.7 12183,3637.9 12184,3629.4"];
	layer1_attn_proj_gpu3 -> layer1_attn_allreduce	[pos="e,12254,3502.6 12216,3550.7 12225,3538.6 12237,3524.5 12248,3510.7"];
	layer1_attn_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU4
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 4",
		pos="12439,3689",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu4 -> layer1_attn_gpu4	[pos="e,12439,3723.1 12439,3758.7 12439,3750.3 12439,3741.6 12439,3733.3"];
	layer1_attn_proj_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Attn_Projection_GPU4
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 4",
		pos="12428,3585",
		shape=rectangle,
		width=2.7778];
	layer1_attn_gpu4 -> layer1_attn_proj_gpu4	[pos="e,12432,3619.3 12435,3654.8 12435,3646.7 12434,3637.9 12433,3629.4"];
	layer1_attn_proj_gpu4 -> layer1_attn_allreduce	[pos="e,12348,3500.7 12396,3550.7 12384,3537.9 12370,3522.9 12356,3508.3"];
	layer1_attn_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU5
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 5",
		pos="12701,3689",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu5 -> layer1_attn_gpu5	[pos="e,12701,3723.1 12702,3758.7 12702,3750.3 12701,3741.6 12701,3733.3"];
	layer1_attn_proj_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Attn_Projection_GPU5
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 5",
		pos="12678,3585",
		shape=rectangle,
		width=2.7778];
	layer1_attn_gpu5 -> layer1_attn_proj_gpu5	[pos="e,12686,3619.3 12694,3654.8 12692,3646.6 12690,3637.7 12688,3629.1"];
	layer1_attn_proj_gpu5 -> layer1_attn_allreduce	[pos="e,12402,3485.2 12586,3550.9 12533,3532.1 12467,3508.5 12411,3488.6"];
	layer1_attn_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU6
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 6",
		pos="12963,3689",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu6 -> layer1_attn_gpu6	[pos="e,12963,3723.1 12963,3758.7 12963,3750.3 12963,3741.6 12963,3733.3"];
	layer1_attn_proj_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Attn_Projection_GPU6
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 6",
		pos="12934,3585",
		shape=rectangle,
		width=2.7778];
	layer1_attn_gpu6 -> layer1_attn_proj_gpu6	[pos="e,12943,3619.3 12954,3654.8 12951,3646.6 12949,3637.7 12946,3629.1"];
	layer1_attn_proj_gpu6 -> layer1_attn_allreduce	[pos="e,12434,3476.1 12834,3561.2 12818,3557.8 12802,3554.2 12787,3551 12672,3525.9 12541,3498.4 12444,3478.1"];
	layer1_attn_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Multi-Head_Attention_GPU7
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 7",
		pos="13225,3689",
		shape=rectangle,
		width=3.375];
	layer1_qkv_gpu7 -> layer1_attn_gpu7	[pos="e,13225,3723.1 13225,3758.7 13225,3750.3 13225,3741.6 13225,3733.3"];
	layer1_attn_proj_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Attn_Projection_GPU7
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 7",
		pos="13192,3585",
		shape=rectangle,
		width=2.7778];
	layer1_attn_gpu7 -> layer1_attn_proj_gpu7	[pos="e,13203,3619.3 13214,3654.8 13212,3646.6 13209,3637.5 13206,3628.9"];
	layer1_attn_proj_gpu7 -> layer1_attn_allreduce	[pos="e,12465,3467.1 13092,3560.6 13075,3557.1 13059,3553.8 13043,3551 12850,3516.3 12627,3486.8 12475,3468.4"];
	layer1_attn_norm_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU0
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="5155,3309",
		shape=rectangle,
		width=3.3889];
	layer1_attn_allreduce -> layer1_attn_norm_gpu0	[pos="e,5277.4,3312.7 12078,3442.2 11325,3429.1 8787.5,3384.7 6691,3343 6171.7,3332.6 5553.6,3318.9 5287.5,3312.9"];
	layer1_attn_norm_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU1
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="6822,3309",
		shape=rectangle,
		width=3.3889];
	layer1_attn_allreduce -> layer1_attn_norm_gpu1	[pos="e,6944.2,3313 12083,3440.6 11176,3418.1 7680.2,3331.3 6954.4,3313.2"];
	layer1_attn_norm_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU2
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="9846,3309",
		shape=rectangle,
		width=3.3889];
	layer1_attn_allreduce -> layer1_attn_norm_gpu2	[pos="e,9968.3,3316.7 12102,3435.1 11620,3408.4 10385,3339.9 9978.4,3317.3"];
	layer1_attn_norm_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU3
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="11513,3309",
		shape=rectangle,
		width=3.3889];
	layer1_attn_allreduce -> layer1_attn_norm_gpu3	[pos="e,11635,3331.1 12152,3420.7 12007,3395.5 11785,3357.2 11645,3332.8"];
	layer1_attn_norm_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU4
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="13084,3309",
		shape=rectangle,
		width=3.3889];
	layer1_attn_allreduce -> layer1_attn_norm_gpu4	[pos="e,12962,3331.1 12444,3420.7 12590,3395.5 12811,3357.1 12952,3332.8"];
	layer1_attn_norm_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU5
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="15405,3309",
		shape=rectangle,
		width=3.3889];
	layer1_attn_allreduce -> layer1_attn_norm_gpu5	[pos="e,15283,3315.3 12501,3437.1 13089,3411.3 14785,3337.1 15273,3315.8"];
	layer1_attn_norm_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU6
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="18102,3309",
		shape=rectangle,
		width=3.3889];
	layer1_attn_allreduce -> layer1_attn_norm_gpu6	[pos="e,17980,3312.8 12514,3440.9 13459,3418.7 17216,3330.7 17970,3313"];
	layer1_attn_norm_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU7
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="20986,3309",
		shape=rectangle,
		width=3.3889];
	layer1_attn_allreduce -> layer1_attn_norm_gpu7	[pos="e,20864,3311.9 12520,3442.5 13765,3423 19875,3327.4 20854,3312"];
	layer1_gate_gpu0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU0
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 0",
		pos="1643,3197.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu0 -> layer1_gate_gpu0	[pos="e,1765,3202.3 5032.8,3304.1 4494.2,3287.3 2333.3,3220 1775.1,3202.6"];
	layer1_gate_gpu1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU1
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 1",
		pos="4715,3197.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu1 -> layer1_gate_gpu1	[pos="e,4837.1,3204.8 6700,3301.6 6331.1,3282.4 5229.1,3225.2 4847.1,3205.3"];
	layer1_gate_gpu2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU2
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 2",
		pos="7787,3197.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu2 -> layer1_gate_gpu2	[pos="e,7909.1,3204.9 9723.7,3301.5 9361.2,3282.2 8294.1,3225.4 7919.1,3205.5"];
	layer1_gate_gpu3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU3
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 3",
		pos="10859,3197.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu3 -> layer1_gate_gpu3	[pos="e,10981,3218.9 11391,3287.5 11277,3268.4 11108,3240.2 10991,3220.6"];
	layer1_gate_gpu4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU4
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 4",
		pos="13739,3197.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu4 -> layer1_gate_gpu4	[pos="e,13617,3218.9 13206,3287.5 13320,3268.5 13490,3240.2 13607,3220.6"];
	layer1_gate_gpu5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU5
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 5",
		pos="16811,3197.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu5 -> layer1_gate_gpu5	[pos="e,16689,3208 15527,3298.5 15790,3278 16407,3229.9 16679,3208.8"];
	layer1_gate_gpu6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU6
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 6",
		pos="19883,3197.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu6 -> layer1_gate_gpu6	[pos="e,19761,3206 18224,3300.4 18546,3280.6 19417,3227.1 19751,3206.6"];
	layer1_gate_gpu7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Gate_GPU7
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 7",
		pos="22955,3197.5",
		shape=rectangle,
		width=3.3889];
	layer1_attn_norm_gpu7 -> layer1_gate_gpu7	[pos="e,22833,3205.2 21108,3301.2 21458,3281.7 22461,3225.9 22823,3205.8"];
	layer1_expert0_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="107,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_0	[pos="e,194.22,3117.7 1520.8,3195.4 1224.2,3191.9 471.59,3177.6 204.29,3120",
		style=dashed];
	layer1_expert0_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="299,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_1	[pos="e,386.22,3117.7 1520.8,3194.2 1254,3188.4 625.25,3170.1 396.17,3119.9",
		style=dashed];
	layer1_expert0_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="491,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_2	[pos="e,578.23,3117.6 1520.9,3192.6 1286.3,3184.4 779.38,3162.6 588.19,3119.9",
		style=dashed];
	layer1_expert0_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="683,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_3	[pos="e,770.25,3117.6 1520.8,3190.3 1321.3,3179.5 933.31,3155.1 780,3119.9",
		style=dashed];
	layer1_expert0_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="875,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_4	[pos="e,962.01,3117.4 1520.9,3193 1387,3186.9 1166.5,3169.8 971.84,3120",
		style=dashed];
	layer1_expert0_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1067,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_5	[pos="e,1154.1,3117.2 1520.9,3185.2 1425.3,3174.5 1289.4,3155.1 1163.8,3120",
		style=dashed];
	layer1_expert0_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1259,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_6	[pos="e,1346.2,3116.8 1520.7,3168 1471.7,3155.6 1414.7,3140 1355.7,3120.1",
		style=dashed];
	layer1_expert0_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1451,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_7	[pos="e,1517.5,3120 1576.4,3155.9 1560.2,3146 1542.7,3135.3 1526.1,3125.2",
		style=dashed];
	layer1_expert0_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1643,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_8	[pos="e,1643,3120 1643,3155.9 1643,3147.6 1643,3138.8 1643,3130.3",
		style=dashed];
	layer1_expert0_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1835,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_9	[pos="e,1768.5,3120 1709.6,3155.9 1725.8,3146 1743.3,3135.3 1759.9,3125.2",
		style=dashed];
	layer1_expert0_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2027,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_10	[pos="e,1939.8,3116.8 1765.3,3168 1814.3,3155.6 1871.3,3140 1930.3,3120.1",
		style=dashed];
	layer1_expert0_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2219,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_11	[pos="e,2131.9,3117.2 1765.1,3185.2 1860.7,3174.5 1996.6,3155.1 2122.2,3120",
		style=dashed];
	layer1_expert0_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2411,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_12	[pos="e,2324,3117.4 1765.1,3193 1899,3186.9 2119.5,3169.8 2314.2,3120",
		style=dashed];
	layer1_expert0_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2603,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_13	[pos="e,2515.8,3117.6 1765.2,3190.3 1964.7,3179.5 2352.7,3155.1 2506,3119.9",
		style=dashed];
	layer1_expert0_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2795,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_14	[pos="e,2707.8,3117.6 1765.1,3192.6 1999.7,3184.4 2506.6,3162.6 2697.8,3119.9",
		style=dashed];
	layer1_expert0_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2987,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu0 -> layer1_expert0_15	[pos="e,2899.8,3117.7 1765.2,3194.2 2032,3188.4 2660.7,3170.1 2889.8,3119.9",
		style=dashed];
	layer1_moe_agg_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_MoE_Aggregate_GPU0
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 0",
		pos="1643,2967",
		shape=rectangle,
		width=2.8194];
	layer1_expert0_0 -> layer1_moe_agg_gpu0	[pos="e,1541.3,2968.2 194.21,3039.2 197.16,3038.4 200.09,3037.6 203,3037 455.13,2979.6 1238.3,2969.9 1531,2968.3"];
	layer1_expert0_1 -> layer1_moe_agg_gpu0	[pos="e,1541.4,2969.1 386.22,3039.2 389.16,3038.4 392.09,3037.6 395,3037 609.24,2987.4 1266.4,2973.1 1531,2969.2"];
	layer1_expert0_2 -> layer1_moe_agg_gpu0	[pos="e,1541.3,2970.3 578.23,3039.2 581.17,3038.4 584.1,3037.6 587,3037 763.72,2995.2 1297.2,2976.8 1531.1,2970.6"];
	layer1_expert0_3 -> layer1_moe_agg_gpu0	[pos="e,1541.2,2972 770.24,3039.3 773.18,3038.4 776.1,3037.7 779,3037 918.55,3002.9 1330.5,2981.3 1531,2972.5"];
	layer1_expert0_4 -> layer1_moe_agg_gpu0	[pos="e,1541.5,2969.1 962.26,3039.4 965.19,3038.5 968.11,3037.7 971,3037 1163.8,2987.6 1396.3,2973.3 1531.1,2969.4"];
	layer1_expert0_5 -> layer1_moe_agg_gpu0	[pos="e,1541.2,2975 1154,3039.6 1157,3038.7 1160,3037.8 1163,3037 1286.5,3002.6 1432.9,2984.7 1531.3,2975.9"];
	layer1_expert0_6 -> layer1_moe_agg_gpu0	[pos="e,1541.2,2988.1 1346.1,3040 1349.1,3038.9 1352.1,3037.9 1355,3037 1412.3,3018.2 1477.5,3002.1 1531.3,2990.2"];
	layer1_expert0_7 -> layer1_moe_agg_gpu0	[pos="e,1585.1,3001 1522.2,3036.8 1539.9,3026.8 1558.7,3016 1576.1,3006.1"];
	layer1_expert0_8 -> layer1_moe_agg_gpu0	[pos="e,1643,3001.3 1643,3036.7 1643,3028.5 1643,3019.8 1643,3011.5"];
	layer1_expert0_9 -> layer1_moe_agg_gpu0	[pos="e,1700.9,3001 1763.8,3036.8 1746.1,3026.8 1727.3,3016 1709.9,3006.1"];
	layer1_expert0_10 -> layer1_moe_agg_gpu0	[pos="e,1744.8,2988.1 1939.9,3040 1936.9,3038.9 1933.9,3037.9 1931,3037 1873.7,3018.2 1808.5,3002.1 1754.7,2990.2"];
	layer1_expert0_11 -> layer1_moe_agg_gpu0	[pos="e,1744.8,2975 2132,3039.6 2129,3038.7 2126,3037.8 2123,3037 1999.5,3002.6 1853.1,2984.7 1754.7,2975.9"];
	layer1_expert0_12 -> layer1_moe_agg_gpu0	[pos="e,1744.5,2969.1 2323.7,3039.4 2320.8,3038.5 2317.9,3037.7 2315,3037 2122.2,2987.6 1889.7,2973.3 1754.9,2969.4"];
	layer1_expert0_13 -> layer1_moe_agg_gpu0	[pos="e,1744.8,2972 2515.8,3039.3 2512.8,3038.4 2509.9,3037.7 2507,3037 2367.4,3002.9 1955.5,2981.3 1755,2972.5"];
	layer1_expert0_14 -> layer1_moe_agg_gpu0	[pos="e,1744.7,2970.3 2707.8,3039.2 2704.8,3038.4 2701.9,3037.6 2699,3037 2522.3,2995.2 1988.8,2976.8 1754.9,2970.6"];
	layer1_expert0_15 -> layer1_moe_agg_gpu0	[pos="e,1744.6,2969.1 2899.8,3039.2 2896.8,3038.4 2893.9,3037.6 2891,3037 2676.8,2987.4 2019.6,2973.1 1755,2969.2"];
	layer1_moe_allreduce	[height=1.8889,
		label="L1_MoE_All-Reduce
Input: 8×[1024,2048,4096]
Output: [1024,2048,4096]
TP All-Reduce across GPUs 0-7",
		pos="12299,2829",
		width=6.5833];
	layer1_moe_agg_gpu0 -> layer1_moe_allreduce	[pos="e,12075,2832.8 1744.6,2964.7 2731.3,2952.1 10601,2851.6 12065,2832.9"];
	layer1_output_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU0
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 0",
		pos="11382,2691",
		shape=rectangle,
		width=3.3889];
	layer2_qkv_gpu0	[fillcolor=lightgreen,
		height=1.3611,
		label="L2_QKV_Projection_GPU0
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 0-3
TP Slice: 0
GPU: 0",
		pos="11383,2572",
		shape=rectangle,
		width=2.7778];
	layer1_output_gpu0 -> layer2_qkv_gpu0	[pos="e,11383,2621.1 11382,2656.7 11382,2648.8 11382,2640 11383,2631.3"];
	layer1_expert1_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3179,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_0	[pos="e,3266.2,3117.7 4592.8,3195.4 4296.2,3191.9 3543.6,3177.6 3276.3,3120",
		style=dashed];
	layer1_expert1_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3371,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_1	[pos="e,3458.2,3117.7 4592.8,3194.2 4326,3188.4 3697.3,3170.1 3468.2,3119.9",
		style=dashed];
	layer1_expert1_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3563,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_2	[pos="e,3650.2,3117.6 4592.9,3192.6 4358.3,3184.4 3851.4,3162.6 3660.2,3119.9",
		style=dashed];
	layer1_expert1_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3755,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_3	[pos="e,3842.2,3117.6 4592.8,3190.3 4393.3,3179.5 4005.3,3155.1 3852,3119.9",
		style=dashed];
	layer1_expert1_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3947,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_4	[pos="e,4034,3117.4 4592.9,3193 4459,3186.9 4238.5,3169.8 4043.8,3120",
		style=dashed];
	layer1_expert1_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4139,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_5	[pos="e,4226.1,3117.2 4592.9,3185.2 4497.3,3174.5 4361.4,3155.1 4235.8,3120",
		style=dashed];
	layer1_expert1_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4331,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_6	[pos="e,4418.2,3116.8 4592.7,3168 4543.7,3155.6 4486.7,3140 4427.7,3120.1",
		style=dashed];
	layer1_expert1_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4523,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_7	[pos="e,4589.5,3120 4648.4,3155.9 4632.2,3146 4614.7,3135.3 4598.1,3125.2",
		style=dashed];
	layer1_expert1_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4715,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_8	[pos="e,4715,3120 4715,3155.9 4715,3147.6 4715,3138.8 4715,3130.3",
		style=dashed];
	layer1_expert1_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4907,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_9	[pos="e,4840.5,3120 4781.6,3155.9 4797.8,3146 4815.3,3135.3 4831.9,3125.2",
		style=dashed];
	layer1_expert1_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5099,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_10	[pos="e,5011.8,3116.8 4837.3,3168 4886.3,3155.6 4943.3,3140 5002.3,3120.1",
		style=dashed];
	layer1_expert1_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5291,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_11	[pos="e,5203.9,3117.2 4837.1,3185.2 4932.7,3174.5 5068.6,3155.1 5194.2,3120",
		style=dashed];
	layer1_expert1_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5483,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_12	[pos="e,5396,3117.4 4837.1,3193 4971,3186.9 5191.5,3169.8 5386.2,3120",
		style=dashed];
	layer1_expert1_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5675,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_13	[pos="e,5587.8,3117.6 4837.2,3190.3 5036.7,3179.5 5424.7,3155.1 5578,3119.9",
		style=dashed];
	layer1_expert1_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5867,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_14	[pos="e,5779.8,3117.6 4837.1,3192.6 5071.7,3184.4 5578.6,3162.6 5769.8,3119.9",
		style=dashed];
	layer1_expert1_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="6059,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu1 -> layer1_expert1_15	[pos="e,5971.8,3117.7 4837.2,3194.2 5104,3188.4 5732.7,3170.1 5961.8,3119.9",
		style=dashed];
	layer1_moe_agg_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_MoE_Aggregate_GPU1
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 1",
		pos="4715,2967",
		shape=rectangle,
		width=2.8194];
	layer1_expert1_0 -> layer1_moe_agg_gpu1	[pos="e,4613.3,2968.2 3266.2,3039.2 3269.2,3038.4 3272.1,3037.6 3275,3037 3527.1,2979.6 4310.3,2969.9 4603,2968.3"];
	layer1_expert1_1 -> layer1_moe_agg_gpu1	[pos="e,4613.4,2969.1 3458.2,3039.2 3461.2,3038.4 3464.1,3037.6 3467,3037 3681.2,2987.4 4338.4,2973.1 4603,2969.2"];
	layer1_expert1_2 -> layer1_moe_agg_gpu1	[pos="e,4613.3,2970.3 3650.2,3039.2 3653.2,3038.4 3656.1,3037.6 3659,3037 3835.7,2995.2 4369.2,2976.8 4603.1,2970.6"];
	layer1_expert1_3 -> layer1_moe_agg_gpu1	[pos="e,4613.2,2972 3842.2,3039.3 3845.2,3038.4 3848.1,3037.7 3851,3037 3990.6,3002.9 4402.5,2981.3 4603,2972.5"];
	layer1_expert1_4 -> layer1_moe_agg_gpu1	[pos="e,4613.5,2969.1 4034.3,3039.4 4037.2,3038.5 4040.1,3037.7 4043,3037 4235.8,2987.6 4468.3,2973.3 4603.1,2969.4"];
	layer1_expert1_5 -> layer1_moe_agg_gpu1	[pos="e,4613.2,2975 4226,3039.6 4229,3038.7 4232,3037.8 4235,3037 4358.5,3002.6 4504.9,2984.7 4603.3,2975.9"];
	layer1_expert1_6 -> layer1_moe_agg_gpu1	[pos="e,4613.2,2988.1 4418.1,3040 4421.1,3038.9 4424.1,3037.9 4427,3037 4484.3,3018.2 4549.5,3002.1 4603.3,2990.2"];
	layer1_expert1_7 -> layer1_moe_agg_gpu1	[pos="e,4657.1,3001 4594.2,3036.8 4611.9,3026.8 4630.7,3016 4648.1,3006.1"];
	layer1_expert1_8 -> layer1_moe_agg_gpu1	[pos="e,4715,3001.3 4715,3036.7 4715,3028.5 4715,3019.8 4715,3011.5"];
	layer1_expert1_9 -> layer1_moe_agg_gpu1	[pos="e,4772.9,3001 4835.8,3036.8 4818.1,3026.8 4799.3,3016 4781.9,3006.1"];
	layer1_expert1_10 -> layer1_moe_agg_gpu1	[pos="e,4816.8,2988.1 5011.9,3040 5008.9,3038.9 5005.9,3037.9 5003,3037 4945.7,3018.2 4880.5,3002.1 4826.7,2990.2"];
	layer1_expert1_11 -> layer1_moe_agg_gpu1	[pos="e,4816.8,2975 5204,3039.6 5201,3038.7 5198,3037.8 5195,3037 5071.5,3002.6 4925.1,2984.7 4826.7,2975.9"];
	layer1_expert1_12 -> layer1_moe_agg_gpu1	[pos="e,4816.5,2969.1 5395.7,3039.4 5392.8,3038.5 5389.9,3037.7 5387,3037 5194.2,2987.6 4961.7,2973.3 4826.9,2969.4"];
	layer1_expert1_13 -> layer1_moe_agg_gpu1	[pos="e,4816.8,2972 5587.8,3039.3 5584.8,3038.4 5581.9,3037.7 5579,3037 5439.4,3002.9 5027.5,2981.3 4827,2972.5"];
	layer1_expert1_14 -> layer1_moe_agg_gpu1	[pos="e,4816.7,2970.3 5779.8,3039.2 5776.8,3038.4 5773.9,3037.6 5771,3037 5594.3,2995.2 5060.8,2976.8 4826.9,2970.6"];
	layer1_expert1_15 -> layer1_moe_agg_gpu1	[pos="e,4816.6,2969.1 5971.8,3039.2 5968.8,3038.4 5965.9,3037.6 5963,3037 5748.8,2987.4 5091.6,2973.1 4827,2969.2"];
	layer1_moe_agg_gpu1 -> layer1_moe_allreduce	[pos="e,12079,2833.9 4816.8,2964.1 5617.2,2949.8 10896,2855.1 12069,2834.1"];
	layer1_output_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU1
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 1",
		pos="11644,2691",
		shape=rectangle,
		width=3.3889];
	layer2_qkv_gpu1	[fillcolor=lightgreen,
		height=1.3611,
		label="L2_QKV_Projection_GPU1
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 4-7
TP Slice: 1
GPU: 1",
		pos="11645,2572",
		shape=rectangle,
		width=2.7778];
	layer1_output_gpu1 -> layer2_qkv_gpu1	[pos="e,11645,2621.1 11644,2656.7 11644,2648.8 11644,2640 11645,2631.3"];
	layer1_expert2_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="6251,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_0	[pos="e,6338.2,3117.7 7664.8,3195.4 7368.2,3191.9 6615.6,3177.6 6348.3,3120",
		style=dashed];
	layer1_expert2_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="6443,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_1	[pos="e,6530.2,3117.7 7664.8,3194.2 7398,3188.4 6769.3,3170.1 6540.2,3119.9",
		style=dashed];
	layer1_expert2_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="6635,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_2	[pos="e,6722.2,3117.6 7664.9,3192.6 7430.3,3184.4 6923.4,3162.6 6732.2,3119.9",
		style=dashed];
	layer1_expert2_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="6827,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_3	[pos="e,6914.2,3117.6 7664.8,3190.3 7465.3,3179.5 7077.3,3155.1 6924,3119.9",
		style=dashed];
	layer1_expert2_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7019,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_4	[pos="e,7106,3117.4 7664.9,3193 7531,3186.9 7310.5,3169.8 7115.8,3120",
		style=dashed];
	layer1_expert2_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7211,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_5	[pos="e,7298.1,3117.2 7664.9,3185.2 7569.3,3174.5 7433.4,3155.1 7307.8,3120",
		style=dashed];
	layer1_expert2_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7403,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_6	[pos="e,7490.2,3116.8 7664.7,3168 7615.7,3155.6 7558.7,3140 7499.7,3120.1",
		style=dashed];
	layer1_expert2_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7595,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_7	[pos="e,7661.5,3120 7720.4,3155.9 7704.2,3146 7686.7,3135.3 7670.1,3125.2",
		style=dashed];
	layer1_expert2_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7787,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_8	[pos="e,7787,3120 7787,3155.9 7787,3147.6 7787,3138.8 7787,3130.3",
		style=dashed];
	layer1_expert2_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7979,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_9	[pos="e,7912.5,3120 7853.6,3155.9 7869.8,3146 7887.3,3135.3 7903.9,3125.2",
		style=dashed];
	layer1_expert2_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8171,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_10	[pos="e,8083.8,3116.8 7909.3,3168 7958.3,3155.6 8015.3,3140 8074.3,3120.1",
		style=dashed];
	layer1_expert2_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8363,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_11	[pos="e,8275.9,3117.2 7909.1,3185.2 8004.7,3174.5 8140.6,3155.1 8266.2,3120",
		style=dashed];
	layer1_expert2_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8555,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_12	[pos="e,8468,3117.4 7909.1,3193 8043,3186.9 8263.5,3169.8 8458.2,3120",
		style=dashed];
	layer1_expert2_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8747,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_13	[pos="e,8659.8,3117.6 7909.2,3190.3 8108.7,3179.5 8496.7,3155.1 8650,3119.9",
		style=dashed];
	layer1_expert2_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8939,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_14	[pos="e,8851.8,3117.6 7909.1,3192.6 8143.7,3184.4 8650.6,3162.6 8841.8,3119.9",
		style=dashed];
	layer1_expert2_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="9131,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu2 -> layer1_expert2_15	[pos="e,9043.8,3117.7 7909.2,3194.2 8176,3188.4 8804.7,3170.1 9033.8,3119.9",
		style=dashed];
	layer1_moe_agg_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_MoE_Aggregate_GPU2
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 2",
		pos="7787,2967",
		shape=rectangle,
		width=2.8194];
	layer1_expert2_0 -> layer1_moe_agg_gpu2	[pos="e,7685.3,2968.2 6338.2,3039.2 6341.2,3038.4 6344.1,3037.6 6347,3037 6599.1,2979.6 7382.3,2969.9 7675,2968.3"];
	layer1_expert2_1 -> layer1_moe_agg_gpu2	[pos="e,7685.4,2969.1 6530.2,3039.2 6533.2,3038.4 6536.1,3037.6 6539,3037 6753.2,2987.4 7410.4,2973.1 7675,2969.2"];
	layer1_expert2_2 -> layer1_moe_agg_gpu2	[pos="e,7685.3,2970.3 6722.2,3039.2 6725.2,3038.4 6728.1,3037.6 6731,3037 6907.7,2995.2 7441.2,2976.8 7675.1,2970.6"];
	layer1_expert2_3 -> layer1_moe_agg_gpu2	[pos="e,7685.2,2972 6914.2,3039.3 6917.2,3038.4 6920.1,3037.7 6923,3037 7062.6,3002.9 7474.5,2981.3 7675,2972.5"];
	layer1_expert2_4 -> layer1_moe_agg_gpu2	[pos="e,7685.5,2969.1 7106.3,3039.4 7109.2,3038.5 7112.1,3037.7 7115,3037 7307.8,2987.6 7540.3,2973.3 7675.1,2969.4"];
	layer1_expert2_5 -> layer1_moe_agg_gpu2	[pos="e,7685.2,2975 7298,3039.6 7301,3038.7 7304,3037.8 7307,3037 7430.5,3002.6 7576.9,2984.7 7675.3,2975.9"];
	layer1_expert2_6 -> layer1_moe_agg_gpu2	[pos="e,7685.2,2988.1 7490.1,3040 7493.1,3038.9 7496.1,3037.9 7499,3037 7556.3,3018.2 7621.5,3002.1 7675.3,2990.2"];
	layer1_expert2_7 -> layer1_moe_agg_gpu2	[pos="e,7729.1,3001 7666.2,3036.8 7683.9,3026.8 7702.7,3016 7720.1,3006.1"];
	layer1_expert2_8 -> layer1_moe_agg_gpu2	[pos="e,7787,3001.3 7787,3036.7 7787,3028.5 7787,3019.8 7787,3011.5"];
	layer1_expert2_9 -> layer1_moe_agg_gpu2	[pos="e,7844.9,3001 7907.8,3036.8 7890.1,3026.8 7871.3,3016 7853.9,3006.1"];
	layer1_expert2_10 -> layer1_moe_agg_gpu2	[pos="e,7888.8,2988.1 8083.9,3040 8080.9,3038.9 8077.9,3037.9 8075,3037 8017.7,3018.2 7952.5,3002.1 7898.7,2990.2"];
	layer1_expert2_11 -> layer1_moe_agg_gpu2	[pos="e,7888.8,2975 8276,3039.6 8273,3038.7 8270,3037.8 8267,3037 8143.5,3002.6 7997.1,2984.7 7898.7,2975.9"];
	layer1_expert2_12 -> layer1_moe_agg_gpu2	[pos="e,7888.5,2969.1 8467.7,3039.4 8464.8,3038.5 8461.9,3037.7 8459,3037 8266.2,2987.6 8033.7,2973.3 7898.9,2969.4"];
	layer1_expert2_13 -> layer1_moe_agg_gpu2	[pos="e,7888.8,2972 8659.8,3039.3 8656.8,3038.4 8653.9,3037.7 8651,3037 8511.4,3002.9 8099.5,2981.3 7899,2972.5"];
	layer1_expert2_14 -> layer1_moe_agg_gpu2	[pos="e,7888.7,2970.3 8851.8,3039.2 8848.8,3038.4 8845.9,3037.6 8843,3037 8666.3,2995.2 8132.8,2976.8 7898.9,2970.6"];
	layer1_expert2_15 -> layer1_moe_agg_gpu2	[pos="e,7888.6,2969.1 9043.8,3039.2 9040.8,3038.4 9037.9,3037.6 9035,3037 8820.8,2987.4 8163.6,2973.1 7899,2969.2"];
	layer1_moe_agg_gpu2 -> layer1_moe_allreduce	[pos="e,12087,2836.3 7888.6,2962.9 8458.9,2945.7 11264,2861.2 12077,2836.6"];
	layer1_output_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU2
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 2",
		pos="11906,2691",
		shape=rectangle,
		width=3.3889];
	layer2_qkv_gpu2	[fillcolor=lightgreen,
		height=1.3611,
		label="L2_QKV_Projection_GPU2
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 8-11
TP Slice: 2
GPU: 2",
		pos="11907,2572",
		shape=rectangle,
		width=2.7778];
	layer1_output_gpu2 -> layer2_qkv_gpu2	[pos="e,11907,2621.1 11906,2656.7 11906,2648.8 11906,2640 11907,2631.3"];
	layer1_expert3_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="9323,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_0	[pos="e,9410.2,3117.7 10737,3195.4 10440,3191.9 9687.6,3177.6 9420.3,3120",
		style=dashed];
	layer1_expert3_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="9515,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_1	[pos="e,9602.2,3117.7 10737,3194.2 10470,3188.4 9841.3,3170.1 9612.2,3119.9",
		style=dashed];
	layer1_expert3_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="9707,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_2	[pos="e,9794.2,3117.6 10737,3192.6 10502,3184.4 9995.4,3162.6 9804.2,3119.9",
		style=dashed];
	layer1_expert3_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="9899,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_3	[pos="e,9986.2,3117.6 10737,3190.3 10537,3179.5 10149,3155.1 9996,3119.9",
		style=dashed];
	layer1_expert3_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10091,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_4	[pos="e,10178,3117.4 10737,3193 10603,3186.9 10382,3169.8 10188,3120",
		style=dashed];
	layer1_expert3_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10283,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_5	[pos="e,10370,3117.2 10737,3185.2 10641,3174.5 10505,3155.1 10380,3120",
		style=dashed];
	layer1_expert3_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10475,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_6	[pos="e,10562,3116.8 10737,3168 10688,3155.6 10631,3140 10572,3120.1",
		style=dashed];
	layer1_expert3_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10667,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_7	[pos="e,10733,3120 10792,3155.9 10776,3146 10759,3135.3 10742,3125.2",
		style=dashed];
	layer1_expert3_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10859,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_8	[pos="e,10859,3120 10859,3155.9 10859,3147.6 10859,3138.8 10859,3130.3",
		style=dashed];
	layer1_expert3_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11051,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_9	[pos="e,10985,3120 10926,3155.9 10942,3146 10959,3135.3 10976,3125.2",
		style=dashed];
	layer1_expert3_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11243,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_10	[pos="e,11156,3116.8 10981,3168 11030,3155.6 11087,3140 11146,3120.1",
		style=dashed];
	layer1_expert3_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11435,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_11	[pos="e,11348,3117.2 10981,3185.2 11077,3174.5 11213,3155.1 11338,3120",
		style=dashed];
	layer1_expert3_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11627,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_12	[pos="e,11540,3117.4 10981,3193 11115,3186.9 11336,3169.8 11530,3120",
		style=dashed];
	layer1_expert3_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11819,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_13	[pos="e,11732,3117.6 10981,3190.3 11181,3179.5 11569,3155.1 11722,3119.9",
		style=dashed];
	layer1_expert3_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="12011,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_14	[pos="e,11924,3117.6 10981,3192.6 11216,3184.4 11723,3162.6 11914,3119.9",
		style=dashed];
	layer1_expert3_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="12203,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu3 -> layer1_expert3_15	[pos="e,12116,3117.7 10981,3194.2 11248,3188.4 11877,3170.1 12106,3119.9",
		style=dashed];
	layer1_moe_agg_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_MoE_Aggregate_GPU3
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 3",
		pos="10859,2967",
		shape=rectangle,
		width=2.8194];
	layer1_expert3_0 -> layer1_moe_agg_gpu3	[pos="e,10757,2968.2 9410.2,3039.2 9413.2,3038.4 9416.1,3037.6 9419,3037 9671.1,2979.6 10454,2969.9 10747,2968.3"];
	layer1_expert3_1 -> layer1_moe_agg_gpu3	[pos="e,10757,2969.1 9602.2,3039.2 9605.2,3038.4 9608.1,3037.6 9611,3037 9825.2,2987.4 10482,2973.1 10747,2969.2"];
	layer1_expert3_2 -> layer1_moe_agg_gpu3	[pos="e,10757,2970.3 9794.2,3039.2 9797.2,3038.4 9800.1,3037.6 9803,3037 9979.7,2995.2 10513,2976.8 10747,2970.6"];
	layer1_expert3_3 -> layer1_moe_agg_gpu3	[pos="e,10757,2972 9986.2,3039.3 9989.2,3038.4 9992.1,3037.7 9995,3037 10135,3002.9 10547,2981.3 10747,2972.5"];
	layer1_expert3_4 -> layer1_moe_agg_gpu3	[pos="e,10757,2969.1 10178,3039.4 10181,3038.5 10184,3037.7 10187,3037 10380,2987.6 10612,2973.3 10747,2969.4"];
	layer1_expert3_5 -> layer1_moe_agg_gpu3	[pos="e,10757,2975 10370,3039.6 10373,3038.7 10376,3037.8 10379,3037 10503,3002.6 10649,2984.7 10747,2975.9"];
	layer1_expert3_6 -> layer1_moe_agg_gpu3	[pos="e,10757,2988.1 10562,3040 10565,3038.9 10568,3037.9 10571,3037 10628,3018.2 10693,3002.1 10747,2990.2"];
	layer1_expert3_7 -> layer1_moe_agg_gpu3	[pos="e,10801,3001 10738,3036.8 10756,3026.8 10775,3016 10792,3006.1"];
	layer1_expert3_8 -> layer1_moe_agg_gpu3	[pos="e,10859,3001.3 10859,3036.7 10859,3028.5 10859,3019.8 10859,3011.5"];
	layer1_expert3_9 -> layer1_moe_agg_gpu3	[pos="e,10917,3001 10980,3036.8 10962,3026.8 10943,3016 10926,3006.1"];
	layer1_expert3_10 -> layer1_moe_agg_gpu3	[pos="e,10961,2988.1 11156,3040 11153,3038.9 11150,3037.9 11147,3037 11090,3018.2 11025,3002.1 10971,2990.2"];
	layer1_expert3_11 -> layer1_moe_agg_gpu3	[pos="e,10961,2975 11348,3039.6 11345,3038.7 11342,3037.8 11339,3037 11215,3002.6 11069,2984.7 10971,2975.9"];
	layer1_expert3_12 -> layer1_moe_agg_gpu3	[pos="e,10961,2969.1 11540,3039.4 11537,3038.5 11534,3037.7 11531,3037 11338,2987.6 11106,2973.3 10971,2969.4"];
	layer1_expert3_13 -> layer1_moe_agg_gpu3	[pos="e,10961,2972 11732,3039.3 11729,3038.4 11726,3037.7 11723,3037 11583,3002.9 11171,2981.3 10971,2972.5"];
	layer1_expert3_14 -> layer1_moe_agg_gpu3	[pos="e,10961,2970.3 11924,3039.2 11921,3038.4 11918,3037.6 11915,3037 11738,2995.2 11205,2976.8 10971,2970.6"];
	layer1_expert3_15 -> layer1_moe_agg_gpu3	[pos="e,10961,2969.1 12116,3039.2 12113,3038.4 12110,3037.6 12107,3037 11893,2987.4 11236,2973.1 10971,2969.2"];
	layer1_moe_agg_gpu3 -> layer1_moe_allreduce	[pos="e,12123,2846.6 10961,2956.4 11200,2933.7 11805,2876.6 12113,2847.5"];
	layer1_output_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU3
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 3",
		pos="12168,2691",
		shape=rectangle,
		width=3.3889];
	layer2_qkv_gpu3	[fillcolor=lightgreen,
		height=1.3611,
		label="L2_QKV_Projection_GPU3
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 12-15
TP Slice: 3
GPU: 3",
		pos="12168,2572",
		shape=rectangle,
		width=2.7778];
	layer1_output_gpu3 -> layer2_qkv_gpu3	[pos="e,12168,2621.1 12168,2656.7 12168,2648.8 12168,2640 12168,2631.3"];
	layer1_expert4_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="12395,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_0	[pos="e,12482,3117.7 13617,3194.2 13350,3188.4 12721,3170.1 12492,3119.9",
		style=dashed];
	layer1_expert4_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="12587,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_1	[pos="e,12674,3117.6 13617,3192.6 13382,3184.4 12875,3162.6 12684,3119.9",
		style=dashed];
	layer1_expert4_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="12779,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_2	[pos="e,12866,3117.6 13617,3190.3 13417,3179.5 13029,3155.1 12876,3119.9",
		style=dashed];
	layer1_expert4_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="12971,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_3	[pos="e,13058,3117.4 13617,3193 13483,3186.9 13262,3169.8 13068,3120",
		style=dashed];
	layer1_expert4_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13163,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_4	[pos="e,13250,3117.2 13617,3185.2 13521,3174.5 13385,3155.1 13260,3120",
		style=dashed];
	layer1_expert4_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13355,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_5	[pos="e,13442,3116.8 13617,3168 13568,3155.6 13511,3140 13452,3120.1",
		style=dashed];
	layer1_expert4_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13547,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_6	[pos="e,13613,3120 13672,3155.9 13656,3146 13639,3135.3 13622,3125.2",
		style=dashed];
	layer1_expert4_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13739,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_7	[pos="e,13739,3120 13739,3155.9 13739,3147.6 13739,3138.8 13739,3130.3",
		style=dashed];
	layer1_expert4_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13931,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_8	[pos="e,13865,3120 13806,3155.9 13822,3146 13839,3135.3 13856,3125.2",
		style=dashed];
	layer1_expert4_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14123,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_9	[pos="e,14036,3116.8 13861,3168 13910,3155.6 13967,3140 14026,3120.1",
		style=dashed];
	layer1_expert4_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14315,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_10	[pos="e,14228,3117.2 13861,3185.2 13957,3174.5 14093,3155.1 14218,3120",
		style=dashed];
	layer1_expert4_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14507,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_11	[pos="e,14420,3117.4 13861,3193 13995,3186.9 14216,3169.8 14410,3120",
		style=dashed];
	layer1_expert4_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14699,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_12	[pos="e,14612,3117.6 13861,3190.3 14061,3179.5 14449,3155.1 14602,3119.9",
		style=dashed];
	layer1_expert4_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14891,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_13	[pos="e,14804,3117.6 13861,3192.6 14096,3184.4 14603,3162.6 14794,3119.9",
		style=dashed];
	layer1_expert4_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="15083,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_14	[pos="e,14996,3117.7 13861,3194.2 14128,3188.4 14757,3170.1 14986,3119.9",
		style=dashed];
	layer1_expert4_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="15275,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu4 -> layer1_expert4_15	[pos="e,15188,3117.7 13861,3195.4 14158,3191.9 14910,3177.6 15178,3120",
		style=dashed];
	layer1_moe_agg_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_MoE_Aggregate_GPU4
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 4",
		pos="13739,2967",
		shape=rectangle,
		width=2.8194];
	layer1_expert4_0 -> layer1_moe_agg_gpu4	[pos="e,13637,2969.1 12482,3039.2 12485,3038.4 12488,3037.6 12491,3037 12705,2987.4 13362,2973.1 13627,2969.2"];
	layer1_expert4_1 -> layer1_moe_agg_gpu4	[pos="e,13637,2970.3 12674,3039.2 12677,3038.4 12680,3037.6 12683,3037 12860,2995.2 13393,2976.8 13627,2970.6"];
	layer1_expert4_2 -> layer1_moe_agg_gpu4	[pos="e,13637,2972 12866,3039.3 12869,3038.4 12872,3037.7 12875,3037 13015,3002.9 13427,2981.3 13627,2972.5"];
	layer1_expert4_3 -> layer1_moe_agg_gpu4	[pos="e,13637,2969.1 13058,3039.4 13061,3038.5 13064,3037.7 13067,3037 13260,2987.6 13492,2973.3 13627,2969.4"];
	layer1_expert4_4 -> layer1_moe_agg_gpu4	[pos="e,13637,2975 13250,3039.6 13253,3038.7 13256,3037.8 13259,3037 13383,3002.6 13529,2984.7 13627,2975.9"];
	layer1_expert4_5 -> layer1_moe_agg_gpu4	[pos="e,13637,2988.1 13442,3040 13445,3038.9 13448,3037.9 13451,3037 13508,3018.2 13573,3002.1 13627,2990.2"];
	layer1_expert4_6 -> layer1_moe_agg_gpu4	[pos="e,13681,3001 13618,3036.8 13636,3026.8 13655,3016 13672,3006.1"];
	layer1_expert4_7 -> layer1_moe_agg_gpu4	[pos="e,13739,3001.3 13739,3036.7 13739,3028.5 13739,3019.8 13739,3011.5"];
	layer1_expert4_8 -> layer1_moe_agg_gpu4	[pos="e,13797,3001 13860,3036.8 13842,3026.8 13823,3016 13806,3006.1"];
	layer1_expert4_9 -> layer1_moe_agg_gpu4	[pos="e,13841,2988.1 14036,3040 14033,3038.9 14030,3037.9 14027,3037 13970,3018.2 13905,3002.1 13851,2990.2"];
	layer1_expert4_10 -> layer1_moe_agg_gpu4	[pos="e,13841,2975 14228,3039.6 14225,3038.7 14222,3037.8 14219,3037 14095,3002.6 13949,2984.7 13851,2975.9"];
	layer1_expert4_11 -> layer1_moe_agg_gpu4	[pos="e,13841,2969.1 14420,3039.4 14417,3038.5 14414,3037.7 14411,3037 14218,2987.6 13986,2973.3 13851,2969.4"];
	layer1_expert4_12 -> layer1_moe_agg_gpu4	[pos="e,13841,2972 14612,3039.3 14609,3038.4 14606,3037.7 14603,3037 14463,3002.9 14051,2981.3 13851,2972.5"];
	layer1_expert4_13 -> layer1_moe_agg_gpu4	[pos="e,13841,2970.3 14804,3039.2 14801,3038.4 14798,3037.6 14795,3037 14618,2995.2 14085,2976.8 13851,2970.6"];
	layer1_expert4_14 -> layer1_moe_agg_gpu4	[pos="e,13841,2969.1 14996,3039.2 14993,3038.4 14990,3037.6 14987,3037 14773,2987.4 14116,2973.1 13851,2969.2"];
	layer1_expert4_15 -> layer1_moe_agg_gpu4	[pos="e,13841,2968.2 15188,3039.2 15185,3038.4 15182,3037.6 15179,3037 14927,2979.6 14144,2969.9 13851,2968.3"];
	layer1_moe_agg_gpu4 -> layer1_moe_allreduce	[pos="e,12475,2846.6 13637,2956.4 13398,2933.7 12793,2876.6 12485,2847.5"];
	layer1_output_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU4
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 4",
		pos="12430,2691",
		shape=rectangle,
		width=3.3889];
	layer2_qkv_gpu4	[fillcolor=lightgreen,
		height=1.3611,
		label="L2_QKV_Projection_GPU4
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 16-19
TP Slice: 4
GPU: 4",
		pos="12429,2572",
		shape=rectangle,
		width=2.7778];
	layer1_output_gpu4 -> layer2_qkv_gpu4	[pos="e,12429,2621.1 12430,2656.7 12430,2648.8 12430,2640 12429,2631.3"];
	layer1_expert5_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="15467,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_0	[pos="e,15554,3117.7 16689,3194.2 16422,3188.4 15793,3170.1 15564,3119.9",
		style=dashed];
	layer1_expert5_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="15659,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_1	[pos="e,15746,3117.6 16689,3192.6 16454,3184.4 15947,3162.6 15756,3119.9",
		style=dashed];
	layer1_expert5_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="15851,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_2	[pos="e,15938,3117.6 16689,3190.3 16489,3179.5 16101,3155.1 15948,3119.9",
		style=dashed];
	layer1_expert5_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16043,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_3	[pos="e,16130,3117.4 16689,3193 16555,3186.9 16334,3169.8 16140,3120",
		style=dashed];
	layer1_expert5_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16235,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_4	[pos="e,16322,3117.2 16689,3185.2 16593,3174.5 16457,3155.1 16332,3120",
		style=dashed];
	layer1_expert5_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16427,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_5	[pos="e,16514,3116.8 16689,3168 16640,3155.6 16583,3140 16524,3120.1",
		style=dashed];
	layer1_expert5_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16619,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_6	[pos="e,16685,3120 16744,3155.9 16728,3146 16711,3135.3 16694,3125.2",
		style=dashed];
	layer1_expert5_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16811,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_7	[pos="e,16811,3120 16811,3155.9 16811,3147.6 16811,3138.8 16811,3130.3",
		style=dashed];
	layer1_expert5_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17003,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_8	[pos="e,16937,3120 16878,3155.9 16894,3146 16911,3135.3 16928,3125.2",
		style=dashed];
	layer1_expert5_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17195,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_9	[pos="e,17108,3116.8 16933,3168 16982,3155.6 17039,3140 17098,3120.1",
		style=dashed];
	layer1_expert5_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17387,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_10	[pos="e,17300,3117.2 16933,3185.2 17029,3174.5 17165,3155.1 17290,3120",
		style=dashed];
	layer1_expert5_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17579,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_11	[pos="e,17492,3117.4 16933,3193 17067,3186.9 17288,3169.8 17482,3120",
		style=dashed];
	layer1_expert5_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17771,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_12	[pos="e,17684,3117.6 16933,3190.3 17133,3179.5 17521,3155.1 17674,3119.9",
		style=dashed];
	layer1_expert5_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17963,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_13	[pos="e,17876,3117.6 16933,3192.6 17168,3184.4 17675,3162.6 17866,3119.9",
		style=dashed];
	layer1_expert5_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="18155,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_14	[pos="e,18068,3117.7 16933,3194.2 17200,3188.4 17829,3170.1 18058,3119.9",
		style=dashed];
	layer1_expert5_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="18347,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu5 -> layer1_expert5_15	[pos="e,18260,3117.7 16933,3195.4 17230,3191.9 17982,3177.6 18250,3120",
		style=dashed];
	layer1_moe_agg_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_MoE_Aggregate_GPU5
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 5",
		pos="16811,2967",
		shape=rectangle,
		width=2.8194];
	layer1_expert5_0 -> layer1_moe_agg_gpu5	[pos="e,16709,2969.1 15554,3039.2 15557,3038.4 15560,3037.6 15563,3037 15777,2987.4 16434,2973.1 16699,2969.2"];
	layer1_expert5_1 -> layer1_moe_agg_gpu5	[pos="e,16709,2970.3 15746,3039.2 15749,3038.4 15752,3037.6 15755,3037 15932,2995.2 16465,2976.8 16699,2970.6"];
	layer1_expert5_2 -> layer1_moe_agg_gpu5	[pos="e,16709,2972 15938,3039.3 15941,3038.4 15944,3037.7 15947,3037 16087,3002.9 16499,2981.3 16699,2972.5"];
	layer1_expert5_3 -> layer1_moe_agg_gpu5	[pos="e,16709,2969.1 16130,3039.4 16133,3038.5 16136,3037.7 16139,3037 16332,2987.6 16564,2973.3 16699,2969.4"];
	layer1_expert5_4 -> layer1_moe_agg_gpu5	[pos="e,16709,2975 16322,3039.6 16325,3038.7 16328,3037.8 16331,3037 16455,3002.6 16601,2984.7 16699,2975.9"];
	layer1_expert5_5 -> layer1_moe_agg_gpu5	[pos="e,16709,2988.1 16514,3040 16517,3038.9 16520,3037.9 16523,3037 16580,3018.2 16645,3002.1 16699,2990.2"];
	layer1_expert5_6 -> layer1_moe_agg_gpu5	[pos="e,16753,3001 16690,3036.8 16708,3026.8 16727,3016 16744,3006.1"];
	layer1_expert5_7 -> layer1_moe_agg_gpu5	[pos="e,16811,3001.3 16811,3036.7 16811,3028.5 16811,3019.8 16811,3011.5"];
	layer1_expert5_8 -> layer1_moe_agg_gpu5	[pos="e,16869,3001 16932,3036.8 16914,3026.8 16895,3016 16878,3006.1"];
	layer1_expert5_9 -> layer1_moe_agg_gpu5	[pos="e,16913,2988.1 17108,3040 17105,3038.9 17102,3037.9 17099,3037 17042,3018.2 16977,3002.1 16923,2990.2"];
	layer1_expert5_10 -> layer1_moe_agg_gpu5	[pos="e,16913,2975 17300,3039.6 17297,3038.7 17294,3037.8 17291,3037 17167,3002.6 17021,2984.7 16923,2975.9"];
	layer1_expert5_11 -> layer1_moe_agg_gpu5	[pos="e,16913,2969.1 17492,3039.4 17489,3038.5 17486,3037.7 17483,3037 17290,2987.6 17058,2973.3 16923,2969.4"];
	layer1_expert5_12 -> layer1_moe_agg_gpu5	[pos="e,16913,2972 17684,3039.3 17681,3038.4 17678,3037.7 17675,3037 17535,3002.9 17123,2981.3 16923,2972.5"];
	layer1_expert5_13 -> layer1_moe_agg_gpu5	[pos="e,16913,2970.3 17876,3039.2 17873,3038.4 17870,3037.6 17867,3037 17690,2995.2 17157,2976.8 16923,2970.6"];
	layer1_expert5_14 -> layer1_moe_agg_gpu5	[pos="e,16913,2969.1 18068,3039.2 18065,3038.4 18062,3037.6 18059,3037 17845,2987.4 17188,2973.1 16923,2969.2"];
	layer1_expert5_15 -> layer1_moe_agg_gpu5	[pos="e,16913,2968.2 18260,3039.2 18257,3038.4 18254,3037.6 18251,3037 17999,2979.6 17216,2969.9 16923,2968.3"];
	layer1_moe_agg_gpu5 -> layer1_moe_allreduce	[pos="e,12511,2836.3 16709,2962.9 16139,2945.7 13334,2861.2 12521,2836.6"];
	layer1_output_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU5
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 5",
		pos="12692,2691",
		shape=rectangle,
		width=3.3889];
	layer2_qkv_gpu5	[fillcolor=lightgreen,
		height=1.3611,
		label="L2_QKV_Projection_GPU5
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 20-23
TP Slice: 5
GPU: 5",
		pos="12691,2572",
		shape=rectangle,
		width=2.7778];
	layer1_output_gpu5 -> layer2_qkv_gpu5	[pos="e,12691,2621.1 12692,2656.7 12692,2648.8 12692,2640 12691,2631.3"];
	layer1_expert6_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="18539,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_0	[pos="e,18626,3117.7 19761,3194.2 19494,3188.4 18865,3170.1 18636,3119.9",
		style=dashed];
	layer1_expert6_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="18731,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_1	[pos="e,18818,3117.6 19761,3192.6 19526,3184.4 19019,3162.6 18828,3119.9",
		style=dashed];
	layer1_expert6_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="18923,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_2	[pos="e,19010,3117.6 19761,3190.3 19561,3179.5 19173,3155.1 19020,3119.9",
		style=dashed];
	layer1_expert6_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19115,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_3	[pos="e,19202,3117.4 19761,3193 19627,3186.9 19406,3169.8 19212,3120",
		style=dashed];
	layer1_expert6_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19307,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_4	[pos="e,19394,3117.2 19761,3185.2 19665,3174.5 19529,3155.1 19404,3120",
		style=dashed];
	layer1_expert6_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19499,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_5	[pos="e,19586,3116.8 19761,3168 19712,3155.6 19655,3140 19596,3120.1",
		style=dashed];
	layer1_expert6_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19691,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_6	[pos="e,19757,3120 19816,3155.9 19800,3146 19783,3135.3 19766,3125.2",
		style=dashed];
	layer1_expert6_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19883,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_7	[pos="e,19883,3120 19883,3155.9 19883,3147.6 19883,3138.8 19883,3130.3",
		style=dashed];
	layer1_expert6_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20075,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_8	[pos="e,20009,3120 19950,3155.9 19966,3146 19983,3135.3 20000,3125.2",
		style=dashed];
	layer1_expert6_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20267,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_9	[pos="e,20180,3116.8 20005,3168 20054,3155.6 20111,3140 20170,3120.1",
		style=dashed];
	layer1_expert6_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20459,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_10	[pos="e,20372,3117.2 20005,3185.2 20101,3174.5 20237,3155.1 20362,3120",
		style=dashed];
	layer1_expert6_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20651,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_11	[pos="e,20564,3117.4 20005,3193 20139,3186.9 20360,3169.8 20554,3120",
		style=dashed];
	layer1_expert6_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20843,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_12	[pos="e,20756,3117.6 20005,3190.3 20205,3179.5 20593,3155.1 20746,3119.9",
		style=dashed];
	layer1_expert6_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="21035,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_13	[pos="e,20948,3117.6 20005,3192.6 20240,3184.4 20747,3162.6 20938,3119.9",
		style=dashed];
	layer1_expert6_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="21227,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_14	[pos="e,21140,3117.7 20005,3194.2 20272,3188.4 20901,3170.1 21130,3119.9",
		style=dashed];
	layer1_expert6_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="21419,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu6 -> layer1_expert6_15	[pos="e,21332,3117.7 20005,3195.4 20302,3191.9 21054,3177.6 21322,3120",
		style=dashed];
	layer1_moe_agg_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_MoE_Aggregate_GPU6
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 6",
		pos="19883,2967",
		shape=rectangle,
		width=2.8194];
	layer1_expert6_0 -> layer1_moe_agg_gpu6	[pos="e,19781,2969.1 18626,3039.2 18629,3038.4 18632,3037.6 18635,3037 18849,2987.4 19506,2973.1 19771,2969.2"];
	layer1_expert6_1 -> layer1_moe_agg_gpu6	[pos="e,19781,2970.3 18818,3039.2 18821,3038.4 18824,3037.6 18827,3037 19004,2995.2 19537,2976.8 19771,2970.6"];
	layer1_expert6_2 -> layer1_moe_agg_gpu6	[pos="e,19781,2972 19010,3039.3 19013,3038.4 19016,3037.7 19019,3037 19159,3002.9 19571,2981.3 19771,2972.5"];
	layer1_expert6_3 -> layer1_moe_agg_gpu6	[pos="e,19781,2969.1 19202,3039.4 19205,3038.5 19208,3037.7 19211,3037 19404,2987.6 19636,2973.3 19771,2969.4"];
	layer1_expert6_4 -> layer1_moe_agg_gpu6	[pos="e,19781,2975 19394,3039.6 19397,3038.7 19400,3037.8 19403,3037 19527,3002.6 19673,2984.7 19771,2975.9"];
	layer1_expert6_5 -> layer1_moe_agg_gpu6	[pos="e,19781,2988.1 19586,3040 19589,3038.9 19592,3037.9 19595,3037 19652,3018.2 19717,3002.1 19771,2990.2"];
	layer1_expert6_6 -> layer1_moe_agg_gpu6	[pos="e,19825,3001 19762,3036.8 19780,3026.8 19799,3016 19816,3006.1"];
	layer1_expert6_7 -> layer1_moe_agg_gpu6	[pos="e,19883,3001.3 19883,3036.7 19883,3028.5 19883,3019.8 19883,3011.5"];
	layer1_expert6_8 -> layer1_moe_agg_gpu6	[pos="e,19941,3001 20004,3036.8 19986,3026.8 19967,3016 19950,3006.1"];
	layer1_expert6_9 -> layer1_moe_agg_gpu6	[pos="e,19985,2988.1 20180,3040 20177,3038.9 20174,3037.9 20171,3037 20114,3018.2 20049,3002.1 19995,2990.2"];
	layer1_expert6_10 -> layer1_moe_agg_gpu6	[pos="e,19985,2975 20372,3039.6 20369,3038.7 20366,3037.8 20363,3037 20239,3002.6 20093,2984.7 19995,2975.9"];
	layer1_expert6_11 -> layer1_moe_agg_gpu6	[pos="e,19985,2969.1 20564,3039.4 20561,3038.5 20558,3037.7 20555,3037 20362,2987.6 20130,2973.3 19995,2969.4"];
	layer1_expert6_12 -> layer1_moe_agg_gpu6	[pos="e,19985,2972 20756,3039.3 20753,3038.4 20750,3037.7 20747,3037 20607,3002.9 20195,2981.3 19995,2972.5"];
	layer1_expert6_13 -> layer1_moe_agg_gpu6	[pos="e,19985,2970.3 20948,3039.2 20945,3038.4 20942,3037.6 20939,3037 20762,2995.2 20229,2976.8 19995,2970.6"];
	layer1_expert6_14 -> layer1_moe_agg_gpu6	[pos="e,19985,2969.1 21140,3039.2 21137,3038.4 21134,3037.6 21131,3037 20917,2987.4 20260,2973.1 19995,2969.2"];
	layer1_expert6_15 -> layer1_moe_agg_gpu6	[pos="e,19985,2968.2 21332,3039.2 21329,3038.4 21326,3037.6 21323,3037 21071,2979.6 20288,2969.9 19995,2968.3"];
	layer1_moe_agg_gpu6 -> layer1_moe_allreduce	[pos="e,12519,2833.9 19781,2964.1 18981,2949.8 13702,2855.1 12529,2834.1"];
	layer1_output_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU6
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 6",
		pos="12954,2691",
		shape=rectangle,
		width=3.3889];
	layer2_qkv_gpu6	[fillcolor=lightgreen,
		height=1.3611,
		label="L2_QKV_Projection_GPU6
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 24-27
TP Slice: 6
GPU: 6",
		pos="12954,2572",
		shape=rectangle,
		width=2.7778];
	layer1_output_gpu6 -> layer2_qkv_gpu6	[pos="e,12954,2621.1 12954,2656.7 12954,2648.8 12954,2640 12954,2631.3"];
	layer1_expert7_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert0_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="21611,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_0	[pos="e,21698,3117.7 22833,3194.2 22566,3188.4 21937,3170.1 21708,3119.9",
		style=dashed];
	layer1_expert7_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert1_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="21803,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_1	[pos="e,21890,3117.6 22833,3192.6 22598,3184.4 22091,3162.6 21900,3119.9",
		style=dashed];
	layer1_expert7_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert2_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="21995,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_2	[pos="e,22082,3117.6 22833,3190.3 22633,3179.5 22245,3155.1 22092,3119.9",
		style=dashed];
	layer1_expert7_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert3_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22187,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_3	[pos="e,22274,3117.4 22833,3193 22699,3186.9 22478,3169.8 22284,3120",
		style=dashed];
	layer1_expert7_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert4_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22379,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_4	[pos="e,22466,3117.2 22833,3185.2 22737,3174.5 22601,3155.1 22476,3120",
		style=dashed];
	layer1_expert7_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert5_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22571,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_5	[pos="e,22658,3116.8 22833,3168 22784,3155.6 22727,3140 22668,3120.1",
		style=dashed];
	layer1_expert7_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert6_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22763,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_6	[pos="e,22829,3120 22888,3155.9 22872,3146 22855,3135.3 22838,3125.2",
		style=dashed];
	layer1_expert7_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert7_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22955,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_7	[pos="e,22955,3120 22955,3155.9 22955,3147.6 22955,3138.8 22955,3130.3",
		style=dashed];
	layer1_expert7_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert8_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23147,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_8	[pos="e,23081,3120 23022,3155.9 23038,3146 23055,3135.3 23072,3125.2",
		style=dashed];
	layer1_expert7_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert9_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23339,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_9	[pos="e,23252,3116.8 23077,3168 23126,3155.6 23183,3140 23242,3120.1",
		style=dashed];
	layer1_expert7_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert10_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23531,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_10	[pos="e,23444,3117.2 23077,3185.2 23173,3174.5 23309,3155.1 23434,3120",
		style=dashed];
	layer1_expert7_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert11_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23723,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_11	[pos="e,23636,3117.4 23077,3193 23211,3186.9 23432,3169.8 23626,3120",
		style=dashed];
	layer1_expert7_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert12_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23915,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_12	[pos="e,23828,3117.6 23077,3190.3 23277,3179.5 23665,3155.1 23818,3119.9",
		style=dashed];
	layer1_expert7_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert13_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="24107,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_13	[pos="e,24020,3117.6 23077,3192.6 23312,3184.4 23819,3162.6 24010,3119.9",
		style=dashed];
	layer1_expert7_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert14_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="24299,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_14	[pos="e,24212,3117.7 23077,3194.2 23344,3188.4 23973,3170.1 24202,3119.9",
		style=dashed];
	layer1_expert7_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L1_Expert15_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="24491,3078.5",
		shape=rectangle,
		width=2.4167];
	layer1_gate_gpu7 -> layer1_expert7_15	[pos="e,24404,3117.7 23077,3195.4 23374,3191.9 24126,3177.6 24394,3120",
		style=dashed];
	layer1_moe_agg_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_MoE_Aggregate_GPU7
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 7",
		pos="22955,2967",
		shape=rectangle,
		width=2.8194];
	layer1_expert7_0 -> layer1_moe_agg_gpu7	[pos="e,22853,2969.1 21698,3039.2 21701,3038.4 21704,3037.6 21707,3037 21921,2987.4 22578,2973.1 22843,2969.2"];
	layer1_expert7_1 -> layer1_moe_agg_gpu7	[pos="e,22853,2970.3 21890,3039.2 21893,3038.4 21896,3037.6 21899,3037 22076,2995.2 22609,2976.8 22843,2970.6"];
	layer1_expert7_2 -> layer1_moe_agg_gpu7	[pos="e,22853,2972 22082,3039.3 22085,3038.4 22088,3037.7 22091,3037 22231,3002.9 22643,2981.3 22843,2972.5"];
	layer1_expert7_3 -> layer1_moe_agg_gpu7	[pos="e,22853,2969.1 22274,3039.4 22277,3038.5 22280,3037.7 22283,3037 22476,2987.6 22708,2973.3 22843,2969.4"];
	layer1_expert7_4 -> layer1_moe_agg_gpu7	[pos="e,22853,2975 22466,3039.6 22469,3038.7 22472,3037.8 22475,3037 22599,3002.6 22745,2984.7 22843,2975.9"];
	layer1_expert7_5 -> layer1_moe_agg_gpu7	[pos="e,22853,2988.1 22658,3040 22661,3038.9 22664,3037.9 22667,3037 22724,3018.2 22789,3002.1 22843,2990.2"];
	layer1_expert7_6 -> layer1_moe_agg_gpu7	[pos="e,22897,3001 22834,3036.8 22852,3026.8 22871,3016 22888,3006.1"];
	layer1_expert7_7 -> layer1_moe_agg_gpu7	[pos="e,22955,3001.3 22955,3036.7 22955,3028.5 22955,3019.8 22955,3011.5"];
	layer1_expert7_8 -> layer1_moe_agg_gpu7	[pos="e,23013,3001 23076,3036.8 23058,3026.8 23039,3016 23022,3006.1"];
	layer1_expert7_9 -> layer1_moe_agg_gpu7	[pos="e,23057,2988.1 23252,3040 23249,3038.9 23246,3037.9 23243,3037 23186,3018.2 23121,3002.1 23067,2990.2"];
	layer1_expert7_10 -> layer1_moe_agg_gpu7	[pos="e,23057,2975 23444,3039.6 23441,3038.7 23438,3037.8 23435,3037 23311,3002.6 23165,2984.7 23067,2975.9"];
	layer1_expert7_11 -> layer1_moe_agg_gpu7	[pos="e,23057,2969.1 23636,3039.4 23633,3038.5 23630,3037.7 23627,3037 23434,2987.6 23202,2973.3 23067,2969.4"];
	layer1_expert7_12 -> layer1_moe_agg_gpu7	[pos="e,23057,2972 23828,3039.3 23825,3038.4 23822,3037.7 23819,3037 23679,3002.9 23267,2981.3 23067,2972.5"];
	layer1_expert7_13 -> layer1_moe_agg_gpu7	[pos="e,23057,2970.3 24020,3039.2 24017,3038.4 24014,3037.6 24011,3037 23834,2995.2 23301,2976.8 23067,2970.6"];
	layer1_expert7_14 -> layer1_moe_agg_gpu7	[pos="e,23057,2969.1 24212,3039.2 24209,3038.4 24206,3037.6 24203,3037 23989,2987.4 23332,2973.1 23067,2969.2"];
	layer1_expert7_15 -> layer1_moe_agg_gpu7	[pos="e,23057,2968.2 24404,3039.2 24401,3038.4 24398,3037.6 24395,3037 24143,2979.6 23360,2969.9 23067,2968.3"];
	layer1_moe_agg_gpu7 -> layer1_moe_allreduce	[pos="e,12523,2832.8 22853,2964.7 21867,2952.1 13997,2851.6 12533,2832.9"];
	layer1_output_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L1_Residual+LayerNorm_GPU7
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 7",
		pos="13216,2691",
		shape=rectangle,
		width=3.3889];
	layer2_qkv_gpu7	[fillcolor=lightgreen,
		height=1.3611,
		label="L2_QKV_Projection_GPU7
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 28-31
TP Slice: 7
GPU: 7",
		pos="13215,2572",
		shape=rectangle,
		width=2.7778];
	layer1_output_gpu7 -> layer2_qkv_gpu7	[pos="e,13215,2621.1 13216,2656.7 13216,2648.8 13216,2640 13215,2631.3"];
	layer1_moe_allreduce -> layer1_output_gpu0	[pos="e,11504,2723.2 12124,2811 11967,2794.3 11729,2765.7 11514,2725.1"];
	layer1_moe_allreduce -> layer1_output_gpu1	[pos="e,11766,2723 12156,2801.9 12053,2782.7 11911,2755.1 11776,2725.2"];
	layer1_moe_allreduce -> layer1_output_gpu2	[pos="e,12001,2725 12193,2791.2 12136,2771.7 12067,2747.8 12011,2728.3"];
	layer1_moe_allreduce -> layer1_output_gpu3	[pos="e,12200,2725.1 12248,2775.4 12235,2761.1 12220,2745.9 12207,2732.4"];
	layer1_moe_allreduce -> layer1_output_gpu4	[pos="e,12398,2725.1 12350,2775.4 12363,2761.1 12378,2745.9 12391,2732.4"];
	layer1_moe_allreduce -> layer1_output_gpu5	[pos="e,12597,2725 12405,2791.2 12462,2771.7 12531,2747.8 12587,2728.3"];
	layer1_moe_allreduce -> layer1_output_gpu6	[pos="e,12832,2723 12442,2801.9 12545,2782.7 12687,2755.1 12822,2725.2"];
	layer1_moe_allreduce -> layer1_output_gpu7	[pos="e,13094,2723.2 12474,2811 12631,2794.3 12869,2765.7 13084,2725.1"];
	layer2_attn_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU0
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 0",
		pos="11384,2453",
		shape=rectangle,
		width=3.375];
	layer2_qkv_gpu0 -> layer2_attn_gpu0	[pos="e,11384,2487.1 11383,2522.7 11383,2514.3 11384,2505.6 11384,2497.3"];
	layer2_attn_proj_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Attn_Projection_GPU0
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 0",
		pos="11439,2349",
		shape=rectangle,
		width=2.7778];
	layer2_attn_gpu0 -> layer2_attn_proj_gpu0	[pos="e,11421,2383.3 11402,2418.8 11406,2410.4 11411,2401.2 11416,2392.3"];
	layer2_attn_allreduce	[height=1.8889,
		label="L2_Attention_All-Reduce
Input: 8×[1024,2048,512]
Output: [1024,2048,4096]
TP All-Reduce across GPUs 0-7",
		pos="12288,2211",
		width=6.5833];
	layer2_attn_proj_gpu0 -> layer2_attn_allreduce	[pos="e,12120,2230.9 11539,2321.4 11549,2319.1 11559,2316.9 11569,2315 11752,2278.7 11964,2249.9 12110,2232.1"];
	layer2_attn_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU1
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 1",
		pos="11646,2453",
		shape=rectangle,
		width=3.375];
	layer2_qkv_gpu1 -> layer2_attn_gpu1	[pos="e,11646,2487.1 11645,2522.7 11645,2514.3 11646,2505.6 11646,2497.3"];
	layer2_attn_proj_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Attn_Projection_GPU1
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 1",
		pos="11678,2349",
		shape=rectangle,
		width=2.7778];
	layer2_attn_gpu1 -> layer2_attn_proj_gpu1	[pos="e,11668,2383.3 11656,2418.8 11659,2410.6 11662,2401.5 11665,2392.9"];
	layer2_attn_proj_gpu1 -> layer2_attn_allreduce	[pos="e,12156,2241.3 11778,2325.6 11878,2303.3 12034,2268.6 12147,2243.5"];
	layer2_attn_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU2
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 2",
		pos="11907,2453",
		shape=rectangle,
		width=3.375];
	layer2_qkv_gpu2 -> layer2_attn_gpu2	[pos="e,11907,2487.1 11907,2522.7 11907,2514.3 11907,2505.6 11907,2497.3"];
	layer2_attn_proj_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Attn_Projection_GPU2
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 2",
		pos="11940,2349",
		shape=rectangle,
		width=2.7778];
	layer2_attn_gpu2 -> layer2_attn_proj_gpu2	[pos="e,11929,2383.3 11918,2418.8 11920,2410.6 11923,2401.5 11926,2392.9"];
	layer2_attn_proj_gpu2 -> layer2_attn_allreduce	[pos="e,12189,2250.6 12025,2314.9 12071,2296.7 12130,2273.9 12179,2254.4"];
	layer2_attn_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU3
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 3",
		pos="12168,2453",
		shape=rectangle,
		width=3.375];
	layer2_qkv_gpu3 -> layer2_attn_gpu3	[pos="e,12168,2487.1 12168,2522.7 12168,2514.3 12168,2505.6 12168,2497.3"];
	layer2_attn_proj_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Attn_Projection_GPU3
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 3",
		pos="12179,2349",
		shape=rectangle,
		width=2.7778];
	layer2_attn_gpu3 -> layer2_attn_proj_gpu3	[pos="e,12175,2383.3 12172,2418.8 12172,2410.7 12173,2401.9 12174,2393.4"];
	layer2_attn_proj_gpu3 -> layer2_attn_allreduce	[pos="e,12244,2266.6 12206,2314.7 12215,2302.6 12227,2288.5 12238,2274.7"];
	layer2_attn_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU4
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 4",
		pos="12429,2453",
		shape=rectangle,
		width=3.375];
	layer2_qkv_gpu4 -> layer2_attn_gpu4	[pos="e,12429,2487.1 12429,2522.7 12429,2514.3 12429,2505.6 12429,2497.3"];
	layer2_attn_proj_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Attn_Projection_GPU4
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 4",
		pos="12418,2349",
		shape=rectangle,
		width=2.7778];
	layer2_attn_gpu4 -> layer2_attn_proj_gpu4	[pos="e,12422,2383.3 12425,2418.8 12425,2410.7 12424,2401.9 12423,2393.4"];
	layer2_attn_proj_gpu4 -> layer2_attn_allreduce	[pos="e,12338,2264.7 12386,2314.7 12374,2301.9 12360,2286.9 12346,2272.3"];
	layer2_attn_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU5
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 5",
		pos="12691,2453",
		shape=rectangle,
		width=3.375];
	layer2_qkv_gpu5 -> layer2_attn_gpu5	[pos="e,12691,2487.1 12691,2522.7 12691,2514.3 12691,2505.6 12691,2497.3"];
	layer2_attn_proj_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Attn_Projection_GPU5
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 5",
		pos="12668,2349",
		shape=rectangle,
		width=2.7778];
	layer2_attn_gpu5 -> layer2_attn_proj_gpu5	[pos="e,12676,2383.3 12684,2418.8 12682,2410.6 12680,2401.7 12678,2393.1"];
	layer2_attn_proj_gpu5 -> layer2_attn_allreduce	[pos="e,12392,2249.2 12576,2314.9 12523,2296.1 12457,2272.5 12401,2252.6"];
	layer2_attn_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU6
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 6",
		pos="12953,2453",
		shape=rectangle,
		width=3.375];
	layer2_qkv_gpu6 -> layer2_attn_gpu6	[pos="e,12953,2487.1 12954,2522.7 12954,2514.3 12953,2505.6 12953,2497.3"];
	layer2_attn_proj_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Attn_Projection_GPU6
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 6",
		pos="12924,2349",
		shape=rectangle,
		width=2.7778];
	layer2_attn_gpu6 -> layer2_attn_proj_gpu6	[pos="e,12933,2383.3 12944,2418.8 12941,2410.6 12939,2401.7 12936,2393.1"];
	layer2_attn_proj_gpu6 -> layer2_attn_allreduce	[pos="e,12424,2240.1 12824,2325.2 12808,2321.8 12792,2318.2 12777,2315 12662,2289.9 12531,2262.4 12434,2242.1"];
	layer2_attn_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Multi-Head_Attention_GPU7
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 7",
		pos="13215,2453",
		shape=rectangle,
		width=3.375];
	layer2_qkv_gpu7 -> layer2_attn_gpu7	[pos="e,13215,2487.1 13215,2522.7 13215,2514.3 13215,2505.6 13215,2497.3"];
	layer2_attn_proj_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Attn_Projection_GPU7
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 7",
		pos="13182,2349",
		shape=rectangle,
		width=2.7778];
	layer2_attn_gpu7 -> layer2_attn_proj_gpu7	[pos="e,13193,2383.3 13204,2418.8 13202,2410.6 13199,2401.5 13196,2392.9"];
	layer2_attn_proj_gpu7 -> layer2_attn_allreduce	[pos="e,12455,2231.1 13082,2324.6 13065,2321.1 13049,2317.8 13033,2315 12840,2280.3 12617,2250.8 12465,2232.4"];
	layer2_attn_norm_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU0
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="5848,2073",
		shape=rectangle,
		width=3.3889];
	layer2_attn_allreduce -> layer2_attn_norm_gpu0	[pos="e,5970.2,2076.5 12070,2205.4 11053,2183.9 6788.1,2093.8 5980.4,2076.7"];
	layer2_attn_norm_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU1
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="7818,2073",
		shape=rectangle,
		width=3.3889];
	layer2_attn_allreduce -> layer2_attn_norm_gpu1	[pos="e,7940.1,2077.7 12077,2203.5 11295,2179.7 8581.7,2097.2 7950.1,2078"];
	layer2_attn_norm_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU2
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="10187,2073",
		shape=rectangle,
		width=3.3889];
	layer2_attn_allreduce -> layer2_attn_norm_gpu2	[pos="e,10309,2081.9 12097,2197.6 11677,2170.4 10679,2105.8 10319,2082.5"];
	layer2_attn_norm_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU3
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="11503,2073",
		shape=rectangle,
		width=3.3889];
	layer2_attn_allreduce -> layer2_attn_norm_gpu3	[pos="e,11625,2095.1 12142,2184.7 11997,2159.5 11775,2121.2 11635,2096.8"];
	layer2_attn_norm_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU4
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="13074,2073",
		shape=rectangle,
		width=3.3889];
	layer2_attn_allreduce -> layer2_attn_norm_gpu4	[pos="e,12952,2095.1 12434,2184.7 12580,2159.5 12801,2121.1 12942,2096.8"];
	layer2_attn_norm_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU5
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="15395,2073",
		shape=rectangle,
		width=3.3889];
	layer2_attn_allreduce -> layer2_attn_norm_gpu5	[pos="e,15273,2079.3 12491,2201.1 13079,2175.3 14775,2101.1 15263,2079.8"];
	layer2_attn_norm_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU6
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="18092,2073",
		shape=rectangle,
		width=3.3889];
	layer2_attn_allreduce -> layer2_attn_norm_gpu6	[pos="e,17970,2076.8 12504,2204.9 13449,2182.7 17206,2094.7 17960,2077"];
	layer2_attn_norm_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU7
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="20976,2073",
		shape=rectangle,
		width=3.3889];
	layer2_attn_allreduce -> layer2_attn_norm_gpu7	[pos="e,20854,2075.9 12510,2206.5 13755,2187 19865,2091.4 20844,2076"];
	layer2_gate_gpu0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU0
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 0",
		pos="1633,1961.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu0 -> layer2_gate_gpu0	[pos="e,1755,1965.6 5725.8,2068.8 5115.2,2052.9 2398.1,1982.3 1765.1,1965.9"];
	layer2_gate_gpu1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU1
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 1",
		pos="4705,1961.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu1 -> layer2_gate_gpu1	[pos="e,4827,1966.7 7696,2067.7 7201.5,2050.3 5349.4,1985.1 4837.1,1967.1"];
	layer2_gate_gpu2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU2
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 2",
		pos="7777,1961.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu2 -> layer2_gate_gpu2	[pos="e,7899.3,1968 10065,2066.4 9654.9,2047.8 8333.7,1987.7 7909.4,1968.5"];
	layer2_gate_gpu3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU3
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 3",
		pos="10849,1961.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu3 -> layer2_gate_gpu3	[pos="e,10971,1982.9 11381,2051.5 11267,2032.4 11098,2004.2 10981,1984.6"];
	layer2_gate_gpu4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU4
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 4",
		pos="13729,1961.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu4 -> layer2_gate_gpu4	[pos="e,13607,1982.9 13196,2051.5 13310,2032.5 13480,2004.2 13597,1984.6"];
	layer2_gate_gpu5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU5
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 5",
		pos="16801,1961.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu5 -> layer2_gate_gpu5	[pos="e,16679,1972 15517,2062.5 15780,2042 16397,1993.9 16669,1972.8"];
	layer2_gate_gpu6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU6
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 6",
		pos="19873,1961.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu6 -> layer2_gate_gpu6	[pos="e,19751,1970 18214,2064.4 18536,2044.6 19407,1991.1 19741,1970.6"];
	layer2_gate_gpu7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Gate_GPU7
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 7",
		pos="22945,1961.5",
		shape=rectangle,
		width=3.3889];
	layer2_attn_norm_gpu7 -> layer2_gate_gpu7	[pos="e,22823,1969.2 21098,2065.2 21448,2045.7 22451,1989.9 22813,1969.8"];
	layer2_expert0_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="97,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu0 -> layer2_expert0_0	[pos="e,184.22,1881.7 1510.8,1959.4 1214.2,1955.9 461.59,1941.6 194.29,1884",
		style=dashed];
	layer2_expert0_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="289,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu0 -> layer2_expert0_1	[pos="e,376.22,1881.7 1510.8,1958.2 1244,1952.4 615.25,1934.1 386.17,1883.9",
		style=dashed];
	layer2_expert0_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="481,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu0 -> layer2_expert0_2	[pos="e,568.23,1881.6 1510.9,1956.6 1276.3,1948.4 769.38,1926.6 578.19,1883.9",
		style=dashed];
	layer2_expert0_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="673,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu0 -> layer2_expert0_3	[pos="e,760.25,1881.6 1510.8,1954.3 1311.3,1943.5 923.31,1919.1 770,1883.9",
		style=dashed];
	layer2_expert0_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="865,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu0 -> layer2_expert0_4	[pos="e,952.01,1881.4 1510.9,1957 1377,1950.9 1156.5,1933.8 961.84,1884",
		style=dashed];
	layer2_expert0_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1057,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu0 -> layer2_expert0_5	[pos="e,1144.1,1881.2 1510.9,1949.2 1415.3,1938.5 1279.4,1919.1 1153.8,1884",
		style=dashed];
	layer2_expert0_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1249,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu0 -> layer2_expert0_6	[pos="e,1336.2,1880.8 1510.7,1932 1461.7,1919.6 1404.7,1904 1345.7,1884.1",
		style=dashed];
	layer2_expert0_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1441,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu0 -> layer2_expert0_7	[pos="e,1507.5,1884 1566.4,1919.9 1550.2,1910 1532.7,1899.3 1516.1,1889.2",
		style=dashed];
	layer2_expert0_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1633,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu0 -> layer2_expert0_8	[pos="e,1633,1884 1633,1919.9 1633,1911.6 1633,1902.8 1633,1894.3",
		style=dashed];
	layer2_expert0_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1825,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu0 -> layer2_expert0_9	[pos="e,1758.5,1884 1699.6,1919.9 1715.8,1910 1733.3,1899.3 1749.9,1889.2",
		style=dashed];
	layer2_expert0_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2017,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu0 -> layer2_expert0_10	[pos="e,1929.8,1880.8 1755.3,1932 1804.3,1919.6 1861.3,1904 1920.3,1884.1",
		style=dashed];
	layer2_expert0_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2209,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu0 -> layer2_expert0_11	[pos="e,2121.9,1881.2 1755.1,1949.2 1850.7,1938.5 1986.6,1919.1 2112.2,1884",
		style=dashed];
	layer2_expert0_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2401,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu0 -> layer2_expert0_12	[pos="e,2314,1881.4 1755.1,1957 1889,1950.9 2109.5,1933.8 2304.2,1884",
		style=dashed];
	layer2_expert0_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2593,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu0 -> layer2_expert0_13	[pos="e,2505.8,1881.6 1755.2,1954.3 1954.7,1943.5 2342.7,1919.1 2496,1883.9",
		style=dashed];
	layer2_expert0_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2785,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu0 -> layer2_expert0_14	[pos="e,2697.8,1881.6 1755.1,1956.6 1989.7,1948.4 2496.6,1926.6 2687.8,1883.9",
		style=dashed];
	layer2_expert0_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2977,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu0 -> layer2_expert0_15	[pos="e,2889.8,1881.7 1755.2,1958.2 2022,1952.4 2650.7,1934.1 2879.8,1883.9",
		style=dashed];
	layer2_moe_agg_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_MoE_Aggregate_GPU0
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 0",
		pos="1633,1731",
		shape=rectangle,
		width=2.8194];
	layer2_expert0_0 -> layer2_moe_agg_gpu0	[pos="e,1531.3,1732.2 184.21,1803.2 187.16,1802.4 190.09,1801.6 193,1801 445.13,1743.6 1228.3,1733.9 1521,1732.3"];
	layer2_expert0_1 -> layer2_moe_agg_gpu0	[pos="e,1531.4,1733.1 376.22,1803.2 379.16,1802.4 382.09,1801.6 385,1801 599.24,1751.4 1256.4,1737.1 1521,1733.2"];
	layer2_expert0_2 -> layer2_moe_agg_gpu0	[pos="e,1531.3,1734.3 568.23,1803.2 571.17,1802.4 574.1,1801.6 577,1801 753.72,1759.2 1287.2,1740.8 1521.1,1734.6"];
	layer2_expert0_3 -> layer2_moe_agg_gpu0	[pos="e,1531.2,1736 760.24,1803.3 763.18,1802.4 766.1,1801.7 769,1801 908.55,1766.9 1320.5,1745.3 1521,1736.5"];
	layer2_expert0_4 -> layer2_moe_agg_gpu0	[pos="e,1531.5,1733.1 952.26,1803.4 955.19,1802.5 958.11,1801.7 961,1801 1153.8,1751.6 1386.3,1737.3 1521.1,1733.4"];
	layer2_expert0_5 -> layer2_moe_agg_gpu0	[pos="e,1531.2,1739 1144,1803.6 1147,1802.7 1150,1801.8 1153,1801 1276.5,1766.6 1422.9,1748.7 1521.3,1739.9"];
	layer2_expert0_6 -> layer2_moe_agg_gpu0	[pos="e,1531.2,1752.1 1336.1,1804 1339.1,1802.9 1342.1,1801.9 1345,1801 1402.3,1782.2 1467.5,1766.1 1521.3,1754.2"];
	layer2_expert0_7 -> layer2_moe_agg_gpu0	[pos="e,1575.1,1765 1512.2,1800.8 1529.9,1790.8 1548.7,1780 1566.1,1770.1"];
	layer2_expert0_8 -> layer2_moe_agg_gpu0	[pos="e,1633,1765.3 1633,1800.7 1633,1792.5 1633,1783.8 1633,1775.5"];
	layer2_expert0_9 -> layer2_moe_agg_gpu0	[pos="e,1690.9,1765 1753.8,1800.8 1736.1,1790.8 1717.3,1780 1699.9,1770.1"];
	layer2_expert0_10 -> layer2_moe_agg_gpu0	[pos="e,1734.8,1752.1 1929.9,1804 1926.9,1802.9 1923.9,1801.9 1921,1801 1863.7,1782.2 1798.5,1766.1 1744.7,1754.2"];
	layer2_expert0_11 -> layer2_moe_agg_gpu0	[pos="e,1734.8,1739 2122,1803.6 2119,1802.7 2116,1801.8 2113,1801 1989.5,1766.6 1843.1,1748.7 1744.7,1739.9"];
	layer2_expert0_12 -> layer2_moe_agg_gpu0	[pos="e,1734.5,1733.1 2313.7,1803.4 2310.8,1802.5 2307.9,1801.7 2305,1801 2112.2,1751.6 1879.7,1737.3 1744.9,1733.4"];
	layer2_expert0_13 -> layer2_moe_agg_gpu0	[pos="e,1734.8,1736 2505.8,1803.3 2502.8,1802.4 2499.9,1801.7 2497,1801 2357.4,1766.9 1945.5,1745.3 1745,1736.5"];
	layer2_expert0_14 -> layer2_moe_agg_gpu0	[pos="e,1734.7,1734.3 2697.8,1803.2 2694.8,1802.4 2691.9,1801.6 2689,1801 2512.3,1759.2 1978.8,1740.8 1744.9,1734.6"];
	layer2_expert0_15 -> layer2_moe_agg_gpu0	[pos="e,1734.6,1733.1 2889.8,1803.2 2886.8,1802.4 2883.9,1801.6 2881,1801 2666.8,1751.4 2009.6,1737.1 1745,1733.2"];
	layer2_moe_allreduce	[height=1.8889,
		label="L2_MoE_All-Reduce
Input: 8×[1024,2048,4096]
Output: [1024,2048,4096]
TP All-Reduce across GPUs 0-7",
		pos="12289,1593",
		width=6.5833];
	layer2_moe_agg_gpu0 -> layer2_moe_allreduce	[pos="e,12065,1596.8 1734.6,1728.7 2721.3,1716.1 10591,1615.6 12055,1596.9"];
	layer2_output_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU0
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 0",
		pos="11372,1455",
		shape=rectangle,
		width=3.3889];
	layer3_qkv_gpu0	[fillcolor=lightgreen,
		height=1.3611,
		label="L3_QKV_Projection_GPU0
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 0-3
TP Slice: 0
GPU: 0",
		pos="11373,1336",
		shape=rectangle,
		width=2.7778];
	layer2_output_gpu0 -> layer3_qkv_gpu0	[pos="e,11373,1385.1 11372,1420.7 11372,1412.8 11372,1404 11373,1395.3"];
	layer2_expert1_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3169,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu1 -> layer2_expert1_0	[pos="e,3256.2,1881.7 4582.8,1959.4 4286.2,1955.9 3533.6,1941.6 3266.3,1884",
		style=dashed];
	layer2_expert1_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3361,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu1 -> layer2_expert1_1	[pos="e,3448.2,1881.7 4582.8,1958.2 4316,1952.4 3687.3,1934.1 3458.2,1883.9",
		style=dashed];
	layer2_expert1_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3553,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu1 -> layer2_expert1_2	[pos="e,3640.2,1881.6 4582.9,1956.6 4348.3,1948.4 3841.4,1926.6 3650.2,1883.9",
		style=dashed];
	layer2_expert1_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3745,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu1 -> layer2_expert1_3	[pos="e,3832.2,1881.6 4582.8,1954.3 4383.3,1943.5 3995.3,1919.1 3842,1883.9",
		style=dashed];
	layer2_expert1_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3937,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu1 -> layer2_expert1_4	[pos="e,4024,1881.4 4582.9,1957 4449,1950.9 4228.5,1933.8 4033.8,1884",
		style=dashed];
	layer2_expert1_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4129,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu1 -> layer2_expert1_5	[pos="e,4216.1,1881.2 4582.9,1949.2 4487.3,1938.5 4351.4,1919.1 4225.8,1884",
		style=dashed];
	layer2_expert1_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4321,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu1 -> layer2_expert1_6	[pos="e,4408.2,1880.8 4582.7,1932 4533.7,1919.6 4476.7,1904 4417.7,1884.1",
		style=dashed];
	layer2_expert1_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4513,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu1 -> layer2_expert1_7	[pos="e,4579.5,1884 4638.4,1919.9 4622.2,1910 4604.7,1899.3 4588.1,1889.2",
		style=dashed];
	layer2_expert1_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4705,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu1 -> layer2_expert1_8	[pos="e,4705,1884 4705,1919.9 4705,1911.6 4705,1902.8 4705,1894.3",
		style=dashed];
	layer2_expert1_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4897,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu1 -> layer2_expert1_9	[pos="e,4830.5,1884 4771.6,1919.9 4787.8,1910 4805.3,1899.3 4821.9,1889.2",
		style=dashed];
	layer2_expert1_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5089,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu1 -> layer2_expert1_10	[pos="e,5001.8,1880.8 4827.3,1932 4876.3,1919.6 4933.3,1904 4992.3,1884.1",
		style=dashed];
	layer2_expert1_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5281,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu1 -> layer2_expert1_11	[pos="e,5193.9,1881.2 4827.1,1949.2 4922.7,1938.5 5058.6,1919.1 5184.2,1884",
		style=dashed];
	layer2_expert1_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5473,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu1 -> layer2_expert1_12	[pos="e,5386,1881.4 4827.1,1957 4961,1950.9 5181.5,1933.8 5376.2,1884",
		style=dashed];
	layer2_expert1_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5665,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu1 -> layer2_expert1_13	[pos="e,5577.8,1881.6 4827.2,1954.3 5026.7,1943.5 5414.7,1919.1 5568,1883.9",
		style=dashed];
	layer2_expert1_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5857,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu1 -> layer2_expert1_14	[pos="e,5769.8,1881.6 4827.1,1956.6 5061.7,1948.4 5568.6,1926.6 5759.8,1883.9",
		style=dashed];
	layer2_expert1_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="6049,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu1 -> layer2_expert1_15	[pos="e,5961.8,1881.7 4827.2,1958.2 5094,1952.4 5722.7,1934.1 5951.8,1883.9",
		style=dashed];
	layer2_moe_agg_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_MoE_Aggregate_GPU1
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 1",
		pos="4705,1731",
		shape=rectangle,
		width=2.8194];
	layer2_expert1_0 -> layer2_moe_agg_gpu1	[pos="e,4603.3,1732.2 3256.2,1803.2 3259.2,1802.4 3262.1,1801.6 3265,1801 3517.1,1743.6 4300.3,1733.9 4593,1732.3"];
	layer2_expert1_1 -> layer2_moe_agg_gpu1	[pos="e,4603.4,1733.1 3448.2,1803.2 3451.2,1802.4 3454.1,1801.6 3457,1801 3671.2,1751.4 4328.4,1737.1 4593,1733.2"];
	layer2_expert1_2 -> layer2_moe_agg_gpu1	[pos="e,4603.3,1734.3 3640.2,1803.2 3643.2,1802.4 3646.1,1801.6 3649,1801 3825.7,1759.2 4359.2,1740.8 4593.1,1734.6"];
	layer2_expert1_3 -> layer2_moe_agg_gpu1	[pos="e,4603.2,1736 3832.2,1803.3 3835.2,1802.4 3838.1,1801.7 3841,1801 3980.6,1766.9 4392.5,1745.3 4593,1736.5"];
	layer2_expert1_4 -> layer2_moe_agg_gpu1	[pos="e,4603.5,1733.1 4024.3,1803.4 4027.2,1802.5 4030.1,1801.7 4033,1801 4225.8,1751.6 4458.3,1737.3 4593.1,1733.4"];
	layer2_expert1_5 -> layer2_moe_agg_gpu1	[pos="e,4603.2,1739 4216,1803.6 4219,1802.7 4222,1801.8 4225,1801 4348.5,1766.6 4494.9,1748.7 4593.3,1739.9"];
	layer2_expert1_6 -> layer2_moe_agg_gpu1	[pos="e,4603.2,1752.1 4408.1,1804 4411.1,1802.9 4414.1,1801.9 4417,1801 4474.3,1782.2 4539.5,1766.1 4593.3,1754.2"];
	layer2_expert1_7 -> layer2_moe_agg_gpu1	[pos="e,4647.1,1765 4584.2,1800.8 4601.9,1790.8 4620.7,1780 4638.1,1770.1"];
	layer2_expert1_8 -> layer2_moe_agg_gpu1	[pos="e,4705,1765.3 4705,1800.7 4705,1792.5 4705,1783.8 4705,1775.5"];
	layer2_expert1_9 -> layer2_moe_agg_gpu1	[pos="e,4762.9,1765 4825.8,1800.8 4808.1,1790.8 4789.3,1780 4771.9,1770.1"];
	layer2_expert1_10 -> layer2_moe_agg_gpu1	[pos="e,4806.8,1752.1 5001.9,1804 4998.9,1802.9 4995.9,1801.9 4993,1801 4935.7,1782.2 4870.5,1766.1 4816.7,1754.2"];
	layer2_expert1_11 -> layer2_moe_agg_gpu1	[pos="e,4806.8,1739 5194,1803.6 5191,1802.7 5188,1801.8 5185,1801 5061.5,1766.6 4915.1,1748.7 4816.7,1739.9"];
	layer2_expert1_12 -> layer2_moe_agg_gpu1	[pos="e,4806.5,1733.1 5385.7,1803.4 5382.8,1802.5 5379.9,1801.7 5377,1801 5184.2,1751.6 4951.7,1737.3 4816.9,1733.4"];
	layer2_expert1_13 -> layer2_moe_agg_gpu1	[pos="e,4806.8,1736 5577.8,1803.3 5574.8,1802.4 5571.9,1801.7 5569,1801 5429.4,1766.9 5017.5,1745.3 4817,1736.5"];
	layer2_expert1_14 -> layer2_moe_agg_gpu1	[pos="e,4806.7,1734.3 5769.8,1803.2 5766.8,1802.4 5763.9,1801.6 5761,1801 5584.3,1759.2 5050.8,1740.8 4816.9,1734.6"];
	layer2_expert1_15 -> layer2_moe_agg_gpu1	[pos="e,4806.6,1733.1 5961.8,1803.2 5958.8,1802.4 5955.9,1801.6 5953,1801 5738.8,1751.4 5081.6,1737.1 4817,1733.2"];
	layer2_moe_agg_gpu1 -> layer2_moe_allreduce	[pos="e,12069,1597.9 4806.8,1728.1 5607.2,1713.8 10886,1619.1 12059,1598.1"];
	layer2_output_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU1
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 1",
		pos="11634,1455",
		shape=rectangle,
		width=3.3889];
	layer3_qkv_gpu1	[fillcolor=lightgreen,
		height=1.3611,
		label="L3_QKV_Projection_GPU1
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 4-7
TP Slice: 1
GPU: 1",
		pos="11635,1336",
		shape=rectangle,
		width=2.7778];
	layer2_output_gpu1 -> layer3_qkv_gpu1	[pos="e,11635,1385.1 11634,1420.7 11634,1412.8 11634,1404 11635,1395.3"];
	layer2_expert2_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="6241,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu2 -> layer2_expert2_0	[pos="e,6328.2,1881.7 7654.8,1959.4 7358.2,1955.9 6605.6,1941.6 6338.3,1884",
		style=dashed];
	layer2_expert2_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="6433,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu2 -> layer2_expert2_1	[pos="e,6520.2,1881.7 7654.8,1958.2 7388,1952.4 6759.3,1934.1 6530.2,1883.9",
		style=dashed];
	layer2_expert2_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="6625,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu2 -> layer2_expert2_2	[pos="e,6712.2,1881.6 7654.9,1956.6 7420.3,1948.4 6913.4,1926.6 6722.2,1883.9",
		style=dashed];
	layer2_expert2_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="6817,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu2 -> layer2_expert2_3	[pos="e,6904.2,1881.6 7654.8,1954.3 7455.3,1943.5 7067.3,1919.1 6914,1883.9",
		style=dashed];
	layer2_expert2_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7009,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu2 -> layer2_expert2_4	[pos="e,7096,1881.4 7654.9,1957 7521,1950.9 7300.5,1933.8 7105.8,1884",
		style=dashed];
	layer2_expert2_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7201,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu2 -> layer2_expert2_5	[pos="e,7288.1,1881.2 7654.9,1949.2 7559.3,1938.5 7423.4,1919.1 7297.8,1884",
		style=dashed];
	layer2_expert2_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7393,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu2 -> layer2_expert2_6	[pos="e,7480.2,1880.8 7654.7,1932 7605.7,1919.6 7548.7,1904 7489.7,1884.1",
		style=dashed];
	layer2_expert2_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7585,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu2 -> layer2_expert2_7	[pos="e,7651.5,1884 7710.4,1919.9 7694.2,1910 7676.7,1899.3 7660.1,1889.2",
		style=dashed];
	layer2_expert2_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7777,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu2 -> layer2_expert2_8	[pos="e,7777,1884 7777,1919.9 7777,1911.6 7777,1902.8 7777,1894.3",
		style=dashed];
	layer2_expert2_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7969,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu2 -> layer2_expert2_9	[pos="e,7902.5,1884 7843.6,1919.9 7859.8,1910 7877.3,1899.3 7893.9,1889.2",
		style=dashed];
	layer2_expert2_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8161,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu2 -> layer2_expert2_10	[pos="e,8073.8,1880.8 7899.3,1932 7948.3,1919.6 8005.3,1904 8064.3,1884.1",
		style=dashed];
	layer2_expert2_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8353,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu2 -> layer2_expert2_11	[pos="e,8265.9,1881.2 7899.1,1949.2 7994.7,1938.5 8130.6,1919.1 8256.2,1884",
		style=dashed];
	layer2_expert2_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8545,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu2 -> layer2_expert2_12	[pos="e,8458,1881.4 7899.1,1957 8033,1950.9 8253.5,1933.8 8448.2,1884",
		style=dashed];
	layer2_expert2_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8737,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu2 -> layer2_expert2_13	[pos="e,8649.8,1881.6 7899.2,1954.3 8098.7,1943.5 8486.7,1919.1 8640,1883.9",
		style=dashed];
	layer2_expert2_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8929,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu2 -> layer2_expert2_14	[pos="e,8841.8,1881.6 7899.1,1956.6 8133.7,1948.4 8640.6,1926.6 8831.8,1883.9",
		style=dashed];
	layer2_expert2_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="9121,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu2 -> layer2_expert2_15	[pos="e,9033.8,1881.7 7899.2,1958.2 8166,1952.4 8794.7,1934.1 9023.8,1883.9",
		style=dashed];
	layer2_moe_agg_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_MoE_Aggregate_GPU2
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 2",
		pos="7777,1731",
		shape=rectangle,
		width=2.8194];
	layer2_expert2_0 -> layer2_moe_agg_gpu2	[pos="e,7675.3,1732.2 6328.2,1803.2 6331.2,1802.4 6334.1,1801.6 6337,1801 6589.1,1743.6 7372.3,1733.9 7665,1732.3"];
	layer2_expert2_1 -> layer2_moe_agg_gpu2	[pos="e,7675.4,1733.1 6520.2,1803.2 6523.2,1802.4 6526.1,1801.6 6529,1801 6743.2,1751.4 7400.4,1737.1 7665,1733.2"];
	layer2_expert2_2 -> layer2_moe_agg_gpu2	[pos="e,7675.3,1734.3 6712.2,1803.2 6715.2,1802.4 6718.1,1801.6 6721,1801 6897.7,1759.2 7431.2,1740.8 7665.1,1734.6"];
	layer2_expert2_3 -> layer2_moe_agg_gpu2	[pos="e,7675.2,1736 6904.2,1803.3 6907.2,1802.4 6910.1,1801.7 6913,1801 7052.6,1766.9 7464.5,1745.3 7665,1736.5"];
	layer2_expert2_4 -> layer2_moe_agg_gpu2	[pos="e,7675.5,1733.1 7096.3,1803.4 7099.2,1802.5 7102.1,1801.7 7105,1801 7297.8,1751.6 7530.3,1737.3 7665.1,1733.4"];
	layer2_expert2_5 -> layer2_moe_agg_gpu2	[pos="e,7675.2,1739 7288,1803.6 7291,1802.7 7294,1801.8 7297,1801 7420.5,1766.6 7566.9,1748.7 7665.3,1739.9"];
	layer2_expert2_6 -> layer2_moe_agg_gpu2	[pos="e,7675.2,1752.1 7480.1,1804 7483.1,1802.9 7486.1,1801.9 7489,1801 7546.3,1782.2 7611.5,1766.1 7665.3,1754.2"];
	layer2_expert2_7 -> layer2_moe_agg_gpu2	[pos="e,7719.1,1765 7656.2,1800.8 7673.9,1790.8 7692.7,1780 7710.1,1770.1"];
	layer2_expert2_8 -> layer2_moe_agg_gpu2	[pos="e,7777,1765.3 7777,1800.7 7777,1792.5 7777,1783.8 7777,1775.5"];
	layer2_expert2_9 -> layer2_moe_agg_gpu2	[pos="e,7834.9,1765 7897.8,1800.8 7880.1,1790.8 7861.3,1780 7843.9,1770.1"];
	layer2_expert2_10 -> layer2_moe_agg_gpu2	[pos="e,7878.8,1752.1 8073.9,1804 8070.9,1802.9 8067.9,1801.9 8065,1801 8007.7,1782.2 7942.5,1766.1 7888.7,1754.2"];
	layer2_expert2_11 -> layer2_moe_agg_gpu2	[pos="e,7878.8,1739 8266,1803.6 8263,1802.7 8260,1801.8 8257,1801 8133.5,1766.6 7987.1,1748.7 7888.7,1739.9"];
	layer2_expert2_12 -> layer2_moe_agg_gpu2	[pos="e,7878.5,1733.1 8457.7,1803.4 8454.8,1802.5 8451.9,1801.7 8449,1801 8256.2,1751.6 8023.7,1737.3 7888.9,1733.4"];
	layer2_expert2_13 -> layer2_moe_agg_gpu2	[pos="e,7878.8,1736 8649.8,1803.3 8646.8,1802.4 8643.9,1801.7 8641,1801 8501.4,1766.9 8089.5,1745.3 7889,1736.5"];
	layer2_expert2_14 -> layer2_moe_agg_gpu2	[pos="e,7878.7,1734.3 8841.8,1803.2 8838.8,1802.4 8835.9,1801.6 8833,1801 8656.3,1759.2 8122.8,1740.8 7888.9,1734.6"];
	layer2_expert2_15 -> layer2_moe_agg_gpu2	[pos="e,7878.6,1733.1 9033.8,1803.2 9030.8,1802.4 9027.9,1801.6 9025,1801 8810.8,1751.4 8153.6,1737.1 7889,1733.2"];
	layer2_moe_agg_gpu2 -> layer2_moe_allreduce	[pos="e,12077,1600.3 7878.6,1726.9 8448.9,1709.7 11254,1625.2 12067,1600.6"];
	layer2_output_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU2
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 2",
		pos="11896,1455",
		shape=rectangle,
		width=3.3889];
	layer3_qkv_gpu2	[fillcolor=lightgreen,
		height=1.3611,
		label="L3_QKV_Projection_GPU2
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 8-11
TP Slice: 2
GPU: 2",
		pos="11897,1336",
		shape=rectangle,
		width=2.7778];
	layer2_output_gpu2 -> layer3_qkv_gpu2	[pos="e,11897,1385.1 11896,1420.7 11896,1412.8 11896,1404 11897,1395.3"];
	layer2_expert3_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="9313,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu3 -> layer2_expert3_0	[pos="e,9400.2,1881.7 10727,1959.4 10430,1955.9 9677.6,1941.6 9410.3,1884",
		style=dashed];
	layer2_expert3_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="9505,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu3 -> layer2_expert3_1	[pos="e,9592.2,1881.7 10727,1958.2 10460,1952.4 9831.3,1934.1 9602.2,1883.9",
		style=dashed];
	layer2_expert3_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="9697,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu3 -> layer2_expert3_2	[pos="e,9784.2,1881.6 10727,1956.6 10492,1948.4 9985.4,1926.6 9794.2,1883.9",
		style=dashed];
	layer2_expert3_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="9889,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu3 -> layer2_expert3_3	[pos="e,9976.2,1881.6 10727,1954.3 10527,1943.5 10139,1919.1 9986,1883.9",
		style=dashed];
	layer2_expert3_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10081,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu3 -> layer2_expert3_4	[pos="e,10168,1881.4 10727,1957 10593,1950.9 10372,1933.8 10178,1884",
		style=dashed];
	layer2_expert3_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10273,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu3 -> layer2_expert3_5	[pos="e,10360,1881.2 10727,1949.2 10631,1938.5 10495,1919.1 10370,1884",
		style=dashed];
	layer2_expert3_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10465,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu3 -> layer2_expert3_6	[pos="e,10552,1880.8 10727,1932 10678,1919.6 10621,1904 10562,1884.1",
		style=dashed];
	layer2_expert3_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10657,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu3 -> layer2_expert3_7	[pos="e,10723,1884 10782,1919.9 10766,1910 10749,1899.3 10732,1889.2",
		style=dashed];
	layer2_expert3_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10849,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu3 -> layer2_expert3_8	[pos="e,10849,1884 10849,1919.9 10849,1911.6 10849,1902.8 10849,1894.3",
		style=dashed];
	layer2_expert3_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11041,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu3 -> layer2_expert3_9	[pos="e,10975,1884 10916,1919.9 10932,1910 10949,1899.3 10966,1889.2",
		style=dashed];
	layer2_expert3_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11233,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu3 -> layer2_expert3_10	[pos="e,11146,1880.8 10971,1932 11020,1919.6 11077,1904 11136,1884.1",
		style=dashed];
	layer2_expert3_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11425,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu3 -> layer2_expert3_11	[pos="e,11338,1881.2 10971,1949.2 11067,1938.5 11203,1919.1 11328,1884",
		style=dashed];
	layer2_expert3_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11617,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu3 -> layer2_expert3_12	[pos="e,11530,1881.4 10971,1957 11105,1950.9 11326,1933.8 11520,1884",
		style=dashed];
	layer2_expert3_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11809,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu3 -> layer2_expert3_13	[pos="e,11722,1881.6 10971,1954.3 11171,1943.5 11559,1919.1 11712,1883.9",
		style=dashed];
	layer2_expert3_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="12001,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu3 -> layer2_expert3_14	[pos="e,11914,1881.6 10971,1956.6 11206,1948.4 11713,1926.6 11904,1883.9",
		style=dashed];
	layer2_expert3_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="12193,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu3 -> layer2_expert3_15	[pos="e,12106,1881.7 10971,1958.2 11238,1952.4 11867,1934.1 12096,1883.9",
		style=dashed];
	layer2_moe_agg_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_MoE_Aggregate_GPU3
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 3",
		pos="10849,1731",
		shape=rectangle,
		width=2.8194];
	layer2_expert3_0 -> layer2_moe_agg_gpu3	[pos="e,10747,1732.2 9400.2,1803.2 9403.2,1802.4 9406.1,1801.6 9409,1801 9661.1,1743.6 10444,1733.9 10737,1732.3"];
	layer2_expert3_1 -> layer2_moe_agg_gpu3	[pos="e,10747,1733.1 9592.2,1803.2 9595.2,1802.4 9598.1,1801.6 9601,1801 9815.2,1751.4 10472,1737.1 10737,1733.2"];
	layer2_expert3_2 -> layer2_moe_agg_gpu3	[pos="e,10747,1734.3 9784.2,1803.2 9787.2,1802.4 9790.1,1801.6 9793,1801 9969.7,1759.2 10503,1740.8 10737,1734.6"];
	layer2_expert3_3 -> layer2_moe_agg_gpu3	[pos="e,10747,1736 9976.2,1803.3 9979.2,1802.4 9982.1,1801.7 9985,1801 10125,1766.9 10537,1745.3 10737,1736.5"];
	layer2_expert3_4 -> layer2_moe_agg_gpu3	[pos="e,10747,1733.1 10168,1803.4 10171,1802.5 10174,1801.7 10177,1801 10370,1751.6 10602,1737.3 10737,1733.4"];
	layer2_expert3_5 -> layer2_moe_agg_gpu3	[pos="e,10747,1739 10360,1803.6 10363,1802.7 10366,1801.8 10369,1801 10493,1766.6 10639,1748.7 10737,1739.9"];
	layer2_expert3_6 -> layer2_moe_agg_gpu3	[pos="e,10747,1752.1 10552,1804 10555,1802.9 10558,1801.9 10561,1801 10618,1782.2 10683,1766.1 10737,1754.2"];
	layer2_expert3_7 -> layer2_moe_agg_gpu3	[pos="e,10791,1765 10728,1800.8 10746,1790.8 10765,1780 10782,1770.1"];
	layer2_expert3_8 -> layer2_moe_agg_gpu3	[pos="e,10849,1765.3 10849,1800.7 10849,1792.5 10849,1783.8 10849,1775.5"];
	layer2_expert3_9 -> layer2_moe_agg_gpu3	[pos="e,10907,1765 10970,1800.8 10952,1790.8 10933,1780 10916,1770.1"];
	layer2_expert3_10 -> layer2_moe_agg_gpu3	[pos="e,10951,1752.1 11146,1804 11143,1802.9 11140,1801.9 11137,1801 11080,1782.2 11015,1766.1 10961,1754.2"];
	layer2_expert3_11 -> layer2_moe_agg_gpu3	[pos="e,10951,1739 11338,1803.6 11335,1802.7 11332,1801.8 11329,1801 11205,1766.6 11059,1748.7 10961,1739.9"];
	layer2_expert3_12 -> layer2_moe_agg_gpu3	[pos="e,10951,1733.1 11530,1803.4 11527,1802.5 11524,1801.7 11521,1801 11328,1751.6 11096,1737.3 10961,1733.4"];
	layer2_expert3_13 -> layer2_moe_agg_gpu3	[pos="e,10951,1736 11722,1803.3 11719,1802.4 11716,1801.7 11713,1801 11573,1766.9 11161,1745.3 10961,1736.5"];
	layer2_expert3_14 -> layer2_moe_agg_gpu3	[pos="e,10951,1734.3 11914,1803.2 11911,1802.4 11908,1801.6 11905,1801 11728,1759.2 11195,1740.8 10961,1734.6"];
	layer2_expert3_15 -> layer2_moe_agg_gpu3	[pos="e,10951,1733.1 12106,1803.2 12103,1802.4 12100,1801.6 12097,1801 11883,1751.4 11226,1737.1 10961,1733.2"];
	layer2_moe_agg_gpu3 -> layer2_moe_allreduce	[pos="e,12113,1610.6 10951,1720.4 11190,1697.7 11795,1640.6 12103,1611.5"];
	layer2_output_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU3
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 3",
		pos="12158,1455",
		shape=rectangle,
		width=3.3889];
	layer3_qkv_gpu3	[fillcolor=lightgreen,
		height=1.3611,
		label="L3_QKV_Projection_GPU3
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 12-15
TP Slice: 3
GPU: 3",
		pos="12158,1336",
		shape=rectangle,
		width=2.7778];
	layer2_output_gpu3 -> layer3_qkv_gpu3	[pos="e,12158,1385.1 12158,1420.7 12158,1412.8 12158,1404 12158,1395.3"];
	layer2_expert4_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="12385,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu4 -> layer2_expert4_0	[pos="e,12472,1881.7 13607,1958.2 13340,1952.4 12711,1934.1 12482,1883.9",
		style=dashed];
	layer2_expert4_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="12577,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu4 -> layer2_expert4_1	[pos="e,12664,1881.6 13607,1956.6 13372,1948.4 12865,1926.6 12674,1883.9",
		style=dashed];
	layer2_expert4_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="12769,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu4 -> layer2_expert4_2	[pos="e,12856,1881.6 13607,1954.3 13407,1943.5 13019,1919.1 12866,1883.9",
		style=dashed];
	layer2_expert4_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="12961,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu4 -> layer2_expert4_3	[pos="e,13048,1881.4 13607,1957 13473,1950.9 13252,1933.8 13058,1884",
		style=dashed];
	layer2_expert4_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13153,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu4 -> layer2_expert4_4	[pos="e,13240,1881.2 13607,1949.2 13511,1938.5 13375,1919.1 13250,1884",
		style=dashed];
	layer2_expert4_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13345,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu4 -> layer2_expert4_5	[pos="e,13432,1880.8 13607,1932 13558,1919.6 13501,1904 13442,1884.1",
		style=dashed];
	layer2_expert4_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13537,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu4 -> layer2_expert4_6	[pos="e,13603,1884 13662,1919.9 13646,1910 13629,1899.3 13612,1889.2",
		style=dashed];
	layer2_expert4_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13729,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu4 -> layer2_expert4_7	[pos="e,13729,1884 13729,1919.9 13729,1911.6 13729,1902.8 13729,1894.3",
		style=dashed];
	layer2_expert4_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13921,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu4 -> layer2_expert4_8	[pos="e,13855,1884 13796,1919.9 13812,1910 13829,1899.3 13846,1889.2",
		style=dashed];
	layer2_expert4_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14113,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu4 -> layer2_expert4_9	[pos="e,14026,1880.8 13851,1932 13900,1919.6 13957,1904 14016,1884.1",
		style=dashed];
	layer2_expert4_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14305,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu4 -> layer2_expert4_10	[pos="e,14218,1881.2 13851,1949.2 13947,1938.5 14083,1919.1 14208,1884",
		style=dashed];
	layer2_expert4_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14497,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu4 -> layer2_expert4_11	[pos="e,14410,1881.4 13851,1957 13985,1950.9 14206,1933.8 14400,1884",
		style=dashed];
	layer2_expert4_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14689,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu4 -> layer2_expert4_12	[pos="e,14602,1881.6 13851,1954.3 14051,1943.5 14439,1919.1 14592,1883.9",
		style=dashed];
	layer2_expert4_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14881,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu4 -> layer2_expert4_13	[pos="e,14794,1881.6 13851,1956.6 14086,1948.4 14593,1926.6 14784,1883.9",
		style=dashed];
	layer2_expert4_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="15073,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu4 -> layer2_expert4_14	[pos="e,14986,1881.7 13851,1958.2 14118,1952.4 14747,1934.1 14976,1883.9",
		style=dashed];
	layer2_expert4_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="15265,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu4 -> layer2_expert4_15	[pos="e,15178,1881.7 13851,1959.4 14148,1955.9 14900,1941.6 15168,1884",
		style=dashed];
	layer2_moe_agg_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_MoE_Aggregate_GPU4
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 4",
		pos="13729,1731",
		shape=rectangle,
		width=2.8194];
	layer2_expert4_0 -> layer2_moe_agg_gpu4	[pos="e,13627,1733.1 12472,1803.2 12475,1802.4 12478,1801.6 12481,1801 12695,1751.4 13352,1737.1 13617,1733.2"];
	layer2_expert4_1 -> layer2_moe_agg_gpu4	[pos="e,13627,1734.3 12664,1803.2 12667,1802.4 12670,1801.6 12673,1801 12850,1759.2 13383,1740.8 13617,1734.6"];
	layer2_expert4_2 -> layer2_moe_agg_gpu4	[pos="e,13627,1736 12856,1803.3 12859,1802.4 12862,1801.7 12865,1801 13005,1766.9 13417,1745.3 13617,1736.5"];
	layer2_expert4_3 -> layer2_moe_agg_gpu4	[pos="e,13627,1733.1 13048,1803.4 13051,1802.5 13054,1801.7 13057,1801 13250,1751.6 13482,1737.3 13617,1733.4"];
	layer2_expert4_4 -> layer2_moe_agg_gpu4	[pos="e,13627,1739 13240,1803.6 13243,1802.7 13246,1801.8 13249,1801 13373,1766.6 13519,1748.7 13617,1739.9"];
	layer2_expert4_5 -> layer2_moe_agg_gpu4	[pos="e,13627,1752.1 13432,1804 13435,1802.9 13438,1801.9 13441,1801 13498,1782.2 13563,1766.1 13617,1754.2"];
	layer2_expert4_6 -> layer2_moe_agg_gpu4	[pos="e,13671,1765 13608,1800.8 13626,1790.8 13645,1780 13662,1770.1"];
	layer2_expert4_7 -> layer2_moe_agg_gpu4	[pos="e,13729,1765.3 13729,1800.7 13729,1792.5 13729,1783.8 13729,1775.5"];
	layer2_expert4_8 -> layer2_moe_agg_gpu4	[pos="e,13787,1765 13850,1800.8 13832,1790.8 13813,1780 13796,1770.1"];
	layer2_expert4_9 -> layer2_moe_agg_gpu4	[pos="e,13831,1752.1 14026,1804 14023,1802.9 14020,1801.9 14017,1801 13960,1782.2 13895,1766.1 13841,1754.2"];
	layer2_expert4_10 -> layer2_moe_agg_gpu4	[pos="e,13831,1739 14218,1803.6 14215,1802.7 14212,1801.8 14209,1801 14085,1766.6 13939,1748.7 13841,1739.9"];
	layer2_expert4_11 -> layer2_moe_agg_gpu4	[pos="e,13831,1733.1 14410,1803.4 14407,1802.5 14404,1801.7 14401,1801 14208,1751.6 13976,1737.3 13841,1733.4"];
	layer2_expert4_12 -> layer2_moe_agg_gpu4	[pos="e,13831,1736 14602,1803.3 14599,1802.4 14596,1801.7 14593,1801 14453,1766.9 14041,1745.3 13841,1736.5"];
	layer2_expert4_13 -> layer2_moe_agg_gpu4	[pos="e,13831,1734.3 14794,1803.2 14791,1802.4 14788,1801.6 14785,1801 14608,1759.2 14075,1740.8 13841,1734.6"];
	layer2_expert4_14 -> layer2_moe_agg_gpu4	[pos="e,13831,1733.1 14986,1803.2 14983,1802.4 14980,1801.6 14977,1801 14763,1751.4 14106,1737.1 13841,1733.2"];
	layer2_expert4_15 -> layer2_moe_agg_gpu4	[pos="e,13831,1732.2 15178,1803.2 15175,1802.4 15172,1801.6 15169,1801 14917,1743.6 14134,1733.9 13841,1732.3"];
	layer2_moe_agg_gpu4 -> layer2_moe_allreduce	[pos="e,12465,1610.6 13627,1720.4 13388,1697.7 12783,1640.6 12475,1611.5"];
	layer2_output_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU4
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 4",
		pos="12420,1455",
		shape=rectangle,
		width=3.3889];
	layer3_qkv_gpu4	[fillcolor=lightgreen,
		height=1.3611,
		label="L3_QKV_Projection_GPU4
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 16-19
TP Slice: 4
GPU: 4",
		pos="12419,1336",
		shape=rectangle,
		width=2.7778];
	layer2_output_gpu4 -> layer3_qkv_gpu4	[pos="e,12419,1385.1 12420,1420.7 12420,1412.8 12420,1404 12419,1395.3"];
	layer2_expert5_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="15457,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu5 -> layer2_expert5_0	[pos="e,15544,1881.7 16679,1958.2 16412,1952.4 15783,1934.1 15554,1883.9",
		style=dashed];
	layer2_expert5_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="15649,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu5 -> layer2_expert5_1	[pos="e,15736,1881.6 16679,1956.6 16444,1948.4 15937,1926.6 15746,1883.9",
		style=dashed];
	layer2_expert5_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="15841,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu5 -> layer2_expert5_2	[pos="e,15928,1881.6 16679,1954.3 16479,1943.5 16091,1919.1 15938,1883.9",
		style=dashed];
	layer2_expert5_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16033,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu5 -> layer2_expert5_3	[pos="e,16120,1881.4 16679,1957 16545,1950.9 16324,1933.8 16130,1884",
		style=dashed];
	layer2_expert5_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16225,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu5 -> layer2_expert5_4	[pos="e,16312,1881.2 16679,1949.2 16583,1938.5 16447,1919.1 16322,1884",
		style=dashed];
	layer2_expert5_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16417,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu5 -> layer2_expert5_5	[pos="e,16504,1880.8 16679,1932 16630,1919.6 16573,1904 16514,1884.1",
		style=dashed];
	layer2_expert5_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16609,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu5 -> layer2_expert5_6	[pos="e,16675,1884 16734,1919.9 16718,1910 16701,1899.3 16684,1889.2",
		style=dashed];
	layer2_expert5_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16801,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu5 -> layer2_expert5_7	[pos="e,16801,1884 16801,1919.9 16801,1911.6 16801,1902.8 16801,1894.3",
		style=dashed];
	layer2_expert5_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16993,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu5 -> layer2_expert5_8	[pos="e,16927,1884 16868,1919.9 16884,1910 16901,1899.3 16918,1889.2",
		style=dashed];
	layer2_expert5_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17185,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu5 -> layer2_expert5_9	[pos="e,17098,1880.8 16923,1932 16972,1919.6 17029,1904 17088,1884.1",
		style=dashed];
	layer2_expert5_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17377,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu5 -> layer2_expert5_10	[pos="e,17290,1881.2 16923,1949.2 17019,1938.5 17155,1919.1 17280,1884",
		style=dashed];
	layer2_expert5_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17569,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu5 -> layer2_expert5_11	[pos="e,17482,1881.4 16923,1957 17057,1950.9 17278,1933.8 17472,1884",
		style=dashed];
	layer2_expert5_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17761,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu5 -> layer2_expert5_12	[pos="e,17674,1881.6 16923,1954.3 17123,1943.5 17511,1919.1 17664,1883.9",
		style=dashed];
	layer2_expert5_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17953,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu5 -> layer2_expert5_13	[pos="e,17866,1881.6 16923,1956.6 17158,1948.4 17665,1926.6 17856,1883.9",
		style=dashed];
	layer2_expert5_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="18145,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu5 -> layer2_expert5_14	[pos="e,18058,1881.7 16923,1958.2 17190,1952.4 17819,1934.1 18048,1883.9",
		style=dashed];
	layer2_expert5_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="18337,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu5 -> layer2_expert5_15	[pos="e,18250,1881.7 16923,1959.4 17220,1955.9 17972,1941.6 18240,1884",
		style=dashed];
	layer2_moe_agg_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_MoE_Aggregate_GPU5
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 5",
		pos="16801,1731",
		shape=rectangle,
		width=2.8194];
	layer2_expert5_0 -> layer2_moe_agg_gpu5	[pos="e,16699,1733.1 15544,1803.2 15547,1802.4 15550,1801.6 15553,1801 15767,1751.4 16424,1737.1 16689,1733.2"];
	layer2_expert5_1 -> layer2_moe_agg_gpu5	[pos="e,16699,1734.3 15736,1803.2 15739,1802.4 15742,1801.6 15745,1801 15922,1759.2 16455,1740.8 16689,1734.6"];
	layer2_expert5_2 -> layer2_moe_agg_gpu5	[pos="e,16699,1736 15928,1803.3 15931,1802.4 15934,1801.7 15937,1801 16077,1766.9 16489,1745.3 16689,1736.5"];
	layer2_expert5_3 -> layer2_moe_agg_gpu5	[pos="e,16699,1733.1 16120,1803.4 16123,1802.5 16126,1801.7 16129,1801 16322,1751.6 16554,1737.3 16689,1733.4"];
	layer2_expert5_4 -> layer2_moe_agg_gpu5	[pos="e,16699,1739 16312,1803.6 16315,1802.7 16318,1801.8 16321,1801 16445,1766.6 16591,1748.7 16689,1739.9"];
	layer2_expert5_5 -> layer2_moe_agg_gpu5	[pos="e,16699,1752.1 16504,1804 16507,1802.9 16510,1801.9 16513,1801 16570,1782.2 16635,1766.1 16689,1754.2"];
	layer2_expert5_6 -> layer2_moe_agg_gpu5	[pos="e,16743,1765 16680,1800.8 16698,1790.8 16717,1780 16734,1770.1"];
	layer2_expert5_7 -> layer2_moe_agg_gpu5	[pos="e,16801,1765.3 16801,1800.7 16801,1792.5 16801,1783.8 16801,1775.5"];
	layer2_expert5_8 -> layer2_moe_agg_gpu5	[pos="e,16859,1765 16922,1800.8 16904,1790.8 16885,1780 16868,1770.1"];
	layer2_expert5_9 -> layer2_moe_agg_gpu5	[pos="e,16903,1752.1 17098,1804 17095,1802.9 17092,1801.9 17089,1801 17032,1782.2 16967,1766.1 16913,1754.2"];
	layer2_expert5_10 -> layer2_moe_agg_gpu5	[pos="e,16903,1739 17290,1803.6 17287,1802.7 17284,1801.8 17281,1801 17157,1766.6 17011,1748.7 16913,1739.9"];
	layer2_expert5_11 -> layer2_moe_agg_gpu5	[pos="e,16903,1733.1 17482,1803.4 17479,1802.5 17476,1801.7 17473,1801 17280,1751.6 17048,1737.3 16913,1733.4"];
	layer2_expert5_12 -> layer2_moe_agg_gpu5	[pos="e,16903,1736 17674,1803.3 17671,1802.4 17668,1801.7 17665,1801 17525,1766.9 17113,1745.3 16913,1736.5"];
	layer2_expert5_13 -> layer2_moe_agg_gpu5	[pos="e,16903,1734.3 17866,1803.2 17863,1802.4 17860,1801.6 17857,1801 17680,1759.2 17147,1740.8 16913,1734.6"];
	layer2_expert5_14 -> layer2_moe_agg_gpu5	[pos="e,16903,1733.1 18058,1803.2 18055,1802.4 18052,1801.6 18049,1801 17835,1751.4 17178,1737.1 16913,1733.2"];
	layer2_expert5_15 -> layer2_moe_agg_gpu5	[pos="e,16903,1732.2 18250,1803.2 18247,1802.4 18244,1801.6 18241,1801 17989,1743.6 17206,1733.9 16913,1732.3"];
	layer2_moe_agg_gpu5 -> layer2_moe_allreduce	[pos="e,12501,1600.3 16699,1726.9 16129,1709.7 13324,1625.2 12511,1600.6"];
	layer2_output_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU5
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 5",
		pos="12682,1455",
		shape=rectangle,
		width=3.3889];
	layer3_qkv_gpu5	[fillcolor=lightgreen,
		height=1.3611,
		label="L3_QKV_Projection_GPU5
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 20-23
TP Slice: 5
GPU: 5",
		pos="12681,1336",
		shape=rectangle,
		width=2.7778];
	layer2_output_gpu5 -> layer3_qkv_gpu5	[pos="e,12681,1385.1 12682,1420.7 12682,1412.8 12682,1404 12681,1395.3"];
	layer2_expert6_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="18529,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu6 -> layer2_expert6_0	[pos="e,18616,1881.7 19751,1958.2 19484,1952.4 18855,1934.1 18626,1883.9",
		style=dashed];
	layer2_expert6_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="18721,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu6 -> layer2_expert6_1	[pos="e,18808,1881.6 19751,1956.6 19516,1948.4 19009,1926.6 18818,1883.9",
		style=dashed];
	layer2_expert6_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="18913,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu6 -> layer2_expert6_2	[pos="e,19000,1881.6 19751,1954.3 19551,1943.5 19163,1919.1 19010,1883.9",
		style=dashed];
	layer2_expert6_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19105,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu6 -> layer2_expert6_3	[pos="e,19192,1881.4 19751,1957 19617,1950.9 19396,1933.8 19202,1884",
		style=dashed];
	layer2_expert6_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19297,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu6 -> layer2_expert6_4	[pos="e,19384,1881.2 19751,1949.2 19655,1938.5 19519,1919.1 19394,1884",
		style=dashed];
	layer2_expert6_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19489,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu6 -> layer2_expert6_5	[pos="e,19576,1880.8 19751,1932 19702,1919.6 19645,1904 19586,1884.1",
		style=dashed];
	layer2_expert6_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19681,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu6 -> layer2_expert6_6	[pos="e,19747,1884 19806,1919.9 19790,1910 19773,1899.3 19756,1889.2",
		style=dashed];
	layer2_expert6_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19873,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu6 -> layer2_expert6_7	[pos="e,19873,1884 19873,1919.9 19873,1911.6 19873,1902.8 19873,1894.3",
		style=dashed];
	layer2_expert6_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20065,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu6 -> layer2_expert6_8	[pos="e,19999,1884 19940,1919.9 19956,1910 19973,1899.3 19990,1889.2",
		style=dashed];
	layer2_expert6_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20257,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu6 -> layer2_expert6_9	[pos="e,20170,1880.8 19995,1932 20044,1919.6 20101,1904 20160,1884.1",
		style=dashed];
	layer2_expert6_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20449,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu6 -> layer2_expert6_10	[pos="e,20362,1881.2 19995,1949.2 20091,1938.5 20227,1919.1 20352,1884",
		style=dashed];
	layer2_expert6_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20641,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu6 -> layer2_expert6_11	[pos="e,20554,1881.4 19995,1957 20129,1950.9 20350,1933.8 20544,1884",
		style=dashed];
	layer2_expert6_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20833,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu6 -> layer2_expert6_12	[pos="e,20746,1881.6 19995,1954.3 20195,1943.5 20583,1919.1 20736,1883.9",
		style=dashed];
	layer2_expert6_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="21025,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu6 -> layer2_expert6_13	[pos="e,20938,1881.6 19995,1956.6 20230,1948.4 20737,1926.6 20928,1883.9",
		style=dashed];
	layer2_expert6_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="21217,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu6 -> layer2_expert6_14	[pos="e,21130,1881.7 19995,1958.2 20262,1952.4 20891,1934.1 21120,1883.9",
		style=dashed];
	layer2_expert6_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="21409,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu6 -> layer2_expert6_15	[pos="e,21322,1881.7 19995,1959.4 20292,1955.9 21044,1941.6 21312,1884",
		style=dashed];
	layer2_moe_agg_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_MoE_Aggregate_GPU6
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 6",
		pos="19873,1731",
		shape=rectangle,
		width=2.8194];
	layer2_expert6_0 -> layer2_moe_agg_gpu6	[pos="e,19771,1733.1 18616,1803.2 18619,1802.4 18622,1801.6 18625,1801 18839,1751.4 19496,1737.1 19761,1733.2"];
	layer2_expert6_1 -> layer2_moe_agg_gpu6	[pos="e,19771,1734.3 18808,1803.2 18811,1802.4 18814,1801.6 18817,1801 18994,1759.2 19527,1740.8 19761,1734.6"];
	layer2_expert6_2 -> layer2_moe_agg_gpu6	[pos="e,19771,1736 19000,1803.3 19003,1802.4 19006,1801.7 19009,1801 19149,1766.9 19561,1745.3 19761,1736.5"];
	layer2_expert6_3 -> layer2_moe_agg_gpu6	[pos="e,19771,1733.1 19192,1803.4 19195,1802.5 19198,1801.7 19201,1801 19394,1751.6 19626,1737.3 19761,1733.4"];
	layer2_expert6_4 -> layer2_moe_agg_gpu6	[pos="e,19771,1739 19384,1803.6 19387,1802.7 19390,1801.8 19393,1801 19517,1766.6 19663,1748.7 19761,1739.9"];
	layer2_expert6_5 -> layer2_moe_agg_gpu6	[pos="e,19771,1752.1 19576,1804 19579,1802.9 19582,1801.9 19585,1801 19642,1782.2 19707,1766.1 19761,1754.2"];
	layer2_expert6_6 -> layer2_moe_agg_gpu6	[pos="e,19815,1765 19752,1800.8 19770,1790.8 19789,1780 19806,1770.1"];
	layer2_expert6_7 -> layer2_moe_agg_gpu6	[pos="e,19873,1765.3 19873,1800.7 19873,1792.5 19873,1783.8 19873,1775.5"];
	layer2_expert6_8 -> layer2_moe_agg_gpu6	[pos="e,19931,1765 19994,1800.8 19976,1790.8 19957,1780 19940,1770.1"];
	layer2_expert6_9 -> layer2_moe_agg_gpu6	[pos="e,19975,1752.1 20170,1804 20167,1802.9 20164,1801.9 20161,1801 20104,1782.2 20039,1766.1 19985,1754.2"];
	layer2_expert6_10 -> layer2_moe_agg_gpu6	[pos="e,19975,1739 20362,1803.6 20359,1802.7 20356,1801.8 20353,1801 20229,1766.6 20083,1748.7 19985,1739.9"];
	layer2_expert6_11 -> layer2_moe_agg_gpu6	[pos="e,19975,1733.1 20554,1803.4 20551,1802.5 20548,1801.7 20545,1801 20352,1751.6 20120,1737.3 19985,1733.4"];
	layer2_expert6_12 -> layer2_moe_agg_gpu6	[pos="e,19975,1736 20746,1803.3 20743,1802.4 20740,1801.7 20737,1801 20597,1766.9 20185,1745.3 19985,1736.5"];
	layer2_expert6_13 -> layer2_moe_agg_gpu6	[pos="e,19975,1734.3 20938,1803.2 20935,1802.4 20932,1801.6 20929,1801 20752,1759.2 20219,1740.8 19985,1734.6"];
	layer2_expert6_14 -> layer2_moe_agg_gpu6	[pos="e,19975,1733.1 21130,1803.2 21127,1802.4 21124,1801.6 21121,1801 20907,1751.4 20250,1737.1 19985,1733.2"];
	layer2_expert6_15 -> layer2_moe_agg_gpu6	[pos="e,19975,1732.2 21322,1803.2 21319,1802.4 21316,1801.6 21313,1801 21061,1743.6 20278,1733.9 19985,1732.3"];
	layer2_moe_agg_gpu6 -> layer2_moe_allreduce	[pos="e,12509,1597.9 19771,1728.1 18971,1713.8 13692,1619.1 12519,1598.1"];
	layer2_output_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU6
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 6",
		pos="12944,1455",
		shape=rectangle,
		width=3.3889];
	layer3_qkv_gpu6	[fillcolor=lightgreen,
		height=1.3611,
		label="L3_QKV_Projection_GPU6
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 24-27
TP Slice: 6
GPU: 6",
		pos="12943,1336",
		shape=rectangle,
		width=2.7778];
	layer2_output_gpu6 -> layer3_qkv_gpu6	[pos="e,12943,1385.1 12944,1420.7 12944,1412.8 12944,1404 12943,1395.3"];
	layer2_expert7_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert0_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="21601,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu7 -> layer2_expert7_0	[pos="e,21688,1881.7 22823,1958.2 22556,1952.4 21927,1934.1 21698,1883.9",
		style=dashed];
	layer2_expert7_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert1_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="21793,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu7 -> layer2_expert7_1	[pos="e,21880,1881.6 22823,1956.6 22588,1948.4 22081,1926.6 21890,1883.9",
		style=dashed];
	layer2_expert7_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert2_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="21985,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu7 -> layer2_expert7_2	[pos="e,22072,1881.6 22823,1954.3 22623,1943.5 22235,1919.1 22082,1883.9",
		style=dashed];
	layer2_expert7_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert3_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22177,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu7 -> layer2_expert7_3	[pos="e,22264,1881.4 22823,1957 22689,1950.9 22468,1933.8 22274,1884",
		style=dashed];
	layer2_expert7_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert4_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22369,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu7 -> layer2_expert7_4	[pos="e,22456,1881.2 22823,1949.2 22727,1938.5 22591,1919.1 22466,1884",
		style=dashed];
	layer2_expert7_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert5_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22561,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu7 -> layer2_expert7_5	[pos="e,22648,1880.8 22823,1932 22774,1919.6 22717,1904 22658,1884.1",
		style=dashed];
	layer2_expert7_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert6_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22753,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu7 -> layer2_expert7_6	[pos="e,22819,1884 22878,1919.9 22862,1910 22845,1899.3 22828,1889.2",
		style=dashed];
	layer2_expert7_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert7_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22945,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu7 -> layer2_expert7_7	[pos="e,22945,1884 22945,1919.9 22945,1911.6 22945,1902.8 22945,1894.3",
		style=dashed];
	layer2_expert7_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert8_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23137,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu7 -> layer2_expert7_8	[pos="e,23071,1884 23012,1919.9 23028,1910 23045,1899.3 23062,1889.2",
		style=dashed];
	layer2_expert7_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert9_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23329,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu7 -> layer2_expert7_9	[pos="e,23242,1880.8 23067,1932 23116,1919.6 23173,1904 23232,1884.1",
		style=dashed];
	layer2_expert7_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert10_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23521,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu7 -> layer2_expert7_10	[pos="e,23434,1881.2 23067,1949.2 23163,1938.5 23299,1919.1 23424,1884",
		style=dashed];
	layer2_expert7_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert11_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23713,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu7 -> layer2_expert7_11	[pos="e,23626,1881.4 23067,1957 23201,1950.9 23422,1933.8 23616,1884",
		style=dashed];
	layer2_expert7_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert12_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23905,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu7 -> layer2_expert7_12	[pos="e,23818,1881.6 23067,1954.3 23267,1943.5 23655,1919.1 23808,1883.9",
		style=dashed];
	layer2_expert7_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert13_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="24097,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu7 -> layer2_expert7_13	[pos="e,24010,1881.6 23067,1956.6 23302,1948.4 23809,1926.6 24000,1883.9",
		style=dashed];
	layer2_expert7_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert14_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="24289,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu7 -> layer2_expert7_14	[pos="e,24202,1881.7 23067,1958.2 23334,1952.4 23963,1934.1 24192,1883.9",
		style=dashed];
	layer2_expert7_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L2_Expert15_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="24481,1842.5",
		shape=rectangle,
		width=2.4167];
	layer2_gate_gpu7 -> layer2_expert7_15	[pos="e,24394,1881.7 23067,1959.4 23364,1955.9 24116,1941.6 24384,1884",
		style=dashed];
	layer2_moe_agg_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_MoE_Aggregate_GPU7
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 7",
		pos="22945,1731",
		shape=rectangle,
		width=2.8194];
	layer2_expert7_0 -> layer2_moe_agg_gpu7	[pos="e,22843,1733.1 21688,1803.2 21691,1802.4 21694,1801.6 21697,1801 21911,1751.4 22568,1737.1 22833,1733.2"];
	layer2_expert7_1 -> layer2_moe_agg_gpu7	[pos="e,22843,1734.3 21880,1803.2 21883,1802.4 21886,1801.6 21889,1801 22066,1759.2 22599,1740.8 22833,1734.6"];
	layer2_expert7_2 -> layer2_moe_agg_gpu7	[pos="e,22843,1736 22072,1803.3 22075,1802.4 22078,1801.7 22081,1801 22221,1766.9 22633,1745.3 22833,1736.5"];
	layer2_expert7_3 -> layer2_moe_agg_gpu7	[pos="e,22843,1733.1 22264,1803.4 22267,1802.5 22270,1801.7 22273,1801 22466,1751.6 22698,1737.3 22833,1733.4"];
	layer2_expert7_4 -> layer2_moe_agg_gpu7	[pos="e,22843,1739 22456,1803.6 22459,1802.7 22462,1801.8 22465,1801 22589,1766.6 22735,1748.7 22833,1739.9"];
	layer2_expert7_5 -> layer2_moe_agg_gpu7	[pos="e,22843,1752.1 22648,1804 22651,1802.9 22654,1801.9 22657,1801 22714,1782.2 22779,1766.1 22833,1754.2"];
	layer2_expert7_6 -> layer2_moe_agg_gpu7	[pos="e,22887,1765 22824,1800.8 22842,1790.8 22861,1780 22878,1770.1"];
	layer2_expert7_7 -> layer2_moe_agg_gpu7	[pos="e,22945,1765.3 22945,1800.7 22945,1792.5 22945,1783.8 22945,1775.5"];
	layer2_expert7_8 -> layer2_moe_agg_gpu7	[pos="e,23003,1765 23066,1800.8 23048,1790.8 23029,1780 23012,1770.1"];
	layer2_expert7_9 -> layer2_moe_agg_gpu7	[pos="e,23047,1752.1 23242,1804 23239,1802.9 23236,1801.9 23233,1801 23176,1782.2 23111,1766.1 23057,1754.2"];
	layer2_expert7_10 -> layer2_moe_agg_gpu7	[pos="e,23047,1739 23434,1803.6 23431,1802.7 23428,1801.8 23425,1801 23301,1766.6 23155,1748.7 23057,1739.9"];
	layer2_expert7_11 -> layer2_moe_agg_gpu7	[pos="e,23047,1733.1 23626,1803.4 23623,1802.5 23620,1801.7 23617,1801 23424,1751.6 23192,1737.3 23057,1733.4"];
	layer2_expert7_12 -> layer2_moe_agg_gpu7	[pos="e,23047,1736 23818,1803.3 23815,1802.4 23812,1801.7 23809,1801 23669,1766.9 23257,1745.3 23057,1736.5"];
	layer2_expert7_13 -> layer2_moe_agg_gpu7	[pos="e,23047,1734.3 24010,1803.2 24007,1802.4 24004,1801.6 24001,1801 23824,1759.2 23291,1740.8 23057,1734.6"];
	layer2_expert7_14 -> layer2_moe_agg_gpu7	[pos="e,23047,1733.1 24202,1803.2 24199,1802.4 24196,1801.6 24193,1801 23979,1751.4 23322,1737.1 23057,1733.2"];
	layer2_expert7_15 -> layer2_moe_agg_gpu7	[pos="e,23047,1732.2 24394,1803.2 24391,1802.4 24388,1801.6 24385,1801 24133,1743.6 23350,1733.9 23057,1732.3"];
	layer2_moe_agg_gpu7 -> layer2_moe_allreduce	[pos="e,12513,1596.8 22843,1728.7 21857,1716.1 13987,1615.6 12523,1596.9"];
	layer2_output_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L2_Residual+LayerNorm_GPU7
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 7",
		pos="13206,1455",
		shape=rectangle,
		width=3.3889];
	layer3_qkv_gpu7	[fillcolor=lightgreen,
		height=1.3611,
		label="L3_QKV_Projection_GPU7
Input: [1024,2048,4096]
Output: [1024,2048,512]
Heads: 28-31
TP Slice: 7
GPU: 7",
		pos="13205,1336",
		shape=rectangle,
		width=2.7778];
	layer2_output_gpu7 -> layer3_qkv_gpu7	[pos="e,13205,1385.1 13206,1420.7 13206,1412.8 13206,1404 13205,1395.3"];
	layer2_moe_allreduce -> layer2_output_gpu0	[pos="e,11494,1487.2 12114,1575 11957,1558.3 11719,1529.7 11504,1489.1"];
	layer2_moe_allreduce -> layer2_output_gpu1	[pos="e,11756,1487 12146,1565.9 12043,1546.7 11901,1519.1 11766,1489.2"];
	layer2_moe_allreduce -> layer2_output_gpu2	[pos="e,11991,1489 12183,1555.2 12126,1535.7 12057,1511.8 12001,1492.3"];
	layer2_moe_allreduce -> layer2_output_gpu3	[pos="e,12190,1489.1 12238,1539.4 12225,1525.1 12210,1509.9 12197,1496.4"];
	layer2_moe_allreduce -> layer2_output_gpu4	[pos="e,12388,1489.1 12340,1539.4 12353,1525.1 12368,1509.9 12381,1496.4"];
	layer2_moe_allreduce -> layer2_output_gpu5	[pos="e,12587,1489 12395,1555.2 12452,1535.7 12521,1511.8 12577,1492.3"];
	layer2_moe_allreduce -> layer2_output_gpu6	[pos="e,12822,1487 12432,1565.9 12535,1546.7 12677,1519.1 12812,1489.2"];
	layer2_moe_allreduce -> layer2_output_gpu7	[pos="e,13084,1487.2 12464,1575 12621,1558.3 12859,1529.7 13074,1489.1"];
	layer3_attn_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU0
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 0",
		pos="11374,1217",
		shape=rectangle,
		width=3.375];
	layer3_qkv_gpu0 -> layer3_attn_gpu0	[pos="e,11374,1251.1 11373,1286.7 11373,1278.3 11374,1269.6 11374,1261.3"];
	layer3_attn_proj_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Attn_Projection_GPU0
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 0",
		pos="11403,1113",
		shape=rectangle,
		width=2.7778];
	layer3_attn_gpu0 -> layer3_attn_proj_gpu0	[pos="e,11394,1147.3 11383,1182.8 11386,1174.6 11388,1165.7 11391,1157.1"];
	layer3_attn_allreduce	[height=1.8889,
		label="L3_Attention_All-Reduce
Input: 8×[1024,2048,512]
Output: [1024,2048,4096]
TP All-Reduce across GPUs 0-7",
		pos="12278,974.95",
		width=6.5833];
	layer3_attn_proj_gpu0 -> layer3_attn_allreduce	[pos="e,12119,997.34 11503,1092.1 11527,1087.6 11552,1082.9 11576,1079 11757,1048.3 11966,1018.4 12109,998.73"];
	layer3_attn_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU1
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 1",
		pos="11636,1217",
		shape=rectangle,
		width=3.375];
	layer3_qkv_gpu1 -> layer3_attn_gpu1	[pos="e,11636,1251.1 11635,1286.7 11635,1278.3 11636,1269.6 11636,1261.3"];
	layer3_attn_proj_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Attn_Projection_GPU1
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 1",
		pos="11685,1113",
		shape=rectangle,
		width=2.7778];
	layer3_attn_gpu1 -> layer3_attn_proj_gpu1	[pos="e,11669,1147.3 11652,1182.8 11656,1174.4 11660,1165.2 11665,1156.3"];
	layer3_attn_proj_gpu1 -> layer3_attn_allreduce	[pos="e,12147,1005.5 11785,1088.4 11799,1085.2 11813,1082 11826,1079 11930,1054.9 12048,1028 12137,1007.7"];
	layer3_attn_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU2
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 2",
		pos="11897,1217",
		shape=rectangle,
		width=3.375];
	layer3_qkv_gpu2 -> layer3_attn_gpu2	[pos="e,11897,1251.1 11897,1286.7 11897,1278.3 11897,1269.6 11897,1261.3"];
	layer3_attn_proj_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Attn_Projection_GPU2
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 2",
		pos="11935,1113",
		shape=rectangle,
		width=2.7778];
	layer3_attn_gpu2 -> layer3_attn_proj_gpu2	[pos="e,11923,1147.3 11909,1182.8 11912,1174.6 11916,1165.5 11919,1156.9"];
	layer3_attn_proj_gpu2 -> layer3_attn_allreduce	[pos="e,12180,1014.9 12018,1078.9 12064,1060.7 12121,1038 12170,1018.6"];
	layer3_attn_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU3
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 3",
		pos="12158,1217",
		shape=rectangle,
		width=3.375];
	layer3_qkv_gpu3 -> layer3_attn_gpu3	[pos="e,12158,1251.1 12158,1286.7 12158,1278.3 12158,1269.6 12158,1261.3"];
	layer3_attn_proj_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Attn_Projection_GPU3
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 3",
		pos="12169,1113",
		shape=rectangle,
		width=2.7778];
	layer3_attn_gpu3 -> layer3_attn_proj_gpu3	[pos="e,12165,1147.3 12162,1182.8 12162,1174.7 12163,1165.9 12164,1157.4"];
	layer3_attn_proj_gpu3 -> layer3_attn_allreduce	[pos="e,12234,1030.6 12196,1078.7 12205,1066.6 12217,1052.5 12228,1038.7"];
	layer3_attn_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU4
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 4",
		pos="12419,1217",
		shape=rectangle,
		width=3.375];
	layer3_qkv_gpu4 -> layer3_attn_gpu4	[pos="e,12419,1251.1 12419,1286.7 12419,1278.3 12419,1269.6 12419,1261.3"];
	layer3_attn_proj_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Attn_Projection_GPU4
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 4",
		pos="12408,1113",
		shape=rectangle,
		width=2.7778];
	layer3_attn_gpu4 -> layer3_attn_proj_gpu4	[pos="e,12412,1147.3 12415,1182.8 12415,1174.7 12414,1165.9 12413,1157.4"];
	layer3_attn_proj_gpu4 -> layer3_attn_allreduce	[pos="e,12328,1028.7 12376,1078.7 12364,1065.9 12350,1050.9 12336,1036.3"];
	layer3_attn_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU5
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 5",
		pos="12681,1217",
		shape=rectangle,
		width=3.375];
	layer3_qkv_gpu5 -> layer3_attn_gpu5	[pos="e,12681,1251.1 12681,1286.7 12681,1278.3 12681,1269.6 12681,1261.3"];
	layer3_attn_proj_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Attn_Projection_GPU5
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 5",
		pos="12658,1113",
		shape=rectangle,
		width=2.7778];
	layer3_attn_gpu5 -> layer3_attn_proj_gpu5	[pos="e,12666,1147.3 12674,1182.8 12672,1174.6 12670,1165.7 12668,1157.1"];
	layer3_attn_proj_gpu5 -> layer3_attn_allreduce	[pos="e,12382,1013.2 12566,1078.9 12513,1060.1 12447,1036.5 12391,1016.6"];
	layer3_attn_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU6
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 6",
		pos="12943,1217",
		shape=rectangle,
		width=3.375];
	layer3_qkv_gpu6 -> layer3_attn_gpu6	[pos="e,12943,1251.1 12943,1286.7 12943,1278.3 12943,1269.6 12943,1261.3"];
	layer3_attn_proj_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Attn_Projection_GPU6
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 6",
		pos="12914,1113",
		shape=rectangle,
		width=2.7778];
	layer3_attn_gpu6 -> layer3_attn_proj_gpu6	[pos="e,12923,1147.3 12934,1182.8 12931,1174.6 12929,1165.7 12926,1157.1"];
	layer3_attn_proj_gpu6 -> layer3_attn_allreduce	[pos="e,12414,1004.1 12814,1089.2 12798,1085.8 12782,1082.2 12767,1079 12652,1053.9 12521,1026.4 12424,1006.1"];
	layer3_attn_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Multi-Head_Attention_GPU7
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 7",
		pos="13205,1217",
		shape=rectangle,
		width=3.375];
	layer3_qkv_gpu7 -> layer3_attn_gpu7	[pos="e,13205,1251.1 13205,1286.7 13205,1278.3 13205,1269.6 13205,1261.3"];
	layer3_attn_proj_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Attn_Projection_GPU7
Input: [1024,2048,512]
Output: [1024,2048,512]
GPU: 7",
		pos="13172,1113",
		shape=rectangle,
		width=2.7778];
	layer3_attn_gpu7 -> layer3_attn_proj_gpu7	[pos="e,13183,1147.3 13194,1182.8 13192,1174.6 13189,1165.5 13186,1156.9"];
	layer3_attn_proj_gpu7 -> layer3_attn_allreduce	[pos="e,12445,995.14 13072,1088.6 13055,1085.1 13039,1081.8 13023,1079 12830,1044.3 12607,1014.8 12455,996.39"];
	layer3_attn_norm_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU0
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="4433,836.95",
		shape=rectangle,
		width=3.3889];
	layer3_attn_allreduce -> layer3_attn_norm_gpu0	[pos="e,4555.4,840.8 12056,970.74 11242,958.89 8352.2,916.01 5969,870.95 5449.7,861.14 4831.6,847.16 4565.5,841.03"];
	layer3_attn_norm_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU1
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="6100,836.95",
		shape=rectangle,
		width=3.3889];
	layer3_attn_allreduce -> layer3_attn_norm_gpu1	[pos="e,6222.1,840.64 12061,969.17 11073,947.43 7018.3,858.17 6232.3,840.87"];
	layer3_attn_norm_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU2
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="9172,836.95",
		shape=rectangle,
		width=3.3889];
	layer3_attn_allreduce -> layer3_attn_norm_gpu2	[pos="e,9294.1,843.3 12075,965.07 11487,939.31 9791.5,865.08 9304.3,843.75"];
	layer3_attn_norm_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU3
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="11493,836.95",
		shape=rectangle,
		width=3.3889];
	layer3_attn_allreduce -> layer3_attn_norm_gpu3	[pos="e,11615,859.12 12132,948.69 11987,923.5 11765,885.16 11625,860.84"];
	layer3_attn_norm_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU4
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="13064,836.95",
		shape=rectangle,
		width=3.3889];
	layer3_attn_allreduce -> layer3_attn_norm_gpu4	[pos="e,12942,859.06 12424,948.69 12570,923.49 12791,885.11 12932,860.79"];
	layer3_attn_norm_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU5
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="15385,836.95",
		shape=rectangle,
		width=3.3889];
	layer3_attn_allreduce -> layer3_attn_norm_gpu5	[pos="e,15263,843.3 12481,965.08 13069,939.34 14765,865.09 15253,843.75"];
	layer3_attn_norm_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU6
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="18082,836.95",
		shape=rectangle,
		width=3.3889];
	layer3_attn_allreduce -> layer3_attn_norm_gpu6	[pos="e,17960,840.81 12494,968.89 13439,946.74 17196,858.71 17950,841.05"];
	layer3_attn_norm_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU7
Input: [1024,2048,4096]
Output: [1024,2048,4096]
Replicated across GPUs 0-7",
		pos="20966,836.95",
		shape=rectangle,
		width=3.3889];
	layer3_attn_allreduce -> layer3_attn_norm_gpu7	[pos="e,20844,839.87 12500,970.48 13745,950.99 19855,855.35 20834,840.03"];
	layer3_gate_gpu0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU0
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 0",
		pos="1623,725.45",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu0 -> layer3_gate_gpu0	[pos="e,1745.1,731.21 4310.9,831.2 3851.7,813.3 2230.6,750.13 1755.1,731.6"];
	layer3_gate_gpu1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU1
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 1",
		pos="4695,725.45",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu1 -> layer3_gate_gpu1	[pos="e,4817.2,735.98 5977.8,826.43 5715.2,805.96 5099,757.94 4827.5,736.78"];
	layer3_gate_gpu2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU2
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 2",
		pos="7767,725.45",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu2 -> layer3_gate_gpu2	[pos="e,7889.2,735.98 9049.8,826.43 8787.2,805.96 8171,757.94 7899.5,736.78"];
	layer3_gate_gpu3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU3
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 3",
		pos="10839,725.45",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu3 -> layer3_gate_gpu3	[pos="e,10961,746.91 11371,815.49 11257,796.45 11088,768.16 10971,748.6"];
	layer3_gate_gpu4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU4
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 4",
		pos="13719,725.45",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu4 -> layer3_gate_gpu4	[pos="e,13597,746.89 13186,815.55 13300,796.51 13470,768.16 13587,748.58"];
	layer3_gate_gpu5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU5
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 5",
		pos="16791,725.45",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu5 -> layer3_gate_gpu5	[pos="e,16669,735.96 15507,826.45 15770,805.99 16387,757.93 16659,736.77"];
	layer3_gate_gpu6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU6
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 6",
		pos="19863,725.45",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu6 -> layer3_gate_gpu6	[pos="e,19741,733.96 18204,828.45 18526,808.64 19397,755.09 19731,734.59"];
	layer3_gate_gpu7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Gate_GPU7
Input: [1024,2048,4096]
Output: [1024,2048,16 experts]
TP: expert routing
GPU: 7",
		pos="22935,725.45",
		shape=rectangle,
		width=3.3889];
	layer3_attn_norm_gpu7 -> layer3_gate_gpu7	[pos="e,22813,733.24 21088,829.17 21438,809.72 22441,753.92 22803,733.8"];
	layer3_expert0_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="87,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu0 -> layer3_expert0_0	[pos="e,174.22,645.71 1500.8,723.37 1204.2,719.87 451.59,705.65 184.29,647.96",
		style=dashed];
	layer3_expert0_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="279,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu0 -> layer3_expert0_1	[pos="e,366.22,645.68 1500.8,722.19 1234,716.43 605.25,698.07 376.17,647.94",
		style=dashed];
	layer3_expert0_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="471,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu0 -> layer3_expert0_2	[pos="e,558.23,645.64 1500.9,720.61 1266.3,712.41 759.38,690.58 568.19,647.95",
		style=dashed];
	layer3_expert0_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="663,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu0 -> layer3_expert0_3	[pos="e,750.25,645.58 1500.8,718.32 1301.3,707.53 913.31,683.15 760,647.92",
		style=dashed];
	layer3_expert0_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="855,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu0 -> layer3_expert0_4	[pos="e,942.01,645.4 1500.9,721 1367,714.86 1146.5,697.79 951.84,647.96",
		style=dashed];
	layer3_expert0_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1047,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu0 -> layer3_expert0_5	[pos="e,1134.1,645.23 1500.9,713.21 1405.3,702.51 1269.4,683.09 1143.8,648",
		style=dashed];
	layer3_expert0_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1239,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu0 -> layer3_expert0_6	[pos="e,1326.2,644.84 1500.7,695.97 1451.7,683.59 1394.7,667.96 1335.7,648.07",
		style=dashed];
	layer3_expert0_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1431,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu0 -> layer3_expert0_7	[pos="e,1497.5,647.97 1556.4,683.86 1540.2,673.97 1522.7,663.32 1506.1,653.21",
		style=dashed];
	layer3_expert0_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1623,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu0 -> layer3_expert0_8	[pos="e,1623,647.97 1623,683.86 1623,675.6 1623,666.82 1623,658.26",
		style=dashed];
	layer3_expert0_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="1815,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu0 -> layer3_expert0_9	[pos="e,1748.5,647.97 1689.6,683.86 1705.8,673.97 1723.3,663.32 1739.9,653.21",
		style=dashed];
	layer3_expert0_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2007,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu0 -> layer3_expert0_10	[pos="e,1919.8,644.84 1745.3,695.97 1794.3,683.59 1851.3,667.96 1910.3,648.07",
		style=dashed];
	layer3_expert0_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2199,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu0 -> layer3_expert0_11	[pos="e,2111.9,645.23 1745.1,713.21 1840.7,702.51 1976.6,683.09 2102.2,648",
		style=dashed];
	layer3_expert0_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2391,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu0 -> layer3_expert0_12	[pos="e,2304,645.4 1745.1,721 1879,714.86 2099.5,697.79 2294.2,647.96",
		style=dashed];
	layer3_expert0_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2583,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu0 -> layer3_expert0_13	[pos="e,2495.8,645.58 1745.2,718.32 1944.7,707.53 2332.7,683.15 2486,647.92",
		style=dashed];
	layer3_expert0_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2775,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu0 -> layer3_expert0_14	[pos="e,2687.8,645.64 1745.1,720.61 1979.7,712.41 2486.6,690.58 2677.8,647.95",
		style=dashed];
	layer3_expert0_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU0
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 0",
		pos="2967,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu0 -> layer3_expert0_15	[pos="e,2879.8,645.68 1745.2,722.19 2012,716.43 2640.7,698.07 2869.8,647.94",
		style=dashed];
	layer3_moe_agg_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_MoE_Aggregate_GPU0
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 0",
		pos="1623,494.95",
		shape=rectangle,
		width=2.8194];
	layer3_expert0_0 -> layer3_moe_agg_gpu0	[pos="e,1521.3,496.21 174.21,567.17 177.16,566.36 180.09,565.62 183,564.95 435.13,507.63 1218.3,497.89 1511,496.27"];
	layer3_expert0_1 -> layer3_moe_agg_gpu0	[pos="e,1521.4,497.09 366.22,567.2 369.16,566.38 372.09,565.63 375,564.95 589.24,515.42 1246.4,501.07 1511,497.24"];
	layer3_expert0_2 -> layer3_moe_agg_gpu0	[pos="e,1521.3,498.29 558.23,567.24 561.17,566.41 564.1,565.64 567,564.95 743.72,523.16 1277.2,504.77 1511.1,498.56"];
	layer3_expert0_3 -> layer3_moe_agg_gpu0	[pos="e,1521.2,500.01 750.24,567.3 753.18,566.45 756.1,565.66 759,564.95 898.55,530.88 1310.5,509.25 1511,500.46"];
	layer3_expert0_4 -> layer3_moe_agg_gpu0	[pos="e,1521.5,497.06 942.26,567.38 945.19,566.51 948.11,565.69 951,564.95 1143.8,515.56 1376.3,501.33 1511.1,497.35"];
	layer3_expert0_5 -> layer3_moe_agg_gpu0	[pos="e,1521.2,502.97 1134,567.62 1137,566.67 1140,565.78 1143,564.95 1266.5,530.64 1412.9,512.73 1511.3,503.86"];
	layer3_expert0_6 -> layer3_moe_agg_gpu0	[pos="e,1521.2,516.06 1326.1,567.97 1329.1,566.92 1332.1,565.91 1335,564.95 1392.3,546.16 1457.5,530.11 1511.3,518.23"];
	layer3_expert0_7 -> layer3_moe_agg_gpu0	[pos="e,1565.1,529 1502.2,564.84 1519.9,554.78 1538.7,544.04 1556.1,534.11"];
	layer3_expert0_8 -> layer3_moe_agg_gpu0	[pos="e,1623,529.25 1623,564.68 1623,556.47 1623,547.81 1623,539.51"];
	layer3_expert0_9 -> layer3_moe_agg_gpu0	[pos="e,1680.9,529 1743.8,564.84 1726.1,554.78 1707.3,544.04 1689.9,534.11"];
	layer3_expert0_10 -> layer3_moe_agg_gpu0	[pos="e,1724.8,516.06 1919.9,567.97 1916.9,566.92 1913.9,565.91 1911,564.95 1853.7,546.16 1788.5,530.11 1734.7,518.23"];
	layer3_expert0_11 -> layer3_moe_agg_gpu0	[pos="e,1724.8,502.97 2112,567.62 2109,566.67 2106,565.78 2103,564.95 1979.5,530.64 1833.1,512.73 1734.7,503.86"];
	layer3_expert0_12 -> layer3_moe_agg_gpu0	[pos="e,1724.5,497.06 2303.7,567.38 2300.8,566.51 2297.9,565.69 2295,564.95 2102.2,515.56 1869.7,501.33 1734.9,497.35"];
	layer3_expert0_13 -> layer3_moe_agg_gpu0	[pos="e,1724.8,500.01 2495.8,567.3 2492.8,566.45 2489.9,565.66 2487,564.95 2347.4,530.88 1935.5,509.25 1735,500.46"];
	layer3_expert0_14 -> layer3_moe_agg_gpu0	[pos="e,1724.7,498.29 2687.8,567.24 2684.8,566.41 2681.9,565.64 2679,564.95 2502.3,523.16 1968.8,504.77 1734.9,498.56"];
	layer3_expert0_15 -> layer3_moe_agg_gpu0	[pos="e,1724.6,497.09 2879.8,567.2 2876.8,566.38 2873.9,565.63 2871,564.95 2656.8,515.42 1999.6,501.07 1735,497.24"];
	layer3_moe_allreduce	[height=1.8889,
		label="L3_MoE_All-Reduce
Input: 8×[1024,2048,4096]
Output: [1024,2048,4096]
TP All-Reduce across GPUs 0-7",
		pos="12279,356.95",
		width=6.5833];
	layer3_moe_agg_gpu0 -> layer3_moe_allreduce	[pos="e,12055,360.81 1724.6,492.66 2711.3,480.06 10581,379.62 12045,360.94"];
	layer3_output_gpu0	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU0
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 0",
		pos="11362,218.95",
		shape=rectangle,
		width=3.3889];
	output	[fillcolor=lightblue,
		height=1.041,
		label="OUTPUT
Input: [batch_size=1024, seq_len=2048, hidden=4096]
GPU: 0-7",
		pos="12279,111.48",
		shape=ellipse,
		width=8.1121];
	layer3_output_gpu0 -> output	[pos="e,12012,126.79 11484,186.52 11487,185.97 11490,185.45 11493,184.95 11661,156.28 11851,138.37 12002,127.53"];
	layer3_expert1_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3159,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu1 -> layer3_expert1_0	[pos="e,3246.2,645.71 4572.8,723.37 4276.2,719.87 3523.6,705.65 3256.3,647.96",
		style=dashed];
	layer3_expert1_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3351,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu1 -> layer3_expert1_1	[pos="e,3438.2,645.68 4572.8,722.19 4306,716.43 3677.3,698.07 3448.2,647.94",
		style=dashed];
	layer3_expert1_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3543,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu1 -> layer3_expert1_2	[pos="e,3630.2,645.64 4572.9,720.61 4338.3,712.41 3831.4,690.58 3640.2,647.95",
		style=dashed];
	layer3_expert1_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3735,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu1 -> layer3_expert1_3	[pos="e,3822.2,645.58 4572.8,718.32 4373.3,707.53 3985.3,683.15 3832,647.92",
		style=dashed];
	layer3_expert1_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="3927,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu1 -> layer3_expert1_4	[pos="e,4014,645.4 4572.9,721 4439,714.86 4218.5,697.79 4023.8,647.96",
		style=dashed];
	layer3_expert1_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4119,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu1 -> layer3_expert1_5	[pos="e,4206.1,645.23 4572.9,713.21 4477.3,702.51 4341.4,683.09 4215.8,648",
		style=dashed];
	layer3_expert1_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4311,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu1 -> layer3_expert1_6	[pos="e,4398.2,644.84 4572.7,695.97 4523.7,683.59 4466.7,667.96 4407.7,648.07",
		style=dashed];
	layer3_expert1_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4503,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu1 -> layer3_expert1_7	[pos="e,4569.5,647.97 4628.4,683.86 4612.2,673.97 4594.7,663.32 4578.1,653.21",
		style=dashed];
	layer3_expert1_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4695,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu1 -> layer3_expert1_8	[pos="e,4695,647.97 4695,683.86 4695,675.6 4695,666.82 4695,658.26",
		style=dashed];
	layer3_expert1_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="4887,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu1 -> layer3_expert1_9	[pos="e,4820.5,647.97 4761.6,683.86 4777.8,673.97 4795.3,663.32 4811.9,653.21",
		style=dashed];
	layer3_expert1_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5079,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu1 -> layer3_expert1_10	[pos="e,4991.8,644.84 4817.3,695.97 4866.3,683.59 4923.3,667.96 4982.3,648.07",
		style=dashed];
	layer3_expert1_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5271,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu1 -> layer3_expert1_11	[pos="e,5183.9,645.23 4817.1,713.21 4912.7,702.51 5048.6,683.09 5174.2,648",
		style=dashed];
	layer3_expert1_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5463,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu1 -> layer3_expert1_12	[pos="e,5376,645.4 4817.1,721 4951,714.86 5171.5,697.79 5366.2,647.96",
		style=dashed];
	layer3_expert1_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5655,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu1 -> layer3_expert1_13	[pos="e,5567.8,645.58 4817.2,718.32 5016.7,707.53 5404.7,683.15 5558,647.92",
		style=dashed];
	layer3_expert1_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="5847,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu1 -> layer3_expert1_14	[pos="e,5759.8,645.64 4817.1,720.61 5051.7,712.41 5558.6,690.58 5749.8,647.95",
		style=dashed];
	layer3_expert1_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU1
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 1",
		pos="6039,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu1 -> layer3_expert1_15	[pos="e,5951.8,645.68 4817.2,722.19 5084,716.43 5712.7,698.07 5941.8,647.94",
		style=dashed];
	layer3_moe_agg_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_MoE_Aggregate_GPU1
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 1",
		pos="4695,494.95",
		shape=rectangle,
		width=2.8194];
	layer3_expert1_0 -> layer3_moe_agg_gpu1	[pos="e,4593.3,496.21 3246.2,567.17 3249.2,566.36 3252.1,565.62 3255,564.95 3507.1,507.63 4290.3,497.89 4583,496.27"];
	layer3_expert1_1 -> layer3_moe_agg_gpu1	[pos="e,4593.4,497.09 3438.2,567.2 3441.2,566.38 3444.1,565.63 3447,564.95 3661.2,515.42 4318.4,501.07 4583,497.24"];
	layer3_expert1_2 -> layer3_moe_agg_gpu1	[pos="e,4593.3,498.29 3630.2,567.24 3633.2,566.41 3636.1,565.64 3639,564.95 3815.7,523.16 4349.2,504.77 4583.1,498.56"];
	layer3_expert1_3 -> layer3_moe_agg_gpu1	[pos="e,4593.2,500.01 3822.2,567.3 3825.2,566.45 3828.1,565.66 3831,564.95 3970.6,530.88 4382.5,509.25 4583,500.46"];
	layer3_expert1_4 -> layer3_moe_agg_gpu1	[pos="e,4593.5,497.06 4014.3,567.38 4017.2,566.51 4020.1,565.69 4023,564.95 4215.8,515.56 4448.3,501.33 4583.1,497.35"];
	layer3_expert1_5 -> layer3_moe_agg_gpu1	[pos="e,4593.2,502.97 4206,567.62 4209,566.67 4212,565.78 4215,564.95 4338.5,530.64 4484.9,512.73 4583.3,503.86"];
	layer3_expert1_6 -> layer3_moe_agg_gpu1	[pos="e,4593.2,516.06 4398.1,567.97 4401.1,566.92 4404.1,565.91 4407,564.95 4464.3,546.16 4529.5,530.11 4583.3,518.23"];
	layer3_expert1_7 -> layer3_moe_agg_gpu1	[pos="e,4637.1,529 4574.2,564.84 4591.9,554.78 4610.7,544.04 4628.1,534.11"];
	layer3_expert1_8 -> layer3_moe_agg_gpu1	[pos="e,4695,529.25 4695,564.68 4695,556.47 4695,547.81 4695,539.51"];
	layer3_expert1_9 -> layer3_moe_agg_gpu1	[pos="e,4752.9,529 4815.8,564.84 4798.1,554.78 4779.3,544.04 4761.9,534.11"];
	layer3_expert1_10 -> layer3_moe_agg_gpu1	[pos="e,4796.8,516.06 4991.9,567.97 4988.9,566.92 4985.9,565.91 4983,564.95 4925.7,546.16 4860.5,530.11 4806.7,518.23"];
	layer3_expert1_11 -> layer3_moe_agg_gpu1	[pos="e,4796.8,502.97 5184,567.62 5181,566.67 5178,565.78 5175,564.95 5051.5,530.64 4905.1,512.73 4806.7,503.86"];
	layer3_expert1_12 -> layer3_moe_agg_gpu1	[pos="e,4796.5,497.06 5375.7,567.38 5372.8,566.51 5369.9,565.69 5367,564.95 5174.2,515.56 4941.7,501.33 4806.9,497.35"];
	layer3_expert1_13 -> layer3_moe_agg_gpu1	[pos="e,4796.8,500.01 5567.8,567.3 5564.8,566.45 5561.9,565.66 5559,564.95 5419.4,530.88 5007.5,509.25 4807,500.46"];
	layer3_expert1_14 -> layer3_moe_agg_gpu1	[pos="e,4796.7,498.29 5759.8,567.24 5756.8,566.41 5753.9,565.64 5751,564.95 5574.3,523.16 5040.8,504.77 4806.9,498.56"];
	layer3_expert1_15 -> layer3_moe_agg_gpu1	[pos="e,4796.6,497.09 5951.8,567.2 5948.8,566.38 5945.9,565.63 5943,564.95 5728.8,515.42 5071.6,501.07 4807,497.24"];
	layer3_moe_agg_gpu1 -> layer3_moe_allreduce	[pos="e,12059,361.9 4796.8,492.13 5597.2,477.77 10876,383.11 12049,362.08"];
	layer3_output_gpu1	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU1
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 1",
		pos="11624,218.95",
		shape=rectangle,
		width=3.3889];
	layer3_output_gpu1 -> output	[pos="e,12064,136.87 11746,186.7 11749,186.1 11752,185.51 11755,184.95 11852,166.03 11961,150.17 12054,138.17"];
	layer3_expert2_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="6231,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu2 -> layer3_expert2_0	[pos="e,6318.2,645.71 7644.8,723.37 7348.2,719.87 6595.6,705.65 6328.3,647.96",
		style=dashed];
	layer3_expert2_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="6423,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu2 -> layer3_expert2_1	[pos="e,6510.2,645.68 7644.8,722.19 7378,716.43 6749.3,698.07 6520.2,647.94",
		style=dashed];
	layer3_expert2_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="6615,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu2 -> layer3_expert2_2	[pos="e,6702.2,645.64 7644.9,720.61 7410.3,712.41 6903.4,690.58 6712.2,647.95",
		style=dashed];
	layer3_expert2_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="6807,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu2 -> layer3_expert2_3	[pos="e,6894.2,645.58 7644.8,718.32 7445.3,707.53 7057.3,683.15 6904,647.92",
		style=dashed];
	layer3_expert2_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="6999,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu2 -> layer3_expert2_4	[pos="e,7086,645.4 7644.9,721 7511,714.86 7290.5,697.79 7095.8,647.96",
		style=dashed];
	layer3_expert2_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7191,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu2 -> layer3_expert2_5	[pos="e,7278.1,645.23 7644.9,713.21 7549.3,702.51 7413.4,683.09 7287.8,648",
		style=dashed];
	layer3_expert2_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7383,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu2 -> layer3_expert2_6	[pos="e,7470.2,644.84 7644.7,695.97 7595.7,683.59 7538.7,667.96 7479.7,648.07",
		style=dashed];
	layer3_expert2_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7575,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu2 -> layer3_expert2_7	[pos="e,7641.5,647.97 7700.4,683.86 7684.2,673.97 7666.7,663.32 7650.1,653.21",
		style=dashed];
	layer3_expert2_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7767,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu2 -> layer3_expert2_8	[pos="e,7767,647.97 7767,683.86 7767,675.6 7767,666.82 7767,658.26",
		style=dashed];
	layer3_expert2_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="7959,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu2 -> layer3_expert2_9	[pos="e,7892.5,647.97 7833.6,683.86 7849.8,673.97 7867.3,663.32 7883.9,653.21",
		style=dashed];
	layer3_expert2_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8151,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu2 -> layer3_expert2_10	[pos="e,8063.8,644.84 7889.3,695.97 7938.3,683.59 7995.3,667.96 8054.3,648.07",
		style=dashed];
	layer3_expert2_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8343,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu2 -> layer3_expert2_11	[pos="e,8255.9,645.23 7889.1,713.21 7984.7,702.51 8120.6,683.09 8246.2,648",
		style=dashed];
	layer3_expert2_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8535,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu2 -> layer3_expert2_12	[pos="e,8448,645.4 7889.1,721 8023,714.86 8243.5,697.79 8438.2,647.96",
		style=dashed];
	layer3_expert2_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8727,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu2 -> layer3_expert2_13	[pos="e,8639.8,645.58 7889.2,718.32 8088.7,707.53 8476.7,683.15 8630,647.92",
		style=dashed];
	layer3_expert2_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="8919,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu2 -> layer3_expert2_14	[pos="e,8831.8,645.64 7889.1,720.61 8123.7,712.41 8630.6,690.58 8821.8,647.95",
		style=dashed];
	layer3_expert2_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU2
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 2",
		pos="9111,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu2 -> layer3_expert2_15	[pos="e,9023.8,645.68 7889.2,722.19 8156,716.43 8784.7,698.07 9013.8,647.94",
		style=dashed];
	layer3_moe_agg_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_MoE_Aggregate_GPU2
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 2",
		pos="7767,494.95",
		shape=rectangle,
		width=2.8194];
	layer3_expert2_0 -> layer3_moe_agg_gpu2	[pos="e,7665.3,496.21 6318.2,567.17 6321.2,566.36 6324.1,565.62 6327,564.95 6579.1,507.63 7362.3,497.89 7655,496.27"];
	layer3_expert2_1 -> layer3_moe_agg_gpu2	[pos="e,7665.4,497.09 6510.2,567.2 6513.2,566.38 6516.1,565.63 6519,564.95 6733.2,515.42 7390.4,501.07 7655,497.24"];
	layer3_expert2_2 -> layer3_moe_agg_gpu2	[pos="e,7665.3,498.29 6702.2,567.24 6705.2,566.41 6708.1,565.64 6711,564.95 6887.7,523.16 7421.2,504.77 7655.1,498.56"];
	layer3_expert2_3 -> layer3_moe_agg_gpu2	[pos="e,7665.2,500.01 6894.2,567.3 6897.2,566.45 6900.1,565.66 6903,564.95 7042.6,530.88 7454.5,509.25 7655,500.46"];
	layer3_expert2_4 -> layer3_moe_agg_gpu2	[pos="e,7665.5,497.06 7086.3,567.38 7089.2,566.51 7092.1,565.69 7095,564.95 7287.8,515.56 7520.3,501.33 7655.1,497.35"];
	layer3_expert2_5 -> layer3_moe_agg_gpu2	[pos="e,7665.2,502.97 7278,567.62 7281,566.67 7284,565.78 7287,564.95 7410.5,530.64 7556.9,512.73 7655.3,503.86"];
	layer3_expert2_6 -> layer3_moe_agg_gpu2	[pos="e,7665.2,516.06 7470.1,567.97 7473.1,566.92 7476.1,565.91 7479,564.95 7536.3,546.16 7601.5,530.11 7655.3,518.23"];
	layer3_expert2_7 -> layer3_moe_agg_gpu2	[pos="e,7709.1,529 7646.2,564.84 7663.9,554.78 7682.7,544.04 7700.1,534.11"];
	layer3_expert2_8 -> layer3_moe_agg_gpu2	[pos="e,7767,529.25 7767,564.68 7767,556.47 7767,547.81 7767,539.51"];
	layer3_expert2_9 -> layer3_moe_agg_gpu2	[pos="e,7824.9,529 7887.8,564.84 7870.1,554.78 7851.3,544.04 7833.9,534.11"];
	layer3_expert2_10 -> layer3_moe_agg_gpu2	[pos="e,7868.8,516.06 8063.9,567.97 8060.9,566.92 8057.9,565.91 8055,564.95 7997.7,546.16 7932.5,530.11 7878.7,518.23"];
	layer3_expert2_11 -> layer3_moe_agg_gpu2	[pos="e,7868.8,502.97 8256,567.62 8253,566.67 8250,565.78 8247,564.95 8123.5,530.64 7977.1,512.73 7878.7,503.86"];
	layer3_expert2_12 -> layer3_moe_agg_gpu2	[pos="e,7868.5,497.06 8447.7,567.38 8444.8,566.51 8441.9,565.69 8439,564.95 8246.2,515.56 8013.7,501.33 7878.9,497.35"];
	layer3_expert2_13 -> layer3_moe_agg_gpu2	[pos="e,7868.8,500.01 8639.8,567.3 8636.8,566.45 8633.9,565.66 8631,564.95 8491.4,530.88 8079.5,509.25 7879,500.46"];
	layer3_expert2_14 -> layer3_moe_agg_gpu2	[pos="e,7868.7,498.29 8831.8,567.24 8828.8,566.41 8825.9,565.64 8823,564.95 8646.3,523.16 8112.8,504.77 7878.9,498.56"];
	layer3_expert2_15 -> layer3_moe_agg_gpu2	[pos="e,7868.6,497.09 9023.8,567.2 9020.8,566.38 9017.9,565.63 9015,564.95 8800.8,515.42 8143.6,501.07 7879,497.24"];
	layer3_moe_agg_gpu2 -> layer3_moe_allreduce	[pos="e,12067,364.33 7868.6,490.89 8438.9,473.7 11244,389.16 12057,364.63"];
	layer3_output_gpu2	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU2
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 2",
		pos="11886,218.95",
		shape=rectangle,
		width=3.3889];
	layer3_output_gpu2 -> output	[pos="e,12156,145.52 12008,185.16 12052,173.41 12101,160.12 12146,148.14"];
	layer3_expert3_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="9303,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu3 -> layer3_expert3_0	[pos="e,9390.2,645.71 10717,723.37 10420,719.87 9667.6,705.65 9400.3,647.96",
		style=dashed];
	layer3_expert3_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="9495,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu3 -> layer3_expert3_1	[pos="e,9582.2,645.68 10717,722.19 10450,716.43 9821.3,698.07 9592.2,647.94",
		style=dashed];
	layer3_expert3_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="9687,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu3 -> layer3_expert3_2	[pos="e,9774.2,645.64 10717,720.61 10482,712.41 9975.4,690.58 9784.2,647.95",
		style=dashed];
	layer3_expert3_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="9879,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu3 -> layer3_expert3_3	[pos="e,9966.2,645.58 10717,718.32 10517,707.53 10129,683.15 9976,647.92",
		style=dashed];
	layer3_expert3_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10071,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu3 -> layer3_expert3_4	[pos="e,10158,645.4 10717,721 10583,714.86 10362,697.79 10168,647.96",
		style=dashed];
	layer3_expert3_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10263,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu3 -> layer3_expert3_5	[pos="e,10350,645.23 10717,713.21 10621,702.51 10485,683.09 10360,648",
		style=dashed];
	layer3_expert3_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10455,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu3 -> layer3_expert3_6	[pos="e,10542,644.84 10717,695.97 10668,683.59 10611,667.96 10552,648.07",
		style=dashed];
	layer3_expert3_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10647,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu3 -> layer3_expert3_7	[pos="e,10713,647.97 10772,683.86 10756,673.97 10739,663.32 10722,653.21",
		style=dashed];
	layer3_expert3_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="10839,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu3 -> layer3_expert3_8	[pos="e,10839,647.97 10839,683.86 10839,675.6 10839,666.82 10839,658.26",
		style=dashed];
	layer3_expert3_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11031,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu3 -> layer3_expert3_9	[pos="e,10965,647.97 10906,683.86 10922,673.97 10939,663.32 10956,653.21",
		style=dashed];
	layer3_expert3_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11223,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu3 -> layer3_expert3_10	[pos="e,11136,644.84 10961,695.97 11010,683.59 11067,667.96 11126,648.07",
		style=dashed];
	layer3_expert3_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11415,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu3 -> layer3_expert3_11	[pos="e,11328,645.23 10961,713.21 11057,702.51 11193,683.09 11318,648",
		style=dashed];
	layer3_expert3_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11607,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu3 -> layer3_expert3_12	[pos="e,11520,645.4 10961,721 11095,714.86 11316,697.79 11510,647.96",
		style=dashed];
	layer3_expert3_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11799,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu3 -> layer3_expert3_13	[pos="e,11712,645.58 10961,718.32 11161,707.53 11549,683.15 11702,647.92",
		style=dashed];
	layer3_expert3_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="11991,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu3 -> layer3_expert3_14	[pos="e,11904,645.64 10961,720.61 11196,712.41 11703,690.58 11894,647.95",
		style=dashed];
	layer3_expert3_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU3
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 3",
		pos="12183,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu3 -> layer3_expert3_15	[pos="e,12096,645.68 10961,722.19 11228,716.43 11857,698.07 12086,647.94",
		style=dashed];
	layer3_moe_agg_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_MoE_Aggregate_GPU3
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 3",
		pos="10839,494.95",
		shape=rectangle,
		width=2.8194];
	layer3_expert3_0 -> layer3_moe_agg_gpu3	[pos="e,10737,496.21 9390.2,567.17 9393.2,566.36 9396.1,565.62 9399,564.95 9651.1,507.63 10434,497.89 10727,496.27"];
	layer3_expert3_1 -> layer3_moe_agg_gpu3	[pos="e,10737,497.09 9582.2,567.2 9585.2,566.38 9588.1,565.63 9591,564.95 9805.2,515.42 10462,501.07 10727,497.24"];
	layer3_expert3_2 -> layer3_moe_agg_gpu3	[pos="e,10737,498.29 9774.2,567.24 9777.2,566.41 9780.1,565.64 9783,564.95 9959.7,523.16 10493,504.77 10727,498.56"];
	layer3_expert3_3 -> layer3_moe_agg_gpu3	[pos="e,10737,500.01 9966.2,567.3 9969.2,566.45 9972.1,565.66 9975,564.95 10115,530.88 10527,509.25 10727,500.46"];
	layer3_expert3_4 -> layer3_moe_agg_gpu3	[pos="e,10737,497.06 10158,567.38 10161,566.51 10164,565.69 10167,564.95 10360,515.56 10592,501.33 10727,497.35"];
	layer3_expert3_5 -> layer3_moe_agg_gpu3	[pos="e,10737,502.97 10350,567.62 10353,566.67 10356,565.78 10359,564.95 10483,530.64 10629,512.73 10727,503.86"];
	layer3_expert3_6 -> layer3_moe_agg_gpu3	[pos="e,10737,516.06 10542,567.97 10545,566.92 10548,565.91 10551,564.95 10608,546.16 10673,530.11 10727,518.23"];
	layer3_expert3_7 -> layer3_moe_agg_gpu3	[pos="e,10781,529 10718,564.84 10736,554.78 10755,544.04 10772,534.11"];
	layer3_expert3_8 -> layer3_moe_agg_gpu3	[pos="e,10839,529.25 10839,564.68 10839,556.47 10839,547.81 10839,539.51"];
	layer3_expert3_9 -> layer3_moe_agg_gpu3	[pos="e,10897,529 10960,564.84 10942,554.78 10923,544.04 10906,534.11"];
	layer3_expert3_10 -> layer3_moe_agg_gpu3	[pos="e,10941,516.06 11136,567.97 11133,566.92 11130,565.91 11127,564.95 11070,546.16 11005,530.11 10951,518.23"];
	layer3_expert3_11 -> layer3_moe_agg_gpu3	[pos="e,10941,502.97 11328,567.62 11325,566.67 11322,565.78 11319,564.95 11195,530.64 11049,512.73 10951,503.86"];
	layer3_expert3_12 -> layer3_moe_agg_gpu3	[pos="e,10941,497.06 11520,567.38 11517,566.51 11514,565.69 11511,564.95 11318,515.56 11086,501.33 10951,497.35"];
	layer3_expert3_13 -> layer3_moe_agg_gpu3	[pos="e,10941,500.01 11712,567.3 11709,566.45 11706,565.66 11703,564.95 11563,530.88 11151,509.25 10951,500.46"];
	layer3_expert3_14 -> layer3_moe_agg_gpu3	[pos="e,10941,498.29 11904,567.24 11901,566.41 11898,565.64 11895,564.95 11718,523.16 11185,504.77 10951,498.56"];
	layer3_expert3_15 -> layer3_moe_agg_gpu3	[pos="e,10941,497.09 12096,567.2 12093,566.38 12090,565.63 12087,564.95 11873,515.42 11216,501.07 10951,497.24"];
	layer3_moe_agg_gpu3 -> layer3_moe_allreduce	[pos="e,12103,374.55 10941,484.36 11180,461.71 11785,404.6 12093,375.53"];
	layer3_output_gpu3	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU3
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 3",
		pos="12148,218.95",
		shape=rectangle,
		width=3.3889];
	layer3_output_gpu3 -> output	[pos="e,12234,148.74 12189,184.87 12201,175.45 12214,165.06 12226,155.16"];
	layer3_expert4_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="12375,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu4 -> layer3_expert4_0	[pos="e,12462,645.68 13597,722.19 13330,716.43 12701,698.07 12472,647.94",
		style=dashed];
	layer3_expert4_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="12567,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu4 -> layer3_expert4_1	[pos="e,12654,645.64 13597,720.61 13362,712.41 12855,690.58 12664,647.95",
		style=dashed];
	layer3_expert4_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="12759,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu4 -> layer3_expert4_2	[pos="e,12846,645.58 13597,718.32 13397,707.53 13009,683.15 12856,647.92",
		style=dashed];
	layer3_expert4_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="12951,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu4 -> layer3_expert4_3	[pos="e,13038,645.4 13597,721 13463,714.86 13242,697.79 13048,647.96",
		style=dashed];
	layer3_expert4_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13143,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu4 -> layer3_expert4_4	[pos="e,13230,645.23 13597,713.21 13501,702.51 13365,683.09 13240,648",
		style=dashed];
	layer3_expert4_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13335,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu4 -> layer3_expert4_5	[pos="e,13422,644.84 13597,695.97 13548,683.59 13491,667.96 13432,648.07",
		style=dashed];
	layer3_expert4_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13527,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu4 -> layer3_expert4_6	[pos="e,13593,647.97 13652,683.86 13636,673.97 13619,663.32 13602,653.21",
		style=dashed];
	layer3_expert4_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13719,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu4 -> layer3_expert4_7	[pos="e,13719,647.97 13719,683.86 13719,675.6 13719,666.82 13719,658.26",
		style=dashed];
	layer3_expert4_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="13911,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu4 -> layer3_expert4_8	[pos="e,13845,647.97 13786,683.86 13802,673.97 13819,663.32 13836,653.21",
		style=dashed];
	layer3_expert4_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14103,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu4 -> layer3_expert4_9	[pos="e,14016,644.84 13841,695.97 13890,683.59 13947,667.96 14006,648.07",
		style=dashed];
	layer3_expert4_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14295,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu4 -> layer3_expert4_10	[pos="e,14208,645.23 13841,713.21 13937,702.51 14073,683.09 14198,648",
		style=dashed];
	layer3_expert4_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14487,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu4 -> layer3_expert4_11	[pos="e,14400,645.4 13841,721 13975,714.86 14196,697.79 14390,647.96",
		style=dashed];
	layer3_expert4_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14679,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu4 -> layer3_expert4_12	[pos="e,14592,645.58 13841,718.32 14041,707.53 14429,683.15 14582,647.92",
		style=dashed];
	layer3_expert4_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="14871,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu4 -> layer3_expert4_13	[pos="e,14784,645.64 13841,720.61 14076,712.41 14583,690.58 14774,647.95",
		style=dashed];
	layer3_expert4_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="15063,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu4 -> layer3_expert4_14	[pos="e,14976,645.68 13841,722.19 14108,716.43 14737,698.07 14966,647.94",
		style=dashed];
	layer3_expert4_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU4
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 4",
		pos="15255,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu4 -> layer3_expert4_15	[pos="e,15168,645.71 13841,723.37 14138,719.87 14890,705.65 15158,647.96",
		style=dashed];
	layer3_moe_agg_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_MoE_Aggregate_GPU4
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 4",
		pos="13719,494.95",
		shape=rectangle,
		width=2.8194];
	layer3_expert4_0 -> layer3_moe_agg_gpu4	[pos="e,13617,497.09 12462,567.2 12465,566.38 12468,565.63 12471,564.95 12685,515.42 13342,501.07 13607,497.24"];
	layer3_expert4_1 -> layer3_moe_agg_gpu4	[pos="e,13617,498.29 12654,567.24 12657,566.41 12660,565.64 12663,564.95 12840,523.16 13373,504.77 13607,498.56"];
	layer3_expert4_2 -> layer3_moe_agg_gpu4	[pos="e,13617,500.01 12846,567.3 12849,566.45 12852,565.66 12855,564.95 12995,530.88 13407,509.25 13607,500.46"];
	layer3_expert4_3 -> layer3_moe_agg_gpu4	[pos="e,13617,497.06 13038,567.38 13041,566.51 13044,565.69 13047,564.95 13240,515.56 13472,501.33 13607,497.35"];
	layer3_expert4_4 -> layer3_moe_agg_gpu4	[pos="e,13617,502.97 13230,567.62 13233,566.67 13236,565.78 13239,564.95 13363,530.64 13509,512.73 13607,503.86"];
	layer3_expert4_5 -> layer3_moe_agg_gpu4	[pos="e,13617,516.06 13422,567.97 13425,566.92 13428,565.91 13431,564.95 13488,546.16 13553,530.11 13607,518.23"];
	layer3_expert4_6 -> layer3_moe_agg_gpu4	[pos="e,13661,529 13598,564.84 13616,554.78 13635,544.04 13652,534.11"];
	layer3_expert4_7 -> layer3_moe_agg_gpu4	[pos="e,13719,529.25 13719,564.68 13719,556.47 13719,547.81 13719,539.51"];
	layer3_expert4_8 -> layer3_moe_agg_gpu4	[pos="e,13777,529 13840,564.84 13822,554.78 13803,544.04 13786,534.11"];
	layer3_expert4_9 -> layer3_moe_agg_gpu4	[pos="e,13821,516.06 14016,567.97 14013,566.92 14010,565.91 14007,564.95 13950,546.16 13885,530.11 13831,518.23"];
	layer3_expert4_10 -> layer3_moe_agg_gpu4	[pos="e,13821,502.97 14208,567.62 14205,566.67 14202,565.78 14199,564.95 14075,530.64 13929,512.73 13831,503.86"];
	layer3_expert4_11 -> layer3_moe_agg_gpu4	[pos="e,13821,497.06 14400,567.38 14397,566.51 14394,565.69 14391,564.95 14198,515.56 13966,501.33 13831,497.35"];
	layer3_expert4_12 -> layer3_moe_agg_gpu4	[pos="e,13821,500.01 14592,567.3 14589,566.45 14586,565.66 14583,564.95 14443,530.88 14031,509.25 13831,500.46"];
	layer3_expert4_13 -> layer3_moe_agg_gpu4	[pos="e,13821,498.29 14784,567.24 14781,566.41 14778,565.64 14775,564.95 14598,523.16 14065,504.77 13831,498.56"];
	layer3_expert4_14 -> layer3_moe_agg_gpu4	[pos="e,13821,497.09 14976,567.2 14973,566.38 14970,565.63 14967,564.95 14753,515.42 14096,501.07 13831,497.24"];
	layer3_expert4_15 -> layer3_moe_agg_gpu4	[pos="e,13821,496.21 15168,567.17 15165,566.36 15162,565.62 15159,564.95 14907,507.63 14124,497.89 13831,496.27"];
	layer3_moe_agg_gpu4 -> layer3_moe_allreduce	[pos="e,12455,374.55 13617,484.36 13378,461.71 12773,404.6 12465,375.53"];
	layer3_output_gpu4	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU4
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 4",
		pos="12410,218.95",
		shape=rectangle,
		width=3.3889];
	layer3_output_gpu4 -> output	[pos="e,12324,148.74 12369,184.87 12357,175.45 12344,165.06 12332,155.16"];
	layer3_expert5_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="15447,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu5 -> layer3_expert5_0	[pos="e,15534,645.68 16669,722.19 16402,716.43 15773,698.07 15544,647.94",
		style=dashed];
	layer3_expert5_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="15639,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu5 -> layer3_expert5_1	[pos="e,15726,645.64 16669,720.61 16434,712.41 15927,690.58 15736,647.95",
		style=dashed];
	layer3_expert5_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="15831,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu5 -> layer3_expert5_2	[pos="e,15918,645.58 16669,718.32 16469,707.53 16081,683.15 15928,647.92",
		style=dashed];
	layer3_expert5_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16023,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu5 -> layer3_expert5_3	[pos="e,16110,645.4 16669,721 16535,714.86 16314,697.79 16120,647.96",
		style=dashed];
	layer3_expert5_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16215,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu5 -> layer3_expert5_4	[pos="e,16302,645.23 16669,713.21 16573,702.51 16437,683.09 16312,648",
		style=dashed];
	layer3_expert5_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16407,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu5 -> layer3_expert5_5	[pos="e,16494,644.84 16669,695.97 16620,683.59 16563,667.96 16504,648.07",
		style=dashed];
	layer3_expert5_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16599,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu5 -> layer3_expert5_6	[pos="e,16665,647.97 16724,683.86 16708,673.97 16691,663.32 16674,653.21",
		style=dashed];
	layer3_expert5_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16791,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu5 -> layer3_expert5_7	[pos="e,16791,647.97 16791,683.86 16791,675.6 16791,666.82 16791,658.26",
		style=dashed];
	layer3_expert5_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="16983,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu5 -> layer3_expert5_8	[pos="e,16917,647.97 16858,683.86 16874,673.97 16891,663.32 16908,653.21",
		style=dashed];
	layer3_expert5_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17175,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu5 -> layer3_expert5_9	[pos="e,17088,644.84 16913,695.97 16962,683.59 17019,667.96 17078,648.07",
		style=dashed];
	layer3_expert5_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17367,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu5 -> layer3_expert5_10	[pos="e,17280,645.23 16913,713.21 17009,702.51 17145,683.09 17270,648",
		style=dashed];
	layer3_expert5_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17559,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu5 -> layer3_expert5_11	[pos="e,17472,645.4 16913,721 17047,714.86 17268,697.79 17462,647.96",
		style=dashed];
	layer3_expert5_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17751,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu5 -> layer3_expert5_12	[pos="e,17664,645.58 16913,718.32 17113,707.53 17501,683.15 17654,647.92",
		style=dashed];
	layer3_expert5_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="17943,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu5 -> layer3_expert5_13	[pos="e,17856,645.64 16913,720.61 17148,712.41 17655,690.58 17846,647.95",
		style=dashed];
	layer3_expert5_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="18135,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu5 -> layer3_expert5_14	[pos="e,18048,645.68 16913,722.19 17180,716.43 17809,698.07 18038,647.94",
		style=dashed];
	layer3_expert5_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU5
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 5",
		pos="18327,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu5 -> layer3_expert5_15	[pos="e,18240,645.71 16913,723.37 17210,719.87 17962,705.65 18230,647.96",
		style=dashed];
	layer3_moe_agg_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_MoE_Aggregate_GPU5
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 5",
		pos="16791,494.95",
		shape=rectangle,
		width=2.8194];
	layer3_expert5_0 -> layer3_moe_agg_gpu5	[pos="e,16689,497.09 15534,567.2 15537,566.38 15540,565.63 15543,564.95 15757,515.42 16414,501.07 16679,497.24"];
	layer3_expert5_1 -> layer3_moe_agg_gpu5	[pos="e,16689,498.29 15726,567.24 15729,566.41 15732,565.64 15735,564.95 15912,523.16 16445,504.77 16679,498.56"];
	layer3_expert5_2 -> layer3_moe_agg_gpu5	[pos="e,16689,500.01 15918,567.3 15921,566.45 15924,565.66 15927,564.95 16067,530.88 16479,509.25 16679,500.46"];
	layer3_expert5_3 -> layer3_moe_agg_gpu5	[pos="e,16689,497.06 16110,567.38 16113,566.51 16116,565.69 16119,564.95 16312,515.56 16544,501.33 16679,497.35"];
	layer3_expert5_4 -> layer3_moe_agg_gpu5	[pos="e,16689,502.97 16302,567.62 16305,566.67 16308,565.78 16311,564.95 16435,530.64 16581,512.73 16679,503.86"];
	layer3_expert5_5 -> layer3_moe_agg_gpu5	[pos="e,16689,516.06 16494,567.97 16497,566.92 16500,565.91 16503,564.95 16560,546.16 16625,530.11 16679,518.23"];
	layer3_expert5_6 -> layer3_moe_agg_gpu5	[pos="e,16733,529 16670,564.84 16688,554.78 16707,544.04 16724,534.11"];
	layer3_expert5_7 -> layer3_moe_agg_gpu5	[pos="e,16791,529.25 16791,564.68 16791,556.47 16791,547.81 16791,539.51"];
	layer3_expert5_8 -> layer3_moe_agg_gpu5	[pos="e,16849,529 16912,564.84 16894,554.78 16875,544.04 16858,534.11"];
	layer3_expert5_9 -> layer3_moe_agg_gpu5	[pos="e,16893,516.06 17088,567.97 17085,566.92 17082,565.91 17079,564.95 17022,546.16 16957,530.11 16903,518.23"];
	layer3_expert5_10 -> layer3_moe_agg_gpu5	[pos="e,16893,502.97 17280,567.62 17277,566.67 17274,565.78 17271,564.95 17147,530.64 17001,512.73 16903,503.86"];
	layer3_expert5_11 -> layer3_moe_agg_gpu5	[pos="e,16893,497.06 17472,567.38 17469,566.51 17466,565.69 17463,564.95 17270,515.56 17038,501.33 16903,497.35"];
	layer3_expert5_12 -> layer3_moe_agg_gpu5	[pos="e,16893,500.01 17664,567.3 17661,566.45 17658,565.66 17655,564.95 17515,530.88 17103,509.25 16903,500.46"];
	layer3_expert5_13 -> layer3_moe_agg_gpu5	[pos="e,16893,498.29 17856,567.24 17853,566.41 17850,565.64 17847,564.95 17670,523.16 17137,504.77 16903,498.56"];
	layer3_expert5_14 -> layer3_moe_agg_gpu5	[pos="e,16893,497.09 18048,567.2 18045,566.38 18042,565.63 18039,564.95 17825,515.42 17168,501.07 16903,497.24"];
	layer3_expert5_15 -> layer3_moe_agg_gpu5	[pos="e,16893,496.21 18240,567.17 18237,566.36 18234,565.62 18231,564.95 17979,507.63 17196,497.89 16903,496.27"];
	layer3_moe_agg_gpu5 -> layer3_moe_allreduce	[pos="e,12491,364.33 16689,490.89 16119,473.7 13314,389.16 12501,364.63"];
	layer3_output_gpu5	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU5
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 5",
		pos="12672,218.95",
		shape=rectangle,
		width=3.3889];
	layer3_output_gpu5 -> output	[pos="e,12402,145.52 12550,185.16 12506,173.41 12457,160.12 12412,148.14"];
	layer3_expert6_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="18519,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu6 -> layer3_expert6_0	[pos="e,18606,645.68 19741,722.19 19474,716.43 18845,698.07 18616,647.94",
		style=dashed];
	layer3_expert6_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="18711,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu6 -> layer3_expert6_1	[pos="e,18798,645.64 19741,720.61 19506,712.41 18999,690.58 18808,647.95",
		style=dashed];
	layer3_expert6_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="18903,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu6 -> layer3_expert6_2	[pos="e,18990,645.58 19741,718.32 19541,707.53 19153,683.15 19000,647.92",
		style=dashed];
	layer3_expert6_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19095,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu6 -> layer3_expert6_3	[pos="e,19182,645.4 19741,721 19607,714.86 19386,697.79 19192,647.96",
		style=dashed];
	layer3_expert6_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19287,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu6 -> layer3_expert6_4	[pos="e,19374,645.23 19741,713.21 19645,702.51 19509,683.09 19384,648",
		style=dashed];
	layer3_expert6_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19479,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu6 -> layer3_expert6_5	[pos="e,19566,644.84 19741,695.97 19692,683.59 19635,667.96 19576,648.07",
		style=dashed];
	layer3_expert6_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19671,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu6 -> layer3_expert6_6	[pos="e,19737,647.97 19796,683.86 19780,673.97 19763,663.32 19746,653.21",
		style=dashed];
	layer3_expert6_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="19863,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu6 -> layer3_expert6_7	[pos="e,19863,647.97 19863,683.86 19863,675.6 19863,666.82 19863,658.26",
		style=dashed];
	layer3_expert6_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20055,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu6 -> layer3_expert6_8	[pos="e,19989,647.97 19930,683.86 19946,673.97 19963,663.32 19980,653.21",
		style=dashed];
	layer3_expert6_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20247,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu6 -> layer3_expert6_9	[pos="e,20160,644.84 19985,695.97 20034,683.59 20091,667.96 20150,648.07",
		style=dashed];
	layer3_expert6_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20439,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu6 -> layer3_expert6_10	[pos="e,20352,645.23 19985,713.21 20081,702.51 20217,683.09 20342,648",
		style=dashed];
	layer3_expert6_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20631,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu6 -> layer3_expert6_11	[pos="e,20544,645.4 19985,721 20119,714.86 20340,697.79 20534,647.96",
		style=dashed];
	layer3_expert6_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="20823,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu6 -> layer3_expert6_12	[pos="e,20736,645.58 19985,718.32 20185,707.53 20573,683.15 20726,647.92",
		style=dashed];
	layer3_expert6_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="21015,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu6 -> layer3_expert6_13	[pos="e,20928,645.64 19985,720.61 20220,712.41 20727,690.58 20918,647.95",
		style=dashed];
	layer3_expert6_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="21207,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu6 -> layer3_expert6_14	[pos="e,21120,645.68 19985,722.19 20252,716.43 20881,698.07 21110,647.94",
		style=dashed];
	layer3_expert6_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU6
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 6",
		pos="21399,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu6 -> layer3_expert6_15	[pos="e,21312,645.71 19985,723.37 20282,719.87 21034,705.65 21302,647.96",
		style=dashed];
	layer3_moe_agg_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_MoE_Aggregate_GPU6
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 6",
		pos="19863,494.95",
		shape=rectangle,
		width=2.8194];
	layer3_expert6_0 -> layer3_moe_agg_gpu6	[pos="e,19761,497.09 18606,567.2 18609,566.38 18612,565.63 18615,564.95 18829,515.42 19486,501.07 19751,497.24"];
	layer3_expert6_1 -> layer3_moe_agg_gpu6	[pos="e,19761,498.29 18798,567.24 18801,566.41 18804,565.64 18807,564.95 18984,523.16 19517,504.77 19751,498.56"];
	layer3_expert6_2 -> layer3_moe_agg_gpu6	[pos="e,19761,500.01 18990,567.3 18993,566.45 18996,565.66 18999,564.95 19139,530.88 19551,509.25 19751,500.46"];
	layer3_expert6_3 -> layer3_moe_agg_gpu6	[pos="e,19761,497.06 19182,567.38 19185,566.51 19188,565.69 19191,564.95 19384,515.56 19616,501.33 19751,497.35"];
	layer3_expert6_4 -> layer3_moe_agg_gpu6	[pos="e,19761,502.97 19374,567.62 19377,566.67 19380,565.78 19383,564.95 19507,530.64 19653,512.73 19751,503.86"];
	layer3_expert6_5 -> layer3_moe_agg_gpu6	[pos="e,19761,516.06 19566,567.97 19569,566.92 19572,565.91 19575,564.95 19632,546.16 19697,530.11 19751,518.23"];
	layer3_expert6_6 -> layer3_moe_agg_gpu6	[pos="e,19805,529 19742,564.84 19760,554.78 19779,544.04 19796,534.11"];
	layer3_expert6_7 -> layer3_moe_agg_gpu6	[pos="e,19863,529.25 19863,564.68 19863,556.47 19863,547.81 19863,539.51"];
	layer3_expert6_8 -> layer3_moe_agg_gpu6	[pos="e,19921,529 19984,564.84 19966,554.78 19947,544.04 19930,534.11"];
	layer3_expert6_9 -> layer3_moe_agg_gpu6	[pos="e,19965,516.06 20160,567.97 20157,566.92 20154,565.91 20151,564.95 20094,546.16 20029,530.11 19975,518.23"];
	layer3_expert6_10 -> layer3_moe_agg_gpu6	[pos="e,19965,502.97 20352,567.62 20349,566.67 20346,565.78 20343,564.95 20219,530.64 20073,512.73 19975,503.86"];
	layer3_expert6_11 -> layer3_moe_agg_gpu6	[pos="e,19965,497.06 20544,567.38 20541,566.51 20538,565.69 20535,564.95 20342,515.56 20110,501.33 19975,497.35"];
	layer3_expert6_12 -> layer3_moe_agg_gpu6	[pos="e,19965,500.01 20736,567.3 20733,566.45 20730,565.66 20727,564.95 20587,530.88 20175,509.25 19975,500.46"];
	layer3_expert6_13 -> layer3_moe_agg_gpu6	[pos="e,19965,498.29 20928,567.24 20925,566.41 20922,565.64 20919,564.95 20742,523.16 20209,504.77 19975,498.56"];
	layer3_expert6_14 -> layer3_moe_agg_gpu6	[pos="e,19965,497.09 21120,567.2 21117,566.38 21114,565.63 21111,564.95 20897,515.42 20240,501.07 19975,497.24"];
	layer3_expert6_15 -> layer3_moe_agg_gpu6	[pos="e,19965,496.21 21312,567.17 21309,566.36 21306,565.62 21303,564.95 21051,507.63 20268,497.89 19975,496.27"];
	layer3_moe_agg_gpu6 -> layer3_moe_allreduce	[pos="e,12499,361.9 19761,492.13 18961,477.77 13682,383.11 12509,362.08"];
	layer3_output_gpu6	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU6
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 6",
		pos="12934,218.95",
		shape=rectangle,
		width=3.3889];
	layer3_output_gpu6 -> output	[pos="e,12494,136.87 12812,186.7 12809,186.1 12806,185.51 12803,184.95 12706,166.03 12597,150.17 12504,138.17"];
	layer3_expert7_0	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert0_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="21591,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu7 -> layer3_expert7_0	[pos="e,21678,645.68 22813,722.19 22546,716.43 21917,698.07 21688,647.94",
		style=dashed];
	layer3_expert7_1	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert1_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="21783,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu7 -> layer3_expert7_1	[pos="e,21870,645.64 22813,720.61 22578,712.41 22071,690.58 21880,647.95",
		style=dashed];
	layer3_expert7_2	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert2_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="21975,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu7 -> layer3_expert7_2	[pos="e,22062,645.58 22813,718.32 22613,707.53 22225,683.15 22072,647.92",
		style=dashed];
	layer3_expert7_3	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert3_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22167,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu7 -> layer3_expert7_3	[pos="e,22254,645.4 22813,721 22679,714.86 22458,697.79 22264,647.96",
		style=dashed];
	layer3_expert7_4	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert4_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22359,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu7 -> layer3_expert7_4	[pos="e,22446,645.23 22813,713.21 22717,702.51 22581,683.09 22456,648",
		style=dashed];
	layer3_expert7_5	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert5_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22551,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu7 -> layer3_expert7_5	[pos="e,22638,644.84 22813,695.97 22764,683.59 22707,667.96 22648,648.07",
		style=dashed];
	layer3_expert7_6	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert6_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22743,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu7 -> layer3_expert7_6	[pos="e,22809,647.97 22868,683.86 22852,673.97 22835,663.32 22818,653.21",
		style=dashed];
	layer3_expert7_7	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert7_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="22935,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu7 -> layer3_expert7_7	[pos="e,22935,647.97 22935,683.86 22935,675.6 22935,666.82 22935,658.26",
		style=dashed];
	layer3_expert7_8	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert8_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23127,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu7 -> layer3_expert7_8	[pos="e,23061,647.97 23002,683.86 23018,673.97 23035,663.32 23052,653.21",
		style=dashed];
	layer3_expert7_9	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert9_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23319,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu7 -> layer3_expert7_9	[pos="e,23232,644.84 23057,695.97 23106,683.59 23163,667.96 23222,648.07",
		style=dashed];
	layer3_expert7_10	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert10_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23511,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu7 -> layer3_expert7_10	[pos="e,23424,645.23 23057,713.21 23153,702.51 23289,683.09 23414,648",
		style=dashed];
	layer3_expert7_11	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert11_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23703,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu7 -> layer3_expert7_11	[pos="e,23616,645.4 23057,721 23191,714.86 23412,697.79 23606,647.96",
		style=dashed];
	layer3_expert7_12	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert12_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="23895,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu7 -> layer3_expert7_12	[pos="e,23808,645.58 23057,718.32 23257,707.53 23645,683.15 23798,647.92",
		style=dashed];
	layer3_expert7_13	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert13_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="24087,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu7 -> layer3_expert7_13	[pos="e,24000,645.64 23057,720.61 23292,712.41 23799,690.58 23990,647.95",
		style=dashed];
	layer3_expert7_14	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert14_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="24279,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu7 -> layer3_expert7_14	[pos="e,24192,645.68 23057,722.19 23324,716.43 23953,698.07 24182,647.94",
		style=dashed];
	layer3_expert7_15	[fillcolor=lightgreen,
		height=1.1528,
		label="L3_Expert15_GPU7
Input: [tokens,4096]
Output: [tokens,4096]
Expert hidden: 16384
GPU: 7",
		pos="24471,606.45",
		shape=rectangle,
		width=2.4167];
	layer3_gate_gpu7 -> layer3_expert7_15	[pos="e,24384,645.71 23057,723.37 23354,719.87 24106,705.65 24374,647.96",
		style=dashed];
	layer3_moe_agg_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_MoE_Aggregate_GPU7
Input: 16×[tokens,4096]
Output: [1024,2048,4096]
GPU: 7",
		pos="22935,494.95",
		shape=rectangle,
		width=2.8194];
	layer3_expert7_0 -> layer3_moe_agg_gpu7	[pos="e,22833,497.09 21678,567.2 21681,566.38 21684,565.63 21687,564.95 21901,515.42 22558,501.07 22823,497.24"];
	layer3_expert7_1 -> layer3_moe_agg_gpu7	[pos="e,22833,498.29 21870,567.24 21873,566.41 21876,565.64 21879,564.95 22056,523.16 22589,504.77 22823,498.56"];
	layer3_expert7_2 -> layer3_moe_agg_gpu7	[pos="e,22833,500.01 22062,567.3 22065,566.45 22068,565.66 22071,564.95 22211,530.88 22623,509.25 22823,500.46"];
	layer3_expert7_3 -> layer3_moe_agg_gpu7	[pos="e,22833,497.06 22254,567.38 22257,566.51 22260,565.69 22263,564.95 22456,515.56 22688,501.33 22823,497.35"];
	layer3_expert7_4 -> layer3_moe_agg_gpu7	[pos="e,22833,502.97 22446,567.62 22449,566.67 22452,565.78 22455,564.95 22579,530.64 22725,512.73 22823,503.86"];
	layer3_expert7_5 -> layer3_moe_agg_gpu7	[pos="e,22833,516.06 22638,567.97 22641,566.92 22644,565.91 22647,564.95 22704,546.16 22769,530.11 22823,518.23"];
	layer3_expert7_6 -> layer3_moe_agg_gpu7	[pos="e,22877,529 22814,564.84 22832,554.78 22851,544.04 22868,534.11"];
	layer3_expert7_7 -> layer3_moe_agg_gpu7	[pos="e,22935,529.25 22935,564.68 22935,556.47 22935,547.81 22935,539.51"];
	layer3_expert7_8 -> layer3_moe_agg_gpu7	[pos="e,22993,529 23056,564.84 23038,554.78 23019,544.04 23002,534.11"];
	layer3_expert7_9 -> layer3_moe_agg_gpu7	[pos="e,23037,516.06 23232,567.97 23229,566.92 23226,565.91 23223,564.95 23166,546.16 23101,530.11 23047,518.23"];
	layer3_expert7_10 -> layer3_moe_agg_gpu7	[pos="e,23037,502.97 23424,567.62 23421,566.67 23418,565.78 23415,564.95 23291,530.64 23145,512.73 23047,503.86"];
	layer3_expert7_11 -> layer3_moe_agg_gpu7	[pos="e,23037,497.06 23616,567.38 23613,566.51 23610,565.69 23607,564.95 23414,515.56 23182,501.33 23047,497.35"];
	layer3_expert7_12 -> layer3_moe_agg_gpu7	[pos="e,23037,500.01 23808,567.3 23805,566.45 23802,565.66 23799,564.95 23659,530.88 23247,509.25 23047,500.46"];
	layer3_expert7_13 -> layer3_moe_agg_gpu7	[pos="e,23037,498.29 24000,567.24 23997,566.41 23994,565.64 23991,564.95 23814,523.16 23281,504.77 23047,498.56"];
	layer3_expert7_14 -> layer3_moe_agg_gpu7	[pos="e,23037,497.09 24192,567.2 24189,566.38 24186,565.63 24183,564.95 23969,515.42 23312,501.07 23047,497.24"];
	layer3_expert7_15 -> layer3_moe_agg_gpu7	[pos="e,23037,496.21 24384,567.17 24381,566.36 24378,565.62 24375,564.95 24123,507.63 23340,497.89 23047,496.27"];
	layer3_moe_agg_gpu7 -> layer3_moe_allreduce	[pos="e,12503,360.81 22833,492.66 21847,480.06 13977,379.62 12513,360.94"];
	layer3_output_gpu7	[fillcolor=lightgreen,
		height=0.94444,
		label="L3_Residual+LayerNorm_GPU7
Input: [1024,2048,4096]x2
Output: [1024,2048,4096]
GPU: 7",
		pos="13196,218.95",
		shape=rectangle,
		width=3.3889];
	layer3_output_gpu7 -> output	[pos="e,12546,126.79 13074,186.52 13071,185.97 13068,185.45 13065,184.95 12897,156.28 12707,138.37 12556,127.53"];
	layer3_moe_allreduce -> layer3_output_gpu0	[pos="e,11484,251.23 12104,338.97 11947,322.28 11709,293.66 11494,253.11"];
	layer3_moe_allreduce -> layer3_output_gpu1	[pos="e,11746,250.99 12136,329.94 12033,310.71 11891,283.1 11756,253.23"];
	layer3_moe_allreduce -> layer3_output_gpu2	[pos="e,11981,252.99 12173,319.24 12116,299.72 12047,275.8 11991,256.33"];
	layer3_moe_allreduce -> layer3_output_gpu3	[pos="e,12180,253.15 12228,303.37 12215,289.12 12200,273.91 12187,260.44"];
	layer3_moe_allreduce -> layer3_output_gpu4	[pos="e,12378,253.15 12330,303.37 12343,289.12 12358,273.91 12371,260.44"];
	layer3_moe_allreduce -> layer3_output_gpu5	[pos="e,12577,252.99 12385,319.24 12442,299.72 12511,275.8 12567,256.33"];
	layer3_moe_allreduce -> layer3_output_gpu6	[pos="e,12812,250.99 12422,329.94 12525,310.71 12667,283.1 12802,253.23"];
	layer3_moe_allreduce -> layer3_output_gpu7	[pos="e,13074,251.23 12454,338.97 12611,322.28 12849,293.66 13064,253.11"];
}
