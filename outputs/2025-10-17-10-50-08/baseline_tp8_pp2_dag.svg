<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: TP8_PP2_Baseline Pages: 1 -->
<svg width="2160pt" height="91pt"
 viewBox="0.00 0.00 2160.00 91.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.03 0.03) rotate(0) translate(4 2912)">
<title>TP8_PP2_Baseline</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2912 68834,-2912 68834,4 -4,4"/>
<text text-anchor="middle" x="34415" y="-54" font-family="Times,serif" font-size="20.00">Baseline: TP=8, PP=2 Hybrid</text>
<text text-anchor="middle" x="34415" y="-32" font-family="Times,serif" font-size="20.00">16 GPUs total</text>
<text text-anchor="middle" x="34415" y="-10" font-family="Times,serif" font-size="20.00">Tensor Parallelism 8 per stage, Pipeline 2 stages</text>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="11688.5" cy="-2859" rx="292.07" ry="37.45"/>
<text text-anchor="middle" x="11688.5" y="-2870.3" font-family="Times,serif" font-size="14.00">INPUT</text>
<text text-anchor="middle" x="11688.5" y="-2855.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="11688.5" y="-2840.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- layer0_qkv_gpu0 -->
<g id="node3" class="node">
<title>layer0_qkv_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="10936.5,-2774 10726.5,-2774 10726.5,-2676 10936.5,-2676 10936.5,-2774"/>
<text text-anchor="middle" x="10831.5" y="-2758.8" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU0</text>
<text text-anchor="middle" x="10831.5" y="-2743.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="10831.5" y="-2728.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="10831.5" y="-2713.8" font-family="Times,serif" font-size="14.00">Heads: 0&#45;3</text>
<text text-anchor="middle" x="10831.5" y="-2698.8" font-family="Times,serif" font-size="14.00">TP Slice: 0</text>
<text text-anchor="middle" x="10831.5" y="-2683.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu0</title>
<path fill="none" stroke="black" d="M11425.09,-2842.78C11285.86,-2830.93 11112.89,-2810.14 10961.5,-2774 10956.51,-2772.81 10951.45,-2771.48 10946.36,-2770.05"/>
<polygon fill="black" stroke="black" points="10947.14,-2766.63 10936.56,-2767.18 10945.18,-2773.35 10947.14,-2766.63"/>
</g>
<!-- layer0_qkv_gpu1 -->
<g id="node26" class="node">
<title>layer0_qkv_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11180.5,-2774 10970.5,-2774 10970.5,-2676 11180.5,-2676 11180.5,-2774"/>
<text text-anchor="middle" x="11075.5" y="-2758.8" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU1</text>
<text text-anchor="middle" x="11075.5" y="-2743.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11075.5" y="-2728.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="11075.5" y="-2713.8" font-family="Times,serif" font-size="14.00">Heads: 4&#45;7</text>
<text text-anchor="middle" x="11075.5" y="-2698.8" font-family="Times,serif" font-size="14.00">TP Slice: 1</text>
<text text-anchor="middle" x="11075.5" y="-2683.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu1 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu1</title>
<path fill="none" stroke="black" d="M11495.6,-2830.86C11408.98,-2816.87 11305.91,-2797.73 11214.5,-2774 11206.68,-2771.97 11198.67,-2769.71 11190.64,-2767.31"/>
<polygon fill="black" stroke="black" points="11191.43,-2763.89 11180.84,-2764.31 11189.38,-2770.58 11191.43,-2763.89"/>
</g>
<!-- layer0_qkv_gpu2 -->
<g id="node49" class="node">
<title>layer0_qkv_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="11433.5,-2774 11223.5,-2774 11223.5,-2676 11433.5,-2676 11433.5,-2774"/>
<text text-anchor="middle" x="11328.5" y="-2758.8" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU2</text>
<text text-anchor="middle" x="11328.5" y="-2743.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11328.5" y="-2728.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="11328.5" y="-2713.8" font-family="Times,serif" font-size="14.00">Heads: 8&#45;11</text>
<text text-anchor="middle" x="11328.5" y="-2698.8" font-family="Times,serif" font-size="14.00">TP Slice: 2</text>
<text text-anchor="middle" x="11328.5" y="-2683.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu2 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu2</title>
<path fill="none" stroke="black" d="M11594.38,-2823.49C11548.19,-2806.55 11492.15,-2786 11443.44,-2768.15"/>
<polygon fill="black" stroke="black" points="11444.4,-2764.77 11433.81,-2764.61 11441.99,-2771.34 11444.4,-2764.77"/>
</g>
<!-- layer0_qkv_gpu3 -->
<g id="node72" class="node">
<title>layer0_qkv_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="11686.5,-2774 11476.5,-2774 11476.5,-2676 11686.5,-2676 11686.5,-2774"/>
<text text-anchor="middle" x="11581.5" y="-2758.8" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU3</text>
<text text-anchor="middle" x="11581.5" y="-2743.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11581.5" y="-2728.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="11581.5" y="-2713.8" font-family="Times,serif" font-size="14.00">Heads: 12&#45;15</text>
<text text-anchor="middle" x="11581.5" y="-2698.8" font-family="Times,serif" font-size="14.00">TP Slice: 3</text>
<text text-anchor="middle" x="11581.5" y="-2683.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu3 -->
<g id="edge4" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu3</title>
<path fill="none" stroke="black" d="M11658.98,-2821.58C11649.05,-2809.33 11637.73,-2795.37 11626.87,-2781.97"/>
<polygon fill="black" stroke="black" points="11629.56,-2779.73 11620.55,-2774.17 11624.12,-2784.14 11629.56,-2779.73"/>
</g>
<!-- layer0_qkv_gpu4 -->
<g id="node95" class="node">
<title>layer0_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="11923.5,-2774 11713.5,-2774 11713.5,-2676 11923.5,-2676 11923.5,-2774"/>
<text text-anchor="middle" x="11818.5" y="-2758.8" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU4</text>
<text text-anchor="middle" x="11818.5" y="-2743.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="11818.5" y="-2728.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="11818.5" y="-2713.8" font-family="Times,serif" font-size="14.00">Heads: 16&#45;19</text>
<text text-anchor="middle" x="11818.5" y="-2698.8" font-family="Times,serif" font-size="14.00">TP Slice: 4</text>
<text text-anchor="middle" x="11818.5" y="-2683.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu4 -->
<g id="edge5" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu4</title>
<path fill="none" stroke="black" d="M11724.37,-2821.58C11736.54,-2809.22 11750.44,-2795.11 11763.74,-2781.6"/>
<polygon fill="black" stroke="black" points="11766.54,-2783.75 11771.06,-2774.17 11761.55,-2778.84 11766.54,-2783.75"/>
</g>
<!-- layer0_qkv_gpu5 -->
<g id="node118" class="node">
<title>layer0_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12176.5,-2774 11966.5,-2774 11966.5,-2676 12176.5,-2676 12176.5,-2774"/>
<text text-anchor="middle" x="12071.5" y="-2758.8" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU5</text>
<text text-anchor="middle" x="12071.5" y="-2743.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12071.5" y="-2728.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="12071.5" y="-2713.8" font-family="Times,serif" font-size="14.00">Heads: 20&#45;23</text>
<text text-anchor="middle" x="12071.5" y="-2698.8" font-family="Times,serif" font-size="14.00">TP Slice: 5</text>
<text text-anchor="middle" x="12071.5" y="-2683.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu5 -->
<g id="edge6" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu5</title>
<path fill="none" stroke="black" d="M11788.23,-2823.69C11832.43,-2808.48 11885.06,-2790.36 11932.5,-2774 11940.39,-2771.28 11948.54,-2768.47 11956.74,-2765.64"/>
<polygon fill="black" stroke="black" points="11958.08,-2768.88 11966.39,-2762.31 11955.79,-2762.26 11958.08,-2768.88"/>
</g>
<!-- layer0_qkv_gpu6 -->
<g id="node141" class="node">
<title>layer0_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="12445.5,-2774 12235.5,-2774 12235.5,-2676 12445.5,-2676 12445.5,-2774"/>
<text text-anchor="middle" x="12340.5" y="-2758.8" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU6</text>
<text text-anchor="middle" x="12340.5" y="-2743.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12340.5" y="-2728.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="12340.5" y="-2713.8" font-family="Times,serif" font-size="14.00">Heads: 24&#45;27</text>
<text text-anchor="middle" x="12340.5" y="-2698.8" font-family="Times,serif" font-size="14.00">TP Slice: 6</text>
<text text-anchor="middle" x="12340.5" y="-2683.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu6 -->
<g id="edge7" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu6</title>
<path fill="none" stroke="black" d="M11883.84,-2831.13C11975.93,-2816.89 12086.97,-2797.47 12185.5,-2774 12198.51,-2770.9 12212.03,-2767.3 12225.41,-2763.49"/>
<polygon fill="black" stroke="black" points="12226.49,-2766.82 12235.13,-2760.68 12224.55,-2760.1 12226.49,-2766.82"/>
</g>
<!-- layer0_qkv_gpu7 -->
<g id="node164" class="node">
<title>layer0_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="12698.5,-2774 12488.5,-2774 12488.5,-2676 12698.5,-2676 12698.5,-2774"/>
<text text-anchor="middle" x="12593.5" y="-2758.8" font-family="Times,serif" font-size="14.00">L0_QKV_Projection_GPU7</text>
<text text-anchor="middle" x="12593.5" y="-2743.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="12593.5" y="-2728.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="12593.5" y="-2713.8" font-family="Times,serif" font-size="14.00">Heads: 28&#45;31</text>
<text text-anchor="middle" x="12593.5" y="-2698.8" font-family="Times,serif" font-size="14.00">TP Slice: 7</text>
<text text-anchor="middle" x="12593.5" y="-2683.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- input&#45;&gt;layer0_qkv_gpu7 -->
<g id="edge8" class="edge">
<title>input&#45;&gt;layer0_qkv_gpu7</title>
<path fill="none" stroke="black" d="M11954.57,-2843.48C12103.02,-2831.73 12290.52,-2810.82 12454.5,-2774 12462.38,-2772.23 12470.44,-2770.17 12478.5,-2767.9"/>
<polygon fill="black" stroke="black" points="12479.71,-2771.2 12488.34,-2765.06 12477.76,-2764.48 12479.71,-2771.2"/>
</g>
<!-- stage0_header -->
<g id="node2" class="node">
<title>stage0_header</title>
<ellipse fill="lightblue" stroke="black" cx="23578.5" cy="-2859" rx="108.37" ry="26.76"/>
<ellipse fill="none" stroke="black" cx="23578.5" cy="-2859" rx="112.37" ry="30.74"/>
<text text-anchor="middle" x="23578.5" y="-2862.8" font-family="Times,serif" font-size="14.00">Stage 0 (GPUs 0&#45;7)</text>
<text text-anchor="middle" x="23578.5" y="-2847.8" font-family="Times,serif" font-size="14.00">Layers 0&#45;1</text>
</g>
<!-- layer0_attn_gpu0 -->
<g id="node4" class="node">
<title>layer0_attn_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="10912,-2640 10669,-2640 10669,-2557 10912,-2557 10912,-2640"/>
<text text-anchor="middle" x="10790.5" y="-2624.8" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU0</text>
<text text-anchor="middle" x="10790.5" y="-2609.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="10790.5" y="-2594.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="10790.5" y="-2579.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="10790.5" y="-2564.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_qkv_gpu0&#45;&gt;layer0_attn_gpu0 -->
<g id="edge9" class="edge">
<title>layer0_qkv_gpu0&#45;&gt;layer0_attn_gpu0</title>
<path fill="none" stroke="black" d="M10815.65,-2675.87C10812.83,-2667.31 10809.89,-2658.39 10807.06,-2649.78"/>
<polygon fill="black" stroke="black" points="10810.37,-2648.63 10803.91,-2640.23 10803.72,-2650.82 10810.37,-2648.63"/>
</g>
<!-- layer0_attn_proj_gpu0 -->
<g id="node5" class="node">
<title>layer0_attn_proj_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="10890.5,-2487 10690.5,-2487 10690.5,-2419 10890.5,-2419 10890.5,-2487"/>
<text text-anchor="middle" x="10790.5" y="-2471.8" font-family="Times,serif" font-size="14.00">L0_Attn_Projection_GPU0</text>
<text text-anchor="middle" x="10790.5" y="-2456.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="10790.5" y="-2441.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="10790.5" y="-2426.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_attn_gpu0&#45;&gt;layer0_attn_proj_gpu0 -->
<g id="edge10" class="edge">
<title>layer0_attn_gpu0&#45;&gt;layer0_attn_proj_gpu0</title>
<path fill="none" stroke="black" d="M10790.5,-2556.76C10790.5,-2538.17 10790.5,-2516.13 10790.5,-2497.24"/>
<polygon fill="black" stroke="black" points="10794,-2497.11 10790.5,-2487.11 10787,-2497.11 10794,-2497.11"/>
</g>
<!-- layer0_attn_norm_gpu0 -->
<g id="node6" class="node">
<title>layer0_attn_norm_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="10908.5,-2169.5 10664.5,-2169.5 10664.5,-2101.5 10908.5,-2101.5 10908.5,-2169.5"/>
<text text-anchor="middle" x="10786.5" y="-2154.3" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU0</text>
<text text-anchor="middle" x="10786.5" y="-2139.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="10786.5" y="-2124.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="10786.5" y="-2109.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_attn_proj_gpu0&#45;&gt;layer0_attn_norm_gpu0 -->
<g id="edge11" class="edge">
<title>layer0_attn_proj_gpu0&#45;&gt;layer0_attn_norm_gpu0</title>
<path fill="none" stroke="black" d="M10790.08,-2418.83C10789.35,-2361.43 10787.86,-2243.62 10787.05,-2179.83"/>
<polygon fill="black" stroke="black" points="10790.55,-2179.65 10786.92,-2169.7 10783.55,-2179.74 10790.55,-2179.65"/>
</g>
<!-- layer0_allreduce_attn -->
<g id="node187" class="node">
<title>layer0_allreduce_attn</title>
<polygon fill="lightcoral" stroke="black" points="11702.5,-2349 11499.5,-2281 11702.5,-2213 11905.5,-2281 11702.5,-2349"/>
<text text-anchor="middle" x="11702.5" y="-2299.8" font-family="Times,serif" font-size="14.00">L0_All&#45;Reduce_Attention</text>
<text text-anchor="middle" x="11702.5" y="-2284.8" font-family="Times,serif" font-size="14.00">Input: 8×[1024,2048,512]</text>
<text text-anchor="middle" x="11702.5" y="-2269.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11702.5" y="-2254.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
</g>
<!-- layer0_attn_proj_gpu0&#45;&gt;layer0_allreduce_attn -->
<g id="edge305" class="edge">
<title>layer0_attn_proj_gpu0&#45;&gt;layer0_allreduce_attn</title>
<path fill="none" stroke="black" d="M10854.85,-2418.84C10881.37,-2406.46 10912.8,-2393.38 10942.5,-2385 11135.61,-2330.53 11364.71,-2304.49 11520.52,-2292.3"/>
<polygon fill="black" stroke="black" points="11520.98,-2295.77 11530.68,-2291.51 11520.44,-2288.79 11520.98,-2295.77"/>
</g>
<!-- layer0_gate_gpu0 -->
<g id="node7" class="node">
<title>layer0_gate_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1668.5,-2058 1424.5,-2058 1424.5,-1975 1668.5,-1975 1668.5,-2058"/>
<text text-anchor="middle" x="1546.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L0_Gate_GPU0</text>
<text text-anchor="middle" x="1546.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="1546.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="1546.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="1546.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_attn_norm_gpu0&#45;&gt;layer0_gate_gpu0 -->
<g id="edge12" class="edge">
<title>layer0_attn_norm_gpu0&#45;&gt;layer0_gate_gpu0</title>
<path fill="none" stroke="black" d="M10664.46,-2133.17C10014.62,-2126.06 6894.86,-2091.62 4343.5,-2058 3317.71,-2044.48 2080.35,-2025.7 1679.03,-2019.54"/>
<polygon fill="black" stroke="black" points="1678.89,-2016.04 1668.84,-2019.39 1678.79,-2023.04 1678.89,-2016.04"/>
</g>
<!-- layer0_expert0_0 -->
<g id="node8" class="node">
<title>layer0_expert0_0</title>
<polygon fill="lightgreen" stroke="black" points="165,-1939 0,-1939 0,-1856 165,-1856 165,-1939"/>
<text text-anchor="middle" x="82.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU0</text>
<text text-anchor="middle" x="82.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="82.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="82.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="82.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_0 -->
<g id="edge13" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1424.34,-2014.34C1137.75,-2010.72 428,-1996.31 175.02,-1939.07"/>
<polygon fill="black" stroke="black" points="175.67,-1935.63 165.13,-1936.76 174.07,-1942.44 175.67,-1935.63"/>
</g>
<!-- layer0_expert0_1 -->
<g id="node9" class="node">
<title>layer0_expert0_1</title>
<polygon fill="lightgreen" stroke="black" points="348,-1939 183,-1939 183,-1856 348,-1856 348,-1939"/>
<text text-anchor="middle" x="265.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU0</text>
<text text-anchor="middle" x="265.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="265.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="265.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="265.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_1 -->
<g id="edge14" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1424.05,-2013.1C1166.44,-2007.18 575,-1988.75 358.18,-1939.11"/>
<polygon fill="black" stroke="black" points="358.68,-1935.63 348.14,-1936.73 357.06,-1942.44 358.68,-1935.63"/>
</g>
<!-- layer0_expert0_2 -->
<g id="node10" class="node">
<title>layer0_expert0_2</title>
<polygon fill="lightgreen" stroke="black" points="531,-1939 366,-1939 366,-1856 531,-1856 531,-1939"/>
<text text-anchor="middle" x="448.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU0</text>
<text text-anchor="middle" x="448.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="448.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="448.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="448.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_2 -->
<g id="edge15" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1424.26,-2011.44C1198.14,-2003.08 721.86,-1981.29 541.08,-1939.1"/>
<polygon fill="black" stroke="black" points="541.69,-1935.65 531.15,-1936.68 540.04,-1942.45 541.69,-1935.65"/>
</g>
<!-- layer0_expert0_3 -->
<g id="node11" class="node">
<title>layer0_expert0_3</title>
<polygon fill="lightgreen" stroke="black" points="714,-1939 549,-1939 549,-1856 714,-1856 714,-1939"/>
<text text-anchor="middle" x="631.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU0</text>
<text text-anchor="middle" x="631.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="631.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="631.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="631.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_3 -->
<g id="edge16" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1424.36,-2009.05C1232.78,-1998.12 869.32,-1973.96 724.23,-1939.15"/>
<polygon fill="black" stroke="black" points="724.72,-1935.66 714.17,-1936.62 723.01,-1942.45 724.72,-1935.66"/>
</g>
<!-- layer0_expert0_4 -->
<g id="node12" class="node">
<title>layer0_expert0_4</title>
<polygon fill="lightgreen" stroke="black" points="897,-1939 732,-1939 732,-1856 897,-1856 897,-1939"/>
<text text-anchor="middle" x="814.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU0</text>
<text text-anchor="middle" x="814.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="814.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="814.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="814.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_4 -->
<g id="edge17" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1424.21,-2011.77C1295.95,-2005.4 1089.18,-1988.17 906.95,-1939.19"/>
<polygon fill="black" stroke="black" points="907.76,-1935.78 897.19,-1936.53 905.92,-1942.53 907.76,-1935.78"/>
</g>
<!-- layer0_expert0_5 -->
<g id="node13" class="node">
<title>layer0_expert0_5</title>
<polygon fill="lightgreen" stroke="black" points="1080,-1939 915,-1939 915,-1856 1080,-1856 1080,-1939"/>
<text text-anchor="middle" x="997.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU0</text>
<text text-anchor="middle" x="997.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="997.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="997.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="997.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_5 -->
<g id="edge18" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1424.05,-2003.58C1333.24,-1992.76 1206.81,-1973.52 1090.06,-1939.28"/>
<polygon fill="black" stroke="black" points="1090.82,-1935.86 1080.24,-1936.36 1088.83,-1942.57 1090.82,-1935.86"/>
</g>
<!-- layer0_expert0_6 -->
<g id="node14" class="node">
<title>layer0_expert0_6</title>
<polygon fill="lightgreen" stroke="black" points="1263,-1939 1098,-1939 1098,-1856 1263,-1856 1263,-1939"/>
<text text-anchor="middle" x="1180.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU0</text>
<text text-anchor="middle" x="1180.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="1180.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="1180.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="1180.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_6 -->
<g id="edge19" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1424.47,-1985.69C1378.95,-1973.56 1326.87,-1958.48 1272.56,-1939.26"/>
<polygon fill="black" stroke="black" points="1273.71,-1935.96 1263.12,-1935.89 1271.35,-1942.55 1273.71,-1935.96"/>
</g>
<!-- layer0_expert0_7 -->
<g id="node15" class="node">
<title>layer0_expert0_7</title>
<polygon fill="lightgreen" stroke="black" points="1446,-1939 1281,-1939 1281,-1856 1446,-1856 1446,-1939"/>
<text text-anchor="middle" x="1363.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU0</text>
<text text-anchor="middle" x="1363.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="1363.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="1363.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="1363.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_7 -->
<g id="edge20" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1483.01,-1974.91C1467.68,-1965.11 1451.19,-1954.56 1435.5,-1944.53"/>
<polygon fill="black" stroke="black" points="1437.19,-1941.46 1426.88,-1939.02 1433.42,-1947.36 1437.19,-1941.46"/>
</g>
<!-- layer0_expert0_8 -->
<g id="node16" class="node">
<title>layer0_expert0_8</title>
<polygon fill="lightgreen" stroke="black" points="1629,-1939 1464,-1939 1464,-1856 1629,-1856 1629,-1939"/>
<text text-anchor="middle" x="1546.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU0</text>
<text text-anchor="middle" x="1546.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="1546.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="1546.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="1546.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_8 -->
<g id="edge21" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1546.5,-1974.91C1546.5,-1966.65 1546.5,-1957.86 1546.5,-1949.3"/>
<polygon fill="black" stroke="black" points="1550,-1949.02 1546.5,-1939.02 1543,-1949.02 1550,-1949.02"/>
</g>
<!-- layer0_expert0_9 -->
<g id="node17" class="node">
<title>layer0_expert0_9</title>
<polygon fill="lightgreen" stroke="black" points="1812,-1939 1647,-1939 1647,-1856 1812,-1856 1812,-1939"/>
<text text-anchor="middle" x="1729.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU0</text>
<text text-anchor="middle" x="1729.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="1729.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="1729.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="1729.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_9 -->
<g id="edge22" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1609.99,-1974.91C1625.32,-1965.11 1641.81,-1954.56 1657.5,-1944.53"/>
<polygon fill="black" stroke="black" points="1659.58,-1947.36 1666.12,-1939.02 1655.81,-1941.46 1659.58,-1947.36"/>
</g>
<!-- layer0_expert0_10 -->
<g id="node18" class="node">
<title>layer0_expert0_10</title>
<polygon fill="lightgreen" stroke="black" points="1995,-1939 1830,-1939 1830,-1856 1995,-1856 1995,-1939"/>
<text text-anchor="middle" x="1912.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU0</text>
<text text-anchor="middle" x="1912.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="1912.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="1912.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="1912.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_10 -->
<g id="edge23" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1668.72,-1985.37C1716.54,-1972.55 1771.55,-1956.51 1820.5,-1939 1820.6,-1938.97 1820.7,-1938.93 1820.79,-1938.9"/>
<polygon fill="black" stroke="black" points="1821.81,-1942.25 1829.97,-1935.49 1819.38,-1935.69 1821.81,-1942.25"/>
</g>
<!-- layer0_expert0_11 -->
<g id="node19" class="node">
<title>layer0_expert0_11</title>
<polygon fill="lightgreen" stroke="black" points="2178,-1939 2013,-1939 2013,-1856 2178,-1856 2178,-1939"/>
<text text-anchor="middle" x="2095.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU0</text>
<text text-anchor="middle" x="2095.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="2095.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="2095.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="2095.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_11 -->
<g id="edge24" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1668.64,-2003.42C1759.24,-1992.52 1885.39,-1973.25 2002.96,-1938.94"/>
<polygon fill="black" stroke="black" points="2004.26,-1942.2 2012.86,-1936.01 2002.28,-1935.49 2004.26,-1942.2"/>
</g>
<!-- layer0_expert0_12 -->
<g id="node20" class="node">
<title>layer0_expert0_12</title>
<polygon fill="lightgreen" stroke="black" points="2361,-1939 2196,-1939 2196,-1856 2361,-1856 2361,-1939"/>
<text text-anchor="middle" x="2278.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU0</text>
<text text-anchor="middle" x="2278.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="2278.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="2278.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="2278.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_12 -->
<g id="edge25" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1668.56,-2011.6C1796.59,-2005.1 2003.01,-1987.76 2186.11,-1938.85"/>
<polygon fill="black" stroke="black" points="2187.18,-1942.19 2195.91,-1936.2 2185.35,-1935.43 2187.18,-1942.19"/>
</g>
<!-- layer0_expert0_13 -->
<g id="node21" class="node">
<title>layer0_expert0_13</title>
<polygon fill="lightgreen" stroke="black" points="2544,-1939 2379,-1939 2379,-1856 2544,-1856 2544,-1939"/>
<text text-anchor="middle" x="2461.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU0</text>
<text text-anchor="middle" x="2461.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="2461.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="2461.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="2461.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_13 -->
<g id="edge26" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1668.87,-2008.96C1860.31,-1997.93 2222.9,-1973.64 2368.82,-1938.83"/>
<polygon fill="black" stroke="black" points="2370.09,-1942.12 2378.94,-1936.3 2368.39,-1935.33 2370.09,-1942.12"/>
</g>
<!-- layer0_expert0_14 -->
<g id="node22" class="node">
<title>layer0_expert0_14</title>
<polygon fill="lightgreen" stroke="black" points="2727,-1939 2562,-1939 2562,-1856 2727,-1856 2727,-1939"/>
<text text-anchor="middle" x="2644.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU0</text>
<text text-anchor="middle" x="2644.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="2644.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="2644.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="2644.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_14 -->
<g id="edge27" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1668.6,-2011.37C1894.48,-2002.9 2370.24,-1980.94 2551.97,-1938.78"/>
<polygon fill="black" stroke="black" points="2553.06,-1942.12 2561.96,-1936.37 2551.42,-1935.32 2553.06,-1942.12"/>
</g>
<!-- layer0_expert0_15 -->
<g id="node23" class="node">
<title>layer0_expert0_15</title>
<polygon fill="lightgreen" stroke="black" points="2910,-1939 2745,-1939 2745,-1856 2910,-1856 2910,-1939"/>
<text text-anchor="middle" x="2827.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU0</text>
<text text-anchor="middle" x="2827.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="2827.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="2827.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="2827.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gate_gpu0&#45;&gt;layer0_expert0_15 -->
<g id="edge28" class="edge">
<title>layer0_gate_gpu0&#45;&gt;layer0_expert0_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1668.83,-2013.04C1926.32,-2006.99 2517.68,-1988.3 2735.21,-1938.73"/>
<polygon fill="black" stroke="black" points="2736.04,-1942.13 2744.97,-1936.42 2734.43,-1935.31 2736.04,-1942.13"/>
</g>
<!-- layer0_moe_agg_gpu0 -->
<g id="node24" class="node">
<title>layer0_moe_agg_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1739,-1793.5 1536,-1793.5 1536,-1710.5 1739,-1710.5 1739,-1793.5"/>
<text text-anchor="middle" x="1637.5" y="-1778.3" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU0</text>
<text text-anchor="middle" x="1637.5" y="-1763.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="1637.5" y="-1748.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="1637.5" y="-1733.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="1637.5" y="-1718.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_expert0_0&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge29" class="edge">
<title>layer0_expert0_0&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M165.15,-1858.3C167.94,-1857.46 170.73,-1856.69 173.5,-1856 429.43,-1792.15 1229,-1764.21 1525.44,-1755.85"/>
<polygon fill="black" stroke="black" points="1525.87,-1759.34 1535.77,-1755.57 1525.68,-1752.35 1525.87,-1759.34"/>
</g>
<!-- layer0_expert0_1&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge30" class="edge">
<title>layer0_expert0_1&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M348.15,-1858.33C350.95,-1857.49 353.74,-1856.7 356.5,-1856 576.5,-1799.95 1256.25,-1767.92 1525.76,-1757.15"/>
<polygon fill="black" stroke="black" points="1526.1,-1760.63 1535.95,-1756.74 1525.82,-1753.64 1526.1,-1760.63"/>
</g>
<!-- layer0_expert0_2&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge31" class="edge">
<title>layer0_expert0_2&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M531.17,-1858.38C533.96,-1857.52 536.74,-1856.72 539.5,-1856 723.69,-1807.76 1284.45,-1772.31 1525.46,-1758.89"/>
<polygon fill="black" stroke="black" points="1525.85,-1762.37 1535.64,-1758.32 1525.47,-1755.38 1525.85,-1762.37"/>
</g>
<!-- layer0_expert0_3&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge32" class="edge">
<title>layer0_expert0_3&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M714.18,-1858.45C716.97,-1857.57 719.75,-1856.75 722.5,-1856 1004.76,-1779.27 1350.99,-1759.61 1525.53,-1754.63"/>
<polygon fill="black" stroke="black" points="1525.86,-1758.12 1535.76,-1754.35 1525.66,-1751.13 1525.86,-1758.12"/>
</g>
<!-- layer0_expert0_4&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge33" class="edge">
<title>layer0_expert0_4&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M897.21,-1858.55C899.99,-1857.64 902.76,-1856.79 905.5,-1856 1119.79,-1794.55 1380.3,-1769.07 1525.64,-1759.04"/>
<polygon fill="black" stroke="black" points="1526.16,-1762.51 1535.9,-1758.34 1525.69,-1755.53 1526.16,-1762.51"/>
</g>
<!-- layer0_expert0_5&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge34" class="edge">
<title>layer0_expert0_5&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1080.01,-1858.8C1082.86,-1857.81 1085.69,-1856.87 1088.5,-1856 1236.45,-1809.89 1413.61,-1781.21 1525.87,-1766.17"/>
<polygon fill="black" stroke="black" points="1526.4,-1769.63 1535.85,-1764.85 1525.48,-1762.69 1526.4,-1769.63"/>
</g>
<!-- layer0_expert0_6&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge35" class="edge">
<title>layer0_expert0_6&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1263.12,-1859.12C1265.94,-1858.04 1268.74,-1857 1271.5,-1856 1355.43,-1825.69 1452.77,-1798.67 1525.96,-1779.92"/>
<polygon fill="black" stroke="black" points="1526.85,-1783.31 1535.67,-1777.44 1525.12,-1776.52 1526.85,-1783.31"/>
</g>
<!-- layer0_expert0_7&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge36" class="edge">
<title>layer0_expert0_7&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1440.92,-1855.95C1475.06,-1838.07 1515.33,-1816.99 1550.5,-1798.56"/>
<polygon fill="black" stroke="black" points="1552.56,-1801.43 1559.8,-1793.69 1549.32,-1795.23 1552.56,-1801.43"/>
</g>
<!-- layer0_expert0_8&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge37" class="edge">
<title>layer0_expert0_8&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1572.33,-1855.76C1582.8,-1839.25 1595,-1820.03 1605.98,-1802.7"/>
<polygon fill="black" stroke="black" points="1609.2,-1804.16 1611.6,-1793.84 1603.29,-1800.41 1609.2,-1804.16"/>
</g>
<!-- layer0_expert0_9&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge38" class="edge">
<title>layer0_expert0_9&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1703.38,-1855.76C1692.8,-1839.25 1680.47,-1820.03 1669.36,-1802.7"/>
<polygon fill="black" stroke="black" points="1672.03,-1800.37 1663.68,-1793.84 1666.13,-1804.15 1672.03,-1800.37"/>
</g>
<!-- layer0_expert0_10&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge39" class="edge">
<title>layer0_expert0_10&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M1834.8,-1855.95C1800.39,-1838 1759.78,-1816.81 1724.37,-1798.33"/>
<polygon fill="black" stroke="black" points="1725.97,-1795.22 1715.49,-1793.69 1722.73,-1801.42 1725.97,-1795.22"/>
</g>
<!-- layer0_expert0_11&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge40" class="edge">
<title>layer0_expert0_11&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2012.97,-1859.52C2009.79,-1858.3 2006.62,-1857.12 2003.5,-1856 1919.51,-1825.86 1822.17,-1798.83 1748.99,-1780.03"/>
<polygon fill="black" stroke="black" points="1749.84,-1776.64 1739.29,-1777.55 1748.11,-1783.42 1749.84,-1776.64"/>
</g>
<!-- layer0_expert0_12&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge41" class="edge">
<title>layer0_expert0_12&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2195.84,-1859.07C2192.7,-1857.98 2189.58,-1856.95 2186.5,-1856 2038.46,-1810.19 1861.32,-1781.44 1749.09,-1766.3"/>
<polygon fill="black" stroke="black" points="1749.48,-1762.82 1739.11,-1764.96 1748.56,-1769.76 1749.48,-1762.82"/>
</g>
<!-- layer0_expert0_13&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge42" class="edge">
<title>layer0_expert0_13&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2378.89,-1858.89C2375.74,-1857.85 2372.61,-1856.88 2369.5,-1856 2155.09,-1794.98 1894.62,-1769.35 1749.33,-1759.17"/>
<polygon fill="black" stroke="black" points="1749.28,-1755.66 1739.06,-1758.47 1748.8,-1762.64 1749.28,-1755.66"/>
</g>
<!-- layer0_expert0_14&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge43" class="edge">
<title>layer0_expert0_14&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2561.92,-1858.77C2558.76,-1857.77 2555.62,-1856.84 2552.5,-1856 2270.08,-1779.84 1923.92,-1759.93 1749.43,-1754.77"/>
<polygon fill="black" stroke="black" points="1749.3,-1751.27 1739.21,-1754.48 1749.1,-1758.26 1749.3,-1751.27"/>
</g>
<!-- layer0_expert0_15&#45;&gt;layer0_moe_agg_gpu0 -->
<g id="edge44" class="edge">
<title>layer0_expert0_15&#45;&gt;layer0_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M2744.94,-1858.7C2741.78,-1857.72 2738.62,-1856.81 2735.5,-1856 2551.21,-1808.14 1990.51,-1772.47 1749.53,-1758.94"/>
<polygon fill="black" stroke="black" points="1749.52,-1755.44 1739.34,-1758.37 1749.13,-1762.43 1749.52,-1755.44"/>
</g>
<!-- layer0_output_gpu0 -->
<g id="node25" class="node">
<title>layer0_output_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="5993.5,-1442 5749.5,-1442 5749.5,-1374 5993.5,-1374 5993.5,-1442"/>
<text text-anchor="middle" x="5871.5" y="-1426.8" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU0</text>
<text text-anchor="middle" x="5871.5" y="-1411.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="5871.5" y="-1396.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="5871.5" y="-1381.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_moe_agg_gpu0&#45;&gt;layer0_output_gpu0 -->
<g id="edge45" class="edge">
<title>layer0_moe_agg_gpu0&#45;&gt;layer0_output_gpu0</title>
<path fill="none" stroke="black" d="M1739.02,-1742.8C2307.76,-1696.86 5095.95,-1471.64 5739.02,-1419.7"/>
<polygon fill="black" stroke="black" points="5739.56,-1423.17 5749.24,-1418.88 5739,-1416.19 5739.56,-1423.17"/>
</g>
<!-- layer0_allreduce_moe -->
<g id="node188" class="node">
<title>layer0_allreduce_moe</title>
<polygon fill="lightcoral" stroke="black" points="11960.5,-1648 11757.5,-1580 11960.5,-1512 12163.5,-1580 11960.5,-1648"/>
<text text-anchor="middle" x="11960.5" y="-1598.8" font-family="Times,serif" font-size="14.00">L0_All&#45;Reduce_MoE</text>
<text text-anchor="middle" x="11960.5" y="-1583.8" font-family="Times,serif" font-size="14.00">Input: 8×[1024,2048,512]</text>
<text text-anchor="middle" x="11960.5" y="-1568.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="11960.5" y="-1553.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
</g>
<!-- layer0_moe_agg_gpu0&#45;&gt;layer0_allreduce_moe -->
<g id="edge307" class="edge">
<title>layer0_moe_agg_gpu0&#45;&gt;layer0_allreduce_moe</title>
<path fill="none" stroke="black" d="M1739.18,-1748.21C2105.56,-1738.24 3392.51,-1703.92 4454.5,-1684 7352.13,-1629.66 10879.48,-1592.01 11756.04,-1583.05"/>
<polygon fill="black" stroke="black" points="11756.26,-1586.55 11766.23,-1582.95 11756.19,-1579.55 11756.26,-1586.55"/>
</g>
<!-- layer0_attn_gpu1 -->
<g id="node27" class="node">
<title>layer0_attn_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11173,-2640 10930,-2640 10930,-2557 11173,-2557 11173,-2640"/>
<text text-anchor="middle" x="11051.5" y="-2624.8" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU1</text>
<text text-anchor="middle" x="11051.5" y="-2609.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="11051.5" y="-2594.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11051.5" y="-2579.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="11051.5" y="-2564.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_qkv_gpu1&#45;&gt;layer0_attn_gpu1 -->
<g id="edge46" class="edge">
<title>layer0_qkv_gpu1&#45;&gt;layer0_attn_gpu1</title>
<path fill="none" stroke="black" d="M11066.22,-2675.87C11064.59,-2667.41 11062.89,-2658.58 11061.25,-2650.06"/>
<polygon fill="black" stroke="black" points="11064.68,-2649.39 11059.35,-2640.23 11057.81,-2650.71 11064.68,-2649.39"/>
</g>
<!-- layer0_attn_proj_gpu1 -->
<g id="node28" class="node">
<title>layer0_attn_proj_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11151.5,-2487 10951.5,-2487 10951.5,-2419 11151.5,-2419 11151.5,-2487"/>
<text text-anchor="middle" x="11051.5" y="-2471.8" font-family="Times,serif" font-size="14.00">L0_Attn_Projection_GPU1</text>
<text text-anchor="middle" x="11051.5" y="-2456.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11051.5" y="-2441.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11051.5" y="-2426.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_attn_gpu1&#45;&gt;layer0_attn_proj_gpu1 -->
<g id="edge47" class="edge">
<title>layer0_attn_gpu1&#45;&gt;layer0_attn_proj_gpu1</title>
<path fill="none" stroke="black" d="M11051.5,-2556.76C11051.5,-2538.17 11051.5,-2516.13 11051.5,-2497.24"/>
<polygon fill="black" stroke="black" points="11055,-2497.11 11051.5,-2487.11 11048,-2497.11 11055,-2497.11"/>
</g>
<!-- layer0_attn_norm_gpu1 -->
<g id="node29" class="node">
<title>layer0_attn_norm_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11170.5,-2169.5 10926.5,-2169.5 10926.5,-2101.5 11170.5,-2101.5 11170.5,-2169.5"/>
<text text-anchor="middle" x="11048.5" y="-2154.3" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU1</text>
<text text-anchor="middle" x="11048.5" y="-2139.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="11048.5" y="-2124.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11048.5" y="-2109.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_attn_proj_gpu1&#45;&gt;layer0_attn_norm_gpu1 -->
<g id="edge48" class="edge">
<title>layer0_attn_proj_gpu1&#45;&gt;layer0_attn_norm_gpu1</title>
<path fill="none" stroke="black" d="M11051.18,-2418.83C11050.64,-2361.43 11049.52,-2243.62 11048.91,-2179.83"/>
<polygon fill="black" stroke="black" points="11052.41,-2179.66 11048.82,-2169.7 11045.41,-2179.73 11052.41,-2179.66"/>
</g>
<!-- layer0_attn_proj_gpu1&#45;&gt;layer0_allreduce_attn -->
<g id="edge309" class="edge">
<title>layer0_attn_proj_gpu1&#45;&gt;layer0_allreduce_attn</title>
<path fill="none" stroke="black" d="M11118.41,-2418.85C11144.49,-2406.9 11174.93,-2394.13 11203.5,-2385 11318.78,-2348.15 11453.37,-2321.27 11553.7,-2304.23"/>
<polygon fill="black" stroke="black" points="11554.33,-2307.67 11563.61,-2302.56 11553.17,-2300.77 11554.33,-2307.67"/>
</g>
<!-- layer0_gate_gpu1 -->
<g id="node30" class="node">
<title>layer0_gate_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="4596.5,-2058 4352.5,-2058 4352.5,-1975 4596.5,-1975 4596.5,-2058"/>
<text text-anchor="middle" x="4474.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L0_Gate_GPU1</text>
<text text-anchor="middle" x="4474.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="4474.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="4474.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="4474.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_attn_norm_gpu1&#45;&gt;layer0_gate_gpu1 -->
<g id="edge49" class="edge">
<title>layer0_attn_norm_gpu1&#45;&gt;layer0_gate_gpu1</title>
<path fill="none" stroke="black" d="M10952.67,-2101.41C10940.94,-2098.39 10929.02,-2095.8 10917.5,-2094 10717.36,-2062.76 7474.05,-2060.47 7271.5,-2058 6245.7,-2045.51 5008.34,-2026.06 4607.03,-2019.64"/>
<polygon fill="black" stroke="black" points="4606.89,-2016.13 4596.84,-2019.47 4606.78,-2023.13 4606.89,-2016.13"/>
</g>
<!-- layer0_expert1_0 -->
<g id="node31" class="node">
<title>layer0_expert1_0</title>
<polygon fill="lightgreen" stroke="black" points="3093,-1939 2928,-1939 2928,-1856 3093,-1856 3093,-1939"/>
<text text-anchor="middle" x="3010.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU1</text>
<text text-anchor="middle" x="3010.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="3010.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="3010.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="3010.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_0 -->
<g id="edge50" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4352.34,-2014.34C4065.75,-2010.72 3356,-1996.31 3103.02,-1939.07"/>
<polygon fill="black" stroke="black" points="3103.67,-1935.63 3093.13,-1936.76 3102.07,-1942.44 3103.67,-1935.63"/>
</g>
<!-- layer0_expert1_1 -->
<g id="node32" class="node">
<title>layer0_expert1_1</title>
<polygon fill="lightgreen" stroke="black" points="3276,-1939 3111,-1939 3111,-1856 3276,-1856 3276,-1939"/>
<text text-anchor="middle" x="3193.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU1</text>
<text text-anchor="middle" x="3193.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="3193.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="3193.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="3193.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_1 -->
<g id="edge51" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4352.05,-2013.1C4094.44,-2007.18 3503,-1988.75 3286.18,-1939.11"/>
<polygon fill="black" stroke="black" points="3286.68,-1935.63 3276.14,-1936.73 3285.06,-1942.44 3286.68,-1935.63"/>
</g>
<!-- layer0_expert1_2 -->
<g id="node33" class="node">
<title>layer0_expert1_2</title>
<polygon fill="lightgreen" stroke="black" points="3459,-1939 3294,-1939 3294,-1856 3459,-1856 3459,-1939"/>
<text text-anchor="middle" x="3376.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU1</text>
<text text-anchor="middle" x="3376.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="3376.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="3376.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="3376.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_2 -->
<g id="edge52" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4352.26,-2011.44C4126.14,-2003.08 3649.86,-1981.29 3469.08,-1939.1"/>
<polygon fill="black" stroke="black" points="3469.69,-1935.65 3459.15,-1936.68 3468.04,-1942.45 3469.69,-1935.65"/>
</g>
<!-- layer0_expert1_3 -->
<g id="node34" class="node">
<title>layer0_expert1_3</title>
<polygon fill="lightgreen" stroke="black" points="3642,-1939 3477,-1939 3477,-1856 3642,-1856 3642,-1939"/>
<text text-anchor="middle" x="3559.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU1</text>
<text text-anchor="middle" x="3559.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="3559.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="3559.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="3559.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_3 -->
<g id="edge53" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4352.36,-2009.05C4160.78,-1998.12 3797.32,-1973.96 3652.23,-1939.15"/>
<polygon fill="black" stroke="black" points="3652.72,-1935.66 3642.17,-1936.62 3651.01,-1942.45 3652.72,-1935.66"/>
</g>
<!-- layer0_expert1_4 -->
<g id="node35" class="node">
<title>layer0_expert1_4</title>
<polygon fill="lightgreen" stroke="black" points="3825,-1939 3660,-1939 3660,-1856 3825,-1856 3825,-1939"/>
<text text-anchor="middle" x="3742.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU1</text>
<text text-anchor="middle" x="3742.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="3742.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="3742.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="3742.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_4 -->
<g id="edge54" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4352.21,-2011.77C4223.95,-2005.4 4017.18,-1988.17 3834.95,-1939.19"/>
<polygon fill="black" stroke="black" points="3835.76,-1935.78 3825.19,-1936.53 3833.92,-1942.53 3835.76,-1935.78"/>
</g>
<!-- layer0_expert1_5 -->
<g id="node36" class="node">
<title>layer0_expert1_5</title>
<polygon fill="lightgreen" stroke="black" points="4008,-1939 3843,-1939 3843,-1856 4008,-1856 4008,-1939"/>
<text text-anchor="middle" x="3925.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU1</text>
<text text-anchor="middle" x="3925.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="3925.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="3925.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="3925.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_5 -->
<g id="edge55" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4352.05,-2003.58C4261.24,-1992.76 4134.81,-1973.52 4018.06,-1939.28"/>
<polygon fill="black" stroke="black" points="4018.82,-1935.86 4008.24,-1936.36 4016.83,-1942.57 4018.82,-1935.86"/>
</g>
<!-- layer0_expert1_6 -->
<g id="node37" class="node">
<title>layer0_expert1_6</title>
<polygon fill="lightgreen" stroke="black" points="4191,-1939 4026,-1939 4026,-1856 4191,-1856 4191,-1939"/>
<text text-anchor="middle" x="4108.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU1</text>
<text text-anchor="middle" x="4108.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="4108.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="4108.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="4108.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_6 -->
<g id="edge56" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4352.47,-1985.69C4306.95,-1973.56 4254.87,-1958.48 4200.56,-1939.26"/>
<polygon fill="black" stroke="black" points="4201.71,-1935.96 4191.12,-1935.89 4199.35,-1942.55 4201.71,-1935.96"/>
</g>
<!-- layer0_expert1_7 -->
<g id="node38" class="node">
<title>layer0_expert1_7</title>
<polygon fill="lightgreen" stroke="black" points="4374,-1939 4209,-1939 4209,-1856 4374,-1856 4374,-1939"/>
<text text-anchor="middle" x="4291.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU1</text>
<text text-anchor="middle" x="4291.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="4291.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="4291.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="4291.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_7 -->
<g id="edge57" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4411.01,-1974.91C4395.68,-1965.11 4379.19,-1954.56 4363.5,-1944.53"/>
<polygon fill="black" stroke="black" points="4365.19,-1941.46 4354.88,-1939.02 4361.42,-1947.36 4365.19,-1941.46"/>
</g>
<!-- layer0_expert1_8 -->
<g id="node39" class="node">
<title>layer0_expert1_8</title>
<polygon fill="lightgreen" stroke="black" points="4557,-1939 4392,-1939 4392,-1856 4557,-1856 4557,-1939"/>
<text text-anchor="middle" x="4474.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU1</text>
<text text-anchor="middle" x="4474.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="4474.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="4474.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="4474.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_8 -->
<g id="edge58" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4474.5,-1974.91C4474.5,-1966.65 4474.5,-1957.86 4474.5,-1949.3"/>
<polygon fill="black" stroke="black" points="4478,-1949.02 4474.5,-1939.02 4471,-1949.02 4478,-1949.02"/>
</g>
<!-- layer0_expert1_9 -->
<g id="node40" class="node">
<title>layer0_expert1_9</title>
<polygon fill="lightgreen" stroke="black" points="4740,-1939 4575,-1939 4575,-1856 4740,-1856 4740,-1939"/>
<text text-anchor="middle" x="4657.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU1</text>
<text text-anchor="middle" x="4657.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="4657.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="4657.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="4657.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_9 -->
<g id="edge59" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4537.99,-1974.91C4553.32,-1965.11 4569.81,-1954.56 4585.5,-1944.53"/>
<polygon fill="black" stroke="black" points="4587.58,-1947.36 4594.12,-1939.02 4583.81,-1941.46 4587.58,-1947.36"/>
</g>
<!-- layer0_expert1_10 -->
<g id="node41" class="node">
<title>layer0_expert1_10</title>
<polygon fill="lightgreen" stroke="black" points="4923,-1939 4758,-1939 4758,-1856 4923,-1856 4923,-1939"/>
<text text-anchor="middle" x="4840.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU1</text>
<text text-anchor="middle" x="4840.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="4840.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="4840.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="4840.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_10 -->
<g id="edge60" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4596.72,-1985.37C4644.54,-1972.55 4699.55,-1956.51 4748.5,-1939 4748.6,-1938.97 4748.7,-1938.93 4748.79,-1938.9"/>
<polygon fill="black" stroke="black" points="4749.81,-1942.25 4757.97,-1935.49 4747.38,-1935.69 4749.81,-1942.25"/>
</g>
<!-- layer0_expert1_11 -->
<g id="node42" class="node">
<title>layer0_expert1_11</title>
<polygon fill="lightgreen" stroke="black" points="5106,-1939 4941,-1939 4941,-1856 5106,-1856 5106,-1939"/>
<text text-anchor="middle" x="5023.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU1</text>
<text text-anchor="middle" x="5023.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="5023.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="5023.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="5023.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_11 -->
<g id="edge61" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4596.64,-2003.42C4687.24,-1992.52 4813.39,-1973.25 4930.96,-1938.94"/>
<polygon fill="black" stroke="black" points="4932.26,-1942.2 4940.86,-1936.01 4930.28,-1935.49 4932.26,-1942.2"/>
</g>
<!-- layer0_expert1_12 -->
<g id="node43" class="node">
<title>layer0_expert1_12</title>
<polygon fill="lightgreen" stroke="black" points="5289,-1939 5124,-1939 5124,-1856 5289,-1856 5289,-1939"/>
<text text-anchor="middle" x="5206.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU1</text>
<text text-anchor="middle" x="5206.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="5206.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="5206.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="5206.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_12 -->
<g id="edge62" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4596.56,-2011.6C4724.59,-2005.1 4931.01,-1987.76 5114.11,-1938.85"/>
<polygon fill="black" stroke="black" points="5115.18,-1942.19 5123.91,-1936.2 5113.35,-1935.43 5115.18,-1942.19"/>
</g>
<!-- layer0_expert1_13 -->
<g id="node44" class="node">
<title>layer0_expert1_13</title>
<polygon fill="lightgreen" stroke="black" points="5472,-1939 5307,-1939 5307,-1856 5472,-1856 5472,-1939"/>
<text text-anchor="middle" x="5389.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU1</text>
<text text-anchor="middle" x="5389.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="5389.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="5389.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="5389.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_13 -->
<g id="edge63" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4596.87,-2008.96C4788.31,-1997.93 5150.9,-1973.64 5296.82,-1938.83"/>
<polygon fill="black" stroke="black" points="5298.09,-1942.12 5306.94,-1936.3 5296.39,-1935.33 5298.09,-1942.12"/>
</g>
<!-- layer0_expert1_14 -->
<g id="node45" class="node">
<title>layer0_expert1_14</title>
<polygon fill="lightgreen" stroke="black" points="5655,-1939 5490,-1939 5490,-1856 5655,-1856 5655,-1939"/>
<text text-anchor="middle" x="5572.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU1</text>
<text text-anchor="middle" x="5572.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="5572.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="5572.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="5572.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_14 -->
<g id="edge64" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4596.6,-2011.37C4822.48,-2002.9 5298.24,-1980.94 5479.97,-1938.78"/>
<polygon fill="black" stroke="black" points="5481.06,-1942.12 5489.96,-1936.37 5479.42,-1935.32 5481.06,-1942.12"/>
</g>
<!-- layer0_expert1_15 -->
<g id="node46" class="node">
<title>layer0_expert1_15</title>
<polygon fill="lightgreen" stroke="black" points="5838,-1939 5673,-1939 5673,-1856 5838,-1856 5838,-1939"/>
<text text-anchor="middle" x="5755.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU1</text>
<text text-anchor="middle" x="5755.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="5755.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="5755.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="5755.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gate_gpu1&#45;&gt;layer0_expert1_15 -->
<g id="edge65" class="edge">
<title>layer0_gate_gpu1&#45;&gt;layer0_expert1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4596.83,-2013.04C4854.32,-2006.99 5445.68,-1988.3 5663.21,-1938.73"/>
<polygon fill="black" stroke="black" points="5664.04,-1942.13 5672.97,-1936.42 5662.43,-1935.31 5664.04,-1942.13"/>
</g>
<!-- layer0_moe_agg_gpu1 -->
<g id="node47" class="node">
<title>layer0_moe_agg_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="4667,-1793.5 4464,-1793.5 4464,-1710.5 4667,-1710.5 4667,-1793.5"/>
<text text-anchor="middle" x="4565.5" y="-1778.3" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU1</text>
<text text-anchor="middle" x="4565.5" y="-1763.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="4565.5" y="-1748.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="4565.5" y="-1733.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="4565.5" y="-1718.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_expert1_0&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge66" class="edge">
<title>layer0_expert1_0&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3093.15,-1858.3C3095.94,-1857.46 3098.73,-1856.69 3101.5,-1856 3357.43,-1792.15 4157,-1764.21 4453.44,-1755.85"/>
<polygon fill="black" stroke="black" points="4453.87,-1759.34 4463.77,-1755.57 4453.68,-1752.35 4453.87,-1759.34"/>
</g>
<!-- layer0_expert1_1&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge67" class="edge">
<title>layer0_expert1_1&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3276.15,-1858.33C3278.95,-1857.49 3281.74,-1856.7 3284.5,-1856 3504.5,-1799.95 4184.25,-1767.92 4453.76,-1757.15"/>
<polygon fill="black" stroke="black" points="4454.1,-1760.63 4463.95,-1756.74 4453.82,-1753.64 4454.1,-1760.63"/>
</g>
<!-- layer0_expert1_2&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge68" class="edge">
<title>layer0_expert1_2&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3459.17,-1858.38C3461.96,-1857.52 3464.74,-1856.72 3467.5,-1856 3651.69,-1807.76 4212.45,-1772.31 4453.46,-1758.89"/>
<polygon fill="black" stroke="black" points="4453.85,-1762.37 4463.64,-1758.32 4453.47,-1755.38 4453.85,-1762.37"/>
</g>
<!-- layer0_expert1_3&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge69" class="edge">
<title>layer0_expert1_3&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3642.18,-1858.45C3644.97,-1857.57 3647.75,-1856.75 3650.5,-1856 3932.76,-1779.27 4278.99,-1759.61 4453.53,-1754.63"/>
<polygon fill="black" stroke="black" points="4453.86,-1758.12 4463.76,-1754.35 4453.66,-1751.13 4453.86,-1758.12"/>
</g>
<!-- layer0_expert1_4&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge70" class="edge">
<title>layer0_expert1_4&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M3825.21,-1858.55C3827.99,-1857.64 3830.76,-1856.79 3833.5,-1856 4047.79,-1794.55 4308.3,-1769.07 4453.64,-1759.04"/>
<polygon fill="black" stroke="black" points="4454.16,-1762.51 4463.9,-1758.34 4453.69,-1755.53 4454.16,-1762.51"/>
</g>
<!-- layer0_expert1_5&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge71" class="edge">
<title>layer0_expert1_5&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4008.01,-1858.8C4010.86,-1857.81 4013.69,-1856.87 4016.5,-1856 4164.45,-1809.89 4341.61,-1781.21 4453.87,-1766.17"/>
<polygon fill="black" stroke="black" points="4454.4,-1769.63 4463.85,-1764.85 4453.48,-1762.69 4454.4,-1769.63"/>
</g>
<!-- layer0_expert1_6&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge72" class="edge">
<title>layer0_expert1_6&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4191.12,-1859.12C4193.94,-1858.04 4196.74,-1857 4199.5,-1856 4283.43,-1825.69 4380.77,-1798.67 4453.96,-1779.92"/>
<polygon fill="black" stroke="black" points="4454.85,-1783.31 4463.67,-1777.44 4453.12,-1776.52 4454.85,-1783.31"/>
</g>
<!-- layer0_expert1_7&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge73" class="edge">
<title>layer0_expert1_7&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4368.92,-1855.95C4403.06,-1838.07 4443.33,-1816.99 4478.5,-1798.56"/>
<polygon fill="black" stroke="black" points="4480.56,-1801.43 4487.8,-1793.69 4477.32,-1795.23 4480.56,-1801.43"/>
</g>
<!-- layer0_expert1_8&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge74" class="edge">
<title>layer0_expert1_8&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4500.33,-1855.76C4510.8,-1839.25 4523,-1820.03 4533.98,-1802.7"/>
<polygon fill="black" stroke="black" points="4537.2,-1804.16 4539.6,-1793.84 4531.29,-1800.41 4537.2,-1804.16"/>
</g>
<!-- layer0_expert1_9&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge75" class="edge">
<title>layer0_expert1_9&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4631.38,-1855.76C4620.8,-1839.25 4608.47,-1820.03 4597.36,-1802.7"/>
<polygon fill="black" stroke="black" points="4600.03,-1800.37 4591.68,-1793.84 4594.13,-1804.15 4600.03,-1800.37"/>
</g>
<!-- layer0_expert1_10&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge76" class="edge">
<title>layer0_expert1_10&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4762.8,-1855.95C4728.39,-1838 4687.78,-1816.81 4652.37,-1798.33"/>
<polygon fill="black" stroke="black" points="4653.97,-1795.22 4643.49,-1793.69 4650.73,-1801.42 4653.97,-1795.22"/>
</g>
<!-- layer0_expert1_11&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge77" class="edge">
<title>layer0_expert1_11&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M4940.97,-1859.52C4937.79,-1858.3 4934.62,-1857.12 4931.5,-1856 4847.51,-1825.86 4750.17,-1798.83 4676.99,-1780.03"/>
<polygon fill="black" stroke="black" points="4677.84,-1776.64 4667.29,-1777.55 4676.11,-1783.42 4677.84,-1776.64"/>
</g>
<!-- layer0_expert1_12&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge78" class="edge">
<title>layer0_expert1_12&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5123.84,-1859.07C5120.7,-1857.98 5117.58,-1856.95 5114.5,-1856 4966.46,-1810.19 4789.32,-1781.44 4677.09,-1766.3"/>
<polygon fill="black" stroke="black" points="4677.48,-1762.82 4667.11,-1764.96 4676.56,-1769.76 4677.48,-1762.82"/>
</g>
<!-- layer0_expert1_13&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge79" class="edge">
<title>layer0_expert1_13&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5306.89,-1858.89C5303.74,-1857.85 5300.61,-1856.88 5297.5,-1856 5083.09,-1794.98 4822.62,-1769.35 4677.33,-1759.17"/>
<polygon fill="black" stroke="black" points="4677.28,-1755.66 4667.06,-1758.47 4676.8,-1762.64 4677.28,-1755.66"/>
</g>
<!-- layer0_expert1_14&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge80" class="edge">
<title>layer0_expert1_14&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5489.92,-1858.77C5486.76,-1857.77 5483.62,-1856.84 5480.5,-1856 5198.08,-1779.84 4851.92,-1759.93 4677.43,-1754.77"/>
<polygon fill="black" stroke="black" points="4677.3,-1751.27 4667.21,-1754.48 4677.1,-1758.26 4677.3,-1751.27"/>
</g>
<!-- layer0_expert1_15&#45;&gt;layer0_moe_agg_gpu1 -->
<g id="edge81" class="edge">
<title>layer0_expert1_15&#45;&gt;layer0_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M5672.94,-1858.7C5669.78,-1857.72 5666.62,-1856.81 5663.5,-1856 5479.21,-1808.14 4918.51,-1772.47 4677.53,-1758.94"/>
<polygon fill="black" stroke="black" points="4677.52,-1755.44 4667.34,-1758.37 4677.13,-1762.43 4677.52,-1755.44"/>
</g>
<!-- layer0_output_gpu1 -->
<g id="node48" class="node">
<title>layer0_output_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="8924.5,-1442 8680.5,-1442 8680.5,-1374 8924.5,-1374 8924.5,-1442"/>
<text text-anchor="middle" x="8802.5" y="-1426.8" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU1</text>
<text text-anchor="middle" x="8802.5" y="-1411.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="8802.5" y="-1396.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="8802.5" y="-1381.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_moe_agg_gpu1&#45;&gt;layer0_output_gpu1 -->
<g id="edge82" class="edge">
<title>layer0_moe_agg_gpu1&#45;&gt;layer0_output_gpu1</title>
<path fill="none" stroke="black" d="M4667.09,-1742.8C5236.32,-1696.85 8027.17,-1471.58 8670.19,-1419.68"/>
<polygon fill="black" stroke="black" points="8670.73,-1423.15 8680.42,-1418.85 8670.17,-1416.17 8670.73,-1423.15"/>
</g>
<!-- layer0_moe_agg_gpu1&#45;&gt;layer0_allreduce_moe -->
<g id="edge311" class="edge">
<title>layer0_moe_agg_gpu1&#45;&gt;layer0_allreduce_moe</title>
<path fill="none" stroke="black" d="M4667.19,-1748.53C5033.58,-1739.66 6320.61,-1708.57 7382.5,-1684 9077.9,-1644.77 11126.53,-1599.4 11762.54,-1585.36"/>
<polygon fill="black" stroke="black" points="11762.79,-1588.86 11772.72,-1585.14 11762.64,-1581.86 11762.79,-1588.86"/>
</g>
<!-- layer0_attn_gpu2 -->
<g id="node50" class="node">
<title>layer0_attn_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="11434,-2640 11191,-2640 11191,-2557 11434,-2557 11434,-2640"/>
<text text-anchor="middle" x="11312.5" y="-2624.8" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU2</text>
<text text-anchor="middle" x="11312.5" y="-2609.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="11312.5" y="-2594.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11312.5" y="-2579.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="11312.5" y="-2564.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_qkv_gpu2&#45;&gt;layer0_attn_gpu2 -->
<g id="edge83" class="edge">
<title>layer0_qkv_gpu2&#45;&gt;layer0_attn_gpu2</title>
<path fill="none" stroke="black" d="M11322.31,-2675.87C11321.24,-2667.5 11320.12,-2658.77 11319.03,-2650.33"/>
<polygon fill="black" stroke="black" points="11322.48,-2649.7 11317.73,-2640.23 11315.54,-2650.6 11322.48,-2649.7"/>
</g>
<!-- layer0_attn_proj_gpu2 -->
<g id="node51" class="node">
<title>layer0_attn_proj_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="11412.5,-2487 11212.5,-2487 11212.5,-2419 11412.5,-2419 11412.5,-2487"/>
<text text-anchor="middle" x="11312.5" y="-2471.8" font-family="Times,serif" font-size="14.00">L0_Attn_Projection_GPU2</text>
<text text-anchor="middle" x="11312.5" y="-2456.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11312.5" y="-2441.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11312.5" y="-2426.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_attn_gpu2&#45;&gt;layer0_attn_proj_gpu2 -->
<g id="edge84" class="edge">
<title>layer0_attn_gpu2&#45;&gt;layer0_attn_proj_gpu2</title>
<path fill="none" stroke="black" d="M11312.5,-2556.76C11312.5,-2538.17 11312.5,-2516.13 11312.5,-2497.24"/>
<polygon fill="black" stroke="black" points="11316,-2497.11 11312.5,-2487.11 11309,-2497.11 11316,-2497.11"/>
</g>
<!-- layer0_attn_norm_gpu2 -->
<g id="node52" class="node">
<title>layer0_attn_norm_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="11432.5,-2169.5 11188.5,-2169.5 11188.5,-2101.5 11432.5,-2101.5 11432.5,-2169.5"/>
<text text-anchor="middle" x="11310.5" y="-2154.3" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU2</text>
<text text-anchor="middle" x="11310.5" y="-2139.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="11310.5" y="-2124.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11310.5" y="-2109.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_attn_proj_gpu2&#45;&gt;layer0_attn_norm_gpu2 -->
<g id="edge85" class="edge">
<title>layer0_attn_proj_gpu2&#45;&gt;layer0_attn_norm_gpu2</title>
<path fill="none" stroke="black" d="M11312.29,-2418.83C11311.93,-2361.43 11311.18,-2243.62 11310.77,-2179.83"/>
<polygon fill="black" stroke="black" points="11314.27,-2179.67 11310.71,-2169.7 11307.27,-2179.72 11314.27,-2179.67"/>
</g>
<!-- layer0_attn_proj_gpu2&#45;&gt;layer0_allreduce_attn -->
<g id="edge313" class="edge">
<title>layer0_attn_proj_gpu2&#45;&gt;layer0_allreduce_attn</title>
<path fill="none" stroke="black" d="M11387.45,-2418.84C11411.99,-2408.02 11439.39,-2395.97 11464.5,-2385 11510.82,-2364.77 11562.28,-2342.47 11605.47,-2323.82"/>
<polygon fill="black" stroke="black" points="11607.05,-2326.95 11614.84,-2319.77 11604.27,-2320.52 11607.05,-2326.95"/>
</g>
<!-- layer0_gate_gpu2 -->
<g id="node53" class="node">
<title>layer0_gate_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="7524.5,-2058 7280.5,-2058 7280.5,-1975 7524.5,-1975 7524.5,-2058"/>
<text text-anchor="middle" x="7402.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L0_Gate_GPU2</text>
<text text-anchor="middle" x="7402.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="7402.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="7402.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="7402.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_attn_norm_gpu2&#45;&gt;layer0_gate_gpu2 -->
<g id="edge86" class="edge">
<title>layer0_attn_norm_gpu2&#45;&gt;layer0_gate_gpu2</title>
<path fill="none" stroke="black" d="M11214.29,-2101.44C11202.68,-2098.44 11190.9,-2095.84 11179.5,-2094 10996.26,-2064.42 8183,-2027.33 7534.94,-2019.15"/>
<polygon fill="black" stroke="black" points="7534.67,-2015.64 7524.63,-2019.02 7534.59,-2022.64 7534.67,-2015.64"/>
</g>
<!-- layer0_expert2_0 -->
<g id="node54" class="node">
<title>layer0_expert2_0</title>
<polygon fill="lightgreen" stroke="black" points="6021,-1939 5856,-1939 5856,-1856 6021,-1856 6021,-1939"/>
<text text-anchor="middle" x="5938.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU2</text>
<text text-anchor="middle" x="5938.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="5938.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="5938.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="5938.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_0 -->
<g id="edge87" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7280.34,-2014.34C6993.75,-2010.72 6284,-1996.31 6031.02,-1939.07"/>
<polygon fill="black" stroke="black" points="6031.67,-1935.63 6021.13,-1936.76 6030.07,-1942.44 6031.67,-1935.63"/>
</g>
<!-- layer0_expert2_1 -->
<g id="node55" class="node">
<title>layer0_expert2_1</title>
<polygon fill="lightgreen" stroke="black" points="6204,-1939 6039,-1939 6039,-1856 6204,-1856 6204,-1939"/>
<text text-anchor="middle" x="6121.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU2</text>
<text text-anchor="middle" x="6121.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="6121.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="6121.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="6121.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_1 -->
<g id="edge88" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7280.05,-2013.1C7022.44,-2007.18 6431,-1988.75 6214.18,-1939.11"/>
<polygon fill="black" stroke="black" points="6214.68,-1935.63 6204.14,-1936.73 6213.06,-1942.44 6214.68,-1935.63"/>
</g>
<!-- layer0_expert2_2 -->
<g id="node56" class="node">
<title>layer0_expert2_2</title>
<polygon fill="lightgreen" stroke="black" points="6387,-1939 6222,-1939 6222,-1856 6387,-1856 6387,-1939"/>
<text text-anchor="middle" x="6304.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU2</text>
<text text-anchor="middle" x="6304.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="6304.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="6304.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="6304.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_2 -->
<g id="edge89" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7280.26,-2011.44C7054.14,-2003.08 6577.86,-1981.29 6397.08,-1939.1"/>
<polygon fill="black" stroke="black" points="6397.69,-1935.65 6387.15,-1936.68 6396.04,-1942.45 6397.69,-1935.65"/>
</g>
<!-- layer0_expert2_3 -->
<g id="node57" class="node">
<title>layer0_expert2_3</title>
<polygon fill="lightgreen" stroke="black" points="6570,-1939 6405,-1939 6405,-1856 6570,-1856 6570,-1939"/>
<text text-anchor="middle" x="6487.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU2</text>
<text text-anchor="middle" x="6487.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="6487.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="6487.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="6487.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_3 -->
<g id="edge90" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7280.36,-2009.05C7088.78,-1998.12 6725.32,-1973.96 6580.23,-1939.15"/>
<polygon fill="black" stroke="black" points="6580.72,-1935.66 6570.17,-1936.62 6579.01,-1942.45 6580.72,-1935.66"/>
</g>
<!-- layer0_expert2_4 -->
<g id="node58" class="node">
<title>layer0_expert2_4</title>
<polygon fill="lightgreen" stroke="black" points="6753,-1939 6588,-1939 6588,-1856 6753,-1856 6753,-1939"/>
<text text-anchor="middle" x="6670.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU2</text>
<text text-anchor="middle" x="6670.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="6670.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="6670.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="6670.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_4 -->
<g id="edge91" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7280.21,-2011.77C7151.95,-2005.4 6945.18,-1988.17 6762.95,-1939.19"/>
<polygon fill="black" stroke="black" points="6763.76,-1935.78 6753.19,-1936.53 6761.92,-1942.53 6763.76,-1935.78"/>
</g>
<!-- layer0_expert2_5 -->
<g id="node59" class="node">
<title>layer0_expert2_5</title>
<polygon fill="lightgreen" stroke="black" points="6936,-1939 6771,-1939 6771,-1856 6936,-1856 6936,-1939"/>
<text text-anchor="middle" x="6853.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU2</text>
<text text-anchor="middle" x="6853.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="6853.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="6853.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="6853.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_5 -->
<g id="edge92" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7280.05,-2003.58C7189.24,-1992.76 7062.81,-1973.52 6946.06,-1939.28"/>
<polygon fill="black" stroke="black" points="6946.82,-1935.86 6936.24,-1936.36 6944.83,-1942.57 6946.82,-1935.86"/>
</g>
<!-- layer0_expert2_6 -->
<g id="node60" class="node">
<title>layer0_expert2_6</title>
<polygon fill="lightgreen" stroke="black" points="7119,-1939 6954,-1939 6954,-1856 7119,-1856 7119,-1939"/>
<text text-anchor="middle" x="7036.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU2</text>
<text text-anchor="middle" x="7036.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="7036.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="7036.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="7036.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_6 -->
<g id="edge93" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7280.47,-1985.69C7234.95,-1973.56 7182.87,-1958.48 7128.56,-1939.26"/>
<polygon fill="black" stroke="black" points="7129.71,-1935.96 7119.12,-1935.89 7127.35,-1942.55 7129.71,-1935.96"/>
</g>
<!-- layer0_expert2_7 -->
<g id="node61" class="node">
<title>layer0_expert2_7</title>
<polygon fill="lightgreen" stroke="black" points="7302,-1939 7137,-1939 7137,-1856 7302,-1856 7302,-1939"/>
<text text-anchor="middle" x="7219.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU2</text>
<text text-anchor="middle" x="7219.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="7219.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="7219.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="7219.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_7 -->
<g id="edge94" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7339.01,-1974.91C7323.68,-1965.11 7307.19,-1954.56 7291.5,-1944.53"/>
<polygon fill="black" stroke="black" points="7293.19,-1941.46 7282.88,-1939.02 7289.42,-1947.36 7293.19,-1941.46"/>
</g>
<!-- layer0_expert2_8 -->
<g id="node62" class="node">
<title>layer0_expert2_8</title>
<polygon fill="lightgreen" stroke="black" points="7485,-1939 7320,-1939 7320,-1856 7485,-1856 7485,-1939"/>
<text text-anchor="middle" x="7402.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU2</text>
<text text-anchor="middle" x="7402.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="7402.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="7402.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="7402.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_8 -->
<g id="edge95" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7402.5,-1974.91C7402.5,-1966.65 7402.5,-1957.86 7402.5,-1949.3"/>
<polygon fill="black" stroke="black" points="7406,-1949.02 7402.5,-1939.02 7399,-1949.02 7406,-1949.02"/>
</g>
<!-- layer0_expert2_9 -->
<g id="node63" class="node">
<title>layer0_expert2_9</title>
<polygon fill="lightgreen" stroke="black" points="7668,-1939 7503,-1939 7503,-1856 7668,-1856 7668,-1939"/>
<text text-anchor="middle" x="7585.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU2</text>
<text text-anchor="middle" x="7585.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="7585.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="7585.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="7585.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_9 -->
<g id="edge96" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7465.99,-1974.91C7481.32,-1965.11 7497.81,-1954.56 7513.5,-1944.53"/>
<polygon fill="black" stroke="black" points="7515.58,-1947.36 7522.12,-1939.02 7511.81,-1941.46 7515.58,-1947.36"/>
</g>
<!-- layer0_expert2_10 -->
<g id="node64" class="node">
<title>layer0_expert2_10</title>
<polygon fill="lightgreen" stroke="black" points="7851,-1939 7686,-1939 7686,-1856 7851,-1856 7851,-1939"/>
<text text-anchor="middle" x="7768.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU2</text>
<text text-anchor="middle" x="7768.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="7768.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="7768.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="7768.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_10 -->
<g id="edge97" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7524.72,-1985.37C7572.54,-1972.55 7627.55,-1956.51 7676.5,-1939 7676.6,-1938.97 7676.7,-1938.93 7676.79,-1938.9"/>
<polygon fill="black" stroke="black" points="7677.81,-1942.25 7685.97,-1935.49 7675.38,-1935.69 7677.81,-1942.25"/>
</g>
<!-- layer0_expert2_11 -->
<g id="node65" class="node">
<title>layer0_expert2_11</title>
<polygon fill="lightgreen" stroke="black" points="8034,-1939 7869,-1939 7869,-1856 8034,-1856 8034,-1939"/>
<text text-anchor="middle" x="7951.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU2</text>
<text text-anchor="middle" x="7951.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="7951.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="7951.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="7951.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_11 -->
<g id="edge98" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7524.64,-2003.42C7615.24,-1992.52 7741.39,-1973.25 7858.96,-1938.94"/>
<polygon fill="black" stroke="black" points="7860.26,-1942.2 7868.86,-1936.01 7858.28,-1935.49 7860.26,-1942.2"/>
</g>
<!-- layer0_expert2_12 -->
<g id="node66" class="node">
<title>layer0_expert2_12</title>
<polygon fill="lightgreen" stroke="black" points="8217,-1939 8052,-1939 8052,-1856 8217,-1856 8217,-1939"/>
<text text-anchor="middle" x="8134.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU2</text>
<text text-anchor="middle" x="8134.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="8134.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="8134.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="8134.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_12 -->
<g id="edge99" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7524.56,-2011.6C7652.59,-2005.1 7859.01,-1987.76 8042.11,-1938.85"/>
<polygon fill="black" stroke="black" points="8043.18,-1942.19 8051.91,-1936.2 8041.35,-1935.43 8043.18,-1942.19"/>
</g>
<!-- layer0_expert2_13 -->
<g id="node67" class="node">
<title>layer0_expert2_13</title>
<polygon fill="lightgreen" stroke="black" points="8400,-1939 8235,-1939 8235,-1856 8400,-1856 8400,-1939"/>
<text text-anchor="middle" x="8317.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU2</text>
<text text-anchor="middle" x="8317.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="8317.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="8317.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="8317.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_13 -->
<g id="edge100" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7524.87,-2008.96C7716.31,-1997.93 8078.9,-1973.64 8224.82,-1938.83"/>
<polygon fill="black" stroke="black" points="8226.09,-1942.12 8234.94,-1936.3 8224.39,-1935.33 8226.09,-1942.12"/>
</g>
<!-- layer0_expert2_14 -->
<g id="node68" class="node">
<title>layer0_expert2_14</title>
<polygon fill="lightgreen" stroke="black" points="8583,-1939 8418,-1939 8418,-1856 8583,-1856 8583,-1939"/>
<text text-anchor="middle" x="8500.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU2</text>
<text text-anchor="middle" x="8500.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="8500.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="8500.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="8500.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_14 -->
<g id="edge101" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7524.6,-2011.37C7750.48,-2002.9 8226.24,-1980.94 8407.97,-1938.78"/>
<polygon fill="black" stroke="black" points="8409.06,-1942.12 8417.96,-1936.37 8407.42,-1935.32 8409.06,-1942.12"/>
</g>
<!-- layer0_expert2_15 -->
<g id="node69" class="node">
<title>layer0_expert2_15</title>
<polygon fill="lightgreen" stroke="black" points="8766,-1939 8601,-1939 8601,-1856 8766,-1856 8766,-1939"/>
<text text-anchor="middle" x="8683.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU2</text>
<text text-anchor="middle" x="8683.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="8683.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="8683.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="8683.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gate_gpu2&#45;&gt;layer0_expert2_15 -->
<g id="edge102" class="edge">
<title>layer0_gate_gpu2&#45;&gt;layer0_expert2_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7524.83,-2013.04C7782.32,-2006.99 8373.68,-1988.3 8591.21,-1938.73"/>
<polygon fill="black" stroke="black" points="8592.04,-1942.13 8600.97,-1936.42 8590.43,-1935.31 8592.04,-1942.13"/>
</g>
<!-- layer0_moe_agg_gpu2 -->
<g id="node70" class="node">
<title>layer0_moe_agg_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="7595,-1793.5 7392,-1793.5 7392,-1710.5 7595,-1710.5 7595,-1793.5"/>
<text text-anchor="middle" x="7493.5" y="-1778.3" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU2</text>
<text text-anchor="middle" x="7493.5" y="-1763.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="7493.5" y="-1748.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="7493.5" y="-1733.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="7493.5" y="-1718.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_expert2_0&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge103" class="edge">
<title>layer0_expert2_0&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6021.15,-1858.3C6023.94,-1857.46 6026.73,-1856.69 6029.5,-1856 6285.43,-1792.15 7085,-1764.21 7381.44,-1755.85"/>
<polygon fill="black" stroke="black" points="7381.87,-1759.34 7391.77,-1755.57 7381.68,-1752.35 7381.87,-1759.34"/>
</g>
<!-- layer0_expert2_1&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge104" class="edge">
<title>layer0_expert2_1&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6204.15,-1858.33C6206.95,-1857.49 6209.74,-1856.7 6212.5,-1856 6432.5,-1799.95 7112.25,-1767.92 7381.76,-1757.15"/>
<polygon fill="black" stroke="black" points="7382.1,-1760.63 7391.95,-1756.74 7381.82,-1753.64 7382.1,-1760.63"/>
</g>
<!-- layer0_expert2_2&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge105" class="edge">
<title>layer0_expert2_2&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6387.17,-1858.38C6389.96,-1857.52 6392.74,-1856.72 6395.5,-1856 6579.69,-1807.76 7140.45,-1772.31 7381.46,-1758.89"/>
<polygon fill="black" stroke="black" points="7381.85,-1762.37 7391.64,-1758.32 7381.47,-1755.38 7381.85,-1762.37"/>
</g>
<!-- layer0_expert2_3&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge106" class="edge">
<title>layer0_expert2_3&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6570.18,-1858.45C6572.97,-1857.57 6575.75,-1856.75 6578.5,-1856 6860.76,-1779.27 7206.99,-1759.61 7381.53,-1754.63"/>
<polygon fill="black" stroke="black" points="7381.86,-1758.12 7391.76,-1754.35 7381.66,-1751.13 7381.86,-1758.12"/>
</g>
<!-- layer0_expert2_4&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge107" class="edge">
<title>layer0_expert2_4&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6753.21,-1858.55C6755.99,-1857.64 6758.76,-1856.79 6761.5,-1856 6975.79,-1794.55 7236.3,-1769.07 7381.64,-1759.04"/>
<polygon fill="black" stroke="black" points="7382.16,-1762.51 7391.9,-1758.34 7381.69,-1755.53 7382.16,-1762.51"/>
</g>
<!-- layer0_expert2_5&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge108" class="edge">
<title>layer0_expert2_5&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M6936.01,-1858.8C6938.86,-1857.81 6941.69,-1856.87 6944.5,-1856 7092.45,-1809.89 7269.61,-1781.21 7381.87,-1766.17"/>
<polygon fill="black" stroke="black" points="7382.4,-1769.63 7391.85,-1764.85 7381.48,-1762.69 7382.4,-1769.63"/>
</g>
<!-- layer0_expert2_6&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge109" class="edge">
<title>layer0_expert2_6&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7119.12,-1859.12C7121.94,-1858.04 7124.74,-1857 7127.5,-1856 7211.43,-1825.69 7308.77,-1798.67 7381.96,-1779.92"/>
<polygon fill="black" stroke="black" points="7382.85,-1783.31 7391.67,-1777.44 7381.12,-1776.52 7382.85,-1783.31"/>
</g>
<!-- layer0_expert2_7&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge110" class="edge">
<title>layer0_expert2_7&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7296.92,-1855.95C7331.06,-1838.07 7371.33,-1816.99 7406.5,-1798.56"/>
<polygon fill="black" stroke="black" points="7408.56,-1801.43 7415.8,-1793.69 7405.32,-1795.23 7408.56,-1801.43"/>
</g>
<!-- layer0_expert2_8&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge111" class="edge">
<title>layer0_expert2_8&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7428.33,-1855.76C7438.8,-1839.25 7451,-1820.03 7461.98,-1802.7"/>
<polygon fill="black" stroke="black" points="7465.2,-1804.16 7467.6,-1793.84 7459.29,-1800.41 7465.2,-1804.16"/>
</g>
<!-- layer0_expert2_9&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge112" class="edge">
<title>layer0_expert2_9&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7559.38,-1855.76C7548.8,-1839.25 7536.47,-1820.03 7525.36,-1802.7"/>
<polygon fill="black" stroke="black" points="7528.03,-1800.37 7519.68,-1793.84 7522.13,-1804.15 7528.03,-1800.37"/>
</g>
<!-- layer0_expert2_10&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge113" class="edge">
<title>layer0_expert2_10&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7690.8,-1855.95C7656.39,-1838 7615.78,-1816.81 7580.37,-1798.33"/>
<polygon fill="black" stroke="black" points="7581.97,-1795.22 7571.49,-1793.69 7578.73,-1801.42 7581.97,-1795.22"/>
</g>
<!-- layer0_expert2_11&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge114" class="edge">
<title>layer0_expert2_11&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M7868.97,-1859.52C7865.79,-1858.3 7862.62,-1857.12 7859.5,-1856 7775.51,-1825.86 7678.17,-1798.83 7604.99,-1780.03"/>
<polygon fill="black" stroke="black" points="7605.84,-1776.64 7595.29,-1777.55 7604.11,-1783.42 7605.84,-1776.64"/>
</g>
<!-- layer0_expert2_12&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge115" class="edge">
<title>layer0_expert2_12&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8051.84,-1859.07C8048.7,-1857.98 8045.58,-1856.95 8042.5,-1856 7894.46,-1810.19 7717.32,-1781.44 7605.09,-1766.3"/>
<polygon fill="black" stroke="black" points="7605.48,-1762.82 7595.11,-1764.96 7604.56,-1769.76 7605.48,-1762.82"/>
</g>
<!-- layer0_expert2_13&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge116" class="edge">
<title>layer0_expert2_13&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8234.89,-1858.89C8231.74,-1857.85 8228.61,-1856.88 8225.5,-1856 8011.09,-1794.98 7750.62,-1769.35 7605.33,-1759.17"/>
<polygon fill="black" stroke="black" points="7605.28,-1755.66 7595.06,-1758.47 7604.8,-1762.64 7605.28,-1755.66"/>
</g>
<!-- layer0_expert2_14&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge117" class="edge">
<title>layer0_expert2_14&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8417.92,-1858.77C8414.76,-1857.77 8411.62,-1856.84 8408.5,-1856 8126.08,-1779.84 7779.92,-1759.93 7605.43,-1754.77"/>
<polygon fill="black" stroke="black" points="7605.3,-1751.27 7595.21,-1754.48 7605.1,-1758.26 7605.3,-1751.27"/>
</g>
<!-- layer0_expert2_15&#45;&gt;layer0_moe_agg_gpu2 -->
<g id="edge118" class="edge">
<title>layer0_expert2_15&#45;&gt;layer0_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M8600.94,-1858.7C8597.78,-1857.72 8594.62,-1856.81 8591.5,-1856 8407.21,-1808.14 7846.51,-1772.47 7605.53,-1758.94"/>
<polygon fill="black" stroke="black" points="7605.52,-1755.44 7595.34,-1758.37 7605.13,-1762.43 7605.52,-1755.44"/>
</g>
<!-- layer0_output_gpu2 -->
<g id="node71" class="node">
<title>layer0_output_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="10521.5,-1442 10277.5,-1442 10277.5,-1374 10521.5,-1374 10521.5,-1442"/>
<text text-anchor="middle" x="10399.5" y="-1426.8" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU2</text>
<text text-anchor="middle" x="10399.5" y="-1411.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="10399.5" y="-1396.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="10399.5" y="-1381.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_moe_agg_gpu2&#45;&gt;layer0_output_gpu2 -->
<g id="edge119" class="edge">
<title>layer0_moe_agg_gpu2&#45;&gt;layer0_output_gpu2</title>
<path fill="none" stroke="black" d="M7595.22,-1739.03C8034.96,-1687.28 9772.57,-1482.78 10267.38,-1424.55"/>
<polygon fill="black" stroke="black" points="10267.9,-1428.01 10277.42,-1423.37 10267.08,-1421.06 10267.9,-1428.01"/>
</g>
<!-- layer0_moe_agg_gpu2&#45;&gt;layer0_allreduce_moe -->
<g id="edge315" class="edge">
<title>layer0_moe_agg_gpu2&#45;&gt;layer0_allreduce_moe</title>
<path fill="none" stroke="black" d="M7595.19,-1747.13C8169.34,-1725.28 11006.84,-1617.29 11770.79,-1588.22"/>
<polygon fill="black" stroke="black" points="11770.92,-1591.72 11780.78,-1587.84 11770.66,-1584.72 11770.92,-1591.72"/>
</g>
<!-- layer0_attn_gpu3 -->
<g id="node73" class="node">
<title>layer0_attn_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="11695,-2640 11452,-2640 11452,-2557 11695,-2557 11695,-2640"/>
<text text-anchor="middle" x="11573.5" y="-2624.8" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU3</text>
<text text-anchor="middle" x="11573.5" y="-2609.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="11573.5" y="-2594.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11573.5" y="-2579.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="11573.5" y="-2564.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_qkv_gpu3&#45;&gt;layer0_attn_gpu3 -->
<g id="edge120" class="edge">
<title>layer0_qkv_gpu3&#45;&gt;layer0_attn_gpu3</title>
<path fill="none" stroke="black" d="M11578.41,-2675.87C11577.87,-2667.5 11577.31,-2658.77 11576.77,-2650.33"/>
<polygon fill="black" stroke="black" points="11580.25,-2649.99 11576.12,-2640.23 11573.27,-2650.43 11580.25,-2649.99"/>
</g>
<!-- layer0_attn_proj_gpu3 -->
<g id="node74" class="node">
<title>layer0_attn_proj_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="11673.5,-2487 11473.5,-2487 11473.5,-2419 11673.5,-2419 11673.5,-2487"/>
<text text-anchor="middle" x="11573.5" y="-2471.8" font-family="Times,serif" font-size="14.00">L0_Attn_Projection_GPU3</text>
<text text-anchor="middle" x="11573.5" y="-2456.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11573.5" y="-2441.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11573.5" y="-2426.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_attn_gpu3&#45;&gt;layer0_attn_proj_gpu3 -->
<g id="edge121" class="edge">
<title>layer0_attn_gpu3&#45;&gt;layer0_attn_proj_gpu3</title>
<path fill="none" stroke="black" d="M11573.5,-2556.76C11573.5,-2538.17 11573.5,-2516.13 11573.5,-2497.24"/>
<polygon fill="black" stroke="black" points="11577,-2497.11 11573.5,-2487.11 11570,-2497.11 11577,-2497.11"/>
</g>
<!-- layer0_attn_norm_gpu3 -->
<g id="node75" class="node">
<title>layer0_attn_norm_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="11694.5,-2169.5 11450.5,-2169.5 11450.5,-2101.5 11694.5,-2101.5 11694.5,-2169.5"/>
<text text-anchor="middle" x="11572.5" y="-2154.3" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU3</text>
<text text-anchor="middle" x="11572.5" y="-2139.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="11572.5" y="-2124.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11572.5" y="-2109.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_attn_proj_gpu3&#45;&gt;layer0_attn_norm_gpu3 -->
<g id="edge122" class="edge">
<title>layer0_attn_proj_gpu3&#45;&gt;layer0_attn_norm_gpu3</title>
<path fill="none" stroke="black" d="M11536.75,-2418.6C11519.11,-2400.05 11499.82,-2375.42 11490.5,-2349 11470.39,-2292 11466.4,-2268.43 11490.5,-2213 11496.36,-2199.51 11505.91,-2187.32 11516.46,-2176.83"/>
<polygon fill="black" stroke="black" points="11518.99,-2179.25 11523.88,-2169.85 11514.2,-2174.15 11518.99,-2179.25"/>
</g>
<!-- layer0_attn_proj_gpu3&#45;&gt;layer0_allreduce_attn -->
<g id="edge317" class="edge">
<title>layer0_attn_proj_gpu3&#45;&gt;layer0_allreduce_attn</title>
<path fill="none" stroke="black" d="M11598.68,-2418.82C11614.89,-2397.46 11636.46,-2369.03 11655.73,-2343.63"/>
<polygon fill="black" stroke="black" points="11658.64,-2345.58 11661.9,-2335.5 11653.07,-2341.35 11658.64,-2345.58"/>
</g>
<!-- layer0_gate_gpu3 -->
<g id="node76" class="node">
<title>layer0_gate_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="10452.5,-2058 10208.5,-2058 10208.5,-1975 10452.5,-1975 10452.5,-2058"/>
<text text-anchor="middle" x="10330.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L0_Gate_GPU3</text>
<text text-anchor="middle" x="10330.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="10330.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="10330.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="10330.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_attn_norm_gpu3&#45;&gt;layer0_gate_gpu3 -->
<g id="edge123" class="edge">
<title>layer0_attn_norm_gpu3&#45;&gt;layer0_gate_gpu3</title>
<path fill="none" stroke="black" d="M11474.04,-2101.41C11463.15,-2098.54 11452.15,-2095.98 11441.5,-2094 11092.51,-2028.94 10672.59,-2017.86 10463.03,-2016.79"/>
<polygon fill="black" stroke="black" points="10462.92,-2013.29 10452.9,-2016.74 10462.89,-2020.29 10462.92,-2013.29"/>
</g>
<!-- layer0_expert3_0 -->
<g id="node77" class="node">
<title>layer0_expert3_0</title>
<polygon fill="lightgreen" stroke="black" points="8949,-1939 8784,-1939 8784,-1856 8949,-1856 8949,-1939"/>
<text text-anchor="middle" x="8866.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU3</text>
<text text-anchor="middle" x="8866.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="8866.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="8866.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="8866.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_0 -->
<g id="edge124" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10208.34,-2014.34C9921.75,-2010.72 9212,-1996.31 8959.02,-1939.07"/>
<polygon fill="black" stroke="black" points="8959.67,-1935.63 8949.13,-1936.76 8958.07,-1942.44 8959.67,-1935.63"/>
</g>
<!-- layer0_expert3_1 -->
<g id="node78" class="node">
<title>layer0_expert3_1</title>
<polygon fill="lightgreen" stroke="black" points="9132,-1939 8967,-1939 8967,-1856 9132,-1856 9132,-1939"/>
<text text-anchor="middle" x="9049.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU3</text>
<text text-anchor="middle" x="9049.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="9049.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="9049.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="9049.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_1 -->
<g id="edge125" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10208.05,-2013.1C9950.44,-2007.18 9359,-1988.75 9142.18,-1939.11"/>
<polygon fill="black" stroke="black" points="9142.68,-1935.63 9132.14,-1936.73 9141.06,-1942.44 9142.68,-1935.63"/>
</g>
<!-- layer0_expert3_2 -->
<g id="node79" class="node">
<title>layer0_expert3_2</title>
<polygon fill="lightgreen" stroke="black" points="9315,-1939 9150,-1939 9150,-1856 9315,-1856 9315,-1939"/>
<text text-anchor="middle" x="9232.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU3</text>
<text text-anchor="middle" x="9232.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="9232.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="9232.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="9232.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_2 -->
<g id="edge126" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10208.26,-2011.44C9982.14,-2003.08 9505.86,-1981.29 9325.08,-1939.1"/>
<polygon fill="black" stroke="black" points="9325.69,-1935.65 9315.15,-1936.68 9324.04,-1942.45 9325.69,-1935.65"/>
</g>
<!-- layer0_expert3_3 -->
<g id="node80" class="node">
<title>layer0_expert3_3</title>
<polygon fill="lightgreen" stroke="black" points="9498,-1939 9333,-1939 9333,-1856 9498,-1856 9498,-1939"/>
<text text-anchor="middle" x="9415.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU3</text>
<text text-anchor="middle" x="9415.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="9415.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="9415.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="9415.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_3 -->
<g id="edge127" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10208.36,-2009.05C10016.78,-1998.12 9653.32,-1973.96 9508.23,-1939.15"/>
<polygon fill="black" stroke="black" points="9508.72,-1935.66 9498.17,-1936.62 9507.01,-1942.45 9508.72,-1935.66"/>
</g>
<!-- layer0_expert3_4 -->
<g id="node81" class="node">
<title>layer0_expert3_4</title>
<polygon fill="lightgreen" stroke="black" points="9681,-1939 9516,-1939 9516,-1856 9681,-1856 9681,-1939"/>
<text text-anchor="middle" x="9598.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU3</text>
<text text-anchor="middle" x="9598.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="9598.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="9598.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="9598.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_4 -->
<g id="edge128" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10208.21,-2011.77C10079.95,-2005.4 9873.18,-1988.17 9690.95,-1939.19"/>
<polygon fill="black" stroke="black" points="9691.76,-1935.78 9681.19,-1936.53 9689.92,-1942.53 9691.76,-1935.78"/>
</g>
<!-- layer0_expert3_5 -->
<g id="node82" class="node">
<title>layer0_expert3_5</title>
<polygon fill="lightgreen" stroke="black" points="9864,-1939 9699,-1939 9699,-1856 9864,-1856 9864,-1939"/>
<text text-anchor="middle" x="9781.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU3</text>
<text text-anchor="middle" x="9781.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="9781.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="9781.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="9781.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_5 -->
<g id="edge129" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10208.05,-2003.58C10117.24,-1992.76 9990.81,-1973.52 9874.06,-1939.28"/>
<polygon fill="black" stroke="black" points="9874.82,-1935.86 9864.24,-1936.36 9872.83,-1942.57 9874.82,-1935.86"/>
</g>
<!-- layer0_expert3_6 -->
<g id="node83" class="node">
<title>layer0_expert3_6</title>
<polygon fill="lightgreen" stroke="black" points="10047,-1939 9882,-1939 9882,-1856 10047,-1856 10047,-1939"/>
<text text-anchor="middle" x="9964.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU3</text>
<text text-anchor="middle" x="9964.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="9964.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="9964.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="9964.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_6 -->
<g id="edge130" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10208.47,-1985.69C10162.95,-1973.56 10110.87,-1958.48 10056.56,-1939.26"/>
<polygon fill="black" stroke="black" points="10057.71,-1935.96 10047.12,-1935.89 10055.35,-1942.55 10057.71,-1935.96"/>
</g>
<!-- layer0_expert3_7 -->
<g id="node84" class="node">
<title>layer0_expert3_7</title>
<polygon fill="lightgreen" stroke="black" points="10230,-1939 10065,-1939 10065,-1856 10230,-1856 10230,-1939"/>
<text text-anchor="middle" x="10147.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU3</text>
<text text-anchor="middle" x="10147.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="10147.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="10147.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="10147.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_7 -->
<g id="edge131" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10267.01,-1974.91C10251.68,-1965.11 10235.19,-1954.56 10219.5,-1944.53"/>
<polygon fill="black" stroke="black" points="10221.19,-1941.46 10210.88,-1939.02 10217.42,-1947.36 10221.19,-1941.46"/>
</g>
<!-- layer0_expert3_8 -->
<g id="node85" class="node">
<title>layer0_expert3_8</title>
<polygon fill="lightgreen" stroke="black" points="10413,-1939 10248,-1939 10248,-1856 10413,-1856 10413,-1939"/>
<text text-anchor="middle" x="10330.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU3</text>
<text text-anchor="middle" x="10330.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="10330.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="10330.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="10330.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_8 -->
<g id="edge132" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10330.5,-1974.91C10330.5,-1966.65 10330.5,-1957.86 10330.5,-1949.3"/>
<polygon fill="black" stroke="black" points="10334,-1949.02 10330.5,-1939.02 10327,-1949.02 10334,-1949.02"/>
</g>
<!-- layer0_expert3_9 -->
<g id="node86" class="node">
<title>layer0_expert3_9</title>
<polygon fill="lightgreen" stroke="black" points="10596,-1939 10431,-1939 10431,-1856 10596,-1856 10596,-1939"/>
<text text-anchor="middle" x="10513.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU3</text>
<text text-anchor="middle" x="10513.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="10513.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="10513.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="10513.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_9 -->
<g id="edge133" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10393.99,-1974.91C10409.32,-1965.11 10425.81,-1954.56 10441.5,-1944.53"/>
<polygon fill="black" stroke="black" points="10443.58,-1947.36 10450.12,-1939.02 10439.81,-1941.46 10443.58,-1947.36"/>
</g>
<!-- layer0_expert3_10 -->
<g id="node87" class="node">
<title>layer0_expert3_10</title>
<polygon fill="lightgreen" stroke="black" points="10779,-1939 10614,-1939 10614,-1856 10779,-1856 10779,-1939"/>
<text text-anchor="middle" x="10696.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU3</text>
<text text-anchor="middle" x="10696.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="10696.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="10696.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="10696.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_10 -->
<g id="edge134" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10452.72,-1985.37C10500.54,-1972.55 10555.55,-1956.51 10604.5,-1939 10604.6,-1938.97 10604.7,-1938.93 10604.79,-1938.9"/>
<polygon fill="black" stroke="black" points="10605.81,-1942.25 10613.97,-1935.49 10603.38,-1935.69 10605.81,-1942.25"/>
</g>
<!-- layer0_expert3_11 -->
<g id="node88" class="node">
<title>layer0_expert3_11</title>
<polygon fill="lightgreen" stroke="black" points="10962,-1939 10797,-1939 10797,-1856 10962,-1856 10962,-1939"/>
<text text-anchor="middle" x="10879.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU3</text>
<text text-anchor="middle" x="10879.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="10879.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="10879.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="10879.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_11 -->
<g id="edge135" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10452.64,-2003.42C10543.24,-1992.52 10669.39,-1973.25 10786.96,-1938.94"/>
<polygon fill="black" stroke="black" points="10788.26,-1942.2 10796.86,-1936.01 10786.28,-1935.49 10788.26,-1942.2"/>
</g>
<!-- layer0_expert3_12 -->
<g id="node89" class="node">
<title>layer0_expert3_12</title>
<polygon fill="lightgreen" stroke="black" points="11145,-1939 10980,-1939 10980,-1856 11145,-1856 11145,-1939"/>
<text text-anchor="middle" x="11062.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU3</text>
<text text-anchor="middle" x="11062.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="11062.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="11062.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="11062.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_12 -->
<g id="edge136" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10452.56,-2011.6C10580.59,-2005.1 10787.01,-1987.76 10970.11,-1938.85"/>
<polygon fill="black" stroke="black" points="10971.18,-1942.19 10979.91,-1936.2 10969.35,-1935.43 10971.18,-1942.19"/>
</g>
<!-- layer0_expert3_13 -->
<g id="node90" class="node">
<title>layer0_expert3_13</title>
<polygon fill="lightgreen" stroke="black" points="11328,-1939 11163,-1939 11163,-1856 11328,-1856 11328,-1939"/>
<text text-anchor="middle" x="11245.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU3</text>
<text text-anchor="middle" x="11245.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="11245.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="11245.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="11245.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_13 -->
<g id="edge137" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10452.87,-2008.96C10644.31,-1997.93 11006.9,-1973.64 11152.82,-1938.83"/>
<polygon fill="black" stroke="black" points="11154.09,-1942.12 11162.94,-1936.3 11152.39,-1935.33 11154.09,-1942.12"/>
</g>
<!-- layer0_expert3_14 -->
<g id="node91" class="node">
<title>layer0_expert3_14</title>
<polygon fill="lightgreen" stroke="black" points="11511,-1939 11346,-1939 11346,-1856 11511,-1856 11511,-1939"/>
<text text-anchor="middle" x="11428.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU3</text>
<text text-anchor="middle" x="11428.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="11428.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="11428.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="11428.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_14 -->
<g id="edge138" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10452.6,-2011.37C10678.48,-2002.9 11154.24,-1980.94 11335.97,-1938.78"/>
<polygon fill="black" stroke="black" points="11337.06,-1942.12 11345.96,-1936.37 11335.42,-1935.32 11337.06,-1942.12"/>
</g>
<!-- layer0_expert3_15 -->
<g id="node92" class="node">
<title>layer0_expert3_15</title>
<polygon fill="lightgreen" stroke="black" points="11694,-1939 11529,-1939 11529,-1856 11694,-1856 11694,-1939"/>
<text text-anchor="middle" x="11611.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU3</text>
<text text-anchor="middle" x="11611.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="11611.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="11611.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="11611.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gate_gpu3&#45;&gt;layer0_expert3_15 -->
<g id="edge139" class="edge">
<title>layer0_gate_gpu3&#45;&gt;layer0_expert3_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10452.83,-2013.04C10710.32,-2006.99 11301.68,-1988.3 11519.21,-1938.73"/>
<polygon fill="black" stroke="black" points="11520.04,-1942.13 11528.97,-1936.42 11518.43,-1935.31 11520.04,-1942.13"/>
</g>
<!-- layer0_moe_agg_gpu3 -->
<g id="node93" class="node">
<title>layer0_moe_agg_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="10523,-1793.5 10320,-1793.5 10320,-1710.5 10523,-1710.5 10523,-1793.5"/>
<text text-anchor="middle" x="10421.5" y="-1778.3" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU3</text>
<text text-anchor="middle" x="10421.5" y="-1763.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="10421.5" y="-1748.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="10421.5" y="-1733.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="10421.5" y="-1718.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_expert3_0&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge140" class="edge">
<title>layer0_expert3_0&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M8949.15,-1858.3C8951.94,-1857.46 8954.73,-1856.69 8957.5,-1856 9213.43,-1792.15 10013,-1764.21 10309.44,-1755.85"/>
<polygon fill="black" stroke="black" points="10309.87,-1759.34 10319.77,-1755.57 10309.68,-1752.35 10309.87,-1759.34"/>
</g>
<!-- layer0_expert3_1&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge141" class="edge">
<title>layer0_expert3_1&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9132.15,-1858.33C9134.95,-1857.49 9137.74,-1856.7 9140.5,-1856 9360.5,-1799.95 10040.25,-1767.92 10309.76,-1757.15"/>
<polygon fill="black" stroke="black" points="10310.1,-1760.63 10319.95,-1756.74 10309.82,-1753.64 10310.1,-1760.63"/>
</g>
<!-- layer0_expert3_2&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge142" class="edge">
<title>layer0_expert3_2&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9315.17,-1858.38C9317.96,-1857.52 9320.74,-1856.72 9323.5,-1856 9507.69,-1807.76 10068.45,-1772.31 10309.46,-1758.89"/>
<polygon fill="black" stroke="black" points="10309.85,-1762.37 10319.64,-1758.32 10309.47,-1755.38 10309.85,-1762.37"/>
</g>
<!-- layer0_expert3_3&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge143" class="edge">
<title>layer0_expert3_3&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9498.18,-1858.45C9500.97,-1857.57 9503.75,-1856.75 9506.5,-1856 9788.76,-1779.27 10134.99,-1759.61 10309.53,-1754.63"/>
<polygon fill="black" stroke="black" points="10309.86,-1758.12 10319.76,-1754.35 10309.66,-1751.13 10309.86,-1758.12"/>
</g>
<!-- layer0_expert3_4&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge144" class="edge">
<title>layer0_expert3_4&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9681.21,-1858.55C9683.99,-1857.64 9686.76,-1856.79 9689.5,-1856 9903.79,-1794.55 10164.3,-1769.07 10309.64,-1759.04"/>
<polygon fill="black" stroke="black" points="10310.16,-1762.51 10319.9,-1758.34 10309.69,-1755.53 10310.16,-1762.51"/>
</g>
<!-- layer0_expert3_5&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge145" class="edge">
<title>layer0_expert3_5&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M9864.01,-1858.8C9866.86,-1857.81 9869.69,-1856.87 9872.5,-1856 10020.45,-1809.89 10197.61,-1781.21 10309.87,-1766.17"/>
<polygon fill="black" stroke="black" points="10310.4,-1769.63 10319.85,-1764.85 10309.48,-1762.69 10310.4,-1769.63"/>
</g>
<!-- layer0_expert3_6&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge146" class="edge">
<title>layer0_expert3_6&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10047.12,-1859.12C10049.94,-1858.04 10052.74,-1857 10055.5,-1856 10139.43,-1825.69 10236.77,-1798.67 10309.96,-1779.92"/>
<polygon fill="black" stroke="black" points="10310.85,-1783.31 10319.67,-1777.44 10309.12,-1776.52 10310.85,-1783.31"/>
</g>
<!-- layer0_expert3_7&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge147" class="edge">
<title>layer0_expert3_7&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10224.92,-1855.95C10259.06,-1838.07 10299.33,-1816.99 10334.5,-1798.56"/>
<polygon fill="black" stroke="black" points="10336.56,-1801.43 10343.8,-1793.69 10333.32,-1795.23 10336.56,-1801.43"/>
</g>
<!-- layer0_expert3_8&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge148" class="edge">
<title>layer0_expert3_8&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10356.33,-1855.76C10366.8,-1839.25 10379,-1820.03 10389.98,-1802.7"/>
<polygon fill="black" stroke="black" points="10393.2,-1804.16 10395.6,-1793.84 10387.29,-1800.41 10393.2,-1804.16"/>
</g>
<!-- layer0_expert3_9&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge149" class="edge">
<title>layer0_expert3_9&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10487.38,-1855.76C10476.8,-1839.25 10464.47,-1820.03 10453.36,-1802.7"/>
<polygon fill="black" stroke="black" points="10456.03,-1800.37 10447.68,-1793.84 10450.13,-1804.15 10456.03,-1800.37"/>
</g>
<!-- layer0_expert3_10&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge150" class="edge">
<title>layer0_expert3_10&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10618.8,-1855.95C10584.39,-1838 10543.78,-1816.81 10508.37,-1798.33"/>
<polygon fill="black" stroke="black" points="10509.97,-1795.22 10499.49,-1793.69 10506.73,-1801.42 10509.97,-1795.22"/>
</g>
<!-- layer0_expert3_11&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge151" class="edge">
<title>layer0_expert3_11&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10796.97,-1859.52C10793.79,-1858.3 10790.62,-1857.12 10787.5,-1856 10703.51,-1825.86 10606.17,-1798.83 10532.99,-1780.03"/>
<polygon fill="black" stroke="black" points="10533.84,-1776.64 10523.29,-1777.55 10532.11,-1783.42 10533.84,-1776.64"/>
</g>
<!-- layer0_expert3_12&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge152" class="edge">
<title>layer0_expert3_12&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M10979.84,-1859.07C10976.7,-1857.98 10973.58,-1856.95 10970.5,-1856 10822.46,-1810.19 10645.32,-1781.44 10533.09,-1766.3"/>
<polygon fill="black" stroke="black" points="10533.48,-1762.82 10523.11,-1764.96 10532.56,-1769.76 10533.48,-1762.82"/>
</g>
<!-- layer0_expert3_13&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge153" class="edge">
<title>layer0_expert3_13&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11162.89,-1858.89C11159.74,-1857.85 11156.61,-1856.88 11153.5,-1856 10939.09,-1794.98 10678.62,-1769.35 10533.33,-1759.17"/>
<polygon fill="black" stroke="black" points="10533.28,-1755.66 10523.06,-1758.47 10532.8,-1762.64 10533.28,-1755.66"/>
</g>
<!-- layer0_expert3_14&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge154" class="edge">
<title>layer0_expert3_14&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11345.92,-1858.77C11342.76,-1857.77 11339.62,-1856.84 11336.5,-1856 11054.08,-1779.84 10707.92,-1759.93 10533.43,-1754.77"/>
<polygon fill="black" stroke="black" points="10533.3,-1751.27 10523.21,-1754.48 10533.1,-1758.26 10533.3,-1751.27"/>
</g>
<!-- layer0_expert3_15&#45;&gt;layer0_moe_agg_gpu3 -->
<g id="edge155" class="edge">
<title>layer0_expert3_15&#45;&gt;layer0_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M11528.94,-1858.7C11525.78,-1857.72 11522.62,-1856.81 11519.5,-1856 11335.21,-1808.14 10774.51,-1772.47 10533.53,-1758.94"/>
<polygon fill="black" stroke="black" points="10533.52,-1755.44 10523.34,-1758.37 10533.13,-1762.43 10533.52,-1755.44"/>
</g>
<!-- layer0_output_gpu3 -->
<g id="node94" class="node">
<title>layer0_output_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="11450.5,-1442 11206.5,-1442 11206.5,-1374 11450.5,-1374 11450.5,-1442"/>
<text text-anchor="middle" x="11328.5" y="-1426.8" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU3</text>
<text text-anchor="middle" x="11328.5" y="-1411.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="11328.5" y="-1396.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11328.5" y="-1381.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_moe_agg_gpu3&#45;&gt;layer0_output_gpu3 -->
<g id="edge156" class="edge">
<title>layer0_moe_agg_gpu3&#45;&gt;layer0_output_gpu3</title>
<path fill="none" stroke="black" d="M10523.34,-1712.6C10699.45,-1646.19 11058.58,-1510.78 11231.37,-1445.63"/>
<polygon fill="black" stroke="black" points="11232.84,-1448.81 11240.97,-1442.01 11230.37,-1442.26 11232.84,-1448.81"/>
</g>
<!-- layer0_moe_agg_gpu3&#45;&gt;layer0_allreduce_moe -->
<g id="edge319" class="edge">
<title>layer0_moe_agg_gpu3&#45;&gt;layer0_allreduce_moe</title>
<path fill="none" stroke="black" d="M10523.07,-1739.78C10784.56,-1710.9 11482.56,-1633.79 11799.7,-1598.76"/>
<polygon fill="black" stroke="black" points="11800.34,-1602.21 11809.9,-1597.64 11799.57,-1595.25 11800.34,-1602.21"/>
</g>
<!-- layer0_attn_gpu4 -->
<g id="node96" class="node">
<title>layer0_attn_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="11956,-2640 11713,-2640 11713,-2557 11956,-2557 11956,-2640"/>
<text text-anchor="middle" x="11834.5" y="-2624.8" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU4</text>
<text text-anchor="middle" x="11834.5" y="-2609.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="11834.5" y="-2594.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11834.5" y="-2579.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="11834.5" y="-2564.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_qkv_gpu4&#45;&gt;layer0_attn_gpu4 -->
<g id="edge157" class="edge">
<title>layer0_qkv_gpu4&#45;&gt;layer0_attn_gpu4</title>
<path fill="none" stroke="black" d="M11824.69,-2675.87C11825.76,-2667.5 11826.88,-2658.77 11827.97,-2650.33"/>
<polygon fill="black" stroke="black" points="11831.46,-2650.6 11829.27,-2640.23 11824.52,-2649.7 11831.46,-2650.6"/>
</g>
<!-- layer0_attn_proj_gpu4 -->
<g id="node97" class="node">
<title>layer0_attn_proj_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="11934.5,-2487 11734.5,-2487 11734.5,-2419 11934.5,-2419 11934.5,-2487"/>
<text text-anchor="middle" x="11834.5" y="-2471.8" font-family="Times,serif" font-size="14.00">L0_Attn_Projection_GPU4</text>
<text text-anchor="middle" x="11834.5" y="-2456.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="11834.5" y="-2441.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11834.5" y="-2426.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_attn_gpu4&#45;&gt;layer0_attn_proj_gpu4 -->
<g id="edge158" class="edge">
<title>layer0_attn_gpu4&#45;&gt;layer0_attn_proj_gpu4</title>
<path fill="none" stroke="black" d="M11834.5,-2556.76C11834.5,-2538.17 11834.5,-2516.13 11834.5,-2497.24"/>
<polygon fill="black" stroke="black" points="11838,-2497.11 11834.5,-2487.11 11831,-2497.11 11838,-2497.11"/>
</g>
<!-- layer0_attn_norm_gpu4 -->
<g id="node98" class="node">
<title>layer0_attn_norm_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="11956.5,-2169.5 11712.5,-2169.5 11712.5,-2101.5 11956.5,-2101.5 11956.5,-2169.5"/>
<text text-anchor="middle" x="11834.5" y="-2154.3" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU4</text>
<text text-anchor="middle" x="11834.5" y="-2139.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="11834.5" y="-2124.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="11834.5" y="-2109.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_attn_proj_gpu4&#45;&gt;layer0_attn_norm_gpu4 -->
<g id="edge159" class="edge">
<title>layer0_attn_proj_gpu4&#45;&gt;layer0_attn_norm_gpu4</title>
<path fill="none" stroke="black" d="M11869.53,-2418.82C11886.65,-2400.15 11905.47,-2375.35 11914.5,-2349 11934.1,-2291.82 11938.25,-2268.58 11914.5,-2213 11908.73,-2199.5 11899.29,-2187.25 11888.87,-2176.7"/>
<polygon fill="black" stroke="black" points="11891.18,-2174.07 11881.53,-2169.68 11886.33,-2179.12 11891.18,-2174.07"/>
</g>
<!-- layer0_attn_proj_gpu4&#45;&gt;layer0_allreduce_attn -->
<g id="edge321" class="edge">
<title>layer0_attn_proj_gpu4&#45;&gt;layer0_allreduce_attn</title>
<path fill="none" stroke="black" d="M11808.74,-2418.82C11792.15,-2397.46 11770.08,-2369.03 11750.35,-2343.63"/>
<polygon fill="black" stroke="black" points="11752.94,-2341.25 11744.04,-2335.5 11747.41,-2345.55 11752.94,-2341.25"/>
</g>
<!-- layer0_gate_gpu4 -->
<g id="node99" class="node">
<title>layer0_gate_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13197.5,-2058 12953.5,-2058 12953.5,-1975 13197.5,-1975 13197.5,-2058"/>
<text text-anchor="middle" x="13075.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L0_Gate_GPU4</text>
<text text-anchor="middle" x="13075.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="13075.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="13075.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="13075.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_attn_norm_gpu4&#45;&gt;layer0_gate_gpu4 -->
<g id="edge160" class="edge">
<title>layer0_attn_norm_gpu4&#45;&gt;layer0_gate_gpu4</title>
<path fill="none" stroke="black" d="M11932.96,-2101.41C11943.85,-2098.54 11954.85,-2095.99 11965.5,-2094 12314.18,-2028.99 12733.72,-2017.88 12943.09,-2016.8"/>
<polygon fill="black" stroke="black" points="12943.22,-2020.3 12953.21,-2016.75 12943.19,-2013.3 12943.22,-2020.3"/>
</g>
<!-- layer0_expert4_0 -->
<g id="node100" class="node">
<title>layer0_expert4_0</title>
<polygon fill="lightgreen" stroke="black" points="11877,-1939 11712,-1939 11712,-1856 11877,-1856 11877,-1939"/>
<text text-anchor="middle" x="11794.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU4</text>
<text text-anchor="middle" x="11794.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="11794.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="11794.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="11794.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_0 -->
<g id="edge161" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12953.05,-2013.1C12695.44,-2007.18 12104,-1988.75 11887.18,-1939.11"/>
<polygon fill="black" stroke="black" points="11887.68,-1935.63 11877.14,-1936.73 11886.06,-1942.44 11887.68,-1935.63"/>
</g>
<!-- layer0_expert4_1 -->
<g id="node101" class="node">
<title>layer0_expert4_1</title>
<polygon fill="lightgreen" stroke="black" points="12060,-1939 11895,-1939 11895,-1856 12060,-1856 12060,-1939"/>
<text text-anchor="middle" x="11977.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU4</text>
<text text-anchor="middle" x="11977.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="11977.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="11977.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="11977.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_1 -->
<g id="edge162" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12953.26,-2011.44C12727.14,-2003.08 12250.86,-1981.29 12070.08,-1939.1"/>
<polygon fill="black" stroke="black" points="12070.69,-1935.65 12060.15,-1936.68 12069.04,-1942.45 12070.69,-1935.65"/>
</g>
<!-- layer0_expert4_2 -->
<g id="node102" class="node">
<title>layer0_expert4_2</title>
<polygon fill="lightgreen" stroke="black" points="12243,-1939 12078,-1939 12078,-1856 12243,-1856 12243,-1939"/>
<text text-anchor="middle" x="12160.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU4</text>
<text text-anchor="middle" x="12160.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="12160.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="12160.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="12160.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_2 -->
<g id="edge163" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12953.36,-2009.05C12761.78,-1998.12 12398.32,-1973.96 12253.23,-1939.15"/>
<polygon fill="black" stroke="black" points="12253.72,-1935.66 12243.17,-1936.62 12252.01,-1942.45 12253.72,-1935.66"/>
</g>
<!-- layer0_expert4_3 -->
<g id="node103" class="node">
<title>layer0_expert4_3</title>
<polygon fill="lightgreen" stroke="black" points="12426,-1939 12261,-1939 12261,-1856 12426,-1856 12426,-1939"/>
<text text-anchor="middle" x="12343.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU4</text>
<text text-anchor="middle" x="12343.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="12343.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="12343.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="12343.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_3 -->
<g id="edge164" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12953.21,-2011.77C12824.95,-2005.4 12618.18,-1988.17 12435.95,-1939.19"/>
<polygon fill="black" stroke="black" points="12436.76,-1935.78 12426.19,-1936.53 12434.92,-1942.53 12436.76,-1935.78"/>
</g>
<!-- layer0_expert4_4 -->
<g id="node104" class="node">
<title>layer0_expert4_4</title>
<polygon fill="lightgreen" stroke="black" points="12609,-1939 12444,-1939 12444,-1856 12609,-1856 12609,-1939"/>
<text text-anchor="middle" x="12526.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU4</text>
<text text-anchor="middle" x="12526.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="12526.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="12526.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="12526.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_4 -->
<g id="edge165" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12953.05,-2003.58C12862.24,-1992.76 12735.81,-1973.52 12619.06,-1939.28"/>
<polygon fill="black" stroke="black" points="12619.82,-1935.86 12609.24,-1936.36 12617.83,-1942.57 12619.82,-1935.86"/>
</g>
<!-- layer0_expert4_5 -->
<g id="node105" class="node">
<title>layer0_expert4_5</title>
<polygon fill="lightgreen" stroke="black" points="12792,-1939 12627,-1939 12627,-1856 12792,-1856 12792,-1939"/>
<text text-anchor="middle" x="12709.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU4</text>
<text text-anchor="middle" x="12709.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="12709.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="12709.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="12709.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_5 -->
<g id="edge166" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12953.47,-1985.69C12907.95,-1973.56 12855.87,-1958.48 12801.56,-1939.26"/>
<polygon fill="black" stroke="black" points="12802.71,-1935.96 12792.12,-1935.89 12800.35,-1942.55 12802.71,-1935.96"/>
</g>
<!-- layer0_expert4_6 -->
<g id="node106" class="node">
<title>layer0_expert4_6</title>
<polygon fill="lightgreen" stroke="black" points="12975,-1939 12810,-1939 12810,-1856 12975,-1856 12975,-1939"/>
<text text-anchor="middle" x="12892.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU4</text>
<text text-anchor="middle" x="12892.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="12892.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="12892.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="12892.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_6 -->
<g id="edge167" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13012.01,-1974.91C12996.68,-1965.11 12980.19,-1954.56 12964.5,-1944.53"/>
<polygon fill="black" stroke="black" points="12966.19,-1941.46 12955.88,-1939.02 12962.42,-1947.36 12966.19,-1941.46"/>
</g>
<!-- layer0_expert4_7 -->
<g id="node107" class="node">
<title>layer0_expert4_7</title>
<polygon fill="lightgreen" stroke="black" points="13158,-1939 12993,-1939 12993,-1856 13158,-1856 13158,-1939"/>
<text text-anchor="middle" x="13075.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU4</text>
<text text-anchor="middle" x="13075.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="13075.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="13075.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="13075.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_7 -->
<g id="edge168" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13075.5,-1974.91C13075.5,-1966.65 13075.5,-1957.86 13075.5,-1949.3"/>
<polygon fill="black" stroke="black" points="13079,-1949.02 13075.5,-1939.02 13072,-1949.02 13079,-1949.02"/>
</g>
<!-- layer0_expert4_8 -->
<g id="node108" class="node">
<title>layer0_expert4_8</title>
<polygon fill="lightgreen" stroke="black" points="13341,-1939 13176,-1939 13176,-1856 13341,-1856 13341,-1939"/>
<text text-anchor="middle" x="13258.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU4</text>
<text text-anchor="middle" x="13258.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="13258.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="13258.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="13258.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_8 -->
<g id="edge169" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13138.99,-1974.91C13154.32,-1965.11 13170.81,-1954.56 13186.5,-1944.53"/>
<polygon fill="black" stroke="black" points="13188.58,-1947.36 13195.12,-1939.02 13184.81,-1941.46 13188.58,-1947.36"/>
</g>
<!-- layer0_expert4_9 -->
<g id="node109" class="node">
<title>layer0_expert4_9</title>
<polygon fill="lightgreen" stroke="black" points="13524,-1939 13359,-1939 13359,-1856 13524,-1856 13524,-1939"/>
<text text-anchor="middle" x="13441.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU4</text>
<text text-anchor="middle" x="13441.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="13441.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="13441.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="13441.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_9 -->
<g id="edge170" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13197.72,-1985.37C13245.54,-1972.55 13300.55,-1956.51 13349.5,-1939 13349.6,-1938.97 13349.7,-1938.93 13349.79,-1938.9"/>
<polygon fill="black" stroke="black" points="13350.81,-1942.25 13358.97,-1935.49 13348.38,-1935.69 13350.81,-1942.25"/>
</g>
<!-- layer0_expert4_10 -->
<g id="node110" class="node">
<title>layer0_expert4_10</title>
<polygon fill="lightgreen" stroke="black" points="13707,-1939 13542,-1939 13542,-1856 13707,-1856 13707,-1939"/>
<text text-anchor="middle" x="13624.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU4</text>
<text text-anchor="middle" x="13624.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="13624.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="13624.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="13624.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_10 -->
<g id="edge171" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13197.64,-2003.42C13288.24,-1992.52 13414.39,-1973.25 13531.96,-1938.94"/>
<polygon fill="black" stroke="black" points="13533.26,-1942.2 13541.86,-1936.01 13531.28,-1935.49 13533.26,-1942.2"/>
</g>
<!-- layer0_expert4_11 -->
<g id="node111" class="node">
<title>layer0_expert4_11</title>
<polygon fill="lightgreen" stroke="black" points="13890,-1939 13725,-1939 13725,-1856 13890,-1856 13890,-1939"/>
<text text-anchor="middle" x="13807.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU4</text>
<text text-anchor="middle" x="13807.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="13807.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="13807.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="13807.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_11 -->
<g id="edge172" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13197.56,-2011.6C13325.59,-2005.1 13532.01,-1987.76 13715.11,-1938.85"/>
<polygon fill="black" stroke="black" points="13716.18,-1942.19 13724.91,-1936.2 13714.35,-1935.43 13716.18,-1942.19"/>
</g>
<!-- layer0_expert4_12 -->
<g id="node112" class="node">
<title>layer0_expert4_12</title>
<polygon fill="lightgreen" stroke="black" points="14073,-1939 13908,-1939 13908,-1856 14073,-1856 14073,-1939"/>
<text text-anchor="middle" x="13990.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU4</text>
<text text-anchor="middle" x="13990.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="13990.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="13990.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="13990.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_12 -->
<g id="edge173" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13197.87,-2008.96C13389.31,-1997.93 13751.9,-1973.64 13897.82,-1938.83"/>
<polygon fill="black" stroke="black" points="13899.09,-1942.12 13907.94,-1936.3 13897.39,-1935.33 13899.09,-1942.12"/>
</g>
<!-- layer0_expert4_13 -->
<g id="node113" class="node">
<title>layer0_expert4_13</title>
<polygon fill="lightgreen" stroke="black" points="14256,-1939 14091,-1939 14091,-1856 14256,-1856 14256,-1939"/>
<text text-anchor="middle" x="14173.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU4</text>
<text text-anchor="middle" x="14173.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="14173.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="14173.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="14173.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_13 -->
<g id="edge174" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13197.6,-2011.37C13423.48,-2002.9 13899.24,-1980.94 14080.97,-1938.78"/>
<polygon fill="black" stroke="black" points="14082.06,-1942.12 14090.96,-1936.37 14080.42,-1935.32 14082.06,-1942.12"/>
</g>
<!-- layer0_expert4_14 -->
<g id="node114" class="node">
<title>layer0_expert4_14</title>
<polygon fill="lightgreen" stroke="black" points="14439,-1939 14274,-1939 14274,-1856 14439,-1856 14439,-1939"/>
<text text-anchor="middle" x="14356.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU4</text>
<text text-anchor="middle" x="14356.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="14356.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="14356.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="14356.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_14 -->
<g id="edge175" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13197.83,-2013.04C13455.32,-2006.99 14046.68,-1988.3 14264.21,-1938.73"/>
<polygon fill="black" stroke="black" points="14265.04,-1942.13 14273.97,-1936.42 14263.43,-1935.31 14265.04,-1942.13"/>
</g>
<!-- layer0_expert4_15 -->
<g id="node115" class="node">
<title>layer0_expert4_15</title>
<polygon fill="lightgreen" stroke="black" points="14622,-1939 14457,-1939 14457,-1856 14622,-1856 14622,-1939"/>
<text text-anchor="middle" x="14539.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU4</text>
<text text-anchor="middle" x="14539.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="14539.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="14539.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="14539.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gate_gpu4&#45;&gt;layer0_expert4_15 -->
<g id="edge176" class="edge">
<title>layer0_gate_gpu4&#45;&gt;layer0_expert4_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13197.56,-2014.27C13483.91,-2010.51 14193.07,-1995.8 14447.05,-1938.76"/>
<polygon fill="black" stroke="black" points="14448.03,-1942.13 14456.98,-1936.45 14446.45,-1935.31 14448.03,-1942.13"/>
</g>
<!-- layer0_moe_agg_gpu4 -->
<g id="node116" class="node">
<title>layer0_moe_agg_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="13085,-1793.5 12882,-1793.5 12882,-1710.5 13085,-1710.5 13085,-1793.5"/>
<text text-anchor="middle" x="12983.5" y="-1778.3" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU4</text>
<text text-anchor="middle" x="12983.5" y="-1763.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="12983.5" y="-1748.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12983.5" y="-1733.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="12983.5" y="-1718.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_expert4_0&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge177" class="edge">
<title>layer0_expert4_0&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M11877.17,-1858.38C11879.96,-1857.52 11882.74,-1856.72 11885.5,-1856 12069.69,-1807.76 12630.45,-1772.31 12871.46,-1758.89"/>
<polygon fill="black" stroke="black" points="12871.85,-1762.37 12881.64,-1758.32 12871.47,-1755.38 12871.85,-1762.37"/>
</g>
<!-- layer0_expert4_1&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge178" class="edge">
<title>layer0_expert4_1&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M12060.18,-1858.45C12062.97,-1857.57 12065.75,-1856.75 12068.5,-1856 12350.76,-1779.27 12696.99,-1759.61 12871.53,-1754.63"/>
<polygon fill="black" stroke="black" points="12871.86,-1758.12 12881.76,-1754.35 12871.66,-1751.13 12871.86,-1758.12"/>
</g>
<!-- layer0_expert4_2&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge179" class="edge">
<title>layer0_expert4_2&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M12243.21,-1858.55C12245.99,-1857.64 12248.76,-1856.79 12251.5,-1856 12465.79,-1794.55 12726.3,-1769.07 12871.64,-1759.04"/>
<polygon fill="black" stroke="black" points="12872.16,-1762.51 12881.9,-1758.34 12871.69,-1755.53 12872.16,-1762.51"/>
</g>
<!-- layer0_expert4_3&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge180" class="edge">
<title>layer0_expert4_3&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M12426.01,-1858.8C12428.86,-1857.81 12431.69,-1856.87 12434.5,-1856 12582.45,-1809.89 12759.61,-1781.21 12871.87,-1766.17"/>
<polygon fill="black" stroke="black" points="12872.4,-1769.63 12881.85,-1764.85 12871.48,-1762.69 12872.4,-1769.63"/>
</g>
<!-- layer0_expert4_4&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge181" class="edge">
<title>layer0_expert4_4&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M12609.12,-1859.12C12611.94,-1858.04 12614.74,-1857 12617.5,-1856 12701.43,-1825.69 12798.77,-1798.67 12871.96,-1779.92"/>
<polygon fill="black" stroke="black" points="12872.85,-1783.31 12881.67,-1777.44 12871.12,-1776.52 12872.85,-1783.31"/>
</g>
<!-- layer0_expert4_5&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge182" class="edge">
<title>layer0_expert4_5&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M12786.92,-1855.95C12821.06,-1838.07 12861.33,-1816.99 12896.5,-1798.56"/>
<polygon fill="black" stroke="black" points="12898.56,-1801.43 12905.8,-1793.69 12895.32,-1795.23 12898.56,-1801.43"/>
</g>
<!-- layer0_expert4_6&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge183" class="edge">
<title>layer0_expert4_6&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M12918.33,-1855.76C12928.8,-1839.25 12941,-1820.03 12951.98,-1802.7"/>
<polygon fill="black" stroke="black" points="12955.2,-1804.16 12957.6,-1793.84 12949.29,-1800.41 12955.2,-1804.16"/>
</g>
<!-- layer0_expert4_7&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge184" class="edge">
<title>layer0_expert4_7&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13049.38,-1855.76C13038.8,-1839.25 13026.47,-1820.03 13015.36,-1802.7"/>
<polygon fill="black" stroke="black" points="13018.03,-1800.37 13009.68,-1793.84 13012.13,-1804.15 13018.03,-1800.37"/>
</g>
<!-- layer0_expert4_8&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge185" class="edge">
<title>layer0_expert4_8&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13180.8,-1855.95C13146.39,-1838 13105.78,-1816.81 13070.37,-1798.33"/>
<polygon fill="black" stroke="black" points="13071.97,-1795.22 13061.49,-1793.69 13068.73,-1801.42 13071.97,-1795.22"/>
</g>
<!-- layer0_expert4_9&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge186" class="edge">
<title>layer0_expert4_9&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13358.97,-1859.52C13355.79,-1858.3 13352.62,-1857.12 13349.5,-1856 13265.51,-1825.86 13168.17,-1798.83 13094.99,-1780.03"/>
<polygon fill="black" stroke="black" points="13095.84,-1776.64 13085.29,-1777.55 13094.11,-1783.42 13095.84,-1776.64"/>
</g>
<!-- layer0_expert4_10&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge187" class="edge">
<title>layer0_expert4_10&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13541.84,-1859.07C13538.7,-1857.98 13535.58,-1856.95 13532.5,-1856 13384.46,-1810.19 13207.32,-1781.44 13095.09,-1766.3"/>
<polygon fill="black" stroke="black" points="13095.48,-1762.82 13085.11,-1764.96 13094.56,-1769.76 13095.48,-1762.82"/>
</g>
<!-- layer0_expert4_11&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge188" class="edge">
<title>layer0_expert4_11&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13724.89,-1858.89C13721.74,-1857.85 13718.61,-1856.88 13715.5,-1856 13501.09,-1794.98 13240.62,-1769.35 13095.33,-1759.17"/>
<polygon fill="black" stroke="black" points="13095.28,-1755.66 13085.06,-1758.47 13094.8,-1762.64 13095.28,-1755.66"/>
</g>
<!-- layer0_expert4_12&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge189" class="edge">
<title>layer0_expert4_12&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M13907.92,-1858.77C13904.76,-1857.77 13901.62,-1856.84 13898.5,-1856 13616.08,-1779.84 13269.92,-1759.93 13095.43,-1754.77"/>
<polygon fill="black" stroke="black" points="13095.3,-1751.27 13085.21,-1754.48 13095.1,-1758.26 13095.3,-1751.27"/>
</g>
<!-- layer0_expert4_13&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge190" class="edge">
<title>layer0_expert4_13&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14090.94,-1858.7C14087.78,-1857.72 14084.62,-1856.81 14081.5,-1856 13897.21,-1808.14 13336.51,-1772.47 13095.53,-1758.94"/>
<polygon fill="black" stroke="black" points="13095.52,-1755.44 13085.34,-1758.37 13095.13,-1762.43 13095.52,-1755.44"/>
</g>
<!-- layer0_expert4_14&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge191" class="edge">
<title>layer0_expert4_14&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14273.95,-1858.65C14270.79,-1857.68 14267.63,-1856.79 14264.5,-1856 14044.39,-1800.39 13364.7,-1768.1 13095.22,-1757.2"/>
<polygon fill="black" stroke="black" points="13095.17,-1753.7 13085.03,-1756.79 13094.89,-1760.69 13095.17,-1753.7"/>
</g>
<!-- layer0_expert4_15&#45;&gt;layer0_moe_agg_gpu4 -->
<g id="edge192" class="edge">
<title>layer0_expert4_15&#45;&gt;layer0_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M14456.96,-1858.61C14453.8,-1857.65 14450.63,-1856.78 14447.5,-1856 14191.45,-1792.67 13391.96,-1764.41 13095.54,-1755.91"/>
<polygon fill="black" stroke="black" points="13095.31,-1752.4 13085.21,-1755.62 13095.11,-1759.4 13095.31,-1752.4"/>
</g>
<!-- layer0_output_gpu4 -->
<g id="node117" class="node">
<title>layer0_output_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="12381.5,-1442 12137.5,-1442 12137.5,-1374 12381.5,-1374 12381.5,-1442"/>
<text text-anchor="middle" x="12259.5" y="-1426.8" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU4</text>
<text text-anchor="middle" x="12259.5" y="-1411.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="12259.5" y="-1396.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12259.5" y="-1381.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_moe_agg_gpu4&#45;&gt;layer0_output_gpu4 -->
<g id="edge193" class="edge">
<title>layer0_moe_agg_gpu4&#45;&gt;layer0_output_gpu4</title>
<path fill="none" stroke="black" d="M12897.6,-1710.43C12755.99,-1643.53 12475.59,-1511.08 12338.58,-1446.36"/>
<polygon fill="black" stroke="black" points="12339.91,-1443.11 12329.37,-1442 12336.92,-1449.44 12339.91,-1443.11"/>
</g>
<!-- layer0_moe_agg_gpu4&#45;&gt;layer0_allreduce_moe -->
<g id="edge323" class="edge">
<title>layer0_moe_agg_gpu4&#45;&gt;layer0_allreduce_moe</title>
<path fill="none" stroke="black" d="M12881.67,-1734.08C12698.81,-1703.69 12314.36,-1639.8 12104.56,-1604.94"/>
<polygon fill="black" stroke="black" points="12104.84,-1601.44 12094.4,-1603.25 12103.69,-1608.34 12104.84,-1601.44"/>
</g>
<!-- layer0_attn_gpu5 -->
<g id="node119" class="node">
<title>layer0_attn_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12217,-2640 11974,-2640 11974,-2557 12217,-2557 12217,-2640"/>
<text text-anchor="middle" x="12095.5" y="-2624.8" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU5</text>
<text text-anchor="middle" x="12095.5" y="-2609.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="12095.5" y="-2594.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12095.5" y="-2579.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="12095.5" y="-2564.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_qkv_gpu5&#45;&gt;layer0_attn_gpu5 -->
<g id="edge194" class="edge">
<title>layer0_qkv_gpu5&#45;&gt;layer0_attn_gpu5</title>
<path fill="none" stroke="black" d="M12080.78,-2675.87C12082.41,-2667.41 12084.11,-2658.58 12085.75,-2650.06"/>
<polygon fill="black" stroke="black" points="12089.19,-2650.71 12087.65,-2640.23 12082.32,-2649.39 12089.19,-2650.71"/>
</g>
<!-- layer0_attn_proj_gpu5 -->
<g id="node120" class="node">
<title>layer0_attn_proj_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12195.5,-2487 11995.5,-2487 11995.5,-2419 12195.5,-2419 12195.5,-2487"/>
<text text-anchor="middle" x="12095.5" y="-2471.8" font-family="Times,serif" font-size="14.00">L0_Attn_Projection_GPU5</text>
<text text-anchor="middle" x="12095.5" y="-2456.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12095.5" y="-2441.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12095.5" y="-2426.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_attn_gpu5&#45;&gt;layer0_attn_proj_gpu5 -->
<g id="edge195" class="edge">
<title>layer0_attn_gpu5&#45;&gt;layer0_attn_proj_gpu5</title>
<path fill="none" stroke="black" d="M12095.5,-2556.76C12095.5,-2538.17 12095.5,-2516.13 12095.5,-2497.24"/>
<polygon fill="black" stroke="black" points="12099,-2497.11 12095.5,-2487.11 12092,-2497.11 12099,-2497.11"/>
</g>
<!-- layer0_attn_norm_gpu5 -->
<g id="node121" class="node">
<title>layer0_attn_norm_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12218.5,-2169.5 11974.5,-2169.5 11974.5,-2101.5 12218.5,-2101.5 12218.5,-2169.5"/>
<text text-anchor="middle" x="12096.5" y="-2154.3" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU5</text>
<text text-anchor="middle" x="12096.5" y="-2139.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="12096.5" y="-2124.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12096.5" y="-2109.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_attn_proj_gpu5&#45;&gt;layer0_attn_norm_gpu5 -->
<g id="edge196" class="edge">
<title>layer0_attn_proj_gpu5&#45;&gt;layer0_attn_norm_gpu5</title>
<path fill="none" stroke="black" d="M12095.61,-2418.83C12095.79,-2361.43 12096.16,-2243.62 12096.36,-2179.83"/>
<polygon fill="black" stroke="black" points="12099.86,-2179.71 12096.39,-2169.7 12092.86,-2179.69 12099.86,-2179.71"/>
</g>
<!-- layer0_attn_proj_gpu5&#45;&gt;layer0_allreduce_attn -->
<g id="edge325" class="edge">
<title>layer0_attn_proj_gpu5&#45;&gt;layer0_allreduce_attn</title>
<path fill="none" stroke="black" d="M12020.97,-2418.95C11996.33,-2408.07 11968.76,-2395.97 11943.5,-2385 11896.45,-2364.58 11844.1,-2342.17 11800.25,-2323.48"/>
<polygon fill="black" stroke="black" points="11801.6,-2320.25 11791.02,-2319.55 11798.85,-2326.69 11801.6,-2320.25"/>
</g>
<!-- layer0_gate_gpu5 -->
<g id="node122" class="node">
<title>layer0_gate_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="16125.5,-2058 15881.5,-2058 15881.5,-1975 16125.5,-1975 16125.5,-2058"/>
<text text-anchor="middle" x="16003.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L0_Gate_GPU5</text>
<text text-anchor="middle" x="16003.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="16003.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="16003.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="16003.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_attn_norm_gpu5&#45;&gt;layer0_gate_gpu5 -->
<g id="edge197" class="edge">
<title>layer0_attn_norm_gpu5&#45;&gt;layer0_gate_gpu5</title>
<path fill="none" stroke="black" d="M12192.71,-2101.44C12204.32,-2098.44 12216.1,-2095.84 12227.5,-2094 12410.69,-2064.43 15223.2,-2027.33 15871.1,-2019.15"/>
<polygon fill="black" stroke="black" points="15871.45,-2022.64 15881.4,-2019.02 15871.36,-2015.64 15871.45,-2022.64"/>
</g>
<!-- layer0_expert5_0 -->
<g id="node123" class="node">
<title>layer0_expert5_0</title>
<polygon fill="lightgreen" stroke="black" points="14805,-1939 14640,-1939 14640,-1856 14805,-1856 14805,-1939"/>
<text text-anchor="middle" x="14722.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU5</text>
<text text-anchor="middle" x="14722.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="14722.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="14722.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="14722.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_0 -->
<g id="edge198" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15881.05,-2013.1C15623.44,-2007.18 15032,-1988.75 14815.18,-1939.11"/>
<polygon fill="black" stroke="black" points="14815.68,-1935.63 14805.14,-1936.73 14814.06,-1942.44 14815.68,-1935.63"/>
</g>
<!-- layer0_expert5_1 -->
<g id="node124" class="node">
<title>layer0_expert5_1</title>
<polygon fill="lightgreen" stroke="black" points="14988,-1939 14823,-1939 14823,-1856 14988,-1856 14988,-1939"/>
<text text-anchor="middle" x="14905.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU5</text>
<text text-anchor="middle" x="14905.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="14905.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="14905.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="14905.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_1 -->
<g id="edge199" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15881.26,-2011.44C15655.14,-2003.08 15178.86,-1981.29 14998.08,-1939.1"/>
<polygon fill="black" stroke="black" points="14998.69,-1935.65 14988.15,-1936.68 14997.04,-1942.45 14998.69,-1935.65"/>
</g>
<!-- layer0_expert5_2 -->
<g id="node125" class="node">
<title>layer0_expert5_2</title>
<polygon fill="lightgreen" stroke="black" points="15171,-1939 15006,-1939 15006,-1856 15171,-1856 15171,-1939"/>
<text text-anchor="middle" x="15088.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU5</text>
<text text-anchor="middle" x="15088.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="15088.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="15088.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="15088.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_2 -->
<g id="edge200" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15881.36,-2009.05C15689.78,-1998.12 15326.32,-1973.96 15181.23,-1939.15"/>
<polygon fill="black" stroke="black" points="15181.72,-1935.66 15171.17,-1936.62 15180.01,-1942.45 15181.72,-1935.66"/>
</g>
<!-- layer0_expert5_3 -->
<g id="node126" class="node">
<title>layer0_expert5_3</title>
<polygon fill="lightgreen" stroke="black" points="15354,-1939 15189,-1939 15189,-1856 15354,-1856 15354,-1939"/>
<text text-anchor="middle" x="15271.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU5</text>
<text text-anchor="middle" x="15271.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="15271.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="15271.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="15271.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_3 -->
<g id="edge201" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15881.21,-2011.77C15752.95,-2005.4 15546.18,-1988.17 15363.95,-1939.19"/>
<polygon fill="black" stroke="black" points="15364.76,-1935.78 15354.19,-1936.53 15362.92,-1942.53 15364.76,-1935.78"/>
</g>
<!-- layer0_expert5_4 -->
<g id="node127" class="node">
<title>layer0_expert5_4</title>
<polygon fill="lightgreen" stroke="black" points="15537,-1939 15372,-1939 15372,-1856 15537,-1856 15537,-1939"/>
<text text-anchor="middle" x="15454.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU5</text>
<text text-anchor="middle" x="15454.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="15454.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="15454.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="15454.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_4 -->
<g id="edge202" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15881.05,-2003.58C15790.24,-1992.76 15663.81,-1973.52 15547.06,-1939.28"/>
<polygon fill="black" stroke="black" points="15547.82,-1935.86 15537.24,-1936.36 15545.83,-1942.57 15547.82,-1935.86"/>
</g>
<!-- layer0_expert5_5 -->
<g id="node128" class="node">
<title>layer0_expert5_5</title>
<polygon fill="lightgreen" stroke="black" points="15720,-1939 15555,-1939 15555,-1856 15720,-1856 15720,-1939"/>
<text text-anchor="middle" x="15637.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU5</text>
<text text-anchor="middle" x="15637.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="15637.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="15637.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="15637.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_5 -->
<g id="edge203" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15881.47,-1985.69C15835.95,-1973.56 15783.87,-1958.48 15729.56,-1939.26"/>
<polygon fill="black" stroke="black" points="15730.71,-1935.96 15720.12,-1935.89 15728.35,-1942.55 15730.71,-1935.96"/>
</g>
<!-- layer0_expert5_6 -->
<g id="node129" class="node">
<title>layer0_expert5_6</title>
<polygon fill="lightgreen" stroke="black" points="15903,-1939 15738,-1939 15738,-1856 15903,-1856 15903,-1939"/>
<text text-anchor="middle" x="15820.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU5</text>
<text text-anchor="middle" x="15820.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="15820.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="15820.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="15820.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_6 -->
<g id="edge204" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15940.01,-1974.91C15924.68,-1965.11 15908.19,-1954.56 15892.5,-1944.53"/>
<polygon fill="black" stroke="black" points="15894.19,-1941.46 15883.88,-1939.02 15890.42,-1947.36 15894.19,-1941.46"/>
</g>
<!-- layer0_expert5_7 -->
<g id="node130" class="node">
<title>layer0_expert5_7</title>
<polygon fill="lightgreen" stroke="black" points="16086,-1939 15921,-1939 15921,-1856 16086,-1856 16086,-1939"/>
<text text-anchor="middle" x="16003.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU5</text>
<text text-anchor="middle" x="16003.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="16003.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="16003.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="16003.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_7 -->
<g id="edge205" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16003.5,-1974.91C16003.5,-1966.65 16003.5,-1957.86 16003.5,-1949.3"/>
<polygon fill="black" stroke="black" points="16007,-1949.02 16003.5,-1939.02 16000,-1949.02 16007,-1949.02"/>
</g>
<!-- layer0_expert5_8 -->
<g id="node131" class="node">
<title>layer0_expert5_8</title>
<polygon fill="lightgreen" stroke="black" points="16269,-1939 16104,-1939 16104,-1856 16269,-1856 16269,-1939"/>
<text text-anchor="middle" x="16186.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU5</text>
<text text-anchor="middle" x="16186.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="16186.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="16186.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="16186.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_8 -->
<g id="edge206" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16066.99,-1974.91C16082.32,-1965.11 16098.81,-1954.56 16114.5,-1944.53"/>
<polygon fill="black" stroke="black" points="16116.58,-1947.36 16123.12,-1939.02 16112.81,-1941.46 16116.58,-1947.36"/>
</g>
<!-- layer0_expert5_9 -->
<g id="node132" class="node">
<title>layer0_expert5_9</title>
<polygon fill="lightgreen" stroke="black" points="16452,-1939 16287,-1939 16287,-1856 16452,-1856 16452,-1939"/>
<text text-anchor="middle" x="16369.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU5</text>
<text text-anchor="middle" x="16369.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="16369.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="16369.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="16369.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_9 -->
<g id="edge207" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16125.72,-1985.37C16173.54,-1972.55 16228.55,-1956.51 16277.5,-1939 16277.6,-1938.97 16277.7,-1938.93 16277.79,-1938.9"/>
<polygon fill="black" stroke="black" points="16278.81,-1942.25 16286.97,-1935.49 16276.38,-1935.69 16278.81,-1942.25"/>
</g>
<!-- layer0_expert5_10 -->
<g id="node133" class="node">
<title>layer0_expert5_10</title>
<polygon fill="lightgreen" stroke="black" points="16635,-1939 16470,-1939 16470,-1856 16635,-1856 16635,-1939"/>
<text text-anchor="middle" x="16552.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU5</text>
<text text-anchor="middle" x="16552.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="16552.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="16552.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="16552.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_10 -->
<g id="edge208" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16125.64,-2003.42C16216.24,-1992.52 16342.39,-1973.25 16459.96,-1938.94"/>
<polygon fill="black" stroke="black" points="16461.26,-1942.2 16469.86,-1936.01 16459.28,-1935.49 16461.26,-1942.2"/>
</g>
<!-- layer0_expert5_11 -->
<g id="node134" class="node">
<title>layer0_expert5_11</title>
<polygon fill="lightgreen" stroke="black" points="16818,-1939 16653,-1939 16653,-1856 16818,-1856 16818,-1939"/>
<text text-anchor="middle" x="16735.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU5</text>
<text text-anchor="middle" x="16735.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="16735.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="16735.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="16735.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_11 -->
<g id="edge209" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16125.56,-2011.6C16253.59,-2005.1 16460.01,-1987.76 16643.11,-1938.85"/>
<polygon fill="black" stroke="black" points="16644.18,-1942.19 16652.91,-1936.2 16642.35,-1935.43 16644.18,-1942.19"/>
</g>
<!-- layer0_expert5_12 -->
<g id="node135" class="node">
<title>layer0_expert5_12</title>
<polygon fill="lightgreen" stroke="black" points="17001,-1939 16836,-1939 16836,-1856 17001,-1856 17001,-1939"/>
<text text-anchor="middle" x="16918.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU5</text>
<text text-anchor="middle" x="16918.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="16918.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="16918.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="16918.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_12 -->
<g id="edge210" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16125.87,-2008.96C16317.31,-1997.93 16679.9,-1973.64 16825.82,-1938.83"/>
<polygon fill="black" stroke="black" points="16827.09,-1942.12 16835.94,-1936.3 16825.39,-1935.33 16827.09,-1942.12"/>
</g>
<!-- layer0_expert5_13 -->
<g id="node136" class="node">
<title>layer0_expert5_13</title>
<polygon fill="lightgreen" stroke="black" points="17184,-1939 17019,-1939 17019,-1856 17184,-1856 17184,-1939"/>
<text text-anchor="middle" x="17101.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU5</text>
<text text-anchor="middle" x="17101.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="17101.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="17101.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="17101.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_13 -->
<g id="edge211" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16125.6,-2011.37C16351.48,-2002.9 16827.24,-1980.94 17008.97,-1938.78"/>
<polygon fill="black" stroke="black" points="17010.06,-1942.12 17018.96,-1936.37 17008.42,-1935.32 17010.06,-1942.12"/>
</g>
<!-- layer0_expert5_14 -->
<g id="node137" class="node">
<title>layer0_expert5_14</title>
<polygon fill="lightgreen" stroke="black" points="17367,-1939 17202,-1939 17202,-1856 17367,-1856 17367,-1939"/>
<text text-anchor="middle" x="17284.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU5</text>
<text text-anchor="middle" x="17284.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="17284.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="17284.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="17284.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_14 -->
<g id="edge212" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16125.83,-2013.04C16383.32,-2006.99 16974.68,-1988.3 17192.21,-1938.73"/>
<polygon fill="black" stroke="black" points="17193.04,-1942.13 17201.97,-1936.42 17191.43,-1935.31 17193.04,-1942.13"/>
</g>
<!-- layer0_expert5_15 -->
<g id="node138" class="node">
<title>layer0_expert5_15</title>
<polygon fill="lightgreen" stroke="black" points="17550,-1939 17385,-1939 17385,-1856 17550,-1856 17550,-1939"/>
<text text-anchor="middle" x="17467.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU5</text>
<text text-anchor="middle" x="17467.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="17467.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="17467.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="17467.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gate_gpu5&#45;&gt;layer0_expert5_15 -->
<g id="edge213" class="edge">
<title>layer0_gate_gpu5&#45;&gt;layer0_expert5_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16125.56,-2014.27C16411.91,-2010.51 17121.07,-1995.8 17375.05,-1938.76"/>
<polygon fill="black" stroke="black" points="17376.03,-1942.13 17384.98,-1936.45 17374.45,-1935.31 17376.03,-1942.13"/>
</g>
<!-- layer0_moe_agg_gpu5 -->
<g id="node139" class="node">
<title>layer0_moe_agg_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="16013,-1793.5 15810,-1793.5 15810,-1710.5 16013,-1710.5 16013,-1793.5"/>
<text text-anchor="middle" x="15911.5" y="-1778.3" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU5</text>
<text text-anchor="middle" x="15911.5" y="-1763.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="15911.5" y="-1748.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="15911.5" y="-1733.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="15911.5" y="-1718.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_expert5_0&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge214" class="edge">
<title>layer0_expert5_0&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M14805.17,-1858.38C14807.96,-1857.52 14810.74,-1856.72 14813.5,-1856 14997.69,-1807.76 15558.45,-1772.31 15799.46,-1758.89"/>
<polygon fill="black" stroke="black" points="15799.85,-1762.37 15809.64,-1758.32 15799.47,-1755.38 15799.85,-1762.37"/>
</g>
<!-- layer0_expert5_1&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge215" class="edge">
<title>layer0_expert5_1&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M14988.18,-1858.45C14990.97,-1857.57 14993.75,-1856.75 14996.5,-1856 15278.76,-1779.27 15624.99,-1759.61 15799.53,-1754.63"/>
<polygon fill="black" stroke="black" points="15799.86,-1758.12 15809.76,-1754.35 15799.66,-1751.13 15799.86,-1758.12"/>
</g>
<!-- layer0_expert5_2&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge216" class="edge">
<title>layer0_expert5_2&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M15171.21,-1858.55C15173.99,-1857.64 15176.76,-1856.79 15179.5,-1856 15393.79,-1794.55 15654.3,-1769.07 15799.64,-1759.04"/>
<polygon fill="black" stroke="black" points="15800.16,-1762.51 15809.9,-1758.34 15799.69,-1755.53 15800.16,-1762.51"/>
</g>
<!-- layer0_expert5_3&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge217" class="edge">
<title>layer0_expert5_3&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M15354.01,-1858.8C15356.86,-1857.81 15359.69,-1856.87 15362.5,-1856 15510.45,-1809.89 15687.61,-1781.21 15799.87,-1766.17"/>
<polygon fill="black" stroke="black" points="15800.4,-1769.63 15809.85,-1764.85 15799.48,-1762.69 15800.4,-1769.63"/>
</g>
<!-- layer0_expert5_4&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge218" class="edge">
<title>layer0_expert5_4&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M15537.12,-1859.12C15539.94,-1858.04 15542.74,-1857 15545.5,-1856 15629.43,-1825.69 15726.77,-1798.67 15799.96,-1779.92"/>
<polygon fill="black" stroke="black" points="15800.85,-1783.31 15809.67,-1777.44 15799.12,-1776.52 15800.85,-1783.31"/>
</g>
<!-- layer0_expert5_5&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge219" class="edge">
<title>layer0_expert5_5&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M15714.92,-1855.95C15749.06,-1838.07 15789.33,-1816.99 15824.5,-1798.56"/>
<polygon fill="black" stroke="black" points="15826.56,-1801.43 15833.8,-1793.69 15823.32,-1795.23 15826.56,-1801.43"/>
</g>
<!-- layer0_expert5_6&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge220" class="edge">
<title>layer0_expert5_6&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M15846.33,-1855.76C15856.8,-1839.25 15869,-1820.03 15879.98,-1802.7"/>
<polygon fill="black" stroke="black" points="15883.2,-1804.16 15885.6,-1793.84 15877.29,-1800.41 15883.2,-1804.16"/>
</g>
<!-- layer0_expert5_7&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge221" class="edge">
<title>layer0_expert5_7&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M15977.38,-1855.76C15966.8,-1839.25 15954.47,-1820.03 15943.36,-1802.7"/>
<polygon fill="black" stroke="black" points="15946.03,-1800.37 15937.68,-1793.84 15940.13,-1804.15 15946.03,-1800.37"/>
</g>
<!-- layer0_expert5_8&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge222" class="edge">
<title>layer0_expert5_8&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16108.8,-1855.95C16074.39,-1838 16033.78,-1816.81 15998.37,-1798.33"/>
<polygon fill="black" stroke="black" points="15999.97,-1795.22 15989.49,-1793.69 15996.73,-1801.42 15999.97,-1795.22"/>
</g>
<!-- layer0_expert5_9&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge223" class="edge">
<title>layer0_expert5_9&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16286.97,-1859.52C16283.79,-1858.3 16280.62,-1857.12 16277.5,-1856 16193.51,-1825.86 16096.17,-1798.83 16022.99,-1780.03"/>
<polygon fill="black" stroke="black" points="16023.84,-1776.64 16013.29,-1777.55 16022.11,-1783.42 16023.84,-1776.64"/>
</g>
<!-- layer0_expert5_10&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge224" class="edge">
<title>layer0_expert5_10&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16469.84,-1859.07C16466.7,-1857.98 16463.58,-1856.95 16460.5,-1856 16312.46,-1810.19 16135.32,-1781.44 16023.09,-1766.3"/>
<polygon fill="black" stroke="black" points="16023.48,-1762.82 16013.11,-1764.96 16022.56,-1769.76 16023.48,-1762.82"/>
</g>
<!-- layer0_expert5_11&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge225" class="edge">
<title>layer0_expert5_11&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16652.89,-1858.89C16649.74,-1857.85 16646.61,-1856.88 16643.5,-1856 16429.09,-1794.98 16168.62,-1769.35 16023.33,-1759.17"/>
<polygon fill="black" stroke="black" points="16023.28,-1755.66 16013.06,-1758.47 16022.8,-1762.64 16023.28,-1755.66"/>
</g>
<!-- layer0_expert5_12&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge226" class="edge">
<title>layer0_expert5_12&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M16835.92,-1858.77C16832.76,-1857.77 16829.62,-1856.84 16826.5,-1856 16544.08,-1779.84 16197.92,-1759.93 16023.43,-1754.77"/>
<polygon fill="black" stroke="black" points="16023.3,-1751.27 16013.21,-1754.48 16023.1,-1758.26 16023.3,-1751.27"/>
</g>
<!-- layer0_expert5_13&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge227" class="edge">
<title>layer0_expert5_13&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17018.94,-1858.7C17015.78,-1857.72 17012.62,-1856.81 17009.5,-1856 16825.21,-1808.14 16264.51,-1772.47 16023.53,-1758.94"/>
<polygon fill="black" stroke="black" points="16023.52,-1755.44 16013.34,-1758.37 16023.13,-1762.43 16023.52,-1755.44"/>
</g>
<!-- layer0_expert5_14&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge228" class="edge">
<title>layer0_expert5_14&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17201.95,-1858.65C17198.79,-1857.68 17195.63,-1856.79 17192.5,-1856 16972.39,-1800.39 16292.7,-1768.1 16023.22,-1757.2"/>
<polygon fill="black" stroke="black" points="16023.17,-1753.7 16013.03,-1756.79 16022.89,-1760.69 16023.17,-1753.7"/>
</g>
<!-- layer0_expert5_15&#45;&gt;layer0_moe_agg_gpu5 -->
<g id="edge229" class="edge">
<title>layer0_expert5_15&#45;&gt;layer0_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M17384.96,-1858.61C17381.8,-1857.65 17378.63,-1856.78 17375.5,-1856 17119.45,-1792.67 16319.96,-1764.41 16023.54,-1755.91"/>
<polygon fill="black" stroke="black" points="16023.31,-1752.4 16013.21,-1755.62 16023.11,-1759.4 16023.31,-1752.4"/>
</g>
<!-- layer0_output_gpu5 -->
<g id="node140" class="node">
<title>layer0_output_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="13588.5,-1442 13344.5,-1442 13344.5,-1374 13588.5,-1374 13588.5,-1442"/>
<text text-anchor="middle" x="13466.5" y="-1426.8" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU5</text>
<text text-anchor="middle" x="13466.5" y="-1411.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="13466.5" y="-1396.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="13466.5" y="-1381.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_moe_agg_gpu5&#45;&gt;layer0_output_gpu5 -->
<g id="edge230" class="edge">
<title>layer0_moe_agg_gpu5&#45;&gt;layer0_output_gpu5</title>
<path fill="none" stroke="black" d="M15809.94,-1736.79C15422.22,-1682.56 14035.19,-1488.55 13598.88,-1427.52"/>
<polygon fill="black" stroke="black" points="13599.14,-1424.02 13588.75,-1426.1 13598.17,-1430.95 13599.14,-1424.02"/>
</g>
<!-- layer0_moe_agg_gpu5&#45;&gt;layer0_allreduce_moe -->
<g id="edge327" class="edge">
<title>layer0_moe_agg_gpu5&#45;&gt;layer0_allreduce_moe</title>
<path fill="none" stroke="black" d="M15809.86,-1746.63C15281.53,-1723.89 12846.37,-1619.12 12148.12,-1589.07"/>
<polygon fill="black" stroke="black" points="12148.11,-1585.57 12137.97,-1588.64 12147.81,-1592.56 12148.11,-1585.57"/>
</g>
<!-- layer0_attn_gpu6 -->
<g id="node142" class="node">
<title>layer0_attn_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="12478,-2640 12235,-2640 12235,-2557 12478,-2557 12478,-2640"/>
<text text-anchor="middle" x="12356.5" y="-2624.8" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU6</text>
<text text-anchor="middle" x="12356.5" y="-2609.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="12356.5" y="-2594.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12356.5" y="-2579.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="12356.5" y="-2564.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_qkv_gpu6&#45;&gt;layer0_attn_gpu6 -->
<g id="edge231" class="edge">
<title>layer0_qkv_gpu6&#45;&gt;layer0_attn_gpu6</title>
<path fill="none" stroke="black" d="M12346.69,-2675.87C12347.76,-2667.5 12348.88,-2658.77 12349.97,-2650.33"/>
<polygon fill="black" stroke="black" points="12353.46,-2650.6 12351.27,-2640.23 12346.52,-2649.7 12353.46,-2650.6"/>
</g>
<!-- layer0_attn_proj_gpu6 -->
<g id="node143" class="node">
<title>layer0_attn_proj_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="12456.5,-2487 12256.5,-2487 12256.5,-2419 12456.5,-2419 12456.5,-2487"/>
<text text-anchor="middle" x="12356.5" y="-2471.8" font-family="Times,serif" font-size="14.00">L0_Attn_Projection_GPU6</text>
<text text-anchor="middle" x="12356.5" y="-2456.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12356.5" y="-2441.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12356.5" y="-2426.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_attn_gpu6&#45;&gt;layer0_attn_proj_gpu6 -->
<g id="edge232" class="edge">
<title>layer0_attn_gpu6&#45;&gt;layer0_attn_proj_gpu6</title>
<path fill="none" stroke="black" d="M12356.5,-2556.76C12356.5,-2538.17 12356.5,-2516.13 12356.5,-2497.24"/>
<polygon fill="black" stroke="black" points="12360,-2497.11 12356.5,-2487.11 12353,-2497.11 12360,-2497.11"/>
</g>
<!-- layer0_attn_norm_gpu6 -->
<g id="node144" class="node">
<title>layer0_attn_norm_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="12480.5,-2169.5 12236.5,-2169.5 12236.5,-2101.5 12480.5,-2101.5 12480.5,-2169.5"/>
<text text-anchor="middle" x="12358.5" y="-2154.3" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU6</text>
<text text-anchor="middle" x="12358.5" y="-2139.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="12358.5" y="-2124.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12358.5" y="-2109.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_attn_proj_gpu6&#45;&gt;layer0_attn_norm_gpu6 -->
<g id="edge233" class="edge">
<title>layer0_attn_proj_gpu6&#45;&gt;layer0_attn_norm_gpu6</title>
<path fill="none" stroke="black" d="M12356.71,-2418.83C12357.07,-2361.43 12357.82,-2243.62 12358.23,-2179.83"/>
<polygon fill="black" stroke="black" points="12361.73,-2179.72 12358.29,-2169.7 12354.73,-2179.67 12361.73,-2179.72"/>
</g>
<!-- layer0_attn_proj_gpu6&#45;&gt;layer0_allreduce_attn -->
<g id="edge329" class="edge">
<title>layer0_attn_proj_gpu6&#45;&gt;layer0_allreduce_attn</title>
<path fill="none" stroke="black" d="M12289.6,-2418.83C12263.52,-2406.88 12233.07,-2394.11 12204.5,-2385 12088.33,-2347.94 11952.65,-2321.04 11851.66,-2304.04"/>
<polygon fill="black" stroke="black" points="11852.13,-2300.57 11841.69,-2302.38 11850.98,-2307.48 11852.13,-2300.57"/>
</g>
<!-- layer0_gate_gpu6 -->
<g id="node145" class="node">
<title>layer0_gate_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="19053.5,-2058 18809.5,-2058 18809.5,-1975 19053.5,-1975 19053.5,-2058"/>
<text text-anchor="middle" x="18931.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L0_Gate_GPU6</text>
<text text-anchor="middle" x="18931.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="18931.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="18931.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="18931.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_attn_norm_gpu6&#45;&gt;layer0_gate_gpu6 -->
<g id="edge234" class="edge">
<title>layer0_attn_norm_gpu6&#45;&gt;layer0_gate_gpu6</title>
<path fill="none" stroke="black" d="M12454.33,-2101.41C12466.06,-2098.39 12477.98,-2095.8 12489.5,-2094 12689.59,-2062.76 15932.01,-2060.47 16134.5,-2058 17160.3,-2045.51 18397.66,-2026.06 18798.97,-2019.64"/>
<polygon fill="black" stroke="black" points="18799.22,-2023.13 18809.16,-2019.47 18799.11,-2016.13 18799.22,-2023.13"/>
</g>
<!-- layer0_expert6_0 -->
<g id="node146" class="node">
<title>layer0_expert6_0</title>
<polygon fill="lightgreen" stroke="black" points="17733,-1939 17568,-1939 17568,-1856 17733,-1856 17733,-1939"/>
<text text-anchor="middle" x="17650.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU6</text>
<text text-anchor="middle" x="17650.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="17650.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="17650.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="17650.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_0 -->
<g id="edge235" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18809.05,-2013.1C18551.44,-2007.18 17960,-1988.75 17743.18,-1939.11"/>
<polygon fill="black" stroke="black" points="17743.68,-1935.63 17733.14,-1936.73 17742.06,-1942.44 17743.68,-1935.63"/>
</g>
<!-- layer0_expert6_1 -->
<g id="node147" class="node">
<title>layer0_expert6_1</title>
<polygon fill="lightgreen" stroke="black" points="17916,-1939 17751,-1939 17751,-1856 17916,-1856 17916,-1939"/>
<text text-anchor="middle" x="17833.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU6</text>
<text text-anchor="middle" x="17833.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="17833.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="17833.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="17833.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_1 -->
<g id="edge236" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18809.26,-2011.44C18583.14,-2003.08 18106.86,-1981.29 17926.08,-1939.1"/>
<polygon fill="black" stroke="black" points="17926.69,-1935.65 17916.15,-1936.68 17925.04,-1942.45 17926.69,-1935.65"/>
</g>
<!-- layer0_expert6_2 -->
<g id="node148" class="node">
<title>layer0_expert6_2</title>
<polygon fill="lightgreen" stroke="black" points="18099,-1939 17934,-1939 17934,-1856 18099,-1856 18099,-1939"/>
<text text-anchor="middle" x="18016.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU6</text>
<text text-anchor="middle" x="18016.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="18016.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="18016.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="18016.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_2 -->
<g id="edge237" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18809.36,-2009.05C18617.78,-1998.12 18254.32,-1973.96 18109.23,-1939.15"/>
<polygon fill="black" stroke="black" points="18109.72,-1935.66 18099.17,-1936.62 18108.01,-1942.45 18109.72,-1935.66"/>
</g>
<!-- layer0_expert6_3 -->
<g id="node149" class="node">
<title>layer0_expert6_3</title>
<polygon fill="lightgreen" stroke="black" points="18282,-1939 18117,-1939 18117,-1856 18282,-1856 18282,-1939"/>
<text text-anchor="middle" x="18199.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU6</text>
<text text-anchor="middle" x="18199.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="18199.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="18199.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="18199.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_3 -->
<g id="edge238" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18809.21,-2011.77C18680.95,-2005.4 18474.18,-1988.17 18291.95,-1939.19"/>
<polygon fill="black" stroke="black" points="18292.76,-1935.78 18282.19,-1936.53 18290.92,-1942.53 18292.76,-1935.78"/>
</g>
<!-- layer0_expert6_4 -->
<g id="node150" class="node">
<title>layer0_expert6_4</title>
<polygon fill="lightgreen" stroke="black" points="18465,-1939 18300,-1939 18300,-1856 18465,-1856 18465,-1939"/>
<text text-anchor="middle" x="18382.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU6</text>
<text text-anchor="middle" x="18382.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="18382.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="18382.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="18382.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_4 -->
<g id="edge239" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18809.05,-2003.58C18718.24,-1992.76 18591.81,-1973.52 18475.06,-1939.28"/>
<polygon fill="black" stroke="black" points="18475.82,-1935.86 18465.24,-1936.36 18473.83,-1942.57 18475.82,-1935.86"/>
</g>
<!-- layer0_expert6_5 -->
<g id="node151" class="node">
<title>layer0_expert6_5</title>
<polygon fill="lightgreen" stroke="black" points="18648,-1939 18483,-1939 18483,-1856 18648,-1856 18648,-1939"/>
<text text-anchor="middle" x="18565.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU6</text>
<text text-anchor="middle" x="18565.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="18565.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="18565.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="18565.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_5 -->
<g id="edge240" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18809.47,-1985.69C18763.95,-1973.56 18711.87,-1958.48 18657.56,-1939.26"/>
<polygon fill="black" stroke="black" points="18658.71,-1935.96 18648.12,-1935.89 18656.35,-1942.55 18658.71,-1935.96"/>
</g>
<!-- layer0_expert6_6 -->
<g id="node152" class="node">
<title>layer0_expert6_6</title>
<polygon fill="lightgreen" stroke="black" points="18831,-1939 18666,-1939 18666,-1856 18831,-1856 18831,-1939"/>
<text text-anchor="middle" x="18748.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU6</text>
<text text-anchor="middle" x="18748.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="18748.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="18748.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="18748.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_6 -->
<g id="edge241" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18868.01,-1974.91C18852.68,-1965.11 18836.19,-1954.56 18820.5,-1944.53"/>
<polygon fill="black" stroke="black" points="18822.19,-1941.46 18811.88,-1939.02 18818.42,-1947.36 18822.19,-1941.46"/>
</g>
<!-- layer0_expert6_7 -->
<g id="node153" class="node">
<title>layer0_expert6_7</title>
<polygon fill="lightgreen" stroke="black" points="19014,-1939 18849,-1939 18849,-1856 19014,-1856 19014,-1939"/>
<text text-anchor="middle" x="18931.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU6</text>
<text text-anchor="middle" x="18931.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="18931.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="18931.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="18931.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_7 -->
<g id="edge242" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18931.5,-1974.91C18931.5,-1966.65 18931.5,-1957.86 18931.5,-1949.3"/>
<polygon fill="black" stroke="black" points="18935,-1949.02 18931.5,-1939.02 18928,-1949.02 18935,-1949.02"/>
</g>
<!-- layer0_expert6_8 -->
<g id="node154" class="node">
<title>layer0_expert6_8</title>
<polygon fill="lightgreen" stroke="black" points="19197,-1939 19032,-1939 19032,-1856 19197,-1856 19197,-1939"/>
<text text-anchor="middle" x="19114.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU6</text>
<text text-anchor="middle" x="19114.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="19114.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="19114.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="19114.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_8 -->
<g id="edge243" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18994.99,-1974.91C19010.32,-1965.11 19026.81,-1954.56 19042.5,-1944.53"/>
<polygon fill="black" stroke="black" points="19044.58,-1947.36 19051.12,-1939.02 19040.81,-1941.46 19044.58,-1947.36"/>
</g>
<!-- layer0_expert6_9 -->
<g id="node155" class="node">
<title>layer0_expert6_9</title>
<polygon fill="lightgreen" stroke="black" points="19380,-1939 19215,-1939 19215,-1856 19380,-1856 19380,-1939"/>
<text text-anchor="middle" x="19297.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU6</text>
<text text-anchor="middle" x="19297.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="19297.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="19297.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="19297.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_9 -->
<g id="edge244" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19053.72,-1985.37C19101.54,-1972.55 19156.55,-1956.51 19205.5,-1939 19205.6,-1938.97 19205.7,-1938.93 19205.79,-1938.9"/>
<polygon fill="black" stroke="black" points="19206.81,-1942.25 19214.97,-1935.49 19204.38,-1935.69 19206.81,-1942.25"/>
</g>
<!-- layer0_expert6_10 -->
<g id="node156" class="node">
<title>layer0_expert6_10</title>
<polygon fill="lightgreen" stroke="black" points="19563,-1939 19398,-1939 19398,-1856 19563,-1856 19563,-1939"/>
<text text-anchor="middle" x="19480.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU6</text>
<text text-anchor="middle" x="19480.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="19480.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="19480.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="19480.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_10 -->
<g id="edge245" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19053.64,-2003.42C19144.24,-1992.52 19270.39,-1973.25 19387.96,-1938.94"/>
<polygon fill="black" stroke="black" points="19389.26,-1942.2 19397.86,-1936.01 19387.28,-1935.49 19389.26,-1942.2"/>
</g>
<!-- layer0_expert6_11 -->
<g id="node157" class="node">
<title>layer0_expert6_11</title>
<polygon fill="lightgreen" stroke="black" points="19746,-1939 19581,-1939 19581,-1856 19746,-1856 19746,-1939"/>
<text text-anchor="middle" x="19663.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU6</text>
<text text-anchor="middle" x="19663.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="19663.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="19663.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="19663.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_11 -->
<g id="edge246" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19053.56,-2011.6C19181.59,-2005.1 19388.01,-1987.76 19571.11,-1938.85"/>
<polygon fill="black" stroke="black" points="19572.18,-1942.19 19580.91,-1936.2 19570.35,-1935.43 19572.18,-1942.19"/>
</g>
<!-- layer0_expert6_12 -->
<g id="node158" class="node">
<title>layer0_expert6_12</title>
<polygon fill="lightgreen" stroke="black" points="19929,-1939 19764,-1939 19764,-1856 19929,-1856 19929,-1939"/>
<text text-anchor="middle" x="19846.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU6</text>
<text text-anchor="middle" x="19846.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="19846.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="19846.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="19846.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_12 -->
<g id="edge247" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19053.87,-2008.96C19245.31,-1997.93 19607.9,-1973.64 19753.82,-1938.83"/>
<polygon fill="black" stroke="black" points="19755.09,-1942.12 19763.94,-1936.3 19753.39,-1935.33 19755.09,-1942.12"/>
</g>
<!-- layer0_expert6_13 -->
<g id="node159" class="node">
<title>layer0_expert6_13</title>
<polygon fill="lightgreen" stroke="black" points="20112,-1939 19947,-1939 19947,-1856 20112,-1856 20112,-1939"/>
<text text-anchor="middle" x="20029.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU6</text>
<text text-anchor="middle" x="20029.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="20029.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="20029.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="20029.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_13 -->
<g id="edge248" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19053.6,-2011.37C19279.48,-2002.9 19755.24,-1980.94 19936.97,-1938.78"/>
<polygon fill="black" stroke="black" points="19938.06,-1942.12 19946.96,-1936.37 19936.42,-1935.32 19938.06,-1942.12"/>
</g>
<!-- layer0_expert6_14 -->
<g id="node160" class="node">
<title>layer0_expert6_14</title>
<polygon fill="lightgreen" stroke="black" points="20295,-1939 20130,-1939 20130,-1856 20295,-1856 20295,-1939"/>
<text text-anchor="middle" x="20212.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU6</text>
<text text-anchor="middle" x="20212.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="20212.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="20212.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="20212.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_14 -->
<g id="edge249" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19053.83,-2013.04C19311.32,-2006.99 19902.68,-1988.3 20120.21,-1938.73"/>
<polygon fill="black" stroke="black" points="20121.04,-1942.13 20129.97,-1936.42 20119.43,-1935.31 20121.04,-1942.13"/>
</g>
<!-- layer0_expert6_15 -->
<g id="node161" class="node">
<title>layer0_expert6_15</title>
<polygon fill="lightgreen" stroke="black" points="20478,-1939 20313,-1939 20313,-1856 20478,-1856 20478,-1939"/>
<text text-anchor="middle" x="20395.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU6</text>
<text text-anchor="middle" x="20395.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="20395.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="20395.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="20395.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gate_gpu6&#45;&gt;layer0_expert6_15 -->
<g id="edge250" class="edge">
<title>layer0_gate_gpu6&#45;&gt;layer0_expert6_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19053.56,-2014.27C19339.91,-2010.51 20049.07,-1995.8 20303.05,-1938.76"/>
<polygon fill="black" stroke="black" points="20304.03,-1942.13 20312.98,-1936.45 20302.45,-1935.31 20304.03,-1942.13"/>
</g>
<!-- layer0_moe_agg_gpu6 -->
<g id="node162" class="node">
<title>layer0_moe_agg_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="18941,-1793.5 18738,-1793.5 18738,-1710.5 18941,-1710.5 18941,-1793.5"/>
<text text-anchor="middle" x="18839.5" y="-1778.3" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU6</text>
<text text-anchor="middle" x="18839.5" y="-1763.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="18839.5" y="-1748.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="18839.5" y="-1733.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="18839.5" y="-1718.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_expert6_0&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge251" class="edge">
<title>layer0_expert6_0&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M17733.17,-1858.38C17735.96,-1857.52 17738.74,-1856.72 17741.5,-1856 17925.69,-1807.76 18486.45,-1772.31 18727.46,-1758.89"/>
<polygon fill="black" stroke="black" points="18727.85,-1762.37 18737.64,-1758.32 18727.47,-1755.38 18727.85,-1762.37"/>
</g>
<!-- layer0_expert6_1&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge252" class="edge">
<title>layer0_expert6_1&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M17916.18,-1858.45C17918.97,-1857.57 17921.75,-1856.75 17924.5,-1856 18206.76,-1779.27 18552.99,-1759.61 18727.53,-1754.63"/>
<polygon fill="black" stroke="black" points="18727.86,-1758.12 18737.76,-1754.35 18727.66,-1751.13 18727.86,-1758.12"/>
</g>
<!-- layer0_expert6_2&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge253" class="edge">
<title>layer0_expert6_2&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M18099.21,-1858.55C18101.99,-1857.64 18104.76,-1856.79 18107.5,-1856 18321.79,-1794.55 18582.3,-1769.07 18727.64,-1759.04"/>
<polygon fill="black" stroke="black" points="18728.16,-1762.51 18737.9,-1758.34 18727.69,-1755.53 18728.16,-1762.51"/>
</g>
<!-- layer0_expert6_3&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge254" class="edge">
<title>layer0_expert6_3&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M18282.01,-1858.8C18284.86,-1857.81 18287.69,-1856.87 18290.5,-1856 18438.45,-1809.89 18615.61,-1781.21 18727.87,-1766.17"/>
<polygon fill="black" stroke="black" points="18728.4,-1769.63 18737.85,-1764.85 18727.48,-1762.69 18728.4,-1769.63"/>
</g>
<!-- layer0_expert6_4&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge255" class="edge">
<title>layer0_expert6_4&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M18465.12,-1859.12C18467.94,-1858.04 18470.74,-1857 18473.5,-1856 18557.43,-1825.69 18654.77,-1798.67 18727.96,-1779.92"/>
<polygon fill="black" stroke="black" points="18728.85,-1783.31 18737.67,-1777.44 18727.12,-1776.52 18728.85,-1783.31"/>
</g>
<!-- layer0_expert6_5&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge256" class="edge">
<title>layer0_expert6_5&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M18642.92,-1855.95C18677.06,-1838.07 18717.33,-1816.99 18752.5,-1798.56"/>
<polygon fill="black" stroke="black" points="18754.56,-1801.43 18761.8,-1793.69 18751.32,-1795.23 18754.56,-1801.43"/>
</g>
<!-- layer0_expert6_6&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge257" class="edge">
<title>layer0_expert6_6&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M18774.33,-1855.76C18784.8,-1839.25 18797,-1820.03 18807.98,-1802.7"/>
<polygon fill="black" stroke="black" points="18811.2,-1804.16 18813.6,-1793.84 18805.29,-1800.41 18811.2,-1804.16"/>
</g>
<!-- layer0_expert6_7&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge258" class="edge">
<title>layer0_expert6_7&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M18905.38,-1855.76C18894.8,-1839.25 18882.47,-1820.03 18871.36,-1802.7"/>
<polygon fill="black" stroke="black" points="18874.03,-1800.37 18865.68,-1793.84 18868.13,-1804.15 18874.03,-1800.37"/>
</g>
<!-- layer0_expert6_8&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge259" class="edge">
<title>layer0_expert6_8&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19036.8,-1855.95C19002.39,-1838 18961.78,-1816.81 18926.37,-1798.33"/>
<polygon fill="black" stroke="black" points="18927.97,-1795.22 18917.49,-1793.69 18924.73,-1801.42 18927.97,-1795.22"/>
</g>
<!-- layer0_expert6_9&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge260" class="edge">
<title>layer0_expert6_9&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19214.97,-1859.52C19211.79,-1858.3 19208.62,-1857.12 19205.5,-1856 19121.51,-1825.86 19024.17,-1798.83 18950.99,-1780.03"/>
<polygon fill="black" stroke="black" points="18951.84,-1776.64 18941.29,-1777.55 18950.11,-1783.42 18951.84,-1776.64"/>
</g>
<!-- layer0_expert6_10&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge261" class="edge">
<title>layer0_expert6_10&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19397.84,-1859.07C19394.7,-1857.98 19391.58,-1856.95 19388.5,-1856 19240.46,-1810.19 19063.32,-1781.44 18951.09,-1766.3"/>
<polygon fill="black" stroke="black" points="18951.48,-1762.82 18941.11,-1764.96 18950.56,-1769.76 18951.48,-1762.82"/>
</g>
<!-- layer0_expert6_11&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge262" class="edge">
<title>layer0_expert6_11&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19580.89,-1858.89C19577.74,-1857.85 19574.61,-1856.88 19571.5,-1856 19357.09,-1794.98 19096.62,-1769.35 18951.33,-1759.17"/>
<polygon fill="black" stroke="black" points="18951.28,-1755.66 18941.06,-1758.47 18950.8,-1762.64 18951.28,-1755.66"/>
</g>
<!-- layer0_expert6_12&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge263" class="edge">
<title>layer0_expert6_12&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19763.92,-1858.77C19760.76,-1857.77 19757.62,-1856.84 19754.5,-1856 19472.08,-1779.84 19125.92,-1759.93 18951.43,-1754.77"/>
<polygon fill="black" stroke="black" points="18951.3,-1751.27 18941.21,-1754.48 18951.1,-1758.26 18951.3,-1751.27"/>
</g>
<!-- layer0_expert6_13&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge264" class="edge">
<title>layer0_expert6_13&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M19946.94,-1858.7C19943.78,-1857.72 19940.62,-1856.81 19937.5,-1856 19753.21,-1808.14 19192.51,-1772.47 18951.53,-1758.94"/>
<polygon fill="black" stroke="black" points="18951.52,-1755.44 18941.34,-1758.37 18951.13,-1762.43 18951.52,-1755.44"/>
</g>
<!-- layer0_expert6_14&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge265" class="edge">
<title>layer0_expert6_14&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20129.95,-1858.65C20126.79,-1857.68 20123.63,-1856.79 20120.5,-1856 19900.39,-1800.39 19220.7,-1768.1 18951.22,-1757.2"/>
<polygon fill="black" stroke="black" points="18951.17,-1753.7 18941.03,-1756.79 18950.89,-1760.69 18951.17,-1753.7"/>
</g>
<!-- layer0_expert6_15&#45;&gt;layer0_moe_agg_gpu6 -->
<g id="edge266" class="edge">
<title>layer0_expert6_15&#45;&gt;layer0_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M20312.96,-1858.61C20309.8,-1857.65 20306.63,-1856.78 20303.5,-1856 20047.45,-1792.67 19247.96,-1764.41 18951.54,-1755.91"/>
<polygon fill="black" stroke="black" points="18951.31,-1752.4 18941.21,-1755.62 18951.11,-1759.4 18951.31,-1752.4"/>
</g>
<!-- layer0_output_gpu6 -->
<g id="node163" class="node">
<title>layer0_output_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="15387.5,-1442 15143.5,-1442 15143.5,-1374 15387.5,-1374 15387.5,-1442"/>
<text text-anchor="middle" x="15265.5" y="-1426.8" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU6</text>
<text text-anchor="middle" x="15265.5" y="-1411.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="15265.5" y="-1396.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="15265.5" y="-1381.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_moe_agg_gpu6&#45;&gt;layer0_output_gpu6 -->
<g id="edge267" class="edge">
<title>layer0_moe_agg_gpu6&#45;&gt;layer0_output_gpu6</title>
<path fill="none" stroke="black" d="M18737.82,-1741.27C18230.06,-1692.68 15970.77,-1476.49 15397.9,-1421.67"/>
<polygon fill="black" stroke="black" points="15397.82,-1418.15 15387.53,-1420.68 15397.15,-1425.11 15397.82,-1418.15"/>
</g>
<!-- layer0_moe_agg_gpu6&#45;&gt;layer0_allreduce_moe -->
<g id="edge331" class="edge">
<title>layer0_moe_agg_gpu6&#45;&gt;layer0_allreduce_moe</title>
<path fill="none" stroke="black" d="M18737.93,-1748.49C17978.66,-1729.73 13190.92,-1611.41 12157.12,-1585.86"/>
<polygon fill="black" stroke="black" points="12157.07,-1582.36 12146.99,-1585.61 12156.9,-1589.35 12157.07,-1582.36"/>
</g>
<!-- layer0_attn_gpu7 -->
<g id="node165" class="node">
<title>layer0_attn_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="12739,-2640 12496,-2640 12496,-2557 12739,-2557 12739,-2640"/>
<text text-anchor="middle" x="12617.5" y="-2624.8" font-family="Times,serif" font-size="14.00">L0_Multi&#45;Head_Attention_GPU7</text>
<text text-anchor="middle" x="12617.5" y="-2609.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="12617.5" y="-2594.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12617.5" y="-2579.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="12617.5" y="-2564.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_qkv_gpu7&#45;&gt;layer0_attn_gpu7 -->
<g id="edge268" class="edge">
<title>layer0_qkv_gpu7&#45;&gt;layer0_attn_gpu7</title>
<path fill="none" stroke="black" d="M12602.78,-2675.87C12604.41,-2667.41 12606.11,-2658.58 12607.75,-2650.06"/>
<polygon fill="black" stroke="black" points="12611.19,-2650.71 12609.65,-2640.23 12604.32,-2649.39 12611.19,-2650.71"/>
</g>
<!-- layer0_attn_proj_gpu7 -->
<g id="node166" class="node">
<title>layer0_attn_proj_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="12717.5,-2487 12517.5,-2487 12517.5,-2419 12717.5,-2419 12717.5,-2487"/>
<text text-anchor="middle" x="12617.5" y="-2471.8" font-family="Times,serif" font-size="14.00">L0_Attn_Projection_GPU7</text>
<text text-anchor="middle" x="12617.5" y="-2456.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="12617.5" y="-2441.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12617.5" y="-2426.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_attn_gpu7&#45;&gt;layer0_attn_proj_gpu7 -->
<g id="edge269" class="edge">
<title>layer0_attn_gpu7&#45;&gt;layer0_attn_proj_gpu7</title>
<path fill="none" stroke="black" d="M12617.5,-2556.76C12617.5,-2538.17 12617.5,-2516.13 12617.5,-2497.24"/>
<polygon fill="black" stroke="black" points="12621,-2497.11 12617.5,-2487.11 12614,-2497.11 12621,-2497.11"/>
</g>
<!-- layer0_attn_norm_gpu7 -->
<g id="node167" class="node">
<title>layer0_attn_norm_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="12742.5,-2169.5 12498.5,-2169.5 12498.5,-2101.5 12742.5,-2101.5 12742.5,-2169.5"/>
<text text-anchor="middle" x="12620.5" y="-2154.3" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU7</text>
<text text-anchor="middle" x="12620.5" y="-2139.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="12620.5" y="-2124.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="12620.5" y="-2109.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_attn_proj_gpu7&#45;&gt;layer0_attn_norm_gpu7 -->
<g id="edge270" class="edge">
<title>layer0_attn_proj_gpu7&#45;&gt;layer0_attn_norm_gpu7</title>
<path fill="none" stroke="black" d="M12617.82,-2418.83C12618.36,-2361.43 12619.48,-2243.62 12620.09,-2179.83"/>
<polygon fill="black" stroke="black" points="12623.59,-2179.73 12620.18,-2169.7 12616.59,-2179.66 12623.59,-2179.73"/>
</g>
<!-- layer0_attn_proj_gpu7&#45;&gt;layer0_allreduce_attn -->
<g id="edge333" class="edge">
<title>layer0_attn_proj_gpu7&#45;&gt;layer0_allreduce_attn</title>
<path fill="none" stroke="black" d="M12553.15,-2418.84C12526.63,-2406.45 12495.2,-2393.37 12465.5,-2385 12271.47,-2330.32 12041.25,-2304.32 11884.81,-2292.18"/>
<polygon fill="black" stroke="black" points="11884.86,-2288.68 11874.62,-2291.4 11884.32,-2295.66 11884.86,-2288.68"/>
</g>
<!-- layer0_gate_gpu7 -->
<g id="node168" class="node">
<title>layer0_gate_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="21981.5,-2058 21737.5,-2058 21737.5,-1975 21981.5,-1975 21981.5,-2058"/>
<text text-anchor="middle" x="21859.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L0_Gate_GPU7</text>
<text text-anchor="middle" x="21859.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="21859.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="21859.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="21859.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_attn_norm_gpu7&#45;&gt;layer0_gate_gpu7 -->
<g id="edge271" class="edge">
<title>layer0_attn_norm_gpu7&#45;&gt;layer0_gate_gpu7</title>
<path fill="none" stroke="black" d="M12742.52,-2133.17C13392.26,-2126.06 16511.53,-2091.62 19062.5,-2058 20088.29,-2044.48 21325.65,-2025.7 21726.97,-2019.54"/>
<polygon fill="black" stroke="black" points="21727.21,-2023.04 21737.16,-2019.39 21727.11,-2016.04 21727.21,-2023.04"/>
</g>
<!-- layer0_expert7_0 -->
<g id="node169" class="node">
<title>layer0_expert7_0</title>
<polygon fill="lightgreen" stroke="black" points="20661,-1939 20496,-1939 20496,-1856 20661,-1856 20661,-1939"/>
<text text-anchor="middle" x="20578.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert0_GPU7</text>
<text text-anchor="middle" x="20578.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="20578.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="20578.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="20578.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_0 -->
<g id="edge272" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21737.05,-2013.1C21479.44,-2007.18 20888,-1988.75 20671.18,-1939.11"/>
<polygon fill="black" stroke="black" points="20671.68,-1935.63 20661.14,-1936.73 20670.06,-1942.44 20671.68,-1935.63"/>
</g>
<!-- layer0_expert7_1 -->
<g id="node170" class="node">
<title>layer0_expert7_1</title>
<polygon fill="lightgreen" stroke="black" points="20844,-1939 20679,-1939 20679,-1856 20844,-1856 20844,-1939"/>
<text text-anchor="middle" x="20761.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert1_GPU7</text>
<text text-anchor="middle" x="20761.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="20761.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="20761.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="20761.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_1 -->
<g id="edge273" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21737.26,-2011.44C21511.14,-2003.08 21034.86,-1981.29 20854.08,-1939.1"/>
<polygon fill="black" stroke="black" points="20854.69,-1935.65 20844.15,-1936.68 20853.04,-1942.45 20854.69,-1935.65"/>
</g>
<!-- layer0_expert7_2 -->
<g id="node171" class="node">
<title>layer0_expert7_2</title>
<polygon fill="lightgreen" stroke="black" points="21027,-1939 20862,-1939 20862,-1856 21027,-1856 21027,-1939"/>
<text text-anchor="middle" x="20944.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert2_GPU7</text>
<text text-anchor="middle" x="20944.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="20944.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="20944.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="20944.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_2 -->
<g id="edge274" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21737.36,-2009.05C21545.78,-1998.12 21182.32,-1973.96 21037.23,-1939.15"/>
<polygon fill="black" stroke="black" points="21037.72,-1935.66 21027.17,-1936.62 21036.01,-1942.45 21037.72,-1935.66"/>
</g>
<!-- layer0_expert7_3 -->
<g id="node172" class="node">
<title>layer0_expert7_3</title>
<polygon fill="lightgreen" stroke="black" points="21210,-1939 21045,-1939 21045,-1856 21210,-1856 21210,-1939"/>
<text text-anchor="middle" x="21127.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert3_GPU7</text>
<text text-anchor="middle" x="21127.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="21127.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="21127.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="21127.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_3 -->
<g id="edge275" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21737.21,-2011.77C21608.95,-2005.4 21402.18,-1988.17 21219.95,-1939.19"/>
<polygon fill="black" stroke="black" points="21220.76,-1935.78 21210.19,-1936.53 21218.92,-1942.53 21220.76,-1935.78"/>
</g>
<!-- layer0_expert7_4 -->
<g id="node173" class="node">
<title>layer0_expert7_4</title>
<polygon fill="lightgreen" stroke="black" points="21393,-1939 21228,-1939 21228,-1856 21393,-1856 21393,-1939"/>
<text text-anchor="middle" x="21310.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert4_GPU7</text>
<text text-anchor="middle" x="21310.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="21310.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="21310.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="21310.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_4 -->
<g id="edge276" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21737.05,-2003.58C21646.24,-1992.76 21519.81,-1973.52 21403.06,-1939.28"/>
<polygon fill="black" stroke="black" points="21403.82,-1935.86 21393.24,-1936.36 21401.83,-1942.57 21403.82,-1935.86"/>
</g>
<!-- layer0_expert7_5 -->
<g id="node174" class="node">
<title>layer0_expert7_5</title>
<polygon fill="lightgreen" stroke="black" points="21576,-1939 21411,-1939 21411,-1856 21576,-1856 21576,-1939"/>
<text text-anchor="middle" x="21493.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert5_GPU7</text>
<text text-anchor="middle" x="21493.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="21493.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="21493.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="21493.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_5 -->
<g id="edge277" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21737.47,-1985.69C21691.95,-1973.56 21639.87,-1958.48 21585.56,-1939.26"/>
<polygon fill="black" stroke="black" points="21586.71,-1935.96 21576.12,-1935.89 21584.35,-1942.55 21586.71,-1935.96"/>
</g>
<!-- layer0_expert7_6 -->
<g id="node175" class="node">
<title>layer0_expert7_6</title>
<polygon fill="lightgreen" stroke="black" points="21759,-1939 21594,-1939 21594,-1856 21759,-1856 21759,-1939"/>
<text text-anchor="middle" x="21676.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert6_GPU7</text>
<text text-anchor="middle" x="21676.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="21676.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="21676.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="21676.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_6 -->
<g id="edge278" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21796.01,-1974.91C21780.68,-1965.11 21764.19,-1954.56 21748.5,-1944.53"/>
<polygon fill="black" stroke="black" points="21750.19,-1941.46 21739.88,-1939.02 21746.42,-1947.36 21750.19,-1941.46"/>
</g>
<!-- layer0_expert7_7 -->
<g id="node176" class="node">
<title>layer0_expert7_7</title>
<polygon fill="lightgreen" stroke="black" points="21942,-1939 21777,-1939 21777,-1856 21942,-1856 21942,-1939"/>
<text text-anchor="middle" x="21859.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert7_GPU7</text>
<text text-anchor="middle" x="21859.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="21859.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="21859.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="21859.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_7 -->
<g id="edge279" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21859.5,-1974.91C21859.5,-1966.65 21859.5,-1957.86 21859.5,-1949.3"/>
<polygon fill="black" stroke="black" points="21863,-1949.02 21859.5,-1939.02 21856,-1949.02 21863,-1949.02"/>
</g>
<!-- layer0_expert7_8 -->
<g id="node177" class="node">
<title>layer0_expert7_8</title>
<polygon fill="lightgreen" stroke="black" points="22125,-1939 21960,-1939 21960,-1856 22125,-1856 22125,-1939"/>
<text text-anchor="middle" x="22042.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert8_GPU7</text>
<text text-anchor="middle" x="22042.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="22042.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="22042.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="22042.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_8 -->
<g id="edge280" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21922.99,-1974.91C21938.32,-1965.11 21954.81,-1954.56 21970.5,-1944.53"/>
<polygon fill="black" stroke="black" points="21972.58,-1947.36 21979.12,-1939.02 21968.81,-1941.46 21972.58,-1947.36"/>
</g>
<!-- layer0_expert7_9 -->
<g id="node178" class="node">
<title>layer0_expert7_9</title>
<polygon fill="lightgreen" stroke="black" points="22308,-1939 22143,-1939 22143,-1856 22308,-1856 22308,-1939"/>
<text text-anchor="middle" x="22225.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert9_GPU7</text>
<text text-anchor="middle" x="22225.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="22225.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="22225.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="22225.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_9 -->
<g id="edge281" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21981.82,-1977.46C21984.74,-1976.62 21987.63,-1975.8 21990.5,-1975 22050.65,-1958.14 22069.73,-1960.05 22133.08,-1938.97"/>
<polygon fill="black" stroke="black" points="22134.41,-1942.22 22142.76,-1935.69 22132.16,-1935.59 22134.41,-1942.22"/>
</g>
<!-- layer0_expert7_10 -->
<g id="node179" class="node">
<title>layer0_expert7_10</title>
<polygon fill="lightgreen" stroke="black" points="22491,-1939 22326,-1939 22326,-1856 22491,-1856 22491,-1939"/>
<text text-anchor="middle" x="22408.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert10_GPU7</text>
<text text-anchor="middle" x="22408.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="22408.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="22408.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="22408.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_10 -->
<g id="edge282" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21981.69,-1976.92C21984.65,-1976.25 21987.59,-1975.61 21990.5,-1975 22130.01,-1946 22173.76,-1975.42 22315.96,-1938.86"/>
<polygon fill="black" stroke="black" points="22317.15,-1942.17 22325.92,-1936.23 22315.36,-1935.4 22317.15,-1942.17"/>
</g>
<!-- layer0_expert7_11 -->
<g id="node180" class="node">
<title>layer0_expert7_11</title>
<polygon fill="lightgreen" stroke="black" points="22674,-1939 22509,-1939 22509,-1856 22674,-1856 22674,-1939"/>
<text text-anchor="middle" x="22591.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert11_GPU7</text>
<text text-anchor="middle" x="22591.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="22591.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="22591.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="22591.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_11 -->
<g id="edge283" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21981.66,-1976.77C21984.62,-1976.14 21987.58,-1975.55 21990.5,-1975 22210.14,-1933.85 22277.39,-1991.75 22498.98,-1938.83"/>
<polygon fill="black" stroke="black" points="22500.08,-1942.16 22508.96,-1936.39 22498.42,-1935.36 22500.08,-1942.16"/>
</g>
<!-- layer0_expert7_12 -->
<g id="node181" class="node">
<title>layer0_expert7_12</title>
<polygon fill="lightgreen" stroke="black" points="22857,-1939 22692,-1939 22692,-1856 22857,-1856 22857,-1939"/>
<text text-anchor="middle" x="22774.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert12_GPU7</text>
<text text-anchor="middle" x="22774.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="22774.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="22774.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="22774.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_12 -->
<g id="edge284" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21981.64,-1976.69C21984.61,-1976.09 21987.57,-1975.52 21990.5,-1975 22290.46,-1921.68 22380.93,-2008.31 22682.1,-1938.79"/>
<polygon fill="black" stroke="black" points="22683.05,-1942.16 22691.98,-1936.47 22681.45,-1935.35 22683.05,-1942.16"/>
</g>
<!-- layer0_expert7_13 -->
<g id="node182" class="node">
<title>layer0_expert7_13</title>
<polygon fill="lightgreen" stroke="black" points="23040,-1939 22875,-1939 22875,-1856 23040,-1856 23040,-1939"/>
<text text-anchor="middle" x="22957.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert13_GPU7</text>
<text text-anchor="middle" x="22957.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="22957.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="22957.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="22957.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_13 -->
<g id="edge285" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21981.63,-1976.65C21984.61,-1976.06 21987.57,-1975.5 21990.5,-1975 22370.8,-1909.53 22484.41,-2024.94 22865.09,-1938.79"/>
<polygon fill="black" stroke="black" points="22866.03,-1942.16 22874.99,-1936.51 22864.46,-1935.34 22866.03,-1942.16"/>
</g>
<!-- layer0_expert7_14 -->
<g id="node183" class="node">
<title>layer0_expert7_14</title>
<polygon fill="lightgreen" stroke="black" points="23223,-1939 23058,-1939 23058,-1856 23223,-1856 23223,-1939"/>
<text text-anchor="middle" x="23140.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert14_GPU7</text>
<text text-anchor="middle" x="23140.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="23140.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="23140.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="23140.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_14 -->
<g id="edge286" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21981.63,-1976.62C21984.61,-1976.04 21987.57,-1975.49 21990.5,-1975 22219.31,-1936.45 22802.9,-1989.84 23048,-1938.73"/>
<polygon fill="black" stroke="black" points="23048.98,-1942.1 23058,-1936.54 23047.48,-1935.26 23048.98,-1942.1"/>
</g>
<!-- layer0_expert7_15 -->
<g id="node184" class="node">
<title>layer0_expert7_15</title>
<polygon fill="lightgreen" stroke="black" points="23406,-1939 23241,-1939 23241,-1856 23406,-1856 23406,-1939"/>
<text text-anchor="middle" x="23323.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L0_Expert15_GPU7</text>
<text text-anchor="middle" x="23323.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="23323.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="23323.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="23323.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gate_gpu7&#45;&gt;layer0_expert7_15 -->
<g id="edge287" class="edge">
<title>layer0_gate_gpu7&#45;&gt;layer0_expert7_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21981.63,-1976.6C21984.6,-1976.02 21987.56,-1975.49 21990.5,-1975 22259.48,-1930.37 22946.03,-1998.08 23230.79,-1938.8"/>
<polygon fill="black" stroke="black" points="23231.72,-1942.18 23240.75,-1936.64 23230.23,-1935.34 23231.72,-1942.18"/>
</g>
<!-- layer0_moe_agg_gpu7 -->
<g id="node185" class="node">
<title>layer0_moe_agg_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="21869,-1793.5 21666,-1793.5 21666,-1710.5 21869,-1710.5 21869,-1793.5"/>
<text text-anchor="middle" x="21767.5" y="-1778.3" font-family="Times,serif" font-size="14.00">L0_MoE_Aggregate_GPU7</text>
<text text-anchor="middle" x="21767.5" y="-1763.3" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="21767.5" y="-1748.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="21767.5" y="-1733.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="21767.5" y="-1718.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_expert7_0&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge288" class="edge">
<title>layer0_expert7_0&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M20661.17,-1858.38C20663.96,-1857.52 20666.74,-1856.72 20669.5,-1856 20853.69,-1807.76 21414.45,-1772.31 21655.46,-1758.89"/>
<polygon fill="black" stroke="black" points="21655.85,-1762.37 21665.64,-1758.32 21655.47,-1755.38 21655.85,-1762.37"/>
</g>
<!-- layer0_expert7_1&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge289" class="edge">
<title>layer0_expert7_1&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M20844.18,-1858.45C20846.97,-1857.57 20849.75,-1856.75 20852.5,-1856 21134.76,-1779.27 21480.99,-1759.61 21655.53,-1754.63"/>
<polygon fill="black" stroke="black" points="21655.86,-1758.12 21665.76,-1754.35 21655.66,-1751.13 21655.86,-1758.12"/>
</g>
<!-- layer0_expert7_2&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge290" class="edge">
<title>layer0_expert7_2&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M21027.21,-1858.55C21029.99,-1857.64 21032.76,-1856.79 21035.5,-1856 21249.79,-1794.55 21510.3,-1769.07 21655.64,-1759.04"/>
<polygon fill="black" stroke="black" points="21656.16,-1762.51 21665.9,-1758.34 21655.69,-1755.53 21656.16,-1762.51"/>
</g>
<!-- layer0_expert7_3&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge291" class="edge">
<title>layer0_expert7_3&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M21210.01,-1858.8C21212.86,-1857.81 21215.69,-1856.87 21218.5,-1856 21366.45,-1809.89 21543.61,-1781.21 21655.87,-1766.17"/>
<polygon fill="black" stroke="black" points="21656.4,-1769.63 21665.85,-1764.85 21655.48,-1762.69 21656.4,-1769.63"/>
</g>
<!-- layer0_expert7_4&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge292" class="edge">
<title>layer0_expert7_4&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M21393.12,-1859.12C21395.94,-1858.04 21398.74,-1857 21401.5,-1856 21485.43,-1825.69 21582.77,-1798.67 21655.96,-1779.92"/>
<polygon fill="black" stroke="black" points="21656.85,-1783.31 21665.67,-1777.44 21655.12,-1776.52 21656.85,-1783.31"/>
</g>
<!-- layer0_expert7_5&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge293" class="edge">
<title>layer0_expert7_5&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M21570.92,-1855.95C21605.06,-1838.07 21645.33,-1816.99 21680.5,-1798.56"/>
<polygon fill="black" stroke="black" points="21682.56,-1801.43 21689.8,-1793.69 21679.32,-1795.23 21682.56,-1801.43"/>
</g>
<!-- layer0_expert7_6&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge294" class="edge">
<title>layer0_expert7_6&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M21702.33,-1855.76C21712.8,-1839.25 21725,-1820.03 21735.98,-1802.7"/>
<polygon fill="black" stroke="black" points="21739.2,-1804.16 21741.6,-1793.84 21733.29,-1800.41 21739.2,-1804.16"/>
</g>
<!-- layer0_expert7_7&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge295" class="edge">
<title>layer0_expert7_7&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M21833.38,-1855.76C21822.8,-1839.25 21810.47,-1820.03 21799.36,-1802.7"/>
<polygon fill="black" stroke="black" points="21802.03,-1800.37 21793.68,-1793.84 21796.13,-1804.15 21802.03,-1800.37"/>
</g>
<!-- layer0_expert7_8&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge296" class="edge">
<title>layer0_expert7_8&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M21964.8,-1855.95C21930.39,-1838 21889.78,-1816.81 21854.37,-1798.33"/>
<polygon fill="black" stroke="black" points="21855.97,-1795.22 21845.49,-1793.69 21852.73,-1801.42 21855.97,-1795.22"/>
</g>
<!-- layer0_expert7_9&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge297" class="edge">
<title>layer0_expert7_9&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22142.97,-1859.52C22139.79,-1858.3 22136.62,-1857.12 22133.5,-1856 22049.51,-1825.86 21952.17,-1798.83 21878.99,-1780.03"/>
<polygon fill="black" stroke="black" points="21879.84,-1776.64 21869.29,-1777.55 21878.11,-1783.42 21879.84,-1776.64"/>
</g>
<!-- layer0_expert7_10&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge298" class="edge">
<title>layer0_expert7_10&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22325.84,-1859.07C22322.7,-1857.98 22319.58,-1856.95 22316.5,-1856 22168.46,-1810.19 21991.32,-1781.44 21879.09,-1766.3"/>
<polygon fill="black" stroke="black" points="21879.48,-1762.82 21869.11,-1764.96 21878.56,-1769.76 21879.48,-1762.82"/>
</g>
<!-- layer0_expert7_11&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge299" class="edge">
<title>layer0_expert7_11&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22508.89,-1858.89C22505.74,-1857.85 22502.61,-1856.88 22499.5,-1856 22285.09,-1794.98 22024.62,-1769.35 21879.33,-1759.17"/>
<polygon fill="black" stroke="black" points="21879.28,-1755.66 21869.06,-1758.47 21878.8,-1762.64 21879.28,-1755.66"/>
</g>
<!-- layer0_expert7_12&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge300" class="edge">
<title>layer0_expert7_12&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22691.92,-1858.77C22688.76,-1857.77 22685.62,-1856.84 22682.5,-1856 22400.08,-1779.84 22053.92,-1759.93 21879.43,-1754.77"/>
<polygon fill="black" stroke="black" points="21879.3,-1751.27 21869.21,-1754.48 21879.1,-1758.26 21879.3,-1751.27"/>
</g>
<!-- layer0_expert7_13&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge301" class="edge">
<title>layer0_expert7_13&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M22874.94,-1858.7C22871.78,-1857.72 22868.62,-1856.81 22865.5,-1856 22681.21,-1808.14 22120.51,-1772.47 21879.53,-1758.94"/>
<polygon fill="black" stroke="black" points="21879.52,-1755.44 21869.34,-1758.37 21879.13,-1762.43 21879.52,-1755.44"/>
</g>
<!-- layer0_expert7_14&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge302" class="edge">
<title>layer0_expert7_14&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23057.95,-1858.65C23054.79,-1857.68 23051.63,-1856.79 23048.5,-1856 22828.39,-1800.39 22148.7,-1768.1 21879.22,-1757.2"/>
<polygon fill="black" stroke="black" points="21879.17,-1753.7 21869.03,-1756.79 21878.89,-1760.69 21879.17,-1753.7"/>
</g>
<!-- layer0_expert7_15&#45;&gt;layer0_moe_agg_gpu7 -->
<g id="edge303" class="edge">
<title>layer0_expert7_15&#45;&gt;layer0_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M23240.96,-1858.61C23237.8,-1857.65 23234.63,-1856.78 23231.5,-1856 22975.45,-1792.67 22175.96,-1764.41 21879.54,-1755.91"/>
<polygon fill="black" stroke="black" points="21879.31,-1752.4 21869.21,-1755.62 21879.11,-1759.4 21879.31,-1752.4"/>
</g>
<!-- layer0_output_gpu7 -->
<g id="node186" class="node">
<title>layer0_output_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="17616.5,-1442 17372.5,-1442 17372.5,-1374 17616.5,-1374 17616.5,-1442"/>
<text text-anchor="middle" x="17494.5" y="-1426.8" font-family="Times,serif" font-size="14.00">L0_Residual+LayerNorm_GPU7</text>
<text text-anchor="middle" x="17494.5" y="-1411.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="17494.5" y="-1396.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="17494.5" y="-1381.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_moe_agg_gpu7&#45;&gt;layer0_output_gpu7 -->
<g id="edge304" class="edge">
<title>layer0_moe_agg_gpu7&#45;&gt;layer0_output_gpu7</title>
<path fill="none" stroke="black" d="M21665.83,-1742.86C21093.27,-1697.04 18273.92,-1471.38 17626.97,-1419.6"/>
<polygon fill="black" stroke="black" points="17626.93,-1416.09 17616.68,-1418.78 17626.37,-1423.07 17626.93,-1416.09"/>
</g>
<!-- layer0_moe_agg_gpu7&#45;&gt;layer0_allreduce_moe -->
<g id="edge335" class="edge">
<title>layer0_moe_agg_gpu7&#45;&gt;layer0_allreduce_moe</title>
<path fill="none" stroke="black" d="M21665.78,-1748.25C21299.28,-1738.41 20011.86,-1704.46 18949.5,-1684 16265.75,-1632.32 13001.86,-1593.05 12164.07,-1583.33"/>
<polygon fill="black" stroke="black" points="12164.06,-1579.83 12154.02,-1583.21 12163.98,-1586.83 12164.06,-1579.83"/>
</g>
<!-- layer0_allreduce_attn&#45;&gt;layer0_attn_norm_gpu0 -->
<g id="edge306" class="edge">
<title>layer0_allreduce_attn&#45;&gt;layer0_attn_norm_gpu0</title>
<path fill="none" stroke="black" d="M11541.38,-2266.9C11381.73,-2252.05 11130.84,-2223.62 10917.5,-2177 10910.86,-2175.55 10904.07,-2173.92 10897.25,-2172.16"/>
<polygon fill="black" stroke="black" points="10897.81,-2168.69 10887.24,-2169.51 10896.01,-2175.46 10897.81,-2168.69"/>
</g>
<!-- layer0_allreduce_attn&#45;&gt;layer0_attn_norm_gpu1 -->
<g id="edge310" class="edge">
<title>layer0_allreduce_attn&#45;&gt;layer0_attn_norm_gpu1</title>
<path fill="none" stroke="black" d="M11568.91,-2257.7C11462.71,-2239.01 11310.73,-2210.11 11179.5,-2177 11173.73,-2175.55 11167.84,-2173.99 11161.91,-2172.36"/>
<polygon fill="black" stroke="black" points="11162.47,-2168.89 11151.9,-2169.57 11160.59,-2175.63 11162.47,-2168.89"/>
</g>
<!-- layer0_allreduce_attn&#45;&gt;layer0_attn_norm_gpu2 -->
<g id="edge314" class="edge">
<title>layer0_allreduce_attn&#45;&gt;layer0_attn_norm_gpu2</title>
<path fill="none" stroke="black" d="M11606.86,-2244.99C11547.26,-2223.17 11470.72,-2195.15 11410.35,-2173.05"/>
<polygon fill="black" stroke="black" points="11411.4,-2169.71 11400.81,-2169.56 11409,-2176.28 11411.4,-2169.71"/>
</g>
<!-- layer0_allreduce_attn&#45;&gt;layer0_attn_norm_gpu3 -->
<g id="edge318" class="edge">
<title>layer0_allreduce_attn&#45;&gt;layer0_attn_norm_gpu3</title>
<path fill="none" stroke="black" d="M11655.57,-2228.19C11640.44,-2211.5 11623.9,-2193.24 11609.59,-2177.44"/>
<polygon fill="black" stroke="black" points="11612.06,-2174.96 11602.75,-2169.9 11606.87,-2179.66 11612.06,-2174.96"/>
</g>
<!-- layer0_allreduce_attn&#45;&gt;layer0_attn_norm_gpu4 -->
<g id="edge322" class="edge">
<title>layer0_allreduce_attn&#45;&gt;layer0_attn_norm_gpu4</title>
<path fill="none" stroke="black" d="M11749.78,-2228.6C11765.29,-2211.74 11782.31,-2193.24 11797,-2177.27"/>
<polygon fill="black" stroke="black" points="11799.81,-2179.38 11804,-2169.66 11794.66,-2174.65 11799.81,-2179.38"/>
</g>
<!-- layer0_allreduce_attn&#45;&gt;layer0_attn_norm_gpu5 -->
<g id="edge326" class="edge">
<title>layer0_allreduce_attn&#45;&gt;layer0_attn_norm_gpu5</title>
<path fill="none" stroke="black" d="M11798.38,-2245.08C11858.27,-2223.27 11935.27,-2195.22 11996.01,-2173.1"/>
<polygon fill="black" stroke="black" points="11997.42,-2176.31 12005.62,-2169.6 11995.02,-2169.73 11997.42,-2176.31"/>
</g>
<!-- layer0_allreduce_attn&#45;&gt;layer0_attn_norm_gpu6 -->
<g id="edge330" class="edge">
<title>layer0_allreduce_attn&#45;&gt;layer0_attn_norm_gpu6</title>
<path fill="none" stroke="black" d="M11836.34,-2257.78C11942.95,-2239.12 12095.66,-2210.21 12227.5,-2177 12233.27,-2175.55 12239.16,-2173.99 12245.09,-2172.37"/>
<polygon fill="black" stroke="black" points="12246.41,-2175.63 12255.1,-2169.58 12244.53,-2168.89 12246.41,-2175.63"/>
</g>
<!-- layer0_allreduce_attn&#45;&gt;layer0_attn_norm_gpu7 -->
<g id="edge334" class="edge">
<title>layer0_allreduce_attn&#45;&gt;layer0_attn_norm_gpu7</title>
<path fill="none" stroke="black" d="M11863.65,-2266.98C12023.7,-2252.15 12275.45,-2223.74 12489.5,-2177 12496.14,-2175.55 12502.93,-2173.92 12509.75,-2172.17"/>
<polygon fill="black" stroke="black" points="12510.99,-2175.46 12519.76,-2169.52 12509.19,-2168.69 12510.99,-2175.46"/>
</g>
<!-- layer0_allreduce_moe&#45;&gt;layer0_output_gpu0 -->
<g id="edge308" class="edge">
<title>layer0_allreduce_moe&#45;&gt;layer0_output_gpu0</title>
<path fill="none" stroke="black" d="M11775.78,-1573.84C10856.94,-1548.19 6791.73,-1434.69 6003.96,-1412.7"/>
<polygon fill="black" stroke="black" points="6003.82,-1409.19 5993.72,-1412.41 6003.62,-1416.19 6003.82,-1409.19"/>
</g>
<!-- layer0_allreduce_moe&#45;&gt;layer0_output_gpu1 -->
<g id="edge312" class="edge">
<title>layer0_allreduce_moe&#45;&gt;layer0_output_gpu1</title>
<path fill="none" stroke="black" d="M11787.91,-1569.71C11223.04,-1539.3 9437.04,-1443.16 8934.96,-1416.13"/>
<polygon fill="black" stroke="black" points="8934.95,-1412.62 8924.78,-1415.58 8934.57,-1419.61 8934.95,-1412.62"/>
</g>
<!-- layer0_allreduce_moe&#45;&gt;layer0_output_gpu2 -->
<g id="edge316" class="edge">
<title>layer0_allreduce_moe&#45;&gt;layer0_output_gpu2</title>
<path fill="none" stroke="black" d="M11809.41,-1562.55C11504.48,-1529.34 10820.04,-1454.8 10531.63,-1423.39"/>
<polygon fill="black" stroke="black" points="10531.86,-1419.89 10521.54,-1422.29 10531.1,-1426.85 10531.86,-1419.89"/>
</g>
<!-- layer0_allreduce_moe&#45;&gt;layer0_output_gpu3 -->
<g id="edge320" class="edge">
<title>layer0_allreduce_moe&#45;&gt;layer0_output_gpu3</title>
<path fill="none" stroke="black" d="M11849.33,-1549.1C11740.83,-1519.91 11575.73,-1475.5 11460.59,-1444.53"/>
<polygon fill="black" stroke="black" points="11461.22,-1441.08 11450.66,-1441.86 11459.4,-1447.84 11461.22,-1441.08"/>
</g>
<!-- layer0_allreduce_moe&#45;&gt;layer0_output_gpu4 -->
<g id="edge324" class="edge">
<title>layer0_allreduce_moe&#45;&gt;layer0_output_gpu4</title>
<path fill="none" stroke="black" d="M12034.79,-1536.76C12083.05,-1509.32 12145.45,-1473.85 12192.24,-1447.24"/>
<polygon fill="black" stroke="black" points="12194.12,-1450.2 12201.08,-1442.21 12190.66,-1444.11 12194.12,-1450.2"/>
</g>
<!-- layer0_allreduce_moe&#45;&gt;layer0_output_gpu5 -->
<g id="edge328" class="edge">
<title>layer0_allreduce_moe&#45;&gt;layer0_output_gpu5</title>
<path fill="none" stroke="black" d="M12110.41,-1562.08C12404.92,-1528.83 13054.66,-1455.49 13334.28,-1423.92"/>
<polygon fill="black" stroke="black" points="13334.93,-1427.37 13344.48,-1422.77 13334.15,-1420.42 13334.93,-1427.37"/>
</g>
<!-- layer0_allreduce_moe&#45;&gt;layer0_output_gpu6 -->
<g id="edge332" class="edge">
<title>layer0_allreduce_moe&#45;&gt;layer0_output_gpu6</title>
<path fill="none" stroke="black" d="M12134.12,-1570.07C12719.65,-1539.95 14614.1,-1442.51 15133.02,-1415.81"/>
<polygon fill="black" stroke="black" points="15133.36,-1419.3 15143.16,-1415.29 15133,-1412.31 15133.36,-1419.3"/>
</g>
<!-- layer0_allreduce_moe&#45;&gt;layer0_output_gpu7 -->
<g id="edge336" class="edge">
<title>layer0_allreduce_moe&#45;&gt;layer0_output_gpu7</title>
<path fill="none" stroke="black" d="M12144.88,-1573.6C12659.34,-1558.5 14154.27,-1514.45 15396.5,-1476 16139.83,-1452.99 17031.26,-1424.09 17362.31,-1413.31"/>
<polygon fill="black" stroke="black" points="17362.54,-1416.81 17372.42,-1412.98 17362.31,-1409.81 17362.54,-1416.81"/>
</g>
<!-- layer1_qkv_gpu0 -->
<g id="node189" class="node">
<title>layer1_qkv_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="32891.5,-2908 32681.5,-2908 32681.5,-2810 32891.5,-2810 32891.5,-2908"/>
<text text-anchor="middle" x="32786.5" y="-2892.8" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU0</text>
<text text-anchor="middle" x="32786.5" y="-2877.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="32786.5" y="-2862.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="32786.5" y="-2847.8" font-family="Times,serif" font-size="14.00">Heads: 0&#45;3</text>
<text text-anchor="middle" x="32786.5" y="-2832.8" font-family="Times,serif" font-size="14.00">TP Slice: 0</text>
<text text-anchor="middle" x="32786.5" y="-2817.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_attn_gpu0 -->
<g id="node190" class="node">
<title>layer1_attn_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="32908,-2766.5 32665,-2766.5 32665,-2683.5 32908,-2683.5 32908,-2766.5"/>
<text text-anchor="middle" x="32786.5" y="-2751.3" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU0</text>
<text text-anchor="middle" x="32786.5" y="-2736.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="32786.5" y="-2721.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="32786.5" y="-2706.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="32786.5" y="-2691.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_qkv_gpu0&#45;&gt;layer1_attn_gpu0 -->
<g id="edge337" class="edge">
<title>layer1_qkv_gpu0&#45;&gt;layer1_attn_gpu0</title>
<path fill="none" stroke="black" d="M32786.5,-2809.97C32786.5,-2799.25 32786.5,-2787.84 32786.5,-2776.99"/>
<polygon fill="black" stroke="black" points="32790,-2776.82 32786.5,-2766.82 32783,-2776.82 32790,-2776.82"/>
</g>
<!-- layer1_attn_proj_gpu0 -->
<g id="node191" class="node">
<title>layer1_attn_proj_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="32886.5,-2632.5 32686.5,-2632.5 32686.5,-2564.5 32886.5,-2564.5 32886.5,-2632.5"/>
<text text-anchor="middle" x="32786.5" y="-2617.3" font-family="Times,serif" font-size="14.00">L1_Attn_Projection_GPU0</text>
<text text-anchor="middle" x="32786.5" y="-2602.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="32786.5" y="-2587.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="32786.5" y="-2572.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_attn_gpu0&#45;&gt;layer1_attn_proj_gpu0 -->
<g id="edge338" class="edge">
<title>layer1_attn_gpu0&#45;&gt;layer1_attn_proj_gpu0</title>
<path fill="none" stroke="black" d="M32786.5,-2683.23C32786.5,-2670.36 32786.5,-2656.1 32786.5,-2643.04"/>
<polygon fill="black" stroke="black" points="32790,-2642.88 32786.5,-2632.88 32783,-2642.88 32790,-2642.88"/>
</g>
<!-- layer1_attn_norm_gpu0 -->
<g id="node192" class="node">
<title>layer1_attn_norm_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="32907.5,-2315 32663.5,-2315 32663.5,-2247 32907.5,-2247 32907.5,-2315"/>
<text text-anchor="middle" x="32785.5" y="-2299.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU0</text>
<text text-anchor="middle" x="32785.5" y="-2284.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="32785.5" y="-2269.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="32785.5" y="-2254.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_attn_proj_gpu0&#45;&gt;layer1_attn_norm_gpu0 -->
<g id="edge339" class="edge">
<title>layer1_attn_proj_gpu0&#45;&gt;layer1_attn_norm_gpu0</title>
<path fill="none" stroke="black" d="M32786.39,-2564.33C32786.21,-2506.93 32785.84,-2389.12 32785.64,-2325.33"/>
<polygon fill="black" stroke="black" points="32789.14,-2325.19 32785.61,-2315.2 32782.14,-2325.21 32789.14,-2325.19"/>
</g>
<!-- layer1_allreduce_attn -->
<g id="node373" class="node">
<title>layer1_allreduce_attn</title>
<polygon fill="lightcoral" stroke="black" points="33702.5,-2521 33499.5,-2453 33702.5,-2385 33905.5,-2453 33702.5,-2521"/>
<text text-anchor="middle" x="33702.5" y="-2471.8" font-family="Times,serif" font-size="14.00">L1_All&#45;Reduce_Attention</text>
<text text-anchor="middle" x="33702.5" y="-2456.8" font-family="Times,serif" font-size="14.00">Input: 8×[1024,2048,512]</text>
<text text-anchor="middle" x="33702.5" y="-2441.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="33702.5" y="-2426.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
</g>
<!-- layer1_attn_proj_gpu0&#45;&gt;layer1_allreduce_attn -->
<g id="edge633" class="edge">
<title>layer1_attn_proj_gpu0&#45;&gt;layer1_allreduce_attn</title>
<path fill="none" stroke="black" d="M32886.74,-2569.24C32904.56,-2564.76 32923.01,-2560.47 32940.5,-2557 33144.71,-2516.51 33382.9,-2487.12 33537.88,-2470.34"/>
<polygon fill="black" stroke="black" points="33538.4,-2473.81 33547.97,-2469.26 33537.65,-2466.85 33538.4,-2473.81"/>
</g>
<!-- layer1_gate_gpu0 -->
<g id="node193" class="node">
<title>layer1_gate_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="23668.5,-2177 23424.5,-2177 23424.5,-2094 23668.5,-2094 23668.5,-2177"/>
<text text-anchor="middle" x="23546.5" y="-2161.8" font-family="Times,serif" font-size="14.00">L1_Gate_GPU0</text>
<text text-anchor="middle" x="23546.5" y="-2146.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="23546.5" y="-2131.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="23546.5" y="-2116.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="23546.5" y="-2101.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_attn_norm_gpu0&#45;&gt;layer1_gate_gpu0 -->
<g id="edge340" class="edge">
<title>layer1_attn_norm_gpu0&#45;&gt;layer1_gate_gpu0</title>
<path fill="none" stroke="black" d="M32663.17,-2278.1C31654.7,-2262.44 24725.28,-2154.81 23678.76,-2138.55"/>
<polygon fill="black" stroke="black" points="23678.63,-2135.05 23668.58,-2138.4 23678.52,-2142.05 23678.63,-2135.05"/>
</g>
<!-- layer1_expert0_0 -->
<g id="node194" class="node">
<title>layer1_expert0_0</title>
<polygon fill="lightgreen" stroke="black" points="22165,-2058 22000,-2058 22000,-1975 22165,-1975 22165,-2058"/>
<text text-anchor="middle" x="22082.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU0</text>
<text text-anchor="middle" x="22082.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="22082.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="22082.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="22082.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_0 -->
<g id="edge341" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23424.34,-2133.34C23137.75,-2129.72 22428,-2115.31 22175.02,-2058.07"/>
<polygon fill="black" stroke="black" points="22175.67,-2054.63 22165.13,-2055.76 22174.07,-2061.44 22175.67,-2054.63"/>
</g>
<!-- layer1_expert0_1 -->
<g id="node195" class="node">
<title>layer1_expert0_1</title>
<polygon fill="lightgreen" stroke="black" points="22348,-2058 22183,-2058 22183,-1975 22348,-1975 22348,-2058"/>
<text text-anchor="middle" x="22265.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU0</text>
<text text-anchor="middle" x="22265.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="22265.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="22265.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="22265.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_1 -->
<g id="edge342" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23424.05,-2132.1C23166.44,-2126.18 22575,-2107.75 22358.18,-2058.11"/>
<polygon fill="black" stroke="black" points="22358.68,-2054.63 22348.14,-2055.73 22357.06,-2061.44 22358.68,-2054.63"/>
</g>
<!-- layer1_expert0_2 -->
<g id="node196" class="node">
<title>layer1_expert0_2</title>
<polygon fill="lightgreen" stroke="black" points="22531,-2058 22366,-2058 22366,-1975 22531,-1975 22531,-2058"/>
<text text-anchor="middle" x="22448.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU0</text>
<text text-anchor="middle" x="22448.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="22448.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="22448.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="22448.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_2 -->
<g id="edge343" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23424.26,-2130.44C23198.14,-2122.08 22721.86,-2100.29 22541.08,-2058.1"/>
<polygon fill="black" stroke="black" points="22541.69,-2054.65 22531.15,-2055.68 22540.04,-2061.45 22541.69,-2054.65"/>
</g>
<!-- layer1_expert0_3 -->
<g id="node197" class="node">
<title>layer1_expert0_3</title>
<polygon fill="lightgreen" stroke="black" points="22714,-2058 22549,-2058 22549,-1975 22714,-1975 22714,-2058"/>
<text text-anchor="middle" x="22631.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU0</text>
<text text-anchor="middle" x="22631.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="22631.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="22631.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="22631.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_3 -->
<g id="edge344" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23424.36,-2128.05C23232.78,-2117.12 22869.32,-2092.96 22724.23,-2058.15"/>
<polygon fill="black" stroke="black" points="22724.72,-2054.66 22714.17,-2055.62 22723.01,-2061.45 22724.72,-2054.66"/>
</g>
<!-- layer1_expert0_4 -->
<g id="node198" class="node">
<title>layer1_expert0_4</title>
<polygon fill="lightgreen" stroke="black" points="22897,-2058 22732,-2058 22732,-1975 22897,-1975 22897,-2058"/>
<text text-anchor="middle" x="22814.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU0</text>
<text text-anchor="middle" x="22814.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="22814.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="22814.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="22814.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_4 -->
<g id="edge345" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23424.21,-2130.77C23295.95,-2124.4 23089.18,-2107.17 22906.95,-2058.19"/>
<polygon fill="black" stroke="black" points="22907.76,-2054.78 22897.19,-2055.53 22905.92,-2061.53 22907.76,-2054.78"/>
</g>
<!-- layer1_expert0_5 -->
<g id="node199" class="node">
<title>layer1_expert0_5</title>
<polygon fill="lightgreen" stroke="black" points="23080,-2058 22915,-2058 22915,-1975 23080,-1975 23080,-2058"/>
<text text-anchor="middle" x="22997.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU0</text>
<text text-anchor="middle" x="22997.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="22997.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="22997.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="22997.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_5 -->
<g id="edge346" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23424.05,-2122.58C23333.24,-2111.76 23206.81,-2092.52 23090.06,-2058.28"/>
<polygon fill="black" stroke="black" points="23090.82,-2054.86 23080.24,-2055.36 23088.83,-2061.57 23090.82,-2054.86"/>
</g>
<!-- layer1_expert0_6 -->
<g id="node200" class="node">
<title>layer1_expert0_6</title>
<polygon fill="lightgreen" stroke="black" points="23263,-2058 23098,-2058 23098,-1975 23263,-1975 23263,-2058"/>
<text text-anchor="middle" x="23180.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU0</text>
<text text-anchor="middle" x="23180.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="23180.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="23180.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="23180.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_6 -->
<g id="edge347" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23424.47,-2104.69C23378.95,-2092.56 23326.87,-2077.48 23272.56,-2058.26"/>
<polygon fill="black" stroke="black" points="23273.71,-2054.96 23263.12,-2054.89 23271.35,-2061.55 23273.71,-2054.96"/>
</g>
<!-- layer1_expert0_7 -->
<g id="node201" class="node">
<title>layer1_expert0_7</title>
<polygon fill="lightgreen" stroke="black" points="23446,-2058 23281,-2058 23281,-1975 23446,-1975 23446,-2058"/>
<text text-anchor="middle" x="23363.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU0</text>
<text text-anchor="middle" x="23363.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="23363.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="23363.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="23363.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_7 -->
<g id="edge348" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23483.01,-2093.91C23467.68,-2084.11 23451.19,-2073.56 23435.5,-2063.53"/>
<polygon fill="black" stroke="black" points="23437.19,-2060.46 23426.88,-2058.02 23433.42,-2066.36 23437.19,-2060.46"/>
</g>
<!-- layer1_expert0_8 -->
<g id="node202" class="node">
<title>layer1_expert0_8</title>
<polygon fill="lightgreen" stroke="black" points="23629,-2058 23464,-2058 23464,-1975 23629,-1975 23629,-2058"/>
<text text-anchor="middle" x="23546.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU0</text>
<text text-anchor="middle" x="23546.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="23546.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="23546.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="23546.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_8 -->
<g id="edge349" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23546.5,-2093.91C23546.5,-2085.65 23546.5,-2076.86 23546.5,-2068.3"/>
<polygon fill="black" stroke="black" points="23550,-2068.02 23546.5,-2058.02 23543,-2068.02 23550,-2068.02"/>
</g>
<!-- layer1_expert0_9 -->
<g id="node203" class="node">
<title>layer1_expert0_9</title>
<polygon fill="lightgreen" stroke="black" points="23812,-2058 23647,-2058 23647,-1975 23812,-1975 23812,-2058"/>
<text text-anchor="middle" x="23729.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU0</text>
<text text-anchor="middle" x="23729.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="23729.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="23729.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="23729.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_9 -->
<g id="edge350" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23609.99,-2093.91C23625.32,-2084.11 23641.81,-2073.56 23657.5,-2063.53"/>
<polygon fill="black" stroke="black" points="23659.58,-2066.36 23666.12,-2058.02 23655.81,-2060.46 23659.58,-2066.36"/>
</g>
<!-- layer1_expert0_10 -->
<g id="node204" class="node">
<title>layer1_expert0_10</title>
<polygon fill="lightgreen" stroke="black" points="23995,-2058 23830,-2058 23830,-1975 23995,-1975 23995,-2058"/>
<text text-anchor="middle" x="23912.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU0</text>
<text text-anchor="middle" x="23912.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="23912.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="23912.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="23912.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_10 -->
<g id="edge351" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23668.72,-2104.37C23716.54,-2091.55 23771.55,-2075.51 23820.5,-2058 23820.6,-2057.97 23820.7,-2057.93 23820.79,-2057.9"/>
<polygon fill="black" stroke="black" points="23821.81,-2061.25 23829.97,-2054.49 23819.38,-2054.69 23821.81,-2061.25"/>
</g>
<!-- layer1_expert0_11 -->
<g id="node205" class="node">
<title>layer1_expert0_11</title>
<polygon fill="lightgreen" stroke="black" points="24178,-2058 24013,-2058 24013,-1975 24178,-1975 24178,-2058"/>
<text text-anchor="middle" x="24095.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU0</text>
<text text-anchor="middle" x="24095.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="24095.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="24095.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="24095.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_11 -->
<g id="edge352" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23668.64,-2122.42C23759.24,-2111.52 23885.39,-2092.25 24002.96,-2057.94"/>
<polygon fill="black" stroke="black" points="24004.26,-2061.2 24012.86,-2055.01 24002.28,-2054.49 24004.26,-2061.2"/>
</g>
<!-- layer1_expert0_12 -->
<g id="node206" class="node">
<title>layer1_expert0_12</title>
<polygon fill="lightgreen" stroke="black" points="24361,-2058 24196,-2058 24196,-1975 24361,-1975 24361,-2058"/>
<text text-anchor="middle" x="24278.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU0</text>
<text text-anchor="middle" x="24278.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="24278.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="24278.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="24278.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_12 -->
<g id="edge353" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23668.56,-2130.6C23796.59,-2124.1 24003.01,-2106.76 24186.11,-2057.85"/>
<polygon fill="black" stroke="black" points="24187.18,-2061.19 24195.91,-2055.2 24185.35,-2054.43 24187.18,-2061.19"/>
</g>
<!-- layer1_expert0_13 -->
<g id="node207" class="node">
<title>layer1_expert0_13</title>
<polygon fill="lightgreen" stroke="black" points="24544,-2058 24379,-2058 24379,-1975 24544,-1975 24544,-2058"/>
<text text-anchor="middle" x="24461.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU0</text>
<text text-anchor="middle" x="24461.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="24461.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="24461.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="24461.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_13 -->
<g id="edge354" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23668.87,-2127.96C23860.31,-2116.93 24222.9,-2092.64 24368.82,-2057.83"/>
<polygon fill="black" stroke="black" points="24370.09,-2061.12 24378.94,-2055.3 24368.39,-2054.33 24370.09,-2061.12"/>
</g>
<!-- layer1_expert0_14 -->
<g id="node208" class="node">
<title>layer1_expert0_14</title>
<polygon fill="lightgreen" stroke="black" points="24727,-2058 24562,-2058 24562,-1975 24727,-1975 24727,-2058"/>
<text text-anchor="middle" x="24644.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU0</text>
<text text-anchor="middle" x="24644.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="24644.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="24644.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="24644.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_14 -->
<g id="edge355" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23668.6,-2130.37C23894.48,-2121.9 24370.24,-2099.94 24551.97,-2057.78"/>
<polygon fill="black" stroke="black" points="24553.06,-2061.12 24561.96,-2055.37 24551.42,-2054.32 24553.06,-2061.12"/>
</g>
<!-- layer1_expert0_15 -->
<g id="node209" class="node">
<title>layer1_expert0_15</title>
<polygon fill="lightgreen" stroke="black" points="24910,-2058 24745,-2058 24745,-1975 24910,-1975 24910,-2058"/>
<text text-anchor="middle" x="24827.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU0</text>
<text text-anchor="middle" x="24827.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="24827.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="24827.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="24827.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gate_gpu0&#45;&gt;layer1_expert0_15 -->
<g id="edge356" class="edge">
<title>layer1_gate_gpu0&#45;&gt;layer1_expert0_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23668.83,-2132.04C23926.32,-2125.99 24517.68,-2107.3 24735.21,-2057.73"/>
<polygon fill="black" stroke="black" points="24736.04,-2061.13 24744.97,-2055.42 24734.43,-2054.31 24736.04,-2061.13"/>
</g>
<!-- layer1_moe_agg_gpu0 -->
<g id="node210" class="node">
<title>layer1_moe_agg_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="23740,-1939 23537,-1939 23537,-1856 23740,-1856 23740,-1939"/>
<text text-anchor="middle" x="23638.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU0</text>
<text text-anchor="middle" x="23638.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="23638.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="23638.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="23638.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_expert0_0&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge357" class="edge">
<title>layer1_expert0_0&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M22165.11,-1977.15C22167.92,-1976.35 22170.72,-1975.63 22173.5,-1975 22442.51,-1913.75 23140.1,-1967.62 23414.5,-1939 23451.33,-1935.16 23491.2,-1928.7 23526.96,-1922.06"/>
<polygon fill="black" stroke="black" points="23527.75,-1925.48 23536.93,-1920.19 23526.45,-1918.6 23527.75,-1925.48"/>
</g>
<!-- layer1_expert0_1&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge358" class="edge">
<title>layer1_expert0_1&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M22348.11,-1977.16C22350.92,-1976.37 22353.72,-1975.64 22356.5,-1975 22585.75,-1922.2 23180.58,-1963.99 23414.5,-1939 23451.32,-1935.07 23491.19,-1928.59 23526.95,-1921.95"/>
<polygon fill="black" stroke="black" points="23527.74,-1925.37 23536.92,-1920.08 23526.44,-1918.49 23527.74,-1925.37"/>
</g>
<!-- layer1_expert0_2&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge359" class="edge">
<title>layer1_expert0_2&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M22531.12,-1977.19C22533.92,-1976.38 22536.72,-1975.65 22539.5,-1975 22728.99,-1930.65 23221.07,-1960.36 23414.5,-1939 23451.3,-1934.94 23491.17,-1928.42 23526.93,-1921.8"/>
<polygon fill="black" stroke="black" points="23527.72,-1925.21 23536.9,-1919.93 23526.43,-1918.33 23527.72,-1925.21"/>
</g>
<!-- layer1_expert0_3&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge360" class="edge">
<title>layer1_expert0_3&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M22714.13,-1977.23C22716.93,-1976.41 22719.73,-1975.67 22722.5,-1975 23021.98,-1903.18 23108.58,-1974.47 23414.5,-1939 23451.28,-1934.74 23491.14,-1928.17 23526.9,-1921.55"/>
<polygon fill="black" stroke="black" points="23527.69,-1924.97 23536.87,-1919.69 23526.4,-1918.09 23527.69,-1924.97"/>
</g>
<!-- layer1_expert0_4&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge361" class="edge">
<title>layer1_expert0_4&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M22897.15,-1977.3C22899.94,-1976.46 22902.73,-1975.69 22905.5,-1975 23125.53,-1920.06 23189.47,-1967.22 23414.5,-1939 23451.24,-1934.39 23491.09,-1927.73 23526.85,-1921.14"/>
<polygon fill="black" stroke="black" points="23527.63,-1924.56 23536.83,-1919.29 23526.35,-1917.67 23527.63,-1924.56"/>
</g>
<!-- layer1_expert0_5&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge362" class="edge">
<title>layer1_expert0_5&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M23080.18,-1977.44C23082.97,-1976.56 23085.75,-1975.75 23088.5,-1975 23229.21,-1936.91 23270.25,-1959.98 23414.5,-1939 23451.23,-1933.66 23491.16,-1926.78 23527,-1920.22"/>
<polygon fill="black" stroke="black" points="23527.79,-1923.64 23536.99,-1918.38 23526.52,-1916.75 23527.79,-1923.64"/>
</g>
<!-- layer1_expert0_6&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge363" class="edge">
<title>layer1_expert0_6&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M23263.03,-1977.87C23265.87,-1976.86 23268.7,-1975.9 23271.5,-1975 23318.14,-1959.95 23436.92,-1936.13 23526.82,-1919.07"/>
<polygon fill="black" stroke="black" points="23527.63,-1922.48 23536.8,-1917.18 23526.33,-1915.6 23527.63,-1922.48"/>
</g>
<!-- layer1_expert0_7&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge364" class="edge">
<title>layer1_expert0_7&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M23446.29,-1978.55C23449.06,-1977.35 23451.8,-1976.16 23454.5,-1975 23478.87,-1964.51 23505.16,-1953.44 23530.02,-1943.08"/>
<polygon fill="black" stroke="black" points="23531.59,-1946.22 23539.48,-1939.14 23528.9,-1939.75 23531.59,-1946.22"/>
</g>
<!-- layer1_expert0_8&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge365" class="edge">
<title>layer1_expert0_8&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M23578.42,-1974.91C23585.48,-1965.92 23593.04,-1956.32 23600.32,-1947.05"/>
<polygon fill="black" stroke="black" points="23603.21,-1949.05 23606.64,-1939.02 23597.7,-1944.72 23603.21,-1949.05"/>
</g>
<!-- layer1_expert0_9&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge366" class="edge">
<title>layer1_expert0_9&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M23697.93,-1974.91C23690.94,-1965.92 23683.47,-1956.32 23676.26,-1947.05"/>
<polygon fill="black" stroke="black" points="23678.92,-1944.77 23670.02,-1939.02 23673.39,-1949.06 23678.92,-1944.77"/>
</g>
<!-- layer1_expert0_10&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge367" class="edge">
<title>layer1_expert0_10&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M23829.78,-1979.01C23826.65,-1977.65 23823.55,-1976.31 23820.5,-1975 23796.21,-1964.55 23770.03,-1953.45 23745.31,-1943.04"/>
<polygon fill="black" stroke="black" points="23746.49,-1939.74 23735.91,-1939.09 23743.78,-1946.19 23746.49,-1939.74"/>
</g>
<!-- layer1_expert0_11&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge368" class="edge">
<title>layer1_expert0_11&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M24012.81,-1978.15C24009.68,-1977.04 24006.57,-1975.99 24003.5,-1975 23920.34,-1948.3 23823.46,-1928.5 23750.42,-1915.74"/>
<polygon fill="black" stroke="black" points="23750.73,-1912.24 23740.28,-1913.98 23749.54,-1919.13 23750.73,-1912.24"/>
</g>
<!-- layer1_expert0_12&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge369" class="edge">
<title>layer1_expert0_12&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M24195.89,-1977.88C24192.74,-1976.85 24189.61,-1975.88 24186.5,-1975 24039.09,-1933.14 23862.61,-1913.74 23750.53,-1905.07"/>
<polygon fill="black" stroke="black" points="23750.46,-1901.55 23740.22,-1904.29 23749.93,-1908.53 23750.46,-1901.55"/>
</g>
<!-- layer1_expert0_13&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge370" class="edge">
<title>layer1_expert0_13&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M24378.93,-1977.74C24375.77,-1976.75 24372.62,-1975.83 24369.5,-1975 24155.42,-1918.17 23895.57,-1903.24 23750.44,-1899.51"/>
<polygon fill="black" stroke="black" points="23750.28,-1896.01 23740.2,-1899.26 23750.11,-1903 23750.28,-1896.01"/>
</g>
<!-- layer1_expert0_14&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge371" class="edge">
<title>layer1_expert0_14&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M24561.95,-1977.66C24558.79,-1976.69 24555.63,-1975.8 24552.5,-1975 24403.61,-1937.12 23959.87,-1912.88 23750.37,-1903.24"/>
<polygon fill="black" stroke="black" points="23750.42,-1899.74 23740.27,-1902.78 23750.1,-1906.73 23750.42,-1899.74"/>
</g>
<!-- layer1_expert0_15&#45;&gt;layer1_moe_agg_gpu0 -->
<g id="edge372" class="edge">
<title>layer1_expert0_15&#45;&gt;layer1_moe_agg_gpu0</title>
<path fill="none" stroke="black" d="M24744.96,-1977.6C24741.8,-1976.65 24738.63,-1975.77 24735.5,-1975 24551.18,-1929.47 23991.1,-1908.51 23750.4,-1901.43"/>
<polygon fill="black" stroke="black" points="23750.32,-1897.92 23740.22,-1901.13 23750.12,-1904.92 23750.32,-1897.92"/>
</g>
<!-- layer1_output_gpu0 -->
<g id="node211" class="node">
<title>layer1_output_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="32887.5,-1614 32643.5,-1614 32643.5,-1546 32887.5,-1546 32887.5,-1614"/>
<text text-anchor="middle" x="32765.5" y="-1598.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU0</text>
<text text-anchor="middle" x="32765.5" y="-1583.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="32765.5" y="-1568.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="32765.5" y="-1553.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_moe_agg_gpu0&#45;&gt;layer1_output_gpu0 -->
<g id="edge373" class="edge">
<title>layer1_moe_agg_gpu0&#45;&gt;layer1_output_gpu0</title>
<path fill="none" stroke="black" d="M23740.16,-1891.46C24256.77,-1865.98 26643.03,-1750.02 28597.5,-1684 30186.17,-1630.34 32116.35,-1592.95 32633.06,-1583.4"/>
<polygon fill="black" stroke="black" points="32633.22,-1586.9 32643.16,-1583.21 32633.09,-1579.9 32633.22,-1586.9"/>
</g>
<!-- layer1_allreduce_moe -->
<g id="node374" class="node">
<title>layer1_allreduce_moe</title>
<polygon fill="lightcoral" stroke="black" points="33800.5,-1820 33597.5,-1752 33800.5,-1684 34003.5,-1752 33800.5,-1820"/>
<text text-anchor="middle" x="33800.5" y="-1770.8" font-family="Times,serif" font-size="14.00">L1_All&#45;Reduce_MoE</text>
<text text-anchor="middle" x="33800.5" y="-1755.8" font-family="Times,serif" font-size="14.00">Input: 8×[1024,2048,512]</text>
<text text-anchor="middle" x="33800.5" y="-1740.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="33800.5" y="-1725.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
</g>
<!-- layer1_moe_agg_gpu0&#45;&gt;layer1_allreduce_moe -->
<g id="edge635" class="edge">
<title>layer1_moe_agg_gpu0&#45;&gt;layer1_allreduce_moe</title>
<path fill="none" stroke="black" d="M23740.19,-1895.02C24106.59,-1889.71 25393.62,-1871.08 26455.5,-1856 29288.82,-1815.77 32736.93,-1767.78 33598.27,-1755.81"/>
<polygon fill="black" stroke="black" points="33598.33,-1759.31 33608.28,-1755.67 33598.23,-1752.31 33598.33,-1759.31"/>
</g>
<!-- pipeline_stage0_1 -->
<g id="node748" class="node">
<title>pipeline_stage0_1</title>
<polygon fill="yellow" stroke="black" points="33904.23,-1476 33551.51,-1476 33460.77,-1340 33813.49,-1340 33904.23,-1476"/>
<text text-anchor="middle" x="33682.5" y="-1426.8" font-family="Times,serif" font-size="14.00">Pipeline_Stage0_to_1</text>
<text text-anchor="middle" x="33682.5" y="-1411.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="33682.5" y="-1396.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="33682.5" y="-1381.8" font-family="Times,serif" font-size="14.00">Cross&#45;stage communication</text>
</g>
<!-- layer1_output_gpu0&#45;&gt;pipeline_stage0_1 -->
<g id="edge665" class="edge">
<title>layer1_output_gpu0&#45;&gt;pipeline_stage0_1</title>
<path fill="none" stroke="black" d="M32819.81,-1545.93C32842.72,-1533.4 32870.16,-1520.19 32896.5,-1512 33097.3,-1449.55 33338.42,-1424.95 33500.19,-1415.27"/>
<polygon fill="black" stroke="black" points="33500.46,-1418.76 33510.24,-1414.68 33500.05,-1411.77 33500.46,-1418.76"/>
</g>
<!-- layer1_qkv_gpu1 -->
<g id="node212" class="node">
<title>layer1_qkv_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="33154.5,-2908 32944.5,-2908 32944.5,-2810 33154.5,-2810 33154.5,-2908"/>
<text text-anchor="middle" x="33049.5" y="-2892.8" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU1</text>
<text text-anchor="middle" x="33049.5" y="-2877.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="33049.5" y="-2862.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="33049.5" y="-2847.8" font-family="Times,serif" font-size="14.00">Heads: 4&#45;7</text>
<text text-anchor="middle" x="33049.5" y="-2832.8" font-family="Times,serif" font-size="14.00">TP Slice: 1</text>
<text text-anchor="middle" x="33049.5" y="-2817.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_attn_gpu1 -->
<g id="node213" class="node">
<title>layer1_attn_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="33171,-2766.5 32928,-2766.5 32928,-2683.5 33171,-2683.5 33171,-2766.5"/>
<text text-anchor="middle" x="33049.5" y="-2751.3" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU1</text>
<text text-anchor="middle" x="33049.5" y="-2736.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="33049.5" y="-2721.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33049.5" y="-2706.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="33049.5" y="-2691.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_qkv_gpu1&#45;&gt;layer1_attn_gpu1 -->
<g id="edge374" class="edge">
<title>layer1_qkv_gpu1&#45;&gt;layer1_attn_gpu1</title>
<path fill="none" stroke="black" d="M33049.5,-2809.97C33049.5,-2799.25 33049.5,-2787.84 33049.5,-2776.99"/>
<polygon fill="black" stroke="black" points="33053,-2776.82 33049.5,-2766.82 33046,-2776.82 33053,-2776.82"/>
</g>
<!-- layer1_attn_proj_gpu1 -->
<g id="node214" class="node">
<title>layer1_attn_proj_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="33149.5,-2632.5 32949.5,-2632.5 32949.5,-2564.5 33149.5,-2564.5 33149.5,-2632.5"/>
<text text-anchor="middle" x="33049.5" y="-2617.3" font-family="Times,serif" font-size="14.00">L1_Attn_Projection_GPU1</text>
<text text-anchor="middle" x="33049.5" y="-2602.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="33049.5" y="-2587.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33049.5" y="-2572.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_attn_gpu1&#45;&gt;layer1_attn_proj_gpu1 -->
<g id="edge375" class="edge">
<title>layer1_attn_gpu1&#45;&gt;layer1_attn_proj_gpu1</title>
<path fill="none" stroke="black" d="M33049.5,-2683.23C33049.5,-2670.36 33049.5,-2656.1 33049.5,-2643.04"/>
<polygon fill="black" stroke="black" points="33053,-2642.88 33049.5,-2632.88 33046,-2642.88 33053,-2642.88"/>
</g>
<!-- layer1_attn_norm_gpu1 -->
<g id="node215" class="node">
<title>layer1_attn_norm_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="33169.5,-2315 32925.5,-2315 32925.5,-2247 33169.5,-2247 33169.5,-2315"/>
<text text-anchor="middle" x="33047.5" y="-2299.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU1</text>
<text text-anchor="middle" x="33047.5" y="-2284.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="33047.5" y="-2269.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33047.5" y="-2254.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_attn_proj_gpu1&#45;&gt;layer1_attn_norm_gpu1 -->
<g id="edge376" class="edge">
<title>layer1_attn_proj_gpu1&#45;&gt;layer1_attn_norm_gpu1</title>
<path fill="none" stroke="black" d="M33049.29,-2564.33C33048.93,-2506.93 33048.18,-2389.12 33047.77,-2325.33"/>
<polygon fill="black" stroke="black" points="33051.27,-2325.17 33047.71,-2315.2 33044.27,-2325.22 33051.27,-2325.17"/>
</g>
<!-- layer1_attn_proj_gpu1&#45;&gt;layer1_allreduce_attn -->
<g id="edge637" class="edge">
<title>layer1_attn_proj_gpu1&#45;&gt;layer1_allreduce_attn</title>
<path fill="none" stroke="black" d="M33149.71,-2570.12C33167.26,-2565.57 33185.38,-2561.03 33202.5,-2557 33324.4,-2528.33 33464.06,-2499.93 33564.73,-2480.24"/>
<polygon fill="black" stroke="black" points="33565.51,-2483.65 33574.66,-2478.3 33564.17,-2476.78 33565.51,-2483.65"/>
</g>
<!-- layer1_gate_gpu1 -->
<g id="node216" class="node">
<title>layer1_gate_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="26596.5,-2177 26352.5,-2177 26352.5,-2094 26596.5,-2094 26596.5,-2177"/>
<text text-anchor="middle" x="26474.5" y="-2161.8" font-family="Times,serif" font-size="14.00">L1_Gate_GPU1</text>
<text text-anchor="middle" x="26474.5" y="-2146.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="26474.5" y="-2131.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="26474.5" y="-2116.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="26474.5" y="-2101.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_attn_norm_gpu1&#45;&gt;layer1_gate_gpu1 -->
<g id="edge377" class="edge">
<title>layer1_attn_norm_gpu1&#45;&gt;layer1_gate_gpu1</title>
<path fill="none" stroke="black" d="M32996.47,-2246.92C32973.08,-2233.64 32944.41,-2219.87 32916.5,-2213 32818.18,-2188.8 29372.75,-2178.23 29271.5,-2177 28245.7,-2164.51 27008.34,-2145.06 26607.03,-2138.64"/>
<polygon fill="black" stroke="black" points="26606.89,-2135.13 26596.84,-2138.47 26606.78,-2142.13 26606.89,-2135.13"/>
</g>
<!-- layer1_expert1_0 -->
<g id="node217" class="node">
<title>layer1_expert1_0</title>
<polygon fill="lightgreen" stroke="black" points="25093,-2058 24928,-2058 24928,-1975 25093,-1975 25093,-2058"/>
<text text-anchor="middle" x="25010.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU1</text>
<text text-anchor="middle" x="25010.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="25010.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="25010.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="25010.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_0 -->
<g id="edge378" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26352.34,-2133.34C26065.75,-2129.72 25356,-2115.31 25103.02,-2058.07"/>
<polygon fill="black" stroke="black" points="25103.67,-2054.63 25093.13,-2055.76 25102.07,-2061.44 25103.67,-2054.63"/>
</g>
<!-- layer1_expert1_1 -->
<g id="node218" class="node">
<title>layer1_expert1_1</title>
<polygon fill="lightgreen" stroke="black" points="25276,-2058 25111,-2058 25111,-1975 25276,-1975 25276,-2058"/>
<text text-anchor="middle" x="25193.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU1</text>
<text text-anchor="middle" x="25193.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="25193.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="25193.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="25193.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_1 -->
<g id="edge379" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26352.05,-2132.1C26094.44,-2126.18 25503,-2107.75 25286.18,-2058.11"/>
<polygon fill="black" stroke="black" points="25286.68,-2054.63 25276.14,-2055.73 25285.06,-2061.44 25286.68,-2054.63"/>
</g>
<!-- layer1_expert1_2 -->
<g id="node219" class="node">
<title>layer1_expert1_2</title>
<polygon fill="lightgreen" stroke="black" points="25459,-2058 25294,-2058 25294,-1975 25459,-1975 25459,-2058"/>
<text text-anchor="middle" x="25376.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU1</text>
<text text-anchor="middle" x="25376.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="25376.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="25376.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="25376.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_2 -->
<g id="edge380" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26352.26,-2130.44C26126.14,-2122.08 25649.86,-2100.29 25469.08,-2058.1"/>
<polygon fill="black" stroke="black" points="25469.69,-2054.65 25459.15,-2055.68 25468.04,-2061.45 25469.69,-2054.65"/>
</g>
<!-- layer1_expert1_3 -->
<g id="node220" class="node">
<title>layer1_expert1_3</title>
<polygon fill="lightgreen" stroke="black" points="25642,-2058 25477,-2058 25477,-1975 25642,-1975 25642,-2058"/>
<text text-anchor="middle" x="25559.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU1</text>
<text text-anchor="middle" x="25559.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="25559.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="25559.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="25559.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_3 -->
<g id="edge381" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26352.36,-2128.05C26160.78,-2117.12 25797.32,-2092.96 25652.23,-2058.15"/>
<polygon fill="black" stroke="black" points="25652.72,-2054.66 25642.17,-2055.62 25651.01,-2061.45 25652.72,-2054.66"/>
</g>
<!-- layer1_expert1_4 -->
<g id="node221" class="node">
<title>layer1_expert1_4</title>
<polygon fill="lightgreen" stroke="black" points="25825,-2058 25660,-2058 25660,-1975 25825,-1975 25825,-2058"/>
<text text-anchor="middle" x="25742.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU1</text>
<text text-anchor="middle" x="25742.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="25742.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="25742.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="25742.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_4 -->
<g id="edge382" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26352.21,-2130.77C26223.95,-2124.4 26017.18,-2107.17 25834.95,-2058.19"/>
<polygon fill="black" stroke="black" points="25835.76,-2054.78 25825.19,-2055.53 25833.92,-2061.53 25835.76,-2054.78"/>
</g>
<!-- layer1_expert1_5 -->
<g id="node222" class="node">
<title>layer1_expert1_5</title>
<polygon fill="lightgreen" stroke="black" points="26008,-2058 25843,-2058 25843,-1975 26008,-1975 26008,-2058"/>
<text text-anchor="middle" x="25925.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU1</text>
<text text-anchor="middle" x="25925.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="25925.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="25925.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="25925.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_5 -->
<g id="edge383" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26352.05,-2122.58C26261.24,-2111.76 26134.81,-2092.52 26018.06,-2058.28"/>
<polygon fill="black" stroke="black" points="26018.82,-2054.86 26008.24,-2055.36 26016.83,-2061.57 26018.82,-2054.86"/>
</g>
<!-- layer1_expert1_6 -->
<g id="node223" class="node">
<title>layer1_expert1_6</title>
<polygon fill="lightgreen" stroke="black" points="26191,-2058 26026,-2058 26026,-1975 26191,-1975 26191,-2058"/>
<text text-anchor="middle" x="26108.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU1</text>
<text text-anchor="middle" x="26108.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="26108.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="26108.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="26108.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_6 -->
<g id="edge384" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26352.47,-2104.69C26306.95,-2092.56 26254.87,-2077.48 26200.56,-2058.26"/>
<polygon fill="black" stroke="black" points="26201.71,-2054.96 26191.12,-2054.89 26199.35,-2061.55 26201.71,-2054.96"/>
</g>
<!-- layer1_expert1_7 -->
<g id="node224" class="node">
<title>layer1_expert1_7</title>
<polygon fill="lightgreen" stroke="black" points="26374,-2058 26209,-2058 26209,-1975 26374,-1975 26374,-2058"/>
<text text-anchor="middle" x="26291.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU1</text>
<text text-anchor="middle" x="26291.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="26291.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="26291.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="26291.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_7 -->
<g id="edge385" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26411.01,-2093.91C26395.68,-2084.11 26379.19,-2073.56 26363.5,-2063.53"/>
<polygon fill="black" stroke="black" points="26365.19,-2060.46 26354.88,-2058.02 26361.42,-2066.36 26365.19,-2060.46"/>
</g>
<!-- layer1_expert1_8 -->
<g id="node225" class="node">
<title>layer1_expert1_8</title>
<polygon fill="lightgreen" stroke="black" points="26557,-2058 26392,-2058 26392,-1975 26557,-1975 26557,-2058"/>
<text text-anchor="middle" x="26474.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU1</text>
<text text-anchor="middle" x="26474.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="26474.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="26474.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="26474.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_8 -->
<g id="edge386" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26474.5,-2093.91C26474.5,-2085.65 26474.5,-2076.86 26474.5,-2068.3"/>
<polygon fill="black" stroke="black" points="26478,-2068.02 26474.5,-2058.02 26471,-2068.02 26478,-2068.02"/>
</g>
<!-- layer1_expert1_9 -->
<g id="node226" class="node">
<title>layer1_expert1_9</title>
<polygon fill="lightgreen" stroke="black" points="26740,-2058 26575,-2058 26575,-1975 26740,-1975 26740,-2058"/>
<text text-anchor="middle" x="26657.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU1</text>
<text text-anchor="middle" x="26657.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="26657.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="26657.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="26657.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_9 -->
<g id="edge387" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26537.99,-2093.91C26553.32,-2084.11 26569.81,-2073.56 26585.5,-2063.53"/>
<polygon fill="black" stroke="black" points="26587.58,-2066.36 26594.12,-2058.02 26583.81,-2060.46 26587.58,-2066.36"/>
</g>
<!-- layer1_expert1_10 -->
<g id="node227" class="node">
<title>layer1_expert1_10</title>
<polygon fill="lightgreen" stroke="black" points="26923,-2058 26758,-2058 26758,-1975 26923,-1975 26923,-2058"/>
<text text-anchor="middle" x="26840.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU1</text>
<text text-anchor="middle" x="26840.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="26840.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="26840.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="26840.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_10 -->
<g id="edge388" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26596.72,-2104.37C26644.54,-2091.55 26699.55,-2075.51 26748.5,-2058 26748.6,-2057.97 26748.7,-2057.93 26748.79,-2057.9"/>
<polygon fill="black" stroke="black" points="26749.81,-2061.25 26757.97,-2054.49 26747.38,-2054.69 26749.81,-2061.25"/>
</g>
<!-- layer1_expert1_11 -->
<g id="node228" class="node">
<title>layer1_expert1_11</title>
<polygon fill="lightgreen" stroke="black" points="27106,-2058 26941,-2058 26941,-1975 27106,-1975 27106,-2058"/>
<text text-anchor="middle" x="27023.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU1</text>
<text text-anchor="middle" x="27023.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="27023.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="27023.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="27023.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_11 -->
<g id="edge389" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26596.64,-2122.42C26687.24,-2111.52 26813.39,-2092.25 26930.96,-2057.94"/>
<polygon fill="black" stroke="black" points="26932.26,-2061.2 26940.86,-2055.01 26930.28,-2054.49 26932.26,-2061.2"/>
</g>
<!-- layer1_expert1_12 -->
<g id="node229" class="node">
<title>layer1_expert1_12</title>
<polygon fill="lightgreen" stroke="black" points="27289,-2058 27124,-2058 27124,-1975 27289,-1975 27289,-2058"/>
<text text-anchor="middle" x="27206.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU1</text>
<text text-anchor="middle" x="27206.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="27206.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="27206.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="27206.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_12 -->
<g id="edge390" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26596.56,-2130.6C26724.59,-2124.1 26931.01,-2106.76 27114.11,-2057.85"/>
<polygon fill="black" stroke="black" points="27115.18,-2061.19 27123.91,-2055.2 27113.35,-2054.43 27115.18,-2061.19"/>
</g>
<!-- layer1_expert1_13 -->
<g id="node230" class="node">
<title>layer1_expert1_13</title>
<polygon fill="lightgreen" stroke="black" points="27472,-2058 27307,-2058 27307,-1975 27472,-1975 27472,-2058"/>
<text text-anchor="middle" x="27389.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU1</text>
<text text-anchor="middle" x="27389.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="27389.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="27389.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="27389.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_13 -->
<g id="edge391" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26596.87,-2127.96C26788.31,-2116.93 27150.9,-2092.64 27296.82,-2057.83"/>
<polygon fill="black" stroke="black" points="27298.09,-2061.12 27306.94,-2055.3 27296.39,-2054.33 27298.09,-2061.12"/>
</g>
<!-- layer1_expert1_14 -->
<g id="node231" class="node">
<title>layer1_expert1_14</title>
<polygon fill="lightgreen" stroke="black" points="27655,-2058 27490,-2058 27490,-1975 27655,-1975 27655,-2058"/>
<text text-anchor="middle" x="27572.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU1</text>
<text text-anchor="middle" x="27572.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="27572.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="27572.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="27572.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_14 -->
<g id="edge392" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26596.6,-2130.37C26822.48,-2121.9 27298.24,-2099.94 27479.97,-2057.78"/>
<polygon fill="black" stroke="black" points="27481.06,-2061.12 27489.96,-2055.37 27479.42,-2054.32 27481.06,-2061.12"/>
</g>
<!-- layer1_expert1_15 -->
<g id="node232" class="node">
<title>layer1_expert1_15</title>
<polygon fill="lightgreen" stroke="black" points="27838,-2058 27673,-2058 27673,-1975 27838,-1975 27838,-2058"/>
<text text-anchor="middle" x="27755.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU1</text>
<text text-anchor="middle" x="27755.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="27755.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="27755.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="27755.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gate_gpu1&#45;&gt;layer1_expert1_15 -->
<g id="edge393" class="edge">
<title>layer1_gate_gpu1&#45;&gt;layer1_expert1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26596.83,-2132.04C26854.32,-2125.99 27445.68,-2107.3 27663.21,-2057.73"/>
<polygon fill="black" stroke="black" points="27664.04,-2061.13 27672.97,-2055.42 27662.43,-2054.31 27664.04,-2061.13"/>
</g>
<!-- layer1_moe_agg_gpu1 -->
<g id="node233" class="node">
<title>layer1_moe_agg_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="26668,-1939 26465,-1939 26465,-1856 26668,-1856 26668,-1939"/>
<text text-anchor="middle" x="26566.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU1</text>
<text text-anchor="middle" x="26566.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="26566.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="26566.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="26566.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_expert1_0&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge394" class="edge">
<title>layer1_expert1_0&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M25093.13,-1977.23C25095.93,-1976.41 25098.73,-1975.67 25101.5,-1975 25357.96,-1913.47 26158.3,-1901.43 26454.66,-1899.07"/>
<polygon fill="black" stroke="black" points="26455.02,-1902.57 26464.99,-1898.99 26454.96,-1895.57 26455.02,-1902.57"/>
</g>
<!-- layer1_expert1_1&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge395" class="edge">
<title>layer1_expert1_1&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M25276.14,-1977.26C25278.94,-1976.43 25281.73,-1975.68 25284.5,-1975 25504.92,-1921.25 26185.05,-1904.62 26454.7,-1900.05"/>
<polygon fill="black" stroke="black" points="26454.96,-1903.55 26464.9,-1899.88 26454.84,-1896.55 26454.96,-1903.55"/>
</g>
<!-- layer1_expert1_2&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge396" class="edge">
<title>layer1_expert1_2&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M25459.14,-1977.29C25461.94,-1976.46 25464.73,-1975.69 25467.5,-1975 25652.06,-1929.03 26213.21,-1908.31 26454.39,-1901.36"/>
<polygon fill="black" stroke="black" points="26454.68,-1904.85 26464.58,-1901.07 26454.48,-1897.86 26454.68,-1904.85"/>
</g>
<!-- layer1_expert1_3&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge397" class="edge">
<title>layer1_expert1_3&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M25642.16,-1977.34C25644.95,-1976.49 25647.74,-1975.71 25650.5,-1975 25799.74,-1936.73 26244.96,-1912.67 26454.77,-1903.16"/>
<polygon fill="black" stroke="black" points="26455.05,-1906.65 26464.88,-1902.7 26454.74,-1899.65 26455.05,-1906.65"/>
</g>
<!-- layer1_expert1_4&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge398" class="edge">
<title>layer1_expert1_4&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M25825.18,-1977.42C25827.96,-1976.55 25830.74,-1975.74 25833.5,-1975 26048.21,-1917.57 26309.02,-1902.86 26454.52,-1899.33"/>
<polygon fill="black" stroke="black" points="26454.88,-1902.82 26464.8,-1899.09 26454.72,-1895.82 26454.88,-1902.82"/>
</g>
<!-- layer1_expert1_5&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge399" class="edge">
<title>layer1_expert1_5&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M26008.21,-1977.54C26010.99,-1976.64 26013.76,-1975.78 26016.5,-1975 26164.74,-1932.62 26342.4,-1913.34 26454.88,-1904.83"/>
<polygon fill="black" stroke="black" points="26455.17,-1908.32 26464.89,-1904.09 26454.65,-1901.34 26455.17,-1908.32"/>
</g>
<!-- layer1_expert1_6&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge400" class="edge">
<title>layer1_expert1_6&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M26191.03,-1977.87C26193.87,-1976.86 26196.7,-1975.9 26199.5,-1975 26283.36,-1947.94 26381.16,-1928.11 26454.7,-1915.42"/>
<polygon fill="black" stroke="black" points="26455.65,-1918.81 26464.92,-1913.68 26454.47,-1911.91 26455.65,-1918.81"/>
</g>
<!-- layer1_expert1_7&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge401" class="edge">
<title>layer1_expert1_7&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M26374.29,-1978.55C26377.06,-1977.35 26379.8,-1976.16 26382.5,-1975 26406.87,-1964.51 26433.16,-1953.44 26458.02,-1943.08"/>
<polygon fill="black" stroke="black" points="26459.59,-1946.22 26467.48,-1939.14 26456.9,-1939.75 26459.59,-1946.22"/>
</g>
<!-- layer1_expert1_8&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge402" class="edge">
<title>layer1_expert1_8&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M26506.42,-1974.91C26513.48,-1965.92 26521.04,-1956.32 26528.32,-1947.05"/>
<polygon fill="black" stroke="black" points="26531.21,-1949.05 26534.64,-1939.02 26525.7,-1944.72 26531.21,-1949.05"/>
</g>
<!-- layer1_expert1_9&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge403" class="edge">
<title>layer1_expert1_9&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M26625.93,-1974.91C26618.94,-1965.92 26611.47,-1956.32 26604.26,-1947.05"/>
<polygon fill="black" stroke="black" points="26606.92,-1944.77 26598.02,-1939.02 26601.39,-1949.06 26606.92,-1944.77"/>
</g>
<!-- layer1_expert1_10&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge404" class="edge">
<title>layer1_expert1_10&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M26757.78,-1979.01C26754.65,-1977.65 26751.55,-1976.31 26748.5,-1975 26724.21,-1964.55 26698.03,-1953.45 26673.31,-1943.04"/>
<polygon fill="black" stroke="black" points="26674.49,-1939.74 26663.91,-1939.09 26671.78,-1946.19 26674.49,-1939.74"/>
</g>
<!-- layer1_expert1_11&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge405" class="edge">
<title>layer1_expert1_11&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M26940.81,-1978.15C26937.68,-1977.04 26934.57,-1975.99 26931.5,-1975 26848.34,-1948.3 26751.46,-1928.5 26678.42,-1915.74"/>
<polygon fill="black" stroke="black" points="26678.73,-1912.24 26668.28,-1913.98 26677.54,-1919.13 26678.73,-1912.24"/>
</g>
<!-- layer1_expert1_12&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge406" class="edge">
<title>layer1_expert1_12&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M27123.89,-1977.88C27120.74,-1976.85 27117.61,-1975.88 27114.5,-1975 26967.09,-1933.14 26790.61,-1913.74 26678.53,-1905.07"/>
<polygon fill="black" stroke="black" points="26678.46,-1901.55 26668.22,-1904.29 26677.93,-1908.53 26678.46,-1901.55"/>
</g>
<!-- layer1_expert1_13&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge407" class="edge">
<title>layer1_expert1_13&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M27306.93,-1977.74C27303.77,-1976.75 27300.62,-1975.83 27297.5,-1975 27083.42,-1918.17 26823.57,-1903.24 26678.44,-1899.51"/>
<polygon fill="black" stroke="black" points="26678.28,-1896.01 26668.2,-1899.26 26678.11,-1903 26678.28,-1896.01"/>
</g>
<!-- layer1_expert1_14&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge408" class="edge">
<title>layer1_expert1_14&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M27489.95,-1977.66C27486.79,-1976.69 27483.63,-1975.8 27480.5,-1975 27331.61,-1937.12 26887.87,-1912.88 26678.37,-1903.24"/>
<polygon fill="black" stroke="black" points="26678.42,-1899.74 26668.27,-1902.78 26678.1,-1906.73 26678.42,-1899.74"/>
</g>
<!-- layer1_expert1_15&#45;&gt;layer1_moe_agg_gpu1 -->
<g id="edge409" class="edge">
<title>layer1_expert1_15&#45;&gt;layer1_moe_agg_gpu1</title>
<path fill="none" stroke="black" d="M27672.96,-1977.6C27669.8,-1976.65 27666.63,-1975.77 27663.5,-1975 27479.18,-1929.47 26919.1,-1908.51 26678.4,-1901.43"/>
<polygon fill="black" stroke="black" points="26678.32,-1897.92 26668.22,-1901.13 26678.12,-1904.92 26678.32,-1897.92"/>
</g>
<!-- layer1_output_gpu1 -->
<g id="node234" class="node">
<title>layer1_output_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="33149.5,-1614 32905.5,-1614 32905.5,-1546 33149.5,-1546 33149.5,-1614"/>
<text text-anchor="middle" x="33027.5" y="-1598.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU1</text>
<text text-anchor="middle" x="33027.5" y="-1583.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="33027.5" y="-1568.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33027.5" y="-1553.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_moe_agg_gpu1&#45;&gt;layer1_output_gpu1 -->
<g id="edge410" class="edge">
<title>layer1_moe_agg_gpu1&#45;&gt;layer1_output_gpu1</title>
<path fill="none" stroke="black" d="M26668.24,-1893.46C26965.37,-1884.41 27857.6,-1856.03 28597.5,-1820 29610.1,-1770.7 29861.46,-1723.25 30874.5,-1684 31099.03,-1675.3 32678.52,-1702.56 32896.5,-1648 32920.78,-1641.92 32945.67,-1630.68 32967.15,-1619.11"/>
<polygon fill="black" stroke="black" points="32969.07,-1622.05 32976.13,-1614.15 32965.68,-1615.93 32969.07,-1622.05"/>
</g>
<!-- layer1_moe_agg_gpu1&#45;&gt;layer1_allreduce_moe -->
<g id="edge639" class="edge">
<title>layer1_moe_agg_gpu1&#45;&gt;layer1_allreduce_moe</title>
<path fill="none" stroke="black" d="M26668.27,-1894.89C27143.7,-1887.31 29193.64,-1854.17 30874.5,-1820 31902,-1799.11 33132.34,-1769.41 33603.64,-1757.86"/>
<polygon fill="black" stroke="black" points="33604.03,-1761.35 33613.94,-1757.6 33603.86,-1754.35 33604.03,-1761.35"/>
</g>
<!-- layer1_output_gpu1&#45;&gt;pipeline_stage0_1 -->
<g id="edge666" class="edge">
<title>layer1_output_gpu1&#45;&gt;pipeline_stage0_1</title>
<path fill="none" stroke="black" d="M33083.69,-1545.9C33106.31,-1533.75 33133.03,-1520.82 33158.5,-1512 33272.65,-1472.46 33406.34,-1446.49 33510.12,-1430.52"/>
<polygon fill="black" stroke="black" points="33510.71,-1433.97 33520.07,-1429 33509.65,-1427.05 33510.71,-1433.97"/>
</g>
<!-- layer1_qkv_gpu2 -->
<g id="node235" class="node">
<title>layer1_qkv_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="33416.5,-2908 33206.5,-2908 33206.5,-2810 33416.5,-2810 33416.5,-2908"/>
<text text-anchor="middle" x="33311.5" y="-2892.8" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU2</text>
<text text-anchor="middle" x="33311.5" y="-2877.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="33311.5" y="-2862.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="33311.5" y="-2847.8" font-family="Times,serif" font-size="14.00">Heads: 8&#45;11</text>
<text text-anchor="middle" x="33311.5" y="-2832.8" font-family="Times,serif" font-size="14.00">TP Slice: 2</text>
<text text-anchor="middle" x="33311.5" y="-2817.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_attn_gpu2 -->
<g id="node236" class="node">
<title>layer1_attn_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="33433,-2766.5 33190,-2766.5 33190,-2683.5 33433,-2683.5 33433,-2766.5"/>
<text text-anchor="middle" x="33311.5" y="-2751.3" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU2</text>
<text text-anchor="middle" x="33311.5" y="-2736.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="33311.5" y="-2721.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33311.5" y="-2706.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="33311.5" y="-2691.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_qkv_gpu2&#45;&gt;layer1_attn_gpu2 -->
<g id="edge411" class="edge">
<title>layer1_qkv_gpu2&#45;&gt;layer1_attn_gpu2</title>
<path fill="none" stroke="black" d="M33311.5,-2809.97C33311.5,-2799.25 33311.5,-2787.84 33311.5,-2776.99"/>
<polygon fill="black" stroke="black" points="33315,-2776.82 33311.5,-2766.82 33308,-2776.82 33315,-2776.82"/>
</g>
<!-- layer1_attn_proj_gpu2 -->
<g id="node237" class="node">
<title>layer1_attn_proj_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="33411.5,-2632.5 33211.5,-2632.5 33211.5,-2564.5 33411.5,-2564.5 33411.5,-2632.5"/>
<text text-anchor="middle" x="33311.5" y="-2617.3" font-family="Times,serif" font-size="14.00">L1_Attn_Projection_GPU2</text>
<text text-anchor="middle" x="33311.5" y="-2602.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="33311.5" y="-2587.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33311.5" y="-2572.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_attn_gpu2&#45;&gt;layer1_attn_proj_gpu2 -->
<g id="edge412" class="edge">
<title>layer1_attn_gpu2&#45;&gt;layer1_attn_proj_gpu2</title>
<path fill="none" stroke="black" d="M33311.5,-2683.23C33311.5,-2670.36 33311.5,-2656.1 33311.5,-2643.04"/>
<polygon fill="black" stroke="black" points="33315,-2642.88 33311.5,-2632.88 33308,-2642.88 33315,-2642.88"/>
</g>
<!-- layer1_attn_norm_gpu2 -->
<g id="node238" class="node">
<title>layer1_attn_norm_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="33431.5,-2315 33187.5,-2315 33187.5,-2247 33431.5,-2247 33431.5,-2315"/>
<text text-anchor="middle" x="33309.5" y="-2299.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU2</text>
<text text-anchor="middle" x="33309.5" y="-2284.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="33309.5" y="-2269.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33309.5" y="-2254.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_attn_proj_gpu2&#45;&gt;layer1_attn_norm_gpu2 -->
<g id="edge413" class="edge">
<title>layer1_attn_proj_gpu2&#45;&gt;layer1_attn_norm_gpu2</title>
<path fill="none" stroke="black" d="M33311.29,-2564.33C33310.93,-2506.93 33310.18,-2389.12 33309.77,-2325.33"/>
<polygon fill="black" stroke="black" points="33313.27,-2325.17 33309.71,-2315.2 33306.27,-2325.22 33313.27,-2325.17"/>
</g>
<!-- layer1_attn_proj_gpu2&#45;&gt;layer1_allreduce_attn -->
<g id="edge641" class="edge">
<title>layer1_attn_proj_gpu2&#45;&gt;layer1_allreduce_attn</title>
<path fill="none" stroke="black" d="M33401.69,-2564.4C33460.03,-2542.99 33536.2,-2515.03 33597.29,-2492.61"/>
<polygon fill="black" stroke="black" points="33598.78,-2495.79 33606.96,-2489.06 33596.37,-2489.22 33598.78,-2495.79"/>
</g>
<!-- layer1_gate_gpu2 -->
<g id="node239" class="node">
<title>layer1_gate_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="29524.5,-2177 29280.5,-2177 29280.5,-2094 29524.5,-2094 29524.5,-2177"/>
<text text-anchor="middle" x="29402.5" y="-2161.8" font-family="Times,serif" font-size="14.00">L1_Gate_GPU2</text>
<text text-anchor="middle" x="29402.5" y="-2146.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="29402.5" y="-2131.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="29402.5" y="-2116.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="29402.5" y="-2101.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_attn_norm_gpu2&#45;&gt;layer1_gate_gpu2 -->
<g id="edge414" class="edge">
<title>layer1_attn_norm_gpu2&#45;&gt;layer1_gate_gpu2</title>
<path fill="none" stroke="black" d="M33258.12,-2246.88C33234.79,-2233.68 33206.25,-2219.98 33178.5,-2213 33088.36,-2190.32 30194.05,-2147.78 29535.1,-2138.37"/>
<polygon fill="black" stroke="black" points="29534.67,-2134.87 29524.62,-2138.22 29534.57,-2141.87 29534.67,-2134.87"/>
</g>
<!-- layer1_expert2_0 -->
<g id="node240" class="node">
<title>layer1_expert2_0</title>
<polygon fill="lightgreen" stroke="black" points="28021,-2058 27856,-2058 27856,-1975 28021,-1975 28021,-2058"/>
<text text-anchor="middle" x="27938.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU2</text>
<text text-anchor="middle" x="27938.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="27938.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="27938.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="27938.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_0 -->
<g id="edge415" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29280.34,-2133.34C28993.75,-2129.72 28284,-2115.31 28031.02,-2058.07"/>
<polygon fill="black" stroke="black" points="28031.67,-2054.63 28021.13,-2055.76 28030.07,-2061.44 28031.67,-2054.63"/>
</g>
<!-- layer1_expert2_1 -->
<g id="node241" class="node">
<title>layer1_expert2_1</title>
<polygon fill="lightgreen" stroke="black" points="28204,-2058 28039,-2058 28039,-1975 28204,-1975 28204,-2058"/>
<text text-anchor="middle" x="28121.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU2</text>
<text text-anchor="middle" x="28121.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="28121.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="28121.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="28121.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_1 -->
<g id="edge416" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29280.05,-2132.1C29022.44,-2126.18 28431,-2107.75 28214.18,-2058.11"/>
<polygon fill="black" stroke="black" points="28214.68,-2054.63 28204.14,-2055.73 28213.06,-2061.44 28214.68,-2054.63"/>
</g>
<!-- layer1_expert2_2 -->
<g id="node242" class="node">
<title>layer1_expert2_2</title>
<polygon fill="lightgreen" stroke="black" points="28387,-2058 28222,-2058 28222,-1975 28387,-1975 28387,-2058"/>
<text text-anchor="middle" x="28304.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU2</text>
<text text-anchor="middle" x="28304.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="28304.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="28304.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="28304.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_2 -->
<g id="edge417" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29280.26,-2130.44C29054.14,-2122.08 28577.86,-2100.29 28397.08,-2058.1"/>
<polygon fill="black" stroke="black" points="28397.69,-2054.65 28387.15,-2055.68 28396.04,-2061.45 28397.69,-2054.65"/>
</g>
<!-- layer1_expert2_3 -->
<g id="node243" class="node">
<title>layer1_expert2_3</title>
<polygon fill="lightgreen" stroke="black" points="28570,-2058 28405,-2058 28405,-1975 28570,-1975 28570,-2058"/>
<text text-anchor="middle" x="28487.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU2</text>
<text text-anchor="middle" x="28487.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="28487.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="28487.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="28487.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_3 -->
<g id="edge418" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29280.36,-2128.05C29088.78,-2117.12 28725.32,-2092.96 28580.23,-2058.15"/>
<polygon fill="black" stroke="black" points="28580.72,-2054.66 28570.17,-2055.62 28579.01,-2061.45 28580.72,-2054.66"/>
</g>
<!-- layer1_expert2_4 -->
<g id="node244" class="node">
<title>layer1_expert2_4</title>
<polygon fill="lightgreen" stroke="black" points="28753,-2058 28588,-2058 28588,-1975 28753,-1975 28753,-2058"/>
<text text-anchor="middle" x="28670.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU2</text>
<text text-anchor="middle" x="28670.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="28670.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="28670.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="28670.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_4 -->
<g id="edge419" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29280.21,-2130.77C29151.95,-2124.4 28945.18,-2107.17 28762.95,-2058.19"/>
<polygon fill="black" stroke="black" points="28763.76,-2054.78 28753.19,-2055.53 28761.92,-2061.53 28763.76,-2054.78"/>
</g>
<!-- layer1_expert2_5 -->
<g id="node245" class="node">
<title>layer1_expert2_5</title>
<polygon fill="lightgreen" stroke="black" points="28936,-2058 28771,-2058 28771,-1975 28936,-1975 28936,-2058"/>
<text text-anchor="middle" x="28853.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU2</text>
<text text-anchor="middle" x="28853.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="28853.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="28853.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="28853.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_5 -->
<g id="edge420" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29280.05,-2122.58C29189.24,-2111.76 29062.81,-2092.52 28946.06,-2058.28"/>
<polygon fill="black" stroke="black" points="28946.82,-2054.86 28936.24,-2055.36 28944.83,-2061.57 28946.82,-2054.86"/>
</g>
<!-- layer1_expert2_6 -->
<g id="node246" class="node">
<title>layer1_expert2_6</title>
<polygon fill="lightgreen" stroke="black" points="29119,-2058 28954,-2058 28954,-1975 29119,-1975 29119,-2058"/>
<text text-anchor="middle" x="29036.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU2</text>
<text text-anchor="middle" x="29036.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="29036.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="29036.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="29036.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_6 -->
<g id="edge421" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29280.47,-2104.69C29234.95,-2092.56 29182.87,-2077.48 29128.56,-2058.26"/>
<polygon fill="black" stroke="black" points="29129.71,-2054.96 29119.12,-2054.89 29127.35,-2061.55 29129.71,-2054.96"/>
</g>
<!-- layer1_expert2_7 -->
<g id="node247" class="node">
<title>layer1_expert2_7</title>
<polygon fill="lightgreen" stroke="black" points="29302,-2058 29137,-2058 29137,-1975 29302,-1975 29302,-2058"/>
<text text-anchor="middle" x="29219.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU2</text>
<text text-anchor="middle" x="29219.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="29219.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="29219.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="29219.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_7 -->
<g id="edge422" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29339.01,-2093.91C29323.68,-2084.11 29307.19,-2073.56 29291.5,-2063.53"/>
<polygon fill="black" stroke="black" points="29293.19,-2060.46 29282.88,-2058.02 29289.42,-2066.36 29293.19,-2060.46"/>
</g>
<!-- layer1_expert2_8 -->
<g id="node248" class="node">
<title>layer1_expert2_8</title>
<polygon fill="lightgreen" stroke="black" points="29485,-2058 29320,-2058 29320,-1975 29485,-1975 29485,-2058"/>
<text text-anchor="middle" x="29402.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU2</text>
<text text-anchor="middle" x="29402.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="29402.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="29402.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="29402.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_8 -->
<g id="edge423" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29402.5,-2093.91C29402.5,-2085.65 29402.5,-2076.86 29402.5,-2068.3"/>
<polygon fill="black" stroke="black" points="29406,-2068.02 29402.5,-2058.02 29399,-2068.02 29406,-2068.02"/>
</g>
<!-- layer1_expert2_9 -->
<g id="node249" class="node">
<title>layer1_expert2_9</title>
<polygon fill="lightgreen" stroke="black" points="29668,-2058 29503,-2058 29503,-1975 29668,-1975 29668,-2058"/>
<text text-anchor="middle" x="29585.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU2</text>
<text text-anchor="middle" x="29585.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="29585.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="29585.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="29585.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_9 -->
<g id="edge424" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29465.99,-2093.91C29481.32,-2084.11 29497.81,-2073.56 29513.5,-2063.53"/>
<polygon fill="black" stroke="black" points="29515.58,-2066.36 29522.12,-2058.02 29511.81,-2060.46 29515.58,-2066.36"/>
</g>
<!-- layer1_expert2_10 -->
<g id="node250" class="node">
<title>layer1_expert2_10</title>
<polygon fill="lightgreen" stroke="black" points="29851,-2058 29686,-2058 29686,-1975 29851,-1975 29851,-2058"/>
<text text-anchor="middle" x="29768.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU2</text>
<text text-anchor="middle" x="29768.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="29768.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="29768.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="29768.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_10 -->
<g id="edge425" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29524.72,-2104.37C29572.54,-2091.55 29627.55,-2075.51 29676.5,-2058 29676.6,-2057.97 29676.7,-2057.93 29676.79,-2057.9"/>
<polygon fill="black" stroke="black" points="29677.81,-2061.25 29685.97,-2054.49 29675.38,-2054.69 29677.81,-2061.25"/>
</g>
<!-- layer1_expert2_11 -->
<g id="node251" class="node">
<title>layer1_expert2_11</title>
<polygon fill="lightgreen" stroke="black" points="30034,-2058 29869,-2058 29869,-1975 30034,-1975 30034,-2058"/>
<text text-anchor="middle" x="29951.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU2</text>
<text text-anchor="middle" x="29951.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="29951.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="29951.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="29951.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_11 -->
<g id="edge426" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29524.64,-2122.42C29615.24,-2111.52 29741.39,-2092.25 29858.96,-2057.94"/>
<polygon fill="black" stroke="black" points="29860.26,-2061.2 29868.86,-2055.01 29858.28,-2054.49 29860.26,-2061.2"/>
</g>
<!-- layer1_expert2_12 -->
<g id="node252" class="node">
<title>layer1_expert2_12</title>
<polygon fill="lightgreen" stroke="black" points="30217,-2058 30052,-2058 30052,-1975 30217,-1975 30217,-2058"/>
<text text-anchor="middle" x="30134.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU2</text>
<text text-anchor="middle" x="30134.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="30134.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="30134.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="30134.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_12 -->
<g id="edge427" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29524.56,-2130.6C29652.59,-2124.1 29859.01,-2106.76 30042.11,-2057.85"/>
<polygon fill="black" stroke="black" points="30043.18,-2061.19 30051.91,-2055.2 30041.35,-2054.43 30043.18,-2061.19"/>
</g>
<!-- layer1_expert2_13 -->
<g id="node253" class="node">
<title>layer1_expert2_13</title>
<polygon fill="lightgreen" stroke="black" points="30400,-2058 30235,-2058 30235,-1975 30400,-1975 30400,-2058"/>
<text text-anchor="middle" x="30317.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU2</text>
<text text-anchor="middle" x="30317.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="30317.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="30317.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="30317.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_13 -->
<g id="edge428" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29524.87,-2127.96C29716.31,-2116.93 30078.9,-2092.64 30224.82,-2057.83"/>
<polygon fill="black" stroke="black" points="30226.09,-2061.12 30234.94,-2055.3 30224.39,-2054.33 30226.09,-2061.12"/>
</g>
<!-- layer1_expert2_14 -->
<g id="node254" class="node">
<title>layer1_expert2_14</title>
<polygon fill="lightgreen" stroke="black" points="30583,-2058 30418,-2058 30418,-1975 30583,-1975 30583,-2058"/>
<text text-anchor="middle" x="30500.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU2</text>
<text text-anchor="middle" x="30500.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="30500.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="30500.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="30500.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_14 -->
<g id="edge429" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29524.6,-2130.37C29750.48,-2121.9 30226.24,-2099.94 30407.97,-2057.78"/>
<polygon fill="black" stroke="black" points="30409.06,-2061.12 30417.96,-2055.37 30407.42,-2054.32 30409.06,-2061.12"/>
</g>
<!-- layer1_expert2_15 -->
<g id="node255" class="node">
<title>layer1_expert2_15</title>
<polygon fill="lightgreen" stroke="black" points="30766,-2058 30601,-2058 30601,-1975 30766,-1975 30766,-2058"/>
<text text-anchor="middle" x="30683.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU2</text>
<text text-anchor="middle" x="30683.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="30683.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="30683.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="30683.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gate_gpu2&#45;&gt;layer1_expert2_15 -->
<g id="edge430" class="edge">
<title>layer1_gate_gpu2&#45;&gt;layer1_expert2_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29524.83,-2132.04C29782.32,-2125.99 30373.68,-2107.3 30591.21,-2057.73"/>
<polygon fill="black" stroke="black" points="30592.04,-2061.13 30600.97,-2055.42 30590.43,-2054.31 30592.04,-2061.13"/>
</g>
<!-- layer1_moe_agg_gpu2 -->
<g id="node256" class="node">
<title>layer1_moe_agg_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="29596,-1939 29393,-1939 29393,-1856 29596,-1856 29596,-1939"/>
<text text-anchor="middle" x="29494.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU2</text>
<text text-anchor="middle" x="29494.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="29494.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="29494.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="29494.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_expert2_0&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge431" class="edge">
<title>layer1_expert2_0&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M28021.13,-1977.23C28023.93,-1976.41 28026.73,-1975.67 28029.5,-1975 28285.96,-1913.47 29086.3,-1901.43 29382.66,-1899.07"/>
<polygon fill="black" stroke="black" points="29383.02,-1902.57 29392.99,-1898.99 29382.96,-1895.57 29383.02,-1902.57"/>
</g>
<!-- layer1_expert2_1&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge432" class="edge">
<title>layer1_expert2_1&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M28204.14,-1977.26C28206.94,-1976.43 28209.73,-1975.68 28212.5,-1975 28432.92,-1921.25 29113.05,-1904.62 29382.7,-1900.05"/>
<polygon fill="black" stroke="black" points="29382.96,-1903.55 29392.9,-1899.88 29382.84,-1896.55 29382.96,-1903.55"/>
</g>
<!-- layer1_expert2_2&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge433" class="edge">
<title>layer1_expert2_2&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M28387.14,-1977.29C28389.94,-1976.46 28392.73,-1975.69 28395.5,-1975 28580.06,-1929.03 29141.21,-1908.31 29382.39,-1901.36"/>
<polygon fill="black" stroke="black" points="29382.68,-1904.85 29392.58,-1901.07 29382.48,-1897.86 29382.68,-1904.85"/>
</g>
<!-- layer1_expert2_3&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge434" class="edge">
<title>layer1_expert2_3&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M28570.16,-1977.34C28572.95,-1976.49 28575.74,-1975.71 28578.5,-1975 28727.74,-1936.73 29172.96,-1912.67 29382.77,-1903.16"/>
<polygon fill="black" stroke="black" points="29383.05,-1906.65 29392.88,-1902.7 29382.74,-1899.65 29383.05,-1906.65"/>
</g>
<!-- layer1_expert2_4&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge435" class="edge">
<title>layer1_expert2_4&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M28753.18,-1977.42C28755.96,-1976.55 28758.74,-1975.74 28761.5,-1975 28976.21,-1917.57 29237.02,-1902.86 29382.52,-1899.33"/>
<polygon fill="black" stroke="black" points="29382.88,-1902.82 29392.8,-1899.09 29382.72,-1895.82 29382.88,-1902.82"/>
</g>
<!-- layer1_expert2_5&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge436" class="edge">
<title>layer1_expert2_5&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M28936.21,-1977.54C28938.99,-1976.64 28941.76,-1975.78 28944.5,-1975 29092.74,-1932.62 29270.4,-1913.34 29382.88,-1904.83"/>
<polygon fill="black" stroke="black" points="29383.17,-1908.32 29392.89,-1904.09 29382.65,-1901.34 29383.17,-1908.32"/>
</g>
<!-- layer1_expert2_6&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge437" class="edge">
<title>layer1_expert2_6&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M29119.03,-1977.87C29121.87,-1976.86 29124.7,-1975.9 29127.5,-1975 29211.36,-1947.94 29309.16,-1928.11 29382.7,-1915.42"/>
<polygon fill="black" stroke="black" points="29383.65,-1918.81 29392.92,-1913.68 29382.47,-1911.91 29383.65,-1918.81"/>
</g>
<!-- layer1_expert2_7&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge438" class="edge">
<title>layer1_expert2_7&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M29302.29,-1978.55C29305.06,-1977.35 29307.8,-1976.16 29310.5,-1975 29334.87,-1964.51 29361.16,-1953.44 29386.02,-1943.08"/>
<polygon fill="black" stroke="black" points="29387.59,-1946.22 29395.48,-1939.14 29384.9,-1939.75 29387.59,-1946.22"/>
</g>
<!-- layer1_expert2_8&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge439" class="edge">
<title>layer1_expert2_8&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M29434.42,-1974.91C29441.48,-1965.92 29449.04,-1956.32 29456.32,-1947.05"/>
<polygon fill="black" stroke="black" points="29459.21,-1949.05 29462.64,-1939.02 29453.7,-1944.72 29459.21,-1949.05"/>
</g>
<!-- layer1_expert2_9&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge440" class="edge">
<title>layer1_expert2_9&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M29553.93,-1974.91C29546.94,-1965.92 29539.47,-1956.32 29532.26,-1947.05"/>
<polygon fill="black" stroke="black" points="29534.92,-1944.77 29526.02,-1939.02 29529.39,-1949.06 29534.92,-1944.77"/>
</g>
<!-- layer1_expert2_10&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge441" class="edge">
<title>layer1_expert2_10&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M29685.78,-1979.01C29682.65,-1977.65 29679.55,-1976.31 29676.5,-1975 29652.21,-1964.55 29626.03,-1953.45 29601.31,-1943.04"/>
<polygon fill="black" stroke="black" points="29602.49,-1939.74 29591.91,-1939.09 29599.78,-1946.19 29602.49,-1939.74"/>
</g>
<!-- layer1_expert2_11&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge442" class="edge">
<title>layer1_expert2_11&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M29868.81,-1978.15C29865.68,-1977.04 29862.57,-1975.99 29859.5,-1975 29776.34,-1948.3 29679.46,-1928.5 29606.42,-1915.74"/>
<polygon fill="black" stroke="black" points="29606.73,-1912.24 29596.28,-1913.98 29605.54,-1919.13 29606.73,-1912.24"/>
</g>
<!-- layer1_expert2_12&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge443" class="edge">
<title>layer1_expert2_12&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M30051.89,-1977.88C30048.74,-1976.85 30045.61,-1975.88 30042.5,-1975 29895.09,-1933.14 29718.61,-1913.74 29606.53,-1905.07"/>
<polygon fill="black" stroke="black" points="29606.46,-1901.55 29596.22,-1904.29 29605.93,-1908.53 29606.46,-1901.55"/>
</g>
<!-- layer1_expert2_13&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge444" class="edge">
<title>layer1_expert2_13&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M30234.93,-1977.74C30231.77,-1976.75 30228.62,-1975.83 30225.5,-1975 30011.42,-1918.17 29751.57,-1903.24 29606.44,-1899.51"/>
<polygon fill="black" stroke="black" points="29606.28,-1896.01 29596.2,-1899.26 29606.11,-1903 29606.28,-1896.01"/>
</g>
<!-- layer1_expert2_14&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge445" class="edge">
<title>layer1_expert2_14&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M30417.95,-1977.66C30414.79,-1976.69 30411.63,-1975.8 30408.5,-1975 30259.61,-1937.12 29815.87,-1912.88 29606.37,-1903.24"/>
<polygon fill="black" stroke="black" points="29606.42,-1899.74 29596.27,-1902.78 29606.1,-1906.73 29606.42,-1899.74"/>
</g>
<!-- layer1_expert2_15&#45;&gt;layer1_moe_agg_gpu2 -->
<g id="edge446" class="edge">
<title>layer1_expert2_15&#45;&gt;layer1_moe_agg_gpu2</title>
<path fill="none" stroke="black" d="M30600.96,-1977.6C30597.8,-1976.65 30594.63,-1975.77 30591.5,-1975 30407.18,-1929.47 29847.1,-1908.51 29606.4,-1901.43"/>
<polygon fill="black" stroke="black" points="29606.32,-1897.92 29596.22,-1901.13 29606.12,-1904.92 29606.32,-1897.92"/>
</g>
<!-- layer1_output_gpu2 -->
<g id="node257" class="node">
<title>layer1_output_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="33411.5,-1614 33167.5,-1614 33167.5,-1546 33411.5,-1546 33411.5,-1614"/>
<text text-anchor="middle" x="33289.5" y="-1598.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU2</text>
<text text-anchor="middle" x="33289.5" y="-1583.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="33289.5" y="-1568.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33289.5" y="-1553.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_moe_agg_gpu2&#45;&gt;layer1_output_gpu2 -->
<g id="edge447" class="edge">
<title>layer1_moe_agg_gpu2&#45;&gt;layer1_output_gpu2</title>
<path fill="none" stroke="black" d="M29596.25,-1891.55C29824.85,-1880.28 30396.52,-1851.24 30874.5,-1820 31001.48,-1811.7 33036,-1682.43 33158.5,-1648 33182.17,-1641.35 33206.56,-1630.23 33227.78,-1618.94"/>
<polygon fill="black" stroke="black" points="33229.56,-1621.95 33236.67,-1614.1 33226.21,-1615.81 33229.56,-1621.95"/>
</g>
<!-- layer1_moe_agg_gpu2&#45;&gt;layer1_allreduce_moe -->
<g id="edge643" class="edge">
<title>layer1_moe_agg_gpu2&#45;&gt;layer1_allreduce_moe</title>
<path fill="none" stroke="black" d="M29596,-1893.9C29945.23,-1884.89 31129.49,-1853.67 32107.5,-1820 32654.61,-1801.17 33300.98,-1774.31 33613.15,-1761.04"/>
<polygon fill="black" stroke="black" points="33613.36,-1764.54 33623.2,-1760.62 33613.06,-1757.55 33613.36,-1764.54"/>
</g>
<!-- layer1_output_gpu2&#45;&gt;pipeline_stage0_1 -->
<g id="edge667" class="edge">
<title>layer1_output_gpu2&#45;&gt;pipeline_stage0_1</title>
<path fill="none" stroke="black" d="M33351.2,-1545.87C33372.88,-1534.65 33397.56,-1522.34 33420.5,-1512 33456.34,-1495.84 33495.52,-1479.66 33532.4,-1465.08"/>
<polygon fill="black" stroke="black" points="33533.71,-1468.33 33541.73,-1461.41 33531.14,-1461.82 33533.71,-1468.33"/>
</g>
<!-- layer1_qkv_gpu3 -->
<g id="node258" class="node">
<title>layer1_qkv_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="33678.5,-2908 33468.5,-2908 33468.5,-2810 33678.5,-2810 33678.5,-2908"/>
<text text-anchor="middle" x="33573.5" y="-2892.8" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU3</text>
<text text-anchor="middle" x="33573.5" y="-2877.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="33573.5" y="-2862.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="33573.5" y="-2847.8" font-family="Times,serif" font-size="14.00">Heads: 12&#45;15</text>
<text text-anchor="middle" x="33573.5" y="-2832.8" font-family="Times,serif" font-size="14.00">TP Slice: 3</text>
<text text-anchor="middle" x="33573.5" y="-2817.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_attn_gpu3 -->
<g id="node259" class="node">
<title>layer1_attn_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="33695,-2766.5 33452,-2766.5 33452,-2683.5 33695,-2683.5 33695,-2766.5"/>
<text text-anchor="middle" x="33573.5" y="-2751.3" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU3</text>
<text text-anchor="middle" x="33573.5" y="-2736.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="33573.5" y="-2721.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33573.5" y="-2706.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="33573.5" y="-2691.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_qkv_gpu3&#45;&gt;layer1_attn_gpu3 -->
<g id="edge448" class="edge">
<title>layer1_qkv_gpu3&#45;&gt;layer1_attn_gpu3</title>
<path fill="none" stroke="black" d="M33573.5,-2809.97C33573.5,-2799.25 33573.5,-2787.84 33573.5,-2776.99"/>
<polygon fill="black" stroke="black" points="33577,-2776.82 33573.5,-2766.82 33570,-2776.82 33577,-2776.82"/>
</g>
<!-- layer1_attn_proj_gpu3 -->
<g id="node260" class="node">
<title>layer1_attn_proj_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="33673.5,-2632.5 33473.5,-2632.5 33473.5,-2564.5 33673.5,-2564.5 33673.5,-2632.5"/>
<text text-anchor="middle" x="33573.5" y="-2617.3" font-family="Times,serif" font-size="14.00">L1_Attn_Projection_GPU3</text>
<text text-anchor="middle" x="33573.5" y="-2602.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="33573.5" y="-2587.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33573.5" y="-2572.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_attn_gpu3&#45;&gt;layer1_attn_proj_gpu3 -->
<g id="edge449" class="edge">
<title>layer1_attn_gpu3&#45;&gt;layer1_attn_proj_gpu3</title>
<path fill="none" stroke="black" d="M33573.5,-2683.23C33573.5,-2670.36 33573.5,-2656.1 33573.5,-2643.04"/>
<polygon fill="black" stroke="black" points="33577,-2642.88 33573.5,-2632.88 33570,-2642.88 33577,-2642.88"/>
</g>
<!-- layer1_attn_norm_gpu3 -->
<g id="node261" class="node">
<title>layer1_attn_norm_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="33693.5,-2315 33449.5,-2315 33449.5,-2247 33693.5,-2247 33693.5,-2315"/>
<text text-anchor="middle" x="33571.5" y="-2299.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU3</text>
<text text-anchor="middle" x="33571.5" y="-2284.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="33571.5" y="-2269.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33571.5" y="-2254.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_attn_proj_gpu3&#45;&gt;layer1_attn_norm_gpu3 -->
<g id="edge450" class="edge">
<title>layer1_attn_proj_gpu3&#45;&gt;layer1_attn_norm_gpu3</title>
<path fill="none" stroke="black" d="M33524.3,-2564.25C33510.77,-2552.35 33497.82,-2537.69 33490.5,-2521 33466.24,-2465.64 33470.73,-2442.12 33490.5,-2385 33498.44,-2362.07 33513.82,-2340.37 33529.07,-2322.85"/>
<polygon fill="black" stroke="black" points="33531.95,-2324.88 33536.04,-2315.1 33526.75,-2320.2 33531.95,-2324.88"/>
</g>
<!-- layer1_attn_proj_gpu3&#45;&gt;layer1_allreduce_attn -->
<g id="edge645" class="edge">
<title>layer1_attn_proj_gpu3&#45;&gt;layer1_allreduce_attn</title>
<path fill="none" stroke="black" d="M33603.42,-2564.22C33616.97,-2549.14 33633.42,-2530.84 33648.99,-2513.53"/>
<polygon fill="black" stroke="black" points="33651.98,-2515.43 33656.06,-2505.65 33646.78,-2510.75 33651.98,-2515.43"/>
</g>
<!-- layer1_gate_gpu3 -->
<g id="node262" class="node">
<title>layer1_gate_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="32452.5,-2177 32208.5,-2177 32208.5,-2094 32452.5,-2094 32452.5,-2177"/>
<text text-anchor="middle" x="32330.5" y="-2161.8" font-family="Times,serif" font-size="14.00">L1_Gate_GPU3</text>
<text text-anchor="middle" x="32330.5" y="-2146.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="32330.5" y="-2131.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="32330.5" y="-2116.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="32330.5" y="-2101.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_attn_norm_gpu3&#45;&gt;layer1_gate_gpu3 -->
<g id="edge451" class="edge">
<title>layer1_attn_norm_gpu3&#45;&gt;layer1_gate_gpu3</title>
<path fill="none" stroke="black" d="M33519.01,-2246.99C33495.82,-2234.07 33467.7,-2220.55 33440.5,-2213 33260.13,-2162.93 32716.65,-2144.83 32463.25,-2138.99"/>
<polygon fill="black" stroke="black" points="32462.95,-2135.48 32452.88,-2138.75 32462.8,-2142.48 32462.95,-2135.48"/>
</g>
<!-- layer1_expert3_0 -->
<g id="node263" class="node">
<title>layer1_expert3_0</title>
<polygon fill="lightgreen" stroke="black" points="30949,-2058 30784,-2058 30784,-1975 30949,-1975 30949,-2058"/>
<text text-anchor="middle" x="30866.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU3</text>
<text text-anchor="middle" x="30866.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="30866.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="30866.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="30866.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_0 -->
<g id="edge452" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32208.34,-2133.34C31921.75,-2129.72 31212,-2115.31 30959.02,-2058.07"/>
<polygon fill="black" stroke="black" points="30959.67,-2054.63 30949.13,-2055.76 30958.07,-2061.44 30959.67,-2054.63"/>
</g>
<!-- layer1_expert3_1 -->
<g id="node264" class="node">
<title>layer1_expert3_1</title>
<polygon fill="lightgreen" stroke="black" points="31132,-2058 30967,-2058 30967,-1975 31132,-1975 31132,-2058"/>
<text text-anchor="middle" x="31049.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU3</text>
<text text-anchor="middle" x="31049.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="31049.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="31049.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="31049.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_1 -->
<g id="edge453" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32208.05,-2132.1C31950.44,-2126.18 31359,-2107.75 31142.18,-2058.11"/>
<polygon fill="black" stroke="black" points="31142.68,-2054.63 31132.14,-2055.73 31141.06,-2061.44 31142.68,-2054.63"/>
</g>
<!-- layer1_expert3_2 -->
<g id="node265" class="node">
<title>layer1_expert3_2</title>
<polygon fill="lightgreen" stroke="black" points="31315,-2058 31150,-2058 31150,-1975 31315,-1975 31315,-2058"/>
<text text-anchor="middle" x="31232.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU3</text>
<text text-anchor="middle" x="31232.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="31232.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="31232.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="31232.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_2 -->
<g id="edge454" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32208.26,-2130.44C31982.14,-2122.08 31505.86,-2100.29 31325.08,-2058.1"/>
<polygon fill="black" stroke="black" points="31325.69,-2054.65 31315.15,-2055.68 31324.04,-2061.45 31325.69,-2054.65"/>
</g>
<!-- layer1_expert3_3 -->
<g id="node266" class="node">
<title>layer1_expert3_3</title>
<polygon fill="lightgreen" stroke="black" points="31498,-2058 31333,-2058 31333,-1975 31498,-1975 31498,-2058"/>
<text text-anchor="middle" x="31415.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU3</text>
<text text-anchor="middle" x="31415.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="31415.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="31415.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="31415.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_3 -->
<g id="edge455" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32208.36,-2128.05C32016.78,-2117.12 31653.32,-2092.96 31508.23,-2058.15"/>
<polygon fill="black" stroke="black" points="31508.72,-2054.66 31498.17,-2055.62 31507.01,-2061.45 31508.72,-2054.66"/>
</g>
<!-- layer1_expert3_4 -->
<g id="node267" class="node">
<title>layer1_expert3_4</title>
<polygon fill="lightgreen" stroke="black" points="31681,-2058 31516,-2058 31516,-1975 31681,-1975 31681,-2058"/>
<text text-anchor="middle" x="31598.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU3</text>
<text text-anchor="middle" x="31598.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="31598.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="31598.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="31598.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_4 -->
<g id="edge456" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32208.21,-2130.77C32079.95,-2124.4 31873.18,-2107.17 31690.95,-2058.19"/>
<polygon fill="black" stroke="black" points="31691.76,-2054.78 31681.19,-2055.53 31689.92,-2061.53 31691.76,-2054.78"/>
</g>
<!-- layer1_expert3_5 -->
<g id="node268" class="node">
<title>layer1_expert3_5</title>
<polygon fill="lightgreen" stroke="black" points="31864,-2058 31699,-2058 31699,-1975 31864,-1975 31864,-2058"/>
<text text-anchor="middle" x="31781.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU3</text>
<text text-anchor="middle" x="31781.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="31781.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="31781.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="31781.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_5 -->
<g id="edge457" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32208.05,-2122.58C32117.24,-2111.76 31990.81,-2092.52 31874.06,-2058.28"/>
<polygon fill="black" stroke="black" points="31874.82,-2054.86 31864.24,-2055.36 31872.83,-2061.57 31874.82,-2054.86"/>
</g>
<!-- layer1_expert3_6 -->
<g id="node269" class="node">
<title>layer1_expert3_6</title>
<polygon fill="lightgreen" stroke="black" points="32047,-2058 31882,-2058 31882,-1975 32047,-1975 32047,-2058"/>
<text text-anchor="middle" x="31964.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU3</text>
<text text-anchor="middle" x="31964.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="31964.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="31964.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="31964.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_6 -->
<g id="edge458" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32208.47,-2104.69C32162.95,-2092.56 32110.87,-2077.48 32056.56,-2058.26"/>
<polygon fill="black" stroke="black" points="32057.71,-2054.96 32047.12,-2054.89 32055.35,-2061.55 32057.71,-2054.96"/>
</g>
<!-- layer1_expert3_7 -->
<g id="node270" class="node">
<title>layer1_expert3_7</title>
<polygon fill="lightgreen" stroke="black" points="32230,-2058 32065,-2058 32065,-1975 32230,-1975 32230,-2058"/>
<text text-anchor="middle" x="32147.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU3</text>
<text text-anchor="middle" x="32147.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="32147.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="32147.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="32147.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_7 -->
<g id="edge459" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32267.01,-2093.91C32251.68,-2084.11 32235.19,-2073.56 32219.5,-2063.53"/>
<polygon fill="black" stroke="black" points="32221.19,-2060.46 32210.88,-2058.02 32217.42,-2066.36 32221.19,-2060.46"/>
</g>
<!-- layer1_expert3_8 -->
<g id="node271" class="node">
<title>layer1_expert3_8</title>
<polygon fill="lightgreen" stroke="black" points="32413,-2058 32248,-2058 32248,-1975 32413,-1975 32413,-2058"/>
<text text-anchor="middle" x="32330.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU3</text>
<text text-anchor="middle" x="32330.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="32330.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="32330.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="32330.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_8 -->
<g id="edge460" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32330.5,-2093.91C32330.5,-2085.65 32330.5,-2076.86 32330.5,-2068.3"/>
<polygon fill="black" stroke="black" points="32334,-2068.02 32330.5,-2058.02 32327,-2068.02 32334,-2068.02"/>
</g>
<!-- layer1_expert3_9 -->
<g id="node272" class="node">
<title>layer1_expert3_9</title>
<polygon fill="lightgreen" stroke="black" points="32596,-2058 32431,-2058 32431,-1975 32596,-1975 32596,-2058"/>
<text text-anchor="middle" x="32513.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU3</text>
<text text-anchor="middle" x="32513.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="32513.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="32513.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="32513.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_9 -->
<g id="edge461" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32393.99,-2093.91C32409.32,-2084.11 32425.81,-2073.56 32441.5,-2063.53"/>
<polygon fill="black" stroke="black" points="32443.58,-2066.36 32450.12,-2058.02 32439.81,-2060.46 32443.58,-2066.36"/>
</g>
<!-- layer1_expert3_10 -->
<g id="node273" class="node">
<title>layer1_expert3_10</title>
<polygon fill="lightgreen" stroke="black" points="32779,-2058 32614,-2058 32614,-1975 32779,-1975 32779,-2058"/>
<text text-anchor="middle" x="32696.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU3</text>
<text text-anchor="middle" x="32696.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="32696.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="32696.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="32696.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_10 -->
<g id="edge462" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32452.72,-2104.37C32500.54,-2091.55 32555.55,-2075.51 32604.5,-2058 32604.6,-2057.97 32604.7,-2057.93 32604.79,-2057.9"/>
<polygon fill="black" stroke="black" points="32605.81,-2061.25 32613.97,-2054.49 32603.38,-2054.69 32605.81,-2061.25"/>
</g>
<!-- layer1_expert3_11 -->
<g id="node274" class="node">
<title>layer1_expert3_11</title>
<polygon fill="lightgreen" stroke="black" points="32962,-2058 32797,-2058 32797,-1975 32962,-1975 32962,-2058"/>
<text text-anchor="middle" x="32879.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU3</text>
<text text-anchor="middle" x="32879.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="32879.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="32879.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="32879.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_11 -->
<g id="edge463" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32452.64,-2122.42C32543.24,-2111.52 32669.39,-2092.25 32786.96,-2057.94"/>
<polygon fill="black" stroke="black" points="32788.26,-2061.2 32796.86,-2055.01 32786.28,-2054.49 32788.26,-2061.2"/>
</g>
<!-- layer1_expert3_12 -->
<g id="node275" class="node">
<title>layer1_expert3_12</title>
<polygon fill="lightgreen" stroke="black" points="33145,-2058 32980,-2058 32980,-1975 33145,-1975 33145,-2058"/>
<text text-anchor="middle" x="33062.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU3</text>
<text text-anchor="middle" x="33062.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="33062.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="33062.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="33062.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_12 -->
<g id="edge464" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32452.56,-2130.6C32580.59,-2124.1 32787.01,-2106.76 32970.11,-2057.85"/>
<polygon fill="black" stroke="black" points="32971.18,-2061.19 32979.91,-2055.2 32969.35,-2054.43 32971.18,-2061.19"/>
</g>
<!-- layer1_expert3_13 -->
<g id="node276" class="node">
<title>layer1_expert3_13</title>
<polygon fill="lightgreen" stroke="black" points="33328,-2058 33163,-2058 33163,-1975 33328,-1975 33328,-2058"/>
<text text-anchor="middle" x="33245.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU3</text>
<text text-anchor="middle" x="33245.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="33245.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="33245.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="33245.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_13 -->
<g id="edge465" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32452.87,-2127.96C32644.31,-2116.93 33006.9,-2092.64 33152.82,-2057.83"/>
<polygon fill="black" stroke="black" points="33154.09,-2061.12 33162.94,-2055.3 33152.39,-2054.33 33154.09,-2061.12"/>
</g>
<!-- layer1_expert3_14 -->
<g id="node277" class="node">
<title>layer1_expert3_14</title>
<polygon fill="lightgreen" stroke="black" points="33511,-2058 33346,-2058 33346,-1975 33511,-1975 33511,-2058"/>
<text text-anchor="middle" x="33428.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU3</text>
<text text-anchor="middle" x="33428.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="33428.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="33428.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="33428.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_14 -->
<g id="edge466" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32452.6,-2130.37C32678.48,-2121.9 33154.24,-2099.94 33335.97,-2057.78"/>
<polygon fill="black" stroke="black" points="33337.06,-2061.12 33345.96,-2055.37 33335.42,-2054.32 33337.06,-2061.12"/>
</g>
<!-- layer1_expert3_15 -->
<g id="node278" class="node">
<title>layer1_expert3_15</title>
<polygon fill="lightgreen" stroke="black" points="33694,-2058 33529,-2058 33529,-1975 33694,-1975 33694,-2058"/>
<text text-anchor="middle" x="33611.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU3</text>
<text text-anchor="middle" x="33611.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="33611.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="33611.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="33611.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gate_gpu3&#45;&gt;layer1_expert3_15 -->
<g id="edge467" class="edge">
<title>layer1_gate_gpu3&#45;&gt;layer1_expert3_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32452.83,-2132.04C32710.32,-2125.99 33301.68,-2107.3 33519.21,-2057.73"/>
<polygon fill="black" stroke="black" points="33520.04,-2061.13 33528.97,-2055.42 33518.43,-2054.31 33520.04,-2061.13"/>
</g>
<!-- layer1_moe_agg_gpu3 -->
<g id="node279" class="node">
<title>layer1_moe_agg_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="32524,-1939 32321,-1939 32321,-1856 32524,-1856 32524,-1939"/>
<text text-anchor="middle" x="32422.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU3</text>
<text text-anchor="middle" x="32422.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="32422.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="32422.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="32422.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_expert3_0&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge468" class="edge">
<title>layer1_expert3_0&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M30949.13,-1977.23C30951.93,-1976.41 30954.73,-1975.67 30957.5,-1975 31213.96,-1913.47 32014.3,-1901.43 32310.66,-1899.07"/>
<polygon fill="black" stroke="black" points="32311.02,-1902.57 32320.99,-1898.99 32310.96,-1895.57 32311.02,-1902.57"/>
</g>
<!-- layer1_expert3_1&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge469" class="edge">
<title>layer1_expert3_1&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M31132.14,-1977.26C31134.94,-1976.43 31137.73,-1975.68 31140.5,-1975 31360.92,-1921.25 32041.05,-1904.62 32310.7,-1900.05"/>
<polygon fill="black" stroke="black" points="32310.96,-1903.55 32320.9,-1899.88 32310.84,-1896.55 32310.96,-1903.55"/>
</g>
<!-- layer1_expert3_2&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge470" class="edge">
<title>layer1_expert3_2&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M31315.14,-1977.29C31317.94,-1976.46 31320.73,-1975.69 31323.5,-1975 31508.06,-1929.03 32069.21,-1908.31 32310.39,-1901.36"/>
<polygon fill="black" stroke="black" points="32310.68,-1904.85 32320.58,-1901.07 32310.48,-1897.86 32310.68,-1904.85"/>
</g>
<!-- layer1_expert3_3&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge471" class="edge">
<title>layer1_expert3_3&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M31498.16,-1977.34C31500.95,-1976.49 31503.74,-1975.71 31506.5,-1975 31655.74,-1936.73 32100.96,-1912.67 32310.77,-1903.16"/>
<polygon fill="black" stroke="black" points="32311.05,-1906.65 32320.88,-1902.7 32310.74,-1899.65 32311.05,-1906.65"/>
</g>
<!-- layer1_expert3_4&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge472" class="edge">
<title>layer1_expert3_4&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M31681.18,-1977.42C31683.96,-1976.55 31686.74,-1975.74 31689.5,-1975 31904.21,-1917.57 32165.02,-1902.86 32310.52,-1899.33"/>
<polygon fill="black" stroke="black" points="32310.88,-1902.82 32320.8,-1899.09 32310.72,-1895.82 32310.88,-1902.82"/>
</g>
<!-- layer1_expert3_5&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge473" class="edge">
<title>layer1_expert3_5&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M31864.21,-1977.54C31866.99,-1976.64 31869.76,-1975.78 31872.5,-1975 32020.74,-1932.62 32198.4,-1913.34 32310.88,-1904.83"/>
<polygon fill="black" stroke="black" points="32311.17,-1908.32 32320.89,-1904.09 32310.65,-1901.34 32311.17,-1908.32"/>
</g>
<!-- layer1_expert3_6&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge474" class="edge">
<title>layer1_expert3_6&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M32047.03,-1977.87C32049.87,-1976.86 32052.7,-1975.9 32055.5,-1975 32139.36,-1947.94 32237.16,-1928.11 32310.7,-1915.42"/>
<polygon fill="black" stroke="black" points="32311.65,-1918.81 32320.92,-1913.68 32310.47,-1911.91 32311.65,-1918.81"/>
</g>
<!-- layer1_expert3_7&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge475" class="edge">
<title>layer1_expert3_7&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M32230.29,-1978.55C32233.06,-1977.35 32235.8,-1976.16 32238.5,-1975 32262.87,-1964.51 32289.16,-1953.44 32314.02,-1943.08"/>
<polygon fill="black" stroke="black" points="32315.59,-1946.22 32323.48,-1939.14 32312.9,-1939.75 32315.59,-1946.22"/>
</g>
<!-- layer1_expert3_8&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge476" class="edge">
<title>layer1_expert3_8&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M32362.42,-1974.91C32369.48,-1965.92 32377.04,-1956.32 32384.32,-1947.05"/>
<polygon fill="black" stroke="black" points="32387.21,-1949.05 32390.64,-1939.02 32381.7,-1944.72 32387.21,-1949.05"/>
</g>
<!-- layer1_expert3_9&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge477" class="edge">
<title>layer1_expert3_9&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M32481.93,-1974.91C32474.94,-1965.92 32467.47,-1956.32 32460.26,-1947.05"/>
<polygon fill="black" stroke="black" points="32462.92,-1944.77 32454.02,-1939.02 32457.39,-1949.06 32462.92,-1944.77"/>
</g>
<!-- layer1_expert3_10&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge478" class="edge">
<title>layer1_expert3_10&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M32613.78,-1979.01C32610.65,-1977.65 32607.55,-1976.31 32604.5,-1975 32580.21,-1964.55 32554.03,-1953.45 32529.31,-1943.04"/>
<polygon fill="black" stroke="black" points="32530.49,-1939.74 32519.91,-1939.09 32527.78,-1946.19 32530.49,-1939.74"/>
</g>
<!-- layer1_expert3_11&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge479" class="edge">
<title>layer1_expert3_11&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M32796.81,-1978.15C32793.68,-1977.04 32790.57,-1975.99 32787.5,-1975 32704.34,-1948.3 32607.46,-1928.5 32534.42,-1915.74"/>
<polygon fill="black" stroke="black" points="32534.73,-1912.24 32524.28,-1913.98 32533.54,-1919.13 32534.73,-1912.24"/>
</g>
<!-- layer1_expert3_12&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge480" class="edge">
<title>layer1_expert3_12&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M32979.89,-1977.88C32976.74,-1976.85 32973.61,-1975.88 32970.5,-1975 32823.09,-1933.14 32646.61,-1913.74 32534.53,-1905.07"/>
<polygon fill="black" stroke="black" points="32534.46,-1901.55 32524.22,-1904.29 32533.93,-1908.53 32534.46,-1901.55"/>
</g>
<!-- layer1_expert3_13&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge481" class="edge">
<title>layer1_expert3_13&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M33162.93,-1977.74C33159.77,-1976.75 33156.62,-1975.83 33153.5,-1975 32939.42,-1918.17 32679.57,-1903.24 32534.44,-1899.51"/>
<polygon fill="black" stroke="black" points="32534.28,-1896.01 32524.2,-1899.26 32534.11,-1903 32534.28,-1896.01"/>
</g>
<!-- layer1_expert3_14&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge482" class="edge">
<title>layer1_expert3_14&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M33345.95,-1977.66C33342.79,-1976.69 33339.63,-1975.8 33336.5,-1975 33187.61,-1937.12 32743.87,-1912.88 32534.37,-1903.24"/>
<polygon fill="black" stroke="black" points="32534.42,-1899.74 32524.27,-1902.78 32534.1,-1906.73 32534.42,-1899.74"/>
</g>
<!-- layer1_expert3_15&#45;&gt;layer1_moe_agg_gpu3 -->
<g id="edge483" class="edge">
<title>layer1_expert3_15&#45;&gt;layer1_moe_agg_gpu3</title>
<path fill="none" stroke="black" d="M33528.96,-1977.6C33525.8,-1976.65 33522.63,-1975.77 33519.5,-1975 33335.18,-1929.47 32775.1,-1908.51 32534.4,-1901.43"/>
<polygon fill="black" stroke="black" points="32534.32,-1897.92 32524.22,-1901.13 32534.12,-1904.92 32534.32,-1897.92"/>
</g>
<!-- layer1_output_gpu3 -->
<g id="node280" class="node">
<title>layer1_output_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="33673.5,-1614 33429.5,-1614 33429.5,-1546 33673.5,-1546 33673.5,-1614"/>
<text text-anchor="middle" x="33551.5" y="-1598.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU3</text>
<text text-anchor="middle" x="33551.5" y="-1583.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="33551.5" y="-1568.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33551.5" y="-1553.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_moe_agg_gpu3&#45;&gt;layer1_output_gpu3 -->
<g id="edge484" class="edge">
<title>layer1_moe_agg_gpu3&#45;&gt;layer1_output_gpu3</title>
<path fill="none" stroke="black" d="M32524.31,-1879.13C32707.47,-1846.14 33103.01,-1766.92 33420.5,-1648 33441.97,-1639.96 33464.49,-1629.32 33484.68,-1618.89"/>
<polygon fill="black" stroke="black" points="33486.55,-1621.87 33493.78,-1614.13 33483.3,-1615.67 33486.55,-1621.87"/>
</g>
<!-- layer1_moe_agg_gpu3&#45;&gt;layer1_allreduce_moe -->
<g id="edge647" class="edge">
<title>layer1_moe_agg_gpu3&#45;&gt;layer1_allreduce_moe</title>
<path fill="none" stroke="black" d="M32524.11,-1885.92C32760.73,-1861.28 33350.22,-1799.89 33637.7,-1769.95"/>
<polygon fill="black" stroke="black" points="33638.21,-1773.42 33647.79,-1768.9 33637.48,-1766.46 33638.21,-1773.42"/>
</g>
<!-- layer1_output_gpu3&#45;&gt;pipeline_stage0_1 -->
<g id="edge668" class="edge">
<title>layer1_output_gpu3&#45;&gt;pipeline_stage0_1</title>
<path fill="none" stroke="black" d="M33577.07,-1545.82C33590.6,-1528.25 33607.82,-1505.92 33624.39,-1484.41"/>
<polygon fill="black" stroke="black" points="33627.37,-1486.27 33630.7,-1476.22 33621.83,-1482 33627.37,-1486.27"/>
</g>
<!-- layer1_qkv_gpu4 -->
<g id="node281" class="node">
<title>layer1_qkv_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="33939.5,-2908 33729.5,-2908 33729.5,-2810 33939.5,-2810 33939.5,-2908"/>
<text text-anchor="middle" x="33834.5" y="-2892.8" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU4</text>
<text text-anchor="middle" x="33834.5" y="-2877.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="33834.5" y="-2862.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="33834.5" y="-2847.8" font-family="Times,serif" font-size="14.00">Heads: 16&#45;19</text>
<text text-anchor="middle" x="33834.5" y="-2832.8" font-family="Times,serif" font-size="14.00">TP Slice: 4</text>
<text text-anchor="middle" x="33834.5" y="-2817.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_attn_gpu4 -->
<g id="node282" class="node">
<title>layer1_attn_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="33956,-2766.5 33713,-2766.5 33713,-2683.5 33956,-2683.5 33956,-2766.5"/>
<text text-anchor="middle" x="33834.5" y="-2751.3" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU4</text>
<text text-anchor="middle" x="33834.5" y="-2736.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="33834.5" y="-2721.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33834.5" y="-2706.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="33834.5" y="-2691.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_qkv_gpu4&#45;&gt;layer1_attn_gpu4 -->
<g id="edge485" class="edge">
<title>layer1_qkv_gpu4&#45;&gt;layer1_attn_gpu4</title>
<path fill="none" stroke="black" d="M33834.5,-2809.97C33834.5,-2799.25 33834.5,-2787.84 33834.5,-2776.99"/>
<polygon fill="black" stroke="black" points="33838,-2776.82 33834.5,-2766.82 33831,-2776.82 33838,-2776.82"/>
</g>
<!-- layer1_attn_proj_gpu4 -->
<g id="node283" class="node">
<title>layer1_attn_proj_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="33934.5,-2632.5 33734.5,-2632.5 33734.5,-2564.5 33934.5,-2564.5 33934.5,-2632.5"/>
<text text-anchor="middle" x="33834.5" y="-2617.3" font-family="Times,serif" font-size="14.00">L1_Attn_Projection_GPU4</text>
<text text-anchor="middle" x="33834.5" y="-2602.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="33834.5" y="-2587.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33834.5" y="-2572.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_attn_gpu4&#45;&gt;layer1_attn_proj_gpu4 -->
<g id="edge486" class="edge">
<title>layer1_attn_gpu4&#45;&gt;layer1_attn_proj_gpu4</title>
<path fill="none" stroke="black" d="M33834.5,-2683.23C33834.5,-2670.36 33834.5,-2656.1 33834.5,-2643.04"/>
<polygon fill="black" stroke="black" points="33838,-2642.88 33834.5,-2632.88 33831,-2642.88 33838,-2642.88"/>
</g>
<!-- layer1_attn_norm_gpu4 -->
<g id="node284" class="node">
<title>layer1_attn_norm_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="33955.5,-2315 33711.5,-2315 33711.5,-2247 33955.5,-2247 33955.5,-2315"/>
<text text-anchor="middle" x="33833.5" y="-2299.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU4</text>
<text text-anchor="middle" x="33833.5" y="-2284.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="33833.5" y="-2269.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33833.5" y="-2254.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_attn_proj_gpu4&#45;&gt;layer1_attn_norm_gpu4 -->
<g id="edge487" class="edge">
<title>layer1_attn_proj_gpu4&#45;&gt;layer1_attn_norm_gpu4</title>
<path fill="none" stroke="black" d="M33881.53,-2564.32C33894.73,-2552.34 33907.4,-2537.61 33914.5,-2521 33938.25,-2465.42 33934.27,-2442.12 33914.5,-2385 33906.56,-2362.07 33891.18,-2340.37 33875.93,-2322.85"/>
<polygon fill="black" stroke="black" points="33878.25,-2320.2 33868.96,-2315.1 33873.05,-2324.88 33878.25,-2320.2"/>
</g>
<!-- layer1_attn_proj_gpu4&#45;&gt;layer1_allreduce_attn -->
<g id="edge649" class="edge">
<title>layer1_attn_proj_gpu4&#45;&gt;layer1_allreduce_attn</title>
<path fill="none" stroke="black" d="M33803.88,-2564.22C33789.82,-2548.93 33772.72,-2530.34 33756.6,-2512.81"/>
<polygon fill="black" stroke="black" points="33759.1,-2510.37 33749.76,-2505.38 33753.95,-2515.11 33759.1,-2510.37"/>
</g>
<!-- layer1_gate_gpu4 -->
<g id="node285" class="node">
<title>layer1_gate_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="35197.5,-2177 34953.5,-2177 34953.5,-2094 35197.5,-2094 35197.5,-2177"/>
<text text-anchor="middle" x="35075.5" y="-2161.8" font-family="Times,serif" font-size="14.00">L1_Gate_GPU4</text>
<text text-anchor="middle" x="35075.5" y="-2146.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="35075.5" y="-2131.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="35075.5" y="-2116.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="35075.5" y="-2101.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_attn_norm_gpu4&#45;&gt;layer1_gate_gpu4 -->
<g id="edge488" class="edge">
<title>layer1_attn_norm_gpu4&#45;&gt;layer1_gate_gpu4</title>
<path fill="none" stroke="black" d="M33885.99,-2246.99C33909.18,-2234.06 33937.3,-2220.55 33964.5,-2213 34145.15,-2162.86 34689.7,-2144.78 34943.12,-2138.97"/>
<polygon fill="black" stroke="black" points="34943.57,-2142.46 34953.49,-2138.73 34943.41,-2135.46 34943.57,-2142.46"/>
</g>
<!-- layer1_expert4_0 -->
<g id="node286" class="node">
<title>layer1_expert4_0</title>
<polygon fill="lightgreen" stroke="black" points="33877,-2058 33712,-2058 33712,-1975 33877,-1975 33877,-2058"/>
<text text-anchor="middle" x="33794.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU4</text>
<text text-anchor="middle" x="33794.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="33794.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="33794.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="33794.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_0 -->
<g id="edge489" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34953.05,-2132.1C34695.44,-2126.18 34104,-2107.75 33887.18,-2058.11"/>
<polygon fill="black" stroke="black" points="33887.68,-2054.63 33877.14,-2055.73 33886.06,-2061.44 33887.68,-2054.63"/>
</g>
<!-- layer1_expert4_1 -->
<g id="node287" class="node">
<title>layer1_expert4_1</title>
<polygon fill="lightgreen" stroke="black" points="34060,-2058 33895,-2058 33895,-1975 34060,-1975 34060,-2058"/>
<text text-anchor="middle" x="33977.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU4</text>
<text text-anchor="middle" x="33977.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="33977.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="33977.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="33977.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_1 -->
<g id="edge490" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34953.26,-2130.44C34727.14,-2122.08 34250.86,-2100.29 34070.08,-2058.1"/>
<polygon fill="black" stroke="black" points="34070.69,-2054.65 34060.15,-2055.68 34069.04,-2061.45 34070.69,-2054.65"/>
</g>
<!-- layer1_expert4_2 -->
<g id="node288" class="node">
<title>layer1_expert4_2</title>
<polygon fill="lightgreen" stroke="black" points="34243,-2058 34078,-2058 34078,-1975 34243,-1975 34243,-2058"/>
<text text-anchor="middle" x="34160.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU4</text>
<text text-anchor="middle" x="34160.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="34160.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="34160.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="34160.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_2 -->
<g id="edge491" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34953.36,-2128.05C34761.78,-2117.12 34398.32,-2092.96 34253.23,-2058.15"/>
<polygon fill="black" stroke="black" points="34253.72,-2054.66 34243.17,-2055.62 34252.01,-2061.45 34253.72,-2054.66"/>
</g>
<!-- layer1_expert4_3 -->
<g id="node289" class="node">
<title>layer1_expert4_3</title>
<polygon fill="lightgreen" stroke="black" points="34426,-2058 34261,-2058 34261,-1975 34426,-1975 34426,-2058"/>
<text text-anchor="middle" x="34343.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU4</text>
<text text-anchor="middle" x="34343.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="34343.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="34343.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="34343.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_3 -->
<g id="edge492" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34953.21,-2130.77C34824.95,-2124.4 34618.18,-2107.17 34435.95,-2058.19"/>
<polygon fill="black" stroke="black" points="34436.76,-2054.78 34426.19,-2055.53 34434.92,-2061.53 34436.76,-2054.78"/>
</g>
<!-- layer1_expert4_4 -->
<g id="node290" class="node">
<title>layer1_expert4_4</title>
<polygon fill="lightgreen" stroke="black" points="34609,-2058 34444,-2058 34444,-1975 34609,-1975 34609,-2058"/>
<text text-anchor="middle" x="34526.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU4</text>
<text text-anchor="middle" x="34526.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="34526.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="34526.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="34526.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_4 -->
<g id="edge493" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34953.05,-2122.58C34862.24,-2111.76 34735.81,-2092.52 34619.06,-2058.28"/>
<polygon fill="black" stroke="black" points="34619.82,-2054.86 34609.24,-2055.36 34617.83,-2061.57 34619.82,-2054.86"/>
</g>
<!-- layer1_expert4_5 -->
<g id="node291" class="node">
<title>layer1_expert4_5</title>
<polygon fill="lightgreen" stroke="black" points="34792,-2058 34627,-2058 34627,-1975 34792,-1975 34792,-2058"/>
<text text-anchor="middle" x="34709.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU4</text>
<text text-anchor="middle" x="34709.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="34709.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="34709.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="34709.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_5 -->
<g id="edge494" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34953.47,-2104.69C34907.95,-2092.56 34855.87,-2077.48 34801.56,-2058.26"/>
<polygon fill="black" stroke="black" points="34802.71,-2054.96 34792.12,-2054.89 34800.35,-2061.55 34802.71,-2054.96"/>
</g>
<!-- layer1_expert4_6 -->
<g id="node292" class="node">
<title>layer1_expert4_6</title>
<polygon fill="lightgreen" stroke="black" points="34975,-2058 34810,-2058 34810,-1975 34975,-1975 34975,-2058"/>
<text text-anchor="middle" x="34892.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU4</text>
<text text-anchor="middle" x="34892.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="34892.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="34892.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="34892.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_6 -->
<g id="edge495" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35012.01,-2093.91C34996.68,-2084.11 34980.19,-2073.56 34964.5,-2063.53"/>
<polygon fill="black" stroke="black" points="34966.19,-2060.46 34955.88,-2058.02 34962.42,-2066.36 34966.19,-2060.46"/>
</g>
<!-- layer1_expert4_7 -->
<g id="node293" class="node">
<title>layer1_expert4_7</title>
<polygon fill="lightgreen" stroke="black" points="35158,-2058 34993,-2058 34993,-1975 35158,-1975 35158,-2058"/>
<text text-anchor="middle" x="35075.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU4</text>
<text text-anchor="middle" x="35075.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="35075.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="35075.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="35075.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_7 -->
<g id="edge496" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35075.5,-2093.91C35075.5,-2085.65 35075.5,-2076.86 35075.5,-2068.3"/>
<polygon fill="black" stroke="black" points="35079,-2068.02 35075.5,-2058.02 35072,-2068.02 35079,-2068.02"/>
</g>
<!-- layer1_expert4_8 -->
<g id="node294" class="node">
<title>layer1_expert4_8</title>
<polygon fill="lightgreen" stroke="black" points="35341,-2058 35176,-2058 35176,-1975 35341,-1975 35341,-2058"/>
<text text-anchor="middle" x="35258.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU4</text>
<text text-anchor="middle" x="35258.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="35258.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="35258.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="35258.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_8 -->
<g id="edge497" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35138.99,-2093.91C35154.32,-2084.11 35170.81,-2073.56 35186.5,-2063.53"/>
<polygon fill="black" stroke="black" points="35188.58,-2066.36 35195.12,-2058.02 35184.81,-2060.46 35188.58,-2066.36"/>
</g>
<!-- layer1_expert4_9 -->
<g id="node295" class="node">
<title>layer1_expert4_9</title>
<polygon fill="lightgreen" stroke="black" points="35524,-2058 35359,-2058 35359,-1975 35524,-1975 35524,-2058"/>
<text text-anchor="middle" x="35441.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU4</text>
<text text-anchor="middle" x="35441.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="35441.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="35441.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="35441.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_9 -->
<g id="edge498" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35197.72,-2104.37C35245.54,-2091.55 35300.55,-2075.51 35349.5,-2058 35349.6,-2057.97 35349.7,-2057.93 35349.79,-2057.9"/>
<polygon fill="black" stroke="black" points="35350.81,-2061.25 35358.97,-2054.49 35348.38,-2054.69 35350.81,-2061.25"/>
</g>
<!-- layer1_expert4_10 -->
<g id="node296" class="node">
<title>layer1_expert4_10</title>
<polygon fill="lightgreen" stroke="black" points="35707,-2058 35542,-2058 35542,-1975 35707,-1975 35707,-2058"/>
<text text-anchor="middle" x="35624.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU4</text>
<text text-anchor="middle" x="35624.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="35624.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="35624.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="35624.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_10 -->
<g id="edge499" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35197.64,-2122.42C35288.24,-2111.52 35414.39,-2092.25 35531.96,-2057.94"/>
<polygon fill="black" stroke="black" points="35533.26,-2061.2 35541.86,-2055.01 35531.28,-2054.49 35533.26,-2061.2"/>
</g>
<!-- layer1_expert4_11 -->
<g id="node297" class="node">
<title>layer1_expert4_11</title>
<polygon fill="lightgreen" stroke="black" points="35890,-2058 35725,-2058 35725,-1975 35890,-1975 35890,-2058"/>
<text text-anchor="middle" x="35807.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU4</text>
<text text-anchor="middle" x="35807.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="35807.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="35807.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="35807.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_11 -->
<g id="edge500" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35197.56,-2130.6C35325.59,-2124.1 35532.01,-2106.76 35715.11,-2057.85"/>
<polygon fill="black" stroke="black" points="35716.18,-2061.19 35724.91,-2055.2 35714.35,-2054.43 35716.18,-2061.19"/>
</g>
<!-- layer1_expert4_12 -->
<g id="node298" class="node">
<title>layer1_expert4_12</title>
<polygon fill="lightgreen" stroke="black" points="36073,-2058 35908,-2058 35908,-1975 36073,-1975 36073,-2058"/>
<text text-anchor="middle" x="35990.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU4</text>
<text text-anchor="middle" x="35990.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="35990.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="35990.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="35990.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_12 -->
<g id="edge501" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35197.87,-2127.96C35389.31,-2116.93 35751.9,-2092.64 35897.82,-2057.83"/>
<polygon fill="black" stroke="black" points="35899.09,-2061.12 35907.94,-2055.3 35897.39,-2054.33 35899.09,-2061.12"/>
</g>
<!-- layer1_expert4_13 -->
<g id="node299" class="node">
<title>layer1_expert4_13</title>
<polygon fill="lightgreen" stroke="black" points="36256,-2058 36091,-2058 36091,-1975 36256,-1975 36256,-2058"/>
<text text-anchor="middle" x="36173.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU4</text>
<text text-anchor="middle" x="36173.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="36173.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="36173.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="36173.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_13 -->
<g id="edge502" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35197.6,-2130.37C35423.48,-2121.9 35899.24,-2099.94 36080.97,-2057.78"/>
<polygon fill="black" stroke="black" points="36082.06,-2061.12 36090.96,-2055.37 36080.42,-2054.32 36082.06,-2061.12"/>
</g>
<!-- layer1_expert4_14 -->
<g id="node300" class="node">
<title>layer1_expert4_14</title>
<polygon fill="lightgreen" stroke="black" points="36439,-2058 36274,-2058 36274,-1975 36439,-1975 36439,-2058"/>
<text text-anchor="middle" x="36356.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU4</text>
<text text-anchor="middle" x="36356.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="36356.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="36356.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="36356.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_14 -->
<g id="edge503" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35197.83,-2132.04C35455.32,-2125.99 36046.68,-2107.3 36264.21,-2057.73"/>
<polygon fill="black" stroke="black" points="36265.04,-2061.13 36273.97,-2055.42 36263.43,-2054.31 36265.04,-2061.13"/>
</g>
<!-- layer1_expert4_15 -->
<g id="node301" class="node">
<title>layer1_expert4_15</title>
<polygon fill="lightgreen" stroke="black" points="36622,-2058 36457,-2058 36457,-1975 36622,-1975 36622,-2058"/>
<text text-anchor="middle" x="36539.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU4</text>
<text text-anchor="middle" x="36539.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="36539.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="36539.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="36539.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gate_gpu4&#45;&gt;layer1_expert4_15 -->
<g id="edge504" class="edge">
<title>layer1_gate_gpu4&#45;&gt;layer1_expert4_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35197.56,-2133.27C35483.91,-2129.51 36193.07,-2114.8 36447.05,-2057.76"/>
<polygon fill="black" stroke="black" points="36448.03,-2061.13 36456.98,-2055.45 36446.45,-2054.31 36448.03,-2061.13"/>
</g>
<!-- layer1_moe_agg_gpu4 -->
<g id="node302" class="node">
<title>layer1_moe_agg_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="35085,-1939 34882,-1939 34882,-1856 35085,-1856 35085,-1939"/>
<text text-anchor="middle" x="34983.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU4</text>
<text text-anchor="middle" x="34983.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="34983.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34983.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="34983.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_expert4_0&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge505" class="edge">
<title>layer1_expert4_0&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M33877.14,-1977.29C33879.94,-1976.46 33882.73,-1975.69 33885.5,-1975 34069.89,-1929.06 34630.54,-1908.33 34871.49,-1901.36"/>
<polygon fill="black" stroke="black" points="34871.78,-1904.86 34881.67,-1901.07 34871.58,-1897.86 34871.78,-1904.86"/>
</g>
<!-- layer1_expert4_1&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge506" class="edge">
<title>layer1_expert4_1&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M34060.16,-1977.34C34062.95,-1976.49 34065.74,-1975.71 34068.5,-1975 34217.57,-1936.76 34662.31,-1912.69 34871.89,-1903.16"/>
<polygon fill="black" stroke="black" points="34872.16,-1906.65 34882,-1902.71 34871.85,-1899.66 34872.16,-1906.65"/>
</g>
<!-- layer1_expert4_2&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge507" class="edge">
<title>layer1_expert4_2&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M34243.18,-1977.42C34245.96,-1976.55 34248.74,-1975.74 34251.5,-1975 34465.91,-1917.63 34726.37,-1902.9 34871.67,-1899.35"/>
<polygon fill="black" stroke="black" points="34872.02,-1902.84 34881.93,-1899.11 34871.86,-1895.84 34872.02,-1902.84"/>
</g>
<!-- layer1_expert4_3&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge508" class="edge">
<title>layer1_expert4_3&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M34426.21,-1977.54C34428.99,-1976.64 34431.76,-1975.78 34434.5,-1975 34582.35,-1932.71 34759.54,-1913.41 34871.83,-1904.87"/>
<polygon fill="black" stroke="black" points="34872.1,-1908.36 34881.82,-1904.13 34871.58,-1901.38 34872.1,-1908.36"/>
</g>
<!-- layer1_expert4_4&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge509" class="edge">
<title>layer1_expert4_4&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M34609.03,-1977.87C34611.88,-1976.87 34614.7,-1975.9 34617.5,-1975 34700.98,-1948.04 34798.32,-1928.22 34871.62,-1915.52"/>
<polygon fill="black" stroke="black" points="34872.54,-1918.92 34881.8,-1913.78 34871.35,-1912.02 34872.54,-1918.92"/>
</g>
<!-- layer1_expert4_5&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge510" class="edge">
<title>layer1_expert4_5&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M34792.29,-1978.56C34795.06,-1977.35 34797.8,-1976.16 34800.5,-1975 34824.75,-1964.54 34850.9,-1953.48 34875.63,-1943.11"/>
<polygon fill="black" stroke="black" points="34877.15,-1946.27 34885.03,-1939.18 34874.45,-1939.81 34877.15,-1946.27"/>
</g>
<!-- layer1_expert4_6&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge511" class="edge">
<title>layer1_expert4_6&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M34924.07,-1974.91C34931.06,-1965.92 34938.53,-1956.32 34945.74,-1947.05"/>
<polygon fill="black" stroke="black" points="34948.61,-1949.06 34951.98,-1939.02 34943.08,-1944.77 34948.61,-1949.06"/>
</g>
<!-- layer1_expert4_7&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge512" class="edge">
<title>layer1_expert4_7&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M35043.58,-1974.91C35036.52,-1965.92 35028.96,-1956.32 35021.68,-1947.05"/>
<polygon fill="black" stroke="black" points="35024.3,-1944.72 35015.36,-1939.02 35018.79,-1949.05 35024.3,-1944.72"/>
</g>
<!-- layer1_expert4_8&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge513" class="edge">
<title>layer1_expert4_8&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M35175.78,-1979C35172.65,-1977.64 35169.55,-1976.31 35166.5,-1975 35142.09,-1964.53 35115.77,-1953.42 35090.91,-1943.01"/>
<polygon fill="black" stroke="black" points="35092.04,-1939.69 35081.46,-1939.05 35089.34,-1946.14 35092.04,-1939.69"/>
</g>
<!-- layer1_expert4_9&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge514" class="edge">
<title>layer1_expert4_9&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M35358.81,-1978.15C35355.68,-1977.04 35352.57,-1975.99 35349.5,-1975 35265.96,-1948.21 35168.63,-1928.38 35095.34,-1915.64"/>
<polygon fill="black" stroke="black" points="35095.61,-1912.13 35085.16,-1913.89 35094.43,-1919.03 35095.61,-1912.13"/>
</g>
<!-- layer1_expert4_10&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge515" class="edge">
<title>layer1_expert4_10&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M35541.89,-1977.88C35538.74,-1976.85 35535.61,-1975.88 35532.5,-1975 35384.56,-1933.01 35207.39,-1913.63 35095.14,-1905"/>
<polygon fill="black" stroke="black" points="35095.39,-1901.51 35085.15,-1904.25 35094.86,-1908.49 35095.39,-1901.51"/>
</g>
<!-- layer1_expert4_11&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge516" class="edge">
<title>layer1_expert4_11&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M35724.93,-1977.74C35721.77,-1976.75 35718.62,-1975.83 35715.5,-1975 35500.97,-1918.07 35240.55,-1903.17 35095.29,-1899.48"/>
<polygon fill="black" stroke="black" points="35095.11,-1895.98 35085.03,-1899.24 35094.95,-1902.98 35095.11,-1895.98"/>
</g>
<!-- layer1_expert4_12&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge517" class="edge">
<title>layer1_expert4_12&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M35907.95,-1977.66C35904.79,-1976.69 35901.63,-1975.8 35898.5,-1975 35749.44,-1937.09 35305.22,-1912.87 35095.5,-1903.24"/>
<polygon fill="black" stroke="black" points="35095.53,-1899.73 35085.38,-1902.77 35095.21,-1906.73 35095.53,-1899.73"/>
</g>
<!-- layer1_expert4_13&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge518" class="edge">
<title>layer1_expert4_13&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M36090.96,-1977.6C36087.8,-1976.65 36084.63,-1975.77 36081.5,-1975 35897.01,-1929.44 35336.42,-1908.5 35095.5,-1901.42"/>
<polygon fill="black" stroke="black" points="35095.41,-1897.92 35085.32,-1901.12 35095.21,-1904.91 35095.41,-1897.92"/>
</g>
<!-- layer1_expert4_14&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge519" class="edge">
<title>layer1_expert4_14&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M36273.97,-1977.56C36270.8,-1976.62 36267.64,-1975.76 36264.5,-1975 36044.15,-1921.74 35364.6,-1904.81 35095.19,-1900.11"/>
<polygon fill="black" stroke="black" points="35095.07,-1896.61 35085.01,-1899.94 35094.95,-1903.61 35095.07,-1896.61"/>
</g>
<!-- layer1_expert4_15&#45;&gt;layer1_moe_agg_gpu4 -->
<g id="edge520" class="edge">
<title>layer1_expert4_15&#45;&gt;layer1_moe_agg_gpu4</title>
<path fill="none" stroke="black" d="M36456.98,-1977.53C36453.81,-1976.6 36450.64,-1975.75 36447.5,-1975 36191.17,-1914.05 35391.85,-1901.65 35095.51,-1899.14"/>
<polygon fill="black" stroke="black" points="35095.22,-1895.63 35085.19,-1899.05 35095.16,-1902.63 35095.22,-1895.63"/>
</g>
<!-- layer1_output_gpu4 -->
<g id="node303" class="node">
<title>layer1_output_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="33935.5,-1614 33691.5,-1614 33691.5,-1546 33935.5,-1546 33935.5,-1614"/>
<text text-anchor="middle" x="33813.5" y="-1598.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU4</text>
<text text-anchor="middle" x="33813.5" y="-1583.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="33813.5" y="-1568.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33813.5" y="-1553.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_moe_agg_gpu4&#45;&gt;layer1_output_gpu4 -->
<g id="edge521" class="edge">
<title>layer1_moe_agg_gpu4&#45;&gt;layer1_output_gpu4</title>
<path fill="none" stroke="black" d="M34881.62,-1893.71C34657.87,-1886.77 34138.22,-1865.86 34073.5,-1820 34019.45,-1781.7 34058.01,-1732.14 34012.5,-1684 34011.25,-1682.68 33943.16,-1647.55 33886.98,-1618.69"/>
<polygon fill="black" stroke="black" points="33888.57,-1615.57 33878.08,-1614.11 33885.38,-1621.8 33888.57,-1615.57"/>
</g>
<!-- layer1_moe_agg_gpu4&#45;&gt;layer1_allreduce_moe -->
<g id="edge651" class="edge">
<title>layer1_moe_agg_gpu4&#45;&gt;layer1_allreduce_moe</title>
<path fill="none" stroke="black" d="M34881.67,-1895.46C34705.35,-1892.09 34332.42,-1878.03 34023.5,-1820 33985.3,-1812.82 33944.33,-1801.59 33908.07,-1790.35"/>
<polygon fill="black" stroke="black" points="33909.05,-1786.99 33898.46,-1787.34 33906.96,-1793.67 33909.05,-1786.99"/>
</g>
<!-- layer1_output_gpu4&#45;&gt;pipeline_stage0_1 -->
<g id="edge669" class="edge">
<title>layer1_output_gpu4&#45;&gt;pipeline_stage0_1</title>
<path fill="none" stroke="black" d="M33787.93,-1545.82C33774.4,-1528.25 33757.18,-1505.92 33740.61,-1484.41"/>
<polygon fill="black" stroke="black" points="33743.17,-1482 33734.3,-1476.22 33737.63,-1486.27 33743.17,-1482"/>
</g>
<!-- layer1_qkv_gpu5 -->
<g id="node304" class="node">
<title>layer1_qkv_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="34200.5,-2908 33990.5,-2908 33990.5,-2810 34200.5,-2810 34200.5,-2908"/>
<text text-anchor="middle" x="34095.5" y="-2892.8" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU5</text>
<text text-anchor="middle" x="34095.5" y="-2877.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="34095.5" y="-2862.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="34095.5" y="-2847.8" font-family="Times,serif" font-size="14.00">Heads: 20&#45;23</text>
<text text-anchor="middle" x="34095.5" y="-2832.8" font-family="Times,serif" font-size="14.00">TP Slice: 5</text>
<text text-anchor="middle" x="34095.5" y="-2817.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_attn_gpu5 -->
<g id="node305" class="node">
<title>layer1_attn_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="34217,-2766.5 33974,-2766.5 33974,-2683.5 34217,-2683.5 34217,-2766.5"/>
<text text-anchor="middle" x="34095.5" y="-2751.3" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU5</text>
<text text-anchor="middle" x="34095.5" y="-2736.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="34095.5" y="-2721.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34095.5" y="-2706.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="34095.5" y="-2691.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_qkv_gpu5&#45;&gt;layer1_attn_gpu5 -->
<g id="edge522" class="edge">
<title>layer1_qkv_gpu5&#45;&gt;layer1_attn_gpu5</title>
<path fill="none" stroke="black" d="M34095.5,-2809.97C34095.5,-2799.25 34095.5,-2787.84 34095.5,-2776.99"/>
<polygon fill="black" stroke="black" points="34099,-2776.82 34095.5,-2766.82 34092,-2776.82 34099,-2776.82"/>
</g>
<!-- layer1_attn_proj_gpu5 -->
<g id="node306" class="node">
<title>layer1_attn_proj_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="34195.5,-2632.5 33995.5,-2632.5 33995.5,-2564.5 34195.5,-2564.5 34195.5,-2632.5"/>
<text text-anchor="middle" x="34095.5" y="-2617.3" font-family="Times,serif" font-size="14.00">L1_Attn_Projection_GPU5</text>
<text text-anchor="middle" x="34095.5" y="-2602.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="34095.5" y="-2587.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34095.5" y="-2572.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_attn_gpu5&#45;&gt;layer1_attn_proj_gpu5 -->
<g id="edge523" class="edge">
<title>layer1_attn_gpu5&#45;&gt;layer1_attn_proj_gpu5</title>
<path fill="none" stroke="black" d="M34095.5,-2683.23C34095.5,-2670.36 34095.5,-2656.1 34095.5,-2643.04"/>
<polygon fill="black" stroke="black" points="34099,-2642.88 34095.5,-2632.88 34092,-2642.88 34099,-2642.88"/>
</g>
<!-- layer1_attn_norm_gpu5 -->
<g id="node307" class="node">
<title>layer1_attn_norm_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="34217.5,-2315 33973.5,-2315 33973.5,-2247 34217.5,-2247 34217.5,-2315"/>
<text text-anchor="middle" x="34095.5" y="-2299.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU5</text>
<text text-anchor="middle" x="34095.5" y="-2284.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="34095.5" y="-2269.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34095.5" y="-2254.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_attn_proj_gpu5&#45;&gt;layer1_attn_norm_gpu5 -->
<g id="edge524" class="edge">
<title>layer1_attn_proj_gpu5&#45;&gt;layer1_attn_norm_gpu5</title>
<path fill="none" stroke="black" d="M34095.5,-2564.33C34095.5,-2506.93 34095.5,-2389.12 34095.5,-2325.33"/>
<polygon fill="black" stroke="black" points="34099,-2325.2 34095.5,-2315.2 34092,-2325.2 34099,-2325.2"/>
</g>
<!-- layer1_attn_proj_gpu5&#45;&gt;layer1_allreduce_attn -->
<g id="edge653" class="edge">
<title>layer1_attn_proj_gpu5&#45;&gt;layer1_allreduce_attn</title>
<path fill="none" stroke="black" d="M34004.84,-2564.4C33946.21,-2542.99 33869.65,-2515.03 33808.25,-2492.61"/>
<polygon fill="black" stroke="black" points="33809.12,-2489.21 33798.53,-2489.06 33806.72,-2495.78 33809.12,-2489.21"/>
</g>
<!-- layer1_gate_gpu5 -->
<g id="node308" class="node">
<title>layer1_gate_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="38125.5,-2177 37881.5,-2177 37881.5,-2094 38125.5,-2094 38125.5,-2177"/>
<text text-anchor="middle" x="38003.5" y="-2161.8" font-family="Times,serif" font-size="14.00">L1_Gate_GPU5</text>
<text text-anchor="middle" x="38003.5" y="-2146.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="38003.5" y="-2131.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="38003.5" y="-2116.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="38003.5" y="-2101.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_attn_norm_gpu5&#45;&gt;layer1_gate_gpu5 -->
<g id="edge525" class="edge">
<title>layer1_attn_norm_gpu5&#45;&gt;layer1_gate_gpu5</title>
<path fill="none" stroke="black" d="M34146.88,-2246.88C34170.21,-2233.68 34198.75,-2219.98 34226.5,-2213 34316.66,-2190.31 37211.74,-2147.78 37870.87,-2138.37"/>
<polygon fill="black" stroke="black" points="37871.4,-2141.87 37881.35,-2138.22 37871.3,-2134.87 37871.4,-2141.87"/>
</g>
<!-- layer1_expert5_0 -->
<g id="node309" class="node">
<title>layer1_expert5_0</title>
<polygon fill="lightgreen" stroke="black" points="36805,-2058 36640,-2058 36640,-1975 36805,-1975 36805,-2058"/>
<text text-anchor="middle" x="36722.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU5</text>
<text text-anchor="middle" x="36722.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="36722.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="36722.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="36722.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_0 -->
<g id="edge526" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37881.05,-2132.1C37623.44,-2126.18 37032,-2107.75 36815.18,-2058.11"/>
<polygon fill="black" stroke="black" points="36815.68,-2054.63 36805.14,-2055.73 36814.06,-2061.44 36815.68,-2054.63"/>
</g>
<!-- layer1_expert5_1 -->
<g id="node310" class="node">
<title>layer1_expert5_1</title>
<polygon fill="lightgreen" stroke="black" points="36988,-2058 36823,-2058 36823,-1975 36988,-1975 36988,-2058"/>
<text text-anchor="middle" x="36905.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU5</text>
<text text-anchor="middle" x="36905.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="36905.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="36905.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="36905.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_1 -->
<g id="edge527" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37881.26,-2130.44C37655.14,-2122.08 37178.86,-2100.29 36998.08,-2058.1"/>
<polygon fill="black" stroke="black" points="36998.69,-2054.65 36988.15,-2055.68 36997.04,-2061.45 36998.69,-2054.65"/>
</g>
<!-- layer1_expert5_2 -->
<g id="node311" class="node">
<title>layer1_expert5_2</title>
<polygon fill="lightgreen" stroke="black" points="37171,-2058 37006,-2058 37006,-1975 37171,-1975 37171,-2058"/>
<text text-anchor="middle" x="37088.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU5</text>
<text text-anchor="middle" x="37088.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="37088.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="37088.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="37088.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_2 -->
<g id="edge528" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37881.36,-2128.05C37689.78,-2117.12 37326.32,-2092.96 37181.23,-2058.15"/>
<polygon fill="black" stroke="black" points="37181.72,-2054.66 37171.17,-2055.62 37180.01,-2061.45 37181.72,-2054.66"/>
</g>
<!-- layer1_expert5_3 -->
<g id="node312" class="node">
<title>layer1_expert5_3</title>
<polygon fill="lightgreen" stroke="black" points="37354,-2058 37189,-2058 37189,-1975 37354,-1975 37354,-2058"/>
<text text-anchor="middle" x="37271.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU5</text>
<text text-anchor="middle" x="37271.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="37271.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="37271.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="37271.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_3 -->
<g id="edge529" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37881.21,-2130.77C37752.95,-2124.4 37546.18,-2107.17 37363.95,-2058.19"/>
<polygon fill="black" stroke="black" points="37364.76,-2054.78 37354.19,-2055.53 37362.92,-2061.53 37364.76,-2054.78"/>
</g>
<!-- layer1_expert5_4 -->
<g id="node313" class="node">
<title>layer1_expert5_4</title>
<polygon fill="lightgreen" stroke="black" points="37537,-2058 37372,-2058 37372,-1975 37537,-1975 37537,-2058"/>
<text text-anchor="middle" x="37454.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU5</text>
<text text-anchor="middle" x="37454.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="37454.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="37454.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="37454.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_4 -->
<g id="edge530" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37881.05,-2122.58C37790.24,-2111.76 37663.81,-2092.52 37547.06,-2058.28"/>
<polygon fill="black" stroke="black" points="37547.82,-2054.86 37537.24,-2055.36 37545.83,-2061.57 37547.82,-2054.86"/>
</g>
<!-- layer1_expert5_5 -->
<g id="node314" class="node">
<title>layer1_expert5_5</title>
<polygon fill="lightgreen" stroke="black" points="37720,-2058 37555,-2058 37555,-1975 37720,-1975 37720,-2058"/>
<text text-anchor="middle" x="37637.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU5</text>
<text text-anchor="middle" x="37637.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="37637.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="37637.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="37637.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_5 -->
<g id="edge531" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37881.47,-2104.69C37835.95,-2092.56 37783.87,-2077.48 37729.56,-2058.26"/>
<polygon fill="black" stroke="black" points="37730.71,-2054.96 37720.12,-2054.89 37728.35,-2061.55 37730.71,-2054.96"/>
</g>
<!-- layer1_expert5_6 -->
<g id="node315" class="node">
<title>layer1_expert5_6</title>
<polygon fill="lightgreen" stroke="black" points="37903,-2058 37738,-2058 37738,-1975 37903,-1975 37903,-2058"/>
<text text-anchor="middle" x="37820.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU5</text>
<text text-anchor="middle" x="37820.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="37820.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="37820.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="37820.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_6 -->
<g id="edge532" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37940.01,-2093.91C37924.68,-2084.11 37908.19,-2073.56 37892.5,-2063.53"/>
<polygon fill="black" stroke="black" points="37894.19,-2060.46 37883.88,-2058.02 37890.42,-2066.36 37894.19,-2060.46"/>
</g>
<!-- layer1_expert5_7 -->
<g id="node316" class="node">
<title>layer1_expert5_7</title>
<polygon fill="lightgreen" stroke="black" points="38086,-2058 37921,-2058 37921,-1975 38086,-1975 38086,-2058"/>
<text text-anchor="middle" x="38003.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU5</text>
<text text-anchor="middle" x="38003.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="38003.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="38003.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="38003.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_7 -->
<g id="edge533" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38003.5,-2093.91C38003.5,-2085.65 38003.5,-2076.86 38003.5,-2068.3"/>
<polygon fill="black" stroke="black" points="38007,-2068.02 38003.5,-2058.02 38000,-2068.02 38007,-2068.02"/>
</g>
<!-- layer1_expert5_8 -->
<g id="node317" class="node">
<title>layer1_expert5_8</title>
<polygon fill="lightgreen" stroke="black" points="38269,-2058 38104,-2058 38104,-1975 38269,-1975 38269,-2058"/>
<text text-anchor="middle" x="38186.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU5</text>
<text text-anchor="middle" x="38186.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="38186.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="38186.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="38186.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_8 -->
<g id="edge534" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38066.99,-2093.91C38082.32,-2084.11 38098.81,-2073.56 38114.5,-2063.53"/>
<polygon fill="black" stroke="black" points="38116.58,-2066.36 38123.12,-2058.02 38112.81,-2060.46 38116.58,-2066.36"/>
</g>
<!-- layer1_expert5_9 -->
<g id="node318" class="node">
<title>layer1_expert5_9</title>
<polygon fill="lightgreen" stroke="black" points="38452,-2058 38287,-2058 38287,-1975 38452,-1975 38452,-2058"/>
<text text-anchor="middle" x="38369.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU5</text>
<text text-anchor="middle" x="38369.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="38369.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="38369.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="38369.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_9 -->
<g id="edge535" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38125.72,-2104.37C38173.54,-2091.55 38228.55,-2075.51 38277.5,-2058 38277.6,-2057.97 38277.7,-2057.93 38277.79,-2057.9"/>
<polygon fill="black" stroke="black" points="38278.81,-2061.25 38286.97,-2054.49 38276.38,-2054.69 38278.81,-2061.25"/>
</g>
<!-- layer1_expert5_10 -->
<g id="node319" class="node">
<title>layer1_expert5_10</title>
<polygon fill="lightgreen" stroke="black" points="38635,-2058 38470,-2058 38470,-1975 38635,-1975 38635,-2058"/>
<text text-anchor="middle" x="38552.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU5</text>
<text text-anchor="middle" x="38552.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="38552.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="38552.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="38552.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_10 -->
<g id="edge536" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38125.64,-2122.42C38216.24,-2111.52 38342.39,-2092.25 38459.96,-2057.94"/>
<polygon fill="black" stroke="black" points="38461.26,-2061.2 38469.86,-2055.01 38459.28,-2054.49 38461.26,-2061.2"/>
</g>
<!-- layer1_expert5_11 -->
<g id="node320" class="node">
<title>layer1_expert5_11</title>
<polygon fill="lightgreen" stroke="black" points="38818,-2058 38653,-2058 38653,-1975 38818,-1975 38818,-2058"/>
<text text-anchor="middle" x="38735.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU5</text>
<text text-anchor="middle" x="38735.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="38735.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="38735.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="38735.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_11 -->
<g id="edge537" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38125.56,-2130.6C38253.59,-2124.1 38460.01,-2106.76 38643.11,-2057.85"/>
<polygon fill="black" stroke="black" points="38644.18,-2061.19 38652.91,-2055.2 38642.35,-2054.43 38644.18,-2061.19"/>
</g>
<!-- layer1_expert5_12 -->
<g id="node321" class="node">
<title>layer1_expert5_12</title>
<polygon fill="lightgreen" stroke="black" points="39001,-2058 38836,-2058 38836,-1975 39001,-1975 39001,-2058"/>
<text text-anchor="middle" x="38918.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU5</text>
<text text-anchor="middle" x="38918.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="38918.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="38918.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="38918.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_12 -->
<g id="edge538" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38125.87,-2127.96C38317.31,-2116.93 38679.9,-2092.64 38825.82,-2057.83"/>
<polygon fill="black" stroke="black" points="38827.09,-2061.12 38835.94,-2055.3 38825.39,-2054.33 38827.09,-2061.12"/>
</g>
<!-- layer1_expert5_13 -->
<g id="node322" class="node">
<title>layer1_expert5_13</title>
<polygon fill="lightgreen" stroke="black" points="39184,-2058 39019,-2058 39019,-1975 39184,-1975 39184,-2058"/>
<text text-anchor="middle" x="39101.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU5</text>
<text text-anchor="middle" x="39101.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="39101.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="39101.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="39101.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_13 -->
<g id="edge539" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38125.6,-2130.37C38351.48,-2121.9 38827.24,-2099.94 39008.97,-2057.78"/>
<polygon fill="black" stroke="black" points="39010.06,-2061.12 39018.96,-2055.37 39008.42,-2054.32 39010.06,-2061.12"/>
</g>
<!-- layer1_expert5_14 -->
<g id="node323" class="node">
<title>layer1_expert5_14</title>
<polygon fill="lightgreen" stroke="black" points="39367,-2058 39202,-2058 39202,-1975 39367,-1975 39367,-2058"/>
<text text-anchor="middle" x="39284.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU5</text>
<text text-anchor="middle" x="39284.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="39284.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="39284.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="39284.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_14 -->
<g id="edge540" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38125.83,-2132.04C38383.32,-2125.99 38974.68,-2107.3 39192.21,-2057.73"/>
<polygon fill="black" stroke="black" points="39193.04,-2061.13 39201.97,-2055.42 39191.43,-2054.31 39193.04,-2061.13"/>
</g>
<!-- layer1_expert5_15 -->
<g id="node324" class="node">
<title>layer1_expert5_15</title>
<polygon fill="lightgreen" stroke="black" points="39550,-2058 39385,-2058 39385,-1975 39550,-1975 39550,-2058"/>
<text text-anchor="middle" x="39467.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU5</text>
<text text-anchor="middle" x="39467.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="39467.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="39467.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="39467.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gate_gpu5&#45;&gt;layer1_expert5_15 -->
<g id="edge541" class="edge">
<title>layer1_gate_gpu5&#45;&gt;layer1_expert5_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38125.56,-2133.27C38411.91,-2129.51 39121.07,-2114.8 39375.05,-2057.76"/>
<polygon fill="black" stroke="black" points="39376.03,-2061.13 39384.98,-2055.45 39374.45,-2054.31 39376.03,-2061.13"/>
</g>
<!-- layer1_moe_agg_gpu5 -->
<g id="node325" class="node">
<title>layer1_moe_agg_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="38014,-1939 37811,-1939 37811,-1856 38014,-1856 38014,-1939"/>
<text text-anchor="middle" x="37912.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU5</text>
<text text-anchor="middle" x="37912.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="37912.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="37912.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="37912.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_expert5_0&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge542" class="edge">
<title>layer1_expert5_0&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M36805.14,-1977.29C36807.94,-1976.46 36810.73,-1975.69 36813.5,-1975 36998.06,-1929.03 37559.21,-1908.31 37800.39,-1901.36"/>
<polygon fill="black" stroke="black" points="37800.68,-1904.85 37810.58,-1901.07 37800.48,-1897.86 37800.68,-1904.85"/>
</g>
<!-- layer1_expert5_1&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge543" class="edge">
<title>layer1_expert5_1&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M36988.16,-1977.34C36990.95,-1976.49 36993.74,-1975.71 36996.5,-1975 37145.74,-1936.73 37590.96,-1912.67 37800.77,-1903.16"/>
<polygon fill="black" stroke="black" points="37801.05,-1906.65 37810.88,-1902.7 37800.74,-1899.65 37801.05,-1906.65"/>
</g>
<!-- layer1_expert5_2&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge544" class="edge">
<title>layer1_expert5_2&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M37171.18,-1977.42C37173.96,-1976.55 37176.74,-1975.74 37179.5,-1975 37394.21,-1917.57 37655.02,-1902.86 37800.52,-1899.33"/>
<polygon fill="black" stroke="black" points="37800.88,-1902.82 37810.8,-1899.09 37800.72,-1895.82 37800.88,-1902.82"/>
</g>
<!-- layer1_expert5_3&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge545" class="edge">
<title>layer1_expert5_3&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M37354.21,-1977.54C37356.99,-1976.64 37359.76,-1975.78 37362.5,-1975 37510.74,-1932.62 37688.4,-1913.34 37800.88,-1904.83"/>
<polygon fill="black" stroke="black" points="37801.17,-1908.32 37810.89,-1904.09 37800.65,-1901.34 37801.17,-1908.32"/>
</g>
<!-- layer1_expert5_4&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge546" class="edge">
<title>layer1_expert5_4&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M37537.03,-1977.87C37539.87,-1976.86 37542.7,-1975.9 37545.5,-1975 37629.36,-1947.94 37727.16,-1928.11 37800.7,-1915.42"/>
<polygon fill="black" stroke="black" points="37801.65,-1918.81 37810.92,-1913.68 37800.47,-1911.91 37801.65,-1918.81"/>
</g>
<!-- layer1_expert5_5&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge547" class="edge">
<title>layer1_expert5_5&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M37720.29,-1978.55C37723.06,-1977.35 37725.8,-1976.16 37728.5,-1975 37752.87,-1964.51 37779.16,-1953.44 37804.02,-1943.08"/>
<polygon fill="black" stroke="black" points="37805.59,-1946.22 37813.48,-1939.14 37802.9,-1939.75 37805.59,-1946.22"/>
</g>
<!-- layer1_expert5_6&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge548" class="edge">
<title>layer1_expert5_6&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M37852.42,-1974.91C37859.48,-1965.92 37867.04,-1956.32 37874.32,-1947.05"/>
<polygon fill="black" stroke="black" points="37877.21,-1949.05 37880.64,-1939.02 37871.7,-1944.72 37877.21,-1949.05"/>
</g>
<!-- layer1_expert5_7&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge549" class="edge">
<title>layer1_expert5_7&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M37971.93,-1974.91C37964.94,-1965.92 37957.47,-1956.32 37950.26,-1947.05"/>
<polygon fill="black" stroke="black" points="37952.92,-1944.77 37944.02,-1939.02 37947.39,-1949.06 37952.92,-1944.77"/>
</g>
<!-- layer1_expert5_8&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge550" class="edge">
<title>layer1_expert5_8&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M38103.78,-1979.01C38100.65,-1977.65 38097.55,-1976.31 38094.5,-1975 38070.21,-1964.55 38044.03,-1953.45 38019.31,-1943.04"/>
<polygon fill="black" stroke="black" points="38020.49,-1939.74 38009.91,-1939.09 38017.78,-1946.19 38020.49,-1939.74"/>
</g>
<!-- layer1_expert5_9&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge551" class="edge">
<title>layer1_expert5_9&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M38286.81,-1978.15C38283.68,-1977.04 38280.57,-1975.99 38277.5,-1975 38194.34,-1948.3 38097.46,-1928.5 38024.42,-1915.74"/>
<polygon fill="black" stroke="black" points="38024.73,-1912.24 38014.28,-1913.98 38023.54,-1919.13 38024.73,-1912.24"/>
</g>
<!-- layer1_expert5_10&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge552" class="edge">
<title>layer1_expert5_10&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M38469.89,-1977.88C38466.74,-1976.85 38463.61,-1975.88 38460.5,-1975 38313.09,-1933.14 38136.61,-1913.74 38024.53,-1905.07"/>
<polygon fill="black" stroke="black" points="38024.46,-1901.55 38014.22,-1904.29 38023.93,-1908.53 38024.46,-1901.55"/>
</g>
<!-- layer1_expert5_11&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge553" class="edge">
<title>layer1_expert5_11&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M38652.93,-1977.74C38649.77,-1976.75 38646.62,-1975.83 38643.5,-1975 38429.42,-1918.17 38169.57,-1903.24 38024.44,-1899.51"/>
<polygon fill="black" stroke="black" points="38024.28,-1896.01 38014.2,-1899.26 38024.11,-1903 38024.28,-1896.01"/>
</g>
<!-- layer1_expert5_12&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge554" class="edge">
<title>layer1_expert5_12&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M38835.95,-1977.66C38832.79,-1976.69 38829.63,-1975.8 38826.5,-1975 38677.61,-1937.12 38233.87,-1912.88 38024.37,-1903.24"/>
<polygon fill="black" stroke="black" points="38024.42,-1899.74 38014.27,-1902.78 38024.1,-1906.73 38024.42,-1899.74"/>
</g>
<!-- layer1_expert5_13&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge555" class="edge">
<title>layer1_expert5_13&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M39018.96,-1977.6C39015.8,-1976.65 39012.63,-1975.77 39009.5,-1975 38825.18,-1929.47 38265.1,-1908.51 38024.4,-1901.43"/>
<polygon fill="black" stroke="black" points="38024.32,-1897.92 38014.22,-1901.13 38024.12,-1904.92 38024.32,-1897.92"/>
</g>
<!-- layer1_expert5_14&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge556" class="edge">
<title>layer1_expert5_14&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M39201.97,-1977.56C39198.8,-1976.62 39195.64,-1975.76 39192.5,-1975 38972.45,-1921.81 38294.13,-1904.85 38024.6,-1900.13"/>
<polygon fill="black" stroke="black" points="38024.46,-1896.62 38014.4,-1899.95 38024.34,-1903.62 38024.46,-1896.62"/>
</g>
<!-- layer1_expert5_15&#45;&gt;layer1_moe_agg_gpu5 -->
<g id="edge557" class="edge">
<title>layer1_expert5_15&#45;&gt;layer1_moe_agg_gpu5</title>
<path fill="none" stroke="black" d="M39384.98,-1977.53C39381.81,-1976.6 39378.64,-1975.75 39375.5,-1975 39119.34,-1914.09 38320.57,-1901.66 38024.44,-1899.14"/>
<polygon fill="black" stroke="black" points="38024.15,-1895.64 38014.12,-1899.05 38024.09,-1902.64 38024.15,-1895.64"/>
</g>
<!-- layer1_output_gpu5 -->
<g id="node326" class="node">
<title>layer1_output_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="34197.5,-1614 33953.5,-1614 33953.5,-1546 34197.5,-1546 34197.5,-1614"/>
<text text-anchor="middle" x="34075.5" y="-1598.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU5</text>
<text text-anchor="middle" x="34075.5" y="-1583.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="34075.5" y="-1568.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34075.5" y="-1553.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_moe_agg_gpu5&#45;&gt;layer1_output_gpu5 -->
<g id="edge558" class="edge">
<title>layer1_moe_agg_gpu5&#45;&gt;layer1_output_gpu5</title>
<path fill="none" stroke="black" d="M37810.79,-1895.21C37289.37,-1887.77 34913.27,-1843.5 34206.5,-1648 34182.7,-1641.42 34158.18,-1630.25 34136.9,-1618.9"/>
<polygon fill="black" stroke="black" points="34138.44,-1615.75 34127.98,-1614.03 34135.09,-1621.9 34138.44,-1615.75"/>
</g>
<!-- layer1_moe_agg_gpu5&#45;&gt;layer1_allreduce_moe -->
<g id="edge655" class="edge">
<title>layer1_moe_agg_gpu5&#45;&gt;layer1_allreduce_moe</title>
<path fill="none" stroke="black" d="M37810.53,-1895.1C37220.52,-1886.94 34263.84,-1844.94 34073.5,-1820 34021.1,-1813.13 33964.18,-1800.09 33915.94,-1787.32"/>
<polygon fill="black" stroke="black" points="33916.67,-1783.89 33906.1,-1784.69 33914.86,-1790.65 33916.67,-1783.89"/>
</g>
<!-- layer1_output_gpu5&#45;&gt;pipeline_stage0_1 -->
<g id="edge670" class="edge">
<title>layer1_output_gpu5&#45;&gt;pipeline_stage0_1</title>
<path fill="none" stroke="black" d="M34013.8,-1545.87C33992.12,-1534.65 33967.44,-1522.34 33944.5,-1512 33920.39,-1501.13 33894.77,-1490.25 33869.36,-1479.86"/>
<polygon fill="black" stroke="black" points="33870.59,-1476.58 33860.01,-1476.05 33867.95,-1483.06 33870.59,-1476.58"/>
</g>
<!-- layer1_qkv_gpu6 -->
<g id="node327" class="node">
<title>layer1_qkv_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="34462.5,-2908 34252.5,-2908 34252.5,-2810 34462.5,-2810 34462.5,-2908"/>
<text text-anchor="middle" x="34357.5" y="-2892.8" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU6</text>
<text text-anchor="middle" x="34357.5" y="-2877.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="34357.5" y="-2862.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="34357.5" y="-2847.8" font-family="Times,serif" font-size="14.00">Heads: 24&#45;27</text>
<text text-anchor="middle" x="34357.5" y="-2832.8" font-family="Times,serif" font-size="14.00">TP Slice: 6</text>
<text text-anchor="middle" x="34357.5" y="-2817.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_attn_gpu6 -->
<g id="node328" class="node">
<title>layer1_attn_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="34479,-2766.5 34236,-2766.5 34236,-2683.5 34479,-2683.5 34479,-2766.5"/>
<text text-anchor="middle" x="34357.5" y="-2751.3" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU6</text>
<text text-anchor="middle" x="34357.5" y="-2736.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="34357.5" y="-2721.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34357.5" y="-2706.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="34357.5" y="-2691.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_qkv_gpu6&#45;&gt;layer1_attn_gpu6 -->
<g id="edge559" class="edge">
<title>layer1_qkv_gpu6&#45;&gt;layer1_attn_gpu6</title>
<path fill="none" stroke="black" d="M34357.5,-2809.97C34357.5,-2799.25 34357.5,-2787.84 34357.5,-2776.99"/>
<polygon fill="black" stroke="black" points="34361,-2776.82 34357.5,-2766.82 34354,-2776.82 34361,-2776.82"/>
</g>
<!-- layer1_attn_proj_gpu6 -->
<g id="node329" class="node">
<title>layer1_attn_proj_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="34457.5,-2632.5 34257.5,-2632.5 34257.5,-2564.5 34457.5,-2564.5 34457.5,-2632.5"/>
<text text-anchor="middle" x="34357.5" y="-2617.3" font-family="Times,serif" font-size="14.00">L1_Attn_Projection_GPU6</text>
<text text-anchor="middle" x="34357.5" y="-2602.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="34357.5" y="-2587.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34357.5" y="-2572.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_attn_gpu6&#45;&gt;layer1_attn_proj_gpu6 -->
<g id="edge560" class="edge">
<title>layer1_attn_gpu6&#45;&gt;layer1_attn_proj_gpu6</title>
<path fill="none" stroke="black" d="M34357.5,-2683.23C34357.5,-2670.36 34357.5,-2656.1 34357.5,-2643.04"/>
<polygon fill="black" stroke="black" points="34361,-2642.88 34357.5,-2632.88 34354,-2642.88 34361,-2642.88"/>
</g>
<!-- layer1_attn_norm_gpu6 -->
<g id="node330" class="node">
<title>layer1_attn_norm_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="34479.5,-2315 34235.5,-2315 34235.5,-2247 34479.5,-2247 34479.5,-2315"/>
<text text-anchor="middle" x="34357.5" y="-2299.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU6</text>
<text text-anchor="middle" x="34357.5" y="-2284.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="34357.5" y="-2269.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34357.5" y="-2254.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_attn_proj_gpu6&#45;&gt;layer1_attn_norm_gpu6 -->
<g id="edge561" class="edge">
<title>layer1_attn_proj_gpu6&#45;&gt;layer1_attn_norm_gpu6</title>
<path fill="none" stroke="black" d="M34357.5,-2564.33C34357.5,-2506.93 34357.5,-2389.12 34357.5,-2325.33"/>
<polygon fill="black" stroke="black" points="34361,-2325.2 34357.5,-2315.2 34354,-2325.2 34361,-2325.2"/>
</g>
<!-- layer1_attn_proj_gpu6&#45;&gt;layer1_allreduce_attn -->
<g id="edge657" class="edge">
<title>layer1_attn_proj_gpu6&#45;&gt;layer1_allreduce_attn</title>
<path fill="none" stroke="black" d="M34257.3,-2570.11C34239.74,-2565.56 34221.62,-2561.02 34204.5,-2557 34082.01,-2528.25 33941.67,-2499.83 33840.57,-2480.15"/>
<polygon fill="black" stroke="black" points="33841.08,-2476.69 33830.6,-2478.22 33839.75,-2483.56 33841.08,-2476.69"/>
</g>
<!-- layer1_gate_gpu6 -->
<g id="node331" class="node">
<title>layer1_gate_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="41053.5,-2177 40809.5,-2177 40809.5,-2094 41053.5,-2094 41053.5,-2177"/>
<text text-anchor="middle" x="40931.5" y="-2161.8" font-family="Times,serif" font-size="14.00">L1_Gate_GPU6</text>
<text text-anchor="middle" x="40931.5" y="-2146.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="40931.5" y="-2131.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="40931.5" y="-2116.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="40931.5" y="-2101.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_attn_norm_gpu6&#45;&gt;layer1_gate_gpu6 -->
<g id="edge562" class="edge">
<title>layer1_attn_norm_gpu6&#45;&gt;layer1_gate_gpu6</title>
<path fill="none" stroke="black" d="M34408.53,-2246.92C34431.92,-2233.64 34460.59,-2219.87 34488.5,-2213 34586.85,-2188.8 38033.22,-2178.23 38134.5,-2177 39160.3,-2164.51 40397.66,-2145.06 40798.97,-2138.64"/>
<polygon fill="black" stroke="black" points="40799.22,-2142.13 40809.16,-2138.47 40799.11,-2135.13 40799.22,-2142.13"/>
</g>
<!-- layer1_expert6_0 -->
<g id="node332" class="node">
<title>layer1_expert6_0</title>
<polygon fill="lightgreen" stroke="black" points="39733,-2058 39568,-2058 39568,-1975 39733,-1975 39733,-2058"/>
<text text-anchor="middle" x="39650.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU6</text>
<text text-anchor="middle" x="39650.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="39650.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="39650.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="39650.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_0 -->
<g id="edge563" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40809.05,-2132.1C40551.44,-2126.18 39960,-2107.75 39743.18,-2058.11"/>
<polygon fill="black" stroke="black" points="39743.68,-2054.63 39733.14,-2055.73 39742.06,-2061.44 39743.68,-2054.63"/>
</g>
<!-- layer1_expert6_1 -->
<g id="node333" class="node">
<title>layer1_expert6_1</title>
<polygon fill="lightgreen" stroke="black" points="39916,-2058 39751,-2058 39751,-1975 39916,-1975 39916,-2058"/>
<text text-anchor="middle" x="39833.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU6</text>
<text text-anchor="middle" x="39833.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="39833.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="39833.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="39833.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_1 -->
<g id="edge564" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40809.26,-2130.44C40583.14,-2122.08 40106.86,-2100.29 39926.08,-2058.1"/>
<polygon fill="black" stroke="black" points="39926.69,-2054.65 39916.15,-2055.68 39925.04,-2061.45 39926.69,-2054.65"/>
</g>
<!-- layer1_expert6_2 -->
<g id="node334" class="node">
<title>layer1_expert6_2</title>
<polygon fill="lightgreen" stroke="black" points="40099,-2058 39934,-2058 39934,-1975 40099,-1975 40099,-2058"/>
<text text-anchor="middle" x="40016.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU6</text>
<text text-anchor="middle" x="40016.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="40016.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="40016.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="40016.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_2 -->
<g id="edge565" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40809.36,-2128.05C40617.78,-2117.12 40254.32,-2092.96 40109.23,-2058.15"/>
<polygon fill="black" stroke="black" points="40109.72,-2054.66 40099.17,-2055.62 40108.01,-2061.45 40109.72,-2054.66"/>
</g>
<!-- layer1_expert6_3 -->
<g id="node335" class="node">
<title>layer1_expert6_3</title>
<polygon fill="lightgreen" stroke="black" points="40282,-2058 40117,-2058 40117,-1975 40282,-1975 40282,-2058"/>
<text text-anchor="middle" x="40199.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU6</text>
<text text-anchor="middle" x="40199.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="40199.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="40199.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="40199.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_3 -->
<g id="edge566" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40809.21,-2130.77C40680.95,-2124.4 40474.18,-2107.17 40291.95,-2058.19"/>
<polygon fill="black" stroke="black" points="40292.76,-2054.78 40282.19,-2055.53 40290.92,-2061.53 40292.76,-2054.78"/>
</g>
<!-- layer1_expert6_4 -->
<g id="node336" class="node">
<title>layer1_expert6_4</title>
<polygon fill="lightgreen" stroke="black" points="40465,-2058 40300,-2058 40300,-1975 40465,-1975 40465,-2058"/>
<text text-anchor="middle" x="40382.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU6</text>
<text text-anchor="middle" x="40382.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="40382.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="40382.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="40382.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_4 -->
<g id="edge567" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40809.05,-2122.58C40718.24,-2111.76 40591.81,-2092.52 40475.06,-2058.28"/>
<polygon fill="black" stroke="black" points="40475.82,-2054.86 40465.24,-2055.36 40473.83,-2061.57 40475.82,-2054.86"/>
</g>
<!-- layer1_expert6_5 -->
<g id="node337" class="node">
<title>layer1_expert6_5</title>
<polygon fill="lightgreen" stroke="black" points="40648,-2058 40483,-2058 40483,-1975 40648,-1975 40648,-2058"/>
<text text-anchor="middle" x="40565.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU6</text>
<text text-anchor="middle" x="40565.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="40565.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="40565.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="40565.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_5 -->
<g id="edge568" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40809.47,-2104.69C40763.95,-2092.56 40711.87,-2077.48 40657.56,-2058.26"/>
<polygon fill="black" stroke="black" points="40658.71,-2054.96 40648.12,-2054.89 40656.35,-2061.55 40658.71,-2054.96"/>
</g>
<!-- layer1_expert6_6 -->
<g id="node338" class="node">
<title>layer1_expert6_6</title>
<polygon fill="lightgreen" stroke="black" points="40831,-2058 40666,-2058 40666,-1975 40831,-1975 40831,-2058"/>
<text text-anchor="middle" x="40748.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU6</text>
<text text-anchor="middle" x="40748.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="40748.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="40748.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="40748.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_6 -->
<g id="edge569" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40868.01,-2093.91C40852.68,-2084.11 40836.19,-2073.56 40820.5,-2063.53"/>
<polygon fill="black" stroke="black" points="40822.19,-2060.46 40811.88,-2058.02 40818.42,-2066.36 40822.19,-2060.46"/>
</g>
<!-- layer1_expert6_7 -->
<g id="node339" class="node">
<title>layer1_expert6_7</title>
<polygon fill="lightgreen" stroke="black" points="41014,-2058 40849,-2058 40849,-1975 41014,-1975 41014,-2058"/>
<text text-anchor="middle" x="40931.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU6</text>
<text text-anchor="middle" x="40931.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="40931.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="40931.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="40931.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_7 -->
<g id="edge570" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40931.5,-2093.91C40931.5,-2085.65 40931.5,-2076.86 40931.5,-2068.3"/>
<polygon fill="black" stroke="black" points="40935,-2068.02 40931.5,-2058.02 40928,-2068.02 40935,-2068.02"/>
</g>
<!-- layer1_expert6_8 -->
<g id="node340" class="node">
<title>layer1_expert6_8</title>
<polygon fill="lightgreen" stroke="black" points="41197,-2058 41032,-2058 41032,-1975 41197,-1975 41197,-2058"/>
<text text-anchor="middle" x="41114.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU6</text>
<text text-anchor="middle" x="41114.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="41114.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="41114.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="41114.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_8 -->
<g id="edge571" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40994.99,-2093.91C41010.32,-2084.11 41026.81,-2073.56 41042.5,-2063.53"/>
<polygon fill="black" stroke="black" points="41044.58,-2066.36 41051.12,-2058.02 41040.81,-2060.46 41044.58,-2066.36"/>
</g>
<!-- layer1_expert6_9 -->
<g id="node341" class="node">
<title>layer1_expert6_9</title>
<polygon fill="lightgreen" stroke="black" points="41380,-2058 41215,-2058 41215,-1975 41380,-1975 41380,-2058"/>
<text text-anchor="middle" x="41297.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU6</text>
<text text-anchor="middle" x="41297.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="41297.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="41297.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="41297.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_9 -->
<g id="edge572" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M41053.72,-2104.37C41101.54,-2091.55 41156.55,-2075.51 41205.5,-2058 41205.6,-2057.97 41205.7,-2057.93 41205.79,-2057.9"/>
<polygon fill="black" stroke="black" points="41206.81,-2061.25 41214.97,-2054.49 41204.38,-2054.69 41206.81,-2061.25"/>
</g>
<!-- layer1_expert6_10 -->
<g id="node342" class="node">
<title>layer1_expert6_10</title>
<polygon fill="lightgreen" stroke="black" points="41563,-2058 41398,-2058 41398,-1975 41563,-1975 41563,-2058"/>
<text text-anchor="middle" x="41480.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU6</text>
<text text-anchor="middle" x="41480.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="41480.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="41480.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="41480.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_10 -->
<g id="edge573" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M41053.64,-2122.42C41144.24,-2111.52 41270.39,-2092.25 41387.96,-2057.94"/>
<polygon fill="black" stroke="black" points="41389.26,-2061.2 41397.86,-2055.01 41387.28,-2054.49 41389.26,-2061.2"/>
</g>
<!-- layer1_expert6_11 -->
<g id="node343" class="node">
<title>layer1_expert6_11</title>
<polygon fill="lightgreen" stroke="black" points="41746,-2058 41581,-2058 41581,-1975 41746,-1975 41746,-2058"/>
<text text-anchor="middle" x="41663.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU6</text>
<text text-anchor="middle" x="41663.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="41663.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="41663.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="41663.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_11 -->
<g id="edge574" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M41053.56,-2130.6C41181.59,-2124.1 41388.01,-2106.76 41571.11,-2057.85"/>
<polygon fill="black" stroke="black" points="41572.18,-2061.19 41580.91,-2055.2 41570.35,-2054.43 41572.18,-2061.19"/>
</g>
<!-- layer1_expert6_12 -->
<g id="node344" class="node">
<title>layer1_expert6_12</title>
<polygon fill="lightgreen" stroke="black" points="41929,-2058 41764,-2058 41764,-1975 41929,-1975 41929,-2058"/>
<text text-anchor="middle" x="41846.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU6</text>
<text text-anchor="middle" x="41846.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="41846.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="41846.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="41846.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_12 -->
<g id="edge575" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M41053.87,-2127.96C41245.31,-2116.93 41607.9,-2092.64 41753.82,-2057.83"/>
<polygon fill="black" stroke="black" points="41755.09,-2061.12 41763.94,-2055.3 41753.39,-2054.33 41755.09,-2061.12"/>
</g>
<!-- layer1_expert6_13 -->
<g id="node345" class="node">
<title>layer1_expert6_13</title>
<polygon fill="lightgreen" stroke="black" points="42112,-2058 41947,-2058 41947,-1975 42112,-1975 42112,-2058"/>
<text text-anchor="middle" x="42029.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU6</text>
<text text-anchor="middle" x="42029.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="42029.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="42029.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="42029.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_13 -->
<g id="edge576" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M41053.6,-2130.37C41279.48,-2121.9 41755.24,-2099.94 41936.97,-2057.78"/>
<polygon fill="black" stroke="black" points="41938.06,-2061.12 41946.96,-2055.37 41936.42,-2054.32 41938.06,-2061.12"/>
</g>
<!-- layer1_expert6_14 -->
<g id="node346" class="node">
<title>layer1_expert6_14</title>
<polygon fill="lightgreen" stroke="black" points="42295,-2058 42130,-2058 42130,-1975 42295,-1975 42295,-2058"/>
<text text-anchor="middle" x="42212.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU6</text>
<text text-anchor="middle" x="42212.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="42212.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="42212.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="42212.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_14 -->
<g id="edge577" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M41053.83,-2132.04C41311.32,-2125.99 41902.68,-2107.3 42120.21,-2057.73"/>
<polygon fill="black" stroke="black" points="42121.04,-2061.13 42129.97,-2055.42 42119.43,-2054.31 42121.04,-2061.13"/>
</g>
<!-- layer1_expert6_15 -->
<g id="node347" class="node">
<title>layer1_expert6_15</title>
<polygon fill="lightgreen" stroke="black" points="42478,-2058 42313,-2058 42313,-1975 42478,-1975 42478,-2058"/>
<text text-anchor="middle" x="42395.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU6</text>
<text text-anchor="middle" x="42395.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="42395.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="42395.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="42395.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gate_gpu6&#45;&gt;layer1_expert6_15 -->
<g id="edge578" class="edge">
<title>layer1_gate_gpu6&#45;&gt;layer1_expert6_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M41053.56,-2133.27C41339.91,-2129.51 42049.07,-2114.8 42303.05,-2057.76"/>
<polygon fill="black" stroke="black" points="42304.03,-2061.13 42312.98,-2055.45 42302.45,-2054.31 42304.03,-2061.13"/>
</g>
<!-- layer1_moe_agg_gpu6 -->
<g id="node348" class="node">
<title>layer1_moe_agg_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="40942,-1939 40739,-1939 40739,-1856 40942,-1856 40942,-1939"/>
<text text-anchor="middle" x="40840.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU6</text>
<text text-anchor="middle" x="40840.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="40840.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="40840.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="40840.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_expert6_0&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge579" class="edge">
<title>layer1_expert6_0&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M39733.14,-1977.29C39735.94,-1976.46 39738.73,-1975.69 39741.5,-1975 39926.06,-1929.03 40487.21,-1908.31 40728.39,-1901.36"/>
<polygon fill="black" stroke="black" points="40728.68,-1904.85 40738.58,-1901.07 40728.48,-1897.86 40728.68,-1904.85"/>
</g>
<!-- layer1_expert6_1&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge580" class="edge">
<title>layer1_expert6_1&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M39916.16,-1977.34C39918.95,-1976.49 39921.74,-1975.71 39924.5,-1975 40073.74,-1936.73 40518.96,-1912.67 40728.77,-1903.16"/>
<polygon fill="black" stroke="black" points="40729.05,-1906.65 40738.88,-1902.7 40728.74,-1899.65 40729.05,-1906.65"/>
</g>
<!-- layer1_expert6_2&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge581" class="edge">
<title>layer1_expert6_2&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M40099.18,-1977.42C40101.96,-1976.55 40104.74,-1975.74 40107.5,-1975 40322.21,-1917.57 40583.02,-1902.86 40728.52,-1899.33"/>
<polygon fill="black" stroke="black" points="40728.88,-1902.82 40738.8,-1899.09 40728.72,-1895.82 40728.88,-1902.82"/>
</g>
<!-- layer1_expert6_3&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge582" class="edge">
<title>layer1_expert6_3&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M40282.21,-1977.54C40284.99,-1976.64 40287.76,-1975.78 40290.5,-1975 40438.74,-1932.62 40616.4,-1913.34 40728.88,-1904.83"/>
<polygon fill="black" stroke="black" points="40729.17,-1908.32 40738.89,-1904.09 40728.65,-1901.34 40729.17,-1908.32"/>
</g>
<!-- layer1_expert6_4&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge583" class="edge">
<title>layer1_expert6_4&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M40465.03,-1977.87C40467.87,-1976.86 40470.7,-1975.9 40473.5,-1975 40557.36,-1947.94 40655.16,-1928.11 40728.7,-1915.42"/>
<polygon fill="black" stroke="black" points="40729.65,-1918.81 40738.92,-1913.68 40728.47,-1911.91 40729.65,-1918.81"/>
</g>
<!-- layer1_expert6_5&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge584" class="edge">
<title>layer1_expert6_5&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M40648.29,-1978.55C40651.06,-1977.35 40653.8,-1976.16 40656.5,-1975 40680.87,-1964.51 40707.16,-1953.44 40732.02,-1943.08"/>
<polygon fill="black" stroke="black" points="40733.59,-1946.22 40741.48,-1939.14 40730.9,-1939.75 40733.59,-1946.22"/>
</g>
<!-- layer1_expert6_6&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge585" class="edge">
<title>layer1_expert6_6&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M40780.42,-1974.91C40787.48,-1965.92 40795.04,-1956.32 40802.32,-1947.05"/>
<polygon fill="black" stroke="black" points="40805.21,-1949.05 40808.64,-1939.02 40799.7,-1944.72 40805.21,-1949.05"/>
</g>
<!-- layer1_expert6_7&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge586" class="edge">
<title>layer1_expert6_7&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M40899.93,-1974.91C40892.94,-1965.92 40885.47,-1956.32 40878.26,-1947.05"/>
<polygon fill="black" stroke="black" points="40880.92,-1944.77 40872.02,-1939.02 40875.39,-1949.06 40880.92,-1944.77"/>
</g>
<!-- layer1_expert6_8&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge587" class="edge">
<title>layer1_expert6_8&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M41031.78,-1979.01C41028.65,-1977.65 41025.55,-1976.31 41022.5,-1975 40998.21,-1964.55 40972.03,-1953.45 40947.31,-1943.04"/>
<polygon fill="black" stroke="black" points="40948.49,-1939.74 40937.91,-1939.09 40945.78,-1946.19 40948.49,-1939.74"/>
</g>
<!-- layer1_expert6_9&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge588" class="edge">
<title>layer1_expert6_9&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M41214.81,-1978.15C41211.68,-1977.04 41208.57,-1975.99 41205.5,-1975 41122.34,-1948.3 41025.46,-1928.5 40952.42,-1915.74"/>
<polygon fill="black" stroke="black" points="40952.73,-1912.24 40942.28,-1913.98 40951.54,-1919.13 40952.73,-1912.24"/>
</g>
<!-- layer1_expert6_10&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge589" class="edge">
<title>layer1_expert6_10&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M41397.89,-1977.88C41394.74,-1976.85 41391.61,-1975.88 41388.5,-1975 41241.09,-1933.14 41064.61,-1913.74 40952.53,-1905.07"/>
<polygon fill="black" stroke="black" points="40952.46,-1901.55 40942.22,-1904.29 40951.93,-1908.53 40952.46,-1901.55"/>
</g>
<!-- layer1_expert6_11&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge590" class="edge">
<title>layer1_expert6_11&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M41580.93,-1977.74C41577.77,-1976.75 41574.62,-1975.83 41571.5,-1975 41357.42,-1918.17 41097.57,-1903.24 40952.44,-1899.51"/>
<polygon fill="black" stroke="black" points="40952.28,-1896.01 40942.2,-1899.26 40952.11,-1903 40952.28,-1896.01"/>
</g>
<!-- layer1_expert6_12&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge591" class="edge">
<title>layer1_expert6_12&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M41763.95,-1977.66C41760.79,-1976.69 41757.63,-1975.8 41754.5,-1975 41605.61,-1937.12 41161.87,-1912.88 40952.37,-1903.24"/>
<polygon fill="black" stroke="black" points="40952.42,-1899.74 40942.27,-1902.78 40952.1,-1906.73 40952.42,-1899.74"/>
</g>
<!-- layer1_expert6_13&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge592" class="edge">
<title>layer1_expert6_13&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M41946.96,-1977.6C41943.8,-1976.65 41940.63,-1975.77 41937.5,-1975 41753.18,-1929.47 41193.1,-1908.51 40952.4,-1901.43"/>
<polygon fill="black" stroke="black" points="40952.32,-1897.92 40942.22,-1901.13 40952.12,-1904.92 40952.32,-1897.92"/>
</g>
<!-- layer1_expert6_14&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge593" class="edge">
<title>layer1_expert6_14&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M42129.97,-1977.56C42126.8,-1976.62 42123.64,-1975.76 42120.5,-1975 41900.45,-1921.81 41222.13,-1904.85 40952.6,-1900.13"/>
<polygon fill="black" stroke="black" points="40952.46,-1896.62 40942.4,-1899.95 40952.34,-1903.62 40952.46,-1896.62"/>
</g>
<!-- layer1_expert6_15&#45;&gt;layer1_moe_agg_gpu6 -->
<g id="edge594" class="edge">
<title>layer1_expert6_15&#45;&gt;layer1_moe_agg_gpu6</title>
<path fill="none" stroke="black" d="M42312.98,-1977.53C42309.81,-1976.6 42306.64,-1975.75 42303.5,-1975 42047.34,-1914.09 41248.57,-1901.66 40952.44,-1899.14"/>
<polygon fill="black" stroke="black" points="40952.15,-1895.64 40942.12,-1899.05 40952.09,-1902.64 40952.15,-1895.64"/>
</g>
<!-- layer1_output_gpu6 -->
<g id="node349" class="node">
<title>layer1_output_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="34459.5,-1614 34215.5,-1614 34215.5,-1546 34459.5,-1546 34459.5,-1614"/>
<text text-anchor="middle" x="34337.5" y="-1598.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU6</text>
<text text-anchor="middle" x="34337.5" y="-1583.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="34337.5" y="-1568.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34337.5" y="-1553.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_moe_agg_gpu6&#45;&gt;layer1_output_gpu6 -->
<g id="edge595" class="edge">
<title>layer1_moe_agg_gpu6&#45;&gt;layer1_output_gpu6</title>
<path fill="none" stroke="black" d="M40738.77,-1894.95C40352.83,-1888.86 38942.11,-1864.67 37780.5,-1820 37734.47,-1818.23 34512.99,-1659.95 34468.5,-1648 34444.54,-1641.57 34419.9,-1630.37 34398.55,-1618.95"/>
<polygon fill="black" stroke="black" points="34400.07,-1615.79 34389.62,-1614.06 34396.71,-1621.93 34400.07,-1615.79"/>
</g>
<!-- layer1_moe_agg_gpu6&#45;&gt;layer1_allreduce_moe -->
<g id="edge659" class="edge">
<title>layer1_moe_agg_gpu6&#45;&gt;layer1_allreduce_moe</title>
<path fill="none" stroke="black" d="M40738.95,-1894.43C39969.1,-1878.74 35053.87,-1778.55 33999.48,-1757.06"/>
<polygon fill="black" stroke="black" points="33999.22,-1753.55 33989.15,-1756.85 33999.07,-1760.55 33999.22,-1753.55"/>
</g>
<!-- layer1_output_gpu6&#45;&gt;pipeline_stage0_1 -->
<g id="edge671" class="edge">
<title>layer1_output_gpu6&#45;&gt;pipeline_stage0_1</title>
<path fill="none" stroke="black" d="M34281.31,-1545.9C34258.69,-1533.75 34231.97,-1520.82 34206.5,-1512 34103.59,-1476.36 33984.8,-1451.74 33886.36,-1435.53"/>
<polygon fill="black" stroke="black" points="33886.73,-1432.04 33876.29,-1433.89 33885.6,-1438.95 33886.73,-1432.04"/>
</g>
<!-- layer1_qkv_gpu7 -->
<g id="node350" class="node">
<title>layer1_qkv_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="34724.5,-2908 34514.5,-2908 34514.5,-2810 34724.5,-2810 34724.5,-2908"/>
<text text-anchor="middle" x="34619.5" y="-2892.8" font-family="Times,serif" font-size="14.00">L1_QKV_Projection_GPU7</text>
<text text-anchor="middle" x="34619.5" y="-2877.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="34619.5" y="-2862.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="34619.5" y="-2847.8" font-family="Times,serif" font-size="14.00">Heads: 28&#45;31</text>
<text text-anchor="middle" x="34619.5" y="-2832.8" font-family="Times,serif" font-size="14.00">TP Slice: 7</text>
<text text-anchor="middle" x="34619.5" y="-2817.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_attn_gpu7 -->
<g id="node351" class="node">
<title>layer1_attn_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="34741,-2766.5 34498,-2766.5 34498,-2683.5 34741,-2683.5 34741,-2766.5"/>
<text text-anchor="middle" x="34619.5" y="-2751.3" font-family="Times,serif" font-size="14.00">L1_Multi&#45;Head_Attention_GPU7</text>
<text text-anchor="middle" x="34619.5" y="-2736.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="34619.5" y="-2721.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34619.5" y="-2706.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="34619.5" y="-2691.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_qkv_gpu7&#45;&gt;layer1_attn_gpu7 -->
<g id="edge596" class="edge">
<title>layer1_qkv_gpu7&#45;&gt;layer1_attn_gpu7</title>
<path fill="none" stroke="black" d="M34619.5,-2809.97C34619.5,-2799.25 34619.5,-2787.84 34619.5,-2776.99"/>
<polygon fill="black" stroke="black" points="34623,-2776.82 34619.5,-2766.82 34616,-2776.82 34623,-2776.82"/>
</g>
<!-- layer1_attn_proj_gpu7 -->
<g id="node352" class="node">
<title>layer1_attn_proj_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="34719.5,-2632.5 34519.5,-2632.5 34519.5,-2564.5 34719.5,-2564.5 34719.5,-2632.5"/>
<text text-anchor="middle" x="34619.5" y="-2617.3" font-family="Times,serif" font-size="14.00">L1_Attn_Projection_GPU7</text>
<text text-anchor="middle" x="34619.5" y="-2602.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="34619.5" y="-2587.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34619.5" y="-2572.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_attn_gpu7&#45;&gt;layer1_attn_proj_gpu7 -->
<g id="edge597" class="edge">
<title>layer1_attn_gpu7&#45;&gt;layer1_attn_proj_gpu7</title>
<path fill="none" stroke="black" d="M34619.5,-2683.23C34619.5,-2670.36 34619.5,-2656.1 34619.5,-2643.04"/>
<polygon fill="black" stroke="black" points="34623,-2642.88 34619.5,-2632.88 34616,-2642.88 34623,-2642.88"/>
</g>
<!-- layer1_attn_norm_gpu7 -->
<g id="node353" class="node">
<title>layer1_attn_norm_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="34741.5,-2315 34497.5,-2315 34497.5,-2247 34741.5,-2247 34741.5,-2315"/>
<text text-anchor="middle" x="34619.5" y="-2299.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU7</text>
<text text-anchor="middle" x="34619.5" y="-2284.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="34619.5" y="-2269.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34619.5" y="-2254.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_attn_proj_gpu7&#45;&gt;layer1_attn_norm_gpu7 -->
<g id="edge598" class="edge">
<title>layer1_attn_proj_gpu7&#45;&gt;layer1_attn_norm_gpu7</title>
<path fill="none" stroke="black" d="M34619.5,-2564.33C34619.5,-2506.93 34619.5,-2389.12 34619.5,-2325.33"/>
<polygon fill="black" stroke="black" points="34623,-2325.2 34619.5,-2315.2 34616,-2325.2 34623,-2325.2"/>
</g>
<!-- layer1_attn_proj_gpu7&#45;&gt;layer1_allreduce_attn -->
<g id="edge661" class="edge">
<title>layer1_attn_proj_gpu7&#45;&gt;layer1_allreduce_attn</title>
<path fill="none" stroke="black" d="M34519.1,-2569.01C34501.65,-2564.61 34483.61,-2560.4 34466.5,-2557 34261.79,-2516.27 34022.97,-2486.94 33867.56,-2470.24"/>
<polygon fill="black" stroke="black" points="33867.76,-2466.74 33857.45,-2469.16 33867.02,-2473.7 33867.76,-2466.74"/>
</g>
<!-- layer1_gate_gpu7 -->
<g id="node354" class="node">
<title>layer1_gate_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="43981.5,-2177 43737.5,-2177 43737.5,-2094 43981.5,-2094 43981.5,-2177"/>
<text text-anchor="middle" x="43859.5" y="-2161.8" font-family="Times,serif" font-size="14.00">L1_Gate_GPU7</text>
<text text-anchor="middle" x="43859.5" y="-2146.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="43859.5" y="-2131.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="43859.5" y="-2116.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="43859.5" y="-2101.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_attn_norm_gpu7&#45;&gt;layer1_gate_gpu7 -->
<g id="edge599" class="edge">
<title>layer1_attn_norm_gpu7&#45;&gt;layer1_gate_gpu7</title>
<path fill="none" stroke="black" d="M34741.84,-2278.1C35750.42,-2262.44 42680.6,-2154.81 43727.22,-2138.55"/>
<polygon fill="black" stroke="black" points="43727.47,-2142.05 43737.41,-2138.4 43727.36,-2135.05 43727.47,-2142.05"/>
</g>
<!-- layer1_expert7_0 -->
<g id="node355" class="node">
<title>layer1_expert7_0</title>
<polygon fill="lightgreen" stroke="black" points="42661,-2058 42496,-2058 42496,-1975 42661,-1975 42661,-2058"/>
<text text-anchor="middle" x="42578.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert0_GPU7</text>
<text text-anchor="middle" x="42578.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="42578.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="42578.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="42578.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_0 -->
<g id="edge600" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43737.05,-2132.1C43479.44,-2126.18 42888,-2107.75 42671.18,-2058.11"/>
<polygon fill="black" stroke="black" points="42671.68,-2054.63 42661.14,-2055.73 42670.06,-2061.44 42671.68,-2054.63"/>
</g>
<!-- layer1_expert7_1 -->
<g id="node356" class="node">
<title>layer1_expert7_1</title>
<polygon fill="lightgreen" stroke="black" points="42844,-2058 42679,-2058 42679,-1975 42844,-1975 42844,-2058"/>
<text text-anchor="middle" x="42761.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert1_GPU7</text>
<text text-anchor="middle" x="42761.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="42761.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="42761.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="42761.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_1 -->
<g id="edge601" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43737.26,-2130.44C43511.14,-2122.08 43034.86,-2100.29 42854.08,-2058.1"/>
<polygon fill="black" stroke="black" points="42854.69,-2054.65 42844.15,-2055.68 42853.04,-2061.45 42854.69,-2054.65"/>
</g>
<!-- layer1_expert7_2 -->
<g id="node357" class="node">
<title>layer1_expert7_2</title>
<polygon fill="lightgreen" stroke="black" points="43027,-2058 42862,-2058 42862,-1975 43027,-1975 43027,-2058"/>
<text text-anchor="middle" x="42944.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert2_GPU7</text>
<text text-anchor="middle" x="42944.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="42944.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="42944.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="42944.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_2 -->
<g id="edge602" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43737.36,-2128.05C43545.78,-2117.12 43182.32,-2092.96 43037.23,-2058.15"/>
<polygon fill="black" stroke="black" points="43037.72,-2054.66 43027.17,-2055.62 43036.01,-2061.45 43037.72,-2054.66"/>
</g>
<!-- layer1_expert7_3 -->
<g id="node358" class="node">
<title>layer1_expert7_3</title>
<polygon fill="lightgreen" stroke="black" points="43210,-2058 43045,-2058 43045,-1975 43210,-1975 43210,-2058"/>
<text text-anchor="middle" x="43127.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert3_GPU7</text>
<text text-anchor="middle" x="43127.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="43127.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="43127.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="43127.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_3 -->
<g id="edge603" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43737.21,-2130.77C43608.95,-2124.4 43402.18,-2107.17 43219.95,-2058.19"/>
<polygon fill="black" stroke="black" points="43220.76,-2054.78 43210.19,-2055.53 43218.92,-2061.53 43220.76,-2054.78"/>
</g>
<!-- layer1_expert7_4 -->
<g id="node359" class="node">
<title>layer1_expert7_4</title>
<polygon fill="lightgreen" stroke="black" points="43393,-2058 43228,-2058 43228,-1975 43393,-1975 43393,-2058"/>
<text text-anchor="middle" x="43310.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert4_GPU7</text>
<text text-anchor="middle" x="43310.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="43310.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="43310.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="43310.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_4 -->
<g id="edge604" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43737.05,-2122.58C43646.24,-2111.76 43519.81,-2092.52 43403.06,-2058.28"/>
<polygon fill="black" stroke="black" points="43403.82,-2054.86 43393.24,-2055.36 43401.83,-2061.57 43403.82,-2054.86"/>
</g>
<!-- layer1_expert7_5 -->
<g id="node360" class="node">
<title>layer1_expert7_5</title>
<polygon fill="lightgreen" stroke="black" points="43576,-2058 43411,-2058 43411,-1975 43576,-1975 43576,-2058"/>
<text text-anchor="middle" x="43493.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert5_GPU7</text>
<text text-anchor="middle" x="43493.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="43493.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="43493.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="43493.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_5 -->
<g id="edge605" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43737.47,-2104.69C43691.95,-2092.56 43639.87,-2077.48 43585.56,-2058.26"/>
<polygon fill="black" stroke="black" points="43586.71,-2054.96 43576.12,-2054.89 43584.35,-2061.55 43586.71,-2054.96"/>
</g>
<!-- layer1_expert7_6 -->
<g id="node361" class="node">
<title>layer1_expert7_6</title>
<polygon fill="lightgreen" stroke="black" points="43759,-2058 43594,-2058 43594,-1975 43759,-1975 43759,-2058"/>
<text text-anchor="middle" x="43676.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert6_GPU7</text>
<text text-anchor="middle" x="43676.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="43676.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="43676.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="43676.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_6 -->
<g id="edge606" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43796.01,-2093.91C43780.68,-2084.11 43764.19,-2073.56 43748.5,-2063.53"/>
<polygon fill="black" stroke="black" points="43750.19,-2060.46 43739.88,-2058.02 43746.42,-2066.36 43750.19,-2060.46"/>
</g>
<!-- layer1_expert7_7 -->
<g id="node362" class="node">
<title>layer1_expert7_7</title>
<polygon fill="lightgreen" stroke="black" points="43942,-2058 43777,-2058 43777,-1975 43942,-1975 43942,-2058"/>
<text text-anchor="middle" x="43859.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert7_GPU7</text>
<text text-anchor="middle" x="43859.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="43859.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="43859.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="43859.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_7 -->
<g id="edge607" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43859.5,-2093.91C43859.5,-2085.65 43859.5,-2076.86 43859.5,-2068.3"/>
<polygon fill="black" stroke="black" points="43863,-2068.02 43859.5,-2058.02 43856,-2068.02 43863,-2068.02"/>
</g>
<!-- layer1_expert7_8 -->
<g id="node363" class="node">
<title>layer1_expert7_8</title>
<polygon fill="lightgreen" stroke="black" points="44125,-2058 43960,-2058 43960,-1975 44125,-1975 44125,-2058"/>
<text text-anchor="middle" x="44042.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert8_GPU7</text>
<text text-anchor="middle" x="44042.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="44042.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="44042.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="44042.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_8 -->
<g id="edge608" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43922.99,-2093.91C43938.32,-2084.11 43954.81,-2073.56 43970.5,-2063.53"/>
<polygon fill="black" stroke="black" points="43972.58,-2066.36 43979.12,-2058.02 43968.81,-2060.46 43972.58,-2066.36"/>
</g>
<!-- layer1_expert7_9 -->
<g id="node364" class="node">
<title>layer1_expert7_9</title>
<polygon fill="lightgreen" stroke="black" points="44308,-2058 44143,-2058 44143,-1975 44308,-1975 44308,-2058"/>
<text text-anchor="middle" x="44225.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert9_GPU7</text>
<text text-anchor="middle" x="44225.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="44225.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="44225.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="44225.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_9 -->
<g id="edge609" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43981.72,-2104.37C44029.54,-2091.55 44084.55,-2075.51 44133.5,-2058 44133.6,-2057.97 44133.7,-2057.93 44133.79,-2057.9"/>
<polygon fill="black" stroke="black" points="44134.81,-2061.25 44142.97,-2054.49 44132.38,-2054.69 44134.81,-2061.25"/>
</g>
<!-- layer1_expert7_10 -->
<g id="node365" class="node">
<title>layer1_expert7_10</title>
<polygon fill="lightgreen" stroke="black" points="44491,-2058 44326,-2058 44326,-1975 44491,-1975 44491,-2058"/>
<text text-anchor="middle" x="44408.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert10_GPU7</text>
<text text-anchor="middle" x="44408.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="44408.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="44408.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="44408.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_10 -->
<g id="edge610" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43981.64,-2122.42C44072.24,-2111.52 44198.39,-2092.25 44315.96,-2057.94"/>
<polygon fill="black" stroke="black" points="44317.26,-2061.2 44325.86,-2055.01 44315.28,-2054.49 44317.26,-2061.2"/>
</g>
<!-- layer1_expert7_11 -->
<g id="node366" class="node">
<title>layer1_expert7_11</title>
<polygon fill="lightgreen" stroke="black" points="44674,-2058 44509,-2058 44509,-1975 44674,-1975 44674,-2058"/>
<text text-anchor="middle" x="44591.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert11_GPU7</text>
<text text-anchor="middle" x="44591.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="44591.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="44591.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="44591.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_11 -->
<g id="edge611" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43981.56,-2130.6C44109.59,-2124.1 44316.01,-2106.76 44499.11,-2057.85"/>
<polygon fill="black" stroke="black" points="44500.18,-2061.19 44508.91,-2055.2 44498.35,-2054.43 44500.18,-2061.19"/>
</g>
<!-- layer1_expert7_12 -->
<g id="node367" class="node">
<title>layer1_expert7_12</title>
<polygon fill="lightgreen" stroke="black" points="44857,-2058 44692,-2058 44692,-1975 44857,-1975 44857,-2058"/>
<text text-anchor="middle" x="44774.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert12_GPU7</text>
<text text-anchor="middle" x="44774.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="44774.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="44774.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="44774.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_12 -->
<g id="edge612" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43981.87,-2127.96C44173.31,-2116.93 44535.9,-2092.64 44681.82,-2057.83"/>
<polygon fill="black" stroke="black" points="44683.09,-2061.12 44691.94,-2055.3 44681.39,-2054.33 44683.09,-2061.12"/>
</g>
<!-- layer1_expert7_13 -->
<g id="node368" class="node">
<title>layer1_expert7_13</title>
<polygon fill="lightgreen" stroke="black" points="45040,-2058 44875,-2058 44875,-1975 45040,-1975 45040,-2058"/>
<text text-anchor="middle" x="44957.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert13_GPU7</text>
<text text-anchor="middle" x="44957.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="44957.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="44957.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="44957.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_13 -->
<g id="edge613" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43981.6,-2130.37C44207.48,-2121.9 44683.24,-2099.94 44864.97,-2057.78"/>
<polygon fill="black" stroke="black" points="44866.06,-2061.12 44874.96,-2055.37 44864.42,-2054.32 44866.06,-2061.12"/>
</g>
<!-- layer1_expert7_14 -->
<g id="node369" class="node">
<title>layer1_expert7_14</title>
<polygon fill="lightgreen" stroke="black" points="45223,-2058 45058,-2058 45058,-1975 45223,-1975 45223,-2058"/>
<text text-anchor="middle" x="45140.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert14_GPU7</text>
<text text-anchor="middle" x="45140.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="45140.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="45140.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="45140.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_14 -->
<g id="edge614" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43981.83,-2132.04C44239.32,-2125.99 44830.68,-2107.3 45048.21,-2057.73"/>
<polygon fill="black" stroke="black" points="45049.04,-2061.13 45057.97,-2055.42 45047.43,-2054.31 45049.04,-2061.13"/>
</g>
<!-- layer1_expert7_15 -->
<g id="node370" class="node">
<title>layer1_expert7_15</title>
<polygon fill="lightgreen" stroke="black" points="45406,-2058 45241,-2058 45241,-1975 45406,-1975 45406,-2058"/>
<text text-anchor="middle" x="45323.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L1_Expert15_GPU7</text>
<text text-anchor="middle" x="45323.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="45323.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="45323.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="45323.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gate_gpu7&#45;&gt;layer1_expert7_15 -->
<g id="edge615" class="edge">
<title>layer1_gate_gpu7&#45;&gt;layer1_expert7_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43981.56,-2133.27C44267.91,-2129.51 44977.07,-2114.8 45231.05,-2057.76"/>
<polygon fill="black" stroke="black" points="45232.03,-2061.13 45240.98,-2055.45 45230.45,-2054.31 45232.03,-2061.13"/>
</g>
<!-- layer1_moe_agg_gpu7 -->
<g id="node371" class="node">
<title>layer1_moe_agg_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="43870,-1939 43667,-1939 43667,-1856 43870,-1856 43870,-1939"/>
<text text-anchor="middle" x="43768.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L1_MoE_Aggregate_GPU7</text>
<text text-anchor="middle" x="43768.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="43768.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="43768.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="43768.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_expert7_0&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge616" class="edge">
<title>layer1_expert7_0&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M42661.14,-1977.29C42663.94,-1976.46 42666.73,-1975.69 42669.5,-1975 42854.06,-1929.03 43415.21,-1908.31 43656.39,-1901.36"/>
<polygon fill="black" stroke="black" points="43656.68,-1904.85 43666.58,-1901.07 43656.48,-1897.86 43656.68,-1904.85"/>
</g>
<!-- layer1_expert7_1&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge617" class="edge">
<title>layer1_expert7_1&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M42844.16,-1977.34C42846.95,-1976.49 42849.74,-1975.71 42852.5,-1975 43001.74,-1936.73 43446.96,-1912.67 43656.77,-1903.16"/>
<polygon fill="black" stroke="black" points="43657.05,-1906.65 43666.88,-1902.7 43656.74,-1899.65 43657.05,-1906.65"/>
</g>
<!-- layer1_expert7_2&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge618" class="edge">
<title>layer1_expert7_2&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M43027.18,-1977.42C43029.96,-1976.55 43032.74,-1975.74 43035.5,-1975 43250.21,-1917.57 43511.02,-1902.86 43656.52,-1899.33"/>
<polygon fill="black" stroke="black" points="43656.88,-1902.82 43666.8,-1899.09 43656.72,-1895.82 43656.88,-1902.82"/>
</g>
<!-- layer1_expert7_3&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge619" class="edge">
<title>layer1_expert7_3&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M43210.21,-1977.54C43212.99,-1976.64 43215.76,-1975.78 43218.5,-1975 43366.74,-1932.62 43544.4,-1913.34 43656.88,-1904.83"/>
<polygon fill="black" stroke="black" points="43657.17,-1908.32 43666.89,-1904.09 43656.65,-1901.34 43657.17,-1908.32"/>
</g>
<!-- layer1_expert7_4&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge620" class="edge">
<title>layer1_expert7_4&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M43393.03,-1977.87C43395.87,-1976.86 43398.7,-1975.9 43401.5,-1975 43485.36,-1947.94 43583.16,-1928.11 43656.7,-1915.42"/>
<polygon fill="black" stroke="black" points="43657.65,-1918.81 43666.92,-1913.68 43656.47,-1911.91 43657.65,-1918.81"/>
</g>
<!-- layer1_expert7_5&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge621" class="edge">
<title>layer1_expert7_5&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M43576.29,-1978.55C43579.06,-1977.35 43581.8,-1976.16 43584.5,-1975 43608.87,-1964.51 43635.16,-1953.44 43660.02,-1943.08"/>
<polygon fill="black" stroke="black" points="43661.59,-1946.22 43669.48,-1939.14 43658.9,-1939.75 43661.59,-1946.22"/>
</g>
<!-- layer1_expert7_6&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge622" class="edge">
<title>layer1_expert7_6&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M43708.42,-1974.91C43715.48,-1965.92 43723.04,-1956.32 43730.32,-1947.05"/>
<polygon fill="black" stroke="black" points="43733.21,-1949.05 43736.64,-1939.02 43727.7,-1944.72 43733.21,-1949.05"/>
</g>
<!-- layer1_expert7_7&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge623" class="edge">
<title>layer1_expert7_7&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M43827.93,-1974.91C43820.94,-1965.92 43813.47,-1956.32 43806.26,-1947.05"/>
<polygon fill="black" stroke="black" points="43808.92,-1944.77 43800.02,-1939.02 43803.39,-1949.06 43808.92,-1944.77"/>
</g>
<!-- layer1_expert7_8&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge624" class="edge">
<title>layer1_expert7_8&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M43959.78,-1979.01C43956.65,-1977.65 43953.55,-1976.31 43950.5,-1975 43926.21,-1964.55 43900.03,-1953.45 43875.31,-1943.04"/>
<polygon fill="black" stroke="black" points="43876.49,-1939.74 43865.91,-1939.09 43873.78,-1946.19 43876.49,-1939.74"/>
</g>
<!-- layer1_expert7_9&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge625" class="edge">
<title>layer1_expert7_9&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M44142.81,-1978.15C44139.68,-1977.04 44136.57,-1975.99 44133.5,-1975 44050.34,-1948.3 43953.46,-1928.5 43880.42,-1915.74"/>
<polygon fill="black" stroke="black" points="43880.73,-1912.24 43870.28,-1913.98 43879.54,-1919.13 43880.73,-1912.24"/>
</g>
<!-- layer1_expert7_10&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge626" class="edge">
<title>layer1_expert7_10&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M44325.89,-1977.88C44322.74,-1976.85 44319.61,-1975.88 44316.5,-1975 44169.09,-1933.14 43992.61,-1913.74 43880.53,-1905.07"/>
<polygon fill="black" stroke="black" points="43880.46,-1901.55 43870.22,-1904.29 43879.93,-1908.53 43880.46,-1901.55"/>
</g>
<!-- layer1_expert7_11&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge627" class="edge">
<title>layer1_expert7_11&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M44508.93,-1977.74C44505.77,-1976.75 44502.62,-1975.83 44499.5,-1975 44285.42,-1918.17 44025.57,-1903.24 43880.44,-1899.51"/>
<polygon fill="black" stroke="black" points="43880.28,-1896.01 43870.2,-1899.26 43880.11,-1903 43880.28,-1896.01"/>
</g>
<!-- layer1_expert7_12&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge628" class="edge">
<title>layer1_expert7_12&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M44691.95,-1977.66C44688.79,-1976.69 44685.63,-1975.8 44682.5,-1975 44533.61,-1937.12 44089.87,-1912.88 43880.37,-1903.24"/>
<polygon fill="black" stroke="black" points="43880.42,-1899.74 43870.27,-1902.78 43880.1,-1906.73 43880.42,-1899.74"/>
</g>
<!-- layer1_expert7_13&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge629" class="edge">
<title>layer1_expert7_13&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M44874.96,-1977.6C44871.8,-1976.65 44868.63,-1975.77 44865.5,-1975 44681.18,-1929.47 44121.1,-1908.51 43880.4,-1901.43"/>
<polygon fill="black" stroke="black" points="43880.32,-1897.92 43870.22,-1901.13 43880.12,-1904.92 43880.32,-1897.92"/>
</g>
<!-- layer1_expert7_14&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge630" class="edge">
<title>layer1_expert7_14&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M45057.97,-1977.56C45054.8,-1976.62 45051.64,-1975.76 45048.5,-1975 44828.45,-1921.81 44150.13,-1904.85 43880.6,-1900.13"/>
<polygon fill="black" stroke="black" points="43880.46,-1896.62 43870.4,-1899.95 43880.34,-1903.62 43880.46,-1896.62"/>
</g>
<!-- layer1_expert7_15&#45;&gt;layer1_moe_agg_gpu7 -->
<g id="edge631" class="edge">
<title>layer1_expert7_15&#45;&gt;layer1_moe_agg_gpu7</title>
<path fill="none" stroke="black" d="M45240.98,-1977.53C45237.81,-1976.6 45234.64,-1975.75 45231.5,-1975 44975.34,-1914.09 44176.57,-1901.66 43880.44,-1899.14"/>
<polygon fill="black" stroke="black" points="43880.15,-1895.64 43870.12,-1899.05 43880.09,-1902.64 43880.15,-1895.64"/>
</g>
<!-- layer1_output_gpu7 -->
<g id="node372" class="node">
<title>layer1_output_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="34721.5,-1614 34477.5,-1614 34477.5,-1546 34721.5,-1546 34721.5,-1614"/>
<text text-anchor="middle" x="34599.5" y="-1598.8" font-family="Times,serif" font-size="14.00">L1_Residual+LayerNorm_GPU7</text>
<text text-anchor="middle" x="34599.5" y="-1583.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="34599.5" y="-1568.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34599.5" y="-1553.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_moe_agg_gpu7&#45;&gt;layer1_output_gpu7 -->
<g id="edge632" class="edge">
<title>layer1_moe_agg_gpu7&#45;&gt;layer1_output_gpu7</title>
<path fill="none" stroke="black" d="M43666.71,-1893C42740.47,-1861.13 35781.72,-1621.68 34731.96,-1585.56"/>
<polygon fill="black" stroke="black" points="34731.86,-1582.05 34721.74,-1585.21 34731.62,-1589.05 34731.86,-1582.05"/>
</g>
<!-- layer1_moe_agg_gpu7&#45;&gt;layer1_allreduce_moe -->
<g id="edge663" class="edge">
<title>layer1_moe_agg_gpu7&#45;&gt;layer1_allreduce_moe</title>
<path fill="none" stroke="black" d="M43666.77,-1894.93C43300.25,-1889.28 42012.78,-1869.67 40950.5,-1856 39541.64,-1837.88 39189.34,-1839.86 37780.5,-1820 36330.17,-1799.56 34582.68,-1767.6 34000.21,-1756.75"/>
<polygon fill="black" stroke="black" points="34000.09,-1753.25 33990.03,-1756.56 33999.96,-1760.24 34000.09,-1753.25"/>
</g>
<!-- layer1_output_gpu7&#45;&gt;pipeline_stage0_1 -->
<g id="edge672" class="edge">
<title>layer1_output_gpu7&#45;&gt;pipeline_stage0_1</title>
<path fill="none" stroke="black" d="M34545.19,-1545.93C34522.28,-1533.4 34494.84,-1520.19 34468.5,-1512 34271.4,-1450.7 34035.45,-1425.87 33873.84,-1415.82"/>
<polygon fill="black" stroke="black" points="33873.98,-1412.32 33863.79,-1415.21 33873.55,-1419.31 33873.98,-1412.32"/>
</g>
<!-- layer1_allreduce_attn&#45;&gt;layer1_attn_norm_gpu0 -->
<g id="edge634" class="edge">
<title>layer1_allreduce_attn&#45;&gt;layer1_attn_norm_gpu0</title>
<path fill="none" stroke="black" d="M33520.82,-2445.77C33359.05,-2436.11 33117.57,-2411.53 32916.5,-2349 32893.55,-2341.86 32869.78,-2330.92 32848.89,-2319.94"/>
<polygon fill="black" stroke="black" points="32850.28,-2316.71 32839.81,-2315.07 32846.97,-2322.88 32850.28,-2316.71"/>
</g>
<!-- layer1_allreduce_attn&#45;&gt;layer1_attn_norm_gpu1 -->
<g id="edge638" class="edge">
<title>layer1_allreduce_attn&#45;&gt;layer1_attn_norm_gpu1</title>
<path fill="none" stroke="black" d="M33555.34,-2434.26C33448.7,-2418.73 33302.14,-2391.82 33178.5,-2349 33156.32,-2341.32 33133.18,-2330.52 33112.63,-2319.82"/>
<polygon fill="black" stroke="black" points="33114.16,-2316.68 33103.69,-2315.1 33110.89,-2322.87 33114.16,-2316.68"/>
</g>
<!-- layer1_allreduce_attn&#45;&gt;layer1_attn_norm_gpu2 -->
<g id="edge642" class="edge">
<title>layer1_allreduce_attn&#45;&gt;layer1_attn_norm_gpu2</title>
<path fill="none" stroke="black" d="M33606.67,-2416.91C33556.65,-2397.95 33494.74,-2373.46 33440.5,-2349 33420.7,-2340.07 33399.6,-2329.68 33380.25,-2319.79"/>
<polygon fill="black" stroke="black" points="33381.69,-2316.59 33371.2,-2315.13 33378.49,-2322.82 33381.69,-2316.59"/>
</g>
<!-- layer1_allreduce_attn&#45;&gt;layer1_attn_norm_gpu3 -->
<g id="edge646" class="edge">
<title>layer1_allreduce_attn&#45;&gt;layer1_attn_norm_gpu3</title>
<path fill="none" stroke="black" d="M33661.41,-2398.68C33642.63,-2374.31 33620.73,-2345.88 33603.24,-2323.19"/>
<polygon fill="black" stroke="black" points="33605.89,-2320.9 33597.01,-2315.11 33600.35,-2325.17 33605.89,-2320.9"/>
</g>
<!-- layer1_allreduce_attn&#45;&gt;layer1_attn_norm_gpu4 -->
<g id="edge650" class="edge">
<title>layer1_allreduce_attn&#45;&gt;layer1_attn_norm_gpu4</title>
<path fill="none" stroke="black" d="M33743.59,-2398.68C33762.37,-2374.31 33784.27,-2345.88 33801.76,-2323.19"/>
<polygon fill="black" stroke="black" points="33804.65,-2325.17 33807.99,-2315.11 33799.11,-2320.9 33804.65,-2325.17"/>
</g>
<!-- layer1_allreduce_attn&#45;&gt;layer1_attn_norm_gpu5 -->
<g id="edge654" class="edge">
<title>layer1_allreduce_attn&#45;&gt;layer1_attn_norm_gpu5</title>
<path fill="none" stroke="black" d="M33798.33,-2416.91C33848.35,-2397.95 33910.26,-2373.46 33964.5,-2349 33984.3,-2340.07 34005.4,-2329.68 34024.75,-2319.79"/>
<polygon fill="black" stroke="black" points="34026.51,-2322.82 34033.8,-2315.13 34023.31,-2316.59 34026.51,-2322.82"/>
</g>
<!-- layer1_allreduce_attn&#45;&gt;layer1_attn_norm_gpu6 -->
<g id="edge658" class="edge">
<title>layer1_allreduce_attn&#45;&gt;layer1_attn_norm_gpu6</title>
<path fill="none" stroke="black" d="M33849.66,-2434.26C33956.3,-2418.73 34102.86,-2391.82 34226.5,-2349 34248.68,-2341.32 34271.82,-2330.52 34292.37,-2319.82"/>
<polygon fill="black" stroke="black" points="34294.11,-2322.87 34301.31,-2315.1 34290.84,-2316.68 34294.11,-2322.87"/>
</g>
<!-- layer1_allreduce_attn&#45;&gt;layer1_attn_norm_gpu7 -->
<g id="edge662" class="edge">
<title>layer1_allreduce_attn&#45;&gt;layer1_attn_norm_gpu7</title>
<path fill="none" stroke="black" d="M33884.18,-2445.77C34045.95,-2436.11 34287.43,-2411.53 34488.5,-2349 34511.45,-2341.86 34535.22,-2330.92 34556.11,-2319.94"/>
<polygon fill="black" stroke="black" points="34558.03,-2322.88 34565.19,-2315.07 34554.72,-2316.71 34558.03,-2322.88"/>
</g>
<!-- layer1_allreduce_moe&#45;&gt;layer1_output_gpu0 -->
<g id="edge636" class="edge">
<title>layer1_allreduce_moe&#45;&gt;layer1_output_gpu0</title>
<path fill="none" stroke="black" d="M33606.44,-1748.87C33420.59,-1742.19 33134.11,-1719.71 32896.5,-1648 32873.28,-1640.99 32849.27,-1629.97 32828.24,-1618.87"/>
<polygon fill="black" stroke="black" points="32829.89,-1615.78 32819.43,-1614.12 32826.57,-1621.94 32829.89,-1615.78"/>
</g>
<!-- layer1_allreduce_moe&#45;&gt;layer1_output_gpu1 -->
<g id="edge640" class="edge">
<title>layer1_allreduce_moe&#45;&gt;layer1_output_gpu1</title>
<path fill="none" stroke="black" d="M33636.23,-1738.92C33504.5,-1725.87 33316.23,-1699.56 33158.5,-1648 33135.87,-1640.6 33112.35,-1629.71 33091.59,-1618.85"/>
<polygon fill="black" stroke="black" points="33093.04,-1615.65 33082.57,-1614.04 33089.75,-1621.83 33093.04,-1615.65"/>
</g>
<!-- layer1_allreduce_moe&#45;&gt;layer1_output_gpu2 -->
<g id="edge644" class="edge">
<title>layer1_allreduce_moe&#45;&gt;layer1_output_gpu2</title>
<path fill="none" stroke="black" d="M33678.64,-1724.8C33603.06,-1706.89 33504.66,-1680.52 33420.5,-1648 33399.22,-1639.78 33376.84,-1629.13 33356.72,-1618.76"/>
<polygon fill="black" stroke="black" points="33358.13,-1615.55 33347.65,-1614.03 33354.89,-1621.76 33358.13,-1615.55"/>
</g>
<!-- layer1_allreduce_moe&#45;&gt;layer1_output_gpu3 -->
<g id="edge648" class="edge">
<title>layer1_allreduce_moe&#45;&gt;layer1_output_gpu3</title>
<path fill="none" stroke="black" d="M33734.43,-1705.89C33695.18,-1679.09 33645.92,-1645.46 33608.4,-1619.85"/>
<polygon fill="black" stroke="black" points="33610.33,-1616.93 33600.1,-1614.18 33606.39,-1622.71 33610.33,-1616.93"/>
</g>
<!-- layer1_allreduce_moe&#45;&gt;layer1_output_gpu4 -->
<g id="edge652" class="edge">
<title>layer1_allreduce_moe&#45;&gt;layer1_output_gpu4</title>
<path fill="none" stroke="black" d="M33805.53,-1685.27C33807.09,-1664.87 33808.77,-1642.91 33810.18,-1624.42"/>
<polygon fill="black" stroke="black" points="33813.68,-1624.5 33810.96,-1614.26 33806.7,-1623.96 33813.68,-1624.5"/>
</g>
<!-- layer1_allreduce_moe&#45;&gt;layer1_output_gpu5 -->
<g id="edge656" class="edge">
<title>layer1_allreduce_moe&#45;&gt;layer1_output_gpu5</title>
<path fill="none" stroke="black" d="M33870.96,-1707.44C33914.88,-1680.29 33970.88,-1645.67 34013.18,-1619.52"/>
<polygon fill="black" stroke="black" points="34015.05,-1622.48 34021.72,-1614.25 34011.37,-1616.53 34015.05,-1622.48"/>
</g>
<!-- layer1_allreduce_moe&#45;&gt;layer1_output_gpu6 -->
<g id="edge660" class="edge">
<title>layer1_allreduce_moe&#45;&gt;layer1_output_gpu6</title>
<path fill="none" stroke="black" d="M33927.57,-1726.45C34008.76,-1708.89 34115.49,-1682.32 34206.5,-1648 34227.95,-1639.91 34250.47,-1629.26 34270.66,-1618.83"/>
<polygon fill="black" stroke="black" points="34272.52,-1621.81 34279.76,-1614.07 34269.28,-1615.61 34272.52,-1621.81"/>
</g>
<!-- layer1_allreduce_moe&#45;&gt;layer1_output_gpu7 -->
<g id="edge664" class="edge">
<title>layer1_allreduce_moe&#45;&gt;layer1_output_gpu7</title>
<path fill="none" stroke="black" d="M33967.94,-1740.08C34105.15,-1727.62 34302.98,-1701.54 34468.5,-1648 34491.15,-1640.67 34514.68,-1629.8 34535.43,-1618.93"/>
<polygon fill="black" stroke="black" points="34537.28,-1621.91 34544.46,-1614.12 34533.98,-1615.74 34537.28,-1621.91"/>
</g>
<!-- stage1_header -->
<g id="node375" class="node">
<title>stage1_header</title>
<ellipse fill="lightblue" stroke="black" cx="45404.5" cy="-2859" rx="114.6" ry="26.76"/>
<ellipse fill="none" stroke="black" cx="45404.5" cy="-2859" rx="118.6" ry="30.74"/>
<text text-anchor="middle" x="45404.5" y="-2862.8" font-family="Times,serif" font-size="14.00">Stage 1 (GPUs 8&#45;15)</text>
<text text-anchor="middle" x="45404.5" y="-2847.8" font-family="Times,serif" font-size="14.00">Layers 2&#45;3</text>
</g>
<!-- layer2_qkv_gpu8 -->
<g id="node376" class="node">
<title>layer2_qkv_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="32901.5,-1304 32691.5,-1304 32691.5,-1206 32901.5,-1206 32901.5,-1304"/>
<text text-anchor="middle" x="32796.5" y="-1288.8" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU8</text>
<text text-anchor="middle" x="32796.5" y="-1273.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="32796.5" y="-1258.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="32796.5" y="-1243.8" font-family="Times,serif" font-size="14.00">Heads: 0&#45;3</text>
<text text-anchor="middle" x="32796.5" y="-1228.8" font-family="Times,serif" font-size="14.00">TP Slice: 0</text>
<text text-anchor="middle" x="32796.5" y="-1213.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_attn_gpu8 -->
<g id="node377" class="node">
<title>layer2_attn_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="32872,-1170 32629,-1170 32629,-1087 32872,-1087 32872,-1170"/>
<text text-anchor="middle" x="32750.5" y="-1154.8" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU8</text>
<text text-anchor="middle" x="32750.5" y="-1139.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="32750.5" y="-1124.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="32750.5" y="-1109.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="32750.5" y="-1094.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_qkv_gpu8&#45;&gt;layer2_attn_gpu8 -->
<g id="edge681" class="edge">
<title>layer2_qkv_gpu8&#45;&gt;layer2_attn_gpu8</title>
<path fill="none" stroke="black" d="M32778.72,-1205.87C32775.56,-1197.31 32772.26,-1188.39 32769.08,-1179.78"/>
<polygon fill="black" stroke="black" points="32772.3,-1178.4 32765.55,-1170.23 32765.73,-1180.82 32772.3,-1178.4"/>
</g>
<!-- layer2_attn_proj_gpu8 -->
<g id="node378" class="node">
<title>layer2_attn_proj_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="32850.5,-1051 32650.5,-1051 32650.5,-983 32850.5,-983 32850.5,-1051"/>
<text text-anchor="middle" x="32750.5" y="-1035.8" font-family="Times,serif" font-size="14.00">L2_Attn_Projection_GPU8</text>
<text text-anchor="middle" x="32750.5" y="-1020.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="32750.5" y="-1005.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="32750.5" y="-990.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_attn_gpu8&#45;&gt;layer2_attn_proj_gpu8 -->
<g id="edge682" class="edge">
<title>layer2_attn_gpu8&#45;&gt;layer2_attn_proj_gpu8</title>
<path fill="none" stroke="black" d="M32750.5,-1086.73C32750.5,-1078.52 32750.5,-1069.86 32750.5,-1061.56"/>
<polygon fill="black" stroke="black" points="32754,-1061.3 32750.5,-1051.3 32747,-1061.3 32754,-1061.3"/>
</g>
<!-- layer2_attn_norm_gpu8 -->
<g id="node379" class="node">
<title>layer2_attn_norm_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="32869.5,-775 32625.5,-775 32625.5,-707 32869.5,-707 32869.5,-775"/>
<text text-anchor="middle" x="32747.5" y="-759.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU8</text>
<text text-anchor="middle" x="32747.5" y="-744.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="32747.5" y="-729.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="32747.5" y="-714.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_attn_proj_gpu8&#45;&gt;layer2_attn_norm_gpu8 -->
<g id="edge683" class="edge">
<title>layer2_attn_proj_gpu8&#45;&gt;layer2_attn_norm_gpu8</title>
<path fill="none" stroke="black" d="M32750.14,-982.95C32749.6,-933.47 32748.57,-840.12 32747.97,-785.27"/>
<polygon fill="black" stroke="black" points="32751.47,-785.13 32747.86,-775.17 32744.47,-785.21 32751.47,-785.13"/>
</g>
<!-- layer2_allreduce_attn -->
<g id="node560" class="node">
<title>layer2_allreduce_attn</title>
<polygon fill="lightcoral" stroke="black" points="33682.5,-947 33479.5,-879 33682.5,-811 33885.5,-879 33682.5,-947"/>
<text text-anchor="middle" x="33682.5" y="-897.8" font-family="Times,serif" font-size="14.00">L2_All&#45;Reduce_Attention</text>
<text text-anchor="middle" x="33682.5" y="-882.8" font-family="Times,serif" font-size="14.00">Input: 8×[1024,2048,512]</text>
<text text-anchor="middle" x="33682.5" y="-867.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="33682.5" y="-852.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
</g>
<!-- layer2_attn_proj_gpu8&#45;&gt;layer2_allreduce_attn -->
<g id="edge977" class="edge">
<title>layer2_attn_proj_gpu8&#45;&gt;layer2_allreduce_attn</title>
<path fill="none" stroke="black" d="M32850.84,-992.99C32868.02,-989.4 32885.74,-985.92 32902.5,-983 33115.15,-945.94 33362.49,-915.39 33520.66,-897.43"/>
<polygon fill="black" stroke="black" points="33521.41,-900.86 33530.95,-896.26 33520.62,-893.91 33521.41,-900.86"/>
</g>
<!-- layer2_gate_gpu8 -->
<g id="node380" class="node">
<title>layer2_gate_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="23648.5,-671 23404.5,-671 23404.5,-588 23648.5,-588 23648.5,-671"/>
<text text-anchor="middle" x="23526.5" y="-655.8" font-family="Times,serif" font-size="14.00">L2_Gate_GPU8</text>
<text text-anchor="middle" x="23526.5" y="-640.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="23526.5" y="-625.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="23526.5" y="-610.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="23526.5" y="-595.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_attn_norm_gpu8&#45;&gt;layer2_gate_gpu8 -->
<g id="edge684" class="edge">
<title>layer2_attn_norm_gpu8&#45;&gt;layer2_gate_gpu8</title>
<path fill="none" stroke="black" d="M32625.29,-738.86C31976.18,-732.75 28866.63,-703.07 26323.5,-671 25297.7,-658.06 24060.34,-638.9 23659.03,-632.59"/>
<polygon fill="black" stroke="black" points="23658.89,-629.09 23648.84,-632.43 23658.78,-636.09 23658.89,-629.09"/>
</g>
<!-- layer2_expert8_0 -->
<g id="node381" class="node">
<title>layer2_expert8_0</title>
<polygon fill="lightgreen" stroke="black" points="22145,-552 21980,-552 21980,-469 22145,-469 22145,-552"/>
<text text-anchor="middle" x="22062.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU8</text>
<text text-anchor="middle" x="22062.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="22062.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="22062.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="22062.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_0 -->
<g id="edge685" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23404.34,-627.34C23117.75,-623.72 22408,-609.31 22155.02,-552.07"/>
<polygon fill="black" stroke="black" points="22155.67,-548.63 22145.13,-549.76 22154.07,-555.44 22155.67,-548.63"/>
</g>
<!-- layer2_expert8_1 -->
<g id="node382" class="node">
<title>layer2_expert8_1</title>
<polygon fill="lightgreen" stroke="black" points="22328,-552 22163,-552 22163,-469 22328,-469 22328,-552"/>
<text text-anchor="middle" x="22245.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU8</text>
<text text-anchor="middle" x="22245.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="22245.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="22245.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="22245.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_1 -->
<g id="edge686" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23404.05,-626.1C23146.44,-620.18 22555,-601.75 22338.18,-552.11"/>
<polygon fill="black" stroke="black" points="22338.68,-548.63 22328.14,-549.73 22337.06,-555.44 22338.68,-548.63"/>
</g>
<!-- layer2_expert8_2 -->
<g id="node383" class="node">
<title>layer2_expert8_2</title>
<polygon fill="lightgreen" stroke="black" points="22511,-552 22346,-552 22346,-469 22511,-469 22511,-552"/>
<text text-anchor="middle" x="22428.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU8</text>
<text text-anchor="middle" x="22428.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="22428.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="22428.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="22428.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_2 -->
<g id="edge687" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23404.26,-624.44C23178.14,-616.08 22701.86,-594.29 22521.08,-552.1"/>
<polygon fill="black" stroke="black" points="22521.69,-548.65 22511.15,-549.68 22520.04,-555.45 22521.69,-548.65"/>
</g>
<!-- layer2_expert8_3 -->
<g id="node384" class="node">
<title>layer2_expert8_3</title>
<polygon fill="lightgreen" stroke="black" points="22694,-552 22529,-552 22529,-469 22694,-469 22694,-552"/>
<text text-anchor="middle" x="22611.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU8</text>
<text text-anchor="middle" x="22611.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="22611.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="22611.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="22611.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_3 -->
<g id="edge688" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23404.36,-622.05C23212.78,-611.12 22849.32,-586.96 22704.23,-552.15"/>
<polygon fill="black" stroke="black" points="22704.72,-548.66 22694.17,-549.62 22703.01,-555.45 22704.72,-548.66"/>
</g>
<!-- layer2_expert8_4 -->
<g id="node385" class="node">
<title>layer2_expert8_4</title>
<polygon fill="lightgreen" stroke="black" points="22877,-552 22712,-552 22712,-469 22877,-469 22877,-552"/>
<text text-anchor="middle" x="22794.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU8</text>
<text text-anchor="middle" x="22794.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="22794.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="22794.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="22794.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_4 -->
<g id="edge689" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23404.21,-624.77C23275.95,-618.4 23069.18,-601.17 22886.95,-552.19"/>
<polygon fill="black" stroke="black" points="22887.76,-548.78 22877.19,-549.53 22885.92,-555.53 22887.76,-548.78"/>
</g>
<!-- layer2_expert8_5 -->
<g id="node386" class="node">
<title>layer2_expert8_5</title>
<polygon fill="lightgreen" stroke="black" points="23060,-552 22895,-552 22895,-469 23060,-469 23060,-552"/>
<text text-anchor="middle" x="22977.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU8</text>
<text text-anchor="middle" x="22977.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="22977.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="22977.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="22977.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_5 -->
<g id="edge690" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23404.05,-616.58C23313.24,-605.76 23186.81,-586.52 23070.06,-552.28"/>
<polygon fill="black" stroke="black" points="23070.82,-548.86 23060.24,-549.36 23068.83,-555.57 23070.82,-548.86"/>
</g>
<!-- layer2_expert8_6 -->
<g id="node387" class="node">
<title>layer2_expert8_6</title>
<polygon fill="lightgreen" stroke="black" points="23243,-552 23078,-552 23078,-469 23243,-469 23243,-552"/>
<text text-anchor="middle" x="23160.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU8</text>
<text text-anchor="middle" x="23160.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="23160.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="23160.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="23160.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_6 -->
<g id="edge691" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23404.47,-598.69C23358.95,-586.56 23306.87,-571.48 23252.56,-552.26"/>
<polygon fill="black" stroke="black" points="23253.71,-548.96 23243.12,-548.89 23251.35,-555.55 23253.71,-548.96"/>
</g>
<!-- layer2_expert8_7 -->
<g id="node388" class="node">
<title>layer2_expert8_7</title>
<polygon fill="lightgreen" stroke="black" points="23426,-552 23261,-552 23261,-469 23426,-469 23426,-552"/>
<text text-anchor="middle" x="23343.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU8</text>
<text text-anchor="middle" x="23343.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="23343.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="23343.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="23343.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_7 -->
<g id="edge692" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23463.01,-587.91C23447.68,-578.11 23431.19,-567.56 23415.5,-557.53"/>
<polygon fill="black" stroke="black" points="23417.19,-554.46 23406.88,-552.02 23413.42,-560.36 23417.19,-554.46"/>
</g>
<!-- layer2_expert8_8 -->
<g id="node389" class="node">
<title>layer2_expert8_8</title>
<polygon fill="lightgreen" stroke="black" points="23609,-552 23444,-552 23444,-469 23609,-469 23609,-552"/>
<text text-anchor="middle" x="23526.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU8</text>
<text text-anchor="middle" x="23526.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="23526.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="23526.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="23526.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_8 -->
<g id="edge693" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23526.5,-587.91C23526.5,-579.65 23526.5,-570.86 23526.5,-562.3"/>
<polygon fill="black" stroke="black" points="23530,-562.02 23526.5,-552.02 23523,-562.02 23530,-562.02"/>
</g>
<!-- layer2_expert8_9 -->
<g id="node390" class="node">
<title>layer2_expert8_9</title>
<polygon fill="lightgreen" stroke="black" points="23792,-552 23627,-552 23627,-469 23792,-469 23792,-552"/>
<text text-anchor="middle" x="23709.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU8</text>
<text text-anchor="middle" x="23709.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="23709.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="23709.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="23709.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_9 -->
<g id="edge694" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23589.99,-587.91C23605.32,-578.11 23621.81,-567.56 23637.5,-557.53"/>
<polygon fill="black" stroke="black" points="23639.58,-560.36 23646.12,-552.02 23635.81,-554.46 23639.58,-560.36"/>
</g>
<!-- layer2_expert8_10 -->
<g id="node391" class="node">
<title>layer2_expert8_10</title>
<polygon fill="lightgreen" stroke="black" points="23975,-552 23810,-552 23810,-469 23975,-469 23975,-552"/>
<text text-anchor="middle" x="23892.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU8</text>
<text text-anchor="middle" x="23892.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="23892.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="23892.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="23892.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_10 -->
<g id="edge695" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23648.72,-598.37C23696.54,-585.55 23751.55,-569.51 23800.5,-552 23800.6,-551.97 23800.7,-551.93 23800.79,-551.9"/>
<polygon fill="black" stroke="black" points="23801.81,-555.25 23809.97,-548.49 23799.38,-548.69 23801.81,-555.25"/>
</g>
<!-- layer2_expert8_11 -->
<g id="node392" class="node">
<title>layer2_expert8_11</title>
<polygon fill="lightgreen" stroke="black" points="24158,-552 23993,-552 23993,-469 24158,-469 24158,-552"/>
<text text-anchor="middle" x="24075.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU8</text>
<text text-anchor="middle" x="24075.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="24075.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="24075.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="24075.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_11 -->
<g id="edge696" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23648.64,-616.42C23739.24,-605.52 23865.39,-586.25 23982.96,-551.94"/>
<polygon fill="black" stroke="black" points="23984.26,-555.2 23992.86,-549.01 23982.28,-548.49 23984.26,-555.2"/>
</g>
<!-- layer2_expert8_12 -->
<g id="node393" class="node">
<title>layer2_expert8_12</title>
<polygon fill="lightgreen" stroke="black" points="24341,-552 24176,-552 24176,-469 24341,-469 24341,-552"/>
<text text-anchor="middle" x="24258.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU8</text>
<text text-anchor="middle" x="24258.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="24258.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="24258.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="24258.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_12 -->
<g id="edge697" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23648.56,-624.6C23776.59,-618.1 23983.01,-600.76 24166.11,-551.85"/>
<polygon fill="black" stroke="black" points="24167.18,-555.19 24175.91,-549.2 24165.35,-548.43 24167.18,-555.19"/>
</g>
<!-- layer2_expert8_13 -->
<g id="node394" class="node">
<title>layer2_expert8_13</title>
<polygon fill="lightgreen" stroke="black" points="24524,-552 24359,-552 24359,-469 24524,-469 24524,-552"/>
<text text-anchor="middle" x="24441.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU8</text>
<text text-anchor="middle" x="24441.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="24441.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="24441.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="24441.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_13 -->
<g id="edge698" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23648.87,-621.96C23840.31,-610.93 24202.9,-586.64 24348.82,-551.83"/>
<polygon fill="black" stroke="black" points="24350.09,-555.12 24358.94,-549.3 24348.39,-548.33 24350.09,-555.12"/>
</g>
<!-- layer2_expert8_14 -->
<g id="node395" class="node">
<title>layer2_expert8_14</title>
<polygon fill="lightgreen" stroke="black" points="24707,-552 24542,-552 24542,-469 24707,-469 24707,-552"/>
<text text-anchor="middle" x="24624.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU8</text>
<text text-anchor="middle" x="24624.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="24624.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="24624.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="24624.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_14 -->
<g id="edge699" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23648.6,-624.37C23874.48,-615.9 24350.24,-593.94 24531.97,-551.78"/>
<polygon fill="black" stroke="black" points="24533.06,-555.12 24541.96,-549.37 24531.42,-548.32 24533.06,-555.12"/>
</g>
<!-- layer2_expert8_15 -->
<g id="node396" class="node">
<title>layer2_expert8_15</title>
<polygon fill="lightgreen" stroke="black" points="24890,-552 24725,-552 24725,-469 24890,-469 24890,-552"/>
<text text-anchor="middle" x="24807.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU8</text>
<text text-anchor="middle" x="24807.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="24807.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="24807.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="24807.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_gate_gpu8&#45;&gt;layer2_expert8_15 -->
<g id="edge700" class="edge">
<title>layer2_gate_gpu8&#45;&gt;layer2_expert8_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23648.83,-626.04C23906.32,-619.99 24497.68,-601.3 24715.21,-551.73"/>
<polygon fill="black" stroke="black" points="24716.04,-555.13 24724.97,-549.42 24714.43,-548.31 24716.04,-555.13"/>
</g>
<!-- layer2_moe_agg_gpu8 -->
<g id="node397" class="node">
<title>layer2_moe_agg_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="23720,-433 23517,-433 23517,-350 23720,-350 23720,-433"/>
<text text-anchor="middle" x="23618.5" y="-417.8" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU8</text>
<text text-anchor="middle" x="23618.5" y="-402.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="23618.5" y="-387.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="23618.5" y="-372.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="23618.5" y="-357.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_expert8_0&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge701" class="edge">
<title>layer2_expert8_0&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M22145.13,-471.23C22147.93,-470.41 22150.73,-469.67 22153.5,-469 22409.96,-407.47 23210.3,-395.43 23506.66,-393.07"/>
<polygon fill="black" stroke="black" points="23507.02,-396.57 23516.99,-392.99 23506.96,-389.57 23507.02,-396.57"/>
</g>
<!-- layer2_expert8_1&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge702" class="edge">
<title>layer2_expert8_1&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M22328.14,-471.26C22330.94,-470.43 22333.73,-469.68 22336.5,-469 22556.92,-415.25 23237.05,-398.62 23506.7,-394.05"/>
<polygon fill="black" stroke="black" points="23506.96,-397.55 23516.9,-393.88 23506.84,-390.55 23506.96,-397.55"/>
</g>
<!-- layer2_expert8_2&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge703" class="edge">
<title>layer2_expert8_2&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M22511.14,-471.29C22513.94,-470.46 22516.73,-469.69 22519.5,-469 22704.06,-423.03 23265.21,-402.31 23506.39,-395.36"/>
<polygon fill="black" stroke="black" points="23506.68,-398.85 23516.58,-395.07 23506.48,-391.86 23506.68,-398.85"/>
</g>
<!-- layer2_expert8_3&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge704" class="edge">
<title>layer2_expert8_3&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M22694.16,-471.34C22696.95,-470.49 22699.74,-469.71 22702.5,-469 22851.74,-430.73 23296.96,-406.67 23506.77,-397.16"/>
<polygon fill="black" stroke="black" points="23507.05,-400.65 23516.88,-396.7 23506.74,-393.65 23507.05,-400.65"/>
</g>
<!-- layer2_expert8_4&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge705" class="edge">
<title>layer2_expert8_4&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M22877.18,-471.42C22879.96,-470.55 22882.74,-469.74 22885.5,-469 23100.21,-411.57 23361.02,-396.86 23506.52,-393.33"/>
<polygon fill="black" stroke="black" points="23506.88,-396.82 23516.8,-393.09 23506.72,-389.82 23506.88,-396.82"/>
</g>
<!-- layer2_expert8_5&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge706" class="edge">
<title>layer2_expert8_5&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M23060.21,-471.54C23062.99,-470.64 23065.76,-469.78 23068.5,-469 23216.74,-426.62 23394.4,-407.34 23506.88,-398.83"/>
<polygon fill="black" stroke="black" points="23507.17,-402.32 23516.89,-398.09 23506.65,-395.34 23507.17,-402.32"/>
</g>
<!-- layer2_expert8_6&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge707" class="edge">
<title>layer2_expert8_6&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M23243.03,-471.87C23245.87,-470.86 23248.7,-469.9 23251.5,-469 23335.36,-441.94 23433.16,-422.11 23506.7,-409.42"/>
<polygon fill="black" stroke="black" points="23507.65,-412.81 23516.92,-407.68 23506.47,-405.91 23507.65,-412.81"/>
</g>
<!-- layer2_expert8_7&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge708" class="edge">
<title>layer2_expert8_7&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M23426.29,-472.55C23429.06,-471.35 23431.8,-470.16 23434.5,-469 23458.87,-458.51 23485.16,-447.44 23510.02,-437.08"/>
<polygon fill="black" stroke="black" points="23511.59,-440.22 23519.48,-433.14 23508.9,-433.75 23511.59,-440.22"/>
</g>
<!-- layer2_expert8_8&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge709" class="edge">
<title>layer2_expert8_8&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M23558.42,-468.91C23565.48,-459.92 23573.04,-450.32 23580.32,-441.05"/>
<polygon fill="black" stroke="black" points="23583.21,-443.05 23586.64,-433.02 23577.7,-438.72 23583.21,-443.05"/>
</g>
<!-- layer2_expert8_9&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge710" class="edge">
<title>layer2_expert8_9&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M23677.93,-468.91C23670.94,-459.92 23663.47,-450.32 23656.26,-441.05"/>
<polygon fill="black" stroke="black" points="23658.92,-438.77 23650.02,-433.02 23653.39,-443.06 23658.92,-438.77"/>
</g>
<!-- layer2_expert8_10&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge711" class="edge">
<title>layer2_expert8_10&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M23809.78,-473.01C23806.65,-471.65 23803.55,-470.31 23800.5,-469 23776.21,-458.55 23750.03,-447.45 23725.31,-437.04"/>
<polygon fill="black" stroke="black" points="23726.49,-433.74 23715.91,-433.09 23723.78,-440.19 23726.49,-433.74"/>
</g>
<!-- layer2_expert8_11&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge712" class="edge">
<title>layer2_expert8_11&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M23992.81,-472.15C23989.68,-471.04 23986.57,-469.99 23983.5,-469 23900.34,-442.3 23803.46,-422.5 23730.42,-409.74"/>
<polygon fill="black" stroke="black" points="23730.73,-406.24 23720.28,-407.98 23729.54,-413.13 23730.73,-406.24"/>
</g>
<!-- layer2_expert8_12&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge713" class="edge">
<title>layer2_expert8_12&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M24175.89,-471.88C24172.74,-470.85 24169.61,-469.88 24166.5,-469 24019.09,-427.14 23842.61,-407.74 23730.53,-399.07"/>
<polygon fill="black" stroke="black" points="23730.46,-395.55 23720.22,-398.29 23729.93,-402.53 23730.46,-395.55"/>
</g>
<!-- layer2_expert8_13&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge714" class="edge">
<title>layer2_expert8_13&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M24358.93,-471.74C24355.77,-470.75 24352.62,-469.83 24349.5,-469 24135.42,-412.17 23875.57,-397.24 23730.44,-393.51"/>
<polygon fill="black" stroke="black" points="23730.28,-390.01 23720.2,-393.26 23730.11,-397 23730.28,-390.01"/>
</g>
<!-- layer2_expert8_14&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge715" class="edge">
<title>layer2_expert8_14&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M24541.95,-471.66C24538.79,-470.69 24535.63,-469.8 24532.5,-469 24383.61,-431.12 23939.87,-406.88 23730.37,-397.24"/>
<polygon fill="black" stroke="black" points="23730.42,-393.74 23720.27,-396.78 23730.1,-400.73 23730.42,-393.74"/>
</g>
<!-- layer2_expert8_15&#45;&gt;layer2_moe_agg_gpu8 -->
<g id="edge716" class="edge">
<title>layer2_expert8_15&#45;&gt;layer2_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M24724.96,-471.6C24721.8,-470.65 24718.63,-469.77 24715.5,-469 24531.18,-423.47 23971.1,-402.51 23730.4,-395.43"/>
<polygon fill="black" stroke="black" points="23730.32,-391.92 23720.22,-395.13 23730.12,-398.92 23730.32,-391.92"/>
</g>
<!-- layer2_output_gpu8 -->
<g id="node398" class="node">
<title>layer2_output_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="26696.5,-142 26452.5,-142 26452.5,-74 26696.5,-74 26696.5,-142"/>
<text text-anchor="middle" x="26574.5" y="-126.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU8</text>
<text text-anchor="middle" x="26574.5" y="-111.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="26574.5" y="-96.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="26574.5" y="-81.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_moe_agg_gpu8&#45;&gt;layer2_output_gpu8 -->
<g id="edge717" class="edge">
<title>layer2_moe_agg_gpu8&#45;&gt;layer2_output_gpu8</title>
<path fill="none" stroke="black" d="M23720.25,-380.81C24165.27,-338.43 25940.5,-169.38 26441.96,-121.62"/>
<polygon fill="black" stroke="black" points="26442.51,-125.09 26452.13,-120.65 26441.85,-118.12 26442.51,-125.09"/>
</g>
<!-- layer2_allreduce_moe -->
<g id="node561" class="node">
<title>layer2_allreduce_moe</title>
<polygon fill="lightcoral" stroke="black" points="33591.5,-314 33388.5,-246 33591.5,-178 33794.5,-246 33591.5,-314"/>
<text text-anchor="middle" x="33591.5" y="-264.8" font-family="Times,serif" font-size="14.00">L2_All&#45;Reduce_MoE</text>
<text text-anchor="middle" x="33591.5" y="-249.8" font-family="Times,serif" font-size="14.00">Input: 8×[1024,2048,512]</text>
<text text-anchor="middle" x="33591.5" y="-234.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="33591.5" y="-219.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
</g>
<!-- layer2_moe_agg_gpu8&#45;&gt;layer2_allreduce_moe -->
<g id="edge979" class="edge">
<title>layer2_moe_agg_gpu8&#45;&gt;layer2_allreduce_moe</title>
<path fill="none" stroke="black" d="M23720.05,-389.04C24674.68,-375.3 32067.65,-268.93 33389.54,-249.91"/>
<polygon fill="black" stroke="black" points="33389.66,-253.4 33399.61,-249.76 33389.56,-246.41 33389.66,-253.4"/>
</g>
<!-- layer2_qkv_gpu9 -->
<g id="node399" class="node">
<title>layer2_qkv_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="33145.5,-1304 32935.5,-1304 32935.5,-1206 33145.5,-1206 33145.5,-1304"/>
<text text-anchor="middle" x="33040.5" y="-1288.8" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU9</text>
<text text-anchor="middle" x="33040.5" y="-1273.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="33040.5" y="-1258.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="33040.5" y="-1243.8" font-family="Times,serif" font-size="14.00">Heads: 4&#45;7</text>
<text text-anchor="middle" x="33040.5" y="-1228.8" font-family="Times,serif" font-size="14.00">TP Slice: 1</text>
<text text-anchor="middle" x="33040.5" y="-1213.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_attn_gpu9 -->
<g id="node400" class="node">
<title>layer2_attn_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="33133,-1170 32890,-1170 32890,-1087 33133,-1087 33133,-1170"/>
<text text-anchor="middle" x="33011.5" y="-1154.8" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU9</text>
<text text-anchor="middle" x="33011.5" y="-1139.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="33011.5" y="-1124.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33011.5" y="-1109.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="33011.5" y="-1094.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_qkv_gpu9&#45;&gt;layer2_attn_gpu9 -->
<g id="edge718" class="edge">
<title>layer2_qkv_gpu9&#45;&gt;layer2_attn_gpu9</title>
<path fill="none" stroke="black" d="M33029.29,-1205.87C33027.32,-1197.41 33025.26,-1188.58 33023.28,-1180.06"/>
<polygon fill="black" stroke="black" points="33026.66,-1179.18 33020.99,-1170.23 33019.85,-1180.76 33026.66,-1179.18"/>
</g>
<!-- layer2_attn_proj_gpu9 -->
<g id="node401" class="node">
<title>layer2_attn_proj_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="33111.5,-1051 32911.5,-1051 32911.5,-983 33111.5,-983 33111.5,-1051"/>
<text text-anchor="middle" x="33011.5" y="-1035.8" font-family="Times,serif" font-size="14.00">L2_Attn_Projection_GPU9</text>
<text text-anchor="middle" x="33011.5" y="-1020.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="33011.5" y="-1005.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33011.5" y="-990.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_attn_gpu9&#45;&gt;layer2_attn_proj_gpu9 -->
<g id="edge719" class="edge">
<title>layer2_attn_gpu9&#45;&gt;layer2_attn_proj_gpu9</title>
<path fill="none" stroke="black" d="M33011.5,-1086.73C33011.5,-1078.52 33011.5,-1069.86 33011.5,-1061.56"/>
<polygon fill="black" stroke="black" points="33015,-1061.3 33011.5,-1051.3 33008,-1061.3 33015,-1061.3"/>
</g>
<!-- layer2_attn_norm_gpu9 -->
<g id="node402" class="node">
<title>layer2_attn_norm_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="33131.5,-775 32887.5,-775 32887.5,-707 33131.5,-707 33131.5,-775"/>
<text text-anchor="middle" x="33009.5" y="-759.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU9</text>
<text text-anchor="middle" x="33009.5" y="-744.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="33009.5" y="-729.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33009.5" y="-714.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_attn_proj_gpu9&#45;&gt;layer2_attn_norm_gpu9 -->
<g id="edge720" class="edge">
<title>layer2_attn_proj_gpu9&#45;&gt;layer2_attn_norm_gpu9</title>
<path fill="none" stroke="black" d="M33011.26,-982.95C33010.9,-933.47 33010.22,-840.12 33009.82,-785.27"/>
<polygon fill="black" stroke="black" points="33013.32,-785.14 33009.74,-775.17 33006.32,-785.19 33013.32,-785.14"/>
</g>
<!-- layer2_attn_proj_gpu9&#45;&gt;layer2_allreduce_attn -->
<g id="edge981" class="edge">
<title>layer2_attn_proj_gpu9&#45;&gt;layer2_allreduce_attn</title>
<path fill="none" stroke="black" d="M33111.6,-994C33128.9,-990.28 33146.71,-986.49 33163.5,-983 33292.89,-956.12 33440.75,-926.92 33545.47,-906.5"/>
<polygon fill="black" stroke="black" points="33546.32,-909.9 33555.46,-904.55 33544.98,-903.03 33546.32,-909.9"/>
</g>
<!-- layer2_gate_gpu9 -->
<g id="node403" class="node">
<title>layer2_gate_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="26576.5,-671 26332.5,-671 26332.5,-588 26576.5,-588 26576.5,-671"/>
<text text-anchor="middle" x="26454.5" y="-655.8" font-family="Times,serif" font-size="14.00">L2_Gate_GPU9</text>
<text text-anchor="middle" x="26454.5" y="-640.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="26454.5" y="-625.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="26454.5" y="-610.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="26454.5" y="-595.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_attn_norm_gpu9&#45;&gt;layer2_gate_gpu9 -->
<g id="edge721" class="edge">
<title>layer2_attn_norm_gpu9&#45;&gt;layer2_gate_gpu9</title>
<path fill="none" stroke="black" d="M32887.3,-708.25C32884.34,-707.79 32881.41,-707.38 32878.5,-707 32678.65,-681.21 29452.99,-673.46 29251.5,-671 28225.7,-658.48 26988.34,-639.05 26587.03,-632.63"/>
<polygon fill="black" stroke="black" points="26586.89,-629.13 26576.84,-632.47 26586.78,-636.13 26586.89,-629.13"/>
</g>
<!-- layer2_expert9_0 -->
<g id="node404" class="node">
<title>layer2_expert9_0</title>
<polygon fill="lightgreen" stroke="black" points="25073,-552 24908,-552 24908,-469 25073,-469 25073,-552"/>
<text text-anchor="middle" x="24990.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU9</text>
<text text-anchor="middle" x="24990.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="24990.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="24990.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="24990.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_0 -->
<g id="edge722" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26332.34,-627.34C26045.75,-623.72 25336,-609.31 25083.02,-552.07"/>
<polygon fill="black" stroke="black" points="25083.67,-548.63 25073.13,-549.76 25082.07,-555.44 25083.67,-548.63"/>
</g>
<!-- layer2_expert9_1 -->
<g id="node405" class="node">
<title>layer2_expert9_1</title>
<polygon fill="lightgreen" stroke="black" points="25256,-552 25091,-552 25091,-469 25256,-469 25256,-552"/>
<text text-anchor="middle" x="25173.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU9</text>
<text text-anchor="middle" x="25173.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="25173.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="25173.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="25173.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_1 -->
<g id="edge723" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26332.05,-626.1C26074.44,-620.18 25483,-601.75 25266.18,-552.11"/>
<polygon fill="black" stroke="black" points="25266.68,-548.63 25256.14,-549.73 25265.06,-555.44 25266.68,-548.63"/>
</g>
<!-- layer2_expert9_2 -->
<g id="node406" class="node">
<title>layer2_expert9_2</title>
<polygon fill="lightgreen" stroke="black" points="25439,-552 25274,-552 25274,-469 25439,-469 25439,-552"/>
<text text-anchor="middle" x="25356.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU9</text>
<text text-anchor="middle" x="25356.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="25356.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="25356.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="25356.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_2 -->
<g id="edge724" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26332.26,-624.44C26106.14,-616.08 25629.86,-594.29 25449.08,-552.1"/>
<polygon fill="black" stroke="black" points="25449.69,-548.65 25439.15,-549.68 25448.04,-555.45 25449.69,-548.65"/>
</g>
<!-- layer2_expert9_3 -->
<g id="node407" class="node">
<title>layer2_expert9_3</title>
<polygon fill="lightgreen" stroke="black" points="25622,-552 25457,-552 25457,-469 25622,-469 25622,-552"/>
<text text-anchor="middle" x="25539.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU9</text>
<text text-anchor="middle" x="25539.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="25539.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="25539.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="25539.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_3 -->
<g id="edge725" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26332.36,-622.05C26140.78,-611.12 25777.32,-586.96 25632.23,-552.15"/>
<polygon fill="black" stroke="black" points="25632.72,-548.66 25622.17,-549.62 25631.01,-555.45 25632.72,-548.66"/>
</g>
<!-- layer2_expert9_4 -->
<g id="node408" class="node">
<title>layer2_expert9_4</title>
<polygon fill="lightgreen" stroke="black" points="25805,-552 25640,-552 25640,-469 25805,-469 25805,-552"/>
<text text-anchor="middle" x="25722.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU9</text>
<text text-anchor="middle" x="25722.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="25722.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="25722.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="25722.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_4 -->
<g id="edge726" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26332.21,-624.77C26203.95,-618.4 25997.18,-601.17 25814.95,-552.19"/>
<polygon fill="black" stroke="black" points="25815.76,-548.78 25805.19,-549.53 25813.92,-555.53 25815.76,-548.78"/>
</g>
<!-- layer2_expert9_5 -->
<g id="node409" class="node">
<title>layer2_expert9_5</title>
<polygon fill="lightgreen" stroke="black" points="25988,-552 25823,-552 25823,-469 25988,-469 25988,-552"/>
<text text-anchor="middle" x="25905.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU9</text>
<text text-anchor="middle" x="25905.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="25905.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="25905.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="25905.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_5 -->
<g id="edge727" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26332.05,-616.58C26241.24,-605.76 26114.81,-586.52 25998.06,-552.28"/>
<polygon fill="black" stroke="black" points="25998.82,-548.86 25988.24,-549.36 25996.83,-555.57 25998.82,-548.86"/>
</g>
<!-- layer2_expert9_6 -->
<g id="node410" class="node">
<title>layer2_expert9_6</title>
<polygon fill="lightgreen" stroke="black" points="26171,-552 26006,-552 26006,-469 26171,-469 26171,-552"/>
<text text-anchor="middle" x="26088.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU9</text>
<text text-anchor="middle" x="26088.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="26088.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="26088.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="26088.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_6 -->
<g id="edge728" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26332.47,-598.69C26286.95,-586.56 26234.87,-571.48 26180.56,-552.26"/>
<polygon fill="black" stroke="black" points="26181.71,-548.96 26171.12,-548.89 26179.35,-555.55 26181.71,-548.96"/>
</g>
<!-- layer2_expert9_7 -->
<g id="node411" class="node">
<title>layer2_expert9_7</title>
<polygon fill="lightgreen" stroke="black" points="26354,-552 26189,-552 26189,-469 26354,-469 26354,-552"/>
<text text-anchor="middle" x="26271.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU9</text>
<text text-anchor="middle" x="26271.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="26271.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="26271.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="26271.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_7 -->
<g id="edge729" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26391.01,-587.91C26375.68,-578.11 26359.19,-567.56 26343.5,-557.53"/>
<polygon fill="black" stroke="black" points="26345.19,-554.46 26334.88,-552.02 26341.42,-560.36 26345.19,-554.46"/>
</g>
<!-- layer2_expert9_8 -->
<g id="node412" class="node">
<title>layer2_expert9_8</title>
<polygon fill="lightgreen" stroke="black" points="26537,-552 26372,-552 26372,-469 26537,-469 26537,-552"/>
<text text-anchor="middle" x="26454.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU9</text>
<text text-anchor="middle" x="26454.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="26454.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="26454.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="26454.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_8 -->
<g id="edge730" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26454.5,-587.91C26454.5,-579.65 26454.5,-570.86 26454.5,-562.3"/>
<polygon fill="black" stroke="black" points="26458,-562.02 26454.5,-552.02 26451,-562.02 26458,-562.02"/>
</g>
<!-- layer2_expert9_9 -->
<g id="node413" class="node">
<title>layer2_expert9_9</title>
<polygon fill="lightgreen" stroke="black" points="26720,-552 26555,-552 26555,-469 26720,-469 26720,-552"/>
<text text-anchor="middle" x="26637.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU9</text>
<text text-anchor="middle" x="26637.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="26637.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="26637.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="26637.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_9 -->
<g id="edge731" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26517.99,-587.91C26533.32,-578.11 26549.81,-567.56 26565.5,-557.53"/>
<polygon fill="black" stroke="black" points="26567.58,-560.36 26574.12,-552.02 26563.81,-554.46 26567.58,-560.36"/>
</g>
<!-- layer2_expert9_10 -->
<g id="node414" class="node">
<title>layer2_expert9_10</title>
<polygon fill="lightgreen" stroke="black" points="26903,-552 26738,-552 26738,-469 26903,-469 26903,-552"/>
<text text-anchor="middle" x="26820.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU9</text>
<text text-anchor="middle" x="26820.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="26820.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="26820.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="26820.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_10 -->
<g id="edge732" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26576.72,-598.37C26624.54,-585.55 26679.55,-569.51 26728.5,-552 26728.6,-551.97 26728.7,-551.93 26728.79,-551.9"/>
<polygon fill="black" stroke="black" points="26729.81,-555.25 26737.97,-548.49 26727.38,-548.69 26729.81,-555.25"/>
</g>
<!-- layer2_expert9_11 -->
<g id="node415" class="node">
<title>layer2_expert9_11</title>
<polygon fill="lightgreen" stroke="black" points="27086,-552 26921,-552 26921,-469 27086,-469 27086,-552"/>
<text text-anchor="middle" x="27003.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU9</text>
<text text-anchor="middle" x="27003.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="27003.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="27003.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="27003.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_11 -->
<g id="edge733" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26576.64,-616.42C26667.24,-605.52 26793.39,-586.25 26910.96,-551.94"/>
<polygon fill="black" stroke="black" points="26912.26,-555.2 26920.86,-549.01 26910.28,-548.49 26912.26,-555.2"/>
</g>
<!-- layer2_expert9_12 -->
<g id="node416" class="node">
<title>layer2_expert9_12</title>
<polygon fill="lightgreen" stroke="black" points="27269,-552 27104,-552 27104,-469 27269,-469 27269,-552"/>
<text text-anchor="middle" x="27186.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU9</text>
<text text-anchor="middle" x="27186.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="27186.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="27186.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="27186.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_12 -->
<g id="edge734" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26576.56,-624.6C26704.59,-618.1 26911.01,-600.76 27094.11,-551.85"/>
<polygon fill="black" stroke="black" points="27095.18,-555.19 27103.91,-549.2 27093.35,-548.43 27095.18,-555.19"/>
</g>
<!-- layer2_expert9_13 -->
<g id="node417" class="node">
<title>layer2_expert9_13</title>
<polygon fill="lightgreen" stroke="black" points="27452,-552 27287,-552 27287,-469 27452,-469 27452,-552"/>
<text text-anchor="middle" x="27369.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU9</text>
<text text-anchor="middle" x="27369.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="27369.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="27369.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="27369.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_13 -->
<g id="edge735" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26576.87,-621.96C26768.31,-610.93 27130.9,-586.64 27276.82,-551.83"/>
<polygon fill="black" stroke="black" points="27278.09,-555.12 27286.94,-549.3 27276.39,-548.33 27278.09,-555.12"/>
</g>
<!-- layer2_expert9_14 -->
<g id="node418" class="node">
<title>layer2_expert9_14</title>
<polygon fill="lightgreen" stroke="black" points="27635,-552 27470,-552 27470,-469 27635,-469 27635,-552"/>
<text text-anchor="middle" x="27552.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU9</text>
<text text-anchor="middle" x="27552.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="27552.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="27552.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="27552.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_14 -->
<g id="edge736" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26576.6,-624.37C26802.48,-615.9 27278.24,-593.94 27459.97,-551.78"/>
<polygon fill="black" stroke="black" points="27461.06,-555.12 27469.96,-549.37 27459.42,-548.32 27461.06,-555.12"/>
</g>
<!-- layer2_expert9_15 -->
<g id="node419" class="node">
<title>layer2_expert9_15</title>
<polygon fill="lightgreen" stroke="black" points="27818,-552 27653,-552 27653,-469 27818,-469 27818,-552"/>
<text text-anchor="middle" x="27735.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU9</text>
<text text-anchor="middle" x="27735.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="27735.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="27735.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="27735.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_gate_gpu9&#45;&gt;layer2_expert9_15 -->
<g id="edge737" class="edge">
<title>layer2_gate_gpu9&#45;&gt;layer2_expert9_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26576.83,-626.04C26834.32,-619.99 27425.68,-601.3 27643.21,-551.73"/>
<polygon fill="black" stroke="black" points="27644.04,-555.13 27652.97,-549.42 27642.43,-548.31 27644.04,-555.13"/>
</g>
<!-- layer2_moe_agg_gpu9 -->
<g id="node420" class="node">
<title>layer2_moe_agg_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="26647,-433 26444,-433 26444,-350 26647,-350 26647,-433"/>
<text text-anchor="middle" x="26545.5" y="-417.8" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU9</text>
<text text-anchor="middle" x="26545.5" y="-402.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="26545.5" y="-387.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="26545.5" y="-372.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="26545.5" y="-357.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_expert9_0&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge738" class="edge">
<title>layer2_expert9_0&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M25073.13,-471.23C25075.93,-470.41 25078.73,-469.67 25081.5,-469 25337.71,-407.53 26137.1,-395.45 26433.47,-393.08"/>
<polygon fill="black" stroke="black" points="26433.83,-396.58 26443.8,-393 26433.77,-389.58 26433.83,-396.58"/>
</g>
<!-- layer2_expert9_1&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge739" class="edge">
<title>layer2_expert9_1&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M25256.14,-471.26C25258.94,-470.43 25261.73,-469.68 25264.5,-469 25484.75,-415.29 26164.35,-398.63 26433.79,-394.06"/>
<polygon fill="black" stroke="black" points="26434.04,-397.55 26443.98,-393.89 26433.92,-390.55 26434.04,-397.55"/>
</g>
<!-- layer2_expert9_2&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge740" class="edge">
<title>layer2_expert9_2&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M25439.14,-471.29C25441.94,-470.46 25444.73,-469.69 25447.5,-469 25631.89,-423.06 26192.54,-402.33 26433.49,-395.36"/>
<polygon fill="black" stroke="black" points="26433.78,-398.86 26443.67,-395.07 26433.58,-391.86 26433.78,-398.86"/>
</g>
<!-- layer2_expert9_3&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge741" class="edge">
<title>layer2_expert9_3&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M25622.16,-471.34C25624.95,-470.49 25627.74,-469.71 25630.5,-469 25779.57,-430.76 26224.31,-406.69 26433.89,-397.16"/>
<polygon fill="black" stroke="black" points="26434.16,-400.65 26444,-396.71 26433.85,-393.66 26434.16,-400.65"/>
</g>
<!-- layer2_expert9_4&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge742" class="edge">
<title>layer2_expert9_4&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M25805.18,-471.42C25807.96,-470.55 25810.74,-469.74 25813.5,-469 26027.91,-411.63 26288.37,-396.9 26433.67,-393.35"/>
<polygon fill="black" stroke="black" points="26434.02,-396.84 26443.93,-393.11 26433.86,-389.84 26434.02,-396.84"/>
</g>
<!-- layer2_expert9_5&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge743" class="edge">
<title>layer2_expert9_5&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M25988.21,-471.54C25990.99,-470.64 25993.76,-469.78 25996.5,-469 26144.35,-426.71 26321.54,-407.41 26433.83,-398.87"/>
<polygon fill="black" stroke="black" points="26434.1,-402.36 26443.82,-398.13 26433.58,-395.38 26434.1,-402.36"/>
</g>
<!-- layer2_expert9_6&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge744" class="edge">
<title>layer2_expert9_6&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M26171.03,-471.87C26173.88,-470.87 26176.7,-469.9 26179.5,-469 26262.98,-442.04 26360.32,-422.22 26433.62,-409.52"/>
<polygon fill="black" stroke="black" points="26434.54,-412.92 26443.8,-407.78 26433.35,-406.02 26434.54,-412.92"/>
</g>
<!-- layer2_expert9_7&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge745" class="edge">
<title>layer2_expert9_7&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M26354.29,-472.56C26357.06,-471.35 26359.8,-470.16 26362.5,-469 26386.75,-458.54 26412.9,-447.48 26437.63,-437.11"/>
<polygon fill="black" stroke="black" points="26439.15,-440.27 26447.03,-433.18 26436.45,-433.81 26439.15,-440.27"/>
</g>
<!-- layer2_expert9_8&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge746" class="edge">
<title>layer2_expert9_8&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M26486.07,-468.91C26493.06,-459.92 26500.53,-450.32 26507.74,-441.05"/>
<polygon fill="black" stroke="black" points="26510.61,-443.06 26513.98,-433.02 26505.08,-438.77 26510.61,-443.06"/>
</g>
<!-- layer2_expert9_9&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge747" class="edge">
<title>layer2_expert9_9&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M26605.58,-468.91C26598.52,-459.92 26590.96,-450.32 26583.68,-441.05"/>
<polygon fill="black" stroke="black" points="26586.3,-438.72 26577.36,-433.02 26580.79,-443.05 26586.3,-438.72"/>
</g>
<!-- layer2_expert9_10&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge748" class="edge">
<title>layer2_expert9_10&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M26737.78,-473C26734.65,-471.64 26731.55,-470.31 26728.5,-469 26704.09,-458.53 26677.77,-447.42 26652.91,-437.01"/>
<polygon fill="black" stroke="black" points="26654.04,-433.69 26643.46,-433.05 26651.34,-440.14 26654.04,-433.69"/>
</g>
<!-- layer2_expert9_11&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge749" class="edge">
<title>layer2_expert9_11&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M26920.81,-472.15C26917.68,-471.04 26914.57,-469.99 26911.5,-469 26827.96,-442.21 26730.63,-422.38 26657.34,-409.64"/>
<polygon fill="black" stroke="black" points="26657.61,-406.13 26647.16,-407.89 26656.43,-413.03 26657.61,-406.13"/>
</g>
<!-- layer2_expert9_12&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge750" class="edge">
<title>layer2_expert9_12&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M27103.89,-471.88C27100.74,-470.85 27097.61,-469.88 27094.5,-469 26946.56,-427.01 26769.39,-407.63 26657.14,-399"/>
<polygon fill="black" stroke="black" points="26657.39,-395.51 26647.15,-398.25 26656.86,-402.49 26657.39,-395.51"/>
</g>
<!-- layer2_expert9_13&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge751" class="edge">
<title>layer2_expert9_13&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M27286.93,-471.74C27283.77,-470.75 27280.62,-469.83 27277.5,-469 27062.97,-412.07 26802.55,-397.17 26657.29,-393.48"/>
<polygon fill="black" stroke="black" points="26657.11,-389.98 26647.03,-393.24 26656.95,-396.98 26657.11,-389.98"/>
</g>
<!-- layer2_expert9_14&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge752" class="edge">
<title>layer2_expert9_14&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M27469.95,-471.66C27466.79,-470.69 27463.63,-469.8 27460.5,-469 27311.44,-431.09 26867.22,-406.87 26657.5,-397.24"/>
<polygon fill="black" stroke="black" points="26657.53,-393.73 26647.38,-396.77 26657.21,-400.73 26657.53,-393.73"/>
</g>
<!-- layer2_expert9_15&#45;&gt;layer2_moe_agg_gpu9 -->
<g id="edge753" class="edge">
<title>layer2_expert9_15&#45;&gt;layer2_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M27652.96,-471.6C27649.8,-470.65 27646.63,-469.77 27643.5,-469 27459.01,-423.44 26898.42,-402.5 26657.5,-395.42"/>
<polygon fill="black" stroke="black" points="26657.41,-391.92 26647.32,-395.12 26657.21,-398.91 26657.41,-391.92"/>
</g>
<!-- layer2_output_gpu9 -->
<g id="node421" class="node">
<title>layer2_output_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="30297.5,-142 30053.5,-142 30053.5,-74 30297.5,-74 30297.5,-142"/>
<text text-anchor="middle" x="30175.5" y="-126.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU9</text>
<text text-anchor="middle" x="30175.5" y="-111.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="30175.5" y="-96.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="30175.5" y="-81.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_moe_agg_gpu9&#45;&gt;layer2_output_gpu9 -->
<g id="edge754" class="edge">
<title>layer2_moe_agg_gpu9&#45;&gt;layer2_output_gpu9</title>
<path fill="none" stroke="black" d="M26647.33,-382.6C27160.83,-342.78 29464.33,-164.15 30043.19,-119.26"/>
<polygon fill="black" stroke="black" points="30043.54,-122.74 30053.24,-118.48 30043,-115.76 30043.54,-122.74"/>
</g>
<!-- layer2_moe_agg_gpu9&#45;&gt;layer2_allreduce_moe -->
<g id="edge983" class="edge">
<title>layer2_moe_agg_gpu9&#45;&gt;layer2_allreduce_moe</title>
<path fill="none" stroke="black" d="M26647.14,-388.43C27417.64,-372.74 32337.06,-272.55 33392.35,-251.06"/>
<polygon fill="black" stroke="black" points="33392.76,-254.55 33402.69,-250.85 33392.62,-247.55 33392.76,-254.55"/>
</g>
<!-- layer2_qkv_gpu10 -->
<g id="node422" class="node">
<title>layer2_qkv_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="33403.5,-1304 33193.5,-1304 33193.5,-1206 33403.5,-1206 33403.5,-1304"/>
<text text-anchor="middle" x="33298.5" y="-1288.8" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU10</text>
<text text-anchor="middle" x="33298.5" y="-1273.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="33298.5" y="-1258.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="33298.5" y="-1243.8" font-family="Times,serif" font-size="14.00">Heads: 8&#45;11</text>
<text text-anchor="middle" x="33298.5" y="-1228.8" font-family="Times,serif" font-size="14.00">TP Slice: 2</text>
<text text-anchor="middle" x="33298.5" y="-1213.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_attn_gpu10 -->
<g id="node423" class="node">
<title>layer2_attn_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="33403.5,-1170 33151.5,-1170 33151.5,-1087 33403.5,-1087 33403.5,-1170"/>
<text text-anchor="middle" x="33277.5" y="-1154.8" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU10</text>
<text text-anchor="middle" x="33277.5" y="-1139.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="33277.5" y="-1124.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33277.5" y="-1109.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="33277.5" y="-1094.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_qkv_gpu10&#45;&gt;layer2_attn_gpu10 -->
<g id="edge755" class="edge">
<title>layer2_qkv_gpu10&#45;&gt;layer2_attn_gpu10</title>
<path fill="none" stroke="black" d="M33290.38,-1205.87C33288.97,-1197.5 33287.5,-1188.77 33286.07,-1180.33"/>
<polygon fill="black" stroke="black" points="33289.48,-1179.51 33284.37,-1170.23 33282.58,-1180.67 33289.48,-1179.51"/>
</g>
<!-- layer2_attn_proj_gpu10 -->
<g id="node424" class="node">
<title>layer2_attn_proj_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="33382,-1051 33173,-1051 33173,-983 33382,-983 33382,-1051"/>
<text text-anchor="middle" x="33277.5" y="-1035.8" font-family="Times,serif" font-size="14.00">L2_Attn_Projection_GPU10</text>
<text text-anchor="middle" x="33277.5" y="-1020.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="33277.5" y="-1005.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33277.5" y="-990.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_attn_gpu10&#45;&gt;layer2_attn_proj_gpu10 -->
<g id="edge756" class="edge">
<title>layer2_attn_gpu10&#45;&gt;layer2_attn_proj_gpu10</title>
<path fill="none" stroke="black" d="M33277.5,-1086.73C33277.5,-1078.52 33277.5,-1069.86 33277.5,-1061.56"/>
<polygon fill="black" stroke="black" points="33281,-1061.3 33277.5,-1051.3 33274,-1061.3 33281,-1061.3"/>
</g>
<!-- layer2_attn_norm_gpu10 -->
<g id="node425" class="node">
<title>layer2_attn_norm_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="33403,-775 33150,-775 33150,-707 33403,-707 33403,-775"/>
<text text-anchor="middle" x="33276.5" y="-759.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU10</text>
<text text-anchor="middle" x="33276.5" y="-744.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="33276.5" y="-729.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33276.5" y="-714.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_attn_proj_gpu10&#45;&gt;layer2_attn_norm_gpu10 -->
<g id="edge757" class="edge">
<title>layer2_attn_proj_gpu10&#45;&gt;layer2_attn_norm_gpu10</title>
<path fill="none" stroke="black" d="M33277.38,-982.95C33277.2,-933.47 33276.86,-840.12 33276.66,-785.27"/>
<polygon fill="black" stroke="black" points="33280.16,-785.16 33276.62,-775.17 33273.16,-785.18 33280.16,-785.16"/>
</g>
<!-- layer2_attn_proj_gpu10&#45;&gt;layer2_allreduce_attn -->
<g id="edge985" class="edge">
<title>layer2_attn_proj_gpu10&#45;&gt;layer2_allreduce_attn</title>
<path fill="none" stroke="black" d="M33375.8,-982.99C33435.25,-963.03 33511.16,-937.54 33572.59,-916.91"/>
<polygon fill="black" stroke="black" points="33573.96,-920.14 33582.32,-913.64 33571.73,-913.51 33573.96,-920.14"/>
</g>
<!-- layer2_gate_gpu10 -->
<g id="node426" class="node">
<title>layer2_gate_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="29504.5,-671 29260.5,-671 29260.5,-588 29504.5,-588 29504.5,-671"/>
<text text-anchor="middle" x="29382.5" y="-655.8" font-family="Times,serif" font-size="14.00">L2_Gate_GPU10</text>
<text text-anchor="middle" x="29382.5" y="-640.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="29382.5" y="-625.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="29382.5" y="-610.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="29382.5" y="-595.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_attn_norm_gpu10&#45;&gt;layer2_gate_gpu10 -->
<g id="edge758" class="edge">
<title>layer2_attn_norm_gpu10&#45;&gt;layer2_gate_gpu10</title>
<path fill="none" stroke="black" d="M33149.98,-708.35C33146.8,-707.86 33143.63,-707.41 33140.5,-707 32957.41,-683.21 30160.42,-641.69 29514.77,-632.38"/>
<polygon fill="black" stroke="black" points="29514.55,-628.88 29504.5,-632.24 29514.45,-635.88 29514.55,-628.88"/>
</g>
<!-- layer2_expert10_0 -->
<g id="node427" class="node">
<title>layer2_expert10_0</title>
<polygon fill="lightgreen" stroke="black" points="28001,-552 27836,-552 27836,-469 28001,-469 28001,-552"/>
<text text-anchor="middle" x="27918.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU10</text>
<text text-anchor="middle" x="27918.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="27918.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="27918.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="27918.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_0 -->
<g id="edge759" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29260.34,-627.34C28973.75,-623.72 28264,-609.31 28011.02,-552.07"/>
<polygon fill="black" stroke="black" points="28011.67,-548.63 28001.13,-549.76 28010.07,-555.44 28011.67,-548.63"/>
</g>
<!-- layer2_expert10_1 -->
<g id="node428" class="node">
<title>layer2_expert10_1</title>
<polygon fill="lightgreen" stroke="black" points="28184,-552 28019,-552 28019,-469 28184,-469 28184,-552"/>
<text text-anchor="middle" x="28101.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU10</text>
<text text-anchor="middle" x="28101.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="28101.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="28101.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="28101.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_1 -->
<g id="edge760" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29260.05,-626.1C29002.44,-620.18 28411,-601.75 28194.18,-552.11"/>
<polygon fill="black" stroke="black" points="28194.68,-548.63 28184.14,-549.73 28193.06,-555.44 28194.68,-548.63"/>
</g>
<!-- layer2_expert10_2 -->
<g id="node429" class="node">
<title>layer2_expert10_2</title>
<polygon fill="lightgreen" stroke="black" points="28367,-552 28202,-552 28202,-469 28367,-469 28367,-552"/>
<text text-anchor="middle" x="28284.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU10</text>
<text text-anchor="middle" x="28284.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="28284.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="28284.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="28284.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_2 -->
<g id="edge761" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29260.26,-624.44C29034.14,-616.08 28557.86,-594.29 28377.08,-552.1"/>
<polygon fill="black" stroke="black" points="28377.69,-548.65 28367.15,-549.68 28376.04,-555.45 28377.69,-548.65"/>
</g>
<!-- layer2_expert10_3 -->
<g id="node430" class="node">
<title>layer2_expert10_3</title>
<polygon fill="lightgreen" stroke="black" points="28550,-552 28385,-552 28385,-469 28550,-469 28550,-552"/>
<text text-anchor="middle" x="28467.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU10</text>
<text text-anchor="middle" x="28467.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="28467.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="28467.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="28467.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_3 -->
<g id="edge762" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29260.36,-622.05C29068.78,-611.12 28705.32,-586.96 28560.23,-552.15"/>
<polygon fill="black" stroke="black" points="28560.72,-548.66 28550.17,-549.62 28559.01,-555.45 28560.72,-548.66"/>
</g>
<!-- layer2_expert10_4 -->
<g id="node431" class="node">
<title>layer2_expert10_4</title>
<polygon fill="lightgreen" stroke="black" points="28733,-552 28568,-552 28568,-469 28733,-469 28733,-552"/>
<text text-anchor="middle" x="28650.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU10</text>
<text text-anchor="middle" x="28650.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="28650.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="28650.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="28650.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_4 -->
<g id="edge763" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29260.21,-624.77C29131.95,-618.4 28925.18,-601.17 28742.95,-552.19"/>
<polygon fill="black" stroke="black" points="28743.76,-548.78 28733.19,-549.53 28741.92,-555.53 28743.76,-548.78"/>
</g>
<!-- layer2_expert10_5 -->
<g id="node432" class="node">
<title>layer2_expert10_5</title>
<polygon fill="lightgreen" stroke="black" points="28916,-552 28751,-552 28751,-469 28916,-469 28916,-552"/>
<text text-anchor="middle" x="28833.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU10</text>
<text text-anchor="middle" x="28833.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="28833.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="28833.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="28833.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_5 -->
<g id="edge764" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29260.05,-616.58C29169.24,-605.76 29042.81,-586.52 28926.06,-552.28"/>
<polygon fill="black" stroke="black" points="28926.82,-548.86 28916.24,-549.36 28924.83,-555.57 28926.82,-548.86"/>
</g>
<!-- layer2_expert10_6 -->
<g id="node433" class="node">
<title>layer2_expert10_6</title>
<polygon fill="lightgreen" stroke="black" points="29099,-552 28934,-552 28934,-469 29099,-469 29099,-552"/>
<text text-anchor="middle" x="29016.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU10</text>
<text text-anchor="middle" x="29016.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="29016.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="29016.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="29016.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_6 -->
<g id="edge765" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29260.47,-598.69C29214.95,-586.56 29162.87,-571.48 29108.56,-552.26"/>
<polygon fill="black" stroke="black" points="29109.71,-548.96 29099.12,-548.89 29107.35,-555.55 29109.71,-548.96"/>
</g>
<!-- layer2_expert10_7 -->
<g id="node434" class="node">
<title>layer2_expert10_7</title>
<polygon fill="lightgreen" stroke="black" points="29282,-552 29117,-552 29117,-469 29282,-469 29282,-552"/>
<text text-anchor="middle" x="29199.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU10</text>
<text text-anchor="middle" x="29199.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="29199.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="29199.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="29199.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_7 -->
<g id="edge766" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29319.01,-587.91C29303.68,-578.11 29287.19,-567.56 29271.5,-557.53"/>
<polygon fill="black" stroke="black" points="29273.19,-554.46 29262.88,-552.02 29269.42,-560.36 29273.19,-554.46"/>
</g>
<!-- layer2_expert10_8 -->
<g id="node435" class="node">
<title>layer2_expert10_8</title>
<polygon fill="lightgreen" stroke="black" points="29465,-552 29300,-552 29300,-469 29465,-469 29465,-552"/>
<text text-anchor="middle" x="29382.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU10</text>
<text text-anchor="middle" x="29382.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="29382.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="29382.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="29382.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_8 -->
<g id="edge767" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29382.5,-587.91C29382.5,-579.65 29382.5,-570.86 29382.5,-562.3"/>
<polygon fill="black" stroke="black" points="29386,-562.02 29382.5,-552.02 29379,-562.02 29386,-562.02"/>
</g>
<!-- layer2_expert10_9 -->
<g id="node436" class="node">
<title>layer2_expert10_9</title>
<polygon fill="lightgreen" stroke="black" points="29648,-552 29483,-552 29483,-469 29648,-469 29648,-552"/>
<text text-anchor="middle" x="29565.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU10</text>
<text text-anchor="middle" x="29565.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="29565.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="29565.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="29565.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_9 -->
<g id="edge768" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29445.99,-587.91C29461.32,-578.11 29477.81,-567.56 29493.5,-557.53"/>
<polygon fill="black" stroke="black" points="29495.58,-560.36 29502.12,-552.02 29491.81,-554.46 29495.58,-560.36"/>
</g>
<!-- layer2_expert10_10 -->
<g id="node437" class="node">
<title>layer2_expert10_10</title>
<polygon fill="lightgreen" stroke="black" points="29831,-552 29666,-552 29666,-469 29831,-469 29831,-552"/>
<text text-anchor="middle" x="29748.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU10</text>
<text text-anchor="middle" x="29748.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="29748.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="29748.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="29748.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_10 -->
<g id="edge769" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29504.72,-598.37C29552.54,-585.55 29607.55,-569.51 29656.5,-552 29656.6,-551.97 29656.7,-551.93 29656.79,-551.9"/>
<polygon fill="black" stroke="black" points="29657.81,-555.25 29665.97,-548.49 29655.38,-548.69 29657.81,-555.25"/>
</g>
<!-- layer2_expert10_11 -->
<g id="node438" class="node">
<title>layer2_expert10_11</title>
<polygon fill="lightgreen" stroke="black" points="30014,-552 29849,-552 29849,-469 30014,-469 30014,-552"/>
<text text-anchor="middle" x="29931.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU10</text>
<text text-anchor="middle" x="29931.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="29931.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="29931.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="29931.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_11 -->
<g id="edge770" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29504.64,-616.42C29595.24,-605.52 29721.39,-586.25 29838.96,-551.94"/>
<polygon fill="black" stroke="black" points="29840.26,-555.2 29848.86,-549.01 29838.28,-548.49 29840.26,-555.2"/>
</g>
<!-- layer2_expert10_12 -->
<g id="node439" class="node">
<title>layer2_expert10_12</title>
<polygon fill="lightgreen" stroke="black" points="30197,-552 30032,-552 30032,-469 30197,-469 30197,-552"/>
<text text-anchor="middle" x="30114.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU10</text>
<text text-anchor="middle" x="30114.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="30114.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="30114.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="30114.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_12 -->
<g id="edge771" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29504.56,-624.6C29632.59,-618.1 29839.01,-600.76 30022.11,-551.85"/>
<polygon fill="black" stroke="black" points="30023.18,-555.19 30031.91,-549.2 30021.35,-548.43 30023.18,-555.19"/>
</g>
<!-- layer2_expert10_13 -->
<g id="node440" class="node">
<title>layer2_expert10_13</title>
<polygon fill="lightgreen" stroke="black" points="30380,-552 30215,-552 30215,-469 30380,-469 30380,-552"/>
<text text-anchor="middle" x="30297.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU10</text>
<text text-anchor="middle" x="30297.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="30297.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="30297.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="30297.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_13 -->
<g id="edge772" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29504.87,-621.96C29696.31,-610.93 30058.9,-586.64 30204.82,-551.83"/>
<polygon fill="black" stroke="black" points="30206.09,-555.12 30214.94,-549.3 30204.39,-548.33 30206.09,-555.12"/>
</g>
<!-- layer2_expert10_14 -->
<g id="node441" class="node">
<title>layer2_expert10_14</title>
<polygon fill="lightgreen" stroke="black" points="30563,-552 30398,-552 30398,-469 30563,-469 30563,-552"/>
<text text-anchor="middle" x="30480.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU10</text>
<text text-anchor="middle" x="30480.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="30480.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="30480.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="30480.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_14 -->
<g id="edge773" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29504.6,-624.37C29730.48,-615.9 30206.24,-593.94 30387.97,-551.78"/>
<polygon fill="black" stroke="black" points="30389.06,-555.12 30397.96,-549.37 30387.42,-548.32 30389.06,-555.12"/>
</g>
<!-- layer2_expert10_15 -->
<g id="node442" class="node">
<title>layer2_expert10_15</title>
<polygon fill="lightgreen" stroke="black" points="30746,-552 30581,-552 30581,-469 30746,-469 30746,-552"/>
<text text-anchor="middle" x="30663.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU10</text>
<text text-anchor="middle" x="30663.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="30663.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="30663.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="30663.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_gate_gpu10&#45;&gt;layer2_expert10_15 -->
<g id="edge774" class="edge">
<title>layer2_gate_gpu10&#45;&gt;layer2_expert10_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29504.83,-626.04C29762.32,-619.99 30353.68,-601.3 30571.21,-551.73"/>
<polygon fill="black" stroke="black" points="30572.04,-555.13 30580.97,-549.42 30570.43,-548.31 30572.04,-555.13"/>
</g>
<!-- layer2_moe_agg_gpu10 -->
<g id="node443" class="node">
<title>layer2_moe_agg_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="29579.5,-433 29367.5,-433 29367.5,-350 29579.5,-350 29579.5,-433"/>
<text text-anchor="middle" x="29473.5" y="-417.8" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU10</text>
<text text-anchor="middle" x="29473.5" y="-402.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="29473.5" y="-387.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="29473.5" y="-372.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="29473.5" y="-357.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_expert10_0&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge775" class="edge">
<title>layer2_expert10_0&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M28001.13,-471.23C28003.93,-470.41 28006.73,-469.67 28009.5,-469 28264.53,-407.81 29057.79,-395.56 29357.37,-393.11"/>
<polygon fill="black" stroke="black" points="29357.41,-396.61 29367.38,-393.03 29357.36,-389.61 29357.41,-396.61"/>
</g>
<!-- layer2_expert10_1&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge776" class="edge">
<title>layer2_expert10_1&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M28184.14,-471.26C28186.94,-470.43 28189.73,-469.68 28192.5,-469 28411.41,-415.62 29084.13,-398.83 29356.85,-394.14"/>
<polygon fill="black" stroke="black" points="29357.23,-397.63 29367.17,-393.97 29357.11,-390.64 29357.23,-397.63"/>
</g>
<!-- layer2_expert10_2&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge777" class="edge">
<title>layer2_expert10_2&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M28367.14,-471.29C28369.94,-470.46 28372.73,-469.69 28375.5,-469 28558.75,-423.35 29113.6,-402.59 29356.97,-395.5"/>
<polygon fill="black" stroke="black" points="29357.37,-398.99 29367.27,-395.2 29357.17,-391.99 29357.37,-398.99"/>
</g>
<!-- layer2_expert10_3&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge778" class="edge">
<title>layer2_expert10_3&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M28550.16,-471.34C28552.95,-470.49 28555.74,-469.71 28558.5,-469 28706.43,-431.06 29145.52,-407.06 29357.04,-397.38"/>
<polygon fill="black" stroke="black" points="29357.42,-400.87 29367.25,-396.92 29357.1,-393.88 29357.42,-400.87"/>
</g>
<!-- layer2_expert10_4&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge779" class="edge">
<title>layer2_expert10_4&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M28733.18,-471.42C28735.96,-470.55 28738.74,-469.74 28741.5,-469 28953.65,-412.24 29210.89,-397.21 29357.04,-393.46"/>
<polygon fill="black" stroke="black" points="29357.46,-396.96 29367.37,-393.21 29357.29,-389.96 29357.46,-396.96"/>
</g>
<!-- layer2_expert10_5&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge780" class="edge">
<title>layer2_expert10_5&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M28916.21,-471.54C28918.99,-470.64 28921.76,-469.78 28924.5,-469 29070.44,-427.26 29244.97,-407.91 29357.45,-399.21"/>
<polygon fill="black" stroke="black" points="29357.75,-402.7 29367.46,-398.45 29357.22,-395.72 29357.75,-402.7"/>
</g>
<!-- layer2_expert10_6&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge781" class="edge">
<title>layer2_expert10_6&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M29099.03,-471.87C29101.88,-470.87 29104.7,-469.9 29107.5,-469 29189.36,-442.56 29284.54,-423 29357.32,-410.27"/>
<polygon fill="black" stroke="black" points="29358.18,-413.68 29367.44,-408.52 29356.99,-406.78 29358.18,-413.68"/>
</g>
<!-- layer2_expert10_7&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge782" class="edge">
<title>layer2_expert10_7&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M29282.29,-472.56C29285.06,-471.35 29287.8,-470.16 29290.5,-469 29314.75,-458.54 29340.9,-447.48 29365.63,-437.11"/>
<polygon fill="black" stroke="black" points="29367.15,-440.27 29375.03,-433.18 29364.45,-433.81 29367.15,-440.27"/>
</g>
<!-- layer2_expert10_8&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge783" class="edge">
<title>layer2_expert10_8&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M29414.07,-468.91C29421.06,-459.92 29428.53,-450.32 29435.74,-441.05"/>
<polygon fill="black" stroke="black" points="29438.61,-443.06 29441.98,-433.02 29433.08,-438.77 29438.61,-443.06"/>
</g>
<!-- layer2_expert10_9&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge784" class="edge">
<title>layer2_expert10_9&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M29533.58,-468.91C29526.52,-459.92 29518.96,-450.32 29511.68,-441.05"/>
<polygon fill="black" stroke="black" points="29514.3,-438.72 29505.36,-433.02 29508.79,-443.05 29514.3,-438.72"/>
</g>
<!-- layer2_expert10_10&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge785" class="edge">
<title>layer2_expert10_10&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M29665.78,-473C29662.65,-471.64 29659.55,-470.31 29656.5,-469 29632.09,-458.53 29605.77,-447.42 29580.91,-437.01"/>
<polygon fill="black" stroke="black" points="29582.04,-433.69 29571.46,-433.05 29579.34,-440.14 29582.04,-433.69"/>
</g>
<!-- layer2_expert10_11&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge786" class="edge">
<title>layer2_expert10_11&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M29848.81,-472.15C29845.68,-471.04 29842.57,-469.99 29839.5,-469 29757.59,-442.73 29662.41,-423.16 29589.64,-410.39"/>
<polygon fill="black" stroke="black" points="29589.98,-406.89 29579.53,-408.63 29588.78,-413.79 29589.98,-406.89"/>
</g>
<!-- layer2_expert10_12&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge787" class="edge">
<title>layer2_expert10_12&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M30031.89,-471.88C30028.74,-470.85 30025.61,-469.88 30022.5,-469 29876.47,-427.55 29701.96,-408.14 29589.51,-399.34"/>
<polygon fill="black" stroke="black" points="29589.74,-395.85 29579.51,-398.57 29589.21,-402.83 29589.74,-395.85"/>
</g>
<!-- layer2_expert10_13&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge788" class="edge">
<title>layer2_expert10_13&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M30214.93,-471.74C30211.77,-470.75 30208.62,-469.83 30205.5,-469 29993.23,-412.67 29736.04,-397.49 29589.92,-393.6"/>
<polygon fill="black" stroke="black" points="29589.68,-390.1 29579.6,-393.34 29589.5,-397.09 29589.68,-390.1"/>
</g>
<!-- layer2_expert10_14&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge789" class="edge">
<title>layer2_expert10_14&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M30397.95,-471.66C30394.79,-470.69 30391.63,-469.8 30388.5,-469 30240.49,-431.36 29801.44,-407.21 29589.94,-397.44"/>
<polygon fill="black" stroke="black" points="29589.89,-393.93 29579.74,-396.97 29589.57,-400.93 29589.89,-393.93"/>
</g>
<!-- layer2_expert10_15&#45;&gt;layer2_moe_agg_gpu10 -->
<g id="edge790" class="edge">
<title>layer2_expert10_15&#45;&gt;layer2_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M30580.96,-471.6C30577.8,-470.65 30574.63,-469.77 30571.5,-469 30388.16,-423.72 29833.35,-402.76 29590.01,-395.55"/>
<polygon fill="black" stroke="black" points="29589.82,-392.05 29579.72,-395.25 29589.61,-399.04 29589.82,-392.05"/>
</g>
<!-- layer2_output_gpu10 -->
<g id="node444" class="node">
<title>layer2_output_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="32239,-142 31986,-142 31986,-74 32239,-74 32239,-142"/>
<text text-anchor="middle" x="32112.5" y="-126.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU10</text>
<text text-anchor="middle" x="32112.5" y="-111.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="32112.5" y="-96.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="32112.5" y="-81.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_moe_agg_gpu10&#45;&gt;layer2_output_gpu10 -->
<g id="edge791" class="edge">
<title>layer2_moe_agg_gpu10&#45;&gt;layer2_output_gpu10</title>
<path fill="none" stroke="black" d="M29579.81,-379.16C29995.47,-334.82 31510.68,-173.2 31975.79,-123.58"/>
<polygon fill="black" stroke="black" points="31976.34,-127.04 31985.91,-122.5 31975.6,-120.08 31976.34,-127.04"/>
</g>
<!-- layer2_moe_agg_gpu10&#45;&gt;layer2_allreduce_moe -->
<g id="edge987" class="edge">
<title>layer2_moe_agg_gpu10&#45;&gt;layer2_allreduce_moe</title>
<path fill="none" stroke="black" d="M29579.69,-386.8C30131.92,-367.56 32677.7,-278.84 33399.97,-253.67"/>
<polygon fill="black" stroke="black" points="33400.34,-257.16 33410.21,-253.32 33400.1,-250.17 33400.34,-257.16"/>
</g>
<!-- layer2_qkv_gpu11 -->
<g id="node445" class="node">
<title>layer2_qkv_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="33662.5,-1304 33452.5,-1304 33452.5,-1206 33662.5,-1206 33662.5,-1304"/>
<text text-anchor="middle" x="33557.5" y="-1288.8" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU11</text>
<text text-anchor="middle" x="33557.5" y="-1273.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="33557.5" y="-1258.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="33557.5" y="-1243.8" font-family="Times,serif" font-size="14.00">Heads: 12&#45;15</text>
<text text-anchor="middle" x="33557.5" y="-1228.8" font-family="Times,serif" font-size="14.00">TP Slice: 3</text>
<text text-anchor="middle" x="33557.5" y="-1213.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_attn_gpu11 -->
<g id="node446" class="node">
<title>layer2_attn_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="33673.5,-1170 33421.5,-1170 33421.5,-1087 33673.5,-1087 33673.5,-1170"/>
<text text-anchor="middle" x="33547.5" y="-1154.8" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU11</text>
<text text-anchor="middle" x="33547.5" y="-1139.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="33547.5" y="-1124.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33547.5" y="-1109.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="33547.5" y="-1094.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_qkv_gpu11&#45;&gt;layer2_attn_gpu11 -->
<g id="edge792" class="edge">
<title>layer2_qkv_gpu11&#45;&gt;layer2_attn_gpu11</title>
<path fill="none" stroke="black" d="M33553.63,-1205.87C33552.96,-1197.5 33552.26,-1188.77 33551.58,-1180.33"/>
<polygon fill="black" stroke="black" points="33555.06,-1179.92 33550.77,-1170.23 33548.08,-1180.48 33555.06,-1179.92"/>
</g>
<!-- layer2_attn_proj_gpu11 -->
<g id="node447" class="node">
<title>layer2_attn_proj_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="33652,-1051 33443,-1051 33443,-983 33652,-983 33652,-1051"/>
<text text-anchor="middle" x="33547.5" y="-1035.8" font-family="Times,serif" font-size="14.00">L2_Attn_Projection_GPU11</text>
<text text-anchor="middle" x="33547.5" y="-1020.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="33547.5" y="-1005.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33547.5" y="-990.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_attn_gpu11&#45;&gt;layer2_attn_proj_gpu11 -->
<g id="edge793" class="edge">
<title>layer2_attn_gpu11&#45;&gt;layer2_attn_proj_gpu11</title>
<path fill="none" stroke="black" d="M33547.5,-1086.73C33547.5,-1078.52 33547.5,-1069.86 33547.5,-1061.56"/>
<polygon fill="black" stroke="black" points="33551,-1061.3 33547.5,-1051.3 33544,-1061.3 33551,-1061.3"/>
</g>
<!-- layer2_attn_norm_gpu11 -->
<g id="node448" class="node">
<title>layer2_attn_norm_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="33674,-775 33421,-775 33421,-707 33674,-707 33674,-775"/>
<text text-anchor="middle" x="33547.5" y="-759.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU11</text>
<text text-anchor="middle" x="33547.5" y="-744.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="33547.5" y="-729.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33547.5" y="-714.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_attn_proj_gpu11&#45;&gt;layer2_attn_norm_gpu11 -->
<g id="edge794" class="edge">
<title>layer2_attn_proj_gpu11&#45;&gt;layer2_attn_norm_gpu11</title>
<path fill="none" stroke="black" d="M33497.86,-982.69C33486.81,-972.64 33476.58,-960.6 33470.5,-947 33445.85,-891.81 33445.85,-866.19 33470.5,-811 33475.2,-800.48 33482.38,-790.9 33490.51,-782.44"/>
<polygon fill="black" stroke="black" points="33493.12,-784.78 33497.86,-775.31 33488.25,-779.76 33493.12,-784.78"/>
</g>
<!-- layer2_attn_proj_gpu11&#45;&gt;layer2_allreduce_attn -->
<g id="edge989" class="edge">
<title>layer2_attn_proj_gpu11&#45;&gt;layer2_allreduce_attn</title>
<path fill="none" stroke="black" d="M33580.52,-982.73C33593.94,-969.21 33609.84,-953.2 33625.05,-937.88"/>
<polygon fill="black" stroke="black" points="33627.88,-939.99 33632.44,-930.43 33622.91,-935.06 33627.88,-939.99"/>
</g>
<!-- layer2_gate_gpu11 -->
<g id="node449" class="node">
<title>layer2_gate_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="32432.5,-671 32188.5,-671 32188.5,-588 32432.5,-588 32432.5,-671"/>
<text text-anchor="middle" x="32310.5" y="-655.8" font-family="Times,serif" font-size="14.00">L2_Gate_GPU11</text>
<text text-anchor="middle" x="32310.5" y="-640.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="32310.5" y="-625.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="32310.5" y="-610.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="32310.5" y="-595.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_attn_norm_gpu11&#45;&gt;layer2_gate_gpu11 -->
<g id="edge795" class="edge">
<title>layer2_attn_norm_gpu11&#45;&gt;layer2_gate_gpu11</title>
<path fill="none" stroke="black" d="M33420.95,-708.55C33417.78,-708 33414.62,-707.48 33411.5,-707 33064.52,-653.24 32650.14,-637.25 32442.65,-632.5"/>
<polygon fill="black" stroke="black" points="32442.7,-629 32432.62,-632.27 32442.54,-636 32442.7,-629"/>
</g>
<!-- layer2_expert11_0 -->
<g id="node450" class="node">
<title>layer2_expert11_0</title>
<polygon fill="lightgreen" stroke="black" points="30929,-552 30764,-552 30764,-469 30929,-469 30929,-552"/>
<text text-anchor="middle" x="30846.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU11</text>
<text text-anchor="middle" x="30846.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="30846.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="30846.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="30846.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_0 -->
<g id="edge796" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32188.34,-627.34C31901.75,-623.72 31192,-609.31 30939.02,-552.07"/>
<polygon fill="black" stroke="black" points="30939.67,-548.63 30929.13,-549.76 30938.07,-555.44 30939.67,-548.63"/>
</g>
<!-- layer2_expert11_1 -->
<g id="node451" class="node">
<title>layer2_expert11_1</title>
<polygon fill="lightgreen" stroke="black" points="31112,-552 30947,-552 30947,-469 31112,-469 31112,-552"/>
<text text-anchor="middle" x="31029.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU11</text>
<text text-anchor="middle" x="31029.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="31029.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="31029.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="31029.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_1 -->
<g id="edge797" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32188.05,-626.1C31930.44,-620.18 31339,-601.75 31122.18,-552.11"/>
<polygon fill="black" stroke="black" points="31122.68,-548.63 31112.14,-549.73 31121.06,-555.44 31122.68,-548.63"/>
</g>
<!-- layer2_expert11_2 -->
<g id="node452" class="node">
<title>layer2_expert11_2</title>
<polygon fill="lightgreen" stroke="black" points="31295,-552 31130,-552 31130,-469 31295,-469 31295,-552"/>
<text text-anchor="middle" x="31212.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU11</text>
<text text-anchor="middle" x="31212.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="31212.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="31212.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="31212.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_2 -->
<g id="edge798" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32188.26,-624.44C31962.14,-616.08 31485.86,-594.29 31305.08,-552.1"/>
<polygon fill="black" stroke="black" points="31305.69,-548.65 31295.15,-549.68 31304.04,-555.45 31305.69,-548.65"/>
</g>
<!-- layer2_expert11_3 -->
<g id="node453" class="node">
<title>layer2_expert11_3</title>
<polygon fill="lightgreen" stroke="black" points="31478,-552 31313,-552 31313,-469 31478,-469 31478,-552"/>
<text text-anchor="middle" x="31395.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU11</text>
<text text-anchor="middle" x="31395.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="31395.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="31395.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="31395.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_3 -->
<g id="edge799" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32188.36,-622.05C31996.78,-611.12 31633.32,-586.96 31488.23,-552.15"/>
<polygon fill="black" stroke="black" points="31488.72,-548.66 31478.17,-549.62 31487.01,-555.45 31488.72,-548.66"/>
</g>
<!-- layer2_expert11_4 -->
<g id="node454" class="node">
<title>layer2_expert11_4</title>
<polygon fill="lightgreen" stroke="black" points="31661,-552 31496,-552 31496,-469 31661,-469 31661,-552"/>
<text text-anchor="middle" x="31578.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU11</text>
<text text-anchor="middle" x="31578.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="31578.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="31578.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="31578.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_4 -->
<g id="edge800" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32188.21,-624.77C32059.95,-618.4 31853.18,-601.17 31670.95,-552.19"/>
<polygon fill="black" stroke="black" points="31671.76,-548.78 31661.19,-549.53 31669.92,-555.53 31671.76,-548.78"/>
</g>
<!-- layer2_expert11_5 -->
<g id="node455" class="node">
<title>layer2_expert11_5</title>
<polygon fill="lightgreen" stroke="black" points="31844,-552 31679,-552 31679,-469 31844,-469 31844,-552"/>
<text text-anchor="middle" x="31761.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU11</text>
<text text-anchor="middle" x="31761.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="31761.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="31761.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="31761.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_5 -->
<g id="edge801" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32188.05,-616.58C32097.24,-605.76 31970.81,-586.52 31854.06,-552.28"/>
<polygon fill="black" stroke="black" points="31854.82,-548.86 31844.24,-549.36 31852.83,-555.57 31854.82,-548.86"/>
</g>
<!-- layer2_expert11_6 -->
<g id="node456" class="node">
<title>layer2_expert11_6</title>
<polygon fill="lightgreen" stroke="black" points="32027,-552 31862,-552 31862,-469 32027,-469 32027,-552"/>
<text text-anchor="middle" x="31944.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU11</text>
<text text-anchor="middle" x="31944.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="31944.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="31944.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="31944.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_6 -->
<g id="edge802" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32188.47,-598.69C32142.95,-586.56 32090.87,-571.48 32036.56,-552.26"/>
<polygon fill="black" stroke="black" points="32037.71,-548.96 32027.12,-548.89 32035.35,-555.55 32037.71,-548.96"/>
</g>
<!-- layer2_expert11_7 -->
<g id="node457" class="node">
<title>layer2_expert11_7</title>
<polygon fill="lightgreen" stroke="black" points="32210,-552 32045,-552 32045,-469 32210,-469 32210,-552"/>
<text text-anchor="middle" x="32127.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU11</text>
<text text-anchor="middle" x="32127.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="32127.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="32127.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="32127.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_7 -->
<g id="edge803" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32247.01,-587.91C32231.68,-578.11 32215.19,-567.56 32199.5,-557.53"/>
<polygon fill="black" stroke="black" points="32201.19,-554.46 32190.88,-552.02 32197.42,-560.36 32201.19,-554.46"/>
</g>
<!-- layer2_expert11_8 -->
<g id="node458" class="node">
<title>layer2_expert11_8</title>
<polygon fill="lightgreen" stroke="black" points="32393,-552 32228,-552 32228,-469 32393,-469 32393,-552"/>
<text text-anchor="middle" x="32310.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU11</text>
<text text-anchor="middle" x="32310.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="32310.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="32310.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="32310.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_8 -->
<g id="edge804" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32310.5,-587.91C32310.5,-579.65 32310.5,-570.86 32310.5,-562.3"/>
<polygon fill="black" stroke="black" points="32314,-562.02 32310.5,-552.02 32307,-562.02 32314,-562.02"/>
</g>
<!-- layer2_expert11_9 -->
<g id="node459" class="node">
<title>layer2_expert11_9</title>
<polygon fill="lightgreen" stroke="black" points="32576,-552 32411,-552 32411,-469 32576,-469 32576,-552"/>
<text text-anchor="middle" x="32493.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU11</text>
<text text-anchor="middle" x="32493.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="32493.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="32493.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="32493.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_9 -->
<g id="edge805" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32373.99,-587.91C32389.32,-578.11 32405.81,-567.56 32421.5,-557.53"/>
<polygon fill="black" stroke="black" points="32423.58,-560.36 32430.12,-552.02 32419.81,-554.46 32423.58,-560.36"/>
</g>
<!-- layer2_expert11_10 -->
<g id="node460" class="node">
<title>layer2_expert11_10</title>
<polygon fill="lightgreen" stroke="black" points="32759,-552 32594,-552 32594,-469 32759,-469 32759,-552"/>
<text text-anchor="middle" x="32676.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU11</text>
<text text-anchor="middle" x="32676.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="32676.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="32676.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="32676.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_10 -->
<g id="edge806" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32432.72,-598.37C32480.54,-585.55 32535.55,-569.51 32584.5,-552 32584.6,-551.97 32584.7,-551.93 32584.79,-551.9"/>
<polygon fill="black" stroke="black" points="32585.81,-555.25 32593.97,-548.49 32583.38,-548.69 32585.81,-555.25"/>
</g>
<!-- layer2_expert11_11 -->
<g id="node461" class="node">
<title>layer2_expert11_11</title>
<polygon fill="lightgreen" stroke="black" points="32942,-552 32777,-552 32777,-469 32942,-469 32942,-552"/>
<text text-anchor="middle" x="32859.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU11</text>
<text text-anchor="middle" x="32859.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="32859.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="32859.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="32859.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_11 -->
<g id="edge807" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32432.64,-616.42C32523.24,-605.52 32649.39,-586.25 32766.96,-551.94"/>
<polygon fill="black" stroke="black" points="32768.26,-555.2 32776.86,-549.01 32766.28,-548.49 32768.26,-555.2"/>
</g>
<!-- layer2_expert11_12 -->
<g id="node462" class="node">
<title>layer2_expert11_12</title>
<polygon fill="lightgreen" stroke="black" points="33125,-552 32960,-552 32960,-469 33125,-469 33125,-552"/>
<text text-anchor="middle" x="33042.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU11</text>
<text text-anchor="middle" x="33042.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="33042.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="33042.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="33042.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_12 -->
<g id="edge808" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32432.56,-624.6C32560.59,-618.1 32767.01,-600.76 32950.11,-551.85"/>
<polygon fill="black" stroke="black" points="32951.18,-555.19 32959.91,-549.2 32949.35,-548.43 32951.18,-555.19"/>
</g>
<!-- layer2_expert11_13 -->
<g id="node463" class="node">
<title>layer2_expert11_13</title>
<polygon fill="lightgreen" stroke="black" points="33308,-552 33143,-552 33143,-469 33308,-469 33308,-552"/>
<text text-anchor="middle" x="33225.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU11</text>
<text text-anchor="middle" x="33225.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="33225.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="33225.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="33225.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_13 -->
<g id="edge809" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32432.87,-621.96C32624.31,-610.93 32986.9,-586.64 33132.82,-551.83"/>
<polygon fill="black" stroke="black" points="33134.09,-555.12 33142.94,-549.3 33132.39,-548.33 33134.09,-555.12"/>
</g>
<!-- layer2_expert11_14 -->
<g id="node464" class="node">
<title>layer2_expert11_14</title>
<polygon fill="lightgreen" stroke="black" points="33491,-552 33326,-552 33326,-469 33491,-469 33491,-552"/>
<text text-anchor="middle" x="33408.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU11</text>
<text text-anchor="middle" x="33408.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="33408.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="33408.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="33408.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_14 -->
<g id="edge810" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32432.6,-624.37C32658.48,-615.9 33134.24,-593.94 33315.97,-551.78"/>
<polygon fill="black" stroke="black" points="33317.06,-555.12 33325.96,-549.37 33315.42,-548.32 33317.06,-555.12"/>
</g>
<!-- layer2_expert11_15 -->
<g id="node465" class="node">
<title>layer2_expert11_15</title>
<polygon fill="lightgreen" stroke="black" points="33674,-552 33509,-552 33509,-469 33674,-469 33674,-552"/>
<text text-anchor="middle" x="33591.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU11</text>
<text text-anchor="middle" x="33591.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="33591.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="33591.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="33591.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_gate_gpu11&#45;&gt;layer2_expert11_15 -->
<g id="edge811" class="edge">
<title>layer2_gate_gpu11&#45;&gt;layer2_expert11_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32432.83,-626.04C32690.32,-619.99 33281.68,-601.3 33499.21,-551.73"/>
<polygon fill="black" stroke="black" points="33500.04,-555.13 33508.97,-549.42 33498.43,-548.31 33500.04,-555.13"/>
</g>
<!-- layer2_moe_agg_gpu11 -->
<g id="node466" class="node">
<title>layer2_moe_agg_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="32507.5,-433 32295.5,-433 32295.5,-350 32507.5,-350 32507.5,-433"/>
<text text-anchor="middle" x="32401.5" y="-417.8" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU11</text>
<text text-anchor="middle" x="32401.5" y="-402.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="32401.5" y="-387.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="32401.5" y="-372.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="32401.5" y="-357.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_expert11_0&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge812" class="edge">
<title>layer2_expert11_0&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M30929.13,-471.23C30931.93,-470.41 30934.73,-469.67 30937.5,-469 31192.53,-407.81 31985.79,-395.56 32285.37,-393.11"/>
<polygon fill="black" stroke="black" points="32285.41,-396.61 32295.38,-393.03 32285.36,-389.61 32285.41,-396.61"/>
</g>
<!-- layer2_expert11_1&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge813" class="edge">
<title>layer2_expert11_1&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M31112.14,-471.26C31114.94,-470.43 31117.73,-469.68 31120.5,-469 31339.41,-415.62 32012.13,-398.83 32284.85,-394.14"/>
<polygon fill="black" stroke="black" points="32285.23,-397.63 32295.17,-393.97 32285.11,-390.64 32285.23,-397.63"/>
</g>
<!-- layer2_expert11_2&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge814" class="edge">
<title>layer2_expert11_2&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M31295.14,-471.29C31297.94,-470.46 31300.73,-469.69 31303.5,-469 31486.75,-423.35 32041.6,-402.59 32284.97,-395.5"/>
<polygon fill="black" stroke="black" points="32285.37,-398.99 32295.27,-395.2 32285.17,-391.99 32285.37,-398.99"/>
</g>
<!-- layer2_expert11_3&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge815" class="edge">
<title>layer2_expert11_3&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M31478.16,-471.34C31480.95,-470.49 31483.74,-469.71 31486.5,-469 31634.43,-431.06 32073.52,-407.06 32285.04,-397.38"/>
<polygon fill="black" stroke="black" points="32285.42,-400.87 32295.25,-396.92 32285.1,-393.88 32285.42,-400.87"/>
</g>
<!-- layer2_expert11_4&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge816" class="edge">
<title>layer2_expert11_4&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M31661.18,-471.42C31663.96,-470.55 31666.74,-469.74 31669.5,-469 31881.65,-412.24 32138.89,-397.21 32285.04,-393.46"/>
<polygon fill="black" stroke="black" points="32285.46,-396.96 32295.37,-393.21 32285.29,-389.96 32285.46,-396.96"/>
</g>
<!-- layer2_expert11_5&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge817" class="edge">
<title>layer2_expert11_5&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M31844.21,-471.54C31846.99,-470.64 31849.76,-469.78 31852.5,-469 31998.44,-427.26 32172.97,-407.91 32285.45,-399.21"/>
<polygon fill="black" stroke="black" points="32285.75,-402.7 32295.46,-398.45 32285.22,-395.72 32285.75,-402.7"/>
</g>
<!-- layer2_expert11_6&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge818" class="edge">
<title>layer2_expert11_6&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M32027.03,-471.87C32029.88,-470.87 32032.7,-469.9 32035.5,-469 32117.36,-442.56 32212.54,-423 32285.32,-410.27"/>
<polygon fill="black" stroke="black" points="32286.18,-413.68 32295.44,-408.52 32284.99,-406.78 32286.18,-413.68"/>
</g>
<!-- layer2_expert11_7&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge819" class="edge">
<title>layer2_expert11_7&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M32210.29,-472.56C32213.06,-471.35 32215.8,-470.16 32218.5,-469 32242.75,-458.54 32268.9,-447.48 32293.63,-437.11"/>
<polygon fill="black" stroke="black" points="32295.15,-440.27 32303.03,-433.18 32292.45,-433.81 32295.15,-440.27"/>
</g>
<!-- layer2_expert11_8&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge820" class="edge">
<title>layer2_expert11_8&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M32342.07,-468.91C32349.06,-459.92 32356.53,-450.32 32363.74,-441.05"/>
<polygon fill="black" stroke="black" points="32366.61,-443.06 32369.98,-433.02 32361.08,-438.77 32366.61,-443.06"/>
</g>
<!-- layer2_expert11_9&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge821" class="edge">
<title>layer2_expert11_9&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M32461.58,-468.91C32454.52,-459.92 32446.96,-450.32 32439.68,-441.05"/>
<polygon fill="black" stroke="black" points="32442.3,-438.72 32433.36,-433.02 32436.79,-443.05 32442.3,-438.72"/>
</g>
<!-- layer2_expert11_10&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge822" class="edge">
<title>layer2_expert11_10&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M32593.78,-473C32590.65,-471.64 32587.55,-470.31 32584.5,-469 32560.09,-458.53 32533.77,-447.42 32508.91,-437.01"/>
<polygon fill="black" stroke="black" points="32510.04,-433.69 32499.46,-433.05 32507.34,-440.14 32510.04,-433.69"/>
</g>
<!-- layer2_expert11_11&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge823" class="edge">
<title>layer2_expert11_11&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M32776.81,-472.15C32773.68,-471.04 32770.57,-469.99 32767.5,-469 32685.59,-442.73 32590.41,-423.16 32517.64,-410.39"/>
<polygon fill="black" stroke="black" points="32517.98,-406.89 32507.53,-408.63 32516.78,-413.79 32517.98,-406.89"/>
</g>
<!-- layer2_expert11_12&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge824" class="edge">
<title>layer2_expert11_12&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M32959.89,-471.88C32956.74,-470.85 32953.61,-469.88 32950.5,-469 32804.47,-427.55 32629.96,-408.14 32517.51,-399.34"/>
<polygon fill="black" stroke="black" points="32517.74,-395.85 32507.51,-398.57 32517.21,-402.83 32517.74,-395.85"/>
</g>
<!-- layer2_expert11_13&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge825" class="edge">
<title>layer2_expert11_13&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M33142.93,-471.74C33139.77,-470.75 33136.62,-469.83 33133.5,-469 32921.23,-412.67 32664.04,-397.49 32517.92,-393.6"/>
<polygon fill="black" stroke="black" points="32517.68,-390.1 32507.6,-393.34 32517.5,-397.09 32517.68,-390.1"/>
</g>
<!-- layer2_expert11_14&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge826" class="edge">
<title>layer2_expert11_14&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M33325.95,-471.66C33322.79,-470.69 33319.63,-469.8 33316.5,-469 33168.49,-431.36 32729.44,-407.21 32517.94,-397.44"/>
<polygon fill="black" stroke="black" points="32517.89,-393.93 32507.74,-396.97 32517.57,-400.93 32517.89,-393.93"/>
</g>
<!-- layer2_expert11_15&#45;&gt;layer2_moe_agg_gpu11 -->
<g id="edge827" class="edge">
<title>layer2_expert11_15&#45;&gt;layer2_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M33508.96,-471.6C33505.8,-470.65 33502.63,-469.77 33499.5,-469 33316.16,-423.72 32761.35,-402.76 32518.01,-395.55"/>
<polygon fill="black" stroke="black" points="32517.82,-392.05 32507.72,-395.25 32517.61,-399.04 32517.82,-392.05"/>
</g>
<!-- layer2_output_gpu11 -->
<g id="node467" class="node">
<title>layer2_output_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="33345,-142 33092,-142 33092,-74 33345,-74 33345,-142"/>
<text text-anchor="middle" x="33218.5" y="-126.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU11</text>
<text text-anchor="middle" x="33218.5" y="-111.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="33218.5" y="-96.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33218.5" y="-81.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_moe_agg_gpu11&#45;&gt;layer2_output_gpu11 -->
<g id="edge828" class="edge">
<title>layer2_moe_agg_gpu11&#45;&gt;layer2_output_gpu11</title>
<path fill="none" stroke="black" d="M32507.89,-353.84C32664.82,-299.77 32956.62,-199.23 33113.03,-145.34"/>
<polygon fill="black" stroke="black" points="33114.36,-148.58 33122.67,-142.02 33112.08,-141.97 33114.36,-148.58"/>
</g>
<!-- layer2_moe_agg_gpu11&#45;&gt;layer2_allreduce_moe -->
<g id="edge991" class="edge">
<title>layer2_moe_agg_gpu11&#45;&gt;layer2_allreduce_moe</title>
<path fill="none" stroke="black" d="M32507.63,-377.7C32717.77,-352.36 33187.73,-295.69 33434.05,-265.99"/>
<polygon fill="black" stroke="black" points="33434.65,-269.44 33444.16,-264.77 33433.81,-262.49 33434.65,-269.44"/>
</g>
<!-- layer2_qkv_gpu12 -->
<g id="node468" class="node">
<title>layer2_qkv_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="33911.5,-1304 33701.5,-1304 33701.5,-1206 33911.5,-1206 33911.5,-1304"/>
<text text-anchor="middle" x="33806.5" y="-1288.8" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU12</text>
<text text-anchor="middle" x="33806.5" y="-1273.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="33806.5" y="-1258.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="33806.5" y="-1243.8" font-family="Times,serif" font-size="14.00">Heads: 16&#45;19</text>
<text text-anchor="middle" x="33806.5" y="-1228.8" font-family="Times,serif" font-size="14.00">TP Slice: 4</text>
<text text-anchor="middle" x="33806.5" y="-1213.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_attn_gpu12 -->
<g id="node469" class="node">
<title>layer2_attn_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="33943.5,-1170 33691.5,-1170 33691.5,-1087 33943.5,-1087 33943.5,-1170"/>
<text text-anchor="middle" x="33817.5" y="-1154.8" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU12</text>
<text text-anchor="middle" x="33817.5" y="-1139.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="33817.5" y="-1124.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33817.5" y="-1109.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="33817.5" y="-1094.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_qkv_gpu12&#45;&gt;layer2_attn_gpu12 -->
<g id="edge829" class="edge">
<title>layer2_qkv_gpu12&#45;&gt;layer2_attn_gpu12</title>
<path fill="none" stroke="black" d="M33810.75,-1205.87C33811.49,-1197.5 33812.26,-1188.77 33813.01,-1180.33"/>
<polygon fill="black" stroke="black" points="33816.51,-1180.5 33813.9,-1170.23 33809.53,-1179.88 33816.51,-1180.5"/>
</g>
<!-- layer2_attn_proj_gpu12 -->
<g id="node470" class="node">
<title>layer2_attn_proj_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="33922,-1051 33713,-1051 33713,-983 33922,-983 33922,-1051"/>
<text text-anchor="middle" x="33817.5" y="-1035.8" font-family="Times,serif" font-size="14.00">L2_Attn_Projection_GPU12</text>
<text text-anchor="middle" x="33817.5" y="-1020.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="33817.5" y="-1005.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33817.5" y="-990.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_attn_gpu12&#45;&gt;layer2_attn_proj_gpu12 -->
<g id="edge830" class="edge">
<title>layer2_attn_gpu12&#45;&gt;layer2_attn_proj_gpu12</title>
<path fill="none" stroke="black" d="M33817.5,-1086.73C33817.5,-1078.52 33817.5,-1069.86 33817.5,-1061.56"/>
<polygon fill="black" stroke="black" points="33821,-1061.3 33817.5,-1051.3 33814,-1061.3 33821,-1061.3"/>
</g>
<!-- layer2_attn_norm_gpu12 -->
<g id="node471" class="node">
<title>layer2_attn_norm_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="33945,-775 33692,-775 33692,-707 33945,-707 33945,-775"/>
<text text-anchor="middle" x="33818.5" y="-759.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU12</text>
<text text-anchor="middle" x="33818.5" y="-744.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="33818.5" y="-729.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="33818.5" y="-714.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_attn_proj_gpu12&#45;&gt;layer2_attn_norm_gpu12 -->
<g id="edge831" class="edge">
<title>layer2_attn_proj_gpu12&#45;&gt;layer2_attn_norm_gpu12</title>
<path fill="none" stroke="black" d="M33867.14,-982.69C33878.19,-972.64 33888.42,-960.6 33894.5,-947 33919.15,-891.81 33918.97,-866.27 33894.5,-811 33889.81,-800.41 33882.61,-790.76 33874.47,-782.24"/>
<polygon fill="black" stroke="black" points="33876.71,-779.54 33867.11,-775.05 33871.82,-784.54 33876.71,-779.54"/>
</g>
<!-- layer2_attn_proj_gpu12&#45;&gt;layer2_allreduce_attn -->
<g id="edge993" class="edge">
<title>layer2_attn_proj_gpu12&#45;&gt;layer2_allreduce_attn</title>
<path fill="none" stroke="black" d="M33784.48,-982.73C33771.06,-969.21 33755.16,-953.2 33739.95,-937.88"/>
<polygon fill="black" stroke="black" points="33742.09,-935.06 33732.56,-930.43 33737.12,-939.99 33742.09,-935.06"/>
</g>
<!-- layer2_gate_gpu12 -->
<g id="node472" class="node">
<title>layer2_gate_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="35177.5,-671 34933.5,-671 34933.5,-588 35177.5,-588 35177.5,-671"/>
<text text-anchor="middle" x="35055.5" y="-655.8" font-family="Times,serif" font-size="14.00">L2_Gate_GPU12</text>
<text text-anchor="middle" x="35055.5" y="-640.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="35055.5" y="-625.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="35055.5" y="-610.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="35055.5" y="-595.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_attn_norm_gpu12&#45;&gt;layer2_gate_gpu12 -->
<g id="edge832" class="edge">
<title>layer2_attn_norm_gpu12&#45;&gt;layer2_gate_gpu12</title>
<path fill="none" stroke="black" d="M33945.2,-708.36C33947.99,-707.88 33950.76,-707.43 33953.5,-707 34300.75,-652.91 34715.52,-637.06 34923.22,-632.42"/>
<polygon fill="black" stroke="black" points="34923.34,-635.92 34933.26,-632.2 34923.18,-628.92 34923.34,-635.92"/>
</g>
<!-- layer2_expert12_0 -->
<g id="node473" class="node">
<title>layer2_expert12_0</title>
<polygon fill="lightgreen" stroke="black" points="33857,-552 33692,-552 33692,-469 33857,-469 33857,-552"/>
<text text-anchor="middle" x="33774.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU12</text>
<text text-anchor="middle" x="33774.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="33774.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="33774.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="33774.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_0 -->
<g id="edge833" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34933.05,-626.1C34675.44,-620.18 34084,-601.75 33867.18,-552.11"/>
<polygon fill="black" stroke="black" points="33867.68,-548.63 33857.14,-549.73 33866.06,-555.44 33867.68,-548.63"/>
</g>
<!-- layer2_expert12_1 -->
<g id="node474" class="node">
<title>layer2_expert12_1</title>
<polygon fill="lightgreen" stroke="black" points="34040,-552 33875,-552 33875,-469 34040,-469 34040,-552"/>
<text text-anchor="middle" x="33957.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU12</text>
<text text-anchor="middle" x="33957.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="33957.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="33957.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="33957.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_1 -->
<g id="edge834" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34933.26,-624.44C34707.14,-616.08 34230.86,-594.29 34050.08,-552.1"/>
<polygon fill="black" stroke="black" points="34050.69,-548.65 34040.15,-549.68 34049.04,-555.45 34050.69,-548.65"/>
</g>
<!-- layer2_expert12_2 -->
<g id="node475" class="node">
<title>layer2_expert12_2</title>
<polygon fill="lightgreen" stroke="black" points="34223,-552 34058,-552 34058,-469 34223,-469 34223,-552"/>
<text text-anchor="middle" x="34140.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU12</text>
<text text-anchor="middle" x="34140.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="34140.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="34140.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="34140.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_2 -->
<g id="edge835" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34933.36,-622.05C34741.78,-611.12 34378.32,-586.96 34233.23,-552.15"/>
<polygon fill="black" stroke="black" points="34233.72,-548.66 34223.17,-549.62 34232.01,-555.45 34233.72,-548.66"/>
</g>
<!-- layer2_expert12_3 -->
<g id="node476" class="node">
<title>layer2_expert12_3</title>
<polygon fill="lightgreen" stroke="black" points="34406,-552 34241,-552 34241,-469 34406,-469 34406,-552"/>
<text text-anchor="middle" x="34323.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU12</text>
<text text-anchor="middle" x="34323.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="34323.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="34323.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="34323.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_3 -->
<g id="edge836" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34933.21,-624.77C34804.95,-618.4 34598.18,-601.17 34415.95,-552.19"/>
<polygon fill="black" stroke="black" points="34416.76,-548.78 34406.19,-549.53 34414.92,-555.53 34416.76,-548.78"/>
</g>
<!-- layer2_expert12_4 -->
<g id="node477" class="node">
<title>layer2_expert12_4</title>
<polygon fill="lightgreen" stroke="black" points="34589,-552 34424,-552 34424,-469 34589,-469 34589,-552"/>
<text text-anchor="middle" x="34506.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU12</text>
<text text-anchor="middle" x="34506.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="34506.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="34506.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="34506.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_4 -->
<g id="edge837" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34933.05,-616.58C34842.24,-605.76 34715.81,-586.52 34599.06,-552.28"/>
<polygon fill="black" stroke="black" points="34599.82,-548.86 34589.24,-549.36 34597.83,-555.57 34599.82,-548.86"/>
</g>
<!-- layer2_expert12_5 -->
<g id="node478" class="node">
<title>layer2_expert12_5</title>
<polygon fill="lightgreen" stroke="black" points="34772,-552 34607,-552 34607,-469 34772,-469 34772,-552"/>
<text text-anchor="middle" x="34689.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU12</text>
<text text-anchor="middle" x="34689.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="34689.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="34689.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="34689.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_5 -->
<g id="edge838" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34933.47,-598.69C34887.95,-586.56 34835.87,-571.48 34781.56,-552.26"/>
<polygon fill="black" stroke="black" points="34782.71,-548.96 34772.12,-548.89 34780.35,-555.55 34782.71,-548.96"/>
</g>
<!-- layer2_expert12_6 -->
<g id="node479" class="node">
<title>layer2_expert12_6</title>
<polygon fill="lightgreen" stroke="black" points="34955,-552 34790,-552 34790,-469 34955,-469 34955,-552"/>
<text text-anchor="middle" x="34872.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU12</text>
<text text-anchor="middle" x="34872.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="34872.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="34872.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="34872.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_6 -->
<g id="edge839" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34992.01,-587.91C34976.68,-578.11 34960.19,-567.56 34944.5,-557.53"/>
<polygon fill="black" stroke="black" points="34946.19,-554.46 34935.88,-552.02 34942.42,-560.36 34946.19,-554.46"/>
</g>
<!-- layer2_expert12_7 -->
<g id="node480" class="node">
<title>layer2_expert12_7</title>
<polygon fill="lightgreen" stroke="black" points="35138,-552 34973,-552 34973,-469 35138,-469 35138,-552"/>
<text text-anchor="middle" x="35055.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU12</text>
<text text-anchor="middle" x="35055.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="35055.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="35055.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="35055.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_7 -->
<g id="edge840" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35055.5,-587.91C35055.5,-579.65 35055.5,-570.86 35055.5,-562.3"/>
<polygon fill="black" stroke="black" points="35059,-562.02 35055.5,-552.02 35052,-562.02 35059,-562.02"/>
</g>
<!-- layer2_expert12_8 -->
<g id="node481" class="node">
<title>layer2_expert12_8</title>
<polygon fill="lightgreen" stroke="black" points="35321,-552 35156,-552 35156,-469 35321,-469 35321,-552"/>
<text text-anchor="middle" x="35238.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU12</text>
<text text-anchor="middle" x="35238.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="35238.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="35238.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="35238.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_8 -->
<g id="edge841" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35118.99,-587.91C35134.32,-578.11 35150.81,-567.56 35166.5,-557.53"/>
<polygon fill="black" stroke="black" points="35168.58,-560.36 35175.12,-552.02 35164.81,-554.46 35168.58,-560.36"/>
</g>
<!-- layer2_expert12_9 -->
<g id="node482" class="node">
<title>layer2_expert12_9</title>
<polygon fill="lightgreen" stroke="black" points="35504,-552 35339,-552 35339,-469 35504,-469 35504,-552"/>
<text text-anchor="middle" x="35421.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU12</text>
<text text-anchor="middle" x="35421.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="35421.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="35421.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="35421.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_9 -->
<g id="edge842" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35177.72,-598.37C35225.54,-585.55 35280.55,-569.51 35329.5,-552 35329.6,-551.97 35329.7,-551.93 35329.79,-551.9"/>
<polygon fill="black" stroke="black" points="35330.81,-555.25 35338.97,-548.49 35328.38,-548.69 35330.81,-555.25"/>
</g>
<!-- layer2_expert12_10 -->
<g id="node483" class="node">
<title>layer2_expert12_10</title>
<polygon fill="lightgreen" stroke="black" points="35687,-552 35522,-552 35522,-469 35687,-469 35687,-552"/>
<text text-anchor="middle" x="35604.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU12</text>
<text text-anchor="middle" x="35604.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="35604.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="35604.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="35604.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_10 -->
<g id="edge843" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35177.64,-616.42C35268.24,-605.52 35394.39,-586.25 35511.96,-551.94"/>
<polygon fill="black" stroke="black" points="35513.26,-555.2 35521.86,-549.01 35511.28,-548.49 35513.26,-555.2"/>
</g>
<!-- layer2_expert12_11 -->
<g id="node484" class="node">
<title>layer2_expert12_11</title>
<polygon fill="lightgreen" stroke="black" points="35870,-552 35705,-552 35705,-469 35870,-469 35870,-552"/>
<text text-anchor="middle" x="35787.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU12</text>
<text text-anchor="middle" x="35787.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="35787.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="35787.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="35787.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_11 -->
<g id="edge844" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35177.56,-624.6C35305.59,-618.1 35512.01,-600.76 35695.11,-551.85"/>
<polygon fill="black" stroke="black" points="35696.18,-555.19 35704.91,-549.2 35694.35,-548.43 35696.18,-555.19"/>
</g>
<!-- layer2_expert12_12 -->
<g id="node485" class="node">
<title>layer2_expert12_12</title>
<polygon fill="lightgreen" stroke="black" points="36053,-552 35888,-552 35888,-469 36053,-469 36053,-552"/>
<text text-anchor="middle" x="35970.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU12</text>
<text text-anchor="middle" x="35970.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="35970.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="35970.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="35970.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_12 -->
<g id="edge845" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35177.87,-621.96C35369.31,-610.93 35731.9,-586.64 35877.82,-551.83"/>
<polygon fill="black" stroke="black" points="35879.09,-555.12 35887.94,-549.3 35877.39,-548.33 35879.09,-555.12"/>
</g>
<!-- layer2_expert12_13 -->
<g id="node486" class="node">
<title>layer2_expert12_13</title>
<polygon fill="lightgreen" stroke="black" points="36236,-552 36071,-552 36071,-469 36236,-469 36236,-552"/>
<text text-anchor="middle" x="36153.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU12</text>
<text text-anchor="middle" x="36153.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="36153.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="36153.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="36153.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_13 -->
<g id="edge846" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35177.6,-624.37C35403.48,-615.9 35879.24,-593.94 36060.97,-551.78"/>
<polygon fill="black" stroke="black" points="36062.06,-555.12 36070.96,-549.37 36060.42,-548.32 36062.06,-555.12"/>
</g>
<!-- layer2_expert12_14 -->
<g id="node487" class="node">
<title>layer2_expert12_14</title>
<polygon fill="lightgreen" stroke="black" points="36419,-552 36254,-552 36254,-469 36419,-469 36419,-552"/>
<text text-anchor="middle" x="36336.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU12</text>
<text text-anchor="middle" x="36336.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="36336.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="36336.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="36336.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_14 -->
<g id="edge847" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35177.83,-626.04C35435.32,-619.99 36026.68,-601.3 36244.21,-551.73"/>
<polygon fill="black" stroke="black" points="36245.04,-555.13 36253.97,-549.42 36243.43,-548.31 36245.04,-555.13"/>
</g>
<!-- layer2_expert12_15 -->
<g id="node488" class="node">
<title>layer2_expert12_15</title>
<polygon fill="lightgreen" stroke="black" points="36602,-552 36437,-552 36437,-469 36602,-469 36602,-552"/>
<text text-anchor="middle" x="36519.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU12</text>
<text text-anchor="middle" x="36519.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="36519.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="36519.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="36519.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_gate_gpu12&#45;&gt;layer2_expert12_15 -->
<g id="edge848" class="edge">
<title>layer2_gate_gpu12&#45;&gt;layer2_expert12_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35177.56,-627.27C35463.91,-623.51 36173.07,-608.8 36427.05,-551.76"/>
<polygon fill="black" stroke="black" points="36428.03,-555.13 36436.98,-549.45 36426.45,-548.31 36428.03,-555.13"/>
</g>
<!-- layer2_moe_agg_gpu12 -->
<g id="node489" class="node">
<title>layer2_moe_agg_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="35069.5,-433 34857.5,-433 34857.5,-350 35069.5,-350 35069.5,-433"/>
<text text-anchor="middle" x="34963.5" y="-417.8" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU12</text>
<text text-anchor="middle" x="34963.5" y="-402.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="34963.5" y="-387.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34963.5" y="-372.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="34963.5" y="-357.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_expert12_0&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge849" class="edge">
<title>layer2_expert12_0&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M33857.14,-471.29C33859.94,-470.46 33862.73,-469.69 33865.5,-469 34048.75,-423.35 34603.6,-402.59 34846.97,-395.5"/>
<polygon fill="black" stroke="black" points="34847.37,-398.99 34857.27,-395.2 34847.17,-391.99 34847.37,-398.99"/>
</g>
<!-- layer2_expert12_1&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge850" class="edge">
<title>layer2_expert12_1&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M34040.16,-471.34C34042.95,-470.49 34045.74,-469.71 34048.5,-469 34196.43,-431.06 34635.52,-407.06 34847.04,-397.38"/>
<polygon fill="black" stroke="black" points="34847.42,-400.87 34857.25,-396.92 34847.1,-393.88 34847.42,-400.87"/>
</g>
<!-- layer2_expert12_2&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge851" class="edge">
<title>layer2_expert12_2&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M34223.18,-471.42C34225.96,-470.55 34228.74,-469.74 34231.5,-469 34443.65,-412.24 34700.89,-397.21 34847.04,-393.46"/>
<polygon fill="black" stroke="black" points="34847.46,-396.96 34857.37,-393.21 34847.29,-389.96 34847.46,-396.96"/>
</g>
<!-- layer2_expert12_3&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge852" class="edge">
<title>layer2_expert12_3&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M34406.21,-471.54C34408.99,-470.64 34411.76,-469.78 34414.5,-469 34560.44,-427.26 34734.97,-407.91 34847.45,-399.21"/>
<polygon fill="black" stroke="black" points="34847.75,-402.7 34857.46,-398.45 34847.22,-395.72 34847.75,-402.7"/>
</g>
<!-- layer2_expert12_4&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge853" class="edge">
<title>layer2_expert12_4&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M34589.03,-471.87C34591.88,-470.87 34594.7,-469.9 34597.5,-469 34679.36,-442.56 34774.54,-423 34847.32,-410.27"/>
<polygon fill="black" stroke="black" points="34848.18,-413.68 34857.44,-408.52 34846.99,-406.78 34848.18,-413.68"/>
</g>
<!-- layer2_expert12_5&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge854" class="edge">
<title>layer2_expert12_5&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M34772.29,-472.56C34775.06,-471.35 34777.8,-470.16 34780.5,-469 34804.75,-458.54 34830.9,-447.48 34855.63,-437.11"/>
<polygon fill="black" stroke="black" points="34857.15,-440.27 34865.03,-433.18 34854.45,-433.81 34857.15,-440.27"/>
</g>
<!-- layer2_expert12_6&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge855" class="edge">
<title>layer2_expert12_6&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M34904.07,-468.91C34911.06,-459.92 34918.53,-450.32 34925.74,-441.05"/>
<polygon fill="black" stroke="black" points="34928.61,-443.06 34931.98,-433.02 34923.08,-438.77 34928.61,-443.06"/>
</g>
<!-- layer2_expert12_7&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge856" class="edge">
<title>layer2_expert12_7&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M35023.58,-468.91C35016.52,-459.92 35008.96,-450.32 35001.68,-441.05"/>
<polygon fill="black" stroke="black" points="35004.3,-438.72 34995.36,-433.02 34998.79,-443.05 35004.3,-438.72"/>
</g>
<!-- layer2_expert12_8&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge857" class="edge">
<title>layer2_expert12_8&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M35155.78,-473C35152.65,-471.64 35149.55,-470.31 35146.5,-469 35122.09,-458.53 35095.77,-447.42 35070.91,-437.01"/>
<polygon fill="black" stroke="black" points="35072.04,-433.69 35061.46,-433.05 35069.34,-440.14 35072.04,-433.69"/>
</g>
<!-- layer2_expert12_9&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge858" class="edge">
<title>layer2_expert12_9&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M35338.81,-472.15C35335.68,-471.04 35332.57,-469.99 35329.5,-469 35247.59,-442.73 35152.41,-423.16 35079.64,-410.39"/>
<polygon fill="black" stroke="black" points="35079.98,-406.89 35069.53,-408.63 35078.78,-413.79 35079.98,-406.89"/>
</g>
<!-- layer2_expert12_10&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge859" class="edge">
<title>layer2_expert12_10&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M35521.89,-471.88C35518.74,-470.85 35515.61,-469.88 35512.5,-469 35366.47,-427.55 35191.96,-408.14 35079.51,-399.34"/>
<polygon fill="black" stroke="black" points="35079.74,-395.85 35069.51,-398.57 35079.21,-402.83 35079.74,-395.85"/>
</g>
<!-- layer2_expert12_11&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge860" class="edge">
<title>layer2_expert12_11&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M35704.93,-471.74C35701.77,-470.75 35698.62,-469.83 35695.5,-469 35483.23,-412.67 35226.04,-397.49 35079.92,-393.6"/>
<polygon fill="black" stroke="black" points="35079.68,-390.1 35069.6,-393.34 35079.5,-397.09 35079.68,-390.1"/>
</g>
<!-- layer2_expert12_12&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge861" class="edge">
<title>layer2_expert12_12&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M35887.95,-471.66C35884.79,-470.69 35881.63,-469.8 35878.5,-469 35730.49,-431.36 35291.44,-407.21 35079.94,-397.44"/>
<polygon fill="black" stroke="black" points="35079.89,-393.93 35069.74,-396.97 35079.57,-400.93 35079.89,-393.93"/>
</g>
<!-- layer2_expert12_13&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge862" class="edge">
<title>layer2_expert12_13&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M36070.96,-471.6C36067.8,-470.65 36064.63,-469.77 36061.5,-469 35878.16,-423.72 35323.35,-402.76 35080.01,-395.55"/>
<polygon fill="black" stroke="black" points="35079.82,-392.05 35069.72,-395.25 35079.61,-399.04 35079.82,-392.05"/>
</g>
<!-- layer2_expert12_14&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge863" class="edge">
<title>layer2_expert12_14&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M36253.97,-471.56C36250.8,-470.62 36247.64,-469.76 36244.5,-469 36025.48,-416.06 35352.83,-399.02 35080.14,-394.2"/>
<polygon fill="black" stroke="black" points="35079.88,-390.69 35069.82,-394.02 35079.76,-397.69 35079.88,-390.69"/>
</g>
<!-- layer2_expert12_15&#45;&gt;layer2_moe_agg_gpu12 -->
<g id="edge864" class="edge">
<title>layer2_expert12_15&#45;&gt;layer2_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M36436.98,-471.53C36433.81,-470.6 36430.64,-469.75 36427.5,-469 36172.34,-408.33 35379.16,-395.76 35079.62,-393.17"/>
<polygon fill="black" stroke="black" points="35079.63,-389.67 35069.6,-393.09 35079.57,-396.67 35079.63,-389.67"/>
</g>
<!-- layer2_output_gpu12 -->
<g id="node490" class="node">
<title>layer2_output_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="34646,-142 34393,-142 34393,-74 34646,-74 34646,-142"/>
<text text-anchor="middle" x="34519.5" y="-126.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU12</text>
<text text-anchor="middle" x="34519.5" y="-111.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="34519.5" y="-96.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34519.5" y="-81.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_moe_agg_gpu12&#45;&gt;layer2_output_gpu12 -->
<g id="edge865" class="edge">
<title>layer2_moe_agg_gpu12&#45;&gt;layer2_output_gpu12</title>
<path fill="none" stroke="black" d="M34899.41,-349.87C34814.06,-295.75 34664.13,-200.7 34580.41,-147.62"/>
<polygon fill="black" stroke="black" points="34582.1,-144.54 34571.78,-142.15 34578.35,-150.46 34582.1,-144.54"/>
</g>
<!-- layer2_moe_agg_gpu12&#45;&gt;layer2_allreduce_moe -->
<g id="edge995" class="edge">
<title>layer2_moe_agg_gpu12&#45;&gt;layer2_allreduce_moe</title>
<path fill="none" stroke="black" d="M34857.27,-379.39C34618.53,-354.42 34038.3,-293.73 33753.97,-263.99"/>
<polygon fill="black" stroke="black" points="33754.29,-260.51 33743.98,-262.95 33753.56,-267.47 33754.29,-260.51"/>
</g>
<!-- layer2_qkv_gpu13 -->
<g id="node491" class="node">
<title>layer2_qkv_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="34170.5,-1304 33960.5,-1304 33960.5,-1206 34170.5,-1206 34170.5,-1304"/>
<text text-anchor="middle" x="34065.5" y="-1288.8" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU13</text>
<text text-anchor="middle" x="34065.5" y="-1273.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="34065.5" y="-1258.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="34065.5" y="-1243.8" font-family="Times,serif" font-size="14.00">Heads: 20&#45;23</text>
<text text-anchor="middle" x="34065.5" y="-1228.8" font-family="Times,serif" font-size="14.00">TP Slice: 5</text>
<text text-anchor="middle" x="34065.5" y="-1213.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_attn_gpu13 -->
<g id="node492" class="node">
<title>layer2_attn_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="34213.5,-1170 33961.5,-1170 33961.5,-1087 34213.5,-1087 34213.5,-1170"/>
<text text-anchor="middle" x="34087.5" y="-1154.8" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU13</text>
<text text-anchor="middle" x="34087.5" y="-1139.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="34087.5" y="-1124.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34087.5" y="-1109.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="34087.5" y="-1094.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_qkv_gpu13&#45;&gt;layer2_attn_gpu13 -->
<g id="edge866" class="edge">
<title>layer2_qkv_gpu13&#45;&gt;layer2_attn_gpu13</title>
<path fill="none" stroke="black" d="M34074.01,-1205.87C34075.48,-1197.5 34077.03,-1188.77 34078.52,-1180.33"/>
<polygon fill="black" stroke="black" points="34082.01,-1180.69 34080.3,-1170.23 34075.12,-1179.47 34082.01,-1180.69"/>
</g>
<!-- layer2_attn_proj_gpu13 -->
<g id="node493" class="node">
<title>layer2_attn_proj_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="34192,-1051 33983,-1051 33983,-983 34192,-983 34192,-1051"/>
<text text-anchor="middle" x="34087.5" y="-1035.8" font-family="Times,serif" font-size="14.00">L2_Attn_Projection_GPU13</text>
<text text-anchor="middle" x="34087.5" y="-1020.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="34087.5" y="-1005.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34087.5" y="-990.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_attn_gpu13&#45;&gt;layer2_attn_proj_gpu13 -->
<g id="edge867" class="edge">
<title>layer2_attn_gpu13&#45;&gt;layer2_attn_proj_gpu13</title>
<path fill="none" stroke="black" d="M34087.5,-1086.73C34087.5,-1078.52 34087.5,-1069.86 34087.5,-1061.56"/>
<polygon fill="black" stroke="black" points="34091,-1061.3 34087.5,-1051.3 34084,-1061.3 34091,-1061.3"/>
</g>
<!-- layer2_attn_norm_gpu13 -->
<g id="node494" class="node">
<title>layer2_attn_norm_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="34216,-775 33963,-775 33963,-707 34216,-707 34216,-775"/>
<text text-anchor="middle" x="34089.5" y="-759.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU13</text>
<text text-anchor="middle" x="34089.5" y="-744.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="34089.5" y="-729.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34089.5" y="-714.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_attn_proj_gpu13&#45;&gt;layer2_attn_norm_gpu13 -->
<g id="edge868" class="edge">
<title>layer2_attn_proj_gpu13&#45;&gt;layer2_attn_norm_gpu13</title>
<path fill="none" stroke="black" d="M34087.74,-982.95C34088.1,-933.47 34088.78,-840.12 34089.18,-785.27"/>
<polygon fill="black" stroke="black" points="34092.68,-785.19 34089.26,-775.17 34085.68,-785.14 34092.68,-785.19"/>
</g>
<!-- layer2_attn_proj_gpu13&#45;&gt;layer2_allreduce_attn -->
<g id="edge997" class="edge">
<title>layer2_attn_proj_gpu13&#45;&gt;layer2_allreduce_attn</title>
<path fill="none" stroke="black" d="M33989.2,-982.99C33929.75,-963.03 33853.84,-937.54 33792.41,-916.91"/>
<polygon fill="black" stroke="black" points="33793.27,-913.51 33782.68,-913.64 33791.04,-920.14 33793.27,-913.51"/>
</g>
<!-- layer2_gate_gpu13 -->
<g id="node495" class="node">
<title>layer2_gate_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="38105.5,-671 37861.5,-671 37861.5,-588 38105.5,-588 38105.5,-671"/>
<text text-anchor="middle" x="37983.5" y="-655.8" font-family="Times,serif" font-size="14.00">L2_Gate_GPU13</text>
<text text-anchor="middle" x="37983.5" y="-640.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="37983.5" y="-625.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="37983.5" y="-610.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="37983.5" y="-595.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_attn_norm_gpu13&#45;&gt;layer2_gate_gpu13 -->
<g id="edge869" class="edge">
<title>layer2_attn_norm_gpu13&#45;&gt;layer2_gate_gpu13</title>
<path fill="none" stroke="black" d="M34216.18,-708.18C34218.97,-707.75 34221.75,-707.36 34224.5,-707 34407.62,-683.05 37205.37,-641.65 37851.19,-632.38"/>
<polygon fill="black" stroke="black" points="37851.52,-635.87 37861.47,-632.23 37851.42,-628.87 37851.52,-635.87"/>
</g>
<!-- layer2_expert13_0 -->
<g id="node496" class="node">
<title>layer2_expert13_0</title>
<polygon fill="lightgreen" stroke="black" points="36785,-552 36620,-552 36620,-469 36785,-469 36785,-552"/>
<text text-anchor="middle" x="36702.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU13</text>
<text text-anchor="middle" x="36702.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="36702.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="36702.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="36702.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_0 -->
<g id="edge870" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37861.05,-626.1C37603.44,-620.18 37012,-601.75 36795.18,-552.11"/>
<polygon fill="black" stroke="black" points="36795.68,-548.63 36785.14,-549.73 36794.06,-555.44 36795.68,-548.63"/>
</g>
<!-- layer2_expert13_1 -->
<g id="node497" class="node">
<title>layer2_expert13_1</title>
<polygon fill="lightgreen" stroke="black" points="36968,-552 36803,-552 36803,-469 36968,-469 36968,-552"/>
<text text-anchor="middle" x="36885.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU13</text>
<text text-anchor="middle" x="36885.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="36885.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="36885.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="36885.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_1 -->
<g id="edge871" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37861.26,-624.44C37635.14,-616.08 37158.86,-594.29 36978.08,-552.1"/>
<polygon fill="black" stroke="black" points="36978.69,-548.65 36968.15,-549.68 36977.04,-555.45 36978.69,-548.65"/>
</g>
<!-- layer2_expert13_2 -->
<g id="node498" class="node">
<title>layer2_expert13_2</title>
<polygon fill="lightgreen" stroke="black" points="37151,-552 36986,-552 36986,-469 37151,-469 37151,-552"/>
<text text-anchor="middle" x="37068.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU13</text>
<text text-anchor="middle" x="37068.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="37068.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="37068.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="37068.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_2 -->
<g id="edge872" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37861.36,-622.05C37669.78,-611.12 37306.32,-586.96 37161.23,-552.15"/>
<polygon fill="black" stroke="black" points="37161.72,-548.66 37151.17,-549.62 37160.01,-555.45 37161.72,-548.66"/>
</g>
<!-- layer2_expert13_3 -->
<g id="node499" class="node">
<title>layer2_expert13_3</title>
<polygon fill="lightgreen" stroke="black" points="37334,-552 37169,-552 37169,-469 37334,-469 37334,-552"/>
<text text-anchor="middle" x="37251.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU13</text>
<text text-anchor="middle" x="37251.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="37251.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="37251.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="37251.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_3 -->
<g id="edge873" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37861.21,-624.77C37732.95,-618.4 37526.18,-601.17 37343.95,-552.19"/>
<polygon fill="black" stroke="black" points="37344.76,-548.78 37334.19,-549.53 37342.92,-555.53 37344.76,-548.78"/>
</g>
<!-- layer2_expert13_4 -->
<g id="node500" class="node">
<title>layer2_expert13_4</title>
<polygon fill="lightgreen" stroke="black" points="37517,-552 37352,-552 37352,-469 37517,-469 37517,-552"/>
<text text-anchor="middle" x="37434.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU13</text>
<text text-anchor="middle" x="37434.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="37434.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="37434.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="37434.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_4 -->
<g id="edge874" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37861.05,-616.58C37770.24,-605.76 37643.81,-586.52 37527.06,-552.28"/>
<polygon fill="black" stroke="black" points="37527.82,-548.86 37517.24,-549.36 37525.83,-555.57 37527.82,-548.86"/>
</g>
<!-- layer2_expert13_5 -->
<g id="node501" class="node">
<title>layer2_expert13_5</title>
<polygon fill="lightgreen" stroke="black" points="37700,-552 37535,-552 37535,-469 37700,-469 37700,-552"/>
<text text-anchor="middle" x="37617.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU13</text>
<text text-anchor="middle" x="37617.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="37617.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="37617.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="37617.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_5 -->
<g id="edge875" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37861.47,-598.69C37815.95,-586.56 37763.87,-571.48 37709.56,-552.26"/>
<polygon fill="black" stroke="black" points="37710.71,-548.96 37700.12,-548.89 37708.35,-555.55 37710.71,-548.96"/>
</g>
<!-- layer2_expert13_6 -->
<g id="node502" class="node">
<title>layer2_expert13_6</title>
<polygon fill="lightgreen" stroke="black" points="37883,-552 37718,-552 37718,-469 37883,-469 37883,-552"/>
<text text-anchor="middle" x="37800.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU13</text>
<text text-anchor="middle" x="37800.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="37800.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="37800.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="37800.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_6 -->
<g id="edge876" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37920.01,-587.91C37904.68,-578.11 37888.19,-567.56 37872.5,-557.53"/>
<polygon fill="black" stroke="black" points="37874.19,-554.46 37863.88,-552.02 37870.42,-560.36 37874.19,-554.46"/>
</g>
<!-- layer2_expert13_7 -->
<g id="node503" class="node">
<title>layer2_expert13_7</title>
<polygon fill="lightgreen" stroke="black" points="38066,-552 37901,-552 37901,-469 38066,-469 38066,-552"/>
<text text-anchor="middle" x="37983.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU13</text>
<text text-anchor="middle" x="37983.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="37983.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="37983.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="37983.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_7 -->
<g id="edge877" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37983.5,-587.91C37983.5,-579.65 37983.5,-570.86 37983.5,-562.3"/>
<polygon fill="black" stroke="black" points="37987,-562.02 37983.5,-552.02 37980,-562.02 37987,-562.02"/>
</g>
<!-- layer2_expert13_8 -->
<g id="node504" class="node">
<title>layer2_expert13_8</title>
<polygon fill="lightgreen" stroke="black" points="38249,-552 38084,-552 38084,-469 38249,-469 38249,-552"/>
<text text-anchor="middle" x="38166.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU13</text>
<text text-anchor="middle" x="38166.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="38166.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="38166.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="38166.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_8 -->
<g id="edge878" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38046.99,-587.91C38062.32,-578.11 38078.81,-567.56 38094.5,-557.53"/>
<polygon fill="black" stroke="black" points="38096.58,-560.36 38103.12,-552.02 38092.81,-554.46 38096.58,-560.36"/>
</g>
<!-- layer2_expert13_9 -->
<g id="node505" class="node">
<title>layer2_expert13_9</title>
<polygon fill="lightgreen" stroke="black" points="38432,-552 38267,-552 38267,-469 38432,-469 38432,-552"/>
<text text-anchor="middle" x="38349.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU13</text>
<text text-anchor="middle" x="38349.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="38349.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="38349.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="38349.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_9 -->
<g id="edge879" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38105.72,-598.37C38153.54,-585.55 38208.55,-569.51 38257.5,-552 38257.6,-551.97 38257.7,-551.93 38257.79,-551.9"/>
<polygon fill="black" stroke="black" points="38258.81,-555.25 38266.97,-548.49 38256.38,-548.69 38258.81,-555.25"/>
</g>
<!-- layer2_expert13_10 -->
<g id="node506" class="node">
<title>layer2_expert13_10</title>
<polygon fill="lightgreen" stroke="black" points="38615,-552 38450,-552 38450,-469 38615,-469 38615,-552"/>
<text text-anchor="middle" x="38532.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU13</text>
<text text-anchor="middle" x="38532.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="38532.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="38532.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="38532.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_10 -->
<g id="edge880" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38105.64,-616.42C38196.24,-605.52 38322.39,-586.25 38439.96,-551.94"/>
<polygon fill="black" stroke="black" points="38441.26,-555.2 38449.86,-549.01 38439.28,-548.49 38441.26,-555.2"/>
</g>
<!-- layer2_expert13_11 -->
<g id="node507" class="node">
<title>layer2_expert13_11</title>
<polygon fill="lightgreen" stroke="black" points="38798,-552 38633,-552 38633,-469 38798,-469 38798,-552"/>
<text text-anchor="middle" x="38715.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU13</text>
<text text-anchor="middle" x="38715.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="38715.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="38715.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="38715.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_11 -->
<g id="edge881" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38105.56,-624.6C38233.59,-618.1 38440.01,-600.76 38623.11,-551.85"/>
<polygon fill="black" stroke="black" points="38624.18,-555.19 38632.91,-549.2 38622.35,-548.43 38624.18,-555.19"/>
</g>
<!-- layer2_expert13_12 -->
<g id="node508" class="node">
<title>layer2_expert13_12</title>
<polygon fill="lightgreen" stroke="black" points="38981,-552 38816,-552 38816,-469 38981,-469 38981,-552"/>
<text text-anchor="middle" x="38898.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU13</text>
<text text-anchor="middle" x="38898.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="38898.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="38898.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="38898.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_12 -->
<g id="edge882" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38105.87,-621.96C38297.31,-610.93 38659.9,-586.64 38805.82,-551.83"/>
<polygon fill="black" stroke="black" points="38807.09,-555.12 38815.94,-549.3 38805.39,-548.33 38807.09,-555.12"/>
</g>
<!-- layer2_expert13_13 -->
<g id="node509" class="node">
<title>layer2_expert13_13</title>
<polygon fill="lightgreen" stroke="black" points="39164,-552 38999,-552 38999,-469 39164,-469 39164,-552"/>
<text text-anchor="middle" x="39081.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU13</text>
<text text-anchor="middle" x="39081.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="39081.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="39081.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="39081.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_13 -->
<g id="edge883" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38105.6,-624.37C38331.48,-615.9 38807.24,-593.94 38988.97,-551.78"/>
<polygon fill="black" stroke="black" points="38990.06,-555.12 38998.96,-549.37 38988.42,-548.32 38990.06,-555.12"/>
</g>
<!-- layer2_expert13_14 -->
<g id="node510" class="node">
<title>layer2_expert13_14</title>
<polygon fill="lightgreen" stroke="black" points="39347,-552 39182,-552 39182,-469 39347,-469 39347,-552"/>
<text text-anchor="middle" x="39264.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU13</text>
<text text-anchor="middle" x="39264.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="39264.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="39264.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="39264.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_14 -->
<g id="edge884" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38105.83,-626.04C38363.32,-619.99 38954.68,-601.3 39172.21,-551.73"/>
<polygon fill="black" stroke="black" points="39173.04,-555.13 39181.97,-549.42 39171.43,-548.31 39173.04,-555.13"/>
</g>
<!-- layer2_expert13_15 -->
<g id="node511" class="node">
<title>layer2_expert13_15</title>
<polygon fill="lightgreen" stroke="black" points="39530,-552 39365,-552 39365,-469 39530,-469 39530,-552"/>
<text text-anchor="middle" x="39447.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU13</text>
<text text-anchor="middle" x="39447.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="39447.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="39447.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="39447.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_gate_gpu13&#45;&gt;layer2_expert13_15 -->
<g id="edge885" class="edge">
<title>layer2_gate_gpu13&#45;&gt;layer2_expert13_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38105.56,-627.27C38391.91,-623.51 39101.07,-608.8 39355.05,-551.76"/>
<polygon fill="black" stroke="black" points="39356.03,-555.13 39364.98,-549.45 39354.45,-548.31 39356.03,-555.13"/>
</g>
<!-- layer2_moe_agg_gpu13 -->
<g id="node512" class="node">
<title>layer2_moe_agg_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="37997.5,-433 37785.5,-433 37785.5,-350 37997.5,-350 37997.5,-433"/>
<text text-anchor="middle" x="37891.5" y="-417.8" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU13</text>
<text text-anchor="middle" x="37891.5" y="-402.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="37891.5" y="-387.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="37891.5" y="-372.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="37891.5" y="-357.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_expert13_0&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge886" class="edge">
<title>layer2_expert13_0&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M36785.14,-471.29C36787.94,-470.46 36790.73,-469.69 36793.5,-469 36976.75,-423.35 37531.6,-402.59 37774.97,-395.5"/>
<polygon fill="black" stroke="black" points="37775.37,-398.99 37785.27,-395.2 37775.17,-391.99 37775.37,-398.99"/>
</g>
<!-- layer2_expert13_1&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge887" class="edge">
<title>layer2_expert13_1&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M36968.16,-471.34C36970.95,-470.49 36973.74,-469.71 36976.5,-469 37124.43,-431.06 37563.52,-407.06 37775.04,-397.38"/>
<polygon fill="black" stroke="black" points="37775.42,-400.87 37785.25,-396.92 37775.1,-393.88 37775.42,-400.87"/>
</g>
<!-- layer2_expert13_2&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge888" class="edge">
<title>layer2_expert13_2&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M37151.18,-471.42C37153.96,-470.55 37156.74,-469.74 37159.5,-469 37371.65,-412.24 37628.89,-397.21 37775.04,-393.46"/>
<polygon fill="black" stroke="black" points="37775.46,-396.96 37785.37,-393.21 37775.29,-389.96 37775.46,-396.96"/>
</g>
<!-- layer2_expert13_3&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge889" class="edge">
<title>layer2_expert13_3&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M37334.21,-471.54C37336.99,-470.64 37339.76,-469.78 37342.5,-469 37488.44,-427.26 37662.97,-407.91 37775.45,-399.21"/>
<polygon fill="black" stroke="black" points="37775.75,-402.7 37785.46,-398.45 37775.22,-395.72 37775.75,-402.7"/>
</g>
<!-- layer2_expert13_4&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge890" class="edge">
<title>layer2_expert13_4&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M37517.03,-471.87C37519.88,-470.87 37522.7,-469.9 37525.5,-469 37607.36,-442.56 37702.54,-423 37775.32,-410.27"/>
<polygon fill="black" stroke="black" points="37776.18,-413.68 37785.44,-408.52 37774.99,-406.78 37776.18,-413.68"/>
</g>
<!-- layer2_expert13_5&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge891" class="edge">
<title>layer2_expert13_5&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M37700.29,-472.56C37703.06,-471.35 37705.8,-470.16 37708.5,-469 37732.75,-458.54 37758.9,-447.48 37783.63,-437.11"/>
<polygon fill="black" stroke="black" points="37785.15,-440.27 37793.03,-433.18 37782.45,-433.81 37785.15,-440.27"/>
</g>
<!-- layer2_expert13_6&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge892" class="edge">
<title>layer2_expert13_6&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M37832.07,-468.91C37839.06,-459.92 37846.53,-450.32 37853.74,-441.05"/>
<polygon fill="black" stroke="black" points="37856.61,-443.06 37859.98,-433.02 37851.08,-438.77 37856.61,-443.06"/>
</g>
<!-- layer2_expert13_7&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge893" class="edge">
<title>layer2_expert13_7&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M37951.58,-468.91C37944.52,-459.92 37936.96,-450.32 37929.68,-441.05"/>
<polygon fill="black" stroke="black" points="37932.3,-438.72 37923.36,-433.02 37926.79,-443.05 37932.3,-438.72"/>
</g>
<!-- layer2_expert13_8&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge894" class="edge">
<title>layer2_expert13_8&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M38083.78,-473C38080.65,-471.64 38077.55,-470.31 38074.5,-469 38050.09,-458.53 38023.77,-447.42 37998.91,-437.01"/>
<polygon fill="black" stroke="black" points="38000.04,-433.69 37989.46,-433.05 37997.34,-440.14 38000.04,-433.69"/>
</g>
<!-- layer2_expert13_9&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge895" class="edge">
<title>layer2_expert13_9&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M38266.81,-472.15C38263.68,-471.04 38260.57,-469.99 38257.5,-469 38175.59,-442.73 38080.41,-423.16 38007.64,-410.39"/>
<polygon fill="black" stroke="black" points="38007.98,-406.89 37997.53,-408.63 38006.78,-413.79 38007.98,-406.89"/>
</g>
<!-- layer2_expert13_10&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge896" class="edge">
<title>layer2_expert13_10&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M38449.89,-471.88C38446.74,-470.85 38443.61,-469.88 38440.5,-469 38294.47,-427.55 38119.96,-408.14 38007.51,-399.34"/>
<polygon fill="black" stroke="black" points="38007.74,-395.85 37997.51,-398.57 38007.21,-402.83 38007.74,-395.85"/>
</g>
<!-- layer2_expert13_11&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge897" class="edge">
<title>layer2_expert13_11&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M38632.93,-471.74C38629.77,-470.75 38626.62,-469.83 38623.5,-469 38411.23,-412.67 38154.04,-397.49 38007.92,-393.6"/>
<polygon fill="black" stroke="black" points="38007.68,-390.1 37997.6,-393.34 38007.5,-397.09 38007.68,-390.1"/>
</g>
<!-- layer2_expert13_12&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge898" class="edge">
<title>layer2_expert13_12&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M38815.95,-471.66C38812.79,-470.69 38809.63,-469.8 38806.5,-469 38658.49,-431.36 38219.44,-407.21 38007.94,-397.44"/>
<polygon fill="black" stroke="black" points="38007.89,-393.93 37997.74,-396.97 38007.57,-400.93 38007.89,-393.93"/>
</g>
<!-- layer2_expert13_13&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge899" class="edge">
<title>layer2_expert13_13&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M38998.96,-471.6C38995.8,-470.65 38992.63,-469.77 38989.5,-469 38806.16,-423.72 38251.35,-402.76 38008.01,-395.55"/>
<polygon fill="black" stroke="black" points="38007.82,-392.05 37997.72,-395.25 38007.61,-399.04 38007.82,-392.05"/>
</g>
<!-- layer2_expert13_14&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge900" class="edge">
<title>layer2_expert13_14&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M39181.97,-471.56C39178.8,-470.62 39175.64,-469.76 39172.5,-469 38953.48,-416.06 38280.83,-399.02 38008.14,-394.2"/>
<polygon fill="black" stroke="black" points="38007.88,-390.69 37997.82,-394.02 38007.76,-397.69 38007.88,-390.69"/>
</g>
<!-- layer2_expert13_15&#45;&gt;layer2_moe_agg_gpu13 -->
<g id="edge901" class="edge">
<title>layer2_expert13_15&#45;&gt;layer2_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M39364.98,-471.53C39361.81,-470.6 39358.64,-469.75 39355.5,-469 39100.34,-408.33 38307.16,-395.76 38007.62,-393.17"/>
<polygon fill="black" stroke="black" points="38007.63,-389.67 37997.6,-393.09 38007.57,-396.67 38007.63,-389.67"/>
</g>
<!-- layer2_output_gpu13 -->
<g id="node513" class="node">
<title>layer2_output_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="36760,-142 36507,-142 36507,-74 36760,-74 36760,-142"/>
<text text-anchor="middle" x="36633.5" y="-126.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU13</text>
<text text-anchor="middle" x="36633.5" y="-111.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="36633.5" y="-96.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="36633.5" y="-81.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_moe_agg_gpu13&#45;&gt;layer2_output_gpu13 -->
<g id="edge902" class="edge">
<title>layer2_moe_agg_gpu13&#45;&gt;layer2_output_gpu13</title>
<path fill="none" stroke="black" d="M37785.33,-366.74C37557.65,-315.79 37022.68,-196.09 36770.1,-139.57"/>
<polygon fill="black" stroke="black" points="36770.66,-136.1 36760.13,-137.34 36769.13,-142.94 36770.66,-136.1"/>
</g>
<!-- layer2_moe_agg_gpu13&#45;&gt;layer2_allreduce_moe -->
<g id="edge999" class="edge">
<title>layer2_moe_agg_gpu13&#45;&gt;layer2_allreduce_moe</title>
<path fill="none" stroke="black" d="M37785.47,-386.96C37217.09,-367.99 34528.95,-278.28 33783.56,-253.41"/>
<polygon fill="black" stroke="black" points="33783.65,-249.91 33773.53,-253.07 33783.41,-256.91 33783.65,-249.91"/>
</g>
<!-- layer2_qkv_gpu14 -->
<g id="node514" class="node">
<title>layer2_qkv_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="34435.5,-1304 34225.5,-1304 34225.5,-1206 34435.5,-1206 34435.5,-1304"/>
<text text-anchor="middle" x="34330.5" y="-1288.8" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU14</text>
<text text-anchor="middle" x="34330.5" y="-1273.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="34330.5" y="-1258.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="34330.5" y="-1243.8" font-family="Times,serif" font-size="14.00">Heads: 24&#45;27</text>
<text text-anchor="middle" x="34330.5" y="-1228.8" font-family="Times,serif" font-size="14.00">TP Slice: 6</text>
<text text-anchor="middle" x="34330.5" y="-1213.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_attn_gpu14 -->
<g id="node515" class="node">
<title>layer2_attn_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="34483.5,-1170 34231.5,-1170 34231.5,-1087 34483.5,-1087 34483.5,-1170"/>
<text text-anchor="middle" x="34357.5" y="-1154.8" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU14</text>
<text text-anchor="middle" x="34357.5" y="-1139.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="34357.5" y="-1124.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34357.5" y="-1109.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="34357.5" y="-1094.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_qkv_gpu14&#45;&gt;layer2_attn_gpu14 -->
<g id="edge903" class="edge">
<title>layer2_qkv_gpu14&#45;&gt;layer2_attn_gpu14</title>
<path fill="none" stroke="black" d="M34340.94,-1205.87C34342.77,-1197.41 34344.69,-1188.58 34346.54,-1180.06"/>
<polygon fill="black" stroke="black" points="34349.97,-1180.75 34348.67,-1170.23 34343.13,-1179.26 34349.97,-1180.75"/>
</g>
<!-- layer2_attn_proj_gpu14 -->
<g id="node516" class="node">
<title>layer2_attn_proj_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="34462,-1051 34253,-1051 34253,-983 34462,-983 34462,-1051"/>
<text text-anchor="middle" x="34357.5" y="-1035.8" font-family="Times,serif" font-size="14.00">L2_Attn_Projection_GPU14</text>
<text text-anchor="middle" x="34357.5" y="-1020.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="34357.5" y="-1005.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34357.5" y="-990.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_attn_gpu14&#45;&gt;layer2_attn_proj_gpu14 -->
<g id="edge904" class="edge">
<title>layer2_attn_gpu14&#45;&gt;layer2_attn_proj_gpu14</title>
<path fill="none" stroke="black" d="M34357.5,-1086.73C34357.5,-1078.52 34357.5,-1069.86 34357.5,-1061.56"/>
<polygon fill="black" stroke="black" points="34361,-1061.3 34357.5,-1051.3 34354,-1061.3 34361,-1061.3"/>
</g>
<!-- layer2_attn_norm_gpu14 -->
<g id="node517" class="node">
<title>layer2_attn_norm_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="34487,-775 34234,-775 34234,-707 34487,-707 34487,-775"/>
<text text-anchor="middle" x="34360.5" y="-759.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU14</text>
<text text-anchor="middle" x="34360.5" y="-744.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="34360.5" y="-729.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34360.5" y="-714.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_attn_proj_gpu14&#45;&gt;layer2_attn_norm_gpu14 -->
<g id="edge905" class="edge">
<title>layer2_attn_proj_gpu14&#45;&gt;layer2_attn_norm_gpu14</title>
<path fill="none" stroke="black" d="M34357.86,-982.95C34358.4,-933.47 34359.43,-840.12 34360.03,-785.27"/>
<polygon fill="black" stroke="black" points="34363.53,-785.21 34360.14,-775.17 34356.53,-785.13 34363.53,-785.21"/>
</g>
<!-- layer2_attn_proj_gpu14&#45;&gt;layer2_allreduce_attn -->
<g id="edge1001" class="edge">
<title>layer2_attn_proj_gpu14&#45;&gt;layer2_allreduce_attn</title>
<path fill="none" stroke="black" d="M34252.81,-993.83C34235.35,-990.18 34217.42,-986.46 34200.5,-983 34071.16,-956.55 33923.45,-927.27 33818.95,-906.71"/>
<polygon fill="black" stroke="black" points="33819.46,-903.25 33808.98,-904.75 33818.11,-910.11 33819.46,-903.25"/>
</g>
<!-- layer2_gate_gpu14 -->
<g id="node518" class="node">
<title>layer2_gate_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="41033.5,-671 40789.5,-671 40789.5,-588 41033.5,-588 41033.5,-671"/>
<text text-anchor="middle" x="40911.5" y="-655.8" font-family="Times,serif" font-size="14.00">L2_Gate_GPU14</text>
<text text-anchor="middle" x="40911.5" y="-640.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="40911.5" y="-625.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="40911.5" y="-610.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="40911.5" y="-595.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_attn_norm_gpu14&#45;&gt;layer2_gate_gpu14 -->
<g id="edge906" class="edge">
<title>layer2_attn_norm_gpu14&#45;&gt;layer2_gate_gpu14</title>
<path fill="none" stroke="black" d="M34487.17,-708.14C34489.97,-707.73 34492.75,-707.35 34495.5,-707 34894.5,-656.93 37712.4,-675.91 38114.5,-671 39140.3,-658.47 40377.66,-639.04 40778.97,-632.63"/>
<polygon fill="black" stroke="black" points="40779.22,-636.13 40789.16,-632.47 40779.11,-629.13 40779.22,-636.13"/>
</g>
<!-- layer2_expert14_0 -->
<g id="node519" class="node">
<title>layer2_expert14_0</title>
<polygon fill="lightgreen" stroke="black" points="39713,-552 39548,-552 39548,-469 39713,-469 39713,-552"/>
<text text-anchor="middle" x="39630.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU14</text>
<text text-anchor="middle" x="39630.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="39630.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="39630.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="39630.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_0 -->
<g id="edge907" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40789.05,-626.1C40531.44,-620.18 39940,-601.75 39723.18,-552.11"/>
<polygon fill="black" stroke="black" points="39723.68,-548.63 39713.14,-549.73 39722.06,-555.44 39723.68,-548.63"/>
</g>
<!-- layer2_expert14_1 -->
<g id="node520" class="node">
<title>layer2_expert14_1</title>
<polygon fill="lightgreen" stroke="black" points="39896,-552 39731,-552 39731,-469 39896,-469 39896,-552"/>
<text text-anchor="middle" x="39813.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU14</text>
<text text-anchor="middle" x="39813.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="39813.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="39813.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="39813.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_1 -->
<g id="edge908" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40789.26,-624.44C40563.14,-616.08 40086.86,-594.29 39906.08,-552.1"/>
<polygon fill="black" stroke="black" points="39906.69,-548.65 39896.15,-549.68 39905.04,-555.45 39906.69,-548.65"/>
</g>
<!-- layer2_expert14_2 -->
<g id="node521" class="node">
<title>layer2_expert14_2</title>
<polygon fill="lightgreen" stroke="black" points="40079,-552 39914,-552 39914,-469 40079,-469 40079,-552"/>
<text text-anchor="middle" x="39996.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU14</text>
<text text-anchor="middle" x="39996.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="39996.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="39996.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="39996.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_2 -->
<g id="edge909" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40789.36,-622.05C40597.78,-611.12 40234.32,-586.96 40089.23,-552.15"/>
<polygon fill="black" stroke="black" points="40089.72,-548.66 40079.17,-549.62 40088.01,-555.45 40089.72,-548.66"/>
</g>
<!-- layer2_expert14_3 -->
<g id="node522" class="node">
<title>layer2_expert14_3</title>
<polygon fill="lightgreen" stroke="black" points="40262,-552 40097,-552 40097,-469 40262,-469 40262,-552"/>
<text text-anchor="middle" x="40179.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU14</text>
<text text-anchor="middle" x="40179.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="40179.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="40179.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="40179.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_3 -->
<g id="edge910" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40789.21,-624.77C40660.95,-618.4 40454.18,-601.17 40271.95,-552.19"/>
<polygon fill="black" stroke="black" points="40272.76,-548.78 40262.19,-549.53 40270.92,-555.53 40272.76,-548.78"/>
</g>
<!-- layer2_expert14_4 -->
<g id="node523" class="node">
<title>layer2_expert14_4</title>
<polygon fill="lightgreen" stroke="black" points="40445,-552 40280,-552 40280,-469 40445,-469 40445,-552"/>
<text text-anchor="middle" x="40362.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU14</text>
<text text-anchor="middle" x="40362.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="40362.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="40362.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="40362.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_4 -->
<g id="edge911" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40789.05,-616.58C40698.24,-605.76 40571.81,-586.52 40455.06,-552.28"/>
<polygon fill="black" stroke="black" points="40455.82,-548.86 40445.24,-549.36 40453.83,-555.57 40455.82,-548.86"/>
</g>
<!-- layer2_expert14_5 -->
<g id="node524" class="node">
<title>layer2_expert14_5</title>
<polygon fill="lightgreen" stroke="black" points="40628,-552 40463,-552 40463,-469 40628,-469 40628,-552"/>
<text text-anchor="middle" x="40545.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU14</text>
<text text-anchor="middle" x="40545.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="40545.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="40545.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="40545.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_5 -->
<g id="edge912" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40789.47,-598.69C40743.95,-586.56 40691.87,-571.48 40637.56,-552.26"/>
<polygon fill="black" stroke="black" points="40638.71,-548.96 40628.12,-548.89 40636.35,-555.55 40638.71,-548.96"/>
</g>
<!-- layer2_expert14_6 -->
<g id="node525" class="node">
<title>layer2_expert14_6</title>
<polygon fill="lightgreen" stroke="black" points="40811,-552 40646,-552 40646,-469 40811,-469 40811,-552"/>
<text text-anchor="middle" x="40728.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU14</text>
<text text-anchor="middle" x="40728.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="40728.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="40728.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="40728.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_6 -->
<g id="edge913" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40848.01,-587.91C40832.68,-578.11 40816.19,-567.56 40800.5,-557.53"/>
<polygon fill="black" stroke="black" points="40802.19,-554.46 40791.88,-552.02 40798.42,-560.36 40802.19,-554.46"/>
</g>
<!-- layer2_expert14_7 -->
<g id="node526" class="node">
<title>layer2_expert14_7</title>
<polygon fill="lightgreen" stroke="black" points="40994,-552 40829,-552 40829,-469 40994,-469 40994,-552"/>
<text text-anchor="middle" x="40911.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU14</text>
<text text-anchor="middle" x="40911.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="40911.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="40911.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="40911.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_7 -->
<g id="edge914" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40911.5,-587.91C40911.5,-579.65 40911.5,-570.86 40911.5,-562.3"/>
<polygon fill="black" stroke="black" points="40915,-562.02 40911.5,-552.02 40908,-562.02 40915,-562.02"/>
</g>
<!-- layer2_expert14_8 -->
<g id="node527" class="node">
<title>layer2_expert14_8</title>
<polygon fill="lightgreen" stroke="black" points="41177,-552 41012,-552 41012,-469 41177,-469 41177,-552"/>
<text text-anchor="middle" x="41094.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU14</text>
<text text-anchor="middle" x="41094.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="41094.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="41094.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="41094.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_8 -->
<g id="edge915" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40974.99,-587.91C40990.32,-578.11 41006.81,-567.56 41022.5,-557.53"/>
<polygon fill="black" stroke="black" points="41024.58,-560.36 41031.12,-552.02 41020.81,-554.46 41024.58,-560.36"/>
</g>
<!-- layer2_expert14_9 -->
<g id="node528" class="node">
<title>layer2_expert14_9</title>
<polygon fill="lightgreen" stroke="black" points="41360,-552 41195,-552 41195,-469 41360,-469 41360,-552"/>
<text text-anchor="middle" x="41277.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU14</text>
<text text-anchor="middle" x="41277.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="41277.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="41277.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="41277.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_9 -->
<g id="edge916" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M41033.72,-598.37C41081.54,-585.55 41136.55,-569.51 41185.5,-552 41185.6,-551.97 41185.7,-551.93 41185.79,-551.9"/>
<polygon fill="black" stroke="black" points="41186.81,-555.25 41194.97,-548.49 41184.38,-548.69 41186.81,-555.25"/>
</g>
<!-- layer2_expert14_10 -->
<g id="node529" class="node">
<title>layer2_expert14_10</title>
<polygon fill="lightgreen" stroke="black" points="41543,-552 41378,-552 41378,-469 41543,-469 41543,-552"/>
<text text-anchor="middle" x="41460.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU14</text>
<text text-anchor="middle" x="41460.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="41460.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="41460.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="41460.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_10 -->
<g id="edge917" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M41033.64,-616.42C41124.24,-605.52 41250.39,-586.25 41367.96,-551.94"/>
<polygon fill="black" stroke="black" points="41369.26,-555.2 41377.86,-549.01 41367.28,-548.49 41369.26,-555.2"/>
</g>
<!-- layer2_expert14_11 -->
<g id="node530" class="node">
<title>layer2_expert14_11</title>
<polygon fill="lightgreen" stroke="black" points="41726,-552 41561,-552 41561,-469 41726,-469 41726,-552"/>
<text text-anchor="middle" x="41643.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU14</text>
<text text-anchor="middle" x="41643.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="41643.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="41643.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="41643.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_11 -->
<g id="edge918" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M41033.56,-624.6C41161.59,-618.1 41368.01,-600.76 41551.11,-551.85"/>
<polygon fill="black" stroke="black" points="41552.18,-555.19 41560.91,-549.2 41550.35,-548.43 41552.18,-555.19"/>
</g>
<!-- layer2_expert14_12 -->
<g id="node531" class="node">
<title>layer2_expert14_12</title>
<polygon fill="lightgreen" stroke="black" points="41909,-552 41744,-552 41744,-469 41909,-469 41909,-552"/>
<text text-anchor="middle" x="41826.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU14</text>
<text text-anchor="middle" x="41826.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="41826.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="41826.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="41826.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_12 -->
<g id="edge919" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M41033.87,-621.96C41225.31,-610.93 41587.9,-586.64 41733.82,-551.83"/>
<polygon fill="black" stroke="black" points="41735.09,-555.12 41743.94,-549.3 41733.39,-548.33 41735.09,-555.12"/>
</g>
<!-- layer2_expert14_13 -->
<g id="node532" class="node">
<title>layer2_expert14_13</title>
<polygon fill="lightgreen" stroke="black" points="42092,-552 41927,-552 41927,-469 42092,-469 42092,-552"/>
<text text-anchor="middle" x="42009.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU14</text>
<text text-anchor="middle" x="42009.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="42009.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="42009.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="42009.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_13 -->
<g id="edge920" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M41033.6,-624.37C41259.48,-615.9 41735.24,-593.94 41916.97,-551.78"/>
<polygon fill="black" stroke="black" points="41918.06,-555.12 41926.96,-549.37 41916.42,-548.32 41918.06,-555.12"/>
</g>
<!-- layer2_expert14_14 -->
<g id="node533" class="node">
<title>layer2_expert14_14</title>
<polygon fill="lightgreen" stroke="black" points="42275,-552 42110,-552 42110,-469 42275,-469 42275,-552"/>
<text text-anchor="middle" x="42192.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU14</text>
<text text-anchor="middle" x="42192.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="42192.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="42192.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="42192.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_14 -->
<g id="edge921" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M41033.83,-626.04C41291.32,-619.99 41882.68,-601.3 42100.21,-551.73"/>
<polygon fill="black" stroke="black" points="42101.04,-555.13 42109.97,-549.42 42099.43,-548.31 42101.04,-555.13"/>
</g>
<!-- layer2_expert14_15 -->
<g id="node534" class="node">
<title>layer2_expert14_15</title>
<polygon fill="lightgreen" stroke="black" points="42458,-552 42293,-552 42293,-469 42458,-469 42458,-552"/>
<text text-anchor="middle" x="42375.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU14</text>
<text text-anchor="middle" x="42375.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="42375.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="42375.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="42375.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_gate_gpu14&#45;&gt;layer2_expert14_15 -->
<g id="edge922" class="edge">
<title>layer2_gate_gpu14&#45;&gt;layer2_expert14_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M41033.56,-627.27C41319.91,-623.51 42029.07,-608.8 42283.05,-551.76"/>
<polygon fill="black" stroke="black" points="42284.03,-555.13 42292.98,-549.45 42282.45,-548.31 42284.03,-555.13"/>
</g>
<!-- layer2_moe_agg_gpu14 -->
<g id="node535" class="node">
<title>layer2_moe_agg_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="40925.5,-433 40713.5,-433 40713.5,-350 40925.5,-350 40925.5,-433"/>
<text text-anchor="middle" x="40819.5" y="-417.8" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU14</text>
<text text-anchor="middle" x="40819.5" y="-402.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="40819.5" y="-387.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="40819.5" y="-372.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="40819.5" y="-357.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_expert14_0&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge923" class="edge">
<title>layer2_expert14_0&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M39713.14,-471.29C39715.94,-470.46 39718.73,-469.69 39721.5,-469 39904.75,-423.35 40459.6,-402.59 40702.97,-395.5"/>
<polygon fill="black" stroke="black" points="40703.37,-398.99 40713.27,-395.2 40703.17,-391.99 40703.37,-398.99"/>
</g>
<!-- layer2_expert14_1&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge924" class="edge">
<title>layer2_expert14_1&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M39896.16,-471.34C39898.95,-470.49 39901.74,-469.71 39904.5,-469 40052.43,-431.06 40491.52,-407.06 40703.04,-397.38"/>
<polygon fill="black" stroke="black" points="40703.42,-400.87 40713.25,-396.92 40703.1,-393.88 40703.42,-400.87"/>
</g>
<!-- layer2_expert14_2&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge925" class="edge">
<title>layer2_expert14_2&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M40079.18,-471.42C40081.96,-470.55 40084.74,-469.74 40087.5,-469 40299.65,-412.24 40556.89,-397.21 40703.04,-393.46"/>
<polygon fill="black" stroke="black" points="40703.46,-396.96 40713.37,-393.21 40703.29,-389.96 40703.46,-396.96"/>
</g>
<!-- layer2_expert14_3&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge926" class="edge">
<title>layer2_expert14_3&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M40262.21,-471.54C40264.99,-470.64 40267.76,-469.78 40270.5,-469 40416.44,-427.26 40590.97,-407.91 40703.45,-399.21"/>
<polygon fill="black" stroke="black" points="40703.75,-402.7 40713.46,-398.45 40703.22,-395.72 40703.75,-402.7"/>
</g>
<!-- layer2_expert14_4&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge927" class="edge">
<title>layer2_expert14_4&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M40445.03,-471.87C40447.88,-470.87 40450.7,-469.9 40453.5,-469 40535.36,-442.56 40630.54,-423 40703.32,-410.27"/>
<polygon fill="black" stroke="black" points="40704.18,-413.68 40713.44,-408.52 40702.99,-406.78 40704.18,-413.68"/>
</g>
<!-- layer2_expert14_5&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge928" class="edge">
<title>layer2_expert14_5&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M40628.29,-472.56C40631.06,-471.35 40633.8,-470.16 40636.5,-469 40660.75,-458.54 40686.9,-447.48 40711.63,-437.11"/>
<polygon fill="black" stroke="black" points="40713.15,-440.27 40721.03,-433.18 40710.45,-433.81 40713.15,-440.27"/>
</g>
<!-- layer2_expert14_6&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge929" class="edge">
<title>layer2_expert14_6&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M40760.07,-468.91C40767.06,-459.92 40774.53,-450.32 40781.74,-441.05"/>
<polygon fill="black" stroke="black" points="40784.61,-443.06 40787.98,-433.02 40779.08,-438.77 40784.61,-443.06"/>
</g>
<!-- layer2_expert14_7&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge930" class="edge">
<title>layer2_expert14_7&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M40879.58,-468.91C40872.52,-459.92 40864.96,-450.32 40857.68,-441.05"/>
<polygon fill="black" stroke="black" points="40860.3,-438.72 40851.36,-433.02 40854.79,-443.05 40860.3,-438.72"/>
</g>
<!-- layer2_expert14_8&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge931" class="edge">
<title>layer2_expert14_8&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M41011.78,-473C41008.65,-471.64 41005.55,-470.31 41002.5,-469 40978.09,-458.53 40951.77,-447.42 40926.91,-437.01"/>
<polygon fill="black" stroke="black" points="40928.04,-433.69 40917.46,-433.05 40925.34,-440.14 40928.04,-433.69"/>
</g>
<!-- layer2_expert14_9&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge932" class="edge">
<title>layer2_expert14_9&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M41194.81,-472.15C41191.68,-471.04 41188.57,-469.99 41185.5,-469 41103.59,-442.73 41008.41,-423.16 40935.64,-410.39"/>
<polygon fill="black" stroke="black" points="40935.98,-406.89 40925.53,-408.63 40934.78,-413.79 40935.98,-406.89"/>
</g>
<!-- layer2_expert14_10&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge933" class="edge">
<title>layer2_expert14_10&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M41377.89,-471.88C41374.74,-470.85 41371.61,-469.88 41368.5,-469 41222.47,-427.55 41047.96,-408.14 40935.51,-399.34"/>
<polygon fill="black" stroke="black" points="40935.74,-395.85 40925.51,-398.57 40935.21,-402.83 40935.74,-395.85"/>
</g>
<!-- layer2_expert14_11&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge934" class="edge">
<title>layer2_expert14_11&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M41560.93,-471.74C41557.77,-470.75 41554.62,-469.83 41551.5,-469 41339.23,-412.67 41082.04,-397.49 40935.92,-393.6"/>
<polygon fill="black" stroke="black" points="40935.68,-390.1 40925.6,-393.34 40935.5,-397.09 40935.68,-390.1"/>
</g>
<!-- layer2_expert14_12&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge935" class="edge">
<title>layer2_expert14_12&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M41743.95,-471.66C41740.79,-470.69 41737.63,-469.8 41734.5,-469 41586.49,-431.36 41147.44,-407.21 40935.94,-397.44"/>
<polygon fill="black" stroke="black" points="40935.89,-393.93 40925.74,-396.97 40935.57,-400.93 40935.89,-393.93"/>
</g>
<!-- layer2_expert14_13&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge936" class="edge">
<title>layer2_expert14_13&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M41926.96,-471.6C41923.8,-470.65 41920.63,-469.77 41917.5,-469 41734.16,-423.72 41179.35,-402.76 40936.01,-395.55"/>
<polygon fill="black" stroke="black" points="40935.82,-392.05 40925.72,-395.25 40935.61,-399.04 40935.82,-392.05"/>
</g>
<!-- layer2_expert14_14&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge937" class="edge">
<title>layer2_expert14_14&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M42109.97,-471.56C42106.8,-470.62 42103.64,-469.76 42100.5,-469 41881.48,-416.06 41208.83,-399.02 40936.14,-394.2"/>
<polygon fill="black" stroke="black" points="40935.88,-390.69 40925.82,-394.02 40935.76,-397.69 40935.88,-390.69"/>
</g>
<!-- layer2_expert14_15&#45;&gt;layer2_moe_agg_gpu14 -->
<g id="edge938" class="edge">
<title>layer2_expert14_15&#45;&gt;layer2_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M42292.98,-471.53C42289.81,-470.6 42286.64,-469.75 42283.5,-469 42028.34,-408.33 41235.16,-395.76 40935.62,-393.17"/>
<polygon fill="black" stroke="black" points="40935.63,-389.67 40925.6,-393.09 40935.57,-396.67 40935.63,-389.67"/>
</g>
<!-- layer2_output_gpu14 -->
<g id="node536" class="node">
<title>layer2_output_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="39165,-142 38912,-142 38912,-74 39165,-74 39165,-142"/>
<text text-anchor="middle" x="39038.5" y="-126.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU14</text>
<text text-anchor="middle" x="39038.5" y="-111.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="39038.5" y="-96.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="39038.5" y="-81.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_moe_agg_gpu14&#45;&gt;layer2_output_gpu14 -->
<g id="edge939" class="edge">
<title>layer2_moe_agg_gpu14&#45;&gt;layer2_output_gpu14</title>
<path fill="none" stroke="black" d="M40713.42,-373.73C40406.42,-325.21 39517.23,-184.67 39174.99,-130.57"/>
<polygon fill="black" stroke="black" points="39175.45,-127.1 39165.02,-129 39174.35,-134.02 39175.45,-127.1"/>
</g>
<!-- layer2_moe_agg_gpu14&#45;&gt;layer2_allreduce_moe -->
<g id="edge1003" class="edge">
<title>layer2_moe_agg_gpu14&#45;&gt;layer2_allreduce_moe</title>
<path fill="none" stroke="black" d="M40713.48,-388.4C39916.15,-372.57 34861.74,-272.22 33790.74,-250.96"/>
<polygon fill="black" stroke="black" points="33790.7,-247.45 33780.63,-250.75 33790.56,-254.45 33790.7,-247.45"/>
</g>
<!-- layer2_qkv_gpu15 -->
<g id="node537" class="node">
<title>layer2_qkv_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="34702.5,-1304 34492.5,-1304 34492.5,-1206 34702.5,-1206 34702.5,-1304"/>
<text text-anchor="middle" x="34597.5" y="-1288.8" font-family="Times,serif" font-size="14.00">L2_QKV_Projection_GPU15</text>
<text text-anchor="middle" x="34597.5" y="-1273.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="34597.5" y="-1258.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="34597.5" y="-1243.8" font-family="Times,serif" font-size="14.00">Heads: 28&#45;31</text>
<text text-anchor="middle" x="34597.5" y="-1228.8" font-family="Times,serif" font-size="14.00">TP Slice: 7</text>
<text text-anchor="middle" x="34597.5" y="-1213.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_attn_gpu15 -->
<g id="node538" class="node">
<title>layer2_attn_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="34753.5,-1170 34501.5,-1170 34501.5,-1087 34753.5,-1087 34753.5,-1170"/>
<text text-anchor="middle" x="34627.5" y="-1154.8" font-family="Times,serif" font-size="14.00">L2_Multi&#45;Head_Attention_GPU15</text>
<text text-anchor="middle" x="34627.5" y="-1139.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="34627.5" y="-1124.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34627.5" y="-1109.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="34627.5" y="-1094.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_qkv_gpu15&#45;&gt;layer2_attn_gpu15 -->
<g id="edge940" class="edge">
<title>layer2_qkv_gpu15&#45;&gt;layer2_attn_gpu15</title>
<path fill="none" stroke="black" d="M34609.1,-1205.87C34611.14,-1197.41 34613.26,-1188.58 34615.32,-1180.06"/>
<polygon fill="black" stroke="black" points="34618.75,-1180.77 34617.69,-1170.23 34611.94,-1179.13 34618.75,-1180.77"/>
</g>
<!-- layer2_attn_proj_gpu15 -->
<g id="node539" class="node">
<title>layer2_attn_proj_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="34732,-1051 34523,-1051 34523,-983 34732,-983 34732,-1051"/>
<text text-anchor="middle" x="34627.5" y="-1035.8" font-family="Times,serif" font-size="14.00">L2_Attn_Projection_GPU15</text>
<text text-anchor="middle" x="34627.5" y="-1020.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="34627.5" y="-1005.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34627.5" y="-990.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_attn_gpu15&#45;&gt;layer2_attn_proj_gpu15 -->
<g id="edge941" class="edge">
<title>layer2_attn_gpu15&#45;&gt;layer2_attn_proj_gpu15</title>
<path fill="none" stroke="black" d="M34627.5,-1086.73C34627.5,-1078.52 34627.5,-1069.86 34627.5,-1061.56"/>
<polygon fill="black" stroke="black" points="34631,-1061.3 34627.5,-1051.3 34624,-1061.3 34631,-1061.3"/>
</g>
<!-- layer2_attn_norm_gpu15 -->
<g id="node540" class="node">
<title>layer2_attn_norm_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="34758,-775 34505,-775 34505,-707 34758,-707 34758,-775"/>
<text text-anchor="middle" x="34631.5" y="-759.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU15</text>
<text text-anchor="middle" x="34631.5" y="-744.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="34631.5" y="-729.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="34631.5" y="-714.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_attn_proj_gpu15&#45;&gt;layer2_attn_norm_gpu15 -->
<g id="edge942" class="edge">
<title>layer2_attn_proj_gpu15&#45;&gt;layer2_attn_norm_gpu15</title>
<path fill="none" stroke="black" d="M34627.98,-982.95C34628.7,-933.47 34630.07,-840.12 34630.87,-785.27"/>
<polygon fill="black" stroke="black" points="34634.37,-785.22 34631.02,-775.17 34627.37,-785.12 34634.37,-785.22"/>
</g>
<!-- layer2_attn_proj_gpu15&#45;&gt;layer2_allreduce_attn -->
<g id="edge1005" class="edge">
<title>layer2_attn_proj_gpu15&#45;&gt;layer2_allreduce_attn</title>
<path fill="none" stroke="black" d="M34523,-992.86C34505.51,-989.33 34487.52,-985.9 34470.5,-983 34254.89,-946.31 34004.16,-915.56 33844.47,-897.47"/>
<polygon fill="black" stroke="black" points="33844.41,-893.94 33834.08,-896.3 33843.63,-900.9 33844.41,-893.94"/>
</g>
<!-- layer2_gate_gpu15 -->
<g id="node541" class="node">
<title>layer2_gate_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="43961.5,-671 43717.5,-671 43717.5,-588 43961.5,-588 43961.5,-671"/>
<text text-anchor="middle" x="43839.5" y="-655.8" font-family="Times,serif" font-size="14.00">L2_Gate_GPU15</text>
<text text-anchor="middle" x="43839.5" y="-640.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="43839.5" y="-625.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="43839.5" y="-610.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="43839.5" y="-595.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_attn_norm_gpu15&#45;&gt;layer2_gate_gpu15 -->
<g id="edge943" class="edge">
<title>layer2_attn_norm_gpu15&#45;&gt;layer2_gate_gpu15</title>
<path fill="none" stroke="black" d="M34758.03,-738.81C35415.71,-732.61 38510.43,-702.96 41042.5,-671 42068.3,-658.05 43305.66,-638.9 43706.97,-632.59"/>
<polygon fill="black" stroke="black" points="43707.22,-636.09 43717.16,-632.43 43707.11,-629.09 43707.22,-636.09"/>
</g>
<!-- layer2_expert15_0 -->
<g id="node542" class="node">
<title>layer2_expert15_0</title>
<polygon fill="lightgreen" stroke="black" points="42641,-552 42476,-552 42476,-469 42641,-469 42641,-552"/>
<text text-anchor="middle" x="42558.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert0_GPU15</text>
<text text-anchor="middle" x="42558.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="42558.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="42558.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="42558.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_0 -->
<g id="edge944" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43717.05,-626.1C43459.44,-620.18 42868,-601.75 42651.18,-552.11"/>
<polygon fill="black" stroke="black" points="42651.68,-548.63 42641.14,-549.73 42650.06,-555.44 42651.68,-548.63"/>
</g>
<!-- layer2_expert15_1 -->
<g id="node543" class="node">
<title>layer2_expert15_1</title>
<polygon fill="lightgreen" stroke="black" points="42824,-552 42659,-552 42659,-469 42824,-469 42824,-552"/>
<text text-anchor="middle" x="42741.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert1_GPU15</text>
<text text-anchor="middle" x="42741.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="42741.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="42741.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="42741.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_1 -->
<g id="edge945" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43717.26,-624.44C43491.14,-616.08 43014.86,-594.29 42834.08,-552.1"/>
<polygon fill="black" stroke="black" points="42834.69,-548.65 42824.15,-549.68 42833.04,-555.45 42834.69,-548.65"/>
</g>
<!-- layer2_expert15_2 -->
<g id="node544" class="node">
<title>layer2_expert15_2</title>
<polygon fill="lightgreen" stroke="black" points="43007,-552 42842,-552 42842,-469 43007,-469 43007,-552"/>
<text text-anchor="middle" x="42924.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert2_GPU15</text>
<text text-anchor="middle" x="42924.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="42924.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="42924.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="42924.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_2 -->
<g id="edge946" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43717.36,-622.05C43525.78,-611.12 43162.32,-586.96 43017.23,-552.15"/>
<polygon fill="black" stroke="black" points="43017.72,-548.66 43007.17,-549.62 43016.01,-555.45 43017.72,-548.66"/>
</g>
<!-- layer2_expert15_3 -->
<g id="node545" class="node">
<title>layer2_expert15_3</title>
<polygon fill="lightgreen" stroke="black" points="43190,-552 43025,-552 43025,-469 43190,-469 43190,-552"/>
<text text-anchor="middle" x="43107.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert3_GPU15</text>
<text text-anchor="middle" x="43107.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="43107.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="43107.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="43107.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_3 -->
<g id="edge947" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43717.21,-624.77C43588.95,-618.4 43382.18,-601.17 43199.95,-552.19"/>
<polygon fill="black" stroke="black" points="43200.76,-548.78 43190.19,-549.53 43198.92,-555.53 43200.76,-548.78"/>
</g>
<!-- layer2_expert15_4 -->
<g id="node546" class="node">
<title>layer2_expert15_4</title>
<polygon fill="lightgreen" stroke="black" points="43373,-552 43208,-552 43208,-469 43373,-469 43373,-552"/>
<text text-anchor="middle" x="43290.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert4_GPU15</text>
<text text-anchor="middle" x="43290.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="43290.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="43290.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="43290.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_4 -->
<g id="edge948" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43717.05,-616.58C43626.24,-605.76 43499.81,-586.52 43383.06,-552.28"/>
<polygon fill="black" stroke="black" points="43383.82,-548.86 43373.24,-549.36 43381.83,-555.57 43383.82,-548.86"/>
</g>
<!-- layer2_expert15_5 -->
<g id="node547" class="node">
<title>layer2_expert15_5</title>
<polygon fill="lightgreen" stroke="black" points="43556,-552 43391,-552 43391,-469 43556,-469 43556,-552"/>
<text text-anchor="middle" x="43473.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert5_GPU15</text>
<text text-anchor="middle" x="43473.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="43473.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="43473.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="43473.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_5 -->
<g id="edge949" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43717.47,-598.69C43671.95,-586.56 43619.87,-571.48 43565.56,-552.26"/>
<polygon fill="black" stroke="black" points="43566.71,-548.96 43556.12,-548.89 43564.35,-555.55 43566.71,-548.96"/>
</g>
<!-- layer2_expert15_6 -->
<g id="node548" class="node">
<title>layer2_expert15_6</title>
<polygon fill="lightgreen" stroke="black" points="43739,-552 43574,-552 43574,-469 43739,-469 43739,-552"/>
<text text-anchor="middle" x="43656.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert6_GPU15</text>
<text text-anchor="middle" x="43656.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="43656.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="43656.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="43656.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_6 -->
<g id="edge950" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43776.01,-587.91C43760.68,-578.11 43744.19,-567.56 43728.5,-557.53"/>
<polygon fill="black" stroke="black" points="43730.19,-554.46 43719.88,-552.02 43726.42,-560.36 43730.19,-554.46"/>
</g>
<!-- layer2_expert15_7 -->
<g id="node549" class="node">
<title>layer2_expert15_7</title>
<polygon fill="lightgreen" stroke="black" points="43922,-552 43757,-552 43757,-469 43922,-469 43922,-552"/>
<text text-anchor="middle" x="43839.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert7_GPU15</text>
<text text-anchor="middle" x="43839.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="43839.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="43839.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="43839.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_7 -->
<g id="edge951" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43839.5,-587.91C43839.5,-579.65 43839.5,-570.86 43839.5,-562.3"/>
<polygon fill="black" stroke="black" points="43843,-562.02 43839.5,-552.02 43836,-562.02 43843,-562.02"/>
</g>
<!-- layer2_expert15_8 -->
<g id="node550" class="node">
<title>layer2_expert15_8</title>
<polygon fill="lightgreen" stroke="black" points="44105,-552 43940,-552 43940,-469 44105,-469 44105,-552"/>
<text text-anchor="middle" x="44022.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert8_GPU15</text>
<text text-anchor="middle" x="44022.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="44022.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="44022.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="44022.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_8 -->
<g id="edge952" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43902.99,-587.91C43918.32,-578.11 43934.81,-567.56 43950.5,-557.53"/>
<polygon fill="black" stroke="black" points="43952.58,-560.36 43959.12,-552.02 43948.81,-554.46 43952.58,-560.36"/>
</g>
<!-- layer2_expert15_9 -->
<g id="node551" class="node">
<title>layer2_expert15_9</title>
<polygon fill="lightgreen" stroke="black" points="44288,-552 44123,-552 44123,-469 44288,-469 44288,-552"/>
<text text-anchor="middle" x="44205.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert9_GPU15</text>
<text text-anchor="middle" x="44205.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="44205.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="44205.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="44205.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_9 -->
<g id="edge953" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43961.72,-598.37C44009.54,-585.55 44064.55,-569.51 44113.5,-552 44113.6,-551.97 44113.7,-551.93 44113.79,-551.9"/>
<polygon fill="black" stroke="black" points="44114.81,-555.25 44122.97,-548.49 44112.38,-548.69 44114.81,-555.25"/>
</g>
<!-- layer2_expert15_10 -->
<g id="node552" class="node">
<title>layer2_expert15_10</title>
<polygon fill="lightgreen" stroke="black" points="44471,-552 44306,-552 44306,-469 44471,-469 44471,-552"/>
<text text-anchor="middle" x="44388.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert10_GPU15</text>
<text text-anchor="middle" x="44388.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="44388.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="44388.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="44388.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_10 -->
<g id="edge954" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43961.64,-616.42C44052.24,-605.52 44178.39,-586.25 44295.96,-551.94"/>
<polygon fill="black" stroke="black" points="44297.26,-555.2 44305.86,-549.01 44295.28,-548.49 44297.26,-555.2"/>
</g>
<!-- layer2_expert15_11 -->
<g id="node553" class="node">
<title>layer2_expert15_11</title>
<polygon fill="lightgreen" stroke="black" points="44654,-552 44489,-552 44489,-469 44654,-469 44654,-552"/>
<text text-anchor="middle" x="44571.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert11_GPU15</text>
<text text-anchor="middle" x="44571.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="44571.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="44571.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="44571.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_11 -->
<g id="edge955" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43961.56,-624.6C44089.59,-618.1 44296.01,-600.76 44479.11,-551.85"/>
<polygon fill="black" stroke="black" points="44480.18,-555.19 44488.91,-549.2 44478.35,-548.43 44480.18,-555.19"/>
</g>
<!-- layer2_expert15_12 -->
<g id="node554" class="node">
<title>layer2_expert15_12</title>
<polygon fill="lightgreen" stroke="black" points="44837,-552 44672,-552 44672,-469 44837,-469 44837,-552"/>
<text text-anchor="middle" x="44754.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert12_GPU15</text>
<text text-anchor="middle" x="44754.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="44754.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="44754.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="44754.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_12 -->
<g id="edge956" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43961.87,-621.96C44153.31,-610.93 44515.9,-586.64 44661.82,-551.83"/>
<polygon fill="black" stroke="black" points="44663.09,-555.12 44671.94,-549.3 44661.39,-548.33 44663.09,-555.12"/>
</g>
<!-- layer2_expert15_13 -->
<g id="node555" class="node">
<title>layer2_expert15_13</title>
<polygon fill="lightgreen" stroke="black" points="45020,-552 44855,-552 44855,-469 45020,-469 45020,-552"/>
<text text-anchor="middle" x="44937.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert13_GPU15</text>
<text text-anchor="middle" x="44937.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="44937.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="44937.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="44937.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_13 -->
<g id="edge957" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43961.6,-624.37C44187.48,-615.9 44663.24,-593.94 44844.97,-551.78"/>
<polygon fill="black" stroke="black" points="44846.06,-555.12 44854.96,-549.37 44844.42,-548.32 44846.06,-555.12"/>
</g>
<!-- layer2_expert15_14 -->
<g id="node556" class="node">
<title>layer2_expert15_14</title>
<polygon fill="lightgreen" stroke="black" points="45203,-552 45038,-552 45038,-469 45203,-469 45203,-552"/>
<text text-anchor="middle" x="45120.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert14_GPU15</text>
<text text-anchor="middle" x="45120.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="45120.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="45120.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="45120.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_14 -->
<g id="edge958" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43961.83,-626.04C44219.32,-619.99 44810.68,-601.3 45028.21,-551.73"/>
<polygon fill="black" stroke="black" points="45029.04,-555.13 45037.97,-549.42 45027.43,-548.31 45029.04,-555.13"/>
</g>
<!-- layer2_expert15_15 -->
<g id="node557" class="node">
<title>layer2_expert15_15</title>
<polygon fill="lightgreen" stroke="black" points="45386,-552 45221,-552 45221,-469 45386,-469 45386,-552"/>
<text text-anchor="middle" x="45303.5" y="-536.8" font-family="Times,serif" font-size="14.00">L2_Expert15_GPU15</text>
<text text-anchor="middle" x="45303.5" y="-521.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="45303.5" y="-506.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="45303.5" y="-491.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="45303.5" y="-476.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_gate_gpu15&#45;&gt;layer2_expert15_15 -->
<g id="edge959" class="edge">
<title>layer2_gate_gpu15&#45;&gt;layer2_expert15_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43961.56,-627.27C44247.91,-623.51 44957.07,-608.8 45211.05,-551.76"/>
<polygon fill="black" stroke="black" points="45212.03,-555.13 45220.98,-549.45 45210.45,-548.31 45212.03,-555.13"/>
</g>
<!-- layer2_moe_agg_gpu15 -->
<g id="node558" class="node">
<title>layer2_moe_agg_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="43853.5,-433 43641.5,-433 43641.5,-350 43853.5,-350 43853.5,-433"/>
<text text-anchor="middle" x="43747.5" y="-417.8" font-family="Times,serif" font-size="14.00">L2_MoE_Aggregate_GPU15</text>
<text text-anchor="middle" x="43747.5" y="-402.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="43747.5" y="-387.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="43747.5" y="-372.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="43747.5" y="-357.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_expert15_0&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge960" class="edge">
<title>layer2_expert15_0&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M42641.14,-471.29C42643.94,-470.46 42646.73,-469.69 42649.5,-469 42832.75,-423.35 43387.6,-402.59 43630.97,-395.5"/>
<polygon fill="black" stroke="black" points="43631.37,-398.99 43641.27,-395.2 43631.17,-391.99 43631.37,-398.99"/>
</g>
<!-- layer2_expert15_1&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge961" class="edge">
<title>layer2_expert15_1&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M42824.16,-471.34C42826.95,-470.49 42829.74,-469.71 42832.5,-469 42980.43,-431.06 43419.52,-407.06 43631.04,-397.38"/>
<polygon fill="black" stroke="black" points="43631.42,-400.87 43641.25,-396.92 43631.1,-393.88 43631.42,-400.87"/>
</g>
<!-- layer2_expert15_2&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge962" class="edge">
<title>layer2_expert15_2&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M43007.18,-471.42C43009.96,-470.55 43012.74,-469.74 43015.5,-469 43227.65,-412.24 43484.89,-397.21 43631.04,-393.46"/>
<polygon fill="black" stroke="black" points="43631.46,-396.96 43641.37,-393.21 43631.29,-389.96 43631.46,-396.96"/>
</g>
<!-- layer2_expert15_3&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge963" class="edge">
<title>layer2_expert15_3&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M43190.21,-471.54C43192.99,-470.64 43195.76,-469.78 43198.5,-469 43344.44,-427.26 43518.97,-407.91 43631.45,-399.21"/>
<polygon fill="black" stroke="black" points="43631.75,-402.7 43641.46,-398.45 43631.22,-395.72 43631.75,-402.7"/>
</g>
<!-- layer2_expert15_4&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge964" class="edge">
<title>layer2_expert15_4&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M43373.03,-471.87C43375.88,-470.87 43378.7,-469.9 43381.5,-469 43463.36,-442.56 43558.54,-423 43631.32,-410.27"/>
<polygon fill="black" stroke="black" points="43632.18,-413.68 43641.44,-408.52 43630.99,-406.78 43632.18,-413.68"/>
</g>
<!-- layer2_expert15_5&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge965" class="edge">
<title>layer2_expert15_5&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M43556.29,-472.56C43559.06,-471.35 43561.8,-470.16 43564.5,-469 43588.75,-458.54 43614.9,-447.48 43639.63,-437.11"/>
<polygon fill="black" stroke="black" points="43641.15,-440.27 43649.03,-433.18 43638.45,-433.81 43641.15,-440.27"/>
</g>
<!-- layer2_expert15_6&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge966" class="edge">
<title>layer2_expert15_6&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M43688.07,-468.91C43695.06,-459.92 43702.53,-450.32 43709.74,-441.05"/>
<polygon fill="black" stroke="black" points="43712.61,-443.06 43715.98,-433.02 43707.08,-438.77 43712.61,-443.06"/>
</g>
<!-- layer2_expert15_7&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge967" class="edge">
<title>layer2_expert15_7&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M43807.58,-468.91C43800.52,-459.92 43792.96,-450.32 43785.68,-441.05"/>
<polygon fill="black" stroke="black" points="43788.3,-438.72 43779.36,-433.02 43782.79,-443.05 43788.3,-438.72"/>
</g>
<!-- layer2_expert15_8&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge968" class="edge">
<title>layer2_expert15_8&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M43939.78,-473C43936.65,-471.64 43933.55,-470.31 43930.5,-469 43906.09,-458.53 43879.77,-447.42 43854.91,-437.01"/>
<polygon fill="black" stroke="black" points="43856.04,-433.69 43845.46,-433.05 43853.34,-440.14 43856.04,-433.69"/>
</g>
<!-- layer2_expert15_9&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge969" class="edge">
<title>layer2_expert15_9&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M44122.81,-472.15C44119.68,-471.04 44116.57,-469.99 44113.5,-469 44031.59,-442.73 43936.41,-423.16 43863.64,-410.39"/>
<polygon fill="black" stroke="black" points="43863.98,-406.89 43853.53,-408.63 43862.78,-413.79 43863.98,-406.89"/>
</g>
<!-- layer2_expert15_10&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge970" class="edge">
<title>layer2_expert15_10&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M44305.89,-471.88C44302.74,-470.85 44299.61,-469.88 44296.5,-469 44150.47,-427.55 43975.96,-408.14 43863.51,-399.34"/>
<polygon fill="black" stroke="black" points="43863.74,-395.85 43853.51,-398.57 43863.21,-402.83 43863.74,-395.85"/>
</g>
<!-- layer2_expert15_11&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge971" class="edge">
<title>layer2_expert15_11&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M44488.93,-471.74C44485.77,-470.75 44482.62,-469.83 44479.5,-469 44267.23,-412.67 44010.04,-397.49 43863.92,-393.6"/>
<polygon fill="black" stroke="black" points="43863.68,-390.1 43853.6,-393.34 43863.5,-397.09 43863.68,-390.1"/>
</g>
<!-- layer2_expert15_12&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge972" class="edge">
<title>layer2_expert15_12&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M44671.95,-471.66C44668.79,-470.69 44665.63,-469.8 44662.5,-469 44514.49,-431.36 44075.44,-407.21 43863.94,-397.44"/>
<polygon fill="black" stroke="black" points="43863.89,-393.93 43853.74,-396.97 43863.57,-400.93 43863.89,-393.93"/>
</g>
<!-- layer2_expert15_13&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge973" class="edge">
<title>layer2_expert15_13&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M44854.96,-471.6C44851.8,-470.65 44848.63,-469.77 44845.5,-469 44662.16,-423.72 44107.35,-402.76 43864.01,-395.55"/>
<polygon fill="black" stroke="black" points="43863.82,-392.05 43853.72,-395.25 43863.61,-399.04 43863.82,-392.05"/>
</g>
<!-- layer2_expert15_14&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge974" class="edge">
<title>layer2_expert15_14&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M45037.97,-471.56C45034.8,-470.62 45031.64,-469.76 45028.5,-469 44809.48,-416.06 44136.83,-399.02 43864.14,-394.2"/>
<polygon fill="black" stroke="black" points="43863.88,-390.69 43853.82,-394.02 43863.76,-397.69 43863.88,-390.69"/>
</g>
<!-- layer2_expert15_15&#45;&gt;layer2_moe_agg_gpu15 -->
<g id="edge975" class="edge">
<title>layer2_expert15_15&#45;&gt;layer2_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M45220.98,-471.53C45217.81,-470.6 45214.64,-469.75 45211.5,-469 44956.34,-408.33 44163.16,-395.76 43863.62,-393.17"/>
<polygon fill="black" stroke="black" points="43863.63,-389.67 43853.6,-393.09 43863.57,-396.67 43863.63,-389.67"/>
</g>
<!-- layer2_output_gpu15 -->
<g id="node559" class="node">
<title>layer2_output_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="40503,-142 40250,-142 40250,-74 40503,-74 40503,-142"/>
<text text-anchor="middle" x="40376.5" y="-126.8" font-family="Times,serif" font-size="14.00">L2_Residual+LayerNorm_GPU15</text>
<text text-anchor="middle" x="40376.5" y="-111.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="40376.5" y="-96.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="40376.5" y="-81.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_moe_agg_gpu15&#45;&gt;layer2_output_gpu15 -->
<g id="edge976" class="edge">
<title>layer2_moe_agg_gpu15&#45;&gt;layer2_output_gpu15</title>
<path fill="none" stroke="black" d="M43641.05,-381.61C43145.79,-340.25 41067.87,-166.73 40513.13,-120.41"/>
<polygon fill="black" stroke="black" points="40513.34,-116.91 40503.08,-119.57 40512.76,-123.89 40513.34,-116.91"/>
</g>
<!-- layer2_moe_agg_gpu15&#45;&gt;layer2_allreduce_moe -->
<g id="edge1007" class="edge">
<title>layer2_moe_agg_gpu15&#45;&gt;layer2_allreduce_moe</title>
<path fill="none" stroke="black" d="M43641.49,-388.96C43269.72,-383.56 41990.6,-365.01 40934.5,-350 38101.96,-309.74 34654.78,-261.78 33793.68,-249.81"/>
<polygon fill="black" stroke="black" points="33793.71,-246.31 33783.67,-249.67 33793.62,-253.31 33793.71,-246.31"/>
</g>
<!-- layer2_allreduce_attn&#45;&gt;layer2_attn_norm_gpu8 -->
<g id="edge978" class="edge">
<title>layer2_allreduce_attn&#45;&gt;layer2_attn_norm_gpu8</title>
<path fill="none" stroke="black" d="M33525.62,-863.5C33365.24,-847.39 33109.01,-818.09 32879.64,-775.15"/>
<polygon fill="black" stroke="black" points="32880.25,-771.7 32869.78,-773.29 32878.95,-778.58 32880.25,-771.7"/>
</g>
<!-- layer2_allreduce_attn&#45;&gt;layer2_attn_norm_gpu9 -->
<g id="edge982" class="edge">
<title>layer2_allreduce_attn&#45;&gt;layer2_attn_norm_gpu9</title>
<path fill="none" stroke="black" d="M33550.35,-855.14C33442.8,-836 33286.93,-807.07 33141.81,-775.25"/>
<polygon fill="black" stroke="black" points="33142.34,-771.79 33131.82,-773.06 33140.84,-778.62 33142.34,-771.79"/>
</g>
<!-- layer2_allreduce_attn&#45;&gt;layer2_attn_norm_gpu10 -->
<g id="edge986" class="edge">
<title>layer2_allreduce_attn&#45;&gt;layer2_attn_norm_gpu10</title>
<path fill="none" stroke="black" d="M33582.4,-844.47C33522.45,-824.39 33446.21,-798.85 33384.84,-778.29"/>
<polygon fill="black" stroke="black" points="33385.72,-774.9 33375.13,-775.04 33383.5,-781.53 33385.72,-774.9"/>
</g>
<!-- layer2_allreduce_attn&#45;&gt;layer2_attn_norm_gpu11 -->
<g id="edge990" class="edge">
<title>layer2_allreduce_attn&#45;&gt;layer2_attn_norm_gpu11</title>
<path fill="none" stroke="black" d="M33632.23,-827.36C33617.55,-812.57 33601.7,-796.6 33587.73,-782.52"/>
<polygon fill="black" stroke="black" points="33590.13,-779.98 33580.61,-775.35 33585.17,-784.91 33590.13,-779.98"/>
</g>
<!-- layer2_allreduce_attn&#45;&gt;layer2_attn_norm_gpu12 -->
<g id="edge994" class="edge">
<title>layer2_allreduce_attn&#45;&gt;layer2_attn_norm_gpu12</title>
<path fill="none" stroke="black" d="M33732.75,-827.75C33747.7,-812.8 33763.88,-796.62 33778.12,-782.38"/>
<polygon fill="black" stroke="black" points="33780.77,-784.68 33785.37,-775.13 33775.82,-779.73 33780.77,-784.68"/>
</g>
<!-- layer2_allreduce_attn&#45;&gt;layer2_attn_norm_gpu13 -->
<g id="edge998" class="edge">
<title>layer2_allreduce_attn&#45;&gt;layer2_attn_norm_gpu13</title>
<path fill="none" stroke="black" d="M33782.85,-844.47C33842.95,-824.39 33919.37,-798.85 33980.89,-778.29"/>
<polygon fill="black" stroke="black" points="33982.25,-781.53 33990.63,-775.04 33980.04,-774.89 33982.25,-781.53"/>
</g>
<!-- layer2_allreduce_attn&#45;&gt;layer2_attn_norm_gpu14 -->
<g id="edge1002" class="edge">
<title>layer2_allreduce_attn&#45;&gt;layer2_attn_norm_gpu14</title>
<path fill="none" stroke="black" d="M33814.02,-854.92C33921.55,-835.6 34077.69,-806.52 34223.81,-775.12"/>
<polygon fill="black" stroke="black" points="34224.82,-778.48 34233.86,-772.95 34223.35,-771.64 34224.82,-778.48"/>
</g>
<!-- layer2_allreduce_attn&#45;&gt;layer2_attn_norm_gpu15 -->
<g id="edge1006" class="edge">
<title>layer2_allreduce_attn&#45;&gt;layer2_attn_norm_gpu15</title>
<path fill="none" stroke="black" d="M33839.16,-863.41C34001.14,-847.12 34261.33,-817.58 34494.87,-775.05"/>
<polygon fill="black" stroke="black" points="34495.71,-778.45 34504.91,-773.21 34494.45,-771.57 34495.71,-778.45"/>
</g>
<!-- layer2_allreduce_moe&#45;&gt;layer2_output_gpu8 -->
<g id="edge980" class="edge">
<title>layer2_allreduce_moe&#45;&gt;layer2_output_gpu8</title>
<path fill="none" stroke="black" d="M33402,-241.33C32383.08,-221.58 27569.63,-128.29 26707.02,-111.57"/>
<polygon fill="black" stroke="black" points="26706.81,-108.06 26696.74,-111.37 26706.68,-115.06 26706.81,-108.06"/>
</g>
<!-- layer2_allreduce_moe&#45;&gt;layer2_output_gpu9 -->
<g id="edge984" class="edge">
<title>layer2_allreduce_moe&#45;&gt;layer2_output_gpu9</title>
<path fill="none" stroke="black" d="M33412.65,-237.88C32806.47,-213.75 30838.07,-135.38 30308,-114.28"/>
<polygon fill="black" stroke="black" points="30307.77,-110.76 30297.64,-113.86 30307.49,-117.76 30307.77,-110.76"/>
</g>
<!-- layer2_allreduce_moe&#45;&gt;layer2_output_gpu10 -->
<g id="edge988" class="edge">
<title>layer2_allreduce_moe&#45;&gt;layer2_output_gpu10</title>
<path fill="none" stroke="black" d="M33434.27,-230.54C33143.02,-203.76 32524.25,-146.86 32249.21,-121.57"/>
<polygon fill="black" stroke="black" points="32249.45,-118.08 32239.17,-120.65 32248.81,-125.05 32249.45,-118.08"/>
</g>
<!-- layer2_allreduce_moe&#45;&gt;layer2_output_gpu11 -->
<g id="edge992" class="edge">
<title>layer2_allreduce_moe&#45;&gt;layer2_output_gpu11</title>
<path fill="none" stroke="black" d="M33495.44,-209.98C33441.17,-190.19 33373.4,-165.48 33318.49,-145.46"/>
<polygon fill="black" stroke="black" points="33319.69,-142.17 33309.1,-142.03 33317.29,-148.75 33319.69,-142.17"/>
</g>
<!-- layer2_allreduce_moe&#45;&gt;layer2_output_gpu12 -->
<g id="edge996" class="edge">
<title>layer2_allreduce_moe&#45;&gt;layer2_output_gpu12</title>
<path fill="none" stroke="black" d="M33730.68,-224.6C33906.7,-198.81 34207.85,-154.67 34382.72,-129.05"/>
<polygon fill="black" stroke="black" points="34383.37,-132.49 34392.76,-127.57 34382.36,-125.56 34383.37,-132.49"/>
</g>
<!-- layer2_allreduce_moe&#45;&gt;layer2_output_gpu13 -->
<g id="edge1000" class="edge">
<title>layer2_allreduce_moe&#45;&gt;layer2_output_gpu13</title>
<path fill="none" stroke="black" d="M33768.2,-237.1C34320.12,-212.43 36004.35,-137.13 36496.87,-115.11"/>
<polygon fill="black" stroke="black" points="36497.03,-118.6 36506.87,-114.66 36496.72,-111.61 36497.03,-118.6"/>
</g>
<!-- layer2_allreduce_moe&#45;&gt;layer2_output_gpu14 -->
<g id="edge1004" class="edge">
<title>layer2_allreduce_moe&#45;&gt;layer2_output_gpu14</title>
<path fill="none" stroke="black" d="M33777.82,-240.35C34631.65,-219.03 38160.76,-130.92 38901.66,-112.42"/>
<polygon fill="black" stroke="black" points="38901.92,-115.91 38911.83,-112.16 38901.75,-108.91 38901.92,-115.91"/>
</g>
<!-- layer2_allreduce_moe&#45;&gt;layer2_output_gpu15 -->
<g id="edge1008" class="edge">
<title>layer2_allreduce_moe&#45;&gt;layer2_output_gpu15</title>
<path fill="none" stroke="black" d="M33783.1,-242.09C34495.6,-231.13 37059.85,-190.49 39173.5,-142 39559.99,-133.13 40016.24,-119.84 40239.51,-113.16"/>
<polygon fill="black" stroke="black" points="40239.75,-116.65 40249.64,-112.85 40239.54,-109.66 40239.75,-116.65"/>
</g>
<!-- layer3_qkv_gpu8 -->
<g id="node562" class="node">
<title>layer3_qkv_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="56297.5,-2908 56087.5,-2908 56087.5,-2810 56297.5,-2810 56297.5,-2908"/>
<text text-anchor="middle" x="56192.5" y="-2892.8" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU8</text>
<text text-anchor="middle" x="56192.5" y="-2877.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="56192.5" y="-2862.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="56192.5" y="-2847.8" font-family="Times,serif" font-size="14.00">Heads: 0&#45;3</text>
<text text-anchor="middle" x="56192.5" y="-2832.8" font-family="Times,serif" font-size="14.00">TP Slice: 0</text>
<text text-anchor="middle" x="56192.5" y="-2817.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_attn_gpu8 -->
<g id="node563" class="node">
<title>layer3_attn_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="56314,-2766.5 56071,-2766.5 56071,-2683.5 56314,-2683.5 56314,-2766.5"/>
<text text-anchor="middle" x="56192.5" y="-2751.3" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU8</text>
<text text-anchor="middle" x="56192.5" y="-2736.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="56192.5" y="-2721.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="56192.5" y="-2706.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="56192.5" y="-2691.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_qkv_gpu8&#45;&gt;layer3_attn_gpu8 -->
<g id="edge1009" class="edge">
<title>layer3_qkv_gpu8&#45;&gt;layer3_attn_gpu8</title>
<path fill="none" stroke="black" d="M56192.5,-2809.97C56192.5,-2799.25 56192.5,-2787.84 56192.5,-2776.99"/>
<polygon fill="black" stroke="black" points="56196,-2776.82 56192.5,-2766.82 56189,-2776.82 56196,-2776.82"/>
</g>
<!-- layer3_attn_proj_gpu8 -->
<g id="node564" class="node">
<title>layer3_attn_proj_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="56292.5,-2632.5 56092.5,-2632.5 56092.5,-2564.5 56292.5,-2564.5 56292.5,-2632.5"/>
<text text-anchor="middle" x="56192.5" y="-2617.3" font-family="Times,serif" font-size="14.00">L3_Attn_Projection_GPU8</text>
<text text-anchor="middle" x="56192.5" y="-2602.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="56192.5" y="-2587.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="56192.5" y="-2572.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_attn_gpu8&#45;&gt;layer3_attn_proj_gpu8 -->
<g id="edge1010" class="edge">
<title>layer3_attn_gpu8&#45;&gt;layer3_attn_proj_gpu8</title>
<path fill="none" stroke="black" d="M56192.5,-2683.23C56192.5,-2670.36 56192.5,-2656.1 56192.5,-2643.04"/>
<polygon fill="black" stroke="black" points="56196,-2642.88 56192.5,-2632.88 56189,-2642.88 56196,-2642.88"/>
</g>
<!-- layer3_attn_norm_gpu8 -->
<g id="node565" class="node">
<title>layer3_attn_norm_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="56313.5,-2315 56069.5,-2315 56069.5,-2247 56313.5,-2247 56313.5,-2315"/>
<text text-anchor="middle" x="56191.5" y="-2299.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU8</text>
<text text-anchor="middle" x="56191.5" y="-2284.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="56191.5" y="-2269.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="56191.5" y="-2254.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_attn_proj_gpu8&#45;&gt;layer3_attn_norm_gpu8 -->
<g id="edge1011" class="edge">
<title>layer3_attn_proj_gpu8&#45;&gt;layer3_attn_norm_gpu8</title>
<path fill="none" stroke="black" d="M56192.39,-2564.33C56192.21,-2506.93 56191.84,-2389.12 56191.64,-2325.33"/>
<polygon fill="black" stroke="black" points="56195.14,-2325.19 56191.61,-2315.2 56188.14,-2325.21 56195.14,-2325.19"/>
</g>
<!-- layer3_allreduce_attn -->
<g id="node746" class="node">
<title>layer3_allreduce_attn</title>
<polygon fill="lightcoral" stroke="black" points="57031.5,-2521 56828.5,-2453 57031.5,-2385 57234.5,-2453 57031.5,-2521"/>
<text text-anchor="middle" x="57031.5" y="-2471.8" font-family="Times,serif" font-size="14.00">L3_All&#45;Reduce_Attention</text>
<text text-anchor="middle" x="57031.5" y="-2456.8" font-family="Times,serif" font-size="14.00">Input: 8×[1024,2048,512]</text>
<text text-anchor="middle" x="57031.5" y="-2441.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="57031.5" y="-2426.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
</g>
<!-- layer3_attn_proj_gpu8&#45;&gt;layer3_allreduce_attn -->
<g id="edge1305" class="edge">
<title>layer3_attn_proj_gpu8&#45;&gt;layer3_allreduce_attn</title>
<path fill="none" stroke="black" d="M56292.53,-2569.34C56310.11,-2564.87 56328.28,-2560.56 56345.5,-2557 56525.17,-2519.85 56733.94,-2490.44 56873.54,-2472.71"/>
<polygon fill="black" stroke="black" points="56873.99,-2476.18 56883.47,-2471.46 56873.11,-2469.24 56873.99,-2476.18"/>
</g>
<!-- layer3_gate_gpu8 -->
<g id="node566" class="node">
<title>layer3_gate_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="47092.5,-2177 46848.5,-2177 46848.5,-2094 47092.5,-2094 47092.5,-2177"/>
<text text-anchor="middle" x="46970.5" y="-2161.8" font-family="Times,serif" font-size="14.00">L3_Gate_GPU8</text>
<text text-anchor="middle" x="46970.5" y="-2146.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="46970.5" y="-2131.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="46970.5" y="-2116.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="46970.5" y="-2101.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_attn_norm_gpu8&#45;&gt;layer3_gate_gpu8 -->
<g id="edge1012" class="edge">
<title>layer3_attn_norm_gpu8&#45;&gt;layer3_gate_gpu8</title>
<path fill="none" stroke="black" d="M56069.41,-2278.1C55063.04,-2262.44 48148.8,-2154.84 47102.92,-2138.56"/>
<polygon fill="black" stroke="black" points="47102.79,-2135.06 47092.74,-2138.4 47102.68,-2142.06 47102.79,-2135.06"/>
</g>
<!-- layer3_expert8_0 -->
<g id="node567" class="node">
<title>layer3_expert8_0</title>
<polygon fill="lightgreen" stroke="black" points="45589,-2058 45424,-2058 45424,-1975 45589,-1975 45589,-2058"/>
<text text-anchor="middle" x="45506.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU8</text>
<text text-anchor="middle" x="45506.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="45506.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="45506.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="45506.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_0 -->
<g id="edge1013" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46848.34,-2133.34C46561.75,-2129.72 45852,-2115.31 45599.02,-2058.07"/>
<polygon fill="black" stroke="black" points="45599.67,-2054.63 45589.13,-2055.76 45598.07,-2061.44 45599.67,-2054.63"/>
</g>
<!-- layer3_expert8_1 -->
<g id="node568" class="node">
<title>layer3_expert8_1</title>
<polygon fill="lightgreen" stroke="black" points="45772,-2058 45607,-2058 45607,-1975 45772,-1975 45772,-2058"/>
<text text-anchor="middle" x="45689.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU8</text>
<text text-anchor="middle" x="45689.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="45689.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="45689.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="45689.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_1 -->
<g id="edge1014" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46848.05,-2132.1C46590.44,-2126.18 45999,-2107.75 45782.18,-2058.11"/>
<polygon fill="black" stroke="black" points="45782.68,-2054.63 45772.14,-2055.73 45781.06,-2061.44 45782.68,-2054.63"/>
</g>
<!-- layer3_expert8_2 -->
<g id="node569" class="node">
<title>layer3_expert8_2</title>
<polygon fill="lightgreen" stroke="black" points="45955,-2058 45790,-2058 45790,-1975 45955,-1975 45955,-2058"/>
<text text-anchor="middle" x="45872.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU8</text>
<text text-anchor="middle" x="45872.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="45872.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="45872.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="45872.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_2 -->
<g id="edge1015" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46848.26,-2130.44C46622.14,-2122.08 46145.86,-2100.29 45965.08,-2058.1"/>
<polygon fill="black" stroke="black" points="45965.69,-2054.65 45955.15,-2055.68 45964.04,-2061.45 45965.69,-2054.65"/>
</g>
<!-- layer3_expert8_3 -->
<g id="node570" class="node">
<title>layer3_expert8_3</title>
<polygon fill="lightgreen" stroke="black" points="46138,-2058 45973,-2058 45973,-1975 46138,-1975 46138,-2058"/>
<text text-anchor="middle" x="46055.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU8</text>
<text text-anchor="middle" x="46055.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="46055.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="46055.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="46055.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_3 -->
<g id="edge1016" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46848.36,-2128.05C46656.78,-2117.12 46293.32,-2092.96 46148.23,-2058.15"/>
<polygon fill="black" stroke="black" points="46148.72,-2054.66 46138.17,-2055.62 46147.01,-2061.45 46148.72,-2054.66"/>
</g>
<!-- layer3_expert8_4 -->
<g id="node571" class="node">
<title>layer3_expert8_4</title>
<polygon fill="lightgreen" stroke="black" points="46321,-2058 46156,-2058 46156,-1975 46321,-1975 46321,-2058"/>
<text text-anchor="middle" x="46238.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU8</text>
<text text-anchor="middle" x="46238.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="46238.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="46238.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="46238.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_4 -->
<g id="edge1017" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46848.21,-2130.77C46719.95,-2124.4 46513.18,-2107.17 46330.95,-2058.19"/>
<polygon fill="black" stroke="black" points="46331.76,-2054.78 46321.19,-2055.53 46329.92,-2061.53 46331.76,-2054.78"/>
</g>
<!-- layer3_expert8_5 -->
<g id="node572" class="node">
<title>layer3_expert8_5</title>
<polygon fill="lightgreen" stroke="black" points="46504,-2058 46339,-2058 46339,-1975 46504,-1975 46504,-2058"/>
<text text-anchor="middle" x="46421.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU8</text>
<text text-anchor="middle" x="46421.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="46421.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="46421.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="46421.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_5 -->
<g id="edge1018" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46848.05,-2122.58C46757.24,-2111.76 46630.81,-2092.52 46514.06,-2058.28"/>
<polygon fill="black" stroke="black" points="46514.82,-2054.86 46504.24,-2055.36 46512.83,-2061.57 46514.82,-2054.86"/>
</g>
<!-- layer3_expert8_6 -->
<g id="node573" class="node">
<title>layer3_expert8_6</title>
<polygon fill="lightgreen" stroke="black" points="46687,-2058 46522,-2058 46522,-1975 46687,-1975 46687,-2058"/>
<text text-anchor="middle" x="46604.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU8</text>
<text text-anchor="middle" x="46604.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="46604.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="46604.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="46604.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_6 -->
<g id="edge1019" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46848.47,-2104.69C46802.95,-2092.56 46750.87,-2077.48 46696.56,-2058.26"/>
<polygon fill="black" stroke="black" points="46697.71,-2054.96 46687.12,-2054.89 46695.35,-2061.55 46697.71,-2054.96"/>
</g>
<!-- layer3_expert8_7 -->
<g id="node574" class="node">
<title>layer3_expert8_7</title>
<polygon fill="lightgreen" stroke="black" points="46870,-2058 46705,-2058 46705,-1975 46870,-1975 46870,-2058"/>
<text text-anchor="middle" x="46787.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU8</text>
<text text-anchor="middle" x="46787.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="46787.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="46787.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="46787.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_7 -->
<g id="edge1020" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46907.01,-2093.91C46891.68,-2084.11 46875.19,-2073.56 46859.5,-2063.53"/>
<polygon fill="black" stroke="black" points="46861.19,-2060.46 46850.88,-2058.02 46857.42,-2066.36 46861.19,-2060.46"/>
</g>
<!-- layer3_expert8_8 -->
<g id="node575" class="node">
<title>layer3_expert8_8</title>
<polygon fill="lightgreen" stroke="black" points="47053,-2058 46888,-2058 46888,-1975 47053,-1975 47053,-2058"/>
<text text-anchor="middle" x="46970.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU8</text>
<text text-anchor="middle" x="46970.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="46970.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="46970.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="46970.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_8 -->
<g id="edge1021" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46970.5,-2093.91C46970.5,-2085.65 46970.5,-2076.86 46970.5,-2068.3"/>
<polygon fill="black" stroke="black" points="46974,-2068.02 46970.5,-2058.02 46967,-2068.02 46974,-2068.02"/>
</g>
<!-- layer3_expert8_9 -->
<g id="node576" class="node">
<title>layer3_expert8_9</title>
<polygon fill="lightgreen" stroke="black" points="47236,-2058 47071,-2058 47071,-1975 47236,-1975 47236,-2058"/>
<text text-anchor="middle" x="47153.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU8</text>
<text text-anchor="middle" x="47153.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="47153.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="47153.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="47153.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_9 -->
<g id="edge1022" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47033.99,-2093.91C47049.32,-2084.11 47065.81,-2073.56 47081.5,-2063.53"/>
<polygon fill="black" stroke="black" points="47083.58,-2066.36 47090.12,-2058.02 47079.81,-2060.46 47083.58,-2066.36"/>
</g>
<!-- layer3_expert8_10 -->
<g id="node577" class="node">
<title>layer3_expert8_10</title>
<polygon fill="lightgreen" stroke="black" points="47419,-2058 47254,-2058 47254,-1975 47419,-1975 47419,-2058"/>
<text text-anchor="middle" x="47336.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU8</text>
<text text-anchor="middle" x="47336.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="47336.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="47336.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="47336.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_10 -->
<g id="edge1023" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47092.53,-2104.69C47138.05,-2092.56 47190.13,-2077.48 47244.44,-2058.26"/>
<polygon fill="black" stroke="black" points="47245.65,-2061.55 47253.88,-2054.89 47243.29,-2054.96 47245.65,-2061.55"/>
</g>
<!-- layer3_expert8_11 -->
<g id="node578" class="node">
<title>layer3_expert8_11</title>
<polygon fill="lightgreen" stroke="black" points="47602,-2058 47437,-2058 47437,-1975 47602,-1975 47602,-2058"/>
<text text-anchor="middle" x="47519.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU8</text>
<text text-anchor="middle" x="47519.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="47519.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="47519.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="47519.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_11 -->
<g id="edge1024" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47092.95,-2122.58C47183.76,-2111.76 47310.19,-2092.52 47426.94,-2058.28"/>
<polygon fill="black" stroke="black" points="47428.17,-2061.57 47436.76,-2055.36 47426.18,-2054.86 47428.17,-2061.57"/>
</g>
<!-- layer3_expert8_12 -->
<g id="node579" class="node">
<title>layer3_expert8_12</title>
<polygon fill="lightgreen" stroke="black" points="47785,-2058 47620,-2058 47620,-1975 47785,-1975 47785,-2058"/>
<text text-anchor="middle" x="47702.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU8</text>
<text text-anchor="middle" x="47702.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="47702.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="47702.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="47702.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_12 -->
<g id="edge1025" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47092.79,-2130.77C47221.05,-2124.4 47427.82,-2107.17 47610.05,-2058.19"/>
<polygon fill="black" stroke="black" points="47611.08,-2061.53 47619.81,-2055.53 47609.24,-2054.78 47611.08,-2061.53"/>
</g>
<!-- layer3_expert8_13 -->
<g id="node580" class="node">
<title>layer3_expert8_13</title>
<polygon fill="lightgreen" stroke="black" points="47968,-2058 47803,-2058 47803,-1975 47968,-1975 47968,-2058"/>
<text text-anchor="middle" x="47885.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU8</text>
<text text-anchor="middle" x="47885.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="47885.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="47885.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="47885.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_13 -->
<g id="edge1026" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47092.64,-2128.05C47284.22,-2117.12 47647.68,-2092.96 47792.77,-2058.15"/>
<polygon fill="black" stroke="black" points="47793.99,-2061.45 47802.83,-2055.62 47792.28,-2054.66 47793.99,-2061.45"/>
</g>
<!-- layer3_expert8_14 -->
<g id="node581" class="node">
<title>layer3_expert8_14</title>
<polygon fill="lightgreen" stroke="black" points="48151,-2058 47986,-2058 47986,-1975 48151,-1975 48151,-2058"/>
<text text-anchor="middle" x="48068.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU8</text>
<text text-anchor="middle" x="48068.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="48068.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="48068.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="48068.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_14 -->
<g id="edge1027" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47092.74,-2130.44C47318.86,-2122.08 47795.14,-2100.29 47975.92,-2058.1"/>
<polygon fill="black" stroke="black" points="47976.96,-2061.45 47985.85,-2055.68 47975.31,-2054.65 47976.96,-2061.45"/>
</g>
<!-- layer3_expert8_15 -->
<g id="node582" class="node">
<title>layer3_expert8_15</title>
<polygon fill="lightgreen" stroke="black" points="48334,-2058 48169,-2058 48169,-1975 48334,-1975 48334,-2058"/>
<text text-anchor="middle" x="48251.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU8</text>
<text text-anchor="middle" x="48251.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="48251.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="48251.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="48251.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_gate_gpu8&#45;&gt;layer3_expert8_15 -->
<g id="edge1028" class="edge">
<title>layer3_gate_gpu8&#45;&gt;layer3_expert8_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47092.95,-2132.1C47350.56,-2126.18 47942,-2107.75 48158.82,-2058.11"/>
<polygon fill="black" stroke="black" points="48159.94,-2061.44 48168.86,-2055.73 48158.32,-2054.63 48159.94,-2061.44"/>
</g>
<!-- layer3_moe_agg_gpu8 -->
<g id="node583" class="node">
<title>layer3_moe_agg_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="47164,-1939 46961,-1939 46961,-1856 47164,-1856 47164,-1939"/>
<text text-anchor="middle" x="47062.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU8</text>
<text text-anchor="middle" x="47062.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="47062.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="47062.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="47062.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_expert8_0&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge1029" class="edge">
<title>layer3_expert8_0&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M45589.13,-1977.23C45591.93,-1976.41 45594.73,-1975.67 45597.5,-1975 45853.96,-1913.47 46654.3,-1901.43 46950.66,-1899.07"/>
<polygon fill="black" stroke="black" points="46951.02,-1902.57 46960.99,-1898.99 46950.96,-1895.57 46951.02,-1902.57"/>
</g>
<!-- layer3_expert8_1&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge1030" class="edge">
<title>layer3_expert8_1&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M45772.14,-1977.26C45774.94,-1976.43 45777.73,-1975.68 45780.5,-1975 46000.92,-1921.25 46681.05,-1904.62 46950.7,-1900.05"/>
<polygon fill="black" stroke="black" points="46950.96,-1903.55 46960.9,-1899.88 46950.84,-1896.55 46950.96,-1903.55"/>
</g>
<!-- layer3_expert8_2&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge1031" class="edge">
<title>layer3_expert8_2&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M45955.14,-1977.29C45957.94,-1976.46 45960.73,-1975.69 45963.5,-1975 46148.06,-1929.03 46709.21,-1908.31 46950.39,-1901.36"/>
<polygon fill="black" stroke="black" points="46950.68,-1904.85 46960.58,-1901.07 46950.48,-1897.86 46950.68,-1904.85"/>
</g>
<!-- layer3_expert8_3&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge1032" class="edge">
<title>layer3_expert8_3&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M46138.16,-1977.34C46140.95,-1976.49 46143.74,-1975.71 46146.5,-1975 46295.74,-1936.73 46740.96,-1912.67 46950.77,-1903.16"/>
<polygon fill="black" stroke="black" points="46951.05,-1906.65 46960.88,-1902.7 46950.74,-1899.65 46951.05,-1906.65"/>
</g>
<!-- layer3_expert8_4&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge1033" class="edge">
<title>layer3_expert8_4&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M46321.18,-1977.42C46323.96,-1976.55 46326.74,-1975.74 46329.5,-1975 46544.21,-1917.57 46805.02,-1902.86 46950.52,-1899.33"/>
<polygon fill="black" stroke="black" points="46950.88,-1902.82 46960.8,-1899.09 46950.72,-1895.82 46950.88,-1902.82"/>
</g>
<!-- layer3_expert8_5&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge1034" class="edge">
<title>layer3_expert8_5&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M46504.21,-1977.54C46506.99,-1976.64 46509.76,-1975.78 46512.5,-1975 46660.74,-1932.62 46838.4,-1913.34 46950.88,-1904.83"/>
<polygon fill="black" stroke="black" points="46951.17,-1908.32 46960.89,-1904.09 46950.65,-1901.34 46951.17,-1908.32"/>
</g>
<!-- layer3_expert8_6&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge1035" class="edge">
<title>layer3_expert8_6&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M46687.03,-1977.87C46689.87,-1976.86 46692.7,-1975.9 46695.5,-1975 46779.36,-1947.94 46877.16,-1928.11 46950.7,-1915.42"/>
<polygon fill="black" stroke="black" points="46951.65,-1918.81 46960.92,-1913.68 46950.47,-1911.91 46951.65,-1918.81"/>
</g>
<!-- layer3_expert8_7&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge1036" class="edge">
<title>layer3_expert8_7&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M46870.29,-1978.55C46873.06,-1977.35 46875.8,-1976.16 46878.5,-1975 46902.87,-1964.51 46929.16,-1953.44 46954.02,-1943.08"/>
<polygon fill="black" stroke="black" points="46955.59,-1946.22 46963.48,-1939.14 46952.9,-1939.75 46955.59,-1946.22"/>
</g>
<!-- layer3_expert8_8&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge1037" class="edge">
<title>layer3_expert8_8&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M47002.42,-1974.91C47009.48,-1965.92 47017.04,-1956.32 47024.32,-1947.05"/>
<polygon fill="black" stroke="black" points="47027.21,-1949.05 47030.64,-1939.02 47021.7,-1944.72 47027.21,-1949.05"/>
</g>
<!-- layer3_expert8_9&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge1038" class="edge">
<title>layer3_expert8_9&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M47121.93,-1974.91C47114.94,-1965.92 47107.47,-1956.32 47100.26,-1947.05"/>
<polygon fill="black" stroke="black" points="47102.92,-1944.77 47094.02,-1939.02 47097.39,-1949.06 47102.92,-1944.77"/>
</g>
<!-- layer3_expert8_10&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge1039" class="edge">
<title>layer3_expert8_10&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M47253.71,-1978.56C47250.94,-1977.35 47248.2,-1976.16 47245.5,-1975 47221.25,-1964.54 47195.1,-1953.48 47170.37,-1943.11"/>
<polygon fill="black" stroke="black" points="47171.55,-1939.81 47160.97,-1939.18 47168.85,-1946.27 47171.55,-1939.81"/>
</g>
<!-- layer3_expert8_11&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge1040" class="edge">
<title>layer3_expert8_11&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M47436.97,-1977.87C47434.12,-1976.87 47431.3,-1975.9 47428.5,-1975 47345.02,-1948.04 47247.68,-1928.22 47174.38,-1915.52"/>
<polygon fill="black" stroke="black" points="47174.65,-1912.02 47164.2,-1913.78 47173.46,-1918.92 47174.65,-1912.02"/>
</g>
<!-- layer3_expert8_12&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge1041" class="edge">
<title>layer3_expert8_12&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M47619.79,-1977.54C47617.01,-1976.64 47614.24,-1975.78 47611.5,-1975 47463.65,-1932.71 47286.46,-1913.41 47174.17,-1904.87"/>
<polygon fill="black" stroke="black" points="47174.42,-1901.38 47164.18,-1904.13 47173.9,-1908.36 47174.42,-1901.38"/>
</g>
<!-- layer3_expert8_13&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge1042" class="edge">
<title>layer3_expert8_13&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M47802.82,-1977.42C47800.04,-1976.55 47797.26,-1975.74 47794.5,-1975 47580.09,-1917.63 47319.63,-1902.9 47174.33,-1899.35"/>
<polygon fill="black" stroke="black" points="47174.14,-1895.84 47164.07,-1899.11 47173.98,-1902.84 47174.14,-1895.84"/>
</g>
<!-- layer3_expert8_14&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge1043" class="edge">
<title>layer3_expert8_14&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M47985.84,-1977.34C47983.05,-1976.49 47980.26,-1975.71 47977.5,-1975 47828.43,-1936.76 47383.69,-1912.69 47174.11,-1903.16"/>
<polygon fill="black" stroke="black" points="47174.15,-1899.66 47164,-1902.71 47173.84,-1906.65 47174.15,-1899.66"/>
</g>
<!-- layer3_expert8_15&#45;&gt;layer3_moe_agg_gpu8 -->
<g id="edge1044" class="edge">
<title>layer3_expert8_15&#45;&gt;layer3_moe_agg_gpu8</title>
<path fill="none" stroke="black" d="M48168.86,-1977.29C48166.06,-1976.46 48163.27,-1975.69 48160.5,-1975 47976.11,-1929.06 47415.46,-1908.33 47174.51,-1901.36"/>
<polygon fill="black" stroke="black" points="47174.42,-1897.86 47164.33,-1901.07 47174.22,-1904.86 47174.42,-1897.86"/>
</g>
<!-- layer3_output_gpu8 -->
<g id="node584" class="node">
<title>layer3_output_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="56326.5,-1614 56082.5,-1614 56082.5,-1546 56326.5,-1546 56326.5,-1614"/>
<text text-anchor="middle" x="56204.5" y="-1598.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU8</text>
<text text-anchor="middle" x="56204.5" y="-1583.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="56204.5" y="-1568.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="56204.5" y="-1553.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_moe_agg_gpu8&#45;&gt;layer3_output_gpu8 -->
<g id="edge1045" class="edge">
<title>layer3_moe_agg_gpu8&#45;&gt;layer3_output_gpu8</title>
<path fill="none" stroke="black" d="M47164.14,-1890.28C47633.49,-1861.79 49638.37,-1742.64 51284.5,-1684 53184.84,-1616.3 55499.76,-1588.46 56071.94,-1582.35"/>
<polygon fill="black" stroke="black" points="56072.32,-1585.84 56082.28,-1582.24 56072.24,-1578.84 56072.32,-1585.84"/>
</g>
<!-- layer3_allreduce_moe -->
<g id="node747" class="node">
<title>layer3_allreduce_moe</title>
<polygon fill="lightcoral" stroke="black" points="57130.5,-1820 56927.5,-1752 57130.5,-1684 57333.5,-1752 57130.5,-1820"/>
<text text-anchor="middle" x="57130.5" y="-1770.8" font-family="Times,serif" font-size="14.00">L3_All&#45;Reduce_MoE</text>
<text text-anchor="middle" x="57130.5" y="-1755.8" font-family="Times,serif" font-size="14.00">Input: 8×[1024,2048,512]</text>
<text text-anchor="middle" x="57130.5" y="-1740.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,4096]</text>
<text text-anchor="middle" x="57130.5" y="-1725.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
</g>
<!-- layer3_moe_agg_gpu8&#45;&gt;layer3_allreduce_moe -->
<g id="edge1307" class="edge">
<title>layer3_moe_agg_gpu8&#45;&gt;layer3_allreduce_moe</title>
<path fill="none" stroke="black" d="M47164.19,-1895.03C47530.59,-1889.74 48817.62,-1871.18 49879.5,-1856 52673.47,-1816.07 56073.03,-1767.96 56928.03,-1755.86"/>
<polygon fill="black" stroke="black" points="56928.33,-1759.36 56938.28,-1755.72 56928.23,-1752.36 56928.33,-1759.36"/>
</g>
<!-- output -->
<g id="node749" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="57139.5" cy="-1408" rx="292.07" ry="37.45"/>
<text text-anchor="middle" x="57139.5" y="-1419.3" font-family="Times,serif" font-size="14.00">OUTPUT</text>
<text text-anchor="middle" x="57139.5" y="-1404.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="57139.5" y="-1389.3" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- layer3_output_gpu8&#45;&gt;output -->
<g id="edge1337" class="edge">
<title>layer3_output_gpu8&#45;&gt;output</title>
<path fill="none" stroke="black" d="M56258.8,-1545.89C56281.71,-1533.35 56309.14,-1520.16 56335.5,-1512 56503.22,-1460.1 56698.42,-1434.32 56854.48,-1421.54"/>
<polygon fill="black" stroke="black" points="56855.02,-1425 56864.7,-1420.71 56854.46,-1418.03 56855.02,-1425"/>
</g>
<!-- layer3_qkv_gpu9 -->
<g id="node585" class="node">
<title>layer3_qkv_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="56559.5,-2908 56349.5,-2908 56349.5,-2810 56559.5,-2810 56559.5,-2908"/>
<text text-anchor="middle" x="56454.5" y="-2892.8" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU9</text>
<text text-anchor="middle" x="56454.5" y="-2877.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="56454.5" y="-2862.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="56454.5" y="-2847.8" font-family="Times,serif" font-size="14.00">Heads: 4&#45;7</text>
<text text-anchor="middle" x="56454.5" y="-2832.8" font-family="Times,serif" font-size="14.00">TP Slice: 1</text>
<text text-anchor="middle" x="56454.5" y="-2817.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_attn_gpu9 -->
<g id="node586" class="node">
<title>layer3_attn_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="56576,-2766.5 56333,-2766.5 56333,-2683.5 56576,-2683.5 56576,-2766.5"/>
<text text-anchor="middle" x="56454.5" y="-2751.3" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU9</text>
<text text-anchor="middle" x="56454.5" y="-2736.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="56454.5" y="-2721.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="56454.5" y="-2706.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="56454.5" y="-2691.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_qkv_gpu9&#45;&gt;layer3_attn_gpu9 -->
<g id="edge1046" class="edge">
<title>layer3_qkv_gpu9&#45;&gt;layer3_attn_gpu9</title>
<path fill="none" stroke="black" d="M56454.5,-2809.97C56454.5,-2799.25 56454.5,-2787.84 56454.5,-2776.99"/>
<polygon fill="black" stroke="black" points="56458,-2776.82 56454.5,-2766.82 56451,-2776.82 56458,-2776.82"/>
</g>
<!-- layer3_attn_proj_gpu9 -->
<g id="node587" class="node">
<title>layer3_attn_proj_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="56554.5,-2632.5 56354.5,-2632.5 56354.5,-2564.5 56554.5,-2564.5 56554.5,-2632.5"/>
<text text-anchor="middle" x="56454.5" y="-2617.3" font-family="Times,serif" font-size="14.00">L3_Attn_Projection_GPU9</text>
<text text-anchor="middle" x="56454.5" y="-2602.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="56454.5" y="-2587.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="56454.5" y="-2572.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_attn_gpu9&#45;&gt;layer3_attn_proj_gpu9 -->
<g id="edge1047" class="edge">
<title>layer3_attn_gpu9&#45;&gt;layer3_attn_proj_gpu9</title>
<path fill="none" stroke="black" d="M56454.5,-2683.23C56454.5,-2670.36 56454.5,-2656.1 56454.5,-2643.04"/>
<polygon fill="black" stroke="black" points="56458,-2642.88 56454.5,-2632.88 56451,-2642.88 56458,-2642.88"/>
</g>
<!-- layer3_attn_norm_gpu9 -->
<g id="node588" class="node">
<title>layer3_attn_norm_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="56575.5,-2315 56331.5,-2315 56331.5,-2247 56575.5,-2247 56575.5,-2315"/>
<text text-anchor="middle" x="56453.5" y="-2299.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU9</text>
<text text-anchor="middle" x="56453.5" y="-2284.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="56453.5" y="-2269.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="56453.5" y="-2254.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_attn_proj_gpu9&#45;&gt;layer3_attn_norm_gpu9 -->
<g id="edge1048" class="edge">
<title>layer3_attn_proj_gpu9&#45;&gt;layer3_attn_norm_gpu9</title>
<path fill="none" stroke="black" d="M56454.39,-2564.33C56454.21,-2506.93 56453.84,-2389.12 56453.64,-2325.33"/>
<polygon fill="black" stroke="black" points="56457.14,-2325.19 56453.61,-2315.2 56450.14,-2325.21 56457.14,-2325.19"/>
</g>
<!-- layer3_attn_proj_gpu9&#45;&gt;layer3_allreduce_attn -->
<g id="edge1309" class="edge">
<title>layer3_attn_proj_gpu9&#45;&gt;layer3_allreduce_attn</title>
<path fill="none" stroke="black" d="M56554.83,-2570.63C56572.37,-2566.02 56590.45,-2561.33 56607.5,-2557 56707.09,-2531.73 56820.16,-2504.32 56904.48,-2484.14"/>
<polygon fill="black" stroke="black" points="56905.45,-2487.51 56914.36,-2481.78 56903.82,-2480.7 56905.45,-2487.51"/>
</g>
<!-- layer3_gate_gpu9 -->
<g id="node589" class="node">
<title>layer3_gate_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="50020.5,-2177 49776.5,-2177 49776.5,-2094 50020.5,-2094 50020.5,-2177"/>
<text text-anchor="middle" x="49898.5" y="-2161.8" font-family="Times,serif" font-size="14.00">L3_Gate_GPU9</text>
<text text-anchor="middle" x="49898.5" y="-2146.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="49898.5" y="-2131.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="49898.5" y="-2116.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="49898.5" y="-2101.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_attn_norm_gpu9&#45;&gt;layer3_gate_gpu9 -->
<g id="edge1049" class="edge">
<title>layer3_attn_norm_gpu9&#45;&gt;layer3_gate_gpu9</title>
<path fill="none" stroke="black" d="M56402.47,-2246.92C56379.08,-2233.64 56350.41,-2219.87 56322.5,-2213 56224.67,-2188.92 52796.25,-2178.23 52695.5,-2177 51669.7,-2164.48 50432.34,-2145.05 50031.03,-2138.63"/>
<polygon fill="black" stroke="black" points="50030.89,-2135.13 50020.84,-2138.47 50030.78,-2142.13 50030.89,-2135.13"/>
</g>
<!-- layer3_expert9_0 -->
<g id="node590" class="node">
<title>layer3_expert9_0</title>
<polygon fill="lightgreen" stroke="black" points="48517,-2058 48352,-2058 48352,-1975 48517,-1975 48517,-2058"/>
<text text-anchor="middle" x="48434.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU9</text>
<text text-anchor="middle" x="48434.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="48434.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="48434.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="48434.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_0 -->
<g id="edge1050" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49776.44,-2133.27C49490.09,-2129.51 48780.93,-2114.8 48526.95,-2057.76"/>
<polygon fill="black" stroke="black" points="48527.55,-2054.31 48517.02,-2055.45 48525.97,-2061.13 48527.55,-2054.31"/>
</g>
<!-- layer3_expert9_1 -->
<g id="node591" class="node">
<title>layer3_expert9_1</title>
<polygon fill="lightgreen" stroke="black" points="48700,-2058 48535,-2058 48535,-1975 48700,-1975 48700,-2058"/>
<text text-anchor="middle" x="48617.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU9</text>
<text text-anchor="middle" x="48617.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="48617.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="48617.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="48617.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_1 -->
<g id="edge1051" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49776.17,-2132.04C49518.68,-2125.99 48927.32,-2107.3 48709.79,-2057.73"/>
<polygon fill="black" stroke="black" points="48710.57,-2054.31 48700.03,-2055.42 48708.96,-2061.13 48710.57,-2054.31"/>
</g>
<!-- layer3_expert9_2 -->
<g id="node592" class="node">
<title>layer3_expert9_2</title>
<polygon fill="lightgreen" stroke="black" points="48883,-2058 48718,-2058 48718,-1975 48883,-1975 48883,-2058"/>
<text text-anchor="middle" x="48800.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU9</text>
<text text-anchor="middle" x="48800.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="48800.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="48800.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="48800.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_2 -->
<g id="edge1052" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49776.4,-2130.37C49550.52,-2121.9 49074.76,-2099.94 48893.03,-2057.78"/>
<polygon fill="black" stroke="black" points="48893.58,-2054.32 48883.04,-2055.37 48891.94,-2061.12 48893.58,-2054.32"/>
</g>
<!-- layer3_expert9_3 -->
<g id="node593" class="node">
<title>layer3_expert9_3</title>
<polygon fill="lightgreen" stroke="black" points="49066,-2058 48901,-2058 48901,-1975 49066,-1975 49066,-2058"/>
<text text-anchor="middle" x="48983.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU9</text>
<text text-anchor="middle" x="48983.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="48983.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="48983.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="48983.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_3 -->
<g id="edge1053" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49776.13,-2127.96C49584.69,-2116.93 49222.1,-2092.64 49076.18,-2057.83"/>
<polygon fill="black" stroke="black" points="49076.61,-2054.33 49066.06,-2055.3 49074.91,-2061.12 49076.61,-2054.33"/>
</g>
<!-- layer3_expert9_4 -->
<g id="node594" class="node">
<title>layer3_expert9_4</title>
<polygon fill="lightgreen" stroke="black" points="49249,-2058 49084,-2058 49084,-1975 49249,-1975 49249,-2058"/>
<text text-anchor="middle" x="49166.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU9</text>
<text text-anchor="middle" x="49166.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="49166.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="49166.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="49166.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_4 -->
<g id="edge1054" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49776.44,-2130.6C49648.41,-2124.1 49441.99,-2106.76 49258.89,-2057.85"/>
<polygon fill="black" stroke="black" points="49259.65,-2054.43 49249.09,-2055.2 49257.82,-2061.19 49259.65,-2054.43"/>
</g>
<!-- layer3_expert9_5 -->
<g id="node595" class="node">
<title>layer3_expert9_5</title>
<polygon fill="lightgreen" stroke="black" points="49432,-2058 49267,-2058 49267,-1975 49432,-1975 49432,-2058"/>
<text text-anchor="middle" x="49349.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU9</text>
<text text-anchor="middle" x="49349.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="49349.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="49349.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="49349.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_5 -->
<g id="edge1055" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49776.36,-2122.42C49685.76,-2111.52 49559.61,-2092.25 49442.04,-2057.94"/>
<polygon fill="black" stroke="black" points="49442.72,-2054.49 49432.14,-2055.01 49440.74,-2061.2 49442.72,-2054.49"/>
</g>
<!-- layer3_expert9_6 -->
<g id="node596" class="node">
<title>layer3_expert9_6</title>
<polygon fill="lightgreen" stroke="black" points="49615,-2058 49450,-2058 49450,-1975 49615,-1975 49615,-2058"/>
<text text-anchor="middle" x="49532.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU9</text>
<text text-anchor="middle" x="49532.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="49532.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="49532.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="49532.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_6 -->
<g id="edge1056" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49776.28,-2104.37C49728.46,-2091.55 49673.45,-2075.51 49624.5,-2058 49624.4,-2057.97 49624.3,-2057.93 49624.21,-2057.9"/>
<polygon fill="black" stroke="black" points="49625.62,-2054.69 49615.03,-2054.49 49623.19,-2061.25 49625.62,-2054.69"/>
</g>
<!-- layer3_expert9_7 -->
<g id="node597" class="node">
<title>layer3_expert9_7</title>
<polygon fill="lightgreen" stroke="black" points="49798,-2058 49633,-2058 49633,-1975 49798,-1975 49798,-2058"/>
<text text-anchor="middle" x="49715.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU9</text>
<text text-anchor="middle" x="49715.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="49715.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="49715.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="49715.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_7 -->
<g id="edge1057" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49835.01,-2093.91C49819.68,-2084.11 49803.19,-2073.56 49787.5,-2063.53"/>
<polygon fill="black" stroke="black" points="49789.19,-2060.46 49778.88,-2058.02 49785.42,-2066.36 49789.19,-2060.46"/>
</g>
<!-- layer3_expert9_8 -->
<g id="node598" class="node">
<title>layer3_expert9_8</title>
<polygon fill="lightgreen" stroke="black" points="49981,-2058 49816,-2058 49816,-1975 49981,-1975 49981,-2058"/>
<text text-anchor="middle" x="49898.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU9</text>
<text text-anchor="middle" x="49898.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="49898.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="49898.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="49898.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_8 -->
<g id="edge1058" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49898.5,-2093.91C49898.5,-2085.65 49898.5,-2076.86 49898.5,-2068.3"/>
<polygon fill="black" stroke="black" points="49902,-2068.02 49898.5,-2058.02 49895,-2068.02 49902,-2068.02"/>
</g>
<!-- layer3_expert9_9 -->
<g id="node599" class="node">
<title>layer3_expert9_9</title>
<polygon fill="lightgreen" stroke="black" points="50164,-2058 49999,-2058 49999,-1975 50164,-1975 50164,-2058"/>
<text text-anchor="middle" x="50081.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU9</text>
<text text-anchor="middle" x="50081.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="50081.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="50081.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="50081.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_9 -->
<g id="edge1059" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49961.99,-2093.91C49977.32,-2084.11 49993.81,-2073.56 50009.5,-2063.53"/>
<polygon fill="black" stroke="black" points="50011.58,-2066.36 50018.12,-2058.02 50007.81,-2060.46 50011.58,-2066.36"/>
</g>
<!-- layer3_expert9_10 -->
<g id="node600" class="node">
<title>layer3_expert9_10</title>
<polygon fill="lightgreen" stroke="black" points="50347,-2058 50182,-2058 50182,-1975 50347,-1975 50347,-2058"/>
<text text-anchor="middle" x="50264.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU9</text>
<text text-anchor="middle" x="50264.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="50264.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="50264.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="50264.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_10 -->
<g id="edge1060" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50020.53,-2104.69C50066.05,-2092.56 50118.13,-2077.48 50172.44,-2058.26"/>
<polygon fill="black" stroke="black" points="50173.65,-2061.55 50181.88,-2054.89 50171.29,-2054.96 50173.65,-2061.55"/>
</g>
<!-- layer3_expert9_11 -->
<g id="node601" class="node">
<title>layer3_expert9_11</title>
<polygon fill="lightgreen" stroke="black" points="50530,-2058 50365,-2058 50365,-1975 50530,-1975 50530,-2058"/>
<text text-anchor="middle" x="50447.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU9</text>
<text text-anchor="middle" x="50447.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="50447.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="50447.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="50447.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_11 -->
<g id="edge1061" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50020.95,-2122.58C50111.76,-2111.76 50238.19,-2092.52 50354.94,-2058.28"/>
<polygon fill="black" stroke="black" points="50356.17,-2061.57 50364.76,-2055.36 50354.18,-2054.86 50356.17,-2061.57"/>
</g>
<!-- layer3_expert9_12 -->
<g id="node602" class="node">
<title>layer3_expert9_12</title>
<polygon fill="lightgreen" stroke="black" points="50713,-2058 50548,-2058 50548,-1975 50713,-1975 50713,-2058"/>
<text text-anchor="middle" x="50630.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU9</text>
<text text-anchor="middle" x="50630.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="50630.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="50630.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="50630.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_12 -->
<g id="edge1062" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50020.79,-2130.77C50149.05,-2124.4 50355.82,-2107.17 50538.05,-2058.19"/>
<polygon fill="black" stroke="black" points="50539.08,-2061.53 50547.81,-2055.53 50537.24,-2054.78 50539.08,-2061.53"/>
</g>
<!-- layer3_expert9_13 -->
<g id="node603" class="node">
<title>layer3_expert9_13</title>
<polygon fill="lightgreen" stroke="black" points="50896,-2058 50731,-2058 50731,-1975 50896,-1975 50896,-2058"/>
<text text-anchor="middle" x="50813.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU9</text>
<text text-anchor="middle" x="50813.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="50813.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="50813.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="50813.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_13 -->
<g id="edge1063" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50020.64,-2128.05C50212.22,-2117.12 50575.68,-2092.96 50720.77,-2058.15"/>
<polygon fill="black" stroke="black" points="50721.99,-2061.45 50730.83,-2055.62 50720.28,-2054.66 50721.99,-2061.45"/>
</g>
<!-- layer3_expert9_14 -->
<g id="node604" class="node">
<title>layer3_expert9_14</title>
<polygon fill="lightgreen" stroke="black" points="51079,-2058 50914,-2058 50914,-1975 51079,-1975 51079,-2058"/>
<text text-anchor="middle" x="50996.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU9</text>
<text text-anchor="middle" x="50996.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="50996.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="50996.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="50996.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_14 -->
<g id="edge1064" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50020.74,-2130.44C50246.86,-2122.08 50723.14,-2100.29 50903.92,-2058.1"/>
<polygon fill="black" stroke="black" points="50904.96,-2061.45 50913.85,-2055.68 50903.31,-2054.65 50904.96,-2061.45"/>
</g>
<!-- layer3_expert9_15 -->
<g id="node605" class="node">
<title>layer3_expert9_15</title>
<polygon fill="lightgreen" stroke="black" points="51262,-2058 51097,-2058 51097,-1975 51262,-1975 51262,-2058"/>
<text text-anchor="middle" x="51179.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU9</text>
<text text-anchor="middle" x="51179.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="51179.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="51179.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="51179.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_gate_gpu9&#45;&gt;layer3_expert9_15 -->
<g id="edge1065" class="edge">
<title>layer3_gate_gpu9&#45;&gt;layer3_expert9_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50020.95,-2132.1C50278.56,-2126.18 50870,-2107.75 51086.82,-2058.11"/>
<polygon fill="black" stroke="black" points="51087.94,-2061.44 51096.86,-2055.73 51086.32,-2054.63 51087.94,-2061.44"/>
</g>
<!-- layer3_moe_agg_gpu9 -->
<g id="node606" class="node">
<title>layer3_moe_agg_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="50091,-1939 49888,-1939 49888,-1856 50091,-1856 50091,-1939"/>
<text text-anchor="middle" x="49989.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU9</text>
<text text-anchor="middle" x="49989.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="49989.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="49989.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="49989.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_expert9_0&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge1066" class="edge">
<title>layer3_expert9_0&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M48517.02,-1977.53C48520.19,-1976.6 48523.36,-1975.75 48526.5,-1975 48782.66,-1914.09 49581.43,-1901.66 49877.56,-1899.14"/>
<polygon fill="black" stroke="black" points="49877.91,-1902.64 49887.88,-1899.05 49877.85,-1895.64 49877.91,-1902.64"/>
</g>
<!-- layer3_expert9_1&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge1067" class="edge">
<title>layer3_expert9_1&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M48700.03,-1977.56C48703.2,-1976.62 48706.36,-1975.76 48709.5,-1975 48929.55,-1921.81 49607.87,-1904.85 49877.4,-1900.13"/>
<polygon fill="black" stroke="black" points="49877.66,-1903.62 49887.6,-1899.95 49877.54,-1896.62 49877.66,-1903.62"/>
</g>
<!-- layer3_expert9_2&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge1068" class="edge">
<title>layer3_expert9_2&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M48883.04,-1977.6C48886.2,-1976.65 48889.37,-1975.77 48892.5,-1975 49076.82,-1929.47 49636.9,-1908.51 49877.6,-1901.43"/>
<polygon fill="black" stroke="black" points="49877.88,-1904.92 49887.78,-1901.13 49877.68,-1897.92 49877.88,-1904.92"/>
</g>
<!-- layer3_expert9_3&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge1069" class="edge">
<title>layer3_expert9_3&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M49066.05,-1977.66C49069.21,-1976.69 49072.37,-1975.8 49075.5,-1975 49224.39,-1937.12 49668.13,-1912.88 49877.63,-1903.24"/>
<polygon fill="black" stroke="black" points="49877.9,-1906.73 49887.73,-1902.78 49877.58,-1899.74 49877.9,-1906.73"/>
</g>
<!-- layer3_expert9_4&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge1070" class="edge">
<title>layer3_expert9_4&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M49249.07,-1977.74C49252.23,-1976.75 49255.38,-1975.83 49258.5,-1975 49472.58,-1918.17 49732.43,-1903.24 49877.56,-1899.51"/>
<polygon fill="black" stroke="black" points="49877.89,-1903 49887.8,-1899.26 49877.72,-1896.01 49877.89,-1903"/>
</g>
<!-- layer3_expert9_5&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge1071" class="edge">
<title>layer3_expert9_5&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M49432.11,-1977.88C49435.26,-1976.85 49438.39,-1975.88 49441.5,-1975 49588.91,-1933.14 49765.39,-1913.74 49877.47,-1905.07"/>
<polygon fill="black" stroke="black" points="49878.07,-1908.53 49887.78,-1904.29 49877.54,-1901.55 49878.07,-1908.53"/>
</g>
<!-- layer3_expert9_6&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge1072" class="edge">
<title>layer3_expert9_6&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M49615.19,-1978.15C49618.32,-1977.04 49621.43,-1975.99 49624.5,-1975 49707.66,-1948.3 49804.54,-1928.5 49877.58,-1915.74"/>
<polygon fill="black" stroke="black" points="49878.46,-1919.13 49887.72,-1913.98 49877.27,-1912.24 49878.46,-1919.13"/>
</g>
<!-- layer3_expert9_7&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge1073" class="edge">
<title>layer3_expert9_7&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M49798.22,-1979.01C49801.35,-1977.65 49804.45,-1976.31 49807.5,-1975 49831.79,-1964.55 49857.97,-1953.45 49882.69,-1943.04"/>
<polygon fill="black" stroke="black" points="49884.22,-1946.19 49892.09,-1939.09 49881.51,-1939.74 49884.22,-1946.19"/>
</g>
<!-- layer3_expert9_8&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge1074" class="edge">
<title>layer3_expert9_8&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M49930.07,-1974.91C49937.06,-1965.92 49944.53,-1956.32 49951.74,-1947.05"/>
<polygon fill="black" stroke="black" points="49954.61,-1949.06 49957.98,-1939.02 49949.08,-1944.77 49954.61,-1949.06"/>
</g>
<!-- layer3_expert9_9&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge1075" class="edge">
<title>layer3_expert9_9&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M50049.58,-1974.91C50042.52,-1965.92 50034.96,-1956.32 50027.68,-1947.05"/>
<polygon fill="black" stroke="black" points="50030.3,-1944.72 50021.36,-1939.02 50024.79,-1949.05 50030.3,-1944.72"/>
</g>
<!-- layer3_expert9_10&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge1076" class="edge">
<title>layer3_expert9_10&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M50181.71,-1978.55C50178.94,-1977.35 50176.2,-1976.16 50173.5,-1975 50149.13,-1964.51 50122.84,-1953.44 50097.98,-1943.08"/>
<polygon fill="black" stroke="black" points="50099.1,-1939.75 50088.52,-1939.14 50096.41,-1946.22 50099.1,-1939.75"/>
</g>
<!-- layer3_expert9_11&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge1077" class="edge">
<title>layer3_expert9_11&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M50364.97,-1977.87C50362.13,-1976.86 50359.3,-1975.9 50356.5,-1975 50272.64,-1947.94 50174.84,-1928.11 50101.3,-1915.42"/>
<polygon fill="black" stroke="black" points="50101.53,-1911.91 50091.08,-1913.68 50100.35,-1918.81 50101.53,-1911.91"/>
</g>
<!-- layer3_expert9_12&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge1078" class="edge">
<title>layer3_expert9_12&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M50547.79,-1977.54C50545.01,-1976.64 50542.24,-1975.78 50539.5,-1975 50391.26,-1932.62 50213.6,-1913.34 50101.12,-1904.83"/>
<polygon fill="black" stroke="black" points="50101.35,-1901.34 50091.11,-1904.09 50100.83,-1908.32 50101.35,-1901.34"/>
</g>
<!-- layer3_expert9_13&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge1079" class="edge">
<title>layer3_expert9_13&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M50730.82,-1977.42C50728.04,-1976.55 50725.26,-1975.74 50722.5,-1975 50507.79,-1917.57 50246.98,-1902.86 50101.48,-1899.33"/>
<polygon fill="black" stroke="black" points="50101.28,-1895.82 50091.2,-1899.09 50101.12,-1902.82 50101.28,-1895.82"/>
</g>
<!-- layer3_expert9_14&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge1080" class="edge">
<title>layer3_expert9_14&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M50913.84,-1977.34C50911.05,-1976.49 50908.26,-1975.71 50905.5,-1975 50756.26,-1936.73 50311.04,-1912.67 50101.23,-1903.16"/>
<polygon fill="black" stroke="black" points="50101.26,-1899.65 50091.12,-1902.7 50100.95,-1906.65 50101.26,-1899.65"/>
</g>
<!-- layer3_expert9_15&#45;&gt;layer3_moe_agg_gpu9 -->
<g id="edge1081" class="edge">
<title>layer3_expert9_15&#45;&gt;layer3_moe_agg_gpu9</title>
<path fill="none" stroke="black" d="M51096.86,-1977.29C51094.06,-1976.46 51091.27,-1975.69 51088.5,-1975 50903.94,-1929.03 50342.79,-1908.31 50101.61,-1901.36"/>
<polygon fill="black" stroke="black" points="50101.52,-1897.86 50091.42,-1901.07 50101.32,-1904.85 50101.52,-1897.86"/>
</g>
<!-- layer3_output_gpu9 -->
<g id="node607" class="node">
<title>layer3_output_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="56588.5,-1614 56344.5,-1614 56344.5,-1546 56588.5,-1546 56588.5,-1614"/>
<text text-anchor="middle" x="56466.5" y="-1598.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU9</text>
<text text-anchor="middle" x="56466.5" y="-1583.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="56466.5" y="-1568.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="56466.5" y="-1553.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_moe_agg_gpu9&#45;&gt;layer3_output_gpu9 -->
<g id="edge1082" class="edge">
<title>layer3_moe_agg_gpu9&#45;&gt;layer3_output_gpu9</title>
<path fill="none" stroke="black" d="M50091.14,-1890.07C50558.34,-1860.77 52546.61,-1739.02 54179.5,-1684 54299.23,-1679.97 56219.28,-1677.03 56335.5,-1648 56359.79,-1641.93 56384.68,-1630.69 56406.15,-1619.13"/>
<polygon fill="black" stroke="black" points="56408.07,-1622.07 56415.13,-1614.17 56404.69,-1615.94 56408.07,-1622.07"/>
</g>
<!-- layer3_moe_agg_gpu9&#45;&gt;layer3_allreduce_moe -->
<g id="edge1311" class="edge">
<title>layer3_moe_agg_gpu9&#45;&gt;layer3_allreduce_moe</title>
<path fill="none" stroke="black" d="M50091.13,-1894.46C50868.2,-1878.84 55867.28,-1778.38 56931.47,-1757"/>
<polygon fill="black" stroke="black" points="56931.59,-1760.5 56941.52,-1756.8 56931.45,-1753.5 56931.59,-1760.5"/>
</g>
<!-- layer3_output_gpu9&#45;&gt;output -->
<g id="edge1338" class="edge">
<title>layer3_output_gpu9&#45;&gt;output</title>
<path fill="none" stroke="black" d="M56523.12,-1545.84C56545.91,-1533.68 56572.84,-1520.76 56598.5,-1512 56702.49,-1476.51 56822.14,-1452.12 56922.43,-1436.03"/>
<polygon fill="black" stroke="black" points="56923.06,-1439.47 56932.39,-1434.45 56921.96,-1432.56 56923.06,-1439.47"/>
</g>
<!-- layer3_qkv_gpu10 -->
<g id="node608" class="node">
<title>layer3_qkv_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="56825.5,-2908 56615.5,-2908 56615.5,-2810 56825.5,-2810 56825.5,-2908"/>
<text text-anchor="middle" x="56720.5" y="-2892.8" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU10</text>
<text text-anchor="middle" x="56720.5" y="-2877.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="56720.5" y="-2862.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="56720.5" y="-2847.8" font-family="Times,serif" font-size="14.00">Heads: 8&#45;11</text>
<text text-anchor="middle" x="56720.5" y="-2832.8" font-family="Times,serif" font-size="14.00">TP Slice: 2</text>
<text text-anchor="middle" x="56720.5" y="-2817.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_attn_gpu10 -->
<g id="node609" class="node">
<title>layer3_attn_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="56846.5,-2766.5 56594.5,-2766.5 56594.5,-2683.5 56846.5,-2683.5 56846.5,-2766.5"/>
<text text-anchor="middle" x="56720.5" y="-2751.3" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU10</text>
<text text-anchor="middle" x="56720.5" y="-2736.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="56720.5" y="-2721.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="56720.5" y="-2706.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="56720.5" y="-2691.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_qkv_gpu10&#45;&gt;layer3_attn_gpu10 -->
<g id="edge1083" class="edge">
<title>layer3_qkv_gpu10&#45;&gt;layer3_attn_gpu10</title>
<path fill="none" stroke="black" d="M56720.5,-2809.97C56720.5,-2799.25 56720.5,-2787.84 56720.5,-2776.99"/>
<polygon fill="black" stroke="black" points="56724,-2776.82 56720.5,-2766.82 56717,-2776.82 56724,-2776.82"/>
</g>
<!-- layer3_attn_proj_gpu10 -->
<g id="node610" class="node">
<title>layer3_attn_proj_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="56825,-2632.5 56616,-2632.5 56616,-2564.5 56825,-2564.5 56825,-2632.5"/>
<text text-anchor="middle" x="56720.5" y="-2617.3" font-family="Times,serif" font-size="14.00">L3_Attn_Projection_GPU10</text>
<text text-anchor="middle" x="56720.5" y="-2602.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="56720.5" y="-2587.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="56720.5" y="-2572.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_attn_gpu10&#45;&gt;layer3_attn_proj_gpu10 -->
<g id="edge1084" class="edge">
<title>layer3_attn_gpu10&#45;&gt;layer3_attn_proj_gpu10</title>
<path fill="none" stroke="black" d="M56720.5,-2683.23C56720.5,-2670.36 56720.5,-2656.1 56720.5,-2643.04"/>
<polygon fill="black" stroke="black" points="56724,-2642.88 56720.5,-2632.88 56717,-2642.88 56724,-2642.88"/>
</g>
<!-- layer3_attn_norm_gpu10 -->
<g id="node611" class="node">
<title>layer3_attn_norm_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="56847,-2315 56594,-2315 56594,-2247 56847,-2247 56847,-2315"/>
<text text-anchor="middle" x="56720.5" y="-2299.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU10</text>
<text text-anchor="middle" x="56720.5" y="-2284.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="56720.5" y="-2269.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="56720.5" y="-2254.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_attn_proj_gpu10&#45;&gt;layer3_attn_norm_gpu10 -->
<g id="edge1085" class="edge">
<title>layer3_attn_proj_gpu10&#45;&gt;layer3_attn_norm_gpu10</title>
<path fill="none" stroke="black" d="M56720.5,-2564.33C56720.5,-2506.93 56720.5,-2389.12 56720.5,-2325.33"/>
<polygon fill="black" stroke="black" points="56724,-2325.2 56720.5,-2315.2 56717,-2325.2 56724,-2325.2"/>
</g>
<!-- layer3_attn_proj_gpu10&#45;&gt;layer3_allreduce_attn -->
<g id="edge1313" class="edge">
<title>layer3_attn_proj_gpu10&#45;&gt;layer3_allreduce_attn</title>
<path fill="none" stroke="black" d="M56792.24,-2564.4C56835.55,-2544.42 56891.2,-2518.73 56937.94,-2497.17"/>
<polygon fill="black" stroke="black" points="56939.55,-2500.28 56947.16,-2492.92 56936.61,-2493.93 56939.55,-2500.28"/>
</g>
<!-- layer3_gate_gpu10 -->
<g id="node612" class="node">
<title>layer3_gate_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="52948.5,-2177 52704.5,-2177 52704.5,-2094 52948.5,-2094 52948.5,-2177"/>
<text text-anchor="middle" x="52826.5" y="-2161.8" font-family="Times,serif" font-size="14.00">L3_Gate_GPU10</text>
<text text-anchor="middle" x="52826.5" y="-2146.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="52826.5" y="-2131.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="52826.5" y="-2116.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="52826.5" y="-2101.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_attn_norm_gpu10&#45;&gt;layer3_gate_gpu10 -->
<g id="edge1086" class="edge">
<title>layer3_attn_norm_gpu10&#45;&gt;layer3_gate_gpu10</title>
<path fill="none" stroke="black" d="M56667,-2246.88C56642.75,-2233.68 56613.14,-2219.98 56584.5,-2213 56494.65,-2191.1 53615.81,-2147.98 52959,-2138.41"/>
<polygon fill="black" stroke="black" points="52958.6,-2134.9 52948.55,-2138.26 52958.5,-2141.9 52958.6,-2134.9"/>
</g>
<!-- layer3_expert10_0 -->
<g id="node613" class="node">
<title>layer3_expert10_0</title>
<polygon fill="lightgreen" stroke="black" points="51445,-2058 51280,-2058 51280,-1975 51445,-1975 51445,-2058"/>
<text text-anchor="middle" x="51362.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU10</text>
<text text-anchor="middle" x="51362.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="51362.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="51362.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="51362.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_0 -->
<g id="edge1087" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52704.44,-2133.27C52418.09,-2129.51 51708.93,-2114.8 51454.95,-2057.76"/>
<polygon fill="black" stroke="black" points="51455.55,-2054.31 51445.02,-2055.45 51453.97,-2061.13 51455.55,-2054.31"/>
</g>
<!-- layer3_expert10_1 -->
<g id="node614" class="node">
<title>layer3_expert10_1</title>
<polygon fill="lightgreen" stroke="black" points="51628,-2058 51463,-2058 51463,-1975 51628,-1975 51628,-2058"/>
<text text-anchor="middle" x="51545.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU10</text>
<text text-anchor="middle" x="51545.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="51545.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="51545.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="51545.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_1 -->
<g id="edge1088" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52704.17,-2132.04C52446.68,-2125.99 51855.32,-2107.3 51637.79,-2057.73"/>
<polygon fill="black" stroke="black" points="51638.57,-2054.31 51628.03,-2055.42 51636.96,-2061.13 51638.57,-2054.31"/>
</g>
<!-- layer3_expert10_2 -->
<g id="node615" class="node">
<title>layer3_expert10_2</title>
<polygon fill="lightgreen" stroke="black" points="51811,-2058 51646,-2058 51646,-1975 51811,-1975 51811,-2058"/>
<text text-anchor="middle" x="51728.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU10</text>
<text text-anchor="middle" x="51728.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="51728.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="51728.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="51728.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_2 -->
<g id="edge1089" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52704.4,-2130.37C52478.52,-2121.9 52002.76,-2099.94 51821.03,-2057.78"/>
<polygon fill="black" stroke="black" points="51821.58,-2054.32 51811.04,-2055.37 51819.94,-2061.12 51821.58,-2054.32"/>
</g>
<!-- layer3_expert10_3 -->
<g id="node616" class="node">
<title>layer3_expert10_3</title>
<polygon fill="lightgreen" stroke="black" points="51994,-2058 51829,-2058 51829,-1975 51994,-1975 51994,-2058"/>
<text text-anchor="middle" x="51911.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU10</text>
<text text-anchor="middle" x="51911.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="51911.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="51911.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="51911.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_3 -->
<g id="edge1090" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52704.13,-2127.96C52512.69,-2116.93 52150.1,-2092.64 52004.18,-2057.83"/>
<polygon fill="black" stroke="black" points="52004.61,-2054.33 51994.06,-2055.3 52002.91,-2061.12 52004.61,-2054.33"/>
</g>
<!-- layer3_expert10_4 -->
<g id="node617" class="node">
<title>layer3_expert10_4</title>
<polygon fill="lightgreen" stroke="black" points="52177,-2058 52012,-2058 52012,-1975 52177,-1975 52177,-2058"/>
<text text-anchor="middle" x="52094.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU10</text>
<text text-anchor="middle" x="52094.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="52094.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="52094.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="52094.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_4 -->
<g id="edge1091" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52704.44,-2130.6C52576.41,-2124.1 52369.99,-2106.76 52186.89,-2057.85"/>
<polygon fill="black" stroke="black" points="52187.65,-2054.43 52177.09,-2055.2 52185.82,-2061.19 52187.65,-2054.43"/>
</g>
<!-- layer3_expert10_5 -->
<g id="node618" class="node">
<title>layer3_expert10_5</title>
<polygon fill="lightgreen" stroke="black" points="52360,-2058 52195,-2058 52195,-1975 52360,-1975 52360,-2058"/>
<text text-anchor="middle" x="52277.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU10</text>
<text text-anchor="middle" x="52277.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="52277.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="52277.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="52277.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_5 -->
<g id="edge1092" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52704.36,-2122.42C52613.76,-2111.52 52487.61,-2092.25 52370.04,-2057.94"/>
<polygon fill="black" stroke="black" points="52370.72,-2054.49 52360.14,-2055.01 52368.74,-2061.2 52370.72,-2054.49"/>
</g>
<!-- layer3_expert10_6 -->
<g id="node619" class="node">
<title>layer3_expert10_6</title>
<polygon fill="lightgreen" stroke="black" points="52543,-2058 52378,-2058 52378,-1975 52543,-1975 52543,-2058"/>
<text text-anchor="middle" x="52460.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU10</text>
<text text-anchor="middle" x="52460.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="52460.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="52460.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="52460.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_6 -->
<g id="edge1093" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52704.28,-2104.37C52656.46,-2091.55 52601.45,-2075.51 52552.5,-2058 52552.4,-2057.97 52552.3,-2057.93 52552.21,-2057.9"/>
<polygon fill="black" stroke="black" points="52553.62,-2054.69 52543.03,-2054.49 52551.19,-2061.25 52553.62,-2054.69"/>
</g>
<!-- layer3_expert10_7 -->
<g id="node620" class="node">
<title>layer3_expert10_7</title>
<polygon fill="lightgreen" stroke="black" points="52726,-2058 52561,-2058 52561,-1975 52726,-1975 52726,-2058"/>
<text text-anchor="middle" x="52643.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU10</text>
<text text-anchor="middle" x="52643.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="52643.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="52643.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="52643.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_7 -->
<g id="edge1094" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52763.01,-2093.91C52747.68,-2084.11 52731.19,-2073.56 52715.5,-2063.53"/>
<polygon fill="black" stroke="black" points="52717.19,-2060.46 52706.88,-2058.02 52713.42,-2066.36 52717.19,-2060.46"/>
</g>
<!-- layer3_expert10_8 -->
<g id="node621" class="node">
<title>layer3_expert10_8</title>
<polygon fill="lightgreen" stroke="black" points="52909,-2058 52744,-2058 52744,-1975 52909,-1975 52909,-2058"/>
<text text-anchor="middle" x="52826.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU10</text>
<text text-anchor="middle" x="52826.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="52826.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="52826.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="52826.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_8 -->
<g id="edge1095" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52826.5,-2093.91C52826.5,-2085.65 52826.5,-2076.86 52826.5,-2068.3"/>
<polygon fill="black" stroke="black" points="52830,-2068.02 52826.5,-2058.02 52823,-2068.02 52830,-2068.02"/>
</g>
<!-- layer3_expert10_9 -->
<g id="node622" class="node">
<title>layer3_expert10_9</title>
<polygon fill="lightgreen" stroke="black" points="53092,-2058 52927,-2058 52927,-1975 53092,-1975 53092,-2058"/>
<text text-anchor="middle" x="53009.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU10</text>
<text text-anchor="middle" x="53009.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="53009.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="53009.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="53009.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_9 -->
<g id="edge1096" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52889.99,-2093.91C52905.32,-2084.11 52921.81,-2073.56 52937.5,-2063.53"/>
<polygon fill="black" stroke="black" points="52939.58,-2066.36 52946.12,-2058.02 52935.81,-2060.46 52939.58,-2066.36"/>
</g>
<!-- layer3_expert10_10 -->
<g id="node623" class="node">
<title>layer3_expert10_10</title>
<polygon fill="lightgreen" stroke="black" points="53275,-2058 53110,-2058 53110,-1975 53275,-1975 53275,-2058"/>
<text text-anchor="middle" x="53192.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU10</text>
<text text-anchor="middle" x="53192.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="53192.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="53192.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="53192.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_10 -->
<g id="edge1097" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52948.53,-2104.69C52994.05,-2092.56 53046.13,-2077.48 53100.44,-2058.26"/>
<polygon fill="black" stroke="black" points="53101.65,-2061.55 53109.88,-2054.89 53099.29,-2054.96 53101.65,-2061.55"/>
</g>
<!-- layer3_expert10_11 -->
<g id="node624" class="node">
<title>layer3_expert10_11</title>
<polygon fill="lightgreen" stroke="black" points="53458,-2058 53293,-2058 53293,-1975 53458,-1975 53458,-2058"/>
<text text-anchor="middle" x="53375.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU10</text>
<text text-anchor="middle" x="53375.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="53375.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="53375.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="53375.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_11 -->
<g id="edge1098" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52948.95,-2122.58C53039.76,-2111.76 53166.19,-2092.52 53282.94,-2058.28"/>
<polygon fill="black" stroke="black" points="53284.17,-2061.57 53292.76,-2055.36 53282.18,-2054.86 53284.17,-2061.57"/>
</g>
<!-- layer3_expert10_12 -->
<g id="node625" class="node">
<title>layer3_expert10_12</title>
<polygon fill="lightgreen" stroke="black" points="53641,-2058 53476,-2058 53476,-1975 53641,-1975 53641,-2058"/>
<text text-anchor="middle" x="53558.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU10</text>
<text text-anchor="middle" x="53558.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="53558.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="53558.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="53558.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_12 -->
<g id="edge1099" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52948.79,-2130.77C53077.05,-2124.4 53283.82,-2107.17 53466.05,-2058.19"/>
<polygon fill="black" stroke="black" points="53467.08,-2061.53 53475.81,-2055.53 53465.24,-2054.78 53467.08,-2061.53"/>
</g>
<!-- layer3_expert10_13 -->
<g id="node626" class="node">
<title>layer3_expert10_13</title>
<polygon fill="lightgreen" stroke="black" points="53824,-2058 53659,-2058 53659,-1975 53824,-1975 53824,-2058"/>
<text text-anchor="middle" x="53741.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU10</text>
<text text-anchor="middle" x="53741.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="53741.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="53741.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="53741.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_13 -->
<g id="edge1100" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52948.64,-2128.05C53140.22,-2117.12 53503.68,-2092.96 53648.77,-2058.15"/>
<polygon fill="black" stroke="black" points="53649.99,-2061.45 53658.83,-2055.62 53648.28,-2054.66 53649.99,-2061.45"/>
</g>
<!-- layer3_expert10_14 -->
<g id="node627" class="node">
<title>layer3_expert10_14</title>
<polygon fill="lightgreen" stroke="black" points="54007,-2058 53842,-2058 53842,-1975 54007,-1975 54007,-2058"/>
<text text-anchor="middle" x="53924.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU10</text>
<text text-anchor="middle" x="53924.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="53924.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="53924.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="53924.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_14 -->
<g id="edge1101" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52948.74,-2130.44C53174.86,-2122.08 53651.14,-2100.29 53831.92,-2058.1"/>
<polygon fill="black" stroke="black" points="53832.96,-2061.45 53841.85,-2055.68 53831.31,-2054.65 53832.96,-2061.45"/>
</g>
<!-- layer3_expert10_15 -->
<g id="node628" class="node">
<title>layer3_expert10_15</title>
<polygon fill="lightgreen" stroke="black" points="54190,-2058 54025,-2058 54025,-1975 54190,-1975 54190,-2058"/>
<text text-anchor="middle" x="54107.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU10</text>
<text text-anchor="middle" x="54107.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="54107.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="54107.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="54107.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_gate_gpu10&#45;&gt;layer3_expert10_15 -->
<g id="edge1102" class="edge">
<title>layer3_gate_gpu10&#45;&gt;layer3_expert10_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52948.95,-2132.1C53206.56,-2126.18 53798,-2107.75 54014.82,-2058.11"/>
<polygon fill="black" stroke="black" points="54015.94,-2061.44 54024.86,-2055.73 54014.32,-2054.63 54015.94,-2061.44"/>
</g>
<!-- layer3_moe_agg_gpu10 -->
<g id="node629" class="node">
<title>layer3_moe_agg_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="53023.5,-1939 52811.5,-1939 52811.5,-1856 53023.5,-1856 53023.5,-1939"/>
<text text-anchor="middle" x="52917.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU10</text>
<text text-anchor="middle" x="52917.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="52917.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="52917.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="52917.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_expert10_0&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge1103" class="edge">
<title>layer3_expert10_0&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M51445.02,-1977.53C51448.19,-1976.6 51451.36,-1975.75 51454.5,-1975 51709.48,-1914.36 52502.12,-1901.78 52801.46,-1899.18"/>
<polygon fill="black" stroke="black" points="52801.5,-1902.68 52811.47,-1899.09 52801.44,-1895.68 52801.5,-1902.68"/>
</g>
<!-- layer3_expert10_1&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge1104" class="edge">
<title>layer3_expert10_1&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M51628.03,-1977.56C51631.2,-1976.62 51634.36,-1975.76 51637.5,-1975 51856.35,-1922.1 52528.47,-1905.03 52800.95,-1900.2"/>
<polygon fill="black" stroke="black" points="52801.32,-1903.7 52811.26,-1900.02 52801.2,-1896.7 52801.32,-1903.7"/>
</g>
<!-- layer3_expert10_2&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge1105" class="edge">
<title>layer3_expert10_2&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M51811.04,-1977.6C51814.2,-1976.65 51817.37,-1975.77 51820.5,-1975 52003.68,-1929.75 52557.97,-1908.77 52801.09,-1901.56"/>
<polygon fill="black" stroke="black" points="52801.48,-1905.05 52811.38,-1901.26 52801.28,-1898.05 52801.48,-1905.05"/>
</g>
<!-- layer3_expert10_3&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge1106" class="edge">
<title>layer3_expert10_3&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M51994.05,-1977.66C51997.21,-1976.69 52000.37,-1975.8 52003.5,-1975 52151.35,-1937.39 52589.92,-1913.22 52801.18,-1903.45"/>
<polygon fill="black" stroke="black" points="52801.55,-1906.93 52811.38,-1902.98 52801.23,-1899.94 52801.55,-1906.93"/>
</g>
<!-- layer3_expert10_4&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge1107" class="edge">
<title>layer3_expert10_4&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M52177.07,-1977.74C52180.23,-1976.75 52183.38,-1975.83 52186.5,-1975 52398.32,-1918.77 52654.96,-1903.55 52800.93,-1899.63"/>
<polygon fill="black" stroke="black" points="52801.34,-1903.12 52811.24,-1899.37 52801.16,-1896.13 52801.34,-1903.12"/>
</g>
<!-- layer3_expert10_5&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge1108" class="edge">
<title>layer3_expert10_5&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M52360.11,-1977.88C52363.26,-1976.85 52366.39,-1975.88 52369.5,-1975 52515.15,-1933.64 52689.18,-1914.21 52801.44,-1905.38"/>
<polygon fill="black" stroke="black" points="52801.73,-1908.87 52811.43,-1904.61 52801.19,-1901.89 52801.73,-1908.87"/>
</g>
<!-- layer3_expert10_6&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge1109" class="edge">
<title>layer3_expert10_6&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M52543.19,-1978.15C52546.32,-1977.04 52549.43,-1975.99 52552.5,-1975 52634.04,-1948.82 52728.77,-1929.27 52801.28,-1916.49"/>
<polygon fill="black" stroke="black" points="52802.12,-1919.9 52811.37,-1914.73 52800.91,-1913 52802.12,-1919.9"/>
</g>
<!-- layer3_expert10_7&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge1110" class="edge">
<title>layer3_expert10_7&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M52726.22,-1979.01C52729.35,-1977.65 52732.45,-1976.31 52735.5,-1975 52759.79,-1964.55 52785.97,-1953.45 52810.69,-1943.04"/>
<polygon fill="black" stroke="black" points="52812.22,-1946.19 52820.09,-1939.09 52809.51,-1939.74 52812.22,-1946.19"/>
</g>
<!-- layer3_expert10_8&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge1111" class="edge">
<title>layer3_expert10_8&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M52858.07,-1974.91C52865.06,-1965.92 52872.53,-1956.32 52879.74,-1947.05"/>
<polygon fill="black" stroke="black" points="52882.61,-1949.06 52885.98,-1939.02 52877.08,-1944.77 52882.61,-1949.06"/>
</g>
<!-- layer3_expert10_9&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge1112" class="edge">
<title>layer3_expert10_9&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M52977.58,-1974.91C52970.52,-1965.92 52962.96,-1956.32 52955.68,-1947.05"/>
<polygon fill="black" stroke="black" points="52958.3,-1944.72 52949.36,-1939.02 52952.79,-1949.05 52958.3,-1944.72"/>
</g>
<!-- layer3_expert10_10&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge1113" class="edge">
<title>layer3_expert10_10&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M53109.71,-1978.55C53106.94,-1977.35 53104.2,-1976.16 53101.5,-1975 53077.13,-1964.51 53050.84,-1953.44 53025.98,-1943.08"/>
<polygon fill="black" stroke="black" points="53027.1,-1939.75 53016.52,-1939.14 53024.41,-1946.22 53027.1,-1939.75"/>
</g>
<!-- layer3_expert10_11&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge1114" class="edge">
<title>layer3_expert10_11&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M53292.97,-1977.87C53290.13,-1976.86 53287.3,-1975.9 53284.5,-1975 53202.42,-1948.52 53106.98,-1928.95 53034,-1916.24"/>
<polygon fill="black" stroke="black" points="53034.3,-1912.74 53023.85,-1914.49 53033.11,-1919.64 53034.3,-1912.74"/>
</g>
<!-- layer3_expert10_12&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge1115" class="edge">
<title>layer3_expert10_12&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M53475.79,-1977.54C53473.01,-1976.64 53470.24,-1975.78 53467.5,-1975 53321.29,-1933.2 53146.44,-1913.87 53033.76,-1905.18"/>
<polygon fill="black" stroke="black" points="53033.97,-1901.69 53023.73,-1904.43 53033.44,-1908.67 53033.97,-1901.69"/>
</g>
<!-- layer3_expert10_13&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge1116" class="edge">
<title>layer3_expert10_13&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M53658.82,-1977.42C53656.04,-1976.55 53653.26,-1975.74 53650.5,-1975 53438.06,-1918.18 53180.47,-1903.17 53034.12,-1899.44"/>
<polygon fill="black" stroke="black" points="53033.86,-1895.94 53023.77,-1899.2 53033.69,-1902.94 53033.86,-1895.94"/>
</g>
<!-- layer3_expert10_14&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge1117" class="edge">
<title>layer3_expert10_14&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M53841.84,-1977.34C53839.05,-1976.49 53836.26,-1975.71 53833.5,-1975 53685.4,-1937.02 53245.83,-1913.04 53034.08,-1903.38"/>
<polygon fill="black" stroke="black" points="53034.01,-1899.87 53023.87,-1902.91 53033.7,-1906.86 53034.01,-1899.87"/>
</g>
<!-- layer3_expert10_15&#45;&gt;layer3_moe_agg_gpu10 -->
<g id="edge1118" class="edge">
<title>layer3_expert10_15&#45;&gt;layer3_moe_agg_gpu10</title>
<path fill="none" stroke="black" d="M54024.86,-1977.29C54022.06,-1976.46 54019.27,-1975.69 54016.5,-1975 53833.08,-1929.31 53277.72,-1908.57 53034.13,-1901.49"/>
<polygon fill="black" stroke="black" points="53033.93,-1897.98 53023.83,-1901.19 53033.73,-1904.98 53033.93,-1897.98"/>
</g>
<!-- layer3_output_gpu10 -->
<g id="node630" class="node">
<title>layer3_output_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="56860,-1614 56607,-1614 56607,-1546 56860,-1546 56860,-1614"/>
<text text-anchor="middle" x="56733.5" y="-1598.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU10</text>
<text text-anchor="middle" x="56733.5" y="-1583.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="56733.5" y="-1568.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="56733.5" y="-1553.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_moe_agg_gpu10&#45;&gt;layer3_output_gpu10 -->
<g id="edge1119" class="edge">
<title>layer3_moe_agg_gpu10&#45;&gt;layer3_output_gpu10</title>
<path fill="none" stroke="black" d="M53023.81,-1889.89C53618.43,-1852.85 56508.75,-1671.86 56597.5,-1648 56622.19,-1641.36 56647.72,-1630.12 56669.9,-1618.72"/>
<polygon fill="black" stroke="black" points="56671.64,-1621.76 56678.86,-1614.01 56668.38,-1615.56 56671.64,-1621.76"/>
</g>
<!-- layer3_moe_agg_gpu10&#45;&gt;layer3_allreduce_moe -->
<g id="edge1315" class="edge">
<title>layer3_moe_agg_gpu10&#45;&gt;layer3_allreduce_moe</title>
<path fill="none" stroke="black" d="M53023.75,-1892.88C53584.78,-1873.77 56204.53,-1784.54 56938.77,-1759.53"/>
<polygon fill="black" stroke="black" points="56939.03,-1763.02 56948.91,-1759.19 56938.79,-1756.03 56939.03,-1763.02"/>
</g>
<!-- layer3_output_gpu10&#45;&gt;output -->
<g id="edge1339" class="edge">
<title>layer3_output_gpu10&#45;&gt;output</title>
<path fill="none" stroke="black" d="M56797.6,-1545.89C56820.12,-1534.67 56845.73,-1522.36 56869.5,-1512 56922.75,-1488.79 56983.07,-1465.5 57033.16,-1446.96"/>
<polygon fill="black" stroke="black" points="57034.54,-1450.18 57042.71,-1443.43 57032.12,-1443.61 57034.54,-1450.18"/>
</g>
<!-- layer3_qkv_gpu11 -->
<g id="node631" class="node">
<title>layer3_qkv_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="57096.5,-2908 56886.5,-2908 56886.5,-2810 57096.5,-2810 57096.5,-2908"/>
<text text-anchor="middle" x="56991.5" y="-2892.8" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU11</text>
<text text-anchor="middle" x="56991.5" y="-2877.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="56991.5" y="-2862.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="56991.5" y="-2847.8" font-family="Times,serif" font-size="14.00">Heads: 12&#45;15</text>
<text text-anchor="middle" x="56991.5" y="-2832.8" font-family="Times,serif" font-size="14.00">TP Slice: 3</text>
<text text-anchor="middle" x="56991.5" y="-2817.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_attn_gpu11 -->
<g id="node632" class="node">
<title>layer3_attn_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="57117.5,-2766.5 56865.5,-2766.5 56865.5,-2683.5 57117.5,-2683.5 57117.5,-2766.5"/>
<text text-anchor="middle" x="56991.5" y="-2751.3" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU11</text>
<text text-anchor="middle" x="56991.5" y="-2736.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="56991.5" y="-2721.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="56991.5" y="-2706.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="56991.5" y="-2691.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_qkv_gpu11&#45;&gt;layer3_attn_gpu11 -->
<g id="edge1120" class="edge">
<title>layer3_qkv_gpu11&#45;&gt;layer3_attn_gpu11</title>
<path fill="none" stroke="black" d="M56991.5,-2809.97C56991.5,-2799.25 56991.5,-2787.84 56991.5,-2776.99"/>
<polygon fill="black" stroke="black" points="56995,-2776.82 56991.5,-2766.82 56988,-2776.82 56995,-2776.82"/>
</g>
<!-- layer3_attn_proj_gpu11 -->
<g id="node633" class="node">
<title>layer3_attn_proj_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="57096,-2632.5 56887,-2632.5 56887,-2564.5 57096,-2564.5 57096,-2632.5"/>
<text text-anchor="middle" x="56991.5" y="-2617.3" font-family="Times,serif" font-size="14.00">L3_Attn_Projection_GPU11</text>
<text text-anchor="middle" x="56991.5" y="-2602.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="56991.5" y="-2587.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="56991.5" y="-2572.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_attn_gpu11&#45;&gt;layer3_attn_proj_gpu11 -->
<g id="edge1121" class="edge">
<title>layer3_attn_gpu11&#45;&gt;layer3_attn_proj_gpu11</title>
<path fill="none" stroke="black" d="M56991.5,-2683.23C56991.5,-2670.36 56991.5,-2656.1 56991.5,-2643.04"/>
<polygon fill="black" stroke="black" points="56995,-2642.88 56991.5,-2632.88 56988,-2642.88 56995,-2642.88"/>
</g>
<!-- layer3_attn_norm_gpu11 -->
<g id="node634" class="node">
<title>layer3_attn_norm_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="57118,-2315 56865,-2315 56865,-2247 57118,-2247 57118,-2315"/>
<text text-anchor="middle" x="56991.5" y="-2299.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU11</text>
<text text-anchor="middle" x="56991.5" y="-2284.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="56991.5" y="-2269.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="56991.5" y="-2254.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_attn_proj_gpu11&#45;&gt;layer3_attn_norm_gpu11 -->
<g id="edge1122" class="edge">
<title>layer3_attn_proj_gpu11&#45;&gt;layer3_attn_norm_gpu11</title>
<path fill="none" stroke="black" d="M56886.74,-2573.06C56860.39,-2561.69 56835.17,-2545.12 56819.5,-2521 56786.57,-2470.31 56789.7,-2437.59 56819.5,-2385 56830.35,-2365.86 56872.44,-2340.5 56912.26,-2319.73"/>
<polygon fill="black" stroke="black" points="56913.96,-2322.8 56921.24,-2315.11 56910.75,-2316.57 56913.96,-2322.8"/>
</g>
<!-- layer3_attn_proj_gpu11&#45;&gt;layer3_allreduce_attn -->
<g id="edge1317" class="edge">
<title>layer3_attn_proj_gpu11&#45;&gt;layer3_allreduce_attn</title>
<path fill="none" stroke="black" d="M57000.78,-2564.22C57004.03,-2552.56 57007.81,-2538.97 57011.6,-2525.41"/>
<polygon fill="black" stroke="black" points="57015.03,-2526.13 57014.34,-2515.56 57008.28,-2524.25 57015.03,-2526.13"/>
</g>
<!-- layer3_gate_gpu11 -->
<g id="node635" class="node">
<title>layer3_gate_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="55876.5,-2177 55632.5,-2177 55632.5,-2094 55876.5,-2094 55876.5,-2177"/>
<text text-anchor="middle" x="55754.5" y="-2161.8" font-family="Times,serif" font-size="14.00">L3_Gate_GPU11</text>
<text text-anchor="middle" x="55754.5" y="-2146.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="55754.5" y="-2131.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="55754.5" y="-2116.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="55754.5" y="-2101.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_attn_norm_gpu11&#45;&gt;layer3_gate_gpu11 -->
<g id="edge1123" class="edge">
<title>layer3_attn_norm_gpu11&#45;&gt;layer3_gate_gpu11</title>
<path fill="none" stroke="black" d="M56936.96,-2246.84C56913.11,-2233.97 56884.28,-2220.54 56856.5,-2213 56677.37,-2164.39 56139.09,-2145.55 55887.2,-2139.26"/>
<polygon fill="black" stroke="black" points="55886.97,-2135.75 55876.89,-2139 55886.8,-2142.75 55886.97,-2135.75"/>
</g>
<!-- layer3_expert11_0 -->
<g id="node636" class="node">
<title>layer3_expert11_0</title>
<polygon fill="lightgreen" stroke="black" points="54373,-2058 54208,-2058 54208,-1975 54373,-1975 54373,-2058"/>
<text text-anchor="middle" x="54290.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU11</text>
<text text-anchor="middle" x="54290.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="54290.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="54290.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="54290.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_0 -->
<g id="edge1124" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55632.44,-2133.27C55346.09,-2129.51 54636.93,-2114.8 54382.95,-2057.76"/>
<polygon fill="black" stroke="black" points="54383.55,-2054.31 54373.02,-2055.45 54381.97,-2061.13 54383.55,-2054.31"/>
</g>
<!-- layer3_expert11_1 -->
<g id="node637" class="node">
<title>layer3_expert11_1</title>
<polygon fill="lightgreen" stroke="black" points="54556,-2058 54391,-2058 54391,-1975 54556,-1975 54556,-2058"/>
<text text-anchor="middle" x="54473.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU11</text>
<text text-anchor="middle" x="54473.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="54473.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="54473.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="54473.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_1 -->
<g id="edge1125" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55632.17,-2132.04C55374.68,-2125.99 54783.32,-2107.3 54565.79,-2057.73"/>
<polygon fill="black" stroke="black" points="54566.57,-2054.31 54556.03,-2055.42 54564.96,-2061.13 54566.57,-2054.31"/>
</g>
<!-- layer3_expert11_2 -->
<g id="node638" class="node">
<title>layer3_expert11_2</title>
<polygon fill="lightgreen" stroke="black" points="54739,-2058 54574,-2058 54574,-1975 54739,-1975 54739,-2058"/>
<text text-anchor="middle" x="54656.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU11</text>
<text text-anchor="middle" x="54656.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="54656.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="54656.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="54656.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_2 -->
<g id="edge1126" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55632.4,-2130.37C55406.52,-2121.9 54930.76,-2099.94 54749.03,-2057.78"/>
<polygon fill="black" stroke="black" points="54749.58,-2054.32 54739.04,-2055.37 54747.94,-2061.12 54749.58,-2054.32"/>
</g>
<!-- layer3_expert11_3 -->
<g id="node639" class="node">
<title>layer3_expert11_3</title>
<polygon fill="lightgreen" stroke="black" points="54922,-2058 54757,-2058 54757,-1975 54922,-1975 54922,-2058"/>
<text text-anchor="middle" x="54839.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU11</text>
<text text-anchor="middle" x="54839.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="54839.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="54839.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="54839.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_3 -->
<g id="edge1127" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55632.13,-2127.96C55440.69,-2116.93 55078.1,-2092.64 54932.18,-2057.83"/>
<polygon fill="black" stroke="black" points="54932.61,-2054.33 54922.06,-2055.3 54930.91,-2061.12 54932.61,-2054.33"/>
</g>
<!-- layer3_expert11_4 -->
<g id="node640" class="node">
<title>layer3_expert11_4</title>
<polygon fill="lightgreen" stroke="black" points="55105,-2058 54940,-2058 54940,-1975 55105,-1975 55105,-2058"/>
<text text-anchor="middle" x="55022.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU11</text>
<text text-anchor="middle" x="55022.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="55022.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="55022.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="55022.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_4 -->
<g id="edge1128" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55632.44,-2130.6C55504.41,-2124.1 55297.99,-2106.76 55114.89,-2057.85"/>
<polygon fill="black" stroke="black" points="55115.65,-2054.43 55105.09,-2055.2 55113.82,-2061.19 55115.65,-2054.43"/>
</g>
<!-- layer3_expert11_5 -->
<g id="node641" class="node">
<title>layer3_expert11_5</title>
<polygon fill="lightgreen" stroke="black" points="55288,-2058 55123,-2058 55123,-1975 55288,-1975 55288,-2058"/>
<text text-anchor="middle" x="55205.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU11</text>
<text text-anchor="middle" x="55205.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="55205.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="55205.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="55205.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_5 -->
<g id="edge1129" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55632.36,-2122.42C55541.76,-2111.52 55415.61,-2092.25 55298.04,-2057.94"/>
<polygon fill="black" stroke="black" points="55298.72,-2054.49 55288.14,-2055.01 55296.74,-2061.2 55298.72,-2054.49"/>
</g>
<!-- layer3_expert11_6 -->
<g id="node642" class="node">
<title>layer3_expert11_6</title>
<polygon fill="lightgreen" stroke="black" points="55471,-2058 55306,-2058 55306,-1975 55471,-1975 55471,-2058"/>
<text text-anchor="middle" x="55388.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU11</text>
<text text-anchor="middle" x="55388.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="55388.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="55388.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="55388.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_6 -->
<g id="edge1130" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55632.28,-2104.37C55584.46,-2091.55 55529.45,-2075.51 55480.5,-2058 55480.4,-2057.97 55480.3,-2057.93 55480.21,-2057.9"/>
<polygon fill="black" stroke="black" points="55481.62,-2054.69 55471.03,-2054.49 55479.19,-2061.25 55481.62,-2054.69"/>
</g>
<!-- layer3_expert11_7 -->
<g id="node643" class="node">
<title>layer3_expert11_7</title>
<polygon fill="lightgreen" stroke="black" points="55654,-2058 55489,-2058 55489,-1975 55654,-1975 55654,-2058"/>
<text text-anchor="middle" x="55571.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU11</text>
<text text-anchor="middle" x="55571.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="55571.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="55571.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="55571.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_7 -->
<g id="edge1131" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55691.01,-2093.91C55675.68,-2084.11 55659.19,-2073.56 55643.5,-2063.53"/>
<polygon fill="black" stroke="black" points="55645.19,-2060.46 55634.88,-2058.02 55641.42,-2066.36 55645.19,-2060.46"/>
</g>
<!-- layer3_expert11_8 -->
<g id="node644" class="node">
<title>layer3_expert11_8</title>
<polygon fill="lightgreen" stroke="black" points="55837,-2058 55672,-2058 55672,-1975 55837,-1975 55837,-2058"/>
<text text-anchor="middle" x="55754.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU11</text>
<text text-anchor="middle" x="55754.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="55754.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="55754.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="55754.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_8 -->
<g id="edge1132" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55754.5,-2093.91C55754.5,-2085.65 55754.5,-2076.86 55754.5,-2068.3"/>
<polygon fill="black" stroke="black" points="55758,-2068.02 55754.5,-2058.02 55751,-2068.02 55758,-2068.02"/>
</g>
<!-- layer3_expert11_9 -->
<g id="node645" class="node">
<title>layer3_expert11_9</title>
<polygon fill="lightgreen" stroke="black" points="56020,-2058 55855,-2058 55855,-1975 56020,-1975 56020,-2058"/>
<text text-anchor="middle" x="55937.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU11</text>
<text text-anchor="middle" x="55937.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="55937.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="55937.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="55937.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_9 -->
<g id="edge1133" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55817.99,-2093.91C55833.32,-2084.11 55849.81,-2073.56 55865.5,-2063.53"/>
<polygon fill="black" stroke="black" points="55867.58,-2066.36 55874.12,-2058.02 55863.81,-2060.46 55867.58,-2066.36"/>
</g>
<!-- layer3_expert11_10 -->
<g id="node646" class="node">
<title>layer3_expert11_10</title>
<polygon fill="lightgreen" stroke="black" points="56203,-2058 56038,-2058 56038,-1975 56203,-1975 56203,-2058"/>
<text text-anchor="middle" x="56120.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU11</text>
<text text-anchor="middle" x="56120.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="56120.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="56120.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="56120.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_10 -->
<g id="edge1134" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55876.53,-2104.69C55922.05,-2092.56 55974.13,-2077.48 56028.44,-2058.26"/>
<polygon fill="black" stroke="black" points="56029.65,-2061.55 56037.88,-2054.89 56027.29,-2054.96 56029.65,-2061.55"/>
</g>
<!-- layer3_expert11_11 -->
<g id="node647" class="node">
<title>layer3_expert11_11</title>
<polygon fill="lightgreen" stroke="black" points="56386,-2058 56221,-2058 56221,-1975 56386,-1975 56386,-2058"/>
<text text-anchor="middle" x="56303.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU11</text>
<text text-anchor="middle" x="56303.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="56303.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="56303.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="56303.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_11 -->
<g id="edge1135" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55876.95,-2122.58C55967.76,-2111.76 56094.19,-2092.52 56210.94,-2058.28"/>
<polygon fill="black" stroke="black" points="56212.17,-2061.57 56220.76,-2055.36 56210.18,-2054.86 56212.17,-2061.57"/>
</g>
<!-- layer3_expert11_12 -->
<g id="node648" class="node">
<title>layer3_expert11_12</title>
<polygon fill="lightgreen" stroke="black" points="56569,-2058 56404,-2058 56404,-1975 56569,-1975 56569,-2058"/>
<text text-anchor="middle" x="56486.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU11</text>
<text text-anchor="middle" x="56486.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="56486.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="56486.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="56486.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_12 -->
<g id="edge1136" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55876.79,-2130.77C56005.05,-2124.4 56211.82,-2107.17 56394.05,-2058.19"/>
<polygon fill="black" stroke="black" points="56395.08,-2061.53 56403.81,-2055.53 56393.24,-2054.78 56395.08,-2061.53"/>
</g>
<!-- layer3_expert11_13 -->
<g id="node649" class="node">
<title>layer3_expert11_13</title>
<polygon fill="lightgreen" stroke="black" points="56752,-2058 56587,-2058 56587,-1975 56752,-1975 56752,-2058"/>
<text text-anchor="middle" x="56669.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU11</text>
<text text-anchor="middle" x="56669.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="56669.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="56669.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="56669.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_13 -->
<g id="edge1137" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55876.64,-2128.05C56068.22,-2117.12 56431.68,-2092.96 56576.77,-2058.15"/>
<polygon fill="black" stroke="black" points="56577.99,-2061.45 56586.83,-2055.62 56576.28,-2054.66 56577.99,-2061.45"/>
</g>
<!-- layer3_expert11_14 -->
<g id="node650" class="node">
<title>layer3_expert11_14</title>
<polygon fill="lightgreen" stroke="black" points="56935,-2058 56770,-2058 56770,-1975 56935,-1975 56935,-2058"/>
<text text-anchor="middle" x="56852.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU11</text>
<text text-anchor="middle" x="56852.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="56852.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="56852.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="56852.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_14 -->
<g id="edge1138" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55876.74,-2130.44C56102.86,-2122.08 56579.14,-2100.29 56759.92,-2058.1"/>
<polygon fill="black" stroke="black" points="56760.96,-2061.45 56769.85,-2055.68 56759.31,-2054.65 56760.96,-2061.45"/>
</g>
<!-- layer3_expert11_15 -->
<g id="node651" class="node">
<title>layer3_expert11_15</title>
<polygon fill="lightgreen" stroke="black" points="57118,-2058 56953,-2058 56953,-1975 57118,-1975 57118,-2058"/>
<text text-anchor="middle" x="57035.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU11</text>
<text text-anchor="middle" x="57035.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="57035.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="57035.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="57035.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_gate_gpu11&#45;&gt;layer3_expert11_15 -->
<g id="edge1139" class="edge">
<title>layer3_gate_gpu11&#45;&gt;layer3_expert11_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M55876.95,-2132.1C56134.56,-2126.18 56726,-2107.75 56942.82,-2058.11"/>
<polygon fill="black" stroke="black" points="56943.94,-2061.44 56952.86,-2055.73 56942.32,-2054.63 56943.94,-2061.44"/>
</g>
<!-- layer3_moe_agg_gpu11 -->
<g id="node652" class="node">
<title>layer3_moe_agg_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="55951.5,-1939 55739.5,-1939 55739.5,-1856 55951.5,-1856 55951.5,-1939"/>
<text text-anchor="middle" x="55845.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU11</text>
<text text-anchor="middle" x="55845.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="55845.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="55845.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="55845.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_expert11_0&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1140" class="edge">
<title>layer3_expert11_0&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M54373.02,-1977.53C54376.19,-1976.6 54379.36,-1975.75 54382.5,-1975 54637.48,-1914.36 55430.12,-1901.78 55729.46,-1899.18"/>
<polygon fill="black" stroke="black" points="55729.5,-1902.68 55739.47,-1899.09 55729.44,-1895.68 55729.5,-1902.68"/>
</g>
<!-- layer3_expert11_1&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1141" class="edge">
<title>layer3_expert11_1&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M54556.03,-1977.56C54559.2,-1976.62 54562.36,-1975.76 54565.5,-1975 54784.35,-1922.1 55456.47,-1905.03 55728.95,-1900.2"/>
<polygon fill="black" stroke="black" points="55729.32,-1903.7 55739.26,-1900.02 55729.2,-1896.7 55729.32,-1903.7"/>
</g>
<!-- layer3_expert11_2&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1142" class="edge">
<title>layer3_expert11_2&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M54739.04,-1977.6C54742.2,-1976.65 54745.37,-1975.77 54748.5,-1975 54931.68,-1929.75 55485.97,-1908.77 55729.09,-1901.56"/>
<polygon fill="black" stroke="black" points="55729.48,-1905.05 55739.38,-1901.26 55729.28,-1898.05 55729.48,-1905.05"/>
</g>
<!-- layer3_expert11_3&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1143" class="edge">
<title>layer3_expert11_3&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M54922.05,-1977.66C54925.21,-1976.69 54928.37,-1975.8 54931.5,-1975 55079.35,-1937.39 55517.92,-1913.22 55729.18,-1903.45"/>
<polygon fill="black" stroke="black" points="55729.55,-1906.93 55739.38,-1902.98 55729.23,-1899.94 55729.55,-1906.93"/>
</g>
<!-- layer3_expert11_4&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1144" class="edge">
<title>layer3_expert11_4&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M55105.07,-1977.74C55108.23,-1976.75 55111.38,-1975.83 55114.5,-1975 55326.32,-1918.77 55582.96,-1903.55 55728.93,-1899.63"/>
<polygon fill="black" stroke="black" points="55729.34,-1903.12 55739.24,-1899.37 55729.16,-1896.13 55729.34,-1903.12"/>
</g>
<!-- layer3_expert11_5&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1145" class="edge">
<title>layer3_expert11_5&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M55288.11,-1977.88C55291.26,-1976.85 55294.39,-1975.88 55297.5,-1975 55443.15,-1933.64 55617.18,-1914.21 55729.44,-1905.38"/>
<polygon fill="black" stroke="black" points="55729.73,-1908.87 55739.43,-1904.61 55729.19,-1901.89 55729.73,-1908.87"/>
</g>
<!-- layer3_expert11_6&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1146" class="edge">
<title>layer3_expert11_6&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M55471.19,-1978.15C55474.32,-1977.04 55477.43,-1975.99 55480.5,-1975 55562.04,-1948.82 55656.77,-1929.27 55729.28,-1916.49"/>
<polygon fill="black" stroke="black" points="55730.12,-1919.9 55739.37,-1914.73 55728.91,-1913 55730.12,-1919.9"/>
</g>
<!-- layer3_expert11_7&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1147" class="edge">
<title>layer3_expert11_7&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M55654.22,-1979.01C55657.35,-1977.65 55660.45,-1976.31 55663.5,-1975 55687.79,-1964.55 55713.97,-1953.45 55738.69,-1943.04"/>
<polygon fill="black" stroke="black" points="55740.22,-1946.19 55748.09,-1939.09 55737.51,-1939.74 55740.22,-1946.19"/>
</g>
<!-- layer3_expert11_8&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1148" class="edge">
<title>layer3_expert11_8&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M55786.07,-1974.91C55793.06,-1965.92 55800.53,-1956.32 55807.74,-1947.05"/>
<polygon fill="black" stroke="black" points="55810.61,-1949.06 55813.98,-1939.02 55805.08,-1944.77 55810.61,-1949.06"/>
</g>
<!-- layer3_expert11_9&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1149" class="edge">
<title>layer3_expert11_9&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M55905.58,-1974.91C55898.52,-1965.92 55890.96,-1956.32 55883.68,-1947.05"/>
<polygon fill="black" stroke="black" points="55886.3,-1944.72 55877.36,-1939.02 55880.79,-1949.05 55886.3,-1944.72"/>
</g>
<!-- layer3_expert11_10&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1150" class="edge">
<title>layer3_expert11_10&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M56037.71,-1978.55C56034.94,-1977.35 56032.2,-1976.16 56029.5,-1975 56005.13,-1964.51 55978.84,-1953.44 55953.98,-1943.08"/>
<polygon fill="black" stroke="black" points="55955.1,-1939.75 55944.52,-1939.14 55952.41,-1946.22 55955.1,-1939.75"/>
</g>
<!-- layer3_expert11_11&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1151" class="edge">
<title>layer3_expert11_11&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M56220.97,-1977.87C56218.13,-1976.86 56215.3,-1975.9 56212.5,-1975 56130.42,-1948.52 56034.98,-1928.95 55962,-1916.24"/>
<polygon fill="black" stroke="black" points="55962.3,-1912.74 55951.85,-1914.49 55961.11,-1919.64 55962.3,-1912.74"/>
</g>
<!-- layer3_expert11_12&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1152" class="edge">
<title>layer3_expert11_12&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M56403.79,-1977.54C56401.01,-1976.64 56398.24,-1975.78 56395.5,-1975 56249.29,-1933.2 56074.44,-1913.87 55961.76,-1905.18"/>
<polygon fill="black" stroke="black" points="55961.97,-1901.69 55951.73,-1904.43 55961.44,-1908.67 55961.97,-1901.69"/>
</g>
<!-- layer3_expert11_13&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1153" class="edge">
<title>layer3_expert11_13&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M56586.82,-1977.42C56584.04,-1976.55 56581.26,-1975.74 56578.5,-1975 56366.06,-1918.18 56108.47,-1903.17 55962.12,-1899.44"/>
<polygon fill="black" stroke="black" points="55961.86,-1895.94 55951.77,-1899.2 55961.69,-1902.94 55961.86,-1895.94"/>
</g>
<!-- layer3_expert11_14&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1154" class="edge">
<title>layer3_expert11_14&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M56769.84,-1977.34C56767.05,-1976.49 56764.26,-1975.71 56761.5,-1975 56613.4,-1937.02 56173.83,-1913.04 55962.08,-1903.38"/>
<polygon fill="black" stroke="black" points="55962.01,-1899.87 55951.87,-1902.91 55961.7,-1906.86 55962.01,-1899.87"/>
</g>
<!-- layer3_expert11_15&#45;&gt;layer3_moe_agg_gpu11 -->
<g id="edge1155" class="edge">
<title>layer3_expert11_15&#45;&gt;layer3_moe_agg_gpu11</title>
<path fill="none" stroke="black" d="M56952.86,-1977.29C56950.06,-1976.46 56947.27,-1975.69 56944.5,-1975 56761.08,-1929.31 56205.72,-1908.57 55962.13,-1901.49"/>
<polygon fill="black" stroke="black" points="55961.93,-1897.98 55951.83,-1901.19 55961.73,-1904.98 55961.93,-1897.98"/>
</g>
<!-- layer3_output_gpu11 -->
<g id="node653" class="node">
<title>layer3_output_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="57131,-1614 56878,-1614 56878,-1546 57131,-1546 57131,-1614"/>
<text text-anchor="middle" x="57004.5" y="-1598.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU11</text>
<text text-anchor="middle" x="57004.5" y="-1583.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="57004.5" y="-1568.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="57004.5" y="-1553.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_moe_agg_gpu11&#45;&gt;layer3_output_gpu11 -->
<g id="edge1156" class="edge">
<title>layer3_moe_agg_gpu11&#45;&gt;layer3_output_gpu11</title>
<path fill="none" stroke="black" d="M55951.7,-1878.8C56140.25,-1845.61 56544.21,-1766.51 56869.5,-1648 56891.66,-1639.92 56914.96,-1629.23 56935.84,-1618.76"/>
<polygon fill="black" stroke="black" points="56937.62,-1621.78 56944.95,-1614.13 56934.44,-1615.54 56937.62,-1621.78"/>
</g>
<!-- layer3_moe_agg_gpu11&#45;&gt;layer3_allreduce_moe -->
<g id="edge1319" class="edge">
<title>layer3_moe_agg_gpu11&#45;&gt;layer3_allreduce_moe</title>
<path fill="none" stroke="black" d="M55951.61,-1895.83C56141.82,-1893.06 56552.8,-1879.95 56893.5,-1820 56935.42,-1812.62 56980.57,-1800.85 57020.11,-1789.22"/>
<polygon fill="black" stroke="black" points="57021.18,-1792.55 57029.76,-1786.35 57019.18,-1785.85 57021.18,-1792.55"/>
</g>
<!-- layer3_output_gpu11&#45;&gt;output -->
<g id="edge1340" class="edge">
<title>layer3_output_gpu11&#45;&gt;output</title>
<path fill="none" stroke="black" d="M57030.85,-1545.82C57051.82,-1519.41 57081.36,-1482.21 57104.35,-1453.26"/>
<polygon fill="black" stroke="black" points="57107.17,-1455.34 57110.65,-1445.33 57101.69,-1450.99 57107.17,-1455.34"/>
</g>
<!-- layer3_qkv_gpu12 -->
<g id="node654" class="node">
<title>layer3_qkv_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="57367.5,-2908 57157.5,-2908 57157.5,-2810 57367.5,-2810 57367.5,-2908"/>
<text text-anchor="middle" x="57262.5" y="-2892.8" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU12</text>
<text text-anchor="middle" x="57262.5" y="-2877.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="57262.5" y="-2862.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="57262.5" y="-2847.8" font-family="Times,serif" font-size="14.00">Heads: 16&#45;19</text>
<text text-anchor="middle" x="57262.5" y="-2832.8" font-family="Times,serif" font-size="14.00">TP Slice: 4</text>
<text text-anchor="middle" x="57262.5" y="-2817.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_attn_gpu12 -->
<g id="node655" class="node">
<title>layer3_attn_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="57388.5,-2766.5 57136.5,-2766.5 57136.5,-2683.5 57388.5,-2683.5 57388.5,-2766.5"/>
<text text-anchor="middle" x="57262.5" y="-2751.3" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU12</text>
<text text-anchor="middle" x="57262.5" y="-2736.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="57262.5" y="-2721.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="57262.5" y="-2706.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="57262.5" y="-2691.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_qkv_gpu12&#45;&gt;layer3_attn_gpu12 -->
<g id="edge1157" class="edge">
<title>layer3_qkv_gpu12&#45;&gt;layer3_attn_gpu12</title>
<path fill="none" stroke="black" d="M57262.5,-2809.97C57262.5,-2799.25 57262.5,-2787.84 57262.5,-2776.99"/>
<polygon fill="black" stroke="black" points="57266,-2776.82 57262.5,-2766.82 57259,-2776.82 57266,-2776.82"/>
</g>
<!-- layer3_attn_proj_gpu12 -->
<g id="node656" class="node">
<title>layer3_attn_proj_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="57367,-2632.5 57158,-2632.5 57158,-2564.5 57367,-2564.5 57367,-2632.5"/>
<text text-anchor="middle" x="57262.5" y="-2617.3" font-family="Times,serif" font-size="14.00">L3_Attn_Projection_GPU12</text>
<text text-anchor="middle" x="57262.5" y="-2602.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="57262.5" y="-2587.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="57262.5" y="-2572.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_attn_gpu12&#45;&gt;layer3_attn_proj_gpu12 -->
<g id="edge1158" class="edge">
<title>layer3_attn_gpu12&#45;&gt;layer3_attn_proj_gpu12</title>
<path fill="none" stroke="black" d="M57262.5,-2683.23C57262.5,-2670.36 57262.5,-2656.1 57262.5,-2643.04"/>
<polygon fill="black" stroke="black" points="57266,-2642.88 57262.5,-2632.88 57259,-2642.88 57266,-2642.88"/>
</g>
<!-- layer3_attn_norm_gpu12 -->
<g id="node657" class="node">
<title>layer3_attn_norm_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="57389,-2315 57136,-2315 57136,-2247 57389,-2247 57389,-2315"/>
<text text-anchor="middle" x="57262.5" y="-2299.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU12</text>
<text text-anchor="middle" x="57262.5" y="-2284.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="57262.5" y="-2269.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="57262.5" y="-2254.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_attn_proj_gpu12&#45;&gt;layer3_attn_norm_gpu12 -->
<g id="edge1159" class="edge">
<title>layer3_attn_proj_gpu12&#45;&gt;layer3_attn_norm_gpu12</title>
<path fill="none" stroke="black" d="M57262.5,-2564.33C57262.5,-2506.93 57262.5,-2389.12 57262.5,-2325.33"/>
<polygon fill="black" stroke="black" points="57266,-2325.2 57262.5,-2315.2 57259,-2325.2 57266,-2325.2"/>
</g>
<!-- layer3_attn_proj_gpu12&#45;&gt;layer3_allreduce_attn -->
<g id="edge1321" class="edge">
<title>layer3_attn_proj_gpu12&#45;&gt;layer3_allreduce_attn</title>
<path fill="none" stroke="black" d="M57209.21,-2564.4C57179.86,-2546.16 57142.86,-2523.18 57110.23,-2502.91"/>
<polygon fill="black" stroke="black" points="57111.94,-2499.85 57101.6,-2497.55 57108.25,-2505.8 57111.94,-2499.85"/>
</g>
<!-- layer3_gate_gpu12 -->
<g id="node658" class="node">
<title>layer3_gate_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="58621.5,-2177 58377.5,-2177 58377.5,-2094 58621.5,-2094 58621.5,-2177"/>
<text text-anchor="middle" x="58499.5" y="-2161.8" font-family="Times,serif" font-size="14.00">L3_Gate_GPU12</text>
<text text-anchor="middle" x="58499.5" y="-2146.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="58499.5" y="-2131.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="58499.5" y="-2116.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="58499.5" y="-2101.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_attn_norm_gpu12&#45;&gt;layer3_gate_gpu12 -->
<g id="edge1160" class="edge">
<title>layer3_attn_norm_gpu12&#45;&gt;layer3_gate_gpu12</title>
<path fill="none" stroke="black" d="M57317.47,-2246.84C57341.51,-2233.97 57370.55,-2220.54 57398.5,-2213 57577.54,-2164.69 58115.29,-2145.7 58366.93,-2139.31"/>
<polygon fill="black" stroke="black" points="58367.32,-2142.8 58377.23,-2139.05 58367.15,-2135.8 58367.32,-2142.8"/>
</g>
<!-- layer3_expert12_0 -->
<g id="node659" class="node">
<title>layer3_expert12_0</title>
<polygon fill="lightgreen" stroke="black" points="57301,-2058 57136,-2058 57136,-1975 57301,-1975 57301,-2058"/>
<text text-anchor="middle" x="57218.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU12</text>
<text text-anchor="middle" x="57218.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="57218.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="57218.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="57218.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_0 -->
<g id="edge1161" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58377.17,-2132.04C58119.68,-2125.99 57528.32,-2107.3 57310.79,-2057.73"/>
<polygon fill="black" stroke="black" points="57311.57,-2054.31 57301.03,-2055.42 57309.96,-2061.13 57311.57,-2054.31"/>
</g>
<!-- layer3_expert12_1 -->
<g id="node660" class="node">
<title>layer3_expert12_1</title>
<polygon fill="lightgreen" stroke="black" points="57484,-2058 57319,-2058 57319,-1975 57484,-1975 57484,-2058"/>
<text text-anchor="middle" x="57401.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU12</text>
<text text-anchor="middle" x="57401.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="57401.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="57401.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="57401.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_1 -->
<g id="edge1162" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58377.4,-2130.37C58151.52,-2121.9 57675.76,-2099.94 57494.03,-2057.78"/>
<polygon fill="black" stroke="black" points="57494.58,-2054.32 57484.04,-2055.37 57492.94,-2061.12 57494.58,-2054.32"/>
</g>
<!-- layer3_expert12_2 -->
<g id="node661" class="node">
<title>layer3_expert12_2</title>
<polygon fill="lightgreen" stroke="black" points="57667,-2058 57502,-2058 57502,-1975 57667,-1975 57667,-2058"/>
<text text-anchor="middle" x="57584.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU12</text>
<text text-anchor="middle" x="57584.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="57584.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="57584.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="57584.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_2 -->
<g id="edge1163" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58377.13,-2127.96C58185.69,-2116.93 57823.1,-2092.64 57677.18,-2057.83"/>
<polygon fill="black" stroke="black" points="57677.61,-2054.33 57667.06,-2055.3 57675.91,-2061.12 57677.61,-2054.33"/>
</g>
<!-- layer3_expert12_3 -->
<g id="node662" class="node">
<title>layer3_expert12_3</title>
<polygon fill="lightgreen" stroke="black" points="57850,-2058 57685,-2058 57685,-1975 57850,-1975 57850,-2058"/>
<text text-anchor="middle" x="57767.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU12</text>
<text text-anchor="middle" x="57767.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="57767.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="57767.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="57767.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_3 -->
<g id="edge1164" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58377.44,-2130.6C58249.41,-2124.1 58042.99,-2106.76 57859.89,-2057.85"/>
<polygon fill="black" stroke="black" points="57860.65,-2054.43 57850.09,-2055.2 57858.82,-2061.19 57860.65,-2054.43"/>
</g>
<!-- layer3_expert12_4 -->
<g id="node663" class="node">
<title>layer3_expert12_4</title>
<polygon fill="lightgreen" stroke="black" points="58033,-2058 57868,-2058 57868,-1975 58033,-1975 58033,-2058"/>
<text text-anchor="middle" x="57950.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU12</text>
<text text-anchor="middle" x="57950.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="57950.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="57950.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="57950.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_4 -->
<g id="edge1165" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58377.36,-2122.42C58286.76,-2111.52 58160.61,-2092.25 58043.04,-2057.94"/>
<polygon fill="black" stroke="black" points="58043.72,-2054.49 58033.14,-2055.01 58041.74,-2061.2 58043.72,-2054.49"/>
</g>
<!-- layer3_expert12_5 -->
<g id="node664" class="node">
<title>layer3_expert12_5</title>
<polygon fill="lightgreen" stroke="black" points="58216,-2058 58051,-2058 58051,-1975 58216,-1975 58216,-2058"/>
<text text-anchor="middle" x="58133.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU12</text>
<text text-anchor="middle" x="58133.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="58133.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="58133.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="58133.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_5 -->
<g id="edge1166" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58377.28,-2104.37C58329.46,-2091.55 58274.45,-2075.51 58225.5,-2058 58225.4,-2057.97 58225.3,-2057.93 58225.21,-2057.9"/>
<polygon fill="black" stroke="black" points="58226.62,-2054.69 58216.03,-2054.49 58224.19,-2061.25 58226.62,-2054.69"/>
</g>
<!-- layer3_expert12_6 -->
<g id="node665" class="node">
<title>layer3_expert12_6</title>
<polygon fill="lightgreen" stroke="black" points="58399,-2058 58234,-2058 58234,-1975 58399,-1975 58399,-2058"/>
<text text-anchor="middle" x="58316.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU12</text>
<text text-anchor="middle" x="58316.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="58316.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="58316.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="58316.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_6 -->
<g id="edge1167" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58436.01,-2093.91C58420.68,-2084.11 58404.19,-2073.56 58388.5,-2063.53"/>
<polygon fill="black" stroke="black" points="58390.19,-2060.46 58379.88,-2058.02 58386.42,-2066.36 58390.19,-2060.46"/>
</g>
<!-- layer3_expert12_7 -->
<g id="node666" class="node">
<title>layer3_expert12_7</title>
<polygon fill="lightgreen" stroke="black" points="58582,-2058 58417,-2058 58417,-1975 58582,-1975 58582,-2058"/>
<text text-anchor="middle" x="58499.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU12</text>
<text text-anchor="middle" x="58499.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="58499.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="58499.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="58499.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_7 -->
<g id="edge1168" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58499.5,-2093.91C58499.5,-2085.65 58499.5,-2076.86 58499.5,-2068.3"/>
<polygon fill="black" stroke="black" points="58503,-2068.02 58499.5,-2058.02 58496,-2068.02 58503,-2068.02"/>
</g>
<!-- layer3_expert12_8 -->
<g id="node667" class="node">
<title>layer3_expert12_8</title>
<polygon fill="lightgreen" stroke="black" points="58765,-2058 58600,-2058 58600,-1975 58765,-1975 58765,-2058"/>
<text text-anchor="middle" x="58682.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU12</text>
<text text-anchor="middle" x="58682.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="58682.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="58682.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="58682.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_8 -->
<g id="edge1169" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58562.99,-2093.91C58578.32,-2084.11 58594.81,-2073.56 58610.5,-2063.53"/>
<polygon fill="black" stroke="black" points="58612.58,-2066.36 58619.12,-2058.02 58608.81,-2060.46 58612.58,-2066.36"/>
</g>
<!-- layer3_expert12_9 -->
<g id="node668" class="node">
<title>layer3_expert12_9</title>
<polygon fill="lightgreen" stroke="black" points="58948,-2058 58783,-2058 58783,-1975 58948,-1975 58948,-2058"/>
<text text-anchor="middle" x="58865.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU12</text>
<text text-anchor="middle" x="58865.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="58865.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="58865.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="58865.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_9 -->
<g id="edge1170" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58621.53,-2104.69C58667.05,-2092.56 58719.13,-2077.48 58773.44,-2058.26"/>
<polygon fill="black" stroke="black" points="58774.65,-2061.55 58782.88,-2054.89 58772.29,-2054.96 58774.65,-2061.55"/>
</g>
<!-- layer3_expert12_10 -->
<g id="node669" class="node">
<title>layer3_expert12_10</title>
<polygon fill="lightgreen" stroke="black" points="59131,-2058 58966,-2058 58966,-1975 59131,-1975 59131,-2058"/>
<text text-anchor="middle" x="59048.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU12</text>
<text text-anchor="middle" x="59048.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="59048.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="59048.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="59048.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_10 -->
<g id="edge1171" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58621.95,-2122.58C58712.76,-2111.76 58839.19,-2092.52 58955.94,-2058.28"/>
<polygon fill="black" stroke="black" points="58957.17,-2061.57 58965.76,-2055.36 58955.18,-2054.86 58957.17,-2061.57"/>
</g>
<!-- layer3_expert12_11 -->
<g id="node670" class="node">
<title>layer3_expert12_11</title>
<polygon fill="lightgreen" stroke="black" points="59314,-2058 59149,-2058 59149,-1975 59314,-1975 59314,-2058"/>
<text text-anchor="middle" x="59231.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU12</text>
<text text-anchor="middle" x="59231.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="59231.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="59231.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="59231.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_11 -->
<g id="edge1172" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58621.79,-2130.77C58750.05,-2124.4 58956.82,-2107.17 59139.05,-2058.19"/>
<polygon fill="black" stroke="black" points="59140.08,-2061.53 59148.81,-2055.53 59138.24,-2054.78 59140.08,-2061.53"/>
</g>
<!-- layer3_expert12_12 -->
<g id="node671" class="node">
<title>layer3_expert12_12</title>
<polygon fill="lightgreen" stroke="black" points="59497,-2058 59332,-2058 59332,-1975 59497,-1975 59497,-2058"/>
<text text-anchor="middle" x="59414.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU12</text>
<text text-anchor="middle" x="59414.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="59414.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="59414.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="59414.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_12 -->
<g id="edge1173" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58621.64,-2128.05C58813.22,-2117.12 59176.68,-2092.96 59321.77,-2058.15"/>
<polygon fill="black" stroke="black" points="59322.99,-2061.45 59331.83,-2055.62 59321.28,-2054.66 59322.99,-2061.45"/>
</g>
<!-- layer3_expert12_13 -->
<g id="node672" class="node">
<title>layer3_expert12_13</title>
<polygon fill="lightgreen" stroke="black" points="59680,-2058 59515,-2058 59515,-1975 59680,-1975 59680,-2058"/>
<text text-anchor="middle" x="59597.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU12</text>
<text text-anchor="middle" x="59597.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="59597.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="59597.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="59597.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_13 -->
<g id="edge1174" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58621.74,-2130.44C58847.86,-2122.08 59324.14,-2100.29 59504.92,-2058.1"/>
<polygon fill="black" stroke="black" points="59505.96,-2061.45 59514.85,-2055.68 59504.31,-2054.65 59505.96,-2061.45"/>
</g>
<!-- layer3_expert12_14 -->
<g id="node673" class="node">
<title>layer3_expert12_14</title>
<polygon fill="lightgreen" stroke="black" points="59863,-2058 59698,-2058 59698,-1975 59863,-1975 59863,-2058"/>
<text text-anchor="middle" x="59780.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU12</text>
<text text-anchor="middle" x="59780.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="59780.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="59780.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="59780.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_14 -->
<g id="edge1175" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58621.95,-2132.1C58879.56,-2126.18 59471,-2107.75 59687.82,-2058.11"/>
<polygon fill="black" stroke="black" points="59688.94,-2061.44 59697.86,-2055.73 59687.32,-2054.63 59688.94,-2061.44"/>
</g>
<!-- layer3_expert12_15 -->
<g id="node674" class="node">
<title>layer3_expert12_15</title>
<polygon fill="lightgreen" stroke="black" points="60046,-2058 59881,-2058 59881,-1975 60046,-1975 60046,-2058"/>
<text text-anchor="middle" x="59963.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU12</text>
<text text-anchor="middle" x="59963.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="59963.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="59963.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="59963.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_gate_gpu12&#45;&gt;layer3_expert12_15 -->
<g id="edge1176" class="edge">
<title>layer3_gate_gpu12&#45;&gt;layer3_expert12_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58621.66,-2133.34C58908.25,-2129.72 59618,-2115.31 59870.98,-2058.07"/>
<polygon fill="black" stroke="black" points="59871.93,-2061.44 59880.87,-2055.76 59870.33,-2054.63 59871.93,-2061.44"/>
</g>
<!-- layer3_moe_agg_gpu12 -->
<g id="node675" class="node">
<title>layer3_moe_agg_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="58513.5,-1939 58301.5,-1939 58301.5,-1856 58513.5,-1856 58513.5,-1939"/>
<text text-anchor="middle" x="58407.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU12</text>
<text text-anchor="middle" x="58407.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="58407.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="58407.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="58407.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_expert12_0&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1177" class="edge">
<title>layer3_expert12_0&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M57301.04,-1977.6C57304.2,-1976.65 57307.37,-1975.77 57310.5,-1975 57493.68,-1929.75 58047.97,-1908.77 58291.09,-1901.56"/>
<polygon fill="black" stroke="black" points="58291.48,-1905.05 58301.38,-1901.26 58291.28,-1898.05 58291.48,-1905.05"/>
</g>
<!-- layer3_expert12_1&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1178" class="edge">
<title>layer3_expert12_1&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M57484.05,-1977.66C57487.21,-1976.69 57490.37,-1975.8 57493.5,-1975 57641.35,-1937.39 58079.92,-1913.22 58291.18,-1903.45"/>
<polygon fill="black" stroke="black" points="58291.55,-1906.93 58301.38,-1902.98 58291.23,-1899.94 58291.55,-1906.93"/>
</g>
<!-- layer3_expert12_2&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1179" class="edge">
<title>layer3_expert12_2&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M57667.07,-1977.74C57670.23,-1976.75 57673.38,-1975.83 57676.5,-1975 57888.32,-1918.77 58144.96,-1903.55 58290.93,-1899.63"/>
<polygon fill="black" stroke="black" points="58291.34,-1903.12 58301.24,-1899.37 58291.16,-1896.13 58291.34,-1903.12"/>
</g>
<!-- layer3_expert12_3&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1180" class="edge">
<title>layer3_expert12_3&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M57850.11,-1977.88C57853.26,-1976.85 57856.39,-1975.88 57859.5,-1975 58005.15,-1933.64 58179.18,-1914.21 58291.44,-1905.38"/>
<polygon fill="black" stroke="black" points="58291.73,-1908.87 58301.43,-1904.61 58291.19,-1901.89 58291.73,-1908.87"/>
</g>
<!-- layer3_expert12_4&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1181" class="edge">
<title>layer3_expert12_4&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M58033.19,-1978.15C58036.32,-1977.04 58039.43,-1975.99 58042.5,-1975 58124.04,-1948.82 58218.77,-1929.27 58291.28,-1916.49"/>
<polygon fill="black" stroke="black" points="58292.12,-1919.9 58301.37,-1914.73 58290.91,-1913 58292.12,-1919.9"/>
</g>
<!-- layer3_expert12_5&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1182" class="edge">
<title>layer3_expert12_5&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M58216.22,-1979.01C58219.35,-1977.65 58222.45,-1976.31 58225.5,-1975 58249.79,-1964.55 58275.97,-1953.45 58300.69,-1943.04"/>
<polygon fill="black" stroke="black" points="58302.22,-1946.19 58310.09,-1939.09 58299.51,-1939.74 58302.22,-1946.19"/>
</g>
<!-- layer3_expert12_6&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1183" class="edge">
<title>layer3_expert12_6&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M58348.07,-1974.91C58355.06,-1965.92 58362.53,-1956.32 58369.74,-1947.05"/>
<polygon fill="black" stroke="black" points="58372.61,-1949.06 58375.98,-1939.02 58367.08,-1944.77 58372.61,-1949.06"/>
</g>
<!-- layer3_expert12_7&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1184" class="edge">
<title>layer3_expert12_7&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M58467.58,-1974.91C58460.52,-1965.92 58452.96,-1956.32 58445.68,-1947.05"/>
<polygon fill="black" stroke="black" points="58448.3,-1944.72 58439.36,-1939.02 58442.79,-1949.05 58448.3,-1944.72"/>
</g>
<!-- layer3_expert12_8&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1185" class="edge">
<title>layer3_expert12_8&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M58599.71,-1978.55C58596.94,-1977.35 58594.2,-1976.16 58591.5,-1975 58567.13,-1964.51 58540.84,-1953.44 58515.98,-1943.08"/>
<polygon fill="black" stroke="black" points="58517.1,-1939.75 58506.52,-1939.14 58514.41,-1946.22 58517.1,-1939.75"/>
</g>
<!-- layer3_expert12_9&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1186" class="edge">
<title>layer3_expert12_9&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M58782.97,-1977.87C58780.13,-1976.86 58777.3,-1975.9 58774.5,-1975 58692.42,-1948.52 58596.98,-1928.95 58524,-1916.24"/>
<polygon fill="black" stroke="black" points="58524.3,-1912.74 58513.85,-1914.49 58523.11,-1919.64 58524.3,-1912.74"/>
</g>
<!-- layer3_expert12_10&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1187" class="edge">
<title>layer3_expert12_10&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M58965.79,-1977.54C58963.01,-1976.64 58960.24,-1975.78 58957.5,-1975 58811.29,-1933.2 58636.44,-1913.87 58523.76,-1905.18"/>
<polygon fill="black" stroke="black" points="58523.97,-1901.69 58513.73,-1904.43 58523.44,-1908.67 58523.97,-1901.69"/>
</g>
<!-- layer3_expert12_11&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1188" class="edge">
<title>layer3_expert12_11&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M59148.82,-1977.42C59146.04,-1976.55 59143.26,-1975.74 59140.5,-1975 58928.06,-1918.18 58670.47,-1903.17 58524.12,-1899.44"/>
<polygon fill="black" stroke="black" points="58523.86,-1895.94 58513.77,-1899.2 58523.69,-1902.94 58523.86,-1895.94"/>
</g>
<!-- layer3_expert12_12&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1189" class="edge">
<title>layer3_expert12_12&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M59331.84,-1977.34C59329.05,-1976.49 59326.26,-1975.71 59323.5,-1975 59175.4,-1937.02 58735.83,-1913.04 58524.08,-1903.38"/>
<polygon fill="black" stroke="black" points="58524.01,-1899.87 58513.87,-1902.91 58523.7,-1906.86 58524.01,-1899.87"/>
</g>
<!-- layer3_expert12_13&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1190" class="edge">
<title>layer3_expert12_13&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M59514.86,-1977.29C59512.06,-1976.46 59509.27,-1975.69 59506.5,-1975 59323.08,-1929.31 58767.72,-1908.57 58524.13,-1901.49"/>
<polygon fill="black" stroke="black" points="58523.93,-1897.98 58513.83,-1901.19 58523.73,-1904.98 58523.93,-1897.98"/>
</g>
<!-- layer3_expert12_14&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1191" class="edge">
<title>layer3_expert12_14&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M59697.86,-1977.26C59695.06,-1976.43 59692.27,-1975.68 59689.5,-1975 59470.42,-1921.58 58797.18,-1904.82 58524.25,-1900.14"/>
<polygon fill="black" stroke="black" points="58523.98,-1896.63 58513.92,-1899.96 58523.86,-1903.63 58523.98,-1896.63"/>
</g>
<!-- layer3_expert12_15&#45;&gt;layer3_moe_agg_gpu12 -->
<g id="edge1192" class="edge">
<title>layer3_expert12_15&#45;&gt;layer3_moe_agg_gpu12</title>
<path fill="none" stroke="black" d="M59880.87,-1977.23C59878.07,-1976.41 59875.27,-1975.67 59872.5,-1975 59617.29,-1913.77 58823.49,-1901.55 58523.71,-1899.11"/>
<polygon fill="black" stroke="black" points="58523.72,-1895.61 58513.69,-1899.03 58523.66,-1902.61 58523.72,-1895.61"/>
</g>
<!-- layer3_output_gpu12 -->
<g id="node676" class="node">
<title>layer3_output_gpu12</title>
<polygon fill="lightgreen" stroke="black" points="57402,-1614 57149,-1614 57149,-1546 57402,-1546 57402,-1614"/>
<text text-anchor="middle" x="57275.5" y="-1598.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU12</text>
<text text-anchor="middle" x="57275.5" y="-1583.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="57275.5" y="-1568.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="57275.5" y="-1553.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_moe_agg_gpu12&#45;&gt;layer3_output_gpu12 -->
<g id="edge1193" class="edge">
<title>layer3_moe_agg_gpu12&#45;&gt;layer3_output_gpu12</title>
<path fill="none" stroke="black" d="M58301.39,-1890.04C58133.71,-1878.98 57815.44,-1854.23 57707.5,-1820 57560.88,-1773.5 57407.53,-1674.74 57328.94,-1619.85"/>
<polygon fill="black" stroke="black" points="57330.84,-1616.91 57320.65,-1614.03 57326.82,-1622.64 57330.84,-1616.91"/>
</g>
<!-- layer3_moe_agg_gpu12&#45;&gt;layer3_allreduce_moe -->
<g id="edge1323" class="edge">
<title>layer3_moe_agg_gpu12&#45;&gt;layer3_allreduce_moe</title>
<path fill="none" stroke="black" d="M58301.36,-1886.48C58156.13,-1872.59 57887.38,-1846.21 57658.5,-1820 57532.1,-1805.53 57388.94,-1787.24 57283.6,-1773.43"/>
<polygon fill="black" stroke="black" points="57283.9,-1769.94 57273.53,-1772.11 57282.99,-1776.88 57283.9,-1769.94"/>
</g>
<!-- layer3_output_gpu12&#45;&gt;output -->
<g id="edge1341" class="edge">
<title>layer3_output_gpu12&#45;&gt;output</title>
<path fill="none" stroke="black" d="M57248.95,-1545.82C57227.83,-1519.41 57198.07,-1482.21 57174.91,-1453.26"/>
<polygon fill="black" stroke="black" points="57177.55,-1450.96 57168.57,-1445.33 57172.08,-1455.33 57177.55,-1450.96"/>
</g>
<!-- layer3_qkv_gpu13 -->
<g id="node677" class="node">
<title>layer3_qkv_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="57637.5,-2908 57427.5,-2908 57427.5,-2810 57637.5,-2810 57637.5,-2908"/>
<text text-anchor="middle" x="57532.5" y="-2892.8" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU13</text>
<text text-anchor="middle" x="57532.5" y="-2877.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="57532.5" y="-2862.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="57532.5" y="-2847.8" font-family="Times,serif" font-size="14.00">Heads: 20&#45;23</text>
<text text-anchor="middle" x="57532.5" y="-2832.8" font-family="Times,serif" font-size="14.00">TP Slice: 5</text>
<text text-anchor="middle" x="57532.5" y="-2817.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_attn_gpu13 -->
<g id="node678" class="node">
<title>layer3_attn_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="57658.5,-2766.5 57406.5,-2766.5 57406.5,-2683.5 57658.5,-2683.5 57658.5,-2766.5"/>
<text text-anchor="middle" x="57532.5" y="-2751.3" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU13</text>
<text text-anchor="middle" x="57532.5" y="-2736.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="57532.5" y="-2721.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="57532.5" y="-2706.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="57532.5" y="-2691.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_qkv_gpu13&#45;&gt;layer3_attn_gpu13 -->
<g id="edge1194" class="edge">
<title>layer3_qkv_gpu13&#45;&gt;layer3_attn_gpu13</title>
<path fill="none" stroke="black" d="M57532.5,-2809.97C57532.5,-2799.25 57532.5,-2787.84 57532.5,-2776.99"/>
<polygon fill="black" stroke="black" points="57536,-2776.82 57532.5,-2766.82 57529,-2776.82 57536,-2776.82"/>
</g>
<!-- layer3_attn_proj_gpu13 -->
<g id="node679" class="node">
<title>layer3_attn_proj_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="57637,-2632.5 57428,-2632.5 57428,-2564.5 57637,-2564.5 57637,-2632.5"/>
<text text-anchor="middle" x="57532.5" y="-2617.3" font-family="Times,serif" font-size="14.00">L3_Attn_Projection_GPU13</text>
<text text-anchor="middle" x="57532.5" y="-2602.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="57532.5" y="-2587.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="57532.5" y="-2572.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_attn_gpu13&#45;&gt;layer3_attn_proj_gpu13 -->
<g id="edge1195" class="edge">
<title>layer3_attn_gpu13&#45;&gt;layer3_attn_proj_gpu13</title>
<path fill="none" stroke="black" d="M57532.5,-2683.23C57532.5,-2670.36 57532.5,-2656.1 57532.5,-2643.04"/>
<polygon fill="black" stroke="black" points="57536,-2642.88 57532.5,-2632.88 57529,-2642.88 57536,-2642.88"/>
</g>
<!-- layer3_attn_norm_gpu13 -->
<g id="node680" class="node">
<title>layer3_attn_norm_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="57660,-2315 57407,-2315 57407,-2247 57660,-2247 57660,-2315"/>
<text text-anchor="middle" x="57533.5" y="-2299.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU13</text>
<text text-anchor="middle" x="57533.5" y="-2284.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="57533.5" y="-2269.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="57533.5" y="-2254.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_attn_proj_gpu13&#45;&gt;layer3_attn_norm_gpu13 -->
<g id="edge1196" class="edge">
<title>layer3_attn_proj_gpu13&#45;&gt;layer3_attn_norm_gpu13</title>
<path fill="none" stroke="black" d="M57532.61,-2564.33C57532.79,-2506.93 57533.16,-2389.12 57533.36,-2325.33"/>
<polygon fill="black" stroke="black" points="57536.86,-2325.21 57533.39,-2315.2 57529.86,-2325.19 57536.86,-2325.21"/>
</g>
<!-- layer3_attn_proj_gpu13&#45;&gt;layer3_allreduce_attn -->
<g id="edge1325" class="edge">
<title>layer3_attn_proj_gpu13&#45;&gt;layer3_allreduce_attn</title>
<path fill="none" stroke="black" d="M57427.78,-2567.51C57346.44,-2544.21 57233.64,-2511.9 57149.18,-2487.71"/>
<polygon fill="black" stroke="black" points="57150.12,-2484.34 57139.54,-2484.95 57148.19,-2491.07 57150.12,-2484.34"/>
</g>
<!-- layer3_gate_gpu13 -->
<g id="node681" class="node">
<title>layer3_gate_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="61549.5,-2177 61305.5,-2177 61305.5,-2094 61549.5,-2094 61549.5,-2177"/>
<text text-anchor="middle" x="61427.5" y="-2161.8" font-family="Times,serif" font-size="14.00">L3_Gate_GPU13</text>
<text text-anchor="middle" x="61427.5" y="-2146.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="61427.5" y="-2131.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="61427.5" y="-2116.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="61427.5" y="-2101.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_attn_norm_gpu13&#45;&gt;layer3_gate_gpu13 -->
<g id="edge1197" class="edge">
<title>layer3_attn_norm_gpu13&#45;&gt;layer3_gate_gpu13</title>
<path fill="none" stroke="black" d="M57587,-2246.88C57611.25,-2233.68 57640.86,-2219.98 57669.5,-2213 57759.35,-2191.1 60638.19,-2147.98 61295,-2138.41"/>
<polygon fill="black" stroke="black" points="61295.5,-2141.9 61305.45,-2138.26 61295.4,-2134.9 61295.5,-2141.9"/>
</g>
<!-- layer3_expert13_0 -->
<g id="node682" class="node">
<title>layer3_expert13_0</title>
<polygon fill="lightgreen" stroke="black" points="60229,-2058 60064,-2058 60064,-1975 60229,-1975 60229,-2058"/>
<text text-anchor="middle" x="60146.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU13</text>
<text text-anchor="middle" x="60146.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="60146.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="60146.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="60146.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_0 -->
<g id="edge1198" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61305.17,-2132.04C61047.68,-2125.99 60456.32,-2107.3 60238.79,-2057.73"/>
<polygon fill="black" stroke="black" points="60239.57,-2054.31 60229.03,-2055.42 60237.96,-2061.13 60239.57,-2054.31"/>
</g>
<!-- layer3_expert13_1 -->
<g id="node683" class="node">
<title>layer3_expert13_1</title>
<polygon fill="lightgreen" stroke="black" points="60412,-2058 60247,-2058 60247,-1975 60412,-1975 60412,-2058"/>
<text text-anchor="middle" x="60329.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU13</text>
<text text-anchor="middle" x="60329.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="60329.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="60329.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="60329.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_1 -->
<g id="edge1199" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61305.4,-2130.37C61079.52,-2121.9 60603.76,-2099.94 60422.03,-2057.78"/>
<polygon fill="black" stroke="black" points="60422.58,-2054.32 60412.04,-2055.37 60420.94,-2061.12 60422.58,-2054.32"/>
</g>
<!-- layer3_expert13_2 -->
<g id="node684" class="node">
<title>layer3_expert13_2</title>
<polygon fill="lightgreen" stroke="black" points="60595,-2058 60430,-2058 60430,-1975 60595,-1975 60595,-2058"/>
<text text-anchor="middle" x="60512.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU13</text>
<text text-anchor="middle" x="60512.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="60512.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="60512.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="60512.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_2 -->
<g id="edge1200" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61305.13,-2127.96C61113.69,-2116.93 60751.1,-2092.64 60605.18,-2057.83"/>
<polygon fill="black" stroke="black" points="60605.61,-2054.33 60595.06,-2055.3 60603.91,-2061.12 60605.61,-2054.33"/>
</g>
<!-- layer3_expert13_3 -->
<g id="node685" class="node">
<title>layer3_expert13_3</title>
<polygon fill="lightgreen" stroke="black" points="60778,-2058 60613,-2058 60613,-1975 60778,-1975 60778,-2058"/>
<text text-anchor="middle" x="60695.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU13</text>
<text text-anchor="middle" x="60695.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="60695.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="60695.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="60695.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_3 -->
<g id="edge1201" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61305.44,-2130.6C61177.41,-2124.1 60970.99,-2106.76 60787.89,-2057.85"/>
<polygon fill="black" stroke="black" points="60788.65,-2054.43 60778.09,-2055.2 60786.82,-2061.19 60788.65,-2054.43"/>
</g>
<!-- layer3_expert13_4 -->
<g id="node686" class="node">
<title>layer3_expert13_4</title>
<polygon fill="lightgreen" stroke="black" points="60961,-2058 60796,-2058 60796,-1975 60961,-1975 60961,-2058"/>
<text text-anchor="middle" x="60878.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU13</text>
<text text-anchor="middle" x="60878.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="60878.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="60878.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="60878.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_4 -->
<g id="edge1202" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61305.36,-2122.42C61214.76,-2111.52 61088.61,-2092.25 60971.04,-2057.94"/>
<polygon fill="black" stroke="black" points="60971.72,-2054.49 60961.14,-2055.01 60969.74,-2061.2 60971.72,-2054.49"/>
</g>
<!-- layer3_expert13_5 -->
<g id="node687" class="node">
<title>layer3_expert13_5</title>
<polygon fill="lightgreen" stroke="black" points="61144,-2058 60979,-2058 60979,-1975 61144,-1975 61144,-2058"/>
<text text-anchor="middle" x="61061.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU13</text>
<text text-anchor="middle" x="61061.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="61061.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="61061.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="61061.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_5 -->
<g id="edge1203" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61305.28,-2104.37C61257.46,-2091.55 61202.45,-2075.51 61153.5,-2058 61153.4,-2057.97 61153.3,-2057.93 61153.21,-2057.9"/>
<polygon fill="black" stroke="black" points="61154.62,-2054.69 61144.03,-2054.49 61152.19,-2061.25 61154.62,-2054.69"/>
</g>
<!-- layer3_expert13_6 -->
<g id="node688" class="node">
<title>layer3_expert13_6</title>
<polygon fill="lightgreen" stroke="black" points="61327,-2058 61162,-2058 61162,-1975 61327,-1975 61327,-2058"/>
<text text-anchor="middle" x="61244.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU13</text>
<text text-anchor="middle" x="61244.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="61244.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="61244.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="61244.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_6 -->
<g id="edge1204" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61364.01,-2093.91C61348.68,-2084.11 61332.19,-2073.56 61316.5,-2063.53"/>
<polygon fill="black" stroke="black" points="61318.19,-2060.46 61307.88,-2058.02 61314.42,-2066.36 61318.19,-2060.46"/>
</g>
<!-- layer3_expert13_7 -->
<g id="node689" class="node">
<title>layer3_expert13_7</title>
<polygon fill="lightgreen" stroke="black" points="61510,-2058 61345,-2058 61345,-1975 61510,-1975 61510,-2058"/>
<text text-anchor="middle" x="61427.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU13</text>
<text text-anchor="middle" x="61427.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="61427.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="61427.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="61427.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_7 -->
<g id="edge1205" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61427.5,-2093.91C61427.5,-2085.65 61427.5,-2076.86 61427.5,-2068.3"/>
<polygon fill="black" stroke="black" points="61431,-2068.02 61427.5,-2058.02 61424,-2068.02 61431,-2068.02"/>
</g>
<!-- layer3_expert13_8 -->
<g id="node690" class="node">
<title>layer3_expert13_8</title>
<polygon fill="lightgreen" stroke="black" points="61693,-2058 61528,-2058 61528,-1975 61693,-1975 61693,-2058"/>
<text text-anchor="middle" x="61610.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU13</text>
<text text-anchor="middle" x="61610.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="61610.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="61610.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="61610.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_8 -->
<g id="edge1206" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61490.99,-2093.91C61506.32,-2084.11 61522.81,-2073.56 61538.5,-2063.53"/>
<polygon fill="black" stroke="black" points="61540.58,-2066.36 61547.12,-2058.02 61536.81,-2060.46 61540.58,-2066.36"/>
</g>
<!-- layer3_expert13_9 -->
<g id="node691" class="node">
<title>layer3_expert13_9</title>
<polygon fill="lightgreen" stroke="black" points="61876,-2058 61711,-2058 61711,-1975 61876,-1975 61876,-2058"/>
<text text-anchor="middle" x="61793.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU13</text>
<text text-anchor="middle" x="61793.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="61793.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="61793.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="61793.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_9 -->
<g id="edge1207" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61549.53,-2104.69C61595.05,-2092.56 61647.13,-2077.48 61701.44,-2058.26"/>
<polygon fill="black" stroke="black" points="61702.65,-2061.55 61710.88,-2054.89 61700.29,-2054.96 61702.65,-2061.55"/>
</g>
<!-- layer3_expert13_10 -->
<g id="node692" class="node">
<title>layer3_expert13_10</title>
<polygon fill="lightgreen" stroke="black" points="62059,-2058 61894,-2058 61894,-1975 62059,-1975 62059,-2058"/>
<text text-anchor="middle" x="61976.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU13</text>
<text text-anchor="middle" x="61976.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="61976.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="61976.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="61976.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_10 -->
<g id="edge1208" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61549.95,-2122.58C61640.76,-2111.76 61767.19,-2092.52 61883.94,-2058.28"/>
<polygon fill="black" stroke="black" points="61885.17,-2061.57 61893.76,-2055.36 61883.18,-2054.86 61885.17,-2061.57"/>
</g>
<!-- layer3_expert13_11 -->
<g id="node693" class="node">
<title>layer3_expert13_11</title>
<polygon fill="lightgreen" stroke="black" points="62242,-2058 62077,-2058 62077,-1975 62242,-1975 62242,-2058"/>
<text text-anchor="middle" x="62159.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU13</text>
<text text-anchor="middle" x="62159.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="62159.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="62159.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="62159.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_11 -->
<g id="edge1209" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61549.79,-2130.77C61678.05,-2124.4 61884.82,-2107.17 62067.05,-2058.19"/>
<polygon fill="black" stroke="black" points="62068.08,-2061.53 62076.81,-2055.53 62066.24,-2054.78 62068.08,-2061.53"/>
</g>
<!-- layer3_expert13_12 -->
<g id="node694" class="node">
<title>layer3_expert13_12</title>
<polygon fill="lightgreen" stroke="black" points="62425,-2058 62260,-2058 62260,-1975 62425,-1975 62425,-2058"/>
<text text-anchor="middle" x="62342.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU13</text>
<text text-anchor="middle" x="62342.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="62342.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="62342.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="62342.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_12 -->
<g id="edge1210" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61549.64,-2128.05C61741.22,-2117.12 62104.68,-2092.96 62249.77,-2058.15"/>
<polygon fill="black" stroke="black" points="62250.99,-2061.45 62259.83,-2055.62 62249.28,-2054.66 62250.99,-2061.45"/>
</g>
<!-- layer3_expert13_13 -->
<g id="node695" class="node">
<title>layer3_expert13_13</title>
<polygon fill="lightgreen" stroke="black" points="62608,-2058 62443,-2058 62443,-1975 62608,-1975 62608,-2058"/>
<text text-anchor="middle" x="62525.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU13</text>
<text text-anchor="middle" x="62525.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="62525.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="62525.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="62525.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_13 -->
<g id="edge1211" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61549.74,-2130.44C61775.86,-2122.08 62252.14,-2100.29 62432.92,-2058.1"/>
<polygon fill="black" stroke="black" points="62433.96,-2061.45 62442.85,-2055.68 62432.31,-2054.65 62433.96,-2061.45"/>
</g>
<!-- layer3_expert13_14 -->
<g id="node696" class="node">
<title>layer3_expert13_14</title>
<polygon fill="lightgreen" stroke="black" points="62791,-2058 62626,-2058 62626,-1975 62791,-1975 62791,-2058"/>
<text text-anchor="middle" x="62708.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU13</text>
<text text-anchor="middle" x="62708.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="62708.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="62708.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="62708.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_14 -->
<g id="edge1212" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61549.95,-2132.1C61807.56,-2126.18 62399,-2107.75 62615.82,-2058.11"/>
<polygon fill="black" stroke="black" points="62616.94,-2061.44 62625.86,-2055.73 62615.32,-2054.63 62616.94,-2061.44"/>
</g>
<!-- layer3_expert13_15 -->
<g id="node697" class="node">
<title>layer3_expert13_15</title>
<polygon fill="lightgreen" stroke="black" points="62974,-2058 62809,-2058 62809,-1975 62974,-1975 62974,-2058"/>
<text text-anchor="middle" x="62891.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU13</text>
<text text-anchor="middle" x="62891.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="62891.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="62891.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="62891.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_gate_gpu13&#45;&gt;layer3_expert13_15 -->
<g id="edge1213" class="edge">
<title>layer3_gate_gpu13&#45;&gt;layer3_expert13_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61549.66,-2133.34C61836.25,-2129.72 62546,-2115.31 62798.98,-2058.07"/>
<polygon fill="black" stroke="black" points="62799.93,-2061.44 62808.87,-2055.76 62798.33,-2054.63 62799.93,-2061.44"/>
</g>
<!-- layer3_moe_agg_gpu13 -->
<g id="node698" class="node">
<title>layer3_moe_agg_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="61441.5,-1939 61229.5,-1939 61229.5,-1856 61441.5,-1856 61441.5,-1939"/>
<text text-anchor="middle" x="61335.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU13</text>
<text text-anchor="middle" x="61335.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="61335.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="61335.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="61335.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_expert13_0&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1214" class="edge">
<title>layer3_expert13_0&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M60229.04,-1977.6C60232.2,-1976.65 60235.37,-1975.77 60238.5,-1975 60421.68,-1929.75 60975.97,-1908.77 61219.09,-1901.56"/>
<polygon fill="black" stroke="black" points="61219.48,-1905.05 61229.38,-1901.26 61219.28,-1898.05 61219.48,-1905.05"/>
</g>
<!-- layer3_expert13_1&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1215" class="edge">
<title>layer3_expert13_1&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M60412.05,-1977.66C60415.21,-1976.69 60418.37,-1975.8 60421.5,-1975 60569.35,-1937.39 61007.92,-1913.22 61219.18,-1903.45"/>
<polygon fill="black" stroke="black" points="61219.55,-1906.93 61229.38,-1902.98 61219.23,-1899.94 61219.55,-1906.93"/>
</g>
<!-- layer3_expert13_2&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1216" class="edge">
<title>layer3_expert13_2&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M60595.07,-1977.74C60598.23,-1976.75 60601.38,-1975.83 60604.5,-1975 60816.32,-1918.77 61072.96,-1903.55 61218.93,-1899.63"/>
<polygon fill="black" stroke="black" points="61219.34,-1903.12 61229.24,-1899.37 61219.16,-1896.13 61219.34,-1903.12"/>
</g>
<!-- layer3_expert13_3&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1217" class="edge">
<title>layer3_expert13_3&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M60778.11,-1977.88C60781.26,-1976.85 60784.39,-1975.88 60787.5,-1975 60933.15,-1933.64 61107.18,-1914.21 61219.44,-1905.38"/>
<polygon fill="black" stroke="black" points="61219.73,-1908.87 61229.43,-1904.61 61219.19,-1901.89 61219.73,-1908.87"/>
</g>
<!-- layer3_expert13_4&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1218" class="edge">
<title>layer3_expert13_4&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M60961.19,-1978.15C60964.32,-1977.04 60967.43,-1975.99 60970.5,-1975 61052.04,-1948.82 61146.77,-1929.27 61219.28,-1916.49"/>
<polygon fill="black" stroke="black" points="61220.12,-1919.9 61229.37,-1914.73 61218.91,-1913 61220.12,-1919.9"/>
</g>
<!-- layer3_expert13_5&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1219" class="edge">
<title>layer3_expert13_5&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M61144.22,-1979.01C61147.35,-1977.65 61150.45,-1976.31 61153.5,-1975 61177.79,-1964.55 61203.97,-1953.45 61228.69,-1943.04"/>
<polygon fill="black" stroke="black" points="61230.22,-1946.19 61238.09,-1939.09 61227.51,-1939.74 61230.22,-1946.19"/>
</g>
<!-- layer3_expert13_6&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1220" class="edge">
<title>layer3_expert13_6&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M61276.07,-1974.91C61283.06,-1965.92 61290.53,-1956.32 61297.74,-1947.05"/>
<polygon fill="black" stroke="black" points="61300.61,-1949.06 61303.98,-1939.02 61295.08,-1944.77 61300.61,-1949.06"/>
</g>
<!-- layer3_expert13_7&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1221" class="edge">
<title>layer3_expert13_7&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M61395.58,-1974.91C61388.52,-1965.92 61380.96,-1956.32 61373.68,-1947.05"/>
<polygon fill="black" stroke="black" points="61376.3,-1944.72 61367.36,-1939.02 61370.79,-1949.05 61376.3,-1944.72"/>
</g>
<!-- layer3_expert13_8&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1222" class="edge">
<title>layer3_expert13_8&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M61527.71,-1978.55C61524.94,-1977.35 61522.2,-1976.16 61519.5,-1975 61495.13,-1964.51 61468.84,-1953.44 61443.98,-1943.08"/>
<polygon fill="black" stroke="black" points="61445.1,-1939.75 61434.52,-1939.14 61442.41,-1946.22 61445.1,-1939.75"/>
</g>
<!-- layer3_expert13_9&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1223" class="edge">
<title>layer3_expert13_9&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M61710.97,-1977.87C61708.13,-1976.86 61705.3,-1975.9 61702.5,-1975 61620.42,-1948.52 61524.98,-1928.95 61452,-1916.24"/>
<polygon fill="black" stroke="black" points="61452.3,-1912.74 61441.85,-1914.49 61451.11,-1919.64 61452.3,-1912.74"/>
</g>
<!-- layer3_expert13_10&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1224" class="edge">
<title>layer3_expert13_10&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M61893.79,-1977.54C61891.01,-1976.64 61888.24,-1975.78 61885.5,-1975 61739.29,-1933.2 61564.44,-1913.87 61451.76,-1905.18"/>
<polygon fill="black" stroke="black" points="61451.97,-1901.69 61441.73,-1904.43 61451.44,-1908.67 61451.97,-1901.69"/>
</g>
<!-- layer3_expert13_11&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1225" class="edge">
<title>layer3_expert13_11&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M62076.82,-1977.42C62074.04,-1976.55 62071.26,-1975.74 62068.5,-1975 61856.06,-1918.18 61598.47,-1903.17 61452.12,-1899.44"/>
<polygon fill="black" stroke="black" points="61451.86,-1895.94 61441.77,-1899.2 61451.69,-1902.94 61451.86,-1895.94"/>
</g>
<!-- layer3_expert13_12&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1226" class="edge">
<title>layer3_expert13_12&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M62259.84,-1977.34C62257.05,-1976.49 62254.26,-1975.71 62251.5,-1975 62103.4,-1937.02 61663.83,-1913.04 61452.08,-1903.38"/>
<polygon fill="black" stroke="black" points="61452.01,-1899.87 61441.87,-1902.91 61451.7,-1906.86 61452.01,-1899.87"/>
</g>
<!-- layer3_expert13_13&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1227" class="edge">
<title>layer3_expert13_13&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M62442.86,-1977.29C62440.06,-1976.46 62437.27,-1975.69 62434.5,-1975 62251.08,-1929.31 61695.72,-1908.57 61452.13,-1901.49"/>
<polygon fill="black" stroke="black" points="61451.93,-1897.98 61441.83,-1901.19 61451.73,-1904.98 61451.93,-1897.98"/>
</g>
<!-- layer3_expert13_14&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1228" class="edge">
<title>layer3_expert13_14&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M62625.86,-1977.26C62623.06,-1976.43 62620.27,-1975.68 62617.5,-1975 62398.42,-1921.58 61725.18,-1904.82 61452.25,-1900.14"/>
<polygon fill="black" stroke="black" points="61451.98,-1896.63 61441.92,-1899.96 61451.86,-1903.63 61451.98,-1896.63"/>
</g>
<!-- layer3_expert13_15&#45;&gt;layer3_moe_agg_gpu13 -->
<g id="edge1229" class="edge">
<title>layer3_expert13_15&#45;&gt;layer3_moe_agg_gpu13</title>
<path fill="none" stroke="black" d="M62808.87,-1977.23C62806.07,-1976.41 62803.27,-1975.67 62800.5,-1975 62545.29,-1913.77 61751.49,-1901.55 61451.71,-1899.11"/>
<polygon fill="black" stroke="black" points="61451.72,-1895.61 61441.69,-1899.03 61451.66,-1902.61 61451.72,-1895.61"/>
</g>
<!-- layer3_output_gpu13 -->
<g id="node699" class="node">
<title>layer3_output_gpu13</title>
<polygon fill="lightgreen" stroke="black" points="57673,-1614 57420,-1614 57420,-1546 57673,-1546 57673,-1614"/>
<text text-anchor="middle" x="57546.5" y="-1598.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU13</text>
<text text-anchor="middle" x="57546.5" y="-1583.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="57546.5" y="-1568.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="57546.5" y="-1553.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_moe_agg_gpu13&#45;&gt;layer3_output_gpu13 -->
<g id="edge1230" class="edge">
<title>layer3_moe_agg_gpu13&#45;&gt;layer3_output_gpu13</title>
<path fill="none" stroke="black" d="M61229.28,-1894.82C60703.6,-1885.66 58377.86,-1835.09 57682.5,-1648 57657.82,-1641.36 57632.29,-1630.11 57610.11,-1618.71"/>
<polygon fill="black" stroke="black" points="57611.62,-1615.56 57601.14,-1614 57608.37,-1621.75 57611.62,-1615.56"/>
</g>
<!-- layer3_moe_agg_gpu13&#45;&gt;layer3_allreduce_moe -->
<g id="edge1327" class="edge">
<title>layer3_moe_agg_gpu13&#45;&gt;layer3_allreduce_moe</title>
<path fill="none" stroke="black" d="M61229.14,-1895.62C60707.79,-1891.08 58418.72,-1868.68 57707.5,-1820 57562.2,-1810.05 57397.21,-1790.01 57280.99,-1774.42"/>
<polygon fill="black" stroke="black" points="57281.33,-1770.94 57270.95,-1773.07 57280.4,-1777.87 57281.33,-1770.94"/>
</g>
<!-- layer3_output_gpu13&#45;&gt;output -->
<g id="edge1342" class="edge">
<title>layer3_output_gpu13&#45;&gt;output</title>
<path fill="none" stroke="black" d="M57483.24,-1546C57460.81,-1534.72 57435.24,-1522.36 57411.5,-1512 57358.02,-1488.67 57297.4,-1465.42 57246.98,-1446.92"/>
<polygon fill="black" stroke="black" points="57247.96,-1443.55 57237.37,-1443.41 57245.56,-1450.13 57247.96,-1443.55"/>
</g>
<!-- layer3_qkv_gpu14 -->
<g id="node700" class="node">
<title>layer3_qkv_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="57908.5,-2908 57698.5,-2908 57698.5,-2810 57908.5,-2810 57908.5,-2908"/>
<text text-anchor="middle" x="57803.5" y="-2892.8" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU14</text>
<text text-anchor="middle" x="57803.5" y="-2877.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="57803.5" y="-2862.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="57803.5" y="-2847.8" font-family="Times,serif" font-size="14.00">Heads: 24&#45;27</text>
<text text-anchor="middle" x="57803.5" y="-2832.8" font-family="Times,serif" font-size="14.00">TP Slice: 6</text>
<text text-anchor="middle" x="57803.5" y="-2817.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_attn_gpu14 -->
<g id="node701" class="node">
<title>layer3_attn_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="57929.5,-2766.5 57677.5,-2766.5 57677.5,-2683.5 57929.5,-2683.5 57929.5,-2766.5"/>
<text text-anchor="middle" x="57803.5" y="-2751.3" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU14</text>
<text text-anchor="middle" x="57803.5" y="-2736.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="57803.5" y="-2721.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="57803.5" y="-2706.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="57803.5" y="-2691.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_qkv_gpu14&#45;&gt;layer3_attn_gpu14 -->
<g id="edge1231" class="edge">
<title>layer3_qkv_gpu14&#45;&gt;layer3_attn_gpu14</title>
<path fill="none" stroke="black" d="M57803.5,-2809.97C57803.5,-2799.25 57803.5,-2787.84 57803.5,-2776.99"/>
<polygon fill="black" stroke="black" points="57807,-2776.82 57803.5,-2766.82 57800,-2776.82 57807,-2776.82"/>
</g>
<!-- layer3_attn_proj_gpu14 -->
<g id="node702" class="node">
<title>layer3_attn_proj_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="57908,-2632.5 57699,-2632.5 57699,-2564.5 57908,-2564.5 57908,-2632.5"/>
<text text-anchor="middle" x="57803.5" y="-2617.3" font-family="Times,serif" font-size="14.00">L3_Attn_Projection_GPU14</text>
<text text-anchor="middle" x="57803.5" y="-2602.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="57803.5" y="-2587.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="57803.5" y="-2572.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_attn_gpu14&#45;&gt;layer3_attn_proj_gpu14 -->
<g id="edge1232" class="edge">
<title>layer3_attn_gpu14&#45;&gt;layer3_attn_proj_gpu14</title>
<path fill="none" stroke="black" d="M57803.5,-2683.23C57803.5,-2670.36 57803.5,-2656.1 57803.5,-2643.04"/>
<polygon fill="black" stroke="black" points="57807,-2642.88 57803.5,-2632.88 57800,-2642.88 57807,-2642.88"/>
</g>
<!-- layer3_attn_norm_gpu14 -->
<g id="node703" class="node">
<title>layer3_attn_norm_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="57931,-2315 57678,-2315 57678,-2247 57931,-2247 57931,-2315"/>
<text text-anchor="middle" x="57804.5" y="-2299.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU14</text>
<text text-anchor="middle" x="57804.5" y="-2284.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="57804.5" y="-2269.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="57804.5" y="-2254.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_attn_proj_gpu14&#45;&gt;layer3_attn_norm_gpu14 -->
<g id="edge1233" class="edge">
<title>layer3_attn_proj_gpu14&#45;&gt;layer3_attn_norm_gpu14</title>
<path fill="none" stroke="black" d="M57803.61,-2564.33C57803.79,-2506.93 57804.16,-2389.12 57804.36,-2325.33"/>
<polygon fill="black" stroke="black" points="57807.86,-2325.21 57804.39,-2315.2 57800.86,-2325.19 57807.86,-2325.21"/>
</g>
<!-- layer3_attn_proj_gpu14&#45;&gt;layer3_allreduce_attn -->
<g id="edge1329" class="edge">
<title>layer3_attn_proj_gpu14&#45;&gt;layer3_allreduce_attn</title>
<path fill="none" stroke="black" d="M57698.65,-2569.12C57681.29,-2564.8 57663.43,-2560.6 57646.5,-2557 57489.01,-2523.56 57306.94,-2494.21 57182.01,-2475.49"/>
<polygon fill="black" stroke="black" points="57182.39,-2472.01 57171.99,-2473.99 57181.36,-2478.93 57182.39,-2472.01"/>
</g>
<!-- layer3_gate_gpu14 -->
<g id="node704" class="node">
<title>layer3_gate_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="64477.5,-2177 64233.5,-2177 64233.5,-2094 64477.5,-2094 64477.5,-2177"/>
<text text-anchor="middle" x="64355.5" y="-2161.8" font-family="Times,serif" font-size="14.00">L3_Gate_GPU14</text>
<text text-anchor="middle" x="64355.5" y="-2146.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="64355.5" y="-2131.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="64355.5" y="-2116.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="64355.5" y="-2101.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_attn_norm_gpu14&#45;&gt;layer3_gate_gpu14 -->
<g id="edge1234" class="edge">
<title>layer3_attn_norm_gpu14&#45;&gt;layer3_gate_gpu14</title>
<path fill="none" stroke="black" d="M57857.64,-2246.91C57881.94,-2233.63 57911.7,-2219.86 57940.5,-2213 58136.04,-2166.42 61357.51,-2179.46 61558.5,-2177 62584.3,-2164.47 63821.66,-2145.04 64222.97,-2138.63"/>
<polygon fill="black" stroke="black" points="64223.22,-2142.13 64233.16,-2138.47 64223.11,-2135.13 64223.22,-2142.13"/>
</g>
<!-- layer3_expert14_0 -->
<g id="node705" class="node">
<title>layer3_expert14_0</title>
<polygon fill="lightgreen" stroke="black" points="63157,-2058 62992,-2058 62992,-1975 63157,-1975 63157,-2058"/>
<text text-anchor="middle" x="63074.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU14</text>
<text text-anchor="middle" x="63074.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="63074.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="63074.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="63074.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_0 -->
<g id="edge1235" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64233.17,-2132.04C63975.68,-2125.99 63384.32,-2107.3 63166.79,-2057.73"/>
<polygon fill="black" stroke="black" points="63167.57,-2054.31 63157.03,-2055.42 63165.96,-2061.13 63167.57,-2054.31"/>
</g>
<!-- layer3_expert14_1 -->
<g id="node706" class="node">
<title>layer3_expert14_1</title>
<polygon fill="lightgreen" stroke="black" points="63340,-2058 63175,-2058 63175,-1975 63340,-1975 63340,-2058"/>
<text text-anchor="middle" x="63257.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU14</text>
<text text-anchor="middle" x="63257.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="63257.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="63257.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="63257.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_1 -->
<g id="edge1236" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64233.4,-2130.37C64007.52,-2121.9 63531.76,-2099.94 63350.03,-2057.78"/>
<polygon fill="black" stroke="black" points="63350.58,-2054.32 63340.04,-2055.37 63348.94,-2061.12 63350.58,-2054.32"/>
</g>
<!-- layer3_expert14_2 -->
<g id="node707" class="node">
<title>layer3_expert14_2</title>
<polygon fill="lightgreen" stroke="black" points="63523,-2058 63358,-2058 63358,-1975 63523,-1975 63523,-2058"/>
<text text-anchor="middle" x="63440.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU14</text>
<text text-anchor="middle" x="63440.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="63440.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="63440.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="63440.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_2 -->
<g id="edge1237" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64233.13,-2127.96C64041.69,-2116.93 63679.1,-2092.64 63533.18,-2057.83"/>
<polygon fill="black" stroke="black" points="63533.61,-2054.33 63523.06,-2055.3 63531.91,-2061.12 63533.61,-2054.33"/>
</g>
<!-- layer3_expert14_3 -->
<g id="node708" class="node">
<title>layer3_expert14_3</title>
<polygon fill="lightgreen" stroke="black" points="63706,-2058 63541,-2058 63541,-1975 63706,-1975 63706,-2058"/>
<text text-anchor="middle" x="63623.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU14</text>
<text text-anchor="middle" x="63623.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="63623.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="63623.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="63623.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_3 -->
<g id="edge1238" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64233.44,-2130.6C64105.41,-2124.1 63898.99,-2106.76 63715.89,-2057.85"/>
<polygon fill="black" stroke="black" points="63716.65,-2054.43 63706.09,-2055.2 63714.82,-2061.19 63716.65,-2054.43"/>
</g>
<!-- layer3_expert14_4 -->
<g id="node709" class="node">
<title>layer3_expert14_4</title>
<polygon fill="lightgreen" stroke="black" points="63889,-2058 63724,-2058 63724,-1975 63889,-1975 63889,-2058"/>
<text text-anchor="middle" x="63806.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU14</text>
<text text-anchor="middle" x="63806.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="63806.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="63806.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="63806.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_4 -->
<g id="edge1239" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64233.36,-2122.42C64142.76,-2111.52 64016.61,-2092.25 63899.04,-2057.94"/>
<polygon fill="black" stroke="black" points="63899.72,-2054.49 63889.14,-2055.01 63897.74,-2061.2 63899.72,-2054.49"/>
</g>
<!-- layer3_expert14_5 -->
<g id="node710" class="node">
<title>layer3_expert14_5</title>
<polygon fill="lightgreen" stroke="black" points="64072,-2058 63907,-2058 63907,-1975 64072,-1975 64072,-2058"/>
<text text-anchor="middle" x="63989.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU14</text>
<text text-anchor="middle" x="63989.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="63989.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="63989.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="63989.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_5 -->
<g id="edge1240" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64233.28,-2104.37C64185.46,-2091.55 64130.45,-2075.51 64081.5,-2058 64081.4,-2057.97 64081.3,-2057.93 64081.21,-2057.9"/>
<polygon fill="black" stroke="black" points="64082.62,-2054.69 64072.03,-2054.49 64080.19,-2061.25 64082.62,-2054.69"/>
</g>
<!-- layer3_expert14_6 -->
<g id="node711" class="node">
<title>layer3_expert14_6</title>
<polygon fill="lightgreen" stroke="black" points="64255,-2058 64090,-2058 64090,-1975 64255,-1975 64255,-2058"/>
<text text-anchor="middle" x="64172.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU14</text>
<text text-anchor="middle" x="64172.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="64172.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="64172.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="64172.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_6 -->
<g id="edge1241" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64292.01,-2093.91C64276.68,-2084.11 64260.19,-2073.56 64244.5,-2063.53"/>
<polygon fill="black" stroke="black" points="64246.19,-2060.46 64235.88,-2058.02 64242.42,-2066.36 64246.19,-2060.46"/>
</g>
<!-- layer3_expert14_7 -->
<g id="node712" class="node">
<title>layer3_expert14_7</title>
<polygon fill="lightgreen" stroke="black" points="64438,-2058 64273,-2058 64273,-1975 64438,-1975 64438,-2058"/>
<text text-anchor="middle" x="64355.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU14</text>
<text text-anchor="middle" x="64355.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="64355.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="64355.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="64355.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_7 -->
<g id="edge1242" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64355.5,-2093.91C64355.5,-2085.65 64355.5,-2076.86 64355.5,-2068.3"/>
<polygon fill="black" stroke="black" points="64359,-2068.02 64355.5,-2058.02 64352,-2068.02 64359,-2068.02"/>
</g>
<!-- layer3_expert14_8 -->
<g id="node713" class="node">
<title>layer3_expert14_8</title>
<polygon fill="lightgreen" stroke="black" points="64621,-2058 64456,-2058 64456,-1975 64621,-1975 64621,-2058"/>
<text text-anchor="middle" x="64538.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU14</text>
<text text-anchor="middle" x="64538.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="64538.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="64538.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="64538.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_8 -->
<g id="edge1243" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64418.99,-2093.91C64434.32,-2084.11 64450.81,-2073.56 64466.5,-2063.53"/>
<polygon fill="black" stroke="black" points="64468.58,-2066.36 64475.12,-2058.02 64464.81,-2060.46 64468.58,-2066.36"/>
</g>
<!-- layer3_expert14_9 -->
<g id="node714" class="node">
<title>layer3_expert14_9</title>
<polygon fill="lightgreen" stroke="black" points="64804,-2058 64639,-2058 64639,-1975 64804,-1975 64804,-2058"/>
<text text-anchor="middle" x="64721.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU14</text>
<text text-anchor="middle" x="64721.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="64721.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="64721.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="64721.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_9 -->
<g id="edge1244" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64477.53,-2104.69C64523.05,-2092.56 64575.13,-2077.48 64629.44,-2058.26"/>
<polygon fill="black" stroke="black" points="64630.65,-2061.55 64638.88,-2054.89 64628.29,-2054.96 64630.65,-2061.55"/>
</g>
<!-- layer3_expert14_10 -->
<g id="node715" class="node">
<title>layer3_expert14_10</title>
<polygon fill="lightgreen" stroke="black" points="64987,-2058 64822,-2058 64822,-1975 64987,-1975 64987,-2058"/>
<text text-anchor="middle" x="64904.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU14</text>
<text text-anchor="middle" x="64904.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="64904.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="64904.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="64904.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_10 -->
<g id="edge1245" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64477.95,-2122.58C64568.76,-2111.76 64695.19,-2092.52 64811.94,-2058.28"/>
<polygon fill="black" stroke="black" points="64813.17,-2061.57 64821.76,-2055.36 64811.18,-2054.86 64813.17,-2061.57"/>
</g>
<!-- layer3_expert14_11 -->
<g id="node716" class="node">
<title>layer3_expert14_11</title>
<polygon fill="lightgreen" stroke="black" points="65170,-2058 65005,-2058 65005,-1975 65170,-1975 65170,-2058"/>
<text text-anchor="middle" x="65087.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU14</text>
<text text-anchor="middle" x="65087.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="65087.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="65087.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="65087.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_11 -->
<g id="edge1246" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64477.79,-2130.77C64606.05,-2124.4 64812.82,-2107.17 64995.05,-2058.19"/>
<polygon fill="black" stroke="black" points="64996.08,-2061.53 65004.81,-2055.53 64994.24,-2054.78 64996.08,-2061.53"/>
</g>
<!-- layer3_expert14_12 -->
<g id="node717" class="node">
<title>layer3_expert14_12</title>
<polygon fill="lightgreen" stroke="black" points="65353,-2058 65188,-2058 65188,-1975 65353,-1975 65353,-2058"/>
<text text-anchor="middle" x="65270.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU14</text>
<text text-anchor="middle" x="65270.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="65270.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="65270.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="65270.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_12 -->
<g id="edge1247" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64477.64,-2128.05C64669.22,-2117.12 65032.68,-2092.96 65177.77,-2058.15"/>
<polygon fill="black" stroke="black" points="65178.99,-2061.45 65187.83,-2055.62 65177.28,-2054.66 65178.99,-2061.45"/>
</g>
<!-- layer3_expert14_13 -->
<g id="node718" class="node">
<title>layer3_expert14_13</title>
<polygon fill="lightgreen" stroke="black" points="65536,-2058 65371,-2058 65371,-1975 65536,-1975 65536,-2058"/>
<text text-anchor="middle" x="65453.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU14</text>
<text text-anchor="middle" x="65453.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="65453.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="65453.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="65453.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_13 -->
<g id="edge1248" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64477.74,-2130.44C64703.86,-2122.08 65180.14,-2100.29 65360.92,-2058.1"/>
<polygon fill="black" stroke="black" points="65361.96,-2061.45 65370.85,-2055.68 65360.31,-2054.65 65361.96,-2061.45"/>
</g>
<!-- layer3_expert14_14 -->
<g id="node719" class="node">
<title>layer3_expert14_14</title>
<polygon fill="lightgreen" stroke="black" points="65719,-2058 65554,-2058 65554,-1975 65719,-1975 65719,-2058"/>
<text text-anchor="middle" x="65636.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU14</text>
<text text-anchor="middle" x="65636.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="65636.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="65636.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="65636.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_14 -->
<g id="edge1249" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64477.95,-2132.1C64735.56,-2126.18 65327,-2107.75 65543.82,-2058.11"/>
<polygon fill="black" stroke="black" points="65544.94,-2061.44 65553.86,-2055.73 65543.32,-2054.63 65544.94,-2061.44"/>
</g>
<!-- layer3_expert14_15 -->
<g id="node720" class="node">
<title>layer3_expert14_15</title>
<polygon fill="lightgreen" stroke="black" points="65902,-2058 65737,-2058 65737,-1975 65902,-1975 65902,-2058"/>
<text text-anchor="middle" x="65819.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU14</text>
<text text-anchor="middle" x="65819.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="65819.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="65819.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="65819.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_gate_gpu14&#45;&gt;layer3_expert14_15 -->
<g id="edge1250" class="edge">
<title>layer3_gate_gpu14&#45;&gt;layer3_expert14_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M64477.66,-2133.34C64764.25,-2129.72 65474,-2115.31 65726.98,-2058.07"/>
<polygon fill="black" stroke="black" points="65727.93,-2061.44 65736.87,-2055.76 65726.33,-2054.63 65727.93,-2061.44"/>
</g>
<!-- layer3_moe_agg_gpu14 -->
<g id="node721" class="node">
<title>layer3_moe_agg_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="64369.5,-1939 64157.5,-1939 64157.5,-1856 64369.5,-1856 64369.5,-1939"/>
<text text-anchor="middle" x="64263.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU14</text>
<text text-anchor="middle" x="64263.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="64263.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="64263.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="64263.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_expert14_0&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1251" class="edge">
<title>layer3_expert14_0&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M63157.04,-1977.6C63160.2,-1976.65 63163.37,-1975.77 63166.5,-1975 63349.68,-1929.75 63903.97,-1908.77 64147.09,-1901.56"/>
<polygon fill="black" stroke="black" points="64147.48,-1905.05 64157.38,-1901.26 64147.28,-1898.05 64147.48,-1905.05"/>
</g>
<!-- layer3_expert14_1&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1252" class="edge">
<title>layer3_expert14_1&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M63340.05,-1977.66C63343.21,-1976.69 63346.37,-1975.8 63349.5,-1975 63497.35,-1937.39 63935.92,-1913.22 64147.18,-1903.45"/>
<polygon fill="black" stroke="black" points="64147.55,-1906.93 64157.38,-1902.98 64147.23,-1899.94 64147.55,-1906.93"/>
</g>
<!-- layer3_expert14_2&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1253" class="edge">
<title>layer3_expert14_2&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M63523.07,-1977.74C63526.23,-1976.75 63529.38,-1975.83 63532.5,-1975 63744.32,-1918.77 64000.96,-1903.55 64146.93,-1899.63"/>
<polygon fill="black" stroke="black" points="64147.34,-1903.12 64157.24,-1899.37 64147.16,-1896.13 64147.34,-1903.12"/>
</g>
<!-- layer3_expert14_3&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1254" class="edge">
<title>layer3_expert14_3&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M63706.11,-1977.88C63709.26,-1976.85 63712.39,-1975.88 63715.5,-1975 63861.15,-1933.64 64035.18,-1914.21 64147.44,-1905.38"/>
<polygon fill="black" stroke="black" points="64147.73,-1908.87 64157.43,-1904.61 64147.19,-1901.89 64147.73,-1908.87"/>
</g>
<!-- layer3_expert14_4&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1255" class="edge">
<title>layer3_expert14_4&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M63889.19,-1978.15C63892.32,-1977.04 63895.43,-1975.99 63898.5,-1975 63980.04,-1948.82 64074.77,-1929.27 64147.28,-1916.49"/>
<polygon fill="black" stroke="black" points="64148.12,-1919.9 64157.37,-1914.73 64146.91,-1913 64148.12,-1919.9"/>
</g>
<!-- layer3_expert14_5&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1256" class="edge">
<title>layer3_expert14_5&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M64072.22,-1979.01C64075.35,-1977.65 64078.45,-1976.31 64081.5,-1975 64105.79,-1964.55 64131.97,-1953.45 64156.69,-1943.04"/>
<polygon fill="black" stroke="black" points="64158.22,-1946.19 64166.09,-1939.09 64155.51,-1939.74 64158.22,-1946.19"/>
</g>
<!-- layer3_expert14_6&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1257" class="edge">
<title>layer3_expert14_6&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M64204.07,-1974.91C64211.06,-1965.92 64218.53,-1956.32 64225.74,-1947.05"/>
<polygon fill="black" stroke="black" points="64228.61,-1949.06 64231.98,-1939.02 64223.08,-1944.77 64228.61,-1949.06"/>
</g>
<!-- layer3_expert14_7&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1258" class="edge">
<title>layer3_expert14_7&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M64323.58,-1974.91C64316.52,-1965.92 64308.96,-1956.32 64301.68,-1947.05"/>
<polygon fill="black" stroke="black" points="64304.3,-1944.72 64295.36,-1939.02 64298.79,-1949.05 64304.3,-1944.72"/>
</g>
<!-- layer3_expert14_8&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1259" class="edge">
<title>layer3_expert14_8&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M64455.71,-1978.55C64452.94,-1977.35 64450.2,-1976.16 64447.5,-1975 64423.13,-1964.51 64396.84,-1953.44 64371.98,-1943.08"/>
<polygon fill="black" stroke="black" points="64373.1,-1939.75 64362.52,-1939.14 64370.41,-1946.22 64373.1,-1939.75"/>
</g>
<!-- layer3_expert14_9&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1260" class="edge">
<title>layer3_expert14_9&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M64638.97,-1977.87C64636.13,-1976.86 64633.3,-1975.9 64630.5,-1975 64548.42,-1948.52 64452.98,-1928.95 64380,-1916.24"/>
<polygon fill="black" stroke="black" points="64380.3,-1912.74 64369.85,-1914.49 64379.11,-1919.64 64380.3,-1912.74"/>
</g>
<!-- layer3_expert14_10&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1261" class="edge">
<title>layer3_expert14_10&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M64821.79,-1977.54C64819.01,-1976.64 64816.24,-1975.78 64813.5,-1975 64667.29,-1933.2 64492.44,-1913.87 64379.76,-1905.18"/>
<polygon fill="black" stroke="black" points="64379.97,-1901.69 64369.73,-1904.43 64379.44,-1908.67 64379.97,-1901.69"/>
</g>
<!-- layer3_expert14_11&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1262" class="edge">
<title>layer3_expert14_11&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M65004.82,-1977.42C65002.04,-1976.55 64999.26,-1975.74 64996.5,-1975 64784.06,-1918.18 64526.47,-1903.17 64380.12,-1899.44"/>
<polygon fill="black" stroke="black" points="64379.86,-1895.94 64369.77,-1899.2 64379.69,-1902.94 64379.86,-1895.94"/>
</g>
<!-- layer3_expert14_12&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1263" class="edge">
<title>layer3_expert14_12&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M65187.84,-1977.34C65185.05,-1976.49 65182.26,-1975.71 65179.5,-1975 65031.4,-1937.02 64591.83,-1913.04 64380.08,-1903.38"/>
<polygon fill="black" stroke="black" points="64380.01,-1899.87 64369.87,-1902.91 64379.7,-1906.86 64380.01,-1899.87"/>
</g>
<!-- layer3_expert14_13&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1264" class="edge">
<title>layer3_expert14_13&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M65370.86,-1977.29C65368.06,-1976.46 65365.27,-1975.69 65362.5,-1975 65179.08,-1929.31 64623.72,-1908.57 64380.13,-1901.49"/>
<polygon fill="black" stroke="black" points="64379.93,-1897.98 64369.83,-1901.19 64379.73,-1904.98 64379.93,-1897.98"/>
</g>
<!-- layer3_expert14_14&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1265" class="edge">
<title>layer3_expert14_14&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M65553.86,-1977.26C65551.06,-1976.43 65548.27,-1975.68 65545.5,-1975 65326.42,-1921.58 64653.18,-1904.82 64380.25,-1900.14"/>
<polygon fill="black" stroke="black" points="64379.98,-1896.63 64369.92,-1899.96 64379.86,-1903.63 64379.98,-1896.63"/>
</g>
<!-- layer3_expert14_15&#45;&gt;layer3_moe_agg_gpu14 -->
<g id="edge1266" class="edge">
<title>layer3_expert14_15&#45;&gt;layer3_moe_agg_gpu14</title>
<path fill="none" stroke="black" d="M65736.87,-1977.23C65734.07,-1976.41 65731.27,-1975.67 65728.5,-1975 65473.29,-1913.77 64679.49,-1901.55 64379.71,-1899.11"/>
<polygon fill="black" stroke="black" points="64379.72,-1895.61 64369.69,-1899.03 64379.66,-1902.61 64379.72,-1895.61"/>
</g>
<!-- layer3_output_gpu14 -->
<g id="node722" class="node">
<title>layer3_output_gpu14</title>
<polygon fill="lightgreen" stroke="black" points="57944,-1614 57691,-1614 57691,-1546 57944,-1546 57944,-1614"/>
<text text-anchor="middle" x="57817.5" y="-1598.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU14</text>
<text text-anchor="middle" x="57817.5" y="-1583.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="57817.5" y="-1568.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="57817.5" y="-1553.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_moe_agg_gpu14&#45;&gt;layer3_output_gpu14 -->
<g id="edge1267" class="edge">
<title>layer3_moe_agg_gpu14&#45;&gt;layer3_output_gpu14</title>
<path fill="none" stroke="black" d="M64157.31,-1894.85C63767.86,-1888.59 62381.24,-1864.36 61238.5,-1820 61192.85,-1818.23 57997.71,-1659.53 57953.5,-1648 57928.65,-1641.52 57902.99,-1630.25 57880.75,-1618.78"/>
<polygon fill="black" stroke="black" points="57882.24,-1615.61 57871.76,-1614.04 57878.97,-1621.8 57882.24,-1615.61"/>
</g>
<!-- layer3_moe_agg_gpu14&#45;&gt;layer3_allreduce_moe -->
<g id="edge1331" class="edge">
<title>layer3_moe_agg_gpu14&#45;&gt;layer3_allreduce_moe</title>
<path fill="none" stroke="black" d="M64157.48,-1894.37C63366.75,-1878.46 58390.94,-1778.36 57329.52,-1757"/>
<polygon fill="black" stroke="black" points="57329.57,-1753.5 57319.5,-1756.8 57329.43,-1760.5 57329.57,-1753.5"/>
</g>
<!-- layer3_output_gpu14&#45;&gt;output -->
<g id="edge1343" class="edge">
<title>layer3_output_gpu14&#45;&gt;output</title>
<path fill="none" stroke="black" d="M57759.52,-1545.87C57736.19,-1533.71 57708.67,-1520.79 57682.5,-1512 57577.53,-1476.74 57456.85,-1452.34 57355.96,-1436.17"/>
<polygon fill="black" stroke="black" points="57356.37,-1432.69 57345.94,-1434.58 57355.27,-1439.61 57356.37,-1432.69"/>
</g>
<!-- layer3_qkv_gpu15 -->
<g id="node723" class="node">
<title>layer3_qkv_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="58179.5,-2908 57969.5,-2908 57969.5,-2810 58179.5,-2810 58179.5,-2908"/>
<text text-anchor="middle" x="58074.5" y="-2892.8" font-family="Times,serif" font-size="14.00">L3_QKV_Projection_GPU15</text>
<text text-anchor="middle" x="58074.5" y="-2877.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,4096]</text>
<text text-anchor="middle" x="58074.5" y="-2862.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,3*512]</text>
<text text-anchor="middle" x="58074.5" y="-2847.8" font-family="Times,serif" font-size="14.00">Heads: 28&#45;31</text>
<text text-anchor="middle" x="58074.5" y="-2832.8" font-family="Times,serif" font-size="14.00">TP Slice: 7</text>
<text text-anchor="middle" x="58074.5" y="-2817.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_attn_gpu15 -->
<g id="node724" class="node">
<title>layer3_attn_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="58200.5,-2766.5 57948.5,-2766.5 57948.5,-2683.5 58200.5,-2683.5 58200.5,-2766.5"/>
<text text-anchor="middle" x="58074.5" y="-2751.3" font-family="Times,serif" font-size="14.00">L3_Multi&#45;Head_Attention_GPU15</text>
<text text-anchor="middle" x="58074.5" y="-2736.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x8</text>
<text text-anchor="middle" x="58074.5" y="-2721.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="58074.5" y="-2706.3" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="58074.5" y="-2691.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_qkv_gpu15&#45;&gt;layer3_attn_gpu15 -->
<g id="edge1268" class="edge">
<title>layer3_qkv_gpu15&#45;&gt;layer3_attn_gpu15</title>
<path fill="none" stroke="black" d="M58074.5,-2809.97C58074.5,-2799.25 58074.5,-2787.84 58074.5,-2776.99"/>
<polygon fill="black" stroke="black" points="58078,-2776.82 58074.5,-2766.82 58071,-2776.82 58078,-2776.82"/>
</g>
<!-- layer3_attn_proj_gpu15 -->
<g id="node725" class="node">
<title>layer3_attn_proj_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="58179,-2632.5 57970,-2632.5 57970,-2564.5 58179,-2564.5 58179,-2632.5"/>
<text text-anchor="middle" x="58074.5" y="-2617.3" font-family="Times,serif" font-size="14.00">L3_Attn_Projection_GPU15</text>
<text text-anchor="middle" x="58074.5" y="-2602.3" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="58074.5" y="-2587.3" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="58074.5" y="-2572.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_attn_gpu15&#45;&gt;layer3_attn_proj_gpu15 -->
<g id="edge1269" class="edge">
<title>layer3_attn_gpu15&#45;&gt;layer3_attn_proj_gpu15</title>
<path fill="none" stroke="black" d="M58074.5,-2683.23C58074.5,-2670.36 58074.5,-2656.1 58074.5,-2643.04"/>
<polygon fill="black" stroke="black" points="58078,-2642.88 58074.5,-2632.88 58071,-2642.88 58078,-2642.88"/>
</g>
<!-- layer3_attn_norm_gpu15 -->
<g id="node726" class="node">
<title>layer3_attn_norm_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="58202,-2315 57949,-2315 57949,-2247 58202,-2247 58202,-2315"/>
<text text-anchor="middle" x="58075.5" y="-2299.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU15</text>
<text text-anchor="middle" x="58075.5" y="-2284.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="58075.5" y="-2269.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="58075.5" y="-2254.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_attn_proj_gpu15&#45;&gt;layer3_attn_norm_gpu15 -->
<g id="edge1270" class="edge">
<title>layer3_attn_proj_gpu15&#45;&gt;layer3_attn_norm_gpu15</title>
<path fill="none" stroke="black" d="M58074.61,-2564.33C58074.79,-2506.93 58075.16,-2389.12 58075.36,-2325.33"/>
<polygon fill="black" stroke="black" points="58078.86,-2325.21 58075.39,-2315.2 58071.86,-2325.19 58078.86,-2325.21"/>
</g>
<!-- layer3_attn_proj_gpu15&#45;&gt;layer3_allreduce_attn -->
<g id="edge1333" class="edge">
<title>layer3_attn_proj_gpu15&#45;&gt;layer3_allreduce_attn</title>
<path fill="none" stroke="black" d="M57969.8,-2568.38C57952.42,-2564.15 57934.52,-2560.17 57917.5,-2557 57672.09,-2511.3 57384.43,-2482.32 57205.04,-2467.11"/>
<polygon fill="black" stroke="black" points="57205.24,-2463.62 57194.99,-2466.27 57204.66,-2470.59 57205.24,-2463.62"/>
</g>
<!-- layer3_gate_gpu15 -->
<g id="node727" class="node">
<title>layer3_gate_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="67405.5,-2177 67161.5,-2177 67161.5,-2094 67405.5,-2094 67405.5,-2177"/>
<text text-anchor="middle" x="67283.5" y="-2161.8" font-family="Times,serif" font-size="14.00">L3_Gate_GPU15</text>
<text text-anchor="middle" x="67283.5" y="-2146.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]</text>
<text text-anchor="middle" x="67283.5" y="-2131.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,16 experts]</text>
<text text-anchor="middle" x="67283.5" y="-2116.8" font-family="Times,serif" font-size="14.00">TP: expert routing</text>
<text text-anchor="middle" x="67283.5" y="-2101.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_attn_norm_gpu15&#45;&gt;layer3_gate_gpu15 -->
<g id="edge1271" class="edge">
<title>layer3_attn_norm_gpu15&#45;&gt;layer3_gate_gpu15</title>
<path fill="none" stroke="black" d="M58202.16,-2278.03C59223.88,-2262.1 66108.31,-2154.81 67151.23,-2138.56"/>
<polygon fill="black" stroke="black" points="67151.44,-2142.06 67161.38,-2138.4 67151.33,-2135.06 67151.44,-2142.06"/>
</g>
<!-- layer3_expert15_0 -->
<g id="node728" class="node">
<title>layer3_expert15_0</title>
<polygon fill="lightgreen" stroke="black" points="66085,-2058 65920,-2058 65920,-1975 66085,-1975 66085,-2058"/>
<text text-anchor="middle" x="66002.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert0_GPU15</text>
<text text-anchor="middle" x="66002.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="66002.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="66002.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="66002.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_0 -->
<g id="edge1272" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67161.17,-2132.04C66903.68,-2125.99 66312.32,-2107.3 66094.79,-2057.73"/>
<polygon fill="black" stroke="black" points="66095.57,-2054.31 66085.03,-2055.42 66093.96,-2061.13 66095.57,-2054.31"/>
</g>
<!-- layer3_expert15_1 -->
<g id="node729" class="node">
<title>layer3_expert15_1</title>
<polygon fill="lightgreen" stroke="black" points="66268,-2058 66103,-2058 66103,-1975 66268,-1975 66268,-2058"/>
<text text-anchor="middle" x="66185.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert1_GPU15</text>
<text text-anchor="middle" x="66185.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="66185.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="66185.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="66185.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_1 -->
<g id="edge1273" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67161.4,-2130.37C66935.52,-2121.9 66459.76,-2099.94 66278.03,-2057.78"/>
<polygon fill="black" stroke="black" points="66278.58,-2054.32 66268.04,-2055.37 66276.94,-2061.12 66278.58,-2054.32"/>
</g>
<!-- layer3_expert15_2 -->
<g id="node730" class="node">
<title>layer3_expert15_2</title>
<polygon fill="lightgreen" stroke="black" points="66451,-2058 66286,-2058 66286,-1975 66451,-1975 66451,-2058"/>
<text text-anchor="middle" x="66368.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert2_GPU15</text>
<text text-anchor="middle" x="66368.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="66368.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="66368.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="66368.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_2 -->
<g id="edge1274" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67161.13,-2127.96C66969.69,-2116.93 66607.1,-2092.64 66461.18,-2057.83"/>
<polygon fill="black" stroke="black" points="66461.61,-2054.33 66451.06,-2055.3 66459.91,-2061.12 66461.61,-2054.33"/>
</g>
<!-- layer3_expert15_3 -->
<g id="node731" class="node">
<title>layer3_expert15_3</title>
<polygon fill="lightgreen" stroke="black" points="66634,-2058 66469,-2058 66469,-1975 66634,-1975 66634,-2058"/>
<text text-anchor="middle" x="66551.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert3_GPU15</text>
<text text-anchor="middle" x="66551.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="66551.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="66551.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="66551.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_3 -->
<g id="edge1275" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67161.44,-2130.6C67033.41,-2124.1 66826.99,-2106.76 66643.89,-2057.85"/>
<polygon fill="black" stroke="black" points="66644.65,-2054.43 66634.09,-2055.2 66642.82,-2061.19 66644.65,-2054.43"/>
</g>
<!-- layer3_expert15_4 -->
<g id="node732" class="node">
<title>layer3_expert15_4</title>
<polygon fill="lightgreen" stroke="black" points="66817,-2058 66652,-2058 66652,-1975 66817,-1975 66817,-2058"/>
<text text-anchor="middle" x="66734.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert4_GPU15</text>
<text text-anchor="middle" x="66734.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="66734.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="66734.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="66734.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_4 -->
<g id="edge1276" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67161.36,-2122.42C67070.76,-2111.52 66944.61,-2092.25 66827.04,-2057.94"/>
<polygon fill="black" stroke="black" points="66827.72,-2054.49 66817.14,-2055.01 66825.74,-2061.2 66827.72,-2054.49"/>
</g>
<!-- layer3_expert15_5 -->
<g id="node733" class="node">
<title>layer3_expert15_5</title>
<polygon fill="lightgreen" stroke="black" points="67000,-2058 66835,-2058 66835,-1975 67000,-1975 67000,-2058"/>
<text text-anchor="middle" x="66917.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert5_GPU15</text>
<text text-anchor="middle" x="66917.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="66917.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="66917.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="66917.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_5 -->
<g id="edge1277" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67161.28,-2104.37C67113.46,-2091.55 67058.45,-2075.51 67009.5,-2058 67009.4,-2057.97 67009.3,-2057.93 67009.21,-2057.9"/>
<polygon fill="black" stroke="black" points="67010.62,-2054.69 67000.03,-2054.49 67008.19,-2061.25 67010.62,-2054.69"/>
</g>
<!-- layer3_expert15_6 -->
<g id="node734" class="node">
<title>layer3_expert15_6</title>
<polygon fill="lightgreen" stroke="black" points="67183,-2058 67018,-2058 67018,-1975 67183,-1975 67183,-2058"/>
<text text-anchor="middle" x="67100.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert6_GPU15</text>
<text text-anchor="middle" x="67100.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="67100.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="67100.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="67100.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_6 -->
<g id="edge1278" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67220.01,-2093.91C67204.68,-2084.11 67188.19,-2073.56 67172.5,-2063.53"/>
<polygon fill="black" stroke="black" points="67174.19,-2060.46 67163.88,-2058.02 67170.42,-2066.36 67174.19,-2060.46"/>
</g>
<!-- layer3_expert15_7 -->
<g id="node735" class="node">
<title>layer3_expert15_7</title>
<polygon fill="lightgreen" stroke="black" points="67366,-2058 67201,-2058 67201,-1975 67366,-1975 67366,-2058"/>
<text text-anchor="middle" x="67283.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert7_GPU15</text>
<text text-anchor="middle" x="67283.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="67283.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="67283.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="67283.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_7 -->
<g id="edge1279" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67283.5,-2093.91C67283.5,-2085.65 67283.5,-2076.86 67283.5,-2068.3"/>
<polygon fill="black" stroke="black" points="67287,-2068.02 67283.5,-2058.02 67280,-2068.02 67287,-2068.02"/>
</g>
<!-- layer3_expert15_8 -->
<g id="node736" class="node">
<title>layer3_expert15_8</title>
<polygon fill="lightgreen" stroke="black" points="67549,-2058 67384,-2058 67384,-1975 67549,-1975 67549,-2058"/>
<text text-anchor="middle" x="67466.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert8_GPU15</text>
<text text-anchor="middle" x="67466.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="67466.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="67466.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="67466.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_8 -->
<g id="edge1280" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67346.99,-2093.91C67362.32,-2084.11 67378.81,-2073.56 67394.5,-2063.53"/>
<polygon fill="black" stroke="black" points="67396.58,-2066.36 67403.12,-2058.02 67392.81,-2060.46 67396.58,-2066.36"/>
</g>
<!-- layer3_expert15_9 -->
<g id="node737" class="node">
<title>layer3_expert15_9</title>
<polygon fill="lightgreen" stroke="black" points="67732,-2058 67567,-2058 67567,-1975 67732,-1975 67732,-2058"/>
<text text-anchor="middle" x="67649.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert9_GPU15</text>
<text text-anchor="middle" x="67649.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="67649.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="67649.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="67649.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_9 -->
<g id="edge1281" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67405.53,-2104.69C67451.05,-2092.56 67503.13,-2077.48 67557.44,-2058.26"/>
<polygon fill="black" stroke="black" points="67558.65,-2061.55 67566.88,-2054.89 67556.29,-2054.96 67558.65,-2061.55"/>
</g>
<!-- layer3_expert15_10 -->
<g id="node738" class="node">
<title>layer3_expert15_10</title>
<polygon fill="lightgreen" stroke="black" points="67915,-2058 67750,-2058 67750,-1975 67915,-1975 67915,-2058"/>
<text text-anchor="middle" x="67832.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert10_GPU15</text>
<text text-anchor="middle" x="67832.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="67832.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="67832.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="67832.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_10 -->
<g id="edge1282" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67405.95,-2122.58C67496.76,-2111.76 67623.19,-2092.52 67739.94,-2058.28"/>
<polygon fill="black" stroke="black" points="67741.17,-2061.57 67749.76,-2055.36 67739.18,-2054.86 67741.17,-2061.57"/>
</g>
<!-- layer3_expert15_11 -->
<g id="node739" class="node">
<title>layer3_expert15_11</title>
<polygon fill="lightgreen" stroke="black" points="68098,-2058 67933,-2058 67933,-1975 68098,-1975 68098,-2058"/>
<text text-anchor="middle" x="68015.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert11_GPU15</text>
<text text-anchor="middle" x="68015.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="68015.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="68015.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="68015.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_11 -->
<g id="edge1283" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67405.79,-2130.77C67534.05,-2124.4 67740.82,-2107.17 67923.05,-2058.19"/>
<polygon fill="black" stroke="black" points="67924.08,-2061.53 67932.81,-2055.53 67922.24,-2054.78 67924.08,-2061.53"/>
</g>
<!-- layer3_expert15_12 -->
<g id="node740" class="node">
<title>layer3_expert15_12</title>
<polygon fill="lightgreen" stroke="black" points="68281,-2058 68116,-2058 68116,-1975 68281,-1975 68281,-2058"/>
<text text-anchor="middle" x="68198.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert12_GPU15</text>
<text text-anchor="middle" x="68198.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="68198.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="68198.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="68198.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_12 -->
<g id="edge1284" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67405.64,-2128.05C67597.22,-2117.12 67960.68,-2092.96 68105.77,-2058.15"/>
<polygon fill="black" stroke="black" points="68106.99,-2061.45 68115.83,-2055.62 68105.28,-2054.66 68106.99,-2061.45"/>
</g>
<!-- layer3_expert15_13 -->
<g id="node741" class="node">
<title>layer3_expert15_13</title>
<polygon fill="lightgreen" stroke="black" points="68464,-2058 68299,-2058 68299,-1975 68464,-1975 68464,-2058"/>
<text text-anchor="middle" x="68381.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert13_GPU15</text>
<text text-anchor="middle" x="68381.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="68381.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="68381.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="68381.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_13 -->
<g id="edge1285" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67405.74,-2130.44C67631.86,-2122.08 68108.14,-2100.29 68288.92,-2058.1"/>
<polygon fill="black" stroke="black" points="68289.96,-2061.45 68298.85,-2055.68 68288.31,-2054.65 68289.96,-2061.45"/>
</g>
<!-- layer3_expert15_14 -->
<g id="node742" class="node">
<title>layer3_expert15_14</title>
<polygon fill="lightgreen" stroke="black" points="68647,-2058 68482,-2058 68482,-1975 68647,-1975 68647,-2058"/>
<text text-anchor="middle" x="68564.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert14_GPU15</text>
<text text-anchor="middle" x="68564.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="68564.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="68564.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="68564.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_14 -->
<g id="edge1286" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67405.95,-2132.1C67663.56,-2126.18 68255,-2107.75 68471.82,-2058.11"/>
<polygon fill="black" stroke="black" points="68472.94,-2061.44 68481.86,-2055.73 68471.32,-2054.63 68472.94,-2061.44"/>
</g>
<!-- layer3_expert15_15 -->
<g id="node743" class="node">
<title>layer3_expert15_15</title>
<polygon fill="lightgreen" stroke="black" points="68830,-2058 68665,-2058 68665,-1975 68830,-1975 68830,-2058"/>
<text text-anchor="middle" x="68747.5" y="-2042.8" font-family="Times,serif" font-size="14.00">L3_Expert15_GPU15</text>
<text text-anchor="middle" x="68747.5" y="-2027.8" font-family="Times,serif" font-size="14.00">Input: [tokens,512]</text>
<text text-anchor="middle" x="68747.5" y="-2012.8" font-family="Times,serif" font-size="14.00">Output: [tokens,512]</text>
<text text-anchor="middle" x="68747.5" y="-1997.8" font-family="Times,serif" font-size="14.00">TP slice</text>
<text text-anchor="middle" x="68747.5" y="-1982.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_gate_gpu15&#45;&gt;layer3_expert15_15 -->
<g id="edge1287" class="edge">
<title>layer3_gate_gpu15&#45;&gt;layer3_expert15_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67405.66,-2133.34C67692.25,-2129.72 68402,-2115.31 68654.98,-2058.07"/>
<polygon fill="black" stroke="black" points="68655.93,-2061.44 68664.87,-2055.76 68654.33,-2054.63 68655.93,-2061.44"/>
</g>
<!-- layer3_moe_agg_gpu15 -->
<g id="node744" class="node">
<title>layer3_moe_agg_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="67297.5,-1939 67085.5,-1939 67085.5,-1856 67297.5,-1856 67297.5,-1939"/>
<text text-anchor="middle" x="67191.5" y="-1923.8" font-family="Times,serif" font-size="14.00">L3_MoE_Aggregate_GPU15</text>
<text text-anchor="middle" x="67191.5" y="-1908.8" font-family="Times,serif" font-size="14.00">Input: 16×[tokens,512]</text>
<text text-anchor="middle" x="67191.5" y="-1893.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="67191.5" y="-1878.8" font-family="Times,serif" font-size="14.00">TP Reduction</text>
<text text-anchor="middle" x="67191.5" y="-1863.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_expert15_0&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1288" class="edge">
<title>layer3_expert15_0&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M66085.04,-1977.6C66088.2,-1976.65 66091.37,-1975.77 66094.5,-1975 66277.68,-1929.75 66831.97,-1908.77 67075.09,-1901.56"/>
<polygon fill="black" stroke="black" points="67075.48,-1905.05 67085.38,-1901.26 67075.28,-1898.05 67075.48,-1905.05"/>
</g>
<!-- layer3_expert15_1&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1289" class="edge">
<title>layer3_expert15_1&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M66268.05,-1977.66C66271.21,-1976.69 66274.37,-1975.8 66277.5,-1975 66425.35,-1937.39 66863.92,-1913.22 67075.18,-1903.45"/>
<polygon fill="black" stroke="black" points="67075.55,-1906.93 67085.38,-1902.98 67075.23,-1899.94 67075.55,-1906.93"/>
</g>
<!-- layer3_expert15_2&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1290" class="edge">
<title>layer3_expert15_2&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M66451.07,-1977.74C66454.23,-1976.75 66457.38,-1975.83 66460.5,-1975 66672.32,-1918.77 66928.96,-1903.55 67074.93,-1899.63"/>
<polygon fill="black" stroke="black" points="67075.34,-1903.12 67085.24,-1899.37 67075.16,-1896.13 67075.34,-1903.12"/>
</g>
<!-- layer3_expert15_3&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1291" class="edge">
<title>layer3_expert15_3&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M66634.11,-1977.88C66637.26,-1976.85 66640.39,-1975.88 66643.5,-1975 66789.15,-1933.64 66963.18,-1914.21 67075.44,-1905.38"/>
<polygon fill="black" stroke="black" points="67075.73,-1908.87 67085.43,-1904.61 67075.19,-1901.89 67075.73,-1908.87"/>
</g>
<!-- layer3_expert15_4&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1292" class="edge">
<title>layer3_expert15_4&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M66817.19,-1978.15C66820.32,-1977.04 66823.43,-1975.99 66826.5,-1975 66908.04,-1948.82 67002.77,-1929.27 67075.28,-1916.49"/>
<polygon fill="black" stroke="black" points="67076.12,-1919.9 67085.37,-1914.73 67074.91,-1913 67076.12,-1919.9"/>
</g>
<!-- layer3_expert15_5&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1293" class="edge">
<title>layer3_expert15_5&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M67000.22,-1979.01C67003.35,-1977.65 67006.45,-1976.31 67009.5,-1975 67033.79,-1964.55 67059.97,-1953.45 67084.69,-1943.04"/>
<polygon fill="black" stroke="black" points="67086.22,-1946.19 67094.09,-1939.09 67083.51,-1939.74 67086.22,-1946.19"/>
</g>
<!-- layer3_expert15_6&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1294" class="edge">
<title>layer3_expert15_6&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M67132.07,-1974.91C67139.06,-1965.92 67146.53,-1956.32 67153.74,-1947.05"/>
<polygon fill="black" stroke="black" points="67156.61,-1949.06 67159.98,-1939.02 67151.08,-1944.77 67156.61,-1949.06"/>
</g>
<!-- layer3_expert15_7&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1295" class="edge">
<title>layer3_expert15_7&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M67251.58,-1974.91C67244.52,-1965.92 67236.96,-1956.32 67229.68,-1947.05"/>
<polygon fill="black" stroke="black" points="67232.3,-1944.72 67223.36,-1939.02 67226.79,-1949.05 67232.3,-1944.72"/>
</g>
<!-- layer3_expert15_8&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1296" class="edge">
<title>layer3_expert15_8&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M67383.71,-1978.55C67380.94,-1977.35 67378.2,-1976.16 67375.5,-1975 67351.13,-1964.51 67324.84,-1953.44 67299.98,-1943.08"/>
<polygon fill="black" stroke="black" points="67301.1,-1939.75 67290.52,-1939.14 67298.41,-1946.22 67301.1,-1939.75"/>
</g>
<!-- layer3_expert15_9&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1297" class="edge">
<title>layer3_expert15_9&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M67566.97,-1977.87C67564.13,-1976.86 67561.3,-1975.9 67558.5,-1975 67476.42,-1948.52 67380.98,-1928.95 67308,-1916.24"/>
<polygon fill="black" stroke="black" points="67308.3,-1912.74 67297.85,-1914.49 67307.11,-1919.64 67308.3,-1912.74"/>
</g>
<!-- layer3_expert15_10&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1298" class="edge">
<title>layer3_expert15_10&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M67749.79,-1977.54C67747.01,-1976.64 67744.24,-1975.78 67741.5,-1975 67595.29,-1933.2 67420.44,-1913.87 67307.76,-1905.18"/>
<polygon fill="black" stroke="black" points="67307.97,-1901.69 67297.73,-1904.43 67307.44,-1908.67 67307.97,-1901.69"/>
</g>
<!-- layer3_expert15_11&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1299" class="edge">
<title>layer3_expert15_11&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M67932.82,-1977.42C67930.04,-1976.55 67927.26,-1975.74 67924.5,-1975 67712.06,-1918.18 67454.47,-1903.17 67308.12,-1899.44"/>
<polygon fill="black" stroke="black" points="67307.86,-1895.94 67297.77,-1899.2 67307.69,-1902.94 67307.86,-1895.94"/>
</g>
<!-- layer3_expert15_12&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1300" class="edge">
<title>layer3_expert15_12&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M68115.84,-1977.34C68113.05,-1976.49 68110.26,-1975.71 68107.5,-1975 67959.4,-1937.02 67519.83,-1913.04 67308.08,-1903.38"/>
<polygon fill="black" stroke="black" points="67308.01,-1899.87 67297.87,-1902.91 67307.7,-1906.86 67308.01,-1899.87"/>
</g>
<!-- layer3_expert15_13&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1301" class="edge">
<title>layer3_expert15_13&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M68298.86,-1977.29C68296.06,-1976.46 68293.27,-1975.69 68290.5,-1975 68107.08,-1929.31 67551.72,-1908.57 67308.13,-1901.49"/>
<polygon fill="black" stroke="black" points="67307.93,-1897.98 67297.83,-1901.19 67307.73,-1904.98 67307.93,-1897.98"/>
</g>
<!-- layer3_expert15_14&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1302" class="edge">
<title>layer3_expert15_14&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M68481.86,-1977.26C68479.06,-1976.43 68476.27,-1975.68 68473.5,-1975 68254.42,-1921.58 67581.18,-1904.82 67308.25,-1900.14"/>
<polygon fill="black" stroke="black" points="67307.98,-1896.63 67297.92,-1899.96 67307.86,-1903.63 67307.98,-1896.63"/>
</g>
<!-- layer3_expert15_15&#45;&gt;layer3_moe_agg_gpu15 -->
<g id="edge1303" class="edge">
<title>layer3_expert15_15&#45;&gt;layer3_moe_agg_gpu15</title>
<path fill="none" stroke="black" d="M68664.87,-1977.23C68662.07,-1976.41 68659.27,-1975.67 68656.5,-1975 68401.29,-1913.77 67607.49,-1901.55 67307.71,-1899.11"/>
<polygon fill="black" stroke="black" points="67307.72,-1895.61 67297.69,-1899.03 67307.66,-1902.61 67307.72,-1895.61"/>
</g>
<!-- layer3_output_gpu15 -->
<g id="node745" class="node">
<title>layer3_output_gpu15</title>
<polygon fill="lightgreen" stroke="black" points="58215,-1614 57962,-1614 57962,-1546 58215,-1546 58215,-1614"/>
<text text-anchor="middle" x="58088.5" y="-1598.8" font-family="Times,serif" font-size="14.00">L3_Residual+LayerNorm_GPU15</text>
<text text-anchor="middle" x="58088.5" y="-1583.8" font-family="Times,serif" font-size="14.00">Input: [1024,2048,512]x2</text>
<text text-anchor="middle" x="58088.5" y="-1568.8" font-family="Times,serif" font-size="14.00">Output: [1024,2048,512]</text>
<text text-anchor="middle" x="58088.5" y="-1553.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_moe_agg_gpu15&#45;&gt;layer3_output_gpu15 -->
<g id="edge1304" class="edge">
<title>layer3_moe_agg_gpu15&#45;&gt;layer3_output_gpu15</title>
<path fill="none" stroke="black" d="M67085.33,-1892.82C66147.19,-1860.31 59283.76,-1622.43 58225.38,-1585.74"/>
<polygon fill="black" stroke="black" points="58225.18,-1582.24 58215.07,-1585.39 58224.94,-1589.23 58225.18,-1582.24"/>
</g>
<!-- layer3_moe_agg_gpu15&#45;&gt;layer3_allreduce_moe -->
<g id="edge1335" class="edge">
<title>layer3_moe_agg_gpu15&#45;&gt;layer3_allreduce_moe</title>
<path fill="none" stroke="black" d="M67085.49,-1894.86C66713.73,-1889.14 65434.62,-1869.66 64378.5,-1856 62982.97,-1837.95 62634.01,-1839.38 61238.5,-1820 59736.66,-1799.14 57926.09,-1767.27 57330.8,-1756.61"/>
<polygon fill="black" stroke="black" points="57330.46,-1753.1 57320.4,-1756.42 57330.33,-1760.1 57330.46,-1753.1"/>
</g>
<!-- layer3_output_gpu15&#45;&gt;output -->
<g id="edge1344" class="edge">
<title>layer3_output_gpu15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M58032.43,-1545.9C58008.81,-1533.37 57980.55,-1520.17 57953.5,-1512 57782.2,-1460.27 57583.02,-1434.51 57424.56,-1421.68"/>
<polygon fill="black" stroke="black" points="57424.43,-1418.16 57414.19,-1420.86 57423.88,-1425.14 57424.43,-1418.16"/>
</g>
<!-- layer3_allreduce_attn&#45;&gt;layer3_attn_norm_gpu8 -->
<g id="edge1306" class="edge">
<title>layer3_allreduce_attn&#45;&gt;layer3_attn_norm_gpu8</title>
<path fill="none" stroke="black" d="M56858.93,-2442.79C56713.13,-2431.28 56500.26,-2405.65 56322.5,-2349 56299.71,-2341.74 56276.06,-2330.82 56255.24,-2319.9"/>
<polygon fill="black" stroke="black" points="56256.66,-2316.69 56246.19,-2315.06 56253.36,-2322.86 56256.66,-2316.69"/>
</g>
<!-- layer3_allreduce_attn&#45;&gt;layer3_attn_norm_gpu9 -->
<g id="edge1310" class="edge">
<title>layer3_allreduce_attn&#45;&gt;layer3_attn_norm_gpu9</title>
<path fill="none" stroke="black" d="M56897.33,-2429.83C56807.49,-2412.85 56687.46,-2386.03 56585.5,-2349 56563.62,-2341.05 56540.69,-2330.34 56520.2,-2319.81"/>
<polygon fill="black" stroke="black" points="56521.76,-2316.68 56511.27,-2315.16 56518.53,-2322.89 56521.76,-2316.68"/>
</g>
<!-- layer3_allreduce_attn&#45;&gt;layer3_attn_norm_gpu10 -->
<g id="edge1314" class="edge">
<title>layer3_allreduce_attn&#45;&gt;layer3_attn_norm_gpu10</title>
<path fill="none" stroke="black" d="M56955.42,-2410.41C56904.89,-2382.79 56839.06,-2346.81 56789.95,-2319.96"/>
<polygon fill="black" stroke="black" points="56791.43,-2316.78 56780.98,-2315.06 56788.07,-2322.93 56791.43,-2316.78"/>
</g>
<!-- layer3_allreduce_attn&#45;&gt;layer3_attn_norm_gpu11 -->
<g id="edge1318" class="edge">
<title>layer3_allreduce_attn&#45;&gt;layer3_attn_norm_gpu11</title>
<path fill="none" stroke="black" d="M57016.83,-2389.66C57011.78,-2368.2 57006.24,-2344.65 57001.63,-2325.07"/>
<polygon fill="black" stroke="black" points="57005.01,-2324.15 56999.32,-2315.22 56998.2,-2325.76 57005.01,-2324.15"/>
</g>
<!-- layer3_allreduce_attn&#45;&gt;layer3_attn_norm_gpu12 -->
<g id="edge1322" class="edge">
<title>layer3_allreduce_attn&#45;&gt;layer3_attn_norm_gpu12</title>
<path fill="none" stroke="black" d="M57094.32,-2405.77C57130.28,-2379.3 57174.92,-2346.46 57209.17,-2321.25"/>
<polygon fill="black" stroke="black" points="57211.66,-2323.76 57217.64,-2315.02 57207.51,-2318.12 57211.66,-2323.76"/>
</g>
<!-- layer3_allreduce_attn&#45;&gt;layer3_attn_norm_gpu13 -->
<g id="edge1326" class="edge">
<title>layer3_allreduce_attn&#45;&gt;layer3_attn_norm_gpu13</title>
<path fill="none" stroke="black" d="M57150.26,-2424.67C57223.02,-2406.46 57317.43,-2380.18 57398.5,-2349 57420.2,-2340.65 57443.1,-2330.03 57463.75,-2319.72"/>
<polygon fill="black" stroke="black" points="57465.41,-2322.8 57472.76,-2315.17 57462.26,-2316.55 57465.41,-2322.8"/>
</g>
<!-- layer3_allreduce_attn&#45;&gt;layer3_attn_norm_gpu14 -->
<g id="edge1330" class="edge">
<title>layer3_allreduce_attn&#45;&gt;layer3_attn_norm_gpu14</title>
<path fill="none" stroke="black" d="M57193.91,-2439.35C57324.76,-2425.95 57512.18,-2399.46 57669.5,-2349 57692.72,-2341.55 57716.92,-2330.65 57738.31,-2319.79"/>
<polygon fill="black" stroke="black" points="57740.02,-2322.85 57747.3,-2315.15 57736.81,-2316.63 57740.02,-2322.85"/>
</g>
<!-- layer3_allreduce_attn&#45;&gt;layer3_attn_norm_gpu15 -->
<g id="edge1334" class="edge">
<title>layer3_allreduce_attn&#45;&gt;layer3_attn_norm_gpu15</title>
<path fill="none" stroke="black" d="M57224.21,-2449.44C57410.88,-2442.5 57700.19,-2419.86 57940.5,-2349 57964.33,-2341.97 57989.05,-2330.94 58010.72,-2319.85"/>
<polygon fill="black" stroke="black" points="58012.57,-2322.83 58019.81,-2315.1 58009.33,-2316.63 58012.57,-2322.83"/>
</g>
<!-- layer3_allreduce_moe&#45;&gt;layer3_output_gpu8 -->
<g id="edge1308" class="edge">
<title>layer3_allreduce_moe&#45;&gt;layer3_output_gpu8</title>
<path fill="none" stroke="black" d="M56947.94,-1745.1C56784.32,-1735.68 56539.37,-1711.25 56335.5,-1648 56312.55,-1640.88 56288.77,-1629.94 56267.88,-1618.96"/>
<polygon fill="black" stroke="black" points="56269.27,-1615.73 56258.81,-1614.09 56265.96,-1621.9 56269.27,-1615.73"/>
</g>
<!-- layer3_allreduce_moe&#45;&gt;layer3_output_gpu9 -->
<g id="edge1312" class="edge">
<title>layer3_allreduce_moe&#45;&gt;layer3_output_gpu9</title>
<path fill="none" stroke="black" d="M56982.28,-1733.58C56873.93,-1718.15 56724.53,-1691.23 56598.5,-1648 56576.16,-1640.34 56552.85,-1629.54 56532.14,-1618.85"/>
<polygon fill="black" stroke="black" points="56533.61,-1615.67 56523.13,-1614.12 56530.36,-1621.87 56533.61,-1615.67"/>
</g>
<!-- layer3_allreduce_moe&#45;&gt;layer3_output_gpu10 -->
<g id="edge1316" class="edge">
<title>layer3_allreduce_moe&#45;&gt;layer3_output_gpu10</title>
<path fill="none" stroke="black" d="M57035.5,-1715.66C56985.67,-1696.58 56923.84,-1672.06 56869.5,-1648 56849.05,-1638.94 56827.19,-1628.52 56807.1,-1618.63"/>
<polygon fill="black" stroke="black" points="56808.53,-1615.43 56798.02,-1614.13 56805.42,-1621.7 56808.53,-1615.43"/>
</g>
<!-- layer3_allreduce_moe&#45;&gt;layer3_output_gpu11 -->
<g id="edge1320" class="edge">
<title>layer3_allreduce_moe&#45;&gt;layer3_output_gpu11</title>
<path fill="none" stroke="black" d="M57090.63,-1697.21C57072.73,-1673.06 57051.94,-1645 57035.27,-1622.51"/>
<polygon fill="black" stroke="black" points="57037.86,-1620.13 57029.09,-1614.18 57032.24,-1624.3 57037.86,-1620.13"/>
</g>
<!-- layer3_allreduce_moe&#45;&gt;layer3_output_gpu12 -->
<g id="edge1324" class="edge">
<title>layer3_allreduce_moe&#45;&gt;layer3_output_gpu12</title>
<path fill="none" stroke="black" d="M57175.19,-1698.61C57196.18,-1674 57220.84,-1645.09 57240.45,-1622.09"/>
<polygon fill="black" stroke="black" points="57243.34,-1624.1 57247.16,-1614.22 57238.01,-1619.56 57243.34,-1624.1"/>
</g>
<!-- layer3_allreduce_moe&#45;&gt;layer3_output_gpu13 -->
<g id="edge1328" class="edge">
<title>layer3_allreduce_moe&#45;&gt;layer3_output_gpu13</title>
<path fill="none" stroke="black" d="M57230.37,-1717.38C57284.53,-1698.41 57352.31,-1673.45 57411.5,-1648 57432.14,-1639.13 57454.12,-1628.67 57474.21,-1618.69"/>
<polygon fill="black" stroke="black" points="57475.93,-1621.75 57483.3,-1614.15 57472.8,-1615.49 57475.93,-1621.75"/>
</g>
<!-- layer3_allreduce_moe&#45;&gt;layer3_output_gpu14 -->
<g id="edge1332" class="edge">
<title>layer3_allreduce_moe&#45;&gt;layer3_output_gpu14</title>
<path fill="none" stroke="black" d="M57280.92,-1734.34C57393.54,-1719.15 57550.28,-1692.19 57682.5,-1648 57705.41,-1640.34 57729.35,-1629.5 57750.6,-1618.76"/>
<polygon fill="black" stroke="black" points="57752.23,-1621.85 57759.53,-1614.17 57749.04,-1615.62 57752.23,-1621.85"/>
</g>
<!-- layer3_allreduce_moe&#45;&gt;layer3_output_gpu15 -->
<g id="edge1336" class="edge">
<title>layer3_allreduce_moe&#45;&gt;layer3_output_gpu15</title>
<path fill="none" stroke="black" d="M57314.75,-1745.57C57483.99,-1736.48 57740.14,-1712.27 57953.5,-1648 57977.18,-1640.87 58001.77,-1629.87 58023.37,-1618.84"/>
<polygon fill="black" stroke="black" points="58025.19,-1621.84 58032.44,-1614.12 58021.95,-1615.63 58025.19,-1621.84"/>
</g>
<!-- pipeline_stage0_1&#45;&gt;layer2_qkv_gpu8 -->
<g id="edge673" class="edge">
<title>pipeline_stage0_1&#45;&gt;layer2_qkv_gpu8</title>
<path fill="none" stroke="black" d="M33495.88,-1393C33341.55,-1378.7 33117.51,-1351.67 32926.5,-1304 32921.52,-1302.76 32916.47,-1301.39 32911.39,-1299.92"/>
<polygon fill="black" stroke="black" points="32912.19,-1296.51 32901.61,-1297 32910.18,-1303.22 32912.19,-1296.51"/>
</g>
<!-- pipeline_stage0_1&#45;&gt;layer2_qkv_gpu9 -->
<g id="edge674" class="edge">
<title>pipeline_stage0_1&#45;&gt;layer2_qkv_gpu9</title>
<path fill="none" stroke="black" d="M33481.32,-1370.99C33390.12,-1353.23 33281.27,-1330.04 33184.5,-1304 33175.05,-1301.46 33165.32,-1298.64 33155.58,-1295.69"/>
<polygon fill="black" stroke="black" points="33156.43,-1292.29 33145.84,-1292.69 33154.37,-1298.98 33156.43,-1292.29"/>
</g>
<!-- pipeline_stage0_1&#45;&gt;layer2_qkv_gpu10 -->
<g id="edge675" class="edge">
<title>pipeline_stage0_1&#45;&gt;layer2_qkv_gpu10</title>
<path fill="none" stroke="black" d="M33512.12,-1340C33478.69,-1326.86 33444.38,-1313.36 33413.3,-1301.14"/>
<polygon fill="black" stroke="black" points="33414.35,-1297.8 33403.77,-1297.39 33411.79,-1304.31 33414.35,-1297.8"/>
</g>
<!-- pipeline_stage0_1&#45;&gt;layer2_qkv_gpu11 -->
<g id="edge676" class="edge">
<title>pipeline_stage0_1&#45;&gt;layer2_qkv_gpu11</title>
<path fill="none" stroke="black" d="M33626.95,-1339.89C33619.28,-1330.63 33611.47,-1321.2 33603.99,-1312.17"/>
<polygon fill="black" stroke="black" points="33606.59,-1309.81 33597.52,-1304.34 33601.2,-1314.28 33606.59,-1309.81"/>
</g>
<!-- pipeline_stage0_1&#45;&gt;layer2_qkv_gpu12 -->
<g id="edge677" class="edge">
<title>pipeline_stage0_1&#45;&gt;layer2_qkv_gpu12</title>
<path fill="none" stroke="black" d="M33737.61,-1339.89C33745.21,-1330.63 33752.96,-1321.2 33760.38,-1312.17"/>
<polygon fill="black" stroke="black" points="33763.16,-1314.29 33766.8,-1304.34 33757.75,-1309.85 33763.16,-1314.29"/>
</g>
<!-- pipeline_stage0_1&#45;&gt;layer2_qkv_gpu13 -->
<g id="edge678" class="edge">
<title>pipeline_stage0_1&#45;&gt;layer2_qkv_gpu13</title>
<path fill="none" stroke="black" d="M33821.86,-1352.06C33864.32,-1335.32 33910.49,-1317.12 33951.1,-1301.1"/>
<polygon fill="black" stroke="black" points="33952.46,-1304.33 33960.48,-1297.4 33949.9,-1297.82 33952.46,-1304.33"/>
</g>
<!-- pipeline_stage0_1&#45;&gt;layer2_qkv_gpu14 -->
<g id="edge679" class="edge">
<title>pipeline_stage0_1&#45;&gt;layer2_qkv_gpu14</title>
<path fill="none" stroke="black" d="M33839.6,-1378.76C33937.87,-1360.02 34066.76,-1333.52 34179.5,-1304 34191.26,-1300.92 34203.46,-1297.48 34215.59,-1293.88"/>
<polygon fill="black" stroke="black" points="34216.73,-1297.19 34225.3,-1290.97 34214.72,-1290.49 34216.73,-1297.19"/>
</g>
<!-- pipeline_stage0_1&#45;&gt;layer2_qkv_gpu15 -->
<g id="edge680" class="edge">
<title>pipeline_stage0_1&#45;&gt;layer2_qkv_gpu15</title>
<path fill="none" stroke="black" d="M33848.92,-1392.71C34004.26,-1377.44 34241.88,-1349.13 34444.5,-1304 34456.95,-1301.23 34469.85,-1297.91 34482.63,-1294.33"/>
<polygon fill="black" stroke="black" points="34483.72,-1297.66 34492.37,-1291.55 34481.79,-1290.93 34483.72,-1297.66"/>
</g>
</g>
</svg>
